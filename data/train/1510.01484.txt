{
  "article_text": [
    "the time integration of a particle motion due to electric and magnetic fields is a common task in several fields of science , from molecular dynamics to plasma physics and astrophysics .",
    "various integration methods have been established within different scientific areas .",
    "a prominent example is the leap frog method , which is also called boris pusher in the context of particle - in - cell ( pic ) codes .",
    "we consider here time - independent magnetic fields which , however , may be nonuniform in space . the electric field on the other hand is not subject to any constraints .",
    "a classical coulomb system subject to a magnetic field serves as an example .",
    "if the particles within this system are moving sufficiently slow , the pairwise interaction can be described purely electrostatically and only the time invariant external magnetic field has to be taken into account .    in this article",
    "we review some second - order methods from the literature under a unifying framework : the methods are interpreted as splitting methods and the solutions of the subflows are given in terms of the so - called @xmath0 functions .",
    "this offers an economic way of stating , analyzing and implementing the methods .",
    "we also present a new second - order method based on the symmetric splitting of the hamiltonian of the system .",
    "further we discuss the structure preserving character of the methods regarding time symmetry , volume preservation and preservation of the system s underlying poisson structure .",
    "the article is organized as follows . in section  [ sec:2 ]",
    "we formulate the equations of motion of a particle subject to an electric and a static magnetic field as a poisson system , and we state some important properties of the exact flow of the system . in section  [ sec:3 ]",
    "we shortly discuss the corresponding properties we desire from the discrete flow given by the numerical integrator . in section  [ sec : splitting ] we give formulas for the maps corresponding to the subflows of different terms of the poisson system and shortly discuss their structural properties . in section  [ sec : methods ] we present four time integrators , which are constructed using the formulas of section  [ sec : splitting ] and certain @xmath0 functions . in section  [ sec : num_results ] we give numerical results in which the integrators are compared on four different cases .",
    "the needed formulas for the matrix functions are given in the appendix ( section  [ sec : appendix ] ) .",
    "the equations of motion for a particle with mass @xmath1 and charge @xmath2 subject to an electromagnetic field are given by the lorentz force @xmath3 where the electric field @xmath4 and the magnetic field @xmath5 are determined by a scalar potential @xmath6 and a vector potential @xmath7 , respectively , as @xmath8 in the lagrangian formalism the lorentz force can be derived from the lagrangian @xmath9 which leads to the usual hamiltonian formulation @xmath10 however , we use a different formulation of the equations of motion , which exhibits both the hamiltonian structure of the system and the splitting of the right - hand side into efficiently computable subflows .",
    "we use @xmath11 for the momentum and state the equations of motion as @xmath12 where @xmath13 is the electric force and @xmath14 corresponds to the cross product of the magnetic force as @xmath15 we use the matrix formulation of the cross product as it will simplify the analysis and derivation of the time integration methods .",
    "the system can be described as a poisson system  ( * ? ? ? * ch.7 ) .",
    "recall that a system of ordinary differential equations ( odes ) in @xmath16 with a given initial value @xmath17 at @xmath18 , @xmath19 is called a poisson system , if @xmath20 is a skew - symmetric matrix which satisfies the identity @xmath21 in this case , @xmath20 is also called a poisson tensor .",
    "the exact flow @xmath22 of any poisson system is a poisson map ( also called noncanonically symplectic map ) , i.e. , the jacobian matrix of the flow satisfies @xmath23 moreover , it is time symmetric , i.e. @xmath24 .    the ode can be written formally in the form with the hamiltonian @xmath25 and the skew - symmetric structure matrix @xmath26 by setting @xmath27 .",
    "we will denote from now on the conjugate variables as @xmath28 or @xmath29 , whichever is more convenient .    for the system matrix we have the following .",
    "let @xmath30 be a differentiable function , and let the @xmath31 matrix be defined by @xmath32 .",
    "then a direct calculation using the relation shows that @xmath20 as in defines a poisson tensor if and only if @xmath33 .",
    "this is satisfied as maxwell s laws are assumed to hold for the magnetic field ( e.g. , we do not consider magnetic monopoles ) . thus the ode can be written as a poisson system .",
    "the flow of a hamiltonian system is volume preserving , i.e. , it holds that @xmath34 the same is true for the exact flow of the system with the structure matrix as can be seen as follows . from the relation it follows that @xmath35 as @xmath36 . since @xmath37 is a continuous function of @xmath38 , and since @xmath39 , holds also for the exact flow of the poisson system .",
    "as we consider only the motion of a single particle , the electrostatic force @xmath40 will be time - independent . in case of many particles and pairwise forces",
    "this is not the case .",
    "however , the poisson system generalizes from dimension @xmath41 to @xmath42 in a trivial way : @xmath43 is replaced by a @xmath44 block diagonal matrix consisting of @xmath31 blocks .",
    "it is desirable that the one - step map @xmath45 given by the numerical flow satisfies the same structural properties as the exact flow of the ode .",
    "the preservation of time symmetry or the poisson structure implies good long time behavior for the numerical solution ( see the backward error analysis of @xcite ) .",
    "the properties we want from the integrators are :    1 .",
    "time symmetry : @xmath46 .",
    "2 .   the integrator gives a poisson map , i.e. , it holds that @xmath47 3 .",
    "the preservation of volume : @xmath48    whether is satisfied depends both on the integrator and the poisson system considered . moreover , the integrator has to respect the casimirs ( the first integrals of the poisson system ) , which in general is difficult to verify for a nonlinear system matrix @xmath20 .",
    "however , in some special cases one can show that these properties hold .",
    "that is the case for example if the integrator is a composition method resulting from a hamiltonian splitting .",
    "this will be discussed in section  [ sec : splitting ] .",
    "we will study analytically in section  [ sec : methods ] whether the considered integrators satisfy these properties .",
    "to have a common description for the various time integrators we state them in the framework of splitting methods and use the @xmath0 functions for representing the subflows containing the term @xmath49 .",
    "to this end , we write the poisson system as @xmath50 where @xmath51 we denote the exact flows of the subsystems corresponding to @xmath52 , @xmath53 , @xmath54 , etc . by @xmath55 , @xmath56 , @xmath57 , etc .",
    "this means that @xmath58 provides the exact solution of the system @xmath59 at time @xmath38 , and so on .",
    "we further denote by @xmath60 the exact flow of the ode with right - hand side @xmath61 , where @xmath62 .",
    "this means that the magnetic field is fixed at @xmath63 , i.e. @xmath64 .",
    "one easily verifies the following solutions for the exact flows : @xmath65 we note that the so - called rodrigues formula allows an efficient implementation of the matrix exponential @xmath66 and the @xmath0 functions ( see   and   of the appendix ) .",
    "we will also need the solutions of the subsystems corresponding to the fields @xmath67 and @xmath68 .",
    "the flow corresponding to @xmath67 is given by the exact solution of the ode @xmath69 which can be expressed by the matrix exponential as @xmath70 using we see that @xmath71 where @xmath72 . on the other hand ,",
    "the flow corresponding to the field @xmath73 is given by the exact solution of the ode @xmath74 this solution is given by the variation - of - constants formula as @xmath75 we also state the solution for the flow corresponding to @xmath76 in the particular case when both @xmath77 and @xmath78 are constant .",
    "this is presented also in @xcite using another formulation .",
    "the ode corresponding to the flow is now @xmath79 and its solution is given again by the variation - of - constants formula and by formula as @xmath80 where @xmath81 .",
    "we note that all of these substeps are time symmetric , i.e. , @xmath82 , and so on .",
    "we also note that the subflows and are volume preserving .",
    "both the maps @xmath83 and @xmath84 have the jacobian @xmath85 where @xmath86 for @xmath87 and @xmath88 for @xmath60 .",
    "its determinant is given by @xmath89 as the cayley transform of a skew - symmetric matrix is a unitary matrix , and as @xmath90 is a continuous function of @xmath91 and @xmath92 , we find for the maps @xmath87 and @xmath60 the relation @xmath93 therefore both are volume preserving .",
    "one easily verifies from that @xmath94 and @xmath95 are also volume preserving .    splitting the hamiltonian gives subsystems corresponding to the right - hand sides @xmath96 and @xmath97 both of these constitute poisson systems of the form with the system matrix and with hamiltonians @xmath98 and @xmath99 , respectively .",
    "therefore , the subflows @xmath100 and @xmath95 are poisson maps , as well as their compositions @xmath101 , etc .",
    "we will next state four time integration methods .",
    "they are formulated using the @xmath0 functions and the solutions of the subflows given in section  [ sec : splitting ] .",
    "three of them can be found in the literature : the boris  buneman scheme @xcite , the method of chin @xcite and the method of spreiter and walter @xcite .",
    "we also state a new method which is nearly symmetric and nearly preserves the poisson structure ( method c below ) .",
    "the so - called boris pusher @xcite is undoubtedly the most common particle trajectory integrator used for pic codes .",
    "it is a second - order accurate centered difference leap frog scheme , given by @xmath102 pic codes usually define the position with an offset of half a time step @xmath91 relative to the momentum . in @xmath103 is updated alternatingly with @xmath104 .    to formulate this scheme as a one - step method",
    ", we denote @xmath105 , @xmath106 , @xmath107 and so on . using this notation",
    "the linear drift operation corresponding to @xmath52 can be split as @xmath108 the momentum change in between these drift operations is defined by the second equation of .",
    "solving it for @xmath109 gives @xmath110 where @xmath111 is the cayley transform @xmath112 and @xmath113 .",
    "we note that both the resolvent @xmath114 and @xmath115 can be evaluated efficiently ( see and of the appendix ) .",
    "since @xmath116 , we may rewrite the momentum step also as @xmath117 from this one can easily read off that the mid - step can be split as @xmath118 the steps and give together the approximation @xmath119 where @xmath120 , and @xmath121 is given by @xmath122 since @xmath123 , we have @xmath124 .",
    "therefore , gives a symmetric method .",
    "we note that is equivalent to the formulation with the initial value @xmath125 .",
    "since the cayley transform of a skew - symmetric matrix is a unitary matrix , the subflow @xmath121 is also a volume preserving map ( see the analysis of section  [ sec : splitting ] ) . and as also the maps @xmath126 and @xmath127 are volume preserving , the method is volume preserving as a composition of volume preserving maps .",
    "the volume preservation property of the boris scheme was also shown in @xcite .    replacing the cayley transform by the exponential function in the mid - step , i.e.",
    ", considering the splitting @xmath128 gives also a symmetric and volume preserving method .",
    "both the cayley transform and the matrix exponential rotate the momentum around the vector @xmath129 in the mid - step .",
    "this can be seen as follows .",
    "since @xmath130 , we may deduce from the power series representations that @xmath131 on the other hand , since @xmath43 is skew - symmetric both @xmath132 and @xmath133 are unitary matrices , so that @xmath134 from and it follows that both give rotations around @xmath129 .      using the lie operator formalism @xcite ,",
    "the following splitting methods are derived in @xcite :    * chin - a : @xmath135 * chin - b : @xmath136    since the substeps are symmetric maps , both and give symmetric methods . moreover , as the methods and are compositions of volume preserving maps ( see section  [ sec : splitting ] ) , both of them are volume preserving as well .",
    "we note that the methods of chin become exactly energy preserving when @xmath137 @xcite .      as a new method",
    ", we propose a symmetric splitting of the hamiltonian for the poisson system .",
    "this means that the right - hand side of the is split into the flows and according to the hamiltonian .",
    "then , strang splitting is applied to this decomposition giving the symmetric one - step method @xmath138 for a constant magnetic field @xmath139 this splitting approach can be found in @xcite where it goes by the name of scovel s method ; see also @xcite .",
    "the mid - step of , i.e. , the solution @xmath140 can be computed efficiently using the formula if the magnetic field is uniform . if the magnetic field is position dependent , some approximations have to be made .",
    "we infer from that the last substep @xmath141 changes only @xmath104 . as the magnetic field depends only on @xmath103 , we see from that by using a symmetric approximation for , we get a symmetric approximation for .    the approaches we consider for the mid - step are the following ones :    1 .   the symmetric method @xmath142 combined with fixed - point iteration .",
    "this approach can be found in @xcite .",
    "2 .   the symmetric method @xmath143 combined with fixed - point iteration .",
    "3 .   perform a symmetric high - order composition of either or . for a description of composition schemes we refer to @xcite . in numerical experiments we use the 8th - order scheme from @xcite .    in the methods above the numerical strategy",
    "is to perform a fixed - point iteration for the implicit mid - step .",
    "this approach is also taken in @xcite .",
    "for the approach this means that after the initial value @xmath144 is computed , the iteration goes on as @xmath145 here @xmath146 can be computed explicitly using the formula .",
    "the implementation for goes analogously .",
    "after the initial value @xmath147 is computed , the iteration goes on as @xmath148    as shown in @xcite the method with the approach will be symmetric up to an order that equals the number of fixed - point iterations .",
    "it is easy to verify that the same holds true for . by the results of @xcite the same holds true for the third approach .",
    "it is easily verified that the high - order composition scheme will also be a poisson integrator up to an order of the scheme used for the mid - step ( i.e. , the relation will be satisfied up to this order ) .",
    "although the number of magnetic field evaluations increases considerably , the term @xmath40 is still evaluated only once per time step , which may be beneficial in situations where the calculation of the electric field is more expensive than that of the magnetic field .",
    "since the flows of the subsystems resulting from a hamiltonian splitting are poisson maps , so is the composition ; see also  ( * ? ? ?",
    "as the method is symmetric and a poisson integrator , it has a modified hamiltonian ( see the backward error analysis of  @xcite ) and preserves the first integrals for exponentially long times .",
    "the strategies 1 - 3 above give symmetric ( or poisson ) maps up to a high order and we expect a good preservation of first integrals numerically .",
    "in @xcite a second - order accurate scheme is proposed which incorporates a homogeneous magnetic field in @xmath149-direction , and which overcomes the stability condition @xmath150 , where @xmath151 is the cyclotron frequency .",
    "we repeat here the derivation of this method using the @xmath0 functions which shortens the derivation considerably .",
    "as this derivation shows , the method can be seen as an exponential version of the velocity verlet scheme . integrating the lorentz force law @xmath152 with respect to @xmath38",
    "gives an ode for @xmath103 , @xmath153 under the assumption that @xmath154 , we can approximate the ode up to second order as @xmath155 by the variation - of - constants formula the solution for this ode at @xmath156 is given by @xmath157 this gives the time stepping formula for @xmath103 . integrating the lorentz force law and using the variation - of - constants formula once more yields @xmath158 using the fact that @xmath159 and @xmath160 we find that @xmath161 the approximations and give together the one - step formula of spreiter and walter : @xmath162 since @xmath163 , @xmath164 and @xmath165 as @xmath166 , we see that in the limiting case @xmath166 the velocity verlet scheme is obtained .",
    "we note that the method of spreiter and walter can be interpreted also as an _ exponential taylor method @xcite . _    despite of its similarity with the velocity verlet scheme , we have not found any structure preserving properties for the method of spreiter and walter .",
    "in the first experiment , we compare the integrators for a particle motion in an inhomogeneous magnetic field in the absence of an electric field .",
    "then , results for experiments including combined electric and magnetic fields are provided .",
    "the motion of a charged particle in a penning trap @xcite provides a suitable numerical test in the case of combined fields . in this setting",
    "the particle trajectory is a periodic orbit , formed by a superposition of three harmonic oscillators .",
    "in addition to the ideal penning trap with a uniform magnetic field we consider two variations of this setup with static but nonuniform magnetic fields .      in the first experiment",
    "we consider an example provided in @xcite : a particle of charge @xmath167 and mass @xmath168 at initial position @xmath169 with initial velocity @xmath170 moves in a magnetic field @xmath171 , @xmath172 .",
    "the particle motion is composed of a periodic motion in the @xmath173-plane and a @xmath174 drift in @xmath28-direction with drift velocity @xmath175 .",
    "the drift reduced trajectory @xmath176 forms an ellipse centered at @xmath177 with @xmath178 .",
    "@xmath179 is given by @xmath180 one full orbit has the period @xmath181 .",
    "the scalar potential is set @xmath182 and the vector potential @xmath183 with @xmath184 .",
    "the lagrangian takes the form @xmath185 .",
    "as it is independent of @xmath186 , the @xmath28-component of the generalized momentum , @xmath187 gives another integral of motion .",
    "since now @xmath188 , the flow @xmath189 vanishes and the integrators used in the previous example simplify as follows .    * boris  buneman scheme with cayley transformation : @xmath190 * chin - b ( equals boris  buneman scheme with matrix exponential ) : @xmath191    the method of scovel gave poor results as it is not symmetric when applied to a nonuniform field .",
    "therefore it was discarded in this experiment .",
    "the symmetric methods ( denoted as impl .",
    "strang ) and ( denoted as impl .",
    "mp . ) were used with five ( for impl .",
    "strang ) and six ( for impl .",
    "mp . ) fixed - point iteration steps .",
    "we compare these methods by performing a numerical integration over 20000 cycles of period @xmath192 with step sizes @xmath91 varying from @xmath193 to @xmath194 .",
    "the initial velocity is set to @xmath195 in all test cases .",
    "figures  [ fig : inhom_mag_field_invariant ] and  [ fig : inhom_mag_field_position ] show the time step length plotted against the relative error of the invariant @xmath196 ( as defined in ) and the absolute position error using a logarithmic scale .",
    "both iterative methods provide slightly lower errors of the invariant , while only the implicit strang splitting method has a lower position error than the method of chin .",
    "the method of boris preserves well first - order drifts .",
    "when the step size increases almost about one order of magnitude there is only a little impact on the position error for the method of boris .",
    "the position error stays around @xmath197 , which is the diameter of the ellipse in @xmath198direction . for small time steps",
    ", however , the implicit strang splitting method is the most accurate .",
    "+    the error behavior becomes more visible when considering separately the error of the drift velocity and the error of the period length as shown in figures  [ fig : inhom_mag_field_v_drift ] and  [ fig : inhom_mag_field_period ] .",
    "the boris pusher is the best method regarding the conservation of the drift velocity but the worst regarding the period length .",
    "+     +   +      the ideal penning trap consists of a static quadrupole electric field and a uniform magnetic field given by @xmath199 where @xmath200 depends on the geometry and the voltage of the electrodes . the analytic solution for the motion of a single particle in an ideal penning trap can be found in @xcite . choosing the trap parameters",
    "suitably gives a stable periodic orbit consisting of a fast gyromotion perpendicular to @xmath5 with the frequency @xmath201 , a slower axial motion along @xmath5 with the frequency @xmath202 solely caused by the electrostatic fields and an even slower circular @xmath203 drift motion around the @xmath149-axis with the magnetron frequency @xmath204 .",
    "we set @xmath205 , @xmath168 , @xmath206 , @xmath207 and the initial coordinates of the particle @xmath208 and @xmath209 .",
    "the particle trajectory of this example is shown in figure  [ fig : trajectories_a ] .    as the magnetic field is uniform in space the central step of the symmetric hamiltonian splitting",
    "can be computed exactly as is done in scovel s method .",
    "we compare this method to the method of chin , the method of spreiter and walter ( denoted by spw ) , the boris pusher and its matrix exponential variation ( denoted by boris exp ) .",
    "we compare the methods by their ability to deliver a stable orbit over a large number of magnetron cycles ( full circles around the @xmath149-axis ) , by the relative energy error ( figure  [ fig : penning_ideal_energy ] ) and by the absolute error of the position ( figure  [ fig : penning_ideal_position ] ) .",
    "as both types of errors are heavily oscillating , the maximum value of the error along a trajectory with a total simulation time of @xmath210 ( a complete magnetron cycle ) is plotted against the time step length , using logarithmic scales for both quantities .",
    "the time step size ranges from 0.002 to 2.4 cyclotron cycles @xmath211 , violating the stability criteria for some methods .",
    "a further reference line with a slope corresponding to a second - order method has been added to both plots .    with the exception of spreiter and walter",
    "all methods feature a bounded energy error and a position error increasing linearly in time on a closed orbit , as long as the time step size is considerably smaller than @xmath212 .",
    "the method of spreiter and walter shows a linearly increasing energy error until its orbit becomes unstable , so with longer simulation time its errors become worse relative to the other methods .    for larger time steps the method of chin , the hamiltonian splitting ( scovel ) and the boris pusher in its matrix exponential variation become unstable for @xmath213 , @xmath214 integer , while the boris pusher using the cayley transform preserves a closed orbit and a bounded energy error .",
    "the boris pusher provides in both variations a smaller energy error than the method of chin and the hamiltonian splitting , but shows a larger position error for small time steps .",
    "figure  [ fig : penning_ideal_position ] demonstrates an interesting behavior of the boris pusher : for a large range of time step sizes the maximum position error remains constant at @xmath215 , the diameter of the gyromotion .",
    "this can be explained by the fact that the boris pusher can reproduce the correct first - order gyrocenter drift motion @xcite .",
    "the position error of a stable trajectory is bounded by the maximum diameter of the closed orbit ( approximately 1 in our example ) , which causes the cut - offs in figures  [ fig : penning_ideal_position ] ,  [ fig : penning_bottle_position ] , and  [ fig : penning_asymm_position ] .",
    "+      the third experiment features a nonuniform magnetic field : a penning trap with a magnetic bottle determined the magnetic field @xmath216 here @xmath217 is as given in .",
    "a physical implementation of a penning trap featuring such a magnetic field can be found in @xcite .",
    "we set @xmath218 and all the other parameters are as in the last example .",
    "the strength of the magnetic field and the cyclotron frequency @xmath151 vary only a little along the trajectory .",
    "the particle trajectory of this example is shown in figure  [ fig : trajectories_b ] .",
    "when using the symmetric splitting method , approximations have to be made for the mid - step since now the magnetic field is nonuniform in space .",
    "figure  [ fig : penning_bottle_fp_energy ] shows the effect of the number of employed fixed - point iterations on the energy preservation of this method in a long time simulation of a trapped particle using a time step size of @xmath219 , where @xmath220 is the cyclotron frequency at the initial position . as the position error is bounded by the closed orbit we choose the relative error of @xmath221 ( defined as the angle of motion around the @xmath149-axis ) as a measure for the trajectory s error in figure  [ fig : penning_bottle_fp_phasexy ] .",
    "both errors are heavily oscillating , so the maximum value over each @xmath222 consecutive time steps is drawn .",
    "the mid - step is either approximated by the implicit method ( denoted as impl .",
    "strang ) or by ( denoted as impl .",
    "mp . ) . for 5 fixed - point iterations ( in the case of impl .",
    "strang ) and 6 iterations ( in the case of impl .",
    "mp . ) both alternatives seem to become approximately energy preserving and provide a stable orbit .",
    "this is expected from the theory , since the order of symmetry of these methods equals the number of fixed - point iterations employed @xcite and since a good long time behavior can be expected for symmetric methods @xcite .",
    "we compare the methods of chin , the boris pusher and the symmetric splitting method using the implicit schemes as described above .",
    "furthermore , we apply a high - order composition of or ( denoted as impl .",
    "mp .  comp . ) .",
    "the composition is performed using an 8th - order symmetric scheme of suzuki and umeno @xcite consisting of 15 substeps .",
    "each substep uses 16 fixed - point iterations .",
    "consequently , such a composition scheme requires a large number of magnetic field evaluations per time step : 240 for the method , or 255 when using the method due to the calculation of the initial value within each substep .",
    "nevertheless , a single electric field evaluation suffices for each time step .",
    "as the results of the implicit schemes do not differ considerably when the composition is applied , only the ones of are drawn in the plots .",
    "as before we provide two log - log plots showing the dependence of the energy and the position errors on the time step size in the range of 0.002 to 0.4 cyclotron cycles @xmath223 .",
    "lacking an analytic solution to determine the position errors we use the trajectory of a high - order method with a small time step ( 0.00025 cyclotron cycles ) as a reference : the fourth - order method of @xcite applied on @xmath224 and @xmath87 ( denoted as m in @xcite ) in combination with a composition scheme @xcite increasing the order to 6 .",
    "all variations of the symmetric hamiltonian splitting method give an energy error similar to chin s scheme ( figure  [ fig : penning_bottle_energy ] ) .",
    "however , the smallest position error is obtained by using the composition scheme for the mid - step of the hamiltonian splitting .",
    "+     +      as the penning trap with magnetic bottle is still rotationally invariant , we also consider an example with an asymmetric magnetic field given by @xmath225 where @xmath226 .",
    "notice that @xmath227 .",
    "@xmath217 is again as given in .",
    "the particle trajectory of this example is shown in figure  [ fig : trajectories_c ] .",
    "along the trajectory the magnetic field strength increases by a factor of 1.8",
    ". therefore time step sizes between 0.001 and 0.1@xmath223 are investigated in a simulation lasting for approximately 24 orbit cycles .",
    "figures  [ fig : penning_asymm_energy ] and  [ fig : penning_asymm_position ] show the energy and position errors for the methods giving similar results as in the previous example .",
    "the reference trajectory for the position errors has been computed with the method described in the previous example .",
    "using the largest time step size @xmath228 shows unbounded energy errors for all the methods with the exception of the boris pusher with the cayley transform and the fixed point iteration schemes of the symmetric hamiltonian splitting in combination with the high - order composition method of the mid - step .",
    "therefore another long time integration over @xmath229 time steps of length 0.1@xmath223 has been performed using both methods and the fourth - order method of @xcite ( denoted by chin m ) .",
    "for this example we measure also the magnetic moment defined by @xmath230 it is a so - called adiabatic invariant of the system @xcite and should be conserved approximately .",
    "the magnetic moment as well as the energy error are oscillating within some range , so the maximum value on consecutive intervals of @xmath222 time steps is drawn in figures  [ fig : penning_asymm_longrun_energy ]  and  [ fig : penning_asymm_longrun_magmom ] .",
    "while the energy error of the boris pusher remains smaller than that of the symmetric hamiltonian splitting for over @xmath231 time steps , the evolution of the magnetic moment @xmath232 indicates the instability long before .",
    "an initial decrease of @xmath232 is followed by a rapid growth after @xmath233 time steps for the boris scheme . the boris scheme with 2 times smaller time steps ( denoted boris h/2 ) shows a similar behavior with a delay .",
    "the fourth - order method denoted by chin m exhibits a quickly growing error in energy but a smoother change of @xmath232 . only the symmetric hamiltonian",
    "splitting in combination with a high - order approximation of the mid - step is able to provide a stable orbit .",
    "we have considered here time integrators for particle trajectories in combined electric and magnetic fields .",
    "we have reformulated and analyzed existing methods found from literature under a common framework and additionally proposed a new method which deals the effect of the magnetic field implicitly .",
    "this is done by splitting the right - hand side of the equations of motion into three terms and by using the matrix function approach .",
    "the matrix functions are used for the magnetic field term , and the so - called rodrigues formula simplifies their evaluation .",
    "we represent the equations of motion as a poisson system and analyze the structure preserving properties of the integrators .",
    "the existing methods we found in literature are : boris  buneman scheme , chin s schemes , the method of spreiter and walter , and the scovel s method .",
    "additionally we have proposed a new implicit scheme .",
    "this scheme is the same as the scovel s method when the magnetic field is homogeneous .",
    "the boris  buneman scheme and the chin s schemes are shown to be both symmetric and volume preserving .",
    "for the spreiter and walter s scheme we did not find any structure preserving properties .",
    "the new method we propose is fully structure preserving up to an order equaling the number of fixed - point iterations used for the implicit mid - step . in numerical experiments",
    "we illustrate the effect of the number of fixed - point iterations on the preservation of the structure . in our experiments",
    "6 iterations were enough to reduce the error negligible .",
    "as a first numerical comparison , we tested all the schemes except spreiter and walter s method in a case where there is no electric field . due to the time symmetry , all the methods seemed to preserve invariants .",
    "for the position error the newly proposed implicit splitting method seemed to be the most accurate for small time steps , whereas for larger time steps the method of boris was the most accurate . when the motion was separated into a periodic and a drift term , it was found that the method of boris preserved the drift motion the best and the periodic motion the worst , whereas this was the opposite for the implicit splitting method .    to compare schemes in combined electric and magnetic fields , we integrated particle trajectories within a penning trap .",
    "as the first example of combined fields we considered a constant homogeneous magnetic field , so scovel s method could be used producing energy and solution errors very similar to the method of chin : a lower solution error than the boris pusher for step - sizes considerably smaller than the inverse cyclotron frequency at the cost of a slightly larger but likewise bounded energy error .",
    "spreiter and walter s method on the other hand did not feature a bounded energy error , so the orbit of the particle was unstable .",
    "as a second penning trap example we have an inhomogeneous but radially symmetric magnetic field . replacing scovel s scheme by",
    "the new method still gave the same energy error like chin s scheme .",
    "the solution error differed depending on the method used for the implicit mid - step iteration . applying a high order composition scheme on the mid - step provided the lowest solution error of all methods tested .    in the last numerical example of a penning trap",
    ", we performed long time integration of a trajectory in an asymmetric magnetic field and compared three methods : one of the chin s schemes , the boris  buneman scheme and the newly proposed implicit method .",
    "we followed the preservation of the energy and of the magnetic moment . as expected from the analysis of section [ sec : methods ] , the implicit method turned out to be the most stable",
    "the boris  buneman scheme , being the second most stable , was more unstable than the implicit scheme even for 4 times smaller time steps .",
    "the following identities are easily verified for the skew - symmetric matrix @xmath78 ( see ): @xmath234 where @xmath235 . using the second identity and the taylor series of @xmath236 and @xmath237",
    ", we get the rodrigues formula for the exponential of @xmath238 : @xmath239      we list here the necessary definitions and properties of the @xmath0 functions .",
    "these functions are defined by @xmath240 they satisfy @xmath241 and the recurrence relation @xmath242 the @xmath0 functions are analytic in the whole complex plane .",
    "therefore , the matrix @xmath243 is well defined for every @xmath244 . for various definitions and more details on matrix functions we refer to @xcite .",
    "we mention that the @xmath0 functions play a crucial role also in the so - called exponential integrators @xcite .    from",
    "it follows that the series representation of the @xmath245 function is given by @xmath246 we will also need the following formula , which can be easily verified using @xmath247 using the formula and the integral definition , the following concise representations can be derived @xmath248          let @xmath78 be as in .",
    "an explicit calculation shows that @xmath251 where @xmath252 and @xmath253 .",
    "multiplication by @xmath254 gives the cayley transform of @xmath255 , @xmath256 the application of @xmath257 on @xmath258 is equivalent to the cross product formulation of the boris scheme ( see @xcite for the cross product formulation ) , since if @xmath259 then @xmath260                                , _ higher - order decomposition theory of exponential operators and its applications to qmc and nonlinear dynamics _",
    ", computer simulation studies in condensed - matter physics vi ( 1993 ) , springer proceedings in physics 76 , pp .  7486 ."
  ],
  "abstract_text": [
    "<S> the equations of motion of a single particle subject to an arbitrary electric and a static magnetic field form a poisson system . we present a second - order time integration method which preserves well the poisson structure and compare it to commonly used algorithms , such as the boris scheme . </S>",
    "<S> all the methods are represented in a general framework of splitting methods . </S>",
    "<S> we use the so - called @xmath0 functions , which give efficient ways for both analyzing and implementing the algorithms . </S>",
    "<S> numerical experiments show an excellent long term stability for the new method considered . </S>"
  ]
}