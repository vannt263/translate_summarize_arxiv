{
  "article_text": [
    "in the analysis of data from high - energy physics experiments , one tries to resolve the `` @xmath2 '' equation .",
    "this no trivial task requires that a lot of different effects be considered simultaneously . from the experimental side , these are mainly detector acceptance and cuts , which are dictated by the construction and physical properties of the detector : the shapes of distributions may be distorted by , say , misidentification and residual background contamination ; these effects need to be discriminated in an appropriate and well - controlled way . from the theoretical side , _ all _",
    "effects of known physics have to be included in predictions as well .",
    "only then can experimental data and theoretical predictions be confronted to determine numerical values of some coupling constants or effects of new physics ( to be discovered ) .",
    "a well - defined class of theoretical effects consists of qed radiative corrections .",
    "photos is a universal monte carlo algorithm that simulates the effects of qed radiative corrections in decays of particles and resonances .",
    "it is a project with a rather long history : the first version was released in 1991 @xcite , followed by version 2.0 @xcite in 1994 ( double emission , threshold terms for fermions ) .",
    "the package is in wide use @xcite ; recently it was applied as a precision simulation tool for @xmath1 mass measurement at the tevatron @xcite and lep @xcite , and for ckm matrix measurements in decays of @xmath3 and @xmath4 resonances ( na48 @xcite , ktev@xcite , belle @xcite , babar @xcite and in fermilab @xcite ) .    throughout the years",
    "the core algorithm for the generation of @xmath5 corrections did not change much ; however , its precision , applicability to various processes , and numerical stability improved significantly . increased interest in the algorithm expressed by experimental collaborations ( including future lhc experiments ) was a motivation to perform a more detailed study of the potential and precision of the photos algorithm ; also new functionalities , such as multiple photon radiation and better interference corrections , were recently introduced . the main purpose of this paper is however not to document the new features of photos , as this will be done elsewhere @xcite , but rather to present the results of precision tests of the algorithm .",
    "our paper is organized as follows : in section [ sec : physical - problem ] we present the physical problem and further motivation for our studies . in section [ sec : photos - features ] we recapitulate the history and properties of the photos algorithm . in section [ sec : test - definition ] we present the testing procedure and necessary tools we employed to obtain our main results , which are presented in section [ sec : results ] . finally , section [ sec : summary - and - outlook ] summarizes the paper and gives an outlook to further developments . in appendix",
    "[ sec : new - photos - features ] we describe the most important features of the new version of the photos code .    some results of the tests and improvements of photos , relevant to @xmath6 physics ,",
    "have already been discussed in @xcite .",
    "although qed bremsstrahlung in particle decays is one of the most elementary effects in quantum mechanics , it is not usually considered explicitly ; to simplify , calculations are performed for inclusive quantities . in fact , it is only the case of a few specific decay channels , where exact fixed - order ( e.g. @xmath7 ) fully - differential formulae , with spin amplitudes or matrix elements squared , are available in analytical , semi - analytical or monte - carlo form .",
    "nonetheless , in the analysis of the experimental data , radiative corrections are usually treated together with the detector effects ( e.g. conversion , detector efficiency ) to form the `` qed - subtracted '' data .",
    "the control of the uncertainties of such data becomes a weak point : theoretical uncertainties appear on both sides of the `` @xmath8 '' equation @xcite .",
    "this problem does not seem to be so evident for `` discovery '' experiments or measurements performed on small statistical samples : usually the effects of radiative corrections do not exceed a few per cent .",
    "an exception is radiative corrections for background processes , such as @xmath9 , where qed bremsstrahlung is an essential element for this channel background contribution to higgs boson searches at the lhc in the @xmath10 channel @xcite .",
    "conversely , for high - precision measurements ( as those performed nowadays ) , good control of the radiative corrections becomes vital not only for the assessment of the overall experimental error of the respective cross - sections or branching ratios , but also for the shapes of the distributions .",
    "the effects of radiative corrections gradually became an important topic in the context of such measurements as high - precision measurements of @xmath1-boson properties ( see , for instance , the combined results of tevatron runs @xcite ) , or @xmath4 , @xmath11 , @xmath3 meson decays for measurements of ckm - matrix coefficients in @xmath4-physics @xcite . with increasing statistics of available experimental data , qed",
    "radiative corrections have become a significant element in the systematic error of the measured quantities .",
    "strict , systematic calculations performed order - by - order in the perturbation theory are usually not the most efficient way of including the effects of bremsstrahlung . to improve the convergence of the perturbative expansion , the most popular method in qed is exponentiation , a rigorous scheme of reshuffling the dominant terms between orders of expansion .",
    "this method is useful for the construction of monte carlo algorithms as well @xcite . in the leading - log approximation ,",
    "partially inclusive formulae exhibit factorization properties of qed , see e.g. @xcite .",
    "a matrix element formula for particle decay accompanied by bremsstrahlung photon emission may be factorized to born - level terms times the bremsstrahlung factor me formula for @xmath0-boson decays as implemented in mustraal @xcite at fully differential level .",
    "in @xcite it was shown , contrary to the previous expectations , that this factorization has a natural geometrical interpretation as well . ] .",
    "similarly , a fully differential formula for lorentz - invariant phase space for particle decay accompanied by a number of photons may be expressed in a way that exhibits factorization properties .",
    "it is used , for example , in the construction of the tauola algorithm for @xmath12 @xcite .",
    "the important property of this parametrization is the full coverage of the phase space and exact ( i.e. free of approximations ) treatment .",
    "the price to pay is that the variables describing each added photon are defined in individual rest frames , separated by boosts , making the question of the choice of gauge fixing a very subtle point of the theoretical bases of the algorithm @xcite .",
    "it is nonetheless straightforward to take advantage of these factorization properties and approximate the fully differential formula for the cross - section in any particle - decay process accompanied by a bremsstrahlung photon , by a product of a cross - section formula that does not contain qed radiative corrections times a bremsstrahlung factor .",
    "the bremsstrahlung factor depends only on the four - momenta of those particles taking part in the decay , and not on the actual underlying process !",
    "this approximation , which takes into account both real and virtual corrections , converges to an exact expression in the soft - photon region of phase space ; this fact is exploited in the construction of photos .",
    "it exposes well - known infrared and collinear singularities . in the final formula",
    ", the infrared divergences that originate from expressions describing the emission of real and virtual photons may be regularized and cancelled out order - by - order . to realize this operation , a technical parameter giving the minimum photon energy",
    "is defined ; then , integration over the directions of photons with energies lower than the cut - off is performed ; this results in the final formula being free from infrared regulator .",
    "only photons of energies higher than the cut - off are explicitly generated .",
    "the photos algorithm properly treats the collinear region of the phase space as well : the singularities are regulated simply by the masses of the charged particles .    as a result of the studies of the second - order matrix element , in particular for @xmath13 and @xmath14 ( performed already in 1994 @xcite ) , the iterative properties of the bremsstrahlung - adding formula have been identified and a universal photon - emission kernel has been isolated and double - photon emission implemented in photos . however , at that time , the question of precision was left out of the discussion .",
    "the main application was an estimate of the background to the higgs boson searches in the @xmath15 channel .",
    "only double hard - photon bremsstrahlung was of interest , and a precision of about 10% on the cross - section was sufficient .    in the iterative algorithm for ( fixed - number ) multiple - photon emission in photos ,",
    "the probability of photon generation is based ( at crude level ) on a binomial distribution , i.e. the probability for generating and not generating a photon is calculated in each iteration .",
    "encouraged by the precision of photos with a photon multiplicity higher than 2 ( subsequent terms in the expansion improved the agreement with exact calculations ) , we decided to replace the binomial distribution with a poissonian distribution for the number of photons to be generated .",
    "in this new poissonian mode , the algorithm is no longer limited to a fixed maximal number of photons : the actual number of photons is also generated ( at this `` crude - generation '' level ) .",
    "the modification set the algorithm free from the negative - probability problem as well . at a crude level , the total probability for single - photon emission in the iterated kernel does not need to be smaller than 1 , because it is multiplied by the exponent of an equally large , but negative",
    ", number is the probability in binomial distribution , it must be smaller than 1 ; however it does not need to have in poissonian distribution given by @xmath16 . because the crude distribution resembles an expansion of an exponent we call this version of multiple - photon algorithm an `` exponentiated mode '' of photos .",
    "our approach is also close to the language of exponentiation as known in qed since yennie - frautchi - suura times @xcite .",
    "the exponentiated mode has proved to be more stable , allowing us to significantly lower the value of the infrared cut - off on the photon energy as well .    a flexible organisation of iteration and phase - space variables in the photos algorithm not only allows a full phase space coverage , but also seems to introduce some higher - order effects , as will be discussed later in the paper ( subsection [ sub : iterating - emission - kernels ] ) .",
    "this was achieved by careful studies and comparisons with matrix - element calculations @xcite , without need of any kind of phase - space ordering .",
    "photos is an `` after - burner '' algorithm , which adds bremsstrahlung photons to already existing events , filled in by a host generator ( which does not take into account the effects of qed radiative corrections ) and transmitted by means of a standard hepevt event record ( only the information about four - vectors of particles taking part in the process , and the topology of the process are needed ) .",
    "photos adds ( with a certain probability ) final - state qed radiation in `` any '' decay of particle or resonance , independent of the physics process that was generated . as the result of its execution , bremsstrahlung photons",
    "are added in a fraction of the events in the hepevt event record , taking into account event topology and momentum conservation .",
    "the single - photon version of the photos algorithm originates from the mustraal monte carlo @xcite , in its part for the @xmath17 process . in photos the full @xmath5 matrix - element algorithm was simplified so as to isolate the universal kernel responsible for photon emission .",
    "the original algorithm , although maintaining full @xmath5 precision and exposing factorization properties , was however dependent on the underlying process .",
    "a downgrade was therefore required to make the algorithm process - independent : the interference terms were removed from the formula , and later restored in an approximated way for a limited set of processes ( decays of neutral particles into two charged particles of the same mass ) by introducing a monte carlo interference weight . the first version of photos : universal monte carlo for qed radiative corrections in particle decays was released in 1991 @xcite . the algorithm operated on the four - vectors stored , in the hepevt event record @xcite , by a host generator .    in 1994 ,",
    "version 2.0 of photos was released @xcite .",
    "the most important improvement was an implementation of the double - photon emission obtained by iteration of the bremsstrahlung kernel .",
    "this version became widely used in the hep experimental era @xcite . in 2000",
    ", photos was integrated to the tauola - photos - f environment to ease code maintaining ; the update of photos was released as part of the documentation of that package @xcite . in 2003 ,",
    "driven by the needs of experimental collaborations , a dedicated monte carlo weight for @xmath18 process was developed @xcite .",
    "this new option , implemented in photos version 2.07 , was documented in @xcite .",
    "one of the changes performed at that time , trivial from the physical point of view , but turned out recently to be vital , was the change of variables in the calculation of interference weight in photos : from angles to four - vectors .",
    "problems with numerical stability may occur when the four - vectors passed in the event record have insufficient precision .",
    "photos is very sensitive to rounding errors and momentum conservation in the event record , especially when the multiple - photon - emission mode of operation is used . at each iteration of the photon - emission kernel",
    "numerical rounding errors are accumulated .",
    "the value of the infrared cut - off parameter was raised to protect the algorithm from being stopped because of numerical instability .",
    "it is not the desired method to solve the numerical problems of course .",
    "special kinematic - correcting subroutines have been made available in photos since version 2.07 , but they are not active in the default setting of input parameters .    in july 2004 , we started a systematic study of the photos algorithm , focusing on its precision and possible extension to the multiple - photon emission .",
    "it turned out that the algorithm stability suffered from a bug ; this had no impact on the results , but prevented the photon emission kernel to be iterated more that twice .",
    "once the bug had been identified and corrected , the algorithm was extended to triple- and quartic - photon emission , then an exponentiated version of an iteration routine was implemented .    in january 2005 , driven by needs of @xmath4-physics experiments , a new , universal interference weight was implemented , allowing for the calculation of an interference for `` any '' process ( see also subsection [ sub : photos - b ] ) . although the formula for this interference weight is given already in eq .",
    "( 17 ) of @xcite , its integration with the photos code was not trivial until recently ; it was modification made in 2003 that made the implementation possible for every decay .    from the point of view of the precision of the obtained results",
    ", the photos algorithm may work in three regimes : ( 1 ) as a `` crude - level '' tool for bremsstrahlung generation in decays of any particle or resonance , ( 2 ) as a precision tool for dedicated decay channels ( at present @xmath0 and @xmath1 decays ) , ( 3 ) as a precision tool incorporating matrix - element calculations ( not exploited so far ) .    at a `` crude level '' , only the leading - log soft - photon parts of the matrix element are included in the photos algorithm into a charged particle @xmath19 and the neutral system @xmath20 , is then not smaller than @xmath21 or @xmath22 , whichever is bigger . ] .",
    "photos is most often used as a general - purpose tool , thus working at the `` crude level '' of precision .",
    "the precision of the results can not be guaranteed in this working regime ; a typical example of use could , however , be the generation of full bremsstrahlung phase - space coverage for acceptance studies only .",
    "appropriate comparisons with matrix - element calculations or experimental data would have to be performed to determine the actual precision .",
    "for the particular decay channel , the photos algorithm could then be upgraded to regime ( 2 ) or ( 3 ) , depending on the form of necessary compensating weight . at present",
    ", the algorithm employs a number of improvements ( with the help of the correcting weight ) and takes into account such effects as the threshold terms for fermions and the impact of the spin of emitting particle .",
    "other effects ( e.g. the impact of spin of a decaying particle or the influence of spin on interference terms ) are not at present taken into account .",
    "the impact of the approximations and missing terms on the precision of photos , when used in regime ( 2 ) , that is for @xmath1 and @xmath0 decays , is the main subject of this paper .",
    "our approach to the study of precision of the photos algorithm presented in this paper is based on numerical comparisons of results obtained from photos with respect to the results produced by other _",
    "monte carlo generators .",
    "the reference generators that we used employ formulae based on the full ( i.e. non - approximated ) fixed - order matrix - element calculations with or without exponentiation ; their precision level is well established , both by theoretical considerations and by comparisons with experimental data .",
    "the advantage of such an approach is obvious : it allows us not only to check the theoretical precision of the approximation used , but also verifies that there are no accidental errors in the actual computing code .",
    "this approach is probably more appealing to the practically - oriented user than to the theoretically - oriented one .",
    "we leave more profound theoretical studies for the future , to be possibly performed in the context of feasibility studies of applicability of methods used in photos to qcd .",
    "we have tested photos against a limited number of event generators and for a limited number of processes .",
    "the choice of processes was dictated not only by physic interests , but also by the availability of monte carlo generators with well - controlled and established precision .",
    "the following processes were studied :    * @xmath23 : for this process the lep era generators koralz @xcite and kkmc @xcite could be used .",
    "note that these programs agreed well with practically all experimental data of the lep measurements .",
    "the kkmc generator is based on @xmath24 me calculations with spin amplitudes technique and exponentiation .",
    "it can also be used in @xmath5 me exponentiated mode . in the case of koralz ,",
    "generation at first - order matrix element and no exponentiation were available as well .",
    "* @xmath25 : for this process the winhac @xcite generator is available for multiple photon generation in decay .",
    "it is based on first - order matrix element and exponentiation .",
    "comparison of photos with a first - order matrix - element generator without exponentiation can be found in ref .",
    "@xcite ; we will not repeat it here .",
    "* @xmath26 : comparison of photos with a first - order matrix - element generator without exponentiation can be found in ref .",
    "@xcite ; we will not repeat it here . * for leptonic @xmath6-decays , complete qed first - order generation with the tauola @xcite generator was available for tests ; tauola was widely used and compared successfully with lep and cleo data @xcite .",
    "the event generators and physical initializations mentioned above will be referred to as `` reference generators '' .",
    "they were used to produce reference results used in comparisons with photos .",
    "the testbed constructed from the event generators discussed above had one very important feature : it allowed a test of photos against several algorithms that differ in physical content and precision .",
    "tests started from an exact @xmath5 matrix element for single - photon emission ( non - exponentiated koralz and tauola ) compared with a single - photon version of photos ) , and went on to multiple - photon generators ( exponentiated versions of kkmc , koralz and winhac ) compared with triple- , quartic- and exponentiated multiple - photon modes of photos .    to operate",
    ", photos needs events produced by a `` host '' generator as an input .",
    "we exploited the possibility of deactivating the bremsstrahlung generation in reference generators , to turn them into qed born - level `` host '' generators .",
    "let us now define the method for automated tests that were used to obtain the results presented later in this paper . to facilitate the systematic comparisons",
    ", we adopted a specially designed tool : mc - tester , described in detail in ref .",
    "the principle of an underlying test is to analyse the series of events produced by two distinct monte carlo event generators ( or a sequence of several generators combined together ) and to extract characteristic distributions in an automatic way . in practice ,",
    "we search for distinct decay channels of the particle of interest and store histograms with distributions of all invariant masses that can be formed from the four - momenta of its decay products .    for a selected decay process , in cases discussed here",
    ", @xmath0 , @xmath1 and @xmath6 decays , the distributions are extracted from the event record in an automated way ( thereby limiting manpower for setting up the appropriate analysis code , and also the risk of accidental errors ) and stored in the output files .",
    "two output files ( from distinct runs of event generators instrumented with mc - tester ) are then analysed , and the results are presented in a form visualized as a `` booklet '' of plots and tables . the user is given a general information concerning two compared runs of monte carlo generators , a list of the decay channels with their branching fractions , and the maximum values ( for each decay channel ) of the shape difference parameter ( sdp ) .",
    "for each decay channel the plots of histogrammed values are then included : each plot presents the two distributions from two distinct runs , and the curve being a ratio of the normalized distributions ; the value of the sdp is also printed for each plot .",
    "the testing approach implemented in mc - tester was already very useful in the case of validation of tauola package ; however , for the purpose discussed here it required further adaptation . the problem was in consistent treatment of the arbitrary number of final - state qed bremsstrahlung photons that might be present in the event , the ambiguity caused by infrared singularities of qed , which is handled differently by the various monte carlo programs .",
    "our aim was to develop a technique where comparisons would make physical sense , would be automatic and independent of the way infrared singularities are regularized in particular generators . for our analysis",
    ", we defined zero- , one- , and two - photon topologies in the following way : we called the event `` zero photon '' if there was no photon of energy ( in a decaying particle rest - frame ) larger than the parameter @xmath27 .",
    "the `` one - photon '' event had to have one ( and only one ) photon of energy larger than @xmath27 .",
    "if there were more than one such photons , we called it a `` two - photon '' event . if there were more than two photons of energy larger than @xmath27 , we considered only the two most energetic ones , and treated the remaining ones as if they had not passed the @xmath27 threshold .",
    "for all the photons that did not pass the @xmath27 threshold we performed an operation inspired by leading - log logic : we added their four - momenta to the momenta of outgoing fermions of smaller angular separation .",
    "we defined two variants for this test definition : _",
    "test1 _ and _ test2_. the _ test2 _ was exactly as explained above . in _",
    "test1 _ , only one photon ( the most energetic one ) could be accepted could be accepted , leading to a fourth distinct decay channel . ] .",
    "the free parameter of the test : @xmath27 was adjusted for each process so that the results had physical sense .",
    "because of the space limitation we can not present complete `` booklets '' with results of comparisons ; for the purpose of this paper we decided to extract the most vital information : the branching ratios for events with 0 , 1 and 2 photons ( 0 and 1 if _ test1 _ was used ) and the maximum value of sdp throughout all the plots in a channel .",
    "complete results with summary tables and all analysis booklets are available on the web @xcite .",
    "the tests were based on high - statistics runs ( @xmath28 non - weighted events ) for all generators .",
    "finally , let us stress that an essential preliminary step for the tests presented here was to assure the numerical stability of photos . as a consequence , we could determine that photos may be used for processes at very high energies ( i.e. at the scale of lhc energies and even at astrophysics ones ) .",
    "the infrared cut on the photon energy may be lowered to @xmath29 from the @xmath30 value that had to be used before .",
    "the results presented here cover two issues : precision of the predictions obtained for the single - photon emission kernel and the convergence of the iterative solution . at first , in subsection",
    "[ sub : single - photon - emission - kernel - tests ] , we will discuss the comparisons of a single - photon emission kernel implemented in photos with other genuine first - order generators . in subsection [ sub :",
    "iterating - emission - kernels ] , we will discuss tests for multiple - photon generation .",
    "finally , in subsection [ sub : photos - high - energies ] , we will discuss the applicability of photos at very high energies .",
    "as mentioned before , we aim at comparing , in total , _ six _ versions of distinct monte carlo programs with five distinct modes of executing photos .",
    "let us specify them here ( including acronyms that will be used throughout the text ) :    *   * koralz o(1 ) * : koralz generator @xcite with @xmath5 me for @xmath31 , no exponentiation , single - photon emission *   * koralz * : koralz generator @xcite with @xmath24 me for @xmath31 and exponentiation ( multiple - photon emission ) *   * kkmc * : kkmc generator @xcite with @xmath24 me for @xmath31 and exponentiation at spin - amplitudes level *   * kkmc @xmath32 * : kkmc generator @xcite with @xmath5 me for @xmath31 and exponentiation *   * tauola * : tauola generator @xcite with @xmath5 me for @xmath33 ( single - photon emission ) *   * winhac exp * : winhac generator @xcite with full @xmath5 me for @xmath34 and exponentiation *   * photos o(1 ) * : photos , no iteration *   * photos o(2 ) * : photos algorithm iteration up to two times *   * photos o(3 ) * : photos algorithm iteration up to three times *   * photos o(4 ) * : photos algorithm iteration up to four times *   * photos exp * : photos algorithm with exponentiation , multiple - photon generation    before we proceed with a presentation of the results , let us , however , briefly describe the approach taken for this presentation and their numerical quantification :    * as described in section [ sec : test - definition ] , we quantify the difference between results produced by two generators by calculating branching ratios for events with 0 , 1 or 2 photons with energy above the @xmath27 threshold , and the maximum values of the sdp parameter of all combinations of invariant masses in the specific channel ( with 0 , 1 or 2 photons ) for a given comparison . * in discussion of the results we will also often use a single value of the `` overall difference '' , being either the maximum of differences in branching ratios or the maximum of products of sdp and corresponding branching ratios the difference in branching ratios is @xmath35 , the product @xmath36 , so that the first value is taken as the overall difference for that test : 0.152% . ] .",
    "we then take the larger of the two .    later in this section",
    "we present only the simplified summary tables and plots where the differences in distributions ( quantified by the sdp parameter ) are most significant . in",
    "the summary tables the first line ( appearing in bold font ) refers to the results produced by the reference generator , the others refer to results of runs of generators being tested .      in this subsection we focus on the quality of the single - photon emission kernel in the photos algorithm .",
    "we perform a systematic comparison of photos with generators that implement @xmath5 matrix element for @xmath0 , @xmath1 and @xmath6 decays .    the purpose of these tests was to assess the impact of the simplifications of the photon - emission kernel implemented in photos on the precision of its predictions ( in the photos kernel the non - leading @xmath5 terms are omitted ) .    at first , let us present the comparisons made in the @xmath37 channel .",
    "in fact , the original photos algorithm was created by gradual simplification of the exact me formula for this process , so the universal emission kernel could have been identified .",
    "therefore this process remains a benchmark for photos single - emission algorithm , its precision and design .",
    "the approximations are well understood and may in fact be restored for this particular case .",
    "we compare photos with koralz monte carlo in single - photon emission mode .",
    "this test , which was already performed a long time ago ( when photos was being developed ) , has been reproduced now , and confirmed that no accidental error has occurred since then .",
    "the results of this comparison are presented in fig .",
    "[ fig : o1resultskoralphotoso1 ] .",
    "one may notice that the difference in branching ratios for channel with and without photon are at the per mil level .",
    "the differences in distributions ( the maximum value of sdp multiplied by branching ratios ) indicate agreement better than per - mil : we have quantified the overall difference as 0.15% .",
    "the dominant contribution to the difference originates from a very sparsely populated area of the phase space , where the invariant mass of the lepton system is small , and very hard photons were emitted .",
    "the discrepancy between the distributions does not exceed 20% , even in this corner of the phase space , though .",
    "it is visible in the slope of the black curve denoting the ratio of the two distributions . in this region of the phase space the approximations ( with respect to @xmath5 ) used in photos are the largest .",
    "the differences are too small to justify the implementation of a channel - dependent correction weight .     +    [",
    "cols=\"^,^,^,^,^ \" , ]      +   +       because of numerical instabilities , the use of photos at lhc energies of 14 tev was technically limited before , by a restriction on minimal @xmath38 ratio ( @xmath39 being the mass of the decaying particle , @xmath40 the minimal energy of generated photons ) .",
    "the phase space for generation had to be significantly reduced and photons of even moderate energies could not be generated .",
    "we verified that the exponentiated version of the algorithm , armed with the new kinematics - correction routine implemented in photos 2.13 , allows it to be used to generate bremsstrahlung in decays of very energetic particles at the energy scales that indeed require very low cut on the minimal photon energy .",
    "we performed studies using kkmc as a `` host '' generator for photos to produce leptonic @xmath0-decays where the mass of the produced @xmath41 intermediate state was of order 2 tev .",
    "the value of the infrared cut - off parameter @xmath38 was lowered down to the value of @xmath42 , which allowed the generation of relatively soft photons , and high - statistics runs were completed without encountering numerical stability problems .",
    "again , we have found excellent agreement between the exponentiated version of photos and the exponentiated @xmath24 kkmc . as usual ,",
    "complete numerical results can be found on the web page @xcite .",
    "recently our attention was drawn to a use of photos in an estimation of the effects of qed radiative corrections in high - precision measurements of @xmath3 , @xmath4 and @xmath11 meson decays .",
    "the systematic error of results given by photos is important for measurements of elements of cabibbo  kobayashi  maskawa matrix of quark mixing , because qed corrections affect the acceptance .",
    "the insufficient precision of photos observed in ref .",
    "@xcite was of no surprise : for the case of semileptonic @xmath3 decays , photos was prepared for use in the `` crude '' mode only , suitable for full phase space coverage of bremsstrahlung for detector studies , but not for shape estimations .",
    "the most important missing terms in calculations performed by photos in this case were those from qed interference .",
    "thanks to the technical development performed in photos , and partially described already in this paper , it was rather straightforward to implement the universal interference weight for any decay channel , as expressed by formula ( 17 ) of @xcite : @xmath43 where @xmath44 , @xmath45 denote the charges of the decay products , @xmath46 , @xmath47 denote the momenta of the decay products , @xmath48 denotes the energy of photon , and a summation is performed over photon polarization states denoted by @xmath49 .",
    "earlier , the interference weight in photos was calculated from internal angular variables and not from four - vectors ; therefore such universal implementation was not trivial .",
    "the impact of the new interference weight on the photon angle distributions in @xmath50 process is presented in fig .",
    "[ fig : kmu3_newinterf ] .",
    "it seems that the majority of discrepancies between photos and the first - order me generator klor have been removed in this way .",
    "the complete study will however be documented elsewhere @xcite .",
    "impact of the universal interference weight in photos on predictions for the angular distribution in @xmath51 events .",
    "the distribution of the cosine of the angle between the charged lepton and the photon generated by older version of photos , without the interference weight ( plotted as black dots ) , and photos 2.13 with universal interference weight ( plotted as red line ) .",
    "this figure should be compared with figure 8b from @xcite .",
    "the majority of discrepancies between photos and @xmath5 generator klor seems to be removed by using the universal interference weight .",
    ", scaledwidth=50.0% ]",
    "we have presented numerical results from a recently upgraded version of the photos monte carlo algorithm for radiative corrections in decays of resonances . in the case of @xmath1 and @xmath0",
    "decays , we found the precision of the simulations in complete multiple - photon final states at the level of ( or better than ) @xmath52% .",
    "this conclusion originates from numerous comparisons with precision monte carlo programs : koralz , kkmc and winhac for simulation of radiative corrections in @xmath0 and @xmath1 decays .",
    "the reliability of those programs  from theoretical and technical sides  was well established by numerous applications at lep time , documented in a multitude of publications on comparisons with the experimental data ( in the case of @xmath0 decay ) , as well as other programs and calculations .",
    "the results we presented prove numerically that photos may be used with confidence to calculate bremsstrahlung in @xmath0 and @xmath1 leptonic decays with very high precision . in the case of higgs boson",
    "decays and leptonic decays of @xmath6 s , this precision tag is valid as well , even if the proof is not as solid , since it relies on the test at first order only .",
    "this conclusion can not be extended to other decay channels , without further work involving a study of process - dependent matrix elements .",
    "nonetheless , precision in the general case is also better now .",
    "finally , let us stress that the mathematical side of the multiple - photon algorithm presented here is missing a rigorous proof .",
    "present - day applications do not justify such an effort . wherever it was possible",
    ", we have verified photos correctness and found that the performance was excellent . in other cases",
    "we were limited by availability of exact matrix elements for single - photon emission .    a more thorough explanation of the mathematical side of the algorithm may , however , be interesting in the future , especially having in mind applications in qcd .",
    "note that algorithms of photos do not rely on the conformal symmetry of soft photon factors and the phase space of masless particles , which is crucial in the construction of exclusive - exponentiation algorithms as used by kkmc , winhac or koralz .    from its origin",
    ", the algorithm of photos was developed as fortran77 code , even though a c++ implementation was already completed @xcite several years ago .",
    "since there was no standard for c++ event record at that time , it was not published .",
    "recently , the experimental communities expressed interest in using photos with the hepmc event record @xcite .",
    "this certainly is a valid option for future development .",
    "we would like to acknowledge inspiring discussions with the authors of the generators we used for comparisons , and with the users of photos ; in particular we would like to thank e.  barberio , m.  boonekamp , s.  jadach , b.  kersevan , r.  kessler , l.  litov , w.  placzek , e.  richter - was , b.f.l .",
    "ward .    the inspiring atmosphere of hera  lhc and mc4lhc workshops at cern and at desy is also acknowledged .",
    "10    e.  barberio , b.  van eijk , and z.  was , _ comput .",
    "* 66 * ( 1991 ) 115 .",
    "e.  barberio and z.  was , _ comput .",
    "* 79 * ( 1994 ) 291308 .",
    "m.  a. dobbs _",
    "et al . _ , http://www.arxiv.org/abs/hep-ph/0403045[hep-ph/0403045 ]",
    "collaboration , v.  m. abazov _",
    "_ , _ phys .",
    "* d70 * ( 2004 ) 092008 , http://www.arxiv.org/abs/hep-ex/0311039[hep-ex/0311039 ] .",
    "collaboration , g.  abbiendi _ et al .",
    "* b580 * ( 2004 ) 1736 , http://www.arxiv.org/abs/hep-ex/0309013[hep-ex/0309013 ] .",
    "collaboration , j.  abdallah _ et al .",
    "_ , _ eur .",
    "phys . j. _ * c31 * ( 2003 ) 139147 , http://www.arxiv.org/abs/hep-ex/0311004[hep-ex/0311004 ] .",
    "collaboration , a.  lai _ et al .",
    "_ , _ phys .",
    "* b602 * ( 2004 ) 4151 , http://www.arxiv.org/abs/hep-ex/0410059[hep-ex/0410059 ] .",
    "collaboration , t.  alexopoulos _ et al .",
    "_ , _ phys . rev . _",
    "* d71 * ( 2005 ) 012001 , http://www.arxiv.org/abs/hep-ex/0410070[hep-ex/0410070 ] .",
    "collaboration , a.  limosani _ et al . _ , http://www.arxiv.org/abs/hep-ex/0504046[hep-ex/0504046 ] .",
    "collaboration , b.  aubert _ et al .",
    "_ , _ phys . rev . _ * d69 * ( 2004 ) 111103 , http://www.arxiv.org/abs/hep-ex/0403031[hep-ex/0403031 ] .",
    "collaboration , j.  m. link _ et al . _ , http://www.arxiv.org/abs/hep-ex/0412034[hep-ex/0412034 ] .",
    "p.  golonka and z.  was , in preparation .",
    "p.  golonka , _ in preparation_. phd thesis , institute of nuclear physics , p.a.s . ,",
    "krakow , 2005 ?",
    "written under supervision of z. was , draft will be available at http://cern.ch/piotr.golonka/mc/phd .",
    "z.  was and p.  golonka , http://www.arxiv.org/abs/hep-ph/0411377[hep-ph/0411377 ] .",
    "z.  was , written on the basis of lectures given at the 1993 european school of high energy physics , zakopane , poland , 12 - 25 sep 1993 , http://www.arxiv.org/abs/cern-th-7154-94[cern-th-7154-94 ] .",
    "e.  richter - was , _ z. phys . _ * c64 * ( 1994 ) 227240 .",
    "e.  richter - was , _ z. phys .",
    "_ * c61 * ( 1994 ) 323340 .",
    "`` radiative corrections in b , d and k meson decays '' workshop and ckm05 conference , la jolla , march 2005 , .",
    "s.  jadach , z.  was , and b.  f.  l. ward , _ comput",
    "* 130 * ( 2000 ) 260 , up to date source available from http://home.cern.ch / jadach/.    s.  jadach , b.  f.  l. ward , and z.  was , _ comput .",
    "* 79 * ( 1994 ) 503 .",
    "p.  h. eberhard _ et al .",
    "_ , to appear in the proceedings of the workshop on z physics at lep , edited by g. altarelli , r. kleiss and v. verzegnassi ( cern-89 - 08 v.1 - 3 ) held in geneva , switzerland , feb 20 - 21 and may 8 - 9 , 1989 .",
    "published in lep physics wrkshp.1989:v.1:235 - 266 .",
    "f.  a. berends , r.  kleiss , and s.  jadach , _ nucl .",
    "phys . _ * b202 * ( 1982 ) 63 . f.  a. berends , r.  kleiss , and s.  jadach , _ comput .",
    "* 29 * ( 1983 ) 185200 .",
    "m.  jezabek , z.  was , s.  jadach , and j.  h. kuhn , _ comput .",
    "* 70 * ( 1992 ) 6976 .",
    "z.  was , http://www.arxiv.org/abs/hep-ph/0406045[hep-ph/0406045 ] .",
    "d.  r. yennie , s.  frautschi , and h.  suura , _ ann . phys .",
    "( ny ) _ * 13 * ( 1961 ) 379 .",
    "s.  jadach , b.  f.  l. ward , and z.  was , _ comput .",
    "_ * 66 * ( 1991 ) 276292 .",
    "j.  j. hernandez _",
    "_ , _ phys .",
    "lett . _ * b239 * ( 1990 ) 1515 .",
    "p.  golonka , e.  richter - was , and z.  was , http://www.arxiv.org/abs/hep-ph/0009302[hep-ph/0009302 ] .",
    "g.  nanava and z.  was , _ acta phys .",
    "_ * b34 * ( 2003 ) 45614570 , http://www.arxiv.org/abs/hep-ph/0303260[hep-ph/0303260 ] .",
    "p.  golonka _ et al . _ , http://www.arxiv.org/abs/hep-ph/0312240[hep-ph/0312240 ]",
    "s.  jadach , b.  f.  l. ward , and z.  was , hep - ph/9905205 , computer .",
    "phys . commun .",
    "w.  placzek and s.  jadach , _ eur .",
    "phys . j. _",
    "* c29 * ( 2003 ) 325339 , http://www.arxiv.org/abs/hep-ph/0302065[hep-ph/0302065 ] .",
    "a.  andonov , s.  jadach , g.  nanava , and z.  was , _ acta phys .",
    "* b34 * ( 2003 ) 26652672 , http://www.arxiv.org/abs/hep-ph/0212209[hep-ph/0212209 ] .",
    "collaboration , m.  davier and c .- z .",
    "yuan , _ econf _ * c0209101 * ( 2002 ) tu06 , http://www.arxiv.org/abs/hep-ex/0211057[hep-ex/0211057 ] .",
    "collaboration , s.  anderson _",
    "_ , _ phys .",
    "* d61 * ( 2000 ) 112002 , http://www.arxiv.org/abs/hep-ex/9910046[hep-ex/9910046 ] .",
    "p.  golonka , t.  pierzchala , and z.  was , _ comput .",
    "* 157 * ( 2004 ) 3962 , http://www.arxiv.org/abs/hep-ph/0210252[hep-ph/0210252 ] .",
    "p.  golonka and z.  was , see + http://cern.ch/piotr.golonka/mc/photos-mctester .",
    "a.  andonov _ et al . _ , http://www.arxiv.org/abs/hep-ph/0209297[hep-ph/0209297 ]",
    "t.  c. andre , http://www.arxiv.org/abs/hep-ph/0406006[hep-ph/0406006 ] .",
    "golonka , l.  litov , e.  mihova , and z.  was , in preparation .",
    "p.  golonka , `` photos+ - a c++ implementation of a universal monte carlo algorithm for qed radiative corrections in particle s decays '' , master s thesis , faculty of nuclear physics and techniques , agh university of science and technology , june , 1999 .",
    "written under the supervision of z. was , available at http://cern.ch/piotr.golonka/mc/photos .",
    "m.  dobbs and j.  b. hansen , _ comput",
    "* 134 * ( 2001 ) 4146 .",
    "in this appendix let us briefly summarize options and switches available in version 2.13 of photos , so it can serve as a reference guide for librarians and end - users .",
    "the complete , technical description of the algorithm , with its recent improvements , will be presented elsewhere @xcite .    by default ,",
    "the new options are not active and photos 2.13 behaves much like photos 2.0 from 1994 @xcite .",
    "it also does not require any changes in old interfaces . in most applications it will produce results that differ little with respect to previous versions , with the exception of the case of interference effects which are now simulated . as in previous versions ,",
    "the initialization parameters , which are subject to user modifications , should be configured in the subroutine phocin .",
    "+ phocin & isec & .true . & switch to enable double emission   + phocin & * itre * & .false . & switch to enable triple / quartic emission   + phocin & * iexp * & .false . & switch to enable exponentiated , multiphoton mode   +    +   phocin & * interf * & .true . & switch to enable universal interference weight   + phocin & ifw & .true . & switch to enable dedicated interference weight   +   & & & for @xmath53 decays   + phocin & * fint * & 2.d0 & maximum interference weight .",
    "+   & & & the value may need to be adjusted to @xmath54 , where +   & & & @xmath55 is the maximal multiplicity of charged decay   +   & & & products of any elementary branching   +    +   phocin & call phcork(n ) & & switch to select kinematics correction mode : +   & & n=1 & n=1 : no correction   +   & & & n=2 : corrects energy from mass   +   & & & n=3 : corrects mass from energy   +   & & & n=4 : corrects energy from mass for particles   +   & & & up to 0.4 gev mass , for heavier ones corrects mass   +   & & n=5 ( exp ) & n=5 : most complete correction for mother   +   & & & and daughter particles ; required for _ ( exp ) _ + phocin & xphcut & 0.01 & infrared cut - off parameter : minimal photon energy   +   & & 1d-7 ( exp ) & expressed as fraction of decaying particle mass   + phocin & iftop & .true . & switch to enable emission in the   +   & & & hard process @xmath56 +      the exponentiated mode has been implemented in version 2.09 of photos ; it may be activated using the iexp flag . by eliminating the problem of negative probabilities",
    "we were able to lower the default value for xphcut parameter to @xmath29 for that mode",
    ". nevertheless , multiple iteration of emission kernel puts higher demands on numerical precision : aggregating rounding errors and initially insignificant numerical deficiencies in energy - momentum conservation of the input data , may lead to significant problems with numerical stability .",
    "therefore a new option for kinematics corrections of the data in the event record was implemented .",
    "the new option , activated with call phcork(5 ) is active by default for the exponentiated mode .",
    "it corrects momenta four - vectors of all particles taking part in photon generation : at first , the energies of all daughter particles are corrected in such a way that @xmath57 ; then the four - momentum of the mother - particle is recalculated to ensure energy - momentum conservation .      before version 2.13",
    "the qed interference was implemented in photos for dedicated decay channels only , namely neutral particle decaying into a pair of opposite - charge particles .",
    "for other channels decays , where a dedicated interference weight was implemented in version 2.07 ( see subsection 7.2.4 of @xcite ) . ]",
    "the interference effects were not taken into account so far .",
    "starting from version 2.13 a new , universal algorithm calculating interference effects for all processes is present in photos . by default , as in previous versions , this algorithm ( implemented internally as the monte carlo interference weight ) is active and may be controlled using interf flag . to use this new interference weight",
    ", it is required that the value of the fint parameter be adjusted in such a way that the maximum weight in the monte carlo rejection is increased to @xmath54 , where @xmath55 denotes the maximal expected multiplicity of charged particles in decays processed by photos .",
    "an omission in adjusting this parameter often results in photos stopping with an error message indicating too high a value of summary weight . on the other hand , putting the value of fint too high may significantly increase the cpu time consumed by photos because of monte carlo rejection not being effective .",
    "an option for having the actual value of fint automatically calculated for each event is being considered for implementation in the future .",
    "phtype & * ifour * & .true.and.(itre ) & switch to enable quartic emission   +   phocin & * expeps * & 1d-4 & residual probability for multiple iteration ,   +   & & & `` stop criteria '' for crude generation   +    + phocin & & & select the variant of weighting algorithm   + phomak & & & code . may be altered by proper commenting   + phopre & & & of code blocks denoted with variant a + phoene & & & and variant b comments .",
    "+ phoint & & & for use by experts only .",
    "+    at an intermediate step of development , a more effective monte carlo weight for crude probability in interference calculation was implemented in photos 2.07 : instead of doubling the crude distribution for photon emission from each charge , a flat , parallel channel was added .",
    "although the results were satisfactory , this solution turned out to suffer from problems with stability when used with universal interference weight for more that three - body decays .",
    "we therefore reverted the code to the original implementation . for the purpose of preserving this interesting technical development and maintaining the compatibility with photos versions 2.072.12 , released in 20032005",
    ", we leave this optimized code as an option to be activated by advanced users only .",
    "the two options are marked in the code by variant a and variant b comments , the former being currently active , the latter being commented - out . due to elimination of numerical instabilities",
    ", we were able to lower the value of xphcut for variant b to @xmath58 and perform important tests .",
    "such tests were not possible in the default variant a , because the value of xphcut has to be kept at @xmath30 ."
  ],
  "abstract_text": [
    "<S> we present a discussion of the precision for the photos monte carlo algorithm , with improved implementation of qed interference and multiple - photon radiation . </S>",
    "<S> the main application of photos is the generation of qed radiative corrections in decays of any resonances , simulated by a `` host '' monte carlo generator . by careful comparisons automated with the help of the mc - tester tool specially tailored for that purpose </S>",
    "<S> , we found that the precision of the current version of photos is of 0.1% in the case of @xmath0 and @xmath1 decays . in the general case , </S>",
    "<S> the precision of photos was also improved , but this will not be quantified here .     * ifjpan - v-05 - 01 + cern - ph - th/2005 - 091 + *     * photos monte carlo : a precision tool + for qed corrections in @xmath0 and @xmath1 decays *    * piotr golonka * and    _ cern , 1211 geneva 23 , switzerland _ + and + _ institute of nuclear physics , p.a.s . , ul . </S>",
    "<S> radzikowskiego 152 , 31 - 342 krakw , poland _    _ to be submitted to epjc _    </S>",
    "<S> * ifjpan - v-05 - 01 + cern - ph - th/2005 - 091 *    supported in part by the eu grant mtkd - ct-2004 - 510126 , in partnership with the cern physics department , and the polish state committee for scientific research ( kbn ) grant 2 p03b 091 27 for years 2004 - 2006 . </S>"
  ]
}