{
  "article_text": [
    "consider the following optimal control problem where the state equation is @xmath0 @xmath1 is the state variable , @xmath2 is the input , or control variable , time @xmath3 is confined to a given interval @xmath4 $ ] , @xmath5 is the dynamic - response function , the initial state @xmath6 is given , and the cost functional is @xmath7 for cost functions @xmath8 and @xmath9 .",
    "let @xmath10 be a compact set , and consider the constraint that @xmath11 for every @xmath12 $ ] . to ensure that eq .",
    "( 1 ) has a unique , continuous and piecewise - differentiable solution , the integral in eq .",
    "( 2 ) is well defined , and other conditions mentioned in the sequel are satisfied , we make the following assumption .",
    "the function @xmath13 is twice - continuously differentiable in @xmath14 for every @xmath15 ; the functions @xmath13 , @xmath16 , and @xmath17 are locally - lipschitz continuous in @xmath18 ; and there exists @xmath19 such that , for every @xmath14 and for every @xmath15 , @xmath20 .",
    "the function @xmath21 is continuously differentiable in @xmath14 for every @xmath15 ; and the functions @xmath21 and @xmath22 are locally - lipschitz continuous in @xmath18 .",
    "define an admissible control to be a function @xmath23\\rightarrow u$ ] which is piecewise continuously differentiable and has a finite number of points of non - continuity .",
    "we denote an admissible control by the bar notation @xmath24}$ ] to distinguish it from the value @xmath11 for a given @xmath12 $ ] .",
    "denote by @xmath25 the space of admissible controls .",
    "observe that @xmath26 as defined by eqs .",
    "( 1 ) -(2 ) can be viewed as a function of @xmath27 , hence denoted by @xmath28 and called a cost functional .",
    "the optimal control problem is to minimize @xmath28 over @xmath27 .",
    "note that while the constraint set @xmath29 is assumed to be compact it need not be convex , may have an empty interior and even be a finite set .",
    "the optimal control problem can be viewed as a constrained optimization problem on a function space , namely the space @xmath25 .",
    "optimization algorithms defined on an infinite - dimensional space ( such as @xmath25 ) must be discretized in order to be solved by a numerical algorithm .",
    "there are basically two approaches to this : one discretizes the problem first and then applies nonlinear - programming techniques to the resultant finite - dimensional problem , and the other defines an algorithm in terms of the infinite - dimensional variable and then discretizes the computations .",
    "the latter approach was formalized in @xcite and pursued in @xcite , and we also adopt it for the following two reasons : ( i ) .",
    "the algorithm described below makes explicit use of the hamiltonian function and the maximum principle , hance it is more natural to describe and analyze it in the continuous - time , infinite - dimensional problem setting .",
    "discretization often involves balancing precision with complexity of computations , and discretizing the computations instead of the problem affords the user considerable flexibility in determining the complexity level one iteration at a time .",
    "we set the optimal control problem in the framework of relaxed controls @xcite , described in detail in the next section .",
    "a relaxed control is a mapping @xmath30 from the interval @xmath4 $ ] into the set of borel probability measures on the set @xmath29 .",
    "it is an extension of the notion of the ordinary control , defined as a lebesgue - measurable function @xmath23\\rightarrow u$ ] .",
    "an ordinary control can be viewed as a relaxed control by associating with each @xmath12 $ ] the dirac measure at @xmath31 .",
    "the space of relaxed controls is compact ( in a suitable sense , discussed below ) as well as convex , whereas the space of admissible controls typically is not compact and may not be convex . therefore the setting of relaxed controls provides certain theoretical advantages over the setting of admissible controls , such as the existence of solutions to the optimal control problems @xcite and the simplicity of analysis of conceptual ( abstract ) algorithms @xcite . however , implementation may be more difficult due to the fact that relaxed controls are more abstract objects than admissible controls .",
    "much of the analysis in the sequel addresses this point by identifying a class of hybrid systems where implementable algorithms are possible with limited complexity .",
    "this class of systems is broad enough to include various problems of practical and theoretical interest .",
    "consider the hamiltonian function @xmath32 , where @xmath33 is the costate ( adjoint ) variable .",
    "fix @xmath14 and @xmath33 , and consider @xmath34 as a function of @xmath15 . by assumption 1",
    "this function is continuous and , since @xmath29 is compact , it admits a minimum at @xmath29 .",
    "we call such a minimum point a _ pointwise minimizer of the hamiltonian_. the algorithm is suitable for problems where a pointwise minimum of the hamiltonian is computable by a simple formula .",
    "given a relaxed control , let @xmath35}$ ] and @xmath36}$ ] be the associated state trajectory and costate trajectory .",
    "the algorithm defines a descent direction by computing a pointwise minimizer of the hamiltonian @xmath37 for a finite set of points @xmath12 $ ] .",
    "it then takes a suitable step in that direction to compute the next relaxed control . in an abstract setting of the algorithm it appears that its complexity grows without a bound in successive iterations , and the main contribution of the paper",
    "is to limit the complexity without detracting from the algorithm s convergence properties .    a preliminary version of the algorithm and its analysis in the abstract setting of eqs .",
    "( 1 ) - ( 2 ) have been presented in @xcite , but it was not applicable to a general class of switched - mode hybrid systems .",
    "the goal of this paper is to close this gap , and extend the algorithm to systems and problems defined as follows .",
    "the state equation is @xmath38 where the functions @xmath39 , @xmath40 represent different modes of the system , @xmath41 , and the mode - dependent set @xmath42 is compact . at each time",
    "@xmath12 $ ] the control variable , denoted by @xmath43 , consists of the mode - index @xmath44 and the continuous - valued control , namely , @xmath45 , where @xmath46 and @xmath47 .",
    "denote by @xmath48 the set of pairs @xmath49 such that @xmath50 and @xmath51 , and let @xmath52 denote an admissible control , namely the function @xmath53}$ ] which is piecewise continuously differentiable and has finite numbers of discontinuities .",
    "denote by @xmath54 the space of admissible controls .",
    "the cost functional for the optimal control problem is @xmath55 where @xmath56 , @xmath40 , are mode - dependent running cost functions , and @xmath9 is a final - state cost function .",
    "the optimal control problem is to minimize @xmath57 over @xmath58 .",
    "the rest of the paper is organized as follows .",
    "section ii recounts relevant existing results , section iii extends the algorithm so as to be applicable for a class of the aforementioned switched - mode problems , and section iv provides simulation results .",
    "this section surveys existing results which are relevant to the developments made in the sequel . in particular we discuss e. polak s framework of infinite - dimensional optimization , the foundations of relaxed controls , and our preliminary algorithm presented in @xcite .",
    "let @xmath59 be a hausdorff topological space with a borel measure @xmath60 , and let @xmath61 be a measurable function .",
    "consider the abstract problem of minimizing @xmath62 over @xmath63 .",
    "for a given necessary optimality condition , let @xmath64 be the set of points @xmath63 where it is satisfied , and suppose that @xmath65 is measurable .",
    "let @xmath66 be a measurable function .",
    "polak defines @xmath67 to be an _ optimality function _ if ( i ) @xmath68 iff @xmath69 , and ( ii ) @xmath70 provides a measure of the extent to which @xmath71 fails to satisfy the optimality condition .",
    "consider an iterative algorithm for minimizing @xmath26 over @xmath59 , and let @xmath72 , @xmath73 , be a sequence of points it computes from a given initial point @xmath74 .",
    "suppose that we can represent the computation of @xmath75 from @xmath72 via the notation @xmath76 , for a measurable mapping @xmath77 .",
    "the algorithm is a _ sufficient - descent _ method with respect to @xmath67 if ( i ) for every @xmath63 , @xmath78 ; and ( ii ) for every @xmath79 there exists @xmath80 such that , for every @xmath63 such that @xmath81 , @xmath82    in finite - dimensional optimization , where @xmath59 is a closed subset of @xmath83 , it is common to characterize the convergence of an algorithm by the condition that every accumulation point of a computed sequence @xmath84 , is contained in @xmath65 . in infinite - dimensional problems , there is no guarantee that a bounded sequence would have an accumulation point , nor is it guaranteed that the set @xmath65 is non - empty .",
    "for this reason the concept of optimality functions was defined in order to characterize convergence of the algorithm by the following limit , @xmath85 the notion of sufficient descent guarantees this condition via the following result .",
    "suppose that @xmath62 is bounded from below over @xmath63 .",
    "if the algorithm is of sufficient descent , then every sequence @xmath84 of iteration points computed by the algorithm , satisfies eq .",
    "the proof is immediate ; see @xcite.@xmath86    we mention that these concepts form the foundations of a general framework for the development and analysis of algorithms , targeted at infinite - dimensional optimization problems including optimal control . for details , please see chapter 4 in @xcite .",
    "the theory of relaxed controls was developed in the late nineteen - sixties @xcite , and more recent surveys can be found in @xcite .",
    "this subsection summarizes its main points which are relevant to the present paper .",
    "consider the optimal control problem defined in section i. let @xmath87 denote the space of borel probability measures on the set @xmath29 , and denote by @xmath30 a particular measure in @xmath87 .",
    "a relaxed control associated with the system ( 1 ) is a mapping @xmath88\\rightarrow m$ ] which is measurable in the following sense : for every continuous function @xmath89 , the function @xmath90 is lebesgue measurable in @xmath3 .",
    "we denote the space of relaxed controls by @xmath59 , and an element in this space is denoted by @xmath91}$ ] to distinguish it from the points @xmath92 for every @xmath12 $ ] .",
    "the space of relaxed controls is endowed with the weak star topology whereby @xmath93 if for every function @xmath94\\times u\\rightarrow r$ ] which is measurable and absolutely integrable in @xmath3 on @xmath95 $ ] for every @xmath15 , and continuous on @xmath29 for every @xmath96 $ ] , @xmath97 the space @xmath59 is compact in the weak star topology .    as noted earlier , every ordinary control @xmath98",
    "is associated with the relaxed control @xmath71 by defining @xmath99 as the dirac measure on @xmath31 .",
    "therefore the space of ordinary controls is contained in the space of relaxed controls , @xmath59 .",
    "moreover , the space of ordinary controls is dense in @xmath59 in the weak - star topology , and since the space of admissible controls , @xmath25 , is dense in the space of ordinary controls in the @xmath100 topology ( and hence in the weak - star topology as well ) , we have that @xmath25 is dense in @xmath59 in the weak - star topology .    an extension of the aforementioned optimal control problem to the setting of relaxed controls",
    "is defined by generalizing eqs .",
    "( 1 ) and ( 2 ) to the relaxed state equation and cost functional , defined as follows . for a relaxed control @xmath71 ,",
    "the relaxed state equation is @xmath101 with the same boundary condition @xmath102 as for ( 1 ) , and the relaxed cost functional is @xmath103 the relaxed optimal control problem is to minimize @xmath62 over @xmath63 .",
    "the relaxed costate ( adjoint ) variable , denoted by @xmath104 , is defined by the equation @xmath105 with the boundary condition @xmath106 , and the relaxed hamiltonian is defined as @xmath107 the maximum principle is in force and provides a natural necessary optimality condition for the relaxed optimal control problem ( see @xcite ) .",
    "it states that if @xmath63 is a solution for the relaxed optimal control problem then @xmath99 minimizes the hamiltonian at almost every time - point @xmath96 $ ] .    in these notational usages",
    "we do not distinguish between relaxed controls and ordinary controls .",
    "for instance , if @xmath71 is associated with an ordinary control @xmath98 in the manner described above , we write @xmath108 , and note that eq .",
    "( 8) is reduced to eq .",
    "( 1 ) , and similarly , the relaxed hamiltonian in ( 11 ) is reduced to the ordinary hamiltonian @xmath109 .",
    "this subsection describes the algorithm presented in @xcite , and recounts some theoretical results whose proofs can be found in the latter reference .",
    "the setting of eqs .",
    "( 1 ) - ( 2 ) is assumed .",
    "consider a relaxed control @xmath63 .",
    "let @xmath110 and @xmath104 denote the state variable and costate variable defined by eqs .",
    "( 8) and ( 10 ) , respectively .",
    "for a given @xmath111 , the function @xmath112 from @xmath59 to @xmath113 is continuous in the weak - star topology in @xmath59 ( see @xcite ) , and since @xmath59 is compact in the weak star topology , it attains a minimum in @xmath59 .",
    "therefore the following function , @xmath114 is well defined : @xmath115 we note that @xmath114 is an optimality function with respect to the relaxed maximum principle .    for",
    "a given @xmath12 $ ] , consider the hamiltonian function @xmath37 as a function of @xmath15 . by assumption 1",
    "this function is continuous , and since @xmath29 is compact , it attains its minimum there .",
    "let @xmath116 be a minimum point .",
    "we have the following simple yet useful result :    @xcite . given @xmath12",
    "$ ] , for every borel probability measure @xmath117 , @xmath118    this result states that , for given @xmath1 and @xmath119 , the minimum of the hamiltonian @xmath120 over @xmath117 is obtained by the dirac measure at a point @xmath121 .    it is tempting to conclude that @xmath122 and hence that @xmath114 is realized by an ordinary control , i.e. , @xmath123",
    ". however , the function @xmath124}$ ] might not be measurable and hence does not qualify as an ordinary control .",
    "thus , while @xmath114 always can be realized by a relaxed control , henceforth denoted by @xmath125 , it can not necessarily be realized by an ordinary control .",
    "however , given @xmath126 , it is always possible to find an admissible control @xmath127 such that @xmath128 for instance , take @xmath129 to be a zero - order interpolation of points @xmath116 for @xmath3 in a finite grid @xmath130 $ ] of equally - spaced points .",
    "although the formulation of the algorithm ( below ) does not specify the particular choice of @xmath127 , this example can be practical as long as a pointwise minimizer of the hamiltonian , @xmath121 , can be easily computed by a simple formula for a given @xmath12 $ ] .    similarly to the presentation in section ii.a , we describe the algorithm by specifying its main loop , represented by a mapping @xmath77 .",
    "thus , starting from an initial guess @xmath131 , the algorithm computes , iteratively , a sequence @xmath132 such that , for all @xmath133 , @xmath76 .",
    "the mapping @xmath134 is characterized by two quantities : a direction , and a step size .",
    "the direction we choose is an admissible control @xmath129 satisfying eq .",
    "( 15 ) . for the step size",
    "we choose the armijo stepsize as formally specified by the algorithm below .",
    "we point out that the armijo step size has been used extensively in gradient - descent optimization including optimal control problems @xcite .",
    "it is described as a part of the following formulation .",
    "given constants @xmath135 , @xmath136 , and @xmath137 .",
    "given @xmath63 , compute @xmath138 as follows .",
    "_ step 1 : _",
    "compute @xmath139 and @xmath140 , @xmath12 $ ] , by numerical means using eqs .",
    "( 8) and ( 10 ) . + _ step 2 : _ compute an admissible control @xmath141 satisfying eq . ( 15 ) .",
    "+ _ step 3 : _ compute the largest @xmath142 from the set @xmath143 such that , @xmath144 denote the resulting @xmath142 by @xmath145 .",
    "+ _ step 4 : _ set @xmath146.@xmath86",
    "we remark that the term @xmath147 indicates a convex combination of the relaxed controls @xmath71 and @xmath127 ( the latter , too , as a relaxed control ) in the sense of measures .",
    "thus , the state trajectory of @xmath147 , and its cost @xmath148 , are defined via eqs .",
    "( 8) and ( 9 ) with the measure @xmath147 replacing @xmath71 .    for every @xmath135 there exists @xmath149 such that , for every choices of @xmath150 and @xmath137 , algorithm 1 has the property of sufficient descent with respect to the relaxed maximum principle.@xmath86    if the pointwise minimizer of the hamiltonian can be computed by a simple formula then the admissible control @xmath127 can be computed easily as well , and this may result in algorithm 1 being efficient , as simulation results , presented in section iv , will show . however , there is a difficulty that first must be overcome before the algorithm can be considered .",
    "to explain it , consider the case where , in algorithm 1 , the relaxed control @xmath71 is actually an admissible control , namely @xmath151 . by step 4 of the algorithm",
    ", @xmath134 is a convex combination ( in the sense of measures ) of two admissible controls , namely @xmath146 .",
    "likewise , the result of @xmath133 iterations of the algorithm ( for @xmath152 ) is a convex combination of @xmath153 admissible controls .",
    "these are not ordinary controls but relaxed controls , and as we can see , their convex dimensionality increases with @xmath133 .",
    "we will resolve this issue for a class of switched - mode systems .",
    "in recent years there has been a mounting interest in the hybrid optimal control problem whose state equation and cost functional are defined by eqs . ( 3 ) and ( 4 ) .",
    "a number of algorithmic approaches emerged , including first- and second - order gradient - descent techniques @xcite , zoning algorithms based on the geometric properties of the underlying systems @xcite , projection - based algorithms @xcite , methods based on dynamic programming and convex optimization @xcite , and needle - variations techniques @xcite .",
    "a relaxed - control algorithm was proposed in ref .",
    "an embedded control approach was analyzed in @xcite and tested in conjunction with matlb s fmincon nonlinear - programming solver @xcite .",
    "a comprehensive survey of algorithmic techniques for the hybrid optimal control problem can be found in @xcite .",
    "an explicit characterization of relaxed controls in the setting of hybrid systems defined by eqs .",
    "( 3)-(4 ) may be complicated . in particular",
    ", the fact that each constraint set @xmath42 depends on the mode - index @xmath44 can render challenging the handling of relaxed controls in a way that is amenable to efficient computation by an algorithm .",
    "however , refs . @xcite resolve this difficulty by defining and considering a space of embedded controls lying between the space of ordinary controls and the space of relaxed controls .",
    "embedded controls are defined as follows @xcite : let @xmath154 denote the set of @xmath87-tuples of pairs , @xmath155 , where @xmath156 @xmath157 , @xmath158 , and @xmath51 , @xmath40 .",
    "an embedded control is a lebesgue measurable function @xmath159\\rightarrow w$ ] , and we denote the space of embedded controls by @xmath160 . furthermore , we denote an embedded control @xmath161}$ ] by @xmath162 .    for a given @xmath162 ,",
    "the state equation is defined by @xmath163 with the given boundary condition @xmath164 , the cost functional has the form @xmath165 and the costate equation is @xmath166   \\end{aligned}\\ ] ] with the boundary condition @xmath167 . for a detailed expositions of embedded controls ,",
    "see @xcite .    ref .",
    "@xcite derived first- and second - order optimality conditions for various optimal control problem formulations .",
    "in particular , for the problem defined in this paper , the space of embedded controls is dense in the space of relaxed controls in the weak - star topology . if a problem includes constraints on the final state then this density holds no more .",
    "however , penalty functions can be used to alter the problem into one without final - state constraints .",
    "our algorithm , defined below , computes in the space of embedded controls .    in the last paragraph of section",
    "ii we described the challenge inherent in algorithm 1 ( in an abstract setting ) due to the increasing convex dimensionality of relaxed controls computed in successive iterations .",
    "we address this difficulty for the hybrid optimal control problem in the following way .",
    "suppose that the input @xmath71 to a given iteration is an embedded control .",
    "the iteration computes the term @xmath134 which is a relaxed control as defined by step 4 .",
    "now we modify the algorithm by adding the computation of an embedded control @xmath168 having the property that @xmath169 .",
    "since ( by theorem 1 ) algorithm 1 has the sufficient - descent property with respect to the maximum principle , the latter inequality ensures that the sufficient - descent property is maintained by the modified algorithm .",
    "we point out that @xmath170 is not a projection of @xmath134 onto the space of embedded controls as in the projection - based algorithms @xcite mentioned above .",
    "the class of problems for which the algorithm is applicable is defined as follows .    for every @xmath14 , and for every @xmath40 , ( i )",
    "@xmath171 is affine in @xmath51 , and ( ii ) @xmath172 is convex in @xmath51.@xmath86    part ( i ) of the assumption means that for every @xmath40 there exist functions @xmath173 and @xmath174 such that , @xmath175    for every @xmath40 , ( i ) the functions @xmath176 and @xmath177 are twice - continuously differentiable , and ( ii ) the function @xmath178 satisfies assumption 1",
    ".    given two embedded controls , @xmath179 and @xmath180 , and given @xmath181 $ ] , we use the notation @xmath182 to designate the convex combination @xmath183 in the sense of measures .",
    "thus , if @xmath184 and @xmath185 , then the state equation of @xmath182 is @xmath186 and the cost functional is @xmath187    the following algorithm is described by specifying its main loop , as for algorithm 1 .",
    "the input to the main loop is @xmath162 , and the corresponding output is @xmath168 .",
    "the first three steps of the algorithm are identical to those of algorithm 1 , and the difference is in step 4 .",
    "given constants @xmath135 , @xmath136 , and @xmath137 .",
    "given + @xmath188 $ ] .",
    "_ step 1 : _ compute @xmath139 and @xmath140 , @xmath12 $ ] , by numerical means , using eqs .",
    "( 17 ) and ( 19 ) .",
    "+ _ step 2 : _ compute an admissible control @xmath141 satisfying eq . ( 15 ) . for every @xmath12 $ ] , @xmath189 for some @xmath190 and @xmath191 , and we can view it as an embedded control of the form @xmath192 , where , @xmath193 , and for all @xmath194 , @xmath195 .",
    "+ _ step 3 : _ compute the largest @xmath142 from the set @xmath143 such that , @xmath196 denote the resulting @xmath142 by @xmath197 .",
    "+ _ step 4 : _ for every @xmath12 $ ] , define @xmath198 , and define @xmath199 . for every @xmath40 define @xmath200 , and set @xmath201.\\ ] ] @xmath86",
    "suppose that assumption 2 and assumption 3 are in force .",
    "for every @xmath135 there exists @xmath149 such that , for every choices of @xmath150 and @xmath137 , algorithm 2 has the property of sufficient descent with respect to the relaxed maximum principle.@xmath86    if step 4 were to be replaced by @xmath202 then algorithm 2 would be reduced to algorithm 1 , and by theorem 1 it would have the sufficient - descent property .",
    "therefore the theorem will be proved once it is shown that , for @xmath170 as defined by eq .",
    "( 24 ) in step 4 , the following inequality is in force : @xmath203 that is what we next prove .",
    "_ to simplify the notation in the following discussion we omit the explicit dependence of various quantities on time @xmath3_.    by eq .",
    "( 24 ) and the definition of @xmath204 in step 4 , it is seen that @xmath170 is an embedded control .",
    "in contrast , @xmath205 is a relaxed control but not necessarily an embedded control .",
    "nonetheless , we next prove that @xmath170 and @xmath205 have the same associated state trajectories .",
    "let @xmath35}$ ] denote the state trajectory of @xmath170 . by eqs .",
    "( 24 ) and ( 17 ) , @xmath206 , and by the definition of @xmath207 ( step 4 ) , @xmath208 by eq .",
    "( 20 ) and a bit of algebra , @xmath209 therefore , and by the definitions of @xmath210 and @xmath211 in step 4 , @xmath212 by eq .",
    "( 21 ) this is the state equation of @xmath205 . since both start at the initial condition @xmath213 , the two state trajectories are identical .",
    "next , consider the cost functions @xmath214 vs. @xmath215 .",
    "( 24 ) and ( 18 ) , @xmath216 by the definition of @xmath217 in step 4 , @xmath218 .",
    "therefore , and by assumption 2(ii ) , @xmath219 .",
    "plug this inequality in ( 29 ) . by the definitions of @xmath210 and @xmath211 in step 4 ,",
    "@xmath220 since the state trajectories of @xmath170 and @xmath205 are identical , and by eq .",
    "( 22 ) , we recognize the rhs of ( 30 ) as @xmath215 .",
    "this establishes that @xmath221 , which completes the proof .",
    "this section presents three examples : an autonomous switched - mode system , an unstable hybrid system , and a spring - mass damper system .",
    "the algorithm was coded by a matlab script , and run on a system based on an intel core i5 processor with 2.8 ghz clock .",
    "all of the numerical integrations were performed by the forward euler method or the trapezoidal method .",
    "consider two cylindrical fluid tanks situated one on top of the other , each having a hole at the bottom .",
    "fluid flows into each tank from the top and out through the hole .",
    "the input flow to the upper tank comes from a valve - controlled hose , and the input flow to the lower tank consists of the output flow from the upper tank .",
    "let @xmath43 denote the input flow rate to the upper tank , and let @xmath222 and @xmath223 denote the amount of fluid in the upper tank and lower tank , respectively .",
    "@xmath43 is the control input to to the system , and @xmath224 is its state variable . by toricelli",
    "s law the state equation is @xmath225 and we assume that the initial state is @xmath226 . the control input @xmath43 is assumed to be constrained to the two - point set @xmath227 , and hence we can view the system as having two modes , mode 1 when @xmath228 , and mode 2 when @xmath229 . using the modal notation , we can write the state equation as @xmath230 with @xmath231 defined by the rhs of ( 31 ) with @xmath232 , @xmath233 .",
    "we consider the problem of having the fluid level in the lower tank track a reference curve @xmath234}$ ] for a given @xmath235 , and correspondingly we minimize the cost functional @xmath236 this is an autonomous switched - mode system without a continuous - valued control @xmath237 .",
    "therefore the hamiltonian function is @xmath238 , with @xmath239 , and for given @xmath240 and @xmath241 , its pointwise minimizer is @xmath242 .",
    "a measure @xmath243 can be represented by a point @xmath244 $ ] , where @xmath245 and @xmath246 , and hence a relaxed control is a function @xmath247\\rightarrow[1,2]$ ] .",
    "such systems are simpler than the controlled - systems discussed in section iii , the hamiltonian is easily minimized ( pointwise ) , and algorithm 2 is reduced to algorithm 1 .",
    "we provide this example nonetheless in order to highlight some features of the algorithm .",
    "this problem was addressed in @xcite with a constant target @xmath248 , while here we track the time - varying target curve @xmath249 over @xmath250 $ ] .",
    "the algorithm s parameters are @xmath251 and @xmath252 .",
    "all of the numerical integrations are performed by the forward euler method with the time step @xmath253 .",
    "the initial control is @xmath229 @xmath254 $ ] , and its cost is @xmath255 .",
    "the algorithm was run for 100 iterations , and its execution took 17.207 seconds of cpu time .",
    "figure 1 depicts the graph of @xmath256 vs. the iteration count @xmath257 , and it exhibits sharp decrease before flattening after about 10 iterations . the final cost is @xmath258 , and the graphs of the corresponding @xmath223 ( solid curve ) and its target @xmath259 ( dashed curve ) are shown in figure 2 for the sake of comparison .",
    "figure 1 indicates a fast approach of the cost @xmath256 towards its minimum value .",
    "such @xmath260-shaped graph is not uncommon for descent algorithms with armijo step size .",
    "its asymptotic convergence typically is slower than that of algorithms with superlinear convergence rate @xcite .",
    "on the other hand they are descent methods that often take large strides towards local - minimum points at the early phases of their runs , hence the l - shaped graph in figure 1 . after the run we projected the final relaxed control @xmath261 onto the space of ordinary controls by using pulse - width modulation , and",
    "the resulting control , denoted by @xmath262 , has a cost of @xmath263 .    finally , in order to explore ways to reduce the run times of the algorithm we experimented with fewer iterations and larger integration step sizes .",
    "the results are summarized in table 1 , where @xmath264 indicates the integration step , @xmath257 is the number of iterations , @xmath265 indicates the initial cost , @xmath256 is the final cost of the algorithm , and @xmath266 is the cpu time of the run in seconds .",
    "we note that an increase of @xmath264 by a factor of 10 results in cpu reduction by about a factor of 10 but with little increase in the final cost .",
    "the following lqr system was considered in @xcite .",
    "the system has two modes , indexed by @xmath233 .",
    "the dynamic response functions are @xmath267 , where @xmath240 , @xmath268 , @xmath269 , and @xmath270 . the matrices @xmath271 and @xmath272 are @xmath273 @xmath274 , and @xmath275 . the initial condition is @xmath276 , and the final time is @xmath277 .",
    "the cost functional is @xmath278 according to the problem formulation in refs .",
    "@xcite the sequence of modes is fixed at @xmath279 , and the control variable @xmath280 consists of the sole switching time between them and the continuous - valued input @xmath31 , @xmath281 $ ] . in this paper",
    "the control variable consists of the mode - schedule without restrictions , and the continuous - valued control @xmath31 , @xmath281 $ ] .",
    "we use the trapezoidal method for integrating the differential equations .",
    "the initial guess for the algorithm consists of mode 1 and @xmath282 for all @xmath281 $ ] , and we ran the algorithm for 400 iterations .",
    "the dominant eigenvalue of both matrices @xmath283 and @xmath284 is 3.0 , hence the system is highly unstable .",
    "therefore the algorithm did not work well with single - shooting integrations of the state equation , and yielded a final cost of about 14.2 , which is higher than that obtained in @xcite with a more - restricted control ( 9.766 ) .",
    "consequently we used multi - shooting integrations in the following way . with @xmath285 denoting the number of shootings , we divided the time - interval @xmath286 $ ] into @xmath285 equal - lengths subintervals with end - points @xmath287 , introduced the additional variables @xmath288 , @xmath289 as the initial condition for the state equation during the subinterval beginning at @xmath290 , and added to the cost the penalty term @xmath291 .",
    "the penalty constant @xmath292 was determined by the formula @xmath293 , since we felt that a higher penalty constant was needed for larger numbers of shooting intervals .",
    "the integration step size was set to @xmath294 .",
    "after some experimentation we chose @xmath295 , hence @xmath296 and @xmath297",
    ". a 400-iteration run of the algorithm took 14.4 seconds of cpu time , and yielded the final cost of @xmath298 .",
    "additional runs supported this result and indicated that the obtained cost is practically close to the minimum .",
    "moreover , the graph of @xmath256 vs. @xmath299 displays a similar l - shaped curve as in figure 2 .",
    "the final state trajectories @xmath300 and @xmath223 are shown in figure 3 .",
    "consider a mass connected to ground by a spring in series with a damper that represents viscous friction .",
    "let @xmath31 be an applied external force , and let @xmath222 and @xmath223 be the mass position and velocity .",
    "the system has two modes , indexed by @xmath301 , representing two levels of viscosity .",
    "the state equation is @xmath302 where @xmath87 the mass ; the spring coefficient @xmath303 is @xmath304 if @xmath305 , and @xmath306 if @xmath307 ; and the viscous friction coefficient is @xmath308 and @xmath309 .",
    "the initial condition is @xmath310 .",
    "we take the mass to be @xmath311 .",
    "the cost functional is @xmath312 , where the mode - dependent cost function is @xmath313 , and @xmath314 .",
    "we impose the constraints that , for all @xmath12 $ ] , @xmath315 , @xmath316 , and @xmath317 ; and the finel - state constraint @xmath318 , @xmath316 .",
    "we chose the final time to be @xmath319 .    in order to satisfy the final - state constraints we appended the cost functional by the penalty term @xmath320 .",
    "we applied algorithm 2 with the parameters , @xmath321 and @xmath252 , and the integration step size @xmath253 .",
    "the initial guess was @xmath322 ( i.e. , mode 1 ) , and @xmath323 for all @xmath12 $ ] .",
    "50 iterations took 11.6950 seconds of cpu time , and reduced the cost from its initial value of 94.0906 to its final value of 14.5166 .",
    "the state trajectory is shown in figure 4 , and the final state is @xmath324 .",
    "a pwm - based projection of the final embedded control onto the space of ordinary controls incurs the cost @xmath26 , excluding the penalty term , of @xmath325 .",
    "l. miller and t.d .",
    "simultaneous optimal estimation of mode transition times and parameters applied to simple traction models .",
    "_ ieee transactions on robotics _ , vol .",
    "29 , no . 6 , pp . 1496 - 1503 , 2013 .",
    "r. vasudevan , h. gonzalez , r. bajcsy , and s.s .",
    "consistent approximations for the optimal control of constrained switched systems - part 1 : a conceptual algorithm , and part 2 : an implementable algorithm . _ siam journal on control and optimization _ , vol .",
    "4663 - 4483 ( part 1 ) and pp .",
    "4484 - 4503 ( part 2 ) , 2013 .",
    "x. xu and p.j .",
    "optimal control of switched systems via nonlinear optimization based on direct differentiations of value functions .",
    "_ international journal of control _ , vol .",
    "1406 - 1426 , 2002 .",
    "shaikh and p.e .",
    "caines . on the optimal control of hybrid systems : optimization of trajectories , switching times and location schedules . in _ proceedings of the 6th international workshop on hybrid systems : computation and control _ , pp . 466 - 481 , prague , the czech republic , 2003 .",
    "p. caines and m.s .",
    "optimality zone algorithms for hybrid systems computation and control : exponential to linear complexity .",
    "13th mediterranean conference on control and automation _",
    ", limassol , cyprus , pp .",
    "1292 - 1297 , june 27 - 29 , 2005 .",
    "shaikh and p.e .",
    "optimality zone algorithms for hybrid systems computation and control : from exponential to linear complexity .",
    "ieee conference on decision and control / european control conference _ ,",
    "1403 - 1408 , seville , spain , december 2005 .",
    "attia , m. alamir , and c. canudas de wit .",
    "sub optimal control of switched nonlinear systems under location and switching constraints .",
    "16th ifac world congress _ ,",
    "prague , the czech republic , july 3 - 8 , 2005 .",
    "h. gonzalez , r. vasudevan , m. kamgarpour , s.s .",
    "sastry , r. bajcsy , and c. tomlin . a numerical method for the optimal control of switched systems .",
    "49th cdc _ ,",
    "atlanta , georgia , pp .",
    "7519 - 7526 , december 15 - 17 , 2010 .",
    "x. ge , w. kohn , a. nerode , and j.b .",
    "hybrid systems : chattering approximation to relaxed controls . _",
    "hybrid systems iii : lecture notes in computer science _",
    ", r. alur , t. henzinger , e. sontag , eds . ,",
    "springer verlag , vol .",
    "1066 , pp .",
    "76 - 100 , 1996 .",
    "meyer , m. zefran , and r.a .",
    "comparison of the embedding method to multi - parametric programming , mixed - integer programming , gradient descent , and hybrid minimum principle based methods .",
    "_ ieee transactions on control systems technology _ , vol .",
    "1784 - 1800 , 2014 ."
  ],
  "abstract_text": [
    "<S> this paper concerns a first - order algorithmic technique for a class of optimal control problems defined on switched - mode hybrid systems . </S>",
    "<S> the salient feature of the algorithm is that it avoids the computation of frchet or gteaux derivatives of the cost functional , which can be time consuming , but rather moves in a projected - gradient direction that is easily computable ( for a class of problems ) and does not require any explicit derivatives . </S>",
    "<S> the algorithm is applicable to a class of problems where a pointwise minimizer of the hamiltonian is computable by a simple formula , and this includes many problems that arise in theory and applications . </S>",
    "<S> the natural setting for the algorithm is the space of continuous - time relaxed controls , whose special structure renders the analysis simpler than the setting of ordinary controls . </S>",
    "<S> while the space of relaxed controls has theoretical advantages , its elements are abstract entities that may not be amenable to computation . </S>",
    "<S> therefore , a key feature of the algorithm is that it computes adequate approximations to relaxed controls without loosing its theoretical convergence properties . </S>",
    "<S> simulation results , including cpu times , support the theoretical developments . </S>"
  ]
}