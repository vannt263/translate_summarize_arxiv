{
  "article_text": [
    "as the most commonly observed objects , stars remain at the forefront of astrophysical research .",
    "advances in optical detector technology , computer processing power , and data storage capability have enabled new sky surveys ( e.g. , the sloan digital sky survey ; * ? ? ?",
    "* ) ; triggered many new optical transient surveys , such as the palomar transient factory @xcite and pan - starrs1 @xcite ; and allowed for space missions ( e.g. , _ kepler _ ; * ? ? ?",
    "* ) that continuously monitor more than 100,000 stars .",
    "the stellar discoveries from these surveys include revelations about rare stars , unusual explosive outcomes , and remarkably complex binaries .",
    "the immediate future holds tremendous promise , as both the space - based survey _ gaia _ @xcite and the ground based large synoptic survey telescope ( lsst ; * ? ? ?",
    "* ) come to fruition .",
    "these developments have created a new demand for a reliable and publicly available research and education tool in computational stellar astrophysics .",
    "we introduced the open source community tool ` mesa `  ( * ? ? ?",
    "* hereafter paper  i ) to meet these new demands .",
    "this first `` instrument '' paper described the design , implementation , and realm of validity of ` mesa `  modules for numerics , microphysics , and macrophysics , and introduced the stellar evolution module , ` mesa `  ` star ` .",
    "we presented a multitude of tests and code comparisons that served as our initial verification and demonstrated ` mesa `  ` star ` s initial capabilities . since paper  i",
    ", ` mesa `  has attracted over 500 registered users , witnessed over 5,000 downloads from http://mesa.sourceforge.net/ , started an annual summer school program , and provided a portal ( http://mesastar.org ) for the community to openly share knowledge ( e.g. , the specific settings for a published ` mesa `  ` star`run ) , codes , and publications .",
    "this paper describes the major new ` mesa `  capabilities for modeling giant planets , asteroseismology , and the treatment of rotation and evolution of massive stars .",
    "we also describe numerous advances since paper  i. these include the incorporation of composition gradients in the determination of convective mixing and additional verification for evolution of intermediate mass stars and the white dwarfs they create .    our improvements to ` mesa",
    "`  ` star `  for gas giant planets were motivated by the dramatic growth in this field . over 800 exoplanets",
    "have been confirmed , and their study has prompted enormous progress in our understanding of the formation and migration of giant planets , and of the importance of factors such as stellar mass @xcite , composition @xcite , and binarity @xcite .",
    "puzzles remain , though , both in our solar system and in the studies of the plethora of these newly discovered exoplanets , including the characteristics of the planet - hosting stars and the interiors , atmospheres , surface gravities , temperatures , and compositions of the planets ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "many of these variations can now be numerically explored , as can the incorporation of an inert core in an otherwise regular gas giant and the impact of irradiation .",
    "the ability to infer stellar properties ( e.g. , mass , radius , internal state , and rotation ) from measurements of the radial and non - radial oscillation modes has been dramatically improved by two space - based optical telescopes ( convection rotation and planetary transits , _ corot _ ; @xcite and _ kepler _ ; @xcite ) .",
    "the high cadences and precision ( often better than ten parts per million ) reveal and accurately measure multitudes of oscillation frequencies for over 10,000 stars , substantially raising the need for accurate and efficient computations of stellar mode frequencies and the resulting eigenfunctions .",
    "the intrinsic flexibility of ` mesa `  ` star `  allows for the exploration of model - space required to precisely infer stellar properties from the observed frequencies .",
    "an important new addition to ` mesa `  is the incorporation of stellar rotation and magnetic fields in radiative regions .",
    "as stars are not solid bodies , they undergo radial differential rotation @xcite and also rotate at different angular velocities at different latitudes @xcite .",
    "these rotational shears have a significant impact on the evolution of the stellar magnetic field .",
    "despite the resulting 3d nature of magnetism and rotation , the stellar evolution community has come a long way in understanding stars with 1d simulations @xcite , thus motivating our need to fully incorporate rotation within ` mesa ` .",
    "the new flexibility in angular momentum transport mechanisms allows for numerical exploration of alternate rotational outcomes should the observations ( e.g. , asteroseismology ) require it .",
    "the paper is outlined as follows .",
    "section [ s.planets ] describes the new capability of ` mesa `  to evolve models of giant planets , while  [ s.astroseismology ] discusses the new asteroseismology capabilities .",
    "the ` mesa `  implementation of composition gradients in stellar interiors and their impact on convective mixing is described in  [ s.mixing ] .",
    "the status of the evolution of intermediate mass stars and the ` mesa `  ` star `  construction and evolution of white dwarfs is described in  [ s.agb-wd ] .",
    "the new capabilities for evolving rotating stars is described in  [ s.rotation ] .",
    "the onset of near eddington luminosities and radiation pressure dominance in the envelopes of evolving massive stars has been a challenge for many stellar evolution codes ever since the realization of the iron opacity bump at @xmath1 @xcite .",
    "we discuss in  [ s.massive ] the resulting improvements for evolving massive stars .",
    "this allows for the uninterrupted evolution of rotating massive stars to the onset of core collapse .",
    "we conclude in  [ s.conclusions ] by highlighting where additional improvements to ` mesa `  are likely to occur in the near future .",
    "appendix [ s.input-physics ] describes the many improvements to the physics modules since paper  i ; appendix [ s.nuts-and-bolts ] presents `` nuts and bolts '' information on the primary components of evolution calculations ; and appendix [ s.mesasdk ] presents the ` mesa `  software development kit ( ` sdk ` ) .",
    "all of our symbols are defined in table  [ t.list-of-symbols ] .",
    "we denote components of ` mesa ` , such as modules and routines , in courier font , e.g. , ` evolve_star ` .",
    "cll @xmath2 & atomic mass number & [ s.chem ] + @xmath3 & mass excess of the @xmath4th isotope & [ s.chem ] + @xmath5 & wind mass loss coefficient & [ s.completing-evolution ] + @xmath6 & day - side flux incident on an irradiated planet & [ sec : irradiation ] + @xmath7 & coulomb coupling parameter & [ s.completing-evolution ] + @xmath4 & specific moment of inertia & [ s.nuts-rotation ] + @xmath8 & opacity & [ s.construction-models ] + @xmath9 & stellar luminosity & [ s.astero ] + @xmath10 & lagrangian mass coordinate & [ s.construction-models ] + @xmath11 & stellar mass & [ s.construction-models ] + @xmath12 & brunt - visl frequency & [ s.ledoux ] + @xmath13 & number density of the @xmath4th isotope & [ s.chem ] + @xmath14 & turbulent viscosity & [ s.nuts-rotation ] + @xmath15 & radial coordinate & [ sec : irradiation ] + @xmath16 & total stellar radius & [ s.construction-models ] + @xmath17 & baryon mass density & [ s.chem ] + @xmath18 & specific entropy & [ s.construction-models ] + @xmath19 & mass column & [ sec : irradiation ] + @xmath20 & depth for heating from irradiation & [ sec : irradiation ] + @xmath21 & optical depth & [ s.completing-evolution ] + @xmath22 & magnitude of changes during a timestep & [ s.timestep-controls ] + @xmath23 & target value for @xmath22 & [ s.timestep-controls ] + @xmath24 & atomic weight & [ s.chem ] + @xmath25 & h mass fraction & [ s.astero ] + @xmath26 & baryon mass fraction of the @xmath4th isotope & [ s.ledoux ] + @xmath27 & he mass fraction & [ s.planets ] + @xmath28 & electrons per baryon ( @xmath29/@xmath30 ) & [ s.chem ] + @xmath31 & abundance of the @xmath4th isotope & [ s.chem ] + @xmath32 & metallicity & [ s.planets ] + @xmath32 & atomic number & [ s.chem ] + @xmath33 & mixing length parameter & [ s.planets-no-core ] + @xmath34 & semiconvection efficiency parameter & [ s.semiconvection ] + @xmath35 & thermohaline efficiency parameter & [ s.thermohaline ] + @xmath36 & smoothing parameter for mlt++ & [ s.superadiabatic ] + @xmath37 & mlt++ parameter used in construction of @xmath36 & [ s.superadiabatic ] + @xmath38 & @xmath39 & [ s.superadiabatic ] + @xmath40 & @xmath41 & [ s.ledoux ] + @xmath42 & @xmath43 & [ s.ledoux ] + @xmath44 & specific heat at constant pressure & [ s.semiconvection ] + @xmath45 & adiabatic sound speed & [ s.astroseismology ] + @xmath46 & large frequency separation of pulsation modes & [ s.astero ] + @xmath47 & overshoot diffusion coefficient & [ s.ledoux ] + @xmath48 & thermohaline diffusion coefficient & [ s.thermohaline ] + @xmath49 & fermi energy at center & [ s.planets-no-core ] + @xmath50 & gravitational heating rate & [ s.completing-evolution ] + @xmath51 & nuclear heating rate & [ s.reactions ] + @xmath52 & neutrino loss rate & [ s.rotation-modifications ] + @xmath53 & convective flux & [ s.massive-evol ] + @xmath54 & convective overshoot parameter & [ s.astero ] + @xmath55 & radiative flux & [ s.massive-evol ] + @xmath56 & reduction factor for @xmath57 & [ s.superadiabatic ] + @xmath58 & @xmath59 & [ s.astroseismology ] + @xmath60 & opacity for thermal radiation orig .  in planet &",
    "[ sec : irradiation ] + @xmath61 & opacity for irradiation from star & [ sec : irradiation ] + @xmath62 & boltzmann constant & [ s.planets-no-core ] + @xmath63 & accretion luminosity & [ s.compressional ] + @xmath64 & @xmath65 & [ s.superadiabatic ] + @xmath66 & core luminosity & [ s.planets-cores ] + @xmath67 & eddington luminosity & [ s.rotation-mass-loss ] + @xmath68 & log surface gravity & [ s.atmospheres ] + @xmath69 & luminosity at which the onset of convection occurs & [ s.massive-evol ] + @xmath70 & radiative luminosity & [ s.massive-evol ] + @xmath71 & luminosity at which a density inversion occurs & [ s.massive-evol ] + @xmath72 & atomic mass unit & [ s.chem ] + @xmath73 & core mass & [ s.planets-cores ] + @xmath74 & mass - loss rate & [ s.compressional ] + @xmath75 & modeled mass & [ s.mesh-controls ] + @xmath76 & avogadro number & [ s.planets-no-core ] + @xmath77 & adiabatic temperature gradient & [ s.ledoux ] + @xmath78 & ledoux criterion & [ s.semiconvection ] + @xmath79 & radiative temperature gradient & [ s.ledoux ] + @xmath80 &",
    "actual temperature gradient & [ s.ledoux ] + @xmath81 & baryon density & [ s.chem ] + @xmath82 & frequency of maximum power & [ s.astero ] + @xmath83 & surface angular velocity & [ s.rotation-mass-loss ] + @xmath84 & angular velocity & [ s.rotation-modifications ] + @xmath85 & surface critical angular velocity & [ s.rotation-mass-loss ] + @xmath86 & central pressure & [ s.construction-models ] + @xmath87 & gas pressure & [ s.compressional ] + @xmath88 & radiation pressure & [ s.compressional ] + @xmath89 & core radius & [ s.planets-cores ] + @xmath90 & central density & [ s.construction-models ] + @xmath91 & pressure scale height & [ s.ledoux ] + @xmath92 & stefan - boltzmann constant & [ s.construction-models ] + @xmath93 & lamb frequency & [ s.astroseismology ] + @xmath94 & superadiabaticity , @xmath95 & [ s.superadiabatic ] + @xmath96 & controls when mlt++ is applied & [ s.superadiabatic ] + @xmath97 & central temperature & [ s.construction-models ] + @xmath98 & effective temperature & [ s.construction-models ] + @xmath99 & numerical timestep & [ s.compressional ] + @xmath100 & thermal ( kelvin - helmholtz ) timescale & [ s.rotation-mass-loss ] + @xmath101 & equatorial velocity & [ s.rotation ] +",
    "evolutionary models of giant planets and low - mass stars differ from their higher - mass stellar counterparts in both the microphysics needed to describe the interior and the role of stellar irradiation in the outer boundary condition . for masses",
    "@xmath102 , hydrogen burning is insufficient to prevent cooling and contraction .",
    "deuterium burning can briefly slow the cooling for @xmath103 , where @xmath104 is jupiter s mass , but has a negligible influence on the cooling for smaller masses .",
    "hence nuclear burning can be ignored in the planetary mass regime",
    ".    for hydrogen - helium rich objects with @xmath105 , an ideal gas equation of state ( eos ) , with arbitrary degeneracy , is a good approximation while for @xmath106 particle interactions play an important role .",
    "specifically , pressure ionization of hydrogen at @xmath107 and @xmath108 causes a sudden change from a h@xmath109-dominated phase to an ionized phase . `",
    "mesa `  employs the @xcite equation of state ( scvh eos ) , smoothly interpolated from the low to high pressure phase , for this complicated region of parameter space where thermal , fermi , and electrostatic energies may all be comparable .",
    "the scvh eos includes pressure ionization of hydrogen , but not helium .",
    "the temperature range covered by the tables is @xmath110 , and the pressure ranges from @xmath111 to a maximum value @xmath112 dependent on the temperature .",
    "smooth interpolation to other eos occurs near the scvh boundaries ( for more details see paper i ) . at the low temperatures in planetary atmospheres , abundant species such as cno atoms",
    "will be in molecular form , and may condense into clouds . `",
    "mesa `  does not follow the transition from atomic to molecular form for these species in the eos  they are currently included by increasing the helium abundance from @xmath27 to @xmath113 when calling the scvh eos . `",
    "mesa `  does , however , include the effect of molecules in the rosseland opacities . currently , the @xcite and @xcite tables , which include the opacity from molecules , but ignore condensates , are available .",
    "lastly , for planets in close - in orbits about their parent star , the external irradiation flux may be orders of magnitude larger than the cooling flux from the planet s interior .",
    "this may dramatically increase the surface temperature and affect the outer boundary condition . `",
    "mesa `  now implements several options for this surface heating , including the flexibility to include user - supplied prescriptions .    in the following subsections ,",
    "we discuss a new ` mesa `  module that creates initial models in the planetary mass range @xmath114 , and present a suite of evolutionary calculations .",
    "we discuss how surface irradiation may be included , as well as an inert core at the center of the planet .",
    "we also show what ` mesa `  ` star `  yields for the mass - radius relation for sub - solar mass stars in ",
    "[ s.mass-radius ] .      for stellar mass objects , the `",
    "pre_ms_model ` routine constructs pre - main - sequence ( pms ) models assuming @xmath115 , where @xmath116 is the luminosity at radius @xmath15 , by iterating on the starting conditions at the center to find a model with a given @xmath11 and central temperature @xmath117 .",
    "this pms routine works well for @xmath118 , but lower masses may not converge when the guess for central density @xmath119 and luminosity are not close enough to the ( unknown ) true values . as a result , it is difficult and time consuming to create models with @xmath120 using the same routine for giant planets as for stars .",
    "a new routine called ` create_initial_model ` builds a model of given @xmath11 and radius @xmath16 using an adiabatic temperature profile .",
    "given the central pressure @xmath86  and specific entropy @xmath18 , the equation of hydrostatic balance is integrated outward , and the temperature at each step determined from the equation of state using @xmath121 .",
    "the values of @xmath86  and @xmath18 are iterated to attain the desired @xmath11 and @xmath16 .",
    "the luminosity profile is then derived treating @xmath18 as constant in space for the fully convective planet ( e.g. , @xcite ) , so @xmath122 the luminosity at the surface , @xmath123 , is estimated using the radius @xmath16 and temperature @xmath124 at the @xmath125 point as @xmath126 . given @xmath123 , the luminosity at interior points is found by @xmath127 this procedure works well for @xmath11 down to @xmath128 and over a range of initial radii , allowing the user to choose either a @xmath129 radius appropriate for a cold planet , to radii @xmath130 appropriate for young or inflated planets ( e.g. , @xcite ) .",
    "here @xmath131 is the equatorial radius of jupiter .      versus @xmath90  during the evolution .",
    "each line is labeled on the left by the mass in units of @xmath132 .",
    "the dotted red lines show constant values of @xmath133)$ ] , labeled at the base of each line .",
    "the blue dashed lines show fixed values of @xmath134 , labeled at the top of each line .",
    "the large black dots show the position of maximum @xmath97  along the evolutionary track . ]     versus @xmath135 at fixed values of @xmath133)$ ] , labeled on the left of each curve .",
    "the dashed blue curves are for fixed entropy , with each curve labeled by @xmath134 on the right .",
    "the dotted black curves are for fixed luminosity , with each curve labeled by @xmath136)$ ] above @xmath137 .",
    "the green curve at the bottom is the @xmath138 @xmath139 relation from @xcite for a solar mixture of h and he . ]",
    "figures [ fig : tc_vs_rhoc_isoage_isoent ] and [ fig : r_vs_m_iso_tsl ] show evolutionary calculations for models with masses @xmath140 .",
    "all models were evolved for @xmath141 gyr .",
    "the initial models from ` create_initial_model ` had a large radius @xmath142 .",
    "the other parameters used are @xmath143 , @xmath144 and @xmath145 .",
    "the opacity and eos tables used are ` eos_file_prefix ` = ` mesa ` , ` kappa_file_prefix ` = ` gs98 ` and ` kappa_lowt_prefix ` = ` lowt_freedman11 ` .",
    "the atmosphere model is ` which_atm_option ` = ` simple_photosphere ` .",
    "figure [ fig : tc_vs_rhoc_isoage_isoent ] is a low mass extension of figure 16 from paper  i , showing evolution in the @xmath90-@xmath97  plane .",
    "each track ( solid black curve ) is labeled on the left by the planet s mass , and evolution goes from left to right .",
    "initially the planet is non - degenerate and contraction increases both @xmath146 and @xmath147 .",
    "a maximum @xmath97  is reached when @xmath148 , where @xmath49  is the electron fermi energy at the center , beyond which @xmath90  approaches a constant as @xmath97   decreases further .",
    "ignoring coulomb interactions in the eos , @xmath18 is a function of the electron degeneracy parameter @xmath149 , where @xmath150 is the electron chemical potential and all models should have maximum @xmath151 at the same @xmath18 .",
    "the line labeled @xmath152 indeed coincides with maximum @xmath97  down to @xmath153 , but at smaller masses where non - ideal effects are more important , maximum @xmath97  occurs when @xmath154 . also shown in figure [ fig : tc_vs_rhoc_isoage_isoent ] are lines of constant age , shown as dotted red lines , and labeled on the bottom of the plot .",
    "the same evolutionary calculations are used in figure [ fig : r_vs_m_iso_tsl ] to show radius versus mass at fixed values of age , entropy or luminosity . at late times , or low entropy and luminosity",
    ", the radius approaches the zero - temperature value ( green curve ; @xcite ) for which thermal support is insignificant .",
    "the maximum radius occurs where gravitational and coulomb energies , per ion , are comparable . the solid red lines , labeled by age on the left , show that contraction down to @xmath155 is rapid , taking less than 10 myr for @xmath156 .",
    "this initial rapid cooling phase occurs because the initial luminosity is orders of magnitude higher than the luminosity around one gyr .",
    "this can been seen in the black dotted contours of constant @xmath157 , where @xmath9 is larger by a factor of 100 for @xmath158 and @xmath159 for @xmath160 , as compared to @xmath161 .",
    "the blue dashed lines show contours of constant entropy , labeled on the right by @xmath162 .      in the core accretion model of planet formation ( e.g. , @xcite ) , a rock / ice core is first assembled .",
    "once this core grows to @xmath163 , where @xmath164 denotes an earth mass , it can initiate rapid accretion of nebular gas , which could then dominate the mass of the planet . for studies of planetary radii ,",
    "a central core composed of high mean molecular weight material can decrease the radius of the planet by a significant amount ( @xmath165 ) . the ` mesa `  ` star `  inert core feature allows one to add a core of specified mass @xmath73  and radius @xmath89 , or more conveniently , density @xmath90 .",
    "a luminosity @xmath66  may also be specified , although the high mean molecular weight of the core , as compared to the overlying h / he envelope , implies that even large cores will tend to have small heat content @xcite .",
    "this inert core is not presently evolved in any way , and changes in @xmath86during evolution are neglected as @xmath16 changes . while cores of mass @xmath166 are commonly used for modeling solar system giants ( e.g. @xcite ) , the large masses and small radii of some exoplanets may imply far larger core masses ( e.g. hd 149026 ; @xcite ) .",
    "in addition , neptune - like planets with smaller ratios of envelope to core masses may be modeled with ` mesa `  @xcite .",
    "-@xmath20 surface heat source .",
    "the data point with error bars is the observed value of the radius for hd 209458b quoted in .",
    "the two sets of curves are deep heating ( upper three curves ) and shallow heating ( lower three curves ) . ]",
    "surface heating by stellar irradiation changes the boundary condition for the planet s cooling and contraction .",
    "this modifies the planetary radius versus age for exoplanets at orbital separation @xmath167 . `",
    "mesa `  provides several ways to implement surface heating with varying degrees of fidelity to the true solution .",
    "these presently include :    \\a ) an energy generation rate @xmath168 applied in the outer mass column @xmath169 .",
    "here @xmath6 is the day - side flux from the star , and @xmath170 is the mass column . in steady - state",
    ", this generates an outward flux @xmath171 , which is meant to simulate the angle - averaged flux over the planetary surface .",
    "this model implicitly assumes that day - night heat transport is efficient , and at the depths of interest the temperature is uniform over the surface .",
    "the parameters @xmath6 and @xmath20 are specified through the user - specified variables ` irradiation_flux ` and ` column_depth_for_irradiation ` , making this the simplest method to use .",
    "this heating mechanism represents absorption of stellar optical radiation well below the photosphere of the planet s thermal radiation and gives rise to greenhouse heating of the atmosphere where @xmath172 .",
    "\\b ) ` mesa ` s ` grey_irradiated ` atmosphere model ( see also  [ s.atmospheres ] ) implements the angle - averaged temperature profile of .",
    "this approximate solution to the transfer equation assumes two frequency bands : optical radiation from the star ( with user - specified opacity @xmath173 ) and thermal radiation originating in the planet ( with user - specified opacity @xmath174 ) .",
    "the temperature profile is derived using the eddington approximation , assuming an external flux from the star as well as a flux from the planetary interior . while the model implemented in ` mesa `  uses a single temperature as a function of depth , it is derived allowing for local temperature variations over the surface which are then averaged over angle .",
    "this temperature profile is shown to be valid in the presence of horizontal heat transport by fluid motions .",
    "this is the only ` mesa `  atmosphere model that uses pressure instead of optical depth to determine the surface boundary condition .",
    "as this pressure may be relatively deep in the atmosphere , a correction to the radius may be required to give either the vertical thermal photosphere , or the optical photosphere in transit along a chord .",
    "lastly , the ` relax_irradiation ` routine improves initial convergence by providing a starting model closer to the irradiated one .",
    "\\c ) finally , ` mesa `  allows user - specified heating functions ( e.g. , @xmath6-@xmath20 surface heating ) or atmosphere models ( e.g. , ` grey_irradiated ` ) .",
    "user - supplied routines may be easily implemented by using the ` other_energy ` module .",
    "figure  [ fig : rph_vs_age_compare_to_cepam_guillot2010_fig9 ] shows radius versus age for the planet hd 209458b .",
    "the two groupings of lines are for different heating depths , and within each grouping of lines , there are three calculations : ` mesa `  using ` grey_irradiated ` surface boundary condition ( solid red line ) , ` mesa `  using the @xmath6-@xmath20 surface heating profile ( dashed blue line ) , and cepam using the same grey irradiated boundary condition ( dotted black line ; kindly provided by tristan guillot ) .",
    "the lower curves , corresponding to shallow heating , use fiducial values @xmath175 and give a model radius significantly smaller than the observed radius .",
    "the upper curves , corresponding to deep heating , use @xmath176 , yielding significantly hotter temperatures deep in the surface radiative zone , which slow the cooling enough to agree with the observed radius .",
    "the choice @xmath177 gives agreement between the grey irradiated and @xmath6-@xmath20 methods , where the factor of 2 accounts for the fact that the grey irradiated boundary condition has some heating below @xmath178 .",
    "the radii are at the @xmath179 photosphere for a vertical path into the atmosphere .",
    "the agreement between all three methods is excellent , at the 12% level after 100@xmath180@xmath181 .",
    "the remaining discrepancy between the ` mesa `  and cepam grey irradiated results are likely due to different opacity tables , with the ` mesa `  result using an update of @xcite ( freedman 2011 , priv .",
    "comm . ) while the cepam run uses the @xcite cond table .",
    "the differences at ages @xmath182 are due to different starting conditions .",
    "the cepam calculation started with initial radius @xmath183 , whereas the mesa calculations started with @xmath184 .",
    "the ` mesa `  grey irradiated and @xmath6-@xmath20 calculations differ at @xmath185 , likely because the former has a fixed thermal opacity while the latter allows the opacity to change .",
    "most of @xmath186 s capability to evolve low - mass ( @xmath187 ) stars was demonstrated in section 7.1 of paper  i. ` mesa `   has seen use in the asteroseismology of helium core flashing stars @xcite and the discovery of a new instability from the onset of @xmath188 burning @xcite .",
    "we expect the future use of ` mesa `  ` star `   for asteroseismic investigations of these stars to be substantial ( see  [ s.astroseismology ] ) .     from ` mesa `",
    "` star `  ( solid lines ) and ( * ? ? ?",
    "* dashed lines ) in the mass - radius plane .",
    "the data points plotted are the same as shown by @xcite . ]",
    "the derivation of accurate planetary radii based on transits requires accurate radii of the host stars ; this motivates ` mesa `  ` star `  investigations of low - mass stars @xcite .",
    "figure [ fig : stellar_m_r ] shows 1 and 5 gyr isochrones at solar composition ( @xmath189 ) from ` mesa `  ` star `  ( solid lines ) and ( * ? ? ?",
    "* dashed lines ) in the mass - radius diagram .",
    "data points shown in figure [ fig : stellar_m_r ] are taken from , @xcite , @xcite , and @xcite .",
    "this figure is a reproduction of the upper panel of figure 11 from @xcite .",
    "figure [ fig : stellar_m_r ] indicates that ` mesa `  ` star `  is capable of producing mass - radius relations for main sequence stars that are consistent with other widely - used models as well as observational data .",
    "the ` mesa `  ` star `  models were computed using , as much as possible , the same physical assumptions as the models used by @xcite .",
    "the main difference is the equation of state , for which @xcite used freeeos and ` mesa `  ` star `  uses a combination of the opal @xcite and scvh eos for thermodynamic parameters relevant to this diagram .",
    "with its highly configurable output options , and its ability to calculate asteroseismic variables , ` mesa `  ` star `  can readily produce models suitable for use with a range of oscillation codes .",
    "in addition to its own text output files , ` mesa `  can produce outputs in formats widely used by stellar oscillation codes , such as ` fgong ` and ` osc ` @xcite .    in figure  [ astero:1m_pre_ms_to_wd ]",
    "we show the evolution of a @xmath190 model in the hertzsprung - russell diagram ( hrd ) and in @xmath97-@xmath90  space .",
    "these were evolved following the test case found in ` 1m_pre_ms_to_wd ` , which was modified to include diffusion .",
    "this runs without user intervention from pre - main sequence to white dwarf . to demonstrate the changing stellar structure",
    "as the model evolves from the main sequence to post helium - core burning on the asymptotic giant branch ( agb ) , we show in figure  [ astero : profiles ] some of the fundamental quantities extracted from the corresponding ` profile.data ` files for the models marked in figure  [ astero:1m_pre_ms_to_wd ] .",
    "these include the lamb and brunt - visl  frequencies defined respectively by @xmath191 , \\label{n1}\\end{aligned}\\ ] ] where @xmath45  is the adiabatic sound speed and @xmath192 is the spherical harmonic degree .",
    "the seismic properties of the sun provide a test of stellar evolution models , and an opportunity to calibrate @xmath193 for any particular set of input physics and other assumptions . the ` mesa `  ` star `  test case ` solar_calibration ` produces a calibrated standard solar model .",
    "figure [ astero : solar ] shows the difference between the helioseismically - inferred solar sound speed profile and this model .",
    "we also show `` model s '' from @xcite .",
    "both models employ comparable input physics and assume solar abundances from @xcite and @xcite .",
    "one clear improvement since paper  i  is a smoother sound speed profile at small @xmath194 , which is primarily due to improvements in the ` diffusion `  module .",
    "this is particularly important for asteroseismology , where sharp features in the sound speed profile can influence the stellar oscillation frequencies .",
    "the results are based on the solar calibration test case compiled with the gnu fortran compiler version 4.7.2 on mac os x 10.7.5 ; appendix [ s.compiler_os ] provides information about how the solar calibration results may depend on different operating systems and compilers .",
    "the `` astero '' extension to ` mesa `  ` star `   implements an integrated approach that passes results automatically between ` mesa `  ` star `  and the new ` mesa `  module based on the adiabatic code adipls ( * ? ? ?",
    "* release ) .",
    "the ` mesa `  module ` adipls `  also supports independent use for post - processing , including the calculation of pulsation frequencies .",
    "this astero extension enables calculation of selected pulsation frequencies by ` mesa `  ` star `  during the evolution of the model .",
    "this allows fitting to the observations that can include spectroscopic constraints ( e.g. , [ fe / h ] and @xmath98 ) , asteroseismic constraints , such as the large frequency separation ( @xmath46 ) and the frequency of maximum power ( @xmath82 ) , and even individual frequencies . a variety of approaches for finding a best - fitting model are available , including grid searches and automatic @xmath195 minimization by the hooke - jeeves algorithm @xcite or by the `` bound optimization by quadratic approximation '' ( bobyqa ; * ? ? ?",
    "* ) technique .",
    "these searches are user controlled through a number of parameter bounds and step sizes .",
    "users also have full control over the relative weight assigned to the seismic and spectroscopic parts of the @xmath196 statistic .    for the automated @xmath195 minimization",
    ", astero will evolve a pre - main sequence model from a user defined starting point , and find the best match along that single evolutionary track .",
    "the code then recalculates the track , again initiated at the pre - main sequence , with different initial parameters such as mass , composition , mixing length parameter and overshoot , and repeats until the lowest @xmath195 has been found .",
    "calculating specific mode frequencies is computationally intensive .",
    "hence , a number of options exist to improve the efficiency of the minimization when individual frequencies are included .",
    "bounds can be established on stellar parameters ( e.g. , @xmath98 , central h mass fraction , @xmath46 ) , so that ` adipls `  is invoked only when the model falls within these bounds .",
    "this enables certain evolutionary stages to be skipped when other observational diagnostics rule them out  if a star is known to be a red giant , for instance , there is no sense in invoking ` adipls `  when models are on the main sequence .",
    "the large frequency separation , @xmath46 , of the model is calculated as the inverse of the sound travel time through the star , @xmath46  @xmath197^{-1}$ ] @xcite .",
    "there is also the option to derive @xmath46  using simple solar scaling : @xmath46  @xmath198 @xcite . to obtain @xmath82 , ` mesa `  scales the solar value with the acoustic cut - off frequency : @xmath82  @xmath199 @xcite .",
    "moreover , hierarchical approaches to the frequency fitting can be selected , saving large amounts of computational time . in one case",
    "the radial modes are first calculated , and only when they match reasonably well are the non - radial mode frequencies derived and included in the @xmath196 .",
    "this is particularly beneficial for red giants where the calculation of the non - radial frequencies is extremely time consuming .",
    "another example is when the time steps in the stellar evolution calculations are too large to find an accurate minimum of @xmath196 .",
    "hence , as a further option to increase efficiency while attaining accuracy , the time steps can be set to automatically reduce when the model comes close to the `` target box '' of the observational constraints . as for other modules used in ` mesa `  ` star ` , astero offers a range of graphical outputs including an chelle diagram where the fitting process can be followed in real time .",
    "there is also an option for including corrections to the model frequencies on - the - fly to compensate for the inadequate modelling of the near surface layers of the star .",
    "the effect , known as the `` surface term , '' is seen as a frequency dependent offset between the modelled and observed acoustic frequencies of the sun ( e.g. * ? ? ?",
    "the offset increases towards higher frequencies and is well described by a power law @xcite . `",
    "mesa `  ` star `  follows the approach described by @xcite for correcting the surface term .    to illustrate the performance of astero , we show here a fit to the star hd49385 .",
    "the input frequencies and the spectroscopic constraints are from @xcite .",
    "we first ran a wide - range grid search over @xmath11 , @xmath193 , [ fe / h ] , and @xmath27 , including only [ fe / h ] , @xmath98 , and @xmath46  as observational constraints .",
    "the results of this initial search guided our starting parameters and ranges for the next automatic @xmath195 minimization .",
    "we first compare our grid results with those of the radius grid search routine @xcite , which is based on a grid of astec models @xcite and find agreement within uncertainties .",
    "we then include the individual oscillation frequencies and use the hooke - jeeves algorithm for the @xmath195 minimization .",
    "model frequencies were corrected for the surface term , and the part of the @xmath195 coming from the frequencies was given 2/3 of the weight in the final @xmath195 , similar to that used by @xcite .",
    "to ensure we adequately sample the parameter space , we initiate the search at several initial values within a broad range . by starting the search from multiple initial values , we aim to reduce the chance of ending up in a local minimum , which could potentially provide unphysical results , such as the spuriously low helium abundances reported by @xcite .",
    "current developments in astero further seeks to overcome such problems and improve the robustness of the results by including frequency ratios @xcite in the @xmath195 minimization .",
    "each `` hooke '' search generates several stellar evolution tracks , each with a best @xmath195 value .",
    "we then combine the data from about 1400 tracks to estimate the 1-@xmath200 uncertainties in the varied parameters following the approach by @xcite .",
    "the lowest ( reduced ) @xmath195 value we obtained was 2.4 with a few tens of models in the 2.44.0 range , which all fit the frequencies similarly well . among these models",
    "there are two families of results , one of which has slightly lower [ fe / h ] and @xmath27 , and a slightly increased value for the spectroscopic part of the @xmath195 .",
    "the comparison of the observed and modeled frequencies for the realization with the lowest @xmath195 is shown in the chelle diagram format in figure  [ astero : echelle ] .",
    "a plot of the internal structure including the brunt - visl  and lamb frequencies is shown in figure  [ astero : hd49385profile ] , and the parameters of the model are listed in table  [ t.astero:hd49385 ] .",
    "we set @xmath201 and use the gn98 solar abundances .",
    "our results can be best compared to those listed as `` low @xmath202 '' and `` gn93 '' in table 4 of @xcite and agree within the uncertainties .",
    "rr @xmath203 & @xmath204 + @xmath205 & @xmath206 + @xmath207 & @xmath208 + @xmath68 & @xmath209 + @xmath124/k & @xmath210 + age / gyr & @xmath211 + @xmath33 & @xmath212 + @xmath213_i$ ] & @xmath214 + @xmath213_s$ ] & @xmath215 + @xmath216 & @xmath217 + @xmath218 & @xmath219 + @xmath195 & @xmath220 +      including the effect of composition gradients in the calculation of the brunt - visl  frequency is important for two reasons .",
    "first , it is necessary for implementing the ledoux criterion for convection , which is used to determine the chemical mixing and convective heat transport in a region ( see   [ s.semiconvection ] ) .",
    "second , a smooth and accurate method for calculating @xmath221 is crucial for studies of g - mode pulsation in stars . in a highly degenerate environment ,",
    "the pressure is nearly independent of temperature , and @xmath222 , so from eq .",
    "( [ n1 ] ) we see that @xmath223 depends on the difference of two large and nearly equal quantities .",
    "this can lead to a loss of precision and a noisy @xmath223 . to eliminate this problem ,",
    "@xmath221 is re - written into a form that depends on the difference of the adiabatic and true temperature gradients and on the composition gradient : @xmath224 the term @xmath225 explicitly takes into account the effect of composition gradients and is commonly called the ledoux term ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "for the general case of an @xmath12-component plasma with mass fractions @xmath226 , the standard formula for @xmath225 is ( e.g. , * ? ? ? * ) @xmath227 since @xmath228 , one of the mass fractions can be eliminated , so that the sum in eq .",
    "( [ bsum ] ) runs from 1 to @xmath229 .",
    "we note that the partial derivatives in eq .",
    "( [ bsum ] ) hold all the \\{@xmath230 } constant except for @xmath26 and @xmath231 , where @xmath231 is varied so as to maintain @xmath228 .",
    "although eq .",
    "( [ bsum ] ) is correct as written , we have developed a new , formally - equivalent prescription that is both numerically robust and simpler to implement .",
    "we define a new ledoux term by taking a directional derivative along the radial composition gradient in the stellar model , @xmath232 the implementation of the above derivative typically involves the use of quantities on neighboring mesh points . using the subscript @xmath233 to denote the value of a given quantity on the @xmath233th mesh point ,",
    "we therefore have @xmath234 this is the form of the ledoux term that is implemented in ` mesa `  and we term it the `` new ledoux '' formulation . since ` mesa `  ensures that @xmath228 at each mesh point , this condition does not have to be separately enforced .",
    "this formulation requires just one numerical difference along @xmath235 that is consistent with the stellar model and equation of state . because ` mesa ` s eos does not directly supply the partial derivatives required for the formulation in eq .",
    "[ bsum ] , an implementation of that method would suffer in both accuracy and efficiency from having to do a large number of numerical differences .",
    "@xcite dealt with a similar problem by using a restricted form of eq .",
    "[ bsum ] that included only the helium composition gradient .",
    "they showed that for cases where their restricted form applied , it gave significantly better numerical results than an implementation of eq .",
    "[ n1 ] based on finite differences .",
    "figure  [ bvdiff ] shows that our new ledoux prescription ( grey heavy curve ) retains their good results compared to eq .",
    "[ n1 ] ( thin black curve ) while extending the applicability to cases that can not be dealt with using only helium gradients .",
    "we described the implementation of mixing - length theory ( mlt ) in paper  i , including the allowance for overshoot beyond the boundaries of the convective zones as determined by the standard schwarzschild condition , @xmath236 .",
    "overshooting is implemented via an exponential decay of the convective diffusion coefficient beyond the boundary of full convection , following : @xmath237 where @xmath238 is the diffusion coefficient at the convective border , @xmath239 is the distance from the start of overshoot , and @xmath240 is the local pressure scale height .",
    "the user - adjusted dimensionless parameter @xmath241 then determines the extent of the overshooting region .",
    "` mesa `  also allows for the adoption of a step - function overshooting model , where the mixing region extends a distance @xmath242 beyond the convective boundary with a constant specified diffusion coefficient .    in paper",
    "i we did not implement the influence of composition gradients on mixing and the resulting diffusion coefficients when instabilities are operative . the description of how ` mesa `  ` star `  calculates the ledoux criterion is in  [ s.ledoux ] . in this section ,",
    "we describe the implementation of mixing due to composition gradients in stellar interiors .",
    "we refer to  [ s.nuts-free-parameters ] for a discussion of the free parameters involved in the implementation of these mixing mechanisms .",
    "semiconvection refers to mixing in regions unstable to schwarzschild but stable to ledoux , that is @xmath243 where @xmath244 is the sum of the adiabatic gradient and the brunt composition gradient term ( see eqs .",
    "[ [ bled ] ] and [ [ new ] ] ) , @xmath245 once @xmath244 is calculated , regions satisfying equation ( [ eq : ledoux_stable ] ) undergo mixing via a time - dependent diffusive process with a diffusion coefficient calculated by the ` mlt ` module following , @xmath246 where @xmath247 is the radiative conductivity , @xmath44  is the specific heat at constant pressure , and @xmath34  a dimensionless efficiency parameter .",
    "see  [ s.nuts-free-parameters ] for a discussion of the range of values for @xmath248 .",
    "we stress that semiconvection and overshooting have distinct implementations in ` mesa ` .",
    "both are time - dependent diffusive processes . as an example , in figure [ 3m_grad_dmix ] we display profiles of thermodynamic gradients and their resulting diffusion coefficients during core helium burning in a semiconvective model with @xmath249 and in an exponentially overshooting model with @xmath250 .",
    "sample profiles of semiconvective ( left ) and exponentially overshooting ( right ) @xmath251 models undergoing core helium burning .",
    "top panels show the radiative , adiabatic , temperature , and ledoux gradients that determine mixing boundaries and diffusion coefficients .",
    "bottom panels show the resulting diffusion coefficients for energy and chemical transport . in either case",
    ", a thin dotted line spanning a single intermediate cell joins the convective and semiconvective / overshoot curves .",
    "this is intended merely as a guide for the eye , as diffusion coefficients are defined only at the two boundaries of a cell . in particular ,",
    "diffusion for this intermediate cell is governed by convection at its interior boundary and semiconvection / overshoot at the exterior .",
    "the semiconvective model shown here was run with @xmath249 ; the exponentially overshooting model with @xmath250 .",
    "the profiles are taken at the points marked in figure [ 3m_he_burn_mixing ] . ]",
    "thermohaline mixing arises in the presence of an inversion of the mean molecular weight in regions that are formally stable against convection according to the ledoux criterion , @xmath252 in ` mesa `  thermohaline mixing is treated in a diffusion approximation , with a diffusion coefficient motivated by the linear stability analysis of @xcite and @xcite @xmath253 the quantity @xmath35  is a dimensionless efficiency parameter . in the linear analysis it depends on the aspect ratio of the blobs / fingers arising from the instability . in the case of salt fingers such a value",
    "is calibrated using laboratory experiments in water ( e.g. * ? ? ?",
    "* ) , where the fingers have an aspect ratio of @xmath254 . in the stellar case",
    "the value of this parameter is vexatious ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , with recent 2d and 3d hydrodynamical calculations pointing toward a much reduced value of @xmath35  relative to the salt fingers case @xcite .",
    "figure [ f.thermohaline ] shows a calculation including the effects of thermohaline mixing during the rgb phase of a @xmath255 star after the luminosity bump ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . for this calculation a value",
    "@xmath256 has been adopted , but see ",
    "[ s.nuts-free-parameters ] for a discussion of the range of options .",
    "the duration of the hydrogen and helium core burning depends on the extent of the convective core , so we focus here on exhibiting the ` mesa `  capabilities during these phases . as we noted above , there are many physical effects that change the size of the convective core , such as semiconvection , overshooting , and rotation - induced mixing .",
    "for example , the schwarzschild criterion implies larger cores than the ledoux criterion , but when using ledoux alone , the region above the convective boundary is overstable and so semiconvection occurs ( see  [ s.semiconvection ] ) .",
    "we evolved a non - rotating @xmath257 star with @xmath258 through central hydrogen burning using ledoux , ledoux plus semiconvection , schwarzschild , and schwarzschild plus overshoot .",
    "as is evident in figure [ 1p5m_main_sequence_mcc ] , this set of physical processes leads to a large range of convective core masses and thereby main sequence lifetimes . for the parameters",
    "explored we found that overshooting increases the lifetime by a factor @xmath2591.2 for schwarzschild and @xmath2592.5 for ledoux .",
    "figure [ 1p5m_main_sequence_hrd ] shows an hr diagram for each of the @xmath257 models undergoing core hydrogen burning , showing the impact of convective core extent on main - sequence turnoff morphology .",
    "history of convective core extent during the main sequence for a non - rotating @xmath257 star with various mixing options .",
    "the plot shows the boundary of convection not including the extent of semiconvection or overshooting . ]",
    "the hr diagram for the non - rotating @xmath257 star with various mixing options .",
    "tracks are displayed from zams until depletion of core hydrogen to @xmath260 . ]",
    "we also evolved a non - rotating @xmath261 star with @xmath262 through central helium burning .",
    "overshooting extends the burning lifetime by a factor @xmath2631.6 for schwarzschild and @xmath2632.8 for ledoux .",
    "although this lengthening of the core burning phase is always true of convective overshoot , we find that the extension of the overshoot and convective regions is sensitive to the temporal resolution adopted . with sufficiently large values of @xmath54",
    "the upper boundary develops oscillatory behavior which can also affect the lifetime .",
    "this behavior also occurs with the step - function implementation of overshoot .",
    "this instability is not seen in overshoot during hydrogen burning and has yet to be studied in detail .",
    "history of convective core extent during the core helium burning phase for a non - rotating @xmath261 star with various mixing options , as in figure  [ 1p5m_main_sequence_mcc ] .",
    "time is measured relative to the onset of the convective core burning .",
    "efficient semiconvection ( @xmath249 ) and inefficient overshooting ( @xmath250 ) coincide with the pure schwarzschild model .",
    "the filled ( open ) circle indicates the time for which we display a profile detailing semiconvection ( overshooting ) in figure [ 3m_grad_dmix ] . ]",
    "extending the verification of paper  i , we now compare to other available codes for intermediate - mass stars , @xmath0 . we describe the techniques used by ` mesa `  `",
    "star `  to evolve stars through the agb phase to the white dwarf cooling sequence .",
    "we also demonstrate how ` mesa `  ` star `  incorporates compressional heating from accretion .",
    "we start by comparing the results of ` mesa `  ` star `  to those from the dartmouth stellar evolution program ( dsep ; @xcite ) for stars with @xmath264 . in both cases ,",
    "the models were evolved from the pre - main sequence to the depletion of helium in their cores . for completeness ,",
    "the ` mesa `  ` star `  models were further evolved to the occurrence of the first helium thermal pulse .",
    "all models have an initial composition @xmath265 , @xmath144 , and no mass loss or rotation was included .",
    "the boundaries of mixing zones are determined by the schwarzschild criterion with @xmath145 . in order to compare the codes",
    ", we do not allow overshooting or semiconvection .",
    "we adopt the @xcite rate for @xmath266@xmath267@xmath268 and the @xcite rate for @xmath269@xmath270@xmath271 ; for all other rates we use the nacre compilation @xcite .",
    "we use the opal type 2 opacity tables ( @xcite ) to account for the carbon- and oxygen - enhanced opacities during helium burning .",
    "the resulting tracks in the hr diagram of figure [ fig : mesa_vs_dsep_hrd ] and the evolution in the @xmath97-@xmath90  plane of figure [ fig : mesa_vs_dsep_tc - rhoc ] show excellent agreement between the codes .",
    "figures [ fig : mesa_vs_dsep_4 m ] and [ fig : mesa_vs_dsep_6 m ] show the hydrogen - burning luminosity , the helium - burning luminosity , and the extent of the convective core during convective helium core burning for a @xmath272 model ( fig .",
    "[ fig : mesa_vs_dsep_4 m ] ) and a @xmath273 model ( fig .",
    "[ fig : mesa_vs_dsep_6 m ] ) .",
    "table  [ mesa_dsep_table ] gives a summary of the core hydrogen burning lifetime , the core helium burning lifetime , the final extent of the convective core during central helium burning , and the final carbon mass fraction @xmath274 in the core for each model .",
    "for the ` mesa `  models , we also show the maximum extent of the convective core during central hydrogen burning , the mass of the helium core before helium ignition , and the mass of the c / o core at the time of the first helium thermal pulse .",
    "hertzsprung - russell diagram for evolution of @xmath275 stars from the pre - main sequence through core helium depletion .",
    "models are from ` mesa `   ( thick grey lines ) and dsep  ( dashed black lines ) .",
    "each curve is labeled with its corresponding initial mass in solar units . ]",
    "same as fig .",
    "[ fig : mesa_vs_dsep_hrd ] , but in the @xmath97-@xmath90  plane . the ` mesa `   models ( thick grey lines ) are evolved until the occurrence of the first thermal pulse . ]",
    "history of hydrogen burning luminosity ( top ) , helium - burning luminosity ( center ) , and convective core extent ( bottom ) during the core helium burning phase for the @xmath272 models .",
    "time is measured relative to the onset of the convective core . ]",
    "history of hydrogen burning luminosity ( top ) , helium - burning luminosity ( center ) , and convective core extent ( bottom ) during the core helium burning phase for the @xmath273 models .",
    "time is measured relative to the onset of the convective core . ]",
    "rrrrrrrrrrrrr 3.0 & 320.6 & 0.69 & 0.36 & 83.59 & 0.097 & 0.426 & 0.466 & & 312.0 & 80.81 & 0.098 & 0.456 + 4.0 & 152.7 & 1.01 & 0.47 & 29.78 & 0.149 & 0.490 & 0.667 & & 147.3 & 28.91 & 0.153 & 0.516 + 5.0 & 85.61 & 1.34 & 0.59 & 15.52 & 0.214 & 0.511 & 0.827 & & 84.75 & 15.19 & 0.210 & 0.507 + 6.0 & 55.98 & 1.68 & 0.72 & 9.62 & 0.288 & 0.514 & 0.870 & & 55.41 & 9.61 & 0.289 & 0.505 + 7.0 & 39.91 & 2.03 & 0.86 & 6.51 & 0.375 & 0.511 & 0.915 & & 39.69 & 6.79 & 0.401 & 0.454 + 8.0 & 30.42 & 2.40 & 1.02 & 4.67 & 0.480 & 0.504 & 0.966 & & 30.26 & 4.71 & 0.482 & 0.515 +    we close with an additional comparison of the helium core burning phase of a @xmath276 , @xmath144 model computed by ` mesa `  to that of @xcite .",
    "both models were evolved using the @xcite rate for @xmath266@xmath267@xmath268 .",
    "the results for ` mesa `  ` star `  are a helium core burning lifetime of 83.6  myr and final c / o mass fractions of @xmath277 , @xmath278 ; @xcite find a lifetime of 88  myr and @xmath279 , @xmath280 .      in the previous section , we discussed the evolution of @xmath275 stars up to the occurrence of the first he thermal pulse .",
    "in paper  i  we showed detailed comparisons of the evolution of a @xmath281 star to the evol code @xcite , exhibiting the ability of ` mesa `  ` star `  to calculate multiple helium shell pulses .",
    "we now illustrate the final evolution of intermediate - mass stars , and how to construct white dwarfs ( wds ) by using winds .",
    "we evolve @xmath261 , @xmath282 , and @xmath283 stars from the zams using the test suite case ` make_co_wd ` .",
    "this makes use of rgb mass loss following @xcite with an efficiency parameter @xmath284 and agb mass loss following using @xmath285 until the occurrence of the first helium shell flash . at that time",
    ", an increased bloecker @xmath286 is adopted to allow only a small number of thermal pulses before the wind mass loss eliminates the envelope .",
    "such intervention allows ` mesa `  ` star `  to make a high - mass wd . to avoid shortening of timesteps due to radiation - dominated envelopes",
    ", these cases also use the mlt++ capability described in ",
    "[ s.superadiabatic ] .",
    "figure [ fig:357_zams_to_wd_hr ] shows the resulting tracks on the hr diagram .",
    "the @xmath261 star underwent eight thermal pulses after the enhancement of bloecker winds , while the @xmath282 and @xmath283 stars lost their envelopes so quickly that thermal pulses were immediately halted . the @xmath282 star ended up as an @xmath287 c / o wd with a helium shell of thickness @xmath288 and a hydrogen envelope of @xmath289 .",
    "note that the c / o wd mass is only slightly larger than the c / o mass at the first thermal pulse ( @xmath290 ) reported in table [ mesa_dsep_table ] .",
    "evolution of @xmath291 , @xmath292 and @xmath283 models from zero - age main sequence to cooling white dwarfs .",
    "a bloecker mass loss strips the stars of their envelopes on the thermally pulsing agb to make the three c / o white dwarfs .",
    "the single @xmath293 he white dwarf was made with mass loss after the hydrogen main sequence for the @xmath261 model was completed . ]    profiles in @xmath294-@xmath295 space of the cooling @xmath296 c / o white dwarf evolved from a @xmath282 progenitor .",
    "each model is labeled to the right by @xmath98 .",
    "the outermost point of the model is at @xmath297 .",
    "dotted curves denote convective regions .",
    "going toward the interior , open circles designate the transition into the helium - rich shell , and filled circles designate the transition into the c / o core . ]",
    "surface luminosity as a function of central temperature for the cooling @xmath298 , @xmath299 , @xmath300 , and @xmath301 wds evolved from @xmath291 , @xmath292 , and @xmath283 progenitors . ]    after removal of the envelope , the evolution of the white dwarf is continued through its cooling phase past solidification .",
    "we include gravitational settling and chemical diffusion of the outermost layers .",
    "figure [ fig : co_wd_from_5m_trho ] shows @xmath302@xmath17 profiles taken at various effective temperatures during the cooling of the @xmath287 c / o wd made from the @xmath282 star .",
    "the growing depth of the convection zone is shown by the dashed line , and the open circles designate the h / he transition , while the filled circles denote the he / co transition .",
    "figure  [ fig:357_cool_l_tc ] illustrates the resulting @xmath9-@xmath97  relation as these models cool .    the test suite case ` wd_diffusion ` uses the implementation of diffusion described in paper  i  to evolve a wd of mass @xmath303 until the @xmath304 hydrogen layer and the @xmath305 helium layer approach diffusive equilibrium . at this point",
    ", the wd has an effective temperature of @xmath306 .",
    "we show the resulting abundance profiles in figure  [ wddiffuse ] , and , for comparison , the abundance profiles derived from the analytic form for diffusive equilibrium ( eq .",
    "( 22 ) of * ? ? ?",
    "this formula is obtained by integrating equation ( a.5 ) of @xcite and assuming an ideal gas equation of state and complete ionization of both species .     a comparison of time - dependent diffusion calculations for a @xmath307 wd with @xmath308 and @xmath309 with ` mesa `  ` star `",
    "( solid lines ) to those assuming diffusive equilibrium and an ideal gas equation of state ( dashed lines ) .",
    "]    the specific treatment of convection can also impact wd evolution . in paper",
    "i , ` mesa `  used the @xcite prescription for convection as its default convective mlt , with the optional extension of @xcite . since paper  i",
    ", we have added support for the formulations of @xcite , @xcite , and @xcite . in particular , the bhm & cassinelli prescription , often referred to as `` ml2 , '' is frequently employed in wd studies ( e.g. , * ? ? ?",
    "* ) . in figure  [ wdconv ]",
    "we show a comparison of the brunt - visl frequency  calculated with ` mesa `  to that using the warsaw envelope code @xcite , assuming the ml2 prescription .",
    "this is the same wd as in figure [ wddiffuse ] , but now at a lower @xmath310 .",
    "to more accurately integrate these opaque but thin layers , we reduce @xmath21 at the boundary of the model by a factor of 1000 from its photospheric value of @xmath311 .",
    "this calculation is a sensitive test of the envelope integrations because @xmath221 is a derivative of the envelope structure .",
    "the two codes give indistinguishable results for this case and all other cases that we have calculated .",
    "` mesa `  now includes atmospheric tables based on the non - grey model atmospheres for hydrogen - atmosphere wds @xcite , spanning the following range of parameters : @xmath312 and @xmath313 .",
    "such an approach is necessary at @xmath314 , where wds develop deeper convection zones .",
    "when the convection zone comes in contact with the degenerate , nearly isothermal core , energy is able to flow out of the core much more efficiently .",
    "the use of non - grey atmosphere models results in shallower convection zones , so this convective coupling of the core and envelope is delayed . for reliable cooling ages",
    ", we therefore recommend using non - grey atmospheres when @xmath314 .",
    "figure  [ age_diff ] demonstrates the impact of non - grey atmospheres with the @xmath303 wd , which was cooled with and without the non - grey atmosphere .",
    "` mesa `  currently treats crystallization by employing the @xcite eos ( pc eos ) .",
    "the pc eos is callable for arbitrary mixtures of chemical species and for densities with @xmath315 ; it is applicable in the domains of non - degenerate and degenerate , non - relativistic and relativistic electrons , weakly and strongly coupled coulomb liquids , and classical and quantum coulomb crystals .",
    "the phase transition is first - order , so the pc eos exhibits a latent heat between the solid and liquid phases , i.e. , the entropy and internal energy both experience finite jumps .",
    "this energy is included in ` mesa `  ` star `  models of cooling white dwarfs through the gravitational source term in the energy equation , @xmath316 this form for @xmath50  replaces the default one ( see eq .",
    "( [ eq : eps_grav_lnd ] ) below ) in cells where @xmath317 ( @xmath7 is the coulomb coupling parameter ) , and is smoothly interpolated with the default form in cells where @xmath318 .",
    "the pc eos uses the criterion @xmath319 to determine crystallization , but it is straightforward to include explicit crystallization curves for c / o and other mixtures ( e.g. , * ? ? ? * ; * ? ? ?",
    "for example , using the parameters of the model in figure  [ wddiffuse ] , the age difference at late times ( @xmath320 ) between a model with and without the latent heat of crystallization is @xmath321 ; a slightly larger value would be obtained using the phase diagram of @xcite .",
    "` mesa `  does not currently treat phase separation of different chemical species upon crystallization .    low mass wds ( @xmath322 ) with helium cores and hydrogen envelopes may be produced in binary systems when the envelope is stripped by the companion as the primary evolves up the giant branch ( * ? ? ? * and references therein ) .",
    "he - core wds of mass @xmath323 may also be produced through strong rgb winds ( dcruz et al .",
    "1996 ) , although we do not discuss this possibility further here .    here",
    "we discuss the prescription for stripping the envelope used in the test case ` make_he_wd ` .",
    "the first step is to evolve a star , @xmath324 in this example , from the pms until a he core of the correct size has been made .",
    "the remnant total mass is determined by the mass interior to where the h abundance has dropped below a preset value , for example , @xmath325 , moving in from the surface .",
    "next , the routine ` relax_mass ` is used to remove mass from the model until it has the desired remnant mass .",
    "after the initial remnant has been constructed , diffusion can then be turned on to allow an outer h layer to form . after this stage ,",
    "normal evolution of the wd occurs , as shown in figures [ fig:357_zams_to_wd_hr ] and [ fig:357_cool_l_tc ] .",
    "accretion onto stars occurs in many contexts and requires special treatment for the outermost layers added in each timestep .",
    "in particular , a special evaluation of the @xmath326 term is required for fluid parcels that were not present in the previous timestep . prior to addressing that subtlety ,",
    "we restate ( as discussed in  6.2 of paper  i ) that ` mesa `  ` star `  calculates @xmath50  of eq .",
    "( [ epsent ] ) in terms of the local thermodynamic variables ( @xmath302 and @xmath17 ) used by ` mesa ` , @xmath327.\\ ] ] ` mesa `  ` star `  takes the quantities in this equation as provided by ` eos ` , and computes the lagrangian time derivatives to find @xmath50 . `",
    "mesa `  ` star `  can alternatively work under the assumption that @xmath328 , in which case ` mesa `  ` star `  treats @xmath87  rather than @xmath17 as its basic variable ( see  [ s.solve-burn-and-mix ] for a discussion ) . in that case ,",
    "@xmath329.\\ ] ] either formulation can be used deep within the star , as long as the location is safely removed from any phase transition .",
    "paper  i described the validation of these formulations .",
    "we now turn to the complication which arises when @xmath50  needs to be evaluated in material that was not present in the previous timestep . defining the envelope mass coordinate @xmath330 , we need to resolve the entropy for @xmath331 , as the explicit lagrangian time derivatives of eqs .",
    "( [ eq : eps_grav_lnd ] ) and ( [ eq : eps_grav_prho ] ) can not be numerically evaluated .",
    "since there can be important physics that needs to be resolved for these mass shells for @xmath332 , an approximation must be derived that allows for accurate modeling of the star s",
    "outermost layers without having to result to a dramatic shortening of @xmath99 .",
    "the luminosity @xmath333 from the accretion shock ( or boundary layer ) goes outwards and does not determine the entropy of the material as it becomes part of the hydrostatically adjusting star .",
    "rather , the entropy of the material at @xmath332 is determined by the the transport of @xmath9 ( @xcite ; @xcite ; @xcite ) .",
    "consider such an outermost layer , where there are two relevant timescales , the thermal time , @xmath334 , and the local accretion time , @xmath335 . in nearly all relevant cases , the ratio @xmath336",
    "; this implies that the fluid element adjusts its temperature to that needed to transport the stellar luminosity from deep within .",
    "this simplifies @xmath337 in that part of the star ( following @xcite ) to @xmath338 enabling accurate modeling within ` mesa `  ` star `  of nearly all fluid elements that become part of the star during each timestep , many of which have envelope mass coordinates @xmath339 .",
    "we give an explicit example of this thin - shell radiative calculation of @xmath50  in a c / o white dwarf accreting hydrogen - rich material and undergoing classical nova ( cn ) cycles .",
    "we present two models accreting at rates of @xmath340 and @xmath341 .",
    "both cases were evolved from a @xmath342 starting model with @xmath343 which had undergone a few flashes while accreting at @xmath340 .",
    "the accreted material has solar - like composition @xmath344 , @xmath345 , and @xmath346 where the metal mass fractions are taken from @xcite .",
    "profiles of the envelope during the mass accumulation phase between cn outbursts for the two accretion rates are displayed in figures [ co_wd_accrete_1d-11 ] and [ co_wd_accrete_1d-10 ] .",
    "each line represents a different time in the accumulation cycle up to the unstable ignition , when the hydrogen mass reaches @xmath347 .",
    "all material at pressures smaller than that shown by the open circle is new to the model in that timestep ( e.g. , it has @xmath348 ) and employs the modified @xmath50  of eq .",
    "( [ eq : eps_grav_thin_radiative ] ) .",
    "this highlights the significance of this approximation as it allows ` mesa `  ` star `  to calculate material properties at @xmath349 .",
    "the solid points show where @xmath50  switches to the explicit form employing the lagrangian time derivatives , such as eq .",
    "( [ eq : eps_grav_lnd ] ) .",
    "the middle panel shows @xmath350 , which reflects the contribution of @xmath50  to the outward luminosity .",
    "the discontinuity of @xmath50  at the solid point reflects the error associated with the abrupt transition in the calculational approach .",
    "the substantially larger luminosity of the early ( @xmath351 ) stages is due to the ongoing transfer of heat from the previous outburst .",
    "the near - discontinuous drop in @xmath50  occurs at the base of the hydrogen - rich envelope , and reflects the jump in composition from the accreted material to the nearly pure @xmath352  layer .",
    "the expected amplitude of the jump in @xmath50  depends on both the composition jump and the local degree of electron degeneracy ( see appendix b of @xcite for a discussion ) .",
    "envelope profiles as a function of pressure of the accreting white dwarf for three instants during the mass accumulation phase ; @xmath340 model .",
    "the top panel shows temperature , the central panel shows the gravitational energy release rate , and the bottom shows the luminosity .",
    "material to the right of the open circle is newly accreted .",
    "the code treats material to the right of the filled circle using the thin - shell radiative calculation of @xmath50 . ]",
    "same as fig .",
    "[ co_wd_accrete_1d-11 ] , but for model accreting @xmath341 . ]",
    "a star s rotational energy is usually a small fraction of the gravitational energy : for the sun it is @xmath353 and for a @xmath354 star rotating with a typical equatorial velocity @xmath355 on the main sequence it is @xmath356 .",
    "therefore the effects on the stellar hydrostatic equilibrium are marginal , with the exception of stars close to critical rotation ( see  [ s.rotation-mass-loss ] ) . even in the case of a small perturbation to hydrostatic equilibrium",
    ", rotation induces a modification to the star s thermal equilibrium @xcite .",
    "together with the emergence of rotationally - induced dynamical and secular instabilities , this can significantly affect the evolution of stars @xcite .",
    "due to the destabilizing effect of increasing radiation pressure , rotation is particularly important in massive stars ( see , e.g. , * ? ? ? * ; * ? ? ? * ) .",
    "moreover , the final fate of a massive star depends chiefly on the relative importance of rotation during its evolution ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    here",
    "we describe the implementation of rotation in ` mesa `  ` star ` .",
    "we briefly discuss the modification to the stellar structure equations and the inclusion of rotationally- and magnetically - induced mixing .",
    "magnetic fields generated by differential rotation in radiative regions have been implemented following the work of @xcite and in the same fashion as in @xcite and @xcite .",
    "rotationally enhanced mass loss is also discussed .",
    "we compare rotating massive - star models calculated with ` mesa `  ` star `  to previous calculations performed with kepler @xcite .",
    "we also directly compare runs from ` mesa `  ` star `  and stern  @xcite .",
    "the purpose of these tests is to verify our implementation of rotation , which is derived from stern .",
    "we do not compare to codes that have a different implementation of rotation ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "although beyond the scope of this paper , such comparisons are critical when coupled to observations of the effects of rotation in stars ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) including asteroseismology @xcite .",
    "stellar structure deviates from spherical symmetry in the presence of rotation .",
    "while the structure is inherently three - dimensional , it suffices to solve the stellar structure equations in one dimension if the angular velocity , @xmath84 , is constant over isobars ( the so - called shellular approximation ; see , e.g. , * ? ? ?",
    "this is expected in the presence of strong anisotropic turbulence acting along isobars . in radiative regions",
    "such turbulence is a consequence of differential rotation @xcite and efficiently erases gradients along isobars and enforces shellular rotation @xcite .",
    "turbulence in the vertical direction ( i.e. , perpendicular to the isobars ) is much weaker due to the stabilizing effect of stratification . in ` mesa `  ` star `  we adopt the shellular approximation @xcite and calculate the modification to the stellar equations due to centrifugal acceleration @xcite .",
    "an isobar with volume @xmath357 and surface area @xmath358 deviates from spherical symmetry in the presence of rotation .",
    "however one can retain a 1d approximation by re - defining the radius coordinate as the radius of a sphere containing the same volume @xmath359 , allowing an equation of continuity in the usual form @xmath360 with @xmath17 being the density and @xmath361 the mass enclosed by @xmath358 .",
    "the energy equation also retains its usual , non - rotating form @xmath362 where @xmath363 is the rate of energy flow through the equipotential surface @xmath358 .",
    "then the next step is to define mean values for the quantities varying on isobars , @xmath364 where @xmath365 is an isobaric surface area element .",
    "the equation of momentum balance can be written as @xmath366 where @xmath367 is the pressure , @xmath368 is the gravitational constant and @xmath369 the time . the last term in the equation is the inertia term .",
    "rotation enters the momentum equation through the quantity @xmath370 @xmath371 where @xmath372 , with @xmath373 the effective gravitational acceleration ( @xmath374 is normal to @xmath358 ) . then the radiative temperature gradient becomes @xmath375}}^{\\!-1 } \\;,\\ ] ] with @xmath376 the radiation constant",
    ", @xmath8 is the opacity , @xmath302 the temperature and @xmath363 , the energy flux through @xmath358 .",
    "the last factor on the right hand side accounts for inertia , and @xmath377 in rotating models the values of @xmath378 and @xmath370 differ from 1 mostly in the outer stellar layers .",
    "limits to the minimum values of @xmath378 and @xmath370 are set in the code ( default values are 0.95 and 0.75 , respectively ) .",
    "this prevents numerical instabilities in models approaching critical rotation ( @xmath379 , see  [ s.rotation-mass-loss ] ) . in such cases",
    "the outer layers greatly deviates from spherical symmetry and the results from 1d calculations should be considered particularly uncertain .",
    "transport of angular momentum and chemicals due to rotationally - induced instabilities is implemented in a diffusion approximation ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this choice has also been adopted by other stellar evolution codes ( e.g. , kepler , @xcite ; stern , @xcite ) .",
    "we stress that this is not the only possibility , and other groups have implemented a diffusion - advection approach ( e.g. , geneva , @xcite ; rose , @xcite ) . the rose code can switch between the two different implementations .",
    "the two approaches are equivalent for the transport of chemicals .",
    "potentially large differences can arise , however , for the transport of angular momentum .",
    "a detailed description of the advection - diffusion equation for angular momentum is given in @xcite and @xcite .",
    "in ` mesa `  ` star `  the turbulent viscosity @xmath14 is determined as the sum of the diffusion coefficients for convection , semiconvection , and rotationally - induced instabilities . in convective regions ,",
    "the very large diffusion coefficient implies that the rotation law is not far from solid body .",
    "this is a very common assumption in stellar evolution codes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) ; note however that helioseismology has clearly shown this is not the case for the solar convection zone ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "` mesa `  ` star `  calculates diffusion coefficients for five different rotationally - induced mixing processes : dynamical shear instability , solberg - hiland instability , secular shear instability , eddington - sweet circulation , and the goldreich - schubert - fricke instability .",
    "see @xcite for a detailed description of the physics of the different instabilities and the calculation of the respective diffusion coefficients .",
    "these enter the angular momentum and abundance diffusion equations that are solved at each timestep ( see  [ s.nuts-rotation ] ) .",
    "it has been suggested that differential rotation in the radiative layers of a star can amplify a seed magnetic field .",
    "such a dynamo process has been proposed by ( * ? ? ?",
    "* spruit - tayler dynamo ) ; a theoretical debate on this is still ongoing @xcite . from the observational point of view",
    ", pure hydrodynamic models fail to predict the solar core rotation ( e.g. , * ? ? ?",
    "* ) , with the exception of models that include transport of angular momentum by gravity waves @xcite .",
    "models that include the spruit - tayler dynamo can reproduce the flat rotation profile of the sun .",
    "note however that these have difficulty explaining the core - envelope decoupling observed in low - mass , young cluster stars @xcite .",
    "on the other hand , observations of the final spins of both wds and neutron stars @xcite suggest that angular momentum transport with an efficiency similar to the torques provided by the spruit - tayler dynamo operates .",
    "models that only include angular momentum transport through rotational instabilities do not produce the core - envelope ratio of angular velocity observed through the splitting of mixed modes in red giant stars @xcite .",
    "` mesa `  ` star `   accounts for transport by magnetic fields of angular momentum and chemicals due to the spruit - tayler dynamo .",
    "we refer to @xcite for a description of the physics of the dynamo loop and to @xcite , @xcite and @xcite for a discussion of its inclusion in stellar evolution codes .",
    "we implement the spruit - tayler dynamo in ` mesa `  ` star `  following kepler @xcite and stern @xcite .",
    "rotating stars that have a significant outer convective zone can produce surface magnetic fields through a dynamo ( see e.g. , * ? ? ?",
    "* for a review on astrophysical dynamos ) .",
    "this is the case for low - mass main sequence stars below about 1.5  @xmath380 , and observationally the break in the rotation properties around this mass is attributed to the presence of magnetized stellar winds ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "note that dynamo action in a subsurface convective layer is in principle possible also in early - type stars @xcite .",
    "surface magnetic fields can also be of fossil origin , as is usually discussed in the context of ap stars @xcite .",
    "whatever the origin of surface magnetic fields , these are expected to couple to the wind mass - loss and , if strong enough , produce magnetic braking ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    ". such magnetic braking has been directly observed in the case of the main sequence massive star @xmath200-ori e @xcite .",
    "here we do not include the physics of magnetic braking , as we only consider the evolution of stars without surface magnetic fields .",
    "we include the rotational modification to the wind mass loss rate @xcite . similar to other codes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , in ` mesa `  ` star `   the stellar mass loss is enhanced as the rotation rate increases according to the prescription @xmath381 where @xmath382 is the value of the surface angular velocity and @xmath383 is the critical angular velocity at the surface .",
    "this last quantity is defined as @xmath384 , where @xmath385 is calculated as a mass - weighted average in a user - specified optical depth range ( default value @xmath386 $ ] ) . in ` mesa `  ` star `  the default value for the exponent @xmath387 is 0.43 @xcite .",
    "other implementations of rotationally enhanced mass loss can be found in @xcite and @xcite .    for stars approaching @xmath379 ,",
    "the mass loss calculated using equation ( [ mdotomega ] ) diverges .",
    "notice that luminous stars can approach this limit without having to rotate very rapidly as @xmath388 when @xmath389 .",
    "following @xcite we limit the mass loss timescale to the thermal timescale of the star @xmath390 @xmath391\\ ] ] where @xmath392 is an efficiency factor of order unity ( default value is @xmath393 ) .      in all the rotating models presented in this paper , rotation",
    "is initialized by imposing a solid body rotation law on the zero - age main sequence ( zams , @xmath394 ) . in these massive stars",
    "this is motivated by the presence of rotationally - induced angular momentum transport during the pre - main sequence evolution .",
    "this alone is able to enforce a state of close - to - rigid rotation by the time the star reaches the zams @xcite .",
    "overall initial solid body rotation is a common choice in stellar evolution codes , but other rotational laws are certainly possible .        *",
    "15mag includes the effects of rotation and spruit - tayler magnetic fields on both the transport of chemicals and angular momentum . *",
    "15rot includes only the effect of rotation on both the transport of chemicals and angular momentum ;    the initial conditions have been calibrated to match as closely as possible the kepler @xmath395 models @xcite .",
    "moreover , we directly compare the ` mesa `  ` star `  models with calculations from stern ( see e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "in particular we adopt a value of @xmath396 for the ratio of the turbulent viscosity to the diffusion coefficient and a value @xmath397 for the sensitivity to @xmath398-gradients ( see * ? ? ?",
    "* for a discussion of these calibration parameters ) .",
    "the ledoux criterion is used for the treatment of convective boundaries , together with semiconvection ( @xmath399 ) .",
    "we use @xmath400 , mass loss as in @xcite with rotational enhancement as described in   [ s.rotation-mass-loss ] .    in fig .",
    "[ fig : hrdfig15 ] we show the evolutionary track and the evolution of surface equatorial rotational velocity for the 15mag model .",
    "results of a similar calculation using stern are shown as a dashed curve .",
    "the two results are in excellent agreement .",
    "small differences in luminosity and lifetimes are not unexpected , as we have only matched the physics of rotation between the two calculations and not other ingredients .",
    "values for the diffusion coefficients for rotationally induced mixing and magnetic torques during the main sequence of 15mag are shown in fig .",
    "[ fig : msfig15 ] .",
    "the comparison reveals a very good agreement .",
    "both stars are kept in solid - body rotation during the main sequence by the efficient transport of angular momentum provided by the eddington - sweet circulation and spruit - tayler magnetic fields .    the amplitude and location of the azimuthal ( @xmath401 ) and radial ( @xmath402 ) components of the magnetic fields during different phases of the evolution of 15mag",
    "are shown in fig .",
    "[ fig : bfig15 ] .",
    "as expected , these fields are generated only in radiative regions of the star and @xmath403 @xcite .",
    "as the star evolves away from the main sequence its structure departs from solid - body rotation with the core rotating faster than the envelope . during this stage",
    "the role of magnetic fields is very important in transporting angular momentum from the core to the envelope .",
    "the effect can be seen in fig .",
    "[ fig : jfig15 ] , which shows the evolution of the internal specific angular momentum in models 15rot and 15mag .",
    "the presence of magnetic torques results in a dramatic spin - down of the core of 15mag with respect to 15rot ( see also table  [ tab:15evo ] ) .",
    "these results are in very good agreement with the ones obtained by stern and kepler .       to address this issue we have created the ` mesa `  software development kit ( ` sdk ` ) , which packages everything necessary to establish a unified and maintained build environment .",
    "the principal components of the ` sdk `  are summarized in table  [ tab : sdk ] ; all of these are distributed under an open - source license ( detailed in the table ) , permitting their redistribution without financial or copyright encumbrances .",
    "perhaps the most important component is the gfortran compiler , part of the gnu compiler collection .",
    "gfortran implements almost all of the fortran 2003 ( f2003 ) standard , and benefits from a high level of community support .",
    "the ` sdk `  is available for intel x86 and x86 - 64 cpu architectures running the linux and mac os x operating systems ( these platforms comprise most of the ` mesa `  user base ) .",
    "installation of the kit is straightforward , requiring a tar archive to be unpacked ( linux ) or an application folder to be copied ( os x ) , followed by the initialization of a few environment variables . by default , ` mesa `  is configured to compile `` out - of - the - box '' with the ` sdk ` .",
    "` mesa `  can also be compiled without the ` sdk ` , using any alternate compiler which supports the f2003 standard . in this respect",
    ", gfortran should not be viewed as _",
    "the _ ` mesa `  compiler ( nor the full ` sdk `  as _ the _ ` mesa `  build environment ) . `",
    "mesa `  will adhere to fortran standards rather than rely on vendor - specific extensions .",
    "uptake of the ` sdk `  has been very rapid : at the time of writing , we estimate over 90% of the ` mesa `  community ( over 500 users ) are using the ` sdk ` .",
    "this growth has been matched by a significant decline in the number of installation support requests , and a corresponding reduction in the time taken to resolve these requests . with these maintenance overheads curbed , the ` mesa `  developers are able to devote more of their time to refining and extending the code ."
  ],
  "abstract_text": [
    "<S> we substantially update the capabilities of the open source software package modules for experiments in stellar astrophysics ( ` mesa ` ) , and its one - dimensional stellar evolution module , ` mesa `  ` star ` . </S>",
    "<S> improvements in ` mesa `  ` star ` s ability to model the evolution of giant planets now extends its applicability down to masses as low as one - tenth that of jupiter . the dramatic improvement in asteroseismology enabled by the space - based _ kepler _ and _ corot _ missions motivates our full coupling of the adipls adiabatic pulsation code with ` mesa `  ` </S>",
    "<S> star ` . </S>",
    "<S> this also motivates a numerical recasting of the ledoux criterion that is more easily implemented when many nuclei are present at non - negligible abundances . </S>",
    "<S> this impacts the way in which ` mesa `  ` star `  calculates semi - convective and thermohaline mixing . </S>",
    "<S> we exhibit the evolution of @xmath0 stars through the end of core he burning , the onset of he thermal pulses , and arrival on the white dwarf cooling sequence . we implement diffusion of angular momentum and chemical abundances that enable calculations of rotating - star models , which we compare thoroughly with earlier work . </S>",
    "<S> we introduce a new treatment of radiation - dominated envelopes that allows the uninterrupted evolution of massive stars to core collapse . </S>",
    "<S> this enables the generation of new sets of supernovae , long gamma - ray burst , and pair - instability progenitor models . </S>",
    "<S> we substantially modify the way in which ` mesa `  ` star `   solves the fully coupled stellar structure and composition equations , and we show how this has improved the scaling of ` mesa ` s calculational speed on multi - core processors . </S>",
    "<S> updates to the modules for equation of state , opacity , nuclear reaction rates , and atmospheric boundary conditions are also provided . </S>",
    "<S> we describe the mesa software development kit ( ` sdk ` ) that packages all the required components needed to form a unified , maintained , and well - validated build environment for ` mesa ` . </S>",
    "<S> we also highlight a few tools developed by the community for rapid visualization of ` mesa `  ` star `  results . </S>"
  ]
}