{
  "article_text": [
    "density functional theory ( dft )  @xcite has become the basis of much computational materials science today , thanks to its predictive accuracy in describing ground - state properties directly from first principles .",
    "while dft is in principle exact , in any practical implementation it requires an educated guess for the exact form of the energy functional . for many years , local or semi - local approximations to the exchange - correlation energy , such as the local density approximation ( lda )  @xcite or the generalized gradient approximation",
    "@xcite have been successfully applied to a wealth of different systems  @xcite . still , these approximations lead to some dramatic failures , including the overestimation of dielectric response , incorrect chemical barriers for reactions involving strongly - localized orbitals  @xcite , energies of dissociating molecular species , and excitation energies of charge - transfer complexes , to name a few  @xcite .",
    "key to these failures is the self - interaction error of approximate dft  @xcite , where the electrostatic and exchange - correlation contributions to the effective energy of the entire charge distribution are not `` purified '' from this spurious self interaction of an individual electron with itself . to address this issue , perdew and zunger ( pz ) introduced first an elegant solution to this problem , where a self - interaction correction ( sic ) is added to the total energy calculated from approximate dft ( e.g. within the lda  @xcite ) , but practical applications have remained scarce  @xcite .",
    "an important property of dft with local or semi - local exchange - correlation functionals is the invariance of the total energy with respect to unitary transformation of the occupied electronic states .",
    "however , sic - dft does not have this invariance property , and in fact finding the optimal unitary transformation given a set of orbital wavefunctions is crucial to the numerically consistent minimization of density functionals with sic  @xcite . in this paper , we focus on the variational minimization of energy functionals that do not satisfy unitary invariance in order to provide a stable , robust , and efficient determination of the electronic structure in this challenging case .",
    "in particular , we adopt the formulation of ensemble dft  @xcite to decouple the variational minimization into an inner loop of unitary transformations and an outer loop of evolution for the occupied manifold , and suggest optimal strategies for the dynamics of unitary transformations . in the solid - state limit , this dynamics gives rise to a localized wannier representation for the electronic states , and we assess their relation with maximally localized wannier functions ( mlwfs )  @xcite as obtained in the absence of sic .    the remainder of the paper is organized as follows . in sec .",
    "ii , dft with sic is briefly reviewed , the method of inner - loop minimization is explained , and the issue of using mlwfs as an initial guess for the wavefunctions is discussed . in sec .",
    "iii , we present and discuss the results .",
    "first , we present results on how the total energy varies with the unitary transformation of the occupied electronic states .",
    "second , we discuss the stability and efficiency of our method for inner - loop minimization . finally , we show how the calculated total energy converges both as a function of the outer - loop iterations and as a function of the cpu time and discuss the optimal scheme for total energy minimization of energy functionals with sic .",
    "we then summarize our findings in sec .",
    "for simplicity , we consider in the following the wavefunctions to be real ; however , the discussion can straightforwardly be extended to complex wavefunctions .",
    "the total energy of the interacting electron system from kohn - sham dft within the lda is given by  @xcite @xmath0\\nonumber\\\\ & & = -\\sum_{\\sigma}\\sum_{i=1}^n\\frac{1}{2}\\int\\psi_{\\sigma i}({\\bf r})\\nabla^2 \\psi_{\\sigma i}({\\bf r})\\,d{\\bf r } + \\int v_{\\rm ext}({\\bf r})\\rho({\\bf r})d{\\bf r } \\nonumber\\\\ & & + \\frac{1}{2}\\int\\int\\frac{\\rho({\\bf r})\\rho({\\bf r}')}{|{\\bf r}-{\\bf r}'|}\\ , d{\\bf r}\\,d{\\bf r } ' + \\int\\epsilon_{\\rm xc}^{\\rm lda}(\\rho({\\bf r}))\\,\\rho({\\bf r})d{\\bf r}\\ , , \\label{eq : e_lda}\\end{aligned}\\ ] ] where @xmath1 is the spin index , the band index @xmath2 runs through the @xmath3 occupied electronic states , and @xmath4 is the total charge density . the first term on the right hand side of eq .",
    "( [ eq : e_lda ] ) is the kinetic energy , the second term the interaction energy between electrons and the ion cores , the third term the hartree interaction energy , and the last term the exchange - correlation energy .",
    "this energy functional @xmath5 $ ] is invariant under the following unitary transformation @xmath6 for an arbitrary unitary matrix @xmath7 since the total charge density @xmath8 and the kinetic energy [ eq .",
    "( [ eq : e_lda ] ) ] are invariant under this transformation .",
    "given that the wavefunctions are real , we consider @xmath9 to be an orthogonal matrix , i.e. , real and satisfying @xmath10 where @xmath11 is the @xmath12 identity matrix .    for some density functionals with sic  @xcite , the total energy @xmath13 $ ]",
    "is given by @xmath14=e_{\\rm lda}[\\{\\psi_{\\sigma i}\\ } ] + e_{\\rm sic}[\\{\\rho_{\\sigma i}\\}]\\ , , \\label{eq : e_total}\\ ] ] where @xmath15 .",
    "@xmath16 $ ] and hence @xmath13 $ ] are in general not invariant under orthogonal transformations because they are dependent not only on the total charge density @xmath8 , which is invariant under orthogonal or unitary transformation , but also on the charge densities , @xmath17 s , arising from different orbitals .",
    "this can be seen by considering how the sic energy varies under the orthogonal transformation of eq .",
    "( [ eq : u ] ) . to this end",
    ", it is useful to recall that an orthogonal matrix @xmath7 can be written as @xmath18 where @xmath19 is an antisymmetric matrix ; if we further consider the case where the norm of @xmath19 is much less than that of an identity matrix , we can assume @xmath20 therefore , the transformed wavefunctions are given by @xmath21 from which @xmath22 and ( using the antisymmetry of @xmath19 ) @xmath23 finally , if we define the sic potential @xmath24 we obtain the gradient of sic energy with respect to the transformation matrix elements @xmath25 \\psi_{\\sigma j}({\\bf r})\\,d{\\bf r}\\ , , \\label{eq : pederson}\\end{aligned}\\ ] ] which is a result originally obtained by pederson _",
    "et al . _",
    "note that this gradient matrix @xmath26 is also antisymmetric , just like @xmath19 .",
    "therefore , at an energy minimum , the wavefunctions satisfy @xmath27 \\psi_{\\sigma j}({\\bf r})\\,d{\\bf r}\\ , , \\label{eq : pederson2}\\ ] ] which was referred to as the `` localization condition '' by pederson _",
    "et al . _",
    "@xcite .    to date , the most widely used sic scheme is pz sic  @xcite ( and its few refinements , e.g. , refs .",
    "@xcite ) . in pz",
    "scheme , the sic energy is given by @xmath28&=&-\\sum_{\\sigma}\\sum_{i=1}^n \\frac{1}{2}\\int\\int\\frac{\\rho_{\\sigma i}({\\bf r})\\rho_{\\sigma i}({\\bf r}')}{|{\\bf r}-{\\bf r}'|}\\ , d{\\bf r}\\,d{\\bf r}'\\nonumber\\\\ & -&\\sum_{\\sigma}\\sum_{i=1}^n\\int\\epsilon_{\\rm xc}^{\\rm lda}(\\rho_{\\sigma i}({\\bf r}))\\,\\rho_{\\sigma i}({\\bf r})d{\\bf r}\\ , .",
    "\\label{eq : e_sic_pz}\\end{aligned}\\ ] ] the rationale underlying pz sic is both simple and beautiful : correcting the total energy by subtracting the incorrect energy contributions from the interaction of an electron with itself  i.e. , the hartree , exchange , and correlation energies .",
    "hence pz sic is exact for one - electron systems , or in the limit where the total charge density can be decomposed into non - overlapping one - electron charge density contributions .",
    "recently , an alternative scheme suitable for many - electron systems based on the generalized koopmans condition  @xcite was introduced in ref .",
    "@xcite . in brief",
    ", one could start from janak s theorem  @xcite that states that in dft the orbital energy @xmath29 with fractional occupation of a state being @xmath30 is @xmath31 where @xmath32 is the kohn - sham total energy minimized under the constraint @xmath30 .",
    "if there were no self - interaction , the orbital energy of a state @xmath29 would not change upon varying its own occupation @xmath33 .",
    "in other words , for a self - interaction - free functional , @xmath34 alternatively , using janak s theorem  @xcite , this can be rewritten as @xmath35 which is equivalent to the generalized koopmans theorem  @xcite , telling us that the total energy varies linearly with the fractional occupation @xmath36 . in conventional dft , however , eq .  ( [ eq : nk_condition ] ) or eq .",
    "( [ eq : delta_e ] ) does not hold and instead , @xmath37 from eqs .",
    "( [ eq : delta_e ] ) and  ( [ eq : delta_e2 ] ) , the non - koopmans ( nk ) energy @xmath38  i.e. , the deviation from the linearity for the energy versus occupation  can be defined as  @xcite @xmath39\\,df'\\ , .",
    "\\label{eq : pi}\\end{aligned}\\ ] ] from this result , the sic energy term based on the generalized koopmans theorem has been defined as @xmath40= \\sum_\\sigma \\sum_{i=1}^n\\pi_{\\sigma i}(f_{\\rm ref})\\ , , \\label{eq : nksic}\\ ] ] where @xmath41 is a reference occupation factor ( for many - electron systems , @xmath42 was shown to be the best choice  @xcite ) .",
    "the total energy versus ( fractional ) number of electrons relation calculated by exact dft should be piecewise linear with slope discontinuities at integral electron occupations  @xcite ; however , within the lda , this energy versus occupation relation is piecewise convex  @xcite .",
    "the lda deviation from the piecewise linearity is the main reason for the failures of approximate dfts  @xcite . the new sic functional [ eq .  ( [ eq : nksic ] ) ]",
    "is introduced to cure this pathology and to recover the piecewise linearity of exact dft  @xcite .",
    "the ( bare ) nk sic discussed above and its screened version explain some of the most important material properties such as ionization energy and electron affinity better than pz sic .",
    "we refer the reader to ref .",
    "@xcite for the details of nk sic .      in order to implement a variational minimization of the total energy functional ,",
    "we adopt the same strategy as the ensemble - dft approach  @xcite , decoupling the dynamics of orbital rotations in the occupied subspace and that of orbital evolution in the manifold orthogonal to the occupied subspace . in explicit terms",
    ", we minimize the sic energy through @xmath43 = \\min_{\\{\\psi_{\\sigma i}\\}}\\left(\\min_{\\{o_{\\sigma}\\}}e_{\\rm sic}[\\{\\psi_{\\sigma i}\\},\\{o_\\sigma\\}]\\right)\\ , , \\label{eq : twoloop}\\ ] ] where @xmath44 and @xmath45 are connected by an orthogonal transformation @xmath46 [ eq .",
    "( [ eq : u ] ) ] .",
    "minimization over the basis orbital wavefunctions @xmath45 and that over the orthogonal transformation @xmath47  inside the round parenthesis in eq .",
    "( [ eq : twoloop ] )  correspond to the outer - loop minimization and inner - loop minimization , respectively , i.e. , given the orbital wavefunctions , an optimal orthogonal transformation is searched and then the orbital wavefunctions are evolved .",
    "this process is repeated until convergence .",
    "ensemble - dft minimization has also been discussed in studying the sic problem by stengel and spaldin  @xcite and by klpfel , klpfel , and jnsson  @xcite .",
    "the main focus here is on inner - loop minimization .",
    "the gradient matrix @xmath48 in eq .",
    "( [ eq : pederson ] ) is antisymmetric and real ; hence , @xmath49 is hermitian ( and purely imaginary ) .",
    "therefore , @xmath50 can be diagonalized as @xmath51 or , @xmath52 where @xmath53 is a unitary matrix and @xmath54 a real diagonal matrix . from eq .",
    "( [ eq : g ] ) , we evolve the matrix @xmath19 along the energy gradient with a step of size @xmath55 @xmath56 calculate the updated orthogonal matrix @xmath57 and then transform the wavefunctions accordingly .    here ,",
    "we use the steepest - descent method for the inner - loop minimization .",
    "but one could employ other methods such as damped dynamics or conjugate gradients . in each of the inner - loop steps",
    ", we evaluate the sic energy with two different sets of wavefunctions : first by using the given wavefunctions [ @xmath58 and second by using the wavefunctions transformed by @xmath9 in eq .",
    "( [ eq : o_update ] ) with a trial step @xmath59 [ @xmath60 .",
    "in addition , the gradient at @xmath61 reads @xmath62_{l=0}\\nonumber\\\\ & = & -\\frac{1}{2}\\sum_{\\sigma ij}|g_{\\sigma ij}|^2 \\ , , \\label{eq : dedl}\\end{aligned}\\ ] ] where we have used eqs .",
    "( [ eq : pederson ] ) and  ( [ eq : da ] ) , and the fact that only half of the matrix elements of @xmath26 are independent . thus , knowing @xmath63 , @xmath64 , and @xmath65 , we can fit a parabola to @xmath66 , yielding the optimal step @xmath67 and the energy minimum @xmath68 .",
    "this completes one inner - loop iteration .",
    "we then use the transformed wavefunctions to calculate the gradient [ eq .",
    "( [ eq : pederson ] ) ] and repeat iterations until the sic energy converges .    for optimal convergence",
    ", we set the step size based on the highest frequency component of the gradient matrix , i.e. , @xmath69 where @xmath70 is a constant of order @xmath71 and @xmath72 the maximum eigenvalue of @xmath73 , @xmath74 the critical step @xmath75 should be considered as the point when the transformed wavefunctions become appreciably different from the original wavefunctions .",
    "therefore , when we evolve wavefunctions by using a step much larger than @xmath75 , a fitting of @xmath76 versus @xmath55 by a parabola will not be successful . imposing the constraint @xmath77 [ eq .",
    "( [ eq : l_c ] ) ] when necessary is the key part of our method : ( i ) we set the trial step of the first iteration of the inner - loop minimization according to eq .",
    "( [ eq : l_c ] ) .",
    "( in subsequent iterations , the trial step @xmath78 is set based on the optimal step of the previous iteration : we set it to be twice the optimal step of the previous iteration . ) by setting the initial trial step based on the eigenspectrum of the gradient matrix , we make the inner - loop process unaffected by the absolute magnitude of the sic energy gradient with respect to the orthogonal transformation [ eq .  ( [ eq : pederson ] ) ] .",
    "( ii ) when the calculated optimal step is larger than @xmath79 , we set @xmath80 .",
    "this procedure has proven to be instrumental when @xmath66 versus @xmath55 relation can not be fitted well by a parabola . in such cases , the calculated @xmath81 can be much larger than @xmath75 .",
    "a similar scaling method based on the highest frequency component of the gradient matrix was used in finding the mlwfs  @xcite .",
    "sic tends to localize the orbital wavefunctions [ note e.g. , that the hartree term in eq .",
    "( [ eq : e_sic_pz ] ) will be more negative if the state becomes more localized ] .",
    "therefore , it is natural to consider using some localized basis functions as an initial guess for the wavefunctions of density functionals with sic . to this end , employing mlwfs  @xcite represents a very promising initial - guess strategy .",
    "although the possibility of using mlwfs in this regard was recently suggested  @xcite , no literature is available on the merit of that scheme .",
    "we address this issue in conjunction with the inner - loop minimization method discussed in the previous subsection .",
    "we performed dft calculations with norm - conserving pseudopotentials  @xcite in the lda  @xcite using the car - parrinello ( cp ) code of the quantum espresso distribution  @xcite with the inner - loop minimization described in the previous subsections , and a conventional damped dynamics algorithm for the outer - loop minimization .",
    "we have performed calculations on both pz sic  @xcite and nk sic  @xcite . except for the case of investigating the effect of using mlwfs as an initial guess for the wavefunctions , we have used lda wavefunctions with some arbitrary phases  they are not lda eigenstates  when we start the calculations .",
    "we performed calculations on a rather big molecule , c@xmath82 fullerene .",
    "a supercell geometry was used with the minimum distance between the carbon atoms in neighboring supercells larger than 6.7   .",
    "the coulomb interaction is truncated to prevent spurious interaction between periodic replicas in different supercells  @xcite .",
    "in order to find an optimal strategy for the minimization of sic dft , it is important to know how the energy varies with orthogonal transformations .",
    "we first show the energy variation along the direction in the orthogonal transformation space parallel to the gradient [ eq .  ( [ eq : pederson ] ) ] of the energy , i.e. , @xmath66 versus @xmath55 , where @xmath55 is a step representing the amount of orthogonal rotation as defined in eq .  ( [ eq : da ] ) .",
    "figure  [ fig1](a ) shows the results for pz sic at a few different stages during the inner - loop minimization .",
    "what we can see is that initially @xmath83 varies slowly with @xmath55 , and then , in the middle of the inner - loop minimization , varies fast and then , toward the end of the minimization , varies slowly again .",
    "there is no good length scale of @xmath55 which can consistently describe the variation of @xmath66 during the entire process of an inner - loop minimization",
    ". the speed of the energy variation at different stages of the inner - loop minimization with respect to @xmath55 near @xmath61 can however be very well explained by @xmath72 [ eq .  ( [ eq : lambda_max ] ) ] , which is the fastest frequency component of the gradient matrix [ eq .",
    "( [ eq : pederson ] ) ] , as shown in fig .",
    "[ fig1](b ) .",
    "we can draw similar conclusions for nk sic as shown in figs .",
    "[ fig1](c ) and  [ fig1](d ) .",
    "however , there are a few points that are worth mentioning . first",
    ", the magnitude of nk sic energy is several times smaller than that of pz sic energy [ figs .",
    "[ fig1](a ) and  [ fig1](c ) ] .",
    "second , @xmath72 , or the main driving force for orthogonal transformation near @xmath61 , for nk sic is also much smaller than that for pz sic , although eventually both of them converge to zero at energy minima .",
    "because of these differences between different sic functionals , it is clear that determining the trial step @xmath78 based on @xmath72 will be very useful , even more so because @xmath72 is also affected by the arbitrary initial phases of the wavefunctions , as will be discussed later ( fig .",
    "[ fig6 ] ) .",
    "[ eq .  ( [ eq : e_total ] ) ] , versus @xmath84 [ eq .  ( [ eq : lp ] ) ] for c@xmath82 at a few inner - loop iteration steps .",
    "( b ) similar quantity as in ( a ) for nk sic . ]    based on the previous discussion , we now show , in fig .",
    "[ fig2 ] , @xmath66 as a function of the scaled step @xmath85 i.e. , @xmath55 in units of @xmath75 . for both pz",
    "sic and nk sic , the energy variation length scale near @xmath61 through the entire process of the inner - loop minimization is @xmath86 in units of @xmath87 .",
    "the results confirm that indeed a natural length scale for @xmath55 that should be used in the inner - loop minimization is the @xmath75 defined in eq .",
    "( [ eq : l_c ] ) .",
    "one more thing to note here is that in both pz sic and nk sic , at the initial stages of the inner - loop iterations , the energy profile can not be well fitted by a parabola .",
    "this trend is dramatic especially for nk sic , where the @xmath66 versus @xmath55 ( or @xmath87 ) relation is concave , not convex , at @xmath61 .",
    "( [ eq : e_total ] ) ] , versus @xmath84 [ eq .  ( [ eq : lp ] ) ] for a carbon atom at a few inner - loop iteration steps . ]",
    "this can be best understood using a simple system : a carbon atom which has , in our pseudopotential calculations , two orbitals ( @xmath88 and @xmath89 ) , i.e. , it is a two - level system .",
    "the pz sic energy @xmath83 versus @xmath87 is shown in fig .",
    "the profile is sinusoidal with a period of 0.5 , rather than parabolic for the entire process of minimization .",
    "notably , the period 0.5 in units of @xmath87 is similar to the previously discussed length scale for c@xmath82 fullerene .",
    "the shape of the curve does not change as we proceed in the inner - loop minimization ; the only variation is that the minimum of the curve moves toward the origin ( @xmath90 ) .",
    "we can understand this behavior as follows .",
    "the gradient matrix in eq .",
    "( [ eq : pederson ] ) for a carbon atom is of the form @xmath91 where @xmath92 is a real constant and @xmath93 the pauli matrix .",
    "( we dropped the spin index for obvious reasons . ) assuming ( without losing generality ) that @xmath94 , the maximum eigenvalue of @xmath95 is @xmath96 and the orthogonal transformation matrix [ eqs .",
    "( [ eq : da ] ) and  ( [ eq : o_update ] ) ] is given by @xmath97 or , using @xmath87 [ eq .  ( [ eq : lp ] ) ] , @xmath98 in particular , when @xmath99 , @xmath100 , and , under this orthogonal transformation @xmath101 , @xmath102 and @xmath103 , i.e. , @xmath101 just exchanges the two orbital wavefunctions ( plus a trivial sign change ) .",
    "when the original wavefunctions @xmath104 and @xmath105 correspond to the maximum sic energy configuration , the new set of wavefunctions @xmath106 and @xmath107 will correspond also to the sic energy maximum .",
    "therefore , the period of @xmath66 versus @xmath87 will be 0.5 in agreement with our calculation [ fig .",
    "[ fig3 ] ] .",
    "( the shape of the curve is not exactly sinusoidal and varies slightly with the kind of sic used . )    for this example , which part of the sinusoidal - like curve one starts the inner - loop minimization from depends on the initial orbital wavefunctions ( and an arbitrary rotation of them ) .",
    "if we start from the lda eigenstates , the sic energy is at its maximum ( roughly speaking , the lda eigenstates are the most delocalized and the sic energy is highest ) and the inner - loop minimization starts from the top of the sinusoidal - like curve , and hence ( i ) the driving force for the orthogonal transformation is extremely weak ( zero at the maximum ) and ( ii ) @xmath66 versus @xmath87 is concave . for these reasons , if we do not properly scale @xmath55 , or if we do not constrain @xmath55 during the inner - loop minimization process , the minimization process based on the assumption that the energy profile is convex parabolic may become unstable or extremely slow .",
    "this discussion is also relevant to other systems , as we have seen in the case of c@xmath82 fullerene .",
    "figure  [ fig4](a ) compares the performance of the inner - loop minimization for the case pz sic . in one case ( dashed or blue curve ) , we take the optimal step size @xmath81 obtained from fitting @xmath83 versus @xmath55 by a parabola from three calculated quantities : @xmath108 , @xmath109 , and @xmath110 . in the other case ( solid or red curve ) , if the calculated @xmath81 is larger than @xmath79 ( with @xmath111 ) [ eq .",
    "( [ eq : l_c ] ) ] , we set @xmath80 . apparently , by using this constraint based on @xmath75 , or , @xmath72 , the inner - loop minimization process becomes more stable and faster .",
    "( in both cases , the trial step of the first iteration was set to @xmath112 . ) the difference between using and not using this @xmath72 constraint is dramatic for nk sic [ fig .",
    "[ fig4](b ) ] .",
    "this again is due to ( i ) the small gradient of the sic energy with respect to the variation of the orthogonal transformation , and ( ii ) non - concave - parabolic dependence of @xmath66 on @xmath55 .        until now",
    ", our focus was on the inner - loop minimization .",
    "now we look at the entire minimization procedure including the outer loop . in order to find an optimal minimization strategy ,",
    "we have performed our calculations by restricting the number of inner - loop minimization iterations per each outer - loop iteration to be less than or equal to @xmath113 .",
    "( however , not every outer - loop iteration will require @xmath113 inner - loop iterations because the sic energy may be converged earlier during inner - loop minimization .",
    "we exit the inner loop if the energy difference between consecutive iterations is lower than the energy convergence threshold of @xmath114  ry . )",
    "the case without inner - loop minimization is denoted by @xmath115 .",
    "figure  [ fig5](a ) shows the convergence of pz sic energy for various different choices of @xmath113 . in all cases where the inner - loop minimization routine is used ( i.e. , @xmath116 )",
    ", the total number of outer - loop iterations necessary to achieve the same level of convergence is much smaller than that when no inner - loop minimization is used .",
    "this , however , does not necessarily mean that the total computation time is reduced . in fig .",
    "[ fig5](b ) , we show the cpu time dependence of the sic energy ( the results include both the inner - loop and outer - loop minimization iterations ) .",
    "surprisingly , in all cases other than @xmath117 , inner - loop minimization actually slows down the computation for pz sic .",
    "when we set @xmath117 , i.e. , if the number of inner - loop iterations per each outer - loop iteration is restricted to  1 , we find about twice improvement over when no inner - loop minimization is performed in terms of the cpu time .",
    "the case of nk sic is very different .",
    "figures  [ fig5](c ) and  [ fig5](d ) shows that inner - loop minimization reduces not only the required number of outer - loop iterations but also the cpu time significantly . especially , the cpu time is reduced by @xmath118 times when we perform inner - loop minimization , and is rather insensitive to @xmath113 .",
    "these results on pz sic and nk sic support that the presented method works regardless of the absolute magnitude of the sic energy gradient with respect to the orthogonal transformation [ eq .  ( [ eq : pederson ] ) ] .",
    "the method can be applied to density functionals with other kinds of sic .",
    "for example , sic with screening , for which the total energy is given by @xmath119 will have the sic energy gradient lower in magnitude than the unscreened version of sic ( @xmath120 ) , and our method will be more useful .",
    "it has to be noted that the relative cpu time among different calculations shown in fig .",
    "[ fig5 ] at different stages of the minimization is affected only by the ratio of the cpu time for one inner - loop iteration to that for one outer - loop iteration .",
    "therefore , the relative cpu time is rather insensitive to the complexity of the system studied , and in that sense is meaningful .",
    "( the absolute cpu time is also affected much by the complexity of the system , the performance and number of processors , etc . ) in our case , one inner - loop iteration for pz sic takes 3.6 times as long as one outer - loop iteration and one inner - loop iteration for nk sic takes 2.0 times as long as one outer - loop iteration .",
    "finally , we discuss how useful it is to use mlwfs  @xcite as an initial guess for the wavefunctions  @xcite .",
    "the following description is relevant for both pz sic [ figs .  [ fig6](a ) and  [ fig6](b ) ] and nk sic [ figs .",
    "[ fig6](c ) and  [ fig6](d ) ] and whether or not the inner - loop minimization is employed . figure  [ fig6 ] shows that when mlwfs are used , the initial total energy is lower than when lda wavefunctions with arbitrary phases is used . on the other hand , the slope of @xmath121 $ ] versus either the number of outer - loop iterations or the relative cpu time is not very different in the two cases .",
    "therefore , it is advantageous to use mlwfs as an initial guess for the wavefunctions ; however , the lower the energy convergence threshold the smaller the relative advantage .",
    "in summary , we have developed a variational , stable and efficient approach for the total - energy minimization of unitary variant functionals , as they appear in self - interaction corrected formulations , with a focus on properly minimizing the energy by unitary transformations of the occupied manifold .",
    "in particular , we have shown that the energy changes along the gradient direction can be very different from being convex parabolic , and suggested the use of the maximum frequency component of the gradient matrix in determining optimal rotations for the inner - loop minimization . when maximally localized wannier functions are used as an initial guess for the wavefunctions , the initial energy decreases significantly from that corresponding to wavefunctions with arbitrary phases",
    "; however , the logarithmic energy convergence rate remains similar in the two cases .",
    "we expect that the results will be useful for investigating the physical properties of complex materials and big molecules with self - interaction corrected density functional theory ."
  ],
  "abstract_text": [
    "<S> density - functional theory has been one of the most successful approaches ever to address the electronic - structure problem ; nevertheless , since its implementations are by necessity approximate , they can suffer from a number of fundamental qualitative shortcomings , often rooted in the remnant electronic self - interaction present in the approximate energy functionals adopted . </S>",
    "<S> functionals that strive to correct for such self - interaction errors , such as those obtained by imposing the perdew - zunger self - interaction correction [ phys . </S>",
    "<S> rev . </S>",
    "<S> b * 23 * , 5048 ( 1981 ) ] or the generalized koopmans condition [ phys . </S>",
    "<S> rev . </S>",
    "<S> b * 82 * , 115121 ( 2010 ) ] , become orbital dependent or orbital - density dependent , and provide a very promising avenue to go beyond density - functional theory , especially when studying electronic , optical and dielectric properties , charge - transfer excitations , and molecular dissociations . unlike conventional density functionals , these functionals are not invariant under unitary transformations of occupied electronic states , which leave the total charge density intact , and this added complexity has greatly inhibited both their development and their practical applicability . here , we first recast the minimization problem for non - unitary invariant energy functionals into the language of ensemble density - functional theory [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> * 79 * , 1337 ( 1997 ) ] , decoupling the variational search into an inner loop of unitary transformations that minimize the energy at fixed orbital subspace , and an outer - loop evolution of the orbitals in the space orthogonal to the occupied manifold . </S>",
    "<S> then , we show that the potential energy surface in the inner loop is far from convex parabolic in the early stages of the minimization and hence minimization schemes based on these assumptions are unstable , and present an approach to overcome such difficulty . </S>",
    "<S> the overall formulation allows for a stable , robust , and efficient variational minimization of non - unitary - invariant functionals , essential to study complex materials and molecules , and to investigate the bulk thermodynamic limit , where orbitals converge typically to localized wannier functions . </S>",
    "<S> in particular , using maximally localized wannier functions as an initial guess can greatly reduce the computational costs needed to reach the energy minimum while not affecting or improving the convergence efficiency . </S>"
  ]
}