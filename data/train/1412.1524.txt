{
  "article_text": [
    "in contrast to the magnetic fields of low - mass stars ( e.g. the sun ) , magnetic fields in upper main sequence stars , white dwarfs , and neutron stars are quite stable on time scales comparable to their life times",
    ". however , not all of these stars are actually `` magnetic , '' in the sense that massive stars and white dwarfs follow a bimodal distribution in which only a fraction within @xmath1% of each star type stands out for having strong magnetic fields when compared to the remaining @xmath2 @xcite . throughout this work",
    ", we will be interested in the stable fields in upper main sequence stars , white dwarfs , and neutron stars .    from a theoretical point of view",
    ", the persistence of magnetic fields in massive stars and compact remnants motivates the interest in what physical conditions are involved in sustaining such equilibria .",
    "both analytical and numerical studies have generally pointed out that stable equilibrium configurations require a poloidal component of the magnetic field to stabilize a toroidal one , and vice versa @xcite , while purely poloidal and purely toroidal equilibria undergo intrinsic instabilities related to their geometries @xcite .",
    "the simulations of braithwaite and collaborators showed that initially random fields often evolve naturally into nearly axisymmetric , toroidal - poloidal `` twisted - torus '' configurations on short ( alfvn ) time scales .",
    "in addition , an important ingredient to consider is that the matter within the stars considered is non - barotropic , that is , the pressure is a function of mass density and another thermodynamic quantity , which is conserved in a fluid element if the latter is perturbed from its equilibrium position @xcite .",
    "this second thermodynamic variable accounts for stable stratification , i.e. , stability against convective motion . on short timescales ,",
    "massive stars and white dwarfs are stratified by entropy gradients , while in neutron stars this role is played by a varying chemical composition .",
    "stable stratification could be a crucial ingredient in stabilizing these equilibria , inhibiting radial motions and hence suppressing fluid instabilities occurring within these stars , as supported by recent numerical simulations @xcite . as a matter of fact",
    ", it has recently been suggested that a plausible condition of dynamical stability for these magnetized stars can be expressed as @xmath3 where @xmath4 is the magnetic - to - gravitational energy ratio , @xmath5 is the fraction of magnetic energy stored in the poloidal component , and @xmath6 is a pure number accounting for how stratified the star is @xcite .",
    "the additional fact that all of these objects are expected to contain a gravitational energy much larger than the magnetic energy @xcite would imply that the toroidal component can be stabilized by a much weaker poloidal field , but the converse is not true .",
    "this is of particular relevance in the context of energy released by magnetars , where it has been claimed that a much stronger internal toroidal field would account for observed outbursts emitted from these objects @xcite .",
    "stable stratification , although crucial on short time scales , could be eroded if some processes change either entropy or chemical composition . in massive stars and white dwarfs ,",
    "heat conduction is too slow to significantly change entropy during their life time . for neutron stars , the stable stratification",
    "could be overcome by changing the chemical composition by means of @xmath7-decay and/or ambipolar difusion @xcite , making them effectively barotropic over long time scales .",
    "on the other hand , and despite their lack of realism , barotropic equations of state have often been assumed to describe the matter within upper main sequence stars , white dwarfs and neutron stars @xcite , because of the expected simplicity as a very first approximation to the realistic state of matter . yet , it is important to identify correctly when one is actually modeling a barotropic fluid .",
    "the local adiabatic index of the fluid , @xmath8 , where @xmath9 is the specific entropy ( or another quantity conserved in fast fluid displacements ) , will not generally be equal to the analogous index describing the equilibrium , @xmath10 .",
    "if @xmath11 , we say that the fluid is barotropic . a single - species , non - interacting degenerate fermi gas , for example ,",
    "_ does _ possess a barotropic equation of state , which in limiting cases of nonrelativistic and ultrarelativistic particles reduces to polytropes with @xmath12 and @xmath13 , respectively .",
    "barotropy strongly restricts the allowed range of possible equilibrium configurations and , as discussed , does not strictly represent the realistic stably stratified matter within these objects on short ( alfvn ) time scales .",
    "moreover , the question whether magnetic equilibria in barotropic stars can be stable or not is being answered negatively by recent studies @xcite .",
    "several authors @xcite have explored the possible axially symmetric equilibria in barotropic stars , generally finding that the fraction of the total magnetic energy corresponding to the toroidal component , @xmath14 , is at most a few % , even in cases of comparable poloidal and toroidal magnetic field strength . since stable stratification , which is absent in the barotropic case ,",
    "is expected to be a key piece in the stability of the stars considered here , and given such a small fraction of toroidal energy apparently inherent to barotropic configurations , it is likely that all of these equilibria are dynamically unstable , as supported by recent simulations @xcite .",
    "more recent works @xcite have shown , however , that higher fractions @xmath14 are actually possible , making a more extensive survey of these equilibria relevant .",
    "studying properties of barotropic equilibria could also be relevant considering the scenario in which neutron stars would reach an effectively barotropic state after overcoming stable stratification by means of dissipative processes , as already discussed .",
    "the present work is focused on obtaining a wide range of barotropic equilibria , paying attention to their main properties .",
    "in addition , these results may be considered as a starting point to study in more detail whether magnetic fields in barotropic stars can be stable or not .",
    "this paper is organized as follows .",
    " 2 presents the formalism used to construct barotropic equilibria , in order to introduce the notation used throughout this paper . in ",
    "3 we solve numerically the resulting equilibrium equation .",
    "we summarize the tests carried out to check our code and present the main results obtained .",
    " 4 expands the analysis of barotropic equilibria , introducing an asymptotic , analytical model to explore equilibrium configurations beyond numerical simulations . finally ,  5",
    "presents the conclusions of this paper .",
    "we assumed that the star is a perfectly conducting fluid . in the ideal mhd approximation ,",
    "the dynamical equilibrium of a star is described by the euler equation , @xmath15 where @xmath16 , @xmath17 , @xmath18 , @xmath19 , @xmath20 and @xmath21 are the fluid pressure , mass density , gravitational potential , magnetic field , electric current density and speed of light , respectively , so that the last term in eq . is the lorentz force per unit volume . throughout this work",
    ", a spherical coordinate system @xmath22 with origin at the center of the star is used to describe all quantities .",
    "also , we assumed that the current density drops toward the stellar surface and vanishes outside , as expected since the mass density and the charged - particle density do so .",
    "for simplicity , we considered axially symmetric magnetic stars .",
    "the magnetic field may then be expressed as the sum of a poloidal and a toroidal component , each determined by a single scalar function @xcite , @xmath23 where @xmath24 , @xmath25 being the orthonormal basis of the coordinate system , with @xmath26 . by ampre s law",
    ", the electric current density reads @xmath27 where the laplacian - like `` grad  shafranov operator '' @xmath28\\\\    & = \\frac{\\partial^2}{\\partial r^2 } + \\frac{\\sin\\theta}{r^2}\\frac{\\partial}{\\partial \\theta}\\left ( \\frac{1}{\\sin\\theta}\\frac{\\partial}{\\partial \\theta } \\right)\\label{gsop}\\end{aligned}\\ ] ] was introduced . for an axisymmetric equilibrium ,",
    "the azimuthal component of the magnetic force must vanish , which is imposed by demanding that @xmath7 be a function of @xmath29 only , @xmath30 . this implies that both @xmath29 and @xmath7 are constant along poloidal field lines .",
    "also , notice that , since the poloidal component is perpendicular to the toroidal one by construction , one can always split the magnetic energy in terms of the energy stored in each component , @xmath31 where the integration is carried out over all space .      since we demanded vacuum outside the star",
    ", @xmath7 has to be a constant there ( see eq . )",
    ". this constant must be zero in order to have a finite magnetic field along the axis .",
    "also , it is needed that @xmath32 which is a linear , homogeneous partial differential equation , whose general solution after separating variables is @xmath33p_\\ell^1(\\cos\\theta),\\label{expoutsidegeneral}\\ ] ] where @xmath34 is the associated legendre polynomial of order @xmath35 with azimuthal index @xmath36 . since the magnetic field must vanish far from the star , @xmath37 for all values of @xmath35 , and @xmath38 outside the star .      throughout this work",
    ", we considered a barotropic equation of state , @xmath39 , in which case if we divide eq .",
    "by @xmath17 and take the curl of the result , the lorentz force per unit mass must be the gradient of a certain axisymmetric scalar function @xmath40 , @xmath41 $ ] , where the factor @xmath42 is introduced for convenience . replacing the decomposition of eq . in the lorentz force ,",
    "it turns out that @xmath43 must be a function of @xmath29 as well .",
    "hence @xmath44 , and the so - called grad  shafranov equation ( hereafter gs , @xcite , @xcite ) , @xmath45 is obtained , where @xmath46 is the grad  shafranov operator given by eq . .",
    "in the latter , a prime indicates derivative with respect to the argument . in this way , for given functions @xmath47 and @xmath48 , the gs equation may be solved for the unknown @xmath29 .",
    "this can be done self - consistently with the poisson equation ( relating the gravitational potential and the density profile ) and the euler equation , provided an equation of state . imposing appropriate boundary conditions at the surface , this procedure gives @xmath29 , which determines the magnetic field inside the star .",
    "this approach has been successfully used to get ( numerical ) barotropic equilibria @xcite , but in what follows we will briefly discuss an additional , useful approximation which allowed us to obtain suitable equilibria with less calculations .",
    "it is clear that the magnetic field can deform the star , so that @xmath17 is in principle affected by @xmath29 .",
    "nevertheless , the fact that the magnetic energy stored in the stars considered is much smaller than their gravitational energy @xcite suggests that this deformation is correspondingly small , so the density profile appearing in eq . can be taken to an excellent approximation to be as in the non - magnetic case .",
    "this approximation has been already considered @xcite .",
    "one advantage of this approach is that the results can be scaled to any ( small ) field strength , which is not true for the `` self - consistent '' one .",
    "thus , in this work we looked for barotropic equilibria by solving the gs equation for a _ given _ density profile @xmath49 , having been particularly interested in comparing these two approaches .      alternatively , the gs equation can also be obtained by extremizing the functional @xmath50 = \\int\\mathcal l\\,dv$ ] with respect to the scalar function @xmath29 , where the lagrangian density is @xmath51,\\ ] ] subject to the condition that @xmath52 must vanish at the stellar surface , i.e. , homogeneous dirichlet boundary conditions .",
    "this expression generalizes that given by @xcite .",
    "maxwell s equation @xmath53 imposes that the radial component of the magnetic field be continuous across the surface .",
    "also , the @xmath54 and @xmath55 components of the magnetic field must be continuous in order to avoid surface currents . in terms of @xmath29 , continuity of",
    "@xmath56 demands that @xmath57 be continuous , which in turn implies that @xmath29 itself must be continuous , @xmath58 where we have introduced the expansion for @xmath29 outside , while @xmath59 is a solution of the gs equation inside the star .",
    "using the completeness of the set @xmath60 , one can extract the coefficients @xmath61 appearing in eq . in terms of the value of @xmath29 at the surface , leading to @xmath62 where @xmath63 stands for the integral @xmath64 this choice of the coefficients @xmath61 ensures @xmath56 continuous .",
    "continuity @xmath65 implies that @xmath66 where in the last equality we have replaced the expression for @xmath61 found in eq . .",
    "finally , in order to have @xmath67 continuous , we demanded that @xmath68 at the surface , as explained in more detail in the next subsection .",
    "as mentioned , @xmath47 is an arbitrary function of @xmath29 only .",
    "however , its shape is physically constrained as follows . since @xmath68 outside and",
    "@xmath7 is constant along poloidal field lines , it has to be zero along poloidal field lines closing outside the star .",
    "that is , the toroidal field may lie only in regions where the poloidal field lines close _ inside _ the star . a particularly simple choice to achieve this is to set @xmath69 where @xmath70 and @xmath71 are free parameters , while @xmath72 is the value of @xmath73 at the surface of the star on the equator , which is also the value of @xmath29 along the longest poloidal field line closing inside the star .",
    "this choice has already been used by previous authors @xcite .",
    "it is fundamental to notice that geometrically one does not know a priori where to locate the boundary between the volume with and without toroidal field . also , @xmath74 is _ not _ a given parameter , but it has to be determined while solving the gs equation .",
    "we set @xmath75 in order to compare with previous works .",
    "it is expected that higher values of @xmath71 result in smaller contributions of the @xmath76 term in the gs equation , leading to a smaller toroidal field strength , although it turns out that there are no significant differences in the configurations when using larger @xmath71 .",
    "the parameter @xmath70 , instead , plays a significant role in the configurations obtained , so a separate subsection will be devoted to this dependence . throughout this work , we also chose @xmath77",
    "we developed a finite - difference code to solve the gs equation for arbitrary choices of the functions @xmath47 , @xmath78 , and @xmath79 .",
    "our code solves for @xmath29 on a polar grid of @xmath80 points in the @xmath81-direction and @xmath82 points in the @xmath54-direction , corresponding to the inside of the star , and it matches the solution smoothly to the multipolar expansion of eq . .",
    "since the infinite sum defining the multipolar expansion outside can not be performed numerically , we truncate it to a maximum multipole @xmath83 , defined at the beginning of the method . the details of our code are summarized in the appendix .",
    "we solved the gs equation for different density profiles , considering the particular function @xmath47 given in eq . and normalized our results so that @xmath84 .",
    "we also normalized distances to stellar radius and density profiles to @xmath85 .",
    "the results can be easily scaled to other normalizations .      after obtaining numerical solutions , we tested whether they are actually solutions by finding that , for resolutions @xmath86 and @xmath87 , the inequality @xmath88 held for @xmath89 on each point on the grid . here",
    "@xmath90 is the maximum value of @xmath29 reached by the corresponding equilibrium over the space .",
    "this inequality held for all equilibria obtained with this resolution , while better accuracy was obtained for higher resolutions , as expected . regarding boundary conditions",
    ", we confirmed that the coefficients that define @xmath29 outside the star were consistently calculated by getting that the inequality @xmath91 held on each point on the surface , with @xmath92 for @xmath86 , @xmath87 .",
    "we also tested that the radial derivative of @xmath29 remained continuous by obtaining that the inequality @xmath93 held for @xmath89 on each point on the surface , again , for @xmath86 and @xmath87 .",
    "for the two latter tests , better resolutions improved the accuracy , but large ( @xmath94 ) values of @xmath70 in the prescription of @xmath47 yielded values of @xmath95 , in both cases .    regarding the number of multipoles outside the star",
    ", one could think that , since the multipolar expansions extend to @xmath96 , the larger @xmath83 , the more accuracy one gets .",
    "however , for a fixed resolution , we found that the accuracy when calculating the multipolar coefficients drops off after passing a certain critical value of @xmath83 . since we expect that the equilibria we are looking for have higher multipoles , we are interested in finding an optimal @xmath83 . after repeating the previous tests for different resolutions , we found that @xmath97 gives the best results , so we fixed this parameter to that value .",
    "we tested our code against known analytical solutions of the gs equation , corresponding to purely poloidal fields ( for which @xmath68 identically ) . here",
    "we present a test using the purely poloidal field with @xcite @xmath98\\sin^2\\theta , & x < 1\\\\ \\dfrac{\\sin^2\\theta}{2x } , & x > 1 , \\end{cases}\\ ] ] where @xmath99 and @xmath100 is the magnetic field at the pole .",
    "this configuration is obtained by choosing @xmath101 , where @xmath102 is the central density . for this case",
    ", we found that @xmath103 with @xmath104 on each point on the grid , for @xmath86 and @xmath87 .",
    "this excellent agreement increased the confidence in our numerical scheme .",
    "we compared some of our equilibria with those obtained by @xcite in the context of hall equilibria in neutron star crusts . in terms of physics , the derivation and the physical interpretation of some quantities involved",
    "are quite different , but the mathematical form of the equation is exactly the same .",
    "gourgouliatos code is based on a gauss  seidel method on a cylindrical grid extending outside the star as well , and assuming as exterior boundary condition a dipolar field at the boundary of the grid .",
    "table [ withkostas ] summarizes this comparison , in which we display the toroidal - to - poloidal energy ratio for different values of @xmath70 . as seen , both codes agree for all equilibria tested .",
    ".fraction of energy ( in % ) stored in the toroidal component of the magnetic equilibria obtained by the code of k. n. gourgouliatos @xcite vs. those obtained in this work , using the twisted - torus configuration given by eq . , and assuming @xmath105 and @xmath106 , for @xmath86 and @xmath87 in our code . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]",
    "numerical instabilities arise when increasing @xmath70 beyond a value @xmath107 ( for fixed @xmath108 ) and our code has convergence problems .",
    "this occurs because more points on the grid are needed to resolve the toroidal volume , which becomes smaller . in this section",
    "we overcome this difficulty by introducing an asymptotic model for large @xmath70 , which allows us to study the global properties of the equilibria in the limit @xmath109 .    in order to motivate the model",
    ", we note that the term @xmath110 in the gs equation approaches zero as one approaches the stellar surface , because it is proportional to @xmath17 , which is expected to decrease monotonically until it vanishes at the surface .",
    "thus , it is also expected that , as the volume occupied by the toroidal field shrinks and gets close to the surface , this term becomes significantly smaller in magnitude than the other two inside the volume , so that @xmath111 and @xmath76 roughly cancel each other .",
    "in fact , from our simulations we confirmed that @xmath112 for @xmath113 ( again , we normalize @xmath108 ) . in this way , one can expect that the relation @xmath114 will become more and more accurate inside the toroidal volume when increasing @xmath70 .",
    "this is the central idea of the field model we are introducing : for large @xmath70 , we assume that eq .",
    "is valid , and solve for @xmath29 under that approximation . of course ,",
    "when @xmath29 is determined , the problem is solved and then one can obtain expressions for the toroidal flux , energy , and so on .",
    "the problem is even simpler if we recall that the volume where the toroidal field lies not only shrinks but also becomes a toroid regardless of the density profile .",
    "because of this , we introduce a new coordinate system @xmath115 on the meridional half plane of the star , see fig .",
    "[ newcoords ] . from our simulations",
    ", it turns out that the smaller the volume , the more independent @xmath29 is with respect to the angle @xmath116 , so that for a sufficiently large @xmath70 , we can assume that @xmath29 does not depend on @xmath116 , but only on @xmath117 , therefore the gs operator reads ( recall eq . )",
    "@xmath118 where we have used that @xmath119 . using the function @xmath47 of equation",
    ", equation inside the toroidal volume can be written as @xmath120 where we have defined the dimensionless function @xmath121 so that @xmath122 , with @xmath90 being the maximum value of @xmath29 ( reached at @xmath123 , or @xmath124 ) , and the dimensionless radius @xmath125 eq . is a second - order ordinary differential equation for @xmath126 , hence two boundary conditions are needed to solve it .",
    "firstly , and by definition , it is clear that @xmath127 .",
    "also , @xmath128 , where the prime stands for the derivative with respect to the argument .",
    "this is because @xmath29 ( and thus @xmath121 ) has a smooth maximum at @xmath124 .",
    "must be integrated until the boundary of the toroidal volume , corresponding to @xmath129 , or @xmath130 , where @xmath131 is the first root of @xmath132 , a number to be determined .",
    "for @xmath133 there is no toroidal field , so this equation ( and its solution ) is valid for @xmath134 only .",
    ". accepts analytical solutions for a few exponents @xmath71 . for @xmath135 ,",
    "the unique solution satisfying the boundary conditions is @xmath136 , with @xmath137 . for @xmath138 .",
    "the equation becomes a bessel equation of order zero , with unique solution @xmath139 , @xmath140 being the first root .",
    "for all other values of @xmath71 , the equation is nonlinear , with no obvious analytical solution , so we wrote a fourth - order runge - kutta code to solve it numerically .",
    "of course , @xmath131 is a pure number , depending on the value of @xmath71 _ and on nothing else_.      under the above assumptions , formul for the toroidal flux and energy are readily obtained . by definition ,",
    "the toroidal flux through a meridional plane is @xmath141 where we defined @xmath142 a pure number .",
    "the toroidal energy can be computed as @xmath143    in principle , we are interested in obtaining analytical expressions as functions of the parameter @xmath70 . in eqs . and , @xmath90 , @xmath74 , and @xmath144 ( which to first approximation equals the radius @xmath145 )",
    "depend implicitly on @xmath70 , so it is desirable to obtain these dependences .",
    "this can be done as follows .",
    "first , let us consider the hypothetical case in which the toroidal field is effectively concentrated in an infinitesimally thin loop at the surface along the equator of the star .",
    "this would be the `` @xmath109 '' case .",
    "this limit of an infinitesimally thin loop is analogous to the problem of a thin , circular current loop . outside this loop , @xmath29 is given by the solution of the gs equation for a purely poloidal field , namely , @xmath146\\sin\\theta p_\\ell^1(\\cos\\theta ) & r < r\\\\ \\displaystyle\\sum_{\\ell = 1}^\\infty b_\\ell \\left(\\frac{r}{r}\\right)^\\ell\\sin\\theta p_\\ell^1(\\cos\\theta ) & r > r,\\label{generalsolution } \\end{cases}\\ ] ] where @xmath147 is the kronecker delta and @xmath148 where @xmath149 ( a constant ) regulates the amplitude of the magnetic field @xcite . the coefficients @xmath150 and @xmath61 must be fixed using boundary conditions .",
    "continuity of @xmath29 at @xmath151 implies @xmath152 this also ensures continuity of the radial component of the magnetic field .",
    "this time , however , the tangential component of the magnetic field is not continuous at the boundary @xmath153 , but it has a discontinuity due to the presence of a thin loop carrying a current @xmath154 , with current density @xmath155 here @xmath156 is the dirac delta function .",
    "this current comes from a singular toroidal field , which produces an azimuthal current density @xmath157 where in the last equality we have used eq . .",
    "the second boundary condition to impose is @xmath158 by direct replacement of the respective expressions for @xmath159 for @xmath160 and for @xmath161 , one can extract the coefficients by standard mathematical tools in order to finally get @xmath162 from which @xmath61 can be obtained from eq . . thus , if @xmath154 is known , the problem in this case is completely determined .",
    "the motivation behind pointing out this hypothetical case is what follows .",
    "the general solution in eq .",
    "is of course also valid outside the toroidal region when the latter is a thin ( but not infinitesimally thin ) loop . in that case , however , the coefficients are not readily obtained as we would have to impose boundary conditions in a cumbersome geometry , assuming that the solution to the gs equation inside the toroidal volume is precisely that satisfying eq . .",
    "nevertheless , as the parameter @xmath70 increases , the coefficients should eventually converge to those in eq . .",
    "therefore , in the limit of a thin toroidal volume with finite cross section , it is expected that the solution to the gs equation will be that in eq . with coefficients @xmath150 and @xmath61 given _ approximately _ by those in , where @xmath154 is the current along the thin toroidal region .",
    "if this is the case , the current @xmath154 flowing can be easily obtained using the asymptotic model developed in this section . by definition , and recalling eq . , we get @xmath163 where we have replaced @xmath164 .",
    ". implies that in this approximation , @xmath154 , and hence the coefficients , are implicit functions of @xmath70 .",
    "the asymptotic solution of the gs equation for large @xmath70 , outside the toroidal volume , is that given in eq .",
    ", where the coefficients are approximately @xmath165 and @xmath166 so , with this procedure , we can write an approximate solution @xmath29 for the gs equation in terms of its maximum value @xmath90 and its value @xmath74 at the surface between the region with and without toroidal field .",
    "in addition , @xmath29 and its derivatives must be continuous across the latter surface , i.e. , @xmath167 and @xmath168 respectively . introducing the explicit form of the coefficients @xmath150 in the expansion for @xmath29 ( equation ) , equations and",
    "read    @xmath169 + \\pi q_{2\\lambda -1}(\\alpha_\\text{max } - \\alpha_\\text{surf})f(1-x)\\label{cond11final}\\ ] ]    and @xmath170 + \\pi ( \\alpha_\\text{max } - \\alpha_\\text{surf})f'(1-x),\\label{cond12final}\\ ] ]    respectively , where we have redefined @xmath171 and then dropped the tilde .",
    "also , we have introduced the parameter @xmath172 and the function @xmath173 ^ 2}{\\ell(\\ell + 1)}z^{\\ell + 1 } = z^2\\sum_{\\nu = 0}^\\infty \\frac{2\\nu + 1}{2\\nu + 2}\\left[p_{2\\nu}(0)\\right]^2 z^{2\\nu}\\\\   & = \\frac{z^2}{8}\\left [ 4\\ , _",
    "2f_1\\left(\\frac{1}{2},\\frac{1}{2},2,z^2\\right ) + z^2\\ , _ 2f_1\\left(\\frac{3}{2},\\frac{3}{2},3,z^2\\right)\\right].\\end{aligned}\\ ] ] here @xmath174 is the gauss hypergeometric function , so that @xmath175 converges for @xmath176 , while @xmath177 means derivative @xmath178 evaluated at @xmath179 .",
    "the interesting point with the previous formul is that eqs . and",
    "allow to write both @xmath90 and @xmath74 in terms of the parameter @xmath172 , which is an implicit function of @xmath70 .",
    "once one solves for @xmath180 and @xmath181 , along with eq .",
    "evaluated at @xmath182 , @xmath183 where @xmath131 is a pure number , one gets the equations needed to write @xmath184 and @xmath185 as a function of @xmath70 . since by construction the poloidal flux equals @xmath186 , we can define the quantity @xmath187 , which is the maximum poloidal flux reached by the configuration , and take the ratio @xmath188 . using ,",
    "we get @xmath189 which turns out to be an explicit function of @xmath190 .",
    "this equation can be combined with @xmath191 ( see eq . ) which is also an explicit function of @xmath192 , to obtain a parametric relation between @xmath70 and @xmath188 .",
    ". allows to compare this model with the simulations .      as discussed , the limit of having an infinitesimally thin toroidal volume is reached when @xmath193 , or @xmath109 .",
    "[ ajustefinal ] displays @xmath188 vs. @xmath70 obtained from eqs . and , as well as from the numerical simulations .",
    "in all cases , as @xmath70 increases , the asymptotic model approaches the numerically obtained curve , in good agreement with the approximations assumed within the model .",
    ", for different polytropic equations of state .",
    "the solid line are numerical simulations , while the dashed line is the evaluation of eqs . and corresponding to the analytic model.,title=\"fig:\",width=260 ] + , for different polytropic equations of state .",
    "the solid line are numerical simulations , while the dashed line is the evaluation of eqs . and corresponding to the analytic model.,title=\"fig:\",width=255 ] + , for different polytropic equations of state .",
    "the solid line are numerical simulations , while the dashed line is the evaluation of eqs . and corresponding to the analytic model.,title=\"fig:\",width=255 ]    having tested the model with the simulations , the question whether @xmath14 is bounded over the full range of @xmath70 can be answered . in this case",
    ", there is no trivial expression for @xmath194 as one should in principle integrate the asymptotic solution over all space outside the thin toroidal volume , and add the contribution inside the torus .",
    "this would demand non - trivial integration limits for the former integral , although the latter can be easily computed with the model of this section . in order to estimate the poloidal energy",
    ", we can use the known result for a circular loop of radius @xmath144 having a circular cross section of radius @xmath182 , with @xmath195 ( e.g. @xcite ) @xmath196,\\ ] ] which diverges in the limit @xmath197 .",
    "the toroidal energy , on the other hand , goes to zero as @xmath193 , so the fraction @xmath198 also vanishes in that limit .",
    "the conclusion is that @xmath198 , _ as a function of @xmath70 , does possess a maximum value , and then decreases monotonically to zero_. this would mean that _ all _ the configurations with @xmath47 as given in eq . and @xmath199 are restricted to have a small ( @xmath0 ) fraction of the magnetic energy stored in the toroidal component .",
    "this choice has been the most used in the literature , so if one were interested in obtaining higher fractions , one should explore other prescriptions for @xmath78 ( and perhaps for @xmath47 as well ) .",
    "we have developed a numerical code to model axially symmetric magnetic stars in ideal mhd equilibrium , allowing for both poloidal and toroidal component of the magnetic field , in a barotropic fluid .",
    "we presented several tests to check its accuracy , including comparisons with previous works in this area , finding a good agreement with them . from these comparisons",
    ", we showed that , for magnetic field strengths up to @xmath200 g , and assuming polytropic equations of state , the simpler approach of solving the resulting gs equation describing the equilibrium , and imposing a density profile derived from a non - magnetic equilibrium , gives essentially the same results as when obtaining equilibria with the self - consistent scheme of solving not only for the magnetic field , but also for the fluid quantities provided an equation of state describing the fluid .    using our code",
    ", we found a relatively wide range of barotropic equilibria whose magnetic fields combine an internal toroidal field and a poloidal field extending to the exterior of the star as well .",
    "fixing @xmath199 , numerical equilibria described by the piecewise function @xmath47 in eq .",
    "are poloidal - dominated , in the sense that the fraction of magnetic energy stored in the toroidal component of the magnetic field is @xmath0 , even for configurations with comparable poloidal and toroidal magnetic field strength .",
    "our numerical simulations also confirm previous results showing a maximum value of this fraction as a function of the parameter @xmath70 appearing in @xmath47 .",
    "these properties do not depend significantly on the density profile assumed , which in this work varied between several very different polytropes .",
    "numerical simulations break down for large values of @xmath70 ( @xmath201 ) . in order to obtain results beyond this limitation",
    ", we developed an analytical model which reproduces the behavior of the numerical solutions for large toroidal field .",
    "this model was able to mimic the main global properties in this regime , finding that both the fractions of magnetic fluxes and energies do have a maximum when plotted against @xmath70 , and decay to zero when @xmath70 goes to infinity .",
    "it is likely that functions providing a larger region of poloidal field lines closing inside the star give larger toroidal energy , as proposed by @xcite .",
    "this is something we can readily explore as our code accepts arbitrary functions @xmath47 and @xmath78 .",
    "also , having obtained barotropic equilibria allows to study their stability .",
    "this can be done either through time - dependent mhd simulations using the configurations we have obtained as initial condition , or by means of analyzing the change of the energy in the system when slightly perturbing the fluid inside the star , in an analogous treatment to that for non - barotropic , stably stratified stars followed by @xcite .",
    "this work was supported by conicyt international collaboration grant dfg-06 , fondecyt regular grants 1110213 , 1110135 , 1150411 and 1150718 , the basal center for astrophysics and associated technologies ( cata ; pfb-06 ) , and a conicyt master s fellowship .",
    "we thank k. n. gourgouliatos , s. k. lander , k. fujisawa , and p. marchant for having provided part of their results , which yielded very stimulating discussions , and the anonymous referee for useful comments on the first draft of this paper .",
    "we are interested in obtaining the function @xmath73 that solves the generalized gs equation , @xmath202 we do this by writing a discrete ( finite - difference ) version of this equation and solving the resulting system of algebraic equations .",
    "we discretize the space inside the star into a polar grid of @xmath80 regular intervals in the radial direction and @xmath82 in the angular direction , of length @xmath203 and @xmath204 each , respectively . on this grid ,",
    "each point is labeled by a pair @xmath205 , with coordinates @xmath206 and @xmath207 .",
    "points along the axis are those with @xmath208 ( northern hemisphere ) and @xmath209 ( southern hemisphere ) and points on the surface of the star correspond to @xmath210 .",
    "any quantity @xmath211 evaluated on a point @xmath205 is labeled as @xmath212 .",
    "the discretized gs equation reads @xmath213 where we use central difference for the derivatives .",
    "this algebraic equation is valid for @xmath214 , @xmath215",
    ". the value of @xmath29 at points lying on the axis ( @xmath216 , @xmath217 and @xmath218 ) must remain fixed equal to zero , providing a boundary condition .",
    ". actually gives @xmath219 algebraic equations for the @xmath220 unknown variables @xmath221 , @xmath222 , @xmath223 , so ( @xmath224 ) additional equations are required in order to close the system , which are obtained from the boundary conditions at the stellar surface .",
    "demanding continuity of the radial derivative of @xmath29 gives the required number of equations , @xmath225 ( see eq . ) .",
    "variables @xmath226 , standing for the value of @xmath29 at points just outside the star , can be calculated by assuming that @xmath29 outside the star is written by the multipolar expansion in eq .",
    "( with @xmath37 ) , @xmath227 again , for @xmath215 , where we have introduced the parameter @xmath83 because we can not perform the sum to infinity .",
    "the integral @xmath63 defined in eq . , and involved in expansions @xmath228 and @xmath229 , can be calculated through simpson s rule and using the points at the surface , @xmath230 .",
    "this gives @xmath231,\\ ] ] so @xmath82 must be chosen as an _ even _ natural number .",
    "of course , using this form of the expansions , we are explicitly assuming continuity of @xmath29 and its derivative with respect to @xmath54 .    when introducing the explicit form of @xmath63 in terms of the @xmath230 s , eq .",
    "gives @xmath232 new independent equations relating part of the @xmath233 unknowns on the grid , so a consistent solution of the algebraic equations may be carried out .",
    "the final system of equations to solve is @xmath234 for @xmath235 , @xmath236 , and @xmath237 for @xmath238 , where @xmath239\\ ] ] and @xmath240.\\ ] ] here , @xmath241 and @xmath242 stand for @xmath243 it is important to notice that , despite the number of equations and unknowns are equal , the system is still nonlinear as @xmath244 is in general nonlinear in @xmath29 .",
    "we developed a code in mathematica 9.0 to solve the nonlinear , algebraic system of equations in and .",
    "our code is based on a generalized newton s method of the form @xmath245 where @xmath246 , @xmath222 , @xmath238 , is the system of ( nonlinear ) equations to be solved , @xmath247 is the jacobian of the system @xmath248 and @xmath249 is an index denoting the @xmath250th iteration .",
    "the aim is to solve for the @xmath251th step given the @xmath249th one , starting from an initial seed @xmath252 until certain convergence criterion is achieved , namely , @xmath253 for all @xmath254 and @xmath255 , where @xmath117 is an arbitrary small number . notice that , in doing so , eq . is a _ linear _ system of equations , easily solved by standard methods of linear algebra when the jacobian is non - singular .",
    "once the system @xmath248 is solved , we can compute back the coefficients @xmath61 that determine @xmath29 outside the star , in this way obtaining @xmath29 everywhere .",
    "+    akgn , t. , reisenegger , a. , mastrano , a. , & marchant , p. 2013 , mnras , 433 , 2445 aurire , m. , wade , g. a. , silvester , j. , lignires , f. , bagnulo , s. , bale , k. , dintrans , b. , donati , j. f. , folsom , c. p. , gruberbauer , m. , hui bon hoa , a. , jeffers , s. , johnson , n. , landstreet , j. d. , lbre , a. , lueftinger , t. , marsden , s. , moulliet , d. , naseri , s. , paletou , f. , petit , p. , power , j. , rincon , f. , strasser , s. , & toqu , n. 2007 , a&a , 475 , 1053 braithwaite , j. 2009 , mnras , 397 , 763 braithwaite , j. , & nordlund ,  . , 2006 ,",
    "a&a , 450 , 1077 braithwaite , j. , & spruit , h. , 2004 , natur , 431 , 819 bucciantini , n. , pili , a. g. , & del zanna , l. 2015 , mnras , 447 , 3278 chandrasekhar , s. , & prendergast , k. h. 1956 , pnas , 42 , 5 ciolfi , r. , ferrari , v. , gualtieri , l. , & pons , j. a. 2009 , mnras , 397 , 913 ciolfi , r. , lander , s. k. , manca , g. , & rezzolla , l. 2011 , apjl , 736 , l6 ciolfi , r. , & rezzolla , l. 2013 , mnras , 435 , l43 donati , j. f. , & landstreet , j. 2009 , ara&a , 47 , 333 ferrario . l. , & wickramasinghe , d. 2006 , mnras , 367 , 1323 flowers , e. , & ruderman , m. a. , 1977 , apj , 215 , 302 fujisawa , k. , yoshida , s. , & eriguchi , y. 2012 , mnras , 422 , 434 fujisawa , k. , & eriguchi , y. 2013 , mnras , 432 , 1245 goldreich , p. , & reisenegger , a. 1992 , apj , 395 , 250 gourgouliatos , k. n. , cumming , a. , reisenegger , a. , armaza , c. , lyutikov , m. , & valdivia , j. a. 2013 , mnras , 434 , 2480 grad , h. , & rubin , h. 1958 , in proc .",
    "2nd int . conf . on peaceful uses of atomic energy .",
    "united nations , geneva , 31 , 190 haskell , b. , samuelsson , l. , glampedakis , k. , & andersson , n. 2008 , mnras , 385 , 531 jackson , j. d. 1975 , _ classical electrodynamics _ ( new york : wiley ) kawka , a. , vennes , s. , schmidt , g. d. , wickramasinghe , d. t. , & koch , r. 2007 , apj , 654 , 499 kiuchi , k. , shibata , m. , & yoshida , s. 2008 , phrvd , 78 , 024029 lander , s. k. , & jones , d. i. , 2009 , mnras , 395 , 2162 lander , s. k. , & jones , d. i. , 2012 , mnras , 424 , 482 lasky , p. d. , zink , b. , kokkotas , k. d. , & glampedakis , k. 2011 , apjl , 735 , l20 liebert , j. , bergeron , p. , & holberg , j. b 2003 , aj , 125 , 348 marchant , p. , reisenegger , a. , & akgn , t. 2011 , mnras , 415 , 242 markey , p. , & tayler , r. j. , 1973 , mnras , 163 , 77 mitchell , j. p. , braithwaite , j. , reisenegger , a. , spruit , h. , valdivia , j. a. , & langer , n. 2014 , mnras , 447 , 1213 monaghan , j. j. 1976 , ap&ss , 40 , 385 pethick , c. j. 1992 , in the structure and evolution of neutron stars , ed .",
    "d. pines , r. tamagaki , & s. tsuruta , 115 pili , a. g. , bucciantini n. , & del zanna , l. 2014 , mnras , 439 , 3541 prendergast , k. h. , 1956 , apj , 123 , 498 reisenegger , a. 2009 , a&a , 499 , 557 shafranov , v. d. 1966 , in _ reviews of plasma physics _ , ed . m. a. leontovich ( new york : consultants bureau ) , 2 , 103 shapiro , s. l. , & teukolsky , s. a. 1983 , _ black holes , white dwarfs , and neutron stars _",
    "( new york : wiley ) tayler , r. j. , 1973 , mnras , 161 , 365 thompson , c. , & duncan , r. c. 1996 , apj , 473 , 322 wade , g. a. , grunhut , j. , alecian , e. , et al .",
    "2014 , in iau symp .",
    "302 , magnetic fields throughout stellar evolution , ed .",
    "p. petit , m. jardine , & h. c. spruit ( cambridge : cambridge univ .",
    "press ) , 265 wright g. a. e. 1973 , mnras , 162 , 339 yoshida , s. , & eriguchi , y. 2006 , apjs , 164 , 156"
  ],
  "abstract_text": [
    "<S> upper main sequence stars , white dwarfs and neutron stars are known to possess stable , large - scale magnetic fields . </S>",
    "<S> numerical works have confirmed that stable mhd equilibria can exist in non - barotropic , stably stratified stars . on the other hand , </S>",
    "<S> it is unclear whether stable equilibria are possible in barotropic stars , although the existing evidence suggests that they are all unstable . </S>",
    "<S> this work aims to construct barotropic equilibria in order to study their properties , as a first step to test their stability . </S>",
    "<S> we have assumed that the star is a perfectly conducting , axially symmetric fluid , allowing for both poloidal and toroidal components of the magnetic field . </S>",
    "<S> in addition , we made the astrophysically justified assumption that the magnetic force has a negligible influence on the fluid structure , in which case the equilibrium is governed by the grad  shafranov equation , involving two arbitrary functions of the poloidal flux . </S>",
    "<S> we built a numerical code to solve this equation , allowing for an arbitrary prescription for these functions . </S>",
    "<S> taking particularly simple , but physically reasonable choices for these functions with a couple of adjustable parameters , all of the equilibria found present only a small ( @xmath0 ) fraction of the magnetic energy stored in the toroidal component , confirming previous results . </S>",
    "<S> we developed an analytical model in order to study in more detail the behavior of the magnetic energy over the full range of parameters . </S>",
    "<S> the model confirms that the toroidal fraction of the energy and the ratio of toroidal to poloidal flux are bounded from above for the whole range of parameters .    </S>",
    "<S> magnetohydrodynamics ( mhd ) ; stars : magnetic field ; stars : neutron ; stars : white dwarfs </S>"
  ]
}