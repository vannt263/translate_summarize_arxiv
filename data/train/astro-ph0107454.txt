{
  "article_text": [
    "computer modeling of astrophysical fluids often requires the accurate representation of densities and other fluid quantities which vary over several orders of magnitude due to the inherent compressibility of the interstellar medium .",
    "this challenge has often been met by the use of lagrangian particle methods to simulate astrophysical fluid flow .",
    "the `` particles '' in a simulation represent fluid elements .",
    "when the fluid is compressed to high densities , the particles  points where we know information about the fluid ",
    "flow with the fluid , resulting in increased resolution in the dense regions .",
    "the relative computational ease with which resolution is enhanced in a regions of increased density has made lagrangian methods very attractive to astrophysicists .",
    "grid - based methods entail great computational complexity in order to attain such a selective resolution enhancement .",
    "the drawback of lagrangian methods is that it is more difficult to achieve the desirable conservation properties characteristic of grid - based methods",
    ".    smoothed particle hydrodynamics ( sph ) is a lagrangian technique that has seen widespread use since its introduction by @xcite and @xcite two decades ago .",
    "although the technique does not provide a solution to high accuracy , sph has proven extremely valuable through its ability to yield solutions to many problems that other computational methods could not possibly tackle .    today",
    ", computational astrophysicists are seeking to extend the limits of applicability of their techniques .",
    "those using grid - based methods have turned to adaptive mesh refinement ( amr ) to push the limits of these high - accuracy methods to allow larger variation in density . for those employing sph codes ,",
    "the inclusion of magnetic fields has become a priority to apply the method to a wider range of phenomena in which the dynamical effect of magnetic fields can not be neglected .",
    "gradient particle magnetohydrodynamics ( gpm ) is a new algorithm introduced here for lagrangian simulation of magnetohydrodynamics ( mhd ) .",
    "it is , essentially , an algorithm for correctly calculating the gradient of fluid quantities in the presence of particle disorder .",
    "sph , a monte carlo technique , fails to stably include magnetic fields because of the small - scale noise inherent in monte carlo methods .",
    "gpm determines the gradients of fluid quantities exactly , rather than statistically , and therefore is not susceptible to the same magnetic tension instability arising in sph .",
    "we begin , in section  [ sec : problems ] , with a discussion of the problems with existing particle methods for hydrodynamics and describe the gpm algorithm which solves these problems . in section  [ sec : mhd ] , we describe the application of the gpm algorithm to the equations of mhd and discuss viscosity , magnetic divergence , and advanced features to be implemented in the code .",
    "analytical estimates of the error of this method are presented in section  [ sec : convergence ] .",
    "section  [ sec : valid ] presents the validation tests performed with the new gpm technique .",
    "issues arising from the validation tests are discussed in section  [ sec : disc ] and concluding remarks are made in section  [ sec : conc ] .",
    "lagrangian numerical methods for hydrodynamics face the difficult task of computing fluid forces accurately when information about the fluid is known only at a discrete set of points whose positions and number may vary .",
    "existing techniques work well when the particles are relatively ordered ; problems occur , however , when the particles become disordered ( as they often do ) . we present below a simple example in which this problem is apparent ; we then present the gpm algorithm as a solution to this problem .",
    "a fluid is modeled as a collection of particles whose positions need not fall on a regular lattice , and where dynamical forces are computed by sampling over neighboring particles @xcite .",
    "let @xmath0 be an arbitrary fluid quantity .",
    "the mean and gradient ( at @xmath1 ) are calculated by convolving neighboring particles @xmath2 with a symmetric smoothing kernel @xmath3 and a gradient kernel @xmath4 : @xmath5 the characteristic smoothing radius @xmath6 of @xmath3 is arranged to include enough neighbor particles to sample the local environment adequately , otherwise the precise form of the kernel is a matter of engineering .",
    "a spatially irregular particle distribution confounds the calculation of gradients , as is illustrated by the 1-dimensional test cases in figure  [ fig : disorder ] . for this example , let @xmath7 if @xmath8 and @xmath9 otherwise . in cases 1 and 3 the particles",
    "are regularly distributed : one each at @xmath10 and @xmath11 . the particles in cases 2 and 4 are irregularly distributed with two at @xmath12 and one at @xmath13 . in every case , the true gradient @xmath14 is equal to @xmath15 , but in cases 1 and 2 the average value of @xmath0 is @xmath9 and in cases 3 and 4 it is @xmath16 .",
    "the gradient operator @xmath17 yields the correct value in every case except number @xmath18 . here",
    ", the background value of @xmath0 introduces a gradient noise which obliterates the true gradient .",
    "additional measures must be taken to extract gradients in the presence of a background .",
    "it may also be noted that the irregular particle distributions in cases 2 and 4 disrupt the evaluation of @xmath19 .",
    "to    sph employs a similar procedure to evaluate pressure gradients .",
    "the irregular particle distribution gives rise to artificial fluctuations in the local density and pressure with a fractional magnitude of 1 , even in a globally uniform fluid .",
    "the resulting pressure gradients give rise to mach 1 fluctuating particle velocities .",
    "the physical velocity field may be obtained by spatially averaging . however , for a subsonic situation , a large number of particles must be averaged to yield a smooth flow .",
    "therefore , the resolution per particle is quite low .",
    "sph correctly captures the physics of fluid turbulence in spite of the loss of resolution from pressure gradient noise , however the inclusion of magnetic fields is inviable . consider a uniform magnetic field in a stationary fluid .",
    "the gradient noise in the induction equation will quickly produce small scale fluctuating fields with the same magnitude as the uniform field . these will give rise to extreme forces and hence even more magnetic fluctuations , resulting in instability .",
    "gpm suppresses noise in the pressure and magnetic gradients , promoting reduced particle velocity fluctuations and enabling the inclusion of magnetic fields .",
    "an additional measure may be taken to quell noise in subsonic flows . here",
    ", the physical density fluctuations have a magnitude of @xmath20 , where @xmath21 is the mach number .",
    "if the density is evaluated from local smoothing , an irregular particle distribution adds fractional density fluctuations of order unity , triggering mach number unity pressure and velocity fluctuations .",
    "this can be corrected by regarding density as a particle property which is evolved according to the continuity equation .",
    "the gpm gradient evaluation corrects for the irregular particle distribution .",
    "we first consider the 1-d case .",
    "assume that a quantity @xmath0 has a spatial profile of @xmath22 and evaluate the quantities @xmath23 @xmath24 with the sum occurring over neighboring particles inside the smoothing sphere .",
    "the smoothing kernel is @xmath25 , where @xmath6 is the smoothing length and @xmath26 is the mass of the neighbor particle .",
    "if the particles are symmetrically distributed , the @xmath27 term in ( [ disa ] ) and the @xmath28 term in ( [ disb ] ) are zero , and @xmath29 these formulae are equivalent to the sph evaluation . if the particle distribution is irregular , the @xmath30 matrix may be solved to obtain @xmath28 and @xmath27 . for three dimensions ,",
    "assume @xmath31 and solve the @xmath32 matrix .",
    "gpm can be further extended to second order by solving the @xmath33 matrix resulting from @xmath34 .",
    "second order allows the viscous and resistive terms to be evaluated directly .",
    "gpm quantities can be evaluated to a hierarchy of orders .",
    "consider the calculation of a 1d gradient of @xmath0 where @xmath35 .",
    "we have @xmath36 the magnitudes of the rhs terms for an irregular particle distribution are @xmath37 , where @xmath6 is the smoothing length and @xmath38 is the number of particles inside the smoothing sphere .",
    "terms of odd order in @xmath6 have zero mean , and for them we specify the fluctuating magnitude . terms of even order in @xmath6 have a positive mean with the specified magnitude . in the evaluation of @xmath27 ,",
    "the @xmath28 and @xmath39 terms constitute the error .",
    "the fractional error due to @xmath28 , @xmath40 , is unbounded , necessitating the simultaneous evaluation of @xmath28 and @xmath27 .",
    "the fractional error due to @xmath39 is @xmath41 .",
    "an imposed viscosity can ensure that @xmath42 is less than the rms value of @xmath27 , and so the @xmath39 term can be neglected when evaluating @xmath43 .",
    "similarly , the evaluation of @xmath39 requires @xmath28 and @xmath43 and not @xmath44 because a sufficiently smooth profile will have @xmath45 .",
    "the gpm algorithm is essentially a recipe for correctly computing gradients in a lagrangian fluid code . in this section ,",
    "we describe the application of the gpm algorithm to create a working code for mhd simulation .",
    "we first discuss the basic application to the most simple mhd system neglecting viscosity and resistivity , describing the kernel used and the spatial and temporal order of the method .",
    "next we describe the incorporation of viscosity into the code and suggest a method for the elimination of magnetic divergence .",
    "finally , advanced features to improve the method are described .",
    "the governing equations of mhd are the momentum equation , the induction equation , the continuity equation , and the energy equation :    @xmath46    @xmath47    @xmath48    @xmath49    the system of mhd equations is closed using the adiabatic equation of state @xmath50    [ cols=\"<,<,<,<\",options=\"header \" , ]",
    "sph simulations serve as a reference for several of our validation tests .",
    "standard sph is discussed in the araa review by monaghan and has seen extensive refinement since .",
    "it is based on the smoothed spatial average , here for a general quantity @xmath0 , of the form : @xmath51 where the subscript @xmath52 denotes neighboring particles .",
    "@xmath53 is a symmetric smoothing kernel with a characteristic radius @xmath6 , and @xmath54 is the gradient kernel .",
    "if @xmath0 is the density , then @xmath55    the pressure operator is symmetrized to conserve momentum .",
    "the subscript @xmath56 refers to the test particle .",
    "@xmath57 an artificial viscosity has been added through an extra pressure term @xmath58 that acts only between converging particles . @xmath59    @xmath60    the density and energy equations have similar forms . @xmath61 @xmath62",
    "we summarize here the mhd eigenvectors for arbitrary alfvn and acoustic speeds @xmath63 and @xmath64 ( shu 1992 ) , assuming only that the fluctuations are small with respect to the alfvn and acoustic speeds .",
    "the uniform magnetic component has a value of @xmath65 oriented along @xmath66 . define mean and fluctuating quantities as @xmath67 @xmath68 where the unit right - hand polarization vectors @xmath69 , @xmath70 , and @xmath71",
    "are defined by @xmath72^{1/2 } } , \\hspace{12 mm } \\hat{\\bf s}\\equiv { \\hat{{{\\bf z}}}-(\\hat{{{\\bf k}}}\\cdot\\hat{{{\\bf z}}})\\hat{{{\\bf k}}}\\over [ 1-(\\hat{{{\\bf k}}}\\cdot\\hat{{{\\bf z}}})^2]^{1/2}}. \\label{eq : polarization}\\ ] ] and @xmath73 .",
    "the alfvn wave dispersion relation is @xmath74 , and the eigenvectors are @xmath75 the dispersion relations for the fast ( + ) and slow ( - ) modes are @xmath76^{1/2 } \\right]\\ ] ] the eigenvectors are @xmath77 @xmath78 : - \\frac{v_s^2 - w^2/k^2}{v_a^2 } \\cos \\psi.\\ ] ]    acoustic waves are a special case where there is no magnetic field .",
    "the progate at the acoustic speed and have an eigenvector of @xmath79 .",
    "gpm accurately reproduces the wave speeds and eigenvectors for all three polarizations of linear waves for all propagation directions .",
    "there are two basic implementation of the cfl time control , loose and strict .",
    "consider the courant - friedrichs - lewy stability criterion that @xmath80 we can determine the timestep to use by @xmath81 where @xmath82 is the courant fraction applied to the problem .",
    "the loose implementation finds the mean nearest neighbor particle separation @xmath83 and the standard deviation of that value @xmath84 .",
    "it employs the value @xmath85 and @xmath86 where @xmath87 is the fast wave speed and @xmath88 is the fastest particle speed in the system .",
    "the strict implementation calculates the value @xmath89 for each particle and its nearest neighbor where @xmath90 is the distance to the nearest neighbor and @xmath91 .",
    "again , @xmath87 is the fast wave speed and @xmath92 is the relative velocity between the two particles .",
    "it selects the minimum value of @xmath89 in the entire system and calculates the timestep as above .",
    "note that , contrary to what the names of the two implementations suggest , for a system with a roughly uniform particle distribution , the loose implementation can actually be a more stringent control on the timestep than the strict implementation if the fastest particle in the system is used as @xmath93 .",
    "the strict implementation is absolutely necessary when a system has particle separations that vary dramatically .",
    "berger and j. oliger ,  adaptive mesh refinement for hyperbolic partial differential equations \" , j. of comput .",
    "53 , 1984 m.j .",
    "berger and p. colella ,  local adaptive mesh refinement for shock hydrodynamics \" , j. comp .",
    "phys . , 82 , 64 - 84 , 1989 borue , v. & orszag , s. a. , 1996 , j. fluid mech . , 306 , 293 .",
    "couchman , h. m. p. , thomas , p. a. , pearce , f. r. ,  hydra : an adaptive - mesh implementation of p3m - sph \" , 1995 , apj , 452 , 797 lucy , ?",
    "1977 maron , j. l. & goldreich , p. m. ,  simulations of incompressible mhd turbulence , 2001 , apj .",
    "monaghan , j.j . and",
    "gingold , r.a .",
    "1977 , ?",
    "monaghan , j.j . and",
    "gingold , r.a .",
    "1983 , j. comp . phys . , 52 , 374 monaghan , j.j .",
    "1985 , comp .",
    ", 3 , 71 monaghan , j. j. ,  smoothed particle hydrodynamics \" , 1992 , araa , 30 , 453 roache , p. j. 1975 , computational fluid dynamics .",
    "albequerque : hermosa .",
    "shu , f. ,  the physics of astrophysics ii , gas dynamics \" , 1992 sod , g. a. 1978 , journal of computational physics , 27 , 1 - 31 stone , j. & norman , m. , ",
    "zeus-2d , a radiation magnetohydrodynamics code for astrophysical flows in two space dimensions : i. the hydrodynamic algorithms and tests \" , 1992a , apjs , 80 , 753 . stone , j. & norman , m. , ",
    "zeus-2d , a radiation magnetohydrodynamics code for astrophysical flows in two space dimensions : ii . the magnetohydrodynamic algorithms and tests \" , 1992b , apjs , 80 , 791 ."
  ],
  "abstract_text": [
    "<S> we introduce gradient particle magnetohydrodynamics ( gpm ) , a new lagrangian method for magnetohydrodynamics based on gradients corrected for the locally disordered particle distribution . </S>",
    "<S> the development of a numerical code for mhd simulation using the gpm algorithm is outlined . </S>",
    "<S> validation tests simulating linear and nonlinear sound waves , linear mhd waves , advection of magnetic fields in a magnetized vortex , hydrodynamical shocks , and three - dimensional collapse are presented , demonstrating the viability of an mhd code using gpm . </S>",
    "<S> the characteristics of a gpm code are discussed and possible avenues for further development and refinement are mentioned . </S>",
    "<S> we conclude with a view of how gpm may complement other methods currently in development for the next generation of computational astrophysics . </S>"
  ]
}