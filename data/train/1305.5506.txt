{
  "article_text": [
    "judea pearl s do - calculus is a part of his theory of probabilistic causality , which itself is a part of the study of bayesian networks ( for which he is largely responsible too ) . for a good textbook on bayesian networks , see , for example , ref.@xcite by koller and friedman .",
    "the goal of this paper is to give a fairly self - contained introduction to judea pearl s do - calculus .",
    "pearl first enunciated his calculus in the 1995 paper ref.@xcite .",
    "our paper is mostly based on ref.@xcite . compared with ref.@xcite ,",
    "the scope of our paper is smaller ( for example , we do nt discuss  identifiability \" at all ) .",
    "however , for the material we do cover , we present some extra details which are not found in ref.@xcite and which might be helpful to beginners .",
    "ref.@xcite is a wonderful paper and we fully expect our readers to read it at the same time that they read this one .",
    "we just think that it might help the readers of ref.@xcite to hear the same thing explained by someone else , in slightly different words , and from a slightly different perspective .    in this paper ,",
    "we give full proofs of the 3 rules of do - calculus .",
    "our proofs are almost the same but slightly different from those found in the appendix of ref.@xcite .",
    "since 1995 , some interesting new consequences , ramifications and applications of pearl s do - calculus have been found .",
    "these were reviewed recently ( 2012 ) by pearl in ref.@xcite .",
    "in this section , we will define some basic notation that will be used later in the paper .",
    "we will use @xmath0 or @xmath1 to denote the kronecker delta function ( equals 1 if @xmath2 and 0 otherwise ) .",
    "we will indicate random variables by underlined symbols and indicate their possible values ( a.k.a . states , instances ) by the same letter , but not underlined .",
    "for example , @xmath3 takes on values @xmath4 .",
    "many people , pearl and coworkers included , indicate random variables by capital letters and their possible values by lower case letters .",
    "for example , @xmath5 takes on values @xmath4 .",
    "given a probability distribution @xmath6 , let    p(a : b)== , and    p(a : b|c)== .",
    "we will indicate n - tuples ( vectors , ordered sets ) by a letter followed by a dot , as in @xmath7 .",
    "the dot is intended to suggest that the subscript is free .",
    "many people denote n - tuples by putting an arrow over the letter ( as in @xmath8 ) or by using a boldface letter ( an in @xmath9 ) .",
    "often , we will treat two n - tuples of random variables as if they were plain sets and use them in conjunction with standard set symbols such as those for subset , union , intersection and subtraction .",
    "for example , if @xmath10 and @xmath11 are an n - tuple and an m - tuple , respectively , where @xmath12 and @xmath13 are not necessarily the same , then we might write @xmath14 , @xmath15 , @xmath16 and @xmath17 . in such contexts , we will sometimes not distinguish between @xmath18 and the singleton set @xmath19 .",
    "for example we might write @xmath20 instead of @xmath21 .",
    "a classical bayesian network is a dag ( directed acyclic graph ) where each vertex ( a.k.a .",
    "node ) is labeled by a random variable @xmath18 and is assigned a transition probability matrix about which we will say more below .",
    "let @xmath22 .",
    "arrows are also called directed edges .",
    "each node @xmath23 with an arrow going from @xmath23 to @xmath18 is called a parent of @xmath18 and the set of such parent nodes is denoted by @xmath24 .",
    "each node @xmath23 with an arrow going from @xmath18 to @xmath23 is called a child of @xmath18 and the set of such children nodes is denoted by @xmath25 .",
    "each node @xmath18 is assigned a transition probability matrix @xmath26 that depends on the value @xmath27 of node @xmath18 and the values @xmath28 of nodes @xmath24 .",
    "the entire bayesian network is assigned a total probability    p(x.)= _",
    "j=1^n p(x_j|pa(_j ) ) .",
    "in this section , we will define certain subgraphs and augmented graphs , derived from a graph @xmath29 , that will be especially useful to us later on .",
    "suppose that graph @xmath29 has nodes @xmath10 and @xmath30 .     of the nodes @xmath10 of graph @xmath29 .",
    ", height=192 ]    we can draw a frame that encloses the nodes @xmath31 and leaves the nodes @xmath32 outside .",
    "we will refer to such an enclosure as the @xmath31  corral \" ( see fig.[fig - corral ] for an example )",
    ".     arises from graph @xmath29 of fig.[fig - corral ] if we restrict @xmath29 to node set @xmath31 .",
    "arrows or nodes with a red cross through them should be erased .",
    ", height=192 ]    we will use @xmath33 to denote the  restriction \" of graph @xmath29 wherein nodes @xmath32 and any arrows connected to @xmath32 have been erased .",
    "( see fig.[fig - restriction ] for an example )",
    ".     arises from graph @xmath29 of fig.[fig - corral ] if we erase from @xmath29 all arrows entering node set @xmath31 .",
    "arrows or nodes with a red cross through them should be erased .",
    ", height=192 ]    we will use @xmath34 to denote the graph @xmath29 with arrows entering @xmath31 erased .",
    "mnemonic : think of the  hat \" on top of @xmath31 as being the arrow - head of an arrow exiting @xmath31 . only arrows of this type ( that is , those that are exiting @xmath31 ) are allowed.(see fig.[fig - in - ban ] for an example )",
    ".     arises from graph @xmath29 of fig.[fig - corral ] if we erase from @xmath29 all arrows exiting node set @xmath31 .",
    "arrows or nodes with a red cross through them should be erased .",
    ", height=192 ]    we will use @xmath35 to denote the graph @xmath29 with arrows exiting @xmath31 erased .",
    "mnemonic : think of the  vee \" on top of @xmath31 as being the arrow - head of an arrow entering @xmath31 . only arrows of this type ( that is , those that are entering @xmath31 ) are allowed.(see fig.[fig - out - ban ] for an example ) .",
    "we will use @xmath36 to denote the augmented graph obtained by adding to graph @xmath29 a node set @xmath37 and arrows from @xmath37 to node set @xmath31 ( @xmath31 is contained in @xmath29 ) . for each @xmath38 , one adds exactly one twin node @xmath39 , and one arrow from the  root \" node @xmath40 to @xmath41.(see fig.[fig - add - rt ] for an example )",
    ".     arises from graph @xmath29 of fig.[fig - corral ] if add to @xmath29 a node set @xmath37 of root nodes for @xmath31 .",
    ", height=192 ]    one can describe a set or family of graphs by using what i call a graph template . in a graph template ,",
    "some corrals have bans or restrictions on the types of arrows that are allowed to cross the fence .",
    "a ban is represented by an arrow with a red cross on it to indicate the type of arrow that is forbidden .",
    "one can ban this way either all arrows entering the corral or all arrows exiting the corral or all arrows going from one corral to another .",
    "in other words , if nodes are like cows , some corrals have one way gates that ban certain types of bovine movement .",
    "see fig.[fig - g - template ] for an example of a graph template @xmath42 .    .",
    "this one has a ban on arrows entering @xmath31 , a ban on arrows exiting @xmath43 , and a ban on arrows going from @xmath31 to @xmath44 . ,",
    "height=192 ]    for @xmath45 and @xmath46 , let @xmath47 be the set of nodes which are the children , descendants , parents and ancestors , respectively , of @xmath31 in the graph @xmath48 .",
    "we will write @xmath49 instead of @xmath47 when @xmath50 . if @xmath51 indicates application @xmath13 times of the function @xmath52 , then @xmath53 and @xmath54 . for @xmath45 ,",
    "let @xmath55 and call @xmath56 the closure of @xmath52 .",
    "in this section , we will explain the d - sep ( dependence separation ) theorem , which tells us how to diagnose from a graph @xmath29 whether @xmath31 and @xmath43 are probabilistically conditionally independent at fixed @xmath57 , where @xmath58 are disjoint subsets of nodes of @xmath29 .",
    "to @xmath43 that are blocked at fixed @xmath57 .",
    "the set @xmath59 is defined to contain all  other \" nodes ; i.e. , all nodes not in @xmath60 .",
    "note that the collider node @xmath61 can have descendants in either @xmath62 or @xmath31 .",
    "note also that even though in this figure we put @xmath61 in the @xmath59 corral , it could also be in @xmath43 or @xmath31 .",
    ", height=288 ]    suppose that graph @xmath29 has nodes @xmath10 and @xmath30 .",
    "if all the nodes in @xmath31 are like the beads in a beaded string with one arrow between adjacent beads , where the direction of the arrows may change inside the string , then we will call @xmath31 an undirected path of @xmath29 .",
    "we will use @xmath63 to denote the set of all undirected paths in graph @xmath29 that start at node @xmath64 and end at node @xmath65 . here",
    "@xmath66 means that there are @xmath67 arrows ( in whatever direction ) and @xmath68 nodes between @xmath64 and @xmath65 .",
    "we will also use @xmath69 if @xmath64 and @xmath65 could be the same node .",
    "we will also write a comma instead of a @xmath66 between the @xmath64 and @xmath65 if there is only one arrow between @xmath64 and @xmath65 .",
    "if @xmath31 and @xmath43 are disjoint subsets of @xmath10 , let @xmath70 . if @xmath71 are disjoint subsets of @xmath10 , define @xmath72 as the obvious generalization of this notation .",
    "given an undirected path @xmath73 of @xmath29 , any node which has arrows impinging upon it from both sides of the string will be called a collider node of @xmath73 .",
    "( see fig.[fig - path ] for an example ) .",
    "we will denote the set of all collider nodes of path @xmath73 by @xmath74 .",
    "suppose a graph @xmath29 has nodes @xmath10 and that @xmath10 equals the union of the disjoint sets @xmath75 and @xmath59 .",
    "@xmath76 is said to be * blocked * at fixed @xmath57 if either    * @xmath77 , or * @xmath78 $ ] .",
    "+ see fig.[fig - out - ban ] for a picture of these two types of blocked paths .",
    "i like to think of the non - collider node @xmath23 as a canyon pass which is blocked by an obstacle ( like a boulder ) in @xmath57 thus impeding information and cattle from flowing through the path . as for the collider node @xmath61 ,",
    "i like to think of it as a deep sink - hole that is an obstacle to cattle .",
    "however , if sink - hole @xmath61 is in @xmath57 or even if merely one of its descendants is in @xmath57 , then this has the effect of filling that sink - hole so that information and cattle can once again flow through the path .    by negating the previous definition",
    ", we immediately get that @xmath76 is * unblocked * at fixed @xmath57 if    * @xmath79 $ ] , and * @xmath80 $ ] .",
    "we write @xmath81 and read this as @xmath31 and @xmath43 are * d - sep * ( dependance - separated ) at fixed @xmath57 in graph @xmath29 if all @xmath82 are blocked at fixed @xmath57 .",
    "( d - sep theorem ) : @xmath81 if and only if , for all possible values of @xmath83 , @xmath84 , or , equivalently , @xmath85 .",
    "see ref.@xcite for a history of this theorem , including pertinent references .",
    "ref.@xcite also describes and gives references for an alternative graphical method , invented by lauritzen , of diagnosing d - sep .",
    "in this section , we will define two operations for pruning the arrows connected to a node .",
    "one operation ",
    "uproots the node \" , meaning that it erases all the roots ( i.e. , incoming arrows ) of the node .",
    "the other  mows the node \" , meaning that it erases all the stems ( i.e. , outgoing arrows ) of the node . uprooting a node is called an  intervention \" by pearl and co - workers .    through out this section ,",
    "let @xmath29 be a graph with nodes @xmath10 and let @xmath58 be 3 disjoints subsets of @xmath10 .",
    "* * uprooting * + we define as follows the probability that @xmath86 when @xmath87 is uprooted : + p(b.| . )",
    "= p_g(b.|a . ) . here",
    "@xmath88 is the probability distribution for the subgraph @xmath34 of @xmath29 .",
    "@xmath88 is defined from @xmath89 by replacing @xmath90 by @xmath91 for all @xmath92 .",
    "note that when we do this replacement , all the arrows entering @xmath31 ( the  roots \" of @xmath31 ) are being erased or  severed \" .",
    "+ other notations used in the literature for @xmath93 are @xmath94 ( where @xmath95 is called the do operator ) , and @xmath96 . we will sometimes write @xmath97^\\wedge$ ] instead of @xmath98 , especially when @xmath99 is a long expression . + an equivalent definition of @xmath93 is as follows .",
    "we define + p(x .- a.| . ) & = & [ eq - uprooting ] + & = & _ j:_j(.- . ) p(x_j|pa(_j ) ) .",
    "note that @xmath100 .",
    "note also that if @xmath101 , then @xmath102 .",
    "+ next we define + p(b.|.)= _ x.-(b.a . ) p(x .- a.| . ) .",
    "we also define + p(b.|.,e.)= .",
    "+ i like to call @xmath103 the probability of @xmath43 conditioned on @xmath57 , and with @xmath31 uprooted .",
    "+ yet another equivalent definition of @xmath93 is as follows . for this definition ,",
    "we begin by augmenting the graph @xmath29 to @xmath36 . in the new graph",
    ", each node @xmath41 has a new incoming arrow .",
    "we define the transition matrices for the nodes @xmath41 in the new graph from the transition matrices of the old graph as follows . for all @xmath92 and for all values @xmath104 of @xmath41 , let + p(a_j | pa(_j , g ) , rt(_j))= p(a_j)_rt(_j)^1 + p(a_j | pa(_j , g))_rt(_j)^0 .",
    "note that + \\ { + l p(b.|a.,rt(.)=0)=p(b.|a . )",
    "+ p(b.|a.,rt(.)=1)=p(b.| . ) + . , where @xmath105 for @xmath106 means @xmath107 for all @xmath92 .",
    "thus , node set @xmath37 acts like a switch .",
    "when it is on ( i.e. , when it equals 1 ) , all the roots of node set @xmath31 are severed . * * mowing * + note that + p(x.)&=&_j p(x_j|pa(_j ) ) + & = & _ j:_j(.- . )",
    "\\{p(x_j|pa(_j ) ) } _ j:_j .",
    "\\{p(x_j|pa(_j ) ) } + & = & p(x .- a.|[a.]^ ) p(a.|[x .- a.]^ ) .",
    "we define as follows the probability that @xmath108 when @xmath109 is mowed : + p_.()(x.)&= & _ a. p(a.|[x .- a.]^ ) + & = & p(x .- a.|[]^ ) p(a.|[x .- a.]^ ) .",
    "[ eq - mow - x ] note that we set to @xmath110 the value of @xmath31 at the destinations of the arrows exiting @xmath31 . by doing this",
    ", we are severing the outgoing arrows of @xmath31 .",
    "note that @xmath111 and @xmath112 .",
    "+ next we define + p_.()(a.,b . ) _ x.-(a.b . )",
    "p_.()(x . ) .",
    "+ we also define + p_.()(b.|a.,e.)= .",
    "+ note that summing both sides of eq.([eq - mow - x ] ) over @xmath113 yields + p_.()(x .- a . )",
    "= p(x .- a.|[]^ ) , [ eq - mow - x - a ] and summing both sides of eq.([eq - mow - x - a ] ) over @xmath114 yields + p_.()(b . )",
    "= p(b.|[]^ ) .",
    "let @xmath115 be the set of all possible probability distributions for @xmath10 , where @xmath10 labels the nodes of the graph @xmath29 .",
    "let @xmath116 denote the set of all linear combinations over the reals of the elements of @xmath115 .",
    "it is convenient to define linear operators acting on @xmath116 whose effect is to mow and uproot a node .",
    "let    cond_. p(a.,b . )",
    "= p(b.|a . ) .    * * uprooting * + we define as follows a linear operator @xmath117 that does uprooting of @xmath31 + _",
    ".p(a.,b.)= p(b.| . ) .",
    "[ eq - uproot - prop1 ] note that @xmath118 and @xmath119 .",
    "next we extend the domain of @xmath117 as follows so that , besides acting on @xmath116 , it can also act on a ratio of two elements of @xmath116 . + _",
    ". p(b.|a.,e.)= .",
    "[ eq - uproot - prop2 ] + _ . p(a.,b . )",
    "= p(b.| . ) , + _ . p(b . ) = _ a.p(b.| . ) , , + _ . p(b.|a . ) = p(b.| . ) , . +",
    "this all follows easily from the linearity of @xmath117 and eqs.([eq - uproot - prop1 ] ) and ( [ eq - uproot - prop2 ] ) .",
    "* * mowing * + we define as follows a linear operator @xmath120 that does mowing of @xmath31 to @xmath110 + _ .",
    "( ) p(a.,b . ) = p_.()(a.,b . ) .",
    "[ eq - mow - prop1 ] note that @xmath121 and @xmath122 . next we extend the domain of @xmath120 , as follows so that it can also act on a ratio of two elements of @xmath116 .",
    "( ) p(b.|a.,e.)= .",
    "[ eq - mow - prop2 ] + _ a. _ .",
    "( ) p(a.,b . ) = p(a.,b . ) , , + _",
    "( ) p(b . ) = p(b.| . ) , , + _ a. _ .",
    "( ) p(b.|a . ) = p(b.|a . ) , . +",
    "this all follows easily from the linearity of @xmath120 and eqs.([eq - mow - prop1 ] ) and ( [ eq - mow - prop2 ] ) .",
    "+ careful : note that @xmath123 and @xmath124 do not commute .",
    "for example , @xmath125 but @xmath126 .",
    "as the notation for @xmath93 suggests , @xmath93 and @xmath127 are similar in some ways . recall that when @xmath127 is independent of @xmath113 , we say that @xmath43 is conditional independent of @xmath31 .",
    "similarly , when @xmath93 is independent of @xmath128 , we might say that @xmath43 is independent of uprooting @xmath31 .",
    "furthermore , conditioning on @xmath31 and uprooting @xmath31 sometimes yield the same result .",
    "the following theorem , due to pearl and galles ( ref.@xcite ) gives sufficient graphical conditions under which each of these 3 situations will occur .",
    "( do - calculus rules theorem , pearl and galles ) : suppose @xmath10 is the set of all the nodes of graph @xmath29 and @xmath10 equals the union of the disjoint subsets @xmath129 and @xmath59 .",
    "( note that in all the 3 rules given below , @xmath130 has a hat permanently over it .",
    "that s why i am using @xmath131 for that variable , as a mnemonic . )    * * rule 1 ( @xmath132 ) * : + ( .. | . , . ) _",
    "g_1 g_1 = g_. iff , for all @xmath133 , + p(b.:a.|.,i.)=1 , or , equivalently , + p(b.|a.,.,i.)= p(b.|.,i . ) . *",
    "* rule 2 ( @xmath134 ) * : + ( .. |.,.)_g_2 g_2 = g_. , .",
    "iff , for all @xmath133 , + p(b.:.| .,i . ) = p(b.:a.|.,i . ) , or , equivalently , + p(b.| . ,",
    ".,i.)= p(b.|a.,.,i . ) . *",
    "* rule 3 ( @xmath135)*:if + ( .. | . , . ) _",
    "g_3 g_3 = g_. , ^ , then , for all @xmath133 , + p(b.:.|.,i.)=1 , or , equivalently , + p(b.|.,.,i.)= p(b.|.,i . ) .",
    "[ eq - goal3 ]    the proofs presented below for the do - calculus rules are the same , except for some minor modifications , as the proofs first given by pearl ( with assistance from galles for the proof of rule 3 ) in the appendix of ref .",
    "@xcite .    *",
    "* rule 1 * : by the d - sep theorem , @xmath136 iff + _ . p(b.|a.,h.,i . )",
    "= _ . p(b.|h.,i . ) .",
    "[ eq - sides1 ] if @xmath137 and @xmath138 denote the left and right hand sides of eq.([eq - sides1 ] ) , then + lhs= p(b.|a.,.,i . ) , and + rhs= p(b.|.,i . ) . *",
    "* rule 2 * : by the d - sep theorem , @xmath139 iff + _",
    "( ) _ . p(b.|a.,h.,i . ) = _ a. _ .",
    "( ) _ . p(b.|h.,i . ) . [ eq - sides2 ] if @xmath137 and @xmath138 denote the left and right hand sides of eq.([eq - sides2 ] ) , then + lhs= p(b.|a.,.,i . ) , and + rhs= p(b.|.,.,i . ) . +   and @xmath140 used in the proof of rule 3 of do - calculus rules theorem . ,",
    "height=288 ] * * rule 3 * : let @xmath141 and @xmath142 be abbreviations for the following sets of nodes : + .^-= .-an(.,g_. ) , and + .^= .an(.,g_. ) .",
    "let @xmath99 and @xmath143 denote the following statements + = ( .. | . , . ) _",
    "g_3 g_3 = g_. , ^ , and + = ( .. , ( .)| . , . )",
    "_ g_3 g_3= [ g ( . ) ] _ . .",
    "by the d - sep theorem , @xmath143 implies , for all @xmath144 , + p(b.|a.,rt(.),.,i.)= p(b.|.,i . ) .",
    "[ eq - pre - goal ] but + p(b.|a.,rt(.)=1,.,i . )",
    "= p(b.|.,.,i . ) .",
    "so @xmath143 implies eq.([eq - goal3 ] ) .",
    "hence we ll be done with the proof if we can prove that @xmath99 implies @xmath143 .",
    "let s prove this by proving the contrapositive @xmath145 implies @xmath146 .",
    "if @xmath145 , then there exists a path @xmath73 which is unblocked at fixed @xmath147 , and which satisfies + path_tg_3 ( < < <  < , ( ) ) , where @xmath148 , @xmath149",
    ". here @xmath150 is the unique node in @xmath73 that belongs to @xmath31 and is closest to @xmath65 .",
    "but then there is a shorter path @xmath151 in @xmath140 that is also unblocked at fixed @xmath152 , + _ opath_t ( < , ( ) ) , [ eq - gamma - o ] where @xmath153 .",
    "if we can show that @xmath151 is unblocked at fixed @xmath152 and also satisfies eq.([eq - gamma - o ] ) with @xmath154 instead of the bigger set @xmath155 , then we ll be done .",
    "as shown in fig.[fig - rule-3 ] , template @xmath156 has the same bans as template @xmath157 plus an additional ban on arrows entering @xmath158 .",
    "so we need to show that @xmath151 has no arrows entering @xmath158 .",
    "such an arrow would have to enter node @xmath159 .",
    "if @xmath160 , then there is no arrow of @xmath151 entering @xmath158 and we are done . if @xmath161 , then there are two possibilities , either @xmath162 or not .",
    "+ if @xmath163 , since there is an arrow pointing from @xmath164 to @xmath159 , there must be an arrow pointing from @xmath159 to a node outside of @xmath158 .",
    "thus , there are no arrows in @xmath151 entering @xmath158 and we are done .",
    "+ if @xmath162 , then , since @xmath151 is unblocked at fixed @xmath152 , we must have @xmath165 .",
    "but this is impossible since as shown by fig.[fig - rule-3 ] , in @xmath156 no arrow can enter @xmath130 and no arrow from @xmath158 can enter @xmath166 .",
    "j. pearl ,  causal diagrams for empirical research \" , r-218-b .",
    "( available in pdf format at j. pearl s website ) biometrika 82 , 669 - 710 ( 1975 ) j. pearl ,  the do - calculus revisited \" , keynote lecture aug .",
    "17 , 2012 , uai-2012 .",
    "( available in pdf format at j. pearl s website )"
  ],
  "abstract_text": [
    "<S> this is a purely pedagogical paper with no new results . </S>",
    "<S> the goal of the paper is to give a fairly self - contained introduction to judea pearl s do - calculus , including proofs of his 3 rules . </S>"
  ]
}