{
  "article_text": [
    "a binomial is a polynomial with at most two terms ; a binomial ideal is an ideal generated by binomials .",
    "binomial ideals abound as the defining ideals of classical algebraic varieties , particularly because equivariantly embedded affine or projective toric varieties correspond to prime binomial ideals .    in fact",
    ", the zero set of any binomial ideal is a union of ( translated ) toric varieties .",
    "thus , binomial ideals are `` easy '' in geometric terms , and one may hope that their algebra is simple as well .",
    "this is indeed the case : the associated primes of a binomial ideal are essentially toric ideals , and their corresponding primary components can be chosen binomial as well .",
    "these results , due to eisenbud and sturmfels @xcite , are concrete when it comes to specifying associated primes , but less so when it comes to primary components themselves , in part because of difficulty in identifying the monomials therein .",
    "the main goal of this article is to provide explicit lattice - point combinatorial realizations of the primary components of an arbitrary binomial ideal in a polynomial ring over an algebraically closed field of characteristic zero ; this is achieved in theorems  [ t : components ] and  [ t : toral ] .",
    "these are proved by way of our other core result , theorem  [ t : zerocomp ] , which combinatorially characterizes , in the setting of an affine semigroup ring over an arbitrary field ( not required to be algebraically closed or of characteristic zero ) , primary binomial ideals whose associated prime comes from a face of the semigroup .",
    "the hypotheses on the field  @xmath0 are forced upon us , when they occur .",
    "consider the univariate case : in the polynomial ring @xmath1 $ ] , primary decomposition is equivalent to factorization of polynomials .",
    "factorization into binomials in this setting is the fundamental theorem of algebra , which requires @xmath0 to be algebraically closed . on the other hand",
    ", @xmath0 must have characteristic zero because of the slightly different behavior of binomial primary decomposition in positive characteristic @xcite : in characteristic zero , every primary binomial ideal contains all of the non - monomial ( i.e. , two - term binomial ) generators of its associated prime , but this is false in positive characteristic .",
    "the motivation and inspiration for this work came from the theory of hypergeometric differential equations , and the results here are used heavily in the companion article @xcite ( see section  [ s : applications ] for an overview of these applications ) .",
    "in fact , these two projects began with a conjectural expression for the non fully suppported solutions of a horn hypergeometric system ; its proof reduced quickly to the statement of corollary  [ c : i(b ) ] , which directed all of the developments here .",
    "our consequent use of @xmath2-subgraphs ( definition  [ d : m ] ) , and more generally the application of commutative monoid congruences toward the primary decomposition of binomial ideals , serves as an advertisement for hypergeometric intuition as inspiration for developments of independent interest in combinatorics and commutative algebra .",
    "the explicit lattice - point binomial primary decompositions in sections  [ s : primary ] and  [ s : toral ] have potential applications beyond hypergeometric systems .",
    "consider the special case of monomial ideals : certain constructions at the interface between commutative algebra and algebraic geometry , such as integral closure and multiplier ideals , admit concrete convex polyhedral descriptions .",
    "the path is now open to attempt analogous constructions for binomial ideals .",
    "the central combinatorial idea behind binomial primary decomposition is elementary and concrete , so we describe it geometrically here .",
    "the notation below is meant to be intuitive , but in any case it coincides with the notation formally defined later .    fix an arbitrary binomial ideal @xmath3 in a polynomial ring , or more generally in any affine semigroup ring @xmath4 $ ] .",
    "then @xmath3 determines an equivalence relation ( _ congruence _ ) on  @xmath4 $ ] in which two elements @xmath5 are congruent , written @xmath6 , if @xmath7 for some @xmath8 . if one makes a graph with vertex set @xmath9 by drawing an edge from @xmath10 to @xmath11 when @xmath12 , then the congruence classes of @xmath13 are the connected components of this graph .",
    "for example , for an integer matrix @xmath14 with @xmath15 columns , the _ toric ideal _",
    "@xmath16 = { { \\ensuremath{\\mathbb{c}}}}[{\\mathbf{t } } ] = { { \\ensuremath{\\mathbb{c}}}}[{{\\ensuremath{\\mathbb{n}}}}^n]\\ ] ] determines the congruence in which the class of @xmath17 consists of the set @xmath18 of lattice points in the polyhedron @xmath19    the set of congruence classes for @xmath20 can be thought of as a periodically spaced archipelago whose islands have roughly similar shape ( but steadily grow in size as the class moves interior to  @xmath21 ) . with this picture in mind ,",
    "the congruence classes for any binomial ideal  @xmath3 come in a finite family of such archipelagos , but instead of each island coming with a shape predictable from its archipelago , its boundary becomes fragmented into a number of surrounding skerries . the extent to which a binomial ideal deviates from primality",
    "is measured by which bridges must be built  and in which directions  to join the islands to their skerries .    when @xmath22 is an orthant as in the previous example , each prime binomial ideal in @xmath23 = { { \\ensuremath{\\mathbb{c}}}}[{{\\ensuremath{\\mathbb{n}}}}^n]$ ] equals the sum @xmath24 of a prime binomial ideal  @xmath25 containing no monomials and a prime monomial ideal  @xmath26 generated by the variables whose indices lie outside of a subset @xmath27 .",
    "the ideal @xmath25 is a toric ideal after rescaling the variables , so its congruence classes are parallel to a sublattice @xmath28 ; in the notation above , @xmath29 .",
    "now suppose that @xmath30 is associated to our binomial ideal @xmath3 .",
    "joining the aforementioned skerries to their islands is accomplished by considering congruences defined by @xmath31 : a bridge is built from @xmath10 to  @xmath11 whenever @xmath32 .    to be more accurate ,",
    "just as @xmath31 determines a congruence on  @xmath21 , it determines one  after inverting the variables outside of  @xmath26on @xmath33 , where @xmath34 , and @xmath35 is defined analogously for the index subset  @xmath36 complementary to  @xmath37 . each resulting class in @xmath33 is acted upon by  @xmath38 and hence is a union of cosets of  @xmath38 .",
    "the key observation is that , when @xmath24 is an associated prime of  @xmath3 , some of these classes consist of finitely many cosets of  @xmath38 ; let us call these _ @xmath38-bounded _ classes .",
    "the presence of @xmath38-bounded classes signals that @xmath38 is `` sufficiently parallel '' to the congruence determined by  @xmath3 , and this is how we visualize the manner in which @xmath24 is associated to  @xmath3 .",
    "intersecting the @xmath38-bounded @xmath33 congruence classes with @xmath21 yields _ @xmath38-bounded _ classes in  @xmath21 ; again , these are constructed more or less by building bridges in directions from  @xmath38 to join the classes defined by  @xmath3 . when the prime @xmath30 is minimal over  @xmath3 , there are only finitely many @xmath38-bounded classes in @xmath21 . in this case , the primary component @xmath39 of  @xmath3 is well - defined , as reflected in its combinatorics : the congruence defined on  @xmath21 by @xmath39 has one huge class consisting of the lattice points in  @xmath21 lying in no @xmath38-bounded class , and each of its remaining classes is @xmath38-bounded in  @xmath21 ; this is the content of theorem  [ t : components].1 .",
    "the only difference for a nonminimal associated prime of  @xmath3 is that the huge class is inflated by swallowing all but a sufficiently large finite number of the @xmath38-bounded classes ; this is the content of the remaining parts of theorem  [ t : components ] . here , `` sufficiently large '' means that every swallowed @xmath38-bounded class contains a lattice point  @xmath10 with @xmath40 lying .    in applications ,",
    "binomial ideals often arise in the presence of multigradings .",
    "( one reason for this is that binomial structures are closely related to algebraic tori , whose actions on varieties induce multigradings on coordinate rings . ) in this context , the matrix  @xmath14 above induces the grading : monomials @xmath40 and @xmath41 have equal degree if and only if @xmath42 .",
    "theorem  [ t : toral ] expounds on the observation that if @xmath43 , then a congruence class for @xmath31 in @xmath33 is @xmath38-bounded if and only if its image in @xmath44 is finite .",
    "this simplifies the description of the primary components because , to describe the set of monomials in a primary component , it suffices to refer to lattice point geometry in @xmath44 , without mentioning @xmath45 .",
    "when it comes to proofs , the crucial insight is that the geometry of @xmath38-bounded classes for the congruence determined by @xmath31 gives rise to simpler algebra when @xmath33 is reduced modulo the action of  @xmath38 .",
    "equivalently , instead of considering the associated prime @xmath24 of an arbitrary binomial ideal  @xmath3 in  @xmath46 $ ] , consider the prime image of the monomial ideal @xmath26 associated to the image of  @xmath3 in @xmath23 = { { \\ensuremath{\\mathbb{c}}}}[{\\mathbf{t}}]/{{\\mathfrak p}}$ ] , where @xmath47 . since monomial primes in an affine semigroup ring @xmath23 $ ] correspond to faces of  @xmath9 , the lattice point geometry is more obvious in this setting , and the algebra is sufficiently uncomplicated that it works over an arbitrary field in place of  @xmath48 .",
    "if @xmath49 is a face of an arbitrary affine semigroup  @xmath9 whose corresponding prime @xmath50 is minimal over a binomial ideal  @xmath3 in  @xmath4 $ ] , then @xmath3 determines a congruence on the semigroup @xmath51 obtained from @xmath9 by allowing negatives for  @xmath49 . the main result in this context , theorem  [ t : zerocomp ]",
    ", says that the monomials @xmath40 in the @xmath50-primary component of  @xmath3 are precisely those corresponding to lattice points @xmath52 not lying in any finite congruence class of @xmath51 .",
    "this , in turn , is proved by translating lattice point geometry and combinatorics into semigroup - graded commutative algebra in proposition  [ p : graded ] .",
    "this project benefited greatly from visits by its various authors to the university of pennsylvania , texas a&m university , the institute for mathematics and its applications ( i m a ) in minneapolis , the university of minnesota , and the centre international de rencontres mathmatiques in luminy ( cirm ) .",
    "we thank these institutions for their gracious hospitality .",
    "our eventual goal is to analyze the primary components of binomial ideals in polynomial rings over the complex numbers  @xmath48 or any algebraically closed field of characteristic zero .",
    "our principal result along these lines ( theorem  [ t : components ] ) is little more than a rephrasing of a statement ( theorem  [ t : zerocomp ] ) about binomial ideals in arbitrary affine semigroup rings in which the associated prime comes from a face , combined with results of eisenbud and sturmfels @xcite .",
    "the developments here stem from the observation that quotients by binomial ideals are naturally graded by noetherian commutative monoids .",
    "our source for such monoids is gilmer s excellent book @xcite .",
    "for the special case of affine semigroups , by which we mean finitely generated submonoids of free abelian groups , see ( * ? ? ?",
    "* chapter  7 ) .",
    "we work in this section over an arbitrary field  @xmath0 , so it might be neither algebraically closed nor of .    [",
    "d : congruence ] a _ congruence _ on a commutative monoid  @xmath9 is an equivalence relation @xmath13 with @xmath53 the _ quotient monoid _ @xmath54@xmath13 is the set of equivalence classes under addition .",
    "[ d : iql ] the _ semigroup algebra _",
    "$ ] is the direct sum @xmath55 , with multiplication @xmath56 .",
    "any congruence @xmath13 on  @xmath9 induces a @xmath57@xmath58-grading on @xmath4 $ ] in which the _ monomial _",
    "@xmath40 has degree  @xmath59@xmath13 whenever @xmath60 .",
    "binomial ideal _ @xmath61",
    "$ ] is an ideal generated by",
    "_ binomials _",
    "@xmath62 , where @xmath63 is a scalar , possibly equal to zero .",
    "[ ex : q = nn ] a _ pure difference _",
    "binomial ideal is generated by differences of monic monomials .",
    "given an integer matrix @xmath2 with @xmath64  rows , we call @xmath65 = { \\bbbk}[{{\\ensuremath{\\mathbb{n}}}}^q]$ ] the pure difference binomial ideal @xmath66 here and in the remainder of this article we adopt the convention that , for an integer vector @xmath67 , the vector @xmath68 has @xmath69 coordinate @xmath70 if @xmath71 and @xmath72 otherwise .",
    "the vector @xmath73 is defined by @xmath74 , or equivalently , @xmath75 . if the columns of @xmath2 are linearly independent , the ideal @xmath76 is called a _ lattice basis ideal _ ( cf.example  [ ex : i(b ) ] ) .",
    "an ideal of @xmath77 $ ] has the form described in  ( [ eq : im ] ) if and only if it is generated by differences of monomials with disjoint  support .",
    "the equality of the two definitions in  ( [ eq : im ] ) is easy to see : the ideal in the first line of the display contains the ideal in the second line by definition ; and the disjointness of the supports of @xmath68 and  @xmath78 implies that whenever @xmath79 is a column of  @xmath2 , and denoting by @xmath80 , we have that the corresponding generator of the first ideal @xmath81 , lies in the second ideal .",
    "[ p : sim ] a binomial ideal @xmath61 $ ] determines a congruence @xmath82 under which @xmath83 the ideal @xmath3 is graded by the quotient monoid @xmath84@xmath82 , and @xmath4/i$ ] has @xmath85-graded hilbert function  @xmath86 on every congruence class except the class @xmath87 of monomials .    that @xmath82 is an equivalence relation is because @xmath7 and @xmath88 implies @xmath89 .",
    "it is a congruence because @xmath90 implies that @xmath91 .",
    "the rest is similarly straightforward .    in the case of a pure difference binomial ideal @xmath76 as in example  [ ex : q = nn ] , the congruence classes under  @xmath92 from proposition  [ p : sim ] are the @xmath2-subgraphs in the following definition , which  aside from being a good way to visualize congruence classes",
    " will be useful later on ( see example  [ ex : um ] and corollary  [ c : i(b ) ] , as well as section  [ s : applications ] ) .",
    "[ d : m ] any integer matrix @xmath2 with @xmath64 rows defines an undirected graph  @xmath93 having vertex set @xmath94 and an edge from @xmath10 to  @xmath11 if @xmath95 or @xmath96 is a column of  @xmath2 .",
    "an _ @xmath2-path _ from @xmath10 to  @xmath11 is a path in  @xmath93 from @xmath10 to  @xmath11 .",
    "a subset of  @xmath94 is _ @xmath2-connected _ if every pair of vertices therein is joined by an @xmath2-path passing only through vertices in the subset",
    ". an _ @xmath2-subgraph _ of  @xmath94 is a maximal @xmath2-connected subset of  @xmath94 ( a connected component of  @xmath93 ) .",
    "an @xmath2-subgraph is _ bounded _ if it has finitely many vertices , and _ unbounded _ otherwise .",
    "( see example  [ ex : concrete - subgraph ] for a concrete computation and an illustrative figure . )",
    "these @xmath2-subgraphs bear a marked resemblance to the concept of _ fiber _ in .",
    "the interested reader will note , however , that even if these two notions have the same flavor , their definitions have mutually exclusive assumptions , since for a square matrix  @xmath2 , the corresponding matrix  @xmath14 in is empty .",
    "given a face  @xmath49 of an affine semigroup @xmath97 , the _ localization _ of  @xmath9 along  @xmath49 is the affine semigroup @xmath98 obtained from  @xmath9 by adjoining negatives of the elements in  @xmath49 .",
    "the algebraic version of this notion is a common tool for affine semigroup rings ( * ? ? ?",
    "* chapter  7 ) : for each @xmath4$]-module @xmath99 , let @xmath100 $ ] denote its _ homogeneous localization _ along  @xmath49 , obtained by inverting @xmath101 for all @xmath102 . for example , @xmath4[{{\\ensuremath{\\mathbb{z}}}}\\phi ] \\cong { \\bbbk}[q+{{\\ensuremath{\\mathbb{z}}}}\\phi]$ ] . writing @xmath103\\ ] ] for the prime ideal of the face  @xmath49 , so that @xmath4/{{\\mathfrak p}}_\\phi = { \\bbbk}[\\phi]$ ] is the affine semigroup ring for  @xmath49 , we find , as a consequence , that @xmath104 = { { \\mathfrak p}}_{{{\\ensuremath{\\mathbb{z}}}}\\phi } \\subseteq { \\bbbk}[q+{{\\ensuremath{\\mathbb{z}}}}\\phi]$ ] , because @xmath105/{{\\mathfrak p}}_\\phi[{{\\ensuremath{\\mathbb{z}}}}\\phi ] = ( { \\bbbk}[q]/{{\\mathfrak p}}_\\phi)[{{\\ensuremath{\\mathbb{z}}}}\\phi]=    { \\bbbk}[\\phi][{{\\ensuremath{\\mathbb{z}}}}\\phi ] = { \\bbbk}[{{\\ensuremath{\\mathbb{z}}}}\\phi].\\ ] ] ( we write equality signs to denote canonical isomorphisms . ) for any ideal @xmath61 $ ] , the localization @xmath106 $ ] equals the extension @xmath107 $ ] of  @xmath3 to @xmath108 $ ] , and we write @xmath109 \\cap { \\bbbk}[q],\\ ] ] the intersection taking place in @xmath108 $ ] .",
    "equivalently , @xmath110 is the usual colon ideal @xmath111 for any element @xmath112 sufficiently interior to  @xmath49 ( for example , take @xmath112 to be a high multiple of the sum of the generators of  @xmath49 ) ; in particular , @xmath110 is a binomial ideal when @xmath3 is .    for the purpose of investigating @xmath50-primary components ,",
    "the ideal @xmath110 is as good as  @xmath3 itself , since this colon operation does not affect such components , or better , since the natural map from @xmath4/(i:{\\mathbf{t}}^\\phi)$ ] to its homogeneous localization along  @xmath49 is injective .",
    "combinatorially , what this means is the following .",
    "a subset @xmath113 is a congruence class in @xmath114 determined by @xmath110 if and only if @xmath115 for some class @xmath116 under the congruence  @xmath117}$ ] .",
    "[ l : distinct ] if a congruence class @xmath116 under @xmath117}$ ] has two distinct elements whose difference lies in  @xmath118 , then for all @xmath60 the monomial @xmath40 maps to  @xmath72 in the ( usual inhomogeneous ) localization @xmath119/i)_{{{\\mathfrak p}}_\\phi}$ ] inverting all elements not in  @xmath50 .",
    "suppose @xmath120 with @xmath121 .",
    "the images in  @xmath4/i$ ] of the monomials @xmath40 for @xmath60 are nonzero scalar multiples of each other , so it is enough to show that @xmath41 maps to zero in  @xmath119/i)_{{{\\mathfrak p}}_\\phi}$ ] . since @xmath122",
    ", we have @xmath123 $ ]",
    ". therefore @xmath124 lies outside of  @xmath125 for all @xmath126 , because its image in  @xmath127 = { \\bbbk}[q+ { { \\ensuremath{\\mathbb{z}}}}\\phi]/{{\\mathfrak p}}_{{{\\ensuremath{\\mathbb{z}}}}\\phi}$ ] is either @xmath124 or  @xmath86 , according to whether or not @xmath128 .",
    "( the assumption @xmath129 was used here : if @xmath130 , then for @xmath131 , we have @xmath132 . )",
    "hence @xmath124 maps to a unit in  @xmath119/i)_{{{\\mathfrak p}}_\\phi}$ ] .",
    "it follows that @xmath41 maps to  @xmath72 , since @xmath133 maps to  @xmath72 in  @xmath4/i$ ] whenever @xmath134 .",
    "[ l : unbounded ] a congruence class @xmath116 under @xmath117}$ ] is infinite if and only if it contains two distinct elements whose difference lies in  @xmath118 .",
    "let @xmath116 be a congruence class . if @xmath135 and @xmath136 , then @xmath137 for all positive @xmath138 .",
    "on the other hand , assume @xmath139 is infinite .",
    "there are two possibilities : either there are @xmath140 with @xmath141 , or not .",
    "if so , then we are done , so assume not .",
    "let @xmath142 be the quotient of @xmath143 modulo its torsion subgroup .",
    "( here @xmath144 is the ambient lattice of @xmath9 . ) the projection @xmath145 induces a map from @xmath139 to its image  @xmath146 that is finite - to - one .",
    "more precisely , if @xmath147 is the intersection of  @xmath139 with a coset of @xmath148 in  @xmath149 , then @xmath147 maps bijectively to its image  @xmath150 .",
    "there are only finitely many cosets , so some  @xmath147 must be infinite , along with  @xmath150 . but",
    "@xmath150 is a subset of the affine semigroup  @xmath151 , defined as the image of @xmath51 in  @xmath142 .",
    "as @xmath151 has unit group zero , every infinite subset contains two points whose difference lies in  @xmath151 , and the corresponding lifts of these to  @xmath147 have their difference in @xmath51 .",
    "[ d : u ] fix a face @xmath49 of an affine semigroup  @xmath9 .",
    "a subset @xmath152 is an _ ideal _ if @xmath153 , and in that case we write @xmath154 for the monomial ideal in  @xmath4 $ ] having @xmath155 as its @xmath0-basis .",
    "an ideal  @xmath155 is _ @xmath148-closed _",
    "if @xmath156 . if  @xmath13 is a congruence on @xmath118 , then the _ unbounded ideal _",
    "@xmath157 is the ( @xmath148-closed ) ideal of elements @xmath52 with infinite congruence class under  @xmath13 in @xmath51 .",
    "finally , write @xmath158 for the set of bounded ( i.e.  finite ) congruence classes of @xmath118 under @xmath13 .",
    "[ ex : um ] let @xmath2 be as in definition  [ d : m ] and consider the congruence @xmath92 on @xmath159 .",
    "if @xmath160 , then the unbounded ideal @xmath161 is the union of the unbounded @xmath2-subgraphs of  @xmath94 , while @xmath162 is the union of the bounded @xmath2-subgraphs .",
    "[ p : graded ] fix a face @xmath49 of an affine semigroup  @xmath9 , a binomial ideal @xmath163 $ ] , and a @xmath148-closed ideal @xmath164 containing @xmath165 under the congruence @xmath117}$ ] .",
    "write @xmath166 for the bounded classes , @xmath37 for the binomial ideal @xmath167 , and @xmath168}$ ] .",
    "@xmath4/j$ ] is graded by @xmath169 , and its set of nonzero degrees is contained in  @xmath170 .",
    "the group @xmath171 acts freely on  @xmath170 , and the @xmath172$]-submodule @xmath119/j)_t \\subseteq { \\bbbk}[q]/j$ ] in degrees from any orbit @xmath173 is  @xmath72 or finitely generated and torsion - free of rank  @xmath86 .",
    "the quotient @xmath174 of the monoid @xmath175}$ ] by its subgroup @xmath148 is a partially ordered set if we define @xmath176 whenever @xmath177 for some @xmath178 .",
    "@xmath4/j$ ] is filtered by @xmath169-graded @xmath4$]-submodules with associated graded module @xmath179/j ) = \\bigoplus_{t \\in { { \\mathcal b}}/\\phi } ( { \\bbbk}[q]/j)_t , \\quad    \\text{where } { { \\mathcal b}}/\\phi = \\{{{\\ensuremath{\\mathbb{z}}}}\\phi\\text{\\rm -orbits } t \\subseteq { { \\mathcal b}}\\},\\ ] ] the canonical isomorphism being as @xmath170-graded @xmath172$]-modules , although the left - hand side is naturally a @xmath4$]-module annihilated by  @xmath50 .",
    "if @xmath119/j)_t \\neq 0 $ ] for only finitely many orbits @xmath180 , then @xmath37 is a @xmath50-primary ideal .",
    "the quotient @xmath4/(i:{\\mathbf{t}}^\\phi)$ ] is automatically @xmath169-graded by proposition  [ p : sim ] applied to @xmath118 and @xmath106 $ ] , given  ( [ eq : i : phi ] ) .",
    "the further quotient by  @xmath181 is graded by @xmath170 because  .",
    "@xmath148 acts freely on  @xmath170 by lemmas  [",
    "l : distinct ] and  [ l : unbounded ] : if @xmath182 and @xmath139 is a bounded congruence class , then the translate @xmath183 is , as well ; and if @xmath184 then @xmath185 , because each coset of  @xmath148 intersects @xmath139 at most once .",
    "combined with the @xmath148-closedness of  @xmath155 , this shows that @xmath4/j$ ] is a @xmath172$]-submodule of the free @xmath127$]-module whose basis consists of the @xmath148-orbits @xmath173 .",
    "hence @xmath119/j)_t$ ] is torsion - free ( it might be zero , of course , if @xmath155 happens to contain all of the monomials corresponding to congruence classes of  @xmath9 arising from @xmath117}$ ] classes in  @xmath186 ) . for item  2 , it remains to show that @xmath119/j)_t$ ] is finitely generated .",
    "let . by construction , @xmath187 is the ( finite ) union of the intersections @xmath188 of @xmath9 with cosets of  @xmath148 in  @xmath144 for @xmath189 in any fixed @xmath190 .",
    "such an intersection is a finitely generated @xmath49-set ( a set closed under addition by  @xmath49 ) by ( * ? ? ?",
    "* eq .  ( 1 ) and lemma  2.2 ) or ( * ? ? ? * theorem  11.13 ) , where the @xmath0-vector space it spans is identified as the set of monomials annihilated by  @xmath172 $ ] modulo an irreducible monomial ideal of  @xmath4 $ ] .",
    "the images in @xmath4/j$ ] of the monomials corresponding to any generators for these @xmath49-sets generate @xmath119/j)_t$ ] .",
    "the point of item  3 is that the monoid @xmath174 acts sufficiently like an affine semigroup whose only unit is the trivial one . to prove it ,",
    "observe that @xmath174 consists , by item  1 , of the ( possibly empty set of ) orbits @xmath191 such that @xmath119/j)_t \\neq 0 $ ] plus one congruence class @xmath192 for the monomials in  @xmath37 ( if there are any ) .",
    "the proposed partial order has @xmath193 for all orbits @xmath194 , and also @xmath195 if and only if @xmath196 .",
    "this relation  @xmath197 a  priori defines a directed graph with vertex set  @xmath174 , and we need it to have no directed cycles .",
    "the terminal nature of  @xmath192 implies that no cycle can contain  @xmath192 , so suppose that @xmath198 . for some @xmath199 , the translate @xmath200 lies in the same congruence class under @xmath117}$ ] as @xmath201 .",
    "l : unbounded ] implies that @xmath202 , and hence @xmath11 itself , does not lie in @xmath118 .    for item  4 , it suffices to find a total order @xmath203 on @xmath204 such that is a @xmath4$]-submodule for all @xmath205 .",
    "use the partial order of @xmath204 via its inclusion in the monoid @xmath174 in item  3 for @xmath206 . any well - order refining",
    "this partial order will do .",
    "item  5 follows from items  2 and  4 because the associated primes of @xmath207/j)$ ] contain every associated prime of  @xmath37 for any finite filtration of @xmath4/j$ ] by @xmath4$]-submodules .    for connections with toral modules ( definition  [ d : toral ] ) ,",
    "we record the following .",
    "[ c : graded ] fix notation as in proposition  [ p : graded ] . if @xmath3 is homogeneous for a grading of  @xmath4 $ ] by a group  @xmath208 via a monoid morphism @xmath209",
    ", then @xmath4/j$ ] and @xmath210/j)$ ] are @xmath208-graded via a natural coarsening @xmath211 that restricts to a group homomorphism @xmath212 .",
    "the morphism @xmath209 induces a morphism @xmath213 by the universal property of monoid localization .",
    "the morphism  @xmath214 is constant on the non - monomial congruence classes in  @xmath85 precisely because @xmath3 is @xmath208-graded .",
    "it follows that @xmath214 is constant on the non - monomial congruence classes in  @xmath215}$ ] .",
    "in particular , @xmath214 is constant on the bounded classes @xmath158 , which therefore map to  @xmath208 to yield the natural coarsening .",
    "the group homomorphism @xmath216 is induced by the composite morphism @xmath217 , which identifies the group @xmath148 with the @xmath148-orbit in  @xmath170 containing ( the class of )  @xmath72 .",
    "[ t : zerocomp ] fix a face @xmath49 of an affine semigroup  @xmath9 and a binomial ideal @xmath163 $ ] .",
    "if @xmath50 is minimal over  @xmath3 , then the @xmath50-primary component of  @xmath3 is @xmath218 , where @xmath110 is the binomial ideal  ( [ eq : i : phi ] ) and @xmath219 is the unbounded ideal ( definition  [ d : u ] ) for @xmath117}$ ] .",
    "furthermore , the only monomials in @xmath218 are those of the form @xmath40 for @xmath220 .",
    "the @xmath50-primary component of  @xmath3 is the kernel of the localization homomorphism @xmath4 \\to ( { \\bbbk}[q]/i)_{{{\\mathfrak p}}_\\phi}$ ] . as this factors through the homogeneous localization @xmath108/i[{{\\ensuremath{\\mathbb{z}}}}\\phi]$ ] , we find that the kernel contains @xmath110 . lemmas  [ l : distinct ] and  [ l : unbounded ] imply that the kernel contains  @xmath221 .",
    "but already @xmath222 is @xmath50-primary by proposition  [ p : graded].5 ; the finiteness condition there is satisfied by minimality of  @xmath50 applied to the filtration in proposition  [ p : graded].4 .",
    "thus the quotient of @xmath4 $ ] by @xmath218 maps injectively to its localization at  @xmath50 . to prove the last sentence of the theorem , observe that under the @xmath169-grading from proposition  [ p : graded].1 , every monomial  @xmath40 outside of  @xmath221 maps to a @xmath0-vector space basis for the ( @xmath86-dimensional ) graded piece corresponding to the bounded congruence class containing  @xmath10",
    ".    one might hope that when @xmath50 is an embedded prime of a binomial ideal  @xmath3 , the @xmath50-primary components , or even perhaps the irreducible components , would be unique , if we require that they be finely graded ( hilbert function @xmath72 or  @xmath86 ) as in proposition  [ p : graded ] .",
    "however , this fails even in simple examples , such as @xmath223/{\\langle}x^2-xy , xy - y^2{\\rangle}$ ] . in this case , @xmath224 and @xmath49 is the face @xmath225 of  @xmath226 , so that @xmath227 by definition .",
    "the monoid @xmath85 , written multiplicatively , consists of @xmath86 , @xmath228 , @xmath229 , and a single element of degree  @xmath230 for each @xmath231 representing the congruence class of the monomials of total degree  @xmath230 .",
    "our two choices @xmath232 and @xmath233 for the irreducible component with associated prime  @xmath234 yield quotients of  @xmath223 $ ] with different @xmath85-graded hilbert functions , the first nonzero in degree  @xmath228 and the second nonzero in degree  @xmath229 .",
    "in this section , we express the primary components of binomial ideals in polynomial rings over the complex numbers as explicit sums of binomial and monomial ideals .",
    "we formulate our main result , theorem  [ t : components ] , after recalling some essential results from @xcite . in this section",
    "we work with the complex polynomial ring @xmath235 $ ] in ( commuting ) variables @xmath236 .",
    "if @xmath237 is a sublattice , then with notation as in example  [ ex : q = nn ] , the _ lattice ideal _ of  @xmath38 is @xmath238 more generally , any _ partial character _ @xmath239 of  @xmath240 , which includes the data of both its domain lattice @xmath241 and the map to  @xmath242 , determines a binomial ideal @xmath243 ( the ideal  @xmath244 is called @xmath245 in @xcite . )",
    "the ideal @xmath244 is prime if and only if @xmath38 is a _ saturated _ sublattice of  @xmath240 , meaning that @xmath38 equals its _ saturation _ , in general defined as @xmath246 where @xmath247 is the rational vector space spanned by  @xmath38 in @xmath248 .",
    "in fact , writing @xmath249 for any @xmath250 , every binomial prime ideal in @xmath235 $ ] has the form @xmath251 for some _ saturated _ partial character  @xmath252 ( i.e. , whose domain is a saturated sublattice ) and subset @xmath37 such that the binomial generators of  @xmath244 only involve variables @xmath253 for @xmath254 ( some of which might actually be absent from the generators of  @xmath244 ) ( * ? ? ?",
    "* corollary  2.6 ) .",
    "[ rem : i_a ] a rank @xmath255 lattice @xmath237 is saturated if and only if there exists an @xmath256 integer matrix @xmath14 of full rank such that @xmath257 . in this case , if @xmath252 is the trivial character , the ideal @xmath258 is denoted by @xmath20 and called a _",
    "toric ideal_. note that @xmath259 if @xmath252 is not the trivial character , then @xmath244 becomes isomorphic to  @xmath20 when the variables are rescaled via @xmath260 , which induces the rescaling @xmath261 on general monomials .",
    "the characteristic zero part of the main result in @xcite , theorem  7.1@xmath262 , says that an irredundant primary decomposition of an arbitrary binomial ideal @xmath263 $ ] is given by @xmath264 for any large integer  @xmath265 , where @xmath266 means to discard the primary components for embedded ( i.e.  nonminimal associated ) primes , and @xmath267 .",
    "our goal in this section is to be explicit about the hull operation .",
    "the salient feature of  ( [ eq : hull ] ) is that @xmath268 contains  @xmath244 . in contrast , ( [ eq : hull ] ) is false in positive characteristic , where @xmath269 should be replaced by a frobenius power of  @xmath270 ( * ? ? ?",
    "* theorem  7.1@xmath262 ) .",
    "our notation in the next theorem is as follows .",
    "given a subset @xmath271 , let @xmath272 be its complement , and use these sets to index coordinate subspaces of  @xmath21 and @xmath240 ; in particular , @xmath273 .",
    "adjoining additive inverses for the elements in @xmath274 yields @xmath275 , whose semigroup ring we denote by @xmath235[{\\mathbf{t}}_j^{-1}]$ ] , with @xmath276 . as in definition",
    "[ d : u ] , @xmath277 is the monomial ideal in  @xmath235 $ ] having @xmath48-basis  @xmath155 .",
    "finally , for a saturated sublattice @xmath278 , we write @xmath279 for the image of @xmath274 in the torsion - free group  @xmath280 .",
    "[ t : components ] fix a binomial ideal @xmath281 $ ] and an associated prime @xmath270 of  @xmath3 , where @xmath239 for a saturated sublattice @xmath282 .",
    "set @xmath283 , and write @xmath13 for the congruence on @xmath33 determined by the ideal @xmath284 = ( i+i_\\rho){{\\ensuremath{\\mathbb{c}}}}[{\\mathbf{t}}][{\\mathbf{t}}_j^{-1}]$ ] .",
    "if @xmath270 is a minimal prime of  @xmath3 and @xmath285 is the set of @xmath286 whose congruence classes in @xmath287@xmath13 have infinite image in  @xmath288 , then the @xmath270-primary component of  @xmath3  is @xmath289    fix a monomial ideal @xmath290 $ ] containing a power of each available variable , and let @xmath291 be the congruence on @xmath33 determined by @xmath292[{\\mathbf{t}}_j^{-1}]$ ] . write @xmath293 for the set of @xmath286 whose congruence classes in @xmath294@xmath291 have infinite image in  @xmath288",
    ".    the @xmath270-primary component of @xmath295 $ ] is @xmath296 .",
    "if @xmath297 is contained in a sufficiently high power of @xmath26 , then @xmath298 is a valid choice of @xmath270-primary component for  @xmath3 .",
    "the only monomials in the above primary components are those in @xmath299 or @xmath300 .",
    "first suppose @xmath270 is a minimal prime of  @xmath3 .",
    "we may , by rescaling the variables @xmath253 for @xmath301 , harmlessly assume that @xmath252 is the trivial character on its lattice  @xmath38 , so that @xmath302 is the lattice ideal for  @xmath38 .",
    "the quotient @xmath235/i_l$ ] is the affine semigroup ring  @xmath23 $ ] for @xmath303 .",
    "now let us take the whole situation modulo  @xmath304 .",
    "the image of  @xmath305 is the prime ideal @xmath306 $ ] for the face  @xmath49 .",
    "the image in @xmath23 $ ] of the binomial ideal  @xmath3 is a binomial ideal  @xmath307 , and @xmath308 has image @xmath309 , as defined in  ( [ eq : i : phi ] ) . finally , the image of @xmath285 in  @xmath9 is the unbounded ideal @xmath157 ( definition  [ d : u ] ) by construction .",
    "now we can apply theorem  [ t : zerocomp ] to  @xmath307 and obtain a combinatorial description of the component associated to @xmath270 .",
    "the second and third items follow from the first by replacing @xmath3 with @xmath310 , given the primary decomposition in  ( [ eq : hull ] ) .",
    "one of the mysteries in @xcite is why the primary components  @xmath311 of binomial ideals turn out to be generated by monomials and binomials . from the perspective of theorem  [ t",
    ": components ] and proposition  [ p : graded ] together , this is because the primary components are _ finely graded _ :",
    "under some grading by a free abelian group , namely @xmath148 , the vector space dimensions of the graded pieces of the quotient modulo the ideal  @xmath311 are all @xmath72 or  @xmath86 ( * ? ? ?",
    "* proposition  1.11 ) .",
    "in fact , via lemma  [ l : distinct ] , fine gradation is the root cause of primaryness .",
    "theorem  [ t : components ] easily generalizes to arbitrary binomial ideals in arbitrary commutative noetherian semigroup rings over  @xmath48 : simply choose a presentation as a quotient of a polynomial ring modulo a pure difference binomial ideal ( * ? ? ?",
    "* theorem  7.11 ) .    the methods of section  [ s : semigroup ] work in arbitrary characteristic  and indeed , over a field @xmath0 that can fail to be algebraically closed , and can even be finite  because we assumed that a prime ideal @xmath50 for a face  @xmath49 is associated to our binomial ideal .",
    "in contrast , this section and the next work only over an algebraically closed field of characteristic zero . however , it might be possible to produce similarly explicit binomial primary decompositions in positive characteristic by reducing to the situation in section  [ s : semigroup ] ; this remains an open problem .",
    "in this section , we turn our attention to interactions of primary components with various gradings on  @xmath235 $ ] .",
    "these played crucial roles already in the proof of theorem  [ t : components ] : taking the quotient of its statement by the toric ideal  @xmath244 put us in the situation of proposition  [ p : graded ] and theorem  [ t : zerocomp ] , which provide excellent control over gradings .",
    "the methods here can be viewed as aids for clarification in examples , as we shall see in the case of lattice basis ideals ( example  [ ex : i(b ) ] ) .",
    "however , this theory was developed with applications in mind @xcite ; see section  [ s : applications ] .",
    "generally speaking , given a grading of  @xmath235 $ ] , there are two kinds of graded modules : those with bounded hilbert function ( the _ toral _ case below ) and those without .",
    "the main point is theorem  [ t : toral ] : if @xmath235/{{\\mathfrak p}}$ ] has bounded hilbert function for some graded prime  @xmath25 , then the @xmath25-primary component of any graded binomial ideal is easier to describe than usual .    to be consistent with notation",
    ", we adopt the following conventions for this section .",
    "[ conv : a ] @xmath312 denotes an integer @xmath313 matrix of rank  @xmath314 whose columns @xmath315 all lie in a single open linear half - space of  @xmath316 ; equivalently , the cone generated by the columns of @xmath14 is pointed ( contains no lines ) , and all of the columns  @xmath317 are nonzero .",
    "we also assume that @xmath318 ; that is , the columns of @xmath14 span @xmath319 as a lattice .",
    "[ conv : b ] let @xmath320 be an integer matrix of full rank  @xmath321 .",
    "assume that every nonzero element of the column span @xmath322 of  @xmath323 over the integers  @xmath324 is _ mixed _ , meaning that it has at least one positive and one negative entry ; in particular , the columns of @xmath323 are mixed .",
    "we write @xmath325 for the rows of  @xmath323 . having chosen  @xmath323 , we set @xmath326 and pick a matrix @xmath327 such that @xmath328 and @xmath318 .    if @xmath329 , the mixedness hypothesis on @xmath323 is equivalent to the pointedness assumption for  @xmath14 in convention  [ conv : a ] .",
    "we do allow  , in which case @xmath14 is the empty matrix .",
    "the @xmath313 integer matrix  @xmath14 in convention  [ conv : a ] determines a @xmath319-grading on @xmath235 $ ] in which the degree is defined , and the degree of @xmath330 is usually defined to be @xmath331 instead of  @xmath332 . ] to be the @xmath333 column of  @xmath14 .",
    "our conventions imply that @xmath235 $ ] has finite - dimensional graded pieces , like any finitely generated module .",
    "[ d : toral ] let @xmath334 be an @xmath14-graded module over the polynomial ring  @xmath235 $ ] .",
    "the _ hilbert function _",
    "@xmath335 takes the values @xmath336 .",
    "if @xmath99 is finitely generated , we say that the module @xmath99 is _ toral _ if the hilbert function @xmath337 is bounded above .",
    "a graded prime  @xmath25 is a _",
    "toral prime _",
    "if @xmath235/{{\\mathfrak p}}$ ] is a toral module .",
    "similarly , a graded primary component @xmath37 of an ideal  @xmath3 is a _",
    "toral component _ of  @xmath3 if @xmath235/j$ ] is a toral module .",
    "the toric ideal @xmath20 for the grading matrix  @xmath14 is always an @xmath14-graded toral prime , since the quotient @xmath235/i_a$ ] is always toral : its hilbert function takes only the values @xmath72 or  @xmath86 .",
    "in contrast , @xmath235 $ ] itself is not a toral module unless @xmath338 ( which forces @xmath14 to be invertible over  @xmath324 , by convention  [ conv : a ] )",
    ".    we will be most interested in the quotients of @xmath235 $ ] by prime and primary binomial ideals .",
    "to begin , here is a connection between the natural gradings from section  [ s : semigroup ] and the @xmath14-grading .",
    "[ l : toral ] let @xmath281 $ ] be an @xmath14-graded binomial ideal and @xmath339 a primary component , with @xmath239 for @xmath278 .",
    "the image @xmath340 of the homomorphism @xmath341 induced by corollary  [ c : graded ] ( with @xmath342 ) is generated by the columns @xmath332 of  @xmath14 indexed by  @xmath254 , as is the monoid image of @xmath283 , which we denote by  @xmath343 .",
    "to make things a little more concrete , let us give one more perspective on the homomorphism @xmath344",
    ". simply put , the ideal @xmath270 is naturally graded by @xmath345 , and the fact that it is also @xmath14-graded means that @xmath346 , the map to @xmath319 being given by  @xmath14 .",
    "( the real content of corollary  [ c : graded ] lies with the action on the rest of  @xmath170 . )",
    "let @xmath239 for a saturated sublattice @xmath347 .",
    "if @xmath339 is an @xmath270-primary binomial ideal , then @xmath235/{{\\mathcal c}}_{\\rho , j}$ ] has a finite filtration whose successive quotients are torsion - free modules of rank  @xmath86 over the affine semigroup ring @xmath348/i_{\\rho , j}$ ] .",
    "this follows by applying proposition  [ p : graded ] to theorem  [ t : components].1 and its proof .",
    "if , in addition , @xmath270 is @xmath14-graded , then some @xmath14-graded translate of each successive quotient admits a @xmath280-grading refining the @xmath14-grading via @xmath349 ; this follows by conjointly applying corollary  [ c : graded ] .",
    "the next three results provide alternate characterizations of toral primary binomial ideals . in what follows",
    ", @xmath350 is the submatrix of  @xmath14 on the columns indexed  by  @xmath37 .",
    "[ p : toral ] every @xmath14-graded toral prime is binomial .",
    "in the situation of lemma  [ l : toral ] , @xmath235/i_{\\rho , j}$ ] and @xmath235/{{\\mathcal c}}_{\\rho , j}$ ] are toral if and only if the homomorphism @xmath344 is injective .    to prove the first part of the statement , fix a toral prime  @xmath25 , and let @xmath351 be the maximum of the hilbert function of  @xmath235/{{\\mathfrak p}}$ ] .",
    "it is enough , by ( * ? ? ?",
    "* proposition  1.11 ) , to show that @xmath352 .",
    "let  @xmath353 be the localization of  @xmath235/{{\\mathfrak p}}$ ] by inverting all nonzero homogeneous elements . because of the homogeneous units in  @xmath353 , all of its graded pieces have the same dimension over  @xmath48 ; and since @xmath353 is a domain , this dimension is at least  @xmath354 .",
    "thus we need only show that @xmath355 . for any given finite - dimensional subspace of  @xmath356 , multiplication by a common denominator maps it injectively to some graded piece of @xmath235/{{\\mathfrak p}}$ ] .",
    "therefore every finite - dimensional subspace of  @xmath356 has dimension at most  @xmath354 .",
    "it follows that @xmath357 , so @xmath356 is artinian . but",
    "@xmath356 is a domain because @xmath358 , so @xmath355 .    for the second part , @xmath235/{{\\mathcal c}}_{\\rho , j}$ ]",
    "has a finite filtration whose associated graded pieces are @xmath14-graded translates of quotients of @xmath235 $ ] by @xmath14-graded primes , at least one of which is @xmath270 and all of which contain  it . by additivity of hilbert functions , @xmath235/{{\\mathcal c}}_{\\rho , j}$ ] is toral precisely when all of these are toral primes .",
    "however , if a graded prime  @xmath25 contains a toral prime , then @xmath25 is itself a toral prime .",
    "therefore , we need only treat the case of @xmath235/i_{\\rho , j}$ ] . but",
    "@xmath235/i_{\\rho , j}$ ] is naturally graded by  @xmath148 , with hilbert function @xmath72 or  @xmath86 , so injectivity immediately implies that @xmath235/i_{\\rho , j}$ ] is toral . on the other hand , if @xmath359 is not injective ,",
    "then @xmath343 is a proper quotient of the affine semigroup  @xmath49 , and such a proper quotient has fibers of arbitrary cardinality .",
    "[ c : toralprimes ] let @xmath239 for a saturated lattice @xmath360 .",
    "the quotient @xmath235/i_{\\rho , j}$ ] by an @xmath14-graded prime  @xmath270 is toral if and only if @xmath361 .    [ l : toral - by - a ] every @xmath14-graded binomial prime ideal @xmath270 satisfies @xmath362 with equality if and only if @xmath235/i_{\\rho , j}$ ] is toral .",
    "rescale the variables and assume that @xmath363 , the lattice ideal for a saturated lattice @xmath364 .",
    "the rank of @xmath38 is at most @xmath365 ; thus @xmath366 .",
    "equality holds exactly when @xmath257 , i.e.  when @xmath235/i_{\\rho , j}$ ] is toral .",
    "[ ex : i(b ) ] fix matrices @xmath14 and  @xmath323 as in convention  [ conv : b ] .",
    "this identifies @xmath319 with the quotient of @xmath367 modulo its torsion subgroup .",
    "consider the _ lattice basis ideal _",
    "@xmath368.\\ ] ] the toric ideal  @xmath20 from  ( [ eq : ia ] ) is an associated prime of  @xmath369 , the primary component being @xmath20 itself .",
    "more generally , all of the minimal primes of the lattice ideal  @xmath370 , one of which is  @xmath20 , are minimal over  @xmath369 with multiplicity  @xmath86 ; this follows from ( * ? ? ?",
    "* theorem  2.1 ) by inverting the variables .",
    "that result also implies that the minimal primes of  @xmath370 are precisely the ideals  @xmath244 for partial characters @xmath371 of  @xmath240 extending the trivial partial character on  @xmath322 , so the lattice ideal  @xmath370 is the intersection of these prime ideals . hence @xmath370 is a radical ideal , and every irreducible component of its zero set is isomorphic , as a subvariety of @xmath372 , to the variety of  @xmath20 .    in complete generality , each of the minimal primes of  @xmath369 arises , after row and column permutations , from a block decomposition of  @xmath323 of the form @xmath373,\\ ] ] where @xmath2 is a mixed submatrix of  @xmath323 of size @xmath374 for some @xmath375 @xcite .",
    "( matrices with @xmath376 rows are automatically mixed ; matrices with @xmath377 row are never mixed . )",
    "we note that not all such decompositions correspond to minimal primes : the matrix @xmath2 has to satisfy another condition which hoten and shapiro call irreducibility ( * ? ? ?",
    "* definition  2.2 and theorem  2.5 ) .",
    "if @xmath369 is a complete intersection , then only square matrices @xmath2 will appear in the block decompositions  ( [ eq : mnob ] ) , by a result of fischer and shapiro @xcite .",
    "for each partial character @xmath378 extending the trivial character on  @xmath379 , the prime @xmath270 is associated to  @xmath369 , where @xmath380 indexes the @xmath381 rows not in  @xmath2 .",
    "we reiterate that the symbol @xmath252 here includes the specification of the sublattice @xmath382 .",
    "the corresponding primary component of the lattice basis ideal  @xmath369 is simply @xmath244 if @xmath376 , but will in general be non - radical when @xmath383 ( recall that @xmath377 is impossible ) .",
    "the quotient @xmath235/{{\\mathcal c}}_{\\rho , j}$ ] is toral if and only if @xmath2 is square and satisfies either @xmath384 or @xmath385 . to check this statement ,",
    "observe that @xmath369 has @xmath386 generators , so the dimension of any of its associated primes is at least  @xmath314 .",
    "but since @xmath350 has rank at most  @xmath314 , lemma  [ l : toral - by - a ] implies that toral primes of  @xmath369 have dimension exactly  @xmath314 ( and are therefore minimal ) .",
    "if @xmath270 is a toral associated prime of @xmath369 arising from a decomposition of the form  ( [ eq : mnob ] ) , where @xmath2 is @xmath374 , then the dimension of @xmath270 is @xmath387 , and from this we conclude that @xmath2 is square . that @xmath2 is invertible follows from the fact that @xmath388 .",
    "the same arguments show that if @xmath2 is not square invertible , then @xmath270 is not toral .",
    "a binomial ideal @xmath281 $ ] may be @xmath14-graded for different matrices @xmath14 ; in this case , which of the components of @xmath3 are toral will change if we alter the grading .",
    "for instance , the prime ideal @xmath389 $ ] is homogeneous for both the matrix @xmath390 $ ] and the matrix @xmath391 $ ] . but @xmath392/i$ ] is toral in the @xmath391$]-grading , while it is not toral in the @xmath390$]-grading .",
    "[ ex : binomial ] let @xmath393 be a binomial ideal in @xmath235 $ ] , where we write @xmath394 , and let @xmath395 \\qquad\\text{and}\\qquad    b = \\left[\\begin{array}{rrr }      -2 & -1 &   0 \\\\        3 &   0 &   1 \\\\       0 &   3 &   0 \\\\",
    "-1 & -2 &   0 \\\\       0 &   0 & -1        \\end{array}\\right].\\ ] ] one easily verifies that the binomial ideal  @xmath3 is graded by @xmath396 . if @xmath397 is a primitive cube root of unity ( @xmath398 ) , then @xmath3 , which is a radical ideal , has the prime decomposition @xmath399 the intersectand @xmath400 equals the prime ideal @xmath270 for @xmath401 and @xmath402 .",
    "the homomorphism @xmath403 is not injective since it maps both basis vectors to @xmath404 $ ] ; therefore the prime ideal @xmath400 is not a toral component of  @xmath3 .",
    "in contrast , the remaining three intersectands are the prime ideals @xmath270 for the three characters @xmath252 that are defined on  @xmath405 but trivial on its index  @xmath406 sublattice  @xmath322 spanned by the columns  of @xmath323 , where @xmath407",
    ". these prime ideals are all toral by corollary  [ c : toralprimes ] , with @xmath408 .",
    "toral components can be described more simply than in theorem  [ t : components ] .",
    "[ t : toral ] fix an @xmath14-graded binomial ideal @xmath281 $ ] and a toral associated prime @xmath270 of  @xmath3 .",
    "define the binomial ideal @xmath409/{\\langle}{t}_j - 1 \\mid j \\in j{\\rangle}$ ] by setting @xmath410 for @xmath301 .",
    "fix a minimal prime @xmath270 of  @xmath3 .",
    "if @xmath411 is the set of elements with infinite congruence class in  @xmath412 ( proposition  [ p : sim ] ) , and @xmath413 , then @xmath3 has @xmath270-primary component @xmath414    let @xmath290 $ ] be a monomial ideal containing a power of each available variable , and let @xmath415 be the set of elements with infinite congruence class in  @xmath416 .",
    "the @xmath270-primary component of @xmath295 $ ] is @xmath417 .",
    "if @xmath297 is contained in a sufficiently high power of @xmath26 , then @xmath418 is a valid choice of @xmath270-primary component for  @xmath3 .",
    "the only monomials in the above primary components are in @xmath419 or @xmath420 .",
    "resume the notation from the statement and proof of theorem  [ t : components ] .",
    "as in that proof , it suffices here to deal with the first item .",
    "in fact , the only thing to show is that @xmath285 in theorem  [ t : components ] is the same as @xmath421 here .",
    "recall that @xmath422 $ ] is the image of  @xmath3 modulo  @xmath244 .",
    "the congruence classes of @xmath288 determined by @xmath423 $ ] are the projections under @xmath424 of the @xmath13 congruence classes",
    ". further projection of these classes to  @xmath44 yields the congruence classes determined by the ideal @xmath425 $ ] , where @xmath426 is obtained from @xmath423 $ ] by setting @xmath427 for all .",
    "this ideal @xmath426 is just  @xmath428 .",
    "hence we are reduced to showing that a congruence class in @xmath429 determined by @xmath423 $ ] is infinite if and only if its projection to  @xmath44 is infinite .",
    "this is clearly true for the monomial congruence class in @xmath288 .",
    "for any other congruence class @xmath430 , the homogeneity of  @xmath3 ( and hence that of  @xmath307 ) under the @xmath14-grading implies that @xmath139 is contained within a coset of @xmath431 .",
    "this kernel  @xmath432 intersects @xmath148 only at @xmath72 because @xmath270 is toral",
    ". therefore the projection of any coset of  @xmath432 to  @xmath433 is bijective onto its image . in particular",
    ", @xmath139 is infinite if and only if its bijective image in @xmath44  is  infinite .",
    "[ c : i(b ) ] resume the notation of example  [ ex : i(b ) ] . if @xmath270 is a toral minimal prime of the lattice basis ideal  @xmath369 given by a decomposition as in  ( [ eq : mnob ] ) , so @xmath434 , then @xmath435 where @xmath436 $ ] is the ideal @xmath48-linearly spanned by by all monomials whose exponent vectors lie in the union of the unbounded @xmath2-subgraphs of  @xmath44 , as in definition  [ d : m ] .",
    "the only monomials in @xmath339 belong to @xmath437 .",
    "theorem  [ t : toral ] need not always be false for a component that is not toral , but it can certainly fail : there can be congruence classes in @xmath288 that are infinite only in the @xmath148 direction , so that their projections to  @xmath44 are finite .",
    "in this section we give a brief overview of the connection between binomial primary decomposition and hypergeometric differential equations , study some examples , and discuss computational issues .    from the point of view of complexity ,",
    "primary decomposition is hard : even in the case of zero dimensional binomial complete intersections , counting the number of associated primes ( with or without multiplicity ) is a @xmath438-complete problem @xcite .",
    "however , the primary decomposition algorithms implemented in singular @xcite or macaulay2 @xcite work very well in reasonably sized examples , and in fact , they provide the only implemented method for computing bounded congruence classes or @xmath2-subgraphs as in section  [ s : primary ] .",
    "we remind the reader that ( * ? ? ?",
    "* section 8) contains specialized algorithms for binomial primary decomposition , whose main feature is that they preserve binomiality at each step .      let @xmath2 be a mixed invertible @xmath440 integer matrix",
    ". without loss of generality , write @xmath441 $ ] , where @xmath442 are positive integers",
    ". then the number of bounded @xmath2-subgraphs is @xmath443 .",
    "moreover , if @xmath444 then every bounded @xmath2-subgraph passes through exactly one of the points in @xmath353 .",
    "[ prop : sols - via - subgraphs ] let @xmath2 be a @xmath447 mixed invertible integer matrix , and assume that @xmath448 .",
    "given @xmath449 , denote by @xmath139 the @xmath2-subgraph containing @xmath189 .",
    "think of the ideal @xmath450 $ ] as a system of linear partial differential equations with constant coefficients .",
    "the @xmath2-subgraphs of @xmath461 are the four slices @xmath462 for @xmath463 ; for @xmath464 , two consecutive slices are @xmath2-connected by @xmath465 , yielding one unbounded @xmath2-subgraph ( see figure  [ f : m - subgraphs ] ) .    a direct combinatorial algorithm for producing the bounded @xmath2-subgraphs for @xmath466 , or even for finding their number would be interesting and useful , as the number of bounded @xmath2-subgraphs gives the dimension of the polynomial solution space of a hypergeometric system , and also the multiplicity of an associated prime of a lattice basis ideal . in the case where @xmath76 is a zero - dimensional complete intersection ,",
    "such an algorithm can be produced from the results in @xcite .",
    "the combinatorial computation of the number of bounded congruence classes determined by a binomial ideal in a semigroup ring is open .",
    "the system of differential equations @xmath467 $ ] is a special case in the class of _ horn hypergeometric systems_. that class of systems takes center stage in our companion article @xcite , in the more general setting of _ binomial @xmath468-modules _ that are introduced there .",
    "the input data for these consist of a binomial ideal  @xmath3 and a vector  @xmath469 of complex parameters .",
    "the special case where @xmath3 is prime corresponds to the _",
    "@xmath14-hypergeometric _ or _ gkz hypergeometric systems _ , after gelfand , kapranov , and zelevinsky @xcite .",
    "binomial primary decomposition is crucial for the study of horn systems , and their more general binomial relatives , because the numerics , algebra , and combinatorics of their solutions are directly governed by the corresponding features of the input binomial ideal .",
    "the dichotomy between components that are toral or not , for example , distinguishes between the choices of parameters yielding finite- or infinite - dimensional solution spaces ; and in the finite case , the multiplicities of the toral components enter into simple formulas for the dimension .",
    "the use of binomial primary decomposition to extract invariants and reduce to the @xmath14-hypergeometric case underlies the entirety of  @xcite ; see section  1.6 there for precise statements",
    ".    using this `` hypergeometric perspective '' , it becomes possible to consider algorithms for binomial primary decomposition that exploit methods for solving differential equations . the idea would be to use the fact from ( * ? ? ?",
    "* section 7 ) , that the supports of power series solutions of hypergeometric systems contain the combinatorial information needed to describe certain toral primary components of the underlying binomial ideal .",
    "the method of canonical series ( * ? ? ?",
    "* sections  2.5 and  2.6 ) , a symbolic algorithm for constructing power series solutions of regular holonomic left @xmath470-ideals , might be useful .",
    "canonical series methods are based on grbner bases in the weyl algebra , and generalize the classical frobenius method in one variable .",
    "i.  m. gelfand , a.  v. zelevinski , and m.  m. kapranov , _ hypergeometric functions and toric varieties _ , funktsional .",
    "i prilozhen .",
    "* 23 * ( 1989 ) , no .  2 , 1226 .",
    "correction in ibid , * 27 * ( 1993 ) , no .  4 ,  91 .",
    "serkan hoten and jay shapiro , _ primary decomposition of lattice basis ideals _ , j. symbolic comput . * 29 * ( 2000 ) , no .  4 - 5 , 625639 , symbolic computation in algebra , analysis , and geometry ( berkeley , ca , 1998 ) ."
  ],
  "abstract_text": [
    "<S> an explicit lattice point realization is provided for the primary components of an arbitrary binomial ideal in characteristic zero . </S>",
    "<S> this decomposition is derived from a characteristic - free combinatorial description of certain primary components of binomial ideals in affine semigroup rings , namely those that are associated to faces of the semigroup . </S>",
    "<S> these results are intimately connected to hypergeometric differential equations in several variables . </S>"
  ]
}