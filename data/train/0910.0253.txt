{
  "article_text": [
    "experiments at the large hadron collider ( lhc )  @xcite will produce tremendous amounts of data . with instantaneous luminosities of @xmath0  @xmath1s@xmath2 and a crossing rate of 40  mhz , the collision rate will be about @xmath3  hz .",
    "but the rate for new physics processes , after accounting for branching fractions and the like , is of order @xmath4  hz , leading to the need to select events out of a huge data sample at the level of @xmath5 .    what does this imply for the necessary scale of computing systems for an lhc experiment , and for the compact muon solenoid ( cms ) in particular ?",
    "the first run of the lhc in 2009 - 2010 is expected to be quite long , with six million seconds of running time .",
    "cms plans to record data at 300  hz , leading to datasets of 2.2  billion events , once dataset overlaps are accounted for . roughly as many events will be simulated .",
    "the size of the raw data from a single event is 1.5  mb ( and 2.0  mb for simulated data ) , already implying petabytes worth of raw data alone from just the first year of operations .",
    "all of this data must be processed ; detector data is reconstructed at a rate of 100  hs06-sec / event  @xcite while simulated data is generated and reconstructed at 1000  hs06-sec / event .",
    "given these parameters , the cms computing model  @xcite estimates that 400  khs06 of processing resources , 30  pb of disk and 38  pb of tape will be required to handle just the first year of cms data .",
    "cms has been developing a distributed computing model from the very early days of the experiment .",
    "there are a variety of motivating factors for this : a single data center at cern would be expensive to build and operate , whereas smaller data centers at multiple sites are less expensive and can leverage local resources ( both financial and human ) .",
    "but there are also many challenges in making a distributed model work , some of which are discussed here .",
    "the cms distributed computing model  @xcite has different computing centers arranged in a `` tiered '' hierarchy , as illustrated in figure  [ fig : tiers ] , with experimental data typically flowing from clusters at lower - numbered tiers to those at higher - numbered tiers .",
    "the different centers are configured to best perform their individual tasks .",
    "the tier-0 facility at cern is where prompt reconstruction of data coming directly from the detector takes place ; where quick - turnaround calibration and alignment jobs are run ; and where an archival copy of the data is made .",
    "the facility is typically saturated by just those tasks .",
    "there are seven tier-1 centers in seven nations ( including at fnal in the united states ) .",
    "these centers keep another archive copy of the data , and are responsible for performing re - reconstruction of older data with improved calibration and algorithms , and making skims of primary datasets that are enriched in particular physics signals .",
    "they also provide archival storage of simulated samples produced at tier-2 .",
    "there are about 40 tier-2 sites around the world ( including seven in the u.s . )",
    "; they are the primary resource for data analysis by physicists , and also where all simulations done for the benefit of the whole collaboration take place .",
    "these centers thus host both organized and chaotic computing activities .",
    "( tier-2 centers are discussed further in section  [ sec : t2descr ] ) .",
    "of course , the tevatron run  ii experiments have also created computing systems of impressive scale .",
    "but computing for cms will be something still different .",
    "for instance , there will not be enough resources at any single location to perform all analysis ; cdf , by contrast , has approximately equal resources at fnal for reconstruction and analysis .",
    "cms in fact depends on large - scale dataset distribution away from cern for successful analysis computing . at cms",
    ", all re - processing resources will be remote .",
    "it is true that d0 does much of its re - processing off the fnal site , but this was put into place after other elements of the computing system were commissioned .",
    "most notably , the commissioning of the distributed computing model will be simultaneous with the commissioning of the cms detector , not to mention the search for new physics that is the object of the experiment . given the stresses that the system will face early on , we must take all steps possible to make sure that the system is ready before we have colliding beams .",
    "such a step is a recent exercise called the scale testing of the experimental program ( step ) .",
    "this was a multi - virtual organization ( vo ) exercise performed in the context of the worldwide lhc computing grid ( wlcg )  @xcite .",
    "the primary goal for the wlcg was to make sure that all experiments could operate simultaneously on the grid , and especially at sites that are shared amongst vo s .",
    "all of the lhc vo s agreed to do their tests in the first two weeks of june 2009 .    for cms , step  09",
    "was not an integrated challenge .",
    "this way , downstream parts of the system could be tested independently of the performance of upstream pieces .",
    "the factorization of the tests made for a much less labor - intensive test , as cms also needed to keep focus on other preparations for data - taking , such as commissioning the detector through cosmic - ray runs , during this time .",
    "cms thus focused on the pieces of the distributed system that needed the greatest testing , and had the greatest vo overlap .",
    "these were data transfers from tier to tier ; the recording of data to tape at tier  0 ; data processing and pre - staging at tier  1 , and the use of analysis resources at tier  2 .",
    "the specific tests and their results are described below .",
    "data transfer is a key element of the cms computing model ; remote resources are of little use if data files can not be transferred in and out of them at sufficient rates for sites to be responsive to the evolving demands of experimenters .",
    "several elements of data transfer were tested in step  09 .",
    "tier-1 sites must archive data to tape at close to the rate that it emerges from the detector , if backups of transfers and disk space are to be avoided . in step  09 , cms exported data from tier  0 at the expected rates to the tier-1 sites for archiving .",
    "latencies were observed between the start of the transfer and files being written to tape , and in some cases these latencies had very long tails , with the last files in a block of files being written very long after the first files were .",
    "latencies were correlated with the state of the tape systems at the individual sites ; they were longer when there were known backlogs at a given site .    while each tier-1 site only has custodial responsibility for a particular fraction of the entire reco - level sample , which contains the full results of event reconstruction , every tier-1 site hosts a full copy of the analysis - object data ( aod ) sample , which contains only a summary of the reconstruction .",
    "when a re - reconstruction pass is performed at a particular tier  1 , new aod s are produced for the fraction of the data that the site has archived , and then those particular aod s must be distributed to the other six sites .",
    "this results in substantial traffic among the seven sites .",
    "these transfers were tested in step  09 by populating seven datasets at the seven sites , with sizes proportional to the custodial fraction , and then subscribing these datasets to the six other sites for transfer .",
    "the total size of the dataset was 50  tb , and the goal was to complete all of the transfers in three days .",
    "an aggregate sustained transfer rate of 1215  mb / s was required to achieve that goal , and a rate of 989  mb / s was achieved .",
    "one interesting feature of these transfers was that it demonstrated the re - routing capabilities of the phedex transfer system  @xcite .",
    "phedex attempts to route files over the fastest links available .",
    "if site a is the original source of a file and both sites b and c wish to acquire them , then if b gets a file from a before c does , and the network link between b and c is faster than that between a and c , then site c will obtain the file from site b rather than the originating site a. this is illustrated in figure  [ fig : reroute ] , which shows which sites serve as the sources for files that were originally at asgc in taiwan , the tier-1 site that is furthest from all the others in cms . in the early stages of the transfer , asgc is the only source of the files .",
    "but once the files have started to arrive in europe , other european tier-1 s start to get the files from their nearest neighbors rather than asgc . in the end , only about half of the transfers of the asgc dataset actually originated at asgc .",
    "cms is learning how to best take advantage of such behavior .",
    "finally , transfers from tier-1 to tier-2 are important for getting data into the hands of physicists .",
    "these transfers typically involve pulling data off tape at the tier-1 site so that disk - resident files can then be copied to tier-2 disk pools .",
    "step  09 testing of these transfers focused on stressing tier-1 tape systems by transfering files that were known not to be on disk at the originating sites .",
    "in general , the target transfer rates were achieved , with the expected additional load on tape systems observed .",
    "one interesting feature that was observed is shown in figure  [ fig : t1t2 ] for the case of two datasets being transferred from the tier-1 site at ral in the uk to a nearby tier-2 site .",
    "both datasets were brought to disk pretty quickly , and the first dataset was mostly transferred after that .",
    "however , the transfer of that dataset was stalled for a while as the second dataset was transferred in its entirety . since only complete blocks of files are visible to cms jobs",
    ", the first dataset was probably not in a useable state while the second dataset was being transferred .",
    "cms is studying techniques to avoid such issues .",
    "the primary responsibility of the tier-0 facility is to do a first pass reconstruction of the raw data , and then to save an archival copy of the raw data and the reconstruction output . in step  09 ,",
    "the tier-0 tape system cms stressed by running i / o intensive jobs at the same time that other experiments ran similar jobs .",
    "could cms archive data to tape at sufficient rates while other experiments were doing the same ?",
    "`` sufficient '' is hard to define , as the 50% duty cycle of the lhc allows time to catch up between fills .",
    "cms estimated that a 500  mb / s tape - writing rate would be sufficient .",
    "the tape - writing test schedule was constrained by the need to handle real detector data from cosmic - ray runs during the step  09 period , leading to two test periods of four and five days .",
    "the results are shown in figure  [ fig : t0write ] . in both periods , the target rate",
    "was easily exceeded , even with atlas also writing at a high rate during one of the periods .",
    "the only problem that was encountered was the limited amount of monitoring information for the tier-0 facility .",
    "the tier-1 sites hold custodial copies of datasets , and will be re - reconstructing those events multiple times . in 2010 , cms expects to do three re - processing passes that will take four months each . in the early stages of the experiment , when data sizes are small , all of the raw data and several versions of the reconstruction will fit onto disk pools at the tier-1 sites , making for efficient processing .",
    "but as the collected dataset gets bigger , it will have to be staged from tape to disk for re - processing .",
    "this is potentially inefficient ; one would nt want to have re - processing jobs occupying batch slots and waiting for file staging .",
    "thus some pre - staging scheme is required to maximize cpu efficiency .",
    "the pre - staging has never been tested by cms on this scale or with such coordination .",
    "step  09 exercises at tier  1 investigated the prestage rates and stability of the tape systems , and the ability to perform rolling re - reconstruction .",
    "a rolling re - processing scheme was established for the exercise . on day 0 , sites pre - staged an amount of data that could be re - reconstructed in a single day from tape to disk . on day 1 ,",
    "that data was processed while a new batch of data was pre - staged . on day 2 , the day 0 data was purged from disk , the day 1 data was processed , and new data was again pre - staged .",
    "this was repeated throughout the exercise period .",
    "how much data was processed varied by the custodial fraction at each site .",
    "cms does not yet have a uniform way of handling pre - staging within the workload management system .",
    "three different implementations emerged across the seven tier-1 sites .",
    "all three worked , and the experienced gained will be used to design a uniform pre - staging system for long - term use .",
    "the target pre - staging rates for each site are given in table  [ tab : t1stage ] .",
    "also shown are the best one - day average rates that were achieved during the exercise . as can be seen ,",
    "all sites were able to achieve the targets , although there were some operational problems during the two weeks .",
    "the fzk tape system was unavailable at first , and the performance was not clear once it was available .",
    "in2p3 had a scheduled downtime during the first week of step  09 .",
    "the large rates required at fnal triggered problems at first that led to a backlog , but these were quickly solved .",
    ".target and best achieved pre - staging rates at tier-1 sites during step  09.[tab : t1stage ] [ cols=\"<,^,^\",options=\"header \" , ]     the re - processing operations ran quite smoothly .",
    "a single operator was able to submit many thousands of jobs per day using glide - in pilots , as shown in figure  [ fig : t1proc ] .",
    "( note the effect of the backlog at fnal mentioned above . )",
    "there was no difficulty in getting the pledged number of batch slots from sites , and fair - share batch systems appeared to give each experiment the appropriate resources .",
    "the efficiency of the re - processing jobs is reflected in the ratio of cpu time consumed by the jobs to the wall - clock time that the job spends using a batch slot .",
    "this ratio should be near one if jobs are not waiting for files to come off tape .",
    "figure  [ fig : t1eff ] shows the efficiency for jobs on a typical step  09 day .",
    "efficiency varies greatly across sites , which bears more investigation .",
    "however , pre - staging , which was used here , is generally observed to greatly improve the efficiency .",
    "the cms data analysis model depends greatly on the distribution of data to tier-2 sites and the subsequent submission of analysis jobs to those sites .",
    "we review those elements of the model here .    in cms ,",
    "analysis jobs go to the data , and not the other way around , so it is important to distribute data for the most efficient use of resources .",
    "the nominal storage available at a tier-2 site is 200  tb ; with about 40 functional tier-2 sites , this is a huge amount of storage that must be partitioned in a sensible way . at each site ,",
    "the available disk space is managed by different parties ranging from the central cms data - operations group to large groups of users to individual users , leading to a mix of central and chaotic control .",
    "a small amount of disk , about 10  tb , is set aside for as staging space for centrally - controlled simulation production .",
    "30  tb at each site is designated as centrally - controlled ; cms will place datasets of wide interest to the collaboration in this space .",
    "another 30 - 90  tb of space , divided into 30  tb pieces , is allocated to individual physics groups in cms for distribution and hosting of datasets that are of greatest interest to them .",
    "there are 17 such groups in cms .",
    "currently no site supports more than three groups and no group is affiliated with more than five sites ; the seven u.s .",
    "tier-2 sites support all 17 groups . as a result",
    ", there are a manageable number of communication channels between sites and groups , making it easier to manage the data placement across the far - flung sites .",
    "the remainder of the space at a tier-2 site is devoted to local activities , such as making user - produced files grid accessible .",
    "cms physicists must then be able to access this data .",
    "all analysis jobs are submitted over the grid . to shield the ordinary user from the underlying complexity of the grid , cms has created the cms remote analysis builder ( crab )  @xcite . a schematic diagram of how the grid submission of an analysis job works is shown in figure  [ fig : workflow ] .",
    "a user creates a crab script that specifies the job , including the target dataset and the analysis program .",
    "the user submits the script to a crab server with a one - line command .",
    "the server then determines where the dataset is located .",
    "the dataset in question could be either an official cms dataset , or one created by a user that is resident at a tier-2 site .",
    "the job is then submitted by the server to the appropriate site through the grid for processing .",
    "if the user is creating significant output , that output can be staged to the user s local tier-2 site , and the files can be registered in the data management system for processing by a future crab job . needless to say , many elements of the system must succeed for the user to have a successful job .",
    "those of greatest concern at the moment are the scaling of grid submissions , data integrity at the tier-2 sites , and reliability and scaling issues for stageout of user output .",
    "50% of the pledged processing resources at tier-2 sites are targeted for user analysis . at the moment , this is about 8,000 batch slots .",
    "the primary goal of step  09 tests at tier  2 was to actually fill that many slots .",
    "figure  [ fig : t2slots ] shows the number of running jobs per day at the tier-2 sites before and during step  09 .",
    "all types of jobs that ran at the sites are indicated  simulation production , normal analysis run by users throughout cms , and the extra analysis jobs that were submitted for the exercise . between normal and step",
    "09 analysis jobs , the pledged analysis resources were more than saturated , with no operational problems at the sites .",
    "this apparent spare capacity suggests that cms could be making better use of the analysis resources .",
    "indeed , in the month before step  09 , only five out of 48 sites were devoting more than 70% of their analysis resources to analysis jobs . during step  09 ,",
    "33 sites did so .",
    "this bodes well for the onslaught of user jobs that we expect when lhc data - taking begins .",
    "the step  09 jobs all read data from local disk at the sites , but did not stage out any output , so the stageout elements of the analysis model were not tested .",
    "the majority of sites handled the step  09 jobs perfectly , as indicated in figure  [ fig : t2success ] .",
    "the overall success rate for jobs was 80% .",
    "90% of the job failures were due to file read errors at the sites , which indicates a clear area that needs improvement .",
    "however , this indicates that the bulk of the problems happened after jobs reached the sites , rather than during the grid submission .",
    "this would not have been true just a few years ago .",
    "the step  09 exercise allowed us to focus on specific key areas of the computing system in a multi - vo environment  data transfers between tiers , the use of tape systems at tier  0 and tier  1 , and data analysis at tier  2 .",
    "most of the tier-1 sites showed good operational maturity .",
    "some may not yet have deployed all of the resources that will be needed at lhc startup this fall , but there are no indications that they will have any problem scaling up . not all tier-1 sites attained the goals of the tests ; specific tests will be re - run after improvements are made .",
    "the tests of analysis activities at tier  2 were largely positive .",
    "most sites were very successful , and cms easily demonstrated that it can use resources beyond the level pledged by sites .",
    "if anything , there are indicators that some resources could be used more efficiently .",
    "* the first run of the lhc will be longer than originally imagined .",
    "what are the operational impacts ? * if the lhc duty cycle is low at the start , there will be pressure to increase the event rate at cms , possibly to as high as 2000  hz from the nominal 300  hz , and to overdrive the computing systems .",
    "will it work ?",
    "* datasets will be divided into streams on the basis of triggers for custodial storage at the various tier-1 sites .",
    "this will allow re - processing to be prioritized by trigger type , but will the local interests at each tier-1 site by satisfied by the set of triggers it stores ?",
    "* read errors were the leading problem in the tier-2 analysis tests .",
    "what can be done to make disk systems more reliable and maintainable ? * the current system for remote stageout will not scale .",
    "what will ? * during a long run , will we be able to keep multiple copies of reco - level data available at tier-2 sites ? if not , how will people adjust ?        9",
    "see http://public.web.cern.ch/public/en/lhc/lhc-en.html for many details .",
    "r.  adolphi _ et al . _",
    "( cms collaboration ) , `` the cms experiment at the cern lhc , '' journal of instrumentation 3 , s08004 ( 2008 ) .",
    "m.  michelotto , `` a comparison of hep code with spec benchmark on multicore worker nodes , '' proceedings of computing in high energy physics ( chep09 ) , prague , czech republic ( 2009 ) . c.  grandi , d.  stickland , l.  taylor .",
    "_ et al . _ , `` the cms computing model , '' cern - lhcc-2004 - 035 ( 2004 ) .",
    "j.  knobloch , l.  robertson _",
    "et al . _ ,",
    "`` lhc computing grid techical design report , '' cern - lhcc-2005 - 024 ( 2005 ) .",
    "r.  egeland , t.  wildish , and s.  metson , `` data transfer infrastructure for cms data taking , '' pos ( acat08 ) 033 .",
    "m.  corvo _ et al .",
    "_ , `` crab , a tool to enable cms distributed analysis , '' proceedings of computing in high energy physics ( chep06 ) , mumbai , india ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> each lhc experiment will produce datasets with sizes of order one petabyte per year . </S>",
    "<S> all of this data must be stored , processed , transferred , simulated and analyzed , which requires a computing system of a larger scale than ever mounted for any particle physics experiment , and possibly for any enterprise in the world . </S>",
    "<S> i discuss how cms has chosen to address these challenges , focusing on recent tests of the system that demonstrate the experiment s readiness for producing physics results with the first lhc data . </S>"
  ]
}