{
  "article_text": [
    "soft matter systems such as polymer solutions , colloidal suspensions , membranes , and microemulsions exhibit many interesting dynamical behaviors , where hydrodynamic flow plays an important role , as do thermal fluctuations . the characteristic time and",
    "length scales of soft - matter systems are in the range from nanoseconds to seconds and from nano- to micrometers , respectively , and are thus typically much larger than the atomistic scales .",
    "mesoscale simulation techniques are therefore necessary to simulate these systems for sufficiently large system sizes with reasonable computational effort .",
    "several mesoscale techniques for the simulation of the flow of complex fluids accompanied by thermal fluctuations have been developed in the last decades , such as direct simulation monte carlo ( dsmc )  @xcite , the lattice boltzmann method  @xcite , dissipative particle dynamics ( dpd )  @xcite , and multi - particle collision dynamics ( mpc ) @xcite .",
    "dsmc , dpd , and mpc are off - lattice hydrodynamics methods and share many properties .",
    "dpd and mpc have been applied to various soft - matter systems such as colloids  @xcite , polymers  @xcite , and surfactants  @xcite .    the key features to distinguish dpd and mpc are the application of a langevin thermostat to the relative velocities of particle pairs or multi - particle collisions , and whether or not to employ collision cells . to understand and elucidate the relation between dpd and mpc , two intermediate methods have been proposed in ref .",
    "@xcite , which are dpd with a multibody thermostat ( dpd - mt ) and mpc - langevin dynamics ( mpc - ld )",
    ". the standard mpc algorithm does not conserve angular momentum .",
    "however , an angular - momentum - conserving version of mpc has also been proposed in ref .",
    "we denote the versions of a simulation method with or without angular - momentum conservation by an extension ` @xmath0 ' or ` @xmath1 ' , respectively .",
    "the importance of angular - momentum conservation in mpc fluids has been studied in ref .",
    "@xcite . in the absence of angular - momentum conservation",
    ", an additional torque appears which depends linearly on the vorticity , whereas the velocity field is unaffected .",
    "therefore , it is essential to employ ` @xmath0 ' techniques to simulate systems such as rotating colloids and binary fluids with different viscosities .    in this paper , we investigate the viscosity @xmath2 and self - diffusion constant @xmath3 of mpc and dpd methods .",
    "the transport coefficients of ` @xmath1 ' versions of mpc were previously derived analytically , and show good agreements with numerical results  @xcite .",
    "we derive here analytically the viscosity and diffusion constant of all ` @xmath0 ' versions of mpc .",
    "the transport coefficients of original version of dpd were derived analytically for systems with an ideal - gas equation of state in the small - time - step limit  @xcite and with finite time step  @xcite , and phenomenologically for soft - repulsive interactions  @xcite .",
    "here , we investigate the transport coefficients of dpd@xmath1 and dpd - mt for the ideal - gas equation of state with finite time step . the viscosity and diffusion constant are also determined from simulations of simple shear flow with lees - edwards boundary conditions and of the mean square displacement of a particle , respectively .",
    "the outline of this paper is as follows . in sec .",
    "[ sec : mpc ] , we describe several versions of mpc , both with and without angular momentum conservation , and calculate their transport coefficients analytically and numerically .",
    "transport coefficients of several version of dpd are calculated in sec .",
    "[ sec : dpd ] . in sec .",
    "[ sec : thermo ] , we discuss the upper limits of the local shear rate for which thermostats in mpc and dpd are capable to provide local - equilibrium condition .",
    "mpc is a modification of dsmc to include multi - particle collisions , in order to make the algorithm more efficient in its application  @xcite .",
    "a fluid is described by point - like particles of mass @xmath4 .",
    "the mpc algorithm consists of alternating streaming and collision steps . in the streaming step ,",
    "the particles move ballistically , @xmath5 where @xmath6 is the time interval between collisions . in the collision step",
    ", the particles are sorted into cubic cells of lattice constant @xmath7 .",
    "the collision procedure is different for each version of mpc . for mpc@xmath1",
    ", it is generally given by @xmath8,\\ ] ] where @xmath9 is the velocity of the center of mass of all particles in the box , and @xmath10 .",
    "the collision operator @xmath11 $ ] stochastically changes the relative velocity @xmath12 , with @xmath13=0 $ ] to keep the translational momentum constant .",
    "this stochastic process is independent for each cell and each time step , and the collision operator @xmath11 $ ] depends on whether a particle is inside a cell , but not on its position @xmath14 within the cell . to guarantee isotropy ,",
    "the operator must be symmetric on average , with @xmath15_{\\beta } \\rangle =   ( 1-a)\\langle { v_{\\alpha}}^2 \\rangle\\delta_{\\alpha\\beta}$ ] , where the subscripts @xmath16 indicate the spatial components .",
    "the constants @xmath17 and @xmath18_{\\alpha } { \\bf \\omega}[{\\bf v}]_{\\beta}\\rangle/\\langle v_{\\alpha } v_{\\beta}\\rangle$ ] are characteristic quantities of each version ( see table  [ tab : fac ] ) , which play an essential role in determining the transport coefficients . the operator @xmath11 $ ] conserves the total kinetic energy in each cell ( local micro - canonical ensemble ) or is coupled to a thermostat ( local canonical ensemble ) .",
    "the collision cells are randomly shifted before each collision step to ensure galilean invariance  @xcite .",
    "the operator @xmath19 $ ] of the original version of mpc is the rotation operator .",
    "it is represented by a matrix @xmath20 which rotates velocities by an angle @xmath21 .",
    "the rotation axis is chosen randomly for each cell , which requires one integer or two real random numbers in two- ( @xmath22d ) or three - dimensional ( @xmath23d ) space , respectively . in @xmath22d ,",
    "the axis is the @xmath24 direction ( out of plane ) , _",
    "i.e _ the rotation is clockwise or anticlockwise with the angle @xmath21 ( see fig .  [",
    "fig : ope ] ) . this original version of mpc",
    "is typically denoted mpc or stochastic rotation dynamics ( srd ) .",
    "we denote it mpc - sr@xmath1 in this paper , in order to distinguish this particular version clearly from the whole family of mpc techniques . in mpc - sr@xmath1",
    ", the energy in each cell is conserved .",
    "the temperature can be controlled by an additional rescaling of the relative velocities @xmath25 , where @xmath26 is the spatial dimension , @xmath27 is the total number of particles , and @xmath28 is the number of cells occupied by particles .",
    "this corresponds to a velocity - scaling version of the profile - unbiased thermostat ( put )  @xcite , where cells are introduced to thermostat local velocities relative to the center - of - mass velocity of each cell .",
    "the number @xmath29 of the degrees of freedom should be sufficiently large for the central - limit theorem to apply .",
    "this usually implies that the number of cells included in the calculation of the rescaling factor is large . when the velocity rescaling is performed on the level of single collision cells , the monte carlo scheme proposed in ref .",
    "@xcite should be employed .    in the random angle version of mpc ( denoted mpc - ra@xmath1 )",
    "@xcite , the same matrix @xmath20 is employed , but the rotational angle @xmath21 is also selected stochastically varied in the interval @xmath30 . in mpc - ra@xmath1 , one or three real random numbers are required for each cell in @xmath22d or @xmath23d , respectively .    in the andersen - thermostat  @xcite version of mpc , denoted mpc - at  @xcite , the operator completely renews the relative velocities in the cell , @xmath19= { \\bf v}_{i}^{\\rm { ran } }    - \\sum_{j \\in { \\rm cell } } { \\bf v}_j^{\\rm { ran}}/n_{\\rm { c}}$ ] , where @xmath31 is the number of particles in a cell .",
    "a velocity @xmath32 is chosen from a maxwell - boltzmann distribution .",
    "thus , in mpc - at@xmath1 , the velocities of particles are updated by @xmath33 instead of the energy , the temperature is constant in mpc - at .    in the langevin version of mpc ( mpc - ld@xmath1 )",
    "@xcite , the langevin thermostat is applied to the relative velocities in a collision cell .",
    "the particle motion is governed by @xmath34 in order to satisfy the fluctuation - dissipation theorem , the gaussian white noise @xmath35 has to have the average @xmath36 and the variance @xmath37 , where @xmath38 and @xmath39 is the thermal energy .",
    "we consider in this paper only fluids with an ideal - gas equation state , _",
    "i.e. _ @xmath40 in eq .",
    "( [ eq : mpld0 ] ) . the finite time - step version of mpc - ld@xmath1 is given by the leapfrog algorithm , @xmath41 where @xmath42 and @xmath43 .",
    "thus , the collision operator is @xmath11= a_{\\rm { ld}}{\\bf v}_{i,{\\rm c } }      + b_{\\rm { ld}}\\{{\\mbox{\\boldmath $ \\xi$}}_{i , n }",
    "-\\sum { \\mbox{\\boldmath $ \\xi$}}_{j , n}/n_{\\rm { c}}\\}$ ] .",
    "mpc - ld with @xmath44 coincides with mpc - at . in mpc - at and mpc - ld ,",
    "the correlations have a simple relation , @xmath45 .",
    "however , mpc - sr and mpc - ra have additional correlations between @xmath46 and @xmath47 components , _",
    "i.e. _ @xmath48 as shown in table  [ tab : fac ] .",
    ".[tab : fac ] correlation factors @xmath49_{\\alpha}\\rangle/       \\langle{v_{\\alpha}}^2 \\rangle$ ] and @xmath18_{\\alpha }     { \\bf \\omega}[{\\bf v}]_{\\beta}\\rangle/\\langle v_{\\alpha } v_{\\beta}\\rangle$ ] of various mpc methods , where @xmath16 and @xmath50 . [ cols=\"<,^,^,<\",options=\"header \" , ]      collisions described by eq .",
    "( [ eq : mpc - a ] ) conserve translational momentum , but do _ not _ conserve angular momentum .",
    "however , angular - momentum conservation can be imposed by an additional constraint .",
    "this modification is straightforward for the mpc versions with an intrinsic thermostat ( such as mpc - at and mpc - ld ) . in this case , the collision is given by @xmath51 \\\\ \\nonumber & + &   m{\\bf \\pi}^{-1 } \\sum_{j \\in { \\rm cell } } \\big\\{{\\bf r}_{j,{\\rm c}}\\times       ( { \\bf v}_{j,{\\rm c}}-{\\bf \\omega}[{\\bf v}_{j,{\\rm c } } ] ) \\big\\ } \\times { \\bf r}_{i,{\\rm c } } , \\end{aligned}\\ ] ] where @xmath52 is the moment - of - inertia tensor of the particles in the cell .",
    "the relative position is @xmath53 where @xmath54 is the center of mass of the particles in the cell .",
    "the angular momentum of the cell after the collision , @xmath55 , is the same as before the collision .",
    "the subtraction of either position or velocity of the center of mass can be omitted in the last term of eq .",
    "( [ eq : mpc+a ] ) , since @xmath56 .    for mpc - at@xmath0 or mpc - ld@xmath0 , the terms @xmath57",
    "are added to eqs .",
    "( [ eq : mpat ] ) and ( [ eq : mpld0 ] ) , respectively  @xcite .",
    "( color online ) schematic representation of the collision operation for mpc - sr@xmath58 and mpc - dr in @xmath22d in the co - moving reference frame ( with @xmath59 ) at @xmath60 and @xmath61 .",
    "circles represent the positions of particles ( @xmath62 ) and the center of mass ( @xmath63 ) .",
    "` old ' indicates the velocities before the collision , ` @xmath64a ' and dr represent the velocities after the collision for mpc - sr@xmath58 and mpc - dr , respectively , and ` @xmath0-vs ' indicates the velocities after the ` @xmath0 ' collision without velocity rescaling . ]",
    "( color online ) radial distribution function @xmath65 of mpc - sr@xmath0 ( with @xmath66 , @xmath67 and @xmath68 , @xmath69 ) and mpc - at@xmath0 ( with @xmath66 , @xmath69 ) in two - dimensional space .",
    "the inset shows the @xmath70 dependence of @xmath65 of mpc - sr@xmath0 at @xmath69 .",
    "error bars are shown at several data points . ]",
    "when eq .",
    "( [ eq : mpc+a ] ) is applied to the operator of mpc - sr or mpc - ra , the kinetic energy is _ not _ conserved .",
    "thus , the collision process has to be modified by combining it with velocity rescaling to conserve the energy , @xmath71 -   m{\\bf \\pi}^{-1 } \\sum_{j \\in { \\rm cell } } \\big({\\bf r}_{j,{\\rm c}}\\times       { \\bf \\omega}[{\\bf v}_{j,{\\rm c}}]\\big ) \\times { \\bf r}_{i,{\\rm c } }   \\big\\},\\end{aligned}\\ ] ] where @xmath72 . here ,",
    "the relative velocities before and after the collision , @xmath73 and @xmath74 , respectively , are given by @xmath75 , where the total translational and angular velocities of the cell are subtracted .",
    "this collision is shown schematically in fig .",
    "[ fig : ope ] . under the molecular - chaos assumption ,",
    "this yields the ideal - gas equation of state .",
    "however , the molecular - chaos assumption is not perfectly valid .",
    "thus , the radial distribution function @xmath65 of mpc - sr@xmath0 exhibits deviations from the uniform distribution of the ideal gas , in particular for small @xmath70 and small @xmath6 ( see fig .  [ fig : rdf ] ) . if the velocity rescaling for the energy conservation is done not for each cell but for the sum of many cells , this deviation becomes larger .",
    "a similar deviation is seen in dpd simulations @xcite with the modified velocity - verlet algorithm @xcite .",
    "mpc - at@xmath0 and mpc - ld@xmath0 and all ` @xmath1 ' versions of mpc give the correct uniform @xmath65  see , e.g. , the data of mpc - at@xmath0 in fig .",
    "[ fig : rdf ] .",
    "thus , mpc - sr@xmath0 should not be used for small @xmath70 or small @xmath6 .",
    "we recommend to check @xmath65 for any new mpc operator .",
    "an alternative modification of mpc - sr for _ two - dimensional _ fluids to conserve angular momentum has been proposed recently by ryder  @xcite ( see also ref .",
    "we denote this algorithm mpc - dr ( deterministic rotation ) . in mpc - dr",
    ", a rotational angle is chosen deterministically to keep the total angular momentum of particles in a collision cell constant by the requirement @xmath76 , where @xmath77 and @xmath78 .",
    "this implies @xmath79 the velocities after a collision in mpc - dr are different from those in mpc - sr@xmath0 , since the ` @xmath0 ' procedure ( from ` @xmath1 ' to ` @xmath0-vs ' in fig .",
    "[ fig : ope ] ) does not change the radial velocities .",
    "mpc - dr gives the correct uniform @xmath65 and is less time - consuming than other ` @xmath0 ' versions of mpc .",
    "we also checked that mpc - dr yields the correct constant angular velocities for phase - separated binary fluids with different viscosities in a circular couette flow , as described in sec .",
    "iv.c of ref .",
    "however , this algorithm can not be generalized to three - dimensional systems .",
    "angular - momentum conservation implies that the stress tensor @xmath80 for an isotropic newtonian fluid is symmetric , _",
    "i.e. _ @xmath81  @xcite .",
    "in contrast , mpc@xmath1 fluids have an asymmetric stress tensor @xmath82 because of the lack of angular - momentum conservation @xcite , where @xmath16 and @xmath83 is the second viscosity coefficient . @xmath84 and @xmath85 are the symmetric and antisymmetric components of the viscosity , respectively . the last term in eq .",
    "( [ eq : strs ] ) implies that the stress depends linearly on the vorticity @xmath86 , and does not conserve angular momentum .",
    "thus , this term vanishes ( _ i.e. _ @xmath87 ) in angular - momentum conserving systems .",
    "the evolution of the velocity field @xmath88 is determined by @xmath89 where @xmath90 is lagrange s derivative and @xmath91 is the pressure field .",
    "when a fluid is incompressible , eq .  ( [ eq : nseq ] ) is the normal navier - stokes equation with viscosity @xmath92 .",
    "this is consistent with the usual definition of the shear viscosity @xmath93 in simple shear flow with velocity field @xmath94 , where @xmath95 is the unit vector along the @xmath46 direction .",
    "since both the equations of continuity and of velocity evolution are of the same forms in systems with and without angular - momentum conservation , the absence of angular - momentum conservation does not affect the velocity field of a fluid when the boundary conditions are given by velocities .",
    "however , it generates an additional torque , as described in detail in ref .",
    "@xcite . in this paper",
    ", we discuss the stress tensor of various mpc and dpd methods .",
    "the shear viscosity is calculated from @xmath96 in simple shear flow with @xmath94 .",
    "the viscosity of mpc fluids consists of two contributions , @xmath97 , where the kinetic viscosity @xmath98 and the collisional viscosity @xmath99 result from the momentum transfer due to particle displacements and collisions , respectively .",
    "the derivation of the viscosity for mpc - sr@xmath1 described in refs .",
    "@xcite can be employed directly for other ` @xmath1 ' versions of mpc , since the differences appear only in the factors @xmath17 and @xmath100 listed in table  [ tab : fac ] .",
    "the kinetic stress @xmath101 is the momentum flux due to particles crossing a @xmath102 plane at @xmath103 .",
    "the stress due to streaming in the time interval @xmath104 $ ] is written as @xmath105 where @xmath106 is the surface area of the considered plane .",
    "the average over equivalent @xmath102 planes yields @xmath107 where @xmath108 is the average number of particles per cell , and @xmath109 is the volume of the considered region @xmath110 , with @xmath111 ; here the middle position @xmath112 during streaming is employed to determine whether the @xmath113-th particle is inside the region @xmath110 .",
    "the expression ( [ eq : stk1 ] ) is symmetric in @xmath46 and @xmath47 .",
    "the symmetry of the kinetic part of the stress tensor , _",
    "i.e. _ @xmath114 , implies @xmath115 for all versions of mpc and dpd .",
    "numerically , @xmath116 and @xmath98 can be calculated from eq .",
    "( [ eq : stk0 ] ) or ( [ eq : stk1 ] ) .",
    "the velocity distribution is shifted by particle streaming so that @xmath117 where @xmath118 is the velocity probability distribution .",
    "the velocity distribution is modified by the mpc collisions so that @xmath119 , where the factor @xmath120 is determined later .",
    "the self - consistency condition of a stationary shear flow is @xmath121 .",
    "the kinetic viscosity @xmath98 is then given by  @xcite @xmath122 eq .",
    "( [ eq : kvis0 ] ) holds for all ` @xmath58 ' versions of mpc and dpd .",
    "the velocity correlations for mpc@xmath1 are calculated by using eq .",
    "( [ eq : mpc - a ] ) , @xmath123 where molecular chaos is assumed , _",
    "i.e. _ @xmath124 and @xmath125 for @xmath126 .",
    "thus the correlation factor for a cell occupied by @xmath127 particles is @xmath128 .",
    "an mpc fluid is thermodynamically an ideal gas , so that the cell occupation number @xmath127 fluctuates with the poisson distribution , @xmath129 with @xmath108 .",
    "thus , the average correlation is give by @xmath130 .",
    "the kinetic viscosity of mpc@xmath1 is then given by @xmath131    the collisional stress @xmath132 is the momentum flux due to mpc collisions in cells crossing a plane at @xmath133 .",
    "it is given by @xcite @xmath134 when eq .",
    "( [ eq : stc0 ] ) is averaged over the planes crossing the cell , @xmath135 , the stress reads @xmath136 where @xmath137 and @xmath138 is the @xmath47 component of the center - of - cell position @xmath139 .",
    "numerically , @xmath140 and @xmath99 can be calculated from either eq .",
    "( [ eq : stc0 ] ) or ( [ eq : stc1 ] ) .",
    "the mean velocity difference is @xmath141 , because @xmath142 , where @xmath143 is averaged over @xmath144 for @xmath145 at @xmath146 .",
    "then the collisional viscosity @xmath99 of mpc@xmath1 is given by @xmath147 the vorticity viscosity @xmath148 is proportional to the angular - momentum transfer with respect to the origin @xmath149 , see eq .",
    "( [ eq : stc1 ] ) .",
    "thus , the vorticity viscosity of mpc@xmath0 vanishes , @xmath150 , because of angular - momentum conservation . for mpc@xmath1 ,",
    "the molecular - chaos assumption gives @xmath151 , because @xmath152 .",
    "thus , the viscosities are @xmath153 @xcite .",
    "this viscosity relation holds for all ` @xmath1 ' versions of mpc and dpd described in this paper .    as an extension of this approach",
    ", the angular - momentum constraint can be applied only partially , by employing alternatively the mpc - collision algorithms which conserve [ given by eq .",
    "( [ eq : mpc+a ] ) ] and do not conserve [ determined by the difference of the right - hand sides of eqs .",
    "( [ eq : mpc - a ] ) and ( [ eq : mpc+a ] ) ] angular momentum . in this way",
    ", the viscosity ratio @xmath154 can be varied continuously between @xmath155 and approximately @xmath156 .",
    "next , we derive the self - diffusion constant @xmath3 of mpc@xmath1 . under the molecular - chaos assumption",
    ", the velocity correlation function decays exponentially , @xmath157 with @xmath158 .",
    "the diffusion constant is thus given by  @xcite @xmath159 in mpc@xmath1 , the correlation factor is @xmath160 with @xmath161 ; this implies @xmath162 however , the velocity auto - correlation function @xmath163 for small mean free path @xmath164 has a long - time tail due to hydrodynamic backflow  @xcite .",
    "this leads to an additional hydrodynamic contribution to the diffusion constant @xmath3 , which thereby becomes larger than predicted by eq .",
    "( [ eq : dif - a ] ) .      to derive expressions for the self - diffusion constant and viscosity of mpc@xmath0",
    ", we employ eqs .",
    "( [ eq : kvis0 ] ) , ( [ eq : stc1 ] ) , and ( [ eq : dif0 ] ) , which remain valid with angular - momentum conservation . however , the correlation factors @xmath165 and @xmath120 of mpc@xmath0 are different from those of mpc@xmath1 .",
    "first , we consider the limit of large @xmath70 , where @xmath166 and @xmath167 , and derive the corrections for small @xmath70 subsequently .",
    "the velocity correlation is calculated from @xmath168 with the molecular - chaos assumption .",
    "the positions of particles @xmath14 are averaged over the cell , so that @xmath169 and @xmath170 where @xmath171 is the identity matrix .",
    "angular - momentum conservation implies additional correlations , which result in @xmath172 where @xmath173 is the @xmath46 component of unit vector @xmath174 and @xmath175 .",
    "the diffusion constant of mpc@xmath0 for large @xmath70 is thus found to be @xmath176     ( color online ) dependence of the viscosity in mpc - at@xmath58 on @xmath177 in two- or three - dimensional space for ( a ) @xmath178 and ( b ) @xmath66 .",
    "symbols represent the numerical data of mpc - at@xmath0 in @xmath22d ( @xmath62 , @xmath179 ) or @xmath23d ( @xmath63 , @xmath180 ) and mpc - at@xmath1 in @xmath22d ( @xmath181 , @xmath182 ) or @xmath23d ( @xmath183 , @xmath184 ) , respectively .",
    "solid and dashed lines represent analytical results for mpc - at@xmath0 and mpc - at@xmath1 , respectively .",
    "error bars are smaller than the size of symbols . ]",
    "( color online ) dependence in mpc - at@xmath58 of the viscosities on the particle number per cell , @xmath70 .",
    "( a),(c ) @xmath98 and ( b ) @xmath99 .",
    "symbols represent the numerical data of mpc - at@xmath0 ( @xmath62 , @xmath179 ) and mpc - at@xmath1 ( @xmath181 , @xmath182 ) for @xmath69 and @xmath67 in @xmath22d , respectively , and the numerical data of mpc - at@xmath0 at @xmath67 ( @xmath183 ) in @xmath23d . in ( a),(b ) , the viscosity is rescaled by @xmath177 and @xmath185 , respectively , in order to facilitate a presentation of data for different @xmath177 on the same scale .",
    "solid and dashed lines in ( a ) and ( b ) represent analytical results for mpc - at@xmath0 and mpc - at@xmath1 , respectively .",
    "solid and dashed lines in ( c ) represent analytical results with or without the correction term @xmath186 , respectively .",
    "error bars are smaller than the size of symbols . ]    for the calculation of the kinetic viscosity , we obtain the @xmath187 correlation factor @xmath188 the kinetic viscosity @xmath98 for large @xmath70 is then given by eqs .",
    "( [ eq : kvis0 ] ) and ( [ eq : c+a ] ) with @xmath167 . for mpc - at@xmath0 and mpc - ld@xmath0 , this implies for large @xmath70 that @xmath189 note that @xmath2 and @xmath3 of mpc - ld@xmath58 have a different dependence on the time step @xmath6 than other mpc algorithms , since their correlation factors @xmath17 and @xmath100 depend on @xmath6 ( see table  [ tab : fac ] ) .",
    "the mean velocity difference for mpc@xmath0 is given by @xmath190 the @xmath191 component of the velocity is pre - averaged , the angular velocity is in the vorticity direction , @xmath192 , and @xmath193 , so that @xmath194 where the numerator and denominator are averaged over @xmath195 , @xmath196 , and @xmath197 independently .",
    "when @xmath198 is also pre - averaged over @xmath199 , @xmath200 is obtained . however , eq .  ( [ eq : stc1 ] ) together with eq .",
    "( [ eq : stc+a0 ] ) contains an integral with @xmath201 , which yields an additional correction term of @xmath202 , @xmath203 then , the collisional viscosity @xmath99 of mpc@xmath0 for large @xmath70 is given by @xmath204     ( color online ) viscosity of mpc - ld@xmath58 as a function of ( a ) @xmath205 and ( b ) , ( c ) @xmath70 in three - dimensional space at ( a ) @xmath206 and @xmath69 and ( b),(c ) @xmath207 .",
    "symbols represent the numerical data of mpc - ld@xmath0 ( @xmath62 , @xmath179 ) and mpc - ld@xmath1 ( @xmath181 , @xmath182 ) . dashed and solid lines represent analytical results for ( a ) @xmath98 or @xmath99 , and ( b ) , ( c ) @xmath69 or @xmath156 , respectively .",
    "error bars are smaller than the size of symbols . ]",
    "( color online ) viscosity @xmath2 in two - dimensional space as a function of @xmath177 for mpc - sr@xmath58 with @xmath61 , mpc - ra@xmath58 with @xmath208 , and mpc - dr with @xmath66 or @xmath178 .",
    "solid and dashed lines represent analytical results for @xmath178 and @xmath66 , respectively .",
    "( a ) symbols represent the numerical data of mpc - ra@xmath0 ( @xmath209 , @xmath179,@xmath184 ) , mpc - dr ( @xmath63,@xmath62,@xmath210 ) , mpc - ra@xmath1 ( @xmath182,@xmath183 ) , mpc - sr@xmath1 ( @xmath181 ) , and mpc - sr@xmath0 ( @xmath211 ) .",
    "error bars are smaller than the size of symbols . ]",
    "next , we derive the correction terms for small @xmath70 . for @xmath212 or @xmath22 , eqs .",
    "( [ eq : s+a ] ) and ( [ eq : c+a ] ) do not give the correct correlation factors @xmath213 and @xmath214 for mpc@xmath0  unlike for mpc@xmath1 .",
    "first , there is no velocity transfer for @xmath212 , _",
    "i.e. _ @xmath215 .",
    "second , in the energy - conserving versions of mpc ( mpc - sr@xmath0 and mpc - ra@xmath0 ) , _ all _ @xmath216 degrees of freedom are determined for @xmath217 by the conservation of energy ( one degree of freedom ) , and translational ( @xmath26 degrees ) and angular ( @xmath218 degrees ) momentum , so that @xmath219 . in the mpc versions with an intrinsic thermostat ( mpc - at@xmath0 and mpc - ld@xmath0 ) ,",
    "one degree of freedom remains for the velocity transfer for @xmath217 , so that @xmath220 and @xmath221",
    ". thus , @xmath222 for energy - conserving versions of mpc , and @xmath223 for mpc versions with an intrinsic thermostat . for mpc - sr@xmath0 and mpc - ra@xmath0 , the diffusion constant @xmath3 , and the viscosities @xmath98 and @xmath99 are given by eqs .",
    "( [ eq : dif0 ] ) and ( [ eq : kvis0 ] ) with @xmath224 for mpc - at@xmath0 and mpc - ld@xmath0 , the diffusion constant @xmath3 and the viscosity contributions @xmath98 and @xmath99 are given by eqs .",
    "( [ eq : dif0 ] ) and ( [ eq : kvis0 ] ) with @xmath225    for mpc - dr , the rotation angle @xmath21 is uniformly distributed in @xmath226 under the molecular - chaos assumption .",
    "thus , the transport coefficients of mpc - dr coincide with those of mpc - ra@xmath0 at @xmath208 .",
    "thus , the diffusion constant @xmath3 , and the viscosities @xmath98 and @xmath99 of mpc - dr are given by eqs .",
    "( [ eq : dif0 ] ) , ( [ eq : kvis0 ] ) , and ( [ eq : c+a1 ] ) with @xmath227 . here",
    ", the term @xmath120 can be written in a simpler form , @xmath228 .",
    "( color online ) viscosity difference @xmath229 of mpc - at@xmath1 in two and three dimensions",
    ". symbols with dashed or solid lines represent the numerical data in @xmath22d ( @xmath62 , @xmath181 ) and @xmath23d ( @xmath182 , @xmath179 ) at @xmath66 or @xmath178 , respectively .",
    "the inset shows the dependence of @xmath230 on the average particle number @xmath70 per cell , for @xmath69 ( @xmath181 ) and @xmath67 ( @xmath62 ) . ]",
    "( color online ) dependence of the diffusion constant @xmath3 of mpc - at@xmath58 on @xmath6 at @xmath178 in three dimensions .",
    "symbols and lines represent numerical and analytical data , respectively .",
    "error bars are smaller than the size of symbols . ]",
    "[ fig : visats][fig : vismpc ] show the viscosities @xmath98 and @xmath99 for five mpc methods with or without the angular - momentum conservation .",
    "the results are displayed in form of dimensionless quantities with length and time units @xmath7 and @xmath231 , respectively .",
    "the main parameters which control the properties of mpc fluids , the time step and friction constant , have the dimensionless form @xmath232 and @xmath233 .",
    "similarly , the viscosity and diffusion constant of a particle are shown in units of @xmath234 and @xmath235 , respectively .",
    "the error bars of the simulation results are estimated from three independent runs .",
    "analytical results are calculated from eqs .",
    "( [ eq : dif0 ] ) and ( [ eq : kvis0 ] ) together with eq .",
    "( [ eq : c+a1 ] ) , or from eqs .",
    "( [ eq : s+a2 ] ) to ( [ eq : cvis+a2 ] ) , and show generally good agreement with the numerical data , in particular for @xmath236 and large @xmath70 . for smaller time step @xmath69 , the most significant deviations between numerical and analytical results are found for the kinetic viscosity @xmath98 , both for mpc - at@xmath1 and mpc - at@xmath0 , as shown in fig .",
    "[ fig : visatn](a ) . similar deviations between analytical and numerical results for @xmath98 have been observed for dpd in refs .",
    "@xcite , and have been explained by correlation effects between collisions  @xcite . at @xmath69 , a pair of particles",
    "can collide sequentially several times ; in particular for @xmath237 , pairwise collision occur frequently without involving any other particles .",
    "thus , the molecular - chaos assumption is weakly violated .",
    "there are also deviations between analytical and numerical results for the viscosity difference @xmath238 of mpc@xmath1 at small @xmath6 or small @xmath70 ( see fig .",
    "[ fig : visyr ] ) .",
    "this is also caused by a violation of the molecular - chaos assumption .",
    "angular - momentum conservation does not affect the kinetic viscosity @xmath98 of mpc - at in @xmath22d at large @xmath70 , compare eqs .",
    "( [ eq : kvis - a ] ) and ( [ eq : kvisat+a ] ) .",
    "numerical results are shown in figs .",
    "[ fig : visats](a ) and [ fig : visatn](a ) . however , the correction term in eq .",
    "( [ eq : c+a2 ] ) predicts a small difference of @xmath98 for mpc - at@xmath1 and mpc - at@xmath0 for small @xmath239 , see figs .",
    "[ fig : visats](b ) and [ fig : visatn](a ) .",
    "the viscosities @xmath98 and @xmath99 of mpc - at@xmath1 , and @xmath99 of mpc - at@xmath0 for large @xmath70 , show no dependence on the space dimension @xmath26 ( except for the scale factor @xmath240 ) ; therefore , the corresponding symbols and lines in fig .  [ fig : visats ] coincide .    in two dimensions , mpc - sr with @xmath61 and mpc - ra with @xmath208 are characterized by @xmath241 , and by @xmath242 and @xmath243 , respectively .",
    "thus , they have the same collisional viscosity @xmath99 for both their ` @xmath1 ' and ` @xmath0 ' version , but a different kinetic viscosity @xmath98 , see fig .",
    "[ fig : vismpc ] .",
    "although mpc - dr has the same viscosity of mpc - ra@xmath0 theoretically , the numerical data of mpc - dr shown in fig .  [ fig : visats ] display a slightly larger deviation from the theoretical results for @xmath99 and a smaller deviation for @xmath98 than the data of mpc - ra@xmath0 .",
    "( [ eq : kvis0 ] ) together with ( [ eq : c+a2 ] ) predicts a minimum of @xmath98 around @xmath66 , as shown in figs .",
    "[ fig : visatn](c ) and [ fig : visld](b ) .",
    "however , this minimum is not seen in numerical data and could be caused by the negligence of higher - order terms in eq .",
    "( [ eq : c+a ] ) .",
    "we therefore investigate the dependence of the next - order term @xmath244 , where @xmath245 is a free parameter .",
    "the average is estimated by @xmath246 , which yields the asymptotic dependence @xmath247 for small @xmath70 and @xmath248 for @xmath249 .",
    "the correction term @xmath186 is then added to eq .",
    "( [ eq : c+a2 ] ) with @xmath245 as a fit parameter . fig .",
    "[ fig : visatn](c ) shows that this correction term with @xmath250 in @xmath22d and @xmath251 in @xmath23d removes the minimum and gives better agreement with the numerical data of mpc - at@xmath0 .",
    "[ fig : dif ] shows the self - diffusion constant @xmath3 of mpc - at@xmath58 .",
    "the ` @xmath0 ' fluid displays faster diffusion than the ` @xmath1 ' fluid .",
    "the diffusion constant @xmath3 is numerically calculated from the mean square displacement of a particle , @xmath252 , in a cubic simulation box with side length @xmath253 .",
    "deviations from the analytical results calculated with the molecular - chaos assumption are seen for small @xmath177 .",
    "the dpd thermostat is a modified langevin thermostat , where friction and noise forces are applied to the relative velocities of pairs of neighboring particles @xcite .",
    "the equation of motion for the @xmath113-th particle with mass @xmath4 is given by @xmath254 where @xmath255 , @xmath256 , and @xmath257 , with weight @xmath258 .",
    "the gaussian white noise @xmath259 obeys the fluctuation - dissipation theorem , with @xmath260 and @xmath261 .",
    "this thermostat is applied only in the direction @xmath262 to conserve the angular momentum .",
    "we denote this original method here dpd@xmath0 .    in dpd ,",
    "a linear weight function @xmath263 is typically employed , which vanishes beyond the cutoff distance @xmath264 .",
    "furthermore , dpd is usually combined with a soft repulsive potential @xmath265 ; however , we only consider the ideal - gas equation state ( with potential @xmath266 ) in this paper .",
    "the dpd equation  ( [ eq : dpd+a ] ) is discretized by the shardlow s s1 splitting algorithm  @xcite , where each thermostat of the @xmath267 pair is integrated separately , @xmath268 with @xmath269 the discretized gaussian noise @xmath270 is determined by the variance @xmath271 .",
    "this splitting algorithm belongs to the class of generalized lowe - anderson thermostats  @xcite , because the factors @xmath272 and @xmath273 satisfy the relation @xmath274 @xcite .",
    "dpd can be modified to remove angular - momentum conservation .",
    "we denoted this technique here dpd@xmath1 .",
    "it has been introduced in ref .",
    "@xcite to explore the similarities and differences between dpd and mpc methods . in this case , the equation of motion reads @xcite @xmath275 the splitting algorithm can also be applied to dpd@xmath1 as @xmath276 .",
    "the combination of dpd@xmath0 and dpd@xmath1 , denoted ` transverse dpd ' , with an equation of motion determined by the difference of the right - hand sides of eqs .",
    "( [ eq : dpd - a ] ) and ( [ eq : dpd+a ] ) , has been suggested very recently  @xcite .",
    "a similar anisotropic friction has been used in the standard langevin equation to treat polymer entanglement implicitly in polymer melts  @xcite and dilute polymer solutions  @xcite .",
    "the dpd thermostat can be generalized into a multibody thermostat ( denoted dpd - mt@xmath1 )  @xcite , which is defined by the equation of motion @xmath277 where @xmath278 , and @xmath279 is the weighted mean velocity . the second term on the right - hand side of eq .",
    "( [ eq : dpdmt ] ) is the friction term between the @xmath113-th particle and its neighbors , and @xmath280 thermostats in eq .",
    "( [ eq : dpd - a ] ) are unified into a single thermostat , where @xmath281 is the average number of the neighbors with @xmath282 .",
    "the third and fourth terms on the right - hand side of eq .",
    "( [ eq : dpdmt ] ) are needed to conserve the translational momentum .",
    "angular momentum can be conserved in dpd - mt , when the thermostat for the @xmath113-th particle is applied only in the direction @xmath283 , where the weighted center of mass is @xmath284 .",
    "the equation of motion of dpd - mt@xmath0 is thus given by @xmath285    shardlow s s1 splitting algorithm  @xcite can be applied to both dpd - mt@xmath1 and dpd - mt@xmath0 .",
    "( [ eq : dpdmt ] ) of dpd - mt@xmath1 is discretized such that each thermostat of the @xmath286 pair is integrated separately , @xmath287 the factors @xmath288 and @xmath289 are given by @xmath290 where @xmath291 .",
    "we now derive analytical expressions for the viscosity @xmath2 and self - diffusion constant @xmath3 of dpd@xmath1 and dpd - mt@xmath58 with ideal - gas equation of state ( with potential @xmath266 ) .",
    "the corresponding derivations for dpd@xmath0  @xcite can be straightforwardly carried over to this case .",
    "the correlations of dpd@xmath58 results from a multitude of pairwise collisions , so that @xmath292 and @xmath293 .",
    "( [ eq : split+a ] ) together with a molecular - chaos assumption implies @xmath294 , @xmath295 for dpd@xmath0 , and @xmath296 , @xmath297 for dpd@xmath1 .",
    "for an ideal gas , the number of particles @xmath298 per volume @xmath299 is given by the poisson distribution , @xmath300 , so that @xmath301 for some constant @xmath302 .",
    "this implies @xmath303 .    the collisional stress @xmath140 is the momentum flux due to dpd collisions crossing a plane at @xmath133 .",
    "after interchange of the order of integration , @xmath140 is given by @xmath304 where eq .",
    "( [ eq : split+a ] ) and @xmath305 have been used .",
    "thus , the diffusion constant and viscosity of dpd@xmath0 are given by eq .",
    "( [ eq : kvis0 ] ) with @xcite @xmath306_g / d ) } - \\frac{1}{2 } \\right ) , \\\\ c_{\\rm m } & = & 1 -        \\exp\\left\\{n \\left[-\\frac{2a_{\\rm { dp}}(r)}{d } +           \\frac{4a_{\\rm { dp}}(r)^2}{d(d+2 ) } \\right]_g\\right\\ } , \\\\",
    "\\label{eq : cvis+dp } \\eta_{\\rm { col } }   & = & \\frac{n^2}{2d(d+2 ) } \\left[\\frac{w r^2}{1+w\\delta t / m } \\right]_g,\\\\ & & [ w]_g \\equiv \\int g(r)w(r ) dv.\\end{aligned}\\ ] ] similarly , for dpd@xmath1 , the viscosity and diffusion constant are found to be @xmath307_g ) } - \\frac{1}{2 } \\right),\\\\ c_{\\rm m } & = & 1- \\exp\\left\\{2n \\left[-a_{\\rm { dp}}(r)+ a_{\\rm { dp}}(r)^2                               \\right]_g\\right\\ } , \\\\",
    "\\eta_{\\rm { col } }   & = & \\frac{n^2}{2d}\\left[\\frac{w r^2}{1+w\\delta t / m } \\right]_g.\\end{aligned}\\ ] ] the only differences between the expressions for @xmath3 , @xmath308 and @xmath99 in dpd@xmath0 and dpd@xmath1 are prefactors containing @xmath26 and @xmath309 .    to simplify the equations of dpd - mt , the factors @xmath288 and @xmath310 are pre - averaged as @xmath311_g \\delta",
    "t / m } { 1+\\nu_{\\rm m } n[w]_g\\delta t/2 m } , \\",
    "\\   \\nu_{\\rm m}= 1+\\frac{[w^2]_g}{n[w]_g^2}.\\ ] ] then @xmath3 and @xmath99 of dpd - mt@xmath0 are given by @xmath312_g \\ \\ } { d(d+2)[w]_g ( 1 + \\nu_{\\rm m } n[w]_g\\delta",
    "t/2 m   ) } .\\end{aligned}\\ ] ] finally , for dpd - mt@xmath1 , we find @xmath313_g}{d[w]_g ( 1+\\nu_{\\rm m } n[w]_g\\delta t/2 m   ) } .\\end{aligned}\\ ] ]     ( color online ) dependence of the viscosity @xmath2 on @xmath177 of dpd@xmath58 and dpd - mt@xmath58 in three - dimensional space for @xmath314 and @xmath315 .",
    "symbols represent the numerical data of dpd@xmath0 ( @xmath62 ) , dpd@xmath1 ( @xmath183 , @xmath181 ) , dpd - mt@xmath0 ( @xmath179 ) , and dpd@xmath1 ( @xmath182 ) . dashed and solid lines represent analytical results for dpd@xmath1 and other dpd methods , respectively .",
    "error bars are smaller than the size of symbols . ]",
    "[ fig : visdpd ] shows the viscosity of various dpd fluids with an ideal - gas equation of state and the linear weight @xmath316 .",
    "the viscosity and time step are normalized by @xmath317 and @xmath318 , respectively .",
    "the dimensionless time step is @xmath232 , as before .",
    "there is in general good agreement between analytical and numerical results .",
    "however , small deviations are visible .",
    "one reason for these deviations is that the molecular - chaos assumption is not perfectly valid  @xcite . in the case of dpd - mt@xmath58 ,",
    "another reason is the pre - averaging procedure used in the derivation of the analytical expressions , which neglects some correlations .",
    "the kinetic ( collisional ) viscosities of dpd@xmath0 and dpd - mt@xmath0 are larger ( smaller ) than those of the ` @xmath1 ' versions , since angular - momentum conservation reduces the momentum transfer in dpd collisions . a similar behavior has also been found for mpc@xmath58 in sec .",
    "[ sec : mpc ] .",
    "in experiments , systems are usually thermostated on their boundaries .",
    "however , in simulations , thermostats typically act on all fluid particles in order to avoid temperature gradients . in flows ,",
    "the temperature is defined under the assumption of local equilibrium . in the mpc and dpd families ,",
    "the length scales which define this `` local '' environment are @xmath7 and @xmath319 , respectively . on these scales ,",
    "the thermal fluctuations should be separated from the macroscopic flow , and the thermostats should act on the local kinetic energy to fix the temperature .",
    "the conditions on the shear rate @xmath320 for this local equilibrium to hold are obtained as follows .",
    "all of thermostats of the mpc family are profile - unbiased thermostats ( put )  @xcite .",
    "thus , the condition for a maximum shear rate of put  @xcite also apply to mpc . in simple shear flow with low reynolds number ,",
    "the particle velocities are characterized by @xmath321 and @xmath322 . in mpc ,",
    "the particle velocity @xmath12 relative to the center - of - mass velocity of a mpc collision cell is employed to calculate the kinetic energy in the local rest frame , @xmath323 where the average is taken over all particles in a cell . for @xmath324 , the second term in eq .",
    "( [ eq : mpct ] ) is negligible , and the thermal fluctuations and shear are well separated . on the other hand , for @xmath325 , the thermostats couple with the macroscopic flow and may modify the flow behavior .    in dpd@xmath0 , the relative velocity @xmath326 of neighboring particles is employed instead , @xmath327_g}{[w]_g}.\\ ] ] for the linear weight @xmath328 and uniform radial distribution function @xmath65 , the second term in eq .",
    "( [ eq : dpdt ] ) is @xmath329 .",
    "thus , the condition for thermostats to provide local equilibrium conditions is @xmath330 .    to study the hydrodynamic behavior of complex fluids , the parameter ranges of simulations should of course also match physical conditions of experiments .",
    "thus , the simulation parameters have to be chosen such as to adjust dimensionless hydrodynamic quantities , like the reynolds number , the schmidt number , and the knudsen number .",
    "mpc and dpd are very versatile simulation techniques for mesoscale hydrodynamics . by employing different types of collision rules and thermostats , it is possible to construct a variety of algorithms with different properies .",
    "one of the important properties is whether an algorithm does or does not conserve angular momentum .",
    "the angular momentum conservation can be switched on or off in each variant of mpc and dpd .",
    "in addition to mpc algorithms suggested previously , we have introduced here an angular - momentum conserving version of the widely used stochastic - rotation - dynamics algorithm of mpc .",
    "this algorithm has to be used with some caution , because compared to other mpc@xmath0 techniques , it does not give a uniform radial distribution function .",
    "however , the deviations are small for sufficiently large particle numbers per cell and not too small time step .",
    "we have derived analytical expressions for the viscosity @xmath2 and the self - diffusion constant @xmath3 of various mpc and dpd methods .",
    "the theoretical results show very good agreement with numerical results .",
    "many similarities between mpc and dpd are seen in the derivation of @xmath2 and @xmath3 and the relation between the ` @xmath1 ' and ` @xmath0 ' versions , we believe that these similarities apply generally for particle - based hydrodynamics methods .",
    "we thank t.  ihle ( north dakota state university ) and i.o .",
    "gtze for helpful discussions .",
    "support of this work by the dfg through the sfb tr6 , `` physics of colloidal dispersions in external fields '' , is gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> the viscosity and self - diffusion constant of particle - based mesoscale hydrodynamic methods , multi - particle collision dynamics ( mpc ) and dissipative particle dynamics ( dpd ) , are investigated , both with and without angular - momentum conservation . </S>",
    "<S> analytical results are derived for fluids with an ideal - gas equation of state and a finite - time - step dynamics , and compared with simulation data . in particular , </S>",
    "<S> the viscosity is derived in a general form for all variants of the mpc method . in general , </S>",
    "<S> very good agreement between theory and simulations is obtained . </S>"
  ]
}