{
  "article_text": [
    "in this paper we investigate how much of the theory of the tutte polynomial @xmath3 @xcite , which is a large and important branch of graph and matroid theory , can be generalized to hypergraphs and polymatroids .",
    "we will see that some of the basic definitions carry over in a new and interesting way . from among the many important properties of the tutte polynomial",
    ", we find an elegant generalization of the equation relating planar dual graphs .",
    "the deletion  contraction rule also has an extension to our context but , interestingly , such formulas play a lesser role here than in the classical case .",
    "the central object of our theory is the lattice polytope @xmath4 , associated to a hypergraph @xmath5 , which generalizes the well known spanning tree polytope of ordinary graphs .",
    "the lattice points in @xmath4 are called hypertrees .",
    "a hypertree , see definition [ def : hiperfa ] , is essentially the valence distribution , taken at one side of the bipartition , of a spanning tree in the bipartite graph naturally associated to @xmath5 .",
    "it is the use of this concept that sets apart the current paper from earlier work .    from @xmath4",
    ", we will read off the one - variable polynomial invariants @xmath6 and @xmath7 of @xmath5 which generalize @xmath8 and @xmath9 , respectively .",
    "they are called the interior and exterior polynomials .",
    "both have positive integer coefficients , the sum of which is the number of hypertrees .",
    "their definitions involve a direct , yet non - obvious generalization of tutte s idea of ordering the ( hyper)edges and using the order to define their internal and external activities with respect to ( hyper)trees . the hypertree polytope is naturally embedded as the set of bases in a certain integer polymatroid .",
    "the latter can be viewed as a generalization to hypergraphs of the cycle matroid of a graph .",
    "the interior and exterior polynomials can in fact be defined for all integer ( extended ) polymatroids , in other words for all integer - valued submodular set functions regardless of whether they are non - decreasing . in this paper",
    "we will merely mention this possibility as we intend to keep the focus on bipartite graphs and hypergraphs . as the counterpart of the planar duality relation",
    "@xmath10 we obtain the formula @xmath11 , where @xmath12 is a naturally associated dual to @xmath5 in cases when the hypergraph @xmath5 can be represented with a plane bipartite graph drawing .",
    "our invariants have another fundamental property which does not manifest itself in the classical case .",
    "namely , any hypergraph @xmath5 has an abstract dual @xmath13 that results from interchanging the roles of its vertices and hyperedges .",
    "for such a pair , we conjecture the identity @xmath14 .",
    "a weaker statement is that @xmath5 and @xmath13 have the same number of hypertrees .",
    "this was recently proven by alexander postnikov .",
    "indeed the discovery of @xmath4 ( and its dual relationship with @xmath15 ) should be attributed to him . in his beautiful paper @xcite",
    "he puts these polytopes in several important contexts .",
    "the polynomials @xmath6 and @xmath7 however seem to appear for the first time in this article .",
    "i read postnikov s work after most results presented here have been obtained . prior to that",
    "i was only able to prove that @xmath4 and @xmath15 had the same number of lattice points when @xmath5 was planar .",
    "this brings us to the second half of the paper .",
    "we will revisit a delicate picture that william tutte @xcite introduced before his discovery of the dichromate .",
    "it consists of three plane bipartite graphs that together triangulate the sphere @xmath16 .",
    "their planar duals are canonically directed so that a so - called arborescence number can be associated to each .",
    "tutte s tree trinity theorem states that in such a triple , the three arborescence numbers coincide .",
    "we will see that this value is also the number of hypertrees in any of the six hypergraphs found in tutte s picture .",
    "the six hypertree polytopes , for which we will derive a concise determinant formula based on work of kenneth berman , form three centrally symmetric pairs .",
    "the total number of interior and exterior polynomials associated to the six hypergraphs is reduced from @xmath17 to @xmath18 by our planar duality result , and the conjecture above on abstract duality implies that the number is in fact only @xmath19 .    the notions that we are",
    "about to introduce also have a strong connection to low - dimensional topology . indeed ,",
    "the results contained in this paper are by - products of the author s investigations in knot theory , especially of research done on the homfly polynomial .",
    "there is a well known method , called the median construction , that one may apply to a plane graph to get an alternating link diagram .",
    "when the graph is bipartite , the link has a natural orientation .",
    "the interior polynomial was originally developed to describe a pattern found in the homfly polynomials of these associated links .",
    "then in joint work with andrs juhsz and jacob rasmussen , we found a manifestation of the hypertree polytope in heegaard floer theory .",
    "but as the former of these two results remains a conjecture at the time of this writing , it feels prudent to save the exploration of topological aspects to future papers .    in another forthcoming paper ,",
    "joint with alex bene , we extend the theory of the hypertree polytope and interior and exterior polynomials to topological bipartite graphs and hypergraphs , in the same way that the bollobs ",
    "riordan polynomial generalizes the tutte polynomial for fatgraphs .",
    "the paper is organized as follows .",
    "section [ sec : prelim ] fixes terminology and recalls tutte s definition of the dichromate . in section [ sec : hyper ] , we introduce ( that is to say , recall from @xcite ) the hypertree polytope and in section [ sec : geometry ] we examine its basic geometry .",
    "after all this preparation , in section [ sec : poly ] we define interior and exterior polynomials .",
    "the material on polymatroids is found in subsections [ ssec : polymat ] and [ ssec : polypoly ] .",
    "section [ sec : prop ] establishes a variety of properties of the new invariants . in section [ sec : sejtes ] we state the main unsolved problem of the paper , the abstract duality conjecture , along with some supporting evidence .",
    "we discuss planar duality in section [ sec : dual ] .",
    "finally , section [ sec : trinity ] introduces trinities of plane bipartite graphs and some earlier work on them , and in section [ sec : moretrinity ] we lay out our new results on that subject .",
    "* acknowledgements . *",
    "part of the research reported here was completed while the author worked at the university of tokyo .",
    "my understanding of issues pertaining to the current paper has greatly benefited from discussions with my collaborators alex bene , andrs juhsz , and jake rasmussen .",
    "i also want to express my gratitude to lszl fehr , lszl lovsz , hitoshi murakami , richrd rimnyi , oliver riordan , gbor tardos , and vera vrtesi for stimulating discussions .",
    "last but not least , i thank pter juhsz for checking many examples by computer .",
    "we will use the standard notion of a _ graph _ as an ordered pair @xmath20 with finite vertex set @xmath21 and finite edge ( multi)set @xmath22 .",
    "loop edges and multiple edges are allowed . by @xmath23 being a _ subgraph _ of @xmath24 we will mean @xmath25 and @xmath26 ( thus subgraphs of a given graph are equivalent to their edge sets ) . for example , if a subgraph contains no edge adjacent to some vertex @xmath27 , then @xmath28 ( more precisely , @xmath29 ) is a connected component of the subgraph",
    ".    we will write @xmath30 for the graph that results from removing ( one copy of ) the edge @xmath31 from @xmath22 .",
    "( in below and in subsection [ ssec : delcontr ] this will also appear as @xmath32 . )",
    "the symbol @xmath33 will stand for the graph that remains after removing the vertex @xmath27 and all its adjacent edges from @xmath24 .",
    "graphs can be viewed as one - dimensional cell complexes and in that sense the _ nullity _ of a graph , @xmath34 , is the rank of its first homology group .",
    "( thus we may also refer to the nullity as the _ first betti number_. )      tutte s original construction @xcite of the two - variable polynomial @xmath3 , associated to the graph @xmath20 , proceeds as follows .",
    "order @xmath22 arbitrarily .",
    "consider the set @xmath35 of _ spanning trees _",
    ", that is connected and cycle - free subgraphs , for @xmath24 .",
    "( in order for @xmath35 to be non - empty , @xmath24 needs to be connected .",
    "this will almost always be assumed . )",
    "[ def : oldactive ] given a spanning tree @xmath36 , call an edge @xmath37 _ internally active _ with respect to @xmath38 if , after removing @xmath31 from @xmath38 , connectedness of the subgraph can not be restored by adding an edge to @xmath39 that is smaller than @xmath31 .",
    "an edge @xmath40 is _ externally active _ if , after adding @xmath31 to @xmath38 , cycle - freeness can not be restored by removing an edge from @xmath41 that is smaller than @xmath31 .",
    "in fact tutte put ` larger ' instead of ` smaller ' in both cases above .",
    "but as we will see in theorem [ thm : tutte ] below , reversing the order does not affect our main notion .",
    "[ def : tuttepoly ] let @xmath42 and @xmath43 denote the number of internally and externally active edges , respectively , with respect to @xmath38 ( under the given order ) .",
    "then , the _ tutte polynomial _ or _ dichromate _ of the graph @xmath24 is the generating function @xmath44    [ thm : tutte ] the polynomial @xmath3 is independent of the chosen edge order .",
    "a multitude of properties of @xmath3 is known .",
    "one of them is the deletion  contraction relation @xmath45 ( a bridge is an edge whose removal disconnects the graph .",
    "the contraction @xmath46 will be formally defined in subsection [ ssec : delcontr ] . ) for an excellent survey on why the tutte polynomial is central in graph theory , see @xcite .",
    "[ ex : egy ] we show a graph and its tutte polynomial .",
    ".04 in @xmath47{l@{\\hspace{2pt}}l@{\\hspace{2pt}}l@{\\hspace{2pt}}l@{\\hspace{2pt}}l@{\\hspace{2pt}}l@{\\hspace{2pt}}l } + y^3&&&&&&\\\\ + 3y^2&+3xy^2&&&&&\\\\ + 2y&+7xy&+6x^2y&+3x^3y&&&\\\\ & + 2x&+6x^2&+7x^3&+6x^4&+3x^5&+x^6 .",
    "\\end{array}\\ ] ]      for the purposes of this paper these structures are almost equivalent , as follows .",
    "a _ bipartite graph _ is a triple @xmath48 , where @xmath49 and @xmath50 are disjoint finite sets , called _ color classes _ , and @xmath22 is a finite set of edges , each connecting an element of @xmath49 to an element of @xmath50 ( multiple edges are not allowed ) .",
    "we will treat @xmath51 , @xmath52 , and the graph @xmath53 as the same object .    a _",
    "hypergraph _ is a pair @xmath54 , where @xmath21 is a finite set and @xmath22 is a finite multiset of non - empty subsets of @xmath21 .",
    "elements of @xmath21 are called _ vertices _ and the elements of @xmath22 are the _",
    "thus , hyperedges with multiplicity ( that is , several copies of the same subset of @xmath21 ) are allowed . on the other hand , obviously , each hyperedge contains each of its elements exactly once .",
    "a hypergraph is both a generalization and a special case of a graph .",
    "the first point is obvious .",
    "conversely , the sets @xmath21 and @xmath22 that constitute the hypergraph @xmath5 may be viewed as the color classes of a bipartite graph @xmath55 : we connect @xmath56 to @xmath57 with an edge if @xmath58 .",
    "we will refer to the result as the _ bipartite graph associated to the hypergraph _ @xmath5 .",
    "the construction of @xmath55 above is reversible if we specify one of the two color classes in the bipartite graph @xmath48 .",
    "we will use the notation @xmath59 for the resulting pair of hypergraphs .",
    "( the index of the hypergraph is chosen to emphasize its hyperedges . )",
    "note that @xmath60 .",
    "the bipartite graph @xmath24 above is said to _",
    "induce _ the hypergraphs @xmath61 and @xmath62 .",
    "two hypergraphs are called _ abstract duals _ if they can be obtained in the form . in other words , the abstract dual @xmath63 of a hypergraph @xmath54",
    "is defined by interchanging the roles of its vertices and hyperedges .",
    "to generalize the approach of subsection [ oldtutte ] to hypergraphs , first we need a notion corresponding to spanning trees . the rest of the paper is built around this concept , and almost all novelty",
    "contained herein stems from its use .",
    "[ def : hiperfa ] let @xmath54 be a hypergraph so that its associated bipartite graph @xmath55 is connected . by a _",
    "hypertree _ in @xmath5 we mean a function ( vector ) @xmath64 so that a spanning tree of @xmath55 can be found which has degree @xmath65 at each @xmath57 .",
    "such a spanning tree is said to _ realize _ or to _ induce _ @xmath66 .    if @xmath66 is a hypertree , then @xmath67 for each @xmath57 .",
    "the condition that @xmath55 be connected is not essential .",
    "we could talk about ` hyperforests ' realized by spanning forests but , partly to avoid such terminology , we will generally assume that the bipartite graphs associated to our hypergraphs are connected .",
    "[ rem : altalanosit ] hypertrees generalize spanning trees of graphs : there , an edge @xmath31 is in the tree if @xmath68 and not in the tree if @xmath69 . in our case , we allow hyperedges to be in hypertrees only `` partially . ''",
    "the number of realizations may vary greatly from hypertree to hypertree . however",
    "this phenomenon will not be incorporated to our theory in any way .",
    "for example , if @xmath66 is a hypertree and @xmath69 , then any edge of @xmath55 adjacent to the hyperedge @xmath31 can be chosen to be part of a realization of @xmath66 , irrespective of the rest of the construction .",
    "the next lemma claims only slightly more .",
    "[ lem : anchor ] let @xmath54 be a hypergraph and @xmath70 a hypertree . for any collection of edges @xmath71 of @xmath55",
    "so that @xmath71 is adjacent to @xmath31 for all @xmath57 , there is a realization of @xmath66 that contains @xmath71 for all @xmath31 .    start with an arbitrary realization @xmath38 of @xmath66 .",
    "if @xmath31 is such that @xmath72 , then add @xmath71 to @xmath38 .",
    "this creates a unique cycle in the subgraph which goes through @xmath31 .",
    "now if we remove the edge of the cycle that is adjacent to @xmath31 but different from @xmath71 , the result is another realization of @xmath66 .",
    "carry this process out at every hyperedge .",
    "it turns out that hypertrees are exactly the integer lattice points in a convex polytope .",
    "this fact was first realized by postnikov @xcite .",
    "but as the author discovered it independently and our points of view and proofs are different , we shall give a full account here .",
    "this will be followed by a sampling of postnikov s ideas , including a sketch of the proof of his duality theorem .    to describe the polytope , let @xmath26 be a non - empty subset of hyperedges and",
    "let @xmath73 denote the set of its neighbors in @xmath55 .",
    "let @xmath74 , the _ bipartite graph induced by @xmath75 _",
    ", be the graph with color classes @xmath75 and @xmath76 and edges inherited from @xmath55 .",
    "let us denote the number of its connected components by @xmath77 .",
    "[ thm : politop ] let @xmath54 be a hypergraph so that its associated bipartite graph @xmath55 is connected .",
    "the hypertrees @xmath70 of @xmath5 are exactly the integer solutions of the following system of linear inequalities in @xmath78 :    [ eq : hypertree ] @xmath79    [ rem:-1 ] we get an equivalent system of inequalities if we replace with @xmath80 , still required for all non - empty @xmath26 .",
    "this is because if @xmath74 is not connected , then its connected components are also of the form @xmath81 and we get the stronger version of the inequality by summing the inequalities associated to these smaller subsets @xmath82 .",
    "[ rem : nemnegkijon ] the conditions follow from and : this is obvious if @xmath83 and otherwise , with @xmath84 , we have @xmath85 where the right hand side is the sum of two non - negative quantities .",
    "the conditions are necessary because of the well known facts that    a.   [ a ] the number of edges in a spanning forest ( maximal cycle - free subgraph ) of a graph is the number of vertices minus the number of connected components of the graph and b.   [ b ] any cycle - free subgraph is part of a spanning forest .    indeed , for a given hypertree @xmath66 and non - empty subset @xmath26 , any spanning tree of @xmath55 that realizes @xmath66 has an intersection with @xmath74 which is a cycle - free subgraph of the latter .",
    "as such , it may have at most @xmath86 edges .",
    "since each of those has exactly one of its ends at an element of @xmath75 , we have @xmath87 which is just another form of .",
    "the claim is obvious and is immediate from above .    to see why is also sufficient ,",
    "let us formulate a lemma that is marginally stronger than what we currently need , but the form in which we state it will be useful later . recall that a graph has nullity zero if and only if it is cycle - free .",
    "[ lem : kormentes ] suppose that the integer vector @xmath70 satisfies conditions and ( including for @xmath88 ) but not necessarily .",
    "then there exists a cycle - free subgraph in @xmath55 that has valence @xmath65 at all elements @xmath57",
    ".    let the vector @xmath66 satisfy the conditions and choose an arbitrary subgraph @xmath89 of @xmath55 whose valence at each @xmath57 is @xmath65 .",
    "this is possible because applied to @xmath90 says @xmath91 .",
    "if @xmath89 is cycle - free , we are done .",
    "assume it is not .",
    "it suffices to show that there is another subgraph of @xmath55 that has the same valences at elements of @xmath22 as @xmath89 ( prescribed by @xmath66 ) but whose nullity is one less than that of @xmath89 .",
    "the subgraph @xmath89 has a connected component @xmath92 which contains a cycle .",
    "let @xmath92 intersect @xmath22 in the set @xmath75 . applying to @xmath75",
    "we see that there is a hyperedge @xmath93 which is connected by an edge @xmath94 of @xmath55 to a vertex which is not in @xmath92 .",
    "( otherwise , @xmath89 and @xmath74 would form a connected and not cycle - free intersection ; as such a subgraph contains a spanning tree of @xmath74 , we would get a contradiction between and . )",
    "now if @xmath31 is part of a cycle in @xmath92 , we are done because we may remove an edge of that cycle ( adjacent to @xmath31 ) and replace it with @xmath94 , whereby valences at hyperedges remain the same but the nullity reduces by one .",
    "otherwise , each edge of @xmath92 coming out of @xmath31 leads to a different connected component of @xmath95 .",
    "at least one of these ( call it @xmath96 ) still contains a cycle .",
    "replace one such edge with @xmath94 .",
    "this results in a subgraph @xmath97 that has the right valences and the same nullity as @xmath89 , but which has a non - tree component @xmath96 containing fewer elements of @xmath22 than @xmath92 did .",
    "repeat the procedure of this paragraph to @xmath97 and @xmath96 . after a finite number of iterations ,",
    "the desired reduction in the nullity will occur .",
    "this finishes the proof of the lemma .",
    "if we apply lemma [ lem : kormentes ] to a vector @xmath66 that satisfies , the resulting subgraph is not just cycle - free but because of it is actually a spanning tree .",
    "let @xmath5 be a hypergraph .",
    "the _ hypertree polytope _ of @xmath5 , denoted with @xmath4 , is the set of solutions in @xmath78 of the inequalities .    by theorem [ thm : politop ] , the set of hypertrees in @xmath5 can be written as @xmath98 .",
    "furthermore , @xmath4 is a lattice polytope , that is @xmath99 , where @xmath100 denotes the usual convex hull .",
    "the hypertree polytope generalizes the usual spanning tree polytope of a graph ( cf .",
    "remarks [ rem : altalanosit ] and [ rem:-1 ] ) .",
    "equation means that @xmath4 is part of an affine hyperplane in @xmath78 .",
    "thus , @xmath4 is situated in the lattice cut out from @xmath101 by the hyperplane .",
    "[ ex : ketto ] the graph used in example [ ex : egy ] is in fact bipartite . let us denote it with @xmath24 and label its color classes with @xmath102 and @xmath103 according to figure [ fig : betuzes ] .",
    "( 36,30 ) ( 8,9 ) ( 8,19 ) ( 18,4 ) ( 18,14 ) ( 18,24 ) ( 28,9 ) ( 28,19 ) ( 8,9)(0,1)10 ( 18,14)(0,1)10 ( 28,9)(0,1)10 ( 8,9)(2,1)10 ( 8,19)(2,1)10 ( 18,4)(2,1)10 ( 8,9)(2,-1)10 ( 18,14)(2,-1)10 ( 18,24)(2,-1)10 ( 17,10)@xmath104 ( 4,19)@xmath105 ( 17,0)@xmath106 ( 30,19)@xmath107 ( 17,26)@xmath108 ( 4,8)@xmath109 ( 30,8)@xmath110    there are @xmath111 spanning trees in @xmath24 .",
    "they give rise to seven hypertrees in @xmath61 , and the same number in @xmath62 , cf .",
    "theorem [ thm : post ] . these are shown , with a concrete spanning tree realizing each , in figure [ fig : ujfak ] .",
    "because of , it is natural to view the polytopes @xmath112 and @xmath113 in barycentric coordinate systems with basepoints labeled with @xmath114 and @xmath115 respectively . in figure",
    "[ fig : polytopes ] , we indicated individual hypertrees by dots and the two hypertree polytopes by thickened edges .",
    "@xmath116 at -10 15 @xmath117 at 340 15 @xmath118 at 160 270 @xmath119 at 575 290 @xmath120 at 455 75 @xmath121 at 710 -10 @xmath122 at 770 150     the hypertree polytope is of course a polytope , i.e. , convex , bounded , and closed . in particular",
    "it is closed under convex linear combinations . for its integer lattice points ,",
    "that is the hypertrees themselves , convexity translates to the following obvious ( from theorem [ thm : politop ] ) but useful property .",
    "[ lem : discreteconvex ] let @xmath123 be some set of hypertrees in the hypergraph @xmath54 and let @xmath124 be a function so that @xmath125 for all @xmath57 and @xmath126 . if it is also true that for all non - empty @xmath26 , there is an index @xmath127 so that @xmath128 , then @xmath129 is a hypertree .      in the terminology of @xcite ,",
    "a hypertree is a draconian sequence ( * ? ? ?",
    "* definition 9.2 ) and the hypertree polytope is a trimmed generalized permutohedron ( * ? ? ?",
    "* definition 11.2 ) .",
    "let us now summarize corollary 11.8 , theorem 12.9 , and some other surrounding statements from @xcite .    [ thm : post ] let @xmath48 be a connected bipartite graph with associated hypergraphs @xmath61 and @xmath62 as in .",
    "then @xmath130 .",
    "in other words , abstract dual hypergraphs have the same number of hypertrees .",
    "it turns out that @xmath112 and @xmath113 have even more in common .",
    "conjecture [ conj : dual ] below proposes a generalization of postnikov s theorem .    without going into the fine details of an elegant but complicated proof",
    ", we will quote some of postnikov s observations .",
    "of course , an equivalent statement is @xmath131 where @xmath54 is an arbitrary hypergraph and @xmath63 is its abstract dual .",
    "we will use this latter formulation . denote the standard generators of @xmath78 with @xmath132 , @xmath57 . recall that the _ minkowski sum _ of two subsets @xmath133 of a vector space is the set of vectors one can obtain as @xmath134 with @xmath135 and @xmath136 .",
    "the _ minkowski difference _",
    "@xmath137 is defined as the set of vectors @xmath138 so that @xmath139 .",
    "it can also be thought of as the set of all translates of @xmath140 that are contained in @xmath141 .",
    "see ( * ? ? ?",
    "* chapter 3 ) for a thorough introduction to these operations .",
    "next , let us quote ( * ? ? ?",
    "* lemma 11.7 ) .",
    "[ pro : felbont ] the hypertree polytope @xmath142 of the hypergraph @xmath54 can be written as @xmath143 where @xmath144 denotes the minkowski sum of the simplices @xmath145 , @xmath146 is the unit simplex and the right hand side is a minkowski difference .    of course , if we denote the standard basis for @xmath147 with @xmath148 , @xmath56 and define the simplices @xmath149 for all @xmath57 , as well as @xmath150 , then @xmath151    the minkowski sums ( in postnikov s terminology , the ( untrimmed ) generalized permutohedra ) @xmath152 are related through the so - called root polytope @xmath153 ( an @xmath154-dimensional polytope whose vertices are indexed by the edges of @xmath55 ) as described below .",
    "[ pro : csel ] if we define the affine subspaces @xmath155 and @xmath156 of @xmath157 as @xmath158 where @xmath159 and @xmath160 are the projections , then , up to translation , @xmath161    studying triangulations of @xmath162 , postnikov observes that a set of vertices of @xmath162 is affinely independent if and only if the corresponding edges form a forest in @xmath55 .",
    "the simplices @xmath163 that arise this way from spanning trees @xmath38 have the same volume .",
    "most importantly , if we form the intersections @xmath164 and @xmath165 and identify them with subsets of @xmath166 and @xmath167 , respectively , as described in proposition [ pro : csel ] , then those subsets contain unique translates of @xmath168 and @xmath169 , respectively , by integer vectors .",
    "( also , they are essentially disjoint from other integer translates of those unit simplices . )",
    "in fact , those integer vectors are the two hypertrees induced by @xmath38 .",
    "thus postnikov finds that any triangulation of @xmath162 gives a bijection between the integer lattice points of the minkowski differences which are the hypertree polytopes .",
    "we also see that the volume of the root polytope associated to a bipartite graph is proportional to the number of hypertrees in each of its induced hypergraphs .",
    "it turns out that for our central concepts , namely the interior and exterior polynomials which will be introduced in the next section , the right level of generality is that of a polymatroid",
    ". moreover , basic submodular function techniques will be useful to simplify our arguments , most notably the proof that our polynomials are well defined , even in the hypergraph case .",
    "we will recall some elements of this theory here , using ( * ? ? ?",
    "* volume b , chapter 44 ) as basic reference .",
    "let @xmath170 be a finite ground set and @xmath171 a set function , i.e. , a function defined on all subsets of @xmath170 .",
    "we say that @xmath172 is _ submodular _ if @xmath173 holds for all subsets @xmath174 of @xmath170 .",
    "the set function @xmath172 is called _ non - decreasing _ if @xmath175 implies @xmath176 .    for an arbitrary set function @xmath177",
    ", we define the polyhedra @xmath178 here @xmath179 means that all entries in @xmath180 are non - negative and @xmath181 is the indicator function of the subset @xmath182 so that the dot product @xmath183 becomes the sum of entries in @xmath180 corresponding to elements of @xmath182 .",
    "if @xmath171 is a submodular set function , then @xmath184 and @xmath185 are called the _ polymatroid _ and _ extended polymatroid _ , respectively , of @xmath172 .",
    "a vector @xmath186 is called a _ base _ if @xmath187 .",
    "we denote the set of bases with @xmath188 and call it the _ base polytope_.    the notions of submodular set function and extended polymatroid are essentially equivalent as described in ( * ? ? ?",
    "* section 44.4 ) . by the same token , non - decreasing submodular set functions are equivalent to polymatroids .",
    "integer - valued submodular functions correspond to ( extended ) polymatroids that are _ integer _ , meaning that they are the convex hulls of their integer lattice points . as to bases",
    ", we note    [ lem : nincstobbbazis ] if @xmath172 is submodular and non - decreasing , then we have @xmath189 .",
    "let @xmath180 be a base , @xmath190 , and @xmath191 .",
    "then the @xmath107-component of @xmath180 is @xmath192 .",
    "the following definition expresses a basic property of polymatroids that will have an important role in our treatment .",
    "[ def : tight ] let @xmath177 be a set function and @xmath193 .",
    "we say that the subset @xmath194 is _ tight _ at @xmath180 if @xmath195 .",
    "the set function @xmath196 is called _ tight _ if for all @xmath193 , the set of subsets that are tight at @xmath180 is closed under taking unions and intersections .",
    "[ pro : szoros ] submodular set functions are tight .",
    "our next claim is on certain @xmath19-dimensional intersections of the base polytope @xmath188 .",
    "[ lem : teglalap ] let @xmath171 be a submodular set function and let @xmath105 , @xmath104 , @xmath106 , and @xmath107 be distinct elements of @xmath170 .",
    "other than these four , give some fixed values to all components and denote the resulting subset of @xmath188 with @xmath197 .",
    "then , assuming @xmath198 , the face of @xmath197 along which the sum of the @xmath199 and @xmath200 components takes its maximum is a ( possibly degenerate ) rectangle with sides parallel to the vectors @xmath201 and @xmath202 .",
    "the set @xmath197 is cut out of the appropriate @xmath19-dimensional affine subspace @xmath141 as the intersection of fourteen half - spaces corresponding to the non - trivial subsets of @xmath203 .",
    "six of these have the normal vectors @xmath204 and so on so that their intersection is a ( possibly degenerate ) cuboid @xmath92 ; see figure [ fig : muszaki ] .",
    "the other eight half - spaces have normal vectors such as @xmath205 and they cut off pieces of @xmath92 near its vertices . our task is to show that in @xmath197 there can not remain a segment of positive length from any edge of @xmath92 .",
    "@xmath122 at 530 1130 @xmath119 at -20 980 @xmath120 at 290 660 @xmath121 at 255 810 @xmath180 at 1130 990   that lies in the affine subspace @xmath141 .",
    "if @xmath206 denotes @xmath207 minus the sum of the fixed components then , writing them in the order @xmath208 , the other four components of the points shown are @xmath209 and so on .",
    "upper right : the cuboid @xmath92 with the normal vectors of its faces .",
    "bottom : the polytope @xmath210 and the direction vectors of two of its edges.,title=\"fig:\",width=384 ]    if the opposite was the case and , for instance , such an interior point @xmath180 remained on , say , the edge of @xmath92 that we thickened in figure [ fig : muszaki ] , then @xmath180 would be a base in @xmath188 at which the sets @xmath211 and @xmath212 are tight but neither their union @xmath213 nor their intersection @xmath214 is tight . as this is impossible , we see that the correct form of @xmath197 is as shown in the lower panel of figure [ fig : muszaki ] .",
    "submodular functions are relevant in this paper due to the following fact , pointed out to the author by lszl lovsz .",
    "[ pro : submodular ] let @xmath54 be a hypergraph .",
    "the function @xmath215 of theorem [ thm : politop ] , extended to the empty set as @xmath216 , is non - decreasing and submodular on the set @xmath22 of hyperedges .",
    "we leave the proof of the first assertion to the reader . as to the second , according to ( * ? ? ?",
    "* theorem 44.1 ) , it suffices to prove @xmath217 for all @xmath26 and distinct @xmath218 .",
    "assume that from the connected components of @xmath74 , the number of those that are connected to both @xmath219 and @xmath220 is @xmath221 .",
    "aside from these , let @xmath222 , @xmath223 be connected to another @xmath224 components of @xmath74 . furthermore",
    ", let us denote the number of such common elements of @xmath219 and @xmath220 that are not in @xmath76 with @xmath225 and assume that other than these , @xmath222 contains @xmath226 non - elements of @xmath76",
    ". then we have @xmath227 whereas the right hand side of is @xmath228 the required inequality holds in all cases ( with equality if and only if @xmath229 or one of the two is @xmath230 and the other @xmath231 ) .",
    "[ def : ph ] the _ polymatroid of the hypergraph _",
    "@xmath5 is the polymatroid @xmath232 associated to the non - decreasing submodular set function @xmath172 of equation .",
    "the next proposition is just a reformulation of theorem [ thm : politop ] and lemma [ lem : kormentes ] which was used in its proof .",
    "the integer lattice points in the polymatroid @xmath233 of the hypergraph @xmath5 are exactly the functions @xmath70 so that @xmath55 has a cycle - free subgraph with valence @xmath65 at each @xmath57 .",
    "the hypertree polytope @xmath4 coincides with the base polytope of @xmath233 .",
    "each graph has a so - called cycle matroid .",
    "this is a classical construction that goes back to the very beginning of matroid theory .",
    "the rank function of any matroid is submodular and therefore defines a polymatroid .",
    "( in fact , one way to define a matroid is as a polymatroid associated to a non - negative integer - valued , non - decreasing submodular set function that assigns @xmath231 to @xmath234 and @xmath231 or @xmath230 to singleton sets . )",
    "thus every graph has a natural polymatroid associated to it , and definition [ def : ph ] generalizes this association to hypergraphs .",
    "we are going to need the following elementary observations later .",
    "[ lem : erdo ] let the spanning tree @xmath235 induce the hypertree @xmath70 .",
    "the inequality is sharp for @xmath26 if and only if @xmath236 is a spanning forest in the latter .",
    "given such a @xmath38 and @xmath75 , if we remove @xmath236 from @xmath38 and replace it with another spanning forest @xmath237 of @xmath74 , then the result @xmath238 is another spanning tree of @xmath55 .",
    "it realizes a hypertree which agrees with @xmath66 on the set @xmath239 .",
    "the first assertion is trivial from the proof of theorem [ thm : politop ] . for the second ,",
    "notice that paths in @xmath38 and @xmath238 are in a one - to - one correspondence , as follows .",
    "any path @xmath240 has maximal segments that fall within @xmath74 and obviously each such segment is in one connected component of @xmath74 .",
    "hence , we get a new path @xmath241 by replacing each segment with the unique connection that exists between its endpoints in @xmath237 .",
    "this correspondence of paths has an inverse constructed in the analogous way .",
    "as @xmath242 and @xmath243 share the same endpoints , we see that @xmath238 is connected and cycle - free .",
    "the final claim of the lemma is of course just stating the obvious .",
    "now suppose that the set @xmath22 of hyperedges in @xmath244 has been ordered and labeled so that @xmath245 think of @xmath5 ( and of @xmath55 ) as being built step - by - step by adding one hyperedge at a time in the prescribed order .",
    "we will use the notation @xmath246 for the bipartite graphs of the intermediate stages . in each step , the nullity of the graph may go up .",
    "we record this by introducing the _ nullity - jump function _ of the chosen order , @xmath247 where @xmath248 .",
    "obviously , @xmath249 for all @xmath31 and @xmath250 .",
    "[ lem : moho ] for any order of the hyperedges , the vector @xmath251 is a hypertree .",
    "it is the unique hypertree that makes the inequality true with an equality sign for all subsets @xmath252 , @xmath248 .    using the order , it is easy to construct a spanning tree that realizes @xmath129 .",
    "the @xmath199th stage of the construction will be a spanning forest @xmath253 of the bipartite graph @xmath254 .",
    "all edges of @xmath55 that are adjacent to @xmath219 will be part of @xmath255 ( note that @xmath256 ) .",
    "suppose that a forest @xmath257 , with the valences @xmath258 at @xmath259 , respectively , has been defined .",
    "the graph @xmath260 consists of @xmath261 and some isolated points .",
    "suppose that @xmath262 is joined by an edge to @xmath108 of its connected components .",
    "it is easy to see that @xmath263 , since the ` first edge ' of @xmath254 to connect @xmath262 to one of the @xmath108 components does not increase the nullity , whereas all others after the first increase it by @xmath230 .",
    "we define @xmath253 by adding to @xmath264 a collection of @xmath265 edges , all adjacent to @xmath262 and leading to different components of @xmath260 .",
    "this is a spanning forest of @xmath254 .",
    "after the last stage , @xmath266 is a spanning tree of @xmath267 which realizes @xmath129 .    from the fact that @xmath253 is a spanning forest of @xmath254 and the first claim in lemma [ lem : erdo ] it is immediate that is sharp for @xmath129 and each set @xmath268 .",
    "no other hypertree can have that property for the simple reason that @xmath269 is uniquely determined as the difference of two consecutive right - hand sides .",
    "the greedy algorithm offers another way of defining the hypertree @xmath129 of the previous lemma : if for all @xmath270 , we choose @xmath271 to be the maximal value so that the valences @xmath272 , @xmath273 , can be realized by a cycle - free subgraph of @xmath254 , then it can be shown that @xmath274",
    ".    we will also refer to the hypertree of lemma [ lem : moho ] as the _ greedy hypertree _ of the given order",
    ". the next definition will be fundamental in the next section .",
    "[ def : transfer ] let @xmath54 be a hypergraph , @xmath70 a hypertree and @xmath275 hyperedges .",
    "we say that _",
    "@xmath66 is such that a transfer of valence is possible _ from @xmath109 to @xmath110 if the function obtained from @xmath66 by reducing @xmath276 by @xmath230 and increasing @xmath277 by @xmath230 is also a hypertree .",
    "[ cor : nemeles ] for any non - empty collection @xmath26 of hyperedges , there exists a hypertree @xmath70 so that is sharp for @xmath66 and @xmath75 . if @xmath75 and @xmath66 are so that is not sharp , then @xmath66 is such that it is possible to transfer valence from some element of @xmath239 to some element of @xmath75",
    ".    choose any order in which the elements of @xmath75 are the smallest and construct its greedy hypertree @xmath124 .",
    "by lemma [ lem : moho ] , @xmath129 has the required property .",
    "to prove the second claim , we construct an indirect argument using propositions [ pro : submodular ] and [ pro : szoros ] .",
    "let @xmath66 be a hypertree and @xmath26 a subset so that no transfer of valence is possible from any element of @xmath239 to any element of @xmath75 .",
    "by theorem [ thm : politop ] , this implies that for any @xmath278 and @xmath279 , there exists a subset @xmath280 of hyperedges so that with the set function @xmath172 of , we have @xmath281 in other words , @xmath282 is tight at @xmath66 .",
    "then so is @xmath283 , i.e. , is sharp for @xmath75 and @xmath66 .",
    "[ lem : mohofelett ] let @xmath54 be a hypergraph with its hyperedges ordered as above .",
    "let @xmath70 be a hypertree and @xmath57 a hyperedge so that @xmath284 , where @xmath129 is the greedy hypertree of the order . then there exists a hyperedge @xmath285 so that @xmath66 is such that a transfer of valence is possible from @xmath31 to @xmath138 .",
    "assume the contrary .",
    "then for all @xmath285 , there exists a set @xmath286 of hyperedges that is tight at @xmath66 , contains @xmath138 , and does not contain @xmath31 .",
    "let @xmath287 .",
    "then we have @xmath288 and @xmath289 while , by proposition [ pro : szoros ] , @xmath182 is also tight at @xmath66 .",
    "now define a new order @xmath290 on @xmath22 by letting the elements of @xmath182 be smallest while keeping the original order among them .",
    "( it does not matter how the rest of @xmath22 gets ordered . )",
    "let @xmath291 be the greedy hypertree of @xmath290 .",
    "by lemma [ lem : moho ] , it is such that both @xmath292 and @xmath182 are tight at @xmath291 .",
    "fix realizations @xmath293 of @xmath291 and @xmath38 of @xmath66 . by lemma [ lem : erdo ] , these are such that both @xmath294 and @xmath295 are spanning forests in @xmath296 .",
    "if in @xmath38 we replace the former with the latter , the result , again by lemma [ lem : erdo ] , is a spanning tree in @xmath55 .",
    "now for the hypertree @xmath297 realized by this spanning tree we have @xmath298 which contradicts theorem [ thm : politop ] .",
    "let @xmath54 be a hypergraph so that @xmath55 is connected .",
    "just as in subsection [ oldtutte ] , we order the set @xmath22 arbitrarily . with regard to a fixed hypertree @xmath66",
    ", we make the following definitions .",
    "[ def : activity ] a hyperedge @xmath57 is _ internally active _ with respect to the hypertree @xmath66 if it is not possible to decrease @xmath299 by @xmath230 and increase @xmath66 of a hyperedge smaller than @xmath31 by @xmath230 so that another hypertree results .",
    "a hyperedge @xmath57 is _ externally active _ with respect to @xmath66 if it is not possible to increase @xmath299 by @xmath230 and to decrease @xmath66 of a smaller hyperedge by @xmath230 so that another hypertree results .",
    "recall that in definition [ def : transfer ] the operation on hypertrees used above was termed a transfer of valence .",
    "for example , a hyperedge is internally active with respect to a hypertree if it can not transfer valence to smaller hyperedges , and it is externally active if valence can not be transferred to it from smaller hyperedges . regarding transfers of valence",
    ", we will need the following lemma later .",
    "[ lem : rombusz ] let @xmath109 , @xmath110 , and @xmath108 be hyperedges in @xmath54 and @xmath66 such a hypertree that @xmath109 can transfer valence to @xmath110 and @xmath110 can transfer valence to @xmath108 . then @xmath66 is also such that @xmath109 can transfer valence to @xmath108 .",
    "in other words , regarding the rhombus of figure [ fig : rombusz ] ( explained below ) , if the three lattice points indicated by full dots are hypertrees then so is the one represented by the hollow dot .",
    "this is immediate from lemma [ lem : discreteconvex ] but we think it worthwile to examine the picture . in @xmath78 , the three - dimensional affine subspace through @xmath66 spanned by @xmath300 forms a two - dimensional intersection @xmath301 with @xmath4 .",
    "the triangle we labelled with @xmath302 in figure [ fig : rombusz ] is in fact spanned by the vectors whose @xmath303 , @xmath304 , and @xmath305-components are equal to @xmath306 , @xmath307 , and @xmath308 , respectively , whereas their other components are identical to those of @xmath66 .    .8pt",
    "( 180,160 ) ( 10,10)(1,0)160 ( 10,10)(3,5)80 ( 170,10)(-3,5)80 ( 80,30 ) ( 62,60 ) ( 116,30 ) ( 98,60 ) ( 80,30)(1,0)36 ( 80,30)(-3,5)18 ( 80,30)(3,5)16 ( 2,5)@xmath109 ( 173,5)@xmath110 ( 87,148)@xmath108 ( 66,26)@xmath66 ( 121,26)@xmath309 ( 46,60)@xmath310 ( 103,60)@xmath311    the conditions in the lemma are that @xmath66 , @xmath309 , and @xmath310 are in @xmath4 and the conclusion is that @xmath311 is , too . now this is obvious from the fact ( theorem [ thm : politop ] ) that @xmath301 is cut out from the plane by lines parallel to the sides of the triangle .",
    "it is easy to see that the notions of definition [ def : activity ] generalize the ones found in definition [ def : oldactive ]",
    ". it will be slightly more convenient for us to work with their negations in what follows .",
    "let @xmath54 be a hypergraph so that @xmath55 is connected .",
    "with respect to a given hypertree @xmath70 and some order of the hyperedges , let the number of internally inactive hyperedges of @xmath5 be denoted with @xmath312 and the number of externally inactive hyperedges be denoted with @xmath313 .",
    "then , let the _",
    "internal polynomial _ and the _ external polynomial _ of @xmath54 be defined as @xmath314 respectively , where both summations are over all hypertrees @xmath66 in @xmath5 .",
    "these notions generalize the valuations @xmath315 respectively , of the classical tutte polynomial @xmath316 of the graph @xmath20 .",
    "there are two ways of treating hypergraphs whose associated bipartite graphs are disconnected .",
    "one is to assign to them the product of the polynomials associated to their connected components . the other is to extend the definition verbatim , which results in the value @xmath231 for both polynomials",
    "because a disconnected graph has no spanning trees and therefore the set of hypertrees is empty . in this paper",
    "we take the latter approach .",
    "this will hardly matter since we almost always assume @xmath55 to be connected .",
    "our first order of business , however , is to address well definedness .",
    "[ thm : independent ] the formulas for the internal and external polynomials do not depend on the chosen order of the hyperedges .",
    "we will need to following statement .",
    "[ lem : nyil ] let @xmath317 be hyperedges in the hypergraph @xmath54 and let @xmath318 . fix a function @xmath319 and consider its extensions to @xmath22 that are hypertrees in @xmath5 . among these , let @xmath309 and @xmath310 be such that @xmath320 and let also @xmath321 be a hyperedge .    1 .",
    "if @xmath309 is such that valence can be transferred from @xmath219 to @xmath138 then @xmath310 is such that valence can be transferred from @xmath220 to @xmath138 .",
    "if @xmath309 is such that valence can be transferred from @xmath138 to @xmath220 then @xmath310 is such that valence can be transferred from @xmath138 to @xmath219 .    in other words ,",
    "regarding both ` staples ' of figure [ fig : nyil ] , if the three lattice points indicated by full dots are hypertrees then so is the one represented by the hollow dot .",
    "the argument is very similar to the proof of lemma [ lem : rombusz ] . examining figure [ fig : nyil ] ,",
    "it is easy to see that if @xmath309 , @xmath310 , and @xmath322 satisfy all constraints of theorem [ thm : politop ] , then so does @xmath323 . likewise , if @xmath309 , @xmath310 , and @xmath324 are in @xmath4 then so is @xmath325 .    .8pt    ( 393,160 ) ( 10,10)(1,0)160 ( 10,10)(3,5)80 ( 170,10)(-3,5)80 ( 0,5)@xmath138 ( 173,5)@xmath219 ( 85,148)@xmath220 ( 110,26)@xmath309 ( 68,98)@xmath310 ( 55,26)@xmath322 ( 58,56)@xmath323 ( 230,10)(1,0)160 ( 230,10)(3,5)80 ( 390,10)(-3,5)80 ( 220,5)@xmath138 ( 393,5)@xmath219 ( 305,148)@xmath220 ( 330,26)@xmath309 ( 288,98)@xmath310 ( 348,56)@xmath324 ( 322,98)@xmath325 ( 70,90)(3,-5)36 ( 70,90)(-3,-5)16 ( 106,30)(-1,0)36 ( 70,90 ) ( 106,30 ) ( 70,30 ) ( 52,60 ) ( 290,90)(3,-5)36 ( 290,90)(1,0)33 ( 326,30)(3,5)18 ( 290,90 ) ( 326,30 ) ( 344,60 ) ( 326,90 )    we will emulate tutte s original proof , i.e. , analyze the effect of changing the relative position in the order of two adjacent hyperedges . let @xmath275 and assume that @xmath326 is an order on @xmath22 so that @xmath327 with no other hyperedge in between , whereas the order @xmath328 only differs from @xmath326 in that @xmath329 . the rest of the hyperedges are partitioned in two sets so that in both orders , elements of @xmath330 are smaller than @xmath109 and @xmath110 while elements of @xmath331 are larger than both .",
    "let @xmath70 be a hypertree .",
    "our goal is to compare the values @xmath332 and @xmath333 ( as well as @xmath334 and @xmath335 ) resulting from the two orders .",
    "if a hyperedge differs from both @xmath109 and @xmath110 , then it is easy to check that ( in the internal as well as in the external sense ) it is active with respect to @xmath66 in @xmath326 if and only if the same holds in @xmath328 .",
    "let us now separate three cases .",
    "a.   [ case1 ] if @xmath66 is such that no transfer of valence is possible between @xmath109 and @xmath110 , then the activity statuses of @xmath109 and @xmath110 are also unaffected by the change in the order .",
    "hence in such cases @xmath336 and @xmath337 . b.   [ case2 ] next , assume that @xmath66 is such that valence can be transferred between @xmath109 and @xmath110 in both directions .",
    "then in the order @xmath326 the hyperedge @xmath110 is not active whereas with respect to @xmath328 , the hyperedge @xmath109 is not active .",
    "( this holds in both the internal and external senses . )",
    "now according to lemma [ lem : rombusz ] , if @xmath109 is not active in @xmath326 ( i.e. , there is some @xmath338 so that valence can be transferred from @xmath109 to @xmath138 ( internal case ) or from @xmath138 to @xmath109 ( external case ) ) , then @xmath110 is not active in @xmath328 and vice versa",
    ". therefore we again have @xmath336 and @xmath337 . c.   [ case3 ]",
    "lastly , let @xmath66 be such that valence can be transferred between @xmath109 and @xmath110 but only in one direction . before analyzing activities ,",
    "let us establish that these kinds of hypertrees are partitioned into pairs .",
    "indeed , the line @xmath339 intersects the polytope @xmath4 in a segment and another lattice point @xmath340 . this can be shown using a property of polymatroids called total dual integrality .",
    "however we will not need this presently . ] . among the lattice points of the segment",
    ", @xmath66 represents one extreme ; let the other extreme be denoted with @xmath340 .",
    "this is necessarily different from @xmath66 by our assumption and if a transfer of valence is possible only from @xmath109 to @xmath110 ( and not in the other direction ) at one of @xmath66 and @xmath340 , then the opposite transfer ( and only that ) is possible at the other one .",
    "it is also clear that @xmath341 , so we get the desired pairs .",
    "( the lattice points between @xmath66 and @xmath340 were discussed in case [ case2 ] , whereas case [ case1 ] is when the segment degenerates to a point . )",
    "+ without loss of generality we may assume that @xmath66 is such that @xmath109 can transfer valence to @xmath110 and the opposite transfer is possible at @xmath340 .",
    "let us first examine the hyperedges @xmath109 and @xmath110 themselves .",
    "we will start with their internal activities . 1 .",
    "assume that @xmath336 .",
    "we will show that in this case @xmath342 holds , too . as the activity status of @xmath110 with respect to @xmath66 is the same in @xmath326 as in @xmath328 , a similar property has to hold for @xmath109 . because @xmath109 is not active with respect to @xmath66 in @xmath328 , this is only possible if there exists a hyperedge @xmath338 so that @xmath66 is such that valence can be transferred from @xmath109 to @xmath138 . by lemma [ lem : nyil ]",
    ", this implies that @xmath110 is inactive with respect to @xmath340 in both @xmath326 and @xmath328 . whether @xmath109 is active with respect to @xmath340 depends on the same thing in both orders : namely , on whether @xmath340 is such that valence can be transferred from @xmath109 to some element @xmath343 .",
    "[ bbb ] the only way @xmath332 and @xmath333 can be different is if @xmath66 is such that @xmath109 can not transfer valence to any element of @xmath330 . in such cases",
    "@xmath110 has the same property by lemma [ lem : rombusz ] so that @xmath344 ( @xmath110 is active with respect to @xmath66 in both orders and @xmath109 is active only in @xmath326 ) .",
    "examining @xmath340 now , by lemma [ lem : nyil ] we see that it has to be such that @xmath110 can not transfer valence to any element of @xmath330 .",
    "this implies , using lemma [ lem : rombusz ] , that @xmath109 has the same property .",
    "therefore we have @xmath345 as @xmath109 is active with respect to @xmath340 in both orders and @xmath110 is active in @xmath328 only .",
    "+ external activities can be handled in almost the same way . 1 .   if @xmath337 , then ( since the activity status of @xmath109 with respect to @xmath66 is independent of order ) there must be some @xmath338 so that valence can be transferred from @xmath138 to @xmath110 .",
    "then by lemma [ lem : nyil ] , @xmath340 is such that valence can be transferred from @xmath138 to @xmath109 , making @xmath109 inactive with respect to @xmath340 in both orders . since the activity status of @xmath110 with respect to @xmath340 is the same in both orders , we obtain @xmath346 .",
    "[ bbbb ] if @xmath347 , that is if @xmath66 is such that no @xmath338 can transfer valence to @xmath110 , then the same holds for transfers of valence from @xmath138 to @xmath109 by lemma [ lem : rombusz ] .",
    "therefore @xmath109 is active with respect to @xmath66 in both orders , whereas @xmath110 is active in @xmath328 and inactive in @xmath326 . by the preceding paragraph",
    ", a similar analysis has to apply to @xmath340 , i.e. , @xmath110 is active with respect to @xmath340 in both orders , whereas @xmath109 is active in @xmath326 and inactive in @xmath328 .",
    "so we have obtained @xmath348 and @xmath349 .",
    "the only hypertrees whose @xmath350 or @xmath351 values actually changed as a result of switching from @xmath326 to @xmath328 were described in the cases ( b ) and ( b ) above .",
    "we saw that they occur in pairs of the form @xmath352 . now to complete our proof it suffices to show that for such a pair and any hyperedge @xmath353 different from @xmath109 and @xmath110 , the activity status of @xmath353 with respect to @xmath66 is the same as with respect to @xmath340 .",
    "( we saw that the choice between @xmath326 and @xmath328 does not matter for @xmath353 , only for @xmath109 and @xmath110 . switching to a new hypertree , on the other hand ,",
    "could in principle make a big difference . ) indeed , that will imply @xmath354 and @xmath355 in case ( b ) , as well as @xmath356 and @xmath357 in case ( b ) so that , regardless of order , the generating functions @xmath6 and @xmath7 always encode the same information .",
    "as we are about to relate activities with respect to different hypertrees , this last part of the proof is where we will rely most heavily on our assumptions .",
    "what we need is essentially lemma [ lem : teglalap ] but we chose to spell the argument out without an explicit reference to it .",
    "it will be convenient to branch out into several cases again .    1",
    ".   we will deal with internal activities first .",
    "recall that we are under the assumptions of the case [ case3](b ) , in particular @xmath66 and @xmath340 are such that neither @xmath109 nor @xmath110 can transfer valence to any element of @xmath330 .",
    "let @xmath353 be a hyperedge which is internally inactive with respect to @xmath66 .",
    "our goal is to show that @xmath353 is also internally inactive with respect to @xmath340 .",
    "a.   assume @xmath358 .",
    "if @xmath66 is such that @xmath353 can transfer valence to @xmath109 or @xmath110 , then lemma [ lem : rombusz ] implies that it can definitely transfer to @xmath110 and then lemma [ lem : nyil ] says that @xmath340 is such that @xmath353 can transfer valence to @xmath109 .",
    "therefore @xmath353 is inactive with respect to @xmath340 .",
    "+ if @xmath358 but @xmath66 is such that @xmath353 can not transfer valence to @xmath109 or @xmath110 , then @xmath340 has to have the same property by the usual combination of lemmas [ lem : rombusz ] and [ lem : nyil ] . because @xmath353 is inactive with respect to @xmath66",
    ", the hypertree @xmath66 must be such that @xmath353 can transfer valence to some @xmath359 with @xmath360 .",
    "we will show that @xmath340 is also such that @xmath353 can transfer valence to @xmath138 .",
    "suppose the opposite is true .",
    "then there are sets of hyperedges @xmath361 , @xmath362 , and @xmath363 so that all three are tight at @xmath340 and neither contains @xmath353 .",
    "( here tightness is in the sense of definition [ def : tight ] with regards the set function @xmath172 of proposition [ pro : submodular ] . ) by proposition [ pro : szoros ] , the union of the three subsets is also tight at @xmath340 .",
    "since the union contains both @xmath109 and @xmath110 , the sum of the @xmath340-values over it agrees with the sum of the @xmath66-values .",
    "therefore @xmath364 is also tight at @xmath66 , which contradicts our assumption that @xmath66 is such that @xmath353 ( which is not in the union ) can transfer valence to @xmath138 ( which is ) .",
    "b.   let now @xmath343 .",
    "then of course there is a hyperedge @xmath338 so that @xmath66 is such that @xmath353 can transfer valence to @xmath138 .",
    "we will show that @xmath340 is also such that @xmath353 can transfer valence to @xmath138 . assuming the contrary",
    ", we find sets of hyperedges @xmath365 , @xmath366 , and @xmath367 which are tight at @xmath340 and all contain @xmath138 .",
    "their intersection is also tight at @xmath340 by proposition [ pro : szoros ] . as @xmath368 contains neither @xmath109 nor @xmath110 , it is also tight at @xmath66 .",
    "but that is a contradiction with the transfer of valence from @xmath369 to @xmath370 which is possible at @xmath66 .",
    "2 .   in the external case , the assumptions of [ case3](b ) were that @xmath66 and @xmath340 are both such that no transfer of valence is possible from elements of @xmath330 to @xmath109 or to @xmath110 .",
    "in such a situation , let @xmath353 be externally inactive with respect to @xmath66 .",
    "we wish to prove that @xmath353 is also externally inactive with respect to @xmath340 .",
    "if @xmath358 , then it may be that @xmath66 is such that @xmath109 or @xmath110 can transfer valence to @xmath353 .",
    "if @xmath110 can , then so can @xmath109 by lemma [ lem : rombusz ] .",
    "thus in either case we can apply lemma [ lem : nyil ] to conclude that @xmath340 is such that @xmath110 can transfer valence to @xmath353 .",
    "+ suppose now that @xmath358 but @xmath66 ( and consequently @xmath340 ) is such that neither @xmath109 nor @xmath110 can transfer valence to @xmath353 .",
    "then some other hyperedge @xmath359 can and we will prove that the same transfer is also possible at @xmath340 . if not , then there are sets of hyperedges @xmath366 , @xmath367 , and @xmath371 , all containing @xmath353 , that are tight at @xmath340",
    ". then their intersection has the same property by proposition [ pro : szoros ] and furthermore , as it contains neither @xmath109 nor @xmath110 , it is tight at @xmath66 as well .",
    "that contradicts the assumption that at @xmath66 , a transfer of valence is possible from outside of the set ( from @xmath138 ) to one of its elements ( namely @xmath353 ) .",
    "2 .   assuming @xmath343 , it being externally inactive implies the existence of another hyperedge @xmath338 so that @xmath66 is such that @xmath138 can transfer valence to @xmath353 .",
    "if the same transfer is not possible at @xmath340 , that means that there are sets of hyperedges @xmath372 , @xmath361 , and @xmath362 that are tight at @xmath340 and none of them contains @xmath138",
    ". then their union has the same properties and it is also tight at @xmath66 , which yields the usual contradiction .",
    "this completes the proof .",
    "[ ex : harom ] we revisit the hypertrees that were discussed in example [ ex : ketto ] .",
    "they are shown in figure [ fig : ujfak ] with an actual spanning tree realization for each .",
    "for the particular orders @xmath373 and @xmath374 , respectively , we also indicated the internal and external activity status of each hyperedge with respect to each hypertree , as well as the resulting @xmath375 values . thus , we find that @xmath376 whereas @xmath377 these values are in line with propositions [ pro : const ] and [ pro : rang ] below , as well as with conjecture [ conj : dual ] .    up to isomorphism there is only one order on the three - element set @xmath49 .",
    "the four - element set @xmath50 , on the other hand , has four essentially different orders depending on the position of @xmath104 .",
    "the reader may check that the other three give rise to the same interior and exterior polynomials as in .    note the lack of similarity between our polynomials and the one shown in example [ ex : egy ] .",
    "indeed , the author is not aware of any formula relating the tutte polynomial @xmath3 of a bipartite graph @xmath24 and the interior and exterior polynomials of its induced hypergraphs .",
    "@xmath378 at 170 630 @xmath379 at 585 630 @xmath380 at 1000 630 @xmath381 at 1415 630 @xmath382 at 1830 630 @xmath383 at 2245 630 @xmath378 at 2660 630 @xmath380 at 170 80 @xmath384 at 585 80 @xmath382 at 1000 80 @xmath382 at 1415 80 @xmath380 at 1830 80 @xmath380 at 2245 80 @xmath379 at 2660 80     unfortunately , for a hypergraph that is not a graph , the two - variable polynomial @xmath385 ( cf .  definition [ def : tuttepoly ] ) does depend on the choice of order .",
    "for instance , for the hypergraph @xmath62 of the previous example , the order that we used there gives rise to the two - variable generating function @xmath386 ( this is directly read off of the bottom row of figure [ fig : ujfak ] ) , whereas the order @xmath387 gives @xmath388 .",
    "( note how the two polynomials do coincide after setting @xmath389 or @xmath390 . )",
    "the interior and exterior polynomials are constructed from the hypertree polytope .",
    "the same procedure can be carried out after replacing @xmath4 with the set of bases @xmath188 of an integer extended polymatroid .",
    "because of lemma [ lem : nincstobbbazis ] and the fact that integer polymatroids can always be defined by integer - valued non - decreasing submodular set functions , we immediately obtain invariants of integer polymatroids as well . in this subsection",
    "we outline the minimal modifications that are needed in our arguments to get the generalization .",
    "let @xmath170 be a finite set and @xmath171 an integer - valued submodular set function , with associated base polytope @xmath391 .",
    "we say that the base @xmath392 is such that a _ transfer _ is possible from @xmath393 to @xmath394 if by decreasing the @xmath395-component of @xmath180 by @xmath230 and increasing its @xmath396-component by @xmath230 , we get another base .",
    "now order @xmath170 arbitrarily .",
    "call an element @xmath190 _ internally active _ with respect to the base @xmath392 if @xmath180 is such that a transfer is possible from @xmath107 to a smaller element of @xmath170 .",
    "we say that @xmath107 is _ externally active _ with respect to @xmath180 if it is such that a transfer is possible to @xmath107 from a smaller element of @xmath170 .    for @xmath392 , define @xmath397 to be the number of elements of @xmath170 that are not internally active with respect to @xmath180 .",
    "similarly , let @xmath398 denote the number of elements of @xmath170 that are not externally active with respect to @xmath180 .",
    "[ def : polym ] let @xmath399 and call these quantities the _ interior polynomial _ ,",
    "respectively the _ exterior polynomial _ of the submodular set function @xmath172 .",
    "the fact that these polynomials do not depend on the order that was used to write them can be shown just like in the proof of theorem [ thm : independent ] . indeed , the first half of that proof depended on the elementary lemmas [ lem : rombusz ] ( rhombus lemma ) and [ lem : nyil ] ( staple lemma ) where we only used the fact that @xmath4 is cut out by placing an upper bound on each partial sum of the components of its elements .",
    "we also used the triviality that lines intersect bounded convex sets in segments .",
    "then in the second half of the argument we relied on proposition [ pro : szoros ] and the fact that our upper bounds are values of a tight set function .    to illustrate the geometry underlying our polynomials , we show in figure [ fig : szakoca ] the hypothetical base polytope of a polymatroid @xmath184 with a ground set @xmath400 of four elements .",
    "( we reused the diagram from the proof of lemma [ lem : teglalap ] but placed it in a different frame of reference . )",
    "it is situated in a tetrahedron with vertices @xmath401 , @xmath402 , @xmath403 , and @xmath404 .",
    "if we set the order @xmath405 , then the marked vertex represents the only hypertree with @xmath406 ; the other lattice points along the six thickened edges are the ones with @xmath407 ; the rest of the lattice points that are visible ( along a total of seven faces ) in the view we used are those with @xmath408 ; finally the invisible lattice points have @xmath409 .    @xmath116 at 610 660 @xmath117 at -30 10 @xmath118 at 1170 320 @xmath410 at 450 980     a similar picture applies to the exterior polynomial",
    ". it would be very interesting to see whether invariants of arbitrary ( i.e. , not necessarily integer ) extended polymatroids can be defined in a way analogous to definition [ def : polym ] , but replacing counts of lattice points along certain faces by taking the volumes of those faces .",
    "it may also be worth it to investigate if there is a wider class of set functions ( or polytopes ) for which interior and exterior polynomials are well defined . already in the set function case some assumption is necessary , as the next example shows .",
    "consider the tetrahedron @xmath411 the four given points are exactly the integer solutions of the equation @xmath412 and the linear inequalities @xmath413 furthermore , each of the fourteen ( fifteen ) inequalities is sharp for at least one of the four points .",
    "the right hand sides _ do not _ give a tight set function .",
    "for example , the set of the @xmath353 and @xmath414 coordinates , as well as the set of the @xmath353 and @xmath415 coordinates is tight at the point @xmath416 .",
    "however the union of the two sets is not tight at the same point .",
    "we also see that lemma [ lem : teglalap ] is violated : the face along which the sum of the @xmath353 and @xmath414 ( or the @xmath353 and @xmath415 ) coordinates takes its maximum is a triangle instead of a rectangle .    from the order @xmath417",
    ", we obtain the interior and exterior polynomials @xmath418 and @xmath419 .",
    "if we use @xmath420 instead , the interior polynomial becomes @xmath421 . for @xmath422 ,",
    "the exterior polynomial is @xmath423 .",
    "we first make an observation on the degrees of the interior and exterior polynomials and then turn our attention to some individual coefficients .    for a hypergraph @xmath54 ,",
    "the degree of its interior polynomial is at most @xmath424 , while the degree of its exterior polynomial is at most @xmath425 .    that @xmath425 is an upper bound for both degrees is obvious from the observation that the smallest hyperedge in an order is both internally and externally active with respect to any hypertree .    as to @xmath426 ,",
    "note that in order for a hyperedge @xmath31 to be internally inactive with respect to a hypertree @xmath66 , we have to have @xmath427 .",
    "this combined with gives the result .    for the constant term in the exterior polynomial and the two lowest - order coefficients in the interior polynomial ,",
    "the following two results offer a more direct way of showing their order - independence .",
    "[ pro : const ] both the internal and external polynomials of the hypergraph @xmath244 have @xmath230 for constant term .",
    "let us fix an arbitrary order on @xmath22 and denote the greedy hypertree of lemma [ lem : moho ] with @xmath129 .",
    "we claim that @xmath129 is the unique hypertree with respect to which ( and the given order ) every hyperedge is internally active . comparing the assertions of lemma [ lem : moho ] and theorem [ thm : politop ] with the definition of internal activity ,",
    "it is clear that @xmath129 is indeed one such hypertree .",
    "the fact that there are no others follows easily either from lemma [ cor : nemeles ] or from lemma [ lem : mohofelett ] . yet",
    "it may be interesting to see an argument that does not rely on abstract properties of submodular functions .    to this end ,",
    "let @xmath70 be a hypertree different from @xmath129 .",
    "we need to show that there is an internally inactive hyperedge with respect to it .",
    "we will make use of notation from subsection [ ssec : politop ] , in particular the sequence of forests @xmath428 that was constructed in the proof of lemma [ lem : moho ] .",
    "let @xmath262 be the smallest hyperedge in the order so that @xmath429 , which of course implies @xmath430 . by lemma [ lem : erdo ]",
    "we may choose a realization @xmath38 for @xmath66 so that @xmath431 .",
    "there is at least one connected component of @xmath260 which is not connected to @xmath262 by any edge in @xmath38 , even though there is an edge @xmath94 of @xmath55 between @xmath262 and this component ( we can take for example the one which was selected into @xmath253 ) .",
    "adding @xmath94 to @xmath38 creates a cycle which has to go through a hyperedge @xmath432 with @xmath433 . by removing from @xmath38 an edge of the cycle adjacent to @xmath432 and replacing it with @xmath94",
    ", we have created a new spanning tree for @xmath55 .",
    "it induces a hypertree which only differs from @xmath66 at @xmath432 ( where it is one smaller than @xmath66 ) and @xmath262 ( where it is one bigger ) .",
    "this shows that the hyperedge @xmath432 is internally inactive with respect to @xmath66 .    in the case of the external polynomial ,",
    "the unique hypertree without an ( externally ) inactive hyperedge is again as in lemma [ lem : moho ] but constructed using the reverse order .",
    "the rest of the proof can be carried out just like above .",
    "[ pro : rang ] for any hypergraph @xmath244 , the coefficient of the linear term in the interior polynomial @xmath6 is the nullity ( first betti number ) @xmath434 of the bipartite graph @xmath55 .",
    "we will extend the analysis carried out in the proofs of lemma [ lem : moho ] and proposition [ pro : const ] a little further .",
    "after fixing an order on @xmath22 , we are going to construct @xmath434 hypertrees .",
    "namely , if @xmath31 is a hyperedge , then we will associate to it @xmath435 hypertrees as follows .",
    "recall the greedy hypertree @xmath251 of lemma [ lem : moho ] and fix one of its realizations .",
    "if @xmath31 is a hyperedge that has @xmath436 with respect to the order , then add to the realization one more edge adjacent to @xmath31 .",
    "this creates a cycle which goes through another hyperedge @xmath437 .",
    "remove an edge of this cycle adjacent to @xmath437 to get a new spanning tree .",
    "its induced hypertree is the result of a transfer of valence from @xmath437 to @xmath31 .",
    "then add another edge and make another transfer and so on until all edges adjacent to @xmath31 are used up .",
    "the hyperedges that we transfer valence from are all smaller than @xmath31 because of lemma [ lem : moho ] and theorem [ thm : politop ] .",
    "the argument in the previous paragraph shows that for all @xmath438 , there is an @xmath127-element multiset of hyperedges smaller than @xmath31 so that the result of reducing their associated @xmath129-values by @xmath230 and increasing @xmath439 to @xmath440 is a hypertree in @xmath5 .",
    "now define @xmath441 ( @xmath57 , @xmath438 ) to be the hypertree among these so that its associated multiset @xmath442 is largest in reverse lexicographical order , i.e. , if @xmath443 are all the hyperedges smaller than @xmath31 , then @xmath442 has the highest possible multiplicity at @xmath262 ; then among those the highest possible multiplicity at @xmath444 , and so on .",
    "we claim that the @xmath445 are exactly those hypertrees in @xmath5 that have a unique internally inactive hyperedge in the given order .",
    "it is easy to see that the @xmath445 do have this property .",
    "namely , @xmath31 is the unique hyperedge that is not internally active with respect to @xmath445 . indeed , if @xmath446 then @xmath437 is internally active with respect to @xmath445 because @xmath447 is already at the largest value allowed by .",
    "if @xmath448 , then it is internally active because a downward transfer of valence from @xmath437 would contradict the way @xmath442 was chosen .",
    "finally , @xmath31 itself is not active because by lemma [ lem : discreteconvex ] applied to @xmath449 and @xmath450 , it can transfer valence to any element of @xmath442 .",
    "let now @xmath66 be a hypertree in @xmath5 so that it has a unique internally inactive hyperedge @xmath31 .",
    "our goal is to show that @xmath66 is one of the @xmath445 .",
    "first we claim that is sharp for @xmath66 and the set @xmath451 for all @xmath452 : indeed if it was not , then by lemma [ cor : nemeles ] there had to be hyperedges larger than @xmath437 ( and hence different from @xmath31 ) that are internally inactive with respect to @xmath66 . because of the similar property of @xmath129 stated in lemma [ lem : moho ] , we see that @xmath274 ( and hence @xmath453 for any @xmath127 ) for all hyperedges larger than @xmath31 .",
    "it also follows that @xmath454 and in fact @xmath284 , because otherwise @xmath31 could not be inactive .",
    "next , we note that if @xmath437 is a hyperedge smaller than @xmath31 , then @xmath455 because if this was not the case then lemma [ lem : mohofelett ] would imply that @xmath437 is internally inactive .",
    "so far we have shown that @xmath66 is obtained from @xmath129 by transferring valence to @xmath31 from a ( non - empty ) multiset of hyperedges that are smaller than @xmath31 .",
    "assume now that @xmath456 , where we set @xmath457 .",
    "because of the way @xmath445 was constructed , the largest hyperedge @xmath437 where the two hypertrees differ is so that @xmath448 and @xmath458 .",
    "we are going to argue that @xmath437 is internally inactive with respect to @xmath66 by showing that @xmath66 is such that @xmath437 can transfer valence to at least one element of the set @xmath459 .",
    "( note that @xmath170 is non - empty because @xmath460 and also that its elements are smaller than @xmath437 . )",
    "suppose again that the opposite is true .",
    "then by the usual argument based on proposition [ pro : szoros ] , there exists a set @xmath182 of hyperedges that is tight at @xmath66 , contains @xmath170 , and does not contain @xmath437 . over @xmath461 ,",
    "the sum of @xmath66-values is higher than the sum of @xmath445-values ; therefore over @xmath182 , the sum of @xmath445-values is higher . but this means that @xmath445 and @xmath182 contradict the inequality because the sum of @xmath66-values over @xmath182 is already @xmath462 , where @xmath172 is as in equation .",
    "therefore @xmath437 is internally inactive , but that contradicts our assumption on @xmath66 .",
    "the only possible conclusion , then , is @xmath453 .",
    "if we change the definition of @xmath445 in the proof above to now require that @xmath442 have the lowest possible multiplicity at @xmath219 , then among those choices the lowest possible multiplicity at @xmath220 and so on , then a similar argument reveals that this , too , is a hypertree in which @xmath31 is the unique internally inactive hyperedge .",
    "therefore the two descriptions define the same hypertree .",
    "it is not hard to see ( cf .",
    "* section 44.6.c ) ) that proposition [ pro : const ] generalizes to arbitrary integer extended polymatroids , i.e. , interior and exterior polynomials always have a constant term of @xmath230 .",
    "theorem [ pro : rang ] , in turn , offers a way of defining the nullity of an integer extended polymatroid via its interior polynomial .    in the classical case ,",
    "proposition [ pro : const ] translates to a well known property of the tutte polynomial .",
    "proposition [ pro : rang ] , however , reveals ( to the best of the author s knowledge ) previously undiscovered information .",
    "let @xmath20 be a connected graph . by summing the coefficients of its tutte polynomial @xmath3 in front of terms that contain @xmath463",
    ", we obtain the nullity of @xmath24 . in other words , under any order , the number of spanning trees that contain exactly one internally inactive edge is the first betti number of @xmath24 as a one - dimensional cell complex .",
    "let us now discuss situations when the interior and exterior polynomials behave multiplicatively .",
    "our first claim is obvious .",
    "[ lem : farkinca ] from @xmath54 , construct another hypergraph @xmath464 by    a.   adding a singleton hyperedge @xmath465 to @xmath22 for some @xmath56 ; b.   adding a new vertex @xmath466 to @xmath21 and making it part of exactly one hyperedge @xmath57 .    then @xmath467 and @xmath468 .    in both cases ,",
    "new and old hypertrees are in an obvious bijection . in the first , new hypertrees are exactly the extensions of old ones by assigning @xmath231 to @xmath437 .",
    "the new hyperedge @xmath437 is both internally and externally active with respect to all hypertrees regardless of the order used .    in the second case ,",
    "increase @xmath299 by @xmath230 in each hypertree @xmath66 of @xmath5 to get the collection of hypertrees in @xmath464 .",
    "with respect to any order , this correspondence preserves @xmath350 and @xmath351 values .    the main result of this subsection examines the picture when two disjoint bipartite graphs are joined by identifying two of their edges .",
    "[ thm : edgesum ] let @xmath469 and @xmath470 be hypergraphs so that @xmath471 .",
    "suppose that @xmath472 and @xmath473 both contain @xmath27 and form the hypergraph @xmath474 by merging @xmath219 and @xmath220 into a single hyperedge @xmath475 . for hypertrees",
    "@xmath309 in @xmath476 and @xmath310 in @xmath477 , define the function @xmath478 by @xmath479 and by otherwise letting @xmath480 , @xmath223 . then @xmath481 defines a bijection @xmath482 consequently , @xmath483    for the claim on the sets of hypertrees , choose arbitrary elements @xmath484 and realize them with spanning trees which contain the edges connecting @xmath222 and @xmath27 . this can be done by lemma [ lem : anchor ] . after merging @xmath219 and @xmath220 ,",
    "the union of the two trees becomes a spanning tree of @xmath55 realizing @xmath485 , which is therefore a hypertree .",
    "conversely , if @xmath66 is a hypertree in @xmath5 then we may realize it with a spanning tree that contains the edge between @xmath31 and @xmath27 .",
    "this can be separated into spanning trees of @xmath486 and of @xmath487 which induce hypertrees in @xmath476 and @xmath477 , respectively .",
    "it is easy to see that this defines an inverse to the correspondence @xmath488 .    to prove the claim on the polynomials , we make the following observation .",
    "if the hypertree @xmath489 is such that valence can be transferred from @xmath490 to @xmath491 , then    a.   [ belso ] @xmath309 is such that valence can be transferred from @xmath492 to @xmath219 and b.   [ kulso ] @xmath310 is such that valence can be transferred from @xmath220 to @xmath493 .    indeed by the above , the result @xmath297 of the assumed transfer of valence has a decomposition @xmath494 where ( since the entries in @xmath495 and @xmath496 share the same sum ) @xmath497 is a hypertree that shows the truth of and the existence of @xmath498 proves .",
    "let us now fix an order on @xmath22 in which @xmath31 is smallest and use its restrictions to order @xmath499 and @xmath500 ( so that @xmath222 becomes the smallest element in @xmath501 ) .",
    "then , we claim that for any pair of hypertrees @xmath495 in @xmath502 , we have @xmath503 because , both in the internal and in the external sense , the set of inactive hyperedges for @xmath485 is the union of the sets of inactive hyperedges for @xmath309 and for @xmath310 .",
    "( as @xmath31 , @xmath219 , and @xmath220 are smallest , they can not be inactive with respect to any hypertree . )",
    "the backward inclusion is obvious because if , say , @xmath497 results from @xmath309 by a single transfer of valence , then @xmath504 and @xmath485 are related by essentially the same transfer .",
    "the forward inclusion follows equally easily with the help of and above .",
    "comparing with the definitions of @xmath505 and @xmath506 completes the proof .",
    "the next two statements describe the situation when two bipartite graphs are joined at a single vertex .",
    "they follow from theorem [ thm : edgesum ] and lemma [ lem : farkinca ] by first slightly enlarging a hypergraph as in the lemma and then joining it to another hypergraph as in the theorem .",
    "[ cor : eleterint ] let @xmath469 and @xmath470 be hypergraphs with disjoint vertex sets .",
    "choose @xmath472 and @xmath473 and form the hypergraph @xmath5 with vertex set @xmath507 and hyperedge set @xmath508",
    ". then @xmath509 and @xmath510 .",
    "[ cor : pontoterint ] let @xmath469 and @xmath470 be hypergraphs with disjoint vertex sets .",
    "choose @xmath511 and @xmath512 and form the hypergraph @xmath5 by identifying them to a single vertex @xmath27 .",
    "i.e. , the vertex set of @xmath5 is @xmath513 and its hyperedge set is identified with @xmath514 so that @xmath27 is an element of a ` new ' hyperedge if and only if either @xmath515 or @xmath516 was an element of the ` old ' hyperedge",
    ". then @xmath509 and @xmath510 .",
    "these operations are of special importance in the theory of the tutte polynomial .",
    "however in the hypergraph case , so far they play surprisingly small roles .",
    "let @xmath54 be a hypergraph and @xmath57 a hyperedge .",
    "_ deleting _",
    "@xmath31 from @xmath5 means passing to the hypergraph @xmath517 .",
    "the result of _ contracting _",
    "@xmath31 is the hypergraph @xmath518 which is obtained from @xmath519 by identifying the elements of @xmath31 .",
    "i.e. , the hyperedge set of @xmath518 is essentially @xmath520 and its vertex set is @xmath521 , where the new vertex @xmath522 belongs to the hyperedge @xmath523 if and only if @xmath524 .",
    "it would be more consistent with our previous notation to write @xmath525 instead of @xmath519 , but for this subsection we decided to conform to the existing literature and use the simpler symbol .",
    "regarding the hypertree polytope @xmath526 and the hyperedge @xmath31 , let us define the _ top face _ of @xmath526 with respect to @xmath31 as @xmath527 and let the _ bottom face _",
    "be @xmath528 . because @xmath4 , being the set of bases in an integer polymatroid , is itself an integer polytope , the top and bottom faces with respect to any hyperedge",
    "coincide with the convex hulls of the hypertrees that they contain .",
    "[ pro : szendvics ] let @xmath54 be a hypergraph with hypertree polytope @xmath526 . for any hyperedge @xmath57 , the hypertree polytopes of @xmath519 and @xmath518 are naturally isomorphic to the bottom and the top face , respectively , of @xmath526 with respect to @xmath31 .",
    "it suffices to equate the sets of hypertrees within the respective polytopes .",
    "deletion : if we take any hypertree in @xmath519 and an arbitrary realization , then by adding to it a single edge of @xmath55 adjacent to @xmath31 , we realize a hypertree that lies along the bottom face . conversely , any realization of a hypertree from the bottom face of @xmath4 has a single edge adjacent to @xmath31 and by removing it we obtain a tree which realizes a hypertree in @xmath519 .",
    "therefore a bijection is defined by extending hypertrees in @xmath519 to @xmath31 with the value zero .",
    "( it is possible for he bottom face of @xmath4 to be empty , namely when @xmath529 is disconnected .",
    "of course in such a case @xmath530 is empty as well . )",
    "contraction : let @xmath522 denote the new vertex in @xmath518 that resulted from the contraction of @xmath31 . if @xmath66 is a hypertree in @xmath518 , then , using lemma [ lem : anchor ] , construct a realization @xmath38 for it which contains all edges adjacent to @xmath522 . based on this tree , we carry out the following construction in @xmath55 .",
    "keep all edges of @xmath38 that are not adjacent to @xmath522 . if @xmath523 is such that @xmath524 , then connect @xmath437 to an arbitrarily chosen element of the intersection . finally , add all edges that are adjacent to @xmath31 .",
    "the result is a spanning tree in @xmath55 so that its induced hypertree is part of the top face of @xmath4 and it agrees with @xmath66 on @xmath520 .",
    "the inverse of this correspondence is constructed as follows .",
    "let @xmath129 be a hypertree from the top face of @xmath4 .",
    "any of its realizations contains all edges of @xmath55 adjacent to @xmath31 .",
    "take one such tree and ( viewing it as a topological space ) contract the union of its edges adjacent to @xmath31 to a single point .",
    "the result is another tree which naturally embeds in @xmath531 as a spanning tree so that it realizes a hypertree in @xmath518 that agrees with @xmath129 over @xmath520 .",
    "we now turn to generalizations of the classical deletion  contraction formulas .",
    "lemma [ lem : farkinca ] can be viewed as a trivial extension of the second one to hypergraphs .",
    "( the reader may wish to consult to see that there is no contradiction . )",
    "the first formula also has an easy extension to hypergraphs as follows .",
    "let @xmath54 be a hypergraph with a hyperedge @xmath31 so that @xmath55 is connected but @xmath532 is the union of @xmath533 connected components",
    ". then @xmath534 and @xmath535 ( and both are equal to obvious @xmath533-fold products ) .",
    "immediate from lemma [ lem : farkinca ] and corollaries [ cor : eleterint ] and [ cor : pontoterint ] .",
    "for the abstract duals of the hypergraphs in the previous proposition , the same argument yields the same conclusion : @xmath536 and @xmath537 , because both sides of each equation agree with the obvious @xmath533-fold product .",
    "finally , let us generalize the third deletion  contraction formula from .",
    "[ pro : delcontr ] let @xmath54 be a hypergraph that contains a two - element hyperedge @xmath31 which is so that @xmath532 is connected",
    ". then we have @xmath538    as @xmath539 , each hypertree in @xmath5 lies either on the top ( if its value at @xmath31 is @xmath230 ) or on the bottom ( if it is @xmath231 ) face of @xmath4 with respect to @xmath31 .",
    "let us choose an order on @xmath22 in which @xmath31 is the largest hyperedge .    with respect to hypertrees along the bottom face ,",
    "@xmath31 is internally active . with respect to those on the top face , by lemma [ lem : mohofelett ] , @xmath31 is internally inactive : indeed the lemma applies because @xmath540 by our assumption which means that the value of the greedy hypertree at @xmath31 is @xmath541 . with this",
    ", our first equation follows easily from proposition [ pro : szendvics ] .",
    "the second is equally easy if we notice that with respect to hypertrees of the top face , @xmath31 is externally active , whereas with respect to those along the bottom face , it is externally inactive .",
    "the latter can be argued for example like this : if @xmath66 is a hypertree in @xmath5 so that @xmath69 , then take any of its realizations and add to it the ` other ' edge adjacent to @xmath31 , too .",
    "the cycle thus created goes through at least one more hyperedge @xmath437 and if we break the cycle by removing one of its edges adjacent to @xmath437 , we get a realization of a hypertree which is the result of a transfer of valence to @xmath31 from the smaller hyperedge @xmath437",
    ".    it would be highly desirable to formulate a version of the last proposition for hyperedges of arbitrary size .",
    "such formulas , however , are currently lacking .",
    "the observations on the interior polynomial contained in propositions [ pro : const ] and [ pro : rang ] show more than just the ( already proved ) order - independence of the coefficients .",
    "the values observed also remain the same if we exchange the roles of hyperedges and vertices , that is they are invariant under abstract duality .",
    "we conjecture that this is true for the rest of the interior polynomial as well .",
    "in other words , the interior polynomial is in fact an invariant of bipartite graphs .",
    "[ conj : dual ] let @xmath48 be a connected bipartite graph which induces the hypergraphs @xmath61 and @xmath62 as in",
    ". then @xmath542 .",
    "so far , supporting evidence for this includes postnikov s theorem [ thm : post ] , which says that @xmath543 , and theorem [ pro : rang ] .",
    "we present some more below .",
    "conjecture [ conj : dual ] was certainly true in example [ ex : harom ] , where it was also illustrated that the operation of abstract duality will usually result in a change in the exterior polynomial .",
    "( indeed , the linear terms can already be different . )",
    "let us work out a more general family of examples .",
    "we consider the complete bipartite graph @xmath544 , where @xmath545 and @xmath546 . for both @xmath61 and @xmath62",
    "the condition in theorem [ thm : politop ] becomes vacuous and we see that their hypertree polytopes are the simplices @xmath547 both of which contain @xmath548 hypertrees .",
    "( the number of lattice points in a standard @xmath549-dimensional simplex of sidelength @xmath199 is @xmath550 . )",
    "fix now some order on @xmath49 .",
    "if @xmath551 is a hypertree in @xmath61 and @xmath552 , then @xmath31 is internally inactive with respect to @xmath66 if and only if @xmath553 and @xmath31 is not the smallest in the order . hence to enumerate hypertrees in @xmath61 with internal inactivity @xmath199",
    ", we need to    a.   choose the set of the @xmath199 internally inactive hyperedges and b.   partition the sum of hypertree entries , @xmath554 , between them and the smallest hyperedge so that the latter may receive @xmath231 but the others get a positive amount .",
    "this is an easy exercise whose solution is @xmath555 . as this is a symmetric expression in @xmath556 and @xmath557",
    ", we see that conjecture [ conj : dual ] holds for complete bipartite graphs .",
    "we leave it for the reader to verify that the number of hypertrees in @xmath61 with external inactivity @xmath199 is @xmath558 for all @xmath559 . for this of course",
    "it does matter if we interchange @xmath556 and @xmath557 .",
    "let us temporarily call a bipartite graph _",
    "good _ if it satisfies conjecture [ conj : dual ] .",
    "bipartite graphs with an isomorphism that interchanges their color classes are good .",
    "we have seen a number of operations that , when applied to good graphs , result in other good graphs .",
    "these include adding on a new valence one point ( lemma [ lem : farkinca ] ) , joining two bipartite graphs at a vertex ( corollaries [ cor : eleterint ] and [ cor : pontoterint ] ) or at an edge ( theorem [ thm : edgesum ] ) . adding a new valence two point is also such an operation . to see why",
    ", we have to accompany proposition [ pro : delcontr ] with the following result .",
    "[ pro : delcontr ] let @xmath54 be a hypergraph with a vertex @xmath56 belonging to exactly two hyperedges @xmath219 and @xmath220 . define the deletion of @xmath27 as @xmath560 and the contraction of @xmath27 as @xmath561 ( which are the obvious ways ) . assuming that @xmath562 is connected , we have @xmath563 if we also suppose that @xmath27 is not the only common element of @xmath219 and @xmath220 , we obtain the relation @xmath564 .",
    "notice that matches the first equation in exactly .",
    "there is however a discrepancy between the formulas concerning exterior polynomials , not to mention the extra assumption ( which , by the way , can not be dropped ) .    just like in the proof of proposition",
    "[ pro : delcontr ] , first we are going to split the set of hypertrees in @xmath5 in two so that the two sides are in one - to - one correspondences with hypertrees in @xmath464 and @xmath565 , respectively , and then study activities . the geometry however will be different this time and therefore the argument more complex .",
    "if @xmath66 is a hypertree in @xmath464 , define @xmath566 and @xmath567 for other hyperedges .",
    "this is a hypertree in @xmath5 because a realization of @xmath66 in @xmath568 together with the edge of @xmath55 between @xmath219 and @xmath27 gives a realization of @xmath297 .",
    "the isometric embedding @xmath569 is obviously injective .",
    "note that @xmath565 contains a distinguished hyperedge @xmath31 where @xmath219 and @xmath220 merge .",
    "if @xmath129 is a hypertree in @xmath565 then @xmath5 has hypertrees which agree with @xmath129 away from @xmath219 and @xmath220 because the same edges that constitute a realization of @xmath129 in @xmath570 form a two - component forest in @xmath55 which can be made a spanning tree by adding to it both edges adjacent to @xmath27 .",
    "the set of these , @xmath571 is analogous to the line segments that we used in the proof of theorem [ thm : independent ] .",
    "let us now associate to @xmath129 the hypertree @xmath572 which has the highest value at @xmath220 .",
    "the sets @xmath573 , which we will also refer to as _ fibers _ , lie on parallel lines .",
    "furthermore , any hypertree @xmath574 in @xmath5 is part of a set @xmath573 . to see this , use lemma",
    "[ lem : anchor ] to construct a realization of @xmath574 containing both edges adjacent to @xmath27 and then contract those two edges to a point to obtain a spanning tree in @xmath570 that induces the right @xmath129 .",
    "moreover , if @xmath575 , then the lines containing @xmath576 and @xmath577 are disjoint ( so that the @xmath129 above is uniquely determined by @xmath574 ) .",
    "this is because @xmath578 represents all but one of the hyperedges in @xmath565 and by , the last value ( at @xmath31 ) is uniquely determined by the rest . in particular , the correspondence @xmath579 is also injective",
    ".    there do not exist @xmath66 and @xmath129 so that @xmath580 because    a.   [ atf ] for any @xmath66 , the hypertree @xmath297 is such that a transfer of valence is possible from @xmath219 to @xmath220 : just repeat the same argument that @xmath297 is a hypertree but with the roles of @xmath219 and @xmath220 reversed .",
    "b.   [ atg  ] at a hypertree of the form @xmath581 , the same transfer is never possible .    on the other hand , elements of @xmath582 ,",
    "i.e. , all hypertrees @xmath574 in @xmath5 that are such that a transfer of valence is possible from @xmath219 to @xmath220 , are of the form @xmath297 for some @xmath66 .",
    "this is because each such @xmath574 has a realization that does not contain the edge @xmath583 of @xmath55 connecting @xmath220 and @xmath27 . to show this , take any realization @xmath584 of @xmath574 .",
    "if it does not contain @xmath583 , we are done .",
    "otherwise , by lemma [ lem : anchor ] , we may assume that it contains both edges of @xmath55 adjacent to @xmath27 .",
    "[ xipage ] by removing those two edges , we separate @xmath584 to two smaller trees @xmath585 and @xmath586 .",
    "let @xmath587 be the set of hyperedges contained by @xmath585 and let @xmath588 be contained by @xmath586 so that @xmath22 is the disjoint union of @xmath499 and @xmath500 .",
    "there have to be elements of @xmath500 that are adjacent in @xmath55 to vertices of @xmath585 .",
    "this is because otherwise @xmath589 would be a spanning tree in @xmath590 , which by lemma [ lem : erdo ] would mean that @xmath500 is tight at @xmath574 and that would rule out the possibility of the assumed transfer of valence from @xmath219 to @xmath220 . whenever we locate this kind of element @xmath109 in @xmath500 ,",
    "we ` switch it over ' to @xmath499 by our usual method : add to @xmath584 an edge @xmath94 connecting @xmath591 to a vertex of @xmath585 ; this creates a unique cycle @xmath92 in @xmath592 which necessarily contains @xmath583 ; remove the edge of @xmath92 adjacent to @xmath109 which is not @xmath94 .    by iterating this procedure",
    ", we move through realizations of @xmath574 with smaller and smaller associated sets @xmath500 .",
    "therefore after finitely many steps , the hyperedge @xmath109 that we operate on will be @xmath220 itself .",
    "the edge that we remove in that step is necessarily @xmath583 .",
    "this finishes the argument that a hypertree in @xmath5 is always either of the form @xmath297 or of the form @xmath581 but never both .    in order to study activities ,",
    "let us now order @xmath22 so that @xmath219 and @xmath220 are the smallest hyperedges .",
    "( later we will use @xmath593 in the internal case and @xmath594 in the external case , but for now we leave this unspecified . )",
    "we will use this order in @xmath5 to define @xmath350 and @xmath351 , as well as in @xmath464 to define @xmath595 and @xmath596 values . in @xmath565 , let @xmath31 be the smallest hyperedge and otherwise use the same order in the definitions of @xmath597 and @xmath598 .",
    "we start with two easy claims .",
    "a.   [ ftof ] if a hyperedge @xmath109 is inactive ( in either sense ) with respect to @xmath66 in @xmath464 , then @xmath109 is inactive with respect to @xmath297 in @xmath5 .",
    "this is because if the hypertrees @xmath309 and @xmath310 in @xmath464 are related by a single transfer of valence then @xmath599 and @xmath600 are related by the same transfer .",
    "b.   [ gtog ] regarding @xmath565 , an implication of the opposite kind is easy : if the hyperedge @xmath601 is inactive with respect to some element of @xmath573 ( in @xmath5 ) , then @xmath109 is inactive with respect to @xmath129 ( in @xmath565 ) as well .",
    "just take the hypertree that results from the transfer of valence which ` makes ' @xmath109 inactive and notice that it is part of a set @xmath602 ; this @xmath603 differs from @xmath129 by the single transfer of valence which establishes the claim .    the rest of the proof",
    "is concerned with the degree to which the converses of and above are true .",
    "we start with .",
    "[ lem : sinpar ] if the hyperedge @xmath601 is inactive , in either sense , with respect to the hypertree @xmath129 in @xmath565 , then @xmath109 is inactive with respect to any element @xmath604 ( e.g.  @xmath605 ) in @xmath5 .    to show this",
    ", we separate two cases",
    ".    a.   let @xmath604 . if @xmath129 is such that a transfer of valence is possible from @xmath109 to @xmath31 ( resp .  from @xmath31 to @xmath109 ) resulting in the hypertree @xmath603 in @xmath565 , then we claim that @xmath574 is such that a transfer of valence is possible from @xmath109 to @xmath219 or @xmath220 ( resp .  from @xmath219 or @xmath220 to @xmath109 ) .",
    "this follows by fixing a @xmath606-dimensional plane containing @xmath573 and @xmath602 and constructing the type of elementary argument that we used to prove lemmas",
    "[ lem : rombusz ] and [ lem : nyil ] .",
    "b.   if @xmath129 is such that no transfer valence is possible from @xmath109 to @xmath31 ( resp .  from @xmath31 to @xmath109 ) , then by the argument in it follows that @xmath574 is such that there is no transfer of valence from @xmath109 to @xmath219 or to @xmath220 ( resp .  from @xmath219 or from @xmath220 to @xmath109 ) . as @xmath109 is inactive",
    ", there is another hyperedge @xmath607 , smaller than @xmath109 , so that @xmath129 is such that valence can be transferred from @xmath109 to @xmath110 ( resp .  from @xmath110 to @xmath109 ) , resulting in the hypertree @xmath603 . from lemma [ lem : rombusz ] and we obtain that @xmath574 is such that valence can not be transferred from @xmath110 to @xmath219 or @xmath220 ( resp .  from @xmath219 or @xmath220 to @xmath110 ) either .",
    "thus lemma [ lem : teglalap ] , applied to @xmath608 , @xmath609 , @xmath610 , @xmath611 ( resp .",
    "@xmath612 , @xmath613 , @xmath614 , @xmath615 ) implies that @xmath573 and @xmath602 are located in a rectangular cross - section of @xmath4 so that every hypertree along @xmath573 is such that a transfer of valence is possible from @xmath109 to @xmath110 ( resp .  from @xmath110 to @xmath109 ) .",
    "this completes the proof of the lemma .",
    "let us assume that @xmath219 and @xmath220 have a second common vertex @xmath616 .",
    "this is equivalent to saying that for any hypertree @xmath129 in @xmath565 , the set @xmath573 has at least two elements .",
    "] , which in turn makes it meaningful for us to let @xmath617 denote the element of @xmath573 adjacent to @xmath581 .",
    "( note that @xmath617 is of the form @xmath297 for some @xmath66 . ) indeed , if @xmath466 exists , then a spanning tree of @xmath55 may contain at most three edges of the quadrangle @xmath618 which makes it very easy to realize a transfer of valence between @xmath219 and @xmath220 .",
    "conversely , if @xmath619 , then there are ( greedy ) hypertrees in @xmath5 which take the maximal values @xmath620 and @xmath621 at @xmath219 and @xmath220 , respectively .",
    "in addition to our previous assumptions , we now set @xmath594 . concerning external inactivities , we prove the following items .",
    "* @xmath622 for all hypertrees @xmath129 in @xmath565 .",
    "it is clear that @xmath219 is externally inactive with respect to @xmath581 whereas of course @xmath31 is active with respect to @xmath129 .",
    "the rest follows from lemma [ lem : sinpar ] and .",
    "* @xmath623 for all hypertrees @xmath66 in @xmath464 .",
    "a converse of is indeed true in this case .",
    "if @xmath297 is such that @xmath220 can transfer valence to @xmath219 , then the same is obviously true for @xmath66 . if @xmath297 is such that @xmath219 or @xmath220 can transfer valence to some other hyperedge @xmath109 then , even if the result of the transfer happens to be of the form @xmath581 , it is because the transfer came from @xmath219 and it is easy to see that a transfer of valence from @xmath220 to @xmath109 turns @xmath297 into @xmath617 .",
    "finally , if @xmath297 and @xmath109 are such that no transfer of valence is possible from @xmath219 or @xmath220 to @xmath109 but the hyperedge @xmath110 can transfer valence to @xmath109 , resulting in the hypertree @xmath574 , then the usual combination of lemmas [ lem : rombusz ] and [ lem : teglalap ] shows that the fibers containing @xmath297 and @xmath574 lie in a rectangular cross - section and therefore @xmath574 is not of the form @xmath581 either .",
    "the combination of the last two equations settles the claim in the proposition concerning exterior polynomials .",
    "finally , we turn to internal activities and establish . for the remainder of the proof",
    ", we will use the order @xmath593 among the two smallest hyperedges . under the simplifying assumption that all fibers contain at least two hypertrees",
    ", the result follows relatively easily as above in the external case . without that assumption ,",
    "both components of the argument break down : some hypertrees @xmath581 are such that @xmath220 can not transfer valence to @xmath219 , i.e. , @xmath581 does not pick up an extra internally inactive hyperedge beyond those of @xmath129 ; on the other hand there are also hypertrees @xmath297 which do pick up extra internally inactive hyperedges beyond those of @xmath66 because some transfer of valence can turn them into one of the @xmath581 without a convenient @xmath617 nearby .",
    "our task is to show that the two problems cancel each other out .",
    "let us call a hypertree in @xmath5 _",
    "lonely _ if it is the unique element of its fiber , i.e. , if it is such that no transfer of valence is possible between @xmath219 and @xmath220 .",
    "we claim that if @xmath574 is a lonely hypertree , then there is a hyperedge @xmath601 so that @xmath574 is such that both @xmath219 and @xmath220 can transfer valence to @xmath109 . after noting that any realization @xmath584 of @xmath574 has to contain both edges of @xmath55 adjacent to @xmath27",
    ", we proceed as earlier ( on p.  ) to define the subtrees and hyperedge sets @xmath624 , @xmath223 .",
    "now there has to be a hyperedge @xmath109 in @xmath499 or @xmath500 that is connected by an edge @xmath94 of @xmath55 to a vertex in @xmath586 or @xmath585 , respectively , for otherwise removing @xmath27 would disconnect the graph .",
    "adding @xmath94 to @xmath584 creates a cycle through @xmath27 so that by removing either edge of @xmath55 adjacent to @xmath27 , we realize the two desired transfers of valence to @xmath109 .    if @xmath574 is a lonely hypertree then select the smallest hyperedge @xmath625 with the property above and let the hypertree @xmath626 be obtained from @xmath574 by a single transfer of valence from @xmath220 to @xmath625 . from the construction",
    "it is obvious that there is a hypertree @xmath66 in @xmath464 so that @xmath627 .",
    "it is also clear from lemma [ lem : rombusz ] that @xmath626 is part of a two - element fiber ; in particular it is such that @xmath220 can not transfer valence to @xmath219 .    for a hypertree @xmath66 in @xmath464 ,",
    "let us introduce @xmath628 the proof of will be immediate from the following items .    1 .",
    "[ ok ] @xmath629 for all hypertrees @xmath129 in @xmath565 so that @xmath581 is not lonely .",
    "this follows easily from , lemma [ lem : sinpar ] , and the observation that @xmath220 is internally inactive with respect to such hypertrees .",
    "2 .   [ keves ] @xmath630 whenever @xmath581 is lonely . in these cases",
    "@xmath220 is internally active ; otherwise see above .",
    "[ tulsok ] @xmath631 for all hypertrees @xmath66 in @xmath464 .",
    "[ sorozat ] for any hypertree @xmath66 in @xmath464 , the values of @xmath350 among the elements of @xmath632 are @xmath633 , each occurring exactly once",
    ".    we will prove [ tulsok ] ) and [ sorozat ] ) momentarily but let us first take care of .",
    "for each hypertree @xmath129 in @xmath565 , we need a hypertree in @xmath5 whose @xmath350 is one higher than @xmath634 .",
    "if it is not lonely then @xmath581 can play this role by [ ok ] ) ; otherwise [ keves ] ) says that @xmath581 is not good but it belongs to a unique set @xmath632 which , by [ sorozat ] ) , either contains an element with the desired @xmath350 or if it does not then , according to [ tulsok ] ) , @xmath297 will do the job . also , for each hypertree @xmath66 in @xmath464 we need a hypertree in @xmath5 with the same @xmath350 . if @xmath635 then , by [ tulsok ] ) , @xmath297 will do ; otherwise [ sorozat ] ) says that the element of @xmath632 with the lowest @xmath350 will suffice .",
    "since we used each hypertree in @xmath5 exactly once , follows .",
    "let us now fix a hypertree @xmath66 in @xmath5 . for each @xmath636 ,",
    "the hyperedge @xmath625 is internally inactive with respect to @xmath297 because a transfer of valence from @xmath625 to @xmath220 turns @xmath297 into @xmath574 .",
    "we claim that the same hyperedges @xmath625 are internally active with respect to @xmath66 , implying via that @xmath637 . for this",
    "it suffices to prove that any downward transfer of valence from @xmath625 will turn @xmath297 into a hypertree of the form @xmath581 for some @xmath129 .",
    "the hypertree @xmath297 is such that valence can not be transferred from @xmath625 to @xmath219 because @xmath574 was such that valence could not be transferred from @xmath220 to @xmath219 .",
    "if @xmath297 is such that a transfer of valence is possible from @xmath625 to some hyperedge @xmath638 ( resulting in the hypertree @xmath639 ) then , by the way @xmath625 was chosen in the definition of @xmath626 , the hypertree @xmath574 is such that valence can not be transferred from @xmath219 to @xmath138 . in other words",
    ", @xmath639 is such that valence can not be transferred from @xmath219 to @xmath220 which , by the characterization , establishes our claim .    to see why @xmath640 holds too ,",
    "we let @xmath641 be internally inactive with respect to @xmath297 and show that it is either internally inactive with respect to @xmath66 as well or it is one of the @xmath625 for some @xmath636 . if @xmath297 is such that a downward transfer of valence from @xmath353 turns it into @xmath642 for some @xmath643 then the first option holds .",
    "for instance , by lemma [ lem : rombusz ] and applied to @xmath297 , this is the case if @xmath297 is such that a transfer of valence is possible from @xmath353 to @xmath219 .",
    "assume now that @xmath297 is such that valence can be transferred from @xmath353 to a hyperedge @xmath644 resulting in the hypertree @xmath127 . by , @xmath297 is such that valence can be transferred from @xmath219 to @xmath220 ( resulting in the hypertree @xmath639 ) but we may assume that the opposite is the case at @xmath127 .",
    "that means that there is a set @xmath645 which is tight at @xmath127 , contains @xmath220 , but does not contain @xmath219 .",
    "because the same set @xmath182 is not tight at @xmath297 , it must be the case that @xmath182 contains @xmath138 and does not contain @xmath353 .",
    "next , apply lemma [ lem : teglalap ] with @xmath646 , @xmath647 , @xmath614 , @xmath648 to find a rectangular cross - section containing @xmath127 and notice that it also contains @xmath639 .",
    "this implies the existence of two more hypertrees in the cross - section , one of which shows that @xmath297 is such that a transfer of valence is possible from @xmath353 to @xmath220 .",
    "let the result of that transfer be the hypertree @xmath574 .",
    "if @xmath574 is of the form @xmath642 for some @xmath643 or if it is not but it is not lonely either then we see that @xmath353 is internally inactive with respect to @xmath66 . if @xmath574 is lonely , then because @xmath574 is such that both @xmath219 and @xmath220 can transfer valence to @xmath353 , we have @xmath649 ; but if @xmath650 then @xmath297 is such that @xmath353 can transfer valence to @xmath625 ( the result being @xmath626 ) , showing that @xmath353 is internally inactive with respect to @xmath66 .",
    "this finishes the proof of [ tulsok ] ) .",
    "what remains is to examine the set @xmath651 of lattice points .",
    "note that @xmath627 and the hyperedge @xmath625 determine the hypertree @xmath574 .",
    "let us label the elements of @xmath632 so that @xmath652 holds .",
    "other than the ones belonging to @xmath220 and the @xmath653 , @xmath654 , all components of the elements of @xmath651 are identical .",
    "the remaining components are almost the same too as each @xmath655 is derived from @xmath297 by a transfer of valence from @xmath653 to @xmath220 . from this description it is clear that @xmath651 is the set of vertices of an inverted @xmath656-dimensional unit simplex .",
    "based on this , using the same techniques as above , it is not hard to show that with respect to @xmath655 , the hyperedges @xmath657 are internally active and @xmath658 are internally inactive , whereas for all other hyperedges we obtain that they are internally active either with respect to all elements of @xmath651 or with respect to none of those .",
    "this completes the proof of [ sorozat ] ) and hence that of the proposition .",
    "the list of operations before proposition [ pro : delcontr ] reduces conjecture [ conj : dual ] to certain prime graphs , one of which is discussed in the next example .",
    "consider the bipartite graph shown in figure [ fig : peti ] .",
    "it is in fact a plane bipartite cubic graph , which is a class that will be important for other reasons in sections [ sec : trinity ] and [ sec : moretrinity ] . for",
    "now , we note that both of its induced hypergraphs have the interior polynomial @xmath659 this is a non - trivial example of conjecture [ conj : dual ] because the structure is not symmetric : even though both color classes have nine elements with matching valences , there is no isomorphism that interchanges them .",
    "this is demonstrated by the slight difference between the corresponding exterior polynomials .",
    "if the full dots play the role of hyperedges , we obtain @xmath660 whereas if the hollow dots represent hyperedges , we get @xmath661 all three polynomials are outputs of a computer code written by pter juhsz .",
    "we call a hypergraph @xmath54 _ planar _ if the corresponding bipartite graph @xmath55 is planar , i.e. , if it admits an embedding into the @xmath606sphere @xmath16 .",
    "we will almost always assume that such an embedding is fixed , but for extra clarity , we will talk about _ plane _ ( hyper)graphs to mean a graph together with a particular embedding .",
    "a _ region _ of a plane ( hyper)graph is a connected component of the complement of the image of the embedding .",
    "if the graph is connected , each region is homeomorphic to a disk",
    ".    for the rest of the paper , it will be convenient to allow multiple edges in ( plane ) bipartite graphs .",
    "such objects induce the same two hypergraphs ( and therefore the same two hypertree polytopes and the same interior and exterior polynomials ) as the bipartite graph which results from reducing each set of multiple edges to a single edge .",
    "this is all fairly natural given that a spanning tree may contain at most one element from a set of multiple edges .",
    "[ def : planedual ] let @xmath5 be a plane hypergraph so that its associated bipartite graph @xmath55 is connected .",
    "we define the _ planar dual hypergraph _",
    "@xmath12 of @xmath5 by keeping the set @xmath22 of hyperedges and letting the new set of vertices be the set @xmath662 of regions of @xmath5 .",
    "we let a region belong to a hyperedge if it is incident with the point representing it on the plane .     of three hyperedges .",
    "right : the planar dual of the corresponding bipartite graph @xmath55 . ]",
    "the planar dual hypergraph @xmath12 is also planar because the bipartite graph @xmath663 can be represented by a planar diagram where we place a new vertex in each element @xmath664 and connect it to all points around the boundary @xmath665 that represent elements of @xmath22",
    ". see figure [ fig : dualisok ] for an example .",
    "in fact we will identify @xmath662 and the set of points just introduced and think of the planar dual hypergraph as given with the embedding that we have just outlined .",
    "it is easy to see that our notion generalizes the usual duality of plane graphs .",
    "indeed , a plane graph @xmath20 is also a hypergraph . passing to @xmath666 means placing a new vertex to the midpoint of each edge . now in @xmath667 , these same midpoints are connected to the points which represent the two regions on either side of the original edge .",
    "finally , if we forget the midpoint , these two connections merge to form the usual dual edge .",
    "the following is also almost immediate .",
    "[ pro : dualdual ] for a plane hypergraph @xmath5 , the planar dual of the planar dual of @xmath5 is naturally isomorphic to @xmath5 .",
    "we explained after definition [ def : planedual ] how @xmath663 is embedded in @xmath16 .",
    "each point representing a vertex @xmath56 is of course in some connected component of the complement of @xmath663 .",
    "this correspondence is onto and one - to - one .",
    "the hypertree polytopes @xmath4 and @xmath668 of a planar dual pair are subsets of the same euclidean space @xmath78 .",
    "next , let us address the effect of planar duality on the hypertree polytope , as well as the interior and exterior polynomials .",
    "[ thm : sikdualis ] let the hypergraphs @xmath5 and @xmath12 be planar duals .",
    "then @xmath4 and @xmath668 are centrally symmetric .",
    "furthermore , up to interchanging the indeterminates @xmath669 and @xmath670 , we have @xmath671 and @xmath672 .    in figure [",
    "fig : dualisok ] we see that the hypergraph @xmath61 of our earlier examples is planar and in fact planar self - dual .",
    "this explains why showed its interior and exterior polynomials to coincide .",
    "parts of the following proof were simplified from an earlier version by a.  bene .",
    "proposition [ pro : dualdual ] implies that for the claim on the polytopes , it suffices to show that if @xmath66 is a hypertree in @xmath5 then @xmath673 defines a hypertree in @xmath12 .",
    "( so the center in which @xmath4 and @xmath668 are symmetric becomes the point whose @xmath31-coordinate is @xmath674 for all @xmath57 . )    to this end , choose a spanning tree @xmath235 that realizes @xmath66 .",
    "form its planar dual @xmath675 in the classical sense , i.e. , put a vertex in each element of @xmath662 and connect these by edges that bisect each edge of @xmath55 that is not an edge in @xmath38 .",
    "this is well known to be a spanning tree in the dual graph , in particular it is cycle - free , connected , and contains all points of @xmath662 .",
    "we are going to use a continuous deformation followed by some discrete steps to turn @xmath675 into a spanning tree @xmath676 that realizes @xmath340 .    each edge @xmath677 of @xmath675",
    "bisects an edge @xmath583 of @xmath55 and @xmath583 has exactly one end @xmath31 in @xmath22 .",
    "let us push the midpoint of @xmath677 along @xmath583 so that it gets very close to @xmath31 .",
    "if @xmath664 and @xmath57 are adjacent with two edges @xmath678 of @xmath55 , then we merge the halves of @xmath679 and @xmath680 adjacent to @xmath106 , as shown in the right side of figure [ fig : csillag ] .",
    "the result of the modifications so far is still a plane tree which we will continue to denote with @xmath675 .",
    "@xmath31 at 275 273 @xmath31 at 1050 273 @xmath106 at 410 490 @xmath681 at 375 550 @xmath680 at 300 550 @xmath682 at 300 505 @xmath683 at 500 475 @xmath679 at 515 400 @xmath684 at 470 400   in @xmath685 toward a tree @xmath686 in @xmath663 .",
    "solid edges represent @xmath55 ; the thick ones are in @xmath38 and the thin ones are not.,title=\"fig:\",width=384 ]    now let @xmath57 be arbitrary .",
    "write the edges of @xmath55 emanating from @xmath31 , in a cyclic order determined by the embedding , as @xmath687 .",
    "let the edges among these that do not belong to @xmath38 form @xmath199 maximal subsequences of consecutive elements .",
    "let the lengths of these subsequences be @xmath688 . in our construction",
    "so far , each of these @xmath199 groups resulted in a point @xmath222 near @xmath31 with @xmath689 edges connecting it to elements of @xmath662 .",
    "see figure [ fig : csillag ] , which shows @xmath690 with @xmath691 , @xmath692 , and @xmath693 .",
    "we wish to push these points @xmath694 all the way to @xmath31 so that the edges adjacent to them become edges of @xmath663 .",
    "the simplest case is that of @xmath695 when we can just identify @xmath219 with @xmath31 .",
    "note that after this , the number of edges of @xmath675 adjacent to @xmath31 is @xmath696 .",
    "when @xmath697 , we still start with pushing @xmath219 to @xmath31 .",
    "when we do the same to @xmath220 , however , a unique cycle is created in @xmath675 and we remove one of its two edges adjacent to @xmath31 in order to have a tree again",
    ". then we push @xmath698 to @xmath31 and remove another edge , and so forth until the last point @xmath262 . in the tree that results at the end ,",
    "the valence of @xmath31 is @xmath699 . after applying this procedure to all elements of @xmath57 with @xmath700",
    ", we arrive at a tree that is adjacent to all such hyperedges as well as to all elements of @xmath662 .",
    "we intentionally left out the case @xmath701 which of course corresponds to @xmath702 .",
    "to finish the construction of the spanning tree @xmath676 realizing @xmath340 , we add one more edge for each such hyperedge so that it is connected to an arbitrarily chosen adjacent element of @xmath662 .",
    "the claim on the polynomials is now easily obtained by the following observation .",
    "the correspondence @xmath703 is a bijection between hypertrees in @xmath5 and @xmath12 .",
    "the hypertree @xmath66 can be transformed into @xmath129 by a single transfer of valence if and only if @xmath340 can be transformed into @xmath704 by the opposite transfer .",
    "therefore with respect to any order of the hyperedges , we have @xmath705 .",
    "[ def : hyperdual ] if the hypertree @xmath66 in the plane hypergraph @xmath5 and the hypertree @xmath340 in @xmath12 are related as above ( namely , @xmath706 for all hyperedges @xmath31 ) , then we will call them _ planar dual hypertrees_.",
    "starting from a plane hypergraph and iterating the constructions of planar and abstract duality , a total of six plane hypergraphs can be built .",
    "the corresponding bipartite graphs form a triple ; see figure [ fig : trinity ] for an example .",
    "the picture thus obtained has a rich combinatorics and admits several equivalent definitions ( cf .",
    "remark [ rem : pbcg ] ) . to highlight the perfect symmetry between the constituent parts , we choose to build our discussion around the following notion .",
    "a _ trinity _ is a triangulation of the sphere @xmath16 together with a three - coloring of the @xmath231-simplices .",
    "( i.e. , @xmath231-simplices joined by a @xmath230-simplex have different colors . ) according to dimension , we will refer to the simplices as _ points , edges _ , and _",
    "triangles_.    most claims of this subsection can be repeated for three - colored triangulations of other closed , orientable surfaces .",
    "the material in the rest of the section , however , is quite specific to the sphere .",
    "we hope to return to this point in our forthcoming joint paper with bene .",
    "we will use the names red , emerald , and violet for the colors in the trinity and denote the respective sets of points with @xmath662 , @xmath22 , and @xmath21 .",
    "let us color each edge in the triangulation with the color that does not occur among its ends .",
    "then @xmath22 and @xmath21 together with the red edges form a bipartite graph that we will call the _ red graph _ and denote with @xmath707 .",
    "each region of the red graph contains a unique red point .",
    "likewise , the _ emerald graph _ @xmath708 has red and violet points , emerald edges , and regions marked with emerald points . finally ,",
    "the _ violet graph _ contains @xmath662 and @xmath22 as vertices , violet edges , and a violet point in each of its regions .",
    "we will refer to the plane bipartite graphs @xmath707 , @xmath708 , and @xmath709 above as the _ constituent bipartite graphs _ of the trinity .",
    "the hypergraphs induced by the constituent bipartite graphs are said to be _ contained _ in the trinity .",
    "a trinity contains six plane hypergraphs .",
    "it can be uniquely reconstructed from each of the six as follows .",
    "let @xmath710 be a trinity with points set @xmath711 as above .",
    "let @xmath54 be the hypergraph with emerald hyperedges and violet vertices so that @xmath712",
    ". then we also have @xmath713 , @xmath714 , @xmath715 , @xmath716 , and @xmath717 .",
    "obvious from an examination of figure [ fig : trinity ] .",
    "@xmath718 at 706 334 @xmath719 at 318 388 @xmath720 at 102 388 @xmath721 at 210 208 @xmath722 at 56 244 @xmath219 at 382 262 @xmath220 at 219 496 @xmath723 at 38 441 @xmath515 at 201 334 @xmath516 at 218 117 @xmath724 at 417 424 @xmath725 at 110 450 @xmath726 at 110 330 @xmath727 at 160 175 @xmath728 at 260 260 @xmath729 at 250 410 @xmath730 at 490 480 @xmath731 at 390 360 @xmath732 at 470 170     the triangles of a trinity can also be colored but not with the original three colors .",
    "notice that each triangle is adjacent with exactly one edge and one point of each color .",
    "compared to the orientation of the sphere , the cyclic order of the colors around each triangle may be positive or negative .",
    "if two triangles share an edge , these orientations are opposite . hence the triangles have a black and white checkerboard coloring according to orientation , cf .",
    "figure [ fig : trinity ] . in particular , the dual graph of a trinity is a plane bipartite cubic ( i.e. , uniform trivalent ) graph .",
    "it turns out that the converse is also true .",
    "[ pro : pbcg ] planar duals of plane bipartite cubic graphs are three - colorable .",
    "let @xmath733 be a plane bipartite cubic graph and let us call its color classes black and white .",
    "direct each edge in @xmath733 from its black to its white endpoint . now",
    "if we assign the modulo @xmath19 coefficient @xmath230 to the thus directed edges , the result is a cycle @xmath92 and hence a homology class in @xmath734 .",
    "therefore the modulo @xmath19 intersection number of a closed loop with @xmath92 is zero .",
    "choose a base region of @xmath733 and assign the remainder class @xmath735 to it . given any other region ,",
    "connect it to the base and assign to the region the modulo @xmath19 intersection number of the path and @xmath92 . by the above remark ,",
    "this is well defined and it is obviously a three - coloring with the colors @xmath231 , @xmath230 , and @xmath606 .",
    "[ rem : pbcg ] according to proposition [ pro : pbcg ] and the paragraph above it , the notion of a trinity is equivalent to that of a plane bipartite cubic graph .",
    "finally , notice that the sets of red edges , emerald edges , violet edges , white triangles , and black triangles all have the same cardinality @xmath556 . in particular , adjacency defines natural bijections between white triangles and edges of each color . now if we apply euler s formula to the trinity @xmath710 , we get @xmath736 , that is @xmath737      next , form the planar dual @xmath738 of the red graph @xmath739 .",
    "this is now in the classical sense , i.e. , the vertex set of @xmath738 is @xmath662 and its edges are in a one - to - one correspondence with the red edges of the trinity .",
    "this graph has a natural orientation ( more precisely , two natural orientations that are opposites of each other ) , defined as follows . put a positive spin ( as in a small spinning top ) to the emerald points and a negative spin to the violet points . if @xmath57 and @xmath56 are connected by a ( red ) edge",
    ", then the two spins induce the same orientation on the dual edge .",
    "see figure [ fig : dualisok ] for an illustration .",
    "notice that at each red point @xmath106 , the edges of @xmath738 that are adjacent to it are oriented toward and away from @xmath106 in an alternating fashion .",
    "in particular , each vertex of @xmath738 has the same number of incoming and outgoing edges .     and the directed graph @xmath738.,width=288 ]",
    "similar properties hold of course for the graphs @xmath740 and @xmath741 .",
    "it is in fact this triple of directed graphs that tutte called a trinity . in @xcite",
    ", he proved a general property of directed graphs which will be stated after the next definition .",
    "let @xmath742 be a finite directed graph ( possibly with multiple edges ) and fix a vertex @xmath743 , called the _ root_. a spanning tree in @xmath742 is called a _ spanning arborescence _ with respect to @xmath106 if the unique path in the tree from @xmath106 to any other vertex is oriented toward that vertex .    directed graphs with the same in - degree and out - degree everywhere",
    "are called _",
    "let @xmath742 be a finite , balanced directed graph .",
    "the number of its spanning arborescences does not depend on the choice of root .",
    "the same holds for trees that are oriented toward the root and the counts of the two kinds of tree coincide .",
    "the invariant of balanced directed graphs introduced in the theorem above is denoted with @xmath744 and called the _",
    "arborescence number_. the following will be a useful characterization .",
    "[ lem : tree ] spanning arborescences of a finite directed graph with root @xmath106 are exactly those cycle - free subgraphs which also have the property that for any vertex other than @xmath106 , exactly one edge of the subgraph is directed toward that vertex .",
    "let @xmath745 be a finite directed graph .",
    "if it is disconnected then both properties above describe the empty set . if @xmath742 is connected and @xmath141 is a spanning arborescence with respect to @xmath106 , then of course it is cycle - free and it has at least one edge directed into any vertex other than @xmath106 , namely the last edge on the path from @xmath106 to that vertex . but because @xmath141 contains exactly @xmath746 edges , these already exhaust all of them .",
    "conversely , if a subgraph is cycle - free than it may have at most @xmath746 edges .",
    "if it has one incoming edge for all points other than @xmath106 , then it has to have exactly @xmath746 of them ( so it is a spanning tree ) and none can be directed into @xmath106 . for any vertex @xmath747 , the first edge of the unique path from @xmath106 to @xmath27 has to be directed toward @xmath27 .",
    "the same holds for the second edge lest they share terminal points with the first .",
    "let us now return to trinities and recall a beautiful result by tutte .    [ thm : ttt ] the arborescence numbers @xmath748 , @xmath749 , and @xmath750 of the directed graphs associated to a trinity @xmath710 are the same .    we will call this common value the _ arborescence number of the trinity _ and denote it with @xmath751 .",
    "we quickly sketch a proof , based on @xcite , as elements of it will be relevant later .",
    "recall that the triangles of a trinity have a black - and - white color scheme .",
    "we may concretize our choice of orientation in the three directed graphs by requiring that the head of each edge be in a white triangle while the tail end of each is in a black triangle . compare figures [ fig : dualisok ] and [ fig : dualitas ] .",
    "then by lemma [ lem : tree ] , a spanning arborescence of @xmath738 , say , is an assignment of an adjacent white triangle to each non - root red point ( the unique incoming edge will reach the point through the chosen triangle ) .",
    "we adapt this point of view for the rest of the proof .",
    "let us now distinguish a white triangle @xmath752 ( called the outer triangle ) and choose its adjacent points @xmath753 , @xmath754 , and @xmath755 as the roots in the three directed graphs .",
    "then @xmath752 can never be selected into an arborescence of any color .",
    "notice that by , the rest of the triangles and the rest of the points are in a one - to - one correspondence .    fix a spanning arborescence @xmath141 in @xmath738 .",
    "we are going to associate to it two other spanning arborescences , in @xmath740 and @xmath741 respectively , so that @xmath756 in other words , no white triangle will get assigned to two different points .",
    "we also claim that , given @xmath141 , there is a unique way to do this .",
    "the dual @xmath757 of @xmath141 is a spanning tree in @xmath739 .",
    "this tree @xmath757 consists of those edges whose duals are not in @xmath141 , in other words of those red edges whose adjacent white triangles have not been assigned to a red point .",
    "note that the edge connecting @xmath722 and @xmath723 is part of @xmath757 . as @xmath757 is a tree , it has at least two leaves , i.e. , valence one points .",
    "if those are @xmath722 and @xmath723 , then @xmath757 consists of a single edge , hence there can not be any other emerald or violet points and we have no assigning to do .",
    "otherwise , as our leaf is adjacent to a unique white triangle that has not yet been assigned , we make the obvious assignment and delete the leaf ( with its single adjacent edge ) from @xmath757 .",
    "we continue this procedure until @xmath757 is reduced to the single edge of @xmath752 between @xmath722 and @xmath723 . by that time , all other emerald and violet points",
    "have been associated to an adjacent white triangle so that no white triangle was used twice .",
    "we have to check ( cf .",
    "lemma [ lem : tree ] ) that the subgraphs we constructed in @xmath740 and @xmath741 are cycle - free .",
    "this is shown using proof by contradiction , arguing that a violet or emerald cycle would prevent some red point from being connected to the red root @xmath718 in @xmath141 .",
    "see @xcite for details .",
    "as the color red played no special role above , any triple of spanning arborescences satisfying can be uniquely reconstructed from any of its three members .",
    "we conclude that spanning arborescences of our three directed graphs are arranged in disjoint triples and so their numbers agree .",
    "a mapping satisfying will be called a _ tutte matching _ ( with respect to some fixed outer white triangle @xmath752 ) .",
    "tutte matchings are exactly the nonzero terms in the expansion of a determinant that first appeared in the work of berman .",
    "[ thm : berman ] the common arborescence number of the three directed graphs of a trinity can be expressed as the absolute value of the determinant of the adjacency matrix of non - outer white triangles and non - root points .",
    "this is of course a square matrix by the observation . to prove the theorem , berman @xcite checks that any tutte matching is in fact the union of three spanning arborescences ( which boils down to cycle - freeness and another argument by contradiction ) and that all non - zero expansion terms come with the same sign .",
    "the adjacency matrix associated with the trinity of figure [ fig : trinity ] is @xmath758 its determinant is @xmath759 , which equals the number of spanning arborescences in each of the three dual directed graphs , including the one shown in figure [ fig : dualitas ] .",
    "[ thm : alexander ] let @xmath48 be a plane bipartite graph .",
    "the arborescence number of its planar dual @xmath667 agrees with the number of hypertrees in the hypergraphs @xmath760 and @xmath761 induced by @xmath24 .",
    "i.e. , @xmath762    let us denote the vertex set of @xmath667 with @xmath662 and fix a root @xmath753 .",
    "any spanning arborescence @xmath141 rooted at @xmath718 has a planar dual spanning tree @xmath757 in @xmath24 and that in turn has a valence distribution which gives rise to a hypertree @xmath763 .",
    "we will show that the mapping @xmath764 is one - to - one and onto .",
    "( a similar statement holds of course for hypertrees in @xmath62 instead of @xmath61 .",
    "thus what we find as a byproduct is a set of spanning trees in @xmath24 that simultaneously realize all hypertrees in @xmath61 and @xmath62 . )    for any @xmath765 , the edges of @xmath24 adjacent to it give rise to a directed cycle @xmath766 in @xmath667 and the edge set of @xmath667 is the disjoint union of these cycles . note that each cycle @xmath766 travels around the corresponding point @xmath27 following the same orientation .",
    "first we show that if two arborescences @xmath141 and @xmath140 contain the same number of edges from each @xmath766 ( which is equivalent to @xmath767 ) , then @xmath768 .",
    "assume this is not so .",
    "then at least one cycle @xmath769 contains an edge @xmath770 of @xmath141 that is not an edge in @xmath140 .",
    "let the head of @xmath770 be @xmath719 .",
    "obviously @xmath771 because @xmath141 has an edge pointing to it .",
    "the other arborescence @xmath140 also has to have such an edge @xmath772 but that has to be part of a different cycle @xmath773 . the edge @xmath772 can not belong to @xmath141 because then @xmath141 would have two edges pointing to @xmath719 .",
    "then , because @xmath141 and @xmath140 intersect @xmath773 in the same number of edges , @xmath773 also contains an edge @xmath774 which belongs to @xmath141 but does not belong to @xmath140 .",
    "iterating our argument , we find cycles @xmath775 in @xmath667 until the first repetition occurs . after discarding some cycles at the beginning and relabeling the rest",
    ", we may assume that @xmath776 was the first such coincidence .",
    "then we find ourselves in the situation depicted in figure [ fig : korbeer ] .",
    "the interiors of the cycles @xmath777 are disjoint from @xmath667 , hence the non - root points @xmath778 separate @xmath667 into the smaller directed graphs @xmath779 and @xmath780 , see figure [ fig : korbeer ] , which have only those points in common .",
    "both @xmath779 and @xmath780 have to contain vertices other than @xmath778 because otherwise @xmath141 or @xmath140 would not be cycle - free .",
    "only one of them , however , can contain the root @xmath718 .",
    "now the contradiction is apparent from the fact that no directed path in @xmath141 can pass from @xmath779 to @xmath780 and no directed path in @xmath140 can pass from @xmath780 to @xmath779 .",
    "@xmath779 at -100 300 @xmath780 at 320 260 @xmath769 at 100 260 @xmath719 at 110 350 @xmath770 at 190 340 @xmath772 at 100 430 @xmath773 at 210 430 @xmath720 at 295 430 @xmath774 at 310 360 @xmath781 at 330 500 @xmath782 at 420 410 @xmath721 at 510 400 @xmath783 at 520 320 @xmath784 at 570 450 @xmath785 at 540 110 @xmath786 at 500 10 @xmath787 at 400 100 @xmath788 at 305 75 @xmath789 at 270 160 @xmath790 at 255 15 @xmath791 at 180 100 @xmath792 at 130 160 @xmath793 at 170 200 @xmath794 at 70 170 .,title=\"fig:\",width=192 ]    to prove that any hypertree @xmath551 can be obtained in the form @xmath795 , we employ the following strategy .",
    "start from an arbitrary spanning tree @xmath38 in @xmath24 that realizes @xmath66 and take its dual tree @xmath796 .",
    "we are going to change @xmath38 step - by - step through other realizations of the same hypertree @xmath66 so that the dual moves closer and closer to being an arborescence .",
    "it is sufficient to keep track of the changes made to the dual tree @xmath686 .",
    "then , the condition that we preserve the hypertree translates to requiring that for each @xmath765 , the number of edges in @xmath797 stays invariant throughout the process .",
    "it is of course crucial to describe carefully what we mean by getting closer to an arborescence . in a rooted tree , edges @xmath583",
    "have a well defined distance @xmath798 to the root ( those adjacent to the root have @xmath799 etc . ) .",
    "if the tree is directed , then there is also a clear sense for each edge to be directed toward the root or away from the root .",
    "the first kind of edge will be called _ bad _ and the second kind _",
    "good_. the tree is an arborescence if and only if all of its edges are good .",
    "let us now associate the following quantities to a finite , directed , rooted tree @xmath800 .",
    "* let @xmath801 denote the smallest value of @xmath549 among bad edges .",
    "( so that within a radius of @xmath556 from the root , the tree is an arborescence . )",
    "* for @xmath802 , let @xmath803 be the number of edges @xmath583 with @xmath804 .",
    "these values are positive . for @xmath805 , we define @xmath806 .      1 .",
    "[ lexi ] the sequence @xmath808 is smaller than the sequence @xmath809 in lexicographic order , or 2 .",
    "[ tuske ] the two sequences coincide ( implying @xmath810 ) but the number of bad edges in @xmath811 with @xmath812 is higher than the same count in @xmath813 .",
    "this may sound complicated but the actual idea of the proof is very simple .",
    "if @xmath686 is not a spanning arborescence already , then it contains a bad edge @xmath583 with @xmath814 .",
    "if we remove @xmath583 from @xmath686 , then the tree falls apart into a root component and a non - root component .",
    "now @xmath583 is part of a cycle @xmath766 which contains points from both components .",
    "therefore @xmath766 also has an edge @xmath815 that goes from a point of the root component to a point of the non - root component .",
    "let @xmath816 denote the tree obtained from @xmath686 by replacing @xmath583 with @xmath815 .",
    "note that @xmath815 is a good edge of the new tree .",
    "the difficulty is that in what used to be the non - root component , distances to the root and relative orientations may have changed .",
    "what we do know though is that each of those edges is farther away from the root than @xmath815 .",
    "let us separate two cases according to whether the non - root component is reattached ` close to ' or ` far from ' the root .",
    "a.   if @xmath817 ( where @xmath818 is of course measured in @xmath816 ) , then @xmath819 by .",
    "indeed , with the addition of @xmath815 , @xmath820 went up by @xmath230 whereas the @xmath821 values before it stayed the same .",
    "b.   if @xmath822 , then @xmath819 either by ( if @xmath583 was the unique bad edge of @xmath686 with @xmath814 , in which case @xmath823 moves from @xmath231 to a positive value ) or by .",
    "we conclude that if the dual of a realization of @xmath66 is not a spanning arborescence , then it is possible to change it to another tree , dual to another realization , that is larger in the sense of the linear order @xmath824 . because there are altogether finitely many spanning trees in @xmath667 , it is now obvious that a spanning arborescence will be reached after finitely many improvements .",
    "thus we find that our map @xmath764 is onto .",
    "theorem [ thm : alexander ] of course verifies postnikov s theorem [ thm : post ] in the case of a planar bipartite graph @xmath24 .",
    "postnikov ( * ? ? ?",
    "* lemma 12.6 ) describes a sufficient condition on a set of spanning trees of @xmath24 in order for them to define a triangulation of the root polytope and therefore to simultaneously realize all hypertrees of the two induced hypergraphs .",
    "it is interesting to note that our set of spanning trees satisfies his condition , as follows .",
    "let @xmath24 be a plane bipartite graph with ( classical ) dual @xmath667 as before .",
    "let @xmath141 and @xmath140 denote two spanning arborescences of @xmath667 with respect to the same root @xmath106 .",
    "then there is no cycle @xmath825 in @xmath24 composed of edges @xmath826 of @xmath757 and @xmath827 of @xmath828 .",
    "it is easy to see that edges of @xmath141 could only cross such a cycle in one direction and edges of @xmath140 could only cross it in the opposite direction .",
    "that leads to the usual contradiction of some points becoming inaccessible from the root for one of the two arborescences .",
    "tutte s theorem [ thm : ttt ] says that directed graphs in a trinity have the same number of spanning arborescences , just like the two graphs in a planar dual pair have the same number of spanning trees .",
    "we may now add that the six hypergraphs contained in the trinity have the same number of hypertrees .",
    "moreover , the following is immediate from theorem [ thm : alexander ] .",
    "let us make one more observation .",
    "we saw how each tutte matching contains three spanning arborescences ( one for each of @xmath830 , @xmath831 , and @xmath832 ) and how the ( classical ) planar duals of these realize a hypertree in each of the six hypergraphs .",
    "this way , each hypertree turns up in relation to exactly one tutte matching .",
    "in fact we also have the following .",
    "pick an arbitrary , say emerald point from the trinity and denote it with @xmath31 .",
    "it is matched to one adjacent white triangle ( or , if the point is the root , substitute the outer white triangle here ) .",
    "out of its other @xmath833 adjacent white triangles , @xmath557 are matched to red points and @xmath834 to violet points .",
    "therefore there are @xmath835 red edges and @xmath836 violet edges adjacent to @xmath31 that appear in the spanning trees of @xmath707 and @xmath709 , respectively , induced by the tutte matching .",
    "this causes the @xmath31-coordinates of the corresponding hypertrees to be @xmath837 and @xmath557 , respectively , the sum of which is indeed @xmath833 .",
    "we are going to extend berman s theorem [ thm : berman ] to write hypertree polytopes associated with plane hypergraphs in determinant form .",
    "let @xmath838 denote the adjacency matrix with rows indexed by the non - root points and columns indexed by the non - outer white triangles .",
    "if a triangle @xmath839 is adjacent with the emerald point @xmath840 and the non - root violet point @xmath841 , then at the intersection of row @xmath841 and column @xmath839 , change the entry @xmath230 to @xmath840 .",
    "( after it becomes a matrix entry , we will think of @xmath840 as an indeterminate associated with the original point . )",
    "call this matrix the _ enhanced adjacency matrix _ and denote it with @xmath842 .",
    "notice that even though @xmath838 contains no row indexed by a root , indeterminates belonging to roots do appear in enhanced adjacency matrices",
    ".    it would be rather pointless to write the symbol @xmath840 in the row indexed by that point because that would simply multiply the determinant by @xmath840 .",
    "the little twist that we introduced , on the other hand , turns out to be quite useful .",
    "[ thm : det ] let the plane bipartite graphs @xmath739 , @xmath843 , and @xmath844 be the constituents of a trinity .",
    "fix an outer white triangle @xmath752 which is adjacent to the roots @xmath753 , @xmath754 , and @xmath755 and form the enhanced adjacency matrix @xmath842 as above .",
    "then for the hypergraph @xmath54 and its hypertree polytope , we have @xmath845 in the following sense .",
    "the determinant on the right hand side is a sum of monomials in the indeterminates @xmath57 .",
    "either each monomial has coefficient @xmath846 or each has @xmath847 .",
    "if we write the exponents in each monomial as a vector , the set we obtain is exactly the left hand side .",
    "the claim on the uniform signs of course follows from berman s theorem [ thm : berman ] on the adjacency matrix @xmath838 .",
    "there and in the proof of theorem [ thm : ttt ] we saw that the nonzero terms in the expansion of @xmath848 , which are the tutte matchings ( of non - root points in the trinity to adjacent non - outer white triangles ) , are also triples of spanning arborescences in the directed graphs @xmath738 , @xmath740 , and @xmath741 .",
    "furthermore , all spanning arborescences from each of the three directed graphs occur as part of exactly one triple .",
    "then in the proof of theorem [ thm : alexander ] we found that the planar duals @xmath757 of the spanning arborescences @xmath141 of @xmath738 realize each hypertree in @xmath526 exactly once . recall that the value of the hypertree @xmath849 at an emerald point @xmath840 is the number of adjacent ( to @xmath840 ) edges of @xmath757 minus one .",
    "a red edge is in @xmath757 if and only if its adjacent white triangle is not assigned to its red point , i.e. , if the triangle is the outer one or if it is assigned to an emerald or violet point .",
    "if @xmath850 then it is not adjacent to @xmath752 and out of all white triangles adjacent to @xmath840 , exactly one is assigned to an emerald point ( namely , @xmath840 ) .",
    "thus @xmath851 is the number of white triangles that are adjacent to @xmath840 and which are assigned to their violet points .",
    "the same holds for @xmath722 where now @xmath752 plays the role of the correction term @xmath847 .",
    "finally , we just have to check the effect of enhancing @xmath838 into @xmath842 on the expansion term that corresponds to @xmath141 . in that monomial , by definition , the indeterminate @xmath840 will appear once for each time that a ( non - outer ) white triangle @xmath839 , which is adjacent to the point @xmath840 , gets assigned to its adjacent violet point @xmath841 .",
    "this completes the proof .",
    "the hypertree polytopes of example [ ex : ketto ] can be recomputed as the determinants of the following two matrices @xmath842 and @xmath852 ( warning : the labels of the points have changed , cf .",
    "figure [ fig : trinity ] ) : @xmath853 the first is equal to @xmath854 , and the second one is @xmath855 .",
    "observe that the sequences of exponents ( @xmath856 etc .  and @xmath416 etc .",
    ", respectively ) are exactly the hypertrees that we saw earlier .    of course ,",
    "as we have already done in the example above , we may use theorem [ thm : det ] to compute any of the six hypertree polytopes associated to a trinity .",
    "this leads to another proof of theorem [ thm : sikdualis ] in terms of manipulating determinants .",
    "it is quick but it is probably much less instructive than the proof given in section [ sec : dual ] .",
    "indeed , starting from @xmath842 , pull out @xmath840 from any column that belongs to a white triangle adjacent with @xmath840 .",
    "do this for all emerald points @xmath840 .",
    "then for the non - root emerald points , pull out @xmath857 from the row indexed by @xmath840 .",
    "the result is a monomial times the enhanced adjacency matrix @xmath858 but with @xmath857 written everywhere where @xmath840 should appear .",
    "therefore the determinant of the matrix is @xmath859 .",
    "if we examine the monomial factor , we see that the exponent of @xmath840 in it is exactly @xmath860 . here",
    "@xmath861 means the size of @xmath840 as a hyperedge , which is the same in @xmath5 as in @xmath12 .",
    "it can also be described as the number of violet and red points connected to @xmath840 by red , respectively violet edges of the trinity , as well as the number of white triangles adjacent to @xmath840 .",
    "the claim is obvious for the non - root emerald points and the exponent of @xmath722 is @xmath862 because @xmath722 is adjacent to the outer white triangle @xmath752 which had no column in the matrix .",
    "let us summarize our findings on hypertree polytopes and interior and exterior polynomials associated to the six hypergraphs contained in a trinity .",
    "see figure [ fig : hetszog ] .",
    "the six polytopes form three centrally symmetric pairs by theorem [ thm : sikdualis ] , i.e. , there are only three ` shapes ' associated to the trinity .",
    "let us denote these , indicating the respective sets of hyperedges , with @xmath863 , @xmath864 , and @xmath865 .",
    "these polytopes have different dimensions but by corollary [ cor : rho ] each contains the same number of integer lattice points , namely @xmath829 , where @xmath829 is the arborescence number of the trinity .",
    "a priori , there are twelve interior and exterior polynomials associated to the six hypergraphs . but again by theorem [ thm : sikdualis ]",
    ", that number is reduced to six , as indicated in figure [ fig : hetszog ] .",
    "these polynomials all have non - negative integer coefficients with their sum equal to @xmath829 in each case . furthermore ,",
    "if conjecture [ conj : dual ] holds , then @xmath866 , @xmath867 , and @xmath868 , so there are in fact only three different polynomials .",
    "hypergraph at 370 580 at 370 636 at 370 692 polytope at 370 524 @xmath869 at 526 497 @xmath505 at 574 533 @xmath506 at 622 569 @xmath870 at 565 335 @xmath506 at 617 323 @xmath505 at 669 311 @xmath871 at 459 202 @xmath872 at 484 152 @xmath873 at 509 102 @xmath874 at 281 202 @xmath873 at 256 152 @xmath872 at 231 102 @xmath875 at 175 335 @xmath876 at 123 323 @xmath877 at 71 311 @xmath878 at 214 497 @xmath877 at 166 533 @xmath876 at 118 569 @xmath162 at 370 380 @xmath864 at 505 410 @xmath865 at 235 410 @xmath863 at 370 237   is true , then @xmath866 , @xmath867 , and @xmath868.,title=\"fig:\",width=345 ]    our first ` final note ' is that the polytopes @xmath879 , @xmath880 , and @xmath881 are all projections of a single set @xmath162 of lattice points .",
    "this can be defined by superimposing @xmath842 , @xmath882 , and @xmath883 to obtain the matrix @xmath884 and taking its determinant . in our running example , the result is @xmath885 with a determinant of @xmath886 .",
    "obviously , @xmath887 , @xmath888 , and @xmath889 are all obtained from @xmath890 by substituting @xmath230 for the unneeded variables .",
    "this corresponds to projections of the associated sets of lattice points which we indicated with the three arrows in figure [ fig : hetszog ] . in particular",
    ", all four determinants contain the same number of lattice points , which is the arborescence number of the trinity .",
    "it is not yet clear , however , whether @xmath891 is itself a lattice polytope .",
    "finally , there exists a curious relationship between our results and an invariant introduced by jaeger @xcite .",
    "we noted in subsection [ ssec : basic ] that the planar dual of a trinity is a plane bipartite cubic graph .",
    "jaeger associated a one - variable polynomial @xmath892 ( with non - negative integer coefficients ) to such objects .",
    "his definition does not make use of the three - coloring of proposition [ pro : pbcg ] and indeed , his polynomial is different from any of the six ( three ) that we introduced .",
    "( for example , the trinity of figure [ fig : trinity ] has @xmath893 . )",
    "the sum of the coefficients is , however , the same .      as the definition of @xmath170",
    "is based on a recursion , it is natural to prove our claim by induction .",
    "jaeger sets his initial condition @xmath895 at a ` free loop , ' but an equivalent notion results if we start by setting @xmath896 for the theta graph ( which has two vertices and three edges connecting them ) .",
    "the theta graph is dual to the trinity formed by one black and one white triangle with a common boundary .",
    "each of the three directed graphs associated to the latter has a single vertex and one loop edge and , therefore , only one arborescence .",
    "@xmath710 at -40 400 @xmath897 at -40 30 @xmath710 at 720 400 @xmath811 at 670 10 @xmath813 at 1110 10 @xmath31 at 880 300 @xmath466 at 755 260 @xmath466 at 1000 30 @xmath898 at 1020 440 @xmath898 at 1255 205 @xmath27 at 610 100     the invariant @xmath170 obeys two kinds of recursive ` collapsing ' rules .",
    "figure [ fig : collapse ] shows the associated pictures , drawn not for the plane bipartite cubic graphs but for their dual trinities ( with an arbitrarily chosen local coloring ) .",
    "the part of the trinity outside of the emerald contour does not change under the collapsing operations .",
    "( the red and violet points in the pictures have other neighbors that are not shown . )",
    "it is easy to show that if a trinity contains at least four triangles than at least one of the moves can always be carried out .",
    "the rules themselves are @xmath899 for the collapsing move on the left and @xmath900 for the one on the right . in the first case ,",
    "@xmath901 by an application of corollary [ cor : rho ] and either lemma [ lem : farkinca ] ( if we choose to work with the red or the violet graph ) or the observation that a double edge has been removed from the emerald graph .    in the second case ,",
    "separate the points of @xmath710 by color into the usual sets @xmath662 , @xmath22 , and @xmath21 .",
    "notice that the set @xmath50 of violet points in @xmath811 is obtained from @xmath21 by identifying @xmath466 and @xmath898 with a single point @xmath27 .",
    "the set of emerald points in both @xmath811 and @xmath813 is @xmath520 .",
    "furthermore , the hypergraph @xmath902 contained in @xmath811 and the hypergraph @xmath903 contained in @xmath813 are the contraction and deletion , respectively , of the hyperedge @xmath31 from the hypergraph @xmath904 contained in @xmath710 .",
    "therefore we get the desired conclusion from corollary [ cor : rho ] and proposition [ pro : delcontr ] .",
    "w.  t.  tutte , _ duality and trinity .",
    "infinite and finite sets _",
    "( colloq .",
    "keszthely , 1973 ; dedicated to p.  erds on his 60th birthday ) , vol .",
    "iii , pp .",
    "jnos bolyai , vol .",
    "10 , north - holland , amsterdam , 1975 ."
  ],
  "abstract_text": [
    "<S> tutte s dichromate @xmath0 is a well known graph invariant . using the original definition in terms of internal and external activities as our point of departure </S>",
    "<S> , we generalize the valuations @xmath1 and @xmath2 to hypergraphs . in the definition , </S>",
    "<S> we associate activities to hypertrees , which are generalizations of the indicator function of the edge set of a spanning tree . </S>",
    "<S> we prove that hypertrees form a lattice polytope which is the set of bases in a polymatroid . </S>",
    "<S> in fact , we extend our invariants to integer polymatroids as well . </S>",
    "<S> we also examine hypergraphs that can be represented by planar bipartite graphs , write their hypertree polytopes in the form of a determinant , and prove a duality property that leads to an extension of tutte s tree trinity theorem . </S>"
  ]
}