{
  "article_text": [
    "galaxy redshifts are important for a large number of studies related with the extragalactic universe , due to their direct correlation with the distance of the sources .",
    "photometric galaxy redshifts ( hereafter photo - z s ) are crucial in the current era of large surveys , based on massive datasets . they are used in a wide plethora of tasks , such as , for example , to constrain the dark matter and dark energy contents of the universe through weak gravitational lensing , to understand the cosmic large scale structure , by identifying galaxies clusters and groups , to map the galaxy color - redshift relationships , as well as to classify astronomical sources .",
    "more recently , the attention in this field has been focused on the techniques able to compute a probability density function ( pdf ) of the photo - z s for each individual astronomical source , with the goal to improve the knowledge about statistical reliability of photo - z estimations . in the machine learning context",
    "several methods have been proposed to approach this task , see for instance : ( ( * ? ? ?",
    "* bonnet 2013 ) , ( * ? ? ?",
    "* rau et al . 2015 ) , ( * ? ? ?",
    "* sadeh et al . 2015 ) , ( * ? ? ?",
    "* carrasco & brunner 2014 ) ) . here",
    "we present a new method , named metaphor ( machine - learning estimation tool for accurate photometric redshifts ) , a modular workflow including a machine learning engine to derive photo - z s and a method to produce their pdf s , based on the evaluation of photometric data uncertainties to derive a perturbation law of the photometry . with this law",
    "we perform the perturbation of the features , in a controlled , not biased by systematics , way .",
    "a proper error fitting , accounting for the attribute errors , allows to constrain the perturbation of photometry on the biases of the measurements .",
    "the conceptual flow of the metaphor pipeline is based on the following sequence of tasks : given a multi - band data sample containing the spectroscopic galaxy redshifts , _ ( i ) _ for each band involved , a photometry perturbation function is derived ; _ ( ii ) _ the data sample is randomly shuffled and split into a training and a test set ; _ ( iii ) _ the photometry of the test set is perturbed , thus obtaining an arbitrary number @xmath0 of test set replica ; _ ( iv ) _ finally , the machine learning engine is trained and the @xmath1 test sets ( @xmath0 perturbed plus the unperturbed one ) are submitted to the training model to derive the pdf of photo - z estimations .    in the last step , the @xmath1 values , output of the trained network , are used to calculate , for each bin of redshift , the probability that a given photo - z value belongs to each bin .",
    "the binning step @xmath2 , as well as the number @xmath0 of perturbations , are user defined parameters , to be chosen accordingly to the specific requirements of the experiment . for a given photo - z binning step @xmath2 , we calculate the number of photo - z s for each bin ( @xmath3 ) and the probability that the redshift belongs to the bin is @xmath4 .",
    "the resulting pdf is thus formed by all these probabilities .    at the end of the procedure ,",
    "a post - processing module calculates the final photo - z estimation and pdf statistics .",
    "for instance , we evaluate the photo - z s in terms of a standard set of statistical estimators for the quantity @xmath5 on the objects in the blind test set : _ ( a ) _ bias : defined as the mean value of the residuals @xmath6 ; _ ( b ) _ @xmath7 : the standard deviation of the residuals ; _ ( c ) _ @xmath8 : the radius of the region that includes @xmath9 of the residuals close to 0 ; _ ( d ) _ @xmath10 : the normalized median absolute deviation of the residuals , defined as @xmath11 ; _ ( e ) _ fraction of outliers with @xmath12 ; _ ( f ) _ skewness : asymmetry of the probability distribution of a real - valued random variable around the mean .",
    "furthermore , in order to evaluate the cumulative performance of the pdf we compute the following three estimators on the _ stacked _ residuals of the pdf s : _ ( 1 ) _ @xmath13 : the percentage of residuals within @xmath14 ; _ ( 2 ) _ @xmath15 : the percentage of residuals within @xmath16 ; _ ( 3 ) _ @xmath17 : the weighted average of all the residuals of the _ stacked _ pdf s .",
    "the photometry perturbation is based on the following expression , applied on the given _",
    "j _ magnitudes of each band _ i _ as many times as the number of perturbations of the test set : @xmath18 the term @xmath19 is a multiplicative constant , used to customize the photometric error trend on the base of the specific band photometric quality .",
    "this could result particularly useful in case of photometry obtained by merging different surveys ; the quantity @xmath20 is the weighting coefficient associated to each specific band used to weight the gaussian noise contribution to magnitude values ; finally , the term @xmath21 is a random value extracted from a normal distribution .    we investigated four different types of the weighting coefficient @xmath20 .",
    "first one is a heuristically chosen real number between @xmath22 and @xmath23 , implying a same width of the gaussian noise for each point .",
    "the second choice is based on weighting the gaussian noise contribution using the individual magnitude error provided for each source .",
    "the third one is a polynomial fitting : a binning of photometric bands is performed , in which a polynomial fitting of the mean magnitude errors is used to reproduce the intrinsic trend of the distribution .",
    "the last option is a slightly more sophisticated version of the polynomial fitting , coupled with a minimum value chosen heuristically , thus resulting in a bi - modal perturbation function .",
    "as introduced , one of the most suitable features of metaphor is the invariance to the specific empirical model used as engine to estimate photo - z s . in order to demonstrate this capability",
    ", we tested the metaphor workflow using three different machine learning methods : mlpqna neural network ( * ? ? ? *",
    "( byrd et al . 1994 ) ) , already successfully used in several astrophysical contexts ( ( * ? ? ?",
    "* brescia et al . 2013 ) , ( * ? ? ?",
    "* brescia et al .",
    "2014a ) , ( * ? ?",
    "* cavuoti et al . 2012 ) , ( * ? ? ?",
    "* cavuoti et al .",
    "2014a ) , ( * ? ?",
    "* cavuoti et al .",
    "2014b ) , ( * ? ? ?",
    "* cavuoti et al .",
    "2015b ) ) , the standard knn ( * ? ? ?",
    "* ( cover & hart 1967 ) ) , and random forest ( * ? ? ? * ( breiman 2001 ) )",
    ". in particular , the experiment with a very basic machine learning model like knn method , would demonstrate the most general applicability of any empirical model engine within metaphor .",
    "furthermore , by considering that the methods mostly based on sed template fitting intrinsically provide the pdf of the estimated photo - z s , we compared metaphor with the _ le phare _ model ( * ? ? ? * ( ilbert et al .",
    "2016 ) ) .",
    "the real data used for the tests were a galaxy spectroscopic catalogue sample extracted from the data release 9 ( dr9 ) of the sloan digital sky survey , sdss , ( * ? ? ? * ( york et al 2000 ) ) . by using mlpqna as internal engine for photo - z estimation",
    ", we reached values of @xmath24 , @xmath25 and @xmath26 of outliers .",
    "these statistical results are slightly worse than what we showed in a previous article ( * ? ? ?",
    "* ( brescia et al . 2014c ) ) , where we already used the mlpqna method to derive photo - z s for the galaxies of sdss - dr9 . however , this discrepancy is only apparent , by considering that the spectroscopic kb used in the cited work was much larger than the one used here ( @xmath27 training objects against only @xmath28 objects used for the training in this case ) .",
    "the decision of such limited sample used in the present experiment was induced by the different goal of the experiment .",
    "we performed a large number of experiments with mlpqna using @xmath29 photometric perturbations in order to find the best perturbation law .",
    "the most performing experiment turns out to be the one based on a bi - modal perturbation law with threshold @xmath30 and a multiplicative constant @xmath31 .",
    "this experiment leads to a stacked pdf with @xmath32 within @xmath33 $ ] , @xmath34 , @xmath35 of the objects falling within the peak of the pdf , @xmath36 falling within @xmath23 bin from the peak and @xmath37 falling within the pdf .    after having found the best perturbation law , we executed @xmath38 perturbations of the test set .",
    "this experiment led to an increase in the statistical performances , obtaining @xmath39 and @xmath40 within the peak of the pdf , @xmath41 within @xmath23 bin from the peak and @xmath42 inside the pdf .    the same configuration and perturbed data have been used to estimate photo - z s by replacing mlpqna with , respectively , the knn and random forest models within the metaphor workflow . in parallel",
    ", we derived also the photo - z pdf s with the _ le phare _ method .",
    "the statistical results for all these methods are summarized in table  [ tab : stackedstat ] .",
    ".statistical results of photo - z s and related pdf estimation on the blind test set extracted from sdss - dr9 , obtained by three machine learning models ( mlpqna , knn and random forest ) , alternately used as internal engine of metaphor and by the sed template fitting method _",
    "le phare_. the last three estimators are related to the cumulative pdf of the estimated photo - z s .",
    "see text for the explanation of the statistical estimators . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     although there is a great difference in terms of photo - z estimation statistics between _ le phare _ and mlpqna ( see table  [ tab : stackedstat ] ) , the results of the pdf in terms of @xmath15 are comparable .",
    "but the greater efficiency of mlpqna induces an improvement in the range within @xmath13 , where we find @xmath43 of the objects against the @xmath44 for _ le phare_. both individual and _ stacked _ pdf s are more symmetric in the case of empirical methods .",
    "this is particularly evident by observing the skewness ( see table [ tab : stackedstat ] ) , which is @xmath45 times greater in the case of _",
    "le phare_.    the presented photo - z estimation results and the statistical performance of the cumulative pdf s , achieved by mlpqna , rf and knn through the proposed workflow , demonstrate the validity and reliability of the metaphor strategy , despite its simplicity , as well as its general applicability to any other empirical method .",
    "mb and sc acknowledge financial contribution from the agreement asi / inaf i/023/12/1 .",
    "mb acknowledges the prin - inaf 2014 _ glittering kaleidoscopes in the sky : the multifaceted nature and role of galaxy clusters_. ct is supported through an nwo - vici grant ( project number @xmath46 ) .",
    "bonnet , c. , 2013 , mnras , 449 , 1 , 1043 - 1056 breiman , l. , 2001 , machine learning , springer eds . , 45 , 1 , 25 - 32 brescia m. , cavuoti s. , longo g. , et al .",
    ", 2014a , pasp , 126 , 942 , 783 - 797 brescia , m. , cavuoti , s. , longo , g. , de stefano , v. , 2014c , vizier on - line data catalog : j / a+a/568/a126 brescia m. , cavuoti s. , dabrusco r. , mercurio a. , longo g. , 2013 , apj , 772 , 140 byrd , r.h , nocedal , j. , and schnabel , r.b .",
    ", mathematical programming , 63 , 129 ( 1994 ) carrasco , k. , brunner , r.  j. , 2014 , mnras , 442 , 4 , 3380 - 3399 cavuoti , s. , brescia , m. , longo , g. , mercurio , a. , 2012 , a&a , 546 , 13 cavuoti s. ; brescia m. ; dabrusco r. ; longo g. & paolillo m. , 2014a , mnras 437 , 968 cavuoti , s. , brescia , m. , longo , g. , 2014b , proceedings of the iau symposium , vol . 306 , cambridge university press cavuoti , s. , brescia , m. , de stefano , v. , longo , g. , 2015b , experimental astronomy , springer , vol . 39 , issue 1 , 45 - 71 cover , t.  m. , hart , p.  e. , 1967 , ieee transactions on information theory 13 ( 1 ) ilbert , o. , arnouts , s. , mccracken , h.  j. , et al .",
    ", 2006 , a&a , 457 , 841 rau , m.  m. , seitz , s. , brimioulle , f. , et al .",
    ", 2015 , mnras , 452 , 4 , 3710 - 3725 sadeh , i. , abdalla , f.  b. , lahav , o. , 2015 , eprint arxiv:1507.00490 york , d.  g. , adelman , j. , anderson , j.  e. , et al . , 2000 ,",
    "aj , 120 , 1579"
  ],
  "abstract_text": [
    "<S> we present metaphor ( machine - learning estimation tool for accurate photometric redshifts ) , a method able to provide a reliable pdf for photometric galaxy redshifts estimated through empirical techniques . </S>",
    "<S> metaphor is a modular workflow , mainly based on the mlpqna neural network as internal engine to derive photometric galaxy redshifts , but giving the possibility to easily replace mlpqna with any other method to predict photo - z s and their pdf . </S>",
    "<S> we present here the results about a validation test of the workflow on the galaxies from sdss - dr9 , showing also the universality of the method by replacing mlpqna with knn and random forest models . the validation test include also a comparison with the pdf s derived from a traditional sed template fitting method ( le phare ) . </S>"
  ]
}