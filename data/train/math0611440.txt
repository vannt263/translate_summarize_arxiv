{
  "article_text": [
    "the @xmath0-index of a convex polytope @xmath1 is a polynomial @xmath2 in the non - commuting variables @xmath3 and @xmath4 that effectively encodes the flag @xmath5-vector of the polytope @xmath1  @xcite .",
    "its coefficients are non - negative integers  @xcite .",
    "the following result was proved in @xcite and used to study the monotonicity property of the @xmath0-index :    [ thm - be ] for any polytope @xmath1 and a proper face @xmath6 of the polytope @xmath1 the coefficientwise inequality @xmath7 holds , where @xmath8 is the pyramid over the polytope @xmath9 .",
    "[ theorem_billera_ehrenborg ]    by iterating this theorem it implies that among all polytopes of dimension @xmath10 the @xmath0-index is minimized by the @xmath10-dimensional simplex .",
    "one can define the @xmath0-index more generally for eulerian posets .",
    "it has non - negative coefficients if the poset is gorenstein *  @xcite .",
    "we generalize theorem  [ theorem_billera_ehrenborg ] to the case of gorenstein * lattices :    [ thm - main ] for any gorenstein * lattice @xmath11 and an element @xmath12 such that @xmath13 the coefficientwise inequality @xmath14 holds , where @xmath15 is the pyramid over the poset @xmath16 .",
    "the use of half - open intervals in the statement of the theorem is explained in the next section .",
    "considering the dual lattice @xmath17 , we obtain by duality @xmath18 the action of taking the pyramid of an eulerian poset on the @xmath0-index is described by the following linear map .",
    "let @xmath19 be a derivation on @xmath20 defined by @xmath21 and @xmath22 .",
    "next let @xmath23 be the operator on @xmath20 defined by @xmath24 .",
    "then the @xmath0-index of the pyramid is the pyramid of the @xmath0-index , that is , @xmath25 ; see  @xcite .    as an example , if @xmath11 is the face lattice of a plane @xmath10-gon and @xmath26 is a vertex , then the inequality of theorem  [ thm - main ] reads @xmath27 to see that the theorem does not extend to gorenstein * posets that are not lattices , take @xmath11 to be the poset of the plane @xmath28-gon , that is , the @xmath29-complex consisting of two edges glued at the two endpoints .",
    "the cells of this complex form a gorenstein * poset , but the inequality above with @xmath30 does not hold .    as a corollary to theorem  [ thm - main ]",
    "we settle a conjecture of stanley :    among all gorenstein * lattices the @xmath0-index is minimized by the boolean algebra .",
    "recall that to a polytope @xmath1 one can associate its @xmath31-polynomial @xmath32 and its @xmath33-polynomial @xmath34 .",
    "the inequality in theorem  [ thm - be ] was motivated by a similar inequality between the @xmath33-polynomials conjectured by kalai and proved in the case of rational polytopes by braden and macpherson @xcite .",
    "[ thm - bm ] for any rational polytope @xmath1 and a proper face @xmath6 of @xmath1 the following inequality holds coefficientwise : @xmath35    since @xmath36 , the two inequalities in theorems  [ thm - be ] and [ thm - bm ] can be made to look even more similar .",
    "theorem  [ thm - bm ] was generalized to the case of nonrational polytopes in @xcite , subject to the assumption that the @xmath33-polynomials involved are non - negative @xcite .",
    "this generalization is proved using a combinatorial decomposition theorem for pure sheaves on a fan : a pure ( i.e. , locally free and flabby ) sheaf on a fan decomposes into elementary sheaves . another consequence of this combinatorial decomposition theorem is the monotonicity of the @xmath31-vector under subdivisions : if @xmath37 is a subdivision of a complete fan @xmath38 then @xmath39 coefficientwise .",
    "we prove an analogous decomposition theorem for the @xmath0-index .",
    "a more precise statement is given in section  2 .",
    "[ thm - decomp ] let @xmath40 be a subdivision of a gorenstein * poset @xmath41 .",
    "then the following inequality holds coefficientwise : @xmath42    the crucial point in the last theorem is the correct definition of `` subdivision '' .",
    "it not only includes the usual subdivisions of polyhedral fans , but also more general subdivisions of @xmath29-complexes . with a correct notion of subdivision in place , theorem  [ thm - main ] follows from theorem  [ thm - decomp ] .",
    "the product of @xmath0-indices corresponds to the @xmath43-product of posets ( see section  [ subsec - lattices ] below for the definition of @xmath43-product ) : @xmath44 we show that the original lattice @xmath11 is a subdivision of @xmath45 and then apply theorem  [ thm - decomp ] .    for a polytope @xmath1 , the construction of @xmath46 is illustrated in figure  [ fig - pol ] . from the original polytope @xmath1 we keep all faces @xmath47 and @xmath48 .",
    "then for each @xmath49 we cap it off with a cell @xmath50 of one smaller dimension .",
    "the resulting @xmath29-complex corresponds to the poset @xmath46 and it admits ( the boundary complex of ) @xmath1 as its subdivision .    [ fig - pol ]",
    "we refer to @xcite for terminology about posets . throughout",
    "we only consider posets that are finite , graded , with minimal element @xmath51 , but with no maximal element @xmath52 in general .",
    "this is motivated by the poset of a fan : every fan has a minimal cone @xmath53 , but no maximal cone in general .",
    "the rank of an element @xmath54 is denoted by @xmath55 .",
    "if @xmath56 , then @xmath57 . we assume that the minimal element has rank @xmath58 and maximal elements have rank equal to the rank of the poset .    the closed ( resp .",
    "half - open ) intervals will be denoted @xmath59 $ ] ( resp .",
    "@xmath60 ) .",
    "if there is possibility of confusion , we write the poset @xmath41 as the subscript : @xmath59_\\pi$ ] .",
    "even though @xmath41 may not contain the maximal element @xmath52 , we write @xmath61 for all the elements greater than or equal to @xmath54 .",
    "if @xmath41 is a poset of rank @xmath10 , let @xmath62 be the order complex , that is , the set of chains in @xmath41 ordered by inclusion .",
    "@xmath63 then @xmath62 is again a poset of rank @xmath10 .",
    "in fact , @xmath62 is the face poset of a simplicial complex of dimension @xmath64 .",
    "( more precisely , the subsets of @xmath41 of the form @xmath65 , where @xmath66 form a simplicial complex . )",
    "if a poset @xmath41 is a lattice , then it obviously must have a maximal element @xmath52 .",
    "if @xmath41 does not contain @xmath52 , then by abuse of terminology we say that @xmath41 is a lattice of rank @xmath10 if @xmath67 is a lattice of rank @xmath68 .",
    "for instance , the simplicial complex @xmath62 is a lattice of rank @xmath10 for any poset @xmath41 of rank @xmath10 .",
    "a poset @xmath41 is eulerian if every interval satisfies the euler - poincar relation .",
    "equivalently , for any two elements @xmath69 , @xmath70 in the poset @xmath41 such that @xmath71 , we have @xmath72      [ def - gor ] a simplicial complex @xmath38 of dimension @xmath64 is called _ gorenstein _ if it is a real homology sphere of dimension @xmath64 .",
    "this means that :    * the reduced ( simplicial ) homology of @xmath38 is @xmath73 * for every simplex @xmath74 of dimension @xmath75 , the reduced homology of its link is @xmath76    a poset @xmath41 is called _ gorenstein * _ if its order complex @xmath62 is gorenstein .",
    "a simplicial complex @xmath38 is called cohen - macaulay if a similar condition holds , but the top degree cohomology is allowed to have any dimension . thus a simplicial complex is gorenstein if and only if it is cohen - macaulay and eulerian",
    ". a poset @xmath41 is called cohen - macaulay if its order complex @xmath62 is cohen - macaulay . since @xmath41 is eulerian if and only if @xmath62 is eulerian , it follows that a poset @xmath41 is gorenstein * if and only if it is cohen - macaulay and eulerian .",
    "recall that @xmath77 is isomorphic to the interval @xmath61 in @xmath38 .",
    "thus , denoting @xmath78 , we see that the first homology condition in the definition is the same as the second one applied to the element @xmath79 . also recall that the reduced simplicial homology of @xmath80 for @xmath54 of rank @xmath81 is computed by the simplicial chain complex @xmath82 the homology condition in the definition of gorenstein states that this sequence has only @xmath83-dimensional homology at the rightmost place .",
    "if @xmath41 is a gorenstein * poset of rank @xmath10 , then any interval @xmath84 in @xmath41 is again gorenstein*. indeed , given a chain @xmath85 , the interval @xmath61 in @xmath86 is isomorphic to the interval @xmath87 in @xmath62 for some @xmath88 . hence the homology condition for @xmath87 implies the same for @xmath61 .    given a gorenstein * poset @xmath41 , its dual poset @xmath89 ( obtained by reversing the order relations ) is again gorenstein*. this follows from the fact that the two posets have isomorphic order complexes .",
    "we also need the notion of a poset @xmath41 such that @xmath62 is a homology ball .",
    "if such an @xmath62 has dimension @xmath64 , then its boundary @xmath90 is a sub - complex of dimension @xmath91 . to define the analogue for arbitrary posets",
    ", we consider pairs @xmath92 , where    * @xmath41 is a poset of rank @xmath10 ; * @xmath93 is a sub - poset of @xmath41 of rank @xmath64 ( with elements in ranks @xmath64 or less ) ; * @xmath94 is an ideal in @xmath41 : if @xmath95 and @xmath96 , then @xmath97 .",
    "[ def - ngor ] a pair @xmath98 where @xmath38 is a simplicial complex of dimension @xmath64 is called _ near - gorenstein _",
    "if @xmath38 is a real homology ball of dimension @xmath64 with boundary  @xmath99 .",
    "this means that :    * the complex @xmath99 is gorenstein of dimension @xmath91 . * for every @xmath74 of dimension @xmath75 ( including @xmath79 of dimension @xmath100 ) , the reduced homology of its link is @xmath101    a pair @xmath92 is called _ near - gorenstein * _ if @xmath102 is near - gorenstein .",
    "it is clear that for a near - gorenstein * pair @xmath92 , the boundary @xmath94 is determined by @xmath41 .",
    "hence we may simply say that a poset @xmath41 is near - gorenstein*. similarly , we may call a simplicial complex @xmath38 near - gorenstein .",
    "we also denote @xmath103 .",
    "the terminology is motivated by stanley s notion of a near - eulerian poset @xcite , which is a poset obtained from an eulerian poset of rank @xmath10 by removing an element of rank @xmath10 .",
    "a similar result holds here :    [ lem - gor - near - gor ] let @xmath41 be a gorenstein * poset of rank @xmath10 and @xmath104 an element of rank @xmath105 . then @xmath106 is a near - gorenstein * poset of rank @xmath10 with boundary @xmath107 .",
    "conversely , every near - gorenstein * poset arises this way",
    ".    we will prove this lemma in section  [ section_sheaves ] .",
    "let us recall the combinatorial construction of the @xmath0-index of an eulerian poset .",
    "for a chain @xmath108 in a poset @xmath41 define the weight of the chain by @xmath109    here @xmath110 and @xmath111 are non - commuting variables of degree @xmath83 each .",
    "then the @xmath112-index of the poset @xmath41 is given by the sum @xmath113 where the sum ranges over all chains @xmath54 in the poset @xmath41 .",
    "when @xmath41 is eulerian , it follows from the relations in @xcite that @xmath114 can be expressed in terms of the variables @xmath115 and @xmath116 .",
    "the @xmath0-index of  @xmath41 is the polynomial @xmath114 written in terms of @xmath3 and @xmath4 . by a slight abuse of notation",
    "we denote the @xmath0-index of @xmath41 by @xmath117 .",
    "this notation may cause concern only when we talk about non - negativity of the @xmath0-index . by this",
    "we mean non - negativity of the coefficient of @xmath117 when expressed as a polynomial in @xmath3 and @xmath4 .",
    "( the coefficients of @xmath114 are always non - negative . )",
    "note that @xmath114 is homogeneous of degree  @xmath10 .",
    "the same is true for @xmath117 where @xmath3 has degree @xmath83 and @xmath4 has degree @xmath28 .",
    "the following non - negativity theorem proved in  @xcite by the second author generalizes stanley s result of the non - negativity for the @xmath0-index of @xmath118-shellable complexes  @xcite .",
    "[ thm - pos - cd ] the @xmath0-index of a gorenstein * poset has non - negative integer coefficients .",
    "one can also define the @xmath112-index of a near - gorenstein * poset @xmath41 using the same construction .",
    "this @xmath112-polynomial , however , can not be expressed in terms of @xmath3 and  @xmath4 .",
    "considering chains in the gorenstein * poset @xmath119 ( lemma  [ lem - gor - near - gor ] ) , it is easy to see that : @xmath120 where @xmath121 is a homogeneous @xmath112-polynomial that can be expressed in terms of @xmath3 and @xmath4 .",
    "let us omit the multiplication with @xmath110 at the end and define the @xmath0-index of @xmath41 to be @xmath122 where @xmath123 is the polynomial @xmath121 expressed in terms of @xmath3 and @xmath4 .",
    "note that the first summand is homogeneous of degree @xmath10 and the second summand is homogeneous of degree @xmath64 .",
    "the following theorem is stated in @xcite only for the case of fans .",
    "we give a generalization to the case of near - gorenstein * posets in the appendix .    [ thm - pos - cd - ngor ] the @xmath0-index of a near - gorenstein * poset has non - negative integer coefficients .",
    "let us now define the notion of a subdivision .",
    "[ def - subd ] let @xmath40 and @xmath41 be two gorenstein * posets of rank @xmath10 and let @xmath124 be a surjective map that preserves the order relation , but not necessarily the rank .",
    "then @xmath125 is a _ subdivision _ if for every @xmath126 the pair @xmath127 ,",
    "\\phi^{-1 } [ { { \\widehat{0}}},\\sigma))\\ ] ] is near - gorenstein * of rank equal to @xmath128 .    to simplify notation , let us write @xmath129 $ ] and @xmath130 .",
    "recall that by theorem  [ thm - pos - cd - ngor ] , the @xmath0-index @xmath131 has all non - negative coefficients .",
    "we can now state the decomposition theorem .",
    "[ thm - decomp - prec ] let @xmath132 be a subdivision map .",
    "then @xmath133    the proof of this theorem is almost entirely contained in @xcite .",
    "it relies on the theory of pure sheaves on fans and posets .",
    "since we will not use this theory elsewhere in this article , we will use the notation of the references above and sketch the proof .",
    "the category of pure sheaves ( i.e. , locally free and flabby sheaves ) on a fan @xmath38 is semisimple : any pure sheaf @xmath134 has a decomposition into a direct sum of simple sheaves @xmath135 indexed by cones @xmath136 : @xmath137 here @xmath138 is a graded vector space , @xmath139 since the map @xmath140 is surjective by purity of @xmath134 , we get an equality between the poincar polynomials of the graded vector spaces : @xmath141    it is shown in @xcite that one can define a similar theory of pure sheaves on an arbitrary poset @xmath41 , where the sheaves now are multi - graded by @xmath142 . if @xmath41 is gorenstein * or near - gorenstein * then the @xmath0-index of @xmath41 is obtained by a change of variable formula from the multi - variable poincar polynomial of the module of global sections of @xmath143 . for @xmath144 , the sheaf @xmath135",
    "similarly gives the @xmath0-index of @xmath145 .    if @xmath146 is a subdivision map , we can decompose @xmath147 here @xmath148 its multi - variable poincar polynomial is @xmath149 where the middle equality comes from equation  ( [ eq - sigma ] ) . now",
    "the formula in the theorem follows by taking the poincar polynomials of the modules of global sections on both sides of the decomposition .",
    "note that all of the terms in the sum of theorem  [ thm - decomp - prec ] are non - negative . since @xmath150 , we obtain theorem  [ thm - decomp ] as a corollary .",
    "let us now deduce theorem  [ thm - main ] from theorem  [ thm - decomp ] . to do this , we construct a subdivision map @xmath151 .",
    "given two posets @xmath41 and @xmath11 , define @xmath152 with order relations those of @xmath41 and @xmath11 , and additionally @xmath153 for any @xmath126 and @xmath154 .",
    "if @xmath41 and @xmath11 have ranks @xmath75 and @xmath10 , respectively , then @xmath155 has rank @xmath156 .",
    "the order poset @xmath157 is the product @xmath158 .",
    "it follows that if @xmath41 and @xmath11 are both gorenstein * , then so is @xmath155 .",
    "also , if @xmath41 is gorenstein * and @xmath11 is near - gorenstein * , then @xmath159 is near - gorenstein*. these two properties follow by considering tensor products of the chain complexes of @xmath62 and @xmath160 .",
    "moreover , the @xmath0-index turns the @xmath43-product into multiplication  @xcite : @xmath161    the pyramid operation of a poset containing the maximal element @xmath52 is defined as the cartesian product with the boolean algebra @xmath162 .",
    "that is , for our poset @xmath41 we have that @xmath163 .",
    "let @xmath1 and @xmath164 be two posets both containing maximal elements .",
    "directly we have that if both @xmath1 and @xmath164 are eulerian so is their cartesian product @xmath165 .",
    "similarly , if both @xmath1 and @xmath164 are cohen - macaulay posets it follows from ( * ? ? ?",
    "* theorem  7.1 ) that their product @xmath165 is cohen - macaulay .",
    "hence the class of gorenstein * posets are closed under cartesian product and we conclude that :    let @xmath41 be a gorenstein * poset of rank @xmath10 .",
    "then @xmath166 is a gorenstein * poset of rank @xmath68 .    with notation as in theorem  [ thm - main ] ,",
    "let @xmath11 be a gorenstein * lattice and @xmath167 , @xmath168 .",
    "define the map @xmath169 as follows : @xmath170    note that @xmath171 can be equal to @xmath52 . in figure  [ fig - pol ]",
    "the cells @xmath19 and @xmath50 correspond to elements @xmath172 and @xmath173 , and the cell @xmath174 corresponds to @xmath175 .",
    "we claim that @xmath125 is a subdivision map . the map @xmath125 clearly preserves the order relation . to prove surjectivity of @xmath125 , the only nontrivial case is to show that @xmath176 lies in the image for @xmath177 . replacing @xmath11 by the interval @xmath178 , we need to show that for some @xmath154 , we have @xmath179 .",
    "if no such @xmath69 exists , then every maximal element of @xmath11 lies in @xmath16 . by descending induction on the rank of an element , and using that the lattice is eulerian",
    ", it follows that every element must lie in @xmath16 .",
    "this gives a contradiction .",
    "finally , we need to check that the inverse images @xmath180 are near - gorenstein * in the three cases :    1",
    ".   if @xmath181 , then @xmath182,[{{\\widehat{0}}},\\tau)).\\ ] ] let @xmath41 be the gorenstein * poset @xmath183 .",
    "we need to show that @xmath67 is near - gorenstein * with boundary @xmath41 .",
    "if @xmath184 , then we have as in the previous case @xmath182,[{{\\widehat{0}}},\\tau)).\\ ] ] 3 .",
    "if @xmath185 , then @xmath186 with boundary @xmath187 let @xmath41 be the gorenstein * lattice @xmath188 containing @xmath26 ( recall that by this we mean @xmath67 is a lattice ) . then we need to show that @xmath189 is near - gorenstein * with boundary @xmath190    we state what is left to prove in the following two lemmas .",
    "[ lem - add - one ] let @xmath41 be a gorenstein * poset of rank @xmath10 . then @xmath67 is a near - gorenstein * poset of rank @xmath68 with boundary @xmath41 .    note that @xmath67 is the @xmath43-product @xmath191 , where @xmath192 is near - gorenstein * with boundary @xmath193 .",
    "this implies the statement of the lemma .",
    "[ lem - main ] let @xmath11 be a gorenstein * lattice of rank @xmath10 and @xmath194 .",
    "then @xmath195 is near - gorenstein * of rank @xmath10 with boundary @xmath196    we will prove this lemma in section  [ section_sheaves ] .    as a final remark in this section , observe that we used the join operation @xmath197 in the lattice , but not the meet operation @xmath198 .",
    "it is enough to do this since a finite join - semilattice with a minimal element @xmath51 is a lattice ; see  ( * ? ? ?",
    "* proposition  3.3.1 ) .",
    "in this section we consider eulerian posets and lattices that are not necessarily gorenstein*. by flag enumeration we are still able to derive identities for their @xmath0-indexes .    for an eulerian lattice @xmath11 with an element @xmath26 such that @xmath13 define the two subposets @xmath199 and @xmath200 of the lattice @xmath11 as follows .",
    "let @xmath201 where @xmath199 inherits the order relations from @xmath11 , and let @xmath200 be the semisuspension of  @xmath199 , that is , @xmath202 where the new element @xmath43 satisfies the order relation @xmath203 for all @xmath204 such that @xmath205 .",
    "the geometric intuition for the poset @xmath199 is that it is the near - eulerian poset consisting of all faces contained in facets which contain the face @xmath26 .",
    "if @xmath11 is gorenstein * , then we will show in section  [ section_sheaves ] that @xmath206 is near - gorenstein*. in fact , the posets @xmath207 of lemma  [ lem - main ] and @xmath199 are complementary in that the lattice @xmath11 is obtained by gluing the two posets along their common boundary .",
    "the @xmath112-index of the poset @xmath199 is given by @xmath208 [ proposition_lambda_nu ]    for @xmath70 in the half open interval @xmath16 , let @xmath209 be the sum of the weights @xmath210 of all chains @xmath211 such that @xmath212 . observe that @xmath213 note that @xmath214 is the result which records if the chain @xmath54 contains @xmath70 or not .",
    "multiply by @xmath215 and sum over all @xmath216 $ ] .",
    "@xmath217 now the @xmath112-index of @xmath199 is given by the sum @xmath218 which proves the proposition .",
    "the sum of the weights of all chains @xmath54 in @xmath200 that contain the element @xmath43 is given by @xmath219 [ proposition_lambda_nu_star ]    assume that @xmath200 has rank @xmath10 and let @xmath1 be the poset @xmath200 with the coatoms removed .",
    "the poset @xmath1 can be thought of as the rank selected poset @xmath220 .",
    "observe that the rank of @xmath1 is one less than the rank of @xmath200 .",
    "however we let @xmath221 denote the rank function of @xmath200 and not that of @xmath1 .    for @xmath70 in the poset",
    "@xmath1 such that @xmath222 , let @xmath223 be the sum of the weights over all chains @xmath211 in the poset @xmath1 such that @xmath224 and @xmath212 .",
    "similarly , let @xmath225 be the sum of the weights over all chains @xmath54 in the poset @xmath1 such that @xmath212 .",
    "observe that @xmath226 , where @xmath209 is the function in the proof of proposition  [ proposition_lambda_nu ] .",
    "hence by equation  ( [ equation_f ] ) we have that @xmath227    now by chain counting we have the identity @xmath228 bring @xmath223 to the other side of the equation and sum over all @xmath70 such that @xmath222 .",
    "we then obtain @xmath229 making a change of variable in the last sum and rearranging the sums gives : @xmath230 the result now follows by multiplying on the right by @xmath111 .    following  @xcite",
    "define @xmath0-polynomials @xmath231 by @xmath232 and otherwise by @xmath233 , \\\\",
    "\\alpha_{2k+1 }      & = &       \\frac{1}{2 } \\left [ ( { { \\bf c}}^2 - 2{{\\bf d}})^{k } \\cdot { { \\bf c}}+       { { \\bf c}}\\cdot ( { { \\bf c}}^2 - 2{{\\bf d}})^{k } \\right ] ,   \\end{aligned}\\ ] ]    the @xmath0-polynomial @xmath234 is given by @xmath235 [ lemma_alpha ]    when @xmath81 is even we have @xmath236 for the odd case , begin by observing that @xmath237 . by rearranging the terms we have @xmath238 since the two sides are equal , they are also equal to their mean value .",
    "thus we have @xmath239    we can now give an explicit formula for the @xmath0-index of the poset @xmath200 .",
    "this formula generalizes corollary  4.4 in  @xcite .",
    "this corollary was proved using line shellings , thus restricting the results in  @xcite to polytopes .    for an eulerian lattice @xmath11 and an element @xmath26 , @xmath13 ,",
    "the @xmath0-index of @xmath200 is given by @xmath240 [ theorem_lambda_nu_prime ]    add propositions  [ proposition_lambda_nu ] and  [ proposition_lambda_nu_star ] using lemma  [ lemma_alpha ] to simplify .",
    "we now outline a different proof of theorem  [ thm - main ] following the argument of the polytope case in  @xcite .",
    "first observe that we have the following corollary to the decomposition theorem , theorem  [ thm - decomp ] .",
    "let @xmath11 be a gorenstein * lattice and let @xmath26 be an element of @xmath11 such that @xmath13 .",
    "then the following coefficientwise inequality holds for the @xmath0-indexes of @xmath200 and @xmath11 : @xmath241 [ corollary_inequality ]    the poset @xmath11 is a subdivision of @xmath200 by the map @xmath242 defined by @xmath243 the map @xmath125 collapses everything outside @xmath199 to the element @xmath43 .",
    "we only have to check that the inverse image of the element @xmath244 $ ] is a near gorenstein * poset . but",
    "this is the content of lemma  [ lem - main ] and the corollary follows from theorem  [ thm - decomp ] , the decomposition theorem .",
    "theorem  [ thm - main ] is implied by the following three statements : ( 1 ) theorem  [ theorem_lambda_nu_prime ] , ( 2 ) the inequality in corollary  [ corollary_inequality ] , and ( 3 ) the equality  ( * ? ? ?",
    "* proposition  4.6 ) : @xmath245 where @xmath246 $ ] is an interval in an eulerian poset .",
    "the proof is verbatim to the proof of theorem  5.1 in  @xcite .",
    "in this section we introduce sheaves on posets and prove lemmas  [ lem - gor - near - gor ] and  [ lem - main ] .    a _ sheaf _",
    "@xmath6 on a poset @xmath41 consists of the data    * a real vector space @xmath247 for each @xmath126 , called the stalk of @xmath6 at @xmath248 . *",
    "linear maps @xmath249 for each @xmath250 , satisfying the condition @xmath251 whenever @xmath252 .",
    "these maps are called restriction maps .",
    "a _ map _ of sheaves @xmath253 is a collection of linear maps @xmath254 commuting with the restriction maps .",
    "the main example of a sheaf is the constant sheaf @xmath255 with all the stalks equal to @xmath256 and all the restriction maps equal to the identity . if @xmath6 is a sheaf on @xmath41 and @xmath257 , we let @xmath258 ( or simply @xmath259 ) be the sheaf obtained from @xmath6 by setting all stalks at elements @xmath260 equal to zero .",
    "this makes sense for subsets @xmath118 satisfying the property that if @xmath96 both lie in @xmath118 , then the interval @xmath261 $ ] also lies in @xmath118 .    for the remainder of this section we consider sheaves on simplicial complexes only .",
    "all sheaves are assumed to have finite dimensional stalks .",
    "let @xmath38 be a simplicial complex of rank @xmath10 and @xmath6 a sheaf on @xmath38 .",
    "the _ cellular complex _",
    "@xmath262 of @xmath6 is the complex @xmath263 where @xmath264 the maps @xmath265 are defined by summing the restriction maps @xmath266 with correct sign as in the simplicial chain complex of @xmath38 .",
    "if @xmath267 is a subset , we write @xmath268 for the complex @xmath269 . in other words , the terms in the complex @xmath268 are indexed by elements of @xmath118 .",
    "note that if @xmath270 is the constant sheaf , then @xmath271 is the simplicial chain complex of @xmath38 . in particular , @xmath272 recalling definition  [ def - gor ] , we have that @xmath38 is gorenstein if and only if @xmath273 for all @xmath74 .",
    "[ def - gor - sheaf ] a sheaf @xmath6 on @xmath38 is called _ cohen - macaulay _ if @xmath274 for all @xmath74 and @xmath275 .",
    "@xmath6 is called _ gorenstein _ if , moreover , @xmath276    thus , the complex @xmath38 is gorenstein if and only if the constant sheaf on it is gorenstein .",
    "the definition of a cohen - macaulay complex @xcite similarly agrees with the notion of a cohen - macaulay sheaf . in @xcite",
    "cohen - macaulay sheaves were called semi - gorenstein , but cohen - macaulay is a more appropriate name .",
    "let @xmath6 be a cohen - macaulay sheaf on @xmath38 .",
    "for any @xmath56 we can use projection maps to define a map of sheaves @xmath277 .",
    "this induces a map of cellular complexes , hence a map in cohomology : @xmath278 we want to assemble the degree zero cohomologies into a sheaf on @xmath38 .",
    "however , the maps ( [ eq - proj ] ) go in the wrong direction compared to restriction maps . to fix this , we take the dual vector spaces and dual maps .",
    "let @xmath6 be a cohen - macaulay sheaf on @xmath38 .",
    "define the sheaf @xmath279 on @xmath38 with the stalks @xmath280 and with the restriction maps being the duals of ( [ eq - proj ] ) .",
    "it is shown in @xcite that the assignment @xmath281 defines a contravariant functor from the category of cohen - macaulay sheaves to the same category .",
    "in particular , @xmath279 is again cohen - macaulay .",
    "moreover , @xmath282 canonically .    consider a short - exact sequence of sheaves on @xmath38 : @xmath283 from the long - exact sequences in cohomology it follows that if either @xmath284 and @xmath285 or @xmath284 and @xmath286 are cohen - macaulay , then so is the third sheaf and we get the short - exact dual sequence @xmath287 if both @xmath285 and @xmath286 are cohen - macaulay , then @xmath284 is cohen - macaulay if and only if the dual map @xmath288 is injective .",
    "suppose that in the exact sequence above both @xmath285 and @xmath286 are cohen - macaulay and @xmath284 is supported on a subcomplex @xmath289 of rank @xmath64 .",
    "then @xmath284 is cohen - macaulay as a sheaf on @xmath99 and we have the dual short exact sequence @xmath290 here @xmath291 is computed by considering @xmath284 as a sheaf on @xmath99 , hence on @xmath38 the stalks of the dual sheaf are obtained from cohomology of degree @xmath83 rather than degree @xmath292",
    ".    we can now give a stronger characterization of gorenstein and near - gorenstein complexes on @xmath38 .",
    "[ lem - gor - sheaf ] a simplicial complex @xmath38 is gorenstein if and only if @xmath293 is cohen - macaulay and @xmath294    note that by definition  [ def - gor ] the complex @xmath38 is gorenstein if and only if it is cohen - macaulay and @xmath295 has one - dimensional stalks .",
    "we need to show that the restriction maps in the dual sheaf are all isomorphisms .",
    "then via @xmath296 all stalks are compatibly isomorphic to @xmath297 .",
    "decompose @xmath298 , where @xmath299 then all the restriction maps in @xmath295 between stalks at points lying in different sets @xmath300 and @xmath301 are zero .",
    "hence @xmath302 but then computing the dual @xmath303 , we see that it decomposes , which is impossible because all the restriction maps in @xmath293 are the identity maps .",
    "hence @xmath304 .",
    "[ lem - ngor - sheaf ] let @xmath38 be a simplicial complex of rank @xmath10 and @xmath305 a subcomplex of rank @xmath64 .",
    "then @xmath38 is near - gorenstein with boundary @xmath99 if and only if @xmath293 is cohen - macaulay and @xmath306 where @xmath307 .",
    "first we assume that the conditions given in the lemma are satisfied and show that then @xmath38 is near - gorenstein with the given boundary . to see that @xmath99 is gorenstein of rank @xmath64 , consider the exact sequence of sheaves @xmath308 since @xmath293 and @xmath309 are both cohen - macaulay ( they are dual to each other by assumption ) , and @xmath310",
    "is supported on the rank @xmath64 subcomplex @xmath99 , we get the dual sequence ( [ eq - dual ] ) @xmath311 it follows that @xmath312 and @xmath99 is gorenstein by the previous lemma .",
    "the remaining homology conditions of definition  [ def - ngor ] follow from the isomorphism @xmath313 .    conversely , let us assume that @xmath38 is near - gorenstein with boundary @xmath99 .",
    "then @xmath293 and @xmath310 are cohen - macaulay , hence so is @xmath309 by the exact sequence ( [ eq - sgor ] ) above .",
    "the dual sequence is @xmath314 the sheaf @xmath295 has the same stalks as @xmath309 , hence @xmath315 has the same stalks as  @xmath293 .",
    "it suffices to prove that @xmath316 .    as in the proof of the previous lemma , if @xmath315 is not isomorphic to @xmath293 ,",
    "then it decomposes , and so does @xmath309 by duality . since all the restriction maps in @xmath309 are identity maps , it follows that the poset @xmath317 decomposes into a disjoint union ( of unrelated elements ) .",
    "but then any sheaf on @xmath317 , including @xmath295 , also decomposes accordingly , which by duality implies that @xmath293 decomposes .",
    "this is a contradiction .",
    "given a poset @xmath41 containing a pair @xmath318 , define the complementary pair @xmath319 by @xmath320 , and @xmath321 .",
    "let @xmath38 be a gorenstein simplicial complex of rank @xmath10 and @xmath322 a near - gorenstein subcomplex of the same rank and with boundary @xmath323 .",
    "then the complementary pair @xmath324 is also near - gorenstein of rank @xmath10 .",
    "consider the exact sequence of sheaves @xmath325 since the left two sheaves are cohen - macaulay , so is the rightmost sheaf .",
    "the dual sequence is @xmath326 it follows that @xmath327 and @xmath328 is near - gorenstein with boundary @xmath329 .",
    "given an arbitrary poset @xmath41 containing a pair @xmath318 , with the complementary pair @xmath330 , we want to assume that taking the order complexes of @xmath331 and @xmath332 , we again get complementary pairs .",
    "for this it is sufficient that @xmath331 is closed under going down : if @xmath333 then @xmath334\\subset \\pi_1 $ ] and @xmath335 is closed under going up : if @xmath336 then @xmath337 . if @xmath331 satisfies these conditions , then @xmath332 also does .",
    "when considering complementary pairs , we will always assume that one pair ( hence also the other ) satisfies these conditions .",
    "let @xmath41 be a gorenstein * poset of rank @xmath10 and @xmath331 a near - gorenstein * sub - poset of the same rank and with boundary @xmath94 .",
    "then the complementary pair @xmath330 is also near - gorenstein * of rank @xmath10 .",
    "let us now prove lemma  [ lem - gor - near - gor ] .",
    "the poset @xmath106 is the complement of @xmath338 $ ] with boundary @xmath107 .",
    "this latter pair is near - gorenstein * by lemma  [ lem - add - one ] , hence so is @xmath106 .",
    "for the second statement of the lemma , suppose that @xmath106 is near - gorenstein * with boundary @xmath107 .",
    "divide @xmath339 into @xmath340 and its complement @xmath341)$ ] .",
    "then both @xmath322 and @xmath328 are near - gorenstein , hence we have an exact sequence of cohen - macaulay sheaves @xmath342 with dual sequence @xmath343 it follows that @xmath295 has all stalks one - dimensional , hence @xmath38 is gorenstein by definition  [ def - gor ] .",
    "let us now prove lemma  [ lem - main ] .",
    "we need to show that for a gorenstein * lattice @xmath11 and a nonzero element @xmath167 , the poset @xmath344 is near - gorenstein * with boundary @xmath345    let @xmath346 be the complementary pair .",
    "then @xmath347 .",
    "we also denote the corresponding order complexes @xmath348 , @xmath349 , @xmath350 , @xmath351 .",
    "consider the exact sequence .",
    "@xmath352 suppose we know that @xmath353 is cohen - macaulay , with the dual sheaf @xmath354 having the same stalks as @xmath355 , and that the dual map @xmath356 is injective .",
    "then all three sheaves are cohen - macaulay and we get the dual exact sequence @xmath357 the sheaf @xmath354 being a subsheaf of the constant sheaf must be the constant sheaf  @xmath355 .",
    "it follows from this that both @xmath322 and @xmath328 are near - gorenstein , hence @xmath358 and @xmath359 are near - gorenstein*.    let us take @xmath360 .",
    "we need to show that the stalk @xmath361 is well - defined ( no higher cohomology in the cellular complex ) , one - dimensional , and that it injects into @xmath362 by the map @xmath363 .",
    "first consider the case when @xmath364 .",
    "then the entire interval @xmath61 in @xmath38 lies in @xmath365 .",
    "the two complexes that compute the stalks of @xmath366 and @xmath361 are equal , with the map between them being the identity .",
    "second consider the case when @xmath367 .",
    "then @xmath54 is a chain @xmath368 where @xmath369 , @xmath370 for all @xmath371 .",
    "let @xmath372 an element of @xmath41 is a refinement of @xmath54 that contains at least one @xmath373 .",
    "such a @xmath69 must necessarily satisfy @xmath374 .",
    "if we let @xmath375 , then we have @xmath376    it remains to prove the cellular complex of @xmath255 has one - dimensional cohomology in degree @xmath292 and that the projection map @xmath377 induces a surjection in the cohomology .",
    "consider the complex of sheaves indexed by chains in @xmath118 where the maps are the projections with @xmath378 signs : @xmath379 we claim that this gives a resolution of @xmath255 . indeed ,",
    "if @xmath380 is a chain that contains @xmath381 , where @xmath382 , then the stalk of this complex at @xmath70 is indexed by subsets of @xmath383 , hence is acyclic .    we can compute the cellular cohomology of @xmath255 by a spectral sequence , where we first compute the cellular cohomology of each sheaf in the resolution .",
    "all sheaves in the complex have only degree zero cohomology of dimension one because @xmath38 is gorenstein .",
    "this implies that the cellular cohomology of @xmath255 is computed by the complex @xmath384 note that if we indexed the terms in this complex by chains @xmath385 , where @xmath386 is strictly greater than @xmath387 , then we would get the cellular complex of @xmath388 .",
    "since we also allow @xmath389 , we get the cellular complex of @xmath390 but without the minimal element @xmath51 .",
    "the cellular complex of the product is acyclic and the missing minimal element gives us that the the degree zero cohomology of the cellular complex of @xmath255 has dimension one .    to see that we have surjectivity of @xmath391 note that we can make the complex ( [ eq - cohom ] )",
    "exact by extending it from the left by @xmath392 which comes from extending the complex of sheaves @xmath393    this finishes the proof of lemma  [ lem - main ] and theorem  [ thm - main ] .",
    "the purpose of this appendix is to prove non - negativity of the @xmath0-index for gorenstein * and near - gorenstein * posets ( theorem  [ thm - pos - cd ] and  [ thm - pos - cd - ngor ] ) .",
    "the two theorems are proved in @xcite for complete and quasi - convex fans , while the generalization to gorenstein * posets is left largely to the reader .",
    "we give the necessary details here .",
    "we start by recalling another construction of the @xmath0-index in terms of two operations @xmath394 and @xmath395 on cohen - macaulay sheaves on a poset @xmath41 .",
    "let @xmath41 be a rank @xmath10 poset and @xmath62 its order complex .",
    "define the map of posets : @xmath396 if @xmath6 is a sheaf on @xmath41 , the pullback @xmath397 is a sheaf on @xmath62 with stalks @xmath398 and the obvious restriction maps .",
    "let @xmath6 be a sheaf on @xmath41 with finite dimensional stalks .",
    "we define the @xmath112-index of  @xmath6 as follows ( recall the definition of @xmath210 in section  [ sec - cd - index ] ) : @xmath399 if this polynomial can be written in terms of variables @xmath115 and @xmath116 , then we call the resulting @xmath0-polynomial the @xmath0-index of the sheaf @xmath6",
    ". it often happens that the @xmath112-index can be expressed only in the form @xmath400 where @xmath5 and @xmath33 are homogeneous @xmath0-polynomials of degree @xmath10 and @xmath64 , respectively .",
    "next we recall the proof of non - negativity of the @xmath0-index in case of fans . for",
    "fans one can define the cellular complex of a sheaf as in the case of simplicial complexes . with the cellular complex one",
    "gets the notion of cohen - macaulay sheaves and duality .",
    "let @xmath41 be the poset of an @xmath10-dimensional but not necessarily complete fan and @xmath6 a cohen - macaulay sheaf on @xmath41 .",
    "we define two operations @xmath394 and @xmath395 that each produce another cohen - macaulay sheaf on @xmath401- and @xmath402-dimensional fans , respectively .",
    "the sheaf @xmath403 is simply the restriction of @xmath6 to the @xmath401-skeleton @xmath404 of @xmath41 .",
    "it is a cohen - macaulay sheaf on @xmath404 .",
    "the sheaf @xmath405 is defined by choosing a surjective map @xmath406 and setting @xmath405 equal to the kernel of @xmath363 . since @xmath407 and @xmath408 have isomorphic stalks on cones of maximal dimension @xmath64 , it follows that @xmath405 is a sheaf on the @xmath402-skeleton of @xmath41 . from the short - exact sequence of sheaves we get",
    "that @xmath405 is a cohen - macaulay sheaf on @xmath409 .    since both @xmath394 and @xmath395 produce cohen - macaulay sheaves , we can compose them .",
    "if @xmath410 is a monomial in @xmath3 and @xmath4 of degree @xmath75 , then applying @xmath411 to the sheaf @xmath6 , we get a sheaf on the @xmath412-skeleton of @xmath41 . in particular ,",
    "if @xmath413 , then @xmath414 is a sheaf on the zero cone .",
    "the following is the most general positivity result proved in @xcite :    let @xmath41 be an @xmath10-dimensional fan and @xmath6 a cohen - macaulay sheaf on  @xmath41 , such that the @xmath112-index of @xmath6 can be expressed in the form @xmath415 for any @xmath0-monomial @xmath410 of degree @xmath10 , the coefficient of @xmath416 in @xmath417 is equal to the dimension of the stalk @xmath418 in particular , @xmath417 has non - negative integer coefficients .    applying this theorem to the constant sheaf @xmath255 on a complete or quasi - convex fan gives the non - negativity of the @xmath0-index .",
    "if , instead of sheaves on @xmath41 , we work with the dimensions of the stalks of such sheaves , then the operations @xmath394 and @xmath395 give a method for computing the coefficients of the @xmath0-index .",
    "it is clear that the same method then works for an arbitrary eulerian poset .",
    "however , we need sheaves to show non - negativity of the @xmath0-index .    for an arbitrary poset ,",
    "the main difficulty in extending the operations @xmath394 and @xmath395 above lies in the definition of the cellular complex and hence the dual sheaf .",
    "recall that the maps in the cellular complex are the restrictions with appropriate signs . in the case of fans one",
    "gets a compatible set of signs by orienting each cone and setting the signs equal to @xmath419 depending on the orientations . for an arbitrary poset",
    ", there may not exist such a compatible set of orientations .",
    "thus , we have to do all computations involving cellular complexes on the order complex @xmath62 .    for the rest of this appendix , let @xmath41 be a poset of rank @xmath10 .",
    "@xmath41 need not be gorenstein*. however , we require that for any @xmath126 the subposet @xmath420 must be gorenstein*. the only case we will need is when @xmath41 is the @xmath10-skeleton of a gorenstein * poset of rank @xmath421 .",
    "a sheaf @xmath6 on  @xmath41 is _ cohen - macaulay _",
    "if @xmath397 is cohen - macaulay on @xmath62 .",
    "[ lem - pull - back ] let @xmath6 be a cohen - macaulay sheaf on @xmath41 .",
    "then there exists a cohen - macaulay sheaf @xmath279 on @xmath41 such that @xmath422    for @xmath423 , consider the fiber @xmath424 .",
    "this subposet of @xmath62 has the minimal element @xmath425 .",
    "we show that for any @xmath426 , the restriction map in the dual sheaf @xmath427 is an isomorphism .",
    "we can then define @xmath428 and restriction maps for @xmath250 @xmath429 these maps are compatible and define the sheaf @xmath279 .",
    "it is also easy to check that this @xmath279 satisfies the isomorphism in the statement of the lemma .    to prove the isomorphism ( [ eq - const ] ) , note that the stalks of the dual sheaf are computed by the cellular complexes over the intervals @xmath87 and @xmath61 , respectively .",
    "we write @xmath61 as a product of two posets @xmath430 where @xmath431 consists of all refinements of the chain @xmath54 with last element @xmath248 and @xmath432 consists of all the chains between @xmath248 and @xmath52 .",
    "similarly , write @xmath433 since the index set of each cellular complex is a product of two posets , we can write the complex as a double complex and compute its cohomology first along rows and then along columns . thus , we have two double complexes and a map between them . for a fixed @xmath434 , the rows of the double complexes indexed by @xmath431 and @xmath435 , respectively , are the cellular complexes computing the dual of the constant sheaf with stalk @xmath436 on the poset @xmath437 . by lemma",
    "[ lem - gor - sheaf ] , these two complexes have only degree zero cohomology isomorphic to @xmath436 and the map between the complexes induces an isomorphism of cohomologies .",
    "thus , after taking cohomology along rows , we get two isomorphic complexes , indexed by the same set  @xmath432 . clearly , the cohomologies of these complexes are also isomorphic .",
    "( 1 ) observe that there is no choice involved in the definition of @xmath279 given in the proof of lemma  [ lem - pull - back ] .",
    "in particular , @xmath281 is a contravariant functor on the category of cohen - macaulay sheaves on @xmath41 .",
    "+ ( 2 ) it is easy to check that @xmath438 thus , at least numerically , we can think of @xmath279 as computed by a cellular complex on @xmath41 , similarly to the case of fans .",
    "let us now turn to the construction of the operations @xmath394 and @xmath395 .",
    "for @xmath6 a sheaf on  @xmath41 , let @xmath403 be its restriction to the @xmath401-skeleton of @xmath41 .    if @xmath6 is a cohen - macaulay sheaf on @xmath41 , then @xmath403 is cohen - macaulay on @xmath404 .",
    "on @xmath41 we have an exact sequence of sheaves @xmath439 where @xmath247 is the constant sheaf with stalk @xmath247 supported on a single element @xmath248 .",
    "the pullback of this sequence to @xmath62 is also exact .",
    "now @xmath397 is cohen - macaulay on @xmath62 by assumption .",
    "each sheaf @xmath440 is a constant sheaf on @xmath441 .",
    "since this subposet of @xmath62 is gorenstein , the constant sheaf is cohen - macaulay .",
    "from the exact sequence we get that @xmath403 is cohen - macaulay on @xmath404 .",
    "to define the sheaf @xmath405 , we find a surjective map @xmath442 and set @xmath405 equal to its kernel . since @xmath363 is surjective , @xmath405 is a cohen - macaulay sheaf on the @xmath402-skeleton of @xmath41 .",
    "the construction of @xmath363 proceeds as in the case of fans in @xcite .",
    "let @xmath126 be an element of rank @xmath10 and @xmath443 a section .",
    "then @xmath5 defines a map of sheaves @xmath444 } & { \\longrightarrow}f \\\\",
    "1_\\sigma & \\longmapsto f_\\sigma .",
    "\\end{aligned}\\ ] ] restricting to the @xmath401-skeleton of @xmath41 we get a map @xmath445 we claim that @xmath446 is a cohen - macaulay sheaf on @xmath404 with an isomorphism @xmath447 indeed , the pullback of @xmath446 to @xmath62 is the constant sheaf on @xmath448 and the poset @xmath420 is gorenstein*.    since the duality is functorial , we get for each @xmath449 a map @xmath450 we claim that a zariski general linear combination of @xmath451 ( over all @xmath248 and a basis of sections @xmath449 ) is a surjective map @xmath363 . for cohen - macaulay sheaves , it suffices to check surjectivity on maximal elements of the poset only . on an element @xmath69 of rank @xmath64 ,",
    "the map @xmath363 is a composition @xmath452 since the rightmost map @xmath125 is surjective , it is clear that for a general diagonal map @xmath453 , the composition is also surjective .    from these two operations",
    "@xmath394 and @xmath395 we get as in the case of fans :    let @xmath41 be a rank @xmath10 poset such that for every @xmath126 the interval @xmath420 is gorenstein*. let @xmath6 be a cohen - macaulay sheaf on  @xmath41 such that its @xmath112-index can be expressed in the form @xmath415 then for any @xmath0-monomial @xmath410 of degree @xmath10 , the coefficient of @xmath416 in @xmath417 is equal to the dimension of the stalk @xmath418 in particular , @xmath417 has non - negative integer coefficients .    applying this theorem to the constant sheaf @xmath255 on a gorenstein * poset @xmath41 gives theorem  [ thm - pos - cd ] . to prove theorem  [ thm - pos - cd - ngor ]",
    ", we first apply the theorem to the constant sheaf @xmath255 on a near - gorenstein * poset @xmath41 to get non - negativity of @xmath123 ; since @xmath94 is gorenstein * , non - negativity of @xmath454 follows as before .",
    "the first author thanks mittag - leffler institute where part of this research was carried out .",
    "he was also supported by nsf grant dms-0200624 .",
    "the second author was supported by nserc grant rgpin 283301 ."
  ],
  "abstract_text": [
    "<S> we prove a decomposition theorem for the @xmath0-index of a gorenstein * poset analogous to the decomposition theorem for the intersection cohomology of a toric variety . from this </S>",
    "<S> we settle a conjecture of stanley that the @xmath0-index of gorenstein * lattices is minimized on boolean algebras . </S>"
  ]
}