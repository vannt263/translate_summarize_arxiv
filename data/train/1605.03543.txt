{
  "article_text": [
    "given a c*-correspondence @xmath2 , the operator algebras associated to shift operators ( also called creation operators ) over the fock correspondence @xmath3 have been the subject of considerable attention by too many researchers to appropriately list here . by an _ operator algebra _ in this paper we mean a ( not necessarily self - adjoint ) closed unital subalgebra @xmath4 of a unital @xmath5-algebra @xmath6 . the operator algebra generated by the shifts in @xmath7",
    "is called the tensor algebra @xmath8 , and it provides a very successful prototype for the study of operator algebras .",
    "it is closely related to the toeplitz algebra @xmath9 , which is the c*-algebra generated by the shifts , and its celebrated quotient , the cuntz - pimsner algebra @xmath10 .",
    "analogously , given a a subproduct system @xmath11 in the sense of shalit and solel  @xcite of c*-correspondences over a c*-algebra @xmath12 parametrized by @xmath13 , one obtains the operator algebras associated to shifts on @xmath14 : the tensor algebra @xmath15 , the toeplitz algebra @xmath16 and the cuntz - pimsner algebra @xmath17 , where the latter was defined in @xcite . this new framework generalizes the previous one , in the sense that a c*-correspondence @xmath2 gives rise to a _ product _",
    "system @xmath11 whose fock correspondence and associated operator algebras are precisely the ones discussed in the previous paragraph .    there has been important work on the operator algebras arising from subproduct systems over @xmath18 , or equivalently , the special case of subproduct systems whose c*-correspondence fibers are actually _ hilbert spaces _ , see for example @xcite . in our previous paper @xcite , we turned to the simplest case for which the fibers of the subproduct system are not hilbert spaces .",
    "namely , we considered the case of subproduct systems of c*-correspondences over @xmath19 when @xmath20 is countable with more than one point . such a subproduct system and its associated operator algebras are conveniently parametrized by a stochastic matrix @xmath0 over the state space @xmath20 . in @xcite , we considered isomorphism problems of the tensor algebras associated to stochastic matrices , via these subproduct systems .    in this paper",
    "we focus on the _ c*-envelope _ of the tensor algebra associated to finite irreducible stochastic matrices .",
    "recall that given an operator algebra @xmath4 , a c*-cover is a pair @xmath21 where @xmath22 is a c*-algebra and @xmath23 is a unital completely isometric homomorphism , such that @xmath24 .",
    "a c*-cover is called the _",
    "c*-envelope _ for @xmath4 if for any other c*-cover @xmath25 , the map @xmath26 extends uniquely to a surjective * -homomorphism @xmath27 . in this precise sense , the c*-envelope is the smallest c*-algebra which contains a completely isometric copy of @xmath4 , and usually the algebra @xmath22 is denoted @xmath28 and the map @xmath29 is suppressed .",
    "the existence of the c*-envelope of an operator algebra was first proven by hamana  @xcite , by way of proving the existence of an injective envelope for operator systems .",
    "an alternative proof via dilation theory was found by dritchel and mccullough in @xcite .",
    "this new idea allowed arveson  @xcite to follow the original strategy he envisioned in @xcite to prove the existence of the c*-envelope via boundary representations in the separable case .",
    "davidson and kennedy finally realized arveson s vision in full in @xcite by providing a proof without the assumption of separability .",
    "we are motivated in this paper by the known results in the determination of the c*-envelope of the tensor algebra of a subproduct system :    1 .   given a c*-correspondence @xmath2 , we have that @xmath30 .",
    "this was first proven by muhly and solel ( * ? ? ?",
    "* corollary 6.6 ) when the left action on @xmath2 is faithful , essential and acts by compacts , and in the general case ( without extra assumptions ) by katsoulis and kribs @xcite .",
    "2 .   let @xmath31 be a homogeneous ideal in the ring of polynomials in finitely many commuting variables .",
    "the universal commuting row contraction subject to the polynomial relations in @xmath31 gives rise to a subproduct system of hilbert spaces @xmath32 , and it was shown by davdison , ramsey and shalit @xcite that @xmath33 .",
    "3 .   let @xmath31 be a monomial ideal in the ring of polynomials in non - commuting variables .",
    "similarly to the commutative case , a subproduct system @xmath32 can be defined .",
    "kakariadis and shalit @xcite have shown that for many cases ( depending on the monomial ideal ) either @xmath33 or @xmath34 .    in summary , for all these cases ,",
    "when the subproduct system @xmath11 is irreducible in the appropriate sense ( i.e. no nontrivial reducing projections , see definition  [ rem : sps - reducing - proj ] ) , @xmath35 has been found to be isomorphic either to @xmath16 or @xmath17 . in (",
    "* section 6 ) , this phenomenon was observed , and it was asked if one can find a general description for the behavior of c*-envelopes of tensor algebras associated with subproduct systems .",
    "in this paper we shed some light on this question : we show that the evidence for the dichotomy witnessed above is misleading , and that the situation is more mysterious than previously thought , by providing an example of stochastic matrix with subproduct system x such that the @xmath35 is not * -isomorphic to either @xmath16 or @xmath17 ( see example [ ex : distinct ] ) .",
    "our first main result is as follows .",
    "let @xmath0 be a finite irreducible stochastic matrix .",
    "in this case we show that the c*-envelope lands between the toeplitz and cuntz - pimsner algebras in the sense that it fits in the following sequence of quotient maps : @xmath36 and in fact @xmath37 is hyperrigid inside @xmath38 ( see @xcite ) . moreover , in the case when @xmath0 has the multiple arrival property ( see definition  [ def : multiple - arrival ] ) , we identify the boundary representations of @xmath37 inside @xmath39 , also known as the non - commutative choquet boundary in the sense of arveson  @xcite .",
    "this enables us to describe the c*-envelope @xmath38 in terms of boundary representations . for details",
    "see corollary  [ cor : multiple - arrival - boundary ] and theorem  [ theorem : shilov - ideal - hyperrigid ] .",
    "the fact that the cuntz - pimsner algebra @xmath17 as defined by viselter  @xcite is not always isomorphic to the c*-envelope of the tensor algebra @xmath15 in the subproduct system case , and even a dichotomy as above fails to hold , suggests that perhaps an alternative definition of cuntz - pimsner algebra for subproduct systems is desirable .",
    "the concrete description of the c*-envelope and lack of dichotomy lead to an unexpected richness of possibilities .",
    "our second main result concerns the classification of c*-envelope up to * -isomorphism and stable isomorphism , so as to clarify the situation . for a finite irreducible stochastic matrix @xmath0 over @xmath40 , the ideal @xmath41 in the sequence is * -isomorphic to a direct sum of @xmath42 copies of the algebra of compact operators . given two irreducible stochastic matrices @xmath0 and @xmath43 over finite state sets @xmath40 and @xmath44 we have that    1 .",
    "@xmath37 and @xmath45 have stably isomorphic c*-envelopes if and only if @xmath46 . for more details",
    "see theorem [ thm : stable - iso ] .",
    "2 .   @xmath37 and @xmath45 have * -isomorphic c*-envelopes if and only if @xmath47 , @xmath48 and up to a reordering of @xmath44 , the matrices @xmath0 and @xmath43 have the same column nullity in every column . for more details , see definition  [ def : column - nullity ] and theorem  [ thm:*-iso ] .    therefore , we see that instead of a dichotomy , we actually have a profusion of possibilities .",
    "these results are obtained by leveraging the surprisingly simple form of the cuntz - pimsner algebra as obtained in ( * ? ? ?",
    "* corollary 5.16 ) to compute the k - theory of @xmath38 .",
    "however , in our case k - theory does not completely resolve the issue by itself , and we then use extension theory ( especially work by paschke and salinas @xcite ) to complete the task .",
    "we should note that dilian yang pointed out to us that there was a gap in the proof of ( * ? ? ?",
    "* corollary 5.16 ) , which we resolve in section [ sec : cuntz - pimsner ] of this paper .",
    "finally , its natural to ask about the relationship between @xmath38 and the graph algebra @xmath49 associated to the unweighted directed graph obtained from a finite irreducible stochastic matrix @xmath0 .",
    "we apply our classification results for the c*-envelope and k - theory for graph algebras to show that these two objects are generally incomparable in the sense that we exhibit @xmath50 irreducible stochastic matrices @xmath0 , @xmath43 and @xmath51 such that @xmath52 where @xmath53 stands for * -isomorphism and @xmath54 stands for stable isomorphism .",
    "this paper has six sections . in section [ sec : prelim ] we give some preliminary background required from @xcite and on extension theory . in section [ sec : cuntz - pimsner ]",
    "we fill the gap pointed out to us by dilian yang in the proof of ( * ? ? ?",
    "* corollary 5.16 ) and compute the extension groups for the cuntz - pimsner algebra of a finite irreducible stochastic matrix . in section",
    "[ sec : choquet ] we determine the non - commutative choquet boundary of @xmath37 inside @xmath39 , which then allows us to compute c*-envelopes @xmath38 associated to finite irreducible stochastic matrices . in section",
    "[ sec : k - theory ] we compute the k - theory of @xmath38 in terms of boundary representations .",
    "finally , in section [ sec : classification ] we prove our main classification results mentioned above , and compare @xmath38 and @xmath55 as invariants for the graph of @xmath0 .",
    "suppose that @xmath4 is a unital operator algebra , and @xmath56 is a c*-cover .",
    "a unital completely contractive ( c.c . )",
    "map @xmath57 has the _ unique extension property _ if there exists a unique unital completely positive ( c.p . ) extension @xmath58 which is also a * -representation .",
    "we will say that a unital * -representation @xmath59 is a _ boundary representation _ for @xmath4 if @xmath60 is irreducible and @xmath61 has the unique extension property .    for a unital c.c .",
    "map @xmath62 , we say that a unital c.c .",
    "map @xmath63 is a _ dilation _ of @xmath64 if there is an isometry @xmath65 such that for any @xmath66 we have @xmath67 .",
    "we will call a unital c.c .",
    "map @xmath68 _ maximal _ if whenever @xmath69 is a dilation of @xmath64 , then @xmath70 for some unital c.c .",
    "map @xmath71 .",
    "it turns out that for a unital c.c .",
    "map @xmath68 we have that @xmath64 is maximal if and only if @xmath64 has the unique extension property ( * ? ? ?",
    "* proposition 2.2 ) , and that maximality is invariant under change of c*-cover ( * ? ? ?",
    "* proposition 3.1 ) .",
    "thus , for the definitions of the unique extension property and maximality , it makes no difference which c*-cover @xmath72 we work inside .",
    "next , for a unital operator algebra @xmath4 and @xmath56 a c*-cover , an ideal @xmath73 of @xmath6 is called a boundary ideal for @xmath4 if the canonical quotient map @xmath74 is completely isometric on @xmath75 . the shilov ideal @xmath76 of @xmath4 in @xmath6 is the largest boundary ideal .",
    "the shilov ideal is a tractable tool for finding the c*-envelope , since @xmath77 must then be the c*-envelope of @xmath4 ( see ( * ? ? ?",
    "* proposition 1.9 ) ) .",
    "however , there is a way to compute the c*-envelope from boundary representations . by the theorem of davidson and kennedy from @xcite , the boundary representations of every unital operator systems completely norm it ,",
    "so that by ( * ? ? ?",
    "* theorem 2.2.3 ) we have that the shilov ideal is the intersection of all kernels of boundary representations .    in @xcite arveson",
    "investigated a closely related notion for c*-covers called hyperrigidity . for a unital operator algebra @xmath4 and @xmath56 a c*-cover for it ,",
    "one of the equivalent formulations for hyperrigidity of @xmath56 is that for _ any _",
    "@xmath78-representation @xmath79 , the restriction @xmath80 has the unique extension property .",
    "suppose now that @xmath4 is hyperrigid in @xmath72 .",
    "then any irreducible * -representation of @xmath6 must be a boundary representation with respect to @xmath81 , so by taking the direct sum @xmath60 of all irreducible representations of @xmath6 , by the above we have that the shilov ideal of @xmath75 in @xmath6 is trivial .",
    "this means that the c*-envelope of @xmath4 is @xmath6 .",
    "hence , when we know that a c*-cover is hyperrigid , this c*-cover must then be the c*-envelope for our operator algebra . by invariance of c*-envelope",
    ", we see that up to * -isomorphism , @xmath4 can only be hyperrigid in at most one c*-algebra .",
    "we will often suppress the notation for the c*-cover that we use , and in many cases think of @xmath4 as a subalgebra of some particular @xmath82 .",
    "we assume that the reader is familiar with the basic theory of hilbert c*-modules , which can be found in @xcite .",
    "we only give a quick summary of basic notions and terminology as we go , so as to clarify our conventions .",
    "let @xmath4 be a c*-algebra and @xmath2 a hilbert c*-module over @xmath4 .",
    "we denote by @xmath83 the collection of adjointable operators on @xmath2 . if in addition @xmath2 has a left @xmath4-module structure given by a * -homomorphism @xmath84 , we call @xmath2 a hilbert c*-correspondence over @xmath4 .",
    "we often suppress notation and write @xmath85 .",
    "if @xmath2 is a c*-correspondence over @xmath4 with left action @xmath64 , and @xmath86 is a c*-correspondence over @xmath4 with left action @xmath71 , then on the algebraic tensor product @xmath87 one defines an @xmath4-valued pre - inner product satisfying @xmath88 on simple tensors .",
    "the usual completion process with respect to the norm induced by this inner product , yields the internal hilbert c*-module tensor product of @xmath2 and @xmath86 , denoted by @xmath89 or @xmath90 , which is a c*-correspondence over @xmath4 with left action @xmath91 .",
    "the following is the c*-algebraic version of ( * ? ? ?",
    "* definition 1.1 ) for the semigroup @xmath92 , which was also given in ( * ? ? ?",
    "* definition 1.4 ) .",
    "let @xmath4 be a c*-algebra , let @xmath93 be a family of hilbert c*-correspondences over @xmath4 and let @xmath94 be a family of bounded bimodule maps .",
    "we will say that @xmath95 is a subproduct system over @xmath4 if the following conditions are met :    1 .",
    "@xmath96 2 .",
    "the maps @xmath97 and @xmath98 are given by the left and right actions of @xmath4 on @xmath99 respectively 3 .",
    "@xmath100 is an _ adjointable _ coisometric map for every @xmath101 4 .",
    "for every @xmath101 we have the associativity identity @xmath102    in case the maps @xmath100 are unitaries , we say that @xmath11 is a _",
    "product system_.",
    "we describe the construction of the tensor , toeplitz and cuntz - pimsner algebras arising from subproduct systems ( see @xcite ) .",
    "let @xmath95 be a subproduct system over a c*-algebra @xmath4 .",
    "there is a canonical _ product system _ containing @xmath95 as a subproduct subsystem as follows ( see ( * ? ? ?",
    "* definition 5.1 & proposition 5.2 ) ) .",
    "we define @xmath103 , so that @xmath104 constitutes a product systems where the unitaries from @xmath105 to @xmath106 are the usual associativity unitaries .",
    "one can then construct canonical _ adjointable _ coisometries @xmath107 which , by associativity of @xmath108 , are uniquely determined inductively by the equations @xmath109 and @xmath110 .",
    "the @xmath11-fock correspondence is the c * - correspondence direct sum of the fibers of the subproduct system    @xmath111    denote by @xmath112 the projection of @xmath113 onto the @xmath114-th fiber @xmath99 , and define @xmath115 } = q_0 + ... + q_n$ ] , and @xmath116}$ ] .",
    "we then obtain an adjointable coisometric map @xmath117 given by @xmath118    the @xmath11-shifts are the operators @xmath119 uniquely determined between fibers by @xmath120 where @xmath121 and @xmath122 , @xmath123 .",
    "we note that @xmath124 , so that @xmath125 is adjointable with adjoint given by @xmath126 , where @xmath127 is a product system shift and is hence an adjointable operator in @xmath128 .",
    "the tensor and toeplitz algebras are the non - self - adjoint and self - adjoint subalgebras of @xmath129 generated by a copy of @xmath4 and all @xmath11-shifts respectively , @xmath130 @xmath131    [ rem : fock - w*-vs - c*-sum ] when a subproduct system is comprised of @xmath132-correspondences , since each @xmath125 is adjointable , the last part of ( * ? ? ?",
    "* proposition 2.14 ) allows us to take the @xmath132-correspondence ( weak ) direct sum of fibers as our fock space in equation , and get that the operator algebras @xmath16 and @xmath15 are the same as those considered in ( * ? ? ?",
    "* definition 4.1 & definition 6.1 ) .",
    "the algebra @xmath129 admits a natural action @xmath133 of the unit circle @xmath134 called the gauge action , defined by @xmath135 for all @xmath136 where @xmath137 is the unitary defined by @xmath138    since @xmath139 , we see that the algebras @xmath15 and @xmath16 are @xmath133-invariant closed subalgebras , and so the action restricts to them , and we shall still denote it by @xmath133 .",
    "the circle action on @xmath16 then enables the definition of a faithful conditional expectation @xmath140 given by @xmath141 where @xmath142 is normalized haar measure on @xmath134 .",
    "one then defines @xmath143 to be the closure of all homogeneous polynomials of degree @xmath144 ( see ( * ? ? ?",
    "* definition 4.5 ) ) , which then coincides with the collection of operators @xmath145 satisfying @xmath146 as shown in ( * ? ? ?",
    "* corollary 4.6 ) .",
    "this makes both @xmath16 and @xmath15 into @xmath147-graded and @xmath92-graded algebras respectively , and @xmath140 on @xmath16 and @xmath15 is then onto @xmath148 and @xmath149 respectively .",
    "another algebra associated to the subproduct system arises as a special quotient of @xmath16 .",
    "the subset @xmath150 given by @xmath151 is a closed @xmath133-invariant left ideal inside @xmath129 according to ( * ? ? ?",
    "* proposition 4.8 ) .",
    "it was proven by viselter in ( * ? ? ?",
    "* theorem 2.5 ) that @xmath152 is a closed two sided ideal .",
    "let @xmath95 be a subproduct system .",
    "define the cuntz - pimsner ideal of @xmath16 to be @xmath153 , and the cuntz - pimsner algebra of @xmath11 is then @xmath154 .",
    "we note that the circle action on @xmath16 passes naturally to @xmath17 since @xmath155 is gauge invariant , and the fixed point algebras are then @xmath148 and @xmath156 respectively .",
    "we shall later need the following formula for the norm of an element in the quotient @xmath157 , in terms of representatives in @xmath158 .",
    "denote by @xmath159 the canonical quotient map .",
    "when @xmath160 , it follows from item ( 1 ) of ( * ? ? ?",
    "* theorem 3.1 ) that @xmath161}\\}$ ] is an approximate identity for @xmath162 , one may then invoke ( * ? ? ?",
    "* exercise 1.8.c ) to obtain the following .",
    "[ prop : complete - norm - cuntz ] let @xmath95 be a subproduct system , and suppose that @xmath160 for all @xmath163 .",
    "then for any @xmath164 \\in m_s({\\mathcal{t}}(x))$ ] we have @xmath165 \\|\\ ] ]      in our previous paper  @xcite we studied the tensor algebra @xmath37 associated to a certain subproduct system construction applied to a stochastic matrix @xmath0 .",
    "this subproduct system construction can be applied to any unital normal completely positive map on a von - neumann algebra , and is called the arveson - stinespring subproduct system construction .    after characterizing isomorphism classes for arveson - stinespring subproduct systems in terms of the underlying stochastic matrices",
    ", we used this characterization to study the dependence of the isomorphism classes of the algebra @xmath37 on the matrix @xmath0 ( with respect to various concepts of isomorphism ) , which ended up coinciding with the respective isomorphism classes for the subproduct systems .",
    "we will now discuss some of the preliminaries and results in @xcite for such subproduct systems and their cuntz - pimsner algebras .",
    "for the basic theory of stochastic matrices and markov chains , we recommend @xcite and ( * ? ? ?",
    "* chapter 6 ) .",
    "let @xmath20 be a countable set .",
    "a stochastic matrix is a function @xmath166 such that for all @xmath167 we have @xmath168 .",
    "elements of @xmath20 are called _ states _ of @xmath0 .    to every stochastic matrix",
    ", one can associate a set of edges @xmath169 and a @xmath170 - matrix @xmath171 representing the directed graph of @xmath0 as an incidence matrix by way of @xmath172    many dynamical properties of @xmath0 can be put in terms of the directed graph @xmath173 of @xmath0 .",
    "let @xmath0 be a stochastic matrix over @xmath20 .",
    "a path of length @xmath174 in @xmath173 , i.e. a path in the directed graph of @xmath0 , is a function @xmath175 such that @xmath176 for every @xmath177 .",
    "the path @xmath178 is said to be a cycle if @xmath179 .",
    "we will say that a state @xmath180 leads to a state @xmath181 if there is a path @xmath178 ( of some length @xmath174 ) as above with @xmath182 and @xmath183 .",
    "we next give the main definitions that we shall use in the context of stochastic matrices in this paper .",
    "let @xmath0 be a stochastic matrix over @xmath20 , and let @xmath167 .    1 .",
    "the _ period _ of @xmath180 is @xmath184 .",
    "if no finite such @xmath185 exists , or if @xmath186 we say that @xmath180 is aperiodic .",
    "@xmath0 is said to be irreducible if for any pair @xmath187 , we have that @xmath180 leads to @xmath181 ( and so @xmath181 also leads to @xmath180 ) .",
    "if @xmath0 is an irreducible stochastic matrix over @xmath20 , then every state @xmath167 is of the same periodicity @xmath188 , so we define the periodicity of @xmath0 to be @xmath188 .",
    "let us recall the statement of the cyclic decomposition of irreducible stochastic matrices ( * ? ? ?",
    "* theorem 1.3 ) which justifies the notion of periodicity of an irreducible stochastic matrix @xmath0 .",
    "[ theorem : cyclic - graph - decomposition ] ( cyclic decomposition for periodic irreducible matrices ) + let @xmath0 be an irreducible stochastic matrix over a state set @xmath189 with period @xmath188 , and let @xmath190 . for each @xmath191 ,",
    "let @xmath192 . then ,    1 .",
    "the family @xmath193 is a partition of @xmath20 .",
    "2 .   if @xmath194 then there exists @xmath195 such that for all @xmath196 we have @xmath197 .",
    "to re - enumeration of @xmath20 , there exist _ rectangular _ stochastic matrices @xmath198 such that @xmath0 has the following cyclic block decomposition : @xmath199\\ ] ] where the rows ( columns ) of @xmath200 in this matrix decomposition are indexed by @xmath201 ( @xmath202 respectively ) for all for @xmath203 , where @xmath204 is the cyclic group of order @xmath188 .    in this paper we shall restrict our attention to _ finite irreducible _ stochastic matrices . for this class of stochastic matrices",
    ", we have that the more generally stated ( * ? ? ?",
    "* theorem 2.10 ) , yields the following cleaner formulation , which is a combination of ( * ? ? ?",
    "* theorem 4.1 ) and ( * ? ? ?",
    "* theorem 6.7.2 ) .",
    "[ theorem : convergence - theorem - finite ] ( convergence theorem for finite irreducible matrices ) + let @xmath0 be a _ finite irreducible _ stochastic matrix over @xmath20 with period @xmath205 , and @xmath206 a cyclic decomposition for it as in item ( 3 ) of theorem  [ theorem : cyclic - graph - decomposition ] .",
    "there exists a unique probability vector @xmath207 so that when we are given @xmath208 and @xmath209 , for @xmath210 such that @xmath211 , we have that @xmath212    let @xmath20 be a finite set and @xmath213 the c*-algebra of finite sequences indexed by @xmath20 .",
    "we denote by @xmath214 the collection of pairwise perpendicular projections on @xmath215 given by @xmath216 .",
    "we denote by @xmath78 the schur ( entrywise ) multiplication of matrices @xmath217 $ ] and @xmath218 $ ] given by @xmath219 $ ] , and let @xmath220 be the map on matrices given by @xmath221 ) = ( a_{ii})_{i \\in \\omega } \\in \\ell^{\\infty}(\\omega)$ ] .",
    "next , for a non - negative matrix @xmath222 $ ] indexed by @xmath20 , we denote by @xmath223 and @xmath224 the matrices with @xmath225-th entry given by @xmath226    in ( * ? ? ?",
    "* theorem 3.4 ) the arveson - stinespring subproduct system associated to a stochastic matrix @xmath0 on countable @xmath20 was computed .",
    "when @xmath20 is finite , we arrive at the following simpler version of the theorem .",
    "let @xmath0 be a stochastic matrix over _ finite _ @xmath20 .",
    "the following is a subproduct system @xmath227 over @xmath228 and is the one given in ( * ? ?",
    "* theorem 3.4 ) .    1 .",
    "the @xmath114-th fiber is a @xmath5-correspondence over @xmath229 given by @xmath230 \\ | \\",
    "a_{ij}= 0 \\ \\text { if } \\   ( i , j ) \\notin e(p^n ) \\ \\}\\ ] ] with left and right actions of @xmath229 on @xmath231 as a bimodule are given by diagonal left and right matrix multiplication and the @xmath229-valued inner product is given by @xmath232\\ ] ] for @xmath233 .",
    "the subproduct maps are given by @xmath234\\ ] ] for @xmath235 and @xmath236 and @xmath237 .",
    "since the subproduct systems we shall consider in this work will be with finite dimensional fibers and over finite dimensional @xmath5-algebras , they will automatically be @xmath132-correspondences .",
    "hence , by remark [ rem : fock - w*-vs - c*-sum ] , the theories of subproduct systems over @xmath5-algebras and their operator algebras discussed here and of subproduct systems over @xmath132-algebras and their operator algebras discussed in @xcite will coincide .",
    "in this paper we choose to discuss our theories only in the c * ( norm closed ) context for the sake of brevity and a cleaner exposition .",
    "[ rem : sps - reducing - proj ] let @xmath95 be a subproduct system of a c*-algebra @xmath4 .",
    "a projection @xmath238 is said to be reducing for @xmath11 if @xmath239    this is the c * / norm - closed version of ( * ? ? ?",
    "* definition 6.19 ) . using ( * ? ? ?",
    "* proposition 7.4 ) we characterized the reducing projections of @xmath227 for any stochastic matrix @xmath0 over @xmath20 .",
    "that is , there is a 1 - 1 bijection between reducing projections and subsets @xmath240 such that whenever @xmath241 is a path in the directed graph of @xmath0 that both begins and ends at @xmath242 , then in fact for every @xmath243 one has that @xmath244 .",
    "hence , for a finite irreducible stochastic matrix @xmath0 over @xmath20 , the only reducing non - zero projection is @xmath245 .",
    "hence , by considering irreducible stochastic matrices , we are considering irreducible subproduct systems in the above dynamical sense .    for @xmath246 we defined in @xcite the shift operator",
    "@xmath247 uniquely determined on fibers by @xmath248 for @xmath237 .",
    "the toeplitz and tensor algebras of @xmath227 are given respectively by @xmath249 @xmath250 we note in passing that @xmath39 and @xmath37 are generated ( as a c*-algebra , and as a norm - closed algebra respectively ) by @xmath251 and @xmath252 , where @xmath253 $ ] is the zero matrix , except for the @xmath225 entry at which it is @xmath254 . indeed , since @xmath0 is a finite matrix , each @xmath255 can be written as a finite linear combination of @xmath256 with @xmath257 . then choose a path of length @xmath114 , say @xmath258 , and we have that @xmath259 for some @xmath260 .",
    "next , for a finite stochastic matrix @xmath0 over @xmath20 , and for every @xmath163 and @xmath246 we defined operators in @xmath261 mapping each @xmath262 to @xmath263 , one denoted by @xmath264 and given by @xmath265 , and the other denoted by @xmath266 which is uniquely determined on fibers @xmath262 by @xmath267 .",
    "for the purposes of computing the cuntz - pimsner algebra , we defined in ( * ? ? ? * section 5 ) the auxiliary @xmath5-algebra @xmath268 and we noted that due to finiteness of @xmath0 we have that @xmath269    ( * ? ? ?",
    "* proposition 5.6 ) was then used to show that in fact @xmath270 is * -isomorphic to @xmath271 , thereby reducing the computation of the cuntz - pimsner algebra to computing a quotient of an algebra generated by operators @xmath272 which do not depend on weights of entries of @xmath0 .",
    "we recall some facts from the theory of primitive ideal spectra and extension theory for c*-algebras , to be used in later sections .",
    "more details on primitive ideal spectra of c*-algebras can be found in ( * ? ? ?",
    "* chapter 3 ) and ( * ? ? ?",
    "* section 1.5 ) . for an account on the busby invariant and extension theory for c*-algebras see @xcite , ( * ? ? ?",
    "* section 15 ) , ( * ? ? ?",
    "* section 1 ) , ( * ? ? ? * section 2 ) and @xcite .",
    "let @xmath12 be a c*-algebra .",
    "we denote by @xmath273 the collection of unitary equivalence classes of irreducible representations of @xmath12 . on the other hand , we define @xmath274 to be the set of primitive ideals of @xmath12 , where a primitive ideal is the kernel of an irreducible representation of @xmath12 .",
    "the set @xmath274 comes equipped with a lattice structure determined by set inclusion .",
    "next , since any two unitarily equivalent * -representations have the same kernel , the map @xmath275 factors through to yield a surjective map @xmath276 .",
    "it turns out that for type i c*-algebras , the above map @xmath277 is a bijection , as every primitive ideal @xmath278 uniquely determines , up to unitary equivalence , an irreducible representation @xmath279 such that @xmath280 ( see ( * ? ? ?",
    "* theorem 4.3.7 ) ) .",
    "when we have a * -isomorphism @xmath281 between two c*-algebras , we denote by @xmath282 the induced lattice isomorphism between the spectra .",
    "suppose we have the following exact sequence of c*-algebras @xmath283 and denote by @xmath284 the calkin map .",
    "then there is a * -homomorphism @xmath285 into the multiplier algebra of @xmath286 , uniquely determined by @xmath287 for @xmath288 and @xmath289 .",
    "hence , a * -homomorphism @xmath290 will be induced , and we call this map @xmath291 the _ busby invariant _ of the exact sequence above .",
    "we say that the above exact sequence is _ essential _ if @xmath286 is an essential ideal in @xmath12 , that is , if the intersection of @xmath286 with any non - trivial ideal in @xmath12 is non - trivial .",
    "the above association turns out to be a bijection between exact sequences of c*-algebras given as in and * -homomorphisms @xmath292 , where the inverse map sends a * -homomorphism @xmath292 to the exact sequence where the pre - image @xmath293 under the calkin quotient @xmath294 , yield an exact sequence as in , with @xmath279 replaced by the restriction of @xmath294 to @xmath12 . under this bijection ,",
    "an exact sequence as in is _ essential _ if and only if its associated busby invariant is an _ injective _ * -homomorphism .",
    "suppose @xmath295 are c*-algebras for @xmath296 , and that @xmath297 are two short exact sequences .",
    "we say that these two short exact sequences are _ isomorphic _ if there exists a * -isomorphism @xmath298 such that @xmath299 .",
    "suppose @xmath300 and @xmath301 are busby maps for exact sequences as in .",
    "* theorem 2.2 ) then yields that these two short exact sequences are isomorphic if and only if there exist * -isomorphisms @xmath302 and @xmath303 such that @xmath304 where @xmath305 is the induced * -isomorphism between the calkin algebras",
    ".    in the context of extensions by a single copy of compact operators on separable infinite dimensional hilbert space , that is when @xmath306 , the calkin quotient map @xmath307 discussed above is just the regular quotient map into the calkin algebra , since @xmath308 , so that @xmath309 .",
    "we denote by @xmath310 the compact operators on separable infinite dimensional hilbert space @xmath311 .",
    "let @xmath312 be a c*-algebra .",
    "we write @xmath313 for the collection of all injective * -homomorphisms of @xmath312 into @xmath314 .",
    "we call elements in @xmath313 extensions , as they are in bijection , under ( the inverse of ) the busby map , with essential exact sequences of @xmath5-algebras of the form @xmath315    we then say that two extensions @xmath316 are    1 .   strongly ( unitarily ) equivalent if there is a unitary @xmath317 such that @xmath318 for all @xmath319 .",
    "2 .   weakly ( unitarily ) equivalent if there is a unitary element @xmath320 such that @xmath321 for all @xmath319 .    when @xmath312 is unital we write @xmath322 and @xmath323 for the strong and weak equivalence classes of _ unital _ extensions in @xmath313 , respectively .",
    "when @xmath312 is non - unital , we write @xmath322 and @xmath323 for the strong and weak equivalence classes of _ all _ extensions in @xmath313 , respectively , however in this case @xmath324 by ( * ? ? ?",
    "* proposition 15.6.4 ) .",
    "we denote by @xmath325_s$ ] and @xmath325_w$ ] the equivalence classes of an extension @xmath291 in @xmath322 and @xmath323 , respectively    given @xmath326 , we may define @xmath327 ( via some fixed identification @xmath328 ) by specifying @xmath329 .",
    "this operation induces a well - defined addition @xmath330 on @xmath322 and @xmath323 given for two extensions @xmath300 and @xmath301 by @xmath331_s + [ \\eta_2]_s : = [ \\eta_1 \\oplus \\eta_2]_s$ ] and @xmath331_w + [ \\eta_2]_w : = [ \\eta_1 \\oplus \\eta_2]_w$ ] , and makes them into abelian semigroups .",
    "an extension @xmath332 is called _ trivial _ if it lifts to a * -homomorphism @xmath333 such that its composition with the calkin quotient map yields @xmath334 .",
    "such a trivial extension @xmath332 is called _ strongly unital _ if the map @xmath335 can be chosen to be unital ( in particular this is relevant only when @xmath312 itself is unital and @xmath332 is unital ) .",
    "trivial extensions correspond to _ split essential _",
    "exact sequences via ( the inverse of ) the busby map .",
    "it is straightforward to construct injective * -homomorphisms of a c*-algebra @xmath312 into @xmath82 which do not intersect @xmath336 , hence trivial extensions always exist .",
    "moreover , the same argument yields strongly unital trivial extensions .",
    "voiculescu  @xcite showed that when @xmath312 is separable , the semigroup @xmath322 has a zero element .",
    "when @xmath312 is non - unital , the zero element consists precisely of the trivial extensions .",
    "when @xmath312 is unital , it consists of the strongly unital trivial extensions . for more details ,",
    "see ( * ? ? ?",
    "* section  15.12 ) , especially ( * ? ? ?",
    "* theorem  15.12.3 ) .",
    "although @xmath322 and @xmath323 are not always groups , it follows from a theorem of choi and effros that when @xmath312 is separable and nuclear , both semigroups are actually groups ( see ( * ? ? ? * corollary 15.8.4 ) ) .",
    "suppose now that @xmath312 is unital .",
    "there is an action @xmath337 of @xmath147 on @xmath322 given by @xmath338_s = [ ad_u\\circ \\eta]_s$ ] where @xmath320 is a unitary of fredholm index @xmath339 , and @xmath340 for @xmath341 . by definition of addition ,",
    "we have that @xmath342_s + [ \\eta_2]_s ) = [ ad_{u \\oplus v } ( \\eta_1 \\oplus \\eta_2 ) ]   = { \\varepsilon}(n)[\\eta_1]_s + { \\varepsilon}(m)[\\eta_2]_s$ ] where @xmath343 and @xmath344 are unitaries in @xmath345 of indices @xmath346 and @xmath339 respectively",
    ". in particular , if @xmath332 is a strongly unital trivial extension then @xmath347_s = { \\varepsilon}(0+m)([\\eta]_s + [ \\tau]_s)= [ \\eta]_s + { \\varepsilon}(m)[\\tau]_s$ ] . hence , when we denote by @xmath348 the canonical quotient map , we have that @xmath349_s \\,|\\ , m \\in \\mathbb{z } \\}$ ] .",
    "let @xmath350 be the so - called _ index invariant _ of @xmath312 , given by @xmath351_w ) = { \\mathop{\\mathrm{ind}}\\nolimits}\\circ \\eta_*$ ] , where @xmath352 is the map induced between the @xmath353 groups and @xmath354 is the fredholm index .",
    "hence , for a unital c*- algebra @xmath312 , we always have the following sequence of maps @xmath355    we next give the details of two particular examples , which will turn out to be useful to us later in the end of section [ sec : cuntz - pimsner ] and in section [ sec : classification ] .    [ ex : torus - extensions ] take @xmath356 . in this case",
    "@xmath312 is nuclear and separable , so both the weak and strong extension semigroups are groups .",
    "we note that @xmath357 as @xmath358 , and every homomorphism is determined on the generator @xmath254 .",
    "we next show that in this case , the map @xmath359 is surjective .",
    "indeed , for every @xmath360 there is a unitary @xmath361 with @xmath362 , and fredholm index @xmath363 , we may define a * -homomorphism @xmath364 given by @xmath365 which implements a * -isomorphism @xmath366 .",
    "thus we obtain an extension with index invariant @xmath367 .",
    "next , we show that @xmath368 is injective . indeed , if @xmath369_s = 0 $ ] , then @xmath370 and hence there is a unitary @xmath371 with @xmath372 s.t @xmath373 . thus , @xmath291 lifts to a unital @xmath78-homomorphism @xmath374 , so that @xmath291 is a strongly unital trivial extension , and the map @xmath368 is injective .",
    "we conclude that @xmath375 , and that @xmath376 acts trivially on @xmath377 for each @xmath114 .",
    "[ ex : matrix - extension ] take @xmath378 . again in this case @xmath312 is nuclear and separable so that both weak and strong extension semigroups are groups .",
    "we already know that @xmath379 , so that the right most group in vanishes .",
    "let @xmath380 be a unital extension .",
    "we reiterate the construction in ( * ? ? ?",
    "* example 15.4.1 ( b ) ) lifting @xmath381 to a * -homomorphism @xmath382 , and measuring how far @xmath383 is from being unital .",
    "that is , how far is @xmath291 from being a strongly unital trivial extension .",
    "let @xmath384 be a system of matrix units for @xmath385 . by standard essential spectrum arguments , one can find projections @xmath386 that lift each @xmath387 .",
    "next , by appealing to ( * ? ? ?",
    "* lemma  1.1 ) , for all @xmath388 we may find partial isometries @xmath389 lifting @xmath390 such that @xmath391 and @xmath392 .",
    "we set @xmath393 so that @xmath394 is a lifted set of matrix units in @xmath395 , where @xmath396 .",
    "we note that @xmath397 is a projection of finite dimensional cokernel , say of dimension @xmath174 , so that by adding a homomorphism from @xmath398 to @xmath399 if necessary , we may arrange for @xmath400 .    the defect of @xmath291 is then defined to be @xmath401 , and up to strong equivalence it is independent of the choice made in the process above .",
    "it is then easy to see that two unital extensions @xmath402 are strongly equivalent if and only if they have the same defect , and are always weakly equivalent .",
    "hence , we conclude that @xmath403 and @xmath404 .",
    "we next close a gap kindly pointed out to us by dilian yang in the proof of the characterization of the cuntz - pimsner algebra of a finite irreducible stochastic matrix , which is one of the theorems of ( * ? ? ?",
    "* section  5 ) .",
    "the theorem at stake , which corresponds to ( * ? ? ?",
    "* corollary 5.16 ) is as follows .",
    "[ theorem : main ] let @xmath0 be an irreducible stochastic matrix of size @xmath405",
    ". then @xmath406 .",
    "the main issue is that the cyclic decomposition of periodic irreducible stochastic matrices need not be realized in square blocks as claimed in ( * ? ? ?",
    "* remark  2.9 ) .",
    "consider the following example kindly brought to our attention by dilian yang : let @xmath407 and set @xmath408 the matrix @xmath0 has period @xmath409 , @xmath410 and @xmath411 , and both @xmath412 and @xmath413 are not square .",
    "therefore , the results in ( * ? ? ?",
    "* section 5 ) after ( * ? ? ?",
    "* proposition 5.7 ) , and in particular ( * ? ? ?",
    "* proposition 5.15 ) , only apply in the case of square blocks .",
    "therefore a gap remains in the proof of theorem  [ theorem : main ] in its stated form , and we now provide a different proof for it , which works in all cases , and resolves any remaining gaps with the rest of ( * ? ? ?",
    "* section 5 ) .",
    "the issue above does not affect the remainder of the paper , namely ( * ? ? ?",
    "* sections 6 and 7 )",
    ".    recall that the adjoint @xmath414 of @xmath415 , which maps @xmath263 to @xmath262 , is uniquely determined on fibers by @xmath416 where the reason for schur - multipling @xmath417 with @xmath418 is to make sure that the product lands in @xmath262 with its given entry constraints ( see the discussion preceeding ( * ? ? ? * proposition 5.7 ) ) .",
    "we note that @xmath19 acts on @xmath262 as left multiplication by diagonal matrices",
    ". therefore , @xmath419 as the adjointable operator on @xmath420 .    the following proposition , which works in all cases , replaces ( * ? ? ?",
    "* remark 5.10 ) and the discussion preceding it .",
    "[ proposition : nograph ] let @xmath421 and suppose that @xmath422",
    ". then there exists @xmath423 such that for all @xmath424 we have that @xmath425 that is , if @xmath424 and @xmath426 , then the matrix @xmath427 has support contained in the support of @xmath428 .",
    "suppose this fails .",
    "then there exists a sequence of matrices @xmath429 , with @xmath430 increasing , such that the support of @xmath431 is not contained in the support of @xmath432 . by finiteness of @xmath0 , perhaps by replacing @xmath433 by a subsequence",
    ", we may assume that there exist @xmath434 independent of @xmath114 such that @xmath435 and both @xmath436 and @xmath437 while @xmath438 .",
    "again by moving to a subsequence , we may assume that there exists @xmath439 independent of @xmath114 such that @xmath440 .",
    "let @xmath441 be the cyclic decomposition of @xmath0 with respect to @xmath144 .",
    "note that by item ( 2 ) of theorem [ theorem : cyclic - graph - decomposition ] , we must have that @xmath442 for _ all _ @xmath363 such that @xmath443 . therefore there are no paths from @xmath180 to @xmath181 whose length is of residue @xmath444 .",
    "let @xmath445 be such that @xmath446 and @xmath447 .",
    "since @xmath436 , we have that @xmath448 and hence @xmath449 .",
    "it follows from the cyclic decomposition theorem that paths from @xmath144 to @xmath180 have length with residue @xmath450 ( mod @xmath188 , which we will suppress ) . since paths from @xmath144 to @xmath144",
    "must have lengths with zero residue by periodicity , we must have that paths from @xmath180 to @xmath144 will have length with residue @xmath451 .",
    "therefore paths from @xmath180 to @xmath181 have lengths with residue @xmath452 .    next , since @xmath422 , and @xmath448 , we have by the definition of the cyclic decomposition that @xmath453 .",
    "similarly , since @xmath454 , and @xmath455 , we have that @xmath456 .",
    "therefore , @xmath457 and we conclude that all paths from @xmath180 to @xmath181 must have residue @xmath174 mod @xmath188 .",
    "but this is impossible since we have noted before that there are _ no _ paths from @xmath180 to @xmath181 whose length is of residue @xmath444 .",
    "[ defi : cuntz - generators ] let @xmath0 be a finite irreducible @xmath188-periodic stochastic matrix over @xmath20 of size @xmath405 .",
    "we will say that a cyclic decomposition @xmath458 for @xmath0 is _ properly enumerated _",
    "if @xmath20 is enumerated in such a way that for every @xmath459 , @xmath460 and @xmath461 we have that @xmath462 . for @xmath463 , denote by @xmath450 the unique index @xmath464 such that @xmath446 .    given a properly enumerated cyclic decomposition @xmath458 for @xmath0",
    ", we define operators @xmath465 and @xmath466 in @xmath467 as follows .",
    "the operator @xmath465 has degree @xmath188 with respect to the grading , i.e. for every @xmath468 , @xmath469 , and it is uniquely determined by @xmath470 if @xmath471 , then @xmath472 , and denote by @xmath473 . then @xmath474 is an operator of degree @xmath174 , i.e. for all @xmath475 , @xmath476 and it is given by @xmath477 if @xmath478",
    "we define @xmath479 .",
    "the family @xmath480 is called the _ standard family _ associated to the properly enumerated cyclic decomposition @xmath458 .",
    "recall the following auxiliary c*-algebra considered in ( * ? ? ?",
    "* section 5 ) : @xmath481 we recall that @xmath482 is a two sided ideal in @xmath483 with @xmath484 by ( * ? ? ? * theorem 5.6 ) .",
    "we denote by @xmath485 the image of @xmath486 under the associated canonical quotient map @xmath487 .",
    "[ lemma : almost - universal ] let @xmath0 be an irreducible @xmath188-periodic stochastic matrix over @xmath20 of size @xmath405 with properly enumerated cyclic decomposition @xmath458 , and let @xmath480 be its associated standard family .    1 .   [ relations - to - cuntz ] let @xmath488 be such that @xmath471 in the properly enumerated decomposition of @xmath20 , so that @xmath489",
    ". then there exists @xmath490 such that for all @xmath491 we have @xmath492 hence , @xmath493 and @xmath494 for all @xmath495 .",
    "[ coords ] let @xmath495 .",
    "there exists @xmath423 such that for all @xmath424 , and @xmath237 we have that @xmath496 3 .   for all @xmath497 we have @xmath498 4 .",
    "@xmath499 5 .   for all",
    "@xmath187 we have @xmath500 6 .",
    "the family @xmath501 generates @xmath270 .",
    "therefore , @xmath502 is a system of @xmath503 matrix units in @xmath504 and @xmath505 is a unitary in @xmath504 that commutes with them and together they generate @xmath504 .    1 .",
    "let @xmath488 be such that @xmath471 in the properly enumerated decomposition of @xmath20 , so that @xmath489 . by item",
    "( 2 ) of the cyclic decomposition theorem [ theorem : cyclic - graph - decomposition ] , there exists @xmath490 such that @xmath506 and @xmath507 for all @xmath508 .",
    "then for all @xmath491 , @xmath509 and @xmath510 we have @xmath511 so that @xmath492 2 .",
    "let @xmath512 be given . by the previous item and by proposition",
    "[ proposition : nograph ] there exists @xmath423 such that for all @xmath513 and @xmath510 we have @xmath514 similarly , by taking adjoints , we have that @xmath515 proving the statement in all cases .",
    "3 .   let @xmath516 be given . by item  , there exists @xmath423 such that for all @xmath424 and @xmath510 we have that @xmath517 thus we have that @xmath518 .",
    "4 .   by item",
    ", there exists @xmath423 such that for all @xmath424 and @xmath510 we have that @xmath519 thus we have that @xmath520 5 .",
    "let @xmath488 be given . by item  , there exists @xmath423 such that for all @xmath424 and @xmath510 we have the following element in @xmath521 where @xmath473 .",
    "@xmath522 thus we have that @xmath523 .",
    "we first observe that since we are dealing with stochastic matrices over a _",
    "finite _ state space @xmath20 , it is in fact the case that @xmath483 is generated by @xmath215 and @xmath524 , where @xmath525 . indeed , since every @xmath231 is finite dimensional , every @xmath266 can be written as a linear combination of elements of the form @xmath526 .",
    "now , if @xmath526 is non - zero , this means that @xmath527 and so there is a path of length @xmath114 from @xmath180 to @xmath144 given by @xmath528 and we would have that @xmath529 so that every element @xmath530 is in the algebra generated by @xmath215 and @xmath531 , and so @xmath532 therefore @xmath504 is generated as a c*-algebra by the images of @xmath215 and @xmath533 under @xmath534 .",
    "+ let us denote by @xmath4 the c*-subalgebra of @xmath535 generated by @xmath505 and @xmath536 for @xmath187 .",
    "it follows from item   that @xmath537 , therefore , we have that @xmath538 . in order to complete the proof that @xmath539 , it suffices to show that @xmath540 for all @xmath541 .",
    "+ let @xmath541 , and suppose that @xmath542 .",
    "if @xmath471 , then we must have by the cyclic decomposition theorem that @xmath543 and @xmath474 is an operator of degree one and by item   we have that @xmath544 . on the other hand ,",
    "if @xmath478 , then also by the cyclic decomposition theorem we must have @xmath545 and in that case @xmath474 is an operator of degree @xmath546 .",
    "therefore @xmath547 has degree @xmath254 , and by item   we have that @xmath548 .",
    "therefore , in both cases we obtain that @xmath540 .",
    "+ finally , if @xmath541 , and @xmath549 , we have that @xmath474 is an operator of degree zero and by item   we have that @xmath548 .",
    "therefore , we also obtain that @xmath540 .",
    "recall from the discussion preceding ( * ? ? ?",
    "* proposition 5.5 ) that there is a natural gauge group action @xmath133 on @xmath483 uniquely determined by @xmath550 .",
    "since @xmath551 is gauge invariant by ( * ? ?",
    "* theorem 5.6 ) , this gauge action passes to the quotient @xmath504 , and we denote by @xmath552 the fixed point algebra .    first note that @xmath553 is the universal c*-algebra generated by a system of @xmath503 matrix units @xmath554 and a unitary @xmath343 that commutes with them .",
    "hence , by lemma [ lemma : almost - universal ] we obtain a surjective * -homomorphism @xmath555 that sends @xmath554 to @xmath536 and @xmath343 to @xmath505 .",
    "it remains to show that @xmath71 is injective .",
    "let @xmath556 .",
    "first we note that @xmath71 restricted to @xmath4 is injective , since @xmath71 is already injective when restricted to the larger simple subalgebra @xmath557 .",
    "we now show that @xmath558 .",
    "first note that @xmath559 is generated by monomials of degree zero ( according to the gauge action ) in the matrix units @xmath560 and the unitary @xmath505 , which commutes with the latter .",
    "let @xmath561 be such a monomial .",
    "products of matrix units are also matrix units , therefore there exists @xmath488 , @xmath562 such that @xmath563 .",
    "hence , the only way that @xmath11 has degree zero is if @xmath564 and @xmath565 .",
    "moreover , @xmath4 is precisely generated by all @xmath554 , @xmath488 such that @xmath565 .",
    "hence @xmath566 .",
    "next , we show @xmath71 is injective on the entire algebra @xmath567 .",
    "given the identifications @xmath568 and @xmath569 , let us consider the _ faithful _ conditional expectation @xmath570 given by @xmath571 where @xmath572 represents normalized haar measure on the circle .",
    "note that in particular , for all @xmath187 and @xmath573 , @xmath574 we now take @xmath575 to be the _",
    "conditional expectation from @xmath576 to @xmath577 , and let @xmath578 denote the canonical conditional expectation into the fixed point algebra associated with the gauge action .",
    "we then have that @xmath579 . indeed ,",
    "since for all @xmath580 , @xmath581 and since monomials are total in the algebra , we have @xmath582 .",
    "finally , suppose towards a contradiction that @xmath71 is not injective .",
    "then there exists a positive non - zero @xmath583 such that @xmath584 . in that case @xmath585 . hence @xmath586 . by injectivity of @xmath71 on the image of @xmath575 , which is the algebra @xmath4",
    ", we obtain @xmath587 .",
    "we reach a contradiction since @xmath575 and @xmath588 are faithful conditional expectations .",
    "now that we have filled the gap in the computation of the cuntz - pimsner algebra of a finite irreducible stochastic matrix , we compute the extension groups for it , which will be useful to us later in section [ sec : classification ] .",
    "based on the work of @xcite , one has a description of @xmath589 for any unital c*-algebra @xmath312 , for which @xmath322 contains no elements of order @xmath405 , as follows . for any unital extension @xmath590",
    ", we define a map @xmath325_s \\mapsto ( [ \\iota_*\\eta]_s,[j_*\\eta]_s)$ ] into @xmath591 by setting @xmath592 and @xmath593 .",
    "then ( * ? ? ?",
    "* proposition 2.2 ) shows that this map induces an isomorphism of semigroups @xmath594 + { \\varepsilon}(\\ell)[\\tau ] , \\ell ) \\in \\operatorname{ext}_s(b ) \\otimes \\mathbb{z}_d \\ | \\ \\eta \\in e(b ) , \\",
    "\\ell \\in \\mathbb{z } \\ \\}\\ ] ] where @xmath332 is a trivial strongly unital extension .",
    "by example [ ex : torus - extensions ] we have that @xmath595_s = [ \\eta]_s$ ] for all @xmath596 , so that @xmath597 so that @xmath598 and @xmath599 as the projection ( and division by @xmath405 ) onto the first coordinate of @xmath600 . since @xmath599 is the quotient of @xmath598 by the subgroup @xmath601_s \\ | \\",
    "n\\in \\mathbb{z } \\ \\ } \\cong \\mathbb{z}_d$ ] , we can identify the subgroup @xmath601_s \\ | \\",
    "n\\in \\mathbb{z } \\",
    "\\}$ ] of @xmath600 with the image @xmath602_s \\ | \\ [ \\eta]_s \\in \\operatorname{ext}_s(c(\\mathbb{t } ) \\otimes m_d ) \\ \\ } \\cong \\mathbb{z}_d$ ] .",
    "note that any automorphism @xmath603 of @xmath604 induces an automorphism @xmath605 of @xmath600 by composition @xmath325_s \\mapsto [ \\eta \\circ \\beta]_s$ ] .",
    "furthermore , every unitary element @xmath606 defines an automorphism @xmath607 of @xmath604 by way of @xmath608 for @xmath609 and @xmath610 .",
    "denote by @xmath611 the collection of @xmath612-bimodule * -automorphisms of @xmath604 .",
    "[ prop : automorphism - invert ] let @xmath291 be a unital extension and let @xmath613 be an automorphism .",
    "up to the identification @xmath614 given above , we have that either @xmath615 = [ \\eta ] = ( [ \\iota_*\\eta],[j_*\\eta])$ ] or @xmath615 = ( -[\\iota_*\\eta],[j_*\\eta])$ ] .",
    "let @xmath616 be some * -automorphism .",
    "then @xmath603 induces an automorphism @xmath617 on the primitive ideal spectrum @xmath134 , which then induces an automorphism @xmath618 back on @xmath619 given by @xmath620 .",
    "it is easy to see that @xmath621 = [ j _ * \\eta \\circ ( \\beta_*)^*]$ ] since @xmath622 .",
    "since the induced map @xmath623 on @xmath624 is the identity on the second coordinate @xmath625 , we must have that @xmath626 $ ] is either @xmath627 $ ] or @xmath628 $ ] .",
    "hence , by composing with the inverse of @xmath618 if necessary , we may assume that @xmath629 .    by ( * ? ? ?",
    "* corollary 5.46 ) we have that @xmath630 , so that by ( * ? ? ?",
    "* lemma 4.28 ) , there is a point - norm continuous map @xmath631 such that @xmath632 .",
    "since the second cohomology group of the torus @xmath633 vanishes , by ( * ? ? ?",
    "* theorem 5.42 ) , there is a unitary element @xmath634 such that @xmath635",
    ". then @xmath607 induces a map on @xmath636 , so that by the homomorphism property of the fredholm index , we get that , @xmath637 = { \\mathop{\\mathrm{ind}}\\nolimits}(\\eta(ad_u(z\\otimes i ) ) ) = { \\mathop{\\mathrm{ind}}\\nolimits}(\\eta(z \\otimes i ) ) = [ \\iota _ * \\eta]\\ ] ]    next , since the image @xmath602_s \\ | \\ [ \\eta]_s \\in \\operatorname{ext}_s(c(\\mathbb{t } ) \\otimes m_d ) \\ \\ } \\cong \\mathbb{z}_d$ ] can be identified with the subgroup @xmath601_s \\ | \\",
    "n\\in \\mathbb{z } \\ \\}$ ] , in order to show that @xmath638 = [ j_*\\eta]$ ] , it will suffice to show that @xmath639_s ) = { \\varepsilon}(n)[\\tau]_s$ ] .",
    "however , since @xmath605 commutes with @xmath376 , it will suffice to show that @xmath640_s ) = [ \\tau]_s$ ] .",
    "but @xmath605 is a group homomorphism , so it must send @xmath641_s$ ] to itself .",
    "hence , we obtain that @xmath638 = [ j_*\\eta]$ ] .",
    "in this section we first find all the irreducible representations of @xmath39 for a finite irreducible stochastic matrix @xmath0 .",
    "we then determine the boundary representations with respect to @xmath37 among them .",
    "we show that any representation annihilating @xmath642 has the unique extension property when restricted to @xmath37 , and find conditions that guarantee that an irreducible representation supported on @xmath643 is boundary or not .    as given in (",
    "* ? ? ? * theorem 5.6 ) , the c*-algebra @xmath644 is the one generated by both @xmath645 and @xmath39 , and it too has a gauge action which is the restriction of the gauge action of @xmath261 , which satisfies @xmath646 and @xmath647 , so that @xmath648 is gauge invariant , and @xmath649 is a closed gauge invariant two - sided ideal by ( * ? ? ?",
    "* theorem 5.6 ) .    as discussed in (",
    "* section 4 ) for general subproduct systems , fourier coeficients @xmath650 on @xmath648 may be defined in such a way that every @xmath651 can be written as @xmath652 , where this sum convergens cesaro .",
    "that is , where @xmath653 converges in norm to @xmath654 .",
    "from now on , we will denote @xmath655 for @xmath488 .",
    "[ prop : alt - desc - for - cuntz - ideal ] let @xmath0 be an irreducible stochastic matrix on @xmath20 of size @xmath405 . then @xmath649 is the two sided ideal generated by @xmath656 inside @xmath648 .    by ( * ? ? ?",
    "* proposition 5.2 ) we see that @xmath657 , and since @xmath658 as @xmath363 goes to infinity , we see that @xmath659 .    for the reverse inclusion ,",
    "let @xmath660 , and write @xmath661 as a cesaro convergent sum where @xmath662 maps @xmath231 to @xmath663 if @xmath664 and @xmath665 otherwise .",
    "further notice that @xmath666 for all @xmath667 , since by ( * ? ? ?",
    "* theorem 5.6 ) we have that @xmath649 is gauge invariant . in this case , we have that @xmath668 .",
    "hence , since @xmath669}$ ] is in the ideal generated by @xmath670 , we see that @xmath662 is in the closed ideal generated by @xmath656 and so must be @xmath654 by cesaro approximation .    for a finite irreducible stochastic matrix @xmath0 with state set @xmath20 of size @xmath405",
    ", we have that @xmath215 is faithfully represented in @xmath671 by diagonal matrix multiplication on columns .",
    "hence by ( * ? ? ?",
    "* corollary 2.74 ) , this faithful * -representation promotes to a faithful * -representation @xmath672 given by @xmath673 .",
    "note that @xmath674 is a reducing subspace for @xmath675 for each @xmath676 .",
    "[ notation : state - invariant - fock ] for a state @xmath677 we will find it useful to denote @xmath678 , and @xmath679 , the reducing hilbert space for @xmath675 mentioned above , so that @xmath680 . for fixed @xmath114",
    "we also denote for @xmath167 with @xmath681 the elements @xmath682 which comprise a finite orthonormal basis for each @xmath683 , so that for varying @xmath684 and @xmath167 with @xmath685 the collection @xmath686 is an orthonormal basis for @xmath687 .",
    "[ prop : irreducible - cuntz ] let @xmath0 be an irreducible stochastic matrix over @xmath20 of size @xmath405 .",
    "then for each @xmath688 given by @xmath689 we have that @xmath690 is an irreducible subalgebra of @xmath691 .    by ( * ? ? ?",
    "* proposition 5.2 ) we see that @xmath692 for every @xmath163 .",
    "let @xmath693 be some non - zero invariant subspace .",
    "since @xmath694})\\}$ ] converges sot to the identity on @xmath687 , there is some minimal @xmath695 such that @xmath696 for some @xmath697 . in this case ,",
    "@xmath698 for some @xmath699 , so that there exists @xmath700 and some non - zero scalar @xmath701 with @xmath702 where @xmath703 .",
    "this means that @xmath704 , where @xmath705 is some scalar .",
    "thus , for @xmath706 if @xmath707 is some vector in @xmath708 , we see that @xmath709 where @xmath710 is some scalar .",
    "this shows that the set of elements @xmath707 for all @xmath475 and @xmath711 is in @xmath712 , and this set of elements is an orthonormal basis for @xmath687 , and so @xmath713 .",
    "hence , we see that @xmath279 decomposes into @xmath714 irreducible representations @xmath715 as above , so that @xmath716 .",
    "we next show that each @xmath717 is in a distinct unitary equivalence class of irreducible representations for @xmath39 .    [",
    "prop : equivalent - representations ] let @xmath0 be a finite irreducible stochastic matrix on @xmath20 and @xmath718 be _ distinct _ indices .",
    "then @xmath717 and @xmath719 are not unitarily equivalent .",
    "suppose that @xmath720 are such that @xmath717 and @xmath719 are unitarily equivalent .",
    "then there is a unitary @xmath721 such that @xmath722 for all @xmath723 . for @xmath700",
    ", we have that @xmath724 , so that @xmath725 .",
    "apply this operator to @xmath726 and get @xmath727 on the other hand @xmath728 must have image in @xmath729 so that @xmath730 for some non - zero @xmath731 .",
    "but after applying @xmath732 we would obtain that @xmath733 thus , we see that if @xmath734 then by taking @xmath735 we would obtain that @xmath736 in contradiction .",
    "hence , @xmath717 and @xmath719 are not unitarily equivalent .",
    "[ prop : toeplitz - char ] let @xmath0 be a finite irreducible stochastic matrix on @xmath20 .",
    "then @xmath737 and is * -isomorphic to @xmath738 .",
    "thus , we have that @xmath739 .    by proposition [ prop : alt - desc - for - cuntz - ideal ]",
    ", we have that @xmath649 is the ideal generated by @xmath740 inside @xmath648 , and since @xmath741 is a finite rank operator , we see by proposition [ prop : irreducible - cuntz ] that @xmath742 and @xmath743 are irreducible compact operator subalgebras of @xmath691 and hence by ( * ? ? ?",
    "* theorem 1.3.4 ) they must both be equal to @xmath744 . write the identity representation @xmath745 as a direct sum of irreducible representations with multiplicity @xmath746 , where each @xmath747 is a representative in the equivalence class of irreducible representation given by restriction to some @xmath687 for some @xmath144",
    ". then by proposition [ prop : equivalent - representations ] we have that @xmath748 for all @xmath747 and that @xmath749 has the same decomposition into irreducible representations as the one above . since @xmath750 is injective on @xmath649 , we have that @xmath751 , and by taking the inverse of the faithful * -representation @xmath279 , we obtain @xmath752 .",
    "finally , by ( * ? ? ?",
    "* proposition 5.5 ) we have that @xmath753 so that @xmath739 .",
    "we next wish to parametrize all irreducible representations of @xmath39 . under the identification @xmath754 and @xmath755",
    "we have the following exact sequence @xmath756 if @xmath757 is a unital representation , by the discussion preceding ( * ? ? ?",
    "* theorem 1.3.4 ) it decomposes uniquely into a central direct sum of representations @xmath758 , where @xmath759 is the unique extension to @xmath39 of the restriction of @xmath60 to @xmath760 , and @xmath761 annihilates @xmath760 .",
    "hence , the spectrum of @xmath39 decomposes into a disjoint union of the spectrum of @xmath755 and the spectrum of @xmath762 .    for @xmath136",
    ", we define @xmath763 given by @xmath764 ) = [ f_{ij}(\\lambda)]$ ] .",
    "since @xmath765 has range @xmath398 , we obtain that @xmath766 is an irreducible representation of @xmath39 where @xmath767 is the quotient map .",
    "note that every @xmath766 is a @xmath405 dimensional representation .",
    "[ cor : irreps - toeplitz ] let @xmath0 be an irreducible stochastic matrix over @xmath20 of size @xmath405 .",
    "then the spectrum of @xmath39 is parameterized by @xmath405 irreducible representations of infinite dimension , each unitarily equivalent to some @xmath715 , and a torus @xmath768 of irreducible representations of dimension @xmath405 that annihilate @xmath760 , each unitarily equivalent to @xmath766 for some @xmath136 .",
    "if @xmath60 is an irreducible representation of @xmath39 that does not annihilate @xmath760 , we have by ( * ? ? ?",
    "* theorem 1.3.4 ) that @xmath769 is also irreducible .",
    "we use @xmath770 to obtain an irreducible representation @xmath771 of @xmath772 . since @xmath772 is a c*-algebra of compact operators , by ( * ? ? ?",
    "* theorem 1.4.4 ) every irreducible representation of it is unitarily equivalent to some restriction to some @xmath687 .",
    "pushing this back via @xmath279 we obtain that @xmath60 is unitarily equivalent to some @xmath715 .    for the other part , if @xmath60 does annihilate @xmath760 , it induces an irreducible representation of @xmath754 by taking the quotient by @xmath760 .",
    "since the irreducible representations of @xmath612 are just point evaluations , and since @xmath612 is strongly morita equivalent to @xmath773 , we see that @xmath60 must be unitarily equivalent to the composition @xmath766 of an evaluation @xmath763 given by @xmath764 ) = [ f_{ij}(\\lambda)]$ ] and the natural quotient map @xmath774 .",
    "thus , the spectrum of @xmath39 is parametrized by @xmath405 irreducible representations of infinite dimension , and a torus @xmath134 of irreducible representations of dimension @xmath405 .",
    "[ lemma : eventually - projection ] let @xmath0 be an irreducible stochastic matrix over a finite set @xmath20 , and let @xmath775 .",
    "there exists @xmath776 and @xmath777 such that for every @xmath778 we have @xmath779}\\ ] ]    for @xmath780 and @xmath781 , by definition of @xmath782 , we see that @xmath783 so that @xmath784 by theorem [ theorem : convergence - theorem - finite ] , there exists @xmath363 such that @xmath785 for all @xmath541 and @xmath786 such that @xmath787 .",
    "hence , if we take @xmath788 } t_{e_{ij}}^{(1)*}t_{e_{ij}}^{(1 ) } \\|$ ] it follows that @xmath789}$ ] as required .",
    "we next show that representations annihilating @xmath643 have u.e.p . when restricted to @xmath37 .",
    "[ prop : annihi - auto - uep ] let @xmath0 be a finite irreducible stochastic matrix over @xmath20 , and let @xmath757 be a * -representation such that @xmath790",
    ". then @xmath791 has u.e.p .",
    "let @xmath792 be a maximal dilation of @xmath793 such that @xmath311 is a subspace of @xmath286 , and let @xmath794 be its ( unique ) extension to a * -representation .",
    "denote @xmath795 first note that since @xmath796 is a self - adjoint projection , we get that @xmath797 so that by taking the @xmath798 compression , we obtain that @xmath799 , so that @xmath800 .",
    "now , since @xmath801 is self - adjoint , we see that we must also have that @xmath802 .",
    "next , for @xmath803 , suppose @xmath804 observe that for all @xmath781 , by the proof of ( * ? ? ?",
    "* proposition 5.5 ) we have that @xmath805 } = i d - \\sum_{(i , j)\\in e(p^{m})}s^{(m)}_{e_{ij}}s^{(m)*}_{e_{ij}}\\ ] ] hence , by applying @xmath71 to this equation , we obtain that @xmath806 } ) = i d - \\sum_{(i , j)\\in e(p^{m})}\\psi(s^{(m)}_{e_{ij}})\\psi(s^{(m)}_{e_{ij}})^*\\ ] ] then by compressing to the @xmath798 corner we get @xmath807 = - \\sum_{(i , j)\\in e(p^{m } ) } x(m)_{ij}x(m)_{ij}^*\\ ] ] where the last equality follows due to the fact that @xmath60 annihilates @xmath808 .",
    "hence we must have that @xmath809 for all @xmath803 , so that the @xmath798 compression of @xmath810})$ ] is @xmath811 , and if we specify @xmath812 , and note that @xmath813 , the above also yields that @xmath814 for all @xmath778 .",
    "next , let @xmath775 . by lemma [ lemma : eventually - projection ]",
    "there exists @xmath781 and @xmath815 such that for all @xmath778 we have that @xmath779}\\ ] ] hence , @xmath816})\\ ] ] by compressing to the @xmath798 corner , we obtain that @xmath817 but @xmath818 , so for every @xmath775 we have that @xmath819 .",
    "hence we have that @xmath820 for all @xmath778 .",
    "since @xmath39 is generated by @xmath251 and @xmath821 , we must have that @xmath71 has @xmath60 as a direct summand , so that @xmath822 is a trivial dilation of @xmath793 , and hence @xmath793 is maximal , and must then have the unique extension property .",
    "we next define a notion that will help us detect when an irreducible @xmath715 is not a boundary representation for @xmath37 .",
    "let @xmath0 be a finite irreducible stochastic matrix over @xmath20 .",
    "a state @xmath677 is called _ exclusive _ if whenever for @xmath167 and @xmath823 we have @xmath527 , then @xmath824 . we denote by @xmath825 the set of all exclusive states in @xmath20 .",
    "one should think of exclusive states as those states @xmath144 such that for any @xmath114 for which @xmath180 leads to @xmath144 in @xmath114 steps , it can not lead anywhere else in @xmath114 steps .",
    "[ lemma : non - exclusive - char ] let @xmath0 be a finite irreducible @xmath188-periodic stochastic matrix over @xmath20 , and @xmath826 be a cyclic decomposition for @xmath0 .",
    "suppose that @xmath827 is a state .",
    "1 .   @xmath828 if and only if @xmath144 is non - exclusive . in this case ,",
    "any state in @xmath829 is non - exclusive and there is an @xmath830 such that for any @xmath508 and @xmath831 we have @xmath832 .",
    "assume @xmath144 is non - exclusive and @xmath833 is some different state .",
    "if there is @xmath834 such that @xmath835 whenever @xmath836 for all @xmath509 , then there exists @xmath163 such that @xmath837 and for all @xmath509 with @xmath838 we have @xmath839 .",
    "( 1 ) : suppose @xmath840 and let @xmath827 . by item",
    "( 2 ) of theorem [ theorem : cyclic - graph - decomposition ] there is @xmath830 such that for all @xmath491 we would have that @xmath841 for all @xmath831 and @xmath508 .",
    "thus , for some @xmath842 we have that @xmath843 , and since the @xmath181-th row sums up to @xmath254 we get that @xmath844 , and we conclude that @xmath144 is non - exclusive .",
    "for the converse , suppose @xmath144 is non - exclusive .",
    "we show that @xmath828 .",
    "let @xmath845 and @xmath830 be so that @xmath846 , and let @xmath847 be large enough so that @xmath848",
    ". then @xmath849 on the other hand , @xmath850 so we see that @xmath851 .",
    "since the @xmath144-th row sums up to @xmath254 , there must be an @xmath167 differnt from @xmath144 such that @xmath852 and by definition of the cyclic decomposition we have that @xmath853 .",
    "this shows that @xmath828 .",
    "next , by item ( 2 ) of theorem [ theorem : cyclic - graph - decomposition ] we may find @xmath830 large enough so that for any @xmath508 we would have @xmath841 for all @xmath854 . as @xmath855 , and",
    "all rows sum up to @xmath254 , we must also have that @xmath856 for all @xmath854 . hence",
    ", we see that all states in @xmath829 are non - exclusive .",
    "( 2 ) : by item ( 1 ) we can find @xmath830 so that @xmath832 for all @xmath854 and @xmath508 .",
    "now fix @xmath509 with @xmath836 , so that by assumption @xmath857 . then @xmath858    [ prop : boundary - rep - exculsive ] let @xmath0 be a finite @xmath188-periodic irreducible matrix over @xmath20 and @xmath859 a cyclic decomposition for @xmath0 .",
    "let @xmath677 .    1 .",
    "if @xmath827 is non - exclusive and for any other non - exclusive @xmath860 there is some @xmath834 such that @xmath857 whenever @xmath836 , then @xmath715 is a boundary representation .",
    "if @xmath144 is exclusive then @xmath715 is not a boundary representation .",
    "( 1 ) : assume @xmath144 is non - exclusive .",
    "we use ( * ? ? ?",
    "* theorem 7.2 ) to show that @xmath715 is a strongly peaking representation according to ( * ? ? ?",
    "* definition 7.1 ) .",
    "since the irreducible representations of @xmath39 are given by corollary [ cor : irreps - toeplitz ] , it suffices to find an element @xmath861 such that @xmath862 for any @xmath136 and such that @xmath863 for any @xmath864 .",
    "choose @xmath865 , and wait until prescribing @xmath114 is necessary .",
    "recall notation [ notation : state - invariant - fock ] , so that @xmath866 on the other hand , @xmath867 for @xmath509 satisfying @xmath868 , so that @xmath869 so we see that @xmath870 .",
    "next , fix @xmath871 with @xmath872 .",
    "since @xmath873 sends @xmath262 to @xmath262 , it is a finite - block diagonal operator , so we must have that @xmath874 is also finite - block diagonal .",
    "denote @xmath875 , and note that since @xmath876 , we have that @xmath877 @xmath878 by theorem [ theorem : convergence - theorem - finite ] we see that as @xmath879 goes to infinity , the fraction @xmath880 converges to the constant @xmath881 .",
    "hence , if @xmath882 , as @xmath144 is non - exclusive , we have that @xmath883 for large enough @xmath114 , and so that @xmath863 .    on the other hand ,",
    "if @xmath884 , then the supremum above is in fact a maximum , and @xmath885 must be non - exclusive . by item",
    "( 2 ) of lemma [ lemma : non - exclusive - char ] there is @xmath114 large enough ( which we now prescribe ) so that @xmath886 and @xmath887 for all @xmath888 .",
    "hence , we see that @xmath889 for all @xmath888 so that still we obtain @xmath863 .    to conclude",
    ", we have shown that @xmath890 so that by ( * ? ? ?",
    "* theorem 7.2 ) we have that @xmath715 is a boundary representation .",
    "( 2 ) : suppose that @xmath144 is exclusive . by the formula for @xmath891",
    ", we see that @xmath892 .",
    "indeed , this follows since any weights appearing in an application of @xmath891 to a @xmath144-th column of a matrix @xmath237 arise only from entries of the @xmath144-th columns of @xmath893 , which are either @xmath811 or @xmath254 by assumption on @xmath144 .",
    "we will use the above to show that @xmath715 is not strongly peaking anywhere by showing that it is not strongly peaking at any @xmath894 \\in m_s({\\mathcal{t}_+}(p)^ * + { \\mathcal{t}_+}(p))$ ] where each @xmath895 is of degree @xmath896 $ ] ( which must then be either of the form @xmath897 or @xmath898 ) .",
    "we also denote by @xmath899 the element ( which is either of the form @xmath272 or @xmath900 respectively ) satisfying @xmath901 above .",
    "we note finally that there exists @xmath847 such that for all @xmath424 we have that @xmath902 for all @xmath903 .",
    "we then have that @xmath904 ) \\| = \\| \\sum_{n =- n}^n[\\pi_k(t_{ij } ) ] \\| = \\| \\sum_{n =- n}^n[\\pi_k(w_{ij } ) ] \\| = \\ ] ] @xmath905 \\| = \\| \\sum_{n =- n}^n[\\pi_k(u^{m*}w_{ij}u^m ) ] \\|\\ ] ] @xmath906 \\| \\leq   \\| [ q_{[m , \\infty ) } ( \\sum_{n =- n}^n w_{ij } ) q_{[m , \\infty ) } ] \\|\\ ] ] so we see that by proposition [ prop : complete - norm - cuntz ] @xmath904 ) \\|",
    "\\leq \\lim_{m \\rightarrow \\infty } \\| [ ( \\sum_{n =- n}^n w_{ij } ) q_{[m , \\infty ) } ] \\| = \\| [ q(\\sum_{n =- n}^n w_{ij } ) ] \\| = \\| q^{(s)}(\\sum_{n =- n}^n [ t_{ij } ] ) \\|\\ ] ]    since @xmath907 ) \\in c(\\mathbb{t},m_d ) \\otimes m_s$ ] , there exists @xmath136 such that @xmath904 ) \\|",
    "\\leq \\|q^{(s)}(\\sum_{n =- n}^n [ t_{ij}])\\| = \\| ( ev_{\\lambda } \\circ q)^{(s)}(\\sum_{n =- n}^n [ t_{ij}])\\|\\ ] ] since elements of the form @xmath894 $ ] with @xmath908 of degree @xmath114 are dense inside @xmath909 , we see that for any @xmath910 \\in m_s({\\mathcal{t}_+}(p)^ * + { \\mathcal{t}_+}(p))$ ] we have @xmath911\\| \\leq \\sup_{\\lambda \\in \\mathbb{t } } \\| [ ( ev_{\\lambda } \\circ q)(v_{ij } ) \\|$ ] so that @xmath715 can not be strongly peaking . by (",
    "* theorem 7.2 ) we see that @xmath715 is not a boundary representation .",
    "it is clear that for exclusive @xmath677 the representation @xmath715 is not boundary by item ( 2 ) of propositon [ prop : boundary - rep - exculsive ] .",
    "item ( 1 ) in proposition [ prop : boundary - rep - exculsive ] above provides a sufficient condition for @xmath715 to be boundary when @xmath144 is non - exclusive .",
    "we believe that this condition is not necessary , however we do not have examples to that effect .",
    "we next introduce a class of stochastic matrices for which we can completely identify the non - commutative choquet boundary of @xmath37 inside @xmath39 in terms of the matrix @xmath0 .",
    "[ def : multiple - arrival ] let @xmath0 be a finite @xmath188-periodic irreducible stochastic matrix over @xmath20 .",
    "we say that @xmath0 has the _ multiple - arrival _",
    "property if whenever @xmath912 are distinct non - exclusive states such that whenever @xmath144 leads to @xmath885 in @xmath114 steps , then there exists @xmath913 such that @xmath914 leads to @xmath885 in @xmath114 steps .",
    "[ cor : multiple - arrival - boundary ] let @xmath0 be a finite irreducible stochastic matrix over @xmath20 , and @xmath677 . if @xmath0 has the multiple - arrival property , then @xmath715 is a boundary representation if and only if @xmath144 is non - exclusive .",
    "hence , the non - commutative choquet boundary of @xmath37 inside @xmath39 is parameterized by a circle @xmath134 of irreducible representations of dimension @xmath405 , and irreducible representations @xmath715 of infinite dimension associated to non - exclusive states @xmath677 .",
    "this follows directly since if @xmath0 has multiple - arrival , then the conditions of proposition [ prop : boundary - rep - exculsive ] item ( 1 ) are automatically satisfied for any non - exculsive @xmath677 , and item ( 2 ) of proposition [ prop : boundary - rep - exculsive ] then gives the reverse implication .",
    "there is an easy class of examples which automatically has the multiple arrival property .",
    "suppose that @xmath0 is an irreducible @xmath188-periodic stochastic matrix with cyclic decomposition @xmath826",
    ". then we may write @xmath199\\ ] ] for rectangle stochastic matrices @xmath915 .",
    "if all entries of the matrices @xmath915 are non - zero , then @xmath0 is called _ fully - supported _ , and has the multiple - arrival property .",
    "suppose @xmath0 is a finite irreducible stochastic matrix @xmath0 over @xmath20 of size @xmath405 .",
    "we next discuss @xmath38 and its spectrum .",
    "denote by @xmath916 the set of states @xmath144 for which @xmath715 is a boundary representation , which is a subset of @xmath917 .",
    "since for all @xmath677 and @xmath136 we have that @xmath918 , and since the intersection of kernels of all boundary representations is the shilov ideal , we must have that @xmath919 is the shilov ideal of @xmath37 inside @xmath39 , thought of as a subalgebra of @xmath920 .",
    "we hence get the following short exact sequence @xmath921 while we identify @xmath922 with @xmath923 , where @xmath924 is the quotient map by the shilov ideal .",
    "if @xmath925 is a unital * -representation , it decomposes uniquely into a central direct sum of representations @xmath926 , where @xmath759 is the unique extension to @xmath38 of the restriction of @xmath60 to @xmath927 , and @xmath928 annihilates @xmath927 .",
    "hence , the spectrum of @xmath38 decomposes into a disjoint union of the spectrum of @xmath923 and the spectrum of @xmath929 .",
    "that is , the spectrum of @xmath38 is comprised of @xmath930 irreducible representations of infinite dimension , and a torus @xmath134 of irreducible representations of dimension @xmath405 that annihilate @xmath927 .",
    "[ theorem : shilov - ideal - hyperrigid ] suppose that @xmath0 is a finite irreducible matrix over @xmath20 .",
    "then @xmath37 is hyperrigid in @xmath38 .",
    "moreover , if @xmath0 has multiple - arrival , the shilov ideal for @xmath37 inside @xmath39 is given by @xmath931 and is * -isomorphic via @xmath279 to @xmath932    let @xmath925 be a * -representation . by the above discussion , we may decompose it into a central direct sum of representations @xmath926 , where @xmath759 is the unique extension to @xmath38 of the restriction of @xmath60 to @xmath927 , and @xmath928 annihilates @xmath927 .    by proposition [ prop : annihi - auto - uep ]",
    "we have that @xmath933 has u.e.p . when restricted to @xmath37 , so that @xmath928 has u.e.p . when restricted to @xmath934 by invariance of maximal ucp maps .",
    "next , since @xmath935 is a direct sum of * -representations , with certain multiplicities @xmath936 , that have u.e.p . when restricted to @xmath37 , by (",
    "* theorem 4.4 ) @xmath937 has u.e.p . when restricted to @xmath37",
    "hence , again by invariance of maximal ucp maps , @xmath759 has u.e.p . when restricted to @xmath934 . by another application of (",
    "* theorem 4.4 ) we obtain that @xmath926 also has u.e.p . when restricted to @xmath934 , so that @xmath37 , which is completely isometric to @xmath934 via @xmath938 , is hyperrigid within @xmath38 .    for the second part , by corollary [ cor : multiple - arrival - boundary ] we know that @xmath939 .",
    "furthermore , by proposition [ prop : annihi - auto - uep ] , we have that @xmath766 is a boundary representation for @xmath37 for any @xmath136 , and since @xmath940 , by the discussion preceding the theorem , the shilov ideal must equal @xmath941    we now give equivalent conditions that guarantee that the c*-envelope of @xmath37 is either the toeplitz algebra , or the cuntz - pimsner algebra .",
    "let @xmath0 be a finite irreducible stochastic matrix of size @xmath405 with multiple - arrival .",
    "then we have that @xmath942 if and only if all @xmath677 are non - exclusive .    in particular ,",
    "if @xmath0 aperiodic and of size @xmath943 with multiple - arrival , we have that @xmath944 .    by theorem [ theorem :",
    "shilov - ideal - hyperrigid ] we see that if all @xmath677 are non - exclusive , then @xmath945 and so @xmath39 is the c*-envelope of @xmath37 .",
    "conversely , if @xmath946 , then @xmath38 has @xmath405 irreducible representations of infinite dimension , which can only occur if @xmath947 .",
    "since @xmath0 has multiple - arrival , we see by corollary [ cor : multiple - arrival - boundary ] that @xmath948 , and so all states @xmath677 are non - exclusive .    for the second part",
    ", our assumptions guarantee that @xmath949 is the cyclic decomposition for @xmath0 , and @xmath950 , so by lemma [ lemma : non - exclusive - char ] all elements in @xmath20 are non - exclusive .",
    "since @xmath0 has multiple - arrival , by corollary [ cor : multiple - arrival - boundary ] we have that @xmath715 is a boundary representation for any @xmath677 , and so @xmath945 and @xmath942 .",
    "[ cor : homomorphism - cuntz ] let @xmath0 be a finite @xmath188-periodic irreducible stochastic matrix of size @xmath405 , and let @xmath859 be a cyclic decomposition for @xmath0 .",
    "the following are equivalent :    1 .",
    "all @xmath677 are exclusive .",
    "@xmath951 for all @xmath952 , or equivalently @xmath953 .",
    "3 .   @xmath954 is a * -homomorphism .",
    "4 .   @xmath955    @xmath956 : by item ( 1 ) of lemma [ lemma : non - exclusive - char ] we see that @xmath951 for all @xmath952 .",
    "@xmath957 : if all @xmath201 are of size @xmath254 , we see that the cyclic decomposition for @xmath0 yields that @xmath0 is in fact a permutation matrix of a single - cycle permutation , and is hence a homomorphism .",
    "@xmath958 : the arveson - stinespring construction of a subproduct system generally yields a product system when applied to a * -homomorphism . hence , @xmath227 is a product system , and its tensor algebra is the tensor algebra of a single correspondence , and by ( * ? ? ?",
    "* proposition 2.8 ) this is also true for the cuntz - pimsner algebra in our case . by ( * ? ? ?",
    "* theorem 3.7 ) we have @xmath955 .    @xmath959 : assume towards contradiction that there is some @xmath677 that is non - exclusive . in this case , let @xmath114 be so that @xmath886 , and observe that @xmath960 , while for @xmath961 we have @xmath962 this means that @xmath774 is not isometric on @xmath963 , and in particular , not completely isometric on @xmath963 . by ( * ? ? ?",
    "* theorem 7.2 ) , there is a boundary representation for @xmath37 coming from an extension to @xmath39 , of an element in the spectrum of @xmath643 , which then must be equivalent to one of the @xmath715 .",
    "this means that @xmath38 has an irreducible representation of infinite dimension , which is impossible since @xmath964 only has irreducible representations of dimension @xmath405 .",
    "[ ex : distinct ] we next give an example of @xmath50 stochastic matrix for which @xmath38 , @xmath39 and @xmath270 are pairwise non * -isomorphic . let @xmath965 the matrix @xmath0 is fully - supported and we see that states @xmath254 and @xmath409 are non - exclusive , while @xmath966 is exclusive . hence , @xmath967 .",
    "therefore , the shilov ideal @xmath968 .",
    "this yields a quotient @xmath38 for which @xmath38 , @xmath39 and @xmath270 are pairwise non * -isomorphic .    without the irreducibility assumption on @xmath0 ,",
    "it is easy to construct intermediary c*-envelopes from `` extremal '' c*-envelopes . indeed ,",
    "if for finite stochastic matrices @xmath0 and @xmath43 of sizes at least @xmath409 we have that @xmath969 , and @xmath970 , then @xmath971 is a finite stochastic matrix such that @xmath972 , and one can similarly use representation theory to show that @xmath973 is non * -isomorphic to @xmath974 nor @xmath975 .    however , when @xmath0 is irreducible , the subproduct system @xmath227 associated to it , can not have any non - trivial reducing projections in the sense of remark [ rem : sps - reducing - proj ] , so we have irreducibility both in a dynamical sense and in a sense of its subproduct system .",
    "the above example then shows that even under this minimality / irreducibility assumptions on a dynamical object which is equivalent to this irreducibility assumptions on the subproduct system above , up to * -isomorophism the c*-envelope may be distinct from both the cuntz - pimsner algebra , and the toeplitz algebra .",
    "in this section we compute the k - theory of @xmath38 .",
    "recall notation [ notation : state - invariant - fock ] .",
    "let @xmath916 be the collection of @xmath676 for which @xmath715 is a boundary representation .",
    "we note immediately that we identify @xmath39 with its image under @xmath976 , where @xmath687 are the invariant subspaces of @xmath279 and @xmath977 the irreducible , pairwise non - unitarily equivalent representations given by restriction @xmath978 , for each @xmath677 .",
    "recall the short exact sequence from .    we know from @xcite that @xmath979 and @xmath353 are additive functors , and that for any @xmath677 we have @xmath980 , and @xmath981 .",
    "hence , the six - term exact sequence of k - theory induced from the exact sequence yields @xmath982 our goal in this section is to compute the index map @xmath983 , which will then enable the computation of the @xmath979 and @xmath353 groups for @xmath38",
    ". it will suffice to compute the value of @xmath984 on a generator of @xmath985 , and in our computations we will work with the unitary element @xmath986 , as @xmath987_1 $ ] is a generator for @xmath985 .",
    "[ lemma : v - partial - isom ] let @xmath0 be an @xmath188-periodic irreducible stochastic matrix over @xmath20 of size @xmath405 , with properly enumerated cyclic decomposition @xmath859 such that @xmath988 is the first element , and let @xmath480 be its associated standard family .    1 .   for all @xmath167 we have that @xmath989 is a family of pairwise orthogonal projections that commute with @xmath465",
    "the element @xmath990 lifts to a partial isometry @xmath991 inside @xmath39 .",
    "( 1 ) : by definition , for any @xmath992 and @xmath993 we have that @xmath994 so that @xmath995 .",
    "next , note that @xmath996 so that @xmath465 and @xmath997 commute on the dense subset of @xmath998 , and hence commute .",
    "( 2 ) : it is clear that @xmath999 lifts to @xmath1000 inside @xmath39 since under the identification @xmath1001 , the element @xmath1002 in the quotient is identified with @xmath999 .",
    "hence , we need only verify that @xmath1000 is a partial isometry .",
    "indeed , since by item ( 1 ) , @xmath465 commutes with @xmath1003 , and since @xmath465 is a partial isometry , we have that @xmath1004 so that @xmath1000 is also a partial isometry .",
    "let @xmath344 be the image of @xmath1000 under the c*-envelope quotient map @xmath1005 . by lemma [ lemma : v - partial - isom ]",
    "we know that @xmath1000 is a partial isometry that lifts @xmath999 , and hence @xmath344 is a partial isometry that lifts @xmath999 . by item ( ii ) of (",
    "* proposition 9.2.5 ) we have that @xmath1006 and @xmath1007 are projections in @xmath1008 with @xmath1009_1 ) = [ 1 - v^*v]_0 - [ 1 - vv^*]_0\\ ] ] but due to the identification @xmath1010 , we obtain that @xmath1009_1 ) = [ 1-v^*v]_0 - [ 1 - vv^*]_0 = \\big ( [ ( 1-v^*v ) |_{{\\mathcal{f}}_{p , k } } ] - [ ( 1 - vv^ * ) |_{{\\mathcal{f}}_{p , k } } ]   \\big)_{k\\in \\omega_b } = \\ ] ] @xmath1011 where we are then left with computing the fredholm indices of @xmath1012 for @xmath1013 .",
    "[ prop : pi - index ] let @xmath0 be an @xmath188-periodic irreducible stochastic matrix over @xmath1014 .",
    "suppose that @xmath859 is a properly enumerated cyclic decomposition such that @xmath871 is its first element , and let @xmath480 be its associated standard family .",
    "let @xmath1015 .",
    "then for every @xmath677 we have that @xmath1016 .    up to conjugating @xmath0 with a permutation matrix",
    ", we may assume that @xmath1017 is the first element .",
    "for each state @xmath677 , let @xmath1018 , and denote by @xmath1019 where @xmath1020 if @xmath1021 , and is @xmath811 otherwise . recall notation [ notation : state - invariant - fock ] . since @xmath1022 , and since @xmath1000 shifts only the first rows of the matrix @xmath12 in an element @xmath1023 , we have for all @xmath163 that @xmath1024 and for all @xmath1025 that @xmath1026 due to the support of elements in @xmath683 . note",
    "also that for @xmath564 , and we get @xmath1027 hence , if we sum up dimensions , we obtain that @xmath1028 and @xmath1029 thus , @xmath1030    @xmath1031    hence , we see that in any case , @xmath1032 , as required .",
    "[ cor : delta - computation ] let @xmath0 be an irreducible stochastic matrix over finite @xmath20",
    ". then the index map @xmath1033 is given by @xmath1034    we then obtain the k - theory of @xmath38 in terms of @xmath930 .",
    "[ theorem : k - theory - computation ] let @xmath0 be a finite irreducible stochastic matrix over @xmath20",
    ". then    1 .",
    "if @xmath0 has a non - exclusive state then @xmath1035 2 .",
    "if all states of @xmath0 are exclusive then @xmath1036    if all states of @xmath0 are exclusive , then by corollary [ cor : homomorphism - cuntz ] we have that @xmath964 so that the @xmath979 and @xmath353 groups of @xmath38 must both be @xmath147 .    next",
    ", if @xmath0 has a non - exclusive state , since @xmath984 is injective , by exactness at @xmath1037 in the six - term exact sequence , we see that @xmath1038 .    since @xmath1039",
    ", we see that the six - term exact sequence can be reduced to the single exact sequence @xmath1040 since @xmath1041 , we see that @xmath1042 , and the proof is complete .",
    "let @xmath0 be a finite irreducible stochastic matrix over @xmath20 .",
    "then conditions @xmath1043 through @xmath1044 of corollary [ cor : homomorphism - cuntz ] are all equivalent to @xmath1045 .",
    "we are now in a position to apply the theory in the previous sections to obtain classification results up to * -isomorphism and stable isomorphisms of c*-envelopes arising from finite irreducible stochastic matrices .    for every finite irreducible stochastic matrix @xmath0 over @xmath40 , which has at least one non - exclusive state , let @xmath1046 be the ( non - empty ) set of indices @xmath1047 such that @xmath1048 is a boundary representation for @xmath37 .",
    "we note that @xmath38 is type i ( equivalently gcr ) , being an extension of a ccr algebra by a ccr algebra .",
    "thus , we may identify an irreducible representation with its kernel when discussing elements of the primitive ideal spectrum of @xmath38 .",
    "the analysis done around the exact sequence shows that the spectrum of @xmath38 as a set is comprised of @xmath1049 irreducible representations of infinite dimensions induced from @xmath715 , which we still denote by @xmath1050 for @xmath1051 , and a torus @xmath134 of irreducible representations of dimension @xmath1052 given by @xmath766 for every @xmath136 , where @xmath1053 is the quotient map .",
    "moreover , we have the exact sequence @xmath1054    since @xmath1055 for every @xmath1051 and every @xmath136 , and @xmath1056 is not a subset of any @xmath1057 for @xmath1058 , we see that for every @xmath136 , each @xmath1056 is a maximal element in the lattice @xmath1059 .    for a finite irreducible stochastic matrix @xmath0 ,",
    "we denote from now on @xmath1060 , @xmath1061 and @xmath1062 .",
    "let @xmath0 and @xmath43 be irreducible stochastic matrices over finite sets @xmath40 and @xmath44 respectively . then we have the following exact sequences @xmath1063 with busby invariants @xmath1064 and @xmath1065 , and the stabilized exact sequences @xmath1066 with busby invariants @xmath1067 and @xmath1068 given by @xmath1069 ) = [ \\eta_p(t_{ij})]$ ] for @xmath1070 \\in b_p \\otimes { \\mathcal{k}}$ ] .",
    "for @xmath1071 denote by @xmath1072 the restriction map , which then promotes to a restriction @xmath1073 .",
    "[ prop : c - env - char - ext ] let @xmath0 and @xmath43 be finite irreducible stochastic matrices over @xmath40 and @xmath44 respectively .    1 .   @xmath38 and @xmath1074 are * -isomorphic if and only if there exists a * -isomorphism @xmath1075 and a bijection @xmath1076 such that for all @xmath1077 the extensions @xmath1078 and @xmath1079 are strongly equivalent .",
    "2 .   @xmath38 and @xmath1074 are stably isomorphic if and only if there exists a * -isomorphism @xmath1080 and a bijection @xmath1076 such that for all @xmath1077 the extensions @xmath1081 and @xmath1082 are weakly equivalent .",
    "we first show ( 1 ) .",
    "suppose that @xmath1083 is a * -isomorphism .",
    "let @xmath1084 be the induced lattice isomorphisms between the spectra . since @xmath1085 must send maximal elements to maximal elements , we see that for @xmath136 we have that @xmath1085 sends @xmath1086 to @xmath1087 for some @xmath1088 in bijection . in particular , since @xmath1089 and @xmath1090 , we see that @xmath1091 .",
    "hence @xmath38 and @xmath1074 are * -isomorphic if and only if the exact sequences of are isomorphic , which happens if and only if the restriction @xmath1092 and the induced map @xmath603 satisfy @xmath1093 , where @xmath1094 is the induced * -isomorphism from @xmath133 between the quotients by @xmath1095 and by @xmath1096 .",
    "so suppose @xmath1093 for @xmath277 and @xmath603 as above .",
    "since @xmath1097 , there is a bijection @xmath1076 and a unitaries @xmath1098 such that @xmath1099 , so that @xmath1100 for the converse , if @xmath1101 are unitaries implementing the strong conjugacy between @xmath1102 and @xmath1103 , by setting @xmath1104 , we have that @xmath1105    next , we show ( 2 ) . since stabilizing an algebra",
    "does not change its primitive ideal spectrum , the same argument as used in ( 1 ) shows that @xmath38 and @xmath1074 are stably isomorphic if and only if the exact sequences in are isomorphic , which happens if and only if there are * -isomorphisms @xmath1106 and @xmath1107 such that @xmath1108 .",
    "then a similar argument to the one used for item ( 1 ) shows that this happens if and only if there is a bijection @xmath1076 such that for all @xmath1077 the extensions @xmath1109 and @xmath1110 are _ strongly _ equivalent .",
    "since these are non - unital extensions , this happens if and only if they are weakly equivalent .",
    "for an irreducible finite stochastic matrix @xmath0 over @xmath40 with period @xmath1111 , and @xmath1047 .",
    "let @xmath1112 be a cyclic decomposition for @xmath0 .",
    "then there exists @xmath847 , such that for all @xmath513 we have @xmath1113 indeed , fix @xmath1114 . by item",
    "( 2 ) of theorem [ theorem : cyclic - graph - decomposition ] there is @xmath1115 such that for all @xmath1116 we have that @xmath1117 for @xmath1118 with @xmath1119 .",
    "hence , if we fix @xmath735 , we see that @xmath1120 then simply take @xmath1121 to obtain the desired claim above .",
    "[ def : column - nullity ] let @xmath0 be an @xmath188-periodic finite irreducible stochastic matrix over @xmath20 of size @xmath405 , and @xmath677",
    ". let @xmath826 be a cyclic decomposition for @xmath0 , so that @xmath1122 is the unique index such that @xmath1123 .",
    "we define the _ @xmath144-th column nullity _ of @xmath0 to be @xmath1124 where @xmath1125 is taken as an element in the cyclic group @xmath204 of order @xmath188 .",
    "we say that @xmath677 is a fully supported column if @xmath1126 .    put in other words , the column nullity of a state @xmath676 is the number of zeros in all @xmath144-th columns of iterations of @xmath0 , that lie in the support of a cyclic decomposition for @xmath0 .",
    "the above infinite sum is in fact always finite by the discussion preceding definition [ def : column - nullity ] and is hence convergent .    for a finite irreducible stochastic matrix @xmath0",
    ", we find the element in @xmath600 representing each extension @xmath1127 , for each @xmath1077 , appearing in proposition [ prop : c - env - char - ext ] .",
    "note that the exact sequence corresponding to the extension @xmath1128 is @xmath1129 recall the computation of @xmath600 and @xmath1130 preceding proposition [ prop : automorphism - invert ] .",
    "[ prop : defect - computation ] let @xmath0 be a finite irreducible stochastic matrix over @xmath40 with period @xmath1111 , and let @xmath1131 be a properly enumerated cyclic decomposition for @xmath0 .",
    "then for each @xmath1132 , there exists @xmath830 large enough so that for all @xmath491 we have that @xmath1133_s$ ] is identified with @xmath1134 given by @xmath1135 and @xmath1136_s$ ] is identified with @xmath1137 . in particular , @xmath1138_w = -1 $ ] .    to compute the class of @xmath1133 $ ]",
    ", we apply the algorithm in example [ ex : matrix - extension ] to @xmath1139 .",
    "let @xmath1140 be the system of matrix units for @xmath1141 associated to a properly enumerated cyclic decomposition @xmath1112 , and let @xmath1142 be the first element in this enumeration .",
    "there then exists @xmath847 such that for all @xmath513 we have @xmath1143 .",
    "we abuse notation for sake of brevity and write @xmath654 instead of @xmath978 for @xmath1144 .",
    "lift each @xmath1145 to @xmath1146 .",
    "then we may lift each @xmath1147 to @xmath1148 .",
    "hence , we get that @xmath1149 , so that for all @xmath684 with @xmath1150 , @xmath1151    denote by @xmath1152 the indicator , which is @xmath254 if and only if @xmath1153 and @xmath811 otherwise .",
    "then , the dimension of the cokernel of @xmath397 is congruent mod @xmath1052 to @xmath1154 so we may take @xmath1155 .    as for @xmath1156 , a lift for @xmath1157 can be taken to be @xmath1158 , where @xmath1158 is the unitary associated to the properly enumerated cyclic decomposition @xmath1112 ( restricted to @xmath687 ) .",
    "then by proposition [ prop : pi - index ] and the notation there , @xmath1159 .",
    "finally , recall that the image @xmath1160_s \\in |\\omega^p| \\cdot \\mathbb{z } $ ] is identified with @xmath1138_w \\in \\mathbb{z}$ ] up to dividing by @xmath1052 , so that @xmath1138_w = -1 $ ] .",
    "we now reach the two main results of this paper , which classify stable isomorphism and * -isomorphism of c*-envelopes in terms of the underlying stochastic matrices and boundary representations supported on different copies of compact operator subalgebras .",
    "[ thm : stable - iso ] let @xmath0 and @xmath43 be finite irreducible stochastic matrices over @xmath40 and @xmath44 respectively",
    ". then @xmath1161 if and only if @xmath38 and @xmath1074 are stably isomorphic .",
    "if @xmath38 and @xmath1074 are stably isomorphic , since @xmath979 and @xmath353 are stable functors , we must have that @xmath1161 by theorem [ theorem : k - theory - computation ] .",
    "for the converse , suppose @xmath1162 . for @xmath1071 ,",
    "denote by @xmath1163 and @xmath1164 the ampliations of these extensions to @xmath1165 . by proposition [ prop : defect - computation ]",
    "we then have that @xmath1163 and @xmath1164 are weakly unitarily equivalent . hence , @xmath1166 and @xmath1167 are also weakly equivalent , so that by item ( 2 ) of proposition [ prop : c - env - char - ext ] ( with @xmath1168 ) we have that @xmath38 and @xmath1074 are stably isomorphic .",
    "[ thm:*-iso ] let @xmath0 and @xmath43 be finite irreducible stochastic matrices over @xmath40 and @xmath44 respectively",
    ". then @xmath38 and @xmath1074 are * -isomorphic if and only if @xmath1169 and there is a bijection @xmath1076 such that for all @xmath1077 we have @xmath1170 .",
    "suppose @xmath38 and @xmath1074 are * -isomorphic . by item ( 1 ) of proposition [ prop : c - env - char - ext ] there is an * -isomorphism @xmath1171 ( so that @xmath1172 ) and a bijection @xmath1076 such that @xmath1128 and @xmath1173 are strongly equivalent . by proposition",
    "[ prop : automorphism - invert ] @xmath605 is the identity on the second coordinate of @xmath1174 .",
    "hence , we see that @xmath1133 = [ j _ * \\eta_{q,\\tau(k)}]$ ] , so that @xmath1077 and @xmath1170 by proposition [ prop : defect - computation ] .    for",
    "the converse , suppose @xmath1170 for all @xmath1077 via some bijection @xmath1175 , and that @xmath47 .",
    "we see by proposition [ prop : defect - computation ] that @xmath1176 and @xmath1177 are strongly equivalent .",
    "again by proposition [ prop : defect - computation ] we have that @xmath1136 $ ] and @xmath1178 $ ] are represented by the numbers @xmath1137 and @xmath1179 which are equal by assumption .",
    "hence , we have that @xmath1128 and @xmath1180 are strongly equivalent .",
    "thus , by item ( 1 ) of proposition [ prop : c - env - char - ext ] ( with @xmath1168 ) we have that @xmath38 and @xmath1074 are * -isomorphic .    it is interesting to try and compare these invariants with the one obtained from the graph c*-algebra of the graph of the stochastic matrix @xmath0 . given an irreducible graph matrix @xmath1181 over @xmath20 , where @xmath1182 , in their first paper @xcite , cuntz and krieger defined a c*-algebra @xmath1183 generated by partial isometries @xmath1184 with pairwise orthogonal ranges , satisfying the relation @xmath1185    for a stochastic matrix @xmath0 , one has the @xmath170-matrix @xmath171 representing the directed graph of @xmath0 .",
    "since the c*-correspondence @xmath1186 is exactly the graph c*-correspondence of @xmath171 , we get that the cuntz - pimsner algebra @xmath1187 is * -isomorphic to the cuntz - krieger algebra @xmath55 . in particular , by ( * ? ? ?",
    "* corollary 7.4 ) we see that @xmath55 is nuclear .    in @xcite",
    ", cuntz computed the k - theory of these c*-algebras .",
    "he showed that for finite @xmath170 matrix @xmath12 over @xmath20 where every column and row is non - zero , the @xmath979 and @xmath353 groups of @xmath1183 are given as the cokernel and kernel of the map @xmath1188 .    in the case where @xmath12 is an irreducible finite matrix which is not a permutation matrix , cuntz and krieger",
    "establish in @xcite that @xmath1183 is simple and purely infinite .",
    "hence , for a finite irreducible stochastic matrix @xmath0 which is not a permutation matrix , the cuntz - krieger algebra @xmath55 is separable , unital , nuclear , simple and purely infinite , or in other words a kirchberg algebra .    a famous classification theorem of kirchberg and phillips then comes into play to show that for two finite irreducible stochastic matrices @xmath0 and @xmath43 which are not permutation matrices , the cuntz - krieger algebras @xmath55 and @xmath1189 are * -isomorphic ( or stably isomorphic ) if and only if @xmath1190_0 ) \\cong ( k_0(\\mathcal{o}_{gr(q)}),[1_q]_0)$ ] and @xmath1191 ( or @xmath1192 and @xmath1191 respectively ) .",
    "that is , the * -isomorphism and stable isomorphism class are completely determined by @xmath286-theory .",
    "[ ex : distinct - invariants ] in this example , we will use the above to show that for a finite irreducible stochastic matrix @xmath0 , the cuntz - krieger algebra @xmath55 and the c*-envelope @xmath38 generally yield incomparable invariants for @xmath0 .",
    "if we restrict to matrices @xmath0 with multiple - arrival , we have that @xmath939 and the invariant @xmath38 will only depend on the graph @xmath171 . hence , we will only specify the @xmath170 graph incidence matrices of three stochastic matrices @xmath1193 .",
    "suppose the graph matrices for @xmath1193 are given respectively by    @xmath1194    then @xmath1195 and @xmath51 have multiple - arrival , and it is clear that @xmath1196 for @xmath1197 , and that @xmath1198 .",
    "we also see that @xmath1199 , so that @xmath1200 .",
    "however , @xmath1201 whereas @xmath1202 , and hence @xmath1074 is not stably isomorphic to @xmath38 .    for the cuntz - krieger c*-algebras",
    "the situation is reversed .",
    "the maps @xmath1203 , @xmath1204 and @xmath1205 on @xmath1206 determining @xmath979 and @xmath353 for the cuntz - krieger algebras are given respectively by the matrices @xmath1207 hence , we see that the @xmath353 groups for @xmath55 , @xmath1189 and @xmath1208 are trivial , and that @xmath1209 , so that @xmath1210 are trivial .",
    "hence , by the above mentioned result of kirchberg and phillips , we have that @xmath55 is * -isomorphic to @xmath1189 .",
    "however , since @xmath1211 , we see that the cokernel @xmath1212 is non - trivial , and hence @xmath1208 is not stably isomorphic to @xmath55 . altogether , we obtain that @xmath52 where @xmath53 stands for * -isomorphism and @xmath54 stands for stable isomorphism .",
    "note that the c*-envelope loses considerable information about the tensor algebra , for instance , the graphs of @xmath0 and @xmath43 are not isomorphic so by ( * ? ? ?",
    "* theorem 7.29 ) @xmath45 and @xmath1213 are not even algebraically isomorphic .",
    "we would like to thank orr shalit for his many helpful remarks and suggestions on a draft version of this paper .                                                              v.  m. manuilov and e.  v. troitsky , _",
    "hilbert @xmath5-modules _ , translations of mathematical monographs , vol .",
    "226 , american mathematical society , providence , ri , 2005 , translated from the 2001 russian original by the authors .",
    "michael  v. pimsner , _ a class of @xmath5-algebras generalizing both cuntz - krieger algebras and crossed products by @xmath1223 _ , free probability theory ( waterloo , on , 1995 ) , fields inst .",
    ", vol .  12 , amer . math . soc . ,",
    "providence , ri , 1997 , pp .",
    "189212 .",
    "iain raeburn , _ graph algebras _ , cbms regional conference series in mathematics , vol .",
    "103 , published for the conference board of the mathematical sciences , washington , dc ; by the american mathematical society , providence , ri , 2005 ."
  ],
  "abstract_text": [
    "<S> in this paper we study the c*-envelope of the ( non - self - adjoint ) tensor algebra associated via subproduct systems to a finite irreducible stochastic matrix @xmath0 .    </S>",
    "<S> firstly , we identify the boundary representations of the tensor algebra inside the toeplitz algebra , also known as its non - commutative choquet boundary . as an application </S>",
    "<S> , we provide examples of c*-envelopes that are not * -isomorphic to either the toeplitz algebra or the cuntz - pimsner algebra . </S>",
    "<S> this characterization required a new proof for the fact that the cuntz - pimsner algebra associated to @xmath0 is isomorphic to @xmath1 , filling a gap in a previous paper .    </S>",
    "<S> we then proceed to classify the c*-envelopes of tensor algebras of stochastic matrices up to * -isomorphism and stable isomorphism , in terms of the underlying matrices . </S>",
    "<S> this is accomplished by determining the k - theory of these c*-algebras and by combining this information with results due to paschke and salinas in extension theory . </S>",
    "<S> this classification is applied to provide a clearer picture of the various c*-envelopes that can land between the toeplitz and the cuntz - pimsner algebras . </S>"
  ]
}