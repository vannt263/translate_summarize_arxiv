{
  "article_text": [
    "an important task of the experimental method is to estimate the true distribution of a given physical quantity from the observed one , i.e. to correct the observed spectrum for the distortion introduced by the detector and for eventual background events ( noise ) .",
    "this can be accomplished by different methods , that follow different approaches . in the following discussion",
    "the physical quantity considered will be the energy , but the discussion can be easily extended to any other observable .    in the first approach the true energy spectrum ( as well as the noise spectrum )",
    "is assumed to be described by a function of the true energy , that depends on a set of free parameters . in this case",
    "the task becomes that of estimating the free parameters of the true spectrum from the observed one , taking into account the response function of the instrument ( irf ) .",
    "this approach is called parametric inference ( fit ) , and it is implemented in the well known `` least - squares '' or `` maximum likelihood '' methods . in this case",
    "all the information contained in the observed spectrum is distilled in the model parameters .",
    "on the other hand , sometimes the experimentalist does not need to interpret the observed data within the framework of a model , but only wishes to estimate the true distribution with uncertainties , having possibly got rid of instrument distortions as well as of background .",
    "this second approach goes under the name of unfolding ( or deconvolution , or restoration ) .",
    "the purpose of the unfolding is to estimate the true distribution ( cause ) given the observed one ( effect ) , and assuming some knowledge about the eventual migration effects ( smearing matrix ) .",
    "the elements of the smearing matrix represent the probabilities to observe a given effect that falls in an observed bin @xmath0 from a cause in a given true bin @xmath1 .",
    "the smearing matrix is estimated by means of a monte carlo procedure , starting from the realistic physical processes that describe the signal to be observed .",
    "the smearing matrix also describes the losses of events due to cuts applied to extract the signal , which occur due to finite acceptance of the detector ( efficiency ) . in this way the links cause - effect ( folding ) and effect - cause ( unfolding ) are assigned in a probabilistic framework .",
    "the fermi - lat collaboration has developed a tool to reconstruct the source energy spectra based on a maximum likelihood approach , that has been made available to the scientific community @xcite .",
    "this paper presents a deconvolution method to reconstruct the energy spectra of point like sources detected with the lat instrument on board the fermi satellite .",
    "the unfolding algorithm illustrated here is based on the bayes theorem @xcite .",
    "the lat is designed to measure the direction , energy , and arrival time of gamma rays incident over a wide field - of - view ( fov ) , while rejecting background from cosmic rays @xcite .",
    "the lat irf shows a dependence both on energy and angles in the lat reference system ( e.g. @xmath2 angle with respect to the normal incidence direction lat z - axis and @xmath3 angle with respect to the lat x - axis ) .",
    "moreover , photons from a point like source will be distributed in the instrument coordinates ( i.e. @xmath4 against @xmath3 ) according to the pointing history of the source , and a method used to reconstruct the energy spectrum should properly take into account this effect .",
    "it is worth to mention here that the pointing history of the lat is provided together with the data collected , allowing to reconstruct the position of any given gamma ray source in the lat fov .",
    "this means that the true ( nominal ) position of a given source ( i.e. true @xmath2 and @xmath3 angles ) can be evaluated together with the effective observation time ( integrated live time ) .",
    "the data are assumed to be binned in histograms .",
    "the bin widths and the number of bins are chosen independently for the distribution of the observed and reconstructed variables . in the discussion",
    "hereafter we will adopt the following notations :    * @xmath5 = number of observed events in the @xmath6 bin of observed energy @xmath7 ( @xmath8 ) , in the @xmath9 bin of true @xmath4 @xmath10 ( @xmath11 ) and in @xmath12 bin of true @xmath3 angle @xmath13 ( @xmath14 ) * @xmath15 = observed live time in the @xmath9 bin of true @xmath4 ( @xmath10 ) and in the @xmath12 bin of true @xmath3 angle ( @xmath13 ) * @xmath16 = number of reconstructed events in the @xmath17 bin of true energy ( @xmath18 ) * @xmath19 = migration ( smearing ) matrix element that describes the probability to observe a given @xmath7 for a given set of true variables @xmath10 , @xmath13 and @xmath18 , once all the cuts and reconstruction algorithms have been applied in analyzing the data sample .",
    "a standard analysis cut is imposed on the angular distance between the direction of reconstructed events and the nominal ( true ) source direction ( region of interest , i.e. roi cut ) .",
    "this cut is related to the angular containment of events , due to finite angular resolution of the lat ( that is expressed in terms of the point spread function , psf ) .",
    "the roi cut is also taken into account in the evaluation of the total live time of the source to be analyzed .",
    "further cuts are applied to reject eventual earth albedo events .",
    "it is worth to point out that the smearing matrix is computed in a multi - dimensional space ( in our case up to 4 dimensions are used ) .",
    "however , the unfolding procedure that will be shown here is limited to two or three dimensions .",
    "in fact , the migration matrix describes the full migration from the true bins to the observed ones , and it is always possible the drop one or two dimensions by computing the smearing matrix and the observed distribution in a proper way .",
    "for instance , the 3-dimensional case is obtained dropping the dimension connected to the @xmath3 angle .",
    "the smearing matrix is evaluated from monte carlo simulations by means of gleam , the full simulation package of the lat based on the geant 4 toolkit @xcite , in which a trial spectrum of input photons is simulated .",
    "the matrix @xmath20 is computed as the ratio between the reconstructed number of events after applying the cuts and the number of generated events , i.e. @xmath21    the smearing matrix in three and two dimensions is evaluated starting from the previously reconstructed and generated number events by a weighting procedure , i.e. @xmath22 @xmath23 where the weight as function of @xmath4 and @xmath3 is evaluated from the pointing history of the source to be analyzed , and represents the integrated live time of the observed source as function of @xmath4 and @xmath3 angles in the local reference system of the lat .",
    "consequently the observed numbers of events are evaluated in a 2 or 1 dimensional histogram , i.e. @xmath24    the true energy range ( mc energy ) has been divided into 90 bins with logarithmic constant step ( i.e. 20 bins / decade ) from @xmath25 mev ( @xmath26 ) to @xmath27 mev ( @xmath28 ) , while the observed energy range from 10 mev to @xmath29 mev has been divided in 120 bins , i.e. 20 bins / decade too .",
    "in this the irf table can also evaluated by merging the bins into groups of 2 ( i.e. 10 bins / decade ) , 3 ( 20 bins/3decades ) , 5 ( i.e. 4 bins / decade ) or 10 ( i.e. 2 bins / decade ) .",
    "the smearing matrix could be also evaluated using the gtobssim package , that is provided in the standard lat science tools ( st ) @xcite software , using a trial spectrum with a source at the same celestial coordinates as the real one .",
    "once the smearing matrix has been built , the true energy spectrum of the point - like gamma ray source under analysis is evaluated by means of a bayesian unfolding method ( see ref.s @xcite and @xcite ) .",
    "the unfolding analysis allows to reconstruct the number of events belonging to each bin of true energy ( @xmath30 ) . the integral flux in the @xmath17 energy bin ( in units of photons per unit area and unit time )",
    "is then evaluated dividing the @xmath16 reconstructed events in the bin for the area of the sphere used for the generation of the monte carlo data sample ( @xmath31 ) and for the integrated live time of the source . the differential flux in that bin ( in units of photons per unit area , unit time and unit energy )",
    "is then evaluated dividing the integral flux for the corresponding bin width .",
    "a crucial point for such analysis is the evaluation of the background energy spectrum and its subtraction from the observed one .",
    "the background distribution can be safely evaluated by using the real data sample , for istance when the source is standalone or when the source is a pulsar . in the first case",
    "the background equivalent events can be evaluated in an external annulus to the roi used in the analysis , and are properly scaled taking into account the solid angle and the eventual difference in the observation time . in the case of large background gradients ( e.g. point source at low galactic latitude )",
    "this method could yield a wrong estimate of the background , in particular if the external annulus is chosen either too far from the source position , or if its area is too large . in these cases",
    "the background counts folded with instrument can be evaluated using a mc procedure ( e.g. gtobssim package ) with the background model as input , including the diffuse and extra - galactic components and eventual point sources .    in the second case ,",
    "since only the pulsed emission is being investigated , the observed spectrum is built from on - pulse photons , while the background spectrum is evaluated from off - pulse photons and rescaled from the on - off phase ratio .",
    "the background distribution is then subtracted bin by bin to the observed one to evaluate the  signal  distribution .",
    "in this section the results obtained with simulated data sets using the gtobssim package are shown .",
    "more applications to simulated data sets can be found in ref .",
    "@xcite while some results with real data can be found in ref.s  @xcite .",
    "pixels ) in @xmath32 circle around the point source .",
    "the diffuse background emission is also visible.,width=192 ]    a steady source has been simulated in a sky position with celestial coordinates ( @xmath33 , @xmath34 ) ( i.e. 3c454.3 position ) with a power law spectrum , @xmath35 , having a spectral index @xmath36 and a flux above 100 mev of @xmath37 , for a total time of 30 days . this source has been simulated using the  gamma - ray point source  in the xml file model editor @xcite . the pass6 v1 diffuse irf has been used for the simulated data set .",
    "both galactic and extragalactic diffuse photon backgrounds have also been included in the simulation .",
    "a realistic pointing history profile has been also used .",
    "[ fig1 ] shows the count map of total events detected in @xmath32 circle around the source .",
    "[ fig2 ] shows the source position distribution in the instrument coordinates .    )",
    ".,width=268 ]        fig .",
    "[ fig3 ] shows the observed energy distribution and the background events evaluated in the annulus and rescaled taking solid angle and live time into account .",
    "an energy dependent roi is used to select events around the true position of the source , i.e. @xmath38 this function reproduces the energy dependence of the 68% angle containment for photons converting in the back section of the fermi lat .",
    "the lower bound of @xmath39 at high energies allows to suppress significantly the background events .",
    "the background has been evaluated in an external annulus from @xmath40 to @xmath41 centered in the source position and the solid angle scaling factor depends on the energy too .",
    "the true source and background distribution are also shown with the observed ones .",
    "the background evaluated in the annulus is a good estimation of the true one .",
    "[ fig4 ] shows the reconstructed flux as function of true energy .",
    "the simulated input spectrum model is also shown .",
    "the agreement is very good .",
    "usually , the smearing matrix is evaluated implementing in the simulation a trial spectrum with a simple power law shape with spectral index 1 ( i.e. a uniform distribution is chosen in logarithmic energy scale ) .",
    "this procedure could introduce a small bias due to the finite energy binning , especially in case of coarse binning , when the shape of the trial spectrum is strongly different from the one of the real spectrum .",
    "however , the dependence of the smearing matrix on the energy binning can be dropped implementing an iterative procedure in which the smearing matrix is reevaluated using the unfolded spectrum as trial spectrum , and a new unfolding is performed with this smearing matrix .    as mentioned above , a crucial issue for any spectral analysis",
    "is the evaluation of background , since a correct background estimate is a necessary condition for a correct reconstruction of the source spectrum . in this analysis",
    "the background can be evaluated either from real data or from a model .",
    "the use of real data turns out to be the most reliable way to evaluate the background in the case of pulsating sources .",
    "in fact , in this case the background is estimated from `` off - pulse '' photons from the same spatial region used for the `` on - pulse '' analysis , and there are no reasons to believe that the background is not homogeneous with respect to the phase .    on the other hand , in case of steady point sources ,",
    "the background evaluation from data could not be the best choice .",
    "in fact , in this case the background spectrum is evaluated from photons in a spatial region external to the roi selected for the analysis and is extrapolated to it , and therefore does not necessarily reproduce the spectrum inside the portion of sky under analysis . this way to evaluate the background",
    "can be considered reliable in the case of isolated sources , but is not recommended when there are strong anisotropies in the background distribution , as in the case of sources in the galactic plane . in these cases ,",
    "the background can be evaluated with the gtobssim package , after implementing a model that takes into account all the background components ( galactic diffuse , extragalactic diffuse , point sources close to the source under analysis ) .",
    "of course this technique of evaluating the background can be implemented for any source , and in case of isolated sources at high galactic latitude the results obtained are found to be consistent with the ones obtained when the background spectrum is evaluated from real data .",
    "the gtobssim package allows to generate simulated background data sets corresponding to a given observation period starting from any input model , and includes both angular and energy dispersion .",
    "another possible tool for simulating the background is gtmodel @xcite , but in this case , since dispersion is not taken into account , it is necessary to fold the simulated background with the smearing matrix or to simulate dispersion with the gtrspgen package @xcite . in the case of real data , it is possible to fit the source and the background with the gtlike tool @xcite , and the fitted background model can be used as input to gtmodel .",
    "this procedure could be done in each energy bin , ensuring a better evaluation of the shape of background spectrum .",
    "another aspect that is worth to point out concerns the spectral fitting .",
    "as pointed out in this report , the unfolding analysis method does not assume any functional model for the source spectra , but this does not preclude the possibility of fitting the reconstructed spectra .",
    "however , when fitting an unfolded spectrum , some attention must be paid to the errors associated to its points . it is worth to point out that some correlations exist among the points of the reconstructed spectrum , that should be taken into account when the fit is performed .",
    "these correlations are evaluated when the unfolding is performed , and are expressed in terms of the elements of a covariance matrix @xmath42 , that usually is not diagonal . when the spectrum is fitted with a function @xmath43 of the energy and of a set of parameters @xmath44 , the @xmath45 to be minimized",
    "must be expressed as : @xmath46 where @xmath47 is the observed number of events in the @xmath9 energy bin , @xmath48 is the number of events predicted by the model in the same bin and @xmath49 are the elements of the inverse of the covariance matrix .",
    "in this report an unfolding technique to reconstruct the energy spectra of point gamma - ray sources detected by the fermi - lat instrument has been illustrated .",
    "this method does not assume any parametric model for the source spectra .",
    "on the other hand , if the experimenter wishes to explain the results in the framework of a given model , a covariance matrix among the experimental points is provided that allows to fit the unfolded spectra with any function .",
    "finally , the contribution of systematic errors to the covariance matrix of the results can be easily implemented @xcite .",
    "99 http://fermi.gsfc.nasa.gov/ssc/data/analysis/documentation/cicerone g.  dagostini , nucl .",
    "methods in phys .",
    "res . * a 362 * ( 1995 ) 487 w.b .",
    "atwood et al . , _ the large area telescope on the fermi gamma - ray space telescope mission _ , apj 697 ( 2009 ) 1071 , arxiv:0902.1089v1 [ astro-ph.im][arxiv:0902.1089v1 [ astro-ph.im ] ] m.n .",
    "mazziotta et al . , _ a method to reconstruct the energy spectra of point like sources with the lat - fermi instrument _ , in preparation m.n .",
    "mazziotta et al . , _ spectral energy distribution analysis of fermi bright blazars from radio to tev energies _ , these proceedings f.  gargano , _ spectral analysis of egret pulsars _ , these proceedings s.  rain et al . , _ fermi view of the tev blazar markarian 421 _ , these proceedings"
  ],
  "abstract_text": [
    "<S> the large area telescope ( lat ) onboard the fermi satellite is exploring the gamma - ray sky in the energy range above 20mev . </S>",
    "<S> we have developed a method to reconstruct the energy spectra of the gamma rays detected by the fermi lat instrument based on a bayesian unfolding approach . </S>",
    "<S> the method has been successfully applied to simulated data sets to reconstruct the energy spectra of both steady and pulsating point sources . </S>",
    "<S> the basic ideas and the procedures implemented to evaluate the energy spectra of gamma ray sources will be illustrated , and the results of the application of the method to a typical test case will be shown .    </S>",
    "<S> spectral analysis ; deconvolution ; gamma rays . </S>"
  ]
}