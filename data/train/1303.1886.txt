{
  "article_text": [
    "sudoku , which is also called number place , is a kind of pencil puzzles  @xcite .",
    "each sudoku puzzle has @xmath0 grid , which has nine @xmath1 subgrids .",
    "there are some numbers in cells .",
    "the objective of the puzzle is to complete the grid by filling numbers in empty cells so that each row , column , and subgrid contains all of numbers from 1 to 9 .",
    "sudoku puzzles are now extremely popular in the world , and recently sudoku have attracted much attention as mathematical and physical points of view . in 2002 , solving sudoku puzzle is proved to be np - complete problems  @xcite .",
    "all possible sudoku solutions is enumerated by felgenhauer and jarvis  @xcite .",
    "solving sudoku puzzles corresponds to find the grand state of the antiferromagnetic 9-state potts model with special interactions .",
    "the similarity between the sudoku problems and spin - glass systems has been pointed out  @xcite .",
    "williams and ackland defined a sudoku hamiltonian , and observed thermodynamic phase transitions by utilizing monte carlo ( mc ) simulations  @xcite .",
    "they also pointed out that the energy landscape of the sudoku hamiltonian is rugged , and the model show similar behavior to spin - glass systems .",
    "from the view point of the computing , it is rather easy to find the solution of the given puzzle .",
    "however , it is not trivial to make difficult puzzles by using computers . in 2010 ,",
    "arto inkara created a difficult sudoku puzzle ( inkara2010 )  @xcite which is shown in fig .",
    "[ fig_inkara ]  ( a ) .",
    "later , he created a more difficult one in 2012 ( inkara2012 )  @xcite which is shown in fig .  [ fig_inkara ]  ( b ) . to our best knowledge , inkara2012 is the world hardest sudoku puzzle ever created .",
    "the purpose of the present manuscript is to create a sudoku puzzle which is more difficult than inkara2012 , and consequently is the world hardest , by utilizing a mc method .",
    "this manuscript is organized as follows . a method to solve sudoku puzzles and a definition of difficulty",
    "are described in sec .",
    "[ sec_difficulty ] .",
    "the algorithms for finding difficult puzzles are explained in sec .",
    "[ sec_method ] .",
    "the numerical results are given in sec .",
    "[ sec_results ] and a summary and a discussion of further issues are given in sec .",
    "[ sec_summary ] .     3.25 , respectively .",
    "( b ) the puzzle made in 2012 ( inkara2012 ) , which depth is 8 , normal width is 3599 , and average width = 2257 @xmath2 25.7 , respectively .",
    ", title=\"fig:\",width=154 ]   3.25 , respectively .",
    "( b ) the puzzle made in 2012 ( inkara2012 ) , which depth is 8 , normal width is 3599 , and average width",
    "= 2257 @xmath2 25.7 , respectively . ,",
    "difficulty of sudoku puzzles depends on a method to solve them .",
    "therefore , we describe the method to solve sudoku puzzles . while there are many kinds of techniques , we adopt only two of them , pencil marks and recursive backtracking ( see fig .  [ fig_pm ] ) .",
    "* pencil marks * : pick up an empty cell .",
    "check all the numbers in the row , column , and subblock to which the cell belongs . then list up all numbers which are still possible in the empty cell .",
    "these numbers are called pencil marks .",
    "if a cell has only one pencil mark , then the mark is the value of the cell .",
    "repeat the above procedure until all empty cells have two or more pencil marks .",
    "* recursive backtracking * : pick up the cell which has the smallest number of pencil marks . then choose one of the pencil marks and assume that it is the value of the cell , and continue to solve the problem recursively .",
    "if the assumed value does not lead to the complete solution , then choose another value of the pencil marks .",
    "the algorithm to solve sudoku puzzles involves the iteration of pencil marks and recursive backtracking .",
    "since the computational costs of pencil marks are cheap , we do not includes pencil marks to difficulty .",
    "we define three kinds of properties for sudoku puzzles , depth , normal width , and average width , respectively .",
    "the depth is the smallest number of recursive backtracking to solve a puzzle .",
    "if a puzzle is solved only with pencil marks , then the depth of the puzzle is zero .",
    "the width is the number of recursive backtracking required to confirm that the puzzle has a unique solution .",
    "it is possible that there are two or more empty cells which have the same number of pencil marks . in fig .",
    "[ fig_pm ] , the smallest number of pencil marks in cells is two , and there are four cells which have two pencil marks .",
    "a value of width depends on a choice of cells to perform recursive backtracking .",
    "we define two kinds of width , the normal width and the average width . *",
    "normal width * : if there are two or more candidates of cells , chose a cell in top - left order .",
    "the choice of cells is deterministic , and the value of width is determined uniquely .",
    "* average width * : if there are two or more candidates of cells , chose a cell randomly .",
    "the value of the average width is stochastic .",
    "the recursive backtracking process constructs a tree structure .",
    "the root node of the tree is the given puzzle .",
    "when a empty cell is chosen for recursive backtracking , then the number of pencil marks in the cell corresponds to the number of edges of the nodes .",
    "each child node corresponds to a grid with an assumed number in the chosen cell .",
    "the tree is constructed recursively for children .",
    "since we have a choice of cells to perform recursive backtracking , there are many possibility for the tree structure .",
    "the depth is the shortest path from the root node to the node describing answer between all possible trees .",
    "the width is a number of nodes in the tree graph .",
    "computational cost to search the solution is proportional to width of the graph .",
    "therefore , we adopt width as difficulty of sudoku puzzles . since the value of the normal width depends on orientation of a puzzle , the average width is more appropriate for difficulty of sudoku puzzles than the normal width . since a number of possible trees increases exponentially as a number of recursive backtracking increases , it is impossible to enumerate all possible trees . therefore , we estimate the average width by mc sampling . in the present manuscript ,",
    "we calculate average width for each puzzle from 100 independent samples .",
    "suppose a solution of a puzzle , _",
    "i.e. _ , all of cells are filled with numbers , is given . to create a puzzle , we have to remove some of numbers from the grid .",
    "the rest numbers are hints of this puzzle .",
    "we label cells from @xmath3 to @xmath4 , and describe the state of @xmath5-th cell by a _ spin _ @xmath6 ; the @xmath5-th cell is empty when @xmath7 and the cell keeps the number of the answer when @xmath8 .",
    "a set of spin configuration @xmath9 denotes a puzzle .",
    "we define an ising spin - glass like hamiltonian of this system as @xmath10 where @xmath11 denotes the internal energy given by the configuration @xmath9 , @xmath12 is the interaction energy , and @xmath13 is the amplitude of the external field , respectively .",
    "the interaction energy @xmath11 is defined so that the energy of the system decreases when the puzzle is more difficult .",
    "we define two kinds of internal energy , depth energy @xmath14 and width energy @xmath15 .",
    "consider a puzzle which depth is @xmath16 and normal width is @xmath17 .",
    "then the depth and width energies are defined to be @xmath18 since @xmath19 , the energies decrease as depth or width increase .",
    "we adopt logarithm for the width energy since width increases exponentially as a number of recursive backtracking increases .",
    "the energies depend on spin configuration @xmath9 , but the relation between them is highly complicated . while one can easily calculate the energies from the given spin configuration , it is almost impossible to find the grand state , _",
    "i.e. _ , to find the spin configuration which describes the most difficult puzzle for the given solution of the puzzle  @xcite .",
    "this property is similar to that of spin - glass models .    the second term in the right - hand side of eq .",
    "( [ eq_hamiltonian ] ) increase energy when a number of hints of a puzzle increases .",
    "this term corresponds to an external field . while we have to minimize only the internal energy for the purpose to search a difficult puzzle , we added this term since to apply a bias to reduce a number of hints . since the spins are all - up in the initial states , it is difficult to decrease energy without this term .",
    "our purpose is to create a puzzle width a large value of average width .",
    "but we find that it is difficult to obtain large values of width from the initial state where all spins are up .",
    "therefore , we first perform mc simulations in the depth - first order , then we switch to that in the width - first order .    in order to update a configuration of spins ,",
    "we adopt the markov chain monte carlo method .",
    "choose a spin randomly and flip it with the metropolis criterion with the boltzmann weight  @xcite .",
    "note that , a spin - flip from down to up always increases energy , and that from up to down always decreases energy .",
    "if a new configuration has two or more solutions , then the trial is rejected .",
    "since the model is similar to ising spin - glass models , there are many local minima in the energy land scape . in order to search lower - energy states efficiently ,",
    "we adopt replica - exchange monte carlo ( remc ) method  @xcite , which is also called parallel tempering method .",
    "the remc method is proposed by hukushima and nemoto in order to study hardly - relaxing systems such as spin - glass systems efficiently . in the remc method , many replicas sharing the identical hamiltonian are simulated simultaneously and temperatures of replicas are sometimes exchanged .",
    "the remc method requires a tuned set of temperatures to work efficiently .",
    "the set should includes a temperature which is high enough to escape from any local minima and a temperature which is low enough to search the grand state .",
    "additionally , a number of temperatures should be sufficient so that exchange ratios between adjacent temperatures are high enough .",
    "usually , a temperature set is determined by preliminary simulations and the set is fixed throughout simulations . however , many temperatures , and consequently , many replicas are required for sudoku problems since the range of energy is wide .",
    "therefore , we adjust the temperature set simultaneously throughout simulations to keep exchange ratios between replicas . while we can not obtain the canonical ensemble without a fixed set of temperatures , it is not problem since we are interested only in the configuration having the lowest energy ,    in order to obtain a temperature set which achieves same exchange ratio between neighboring temperatures , the following procedure is proposed  @xcite .",
    "@xmath20 where @xmath21 is a number of replicas , @xmath22 is the inverse temperature of the @xmath23-th replica at the @xmath24-th exchange of temperature , and @xmath25 is the acceptance ratio of exchange between the @xmath23-th and the @xmath26-th replicas , respectively . the value of @xmath27 is estimated from mc sampling between exchange .",
    "after convergence , the acceptance ratios will share the identical value as @xmath28 .",
    "however , with a large number of iterations , the temperature set can converge into the following trivial state @xmath29 in order to prevent the trivial convergence , we determine a desired value of acceptance ratio @xmath30 as follows , @xmath31 let @xmath32 is a number of mc steps between exchange processes , _",
    "i.e. _ , a number of samples to estimate the acceptance ratios @xmath33 .",
    "if energy difference between adjacent replicas is extremely large , then the acceptance ratio between the replicas becomes extremely small .",
    "then the acceptance ratio @xmath25 is estimated to be zero .",
    "once it happens , we have @xmath34 throughout the simulations which means that the number of replicas virtually decreases . in order to avoid the above",
    ", we adopts @xmath35 instead of @xmath25 if the exchange is not performed between @xmath23-th and @xmath26-th replica in @xmath32 mc steps .",
    "finally , we obtain the following procedure to adjust temperatures as , @xmath36 the above procedure guarantees that the all temperatures have different value and a temperature increases when some of replicas are trapped in a local minimum .",
    "we choose the initial set of temperatures as @xmath37 the highest temperature @xmath38 is fixed throughout simulations .      from preliminary simulations ,",
    "we adopt the interaction energy @xmath39 and the external field @xmath40 for both depth - first and width - first order calculations .",
    "first we create a solution of sudoku puzzle randomly , then we perform the depth - first order search with the simple mc simulation with @xmath41 .",
    "after we find a puzzle with depth larger than 8 , we perform the width - first search with the remc method .",
    "we choose a number of mc steps between temperature exchange to be @xmath42 .",
    "the highest temperatures is set to be @xmath43 which is high enough to escape any local minim . the desired acceptance ratio for exchange @xmath30 and a number of replicas @xmath21 are chosen to be @xmath44 and @xmath45 , respectively .",
    "the most time consuming part of this simulation is to calculate energy .",
    "therefore , we adopt the normal width for internal energy in eq .",
    "( [ u_width ] ) instead of the average width to save computational time .",
    "we list up the candidates of hard puzzles from simulations , and determine the hardest one by calculating average width for each candidate .",
    "since computational costs strongly depend on temperature , it is inefficient to perform parallel computation for remc due to load imbalance",
    ". therefore , we assign all replicas to one process , _ i.e. _ , a simulation of each replica is performed serially .",
    "throughout simulations . one can see that the temperatures oscillate .",
    "thanks to the oscillation , the replicas can escape from local minima and visit both high- and low - energy states .",
    ", title=\"fig:\",width=302 ]   throughout simulations .",
    "one can see that the temperatures oscillate .",
    "thanks to the oscillation , the replicas can escape from local minima and visit both high- and low - energy states .",
    ", title=\"fig:\",width=302 ]    in order to investigates the efficiency of the simultaneous temperature adjustments , we perform simulations with and without the adjustments .",
    "each simulation contains 10 replicas , and 2048 independent samples are investigated for simulations with and without adjustments .",
    "we adopt the trivial parallelization , _",
    "i.e. _ , simulations are performed independently with different seeds of random numbers .",
    "computations are carried on sgi altix ice 8400ex at the institute for solid state physics , the university of tokyo .",
    "computational time is 24 hours for each run and the total amount of the computational time is about 11 cpu - core - years .",
    "the cumulative distribution function ( cdf ) of the minimum energies found by the simulations are shown in fig .",
    "[ fig_hist ] .",
    "the cdf @xmath46 is a probability that the lowest energy found by each process is smaller than @xmath47 .",
    "it shows that the simulations with temperature adjustments is more efficient than that without adjustments .",
    "typical time evolutions of temperatures and energies of a run with the temperature adjustments are shown in fig .",
    "[ fig_results ] .",
    "the reason that temperatures oscillate is as follows .",
    "when one replica is trapped into a local minimum , then acceptance ratio of exchange temperature between the replica and its neighbor decreases .",
    "it increases temperature of the replica . after the replica escapes from the local minimum , then the acceptance ratio increases and the temperature decreases again . from the variation rage of the lowest temperature",
    ", we estimate that over 35 replicas are necessary to keep the desired acceptance ratio without the temperature adjustments , while we used only 10 replicas .",
    "it means that the simultaneous temperature adjustments work efficiently .",
    "figure  [ fig_results ]  ( b ) shows that the energies of replicas fluctuate from high - energy states to low - energy states which means that the exchange of temperatures works efficiently .",
    "we obtain 2048 candidates of difficult puzzles from the simulations with the simultaneous temperature adjustments .",
    "we calculate an average width for each candidates , and determine the hardest one which is shown in fig .  [ fig_watanabe ] .",
    "the hardest puzzle s depth is @xmath48 and average width is 100571 @xmath2 1198 , respectively .",
    "this is about 44 times more difficult than inkara2012 .",
    "if one adopts only pencil marks and recursive backtracking techniques to solve this puzzle , then about 50000 times recursive backtracking is necessary to solve it , and therefore , it is almost impossible to solve by hand .",
    "we define the hamiltonian describing the difficulty of sudoku puzzles .",
    "then creating difficult puzzles reduces to minimizing the energy defined by the hamiltonian . we perform the remc method to minimize the hamiltonian , and succeed to create a sudoku puzzle which is much harder than inkara2012 in our definition of difficulty . to our best knowledge",
    ", this is the world hardest puzzle ever created .",
    "while the remc is a method to obtain canonical ensemble of different temperatures simultaneously , we propose the remc with simultaneous adjustments of temperature which does not guarantee canonical ensembles .",
    "the results presented in this manuscript demonstrates that the remc method is useful not only for physical problems , but for general optimization problems .",
    "a definition of difficulty strongly depends on solving algorithms .",
    "we adopt only two techniques , pencil marks and recursive backtracking , while there are many kinds of techniques to solve sudoku puzzles .",
    "therefore , the difficulty defined in the present manuscript can be different from the actual feeling .",
    "but once the definition of the difficulty is given , then difficult puzzles can be created in that definition since the method proposed in the present manuscript is general and it is independent of a definition of difficulty .",
    "while we adopt the remc method here , there are other optimization methods , such as genetic algorithm or simulated annealing , and so forth .",
    "it is one of the further issues to compare such algorithms with remc .",
    "since we are interested only in the lowest energy state , it is not necessary to achieve canonical ensemble for given temperature .",
    "therefore , we have a choice of the transition probability . while we adopt the boltzmann weight both for mc and remc , it is possible to accelerate finding lower energy states by adopting general transition probability  @xcite .    in the present manuscript",
    ", we create a difficult sudoku puzzle .",
    "it is not always true that a difficult puzzle is interesting one .",
    "however , if we can define a quantity describing how interest a puzzle is , then we can create interesting puzzles by adopting the similar method proposed here .",
    "the programs used in the present manuscript are published as open source software  @xcite .",
    "the computations were carried out by using facilities of the supercomputer center , institute for solid state physics , university of tokyo .",
    "we would like to thank n. kawashima , s. todo , and t. okubo for helpful discussions .",
    "similar to solving sudoku puzzles , it is expected that to determine the grand state of hamiltonian in eq .",
    "( [ eq_hamiltonian ] ) for the given solution would be also np - compete . however , it is not proven yet to our best knowledge ."
  ],
  "abstract_text": [
    "<S> an algorithm to create difficult sudoku puzzles is proposed . </S>",
    "<S> an ising spin - glass like hamiltonian describing difficulty of puzzles is defined , and difficult puzzles are created by minimizing the energy of the hamiltonian . </S>",
    "<S> we adopt the replica exchange monte carlo method with simultaneous temperature adjustments to search lower energy states efficiently , and we succeed in creating a puzzle which is the world hardest ever created in our definition , to our best knowledge . </S>",
    "<S> ( added on mar . </S>",
    "<S> 11 , the created puzzle can be solved easily by hand . </S>",
    "<S> our definition of the difficulty is inappropriate . ) </S>"
  ]
}