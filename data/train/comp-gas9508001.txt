{
  "article_text": [
    "the lattice boltzmann equation ( lbe ) method has achieved great success for simulation of transport phenomena in recent years . among different lbe methods ,",
    "the lattice boltzmann bgk model is considered more robust @xcite . besides , theoretical discussion is easier for the lbgk due to its simple form . some recent theoretical discussions on lbgk @xcite",
    "have enhanced our understanding of the method and the effect of boundary conditions . in @xcite , analytical solutions of distribution functions for plane poiseuille flow with forcing and plane couette flow have been obtained for the 2-d triangular and square lattice boltzmann bgk models .",
    "it is found that the bounce - back boundary condition produces distribution functions with a first - order error compared with the analytical distribution functions . in @xcite",
    ", a new technique was developed to seek the analytic solution of lbgk model for some simple flow .",
    "for example , the velocity profile from the 2-d square and triangular lbgk models are shown to satisfy a second - order difference equation of the navier - stokes equation in the case of plane poiseuille flow with forcing and couette flow .",
    "the technique is generalized in @xcite to include steady - state flows with both @xmath0 and @xmath1 velocities , which are assumed to be independent of @xmath0 .",
    "the analysis provides a framework to analyze any velocity boundary condition .",
    "for example , the analysis explains why the velocity boundary condition for the 2-d triangular lbgk model proposed in @xcite generates results of machine accuracy for plane poiseuille flow with forcing .    in practice , however , a flow is often driven by pressure difference .",
    "in general , the pressure gradient through the flow field is not a constant and the local pressure gradient is unknown before solving the flow .",
    "hence the pressure gradient in many cases can not be replaced by an external force in lbgk computations . in this situation",
    ", boundary conditions usually need be implemented by giving prescribed pressure or velocity on some `` flow boundaries '' , which are not solid walls or interfaces of two distinct fluids . instead , they are imaginary boundaries inside a flow domain ( e.g. inlet and outlet in a pipe flow ) .",
    "their existence is purely for the convenience of study .",
    "the implementation of these boundary conditions in lbgk is very important but it has not yet been well studied .    since in lattice",
    "boltzmann method , the pressure is related to the density by the isothermal equation of state as @xmath2 ( @xmath3 is the sound speed of the model ) , a specification of pressure difference amounts to a specification of density difference .",
    "early works ( see , for example , @xcite ) to implement pressure ( density ) flow boundary condition is simply to assign the equilibrium distribution computed with the specified density and some velocity ( maybe zero ) to the distribution function .",
    "this method introduces significant errors : the real pressure gradient obtained in the simulation for the poiseuille flow is not a constant .",
    "it is approximately a constant only some distance away from the inlet and outlet of the channel . besides , even away from the inlet and outlet region , the pressure gradient is different from the intended value .",
    "@xcite proposed an alternative pressure or velocity flow boundary condition for the 3-d 15-velocity direction lbgk model , and their results are greatly improved over the equilibrium distribution approach .",
    "the pressure or velocity flow boundary condition in @xcite is obtained through a post - streaming rule to the distribution functions based on an extrapolation . however , this pressure or velocity boundary condition is still to be improved due to some inconsistency ( see discussion in section 2 ) .",
    "its inaccuracy is most noticeable in the following case : when this pressure or velocity boundary condition is applied to the modified lbgk @xcite , which corresponds to a macroscopic momentum equation having the analytical solution of poiseuille flow with pressure ( density ) gradient , the simulation results are far from the analytical results .    in this paper",
    ", we propose a general way to specify pressure or velocity on flow boundaries .",
    "the implementation is a natural extension of the wall boundary condition described in our previous paper @xcite .",
    "the result shows a clear improvement to the flow boundary conditions in @xcite for ordinary lbgk models .",
    "besides , for the modified lbgk model , these flow boundary conditions produce results of machine accuracy for poiseuille flow .",
    "the square lattice lbgk model ( d2q9 ) is expressed as ( @xcite,@xcite,@xcite ) : @xmath4 , \\ \\",
    ",8 , \\label{eq : lbgk}\\ ] ] where the equation is written in physical units . both the time step and the lattice spacing have the value of @xmath5 in physical units .",
    "@xmath6 is the density distribution function along the direction @xmath7 at ( @xmath8 ) .",
    "the particle speed @xmath7 s are given by @xmath9 , and @xmath10 .",
    "rest particles of type 0 with @xmath11 is also allowed ( see fig .  1 ) .",
    "the right hand side represents the collision term and @xmath12 is the single relaxation time which controls the rate of approach to equilibrium . the density per node , @xmath13 , and the macroscopic flow velocity , @xmath14 ,",
    "are defined in terms of the particle distribution function by @xmath15 the equilibrium distribution functions @xmath16 depend only on local density and velocity and they can be chosen in the following form ( the model d2q9 @xcite ) : @xmath17 , \\mbox{\\hspace{1.65 in } } \\nonumber\\\\ f_{i}^{(eq)}&=&\\frac{1}{9}\\rho[1 + 3({\\bf e}_{i}\\cdot { \\bf u})+\\frac{9}{2}({\\bf e}_{i}\\cdot { \\bf u})^2-\\frac{3}{2}{\\bf u}\\cdot { \\bf u}],\\;\\ ; i =   1,2,3,4 \\\\ f_{i}^{(eq)}&=&\\frac{1}{36}\\rho[1 + 3({\\bf e}_{i}\\cdot { \\bf u})+\\frac{9}{2}({\\bf e}_{i}\\cdot { \\bf u})^2-\\frac{3}{2}{\\bf u}\\cdot { \\bf u } ] , \\;\\ ; i =   5,6,7,8 .",
    "\\nonumber \\label{eq : equil}\\end{aligned}\\ ] ]    a chapman - enskog procedure can be applied to eq .",
    "( [ eq : lbgk ] ) to derive the macroscopic equations of the model .",
    "they are given by : the continuity equation ( with an error term @xmath18 being omitted ) : @xmath19 and the momentum equation ( with terms of @xmath18 and @xmath20 being omitted ) : @xmath21 where the einstein summation convention is used .",
    "@xmath22 is the strain - rate tensor .",
    "the pressure is given by @xmath2 , where @xmath3 is the speed of sound with @xmath23 and @xmath24 , with @xmath25 being the the kinematic viscosity .",
    "the form of the error terms and the derivation of these equations can be found in @xcite .    in this paper",
    ", we will take the poiseuille flow as an example to study the pressure ( density ) or velocity inlet / outlet condition .",
    "the analytical solution of poiseuille flow in a channel with width @xmath26 for the navier - stokes equation is given by : @xmath27 where the pressure gradient @xmath28 is a constant related to the centerline velocity @xmath29 by @xmath30 and the flow density @xmath31 is a constant .",
    "the reynolds number is defined as re = @xmath32 .",
    "the poiseuille flow is an exact solution of the steady - state incompressible navier - stokes equations : @xmath33 @xmath34 on the other hand , the steady - state macroscopic equations of lbgk model , eq .",
    "( [ eq : lbgk ] ) , is given by : @xmath35 @xmath36 these equations are different from the incompressible navier - stokes equations eqs .",
    "( [ eq : a64],[eq : a65 ] ) by terms containing the spatial derivative of @xmath31 .",
    "these discrepancies are called compressibility error in lbe model .",
    "thus , the poiseuille flow given by eq .",
    "( [ eq : pois ] ) is not the exact solution of eqs .",
    "( [ eq : conts ] , [ eq : momens ] ) when pressure ( density ) gradient drives the flow .",
    "that is , due to change of pressure ( density ) in the @xmath37direction , @xmath38 is not constant in the @xmath37direction , and the velocity profile of the solution of eqs .",
    "( [ eq : conts ] , [ eq : momens ] ) is no loger a parabolic profile . for a fixed mach number ( @xmath29 fixed ) , as @xmath39 , the velocity of the lbgk simulation will not converge to the velocity in eq .",
    "( [ eq : pois ] ) because the compressibility error becomes dominating .",
    "this phenomenon is seen in the result in @xcite , where the error of velocity increases as the number of lattice grid increases .",
    "besides , from @xmath40 ( suppose @xmath41 in the simulation ) , one can see that @xmath38 should be increasing linearly along the flow direction since @xmath31 is decreasing linearly .",
    "this makes the comparison of @xmath38 with the analytical velocity of poiseuille flow somehow ambiguous .    to make a more sensible study for poiseuille flow with pressure ( density ) or velocity flow boundary condition , it is better to use the improved incompressible lbgk model proposed in @xcite . the model ( called d2q9i )",
    "is given by eq .",
    "( [ eq : lbgk ] ) with the same @xmath7 and the following equilibrium distributions : @xmath42 ,    \\nonumber \\\\   f_{i}^{(eq)}&=&\\frac{1}{9 }   [ \\rho + 3 { \\bf e}_{i } \\cdot { \\bf v } +    \\frac{9}{2}({\\bf e}_{i } \\cdot { \\bf v})^2 - \\frac{3}{2 } { \\bf v}\\cdot{\\bf v } ] , \\ ;    i=1,2,3,4 , \\nonumber \\\\   f_{i}^{(eq)}&=&\\frac{1}{36 } [ \\rho + 3 { \\bf e}_{i } \\cdot { \\bf v } +    \\frac{9}{2}({\\bf e}_{i } \\cdot { \\bf v})^2 - \\frac{3}{2}{\\bf v}\\cdot { \\bf v } ] , \\ ; i = 5,6,7,8 , \\label{eq : eqi}\\end{aligned}\\ ] ] and @xmath43 where @xmath44 ( like the momentum in the ordinary lbgk model ) is used to represent the flow velocity .",
    "the macroscopic equations of d2q9i in the steady - state case ( apart from error terms of @xmath18 : @xmath45 @xmath46 are exactly the steady - state incompressible navier - stokes equation . in the model , pressure is related to density by @xmath47 ( @xmath48 ) for a flow with constant density like poiseuille flow , and @xmath49 .    if the flow is steady , d2q9i is superior to d2q9 to simulating incompressible flows .",
    "if the flow is unsteady , one may consider the continuity equation derived from d2q9 given by @xmath50 . in a situation where the first two terms likely cancel each other , d2q9 may be of advantage ( to approximate the continuity equation @xmath51 ) . if the first two terms have the same sign , then d2q9i is better .",
    "it is proved in @xcite that if the flow is steady and independent of @xmath0 , then the solution @xmath52 of eq .",
    "( [ eq : lbgk ] ) produces a velocity profile that satisfies a difference equation which is a second - order approximation of the navier - stokes equation .",
    "if the boundary condition is chosen correctly , then the difference equation near the boundary is consistent with the difference equation inside .",
    "a velocity wall boundary condition is proposed in @xcite as follows : take the case of a bottom node in fig .  1 ,",
    "the boundary is aligned with @xmath37direction with @xmath53 pointing into the wall . after streaming , @xmath54",
    "are known .",
    "suppose that @xmath55 are specified on the wall , we need to determine @xmath56 and @xmath31 from eqs .",
    "( [ eq : dens ] ) , which can be put into the form : @xmath57 @xmath58 @xmath59 consistency of eqs .",
    "( [ eq : rho],[eq : v0 ] ) gives @xmath60 .",
    "\\label{eq : rhod}\\ ] ]    we assume the bounce - back rule is still correct for the non - equilibrium part of the particle distribution normal to the boundary ( in this case , @xmath61 ) . with @xmath62",
    "known , @xmath63 can be found as @xmath64 the collision step is applied to the boundary nodes also . for non - slip boundaries ,",
    "this boundary condition is reduced to that in @xcite .",
    "now let us turn to pressure ( density ) flow boundary condition .",
    "its derivation is based on eq .",
    "( [ eq : dens ] ) as for velocity wall boundary condition .",
    "suppose a flow boundary ( take the inlet in fig .  1 as example ) is along the @xmath65direction , and the pressure is to be specified on it .",
    "suppose that @xmath66 is also specified ( e.g. @xmath67 at the inlet in a channel flow ) .",
    "after streaming , @xmath68 are known , @xmath69 are specified at inlet .",
    "we need to determine @xmath38 and @xmath70 from eq .",
    "( [ eq : dens ] ) as following : @xmath71 @xmath72 @xmath73 consistency of eqs .",
    "( [ eq : rhoi],[eq : u0i ] ) gives @xmath74}{\\rho_{in } } .",
    "\\label{eq : u0d}\\ ] ]    we use bounce - back rule for the non - equilibrium part of the particle distribution normal to the inlet to find @xmath75 . with @xmath76 known , @xmath77 are obtained by the remaining two equations : @xmath78    the corner node at inlet needs some special treatment .",
    "take the bottom node at inlet as an example , after streaming , @xmath79 are known ; @xmath31 is specified , and @xmath80 .",
    "we need to determine @xmath81 .",
    "we use bounce - back rule for the non - equilibrium part of the particle distribution normal to the inlet and the boundary to find : @xmath82 using these @xmath83 in eqs .",
    "( [ eq : dens ] ) , we find : @xmath84 .",
    "\\label{eq : f5678}\\ ] ] similar procedure can be applied to top inlet node and outlet nodes including outlet corner nodes .",
    "the case that @xmath31 and non - zero @xmath66 is specified at a flow boundary along @xmath65direction can be handled in the same way .",
    "here , it is useful to compare our pressure boundary condition with that proposed in @xcite , which is given by the following post - streaming rule ( an extrapolation ) at inlet : after streaming , @xmath85 are calculated as @xmath86 where @xmath87 is the distribution functions at previous time step after collision and before streaming , @xmath88 is along @xmath89 with @xmath90 ( the inner normal @xmath91 in the case ) .",
    "thus , for @xmath92 , @xmath93 respectively . the density @xmath94 is set to the specified inlet value and @xmath66",
    "is set to zero to compute @xmath95 . at the bottom",
    ", @xmath96 are computed using eq .",
    "( [ eq : posts ] ) and then @xmath56 are obtained in the treatment of wall boundary condition .",
    "notice , however , that at the inlet , @xmath97 may not be equal to the specified density and @xmath98 may not be equal to zero with this post - streaming operation .",
    "this inconsistency causes some inaccuracy in simulations and leaves room for improvement .      in some calculations , velocities @xmath55",
    "are specified at a flow boundary ( take the inlet in fig .  1 as example ) . in the case of channel flow , after streaming , @xmath99 are known at inlet .",
    "@xmath100 are specified at inlet ( for the special case of poiseuille flow , @xmath67 ) , we need to determine @xmath31 and @xmath70 .",
    "this is actually equivalent to a velocity wall boundary condition .",
    "using our velocity wall boundary condition in @xcite previously described , we find : @xmath101 , \\nonumber \\\\",
    "f_1&=&f_3+\\frac 23 \\rho u_{x } , \\nonumber \\\\",
    "f_5&=&f_7-\\frac 12 ( f_2-f_4)+\\frac 12 \\rho u_y +   \\frac 16   \\rho u_{x }   , \\nonumber   \\\\ f_8&=&f_6+\\frac 12 ( f_2-f_4)-\\frac 12 \\rho u_y +   \\frac 16 \\rho u_{x } .",
    "\\label{eq : bc}\\end{aligned}\\ ] ] the effect of specifying velocity at inlet is similar to specifying pressure ( density ) at inlet .",
    "density difference in the flow can be generated by the velocity inlet condition .    at the inlet bottom",
    "( non - slip boundary ) , special treatment is needed .",
    "after streaming , @xmath102 need to be determined .",
    "using bounce - back on normal distributions gives : @xmath103 expressions of @xmath104 momenta give : @xmath105 which gives @xmath106 , \\label{eq : veli1}\\end{aligned}\\ ] ] but there is no more equation available to determine @xmath31 .",
    "the situation is similar to a corner wall node ( the intersection of two perpendicular walls ) . in the situation , @xmath31 at the inlet bottom node",
    "can be taken as the @xmath31 of its neighboring flow node , thus the velocity inlet condition is specified .    from the discussion given above ,",
    "we can unify boundary conditions ( on a wall boundary or in a flow boundary ) in 2-d simulation on a straight boundary as :    * given @xmath55 , find @xmath31 and unknown @xmath52 s .",
    "* given @xmath31 and the velocity along the boundary , find the velocity normal to the boundary and unknown @xmath52 s .",
    "( [ eq : dens ] ) is used to determine @xmath31 or the normal velocity and the unknown @xmath52 s .",
    "the formula are given in sections 2.2 , 2.3 , 2.4 .",
    "again , it is useful to compare our velocity flow boundary condition with that proposed in @xcite , which is given by the following post - streaming rule ( a zeroth - order extrapolation ) at inlet : after streaming , @xmath85 are calculated using @xmath107 where @xmath108 is the distribution function at previous time step after collision .",
    "after @xmath94 is computed using @xmath52 s , @xmath95 can be computed using this @xmath31 and the specified velocities @xmath55 . in this approach",
    ", the determination of unknown @xmath52 s does not use the information of known @xmath52 s at present time .",
    "this is inconsistent with the present distribution in the flow .",
    "suppose that initially , @xmath109 are computed by using some density @xmath110 and the specified @xmath55 , and one assigns @xmath111 , then collision does not change @xmath52 , and the post - streaming rule eq .",
    "( [ eq : postsv ] ) does not change @xmath52 and @xmath31 .",
    "hence @xmath112 for all time in the simulation .",
    "this velocity inlet condition amounts to assign the equilibrium distribution to @xmath52 and it makes a significant error .",
    "the result is worse than that of pressure inlet condition @xcite .",
    "the velocity wall boundary condition and flow boundary conditions for d2q9i are similar to that of d2q9 .",
    "it is from equations @xmath113 and @xmath114 and hence some modifications are needed as follows :    * in wall boundary condition , eq .",
    "( [ eq : rhod ] ) is replaced by @xmath115 .",
    "\\label{eq : rhodi}\\ ] ] + and in eq .",
    "( [ eq : f256 ] ) , @xmath116 are replaced by @xmath117 respectively . * in pressure flow boundary condition , eq .",
    "( [ eq : u0d ] ) is replaced by @xmath118 , \\label{eq : u0di}\\ ] ] and in eq .",
    "( [ eq : f158 ] ) , @xmath119 is replaced by @xmath120 . * similar replacement in velocity flow boundary condition , eq .",
    "( [ eq : bc ] ) .",
    "we report and discuss the numerical results for poiseuille flow with pressure ( density ) or velocity flow boundary condition . the simulation is performed on both models d2q9 and d2q9i .",
    "the main result in the simulation of d2q9i is the achievement of machine accuracy .",
    "the main result in the simulation of d2q9 is the achievement of second - order accuracy of the boundary conditions .",
    "the width of the channel is assumed to be @xmath121 .",
    "we use @xmath122 lattice nodes on the @xmath37 and @xmath65directions , thus , @xmath123 .",
    "the initial condition is to assign @xmath124 computed using a constant density @xmath110 , and zero velocities .",
    "the steady - state is reached if @xmath125 for model d2q9i , @xmath126 are replaced by @xmath117 .",
    "@xmath127 is a tolerance usually set to @xmath128 . on the wall , boundary condition discussed in section 2.2",
    "is used to make non - slip boundaries .",
    "we also define a l1 error as : @xmath129 where @xmath130 is the analytical velocity .      for model d2q9i , we carried out simulations with a variety of re , @xmath131 ( @xmath29 is the peak velocity in the channel ) using the pressure or velocity flow boundary condition .",
    "the range of re is from 0.0001 to 30.0 ; the range of @xmath12 is from 0.56 to 20.0 and the range of @xmath132 is from 0.001 to 0.4 ; the largest density difference simulated ( not the limit ) is @xmath133 with @xmath134 corresponding to a pressure gradient of @xmath135 .",
    "the magnitude of average density @xmath110 is irrelevant for the simulation @xcite .    for all cases where the simulation is stable ,",
    "the steady - state velocity and density show :    * the velocity field @xmath136 is accurate up to machine accuracy compared to the analytical solution in eq .",
    "( [ eq : pois ] ) , @xmath137 is very small with maximum of @xmath138 in the whole region being in the order of @xmath139 . for example , for @xmath140 re = 10",
    ", the relative l1 error of @xmath141 in the whole flow region is @xmath142 . *",
    "the density is uniform in the cross channel direction , and linear in the flow direction .",
    "the density difference @xmath143 is a constant through the flow region , its value is equal ( up to machine accuracy ) to the analytical value set by the constant pressure gradient .",
    "* velocity @xmath136 is uniform in the @xmath37direction , the results are the same for different @xmath144 .",
    "if the computed velocity were plotted with the analytical velocity , there would be no difference to naked - eyes .",
    "it is also noticed that with pressure ( density ) gradient to drive poiseuille flow , the maximum reynolds number which makes the simulation stable is far less than that with external forcing . for @xmath145 , the maximum",
    "re is about 30 .",
    "refinement of mesh can increase the maximum re .",
    "when the pressure flow boundary condition is replaced by the method in @xcite , machine accuracy can no longer be obtained , for a simple case @xmath146 re = 5 , with a moderate pressure gradient of @xmath147 , @xmath148 , the relative l1 error of @xmath141 in the whole flow region is @xmath149 , with maximum of @xmath138 being @xmath150 , not very small compared to @xmath29 .",
    "the density difference @xmath151 is no longer a constant , its range is from -0.002094 to -0.003872 ( the analytical value is @xmath152 ) .",
    "the result indicates that the pressure or velocity flow boundary condition proposed in this paper is a clear improvement of that in @xcite",
    ".    similar results of machine accuracy are obtained by specifying the analytical velocity profile given in eq .",
    "( [ eq : pois ] ) at inlet and pressure ( density ) at outlet by using the flow boundary conditions in this paper . in the case",
    ", there is a uniform pressure ( density ) difference in the region .",
    "the value of the density difference depends on @xmath29 and the outlet density .",
    "since the ordinary lbgk model d2q9 is still widely used for simulations .",
    "it is worthwhile to do some simulations with d2q9 with our flow boundary conditions and show that they give a second - order accuracy .",
    "we use d2q9 to poiseuille flow with pressure or velocity flow boundary condition .",
    "since as @xmath39 the computed solution does not approach the analytical solution , we will use the result of the finest mesh as the exact solution to compute the error .",
    "simulations with successively doubled lattice steps are carried out to observe the convergence .",
    "the example uses fixed re = 10 , @xmath153 .",
    "the pressure gradient @xmath28 in eq .",
    "( [ eq : pois ] ) and then pressure ( density ) at inlet / outlet can be obtained as @xmath154 and @xmath155 respectively to be used in the pressure ( density ) flow boundary condition . for the velocity flow boundary condition , the analytical velocities in eq .",
    "( [ eq : pois ] ) are used at inlet , and @xmath110 is specified at outlet .",
    "thus , the results of the pressure flow boundary condition and the velocity flow boundary condition are similar but not identical .",
    "define @xmath156 to represent the number of lattice steps in @xmath37 and @xmath65directions , we use @xmath157 respectively to do the simulation . the l1 error is defined in eq .",
    "( [ eq : err1 ] ) with @xmath130 being replaced by the computed velocities of @xmath158 .",
    "@xmath159 has to be changed as @xmath160 are changed to keep the same re , @xmath29 ( values of @xmath159 are included in table  i ) .",
    "the convergence result is summerized in table  i. the case of @xmath161 was not shown in table i , because the simulation is unstable for the velocity inlet condition .",
    "the ratio of two consecutive l1 errors is also shown .",
    "the ratio is approximately equal to 4 , indicating a second - order accuracy .",
    "for all runs , it is also observed that    * velocity @xmath38 is monotonically increasing in the @xmath37direction , the result is not sensitive to the value of @xmath162 , we usually take @xmath163 .",
    "if the pressure boundary condition in @xcite is used , @xmath38 on the centerline of the channel decreases first , then increases , and decreases again near the outlet .",
    "this behavior deviates from the macroscopic continuity equation of lbgk @xmath40 in the case , indicating that errors are introduced by the pressure boundary condition in @xcite .",
    "an example of centerline velocity @xmath38 as a function of @xmath0 is presented in fig .",
    "* @xmath66 is very small compared to @xmath29 , with maximum of @xmath164 being approximately of @xmath165 in typical cases . if the pressure boundary condition in @xcite is used , maximum value of @xmath164 is like @xmath166 typically . *",
    "the density is uniform in the cross channel direction , and linear in the flow direction .",
    "the density difference @xmath143 is almost a constant through the flow region , its value is equal to the analytical value with a fluctuation of less than 0.03  % in a worst case observed with re= 5 . if the pressure boundary condition in @xcite is used , the fluctuation of density difference @xmath143 from the analytical value reaches 20  % for the same case mentioned above with re = 5 .    in the case where the density gradient is small ,",
    "the computed velocity profile are close to the analytical velocity profile of poiseuille flow .",
    "we present an example here with @xmath167 , re=0.8333 , @xmath168 , @xmath169 , @xmath170 with both pressure ( density ) flow boundary conditions in this paper and in @xcite . fig .",
    "2 shows the velocity @xmath38 as a function of @xmath1 at @xmath171 ( the middle section of the channel ) , fig .  3 shows the centerline density profile along the @xmath0 direction , and fig .",
    "4 shows the centerline @xmath38 along the @xmath0 direction .",
    "the solid line represents the corresponding analytical solution and the symbols @xmath172 represent the computed solutions with the pressure boundary conditions in this paper and in @xcite respectively .",
    "both computed velocities @xmath38 at the mid - channel has no difference to the analytical solution to naked eyes ( the relative error are of order @xmath173 for both pressure boundary conditions ) .",
    "the computed centerline density with our method looks identical to the analytical solution ( given as a linear function crossing @xmath174 and @xmath175 at inlet and outlet respectively ) , while the centerline density with the method in @xcite has a discernible difference with the linear function especially near the inlet and outlet .",
    "the centerline @xmath38 with our method is monotonically increasing , the behavior is consistent with the continuity equation of lbgk @xmath40 in the case , while the centerline @xmath38 with the method in @xcite has a behavior inconsistent with the continuity equation near the inlet and outlet .",
    "this again shows an clear improvement of our method to that in @xcite .",
    "since 3-d model is needed in practical problems , we give a discussion of the pressure or velocity flow boundary condition for the 3-d 15-velocity lbgk model ( d3q15 ) and present a brief statement about its simulation results .",
    "the model is based on the lbgk equation eq .",
    "( [ eq : lbgk ] ) with @xmath176 , where @xmath177 are the column vectors of the following matrix : @xmath178\\ ] ] and @xmath179 are clasified as type i , @xmath180 are clasified as type ii .",
    "the density per node , @xmath13 , and the macroscopic flow velocity , @xmath181 , are defined in terms of the particle distribution function by @xmath182 the equilibrium can be chosen as : @xmath183    since we will use this model for 2-d simulation in this paper , it is clear to give a projection of the velocities in the @xmath184 plane as shown in fig .  1 .",
    "the @xmath65axis is pointing into the paper , so are velocity directions 3,7,9,12,14 , while the velocity directions 4,8,10,11,13 are pointing out ( velocity directions 3,4 have a projection at the center and are not shown in the figure ) .",
    "the flow direction is still @xmath0 , and the cross channel direction is @xmath185 .",
    "the macroscopic equations of the model is the same as eqs .",
    "( [ eq : cont],[eq : momen ] ) with @xmath186 , and @xmath187 .",
    "the velocity wall boundary condition proposed in @xcite has the following version for the model d3q15 : take the case of a bottom node ( wall node ) as shown in fig .  1",
    ", the wall is on @xmath188 plane . after streaming , @xmath189",
    "are known , suppose that @xmath190 are specified on the wall , we need to determine @xmath191 and @xmath31 from eqs .",
    "( [ eq:3ddens ] ) .",
    "similar to the derivation in d2q9 , @xmath31 is determined by a consistency condition as : @xmath192 .",
    "\\label{eq:3drhod}\\ ] ] the expression of @xmath193 momentum gives : @xmath194 if we use bounce - back rule for the non - equilibrium part of the particle distribution @xmath195 to set @xmath196 then eq .",
    "( [ eq:3duz ] ) is satisfied , and all @xmath52 are defined . in order to get the correct @xmath197momenta , we further fix this @xmath198 ( bounce - back of non - equilibrium @xmath52 in the normal direction ) and modify @xmath199 as in @xcite : @xmath200 this modification leaves @xmath193 momentum unchanged but adds @xmath201 to the @xmath197momenta respectively",
    ". a suitable choice of @xmath202 and @xmath203 then gives the correct @xmath197momenta .",
    "finally , we find : @xmath204 , \\label{eq:3dbc}\\end{aligned}\\ ] ] where @xmath205 is the index corresponding to @xmath206 ( e.g. , @xmath207 for @xmath208 and @xmath209 for @xmath210 ) . in the case of non - slip boundary",
    ", this boundary condition is reduced to that in @xcite .",
    "the derivation of pressure ( density ) flow boundary condition uses a similar way as for velocity wall boundary condition .",
    "suppose the boundary ( take the case of inlet in fig .",
    "1 ) is on @xmath211 plane with specified @xmath174 and @xmath212 . after streaming , we need to determine @xmath38 and @xmath213 from eq .",
    "( [ eq:3ddens ] ) .",
    "the consistency condition gives : @xmath214 , \\label{eq:3din1}\\ ] ] which determines @xmath38 at inlet , using a similar procedure as in deriving the boundary condition , we find : @xmath215 , \\;\\ ; i = 7,9,11,13 \\label{eq:3din2}\\end{aligned}\\ ] ] where @xmath205 direction is opposite to @xmath216 direction .",
    "same procedure as in d2q9 is used at the inlet bottom node ( non - slip ) to derive : @xmath217 , \\label{eq:3din3}\\end{aligned}\\ ] ] and similar results for inlet top and outlet condition .",
    "the pressure ( density ) boundary condition in @xcite is specified as post - streaming rule ( take the inlet as an example ) : @xmath218 where @xmath108 is the distribution functions at previous time step after collision , @xmath88 is along @xmath89 with @xmath90 ( the inner normal @xmath91 in the case ) .",
    "thus , @xmath219 for @xmath220 respectively .",
    "then @xmath31 is set to @xmath174 and @xmath221 are set to zero to compute @xmath222 .",
    "again , the density and @xmath193 momentum from @xmath52 may not be correct , indicating some inconsistency .    the velocity flow boundary condition , which can be viewed simply a velocity wall boundary condition , can be derived similarly .",
    "but the corner node with non - slip condition needs some treatment as in the d2q9 case .",
    "the details are easy to work out and omitted here .",
    "simple modifications are used to derive wall boundary condition , pressure ( density ) or velocity flow boundary condition for the improved incompressible model d3q15i , which is the counterpart of d2q9i in 3-d case .",
    "simulations on plane poiseuille flow are performed on d3q15 and d3q15i using the pressure or velocity flow boundary condition .",
    "the only difference with 2-d simulations is periodic condition is used on @xmath65direction , and initial condition is uniform in @xmath1 direction with zero velocity .",
    "it is found that the result is uniform in the @xmath1-direction and is independent of the number of nodes in @xmath65direction .",
    "@xmath66 is identically zero ( in the order of @xmath223 because of round - off error ) .",
    "the results are very similar , although not identical , to the results of d2q9 , d2q9i .",
    "again , d3q15i with our boundary condition and pressure ( density ) flow boundary condition gives results with machine accuracy , showing a clear improvement over the pressure boundary condition in @xcite .",
    "discussions with r. maier , r. bernard are appreciated . q.z .",
    "would like to thank the associated western universities inc . for providing a fellowship and to thank g. doolen and s. chen for helping to arrange his visit to the los alamos national lab .",
    "99    x. he and q. zou , `` analysis and boundary condition of the lattice boltzmann bgk model with two velocity components , '' los alamos preprint , la - ur-95 - 2293 .",
    "q. zou , s. hou , s. chen and g.d .",
    "doolen , `` an improved incompressible lattice boltzmann model for time - independent flows , '' _ j. stat .",
    "_ , october ( 1995 ) .",
    "s. succi , d. dhumires , y. qian and s.a .",
    "orszag , `` on the small - scale dynamical behavior of lattice bgk and lattice boltzmann schemes , '' _ j. of sci .. comput . _",
    "* 8 * , 219 ( 1993 ) .",
    "q. zou , s. hou and g.d .",
    "doolen , `` analytical solutions of the lattice boltzmann bgk model , '' _ j. stat",
    "_ , october ( 1995 ) .",
    "x. he , l.s .",
    "luo and m. dembo , `` the dirichlet boundary condition in hydrodynamics and analytic solutions of simple flows for the lattice bgk method , '' preprint .",
    "noble , s. chen , j.g .",
    "georgiadis , r.o .",
    "buckius , `` a consistent hydrodynamic boundary condition for the lattice boltzmann method , '' _ phys .",
    "fluids _ * 7 * , 203 ( 1995 ) .",
    "grunau phd thesis , colorado state university , 1993 .",
    "r. s. maier , r. s. bernard and d. w. grunau , `` boundary conditions for the lattice boltzmann method '' , preprint ( 1995 ) .",
    "s. chen , h. chen , d.o .",
    "martinez and w.h .",
    "matthaeus , `` lattice boltzmann model for simulation of magnetohydrodynamics , '' _ phys .",
    "_ , * 67 * , 3776 ( 1991 ) .",
    "y. qian , d. dhumires and p. lallemand , `` recovery of navier - stokes equations using a lattice - gas boltzmann method , '' _ europhys .",
    "* 17 * ( 6 ) , 479 ( 1992 ) .",
    "h. chen , s , chen , and w. h. matthaeus , `` recovery of navier - stokes equations using a lattice - gas boltzmann method , '' _ phys .",
    "a _ * 45 * , 5771 ( 1992 ) .    y. h. qian and s. a. orszag , `` lattice bgk models for navier - stokes equation , '' _ europhys . lett . _",
    "* 21 * ( 3 ) , 255 ( 1993 ) .",
    "s. hou , q. zou , s. chen , g. d. doolen , and a. c. cogley , `` simulation of cavity flow by the lattice boltzmann method , '' j. comp .",
    "phys . * 118 * , 329 ( 1995 ) .    table i. l1 relative error of velocities as @xmath224 are doubled , re=10 , @xmath225 with our pressure or velocity flow boundary condition .",
    "error are from comparison with the velocities of @xmath158 ( @xmath226 ) .",
    "the symbol ( -2 ) represents @xmath227 .",
    "ratio of two consecutive l1 errors is also shown .",
    "+    [ cols=\"^ , < , < , < , < , < , < \" , ]",
    "1 , schematic plot of velocity directions of the 2-d ( d2q9 ) model and projection of 3-d ( d3q15 ) model in a channel . in the 3-d model , the @xmath65axis is pointing into the paper , so are velocity directions 3,7,9,12,14 , while the velocity directions 4,8,10,11,13 are pointing out ( velocity directions 3,4 have a projection at the center and are not shown in the figure ) .",
    "fig .  2 , velocity @xmath38 as a function of @xmath1 at @xmath171 ( the middle section of the channel ) for the case @xmath167 , re=0.8333 , @xmath168 , @xmath169 , @xmath170 with pressure ( density ) flow boundary conditions .",
    "the solid line represents the corresponding analytical solution of poiseuille flow .",
    "the symbols @xmath172 represent the computed solutions with the pressure flow boundary conditions in this paper and in @xcite respectively .",
    "3 , centerline density profile along the @xmath0 direction for the case @xmath167 , re=0.8333 , @xmath168 , @xmath169 , @xmath170 with pressure ( density ) flow boundary condition .",
    "the solid line represents the corresponding analytical solution ( a linear function crossing @xmath174 and @xmath175 at inlet and outlet respectively ) .",
    "the symbols @xmath172 represent the computed solutions with the pressure flow boundary conditions in this paper and in @xcite respectively .",
    "4 , centerline @xmath38 along the @xmath0 direction for the case @xmath167 , re=0.8333 , @xmath168 , @xmath169 , @xmath170 with pressure ( density ) flow boundary condition .",
    "the solid line represent the analytical solution of poiseuille flow .",
    "the symbols @xmath172 represent the computed solutions with the pressure flow boundary conditions in this paper and in @xcite respectively ."
  ],
  "abstract_text": [
    "<S> pressure ( density ) and velocity boundary conditions inside a flow domain are studied for 2-d and 3-d lattice boltzmann bgk models ( lbgk ) and new method to specify these conditions are proposed . </S>",
    "<S> these conditions are consistent with the boundary condition we proposed in @xcite using an idea of bounce - back of non - equilibrium distribution . </S>",
    "<S> these conditions give excellent results for the regular lbgk models , and were shown to be second - order accurate by numerical examples . </S>",
    "<S> when they are used together with the improved incompressible lbgk model in @xcite , the simulation results recover the analytical solution of the plane poiseuille flow driven by pressure ( density ) difference with machine accuracy .    </S>",
    "<S> # 1by # 1 # 1by # 1    6.4 in 8.6 in    key words : lattice boltzmann method ; boundary condition ; pressure boundary condition ; velocity inlet condition ; poiseuille flow .    </S>",
    "<S> pacs numbers : 47.1.45.-x ; 47.60.+l </S>"
  ]
}