{
  "article_text": [
    "radiation from synchrotrons is a well developed field , and a number of numerical methods for calculating the radiation spectrum exist @xcite .",
    "laser driven sources of radiation have also triggered interest in measurements @xcite and numerical calculations @xcite of radiation , particularly in the area of laser - plasma particle acceleration . as sources of high - energy particle beams and radiation ,",
    "laser - plasma based techniques may be used for a large range of future applications .",
    "ultrafast x - ray sources would be useful in , for example , time resolved diffraction , medical imaging , spectroscopy and microscopy of transient physical , chemical , or biological phenomena .",
    "laser wakefield acceleration @xcite of high energy electrons beams has recently successfully demonstrated the production of gev peak energy electron beams @xcite , and has become a highly cited field of research .",
    "such beams could be used directly for radiotherapy or radiographic imaging , or alternatively can be converted into fs duration , high brightness sources of x - rays .",
    "numerical calculation of the x - ray spectrum is therefore of interest .",
    "scattering of laser pulses from relativistic electron beams is another area which may require well characterized angularly resolved spectra from a realistic bunch , for comparison with experiment .    in general",
    ", the trajectories of particles in laser driven experiments are quite complicated ; wakefields , electron beam interactions with intense laser fields , electron orbits in laser generated channels and in laser - solid interactions all represent sources of radiation .",
    "the radiation fields can be explicitly calculated by a fast fourier transform method or by finite differencing of the linard - wiechert fields in time , but these are computationally intensive processes due to the constraints of the whittaker - shannon - nyquist sampling theorem @xcite .",
    "this essentially states that for discretely sampled data , frequencies higher than half the sampling frequency are aliased to frequencies lower than half the sampling frequency .",
    "since the spectral power as a function of frequency emitted is essentially equivalent to a fourier transform , the highest resolvable frequency in the spectrum is constrained . however ,",
    "for relativistic particles radiation can be produced at much higher frequencies than the actual time - scale corresponding to the change in momentum of the particles , because the radiation co - propagates with the particle .    here",
    ", an algorithm is developed which uses a combination of numerical and analytic methods to integrate the linard - wiechert fields , for arbitrary trajectories of many charged particles , to frequencies greatly exceeding the nyquist frequency , @xmath0 .",
    "this means that the sampling rate to accurately reproduce a particular spectrum can be many orders of magnitude lower than @xmath1 , and therefore faster to solve numerically .",
    "this is particularly relevant to calculations of radiation from betatron oscillations in laser wakefield accelerators and beam - laser interactions , but the technique is applicable to numerous other areas of physics .",
    "the spectral intensity of radiation emitted by a number @xmath2 of accelerating point charges , with the @xmath3th particle at position @xmath4 and with normalized velocity @xmath5 , can be expressed , in the far - field , as : @xmath6 where the unit vector @xmath7 is in the direction of observation , at a distance far compared with the scale of the emission region .",
    "this can be written alternatively in terms of proper time , @xmath8 : @xmath9 where the four - wave - vector @xmath10 , and @xmath11 is the momentum part of the @xmath3th particle s four - velocity defined as : @xmath12 one of the advantages of using proper time rather than ` laboratory ' time for numerical calculations is that for a uniform step finite differencing scheme , the time resolution is effectively adaptive ; as the particle gains inertia and is therefore accelerated at a decreased rate for a similar force , the _ laboratory _ time step - size increases . to numerically integrate the equations of motions for charged particles , both @xmath13 and @xmath14 have to be recorded at a number of discrete points .",
    "to then perform the spectral integration numerically , a ` zeroth order ' model would be to reduce equation [ spec : jackson_proper ] to a summation over finite differenced points : @xmath15 the problem with this method is that frequencies higher than half the sampling rate are aliased to lower frequencies , and therefore an upper limit is put on the maximum frequency that can be effectively resolved to @xmath16 @xcite . for attempts to simulate high energy photons from laser interactions",
    ", this can be computationally prohibitive . however , the motion of the particles which lead to such high - energy photons generally consists of changes on timescales much larger than the radiation frequencies produced .",
    "hence , a different approach is taken , which is to assume that the motion of a particle between time - steps can be approximated by an interpolating function .",
    "the spectral integral can be expressed as a summation over analytic integrals between each time - step : @xmath17 here the notation used is that greek character sub / super - scripts represents components of 4-vector quantities , subscript roman characters denote either particle number , @xmath3 , or ( proper ) time - step , @xmath18 , and bold font represents 3-vector quantities .",
    "proper time is discretized into steps of size @xmath19 .",
    "an exact analytic solution can then be employed to calculate the sub - integral between time - steps , using an interpolating function for @xmath11 and @xmath20 between discrete time steps . a quadratic interpolation for @xmath13 can accurately model both linear and harmonic accelerations , and a linear interpolation for the velocity four - vector is consistent .",
    "thus , the four - velocity and four - displacement at a time @xmath21 are approximated by : @xmath22 where @xmath23 , @xmath24 , and @xmath25 , @xmath26 and @xmath27 are interpolation coefficients .",
    "each integral over time in equation [ spec : jackson_proper_diff_proper ] can then be broken up into a series of _ analytic integrals _ between time steps from @xmath28 to @xmath29 : @xmath30 where , with quadratic interpolation : @xmath31}\\right ) e^{\\pm i\\kappa_\\alpha ( x^\\alpha_{0j , n}+x^{\\alpha}_{1j , n}{[\\tau-\\tau_n]}+x^\\alpha_{2j , n}{[\\tau-\\tau_n]}^2 ) } d\\tau\\;,\\end{aligned}\\ ] ] and the space and velocity fourvectors are assumed real so that @xmath32 .",
    "a change of variables in the integral leads to : @xmath33 if each particle trajectory is accurately described by the interpolation function between grid - points , then the total integral is exactly solved .",
    "this is the key difference which allows calculation of the spectrum to far beyond the nyquist frequency corresponding to the time step between known position and moment values .",
    "the integral with respect to @xmath8 , @xmath34 , can be split into real and imaginary parts : @xmath35 it can be shown that these integrals have the solutions : @xmath36\\\\ + & { \\mathbf{\\psi}}_-\\left[s(\\theta_+)-s(\\theta_-)\\right]\\\\ + & 2{\\mathbf{v}}_{1j , n}\\left[\\sin\\phi_+-\\sin\\phi_-\\right ] \\end{array } \\right\\ } \\ ; , \\label{fresnel1 } \\\\",
    "\\im\\left({\\mathcal{i}}_{j , n}\\right)&= & \\pm\\frac{1}{4{\\chi_{2j , n } } } \\left\\ { \\begin{array}{l l } & { \\mathbf{\\psi}}_+\\left[s(\\theta_+)-s(\\theta_-)\\right]\\\\ -&{\\mathbf{\\psi}}_-\\left[c(\\theta_+)-c(\\theta_-)\\right]\\\\ -&2{\\mathbf{v}}_{1j , n}\\left[\\cos\\phi_+-\\cos\\phi_-\\right ] \\end{array } \\right\\ } \\ ; , \\label{fresnel2}\\end{aligned}\\ ] ] where @xmath37 and @xmath38 are the fresnel integrals , and : @xmath39 here , the fresnel integrals are solved numerically by using the power series and continued fraction expressions in _ numerical recipes in c++ _ @xcite .",
    "although the benefit gained in using less time steps by this method far outweighs the cost of calculating these functions , this is a computationally expensive process , and if the use of fresnel integrals can be avoided it would be beneficial . if the second exponent in the integral is small , it is appropriate to taylor expand the exponential function and truncate at order @xmath40 , hence : @xmath41 the integrals when @xmath42 is small are : @xmath43 where : @xmath44\\;,\\\\ { \\mathcal{i}}_{2j , n}&=&\\frac{\\delta\\tau^3}{4}{\\rm sinc}\\left(\\frac{\\chi_{1j , n}\\delta\\tau}{2}\\right ) -\\frac{2}{\\chi_{1j , n}}{\\mathcal{i}}_{1j , n } \\;,\\end{aligned}\\ ] ] where @xmath45 is the unnormalized cardinal sine function , @xmath46 .",
    "the taylor expanded solution for the integral @xmath47 is significantly faster to solve than the fresnel integral expressions , so a condition statement can switch between solutions depending on the size of @xmath48 . for practical purposes ,",
    "the expansion solution is necessary because the exact solution , when numerically solved , diverges for small @xmath48 due to floating point truncation error , the accuracy of the trigonometric functions and the inverse @xmath48 relationship .",
    "some threshold value , @xmath49 , for @xmath48 can be used to choose between the two models .",
    "this must be between 1 and 0 , as the taylor expansion is only valid for @xmath50 . for values less than the threshold , @xmath51 , the taylor expansion solution is used and for values greater than threshold , @xmath52 , the exact solution is used .",
    "in addition , _ long double _ precision floating point numbers are necessary for sufficiently accurate calculation of the functions .",
    "a good threshold value is @xmath53 , as a balance between the accuracy of the solution and the speed of the algorithm .",
    "figure [ figure1 ] shows calculations of integral @xmath54 for @xmath55 , @xmath56 , @xmath57 , @xmath58 and varying @xmath59 .",
    "( a ) calculation of integral using fresnel integral form .",
    "( b ) calculation using taylor series expansion form of integral .",
    "( c ) calculation using finite differenced integral with @xmath60 steps and simpson s rule .",
    "it is clear in this specific example that the fresnel integral solution is correct for all but the smallest values of @xmath59 . for these values , since the equations [ fresnel1 ] and [ fresnel2 ] involve the subtraction of large terms and division by @xmath59 , the truncation errors are amplified to significant values .",
    "the taylor expanded solution does not contain a term @xmath61 , and therefore approaches the correct result for @xmath62 .     for @xmath55 , @xmath56 , @xmath57 , @xmath58 and varying @xmath59 .",
    "( a ) calculation of integral using fresnel integral form .",
    "( b ) calculation using taylor series expansion form of integral .",
    "( c ) calculation using finite differenced integral with @xmath60 steps and simpson s rule.,width=480 ]    the radiated spectral intensity is then given by : @xmath63 ^ 2\\\\ + \\left[\\sum_{j=1}^{n_p}\\sum_{n=0}^{n_\\tau}{\\mathbf{\\hat{s}}}\\times\\left ( \\im\\left({\\mathcal{i}}_{j , n}\\right)\\cos({\\kappa_\\alpha x^\\alpha_{0j , n}})+\\re\\left({\\mathcal{i}}_{j , n}\\right)\\sin({\\kappa_\\alpha x^\\alpha_{0j , n}})\\right)\\right]^2\\\\ \\end{array } \\right\\ } \\;.\\end{aligned}\\ ] ] the radiation would normally be considered in a spherical polar coordinate system , @xmath64 , where @xmath65 is the azimuth and @xmath66 is the polar angle . for simplicity , a cartesian coordinate system , @xmath67 ,",
    "can be chosen such that the radiation is calculated at an angle @xmath65 with respect to the @xmath68 axis in the @xmath69 plane . to observe radiation in a particular direction in @xmath66",
    ", the coordinate system can be rotated about the @xmath68 axis .",
    "defining @xmath67 components of combinations of integrals @xmath47 : @xmath70 the radiated spectral intensity is : @xmath71",
    ", and the magnetic field strength , @xmath72 , is such that @xmath73 .",
    "the time - step is @xmath74 .",
    "( a - b ) calculated spectrum and error for finite differenced numerical integration .",
    "( c - d ) calculated spectrum and error for summation of exact integrals using first - order interpolation of position .",
    "( e - f ) calculated spectrum and error for summation of exact integrals using second - order interpolation of position . in the left - hand images , the red dashed line corresponds to the analytic solution , and the blue solid line corresponds to the numerically calculated solution.,width=384 ]    a test for the algorithm for relativistic motion is reproducing the well known continuum spectrum from a single ultra - relativistic electron rotating in a magnetic field without losing energy .",
    "mathematically this means no radiation damping term in the force equation , physically this can be accelerating electric fields that compensate for the energy losses .",
    "an analytic expression for the spectrum is the sum of modified bessel functions of the second kind , @xmath75 : @xmath76\\;,\\end{aligned}\\ ] ] where @xmath77 and @xmath78 is the radius of curvature .",
    "figure [ figure2 ] shows calculated synchrotron spectra ( left ) and the percentage error relative to the analytic solution ( right ) for different numerical integration techniques .",
    "the relative percentage error is defined as the difference between the analytic and numerical solutions divided by the maximum value of the analytic solution .",
    "the electron lorentz factor is @xmath79 , and the magnetic field strength , @xmath80 , is such that @xmath81 .",
    "the time - step is @xmath74 , and the maximum frequency calculated is @xmath82 .",
    "note that this means that the maximum frequency resolved is @xmath83 times the inverse of the time - step size .",
    "( a - b ) show the calculated spectrum and error for finite differenced numerical integration , ( c - d ) show the spectrum and error for the summation of exact integrals using first - order interpolation of position _ only _ and ( e - f ) show the spectrum and error for the summation of exact integrals using second - order interpolation of position . in the left - hand images",
    ", the red dashed line corresponds to the analytic solution , and the blue solid line corresponds to the numerically calculated solution .",
    "it is clear from ( a - b ) that using the simple finite differencing method ( equivalent to a discrete fourier transform ) that the resulting spectrum is of no use whatsoever with this particular time - step .",
    "the error grows with frequency to be 12 orders of magnitude larger than the maximum of the spectral intensity that the method is trying to reproduce . decreasing the time - step size eventually yields an error smaller than 100% , but to produce accurate spectra , @xmath84 .",
    "this is a very limiting factor in calculations of this kind .    by performing a first - order interpolation , as in figure [ figure2 ] ( c - d ) , which corresponds to using the real part of the taylor expanded solution only , equation [ realfirstorder ] , the calculated spectrum is clearly now representative of the analytic spectrum , albeit with an error of up to 10% .",
    "the simplicity of this algorithm ( the only non algebraic operation involving the calculation of a single sinusoid for each time - step ) makes it fast and easy to implement .",
    "however , beyond @xmath82 , the error in the numerical solution starts to grow . using second - order interpolation , ( e - f ) , yields an error that is at most more than an order of magnitude smaller than the maximum error in the first - order interpolation calculation .",
    "importantly , it is free of spurious oscillations which could lead to misinterpretation of more complex spectra .",
    "in addition , the error remains less than the maximum error shown in figure [ figure2](f ) up to @xmath85 , which corresponds to a frequency of @xmath86 . despite being a more complex algorithm ,",
    "the second - order method greatly speeds up a spectral calculation due to a larger time - step being allowed . provided the motion of a particle",
    "can be well - described by piecewise quadratic functions ( i.e. cubic or higher terms would be small ) , the method will produce accurate spectra .    , and",
    "a magnetic field strength of @xmath87  t. the time - step is @xmath74 .",
    "( left ) @xmath88 is the radiated spectral power polarized in the plane of the motion of the electron .",
    "( right ) @xmath89 is the radiated spectral power polarized parallel to the magnetic field.,width=480 ]    in figure [ figure2d ] , angularly resolved polarization components of synchrotron spectra for the same parameters are shown . in this case , the frequency scale is shown as an energy scale corresponding to a magnetic field of @xmath87  t , which is similar to the parameters of a small synchrotron .",
    "the two polarized components of the radiation are @xmath90 and @xmath91 , i.e. the components perpendicular and parallel to the plane of observation .",
    "such calculations can be performed in a matter of minutes on a single processor ( the figure shows 500 frequency bins by 500 angular bins resolution and took 30 minutes to calculate on a single processor of a @xmath92  ghz imac , but a calculation of 100 frequency bins by 100 angular bins resolution took @xmath931 minute , including the calculation of the particle trajectory . )      ) with the field vector along the @xmath94 axis , calculated numerically .",
    "the vertical axis is the frequency normalized to the laser frequency , and the horizontal plane gives the radiated intensity .",
    "the angular shape of the structure is a set of @xmath95 lobes , in agreement with the analytic expression .",
    ", width=288 ]    to test non - relativistic motion extending to moderately relativistic motion , thomson scattering of a laser pulse from a single electron can be analyzed . in non - relativistic thomson scattering from a linearly polarized plane wave , an analytic solution for the radiated power is possible .",
    "the field strength corresponding to the interaction is parameterized by the normalized peak vector potential @xmath96 , where @xmath97 is the peak electric field strength and @xmath98 is the angular frequency of the laser .",
    "returning to equation [ spec : jackson ] for a single particle , and inserting a time varying velocity @xmath99 , and using a coordinate system so that angle @xmath100 is measured between the polarization axis and the observation direction , the spectral power is : @xmath101 to first - order in @xmath102 , assuming @xmath103 , this can be integrated to give : @xmath104    here , the dirac delta function @xmath105 is a representation of @xmath106 in the limit that @xmath107 .",
    "the radiated energy is therefore distributed at a single frequency with an angular structure consisting of a @xmath95 shape . in figure",
    "[ figure3 ] , the angular distribution of spectral power is shown from calculations using the quadratic algorithm with a time - step of @xmath108 , with a plane electromagnetic wave polarized along the @xmath94-axis with a field strength of @xmath109 .",
    "time is integrated to include 20 wave - periods .",
    "the angular shape of the structure is a set of @xmath95 lobes , in agreement with the analytic expression .",
    "although the spectrum as a function of energy is a peaked distribution centered at @xmath110 , it is not a dirac delta function .",
    "however , the analytic solution is for an infinite summation of wave - periods , whereas for obvious reasons a finite summation is calculated numerically . in terms of frequency , the calculation yields a @xmath111 shape , characteristic of a finite window , which approaches the dirac delta as the size of the window is increased .    as the field strength increases in the interaction , the electron motion becomes more complicated due to the magnetic field , and tends towards a figure of eight motion .",
    "this means that additional harmonics of the motion appear in the spectrum . for the case of exact back - scatter from an electron with an initial lorentz factor of @xmath112 ,",
    "the motion of the electron means that it experiences a doppler shifted plane wave , and therefore the period of oscillation is modified . in reference",
    "@xcite an analytic expression for the shifted fundamental frequency , @xmath113 , was given as : @xmath114 where @xmath115 is the initial velocity of the particle , and the power per unit solid angle in the @xmath116th harmonic of @xmath113 is : @xmath117 ^ 2 & \\quad m { \\rm~odd}\\;,\\\\ 0 & \\quad m { \\rm~even}\\ ; , \\end{array}\\end{aligned}\\ ] ]      where @xmath118 is a bessel function of the first kind and @xmath119 . in figure [ figure4 ] , the power in harmonics of the fundamental frequency , normalized to the first harmonic , as a function of harmonic @xmath116 , due to non - linear thomson backscattering from a 5  mev electron beam colliding with 10 periods of a linearly polarized plane wave with a normalized vector potential of @xmath120 is shown . the temporal resolution is such that @xmath121 , which represents only 100 sample points to calculate the spectrum from . also shown",
    "is the ( normalized ) power from the analytic solution .",
    "again the analytic solution models an infinite plane wave solution , and hence the harmonics are discrete . in the numerical solution ,",
    "a finite number of periods is calculated , and therefore the harmonics have a @xmath122 shape .",
    "the scaling of the amplitude of the peaks and the position of the harmonics agrees well between the two solutions . for the numerical solution",
    ", the spectrum was calculated as a function of frequency and then divided by the analytically calculated frequency @xmath113 to give the horizontal axis .",
    "the 12th harmonic corresponds to a frequency of @xmath123 , which for an @xmath124 laser interaction corresponds to a photon energy of 1.2  kev .",
    "figure [ figure6 ] shows the angularly resolved plot of the same calculations as figure [ figure4 ] , and can be compared with figure 2(b ) in reference @xcite , which shows a similar plot calculated from an analytic solution . note that in their figure , only the first three harmonics were calculated . in the top right of the mesh - plot in figure [ figure6 ] , the next 3 harmonics can be observed .",
    "the finite width of the pulse , in both the numerical calculations here and the analytic calculations of reference @xcite , results in the @xmath122 shape of the spectral peaks .",
    "it should be noted that the radiation reaction force model of reference @xcite has also been included to particle motions for other laser - particle interactions , and the energy loss by the particle compared with the energy in the calculated spectra , with good agreement .",
    "the question arises as to what resolution is required to accurately reproduce spectra using this method .",
    "firstly , the particle trajectories themselves have to be reproduced accurately .",
    "secondly , the quadratic interpolation must be an accurate representation of the function @xmath126 . since the calculation is an integral , slight discontinuities at grid points are not as important as the accuracy of the function between grid - points .",
    "this means that a spline interpolation method is not necessarily better , and has been found to be worse , than an interpolation that only relates to local grid - points . if the coefficient for a cubic interpolation term is small ,",
    "@xmath127 , then the spectrum should be accurately modeled .",
    "the result of this is that the algorithm is not particularly efficient for calculations of highly relativistic particles ( @xmath128gev ) performing large radius orbits such as in a classic synchrotron , although it will yield correct results given sufficient resolution ( the required resolution for such orbits scales as @xmath129 , because the trigonometric nature of the motion means a cubic term exists and @xmath126 scales with @xmath129 ) . for such calculations",
    "other methods may be preferred .",
    "however , for laser or plasma based accelerator interactions , for example , where typically the electron energies are @xmath130  gev but the oscillation frequencies are very fast , @xmath131  hz , the algorithm works well .",
    "g.  bassi , j.  a. ellison , k.  heinemann , m.  venturini , and r.  warnock . .",
    "in _ 2007 ieee particle accelerator conference , vols 1 - 11 _ , ieee particle accelerator conference , pages 37233727 , 345 e 47th st , new york , ny 10017 usa , 2007 .",
    "ieee , ieee . .",
    "t.  tanaka and h.  kitamura . .",
    "in choi , jy and rah , s , editor , _ synchrotron radiation instrumentation , pts 1 and 2 _ , volume 879 of _ aip conference proceedings _ , pages 355358 , 2 huntington quadrangle , ste 1no1 , melville , ny 11747 - 4501 usa , 2007 .",
    "pohang accelerator lab ; japan synchrotron radiat res inst ; korea minist sci & technol ; korea synchrotron radiat users assoc ; japanese soc synchrotron radiat res ; daegu metropolitan city ; daegu convent & visitors bur ; korea tourism org ; korean phys soc , amer inst physics . .",
    "s.  kneip , s.  r. nagel , c.  bellei , n.  bourgeois , a.  e. dangor , a.  gopal , r.  heathcote , s.  p.  d. mangles , j.  r. marques , a.  maksimchuk , p.  m. nilson , k.  ta phuoc , s.  reed , m.  tzoufras , f.  s. tsung , l.  willingale , w.  b. mori , a.  rousse , k.  krushelnick , and z.  najmudin . . , 100(10 ) ,",
    "mar 14 2008 .",
    "h.  p. schlenvoigt , k.  haupt , a.  debus , f.  budde , o.  jaeckel , s.  pfotenhauer , h.  schwoerer , e.  rohwer , j.  g. gallacher , e.  brunetti , r.  p. shanks , s.  m. wiggins , and d.  a. jaroszynski . .",
    ", 4(2):130133 , feb 2008 ."
  ],
  "abstract_text": [
    "<S> an algorithm for calculating the spectral intensity of radiation due to the coherent addition of many particles with arbitrary trajectories is described . </S>",
    "<S> direct numerical integration of the linard - wiechert potentials , in the far - field , for extremely high photon energies and many particles is made computationally feasible by a mixed analytic and numerical method . </S>",
    "<S> exact integrals of spectral intensity are made between discretely sampled trajectories , by assuming the space - time four - vector is a quadratic function of proper time . </S>",
    "<S> the integral fourier transform of the trajectory with respect to time , the modulus squared of which comprises the spectral intensity , can then be formed by piecewise summation of exact integrals between discrete points . </S>",
    "<S> because of this , the calculation is not restricted by discrete sampling bandwidth theory , and hence for smooth trajectories , time - steps many orders larger than the inverse of the frequency of interest can be taken .    </S>",
    "<S> radiation , computational , laser , plasma , acceleration , 41.60.-m , 02.70.-c , 41.75.jv </S>"
  ]
}