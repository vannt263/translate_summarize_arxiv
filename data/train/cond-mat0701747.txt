{
  "article_text": [
    "modern experimental techniques such as atomic force microscopy or optical tweezers offer the means to study the mechanical properties of single molecules such as proteins or nucleic acids providing striking insights into their structure , energetics and dynamics @xcite . in such experiments , finely tuned forces are used to distort individual molecules and to track their response with high resolution . although mechanical single molecule experiments can yield a wealth of useful information , their thermodynamic analysis in terms of binding constants or unfolding free energies is not straightforward .",
    "this complication originates from the fact that typically the perturbation acting on the system is time dependent , driving the system away from equilibrium .",
    "in such a non - equilibrium situation the free energy , or reversible work , can not be simply calculated by integration of the average force along the pulling path .",
    "a solution is offered by jarzynski s theorem which relates equilibrium free energies to the statistics of work carried out during non - equilibrium transformations @xcite .    according to the jarzynski equality",
    ", the free energy difference @xmath0 between two states corresponding to different values of an externally controlled parameter @xmath1 can be obtained from an exponential average of the work @xmath2 performed on the system by switching the parameter from its initial to its final value : @xmath3 the average , denoted by the angular brackets , extends over all realisations of the switching process starting from a system initially in equilibrium with a heat bath at temperature @xmath4 . in an experiment in which a single molecule , say a dna fragment ,",
    "is pulled by an optical trap , the external parameter @xmath1 corresponds to the trap position and @xmath2 is the work performed on the system by the moving trap .",
    "since the force exerted on the molecule by the optical trap can be measured for every trap position , the work @xmath2 can be calculated from the experimental data and the average from equ .  ( [ eq : jarz ] ) can be determined by repeating the pulling experiment many times .",
    "while such an analysis of the experimental data is possible , one is rarely interested in the free energy of the entire system ( molecule plus trap ) as a function of the trap position .",
    "rather , the interest usually lies in the equilibrium free energy of the untrapped molecule as a function of some conformational degree of freedom such as the end - to - end distance . a way to extract that information from non - equilibrium work data has been recently proposed by hummer and szabo @xcite .",
    "this method is based on the insight that the equilibrium distribution from which the transformation is initiated can be reconstructed from the non - equilibrium distribution generated in the process .",
    "this reconstruction , in which the bias of the trap is removed , requires only knowledge of the work carried out in the transformation as well as the time - dependent trap potential , both quantities that are accessible experimentally .",
    "information extracted from single molecule experiments can be complemented with corresponding non - equilibrium computer simulations which provide detailed atomistic pictures of the molecule s response to the mechanical perturbation @xcite .",
    "as is the case for the experiments , the calculation of equilibrium free energies from such simulations using jarzynski s method or hummer and szabo s refinement becomes increasingly difficult if the external perturbation strongly removes the system from equilibrium . in this regime , the exponential average from equ .",
    "( [ eq : jarz ] ) is dominated by a few rare trajectories leading to large statistical uncertainties in the free energy estimate @xcite .",
    "this difficulty may be overcome in computer simulations by generating trajectories yielding rare but important work values with enhanced likelihood , and several techniques to do that have been devised @xcite . using these biased sampling methods , the number of non - equilibrium trajectories required to calculate free energies with a given accuracy can be dramatically lowered .",
    "a different type of efficiency enhancement of such non - equilibrium fast - switching simulations can be achieved by reducing the computational cost required to generate the individual trajectories .",
    "we have recently proposed a method to do that based on the integration of the equations of motion with unusually large time steps @xcite . since the number of steps required to propagate the system for a given time decreases with increasing time step , this approach promises computational savings .",
    "although approximate trajectories obtained with large time steps mimic the true dynamics of the system only crudely , the resulting free energies are in principle exact , the obvious limitation being the numerical stability of the integrator . in this paper",
    ", we investigate how this large - time step formalism performs in the simulation of single molecule pulling experiments . to do",
    "that we first show that the hummer - szabo procedure can be applied without major changes to trajectories obtained with large time steps .",
    "we then analyse the efficiency of the method for the force induced unfolding of deca - alanine and calculate the free energy as a function of the end - to - end distance .",
    "these simulations indicate that for time steps ranging from a conservative time step of 0.5  fs to a time step of 3.2  fs , just short of the stability limit , the computational efficiency is essentially constant .",
    "the time steps typically used in simulations of such systems are in the range of 12  fs . a detailed analysis of the trajectories obtained with different time steps reveals clear indications of their approximate character .",
    "in particular , we observe a sudden temperature drop of up to 5% during the first few steps of the pulling trajectories , as the time step is increased .",
    "this effect is most likely because of the so - called shadow hamiltonian that is conserved for symplectic integrators such as the velocity - verlet algorithm used in this study .",
    "the remainder of the paper is organised as follows .",
    "first , in sec .  [ sec : ltintro ] , we review our large timestep fast - switching method and show how the hummer - szabo procedure can be applied to this case .",
    "after that we describe the model system in sec .",
    "[ sec : model ] .",
    "results are presented in sec .",
    "[ sec : results ] followed by conclusions in sec .",
    "[ sec : conclusions ] .",
    "any deterministic time evolution in phase space can be viewed as a mapping that takes the initial point of a trajectory into its final point . expanding on this perspective",
    ", we have recently derived a generalised version of the jarzynski identity that permits to calculate exact free energies from approximate large time step trajectories both for deterministic as well as stochastic dynamics @xcite . the basis for this approach",
    "is provided by the following identity that can be shown to hold for a system with parameter dependent hamiltonian @xmath5 and a general invertible and differentiable mapping @xmath6 acting on the phase space point @xmath7 : @xmath8 here , the angular brackets denote an average over the equilibrium ( canonical ) distribution of the initial state .",
    "the work function @xmath9 , defined as @xmath10 includes the total energy change caused by switching the parameter @xmath1 from its initial value @xmath11 to its final value @xmath12 .",
    "in addition , a term depending on the jacobian @xmath13 of the mapping contributes to the work function .",
    "if the mapping @xmath6 conserves the canonical distribution , this entropic term , which takes into account the expansion or compression of phase space volume , corresponds to the heat exchange @xcite . in this case ,",
    "( [ eq : ltwork ] ) is equivalent to the first law of thermodynamics .    to apply equ .",
    "( [ eq : ltwork ] ) to the case of large time step trajectories , one has to consider the mapping that results from a concatenation of molecular dynamics steps . the work function then consists of the difference in total energy between the initial and final point of the trajectory and a sum of terms depending on the phase space volume change during each time step .",
    "we emphasise that in principle equ .",
    "( [ eq : ltwork ] ) yields exact free energy differences regardless of the size of the time step .",
    "the application of the large time step method becomes particularly simple if the algorithm used for the integration of the equations of motion conserves phase space volume . in this case , the jacobian is strictly unity for each time step and the work function reduces to the energy difference accumulated along the trajectory , @xmath14 . in the present work",
    "we will only use the velocity - verlet algorithm , which is volume - preserving @xcite .",
    "a detailed discussion of the large time step formalism for non volume - preserving integrators and related complications can be found in ref .",
    "@xcite .",
    "since jarzynski s identity holds for a time evolution resulting from the integration of the equations of motion with large time step , one expects that also the hummer - szabo procedure mentioned above remains valid in this case .",
    "we next show that this is indeed the case .",
    "consider a system with hamiltonian @xmath15 where @xmath16 is the molecular hamiltonian and @xmath17 is the parameter dependent trap potential coupling to the variable @xmath18 .",
    "what one would like to calculate is the free energy @xmath19 defined up to a constant as @xmath20 \\rangle_0,\\ ] ] where the brackets @xmath21 denote an average over the equilibrium distribution of the molecular system without the trap , i.e. , over the distribution @xmath22 the goal now is to derive an expression that permits to compute the free energy from the phase space distribution resulting from application of the mapping @xmath6 where at the same time the parameter @xmath1 is changed from its initial value @xmath11 to its final value @xmath12 .",
    "to do so , we first perform a transformation of variables from @xmath7 to @xmath23 obtaining @xmath24,\\ ] ] where @xmath25 $ ] is the partition function of the system without trap . multiplication and division of the integrand with @xmath26-\\beta v(q(y ) , \\lambda_b)\\}$ ] then yields @xmath27 e^{-\\beta w_\\phi}\\rangle,\\ ] ] where @xmath28 is the partition function of the entire system , including the trap at position @xmath11 and the average is over initial conditions canonically distributed with respect to @xmath29 .",
    "equation ( [ equ : husza1 ] ) implies that the entire free energy profile @xmath30\\rangle_0 $ ] can be calculated up to a constant by histogramming the variable @xmath31 at the end of the transformation @xmath6 and weighing each contribution to the histogram with the work exponential @xmath32 .",
    "this weight essentially takes into account the different phase space probability of a particular point in the equilibrium ensemble and the ensemble generated by the mapping .",
    "equation ( [ equ : husza1 ] ) is analogous to the central result of hummer and szabo ( equ .",
    "( 7 ) of ref .",
    "@xcite ) , which therefore is valid also for general phase space mappings .    in the case of a molecular dynamics simulation ,",
    "the mapping @xmath6 consists of a concatenation of a certain number of time steps .",
    "equation ( [ equ : husza1 ] ) can be applied at each stage of the mapping and , accordingly , we rewrite it as @xmath33 e^{-\\beta w_{\\phi_i}}\\rangle.\\ ] ] here , the index @xmath34 refers to the number of steps the mapping @xmath35 and @xmath36 consists of is the work accumulated in the first @xmath34 steps .",
    "the parameter @xmath1 is changed in discrete steps @xmath37 such that @xmath38 and @xmath39 and @xmath40 is the total number of steps .    in principle",
    ", the full free energy profile can be obtained from data at one single time . for better accuracy",
    "one can combine the free energy profiles for all time steps using the weighted histogram technique introduced by ferrenberg and swendsen @xcite : @xmath41\\exp(-\\beta w_{\\phi_i})\\rangle}{\\langle \\exp(-\\beta w_{\\phi_i})\\rangle } } { \\sum_i \\frac{\\exp ( -\\beta v(q ; \\lambda_i))}{\\langle\\exp(-\\beta w_{\\phi_i})}}.\\ ] ] combining the histograms for different times in this way , each histogram contributes most where it has the highest accuracy . in conclusion",
    ", we have demonstrated that the method of hummer and szabo can be transferred essentially without changes to the case of large time step trajectories .",
    "to investigate the computational efficiency of pulling simulations with large time steps we study the force - induced unfolding of a deca - alanine molecule in vacuum .",
    "this oligo - peptide with an acetylated n - terminus and an amidated c - terminus consists of ten alanine residues and forms an @xmath42-helix that is stable in vacuum at room temperature ( fig .",
    "[ fig : d - ala ] ) .",
    "it has @xmath43 atoms and is therefore small enough to permit the calculation of a large number of trajectories in a reasonable amount of time , but is , on the other hand , close to the systems treated in molecular biology or chemistry . except the differing termini , the model is identical to the one studied by park _ et .",
    "@xcite . by using this system studied previously as our test case , we can check the results obtained with large time steps not only against our own calculations with `` safe '' time steps , but against an external reference .",
    "-helical ( top ) and its final coil configuration ( bottom ) .",
    "the green atom on the right hand side stays fixed throughout the simulation while the green atom on the left hand side moves in a harmonic trap that is translated from right to left - as indicated by the spring . ]",
    "the unfolding process from the helix to the coil configuration is induced by imposing a time - dependent trap potential @xmath44 on the amide nitrogen atom of the capped c - terminus at position @xmath31 while keeping the nitrogen atom of the first residue fixed at the origin .",
    "the harmonic trap potential @xmath44 is given by @xmath45 ^ 2,\\ ] ] where @xmath46 is the trap position and @xmath47 is the force constant of the potential which is set to @xmath48 kcal / mol @xmath49 in all simulations .",
    "the trap is moved from its initial ( @xmath50 ) position @xmath51 to its final ( @xmath52 ) position @xmath53 at constant speed @xmath54 .",
    "the initial trap position of @xmath55  is chosen such that the system starts in a slightly compressed state where the end - to - end distance is smaller than the equilibrium distance , which lies at about @xmath56  .",
    "the final position @xmath57  leads to a fully unfolded state .",
    "the trap speed @xmath58 must be chosen sufficiently low such that it allows good sampling using the jarzynski equality .",
    "on the other hand , it should be high enough to permit sampling of sufficiently many trajectories .",
    "following park _ _ et al .  _",
    "@xcite , we chose a trap speed of @xmath59  / ps , which amounts to a trajectory length of @xmath60 ns .",
    "the canonically distributed initial conditions , as required by jarzynski s theorem , are generated from an equilibrium langevin molecular dynamics simulation at @xmath61 with a small time step of @xmath62 fs . from this `` base trajectory ''",
    "we start a non - equilibrium pulling trajectory every one thousand time steps using the velocity verlet algorithm .",
    "all our simulations were performed using the charmm force field version 27 with both charmm and the namd simulation package , respectively @xcite .",
    "in this section we first show that we obtain identical free energy profiles ( well within statistical error bars ) , regardless of the time step used .",
    "we then discuss an interesting effect we observed for the temperature behaviour in our large timestep simulations .",
    "finally , we address the central point of this paper , the efficiency of the large time step method for the calculation of free energy profiles .       of the end - to - end - distance @xmath31 for various timesteps obtained from @xmath63 trajectories at @xmath64 ns corresponding to the final position of the trap . ]    from repeated pulling simulations one can collect separate distributions of the end - to - end distance @xmath31 for every time @xmath65 .",
    "examples of such distributions obtained for the final position of the pulling trap for different time steps @xmath66 are depicted in fig .",
    "[ fig : etehist ] along with the trap potential .",
    "note that the histograms do not differ significantly for the different time steps and that the distributions are not centred at the minimum of the trap potential but to the left of it , indicating that the molecule slightly lags behind the trap potential .    using the procedure of hummer and szabo ,",
    "we have combined the distributions corresponding to different times obtaining the free energy as a function of the end - to - end distance @xmath31 . for the application of equ .",
    "( [ eq : humcor ] ) it is important that the histograms of the end - to - end distance have sufficiently narrow bins . if not , the correction for the pulling potential in the denominator of equ .",
    "( [ eq : humcor ] ) varies too much within a bin , thus giving the wrong correction factor . in our simulations we used a bin size of @xmath67  .",
    "the free energy profiles calculated with equ .",
    "( [ eq : humcor ] ) are depicted in fig .",
    "[ fig : fprof_all_corr ] and agree well with the curves calculated by park _ et .",
    "@xcite . as can be inferred from the figure , all time steps yield the same result within statistical deviations . the free energy profile @xmath19 displays a minimum at an end - to - end distance of @xmath68  corresponding to the @xmath42-helical native state .",
    "for increasing @xmath31 , the free energy then grows almost linearly up to @xmath69  . in this regime ,",
    "the hydrogen bonds in the helix are consecutively cleaved .",
    "after all hydrogen bonds have been broken , the free energy keeps growing , but at a smaller rate .",
    "no stable state exists for the unfolded molecule .",
    "as function of the end - to - end distance @xmath31 for various timesteps obtained from @xmath63 trajectories using the hummer - szabo procedure . ]       as a function of the trap position @xmath70 obtained for various timesteps and averaged over @xmath71 trajectories . ]    the instantaneous temperature @xmath72 during the pulling process averaged over two - thousand trajectories is depicted in fig .",
    "[ fig : temp - curve ] for various time steps .",
    "the overall temperature behaviour is similar for all time steps : after a small rise occurring at a trap position of about @xmath73  , the temperature decreases steadily throughout the switching process .",
    "however , the temperature traces differ by an essentially constant offset which is due to a very sharp decline of up to five percent from the @xmath74 k of the langevin base trajectory . this initial temperature drop , which occurs during the first few integration steps , grows with increasing time step and is accompanied by an increase in the potential energy such that the total energy remains approximately constant .",
    "the potential energy increase is mainly caused by an increase of the angle bending potential energy terms and , to a smaller extent , of the bond stretching interactions .",
    "the redistribution of energy from kinetic to potential terms suggests that the equipartition theorem may be violated for large time step trajectories .",
    "we indeed find that in straightforward equilibrium md simulations carried out with time steps larger than @xmath60 fs the kinetic energy of the hydrogen atoms is up to @xmath75 percent less than that of heavier atoms .",
    "this phenomenon is most likely linked to the nearly harmonic potentials used to model the angle bending and bond stretching interactions and can be made plausible by considering a one - dimensional harmonic oscillator with hamiltonian @xmath76 here , @xmath31 and @xmath77 denote the position and the velocity of the oscillator and @xmath78 and @xmath79 are its mass and frequency , respectively .",
    "as is well known @xcite , symplectic integration schemes like the velocity verlet algorithm do not conserve the actual hamiltonian of a system , but a timestep - dependent  shadow hamiltonian  @xmath80 which converges to the real hamiltonian only in the limit of @xmath81 .",
    "for the harmonic oscillator this shadow hamiltonian is known analytically @xcite : @xmath82 starting from a given phase space point @xmath83 the natural dynamics of the harmonic oscillator traces out an ellipsoid on which the hamiltonian from equ .",
    "( [ eq : hoham ] ) is conserved ( solid line in fig .",
    "[ fig : ellipsoid ] ) .",
    "however , a trajectory obtained by integrating the equations of motion of the harmonic oscillator with finite time step @xmath66 lies on a curve on which the shadow hamiltonian @xmath84 rather than the hamiltonian @xmath85 is conserved ( dashed line in fig .",
    "[ fig : ellipsoid ] ) .",
    "it follows from the specific form of the shadow hamiltonian , that this curve , which is also an ellipsoid , is compressed on the momentum axis by a factor @xmath86 but expanded on the position axis by a factor @xmath87 with respect to the ellipsoid defined by a constant hamiltonian .",
    "thus , increasing the integration time step @xmath66 leads to a decrease in the average kinetic energy and , at the same time , to an increase of the average potential energy .    under the assumption that the dynamics obtained by application of the velocity verlet algorithm is nearly continuous , a canonical average of the kinetic and potential energy averaged over one oscillation period yields @xmath88 and @xmath89 respectively .",
    "the deviation @xmath90 of the kinetic temperature @xmath91 from the temperature @xmath92 of the distribution of the initial conditions is then obtained from the averaged kinetic energy according to : @xmath93     of the kinetic temperature from the temperature of the initial conditions ( symbols ) as a function of @xmath94 .",
    "the line is a linear fit to the data with slope @xmath95 fs@xmath96 . ]",
    "the quadratic dependence of the temperature drop from the time step expected for a system with nearly harmonic degrees of freedom can be tested for the deca - alanine molecule .",
    "figure [ fig : trel ] shows the relative temperature drop obtained from the data depicted in fig .",
    "[ fig : temp - curve ] as a function of @xmath94 along with a linear fit to the data .",
    "approximately , the relative temperature drops follow the quadratic behaviour found in the harmonic oscillator .",
    "moreover , the slope of the fitted line is consistent with the assumption that each hydrogen atom is involved in exactly one harmonic degree of freedom and the frequency of the corresponding motion is of the order @xmath97 .",
    "the above considerations suggest that the sudden drop of the kinetic temperature observed for the deca - alanine with increasing time step may be related to the particular form of the shadow hamiltonian corresponding to the nearly harmonic degrees of freedom of the molecule .",
    "we stress , however , that this effect has no impact on the large timestep method , because the only requirements are a canonical ensemble of initial conditions and a volume preserving integrator such as the velocity verlet scheme .",
    "as long as these conditions are met , the large time step method is valid regardless of the unusual behaviour of some energy components .      to assess the efficiency of the large timestep algorithm",
    "we need a way to determine the statistical error in the free energy profile as a function of the number of trajectories used in the jarzynski average . for this purpose",
    "we use a block averaging method @xcite , analogous to zuckerman and woolf @xcite .",
    "first we partition all @xmath98 trajectories into @xmath99  blocks  of size @xmath100 and introduce the free energy @xmath101 calculated by applying equ .",
    "( [ eq : humcor ] ) only to the @xmath40 trajectories of block @xmath34 .",
    "then , we compute the statistical deviation - equ .  ( [ eq : cofn ] ) - of @xmath101 from the mean @xmath102 , averaged over all trajectories . to improve the accuracy of this error estimate we average also over the end - to - end distances @xmath31 :",
    "@xmath103 ^ 2\\right\\rbrace.\\ ] ] here , @xmath104 is the number of end - to - end distances over which the average extends and in all our calculations @xmath105 .",
    "the quantity @xmath106 is the mean square deviation of the block free energy from the free energy obtained from all trajectories . for a different approach to efficiency estimation in fast switching simulations , which , however , requires a larger computational effort , see @xcite .    from the resulting curves @xmath106 , which are depicted in fig .",
    "[ fig : blockavg ] , we can extract the number @xmath107 of trajectories needed to obtain an accuracy of @xmath108 . to do that we determine the intersection of the correlation curves @xmath106 with the error threshold , shown as a red dashed line in fig .",
    "[ fig : blockavg ] .",
    "the threshold of @xmath108 is arbitrary , but , as the inset of fig .",
    "[ fig : blockavg ] indicates , the relative numbers @xmath107 for different timesteps are largely independent of the choice of the threshold .     as a function of the block size @xmath40 for different timesteps and the threshold @xmath109",
    "( red dashed line ) .",
    "the inset shows the same graphs on a doubly logarithmic scale . ]",
    "the total computational cost required to obtain a free energy profile with an accuracy of @xmath108 is proportional to the number of force evaluations performed in the calculation and thus to the number @xmath110 of time steps per trajectory : @xmath111 the cost function @xmath112 is the total number of molecular dynamics steps required to calculate the free energy with accuracy @xmath108 , or , in other words , the total computational cost of the simulation in units of the cost of one single molecular dynamics step .",
    "the behaviour of the computational cost as a function of the integration time step @xmath66 ( see fig .  [",
    "fig : cost ] ) , indicates that in the range @xmath113 fs the computational cost of the free energy calculation is essentially constant while time steps shorter than @xmath114 fs lead to an increased computational cost .    .",
    "the generalisation of the jarzynski theorem for invertible and differentiable maps justifies the use of large time steps in fast switching simulations and thus permits the calculation of valid free energies from computationally inexpensive trajectories . in the present work we have adapted the hummer - szabo procedure to large time step dynamics and",
    "have shown that it is applicable to the simulation of complex biomolecules .",
    "approximate large time step trajectories generated with the velocity verlet algorithm display an interesting initial temperature drop , which is most likely due to the specific properties of the shadow hamiltonian conserved by the discrete dynamics .",
    "although this effect leads to inaccurate trajectories violating the equipartition theorem , it is irrelevant for the validity of the large timestep formalism since all its requirements , a phase space volume conserving integrator and a canonical distribution of initial conditions , are met also in this case .",
    "it should be noted that the temperature jump indicating the approximative nature of the trajectories can be observed already at a time step of 2  fs , a value which is often used in equilibrium simulations of protein and peptide systems .",
    "thus , one may argue that the large time step approach is more correct than a comparable calculation based on equilibrium methods alone .",
    "the potential computational benefit of the large time step method is in part compensated by a growth of statistical fluctuations observed in simulations using computationally inexpensive trajectories generated with larger time steps .",
    "all time steps from about @xmath62 fs up to the stability limit of the integrator yield essentially the same efficiency .",
    "time steps smaller than about @xmath62 fs , however , lead to an efficiency loss .",
    "this work was supported by the austrian science fund ( fwf ) under grant no .",
    "p17178-n02 and within the science college `` computational materials science '' under grant w004 .",
    "simulations were carried out in part on the schrdinger cluster of the university of vienna ."
  ],
  "abstract_text": [
    "<S> recently , we presented a generalisation of the jarzynski non - equilibrium work theorem for phase space mappings . </S>",
    "<S> the formalism shows that one can determine free energy differences from approximate trajectories obtained from molecular dynamics simulations in which very large timesteps are used . in this work </S>",
    "<S> we test the method by simulating the force induced unfolding of a deca - alanine helix in vacuum . </S>",
    "<S> the excellent agreement between results obtained with a small , conservative time step of 0.5  fs and results obtained with a time step of 3.2  fs ( i.e. , close to the stability limit ) indicates that the large time step approach is practical for such complex biomolecules . </S>",
    "<S> we further adapt the method of hummer and szabo for the simulation of single - molecule force spectroscopy experiments to the large time step method . while trajectories generated with large steps are approximate and </S>",
    "<S> may be unphysical  in the simulations presented here we observe a violation of the equipartition theorem  the computed free energies are exact in principle . in terms of efficiency </S>",
    "<S> , the optimum time step for the unfolding simulations lies in the range 13  fs . </S>"
  ]
}