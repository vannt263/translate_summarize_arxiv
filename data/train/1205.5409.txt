{
  "article_text": [
    "the sdss ( @xcite ) provides photometry ( including widely - used aperture and psf magnitudes ) for objects down to @xmath322.5  mag and covering 14555  deg@xmath4 ( @xcite - from now on aih11 ) .",
    "the photometric calibration is uniform over the survey area at the @xmath01% and @xmath02% levels in the @xmath1 and @xmath2 wavebands , respectively ( @xcite - from now on pad08 ) .",
    "this vast data set has provided insight into many areas of astronomical research , including the large - scale structure of the universe , properties of galaxies , galactic structure , stellar populations , just to name a few .    for many of the scientific applications of sdss photometric data , an accurate absolute photometric calibration (",
    "i.e. knowledge of fluxes in physical units such as j  m@xmath5  s@xmath6 ) is not as important as a precise relative calibration over the survey .",
    "furthermore , it is substantially more challenging to achieve an accurate absolute calibration due to the inherent difficulties in minimising the systematic uncertainties in the mapping between the spectral energy distribution ( sed ) of an appropriate ( and usually very bright ) fundamental spectrophotometric standard and the natural photometric system of the survey . for these reasons ,",
    "much recent effort has been invested in determining a precise relative calibration of sdss imaging data , and other similar surveys have followed suit ( e.g. @xcite ) .",
    "future ground - based all - sky surveys that require 1% or better relative photometric calibrations ( e.g. panstarrs - @xcite , lsst - @xcite , etc . ) are investing considerable resources to perform exquisitely precise measurements of the telescope - instrument - detector system throughput as a function of wavelength for each imager pixel ( @xcite ; @xcite ) and to use spectroscopic observations of calibrator stars coupled with detailed atmospheric modelling to enable the precise correction of atmospheric extinction effects to the level of a few millimagnitudes ( @xcite ; @xcite ) .",
    "the purpose of a relative photometric calibration is to model the systematic differences in the measured magnitudes of survey objects as they are observed over time and over the spatial extent of the survey .",
    "the sources of these differences are multitude although they are usually dominated by atmospheric extinction variations , differences in detector responses , and errors introduced during the photometric analysis of the images .",
    "ideally , correction of the full survey data using the fitted calibration model should result in object photometry that reaches some target homogeneity such as the desirable 1% level .",
    "the key to being able to fit a relative photometric calibration across survey data is the existence of _ repeat observations _ of a sufficient number of objects to link all the observational data via the adopted calibration model and to provide strong enough constraints on the model parameters .",
    "the early development of the photometric calibration methodology may be found in the works of @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "pad08 present the impressive development of a photometric calibration model for sdss data on a scale many times larger than has been used before .",
    "the model is fit to the repeat observations from the overlaps between the scan columns and at the ends of the scans along great circles ( see section  [ sec : camera ] ) , and from the repeat scanning of certain scan regions .",
    "for sdss data release 6 ( @xcite ) , their model has @xmath02000 calibration parameters of interest and @xmath010@xmath7 nuisance parameters ( the star mean magnitudes ) to be solved for .",
    "pad08 marginalise over the unknown star mean magnitudes and iteratively solve the normal equations of the smaller least squares problem for the calibration parameters .",
    "the resulting relative calibration is good to @xmath01% in the @xmath1 wavebands ( @xmath02% in the @xmath2 waveband ) .    in pad08",
    ", the authors looked at the calibration residuals as a function of star brightness ( or mean magnitude ) , as a function of detector column to assess the accuracy of the flat - field calibrations , as a function of time , and as a function of celestial coordinates , the latter being further decomposed into spatial error modes .",
    "they found a clear trend as a function of time , which manifests as `` coherent errors at the few millimagnitude level '' , and which most likely correlates with time - varying image quality parameters such as seeing , sky brightness , etc .",
    "an example of such a time - dependent trend may be discerned as a @xmath010  mmag drift in the magnitude residuals in the upper panel of fig .  9 in pad08 .",
    "this implies that the pad08 photometric model may need to be updated to include appropriate terms to fit these trends .",
    "we also highlight the fact that the photometric calibration parameters in pad08 are derived from fitting the sdss aperture magnitudes and the calibration is then applied to calibrate various object magnitude measurements in the survey catalogues such as psf magnitudes .",
    "the purpose of this paper is to extend the investigation into the systematic trends in the sdss photometric data .",
    "we stress that an exhaustive study of this topic is virtually impossible and not within the scope of our work .",
    "we start in section  [ sec : modelling ] by describing our modelling method . in section",
    "[ sec : photo_data ] , we describe the procedure we use to select appropriate photometric data from the sdss data base .",
    "we then investigate the systematic trends in the sdss aperture and psf magnitude measurements , and we report on the trends we find as a function of psf fwhm , object brightness , and subpixel coordinates ( section  [ sec : systrend ] ) . in section",
    "[ sec : compare ] , we derive the relation between the aperture and psf magnitude scales , which we find suffers from non - linearities .",
    "we summarise and discuss our results in section  [ sec : disc ] .",
    "our approach to identifying the systematic trends in the sdss photometric data consists of investigating how the photometry depends on each object or image property which we suspect could have an impact on the photometry .",
    "our aim is to identify any significant trends that were not modelled during the pad08 calibration of the aperture magnitudes .",
    "however , since we do not know _ a priori _ the form of any potential trend , we can not assume a smooth functional form at this stage .",
    "instead , we introduce a binning for an object / image property @xmath8 that covers the full range of data values that we are modelling . for the @xmath9th bin in @xmath8",
    ", we introduce an unknown magnitude offset @xmath10 to be determined , the purpose of which is to model the mean difference of the photometric measurements within the corresponding bin in @xmath8 from the rest of the photometric measurements indicates that the photometric measurements within the corresponding bin in @xmath8 are _ fainter _ on average than the rest of the photometric measurements , and vice versa . ] . our photometric model",
    "may then be written as : @xmath11 where @xmath12 is the model magnitude for the @xmath13th magnitude measurement @xmath14 , @xmath15 is the unknown true instrumental magnitude of the @xmath16th object , @xmath17 is the number of objects in the photometric data sample , @xmath18 is the number of magnitude offsets @xmath10 that we are attempting to fit , and @xmath19 is the kronecker delta - function : @xmath20 note that the @xmath13th photometric measurement in our photometric data sample belongs to the @xmath21th object and the @xmath22th bin in @xmath8 , where the adopted notation for @xmath16 and @xmath9 reflects the fact that both of the indices @xmath16 and @xmath9 are functions of the index @xmath13 . however , in the rest of this paper , we devolve to using the notation @xmath16 and @xmath9 for @xmath21 and @xmath22 , respectively , in order to avoid confusion in our subscript notation .    the photometric model defined in equation  [ eqn : phot_model ] is degenerate since increasing each of the instrumental magnitudes @xmath15 by an arbitrary amount @xmath23 at the same time as decreasing each of the magnitude offsets @xmath10 also by @xmath23 will have no effect on the model values @xmath12 .",
    "this degeneracy may be removed by fixing the instrumental magnitude of a single object to an arbitrary but convenient value .",
    "this is equivalent to fixing the absolute photometric calibration of the observations .",
    "equation  [ eqn : phot_model ] is linear and therefore we may use general linear least - squares ( @xcite ) to find the solution for the instrumental magnitudes @xmath15 and the magnitude offsets @xmath10 . the chi - squared associated with equation  [ eqn : phot_model ] is : @xmath24 where @xmath25 is the number of photometric measurements , and @xmath26 is the uncertainty on the @xmath13th photometric measurement .",
    "the normal equations of the least - squares problem are found by differentiating the @xmath27 in equation  [ eqn : chi2 ] with respect to each parameter in the model and they may be written in matrix form as : @xmath28 where * a * , * b * , and * d * are matrices of sizes @xmath29 , @xmath30 , and @xmath31 elements , respectively , and where * * v**@xmath32 and * * v**@xmath33 are vectors of lengths @xmath17 and @xmath18 elements , respectively .",
    "the vector * * x**@xmath32 contains the @xmath17 unknown instrumental magnitudes @xmath15 , and the vector * * x**@xmath33 contains the @xmath18 unknown magnitude offsets @xmath10 .",
    "the individual elements of * a * , * b * , * d * , * * v**@xmath32 , and * * v**@xmath33 are given by : @xmath34    matrix * a * ( equation  [ eqn : ael ] ) is diagonal since the product @xmath35 is only non - zero when @xmath36 , which makes sense because a photometric measurement @xmath14 may only correspond to a single object .",
    "similarly , matrix * d * ( equation  [ eqn : del ] ) is diagonal , which is due to the fact that a photometric measurement @xmath14 may only correspond to a single bin in @xmath8 .",
    "matrix * b * ( equation  [ eqn : bel ] ) happens to be sparse when there are generally less photometric measurements per object than bins in @xmath8 . finally , we observe that the elements of the vectors * * v**@xmath32 and * * v**@xmath33 ( equations  [ eqn : v1el ]  &  [ eqn : v2el ] ) are simply the inverse - variance weighted sums of the photometric measurements @xmath14 for each object and for each bin in @xmath8 , respectively .    at this stage",
    ", it is worth noting that the construction of the least squares matrix and the vector on the right - hand side is a highly parallel computational problem due to the natural partitioning of the photometric measurements on a per - object and per - bin - in-@xmath8 basis , which is a very convenient fact because this is where a large fraction of the computational operations occur in finding the solution for * * x**@xmath32 and * * x**@xmath33 .",
    "furthermore , the facts that * a * and * d * are diagonal , and * b * is sparse , may be used to implement computer code that makes efficient use of available memory resources , especially when it may be unfeasible to store the full versions of the matrices * a * , * b * , and * d * in computer memory .      the fact that * a * is diagonal in the normal equations for photometric models including the true instrumental magnitudes ( as in equation  [ eqn : phot_model ] ) has been spotted previously by @xcite , and it is clearly the case in @xcite even though no comment was made . in appendix  a of @xcite , they use this property to develop a tractable way of solving the normal equations for the parameter vectors * * x**@xmath32 and * * x**@xmath33 , and for calculating the marginalised covariance matrix * c * for the parameters in * * x**@xmath33 . we briefly repeat this method here using the notation in this paper .",
    "eliminating the parameter vector * * x**@xmath32 from the normal equations in equation  [ eqn : normal_eqns ] yields : @xmath37 where the elements of * * a**@xmath6 are easily computed as : @xmath38 cholesky factorisation of the symmetric and positive - definite matrix @xmath39 , followed by forward and back substitution is the most efficient and numerically stable method ( @xcite ) for obtaining the solution for the magnitude offsets @xmath10 .",
    "the solution for the instrumental magnitudes @xmath15 , if required , can be obtained by substituting the solution for * * x**@xmath33 into equation  [ eqn : normal_eqns ] : @xmath40 finally , the marginalised covariance matrix * c * for the magnitude offsets @xmath10 may be obtained by marginalising over the true instrumental magnitudes : @xmath41      we have implemented an idl program called fit_photometric_calibration.pro as part of the danidl library of routines .",
    "this program allows the user to fit a fully configurable and highly flexible photometric calibration model ( including static and rotating illumination corrections - @xcite ) to a set of magnitude measurements , and it employs the methodology developed in sections  [ sec : normal_equations ]  &  [ sec : solving_normal_equations ] .",
    "the specific photometric model defined in equation  [ eqn : phot_model ] uses only one of a slew of available terms that may be configured in the photometric model in fit_photometric_calibration.pro .",
    "the program that we have developed works solely by storing all the necessary data and arrays in computer memory , which limits the size of the fitting problem that can be tackled to the amount of memory that is available .",
    "if we improved our program to capitalise on the highly parallel nature of the computational problem by reading and writing data from the computer hard disk as necessary , then the limit on the size of the fitting problem that can be solved can be greatly increased to match with the amount of disk space available since computer hard disks currently obtain much larger storage sizes than computer memory . by doing this",
    ", we would also remove any constraint imposed by the amount of computer memory available , because the program would only use a limited and well - defined amount of memory at any one time .",
    "however , for the analysis of the data presented in this paper , our idl program is not limited by the amount of computer memory that is available .",
    "we have briefly tested the performance of our program and its scalability to larger data sets . using a single intel xeon 2.0ghz cpu on a 64-bit machine with 132 gb of ram",
    ", we find that for @xmath42 and @xmath43 , our program uses @xmath01.7 , 4.4 , and 8.9  gb of ram for @xmath44 , @xmath45 , and @xmath46 , respectively , while taking @xmath01.6 , 3.8 , and 8.5  minutes to run , respectively .",
    "the processing limit for our program on the same machine seems to lie at approximately @xmath47 , @xmath48 , and @xmath49 , which requires @xmath048  gb of ram and takes @xmath052  minutes to run .",
    "the sdss imaging camera , mounted on a dedicated 2.5 m telescope at the apache point observatory ( new mexico ) , consists of an array of 30 site / tektronix charge - coupled devices ( ccds ) , each of size 2048@xmath502048 pix and with a pixel scale of 0.396  pix@xmath6 , arranged in six columns of five chips each with a space of approximately one chip width between columns ( @xcite ; @xcite ) .",
    "each row of six chips is positioned behind a different filter so that sdss imaging data are produced in five wavebands , namely @xmath2 , @xmath51 , @xmath52 , @xmath13 , and @xmath53 ( @xcite ; @xcite ) .",
    "the camera operates in time - delay - and - integrate ( tdi ) readout mode scanning along great circles in the sky at the sidereal rate ( @xcite ) .",
    "the camera scan direction is parallel to the six columns of ccds , and the temporal observation order of the wavebands is @xmath54 .",
    "the chip arrangement is such that two scans may be used to cover a filled stripe 254 wide , with @xmath01(@xmath08% ) overlap between chip columns in the two scans .",
    "the telescope and camera optics , along with the ccd layout , are designed such that , given perfect tracking along great circles , the optical distortion over the field - of - view ( fov ) results in star tracks across each ccd that deviate from being parallel to the ccd columns by at most @xmath00.06(or @xmath00.15  pix ) over the length of a detector in the worst case .",
    "we obtained our photometric data sample from sdss dr8 ( aih11 ) , which includes all imaging data up to the retirement of the sdss camera , reprocessed with an updated version of the sdss photometric pipeline , and calibrated using the pad08 modelling scheme .",
    "we employed the casjobs interface to query the dr8 data base .",
    "we extracted photometric observations of all stars ( type@xmath556 ) that have no `` child objects '' ( nchild@xmath550 ; @xcite ) and calibrated ( calibstatus_filter and 1 ) psf magnitudes brighter than 19  mag ( psfmag_filter@xmath5619 ) with positive uncertainties smaller than 1  mag ( 0@xmath56psfmagerr_filter@xmath561 ) .",
    "the magnitude threshold was chosen to limit our data sample to those objects with photometric uncertainties of better than @xmath02 - 3% .",
    "the photometric measurements are supplied with corresponding quality flags which aid in the selection of `` good quality '' measurements .",
    "we further filtered our data by applying the set of quality constraints described in table  2 of @xcite .",
    "finally , the resolution of the individual objects to which each photometric observation belongs is available in dr8 and the object identifications are stored in the thingid entry in the dr8 data base . where this identification process fails , a thingid value of @xmath571 is stored , and we therefore dropped such measurements from our data sample .    [",
    "cols=\"^,^ \" , ]     [ tab : dr8_data_repeat_psf ]      we now analyse the psf magnitudes .",
    "we use the data corresponding to table  [ tab : dr8_data_repeat_psf ] . independently for each detector , we investigate how the psf magnitudes correlate with various object / image properties . using the same fitting procedure as that described in section  [ sec : apermag1 ] applied to the psf magnitude measurements , we find that there are no significant trends in the fitted magnitude offsets as a function of detector row ( @xmath58  mmag ) or column ( @xmath59  mmag ) , and , as with the aperture magnitude measurements , we do find a systematic trend in the magnitude offsets as a function of psf fwhm and object brightness . we also find a systematic trend in the magnitude offsets as a function of subpixel coordinates .",
    "[ fig : maps_psf ] is the equivalent of fig .",
    "[ fig : maps_ap ] produced for the psf magnitudes .",
    "the only difference in the plot schema is that in fig .",
    "[ fig : maps_psf ] , the colour - scale in each of the ipsms is in units of mmag rather than in units of @xmath60 . for all wavebands ,",
    "the colour - scale in these maps is linear , and it runs between @xmath613  mmag for the maps corresponding to the under - sampled psf regime , and between @xmath610.8  mmag for the maps corresponding to the normally - sampled and well - sampled psf regimes .    inspection of the plots of the fitted magnitude offsets as a function of psf fwhm reveals that as the psf fwhm increases from the critical sampling to @xmath02.2 - 2.5 , the magnitude offsets `` oscillate '' with an amplitude of @xmath02 - 6  mmag ( the @xmath62 wavebands show the clearest examples ) while also decreasing with a slight gradient ( @xmath01 - 5  mmag / arcsec ; most notably in the @xmath51 waveband ) .",
    "this behaviour is largely independent of object brightness ( except in the @xmath53 waveband ) .",
    "it is also interesting to note that the form and amplitude of the trend is consistent between the different camera columns for each waveband . for psf",
    "fwhms greater than @xmath02.2 - 2.5 , we find that as the psf fwhm increases , the magnitude offsets increase sharply by up to @xmath020 - 50  mmag . for psf fwhms less than the critical sampling , the systematic trend tends to be that as the psf fwhm decreases , the fainter an object is measured ( except in the @xmath53 waveband ) , with some evidence that this behaviour becomes more pronounced for even smaller psf fwhms ( see the @xmath63 wavebands ) .",
    "we have tested that the detected systematic trends in the magnitude offsets as a function of psf fwhm are independent of right ascension , declination , detector coordinates , subpixel coordinates , and the number of neighbouring objects within 15@xmath64 by making similar plots to those displayed in fig .",
    "[ fig : maps_psf ] for various mutually - exclusive partitions of our photometric data .",
    "clearly , the systematic trends in the magnitude offsets for the psf magnitude measurements are more complicated than the trends observed in the magnitude offsets for the aperture magnitude measurements , and this suggests that it is the algorithms used to measure the psf magnitudes that introduce these trends into the photometry .",
    "the scientific literature contains only brief qualitative descriptions of the psf fitting procedures implemented in the sdss pipeline ( @xcite ; @xcite ) , and there are no published studies in which an analysis of the behaviour of these routines has been performed .",
    "therefore , we do not attempt to offer an in - depth explanation for any of these systematic trends in terms of the algorithms used to measure the psf magnitudes .",
    "we limit our scope to simply highlighting the existence and form of the systematic trends in the psf magnitude measurements , and to speculating that the `` oscillations '' present in the magnitude offsets are probably due to some form of resonance between the psf shape and the underlying pixel grid .",
    "the ipsms displayed in fig .",
    "[ fig : maps_psf ] show very clear systematic trends in each of the regimes of under - sampled , normally - sampled , and well - sampled psfs .",
    "for the regime of under - sampled psfs , we find that in the @xmath65 wavebands , objects with their centroid close to the centre of a detector pixel are measured by up to @xmath04 - 7  mmag brighter than if their centroid is at the corner of a detector pixel .",
    "we can not discern this effect for the regime of under - sampled psfs in the @xmath62 wavebands due to the lack of data in these wavebands with psf fwhms less than the critical sampling .",
    "since these systematic trends are not present in the regime of under - sampled psfs for the aperture magnitude measurements , we can only conclude that they are _ introduced _ into the psf magnitude measurements by the algorithms used to measure the psf magnitudes , and that the underlying cause is not a physical effect ( i.e. a non - uniform prf convolved with the object psf ) .",
    "we speculate that a possible explanation for the trends could be a slight mismatch between the psf model and the actual shape of the psf .",
    "the fact that , for the regime of under - sampled psfs , the exact form of the ipsms varies between different wavebands and camera columns hints that the deficiencies in the psf modelling depend on the exact psf shape , which is unique to each detector .    for psf magnitude measurements with psf fwhms that are greater than the critical sampling , we find that for all wavebands , the ipsms in fig .",
    "[ fig : maps_psf ] have the same smooth and approximately radially - symmetric form as the systematic trend detected for the aperture magnitudes in the @xmath52 waveband in section  [ sec : apermag3 ] . for each waveband ,",
    "the trends are very similar in form and amplitude between the six detectors and the normally - sampled and well - sampled psf regimes .",
    "therefore we have derived a single master ipsm for each waveband using all of the psf magnitude measurements over the six detectors that have corresponding psf fwhms greater than the critical sampling .",
    "we present these maps in fig .",
    "[ fig : radial_psf ] as the image panels along the top of the figure . in the same figure",
    ", we also plot the radial profiles of the master ipsms for each waveband .",
    "finally , we note that the form and amplitude of these ipsms are independent of right ascension , declination , detector coordinates , object brightness , and the number of neighbouring objects within 15 .",
    "the master ipsms displayed in fig .",
    "[ fig : radial_psf ] are very similar between wavebands with peak - to - peak amplitudes of @xmath01.55 , 1.61 , 1.68 , 1.57 , and 1.67  mmag for the @xmath66 wavebands , respectively .",
    "these amplitudes are approximately three times larger than the peak - to - peak amplitude of the same systematic trend detected for the @xmath52-waveband aperture magnitude measurements .",
    "again , we believe that this systematic trend is an effect introduced by the algorithms used to measure the psf magnitudes .      our idl program described in section  [ sec : apmagcorr ] ( ... weblink ... ) may also be used to correct a set of psf magnitude measurements of point sources from sdss dr8 .",
    "the program subtracts the appropriate fitted magnitude offsets @xmath10 corresponding to the systematic trends that we detected as a function of psf fwhm and object brightness in section  [ sec : psfmag2 ] from the psf magnitude measurements to be corrected .",
    "also , for each detector , we repeat the analysis from section  [ sec : psfmag3 ] to derive two ipsms , one for each of the regimes of psf fwhms less than and greater than the critical sampling . for each map",
    ", we force the mean of the magnitude offsets to be zero to minimise the effect on the absolute photometric calibration when they are applied .",
    "the program subtracts the appropriate magnitude offsets taken from these ipsms from the psf magnitude measurements to correct for the systematic trends that we detected as a function of subpixel coordinates in section  [ sec : psfmag3 ] . for the @xmath62 wavebands , we refrain from applying the magnitude offsets from the ipsms calculated for the regime of under - sampled psfs because these maps are very noisy due to the lack of appropriate data .",
    "in essence , the procedure for calibrating the psf magnitudes is the same as for the aperture magnitudes except for the inclusion of the extra correction for the systematic trends as a function of subpixel coordinates , which introduces a further 50 parameters into the model for the photometric data .",
    "however , the number of extra parameters introduced for our corrections to the psf magnitude measurements is still insignificant compared to the total number of free parameters .",
    "therefore , we follow a similar analysis to that of the aperture magnitudes with regards to the significance of our corrections to the repeat psf magnitude measurements , and in columns 5 and 6 of table  [ tab : dr8_data_repeat_psf ] , we tabulate the values of @xmath67 and @xmath68 for each detector .",
    "we conclude that our corrections to the repeat psf magnitude measurements are significant at the @xmath08 - 20@xmath60 , 35 - 132@xmath60 , 32 - 76@xmath60 , 28 - 68@xmath60 , and 9 - 21@xmath60 level for the @xmath66 wavebands , respectively .",
    "we also note that if we reproduce fig .",
    "[ fig : maps_psf ] using the corrected psf magnitude measurements , then the systematic trends as a function of psf fwhm and subpixel coordinates are not present any more , which confirms that applying the corrections has successfully calibrated the psf magnitudes to compensate for these particular systematic trends .    in fig .",
    "[ fig : hist_psf_corr ] we plot for each filter a histogram of the magnitude offsets ( mmag ) that we calculate for use in calibrating the psf magnitude measurements for the full set of selected observations from sdss dr8 in table  [ tab : dr8_data ] , combining the data for the six camera columns .",
    "again , we see that there are a significant number of corrections that have absolute values @xmath692  mmag and stretching up to @xmath08  mmag . as with the aperture magnitudes , these corrections are of the order of the quoted @xmath01% precision of the sdss dr8 photometric measurements , and we believe that the application of these corrections to the psf magnitude measurements will significantly improve the sdss dr8 photometric precision in all filters .",
    "in this section , we investigate how the sdss psf magnitude scale relates to the sdss aperture magnitude scale for the 7.43@xmath64 fixed aperture .",
    "this investigation is important because the photometric calibration parameters derived by pad08 are obtained by fitting the aperture magnitudes and the calibration is subsequently applied to the psf magnitudes .",
    "this is a valid procedure for the calibration of the psf magnitudes as long as they follow the same magnitude scale ( to within the addition of an arbitrary constant ) as the aperture magnitudes .",
    "any deviation of the psf magnitude scale from the aperture magnitude scale other than a simple offset renders the calibration parameters derived from the aperture magnitudes as incompatible with the psf magnitudes .",
    "consequently , in such a case , the application of the calibration parameters to the psf magnitudes will introduce undesirable systematic errors .",
    "we may use the selected observations from sdss dr8 in table  [ tab : dr8_data ] to compare the psf magnitude measurements to the aperture magnitude measurements .",
    "we analyse the photometric data for each detector independently .",
    "firstly , we drop the observations for which the sdss pipeline failed to measure an aperture flux .",
    "in addition , we restrict our sample of observations to those objects which have no neighbouring objects within 15 .",
    "we do this to avoid the inclusion of objects with aperture magnitude measurements that have been contaminated by the flux of nearby objects , which would lead to artificially bright aperture magnitude measurements for these objects when compared to the corresponding psf magnitude measurements .",
    "next , for each observation , we calculate the magnitude difference @xmath70 , where @xmath71 and @xmath72 are the measured aperture and psf magnitudes , respectively , calibrated using the procedures described in sections  [ sec : apmagcorr ]  &  [ sec : psfmagcorr ] .",
    "the uncertainty on @xmath73 is calculated as the square root of the sum in quadrature of the corresponding aperture and psf magnitude measurement uncertainties .",
    "we partition the @xmath73 values into three groups based on their corresponding psf fwhms ; namely , the under - sampled psfs with psf fwhms less than the critical sampling of 0.93 , the normally - sampled psfs with psf fwhms greater than the critical sampling but less than 1.5 , and the well - sampled psfs with psf fwhms greater than 1.5 .",
    "then , for each grouping , we assign the @xmath73 values to magnitude bins of width 0.2  mag using their corresponding psf magnitudes , and we calculate the inverse - variance weighted mean of the @xmath73 values in each bin . in fig .  [",
    "fig : scale_comp ] , for each detector , we plot these mean @xmath73 values as a function of psf magnitude using black , red , and green points for the regimes of under - sampled , normally - sampled , and well - sampled psfs , respectively . in each plot",
    ", the error bars represent the uncertainties in the mean @xmath73 values , and they are generally much smaller than the plot symbols ( @xmath00.03 - 0.2  mmag ) .",
    "we refrain from plotting mean @xmath73 values with uncertainties of greater than 5  mmag , and we mark mean @xmath73 values that fall outside of the plot range with an asterisk of the relevant colour .",
    "the plot panels are arranged in the same grid layout as in fig .",
    "[ fig : maps_psf ] .",
    "if the psf magnitude scale is the same as the aperture magnitude scale except for a difference in photometric zero - points , then , independent of object brightness , the expected value of @xmath73 is the zero - point difference , and the plots of the mean @xmath73 values as a function of object brightness will be horizontal straight lines with a @xmath74-axis value equal to the zero - point difference .",
    "however , the fact that _ all _ of the plots in fig .  [ fig : scale_comp ] show mean @xmath73 values that depend on the object brightness in a non - linear fashion ( i.e. they do not form horizontal or inclined straight lines ) indicates that the psf magnitude scale is related to the aperture magnitude scale by a non - linear transformation . as a further complication",
    ", we may also see in fig .",
    "[ fig : scale_comp ] that this non - linear transformation is psf fwhm dependent since the mean @xmath73 values show different behaviour for each of the regimes of under - sampled , normally - sampled , and well - sampled psfs .",
    "we observe that , for any single waveband and psf fwhm regime combination , the form and amplitude of the non - linear relation between the aperture and psf magnitude scales is very similar for all six detectors . for the @xmath1 wavebands ,",
    "the fainter an object is , the brighter the psf magnitude measurement is compared to the aperture magnitude measurement , where the difference between the two types of magnitude measurements can reach up to @xmath015 - 35  mmag for the faintest objects in our data set when observed under normal - seeing conditions . for the @xmath2 waveband",
    ", we detect the opposite effect ( except for camera column 2 ) with a difference of up to @xmath010 - 25  mmag between the aperture and psf magnitudes for the faintest objects in our data set when observed under normal - seeing conditions .",
    "we also note that for the @xmath2 waveband , the psf magnitudes are fainter than the aperture magnitudes by @xmath05 - 10  mmag , indicating that there is a zero - point difference between the two magnitude scales for this waveband . for the @xmath53 waveband ,",
    "the aperture and psf magnitude scales diverge rapidly for objects with brightnesses in the range 18 - 19  mag .",
    "also , for all wavebands , we find that the amplitude of the non - linearity in the relation between the aperture and psf magnitude scales is greater for larger psf fwhms .",
    "finally , we note that the erratic behaviour of the mean @xmath73 values at the bright - end for all wavebands is most likely a consequence of image saturation for the corresponding observations .",
    "we have tested that the detected non - linear relation between the aperture and psf magnitude scales is independent of right ascension , declination , detector coordinates , and subpixel coordinates by making similar plots to those displayed in fig .",
    "[ fig : scale_comp ] for various mutually - exclusive partitions of our photometric data .",
    "furthermore , the plots in fig .",
    "[ fig : scale_comp ] are only marginally affected if we do not calibrate the aperture and psf magnitudes using the procedures described in sections  [ sec : apmagcorr ]  &  [ sec : psfmagcorr ] .",
    "this is to be expected since , by necessity , our magnitude corrections are calculated independently of object brightness .",
    "it is important to understand that our analysis may only determine how the psf magnitude scale relates to the aperture magnitude scale . due to the fact that there is a non - linear relation between the aperture and psf magnitude scales",
    ", we may deduce that _ at least one _ of the scales must deviate from a pure asinh - magnitude scale .",
    "however , it is quite possible that _ both _ the aperture and psf magnitude scales actually deviate from a pure asinh - magnitude scale , and that the non - linear relation that we find between the magnitude scales simply indicates that they differ from each other in a non - linear fashion .",
    "one way to investigate if a magnitude scale actually deviates from a pure asinh - magnitude scale is to simulate a set of images containing objects of known magnitudes , and then to process these images with the sdss pipeline to extract the relevant magnitude measurements for comparison with the known magnitudes .",
    "we note that both the aperture and psf magnitude measurements that we have employed in this analysis have already been calibrated using the pad08 modelling scheme .",
    "however , the calibrations will not have affected the relation between the aperture and psf magnitude scales because , for each observation , the same calibration correction is applied to each type of magnitude measurement .",
    "we find that we can explain the main features of the non - linear relation between the aperture and psf magnitude scales as , yet again , a consequence of sky over - subtraction in the sdss images .",
    "the sdss pipeline performs psf photometry by scaling the image psf to each object on the sky - subtracted images without fitting a local background ( r.  lupton , private communication ) .",
    "hence , the main difference between the sdss aperture and psf photometry is the pixel weighting scheme that is used when measuring the flux of an object .",
    "aperture photometry weights all pixels equally within the aperture , whereas psf photometry weights the pixels in the aperture using the image psf , giving more weight to the image pixels that contain most of the object flux .",
    "hence , the effective number of pixels used in the psf photometry measurement is less than the effective number of pixels used in the aperture photometry measurement , and so we would expect that if the sky background is over - subtracted from the sdss images , then the psf photometry measurement will be brighter than the aperture photometry measurement . also , we have already seen in section  [ sec : apermag2 ] that the aperture magnitude measurements of fainter objects suffer from larger systematic errors due to incorrect sky - subtraction , and so we would expect the psf magnitudes to differ by a greater amount from the aperture magnitudes for fainter objects .",
    "these effects constitute the main features of the non - linear relation that we detect in fig .",
    "[ fig : scale_comp ] between the aperture and psf magnitude scales .",
    "we note that the sky over - subtraction hypothesis can not explain the psf fwhm dependence of the relation between the aperture and psf magnitude scales .",
    "as the psf fwhm increases , the psf photometry pixel - weighting scheme tends towards the aperture photometry pixel - weighting scheme , and therefore , in the case of sky over - subtraction , we would expect the difference between the aperture and psf magnitude measurements to decrease , which is the opposite of what we detect .",
    "we have investigated the systematic trends in the sdss dr8 photometric data , extending the internal consistency checks performed by pad08 on the aperture magnitude residuals from their photometric calibration model . from our analysis of the repeat observations in sdss dr8 , we have discovered a systematic trend in the aperture magnitudes that is a function of psf fwhm , the amplitude of which increases for fainter objects .",
    "this trend is present at the @xmath07 - 15  mmag and @xmath030 - 170  mmag level for the brightest ( near the saturation limit ) and faintest ( 19  mag ) objects that we analysed , respectively , with the @xmath53 waveband exhibiting the strongest trend .",
    "we have also detected a low - amplitude ( @xmath00.54  mmag ) systematic trend in the @xmath52-waveband aperture magnitudes that is a function of subpixel coordinates .",
    "for the sdss psf magnitudes , we have discovered complicated systematic trends that are a function of psf fwhm , object brightness , and subpixel coordinates .",
    "the trends that are a function of psf fwhm and object brightness are present at the @xmath010 - 20  mmag and @xmath020 - 50  mmag level for psf fwhms that are less than @xmath02.5@xmath64 and greater than @xmath02.5 , respectively .",
    "again , it is the @xmath53-waveband psf magnitudes that exhibit the strongest trends as a function of psf fwhm and object brightness .",
    "the systematic trends in the psf magnitudes that are a function of subpixel coordinates are clearly detected in all wavebands at the @xmath01.6  mmag level for psf fwhms greater than the critical sampling ( 0.93 ) , and in the @xmath65 wavebands at the @xmath04 - 7  mmag level for psf fwhms less than the critical sampling . in the @xmath62 wavebands",
    ", we can not discern these trends as a function of subpixel coordinates for the regime of under - sampled psfs due to the lack of appropriate data .    to address the problem of these systematic trends ,",
    "we have described a method for self - calibration of the sdss photometric data which successfully removes the trends , and we provide an idl program which can be used to calibrate a set of aperture and/or psf magnitude measurements of point sources from sdss dr8 .",
    "however , it would be better to eliminate these trends by identifying the algorithm(s ) in the sdss pipeline that introduce them , and then improving the relevant algorithm(s ) appropriately .",
    "another way to avoid the need for a post - processing self - calibration is to include a set of appropriate terms in the pad08 modelling scheme .",
    "we hypothesise that the sky over - subtraction problem discussed by aih11 is the main cause of the detected systematic trend in the aperture magnitudes as a function of psf fwhm and object brightness , although there may also be some contribution to the trend from aperture flux losses . with regards to the complicated systematic trends that we have found in the psf magnitudes as a function of psf fwhm and object brightness",
    ", we do not speculate on exactly what is causing them because we do not have access to sufficient information on the details of the psf photometry routines in the sdss pipeline .",
    "having studied the basic descriptions of these routines in @xcite and @xcite , we flag the following procedures as potentially containing algorithms that introduce the detected systematic trends into the psf magnitudes :    * the psf model adopted for each image including the model for the spatially variable terms .",
    "* the procedure for fitting the psf model to each object in order to measure the psf flux , which includes sinc - resampling of the image pixel data for the objects .",
    "* the procedure for determining the aperture correction that is applied to the psf magnitude measurements .",
    "the systematic trends in the psf magnitudes as a function of subpixel coordinates for the regime of under - sampled psfs are also most likely caused by some aspect(s ) of the above procedures , and , specifically , we suspect that they are due to a slight mismatch between the psf model and the actual shape of the image psf .",
    "we are unable to offer an explanation for the unexpected systematic trend as a function of subpixel coordinates for normally - sampled and well - sampled psfs that is present at the same amplitude in all wavebands for the psf magnitudes , and which is detected in the @xmath52 waveband for the aperture magnitudes .",
    "we also found that the sdss aperture and psf magnitude scales are related by a non - linear transformation that departs from linearity by @xmath01 - 4% , implying that at least one of the scales departs from a pure asinh - magnitude scale .",
    "furthermore , this discovery invalidates to some extent the application of the pad08 calibrations to the psf magnitudes , since the calibration model parameters are derived from fitting the aperture magnitudes . to avoid the problems introduced by the non - linear relation between the magnitude scales",
    ", it would be necessary to either transform the aperture magnitudes to the psf magnitude scale before performing the calibration model fit , or to transform the psf magnitudes to the aperture magnitude scale before applying the photometric calibrations derived from the aperture magnitudes , or , better still , to simply identify and remedy the cause of the non - linear relation in the first place .",
    "we have argued that the main cause of the non - linear relation between the magnitude scales is most likely yet another consequence of sky over - subtraction in the sdss images .",
    "finally , we report the detection of a @xmath00.5 - 1% zero - point difference between the aperture and psf magnitude scales for the @xmath2 waveband .",
    "our results indicate that there is still room for improvement in the relative photometric calibration of the sdss photometric data .",
    "pad08 report that they detect systematic trends in the residuals of the sdss aperture magnitudes for the pad08 model `` at the @xmath00.5% level '' .",
    "they also perform simulations of the data that include random walks in time of the atmospheric extinction coefficients to simulate temporal atmospheric variations , and they fit the simulated data with the photometric calibration model to see if they can reproduce the systematic errors at the @xmath00.5% level that they have detected in the real data .",
    "pad08 find that their simulations produce systematic trends at the level of @xmath013 , 8 , 8 , 7 , and 8  mmag in the @xmath66 wavebands , respectively , and therefore , they hypothesise that it is the unmodelled temporal atmospheric variations in the pad08 modelling scheme that are the cause of the remaining systematic trends in the sdss photometry . however , the results from their simulations depend heavily on the assumptions about the temporal atmospheric variations .",
    "we have shown , in contrast , that there are still systematic trends not related to temporal atmospheric variations in the sdss photometry at the 0.5% level and above for both the aperture and psf magnitudes .",
    "hence , it is possible to further improve the precision of the relative calibration of the sdss photometric data , which , if implemented , will be of great benefit to the astronomical community .",
    "the sdss photometry is now routinely used to calibrate other photometric data , including other large scale surveys ( e.g. @xcite , @xcite , etc . ) . specifically for this purpose ,",
    "@xcite have produced a standard star catalogue for stripe 82 based on the sdss repeat observations .",
    "therefore , the correction of the systematic trends and magnitude scale non - linearities that we have found in order to produce the most precise sdss photometric data is crucial .    finally , all of the issues that we have highlighted with the sdss photometry are likely be relevant to other upcoming surveys ( e.g. panstarrs - @xcite , des - @xcite , lsst - @xcite , etc . ) in their analysis of the photometric precision that they achieve .",
    "our paper emphasises the fact that the relative calibration of the well - established sdss photometry could still be improved further for little effort , and that a thorough investigation and understanding of the systematic trends that are present in the photometry is very important when constructing a photometric calibration model so as to include all of the relevant terms .",
    "dmb dedicates this work to those close friends who sadly passed away before their time : nick holliday - school form teacher and inspiration , and gins ramrez alemn - full of fun and life .",
    "dmb and wf also dedicate this work to a close collaborator and dear friend who also passed away recently , carlo izzo .    this research has made extensive use of the danidl library of routines ( http://www.danidl.co.uk ) .",
    "we would like to thank the sdss helpdesk , especially ani thakar , for supplying sufficient space for the large casjobs queries that we submitted .",
    "lodovico coccato kindly tested in depth the program fit_photometric_calibration.pro and its sub - modules .",
    "funding for sdss - iii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , and the u.s .",
    "department of energy office of science .",
    "the sdss - iii web site is http://www.sdss3.org/ where information on the participating institutions may be found ."
  ],
  "abstract_text": [
    "<S> we investigate the sloan digital sky survey ( sdss ) photometry from data release 8 ( dr8 ) in the search for systematic trends that still exist after the calibration effort of padmanabhan et al . </S>",
    "<S> we consider both the aperture and point - spread function ( psf ) magnitudes in dr8 . </S>",
    "<S> using the objects with repeat observations , we find that a large proportion of the aperture magnitudes suffer a @xmath00.2 - 2% systematic trend as a function of psf full - width half - maximum ( fwhm ) , the amplitude of which increases for fainter objects . </S>",
    "<S> analysis of the psf magnitudes reveals more complicated systematic trends of similar amplitude as a function of psf fwhm and object brightness . </S>",
    "<S> we suspect that sky over - subtraction is the cause of the largest amplitude trends as a function of psf fwhm . </S>",
    "<S> we also detect systematic trends as a function of subpixel coordinates for the psf magnitudes with peak - to - peak amplitudes of @xmath01.6  mmag and @xmath04 - 7  mmag for the over- and under - sampled images , respectively . </S>",
    "<S> we note that the systematic trends are similar in amplitude to the reported @xmath01% and @xmath02% precision of the sdss photometry in the @xmath1 and @xmath2 wavebands , respectively , and therefore their correction has the potential to substantially improve the sdss photometric precision . </S>",
    "<S> we provide an idl program specifically for this purpose . </S>",
    "<S> finally , we note that the sdss aperture and psf magnitude scales are related by a non - linear transformation that departs from linearity by @xmath01 - 4% , which , without correction , invalidates the application of a photometric calibration model derived from the aperture magnitudes to the psf magnitudes , as has been done for sdss dr8 .    </S>",
    "<S> [ firstpage ]    instrumentation : detectors - techniques : photometric - surveys . </S>"
  ]
}