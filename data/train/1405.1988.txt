{
  "article_text": [
    "since the rational points of an algebraic variety over a global field satisfy the brauer - manin conditions , it is natural to ask whether , conversely , these conditions determine the rational points .",
    "there is some recent progress for projective curves and abelian varieties ( @xcite , see also @xcite ) . on the other hands , colliot - thlne and the second named author introduced in @xcite the study of integral points for homogeneous spaces of linear algebraic groups in relation with strong approximation properties .",
    "afterward , harari and voloch @xcite considered the integral points on hyperbolic curves satisfying some brauer - manin conditions .",
    "in particular they conjectured that these conditions determine the integral points of rational hyperbolic curves . in the present paper ,",
    "the main purpose is first to pursuit the study of integral points and strong approximation properties for general algebraic varieties with focus on subvarieties of torus .",
    "secondly , we solve harari - voloch conjecture for global function fields .",
    "now let us fix some notation and give some definition .",
    "let @xmath0 be a global field , @xmath3 be the set of all primes in @xmath0 , @xmath4 be the set of all archimedean primes of @xmath0 ( @xmath5 if @xmath0 is a function field ) .",
    "we will denote by @xmath6 the ring of @xmath7-integers for a _ non - empty _ finite subset @xmath7 of @xmath3 containing @xmath4 .",
    "if @xmath0 is a number field , we denote by @xmath8 the ring of integers of @xmath0 . for each finite prime @xmath9",
    ", @xmath10 denotes the discrete valuation ring of @xmath0 associated to @xmath11 , @xmath12 its completion , @xmath13 .",
    "if @xmath14 , we put @xmath15 .",
    "let @xmath16 be the adelic ring of @xmath0 .",
    "we denote by @xmath17 the @xmath7-adeles obtained by projecting @xmath16 to @xmath18 endowed with the induced adelic topology and have @xmath19 for any finite subset @xmath7 of @xmath3 containing @xmath4 .    an _ algebraic variety over @xmath0",
    "_ will be a separated scheme of finite type over @xmath0 .",
    "let @xmath20 be an algebraic variety . for all @xmath21",
    ", @xmath22 is endowed with the topology induced by the topology of @xmath23 .",
    "the set of adelic points @xmath24 can be canonically endowed with a locally compact hausdorff topology ( @xcite ,  4 ) .",
    "when @xmath20 is affine , @xmath25 is a closed subvariety of an affine space .",
    "then the adelic topology of @xmath26 is induced by the product of usual adelic topology under the closed immersion .",
    "let @xmath27 for any @xmath28 , one has @xmath29 for almost all @xmath9 ( see @xcite  5.2 ) , where @xmath30 is the local invariant map . for any subgroup @xmath31 of @xmath32 ,",
    "define @xmath33 the artin reciprocity law implies that @xmath34 for each @xmath35 , @xmath36 is locally constant , hence continuous , on @xmath22 .",
    "this implies that @xmath37 is a closed subset of @xmath26 .",
    "part of the following definition is taken from @xcite , definition 2.1 .",
    "[ def - bm ]",
    "let @xmath7 be a finite subset of @xmath3 and let @xmath38 be the projection map .",
    "we will say that _ the strong approximation property with brauer - manin obstruction off @xmath7 holds for @xmath20 _ or that _ @xmath20 satisfies the strong approximation property with brauer - manin obstruction off @xmath7 _ ( sap - bm off @xmath7 for short ) if @xmath39 , under the diagonal map , is dense in @xmath40 $ ] with adelic topology .",
    "we will say that _ the very strong approximation property with brauer - manin obstruction off @xmath7 holds for @xmath20 _ or that _ @xmath20 satisfies the very strong approximation property with brauer - manin obstruction off @xmath7 _ ( abbreviated to vsap - bm off @xmath7 ) if @xmath41.\\ ] ]    in the classical strong approximation examples ( _ e.g. _ , affine spaces and simply connected semi - simple linear algebraic groups ) , the brauer groups are always constant ( _ i.e. _ , the canonical map @xmath42 is surjective ) and @xmath43 .",
    "so the above definition extends the classical situations .",
    "the first main result of this work deals with vsap - bm and can be regarded as an analogue of theorem d in @xcite for tori .",
    "( corollary  [ reb ] ) let @xmath20 be a subvariety of a torus @xmath1 over a global field @xmath0",
    ". then @xmath20 satisfies vsap - bm off @xmath7 for any finite subset @xmath7 of @xmath3 containing @xmath4 if one of the following conditions is satisfied :    1 .",
    "@xmath0 is a global function field ( then @xmath5 ) ; 2 .   @xmath2 or an imaginary quadratic field and @xmath1",
    "is split over @xmath0 .    for general algebraic varieties",
    ", we have the following result .",
    "( corollary  [ rev ] ) any algebraic variety over @xmath44 or an imaginary quadratic field always contains an dense open subvariety which satisfies vsap - bm off @xmath7 for any finite subset @xmath7 of @xmath3 containing @xmath4 .    as an application , we prove harari - voloch s conjecture over a global function field by using @xcite , theorem 1 .",
    "[ m](corollary [ true ] ) let @xmath0 be a global function field and @xmath20 be an open subset of @xmath45 with complementary of degree @xmath46 as a reduced separable divisor .",
    "then @xmath47 where @xmath48\\ ] ] for any finite subset @xmath7 of @xmath3 .",
    "we prove that the same result is also true over @xmath44 when @xmath49 and @xmath50 contains more than a single point in corollary  [ hv - ex2 ] .",
    "the next theorem can be regarded as an analogue for tori of @xcite , theorem 3.11 .",
    "after this paper was written , we learned that c .- l .",
    "sun proved an equivalent statement ( @xcite , theorem 1 ) by a slightly different method .",
    "( theorem [ inters ] ) if @xmath51 is a finite subscheme of a torus @xmath1 over a number field @xmath0 , then for any finite subset @xmath7 of @xmath3 containing @xmath4 , we have @xmath52 where @xmath53 is the topological closure of @xmath54 inside @xmath55 .    note that if this result is true for any curve contained in @xmath1 , then harari - voloch conjecture holds over number fields ( proposition  [ eqhv ] ( 1 ) ) .",
    "as an application of the above theorem , we prove in proposition  [ quasi - finite ] that if @xmath56 is a quasi - finite morphism of rational hyperbolic curves and if harari - voloch conjecture is true for @xmath57 , then it is true for @xmath20 .",
    "let @xmath58 and @xmath20 be as in   [ intro ] .",
    "the aim of this section is first to show that the subsets of @xmath59 of the form @xmath60 , when @xmath61 runs through the integral models of @xmath20 over @xmath6 , form a topology basis for @xmath62 ( corollary  [ u - model ] ) .",
    "then we apply this result to relate strong approximation of adelic points to that of integral points ( theorem  [ diophantine - sap ] ) .",
    "we start with some basic definitions and technical preliminary results .",
    "let @xmath7 be a non - empty finite subset of @xmath3 containing @xmath4 .",
    "an _ integral model ( or a model ) of @xmath20 _ over @xmath6 is a scheme @xmath61 faithfully flat of finite type and separated over @xmath6 endowed with an isomorphism @xmath63 over @xmath0 .",
    "an _ integral point on @xmath61 _ is a section @xmath64 .",
    "define @xmath65 .",
    "then @xmath66 and it is known that the canonical map @xmath67 is a bijection ( @xcite , theorem 3.6 , where @xmath68 is our @xmath12 ) . by artin reciprocity law , a necessary condition for @xmath69 is @xmath70 when @xmath71 is constant , the above condition is equivalent to the classical local - global ( hasse ) principle .",
    "if the condition ( [ bm ] ) is also sufficient to insure that @xmath69 , we say _ the brauer - manin obstruction is the only obstruction _ for the existence of integral points on @xmath61 .",
    "we will use the following gluing process several times .",
    "[ gluing ] let @xmath72 and @xmath73 .",
    "suppose we are given separated schemes of finite type @xmath74 over @xmath75 , @xmath76 over @xmath77 and isomorphisms @xmath78 .",
    "then there exists a unique ( up to isomorphisms ) separated scheme of finite type @xmath61 over @xmath6 such that @xmath79 and @xmath80 .    if @xmath74 , @xmath81 are group schemes and if the @xmath82 are isomorphisms of group schemes , then @xmath61 is a group scheme over @xmath6",
    ".    let @xmath83 . then @xmath84",
    ". there are open neighborhoods @xmath85 such that @xmath76 and @xmath82 extend to @xmath86 and the identity @xmath84 holds on @xmath87 .",
    "we can then use the usual gluing process to construct @xmath61 .",
    "the separatedness of @xmath61 comes from that of @xmath88 and of @xmath89 .",
    "the assertion on the structure of group scheme is straightforward .",
    "let @xmath74 be an @xmath6-scheme of finite type , not necessarily flat , with generic fiber isomorphic to @xmath25 .",
    "let @xmath61 be the biggest flat closed subscheme of @xmath74 ( defined by the sheaf of ideals of @xmath6-torsion elements of @xmath90 or , equivalently , @xmath61 is the scheme - theoretic closure in @xmath74 of the generic fiber of @xmath74 ) .",
    "then for any flat @xmath6-scheme @xmath91 , the canonical map @xmath92 is bijective .",
    "so for the questions we deal with in this paper , it is harmless to restrict ourselves to flat models . on the other hand , for a model @xmath61 to have local sections in @xmath93 for all @xmath94 ,",
    "it is necessary that @xmath61 be faithfully flat over @xmath6 .",
    "let @xmath95 be a dedekind domain with field of fractions @xmath96 .",
    "let @xmath97 be an algebraic variety over @xmath96 .",
    "then @xmath97 has a model @xmath61 over @xmath95 .",
    "moreover there exists a such @xmath61 which is proper ( resp .",
    "projective ) over @xmath95 if @xmath97 is proper ( resp .",
    "projective ) over @xmath96 .",
    "the case when @xmath97 is projective is immediate : embed @xmath97 into a projective space @xmath98 and take the scheme - theoretic closure @xmath61 of @xmath97 in @xmath99 . as @xmath61 is proper and flat over @xmath95 ,",
    "it is faithfully flat .",
    "now suppose @xmath97 is affine .",
    "note that if we extend directly to @xmath95 by scaling a system of equations defining @xmath97 and take the biggest closed subscheme flat over @xmath95 , we just get a flat , but not necessarily faithfully flat scheme over @xmath95 .",
    "let @xmath100 be a projective variety containing @xmath97 as a dense open subvariety .",
    "consider the scheme - theoretic closure @xmath74 of @xmath101 in @xmath99 and @xmath102 the scheme - theoretic closure of @xmath103 in @xmath74 .",
    "then @xmath104 is flat , separated and finite type over @xmath95 , with generic fiber equal to @xmath97 .",
    "let us show @xmath61 is faithfully flat .",
    "as @xmath105 are flat and proper over @xmath95 , they are faithfully flat and @xmath106 therefore @xmath107 and @xmath61 is faithfully flat .    in the general case , as @xmath97 is separated and of finite type over @xmath96",
    ", it extends to a separated scheme @xmath108 of finite type and faithful flat over some open subset @xmath109 ( @xcite , iv.8.8.2(ii ) ) .",
    "let @xmath110 be a non - empty affine open subset of @xmath97 .",
    "by the affine case , there exists a faithfully flat model @xmath111 of @xmath110 over @xmath95 .",
    "shrinking @xmath75 if necessary , we can suppose @xmath112 extends to an open immersion @xmath113 .",
    "let @xmath61 be the gluing of @xmath108 and @xmath114 along @xmath115 .",
    "then @xmath61 is a model of @xmath97 over @xmath95 .",
    "suppose @xmath97 is proper .",
    "the model @xmath61 we obtained above is not proper in general .",
    "but by nagata s embedding theorem ( @xcite , @xcite ) , @xmath61 is an open subscheme of some proper scheme @xmath116 over @xmath95 .",
    "as @xmath61 is flat , it is contained in the scheme - theoretic closure @xmath117 of @xmath20 in @xmath116 .",
    "now @xmath117 is a proper model of @xmath61 ( it is faithfully flat over @xmath95 by properness ) .",
    "[ smoothening ] suppose @xmath20 is smooth . to study the integral points of @xmath20 over @xmath6 when @xmath20 has local points at every @xmath94 , we can restrict ourselves to smooth models in the sense that for any integral model @xmath61 such that @xmath118 for all @xmath119 , there exists a quasi - projective morphism @xmath120 of models of @xmath20 such that @xmath121 is smooth and the canonical maps @xmath122 and @xmath123 , @xmath94 , are bijective .",
    "indeed , @xmath61 is already smooth over some dense open subset @xmath75 of @xmath124 . by the gluing process [ gluing ] ,",
    "we are reduced to the local case .",
    "then the result follows from the smoothening procedure , see @xcite , theorems 3.1/3 : if @xmath125 is a smoothening , then take @xmath121 equal to the smooth locus of @xmath126 .",
    "note that for any closed point @xmath127 , we have @xmath128 because the smoothening commutes with base changes of index @xmath129 ( see @xcite , corollary 3.6/6 ) .",
    "in particular @xmath130 and @xmath121 is faithfully flat over @xmath131 . as a counterpart ,",
    "if we start with a proper model @xmath61 , the smoothening will produce a non - proper smooth model in general .",
    "if @xmath20 is furthermore a smooth algebraic group and the model @xmath61 is a ( separated ) group scheme , then @xmath121 can be chosen to be a smooth group scheme .",
    "this is a consequence of the existence of group smoothening as shown in @xcite , 7.1/5 .",
    "the existence over a global dedekind base scheme follows from the local case by the gluing process as above .",
    "we also have @xmath132 for all closed points @xmath11 because the group smoothening is obtained by successive dilatations and the latter operations commute with the passage to the completion .",
    "[ section - lg ] let @xmath61 be an integral model of @xmath20 over @xmath6 . then the canonical commutative diagram of injective maps @xmath133 allows us to identify @xmath134 with @xmath135 .",
    "let @xmath136 such that @xmath137 in @xmath22 for all @xmath138 .",
    "then @xmath139 for all @xmath138 .",
    "moreover @xmath140 extends to a @xmath141 for some open neighborhood @xmath142 of @xmath143 for all @xmath144 .",
    "one concludes that @xmath145 by gluing these morphisms .",
    "let @xmath146 be an integral domain containing @xmath6 , with field of fractions @xmath147 .",
    "let @xmath61 be an integral model of @xmath20 over @xmath6 .",
    "the base change @xmath148 induces canonically a map @xmath149 ( depending on the isomorphism @xmath150 ) which is injective because @xmath61 is separated over @xmath6 . for simplicity , we will consider @xmath151 as a subset of @xmath152 . by lemma",
    "[ section - lg ] , @xmath134 can be identified to @xmath135 .",
    "next we relate the analytic open subsets to integral points of models .",
    "[ integral - u]let @xmath95 be a discrete valuation ring with field of fractions @xmath96 .",
    "let @xmath153 be its completion and @xmath154 .",
    "let @xmath97 be an algebraic variety over @xmath96 , let @xmath155 and let @xmath156 be an open neighborhood of @xmath157 for the topology induced by that of @xmath158 .",
    "then there exists an integral model @xmath61 of @xmath97 over @xmath95 such that @xmath159 .",
    "first let us prove that if @xmath160 is a model of @xmath97 over @xmath95 such that @xmath161 , then there exists a finite sequence of dilatations ( @xcite ,  3.2 ) @xmath162 such that @xmath163 .",
    "let @xmath164 be the specialization of @xmath157 ( _ i.e. _ the image of the closed point of @xmath165 by @xmath166 ) .",
    "consider @xmath167 the dilatation of @xmath168 on @xmath160 ( see @xcite ,  3.2 ) . by the universal property of the dilatation , the image of the ( injective ) canonical map @xmath169 consists of the points of @xmath170 whose specializations in @xmath171 are equal to @xmath172 .",
    "in particular , @xmath173 . we define inductively a sequence @xmath174 of dilatation of @xmath175 on @xmath176 , where @xmath177 is the specialization of @xmath178 .",
    "let us show that @xmath163 when @xmath179 is big enough .",
    "as the dilatation commutes with flat base change ( @xcite , 3.2/2(b ) ) , we can suppose @xmath95 is complete .    by construction , for any closed subscheme @xmath180 of @xmath181 and for any open subscheme @xmath182 of @xmath176 ,",
    "the dilatation of @xmath183 on @xmath182 is the restriction to @xmath182 of the dilatation @xmath174 .",
    "so we can suppose @xmath160 , and hence @xmath97 , are affine .",
    "we have a closed immersion @xmath184 $ ] such that @xmath185 is the origin @xmath186 .",
    "let @xmath187 be a uniformizing element of @xmath95 .",
    "for any integer @xmath188 , let @xmath189 .",
    "then by the definition of the topology on @xmath190 , there exists @xmath191 such that @xmath192 .    by the construction of the dilatation ( @xcite , 3.2/2(b ) )",
    ", @xmath193 induces a closed immersion @xmath194\\ ] ] and @xmath195    now to prove the proposition , it is enough to find a model @xmath160 of @xmath97 over @xmath95 such that @xmath161 .",
    "let @xmath196 be an affine zariski open neighborhood of @xmath155 .",
    "then @xmath197 extends to an affine model @xmath182 .",
    "up to scaling a system of coordinates on @xmath197 , we can suppose that @xmath198 .",
    "now we can glue @xmath97 and @xmath199 along @xmath197 to get an integral model @xmath160 of @xmath97 over @xmath95 with @xmath161 .",
    "[ u - model ] let @xmath20 be an algebraic variety over @xmath0 .",
    "let @xmath200 be an open subset and let @xmath201 .",
    "then there exists an integral model @xmath61 of @xmath20 over @xmath6 such that @xmath202 in other words , the subsets @xmath203 , where @xmath61 runs through the integral models of @xmath20 over @xmath6 , form a basis of the topological space @xmath62 .",
    "moreover , if @xmath20 is a ( smooth ) algebraic group over @xmath0 , then the subsets of the form @xmath60 , where @xmath61 is a ( smooth ) group scheme model of @xmath20 over @xmath6 , form a fundamental system of neighborhood of @xmath129 .    by the definition of the adelic topology ( @xcite ,  4 )",
    ", there exists an integral model @xmath74 of @xmath20 over @xmath204 for some finite subset @xmath205 of @xmath3 such that @xmath206 for some non - empty open subsets @xmath207 of @xmath22 .",
    "write @xmath208 . for any @xmath209",
    ", there exists an integral model @xmath210 of @xmath20 over @xmath10 such that @xmath211 by proposition  [ integral - u](1 ) . using lemma  [ gluing ]",
    ", we obtain an integral model @xmath61 of @xmath20 over @xmath6 as required by gluing the schemes @xmath212 , @xmath209 with @xmath213 .",
    "the case of algebraic groups is proved in a similar way using dilatations along the unit section , see remark  [ smoothening ] .",
    "now we can give a diophantine interpretation of strong approximation .",
    "[ diophantine - sap ] let @xmath20 be an algebraic variety over @xmath0 and let @xmath7 be a non - empty finite subset of @xmath3 containing @xmath4",
    ". then @xmath20 satisfies sap - bm off @xmath7 if and only if the brauer - manin obstruction is the only obstruction for the existence of integral points for every integral model @xmath61 of @xmath20 over @xmath6 .",
    "( @xmath214 ) let @xmath61 be an integral model of @xmath20 over @xmath6 and suppose that @xmath215 this set being open ( with respect to the adelic topology ) in @xmath216 , we have @xmath217   \\neq \\emptyset\\ ] ] by hypothesis on @xmath20 . hence the brauer - manin obstruction is the only obstruction for the existence of integral points on @xmath61 .",
    "( @xmath218 ) let @xmath219 be an open subset of @xmath220 such that @xmath221 let @xmath222 be a point of this set . by corollary  [ u - model ]",
    ", there exists an integral model @xmath61 over @xmath6 such that @xmath223 this implies that @xmath224 by the hypothesis , one obtains that @xmath225 .",
    "as the natural map @xmath226 has image in @xmath227 and @xmath228 , one concludes that @xmath219 meets the image of @xmath229 in @xmath230 and the theorem is proved .",
    "[ bijective ] vsap - bm off @xmath7 holds for @xmath20 if and only if the diagonal map @xmath231\\ ] ] is bijective for every model @xmath61 of @xmath20 over @xmath6 .",
    "( @xmath214 ) we only have to show that the diagonal map is surjective .",
    "let @xmath232 then there exists @xmath136 such that for all @xmath94 , @xmath233 where @xmath10 is the local ring of @xmath0 at @xmath11 . hence @xmath234 and @xmath235 under the diagonal map .",
    "( @xmath218 ) this follows from corollary [ u - model ] .",
    "a smooth curve @xmath20 is called hyperbolic if it is the complement of a reduced separable effective divisor of degree @xmath236 on a projective curve of genus @xmath237 such that @xmath238 . by siegel",
    "s theorem for integral points and faltings theorem on mordell s conjecture , @xmath134 is finite for any integral model @xmath61 of @xmath20 over @xmath6 . if @xmath20 satisfies sap - bm off @xmath7 ( definition  [ def - bm ] ) , then the diagonal map @xmath239\\ ] ] is bijective for any integral model @xmath61 of @xmath20 over @xmath6 . by corollary  [ bijective ] , @xmath20 satisfies the vsap - bm off @xmath7 .",
    "however , harari and voloch gave an explicit example at the end of @xcite to explain that the strong approximation property with brauer - manin obstruction does not hold in general .",
    "let us first prove some general properties regarding the very strong approximation property . recall that an immersion is a closed immersion followed by an open immersion ( @xcite , i.4.2.1 ) .",
    "[ bm - vsap - im ] let @xmath56 be an immersion of algebraic varieties over a global field @xmath0 .",
    "suppose that vsap - bm off @xmath7 holds for @xmath57 , then the same holds for @xmath20 .",
    "we have the following commutative diagram @xmath240   @ > > > p_s [ y_f(\\mathbb a_f)^{\\operatorname{br}(y_f ) } ] \\subseteq y_f(\\mathbb a_f^s ) \\\\ \\end{cd}\\ ] ] where the horizontal arrows are injective ( the last two ones are injective because @xmath241 and @xmath242 are injective ) . here",
    "we use the hypothesis that @xmath243 is an immersion ( or at least universally injective ) . moreover ,",
    "if we consider @xmath244 and @xmath62 as subsets of @xmath245 , then @xmath246 .",
    "indeed , let @xmath247 be such that @xmath248 in @xmath249 with @xmath250 for all @xmath94 .",
    "fix a @xmath251 , then @xmath252 .",
    "so @xmath253 . in a more algebraic setting",
    ", we are saying that some @xmath0-algebra homomorphism @xmath254 fits into a commutative diagram @xmath255 where the left vertical arrow is surjective ( here we use the hypothesis @xmath243 is an immersion ) .",
    "so the bottom arrow takes values in @xmath0 and @xmath256 .",
    "this implies immediately the proposition .",
    "[ bm - vsap - prod ] let @xmath257 be algebraic varieties over a global field @xmath0 such that @xmath258 .",
    "then @xmath259 satisfies sap - bm ( resp .",
    "vsap - bm ) off s if and only if the same holds for both @xmath20 and @xmath57 .    by functoriality ,",
    "the projections to @xmath20 and @xmath57 induce a continuous map @xmath260 which is injective as both sides are subsets of @xmath261 .",
    "they both contain @xmath262 .",
    "the same holds when we project to @xmath263 .",
    "so if @xmath20 and @xmath57 satisfy vsap - bm off @xmath7 , then so does @xmath259 .",
    "suppose @xmath257 satisfy sap - bm off @xmath7 .",
    "as @xmath264 is canonically homeomorphic to the product @xmath261 , any non - empty open subset of @xmath265 $ ] is the trace of some @xmath266 with @xmath267 respective open subsets of @xmath62 and @xmath245 such that @xmath268 and @xmath269 are non - empty .",
    "thus we find rational points @xmath270 and @xmath271 , therefore @xmath272 and @xmath259 satisfies sap - bm off @xmath7 .",
    "now we notice that a rational point @xmath273 gives rise to a closed immersion @xmath274 by base change .",
    "thus @xmath20 ( and similarly , @xmath57 ) satisfies vsap - bm off @xmath7 if @xmath259 does ( proposition  [ bm - vsap - im ] ) .",
    "suppose now that @xmath259 satisfies sap - bm off @xmath7 .",
    "let @xmath219 be a non - empty subset of @xmath275 $ ] .",
    "the intersection @xmath276\\cap",
    "p_s[(x_f\\times_f y_f)(\\a_f)^{\\operatorname{br}(x_f\\times_f y_f)}]\\ ] ] is non - empty as it contains @xmath277 , thus contains a point @xmath278 . by construction , @xmath279 , and @xmath20 satisfies sap - bm off @xmath7 .",
    "note that for projective smooth and geometrically integral varieties , skorobogatov and zarhin proved a stronger result ( @xcite , theorem c ) than proposition [ bm - vsap - prod ] .    the simplest class for which the very strong approximation property with brauer - manin obstruction holds are zero - dimensional schemes over @xmath0 .",
    "let @xmath280 be the set of the complex places of @xmath0 if @xmath0 is a number field and @xmath281 otherwise .",
    "if @xmath282 is a disjoint union of two open subschemes , then @xmath283=p_{\\xi}[x_1(\\mathbb a_f)^{\\operatorname{br}(x_1)}]\\coprod p_{\\xi}[x_2(\\mathbb a_f)^{\\operatorname{br}(x_2)}].\\ ] ] in particular , if @xmath20 is finite , then @xmath20 satisfies the very strong approximation property with brauer - manin obstruction off any finite set containing @xmath280 .",
    "if there is @xmath284\\ ] ] with @xmath285 such that @xmath286 and @xmath287 , then one can choose @xmath288 and @xmath289 satisfying @xmath290 by the artin reciprocity law @xmath291 ( see @xcite , viii , ( 8.1.17 ) ) .",
    "let @xmath292 be the images of @xmath293 under the canonical map @xmath294 for @xmath295",
    ". then @xmath296 and @xmath297 by the artin reciprocity law as above .",
    "a contradiction is derived and the first part of the proposition is proved .",
    "now suppose that @xmath20 is finite . by the above result",
    ", we can suppose @xmath20 is local .",
    "by @xcite , cor .",
    "6.2 , we can further suppose that @xmath20 is reduced , hence is the spectrum of some finite field extension @xmath147 of @xmath0 .",
    "by chebotarev density theorem , if @xmath298 , then @xmath299 , in which case @xmath300 and the result follows .",
    "note that a similar decomposition result can be found in @xcite , proposition  5.1.1 .",
    "let @xmath1 be a torus over a global field @xmath0 .",
    "let @xmath301 be the group of characters of @xmath1 .",
    "a point @xmath302 induces an evaluation homomorphism @xmath303 where @xmath304 runs over all finite separable subextensions of @xmath305 , thus a group homomorphism @xmath306 ( @xcite , viii , ( 8.1.7 ) ) .",
    "this gives a pairing @xmath307 and induces a homomorphism @xmath308 this pairing is compatible with the brauer - manin pairing .",
    "indeed , one has the canonical inclusion @xmath309 by hochschild - serre spectral sequence ( see @xcite , iii , theorem 2.20 ) with @xmath310 .",
    "this inclusion commutes with the evaluation @xmath311 for any @xmath302 .    for any topological group @xmath312 , denote by @xmath313 the completion of @xmath312 with respect to open finite index subgroups .",
    "[ tori ] let @xmath1 be a torus over a global function field @xmath0 .",
    "then we have canonical exact sequences @xmath314 and @xmath315 where @xmath316 is the pontryagin dual .",
    "the first exact sequence follows from theorem 3.11 in @xcite by taking @xmath317 .",
    "indeed , the hyper - cohomology is the same as the usual galois cohomology in this case and @xmath318 $ ] . since @xmath319 is torsion , one has @xmath320 by viii , ( 8.3.17 ) in @xcite .",
    "the second one is deduced from if we can prove that the canonical map @xmath321 is injective . since @xmath54 is discrete in @xmath322 ,",
    "the quotient group @xmath323 is locally compact and totally disconnected",
    ". let @xmath7 be a finite non - empty subset of @xmath3 and @xmath324 be a group scheme model of @xmath91 over @xmath6 .",
    "then @xmath325 is finite ( when @xmath1 is split this comes from the finiteness of @xmath326 , the general case follows from @xcite , lemma 2.2.3 ) .",
    "it is clear that @xmath327 is compactly generated .",
    "this implies that @xmath323 is compactly generated .",
    "hence @xmath328 ( see _ e.g. _ @xcite , appendix ) .",
    "since the natural projection @xmath329 is open , one concludes @xmath330 by appendix in @xcite .",
    "[ stp ] let @xmath1 be a torus over a global field @xmath0 .",
    "suppose that one of the following conditions holds :    1 .",
    "@xmath0 is a global function field ; and @xmath7 can be empty , @xmath331 is then the identity map ] ; 2 .",
    "@xmath0 is a number field and @xmath332 where @xmath333 and @xmath334 are the respective ranks of the free abelian groups @xmath335 and @xmath336 .",
    "then @xmath1 satisfies vsap - bm off @xmath7 for any finite subset @xmath7 containing @xmath4 . in case",
    "( 2 ) , @xmath54 is discrete , hence closed in @xmath337 .",
    "it is enough to show that , under the hypothesis of the theorem , the kernel of the map is @xmath54 .",
    "\\(1 ) the case where @xmath0 is a global function field follows from proposition  [ tori ] .",
    "\\(2 ) suppose @xmath0 is a number field . according to @xcite , main theorem , under the hypothesis on the ranks",
    ", there is an open subgroup of @xmath338 whose intersection with @xmath54 is finite .",
    "so @xmath54 is discrete ( hence closed ) in @xmath339 .",
    "the result follows from @xcite , thorme 2 ( see also remarques that follow ) .",
    "recall that a subvariety is a closed subvariety of an open subvariety .",
    "[ reb ] let @xmath20 be a subvariety of a torus as in theorem [ stp ] .",
    "then @xmath340 where @xmath4 is empty if @xmath0 is a global function field .",
    "in particular , for any finite @xmath341 , the very strong approximation property with brauer - manin obstruction off @xmath7 holds for @xmath20 .",
    "this follows from proposition  [ bm - vsap - im ] and theorem  [ stp ] .",
    "[ rank0 ] the following tori satisfy the rank condition in theorem [ stp ] ( 2 ) :    1 .",
    "when @xmath2 or is a quadratic imaginary field and @xmath1 is a split torus over @xmath0 ; 2 .",
    "when @xmath0 is a totally real field , and @xmath342 where the @xmath343 are totally imaginary quadratic extensions of @xmath0 and @xmath344 denotes the weil restriction functor ; 3 .   when @xmath1 is isogeneous to any finite product of the above tori over @xmath0 .",
    "[ ex-3.9 ] let @xmath345 be one of the algebraic varieties defined as follows",
    ". then vsap - bm off @xmath346 holds for @xmath345 .    1 .",
    "let @xmath345 be defined by the following diagonal equation @xmath347 where @xmath348 , @xmath349 for @xmath350 .",
    "then @xmath345 is a closed subvariety of @xmath351 .",
    "2 .   let @xmath352 be an elliptic curve over @xmath44 and @xmath353 $ ] be three distinct points .",
    "then @xmath354 can be embedded in @xmath355 because it is contained in the complementary in @xmath356 of the tangent lines at the three missing points .",
    "any open subset of @xmath357 in the complementary of an imaginary quadratic point is contained in a torus as in example  [ rank0](2 ) .",
    "[ open ] suppose @xmath20 is a smooth and geometrically integral variety over @xmath0 and @xmath219 is an open subscheme of @xmath20 .",
    "if @xmath358 is finite , then the strong approximation property with brauer - manin obstruction of @xmath219 implies the strong approximation property with brauer - manin obstruction of @xmath20 by proposition 2.6 in @xcite .",
    "it is natural to ask if the finiteness condition for @xmath358 can be removed .",
    "take any @xmath20 for which the strong approximation property with brauer - manin obstruction does not hold ( _ e.g. _ , the complement of a rational point in some elliptic curve as at the end of @xcite ) , then the next corollary ( or example [ ex-3.9](2 ) ) gives a negative answer to the above question , by taking a small enough open subset @xmath219 of @xmath20 .",
    "[ rev ] let @xmath20 be an algebraic variety over @xmath0 , where @xmath2 or is an imaginary quadratic field .",
    "then there exists a dense open subset @xmath219 of @xmath20 such that @xmath219 satisfies the very strong approximation property with brauer - manin obstruction off @xmath7 for any finite subset @xmath7 containing @xmath4 .    by corollary  [ reb ] and example  [ rank0](1 ) ,",
    "it is enough to show that @xmath20 contains a dense open subset @xmath219 which is a finite disjoint union of subvarieties of split tori over @xmath0 . after restricting to the interior of each irreducible component",
    ", we can suppose that @xmath20 is irreducible and even integral .",
    "shrinking further @xmath20 if necessary , we can suppose that @xmath20 is affine .",
    "now embed @xmath20 as a closed subvariety in some affine space @xmath359 with @xmath360 minimal .",
    "let @xmath91 be a split torus obtained as the complement of @xmath360 independent linear hyperplanes in @xmath359 .",
    "then @xmath361 is a closed subvariety of @xmath91 , is non - empty ( by the minimality of @xmath360 ) and is open in @xmath20 .",
    "let @xmath0 be a number field .",
    "let @xmath20 be an algebraic variety admitting a non - constant morphism @xmath362 from the affine line over @xmath0 .",
    "then for any finite @xmath341 , the map @xmath363\\ ] ] is not surjective .",
    "this can be proved as follows .",
    "the image of @xmath243 in @xmath20 is a locally closed subset of dimension @xmath129 .",
    "endowed with the reduced structure , it is an integral subvariety of @xmath20 . by proposition  [ bm - vsap - im ]",
    ", we can replace @xmath20 by @xmath364 and suppose that @xmath243 is surjective .",
    "we can extend @xmath243 to a finite surjective morphism @xmath365 to a compactification @xmath366 of @xmath20 . then @xmath367 . by lroth s theorem",
    ", the normalization of @xmath20 is isomorphic to @xmath368 .",
    "thus we can replace @xmath243 by the normalization map of @xmath20 and suppose that @xmath243 is birational .",
    "let @xmath75 be the smooth locus of @xmath20 and let @xmath369 . the canonical injective map @xmath370\\cong p_s[v(\\a_f)]\\to p_s[x_f(\\a_f)]\\ ] ] factors through @xmath370\\subseteq p_s[\\mathbf a^1_f(\\a_f)]=p_s[\\mathbf a^1_f(\\a_f)^{\\operatorname{br}(\\mathbf a^1_f)}]\\to p_s[x_f(\\a_f)^{\\operatorname{br}(x_f)}].\\ ] ] so @xmath371 $ ] is actually contained in @xmath275 $ ] .",
    "if the map @xmath372\\ ] ] is surjective , as @xmath229 is countable , @xmath371 $ ] would also be countable , we have a contradiction .",
    "let @xmath20 be a hyperbolic rational curve ( _ i.e. _ @xmath20 is an open subset in @xmath45 , and its complementary is a reduced separable divisor of degree @xmath46 ) and let @xmath61 be an integral model of @xmath20 over @xmath6 for a non - empty finite subset @xmath7 of @xmath3 containing @xmath4 .",
    "harari and voloch proposed the following conjecture ( @xcite , conjecture 2 ) .",
    "( harari - voloch ) [ conjecture ] let @xmath373.\\ ] ] then the diagonal map @xmath374 is bijective .",
    "[ hv - equiv ] by the same argument as those in corollary [ bijective ] , this conjecture holds for all models of @xmath20 over @xmath124 if and only if @xmath375 is bijective .",
    "since @xmath376\\supseteq x_f(f),\\ ] ] conjecture  [ conjecture ] implies the very strong approximation property with brauer - manin obstruction off @xmath7 for @xmath20 , and it also implies a conjecture of skolem ( see remark 2.5 in @xcite ) .",
    "[ br ] let @xmath0 be any field .",
    "let @xmath20 be an affine curve contained in @xmath377 with @xmath378 .",
    "let @xmath305 be a separable closure of @xmath0 .    1 .",
    "there is a split exact sequence @xmath379 2 .",
    "suppose @xmath0 is a global field .",
    "denote by @xmath380 a separable closure of @xmath23 for any @xmath381 .",
    "then one has a split exact sequence @xmath382 \\to 0\\end{gathered}\\ ] ] for any finite subset @xmath7 of @xmath3 containing @xmath4 .    by hochschild - serre spectral sequence ( see @xcite , iii , theorem 2.20 and appendix b , p. 309 ) @xmath383 with @xmath384 , one has the long exact sequence @xmath385\\to h^1(f , \\operatorname{pic}(x_{\\bar{f}})).\\ ] ] since @xmath20 is an affine open subscheme of @xmath377 , one has @xmath386 . moreover , @xmath387 by tsen s theorem .",
    "therefore @xmath388 the existence of a @xmath0-rational point on @xmath20 implies that the exact sequence of @xmath312-modules @xmath389 splits .",
    "this give a split exact sequence @xmath390 when @xmath0 is a global field , the same decomposition holds over @xmath23 for any @xmath381 , and the lemma follows easily .",
    "let @xmath0 be any field and @xmath20 be an affine curve contained in @xmath377 such that the reduced divisor @xmath391 is separable of degree @xmath392 and @xmath378 .",
    "the next lemma is the same as part of @xcite , lemma 2.1 , but we do not assume @xmath393 .",
    "[ embed - t ] let @xmath20 be as above and let @xmath305 be a separable closure of @xmath0 with galois group @xmath312 .",
    "let @xmath394 and denote by @xmath395 the group of divisors on @xmath396 supported in @xmath397 .",
    "let @xmath1 be a torus over @xmath0 such that its character group @xmath398 is isomorphic to @xmath399 as a @xmath312-module .",
    "then there exists a closed immersion @xmath400 such that the induced group homomorphism @xmath401 is an isomorphism .",
    "we have a canonical exact sequence @xmath402 where the last map consists in taking the divisors of rational functions on @xmath403 . because @xmath404 , it is clear that the above exact sequence induces an exact sequence of @xmath312-modules @xmath405 a rational point on @xmath20 gives rise to an evaluation homomorphism @xmath406 of @xmath312-modules , which is identity on @xmath407 on the source .",
    "thus we have @xmath312-equivariant isomorphisms @xmath408 and a @xmath312-equivariant @xmath305-algebras homomorphism @xmath409\\twoheadrightarrow \\bar{f}[e^{-1}(\\{1\\})]=\\bar{f}[{\\mathcal o}(x_{\\bar{f}})^\\times]\\subseteq { \\mathcal o}(x_{\\bar{f}}).\\ ] ] an easy explicit computation ( using the coordinates of the points of @xmath397 ; the hypothesis @xmath410 is needed here ) shows that the last two terms are actually equal .",
    "then the above homomorphism induces a closed immersion @xmath411 ( depending on the choice of a rational point on @xmath20 ) , and an isomorphism @xmath412    [ b1s ] let @xmath1 be a torus over @xmath0 and let @xmath413 be the group of characters of @xmath414 .",
    "when @xmath0 is a global field , we set @xmath415 for any field @xmath0 , we have @xmath416 as galois modules . similarly to the proof of lemma  [ br](1 ) , we have a split exact sequence @xmath417    the following proposition is a variant of theorem 1 in @xcite .",
    "[ eqhv ] let @xmath20 be a hyperbolic rational curve over a global field @xmath0 and let @xmath418 be the closed immersion given by lemma [ embed - t ] .",
    "fix a non - empty finite set @xmath7 of primes containing @xmath4",
    ". then    1 .",
    "we have @xmath419 where @xmath53 is the topological closure of @xmath54 inside @xmath55 ; 2 .",
    "conjecture [ conjecture ] for all models @xmath61 of @xmath20 over @xmath6 is true if and only if @xmath420    by lemmas [ br ] and [ embed - t ] , we have a split exact sequence : @xmath421 by theorem 2 in @xcite when @xmath0 is a number field , and by proposition  [ tori ] when @xmath0 is a function field , together with the compatibility of local duality ( @xcite , vii , ( 7.2.9 ) ) , one has the following diagram of exact sequences @xmath422 where @xmath316 is the pontryagin dual , @xmath423 is the topological closure of @xmath54 inside @xmath424 , @xmath425 is the group of connected components of the topological group @xmath426 and @xmath427 is the projection map .",
    "moreover , @xmath428 is injective with dense image by @xcite , vii , ( 7.2.10 ) .",
    "write for simplicity this diagram as @xmath429 and denote @xmath430 . as the latter is closed in @xmath55 , to prove ( 1 )",
    ", one only needs to show that @xmath431 is dense in @xmath432 or , equivalently , that @xmath433 is dense in @xmath432 .",
    "when @xmath0 is a number field , the image of @xmath434 is the kernel of a continuous map of topological groups @xmath435 by @xcite , theorem 2 , hence compact . because its domain is @xmath140-compact",
    ", @xmath434 is an open map to its image .",
    "let @xmath436 be an open subset such that @xmath437 then @xmath438 for some open subset @xmath439 of @xmath440 .",
    "as @xmath441 is a non - empty open subset of @xmath442 by the hypothesis on @xmath219 , it contains an element of @xmath443 by the density of @xmath443 .",
    "this implies that @xmath219 contains an element of @xmath444 and proves ( 1 ) for number fields .",
    "now suppose that @xmath0 is a global function field . then @xmath445 let @xmath219 be an open subset of @xmath322 with an intersection point @xmath446 .",
    "let @xmath447 be the integral smooth projective curve whose function field is @xmath0 .",
    "then @xmath448 contains an open subgroup of the form @xmath449 , where @xmath450 is a group scheme of finite type over @xmath447 with generic fiber isomorphic to @xmath1 ( corollary  [ u - model ] ) .",
    "we can shrink @xmath219 and suppose @xmath451 . as @xmath431 is a group , @xmath452 is equivalent to @xmath453 , where @xmath454 is an open subgroup of @xmath322 . we know that @xmath455 is finite ( when @xmath1 is split this comes from the finiteness of @xmath326 , the general case follows from @xcite , lemma 2.2.3 )",
    "therefore , @xmath31 is an open subgroup of finite index in @xmath322 and @xmath456 is an open subset in @xmath457 .",
    "similarly to the case of number fields , by using the exact sequence , we see that @xmath458 . as @xmath54 and @xmath459",
    "are contained in @xmath31 , @xmath460 , hence @xmath461 and @xmath453 .",
    "\\(2 ) by ( 1 ) , we have @xmath462 by the functoriality of the brauer - manin pairing ( see @xcite , ( 5.3 ) ) and by the exact sequence .",
    "this completes the proof of ( 2 ) by remark  [ hv - equiv ] .",
    "[ true ] conjecture [ conjecture ] is true if @xmath0 is a global function field .",
    "embed @xmath20 into a torus @xmath1 as in lemma  [ embed - t ] . by the above proposition ,",
    "it is enough to show that @xmath463 . for any @xmath464",
    ", there is a finite set @xmath465 such that @xmath1 can be extended to a group scheme @xmath450 of finite type over @xmath466 with @xmath467 the latter is an open subset whose intersection with @xmath54 is equal to @xmath468 .",
    "this implies that @xmath469 where @xmath470 is the topological closure of @xmath471 in @xmath472 with the product topology .",
    "since @xmath471 is a finitely generated abelian group , one has @xmath473 by @xcite , theorem 1 .",
    "the proof is complete .",
    "[ hv - ev ] ( see also corollary  [ hv - ex2 ] ) let us give some evidence for harari - voloch conjecture over @xmath44 with @xmath474 .",
    "let @xmath475 be a non - empty open subset of @xmath476 , where @xmath477 consists of either three rational points , or two imaginary quadratic points , or one point of each type .",
    "then harari - voloch conjecture is true for @xmath475 and @xmath478 .",
    "indeed , the torus @xmath479 which the curve @xmath480 is embedded in following lemma  [ embed - t ] satisfies the condition of theorem  [ stp ] ( 2 ) . in particular , @xmath481 it follows from proposition  [ eqhv ] ( 2 ) that harari - voloch conjecture holds for @xmath482 and @xmath7 . for arbitrary non - empty open subset @xmath475 of @xmath482",
    ", this proof does not work anymore , but the result is still true by applying @xcite , theorem  3 to the open immersion @xmath483 .",
    "in this section we will show that the analogue of @xcite , theorem 3.11 holds for tori over number fields .",
    "see theorem  [ inters ] . as an application",
    ", we generalize @xcite , theorem 3",
    ". see proposition  [ quasi - finite ] . throughout this section , _",
    "@xmath0 is a number field_. we also fix a finite subset @xmath7 of @xmath3 containing @xmath4 .",
    "the proof of the main theorem  [ inters ] of this section follows closely the same strategy as in @xcite .",
    "let us first show some preliminary results on galois cohomology of tori .",
    "let @xmath484 be a finite subset of @xmath3 with @xmath465 and @xmath485 be a separated commutative group scheme of finite type over @xmath466 such that @xmath486 for some @xmath487 , where @xmath488 is the integral closure of @xmath466 inside the algebraic closure @xmath305 of @xmath0 . under the assumption ( [ split ] )",
    ", the multiplication by @xmath489 on @xmath490 is surjective .",
    "note that enlarging @xmath484 if necessary , condition   is always be satisfied .",
    "indeed , we can extend @xmath0 and suppose @xmath491 . as @xmath324 and @xmath492 coincide on the generic fiber and are both of finite type , they concide on a dense open subset of @xmath493 .    for any positive integer @xmath489 , denote by @xmath494 $ ] the group scheme of @xmath489-torsion of @xmath485 . in what follows , in galois cohomology groups , @xmath485 ( resp . @xmath494 $ ] )",
    "is the galois module @xmath495 ( resp .",
    "@xmath494(\\bar{\\go}_{s_1})$ ] ) .",
    "define as usual @xmath496 ) \\rightarrow \\prod_{v\\not\\in s }   h^1(f_v,{\\t}))\\ ] ] and @xmath497 ( it can be seen that the image of @xmath498 in @xmath499 is in fact contained in @xmath500 by lang s theorem on torsors under connected algebraic groups over a finite field ) . then one has the short exact sequence @xmath501 \\rightarrow 0\\ ] ] and the natural coordinate map can be decomposed as @xmath502 by using the kummer sequence and galois cohomology .",
    "let @xmath96 be a finite galois extension of @xmath0 such that @xmath504 is a split torus over @xmath96 .",
    "it is easy to see that the kernel of the canonical map @xmath505 , where @xmath506 is the set of primes of @xmath96 above @xmath7 , is contained in @xmath507 . since @xmath508 is a finitely generated abelian group , @xmath507 is finite .",
    "therefore the finiteness of @xmath509 implies that of @xmath503 and we can assume that @xmath1 is a split torus over @xmath0 . enlarging @xmath7 if necessary ( which will increase @xmath510 ) , we can suppose that @xmath511 and @xmath512 , and even that @xmath513 .",
    "the short exact sequence @xmath514 gives the diagram of the following long exact sequence @xmath515 for any @xmath516 by galois cohomology , where @xmath384 and @xmath517 .",
    "since for all @xmath94 , @xmath312 acts transitively on the primes of @xmath518 dividing @xmath11 , one has @xmath519 note that the canonical map @xmath520 takes values in the direct sum .",
    "thus by the snake lemma , and because @xmath521 , @xmath522 is finite .",
    "let @xmath485 be a commutative group scheme separated of finite type over @xmath466 satisfying condition ( [ split ] ) as before .",
    "consider the projective systems @xmath523 and @xmath524 , where for any pair of natural integers @xmath525 , the transition map of the first system is the canonical quotient map , and that of the second system is given by the multiplication - by-@xmath526 map @xmath527 consider the limits @xmath528            let @xmath96 be a finite galois extension of @xmath0 such that @xmath532 splits over @xmath96 , let @xmath533 be the places of @xmath96 above @xmath484 and let @xmath534 .",
    "let @xmath535 be the absolute galois group of @xmath96 .",
    "then @xmath536(\\bar{\\go}_{s'})$ ] is a sub-@xmath535-module of @xmath537(\\bar{k})=\\mu_{n , k}^d(\\bar{k})$ ] .",
    "it follows that @xmath536(\\bar{\\go}_{s'})$ ] is isomorphic to a product of @xmath538 s .",
    "we have the following commutative diagram @xmath539(\\go_{s ' } ) ) @ > > > h^1(f , { \\t}[n ] ) @ > > > h^1(k , { \\t}'[n ] ) \\\\",
    "@.   @vvv   @vvv    \\\\ @.",
    "\\prod_{v\\not\\in s_1 } h^1(f_v , { \\t}[n ] )   @ > > > \\prod_{w|v , v\\not \\in s_1 } h^1(k_w , { \\t}'[n ] ) .",
    "\\end{cd}\\ ] ] as @xmath540(\\go_{s'}))$ ] is killed by @xmath541 , r_k)$ ] , where @xmath542 is the number of roots of unity inside @xmath96 , and the kernel of the last vertical arrow is killed by @xmath543 ( @xcite , theorem ( 9.1.9)(ii ) ) , the kernel @xmath544)\\rightarrow \\prod_{v\\not\\in s_1 } h^1(f_v , { \\t}[n])\\big)\\ ] ] is killed by @xmath545 , r_k)$ ] for any positive integer @xmath489 .",
    "let @xmath546 which depends only on @xmath450 .    for any @xmath547 , the following commutative diagram of kummer exact sequences @xmath548 )   \\\\",
    "@vvv   @vvv   @vvv \\\\",
    "\\prod_{v\\not\\in s_1 } { \\t}(\\go_v)@>{\\cdot h n } >",
    "> \\prod_{v\\not\\in s_1 } { \\t}(\\go_v )",
    "\\prod_{v\\not\\in s_1 } h^1(f_v , { \\t}[h n ] ) \\end{cd}\\ ] ] implies that there exists @xmath549 such that @xmath550 .",
    "let @xmath551 we have @xmath552 where @xmath553 .",
    "by @xcite , theorem ( 9.1.11)(i ) , there exists @xmath554 such that @xmath555 . as @xmath222 is a @xmath556-torsion point",
    ", @xmath35 is also a torsion point . since @xmath542 kills all roots of unity in @xmath96",
    ", @xmath222 is trivial and @xmath557 .",
    "the proof is complete .",
    "[ equiv ] let @xmath470 be the topological closure of @xmath471 inside @xmath55 .",
    "then the natural homomorphisms @xmath558 induce an isomorphism of topological groups @xmath559 .",
    "in particular , the inclusion @xmath560 induces an equality of the torsion parts @xmath561    let @xmath562 for any positive integer @xmath489 .",
    "since @xmath471 is a finitely generated abelian group , the quotient @xmath563 is finite for all @xmath489 .",
    "as the canonical map @xmath564 has dense image , it is surjective . therefore one has the following exact sequence @xmath565 for any positive integer @xmath489 .",
    "moreover , the inverse system @xmath566 satisfies the mittag - leffler condition by the finiteness of @xmath567 . by taking the inverse limits ,",
    "one obtains the exact sequence @xmath568 the last equality follows from @xcite , theorem 1.1 . on the other hand , @xmath569 by lemma",
    "[ h - k ] and the the desired isomorphism is proved .",
    "the equality on the torsion parts then follows easily from the fact that @xmath468 is a finitely generated abelian group .",
    "[ cohtor ] there exists a positive integer @xmath556 depending only on @xmath450 such that @xmath556 kills all @xmath571)$ ] for all positive integers @xmath489 , where @xmath572)$ ] is the smallest extension of @xmath0 such that @xmath570(\\bar{\\go}_{s_1})\\subseteq t_f(f_n)$ ] .",
    "let @xmath96 be a finite galois extension of @xmath0 containing @xmath573 .",
    "then @xmath574 acts trivially on @xmath570(\\bar{\\go}_{s_1})$ ] and we have an exact sequence @xmath575)\\to h^1(k / f,{\\t}[n ] ) \\to h^1(k / f_n , { \\t}[n]).\\ ] ] taking @xmath96 for the compositum of @xmath573 with the splitting field of the torus @xmath1 , we are reduced to the case when @xmath1 is split .",
    "define the galois module @xmath576 by the exact sequence @xmath577(\\bar{\\go}_s ) \\to t_f[n](\\bar{f})=\\mu_{n , f}^d",
    "\\to \\nu_n \\to 0.\\ ] ] then one has @xmath578)\\rightarrow h^1(f(\\mu_n)/f , \\mu_n^d)\\ ] ] and @xmath579 ) \\rightarrow   h^1(f(\\mu_n)/f , { \\t}[n])\\ ] ] by galois cohomology . let @xmath580 be the number of roots of unity inside @xmath0 .",
    "then @xmath581 is killed by @xmath580 and one only needs to prove that @xmath582 is killed by a positive integer which is independent of @xmath489 .",
    "let @xmath583 be the prime factorization of @xmath489 .",
    "then one has @xmath584 and the exact sequence @xmath585 where @xmath586 . since @xmath587 one concludes that @xmath588 is killed by @xmath589 by @xcite , proposition 9.1.6 .      [ density ]",
    "let @xmath556 be a positive integer as in lemma [ cohtor ] .",
    "let @xmath592 and let @xmath360 be the order of @xmath593 inside @xmath594 .",
    "then the density of the following set @xmath595 inside @xmath3 is less than or equal to @xmath596)$ ] , where @xmath572)$ ] .",
    "as @xmath597 , one can replace @xmath7 with @xmath484 and suppose that @xmath511 .",
    "let @xmath533 be the primes of @xmath573 above the primes of @xmath7 and let @xmath598 the restriction map of galois cohomology induces a homomorphism @xmath599 whose kernel is killed by @xmath556 by construction ( lemma  [ cohtor ] ) .",
    "this implies that the order of the image of @xmath600 in @xmath601 is a multiple of @xmath360 . since @xmath602)=\\operatorname{hom}_{\\mathrm{cont } } ( \\operatorname{gal}(\\bar{f}/f_n ) , { \\t}[n]),\\ ] ] @xmath600 gives rise to a homomorphism @xmath603)$ ] of order a multiple of @xmath360 .",
    "let @xmath604 .",
    "this is a galois extension of @xmath573 of degree a multiple of @xmath360 .",
    "if @xmath516 splits completely in @xmath605 and @xmath606 is a prime in @xmath573 above @xmath11 , then one has the following commutative diagram with injective row maps @xmath607 ) \\\\      @vvv @vvv \\\\",
    "{ \\t}(\\go_v)/n { \\t}(\\go_v ) \\cong { \\t}(\\go_{w})/n { \\t}(\\go_{w } ) @ > > > \\operatorname{hom}_{\\mathrm{cont}}(\\operatorname{gal}(\\overline{f_{n , w}}/ f_{n , w}),{\\t}[n ] ) \\end{cd}\\ ] ] where @xmath608 is the algebraic closure of @xmath609 .",
    "so the image of @xmath600 in @xmath610 is trivial if and only if the decomposition group at any prime of @xmath147 above @xmath606 is trivial .",
    "the latter is equivalent to @xmath606 being split in @xmath611 completely .",
    "therefore the set of primes of @xmath0 we consider is the same as the set of primes in @xmath0 , not in @xmath7 , and which split completely in @xmath147 . by the chebotarev density theorem ,",
    "the density of this set is at most @xmath612}=\\frac{1}{[l : f_n]\\cdot [ f_n : f ] } \\leq \\frac{1}{n\\cdot [ f_n : f]}\\ ] ] and",
    "the proof is complete .",
    "we first reduce to the case @xmath613 using a similar trick to the proof of @xcite , proposition 3.9 . consider a finite extension @xmath614 such that @xmath615 .",
    "let @xmath533 be the primes of @xmath96 above @xmath7 . if one can show that @xmath616 then @xmath617 the last equality being proved similarly to lemma 3.2 in @xcite , and the desired equality will hold over @xmath0 .",
    "since @xmath618 is finite , there exists a finite subset @xmath619 such that @xmath91 extend to an affine group scheme @xmath450 of finite type over @xmath466 and @xmath620 and the condition ( [ split ] ) is satisfied .",
    "one only needs to show that @xmath621 where @xmath470 is the topological closure of @xmath471 inside @xmath55 .",
    "indeed , the left - hand side contains @xmath622 as we saw in the proof of corollary [ true ] .    for any @xmath623",
    "we claim that there is @xmath624 such that @xmath625 is torsion .",
    "suppose the contrary .",
    "then all @xmath625 with @xmath624 are of infinite order .",
    "fix a positive integer @xmath360 with @xmath626 .",
    "use proposition  [ equiv ] and corollary  [ t - s ] to identify @xmath627 to a subgroup of @xmath628 . by the same argument as @xcite ,",
    "lemma 3.5 , there is a positive integer @xmath489 such that the order of @xmath629 in @xmath594 is at least @xmath360 for all @xmath624 , here @xmath556 is the positive integer defined lemma  [ cohtor ] . by lemma [ density ] , the density of primes @xmath630 such that @xmath11 splits completely in @xmath605 and at least one of @xmath625 is trivial in @xmath610 for some @xmath624 is at most @xmath631 } < \\frac{1}{[f_n : f ] } .\\ ] ] this implies that there is @xmath632 such that @xmath633 splits completely in @xmath605 and none of @xmath634 is trivial in @xmath635 for all @xmath624 .",
    "in particular , one has @xmath636 for all @xmath637 .",
    "this contradicts the hypothesis @xmath638 .",
    "[ quasi - finite ] suppose @xmath646 is a quasi - finite morphism of curves over @xmath0 and @xmath20 is a rational curve inside @xmath377 with complement of degree @xmath392 . fix a finite subset @xmath7 of primes of @xmath0 containing @xmath4 . if @xmath647 , then @xmath648 .    for any @xmath649 ,",
    "there is @xmath650 such that @xmath651 by the functoriality of the brauer - manin pairing and the assumption .",
    "then @xmath652 is a finite closed subscheme over @xmath0 inside @xmath20 and @xmath653 .",
    "let @xmath418 be the closed immersion given by lemma  [ embed - t ] .",
    "let @xmath53 be the closure of @xmath54 in @xmath55 .",
    "by lemma [ br ] ( 2 ) , see also definition  [ b1s ] , the immersion @xmath411 induces a map @xmath654 by proposition [ eqhv ] ( 1 ) , one has @xmath655 hence @xmath656 by theorem [ inters ] .",
    "the proof is complete .",
    "[ gen ] let @xmath657 be a projective smooth curve of positive genus over @xmath0 .",
    "in @xcite , theorem 8.2 , it is proved that for any finite closed subset @xmath51 of @xmath657 , one has @xmath658 where the subscript @xmath659 means that at infinite places @xmath11 , @xmath660 is replaced with its set of connected components @xmath661 .    using the above result ,",
    "colliot - thlne proved in @xcite that @xcite theorem 3 , can be generalized to covers of arbitrary degree , provided the group @xmath662 is replaced by the whole brauer group @xmath663 .",
    "our proof of proposition  [ quasi - finite ] is based on similar arguments .",
    "if @xmath20 is an open subvariety of @xmath657 containing @xmath51 and if the analogue equality @xmath664 holds , then one can remove the rationality hypothesis on @xmath20 in proposition [ quasi - finite ] .",
    "[ hv - ex2 ] let @xmath477 be a reduced effective divisor in @xmath357 supported in at least two points .",
    "let @xmath475 be the complement of @xmath477 and let @xmath665 .",
    "then @xmath666 in particular , harari - voloch conjecture holds for @xmath475 and @xmath7 if @xmath667 ( equivalently , if @xmath475 is hyperbolic ) .",
    "let @xmath668 be two points in @xmath477 .",
    "there exists a non - constant invertible element @xmath669 .",
    "the finite morphism @xmath670 defined by @xmath243 induces a quasi - finite morphism @xmath671 .",
    "as @xmath672 ( e.g. by proposition  [ eqhv ] ( 2 ) and theorem  [ stp ] ( 2 ) ) , the same equality holds for @xmath475 by proposition  [ quasi - finite ] .",
    "* acknowledgements .",
    "* we would like to thank j .-",
    "colliot - thlne , d. harari , y. liang and f. voloch for helpful discussions .",
    "we would also like to thank liang - chung hsia for drawing our attention to @xcite .",
    "we thank the referee for a careful reading of the manuscript and for pointing out some inaccuracies .",
    "the first named author thanks capital normal university , where part of this work was done , for its support .",
    "the second named author is supported by the algant program in universit de bordeaux , mpi for mathematics at bonn from sep .- oct.2014 and nsfc grant no ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a global field . in this work , we show that the brauer - manin condition on adelic points for subvarieties of a torus @xmath1 over @xmath0 cuts out exactly the rational points , if either @xmath0 is a function field or , if @xmath2 and @xmath1 is split . </S>",
    "<S> as an application , we prove a conjecture of harari - voloch over global function fields which states , roughly speaking , that on any rational hyperbolic curve , the local integral points with the brauer - manin condition are the global integral points . </S>",
    "<S> finally we prove for tori over number fields a theorem of stoll on adelic points of zero - dimensional subvarieties in abelian varieties . </S>"
  ]
}