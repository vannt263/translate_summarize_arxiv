{
  "article_text": [
    "the recent market turbulence caused by the credit crunch has exposed in a drastic way the consequences of overconfidence in financial modelling assumptions .",
    "typically , a financial model , such as the famous black - scholes model , will assume that the price of an asset follows a given stochastic process whose parameters need to be calibrated to market prices .",
    "if a model becomes an accepted standard and most market participants adopt it , problems can occur when assumptions that hold under normal market conditions are also expected to hold under abnormal ones .",
    "an example is the stock market crash of @xmath2 , where the volatilities used for pricing at - the - money options were also used for pricing far out - of - the - money put options . as the market headed downwards , it turned out that the true hedging cost for somebody who had sold such puts was far greater than the received premium .",
    "another good example is described in the recent paper @xcite , where the authors demonstrate for cdos and cdo@xmath3s what can happen to asset prices when model parameters that are hard to observe or estimate with sufficient accuracy are put to a true stress test .",
    "however , they write : `` the good news is that this mistake can be fixed .",
    "for example , a bayesian approach that explicitly acknowledges that parameters are uncertain would go a long way towards solving this problem . ''",
    "@xcite    another well - established way to obtain estimates for such parameters from observable data , which we will follow here , is via maximum entropy methods ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) .",
    "such an estimate `` is the least biased estimate possible on the given information , i.e. , it is maximally noncommittal with regard to missing information . ''",
    "@xcite for example , the probability distribution over the interval @xmath4 $ ] which maximises entropy is the uniform distribution .",
    "there is no entropy maximiser for distributions over @xmath5 .",
    "however , when the mean and variance are specified , the gauss distribution with these parameters maximises entropy .",
    "we concentrate on the distribution of an asset price at a given time in the future , for which there are some option data .",
    "we develop a highly robust technique to find a maximum entropy distribution ( med ) for the asset in case we have call and digital option prices .",
    "the density is obtained by partitioning the range of possible stock prices into buckets , i.e. the intervals between adjacent strikes given by the option data , but , in contrast to the black - scholes model , making no a priori assumption about the asset s distribution .",
    "instead , we maximise the boltzmann - shannon entropy to obtain a distribution that respects only the given option prices and is otherwise unbiased .",
    "the density can in turn be used to interpolate implied volatilities and , by repeating this operation for a range of maturities , obtain a volatility surface .",
    "the results agree surprisingly well with observed volatility surfaces from the markets .",
    "buchen and kelly ( @xcite ) have proposed a similar entropy maximisation method to infer the probability distribution for an asset from call prices .",
    "this maximisation problem corresponds to finding a set of lagrange multipliers . in @xcite",
    "the authors write : `` there is a problem with this type of calculation , '' meaning that the formal lagrange multipliers approach is not mathematically rigorous . using convex programming arguments they legitimise those calculations .",
    "like @xcite we legitimise the results found in @xcite .",
    "however , we follow a simpler approach by applying a result of csiszr s @xcite .    both @xcite and @xcite present numerical methods to find the lagrange multipliers by solving an @xmath6-dimensional non - linear problem ( where @xmath6 is the number of constraints given by call prices ) . as mentioned in @xcite , in the case of close strikes",
    "the problem can be poorly conditioned . in the present work ,",
    "we add @xmath6 digital prices to our constraints and the resulting numerical problem is highly simplified : instead of an @xmath6-dimensional equation , we need to solve a one - dimensional problem @xmath7 for @xmath6 different values of @xmath8 ( the same @xmath9 though ) , allowing for easy parallelisation and avoiding any ill - conditioned problem . additionally , @xmath9 is a strictly monotonic function whose derivative is known analytically . therefore , the newton - raphson method can be used for excellent speed of convergence and stability . alternatively",
    "to iterative methods , one may try to find an analytical approximation for @xmath10 .    in a nutshell ,",
    "the advantage we obtain is the localisation of the maximum entropy density into asset price buckets , in which the functional form is a simple exponential function .",
    "but of course there is a price to pay for this localisation technique , and the price here is the necessity of an additional constraint for each call option used .",
    "this extra constraint is the price of a digital option at the same strike .",
    "the density in our case differs slightly from the one given by the method in @xcite .",
    "we therefore investigate the differences between them . in both approaches",
    "one can also use information from a so - called prior density , if available , leading to the concept of relative entropy ( also called @xmath1-divergence and kullback - leibler information number ) , and we compare the densities obtained by this method .    after finding the med",
    "we give the expressions for the cumulative distribution function and its inverse .",
    "these formulas involve only arithmetic operations and exponential- and logarithm - functions .",
    "they are therefore very easy to implement and fast to compute .",
    "this is a highly useful feature for fast monte carlo simulations .",
    "furthermore , we obtain an analytical formula for the price of a call at a given strike . by calculating several such prices at different strikes , one can recover the implied volatility smile .",
    "we also include a section in which we calibrate to real market data .",
    "digital options on the s&p 500 index ( spx ) and the cboe volatility index ( vix ) are traded on the chicago board option exchange ( cboe ) , where they are called _",
    "binary options_. they are specified such that `` expiration dates and settlement values are the same as for traditional options '' @xcite , which is just what we need in our setup . we show results for two cases : the first , in which we have cboe quotes for call _ and _ digital options on the spx and calibrate to them , and the second , for a different maturity , in which we only have quotes for call options and therefore have to estimate digital prices from call spreads .",
    "the method we propose here is found to work very well in both cases , and we compare our results to those obtained by calibrating only to call prices as in @xcite .",
    "we are given a fixed maturity @xmath11 , strictly increasing strikes @xmath12 @xmath13 , and undiscounted call and digital prices @xmath14 at these strikes .",
    "the payoffs of the call and digital options are given in equations and .",
    "@xmath15 denotes the discount factor . throughout",
    "we make the convention @xmath16    assuming risk neutral pricing , we will determine a density @xmath17 for the underlying asset price @xmath18 which maximises entropy @xmath19 under the constraints @xmath20 } = \\tilde{c}_i , \\quad i.e. \\quad \\int_{k_i}^\\infty ( x - k_i ) g(x ) dx = \\tilde{c}_i\\ ] ] and @xmath21 } = \\tilde{d}_i , \\quad i.e. \\quad \\int_{k_i}^\\infty g(x ) dx = \\tilde{d}_i\\ ] ] for all @xmath22 .",
    "in particular , these two constraints for @xmath23 mean that @xmath17 is a density , since @xmath24 , and that the martingale condition @xmath25 } = \\int_0^\\infty x g(x ) dx = \\tilde{c}_0\\ ] ] is satisfied , since @xmath26 is the forward price of @xmath27 for time @xmath11 .    from the second constraint",
    "it immediately follows that @xmath28    looking at a call spread with strikes @xmath29 raised to level @xmath30 , i.e. a derivative that pays @xmath18 if @xmath31 and zero otherwise , we obtain the condition @xmath32    we now calculate the density @xmath17 under the constraints given above . the purpose of theorem [ localglobalmaximiser ] is to show that the local constraints and are equivalent to the global constraints and .",
    "moreover , @xmath33 and , thus , we only need to maximise @xmath34 subject to and over each bucket .",
    "let @xmath35 be the set of positive borel - measurable functions defined on @xmath36 define @xmath37 and , for all @xmath22 , @xmath38    [ intersectionx ] @xmath39    it is straightforward to show this using , , and .",
    "@xmath40    for @xmath41 we define @xmath42    [ localglobalmaximiser ] if @xmath17 is a maximiser of @xmath43 on @xmath44 , then @xmath17 is a maximiser of @xmath45 on @xmath46 .",
    "conversely , if @xmath17 is a maximiser of @xmath45 on @xmath46 for all @xmath47 then @xmath17 is a maximiser of @xmath43 on @xmath44 .",
    "let @xmath17 be a maximiser of @xmath43 on @xmath44 , and let @xmath48 .",
    "define @xmath49 since @xmath50 on @xmath51 , we have @xmath52 .",
    "moreover , for @xmath53 , we have @xmath54 on @xmath55 , and thus @xmath56 .",
    "it follows from proposition [ intersectionx ] that @xmath57 .",
    "hence , from the maximality of @xmath58 , we get @xmath59 .",
    "a simple computation gives @xmath60 , and therefore @xmath61 .",
    "it follows that @xmath17 maximises @xmath45 on @xmath46 .",
    "conversely , suppose that @xmath17 is a maximiser of @xmath45 on @xmath46 for all @xmath62 let @xmath63 .",
    "we have @xmath64 which means that @xmath17 is a maximiser of @xmath43 on @xmath44 .",
    "@xmath40    we now give a heuristic way of determining the entropy maximiser , but in the next subsection we also give a rigorous proof that this is indeed the correct result . formally applying the lagrange multipliers theorem , we conclude that the maximiser has the form @xmath65 to see this , define the functionals @xmath66 and solve the equation @xmath67 for the frchet derivatives .",
    "it follows that @xmath68 therefore , on the interval @xmath51 , we must have @xmath69 and , introducing @xmath70 and @xmath71 , we obtain .",
    "using the explicit form of @xmath17 just found in and gives @xmath72 for all @xmath22 .",
    "for @xmath73 , solving for @xmath74 and then for @xmath75 , using integration by parts , gives @xmath76 define @xmath77 it follows that @xmath78     and @xmath79 ( here @xmath80 means derivative with respect to @xmath81 ) . ]",
    "figure [ fig:1 ] shows the graphs of @xmath82 and @xmath83 for @xmath84 and @xmath85 .",
    "it suggests that equation has a unique solution if the quantity on the right hand side is in @xmath86k_i , k_{i+1}[$ ] .",
    "this turns out to be the case , as we show with the following proposition .",
    "let @xmath87 .",
    "if there is no arbitrage opportunity implied by @xmath88 , then there is a unique solution @xmath89 for equations and .",
    "define @xmath90 we first show that we must have @xmath91 .",
    "this can be seen by comparing the prices of three derivatives : they pay , respectively , @xmath30 , @xmath18 and @xmath92 if @xmath31 and zero otherwise . under the assumption that there is no arbitrage opportunity",
    ", it follows immediately that the second derivative is more expensive than the first one and cheaper that the third one .",
    "it is also clear that they can be replicated by portfolios of calls and digitals and their prices , in increasing order , are @xmath93 from the definition of @xmath94 the middle quantity above is @xmath95 and the result follows .",
    "next we show that if @xmath96 , then there is a unique solution @xmath89 for equations and .",
    "we begin with the case @xmath73 . as we have just seen , and are then equivalent to and . without loss of generality , we may assume @xmath97 and @xmath98 .",
    "indeed , it is straightforward to see that the change of variables @xmath99 transforms the equation @xmath100 into @xmath101 , with @xmath1020 , 1[$ ] . using lhpital s rule we obtain that the function @xmath103 given by @xmath104 is a continuous extension of @xmath105 .",
    "it is easy to see that @xmath106 and @xmath107 .",
    "hence the equation @xmath108 has a solution . to prove that the solution is unique",
    ", we shall now show that @xmath9 is strictly increasing .",
    "again by lhpital s rule , we obtain that @xmath9 is differentiable at @xmath109 and @xmath110 ( this is particularly useful because @xmath109 is an ideal starting point for the newton - raphson method ) . for @xmath111",
    "we have @xmath112 recall that @xmath113 for all @xmath114 .",
    "hence @xmath115 we conclude that @xmath116 for all @xmath117",
    ". therefore @xmath9 is strictly increasing .",
    "finally , we consider the case @xmath118 .",
    "equations and then become @xmath119 the first equation implies that @xmath120 . solving it for @xmath121 and the second equation for @xmath122",
    "gives @xmath123 @xmath40    note that we have shown that @xmath9 is itself a continuously differentiable probability distribution function .",
    "for such a function there might already exist an inversion - algorithm .      like others",
    ", we have formally derived the expression for the entropy maximiser using the lagrange multipliers method .",
    "however , as pointed out in @xcite `` there is a problem with this type of calculation . ''",
    "recall that the lagrange multipliers theorem requires continuous differentiability for objective and constraint functionals in a neighbourhood of the maximiser .",
    "however , the boltzmann - shannon entropy functional is finite only for densities in @xmath124 which has empty interior on @xmath125 . therefore a maximiser is not an interior point of @xmath126 .",
    "even worse , the entropy is far from being continuously differentiable since it is nowhere continuous .    in @xcite ,",
    "convex programming arguments are considered to circumvent this problem . here",
    "we present a new approach based on a result by csiszr @xcite .",
    "when no prior density is given we are interested in the ( non - relative ) entropy of @xmath17 @xmath127 where @xmath128 is an interval . however",
    ", csiszr s results deal with relative entropy of a probability density @xmath17 with respect to a probability measure @xmath129 on @xmath1 @xmath130 roughly speaking , we are interested in the `` relative entropy '' with respect to the lebesgue measure which , in general , is not a probability measure .    for @xmath131 , @xmath132 is bounded . in that case",
    ", the problem can easily fit in csiszr s framework by considering the normalised lebesgue probability measure @xmath133 .",
    "however , it is impossible to use this trick for the global problem , @xmath134 , and for the last bucket , @xmath135 , since there is no normalisation constant which turns the lebesgue measure into a probability measure on these intervals .",
    "nevertheless , it is possible to turn the two problems over unbounded intervals into equivalent ones that do fit in csiszr s framework .",
    "this is the subject of the next proposition .",
    "moreover , the same arguments also apply to bounded intervals . therefore ,",
    "in contrast to @xcite , we do not need to make any distinction between bounded and unbounded intervals .    for the sake of simplicity",
    ", the statement in the following proposition considers only two _ main _ constraints , namely , the total mass and the mean .",
    "this includes the bucket problems and excludes the global problem ( where additional constraints are given ) .",
    "however , the proof works even for an infinite number of constraints provided the two main ones are among them .",
    "[ bijection ] let @xmath136 be an interval .",
    "define @xmath137 for all @xmath138 , where @xmath139 is a normalisation constant such that @xmath140 is a probability measure on @xmath1 .",
    "let @xmath141 .",
    "then the mapping @xmath142 is a bijection from @xmath143 onto @xmath144 moreover , @xmath17 is a maximiser of @xmath145 on @xmath146 if and only if @xmath147 is a maximiser of @xmath148 on @xmath149 .",
    "define @xmath150 by @xmath151 .",
    "since @xmath152 is strictly positive , it follows immediately that @xmath153 is a well defined bijection .",
    "we shall show that @xmath153 preserves some linear functionals .",
    "let @xmath154 and @xmath155 .",
    "then we have @xmath156 in particular , applying this result to @xmath157 and to @xmath158 , it follows immediately that @xmath153 maps @xmath146 onto @xmath149 .    to complete the proof it suffices to show that if @xmath159 , then @xmath160 in fact , we shall show a stronger result , namely , that the two differences above are equal",
    "this is equivalent to showing that @xmath161 does not depend on @xmath162 .",
    "we have @xmath163 @xmath40    later we will restate and apply a partial version of a theorem by cziszr .",
    "but before we do so , let us say a few words about it",
    ".    it is very natural to apply the lagrange multipliers theorem for maximisation problems under constraints .",
    "however , there are many cases where other techniques are used - for instance in the proof of the existence of projection on a convex set of a hilbert space . in that case ,",
    "geometric arguments , including the parallelogram identity , are used .",
    "many texts suggest thinking of the relative entropy of one probability measure with respect to another as a quantity measuring how much they differ .",
    "moreover , they present some similarities between relative entropy and a metric . unfortunately , they say , this analogy does not go too far .",
    "csiszr s paper pushes these similarities a bit further , showing a relation analogous to the parallelogram identity .",
    "furthermore , he proves the existence of an entropy minimiser under convex constraints by similar arguments that show the existence of projection on convex subsets of hilbert spaces .",
    "we restate here a partial version of his theorem 3.1 sufficient for our purposes .",
    "[ csiszr ] let @xmath129 be a probability on a measurable space @xmath164 .",
    "let @xmath165 be an arbitrary set of real - valued @xmath166-measurable functions on @xmath167 and @xmath168 be real constants .",
    "let @xmath169 be the set of all those probabilities @xmath170 on @xmath171 for which the integrals @xmath172 exist and equal @xmath173 @xmath174 . then",
    ", if there exists @xmath175 such that @xmath176 and its radon - nikodym derivative has the form @xmath177 where @xmath178 and @xmath179 belongs to the linear space spanned by the @xmath180 s , then @xmath181 for all @xmath182 such that @xmath183 .",
    "now we prove that @xmath17 , given by , and , is indeed an entropy maximiser .",
    "let @xmath184 , @xmath132 .",
    "let @xmath74 and @xmath75 be defined by equations and .",
    "then @xmath185 given by @xmath186 maximises @xmath45 on @xmath46 .",
    "set @xmath187 and @xmath188 .",
    "let @xmath152 , @xmath129 , @xmath146 and @xmath149 be as in proposition [ bijection ] .",
    "note that for this choice of @xmath1 , @xmath189 and @xmath190 , we have @xmath191 and @xmath192 .",
    "let @xmath193 , @xmath194 be the @xmath195-algebra of lebesgue measurable subsets of @xmath1 , @xmath196 , @xmath197 ( @xmath198 ) and @xmath169 as in csiszr s theorem .",
    "given @xmath199 , define the measure @xmath200 by @xmath201 . from the definition of @xmath149",
    ", it follows that @xmath202 .",
    "conversely , if @xmath182 and @xmath183 , then @xmath203 . then a simple computation yields @xmath204    by definition of @xmath74 and @xmath75 we have @xmath205 .",
    "proposition [ bijection ] yields @xmath206 .",
    "moreover , @xmath207 for all @xmath138 .",
    "let @xmath208 .",
    "it follows that @xmath175 , and its radon - nikodym derivative with respect to @xmath129 ( which is @xmath209 ) has the form with @xmath210 and @xmath211 .",
    "therefore , csiszr s theorem gives @xmath181 for all @xmath182 such that @xmath183 .",
    "in particular , for all @xmath199 , from we obtain @xmath212    we conclude that @xmath213 maximises @xmath148 on @xmath149 and , again by proposition [ bijection ] , that @xmath17 is a maximiser of @xmath45 on @xmath46 . @xmath40      we have the explicit form of the density given by equation .",
    "this allows us to give formulas in several important cases . to do this ,",
    "we first state two useful results for the following proofs .    for @xmath214 , we have @xmath215 \\nonumber \\\\ & = & \\frac{\\alpha_i}{\\beta_i}(ke^{\\beta_ik } - k_ie^{\\beta_ik_i } ) - \\frac{\\alpha_i}{\\beta_i^2}(e^{\\beta_ik } - e^{\\beta_ik_i } ) .",
    "\\label{k_i - k - mean}\\end{aligned}\\ ] ]    it is straightforward to integrate the density @xmath17 and obtain an explicit form of the probability distribution @xmath216 its inverse can also be expressed analytically , which is a useful feature for monte carlo simulations .",
    "the results are stated in the following proposition .",
    "[ distributionfunction ] suppose @xmath217 .",
    "then @xmath218    given @xmath219 , find @xmath220 such that @xmath221\\tilde d_{i+1 } , \\tilde d_i]$ ] .",
    "then @xmath222    we treat only the case @xmath223 .",
    "the simpler case @xmath224 is left to the reader .",
    "first , notice that @xmath225",
    ". then , using , we get @xmath226    since @xmath227 , we have @xmath228 . therefore solving for @xmath229",
    "concludes the proof . @xmath40",
    "it is also straightforward to express the prices of call and digital options analytically .",
    "[ prices ] given a strike @xmath230 , find @xmath231 such that @xmath214 .",
    "if @xmath223 , then @xmath232    if @xmath224 , then @xmath233    again we prove only the case @xmath223 . from we obtain @xmath234 for the ( undiscounted ) call price we have @xmath235    now putting and into leads to the stated result .",
    "@xmath40    finally , using euler s relationship for homogeneous functions , we can also give an explicit formula for spot - delta .",
    "given a strike @xmath230 , find @xmath231 such that @xmath214 .",
    "let @xmath27 be today s underlying spot price and @xmath236 be the spot - delta of a call with strike @xmath237 maturing at @xmath11 . if @xmath223 , then    @xmath238    if @xmath224 , then @xmath239    again we consider only the case @xmath223 and leave the simpler case @xmath224 for the reader .",
    "let @xmath240 and @xmath241 be , respectively , the discounted prices of call and digital options with strike @xmath237 maturing at @xmath11 , i.e. @xmath242 and @xmath243 , where @xmath244 and @xmath245 are as in proposition [ prices ] .",
    "since @xmath240 is a positively homogeneous function of degree @xmath246 in @xmath247 , from euler s theorem we have @xmath248    recalling that @xmath249 , we can rewrite the last relation as @xmath250 now using and gives the result .",
    "@xmath40    note that the analogous statement for the forward - delta can be obtained by replacing the spot - price with the forward - price in the corollary and proof above .",
    "if we hold a prior belief about the distribution , we can maximise relative entropy instead in order to stay as `` close '' as possible to the prior distribution .",
    "suppose @xmath251 is a probability density for this prior distribution . for @xmath252",
    ", define relative entropy @xmath253 ( the kullback - leibler information number or @xmath1-divergence is given by @xmath254 .",
    "this can be thought of as a measure of distance between two distributions .",
    "for example , @xmath255 , and @xmath256 if and only if @xmath257 .",
    ") we have @xmath258 and essentially the same argument as the one given above shows that the maximum relative entropy density ( mred ) @xmath259 is given by @xmath260 therefore the resulting density @xmath261 is now given by the product of a piecewise exponential density and the prior density .    even in the simple case where the prior density @xmath262 is just log - normal",
    ", we no longer have explicit formulas for call and digital prices .",
    "since we can not separate the two constraints @xmath263 for each @xmath47 as in equations and , we must solve them simultaneously using numerical integration and a two - dimensional root - finder .",
    "however , if the prior density @xmath262 is already given by an med , then @xmath264 and we can solve everything analytically as before .",
    "we also recover explicit formulas for call and digital prices .",
    "buchen and kelly @xcite propose a similar method to find an entropy - maximising density @xmath265 under constraints given by european payoffs .",
    "the case of most interest is where these are the payoff - functions of call options at different strikes @xmath266 and the actual constraints are given by ( undiscounted ) call option prices @xmath267 such that @xmath268 } = \\tilde{c}_i\\ ] ] must hold for all @xmath269 .",
    "the density @xmath265 must therefore satisfy the conditions @xmath270 and @xmath271    to find @xmath265 , they construct the functional @xmath272 where @xmath273 are the lagrange multipliers , and then solve the equation @xmath274 the solution is given by @xmath275 where @xmath276 is a normalising constant .",
    "buchen and kelly show that numerically , finding the parameters @xmath277 is an m - dimensional root - finding problem that can be tackled with the multi - dimensional newton algorithm .",
    "they show how to compute the jacobian , and that it is invertible , by expressing it as a covariance matrix .",
    "if a call option with strike @xmath278 , i.e. the forward , is among the input data , the mean of the distribution is given .",
    "since the total mass , @xmath246 , is also known , we have the two main constraints needed to apply the arguments from subsection [ rigorousproof ] and can therefore also rigorously find the entropy maximiser when only call options are given as input .",
    "of course , the forward should be known in most situations , so that this is certainly the most important case .      similarly ,",
    "if a prior distribution @xmath262 is given , the distribution maximising relative entropy under the same constraints is given by @xmath279 where @xmath280 is again the normalising constant .",
    "in this section we give some numerical examples for the entropy maximisers described so far .",
    "we suppose that the market data is given by @xmath281 we assume a flat volatility and make no skew correction when calculating the digital prices in this scenario .",
    "we calculate three densities using strikes    * @xmath282 * @xmath283 * @xmath284    lllllllllll + strike & 0.00 & 20.00 & 40.00 & 60.00 & 80.00 & 100.00 & 120.00 & 140.00 & 160.00 & 180.00 + call & 100.0000 & 80.0000 & 60.0005 & 40.1454 & 22.2656 & 9.9477 & 3.7059 & 1.2139 & 0.3659 & 0.1049 + digital & 1.0000 & 1.0000 & 0.9998 & 0.9725 & 0.7786 & 0.4503 & 0.1965 & 0.0707 & 0.0225 & 0.0066 +   + entropy & 4.6714 + @xmath285 & 1.3582e-04 & n / a & n / a & n / a & n / a & 1.8835 & n / a & n / a & n / a & n / a + @xmath81 & 0.0539 & n / a & n / a & n / a & n / a & -0.0453 & n / a & n / a & n / a & n / a + call & 100.0000 & 80.0402 & 60.2562 & 40.9886 & 23.2384 & 9.9477 & 4.0232 & 1.6271 & 0.6581 & 0.2661 + implied vol . &",
    "n / a & 62.13% & 46.26% & 36.17% & 28.88% & 25.00% & 25.95% & 27.04% & 27.84% & 28.41% + digital & 1.0000 & 0.9951 & 0.9808 & 0.9386 & 0.8146 & 0.4503 & 0.1821 & 0.0736 & 0.0298 & 0.0120 +   + entropy & 4.6143 + @xmath285 & 6.0682e-08 & n / a & n / a & 0.0016 & n / a & 0.5397 & n / a & 14.2333 & n / a & n / a + @xmath81 & 0.1894 & n / a & n / a & 0.0255 & n / a & -0.0343 & n / a & -0.0582 & n / a & n / a + call & 100.0000 & 80.0001 & 60.0033 & 40.1454 & 22.4905 & 9.9477 & 3.7539 & 1.2139 & 0.3790 & 0.1183 + implied vol . & n / a & 38.76% & 28.60% & 25.00% & 25.93% & 25.00% & 25.14% & 25.00% & 25.15% & 25.38% + digital & 1.0000 & 1.0000 & 0.9994 & 0.9725 & 0.7765 & 0.4503 & 0.1978 & 0.0707 & 0.0221 & 0.0069 +   + entropy & 4.6076 + @xmath285 & 6.0682e-08 & n / a & n / a & 1.5393e-04 & 0.0129 & 0.2389 & 1.6987 & 14.2333 &",
    "n / a & n / a + @xmath81 & 0.1894 & n / a & n / a & 0.0584 & 0.0027 & -0.0268 & -0.0433 & -0.0582 & n / a & n / a + call & 100.0000 & 80.0001 & 60.0033 & 40.1454 & 22.2656 & 9.9477 & 3.7059 & 1.2139 & 0.3790 & 0.1183 + implied vol . &",
    "n / a & 38.76% & 28.60% & 25.00% & 25.00% & 25.00% & 25.00% & 25.00% & 25.15% & 25.38% + digital & 1.0000 & 1.0000 & 0.9994 & 0.9725 & 0.7765 & 0.4503 & 0.1978 & 0.0707 & 0.0221 & 0.0069 +    table [ tab:1 ] gives the ( undiscounted ) option prices we used and the parameters describing the density .     and",
    "three maximum entropy densities obtained by calibrating to @xmath246 , @xmath286 and @xmath287 strikes . ]",
    "figure [ fig:2 ] shows the three densities and the actual log - normal density .",
    "it can be seen that already with @xmath287 strikes and the forward , the fit of the piecewise - exponential distribution to the log - normal distribution is very good .    in practice , however , implied volatilities are not flat as in the example above , i.e. they are not the same for different strikes and maturities .",
    "this is discussed in detail in gatheral s book @xcite , in particular in the section `` the spx implied volatility surface '' in chapter 3 . we show that our method has by its nature a tendency to give good fits to observed volatility surfaces . to do this",
    ", we will assume that we now only have at - the - money ( atm ) option prices , and that already with this minimal amount of market data our method generates a very realistic looking volatility surface .",
    "we show in figure [ fig:3 ] the implied volatility surface obtained by using just the atm strike .",
    "more precisely , if we assume @xmath288 and @xmath289 again , then the atm strike is @xmath290 .",
    "moreover , we consider a constant atm volatility @xmath291 ( it could of course be time dependent ) . for each maturity @xmath292",
    ", we compute the black - scholes prices of the atm call @xmath293 and atm digital @xmath294 . then applying the maximum entropy approach to just one strike @xmath295 , we compute @xmath74 and @xmath75 for @xmath296 . in other terms",
    ", we recover the maximum entropy density of @xmath18 compatible with @xmath297 , @xmath293 and @xmath294 .",
    "we emphasise that no other strike , call or digital is used in this calibration .",
    "according to the med , the price of a call with strike @xmath237 and maturity @xmath11 is given by @xmath298 , where @xmath299 is given in proposition [ prices ] .",
    "from @xmath300 we recover the implied volatility @xmath301 with a bisection root - finder from the black - scholes formula .",
    "readers interested in a more robust method can consult the one proposed in @xcite .    as expected , as a consequence of calibration , @xmath302 .",
    "what is surprising is the fact that the curve @xmath303 has a profile very similar to smile curves typically seen in equity markets .",
    "now , by varying @xmath11 one constructs a volatility surface which , again , is qualitatively very similar to those observed in equity markets .",
    "the maximum entropy method seems to be able to transform just one volatility number from a flat black - scholes ( atm ) world into a very realistic looking volatility surface , with important features such as a strongly pronounced smile at the short end that decays as the maturity increases .",
    "different strikes and different numbers of option prices can of course be used at different maturities , so that any arbitrage - free option data can easily be converted into an implied volatility surface .",
    "the density @xmath17 is usually discontinuous at the @xmath30 s .",
    "the distribution function is of course continuous .",
    "many monte carlo models work by drawing a random uniform variable and inverting the distribution . in black - scholes type models , for example , a normal distribution has to be inverted at some stage . in our case , only one logarithm needs to be taken , a circumstance which accelerates a simulation .",
    "let the prior distribution be a log - normal distribution with fixed volatility parameter @xmath195 @xmath304 we still have an explicit form of the density , namely @xmath261 , where @xmath17 is a piecewise exponential density , although the parameters @xmath305 are of course different from the parameters @xmath306 used for the med of the previous subsection . since we are now unable to express call prices analytically , we calculate them via numerical integration .",
    "lllllll strike & 0.00 & 60.00 & 80.00 & 100.00 & 120.00 & 140.00 +   + @xmath307 & 12.2600 & n / a & n / a & 0.0833 & n / a & n / a + @xmath308 & -0.0298 & n / a & n / a & 0.0206 & n / a & n / a +   + @xmath307 & 11.2900 & 7.2379 &",
    "n / a & 0.2930 & n / a & 0.3267 + @xmath308 & -0.0194 & -0.0237 & n / a & 0.0098 & n / a & 0.0116 +   + @xmath307 & 11.2900 & 5.9910 & 2.0430 & 0.5970 & 0.5815 & 0.3267 + @xmath308 & -0.0194 & -0.0210 & -0.0097 & 0.0031 & 0.0047 & 0.0116 +    table [ tab:2 ] gives the parameters describing the density .",
    "of course , should a prior density already meet the constraints , we will have @xmath309 and @xmath310 for all @xmath311 .    , actual log - normal density with @xmath312 and three maximum relative entropy densities obtained by calibrating to @xmath246 , @xmath286 and @xmath287 strikes . ]",
    "figure [ fig:4 ] shows the three maximum relative entropy densities and the prior log - normal density ( @xmath313 ) .",
    "the density for the forward and one call is already much closer to the actual one than in the previous case , so that convergence is not as pronounced as before when the number of strikes is increased .",
    "we see that @xmath17 has the effect of pushing the prior density downwards and widening it as to be closer to the actual density .",
    "the explicit form of the density given by equation allows one to obtain analytic expressions for call and digital prices like those in proposition [ prices ] . as an example , using just the forward and an at - the - money call , i.e. @xmath314 , we obtained @xmath315 on our computer .",
    "this leads to a very similar volatility smile as the one given at @xmath316 in subsection [ med - cd ] above .",
    "we refer to @xcite for graphs and numerical data regarding this distribution .      as in subsection [ relmed - cd ] ,",
    "in general there will be no analytic expressions for call or digital prices .",
    "if the chosen prior distribution is continuous , then the resulting relative entropy maximiser will also be continuous .",
    "again , we advise the reader to look at @xcite for graphs and numerical data regarding this distribution .",
    "digital options are traded on the chicago board option exchange ( cboe ) .",
    "they are called _ binary options _ there .",
    "we quote the following paragraph from the `` binaries '' product description @xcite :    `` cboe offers binary options on the s&p 500 index ( spx ) and the cboe volatility index ( vix ) .",
    "the ticker symbols for these binary contracts is bsz and bvz respectively .",
    "expiration dates and settlement values are the same as for traditional options . ''",
    "the specification that digital option strikes and maturities are the same as those of call options is exactly what we need for our setup .",
    "we calibrate to cboe option prices from 10 april 2010 for two different maturities .",
    "the first maturity is 18 september 2010 .",
    "we have digital option bid and ask quotes for strikes @xmath237 from @xmath317 to @xmath318 usd , usually in steps of @xmath319 usd .",
    "we also have call option bid and ask quotes for these same strikes .",
    "we calibrate to the `` mid '' prices , i.e. the average of the bid and ask quotes , at the ten strikes from @xmath317 to @xmath318 in steps of @xmath320 usd .",
    "rrrrrrr & & & + strike & digital & call & digital & call & digital & call + 950 & 0.9400 & 246.30 & 0.9259 & 246.30 & 0.9400 & 246.30 + 975 & 0.9150 & 223.20 & 0.9171 & 223.25 & 0.9153 & 223.12 + 1000 & 0.8950 & 200.50 & 0.9014 & 200.50 & 0.8950 & 200.50 + 1025 & 0.8750 & 178.15 & 0.8787 & 178.24 & 0.8795 & 178.30 + 1050 & 0.8550 & 156.60 & 0.8516 & 156.60 & 0.8550 & 156.60 + 1075 & 0.8150 & 135.70 & 0.8191 & 135.70 & 0.8195 & 135.65 + 1100 & 0.7750 & 115.70 & 0.7802 & 115.70 & 0.7750 & 115.70 + 1125 & 0.7250 & 96.75 & 0.7336 & 96.76 & 0.7367 & 96.76 + 1150 & 0.6700 & 79.10 & 0.6776 & 79.10 & 0.6700 & 79.10 + 1175 & 0.6050 & 63.00 & 0.6117 & 62.97 & 0.6137 & 63.01 + 1200 & 0.5350 & 48.60 & 0.5357 & 48.60 & 0.5350 & 48.60 + 1225 & 0.4550 & 36.25 & 0.4541 & 36.23 & 0.4585 & 36.13 + 1250 & 0.3550 & 25.90 & 0.3720 & 25.90 & 0.3550 & 25.90 + 1300 & 0.1850 & 11.35 & 0.2112 & 11.35 & 0.1850 &",
    "11.35 + 1350 & 0.0700 & 4.10 & 0.0896 & 4.10 & 0.0700 & 4.10 + 1400 & 0.0450 & 1.33 & 0.0307 & 1.33 & 0.0450 & 1.33 +    table [ tab:3 ] shows cboe prices for call and digital options on the spx from 10 april 2010 in columns 2 and 3 .",
    "columns 4 and 5 show option prices obtained by calibrating an med to call prices at strikes @xmath317 , @xmath321 , @xmath322 , @xmath323 , @xmath318 .",
    "columns 6 and 7 show option prices obtained by calibrating an med to call and digital prices at the same strikes .",
    "note that the second med matches market call _ and _ digital prices at the strikes calibrated to exactly , whereas the first med matches only the call prices .",
    "the second maturity is 31 december 2010 .",
    "we have call option bid and ask quotes for strikes @xmath237 from @xmath324 to @xmath325 usd in steps of @xmath320 usd .",
    "we do not have any digital option quotes for this maturity . as a substitute ,",
    "we calculate symmetric call spread prices @xmath326 using mid call prices .",
    "we calibrate to this data at the three strikes @xmath327 . in the previous example",
    ", we showed that our method can be used to calibrate to quotes at many ( @xmath328 ) strikes , and that this leads to a very good fit . in this example , we calibrate to only a small number ( @xmath286 ) of strikes in order to show that our method has an excellent natural tendency to fit a market smile .",
    "the call spread prices @xmath329 needed for are obtained by using the call quotes at @xmath330 .    [ tab:4 ]    rrrrrrrrr & & & & + & & & & + strike & call & implied vol . & call & implied vol . & call & implied vol . & call & implied vol .",
    "+ 500 & 681.15 & 62.90% & 678.87 & 59.45% & 677.05 & 56.22% & 679.66 & 60.70% + 550 & 631.75 & 57.19% & 630.27 & 55.25% & 628.62 & 52.84% & 630.92 & 56.12% + 600 & 582.35 & 51.94% & 581.72 & 51.22% & 580.41 & 49.63% & 582.18 & 51.75% + 650 & 533.45 & 47.55% & 533.22 & 47.32% & 532.44 & 46.53% & 533.45 & 47.55% + 700 & 484.75 & 43.52% & 484.75 & 43.52% & 484.75 & 43.52% & 484.75 & 43.52% + 750 & 436.55 & 39.99% & 436.54 & 39.98% & 437.36 & 40.59% & 436.55 & 39.99% + 800 & 388.85 & 36.77% & 388.90 & 36.81% & 390.39 & 37.75% & 388.97 & 36.85% + 850 & 341.85 & 33.85% & 342.02 & 33.95% & 343.97 & 35.01% & 342.11 & 34.00% + 900 & 295.95 & 31.28% & 296.11 & 31.36% & 298.32 & 32.39% & 296.20 & 31.40% + 950 & 251.25 & 28.89% & 251.49 & 28.99% & 253.72 & 29.88% & 251.55 & 29.01% + 1000 & 208.25 & 26.70% & 208.54 & 26.80% & 210.56 & 27.50% & 208.54 & 26.80% + 1050 & 167.50 & 24.68% & 167.76 & 24.76% & 169.36 & 25.25% & 167.72 & 24.75% + 1100 & 129.70 & 22.82% & 129.84 & 22.86% & 130.87 & 23.15% & 129.77 & 22.84% + 1150 & 95.60 & 21.09% & 95.64 & 21.10% & 96.06 & 21.21% & 95.60 & 21.09% + 1200 & 66.30 & 19.52% & 66.30 & 19.52% & 66.30 & 19.52% & 66.30 & 19.52% + 1250 & 42.70 & 18.13% & 43.09 & 18.24% & 42.93 & 18.20% & 42.70 & 18.13% + 1300 & 25.10 & 16.91% & 25.83 & 17.13% &",
    "25.61 & 17.06% & 25.19 & 16.93% + 1350 & 13.35 & 15.87% & 13.79 & 16.05% & 13.63 & 15.99% & 13.35 & 15.87% + 1400 & 6.35 & 15.01% & 6.35 & 15.01% & 6.35 & 15.01% & 6.35 & 15.01% + 1450 & 2.68 & 14.27% & 2.74 & 14.34% & 2.83 & 14.43% & 2.68 & 14.27% + 1500 & 1.13 & 13.91% & 1.18 & 14.02% & 1.26 & 14.16% & 1.08 & 13.82% + 1550 & 0.43 & 13.57% & 0.51 & 13.88% & 0.56 & 14.05% & 0.43 & 13.59% + 1600 & 0.20 & 13.69% & 0.22 & 13.83% & 0.25 & 14.03% & 0.17 & 13.49% +    table [ tab:4 ] shows cboe prices for call options on the spx from 10 april 2010 and their implied volatilities in columns 2 and 3 .",
    "columns 4 and 5 show call option prices and implied volatilities obtained by calibrating an med to call prices at strikes @xmath331 , @xmath332 , @xmath318 .",
    "columns 6 and 7 show call option prices and implied volatilities obtained by calibrating an med to call and digital prices at the same strikes , using call spread prices at @xmath333 , @xmath334 , @xmath335 as substitutes for the digital prices .",
    "columns 8 and 9 show call option prices and implied volatilities obtained by calibrating an med to call and digital prices at all nine strikes .",
    "of course the med obtained using calls and digitals at three strikes uses more `` information '' than the med obtained using just calls at three strikes .",
    "it is therefore not surprising that it leads to a better fit .",
    "however , to show that this fit is already very good , we also report the med obtained from call prices at all nine strikes used in this example .",
    "figure [ fig:5 ] illustrates graphically that these last two med s are indeed very close to each other .    .",
    "in most situations the information observed in the market regarding an asset consists of option prices at a discrete set of strikes . using this to extrapolate the second derivative of a function everywhere , as suggested by breeden and litzenberger @xcite or the volatility approach @xcite , @xcite , relies on additional assumptions about the distribution of returns , the sde the asset follows and/or the choice of an interpolation method .",
    "even when there are strong reasons for such assumptions , we believe that it is important to know the shape of the distribution function given by the principle of maximum entropy ( pme ) in case these assumptions turn out to be flawed .    in the local volatility model call prices for all strikes in @xmath336 are needed , and , additionally , it assumes that the smile volatility is twice continuously differentiable .",
    "hence this approach requires an infinity of non - quoted prices together with a strong regularity .",
    "`` since the market provides call prices at only a small number of strike prices , the second derivative must be estimated by interpolation .",
    "this method is not very robust as the results are very sensitive to the interpolation scheme used . ''",
    "@xcite    for the method proposed here , if there are no observable digital quotes in the market , the `` artificial '' data required consists only of digital prices for a finite , usually small , set of strikes @xmath337 . if one assumes ( and our approach does not ) that the volatility smile is differentiable with respect to the strike at the points of @xmath338 , then prescribing digital prices there is indeed equivalent to prescribing the value of the smile derivative at those points .",
    "this is still a much weaker requirement than that of the local volatility model .",
    "moreover , the example in section [ spx - calibration ] shows that centered call spread prices are very good estimators for digital prices .",
    "entropy has been one of the main concepts in information theory @xcite , and since market participants react to information when taking their positions , we believe entropy is a very natural tool for use in finance .",
    "entropy can be seen as a measure of how unbiased a probability distribution is .",
    "hence , by maximising entropy , what we propose is to find the most unbiased probability distribution which agrees with information provided from the market .",
    "we then show how this hypothesis leads to a piecewise exponential density .",
    "the method we propose can be used reliably and efficiently in practice . on the one hand",
    ", we have seen that it produces a remarkably realistic volatility surface from just one volatility number as in the original black - scholes model , with a steep skew for short maturities that decays with increasing maturity . on the other hand ,",
    "if the actual distribution is known , then with option prices given at five or more strikes , the fit to it is very close . in particular",
    ", it can be used as a robust interpolation method for volatility curves .",
    "if additionally there is knowledge of a prior distribution , the principle of maximum relative entropy can be applied to find a density that takes this into account and also meets the new constraints .",
    "we give an example of such a scenario with two log - normal distributions , and show that the convergence to the actual distribution is particularly quick .",
    "buchen and kelly have proposed a similar method of finding a probability density that maximises entropy when the market data consists only of call options .",
    "the density they obtain is continuous .",
    "however , to find its parameters they must solve a multi - dimensional root - finding problem with the newton - raphson algorithm .",
    "one criticism often raised in this application of the pme is that the method of finding the form of the density uses lagrange multipliers and is not rigorous .",
    "indeed , this technique works well in practice and leads to the correct form , but we also give a complete mathematical proof that avoids them .",
    "relative entropy has often been compared to a metric for probability distributions .",
    "our proof uses results by csiszr that give additional insights into `` distances '' between distributions and establish remarkable `` geometric '' results .",
    "since we have an explicit form of the density , we are able to give analytical formulas for the distribution , inverse distribution , and call and digital option prices . using euler s relation for homogeneous functions , we give formulas for spot- and forward - deltas .",
    "we also include two examples in which we calibrate to real market data from the cboe .",
    "we show that our method performs very well in both cases and compare our results to those obtained by using buchen and kelly s approach .",
    "cassio neri currently works as quantitative analyst for lloyds banking group in london .",
    "lorenz schneider is assistant professor in quantitative finance at emlyon business school in lyon .",
    "they have ph.d.s in mathematics from universities paris ix and vi , respectively ."
  ],
  "abstract_text": [
    "<S> we obtain the maximum entropy distribution for an asset from call and digital option prices . a rigorous mathematical proof of its existence and exponential form is given , which can also be applied to legitimise a formal derivation by buchen and kelly @xcite . </S>",
    "<S> we give a simple and robust algorithm for our method and compare our results to theirs . </S>",
    "<S> we present numerical results which show that our approach implies very realistic volatility surfaces even when calibrating only to at - the - money options . </S>",
    "<S> finally , we apply our approach to options on the s&p 500 index .    </S>",
    "<S> * keywords : * entropy @xmath0 information theory @xmath0 @xmath1-divergence @xmath0 asset distribution @xmath0 option pricing @xmath0 volatility smile    * mathematics subject classification ( 2000 ) : * 91b24 @xmath0 91b28 @xmath0 91b70 @xmath0 94a17 * jel : * c16 @xmath0 c63 @xmath0 g13 </S>"
  ]
}