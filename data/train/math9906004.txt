{
  "article_text": [
    "we will start by recalling from @xcite how to define intersection numbers in the algebraic setting .",
    "we will connect this with the natural topological idea of intersection number already discussed in the introduction .",
    "consider two simple closed curves @xmath1 and @xmath2 on a closed orientable surface @xmath0 . as in @xcite , it will be convenient to assume that @xmath1 and @xmath2 are shortest geodesics in some riemannian metric on @xmath0 so that they automatically intersect minimally .",
    "we will interpret the intersection number of @xmath1 and @xmath2 in suitable covers of @xmath28 , exactly as in @xcite and @xcite .",
    "let @xmath12 denote @xmath29 , let @xmath13 denote the infinite cyclic subgroup of @xmath12 carried by @xmath1 , and let @xmath30 denote the cover of @xmath0 with fundamental group equal to @xmath13 .",
    "then @xmath1 lifts to @xmath30 and we denote its lift by @xmath1 again .",
    "let @xmath31 denote the pre - image of this lift in the universal cover @xmath32 of @xmath0 .",
    "the full pre - image of @xmath1 in @xmath33 consists of disjoint lines which we call @xmath1lines , which are all translates of @xmath31 by the action of @xmath12 .",
    "( note that in this paper groups act on the left on covering spaces . )",
    "similarly , we define @xmath11 , @xmath34 , the line @xmath35 and @xmath2lines in @xmath32 .",
    "now we consider the images of the @xmath1lines in @xmath34 .",
    "each @xmath1line has image in @xmath34 which is a line or circle",
    ". then we define @xmath36 to be the number of images of @xmath1lines in @xmath37 which meet @xmath2 .",
    "similarly , we define @xmath38 to be the number of images of @xmath2lines in @xmath30 which meet @xmath1 .",
    "it is shown in @xcite , using the assumption that @xmath1 and @xmath2 are shortest closed geodesics , that each @xmath1line in @xmath34 crosses @xmath2 at most once , and similarly for @xmath2lines in @xmath30 .",
    "it follows that @xmath36 and @xmath38 are each equal to the number of points of @xmath39 , and so they are equal to each other .    we need to take one further step in abstracting the idea of intersection number .",
    "as the stabiliser of @xmath31 is @xmath13 , the @xmath1lines naturally correspond to the cosets @xmath40 of @xmath13 in @xmath12 .",
    "hence the images of the @xmath1lines in @xmath41 naturally correspond to the double cosets @xmath42 .",
    "thus we can think of @xmath36 as the number of double cosets @xmath42 such that @xmath43 crosses @xmath35 .",
    "this is the idea which we generalise to define intersection numbers in a purely algebraic setting .",
    "first we need some terminology .",
    "two sets @xmath44 and @xmath45 are _ almost equal _ if their symmetric difference @xmath46 is finite .",
    "we write @xmath47    if a group @xmath12 acts on the right on a set @xmath48 , a subset @xmath44 of @xmath48 is _ almost invariant _ if @xmath49 for all @xmath50 in @xmath12 . an almost invariant subset @xmath44 of @xmath48 is _ non - trivial _ if @xmath44 and its complement @xmath51 are both infinite .",
    "the complement @xmath51 will be denoted simply by @xmath52 , when @xmath48 is clear from the context    for finitely generated groups , these ideas are closely connected with the theory of ends of groups via the cayley graph @xmath53 of @xmath12 with respect to some finite generating set of @xmath12 .",
    "( note that @xmath12 acts on its cayley graph on the left . ) using @xmath54 as coefficients , we can identify @xmath55cochains and @xmath3cochains on @xmath53 with sets of vertices or edges .",
    "a subset @xmath44 of @xmath12 represents a set of vertices of @xmath53 which we also denote by @xmath44 , and it is a beautiful fact , due to cohen @xcite , that @xmath56 is an almost invariant subset of @xmath12 if and only if @xmath57 is finite , where @xmath58 is the coboundary operator . now @xmath53 has more than one end if and only if there is an infinite subset @xmath44 of @xmath12 such that @xmath59 is finite and @xmath52 is also infinite . thus @xmath53 has more than one end if and only if @xmath12 contains a non - trivial almost invariant subset . if @xmath13 is a subgroup of @xmath12 , we let @xmath26 denote the set of cosets @xmath60 of @xmath13 in @xmath12 , ie , the quotient of @xmath12 by the left action of @xmath13",
    "of course , @xmath12 will no longer act on the left on this quotient , but it will still act on the right .",
    "thus we also have the idea of an almost invariant subset of @xmath26 , and the graph @xmath61 has more than one end if and only if @xmath26 contains a non - trivial almost invariant subset .",
    "now the number of ends @xmath62 of @xmath12 is equal to the number of ends of @xmath53 , so it follows that @xmath63 if and only if @xmath64 contains a non - trivial almost invariant subset .",
    "similarly , the number of ends @xmath65 of the pair @xmath66 equals the number of ends of @xmath67 , so that @xmath68 if and only if @xmath26 contains a non - trivial almost invariant subset .",
    "now we return to the simple closed curves @xmath1 and @xmath2 on the surface @xmath0 . pick a generating set for @xmath12 which can be represented by a bouquet of circles embedded in @xmath0 .",
    "we will assume that the wedge point of the bouquet does not lie on @xmath1 or @xmath2 .",
    "the pre - image of this bouquet in @xmath32 will be a copy of the cayley graph @xmath53 of @xmath12 with respect to the chosen generating set .",
    "the pre - image in @xmath30 of the bouquet will be a copy of the graph @xmath61 , the quotient of @xmath53 by the action of @xmath13 on the left . consider the closed curve @xmath1 on @xmath30 .",
    "let @xmath44 denote the set of all vertices of @xmath61 which lie on one side of @xmath1 .",
    "then @xmath44 has finite coboundary , as @xmath57 equals exactly the edges of @xmath61 which cross @xmath1 .",
    "hence @xmath44 is an almost invariant subset of @xmath26 .",
    "let @xmath69 denote the pre - image of @xmath44 in @xmath70 , so that @xmath69 equals the set of vertices of @xmath53 which lie on one side of the line @xmath31 .",
    "now finally the connection between the earlier arguments and almost invariant sets can be given .",
    "for we can decide whether the lines @xmath31 and @xmath35 cross by considering instead the sets @xmath69 and @xmath71 .",
    "the lines @xmath31 and @xmath35 together divide @xmath12 into the four sets @xmath72 , @xmath73 , @xmath74 and @xmath75 , where @xmath76 denotes @xmath77 , and @xmath31 crosses @xmath35 if and only if each of these four sets projects to an infinite subset of @xmath78    now let @xmath12 be a group with subgroups @xmath13 and @xmath11 , let @xmath44 be a non - trivial almost invariant subset of @xmath26 and let @xmath45 be a non - trivial almost invariant subset of @xmath79 .",
    "we will define the intersection number @xmath80 of @xmath44 and @xmath45 .",
    "first we need to consider the analogues of the sets @xmath81and @xmath71 in the preceding paragraph , and to say what it means for them to cross .",
    "if @xmath12 is a group and @xmath13 is a subgroup , then a subset @xmath69 of @xmath12 is @xmath13__-almost invariant _ _",
    "if @xmath69 is invariant under the left action of @xmath13 , and simultaneously @xmath82 is an almost invariant subset of @xmath83 .",
    "in addition , @xmath69 is a _ non - trivial _",
    "@xmath13almost invariant subset of @xmath12 , if the quotient sets @xmath82 and @xmath84 are both infinite .    note that if @xmath13 is trivial , then a @xmath13almost invariant subset of @xmath64 is the same as an almost invariant subset of @xmath12 .",
    "let @xmath69 be a @xmath13almost invariant subset of @xmath12 and let @xmath71 be a @xmath11almost invariant subset of @xmath12 .",
    "we will say that @xmath69 _ crosses _ @xmath71 if each of the four sets @xmath72 , @xmath85 , @xmath74 and @xmath86 projects to an infinite subset of @xmath78    we will often write @xmath87 instead of listing the four sets @xmath72 , @xmath85 , @xmath74 and @xmath88    if @xmath12 is a group and @xmath13 is a subgroup , then we will say that a subset @xmath89 of @xmath12 is @xmath13_finite _ if it is contained in the union of finitely many left cosets @xmath60 of @xmath13 in @xmath12 , and we will say that two subsets @xmath90 and @xmath89 of @xmath12 are @xmath13_almost equal _ if their symmetric difference is @xmath13finite .    in this language , @xmath69 crosses @xmath71 if each of the four sets @xmath91 is not @xmath11finite .",
    "this definition of crossing is not symmetric , but it is shown in @xcite that if @xmath12 is a finitely generated group with subgroups @xmath13 and @xmath11 , and @xmath69 is a non - trivial @xmath13almost invariant subset of @xmath12 and @xmath71 is a non - trivial @xmath11almost invariant subset of @xmath12 , then @xmath69 crosses @xmath71 if and only if @xmath71 crosses @xmath69 .",
    "if @xmath69 and @xmath71 are both trivial , then neither can cross the other , so the above symmetry result is clear .",
    "however , this symmetry result fails if only one of @xmath69 or @xmath71 is trivial .",
    "this lack of symmetry will not concern us as we will only be interested in non - trivial almost invariant sets .",
    "now we come to the definition of the intersection number of two almost invariant sets .",
    "[ defnofintersectionnumber]let @xmath13 and @xmath11 be subgroups of a finitely generated group @xmath12 .",
    "let @xmath44 denote a non - trivial almost invariant subset of @xmath26 , let @xmath45 denote a non - trivial almost invariant subset of @xmath92 and let @xmath69 and @xmath71 denote the pre - images of @xmath44 and @xmath45 respectively in @xmath12 .",
    "then the intersection number @xmath80 of @xmath44 and @xmath45 equals the number of double cosets @xmath42 such that @xmath93 crosses @xmath94    [ almostequalsetshavesameintersectionnumber]the following facts about the intersection number are proved in @xcite .    1",
    ".   intersection numbers are symmetric , ie @xmath95 .",
    "@xmath80 is finite when @xmath12 , @xmath13 , and @xmath11 are all finitely generated .",
    "if @xmath96 is an almost invariant subset of @xmath26 which is almost equal to @xmath44 or to @xmath52 and if @xmath97 is an almost invariant subset of @xmath79 which is almost equal to @xmath45 or to @xmath98 , then @xmath99    we will often be interested in situations where @xmath69 and @xmath71 do not cross each other and neither do many of their translates .",
    "this means that one of the four sets @xmath87 is @xmath11finite , and similar statements hold for many translates of @xmath81and @xmath71 .",
    "if @xmath100 and @xmath101 do not cross , then one of the four sets @xmath102 is @xmath103finite , but probably not @xmath11finite .",
    "thus one needs to keep track of which translates of @xmath69 and @xmath71 are being considered in order to have the correct conjugate of @xmath11 , when formulating the condition that @xmath104 and @xmath90 do not cross .",
    "the following definition will be extremely convenient because it avoids this problem , thus greatly simplifying the discussion at certain points .",
    "let @xmath104 be a @xmath13almost invariant subset of @xmath12 and let @xmath90 be a @xmath11almost invariant subset of @xmath12 .",
    "we will say that @xmath105 is _ small _ if it is @xmath13finite .",
    "as the terminology is not symmetric in @xmath104 and @xmath90 and makes no reference to @xmath13 or @xmath11 , some justification is required . if @xmath104 is also @xmath106almost invariant for a subgroup @xmath106 of @xmath12 , then @xmath106 must be commensurable with @xmath13 .",
    "thus @xmath105 is @xmath13finite if and only if it is @xmath106finite .",
    "in addition , the fact that crossing is symmetric tells us that @xmath105 is @xmath13finite if and only if it is @xmath11finite .",
    "this provides the needed justification of our terminology .",
    "finally , the reader should be warned that this use of the word small has nothing to do with the term small group which means a group with no subgroups which are free of rank @xmath107 .    at this point",
    "we have the machinery needed to define the intersection number of two splittings .",
    "this definition depends on the fact , which we recall from @xcite , that if a group @xmath12 has a splitting over a subgroup @xmath13 , there is a @xmath13almost invariant subset @xmath69 of @xmath12 associated to the splitting in a natural way .",
    "this is entirely clear from the topological point of view as follows .",
    "if @xmath108 , let @xmath109 denote a space with fundamental group @xmath12 constructed in the usual way as the union of @xmath110 , @xmath111 and @xmath112 . if @xmath113 , then @xmath109 is constructed from @xmath110 and @xmath112 only . now let @xmath114 denote the based cover of @xmath109 with fundamental group @xmath13 , and denote the based lift of @xmath115 into @xmath114 by @xmath112",
    ". then @xmath69 corresponds to choosing one side of @xmath112 in @xmath114 .",
    "we now give a purely algebraic description of this choice of @xmath69 ( see @xcite for example ) .",
    "if @xmath108 , choose right transversals @xmath116 , @xmath117 of @xmath118 in @xmath119 , @xmath120 , both of which contain the identity element .",
    "( a right transversal for a subgroup @xmath13 of a group @xmath12 consists of one representative element for each right coset @xmath40 of @xmath13 in @xmath121 each element of @xmath12 can be expressed uniquely in the form @xmath122 with @xmath123 , @xmath124 , @xmath125 , where only @xmath126 , @xmath127 and @xmath128 are allowed to be trivial .",
    "then @xmath69 consists of elements for which @xmath127 is non - trivial . in the case of a hnn ",
    "extension @xmath18 , let @xmath129 , @xmath130 , @xmath107 , denote the two inclusions of @xmath13 in @xmath119 so that @xmath131 , and choose right transversals @xmath132 of @xmath133 in @xmath119 , both of which contain the identity element .",
    "each element of @xmath12 can be expressed uniquely in the form @xmath134 where @xmath135 lies in @xmath119 and , for @xmath136 , @xmath137 or @xmath138 , @xmath139 if @xmath137 , @xmath140 if @xmath141 and moreover @xmath142 if @xmath143 . in this case , @xmath69 consists of elements for which @xmath127 is trivial and @xmath144 . in both cases ,",
    "the stabiliser of @xmath69 under the left action of @xmath12 is exactly @xmath13 and , for every @xmath145 , at least one of the four sets @xmath146 is empty .",
    "note that this is equivalent to asserting that one of the four inclusions @xmath147 , @xmath148 , @xmath149 , @xmath150 holds",
    ".    the following terminology will be useful .",
    "a collection @xmath151 of subsets of @xmath12 which are closed under complementation is called _ nested _ if for any pair @xmath104 and @xmath90 of sets in the collection , one of the four sets @xmath102 is empty .",
    "if each element @xmath104 of @xmath151 is a @xmath152almost invariant subset of @xmath12 for some subgroup @xmath152 of @xmath12 , we will say that @xmath151 is _ _ almost nested  _",
    "_ if for any pair @xmath104 and @xmath90 of sets in the collection , one of the four sets @xmath102 is small .",
    "the above discussion shows that the translates of @xmath69 and @xmath153 under the left action of @xmath12 are nested .",
    "note that @xmath69 is not uniquely determined by the splitting . in both cases",
    ", we made choices of transversals , but it is easy to see that @xmath69 is independent of the choice of transversal .",
    "however , in the case when @xmath108 , we chose @xmath69 to consist of elements for which @xmath127 is non - trivial whereas we could equally well have reversed the roles of @xmath119 and @xmath120 .",
    "this would simply replace @xmath69 by @xmath154 .",
    "also either of these sets could be replaced by its complement .",
    "we will use the term _ standard almost invariant set _ for the images in @xmath26 of any one of @xmath69 , @xmath155 , @xmath153 , @xmath154 . in the case when @xmath113 , reversing the roles of the two inclusion maps of @xmath13 into @xmath119 also replaces @xmath69 by @xmath154 .",
    "again we have four standard almost invariant sets which are the images in @xmath83 of any one of @xmath69 , @xmath155 , @xmath153 , @xmath154 .",
    "there is a subtle point here . in the amalgamated free product case",
    ", we use the obvious isomorphism between @xmath17 and @xmath156 . in the hnn case ,",
    "let us write @xmath157 to denote the group @xmath158 .",
    "then the correct isomorphism to use between @xmath159 and @xmath160 is not the identity on @xmath119 .",
    "instead it sends @xmath161 to @xmath162 and @xmath119 to @xmath163 . in all cases",
    ", we have four standard almost invariant subsets of @xmath164    [ defnofintersectionnumberofsplittings]if a group @xmath12 has splittings over subgroups @xmath13 and @xmath11 , and if @xmath44 and @xmath45 are standard almost invariant subsets of @xmath26 and @xmath79 respectively associated to these splittings , then the _ intersection number _ of this pair of splittings of @xmath12 is the intersection number of @xmath44 and @xmath165    [ xgisequivalenttox]as any two of the four standard almost invariant subsets of @xmath26 associated to a splitting of @xmath12 over @xmath13 are almost equal or almost complementary , remark [ almostequalsetshavesameintersectionnumber ]  tells us that this definition does not depend on the choice of standard almost invariant subsets @xmath44 and @xmath166 .",
    "if @xmath69 and @xmath71 denote the pre - images in @xmath12 of @xmath167and @xmath45 respectively , and if we conjugate the first splitting by @xmath168 and the second by @xmath169 , then @xmath170 is replaced by @xmath171 and @xmath172is replaced by @xmath173 . now @xmath174 is @xmath13almost equal to @xmath69 and @xmath175 is @xmath11almost equal to @xmath71 , because of the general fact that for any subset @xmath89 of @xmath12 and any element @xmath50 of @xmath12 , the set @xmath176 lies in a @xmath31neighbourhood of @xmath89 , where @xmath31 equals the length of @xmath50 .",
    "this follows from the equations @xmath177 .",
    "it follows that the intersection number of a pair of splittings is unchanged if we replace them by conjugate splittings .",
    "now we can state two easy results about the case of zero intersection number . recall that if @xmath69 is one of the standard @xmath13almost invariant subsets of _ _  _ _ @xmath12 determined by a splitting of @xmath12 over @xmath13 , then the set of translates of @xmath81and @xmath153 is nested .",
    "it follows at once that the self - intersection number of @xmath82 is zero . also if two splittings of @xmath12 over subgroups @xmath13 and @xmath11 are compatible , and if @xmath170 and @xmath71 denote corresponding standard @xmath13almost and @xmath11almost invariant subsets of @xmath12 , then the set of all translates of @xmath69 , @xmath153 , @xmath71 , @xmath178 is also nested , so that the intersection number of the two splittings is zero .",
    "the next section is devoted to proving converses to each of these statements .    before going further",
    ", we need to say a little more about splittings .",
    "recall from the introduction that a group @xmath12 is said to split over a subgroup @xmath13 if @xmath12 is isomorphic to @xmath18 or to @xmath17 , with @xmath179 .",
    "we will need a precise definition of a splitting .",
    "we will say that a _ splitting _ of @xmath12 consists either of proper subgroups @xmath119 and @xmath120 of @xmath12 and a subgroup @xmath13 of @xmath180 such that the natural map @xmath181 is an isomorphism , or it consists of a subgroup @xmath119 of @xmath182 and subgroups @xmath183 and @xmath184 of @xmath119 such that there is an element @xmath185 of @xmath12 which conjugates @xmath183 to @xmath184 and the natural map @xmath186 is an isomorphism .",
    "recall also that a collection of @xmath23 splittings of a group @xmath12 is _ compatible _ if @xmath12 can be expressed as the fundamental group of a graph of groups with @xmath23 edges , such that , for each @xmath24 , collapsing all edges but the @xmath24-th yields the @xmath24-th splitting of @xmath25 we note that if a splitting of a group @xmath12 over a subgroup @xmath13 is compatible with a conjugate of itself by some element @xmath50 of @xmath12 , then @xmath50 must lie in @xmath13 .",
    "this follows from a simple analysis of the possibilities . for example",
    ", if the splitting @xmath187 is compatible with its conjugate by some @xmath145 , then @xmath12 is the fundamental group of a graph of groups with two edges , which must be a tree , such that collapsing one edge yields the first splitting and collapsing the other yields its conjugate by @xmath50 .",
    "this means that each of the two extreme vertex groups of the tree must be one of @xmath119 , @xmath188 , @xmath120 or @xmath189 , and the same holds for the subgroup of @xmath12 generated by the two vertex groups of an edge .",
    "now it is easy to see that @xmath190 and @xmath191 , or the same inclusions hold with the roles of @xmath119 and @xmath120 reversed . in either case",
    "it follows that @xmath50 lies in @xmath13 as claimed .",
    "the case when @xmath192 is slightly different , but the conclusion is the same .",
    "this leads us to the following idea of equivalence of two splittings .",
    "we will say that two amalgamated free product splittings of @xmath12 are equivalent , if they are obtained from the same choice of subgroups @xmath119 , @xmath120 and @xmath13 of @xmath12 .",
    "this means that the splittings @xmath17 and @xmath156 of @xmath12 are equivalent .",
    "similarly , a splitting @xmath18 of @xmath12 is equivalent to the splitting obtained by interchanging the two subgroups @xmath183 and @xmath184 of @xmath119 .",
    "also we will say that any splitting of a group @xmath12 over a subgroup @xmath13 is equivalent to any conjugate by some element of @xmath13 .",
    "then the equivalence relation on all splittings of @xmath12 which this generates is the idea of equivalence which we will need . stated in this language",
    ", we see that if two splittings are compatible and conjugate , then they must be equivalent .",
    "note that two splittings of a group @xmath12 are equivalent if and only if they are over the same subgroup @xmath13 , and they have exactly the same four standard almost invariant sets .    next we need to recall the connection between splittings of groups and actions on trees .",
    "serre theory , @xcite or @xcite , tells us that if a group @xmath12 splits over a subgroup @xmath13 , then @xmath12 acts without inversions on a tree @xmath193 , so that the quotient is a graph with a single edge and the vertex stabilisers are conjugate to @xmath119 or @xmath120 and the edge stabilisers are conjugate to @xmath13 . in his important paper @xcite ,",
    "dunwoody gave a method for constructing such a @xmath12tree starting from the subset @xmath69 of @xmath12 defined above .",
    "the crucial property of @xmath170 which is needed for the construction is the nestedness of the set of translates of @xmath69 under the left action of @xmath12 .",
    "we recall dunwoody s result :    [ dunwoodytreeconstruction]let @xmath151 be a partially ordered set equipped with an involution @xmath194 , where @xmath195 , such that the following conditions hold :    1 .   if @xmath196 , @xmath197 and @xmath198 , then @xmath199 .",
    "2 .   if @xmath196 , @xmath197 , there are only finitely many @xmath200 such that @xmath201 .",
    "3 .   if @xmath196 , @xmath197 , at least one of the four relations @xmath198 , @xmath202 , @xmath203 , @xmath204 holds .",
    "if @xmath196 , @xmath197 , one can not have @xmath198 and @xmath205    then there is an abstract tree @xmath193 with edge set equal to @xmath151 such that the order relation which @xmath151 induces on the edge set of @xmath193 is equal to the order relation in which @xmath198 if and only if there is an oriented path in @xmath193 which begins with @xmath196 and ends with @xmath206    one applies this result to the set @xmath207 with the partial order given by inclusion and the involution by complementation .",
    "there is a natural action of @xmath12 on @xmath151 and hence on the tree @xmath193 . in most cases , @xmath12 acts on @xmath193 without inversions",
    "and we can recover the original decomposition from this action as follows .",
    "let @xmath196 denote the edge of @xmath193 determined by @xmath69 .",
    "then @xmath69 can be described as the set @xmath208 or @xmath209 .",
    "if the action of @xmath12 on @xmath193 has inversions , then the original splitting must have been an amalgamated free product decomposition @xmath210 , with @xmath13 of index @xmath107 in @xmath119 . in this case , subdividing the edges of @xmath193 yields a tree @xmath211 on which @xmath12 acts without inversions .",
    "if @xmath212 denotes the edge of @xmath211 contained in @xmath196 and containing the terminal vertex of @xmath196 , then @xmath69 can be described as the set @xmath213 or @xmath214 .",
    "now we will prove the following result .",
    "this implies part 2 ) of remark [ almostequalsetshavesameintersectionnumber ] .",
    "we give the proof here because the proof in @xcite is not complete , and we will need to apply the methods of proof later in this paper .    [ finitenumberofdoublecosets]let @xmath12 be a finitely generated group with finitely generated subgroups @xmath13 and @xmath11 , a non - trivial @xmath13almost invariant subset @xmath69 and a non - trivial @xmath11almost invariant subset @xmath71 .",
    "then @xmath215 and @xmath71 are not nested } consists of a finite number of double cosets @xmath216    let @xmath53 denote the cayley graph of @xmath12 with respect to some finite generating set for @xmath12 .",
    "let @xmath44 denote the almost invariant subset @xmath217 of @xmath26 and let @xmath45 denote the almost invariant subset @xmath218 of @xmath79 . recall from the start of this section , that if we identify @xmath44 with the @xmath219cochain on @xmath220 whose support is @xmath44 , then @xmath44 is an almost invariant subset of @xmath83 if and only if @xmath57 is finite .",
    "thus @xmath57 is a finite collection of edges in @xmath61 and similarly @xmath221 is a finite collection of edges in @xmath222 .",
    "now let @xmath223 denote a finite connected subgraph of @xmath61 such that @xmath223 contains @xmath224 and the natural map @xmath225 is onto , and let @xmath151 denote a finite connected subgraph of @xmath222 such that @xmath151 contains @xmath221 and the natural map @xmath226 is onto .",
    "thus the pre - image @xmath227 of @xmath223 in @xmath53 is connected and contains @xmath228 , and the pre - image @xmath0 of @xmath151 in @xmath53 is connected and contains @xmath229 let @xmath230 denote a finite subgraph of @xmath227 which projects onto @xmath223 , and let @xmath231 denote a finite subgraph of @xmath0 which projects onto @xmath151 . if @xmath232 meets @xmath0 , there must be elements @xmath126 and @xmath4 in @xmath13 and @xmath11 such that @xmath233 meets @xmath234 .",
    "now @xmath235 meets @xmath236 is finite , as @xmath12 acts freely on @xmath53 .",
    "it follows that @xmath237 meets @xmath238 consists of a finite number of double cosets @xmath239    the result would now be trivial if @xmath69 and @xmath71 were each the vertex set of a connected subgraph of @xmath53 . as this need not be the case",
    ", we need to make a careful argument as in the proof of lemma 5.10 of @xcite .",
    "consider @xmath50 in @xmath12 such that @xmath232 and @xmath0 are disjoint .",
    "we will show that @xmath93 and @xmath71 are nested .",
    "as @xmath227 is connected , the vertex set of @xmath232 must lie entirely in @xmath71 or entirely in @xmath240 suppose that the vertex set of @xmath232 lies in @xmath71 . for a set @xmath2 of vertices of @xmath53 , let @xmath241 denote the maximal subgraph of @xmath53 with vertex set equal to @xmath2 .",
    "each component @xmath89 of @xmath242 and @xmath243 contains a vertex of @xmath227 .",
    "hence @xmath244 contains a vertex of @xmath232 and so must meet @xmath71 .",
    "if @xmath244 also meets @xmath178 , then it must meet @xmath0 .",
    "but as @xmath0 is connected and disjoint from @xmath232 , it lies in a single component @xmath244 .",
    "it follows that there is exactly one component @xmath244 of @xmath245 and @xmath246 which meets @xmath178 , so that we must have @xmath247 or @xmath248 .",
    "similarly , if @xmath232 lies in @xmath178 , we will find that @xmath249 or @xmath250 .",
    "it follows that in either case @xmath93 and @xmath71 are nested as required .    in theorem 2.2 of @xcite",
    ", scott used dunwoody s theorem to prove a general splitting result in the context of surfaces in @xmath9manifolds .",
    "we will use the ideas in his proof a great deal .",
    "the following theorem is the natural generalisation of his result to our more general context and will be needed in the proofs of theorems [ disjointsplittings ] and [ splittingsexist ] .",
    "the first part of the theorem directly corresponds to the result proved in @xcite , and the second part is a simple generalisation which will be needed later .",
    "@xmath251 [ algebrafromtorustheorem ]    1 .",
    "let @xmath13 be a finitely generated subgroup of a finitely generated group @xmath12 .",
    "let @xmath69 be a non - trivial @xmath13almost invariant set in @xmath12 such that @xmath207 is almost nested and if two of the four sets @xmath252 are small , then at least one of them is empty",
    ". then @xmath12 splits over the stabilizer @xmath106 of @xmath69 and @xmath27 contains @xmath13 as a subgroup of finite index .",
    "further , one of the @xmath106almost invariant sets @xmath71 determined by the splitting is @xmath13almost equal to @xmath253 2 .",
    "let @xmath254 be finitely generated subgroups of a finitely generated group @xmath12 .",
    "let @xmath255 , @xmath256 , be a non - trivial @xmath257almost invariant set in @xmath12 such that @xmath258 is almost nested .",
    "suppose further that , for any pair of elements @xmath104 and @xmath90 of @xmath151 , if two of the four sets @xmath259 are small , then at least one of them is empty .",
    "then @xmath12 can be expressed as the fundamental group of a graph of groups whose @xmath24-th edge corresponds to a conjugate of a splitting of @xmath12 over the stabilizer @xmath260 of @xmath255 , and @xmath261 contains @xmath257 as a subgroup of finite index .",
    "further , for each @xmath24 , one of the @xmath261almost invariant sets determined by the @xmath24-th splitting is @xmath257almost equal to @xmath255 .",
    "most of the arguments needed to prove this theorem are contained in the proof of theorem 2.2 of @xcite , but in the context of @xmath9manifolds .",
    "we will present the proof of the first part of this theorem , and then briefly discuss the proof of the second part .",
    "the idea in the first part is to define a partial order on @xmath207 , which coincides with inclusion whenever possible .",
    "let @xmath104 and @xmath90 denote elements of @xmath151 .",
    "if @xmath262 is small , we want to define @xmath263 .",
    "there is a difficulty , which is what to do if @xmath104 and @xmath90 are distinct but @xmath264 and @xmath265 are both small .",
    "however , the assumption in the statement of theorem [ algebrafromtorustheorem ] is that if two of the four sets @xmath102 are small , then one of them is empty .",
    "thus , as in @xcite , we define @xmath263 if and only if @xmath262 is empty or the only small set of the four .",
    "note that if @xmath266 then @xmath263 .",
    "we will show that this definition yields a partial order on @xmath267    as usual , we let @xmath53 denote the cayley graph of @xmath12 with respect to some finite generating set .",
    "the distance between two points of @xmath12 is the usual one of minimal edge path length .",
    "our first step is the analogue of lemma 2.3 of @xcite .",
    "[ smallimpliesinboundednbhd]@xmath262 is small if and only if it lies in a bounded neighbourhood of each of @xmath268 , @xmath90 , @xmath269    as @xmath104 and @xmath90 are translates of @xmath69 or @xmath153 , it suffices to prove that @xmath270 is small if and only if it lies in a bounded neighbourhood of each of @xmath69 , @xmath153 , @xmath93 , @xmath271 .",
    "if @xmath272 is small , it projects to a finite subset of @xmath26 which therefore lies within a bounded neighbourhood of the image of @xmath273 . by lifting paths , we see that each point of @xmath270 lies in a bounded neighbourhood of @xmath273 , and hence lies in a bounded neighbourhood of @xmath69 and @xmath153 . by reversing the roles of @xmath93 and @xmath274",
    ", we also see that @xmath270 lies in a bounded neighbourhood of each of @xmath93 and @xmath275    for the converse , suppose that @xmath270 lies in a bounded neighbourhood of each of @xmath69 and @xmath153",
    ". then it must lie in a bounded neighbourhood of @xmath273 , so that its image in @xmath26 must lie in a bounded neighbourhood of the image of @xmath273 . as",
    "this image is finite , it follows that @xmath270 must be small , as required .",
    "now we can prove that our definition of @xmath276 yields a partial order on @xmath277 our proof is essentially the same as in lemma 2.4 of @xcite .",
    "[ partialorder]if a relation @xmath276 is defined on @xmath151 by the condition that @xmath263 if and only if @xmath262 is empty or the only small set of the four sets @xmath102 , then @xmath276 is a partial order .",
    "we need to show that @xmath276 is transitive and that if @xmath263 and @xmath278 then @xmath279    suppose first that @xmath263 and @xmath280 .",
    "the first inequality implies that @xmath262 is small and the second implies that @xmath265 is small , so that two of the four sets @xmath102 are small .",
    "the assumption of theorem [ algebrafromtorustheorem ] implies that one of these two sets must be empty . as @xmath263",
    ", our definition of @xmath276 implies that @xmath262 is empty .",
    "similarly , the fact that @xmath280 tells us that @xmath265 is empty .",
    "this implies that @xmath281 as required .    to prove transitivity ,",
    "let @xmath104 , @xmath90 and @xmath89 be elements of @xmath151 such that @xmath282 .",
    "we must show that @xmath283    our first step is to show that @xmath284 is small . as @xmath285 and @xmath286 are small , we let @xmath287 be an upper bound for the distance of points of @xmath262 from @xmath90 and let @xmath288 be an upper bound for the distance of points of @xmath286 from @xmath89 .",
    "let @xmath289 be a point of @xmath284 .",
    "if @xmath289 lies in @xmath90 , then it lies in @xmath290 and so has distance at most @xmath288 from @xmath89 .",
    "otherwise , it must lie in @xmath262 and so have distance at most @xmath287 from some point @xmath291 of @xmath90 . if @xmath291 lies in @xmath89",
    ", then @xmath289 has distance at most @xmath287 from @xmath89 .",
    "otherwise , @xmath291 lies in @xmath290 and so has distance at most @xmath288 from @xmath89 . in this case",
    ", @xmath289 has distance at most @xmath292 from @xmath89 .",
    "it follows that in all cases , @xmath293 has distance at most @xmath292 from @xmath89 , so that @xmath284 lies in a bounded neighbourhood of @xmath89 as required . as @xmath284",
    "is contained in @xmath294 , it follows that it lies in bounded neighbourhoods of @xmath89 and @xmath294 , so that @xmath284 is small as required .",
    "the definition of @xmath276 now shows that @xmath295 , except possibly when two of the four sets @xmath296 are small .",
    "the only possibility is that @xmath297 and @xmath284 are both small .",
    "as one must be empty , either @xmath298 or @xmath299 .",
    "we conclude that if @xmath300 , then either @xmath295 or @xmath299 .",
    "now we consider two cases .",
    "first suppose that @xmath301 , so that either @xmath295 or @xmath302 . if @xmath299 , then @xmath303 , so that @xmath304",
    ". as @xmath305 and @xmath306 , it follows from the first paragraph of the proof of this lemma that @xmath307 .",
    "hence , in either case , @xmath283    now consider the general situation when @xmath300 .",
    "again either @xmath308 or @xmath299 . if @xmath299 , then we have @xmath309 .",
    "now the preceding paragraph implies that @xmath304 .",
    "hence we again have @xmath305 and @xmath304 so that @xmath307 . hence @xmath295 still holds .",
    "this completes the proof of the lemma .",
    "next we need to verify that the set @xmath151 with the partial order which we have defined satisfies all the hypotheses of dunwoody s theorem [ dunwoodytreeconstruction ] .",
    "[ posatisfiesdunwoody]@xmath151 together with @xmath276 satisfies the following conditions .    1 .",
    "if @xmath104 , @xmath310 and @xmath263 , then @xmath311 .",
    "2 .   if @xmath104 , @xmath310 , there are only finitely many @xmath312 such that @xmath313 .",
    "3 .   if @xmath104 , @xmath310 , at least one of the four relations @xmath263 , @xmath314 , @xmath315 , @xmath316 holds .",
    "if @xmath104 , @xmath310 , one can not have @xmath263 and @xmath317    conditions ( 1 ) and ( 3 ) are obvious from the definition of @xmath276 and the hypotheses of theorem [ algebrafromtorustheorem ] .    to prove ( 4 ) , we observe that if @xmath263 and @xmath318 , then @xmath319 and @xmath105 must both be small .",
    "this implies that @xmath104 itself is small , so that @xmath69 or @xmath153 must be small .",
    "but this contradicts the hypothesis that @xmath69 is a non - trivial @xmath13almost invariant subset of @xmath25    finally we prove condition ( 2 ) .",
    "let @xmath320 be an element of @xmath151 such that @xmath321 .",
    "recall that , as @xmath322 projects to a finite subset of @xmath83 , we know that @xmath322 lies in a @xmath323neighbourhood of @xmath69 , for some @xmath324 . if @xmath325 but @xmath48 is not contained in @xmath69 , then @xmath326 and @xmath69 are not nested .",
    "now lemma [ finitenumberofdoublecosets ] tells us that if @xmath48 is such a set , then @xmath50 belongs to one of only finitely many double cosets @xmath327 .",
    "it follows that if we consider all elements @xmath48 of @xmath151 such that @xmath325 , we will find either @xmath328 , or @xmath322 lies in a @xmath323neighbourhood of @xmath69 , for finitely many different values of @xmath329 hence there is @xmath330 such that if @xmath325 then @xmath48 lies in the @xmath331neighbourhood of @xmath69 .",
    "similarly , there is @xmath332 such that if @xmath333 , then @xmath48 lies in the @xmath288neighbourhood of @xmath334 let @xmath335 denote the larger of @xmath287 and @xmath288 .",
    "then for any elements @xmath104 and @xmath90 of @xmath151 with @xmath263 , the set @xmath262 lies in the @xmath323neighbourhood of each of @xmath104 , @xmath336 , @xmath90 and @xmath337    now suppose we are given @xmath263 and wish to prove condition ( 2 ) .",
    "choose a point @xmath338 in @xmath104 whose distance from @xmath336 is greater than @xmath323 , choose a point @xmath339 in @xmath340 whose distance from @xmath90 is greater than @xmath323 and choose a path @xmath1 in @xmath53 joining @xmath338 to @xmath339 .",
    "if @xmath341 , then @xmath342 must lie in @xmath48 and @xmath339 must lie in @xmath343 so that @xmath1 must meet @xmath344 . as @xmath1 is compact , the proof of lemma [ finitenumberofdoublecosets ]",
    "shows that the number of such @xmath48 is finite .",
    "this completes the proof of part 2 ) of the lemma .",
    "we are now in a position to prove theorem [ algebrafromtorustheorem ] .",
    "to prove the first part , we let @xmath151 denote the set of all translates of @xmath69 and @xmath153 by elements of @xmath12 , let @xmath345 be the involution on @xmath151 and let the relation @xmath276 be defined on @xmath151 by the condition that @xmath263 if @xmath262 is empty or the only small set of the four sets @xmath102 .",
    "lemmas [ partialorder ] and [ posatisfiesdunwoody ] show that @xmath276 is a partial order on @xmath151 and satisfies all of dunwoody s conditions ( 1)(4 ) .",
    "hence we can construct a tree @xmath193 from @xmath151 .",
    "as @xmath12 acts on @xmath151 , we have a natural action of @xmath12 on @xmath346 clearly , @xmath12 acts transitively on the edges of @xmath193 .",
    "if @xmath12 acts without inversions , then @xmath347 has a single edge and gives @xmath12 the structure of an amalgamated free product or hnn decomposition .",
    "the stabiliser of the edge of @xmath193 which corresponds to @xmath69 is the stabiliser @xmath27 of @xmath69 , so we obtain a splitting of @xmath12 over @xmath106 unless @xmath12 fixes a vertex of @xmath193 . note that as @xmath348 is finite , and @xmath106 preserves @xmath273 , it follows that @xmath106 contains @xmath13 with finite index as claimed in the theorem .",
    "if @xmath12 acts on @xmath193 with inversions , we simply subdivide each edge to obtain a new tree @xmath349 on which @xmath12 acts without inversions . in this case",
    ", the quotient @xmath350 again has one edge , but it has distinct vertices .",
    "the edge group is @xmath106 and one of the vertex groups contains @xmath106 with index two . as @xmath13 has infinite index in @xmath12 , it follows that in this case also we obtain a splitting of @xmath12 unless @xmath12 fixes a vertex of @xmath351    suppose that @xmath12 fixes a vertex @xmath339 of @xmath193",
    ". as @xmath12 acts transitively on the edges of @xmath193 , every edge of @xmath193 must have one vertex at @xmath339 , so that all edges of @xmath193 are adjacent to each other .",
    "we will show that this can not occur .",
    "the key hypothesis here is that @xmath69 is non - trivial .",
    "let @xmath89 denote @xmath352 or @xmath353 , and note that condition 3 ) of lemma [ posatisfiesdunwoody ] shows that @xmath354 or @xmath355 .",
    "recall that there is @xmath330 such that if @xmath325 then @xmath48 lies in the @xmath287neighbourhood of @xmath69 .",
    "if @xmath323 denotes @xmath356 , and @xmath357 , it follows that @xmath358 lies in the @xmath323neighbourhood of @xmath69 .",
    "let @xmath359 denote the distance of the identity of @xmath12 from @xmath273",
    ". then @xmath50 must lie within the @xmath360neighbourhood of @xmath69 , for all @xmath357 , so that @xmath89 itself lies in the @xmath360neighbourhood of @xmath69 .",
    "similarly , @xmath294 lies in the @xmath361neighbourhood of @xmath153 .",
    "now both @xmath69 and @xmath153 project to infinite subsets of @xmath26 , so @xmath12 can not equal @xmath89 or @xmath362 it follows that there are elements @xmath363and @xmath90 of @xmath151 such that @xmath364 , so that @xmath363and @xmath90 represent non - adjacent edges of @xmath193 .",
    "this completes the proof that @xmath12 can not fix a vertex of @xmath351    to prove the last statement of the first part of theorem [ algebrafromtorustheorem ] , we will simplify notation by supposing that the stabiliser @xmath106 of @xmath69 is equal to @xmath13 .",
    "one of the standard @xmath13almost invariant sets associated to the splitting we have obtained from the action of @xmath12 on the tree @xmath193 is the set @xmath89 in the preceding paragraph .",
    "we will show that @xmath89 is @xmath13almost equal to @xmath69 .",
    "the preceding paragraph shows that @xmath89 lies in the @xmath360neighbourhood of @xmath69 , and that @xmath294 lies in the @xmath360neighbourhood of @xmath153 .",
    "it follows that @xmath89 is @xmath13almost contained in @xmath69 and @xmath294 is @xmath13almost contained in @xmath365 , so that @xmath89 and @xmath69 are @xmath13almost equal as claimed .",
    "this completes the proof of the first part of theorem [ algebrafromtorustheorem ] .    for the second part",
    ", we will simply comment on the modifications needed to the preceding proof .",
    "the statement of lemma [ smallimpliesinboundednbhd ] remains true though the proof needs a little modification .",
    "the statement and proof of lemma [ partialorder ] apply unchanged .",
    "the statement of lemma [ posatisfiesdunwoody ] remains true , though the proof needs some minor modifications .",
    "finally the proof of the first part of theorem [ algebrafromtorustheorem ] applies with minor modifications to show that @xmath12 acts on a tree @xmath193 with quotient consisting of @xmath4 edges in the required way .",
    "this completes the proof of theorem [ algebrafromtorustheorem ] .",
    "in this section , we prove our two main results about the case of zero intersection number .",
    "first we will need the following little result .",
    "[ bignormaliserimpliesnormal]let @xmath12 be a finitely generated group which splits over a subgroup @xmath13 .",
    "if the normaliser @xmath109 of @xmath13 in @xmath12 has finite index in @xmath12 , then @xmath13 is normal in @xmath25    the given splitting of @xmath12 over @xmath13 corresponds to an action of @xmath12 on a tree @xmath193 such that @xmath366has a single edge , and some edge of @xmath367has stabiliser @xmath13 .",
    "let @xmath368 denote the fixed set of @xmath13 , ie , the set of all points fixed by @xmath13 .",
    "then @xmath368 is a ( non - empty ) subtree of @xmath193 . as @xmath109 normalises @xmath13 , it must preserve @xmath368 , ie @xmath369 .",
    "suppose that @xmath370 . as @xmath109 has finite index in @xmath12 , we let @xmath371 denote a set of coset representatives for @xmath109 in @xmath12 , where @xmath372 . as @xmath12",
    "acts transitively on @xmath193 ,",
    "we have @xmath373 . edges of @xmath368 all have stabiliser @xmath13 , and so edges of @xmath374 all have stabiliser @xmath375 .",
    "as @xmath376 does not lie in @xmath109 , these stabilisers are distinct so the intersection @xmath377 contains no edges .",
    "the intersection of two subtrees of a tree must be empty or a tree , so it follows that @xmath377 is empty or a single vertex @xmath378 , for each @xmath24 .",
    "now @xmath109 preserves @xmath368 and permutes the translates @xmath374 , so @xmath379 preserves the collection of all the @xmath378 s . as",
    "this collection is finite , @xmath109 has a subgroup @xmath380 of finite index such that @xmath380 fixes a vertex @xmath339 of @xmath368 .",
    "as @xmath380 has finite index in @xmath12 , it follows that @xmath12 itself fixes some vertex of @xmath193 , which contradicts our assumption that our action of @xmath12 on @xmath193 corresponds to a splitting of @xmath12 .",
    "this contradiction shows that @xmath109 must equal @xmath12 , so that @xmath13 is normal in @xmath381as claimed .",
    "recall that if @xmath69 is a @xmath13almost invariant subset of @xmath12 associated to a splitting of @xmath12 , then the set of translates of @xmath69 and @xmath153 is nested .",
    "equivalently , for every @xmath145 , one of the four sets @xmath382 is empty .",
    "we need to consider carefully how it is possible for two of the four sets to be small , and a similar question arises when one considers two splittings of @xmath25    [ twosmallsets]let @xmath12 be a finitely generated group with two splittings over finitely generated subgroups @xmath13 and @xmath11 with associated @xmath13almost invariant subset @xmath69 of @xmath12 and associated @xmath11almost invariant subset @xmath71 of @xmath25    1 .",
    "if two of the four sets @xmath87 are small , then @xmath383 2 .",
    "if two of the four sets @xmath252 are small , then @xmath50 normalises @xmath384    our first step will be to show that @xmath13 and @xmath11 must be commensurable . without loss of generality",
    ", we can suppose that @xmath72 is small .",
    "the other small set can only be @xmath75 , as otherwise @xmath69 or @xmath385 would be small which is impossible .",
    "it follows that for each edge of @xmath386 , either it is also an edge of @xmath273 or it has ( at least ) one end in one of the two small sets . as the images in @xmath61 of @xmath387 and of each small set is finite , and as the graph @xmath53 is locally finite , it follows that the image of @xmath388 in @xmath67 must be finite .",
    "this implies that @xmath389 has finite index in the stabiliser @xmath11 of @xmath388 . by reversing the roles of @xmath13 and @xmath11",
    ", it follows that @xmath389 has finite index in @xmath13 , so that @xmath13 and @xmath11 must be commensurable , as claimed .",
    "now let @xmath1 denote @xmath389 , so that @xmath1 stabilises both @xmath69 and @xmath71 , and consider the images @xmath44 and @xmath45 of @xmath69 and @xmath71 in @xmath390 .",
    "as @xmath391 has finite index in @xmath13 and @xmath11 , it follows that @xmath57 and @xmath221 are each finite , so that @xmath44 and @xmath45 are almost invariant subsets of @xmath392 .",
    "further , two of the four sets @xmath87 have finite image in @xmath390 , so we can assume that @xmath44 and @xmath45 are almost equal , by replacing one of @xmath69 or @xmath71 by its complement in @xmath12 , if needed .",
    "let @xmath5 denote the intersection of the conjugates of @xmath1 in @xmath13 , so that @xmath5 is normal in @xmath13 , though it need not be normal in @xmath11 .",
    "we do not have @xmath393 , but because @xmath1 has finite index in @xmath13 , we know that @xmath5 has finite index in @xmath13 and hence also in @xmath11 , which is all we need .",
    "let @xmath96 and @xmath97 denote the images of @xmath69 and @xmath71 respectively in @xmath394 , and consider the action of an element @xmath126 of @xmath13 on @xmath395 trivially @xmath396 . as @xmath96 and @xmath97 are almost equal , @xmath397 must be almost equal to @xmath398 .",
    "now we use the key fact that @xmath71 is associated to a splitting of @xmath12 so that its translates by @xmath12 are nested .",
    "thus for any element @xmath50 of @xmath12 , one of the following four inclusions holds : @xmath399 , @xmath400 , @xmath401 , @xmath402 .",
    "as @xmath403 is almost equal to @xmath97 , we must have @xmath404 or @xmath405 but @xmath126 has a power which lies in @xmath1 and hence stabilises @xmath71 .",
    "it follows that @xmath406 , so that @xmath126 lies in @xmath11 .",
    "thus @xmath118 is a subgroup of @xmath407 similarly , @xmath11 must be a subgroup of @xmath13 , so that @xmath408 .",
    "this completes the proof of part 1 of the lemma .",
    "note that it follows that @xmath409 , that @xmath410 and @xmath411 and that @xmath44 and @xmath412 are almost equal or almost complementary .    in order to prove part 2 of the lemma",
    ", we apply the preceding work to the case when the second splitting is obtained from the first by conjugating by some element @xmath50 of @xmath12 .",
    "thus @xmath413 and @xmath414 which is @xmath11almost equal to @xmath93 by remark [ xgisequivalenttox ] .",
    "hence if two of the four sets @xmath252 are small , then so are two of the four sets @xmath87 small .",
    "now the above shows that @xmath415 , so that @xmath50 normalises @xmath13 .",
    "this completes the proof of the lemma .",
    "[ equalsplittings]let @xmath12 be a finitely generated group with two splittings over finitely generated subgroups @xmath13 and @xmath11 with associated @xmath13almost invariant subset @xmath69 of @xmath12 and associated @xmath11almost invariant subset @xmath71 of @xmath12 .",
    "if two of the four sets @xmath87 are small , then the two splittings of @xmath12 are conjugate .",
    "further one of the following holds :    1 .",
    "the two splittings are equivalent , or 2 .",
    "the two splittings are of the form @xmath416 , where @xmath13 has index @xmath107 in @xmath1 , and the splittings are conjugate by an element of @xmath1 , or 3 .",
    "@xmath13 is normal in @xmath12 and @xmath26 is isomorphic to @xmath417 or to @xmath418    the preceding lemma showed that the hypotheses imply that @xmath13 equals @xmath11 and also that the images @xmath44 and @xmath45 of @xmath69 and @xmath71 in @xmath26 are almost equal or almost complementary . by replacing one of @xmath69 or @xmath71 by its complement",
    "if needed , we can arrange that @xmath44 and @xmath45 are almost equal .",
    "we will show that in most cases , the two given splittings over @xmath13 and @xmath11 must be equivalent , and that the exceptional cases can be analysed separately to show that the splittings are conjugate .    recall that by applying theorem [ dunwoodytreeconstruction ] , we can use information about @xmath69 and its translates to construct a @xmath12tree @xmath419 and hence the original splitting of @xmath12 over @xmath13 .",
    "similarly , we can use information about @xmath71 and its translates to construct a @xmath12tree @xmath420 and hence the original splitting of @xmath12 over @xmath11 .",
    "we will compare these two constructions in order to prove our result .",
    "as @xmath44 and @xmath45 are almost equal subsets of @xmath26 , it follows that there is @xmath421 such that , in the cayley graph @xmath53 of @xmath12 , we have @xmath69 lies in a @xmath58neighbourhood of @xmath71 and @xmath71 lies in a @xmath58neighbourhood of @xmath69 .",
    "now let @xmath422 denote one of @xmath69 or @xmath153 , let @xmath423 denote one of @xmath93 or @xmath271 and let @xmath424 and @xmath425 denote the corresponding sets obtained by replacing @xmath69 with @xmath71 . recall that @xmath426 is small if and only if its image in @xmath26 is finite .",
    "clearly this occurs if and only if @xmath423 lies in a @xmath58neighbourhood of @xmath427 , for some @xmath421 .",
    "it follows that @xmath426 is small if and only if @xmath428 is small .    as @xmath69 and @xmath71",
    "are associated to splittings , we know that for each @xmath145 , at least one of the four sets @xmath252 is empty and at least one of the four sets @xmath429 is empty .",
    "further the information about which of the four sets is empty completely determines the trees @xmath419 and @xmath420 .",
    "thus we would like to show that when we compare the four sets @xmath252 with the four sets @xmath430 , then corresponding sets are empty .",
    "note that when @xmath50 lies in @xmath13 , we have @xmath431 , so that two of the four sets @xmath382 are empty .",
    "first we consider the case when , for each @xmath432 , only one of the sets @xmath433 is small and hence empty .",
    "then only the corresponding one of the four sets @xmath429 is small and hence empty .",
    "now the correspondence @xmath434 gives a @xmath12isomorphism of @xmath419 with @xmath420 and thus the splittings are equivalent .",
    "next we consider the case when two of the sets @xmath252 are small , for some @xmath432 .",
    "part 2 of lemma [ twosmallsets ] implies that @xmath50 normalises @xmath13 .",
    "further if @xmath435 , then @xmath167is almost equal to @xmath436 or @xmath437 .",
    "let @xmath438 denote the normaliser of @xmath13 in @xmath12 , so that @xmath438 acts on the left on the graph @xmath61 and we have @xmath439 .",
    "let @xmath1 denote the subgroup of @xmath438 consisting of elements @xmath4 such that @xmath440 is almost equal to @xmath44 or @xmath52 .",
    "now we apply theorem 5.8 from @xcite to the action of @xmath441 on the left on the graph @xmath442 this result tells us that if @xmath443 is infinite , then it has an infinite cyclic subgroup of finite index .",
    "further the proof of this result in @xcite shows that the quotient of @xmath61 by @xmath441 must be finite .",
    "this implies that @xmath61 has two ends and that @xmath1 has finite index in @xmath12 . to summarise , either @xmath443 is finite , or it has two ends and @xmath1 has finite index in @xmath12 .",
    "let @xmath4 be an element of @xmath1 whose image in @xmath441 has finite order such that @xmath444 .",
    "as @xmath69 is associated to a splitting of @xmath64 , we must have @xmath445 or @xmath446 . as @xmath4 has finite order in @xmath443 , we have @xmath447 , for some positive integer @xmath23 , which implies that @xmath448 so that @xmath4 itself lies in @xmath13 .",
    "it follows that the group @xmath441 must be trivial , @xmath54 , @xmath417 or @xmath449 . in the first case , the two trees @xmath419 and @xmath420 will be @xmath12isomorphic , showing that the given splittings are equivalent . in the other three cases , @xmath450 is non - empty and we know that , for any @xmath451 , two of the four sets @xmath252 are small .",
    "thus in these cases , it seems possible that @xmath419 and @xmath420 will not be @xmath12isomorphic , so we need some special arguments .",
    "we start with the case when @xmath441 is @xmath54 . in  this case",
    ", the given splitting must be an amalgamated free product of the form @xmath452 , for some group @xmath223 .",
    "if @xmath4 denotes an element of @xmath450 , then @xmath453 .",
    "thus @xmath12 acts on @xmath419 and @xmath420 with inversions .",
    "recall that either the two partial orders on the translates of @xmath170 and @xmath71 are the same under the bijection @xmath434 , or they differ only in that @xmath454 but @xmath455 , for all @xmath456 . if they differ , we replace the second splitting by its conjugate by some element @xmath456 , so that @xmath71 is replaced by @xmath457 and we replace @xmath69 by @xmath458 as @xmath459 is @xmath13almost equal to @xmath460 , the partial orders on the translates of @xmath460 and @xmath459 respectively are the same under the bijection @xmath461 except possibly when one compares @xmath460 , @xmath462 and @xmath459 , @xmath463 , where @xmath464 in this case , the inclusion @xmath454 tells us that @xmath465 , and the inclusion @xmath455 tells us that @xmath466 .",
    "we conclude that the partial orders on the translates of @xmath467 and @xmath459 respectively are exactly the same , so that @xmath468 and @xmath420 are @xmath12isomorphic , and the two given splittings are conjugate by an element of @xmath1 .",
    "now we turn to the two cases where @xmath441 is infinite , so that @xmath1 has finite index in @xmath12 and @xmath61 has two ends .",
    "as @xmath1 normalises @xmath13 , lemma [ bignormaliserimpliesnormal ] shows that @xmath13 is normal in @xmath12 .",
    "as @xmath61 has two ends , it follows that @xmath469 , so that @xmath26 is @xmath417 or @xmath470 .",
    "it is easy to check that there is only one splitting of @xmath417 over the trivial group and that all splittings of @xmath471 over the trivial group are conjugate .",
    "it follows that , in either case , all splittings of @xmath12 over @xmath13 are conjugate .",
    "this completes the proof of lemma [ equalsplittings ] .",
    "[ emptyorconjugate]let @xmath12 be a finitely generated group with two splittings over finitely generated subgroups @xmath13 and @xmath11 with associated @xmath13almost invariant subset @xmath69 of @xmath12 and associated @xmath11almost invariant subset @xmath71 of @xmath12 .",
    "let @xmath472 , and let @xmath473 and @xmath90 denote two elements of @xmath151 such that two of the four sets @xmath474 are small .",
    "then either one of the two sets is empty , or the two given splittings of @xmath12 are conjugate .",
    "recall that @xmath69 is associated to a splitting of @xmath12 over @xmath13 .",
    "it follows that @xmath93 is associated to the conjugate of this splitting by @xmath50 .",
    "thus @xmath104 and @xmath90 are associated to splittings of @xmath12 which are each conjugate to one of the two given splittings .",
    "if @xmath104 and @xmath90 are each translates of @xmath69 or @xmath274 , the nestedness of the translates of @xmath69 shows that one of the two small sets must be empty as claimed .",
    "similarly if both are translates of @xmath71 or @xmath178 , then one of the two small sets must be empty .",
    "if @xmath104 is a translate of @xmath69 or @xmath153 and @xmath90 is a translate of @xmath71 or @xmath475 , we apply lemma [ equalsplittings ] to show that the splittings to which @xmath104 and @xmath90 are associated are conjugate .",
    "it follows that the two original splittings were conjugate as required .",
    "now we come to the proof of our first main result .",
    "[ disjointsplittings]let @xmath12  be a finitely generated group with @xmath23  splittings over finitely generated subgroups .",
    "this collection of splittings is compatible up to conjugacy if and only if each pair of splittings has intersection number zero .",
    "further , in this situation , the graph of groups structure on @xmath12 obtained from these splittings has a unique underlying graph , and the edge and vertex groups are unique up to conjugacy .",
    "let the @xmath23 splittings @xmath476 of @xmath12 be over subgroups @xmath477 with associated @xmath257almost invariant subsets @xmath255 of @xmath12 , and let @xmath478 .",
    "we will start by supposing that no two of the @xmath476 s are conjugate .",
    "we will handle the general case at the end of this proof .",
    "we will apply the second part of theorem [ algebrafromtorustheorem ] to @xmath277 recall that our assumption that the @xmath476 s have intersection number zero implies that no translate of @xmath255 can cross any translate of @xmath479 , for @xmath480 . as each @xmath255",
    "is associated to a splitting , it is also true that no translate of @xmath255 can cross any translate of @xmath481 .",
    "this means that the set @xmath151 is almost nested . in order to apply theorem [ algebrafromtorustheorem ]",
    ", we will also need to show that for any pair of elements @xmath104 and @xmath90 of @xmath151 , if two of the four sets @xmath259 are small then one is empty .",
    "now lemma [ emptyorconjugate ] shows that if two of these four sets are small , then either one is empty or there are distinct @xmath24 and @xmath482 such that @xmath476 and @xmath483 are conjugate .",
    "as we are assuming that no two of these splittings are conjugate , it follows that if two of the four sets @xmath484 are small then one is empty , as required .",
    "theorem [ algebrafromtorustheorem ] now implies that @xmath12 can be expressed as the fundamental group of a graph @xmath53 of groups whose @xmath24-th edge corresponds to a conjugate of a splitting of @xmath12 over the stabilizer @xmath260 of @xmath255 . as @xmath255 is associated to a splitting of @xmath12 over @xmath257 , its stabiliser @xmath261 must equal @xmath257 .",
    "further , it is clear from the construction that collapsing all but the @xmath24-th edge of @xmath53 yields a conjugate of @xmath476 , as the corresponding @xmath12tree has edges which correspond precisely to the translates of @xmath485    now suppose that we have a graph of groups structure @xmath486 for @xmath12 such that , for each @xmath24 , @xmath136 , collapsing all edges but the @xmath487-th yields a conjugate of the splitting @xmath476 of @xmath12 .",
    "this determines an action of @xmath12 on a tree @xmath368 without inversions .",
    "we want to show that @xmath193 and @xmath368 are @xmath12isomorphic . for this",
    "implies that @xmath488 and @xmath486 have the same underlying graph , and that corresponding edge and vertex groups are conjugate , as required .",
    "let @xmath196 denote an edge of @xmath368 , and let @xmath489 denote @xmath490 or @xmath491 .",
    "there are edges @xmath492 of @xmath368 , @xmath136 , such that the set @xmath493 of all translates of @xmath494 and @xmath495 is nested and dunwoody s construction applied to @xmath496 yields the @xmath12tree @xmath368 again",
    ". we will denote @xmath497 by @xmath498 .",
    "the hypotheses imply that there is @xmath499 such that the stabiliser @xmath500 of @xmath492 equals @xmath501 , and that @xmath498 is @xmath500almost equal to @xmath502 , where @xmath255 is one of the standard @xmath257almost invariant subsets of @xmath12 associated to the splitting @xmath476 .",
    "let @xmath503 denote @xmath504 so that @xmath503 is @xmath257almost equal to @xmath505 .",
    "now remark [ xgisequivalenttox ] shows that @xmath506 is @xmath257almost equal to @xmath255 , so that @xmath503 is @xmath257almost equal to @xmath255 .",
    "now consider the @xmath12equivariant bijection @xmath507 determined by sending @xmath255 to @xmath503 .",
    "the above argument shows that if @xmath473 is any element of @xmath151 , and @xmath508 is the corresponding element of @xmath493 , then @xmath363and @xmath508 are @xmath509almost equal .",
    "we will show that in most cases , this bijection automatically preserves the partial orders on @xmath151 and @xmath493 , implying that @xmath193 and @xmath368 are @xmath12isomorphic , as required .",
    "we compare the partial orders on @xmath151 and @xmath496 rather as in the proof of lemma [ equalsplittings ] .",
    "for any elements @xmath104 and @xmath90 of @xmath151 , let @xmath508 and @xmath510 denote the corresponding elements of @xmath493 .",
    "thus @xmath105 is small if and only if @xmath511 is small .",
    "we would like to show that when we compare the four sets @xmath102 with the four sets @xmath512 , then corresponding sets are empty , so that the partial orders are preserved by our bijection .",
    "otherwise , there must be @xmath104 and @xmath90 in @xmath151 such that two of the sets @xmath474 are small .",
    "if @xmath363and @xmath90 are translates of @xmath481 and @xmath479 , then lemma [ equalsplittings ] tells us that the splittings @xmath476 and @xmath513 are conjugate . as we are assuming that distinct splittings are not conjugate",
    ", it follows that @xmath514 .",
    "now the arguments in the proof of lemma [ equalsplittings ] show that either the splitting @xmath476 is an amalgamated free product of the form @xmath515 , with @xmath516 , or @xmath13 is normal in @xmath12 and @xmath26 is @xmath517 or @xmath518 .",
    "if the second case occurs , then there can be only one splitting in the given family , so it is immediate that @xmath53 and @xmath486 have the same underlying graph , and that corresponding edge and vertex groups are conjugate .",
    "if the first case occurs and the partial orders on translates of @xmath255 and @xmath503 do not match , we must have @xmath519 but @xmath520 , for all @xmath521 .",
    "we now pick @xmath521 and alter our bijection from @xmath151 to @xmath493 so that @xmath255 maps to @xmath522 and extend @xmath12equivariantly to the translates of @xmath481 and @xmath523 .",
    "this ensures that the partial orders on @xmath151 and @xmath496 match for translates of @xmath255 . by repeating this for other values of @xmath24 as necessary",
    ", we can arrange that the partial orders match completely , and can then conclude that @xmath193 and @xmath368 are @xmath12isomorphic as required .",
    "we end by discussing the case when some of the given @xmath23 splittings are conjugate .",
    "we divide the splittings into conjugacy classes and discard all except one splitting from each conjugacy class , to obtain @xmath4 splittings .",
    "now we apply the preceding argument to express @xmath12 uniquely as the fundamental group of a graph @xmath53 of groups with @xmath4 edges .",
    "if an edge of @xmath53 corresponds to a splitting over a subgroup @xmath13 which is conjugate to @xmath524 other splittings , we simply subdivide this edge into @xmath525 sub - edges , and label all the sub - edges and the @xmath524 new vertices by @xmath13 .",
    "this shows the existence of the required graph of groups structure @xmath526 corresponding to the original @xmath23 splittings .",
    "the uniqueness of @xmath527 follows from the uniqueness of @xmath53 , and the fact that the collection of all the edges of @xmath486 which correspond to a given splitting of @xmath12 must form an interval in @xmath486 in which all the interior vertices have valence @xmath107 .",
    "this completes the proof of theorem [ disjointsplittings ] .",
    "now we turn to the proof of theorem [ splittingsexist ] that splittings exist . it will be convenient to make the following definitions .",
    "we will use @xmath528 to denote @xmath529    if @xmath69 is a @xmath13almost invariant subset of @xmath381and @xmath71 is a @xmath11almost invariant subset of @xmath12 , and if @xmath69 and @xmath71 are @xmath13almost equal , then we will say that @xmath69 and @xmath71 are equivalent and write @xmath530 .",
    "( note that @xmath13 and @xmath11 must be commensurable . )",
    "if @xmath13 is a subgroup of a group @xmath12 , the commensuriser in @xmath12 of @xmath13 consists of those elements @xmath50 in @xmath12 such that @xmath13 and @xmath531 are commensurable subgroups of @xmath12 .",
    "the commensuriser is clearly a subgroup of @xmath182 and is denoted by @xmath532 or just @xmath533 , when the group @xmath12 is clear from the context .",
    "now we come to the proof of our second main result .",
    "[ splittingsexist]let @xmath12 be a finitely generated group with a finitely generated subgroup @xmath13 , such that @xmath534 . if there is a non - trivial @xmath118almost invariant subset @xmath69 of @xmath12 such that @xmath535 , then @xmath12 has a splitting over some subgroup @xmath106 commensurable with @xmath13 .",
    "further , one of the @xmath106almost invariant sets @xmath71 determined by the splitting is equivalent to @xmath253    this is the best possible result of this type , as it is clear that one can not expect to obtain a splitting over @xmath13 itself .",
    "for example , suppose that @xmath13 is carried by a proper power of a two - sided simple closed curve on a closed surface whose fundamental group is @xmath536 so that @xmath537 there are essentially only two non - trivial almost invariant subsets of @xmath538 each with vanishing self - intersection number , but there is no splitting of @xmath12 over @xmath384    the idea of the proof is much as before .",
    "we let @xmath44 denote the almost invariant subset @xmath82 of @xmath26 , and let @xmath151 denote @xmath539 .",
    "we want to apply the first part of theorem [ algebrafromtorustheorem ] . as before ,",
    "the assumption that @xmath540 implies that @xmath151 is almost nested .",
    "however , in order to apply theorem [ algebrafromtorustheorem ] , we also need to know that for any pair of elements @xmath104 and @xmath90 of @xmath151 , if two of the four sets @xmath541 are small then one is empty . in the proof of theorem [ disjointsplittings ]",
    ", we simply applied lemma [ emptyorconjugate ] .",
    "however , here the situation is somewhat more complicated .",
    "lemma [ kcommensurises ] below shows that if @xmath542 and @xmath543 are both small , then @xmath50 must lie in a certain subgroup @xmath544 of @xmath545 .",
    "thus it would suffice to arrange that @xmath151 is nested with respect to @xmath544 , ie , that @xmath93 and @xmath69 are nested so long as @xmath50 lies in @xmath544 .",
    "now proposition [ almostnestedimpliesnested ] below tells us that there is a subgroup @xmath106 commensurable with @xmath13 and a @xmath106almost invariant set @xmath71 equivalent to @xmath69 such that @xmath546 is nested with respect to @xmath544 .",
    "it follows that if @xmath363and @xmath90 are any elements of @xmath493 and if @xmath319 and @xmath265 are both small , then one of them is empty .",
    "we also claim that , like @xmath151 , the set @xmath493 is almost nested .",
    "this means that if we let @xmath96 denote @xmath547 , we are claiming that @xmath548 .",
    "let @xmath549 denote @xmath550 .",
    "the fact that @xmath71 is equivalent to @xmath69 means that the pre - images in @xmath551 of @xmath44 and of @xmath552 are almost equal almost invariant sets which we denote by @xmath45 and @xmath97 .",
    "if @xmath323 denotes the index of @xmath106 in @xmath13 , then @xmath553 and similarly @xmath554 is an integral multiple of @xmath555 .",
    "as @xmath45 and @xmath97 are almost equal , it follows that @xmath556 , and hence that @xmath548 as claimed .",
    "this now allows us to apply theorem [ algebrafromtorustheorem ] to the set @xmath493 .",
    "we conclude that @xmath381splits over the stabiliser @xmath549 of @xmath71 , that @xmath549 contains @xmath106 with finite index and that one of the @xmath549almost invariant sets associated to the splitting is equivalent to @xmath460 .",
    "it follows that @xmath557 is commensurable with @xmath13 and that one of the @xmath549almost invariant sets determined by the splitting is equivalent to @xmath253 this completes the proof of theorem [ splittingsexist ] apart from the proofs of lemma [ kcommensurises ] and proposition [ almostnestedimpliesnested ] .",
    "it remains to prove the two results we just used .",
    "the proofs do not use the hypothesis that the set of all translates of @xmath69 and @xmath153 are almost nested .",
    "thus for the rest of this section , we will consider the following general situation .",
    "let @xmath12  be a finitely generated group with a finitely generated subgroup @xmath13  such that @xmath534 , and let @xmath69 denote a non - trivial @xmath13almost invariant subset of @xmath25    recall that our problem in the proof of theorem [ splittingsexist ] is the possibility that two of the four sets @xmath252 are small . as this would imply that @xmath558 or @xmath153 , it is clear that the subgroup @xmath544 of @xmath12 defined by @xmath559 or @xmath560 is very relevant to our problem .",
    "we will consider this subgroup carefully . here",
    "is the first result we quoted in the proof of theorem [ splittingsexist ] .",
    "[ kcommensurises]if @xmath559 or @xmath560 , then @xmath561    the first inclusion is clear .",
    "the second is proved in essentially the same way as the proof of the first part of lemma [ equalsplittings ] .",
    "let @xmath50 be an element of @xmath544 , and consider the case when @xmath558 ( the other case is similar ) . recall that this means that the sets @xmath562 and @xmath563 are both small .",
    "now for each edge of @xmath564 , either it is also an edge of @xmath273 or it has ( at least ) one end in one of the two small sets . as the images in @xmath61 of @xmath273 and of each small set is finite , and",
    "as the graph @xmath53 is locally finite , it follows that the image of @xmath564 in @xmath61 must be finite .",
    "this implies that @xmath565 has finite index in the stabiliser @xmath531 of @xmath564 . by reversing the roles of @xmath69 and @xmath93",
    ", it follows that @xmath565 has finite index in @xmath13 , so that @xmath13 and @xmath566 must be commensurable , as claimed .",
    "it follows that @xmath567 , as required .",
    "another way of describing our difficulty in applying theorem [ algebrafromtorustheorem ] is to say that it is caused by the fact that the translates of @xmath69 and @xmath153 may not be nested .",
    "however , lemma [ finitenumberofdoublecosets ] assures us that `` most '' of the translates are nested .",
    "the following result gives us a much stronger finiteness result .",
    "[ finitelymanynonnested ] let @xmath12 , @xmath13 , @xmath69 , @xmath544 be as above .",
    "then @xmath568 and @xmath69 are not nested@xmath569 consists of a finite number of right cosets @xmath40 of @xmath13 in @xmath25    lemma [ finitenumberofdoublecosets ] tells us that the given set is contained in the union of a finite number of double cosets @xmath570 . if @xmath571 , we claim that the double coset @xmath327 is itself the union of only finitely many cosets @xmath40 , which proves the required result .",
    "to prove our claim , recall that @xmath572 is commensurable with @xmath13 .",
    "thus @xmath572 can be expressed as the union of cosets @xmath573 , for @xmath574 hence @xmath575 so that @xmath327 is the union of finitely many cosets @xmath40 as claimed .",
    "now we come to the key result .",
    "[ kisunionofnormalisers]let @xmath12 , @xmath13 , @xmath69 , @xmath544 be as above . then there are a finite number of finite index subgroups @xmath576 of @xmath13 , such that @xmath544 is contained in the union of the groups @xmath577 , @xmath578 , where @xmath579 denotes the normaliser of @xmath580 in @xmath25    consider an element @xmath50 in @xmath544 .",
    "lemma [ kcommensurises ] tells us that @xmath13 and @xmath531 are commensurable subgroups of @xmath12 .",
    "let @xmath1 denote their intersection and let @xmath5 denote the intersection of the conjugates of @xmath1 in @xmath13 .",
    "thus @xmath5 is of finite index in @xmath13 and @xmath528 and is normal in @xmath13 . now consider the quotient @xmath581 .",
    "let @xmath44 and @xmath45 denote the images of @xmath69 and @xmath93 respectively in @xmath582 .",
    "as before , @xmath44 and @xmath45 are almost invariant subsets of @xmath582 which are almost equal or almost complementary .",
    "now consider the action of @xmath583 on the left on @xmath582 .",
    "if @xmath126 is in @xmath13 , then @xmath584 , so that @xmath585 if @xmath586 and @xmath93 are nested , there are four possible inclusions , but the fact that @xmath587 excludes two of them .",
    "thus we must have @xmath588 or @xmath45 @xmath589 .",
    "this implies that @xmath590 as some power of @xmath126 lies in @xmath5 and so acts trivially on @xmath591 we conclude that if @xmath126 is an element of @xmath592 such that @xmath586 and @xmath93 are nested , then @xmath126 stabilises @xmath593 and so lies in @xmath531 .",
    "hence @xmath126 lies in @xmath1 .",
    "it follows that for each element @xmath126 of @xmath594 , the sets @xmath586 and @xmath93 are not nested .",
    "recall from lemma [ finitelymanynonnested ] that @xmath568 and @xmath69 are not nested@xmath569 consists of a finite number of cosets @xmath40 of @xmath13 in @xmath12",
    ". it will be convenient to denote this number by @xmath595 .",
    "thus , for @xmath596 , the set @xmath597 and @xmath93 are not nested@xmath569 consists of @xmath595 cosets @xmath598 of @xmath531 in @xmath12 .",
    "it follows that @xmath594 lies in the union of @xmath595 cosets @xmath598 of @xmath531 in @xmath12 . as @xmath599",
    ", it follows that @xmath594 lies in the union of @xmath595 cosets @xmath600 of @xmath1 in @xmath12 and hence that @xmath1 has index at most @xmath323 in @xmath384    a similar argument shows also that @xmath1 has index at most @xmath323 in @xmath531 .",
    "of course , the same bound applies to the index of @xmath601 in @xmath13 , for each @xmath24 . now we define @xmath602 clearly @xmath106 is a subgroup of @xmath13 which is normalised by @xmath50 . now",
    "each intersection @xmath601 has index at most @xmath323 in @xmath13 , and so @xmath603 is an intersection of subgroups of @xmath13 of index at most @xmath323 .",
    "if @xmath13 has @xmath23 subgroups of index at most @xmath323 , it follows that @xmath106 has index at most @xmath604 in @xmath13 .",
    "hence each element of @xmath544 normalises a subgroup of @xmath13 of index at most @xmath604 in @xmath13 .",
    "as @xmath13 has only finitely many such subgroups , we have proved that there are a finite number of finite index subgroups @xmath576 of @xmath13 , such that @xmath544 is contained in the union of the groups @xmath579 , @xmath578 , as required .    using this result",
    ", we can prove the following .",
    "let @xmath12 , @xmath13 , @xmath69 , @xmath544 be as above .",
    "then there is a subgroup @xmath27 of finite index in @xmath13 , such that @xmath544 normalises @xmath605    we will consider how @xmath544 can intersect the normaliser of a subgroup of finite index in @xmath13 . let @xmath184 denote a subgroup of @xmath13 of finite index .",
    "we denote the image of @xmath69 in @xmath606 by @xmath44 .",
    "then @xmath44 is an almost invariant subset of @xmath606 .",
    "we consider the group @xmath607 , which we will denote by @xmath608 .",
    "then @xmath609 acts on the left on @xmath610 , and we have @xmath444 or @xmath52 , for every element @xmath4 of @xmath611 , because every element of @xmath544 satisfies @xmath612 or @xmath153 .",
    "now we apply theorem 5.8 from @xcite to the action of @xmath609 on the left on the graph @xmath613 .",
    "this result tells us that if @xmath609 is infinite , then it has an infinite cyclic subgroup of finite index .",
    "further the proof of this result in @xcite shows that the quotient of @xmath614 by @xmath609 must be finite .",
    "this implies that @xmath613 has two ends and that @xmath608 has finite index in @xmath12 .",
    "hence either @xmath609 is finite , or it has two ends and @xmath608 has finite index in @xmath25    recall that there are a finite number of finite index subgroups @xmath615 of @xmath13 , such that @xmath544 is contained in the union of the groups @xmath579 , @xmath578 .",
    "the above discussion shows that , for each @xmath24 , if @xmath616 denotes @xmath617 , either @xmath618 is finite , or it has two ends and @xmath619 has finite index in @xmath12 .",
    "we consider two cases depending on whether or not every @xmath618 is finite .",
    "suppose first that each @xmath618 is finite .",
    "we claim that @xmath544 contains @xmath13 with finite index . to see this ,",
    "let @xmath620 , so that @xmath549 is a subgroup of @xmath13 of finite index , and note that @xmath544 is the union of a finite collection of groups @xmath616 each of which contains @xmath621 with finite index , so that @xmath544 is the union of finitely many cosets of @xmath549 .",
    "it follows that @xmath544 also contains @xmath549 with finite index and hence contains @xmath13 with finite index as claimed .",
    "if we let @xmath106 denote the intersection of the conjugates of @xmath13 in @xmath544 , then @xmath106 is the required subgroup of @xmath13 which is normalised by @xmath622    now we turn to the case when @xmath609 is infinite and so @xmath609 has two ends and @xmath608 has finite index in @xmath25 define @xmath106 to be @xmath623 . as @xmath544 contains @xmath608 with finite index , @xmath106 is the intersection of only finitely many conjugates of @xmath184 . as @xmath544",
    "is contained in @xmath533 , each of these conjugates of @xmath184 is commensurable with @xmath184 .",
    "it follows that @xmath27 is a subgroup of @xmath13 of finite index in @xmath13 which is normalised by @xmath544 .",
    "this completes the proof of the lemma .",
    "the key point here is that @xmath544 normalises @xmath106 rather than just commensurises it .",
    "now we can prove the second result which we quoted in the proof of theorem [ splittingsexist ] .",
    "[ almostnestedimpliesnested]suppose that @xmath66 is a pair of finitely generated groups and that @xmath69 is a non - trivial @xmath13almost invariant subset of @xmath12 .",
    "then , there is a subgroup @xmath106 of @xmath12 which is commensurable with @xmath13 , and a non - trivial @xmath106almost invariant set @xmath71 equivalent to @xmath69 such that @xmath624 is nested with respect to the subgroup @xmath559 or @xmath560 of @xmath64 .",
    "the previous lemma tells us that there is a subgroup @xmath106 of finite index in @xmath13 such that @xmath544 normalises @xmath106 .",
    "let @xmath44 denote the almost invariant subset @xmath82 of @xmath26 , and let @xmath96 denote the almost invariant subset @xmath625 of @xmath626    suppose that the index of @xmath106 in @xmath544 is infinite .",
    "recall from the proof of the preceding lemma that @xmath627 has two ends and that @xmath544 has finite index in @xmath12 .",
    "we construct a new non - trivial @xmath549almost invariant set @xmath71 as follows .",
    "since the quotient group @xmath628 has two ends , @xmath629 splits over a subgroup @xmath549 which contains @xmath27 with finite index .",
    "thus there is a @xmath630almost invariant set @xmath631 in @xmath544 which is nested with respect to @xmath544 .",
    "further , @xmath549 is normal in @xmath629 and the quotient group must be isomorphic to @xmath417 or @xmath449 .",
    "let @xmath632 be coset representatives of @xmath544 in @xmath12 so that @xmath633 .",
    "we take @xmath634 .",
    "it is easy to check that @xmath71 is @xmath549almost invariant and that @xmath635 is nested with respect to @xmath622    now suppose that the index of @xmath106 in @xmath544 is finite .",
    "we will define the subgroup @xmath636 of @xmath637 .",
    "the index of @xmath638 in @xmath544 is at most two .",
    "first we consider the case when @xmath639 .",
    "we define @xmath640 to be the intersection of the translates of @xmath96 under the action of @xmath628 .",
    "thus @xmath641 is invariant under the action of @xmath627 .",
    "as all the translates of @xmath96 by elements of @xmath642 are almost equal to @xmath96 , it follows that @xmath643 so that @xmath644 is also an almost invariant subset of @xmath645 .",
    "let @xmath71 denote the inverse image of @xmath644 in @xmath12 , so that @xmath71 is invariant under the action of @xmath544 . in particular ,",
    "@xmath624 is nested with respect to @xmath544 , as required .",
    "now we consider the general case when @xmath646 .",
    "we can apply the above arguments using @xmath638 in place of @xmath637 to obtain a subgroup @xmath549 of @xmath12 and a @xmath557almost invariant subset @xmath71 of @xmath12 which is equivalent to @xmath69 , and whose translates are nested with respect to @xmath638 .",
    "we also know that @xmath647 is @xmath638invariant .",
    "let @xmath45 denote the image of @xmath71 in @xmath648 , let @xmath4 denote an element of @xmath649 and consider the involution of @xmath650 induced by @xmath4 .",
    "then @xmath45 is a non - trivial almost invariant subset of @xmath648 and @xmath651 .",
    "define @xmath652 , so that @xmath653 and let @xmath48 denote the pre - image of @xmath436 in @xmath12 .",
    "we claim that the translates of @xmath48 and @xmath343 are nested with respect to @xmath544 .",
    "first we show that they are nested with respect to @xmath654 , by showing that @xmath655 is @xmath638invariant . for @xmath656",
    ", we have @xmath657 as @xmath638 must be normal in @xmath544 .",
    "it follows that @xmath658 . as @xmath659",
    ", we see that @xmath48 is @xmath638invariant as required . in order to show that the translates of @xmath48 and @xmath343 are nested with respect to @xmath544",
    ", we will also show that @xmath660 is empty .",
    "this follows from the fact that @xmath661 which is clearly empty .",
    "this completes the proof of proposition [ almostnestedimpliesnested ] .",
    "let @xmath12 be a finitely generated group and let @xmath13 and @xmath11 be subgroups of @xmath12 .",
    "let @xmath69 be a non - trivial @xmath13almost invariant subset of @xmath12 and let @xmath71 be a non - trivial @xmath11almost invariant subset of @xmath25 in section 1 , we discussed what it means for @xmath69 to cross @xmath71 and the fact that this is symmetric .",
    "as mentioned in the introduction , there is an alternative way to define crossing of almost invariant sets .",
    "recall that , in section 1 , we introduced our definition of crossing by discussing curves on surfaces .",
    "thus it seems natural to discuss the crossing of @xmath69 and @xmath71 in terms of their boundaries .",
    "we call this strong crossing .",
    "however , this leads to an asymmetric intersection number . in this section ,",
    "we define strong crossing and discuss its properties and some applications .",
    "we consider the cayley graph @xmath53 of @xmath12 with respect to a finite system of generators .",
    "we will usually assume that @xmath13 and @xmath11 are finitely generated though this does not seem necessary for most of the definitions below .",
    "we will also think of @xmath273 as a set of edges in @xmath53 or as a set of points in @xmath12 , where the set of points will simply be the collection of endpoints of all the edges of @xmath662      [ strongcrossingimpliescrossing]this definition is independent of the choice of generators for @xmath12 which is used to define @xmath53 .",
    "clearly , if @xmath665 crosses @xmath69 strongly , then @xmath71 crosses @xmath69 .",
    "strong crossing is not symmetric . for an example , one need only consider an essential two - sided simple closed curve @xmath2 on a compact surface @xmath0 which intersects a simple arc @xmath1 transversely in a single point .",
    "let @xmath12 denote @xmath666 , and let @xmath13 and @xmath11 respectively denote the subgroups of @xmath12 carried by @xmath2 and @xmath1 , so that @xmath13 is infinite cyclic and @xmath11 is trivial .",
    "then @xmath2 and @xmath1 each define a splitting of @xmath12 over @xmath10and @xmath11 respectively .",
    "let @xmath69 and @xmath71 denote associated standard @xmath13almost invariant and @xmath11almost invariant subsets of @xmath12 .",
    "these correspond to submanifolds of the universal cover of @xmath0 bounded respectively by a line @xmath667 lying above @xmath2 and by a compact interval @xmath668 lying above @xmath1 , such that @xmath669 meets @xmath668 transversely in a single point . clearly , @xmath69 crosses @xmath71 strongly but @xmath71 does not cross @xmath69 strongly",
    ".    however , a strong intersection number can be defined as before .",
    "it is usually asymmetric , but we will be particularly interested in the case of self - intersection numbers when this asymmetry will not arise .    the strong intersection number @xmath670 is defined to be the number of double cosets @xmath42 such that @xmath93 crosses @xmath71 strongly . in particular , @xmath671 if and only if at least one of @xmath672 and @xmath673 is @xmath13finite , for each @xmath145 .    if @xmath35 and @xmath674 are splittings of a group @xmath12 over subgroups @xmath13 and @xmath11 , with associated almost invariant subsets @xmath69 and @xmath71 of @xmath12 , it is natural to say that @xmath35 crosses @xmath674 strongly if @xmath675 .",
    "it is easy to show that this is equivalent to the idea introduced by sela @xcite that @xmath35 is hyperbolic with respect to @xmath674 .",
    "remark [ strongcrossingimpliescrossing ] shows that @xmath676 .",
    "recall that theorem [ splittingsexist ] shows that if @xmath677 , then @xmath12 splits over a subgroup @xmath106 commensurable with @xmath13 .",
    "thus the vanishing of the strong self - intersection number may be considered as a first obstruction to splitting @xmath12 over some subgroup related to @xmath13 .",
    "we will show in corollary [ canmakenested ] that the vanishing of the strong self - intersection number has a nice algebraic formulation .",
    "this is that when @xmath678 vanishes , we can find a subgroup @xmath11 of @xmath12 , commensurable with @xmath13 , and a @xmath11almost invariant subset @xmath71 of @xmath12 which is nested with respect to @xmath679 .",
    "however , @xmath71 may be very different from @xmath69 .",
    "this leads to some splitting results when we place further restrictions on @xmath13 .",
    "[ conditionforsi=0]let @xmath12 be a finitely generated group with finitely generated subgroup @xmath13 , and let @xmath69 be a non - trivial @xmath13almost invariant subset of @xmath12 .",
    "then @xmath671 if and only if there is a subset @xmath71 of @xmath12 which is @xmath13almost equal to @xmath69 ( and hence @xmath13almost invariant ) such that @xmath680 .",
    "suppose that there exists a subset @xmath71 of @xmath12 which is @xmath13almost equal to @xmath170 , such that @xmath680 .",
    "we have @xmath681 as @xmath69 and @xmath71 are @xmath13almost equal .",
    "so , it is enough to show that for every @xmath145 , either @xmath682 or @xmath683 is @xmath13finite .",
    "suppose that @xmath684 .",
    "consider @xmath685 which is a union of a finite number of right cosets @xmath686 , @xmath136 . since @xmath684 , @xmath687 .",
    "for any @xmath123 , @xmath688 .",
    "thus @xmath689 is at a bounded distance from @xmath71 and hence @xmath683 has finite image in @xmath26 .",
    "similarly , if @xmath690 , @xmath691 projects to a finite set in @xmath26 .",
    "for the converse , suppose that @xmath671 and let @xmath692 denote the projection from @xmath12 to @xmath26 . by hypothesis , @xmath693 or",
    "@xmath694 is finite .",
    "the proof of lemma [ posatisfiesdunwoody ] tells us that there is a positive number @xmath323 such that , for every @xmath145 , the set @xmath695 is contained in a @xmath323neighbourhood of @xmath69 or @xmath153 .",
    "let @xmath696 , the @xmath323neighbourhood of @xmath69 and let @xmath697 . if @xmath684 and @xmath123 , then @xmath698 and thus @xmath699 .",
    "if @xmath684 and @xmath123 , then @xmath700 and thus @xmath701 .",
    "it only remains to show that @xmath71 is @xmath13almost equal to @xmath253 this is essentially shown in the third and fourth paragraphs of the proof of theorem [ algebrafromtorustheorem ] .",
    "we will say that a pair of finitely generated groups @xmath66 is of _ surface type _ if @xmath702 for every subgroup @xmath106 of finite index in @xmath13 and @xmath703 for every subgroup @xmath106 of infinite index in @xmath13 .",
    "this terminology is suggested by the dichotomy in @xcite .",
    "note that for such pairs any two non - trivial @xmath13almost invariant sets in @xmath12 are @xmath13almost equal or @xmath13almost complementary .",
    "we will see that for pairs of surface type , strong and ordinary intersection numbers are equal .",
    "[ crossingiffstrongcrossing]let @xmath66 be a pair of surface type , let @xmath704 be a non - trivial @xmath13almost invariant subset of @xmath12 and let @xmath71 be a non - trivial @xmath11almost invariant subset of @xmath12 for some subgroup @xmath11 of @xmath12",
    ". then @xmath71 crosses @xmath69 if and only if @xmath71 crosses @xmath69 strongly .",
    "let @xmath53 be the cayley graph of @xmath12 with respect to a finite system of generators and let @xmath705 .",
    "as in the proof of lemma [ finitenumberofdoublecosets ] , for a set @xmath2 of vertices in a graph , we let @xmath706 denote the maximal subgraph with vertex set equal to @xmath2",
    ". we will show that exactly one component of @xmath242 has infinite image in @xmath61 .",
    "note that @xmath707 has exactly one infinite component as @xmath61 has only two ends .",
    "let @xmath45 denote the set of vertices of the infinite component of @xmath707 and let @xmath89 denote the inverse image of @xmath45 in @xmath12 .",
    "if @xmath708 has components with vertex set @xmath22 , then we have @xmath709 .",
    "let @xmath1 denote the vertex set of a component of @xmath708 , and let @xmath710 be the stabilizer in @xmath13 of @xmath1 .",
    "since @xmath221 is finite , we see that @xmath711 is finite .",
    "hence @xmath712 has more than one end .",
    "now our hypothesis that @xmath66 is of surface type implies that @xmath710 has finite index in @xmath13 and thus @xmath713 is finite .",
    "if @xmath714 , we see that @xmath713 divides @xmath715 into at least three infinite components .",
    "thus @xmath716 and so @xmath708 is connected .",
    "the other components of @xmath242 have finite image in @xmath717 .",
    "similarly , exactly one component of @xmath718 has infinite image in @xmath61 .",
    "the same argument shows that for any finite subset @xmath227 of @xmath61 containing @xmath57 , the two infinite components of @xmath719 and@xmath720 have connected inverse images in @xmath70 .",
    "recall that if @xmath71 crosses @xmath69 strongly , then @xmath71 crosses @xmath69 .",
    "we will next show that if @xmath71 does not cross @xmath69 strongly , then @xmath71 does not cross @xmath69 .",
    "suppose that @xmath721 projects to a finite set in @xmath67 .",
    "take a compact set @xmath227 in @xmath61 large enough to contain @xmath721 and @xmath57 . by the argument above ,",
    "if @xmath436 is the infinite component of @xmath719 , then its inverse image @xmath48 is connected and is contained in @xmath242 .",
    "any two points in @xmath48 can be connected by a path in @xmath48 and thus the path does not intersect @xmath388 .",
    "thus @xmath48 is contained in @xmath71 or @xmath178 .",
    "hence @xmath722 or @xmath723 is empty .",
    "suppose that @xmath724 is empty",
    ". then @xmath725 . since @xmath726 projects to a finite set , we see that @xmath727 projects to a finite set . similarly , if @xmath728 is empty , then @xmath729 projects to a finite set in @xmath83 .",
    "thus , we have shown that if @xmath721 projects to a finite set , then either @xmath727 or @xmath729 projects to finite set .",
    "thus @xmath71 does not cross @xmath69 .",
    "if @xmath66 and @xmath730 are both of surface type and @xmath69 is a non - trivial @xmath13almost invariant set in @xmath12 , and @xmath71 is a non - trivial @xmath11almost invariant set in @xmath12 then @xmath731 . in particular @xmath677 if and only if @xmath732 .",
    "let @xmath11 be a poincar duality group of dimension @xmath733 which is a subgroup of a poincar duality group @xmath12 of dimension @xmath23 .",
    "thus the pair @xmath730 is of surface type . in @xcite , kropholler and roller",
    "defined an obstruction @xmath734 to splitting @xmath12 over a subgroup commensurable with @xmath11 .",
    "their main result was that @xmath734 vanishes if and only if @xmath12 splits over a subgroup commensurable with @xmath11 . at an early stage in their proof",
    ", they showed that @xmath734 vanishes if and only if there is a @xmath11almost invariant subset @xmath71 of @xmath12 such that @xmath735 . starting from this point , proposition [ conditionforsi=0 ] , the above corollary and then theorem [ splittingsexist ] give an alternative proof of their splitting result .",
    "thus theorem [ splittingsexist ] may be considered as a generalization of their splitting theorem .",
    "we next reformulate in our language a conjecture of kropholler and roller @xcite :    [ krconjecture]if @xmath12 is a finitely generated group with a finitely generated subgroup @xmath13 , and if @xmath69 is a non - trivial @xmath13almost invariant subset of @xmath12 such that @xmath671 , then @xmath12 splits over a subgroup commensurable with a subgroup of @xmath13 .",
    "note that theorem [ splittingsexist ] has a stronger hypothesis than this conjecture , namely the vanishing of the self - intersection number @xmath736 , rather than the vanishing of the strong self - intersection number , and it has a correspondingly stronger conclusion , namely that @xmath12 splits over a subgroup commensurable with @xmath13 itself .",
    "a key difference between the two statements is that , in the above conjecture , one does not expect the almost invariant set associated to the splitting of @xmath12 to be at all closely related to @xmath69 .",
    "dunwoody and roller proved this conjecture when @xmath13 is virtually polycyclic @xcite , and sageev @xcite proved it for quasiconvex subgroups of hyperbolic groups .",
    "the paper of dunwoody and roller @xcite contains information useful in the general case .",
    "the second step in their proof , which uses a theorem of bergman @xcite , proves the following result , stated in our language .",
    "( there is an exposition of bergman s argument and parts of @xcite in the later versions of @xcite . )",
    "let @xmath66 be a pair of finitely generated groups , and let @xmath69 be a @xmath13almost invariant subset of @xmath12 .",
    "if @xmath671 , then there is a subgroup @xmath106 commensurable with @xmath13 , and a non - trivial @xmath106almost invariant set @xmath71 with @xmath737 such that the set @xmath635 is almost nested with respect to @xmath738 .",
    "[ canmakenested]with the hypotheses of the above theorem we can choose @xmath27 and a non - trivial @xmath106almost invariant set @xmath71 with @xmath739 such that @xmath740 is almost nested with respect to @xmath532 and is nested with respect to the subgroup @xmath559 or @xmath741 of @xmath532 .          if @xmath12 , @xmath13 are finitely generated groups with @xmath68 , if @xmath742 for every subgroup @xmath11 commensurable with a subgroup of infinite index in @xmath13 , and if @xmath69 is a @xmath13almost invariant subset of @xmath12 such that @xmath743 , then @xmath12 splits over a subgroup commensurable with @xmath13 .",
    "observe that corollary [ canmakenested ] shows that , by changing @xmath13 up to commensurability , and changing @xmath69 , we may assume that the translates of @xmath69 are almost nested with respect to @xmath532 and nested with respect to @xmath744 or @xmath560 .",
    "if we do not have almost nesting for all translates of @xmath69 , then there is @xmath50 outside @xmath532 such that none of @xmath252 is @xmath13finite .",
    "in particular , none of these sets is @xmath745finite . but these four sets are each invariant under @xmath565 and the fact that the strong intersection number vanishes shows that at least one of them has boundary which is @xmath745finite . since @xmath50 is not in @xmath532 , we have a contradiction to our hypothesis that @xmath742 with @xmath746 .",
    "this completes the proof .",
    "we note another application of groups of surface type which provides an approach to the algebraic torus theorem @xcite similar to ours in @xcite .",
    "we will omit a complete discussion of this approach , but will prove the following proposition to illustrate the ideas .",
    "[ bigcommensuriserimpliesvirtuallynormal]if @xmath66 is of surface type and if @xmath13 has infinite index in @xmath532 , then there is a subgroup @xmath27 of finite index in @xmath13 such that the normalizer @xmath747 of @xmath106 is of finite index in @xmath12 and @xmath748 is virtually infinite cyclic . in particular ,",
    "if @xmath13 is virtually polycyclic , then @xmath12 is virtually polycyclic .",
    "let @xmath69 be a non - trivial @xmath13almost invariant subset of @xmath12 , let @xmath50 be an element of @xmath532 and let @xmath749 , so that @xmath172has stabiliser @xmath531 .",
    "let @xmath106 denote the intersection @xmath565 which has finite index in both @xmath13 and in @xmath531 because @xmath50 lies in @xmath532 .",
    "thus @xmath750 and @xmath547 are both almost invariant subsets of @xmath645 . as @xmath66 is of surface type , the pair @xmath751 has two ends so that @xmath752 and @xmath547 are almost equal or almost complementary .",
    "it follows that @xmath69 is @xmath13almost equal to @xmath71 or @xmath178 , ie , @xmath753 or @xmath754 .",
    "recall from lemma [ kcommensurises ] , that if @xmath629 denotes @xmath755 or @xmath756 , then @xmath757 .",
    "it follows that in our present situation @xmath629 must equal @xmath532 . by lemma [ kisunionofnormalisers ]",
    ", we see that there are a finite number of subgroups @xmath576 of finite index in @xmath13 such that @xmath544 is contained in the union of the normalizers @xmath579 . as @xmath13 has infinite index in @xmath758 , one of the @xmath257 ,",
    "say @xmath184 , has infinite index in its normalizer @xmath759 .",
    "as @xmath66 is of surface type , the pair @xmath760 has two ends , so we can apply theorem 5.8 from @xcite to the action of @xmath761 on the left on the graph @xmath614 .",
    "this result tells us that @xmath761 is virtually infinite cyclic .",
    "further the proof of this result in @xcite shows that the quotient of @xmath613 by @xmath761 must be finite so that @xmath762 has finite index in @xmath12 .",
    "[ toomanyends ] let @xmath66 be a pair of finitely generated groups with @xmath118 virtually polycyclic and suppose that @xmath12 does not split over a subgroup commensurable with a subgroup of infinite index in @xmath13 .",
    "if for some subgroup @xmath11 of @xmath13 , @xmath763 , then @xmath12 splits over a subgroup commensurable with @xmath13 .",
    "we end this section with an interpretation of intersection numbers in the case when the strong and ordinary intersection numbers are equal .",
    "this corrects a mistake in @xcite .",
    "suppose that a group @xmath12 splits over subgroups @xmath13 and @xmath11 and let the corresponding @xmath13almost and @xmath11almost invariant subsets of @xmath12 be @xmath69 and @xmath71 .",
    "let @xmath193 denote the bass  serre tree corresponding to the splitting of @xmath12 over @xmath11 and consider the action of @xmath13 on @xmath193 .",
    "let @xmath368 denote the minimal @xmath13invariant subtree of @xmath193 , and let @xmath764 denote the quotient graph @xmath765 similarly , we get a graph @xmath231 by considering the action of @xmath11 on the bass  serre tree corresponding to the splitting of @xmath12 over @xmath13 .",
    "we have :      the proof of theorem 3.1 of @xcite goes through because of our assumption that @xmath767 .",
    "the mistake in @xcite occurs in the proof of lemma 3.6 of @xcite where it is implicitly assumed that if @xmath69 crosses @xmath71 , then it crosses @xmath71 strongly .",
    "since we have assumed that the two intersection numbers are equal , the argument is now valid ."
  ],
  "abstract_text": [
    "<S> we prove algebraic analogues of the facts that a curve on a surface with self - intersection number zero is homotopic to a cover of a simple curve , and that two simple curves on a surface with intersection number zero can be isotoped to be disjoint .    in this paper , we will discuss an algebraic version of intersection numbers which was introduced by scott in @xcite . </S>",
    "<S> first we need to discuss intersection numbers in the topological setting . </S>",
    "<S> let @xmath0 denote a surface and let @xmath1 and @xmath2 each be a properly immersed two - sided circle or compact arc in @xmath0 . here ` </S>",
    "<S> properly ' means that the boundary of the @xmath3manifold lies in the boundary of @xmath0 . </S>",
    "<S> one can define the intersection number of @xmath1 and @xmath2 to be the least number of intersection points obtainable by homotoping @xmath1 and @xmath2 transverse to each other . </S>",
    "<S> ( the count is to be made without any signs attached to the intersection points . ) </S>",
    "<S> it is obvious that this number is symmetric in the sense that it is independent of the order of @xmath1 and @xmath2 . </S>",
    "<S> it is also obvious that @xmath1 and @xmath2 have intersection number zero if and only if they can be properly homotoped to be disjoint . </S>",
    "<S> it seems natural to define the self - intersection number of an immersed two - sided circle or arc @xmath1 in @xmath0 to be the least number of transverse intersection points obtainable by homotoping @xmath1 into general position . with this definition , </S>",
    "<S> @xmath1 has self - intersection number zero if and only if it is homotopic to an embedding . </S>",
    "<S> however , in light of later generalisations , it turns out that this definition should be modified a little in order to ensure that the self - intersection number of any cover of a simple closed curve is also zero . </S>",
    "<S> no modification is needed unless @xmath1 is a circle which can be homotoped to cover another immersion with degree greater than @xmath3 . in this case , suppose that the maximal degree of covering which can occur is @xmath4 and that @xmath1 covers @xmath5 with degree @xmath4 . </S>",
    "<S> then we define the self - intersection number of @xmath1 to be @xmath6 times the self - intersection number of @xmath5 . with this modified definition , @xmath7has self - intersection number zero if and only if it can be homotoped to cover an embedding .    in @xcite , </S>",
    "<S> freedman , hass and scott introduced a notion of intersection number and self - intersection number for two - sided @xmath8injective immersions of compact surfaces into @xmath9manifolds which generalises the preceding ideas . </S>",
    "<S> their intersection number can not be described as simply as for curves on a surface , but it does share some important properties . in  particular , it is a non - negative integer and it is symmetric , although this symmetry is not obvious from the definition . </S>",
    "<S> further , two surfaces have intersection number zero if and only if they can be homotoped to be disjoint , and a single surface has self - intersection number zero if and only if it can be homotoped to cover an embedding . these two facts are no longer obvious consequences of the definition , but are non - trivial applications of the theory of least area surfaces .    </S>",
    "<S> in @xcite , scott extended the ideas of @xcite to define intersection numbers in a purely group theoretic setting . </S>",
    "<S> the details will be discussed in the first section of this paper , but we give an introduction to the ideas here . </S>",
    "<S> it seems clear that everything discussed in the preceding two paragraphs should have a purely algebraic interpretation in terms of fundamental groups of surfaces and @xmath9manifolds , and the aim is to find an interpretation which makes sense for any group . </S>",
    "<S> it seems natural to attempt to define the intersection number of two subgroups @xmath10and @xmath11 of a given group @xmath12 . </S>",
    "<S> this is exactly what the topological intersection number of simple closed curves on a surface does when @xmath12 is the fundamental group of a closed orientable surface and we restrict attention to infinite cyclic subgroups @xmath13 and @xmath11 . </S>",
    "<S> however , if one considers two simple arcs on a surface @xmath0 with boundary , they each carry the trivial subgroup of @xmath14 , whereas we know that some arcs have intersection number zero and others do not . thus intersection numbers are not determined simply by the groups involved . </S>",
    "<S> we need to look a little deeper in order to formulate the algebraic analogue . </S>",
    "<S> first we need to think a bit more about curves on surfaces . </S>",
    "<S> let @xmath1 be a simple arc or closed curve on an orientable surface @xmath0 , let @xmath12 denote @xmath15 and let @xmath13 denote the image of @xmath16 in @xmath12 . </S>",
    "<S> if @xmath1 separates @xmath0 then , in most cases , it gives @xmath12 the structure of an amalgamated free product @xmath17 , and if @xmath1 is non - separating , it gives @xmath12 the structure of a hnn extension @xmath18 . in order to avoid discussing which of these two structures @xmath12 has , </S>",
    "<S> it is convenient to say that a group @xmath12 _ splits over a subgroup _ </S>",
    "<S> @xmath13 if @xmath12 is isomorphic to @xmath18 or to @xmath17 , with @xmath19 . </S>",
    "<S> ( note that the condition that @xmath19 is needed as otherwise any group @xmath12 would split over any subgroup @xmath13 . </S>",
    "<S> for one can always write @xmath20 . ) thus , in most cases , @xmath1 determines a splitting of @xmath14 . </S>",
    "<S> usually one ignores base points , so that the splitting of @xmath12 is only determined up to conjugacy . in @xcite , </S>",
    "<S> scott defined the intersection number of two splittings of any group @xmath12 over any subgroups @xmath13 and @xmath11 . in the special case </S>",
    "<S> when @xmath12 is the fundamental group of a compact surface @xmath0 and these splittings arise from embedded arcs or circles on @xmath0 , the algebraic intersection number of the splittings equals the topological intersection number of the corresponding @xmath3manifolds . </S>",
    "<S> the analogous statement holds when @xmath12 is the fundamental group of a compact @xmath9manifold and these splittings arise from @xmath8injective embedded surfaces . in general , the algebraic intersection number shares some properties of the topological intersection number . </S>",
    "<S> algebraic intersection numbers are symmetric , and if @xmath12 , @xmath13 and @xmath11 are finitely generated , the intersection number of splittings of @xmath12 over @xmath13 and over @xmath11 is a non - negative integer .    </S>",
    "<S> the first main result of this paper is a generalisation to the algebraic setting of the fact that two simple arcs or closed curves on a surface have intersection number zero if and only if they can be isotoped apart . </S>",
    "<S> of course , the idea of isotopy makes no sense in the algebraic setting , so we need some algebraic language to describe multiple disjoint curves on a surface . </S>",
    "<S> let @xmath21 be disjoint simple arcs or closed curves on a compact orientable surface @xmath0 with fundamental group @xmath12 , such that each @xmath22 determines a splitting of @xmath12 . </S>",
    "<S> together they determine a graph of groups structure on @xmath12 with @xmath23 edges . </S>",
    "<S> we say that a collection of @xmath23 splittings of a group @xmath12 is _ compatible _ if @xmath12 can be expressed as the fundamental group of a graph of groups with @xmath23 edges , such that , for each @xmath24 , collapsing all edges but the @xmath24-th yields the @xmath24-th splitting of @xmath25 we will say that the splittings are _ compatible up to conjugacy _ if collapsing all edges but the @xmath24-th yields a splitting of @xmath12 which is conjugate to the @xmath24-th given splitting . </S>",
    "<S> clearly disjoint essential simple arcs or closed curves on @xmath0 define splittings of @xmath12 which are compatible up to conjugacy . </S>",
    "<S> the precise statement we obtain is the following .    * theorem [ disjointsplittings ] </S>",
    "<S> *    so far , we have not discussed any algebraic analogue of non - embedded arcs or circles on surfaces . </S>",
    "<S> there is such an analogue which is the idea of an almost invariant subset of the quotient @xmath26 , where @xmath13 is a subgroup of @xmath12 . </S>",
    "<S> this generalises the idea of an immersed curve in a surface or of an immersed @xmath8injective surface in a 3manifold which carries the subgroup @xmath13 of @xmath12 . </S>",
    "<S> we give the definitions in section 1 . </S>",
    "<S> there is also an idea of intersection number of such things , which we give in definition [ defnofintersectionnumber ] . </S>",
    "<S> this too was introduced by scott in @xcite . </S>",
    "<S> our second main result , theorem [ splittingsexist ] , is an algebraic analogue of the fact that a singular curve on a surface or a singular surface in a @xmath9manifold which has self - intersection number zero can be homotoped to cover an embedding . </S>",
    "<S> it asserts that if @xmath26 has an almost invariant subset with self - intersection number zero , then @xmath12 has a splitting over a subgroup @xmath27 commensurable with @xmath13 . </S>",
    "<S> we leave the precise statement until section 2 .    in a separate paper @xcite </S>",
    "<S> , we use the ideas about intersection numbers of splittings developed in @xcite and in this paper to study jsj decompositions of haken @xmath9manifolds . </S>",
    "<S> the problem there is to recognize which splittings of the fundamental group of such a manifold arise from the jsj decomposition ( see @xcite and @xcite ) . </S>",
    "<S> it turns out that a class of splittings which we call canonical can be defined using intersection numbers and we use this to show that the jsj decomposition for haken @xmath9manifolds depends only on the fundamental group . </S>",
    "<S> this leads to an algebraic proof of johannson deformation theorem . </S>",
    "<S> it seems very likely that similar ideas apply to sela s jsj decompositions @xcite of hyperbolic groups and thus provide a common thread to the two types of jsj decomposition . </S>",
    "<S> thus , the use of intersection numbers seems to provide a tool in the study of diverse topics in group theory and this paper together with @xcite provides some of the foundational material .    </S>",
    "<S> this paper is organised as follows . </S>",
    "<S> in section 1 , we recall from @xcite the basic definitions of intersection numbers in the algebraic context . we also prove a technical result which was essentially proved by scott @xcite in 1980 . </S>",
    "<S> however , scott s results were all formulated in the context of surfaces in @xmath9manifolds , so we give a complete proof of the generalisation to the purely group theoretic context . </S>",
    "<S> section 2 is devoted to the proofs of our two main results discussed above .    </S>",
    "<S> there is a second natural idea of intersection number , which we discuss in section 3 . </S>",
    "<S> we call it the strong intersection number . </S>",
    "<S> it is not symmetric in general , but this is not a problem when one is considering self - intersection numbers . </S>",
    "<S> we also discuss when the two kinds of intersection number are equal , which then forces the strong intersection number to be symmetric . </S>",
    "<S> we use these ideas to give a new approach to a result of kropholler and roller @xcite on splittings of poincar duality groups . </S>",
    "<S> we also discuss applications of our ideas to prove a special case of a conjecture of kropholler and roller @xcite on splittings of groups in general . </S>",
    "<S> we point out that these ideas lead to an alternative approach to the algebraic torus theorem @xcite . </S>",
    "<S> we end the section with a brief discussion of an error in @xcite . in section 3 of that paper , </S>",
    "<S> scott gave an incorrect interpretation of the intersection number of two splittings . </S>",
    "<S> his error was caused by confusing the ideas of strong and ordinary intersection . </S>",
    "<S> however , the arguments in @xcite work to give a nice interpretation of the intersection number in the case when it is equal to the strong intersection number . without this condition , finding nice interpretations of the two intersection numbers is an open problem . </S>"
  ]
}