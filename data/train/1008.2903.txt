{
  "article_text": [
    "it has long been understood that dark matter plays an essential role in galaxy formation .",
    "@xcite demonstrated that dark matter haloes act as potential wells within which infalling material can be captured and condense to form galaxies .",
    "as the universe ages , these haloes merge to form larger structures and this continued process produces the framework of the universe that we see today .",
    "this so called hierarchical model of galaxy formation has been put to many tests including those generated by @xmath0-body simulation .",
    "one of the most widely used of these simulations is the _ millennium simulation _ @xcite which accurately reproduced the large - scale structure of a 500 mpc/@xmath1 cube region of the universe .",
    "one of the challenges of studying the results of @xmath0-body simulations has been finding a consistent way of identifying the structures and substructures within them .",
    "detailed studies of haloes and subhaloes require halo finders , codes that scan the simulation outputs and identify structures .",
    "many different halo finders are available and each uses different techniques and definitions of the haloes they find .",
    "broadly , halo finders fall into two general categories ; those based on the friends - of - friends ( fof ) technique and those based on grids .",
    "fof was first proposed by @xcite and locates haloes based on a predetermined linking length for particles .",
    "this is usually a fraction of the mean inter - particle separation and any two particles closer than this distance are linked together .",
    "isolated sets of linked particles are then identified as the haloes .",
    "commonly a value of 0.2 times the mean inter - particle separation is chosen motivated by scdm ( @xmath2 & @xmath3 ) @xcite and a slightly lower value of 0.16 is sometimes adopted for @xmath4cdm ( @xmath5 & @xmath6 ) @xcite . despite the difference , convergence between cosmologies in the halo mass function can be found using 0.2 ( see * ? ? ?",
    "* ) making this the most widely used .",
    "the fof method was implemented in , for example , subfind @xcite and hfof @xcite , with different techniques being used to find subhaloes .",
    "hfof uses hierarchical fof to locate the subhaloes by using a shorter linking length inside the halo , while subfind searches the haloes for overdensities in the density profile .",
    "the grids method of halo finding works by placing a grid across the simulation and smoothing the discrete particle data onto that grid and then locating the densest cells .",
    "refinement can be built onto the grid to obtain improved resolution and to increase the speed of the code .",
    "the density peaks that are located on the grid can then be used as the seeds for potential structures .",
    "this technique was used by , for example , ahf @xcite and asohf @xcite .",
    "the variations between these codes comes in the definition of haloes .",
    "ahf uses isodensity contours on the grid , while asohf uses spherical overdensities .",
    "fof and grid based methods are the two main ways for locating structure , but there are alternatives .",
    "more recent finders , such as hsf @xcite , have tried using phase space to identify subhaloes .",
    "this extends the search based on position and density to incorporate the velocity of the particles .",
    "bulk velocities can then also be used to help identify structures .",
    "other finders that have tried different techniques include voboz @xcite , which replaced the uniform grid with a voronoi diagram , and surv @xcite , which uses knowledge of the structures from one snapshot to help find structure in the next .",
    "while this summary of halo finders is by no means exhaustive , it does give a flavour for the different techniques employed .",
    "a thorough review of the different types of halo finders available and their effectiveness will be found in knebe et al .",
    "( in preparation ) .",
    "the importance of accurate subhalo detection has increased in recent years with the advances in high resolution simulations .",
    "various simulations of milky way sized haloes have been produced including _ via lactea _",
    "@xcite , _ aquarius _ @xcite and ghalo @xcite .",
    "as expected , these haloes contain a wealth of substructure ( see * ? ? ?",
    "however , it is important to ask how robust the recovered properties of subhaloes are to the choice of subhalo finder .",
    "for example , subhaloes are identified initially as overdensities in their host haloes .",
    "we expect picking out such overdensities to be more difficult in the innermost parts of the host haloes where the background density is the greatest .",
    "if one halo finder is less able to pick out these overdensities than another halo finder , we would expect this halo finder to systematically underpredict the numbers of subhaloes in the inner parts of haloes , which would have important implications for how we interpret the results of , for example , the radial distribution of subhaloes and subhalo mass loss .    in this paper we set out to quantify the extent to which our choice of halo finder impacts on the radial distribution of subhaloes that we recover .",
    "specifically we focus on subfind @xcite and ahf @xcite and ask how well these halo finders can recover the properties of a nfw subhalo @xcite embedded in a more massive host nfw halo .",
    "the advantage of this approach is that , unlike using haloes and subhaloes drawn from cosmological simulations , we know exactly which particles belong to the host and to the subhalo at initial time and we can track their positions and velocities at all subsequent times .",
    "this provides a clean test of the halo finders because any discrepancies found can be identified easily .",
    "the rest of this paper is setout as follows . in ",
    "[ method ] we outline the methods used , including summaries of the halo finders and the process of constructing a mock 6d ( @xmath7 , @xmath8 , @xmath9 , @xmath10 , @xmath11 , @xmath12 ) nfw halo by reproducing the density and velocity profiles .",
    "we then use this construction , in  [ model ] , to model an infalling subhalo .",
    "this is undertaken in two ways , first by considering how well the halo finders recover the subhalo when simply placed at different radii within the main halo .",
    "the second method is to let the subhalo fall into the main halo under gravity and compare how the different halo finders recover the subhalo .",
    "having established the accuracy of the halo finders , in  [ strip ]",
    "we investigate the effect the trajectory of the subhalo has on stripping as it passes through the halo . in ",
    "[ circ ] we test the reliability of recovering the peak in the circular velocity profile .",
    "finally we summarise our results . throughout this work ,",
    "a standard @xmath4cdm cosmology has been adopted , taking @xmath5 , @xmath6 and @xmath13 , where appropriate , consistent with observations from wmap first year results @xcite .",
    "for the purpose of this work we focus on two halo finders that rely on different methods to detect haloes and subhaloes .",
    "ahf@xcite is an updated version of mhf @xcite and works using an adaptive mesh refinement method .",
    "it begins by placing a user - defined grid across the box and calculates the particle density in each cell .",
    "if this is greater than a user - specified value , then the cell is refined with a smaller grid .",
    "the particle density is then recalculated on this finer grid and , if required , further refinement is carried out . once all the refinements are carried out , a hierarchical grid tree of the density distribution has been produced and this can be used to find structure . throughout this work",
    ", we used a grid of 128 cells with refinement being carried out in cells that contain more than 3 particles .",
    "the most refined and isolated cells are used as potential halo centres and these are linked to the coarser grids to build the structure .",
    "if two isolated centres join up on a coarser grid then these are combined into one structure . by considering these separate , isolated points in one structure",
    ", substructure can be defined .",
    "once the structures are identified , starting on the lowest level of substructure , they are tested for boundness in isolation .",
    "this is conducted by comparing the particles velocity to the local escape velocity obtained using a spherical potential approximation .",
    "if a particle is found to be unbound it is assigned to the next highest level of structure until it is dispensed with if not bound to the halo .",
    "the haloes are then truncated at the virial radius ( see  [ mock ] ) to define their size . for the subhaloes ,",
    "not all have a low enough overdensity to satisfy the virial radius due to the background density of the halo .",
    "if this is the case then they are truncated by a sharp spherical boundary at the outer radius at which their density profile first shows an upturn and starts to rise with increasing distance .",
    "subfind @xcite begins by conducting a standard friends - of - friends ( fof ) search of the simulation volume to identify haloes . at each particle",
    "the local density is then calculated using a local sph - like smoothing kernel interpolation over the nearest neighbours .",
    "any locally overdense region is then considered as a subhalo candidate with its shape being defined by an isodensity contour that traverses the saddle point in the density profile of the halo . this is found by lowering the global density threshold and selecting out the overdense regions . at this stage particles can be members of more than one structure allowing different levels of substructure to be determined .",
    "for this work , we used a fof linking length of 0.2 and 10 particles for the sph density calculation allowing subfind to recover all subhaloes with 10 or more particles .",
    "tests were also carried out using higher values for the sph density calculation , but the number of particles recovered was found to be relatively insensitive to this parameter for the size of the subhalo we used .",
    "once subhalo candidates have been identified , an unbinding procedure is used to determine iteratively which particles are not gravitationally bound .",
    "this is achieved by defining the centre of the subhalo as the position of the most bound particle and the bulk velocity as the mean velocity of the particles in the group .",
    "the kinetic and potential energies of the particles are then compared and unbound particles are removed .",
    "the final step is to assign particles that are listed in multiple structures to just one . to solve this ,",
    "the particles are assigned to the smallest structure they are found in .",
    "the remaining fof particles that have not been assigned to substructure are then tested for boundness and assigned to the background halo .",
    "any particles that are not bound to anything are then classified as fof fuzz.      the following outlines the process of constructing a mock dark matter halo . for simplicity we have limited ourselves to the case of a spherical halo that follows a radial nfw density profile , @xmath14 where @xmath15 is the critical density of the universe , @xmath16 is the scale radius and @xmath17 is the characteristic density .",
    "dark matter haloes are characterised by their virial mass , @xmath18 where @xmath19 is the virial radius and @xmath20 is the virial approximation given by @xcite as , @xmath21 where , @xmath22 for @xmath5 , @xmath6 and @xmath23 , @xmath24 . using the scale radius and the virial approximation , the characteristic density is given by , @xmath25 where @xmath26 is the concentration .",
    "using these conditions , a monte carlo realisation can be constructed by defining the number of particles within @xmath19 , @xmath27 , and specifying the concentration of the halo required .",
    "the monte carlo realisation is produced by drawing a random enclosed mass and inverting to find a radius .",
    "this is then turned into a set of coordinates by specifying they produce a smooth distribution on the surface of a sphere .",
    "the mass of a nfw halo continues to increase with increasing radius and so in principle has infinite mass ; we circumvent this by truncating the halo beyond a cut - off radius , @xmath28 .",
    "this modifies the density profile so that @xmath29 follows the nfw profile and @xmath30 . for this work we set @xmath31 .",
    "a smoother truncation could be produced by using a exponential decay at the edge of the halo .",
    "once the halo is constructed , each particle needs to be given a velocity that reproduces the velocity dispersion , @xmath32 , of a halo .",
    "dark matter haloes are supported by the random motion of the particles and to get an accurate representation we need to reproduce this in the velocity of the particles .",
    "the velocity dispersion can be obtained by considering the jeans equation , @xmath33 where @xmath34 and @xmath35 is the gravitational potential .",
    "assuming isotropy , @xmath36 , @xmath37 and the velocity dispersion is given by , @xmath38 this integral was solved by @xcite , and confirmed here , to give , @xmath39 } \\ [ \\pi^2-\\ln(cs)-\\frac{1}{cs } \\nonumber \\\\   & \\hspace{-1.2 cm } - & \\hspace{-0.9 cm } \\frac{1}{(1+cs)^2 } -\\frac{6}{1+cs }   + \\left(1+\\frac{1}{c^2s^2 } - \\frac{4}{cs }   - \\frac{2}{1+c s } \\right ) \\nonumber   \\\\   & \\hspace{-1.2 cm } \\times & \\hspace{-0.9 cm }   \\ln ( 1+c s )   + 3 \\ln^2 ( 1+c s ) + 6 \\ , { \\rm li}_2(-cs ) ] \\ , \\end{aligned}\\ ] ] where @xmath40 , @xmath41 is the circular velocity at the virial radius and @xmath42 is the dilogarithm function given by ,    @xmath43    the 3d velocity dispersion is then given by the sum of the individual components . since isotropy was assumed this gives @xmath44 . to generate a velocity distribution function for a given radius ,",
    "a maxwell - boltzmann distribution can be assumed ( cf . * ? ? ?",
    "* ) , @xmath45 the function @xmath46 is normalised such that , @xmath47 the velocity of each particle can then be obtained using the probability distribution of equation  ( [ mb ] ) . having obtained the density and velocity profiles of the halo , the only thing left is to assign a direction to each velocity .",
    "this is done by simply requiring that the directional velocity vectors produce a smooth distribution on the surface of a unit sphere .    , @xmath48 and @xmath49 halo left to evolve over 8 gyr .",
    "the black line denotes the theoretical nfw profile , while the mock halo is shown initially ( black pluses ) , after 4 gyr ( red asterisks ) and 8 gyr ( blue crosses ) .",
    "the arrow represents the plummer equivalent softening ( @xmath50).,width=309 ]    to test the stability of this setup , an isolated halo with @xmath51 , @xmath48 and @xmath49 was left to evolve over 8 gyr using gadget-2 @xcite .",
    "the spline gravitational softening was set to @xmath52 corresponding roughly to the radius of the 100th particle ( see * ? ? ?",
    "[ dens ] shows that the halo retains the overall shape of an nfw profile , except at the centre where the profile has flattened similar to that observed by @xcite .",
    "this flattening of the density profile is caused by approximating the distribution function with a maxwell - boltzmann . as demonstrated in @xcite",
    ", this will lead to an over estimate of any stripping that occurs . despite this",
    ", it will have no effect on the ability of halo finders to recover the haloes .",
    "this was confirmed by using the method outlined in @xcite to generate haloes with @xcite and @xcite density profiles based on their 6d distribution functions .",
    "when the same tests were carried out on these haloes , the same patterns between the halo finders was found as for the nfw with the maxwell - boltzmann approximation .",
    "the first method of modelling the infall of a subhalo we adopted was to consider how well different halo finders recovered the subhalo at a given radius .",
    "this was achieved by placing the same sized subhalo _ by hand _ at different radii within the main halo and attempting to recover it with each halo finder .",
    "a halo was generated with @xmath51 , @xmath48 and @xmath49 and a subhalo with @xmath53 , @xmath54 and @xmath55 .",
    "the concentration of the subhalo was set to be higher than the halo in order to reflect the conditions found in cosmological simulations ( see * ? ? ?",
    "* ; * ? ? ?",
    "the subhalo was then placed at different distances away from the centre of the halo and given a velocity , @xmath56 where @xmath57 is the mass of the halo and @xmath58 is the separation of the centres of the halo and subhalo , towards the centre of the halo .",
    "this velocity corresponds to the conversion of potential energy to kinetic , for two point masses , as the subhalo falls in from infinity .",
    "when the subhalo was placed at the centre of the halo , @xmath59 so @xmath60 . to overcome this , the subhalo was given a velocity of the previous closest separation when it was at the centre of the halo .",
    "this set - up was produced 100 times for each separation using different random number seeds .",
    "consistent realisations were found each time .",
    "[ subpos ] shows the fraction of particles recovered by each halo finder at different separations .",
    "neither halo finder can recover the subhalo when it is near the centre of the halo .",
    "this corresponds to the densest region of the halo and leads to any overdensity from the subhalo being hidden .",
    "as the separation is increased ahf has a steep rise in the fraction of particles it recovers until it is finding the complete subhalo from @xmath61 outwards .",
    "subfind does not have such a drastic change and continues to underestimate the size of subhalo all the way out to @xmath62 .",
    "we can gain some insight into the strong radial dependence in recovered particle number in subfind by considering the following simple argument .",
    "subfind identifies subhaloes as overdensities ; it identifies when a subhalo s local density equals its host halo s local density .",
    "this equates to , @xmath63 where @xmath64 and @xmath65 are the characteristic densities of the halo and subhalo respectively ( equation  [ deltac ] ) , @xmath66 and @xmath67 are the scale radii of the halo and subhalo respectively , @xmath58 is the separation of the centres of the halo and subhalo and @xmath68 is the radius of the subhalo at which the densities are equal .",
    "the number of particles within @xmath68 can not exceed @xmath27 by construction .",
    "the shape of the theoretical curve ( dotted line in fig .",
    "[ subpos ] ) implied by equation  ( [ eqnfw ] ) reasonably captures the shape of the curve recovered by subfind .",
    "the agreement is not perfect , equation  ( [ eqnfw ] ) predicts more mass should be recovered at larger radii than is recovered in practise , but the differences can be easily understood .",
    "first , based on the random nature of the velocity assignment some of the particles will have large velocities and will therefore not be bound .",
    "the effect of this will be to cause the two curves to deviate systematically from each other with increasing radius .",
    "second , subfind identifies overdensities as saddle points in the mass density profile rather than by equating subhalo and halo mass profiles , as implied by equation  ( [ eqnfw ] ) .",
    "overall the curve shares the same shape as that found using subfind , indicating that the background density is affecting the ability to recover the subhalo .",
    "implanting a nfw subhalo in a larger halo , defining the virial radius using equation  ( [ vir ] ) , is obviously a highly idealised situation .",
    "realistically the subhalo would be expected to undergo stripping which would cause it to be stripped down to its tidal radius at different points within the halo .",
    "this tidal radius would roughly correspond to the radius at which there is a saddle point in the density profile @xcite .",
    "this also corresponds to the size of the overdensity that subfind is recovering .",
    "therefore , if the edge of the subhalo is defined as the tidal radius , subfind would give consistent recovery of the subhalo .        a different method of determining the size of the subhalo",
    "is to consider the peak in the circular velocity profile ( see * ? ? ?",
    "* ; * ? ? ?",
    "this will be less affected by truncation of the subhalo , as the particle with the maximum circular velocity is closer to the centre .",
    "[ vc ] shows the recovered maximum circular velocity for the subhalo at different separations .",
    "this was obtained by calculating the circular velocity for each particle in the subhalo and taking the largest of these as the peak . as expected",
    ", both halo finders more accurately recover the subhalo size using this method .",
    "subfind still displays a slight radial dependence , with a gradual decrease towards the centre of the halo .",
    "this is caused by high velocity particles near the centre of the subhalo being unbound due to the truncation . as the subhalo was not detected at the centre of the halo",
    ", it is not possible to obtain a circular velocity there .          the second method of investigating the infall of a subhalo was to allow the system to evolve under gravity .",
    "the same halo and subhalo properties were set up as in  [ place ] .",
    "the subhalo was then placed so that @xmath69 of the halo and it was given a velocity toward the centre of the halo from equation  ( [ gp ] ) .",
    "the subhalo was then left to free - fall through the halo for 6 gyr using gadget-2 with gravitational softening @xmath52 .",
    "snapshots were taken every 0.05 gyr . during this run cosmological expansion",
    "was turned off so the haloes were only affected by gravity .",
    "[ infall ] shows the fraction of particles recovered by subfind and ahf as the subhalo passed through the halo .",
    "the subhalo undergoes a large amount of stripping , loosing around 75 per cent of its mass .",
    "most of this stripping occurs as the subhalo passes through the very centre of the halo .",
    "this corresponds to the greatest rate of change of the potential and so would be expected to have the largest effect . as predicted in  [ place ] both",
    "halo finders fail to recover the subhalo as it passes through the centre of the halo and disagree about the size of the subhalo immediately either side of this region .",
    "the largest discrepancy occurs when the subhalo is within the virial radius of the halo .",
    "as expected due to its definition of a subhalo , subfind recovers a smaller subhalo during the infall phase compared with ahf .",
    "after the subhalo has passed the centre of halo , ahf recovers a much larger number of particles due to its unbinding procedure being less efficient and this is discussed further in  [ strip ] .",
    "as expected , the level of stripping observed is consistent with @xcite and higher than @xcite .",
    "as seen in  [ dynam ] , an infalling subhalo only undergoes stripping as it passes through the very centre of the halo .",
    "this should mean that any subhalo that does not pass through the centre of the halo and is merely deflected around it should undergo significantly less stripping . to test this hypothesis ,",
    "the subhalo was placed at a separation of 3.0@xmath19 in the @xmath7-axis and 0.0 , 0.5@xmath19 and 1.0@xmath19 in the @xmath8-axis . in each case",
    "the subhalo was given the same velocity along the @xmath7-axis toward the halo as in  [ dynam ] .",
    "the subhalo that was on the @xmath7-axis followed the same path as the subhalo in  [ dynam ] passing straight through the halo centre .",
    "the other two subhaloes were deflected around the halo centre with closest approaches of 0.2@xmath19 and 0.5@xmath19 respectively .",
    "[ deflection ] shows the fraction of particles recovered by each halo finder for the three scenarios outlined and also the value of the peak in the circular velocity profile .",
    "both halo finders give consistent values for the the final sizes of the subhalo after stripping .",
    "for the two subhaloes that do not pass through the centre of the halo , the amount of stripping is noticeably less .",
    "the subhalo loses around 35 per cent and 50 per cent of its mass for closest approaches of 0.5@xmath19 and 0.2@xmath19 respectively compared with over 75 per cent if it passes through the centre .        comparing the halo finders as the subhalo passes through the central region of the halo ,",
    "both show a characteristic dip in the number of particles recovered .",
    "it is also noticeable that as the subhalo leaves the centre of the halo , ahf always finds a larger subhalo than subfind .",
    "this is also shown very clearly in fig .",
    "[ infall ] where in the region @xmath70 ahf gives much higher recovery of particles compared with subfind which has flattened off .",
    "the cause of this difference can be seen in the lower left panel of fig .",
    "[ deflection ] by considering the maximum circular velocity .",
    "after the subhalo has passed through the centre of the halo , the maximum circular velocity recovered by ahf spikes meaning that background halo particles are being included in the subhalo .",
    "there is no such spike in the subfind value ( lower right panel ) .",
    "this shows that the unbinding of particles is more efficient in subfind than ahf .",
    "this discrepancy is caused by ahf assuming spherical symmetry for the unbinding when the subhalo becomes elongated in the centre of halo and is no longer a spherical shape .",
    "for the subhalo with the closest approach of @xmath71 , ahf shows a smooth transition in the size of the subhalo , while subfind shows the size to decrease and then increase again . during this transition",
    "the subhalo always has a finite size as the subhalo does not pass close enough to the halo centre to completely vanish .",
    "the decrease and increase in the size of the subhalo demonstrates that it is being truncated at a radius smaller than its actual size .",
    "as the saddle point in the density profile corresponds to the tidal radius @xcite , this in turn shows that a subhalo not passing through the centre of a halo will not be completely stripped down to its tidal radius .",
    "this is perhaps not that surprising as the subhalo has not spent a long enough time in the halo to undergo the full effects of tidal stripping .",
    "the maximum circular velocity is shown in fig .",
    "[ deflection ] to be a much more stable quantity compared to particle number as expected from  [ place ] .",
    "the strong radial dependence of subfind in particle number is not present in maximum circular velocity . while this is an advantage in recovering properties of the subhalo , fig .",
    "[ deflection ] also shows how this quantity can be misleading when considering stripping . for the case where the subhalo passes within 0.5@xmath19",
    ", the subhalo was stripped of around 35 per cent of its mass , but the maximum circular velocity changes by less than 5 per cent .",
    "this is caused by the maximum circular velocity being located at a radius much closer to the centre of the subhalo and so is less affected by stripping which occurs primarily in the outer regions .",
    "and @xmath55 halo .",
    "error bars represent 1 standard deviation and are distributed symmetrically in log space . for the average to be within 2.5 per cent of the maximum value ,",
    "in excess of 500 particles are required.,width=309 ]    as seen in the previous sections , the peak in the circular velocity profile of a subhalo is a more stable quantity to recover than the total subhalo mass .",
    "the origin of this stability is related to the fact that the radius at which the maximum circular velocity is reached is located much closer to the centre of the halo and so is unaffected by truncation .",
    "[ conc ] shows how the position of peak changes with the concentration of a halo . for a nfw halo",
    "this can be obtained numerically to give , @xmath72 the values determined by equation  ( [ vmax ] ) are based on an ideal nfw halo , but for low resolution haloes there will be deviations from this curve . for the subhalo used in this work ( @xmath55 ) @xmath73 which corresponds to roughly @xmath74 ( the radius at which the enclosed density is 5,000 times the critical density , @xmath15 ) .",
    "stripping occurs in the outer regions of the subhalo and so for it to affect this radius a large amount of material needs to be lost , consistent with fig .",
    "[ deflection ] .",
    "one of the main issues with using the maximum circular velocity of a halo is how its measurement depends upon resolution . to investigate this",
    ", we generated a halo with @xmath53 and @xmath55 in isolation using a different number of particles within the virial radius each time .",
    "for each number of particles within the virial radius , we constructed 1,000 realisations in order to constrain the variation .",
    "[ res ] shows how the recovered maximum circular velocity varied with the total particle number . for the sparsely populated realisations the average maximum circular velocity was higher than the analytic value .",
    "as more particles were used , the two values converged . for the average value to be within 2.5 per cent of the analytic value , in excess of 500 particles were required in the halo .",
    "the variation of the maximum circular velocity between different realisations of the same total virial particle number is strong for the sparsely populated haloes . at all points",
    "the curve is within 1 standard deviation of the analytic value , but the variation is clear where for 10 particles the standard deviation is 0.56 compared with 0.002 for 10,000 . to obtain an accurate value for the maximum circular velocity of a recovered subhalo",
    ", its resolution has to be taken into account .",
    "halo finders are an important tool for the analysis of cosmological simulations .",
    "they are pivotal in the construction of merger trees , which underpin galaxy formation modelling , and their results allow us to characterise , for example , the abundance and spatial distribution of both dark matter haloes and subhaloes .",
    "there are as many techniques for identifying haloes and subhaloes in cosmological simulations as there are halo finders and so it is interesting to ask whether or not ( sub)halo properties recovered by different halo finders are consistent .    in this paper",
    "we have compared and contrasted the results of two halo finders , subfind and ahf , that use fundamentally different approaches to identifying subhaloes .",
    "we have taken a simple test problem , the identification of a nfw subhalo embedded in a more massive nfw halo , and compared the performance of subfind and ahf in recovering the mass of the subhalo at different radii within its host .",
    "as shown using subfind , halo finders that identify subhaloes as overdensities will have a strong dependence on the local density .",
    "this is demonstrated in the strong radial dependence in the fraction of a model subhalo subfind recovers . as the subhalo gets closer to the centre of the halo ,",
    "the background density from the halo is rising . with a higher background density and the same density for the subhalo",
    ", the overdensity will be less leading to a smaller subhalo being recovered . by the time the subhalo is in the centre of the halo , which corresponds to the densest point , the overdensity becomes negligible leading to no saddle point and",
    "the subhalo is no longer detected .",
    "while the size of the overdensity recovered roughly corresponds to the tidal radius of the subhalo , it has been shown that not all subhaloes are stripped down to this size when they pass through a halo .",
    "the authors of subfind are aware of these issues ( see  4.1 of * ? ? ?",
    "* ) and post - process , but where this effect is not taken into account it could have profound consequences on substructure studies .    the radial dependence of locating subhaloes as overdensities will have a large effect on measures of tidal stripping .",
    "as a subhalo plunges into a halo , the halo finder will reduce the size of the subhalo due to the increase in density .",
    "if this is not considered , then it will appear the subhalo is undergoing a larger amount of stripping as it falls through the halo than it actually underwent .",
    "stripping will be further complicated by the fact it occurs in the outer region of the subhalo , an area that is not included in the truncated subhalo that is recovered .",
    "this can lead to confusion when comparing the recovery of ahf and subfind .",
    "ahf indicates that most of the stripping occurs as the subhalo passes through the centre of the halo and not during the infall , but ahf has been shown to have inefficient unbinding causing it to retain a larger fraction of particles",
    ". meanwhile subfind indicates a more gradual process , but the effects of truncation will cause the recovered subhaloes to always be lower estimates of the size .",
    "further studies will need to be made to determine how dramatic the effect of stripping is on an infalling subhalo .",
    "the radial dependence in recovery will also have important implications for the subhalo mass distribution .",
    "two subhaloes that have identical mass can be recovered with different sizes based on position . this will lead to large subhaloes being recovered as smaller ones , in turn , leading to subhalo mass distributions biased towards the low mass end . whilst most subhaloes that reside in the inner region of the halo will have undergone a large amount of stripping and will be smaller anyway , the effect of truncation still needs to be considered alongside the underlying physics .",
    "these issues highlight that the recovered mass identified using the overdensity method is not a good property to consider when studying subhaloes .",
    "this is true even as far out as the virial radius of the halo , where the mass can be underestimated by around 25 per cent .    a more stable quantity to consider is the peak in the circular velocity profile",
    "this is located much closer to the centre of the subhalo and so will be less affected by truncation and the particular choice of the definition for an entire subhalo .",
    "both ahf and subfind recover consistent values for the maximum circular velocity at all radii within the halo , except at the very centre of the halo where no particles are recovered .",
    "this makes the circular velocity peak a useful quantity to track subhaloes and gives a good indication of initial mass .",
    "however , when considering stripping , the circular velocity peak is no longer useful .",
    "being located so close to the centre of the subhalo , a substantial amount of the outer layers can be stripped before the peak in the circular velocity is affected .",
    "two methods of improving the accuracy of subhalo recovery would be halo tracking and phase space .",
    "halo tracking involves identifying the subhalo before it falls into the halo so all the particles that were originally part of the structure are followed and at each time step they can be tested to see if they are still part of the substructure .",
    "the disadvantage of this technique is that it requires multiple snapshots to identify the subhalo , not a problem for the second method of phase space .",
    "phase space takes into account not only the spacial position of the subhalo particles , but also links particles based on a common velocity . by considering haloes in phase space density , any subhaloes that are present",
    "will stand out as overdensities .",
    "these can then be isolated . for subhaloes in the centre of the halo ,",
    "the difference in the bulk velocity of the particles would cause them to be separated in phase space . the only remaining problem would be if a subhalo was at rest in the centre of the halo .",
    "these structures could not be separated in phase space , but it is arguable whether such a structure would be a dynamically independent entity .",
    "the authors wish to thank alexander knebe , steffen knollmann , justin read and volker springel for useful discussions .",
    "sim and frp would also like to thank the astrosim network of the european science foundation ( science meeting 2910 ) for financial support of the workshop haloes going mad held in miraflores de la sierra near madrid in may 2010 .",
    "cp acknowledges the support of the stfc theoretical astrophysics rolling grant at the university of leicester .",
    "this research made use of the high performance computing ( hpc ) facilities at the university of nottingham .",
    "99 bryan g.l .",
    ", norman m.l . , 1998 ,",
    "apj , 495 , 80 bullock j.s . , kolatt t.s . , sigad y. , somerville r.s . , kravtsov a.v . ,",
    "klypin a.a .",
    ", primack j.r . ,",
    "dekel a. , 2001 , mnras , 321 , 559 davis m. , efstathiou g. , frenk c.s .",
    ", white s.d.m . , 1985 , apj , 292 , 371 diemand j. , kuhlen m. , madau p. , 2007 ,",
    "apj , 657 , 262 diemand j. , kuhlen m. , madau p. , zemp m. , moore b. , potter d. , stadel j. , 2008 , nat , 454 , 735 eke v.r . , cole s. , frenk c.s . , 1996 , mnras , 282 , 263 eke v.r . , navarro j.f . , steinmetz m. , 2001 , apj , 554 , 114 gao l. , white s.d.m . , jenkins a. , stoehr f. , springel v. , 2004 , mnras , 355 , 819 ghigna s. , moore b. , governato f. , lake g. , quinn t. , stadel j. , 1998 , mnras , 300 , 146 ghigna s. , moore b. , governato f. , lake g. , quinn t. , stadel j. , 2000 , apj , 544 , 616 gill s.p.d .",
    ", knebe a. , gibson b.k . , 2004 , mnras , 351 , 399 giocoli c. , tormen g. , sheth r.k . , van den bosch f.c . , 2010 , mnras , 404 , 502 hayashi e. , navarro j.f . , taylor j.e . , stadel j. , quinn t. , 2003 , apj , 584 , 541 hernquist l. , 1990 , apj , 356 , 359 hernquist l. , 1993 , apjs , 86 , 389 jenkins a. , frenk c.s . , white s.d.m .",
    ", colberg j.m . , cole s. , evrard a.e . , couchman h.m.p . , yoshida n. , 2001 , mnras , 321 , 372 kazantzidis s. , magorrian j. , moore b. , 2004 , apj , 601 , 37 klypin a. , gottlber s. , kravtsov a.v .",
    ", khokhlov a.m. , 1999 , apj , 516 , 530 knollmann s.r .",
    ", knebe a. , 2009 , apjs , 182 , 608 lacey c. , cole s. , 1993 , mnras , 262 , 627 okas e.l .",
    ", mamon g.a . , 2001 ,",
    "mnras , 321 , 155 maciejewski m. , colombi s. , springel v. , alard c. , bouchet f.r . , 2009 , mnras , 396 , 1329 navarro j.f . , frenk c.s . ,",
    "white s.d.m . , 1997 , apj , 490 , 493 neto a.f .",
    "et al . , 2007 , mnras , 381 , 1450 neyrinck m.c . , gnedin n.y . ,",
    "hamilton a.j.s . , 2005 , mnras , 356 , 1222 planelles s. , quilis v. , 2010 , a&a , in press , preprint ( astro - ph/1006.3205 ) plummer h.c . , 1911 , mnras , 71 , 460 power c. , navarro j.f . , jenkins a. , frenk c.s . ,",
    "white s.d.m . , springel v. , stadel j. , quinn t. , 2003 , mnras , 338 , 14 read j.i . ,",
    "wilkinson m.i .",
    ", evans n.w . , gilmore g. , kleyna j.t . , 2006 , mnras , 367 , 387 spergel d.n .",
    "et al . , 2003 , apjs , 148 , 175 springel v. , 2005 , mnras , 364 , 1105 springel v. , white s.d.m . , tormen g. , kauffmann g. , 2001 , mnras , 328 , 726 springel v. et al .",
    ", 2005 , nat , 435 , 629 springel v. et al . , 2008 , mnras , 391 , 1685 stadel j. , potter d. , moore b. , diemand j. , madau p. , zemp m. , kuhlen m. , quilis v. , 2009 , mnras , 398 , l21 tormen g. , diaferio a. , syer d. , 1998 , mnras , 299 , 728 tormen g. , moscardini l. , yoshida n. , 2004 , mnras , 350 , 1397 white s.d.m .",
    ", rees m.j . , 1978 , mnras , 183 , 341"
  ],
  "abstract_text": [
    "<S> with the ever increasing resolution of @xmath0-body simulations , accurate subhalo detection is becoming essential in the study of the formation of structure , the production of merger trees and the seeding of semi - analytic models . to investigate the state of halo finders , </S>",
    "<S> we compare two different approaches to detecting subhaloes ; the first based on overdensities in a halo and the second being adaptive mesh refinement . </S>",
    "<S> a set of stable mock nfw dark matter haloes were produced and a subhalo was placed at different radii within a larger halo . </S>",
    "<S> subfind ( a friends - of - friends based finder ) and ahf ( an adaptive mesh based finder ) were employed to recover the subhalo . as expected , we found that the mass of the subhalo recovered by subfind has a strong dependence on the radial position and that neither halo finder can accurately recover the subhalo when it is very near the centre of the halo . </S>",
    "<S> this radial dependence is shown to be related to the subhalo being truncated by the background density of the halo and originates due to the subhalo being defined as an overdensity . </S>",
    "<S> if the subhalo size is instead determined using the peak of the circular velocity profile , a much more stable value is recovered . </S>",
    "<S> the downside to this is that the maximum circular velocity is a poor measure of stripping and is affected by resolution . for future halo finders to recover all the particles in a subhalo , a search of phase space will need to be introduced .    </S>",
    "<S> [ firstpage ]    methods : numerical  galaxies : formation  galaxies : haloes  cosmology : theory  dark matter </S>"
  ]
}