{
  "article_text": [
    "positron emission tomography ( pet )  @xcite is currently one of the most prominent and promising techniques in the field of medical imaging . it plays a unique role both in medical diagnostics and in monitoring effects of therapy , in particular in oncology , cardiology and neurology .",
    "therefore , notable efforts are devoted to improve this imaging technique .",
    "the best way so far is to determine the annihilation point along the line of response ( lor ) based on measurement of the time difference between the arrival of the gamma quanta at the detectors , referred to as the time of flight ( tof ) difference  @xcite . as it was shown in ref .",
    "@xcite , even with the tof resolution of about 400  ps that is achievable with non - organic crystals , a signal - to - noise ratio can be improved substantially in reconstruction of clinical pet images .",
    "in the articles  @xcite , a new concept of the tof - pet scanner , named j - pet , was introduced .",
    "the j - pet detector offers improvement of the tof resolution due to the use of fast plastic scintillators .",
    "a single detection unit of the newly proposed tof - pet detector is built out of a long scintillator strip .",
    "light pulses produced in the strip propagate to its edges where they are converted via photomultipliers into electric signals .",
    "there are two main reasons why the tof resolution may be improved in j - pet scanner : i ) a very short rise - time and duration of the signals and ii ) a relation between the shape and amplitude of the signals and the hit position .",
    "the latter feature usually distorts the time resolution but , when the waveform of the signal is registered , the information about a change of the shape with the position may increase the position resolution and indirectly improve also the resolution of the time determination  @xcite . however , to probe the signals , with duration times of few nanoseconds , a sampling time of order of picoseconds is required .",
    "this can be done well with the oscilloscopes during the laboratory studies on the prototype , but in the final multimodular devices with hundreds of photomultipliers , probing with oscilloscopes is not feasible  @xcite .",
    "therefore , sampling in the voltage domain using a predefined number of voltage levels is needed .",
    "an electronic system for probing these signals in a voltage domain was developed and successfully tested  @xcite .    in recent papers  @xcite",
    "we have investigated the performance of a single unit of a j - pet scanner . sampling in the voltage domain at four thresholds was simulated and each pair of waveforms was represented by a 15-dimensional vector holding information about the relative time values of a signal s arrival at both scintillator ends  @xcite . in that scenario ,",
    "the spatial and time resolutions of the hit position and event time for annihilation quanta were determined to be 1.05 cm and 80 ps ( @xmath0 ) , respectively .",
    "it is evident that the spatial and time resolutions can be further improved primarily by an increase in the number of threshold levels , as was also concluded e.g. in article  @xcite .",
    "however , the number of channels in the electronic devices is a very important factor in determining the cost of the pet scanner .",
    "therefore , the question arises : is it possible to recover the whole signal based on only a few samples ?",
    "equivalently , how many threshold levels have to be applied to achieve a reasonable estimation error ?    in this article we propose a novel signal recovery scheme based on ideas from the tikhonov regularization  @xcite and compressive sensing  @xcite methods that is compatible with the signal processing scenario in j - pet devices .",
    "we investigate the quality of signal recovery based on the scheme with a single scintillator strip module introduced in ref .",
    "the two most important aspects of our work involve i ) a development of fast recovery algorithms and ii ) a statistical analysis of an error level . in practice",
    "the algorithm needs to work in real - time scenarios : during a single pet examination more than 10 million signals are acquired in just 10 - 15 minutes .",
    "moreover , only results for realistic scenarios with noisy measurements are considered . in particular , as was mentioned , the most important part of our investigations is to determine a dependence of the signal recovery error on the number of samples taken in the voltage domain . in this paper",
    "the formula for calculations of the recovery error will be introduced and proven .",
    "this article is organized as follows .",
    "we will define the problem of signal recovery and show briefly the tikhonov regularization and compressive sensing methods in sec .  2 .",
    "in the last part of this section we will introduce the theorem enabling the determination of the signal recovery error as a function of the number of samples .",
    "the experimental setup of the simplified pet device with a single scintillator strip that enables us to acquire real signals as well as the results of their analysis are presented in sec .",
    "a detailed analysis of the experimental characteristic of signal recovery error as a function of the number of samples , as well as the explanation of the specificity of the signal recovery method in the application to the j - pet measurement are provided in sec .",
    "3.2 . in sec .",
    "3.3 we have discussed the limitations of the method of signal recovery . in particular , we have presented how the quality of the information needed to recover the signals , and therefore to estimate the recovery error , vary with size of training set of fully acquired signals .",
    "moreover , we have demonstrated that using the recovered waveform of the signals , instead of samples at four voltage levels alone , improves the spatial resolution of the hit position reconstruction .",
    "a detailed description of this study is given in sec .",
    "the conclusions and directions for future work are presented in sec .",
    "we wish to recover a finite signal @xmath1 in a situation where the number @xmath2 of available samples , denoted as measurement @xmath3 , is much smaller than the signal dimension @xmath4 ( @xmath5 is sampled on some partial subset @xmath6 , where the cardinality @xmath7 ) . in the compressive sensing ( cs ) method",
    "@xcite , a sparse expansion @xmath8 of signal @xmath9 , evaluated via linear and orthonormal transformation @xmath10 , is considered . in the following we assume we",
    "are given a contaminated measurement @xmath5 and then one may write : @xmath11 where @xmath12 is a @xmath13 matrix modeling the sampling system , constructed from @xmath2 rows of matrix @xmath14 that corresponds to the indexes of @xmath5 described in the subset @xmath6 , and @xmath15 is an error term .",
    "therefore , during the recovery process the information about the measurement @xmath5 may be included in the form of the linear system of equations : @xmath16 it should be stressed that in the case of presence of noise , represented by signal @xmath15 , instead of an exact recovery of signal @xmath17 we will consider the solution @xmath18 and by the analogy , instead of signal @xmath9 we will consider the solution @xmath19 . before we look in more detail we may state that the evaluation of @xmath19 requires two steps : i ) recovery of the sparse expansion @xmath18 and ii ) calculation of @xmath19 based on the @xmath18 .",
    "the first step of the procedure is crucial .    in the situation where an exact solution can not be found ,",
    "cs method provide an attempt to recover @xmath18 by solving optimization problem of the form @xmath20 where @xmath21 is the size of the error term @xmath15 .",
    "the @xmath22 minimization approach provides a powerful framework for recovering sparse signals .",
    "moreover , the use of @xmath22 minimization leads to a convex optimization problems for which there exist a variety of greedy approaches like orthogonal matching pursuit  @xcite or basis pursuit  @xcite .",
    "other insights provided by cs are related to the construction of measurement matrices ( @xmath12 ) that satisfy the restricted isometry property  @xcite .",
    "for an extensive review of cs the reader is referred to refs .",
    ".    we will incorporate from the cs framework to our scheme only the idea of conducting the experiment , formulated by a linear system of equations as given explicitly in eq .",
    "( [ linearsyst ] ) . the problem formulated by eq .",
    "( [ linearsyst ] ) alone is essentially underdetermined , and is so - called ill - posed  @xcite . as in the case of the cs method , it is necessary to incorporate further assumptions or information about the desired solution in order to stabilize the problem .",
    "as an alternative to the cs theory , one may use the regularization methods  @xcite .",
    "the tikhonov regularization ( tr ) method  @xcite is the most suitable for our problem . here , the idea is to define the regularized solution @xmath18 as the minimizer of the following expression : @xmath23 in eq .",
    "( [ tikmin ] ) , both signals @xmath5 and @xmath24 are assumed to be given with multivariate normal ( mvn ) distributions , @xmath25 where @xmath26 and @xmath27 are the mean value and covariance matrix of a measured signal @xmath5 , respectively , @xmath28 and @xmath29 are the mean value and covariance matrix of a prior distribution of @xmath17 , respectively .",
    "the covariance matrix @xmath27 in eq .",
    "( [ ydist ] ) is diagonal with the values on the diagonal equal to the measurement error variances @xmath30 ( as explained in sec .",
    "2.4 ) . with the introduction of the second term to the optimization problem in eq .",
    "( [ tikmin ] ) , an additional information from a training set of fully sampled signals @xmath9 is provided .",
    "the prior distribution of sparse representation @xmath17 ( see eq .",
    "( [ xdist ] ) ) is evaluated based on the linear transformation of the training set of signals @xmath9 by using the principal component analysis ( pca ) decomposition  @xcite .",
    "thus , in order to find the sparse representation @xmath18 of a given measurement @xmath5 , as a solution of eq .",
    "( [ tikmin ] ) , one needs to specify first the prior distribution of @xmath17 .    beside the advantage of including the additional information from training signals ,",
    "a further benefit of the tr approach is that the problem in eq .",
    "( 2 ) has an optimal solution which can be determined explicitly . in sec .",
    "2.2 we will evaluate the orthonormal matrix @xmath14 , as well as the parameters of the prior distribution of signal @xmath17 , see eq .",
    "( [ xdist ] ) , via the pca decomposition of training signals @xmath9 .",
    "it should be stressed that these parameters are calculated only once , at the preparation stage of the procedure .",
    "thus , the same matrix @xmath31 and vector @xmath28 , are used to recover a signal @xmath18 for each measurement @xmath5 .",
    "an example of the idea of using the pca decomposition of a training data set in a similar problem may be found in ref .",
    "@xcite . in sec .",
    "2.3 the solution of the tr formula described in eq .",
    "( [ tikmin ] ) , as well as its properties , will be provided . finally in sec .",
    "2.4 we will introduce the theorem enabling the determination of the signal recovery error as a function of the number of samples .",
    "pca is a statistical study , based on the orthogonal transformation , to convert a set of signals into a set of linearly independent variables , such that the variance of the projected data is maximized . for the training data matrix of fully sampled signals",
    "@xmath32 ,          \\label{datay}\\ ] ] where @xmath33 is the mean of the aligned @xmath34 training signals @xmath9 , the pca coordinates @xmath35 $ ] are given by : @xmath36 the matrix @xmath37 $ ] in eq .",
    "( [ xay ] ) is calculated in such a way that the projection of the data matrix @xmath38 with successive basis vectors @xmath39 inherits the greatest possible variance in the data set @xmath38 .",
    "thus , the first basis vector has to satisfy : @xmath40 where @xmath41 ( the orthonormality is restricted ) .",
    "the @xmath42 component can be found by subtracting the first @xmath43 principal components from data set @xmath38 : @xmath44 and then finding the basis vector which extracts the maximum variance from this new data matrix @xmath45 where @xmath41 .    in the case discussed in this paper , the matrix @xmath14",
    "is evaluated based on the pca decomposition of the training set of signals @xmath9 and therefore the parameters of the mvn distribution of @xmath17 ( @xmath46 ) are estimated based on data matrix @xmath47 , constructed according to eq .",
    "( [ xay ] ) .",
    "the empirical covariance matrix @xmath29 of data set @xmath47 may be evaluated as : @xmath48 .",
    "\\label{covp}\\ ] ] the covariance matrix @xmath29 is diagonal , with values sorted in non - increasing order . since the mean of the signals in data set @xmath38 is equal to 0 , see eq .  ( [ datay ] ) , the mean @xmath49 .      in the previous section",
    "we have shown how the prior information from a training set of signals @xmath9 i.e. the orthonormal matrix @xmath14 , and the parameters of the prior distribution of signal @xmath17 , may be introduced to the tr framework . in this section",
    "we will derive a sparse solution @xmath18 of eq .",
    "( [ tikmin ] ) , and its covariance matrix , denoted hereafter as @xmath50 , for a particular measurement @xmath5 , based on the tr assumptions  @xcite .",
    "the posterior probability density function ( pdf ) of the signal @xmath24 conditional on measurement @xmath5 , namely @xmath51 , can be computed after combining the prior distribution of @xmath24 , @xmath52 , likelihood of measurement @xmath53 , and @xmath54 via the well - known bayesian rule : @xmath55 to describe the mvn distribution in eq .",
    "( [ bayes ] ) we will use the following notion : @xmath56 where @xmath57 is an @xmath58dimensional variable with mean value @xmath59 and covariance matrix @xmath60 .",
    "hence , the marginal and conditional densities of @xmath24 and @xmath5 from eq .",
    "( [ bayes ] ) are given as follows : @xmath61 equations  ( [ probx ] ) and  ( [ probyx ] ) result directly from the previously described eq .",
    "( [ xdist ] ) and  ( [ ydist ] ) , respectively . equation  ( [ proby ] ) shows that the probability @xmath54 is independent of @xmath24 , and therefore serves as a normalization constant . the posterior probability in eq .",
    "( [ probxy ] ) can be described exclusively by its first two moments ( @xmath62 ) because a gaussian pdf is self - conjugate and the pdfs on the right hand side of eq .",
    "( [ bayes ] ) are gaussian . after some simple calculations the equations for @xmath18 and @xmath50 are given by  @xcite : @xmath63 it is worth noting that the solutions in eq .",
    "( [ estx ] ) and ( [ ests ] ) are analogous to kalman filter update equations ( cf",
    "@xcite ) . it can be easily shown that @xmath18 is not only the minimum mean square error ( mse ) estimator ( see eq .",
    "( [ tikmin ] ) ) but also the maximum a posteriori ( map ) estimator , that is @xmath64    it should be stressed that all the information from the training set of signals @xmath9 ( matrix @xmath31 and vector @xmath28 ) and from the oscilloscope specification ( matrix @xmath27 ) are evaluated only once , at the preparation stage .",
    "thus , the sparse signal @xmath18 may be found , according to eq .",
    "( [ estx ] ) , as a linear combination of the previously defined parameters and a given measurement @xmath5 . however , the evaluation of the covariance matrix @xmath50 , according to eq .",
    "( [ ests ] ) , does not require the information about the measurement @xmath5 , and may be provided at the preparation stage .",
    "this fact opens a possibility for an estimation of the theoretical value of the recovery error .",
    "this idea will be presented in the next section .      as mentioned at the beginning of the sec .  2 ,",
    "the evaluation of the recovered signal @xmath19 requires two steps : i ) recovery of the compact representation @xmath18 via eq .",
    "( [ estx ] ) and ii ) calculation of @xmath19 as the solution @xmath65 where @xmath33 and @xmath14 are derived by pca decomposition .",
    "one of the benefit of using the tr approach is that it provides an easy way to obtain the error term of the recovered signal @xmath19 .",
    "we assume for the sake of simplicity that @xmath33 in eq .",
    "( [ esty ] ) is known exactly . since the matrix @xmath14 is orthonormal",
    ", we have @xmath66 , and therefore we may focus on the recovered signal @xmath18 error .    in multivariate statistics ,",
    "the trace of the covariance matrix is considered as the total variance .",
    "we will denote the trace of covariance matrix @xmath50 as @xmath67 .",
    "it is worth noting that @xmath67 is the mean value of the recovery error squared norm @xmath68 .",
    "let @xmath69 be the @xmath42 diagonal element of covariance matrix @xmath29 ( see eq .",
    "( [ covp ] ) ) .",
    "find the smallest value @xmath70 , and largest value @xmath71 ( with constraints @xmath72 and @xmath73 ) such that for each @xmath74 : @xmath75 from eq .",
    "( [ pk ] ) one may see that @xmath71 controls the decrease rate of @xmath69 : the greater @xmath71 , the faster the decreasing of @xmath69 and better the compressibility of signal @xmath24 .",
    "the characteristics @xmath70 and @xmath71 of the prior distribution of signal @xmath24 and a standard deviation of noise ( @xmath0 ) enable us to provide the formula for average value of the recovery error @xmath67 .",
    "for this purpose we formulate the following theorem :    suppose that @xmath70 and @xmath71 describe the decrease rate of variances of signal @xmath24 according to eq .",
    "( [ pk ] ) . the signal @xmath24 may be recovered as the solution to eq .",
    "( [ estx ] ) with an average value of error @xmath76    equation  ( [ sigmax ] ) enables us to estimate the number of required samples @xmath2 of signal to achieve a preselected mean recovery error .",
    "intuitively , the @xmath67 is also closely related to the compressibility of signal @xmath24 , and from eq .  ( [ sigmax ] )",
    "one may observe that an average recovery error is inversely proportional to the constant value @xmath71 .",
    "the proof of the theorem is given in the appendix .",
    "in this section , we present results illustrating the proposed approach and demonstrating that the number of samples ( @xmath2 ) required to sense the data can be considerably less than the total number of time samples ( @xmath4 ) in the reference signal @xmath9 . we investigate the performance of the algorithm using a data set of reference signals registered in single module scintillator strip ej-230  @xcite of j - pet device  @xcite .    the scheme of the experimental setup is presented in fig .",
    "[ exper_setup ] .",
    "the 30 cm long strip was connected on two sides to the r4998 hamamatsu  @xcite photomultipliers denoted as pm1(2 ) .",
    "a series of measurements was performed using collimated gamma quanta from a @xmath77na source placed between the scintillator strip and the reference detector .",
    "the collimator was located on a dedicated mechanical platform allowing it to be shifted along the line parallel to the scintillator strip with a submillimeter precision .",
    ", scaledwidth=70.0% ]    the @xmath77na source was moved from the first to the second end in steps of 6  mm . at each position , about 5  000 pairs of signals from pm1 and pm2 were registered in coincidence .",
    "these signals were sampled using the serial data analyzer ( lecroy sda6000a ) with a probing interval of 50  ps . to demonstrate the recovery performance only signals from pm1 were investigated ( the procedure with signals from pm2 would be the same ) .",
    "the length of a signal @xmath9 was set to 15  ns , which corresponds to @xmath78 samples ( see fig .",
    "[ examp_008]-[examp_082 ] for details ) .",
    "we wish to make one comment about the data acquisition .",
    "the signal captured by an oscilloscope is length @xmath4 , where each sample is contaminated with white noise with 0 mean and @xmath30 variance .",
    "the simulation of measurement @xmath5 is then based on selecting @xmath2 samples according to the subset @xmath6",
    ". however , in order to extract the reference , noise - free signal @xmath9 , the acquired @xmath4 samples have to be subjected to low pass filtering . in the following procedure we will need the signals @xmath5 and @xmath9 as well .    since the absolute registration time has no physical meaning , we synchronize the signals in data set @xmath38 in such way that the fixed index number 20 corresponds to the amplitude of -0.06  v on the rising slope of each signal ( see fig .",
    "[ examp_008 ] ,  [ examp_026 ] ,  [ examp_082 ] ) .",
    "the complete data set @xmath38 contains more than 200  000 signal examples and was divided into two disjoint subsets : training and testing part , with a ratio 9 to 1 , respectively . in the training data set only the signals @xmath9",
    "are stored , while in the testing one both signals @xmath5 and @xmath9 are required .",
    "the training data set @xmath38 was transformed via pca into a new space @xmath47 according to the scheme shown in sec .",
    "the evaluated matrix @xmath14 , as well as the mean value signal @xmath33 , were saved and used in the further analysis during the signal @xmath24 recovery from the testing data set . in order to find the theoretical value of mean recovery error @xmath67 , introduced in eq .",
    "( [ sigmax ] ) , one needs to specify additionally the following parameters : @xmath79 ( we will investigate the error @xmath67 as a function of the number of samples @xmath2 ) . the standard deviation of the noise ( @xmath0 ) was estimated based on the training data set @xmath38 to c.a .",
    "0.015  v , which is consistent with the oscilloscope specification .",
    "the unknown parameters @xmath80 were found after the analysis of diagonal elements of the covariance matrix @xmath29 of the training data set @xmath47 . the smallest value @xmath70 and the largest value @xmath71 for which the condition from eq .",
    "( [ pk ] ) was met , are equal to 4.2  v@xmath81 and 0.33 , respectively .",
    "it should be stressed that , for a given number of samples ( @xmath2 ) , the expected value of @xmath67 in j - pet scenario would be slightly greater than for the one described by eq .",
    "( [ sigmax ] ) .",
    "the reason is that in the j - pet scenario the signals are probed in the voltage domain and hence in the case when the amplitude of the signal is smaller than the threshold level , not all the samples of the signal are acquired ( see fig .",
    "[ examp_082 ] for example ) .",
    "therefore , in order to evaluate the theoretical function of mean recovery error in the j - pet scenario , both , the values of the threshold levels as well as the distribution of signal amplitides have to be specified first .    in the first step of the analysis",
    "the distribution of signal amplitudes was investigated .",
    "the experimental cumulative distribution function ( cdf ) , based on the signals registered at all the positions along the scintillator strip , is presented in fig .",
    "the amplitudes of the signals are in the range from -0.3  v to -1.0  v.     , scaledwidth=70.0% ]    in order to suppress events when gamma quanta were scattered inside the patient s body , in the current pet scanners ( detecting gamma quanta based on photoelectric effect ) the energy window , typically in the range from 350  kev to 650  kev , is applied  @xcite .",
    "such window suppress scattering under angles larger than 60 degrees .",
    "the j - pet detector is made of plastic scintillators which are composed of carbon and hydrogen .",
    "due to the low atomic number of these elements the interaction of gamma quanta with energy of 511  kev is predominantly due to the compton effect whereas the interaction via photoelectric effect is negligible . in order to suppress scattering in the patient through angles larger than 60 degrees , in the j - pet scanner only the signals with energy deposition larger than 200  kev",
    "will be accepted  @xcite .",
    "therefore , the signals with amplitude smaller than a -0.3  v are filtered out , and a sharp edge of the spectrum for this value is seen in fig .  [ cdf ] .    in the next step , based on the fully sampled signals stored in testing data set @xmath38 , we simulate a front - end electronic device that probes the signals at preselected number of voltage levels , both on the rising and falling slope .",
    "we carried out the experiments for different numbers of voltage levels from 2 to 15 . in each case , the level of -0.06  v on the rising slope was applied for triggering purposes , as was mentioned in sec .",
    "the remaining amplitude levels were adjusted after a simple optimization process , where the goal was to minimize the experimental mean recovery error @xmath67 . at each step of the optimization process , for a fixed number ( @xmath2 ) and values of voltage levels ,",
    "signal recovery was conducted in the following way .",
    "for each 300 signal samples from testing data set @xmath38 , all samples at preselected voltage levels were selected to simulate the measurement @xmath5 . since the amplitude of the signal may be less than certain voltage levels , not all samples had to be registered .",
    "therefore , for each processed signal , the number of acquired samples would be smaller or equal to @xmath2 . in order to remove the mean value from the measurement @xmath5 ,",
    "the corresponding values of signal @xmath33 were subtracted from signal samples from the oscilloscope .",
    "the measurement matrix @xmath12 was formed from the proper rows of matrix @xmath14 .",
    "the signal @xmath18 was recovered using eq .",
    "( [ estx ] ) , and finally the signal @xmath19 was derived as the linear solution of eq .",
    "( [ esty ] ) . with optimized values of voltage levels ,",
    "theoretical and experimental curves describing the mean recovery error @xmath67 as a function of the number of samples ( @xmath2 ) in the j - pet scenario are evaluated and shown in fig .",
    "[ theor_error ] .     as a function of the acquired samples ( @xmath2 ) .",
    "meaning of the curves is described in the text .",
    "[ theor_error ] , scaledwidth=70.0% ]    an empirical mean value of @xmath67 is marked with a solid blue line in fig .",
    "[ theor_error ] and is very similar to the expected , theoretical characteristic that takes into account the distribution of amplitudes and optimized values of voltage levels ( solid green line ) .",
    "the difference between those two functions is larger for small values of @xmath2 ( about @xmath82 of @xmath67 ) and almost negligible for greater numbers of samples .",
    "however , both of these functions differ significantly from the theoretical characteristic of @xmath67 , calculated according to eq .",
    "(  [ sigmax ] ) , marked with dashed green line in fig .",
    "[ theor_error ] . in the following",
    "we will investigate only the case with a four - level measurement , which is of most importance since the currently developed front - end electronic allows one to probe the signals at four fixed - voltage levels .",
    "it is evident that this comparison of results may be performed in the same way for all values of @xmath2 .",
    "the optimized values of the four voltage levels are : -0.06 , -0.20 , -0.35 and -0.60  v. since , the index of the sample taken at the voltage level of -0.06  v at the rising slope is common for all signals , the effective number of simulated samples at rising and falling edge is equal to @xmath83 . from fig .",
    "[ theor_error ] , the theoretical value of the average recovery error @xmath67 for @xmath83 is c.a .",
    "0.173  v@xmath81 ( dashed green line ) .",
    "however , based on the experimental distribution of amplitudes of the signals , presented in fig .",
    "[ cdf ] , only for about @xmath84 of signals would all samples from four thresholds be available ( amplitudes larger than -0.60  v ) .",
    "moreover , for signals with amplitudes in the range from -0.35 v to -0.60 v ( about @xmath85 of signals ) , the effective number of samples is equal to 5 and the theoretical value of @xmath67 increases to 0.228  v@xmath81 . for the rest of the considered signals , with amplitudes in the range from -0.30 v to -0.35 v ( about @xmath86 of signals ) , the effective number of samples is equal to 3 and the theoretical value of @xmath67 is 0.346  v@xmath81 .",
    "finally , the expected mean value of @xmath67 in the j - pet scenario for four voltage levels is equal to c.a .",
    "0.227  v@xmath81 and is much more comparable with the experimental value ( equal to c.a .",
    "0.264 v@xmath81 ) than the theoretical value for 7 samples .",
    "the analysis of the characteristic of @xmath67 allows us to indicate the proper number of samples needed .",
    "the function @xmath87 is approximately proportional to @xmath88 but , due to the logaritmic factor ( see eq .",
    "(  [ sigmax ] ) ) , it drops rapidly until @xmath2 reaches the value of about 10 .",
    "further increase in the number of samples does not provide any significant improvement in the signal recovery .",
    "this is very important information since the currently developed front - end electronic enable one to probe the signals at four fixed - voltage levels , providing eight time values for each signal .",
    "the distribution of the recovery error @xmath89 evaluated using all signals from the testing data set for optimized values of four voltage levels is shown in fig .",
    "[ dist_error ] .",
    ", scaledwidth=70.0% ]    from the empirical characteristics of @xmath89 one may see that the recovery error is concentrated between 0 and 0.4  v@xmath81 with the tail reaching the value 1.5  v@xmath81 . as was shown in fig .",
    "[ theor_error ] , the mean value in the experiment is equal to c.a .",
    "0.264  v@xmath81 .",
    "in addition , the standard deviation and the median of a probability distribution of a recovery error are equal to c.a .  0.192  v@xmath81 and 0.206  v@xmath81 , respectively .",
    "the three signal recovery examples , with small , medium and large recovery error , are shown in fig .",
    "[ examp_008 ] ,  [ examp_026 ] and  [ examp_082 ] , respectively .    .",
    "[ examp_008 ] , scaledwidth=70.0% ]    .",
    "[ examp_026 ] , scaledwidth=70.0% ]    .",
    "[ examp_082 ] , scaledwidth=70.0% ]    the values of the signal recovery errors in fig .",
    "[ examp_008 ] to  [ examp_082 ] are as follow : 0.082 , 0.266 , 0.814  v@xmath81 . as expected , the worst situation takes a place when the amplitude of the signal is slightly below the selected threshold level ( see fig .",
    "[ examp_082 ] ) or where it is much larger than the highest sampling voltage . in our sampling scheme",
    "the highest recovery error occurs for signal amplitudes in the range from -0.55 to -0.6  v and from -0.95 to -1  v ( where -1  v corresponds to the maximum amplitude , see fig .",
    "[ cdf ] ) .",
    "unfortunately , there is no possibility to overcome these phenomena when only a few samples of the signal are measured . on the other hand",
    ", it can be seen that the mean value of the error @xmath89 is on an acceptable level . in a typical situation",
    "the signal is recovered quite accurately ( see fig .  [ examp_026 ] ) .      although , the experimental and theoretical functions describing the recovery errors in the j - pet scenario , presented in fig .  [ theor_error ] , are largely consistent , there are at least two aspects of the method that need to be investigated :    \\1 ) the assumption about the prior mvn distribution of signals @xmath17 ( see eq .",
    "( [ xdist ] ) ) , which has an impact on the difference bewteen the values of the @xmath67 errors ,    \\2 ) the evaluation of the empirical values of @xmath67 as a function of the size of training set of signals @xmath9 .",
    "in order to verify the assumption about the normality of signals @xmath17 , we have used the kolmogorov - smirnov test on each of @xmath4 principal components in the training data set @xmath47 , evaluated according to eq .",
    "( [ xay ] ) . in each dimension , the mean value as well as the standard deviation were estimated for all the samples .",
    "the significance level used in this study was 0.05 .",
    "the hypothesis , regarding the normal distribution form , was rejected only for the first principal component that holds about @xmath90 of the signal energy . however , in that case the calculated value from the statistical test was not significantly higher than the critical value . from this analysis one infers that the signals stored in matrix @xmath47 are not exactly normally distributed .",
    "this fact may contribute to the difference between the theoretical and empirical values of @xmath67 .",
    "it should be stressed that all the informations needed to recover the signal @xmath18 ( matrix @xmath31 and vector @xmath28 - see sec .  2.2 for details ) , and therefore the empirical values of @xmath67 , were evaluated based on large set of about 200 000 training signals",
    "@xmath9 . in the following",
    "we will analyze the influence of the size of the training set of signals on the value of the signal recovery error .",
    "we conduct the experiment for a wide range of number of signals @xmath9 in the training set from 50 to 200  000 . in each case",
    "we investigate only the four - level measurement @xmath5 ( @xmath83 ) .",
    "the results of the analysis of the empirical values of @xmath67 as a function of the size of the training set of signals @xmath9 are shown in fig .",
    "( [ trainingset ] ) .     on the average recovery error @xmath67 .",
    "[ trainingset ] , scaledwidth=70.0% ]    the parameters of the model that were used for the signal recovery in the study described in sec .",
    "3.2 were based on 200  000 training signals , which corresponds to the value of the empirical recovery error of 0.264  v@xmath81 . from fig .",
    "( [ trainingset ] ) one may observe that reducing the number of training signals down to about 10  000 does not influence the quality of the recovery of signal @xmath18 ; the @xmath67 error is almost constant in that range .",
    "however , for smaller number of traning signals , the @xmath67 error increases rapidly and the recovery of the signal @xmath18 becomes increasingly less accurate .      in this section",
    ", we will incorporate the method for hit - position reconstruction , described in ref .",
    "@xcite , in order to evaluate a position resolution of the j - pet scanner with fully recovered signals .",
    "we will compare the spatial resolutions obtained from the original raw - signal ( 300 samples ) to those from the compressed signal ( e.g. 8 samples ) .",
    "we have carried out experiments with numbers of voltage levels from 2 to 15 , which corresponds to the number of samples @xmath2 from 3 to 29 .    for a single event of gamma quantum interaction along the scintillator strip , a pair of signals at two photomultipliers is measured in a voltage domain .",
    "next , the signals are recovered according to the description in sec .  2 , and",
    "finally , an event is represented by a 600-dimensional vector . for a fixed number of voltage levels a two - step procedure of the position reconstruction",
    "was performed .",
    "first , the scintillator s volume was discretized and for each bin a high statistics set of reference 600-dimensional vectors was created .",
    "the objective of the second part of the procedure is to classify the new event to one of the given sets and hence determine the hit position . for more details about conducting the experiment of hit position reconstruction ,",
    "the reader is referred to ref .",
    "@xcite .",
    "we have conducted the test on the same data set and under the same conditions as described in ref .",
    "@xcite , where the spatial resolution was reported to be equal to 1.05 cm ( @xmath0 ) .",
    "the spatial resolutions derived from the recovered signals as a function of the number of samples @xmath2 included in the recovery process are shown in fig .",
    "[ spatial ] .    ) . [ spatial ] , scaledwidth=70.0% ]    in fig .",
    "[ spatial ] only the region for small @xmath2 , from 3 to 29 , is shown , but it has to be stressed that the spatial resolution derived from the original raw - signal ( 300 samples ) is equal to 0.933  cm ( @xmath0 ) and is almost the same as for @xmath2=29 . for the most interesting case , with four voltage levels ( @xmath2=7 ) , the spatial resolution is slightly worse than for the fully sampled signal and is equal to 0.943  cm ( @xmath0 ) . on the other hand , even in that case",
    "the spatial resolution is about 0.1  cm better in comparison to the one evaluated based on signals in the voltage domain alone .",
    "in this paper a novel scheme of recovery of signals generated in plastic scintillator detectors in the j - pet scanner was introduced .",
    "the idea of signal recovery is based on the tikhonov regularization theory , that uses the training data set of signals . in these studies we assumed that training signals come from a mvn distribution .",
    "the compact representation of these signals was provided by the pca decomposition .",
    "one of the most important aspect of our work considers a statistical analysis of an error level of recovered signals . in this work a dependence of the signal recovery error on the number of samples taken in the voltage domain was determined .",
    "it has been proven that an average recovery error is approximately inversely proportional to the number of samples and inversely proportional to the decrease rate of variances in the covariance matrix . in the experimental section",
    ", the method was tested using signals registered by means of the single detection module of the j - pet detector .",
    "it was shown that the pca basis offers high level of information compression and an accurate recovery may be achieved with just 8 samples for each signal waveform .",
    "it is worth noting that the developed recovery scheme is general and may be incorporated in any other investigation where a prior knowledge about the signals of interest may be utilized .    in the experimental section",
    "we have demonstrated that using the recovered signals improves the hit - position reconstruction . in order to evaluate a position resolution of the j - pet scanner with fully recovered signals ,",
    "we have incorporated the method for hit - position reconstruction , described in ref .",
    "@xcite . in the cited work , the spatial resolution evaluated on the same data set and under the same conditions , based on 8 samples in voltage domain , without a recovery of the waveform of the signal ,",
    "was reported to be equal to about 1.05  cm ( @xmath0 ) .",
    "our experiment shows that the application of an information from four voltage levels to the recovery of the signal waveform can improve the spatial resolution to about 0.94  cm ( @xmath0 ) .",
    "moreover , the obtained result is only slightly worse than the one evaluated based on all 300 samples of the signals waveform .",
    "the spatial resolution calculated under these conditions is equal to about 0.93  cm ( @xmath0 ) .",
    "it is very important information since , limiting the number of threshold levels in the electronic devices to four , leads to a reduction in the cost of the pet scanner .",
    "future work will address a development of the more advanced method to define the hit - position and event time for annihilation quanta in the j - pet detector based on the recovered information .",
    "we believe that , with fully recovered signals , there is still scope for improvement in the time and position resolution of the j - pet scanner .    in order to prove the theorem we assume , for the sake of simplicity , that the matrix @xmath14 has normally distributed elements with zero means and @xmath91 variances .",
    "these values of the parameters of normal distribution ensure that the matrix @xmath14 is orthonormal .",
    "hence , based on eq .",
    "( [ ests ] ) , the matrix @xmath50 is given by : @xmath92 the @xmath67 is equal to the trace of the matrix @xmath50 and hence : @xmath93 the sum in the last term in eq .  ( [ approxs ] ) may be approximated by a definite integral . in the following",
    "we will use for the calculations a basic , rectangle rule , and : @xmath94 where @xmath95 . at the very",
    "beginning we assumed that the function @xmath69 has the form : @xmath96 ( see eq .",
    "( [ pk ] ) ) .",
    "we will perform the integration using the substitution @xmath97 . without any significant loss of precision",
    ", we change the integration limits from @xmath98 $ ] to @xmath99 $ ] .",
    "the calculations of the integral @xmath100 will be as follow : @xmath101 and thus @xmath102",
    "we acknowledge technical and administrative support of t. gucwa - ry , a. heczko , m. kajetanowicz , g. konopka - cupia , j. majewski , w. migda , a. misiak , and the financial support by the polish national center for development and research through grant innotech - k1/in1/64/159174/ncbr/12 , the foundation for polish science through mpd programme , the eu and mshe grant no .",
    "poig.02.03.00 - 161 00 - 013/09 , doctus - the lesser poland phd scholarship fund , and marian smoluchowski krakw research consortium `` matter - energy - future '' .",
    "we are grateful to prof .",
    "colin wilkin for correction of the manuscript .",
    "99 g. l. brownell , w. h. sweet , nucleonics 11 ( 1953 ) 40 j. s. robertson et al . , tomographic imaging in nuclear medicine ( 1973 ) 142 d. l. bailey , positron emission tomography : basic sciences .",
    "springer - verlag , nj ( 2005 ) .",
    "j. s. karp et al . , journal of nuclear medicine 49 ( 2008 ) 462 .",
    "d. j. kardmas et al . ,",
    "journal of nuclear medicine 50 ( 2009 ) 1315 .",
    "w. w. moses , s. e. derenzo , ieee transactions on nuclear science ns-46 ( 1999 ) 474 .",
    "p. moskal et al . , bio - algorithms and med - systems 7 ( 2011 ) 73 ; [ arxiv:1305.5187 [ physics.med-ph ] ] p. moskal et al .",
    ", nuclear medicine review 15 ( 2012 ) c68 ; [ arxiv:1305.5562 [ physics.ins-det ] ] .",
    "p. moskal et al .",
    ", nuclear medicine review 15 ( 2012 ) c81 ; [ arxiv:1305.5559 [ physics.ins-det ] ] .",
    "p. moskal et al . , radiotheraphy and oncology 110 ( 2014 ) s69 .",
    "q. xie et al .",
    ", ieee transactions on nuclear science 56 ( 2009 ) 2607 .",
    "h. kim et al . ,",
    "nuclear instruments and methods in physics research section a 602 ( 2009 ) 618 .",
    "d. xi et al . , ieee nuclear science symposium and medical imaging conference ( ieee nss / mic ) ( 2013 ) 1 .",
    "m. paka et al . ,",
    "bio - algorithms and med - systems 10 ( 2014 ) 41 ; [ arxiv:1311.6127 [ physics.ins-det ] ] .",
    "l. raczyski et al .",
    ", nuclear instruments and methods in physics research section a 764 ( 2014 ) 186 ; [ arxiv:1407.8293 [ physics.ins-det ] ] .",
    "p. moskal et al .",
    ", nuclear instruments and methods in physics research section a 764 ( 2014 ) 317 ; [ arxiv:1407.7395 [ physics.ins-det ] ] .",
    "p. moskal et al .",
    ", nuclear instruments and methods in physics research section a 775 ( 2015 ) 54 ; [ arxiv:1412.6963 [ physics.ins-det ] ] .",
    "a. tikhonov , soviet math",
    ". dokl . 4 ( 1963 ) 1035 .",
    "a. tikhonov , v. arsenin , solutions of ill - posed problems , winston and sons , washington , d.c .",
    "e. candes , j. romberg , t. tao , ieee transaction on information theory 52 ( 2006 ) 489 .",
    "d. donoho , ieee transaction on information theory 52 ( 2006 ) 1289 .",
    "s. mallat , z. zhang , ieee transaction on signal processing 41 ( 1993 ) 3397 .",
    "s. chen , d. donoho , m. saunders , siam journal of scientific computing 20 ( 1998 ) 33 .",
    "e. candes , t. tao , ieee tranaction on information theory 51 ( 2005 ) 4203 .",
    "e. candes , j. romberg , t. tao , communication on pure and applied mathematics 59 ( 2006 ) 1207 .",
    "j. hadamard , lectures on cauchy s problem in linear partial differential equations , yale university press , new haven ( 1923 ) .",
    "p. hansen , siam journal sci .",
    ". comput . 11 ( 1990 ) 503 .",
    "p. hansen , t. sekii , h. shibahashi , siam journal sci .",
    "comput . 13",
    "( 1992 ) 1142 .",
    "d. p. berrar et al . , a practical approach to microarray data analysis , kluwer academic publishers , boston ( 2002 ) .",
    "a. mahalanobis , journal of physics : conference series 139 ( 2008 ) 012031 .",
    "p. hansen , rank - deficient and discrete ill - posed problems .",
    "numerical aspects of linear inversion , siam , philadelphia ( 1997 ) .",
    "r. kalman , transaction of the asme  journal of basic engineering ( 1960 ) 35 .",
    "h. sorenson , ieee spectrum 7 ( 1970 ) 63 .",
    "eljen technology http://www.eljentechnology.com .",
    "hamamatsu http://www.hamamatsu.com .",
    "humm et al . , european journal of nuclear medicine and molecular imaging 30 ( 2003 ) 1574 ."
  ],
  "abstract_text": [
    "<S> the j - pet scanner , which allows for single bed imaging of the whole human body , is currently under development at the jagiellonian university . </S>",
    "<S> the discussed detector offers improvement of the time of flight ( tof ) resolution due to the use of fast plastic scintillators and dedicated electronics allowing for sampling in the voltage domain of signals with durations of few nanoseconds . in this paper </S>",
    "<S> we show that recovery of the whole signal , based on only a few samples , is possible . in order to do that , we incorporate the training signals into the tikhonov regularization framework and we perform the principal component analysis decomposition , which is well known for its compaction properties . </S>",
    "<S> the method yields a simple closed form analytical solution that does not require iterative processing . </S>",
    "<S> moreover , from the bayes theory the properties of regularized solution , especially its covariance matrix , may be easily derived . </S>",
    "<S> this is the key to introduce and prove the formula for calculations of the signal recovery error . in this paper </S>",
    "<S> we show that an average recovery error is approximately inversely proportional to the number of acquired samples .    ` </S>",
    "<S> tikhonov regularization ` , ` compressed sensing ` , ` positron emission tomography ` , ` j - pet ` </S>"
  ]
}