{
  "article_text": [
    "in this paper , the region of attraction ( roa ) of a given target set is defined as the set of all states that can be steered to the target set at any time while satisfying state and control input constraints .",
    "the problem of roa characterization and computation with its many variations have a long tradition in both control and viability theory ( where the roa is typically called the capture basin  @xcite ) .",
    "computational methods start with the seminal work of zubov  @xcite and are surveyed in , e.g. , @xcite and the book @xcite .",
    "this work proposes a computationally tractable method for obtaining both inner and outer approximations of the roa and , importantly , an approximate polynomial controller .",
    "the approach consists of three steps : compute outer approximations , extract a polynomial controller satisfying the input constraints , compute inner approximations of the closed - loop system with the extracted controller .",
    "thus , the approach can also be viewed as a design tool providing a polynomial controller with an analytically known inner and outer approximations of its roa .",
    "computing both inner and outer approximations , compared to just one or the other , enables assessing the tightness of the approximations obtained and provides a valuable insight into achievable performance and/or safety of a given constrained control system .",
    "for instance , a natural application for outer approximations is in collision avoidance , whereas a typical application of a ( positively invariant ) inner approximation is as a terminal constraint of a model predictive controller ensuring recursive feasibility of the underlying optimization problem  @xcite .",
    "the approach builds on and extends the ideas of  @xcite and  @xcite and the controller extraction procedure of  @xcite which was also sketched earlier in @xcite in the context of switching sequence design .",
    "the main contributions with respect these works are :    * contrary to  @xcite , we treat the infinite time version of the roa computation problem .",
    "the approach uses discounting similarly to our previous work  @xcite but here we treat the problem of computing the roa , not maximum controlled invariant set as in  @xcite . *",
    "contrary to  @xcite we compute inner approximations for _ controlled _ systems .",
    "this significantly extends the applicability of the approach but brings additional practical and theoretical challenges .",
    "in addition , under mild conditions , the inner approximations obtained are controlled invariant . *",
    "contrary to  @xcite the extracted controller is guaranteed to satisfy the input constraints and comes with an explicit estimate of its roa , both from inside and outside . *",
    "the formulation providing outer approximations of the roa is based on a different idea than that of  @xcite and provides tighter estimates on the numerical examples investigated .    -1 as in previous works  @xcite , the method presented in this paper studies how whole ensembles of trajectories evolve through time using the concept of occupation measures . to obtain the outer approximations ,",
    "we first characterize the roa as a value function of a certain nonlinear optimal control problem which we then relax using measures in the spirit of  @xcite .",
    "this leads to a primal infinite - dimensional linear program ( lp ) which is then relaxed using a hierarchy of finite - dimensional semidefinite programming problems ( sdps ) whose solutions can be used to extract approximate polynomial controllers .",
    "finite - dimensional approximations of the dual infinite - dimensional lp in the space of continuous functions are sum - of - squares ( sos ) problems and provide outer approximations to the roa . to obtain the inner approximations , we characterize directly using measures the _ complement _ of the roa associated with the closed - loop system with the extracted polynomial controller .",
    "this leads to an infinite - dimensional primal lp in the space of measures .",
    "finite - dimensional approximations of the dual lp on continuous functions are sos problems and provide outer approximations to the complement of the roa and hence inner approximations to the roa itself .",
    "note in passing that the use of occupation measures has a long tradition both in deterministic and stochastic control ; see , e.g. , @xcite for a historical account with the emphasis on applications to roa and mci set computation .",
    "the paper is organized as follows .",
    "section  [ sec : probstatement ] defines the problem to be solved ; section  [ sec : occupmeas ] introduces the occupation measures ; section  [ sec : outer ] presents the outer approximation formulation ; section  [ sec : extraction ] describes the controller extraction procedure ; section  [ sec : inner ] presents the inner approximations ; and section  [ sec : numex ] demonstrates the whole procedure on numerical examples .      throughout the paper we work with standard euclidean spaces ; all subsets of these spaces we refer to",
    "are automatically assumed borel measurable .",
    "the spaces of continuous and once continuously differentiable functions on a set @xmath0 are denoted by @xmath1 and @xmath2 , respectively . by a measure we understand a countably - additive mapping from sets to real numbers .",
    "integration of a function @xmath3 with respect to a measure  @xmath4 over a set @xmath0 is denoted by @xmath5 ; often we omit the integration variable or the domain of integration and write @xmath6 or @xmath7 .",
    "the support of a measure @xmath4 ( i.e. , the smallest closed set whose complement has a zero measure ) is denoted by @xmath8 .",
    "a moment sequence @xmath9 of a measure @xmath4 on @xmath10 is defined by @xmath11 .",
    "the indicator function of a set @xmath12 , i.e. , the function equal to one on the set and zero elsewhere , is denoted by @xmath13 .",
    "consider the polynomial input - affine dynamical system @xmath14 where the vector- and matrix - valued functions @xmath15 and @xmath16 have polynomial entries . the system is subject to a basic semialgebraic state constraint",
    "is given by a super - level set of single polynomial is made for ease of exposition ; all results extend immediately to arbitrary basic semialgebraic sets .",
    "this extension is briefly described in appendix a. ] @xmath17 where @xmath18 is a polynomial , and box input constraints @xmath19^m ,",
    "\\quad \\bar{u } \\ge 0.\\ ] ] the assumption that the input constraint is of the form  ( [ eq : inputconst ] ) is made without loss of generality since any box in @xmath20 can be affinely transformed can , of course , be also affinely transformed to @xmath21^m$ ] .",
    "however , we decided to consider the more general form @xmath22^m$ ] so that it is immediately apparent where the upper bound  @xmath23 comes into play in the optimization problems providing the region of attraction estimates . ] to @xmath22^m$ ] .",
    "it is also worth mentioning that arbitrary polynomial dynamical systems of the form @xmath24 can also be handled by considering the dynamic extension @xmath25 where the real control input @xmath26 is treated as a state and @xmath27 is a new , unconstrained , control input .",
    "some of our convergence results hinge on the compactness of the input constraint set and therefore one may want to impose additional bounds on the new control input @xmath27 , which correspond to slew - rate constraints on the true control input @xmath26 , a requirement often encountered in practice .    in the remainder of the text we make the following standing assumption :    the set @xmath28 is compact .",
    "this assumption is of a technical nature , required for the convergence results of section  [ sec : inner ] .    given a target set @xmath29 where the function @xmath30 is a polynomial , the goal of the paper is to compute inner approximations of the _ region of attraction _ ( roa ) @xmath31,\\ : x(0 ) = x_0,\\ : x(\\tau)\\in x_t    \\big\\},\\end{aligned}\\ ] ] where a.e .",
    "means `` almost everywhere '' with respect to the lebesgue measure on @xmath32 $ ] , @xmath33 is absolutely continuous and @xmath34 is measurable .    in words ,",
    "the region of attraction @xmath35 is the set of all initial states that can be steered to the target set @xmath36 at any time @xmath37 in an admissible way , i.e. , without violating the state or input constraints .",
    "our approach to compute the inner and outer approximations to the roa consists of three steps :    1 .",
    "compute an outer approximation to the roa , 2 .",
    "extract a polynomial controller out of this outer approximation , 3 .",
    "compute an inner approximation for the closed - loop system with this controller .",
    "these steps are detailed in the rest of the paper .",
    "the key ingredient of our approach is the use of measures to capture the evolution of a family of the trajectories of a dynamical system starting from a given initial distribution .",
    "assume therefore that the initial state is not a single point but that its spatial distribution is given by an _ initial measure _ @xmath38 and that to each initial condition a stopping time @xmath39 $ ] is assigned .",
    "assume that the support of @xmath38 and the stopping time @xmath40 are chosen such that there exists a controller @xmath41 such that all closed - loop trajectories @xmath42 starting from initial conditions @xmath43 remain in @xmath0 for all @xmath44 .",
    "then we can define the _ ( average ) discounted occupation measure _ as @xmath45 where @xmath46 is a discount factor .",
    "this measure measures the average ( where the averaging is over the distribution of the initial state ) discounted time spent in subsets of the state - space in the time interval @xmath47 .",
    "the _ discounted final measure _ @xmath48 is defined by @xmath49 where we define @xmath50 whenever @xmath51 .",
    "the discounted final measure captures the time - discounted spatial distribution of the state at the stopping time @xmath52 .",
    "the equation linking the three measures is a variant of the discounted liouville equation @xmath53\\,d\\mu(x),\\ ] ] which holds for all @xmath54 .",
    "this equation will replace the system dynamics  ( [ eq : sysuncont ] ) when studying the evolution of trajectories starting from the initial distribution @xmath38 over the possibly infinite time intervals  @xmath47 .",
    "the equation is derived in appendix  b.",
    "in this section we formulate an infinite - dimensional linear program ( lp ) in the space of measures characterizing the roa ( or more precisely a set closely related to it ) and whose finite - dimensional relaxations allow for the extraction of an approximate controller .",
    "finite - dimensional relaxations of the dual to this lp then provide outer approximations to the roa .    here",
    "we take an approach different from  @xcite and formulate the roa computation problem as an optimal control problem whose value function characterizes the roa ; this problem is then relaxed using measures .",
    "the optimal control problem reads :    @xmath55,u(\\cdot ) } &   e^{-\\beta\\tau}\\big[\\mathbb{i}_{x_t}(x(\\tau ) )   -\\mathbb{i}_{x\\setminus x_t}(x(\\tau ) )   \\big ] \\\\ & & \\hspace{0.6cm}\\mathrm{s.t . } & \\dot{x}(t ) = f(x(t ) ) + g(x(t))u(t),\\quad x(0 ) = x_0\\\\ & & & x(t)\\in x,\\ ; u(t)\\in u \\ ;",
    "\\forall\\ , t\\in [ 0,\\tau ] , \\end{array}\\ ] ]    where the objective function is zero if @xmath56 . clearly , the initial conditions that can be steered to @xmath36 achieve a strictly positive objective ; the initial conditions that necessarily leave @xmath0 a strictly negative objective ; and the initial conditions that can be kept within @xmath0 forever but do not enter @xmath36 achieve a zero objective .",
    "therefore @xmath57 .",
    "now we formulate an infinite - dimensional lp relaxation of the problem ( [ opt : opc_outer ] ) in the space of measures .",
    "first , and this the key insight due to  @xcite ensuring that an approximate controller can be extracted , we view each component @xmath58 of the controller @xmath41 in  ( [ eq : discountliouville ] ) as a density of a _ _ control measure _ _ @xmath59 defined by @xmath60    defining the linear differential operators @xmath61 and @xmath62 , @xmath63 , by @xmath64 where @xmath65 denotes the @xmath66 column of @xmath67 , the liouville equation  ( [ eq : discountliouville ] ) can be rewritten as @xmath68 where we used the fact that @xmath69 in view of ( [ eq : sigmadef ] ) .",
    "the input constraints @xmath70 $ ] are then enforced by requiring that @xmath71 , which is equivalent to saying that @xmath59 is a nonnegative measure absolutely continuous with respect to  @xmath4 with density ( i.e. , radon - nikodm derivative ) taking values in @xmath22 $ ] . the constraint @xmath72 can be written equivalently as @xmath73 , @xmath74 for some non - negative slack measure @xmath75 .",
    "the state constraint @xmath76 is handled by requiring that @xmath77 .",
    "further we decompose the final measure as @xmath78 with to @xmath79 instead of @xmath0 ; however , this is unnecessary by virtue of optimality in  ( [ rrlp_2 ] ) and avoids using the difference of two basic semialgebraic sets which may not be basic semialgebraic . ]",
    "@xmath80 and @xmath81 .",
    "finally we set the initial measure equal to the lebesgue measure ( i.e. , @xmath82 ) .",
    "this leads to the following infinite - dimensional primal lp on measures : @xmath83 where the supremum is over @xmath84 the dual lp on continuous functions provides approximations from above to the value function and therefore outer approximations of the roa .",
    "the dual lp reads    @xmath85    where the infimum is over @xmath86 .",
    "the following lemma shows that the zero super - level set of any function @xmath87 feasible in  ( [ vlp_2 ] ) is an outer approximation to the roa .",
    "[ lem : outer2 ] if @xmath88 is feasible in  ( [ vlp_2 ] ) , then @xmath89 .",
    "fix an @xmath90 .",
    "then by definition there exists @xmath91 control functions @xmath92 $ ] and a time @xmath37 such that @xmath93 .",
    "therefore @xmath94 for all @xmath95 $ ] and consequently , using the constraints of  ( [ vlp_2 ] ) , @xmath96 for all @xmath97 . using the gronwall s inequality",
    "we have @xmath98 and therefore @xmath99 as desired . here",
    "the last inequality follows from the fact that @xmath100 on @xmath36 .",
    "the infinite dimensional lps  ( [ rrlp_2 ] ) and ( [ vlp_2 ] ) can be solved only approximately ; a systematic way of approximating them is the so - called lasserre hierarchy of semidefinite programming  ( sdp ) relaxations  @xcite , originally introduced for static polynomial optimization and later extended to the dynamic case  @xcite .",
    "instead of optimizing over measures , this hierarchy takes only finitely many moments of the measures for the primal problem  ( [ rrlp_2 ] ) while imposing conditions necessary for these truncated moment sequences to be feasible in the primal lp via the so - called moment and localizing matrices . on the dual side ,",
    "the function space is restricted to polynomials of a given degree while imposing sufficient conditions for the non - negativity via sum - of - squares conditions .",
    "one then refers to the relaxation of order @xmath101 when the first @xmath102 moments of the measures are taken on the primal side and polynomials of total degree up to @xmath102 on the dual side .",
    "please refer to  @xcite or @xcite for more details on how to construct the relaxations for this particular problem or to  @xcite for a general treatment .",
    "let @xmath103 be a polynomial of degree @xmath102 solving the @xmath104 order relaxation of the dual sdp  ( [ vlp_2 ] ) .",
    "then this polynomial is feasible in  ( [ vlp_2 ] ) and therefore , in view of lemma  [ lem : outer2 ] , we can define the @xmath104 order outer approximation of @xmath35 by @xmath105    the following theorem states that the running intersection @xmath106 converges monotonically to the set no smaller than @xmath107 , which is the union of the roa @xmath35 and the set of all states which can be kept within @xmath0 forever .",
    "[ thm : outer ] the following statements are true : @xmath108 for all @xmath109 and @xmath110    the proof follows the convergence of @xmath103 to @xmath111 in @xmath112 norm which can be established using similar reasoning as in  ( * ? ? ?",
    "* theorem  6 ) ; details are omitted for brevity .    note that in the case where the volume of the set of states which can be kept in @xmath0 forever but can not be steered to @xmath36 is positive , the set to which the running intersection of @xmath113 converges can be strictly larger than @xmath35 ( in the sense of positive volume difference ) ; nevertheless by virtue of optimality in  ( [ rrlp_2 ] ) the controller attaining the infimum in  ( [ rrlp_2 ] ) generates @xmath35 ( i.e. , admissibly steers any state in @xmath35 to @xmath36 ) .",
    "in this section we describe how a polynomial controller approximately feasible in the primal  lp  ( [ rrlp_2 ] ) can be extracted from the solution to the finite - dimensional relaxations of  ( [ rrlp_2 ] ) .",
    "given a truncated moment sequence solving the @xmath104 primal relaxation , the idea is to find , component - by - component , polynomial controllers @xmath114 , @xmath63 , of a predefined total degree @xmath115 that approximately satisfy the relation  ( [ eq : sigmadef ] ) .",
    "details of this procedure are described below .",
    "first , note that satisfying relation  ( [ eq : sigmadef ] ) is equivalent to satisfying @xmath116 for all polynomials and the fact that the polynomials are dense in @xmath1 w.r.t .",
    "the supremum norm on compact sets . ] @xmath3 and therefore , by linearity , it is equivalent to the linear equation @xmath117 where the multindex @xmath118 runs over all nonnegative integer @xmath119-tuples .",
    "the data available to us after solving the @xmath120 order primal relaxation are the first @xmath102 moments moments belong to a measure feasible in  ( [ rrlp_2 ] ) only asymptotically , i.e. when @xmath121 ; at a finite relaxation order @xmath101 the first @xmath102 moments may not belong to a measure feasible in ( [ rrlp_2 ] ) ( or any nonnegative measure at all ) . ] of the measures @xmath4 and @xmath59 .",
    "the approach for controller extraction of @xcite consists of setting @xmath122 and satisfying the equation  ( [ eq : contextract ] ) exactly for all moments up to degree @xmath101 , i.e. , for all @xmath123 such that @xmath124 . for",
    "this choice of @xmath125 , the linear equation  ( [ eq : contextract ] ) takes a particularly simple form @xmath126 where @xmath127 is the @xmath128 moment matrix ( see  @xcite for definition ) associated to @xmath129 , the vector of the first @xmath102 moments of @xmath4 , @xmath130 is the vector of the first  @xmath101 moments of  @xmath59 , and  @xmath131 is the vector of the coefficients of the polynomial @xmath132 .",
    "however , this extraction procedure does not ensure the satisfaction of the input constraints and indeed typically leads to controllers violating the input constraints .",
    "one remedy is to pose input constraints on the polynomial @xmath114 as sum - of - squares ( sos ) constraints and minimize over  @xmath133 the moment mismatch @xmath134 subject to these input constraints ; this immediately translates to an sdp problem , as proposed originally in @xcite . denoting by @xmath135 the `` true '' controller , coefficients",
    "of which satisfy the equation  ( [ eq : contextractexact ] ) , this approach is equivalent to minimizing the @xmath136 error should be understood symbolically , replacing moments of the `` true '' occupation measure @xmath4 by @xmath137 . ]",
    "the problem of this extraction procedure is now apparent ",
    "the @xmath136 criterion weights subsets of @xmath0 according to the occupation measure @xmath4 and therefore will penalize more those subsets of @xmath0 where the trajectories spend a large amount of time and penalize less those subsets where the trajectories spend little time .",
    "this is clearly undesirable and is likely to lead to a poor closed - loop performance of the extracted controller .",
    "what we would like to have is a uniform penalization over the constraint set @xmath0 or even better over the region of attraction @xmath35 ( since any control is futile outside @xmath35 anyway ) .",
    "this leads to the following two - step procedure that we propose :    1 .",
    "extract the controller polynomial @xmath135 satisfying exactly  ( [ eq : contextractexact ] ) but violating the input constraints .",
    "2 .   minimize the @xmath139 error @xmath140 subject to the input constraints ,    where @xmath141 is a reference measure , ideally equal to the uniform measure on the roa @xmath35 .",
    "the second step can be carried out only approximately since the roa , let alone the uniform distribution on it , are not known in advance .",
    "here we use the first @xmath102 moments of the uniform measure on  @xmath0 as a rough proxy for the uniform measure on  @xmath35 .",
    "this leads to the following sos optimization problem for controller extraction : @xmath142 where @xmath143 and @xmath144 are respectively the @xmath145 and @xmath146 top - left sub - blocks of @xmath147 , the moment matrix associated to the first @xmath102 moments of the reference measure  @xmath141 .",
    "the optimization is over the coefficients @xmath131 of the controller polynomial @xmath114 and the coefficients of the sos polynomial multipliers @xmath148 and  @xmath149 .    it is worth noting that if a low - complexity controller is desired one can enforce sparsity on the coefficient vector of the polynomial @xmath150 by adding an @xmath151-regularization term @xmath152 for some @xmath153 to the objective of  ( [ contsos ] ) and/or fix an a priori sparsity pattern of @xmath131 .    to state a convergence result for the extracted controllers , we abuse notation and set @xmath154 for a polynomial @xmath155 of total degree less than @xmath102 .",
    "the following convergence result for the controllers @xmath135 was established in  @xcite :    [ lem : contconv ] there exists a subsequence @xmath156 such that @xmath157 for all polynomials @xmath158 , where @xmath159 and @xmath160 is a part of an optimal solution to the primal lp  ( [ rrlp_2 ] ) .    establishing a stronger notion of convergence and extending the convergence result to the controllers @xmath114 satisfying the input constraints obtained from  ( [ contsos ] )",
    "is currently investigated by the authors .",
    "the method of controller extraction ensuring the satisfaction of input constraints using sum - of - squares programming is not the only one possible but is particularly convenient for subsequent inner approximation computation since the extracted controller is polynomial .",
    "for instance , other viable approach is to simply clip the controller @xmath161 on the input constraint set ; in this case the closed - loop dynamics is piecewise polynomial defined over a semi - algebraic partition and it is still possible to compute inner approximations by a straightforward modification of the approach of section  [ sec : inner ] .",
    "given a controller @xmath41 satisfying input constraints extracted from the outer approximations , all we need to do to obtain _ inner approximations _ to the roa @xmath35 is to compute inner approximations of the roa for the closed - loop system @xmath162    all results of this section apply to uncontrolled systems @xmath163 with an arbitrary polynomial vector field @xmath164 , not only those of the special form  ( [ eq : sysuncont ] ) .    in order to compute the inner approximations we combine ideas of our two previous works  @xcite and @xcite for computation of inner approximations to the roa in a finite - time setting and outer approximations to the maximum controlled invariant set , respectively .",
    "this combination of the two approaches retains strong theoretical guarantees of both and seems to exhibit faster convergence of the finite - dimensional sdp relaxations .",
    "the key idea of  @xcite that we adopt here is to characterize the _ complement _ of the roa @xmath165 by continuity of solutions to  ( [ eq : sysuncont ] ) , this set is equal to @xmath166 where @xmath167 is the complement of @xmath36 in @xmath0 and @xmath168    in order to compute outer approximations of the complement roa @xmath169 we study families of trajectories starting from an initial distribution @xmath38 .",
    "the time evolution is captured by the discounted occupation measure  ( [ eq : discountliouville ] ) and the distribution at the stopping time @xmath170 $ ] by the final measure @xmath48  ( [ eq : mu_t ] ) .",
    "the three measures are again linked by the discounted liouville s equation  ( [ eq : discountliouville ] ) .",
    "the complement roa @xmath169 ( and hence also the roa @xmath35 ) is then obtained by maximizing the mass of the initial measure subject to the discounted liouville equation  ( [ eq : discountliouville ] ) , support constraints @xmath171 , @xmath172 , @xmath173 , and subject to the constraint that the initial measure is dominated by the lebesgue measure ( which is equivalent to saying that the density of the initial measure is below one ) . the last constraint is equivalent to the existence of a nonnegative slack measure @xmath174 such that @xmath175 for all  @xmath176 .",
    "this optimization procedure yields an optimal initial measure with density ( w.r.t .",
    "the lebesgue measure ) equal to one on @xmath169 and zero otherwise .    writing",
    "the above formally leads to the following primal infinite - dimensional lp on measures @xmath177 where the supremum is over the vector of nonnegative measures @xmath178    the dual infinite - dimensional linear program on continuous functions reads @xmath179 where the infimum is over the pair of functions @xmath180 .",
    "the following lemma establishes that the set @xmath181 for any function @xmath182 feasible in  ( [ vlp_inner ] ) provides an inner approximation to the roa @xmath35 .",
    "[ lem : inner ] if @xmath182 is feasible in  ( [ vlp_inner ] ) , then @xmath183",
    ".    we will prove the contrapositive , i.e. , that whenever @xmath184 , then @xmath185 .",
    "for that we distinguish two cases .",
    "first , assume that @xmath184 and that @xmath76 for all @xmath186 .",
    "in that case necessarily also @xmath187 for all @xmath186 and the first constraint of  ( [ vlp_inner ] ) implies that @xmath188 for all @xmath186 . using gronwall s inequality",
    ", this implies that @xmath189 or @xmath190 for all @xmath186 .",
    "since @xmath191 is compact and @xmath27 continuous this implies that @xmath192 is bounded and therefore necessarily @xmath193 .",
    "second , assume that there exists a time @xmath37 such that @xmath194 .",
    "then the second constraint of  ( [ vlp_inner ] ) implies that @xmath195 , and therefore , using again the first constraint of  ( [ vlp_inner ] ) and gronwall s inequality , we get @xmath196 and therefore @xmath197 as desired .",
    "the lps  ( [ rrlp_inner ] ) and ( [ vlp_inner ] ) depend on the discount factor @xmath199 which is a free parameter .",
    "theoretical results pertaining to the infinite - dimensional lps ( [ rrlp_inner ] ) and ( [ vlp_inner ] ) and convergence guarantees of their finite - dimensional relaxations do not depend on the value of @xmath198 as long as it is strictly positive . however , the _ speed of convergence _ and the _ quality _ ( i.e. , the tightness ) of the roa estimates coming out of the finite - dimensional relaxations does depend on @xmath198 .",
    "this dependence can be exploited to speed - up the convergence of the finite - dimensional relaxations by observing that if a vector of measures @xmath200 is feasible in the primal lp  ( [ rrlp_inner ] ) with a given value of the discount factor @xmath199 , then for any other value of @xmath201 there must exist discounted occupation and terminal measures @xmath202 and @xmath203 such that the vector of measures @xmath204 is also feasible in  ( [ rrlp_inner ] ) .",
    "therefore , instead of considering a single value of @xmath198 we can define a vector @xmath205 , @xmath206 , and optimize over vectors of discounted occupation and terminal measures @xmath207 and @xmath208 , components of which have to satisfy the discounted liouville equation with _ one common _ initial measure  @xmath38 .",
    "this leads to the following modified primal lp @xmath209 where the supremum is over the vector of nonnegative measures @xmath210    as already remarked the optimal values of the infinite - dimensional primal lps  ( [ rrlp_inner ] ) and ( [ rrlp_inner_beta ] ) are the same ; however , the finite - dimensional sdp relaxations of  ( [ rrlp_inner_beta ] ) are likely to converge faster than those of  ( [ rrlp_inner ] ) ( and will never converge slower provided that the @xmath198 used in ( [ rrlp_inner ] ) is among the components of the vector @xmath211 used in  ( [ rrlp_inner_beta ] ) ) .    for completeness we also state the dual infinite - dimensional lp on continuous functions where the function @xmath27 from  ( [ vlp_inner ] ) is replaced by a vector of functions  @xmath212 : @xmath213 where the infimum is over the vector of functions @xmath214 .",
    "[ rem : lemmas ] for any functions @xmath215 feasible in  ( [ vlp_inner_beta ] ) the results of lemmata  [ lem : inner ] and  [ lem : tauinvar ] and corollaries  [ cor : invariance1 ] and [ cor : invariance2 ] hold with the function @xmath27 replaced by @xmath216 .",
    "the infinite dimensional primal and dual lps  ( [ rrlp_inner ] ) and  ( [ vlp_inner ] ) give rise to finite - dimensional sdp relaxations in exactly the same fashion as outlined in section  [ sec : finitedimrelax ] or described in more detail in , for instance , ( * ? ? ?",
    "* section  vi ) .",
    "further details are omitted for brevity .",
    "let @xmath217 , @xmath218 , and @xmath219 denote the polynomials of degree @xmath102 solving the @xmath104 order sdp relaxation of the dual lp  ( [ vlp_inner_beta ] ) and let @xmath220 denote the @xmath104 order inner approximation ( since @xmath221 by lemma  [ lem : inner ] and remark  [ rem : lemmas ] ) .",
    "the following theorem summarizes convergence properties of the finite - dimensional relaxations .",
    "let @xmath222 be the _ closed - loop _ roa associated to the closed - loop system  ( [ eq : sysuncont ] ) ( defined analogously as roa  @xmath35 ) .",
    "[ thm : convinner ] the following convergence properties hold :    * the optimal values of the primal and dual sdp relaxations converge to the volume of @xmath223 as the relaxation order @xmath101 tends to infinity .",
    "* the functions @xmath219 converge in @xmath224 to the indicator function of the set @xmath223 . *",
    "the sets @xmath225 converge from inside to @xmath226 in the sense that the volume of @xmath227 tends to zero as the relaxation order @xmath101 tends to infinity .",
    "the proof follows by the same arguments as theorem  6 , corollary  7 and theorem  8 of  @xcite using theorems  2 and 4 of  @xcite in place of theorems  1 and  5 of @xcite .      in this section",
    "we investigate under what conditions the inner approximations @xmath225 are controlled invariant for the system  ( [ eq : sys ] ) and positively invariant for the system  ( [ eq : sysuncont ] ) . recall that a subset of @xmath10 is called _ positively invariant _ for an uncontrolled ode if trajectories starting in the set remain in the set forever . similarly a subset of @xmath10 is called _ controlled invariant _ for a controlled ode if there exists an admissible control input such that the trajectories starting in the set remain in the set forever .",
    "the following lemma leads almost immediately to the characterization of the invariance of @xmath225 ; it says that trajectories starting in @xmath225 stay there until they reach the target set  @xmath36 for the closed - loop system  ( [ eq : sysuncont ] ) .",
    "[ lem : tauinvar ] if @xmath228 , then @xmath229 for all @xmath95 $ ] , where @xmath230 is the first time that @xmath231 reaches  @xmath36 , and @xmath231 is the solution to  ( [ eq : sysuncont ] ) .",
    "if @xmath232 then there is nothing to prove . assume therefore @xmath233 .",
    "by lemma  [ lem : inner ] ( and its analogy for the problem  ( [ vlp_inner_beta ] ) ) if @xmath228 , then , by the definition of the roa @xmath35 , @xmath234 is finite and @xmath235 for all @xmath95 $ ] .",
    "this implies that @xmath187 for all @xmath236 and therefore @xmath237 , where the first inequality follows from the first constraint of  ( [ vlp_inner_beta ] ) and the gronwall s inequality and the second one from the definition of @xmath238  ( [ eq : innerapprox ] ) .",
    "this proves the claim .",
    "the following two immediate corollaries give conditions under which @xmath238 is invariant .",
    "[ cor : invariance1 ] if the target set @xmath36 is controlled  /  positively invariant for the system  ( [ eq : sys ] )  /  ( [ eq : sysuncont ] ) , then so is the set @xmath239 .",
    "[ cor : invariance2 ] if @xmath240 , then @xmath238 is controlled  /  positively invariant for the system  ( [ eq : sys ] )  /  ( [ eq : sysuncont ] ) .",
    "in this section we present numerical examples illustrating the approach . as a modeling tool we used gloptipoly  @xcite which allows to model directly the primal problems on measures .",
    "the outer and inner approximations are then extracted from the dual variables provided by a primal - dual sdp solver ( in our case mosek ) .",
    "equivalently one can model the dual sos problems ( in our case using yalmip  @xcite or sosopt  @xcite ) and extract the primal moment vector ( which is needed to obtain the approximate control law ) as a part of the dual variables associated with the constraints of the dual  sdp .",
    "as our first example we consider the nonlinear double integrator @xmath241 subject to the constraints @xmath242 $ ] and @xmath243 . as a terminal",
    "set we take a small neighbourhood of the origin @xmath244 .",
    "first we obtain two approximate polynomial controllers of degree four by solving the fourth order ( i.e. , considering moments up to total degree eight ) sdp relaxation of the two primal lps   ( [ rrlp_2 ] ) .",
    "then we obtain inner approximations from the eighth order ( corresponding to degrees of @xmath245 and @xmath246 , @xmath247 , equal to 16 ) sdp relaxation of the dual lp  ( [ vlp_inner_beta ] ) where we choose the vector @xmath248 ; the inner approximations given by ( [ eq : innerapprox ] ) are compared in figure  [ fig : doubinteg ] with an outer approximation  ( [ eq : outerapprox ] ) obtained from solving an sdp relaxation of the dual lp  ( [ vlp_2 ] ) with degrees of @xmath245 and @xmath27 equal to 16 .",
    "we can see that , for this example , both the inner and outer estimates are almost tight .",
    "computation times of the sdp relaxations are reported in table  [ tab : timesdoubleinteg ] .",
    ".-1 nonlinear double integrator  computation time comparison for different degrees @xmath249 of the polynomials in the sdp relaxations of the outer dual lp ( [ vlp_2 ] ) and the inner dual lp ( [ vlp_inner_beta ] ) .",
    "reported is pure solver time of the mosek sdp solver ( excluding gloptipoly and yalmip parsing time ) .",
    "larger solve time for the inner approximations is because of the larger number of decision variables and constraints in ( [ vlp_inner_beta ] ) since in  ( [ vlp_inner_beta ] ) there is one polynomial @xmath246 associated to each of the five values of the discount factor  @xmath250 . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     ( 140,246 ) ( 130,20 )",
    "we have presented a method for computing inner and outer approximations of the region of attraction for input - affine polynomial dynamical systems subject to box input and semialgebraic state constraints .",
    "the method combines and extends the ideas of our previous works  @xcite and the controller extraction idea of  @xcite .",
    "the inner approximations are controlled invariant provided that the target set is included in the inner approximation and/or itself controlled invariant .    the approach is based purely on convex optimization , in fact semidefinite programming ( sdp ) , and is tractable for systems of moderate state - space dimension ( say up to @xmath119 equal to @xmath251 or @xmath252 ) using interior point solvers , in our case mosek ; the number of control inputs @xmath91 plays a secondary role in the computation complexity since the number of variables and constraints in the sdp relaxations grows only linearly with @xmath91 .",
    "the linear growth is due to the fact that one measure on @xmath10 is associated to each control input , where @xmath119 is the state dimension .",
    "the total number of variables therefore grows as @xmath253 when the polynomial degree is held fixed and as @xmath254 when @xmath91 and @xmath119 are held fixed ; this is a significantly more favourable growth rate than @xmath255 or @xmath256 of @xcite .",
    "larger systems could be tackled using first - order methods ; for instance sdpnal  @xcite shows promising results on our problem class ( after suitable preconditioning of problem data ) .",
    "the approach can be readily extended to trigonometric , rational or rational - trigonometric dynamics with the same theoretical guarantees since a variant of the putinar positivstellensatz  @xcite ( which theorem  [ thm : convinner ] hinges on ) holds for trigonometric polynomials as well  @xcite .    at present no proof of convergence of the inner approximations @xmath257 to the roa",
    "@xmath35 is available .",
    "this is since lemma  [ lem : contconv ] provides only very weak convergence guarantees of the extracted controller to a controller generating the roa @xmath35 .",
    "strengthening lemma  [ lem : contconv ] or the possibility of proving the convergence by other means is currently investigated by the authors .",
    "here we describe how the presented approach can be extended to handle the situation where the state constraint set @xmath0 and/or the target set @xmath36 are given by multiple polynomial inequalities .",
    "assume therefore for this section that @xmath258 and that the set @xmath259 is compact .",
    "the primal and dual lps  ( [ rrlp_2 ] ) and ( [ vlp_2 ] ) providing the outer approximations stay the same since the set @xmath260 is compact basic semialgebraic .",
    "a slight modification is needed for the primal and dual lps ( [ rrlp_inner ] ) and ( [ vlp_inner ] ) providing the inner approximations . there , with multiple constraints , we define the sets @xmath261 and @xmath191  as @xmath262 @xmath263 since @xmath264 is compact , so are @xmath265 and @xmath266 .",
    "the sets @xmath261 and @xmath191 are therefore unions of compact basic semialgebraic sets . in the primal lp the measures @xmath38 , @xmath174 and @xmath4 with the supports in  @xmath191 are decomposed as the sum of  @xmath267 measures each with the support in  @xmath266 and analogously the terminal measure with the support in  @xmath261 is decomposed as the sum of  @xmath268 measures with the supports in  @xmath265 . in the dual lp  ( [ vlp_inner ] ) this translates to imposing the inequalities for each @xmath266 and @xmath265 ; for instance , the first inequality of  ( [ vlp_inner ] ) now translates to the  @xmath267 inequalities @xmath269 , @xmath270 .",
    "this appendix derives the discounted liouville equation  ( [ eq : discountliouville ] ) . for any test function",
    "@xmath182 we have @xmath271 which is exactly  ( [ eq : discountliouville ] ) . here",
    "we have used integration by parts in the third equality , and the definition of the initial , discounted occupation and terminal measures in the fourth .",
    "m. claeys , d. arzelier , d. henrion , j .- b .",
    "measures and lmi for impulsive optimal control with applications to space rendezvous problems .",
    "proceedings of the american control conference , montreal , 2012 .",
    "m. korda , d. henrion , c. n. jones .",
    "convex computation of the maximum controlled invariant set for polynomial control systems . ` arxiv:1303.6469 ` .",
    "a shorter version focusing only on the discrete - time was presented at the ieee conference on decision and control , florence , italy , 2013 .",
    "a. majumdar , r. vasudevan , m. m. tobenkin , r. tedrake .",
    "convex optimization of nonlinear feedback controllers via occupation measures .",
    "proceedings of robotics science and systems ( rss ) , 2013 . `",
    "arxiv : 1305.7484 `"
  ],
  "abstract_text": [
    "<S> this work presents a method to obtain inner and outer approximations of the region of attraction of a given target set as well as an admissible controller generating the inner approximation . </S>",
    "<S> the method is applicable to constrained polynomial dynamical systems and extends to trigonometric and rational systems . </S>",
    "<S> the method consists of three steps : compute outer approximations , extract a polynomial controller while guaranteeing the satisfaction of the input constraints , compute inner approximations with respect to the closed - loop system with this controller . </S>",
    "<S> each step of the method is a convex optimization problem , in fact a semidefinite program consisting of minimizing a linear function subject to linear matrix inequality ( lmi ) constraints . </S>",
    "<S> the inner approximations are positively invariant provided that the target set is included in the inner approximation and/or is itself invariant .    </S>",
    "<S> region of attraction , polynomial control systems , occupation measures , linear matrix inequalities ( lmis ) , convex optimization , viability theory , reachable set , capture basin . </S>"
  ]
}