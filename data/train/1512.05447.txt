{
  "article_text": [
    "it has been more than 30 years since the proposal of the first quantum key distribution ( qkd ) protocol ",
    "bb84  @xcite .",
    "the ultimate goal of a qkd protocol is to establish a secure key between two parties for a further cryptographic use ; in this context , quantum mechanics is a powerful ally of the legitimate parties .",
    "therefore , it is advantageous to generate the key by distributing and measuring quantum states .",
    "contrary to communication with classical signals , for quantum states there exists a fundamental trade - off between how much information a classical or quantum adversary can get and how much the quantum system is disturbed .",
    "for example , the most straightforward strategy of simply copying a quantum state does not work  @xcite .",
    "a significant amount of effort has been invested in proving the security of bb84 and subsequent qkd protocols ( starting with its proper definition  @xcite ) and experimental realization  @xcite .",
    "most of the modern qkd schemes rely on two - level quantum systems ( qubits ) as quantum information carriers .",
    "this is especially easy to achieve using the photon polarization degree of freedom .",
    "the theoretical background as well as the experimental techniques are mature .",
    "however , quantum @xmath0-level states ( qudits ) have attracted much attention recently because they naturally offer higher quantum information transmission rates and together with continuous variables are promising candidates for next generation quantum information processing . in this approach ,",
    "the information is encoded onto @xmath0 distinct orthogonal states , for which in principle there is no upper limit on  @xmath0 . in the context of qkd ,",
    "the @xmath0-level protocols not only offer a great potential to increase the transmitted key rate but they are also known to be more resilient to errors  @xcite .",
    "experimentally , high - dimensional quantum states have been realized as discrete time - bins  @xcite , positions  @xcite or angular momenta  @xcite in lab - scale proof - of - principle tests .",
    "they have also been successfully studied under real world environmental conditions where air turbulence or inter - modal coupling in fibers have to be taken into account @xcite .",
    "the experimental efforts for realization of multidimensional qkd has primarily relied on employing two mutually unbiased bases ( mubs ) .",
    "however , it is known that using only two mubs for @xmath1 does not realize the full potential of a qubit - based qkd . instead ,",
    "by using three mubs we are rewarded by an increase in the maximum tolerable error rate in a qkd protocol known as the six - state protocol  @xcite . considering this observation ,",
    "it is expected that using more than two mubs would provide enhancement in the security of the @xmath0-dimensional qkd protocols .",
    "it is well known that for @xmath0 a prime number or the power of a prime , the maximum number of mubs in a @xmath0-dimensional hilbert space is @xmath2  @xcite . for the non - prime dimensions ,",
    "the number of mubs is a major open problem .",
    "however , it is perhaps less well known that there always exists three mubs for any @xmath0  @xcite .",
    "motivated by this fact , we present a comprehensive security analysis for @xmath0-level qkd with two and three mubs .",
    "our main contribution in this paper is the calculation of the secret key rate upper bounds for discrete @xmath0-dimensional qkd protocols using two and three mubs .",
    "we exemplify the key rate calculations on @xmath1 to @xmath3 but our approach can be immediately applied for any @xmath0 .",
    "the secret key rates are calculated in both the asymptotic and finite key length scenario . in the asymptotic case , the 2-mub rates reproduce the previously known results  @xcite but to our best knowledge the analytical results we obtain for 3-mub rates and for any @xmath0 are novel and the corresponding adversarial channels havent been studied before ( only the @xmath1 case reduces to the well studied six - state protocol  @xcite ) .",
    "the main reason to reproduce the already known results for the 2-mub qkd protocol is the calculation method that may not be familiar to the practitioners of qkd .",
    "it can be summarized as `` ab initio '' since our starting point is the private classical capacity and the quantum capacity of a quantum channel  @xcite and we systematically derive the well - known expressions for the secret key rate .",
    "the main result of the asymptotic part of our analysis is the secret key rate calculation for the 3-mub protocol and the derivation of the tolerable threshold for the error rate .",
    "we found that the threshold quite substantially increases accompanied by the increase of the secret key rate as envisaged by the comparison of bb84 and the six - state protocol .",
    "our results justify the overlapping numerical results presented in  @xcite .",
    "the second part of our analysis is the study of qkd in the non - asymptotic regime of a finite number of exchanged signals .",
    "we follow two different routes leading to excellent ( achievable  @xcite ) upper bounds on the secret key rates even for a relatively low number of signals .",
    "the first approach is the generalization of the uncertainty relation - based approach pioneered in  @xcite for two mubs and @xmath1 .",
    "we generalize the key step spelled out in  @xcite for any @xmath0 and using the large deviation estimate for the number of errors in the non - sacrificed part of the sifted key we derived the corresponding secret key rates .",
    "the intermediate step includes a numerical optimization over the ratio of dits in the secret key rates that are sacrificed for the parameter estimation purposes .",
    "as the number of sifted bits asymptotically increases the portion of sacrificed bits tends to zero  @xcite and the secret key rates approach the asymptotic ones derived previously .",
    "for another approach to the non - asymptotic regime see  @xcite .",
    "the uncertainty - relation - based method is , however , not known to be applicable to the 3-mub qkd protocol  @xcite .",
    "more precisely , it can be enforced even for three mubs but our attempts lead to awfully suboptimal rates .",
    "hence we adopt a different strategy . using the recent advances in the second - order asymptotics for the quantum coding rates  @xcite we use the expansion of the relevant entropic quantity ( the smooth min - entropy ) in terms of the conditional entropy variance  @xcite and",
    "expand the decoupling exponent of what is essentially a one - shot decoupling lemma  @xcite .",
    "the resulting rates are calculated both in the 2- and 3-mub qkd scenario . in the latter ,",
    "the resulting secret key rates are better for any @xmath0 compared to the basic estimate first brought by renner in  @xcite that is used as a template in almost all finite key studies . since the 3-mub qkd protocol for any @xmath0 seems to be systematically studied for the first time here , it therefore establishes the best known secret key rates .",
    "the second - order asymptotic expansion also beats renner s rates for the 2-mub qkd protocol ( for any @xmath0 ) but it is not as good as the uncertainty - relation - based estimates .",
    "this is the expected kind of behavior .",
    "the remainder of the paper is structured as follows . in sec .",
    "[ sec : prelim ] we introduce the minimal background material and notation for our approach to calculate the asymptotic secret key rates and collect several rudimentary facts about the pauli group for qudits and mutually unbiased basis .",
    "we also recall the choi - jamiokowski state - map correspondence .",
    "the asymptotic rates for 2- and 3-mub qkd protocol are calculated in sec .",
    "[ sec : qkdasymptotic ] . in sec .",
    "[ sec : finitesizekey ] we introduce the necessary entropic quantities that come out in the expressions for finite key length secret key rates and derive the previously discussed non - asymptotic secret key rates . in sec .",
    "[ sec : oam ] we describe one possible laboratory implementation of our results by considering photonic oam based qkd schemes , which have become a promising candidate for real - life high - dimensional qkd applications .",
    "we show the spatial modes that would be required for three mubs and describe possible next steps and open challenges .",
    "we , however , do not analyze the security of the studied qkd protocols by considering all realistic parameters such a platform offers .",
    "this would include taking into account the efficiency of photon sources and detectors together with the suboptimality of certain classical information algorithms used in the postprocessing step .",
    "the experimental inefficiencies do not affect the secret key rate ( measured by bits per channel ) but rather the speed of how many secret bits one is able to collect per given time period .",
    "the modern definition of security for a quantum key distribution protocol requires the final state @xmath4 to satisfy @xmath5 the indices @xmath6 stand for the legitimate sender and receiver and @xmath7 is an adversary ( eve ) .",
    "the condition says that after the protocols ends , the legitimate parties share classical correlations ( in this case a classical key @xmath8 ) , where the knowledge of eve can be made arbitrarily small  the quantum system in her possession is _ decoupled _ from the legitimate participants .",
    "the expression @xmath9 denotes the trace norm .",
    "this approach was first rigorously introduced in a great generality in  @xcite and in the context of qkd also in  @xcite .",
    "the marginal state @xmath10 can be seen as an output of a noisy quantum channel @xmath11 between a sender and a receiver .",
    "they do not know whether the noisy evolution is caused by decoherence of any kind or by an eavesdropper and mainly they must not care .",
    "as long as they know the channel and are able to use it asymptotically ( sending a large number of quantum signals ) one can often easily determine whether a secret key can be established . here comes the idea of asymptotic qkd : with an ever increasing number of channel uses the parameter on the rhs of eq .",
    "( [ eq : privacy ] ) is required to become arbitrarily small .",
    "for some channels this condition can not ever be satisfied and in that case the asymptotic qkd is impossible .",
    "the normalized rate at which establishing classical correlation over a noisy quantum channel is in principle possible is called the _ private classical capacity _ of @xmath11 .",
    "note that a secret key is a form of classical correlations  @xcite .",
    "if the private capacity is zero , eq .",
    "( [ eq : privacy ] ) can not be satisfied in the sense that eve can not be arbitrarily well decoupled from the state shared by the sender ( @xmath12 ) to a receiver ( @xmath13 ) .",
    "the private classical capacity is given by @xmath14 where @xmath15 is the _ private information_. the state @xmath16 is given by the action of a channel isometry @xmath17 on a classical - quantum input state @xmath18 and @xmath19 denotes a classical random variable with a probability distribution @xmath20 ( @xmath21 ) .",
    "the quantity @xmath22 is called the _ quantum mutual information _ defined as @xmath23 where @xmath24 $ ] is the von neumann entropy is the logarithm base two and @xmath25 denotes the natural logarithm throughout the paper . ] of a ( possibly multipartite ) state @xmath26 .",
    "the private classical capacity in ( [ eq : privcap ] ) is an unconstrained optimization problem whose tractable solution for a general channel @xmath11 is not known at present and even the calculation of the _ one - shot _ private capacity ( @xmath27 ) @xmath28 is not straightforward since @xmath29 admits a mixed state decomposition @xmath30 .",
    "another fundamental quantity , seemingly unrelated to qkd , is called the _ quantum channel capacity _",
    "@xcite @xmath31 where @xmath32 is the",
    "_ coherent information_. the isometry now acts on @xmath29 that ( crucially ) can be limited to a convex sum of rank - one states @xmath33 as @xmath34 .",
    "the quantum capacity follows from a stronger condition than eq .",
    "( [ eq : privacy ] )  that the main goal is to successfully transmit a quantum state from a sender to a receiver who happens to be decoupled from the environment @xmath7 ( completely controlled by an adversary ) .",
    "quantum channel capacity  ( [ eq : quantcap ] ) is also intractable for a general channel @xmath11 but the one - shot quantity ( also called the optimized coherent information ) @xmath35 is fairly easy to evaluate ( often not analytically but the numerics will do the job ) .",
    "the decoupling mechanism is naturally useful for secret key generation .",
    "this is because the quantum capacity can crucially be interpreted as the one - way entanglement distillation rate which itself is a lower bound on the one - way secret key rate  @xcite .",
    "once the parties share maximally entangled states , they can be used to teleport any type of information , in particular a secret key , at the same rate the pairs were distilled .",
    "hence the quantum capacity is a channel secret key rate lower bound .",
    "formally , it can be shown in the following way  @xcite ( see also  @xcite ) . from eq .",
    "( [ eq : oneshotprivcap ] ) and the definition of the mutual information we write    [ eq : privquantcaprelation ] @xmath36\\label{eq : privquantcaprelationa}\\\\       & = \\sup_{\\vr_{xa}}\\big[h(b)_\\s - h(bx)_\\s - h(e)_\\s+h(ex)_\\s\\big]\\label{eq : privquantcaprelationb}\\\\       & = \\sup_{\\vr_{xa}}\\big[h(b)_\\s - h(e)_\\s-\\sum_xp_x\\big(h(b)_{\\s_{x}}-h(e)_{\\s_{x}}\\big)\\big]\\label{eq : privquantcaprelationc}\\\\       & = \\sup_{\\vr_a}\\big[h(b)_\\s - h(e)_\\s\\big]-\\inf_{\\vr_{xa}}\\sum_xp_x\\big(h(b)_{\\s_{x}}-h(e)_{\\s_{x}}\\big)\\label{eq : privquantcaprelationd}\\\\       & = q^{(1)}({\\pazocal{n}})-\\inf_{p_x,\\vr_{x , a}}\\sum_xp_xq({\\pazocal{n}},\\vr_x).)\\label{eq : privquantcaprelatione }    \\end{aligned}\\ ] ]    eq .",
    "( [ eq : privquantcaprelationc ] ) follows from @xmath37 and similarly for the @xmath38 .",
    "the first two summands in eq .",
    "( [ eq : privquantcaprelationd ] ) can be optimized over @xmath29 instead of @xmath39 since we trace over the classical variable @xmath19 .",
    "the von neumann entropy @xmath40 over a classical probability distribution @xmath20 is simply the shannon entropy @xmath41 .",
    "in the end we arrived at  @xcite @xmath42 and thus the lhs turns out to be a useful lower bound in the qkd scenario as claimed .",
    "the equality is achieved for @xmath43 in which case @xmath44 for all @xmath45 and",
    "so .    the usual starting point for an asymptotic analysis of a qkd s secret key rate",
    "@xmath46 is the following formula  @xcite @xmath47},\\ ] ] where @xmath48 is a pure tripartite state shared by all parties , @xmath49 is a classical - quantum state obtained by measuring @xmath48 ( so @xmath50 are classical variables also called a raw key ) and @xmath51 is the block size . the marginal state @xmath52 over which is being optimized is essentially a choi state introduced on p.  .",
    "the set @xmath53 are all choi states compatible with the channel estimation step in the protocol and we will see it in action in eqs .",
    "( [ eq : cohinfominimizedmub2c ] ) .",
    "finally , the expression in eq .",
    "( [ eq : qkdsecretkeyrate ] ) @xmath54 is the quantum conditional entropy .",
    "we can quickly see the equivalence between eq .",
    "( [ eq : qkdsecretkeyrate ] ) and @xmath55 $ ] from eq .",
    "( [ eq : privquantcaprelationb ] ) .",
    "we get rid of the supremum by realizing that in all mainstream qkd protocols , the input states ( or private codes ) @xmath29 are pure states ( or mixtures thereof ) leaving us with the classical - quantum input state of the form @xmath56 .",
    "the maximum is achieved for @xmath57 maximally mixed and so from eq .",
    "[ eq : privquantcaprelatione ] we get @xmath58 , see below  ( [ eq : oneshotinequality ] ) . in the second step , we realize that in all qkd protocols , bob applies a povm on the received quantum state generating a classical variable @xmath59 and so eq .  ( [ eq : qkdsecretkeyrate ] ) for @xmath27 has been recovered @xmath60 where @xmath61 from the rhs represents @xmath11 on the lhs via the choi - jamiokowski isomorphism ( see p.  ) .",
    "there is also a missing @xmath62 for @xmath63 ( or @xmath64 in general ) as opposed to @xmath65 and this a subtle point . from the quantum capacity standpoint ,",
    "the channel @xmath11 is given and the maximization is over all possible input states @xmath29 ( quantum codes ) . in the qkd scenario ( specifically in its entanglement version ) the parties try to share maximally entangled states and the most reasonable strategy is obviously to start the distribution with maximally entangled states ( quantum codes ) but @xmath66 . ] .",
    "the fact that they may become disrupted due to decoherence or an eavesdropper implies that the channel will be different . as we will see later ,",
    "such a disrupted code _ is _ a channel representation ( the choi matrix ) .",
    "it is instructive to investigate the case of two complementary bases ( mubs ) for higher - dimensional hilbert spaces . to this end",
    ", we first informally introduce the qudit pauli group @xmath67 .",
    "it has two generators @xmath68 defined as    [ eq : pauligens ] @xmath69    where @xmath70 and @xmath71 is addition modulo @xmath0 .",
    "an arbitrary element of @xmath67 is then @xmath72 for @xmath73 .    from other useful properties of the qudit pauli group",
    "let us recall that the special case of weyl commutation relations  @xcite ) reads @xmath74 hence , the eigenvector @xmath75 in the equation @xmath76 is also an eigenvector of @xmath77 ( up to a phase ) .",
    "this is because @xmath78 where @xmath79 counts the total number of passes of @xmath80 through @xmath81 .",
    "but @xmath75 is also an eigenvector of the rhs ( up to a phase ) .",
    "a remarkable way of representing a quantum channel is known as the choi - jamiokowski isomorphism  @xcite .",
    "let @xmath11 be the quantum channel .",
    "then there exists a positive semi - definite map @xmath82 , sometimes called _",
    "choi matrix _ , that represents the action of the channel via @xmath83.\\ ] ] the channel @xmath11 is trace - preserving if its choi matrix satisfies @xmath84 .",
    "conversely , any quantum channel @xmath11 gives rise to a choi matrix @xmath85 where @xmath86 is an unnormalized maximally entangled state .",
    "the physical interpretation of the choi matrix is as if the communicating parties shared a maximally entangled qudit pair . instead of sending the actual qudit through",
    "the channel one sends a half of a maximally entangled state .",
    "the choi matrix is usually derived from another channel representation ( kraus maps , for example ) but almost all qkd schemes allow its direct construction .",
    "this leads to the so - called diagonal bell state . to see this ,",
    "recall that the states in many qkd schemes are always sent in one of the mub bases .",
    "that means that the number of possible errors can be enumerated  one just needs to find the error generators causing a bit flip in at least one of the bases .",
    "these are precisely the elements of the pauli group @xmath67 and so the choi matrix reads @xmath87 starting from ( [ eq : qkdchoi ] ) , the operation @xmath88 in ( [ eq : choiconverse ] ) becomes an ordinary matrix multiplication and the tilde indicates a normalized state .",
    "the probability error coefficients satisfy @xmath89 together with @xmath90 .",
    "we adopt and reformulate the method of adversarial channel derivation from  @xcite .",
    "a concise version also appears in appendix  a of  @xcite .",
    "the error analysis is straightforward . in the bit basis",
    "( the eigenvectors of @xmath80 ) , the errors are caused by @xmath91 ( there is @xmath92 of them ) and @xmath93 for all @xmath94 ( there is @xmath95 of them in total ) .",
    "hence the measured error rate in the bit basis reads @xmath96 where @xmath97 and @xmath98 is the rest .",
    "similarly for the phase basis , by setting @xmath99 we obtain @xmath100 it is common and experimentally reasonable  @xcite to set the error rates equal @xmath101 .",
    "the normalization condition yields @xmath102 and it is perhaps clear that @xmath98 is a free parameter that needs to be determined by taking the best eve s strategy . following  @xcite ,",
    "the most general quantum attack is a collective attack .",
    "a collective attack is eve s interaction with a passing qubit one by one with an eventual collective measurement deferred until the quantum transmission is over . in this light ,",
    "the maximum amount of information provided to eve is given by the _ minimized _ coherent information eq .",
    "( [ eq : cohinfo ] ) which we readily rewrite as @xmath103 indeed , the normalized choi matrix @xmath104 serves a double purpose : it is a channel representation but also an output of the channel whose input is maximally entangled with the reference system @xmath12 ( see eq .",
    "( [ eq : choiconverse ] ) ) .",
    "the minimized rhs can be immediately evaluated    [ eq : cohinfominimizedmub2 ] @xmath105}\\\\    & = \\log{d}+\\min_{\\la_?}\\sum_{\\a,\\b=0}^{d-1}\\la_{\\a\\b}\\log{\\la_{\\a\\b}}\\label{eq : cohinfominimizedmub2b}\\\\    & = \\log{d}+\\min_{\\la_?}\\big [    ( 1 - 2q+(d-1)^2\\la_?)\\log{[1 - 2q+(d-1)^2\\la_?]}\\label{eq : cohinfominimizedmub2c}\\\\    & \\ \\quad\\qquad+2(d-1){q-(d-1)^2\\la_?\\over d-1}\\log{q-(d-1)^2\\la_?\\over d-1}{\\nonumber}\\\\    & \\ \\quad\\qquad+(d-1)^2\\la_?\\log{\\la _ ? }   { \\nonumber}\\big].\\end{aligned}\\ ] ]    equality ( [ eq : cohinfominimizedmub2b ] ) follows from @xmath106={\\mathop{{\\mathrm{id}}}\\nolimits}/d$ ] ( the channel represented by @xmath107 ( @xmath108 ) is unital ) .",
    "we also used the fact that @xmath108 is bell - diagonal in order to calculate @xmath109 using eqs .",
    "( [ eq : qberbit2mubs]),([eq : qberphase2mubs ] ) and ( [ eq : normalization2mubs ] ) . from  ( [ eq : cohinfominimizedmub2c ] ) , by setting @xmath110=0 $ ] , we find the stationary point @xmath111 and @xmath112\\big|_{(\\ref{eq : optimalvalue2mubs})}=\\frac{(d-1)^4}{(q-1)^2 q^2 \\ln{2}}>0 $ ] reveals a minimum for all @xmath0 and @xmath113 .",
    "then @xmath114 and as a result we get @xmath115 also called the bb84 channel for @xmath1 . the secret key rates obtained by plugging eq .",
    "( [ eq : optimalvalue2mubs ] ) into eq .",
    "( [ eq : cohinfominimizedmub2c ] ) read @xmath116\\ ] ] and are plotted in fig .",
    "[ fig : asympt2mubs ] for @xmath1 to @xmath3 . for @xmath1",
    "the rate goes to zero for @xmath117 which is the famous threshold derived in  @xcite .",
    "we can recover one of our earlier results also from eq .",
    "( [ eq : qkdsecretkeyrate ] ) .",
    "first , since @xmath118 and by using eq .",
    "( [ eq : quantmutinfo ] ) together with the identity @xmath119 we get @xmath120 the channel @xmath121 is unital : @xmath122 .",
    "therefore , bob s information is classical ( knowing the basis he perfectly measures the raw bit value ) , @xmath123 and @xmath124 .",
    "we also find @xmath125 and by using @xmath126 we get @xmath127 putting it all together , we obtain @xmath128\\equiv q^{(1)}({\\pazocal{n}}_d^{\\mathrm{2mubs}})\\ ] ] in accordance with eq .",
    "( [ eq : keyratesbb84 ] ) .",
    "the reason for the repetition of the previous analysis is two - fold . besides showing that our earlier approach via quantum / private capacity is valid and arguably more perspicuous , the secret key rates of the form of eq .",
    "( [ eq : qkdsecretkeyrate ] ) enable a nice interpretation of the entropic quantities and a direct comparison with the results coming from the finite key size analysis performed in  @xcite , which is based on the one - shot entropic uncertainty relations .",
    "the second point will be discussed in detail in section  [ sec : finitesizekey ] . to illustrate the first point , note that for @xmath1 we may rewrite eq .",
    "( [ eq : qkdsecretkeyrate ] ) in an even more familiar form  @xcite @xmath129 where @xmath130 is the binary shannon entropy and @xmath131 is the information leaked to eve during the error correction ( information reconciliation ) procedure .",
    "going back to a general @xmath0 , typically , @xmath132 ( recall @xmath123 from below eq .",
    "( [ eq : conditionalentbb84b ] ) ) .",
    "this is because the algorithms performing this purely classical part do not typically achieve the shannon limit  @xcite . for our purposes",
    "we consider this step to be perfect : @xmath133 .      the existence of three mubs generated by the pauli elements @xmath134 and @xmath135 for any @xmath0  @xcite is good news and it makes senses to study the secret key rates for the 3-mub qkd protocols . the error analysis is a bit more intricate . in the bit ( @xmath80 ) and phase ( @xmath81 ) basis",
    "the errors are generated by the @xmath136 and @xmath72 and by @xmath137 and @xmath72 , respectively , assuming @xmath94 .",
    "in the bit - phase basis ( the basis spanned by the eigenvectors of @xmath135 ) the errors are caused by @xmath138 ( @xmath94 ) and those _ not _ of the form @xmath77 for @xmath139 .",
    "this is shown in eq .",
    "( [ eq : paulicommutes ] ) .",
    "let us first do some counting : for a given @xmath0 there is in total @xmath140 error operators @xmath141 by excluding an identity .",
    "it contains @xmath92 of @xmath136 operators and @xmath92 of @xmath137 operators .",
    "there is also @xmath92 of @xmath77 operators for @xmath139 .",
    "hence , the number of operators of the form @xmath72 ( @xmath142 ) causing errors in the @xmath135 basis must be @xmath143 as a result we get from eq .",
    "( [ eq : qkdchoi ] ) the following error rates :    [ eq : qber_3mubs ] @xmath144    the coefficients @xmath145 are defined as before and @xmath146 for @xmath147 .",
    "we again set the error rates equal : @xmath148 .",
    "the normalization condition becomes @xmath149 and we find    [ eq : lambdacoeffsmub3 ] @xmath150    for @xmath151 .",
    "the channel is of the following form @xmath152{\\nonumber}\\\\              & \\quad+{q-2(d-1)\\la_?\\over(d-2)(d-1)}\\sum_{\\a\\neq\\b=1}^{d-1}x_d^\\a z_d^\\b\\vr { \\big(x_d^\\a z_d^\\b\\big)}^\\dg.\\end{aligned}\\ ] ] the minimization procedure similar to eq .",
    "( [ eq : cohinfominimizedmub2 ] ) leads to an analytical solution ( too long to paste here ) of the following cubic equation @xmath153 ^ 2.\\ ] ] the resulting secret key rates are given by @xmath154 and are plotted in fig .  [ fig : asympt3mubs ] . by comparing with fig .",
    "[ fig : asympt2mubs ] we can see that the tolerable threshold values are much better than for the corresponding 2-mub protocol .",
    "our results perfectly agree ( in the overlapping cases ) with a numerical study from  @xcite as well as the secret key rates and thresholds from  @xcite .",
    "the @xmath1 case must be analyzed separately and it is the well - known six - state protocol  @xcite .",
    "the channel is the qubit depolarizing channel ( see again  @xcite , appendix  a ) @xmath155 then @xmath156 where @xmath157 .",
    "the one - shot capacity becomes zero for the threshold value @xmath158  @xcite .",
    "the condition for a secret key generated when the resources are not unlimited is formally identical to eq .",
    "( [ eq : privacy ] ) . however , eq .  ( [ eq : privacy ] )",
    "can not this time be satisfied arbitrarily well .",
    "more precisely , for finite - length private codes , @xmath159 is chosen sufficiently small and it becomes an input parameter of the secret key generation protocol .",
    "the task can be further reformulated ",
    "it is often advantageous to investigate separately two conditions : ( i ) _ correctness _",
    "@xmath160\\leq\\e_{cor},\\ ] ] where the key string is allowed to be different with a nonzero probability @xmath161 , and ( ii ) _ secrecy _ @xmath162 this means that an adversary is decoupled from the resulting secret key sequence by a small ( but fixed ) amount @xmath163 .",
    "due to composability  @xcite , the errors add up and the overall security parameter is bounded : @xmath164we took the liberty of ignoring the possibility of failure @xmath165 during the privacy amplification ( pa ) step and the probability of failure @xmath161 of correctly estimating alice s key , eq .",
    "( [ eq : correctness ] ) .",
    "both parameters are undoubtedly important for the overall secret key rate in the non - asymptotic scenario .",
    "they manifest themselves as additional exponents in eq .",
    "( [ eq : leftover ] ) in the form proportional to @xmath166}$ ] .",
    "the errors are chosen independently as part of the protocol  @xcite but our main interest lies in @xmath163 and so we will study the key rate as its function . for a practical piece of advice as what to do in the deployed scenario , where all parameters must be set , we point the reader to  ref .",
    "@xcite and also  @xcite . ] . similarly to the asymptotic analysis , the `` measure '' of decoupling , @xmath163 , is related , through the decoupling lemma  @xcite @xmath167 to the smooth min - entropy @xmath168 where @xmath169}}.\\ ] ] we will also need the max - entropy definition @xmath170\\big]^2},\\ ] ] where for two commuting distributions @xmath171 and @xmath172 the optimization can be performed  @xcite .",
    "given the secrecy parameter @xmath163 , the secret key of the length @xmath173 can be extracted whenever @xmath174 the secret key rate is achievable  @xcite .",
    "given the security parameters @xmath175 in  ( [ eq : leftover ] ) , the constructed code satisfies the decoupling condition . in coding theory , the statement of achievability is usually proved by a random construction via a direct coding theorem .",
    "this is precisely the construction found in sec .",
    "5.4  of  @xcite .",
    "the original derivation from  @xcite has been further elaborated on and sharpened providing increasingly better estimates for the secret key rate .",
    "for the most important contributions , we should not forget to mention  @xcite and mainly  @xcite culminating in  @xcite whose extension to the qkd qudit protocols will be presented in the next section .",
    "also note the similarity between eq .",
    "( [ eq : qkdsecretkeyrate ] ) and eq .",
    "( [ eq : secrecycond ] ) .",
    "indeed , this is not a coincidence , the latter can be seen as a finite - key version of the former  @xcite .",
    "the conditional entropy belongs to a parametric family of the so - called rnyi entropies and both the min- and max - entropy , eq .",
    "( [ eq : minent ] ) and  [ eq : maxent ] , are family members with an operational meaning relevant for qkd  @xcite .",
    "furthermore , we have the equipartition property @xmath176    an important advance in the security of the finite - key size qkd using two mubs was possible due to the use of the uncertainty relation for smooth entropies : @xmath177 ref .",
    "@xcite explains the physical interpretation in detail so we will only say that uncertainty relations in general limit the knowledge in one basis if a measurement is performed in the complementary basis . in this case , the complementary basis ( the eigenvectors of the pauli @xmath80 basis ) is used exclusively for the sacrificed portion of the sifted key and this consequently serves for an estimation of the preserved part of the sifted key ( which itself is transmitted in the basis spanned by the eigenvectors of the pauli @xmath81 matrix ) .",
    "the direct evaluation of the smooth min - entropy for @xmath178 in eq .",
    "( [ eq : secrecycond ] ) is not straightforward .",
    "there exists a couple of methods to estimate it and the most advanced analysis so far , based on the smooth entropy uncertainty relations , appeared in  @xcite following  @xcite .",
    "we present its generalization to the qudit scenario for the 2-mub qkd protocol .",
    "this approach provides the best secret key rate known to the authors but it can not be extended to the case of 3 mubs in a straightforward manner . in this case",
    "we use another strategy via the study of the asymptotic behavior of the smooth min - entropy .",
    "this bound already appeared in  @xcite and we improve it by recent insights based on the _ conditional entropy variance _ ( the so - called second - order approximation of the quantum coding rate  @xcite ) . for the sake of comparison , we evaluate these bounds also for the 2-mub qudit protocol . here , the finite - key corrections come from two sources .",
    "first , it is the approximations of the smooth min - entropy and the smooth quantities in general .",
    "the second source of corrections is the error rate estimation phase , where a part of the sifted key is sacrificed in order to estimate the error rate of the data used to extract the actual secret key .",
    "to proceed , we will recapitulate the relevant parts^[foot : relqkd]^ of the qudit 2- and 3-mub qkd protocol in order to apply the methods of  @xcite . for the case of 2 mubs",
    ", we may adopt the same protocol definition as in box  1 of  ref .",
    "in particular , an asymmetric choice of the complementary bases is used  @xcite , one for the raw key whose length will be labeled @xmath51 and the other one of the length @xmath179 used solely in the parameter estimation step .",
    "hence , the total length of the sifted key is @xmath180 .",
    "the difference compared to  @xcite is the calculation of the average error @xmath181 subsequently used for the parameter estimation . as a pure formality  instead of the modulo two addition of the publicly announced bit sequences of the length  @xmath179 ( used to count the number of differing bits ) , the communicating parties may use @xmath182 where @xmath183 stands for the modulo @xmath0 subtraction and @xmath184 denotes the set indicator function defined for two sets @xmath185 as @xmath186 whenever @xmath187 and zero otherwise . in the parameter estimation phase",
    ", the sacrificed portion of the sifted sequence of the length @xmath179 over @xmath0 letters ( transmitted in the pauli @xmath80 basis ) is used to estimate the error rate in the portion of the length @xmath51 transmitted in the pauli @xmath81 basis .",
    "analogously to  @xcite , we are penalized by effectively increasing the error rate by @xmath188 due to the finiteness of the statistics .",
    "more precisely , the estimate of large deviations for an independent and identically distributed random process sampled without replacement due to serfling is used  @xcite .    for three mubs ,",
    "the qkd protocol must be modified only such that the pauli @xmath81 basis will be used for the key extraction and the @xmath80 and @xmath135 basis for the parameter estimation step .",
    "so the communicating parties will be instructed to switch the bases accordingly with equal probabilities for the @xmath80 and @xmath135 bases . in this case , the uncertainty relations based approach does not provide the best secret key rates and the smooth min - entropy from eq .",
    "( [ eq : leftover ] ) must be estimated differently ( see eq .",
    "( [ eq : smoothminentestimaterenner ] ) onwards ) .    a useful upper bound on the classical max - entropy",
    "is given by the probability distribution support ( the set over which the probability distribution is positive  @xcite ) leading to @xmath189}|}=\\log{\\big|\\big\\{x\\in\\{0,1,\\dots , d-1\\};\\pr{[x = x|y = y]}>0\\big\\}\\big|}.\\ ] ] here we generalize the result from  @xcite ( claim  9 ) and show that the rhs satisfies @xmath190}>0\\big\\}\\big|}\\leq n\\big(h(q+\\nu)+(q+\\nu)\\log{(d-1)}\\big)\\ ] ] for the 2-mub protocol .",
    "we start as in  @xcite    [ eq : hminestimate ] @xmath191}>0\\big\\}\\big|          & \\leq\\sum_{x\\in\\{0,\\dots , d-1\\}^n}\\mathsf{\\mathbf{1}}\\{\\la < n(q+\\nu)\\ } \\\\     & = \\sum_{\\la=0}^n\\binom{n}{\\la}(d-1)^\\la\\mathsf{\\mathbf{1}}\\{\\la <",
    "n(q+\\nu)\\}\\\\     & = \\sum_{\\la=0}^{n(q+\\nu)}\\binom{n}{\\la}(d-1)^\\la\\\\     & \\leq 2^{n(h(q+\\nu))}(d-1)^{n(q+\\nu)}.\\end{aligned}\\ ] ]    the new term @xmath192 in the first equality comes from an additional number of errors caused by a larger ( @xmath0-letter ) alphabet . the last line comes from @xmath193 , valid for @xmath194 , and by taking into account @xmath195 . upon taking the logarithm",
    "we obtain  ( [ eq : supportprobbound ] ) .",
    "this , on the other hand , allows us to bound the min - entropy from eq .",
    "( [ eq : leftover ] ) via  eq .",
    "( [ eq : uncertrel ] ) : @xmath196 hence , we get for  ( [ eq : secrecycond ] ) @xmath197 and so finally the optimized secret key rate is given by @xmath198.\\ ] ] the numerical optimization was done by choosing a target number of sifted signals @xmath199 , the error rate @xmath113 and the security parameter @xmath175 .",
    "the result of optimization is the highest rate and also the number @xmath179 of sacrificed bits needed to achieve it .",
    "another option , we did not pursue , was to set the target number @xmath51 of raw bits and optimize the rate over @xmath179 sa well .",
    "the choice depends more on practical requirements . as expected , in the limit of @xmath200 or @xmath201 , we recover eq .",
    "( [ eq : keyratesbb84 ] ) ( ( [ eq : qkdsecretkeyratebb84again ] ) ) .",
    "this is because @xmath202 and @xmath203 .",
    "the smooth min - entropy estimates reveal the rate of convergence in eq .",
    "( [ eq : equipartition ] ) .",
    "the first such estimate widely used in the literature was provided by renner  @xcite ( cor .",
    "3.3.7 ) @xmath204 a better estimate comes from the recent advances in finite block length quantum coding  @xcite through @xmath205 where @xmath206\\ ] ] is the relative entropy variance and @xmath207\\ ] ] is the quantum relative entropy  @xcite .",
    "then , as a special case , we obtain the quantum conditional entropy and the conditional entropy variance  @xcite @xmath208 the expression @xmath209 $ ] stands for the inverse of the complementary cumulative gaussian distribution function .",
    "the previously mentioned large deviation estimate of the smooth min - entropy manifests itself by replacing @xmath210 with @xmath211 in eqs .",
    "( [ eq : smoothminentestimaterenner ] ) and ( [ eq : smoothminentestimatetoma ] ) .    combining eq .",
    "( [ eq : secrecycond ] ) and the estimates in eqs .",
    "( [ eq : smoothminentestimaterenner ] ) and  ( [ eq : smoothminentestimatetoma ] ) together with eq .",
    "( [ eq : fluct ] ) we get an achievable upper bound for the secret key rate @xmath212.\\ ] ] the optimized secret key rate @xmath213 is plotted as the two lower curves in fig .",
    "[ fig : finitekey2mubs ] for the 2-mub protocol and in fig .",
    "[ fig : finitekey3mubs ] for the 3-mub protocol .",
    "then , the overall number of secret key bits is given by @xmath214 for @xmath179 found in eq .",
    "( [ eq : keyratefinite ] ) .",
    "[ fig : finitekey2mubslog ] shows the @xmath215 and @xmath216 cases from fig .",
    "[ fig : finitekey2mubs ] on a semilogarithmic scale .",
    "with the promising results of an increased secret key rate at hand , we now turn to laboratory implementations of discrete high - dimensional state spaces .",
    "although the presented theoretical analysis is valid for any experimental realization , we focus on one prominent example , namely transverse spatial light modes .",
    "encoding high - dimensional quantum states on the orbital angular momentum of photons is a vibrant field in which technologies to generate and manipulate the states have matured over the last 15 years . here",
    ", the eigenstates of two mubs can be intuitively understood as the complementary variables , orbital angular momentum ( oam ) and angular position ( ang ) .",
    "they correspond to the generators @xmath80 and @xmath81 , respectively , which we introduced earlier ( eq .  ( [ eq : pauligens ] ) ) .",
    "high - dimensional states of both mubs have been used in previous experiments to demonstrate complementarity as well as high - dimensionality of the generated quantum states  @xcite .",
    "more importantly , their advantage in high - dimensional qkd has been demonstrated recently  @xcite and experimental techniques for efficiently sorting the encoded qudits are well established @xcite .    in fig .",
    "[ fig:3mubs ] , we give an example of the eigenmodes of all three mubs for dimension @xmath216 : the oam - basis @xmath217 , the ang - basis @xmath218 and the eigenstates of @xmath219 . the typical vortex of oam carrying light modes and their according helical phase dependence ( from which the oam stems ) can be seen ( fig .",
    "[ fig:3mubs ] .",
    "a ) as well as the angular - shaped intensity of the states in the second mubs ( fig .",
    "[ fig:3mubs ] .",
    "the modes of the third mub are more complex in their intensity and phase profile ( fig .",
    "[ fig:3mubs ] .",
    "c ) , which leads to open questions of how practical such modes are in a laboratory setting .",
    "although modern techniques to generate complex light fields with high fidelity and efficiency are well known @xcite , the efficient sorting of a general set of spatial modes remains difficult .",
    "possible techniques will need to be efficient and to work on the single photon level .",
    "both requirements are fulfilled for established sorting devices that are used for oam and ang modes but no direct techniques is known yet , which sorts the modes of the third basis .",
    "one way to circumvent this lack of an efficient direct sorting would be to transfer the transverse spatial degree of freedom into different optical paths , e.g. as described  @xcite .",
    "once transferred , it is known how to realize any unitary transformation on the state , and thus an efficient detection could be done in any basis  @xcite . here , the fast progress in integrated quantum optics might a promising way to realize such a so - called multiport even for dimensions as high as @xmath216 @xcite .    in summary , we calculated secret key rates and tightly estimated achievable upper bounds on acceptable errors for an asymptotic and finite key length scenario in high - dimensional qkd schemes .",
    "we were able not only to reproduce and streamline already known bounds but mainly we ( i ) adapted the uncertainty - relations - based method to high - dimensional qkd with two mubs leaving us with nonzero secret key rates even for a relatively small number of signals and ( ii ) extended the findings to a qkd scheme involving 3 mubs basis . given the assured existence of 3 mubs in any dimension , our results are not limited to dimensions where the exact number of mubs is known and they can be readily applied to laboratory implementations .",
    "additionally , we give an example for a possible physical implementation , transverse spatial modes , for which mature techniques in generating all possible qudit - states exist and devices to efficiently sort the states of two mubs are established .",
    "hence , an important future challenge is to develop a practical device that efficiently sorts the modes of the third mub . given the derived increase in the secret key rate , the development of such a novel sorter will further boost high - dimensional qkd schemes and their real - world implementations .",
    "rb , rf and kb thank the canada excellence research chairs program for support .",
    "ab , rb , and kb acknowledge support from the natural sciences and engineering research council of canada .",
    "rb and mm acknowledge support from the us office of naval research . in addition , kb thanks patrick coles for comments and pointers to relevant literature ( @xcite ) ."
  ],
  "abstract_text": [
    "<S> we present a detailed security analysis of a @xmath0-dimensional quantum key distribution protocol based on two and three mutually unbiased bases ( mubs ) both in an asymptotic and finite key length scenario . </S>",
    "<S> the finite secret key rates ( in bits per detected photon ) are calculated as a function of the length of the sifted key by ( i ) generalizing the uncertainly relation - based insight from bb84 to any @xmath0-level 2-mub qkd protocol and ( ii ) by adopting recent advances in the second - order asymptotics for finite block length quantum coding ( for both @xmath0-level 2- and 3-mub qkd protocols ) . </S>",
    "<S> since the finite and asymptotic secret key rates increase with @xmath0 and the number of mubs ( together with the tolerable threshold ) such qkd schemes could in principle offer an important advantage over bb84 . </S>",
    "<S> we discuss the possibility of an experimental realization of the 3-mub qkd protocol with the orbital angular momentum degrees of freedom of photons . </S>"
  ]
}