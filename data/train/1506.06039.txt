{
  "article_text": [
    "calcium imaging , first used to measure the activity of neurons in the early 1990s @xcite , has been successfully applied throughout the nervous system .",
    "it allows us to see the behavior of neurons in awake behaving mice , using either chemical or genetic calcium indicators , with confocal microscopy , two - photon microscopy , or wearable imaging devices @xcite . as a result , it is an increasingly useful tool for identifying the neural substrate of mouse behaviors . however , calcium imaging videos have difficult noise properties , including white noise and motion artifacts which must be corrected in a preprocessing step before proper analysis can be undertaken .",
    "motion correction is the first step in the analysis of calcium images .",
    "after they are motion - corrected , rois are identified , and time - activity graphs are made from each roi . if the motion - correction is low - quality , then the time - activity graphs suffer , and the reconstructed networks may have errors . for real time",
    "closed loop operation , if the motion correction is slow , it can not be done while the mouse is in the microscope , and the experiment fails .",
    "turboreg @xcite is a commonly used algorithm to do motion correction .",
    "it uses a downsampling strategy , which is prerequisite for speed , and it uses a template image , which is necessary for accuracy .",
    "we have developed a similar method , called _ moco _ ( motion corrector ) , which adopted both strategies , since correcting one image against the next in the stack results in unacceptable roundoff errors .",
    "other approaches use hmms @xcite , @xcite or other techniques @xcite , @xcite , @xcite , @xcite , @xcite .",
    "@xcite is the only one similar mathematically to , and may be slightly faster than , moco , but it has accuracy problems ( see figure 2 ) .",
    "moco uses downsampling and a template image , and it can be called from imagej .",
    "however , it is faster than turboreg @xcite at translation - based motion correction because it uses dynamic programming and two - dimensional fft - acceleration of two - dimensional convolutions .",
    "@xcite also uses the fft approach but uses a different objective function that does not require dynamic programming ; we believe that our approach is more robust to corrupted data , see figure 2 .",
    "image stabilizer is as fast for small images , but is very slow for standard - size images .",
    "running on our own datasets , moco appears faster than all approaches compatible with imagej .",
    "moco corrects every image in the video by comparing every possible translation of it with the template image , and chooses the one which minimizes the @xmath0 norm of the difference between the images in the overlapping region , @xmath1 , divided by the area of @xmath1 . the fact that it is",
    "so thorough makes it robust to long translations in the data .",
    "more complicated non - translation image warps are usually unnecessary for fixing calcium images , which suffer from spurious translations , which moco corrects , and spurious motion in the z - direction , which is very hard to correct .",
    "our approach also uses cache - aware upsampling : when an image is aligned with the template in the downsampled space , it must be jittered when it is upsampled to see which jitter best aligns with the upsampled template .",
    "we do this in such a way that data that is used recently is reused immediately , making the implementation faster . hence , moco is an efficient motion correction of calcium images , and is likely to become a useful tool for processing calcium imaging movies .",
    "let @xmath2 , for @xmath3 and @xmath4 be an image in the stack .",
    "we assume @xmath5 is downsampled if it is larger than @xmath6 .",
    "let @xmath7 be the template image against which to align @xmath5 .",
    "we want to pick @xmath8 such that @xmath9 , where @xmath10 is input by the user , and @xmath11 is minimal , where @xmath12 is the set of ordered pairs of integers @xmath13 such that @xmath14 , @xmath15 , @xmath16 , and @xmath17 .",
    "if we do this for every image @xmath5 in the stack , we have then motion corrected the video , and we are done , up to a short upsampling step . to upsample , multiply the optimal @xmath8 by @xmath18 and do a local search to minimize @xmath19 on the finer grid .",
    "now , @xmath20 the first two sums can be computed via dynamic programming .",
    "let s consider @xmath5 when @xmath21 and @xmath22 are negative .",
    "let @xmath23 we have that @xmath24 hence , the first two sums can be computed for all @xmath8 in @xmath25 time , which is unaffected by a constant amount of downsampling .",
    "it suffices to compute for all @xmath8 such that @xmath9 , @xmath26 let @xmath27 be @xmath28 rotated @xmath29 degrees . using matlab notation , let @xmath30;{\\rm zeros(w , n+w)}]),\\ ] ]",
    "@xmath31;{\\rm zeros(w , n+w)}]).\\ ] ] commas denote horizontal concatenation , semicolons denote vertical concatenation , and @xmath32 is an @xmath33 matrix of zeros . for equally sized matrices",
    "@xmath34 , @xmath35 , let @xmath36 mean @xmath37 .",
    "then @xmath38 is a rearrangement of @xmath39 .",
    "since @xmath40 s are fast , that means @xmath39 can be computed for all @xmath8 in @xmath41 time .",
    "hence , after upsampling , the entire video can be aligned in @xmath42 time , where @xmath43 is the number of slides in the video .",
    "after @xmath8 are chosen to minimize @xmath19 , they are multiplied by two multiple times to upsample .",
    "every time they are multiplied by @xmath18 , @xmath44 are computed for @xmath45 to see which @xmath46 and @xmath47 are minimal .",
    "these nine evaluations of @xmath48 are done with a cache - aware algorithm for speed .",
    "we compare moco in speed to turboreg @xcite on its translation mode , using both the `` fast '' and `` accurate '' settings .",
    "we also compare it to image stabilizer using its default settings @xcite ( it can be made faster by changing the settings but the accuracy is poor ) .",
    "we use several real calcium imaging videos , which we say are @xmath49 if they contain @xmath43 slides of size @xmath50 .",
    "if the images are larger than @xmath6 , we downsample once , otherwise , we do not downsample .",
    "we have found that dowsampling @xmath51 and @xmath52 times causes severe errors so we avoid those settings .",
    "in addition , we have compared moco to turboreg on synthetic images with severe translational motion artifacts and have found that moco is slightly more accurate .",
    "all times are in seconds .",
    "the template used for every video is the first image in the video for both moco and turboreg .",
    "moco uses a maximum translation width of @xmath53 in both the @xmath54 and @xmath55 directions .",
    ".2 in    [ cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "the first author would like to thank julia sable for her help , and inbal ayzenshtat , jesse jackson , jae - eun miller , luis reid , weijian yang , and weiqun fang for their datasets .",
    "the first author would also like to thank the columbia university data science institute for their ongoing support .",
    "this research is supported by the nei ( dp1ey024503 , r01ey011787 ) , nihm ( r01mh101218 , r41mh100895 ) and darpa contract w91nf-14 - 1 - 0269 .",
    "this material is based upon work supported by , or in part by , the u. s. army research laboratory and the u. s. army research office under contract number w911nf-12 - 1 - 0594 ( muri ) .",
    "david s. greenberg , jason n.d .",
    "kerr , `` automated correction of fast motion artifacts for two - photon imaging of awake animals , '' _ journal of neuroscience methods _ , volume 176 , issue 1 , 15 january 2009 , pages 115 .",
    "patrick kaifosh , jeffrey d. zaremba , nathan b. danielson , and attila losonczy , `` sima : python software for analysis of dynamic fluorescence imaging data , '' front neuroinform .",
    "2014 ; 8 : 80 . published online 2014 sep 23"
  ],
  "abstract_text": [
    "<S> motion correction is the first in a pipeline of algorithms to analyze calcium imaging videos and extract biologically relevant information , for example the network structure of the neurons therein . </S>",
    "<S> fast motion correction would be especially critical for closed - loop activity triggered stimulation experiments , where accurate detection and targeting of specific cells in necessary . </S>",
    "<S> our algorithm uses a fourier - transform approach , and its efficiency derives from a combination of judicious downsampling and the accelerated computation of many @xmath0 norms using dynamic programming and two - dimensional , fft - accelerated convolutions . </S>",
    "<S> its accuracy is comparable to that of established community - used algorithms , and it is more stable to large translational motions . </S>",
    "<S> it is programmed in java and is compatible with imagej . </S>"
  ]
}