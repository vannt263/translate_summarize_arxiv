{
  "article_text": [
    "gromov  witten invariants are deformation invariant numbers associated to a smooth variety over @xmath0 that are closely related to the numbers of curves in that variety with prescribed incidence to specified homology classes .",
    "they are defined by intersecting the homology classes in question with the virtual fundamental class on the moduli space of stable maps .",
    "there are thus two essential ingredients in gromov  witten theory : a proper moduli space on which to do intersection theory , and a virtual fundamental class of the expected dimension in the homology of that moduli space .    in this paper",
    ", we will be interested in counting rational curves in a smooth variety with prescribed incidence conditions , as well as prescribed tangencies along a divisor .",
    "the introduction of tangencies makes the definition of gromov  witten invariants more subtle . since a tangency can degenerate to one of higher order , it is not obvious how to produce a proper moduli space , and since a tangency can be deformed to lower order , it is not obvious how to do the deformation theory necessary to produce a virtual fundamental class",
    ".    there are now several solutions to this problem .",
    "the first is the theory of _ relative stable maps _ , introduced by a. m. li and y. ruan in @xcite , but also studied by ionel ",
    "parker @xcite , gathmann @xcite and several others .",
    "in algebraic geometry it is due to j. li  ( @xcite and  @xcite ) . in this theory ,",
    "tangencies are prevented from degenerating to higher order by allowing the target variety to expand , in close analogy to the way a deligne ",
    "mumford stable curve might expand to prevent a marked point from colliding with a node .",
    "the deformation theory of these curves still remains quite subtle , however .",
    "a second solution  @xcite is to change the target variety by a _",
    "root construction_. the variety is replaced by a stack that is isomorphic to the original variety away from the divisor , but in which the divisor is replaced by a `` stacky '' version of itself with a cyclotomic stabilizer group . provided that the stackiness of the divisor is taken to be large enough , the concept of tangency to the divisor in the original variety can be replaced with transversal contact to the stacky divisor in the root stack .",
    "in other words , the ordinary theory of twisted stable maps  @xcite applies to yield a proper moduli space and a virtual fundamental class via straightforward deformation theory .",
    "the disadvantage of this theory , as compared to relative stable maps , is that it may include extraneous information ( in higher genus ; see section  [ sect : genus1 ] ) and can not be used in the degeneration formula  @xcite ,  @xcite .",
    "cadman and chen applied cadman s method to enumerate rational curves tangent to a smooth plane cubic  @xcite .",
    "some of these numbers were also computed by gathmann using relative gromov ",
    "witten invariants  @xcite .",
    "it is no surprise that these numbers agree when they are both enumerative : they count the same thing . remarkably , however , one is enumerative if and only if the other is , and the invariants coincide even if they are not enumerative .",
    "our goal in this paper is to explain this coincidence by comparing the approaches of j. li and cadman in genus  @xmath1 .",
    "our comparison goes by way of a third theory that combines the advantages of both while avoiding the disadvantages  @xcite .",
    "this `` relative  orbifold '' theory furnishes a correspondence between the relative and orbifold moduli spaces .",
    "@xmath2{x , d } ) \\ar[dr]^\\phi \\ar[dl]_{\\psi } \\\\      { { \\overline{m}}}^{{\\mathrm{rel}}}(x , d ) & & { { \\overline{m}}}^{{\\mathrm{orb}}}(\\sqrt[r]{x , d } )     } \\ ] ] ( the notation here is temporary and will be superseded in the body of the text . )",
    "it is shown in  @xcite that @xmath3 is an isomorphism and identifies the virtual fundamental classes , so our task is primarily to study the map @xmath4 .",
    "this map is not an isomorphism , even in genus zero and for large @xmath5 , but we will show that it nevertheless carries one virtual fundamental class to the other via push - forward , and therefore identifies the gromov ",
    "witten invariants .",
    "there is a fourth theory of stable maps relative to a divisor called _ logarithmic stable maps _ , currently in development by several groups",
    ". we will not discuss logarithmic stable maps here , but see  @xcite for some of the beginnings of this theory .",
    "let @xmath6 be a smooth projective variety , @xmath7 a smooth divisor , and fix a curve class @xmath8 .",
    "consider a vector of nonnegative integers @xmath9 , with @xmath10 , cohomology classes @xmath11 where @xmath12 when @xmath13 and @xmath14 when @xmath15 , and nonnegative integers @xmath16 .",
    "for @xmath5 a positive integer , denote by @xmath17 the stack obtained by taking the @xmath5-th root of @xmath6 along @xmath18 .",
    "[ maintheorem ] fix @xmath19 .",
    "if @xmath5 is any sufficiently large and divisible natural number then the following relative and orbifold invariants coincide .",
    "@xmath20    our notation",
    "is explained in the following section .",
    "there is also a table of notation in appendix  [ app : notn ] .      1 .",
    "consider @xmath21 the moduli space of relative stable maps to @xmath22 , where * the source curve has genus @xmath23 and @xmath24 marked points , * the @xmath25-th marked point has contact order @xmath26 with @xmath18 , and * the homology class of the curve is @xmath27 .",
    "+ let @xmath28 be the @xmath25-th evaluation map , where @xmath29 let @xmath30 be the @xmath25-th section of the universal _ contracted curve mapping to @xmath6 _ , and let @xmath31 .",
    "the stack @xmath32 admits a virtual fundamental class @xmath33^{\\mathrm{vir}}$ ] defined in @xcite .",
    "+ with this notation we set @xmath34^{\\mathrm{vir } } } \\psi_1^{a_1}e_1^*\\gamma_1\\cdots   \\psi_n^{a_n}e_n^*\\gamma_n.\\ ] ] 2 .",
    "consider @xmath35 the moduli space of stable maps to @xmath36 , where * the curve has genus @xmath23 and @xmath24 marked points , * the _ coarse _ evaluation map at the @xmath25-th marked point ( defined below ) @xmath37 lands in the twisted sector of age @xmath38 ( which is isomorphic to @xmath6 if @xmath39 and to @xmath18 if @xmath15 ) , and * the homology class of the curve is @xmath27 .",
    "+ we have used the notation @xmath40 for the coarse moduli space of the inertia stack of @xmath36 , which has @xmath5 components : @xmath41 the components isomorphic to @xmath18 are called twisted sectors , and are labeled by the ages @xmath42 .",
    "+ let @xmath43 be the @xmath25-th section of the _ universal coarse curve mapping to @xmath6 _ , and let @xmath44 .",
    "the stack @xmath45 admits a virtual fundamental class @xmath46^{\\mathrm{vir}}$ ] defined in @xcite .",
    "+ with this notation we set @xmath47^{\\mathrm{vir } } } \\psi_1^{a_1}e_1^*\\gamma_1\\cdots   \\psi_n^{a_n}e_n^*\\gamma_n.\\ ] ]      note that theorem  [ maintheorem ] applies only to genus zero invariants .",
    "the necessity of this restriction may be seen in the following example , which was shown to us by davesh maulik  @xcite .",
    "let @xmath48 be an elliptic curve and let @xmath49 .",
    "let @xmath50 , the union of the fibers of @xmath6 over @xmath1 and @xmath51 .",
    "let @xmath52 be the class of a fiber of @xmath53 .",
    "then the relative invariant with no insertions vanishes : @xmath54 .",
    "a simple explanation for this is that the invariant remains the same when taking covering of @xmath55 branched at @xmath56 , and at the same time it is multiplied by the degree of the cover .",
    "note that the space of genus  @xmath57 relative maps to @xmath22 of class @xmath58 has expected dimension @xmath1 , even though the actual dimension is @xmath57 .",
    "let @xmath59 be the stack obtained from @xmath6 via an @xmath5-th root construction on @xmath60 and an @xmath61-th root construction on @xmath62 .",
    "the space @xmath63 has a @xmath57-dimensional component and @xmath64 components of dimension @xmath1 .",
    "the @xmath57-dimensional component is isomorphic to the stack @xmath65 , obtained from @xmath55 by an @xmath5-th root at @xmath1 and an @xmath61-th root at infinity .",
    "the remaining components exist because a morphism @xmath66 which is the identity onto the first factor is determined by a @xmath67-torsor over @xmath48 .",
    "there are @xmath68 choices for the @xmath67-torsor , but the trivial torsor already appears in the @xmath57-dimensional component .",
    "the obstruction bundle on the @xmath57-dimensional component is the tangent bundle , which has degree @xmath69 .",
    "the @xmath1-dimensional components count with precisely their degree , which takes into account the automorphism group of the torsor .",
    "we may therefore calculate @xmath70    we interpret this discrepancy between the relative and twisted gromov ",
    "witten invariants to be a result of the nontriviality of the picard group of @xmath48 .",
    "a more precise statement is postponed to a later investigation .",
    "we gratefully acknowledge the help of barbara fantechi in understanding relative stable maps , martin olsson s help with @xmath71-stack , davesh maulik for a crucial example in genus 1 , and angelo vistoli with his insight on root stacks .",
    "in addition we thank jarod alper , linda chen , alessio corti , johan de jong , and michael thaddeus , for helpful discussions at various stages of this project .",
    "much progress was made while abramovich and wise were visiting msri in spring 2009 .",
    "we thank msri and the algebraic geometry program organizers for the opportunity afforded us to use its exciting environment .",
    "in order to prove the theorem , we want to relate the moduli spaces . it is natural to relate them through a third moduli space where both relative geometry and orbifold geometry are present :    consider @xmath72 the moduli space of relative stable maps to @xmath73 , with    * genus @xmath23 and @xmath24 marked points , * where the @xmath25-th marked point of the _ coarse curve _ has contact order @xmath26 with @xmath18 , and * curve class @xmath27 .",
    "we denote by @xmath74 the @xmath25-th evaluation map , where for @xmath39 we have @xmath75 and for @xmath15 we have @xmath76 .",
    "let @xmath77 be the @xmath25-th section of the universal _ coarse contracted curve mapping to @xmath6 _ , and let @xmath78 .",
    "the space @xmath79 admits a virtual fundamental class @xmath80^{\\mathrm{vir}}$ ] defined in @xcite .    with this notation we set @xmath81^{\\mathrm{vir } } }",
    "\\psi_1^{a_1}e_1^*\\gamma_1\\cdots   \\psi_n^{a_n}e_n^*\\gamma_n.\\ ] ]      for any @xmath82 we have a diagram of stabilization morphisms @xmath83_{\\psi } \\ar[dr]^{\\phi}\\\\   { { \\overline{m}}}^{\\mathrm{rel}}(x , d ) & &   { { \\overline{m}}}^{\\mathrm{orb}}({\\mathscr{x}}_r ) .   } \\ ] ]    we have defined the terms so that    * @xmath84 * @xmath85 therefore * @xmath86 and finally * @xmath87    consequently , the projection formula gives us @xmath88^{\\mathrm{vir } } ) } \\psi_1^{a_1}e_1^*\\gamma_1\\cdots   \\psi_n^{a_n}e_n^*\\gamma_n\\\\ & =   \\int_{\\phi_*([{{\\overline{m}}}^{{\\mathrm{relorb}}}]^{\\mathrm{vir } } ) } \\psi_1^{a_1}e_1^*\\gamma_1\\cdots   \\psi_n^{a_n}e_n^*\\gamma_n\\end{aligned}\\ ] ] where the integrals are on @xmath89 and @xmath90 , respectively .",
    "theorem  [ maintheorem ] is thus a consequence of the following two theorems .",
    "[ prop1 ]    1 .   for any @xmath82 and",
    "any twisting choice @xmath91 we have @xmath92^{{\\mathrm{vir } } } )   = [ { { \\overline{m}}}^{{\\mathrm{rel}},{\\mathfrak{r}}}(x , d)]^{{\\mathrm{vir}}}\\ ] ] where the obstruction theories are those defined in @xcite .",
    "2 .   the gromov ",
    "witten invariants defined using @xmath93^{{\\mathrm{vir } } } $ ] coincide with those defined in [ sec : conv](1 ) using @xmath94^{{\\mathrm{vir}}}$ ] .",
    "[ prop2 ] if @xmath95 , then for any @xmath5 sufficiently large and divisible depending on @xmath27 we have @xmath96^{{\\mathrm{vir } } } )   = [ { { \\overline{m}}}^{\\mathrm{orb}}({\\mathscr{x}}_r)]^{{\\mathrm{vir}}}\\ ] ]    part  ( 1 ) follows from ( * ? ? ?",
    "* theorem  4.4.1 ) . indeed given a twisting choice @xmath91 , the moduli spaces",
    "* @xmath97 of relative twisted stable maps with twisting choice @xmath91 and * @xmath98 of relative twisted stable maps with twisting choice @xmath99    are identical with identical obstruction theories ( as defined in  ( * ? ? ?",
    "* section 4.2 , lemma c.3.3 ) ) .",
    "the equality of invariants in part  ( 2 ) is proved in ( * ? ? ?",
    "* section  4.7 ) .",
    "we emphasize that we do not compare our virtual classes to those defined in @xcite .",
    "see discussion in ( * ? ? ?",
    "* section  4.7 ) .",
    "the third author has an argument for comparing these classes which goes beyond the scope of this paper",
    ".    we will prove theorem  [ prop2 ] in section  [ sec : main_prop ] using a technique introduced by costello .",
    "we restrict to genus @xmath1 maps and construct a cartesian square @xmath100\\ar_{\\sigma^{\\mathrm{rel}}}[d ]   & { { \\overline{m}}}^{\\mathrm{orb}}({\\mathscr{x}}_r)\\ar[d]^{\\sigma } \\\\   { { { \\mathfrak{m}}}^{{\\mathrm{rel}}}({\\mathscr{a}},{{{\\mathcal{b}}{\\mathbb{g}}_m}})'}\\ar^<>(0.5){\\phi_{\\mathscr{a}}}[r ] & { { { \\mathfrak{m}}}({\\mathscr{a}})'}. } \\ ] ] @xmath101 @xmath102    here",
    "@xmath103 is the morphism denoted @xmath4 above .",
    "we use @xmath104 to stand for the stack @xmath105 $ ] , which includes @xmath106 $ ] as a closed substack ( of artin type ) .",
    "we show below that the diagram has the following properties :    1 .",
    "the virtual fundamental classes can be defined via perfect relative obstruction theories relative to the vertical arrows , and 2 .   the hypotheses of (",
    "* theorem  5.0.1 ) are satisfied for these choices .",
    "the stacks in the bottom row of this diagram require definition , which will be given explicitly in section  [ sect : main - diagram ] . for the moment , we note the following .    * we define @xmath107 to be the stack of triples @xmath108 , where @xmath109 is a twisted curve , @xmath110 a line bundle on @xmath109 and @xmath61 a section of @xmath110 , such that the associated morphism @xmath111 is representable .",
    "the stack @xmath112 is defined in section  [ sect : constr - of - ma ] as an open substack of @xmath113 .",
    "* let @xmath114 be jun li s moduli space of expanded pairs ( see section  [ sect : exp - pairs ] and  @xcite ) .",
    "we define @xmath115 to be the stack of maps over @xmath114 from twisted curves to expansions of @xmath104 relative to the divisor @xmath116 .",
    "the stack @xmath117 is defined in section  [ sect : constr - of - marel ] , and it is shown there to be tale over @xmath118 .",
    "in this section we will construct the stacks appearing in diagram  .",
    "our definitions require the notion of stable maps into the fibers of a morphism , which we summarize first . in section  [",
    "sect : exp - pairs ] we describe our perspective on j. li s moduli space of expansions of a scheme with a divisor ; this section summarizes material from  @xcite . finally in section  [",
    "sect : constr - of - ma ] and  [ sect : constr - of - marel ] we construct the stacks in the bottom row of diagram   and in section  [ sec : algebraicity ] we show that they are algebraic .",
    "we refer the reader to appendix  [ app : mod - diag ] for some of the details that are omitted from this section .",
    "suppose that @xmath119 is a morphism of stacks .",
    "we define  @xmath120 to be the stack of commutative diagrams @xmath121^f \\ar[d ] & x \\ar[d ] \\\\      s \\ar[r ] & t    } \\ ] ] where @xmath122 is a family of twisted pre - stable curves with an ordered set of marked points ( not illustrated in the diagram ) , and @xmath123 s$ ] is representable . we will use the notation  @xmath124 to refer to an open and closed substack of  @xmath120 consisting of those diagrams as above having some fixed data",
    "; for example , @xmath125 will denote the substack parameterizing those diagrams where  @xmath109 has genus  @xmath23 and  @xmath24  marked ( possibly twisted ) points .",
    "let  @xmath126 be the substack of points of  @xmath120 where the ( absolute ) inertia group is unramified . under mild conditions",
    ", @xmath120 is an algebraic stack and @xmath126 is its maximal deligne ",
    "mumford substack , see proposition  [ prop : alg - stacks ] for the cases relevant in this paper .",
    "the stack of maps into the fibers of a morphism is frequently defined as the space of maps into the total space whose homology class is that of a fiber .",
    "we have not taken this approach for two reasons .",
    "the first is that we need a definition in the case where the morphism is of artin type , so we do nt know how to talk about the homology class of a fiber .",
    "the second reason is more philosophical : the obstruction theory naturally associated to the space of maps with the homology class of a fiber is different from the obstruction theory on the space of maps into a fiber as defined above ( ( * ? ? ?",
    "* appendix c.2 ) .",
    "we will eventually need to study a commutative diagram of the following form , where the upper square is cartesian and the lower square is not .",
    "@xmath127 \\ar[d ] & x ' \\ar[d ] \\\\      y \\ar[r ] \\ar[d ] & y ' \\ar[d ] \\\\      t \\ar[r ] & t '    } \\ ] ] in the application ,    * @xmath128 will be a point , * @xmath129 will be the moduli space of line bundles with section , * @xmath130 will be a smooth deligne  mumford stack with @xmath131 the morphism corresponding to a smooth divisor @xmath132 on @xmath130 ,",
    "* @xmath133 will be j. li s moduli space of expanded pairs , * @xmath134 will be the universal expansion of @xmath104 along the divisor @xmath135 , and * @xmath136 will be the universal expansion of @xmath130 along the divisor @xmath132 .",
    "this induces a cartesian diagram @xmath137 \\ar[d ] & { { \\mathfrak{m}}}(x'/t ' ) \\ar[d ] \\\\      { { \\mathfrak{m}}}(y / t ) \\ar[r ] & { { \\mathfrak{m}}}(y'/t ' ) ,    } \\ ] ] where all the maps are given by composition .",
    "however , the corresponding diagram with @xmath138 replaced by @xmath139 in the upper row is not even commutative .",
    "this is because a map @xmath140 may require the contraction of some components that become unstable after composition with the map @xmath141 while the map @xmath142 involves no contraction at all .",
    "if we do not modify the construction , this will prevent us from applying costello s theorem .",
    "our solution is to replace @xmath143 by a stack that keeps track of slightly more information : in addition to a family of curves in the fibers of @xmath144 , this stack will also parameterize a contraction of this family in the fibers of @xmath145 t$ ] .    the technical device used to achieve",
    "this is a stack @xmath146 , associated to a sequence of morphisms @xmath147 with @xmath148 representable .",
    "this is the stack whose @xmath149-points are diagrams @xmath150 \\ar[d ] & x \\ar[d ] \\\\",
    "{ { \\overline{c}}}\\ar[r ] \\ar[d ] & { { \\overline{x}}}\\ar[d ] \\\\",
    "s \\ar[r ] & t     } \\ ] ] where the stabilization of @xmath151 is an isomorphism .    given a morphism @xmath152 and @xmath153 for some stack @xmath130 over @xmath128",
    ", we define @xmath154 to be the substack of points whose inertia _ relative to @xmath155 _ is unramified .",
    "( note that we are abusing notation slightly , since @xmath156 does not depend only on @xmath157 but also on the map @xmath158 . )",
    "let @xmath159 denote the subspace of @xmath126 consisting of those diagrams   that can be stabilized in @xmath160 after composing with the map @xmath141 .",
    "then we obtain the cartesian diagram we need :    [ prop : cart - diag ] suppose that @xmath161 is a morphism of deligne  mumford type . the diagram @xmath162 \\ar[d ] & { { \\overline{m}}}(x ' / t ' ) \\ar[d ] \\\\        { { \\overline{m}}}(y / y'_t / t ) \\ar[r ] & { { \\mathfrak{m}}}(y'/t ' ) .      } \\ ] ] is cartesian .",
    "the proof ( which is straightforward from the construction ) is deferred to section  [ sect : fiber - products ] .",
    "we have a morphism @xmath164 which forgets the middle row of  .",
    "we will need the following lemma .",
    "[ lem : pf - qis ] suppose that @xmath165 is a morphism of @xmath24-marked twisted curves over @xmath149 , the stabilization of which is an isomorphism .",
    "then the canonical map @xmath166 is a quasi - isomorphism .",
    "we claim that the fibers of @xmath167 over @xmath149 are trees of genus zero curves .",
    "( note that @xmath168 is representable , so the fibers are schemes . ) to see this , we can suppose that @xmath149 is a point . since @xmath169 is a curve , the fibers of @xmath168 that are not points must each have at least one special point : the point at which the fiber is attached to the rest of @xmath169 .",
    "since the fibers that are not points are unstable curves , it follows that the these fibers must be connected curves of arithmetic genus zero .",
    "since the fibers of @xmath170 have arithmetic genus zero , @xmath171 vanishes at each geometric point @xmath172 of @xmath169 .",
    "therefore , by cohomology and base change , @xmath173 . likewise , the map @xmath174 is an isomorphism on the geometric fibers , hence is an isomorphism , again by cohomology and base change .",
    "[ lem : tau - is - formally - etale ] the morphism @xmath175 of is formally tale .",
    "we shall show that the natural obstruction theory vanishes .",
    "it is easy to produce a direct proof of this fact , but it is somewhat faster to rely on illusie s relative cohomology .    for @xmath175 to be formally tale at the point corresponding to diagram  , it is equivalent to show that , for any square - zero extension @xmath176 with ideal @xmath177 , any commutative diagram of solid arrows @xmath178 \\ar[d ] & { { \\mathfrak{m}}}(x/{{\\overline{x}}}/t ) \\ar[d ] \\\\ s ' \\ar[r ] \\ar@{-->}[ur ] & { { \\mathfrak{m}}}(x / t ) } \\ ] ] can be extended , uniquely up to unique isomorphism , to a commutative diagram including the dashed arrow . to show this , it is equivalent to show that the lifting problem @xmath179 \\ar[d]_\\pi & c ' \\ar@{-->}[d ] \\ar@/^15pt/[dd ] \\\\",
    "\\ar[d ] \\overline{c } \\ar@{-->}[r ] & \\overline{c } ' \\ar@{-->}[d ] \\\\",
    "x_s \\ar[r ] & \\overline{x}_s '   } \\ ] ] admits a solution that is unique up to unique isomorphism . by (",
    "iii , p.  199",
    "2.3.2 ) , obstructions , deformations , and infinitesimal automorphisms for such a problem are classified by @xmath180 where @xmath177 is the pull - back of the ideal of @xmath149 in @xmath181 and @xmath182 is the divisor of marked points .",
    "it therefore suffices to show that the group @xmath183 vanishes for all @xmath25 .",
    "there is an exact triangle ( * ? ? ?",
    "iii , p.  221",
    ", equation  ( 4.10.3 ) ) @xmath184 but @xmath185 is a quasi - isomorphism by lemma  [ lem : pf - qis ] , so @xmath186 is a quasi - isomorphism , and hence @xmath187 is zero for all @xmath25 .",
    "in fact @xmath188 is tale : in addition to being formally tale , it is representable by algebraic spaces and locally of finite presentation .",
    "however , we will not need that fact in such generality in this paper .",
    "[ sec : obs - thy ]    if @xmath189 is a smooth morphism over @xmath133 of deligne  mumford type it induces a natural obstruction theory for the morphism @xmath190 .",
    "let @xmath191 \\\\",
    "{ { \\mathfrak{c}}}(x / t ) \\ar[r ] \\ar@/^15pt/[urr]^f \\ar[d]_\\pi & { { \\mathfrak{c}}}(y / t ) \\ar[r ] \\ar[d ] & y \\ar[d ] \\\\",
    "{ { \\mathfrak{m}}}(x / t ) \\ar[r ] & { { \\mathfrak{m}}}(y / t ) \\ar[r ] & t    } \\ ] ] be the universal commutative diagram .",
    "there is a canonical map in the derived category of quasi - coherent sheaves on @xmath192 , @xmath193 by adjunction , we obtain a morphism in the dervied category of quasi - coherent sheaves on @xmath120 , @xmath194 here @xmath195 is the left adjoint to @xmath196 ; it exists by grothendieck duality and the invertibility of @xmath197 .",
    "we denote the complex @xmath198 on the left by @xmath199 .",
    "[ prop : obs - thy ] the morphism @xmath200 is a perfect relative obstruction theory of perfect amplitude in @xmath201 $ ] .    to prove this , we can work locally on the base @xmath143 .",
    "since @xmath120 is of deligne  mumford type over @xmath143 , this reduces the problem to the case of a deligne ",
    "mumford stack over a base scheme .",
    "the rest of the proof is then very similar to ( * ? ? ?",
    "* theorem 4.5 and proposition 6.3 ) .",
    "we give details in section  [ sect : obs - thy - constr ] .",
    "now we place ourselves in the situation of diagram  .",
    "the natural map @xmath202 is formally tale , so the obstruction theory for @xmath120 relative to @xmath143 is also an obstruction theory relative to @xmath203 .",
    "we set @xmath204 to emphasize that we are working relative to @xmath205 .",
    "this restricts to a perfect obstruction theory on any open substack @xmath206 of @xmath120 , and we write @xmath207 for such a restriction ; below we use this for @xmath208 .",
    "[ prop : compatibility ] let @xmath209 be the canonical morphism .",
    "there is a commutative diagram @xmath210^{\\sim } g^\\ast { \\mathbb{e}}_{{{\\overline{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } \\ar[d ] & { \\mathbb{e}}_{{{\\overline{m}}}(x / t)^\\ast / { { \\mathfrak{m}}}(y / y'_t / t ) } \\ar[d ] \\\\        \\ar[r ] g^\\ast { \\mathbb{l}}_{{{\\overline{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } & { \\mathbb{l}}_{{{\\overline{m}}}(x / t)^\\ast / { { \\mathfrak{m}}}(y / y'_t / t ) }       } \\ ] ] in which the upper horizontal arrow is an isomorphism and the lower horizontal arrow is the canonical morphism of cotangent complexes .",
    "the commutativity of the diagram is not difficult to check , but it is tedious to carry out in complete detail .",
    "we refer readers with the patience for these details to appendix  [ sect : obs - thy - compat ] .    to complete the proof , we must check that the map in the upper horizontal arrow of diagram   is a quasi - isomorphism .",
    "let @xmath109 be the universal curve over @xmath126 , let @xmath211 be the universal curve over @xmath212 , and let @xmath213 be the pullback of @xmath211 to @xmath159 , so that the diagram @xmath214^\\rho \\ar@/_10pt/[rdd]_{\\pi } \\ar[dr]^\\epsilon \\\\ & { { \\overline{c}}}\\ar[r]^<>(0.3){{{\\overline{\\rho } } } } \\ar[d]^{{{\\overline{\\pi } } } } & c ' \\ar[d]^{\\pi ' } \\\\ & { { \\overline{m}}}_{g , n}(x / t)^\\ast \\ar[r]^g & { { \\overline{m}}}_{g , n}(x'/t ' ) } \\ ] ] commutes and has a cartesian square .",
    "let @xmath215 and @xmath216 be the universal maps .",
    "note the following .    1 .",
    "the map @xmath217 is an isomorphism since @xmath131 is smooth and @xmath218 y$ ] .",
    "we have @xmath219 since @xmath220 by lemma  [ lem : pf - qis ] .",
    "dualization commutes with pullback for perfect complexes .",
    "we have @xmath221      in section  [ sec : maps - to - fibers - cart - diag ] we defined @xmath222 be the substack of points @xmath223 such that @xmath224 is unramified over @xmath149 .",
    "this is the maximal substack of @xmath156 with unramified inertia relative to @xmath160 .",
    "[ prop : fprod ]    1 .",
    "suppose that we have a commutative diagram of algebraic stacks   with @xmath218 y$ ] .",
    "the natural map @xmath225 { { \\mathfrak{m}}}(x'/t ' ) \\end{gathered}\\ ] ] is an isomorphism .",
    "2 .   let @xmath130 and @xmath226 be algebraic stacks over @xmath128 and write @xmath227 t$ ] and @xmath228 t$ ] .",
    "the natural map @xmath229 { { \\mathfrak{m}}}(x'/t')\\end{gathered}\\ ] ] is an isomorphism of stacks .    1 .   set @xmath230 and @xmath153 . by definition ,",
    "an @xmath149-point of @xmath231 { { \\mathfrak{m}}}(x'/t')$ ] is a diagram @xmath232 \\ar[rr ] & & y \\ar[d ] \\\\ { { \\overline{c}}}\\ar[r ] \\ar[d ] & x ' \\ar[r ] \\ar[d ] & y ' \\ar[d ] \\\\",
    "s \\ar[r ] & t \\ar[r ] & t ' } \\ ] ] which clearly induces a unique map @xmath233 y$ ] .",
    "if @xmath61 is a point of @xmath156 , then by ( a ) there is a cartesian diagram @xmath234 \\ar[d ] & \\underline{\\aut}_{{{\\mathfrak{m}}}(x'/t')}(s ) \\ar[d ] \\\\",
    "\\underline{\\aut}_{{{\\mathfrak{m}}}(y / y'_t / t)}(s ) \\ar[r ] & \\underline{\\aut}_{{{\\mathfrak{m}}}(y'/t')}(s ) . } \\ ] ] the induced map between the kernels of the two horizontal arrows is an isomorphism ; one is unramified if and only if the other is .    for the rest of this section",
    ", we work in the setting of proposition  [ prop : fprod ]  ( b ) , assuming in addition that @xmath130 is of deligne  mumford type and @xmath235 is representable .    in section  [ sec :",
    "maps - to - fibers ] , we defined @xmath236 be the locus of maps @xmath237 in @xmath120 such that the composed map @xmath238 admits a stabilization .",
    "more precisely , @xmath239 is the locus of maps @xmath237 where either the homology class of the image of @xmath109 in @xmath130 is non - zero or @xmath240 ( with @xmath23 denotes the genus of @xmath109 and @xmath24 its number of marked points ) .",
    "since the homology class of @xmath109 in @xmath130 and the function @xmath241 are both locally constant , @xmath239 is open and closed in @xmath120 .",
    "let @xmath242 be the map which sends a map @xmath243 over @xmath149 to the stabilization @xmath213 of the composed map @xmath238 .",
    "since there is a projection @xmath151 whose stabilization is an isomorphism , this also induces a section @xmath244 of @xmath175 .",
    "[ prop : fprod2 ] suppose @xmath130 is a deligne  mumford stack .",
    "then the map @xmath245 { { \\overline{m}}}(x'/t')\\ ] ] is an isomorphism with inverse given by @xmath246 and it induces an isomorphism @xmath247 { { \\overline{m}}}(x'/t')\\ ] ]    since @xmath248 is a section of @xmath175 , it is clear that @xmath246 is left inverse to @xmath249 . in particular",
    ", @xmath249 is an isomorphism of @xmath239 onto a substack of @xmath250 { { \\overline{m}}}(x'/t')$ ] .",
    "note that this implies that , for any @xmath251 , we have @xmath252 is an isomorphism of group schemes over @xmath149 .    to see that @xmath246 is also right inverse to @xmath249 , we must show that , for any @xmath149-point   of @xmath156 whose image in @xmath160 is contained in @xmath212 , the stabilization of @xmath238 is @xmath213 .",
    "let @xmath211 denote the stabilization . since the stabilization is initial among all factorizations of @xmath238 through stable maps , there is a map @xmath253 . on the other hand , @xmath253 is also stable ( its automorphism group being contained in that of @xmath211 over @xmath130 ) and @xmath213 is the stabilization of @xmath151 , so we obtain a section @xmath254 , which must be an isomorphism by the universal property .",
    "this proves the first claim .",
    "to finish the proof , we must show that @xmath251 is in @xmath159 if and only if @xmath255 is in @xmath256 . for @xmath61 to lie in @xmath159",
    "means that @xmath257 is unramified over @xmath149 ; for @xmath255 to lie in @xmath256 means that the group @xmath258 in the exact sequence @xmath259 is unramified over @xmath149 .",
    "since @xmath61 is in @xmath239 , the group @xmath260 is unramified .",
    "thus , @xmath258 is unramified if and only if @xmath261 is .",
    "but we saw above that @xmath261 is isomorphic to @xmath257 .",
    "thus @xmath61 is in @xmath159 if and only if it is in @xmath256 .",
    "combining propositions  [ prop : fprod ] and  [ prop : fprod2 ] now yields proposition  [ prop : cart - diag ] .        the moduli space of targets @xmath262 is defined in  ( * ? ?",
    "* definition  4.4 ) ( denoted there by @xmath263 and called the stack of expanded relative pairs ) ; the notation @xmath114 , as well as the name , come from  @xcite .",
    "we summarize some properties of @xmath114 that are proved in  @xcite .",
    "the stack @xmath114 admits an tale cover by maps @xmath264 , @xmath265 such that , for any monotonic injection @xmath266 \\rightarrow [ m]$ ] , there is a @xmath267-isomorphism making the diagram @xmath268 \\ar[dr ] & & { \\mathscr{a}}^m \\ar[dl ] \\\\ & { \\mathscr{t}}}\\ ] ] commute , and these @xmath267-isomorphisms are compatible in the obvious sense .",
    "it is also proved in  @xcite that @xmath114 is the colimit of the @xmath269 , but we will not use this fact here .    there is a universal expansion @xmath270 of @xmath104 over @xmath114 . setting @xmath271 = { \\mathscr{a}}^{\\mathrm{rel}}\\fp[{\\mathscr{t } } ] { \\mathscr{a}}^n$ ] , it is shown in  @xcite that @xmath271 $ ] may be identified with an open substack of  @xmath272 .",
    "recall that a morphism @xmath274 is equivalent to a line bundle with section on @xmath109",
    ". therefore an object of @xmath275 is equivalent to a triple @xmath276 , where @xmath109 is an @xmath24-marked genus @xmath1 curve over @xmath149 , with a line bundle @xmath110 on @xmath109 , and a section @xmath61 of @xmath110 .",
    "define the open substack @xmath277 as follows .",
    "an object @xmath108 of @xmath275 over a scheme @xmath149 is an object of @xmath278 if for every geometric point @xmath279 ,    * @xmath280 , where @xmath281 denotes the age at the @xmath25-th marked point , and * for any proper subcurve @xmath282 , we have @xmath283 .    if the geometric fiber @xmath284 is smooth , with coarse moduli space @xmath213 , these imply that the push forward of @xmath110 to @xmath213 is @xmath285 . in particular , @xmath286 in this case .",
    "these conditions are crucial for the key technical argument in section  [ sect : dense - in - ma ] .",
    "we construct @xmath117 through a series of definitions as follows .",
    "let @xmath179 \\ar[d ] & { \\mathscr{a}}^{\\mathrm{rel}}\\ar[d ] \\\\",
    "s \\ar[r ] & { \\mathscr{t}}}\\ ] ] describe an @xmath149-point of @xmath287 .",
    "the distinguished divisor of @xmath288 pulls back to a closed substack @xmath182 on @xmath109 .",
    "we say that a diagram as above is in @xmath289 if the map @xmath290 is smooth near the pre - image of the nodes and near @xmath182 .",
    "the point is that when @xmath290 lifts to an expanded pair @xmath291 with @xmath6 a scheme , then the map is an object of @xmath289 if an only if @xmath291 is transversal to the nodes and boundary divisor of @xmath292 .",
    "this definition makes @xmath289 an open substack of @xmath287 .",
    "we denote its pre - image in @xmath293 by @xmath294 .",
    "we define @xmath295 to be the intersection of @xmath296 and @xmath297 .",
    "we prove here that the stacks considered above are algebraic .",
    "we repeatedly use    suppose @xmath298 is a stack with a morphism to an algebraic stack @xmath299 .",
    "assume there is a smooth cover @xmath300 by an algebraic stack @xmath301 such that @xmath302 { \\mathscr{x}}$ ] is an algebraic stack .",
    "then @xmath298 is algebraic .",
    "[ prop : alg - stacks ]    1 .",
    "[ prop : ma - alg ] the stacks @xmath303 , @xmath113 , as well as the stack @xmath112 defined in section  [ sect : constr - of - ma ] , are algebraic .",
    "[ prop : marel - alg ] the stack @xmath304 is algebraic .",
    "[ prop : marelrel - alg ] the stack @xmath305 is algebraic .",
    "[ prop : manrel - alg ] the stacks @xmath306 , as well as @xmath117 defined in section  [ sect : constr - of - marel ] , are algebraic .",
    "[ cor : mxrel - dm ] let @xmath298 be a deligne  mumford stack of finite type over @xmath0 .",
    "then the stacks @xmath307 and @xmath308 are algebraic .",
    "thus @xmath308 is a deligne ",
    "mumford stack .",
    "( [ prop : ma - alg ] ) to prove the algebraicity of @xmath303 , it is sufficient to work locally in the moduli stack of deligne  mumford pre - stable curves @xmath309 .",
    "it is therefore sufficient to show that for any scheme @xmath149 and family of orbifold pre - stable curves @xmath109 over @xmath149 , the @xmath149-stack @xmath310 is algebraic .",
    "this follows from  @xcite and @xcite .",
    "now we may prove that @xmath113 is algebraic by working locally in @xmath311 .",
    "we must show that for any scheme @xmath149 , any family of orbifold pre - stable curves @xmath109 over @xmath149 , and any line bundle @xmath110 over @xmath109 , the @xmath149-sheaf of sections of @xmath110 is representable .",
    "this is just @xmath312 s$ ] where the map @xmath313 is the one associated to the identity map on @xmath109 .",
    "this is representable by  ( * ? ? ?",
    "* theorem  1.1 ) , since both @xmath109 and @xmath110 are deligne ",
    "mumford stacks over @xmath149 .",
    "finally , @xmath112 is open in @xmath113 , which completes the proof of ( [ prop : ma - alg ] ) .",
    "( [ prop : marel - alg ] ) it is sufficient to prove this locally in @xmath114 .",
    "the collection of @xmath264 defined in section  [ sect : exp - pairs ] forms an tale cover , so it is sufficient to prove that @xmath314 { \\mathscr{a}}^n$ ] is algebraic for each @xmath24 .",
    "we have @xmath315 / { \\mathscr{a}}^n & \\cong { { \\mathfrak{m}}}({{\\mathscr{a}}^{\\mathrm{rel}}}\\fp[{\\mathscr{t } } ] { \\mathscr{a}}^n / { \\mathscr{a}}^n ) \\\\ & \\cong { { \\mathfrak{m}}}({\\mathscr{a}}[n ] / { \\mathscr{a}}^n ) \\cong { { \\mathfrak{m}}}({\\mathscr{a}}[n ] ) \\fp[{{\\mathfrak{m}}}({\\mathscr{a}}^n ) ] { \\mathscr{a}}^n , \\end{split}\\ ] ] and @xmath316 is algebraic by  ( [ prop : ma - alg ] ) . since @xmath269 is also algebraic , it suffices to see that @xmath317)$ ] is algebraic .",
    "but @xmath271 $ ] is an open substack of @xmath272 so @xmath317)$ ] is an open substack of the algebraic stack @xmath318 , hence is algebrac .",
    "( [ prop : marelrel - alg ] ) we have a natural morphism @xmath319 .",
    "we have shown above that the stack @xmath320 is algebraic , and the stack @xmath321 is algebraic by ( [ prop : ma - alg ] ) .",
    "it remains to show that @xmath322 is algebraic whenever @xmath149 is a scheme .",
    "denote by @xmath323 and @xmath324 the resulting families of curves as in diagram  .",
    "the stack @xmath325 maps to the algebraic stack @xmath326 of representable maps .",
    "the locus where these maps have 0-dimensional image is closed , and in the open ( and therefore algebraic ) complement the stabilization @xmath327 of @xmath328 is well defined .",
    "the stack @xmath325 above factors through the the open ( and therefore algebraic ) locus where @xmath329 is an isomorphism .",
    "the stack @xmath325 itself is therefore the algebraic substack of sections @xmath330 where @xmath331 , where the map on the right is the diagonal and the maps on the left are @xmath332 and @xmath333 .",
    "( [ prop : manrel - alg ] ) the stack @xmath334 is an open substack of @xmath335 , which is algebraic by  ( [ prop : marel - alg ] ) above .",
    "the stack @xmath336 is an open substack of @xmath305 , which is algebraic by  ( [ prop : marelrel - alg ] ) above .",
    "( [ cor : mxrel - dm ] ) since @xmath337 { \\mathscr{a}}^{\\mathrm{rel}}$ ] and the map @xmath338 is induced from @xmath339 , we have an isomorphism @xmath340 { { \\mathfrak{m}}}({\\mathscr{a}}^{\\mathrm{rel}}/ { \\mathscr{t } } ) .\\ ] ] but @xmath341 is an algebraic stack by  ( * ? ? ?",
    "* theorem 1.4.1 and section 8) and both @xmath113 and @xmath287 are algebraic by  ( [ prop : ma - alg ] ) and  ( [ prop : marel - alg ] ) , respectively .    by definition",
    ", @xmath308 is an open substack of the maximal deligne ",
    "mumford substack of the algebraic stack @xmath307 .",
    "in section  [ sect : main - arg ] we reduce the proof of theorem  [ prop2 ] to an application of costello s theorem .",
    "the rest of section  [ sec : main_prop ] will be devoted to the verification of costello s hypotheses .",
    "let @xmath6 be a smooth scheme over @xmath0 with a smooth divisor @xmath18 .",
    "let @xmath298 be the @xmath5-th root stack of the line bundle and section @xmath342 ( the value of @xmath5 will be specified in definition  [ def : twisting - choice ] ) .",
    "let @xmath343 be the @xmath5-th root divisor on @xmath298 .",
    "[ prop : x - to - a - smooth ] let @xmath6 be smooth and @xmath18 a cartier divisor , and let @xmath344 be the corresponding morphism .",
    "then @xmath248 is smooth if and only if @xmath18 is smooth .",
    "if @xmath248 is smooth then @xmath18 is smooth as it is the inverse image of the smooth divisor @xmath345 .",
    "now we assume @xmath18 smooth and prove that @xmath346 is smooth .",
    "the problem is tale local on @xmath6 so we may assume @xmath18 is defined by a local coordinate  @xmath347 . completing this to a regular system of parameters @xmath348 with @xmath349 , we obtain a factorization of @xmath248 through the tale map @xmath350 .",
    "the map @xmath351 factors through the smooth projection @xmath352 on the first coordinate , and @xmath353 is smooth by definition .",
    "the proposition implies that the map @xmath354 ( determined by the line bundle and section @xmath342 ) is smooth .",
    "since @xmath355 is obtained from this by base change along the @xmath5-th power map , it is smooth as well",
    ". this implies , again by the proposition , that @xmath343 is smooth .",
    "therefore , by proposition  [ prop : obs - thy ] , the morphism @xmath356 has a perfect relative obstruction theory of perfect amplitude in @xmath357 $ ] .",
    "we denote the relative virtual class by @xmath358^{\\mathrm{vir}}$ ] .",
    "now we select the integer  @xmath5 determining the root stack @xmath298 .",
    "note that , as in the proof of theorem  [ prop1 ] , this choice in turn determines a twisting choice @xmath91 in the sense of ( * ? ? ?",
    "* definition  3.4.1 ) for relative stable maps to @xmath6 of class @xmath27 , namely @xmath359 for every multiset @xmath360 of contact orders occuring in the moduli space .",
    "[ def : twisting - choice ] let @xmath27 be an effective class in @xmath361 and let @xmath362 .",
    "set @xmath363 , the minimum taken over all classes @xmath364 such that both @xmath364 and @xmath365 are effective .",
    "let @xmath5 be an integer such that    1 .",
    "@xmath366 , 2 .",
    "@xmath367 , and 3 .",
    "if @xmath368 is an integer such that @xmath369 then @xmath368 divides @xmath5 .",
    "the integer @xmath5 is chosen carefully for proposition  [ prop : density ] to apply .",
    "since the conditions on @xmath5 only bound it from below and impose divisibility , it is clear that an integer @xmath5 satisfying the conditions exists .",
    "let @xmath370 stand for the numerical data @xmath371 .",
    "the assumptions on @xmath5 made above guarantee that the universal curve over @xmath372 satisfies properties  ma1 and  ma2 of section  [ sect : constr - of - ma ] , hence that the map @xmath373 factors through @xmath374 .",
    "we therefore have a commutative diagram    @xmath375^<>(0.5){\\phi_{{\\mathscr{x } } } } \\ar[d ] & { { \\overline{m}}}_\\gamma({\\mathscr{x } } ) \\ar[d ] \\\\      { { \\mathfrak{m}}}^{\\mathrm{rel}}_{0,n}({\\mathscr{a } } , { { { \\mathcal{b}}{\\mathbb{g}}_m } } ) '          \\ar[r]^<>(0.5){\\phi_{{\\mathscr{a } } } } & { { \\mathfrak{m}}}_{0,n}({\\mathscr{a } } ) ' ,    } \\ ] ]    which is cartesian by proposition  [ prop : cart - diag ] .",
    "this is diagram  [ eq : costello ] with a more specific notation that includes the relevant discrete data",
    ". we will apply  ( * ? ? ?",
    "* theorem  5.0.1 ) to this diagram .",
    "the hypotheses of the theorem are the following ( with numbers corresponding to the bullets in costello s statement ) :    1 .   @xmath376 is a deligne ",
    "mumford stack by proposition  [ prop : alg - stacks ] .",
    "2 .   @xmath372 is a deligne ",
    "mumford stack by  ( * ? ? ?",
    "* theorem  1.4.1 ) .",
    "3 .   @xmath377 and @xmath275 are artin stacks of the same pure dimension .",
    "the morphism @xmath378 is representable , so by ( * ? ? ?",
    "* section 8.3 ) the morphism @xmath379 is of relative deligne ",
    "mumford type .",
    "it is of pure degree @xmath57 by proposition  [ prop : pure - dim ] ) .",
    "@xmath380 is proper ( checked below using  ( * ? ? ?",
    "* corollary  3.4.8 ) ) .",
    "the obstruction theory for @xmath381 on the left is equivalent to the one obtained by pulling back that of the morphism @xmath382 on the right ( proposition  [ prop : compatibility ] ) .",
    "hypothesis ( 2,3 ) is implied by    [ prop : pure - dim ] there are dense , unobstructed , open substacks @xmath383 on which @xmath384 induces an isomorphism .    for @xmath385",
    "we take the fiber of @xmath386 above the open point of @xmath114 .",
    "since @xmath288 and @xmath387 are isomorphic over the open point of @xmath114 , diagram   simplifies to @xmath388 \\ar[d ] & { \\mathscr{a}}\\ar[d ] \\\\        { { \\overline{c}}}\\ar[r ] \\ar[d ] & { \\mathscr{a}}\\\\        s .      } \\ ] ] since this point lies in @xmath389 , it can have no continuous automorphisms fixing the map @xmath390 .",
    "this means that @xmath151 is stable , hence an isomorphism , since @xmath213 is the stabilization of the map @xmath151 .",
    "thus the top line in the diagram above is determined from the rest of the diagram .",
    "this implies that @xmath391 , which forgets the top line above , is an embedding on @xmath392 .    by the definition of @xmath393 ,",
    "a map @xmath394 lies in the image of @xmath391 if and only if it is transverse to the divisor @xmath345 , i.e. , if and only if the map @xmath394 is smooth near the pre - image of @xmath116",
    ". this is an open condition on @xmath273 , hence defines an open substack @xmath395 onto which @xmath391 defines an isomorphism .    to complete the proof",
    ", we check in section  [ sect : rms - smooth ] that @xmath392 is dense in @xmath393 and in section  [ sect : dense - in - ma ] that @xmath395 is dense in @xmath273 .    in order to check hypothesis  ( 4 )",
    ", we relate our notation to that of  @xcite .",
    "our stack @xmath376 is isomorphic to a union of open and closed substacks @xmath396 of  @xcite where @xmath397 is equal to our twisting choice ( definition  [ def : twisting - choice ] ) and the union is taken as @xmath398 ranges among all `` data for a pair '' ( ( * ? ? ?",
    "* convention  3.1.2 ) ) compatible with @xmath370 ( effectively , over all partitions of @xmath399 into two sets , denoted @xmath400 and @xmath401 in loc.cit . ) . by  ( * ? ? ?",
    "* corollary  3.4.8 ) , each @xmath402 is proper ; since @xmath403 is separated ( ( * ? ? ?",
    "* theorem  1.4.1 ) ) this implies @xmath380 is proper , which is hypothesis  ( 4 ) .",
    "we deduce from costello s theorem that @xmath404^{\\mathrm{vir}}= [ { { \\overline{m}}}_{\\gamma}({\\mathscr{x } } ) / { { \\mathfrak{m}}}_{0,n}({\\mathscr{a } } ) ] ^{\\mathrm{vir}}.\\ ] ] where here and later we omit the subscript @xmath298 of @xmath405 when no confusion is likely .",
    "in section  [ sect : rms - smooth ] , we show that @xmath406 is smooth , which implies by a standard compatibility result reviewed in proposition  [ prop : compat - seq ] that @xmath407^{\\mathrm{vir}}= \\big [ { { \\overline{m}}}^{{\\mathrm{tr}}}_{\\gamma}({\\mathscr{x}}^{\\mathrm{rel}}/ { \\mathscr{t } } ) \\big]^{\\mathrm{vir}}.\\ ] ] noting that @xmath408 is smooth , we apply a similar compatibility result reviewed in proposition  [ prop : mod - compat - seq ] to the sequence @xmath409 to conclude @xmath410^{\\mathrm{vir}}= \\big [ { { \\overline{m}}}_{\\gamma}({\\mathscr{x } } ) \\big/ { { \\mathfrak{m}}}_{0,n}({{{\\mathcal{b}}{\\mathbb{g}}_m } } ) \\big]^{\\mathrm{vir}}.\\ ] ]    [ m(bg_m)_is_smooth ] the stack @xmath411 is smooth and unobstructed .",
    "the obstructions to deforming a line bundle on @xmath109 lie in @xmath412 , which vanishes if @xmath109 is a curve .",
    "hence @xmath411 is smooth over @xmath138 , which is itself smooth .",
    "lemma  [ m(bg_m)_is_smooth ] permits us again to apply proposition  [ prop : compat - seq ] to the sequence @xmath413 and find @xmath414^{\\mathrm{vir}}= \\big [ { { \\overline{m}}}_{\\gamma}({\\mathscr{x } } ) \\big]^{\\mathrm{vir}}.\\ ] ]    taken together , the equalities above imply @xmath415^{\\mathrm{vir}}= \\big [ { { \\overline{m}}}_{\\gamma}({\\mathscr{x } } ) \\big]^{\\mathrm{vir}},\\ ] ] which is the conclusion of theorem  [ prop2 ] .",
    "our remaining task is to complete the proof of proposition  [ prop : pure - dim ] .",
    "we abbreviate @xmath416 to @xmath138 .",
    "let @xmath417 be the universal morphism and write @xmath418 where @xmath18 is the universal divisor on @xmath288 and @xmath182 is the divisor of marked points on @xmath419 .",
    "if @xmath420 is the projection , then there is a natural map @xmath421 \\rightarrow { \\mathbb{l}}_{{{\\mathfrak{m}}}/ { \\mathscr{t } } }   .\\ ] ]    [ lem : another - obs - thy ] this is a relative obstruction theory for @xmath422 .",
    "this is a standard generalization of ( * ? ?",
    "* proposition 6.3 ) in combination with ( * ? ? ?",
    "* proposition a.1 ) .",
    "see appendix  [ app : another - obs - thy - proof ] for more details .",
    "[ prop : marel - smooth ] the morphism @xmath423 is smooth and unobstructed .",
    "let @xmath424 $ ] .",
    "we must show that @xmath425 has perfect amplitude in @xmath426 $ ] .",
    "since @xmath425 is certainly perfect , it suffices to see that @xmath427 = r \\pi_\\ast \\big ( { \\mathbb{l}}^\\vee \\big)$ ] has perfect amplitude in @xmath426 $ ] . by semicontinuity , it is enough to see that , when @xmath149 is a geometric point of @xmath138 and @xmath428 s$ ] is the corresponding morphism , we have @xmath429 for @xmath430 ( where @xmath431 denotes the pullback of @xmath432 to @xmath109 via the canonical map @xmath433 ) .",
    "we use the local - to - global spectral sequence , which gives @xmath434",
    "the proposition will follow once we show    1 .",
    "@xmath435 is supported in dimension @xmath1 ( which implies that @xmath436 for @xmath437 ) , and 2 .",
    "@xmath438 for @xmath439 .    indeed ,",
    "these properties show that the @xmath440 term of the spectral sequence is concentrated in positions @xmath441 which implies both that it degenerates at the @xmath440 term and that @xmath442 for @xmath430 .",
    "let @xmath443 be the complement of @xmath18 in the smooth locus of the map @xmath444 .",
    "since @xmath206 is tale over @xmath114 we have @xmath445 and hence @xmath446 it is well - known tht @xmath447 for @xmath439 and is supported on the nodes for @xmath448 .",
    "the map @xmath290 is transverse to the singularities and to the distinguished divisor @xmath18 .",
    "therefore , if @xmath449 is either a node or the distinguished divisor of @xmath288 then there is an open neighborhood @xmath450 of @xmath449 such that @xmath451 s$ ] is smooth .",
    "therefore @xmath452 is a vector bundle , and @xmath453 for @xmath454 .",
    "since @xmath455 and the @xmath456 cover @xmath109 , this completes the proof .",
    "let @xmath457 be the pre - image of the open point in @xmath114 and let @xmath458 be its intersection with @xmath459 .",
    "the open inclusions @xmath460 are dense .    the claim for @xmath386 follows immediately from that for @xmath461 .",
    "let @xmath462 be a point of @xmath463 that is not in @xmath464 .",
    "choose a scheme @xmath133 , the spectrum of a complete noetherian local ring , and a map @xmath465 whose restriction to the closed point is the image of @xmath462 and whose open point maps to the open point of @xmath114 . by the proposition , there is a formal section of @xmath466 over @xmath133 , coinciding with @xmath462 on the closed point .",
    "it suffices to show this section can be algebraized .",
    "since @xmath271 $ ] is open in @xmath272 , this is a question of algebraizing vector bundles and their sections .",
    "it therefore has an answer by grothendieck s existence theorem .",
    "[ lem : def - of - sect ] let @xmath276 be a geometric point of @xmath374 .",
    "assume @xmath109 is smooth .",
    "let @xmath211 be a square - zero thickening of @xmath109 with ideal @xmath467 .",
    "let @xmath468 be an extension of @xmath110 to @xmath211 .",
    "then @xmath61 can be extended to a nonzero section of @xmath468 on @xmath211 .",
    "the obstruction for this deformation problem lies in @xmath469 ; when the obstruction vanishes , solutions form a torsor under @xmath470 . to show that a deformation exists it suffices to show that @xmath471 . to show that the section can be deformed to be non - zero",
    ", we must show in addition @xmath472 .",
    "our assumptions in section  [ sect : constr - of - ma ] on @xmath374 imply that @xmath473 writing @xmath474 for the projection on the coarse moduli space , this implies that @xmath475 .",
    "but @xmath476 and @xmath109 has genus zero , so the lemma follows .    [ lem : props - of - ma ] if @xmath276 is a point of @xmath374 then    1 .   if @xmath449 is a node whose stabilizer group is non - trivial , then @xmath61 vanishes on at least one of the components containing @xmath449 , and 2 .",
    "if @xmath449 is a node whose stabilizer group is trivial and @xmath477 , then @xmath61 vanishes identically on both components containing @xmath449 .",
    "let @xmath276 be a point of @xmath374 .",
    "suppose that @xmath478 and @xmath479 are two irreducible components of @xmath109 meeting at an orbifold node @xmath449 .",
    "since @xmath480 , one of these , say the first , must be at least @xmath481 .",
    "but then if @xmath61 does not vanish on @xmath478 , we have @xmath482 , contradicting condition  ma2 ( section  [ sect : constr - of - ma ] ) .",
    "now let the notation be as above , but assume that @xmath449 is a node with trivial stabilizer . if @xmath61 vanishes at @xmath449 but does not vanish identically on @xmath483 then @xmath484 , once again contradicting condition  ma2 .",
    "thus if @xmath61 is an ordinary node , @xmath61 can not vanish at @xmath449 unless it vanishes identically on both components containing @xmath449 .",
    "[ def : fma  ] let @xmath485 be the open substack consisting of triples @xmath108 such that @xmath109 is smooth and @xmath61 is not identically @xmath1 .",
    "[ prop : density ] the substack @xmath486 is dense .",
    "step 1 : smoothing the vanishing locus of @xmath61 .",
    "we will write @xmath487 for the open substack consisting of those @xmath276 in @xmath374 for which the vanishing locus of @xmath61 inside @xmath109 is smooth ( i.e. , is a disjoint union of reduced stacky points and smooth curves ) .",
    "equivalently , @xmath488 is the locus where @xmath61 does not vanish on two adjacent irreducible components of @xmath109 . by lemma  [ m(bg_m)_is_smooth ] , a node joining two components of @xmath109 on which @xmath61 vanishes can be smoothed along with the line bundle .",
    "the section extends as the zero section on the resulting smoothed component .",
    "it follows that @xmath489 is dense in @xmath374 .",
    "thus , to prove proposition  [ prop : density ] it remains only to prove that @xmath490 is dense in @xmath489 .",
    "step 2 : smoothing the orbifold nodes : setup .",
    "define the open substack @xmath491 to be the locus where @xmath109 has trivial stack structure at all of its nodes . in steps 27",
    ", we will show that @xmath492 is dense in @xmath487 . on an object @xmath108 of @xmath489 having an orbifold node",
    ", the section @xmath61 vanishes identically on a component @xmath493 of @xmath109 through the node .",
    "let @xmath494 be the locus where @xmath61 does not vanish and let @xmath495 be the connected components of the closure of @xmath211 that meet @xmath493 .",
    "let @xmath496 be the intersection of @xmath493 with @xmath483 .",
    "we claim that the nodes @xmath496 can be smoothed simultaneously .",
    "step 3 : isolating the relevant curve . to obtain this smoothing",
    ", it suffices to assume that @xmath109 is the union of @xmath497 : any node connecting @xmath483 to another component of @xmath498 must be twisted , so if we can deform the section on this subcurve , the deformed section will automatically vanishes on such nodes .",
    "it follows that the deformation can be glued to a trivial deformation of the rest of the curve .",
    "step 4 : removing markings way from @xmath493 .",
    "we further simplify the object : if there is a twisted marking @xmath499 , then let @xmath500 be the morphism which forgets this twisted marking",
    ". we can recover @xmath110 from @xmath501 by the formula @xmath502 this can be done in families , so it is equivalent to deform either @xmath276 or @xmath503 ( where the marked point remains on @xmath211 , but is untwisted ) .",
    "so we may assume that all twisted markings of @xmath109 lie on @xmath493 , though we may no longer assume that @xmath504 for each @xmath505 .",
    "step 5 : reduction to positive degree on @xmath493 .",
    "choose a general point @xmath506 , and replace @xmath493 with the square root of @xmath493 at @xmath449 , replacing @xmath110 with @xmath507 , and @xmath61 with its image in @xmath507 .",
    "by the same argument as before , it suffices to deform this new triple .",
    "therefore , we can assume that the degree of @xmath110 restricted to @xmath493 is positive , and that the total degree of @xmath110 is less than @xmath57 .",
    "let @xmath508 be the number of twisted marked points on @xmath493 and define @xmath509 to be the ages of @xmath110 at these points .",
    "for @xmath510 , let @xmath511 be the age of @xmath512 at the node .",
    "since @xmath513 and @xmath512 has a nontrivial section , it follows that @xmath514 . since @xmath515",
    ", it follows that @xmath516 .",
    "step 6 : lifting to a weighted projective space .",
    "although it is not essential to the argument , we now reduce the problem to one concerning maps to a weighted projective space",
    ". this will be convenient in step  7 where it allows us to do our dimension estimates with deligne  mumford stacks instead of artin stacks .    choose a positive integer @xmath517 such that @xmath518 and @xmath519 for all @xmath25 .",
    "then @xmath520 is pulled back from the coarse moduli space of @xmath109 and has non - negative degree on each component .",
    "the complete linear system of @xmath520 together with the section @xmath61 define a representable morphism @xmath521 of degree @xmath522 , where @xmath523 is a hyperplane , and @xmath524{{\\mathbf{p}}^n , h}$ ] is the @xmath517-th root stack .    the moduli space of twisted stable maps to @xmath525 of genus @xmath1 , degree @xmath522 , having @xmath24 marked points , @xmath508 of which are twisted with contact types @xmath526 , has expected dimension @xmath527 ; see @xcite .",
    "step 7 : dimension estimate .",
    "now suppose the map @xmath521 could not be deformed to a map where @xmath109 has fewer nodes .",
    "we calculate the dimension of the component of the space of stable maps in which it lies as follows :    1 .   for each @xmath528 , deformations of @xmath529 marked by @xmath496",
    "are unobstructed and therefore have dimension precisely @xmath530 .",
    "deformations of @xmath531 inside @xmath532 marked by @xmath533 and the @xmath508 twisted marked points are identical to deformations of @xmath534 with as maky marked points , and have precisely dimension @xmath535 .",
    "we have @xmath536 additional untwisted marked points , contributing as many dimensions to moduli .",
    "4 .   the conditions for these maps to glue are independent by kleiman s bertini argument ( * ? ? ?",
    "* theorem 2 ) .",
    "we have @xmath537 independent conditions for each @xmath496 .",
    "we compute :    @xmath538    since the dimension is greater than or equal to the expected dimension , it follows that the map @xmath539 can be smoothed .",
    "we then get the required deformation of @xmath108 by pulling back @xmath540 together with its tautological section .",
    "it now remains to prove that @xmath490 is dense in @xmath541 .",
    "step 8 : smoothing non - orbifold nodes .",
    "now , we show that @xmath542 , the open substack of @xmath374 consisting of @xmath276 with @xmath109 smooth , is dense in @xmath541 . by lemma  [ m(bg_m)_is_smooth ] , there is no obstruction to deforming @xmath110 as @xmath109 is smoothed , and the obstruction to deforming @xmath61 as @xmath109 and @xmath110 are deformed lies in @xmath469 .",
    "but since @xmath276 is in @xmath541 the vanishing locus of @xmath61 must be discrete by lemma  [ lem : props - of - ma ] .",
    "therefore @xmath110 must have non - negative degree on every component of @xmath109 , whence @xmath543 .",
    "the obstruction to carrying @xmath61 along with the deformation of @xmath544 therefore vanishes and @xmath276 can be deformed into @xmath545 .",
    "step 9 : deforming to a nonzero section .",
    "lemma  [ lem : def - of - sect ] implies that @xmath490 is dense in @xmath546 , which completes the proof .",
    "[ lem : truncation ] suppose @xmath547 is an exact triangle in @xmath548 for some abelian category @xmath549 .",
    "the following are equivalent .    1 .",
    "the map @xmath550 is an isomorphism for @xmath551 and surjective for @xmath552 , 2 .",
    "@xmath553 is concentrated in degrees @xmath554 , 3 .   for every @xmath555 ,",
    "the map @xmath556 is an isomorphism for @xmath551 and injective for @xmath552 , 4 .",
    "@xmath557 for all @xmath558 and all @xmath555 .",
    "\\(i ) ( ii ) follows immediately by considering the long exact sequence in cohomology @xmath559    likewise , ( iii ) ( iv ) follows from the long exact sequence @xmath560    it is obvious that ( ii ) implies ( iii ) . for the converse ,",
    "it is sufficient , by descending induction , to assume that @xmath561 . in that case",
    ", it follows by taking @xmath562 .",
    "let @xmath563 be a morphism of algebraic stacks .",
    "let @xmath564 .",
    "an _ obstruction theory _",
    "* definition  4.4 ) ) for @xmath58 is a morphism @xmath565 in the derived category of @xmath6 that satisfies the equivalent conditions of lemma  [ lem : truncation ] with @xmath566 .",
    "let @xmath567 be a sequence of morphisms of algebraic stacks .",
    "they are said to possess compatible obstruction ( cf .",
    "* construction  2 ) ) theories if there is a commutative diagram in the derived category of @xmath6 @xmath568 \\ar[d ] & { \\mathbb{e}}_{x / z } \\ar[r ] \\ar[d ] & { \\mathbb{e}}_{x / y } \\ar[d ] \\\\",
    "f^\\ast { \\mathbb{l}}_{y / z } \\ar[r ] & { \\mathbb{l}}_{x / z } \\ar[r ] & { \\mathbb{l}}_{x / y }    } \\ ] ] in which the rows are distinguished triangles , the lower row is the transitivity triangle of the cotangent complex , and the two vertical arrows on the right , as well as the map @xmath569 , are obstruction theories . note that a compatibility of obstruction theories includes the specification of the triangle above , so it is not a property of the obstruction theories by themselves .",
    "if @xmath570 is of deligne  mumford type , then a perfect obstruction theory for @xmath58 determines a gysin pullback morphism ( * ? ? ?",
    "* definition  4 ) @xmath571 this morphism depends on the obstruction theory , of course .",
    "manolache shows ( * ? ? ?",
    "* theorem  4 ) that if @xmath572 is a sequence of morphisms of deligne  mumford type with compatible obstruction theories then @xmath573 .",
    "the following result is closely related to manolache s theorem ( as well as to ( * ? ? ?",
    "* proposition  a.1 ) and ( * ? ? ?",
    "* theorem  1 ) ) .",
    "it may be interpreted as saying that manolache s construction of @xmath574 , which depends a priori on a smooth artin stack @xmath575 and a commutative diagram , @xmath576^p \\ar[dr ] & & y \\ar[dl ] \\\\      & w ,    } \\ ] ] is in fact independent of @xmath575 .",
    "[ prop : compat - seq ] suppose @xmath572 is a sequence of morphisms of artin stacks , @xmath170 and @xmath577 are of deligne  mumford type , and @xmath578 is smooth .",
    "suppose that the morphisms have compatible obstruction theories and the obstruction theory of @xmath578 coincides with the cotangent complex",
    ". then @xmath579 .",
    "the hypothesis that @xmath580 be smooth and its obstruction theory be the canonical one should not really be necessary .",
    "the trouble is that we do nt know how to define @xmath581 except under these hypotheses ( where it is just @xmath582 ) .",
    "we have a commutative diagram on @xmath6 : @xmath583 \\ar[d ] & { { \\mathfrak{c}}}_{x / z } \\ar[d ] \\\\        { \\mathfrak{e}}_{x / y } \\ar[r ] & { \\mathfrak{e}}_{x / z } .      } \\ ] ] it suffices to show that this diagram is cartesian , for @xmath584^{{\\mathrm{vir } } } = 0_{{\\mathfrak{e}}_{x / y}}^ ! [ { { \\mathfrak{c}}}_{x / y } ] $ ] and @xmath585^{{\\mathrm{vir } } } = 0_{{\\mathfrak{e}}_{x / z}}^ ! [ { { \\mathfrak{c}}}_{x / z } ] $ ] . by the compatibility of the obstruction theories with the canonical obstruction theory ,",
    "the fiber of @xmath586 is @xmath587 .",
    "this reduces the problem to showing that the above diagram is cartesian with @xmath588 replaced by @xmath589 and @xmath590 replaced by @xmath591 .",
    "this is now a local problem , so we can assume that there is a commutative diagram @xmath592^i \\ar[d]_p & { \\widetilde{y}}\\ar[r]^j \\ar[d ] & { \\widetilde{z}}\\ar[d ] \\\\",
    "x \\ar[r ] & y \\ar[r ] & z      } \\ ] ] in which the horizontal arrows are closed embeddings and the vertical arrows are smooth . since @xmath580 is smooth , we can assume that @xmath593 is an isomorphism .",
    "we can then identify the pullback of diagram  [ eqn:21 ] to @xmath6 with @xmath594 \\ar[r ] \\ar[d ] & [ c_{{\\widetilde{x}}/ { \\widetilde{z } } } / ( ji)^\\ast t_{{\\widetilde{z}}/ z } ] \\ar[d ] \\\\",
    "[ n_{{\\widetilde{x}}/ { \\widetilde{y } } } / i^\\ast t_{{\\widetilde{y}}/ y } ] \\ar[r ] & [ n_{{\\widetilde{x}}/ { \\widetilde{z } } } / ( ji)^\\ast t_{{\\widetilde{z}}/ z } ] .      } \\ ] ] but since @xmath593 is an isomorphism , it is clear that this diagram is cartesian .",
    "we prove proposition  [ prop : obs - thy ] .",
    "suppose that @xmath189 is morphism of algebraic stacks .",
    "then the morphism @xmath595 constructed in section  [ sec : obs - thy ] is an obstruction theory .",
    "if @xmath189 is smooth then it is of perfect amplitude in @xmath596 $ ] .",
    "if in addition @xmath189 is of deligne  mumford type , it is of perfect amplitude in @xmath201 $ ] .    for brevity , we shorten @xmath597 to @xmath425 and @xmath598 to @xmath432 . by the lemma",
    "above , it s enough to prove that @xmath599 is injective for @xmath600 and bijective for @xmath601 and that @xmath425 is perfect in degrees @xmath596 $ ] if @xmath189 is smooth ( and in @xmath201 $ ] if it is also of deligne  mumford type ) .",
    "the last property is the easiest : assuming @xmath6 is smooth over @xmath602 , we obtain @xmath425 as the dual of the derived pushforward of the complex @xmath603 , where @xmath216 is the universal map . since @xmath6 is smooth over @xmath602 , the complex @xmath603 has perfect amplitude in @xmath201 $ ] , so @xmath604 has perfect amplitude in @xmath596 $ ]",
    ". therefore its dual also has perfect amplitude in @xmath596 $ ] .",
    "if in addition @xmath6 is of deligne  mumford type over @xmath602 , then @xmath603 is a vector bundle and @xmath605 has perfect amplitude in @xmath201 $ ] .    by the naturality of the local - to - global spectral sequence for @xmath606 ,",
    "it is sufficient to prove    the maps @xmath607 are injective for @xmath600 and isomorphisms for @xmath608 and @xmath609 .",
    "the rest of this section will be devoted to a proof of the lemma .",
    "we will interpret the map @xmath595 in terms of infinitesimal obstructions , deformations , and automorphisms .    *",
    "the injectivity of   when @xmath600 .",
    "* if @xmath610 is a smooth map corresponding to a family of curves @xmath611 and a map @xmath216 , then we have a commutative diagram @xmath612 \\ar@{=}[d ] & \\underline{\\ext}^1_s(u^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x / t ) / { { \\mathfrak{m}}}(y / t ) } , j ) \\ar@{=}[d ] \\\\",
    "\\underline{\\ext}^1_s({\\mathbb{l}}_{s / { { \\mathfrak{m}}}(y / t ) } , j ) \\ar[r ] & \\underline{\\ext}^1_c(f^\\ast { \\mathbb{l}}_{x / y } , j ) .    } \\ ] ] it is therefore sufficient to show that the lower arrow is injective .",
    "an element @xmath613 corresponds to a commutative diagram of solid arrows , @xmath614 \\ar[d ] & { { \\mathfrak{m}}}(x / t ) \\ar[d ] \\\\",
    "s ' \\ar@{-->}[ur ] \\ar[r ] & { { \\mathfrak{m}}}(y / t ) .    } \\ ] ] let @xmath615 and @xmath616 be the family of curves and map corresponding to the map @xmath617 .",
    "one may check using the definitions ( * ? ? ? *",
    "iii.2.2.1.2 ) that the image of @xmath618 in @xmath619 is illusie s obstruction to the existence of a lift of the diagram @xmath620 \\ar[d ] & x \\ar[d ] \\\\",
    "c ' \\ar@{-->}[ur ] \\ar[r ] & y .    } \\ ] ] if this obstruction vanishes then   has a lift by the modular definition of @xmath120 .",
    "but since @xmath149 is smooth over @xmath120 , any square - zero extension of @xmath149 over @xmath120 is locally trivial .",
    "thus we find that , possibly after localizing in @xmath149 , the class @xmath618 is zero .",
    "this proves the injectivity of the lower arrow of  .    * the bijectivity of   when @xmath608 or @xmath609 .",
    "* let @xmath610 be a smooth map corresponding to a family of curves @xmath611 and a map @xmath216 .",
    "when @xmath609 ( resp .",
    "@xmath608 ) we can interpret a class @xmath621 as a lift ( resp .",
    "an automorhism of a lift ) of the diagram @xmath622 \\ar[d ] & { { \\mathfrak{m}}}(x / t ) \\ar[d ] \\\\",
    "s[j ] \\ar@{-->}[ur ] \\ar[r ] & { { \\mathfrak{m}}}(y / t ) .    } \\ ] ] one may check that the map @xmath623 sends @xmath618 to the class of the induced extension ( resp .",
    "automorphism of the induced extension ) @xmath624 \\ar[d ] & c ' \\ar@{-->}[d ] \\ar@/^15pt/[dd ] \\\\      x_s \\ar[r ] \\ar[d ] & x_{s[j ] } \\ar[d ] \\\\      y_s \\ar[r ] & y_{s[j ] }    } \\ ] ] since the functor from the category of lifts of diagram   to the category of extensions in diagram   is an equivalence ( by the definitions of @xmath120 and @xmath143 as moduli spaces ) , it induces an bijection on isomorphism classes ( resp .",
    "automorphisms of objects ) .",
    "this proves the required bijections .",
    "[ prop : mod - compat - seq ] suppose @xmath625 is a sequence of smooth morphisms over @xmath133",
    ". then the obstruction theories constructed above for the maps in the sequence @xmath626 are compatible .",
    "let @xmath627 .",
    "the commutative diagram @xmath628 \\ar[d ] & y_{{{\\mathfrak{m}}}(x / t ) } \\ar[r ] \\ar[d ] & z_{{{\\mathfrak{m}}}(x / t ) } \\ar[d ] \\\\        { { \\mathfrak{m}}}(x / t ) \\ar[r ] & { { \\mathfrak{m}}}(y / t ) \\ar[r ] & { { \\mathfrak{m}}}(z / t )      } \\ ] ] gives rise to a commutative diagram @xmath629 \\ar[d ] & { \\mathbb{l}}_{x / z } \\ar[r ] \\ar[d ] & { \\mathbb{l}}_{x / y } \\ar[d]\\\\        \\pi^\\ast { { \\mathfrak{m}}}(g)^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(y / t ) / { { \\mathfrak{m}}}(z / t ) } \\ar[r ] & \\pi^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / t ) / { { \\mathfrak{m}}}(y / t ) } \\ar[r ] & \\pi^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / t ) / { { \\mathfrak{m}}}(y / t ) }      } \\ ] ] whose rows are exact triangles .",
    "the adjunction @xmath630 now gives the required compatibility of the obstruction theories .",
    "we prove proposition  [ prop : compatibility ] .",
    "we work in the situation of diagram  .",
    "consider the commutative diagram with cartesian squares , @xmath631 & { { \\mathfrak{m}}}(x / x'_t / t ) \\ar[l]_<>(0.5){g } \\ar[r]^<>(0.5)h \\ar[d ] & { { \\mathfrak{m}}}(x'/t ' ) \\ar[d ] \\\\",
    "{ { \\mathfrak{m}}}(y / t ) & { { \\mathfrak{m}}}(y / y'_t / t ) \\ar[l ] \\ar[r ] & { { \\mathfrak{m}}}(y'/t ' ) ,    } \\ ] ] in which the two horizontal arrows on the left side are formally tale ( lemma  [ lem : tau - is - formally - etale ] ) .",
    "assume that all of the stacks appearing above are algebraic , hence have cotangent complexes .",
    "we wish to show that there is a commutative diagram @xmath632 \\ar[r]^<>(0.5){\\sim } & { \\mathbb{e}}_{{{\\mathfrak{m}}}(x / x'_t / t ) / { { \\mathfrak{m}}}(y / y'_t / t ) } \\ar[d ] & h^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } \\ar[d ] \\ar[l]_<>(0.5){\\sim } \\\\",
    "g^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / t ) / { { \\mathfrak{m}}}(y / t ) } \\ar[r]^<>(0.5){\\sim } & { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / x'_t / t ) / { { \\mathfrak{m}}}(y / y'_t / t ) } & { \\mathbb{l}}_{{{\\mathfrak{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } \\ar[l ]    } \\ ] ] in which the upper horizontal arrows are quasi - isomorphisms .",
    "in fact , there is nothing to show on the left side of the diagram : the lower horizontal arrow on the left side is a quasi - isomorphism because @xmath633 and @xmath634 are formally tale , and we have taken the commutativity of the left square as the definition of @xmath635 .",
    "nevertheless , the deformation theoretic interpretation of @xmath199 will be useful in the proof of the commutativity of the square on the right side .",
    "we define the map @xmath636 as follows .",
    "if @xmath637 is an @xmath149-point of @xmath156 corresponding to a diagram   in which    * @xmath153 , * @xmath638 denotes the projection , and * @xmath216 and @xmath639 are the two canonical maps ,    then @xmath640 by adjunction , we get a map @xmath641 and therefore @xmath642 \\ar[r ] &   \\pi _ !",
    "f^\\ast { \\mathbb{l}}_{x / y } \\ar@{=}[d ] \\\\",
    "u^\\ast h^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } &   u^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x / x'_t / t ) / { { \\mathfrak{m}}}(y / y'_t / t ) }    } \\ ] ] it was already shown in section  [ sec : obs - thy ] that this map is an isomorphism , so the only thing to check here is the commutativity of the diagram .",
    "we remark first of all that since all of the @xmath425 complexes are of perfect amplitude in @xmath201 $ ] , we may demonstrate the commutativity by working locally with the dual diagrams @xmath643 \\ext^p(u^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / x'_t / t ) / { { \\mathfrak{m}}}(y / y'_t / t ) } , j ) \\ar[d ] & \\ext^p(u^\\ast h^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } , j ) \\ar[d ]   \\\\",
    "\\ar[r ] \\ext^p(u^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x / x'_t / t ) / { { \\mathfrak{m}}}(y / y'_t / t ) } , j )   & \\ext^p(u^\\ast h^\\ast { \\mathbb{e}}_{{{\\mathfrak{m}}}(x'/t ' ) / { { \\mathfrak{m}}}(y'/t ' ) } , j )      }    \\end{split}\\ ] ] for @xmath644 and @xmath645 a smooth map from a scheme to @xmath156 .",
    "let @xmath216 and @xmath639 denote the curves and maps corresponding to @xmath637 , and let @xmath611 and @xmath646 be the projections .",
    "* the commutativity when @xmath600 .",
    "* let @xmath618 be an element of the group @xmath647 .",
    "first we compute the image of @xmath618 in @xmath648 via the sequence @xmath649 the image of @xmath618 in @xmath650 is the standard obstruction to lifting the diagram @xmath651 \\ar[d ] & { { \\mathfrak{m}}}(x'/t ' ) \\ar[d ] \\\\      s ' \\ar[r ] \\ar@{-->}[ur ] & { { \\mathfrak{m}}}(y'/t ' ) .    } \\ ] ] we showed in section  [ sect : obs - thy - constr ] that the image of this in @xmath652 is the standard obstruction to lifting the diagram @xmath653 \\ar[d ] & x ' \\ar[d ] \\\\      { { \\overline{c } } } ' \\ar[r ] \\ar@{-->}[ur ] & y ' .    } \\ ] ]    now we check that the image of @xmath618 under the maps @xmath654 agrees with the calculation above .",
    "the image of @xmath618 in @xmath655 corresponds to an infinitesimal extension @xmath181 of @xmath149 over @xmath120 .",
    "as demonstrated in section  [ sect : obs - thy - constr ] , the image of @xmath618 in @xmath656 is illusie s obstruction to finding a dashed arrow lifting the left square of the diagram @xmath620 \\ar[d ] & x \\ar[d ] \\ar[r ] \\ar[d ] & x ' \\ar[d ] \\\\",
    "c ' \\ar[r ] \\ar@{-->}[ur ] \\ar@{ .. >}[urr ] & y \\ar[r ] & y '    } \\ ] ] where @xmath616 is the morphism corresponding to @xmath617 .",
    "this corresponds , via the isomorphism @xmath657 to the obstruction to finding a dotted arrow lifting the outside rectangle in the same diagram .    on the other hand",
    ", we have the commutative diagram @xmath658 \\ar[d ] & { { \\overline{c}}}\\ar[r ] \\ar[d ] & x ' \\ar[d ] \\\\",
    "c ' \\ar[r ] \\ar@{ .. >}[urr ] & { { \\overline{c } } } ' \\ar@{-->}[ur ] \\ar[r ] & y ' .    } \\ ] ] the obstruction to finding a dashed lift of the rectangle on the right lies in @xmath659 and its image under the isomorphism @xmath660 is the obstruction to lifting the outside rectangle ( * ? ? ?",
    "* lemma  4.12 ) .",
    "thus the image of @xmath618 in @xmath661 is the standard obstruction to producing a dashed lift in diagram  , which is what we wanted to prove .    *",
    "the commutativity when @xmath608 or @xmath609 .",
    "* these are very similar to the @xmath600 case , so we omit them .",
    "we prove lemma  [ lem : another - obs - thy ] .",
    "suppose @xmath610 is a map from a scheme to @xmath120 .",
    "let @xmath216 and @xmath611 be the corresponding map and curve .",
    "let @xmath182 be the divisor of marked points on @xmath109 .",
    "we have a commutative diagram in the derived category @xmath662 whose rows and columns are distinguished triangles : @xmath663 \\ar[d ] & f^\\ast { \\mathbb{l}}_{x } \\ar[r ] \\ar[d ] & f^\\ast { \\mathbb{l}}_{x / t } \\ar[d ] \\\\",
    "\\pi^\\ast { \\mathbb{l}}_{s } \\ar[r ] \\ar[d ] & { \\mathbb{l}}_c(\\log p ) \\ar[r ] \\ar[d ] & { \\mathbb{l}}_{c / s}(\\log p ) \\ar[d ] \\\\",
    "\\pi^\\ast { \\mathbb{l}}_{s / t } \\ar[r ] & { \\mathbb{l}}_{c / x}(\\log p ) \\ar[r ] & { \\mathbb{l}}_{c / x_s}(\\log p ) .    } \\ ] ] shifting the exact triangle in the bottom row gives a map @xmath664 \\rightarrow \\pi^\\ast { \\mathbb{l}}_{s / t } .\\ ] ] defining @xmath665 $ ] we obtain a map @xmath666 by adjunction . applying this with @xmath667 , we get the complex @xmath668 .",
    "we show below that @xmath669 is an obstruction theory using charts by smooth maps @xmath670 .",
    "note that since @xmath671 is the pullback of @xmath672 , we have a canonical isomorphism @xmath673 .    as in section",
    "[ sect : obs - thy - constr ] , it is sufficient to show that @xmath674 is bijective for @xmath601 and injective for @xmath600 .",
    "* the injectivity of   when @xmath600 . * note that the map   may be identified with the map @xmath675 when @xmath600 and @xmath610 is smooth , so it is equivalent to show that this latter map is injective .",
    "one may check without difficulty that the map @xmath676 sends the class @xmath618 of the extension @xmath176 over @xmath133 in the diagram @xmath677 \\ar[d ] & { { \\mathfrak{m}}}(x / t ) \\ar[d ] \\\\",
    "s ' \\ar[r ] \\ar@{-->}[ur ] & t    } \\ ] ] to the obstruction to extension in the diagram @xmath678 \\ar[d ] & c ' \\ar@{-->}[d ] \\\\      x_s \\ar[r ] & x_{s ' }     } \\ ] ] ( cf .",
    "* proposition  2.1.2.3 ) ) .",
    "if the image of @xmath618 in @xmath679 is zero , then diagram   must have a lift , by the definition of @xmath120 as a moduli space .",
    "but @xmath680 was assumed to be smooth , so , at least after localizing in @xmath149 , the extension @xmath176 over @xmath120 can be split .",
    "that is , the class of @xmath618 in @xmath681 is zero , which implies that @xmath682 is injective , as we wanted .    * the bijectivity of   when @xmath609 and @xmath608 . * likewise , when @xmath609 ( resp .",
    "@xmath608 ) , the map @xmath683 sends the class of a lift of the diagram ( resp .",
    "an automorphism of the diagram ) @xmath651 \\ar[d ] & { { \\mathfrak{m}}}(x / t ) \\ar[d ] \\\\",
    "s[j ] \\ar[r ] \\ar@{-->}[ur ] & t    } \\ ] ] to the class ( resp .",
    "the induced automorphism ) of the extension @xmath684 \\ar[d ] & c ' \\ar@{-->}[d ] \\\\      x_s \\ar[r ]   & x_{s[j ] } .    } \\ ] ] since @xmath120 is a moduli space , the functor from the category of lifts of the first diagram to the category of extensions in the second is an equivalence .",
    "it therefore induces bijections on isomorphism classes of objects ( resp .",
    "automorphisms ) .",
    "suppose @xmath685 is a smooth morphism of algebraic stacks .",
    "then the obstruction theories in the sequence @xmath686 are compatible .",
    "let @xmath627 be the universal curve and @xmath687 the universal map .",
    "the commutative diagram @xmath688 \\ar[d ] & x_{{{\\mathfrak{m}}}(x / t ) } \\ar[r ] \\ar[d ] & y_{{{\\mathfrak{m}}}(y / t ) } \\ar[d ] \\\\        { { \\mathfrak{m}}}(x / t ) \\ar[r ] & { { \\mathfrak{m}}}(y / t ) \\ar[r ] & t      } \\ ] ] gives rise to a commutative diagram @xmath689 \\ar[d ] & { \\mathbb{l}}_{{{\\mathfrak{c}}}/ y_{{{\\mathfrak{m}}}(x / t ) } } \\ar[r ] \\ar[d ] & { \\mathbb{l}}_{{{\\mathfrak{c}}}/ x_{{{\\mathfrak{m}}}(x / t ) } } \\ar[d ] \\\\",
    "{ { \\mathfrak{m}}}(g)^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(y / t)/t } \\ar[r ] & \\pi^\\ast { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / t ) / t } \\ar[r ] & { \\mathbb{l}}_{{{\\mathfrak{m}}}(x / t ) / { { \\mathfrak{m}}}(y / t ) }       } \\ ] ] in the derived category of @xmath419 . applying",
    "the adjunction @xmath630 proves the proposition .",
    "[ cor : ma - lci ] the map @xmath690 is a local complete intersection morphism .",
    "this proposition is not used in the proof of theorem  [ prop2 ] , but the lemma we use to prove it seems to be of independent interest .    [",
    "lem : obs - lci ] let @xmath691 be a representable , finite type morphism of locally noetherian algebraic stacks and let @xmath692 be a perfect relative obstruction theory .",
    "suppose that @xmath693 is smooth and that generically , @xmath694 .",
    "then @xmath695 is an isomorphism , and in particular , @xmath691 is a local complete intersection morphism .",
    "we begin by reducing to the case where @xmath691 is an embedding of affine schemes .",
    "it suffices to prove the lemma after a base change by a smooth presentation @xmath696 .",
    "under such a base change , @xmath692 pulls back to a perfect relative obstruction theory on @xmath697 .",
    "so we may assume that @xmath698 is an affine noetherian scheme .",
    "now it suffices to prove the lemma after an tale base change @xmath699 , where @xmath206 is an affine scheme of finite type over @xmath149 .",
    "let @xmath700 be an embedding into an affine scheme @xmath701 which is smooth over @xmath693 .",
    "let @xmath702 be the ideal of @xmath206 in @xmath575 .",
    "since @xmath703 is a vector bundle in degree @xmath1 and @xmath704 is an isomorphism , @xmath705 lifts uniquely to @xmath706 .",
    "let @xmath707 .",
    "then we have a morphism of distinguished triangles : @xmath708 \\ar[d]^= & { \\mathbb{e}}\\ar[r ] \\ar[d ] & { \\mathbb{f}}\\ar[r ] \\ar[d ] & \\iota^*{\\mathbb{l}}_{w/{\\mathcal{n}}}[1 ] \\ar[d]^= \\\\ \\iota^*{\\mathbb{l}}_{w/{\\mathcal{n } } } \\ar[r ] & { \\mathbb{l}}_{u/{\\mathcal{n } } } \\ar[r ] & { \\mathbb{l}}_{u / w } \\ar[r ] & \\iota^*{\\mathbb{l}}_{w/{\\mathcal{n}}}[1].}\\ ] ] by taking long exact sequences , we see that @xmath553 is represented by a vector bundle in degree @xmath709 which surjects onto @xmath710 .",
    "the assumption that @xmath711 is generically @xmath1 implies that there is a dense open subset of @xmath206 over which @xmath712 is an isomorphism .    by restricting to a smaller open set",
    ", we may assume that @xmath713 is free of rank @xmath714 .",
    "then a basis of @xmath553 determines elements @xmath715 which generate @xmath702 modulo @xmath716 . in other words @xmath717",
    "is generated by the image of @xmath716 .",
    "thus @xmath718 and nakayama s lemma implies that there is an element @xmath719 such that @xmath720 modulo @xmath702 and @xmath721 @xcite .",
    "since @xmath722 does not vanish on @xmath206 , we may invert @xmath722 and assume that @xmath723 . to show that @xmath724 is a regular sequence",
    ", it suffices to show that @xmath725 @xcite .    by assumption",
    ", @xmath206 has a dense open set which is a local complete intersection .",
    "it follows that @xmath714 is the codimension of @xmath206 in @xmath575 .",
    "but any proper ideal @xmath702 of a cohen - macaulay ring @xmath549 has @xmath726 @xcite , so @xmath206 is a local complete intersection and @xmath727 is free with basis @xmath724 .",
    "this shows that @xmath728 is an isomorphism , which implies that @xmath729 is an isomorphism .    by the lemma and the definition of @xmath730",
    ", it suffices to show that @xmath731 for a general geometric point @xmath732 .",
    "if @xmath733 is smooth , with coarse moduli space @xmath734 , then it follows from the definition of @xmath273 that the pushforward of @xmath735 to @xmath734 is @xmath736 .",
    "in particular , @xmath731 in this case .",
    "so it suffices to show that @xmath733 is smooth for general @xmath737 , which is proposition  [ prop : density ] .",
    " = 11                                                  bumsig kim , andrew kresch , and tony pantev , _ functoriality in intersection theory and a conjecture of cox , katz , and lee _ , j. pure appl .",
    "algebra * 179 * ( 2003 ) , no .  1 - 2 , 127136 .",
    "mr mr1958379 ( 2003m:14088 )"
  ],
  "abstract_text": [
    "<S> we prove that genus zero gromov  </S>",
    "<S> witten invariants of a smooth scheme relative to a smooth divisor coincide with genus zero orbifold gromov  witten invariants of an appropriate root stack construction along the divisor . </S>"
  ]
}