{
  "article_text": [
    "the one dimensional nonlinear schrdinger system ( nls )  @xcite : @xmath0 under periodic boundary conditions , @xmath1 for all @xmath2 and @xmath3 , is a widely studied multiparticles system subjected to nonlinear interactions , that can be used to model several relevant physical phenomena  @xcite , ranging from optics to solid state and atomic physics , for instance bose - einstein condensates .",
    "often scientists , once modeling physical nonlinear phenomena , impose the condition   sign represents the defocusing case hereby considered , a @xmath4 sign represents the focusing one and where @xmath5 denotes the complex conjugate of the complex number @xmath6 . ] @xmath7 for all @xmath3 , in this case the system reduces to the standard cubic nls equation .",
    "we hereby adopt the viewpoint of  @xcite where the conjugacy relation between @xmath8 and @xmath9 is not imposed a priori .",
    "we will nevertheless show that if this relation holds at @xmath10 then it will be preserved by our numerical integration scheme .",
    "most properties of nls are related to the asymptotic behavior of its solutions , there is thus a strong need for integration schemes , allowing large step sizes , to easily cover large time spans , without degrading the efficiency of the numerical method hence avoiding the introduction of spurious outcome in the numerical simulations .",
    "these goals can be achieved using symplectic integrators , that are specifically designed to preserve the energy and possibly other first integral of the system .",
    "our analysis will be performed on the following one dimensional discretization of the eq .",
    ", dnls for short  @xcite : @xmath11 using the periodic boundary conditions @xmath12 and @xmath13 for all @xmath14 .",
    "let us observe that the solutions of the dnls are @xmath15 close to the solutions of the pde  , thus in the limit @xmath16 , the former converge to the solutions of the latter .",
    "the integration method hereby proposed is based on the development of an idea introduced by yoshida  @xcite .",
    "the strong improvement allowed by this method with respect to other ones available in the literature , relies on the fact that we are able to provide _",
    "integrators , that are _ explicit _ ones , thus very fast , and whose _ order _ can be easily as high as the eighth one .",
    "other methods based on the construction of generating functions , see for instance  @xcite are not particularly suitable because the hamiltonian function describing the dnls can not be split in the form @xmath17 , namely it is not a potential hamiltonian system .",
    "this implies in fact that the obtained numerical integration schemes are implicit methods , and thus a large amount of cpu time is used to compute the new position , or the new momentum , using some newton  like method .",
    "let us observe that gauss methods  @xcite , namely symplectic versions of runge  kutta , are also implicit ones and thus they suffer of the above mentioned limitations .",
    "finally let us observe that , because the system can not be put in the form of a perturbation of an integrable system , the method proposed in  @xcite is no more useful here : one can easily get a second order method and with some additional work also a fourth order method  @xcite , but no higher orders are obtainable .",
    "the paper is organized as follows . in the next section we briefly recall the hamiltonian structure of the non linear schrdinger equation on a one dimensional lattice",
    "; then section  [ sec : symplsch ] will be devoted to the presentation and to the construction of the symplectic integrator , whose properties will be numerically studied in section  [ sec : results ] .",
    "finally we sum up and draw our conclusions in section  [ sec : concl ] .",
    "the system   will be studied imposing the standard spatial discretization , see for instance  @xcite , thereby called _ diagonal _ nls , that reads : @xmath18 using the periodic boundary conditions : @xmath19 observe that @xmath20 plays the role of spatial discretization parameter and thus the first terms on the right hand sides stem from the discretized second order spatial derivatives .",
    "let us remark that one could be interested in studying directly the system   as a relevant model of non  linear interaction on a discrete one dimensional of lattice .",
    "one can easily prove that the dnls can be cast into the hamiltonian formalism using the following hamilton function @xmath21\\ ,    , \\ ] ] and moreover the variables @xmath22 do satisfy the standard poisson equations @xmath23    let us observe that the dnls system   possesses another first integral independent of the energy , namely : @xmath24 that under the assumption @xmath25 , is usually called the _ mass _ of the system .",
    "the aim of this work is to define a family of symplectic integrators based on the yoshida symplectic scheme  @xcite adapted to the dnls system   and to study their numerical properties in terms of preserved quantities , cpu time needed and accuracy of the results .",
    "let us observe that system   is not quasi ",
    "integrable , i.e. it can not be decomposed as the sum of an integrable one and a small perturbation , thus we can not use the high order symplectic schemes @xmath26 or @xmath27 proposed by laskar and robutel  @xcite , whose accuracy strongly relies on the smallness of the perturbation .",
    "for a sake of completeness , let us briefly recall the integration method proposed in  @xcite to numerically reconstruct the orbit of an hamiltonian systems @xmath28",
    ".    given any initial condition @xmath29 and an integration time span @xmath30 $ ] , we proceed by decomposing the integration interval into small pieces of fixed size @xmath31 .",
    "the method results thus in a fixed step size integration method .",
    "then , in each small interval , we approximate the time @xmath31 flow of the hamiltonian systems @xmath32 by a composition of _ basic symplectic flows _ of the form @xmath33 and @xmath34 , where @xmath35 and @xmath36 are two suitable functions providing a decomposition of the hamilton function , i.e. @xmath37 , @xmath38 suitable constants to achieve the wanted order of precision of the integration scheme and @xmath39 is a shorthand notation to denote the flow at time @xmath31 of the hamilton function @xmath40 .",
    "more precisely we are looking for @xmath41 for some positive integers @xmath42 and @xmath43 .",
    "the method is particularly efficient once the maps @xmath33 and @xmath44 are explicitely computable , which requires @xmath45 and @xmath46 to be",
    "_ simple enough_. in particular this is true whenever @xmath45 and @xmath46 depend only upon one group of canonical variables and thus the hamiltonian is of the so - called potential form .",
    "of course this is a strong requirement that can not always be achieved by suitable change of coordinates . in the following",
    "we propose the decomposition of the hamilton function   given by @xmath47 let us observe that even if @xmath45 and @xmath46 both depend on all the canonical variables , we are able to explicitely compute @xmath48 and @xmath49 ( see   [ ssec : expa ] and   [ ssec : expb ] ) and thus to propose a _ completely explicit _ method .",
    "the equations of motion of the system with hamilton function@xmath45 are given by : @xmath50 from which it trivially follows that @xmath51 is a first integral for all @xmath52 , in fact : @xmath53 hence   simplifies into @xmath54 whose solution with initial datum @xmath55 is for all @xmath3 : @xmath56 finally the time @xmath31 flow of @xmath45 is given by : @xmath57 where @xmath58 denotes the transposed of the vector .",
    "the equations of motion corresponding to the @xmath46 part of the hamiltonian function are : @xmath59 that can be cast in a compact form using the periodic boundary conditions   by introducing the _ circulant matrix _",
    "@xcite @xmath60 obtained by cyclically permute the @xmath61vector @xmath62 : @xmath63 that is the linear diagonal system @xmath64    thus formally the time @xmath31 flow of the hamilton function @xmath46 is given by : @xmath65    the circulant matrices have some useful properties that allow one to explicitely compute their eigenvalues , eigenvectors and hence their exponential .",
    "[ prop : circmatr ] let @xmath60 be the circulant matrix given by   and let @xmath66 , then    1 .",
    "the eigenvalues of the matrix @xmath60 are given by : @xmath67 , @xmath68 ; 2 .",
    "for @xmath68 , the eigenvector associated to @xmath69 is given by @xmath70 3 .",
    "let @xmath71 be the matrix whose columns are the eigenvectors @xmath72 , then @xmath71 is unitary , namely @xmath73 . where @xmath74 denotes the transposed complex conjugated matrix ; 4 .",
    "the exponential of @xmath60 is given by : @xmath75 being @xmath76 the diagonal matrix with the eigenvalues on the diagonal .",
    "point ( 1 ) can be proved by a direct computation , for all @xmath77 , one has : @xmath78 observing that @xmath79 , we thus have @xmath80    let us point out that the complex vectors @xmath81 form an orthonormal set for @xmath82 ( with the standard complex scalar product ) : @xmath83    let us also remark that the eigenvalues @xmath69 are actually real : @xmath84 and moreover the eigenvalues coincide in pairs , more precisely there are @xmath85 distinct eigenvalues , if @xmath61 is odd , and @xmath86 ones if @xmath61 is even : @xmath87 if @xmath88 .    to prove that @xmath71 is unitary ,",
    "let us denote by @xmath89 and compute the element @xmath90 of such matrix . by definition @xmath91 thus @xmath92 .",
    "a similar computation can be done for @xmath93 .",
    "finally let us observe that @xmath94 , in fact one trivially has @xmath95 and because @xmath71 is unitary , @xmath96 , thus @xmath97 .",
    "this implies that the exponential can be computed as follows : @xmath98 the element @xmath99 of @xmath100 is thus given by : @xmath101    one can thus explicitely compute the flow of @xmath46 given by     the time @xmath31 flow of the hamilton function @xmath46 can be rewritten as : @xmath102 or explicitely for all @xmath14 : @xmath103    let us observe that   can be rewritten in compact vector form in a way inspired by the solution of linear ode , namely as a linear combination of eigenvectors , as follows : @xmath104      once we have the explicit maps @xmath48 and @xmath105 one can construct the basic second order symplectic scheme strmer - verlet / leap frog : @xmath106 .",
    "then yoshida proved  @xcite that one can find explicit suitable coefficients @xmath107 and @xmath108 , such that the composition @xmath109 is actually a fourth order symplectic integrator , that moreover is symmetric , i.e. it has exact time reversibility .",
    "one can iterate this construction and find new explicit coefficients , @xmath110 and @xmath111 , such that the composition @xmath112 provides a sixth order symmetric symplectic integrator .",
    "this idea can be iterated to construct symmetric symplectic integrators with arbitrarily high order .",
    "the main drawback is that the number of involved terms increases very fast , thus one has to choose a suitable compromise between the required precision in term of preserved quantities , i.e. energy and mass , and the cpu time available .    in the next sections we will show that @xmath113 and @xmath114 exhibit very good energy and mass preservation properties even for relatively large integration time steps , they are composed by relatively few terms and moreover because they are explicit methods , they are relatively fast .",
    "they provide thus very powerful and fast methods to numerically analyze the dnls in the asymptotic limit of large time spans .",
    "let us observe that our method straightforwardly applies to generalized dnls  @xcite @xmath115\\ ,    , \\ ] ] being @xmath116 a positive parameter .",
    "in fact setting @xmath117 and observing that @xmath118 is still a first integral for the flow of @xmath119 , we directly obtain for @xmath120 @xmath121 while the flow associated to the @xmath46 part remains unchanged .",
    "more generally our method can be directly applied whenever we replace the @xmath45part of the hamiltonian function with a new one , @xmath122 , for which the map @xmath123 can be computed explicitely .      by construction the symplectic scheme @xmath124 will preserve the energy of the systems with an error @xmath125 , that is independent of the relative weight of the functions @xmath45 and @xmath46 used to decompose the hamilton function ,",
    "this is the reason why this method is more suitable than the one proposed in  @xcite where the error is also a function of the relative weights .",
    "the aim of this section , is to prove that the symplectic schemes @xmath126 preserve other relevant quantities of the dnls system  .      to prove that our method preserves the first integral @xmath128",
    "let us start by consider the action of the map @xmath49 on the function @xmath129 .",
    "starting by its very first definition   we get : @xmath130    \\\\ & = & -\\frac{i}{h^2}\\sum_{l=1}^n    \\left(p_{l+1}q_l+p_{l-1}q_l - p_lq_{l+1}-p_lq_{l-1}\\right)=0\\ , , \\end{aligned}\\ ] ] where the last equality follows by using the boundary conditions .",
    "thus the flow of @xmath46 preserves @xmath128 .",
    "on the other hand by the definition of the map @xmath131 given by   one straightforwardly get : @xmath132 and thus also the flow induced by @xmath45 preserves @xmath128 .",
    "we can thus conclude that the composition of the maps @xmath131 and @xmath133 preserves the first integral @xmath128 and so does any symplectic scheme @xmath126 .",
    "let us define the complex vector @xmath135 .",
    "using the fact that @xmath60 is real , the time evolution of @xmath136 under the action of @xmath46 is given by  : @xmath137 from which one gets : @xmath138 thus if by assumption @xmath139 then we get @xmath140 for all @xmath3 .",
    "for the flow of @xmath45 we use once again the explicit map   and the fact that @xmath141 implies that @xmath142 is real for all @xmath14 , thus @xmath143    once again , we can thus conclude that the composition of the maps @xmath131 and @xmath133 preserves the first integral @xmath128 and so it does any symplectic scheme @xmath126 .",
    "the symplectic integrators we proposed preserve other quantities such as the norm of the canonical variables , namely @xmath144 and @xmath145 , defined by the complex scalar product @xmath146 .",
    "let us first observe that this statement holds for the flow of @xmath46 .",
    "for instance in the case of the @xmath147 variable one has : @xmath148 where in the last step we used the facts that @xmath60 is real , thus @xmath149 , and moreover @xmath150 .",
    "it remains to check the behavior under @xmath45 .",
    "but using the definition   we get : @xmath151    along a very similar way we can prove the result for @xmath152 .",
    "we can thus conclude that the symplectic integrators @xmath126 preserve the norm of the complex vectors @xmath147 and @xmath152 .",
    "the aim of this section is to present the numerical results obtained using our high order symplectic schemes .",
    "we fixed initial conditions as in  @xcite to have a good testbed to compare our results with other ones available in the literature , hence we define : @xmath153 where @xmath154 , @xmath155 , @xmath14 , namely we are considering perturbation of a spatially uniform plane wave invariant under the phase flows .",
    "we used several values for @xmath61 while the remaining parameters have been fixed  @xcite to @xmath156 , @xmath157 and @xmath158 .",
    "let us stress that because of the high accuracy of most of the presented results , mainly in term of energy preservation , we performed our numerical simulation using quadruple precision fortran .",
    "the first result reported in fig .",
    "[ fig : nrgevol ] shows the preservation of the energy for one given orbit with the above initial conditions using the symplectic schemes @xmath126 for @xmath159 .",
    "we can observe that the relative energy loss , @xmath160 , fluctuates in times but does nt grow on a quite large time span @xmath161 $ ] even using a relatively large time step @xmath162 .",
    "moreover we can remark that already with @xmath113 the relative energy loss , is well below @xmath163 . on the other hand @xmath164",
    "allows to reach values of the order of @xmath165 .",
    "the preservation of the other quantities is even better ; concerning the mass , @xmath166 , we can find that the relative error , @xmath167 , assumes values well below @xmath168 for all integrator schemes we used @xmath126 ( data not reported ) ; while the relation @xmath134 is preserved up to the machine precision , namely @xmath169 ( data not reported ) .    in the inset of fig .",
    "[ fig : nrgevol ] we report the comparison with the non  symplectic integrator runge  kutta 4 using @xmath170 ; we can clearly see the inefficiency of the latter method even using a time step smaller than the one used for the symplectic schemes , in fact the relative energy loss becomes larger than @xmath171 already at @xmath172 , so no longer comparison are possible . using runge ",
    "kutta 4 the relative energy loss grows in times , the slower is the time step , but still growing , hence one can reach the precisions obtained by a symplectic integrator only using very small time steps @xmath31 or integrating over relatively short time spans .",
    "for instance one can achieve a relative energy loss of @xmath173 using @xmath174 only on a time span @xmath175 $ ] , while using @xmath176 we can get the same error but on @xmath161 $ ] . on the time span @xmath175 $ ] and using the time step @xmath177 , runge  kutta 4 achieves a relative loss for the mass of the order of @xmath178 while the conjugacy relation @xmath134 is not preserved any more .",
    "this is the main reason of the poor properties obtained using runge ",
    "kutta 4 with @xmath179 ; in fact if we modify the integration scheme by forcing the vectors @xmath180 and @xmath181 to satisfy the conjugation relation at each time step , we obtain a method , hereby called modified runge ",
    "kutta 4 , @xmath182 , that exhibits improved energy preservation properties ( see fig .",
    "[ fig : nrgevol ] ) .",
    "let us observe that this is method is not symplectic , as one can clearly conclude from the increasing trend in the relative energy variation presented in the figure .",
    "the method allows to reach large time spans , @xmath161 $ ] , but the goodness of the method , measured in terms of relative energy variation , is worse than @xmath113 and slightly better than @xmath183 .",
    "let us finally observe that on the same large time span and still using @xmath179 , the mass of the system is conserved up to a factor @xmath184 .",
    ", as a function of time , for one orbit with initial conditions  , @xmath185 and a time step @xmath179 . using , from top to bottom , the integrators @xmath183 ( blue ) , @xmath182 ( magenta ) , @xmath113 ( red ) , @xmath114 ( black ) and @xmath164 ( green ) .",
    "inset : using @xmath186 with time step @xmath187.,width=434 ]    the next study will concern the dependence of the maximum relative energy loss as a function of the time step , by integrating several solutions using @xmath124 , @xmath188 , over a large time span @xmath161 $ ] ; let us observe , once again , that because the relative energy fluctuates around the fixed initial value , the same results hold for arbitrarily longer time spans .",
    "result reported in fig .",
    "[ fig : nrgloss ] shows the computed numerical accuracy of @xmath124 as a function of the time step @xmath31 .",
    "let us observe that the use of @xmath189 , respectively of @xmath190 , with integration steps @xmath31 smaller than @xmath191 , respectively @xmath192 , will produce a maximum relative energy loss below the quadruple machine precision , that is why we limited our simulations to these values .",
    "straight lines reported in fig .  [ fig : nrgloss ] represent linear best fits @xmath193 , whose coefficients @xmath194 and @xmath195 are reported in table  [ tab : lifit ] and numerically confirm the accuracy of the integrators @xmath126 .",
    "let us remark that a similar result holds for larger values of @xmath61 .",
    "the main difference being that in this case large time steps are prevented to be used because of a decrease in the performances of all integrator schemes , @xmath196 , mainly because of the energy preservation .",
    "this fact has been already observed  @xcite and relies on a stability issue of the integrators , symplectic and non  symplectic ones , that imposes a constrains @xmath197 , for some positive constant @xmath198 .",
    "we report @xmath199}|\\delta e(t)|$ ] for orbits with initial conditions given by   and @xmath185 , numerically integrated over the time span of @xmath161 $ ] with @xmath200 @xmath183 ( black ) , @xmath201 @xmath113 ( blue ) , @xmath202 @xmath114 ( green ) , @xmath203 @xmath164 ( red ) , @xmath204 @xmath189 ( cyan ) , empty @xmath205 @xmath182 ( grey ) and @xmath205 @xmath186 ( grey ) but over a small time span @xmath206 $ ] .",
    "straight lines are linear best fits @xmath193 , the coefficients @xmath194 and @xmath195 are reported in table  [ tab : lifit].,width=434 ]    .numerical coefficients of the linear best fits @xmath207 reported in fig .  [ fig : nrgloss ] .",
    "[ cols=\"^,^,^\",options=\"header \" , ]     our last remark concerns the speed of the numerical methods @xmath196 . in fig .  [ fig : cputime ] we report the cpu time used to integrate orbits with initial conditions   and @xmath185 using @xmath196 , as a function of the time step @xmath31 . for @xmath164 and @xmath189",
    "we limited the analysis to time steps whose maximum relative energy loss is larger than the machine precision using quadruple precision fortran ( see fig .",
    "[ fig : nrgloss ] and discussion therein ) . from these data",
    "we clearly conclude that the cpu time increases as @xmath208 for a fixed integrator scheme @xmath196 ; on the other hand , for fixed @xmath31 , the cpu time increases as a exponential of the integrator order , roughly as @xmath209 .",
    "this is because , as already mentioned , the yoshida scheme does not get the optimal number of products @xmath210 and @xmath211 . on one hand yoshida already proposed  @xcite an improved version to tackle this difficulty , whose results are symplectic schemes with fewer compositions  .",
    "because the computations to obtain the coefficients @xmath38 become rapidly cumbersome we limit ourselves to study the cases of sixth order , @xmath212 , and eighth order , @xmath213 .",
    "results reported in fig .  [ fig : cputime ] show that @xmath214 needs almost @xmath215 times more cpu time than @xmath216 , while @xmath217 about @xmath218 times more cpu time than @xmath219 .    on the other hand in practical applications one should choose the time step @xmath31 and the integration order @xmath220 that produce the best balance between the required precision , say maximum relative energy loss , and the cpu time needed .",
    "for instance from fig .",
    "[ fig : nrgloss ] we clearly see that using @xmath113 and @xmath221 , we can ensure a maximum relative energy loss of the order of @xmath222 , to get the same precision using @xmath114 one can use a time step ten times larger , @xmath223 and thus ( see fig .",
    "[ fig : cputime ] ) the required cpu time will be smaller with @xmath224 than with @xmath225 . requiring the same precision , using instead @xmath164 , will need a time step onlytwenty times larger and thus the cpu time will increase : @xmath226 .    the runge  kutta 4 requires a cpu time larger than @xmath113 using the same time step , roughly of the same order of @xmath227 .",
    "on the other hand the modified runge ",
    "kutta scheme is faster than @xmath113 because it has to compute only half of the vector field .",
    "the dependence of the cpu time on the discretization parameter @xmath20 , hence on @xmath61 , is more crucial once we need to use very large @xmath61 and/or a very large number of orbits .",
    "because in the present work we were not interested in the optimality of the method , we computed naivelythe map @xmath211 , namely using a vector  matrix product whose cost is @xmath228 .",
    "on the other hand we can easily improve this part by considering the strong similarity with the map @xmath211 and the fourier transform of the vectors @xmath229 ( see proposition  [ prop : circmatr ] and eq .  ) and thus use , instead of the vector  matrix product , a fast fourier  like method to speed up the computations .     as a function of @xmath31_. for a fixed time span of @xmath161",
    "$ ] we report the cpu time needed by @xmath124 to integrate orbits with initial conditions given by   and @xmath185 .",
    "symbols are : @xmath200 @xmath183 ( black ) , @xmath201 @xmath113 ( blue ) , @xmath202 @xmath114 ( green ) , empty @xmath202 @xmath212 ( green ) , @xmath203 @xmath164 ( red ) , empty @xmath203 @xmath213 ( red ) , @xmath204 @xmath189 ( cyan ) , empty @xmath205 @xmath182 ( magenta ) and @xmath205 @xmath186 using ( magenta).,width=434 ]",
    "in this paper we presented a family of high order , explicit , symplectic integrations schemes adapted to the study of the dnls . despite dnls",
    "has been studied numerically since long time , this is the first time that such a high precision can be achieved using relatively large time steps . besides the very good energy preservation properties of the above introduced methods , we also obtained an almost exact preservation of the other first integral , the mass of the system , and of the conjugacy relation .",
    "because the integrators we constructed are explicit ones , they result very fast .    for all these reasons we believe that such accurate numerical schemes could be very useful to test several physical hypotheses concerning the asymptotic regimes of the dnls , for instance the existence and stability of breathers and the regimes with negative temperature .",
    "one of the authors , tc , would like to thank antonio politi and stefano iubini , from isc florence italy , for interesting and useful discussions .",
    "the work of ch.h is supported by a fnrs research fellowship .",
    "numerical simulations were made on the local computing resources ( cluster urbm - sysdyn ) at the university of namur ( fundp , belgium ) .",
    "porter , _ experimental results related to dnls equations _ , in p.g .",
    "kevrekidis : _ the discrete nonlinear schrdinger equation . mathematical analysis , numerical computations and physical perspectives _ , stmp , * 232 * , springer - verlag berlin heidelberg ( 2009 ) , pp.175"
  ],
  "abstract_text": [
    "<S> we propose a family of reliable symplectic integrators adapted to the discrete non  linear schrdinger equation ; based on an idea of yoshida  @xcite we can construct high order numerical schemes , that result to be explicit methods and thus very fast . </S>",
    "<S> the performances of the integrators are discussed , studied as functions of the integration time step and compared with some non symplectic methods .            </S>",
    "<S> university of namur + 8 , rempart de la vierge , b5000 namur ( belgium ) + http://www.naxys.be </S>"
  ]
}