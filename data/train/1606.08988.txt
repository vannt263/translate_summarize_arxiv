{
  "article_text": [
    "in this subsection , we briefly describe a variational principle for equilibrium description in hierarchical congestion population games .",
    "in particular , we consider a multistage model of traffic flows .",
    "further details can be found in @xcite .",
    "we consider the traffic network described by the directed graph @xmath0 .",
    "some of its vertices @xmath1 are sources ( origins ) , and some are sinks ( destinations ) @xmath2 . we denote a set of source - sink pairs by @xmath3 .",
    "let us assume that for each pair @xmath4 there is a flow of network users of the amount of @xmath5 , where @xmath6 , per unit time who moves from the origin of @xmath7 to its destination .",
    "we call the pair @xmath8 as correspondence .",
    "let edges @xmath9 be partitioned into two types @xmath10 .",
    "the edges of type @xmath11 are characterized by non - decreasing functions of expenses @xmath12 .",
    "expenses @xmath13 are incurred by those users who use in their path an edge @xmath14 , the flow of users on this edge being equal to @xmath15 .",
    "the pairs of vertices setting the edges of type @xmath16 are in turn a source - sink pairs @xmath17 ( with correspondences @xmath18 , @xmath19 ) in a traffic network of the second level @xmath20 whose edges are partitioned in turn into two types @xmath21 .",
    "the edges having type @xmath22 are characterized by non - decreasing functions of expenses @xmath23 .",
    "expenses @xmath24 are incurred by those users who use in their path an edge @xmath25 , the flow of users on this edge being equal to @xmath26 .",
    "the pairs of vertices setting the edges having type @xmath27 are in turn source - sink pairs @xmath28 ( with correspondences @xmath29 , @xmath30 ) in a traffic network of a higher level @xmath31 , etc .",
    "we assume that in total there are @xmath32 levels : @xmath33 . usually , in applications , the number @xmath32 is small and varies from 2 to 10 .",
    "let @xmath34 be the set of all paths in @xmath9 which correspond to a correspondence @xmath7 .",
    "each user in the graph @xmath9 chooses a path @xmath35 ( a consecutive set of the edges passed by the user ) corresponding to his correspondence @xmath4 . having defined a path @xmath36 , it is possible to restore unambiguously the edges having type @xmath16 which belong to this path . on each of these edges @xmath37",
    ", user can choose a path @xmath38 ( @xmath39 is a set of all paths corresponding in the graph @xmath40 to the correspondence @xmath41 ) , etc .",
    "let us assume that each user have made the choice .",
    "we denote by @xmath42 the size of the flow of users on a path @xmath43 , @xmath44 the size of the flow of users on a path @xmath45 , etc .",
    "let us notice that @xmath46 and that @xmath47    for all @xmath48 , we introduce for the graph @xmath49 and the set of paths @xmath50 a matrix @xmath51 then , for all @xmath48 , the vector @xmath52 of flows on the edges of the graph @xmath49 is defined in a unique way by the vector of flows on the paths @xmath53 : @xmath54 we introduce the following notation @xmath55    we denote @xmath56 and set @xmath57 .",
    "further , we define by induction , with the basis @xmath58 , for all @xmath59 , @xmath60 to be the `` length '' of the path @xmath61 in the graph @xmath62 with the edges @xmath63 having weight @xmath64 and the edges @xmath65 having weight @xmath66 . here",
    "@xmath67 is the parameter , characterizing the restricted rationality of the network users on the level @xmath68 , and @xmath69 let us now describe the probabilistic model for the choice of the path by a network user .",
    "we assume that each user @xmath70 of a traffic network who uses a correspondence @xmath71 at a level @xmath68 ( and simultaniously the edge @xmath72 at the level @xmath73 ) chooses to use a path @xmath74 if @xmath75 where @xmath76 are iid random variables with double exponential distribution ( also known as gumbel s distribution ) with cumulative distribution function @xmath77 where @xmath78 is euler  mascheroni constant . in this case",
    "@xmath79=0 , \\quad d [ { \\xi _ { q^k}^{k , l } } ] = ( \\gamma^k)^2\\pi^2/6.\\ ] ] also , it turns out that , when the number of agents on each correspondence @xmath71 , @xmath48 tends to infinity , i.  e. @xmath80 , the limiting distribution of users among paths is the gibbs s distribution ( also known as logit distribution ) @xmath81 it is worth noting here that ( see theorem 1 below ) @xmath82 .",
    "\\notag \\\\ & f = \\theta x =   - \\nabla { \\psi ^1}\\left ( { { t \\mathord{\\left/   { \\vphantom { t { { \\gamma ^1 } } } } \\right .",
    "\\kern-\\nulldelimiterspace } { { \\gamma ^1 } } } } \\right ) , { \\psi ^1}\\left ( t \\right ) = \\sum\\limits_{{w^1 } \\in o{d^1 } } { d_{{w^1}}^1\\psi _ { { w^1}}^1\\left ( t \\right)}. \\qquad \\qquad \\qquad \\qquad \\qquad \\quad ( 1 ' ) \\notag \\ ] ]    for the sake of convenience we introduce the graph @xmath83 and denote @xmath84 , @xmath85 .",
    "assume that , for a given vector of expenses @xmath86 on edges @xmath87 , which is identical to all users , each user chooses the shortest path at each level based on noisy information and averaging of the information from the higher levels .",
    "then , in the limit number of users tending to infinity , such behavior of users leads to the description of distribution of users on paths / edges given in ( [ gas_eq1 ] ) and the equilibrium configuration in the system is characterized by the vector @xmath86 for which the vector @xmath88 , obtained from ( [ gas_eq1 ] ) , leads to the vector @xmath89 ( see also @xmath90 ) satisfying @xmath91 .    introducing @xmath92 and @xmath93",
    ", we obtain @xmath94    this allows to prove the following",
    ".    the fixed point equilibrium @xmath95 can be found as a solution of the following problem ( here and below we denote by @xmath96 the effective domain of the function conjugated to a function @xmath97 ) @xmath98 _ where _",
    "@xmath99 @xmath100    _  _    @xmath101 @xmath102    _  _    @xmath103 @xmath104",
    "in this subsection , we describe one of our contributions made by this paper , namely a general accelerated primal - dual gradient method for composite minimization problems .",
    "we consider the following convex composite optimization problem  @xcite : @xmath105.\\ ] ] here @xmath106 is a closed convex set , the function @xmath107 is differentiable and convex on @xmath108 , and function @xmath109 is closed and convex on @xmath108 ( not necessarily differentiable ) .    in what follows",
    "we assume that @xmath107 is @xmath110-smooth on @xmath108 : @xmath111 we stress that the constant @xmath112 arises only in theoretical analysis and not in the actual implementation of the proposed method .",
    "moreover , we assume that the set @xmath108 is unbounded and that @xmath110 can be unbounded on the set @xmath108 .    the space @xmath87 is endowed with a norm @xmath113 ( which can be arbitrary ) .",
    "the corresponding dual norm is @xmath114 .",
    "for mirror descent , we need to introduce the bregman divergence .",
    "let @xmath115 be a distance generating function , i.e. a 1-strongly convex function on @xmath108 in the @xmath113-norm : @xmath116 then , the corresponding bregman divergence is defined as @xmath117    finally , we generalize the @xmath118 and @xmath119 operators from @xcite to composite functions : @xmath120      below is the proposed scheme of the new method .",
    "the main differences between this algorithm and the algorithm of @xcite are as follows : 1 ) now the @xmath118 and @xmath119 operators contain the @xmath121 term inside ; 2 ) now the algorithm does not require the actual lipschitz constant @xmath110 , instead it requires an arbitrary number @xmath122 can be always set to 1 with virtually no harm to the convergence rate of the method . ] and automatically adapts the lipschitz constant in iterations ; 3 ) now we need to use a different formula for @xmath123 to guarantee convergence ( see next section ) .",
    "@xmath124 : initial point ; @xmath125 : number of iterations ; @xmath122 : initial estimate of @xmath110 .",
    "@xmath126 , @xmath127 , @xmath128 @xmath129 @xmath130 @xmath131 @xmath132 @xmath133 @xmath134    @xmath135    note that algorihtm  [ alg : main ] if well - defined in the sense that it is always guaranteed that @xmath136 $ ] and , hence , @xmath137 as a convex combination of points from @xmath108 . indeed , from the formula for @xmath123 we have @xmath138 therefore @xmath139 .",
    "first we prove the analogues of lemma 4.2 and lemma 4.3 from @xcite .",
    "[ lem : first_lemma ] for any @xmath140 and @xmath141 we have @xmath142    from the first order optimality condition for @xmath143 we get @xmath144 therefore @xmath145 where the second inequality follows from the convexity of @xmath109 .    using the triangle equality of the bregman divergence ,",
    "@xmath146 we get @xmath147 where we have used @xmath148 in the last inequality .",
    "so we have @xmath149    define @xmath150 .",
    "then we have @xmath151 and @xmath152 due to convexity of @xmath109 . using this and the formula for @xmath153",
    ", we get @xmath154 here the last inequality follows from the definition of @xmath155 .    note that by the termination condition for choosing @xmath156 we have @xmath157 after rearranging : @xmath158 hence , @xmath159 finally , combining the previous estimates , we get @xmath160    [ lem : second_lemma ] for any @xmath140 and @xmath141 we have @xmath161    using convexity of @xmath107 and relation @xmath162 , we obtain @xmath163 now we apply lemma  [ lem : first_lemma ] to bound the last term , group the terms and get @xmath164 after rearranging , we obtain  .",
    "now we are ready to prove the convergence theorem for algorithm  [ alg : main ] .",
    "for the sequence @xmath165 in algorithm  [ alg : main ] we have @xmath166 and , hence , the following rate of convergence : @xmath167    note that the special choice of @xmath168 in algorithm  [ alg : main ] gives us @xmath169 therefore , taking the sum over @xmath170 in and using that @xmath171 , @xmath172 we get , for any @xmath140 , @xmath173 and is straightforward . at the same time , using the convexity of @xmath174 , the definition of @xmath175 , and @xmath176 , we obtain @xmath177 from   it follows that @xmath178 , so @xmath179 now it remains to estimate the rate of growth of coefficients @xmath180 .",
    "for this we use the technique from  @xcite . note that from   we have @xmath181 rearranging and using @xmath182 and @xmath183 , we get @xmath184 from this it follows that @xmath185 note that according to   and the stopping criterion for choosing @xmath156 in algorithm  , we always have @xmath186 .",
    "hence , @xmath187    thus , combining   and with @xmath188 , we have proved .",
    "using the same arguments to  @xcite , it is also possible to prove that the average number of evaluations of the function @xmath107 per iteration in algorithm  [ alg : main ] equals 4 .",
    "let @xmath189 be the total number of evaluations of the function @xmath107 in algorithm  [ alg : main ] after the first @xmath68 iterations .",
    "then for any @xmath190 we have @xmath191",
    "in this section , we apply algorithm  [ alg : main ] to solve the dual problem in @xmath192 with @xmath86 in the role of @xmath88 , @xmath193 in the role of @xmath174 , and @xmath194 in the role of @xmath195 .",
    "the inequality leads to the fact that algorithm  [ alg : main ] is primal - dual @xcite , which means that the sequences @xmath196 ( which is in the role of @xmath197 ) and @xmath198 ( which is in the role of @xmath199 ) generated by this method have the following property : @xmath200 @xmath201 } } + \\sum\\limits_{e\\in e } { \\sigma_e^\\ast(t_e ) } \\right\\}\\ ] ] @xmath202 where @xmath203 with @xmath204 being the total number of edges ( among all of the levels ) in the longest path for correspondence @xmath7 , @xmath205 @xmath206 is defined in theorem 2 , the method starts from @xmath207 , @xmath208 is a solution of the problem ( [ gas_eq2 ] ) .",
    "theorem 2 provides the bound for the number of iterations in order to solve the problem ( [ gas_eq2 ] ) with given accuracy .",
    "nevertheless , on each iteration it is necessary to calculate @xmath214 and also @xmath215 . similarly to @xcite it is possible to show , using the smoothed version of bellman  ford method , that for this purpose it is enough to perform @xmath216 arithmetic operations .    in general",
    ", it is worth noting that the approach of adding some artificial vertices , edges , sources , sinks is very useful in different applications @xcite .",
    "* acknowledgements . *",
    "the research was supported by rfbr , research project no . 15 - 31 - 70001 mol_a_mos and no .",
    "15 - 31 - 20571 mol_a_ved .",
    "gasnikov , a. , gasnikova , e. , matsievsky , s. , usik , i. : searching of equilibriums in hierarchical congestion population games .",
    "trudy mipt .",
    "28 , 129142 ( 2015 ) allen - zhu , z. , orecchia , l. linear coupling : an ultimate unification of gradient and mirror descent .",
    "arxiv preprint:1407.1537v4 ( 2014 ) nesterov , yu .",
    ": gradient methods for minimizing composite functions . math .",
    "140 , 125161 ( 2013 ) nesterov , yu . ,",
    "nemirovski , a. : on first order algorithms for @xmath217/nuclear norm minimization .",
    "acta numerica .",
    "22 , 509575 ( 2013 ) nesterov , yu . : universal gradient methods for convex optimization problems .",
    "core discussion paper 2013/63 ( 2013 ) nesterov , yu . : primal - dual subgradient methods for convex problems .",
    "b. 120 , 261283 ( 2009 ) nemirovski , a. , onn , s. , rothblum , u.g .",
    ": accuracy certificates for computational problems with convex structure . mathematics of operation research .",
    "35 , 5278 ( 2010 ) gasnikov , a. , dvurechensky , p. , kamzolov , d. , nesterov , yu . ,",
    "spokoiny , v. , stetsyuk , p. , suvorikova , a. , chernov , a. : searching for equilibriums in multistage transport models .",
    "trudy mipt .",
    "28 , 143155 ( 2015 ) gasnikov , a. , gasnikova , e. , dvurechensky , p. , ershov , e. , lagunovskaya , a. : search for the stochastic equilibria in the transport models of equilibrium flow distribution .",
    "trudy mipt .",
    "28 , 114128 ( 2015 ) ed .",
    "gasnikov , a. : introduction to mathematical modelling of traffic flows .",
    "mccme , moscow ( 2013 ) nesterov , yu . :",
    "characteristic functions of directed graphs and applications to stochastic equilibrium problems .",
    "engineering . 8 , 193214 ( 2007 ) gasnikov , a. : about reduction of searching competetive equillibrium to the minimax problem in application to different network problems .",
    "27 , 121136 ( 2015 ) babicheva , t. , gasnikov , a. , lagunovskaya , a. , mendel , m. : two - stage model of equilibrium distributions of traffic flows .",
    "trudy mipt .",
    "27 , 3141 ( 2015 ) vaschenko , v. , gasnikov , a. , molchanov , e. , pospelova , l. , shananin , a. : analysis of tariff policy of a railway cargo transportation .",
    "preprint of ccas ras ( 2014 )"
  ],
  "abstract_text": [
    "<S> in this paper , we consider a large class of hierarchical congestion population games . </S>",
    "<S> one can show that the equilibrium in a game of such type can be described as a minimum point in a properly constructed multi - level convex optimization problem . </S>",
    "<S> we propose a fast primal - dual composite gradient method and apply it to the problem , which is dual to the problem describing the equilibrium in the considered class of games . </S>",
    "<S> we prove that this method allows to find an approximate solution of the initial problem without increasing the complexity . </S>"
  ]
}