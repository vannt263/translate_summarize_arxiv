{
  "article_text": [
    "computational cell biology is a relatively new and rapidly growing field that uses modern computers and computational science to study microscopic biological phenomena .",
    "its primary objective is to quantitatively understand cellular behavior at the molecular level . because a large number of physical and chemical processes simultaneously take place in a cell , approximation methods that make use of finite computational resources are employed to mimic the processes .",
    "although molecular dynamics ( md ) , which calculates the atomistic behavior of molecules in a system , is a popular method for this purpose , it is frequently hampered by severe time restrictions @xcite .",
    "for example , millisecond - long calculations are still a challenge for md @xcite , whereas the typical time scale for cell signaling , such as the mitogen - activated protein kinase ( mapk ) cascade , which is thought to regulate transcription and tumor formation ranges from minutes to hours @xcite .",
    "alternatively , network biology uses dynamic systems , i.e. , conventional differential equations , to describe cell signaling pathways on the reaction networks between chemical species @xcite .",
    "although such an approximation drastically reduces the computational workload , network biology neglects spatial distribution , which compromises its real application as the diffusion rate significantly decreases in an extremely dense molecular environment in a phenomenon known as molecular crowding @xcite@xcite .",
    "in addition to the two methods above there is the lattice - based method , which is able to resolve the above - mentioned issues . in its early days , the lattice - based method employed diffusion - reaction or master equations to formulate the underlying physics and chemistry of a cell in explicitly discretized space and time @xcite @xcite @xcite @xcite .    diffusion and reactions are the two most fundamental processes in a cell , and partial differential equations ( pdes ) are insufficient to incorporate inherently discrete phenomena , such as molecular crowding . to overcome this shortcoming , fully discrete mechanics in a lattice with molecular resolution",
    "is preferred .",
    "this approach explicitly discretizes space with voxels that can be exclusively occupied by a single molecule .",
    "the diffusion process then is represented by molecules hopping around the voxels .",
    "a chemical reaction takes place when reactant molecules collide , and the reaction is treated in a fully discrete and stochastic manner . to be stochastically correct",
    ", it is desirable that voxels be as isotropic and equidistant as possible . to meet such a requirement , spatiocyte @xcite was created as part of the e - cell system @xcite , the aim of which was to offer a modeling and simulation environment for biochemical and genetic processes .",
    "spatiocyte employs random walks on a hexagonal close - packed lattice and a chemical master - equation based on monte carlo methods for chemical reactions .",
    "because parallel computation has become an indispensable tool in the scientific community , we developed a new program called `` pspatiocyte . ''",
    "pspatiocyte is a parallel implement of spatiocyte and has been written from scratch to optimize its use in parallel computers .",
    "the foremost goal of pspatiocyte is to realize faster and larger cell simulations particularly on a leadership supercomputer .",
    "several computer programs that can simulate reaction - diffusion of molecules in intracellular space at the particle level have been developed , for example , some using discrete particles in continuous space @xcite some others using discretized lattice space @xcite @xcite @xcite @xcite @xcite @xcite @xcite . to our knowledge , the work presented here is the first to report successful efficient simulations of particle reaction - diffusion systems with excluded volume effect to explicitly represent crowded nature of intracellular media to achieve scalability over a half million of cores on a distributed memory architecture .",
    "we present herein a parallel computational method that can perform calculations for a hexagonal close - packed lattice .",
    "we focus on the numerical implementation adopted by the method and show computational results with validations and estimations .",
    "we present our conclusion in the last section .",
    "cell signaling starts from the binding of a signaling molecule to a membrane receptor and the transmission of the signaling molecule to the cytoplasm .",
    "the signaling molecule finally reaches the nucleus after a myriad of spatial translations and molecular transformations .",
    "those processes can be mathematically formulated as diffusion - reaction equations from a coarse - grained point of view . the corresponding pdes model microscopic molecular behavior as diffusion and reaction processes on a macro scale and are a basis for simulating cell signaling . to solve pdes on digital computers under specific initial and boundary conditions , researchers usually use the finite difference method based on the cartesian coordinate system .",
    "however , it was recently found that the diffusion rates varied both locally and temporally depending on the circumstances , which makes conventional pdes with constant coefficients inapplicable .",
    "fully discrete algorithms are expected to overcome these shortcomings .",
    "monte carlo simulations model diffusion and reaction processes as a random walk of molecules and collisions between molecules .",
    "they also introduce a voxel as the fundamental element , which can be recognized as a box that holds a molecule .",
    "a cell is modeled as a collection of several groups of voxels called compartments .",
    "each molecule , e.g. , protein , should reside in one voxel , and no voxel is allowed to contain more than one molecule at a time .",
    "each molecule randomly moves to an adjacent voxel , and a reaction is set off once the voxel is occupied .",
    "monte carlo simulations sometimes result in stochastically incorrect calculations if the voxel arrangement is not taken into careful consideration .",
    "we therefore adopt a hexagonal close - packed lattice in terms of isotropy and equidistance . furthermore , to overcome the severe time restriction inherent in differential equations , we introduce an event scheduler to schedule various time steps optimally .",
    "chemical reactions are also treated in a fully discrete manner according to gillespie s method and the collins - kimball approach .",
    "in addition , enabling parallel monte carlo simulations requires improvements in inter - process communication and sampling order . in what follows",
    ", we describe these implementations in detail .",
    "the cartesian coordinate system is frequently used in simulations regardless of the research field .",
    "it has six nearest neighbors for each node , i.e. , voxel .",
    "however , the system is sometimes insufficient to suppress numerical noise inherent to a discretized system . to solve this problem , twelve of the second - nearest or eight of the third - nearest , i.e. , diagonal ,",
    "nodes are used . however , those higher order neighbors are located @xmath0 or @xmath1 times the distance from the origin compared with the nearest neighbors . in monte carlo simulations , assuming that the average velocity of a molecule is constant , the hopping duration should be longer as the distance increases . as a result",
    ", two or three intervals should be managed to incorporate such higher order neighbors .",
    "in addition , it is difficult to determine the equally distributed probabilities between distances consistently .",
    "moreover , enumeration of the angle is not an easy task .",
    "in contrast , a hexagonal close - packed ( hcp ) lattice has twelve nearest neighbors , twice as many as the cartesian coordinate system ( figure [ fig : hcp ] ) . from the viewpoint of spatial isotropy ,",
    "adjacent neighbors forming platonic solids are the most desirable .",
    "however , platonic solids except hexahedrons can not fill a three - dimensional space completely . although the hcp lattice does not form a platonic solid whereas the cartesian coordinate system forms a hexahedron , the neighbors of the hcp lattice are much more densely and uniformly arranged than those of the cartesian coordinate system .",
    "furthermore , it has been proven that no regular lattice has more densely packed adjacent neighbors than the hcp lattice .",
    "the average density of the hcp lattice is 74.048% , whereas that of the cartesian coordinate system is 52.359% . indeed , t. c. hales proved in 1998 that the hcp lattice is the most closely packed lattice @xcite .        generally , the number of neighbors is a prime concern when obtaining clean results in stochastic simulations .",
    "we therefore expect that the hcp lattice should serve as an ideal coordinate for monte carlo simulations @xcite .",
    "although the hcp lattice is a regular grid , some considerations are needed prior to the introduction of the coordinate axes . in crystallography ,",
    "a coordinate system based on a unit cell is usually used , but it is far less convenient for three - dimensional simulations on digital computers ( figure [ fig : unitcell ] ) . because the unit cell of the hcp lattice is markedly squished ,",
    "it is difficult to identify the coordinate of a specific neighbor in three - dimensional space . to worsen matters ,",
    "unnecessarily wide margins are sometimes required to house entire computational objects .",
    "in fact , even a data structure without a coordinate system is possible .",
    "for example , a one - dimensional chain of voxels , such as an unstructured grid , may work .",
    "in this case , each voxel should have pointers to its neighbors .",
    "however , indirect memory access to load the data sometimes adversely impacts efficiency .",
    "in addition , an unstructured grid could still be inconvenient for a transformation , such as decomposition or merger , of arbitrary parts of an object .        to overcome these difficulties , we propose a unique coordinate system called the twisted cartesian coordinate system , which comprises a straight axis and two zigzag axes .",
    "although it may seem awkward , the twisted cartesian coordinate system actually works well when identifying nearest neighbors .",
    "we have used this coordinate system for parallelization @xcite .",
    "recently a similar device was applied for cellular automata in two dimensions @xcite .",
    "figure [ fig : twist ] illustrates how a specific neighbor is identified .",
    "one of two procedures should be correctly used according to the even or odd layers in the k- and j - axes .",
    "the twisted cartesian coordinate system can be readily mapped onto a conventional cartesian coordinate system without almost any modification .",
    "further , its similarity to ordinal cartesian coordinate systems gives programmers great relief and ease .",
    "therefore , we expected that the twisted cartesian coordinate system be suitable to define multi - domain computational objects in an hcp lattice . in practical domain decomposition , we always restrict the number of voxels in each axis to an even number for simplicity .",
    "readers should note that the restriction is not substantial and that an odd number of voxels is also possible theoretically .",
    "however , such a generalization requires exhaustingly complicated considerations of the boundaries and is cumbersome .",
    "another limitation for practical use is the lack of descriptions of flat boundaries along the zigzag axes .",
    "however , this constraint is negligible for molecular scale applications .",
    "recently , we also found the way to apply the twisted cartesian coordinate for face - centered cubic ( fcc ) which has the same density as hcp and is closer to spherical symmetry than hcp , see figures in appendix 1 and 2 for detail .      in a typical numerical simulation , forward and backward finite differences are frequently employed for integration in time , which provides a straightforward and suitable approach to problems formulated with pdes . in the course of integration , the time interval used should normally be as large as possible to fulfill stability conditions .",
    "nevertheless , the finite difference method intrinsically manages a single time interval throughout the calculation although a number of characteristic time intervals likely exist in the problem .",
    "eventually , the smallest characteristic time interval that fulfills the stability conditions is chosen in practice .",
    "however , stability conditions frequently impose severe limitations on the calculation of physically interesting phenomena . to alleviate such limitations , which are apt to occur in mathematically stiff problems , the operator splitting technique is usually incorporated , in which difference operators and variables are artificially split and separately treated in their numerically stable range .",
    "in contrast to pdes , monte carlo methods can naturally realize multi - time scale procedures .",
    "suppose molecules of different chemical species reside in some voxels .",
    "as seen in the next section , each chemical species has its own characteristic time to hop into one of the neighboring voxels , which is dependent on its weight . a straightforward way to realize random",
    "walking is to choose a molecule of a specific chemical species randomly and let it hop from one voxel to another .",
    "note that molecules of the same species can be processed asynchronously , whereas molecules of different species can be processed only in chronological order .",
    "regarding reactions , no matter how complex a reaction , it can be decomposed into a series of elementary reactions .",
    "generally , each elementary reaction is classified into two types : first - order , in which a single molecule spontaneously changes its species or decays into multiple molecules , and second - order , in which two molecules collide and then transform into another species or coalesce to form a single molecule .",
    "one should keep in mind that each elementary reaction has a specific time interval similar to multi - species diffusion .    in our program ,",
    "a first - order reaction is processed every diffusion event whereas a second - order reaction is treated as an independent event .",
    "therefore , the event scheduler should keep track of diffusion and second - order reaction events .",
    "our scheduler is written in c++ language and is programmed to arrange multiple events correctly and quickly supply the latest event at any moment @xcite . in practice , one should register the time intervals of all diffusion events as the first time .",
    "the event scheduler interprets events as a thread and arranges them in chronological order .",
    "note that only a master process owns a scheduler .",
    "in the course of calculation , the master process determines the event to be taken every moment and distributes information to the worker processes .",
    "workers interpret the received information and perform accordingly .",
    "as we mentioned above , in monte carlo simulations , the diffusion process is interpreted as numerous consecutive steps of a randomly walking molecule .",
    "the hopping frequency and distance should be consistent with the diffusion coefficients of pdes on the macro scale .",
    "the following equation assures the consistency @xmath2 this equation is called the einstein - smoluchowski equation , which is named after the two prominent pioneers who derived it in the early twentieth century . in appendix 3",
    ", we reproduce an alternative derivation of this equation from the point of stochastic differential equation view .",
    "it is also the simplest example of a general fluctuation - dissipation theorem .",
    "physically , @xmath3 can be understood as the mean distance a molecule can travel in a given time interval .",
    "taking @xmath3 as the voxel diameter , @xmath4 can be interpreted as the mean time @xmath5 each molecule takes to move in adjacent voxel .",
    "@xmath6 where @xmath7 denotes voxel radius . eventually , @xmath5 is equal to the time interval between diffusion events .",
    "it should be noted that the time interval derived herein differs according to chemical species .",
    "therefore , the diffusion process should be processed for each species .    to understand what is taking place during program execution , suppose an event scheduler returns a diffusion event of the @xmath8-th species .",
    "then , an adjacent voxel is randomly chosen for each molecule of species @xmath8 , and each molecule moves to the chosen voxel only if the voxel is vacant .",
    "this movement fails if the voxel is already occupied by another molecule or if the voxel is in a different compartment , e.g. , membrane .",
    "molecules are processed one by one in dictionary order .",
    "the processing order of molecules matters theoretically , but practically the difference is always negligibly small .",
    "furthermore , this asynchronous property is indispensable for the parallel processing of stochastic calculations .",
    "finally , the next diffusion time is updated by adding @xmath5 to the current time .      normally , no matter how complicated a chemical reaction , it can be generally decomposed into elementary reactions that obey the simple law of mass action . recall that an elementary reaction is set off by collisions between reactants .",
    "because the probability of more than three molecules meeting somewhere at a time is thought to be infinitesimally small , considering only two reactants often suffices .",
    "a single reactant may spontaneously transform into another molecule or decay into multiple molecules after a specific duration .",
    "in contrast , two reactants may coalesce into one or decay into multiple molecules .",
    "these reactions are called first- and second - order reactions , respectively .",
    "the first - order reaction occurs independent of a collision , whereas the second - order reaction is dependent .",
    "consequently , the second - order reaction is a diffusion - influenced process .",
    "therefore , we should realize these reactions numerically by using different procedures according to their underlying physics .",
    "note that the number of products could be more than three and is limited to less than twelve , @xmath9 , the number of nearest neighbors , in our method . in an extreme situation ,",
    "eleven neighbors could be already occupied and no reaction would take place .",
    "this condition is highly unlikely and can be avoided by introducing a multi - stage reaction that decomposes a multi - product reaction into a cascade of bi - product reactions .",
    "another factor to consider is the voxel size .",
    "when the voxel is too large compared with the molecular size , exclusive volume is overestimated .",
    "consequently , the reaction rate would be underestimated .",
    "we employed gillespie s algorithm with slight modification for a given duration to realize a first - order reaction numerically @xcite .",
    "the algorithm can reproduce a stochastically correct law of mass action . in this method , called gillespie s direct method , a species dependency table is prepared from a directed graph of species .",
    "suppose the following chemical formula , @xmath10 the propensity is calculated for each reaction with the concentration of reactant species as follows : @xmath11 where @xmath12 and @xmath13 are propensity and the concentration of species a , respectively .",
    "in every diffusion event , the propensities of the provided first - order reactions are calculated , and the probability @xmath14 that any first - order reaction is fired can be calculated , as follows : @xmath15 where @xmath16 , @xmath17 , @xmath18 , @xmath19 , and @xmath20 denote total propensity , propensity of the @xmath8-th first - order reaction , the number of provided first - order reactions , current time , and time of the previous diffusion event , respectively . if a random number drawn from [ 0;1 ] is larger than @xmath14 , one of the first - order reactions is fired .",
    "we determine the @xmath21-th first - order reaction that satisfies the following condition : @xmath22 where @xmath23 denotes a random number drawn from [ 0;1 ] .",
    "after the selected @xmath21-th first - order reaction is fired , species related to the fired reaction are processed .",
    "a reactant is eliminated from the voxel where it has resided and products are created . in the case of a single product , the created product is located in the same voxel where the reactant had resided .",
    "if there are multiple products , the program tries to find adjacent vacant voxels .",
    "the reaction is a success if sufficient voxels are found ; otherwise , it is a failure .",
    "the concentrations of the eliminated reactant and product(s ) created by the reaction are updated .",
    "in addition , propensities depending on the updated species are recalculated by consulting the dependency table .",
    "this method can reduce computational operations for updating , which requires load and store operations between the register and the main memory , and are very time - consuming , thus leading to enhanced system performance .      to realize a diffusion - influenced reaction",
    ", we employ the collins - kimball approach @xcite in a discretized fashion .",
    "suppose a second - order reaction between species a and b , @xmath24 a molecule of species a collides somewhere with a molecule of species b. the probability @xmath25 of setting off a reaction is expressed as : @xmath26 after some manipulation @xcite .",
    "collisions may occur in the midst of the diffusion process in our program .",
    "eventually , second - order reactions are executed as part of the diffusion event with the above probability .",
    "suppose a molecule of species @xmath27 moves to one of its adjacent voxels .",
    "if that voxel is vacant , the diffusion succeeds ; otherwise , collision occurs .",
    "a molecule in a target voxel reacts with species @xmath27 only if the chemical formula between the molecules is registered in the reaction table .",
    "pspatiocyte is written in c++ language @xcite in accordance with object - oriented programming and is markedly reliant on the standard template library ( stl ) @xcite .",
    "it also borrows a pseudo - random number generator based on the merssene - twister algorithm @xcite .",
    "in addition , c++ bindings of the message passing interface ( mpi ) version 2.2 are used to enable inter - process communication @xcite .",
    "thread parallelism through the openmp interface version 3.0 @xcite is also introduced to enable hybrid parallelism .",
    "domain decomposition and a master - worker model are employed as the fundamental framework of our program .    the most difficult problem inherent to parallel stochastic simulations , such as the monte carlo method ,",
    "is maintaining consistency on each domain boundary .",
    "processes should be always aware of ghost voxels residing in adjacent processes .",
    "suppose a molecule moves beyond the boundary . the vacancy of the voxel on the opposite side should be examined .",
    "if the voxel is vacant , it must be blocked immediately to enable mutual exclusion between involved processes . because many molecules are moving around simultaneously on both sides , maintaining",
    "the consistency of every ghost voxel is a formidable task .",
    "busy waiting is a possible straightforward solution to mutual exclusion .",
    "unfortunately , it works only for two alternating processes and prevents a process from reading the voxel consecutively .",
    "a standard solution to randomly accessing two parties is known as peterson s algorithm @xcite .",
    "because multiple threads may access a voxel in a diagonal ghost , the algorithm should be improved for application to a multi - party environment . to make matters worse ,",
    "inter - process communication is required every time a molecule moves beyond the boundary . as a result",
    ", many mpi calls carrying short messages would only waste latency times .    alternatively , a rolling back strategy can be used .",
    "however , this approach cancels the movement sequence .",
    "such a sequence tends to bifurcate many times , propagates upstream beyond the boundary , and rapidly piles up until it becomes difficult to track . generally compromising local modification and global consistency",
    "is a difficult problem .",
    "therefore , we loosened the complete consistency somewhat to enable parallel calculations .",
    "suppose an hcp lattice on each process forms a cube projected on a cartesian coordinate system .",
    "we further divide the cube into octal cubes called sub - volumes .",
    "one can easily find that there are @xmath28 ways to reorder these sub - volumes .",
    "overall , the baseline procedure of our program is as follows :    1 .   identify a sub - volume to be processed randomly , 2 .",
    "obtain data in ghost regions from adjacent processes , 3 .",
    "do monte carlo calculations , 4 .",
    "move to the next time step if all sub - volumes are processed ; otherwise jump back to 1 .",
    "each process calculates the same sub - volume at the same time .",
    "sub - volumes and ghost regions are illustrated in figure [ fig : subvolume ] .",
    "note that each sub - volume in the calculation is located remotely at any time , and the ghost voxels remain intact by adjacent processes .",
    "although mutual exclusion is naturally realized by this method , inter - process communication should be executed eight times for each step . however , this method of mutual exclusion does not necessarily mean that eightfold communication times are required , because the number of voxels to be sent or received is also reduced in proportion to the surface area .",
    "we have confirmed the effectiveness of our method in at least a few thousand processes @xcite .",
    "another problem common to lattice - based parallel calculations is diagonal communication .",
    "some ghost voxels sometimes locate in diagonally adjacent processes . in that case",
    ", one process should communicate with the other twenty - six processes surrounding it .",
    "generally , latency has an impact on short communication .",
    "in addition , contention between requests tends to occur due to the limited number or bandwidth of the communication channels . from the viewpoint of strong scaling ,",
    "such a communication strategy will show poor performance for a larger number of processes . to overcome such constraints , we employ interlocking tri - phase communication ( fig . [",
    "fig : triphase - comm ] ) , which is found in conventional literature @xcite . by using this method",
    ", each node suffices to communicate with six directly adjacent processes in three consecutive phases . to apply the method to our program , we further modified it so that it would fit octal sub - volume configurations .",
    "finally , reactions have little impact on performance since they are far fewer than diffusion events ..            as for thread level parallelization , straightforward implementation to avoid competing access to specific voxel employs critical clause from openmp interface . however it generally suffers poor performance even in a case of few threads since threads are apt to fall in an idle state at the entrance of critical section . to address this issue",
    ", we propose the voxel - locking technique which locks every voxel independently with openmp runtime routines @xmath29 , @xmath30 , @xmath31 and @xmath32 as shown in fig . [ fig : voxellock ] .",
    "although it may require millions of lock variables , each variable consumes just a small amount of byte . therefore the impact on memory system",
    "is limited .",
    "to prove the physical correctness of pspatiocyte , we validated diffusion and reaction processes .",
    "parallel performances were also examined across thousands of computational cores .",
    "finally , calculation of a simplified mapk model is shown as a preliminary result and an example of real - world applications .",
    "all calculations discussed below were performed on the k computer @xcite .",
    "we first validated the dependence of the diffusion rates .",
    "the mean squared displacement ( msd ) from the origin against time was predicted by the random walk theory as @xmath33 which is derived from the einstein - smoluchowski equation . to confirm the reliability of the dependence of the diffusion rates",
    ", we monitored a single test molecule in a @xmath34 lattice with voxels measuring @xmath35 nm in radius .",
    "no other molecules existed in the lattice .",
    "then we performed random walks repeatedly under the same initial conditions and environments aside from random number seeds . in those calculations ,",
    "variance , @xmath36 was determined from a given @xmath37 as shown in appendix 3 .",
    "one thousand random walks were generated .",
    "each walk was terminated when it reached a boundary .",
    "finally , the average locations were taken from the ensembles .",
    "figure [ fig : diffusion ] shows the log - log plots of the results for three diffusion rates .",
    "the slopes , the vertical distances , and the absolute values coincide with theory .",
    "isotropy was found to have fairly good agreement at least for one thousand ensembles .",
    ", @xmath38 , and @xmath39 and theoretical results , respectively.,width=249 ]    the diffusion rates are thought to decrease under the crowding condition . to prove that pspatiocyte is able to predict diffusion rates , we calculated msd for three different occupancies of molecules .",
    "8 shows the results . a significant decrease of the diffusion rate corresponding to an increase in the number of crowding molecules is clearly observed .",
    "note that standard diffusion theory is based on the assumption that molecules are infinitesimally small and move around without collision .",
    "finite size effects , such as volume exclusion , are not captured by the theory .",
    "as we mentioned earlier , the underlying physics of the first- and second - order reactions are different , thus we validated them separately using simplified irreversible and reversible reactions .      a first - order reaction primarily models auto decay , such as dissociation .",
    "a reaction involving two products is typical and is written in a chemical formula as follows : @xmath40 the first - order reaction is a one - way ( i.e. , irreversible ) reaction , and its propensity depends on a single reactant .",
    "as long as the accompanying rate equation holds , the reaction can be solved analytically as follows : @xmath41 & = & [ \\mathrm{a}_0 ] \\exp \\left ( -kt \\right ) \\cr [ \\mathrm{b}_t ] & = & [ \\mathrm{b}_0 ] + [ \\mathrm{a}_0 ] \\left ( 1 - \\exp \\left ( -kt \\right ) \\right ) \\cr [ \\mathrm{c}_t ] & = & [ \\mathrm{c}_0 ] + [ \\mathrm{a}_0 ] \\left ( 1 - \\exp \\left ( -kt \\right ) \\right),\\end{aligned}\\ ] ] where brackets and subscripts stand for species concentration and time , respectively .",
    "one should keep in mind that the rate equation holds only for low concentrations .",
    "propensities are expected to be less than the law of mass reaction under the crowding condition because of the scarcity of free space in the surroundings .",
    "we calculated three different reaction rates within the dilute realm and compared the results with theory .",
    "the parameters used in the calculation were @xmath42 and @xmath43 .",
    "the initial numbers of molecules of species @xmath27 , @xmath44 and @xmath45 were 64,000 , 0 and 0 , respectively , and lattice size was @xmath34 .",
    "the results are shown in figure [ fig : firstorder ] .",
    "good agreement was observed for each case , however , validation of the denser case was necessary for reliable cell signaling simulation . for the time being , the results of pspatiocyte agree with those of our precedent program , spatiocyte @xcite , despite ambiguity in the probability estimation .",
    "a second - order reaction is fundamentally diffusion - influenced because it is set off by reactants colliding .",
    "for simplicity , we considered a single product instead of bi - products as the simplest example of a reversed reaction : @xmath46 where @xmath47 and @xmath48 denote forward and backward reaction rates , respectively .",
    "unfortunately , no closed - form analytical solution convenient for comparison is available even for the simple formula above .",
    "therefore , we used our serial program , spatiocyte @xcite , as a measure . the parameters used were @xmath49 and @xmath50 .",
    "the initial numbers of molecules of species a , b and c were 0 , 0 and 64,000 , respectively , and the lattice size was @xmath51 .",
    "the results are shown in figure [ fig : secondorder ] with the temporal axis plotted in logarithmic scale to examine changes in detail .",
    "good agreement is noted between the results of the two programs .",
    "note that the reaction is diffusion - influenced in the case of low concentration , such as this example .",
    "therefore , the observed reaction rate was expected to be lower than that predicted by the law of mass action . in the case of high concentration",
    ", the reaction rate will increase gradually to the value the law of mass action predicts .          to estimate the parallel performance of our program ,",
    "we compared real time from the point of view of strong and weak scaling .",
    "strong scaling measures how fast a program is able to process specific problems by parallelization . on the other hand , weak scaling measures",
    "how large of a problem a program is able to handle without loss of speed .    for strong ( i.e. , intensive ) scaling ,",
    "three resolutions according to the voxel radius were used to measure performance . provided that the physical dimensions of a cell remain the same",
    ", a smaller voxel would serve as a finer lattice .",
    "we denoted voxels having 10 , 5 , and 2.5 nm radii as coarse , intermediate , and fine lattices , respectively .",
    "the parameters and conditions were the same as those of the diffusion cases in the previous section , except for lattice size and occupancy .",
    "occupancy was fixed at 30% in this section , and the the whole lattice size was @xmath52(coarse ) , @xmath53(intermediate ) or @xmath54(fine ) except fot calculations using 663552 cores , the largest number of available cores on k computer , in which we used @xmath55 ( coarse ) , @xmath56 ( intermediate ) or @xmath57 ( fine ) lattices to make it conform with the physical configuration of nodes .",
    "notice that we examined relative speedup rates instead of bare flops since a large part of the calculation was spent in integer or logical instructions .",
    "the speedups measured from the elapsed times are shown in fig .",
    "[ fig : strong ] . in this figure",
    ", we took the result of the coarse lattice with 64 cores as the denominator as simulation with less cores was not possible due to memory restriction .",
    "for intermediate and fine lattices , data of 64 cores were extrapolated from consumed time per voxel of coarse lattice .",
    "in addition , parallel efficiencies of strong scaling are also summarized in fig .",
    "[ fig : strongefficiency ] . for the fine lattice with 663552 cores , speedup of 7686 times was achieved .",
    "parallel ( strong ) efficiency of that case was 74.1% .",
    "in contrast , the other , especially coarse , lattice shows conspicuous separation from the ideal curve .",
    "to identify the cause of deterioration , we closely figured out the components of elapsed time of coarse lattice as shown in fig .",
    "[ fig : component ] . in this figure",
    ", we find that initialization , calculation , pack and unpack times kept decreasing at least up to 262144 cores while mpi time saturated and overwhelmed others over 32768 cores .",
    "constant duplication time due to redundant duplication of communicator object should be eliminated by sophisticated programming in the next version . as a result ,",
    "saturation of mpi time is thought of as the most significant factor to improve scaling further .",
    "however , saturation of that kind generally originates from the latency of inter - node communication which is specific to hardware or firmware .",
    "consequently , all we can do to improve strong scaling is to decrease calculation time as close to latency as possible . in this sense ,",
    "deterioration observed here is inevitable and beyond programming effort .",
    "lastly , by extrapolating from the discussion above , we can predict the speedup and efficiency of fine lattice would be around 13000 times and 40% if two millions of cores were employed .",
    ", @xmath53 , and @xmath54 voxels , respectively.,width=268 ]    .,width=307 ]        in terms of weak ( i.e. , extensive ) scaling , fig .",
    "[ fig : weak ] shows the elapsed time per voxel per step .",
    "labels , smallest , smaller , medium , larger or largest , in the figure indicate that the lattice on each node is @xmath58 , @xmath59 , @xmath60 , @xmath61 or @xmath62 . for any lattice size , those times should be identical ( i.e. independent of the number of cores ) if weak scaling is completely accomplished . in spite of variation in absolute value ,",
    "all data sequences in the figure show good scaling properties . as for smallest and smaller lattices , scrutinizing the element of elapsed time revealed that constant time originated from latency overwhelmed calculations .",
    "this explains the cause of larger time in absolute value compared to the other lattices .",
    "parallel efficiencies for weak scaling are summarized in fig .",
    "[ fig : weakefficiency ] . in the figure ,",
    "elapsed time of 64 cores was used as the denominator for each lattice .",
    "although efficiencies tend to deteriorate for high number of cores , at least 60% of efficiency was accomplished up to more than a half million cores .    ,",
    "@xmath60 , @xmath61 , @xmath62 , and @xmath52 voxels per process , respectively.,width=307 ]    .,width=307 ]    elapsed times of @xmath63 voxels with 96 cores are shown in fig . [",
    "fig : thread ] .",
    "molecular occupancy is set as 0.3 and 1000 steps are calculated .",
    "here the focus is on the effect of thread parallelization . here",
    "the focus should be on the effect of thread parallelization so that mpi times are not important .",
    "with openmp critical function , pack time decreases according to the number of cores while calculation time increases .",
    "after all , total elapsed time increases . on the other hand , object locking technique shows a decrease in both pack and calculation times .",
    "however , there is an obvious saturation in performance as seen in the figure . apart from init and mpi times ,",
    "the remaining time with eight threads is just four times faster than that with a single thread . considering",
    "actual contention rarely occurs for this occupancy of molecules , we suspect the reason of underperformance is due to the overheads inherent in openmp .          as a preliminary example of real - world application , we performed parallel calculation of the mapk model , a typical network motif in cell signaling pathways . because complete cell signaling pathways are very huge networks @xcite , we made the pathway as simple as possible without any loss of essential parts . in the mapk model",
    ", mapk is doubly phosphorylated by mapk kinase ( mapkk ) and doubly dephosphorylated by phosphatase ( pase ) .",
    "this model consists of nine chemical species and twelve reactions as formulated in the following .",
    "@xmath64 the initial conditions and the kinetic parameters were @xmath65 , @xmath66 , @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath71 and @xmath72 .",
    "the initial concentrations of mapk , mapkk and pase were@xmath73 , @xmath74 and @xmath74 , respectively .",
    "the lattice size and its physical volume were @xmath75 and @xmath76 . in the chemical formulas above",
    ", the prefixes p and pp stand for singly and doubly phosphorylated mapk , respectively .",
    "it is a rather simple model , and the parameters are based on experimental data from @xcite . in the calculation , the molecules of all species were assumed to be initially distributed homogeneously for simplicity .",
    "all calculations were carried out with 4,096 cores ( 2,048 processes , two threads per process ) and required approximately 16 hours ( 57,600 seconds ) .",
    "figure [ fig : mapk ] shows ppmapk fractions relative to total mapk concentrations during a thirty - second period for various initial fractions of phosphatase . although there is still room for quantitative scrutiny , the dependence on the parameters and the behavior of the variation agree with experimental results at least qualitatively . calculations with larger pathways , longer durations , and membrane structures",
    "are under way .",
    "we proposed a parallel stochastic method to calculate cell signaling in a hexagonal close - packed lattice . to realize large - scale parallel calculations , several improvements , including a twisted cartesian coordinate system , an event scheduler , random sub - volumes and a voxel - locking technique , were introduced .",
    "we also validated the physical correctness of the program .",
    "the calculated diffusion rates without crowding coincided with theory within negligibly small error . under the crowding condition , the diffusion rates decreased , as expected by theory . the first - order reaction agreed well with theory , and",
    "the second - order reaction agreed with our well - validated serial program .",
    "parallel performance was sufficiently high for large - scale calculations .",
    "from the viewpoint of strong scaling , our program achieved 7686 times speedup in the case of 663552 cores relative to 64 cores with a @xmath54 lattice .",
    "its efficiency was equal to 74.1% . in terms of weak",
    "scaling , efficiencies at least 60% were obtained .",
    "voxel - locking technique was shown to work well to parallelize randomly accessing loops .",
    "in addition , a preliminary calculation of the mapk model revealed that the program is promising for application to real problems .",
    "last but not least , twisted cartesian coordinate also enables calculations of three dimensional lattice gas automata and d3q13 model in lattice boltzmann methods besides conventional models such as d3q15 , d3q19 or d3q27 .",
    "this research is part of the hpci strategic program for innovative research in supercomputational life science ( spire field 1 ) , which is funded by the ministry of education , culture , sports , science and technology ( mext ) , japan .",
    "part of the results were obtained by using the k computer at riken advanced institute for computational science ( proposal number hp120309 ) .",
    "we would like to thank yukihiro eguchi for continuous encouragement ; and peter karagiannis and kylius wilkins of qbic for reading the manuscript and making valuable comments .",
    "finally , first auther wish to thank hisashi nakamura of rist for giving him the opportunity to start this research .",
    "10    m.  p. allen and d.  j. tildesley . .",
    "clarendon press , new york , 1989 .",
    "d.  e. shaw , r.  o. dror , j.  k. salmon , j.  p. grossman , k.  m. mackenzie , j.  a. bank , c.  young , m.  m. deneroff , b.  batson , k.  j. bowers , e.  chow , m.  p. eastwood , d.  j. ierardi , j.  l. klepeis , j.  s. kuskin , r.  h. larson , k.  l - larsen , p.  maragakis , m.  a. moraes , s.  piana , y.  shan , and b.  towles .",
    "millisecond - scale molecular dynamics simulations on anton . in _ international conference for high performance computing , networking , storage and analysis _ , portland , or ,",
    "november 2009 .",
    "acm / ieee .",
    "j.  j. hornberg , b.  binder , f.  j. bruggeman , b.  schoeberl , r.  heinrich , and h.  v. wsterhoff .",
    "control of mapk signalling : from complexity to what really matters .",
    ", 24:55335542 , 2005 .",
    "e.  klipp , w.  liebermeister , c.  wierling , a.  kowald , h.  lehrach , and r.  herwig . .",
    "wiley - vch , weinheim , 2009 .",
    "a.  fulton .",
    "how crowded is the cytoplasm ?",
    ", 30(2):345347 , 1982 .",
    "a.  minton .",
    "the influence of macromolecular crowding and macromolecular confinement on biochemical reactions in physiological media .",
    ", 276(14):1057710580 , 2001 .",
    "s.  p. dawson , s.  chen , and g.  d. doolen .",
    "lattice boltzmann computations for reaction - diffusion equations . , 98(2):15141523 , 1993 .",
    "j.  schaff , c.  c. fink , b.  slepchenko , j.  h. carson , and l.  m. loew . a general computational framework for modeling cellular structure and function .",
    ", 73(3):11351146 , 1997 .",
    "m.  ander , p.  beltrao , b.  d. ventura , j.  ferkinghoff - borg , m.  foglierini , m.  kaplan , c.  lemerle , i.  toms - oliveira , and l.  serrano .",
    "smartcell , a framework to simulate cellular processes that combines stochastic approximation with diffusion and localisation : analysis of simple networks .",
    ", 1(1):129138 , 2004 .",
    "r.  roberts , j.  e. stone , and z.  luthhey - schluten .",
    "lattice microbes : high - performance stochastic simulation method for the reaction - diffusion master equation . , 34(3):245266 , 2013 .",
    "s.  n.  v. arjunan and m.  tomita .",
    "a new multicompartmental reaction - diffusion modeling method links transient membrane attachment of e. coli mine to e - ring formation .",
    ", 4(1):3553 , 2010 .",
    "m.  tomita , k.  hashimoto , k.  takahashi , t.  s. shimizu , y.  matsuzaki , f.  miyoshi , k.  saito , s.  tanida , k.  yugi , j.  c. venter , and c.  a. hutchison iii .",
    ": software environment for whole - cell simulation .",
    ", 15(1):7284 , 1999 .",
    "j.  r. stiles , t.  m. bartol , m.  m. salpeter , and e.  e. salpeter , and t.  j. sejnowski .",
    "synaptic variability , new insights from reconstructions and monte carlo simulations with mcell . in _",
    "synapses _ , johns hopkins university press , baltimore , 2001 .",
    "s.  s. andrews , n.  j. addy , r.  brent , and a.  p. arkin .",
    "detailed simulations of cell biology with smoldyn 2.1 . , 6(3):1000705 , 2010 .",
    "l.  boulianne , s.  a. assaad , m.  dumontier , and w.  gross .",
    "gridcell : a stochastic particle - based biological system simulator .",
    ", 2(1):66 , 2008 .",
    "n.  l. novre and t.  s. shimizu .",
    ": modelling of stochastic biomolecular processes . , 17(6):575576 , 2001 .    c.  sanford , m.  l.  k. yip , c.  white , and j.  parkinson .",
    "ell++ simulating biochemical pathways .",
    ", 22(23):29182925 , 2006 .",
    "d. ridgway , g. broderic , a , lopez - campistrous , m. ruini , p. winter , m. hamilton , p. boulanger , a. kovalenko , and m.  j. ellison .",
    "coarse - grained molecular simulation of diffusion and reaction kinetics in a crowded virtual cytoplasm .",
    ", 94:3748 - 3759 , 2008 .",
    "m.  j. byrne , m.  n. waxham , and y.  kubota .",
    "cellular dynamic simulator : an event driven molecular simulation environment for cellular physiology . , 8(2):6382 , jun 2010 .",
    "j.  n.  f. schneberg .",
    "readdy - a software for particle - based reaction - diffusion dynamics in crowded cellular environments .",
    ", 8(9):74261 , 2013 .",
    "g.  g. szpiro . .",
    "wiley , new york , 2003 .",
    "s.  n.  v. arjunan , a.  miyauchi , and k.  takahashi . a high - performance microscopic lattice reaction - diffusion method for biochemical network simulation . in _ the second bio - supercomputing symposium _ ,",
    "tokyo , march 2010 . riken .",
    "s.  szkoda , z.  koza , and m.  tykierko .",
    "accelerating cellular automata simulations using avx and cuda . , aug 2012 .",
    "k.  takahashi , k.  kaizu , b.  hu , and m.  tomita , a multi - algorithm , multi - timescale method for cell simulation .",
    ", 20(4):538546 , 2004 .",
    "d.  t. gillespie . a general method for numerically simulating the stochastic time evolution of coupled chemical reactions .",
    ", 22:403434 , 1977 .",
    "f.  c. collins and g.  e. kimball .",
    "diffusion - controlled reaction rates .",
    ", 4(4):425437 , 1949 .",
    "b.  stroustrup .",
    "addison - wesley , new york , 2013 .",
    "s.  meyers . .",
    "addison - wesley , new york , 2001 .",
    "m.  matsumoto and t.  nishimura .",
    "mersenne twister : a 632-dimensionally equidistributed uniform pseudorandom number generator .",
    ", 8:330 , 1998 .    . ,",
    "september 2009 .",
    "http://mpi-forum.org/docs/mpi-2.2/mpi22-report.pdf .",
    ". , may 2008 .",
    "http://www.openmp.org/mp-documents/spec30.pdf .",
    "a.  s. tanenbaum .",
    "prentice hall , new jersey , 2007 .",
    "g.  h. golub and j.  m. ortega . .",
    "academic press , new york , 1993 .",
    "a.  yonezawa , t.  watanabe , m.  yokokawa , m.  sato , and k.  hirao .",
    "advanced institute for computational science ( aics ) : japanese national high - performance computing research institute and its 10-petaflops supercomputer k. in _ international conference for high performance computing , networking , storage and analysis _",
    ", seattle , wa , november 2011 .",
    "acm / ieee .",
    "k.  takahashi , s.  t - nicola , and p.  r. ten wolde .",
    "spatio - temporal correlations can drastically change the response of a mapk pathway .",
    ", 106(6):24732478 , 2010 .",
    "s.  shreve . .",
    "springer , new york , 2008 .",
    "mathematically , an infinitesimal limit of a random walk can be formulated as a wiener process . the traveling distance @xmath77 in three - dimensional space in time interval @xmath78 can be written in general by a stochastic differential equation ( sde ) as @xmath79 where @xmath80 , @xmath36 , and @xmath81 denote drift , variance , and the three - dimensional wiener process , respectively .",
    "characters in boldface indicate three - dimensional vectors .",
    "the wiener process is a mathematically defined stochastic variable that starts from the origin and obeys a normal distribution . in the case of the diffusion equation , drift and",
    "variance parameters are considered constants . without any loss of generality",
    ", we can assume that @xmath82 .",
    "consequently , eq . ( [ eq : sde1 ] )",
    "can be integrated in the sense of the ito integral as @xmath83 note that the average and the covariance of the three - dimensional wiener process are defined as : @xmath84 = { \\bf 0 } , \\quad e[{\\bf w}_t^2 ] = 3 t , \\label{eq : average1}\\ ] ] where @xmath85 stands for expectation over the ensembles .",
    "applying eq .",
    "( [ eq : average1 ] ) to eq . ( [ eq : sde2 ] ) , the average and the covariance of @xmath86 can be readily found , @xmath87 = { \\boldsymbol \\mu } t , \\quad e[{\\bf x}_t^2 ] = \\mu^2 t^2 + 3\\sigma^2 t. \\label{eq : expect}\\ ] ] since @xmath4 is a deterministic variable , it does not affect the expectation .",
    "on the other hand , macroscopically , the kolmogorov forward equation , sometimes known as the fokker - planck equation , is also formally derived from the given sde as @xmath88 where @xmath89 denotes a probabilistic distribution that evolves from the initial distribution of molecules @xcite . comparing this equation with the diffusion equation considered in this paper , @xmath90",
    "we immediately find the following relations , @xmath91 substituting eq .",
    "( [ eq : coef ] ) into eq .",
    "( [ eq : expect ] ) gives @xmath87 = { \\bf 0 } , \\quad e[{\\bf x}_t^2 ] = 6dt .",
    "\\label{eq : xt2}\\ ] ] because @xmath92 $ ] has dimensions in squared length , we denote it by @xmath3 . finally , we can rewrite the latter of eq .",
    "( [ eq : xt2 ] ) as @xmath2 this equation is called the einstein - smoluchowski equation ."
  ],
  "abstract_text": [
    "<S> computational systems biology has provided plenty of insights into cell biology . </S>",
    "<S> early on , the focus was on reaction networks between molecular species . </S>",
    "<S> spatial distribution only began to be considered mostly within the last decade . </S>",
    "<S> however , calculations were restricted to small systems because of tremendously high computational workloads . to date , application to the cell of typical size with molecular resolution is still far from realization . in this article </S>",
    "<S> , we present a new parallel stochastic method for particle reaction - diffusion systems . the program called pspatiocyte </S>",
    "<S> was created bearing in mind reaction networks in biological cells operating in crowded intracellular environments as the primary simulation target . </S>",
    "<S> pspatiocyte employs unique discretization and parallelization algorithms based on a hexagonal close - packed lattice for efficient execution particularly on large distributed memory parallel computers . for two - level parallelization </S>",
    "<S> , we introduced isolated subdomain and tri - stage lockstep communication for process - level , and voxel - locking techniques for thread - level . </S>",
    "<S> we performed a series of parallel runs on riken s k computer . for a fine lattice that had relatively low occupancy , pspatiocyte achieved 7686 times speedup with 663552 cores relative to 64 cores from the viewpoint of strong scaling and exhibited 74% parallel efficiency . </S>",
    "<S> as for weak scaling , efficiencies at least 60% were observed up to 663552 cores . </S>",
    "<S> in addition to computational performance , diffusion and reaction rates were validated by theory and another well - validated program and had good agreement . </S>",
    "<S> lastly , as a preliminary example of real - world applications , we present a calculation of the mapk model , a typical reaction network motif in cell signaling pathways . </S>"
  ]
}