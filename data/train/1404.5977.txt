{
  "article_text": [
    "random numbers are important for an array of applications from encryption and authentication systems @xcite , to monte carlo simulations for molecular dynamics , nuclear reactors , and others @xcite . as a result , a variety of classical methods ( computational pseudo - random number generators , sampling stochastic physical processes , etc . ) to generate random number sequences have been developed .",
    "an attendant host of tests to certify that a given data sequence is `` random '' has been also been created @xcite . while pseudo - random numbers are useful for many of these applications , including simulations and encryption with suitably high quality sources , their inherent determinism means that any encryption or authentication scheme is in principle breakable with sufficient computational power .",
    "this principle applies to any deterministic system , including processes described by classical physics .    on the other hand ,",
    "the only nondeterministic physical theory with experimentally accessible applications is quantum mechanics @xcite .",
    "the additional security provided by non determinism is a requirement for quantum key distribution , for instance , whose security proofs often rely on the concept of true , nondeterministic randomness in order to guarantee successful secret key sharing @xcite .",
    "thus , a wide array of so - called quantum random number generators ( qrng ) have been developed . from radioactive decay @xcite to quantum optical techniques @xcite , a host of methods involving photon arrival time @xcite and vacuum noise measurements @xcite have been demonstrated . despite the prevalence of qrngs and their acknowledged need , many implementations use extractors ( such as hashes ) to remove large amounts of bias computationally , exposing a potential weakness in their physical implementations .",
    "for instance , if an adversary is able to computationally reverse the extractor function that a given qrng implements in order to achieve random number uniformity and the underlying ( `` physical '' ) distribution is strongly biased then he or she will have a best - guess strategy against the qrng device .",
    "therefore , one s ability to detect and remove bias before applying an extractor function improves the qrng s security .",
    "one of the major sources of bias in qrngs , aside from environmental noise , is the lack of knowledge of precise values of the qrng s physical parameters .",
    "the best one may do is to estimate the parameters statistically .",
    "but because the estimates are statistical they are intrinsically noisy , and thus assigning a single value to a parameter can lead to errors and bias .",
    "nevertheless , parameter estimator errors are usually ignored in qrng design and simple point estimators are used . here ,",
    "we show that using point estimators may introduce possible binning bias .",
    "we argue that using a bayesian statistical inference method removes this type of bias and propose a binning scheme that extracts the optimum number of bits possible for a given entropy from a given physical random number distribution .",
    "when used as a diagnostic for qrngs in combination with maximum likelihood estimators ( mle ) , uniform distributions can be generated from sources of quantum randomness .",
    "using bayesian hypothesis updating techniques , our scheme allows for a test of the quantum model that produced a given set of numbers , potentially allowing for a fast , on - line quantum test of randomness .",
    "this technique has applications to high bit rate qrngs which need testing and verification to ensure the device remains bias - free during use .",
    "let @xmath0 be a continuous random variable with probability density function ( _ pdf _ ) @xmath1 , where @xmath2 is a fixed- ( but unknown- ) value parameter . the particular form and parametric dependence of @xmath1",
    "is determined by the experimental setup at hand .",
    "our goal in this section is to introduce a typical problem of physical random number generation that can be formulated as follows : provided @xmath3 independent samples of @xmath0 , @xmath4 are measured in an experiment , convert , if possible , each measurement outcome @xmath5 into a discrete random variable @xmath6 with the probability mass function ( _ pmf _ ) @xmath7 and corresponding domain @xmath8 .",
    "a uniform distribution @xmath9 is often important in applications and here we will also concentrate on the case of @xmath10 . then the problem essentially reduces to constructing a surjection @xmath11 from the set @xmath12 onto the set @xmath13 .    traditionally , the problem is solved by dividing the domain of @xmath14 , @xmath15 , into @xmath16 mutually non - intersecting bins such that @xmath17@xcite . when bins are selected such that the probability of the random variable @xmath0 to fall into the @xmath18-th bin",
    "@xmath19 is @xmath20 then the surjection @xmath21 can be constructed by following a simple rule : if a measurement result @xmath22 for some @xmath18 then we assign @xmath23 . of course",
    "this mapping works only if the value of the model parameter @xmath2 is known .",
    "since it is usually not the case in the majority of experimental situations , the first order of business is to find a good estimate of the value of @xmath2 . in many cases ,",
    "the number of possible ways to construct an estimator that provides an unbiased estimate of @xmath2 is infinite @xcite .",
    "moreover , it is not always possible to find an estimator that has minimal uncertainty , and often one is forced to choose one from a set of almost optimal candidates . in practice",
    "the maximum likelihood estimator ( mle ) is a common choice .",
    "given a set @xmath24 of independent samples of @xmath0 , @xmath25 , we can introduce the _ likelihood _ function , @xmath26 the likelihood @xmath27 indicates which values of @xmath2 are more likely given measurement data @xmath24 .",
    "we can also compute , at least numerically , the value of @xmath2 that maximizes @xmath27 , provided the likelihood function is convex .",
    "the resulting estimator is mle , i.e. @xmath28 .",
    "using @xmath29 as the `` true '' parameter value for binning purposes in eq.([eq : binprobability1 ] ) might at first appear as a reasonable choice , and this approach is a mainstay in qrng design .",
    "but what happens if instead of @xmath29 one uses some other estimate @xmath30 that differs from @xmath29 only slightly in the value of the likelihood , i.e. @xmath31 ?",
    "choosing @xmath30 over @xmath29 will have an effect on the size of bins @xmath19 generated via eq.([eq : binprobability1 ] ) .",
    "we illustrate this situation in fig .",
    "[ fig : binningexample1 ] , where the random variable @xmath0 follows gamma distribution @xmath32 ( i.e. @xmath33 ) and we are interested in converting each measurement outcome @xmath34 into a uniformly distributed discrete random variable k that can take on values \\{0,1,2,3}. we fit the same measurement data using two slightly different values of the parameter @xmath2 .",
    "the red solid line represents the fit with @xmath35 and the blue solid line has @xmath36 .",
    "the vertical dashed blue ( red ) lines represent bins calculated using eq.([eq : binprobability ] ) with @xmath37 and @xmath38(@xmath39 ) .",
    "the green circle is a particular measurement outcome @xmath40 that we would like to assign a discrete value @xmath41 to . according to our previous discussion ,",
    "@xmath42 and @xmath43 if we use values @xmath44 and @xmath45 respectively .",
    "now imagine that @xmath45 and @xmath44 are such that the likelihood function does not provide a reliable differentiation between them , i.e. @xmath46 .",
    "which value of @xmath41 , if any , should we then adopt ?",
    "there are four possible options :    * choose @xmath39 when @xmath45 is the true estimate ( @xmath47 ) .",
    "* choose @xmath38 when @xmath44 is the true estimate ( @xmath48 ) .",
    "* choose @xmath39 when @xmath44 is the true estimate ( @xmath47 ) .",
    "* choose @xmath38 when @xmath45 is the true estimate ( @xmath48 ) .",
    "the first two choices are trivial since they obviously result in a uniform pmf @xmath49 . the last two choices , however , generate a bias that distorts the uniformity of @xmath50 . to see that we calculate the probability of @xmath0 occupying the @xmath18-th bin provided that @xmath39 is chosen when @xmath44 is the true estimate , @xmath51^{\\frac{\\theta_{1}}{\\theta_{2 } } } - [ \\frac{n - i-1}{n}]^{\\frac{\\theta_{1}}{\\theta_{2}}},\\label{eq : binprobunder}\\end{aligned}\\ ] ] where @xmath37 , @xmath52 , and @xmath53 .",
    "we notice that , by definition , @xmath54 .",
    "similarly , if we choose @xmath38 when @xmath45 is the true estimate then the @xmath18-th bin probability @xmath55 reads , @xmath56^{\\frac{\\theta_{2}}{\\theta_{1 } } } - [ \\frac{n - i-1}{n}]^{\\frac{\\theta_{2}}{\\theta_{1 } } } , \\label{eq : binprobover}\\end{aligned}\\ ] ] where @xmath57 . finally , the plot of pmfs @xmath50 and @xmath58 in fig .",
    "[ fig : binprobability ] , calculated using eqs.([eq : binprobunder ] ) and ( [ eq : binprobover ] ) respectively for @xmath37 , illustrates the effect of parameter under(over)-estimation on the uniformity of the random numbers generated using the continuous distribution binning method .",
    "the horizontal axis represents the bin number @xmath41 where a measurement outcome @xmath40 is placed as the result of binning .",
    "the vertical axis is the probability for different values of @xmath41 to occur .",
    "ideally , if the value of @xmath2 was known exactly , the probability of @xmath59 or @xmath60 would be the same at @xmath61 .",
    "this situation is represented by the solid blue line .",
    "when the value of @xmath2 is overestimated , @xmath58  the corresponding pmf in eq.([eq : binprobover ] )  depicted by green crosses , exhibits a bias towards placing measurement outcomes into the first two bins . in a similar fashion ,",
    "@xmath50 in eq.([eq : binprobunder ] ) , represented by red circles , corresponds to the situation when the parameter @xmath2 is underestimated and demonstrates bias towards @xmath48 . to quantify the amount of introduced bias we compute values of kullback - leibler ( kl ) divergence @xmath62 and @xmath63 between the bin pmf @xmath58 ( @xmath50 ) and the ideal uniform pmf @xmath64 respectively . by definition ,",
    "kl divergence measures the information lost when the uniform pmf @xmath65 is used to approximate @xmath58 or @xmath50 .",
    "we find that @xmath66 bits and @xmath67 bits .",
    "this example shows that discrete random number generation procedures relying on binning a continuous probability distribution with a parametric dependence potentially introduces bias .",
    "this happens because the point parameter estimation approach is prone to over(under)-estimating the true value of the parameter .",
    "hence , the question arises : is there a binning method that does not introduce bias ?",
    "the short answer is yes , and such a method will be introduced in section  [ sec : bayesianinference ] . in the next section , a slightly different approach to binning is shown in order to motivate the discussion .",
    "a measurement outcome @xmath34 does not depend on the value of the pdf parameter @xmath2",
    ". however , the probability of the outcome does .",
    "as we have already seen , this means that the size of the bins also depends on @xmath2 , which makes binning procedure problematic .",
    "the reverse situation would be more practical , in which the bin size is fixed ( independent of @xmath2 ) but the measurement outcome depends on the pdf parameter .",
    "of course , this does not remedy the problem of bias discussed earlier , but it will be useful in formulating a solution in the next section .    for a given fixed value @xmath2 , the probability @xmath68 that the continuous random variable @xmath0 is less than @xmath69 reads , @xmath70 where we have assumed that @xmath71 .",
    "by definition @xmath72 $ ] and @xmath73 can be interpreted as a uniform continuous random variable on the @xmath74 $ ] interval provided @xmath68 is a continuous function of @xmath69 .",
    "the proof is straightforward and can be found elsewhere  @xcite . on the other hand , if the value of @xmath69 is fixed , e.g. @xmath75 , and the value of @xmath2 is unknown then @xmath76 is clearly a function of @xmath2 with the range @xmath74 $ ] .",
    "if we divide the @xmath74 $ ] interval into @xmath16 uniform bins , each of the size @xmath77 , then for every measurement outcome @xmath34 a discrete random number @xmath78 can be generated by finding @xmath41 such that @xmath79 .",
    "this is exactly what we were looking for . by replacing the random variable @xmath0 with @xmath80 using the integral transform in eq.([eq : inttrans ] )",
    "we switched from having bins that explicitly depended on the model parameter @xmath2 to having constant bin size .",
    "the parametric dependence is now shifted to the random variable that we bin , i.e. @xmath81 , and now we need to figure out a way to assign a value to @xmath81 which does not create bias .",
    "we could try to fix the value of @xmath81 by using an estimate of @xmath2 ( e.g. mle ) as was done previously in section  [ sec : directbinning ] . however , this approach is inherently flawed because any finite data sample estimator  though it can be very close to the true parameter value  will over(under)-estimate the true parameter value . however , the concept of likelihood , or , more precisely , the concept of treating the distribution parameter @xmath2 as an unknown ( but not random ) variable given a set of measurements @xmath25 can be inverted using bayesian inference to compute the probability @xmath81 of occupying a given bin @xmath18 .",
    "indeed , the bayesian approach treats @xmath2 as a quantity whose variation is described by a probability distribution @xmath82 usually referred to as the _",
    "prior_. the prior is a subjective distribution determined by experimenter s personal beliefs and knowledge about the system of interest prior to any observations on the system .",
    "once @xmath82 is formulated , an observation on the system is made .",
    "the prior is then updated with the result of the observation using bayes rule and the next measurement is taken with the updated prior , often called _ posterior _ , as the new prior . if the sampling distribution , i.e. the distribution we draw measurement outcomes from , is @xmath1 ( the pdf to observe @xmath83 as a result of our measurement , given the parameter value @xmath2 ) and the measurement result is @xmath83 then the posterior distribution is given by @xmath84 where @xmath85 is the marginal distribution of @xmath0 : @xmath86 the posterior distribution can be subjectively interpreted ( since it does depend on the choice of the prior ) as a conditional distribution ( conditioned on the observed sample ) for the parameter @xmath2 . on the other hand , we know that @xmath81 is a function of @xmath2 given the measurement outcome @xmath83 .",
    "therefore , @xmath81 can also be interpreted as a random variable on @xmath74 $ ] with distribution function @xmath87 that can be computed using @xmath88 , @xmath89 where the plus ( minus ) sign is taken when @xmath81 is an increasing ( decreasing ) function of @xmath2 , @xmath80 is assumed to be continuous , and @xmath90 has a continuous first derivative .",
    "now we are fully equipped to calculate the probability that a measurement outcome @xmath34 converts into an integer @xmath41 ( @xmath91 $ ] ) .",
    "it is equivalent to the probability that the random variable @xmath92 falls into the interval @xmath93 given by , @xmath94 this means that we now can assign a bin to a measurement outcome using a simple acceptance / rejection test : we accept @xmath40 into the @xmath41-th bin if @xmath95 and reject @xmath40 in the @xmath41-th bin otherwise . here",
    "@xmath96 is the user - defined acceptance probability .",
    "the binning bias can be completely eliminated by setting the value of @xmath96 high ( @xmath97 ) .",
    "this means that only the measurement outcomes that have more than 95% of their distribution function @xmath98 localized within a certain bin will be accepted and converted into a discrete random number .",
    "all other measurements will be rejected . on the other hand ,",
    "if @xmath96 is set too low , say , @xmath99 then less measurements will be rejected . however",
    ", this may lead to conflicting situations when a measurement outcome could be placed into two or more different bins which , in turn , may lead to binning bias .",
    "let us consider an example depicted in figure  [ fig : binvsparam ] where two distribution functions @xmath100 ( red solid line ) and @xmath101 ( green solid line ) for two independent samples @xmath102 and @xmath103 are plotted .",
    "we are interested in converting each measurement outcome @xmath69 into an integer value @xmath104 . using our acceptance / rejection test with @xmath105",
    "we conclude that @xmath103 is an acceptable measurement that can be converted to @xmath43 . on contrary , @xmath103 will be rejected and no integer value will be assigned to it .",
    "we finally summarize our approach to qrng data processing as the following 5 step algorithm :    1 .",
    "run qrng and collect @xmath3 independent samples @xmath106 from the distribution @xmath1 defined by the qrng .",
    "2 .   construct a prior @xmath82 for all possible values of @xmath2 .",
    "3 .   update the prior @xmath3 times using the bayes rule eq.([eq : bayesrule ] ) .",
    "compute the posterior @xmath107 .",
    "4 .   for each measurement outcome @xmath40 compute the correspondent distribution @xmath98 using eq.([eq : gofu ] ) and eq.([eq : inttrans ] ) . set the acceptance probability value @xmath108 5 .",
    "use the proposed acceptance / rejection test to convert the measured sequence @xmath24 into integer values .",
    "it is worth mentioning that alternatively , instead of waiting to collect a measurement record @xmath24 , one could choose to update the prior on - line i.e. after each measurement . in this case",
    "it is likely that a few first measurement results will be discarded as we accumulate information about the qrng device at hand .",
    "however , after enough information is received to narrow down the parameter distribution , it will be possible to convert upcoming measurements into random bit values .",
    "to illustrate how our approach works in an experiment we consider two physical implementations of qrngs .",
    "we first introduce mathematical models to describe the qrngs of interest in the section  [ sec : physmodels ] and then proceed with the analysis of the experimental data and numerical simulations results in section  [ sec : randd ] .",
    "let us first consider a qrng based on measuring time - of - arrival statistics of a coherent light source .",
    "our experimental setup consists of a tapered amplifier , emitting spontaneously and subsequently attenuated to a coherent state , that continuously illuminates the surface of a free - running single photon counting module with 80  ns dead time @xcite . using a gated fpga essentially acting as a time to digital converter , we measure the time interval @xmath109 between two consecutive photodetection events .",
    "the time interval @xmath109 plays the role of a physical random variable @xmath0 that we would like to convert into a discrete uniform random variable .    to determine statistical properties of @xmath109 , a quantum model of phododetection process is needed . for this purpose",
    "we introduce a positive - operator valued measure ( povm ) @xmath110 , where @xmath111 is a projection operator that corresponds to `` no - click '' measurement of the detector and @xmath112 represents a `` click '' detection event .",
    "note that @xmath113 .",
    "then the detector click rate ( i.e the click probability per unit time ) reads , @xmath114,\\ ] ] here @xmath115 is the density operator of the laser field and @xmath2 describes the overall detection efficiency .",
    "therefore , the probability to get a click in a short time interval @xmath116 is @xmath117 $ ] . on the other hand ,",
    "the probability to detect no click in the same time interval is @xmath118 .",
    "next consider the time interval @xmath109 between two consecutive detector clicks . we can model the absence of clicks during time @xmath109 by a sequence of @xmath16 successful `` no - click '' measurements each of the duration @xmath119 .",
    "hence , the probability to observe no clicks during time @xmath109 reads , @xmath120 where we introduced @xmath121 $ ] . in the limit of large @xmath16",
    "we obtain , @xmath122 we now can compute the conditional probability to detect a click at @xmath123 given a click was detected at @xmath124 , @xmath125 finally , the probability density @xmath126 for the random variable @xmath109 can be obtained by taking a derivative of @xmath127 , @xmath128 two main assumptions were made in the derivation of eq.([eq : toapdf ] ) .",
    "first , the detection events are independent and identically distributed .",
    "this assumption is justifiable in case of moderate laser powers .",
    "second , we have assumed noiseless detection .",
    "the later assumption is , unfortunately , not very realistic .",
    "avalanche photodiode detectors usually introduce two main sources of noise that affect the value of @xmath109  afterpulsing and timing jitter .",
    "afterpulsing is a false detection event in which electrons that were trapped by quenching in a previous detector gate are rereleased in subsequent detector gates , usually occuring after a true click due to a photon absorption event .",
    "the time interval @xmath129 between a true detection and an afterpulse event can be well characterized experimentally and the raw data can be filtered to remove the afterpulsing events by only accepting measurements with @xmath130 .",
    "the filtering procedure effectively results in rescaling of the probability density in eq.([eq : toapdf ] ) , @xmath131 where @xmath129 is a characteristic afterpulsing time .",
    "the time jitter is a small error in the measurement of @xmath109 .",
    "the recorded time interval between two sequential clicks @xmath132 is a sum of two random variables @xmath133 , where @xmath109 is the `` true '' time interval with pdf @xmath134 given in eq.([eq : toapdfrenorm ] ) and @xmath135 is a time jitter random @xmath136 variable .",
    "one can show that the probability density for @xmath132 reads , @xmath137\\end{aligned}\\ ] ] where @xmath138 denotes the error function .",
    "notice that if the time jitter is small ( @xmath139 ) , eq.([eq : toapdfnoise ] ) coincides with eq.([eq : toapdfrenorm ] ) .",
    "since the observed time jitter is indeed small we will model the time - of - arrival qrng using the probability density in eq.([eq : toapdfrenorm ] ) with one parameter @xmath140 .",
    "let us also discuss how to implement the qrng data processing algorithm described earlier for this model .",
    "the model pdf is given in eq.([eq : toapdfrenorm ] ) .",
    "an obvious choice for the prior is a non - informative ( uniform ) prior @xmath141 that assigns constant weight to all values of the parameter @xmath140 .",
    "it turns out that in this case the posterior distribution @xmath142 after @xmath143 measurements can be calculated even analytically ( instead of standard numerical updating ) as , @xmath144 where @xmath145 , and we assume that the characteristic afterpulsing time @xmath129 is known ( not a parameter ) and @xmath146 denotes the gamma distribution function . using eq.([eq : inttrans ] ) we introduce @xmath143 random variables @xmath147 , where @xmath148 and compute their probability distribution @xmath149 using eq.([eq : gofu ] ) and eq.([eq : posteriortoa ] ) , @xmath150^{n}(1-u_{i})^{\\frac{1}{t(\\tau_{i}-\\tau_{a})}-1}}{n!(t(\\tau_{i}-\\tau_{a}))^{n+1}}.\\ ] ] and finally we calculate the probability @xmath151 that @xmath152 falls into the @xmath153-th bin ( @xmath154 $ ] ) @xmath155,\\end{aligned}\\ ] ] where @xmath156 denotes the lower incomplete gamma function . applying the acceptance / rejection test to @xmath157 for all pairs @xmath158 will convert measurement outcomes @xmath159 into a sequence of uniformly distributed integers on @xmath160 $ ] .",
    "the second system that we consider here is a popular qrng implementation based on vacuum quadrature measurement .",
    "quantum vacuum fluctuations of the electromagnetic field are measured routinely at optical wavelengths using homodyne detection techniques  @xcite .",
    "a typical homodyne detector consists of a beam splitter with two input ( @xmath161 ) and two output ports ( @xmath162 ) .",
    "suppose that the input port @xmath163 carries a laser field described by a density operator @xmath164 and the port @xmath165 carries the vacuum . by placing a photodetector in each of the output ports we measure the photon number difference operator @xmath166 between @xmath167 and @xmath168 , @xmath169a^{\\dagger}a + [ ( \\eta_{1}r)^2 - ( \\eta_{2}t)^2]b^{\\dagger}b + \\nonumber \\\\ &   & rt(\\eta_{1}^2 + \\eta_{2}^2)[a^{\\dagger}b + ab^{\\dagger}],\\end{aligned}\\ ] ] where @xmath170 ( @xmath171 ) are the transmittance ( reflectance ) of the beam splitter , @xmath172 are detector 1,2 detection efficiencies and @xmath173 ( @xmath174 ) are creation / annihilation operators for the input port @xmath163 ( @xmath165 ) .",
    "therefore , in a general experimental situation , @xmath166 will depend on three parameters @xmath175 ( note that @xmath176 ) and the laser field @xmath164 .",
    "but since we only perform a numerical simulation of an experiment here and thus can `` control '' the parameters perfectly , we will assume that we have a 50/50 beam splitter ( @xmath177 ) and 100 percent efficient detectors ( @xmath178 ) .",
    "we will also assume that the laser field is in a coherent state , i.e. @xmath179 .",
    "therefore , the expectation value of @xmath166 , @xmath180 is proportional to the expectation value of the vacuum quadrature operator @xmath181 . setting @xmath182",
    "we conclude that by measuring the photon number difference in the output ports @xmath167 and @xmath168 we effectively measure the vacuum @xmath0 quadrature , and hence , a particular measurement outcome in a normal random variable @xmath183 with pdf @xmath184",
    ".    in reality measurement results are always affected by electronic noise .",
    "the noise is usually model by a normal distribution @xmath185 and thus the outcome of the quadrature measurement is a sum of the `` true '' quadrature random variable and the noise i.e. @xmath186 .",
    "since @xmath183 and @xmath187 are independent and normally distributed , their sum @xmath188 is also a normally distributed random variable with pdf @xmath189 .",
    "therefore , we will model the output of vacuum quadrature measurement based qrng as a continuous random variable @xmath188 with the distribution function @xmath190 , @xmath191 where @xmath192 is an unknown parameter .    with the qrng model at hand",
    "we can now discuss how to apply the data processing algorithm developed in section  [ sec : bayesianinference ] to the vacuum quadrature measurement qrng .",
    "once again we start by choosing a prior .",
    "we propose to use a non - informative prior @xmath193 as in the previous example .",
    "the posterior distribution @xmath194 after @xmath143 measurements can then be calculated analytically and reads , @xmath195 where @xmath196 and @xmath197 denotes the gamma function .",
    "the next step in our procedure is to introduce @xmath143 random variables @xmath198 that later on will be binned . unlike the previous example , where eq.([eq : inttrans ] ) was used for that purpose",
    ", we will rely on _ box - muller _",
    "transform  @xcite here . recall that @xmath199 and @xmath200 , two independent uniform(0,1 ) random variables , can be converted into two independent normal @xmath201 random variable @xmath0 and @xmath202 using the following transformation , @xmath203 on the other hand , a pair of measurement outcomes @xmath204 and @xmath205 can be converted into two random variables @xmath206 and @xmath207 @xmath208 [ 0,1 ] . since @xmath209 does not depend on the parameter @xmath210 ( it is constant for a given pair @xmath211 ) , it can be immediately placed into the @xmath153-th bin that satisfies @xmath212 . as to @xmath213 which indeed is a function of @xmath210",
    ", we can derive its probability distribution function @xmath214 using the posterior distribution in eq.([eq : posteriorhqrng ] ) , @xmath215 finally , the probability @xmath216 that @xmath217 falls into the @xmath153-th bin ( @xmath154 $ ] ) @xmath218,\\end{aligned}\\ ] ] where @xmath156 is the lower incomplete gamma function . applying the acceptance / rejection test to @xmath219 for all",
    "@xmath153 will convert @xmath217 into a uniformly distributed integer on @xmath160 $ ] .",
    "therefore , a pair of normally distributed outputs of the vacuum homodyne measurement @xmath220 and @xmath221 converts into two uniformly distributed integer random numbers @xmath222 and @xmath223 .",
    "we collected a sample containing 256,000 measurements of the time interval between two consecutive detection events @xcite .",
    "the raw data was filtered and all entries @xmath224 were removed from the sample to mitigate the effect of detector afterpulsing .",
    "the resulting filtered sample consisted of 221,890 measurements .",
    "we binned the filtered data into 100 bins of equal size @xmath225 and calculated the probability of each bin .",
    "the corresponding probability distribution is depicted in fig .",
    "[ fig : toadatapdf ] with red circles . based on the qrng model discussed in section  [ sec : physmodelstoa ] we calculated @xmath226 , mle for the parameter @xmath140 .",
    "we used @xmath227 in conjunction with the probability density function in eq.([eq : toapdf ] ) to fit the experimental data .",
    "the result is depicted on fig .",
    "[ fig : toadatapdf ] with the solid blue line .",
    "not surprisingly , given the number of measurements , the ml curve fits the data well .",
    "next we applied our data processing algorithm to the filtered data .",
    "we set the acceptance probability @xmath105 and proceeded to convert the data into a set of 4-bit random numbers ( i.e. measurement results are binned among @xmath228 bins ) .",
    "the number of measurements that passed acceptance / rejection criterion ( @xmath229 ) , and were assigned a bin value ( @xmath230 ) , was 215,538 ( out of 221,890 ) .",
    "the resulting bin probability distribution is depicted in fig .",
    "[ fig : toa4bitpdf ] using green triangles .",
    "the solid blue line corresponds to the ideal 4-bit uniform distribution and the red crosses represent a 4-bit probability distribution obtained from the same data set using the conventional fixed - parameter binning technique with @xmath231 .",
    "both methods generate a visually uniform distribution .",
    "the uniformity is also confirmed by the values of shannon entropy per bit ",
    "@xmath232  for each distribution . for the conventional binning @xmath233 bits and",
    "the entropy of the distribution generated by our binning method is @xmath234 bits .    in conventional bin assignment methods ,",
    "once the distribution parameter value is estimated from a given set of measurements , the number of random bits that can be generated per single measurement is , in principle , only limited by the number of measurements  @xcite .",
    "this is because the mean error ( standard deviation ) of the parameter estimator is ignored in conventional binning .",
    "however , if the parameter estimation error is greater than the width of the bin where the measurement result is placed then such a bin assignment is erroneous and this measurement must be ignored and removed from the data .",
    "but this is exactly what our bin assignment method with the acceptance probability @xmath105 does .",
    "it effectively requires that the bin width should be greater than 4 standard deviations of the random variable @xmath152 .",
    "if this requirement is not fulfilled the @xmath18-th measurement can not be assigned a bin reliably and the measurement is discarded . hence , in contrast to the conventional binning our approach reduces the overall number of measurements .",
    "therefore , for a given initial set of data , the number of random bits per measurement is naturally less in our method . in other words",
    "bayesian updating provides a more conservative estimate of randomness of a qrng when compared to ad - hoc binning .",
    "to illustrate this we generated 7- and 8-bit random number distributions from the same filtered data that we used for the 4-bit distribution above and the acceptance probability @xmath105 .",
    "the resulting distributions are depicted with green triangles on fig .",
    "[ fig : toa7bitpdf ] and fig .  [ fig : toa8bitpdf ] . as",
    "before the solid blue line corresponds to the ideal 7(8)-bit uniform distributions and the red crosses represent 7(8)-bit probability distribution obtained from the same size data sets using the conventional fixed - parameter binning technique with @xmath231 .",
    "the number of measurements that have passed acceptance / rejection criteria ( @xmath229 ) is 172,736 ( 122,927 ) for the 7-(8-)bit distribution .",
    "we also calculated shannon entropy for the conventional binning , @xmath235 bits , and the entropy of our binning method is @xmath236 bits . on the other hand",
    "the entropy in the 8-bit case for conventional binning is @xmath237 bits and for the proposed binning method is @xmath238 bits . as previously suspected , we observe a drop in the entropy of the 8-bit distribution generated using our technique .",
    "this implies that the collected data can reliably be converted into random bit sequences up to 7 bits long .",
    "note that the conventional binning method does not provide us with such a conclusion .",
    "we simulated vacuum homodyne measurements using a pseudo random number generator .",
    "two independent sets of 50,000 random numbers were created by sampling the normal distributions @xmath239 and @xmath240 respectively .",
    "the first set with @xmath241 represents noiseless vacuum quadrature measurement whereas the second set with @xmath242 corresponds to the electronics noise .",
    "thus , the sum of the sets simulates the vacuum homodyning based qrng that we previously modeled using eq.([eq : hqrngpdf ] ) .",
    "we used the data to produce sets of 6- and 7-bit random numbers implementing both the conventional ( mle based ) and proposed ( bayesian ) binning methods .",
    "the resulting distributions are depicted in fig .",
    "[ fig : vachomodyne6bitpdf ] and fig .",
    "[ fig : vachomodyne7bitpdf ] .",
    "the green triangles correspond to the probability distributions generated using our technique ( @xmath105 ) , the red circles depict the results of the conventional mle based binning and black crosses represent conventional binning with the `` true '' value of the parameter @xmath243 .",
    "examining fig .",
    "[ fig : vachomodyne6bitpdf ] and fig .",
    "[ fig : vachomodyne7bitpdf ] visually we observe that our method fails to produce a uniform 7-bit distribution indicating that the maximum number of random bits per measurement outcome can not exceed 6 for the simulated data sample .",
    "this is also confirmed by the values of shannon entropy @xmath244 versus @xmath245 . of course",
    ", generating a larger sample of measurements would allow a higher number of bits per measurement outcome as was the case in the previous section .",
    "this illustrates the interplay between the number of measurement in a sample , acceptance probability , and the number of random bits that can be extracted from the sample .",
    "in this manuscript we have demonstrated a new binning technique for qrngs , as well as a formalized approach to characterize traditional binning methods . in particular , ad - hoc binning approaches are shown to result in possible bias when the model of the physical qrng system is not taken into account .",
    "using bayesian hypothesis updating , a physical model can be used to quickly characterize experimental data .",
    "this has implications for new types of quantum statistical tests for randomness in a potentially more accessible manner than loop - hole - free bell inequality violation tests .",
    "p. l. would like to thank bing qi , ryan bennink and travis humble for useful discussions .",
    "this work was performed at oak ridge national laboratory , operated by ut - battelle for the u.s .",
    "department of energy under contract no .",
    "de - ac05 - 00or22725 .",
    "increasing the number of bins @xmath16 for a fixed number of measurements @xmath3 also increases fluctuations in the probability of occurrence of a given bin , ultimately reducing the entropy of the distribution to zero ."
  ],
  "abstract_text": [
    "<S> the majority of quantum random number generators ( qrng ) are designed as converters of a continuous quantum random variable into a discrete classical random bit value . for the resulting random bit sequence to be minimally biased </S>",
    "<S> , the conversion process demands an experimenter to fully characterize the underlying quantum system and implement parameter estimation routines . </S>",
    "<S> here we show that conventional approaches to parameter estimation ( such as e.g. _ maximum likelihood estimation _ ) used on a finite qrng data sample without caution may introduce binning bias and lead to overestimation of the randomness of the qrng output . to bypass these complications </S>",
    "<S> , we develop an alternative conversion approach based on the bayesian statistical inference method . </S>",
    "<S> we illustrate our approach using experimental data from a time - of - arrival qrng and numerically simulated data from a vacuum homodyning qrng . </S>",
    "<S> side - by - side comparison with the conventional conversion technique shows that our method provides an automatic on - line bias control and naturally bounds the best achievable qrng bit rate for a given measurement record . </S>"
  ]
}