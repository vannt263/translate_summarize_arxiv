{
  "article_text": [
    "the well known lagrange variational principle requires @xmath1 dt=0\\ ] ] with the lagrangian @xmath2 , hamiltonian @xmath3 , and generalized momenta @xmath4 and coordinates @xmath5 .    in this principle",
    "all variations of @xmath6 are allowed and therefore the euler ",
    "lagrange equations of motion hold , @xmath7 for relativistic single particle motion the lagrangian is @xmath8 where the position @xmath9 is a function of the generalized coordinates @xmath5 .",
    "the jacobian matrix @xmath10 of this function can be written in the form @xmath11 and has the elements @xmath12 . in this efficient notation @xmath13",
    "is the transpose    of the @xmath14 matrix @xmath15 .",
    "the jacobian matrix of the function @xmath16 is also @xmath10 since @xmath17 .",
    "the generalized momentum is @xmath18 and the variational principle can thus be written as @xmath19dt & = & \\delta\\int [ ( m\\gamma\\dot{\\vec r}+e\\vec a)^t\\underline    r\\ ; \\underline{r}^{-1}\\dot{\\vec r}-{\\cal h}]dt\\nonumber\\\\ & = & \\delta\\int [ m\\gamma v^2+e\\vec a^t\\dot{\\vec r}-{\\cal h}]dt\\ .\\end{aligned}\\ ] ]    if only variations @xmath20 are considered which keep the total energy @xmath21 constant , the variational principle becomes @xmath22 dt & = & \\delta_{_{{\\cal h}=e}}\\int \\vec{\\tilde p}\\cdot d\\vec q\\nonumber\\\\ = \\delta_{_{{\\cal h}=e } } \\int [ m\\gamma v^2+e\\vec a^t\\dot{\\vec r}]dt&=&0\\ .\\label{eq : var}\\end{aligned}\\ ] ] the variational principle for constant total energy is called the principle of maupertuis . however , in equation ( [ eq : var ] ) it does not lead to euler ",
    "lagrange equations of motion , since not all variations are allowed .",
    "a particle optical device usually has an optical axis or some design curve along which a particle beam should travel .",
    "this design curve @xmath23 is parameterized by a variable @xmath24 and the position of a particle in the vicinity of the design curve has coordinates @xmath25 and @xmath26 along the unit vectors @xmath27 and @xmath28 in a plane perpendicular this curve .",
    "this coordinate system is shown in figure [ fg : coord ] .",
    "the third coordinate vector @xmath29 is tangential to the design curve and the curvature vector is @xmath30 .",
    "the unit vectors @xmath27 and @xmath28 in the usual frenet ",
    "serret comoving coordinate system rotate with the torsion of the design curve .",
    "if this rotation is wound back , the equations of motion do not contain the torsion of the design curve .",
    "the position and the velocity are @xmath31 with @xmath32 .",
    "this method is described in @xcite and @xcite and is mentioned here since design curves with torsion are becoming important when considering particle motion in helical wigglers , undulators , and wavelength shifters @xcite , and for polarized particle motion in helical dipole siberian snakes @xcite .    the variational principle ( [ eq : var ] ) for the three generalized coordinates @xmath33 , @xmath34 , and @xmath35 can now be written for the two generalized coordinates @xmath36 and @xmath37 .",
    "this has the following two advantages : a ) the particle trajectory along the design curve is usually more important than the particle position at a time @xmath38 , and b ) whereas @xmath39 does not allow for all variations of the three coordinates , the total energy can be conserved for all variations of the two coordinates @xmath25 and @xmath26 by choosing for each position @xmath15 the appropriate momentum with @xmath40 .",
    "we obtain from equation ( [ eq : var ] ) @xmath41dl=0\\ ] ] with @xmath42 and @xmath43 .",
    "since all variations are allowed , the integrand is a very simple new lagrangian @xmath44 which leads to euler  lagrange equations of motion @xmath45 the integral @xmath46 is called the eikonal .",
    "since the hamiltonian formulation is very common in the area of accelerator physics , we will show how the eikonal can be derived from a hamiltonian formulation .",
    "the equations of motion for the three generalized coordinates @xmath33 , @xmath34 , and @xmath35 can be obtained from the hamiltonian @xmath47 in the case of time independent fields , @xmath3 is the conserved total energy @xmath48 and there are only five independent variables , rather than six .",
    "note that the velocity dependent or non holonomic @xcite boundary condition @xmath49 can not be included in the lagrange formalism directly .",
    "but in the hamilton formalism this can be done .",
    "furthermore , a switch of independent variable from @xmath38 to @xmath24 can easily be done in the hamiltonian formulation .",
    "the lagrange formulation is therefore abandoned ( too easily , as will be shown later ) . in the variational condition @xmath50dt=0\\ ] ] one can change to the independent variable @xmath24 as follows : @xmath51dl=0\\ .\\ ] ] the six canonical coordinates are now @xmath25 , @xmath52 , @xmath26 ,",
    "@xmath53 , @xmath54 , and @xmath3 , and the new hamiltonian is given by @xmath55 which has to be expressed as a function of the six coordinates @xcite , @xmath56}\\ .\\nonumber\\end{aligned}\\ ] ] in the hamilton formalism it is simple to take advantage of the fact that the total energy is conserved for time independent fields ; @xmath57 leads to @xmath21 . then from the six coordinates only the first four have to be considered , leading to the lagrangian @xmath58 from @xmath59 , @xmath60 where @xmath61 is the square root in @xmath62 one obtains @xmath63 @xmath64 for @xmath65 .",
    "the very simple lagrangian @xmath66 agrees with the integrand ( [ eq : lag ] ) of the eikonal .    in the following",
    "it will be shown how the hamiltonian and the lagrangian equations of motion for the particle trajectory @xmath67 can be solved in an iterative way .",
    "we write a general equation of motion for a coordinate vector @xmath68 in the form @xmath69 where we assume that @xmath70 is a solution of the differential equation .",
    "furthermore , we assume @xmath68 to be small and let @xmath71 be linear in the coordinates .",
    "we assume that the nonlinear part of the equation of motion can be expanded in a taylor series @xmath72 .",
    "the linearized equation of motion is solved by a trajectory @xmath73 which depends linearly on the initial coordinates . for the transport matrix @xmath74",
    "we therefore have @xmath75 for all coordinate vectors @xmath76 ; @xmath77 being the jacobian matrix of @xmath71 .",
    "one can write every solution of ( [ eq : dgl ] ) as @xmath78 , leading to the equation of motion @xmath79 the taylor coefficients of @xmath80 with respect to the initial coordinates @xmath81 are called aberration coefficients .",
    "with equation ( [ eq : mdgl ] ) one obtains @xmath82    now we assume that the general solution @xmath83 can be expanded in a power series with respect to the initial coordinates . then symbolizing the @xmath84th order taylor polynomial with @xmath85_j$ ]",
    ", we write the orders up to @xmath84 as @xmath86_j$ ] , i.e.  we use lower indices to describe the order of @xmath76 .",
    "the upper index in @xmath87 describes the order in @xmath68 , which is in turn a nonlinear function of @xmath76 .",
    "when @xmath88 is known , one can iterate the expansion up to order @xmath89 with equation ( [ eq : integ ] ) , since @xmath90_n\\}d\\tilde l\\ .",
    "\\label{eq : iter}\\ ] ]    the zeroth order of the expansion with respect to the coordinates must vanish , which means that the trajectory @xmath91 must satisfy the equation of motion for some momentum @xmath92 .",
    "additionally we require that the vector potential on the design curve is gauged to zero .",
    "this can always be achieved . the canonical momentum @xmath93 then also vanishes for the trajectory @xmath91 .",
    "it then follows that the hamiltonian and the lagrangian have no components linear in the coordinates and momenta . when computing trajectories through a particle optical device , it is customary to normalize the momenta to the initial design momentum @xmath94",
    "the following two dimensional generalized coordinates are therefore used : @xmath95 the euler ",
    "lagrange equations lead to the second order differential equations @xmath96 for the two dimensional vector @xmath5 .",
    "in the hamilton formalism one obtains first order equations of motion for the four dimensional vector @xmath97 . with the antisymmetric matrix @xmath98",
    "one can write the equation of motion as @xmath99 with the @xmath100 identity and zero matrixes @xmath101 and @xmath102 .",
    "this structure implies special symmetries for the transport maps @xmath103 of particle optics .",
    "these maps describe how the final phase space coordinates @xmath104 of a particle , after flying through an optical device , are related to the initial coordinates @xmath76 .",
    "these maps are often weakly nonlinear and can be expanded in a taylor expansion .",
    "the hamiltonian nature implies that the jacobian @xmath105 of any transport map @xmath106 is symplectic @xcite , meaning that @xmath107    for the successive approximations we separate the equation of motion into its linear and nonlinear part , @xmath108 after we have solved for the linear transport matrix @xmath109 , we can iterate by equation ( [ eq : iter ] ) which takes the form @xmath110_nd\\tilde l\\}\\ ] ] with the relation @xmath111 from equation ( [ eq : symp ] ) this can be written as @xmath112_nd\\tilde l\\}\\ .\\ ] ] the corresponding equation for the aberrations @xmath113 becomes @xmath114_nd\\tilde l\\ .",
    "\\label{eq : zeta}\\ ] ] this form of the iteration equation is quite simple .",
    "however , since the hamiltonian ( [ eq : ham ] ) is a complicated function , the evaluation of the four integrals can become very cumbersome .",
    "in @xcite rose used a variational principle to derive a successive approximation to nonlinear motion based on the eikonal .",
    "this method iterates position @xmath5 and momentum @xmath93 in their nonlinear dependence on the initial position @xmath115 and momentum @xmath116 . knowing the order @xmath117 dependence @xmath118 and @xmath119 , one has to compute @xmath120 by differentiation of @xmath118 or by inversion of @xmath121 .",
    "then the eikonal can be evaluated to compute the order @xmath89 dependence @xmath122 and @xmath123 .",
    "in general it can be cumbersome to compute @xmath120 and therefore here we derive a new version of the eikonal method , which iterates directly @xmath124 rather than the momentum .    in deriving the simple form of equation ( [ eq : zeta ] )",
    ", advantage has only been taken of the symplectic first order transfer matrix .",
    "we therefore wish to exploit this advantage again by working with new coordinates which are identical with the canonical @xmath5 and @xmath125 up to first order so that the new coordinates lead to the same first order transport matrix @xmath126 . to first order one obtains @xmath127 where @xmath128 is the momentum of a particle traveling on the design curve @xmath91 , and the upper index 1 specifies the part of the vector potential linear in @xmath25 and @xmath26 .",
    "we therefore work with the coordinates @xmath129 moreover , it can be shown @xcite that the contribution from the vector potential can be gauged to vanish whenever there is no longitudinal magnetic field @xmath130 on the design curve .",
    "then if one investigates trajectories which start with momentum @xmath131 in a region free of such a field , we have the simple relation @xmath132 .    by splitting the lagrangian into its second order and its higher order part ,",
    "the equation of motion becomes @xmath133 after having solved the linearized equation of motion , we obtain with equation ( [ eq : iter ] ) @xmath134 an integration by parts leads to @xmath135 d\\tilde l\\nonumber\\\\ & & + \\underline j{\\bigg [ } { \\underline m}^t{\\partial_{{\\vec q}^{\\;\\prime}}l^{\\ge 3}\\choose 0 } { \\bigg ] } _ 0^l\\}\\ .\\label{eq : lag0}\\end{aligned}\\ ] ] writing the jacobian as @xmath136 where @xmath137 was split into parts which depend on @xmath138 linearly and nonlinearly , we obtain @xmath139d\\tilde l+\\underline j{\\bigg [ } ( \\partial_{{\\vec q}_i}{\\vec q}_1^t)\\partial_{{\\vec q}^{\\;\\prime}}l^{\\ge 3 } { \\bigg ] } _",
    "0^l\\nonumber\\\\ & & = { \\vec q}_i -\\underline j\\int_0^l[\\partial_{{\\vec q}_i}l^{\\ge 3 } -(\\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^{\\;\\prime t } ) \\partial_{{\\vec q}^{\\;\\prime}}(l - l^2)\\nonumber\\\\ & & -(\\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^t ) \\partial_{\\vec q}(l - l^2)]d\\tilde l + \\underline j{\\bigg [ } ( \\partial_{{\\vec q}_i}{\\vec q}_1^t)\\partial_{{\\vec q}^{\\;\\prime}}l^{\\ge 3 } { \\bigg ] } _ 0^l\\nonumber\\\\ & & = { \\vec q}_i -\\underline j\\int_0^l[\\partial_{{\\vec q}_i}l^{\\ge 3 } + ( \\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^{\\;\\prime t } ) \\partial_{{\\vec q}^{\\;\\prime}}l^2 + ( \\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^t ) \\partial_{\\vec q}l^2 \\nonumber\\\\ & & -(\\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^{\\;\\prime t } ) \\partial_{{\\vec q}^{\\;\\prime}}l -(\\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^t)\\frac{d}{d\\tilde l } \\partial_{{\\vec q}^{\\;\\prime}}l]d\\tilde l \\nonumber\\\\ & & + \\underline j{\\bigg [ } ( \\partial_{{\\vec q}_i}{\\vec q}_1^t)\\partial_{{\\vec q}^{\\;\\prime}}l^{\\ge 3 } { \\bigg ] } _ 0^l\\ . \\label{eq : lag1}\\end{aligned}\\ ] ] note that the @xmath140 , @xmath141 , @xmath128 and @xmath131 of equation ( [ eq : newco ] ) drop out of the right hand side of equation ( [ eq : lag1 ] ) owing to the multiplications by the zeros in equation ( [ eq : lag0 ] ) .",
    "the second order @xmath142 of the lagrangian is a quadratic form in which every quadratic combination of the @xmath5 and @xmath143 can occur .",
    "it can be written using a matrix @xmath144 as @xmath145 .",
    "part of the above integrand can be rewritten as @xmath146 for convenience we write @xmath147 .",
    "another integration by parts in equation ( [ eq : lag1 ] ) leads to @xmath148 d\\tilde l\\nonumber\\\\ & & + \\underline j{\\bigg [ } ( \\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^t)\\partial_{{\\vec q}^{\\;\\prime}}l + ( \\partial_{{\\vec q}_i}{\\vec q}_1^t)\\partial_{{\\vec q}^{\\;\\prime}}l^{\\ge 3 } { \\bigg ] } _ 0^l\\ .\\end{aligned}\\ ] ] the first part of the integral contains @xmath149 .",
    "the integral @xmath150 is called the perturbation eikonal .",
    "this scheme embodies the essential requirement that the @xmath151 order dependence of @xmath152 on the initial variables @xmath153 can be computed already when @xmath154 is known ; @xmath155 does not need to be known .",
    "for an iteration of @xmath156 , knowledge of @xmath157 is sufficient .",
    "since @xmath158 satisfies the first order equation of motion , we can use the relation @xmath159 to perform another integration by parts , @xmath160}_0^l\\nonumber\\\\ & = & { \\vec q}_i -\\underline j\\partial_{{\\vec q}_i}\\int_0^ll_e d\\tilde l + \\underline j{\\bigg [ } ( \\partial_{{\\vec q}_i}{\\vec q}^t)\\partial_{{\\vec q}^{\\;\\prime}}l \\nonumber\\\\ & & - ( \\partial_{{\\vec q}_i}{\\vec q}_1^t)\\partial_{{\\vec q}^{\\;\\prime}}l^2 -(\\partial_{{\\vec q}_i}{\\vec q}_{\\ge 2}^{t } ) \\partial_{{\\vec q}^{\\;\\prime}_1}l^2({\\vec q}_1 ) { \\bigg ] } _ 0^l\\ .\\end{aligned}\\ ] ] @xmath161 is the part of @xmath162 which up to order @xmath89 in @xmath163 does not depend on @xmath156 .",
    "similarly the term outside the integral is simply the part of @xmath164 which up to order @xmath89 does not depend on @xmath156",
    ". we therefore write @xmath165 .",
    "if we now express the lagrangian in terms of the aberrations @xmath166 with @xmath167 , we obtain the iteration equation @xmath168}_0^l\\ .\\nonumber\\end{aligned}\\ ] ] when computing @xmath169 from @xmath170 with this iteration equation , all parts of the right hand side which contribute to higher orders are neglected , as indicated by @xmath171 .",
    "this iteration equation can have several advantages over the hamiltonian iteration equation ( [ eq : iter ] ) :    * the lagrangian ( [ eq : lag ] ) is a much simpler function than the hamiltonian ( [ eq : ham ] ) . * the derivative in equation ( [ eq : eikiter ] )",
    "is performed after the integral has been evaluated .",
    "therefore only one integral has to be computed and it describes all four coordinates of @xmath169 .",
    "* the fact that the various coordinates are the derivatives with respect to initial conditions yields very simple relations @xcite between the various expansion coefficients of @xmath169 , which are the so called aberration coefficients of particle optical devices",
    ". these relations can be much simpler than relations entailed by the symplectic symmetry implicit in the hamiltonian formulation . *",
    "the second pair of coordinates in equation ( [ eq : newco ] ) can be calculated very easily . with equations ( [ eq : varcons ] ) and ( [ eq : lagode ] ) , the equation of motion for @xmath172 is @xmath173 after having computed @xmath174 by iteration , the derivative @xmath143 can then easily be computed as @xmath175 using equation ( [ eq : zeroder ] ) .",
    "one thus only needs to iterate the two dimensional vector @xmath122 and not a four dimensional vector @xmath176 as in the hamiltonian iteration procedure .",
    "the time variation of a spin @xmath177 in the rest frame of a particle is described by the so called thomas  bmt equation @xmath178 @xcite where @xmath179 with the electric field @xmath180 , the parts of the magnetic field @xmath181 which are perpendicular ( @xmath182 ) and parallel ( @xmath183 ) to the particle s velocity , and the anomalous gyro - magnetic factor @xmath184 .    changing to the comoving coordinate system of figure ( [ fg : coord ] ) , we obtain @xmath185 and @xmath186 .",
    "the equation of motion for the vector @xmath187 of these spin components is then @xmath188 the equations of motion for the phase space vector @xmath68 and the spin @xmath187 have the form @xmath189 the general solutions transporting the coordinates along the optical system , starting at the initial values @xmath76 , @xmath190 , is given by the transport map @xmath191 and the rotation matrix @xmath192 , @xmath193 in order to find the general solution , one could compute the nine coefficients of the rotation matrix by solving the differential equation @xmath194 where the vector product was expressed by the totally antisymmetric tensor @xmath195 .",
    "however , computing the nine components of the rotation matrix seems inefficient , since a rotation can be represented by three angles .",
    "it has turned out @xcite to be most efficient to represent the rotation of spins by the quaternion @xmath196 which gives the rotation transformation in the su(2 ) representation as @xmath197 here @xmath198 is the @xmath100 identity matrix and the elements of the vector @xmath199 are the three two dimensional pauli matrixes . when a rotation by an angle @xmath200 is performed around the unit vector @xmath201 , the quaternion representation of the rotation has @xmath202 and @xmath203 .",
    "therefore @xmath204 and the identity transformation is represented by @xmath205 .",
    "if a particle traverses an optical element which rotates the spin according to the quaternion @xmath196 and then passes through an element which rotates the spin according to the quaternion @xmath206 , the total rotation of the spin is given by @xmath207 the concatenation of quaternions can be written in matrix form as @xmath208 this concatenation of two quaternions can be used to find a differential equation for the spin rotation .",
    "while propagating along the design curve by a distance @xmath209 , spins are rotated by an angle @xmath210 around the vector @xmath211 .",
    "after having been propagated to @xmath24 by the quaternion @xmath196 , a spin gets propagated from @xmath24 to @xmath212 by the quaternion with @xmath213 and @xmath214 .",
    "the resulting total rotation is given by @xmath215 and we obtain the differential equation @xmath216 writing the matrix as @xmath217 and the vector as @xmath218 , the spin orbit equation of motion has the form @xmath219 the starting conditions are @xmath220 , @xmath205 , and @xmath221 .",
    "the quaternion @xmath196 depends on the initial phase space coordinates @xmath76 and can be expanded in a taylor series with respect to these coordinates . in the following we want to devise an iteration method for @xmath222 , which is the taylor expansion to order @xmath89 of @xmath196 .",
    "the rotation vector @xmath211 is split into its value on the design curve and its phase space dependent part as @xmath223 .",
    "the spin motion on the design curve is given by @xmath224 .",
    "similarly to equation ( [ eq : varcons ] ) , spin aberrations are defined with respect to the leading order motion .",
    "small phase space coordinates will create a rotation which differs little from @xmath225 and we write the phase space dependent rotation as a concatenation of @xmath226 and the @xmath68 dependent rotation @xmath227 which reduces to the identity for @xmath70 by requiring that the aberrations @xmath228 and @xmath229 vanish on the design curve .",
    "with equation ( [ eq : concat ] ) we obtain @xmath230 the quaternion @xmath196 is now inserted in the differential equation ( [ eq : quatdgl ] ) to obtain @xmath231 taking into account the equation on the design curve and the fact that @xmath232 describes the inverse rotation of @xmath233 , we obtain @xmath234 writing the taylor expansion to order @xmath89 in @xmath76 one finally obtains the iteration equation @xmath235 this iteration method was used for the spin transport in the program sprint @xcite and was evaluated using mathematica in @xcite .    in the case of successive approximation in terms of the hamiltonian",
    ", the various aberration coefficients were related by the symplectic symmetry . with the lagrange formalism",
    "the various aberration coefficients were related by their being derivatives of a common integral with respect to different initial coordinates . in the case of the successive approximation for spin motion , the various aberration coefficients in @xmath229 and @xmath228",
    "are related by the relation @xmath236 ."
  ],
  "abstract_text": [
    "<S> single particle dynamics in electron microscopes , ion or electron lithographic instruments , particle accelerators , and particle spectrographs is described by weakly nonlinear ordinary differential equations . </S>",
    "<S> therefore , the linear part of the equation of motion is usually solved and the nonlinear effects are then found in successive order by iteration methods .    when synchrotron radiation is not important , the equation can be derived from a hamiltonian or a lagrangian . </S>",
    "<S> the hamiltonian nature can lead to simplified computations of particle transport through an optical device when a suitable computational method is used . </S>",
    "<S> h. rose and his school have contributed to these techniques by developing and intensively using the eikonal method @xcite . </S>",
    "<S> many ingenious microscopic and lithographic devices were found by rose and his group due to the simple structure of this method @xcite .    </S>",
    "<S> the particle optical eikonal method is either derived by propagating the electron wave or by the principle of maupertuis for time independent fields . </S>",
    "<S> maybe because of the time dependent fields which are often required , in the area of accelerator physics the eikonal method has never become popular , although lagrange methods had been used sometimes already in early days @xcite . in this area </S>",
    "<S> classical hamilitonian dynamics is usually used to compute nonlinear particle motion . here </S>",
    "<S> i will therefore derive the eikonal method from a hamiltonian quite familiar to the accelerator physics community .    with the event of high energy polarized electron beams @xcite and plans for high energy proton beams @xcite , nonlinear effects in spin motion </S>",
    "<S> have become important in high energy accelerators . </S>",
    "<S> i will introduce a successive approximation for the nonlinear effects in the coupled spin and orbit motion of charged particles which resembles some of the simplifications resulting from the eikonal method for the pure orbit motion .    </S>",
    "<S> # 1@xmath0#1    to h. rose on the occasion of his 65th birthday </S>"
  ]
}