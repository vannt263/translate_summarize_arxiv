{
  "article_text": [
    "the halo mass function ( hereafter hmf ) , which encodes the comoving number density of dark matter haloes in the universe at a given epoch as a function of their mass , is a powerful probe of cosmology , dark matter and dark energy @xcite . for example , the amplitude of the hmf on the scale of galaxy clusters at the present epoch may be used to deduce limits on the combination of the power spectrum normalisation @xmath3 and the matter density parameter @xmath1 @xcite .",
    "similarly , the evolution of this amplitude over cosmic time may be used to characterise the dark energy equation of state @xmath4 @xcite .    over the last decade , precise measurements of the cosmic microwave background ( cmb ) by the wilkinson microwave anisotropy probe ( hereafter wmap ; cf . * ? ? ?",
    "* ) and planck @xcite satellites have led to increasingly accurate estimates of key cosmological parameters such as @xmath1 , by factors of @xmath54 in most cases .",
    "it is therefore interesting to ask how our knowledge of the hmf has evolved over the same period .    in this letter",
    ", we estimate the uncertainty in the hmf assuming `` best - bet '' wmap and planck cosmological parameters , and we determine the independent parameters that are the primary sources of this uncertainty .",
    "this is of crucial importance because quantifying the significance of any deviation between an observationally derived hmf and one predicted within the standard cosmological framework is difficult without understanding the framework s instrinsic uncertainties .",
    "specifically , we determine uncertainties in the predicted hmf for a suite of flat @xmath0 cold dark matter ( hereafter @xmath0cdm ) cosmologies , adopting a range of hmf fitting functions drawn from the literature .",
    "we present the 68% error on the amplitude and slope of the hmf , given the reported errors on a number of input parameters ; a comparison of errors due to uncertainty in cosmology with errors in the chosen fitting function ; and an analysis of the parameters that provide the primary sources of uncertainty . finally , we consider the sensitivity of the hmf to the assumed dark matter model by exploring the range of warm dark matter ( wdm ) particle masses for which the hmf can be used to differentiate between @xmath0cdm and its @xmath0wdm alternatives .",
    "we calculate the hmf using the formalism of @xcite and @xcite .",
    "this defines the hmf as the differential number density of haloes in logarithmic mass bins , @xmath6 where @xmath7 is the mean matter density of the universe ; @xmath8 is the mass variance at mass scale @xmath9 ; and the function @xmath10 differentiates between fitting functions .",
    "many forms for @xmath10 have been proposed in the literature .",
    "the original form proposed by @xcite is the only one derived completely analytically , but makes the simplifying assumption of collisionless spherical collapse .",
    "@xcite proposed a form motivated by the more general assumption of ellipsoidal collapse in which three parameters were set by fitting to simulation data . to date , no other analytical form for @xmath10 has been derived ; instead , its form is empirically derived by fitting to the abundance of haloes measured by halo finders in cosmological simulations . in this letter",
    "we adopt many of these empirical fitting functions from the literature in addition to the forms of @xcite and @xcite . for clarity ,",
    "we focus on the form of sheth - tormen unless otherwise stated ; we note that results are qualitatively similar for all of the fitting functions we have considered .",
    "we calculate hmfs using the ` hmf ` code ( cf .",
    "github.com/steven-murray/hmf ) , which is the backend of the ` hmfcalc ` web - application ( cf .",
    "hmf.icrar.org ) ; further details can be found in murray , power & robotham ( in prep . ) .",
    "our code uses ` camb ` ( cf .",
    "camb.info ; details in * ? ? ?",
    "* ) to produce a transfer function for a given input cosmology , and interpolates and integrates this function to compute the mass variance .",
    "importantly , our code is optimized to quickly and easily update parameters of the calculation , which allows us to generate the large number of realisations necessary for this study .",
    "we use data spanning the last 7 years of cosmological parameters derived from the cmb  from wmap3 @xcite , wmap5 @xcite , wmap9 @xcite and planck @xcite .",
    "we choose parameter sets that derive from isolated fits to the cmb , not using any extra data ( such as baos or lensing ) to ensure consistency across samples . in all cases",
    "we assume a flat @xmath0cdm geometry , consistent with the theoretical base model of the planck results , and consider five parameters  the baryon and cdm densities combined with the hubble constant @xmath11 and @xmath12 , the spectral index @xmath13 , the hubble parameter @xmath14 and the normalization @xmath3 .",
    "we constrain @xmath14 by adopting eq .",
    "11 of @xcite ; this is possible because we can calculate directly the angular size of the sound horizon at last scattering , to better than 0.3% accuracy .    in order to sample from the parameter distributions from each base cosmology ,",
    "we use available monte carlo markov chains ( mcmc ) , randomly choosing 5000 realizations from each chain .",
    "this allows for robust sampling of the covariance between each parameter .",
    "we calculate the hmf for each realization , finding the resulting 68% uncertainty about the median for both the amplitude and slope .",
    "note that we have checked our results for consistency with more basic approaches based on ( i ) variance in the parameters , in which parameter uncertainties are assumed to be uncoupled , and ( ii ) covariance between the parameters , in which parameter uncertainties are coupled but assumed to be gaussian - distributed .",
    "averaging over masses , we find that the maximum difference between the variance and mcmc approaches is 6% ( for wmap3 ) , while the maximum difference between the covariance and mcmc approaches is 2% ( for planck ) .",
    "if we do not average over masses , we find that the variance approach underestimates the uncertainty in the hmf by @xmath15 for all wmap ( planck ) datasets at high masses ( @xmath16 ) , whereas it is @xmath17 at most if we adopt the covariance approach .",
    "the amplitude uncertainty range is simply the 16@xmath18",
    " @xmath19 quantile of the value of the hmf .",
    "calculation of this quantity eliminates any information associated with the gradient of the mass function , which may be an important aspect in constraining cosmology .",
    "therefore we also calculate the slope , as the arc - tangent of the discrete gradient ( via the method of central differences ) at each mass bin . for this analysis we use a mass bin width of 0.05 dex .",
    "note that we perform our analysis assuming a  universal \" form for the mass function , in which changes in cosmology are captured by changes in the mass variance @xmath8 .",
    "recent work suggests that this assumption does not hold in detail and can lead to @xmath510% uncertainties ( cf .",
    "* ; * ? ? ?",
    "we do not explicitly account for this source of uncertainty in our analysis and we suggest that the reader allow for an additional 10% uncertainty in our quoted results to account for this .",
    "[ [ effect - of - choice - of - fitting - function . ] ] effect of choice of fitting function .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in figure [ fig : hmf ] we show the variety of hmf fitting functions drawn from the literature  @xcite and @xcite  assuming a planck cosmology .",
    "the scatter between fitting functions is noticeable and has been remarked upon already in the comprehensive comparison of halo - finders presented in @xcite . given this scatter ,",
    "we wish to investigate two effects ; ( i ) whether or not the fitting functions behave similarly under changes of cosmology , and ( ii ) whether or not the scatter in the fitting functions is the dominant source of uncertainty in the hmf for contemporary cosmological parameter sets .",
    "that is , whether the variation between fitting functions for a cosmology with no variance is greater than the variation between hmf s of a single fitting function for a cosmology with non - zero variance .    in figure",
    "[ fig : error ] we show the fractional error intrinsic to each parameter set ; the sheth - tormen fitting function is shown by the solid lines , while the fractional error attributable to the choice of fitting function , estimated at the median value of the hmf for the given cosmology , is shown by the dashed lines .",
    "it is noticeable that the variance in earlier parameter sets ( e.g. wmap3 ) is dominated by uncertainty in the cosmological parameters ; in contrast , the variance in the most recent parameter sets is comparable to the variation between fitting functions across the mass range considered .",
    "this implies that future constraints on cosmology using the hmf will be limited by uncertainties in our knowledge of the hmf fitting function itself , unless more robust non - parametric means are used .",
    "more encouraging is the similarity of the several dashed curves in figure [ fig : error ] , which imply that a change of cosmology ( within reasonable ranges ) does not greatly affect the behaviour of the general class of fitting functions . ] ; that is , each fitting function displays a similar trend with the change of cosmology .",
    "this derives from the fitting functions depending on cosmology only through its influence on the mass variance ( cf .",
    "[ eq : hmf ] ) , and justifies our use of a single fitting function on which to base a general analysis of the cosmological parameter errors .",
    "figure [ fig : comparison ] confirms this ; it shows the normalized hmf for several cosmologies for three fitting functions .",
    "while there are noticeable differences between cosmologies , there is consistency of behaviour between the fitting functions .",
    "[ [ amplitude - of - errors - in - standard - cosmologies . ] ] amplitude of errors in standard cosmologies .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    figure [ fig : error ] shows that at low masses , the variation asymptotes to a constant value , while at high masses the error rises seemingly exponentially .",
    "indeed , for early parameter sets , cluster - mass haloes had associated uncertainties of almost 70% .",
    "this increase in uncertainty at high masses reflects the sensitivity of the abundance of clusters to the value of @xmath3 , which has been noted previously @xcite and will be discussed further . from the latest planck measurements , we deduce a ` rule - of - thumb ' of @xmath56% uncertainty in both the amplitude and slope of the hmf on scales less than @xmath20 , rising to @xmath520% for the amplitude and @xmath515% for the slope at scales of @xmath21 .",
    "furthermore , although we observe a decrease in uncertainty over the consecutive wmap and planck measurements , the rate of decrease is becoming smaller , especially at high masses .",
    "this occurs because of the dominance of @xmath3 , which is the primary contributor to the uncertainty at high masses ( cf .",
    "figure [ fig : contribution ] ) .",
    "therefore , a significantly more constrained hmf will depend strongly on the @xmath3 constraint .",
    "maximum likelihood techniques applied to observed clusters may be the best way to constrain @xmath3 , given the strong sensitivity in this regime .",
    "such a constraint could be obtained from clusters drawn from the xmm xxl x - ray survey , which is designed to identify galaxy clusters out to @xmath22 with masses of @xmath23 in 50 square degrees of sky ( cf .",
    "[ [ consistency - of - parameter - sets . ] ] consistency of parameter sets .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    figure [ fig : comparison ] shows the hmf , with error ranges ( given by the 16@xmath18 and 84@xmath18 quantiles ) for several parameter sets , normalized by the hmf of the mean parameters from wmap1 .",
    "this gives a visual clue as to the relative amplitude of the hmfs and their error , which reveals whether they are statistically consistent .",
    "we see that while planck results are marginally consistent with wmap9 , they do not overlap with wmap5 over the entire range of masses considered .",
    "this is driven by the inconsistency of @xmath12 between these parameter sets .",
    "[ [ effects - of - single - parameters . ] ] effects of single parameters .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to better understand the parameters that are most important in the variance of the hmf , we marginalise over all but one of the parameters at a time , calculating the uncertainty , and plot the fractional uncertainty of each parameter with respect to the total uncertainty ( summed in quadrature ) in figure [ fig : contribution ] .",
    "these results are for the planck parameter set .",
    "the dark matter density parameter @xmath12 is the dominant source of uncertainty in both the amplitude and slope of the hmf except at high masses .",
    "@xmath12 has the intuitive effect of increasing ( decreasing ) the amplitude of the hmf as it increases ( decreases ) . at high masses ,",
    "the effect of @xmath3 is even more important than @xmath12 because it regulates the amplitude of density perturbations .",
    "most fitting functions contain an explicit inverse exponential dependence on the mass variance , which is linear in @xmath3 , so for large masses ( where the mass variance is very small ) , the hmf is exponentially sensitive to this parameter .",
    "is the dominant term for most of the mass range , with @xmath3 becoming extremely important at high mass . ]",
    "[ [ application - to - non - standard - dark - matter - models . ] ] application to non - standard dark matter models .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we expect the hmf to be sensitive to the nature of dark matter .",
    "warm dark matter ( wdm ) models , in which the abundance of low - mass haloes is suppressed , provide a popular alternative to the cdm model and there has been much interest in them recently ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    ". the signature of wdm should be evident in the hmf on galaxy - mass scales and below , whereas most work on the hmf has focussed on group- to cluster - mass scales .",
    "this raises the question  what is the maximum mass scale for a given wdm model which can theoretically differentiate it from cdm given the current best cosmological parameters ? or conversely , how well constrained must the parameters be to differentiate reasonable wdm models at a certain mass ?",
    "these questions are important for future efforts to detect a wdm signal in the hmf , such as , for example , the gama survey @xcite that aims to measure the hmf down to scales of @xmath24 . to answer them",
    ", one needs to know the intrinsic uncertainty in the cdm mass function , and deduce where the particular wdm model becomes significantly different .",
    "figure [ fig : wdm ] shows the results of calculating the cdm hmf for the planck parameters , with error region shaded , compared to equivalent wdm hmfs for candidate particle masses between 1 and 10 kev .",
    "here we assume the transfer function of @xcite is applied to the cdm linear matter power spectrum to produce the wdm linear matter power spectrum , required to compute the mass variance @xmath8 in eq .",
    "[ eq : hmf ] . for a plausible wdm particle mass of 1 kev  in the sense",
    "that it is consistent with observational limits on the wdm particle mass  we find that the maximum mass scale at which the cdm and wdm models are inconsistent is @xmath510@xmath25 .",
    "increasing the particle mass should mimic a `` colder '' dark matter model and reduce the discrepancy with the cdm hmf , which is what the results show .        by observing that the dominant source of uncertainty at intermediate mass scales is @xmath1",
    ", we can calculate error - ranges on the hmf for a given error in this parameter ( marginalising over other insignificant parameters ) . by doing so",
    ", we may calculate the necessary uncertainty required to theoretically distinguish a wdm model with given particle mass from the cdm model at a given mass scale .",
    "this allows us to make a rough estimate of the time it will take to reduce errors in @xmath1 sufficiently to differentiate reasonable wdm models .",
    "we can already , in principle , distinguish a 1kev wdm model from the cdm model assuming planck parameters at 10@xmath26 , which is expected from figure [ fig : wdm ] , but it will be 20 + years before we can distinguish between wdm and cdm on group mass scales ( @xmath27 ) .",
    "[ [ redshift - dependence ] ] redshift dependence + + + + + + + + + + + + + + + + + + +    we have repeated our analysis at @xmath28=1 , the redshift at which a number of current and future surveys are operating .",
    "results are qualitatively similar although we note that uncertainties for all base cosmologies are increased by a factor of @xmath52 across the mass range considered .",
    "the uncertainty stemming from choice of fitting function also increases , and we find that planck results have smaller uncertainties than the fitting functions . this highlights the need for a consistent approach to fitting the hmf , and , as argued by @xcite , raises the question of the suitability of simple analytic fits to the mass function for future percent - level analyses .",
    "we have examined how our knowledge of the hmf has improved over the last decade with the availability of increasingly accurate estimates of the cosmological parameters by the wmap and planck satellites .",
    "our analysis reveals the limiting uncertainty in the hmf now comes from the variance between fitting functions , with errors intrinsic to the parameters being constrained to @xmath56% at low masses , and @xmath520% at high masses .",
    "we find that the primary sources of uncertainty in the hmf for a standard flat @xmath0cdm cosmology are the matter density parameter @xmath1 and the normalization @xmath3 . of these , @xmath3 is the key parameter which will influence further reductions in the uncertainty in the hmf .",
    "in addition , we have examined prospects for differentiating between the standard cdm model and its wdm variants using the hmf and found that reasonable models only become detectable at scales less than @xmath510@xmath26 with current parameter uncertainties .",
    "we place an upper - limit of 0.8% on the uncertainty in @xmath1 before theoretical detection of a wdm model of 1kev is possible at @xmath24  a @xmath5300% tighter constraint than the planck results .",
    "we conclude by noting that , while the strongest constraint on the hmf can be made in theory using data drawn from the entire halo mass range , this is prohibitively difficult to do in practice . assuming a volume limited sample of haloes , the strongest constraint comes from the smallest haloes because of poisson statistics .",
    "however , for an hmf sample constructed with a volume limit scaled optimally to match halo mass ( i.e. detection of larger haloes require larger volumes ) , there will be a volume disconnect between bins , so the halo mass bin to bin variance will dominate hmf shape .",
    "this means that we can not use the entire hmf to constrain , say , both dark matter and dark energy models , because the volume overlap between observable low mass halos and large clusters is virtually nil .",
    "therefore future surveys that seek to use the hmf should target either the most massive haloes  and tests of dark energy  or the hosts of the lowest mass galaxies  and tests of dark matter ; they should not do both .",
    "asgr acknowledges support of a uwa postdoctoral research fellowship .",
    "part of this research was undertaken as part of the survey simulation pipeline ( ssimpl ; ssimpl-universe.tk ) .",
    "the centre for all - sky astrophysics ( caastro ) is an australian research council centre of excellence , funded by grant ce11e0090 ."
  ],
  "abstract_text": [
    "<S> the parameters governing the standard @xmath0 cold dark matter cosmological model have been constrained with unprecedented accuracy by precise measurements of the cosmic microwave background by the wilkinson microwave anisotropy probe ( wmap ) and planck satellites . </S>",
    "<S> each new data release has refined further our knowledge of quantities  such as the matter density parameter @xmath1  that are imprinted on the dark matter halo mass function ( hmf ) , a powerful probe of dark matter and dark energy models . in this letter </S>",
    "<S> we trace how changes in the cosmological parameters over the last decade have influenced uncertainty in our knowledge of the hmf . </S>",
    "<S> we show that this uncertainty has reduced significantly since the @xmath2 wmap data release , but the rate of this reduction is slowing . </S>",
    "<S> this is limited by uncertainty in the normalisation @xmath3 , whose influence is most pronounced at the high mass end of the mass function . </S>",
    "<S> interestingly , we find that the accuracy with which we can constrain the hmf in terms of the cosmological parameters has now reached the point at which it is comparable to the scatter in hmf fitting functions . </S>",
    "<S> this suggests that the power of the hmf as a precision probe of dark matter and dark energy hinges on more accurate determination of the theoretical hmf . </S>",
    "<S> finally , we assess prospects of using the hmf to differentiate between cold and warm dark matter models based on ongoing improvements in measurements of @xmath1 , and we comment briefly on optimal survey strategies for constraining dark matter and dark energy models using the hmf . </S>"
  ]
}