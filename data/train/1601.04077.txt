{
  "article_text": [
    "the increase of available computational power , together with the development of more accurate and efficient simulation algorithms , have made it possible to reliably predict the properties of materials and molecules of increasing levels of complexity .",
    "furthermore , high - throughput computational screening of existing and hypothetical compounds promises to dramatically accelerate the development of materials with the better performances or custom - tailored properties @xcite .",
    "these developments have made even more urgent the need for automated tools to analyze , classify  @xcite and represent  @xcite large amounts of structural data , as well as techniques to leverage this wealth of information to estimate inexpensively the properties of materials using machine - learning techniques , circumventing the need for computationally demanding quantum mechanical calculations @xcite .    at the most fundamental level ,",
    "the crucial ingredient for all these techniques is a mathematical formulation of the concept of ( dis)similarity between atomic configurations , that can take the form of a distance - that can be used for dimensionality reduction or clustering - or of a kernel function , that could be used for ridge regression or automated classification.@xcite the most obvious choice for a metric to compare atomic structures would involve the euclidean distance between the cartesian coordinates of the atoms , commonly known as root mean square displacement ( rmsd ) distance , that can be easily made invariant to relative translations and rotations .",
    "it is however highly non - trivial to extend the rmsd to deal with situations in which atoms in the two structures can not be mapped unequivocally with each other .",
    "the deterministic evaluation of a `` permutationally invariant '' rmsd scales combinatorially with the size of the molecules to be compared  @xcite , and introduces cusps at locations where the mapping of atom identities changes .",
    "furthermore , as we will discuss later on , the rmsd is perhaps the most straightforward , but not necessarily the most flexible or effective strategy to compare molecular and condensed - phase configurations .    in the last few years",
    ", a large number of `` fingerprint '' functions have been developed to represent the state of structures , or of groups of atoms within a structure .",
    "structural descriptors have been developed based on graph - theoretic procedures ( e.g. sprints  @xcite ) , as well as on analogies with electronic structrure methods ( e.g. hamiltonian matrix , hessian matrix , overlap matrix of gaussian type orbitals ( gto ) or even kohn - sham eigenvalues fingerprints  @xcite ) .",
    "most of these approaches have been introduced to provide a fast and reliable estimate of the dissimilarity between structures .",
    "several other descriptors have been also used in machine learning , to predict properties of materials and molecules circumventing the need for an expensive electronic structure calculation .",
    "a non - comprehensive list of such methods include coulomb matrices  @xcite , bags of bonds  @xcite , `` symmetry functions ''  @xcite , scattering transformation applied on a linear superposition of atomic densities  @xcite .",
    "a particularly promising approach to compare structures in a way that is invariant to rotations , translations , and permutations of equivalent atoms , is to start from descriptors designed to represent _ local _ atomic environments and that fulfill these requirements , and combine them to yield a _ global _ measure of similarity between structures .",
    "this idea typically relies on finding the best match between pairs of environments in the two configurations  @xcite , and can also be traced back to methods developed to compare images based on the matching of local features  @xcite .    in the present work",
    "we start from a recently - developed strategy to define a similarity kernel between local environments  the smooth overlap of atomic positions ( soap)@xcite  and discuss the different ways one can process the set of all possible matchings between atomic environments to generate a global kernel to compare two structures . in particular , we introduce a regularized entropy match ( rematch ) strategy that is based on techniques in optimal - transport theory  @xcite , and that is both more efficient and tunable than previously - applied methods .",
    "we discuss the relative merits of different approaches , and generalize this strategy to the comparison between structures with different numbers and kinds of atoms .",
    "we demonstrate the behavior of the different global kernels when applied to completely different classes of problems , ranging from elemental clusters , to bulk structures , to the conformers of oligopeptides and to a heterogeneous database of small organic molecules .",
    "we visualize the behavior of the distance associated with these kernels using sketch - map  @xcite , a non - linear dimensionality reduction technique , and demonstrate the great promise shown by the straightforward application of the rematch - soap kernel to the machine - learning of molecular properties . finally , we present our conclusions .",
    "let us start by introducing the notation we will employ in the rest of the paper .",
    "we will label structures to be compared by capital letters , use a lowercase latin letter to indicate the index of an atom , and when necessary use a greek lowercase letter to mark its chemical identity .",
    "for instance , the position of the @xmath0-th atom within the structure @xmath1 will be labeled as @xmath2 . the _ environment _ of that atom , i.e. the abstract descriptor of the arrangement of atoms in its vicinity will be labelled with a calligraphic upper case letter , e.g. @xmath3 , and the sub - set of such environment that singles out atoms of species @xmath4 will be indicated as @xmath5 .    among the many descriptors of local environments that have been developed in the recent years@xcite , we will refer in particular to the soap fingerprints @xcite , that have been proven to be a very elegant and robust strategy to describe coordination environments in a way that is naturally invariant with respect to translations , rotations and permutations of atoms .",
    "we will use the notation @xmath6 to indicate the similarity kernel between two environments  which one would use in a kernel ridge regression method  @xcite  and @xmath7 to indicate the ( squared ) kernel distance between the environments  which one would use in a dimensionality reduction method  @xcite . in what follows",
    "we will discuss different ways by which environment kernels can be combined to yield a a _ global _ similarity kernel between two structures @xmath8 , and the associated squared distance @xmath9 .",
    "we will first focus on the comparison between the environment of two atoms in a pure compound made up of single atomic species @xmath4 .",
    "the crucial ingredient in making the comparison is a kernel function based on the distribution of atoms in the two environments . in the context of soap kernels one represents the local density of atoms within the environment @xmath10 as a sum of gaussian functions with variance @xmath11 , centered on each of the neighbors of the central atom , as well as on the central atom itself : @xmath12 the soap kernel is then defined as the overlap of the two local atomic neighbour densities , integrated over all three - dimensional rotations @xmath13 , @xmath14 note that in the @xmath15 case the two integrals can be switched , and therefore the kernel looses all angular information , so we focus on the @xmath16 case exclusively . for most applications it is helpful to normalise the kernel so that the self - similarity of any environment is unity , giving the final kernel @xmath17 it is a remarkable property of the soap kernel that the integration over all rotations can be carried out analytically .",
    "first the atomic neighbour density is expanded in a basis composed of spherical harmonics and a set of orthogonal radial basis functions @xmath18 , @xmath19 then the rotationally invariant _ power spectrum _ is given by @xmath20 collecting the elements of the power spectrum into a unit - length vector @xmath21 , the soap kernel is shown@xcite to be given by @xmath22 eventually leaving a definition of the distance as @xmath23 the soap kernel can be written in the form of a dot product , therefore it is manifestly positive definite , which implies that the distance function   is a proper metric .",
    "the vectors that enter the definition of the environments are defined in such a way that their dot product is the overlap of ( smoothed ) atomic distributions . given two structures with the same number @xmath24 of atoms , we can compute an _ environment covariance matrix _ that contains all the possible pairing of environments @xmath25 this matrix contains the complete information on the pair - wise similarity of all the environments between the two systems . based on it , one can introduce a global kernel to compare two structures or molecules .",
    "we will discuss and compare four different approaches .",
    "all of them are meant to be normalized , i.e. the given expressions for @xmath8 are to be divided by @xmath26 whenever such normalization is not automatically one .",
    "[ [ average - structural - kernel ] ] average structural kernel + + + + + + + + + + + + + + + + + + + + + + + + +    a first possibility to compare two structures involves computing an _ average kernel _",
    "@xmath27      \\cdot      \\left[\\frac{1}{n}\\sum_{j}\\mathbf{p}(\\mathcal{x}^b_{j})\\right ] .",
    "\\end{split } \\label{eq : k - avg}\\ ] ] one sees that @xmath28 can be computed inexpensively by just storing the average soap fingerprint between all environments of the two structures .",
    "this kernel is also positive - definite , being based on a scalar product  @xcite , and therefore induces a metric @xmath29 . on the other hand ,",
    "it is not a very sensitive metric : two very different structures can appear to be the same if they are composed of environments that give the same fingerprint upon averaging .",
    "[ [ best - match - structural - kernel ] ] best - match structural kernel + + + + + + + + + + + + + + + + + + + + + + + + + + + +    another possibility , that has been used previously with different kinds of structural fingerprints  @xcite is to identify the best match between the environments of the two structures , @xmath30 which can be accomplished with an @xmath31 effort using the munkres algorithm  @xcite .",
    "the corresponding distance has the properties of a metric , which means it can still be safely used to assess similarity between structures and molecules .",
    "unfortunately , this `` best - match '' kernel is not guaranteed to be positive - definite , which makes it less than ideal for use in machine - learning applications . furthermore , the distance obtained by a best - match strategy is continuous , but has discontinuous derivatives whenever the matching of environments changes .",
    "these problems can be solved or alleviated by matching the environments based on a different strategy , that combines features of the average and the best - match kernels .",
    "[ [ regularized - entropy - match - kernel ] ] regularized entropy match kernel + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the best match problem can be also stated in an alternative form , namely @xmath32 where @xmath33 is the set of @xmath34 ( scaled ) doubly stochastic matrices , whose rows and columns sum to @xmath35 , i.e. @xmath36 .",
    "we can then borrow an idea that was recently introduced in the field of optimal transport@xcite to _ regularize _ this problem , adding a penalty that instead aims at maximizing the information entropy for the matrix @xmath37 subject to the aforementioned constraints on its marginals .",
    "such `` regularized - entropy match '' ( rematch ) kernel is defined as @xmath38 where the regularization is given by an entropy term @xmath39 .",
    "@xmath40 can be computed very efficiently , with @xmath41 effort , by the sinkhorn algorithm  @xcite ( see appendix  [ app : sinkhorn ] ) . for @xmath42 ,",
    "the entropic penalty becomes negligible , and @xmath43 . for @xmath44",
    ", one selects the @xmath37 with the least information content , that is one with constant @xmath45 .",
    "hence , in this limit @xmath46 .",
    "[ [ permutation - structural - kernel ] ] permutation structural kernel + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the sake of completeness , we also discuss a fourth option : rather than summing over all possible pairs of environments , one can consider each pairing of environments separately , and sum over all the @xmath47 possible permutations that define the pairings . in order to kill off more rapidly the combinations of environments that contain bad matches , one can _ multiply _ the kernels that appear in each pairing , and define a _",
    "permutation kernel _",
    "@xmath48 this choice corresponds to the evaluation of the permanent of the environment kernel matrix , and has some appeal as it is guaranteed to yield a positive - definite kernel  @xcite .",
    "the evaluation of the permanent of a matrix , however , has combinatorial computational complexity .",
    "its application is limited to small molecules , and we will not discuss it further in the present work .      when comparing structures that contain different atomic species , the first problem that has to be addressed is that of extending the local environment metric so that the presence of multiple species is properly accounted for .",
    "soap descriptors provide a very natural way to do this : a separate density can be built for each atomic species @xmath49 and a ( non - normalized ) kernel be defined by matching separately the different species : @xmath50 here we have introduced `` partial '' power spectra that encode information on the relative arrangement of pairs of species , @xmath51 the species - resolved power spectrum @xmath52 can be written as @xmath53 and combines the expansion coefficients @xmath54 of the two densities .",
    "the kernel in eq .   can then be normalized as in eq .  .",
    "note that the so(3 ) power spectrum vectors contain mixed - species components due to the squaring of the density overlap within the rotational average .",
    "these mixed terms guarantee that the kernel is sensitive to the relative correlations of different species , although the overlap between the environments of the different species is considered to be zero .",
    "one could however introduce a notion of `` alchemical similarity '' between different species .",
    "for instance , when comparing structures of iii - v semiconductors one could disregard the chemical information on the identity of an atom as long as it belongs to the same column of the periodic table .",
    "such a notion can be readily implemented , defining an alchemical similarity kernel @xmath55 which is one for pairs that should be considered interchangeable , and tend to zero for pairs that one wants to consider as completely unrelated .",
    "the expression then becomes @xmath56 the original expression   can be recovered by setting @xmath57 .",
    "global similarity kernels can then be transparently introduced to compare structures composed of different atomic species , with structure and alchemical composition treated on the same footings and the possibility of adapting the definition of similarity to the system and application .",
    "the definitions above can be readily extended to compare structures containing different numbers of atoms @xmath58 and @xmath59 .",
    "we discuss two possible strategies .",
    "when comparing crystalline , periodic structures , it may be the case that one of the structures corresponds to a slight distortion of the other , that needs a larger unit cell for a proper representation .",
    "comparing the structures using the average kernel   does automatically the `` right thing '' , that is performing the comparison in a way that is independent of the number of times the two structures have to be replicated to match atom counts . in the case of the permutation kernel and of the best - match kernel ,",
    "the most effective way to perform the comparison is to evaluate the least common multiple @xmath24 of @xmath58 and @xmath59 , and replicate the environment similarity matrix to form a square matrix .",
    "one can then proceed to compute the permanent , or the linear assignment problem , based on such replicated matrix .",
    "the advantage of this procedure is that one does not need to explicitly find the relation between the shape of the two unit cells and replicate them to perform the comparison : the environment similarities can be evaluated including periodic replicas , and the minimum number of comparisons will be naturally performed among any pairs of structures .",
    "however , the least common multiple can become very large , making even the best - match kernel   impractically demanding , although the cost can be reduced by exploiting the redundancy in the extended environment covariance matrix .",
    "as shown in the appendix , the rematch kernel   can be computed easily also for a rectangular matrix , which constitutes an additional advantage of formulating the environment matching problem in terms of a regularized transport optimization .    when comparing molecules or molecular fragments , it may be advisable to proceed differently .",
    "one could consider an idealized pool ( `` kit '' ) of isolated atoms from which a number of molecules will be built , and use them to `` top up '' each molecule so as to obtain a set of structures , all having the same number of atomic environments .",
    "the `` reference kit '' could be chosen dynamically for each pair of molecules , or ",
    "when working with a well defined database  fixed globally as the smallest set of atoms needed to generate all the relevant structures .",
    "one can then define the kernel between an actual atomic environment and those within this `` virtual atom reservoir '' , @xmath60 , in terms of a `` chemical potential '' parameter @xmath61 . since the so(3 )",
    "fingerprints that underlie the definition of the soap kernel can also be evaluated for isolated atoms , it is also possible to introduce a natural definition of the covariance between an environment and an isolated atom , which has the advantage that the global kernels will then vary smoothly during an actual atomization process .      in this work",
    "we will demonstrate the flexibility , transferability and effectiveness of the framework we have just introduced to compare molecular and condensed - phase structures . to this aim",
    ", we will build two dimensional maps that represent proximity relations between the structures  as assessed by the kernel - induced metric  using sketch - map  @xcite , a non - linear dimensionality reduction ( nldr ) scheme specifically designed to deal with atomistic simulation data .",
    "as we will demonstrate , the combination of soap - based structural metrics and nldr representation provides a broadly applicable protocol to generate an insightful representation of the structural and alchemical landscape of complex molecular and condensed - phase systems . of course",
    ", one could use the soap - based global kernels , or the corresponding distances , as the basis of other non - linear dimensionality reduction techniques , such as multi - dimensional scaling  @xcite or diffusion maps  @xcite .",
    "we refer the reader to the relevant literature for a detailed explanation of the sketch - map algorithm@xcite .",
    "the main idea derives from multi - dimensional scaling , and is based on optimizing a non - linear objective function @xmath62- f\\left[d(x_i , x_j)\\right]\\right]^2 \\label{eq : smap}\\ ] ] where @xmath63 and @xmath64 correspond respectively to high - dimensional reference structures and to vectors in a low - dimensional space .",
    "the metric @xmath65 in low dimension is typically taken to be the euclidean distance , whereas the metric in high dimension could be more complex . in this case",
    ", @xmath66 can be regarded as an abstract descriptor of a structure or molecule , and @xmath67 is one of the kernel - based distance metrics discussed above . @xmath68 and @xmath69 are non - linear sigmoid functions of the form @xmath70 which serve to focus the optimization of   on the most significant , intermediate distances , disregarding local distortion ( e.g. induced by thermal fluctuations ) and the relation between completely unrelated portions of configuration landscape .",
    "the choice of the parameters in the sigmoid functions is discussed in ref .",
    "@xcite . here",
    "we will label synthetically each sketch - map representation using the notation ` \\sigma - a_b - a_b ` where @xmath1 and @xmath71 denote the exponents used for the high - dimensional function @xmath68 , @xmath72 and @xmath73 denote the exponents for the low - dimensional function @xmath69 , and @xmath74 the threshold for the switching function .",
    "after having described the theoretical and algorithmic background of our strategy to define a structural similarity kernel , let us present a series of applications . in order to demonstrate that our approach can be seamlessly applied to the most diverse atomistic simulation problems",
    ", we have chosen examples of increasing complexity , from clusters , to crystalline and amorphous solids , to biological molecules and a database of small organic compounds , containing varying number of both atoms and atomic species .",
    "let us start with a relatively simple test case .",
    "we consider the same set of 80 local minima for c@xmath75 discussed in ref .",
    "@xcite , which were obtained by exploring the density functional theory energy landscape of c@xmath75 using the minima hopping  @xcite global structure search algorithm .",
    "figure :  [ fig : c60-corr ] contrasts different similarity matrices : the permutation - invariant rmsd@xcite , the absolute difference between the potential energy , and the best - match distances obtained from soap descriptors computed with different environment cutoff .",
    "rmsd distance does not correlate very well with soap - based metrics , particularly for the smaller cutoff value .",
    "the @xmath76-rmsd correlation plot is enlarged , and allows us to discuss the source of this discrepancy .",
    "hollow fullerene - like structures ( a , with reference to the labeling in the figure ) and compact structures containing internal connections ( a , g ) are extremely different from the point of view of the short - range connectivity , but differ comparatively less in terms of rmsd , since they are both fairly compact . on the other hand , flake - like structures based on a honeycomb motif ( f , e ) have the same basic first - neighbor connectivity as the defective fullerene structures ( c , d ) but have much different spatial extent . then , one sees that the discrepancy between rmsd and small - cutoff @xmath77 indicates just the focus on different structural features : the global arrangement of atoms in the first case , and the local connectivity in the latter . in the case of soap - based metrics , however it is easy to extend the sensitivity of the metric to longer distances just by increasing the cutoff : by going from 2 to 3.5 and 7 , one sees that @xmath77 and rmsd become progressively more correlated , as the focus shifts from the nearest - neighbor coordination to the overall geometry of the cluster .",
    "it is worth stressing that the rmsd , albeit a very natural measure of structural similarity , is not necessarily the best metric to compare configurations . to see why , consider the absolute energy difference as a measure of similarity : even though one can obviously have configurations with very different geometry and similar energies , in general one would expect that on the contrary large energy differences should be associated with highly dissimilar structures in a given system  which is not the case for rmsd .",
    "one sees that the intermediate - cutoff @xmath78 shows a nice correlation between energetic and structural differences .",
    "these considerations underline a theme that will recur in other examples : soap - based structural metrics offer a mathematically sound framework that can be transparently adapted to focus on the aspects that are most relevant to a given application . for instance , power - spectrum based environment kernels are invariant to mirror symmetry , and therefore the derived metrics can not distinguish enantiomers .",
    "if one needed to do so , however , it would be sufficient to use a bispectrum - based soap kernel  @xcite  which corresponds to @xmath79 in eq .",
    "( [ eq : soap - kernel - nonorm ] ) and is invariant to rotations but not to mirror symmetry operations  as the basis for obtaining a global comparison that is sensitive to chirality .    having established a connection between traditional structural similarity metrics and the best - match soap kernel , let us use the example of c@xmath75 to compare the three main strategies we propose to build a global kernel : the average kernel @xmath28 , the best - match kernel @xmath80 , and the regularized entropy match kernel @xmath81 with an intermediate regularization parameter @xmath82 .    the distance - distance correlation plot for each pair of structures , that compares the distances induced by the three kernels , is reported in fig.[fig : c60 ] .",
    "the @xmath83 plot shows overall linear correlation except for very small values of @xmath84 .",
    "this is expected as the average kernel is under - determined , and could in principle label two structures as identical even though they might composed of different environments .",
    "the best - match kernel , therefore , provides better resolving power .",
    "as we will discuss in more detail later on , the regularized best - match kernel @xmath85 can be tuned to interpolate between these two extremes . as an example",
    ", we chose here an intermediate value @xmath82 : as shown in fig .",
    "[ fig : c60 ] , the resulting distance correlates strongly with both @xmath84 and the conventional best - match distance @xmath77 .",
    "fig.[fig : c60 ] also shows annotated sketch - maps obtained based on the three metrics .",
    "once the sketch - map parameters have been adjusted following the guidelines in ref .",
    "@xcite , the three maps are effectively equivalent  indicating that the three kernels give similar qualitative information on the similarity between different structures .",
    "given the much lower computational cost associated with the evaluation of the average kernel , this observation suggests it might conveniently be used to preliminarily screen a dataset before proceeding to a more accurate comparison of similar structures based on the best - match , or rematch distance .      as a second example , let us move on to a condensed - phase application .",
    "here we start from a database of 1274 bulk silicon structures containing ideal and distorted structures from the phase diagram ( e.g. diamond , simple hexagonal , @xmath86-tin , liquid and quenched amorphous structures ) .",
    "soap environment kernels with a 5  cutoff distance were used , and combined with a best - match strategy to obtain the ( dis)similarity matrix using a rematch kernel with a small entropy regularization . ]",
    "we selected 100 landmark configurations out of this data set ( using farthest point sampling based on kernel distance ) and built a sketch - map , on which the rest of configurations were projected .",
    "the outcome of such mapping procedure is shown in fig .",
    "[ fig : silicon ] , where points are colored according to the dft atomic energy , and point sizes are scaled to a size proportional to volume per atom . as seen in the fig .",
    "[ fig : silicon ] the map is extremely well correlated with both atomic energy and density .",
    "furthermore , structures that were obtained by distorting and heating up structures coming from different portions of the phase diagram are clustered together : rough outlines have been drawn on the map to indicate different phases .",
    "although the map has been built using only reference configurations from a few of the conventional si phases , we have also projected on it ( using out - of - sample embedding ) two sets of hypothetical configurations obtained by minima hopping  @xcite and by ab initio random structure search ( airss )  @xcite .",
    "these structures were not included in the landmarks selection phase .",
    "still , the out - of - sample embedding procedure correctly identifies not only that in most cases airss structures differ significantly from stable phases of silicon , but also clusters together hypothetical polymorphs that share common features .",
    "for instance , the airss structures outlined in the lower portion of the map are all taken from ref .",
    "the structures were proposed as possible metastable polymorphs arising as a result of microexplosion ( powerful ultrashort and tightly focused laser pulse ) in crystalline cubic diamond silicon phase , hence their structural motif naturally carries resemblance with silicon diamond phase .",
    "it is interesting to see that they indeed are projected close to the diamond phase on the map .",
    "all of the minima hopping low - density si polymorphs are also clustered together , which is consistent with the fact that they are all based on combinations of a few base motifs .",
    "thus , figure  [ fig : silicon ] shows not only that soap - based structural similarity distances can be very effective in the study of bulk crystalline structures , but also testify the extrapolative power of a sketch - map representation based on such a metric .",
    "the structures that have undergone a proton transfer reaction relative to the neutral molecule have been highlighted , and a few representative snapshots of the molecular structure are also reported . ]",
    "having shown that soap - based structural similarity kernels are equally effective for clusters and for bulk configurations of elemental materials , let us consider a case of a multi - species chemical compound .",
    "we selected a library of 5062 locally stable conformers of arginine dipeptide ( 845 with and 4217 without a ca@xmath87 counterion ) from a public database of oligopeptides structures developed by matti ropo et al @xcite .",
    "we used a cut - off of 3.5 in the definition of environment soap kernels , and combined them using a best - match strategy .",
    "since h atoms stay at almost fixed positions relative to their neighboring atoms , we decided to include them in the environment descriptors of other atoms , but did not include them explicitly as centers of atomic environments .",
    "this is another example of how soap - based structural metrics are effective in a broad variety of contexts , but at the same time can be easily and transparently refined based on intuition , prior experience , or a clear understanding of the objectives of the structural comparison .    in fig .",
    "[ fig : arg - cfg ] we show the sketch - map representation for these two sets of structures , highlighting the correlation between the location on the map and structural and energetic properties of the conformers . in the absence of a complexing cation",
    ", the dipeptide can exist in a very large number of local minima , spanning a relatively narrow range of energies .",
    "the map shows very clearly partitioning of configuration space in four disconnected regions .",
    "conventional wisdom  @xcite assumes that the c@xmath88 dihedral angles @xmath89 and @xmath90 are the most important descriptors of oligopeptide structure .",
    "one quickly realizes , however , that the order parameters corresponding to the four lobes are connected to the cis - trans isomerization of the two peptide bonds . within each of the lobes , configurations with different @xmath89-@xmath90 dihedral angles",
    "are clearly clustered together , but in this case they constitute features of secondary importance .",
    "this observation demonstrates the advantages of using a general - purpose descriptor , that does not rely on pre - conceived assumptions on the behavior of the molecule being studied , but instead captures automatically the intrinsic structural hierarchy of minima in the configuration landscape .",
    "the presence of a ca@xmath87 cation has a dramatic impact on the landscape for the dipeptide .",
    "the distribution of configurations becomes considerably more sparse and span a broader range of energies .",
    "the strong electrostatic interaction with the cation means that there is not a clear separation anymore between the energy scale for @xmath89-@xmath90 flexibility of the backbone and the isomerization of the peptide bonds .",
    "a remarkable observation in this analysis is the realization that the presence of the cation catalyzed unexpected proton transfer reactions , that change the chemical structure of the molecule .",
    "configurations that underwent a chemical reaction are clustered on one side of the map ( fig .",
    "[ fig : arg - chem ] ) , with further internal structure reflecting the fact that soap - based structural metrics treat on the same footing information on the chemical bonding and on the conformational variability of the molecule .",
    "it is again worth noting that by changing the cut - off value for the soap descriptors , one can `` focus '' the structural metric on different molecular features .",
    "a short cutoff of 2 makes the chemically different structures stand out more as outliers  which would for instance be useful to detect automatically this kind of unwanted transitions in an automatically - generated data set  while on the contrary a longer cutoff would give more importance to the difference between collapsed and extended molecular conformers .    , the best - match kernel @xmath80 , and _",
    "regularized _ best - match kernels @xmath81 with different regularization parameters @xmath91 .",
    "distances are computed between pairs of 200 structures , randomly selected from the qm7b database@xcite . ]          as a final example of the evaluation of a structural and alchemical similarity metric , and its use to represent complex ensembles of compounds , let us consider the qm7b database  @xcite .",
    "this set of compounds contains 7211 minimum - energy structures for small organic compounds containing up to seven heavy atoms ( c , n , o , s , cl ) , saturated with h to different degrees .",
    "this database constitutes a small fraction of a larger chemical library that contains millions of hypothetical structures screened for accessible synthetic pathways  @xcite .",
    "this is an extremely challenging data set to benchmark a structural similarity metric : molecules differ by number of atoms , chemical composition , bonding and conformation . to simplify the description",
    ", we decided to use soap descriptors with a cutoff of 3 , and to include h atoms in the environments but not as environment centers , to simplify the description  considering also that in the case of arginine dipeptide this choice did not prevent clear identification of isomers that only differed by a proton transfer reaction .",
    "we used a best - match strategy to compare configurations , and topped them up with isolated atoms up to the maximum number of each species that is present in the database .",
    "this effectively corresponds to choosing a `` kit '' ( in other terms , a fully atomized reference state ) starting from which all of the compounds can be assembled .",
    "this is a fairly extreme case for the application of our idea of compounding local structure matching to obtain a global structural metric , so it is worth returning on a comparison of the different strategies we proposed .",
    "[ fig : qm7b - corr ] compares average and best - match distances , together with the rematch using different regularization parameters . despite the very different context ,",
    "the outcome is similar to what we observed in figure  [ fig : c60 ] for c@xmath75 clusters .",
    "the average kernel is reasonably well correlated with the more demanding best - match kernel , although in most cases it has poorer resolution . by varying @xmath91",
    ", the regularized match distance @xmath85 varies between these two extremes , and for @xmath92 provides a smooth , inexpensive approximation to the best - match distance .    for the sake of simplicity ( and",
    "given we reduced the size of the environment covariance matrix @xmath93 by considering only heavy atoms as environment centers ) we used the conventional best - match distance for the rest of our analyses .",
    "as shown in fig .",
    "[ fig : qm7b ] , the soap - based metric nicely separates out `` islands '' with homogeneous composition in terms of the number of heavy atoms . within each group of atoms",
    ", one can recognize some sub - structure , with configuration roughly arranged in terms of the atomization energy  which in turns strongly correlates with the degree of h saturation . as it can be seen from inspection of the database ( see the si ) in many cases one can notice that structures with similar chemical skeleton ( presence of cycles , chemical groups , etc . ) are clustered close to each other in the map .",
    "however , it is of course very difficult to quantitatively assess how well the map corresponds to chemical intuition , and how much departures from it are to be considered a failure of the metric , of the sketch - map procedure or of the notion of `` chemical intuition '' .",
    "our objective here is more to demonstrate how the fingerprint - based structural metric we introduced can cope with widely different classes of problems , and how it can treat on the same footings alchemical and structural variability . as an example",
    "we have also computed the similarity matrix and mapped the qm7b landscape using a modified alchemical similarity metric between the heavy atoms ( we always take @xmath94 ) .",
    "first , we set @xmath95 ( which means we are treating species @xmath4 and @xmath86 as the same species ) for all of heavy atoms .",
    "the clear separation of the map into islands with the same stoichiometry is lost .",
    "however , there is now near - perfect correlation between position on the map and atomization energy , and at the same time one can see some residual clustering of molecules with similar composition .",
    "this can be explained because information on the alchemical identity of the atoms is encoded in their atomic coordination and bond lengths .",
    "this is for instance evident for sulfur , that has considerably larger bond lengths , leading to a clustering of sulfur - containing compounds that is considerably better than for instance in the case of oxygen or nitrogen .",
    "obviously , assuming that all atom kinds are interchangeable is an extreme choice , and it is hard to imagine circumstances in which this `` element agnostic '' metric would be advantageous over one that exploited knowledge of the chemical identity of atoms . on the other hand , one could foresee to encode information on the `` alchemical similarity '' using one of the many quantities chemists have used historically to rationalize trends in reactivity across the periodic table . as an example",
    ", we used the electronegativity @xmath96 to define @xmath97 where @xmath98 is a parameter that determines how sensitive is the alchemical kernel to differences in electronegativities .",
    "we used @xmath99 to generate the last set of maps in fig .",
    "[ fig : qm7b ] .",
    "the map now separates out quite accurately regions with homogeneous stoichiometry . whereas in the @xmath57 the different `` islands",
    "'' were roughly arranged according to a square grid pattern corresponding to @xmath100 and @xmath101 along two orthogonal directions , now stripe - shaped islands are arranged in 1d , following numbers of @xmath100 and @xmath102 , with the number of nitrogen atoms coming out clustered in adjacent `` stripes '' , but less clear - cut partitioning than for the other two elements .",
    "this is perhaps unsurprising given that nitrogen has an intermediate electronegativity between that of oxygen and carbon , and the metric tries to separate most efficiently the elements that differ most based on the alchemical similarity kernel .",
    "this last example gives perhaps the most compelling demonstration of how a structural similarity metric based on a combination of soap kernels gives an effective , broadly applicable and easily customizable strategy to assess the similarity of materials and molecules , and how a sketch - map construction based on such metric provides an insightful representation of structural and alchemical landscapes .",
    "in this paper we focused mainly on the definition of a compound structural similarity kernel , and on characterizing its behavior by means of sketch - map representations .",
    "it is however important to keep in mind that an effective tool to compare atomic structures can find application to a broad range of problems - one of the most intriguing being the inexpensive prediction of physical - chemical properties of materials and molecules . to demonstrate the great promise of rematch - soap kernels for machine - learning of molecular properties , we used a standard kernel - ridge regression ( krr ) method  @xcite to reproduce the 14 properties that had been reported in ref .",
    "@xcite for the 7211 molecules we described in the previous paragraph .",
    "we randomly selected 5000 training structures , and used the remainder as an out - of - sample validation set .",
    "after having computed the rematch - soap kernel matrix @xmath103 between all the structures , using a cutoff of 3 and a regularization parameter @xmath104  in this case including also h atoms in the list of environments  we computed the krr weights vector @xmath105 here @xmath106 and @xmath107 are the kernel matrix and property values restricted to the training set , @xmath108 indicates entry - wise exponentiation to tune the spatial range of the kernel , and @xmath74 is a regularization hyperparameter .",
    "the prediction of the properties for the test set can then be obtained as @xmath109 , where @xmath110 is the matrix containing the rematch - soap kernels between the test points and the training points .",
    "the procedure was repeated 10 times , and the average mean absolute error ( mae ) and root mean square error ( rmse ) on the test set were computed .",
    "we optimized the @xmath108 and @xmath74 hyperparameters by minimising the mae on the atomization energy , and then used the same values to perform a krr for all the other molecular properties .",
    "since we did not further adjust the choice of kernel and the @xmath108 exponent , all the properties could be estimated at the same time , as discussed e.g. in @xcite .",
    "the results of this procedure are reported in table  [ tab : krr - data ] , and demonstrate the extraordinary performance of rematch - soap for machine - learning applications .",
    "for the atomization energy we can obtain a mae of less than 1kcal / mol  a four - fold improvement relative to previous results that were based on a coulomb matrix representation of structures and a deep - neural - network learning strategy .",
    "what is more , even without separately tuning the krr hyperparameters , we can improve or match the performance of prior methods for almost all of the properties , the only exceptions being some of the properties computed with semi - empirical methods .",
    "the fact we can obtain such a dramatic improvement using a standard regression technique is a testament to the effectiveness of our kernel .",
    "the crucial importance of the choice of descriptors is also apparent by noting that a mae of about 1.5 kcal / mol was recently obtained by regression based on a `` bag of bonds '' description of molecules , coupled with a laplacian kernel  @xcite .",
    "reaching chemical accuracy in the automated prediction of atomization energies is an important milestone , and the fact that we could achieve that without fully exploring the flexibility of the rematch - soap framework ( e.g. by optimizing the entropy regularization parameter , the environment cutoff , eliminating the outliers , combining multiple layers of description or using a non - diagonal alchemical similarity matrix ) is a testament to the potential of our approach .",
    "future work will be devoted to analyzing the performance , convergence and limits for the machine - learning of molecular and materials properties using our soap - based structural similarity kernel .",
    ".mean absolute errors ( maes ) and root mean square errors ( rmse ) for the krr estimation of 14 molecular properties , together with previously published estimation  @xcite for the same data set .",
    "the standard deviation of the values of the properties across all 7211 molecules in the database is shown in the second column .",
    "errors in the krr estimation refer to a test set of  2200 randomly selected configurations , while the remaining structures were used for training .",
    "property labels refer to the level of theory and molecular property , i.e. atomization energy ( e ) , averaged molecular polarizability ( @xmath4 ) , homo and lumo eigenvalues , ionization potential ( ip ) , electron affinity ( ea ) , first excitation energy ( @xmath111 ) , excitation frequency of maximal absorption ( @xmath112 ) and the corresponding maximal absorption intensity ( @xmath113 ) .",
    "energies , polarizabilities and intensities are in ev , @xmath114 and arbitrary units , respectively . [ cols=\"<,^,^,^,^,^\",options=\"header \" , ]",
    "distances between atomic structures based on combinations of local similarity kernels provide a flexible framework to define a metric in structural and alchemical space .",
    "atom - centered environment information can be combined to provide a global measure of ( dis)similarity .",
    "an average kernel @xmath28 provides an inexpensive strategy to do so , with a cost that scales linearly with the size of the structures to be compared , but might under - estimate the difference between two configurations  since in principle two different structures might yield zero @xmath84 .",
    "alternatively , one can compute the local kernel between every possible pair of environments ( which itself entails a cost scaling with the square of the number of environments ) , and then build a compound kernel @xmath80 by finding the best - match permutation of the environments  which gives a metric with better resolving power , but entails solving a cubic - scaling linear assignment problem . introducing an entropy regularization",
    "makes it possible at the same time to reduce the size - scaling to quadratic , and to obtain a better behaved , smoothly varying metric , that interpolates - depending on the regularization parameter - between the average and best - match limit .",
    "this strategy to compare atomic configurations builds on the very general notion that complex bulk and molecular structures arise from the combination of local building blocks , and can be applied seamlessly to systems as diverse as clusters , bulk phases of an element , conformation of a biomolecules and an assembly of small chemical compounds with varying atom kinds and number . at the same time",
    ", the structure of the underlying soap kernels allows for very effective fine - tuning .",
    "for instance , by choosing the cutoff radius over which atomic densities are compared between environments , one can make the metric more sensitive to the first - neighbor chemical connectivity , or vice versa , include information on the long - range conformation of flexible molecules .",
    "what is more , it is possible to treat structural and alchemical complexity on the same footing , by introducing an alchemical similarity kernel that makes it possible to specify whether atoms of different species should be considered completely separate , or whether a notion of chemical distance ( based e.g. on the difference in electronegativity ) should be introduced to give different weights to substitutions between elements with similar reactivity .    we also demonstrate that straightforward application of the rematch - soap kernel to the ridge - regression evaluation of molecular properties matches or outperforms all previously - presented approaches , reaching chemical accuracy in the prediction of the atomization energies of a set of small organic molecules .",
    "we believe that in this respect we are only scratching the surface of the potential applications of our approach to machine - learning , since these results were obtained without using any of the more sophisticated techniques ( e.g. introducing a hierarchy of models to capture the variance of properties at different structural scales ) that have been shown to significantly improve this kind of procedures when using different kinds of structural descriptors .",
    "the similarity metric we introduce could find application as the workhorse of a number of simulation protocols , machine - learning algorithms and data mining strategies .",
    "for instance , it could be used to detect outliers in automated high - throughput screenings of materials , to cluster similar configurations together , to accelerate the exploration of chemical and conformational space of materials and molecules . here , we show in particular how it can be combined with a non - linear dimensionality reduction technique such as sketch - map , to give simple and insightful two - dimensional representation of a given molecular or structural data set . as atomistic modelling adventures into larger - scale structures , and unsupervised exploration of materials space",
    ", maps such as these can provide a valuable tool to convey intuitive information on complex structural and alchemical landscapes , to rationalize structure - property relations , and to predict physical observables of novel compounds by training machine - learning models to libraries of known materials .",
    "s.d and m.c would like to acknowledge support from the nccr marvel .",
    "a.p.b . was supported by a leverhulme early career fellowship with joint funding from the isaac newton trust .",
    "we would like to thank m. cuturi and c. ortner for insightful discussion .",
    "we thank c. pickard for providing silicon structures found with airss , and s. goedecker and m. amsler for sharing with us the crystal structures of low - density silicon polymorphs .",
    "let us discuss briefly how the rematch can be implemented in practice .",
    "consider for generality the @xmath115 environment similarity matrix @xmath116 between two structures with @xmath24 and @xmath117 atoms respectively .",
    "the expression   given in section  [ sec : theory ] for the optimal - transport - inspired definition of @xmath80 generalizes straightforwardly to non - s quare matrices  @xcite : @xmath118 where @xmath119 is a ( scaled ) doubly - stochastic @xmath115 matrix for which @xmath120 and @xmath121 .    the sinkhorn algorithm finds the optimal @xmath40 by the decomposition @xmath122 , where @xmath123 indicates the hadamard product , and @xmath103 is the entry - wise exponential of @xmath124 , i.e. @xmath125.\\ ] ] the balancing vectors @xmath126 and @xmath127 can be obtained by the iteration @xmath128 where @xmath129 are scaled stochastic vectors , and the iteration can be initialized by setting @xmath130 .",
    "one of the advantages of a regularized match strategy is that the kernel becomes a smooth function of the environment kernels .",
    "computing its derivative @xmath131 with respect to a parameter @xmath4 ( a cartesian coordinate , for instance ) , is however not completely trivial .",
    "such a derivative is in fact composed of two terms @xmath132 the first term is easy to compute  provided that one can obtain @xmath133 , the derivative of all environment kernels with respect to @xmath4 .",
    "the second term can be further broken down based on the sinkhorn decomposition of @xmath40 : @xmath134 the critical issue here is that direct evaluation of @xmath135 would involve performing a separate calculation for each derivative @xmath4 , which could make the approach prohibitively expensive when , for instance , one would want to compute derivatives with respect to the coordinates of each atom .    by straightforward albeit tedious algebra",
    ", one can reformulate the problem in such a way that the derivative can be computed cheaply for any variational parameter , given @xmath133 : @xmath136 with @xmath137.\\ ] ]    the @xmath138 matrix can be fully evaluated based on intermediate terms that do not depend on @xmath139 : @xmath140\\\\ \\mathbf{c}= & n\\left(\\mathbf{b}\\circ\\mathbf{u}^{2}\\right)\\mathbf{k}\\\\ \\mathbf{w}= & { \\ensuremath{\\operatorname{diag}}}\\left(n\\mathbf{u}^{2}\\right)\\mathbf{k}{\\ensuremath{\\operatorname{diag}}}\\left(m\\mathbf{v}^{2}\\right)\\mathbf{k}^{t } , \\end{split}\\ ] ] were with @xmath141 we indicate the entry - wise square .",
    "the only caveat here is that @xmath142 is singular , and so it can not be straightforwardly inverted .",
    "nevertheless , @xmath143 can be computed by the fixed - point iteration @xmath144 with @xmath145 $ ] . due to the potential instability of the procedure , it is crucial however to check the convergence on the overall value of @xmath131 , and not to push the convergence to higher relative accuracy levels than those used for the original solution to the sinkhorn balancing problem .",
    "60ifxundefined [ 1 ] ifx#1 ifnum [ 1 ]",
    "# 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1103/physrevlett.114.105503 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.014106 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.094306 [ * * ,   ( ) ] http://dx.doi.org/10.1038/srep06367 [ * * ,   ( ) ] http://dx.doi.org/10.1038/sdata.2014.22 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.155136 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1109/tnn.2005.845141 [ * * ,   ( ) ] in  link:\\doibase    10.1109/kam.2009.98 [ _ _ ] ,  vol .",
    "( )  pp .",
    "link:\\doibase    10.1021/cm503507h [ * * ,   ( ) ] ,   http://dx.doi.org/10.1038/srep13285 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.108.058301 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.104108 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.89.235411 [ * * ,   ( ) ] http://dx.doi.org/10.1038/srep02810 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.88.054104 [ * * ,   ( ) ] @noop * * ,   ( ) @noop ( ) http://stacks.iop.org/1367-2630/15/i=9/a=095003 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.108.253002 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.045131 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.24375 [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jpclett.5b00831 [ * * ,   ( ) ] ,  ,   link:\\doibase 10.3835/plantgenome2011.08.0024 [  * * ( ) , 10.3835/plantgenome2011.08.0024 ] in  link:\\doibase 10.1109/cvpr.2007.383105 [ _ _ ]  ( )  pp .",
    "@noop _ _ ( ,  ) @noop _ _ ,  springer series in statistics  ( ,  ,  ) @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.107.085504 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.3553717 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.3553717 ] @noop ( ) ,   @noop * * ,   ( ) @noop * * , ( ) in  @noop _ _ , ( ,  ) pp .",
    "@noop * * ,   ( ) @noop _ _ ,  , vol .",
    "( , ,  ) link:\\doibase 10.1103/physrevlett.106.225502 [ * * , ( ) ] link:\\doibase 10.1063/1.4828704 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.112.083401 [ * * ,   ( ) ] @noop * * ,   ( ) @noop ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) link:\\doibase    10.1063/1.1724816 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/23/i=5/a=053201 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.014101 [ * * ,   ( ) ] http://dx.doi.org/10.1038/ncomms8555 [ * * ( ) ] @noop ( ) ,   \\doibase    http://dx.doi.org/10.1016/s0022-2836(63)80023-6 [ * * ,   ( ) ] link:\\doibase 10.1021/ci600423u [ * * ,   ( ) ] ,  , @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> evaluating the ( dis)similarity of crystalline , disordered and molecular compounds is a critical step in the development of algorithms to navigate automatically the configuration space of complex materials . </S>",
    "<S> for instance , a structural similarity metric is crucial for classifying structures , searching chemical space for better compounds and materials , and to drive the next generation of machine - learning techniques for predicting the stability and properties of molecules and materials . in the last few years several strategies </S>",
    "<S> have been designed to compare atomic coordination environments . in particular , the smooth overlap of atomic positions ( soap ) has emerged as a natural framework to obtain translation , rotation and permutation - invariant descriptors of groups of atoms , driven by the design of various classes of machine - learned inter - atomic potentials . here </S>",
    "<S> we discuss how one can combine such local descriptors using a regularized entropy match ( rematch ) approach to describe the similarity of both whole molecular and bulk periodic structures , introducing powerful metrics that allow the navigation of alchemical and structural complexity within a unified framework . </S>",
    "<S> furthermore , using this kernel and a ridge regression method we can also predict atomization energies for a database of small organic molecules with a mean absolute error below 1kcal / mol , reaching an important milestone in the application of machine - learning techniques to the evaluation of molecular properties . </S>"
  ]
}