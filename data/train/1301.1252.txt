{
  "article_text": [
    "just over 50 years ago , kasteleyn @xcite and fisher and temperley @xcite presented analytic combinatorial methods for counting dimer packings on a lattice ; these techniques were soon applied @xcite to computing the partition function for the pure ferromagnetic two - dimensional ising model @xcite .",
    "these methods continue to be extended and improved to study two - dimensional models in statistical mechanics .",
    "such methods were then extended @xcite to numerically compute the thermodynamic properties of disordered magnets .",
    "they have allowed for a precise and extensive study of the statistical mechanics of disordered models @xcite .",
    "this paper presents a detailed description of a numerical approach to implement these combinatorial techniques .    to review the power of these techniques in more detail , consider an ising model where spins on a planar lattice can take on one of two values and the energy",
    "is given by the sum over possible ferromagnetic or antiferromagnetic interactions between pairs of neighboring spins .",
    "directly evaluating the partition function of this model with @xmath0 spins involves a sum of boltzmann factors over the @xmath1 spin configurations .",
    "but combinatorial techniques allow for a much more compact evaluation .",
    "the ising configurations can be put into correspondence with dimer coverings on a related lattice , where dimer coverings are choices of edges so that each node of the lattice is in exactly one chosen edge",
    ". weighted sums @xmath2 over all dimer coverings give the partition function @xmath3 for the ising problem , with @xmath4 .",
    "the sum over all dimer coverings can in turn be expressed as the pfaffian @xcite of a weighted and signed adjacency - like matrix , the kasteleyn matrix @xcite ; for a skew - symmetric matrix , the square of its pfaffian is equal to its determinant .",
    "for the specific case of regular lattices and interactions , the pfaffians can even be evaluated analytically by direct diagonalization of the kasteleyn matrix @xcite , allowing for exact evaluation of thermodynamic quantities and studies of phase transitions .",
    "pfaffians ( or also determinants ) of @xmath5 matrices can be defined directly as the sum over permutations whose number grows exponentially with @xmath6 , but the matrix can be be simplified by column and row eliminations , so that the pfaffian ( or determinant ) can be evaluated in time polynomial in @xmath6 . as the kasteleyn matrix used here is of size @xmath7 ,",
    "@xmath3 can be found for general planar ising models in time polynomial in @xmath0 .",
    "( note that as the arithmetic precision needed for a stable calculation of @xmath3 depends on @xmath8 , there is a @xmath8 dependent prefactor for the running time which scales roughly as @xmath8 @xcite . )",
    "this technique was subsequently generalized to include inhomogeneous couplings between nearest neighboring ising spins by saul and kardar @xcite for numerical work . in the ising spin glass",
    ", the nearest neighbor interactions can be either ferromagnetic or antiferromagnetic .",
    "for a given random choice of couplings of arbitrary sign , the pfaffian of the kasteleyn matrix can be computed and used to derive thermodynamic potentials and susceptibilities .",
    "if the couplings are of fixed magnitude @xmath9 but random sign ( the bimodal distribution ) , the exact dependence of @xmath3 on inverse temperature @xmath8 can be written as a polynomial in @xmath10 @xcite .",
    "more generally , this numerical approach has allowed for a detailed study of the thermodynamics of the 2d ising spin glass , even with continuous disorder distributions .",
    "one example of the more important recent developments in these algorithms has been the application of nested dissection and integer arithmetic @xcite for computing @xmath11 for the bimodal distribution in larger systems .",
    "applying wilson s dimer sampling technique @xcite , this numerically exact approach has also been used to generate random samples of configurations of random ising models @xcite .",
    "this sampling method bypasses the long equilibration times that arise in markov chain monte carlo methods .    in this paper",
    ", we describe a version of nested dissection as applied to the pfaffian techniques , with the goal of simplifying and extending the calculation of correlation functions and sample configurations . for a two - dimensional ising sample with arbitrary nearest - neighbor couplings ,",
    "we describe how this technique can be used to compute the partition function , to calculate correlation functions , and to randomly choose sample spin configurations .",
    "we find that , due to near cancellations of intermediate sums , multiple precision floating point arithmetic is needed to find accurate results at temperatures of interest for system sizes of size about @xmath12 or larger ( though the sets of integer fields used in ref .",
    "could also be used for the partition function in the bimodal case ) .",
    "we note that correlation functions were computed at @xmath13 by blackman and poulter for the bimodal case @xcite using a different approach .",
    "we simplify the sampling technique used in our previous work @xcite by simplifying the matrices and by using a different approach to maintain computed correlation functions as spins are sampled .",
    "many of these improvements are based on the find ( fast inverse using nested dissection ) algorithm @xcite which computes desired elements of a matrix inverse quickly and was developed to compute nonequilibrium green s function applications in nanodevices .",
    "this particular flavor of hierarchical decomposition is very well suited to the geometry of the mapping between two - dimensional ising models and dimer coverings .",
    "while much of this algorithm is implicit in previous work , we assemble these methods into a form adapted to studying the statistical mechanics of the ising model , with novel applications to computing correlation functions , and emphasize the nature of the algorithms as a renormalization procedure and clarify the sampling procedure .",
    "this formulation is also significantly faster in practice .",
    "we present comparisons with analytic results , sample results for the spin glass case , and empirical results for the timings .",
    "a version of the computer code for computing partition functions , written in c++ , is available in the supplemental materials for this paper at [ publisher url ] or by download @xcite .",
    "extensions of this version of the code have been checked against analytic predictions for correlation functions in the ferromagnet and against other exact codes for small spin glass samples .",
    "this code can be used to study pure , random bond , and spin glass models .",
    "in this section , we state the standard ising spin glass hamiltonian and recall the mapping between ising spin configurations and dimer coverings @xcite . we also review the definition of the pfaffian of the kasteleyn matrix and its relation to the partition function of the ising model .",
    "a state @xmath14 of the ising model in two dimensions on a rectangular sample composed of @xmath15 spin variables @xmath16 is given by a choice for each @xmath16 , where each @xmath16 is restricted to @xmath17 .",
    "the @xmath18 sites @xmath19 lie on a square grid .",
    "there are @xmath20 possible spin configurations in the state space @xmath21 .",
    "the statistical mechanics of this model is governed by the standard hamiltonian @xmath22 where the sample - dependent bond strengths @xmath23 are quenched , i.e. , fixed in time , and connect nearest neighbor spin pairs @xmath24 .",
    "the spins lie on the nodes of a graph @xmath25 whose edges @xmath26 connect these nearest neighbor pairs . for open or free boundary conditions or for fixed spins on the boundaries ,",
    "these pairs form the edges of a planar graph . for periodic boundary conditions , nearest neighbor pairs @xmath26 include bonds that wrap the sample around a torus by connecting the top row of the array to the bottom row and the right column to the left column . in equilibrium at temperature @xmath27 ,",
    "the probability @xmath28 of a spin state @xmath14 is @xmath29 , where the partition function is @xmath30 .",
    "numerical derivatives of @xmath11 with respect to @xmath31 allow for the computation of energy @xmath32 , the entropy @xmath33 , and the heat capacity @xmath34 .",
    "exact sampling will be taken to mean that configurations @xmath14 are generated with the correct probability @xmath28 , within numerical accuracy .",
    "the correlation functions that will be computed by the algorithm are spin - spin correlation functions , @xmath35 , where the average is taken over all configurations weighted by their equilibrium probability , i.e. , @xmath36 .",
    "computing these correlations allows for a direct measure of the correlation length and the density of relative domain walls .",
    "though we describe the techniques using square lattice samples with open boundaries or with periodic boundaries , the techniques presented generically apply to arbitrary graphs on low - genus surfaces @xcite .",
    "a given spin configuration @xmath14 in the ising model can be represented by a set of relative domain walls and by the value of a single spin .",
    "these domain walls can be defined relative to any reference spin configuration @xmath37 ; one simple choice for @xmath37 is the fixed direction configuration @xmath38 , with all @xmath39 .",
    "this is the choice that we will use in this paper .",
    "( another example choice would be a ground state configuration @xmath40 that minimizes @xmath41 . )",
    "the domain walls divide the spins into connected sets of spins that are either all aligned with or all opposite to the spins in @xmath37 .",
    "these domain walls can be drawn as loops on the dual graph @xmath42 .",
    "the graph @xmath42 has nodes at the center of each ( square ) plaquette of @xmath25 .",
    "the edges of @xmath42 are dual to the edges in @xmath25 : they are in one - to - one correspondence , with each edge in @xmath42 crossing one edge in @xmath25 . given an arbitrary spin configuration @xmath14 and a nearest neighbor pair of spins @xmath24 , the dual edge that crosses the bond connecting @xmath19 to @xmath43 is in a domain wall if @xmath44 . for the choice @xmath45",
    ", the domain walls separate up spins from down spins . as the domain walls are closed loops , an even number of domain wall segments",
    "meet at each node in @xmath42 .",
    "the configurations in the ising model may be put into correspondence with a complete dimer covering problem on a decorated dual graph @xmath46 . for the case we are considering , where @xmath25 is a square grid ,",
    "each node of @xmath42 can be replaced by a kasteleyn city @xcite , which is a subgraph composed of four fully connected nodes .",
    "( note that a kasteleyn city can be found from a fisher city @xcite by pfaffian elimination . ) by replacing each lattice point in the dual @xmath42 with a kasteleyn city , one arrives at the decorated dual graph @xmath46 shown in fig .",
    "[ fig : dimers ] .",
    "this larger graph allows for a correspondence between domain walls , equivalent to ising spin configurations up to a global spin flip @xmath47 , and dimer matchings on @xmath46 . for each set of domain walls",
    ", there is at least one corresponding dimer covering on the decorated dual lattice @xmath46 .",
    "the computation of the partition function @xmath3 for the ising model , a sum over all assignments of ising spins , can be directly expressed as a related sum over complete coverings of either @xmath48 , the decoration of the graph @xmath25 by kasteleyn cities @xcite , or coverings of @xmath46 . for sampling and computing correlation functions , though , it is simpler to start with the decorated dual graph @xcite . in a pure ising model ,",
    "summing over matchings on @xmath48 corresponds to a high temperature expansion @xcite , while sums over @xmath49 correspond to a low temperature expansion .",
    "there is a simple correspondence between domain wall loops in @xmath46 and spin configurations : given a set of domain walls , spins are found by setting spins within a single connected region to the same value .     for a periodic spin lattice of size @xmath50 . a sample configuration of ising spins @xmath17 are represented by the arrows inside the large circles",
    "these spins are coupled by horizontal and vertical bonds of strength @xmath23 .",
    "the ( red ) dashed lines indicate the bonds for one example spin .",
    "the spins and bonds are the vertices and edges , respectively , of the ising model graph @xmath25 .",
    "the nodes of the decorated dual graph @xmath46 are drawn as small circles and the edges are indicated by the thin and thick solid lines .",
    "the edges of @xmath46 are either internal to a kasteleyn city ( the sets of 4 fully connected nodes ) or connect neighboring cities .",
    "those that are internal to a city have a weight of @xmath51 while those connecting cities have a weight @xmath52 , where the @xmath23 is the coupling strength of the bond crossing the dual edge .",
    "an example of a complete dimer covering @xmath53 corresponding to the displayed spin configuration is indicated by the heavy lines : such a choice of edges includes all nodes in @xmath46 exactly once .",
    "the intercity edges belonging to the covering @xmath53 separate the up spins from the down spins and so compose the relative domain walls ( here we are assuming that the reference configuration @xmath37 is the configuration with all spins up , @xmath54 ) . note that for any kasteleyn city surrounded by 4 spins of identical sign , there are 3 ways to arrange the dimers on that city .",
    "two examples of these arrangements can be seen in the lower left and lower right cities . in other cases ,",
    "the choice of kasteleyn city edges is uniquely determined by the domain walls .",
    ", width=288 ]    the configurations contributing to the partition function sum correspond to terms in the expansion of the pfaffian of the kasteleyn matrix @xcite : to describe this correspondence , we first need to define the kasteleyn matrix and the pfaffian sum .",
    "the kasteleyn matrix @xmath55 is a skew - symmetric matrix with non - zero entries for each edge of the decorated graph @xmath49 ; the rows and columns of the matrix are indexed by the vertices of the decorated graph .",
    "skew symmetry implies @xmath56 .",
    "a non - zero entry @xmath57 corresponds to an edge in @xmath49 connecting vertices @xmath58 and @xmath59 .",
    "it is a matrix of size @xmath7 .",
    "the values of the matrix are @xmath60 for edges internal to kasteleyn cities .",
    "edges that connect cities have weights with absolute value @xmath61 , where spins @xmath19 and @xmath43 have coupling @xmath23 and the edge @xmath62 in @xmath25 crosses the edge @xmath63 in @xmath49 .",
    "the sign of each @xmath57 is determined by a pfaffian orientation of the dimer graph ( see , e.g. , ref .  ) . for the graph @xmath49",
    ", a simple pfaffian orientation is that horizontal edges between kasteleyn cities are oriented from left to right and vertical intercity edges are oriented from bottom to top , so that if @xmath58 is to the left of @xmath59 or @xmath59 is above @xmath58 , @xmath64 .",
    "the orientation of edges internal to a kasteleyn city can then be set as in ref .",
    "@xcite or as described in sec .",
    "[ fig : mwab ] . given a proper choice of signs for @xmath57 , the partitition function for the original spin problem on a planar graph ( without periodic boundaries )",
    "can then be shown @xcite to be equal to @xmath65 , @xmath66 where the pfaffian of @xmath55 is defined by a sum over permutations @xmath67 of node indices , @xmath68 with @xmath69 giving the sign of the permutation @xmath70 of the @xmath53 indices for the nodes of @xmath49 with @xmath71 , and the sum is restricted to the permutations satisfying the orderings @xmath72 and @xmath73 , @xmath74 , ... , @xmath75 .",
    "this choice of signs forces all domain walls relative to a reference configuration to enter with a positive sign ; it also leads to the cancellation of terms such that the many - to - one correspondence between dimer coverings and spin configurations becomes one - to - one @xcite .",
    "the permutation @xmath67 of indices that enters into the sum represents `` matchings '' or `` dimer coverings '' , i.e. , choices of edges @xmath76 , @xmath77 , @xmath78 , @xmath79 , such that each node in the dual decorated lattice belongs to exactly one edge . for proofs of the correctness of this mapping see , for example ,",
    "kasteleyn s papers @xcite and textbook treatments @xcite .",
    "note that the partition function for a graph of high genus ( e.g. , the three - dimensional ising model ) is impractical to compute , as it requires a sum over a number of pfaffians that is exponential in the genus @xcite .",
    "the computation of the partition function on planar graphs is simply given by the evaluation of a single pfaffian .",
    "computations on a periodic graph are more complicated .",
    "kasteleyn described @xcite how to compute the partition functions for dimers on a periodic , i.e. , toroidal , lattice .",
    "four pfaffians are computed for four variations of @xmath55 , namely @xmath80 , @xmath81 , @xmath82 , and @xmath83 .",
    "we will refer to the set of these four matrices by the notation @xmath84 . for a given choice for @xmath85 and @xmath86 , the matrix @xmath87 has matrix elements @xmath57 defined according to the standard pfaffian orientation , except for those elements which have endpoints @xmath88 at opposite ends of the square array : these elements correspond to the intercity edges that wrap around the graph , leading to a periodic topology . in the matrix @xmath87 ,",
    "if an edge connects the a node @xmath58 in a city that is in column @xmath89 to a node @xmath59 in column @xmath90 , its sign is given by @xmath91 , while if an edge connects a node in a city in row @xmath92 to a node for a city in row @xmath90 , it has sign @xmath93 .",
    "these matrices @xmath94 can be used to compute the partition functions @xmath95 for @xmath96 and @xmath97 , where @xmath98 indicates periodic boundary conditions along an axis and @xmath99 indicates antiperiodic boundary conditions [ negation of the @xmath23 for all horizontal ( vertical ) edges in a vertical ( horizontal ) line ] . in particular , the partition functions are given by linear combinations @xmath100 for a @xmath101 matrix @xmath102 @xcite , @xmath103    though the pfaffian is formally written as a sum over a number of permutations that has a number of terms roughly exponential in @xmath0 , the pfaffian of a general @xmath104 matrix can be evaluated in time polynomial in the number of nodes , in a fashion similar to computing the determinant .",
    "however , given the two - dimensional nature of the graph underlying the matrix @xmath55 , pfaffians ( or determinants ) and correlation functions can be computed much more quickly ( a lower power of @xmath0 ) than for a general matrix by splitting the set of nodes geometrically in a hierarchical manner @xcite .",
    "in this section , we first give an introductory outline to the numerical methods we have implemented for rapidly evaluating the partition function and correlation functions . the details",
    "are then described in the subsections sec .",
    "[ subsec : pe ] through sec .",
    "[ subsec : down ] . the algorithm for sampling configurations",
    "is described in sec .",
    "[ sec : sampling ] .",
    "the introduction to these methods requires the definition of the intermediate mathematical objects used , the core mathematical steps applied to these objects , and the overall organization of these steps to find the pfaffian for the whole sample ( or ratios of pfaffians for correlation functions ) .",
    "the pfaffian for the whole sample is computed by combining information from smaller regions .",
    "we can select a region @xmath105 on the decorated dual lattice @xmath46 by choosing a loop of ising spins on the spin lattice @xmath25 : those nodes in @xmath46 that are `` inside '' the loop ( generally the smaller set of nodes ) will compose the interior set @xmath105 while those outside the loop compose the exterior , complementary , set @xmath106 .",
    "these geometrical regions or clusters have associated matrices and factors .",
    "the central mathematical objects used in this procedure are antisymmetric `` cluster '' matrices @xmath107 and @xmath108 @xcite which depend both on the set of spin couplings @xmath109 and the region @xmath105 . the dependence of @xmath110 on the spin couplings @xmath111 that define the given realization of a sample will be implicit in the remainder of this paper and so we will write @xmath112 for @xmath107 .",
    "a given cluster matrix is indexed by the nodes of the decorated dual lattice that are on the boundary of the clusters : if there are @xmath6 boundary vertices in the cluster , the matrix @xmath110 has dimensions @xmath5 .",
    "the boundary correlations of dimers ( and hence spins on the original graph ) are directly related to the cluster matrices @xmath110 by a matrix inverse . also associated with each region @xmath105 is a factor @xmath113 , the `` partial pfaffian '' .",
    "this factor represents a multiplicative contribution to the overall partition function .",
    "it represents a sum over dimer configurations on the interior of @xmath105 .",
    "the core mathematical steps applied to the cluster matrices are the collection of cluster matrices for neighboring regions into a larger matrix and subsequent elimination ( contraction ) steps applied to this joint matrix .",
    "these elimination steps remove rows and columns from the joint matrix that correspond to nodes that are on the boundary of the original neighboring regions but are not boundary nodes for the union of the two regions .",
    "the remaining matrix is then indexed by the boundary nodes of the larger , unified region .",
    "this removal of nodes is carried out by pfaffian elimination , a procedure described in sec .",
    "[ subsec : pe ] and one that is similar to gaussian elimination .",
    "this directly implements a sum over the the dimer coverings over edges that are shared by the adjacent clusters and incorporates that sum into the partial pfaffian factor . to collect neighboring regions @xmath105 , with @xmath114 boundary nodes , and @xmath115 , with @xmath116 boundary nodes , a square matrix of size @xmath117 is filled with the elements of @xmath112 and @xmath118 , in block diagonal form,@xmath119 where the matrix @xmath120 is indexed by the boundary nodes of @xmath105 and @xmath115 and has nonzero elements when @xmath58 and @xmath59 are the ends of an intercity edge @xmath121 connecting @xmath105 to @xmath115 .",
    "partial pfaffian elimination then removes from the matrix rows and columns that correspond to the nodes belonging to separating edges in @xmath122 , while maintaining the overall pfaffian .",
    "the matrix resulting from elimination will be the cluster matrix @xmath123 for the joined regions @xmath124 , with the matrix again indexed by the remaining boundary nodes .",
    "the matrix @xmath123 has dimension @xmath125 .",
    "the two steps together , collection and pfaffian elimination , will be referred to as a `` merger '' .",
    "the methods for evaluating the partition function @xmath126 are based on relating the pfaffian of a region of the sample to the pfaffians defined for subregions : by recursive application of this relationship , the pfaffian @xmath65 of the whole sample can be computed . at the largest scale of this recursion , for example",
    ", it turns out that we can write @xmath127 where the sample is divided geometrically into two regions , @xmath128 and @xmath129 , the @xmath113 and @xmath130 factors are `` partial pfaffians '' computed recursively .",
    "the factors @xmath131 result from the pfaffian elimination steps described in sec .",
    "[ subsec : pe ] .",
    "the prefactor @xmath132 is determined by the sign of how the rows and columns of @xmath133 and @xmath134 are combined . in turn , we can write , for example , @xmath135 where the region @xmath128 is decomposed into regions @xmath136 and @xmath137 and @xmath138 is the set of edges that connect these two sets of nodes . note that the parity factors @xmath139 are not strictly needed for computing the partition function in planar graphs , as all that matters in that case is the magnitude of @xmath65 , but they are needed whenever periodic boundary conditions are used . for numerical stability , pivoting operations that permute the rows and columns are used and the choice of pivots may be different for the distinct @xmath94 .",
    "the organization of the cluster matrix mergers is divided into two stages , the up sweep stage and the down sweep stage @xcite . in each sweep , matrices representing neighboring or enclosing regions are merged .",
    "the organization of these mergers is set by the recursive geometric division of the sample . in the up sweep stage ,",
    "smaller cluster matrices @xmath112 and @xmath140 for neighboring clusters @xmath105 and @xmath115 are merged to create a cluster matrix @xmath123 for the union @xmath124 of the two clusters",
    ". this information sums information over smaller scales into information at larger scales .",
    "the up sweep stage is sufficient to compute the partition function of a sample . in the down sweep stage , correlations ( and configuration samplings )",
    "can be computed . in this stage",
    ", the sum of statistical weights of all dimer configurations external to a region is used to find the sum of statistical weights external to smaller regions .",
    "if @xmath141 is the union of clusters @xmath105 and @xmath115 , @xmath142 gives the matrix encoding the sum of statistical weights external to the region @xmath141 .",
    "this matrix is originally found by summing over all dimer configurations external to the region @xmath141 .",
    "the cluster matrix @xmath142 can be merged with @xmath118 .",
    "this sums over the configuration sums internal to @xmath115 and the dimer configurations external to both @xmath105 and @xmath115 , giving a matrix defined on the boundary of @xmath105 that represents the sum over dimer configurations external to @xmath105 , the cluster matrix @xmath143 . at each stage of this recursion , the cluster matrices @xmath112 and @xmath143",
    "can then be used together to find correlations on the boundary of @xmath105 .",
    "it turns out that the sums of signed mergers of these two matrices gives the spin - spin correlation functions for the ising spins that lie between @xmath105 and @xmath106 .    for reference and to provide a flavor of the methods , we present an outline of the steps for computing the partition function and correlation functions ;",
    "more detailed descriptions of these steps are given in the subsequent subsections :    1 .   from the bond weights",
    "@xmath23 , generate the weights @xmath144 for all neighboring spins in the lattice .",
    "2 .   generate a binary tree @xmath31 for the geometric subdivision of the decorated dual lattice @xmath46 .",
    "each node of the tree contains geometric information for a region @xmath105 , the cluster matrices @xmath112 and @xmath143 , and the partial pfaffian factors @xmath113 .",
    "all non - leaf nodes of the tree have pointers to two children representing matrices for two subregions of approximately the same size .",
    "the subdivision is terminated at the scale of kasteleyn cities , which are regions that correspond to the leaves of @xmath31 .",
    "sweep : starting from the leaves of @xmath31 , merge sibling pairs of cluster matrices @xmath145 and factors @xmath113 and @xmath130 to compute parent matrices @xmath123 and partial pfaffian factors @xmath146 .",
    "this merging is initiated by collecting the matrices @xmath112 and @xmath118 along with edge weights for the edges @xmath122 connecting @xmath105 and @xmath115 together into a joint matrix @xmath147 ( see eq .",
    "( [ eq : fill ] ) ) .",
    "2 .   pfaffian elimination then reduces the matrix @xmath148 into a set of factors @xmath131 and a smaller matrix @xmath123 indexed by the boundary of @xmath149 .",
    "3 .   set @xmath150 , where @xmath151 gives the total parity of row / column permutations that were used in the rearrangements of @xmath148 in preparation for pfaffian elimination and the parity of permutations used for pivoting steps during the pfaffian elimination .",
    "these up sweep steps are carried out recursively , merging clusters up to , but not including , the last pair @xmath128 and @xmath129 representing the initial division of the whole sample .",
    "4 .   the two largest clusters for @xmath152 and @xmath153",
    "are then merged according to the choice of boundary conditions : 1 .   for open or fixed boundary conditions , simply merge the two top - level cluster matrices @xmath133 and @xmath134 . in this case , pfaffian elimination eliminates all rows and columns and the partition function @xmath65 is given by eq .",
    "( [ finalanswer ] ) .",
    "2 .   for periodic boundaries ,",
    "merge the @xmath133 and @xmath134 along one of the rows or columns separating them ( there are either two rows or two columns separating them for periodic bcs ) into a matrix @xmath154 .",
    "then connect the matrix @xmath154 with itself along a remaining row to generate two matrices @xmath155 and @xmath156 , the former using positive weights for the wrapping edges , the latter using negative weights .",
    "eliminate those connecting edges .",
    "then include wrapping edges along the remaining axis , again using negative and positive edge weights for each of the @xmath157 .",
    "the resulting eliminations give scalars : these overall weights are the pfaffians @xmath158 .",
    "3 .   compute @xmath159 , @xmath160 , @xmath161 , @xmath162 from linear combinations of @xmath158 , as given by eq .",
    "( [ eqn : zab ] ) .",
    "stop here if only the partition function is required .",
    "continue to the next steps to compute correlation functions .",
    "down sweep : descend the tree @xmath31 , computing cluster matrices for complementary regions and merging interior and exterior matrices to find correlation functions : 1 .",
    "use the results of the up sweep to initialize the two top level complementary cluster matrices via @xmath163 and @xmath164 .",
    "2 .   if periodic boundary conditions are used , merge @xmath133 and @xmath165 and merge @xmath134 with @xmath166 using the four different choices for wrapping edge weights , i.e. , select @xmath167 from @xmath168 .",
    "use these mergers to set up four parallel trees for further descent .",
    "3 .   for all down sweep steps for a planar ising model or further descending steps in the case of periodic boundary conditions in each of the four trees : 1 .   given a parent @xmath141 with known @xmath142 and children @xmath105 and @xmath115 ,",
    "merge the parent matrix @xmath142 with @xmath118 to generate matrices @xmath143 for regions complementary to @xmath106 , as in the find algorithm @xcite .",
    "2 .   also merge @xmath142 with @xmath112 to generate @xmath169 .",
    "4 .   compute correlation functions between spins on the corners of any given region @xmath105 by signed merging of @xmath143 and @xmath112 .",
    "( to find correlation functions for periodic boundary conditions , compute the correlation function as the weighted sum over four trees as given by eq .",
    "( [ weightedcorrs ] ) . )",
    "pfaffian elimination simplifies a matrix by setting chosen elements in a row to zero while maintaining the pfaffian of the matrix as an invariant .",
    "this elimination proceeds by a process similar to gaussian elimination for general matrices , but is applied to skew - symmetric matrices @xcite . in gaussian elimination , the lower triangular elements are set to zero and the determinant is the product of the diagonal elements . in pfaffian elimination , the diagonal elements of a given skew - symmetric @xmath110 are zero and pfaffian elimination aims to set all elements that are more than one step off of the diagonal to zero .",
    "the pfaffian of the matrix is the product of the remaining elements in even - indexed rows ( given that the first row has index 0 ) .",
    "pfaffian elimination can be defined inductively for a skew - symmetric matrix @xmath110 .",
    "each step simplifies one row to a single non - zero element .",
    "suppose that pfaffian elimination has been carried out for rows with index less than @xmath19 , where @xmath19 is even and the rows are indexed starting with row @xmath90 and that the element in row @xmath19 and column @xmath170 is non - zero .",
    "then multiples of row @xmath19 and column @xmath170 can be added to rows and columns of higher index to zero out the remaining elements of row @xmath19 and column @xmath19 .",
    "this addition of rows and columns simplifies the matrix while the pffafian is unchanged , in the same fashion as row and column additions in a matrix do not modify its determinant .",
    "specifically , for @xmath171 , column @xmath170 is multiplied by @xmath172 and added to column @xmath173 and row @xmath170 is multiplied by the same prefactor and added to row @xmath173 @xcite .",
    "note that the odd rows do not contribute to the pfaffian when the elimination in the previous even row is completed , so that elimination is applied only to even rows .",
    "we use pivoting of the rows and columns that are to be eliminated to improve numerical stability .",
    "a pivot is an interchange between indices @xmath174 and @xmath175 : the elements of row @xmath174 are swapped with the elements of row @xmath175 at the same time columns @xmath174 and @xmath175 are swapped . as we use it here , pfaffian elimination",
    "is often carried out only for some subset of rows .",
    "note that rows / columns that are not to be eliminated are not considered for pivoting .",
    "the permutations due to pivoting operations place the element with the largest available magnitude in the superdiagonal position , before the elimination is carried out .",
    "each pivot leads to a change of sign in @xmath176 which is accumulated in the prefactor @xmath139 .",
    "mathematically , pfaffian elimination carried out for all rows can be used as a factorization scheme , similar to lu factorization via gaussian elimination @xcite .",
    "the pfaffian elimination procedure applies linear operations to @xmath110 so that @xmath177 where @xmath102 is a lower triangular matrix and @xmath178 is zero except for the superdiagonal elements .",
    "the inverse of a skew - symmetric matrix @xmath110 is then @xmath179 this procedure of elimination and matrix multiplication is used to find matrix inverses in the sampling of ising spin configurations ( see sec .",
    "[ sec : sampling ] and ref .",
    "@xcite ) . in the mergings of matrices",
    "used here , the rows and columns corresponding to nodes on the boundary of the joined regions are kept , while the rows and columns corresponding to nodes shared by the joined regions are eliminated .",
    "the eliminated rows and columns have superdiagonal elements which are multiplied together to give a partial pfaffian while the rows and columns for the new boundary are carried onto the next stage .",
    "physically , by eliminating rows and columns corresponding to nodes internal to a geometric region , these steps `` integrate out '' degrees of freedom internal to the new cluster .",
    "computations for sparse matrices that are derived from two - dimensional graphs can be very efficiently carried out using the important technique of nested dissection @xcite .",
    "the row and column indices of the matrix correspond to a numbering of the nodes in a graph .",
    "the idea behind nested dissection is to hierarchically subdivide the matrix according to row and column indices that index nodes for distinct compact regions .",
    "when subdividing a region into two child regions , the separator for this subdivision can be taken to be either nodes that lie between the two regions or a set of edges that connects the two compact subdivisions .",
    "by``compact '' , we mean regions of size @xmath0 whose boundary scales as @xmath180 . the result for the parent region is found by separately computing the results for the two child regions and stitching those two results together using the separator . as a separator",
    "can be found with @xmath180 nodes for a matrix of scale @xmath104 ( i.e. , of order @xmath102 for a spatial region of size @xmath181 ) , with the two subproblems of comparable size , the computation at each scale is for matrices of size @xmath182 @xcite .",
    "the work at each scale is therefore much less than for the dense case where the problem can not be efficiently subdivided and one needs to consider matrices of size @xmath104 .",
    "the first application of nested dissection to efficiently computing spin glass partition functions is described in ref .",
    "the use of the general concept of nested dissection for sampling dimer configurations was proposed in ref .",
    "@xcite and carried out for ising spin glasses in ref .",
    "@xcite .    in the form of nested dissection",
    "@xcite used for dimer sampling @xcite , a set of nodes in a graph is selected as the separator .",
    "this is the form we previously used @xcite for sampling ising spin configurations . here",
    ", we instead use an edge separator with each separating edge having one node in each child region . an example approach that inspired our method",
    "is the find ( fast inverse using nested dissection ) technique , which computes some of the elements of an inverse matrix , as used in computing non - equilibrium green s functions in a two - dimensional quantum device .",
    "the asymptotic run - time of computing the pfaffian with either node or edge separators scales with @xmath0 in the same way , i.e. , as @xmath183 but the find approach has several advantages for studying the ising model .",
    "these advantages include simplifying the structure of the code as well as allowing for more direct computations of the inverse matrix elements and the pfaffian ratios used to sample configurations",
    ".    in the ising model , the decorated dual graph @xmath46 for an @xmath15 square sample with periodic boundaries can be recursively divided by splitting it either horizontally or vertically at each stage into smaller rectangles .",
    "[ fig : tree ] gives an example of this dissection .",
    "the geometric dissection of the system into smaller rectangles is described by a binary tree @xmath31 .",
    "each rectangle is an array of kasteleyn cities .",
    "the leaves of the tree consist of @xmath184 arrays , that is , individual kasteleyn cities , so that the corresponding cluster matrix @xmath185 for a city @xmath186 is a @xmath187 matrix . at each stage of the dissection",
    ", the graph is divided along the axis with the shortest length and as close to the middle of the rectangle as possible .",
    "this division splits the city set by cutting the edges which join neighboring cities ; these cut edges comprise the separating set @xmath122 at each stage .",
    "it is important to note that the separator @xmath122 has a corresponding set of ising spins : the spins that lie between the two geometric regions and are separated from each other by the edges in the set @xmath122 ( see fig .",
    "[ fig : sep ] ) .",
    "the top of the tree @xmath31 has no boundary and so is associated with a null matrix at the end of the algorithm .",
    "however , for efficiency in collecting partial results , the region @xmath188 corresponding to the whole sample has matrices associated with it during intermediate stages of the calculation .",
    "the two rectangles @xmath152 and @xmath153 that result from the first division of the sample are the first non - empty regions , with @xmath189 .",
    "( a ) for an example decorated dual graph .",
    "the original ising system has @xmath190 spins on a periodic graph ; the spins are indicated by gray circles .",
    "the decorated dual graph has @xmath191 kasteleyn cities ( the sets of four fully connected nodes ) . at each stage",
    ", a parent rectangle of kasteleyn cities is divided into two roughly equal sibling rectangles , the children . in the algorithms described here",
    ", each rectangle @xmath105 has geometric information , two cluster matrices @xmath112 and @xmath143 , and a partial pfaffian factor @xmath113 .",
    "( a ) the nested dissection in real space .",
    "the two largest subregions with boundaries , @xmath152 and @xmath153 , indicated .",
    "the region @xmath188 in the final stage ( not shown for clarity ) is the union of @xmath152 and @xmath153 , @xmath192 ; at the end of the algorithm , it has no boundary but a matrix corresponding to this region is used as a working matrix when using periodic boundaries .",
    "( b ) a diagram of the resulting nested dissection tree @xmath31 .",
    "the leaves of the tree are kasteleyn cities .",
    "the root of the tree has no cluster matrix associated with it , as the sample has no boundary , though it has a pfaffian factor associated with it , which is used to find the partition function for the whole sample . ,",
    "title=\"fig:\",width=134 ]  ( b )   for an example decorated dual graph .",
    "the original ising system has @xmath190 spins on a periodic graph ; the spins are indicated by gray circles .",
    "the decorated dual graph has @xmath191 kasteleyn cities ( the sets of four fully connected nodes ) . at each stage ,",
    "a parent rectangle of kasteleyn cities is divided into two roughly equal sibling rectangles , the children . in the algorithms described here , each rectangle @xmath105 has geometric information , two cluster matrices @xmath112 and @xmath143 , and a partial pfaffian factor @xmath113 .",
    "( a ) the nested dissection in real space .",
    "the two largest subregions with boundaries , @xmath152 and @xmath153 , indicated .",
    "the region @xmath188 in the final stage ( not shown for clarity ) is the union of @xmath152 and @xmath153 , @xmath192 ; at the end of the algorithm , it has no boundary but a matrix corresponding to this region is used as a working matrix when using periodic boundaries .",
    "( b ) a diagram of the resulting nested dissection tree @xmath31 .",
    "the leaves of the tree are kasteleyn cities .",
    "the root of the tree has no cluster matrix associated with it , as the sample has no boundary , though it has a pfaffian factor associated with it , which is used to find the partition function for the whole sample .",
    ", title=\"fig:\",width=115 ]    this tree structure is used to organize the elimination steps in the find - based technique , which consists of two stages : an up sweep which produces the partition function of the system by pfaffian elimination , and a down sweep which may be used to find inverse matrix elements , bond probabilities , or correlation functions .",
    "these stages may be understood as a reorganization to move information about dimer correlations on the region boundaries from one scale to another .",
    "first , in the up sweep stage , the cluster matrices , which represent boundary information about couplings that remains after summing over internal degrees of freedom , are joined with cluster matrices in neighboring regions to generate cluster information at a larger scale , for the joint region .",
    "this is repeated until the aggregate thermodynamic properties of the entire sample are found .",
    "next , in the down sweep stage , this information may be propagated back down to give correlation results at the smallest scales , and all scales in between .",
    "this propagation is effected by merging the correlation information exterior to a region with the interior correlation information .",
    "the matrix operations for the pfaffian eliminations carried out in the up sweep stage can be illustrated by an example of the first steps of the algorithm .",
    "describing these first steps allows us to display the matrices used and their correspondence to the graphs showing dimer correlations .",
    "subsequent steps use larger matrices , but have the same structure .",
    "the lowest level steps merge the cluster matrices for two neighboring kasteleyn cities .",
    "let two such cities be denoted by @xmath105 and @xmath115 .",
    "these cities each correspond to neighboring nodes on the dual square lattice @xmath42 and are two of the leaves of the tree representing the geometric dissection of @xmath46 .",
    "the corresponding kasteleyn matrices , @xmath112 and @xmath118 , are the simplest cluster matrices .",
    "the rows and columns of @xmath105 and @xmath115 are each indexed by four nodes , so @xmath112 and @xmath118 are each of size @xmath193 . in general , due to skew symmetry , only the upper triangular portion of each cluster matrix need be stored in memory . the elements above the diagonal in the matrices @xmath112 and @xmath118 are displayed in fig .",
    "[ fig : mwab](a ) .",
    "each cluster matrix has a weight associated with it , a partial pfaffian that accumulates the weights of eliminated rows , which is initialized to be unity , @xmath194 .",
    "the entries of each matrix have weight of magnitude @xmath51 , with signs appropriate for kasteleyn cities @xcite . for the sign conventions and numbering scheme show in fig .",
    "[ fig : mwab](a ) , all elements of @xmath112 and @xmath118 are positive in the upper triangular section . the edges joining cities are directed in the positive @xmath195 and positive @xmath196 directions , so that the matrix elements @xmath197 are non - negative for nodes @xmath198 in cities to the left of or below the city containing node @xmath199 . here",
    ", the separator @xmath122 consists of a single edge @xmath76 joining city @xmath105 to city @xmath115 .",
    "the weight of this edge is @xmath52 , where @xmath23 is the bond weight on the connection between spins @xmath19 and @xmath43 that is perpendicular to this dual edge @xmath76 .",
    "note that this edge is not connected to the rest of the lattice and so will be be eliminated when merging @xmath105 and @xmath115 .",
    "to carry out this reduction , the elements of @xmath112 and @xmath118 and the edge weight are copied into a joint temporary matrix @xmath147 , which is of size @xmath200 ( 28 upper triangular elements ) .",
    "this edge to be eliminated is then placed in the first row of the matrix by permuting the rows of the joint matrix to obtain @xmath201 .",
    "whenever two rows are interchanged , an overall minus sign is introduced into the pfaffian factors . in this simple case ,",
    "only one pfaffian elimination is applied to @xmath202 .",
    "this eliminates the connections of the ends of the connecting edge to the rest of the boundaries of @xmath105 and @xmath115 , giving a matrix with the first superdiagonal element @xmath203 is non - zero , but the rest of the first row eliminated .",
    "the remaining rows , the third through the last rows , define the new cluster matrix @xmath204 .",
    "this matrix encodes the correlations along the outer boundary of @xmath141 , the region composed of the two joined cities .",
    "this contracted matrix is generally not sparse ; see fig .",
    "[ fig : mwab ] . using eq .",
    "( [ eq : zsigmapi ] ) , the partial pfaffian factor that is stored along with @xmath123 is @xmath205 , where the minus sign is included because of the row interchange .",
    "this process of merging adjacent subgraphs of @xmath49 , which uses pfaffian elimination to remove adjacent boundary nodes , is repeated at each scale up to the system size @xmath102 .",
    "generally , neighboring regions @xmath105 and @xmath115 are joined together by copying their entries into a joint matrix @xmath148 , adding the weights of connections for the set of @xmath206 edges @xmath122 that join @xmath105 to @xmath115 ( @xmath122 is indicated by jagged lines in fig .",
    "[ fig : sep ] ) , permuting the joint matrix to give @xmath207 , and then eliminating the first @xmath208 rows .",
    "the portion of the matrix that is indexed by the boundary of @xmath124 is the larger scale cluster matrix @xmath123 .",
    "the product of the superdiagonals on the even eliminated rows are used to find @xmath209 , where @xmath210 is the sign of the permutations carried out in assembling and carrying out pivot eliminations during the elimination and the @xmath211 for even @xmath19 for the eliminated edges are the superdiagonal elements remaining after pfaffian elimination .",
    "this process is an exact real - space renormalization process on the space of cluster matrices . at each scale ,",
    "the cluster matrices represent geometric regions whose interactions are computed using their adjacent boundaries , though each of these clusters has many internal degrees of freedom . at the largest length scale ,",
    "the pfaffian of the remaining @xmath212 matrix is multiplied by the products @xmath213 and @xmath214 resulting from all lower level mergers to gives the pfaffian of the entire kasteleyn matrix , i.e. , the partition function @xmath65 .",
    "this procedure of pfaffian elimination and collection of superdiagonal elements preserves the overall pfaffian at each stage , since pfaffian elimination maintains the pfaffian as an invariant and the pfaffian of a matrix with only superdiagonal elements in the odd rows is just the product of those superdiagonal elements .",
    "the total number of operations in a full up sweep is dominated by the last merger and is of order @xmath215 .",
    "( 660,375 ) ( 10,350)(0,0)@xmath216 ( 220,290)(1,1)60 ( 220,290)(1,-1)60 ( 280,230)(0,1)120 ( 220,290)(1,0)120 ( 340,290)(-1,1)60 ( 340,290)(-1,-1)60 ( 220,290 ) ( 280,350 ) ( 280,230 ) ( 340,290 ) ( 195,290)(0,0)@xmath217 ( 340,315)(0,0)@xmath51 ( 250,230)(0,0)@xmath218 ( 250,350)(0,0)@xmath90 ( 520,230)(0,1)120 ( 460,290)(1,0)120 ( 580,290)(-1,-1)60 ( 580,290)(-1,1)60 ( 460,290)(1,1)60 ( 460,290)(1,-1)60 ( 580,290 ) ( 520,350 ) ( 520,230 ) ( 460,290 ) ( 460,315)(0,0)@xmath217 ( 600,290)(0,0)@xmath51 ( 545,230)(0,0)@xmath218 ( 545,350)(0,0)@xmath90 ( 340,290)(1,0)120 ( 340,265)(110,20)@xmath219 ( 100,10)(200,160 ) @xmath220 ( 500,10)(200,160 ) @xmath221    ( 660,620 ) ( 10,580)(0,0)@xmath222 ( 24,340)(660,240 ) @xmath223 ( 24,30)(660,240 ) @xmath224    ( 660,400 ) ( 10,385)(0,0)@xmath225 ( 220,320)(1,1)60 ( 220,320)(1,-1)60 ( 280,260)(0,1)120 ( 220,320 ) ( 280,380 ) ( 280,260 ) ( 195,320)(0,0)@xmath226 ( 250,260)(0,0)@xmath227 ( 250,380)(0,0)@xmath90 ( 520,260)(0,1)120 ( 580,320)(-1,-1)60 ( 580,320)(-1,1)60 ( 580,320 ) ( 520,380 ) ( 520,260 ) ( 600,320)(0,0)@xmath218 ( 545,260)(0,0)@xmath217 ( 545,380)(0,0)@xmath51 ( 220,320)(1,0)360 ( 220,320)(5,1)300 ( 220,320)(5,-1)300 ( 280,380)(1,0)240 ( 280,260)(1,0)240 ( 280,380)(2,-1)240 ( 280,380)(5,-1)300 ( 280,260)(2,1)240 ( 280,260)(5,1)300 ( 36,0)(600,240 ) @xmath228     are relevant to the calculations through this step are indicated by the large grey circles , while the nodes of the decorated dual lattice are indicated by the medium - sized and small circles .",
    "the solid straight and jagged lines indicate edges belonging to the decorated dual graph .",
    "two geometric regions on the dual lattice , @xmath105 and @xmath115 , each containing @xmath229 kasteleyn cities , are denoted by the ( blue ) dashed squares .",
    "the dual edges @xmath122 that separate @xmath105 and @xmath115 are drawn as jagged lines and join the filled in medium - sized nodes .",
    "the small nodes are interior to the regions @xmath105 and @xmath115 while the larger nodes ( medium - sized open and filled circles ) form the borders of @xmath105 and @xmath115 . in the up sweep stage",
    "( see sec .",
    "[ subsec : up ] ) , given the cluster matrices @xmath112 and @xmath118 for @xmath105 and @xmath115 , the separating edges belonging to the separator @xmath122 are integrated out via pfaffian elimination , leaving a cluster matrix for @xmath141 that includes the entire subgraph shown .",
    "the cluster matrix @xmath123 is indexed by its border nodes , i.e. , the medium - sized open circles connected by the dashed ( blue ) rectangle.,width=288 ]      while the up sweep stage can be used to compute a global quantity , e.g. , the partition function for given boundary conditions , the subsequent down sweep stage provides a powerful method for computing spatial information such as spin - spin correlation functions .",
    "correlation functions at multiple scales can be computed in a single down sweep , while multiple down sweeps are used to generate sample configurations ( see sec .",
    "[ sec : sampling ] ) ,    the down sweep stage descends the geometry tree @xmath31 , recursively computing new cluster matrices @xmath143 .",
    "these matrices contain information about sums over dimer configurations for the exterior @xmath106 of the geometric regions @xmath105 .",
    "these exterior clusters are merged with the interior cluster matrices that were computed on the up sweep to find spin - spin correlation functions .",
    "the computed correlation functions , i.e. , the thermal averages @xmath35 , are for pairs of spins @xmath19 and @xmath43 that border a geometric cluster @xmath105 : these spins lie between @xmath105 and @xmath106 . in our current implementation of the down sweep stage , we compute all pairwise correlations between the four spins that are on the corners of each rectangular region . the results of this computation include correlations between all pairs of neighboring spins , as these are on the corners of the region around a single kasteleyn city ( a @xmath184 region ) .",
    "the down sweep stage uses as initial data the cluster matrices @xmath112 for each node @xmath105 of the tree found during the up sweep . as in the find method @xcite , this initial set of cluster matrices",
    "is then used to calculate cluster matrices @xmath143 for the complementary ( i.e. , exterior ) regions @xmath106 .",
    "these matrices encode the boundary correlations of dimer matchings resulting from summing matchings over the portion of the sample _ surrounding _ a geometric region @xmath105 .",
    "this is to be compared with the cluster matrix @xmath230 which contains information about dimer correlations between its boundary nodes resulting from summing all of the dimers within the region @xmath105 .    at the highest level , where there are two regions @xmath128 and",
    "@xmath129 , @xmath163 and @xmath164 , up to permutations of rows and columns due to differing indexing of the boundary nodes , as @xmath128 is exterior to @xmath129 and @xmath129 is exterior to @xmath128 .",
    "the complementary matrix @xmath143 for a region @xmath105 at a lower level is computed by merging @xmath142 with @xmath118 , where @xmath141 is the parent region for the siblings @xmath105 and @xmath115 .",
    "the matrices @xmath142 and @xmath118 are placed into a larger matrix and the edge weights for those edges whose ends are shared by these two boundaries are included .",
    "those edges shared by @xmath231 and @xmath115 are eliminated by pfaffian elimination and what remains is the cluster matrix @xmath143 , indexed by the nodes adjacent to @xmath105 .",
    "the entire tree is descended in this fashion , thus generating complementary matrices and correlations between corner spins for each region in the geometry tree @xmath31 .",
    "a step of this process is diagrammed in fig .",
    "[ fig : downsweep ] .    .",
    "the gray and black larger circles indicate the locations of the ising spins in the original square grid .",
    "( the black spins are the corner spins for region @xmath141 ) .",
    "the matrix @xmath142 describes the dimer correlations between the nodes that touch the outer ( red ) dashed line labeled @xmath231 .",
    "this matrix sums over correlations external to the spins shown .",
    "this cluster matrix @xmath142 is merged with @xmath118 by eliminating the edges shown by the jagged solid lines .",
    "the region @xmath115 is indicated by the dashed ( blue ) square on the right of the diagram .",
    "the result of the merger is the matrix @xmath143 describing correlations among the nodes on the boundary of @xmath106 , which is shown by the labeled square ( red ) dashed line .",
    ", width=288 ]    as the @xmath143 are computed , the clusters @xmath112 and @xmath143 can be merged via pfaffian elimination . by comparing the results found using different signs for the connecting edge weights , the spin - spin correlations on the original lattice can be computed . to explain this computation of correlations , we continue to suppose that domain walls are defined using an all spin up reference configuration @xmath45 , so that neighboring ising spins of opposite sign are separated by a domain wall .",
    "then the boltzmann weight @xmath232 of a given spin configuration @xmath14 is equal to the product @xmath233 of all weights @xmath234 of edges @xmath76 that make up the domain wall set @xmath235 on the dual graph with @xmath236 , which is a sample and reference state dependent constant .",
    "consider two spins located at @xmath19 and @xmath43 in @xmath25 . in a given spin configuration @xmath14 ,",
    "the spins are separated by either an even number or and odd number of domain walls in @xmath53 .",
    "the spins have equal orientations , @xmath237 , if and only if a path in @xmath25 between the two spins crosses an even number of domain walls .",
    "so the correlation function can be found from the average parity of domain walls between the two spins @xmath19 and @xmath43 .    given a choice of couplings @xmath23 with chosen boundary conditions and temperature ,",
    "let the equilibrium fraction of spin configurations @xmath14 with @xmath238 ( @xmath239 ) be given by @xmath240 [ respectively , @xmath241 .",
    "let @xmath242 indicate a path of length @xmath243 between @xmath19 and @xmath43 built up of nearest neighbor pairs @xmath244 .",
    "for @xmath245 , the path is just the single bond @xmath246 .",
    "the partition function under the constraint that @xmath247 is @xmath248 and can be represented as the restricted sum over matchings @xmath53 in @xmath46 @xmath249 in this formula , the sum over matchings is understood to be restricted to edge choices that obey the restrictions described below eq .",
    "( [ eq : pfk ] ) and @xmath250 is the sign of the permutations in the listing of the nodes in the matching @xmath53 , so that the many - to - one mapping of dimer coverings to spin configurations is effectively turned into a one - to - one mapping by cancellation of oppositely signed terms .",
    "the restriction is to matchings such that the bonds for ising spin pairs in the path @xmath242 are crossed by the dual edges in the matching @xmath53 an odd number of times .",
    "note that this restriction is independent of the exact path @xmath242 and only depends on the endpoints @xmath19 and @xmath43 .",
    "a similar correspondence ( with the sum over an even number of crossings ) holds for expressing @xmath251 , with @xmath252 .    to compute these restricted partition functions",
    ", we compare @xmath65 with @xmath253 , where @xmath254 is a modified kasteleyn matrix .",
    "all weights for the edges in @xmath46 that cross the chosen path @xmath242 contained in @xmath25 are negated in this modified matrix . that is , the elements of @xmath254 are the same as those in @xmath55 except where an edge @xmath255 is crossed by the path @xmath242 : in that case , the weight @xmath234 in @xmath55 is replaced by @xmath256 in @xmath254 .",
    "these negations reverse the signs of the weights of matchings @xmath53 with an odd number of edges of that cross @xmath242 while maintaining the sign of matchings with an even number of edges of @xmath53 crossing that path . to efficiently carry out the computation of @xmath253 , the path @xmath242 is chosen to cross edges that connect a cluster @xmath105 to its complement @xmath106 .",
    "that is the path connect spins that lie between @xmath105 and @xmath106 .",
    "an example showing the negated dual edges is shown in fig .",
    "[ fig : corr ] .    these correspondences allow us to write the spin correlation function for a planar ising model in the form @xmath257\\nonumber\\\\ & =   & \\frac{1}{{\\operatorname{pf}}(k ) }       \\left[\\sum_{\\{m|\\mathrm{even}\\ i\\rightarrow j\\ } }           \\epsilon(p_m)\\prod_{e\\in m}w(e)- \\right .",
    "\\nonumber \\nonumber\\\\           & &        \\left .",
    "\\sum_{\\{m|\\mathrm{odd}\\ i\\rightarrow j\\}}\\epsilon(p_m)\\prod_{e\\in m}w(e)\\right ] \\nonumber\\\\        & = & \\frac{1}{{\\operatorname{pf}}(k)}{\\operatorname{pf}}(k_{i\\rightarrow j } ) \\nonumber\\\\         & = & \\frac{{\\operatorname{pf}}[m_0(w_{i\\rightarrow j } , u_a , u_{\\overline{a}})]}{{\\operatorname{pf}}[m_0(w , u_a , u_{\\overline{a } } ) ] } , \\label{eq : corr}\\end{aligned}\\ ] ] the modified list of weights @xmath258 is the set of weights with negated values for all dual edges crossed by the path ( any path ) from @xmath19 to @xmath43 , i.e. , @xmath242 , where again @xmath242 lies between @xmath105 and @xmath106 .",
    "note that @xmath259z(a)z(\\overline{a})$ ] and @xmath260z(a)z(\\overline{a})$ ] ; the cancellation of the common factor @xmath261 gives the last step in the above equation .",
    "this representation of the spin correlations in eq .",
    "( [ eq : corr ] ) defines the procedure for their computation .",
    "correlations between two spins that lie between a region @xmath105 and and its complement @xmath143 are computed by merging the two matrices @xmath112 and @xmath143 once using the original weights and again using the modified ( partially negated ) weights .",
    "the ratio of the two resulting pfaffians gives the spin - spin correlation value .",
    "we note that a different approach has been used to compute correlation functions at @xmath13 @xcite , where paths between frustrated plaquettes are the basis of the representation in the ground state . for the example shown in fig .",
    "[ fig : corr ] , the correlation function is calculated between the two spins diagonally opposite ( top left and bottom right ) between the outer and inner set of nodes , whose correlations are given by @xmath112 and @xmath143 .",
    "the choice of signs for @xmath122 could also be modified to compute multispin correlations .     and @xmath43 .",
    "this calculation uses information computed during the both the up sweep and down sweep stage .",
    "the matrices @xmath142 and @xmath123 are merged using the edge weights on the jagged lines .",
    "these edges form the set @xmath122 .",
    "two mergings are calculated : one for all positive weights for the edges in @xmath122 and one where the weights are negated for the thicker ( green ) edges .",
    "this gives two pfaffians for the whole sample .",
    "the first pfaffian has positive contributions from configurations with either an odd or even number of dimer choices ( i.e. , domain walls ) between spins @xmath19 and @xmath43 .",
    "this is the partition function for the whole sample .",
    "the second pfaffian is the difference between the partition function constrained to have an even number of domain walls between @xmath19 and @xmath43 and the partition function constrained to have an odd number of domain walls between @xmath19 and @xmath43 .",
    ", width=288 ]    the calculation of correlations is simplest for planar graphs ( ising models with open or fixed boundary conditions ) .",
    "if periodic boundary conditions are to be used , four different mergers of the two top level matrices @xmath133 and @xmath134 are computed .",
    "these mergers are computed for all possible pairings of negative or positive weights for bonds that connect the top row to the bottom row of cities or the rightmost column to the leftmost column of cities , as justified in sec .",
    "[ subsec : up ] and ref .",
    "the descent of the tree for each is carried out starting from each of these four choices .",
    "there will then be four complementary cluster matrices , @xmath262 , for each geometrical region @xmath105 .",
    "each complementary cluster matrix will have its own four partial pfaffian factors @xmath263 . a spin - spin correlation for periodic boundary conditions ( as given by @xmath80 )",
    "is then the ratio of two weighted sums .",
    "the weighted sum in the denominator is the total partition function divided by @xmath113 .",
    "the sum in the numerator is the same linear combination of the pfaffians but with the weights @xmath122 negated on edges that cross the path @xmath242 ( i.e. , using the weights @xmath258 ) .",
    "the partition function for periodic boundary conditions is @xmath264 .",
    "the factor @xmath113 is common to all terms @xmath265 $ ] in the weighted sums and so can be cancelled out .",
    "this gives the result that the spin - spin correlation function on a periodic lattice is the ratio @xmath266z^{(r , s)}(\\overline{a } ) }                                  { \\sum_{(r , s)\\in\\{(\\pm,\\pm)\\ } } { \\operatorname{pf}}[m_0(w , u_a , u^{r , s}_{\\overline{a}})z^{r , s}(\\overline{a})]}\\ .\\end{aligned}\\ ] ] so the correlation function computations , which require the evaluation of two pfaffians on a planar graph , require @xmath267 pfaffians on a torus for each pair of spins .",
    "the computation time for the correlation functions for the corner spins on all regions in practice requires about 10 times the amount of computing time as finding only the partition function @xmath3 .",
    "exact sampling methods select independent configurations according to their probability in the whole sample space .",
    "we consider here the problem of generating a sample configuration of a system with probability proportional to the boltzmann weight @xmath268 . as a contrast with direct sampling , consider markov chain monte carlo ( mcmc ) methods . in an mcmc method ,",
    "a sequence of configurations is generated by randomly chosen updates ; if the update choices obey detailed balance and can reach all possible configurations , in the limit of large times this sequence will generate sample configurations from the boltzmann distribution @xcite . the number of monte carlo updates needed for the approach to fair sampling is often unknown and can be very long .",
    "however , mcmc methods can generate exact sampling if coupling from the past @xcite can be used to guarantee fair samples ( but not necessarily fast mixing times ) . however , no known coupling methods are practical for ising spin glass models at low temperatures @xcite . markov chain monte carlo methods are of course of great practical use , but the availability of exact sampling in some cases provides for a very useful comparison and the potential for much more rapid calculations for large glassy systems .",
    "the direct sampling methods we use @xcite to generate random ising spin configurations are based on the mapping between dimer and ising model configurations and on dimer sampling methods @xcite that use nested dissection . by directly selecting a random matching on the decorated dual graph @xmath46 with the proper probability",
    ", we fairly select a set of relative domain walls and hence the relative orientations of the spins on the original lattice .",
    "we report here on a modification of the method used in ref .",
    "@xcite ; here we use the edge separators @xmath122 @xcite described in sec .",
    "[ sec : main ] rather than a node separator @xcite .",
    "this modification significantly speeds up the sampling algorithm for the ising model , as the dimension of the matrices to be factorized are reduced by a factor of three from those used in ref .  .",
    "the implementation of the algorithm is also simplified .    as in the computation of the partition function and correlation functions ,",
    "the direct sampling calculations rely on a geometric dissection .",
    "the tree used for sampling differs some from that described in sec .",
    "[ sec : main ] for computing partition functions and correlation functions . for sampling configurations with periodic boundary conditions , we start this modified dissection with a cluster @xmath188 which is formed by joining the two system halves @xmath128 and @xmath129 along a single line of spins .",
    "the cluster @xmath188 includes all of the nodes in the decorated dual graph @xmath46 , but does not include the edges at the top or right that connect the top row of nodes to the bottom row or the right column to the left column .",
    "these edges that are left out are those used to complete the periodic boundary conditions .",
    "see fig .",
    "[ fig : samp](a ) for a drawing of @xmath188 and the initial separator .",
    "all of the edges internal to the region @xmath188 are contracted out by pfaffian elimination in an up sweep to give the cluster matrix @xmath154 .",
    "this matrix @xmath269 is used in the first stage of spin assignment . in this first stage",
    ", the ising spins that form the bottom row of the sample are chosen .",
    "as the probability distribution is symmetric with respect to global spin reversals , we can simply fix an initial spin , the spin at the lower left , to have the value @xmath270 .",
    "the orientation of the remaining spins that lie along the bottom row of @xmath188 are then assigned sequentially first along the bottom row .",
    "the spins along the left column are then assigned .",
    "this assignment is based on the probabilities of domain walls separating neighboring spins in the bordering row and column .",
    "these probabilities are found by effectively computing the correlation functions between spins in the lower row and left column .",
    "note that , in principle , any order of spin assignment for these outer border spins could be used .",
    "it is possible that numerical stability might be improved by choosing an alternate order of spin assignments ; we chose the nearest neighbor sequence for simplicity .",
    "( a )   ( b )   ( c )   ( d )   +   +  ( e )   ( f )   ( g )   ( h )     once all spins around the boundary of the sample are fixed , the process becomes simpler .",
    "spin assignments are decided at finer scales by descending the tree recursively . in each subsequent step , the spins surrounding a region @xmath141 have been fixed by prior assignment .",
    "the probabilities of domain wall sections crossing between the spins lying between two child regions @xmath105 and @xmath115 are computed . the spins between the two child regions @xmath105 and @xmath115 are then assigned by using these probabilities of relative domain walls . as the assignments are made , the probabilities for remaining parts of the separator",
    "are updated .",
    "these newly assigned spins then form the boundaries for the child regions of @xmath105 and of @xmath115 .",
    "these steps are shown for a sample spin assignment in fig .",
    "[ fig : samp ] .",
    "the iterative assignment of spins along the separators uses the inverse of a cluster matrix to compute correlation functions .",
    "the spins are randomly chosen according to these correlation functions .",
    "an essential part of this approach is that when a spin is fixed by such a choice , the inverse of the cluster matrix can be updated efficiently and incrementally @xcite .",
    "this incremental update makes the sampling procedure running time for selecting a single spin configuration proportional to the time of computing the partition function ( though with a larger prefactor ) .",
    "a summary outline of the procedure is presented in sec .",
    "[ samplingoutline ] ; the next sections sec .",
    "[ dwprob ] and sec .",
    "[ sm ] give more details of the algorithm .",
    "given two regions @xmath105 and @xmath115 and their edge separator @xmath122 , the domain wall probabilities are calculated using the inverse of @xmath271 , the kasteleyn matrix that incorporates the effects of both the values of the boundary spins surrounding @xmath149 and the weights on the edges in @xmath122 . note that boundary spins around the region @xmath149 are taken to be fixed , except at the highest level .",
    "these fixed spins affect the weights of the intercity edges at the boundaries of @xmath105 and @xmath115 .",
    "these weights are computed for a reference configuration where the spins at the boundary of @xmath105 and @xmath115 are fixed to the values decided at the higher levels of the tree .",
    "we can continue to use all spins set to @xmath39 for the spins interior to @xmath105 and @xmath115 .",
    "it follows that if a spin @xmath43 neighbor to @xmath19 in the region @xmath105 is fixed to be @xmath272 , the weight @xmath273 for the edge @xmath76 crossing the bond @xmath26 is set to be @xmath274 . if the boundary spin is fixed to @xmath275 , then the usual weight is used , @xmath276 . at each stage of the spin assignment ,",
    "then , we recompute the matrices @xmath112 and @xmath118 using these weights that depend on the boundary spins for @xmath149 .",
    "the matrix @xmath271 is found by collecting @xmath112 and @xmath118 into a single matrix and then linking the matrices using the edge weights that connect @xmath105 and @xmath115 .",
    "matrix inversion using pfaffian factorization is then used to compute the matrix @xmath277 .",
    "the inverse matrix @xmath277 allows for the simple calculation the probability of any given separating edge being part of a domain wall .",
    "these calculations eqns .",
    "( [ eq : p],[eq : pper ] ) use the pfaffian analog of the jacobi determinant identity , which states that @xmath278 where @xmath279 is the matrix with rows and columns @xmath198 and @xmath199 removed .",
    "the notation @xmath280 indicates the @xmath281 submatrix of @xmath282 which is built out of the intersections of rows and columns @xmath198 and @xmath199 , i.e. , @xmath283 where @xmath284 , so that @xmath285_{k , l})=u^{-1}_{k , l}$ ] . since the ratio of pfaffians of kasteleyn matrices @xmath65 is the ratio of partition functions @xmath3 , probabilities can be computed using the identity eq .",
    "( [ eq : jacobi ] ) .",
    "let the edge on the decorated dual graph that separate the neighboring spins @xmath19 and @xmath43 have nodes @xmath58 and @xmath59 .",
    "the probability of including an edge @xmath121 as part of a domain wall that separates the two spins is then given by the expression @xmath286_{ab}[k_w^{-1}]_{ab}|\\ .\\end{aligned}\\ ] ] the result eq .",
    "( [ eq : p ] ) then follows from the probability being the product of the weight of the chosen edge and the weight of dimer configurations that do nt include nodes @xmath198 and @xmath199 ( i.e. , @xmath287 ) divided by the total weight @xmath288 . when @xmath122 is the separator for regions @xmath105 and @xmath115 with fixed boundary spins , the @xmath63 element of @xmath271 is given by @xmath289_{ab}=w_{ab}$ ] .",
    "the situation is different for the top level matrix @xmath188 , where @xmath122 `` separates '' @xmath290 from itself , i.e. , the edges connect boundary nodes on @xmath188 to each other . in this case ,",
    "@xmath289_{ab}=w_{ab}+[u_{c^*}]_{ab}$ ] .",
    "in addition , the probability for selecting an edge that connects @xmath188 to itself is given by a weighted sum over the four possible boundary dimer orientations , @xmath291^{-1}_{ab } }     { \\sum_{(r , s)}{\\operatorname{pf}}(k_{w}^{r , s } ) }     \\right|\\end{aligned}\\ ] ] the equation for domain wall probabilities at the highest level in the periodic lattice follows from eq .",
    "( [ eq : l ] ) and eq .",
    "( [ eq : jacobi ] ) and cancellations of common factors similar to those that led to the result eq .",
    "( [ eq : corr ] ) .",
    "once the probability of choosing an edge is computed , a random number @xmath196 is chosen in the interval @xmath292 to decide whether to accept the addition of edge @xmath293 to @xmath53 .",
    "if @xmath294 the edge @xmath76 is included in the sampled matching , otherwise it is excluded .",
    "given the resulting choice , the matrix @xmath277 is then updated by the method described in sec .",
    "we note here the contrast with methods for dimer covering sampling that are based on node separators @xcite . in these methods , a chosen node that is between regions @xmath105 and",
    "@xmath115 was matched .",
    "the probabilities computed were the probability of choosing each edge that matched the chosen node , with the sum of these probabilities being unity . from the jacobi identity , the conditional probabilities for these forced node matching could be found without recomputing all of the elements of @xmath295 ; these probabilities are given by the pfaffian of a submatrix that grows with the number of fixed nodes @xcite . here , instead , nodes on the boundary may or may not be matched , depending on whether an edge is chosen or not , so the same approach can not be used . instead , inspired by the approach of ref .",
    "@xcite , we update the inverse matrix using the sherman - morrison formula .",
    "note that only @xmath296 edges are need be chosen for each separator @xmath122 , as the last choice of an edge is forced by consistency in the spin assignments ( or , equivalently , parity in the dimer covering . )      after the assignment of one spin value , the choice of whether the corresponding edge is included in the matching is fixed for the remainder of the calculation ; all subsequent bond probabilities along the separator @xmath122 must be computed conditioned upon this choice .",
    "this is accomplished by modifying the inverse kasteleyn matrix @xmath277 for the edge separator .",
    "the sherman - morrison formula @xcite allows for quickly recomputing the inverse of a matrix when modifications of the original matrix are confined to one ( or a small number ) of rows and columns . here",
    ", we apply this formula to set specific edges of @xmath271 to zero .",
    "one formulation of the sherman - morrison formula is that for any matrix @xmath105 , and row vectors @xmath297 and @xmath298 , @xmath299 in the sampling algorithm , the choice of whether to force the inclusion of an edge or exclude it from @xmath53 modifies the skew - symmetric matrix @xmath271 in two rows and columns at the same time . when including an edge @xmath121 , all elements of @xmath271 in rows and columns @xmath58 and @xmath59",
    "are set to zero , except the elements @xmath289_{a , b}$ ] and @xmath289_{b , a}$ ] .",
    "the matching found using @xmath271 must then link @xmath58 to @xmath59 .",
    "in contrast , when the edge is excluded , these two elements @xmath289_{a , b}$ ] and @xmath289_{b , a}$ ] are set to zero , while the others in rows and columns @xmath58 and @xmath59 are kept unchanged .",
    "if a general matrix @xmath105 ( and hence its inverse @xmath300 ) is antisymmetric , numerical stability is enhanced by carrying out both row operations and column operations at the same time , keeping the resulting matrix antisymmetric as well .",
    "using skew - symmetry and applying the sherman - morrison formula twice gives the inverse of a matrix modified in two rows and columns as @xmath301 if an edge @xmath121 is to be removed by setting @xmath57 to zero , then one can set @xmath302 and @xmath303 , with all other elements of @xmath297 and @xmath298 being zero .",
    "similarly , if edge @xmath293 is to be kept , one can also use @xmath304 for kronecker delta @xmath305 but set the vector @xmath298 by @xmath306 , for @xmath307 .",
    "given that that matrix @xmath300 is computed directly only once , at the start of spin assignment along a separator , a single update procedure per eq .",
    "[ eq : sm_as ] may be carried out in @xmath308 operations for a separator of @xmath102 spins .",
    "this is faster than the @xmath309 for matrix multiplication of two @xmath310 matrices because @xmath311 and @xmath312 are themselves vectors .",
    "so performing @xmath102 updates to the matrix can be achieved in @xmath309 operations .",
    "as the nested dissection produces a separator with @xmath313 elements , sampling across the separator takes @xmath215 steps .",
    "summing this cost over all of the needed scales for the separators gives a time to sample all of the spins scaling also as @xmath215 .",
    "given the connection between @xmath277 and spin correlations and the sherman - morrison method for updating @xmath277 as spins are chosen , the sampling algorithm for periodic systems can now be directly described in outline form :    1 .",
    "perform the same up sweep steps needed to compute the cluster matrices @xmath133 and @xmath134 .",
    "these are the same steps needed to compute the partition function @xmath3 but without the final merger .",
    "2 .   merge @xmath133 and @xmath134 along the line of spins through the middle of the sample that separates the regions @xmath128 and @xmath129 .",
    "this is done by placing @xmath133 and @xmath134 into a larger matrix and filling in the values of weights @xmath314 along this line .",
    "this gives the cluster matrix @xmath154 which is indexed by nodes along the bottom , top , left , and right rows of the sample .",
    "3 .   for each of the four global dimer orientations @xmath315 , fill in the weights that complete the torus , using signs for the weights given for each choice",
    "this gives four matrices @xmath317 .",
    "compute the inverse matrices @xmath318 using pfaffian elimination ( eq .",
    "( [ eq : pfinverse ] ) ) .",
    "4 .   for each edge",
    "@xmath76 that connects the top of @xmath188 to the bottom of @xmath188 : 1 .",
    "compute the probability that the edge @xmath76 is occupied using eq .",
    "( [ eq : pper ] ) .",
    "2 .   apply eq .",
    "( [ eq : sm_as ] ) to update @xmath319 , using the vectors @xmath297 and @xmath298 that modify @xmath154 so as to force the chosen occupation value of the current edge @xmath76 .",
    "5 .   compute two new cluster matrices , @xmath320 and @xmath321 which have as boundaries the left and right columns of @xmath188 , using the fixed values of the spins in the bottom row chosen in the previous step . then use a modified form of eq .",
    "( [ eq : pper ] ) that sums only over @xmath93 , not both @xmath91 and @xmath93 , to compute probabilities for edges along the column at the left / right boundary of the sample . after selecting each edge , use eq .",
    "( [ eq : sm_as ] ) to update @xmath322 and @xmath323 . 6 .   use the edge choices , which give portions of relative domain walls , to assign ising spins around the border of @xmath188 .",
    "more specifically , if an edge is chosen to belong to the matching @xmath53 , the sign of the spin differs on either side of the edge , while if a spin was not chosen , the sign of the two spins on either side is the same . 7 .",
    "sampling is now carried out recursively for the subregions , given these fixed boundary conditions around the border of the sample .",
    "this is carried out first for the spins lying on the central dividing line between @xmath128 and @xmath129 , and then for the spins lying between their child regions , etc .",
    ", until all spins are assigned . at each level",
    "recompute the cluster matrices @xmath112 and @xmath118 for the regions @xmath105 and @xmath115 on either side of the separator .",
    "this computation uses as a reference configuration all spins @xmath39 , except on the boundary of the region @xmath149 , where the fixed boundary spins are used as the reference configuration .",
    "2 .   merge @xmath112 and @xmath118 using the edge weights for edges @xmath324 between @xmath105 and @xmath115 to obtain the matrix @xmath271 , the effective kasteleyn matrix for the separator @xmath325 .",
    "3 .   compute @xmath277 by pfaffian elimination .",
    "4 .   for each of the @xmath296 edges @xmath326 , @xmath327 for a node @xmath19 on the boundary of @xmath105 and a node @xmath43 on the boundary of @xmath115 : 1 .   compute the probability of choosing @xmath76 , @xmath328_{ij}\\right|$ ] .",
    "2 .   choose whether to accept or reject the inclusion of @xmath76 .",
    "3 .   based on whether @xmath76 is included or excluded from the dimer sampling , set up the vectors @xmath297 and @xmath298 and apply the sherman - morrison formula to update @xmath277 . 5 .   fix the ising spins that lie in the separator @xmath122 using the newly computed portions of the domain walls .",
    "as the implementation of these methods into working programs is relatively complex , we have carried out a number of tests of the code to confirm that it computes partition functions and correlation functions correctly .",
    "previous to this current version of the code , each of the authors has independently written a computer code that computes partition functions using pfaffians .",
    "we confirmed that the two previous codes and the current partition function code @xcite compute the same partition function for samples of sizes up to size @xmath329 , for several samples at each size .",
    "we have also verified our code by comparison with ( 1 ) exact enumeration for small ising spin glass samples of size up to @xmath330 spins and ( 2 ) checking correlation functions against analytic results for the ferromagnetic ising model .",
    "the following subsections summarize the results of tests for the pure ising model and for spin glass models .",
    "similar checks are included as samples in our current distribution of the partition function code @xcite . for further examples of applications of these particular codes ,",
    "see refs .",
    "@xcite .",
    "the checks against exact enumeration verified that the code produced both correct partition functions and correlation functions .",
    "a simple exact enumeration code computed the boltzmann factor for each spin configuration @xmath14 directly , for a given random selection of bond strengths @xmath23 .",
    "the sum of the boltzmann factors at a given @xmath8 was compared against the partition function @xmath3 computed for each sample using nested dissection and multi - precision arithmetic . in all cases ( @xmath331 random samples for each distribution ) , the partition functions were in exact agreement .",
    "we carried out tests for both bimodal and gaussian distributions for @xmath23 .",
    "as the support for the density of states is limited in the bimodal case when @xmath332 , the bimodal distribution allows for an easy exact check of the number of states at each energy . setting @xmath8 so that @xmath333 for , say , @xmath334 allows one to directly read off the density of states from @xmath3 written in decimal , when the degeneracy at all energies is less than @xmath335 .",
    "the spin - spin correlations generated by the nested dissection code were also compared with the exact enumeration results and found to be the same .",
    "in addition , to check our sampling code , up to @xmath336 configurations were generated using our sampling methods for several @xmath337 samples .",
    "the temperatures used were set so that about 90% of the configurations were in one of the ten lowest energy states .",
    "the temperature was set this low to have enough statistics to verify the boltzmann distribution for the low - lying states , including the degeneracies of the bimodal distribution .",
    "the distribution of energies found were also found to satisfy the boltzmann distribution for gaussian disorder , where there is a unique state for each energy .      to check the calculation directly against an analytic result in larger samples",
    ", we numerically computed the spin - spin correlation function for the square lattice in ferromagnetic ising models at the critical temperature . for @xmath338 for all neighboring pairs on the square the lattice , the critical temperature @xmath339 satisfies @xmath340 for @xmath338 . the correlation function along the diagonals , @xmath341 , where the spins are now indicated by two subscripts that indicate their @xmath195 and @xmath196 coordinates on the lattice .",
    "the computed correlation function was compared with known results @xcite .",
    "while this does not check for the effect of heterogeneities on correlation functions , it helps confirm that correlation calculations are carried out correctly at all scales , from single cities up through the size of the sample .",
    "the analytic result @xcite for an infinite sample is @xmath342^{i - r}\\]]z which at large separations @xmath343 gives @xmath344 with @xmath345 and @xmath346 is the riemann @xmath346 function .",
    "the numerical results for finite - size samples are plotted in fig .",
    "[ fig : pure ] . the rather large finite - size corrections to the spin - spin correlation functions are apparent , but the numerical calculation quickly converges to the exact short distance results of eq .",
    "( [ eqn : isingcorrfs ] ) and apparently converges to the asymptotic limit eq .",
    "( [ eqn : isingcorrinf ] ) , giving us further confidence in the correlation function code .     for diagonal spin separations @xmath347",
    "was computed using pfaffian methods for samples of size @xmath310 spins , @xmath348 , and compared with @xmath349 exact and asymptotic results.,width=268 ]      we conclude the review of these algorithms with a list of the timings and memory used , in order to compare with other implementations and algorithms . table [ table : timing ] gives average run times on a single core of a 2.4 ghz xeon e5620 quad - core processor with 12 gb of memory .",
    "the gnu multiprecision arithmetic library gmp ( version 3.5.0 ) was utilized for high precision floating point arithmetic using the c++ interface gmpxx ( version 4.1.0 ) included with gmp @xcite .",
    "multiprecision arithmetic was used for all floating point calculations , including the temperature parameters , storing the bond strengths and weights , and all matrix and partial pfaffian operations .",
    "a pair of custom routines were written for the logarithm and exponential functions .",
    "these are used only for computing weights at the start of the computation and computing logarithms of the partition functions at the end of the calculation , for finding free energies .",
    "these timings are all for periodic samples : for samples with free or fixed boundary conditions , approximately four times less memory and cpu time are needed .",
    "as long as there are no overflows , the running time is independent of inverse temperature @xmath8 , though increasing the precision increases the maximum value of @xmath8 for which the calculations are stable . for @xmath329 and bimodal disorder ,",
    "floats using 1536 bits are needed to reliably sample configurations for @xmath350 .",
    "computing the partition function or using gaussian disorder requires just somewhat fewer bits .    [ cols=\"^,^,^,^,^,^,^,^ \" , ]",
    "the goal of this paper has been to present in detail numerical methods for computing thermodynamic quantities , computing spin - spin correlation functions , and sampling configurations for two - dimensional ising models with short range ( planar ) interactions .",
    "the development and explication of these methods , which incorporates many ideas from previous work , emphasizes the natural summing over various length scales . especially at lower temperatures ,",
    "the near cancellations that result during the matrix operations require matrix operations with multi - precision arithmetic .",
    "the precise numerical results obtained are a great advantage for studying thermodynamic quantities , compared with traditional markov chain monte carlo methods , for a broad range of problems .",
    "we have prepared a code that should be easily compiled to compute partition functions for the ising model with arbitrary couplings on square lattices .",
    "we are currently preparing implementations of the correlation function and sampling codes for distribution .",
    "the structure of the algorithm is also very suggestive with respect to the renormalization of couplings in random models , which might be studied directly to look for some type of fixed point distribution in coarse grained couplings .",
    "we thank cris cecka for introducing us to the find algorithm of ref .",
    "this work was supported in part by the national science foundation grant dmr-1006731 .",
    "we thank the aspen center for physics , supported by nsf grant 1066293 , for its hospitality while portions of this paper were written up .",
    "this cancellation can most directly be understood in terms of fisher cities .",
    "the fisher mapping from the ising model to a dimer model is one - to - one , and if one performs pfaffian elimination on the two inner nodes of a fisher city , a kasteleyn city results .",
    "the two different types of decorations are equivalent , forcing this convenient cancellation ."
  ],
  "abstract_text": [
    "<S> a powerful existing technique for evaluating statistical mechanical quantities in two - dimensional ising models is based on constructing a matrix representing the nearest neighbor spin couplings and then evaluating the pfaffian of the matrix . utilizing this </S>",
    "<S> technique and other more recent developments in evaluating elements of inverse matrices and exact sampling , a method and computer code for studying two - dimensional ising models is developed . </S>",
    "<S> the formulation of this method is convenient and fast for computing the partition function and spin correlations . </S>",
    "<S> it is also useful for exact sampling , where configurations are directly generated with probability given by the boltzmann distribution . </S>",
    "<S> these methods apply to ising model samples with arbitrary nearest - neighbor couplings and can also be applied to general dimer models . </S>",
    "<S> example results of computations are described , including comparisons with analytic results for the ferromagnetic ising model , and timing information is provided . </S>"
  ]
}