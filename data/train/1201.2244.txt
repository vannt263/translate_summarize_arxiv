{
  "article_text": [
    "elucidating the explosion mechanism of core - collapse supernovae is a grand challenge in astrophysics , nuclear and particle physics as well as computing science .",
    "it requires the numerical computations of hydrodynamics , neutrino transfer and electromagnetism that incorporate detailed microphysics at extreme conditions .",
    "delicate interplays of these multiple elements in various physics have to be described quantitatively in numerical simulations in order to determine unambiguously the outcome of collapse and bounce of central cores and to obtain the magnificent optical display , neutrino burst , and ejected material as well as remnants that fit observations appropriately . despite the extensive studies with ever increasing theoretical achievement and computational resources for more than four decades ,",
    "the critical element of supernova explosion has been elusive @xcite .",
    "one of the key issues is the neutrino transfer .",
    "interactions of neutrinos with material play important roles in a couple of ways .",
    "the lepton fraction stored in the bouncing core is determined by the neutronization and neutrino trapping ; the core bounce launches a shock wave , which stalls on the way out owing to energy losses through the dissociation of nuclei and the neutrino cooling ; the fate of the stagnated shock wave is eventually determined by the flux of neutrinos that are emitted copiously by a proto - neutron star and interact with the material below the shock wave .",
    "neutrino signals detected at terrestrial detectors are an important probe into what is happening in the deep interior of thickly veiled supernova cores , which was indeed vindicated for sn1987a @xcite .    among viable scenarios for supernova explosions ,",
    "the neutrino heating mechanism @xcite is currently the most promising .",
    "the heating of material below the stalled shock wave by the absorption of neutrinos emitted from deeper inside the core is supposed to revive the stagnated shock wave .",
    "since neutrinos carry away most of the liberated energy of @xmath310@xmath4 erg , tapping a hundredth the energy transferred by neutrinos is sufficient to obtain the observed explosion energy of @xmath310@xmath5 erg .",
    "even if the neutrino heating is not the main cause of explosions , it will be still critical to accurately evaluate the energy exchanges between neutrinos and matter .",
    "for this purpose , one has to solve the neutrino transfer equations and obtain fluxes , energy spectra , emissions and absorptions .",
    "the numerical treatment of neutrino transfer is a longstanding problem though .",
    "one of the difficulties is the wide range of opacity in the supernova core .",
    "deep inside , interactions are so frequent that thermal and chemical equilibrium is established in a quasi - static manner and neutrinos spread in a diffusive way .",
    "as the density and temperature become lower in the outer region , the neutrino interactions become less frequent and the statistical equilibrium is not achieved . further outside , neutrinos propagate freely through transparent material .",
    "it is the intermediate regime between diffusion and free - streaming that the neutrino heating mechanism operates .",
    "it is hence mandatory in the computation of neutrino transfer to treat all these regimes .",
    "it is computationally demanding , however , as one often sees in the applications of radiation transfer to other subjects . even in spherical symmetry , the neutrino transfer is a three - dimensional problem ( or four - dimensional if one includes time ) since the neutrino distribution is a function of neutrino energy , angle of neutrino momentum with respect to the radial direction as well as radial position .",
    "since the neutrino interactions are strongly energy - dependent , the multi - energy group treatment is indispensable . without any symmetry ,",
    "the neutrino transfer becomes a six dimensional problem : the neutrino distribution is then as a function of three spatial coordinates and three neutrino momentum ( energy and two angles that specify the direction of neutrino momentum are commonly used as independent variables ) . with limited computational resources",
    ", this fact makes the numerical computation of neutrino transfer such a formidable task and various levels of approximations have been employed ( see  [ nu - transfer ] for details ) so far .    the numerical treatment of neutrino transfer under spherical symmetry has been sophisticated over the years - so much so that the boltzmann equation is solved without any approximation .",
    "unfortunately , it has been consistently demonstrated with scrutinized microphysics @xcite that no explosion occurs under spherical symmetry . on the other hand ,",
    "recent multi - dimensional simulations have revealed the critical role of hydrodynamical instabilities with / without possible neutrino assistance for successful supernova explosions @xcite .",
    "core - collapse simulations in axial symmetry have adopted different approximations and only recently the boltzmann equations were directly solved by the discrete - ordinate method for a handful of post - bounce evolutions @xcite . in three spatial dimensions ( 3d ) without any symmetry , most of the simulations done so far focused on the hydrodynamical instabilities with very simple treatments of neutrinos .",
    "very recently the first 3d simulations with the neutrino transport being treated with the isotropic diffusion source approximation have been performed @xcite .",
    "unfortunately , their results are inconclusive owing to limited numerical resolutions .",
    "3d computations of neutrino transfer have just begun and further development is highly awaited .",
    "exploring the explosion mechanism in three dimensions is indeed the current focus in the supernova society .",
    "this is mainly because marginal explosions have been observed in many 2d simulations so far and it is expected that 3d will give a boost : increased degrees of freedom may give fluid elements more time to hover around the heating region .",
    "it was indeed demonstrated by a systematic numerical experiment @xcite that the critical neutrino luminosity is lowered and explosions occur more easily as the spatial dimension increases ( see also * ? ? ?",
    "this needs confirmation by more realistic simulations with detailed neutrino transfer .",
    "it is interesting to assess quantitatively whether the observed rotation and/or magnetic fields of pulsars can be induced by 3d hydrodynamical instabilities as suggested by some authors @xcite .",
    "moreover , gamma ray bursts may be produced by anisotropic neutrino radiations @xcite .",
    "3d neutrino transfer in these contexts has not been studied yet and will be the target in our investigations to come .",
    "under these circumstances , we have developed a numerical code to treat the time - dependent neutrino transfer in 3d space with no symmetry .",
    "we adopt a discrete - ordinate method ( s@xmath6 ) and deploy multi - angle , multi - energy groups to directly solve the boltzmann equation for the neutrino distribution function in six dimensional phase space .",
    "the fully implicit finite differencing in time is employed .",
    "the neutrino reactions and eos of dense matter that are suitable for supernova simulations have been implemented .",
    "as far as the authors know , this is the first study on the 3d neutrino transfer for core - collapse supernovae .",
    "the purpose of this article is to report the first results on the performance of the new 3d code . as a first step , we study the neutrino transfer in static backgrounds in this paper . starting with some basic tests in idealized settings , we then examine the code performance for exemplary core profiles both before and after bounce with the appropriate microphysics inputs . by these tests and applications ,",
    "we demonstrate that the 3d simulation of neutrino transfer is now feasible in all the opacity regimes .",
    "it is true that the problem size is very large and the resolution is still severely limited by the current computing resources .",
    "we discuss the computing power required for the full 3d core - collapse simulations based on the current numerical experiments .",
    "we arrange the article as follows .",
    "we briefly describe the recent developments of neutrino transfer computations for supernovae in  [ nu - transfer ] . in  [ formulation ] , we give the basic equations of neutrino transfer together with the microphysics included in the current version of the code and explain their numerical implementation .",
    "we report in  [ basic ] the results of the basic tests to validate the code : the neutrino transfer in the diffusion and free - streaming limits are tested in ",
    "[ advection ] ; the implementations of neutrino reactions as collision terms are examined in  [ collision ] .",
    "after these basic tests , we proceed to some applications of the code to more realistic background models adopted from supernova simulations in  [ applications ] : we first compute spherically symmetric neutrino transfers in  [ 1dconfig ] and compare them with the results published in other papers .",
    "we then demonstrate some basic features of 2d and 3d neutrino transfers using artificially deformed core profile in   [ 2dconfig ] and [ 3dconfig ] .",
    "the summary is given in ",
    "[ summary ] with some discussions on further extensions of the current code .",
    "we describe briefly the recent developments of neutrino transfer in core - collapse supernovae in order to grasp the status of prescriptions to handle the neutrino transfer in the previous studies .",
    "further references to overview the historical and modern developments , we refer the review articles by @xcite on core - collapse supernovae as well as the books by @xcite on the radiation transfer .    under spherical symmetry",
    ", the development of neutrino transfer has reached a level of sophistication by direct solutions of equations , thanks to enough computing resources recently . after longstanding efforts on the treatment of neutrino transfer by invoking approximations ( see * ? ? ? * for example ) , the numerical solution of the neutrino transfer with multi - energy and multi - angle has become possible under spherical symmetry @xcite in general relativity @xcite . through the developments of the frameworks , the method of numerical solutions both in inertial and co - moving frames have been established to handle the neutrino transfer with the lorentz transformation @xcite .",
    "the comparison of the methods to solve the neutrino transfer by direct solutions of the boltzmann equations and by iterations of the moment equations with a variable eddington factor has been also made to test the approaches of neutrino - radiation hydrodynamics @xcite .",
    "the microphysics of the equation of state and the neutrino reactions have been implemented to examine their influence in detail by having the advance of nuclear physics in supernovae .",
    "the most updated set of neutrino reactions in dense matter @xcite as well as electron capture rates of nuclei @xcite have been adopted to test the impact on the explosion mechanism @xcite .",
    "the role of the equation of state based on the unstable nuclei has been examined through the delicate connections with the neutrino transfer @xcite .",
    "even with the exact treatment of the neutrino transfer and the updated sets of microphysics , the numerical studies of the gravitational collapse of massive stars have shown that there is no successful case of supernova explosion under spherical symmetry for sets of stellar models . in the developments of the numerical methods of neutrino transfer under",
    "spherical symmetry , there has been progress on clarifying the role of neutrino transfer in core - collapse supernovae .",
    "the proper treatment of neutrino transfer is crucial to determine the amount of neutrino trapping in the collapsing core , the energy and flux of neutrinos emitted from the cooling region , the heating behind the stalled shock wave and the prediction of the spectrum of supernova bursts .",
    "the progress from the early methods such as the light - bulb approximation , the leakage scheme and the flux limited diffusion method to the exact treatment of neutrino transfer has clarified the influence of approximations to those quantities . among others , the neutrino heating is sensitive to the neutrino transfer , especially , to the flux factor of neutrino distributions @xcite .",
    "the accurate evaluation by the neutrino transfer is necessary since the flux limited diffusion method may overestimate the flux factor , resulting underestimation of the heating @xcite .",
    "it is to be noted that the proper treatment of neutrino transfer enables ones to predict the energy spectrum of the supernova bursts for terrestrial observations @xcite .",
    "the energy spectra predicted by the neutrino - radiation hydrodynamics are used to evaluate the event numbers for supernova explosions and black hole formations near the galaxy in future by taking into account the neutrino oscillations and the specification of neutrino detectors @xcite . in two dimensions ,",
    "the approximate treatments of the neutrino transfer have been adopted in most of the recent studies by state - of - the - art calculations .",
    "this is because the exact treatment of neutrino transfer becomes much harder than the case of spherical symmetry due to the increase of dimension of phase space from three to five .",
    "there are several categories in the approximate methods , depending on the degree of accuracy regarding transfer and dimensional assumption .",
    "putting the emphasis on the two dimensional behavior , the flux limited diffusion method has been adopted for the neutrino - radiation hydrodynamics to reveal the explosion mechanism @xcite .",
    "the diffusion equations of neutrino energy and flux distributions with multi - energy groups are solved with the flux - limiter to handle the transition to the free - streaming limit .",
    "although this approach is advantageous to describe the lateral transport of neutrinos in supernova cores , the intermediate regime from diffusion to transparent regimes are handled by the prescribed flux - limiter .",
    "attempting to describe better the transition of neutrino transfer in the intermediate regime , the method of `` ray - by - ray plus '' approximation has been adopted for the neutrino - radiation hydrodynamics @xcite utilizing the developed code of neutrino transfer for spherical symmetry @xcite .",
    "the equation of neutrino transfer along each radial ray is solved independently for many directions to cover the whole region of the supernova core . by using the exact treatment of the 1d neutrino transfer for multi - energy groups ,",
    "it is advantageous to describe the whole regime of neutrino transfer . by assuming the spherical symmetry on the transport along each ray ,",
    "the transport of neutrinos for lateral directions is neglected except for the advection with material and a partial contribution of pressure .",
    "this prescription along independent rays overestimates the angular dependence of neutrino quantities and enhances the neutrino fluxes along the radial directions .",
    "some of the recent studies adopt the mixed approach of the ray - by - ray plus approximation together with the approximation of flux limited diffusion @xcite or the isotropic diffusion source approximation ( idsa ) @xcite .",
    "the ray - tracing method has been utilized for the analysis of anisotropic neutrino radiations @xcite .",
    "recently , the 2d numerical simulations by the multi - angle , multi - energy group neutrino - radiation hydrodynamics have been done to study the postbounce phase of core - collapse supernovae .",
    "the neutrino transfer is solved by the discrete - ordinate ( s@xmath6 ) method to describe the whole regime of neutrino transfer @xcite . in order to save computational load and to have large time steps ,",
    "the flux limited diffusion approximation is adopted for the central part of supernova core for the study on the time evolution for a long period @xcite .",
    "the basic behavior of neutrino quantities in 2d has been reported through the examination of angle dependence , moments of energy and angle of neutrino distributions in realistic profiles of supernova dynamics .",
    "the advantage to describe the neutrino transfer in 2d has been demonstrated through comparisons with the counterpart by the flux limited diffusion approximation .",
    "the multi - angle treatment of neutrino transfer has revealed the substantial effects such as asymmetries in neutrino fluxes between pole and equator , enhancements of the neutrino heating through the integral of neutrino sources over many angles @xcite . with those levels of approximations and sophistications described above",
    ", the mechanism of core - collapse supernovae has been explored by neutrino radiation hydrodynamics in 2d to find a handful of successful models with new mechanisms , which are still under debate .    in three dimensions ,",
    "the treatment of neutrino transfer is still in its infancy . in most of the numerical simulations in 3d",
    "@xcite , the neutrino transfer has been neglected or simplified by assuming the given rate of neutrino cooling and/or heating @xcite . the central part of supernova core was often omitted to avoid the treatment of neutrino trapping and emission in the early stage of researches .",
    "these simplifications in the numerical studies are made to explore the frontier of hydrodynamical instabilities and to seek the favorable conditions of explosion in 3d beyond the assumption of axial symmetry . moreover",
    ", the computational cost of neutrino transfer in 3d has been formidable to handle the time evolution of neutrino distributions in six dimensions .",
    "the 3d numerical simulations by the ray - by - ray plus approximations have been reported recently by adopting the flux limited diffusion @xcite or the isotropic diffusion source approximation ( idsa ) @xcite for radial transport .",
    "however , the direct solution of the neutrino transfer in 3d has not been implemented in the numerical simulations so far .",
    "there have been long - term efforts on the numerical method to solve directly the neutrino transfer in multi - dimensions besides the approximative approaches mentioned above ( see also , * ? ? ?",
    "general forms of the neutrino transfer in general relativity have been studied by @xcite .",
    "a time - dependent boltzmann transport scheme in multi - energy and multi - angle has been recently developed for neutrino - radiation hydrodynamics in one and two dimensions @xcite .",
    "the boltzmann equation in 2d axisymmetric geometry is discretized in conservative form using the discrete - ordinates ( s@xmath6 ) method by dropping the velocity dependent terms .",
    "the 2d transport method incorporated to the neutrino radiation hydrodynamics is applied to a time - dependent 2d test of a post - bounce supernova core .",
    "the neutrino radiation hydrodynamics code ( vulcan-2d ) has been utilized for the 2d supernova simulations with a variant of the flux limited method as mentioned above @xcite .",
    "more recently , a new algorithm to solve the neutrino transfer in two dimensions has been developed to conform the lorentz transformation in the transport equation @xcite .",
    "they derive the formulation using the mixed - frame approach by evaluating the collision term in the comoving frame with a taylor expansion regarding lorentz shifts .",
    "the new formalism has been applied to one - dimensional tests of stationary solutions and proto - neutron star cooling .",
    "our study here is to establish the numerical solver of the boltzmann equation for neutrinos in three dimensions , for the first time , beyond the previous developments in two dimensions .",
    "we develop a numerical code to solve the boltzmann equation for multi - energy and multi - angle group in 3d spatial coordinates .",
    "we take an approach to solve the boltzmann equation in the inertial frame , on which we report below , as a basis for our developments .",
    "we extend the formulation and its numerical implementation by evaluating the collision term according to the lorentz transformation as a next step , which will be reported separately elsewhere .",
    "in our numerical code for the neutrino transfer , we solve the boltzmann equation for the neutrino distribution by a discrete ordinate ( s@xmath6 ) method .",
    "our starting point is the boltzmann equation , @xmath7_{collision } , \\ ] ] for the neutrino distribution function , @xmath8 , at position , @xmath9 , and time , @xmath10 , along path length , @xmath11 .",
    "the right hand side is the collision term , which expresses the time rate of change due to the neutrino reactions such as emissions , absorptions and scatterings .",
    "we prepare the neutrino distributions , @xmath12 where @xmath13 and @xmath14@xmath15 are the neutrino energy and the unit vector of neutrino momentum , respectively , in the inertial frame .",
    "we adopt spatial variables , @xmath16 , @xmath17 , @xmath18 , in the spherical coordinate system .",
    "the unit vector of neutrino momentum is defined with respect to the radial direction along the coordinate @xmath16 as in fig .",
    "[ fig : coordinate ] .",
    "we adopt the neutrino angles , @xmath19 , @xmath20 , and the neutrino energy , @xmath13 , to designate the neutrino momentum .",
    "we take an approach in the inertial ( laboratory ) frame to write down the equation of neutrino transfer and to handle the neutrino quantities .",
    "the way of solutions of neutrino transfer differs very much depending on the frame @xcite .",
    "the two major ways in the comoving and inertial frames have both easiness and difficulty in the procedures of solution . on the one hand , the form of left hand side of eq .",
    "( [ eqn : eqtransfin ] ) is simple in the inertial frame , while the derivative terms in the left hand side are complicated with velocity dependent terms in the comoving frame @xcite . on the other hand ,",
    "the collision term can be calculated easily in the comoving frame , where the neutrino reactions occur in the moving fluid .",
    "the collision term in the inertial frame requires tedious procedures through the lorentz transformation of reaction rates from the comoving frame in principle . in our strategy",
    ", we take the simplicity of the transfer equation in three dimensions and will make numerical efforts to handle the collision term in a next step of the development .",
    "fixing the framework in the inertial frame , the boltzmann equation , eq .",
    "( [ eqn : eqtransfin ] ) , in the spherical coordinate system is expressed as @xmath21_{collision},\\end{aligned}\\ ] ] with the definition of the neutrino direction angles @xcite .",
    "we remark that there is neither velocity - dependent term nor energy derivative in the equation in the inertial frame , being different from that in the comoving frame . choosing the angle variable @xmath22 instead of @xmath19 , the equation can be written by @xmath23_{collision}.\\end{aligned}\\ ] ] for the numerical calculation , we rewrite the equation in the conservative form as , @xmath24 - \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}}{r }     \\frac{{\\rm cos}~\\theta}{{\\rm sin}~\\theta }    \\frac{\\partial}{\\partial \\phi_{\\nu } } ( { \\rm sin}~\\phi_{\\nu } f^{in } ) = \\left [ \\frac{1}{c } \\frac{\\delta f^{in}}{\\delta t } \\right]_{collision}.\\end{aligned}\\ ] ] we adopt this equation as the basis for our numerical code .",
    "we remark that the neutrino distribution function is a function of time and six variables in the phase space as written by , @xmath25 in the above expressions , the angle variables , @xmath26 and @xmath20 are those measured in the inertial frame .",
    "we implement the rate of neutrino reactions with the composition of dense matter as contributions to the collision term .",
    "we take here several simplifications to make the neutrino transfer in 3d feasible .    as the first step of 3d calculations ,",
    "we treat mainly the case of static background of material or the case where the motion is very slow so that @xmath1 is very small . in the current study",
    ", we evaluate the collision term of the boltzmann equation to the zeroth order of @xmath1 by neglecting the terms due to the lorentz transformation . for dynamical situations in general ,",
    "this drastic approximation will be studied carefully by evaluating the effects from the lorentz transformation in future .",
    "we plan to implement such effects in all orders of @xmath1 in our formulation by taking into account the energy shift by the doppler effects and the angle shifts by the aberration in the collision term .",
    "in addition , we limit ourselves within a set of neutrino reactions to make the solution of boltzmann equation possible in the current supercomputing facilities . in order to avoid the energy coupling in the collision term",
    ", we do not take into account energy - changing scatterings such as the neutrino - electron scattering @xcite .",
    "this makes the size of the block matrix due to the collision term smaller and the whole matrix tractable in the system of equations . as a further approach ,",
    "we linearize the collision term for the pair process to avoid the non - linearity in equations and to guarantee the convergence .    in future",
    ", having enough supercomputing resources , we will be able to include the energy - changing reactions by enlarging the size of block matrices .",
    "we also may be able to solve the full reactions by the newton iteration , which requires the complicated matrix elements by derivatives , as have been accomplished in the spherical calculations @xcite . in the numerical study under the assumptions above",
    ", we implement the collision term in the following way .",
    "we utilize directly the neutrino distribution function in the inertial frame to evaluate the collision term .",
    "we use the energy and angle variables in the inertial frame in the calculation of the collision term by dropping the shifts .",
    "we drop the superscript _ in _ for the inertial frame in the following expressions . for the emission and absorption of neutrinos ,",
    "the collision term for the energy , @xmath27 , and the angles , @xmath26 and @xmath20 , is expressed as , @xmath28_{emis - abs } =   - r_{abs}(\\varepsilon , \\omega ) f(\\varepsilon , \\omega )    + r_{emis}(\\varepsilon , \\omega ) ( 1 - f(\\varepsilon , \\omega)).\\ ] ] hereafter we suppress the spatial variables and use @xmath29 to denote the two angle variables for the compactness of equations .",
    "the emission rate is related with the absorption rate through the detailed balance as , @xmath30 where @xmath31 is the inverse of temperature and @xmath32 is the chemical potential for neutrinos .",
    "the collision term for the scattering is expressed by , @xmath33_{scat } =   - \\int \\frac{d \\varepsilon ' \\varepsilon'^2}{(2 \\pi)^3}~ \\int d \\omega'~r_{scat}(\\varepsilon , \\omega ; \\varepsilon ' , \\omega ' )   f(\\varepsilon ,",
    "\\omega )    [ 1 - f(\\varepsilon ' , \\omega ' )   ] \\nonumber \\\\ + \\int \\frac{d \\varepsilon ' \\varepsilon'^2}{(2 \\pi)^3}~ \\int d \\omega ' ~r_{scat}(\\varepsilon ' , \\omega ' ; \\varepsilon , \\omega ) f(\\varepsilon ' , \\omega ' )    [ 1 - f(\\varepsilon , \\omega )   ] , \\end{aligned}\\ ] ] where @xmath34 denotes the angle variables after / before the scattering . the energy integration can be done by assuming the iso - energetic scattering .",
    "the expression can be reduced as @xmath35_{scat } =   - \\frac{\\varepsilon^2}{(2 \\pi)^3}~ \\int d \\omega'~r_{scat}(\\omega ; \\omega ' )   [ f(\\varepsilon , \\omega )   - f(\\varepsilon , \\omega ' ) ]   , \\ ] ] with the relation , @xmath36 .",
    "the collision term for the pair - process is expressed by , @xmath37_{pair } =   - \\int \\frac{d \\varepsilon ' \\varepsilon'^2}{(2 \\pi)^3}~ \\int d \\omega'~ r_{pair - anni}(\\varepsilon , \\omega ; \\varepsilon ' , \\omega ' )   f(\\varepsilon , \\omega )    \\overline{f}(\\varepsilon ' , \\omega ' ) \\nonumber \\\\ + \\int \\frac{d \\varepsilon ' \\varepsilon'^2}{(2 \\pi)^3}~ \\int d \\omega ' ~ r_{pair - emis}(\\varepsilon , \\omega ; \\varepsilon ' , \\omega ' ) [ 1 - f(\\varepsilon , \\omega ) ]   [ 1 - \\overline{f}(\\varepsilon ' , \\omega ' ) ] , \\end{aligned}\\ ] ] where @xmath38 denotes the distribution of anti - neutrinos . from the detailed balance ,",
    "the following relation holds ; @xmath39 we linearize the collision term , eq . ( [ eqn : colpair ] ) , by assuming that the distribution for anti - neutrinos is given by that in the previous time - step or the equilibrium distribution .",
    "this is a good approximation since the pair - process is dominant only in high temperature regions , where neutrinos are in thermal equilibrium .",
    "we adopt the approach with the distribution in the previous time - step in all of the numerical calculations with pair processes in the current study .",
    "we utilize further the angle average of the distribution when we take the isotropic emission rate as we will state .",
    "we have also tested that the approach with the equilibrium distribution determined by the local temperature and chemical potential works equally well .",
    "as for the reaction rates , we take mainly from the conventional set by @xcite with some extensions @xcite .",
    "we implement the neutrino reactions , @xmath40   , \\\\ \\label{eqn : nureaction2 } e^+ + n   \\longleftrightarrow   \\bar{\\nu}_e + p \\ \\ [ aecp ] , \\\\ \\label{eqn : nureaction3 } e^- + a   \\longleftrightarrow   \\nu_e + a '       \\ \\ [ eca ]   , \\end{aligned}\\ ] ] for the absorption / emission , @xmath41   , \\\\",
    "\\label{eqn : nureactionscat2 } \\nu + a   \\longleftrightarrow   \\nu + a          \\ \\ [ csc ]   , \\end{aligned}\\ ] ] for the iso - energetic scattering .",
    "we do not take into account the neutrino - electron scattering .",
    "it is well known that the influence of this reaction is minor although it contributes to the thermalization @xcite . as for the pair - process , we take the electron - positron process and the nucleon - nucleon bremsstrahlung as follows , @xmath42 , \\\\",
    "\\label{eqn : nureactionpair2 } n + n \\longleftrightarrow n + n + \\nu_i + \\bar{\\nu}_i   \\ \\ [ nbr ] .\\end{aligned}\\ ] ] for these pair processes , we take the isotropic emission rate as an approximation , which avoids complexity but describes the essential roles . we remark that the set of the reaction rates adopted in the current study is the minimum , which describes sufficiently the major role of neutrino reactions in the supernova mechanism .",
    "further implementation of other neutrino reactions and more sophisticated description of reaction rates in the modern version @xcite will be done once we have enough computing resources in future .",
    "we utilize the physical equation of state ( eos ) of dense matter to evaluate the rates of neutrino reactions .",
    "it is necessary to have the composition of dense matter and the related thermodynamical quantities such as the chemical potentials and the effective mass of nucleon .",
    "we implement the subroutine for the evaluation of quantities from the data table of eos as used in the other simulations of core - collapse supernovae @xcite .",
    "we adopt the table of the shen equation of state @xcite in the current study",
    ". other sets of eos can be used by simply replacing the data table .",
    "we describe the numerical scheme employed in the numerical code for the neutrino transfer in three dimensions .",
    "the method of the discretization is based on the approach by @xcite .",
    "we refer also the references by @xcite for the other methods of discretization of neutrino transfer and radiation transfer .",
    "we define the neutrino distributions at the cell centers and evaluate the advection at the cell interfaces and the collision terms at the cell centers .",
    "we describe the neutrino distributions in the space coordinate with radial @xmath43- , polar @xmath44- and azimuthal @xmath45-grid points and in the neutrino momentum space with energy @xmath46-grid points and angle @xmath47- and @xmath48-grid points .",
    "we explain the detailed relations to define the numerical grid in  [ scheme - grid ] .",
    "we discretize the boltzmann equation , eq .",
    "( [ eqn : eqtransfin - spherical2a ] ) , for the neutrino distribution , @xmath49 , in a finite differenced form on the grid points . here",
    "we assign the integer indices , @xmath14 and @xmath50 , for the time steps and , @xmath51 , for the grid position .",
    "we adopt the implicit differencing in time to ensure the numerical stability for stiff equations and to have long time steps for supernova simulations .",
    "we solve the equation for @xmath52 by evaluating the advection and collision terms at the time step @xmath50 in the following form , @xmath53^{n+1 } + \\left [ \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}~{\\rm cos}~\\phi_{\\nu}}{r { \\rm sin}~\\theta }     \\frac{\\partial}{\\partial \\theta } ( { \\rm sin}~\\theta f ) \\right]^{n+1 } \\nonumber",
    "\\\\ + \\left [ \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}~{\\rm sin}~\\phi_{\\nu}}{r { \\rm sin}~\\theta }     \\frac{\\partial f}{\\partial \\phi } \\right]^{n+1 }   + \\left [ \\frac{1}{r }     \\frac{\\partial}{\\partial \\mu_{\\nu } } [ ( 1-\\mu_{\\nu}^{2 } ) f ] \\right]^{n+1 } \\nonumber \\\\",
    "+ \\left [ - \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}}{r }     \\frac{{\\rm cos}~\\theta}{{\\rm sin}~\\theta }    \\frac{\\partial}{\\partial \\phi_{\\nu } } ( { \\rm sin}~\\phi_{\\nu } f ) \\right]^{n+1 }   = \\left [ \\frac{1}{c } \\frac{\\delta f}{\\delta t } \\right]_{collision}^{n+1},\\end{aligned}\\ ] ]",
    "where we schematically express the advection terms for the cell containing @xmath52 .",
    "we evaluate the advection at the cell interface by the upwind and central differencing for free - streaming and diffusive limits , respectively .",
    "the two differencing methods are smoothly connected by a weighting factor in the intermediate regime between the free - streaming and diffusive limits .",
    "we describe the numerical scheme for the evaluation of the advection terms in  [ scheme - adv ] .",
    "we express the collision terms by the summation of the integrand using the neutrino distributions at the cell centers .",
    "we arrange the discretized neutrino distribution as a vector for the system of linear equations .",
    "the length of the vector is @xmath54 .",
    "we advance time - step by the implicit method for a time step , @xmath55 , by the relation , @xmath56,\\ ] ] for the vector of the neutrino distribution , @xmath57 , at the time step , @xmath50 . by linearizing the collision term",
    "as described above , we rearrange the boltzmann equation as a set of linear equations , @xmath58 .",
    "the matrix , @xmath59 , contains the terms from time - advance , advection and absorption terms .",
    "the source vector contains the old vector and emission terms . this large sparse matrix ( @xmath60 ) contains block diagonal matrices of the size , @xmath61 , which comes mainly from the angle - coupling due to scatterings , together with the lines of none - zero elements due to the advection in the three directions .",
    "we remark that the size of the block matrices becomes huge as @xmath62 , if we take the energy changing reactions and the lorentz energy shifts fully into account .",
    "we solve this system of equations by the matrix solver using the iterative method @xcite .",
    "we use the bi - cgstab method by utilizing a program in the templates library @xcite with the point - jacobi method as a pre - conditioner .",
    "we set the allowable convergence measure to be 10@xmath63 and get the convergence typically within 20 iterations for the current numerical studies .",
    "we solve the evolution of neutrino distributions for multi - species ( @xmath64 ) .",
    "for the basic tests , we treat the one species of neutrino ( @xmath65 ) . for the applications of supernova cores , we treat the three species of neutrinos , @xmath66 , @xmath67 and @xmath68 ( @xmath69 ) .",
    "we treat @xmath68 as a representative of the group for four species @xmath68 , @xmath70 , @xmath71 and @xmath72 .",
    "we performed the series of basic tests on the advection and collision terms , in order to validate the numerical code to solve the neutrino transfer in three dimensions .",
    "we report here the two tests on the advection in the diffusion and free - streaming limits , where we can compare with the analytic behavior .",
    "these tests are performed to validate the advection part of the boltzmann solver .",
    "in addition , we report the tests on the stationary solution , the time evolution toward the equilibrium and the comparison with the spherical calculations . these tests are used to check the collision term as a source term and to examine the neutrino reactions with dense matter in supernova cores .",
    "the method of basic tests in the current study are based on the standard tests described in @xcite .        in order to show that the new code can properly handle diffusions of neutrinos in opaque material ,",
    "we compute the diffusion of a gaussian packet in a uniform background . taking a scattering as a sole contribution to the collision term",
    ", we assume that it is isotropic and isoenergetic and its rate is independent of incident neutrino energy .",
    "we keep multiple energy bins to confirm that the neutrino energy spectrum is unchanged during the simulation .",
    "analytic solutions are available for this test .",
    "the diffusion of a gaussian packet with its central position located at @xmath73 and its width , @xmath74 , being @xmath75 initially is described by @xmath76 where @xmath77 is the neutrino distribution function at the position , , and time , @xmath10 , after the initial time , @xmath78 , @xcite .",
    "the diffusion coefficient , @xmath79 , is related with the mean free path for the scattering , @xmath80 , as @xmath81 .",
    "the parameter , @xmath82 , is the initial height of the packet .",
    "the value of @xmath83 also gives the time scale of diffusion .",
    "the power index , @xmath84 , is related with the space dimension , @xmath85 , as @xmath86 .",
    "we first describe the spherical spreading of the gaussian packet located at the center .",
    "the computation was done in 3d .",
    "this is a very crude approximation to what happens in the opaque region in the supernova core .",
    "we additionally examine non - radial diffusions of the gaussian packet in the box geometry .",
    "although this has no counterpart in the supernova explosion , it is a common benchmark test for neutrino ( or radiation ) transfer codes @xcite .",
    "for the first test we place the gaussian packet at the center of the sphere with the radial coordinate extending from @xmath87 to @xmath88 cm and the polar and azimuthal coordinates from @xmath89 to @xmath90 and from @xmath91 to @xmath92 .",
    "the initial width of the gaussian packet is set to @xmath93 cm .",
    "we consider only the isotropic scattering with a mean free path of @xmath94  cm .",
    "this corresponds to a diffusion time scale of @xmath95 sec .",
    "we deploy @xmath9620 , 40 , 80 and 160 radial grid points and @xmath97 polar grid points and @xmath98 azimuthal grid points as spatial grids . for the momentum space , on the other hand",
    ", we employ @xmath99 for energy grid points and @xmath100 , @xmath101 for angle grid points .",
    "we show in fig .",
    "[ fig : cgauss ] the radial profiles of neutrino density at the initial ( @xmath102 s ) and final ( @xmath103 s ) time steps ( 10@xmath104 steps ) for the case of @xmath105 .",
    "the radial profile of number flux is also shown for the final time step .",
    "we compare the numerical results ( cross symbols ) with the analytic solutions ( solid lines ) .",
    "it is evident that they agree well with each other . in figure",
    "[ fig : cgauss - error ] , we give relative deviations of the numerical results from the analytic solutions averaged over all the radial grid points for different grid sizes . as the number of radial grid points increases , the deviation is reduced as @xmath106 as predicted for the second order central differencing scheme .",
    "the second test for non - radial diffusion is done in 2d and 3d . in 2d",
    ", we place the gaussian packet in the square that has a side of @xmath107  cm and is located at @xmath108 cm . in this small area",
    ", coordinates are approximately cartesian .",
    "we consider again only the isotropic scattering with the same mean free path of @xmath94  cm .",
    "we take @xmath109 , @xmath110 for the spatial grid and @xmath100 , @xmath101 for the angle grid points in the momentum space .",
    "we deploy @xmath111 energy grid points despite the calculation is independent of neutrino energy in this test .",
    "we show in fig .",
    "[ fig : gauss2d ] the neutrino density at an early time ( @xmath112 s ) and the final time ( @xmath113 s ) .",
    "the polar axis is denoted as z ( @xmath114 ) and the distance from the polar axis as r ( @xmath115 ) in the plot .",
    "we compare the numerical result with the analytic solution along @xmath116 cm ( near the center of square ) in fig .",
    "[ fig : gauss2dana ] . the deviation of the numerical result from the analytic solution is less than 0.5 % in the central region after 10@xmath104 time - steps ( @xmath117 s ) .    in order to see the convergence of the numerical results quantitatively ,",
    "we repeat the same computation with different resolutions : ( @xmath43 , @xmath44)=(25,24 ) , ( 50,48 ) , ( 100,96 ) and ( 150,144 ) ; for the momentum space the grid points are essentially the same @xmath100 , @xmath101 except the number of energy grid points is reduced to @xmath99 to save the memory size . in figure",
    "[ fig : gauss2derror ] , we show the relative deviations of the neutrino density averaged over the radial grid points along @xmath118 .",
    "the deviation decreases quadratically as the number of grid points increases as expected for the central differencing scheme .",
    "the test is also done in 3d .",
    "we put a cubic box with a side of @xmath107  cm at a radial position of @xmath119  cm .",
    "the box is small enough to regard the patch of spherical coordinates as cartesian .",
    "the mean free path of the isotropic scattering is again @xmath94  cm .",
    "the numbers of grid points employed in this test are @xmath120 , @xmath121 , @xmath122 for the spatial grid and @xmath100 , @xmath101 , @xmath111 for the momentum space .",
    "we show in fig .",
    "[ fig : gauss3d ] the neutrino density on the plane @xmath123  cm for the initial ( 0 s ) and final ( @xmath124 s ) times as a contour map .",
    "the isosurfaces are also shown in color .",
    "we compare the numerical result with the analytic formula , eq .",
    "( [ eqn : gauss ] ) .",
    "the relative deviation is shown in fig .",
    "[ fig : gauss3dana ] .",
    "the final distribution obtained by the numerical computation agrees very well with the analytic one .",
    "the deviation is typically less than 5 % in the central region for the case with @xmath120 , @xmath121 , @xmath122 at @xmath113 s after 10@xmath104 time - steps ( @xmath117 s ) .",
    "large deviations near the edge of the box are mainly due to the fixed boundary condition we use for this test .    in order to see the convergence of numerical solutions ,",
    "we perform another test computation with a higher spatial resolution , @xmath125 , @xmath126 , @xmath127 , and a smaller time step of @xmath128 s. the results for the different grid sizes are compared at the same timing @xmath129 s. the accuracy is improved by a factor of @xmath32 over the whole region . unfortunately , further computations with even higher resolutions are impossible owing to the limitation of available memory space ( see  [ compsize ] ) and the power index of convergence can not be determined at present .",
    "it is encouraging , however , that the numerical solution is indeed converging to the exact solution in a way that is consistent with the 1d and 2d counterparts .",
    "we note incidentally that the total number of neutrinos in the box is conserved within the accumulation of round - off errors as expected for the conservative scheme .",
    "we next examine the free streaming limit .",
    "we switch off all neutrino reactions in the following . as the simplest test",
    ", we compute a 1d advection of neutrinos .",
    "we utilize a small radial interval located at a large distance .",
    "we set up a step - like distribution initially ( top panel of fig .",
    "[ fig:1d - adv ] ) .",
    "all neutrinos have @xmath130 , which corresponds to the forward grid point for the polar coordinate of neutrino momentum whereas they are uniformly distributed in the azimuthal direction .",
    "the numbers of mesh points are @xmath109 , @xmath131 , @xmath132 for the spatial grid and @xmath133 , @xmath134 , @xmath111 for the momentum space .",
    "this means that we employ the full 3d code to solve the 1d advection in space .",
    "the time step of @xmath135 s is adopted to follow the evolution over @xmath136 s.    as shown in fig .",
    "[ fig:1d - adv ] , the step in the neutrino distribution propagates radially at the projected light speed , @xmath137 .",
    "the edge of the step smears out gradually owing to numerical diffusions as it propagates .",
    "the upwind scheme is adopted for the current test ( see [ scheme - adv ] ) .",
    "we next confirm that this numerical diffusion is reduced when we deploy finer spatial grids and take smaller time steps .",
    "we show in fig .",
    "[ fig:1d - adv - check ] the neutrino distributions at the final time ( @xmath136 s , corresponding to the bottom panel in fig . [ fig:1d - adv ] ) for different spatial and temporal resolutions . in the upper panel ,",
    "we show the cases for different time steps , @xmath138t=10@xmath139 s , 10@xmath140 s and 10@xmath63 s ( corresponding to the courant numbers , 3 , 0.3 and 0.03 , respectively ) for the same number of radial grid points of @xmath43=100 .",
    "the smearing becomes apparently smaller when we reduce the time step from 10@xmath139 s to 10@xmath140 s. the improvement is not so drastic when we take 10@xmath63 s instead of 10@xmath140 s. the further reduction of numerical diffusions is obtained by improving the spatial resolution .",
    "when we increase the number of radial grid points to @xmath43=1000 from @xmath43=100 , the smearing of the step becomes even smaller as we can see in the lower panel .",
    "we note that the time step is simultaneously reduced by a factor of 10 in this computation so that the courant number remains to be 0.3 .",
    "the smearing of sharp edges in the distribution function as observed above is rather common to radiation transfer codes @xcite .",
    "the performance of new code is not so bad as it seems , being comparable to those obtained by other popular transfer codes .",
    "for example , the reduction of numerical diffusion with the spatial and temporal resolutions in this test is similar to what was shown in ",
    "4.3.3 with fig .",
    "16 of @xcite .",
    "no oscillation ( or overshooting ) around the edge in our results is found as expected for the implicit time - differencing we adopt in our code and is consistent with the results reported in  6.1 with fig .",
    "7 of @xcite .",
    "although the simple advection of the step - like distribution is done as a standard test here , we stress that it is too stringent from a view point of core - collapse simulations , since we do not obtain such a sharp edge in the neutrino distribution function as we will see in ",
    "[ 1dconfig ] , for example .",
    "it is true that the smearing of the forward - peaked distribution in the optically thin region at large radii in the core is a concern .",
    "this is a problem more closely connected with the numbers of angular grid points in the momentum space as we will discuss in  [ stationary ] rather than that of the advection scheme , though .",
    "we note also that it is the neutrino transfer and its influences to the hydrodynamics of material below the stalled shock wave ( @xmath3200 km ) that we would like to address with the new code .",
    "then the forward peak of the neutrino angular distribution is not so appreciable and the numerical smearing will be less problematic . the neutrino luminosities and spectra at much larger radii are certainly important particularly from an observational point of view and will be addressed quantitatively by our new code on supercomputers of the next generation .",
    "the current advection scheme is admittedly diffusive and is adopted just as a first step in the 3d neutrino transfer , which itself has become possible only recently and is in its infancy .",
    "exploration of a more sophisticated scheme ( * ? ? ?",
    "* for example ) is hence a future issue .    as a final test",
    ", we present 3d computations of a searchlight beam @xcite .",
    "we note again that this test is also too severe for the code intended for supernova simulations in spite of its popularity as a benchmark test for radiative transfer codes .",
    "indeed , there is no hot spot in the supernova core unlike in the sun which would require high angular resolutions . the main purpose of this test is to examine whether the code can give a correct propagation velocity of neutrinos , that is , the light speed in the genuinely 3d setting .",
    "we inject the neutrino beam with @xmath141 and @xmath142 radian at a certain point on the boundary .",
    "the numbers of mesh points employed for this test are @xmath120 , @xmath121 , @xmath122 for the spatial grid and @xmath100 , @xmath101 , @xmath111 for the momentum space .    in figure [ fig:3d - beam ] , we show the resultant neutrino densities in a 3d box with a side of @xmath107  cm at the time of @xmath31@xmath14310@xmath144 s when they become almost steady .",
    "we can see that the beam propagates along the designated direction , while the beam becomes broader as it propagates because of numerical diffusions .",
    "it is to be noted that the diffusion is mainly due to the small numbers of angular grid points in the momentum space rather than due to the relatively coarse spatial resolution .",
    "( see the employed grid in the 3d box presented in the upper panel ) .",
    "this is different from the situation for the 1d advection discussed earlier .",
    "we also find that the beam shape is deformed as it propagates owing to the non - uniform angular grid in the momentum space along the beam .",
    "these results indicate that it is desirable in principle to deploy an angular mesh in the momentum space that is as fine as possible and covers the whole solid angle uniformly ( see * ? ? ?",
    "* for example ) .",
    "in order to examine the collision term for the neutrino reactions in supernova cores , we investigate test cases with realistic profiles using the neutrino reaction rates described in  [ reaction ] .",
    "we concentrate here on basic tests under spherical symmetry .",
    "we will explore further the neutrino transfer inside the supernova core in  [ applications ] .    as a typical situation ,",
    "we utilize supernova profiles from the spherical calculation @xcite .",
    "we take the profiles of density , temperature and electron fraction at 100 ms after the core bounce in the collapse of the 15m@xmath2 star ( see also  [ 1dconfig ] ) .",
    "we adopt the radial grid points ( @xmath145 ) for @xmath146 km from the original profile .",
    "we cover the first octant of the sphere with the angular grid , though we treat a spherical profile . the neutrino energy and angular grids",
    "are determined by following the setting in the spherical simulations of supernovae by @xcite . the energy grid ( @xmath147 ) is placed logarithmically from 0.9 mev to 300 mev with a fine grid for high energy tails .",
    "we examine stationary cases through comparisons with the formal solutions of neutrino transfer . for this purpose , we take into account absorptions and emissions in the collision term and switch off scatterings .",
    "we check the neutrino propagation with the neutrino reactions in dense matter along a certain ray .",
    "this covers the intermediate regime between the opaque and transparent regimes .",
    "therefore , this is a complementary check to the tests in the diffusion and free - streaming limits .",
    "we evaluate the neutrino distribution at a certain location by the formal solution @xcite . the neutrino distribution , @xmath148 , at the position , @xmath11 , along the ray follows the transfer equation given by , @xmath149 where @xmath150 and @xmath151 are the opacity and the emissivity , respectively . the path length , @xmath11 , is measured backward ( the opposite to the neutrino direction @xmath152 ) from the position ( @xmath153 at @xmath16 to obtain @xmath154 ) to the outer boundary ( @xmath155 at @xmath156 ) . the neutrino distribution at the position , @xmath9 , is obtained by the integral , @xmath157 along the ray designated by @xmath26 and @xmath20 .",
    "the optical depth , @xmath158 , along the ray is given by , @xmath159 we assume in deriving eq .",
    "( [ eqn : formalsol ] ) the incoming neutrino flux is zero at the outer boundary .",
    "we integrate numerically the above equations using the rates of emission and absorption on the grid points along the ray of neutrino propagation . at the same time",
    ", we perform computations of the neutrino transfer by solving the boltzmann equation in 3d for a sufficiently long period to obtain a steady state solution .",
    "we fix the spherical profile of the supernova core at the post - bounce mentioned above by the spatial grid with @xmath160 , @xmath131 and @xmath132 .",
    "we set the neutrino angle grid with @xmath133 , 12 , 24 and @xmath134 .",
    "we treat here the electron - type neutrino only .",
    "we compare the energy spectra obtained by the two methods in fig .",
    "[ fig : formal ] ( a ) .",
    "we plot the spectra at the radial position of @xmath16198.4 km for the neutrino direction with @xmath162 ( the most forward grid point ) for @xmath163 . the distributions accord well with each other for the wide range of neutrino energy , though there is a slight deviation at low and high energies . in fig .",
    "[ fig : formal ] ( b ) , we show relative errors of the distributions by the computation with respect to the formal solutions . for the case of @xmath163 , errors are less than 30@xmath164 for neutrino energies , @xmath165 mev .",
    "errors become large for high energy tails above 200 mev since tails of distributions become fairly small below 10@xmath166 .",
    "as the energy goes below @xmath33 mev , errors increase beyond 10@xmath164 .",
    "this is because the matter becomes transparent for low energy neutrinos with small cross sections .",
    "a high angular resolution is necessary to follow the propagation of neutrinos in the transparent situation . for the medium range of energy , which is most important in the supernova study , the transition from the opaque central core to the transparent outer layers",
    "is well described by the computation .",
    "we next examine the angular resolution by changing @xmath47 . in fig .",
    "[ fig : formal ] ( b ) , we plot also the cases of @xmath133 and 12 for comparison .",
    "the neutrino directions at the most forward grid points are @xmath130 and 0.98156 , respectively , in these cases .",
    "as @xmath47 increases , errors become small in principle , showing the improvement of the angular resolution . although @xmath163 ( or larger ) is preferable for the precise evaluation of forward - peaked distributions , @xmath133 is sufficient to obtain errors less than 40@xmath164 .",
    "note that @xmath133 is the minimally proper size for the supernova study as checked by the detailed tests @xcite and is adopted for the spherical calculations of core - collapse supernovae so far ( * ? ? ? * for example ) .    the angular resolution to describe",
    "the peaked distribution is the intrinsic problem of the s@xmath0 method in the field of radiation hydrodynamics . in the current problem of core - collapse supernovae ,",
    "though , it is rather important to describe the phenomena around @xmath3200 km , where the shock wave is hovering , with the neutrino emission from the central core ( @xmath167 km ) .",
    "therefore , the resolution for the angle factor of @xmath30.25 may be sufficient to describe the phenomena such as neutrino heating , at least for the first trial in 3d simulations .",
    "this is totally different from the situation in the solar physics , for example , where a small hot spot may be crucial for the radiation in outer layers at very large distance . under the reasoning described above",
    ", we adopt @xmath133 for the following study of supernova cores (  [ applications ] ) within the currently available computing resources .",
    "we examine the time evolution of the neutrino distribution toward the equilibrium determined by the condition of dense matter .",
    "we check the time scale to reach the equilibrium and the detailed balance under the chemical and thermal equilibrium through the neutrino reactions .",
    "we follow the evolution from an initial neutrino distribution with small values ( @xmath168 times the equilibrium value ) to the equilibrium state . in the static background ,",
    "the time evolution of the neutrino distribution at a certain energy grid point by the absorption and emission can be analytically expressed as @xmath169 , where @xmath170 and @xmath171 are the initial and equilibrium ( fermi - dirac ) values , respectively .",
    "the time scale , @xmath172 , is given by @xmath173 with the effective mean free path , @xmath80 .",
    "the effective mean free path is defined here by the inverse of the true absorption coefficient , @xmath174 .",
    "the true absorption coefficient is given by the sum of contributions @xmath175 ~,\\ ] ] for electron captures and neutrino absorptions and @xmath176   \\right],\\ ] ] for the pair processes .",
    "since we consider the iso - energetic scattering , the neutrino scattering contributes only to the realization of isotropy .",
    "the scattering coefficient , @xmath177 , is given by @xmath178 which is larger than the absorption coefficient in this case .",
    "the effective mean free path due to the scattering process is short enough to realize the isotropic distribution within a short time period .",
    "we utilize the profile of the supernova core at 100 msec after the bounce as a background and choose a central grid point for the test .",
    "the neutrino reactions listed in  [ reaction ] are all included .    in figure",
    "[ fig : equil ] , we show the time evolution of the neutrino populations of @xmath66 for the energy grid points at @xmath179= 34.0 and 129 mev at the center of the supernova core .",
    "the density , temperature and neutrino chemical potential are 3.15@xmath14310@xmath180 g/@xmath181 , 13.4 mev and 158 mev , respectively .",
    "the time evolution in the computation is well in accord with the analytic solution .",
    "time steps can be very long ( over 1 sec ) once the distribution reaches the chemical equilibrium owing to the implicit treatment .",
    "we show also the energy spectra in fig .",
    "[ fig : equil ] .",
    "the spectrum evolves toward the equilibrium and reaches the fermi - dirac distribution determined by the temperature and chemical potential .",
    "we note that the angle distribution becomes isotropic through scatterings during the evolution .",
    "we check also that the approximation for the pair process , which is taken for the linearization , is appropriate in the realistic profile of supernova core . in the central part of core , where the temperature is high , the neutrino distribution approaches soon the thermal equilibrium as shown above . the blocking factor in the reaction rate for the pair process",
    "can be hence expressed by the thermal distribution or the distribution at the previous step .",
    "the effective mean free paths due to the pair processes , eqs .",
    "( [ eqn : nureactionpair1 ] ) and ( [ eqn : nureactionpair2 ] ) , in the new code are compared with those from the spherical calculation .",
    "they accord very well with each other once the thermal equilibrium is maintained after a short period ( see  [ 1dconfig ] ) .",
    "this time scale is much shorter than the hydrodynamical time scale ( @xmath3ms ) , therefore , the approximation can be safely used in the dynamical simulations of core - collapse supernovae .",
    "we investigate here the performance of our code for realistic profiles taken from supernova cores .",
    "we first employ two spherically symmetric core profiles , one during the collapse and the other for the post - bounce stage . in 2d and 3d cases ,",
    "we deform by hand an originally spherically symmetric core profile rather arbitrarily and investigate the neutrino transfer in the non - spherical settings .",
    "we demonstrate that the new code can describe such features as fluxes and eddington tensors in a qualitatively correct way both in 2d and 3d .",
    "we also use the formal solutions for more quantitative assessments .",
    "we examine first the neutrino transfer under spherical symmetry through comparisons with the numerical results by the neutrino - radiation hydrodynamics in general relativity @xcite . adopting the profiles of supernova cores ,",
    "we follow the time evolution of the neutrino distributions from small initial values until they reach a steady state .",
    "we treat the three neutrino species , @xmath66 , @xmath67 and @xmath68 and implement the neutrino reactions listed in  [ reaction ] .",
    "figure [ fig:1d - profile ] shows the adopted profiles of the supernova core in the gravitational collapse of the 15 m@xmath2 star @xcite from @xcite .",
    "the snapshots are taken at the timings when the central density is 10@xmath182 g/@xmath181 during the collapse and at 100 ms after the core bounce .",
    "the former is an example of the situation during the collapse , where the neutrinos are trapped by the reactions with nuclei .",
    "the latter is a typical situation of the stalled shock wave after the bounce , where the neutrino heating takes place by the neutrino flux from the central core .",
    "we set the spatial grid with @xmath160 , @xmath183 and @xmath184 in the first octant and take the radial grid points from the original profiles as done in  [ collision ] .",
    "the neutrino angle and energy grids are set with @xmath133 , @xmath101 and @xmath147 .",
    "we show the radial distributions of the number densities and fluxes for the three species of neutrinos in the left panel of figs .",
    "[ fig:1d - nudens.rhoc12 ] and [ fig:1d - nuflux.rhoc12 ] for the profile during the collapse .",
    "we show the corresponding distributions for the profile after the bounce in the left panel of figs .",
    "[ fig:1d - nudens.tpb100 ] and [ fig:1d - nuflux.tpb100 ] .",
    "the degenerate neutrinos ( @xmath66 ) and thermal neutrinos ( @xmath67 and @xmath68 ) at the central region are properly described with the tail of free - streaming fluxes in the outer region .    in figures",
    "[ fig:1d - nudens.rhoc12 ] , [ fig:1d - nuflux.rhoc12 ] , [ fig:1d - nudens.tpb100 ] and [ fig:1d - nuflux.tpb100 ] , we compare the current results ( cross symbols ) with the numerical results by the spherical code ( solid lines ) based on @xcite .",
    "since we treat the steady state , we evaluate separately the neutrino distributions for the static background by solving the general relativistic boltzmann equation under spherical symmetry ( 1d ) .",
    "relative errors in the neutrino densities and fluxes between the two evaluations are shown in the right panel of each figure .",
    "in general , the numerical results accord very well with each other , while the errors of the density amount to a few tens of percent near the boundary .",
    "the errors of the fluxes are significant in the region where the errors of the density are appreciable .",
    "we found that the general relativistic treatment in the 1d code does not affect the comparison .",
    "this is because the neutrino distributions are determined locally by the thermodynamical condition at the central region and the neutrino fluxes at the outer layers are not affected by the general relativity due to large radii .",
    "we show in fig .",
    "[ fig:1d - mfp ] the mean free paths of neutrino reactions in the profile after the bounce described above .",
    "the mean free path we discuss hereafter is the effective mean free path defined by the inverse of the absorption and scattering coefficients in eqs .",
    "( [ eqn : kappa - abs ] ) , ( [ eqn : kappa - pair ] ) and ( [ eqn : kappa - scatt ] ) for each process .",
    "we check the mean free paths by comparing with the numerical results obtained by the 1d code . as shown in fig .",
    "[ fig:1d - mfp ] , the mean free paths by the 3d code accord with those in the 1d evaluation .",
    "the relative errors between the two evaluations are within @xmath185 except for the cases of the pair process and nucleon - nucleon bremsstrahlung to be discussed below . the mean free paths for the collapse phase have been also checked in the same way ( not shown here in figure ) .",
    "we note that the mean free paths for the pair processes within the approximate expression accord very well with the full expression in the 1d code in the central region where these reactions are important .",
    "we show in fig .",
    "[ fig:1d - mfp.fac ] the ratios of the mean free path by the 3d calculation to that by the 1d code for the pair process and nucleon - nucleon bremsstrahlung . in the central region ,",
    "the ratio is very close to 1 and its deviation is within @xmath186 .",
    "deviations in the outer layers appear due to the approximation of the reaction rate and the angle - averaged distribution of couterpart - neutrinos .",
    "deviations for the nucleon - nucleon bremsstrahlung are rather small since we adopt the same isotropic rate in the both codes .",
    "large deviations in the pair - process are due to the approximation of taking isotropic reaction rates .",
    "we note , however , that the deviations in the outer layers are not crucial for the whole description since the material is in the transparent regime and contributions of these reactions are minor there .    in figure [ fig:1d - emis ]",
    ", we show the emissivities for the three neutrino species as a function of radius for the profile after the bounce .",
    "the emissivities are defined by @xmath187 and @xmath188 , \\ ] ] for neutrino - emissions ( ecp , aecp and eca ) and pair - processes ( pap and nbr ) , respectively .",
    "we compare the emissivities with those obtained by the 1d code .",
    "the emissivities in the two evaluations agree very well with each other within relative errors of @xmath185 in general .",
    "the largest errors arise in the transitional region between 20 km and 100 km but are within @xmath189 .",
    "the agreement is good even for the pair processes despite the usage of the isotropic rates .",
    "this is because the isotropic term of the reaction rates is dominant in eq .",
    "( [ eqn : emis - pap ] ) with isotropic distributions in the inner region or small distributions in the outer region .",
    "this situation is different from the case of the effective mean free path for the pair processes , where the angular distribution is important due to the exponential factor in eq .",
    "( [ eqn : kappa - pair ] ) .",
    "we examine the energy and angle moments of the neutrino distributions obtained in the 3d code through the comparison with the 1d evaluation .",
    "we show in fig .",
    "[ fig:1d - mom ] the eddington factors , @xmath190 , and the flux factors , @xmath191 , as functions of radius in the post - bounce profile .",
    "the definition of various moments of the neutrino distributions is summarized in  [ moments ] .",
    "we obtain the correct limits of quantities in the opaque and transparent regimes .",
    "the eddington factor and the flux factor are 1/3 and zero , respectively , in the central core , where the distributions are isotropic , and they approach @xmath31 ( forward peaked ) toward the outer layers . the moments by the 3d code accord generally well with those by the 1d evaluation . in figure [ fig:1d - mom.err ] , we show differences of the moments by the 3d code from the 1d evaluation",
    ". deviations within @xmath30.05 appear around the transitional region and near the boundary .",
    "we show , in fig .",
    "[ fig:1d - enu ] , the luminosities and average energies of neutrinos for the post - bounce profile with the corresponding quantities from the 1d code for comparison .",
    "we plot here the average energy , @xmath192 , and the luminosity , @xmath193 , defined in  [ moments ] .",
    "the behavior of the luminosities and average energies accords generally well with the results by the 1d code .",
    "the numerical checks so far prove the new code with the microphysics of neutrinos in dense matter works properly with reliable accuracy in the spherical configurations . from the examination of the effective mean free paths and the emissivities , we judge that the approximate expressions adopted in the pair processes are efficient and sufficient for the numerical studies of supernova cores by the 3d code .      in order to demonstrate the ability of the new code in multi - dimensional realistic settings , we first study 2d case , utilizing artificially deformed profiles of supernova core based on the 1d core - collapse simulation @xcite . for the given background profile ,",
    "we obtain a steady state solution of neutrino transfer by following the time evolution for a sufficiently long time .",
    "we compare the result with the formal solutions as discussed in  [ stationary ] .",
    "we utilize the same spherical profiles for the post - bounce stage as those studied in  [ 1dconfig ] .",
    "we modify the profiles of density , @xmath194(@xmath16 ) , temperature , t(@xmath16 ) , and electron fraction , y@xmath195(@xmath16 ) , along each radial direction , depending on its polar angle , @xmath17 , by scaling the radius , @xmath16 , as @xmath196 where @xmath197 is a parameter to specify the degree of deformation . as a result",
    ", we obtain oblate profiles for positive @xmath197 s , which are crude approximations to rapidly rotating supernova cores .",
    "we show in figs .",
    "[ fig:2d - profile ] and [ fig:2d - contour ] some features of the profiles thus constructed for @xmath198 .",
    "we first examine the neutrino transfer through comparisons with the formal solutions . for this purpose",
    ", we treat the electron - type neutrino alone , taking into account only the emissions and absorptions .",
    "we set the spatial grid with @xmath160 , @xmath199 and @xmath200 in the first octant .",
    "we try four sets of angular meshes in the momentum space : ( @xmath47 , @xmath48)=(6,6 ) , ( 12,6 ) , ( 24,6 ) and ( 12,12 ) .",
    "the number of energy grid points is fixed to @xmath147 .",
    "the relatively small grid sizes are mainly due to the limitation of available computing resources .    the formal solution is obtained by integrating the boltzmann equation along the representative paths shown in fig .",
    "[ fig:2d - contour ] .",
    "these paths go through one of four grid points that are rather arbitrarily chosen and have a radius of @xmath16=98.4 or 198 km with an angle cosine of @xmath201 or @xmath202 .",
    "the solid lines in the figure represent the paths with a polar angle cosine in the momentum space of @xmath162 , which corresponds to the most forward grid point for @xmath163 . for comparison ,",
    "the long - dashed and dashed lines show the paths with @xmath130 and @xmath203 , which correspond to the most forward grid points for @xmath133 and 12 , respectively .",
    "figures [ fig:2d - formal.ith2 ] and [ fig:2d - formal.ith9 ] show the comparison of the numerical results by the new code with the formal solutions . in figure [ fig:2d - formal.ith2 ] , we present the energy spectra for the points close to the equator ( square symbols in fig .",
    "[ fig:2d - contour ] ) .",
    "the numerical results agree with the formal solutions within relative errors of 20 % at r=98.4 km . in this case",
    ", the density at the grid point is rather high ( @xmath310@xmath204 g/@xmath181 ) and the matter is already opaque to neutrinos there .",
    "moreover , the path runs through the proto - neutron star . as a result",
    ", the neutrino spectrum at the grid point is mainly formed by the contributions from relatively near - zones and the agreement of the numerical result with the formal solution is excellent even with the rather coarse grid adopted in this computation . at r=198 km , on the other hand , the agreement is not so good as shown in the right panel of fig .",
    "[ fig:2d - formal.ith2 ] .",
    "this is because the density at the grid point is much lower and the matter in the vicinity is transparent to neutrinos as well as because the path barely touches the periphery of the proto - neutron star .",
    "then the neutrino distribution at the grid point is a superposition of the contributions from very far regions .",
    "in general , the larger the distance to the source is , the more anisotropic the neutrino distribution becomes and the more difficult it is to numerically reproduce it .",
    "it is important to see , however , that the relative error is still within @xmath350 % even at very low energies , where the opacities are the lowest .",
    "these features are common to the points near the pole ( triangle symbols in fig .",
    "[ fig:2d - contour ] ) as seen in fig .",
    "[ fig:2d - formal.ith9 ] : the energy spectra obtained numerically agree with the formal solutions within @xmath350 % except for the high energy tail beyond @xmath3100 mev , where the neutrino populations are very small , f@xmath205 @xmath206 .",
    "the relative errors near the pole are somewhat larger in general than those near the equator .",
    "this is because of the oblate shape of the artificially deformed core in this computation .",
    "the matter densities at the two points near the pole are lower than those at the corresponding points near the equator .",
    "the matter is hence more transparent in the vicinity of the former , hence , the evaluation of the forward peak is further difficult .",
    "the paths near the pole , on the other hand , run into deeper inside the proto - neutron star .",
    "although these effects are counteracting each other , the former turns out to be more important .",
    "the relative errors become smaller for @xmath163 than those for @xmath133 , 12 . the increase of @xmath48 to 12 ,",
    "on the other hand , does not improve the accuracy very much for @xmath100 .",
    "this feature is common to all the paths considered here .",
    "although we need further systematic studies with finer grids , the above facts suggest that it is more important to employ a sufficiently large @xmath47 in the momentum space .",
    "we proceed to the numerical results with the full set of neutrino reactions for the three neutrino species .",
    "we set the number of grid points to @xmath160 , @xmath199 , @xmath200 , @xmath133 and @xmath101 .",
    "we follow the evolution for a sufficiently long time period ( @xmath310 ms ) to obtain a steady state .",
    "we show in fig .",
    "[ fig:2d - nudens ] the contour plots of the neutrino density on the meridian slice with a constant @xmath18=0.44 radian .",
    "the neutrino distributions apparently reflect the deformed profiles of density and temperature .",
    "the electron - type neutrinos are mostly populated in the central region , while the electron - type anti - neutrinos and mu - type neutrinos mainly exist off - center , where the temperature is high .",
    "figure [ fig:2d - nudens.radial ] presents the radial profiles of the neutrino density and flux along the directions with @xmath201 ( near the equator ) and @xmath202 ( near the pole ) .",
    "the peaks of the densities for electron - type neutrinos are located at the center with different widths , reflecting the deformation of the proto - neutron star .",
    "the peaks for electron - type anti - neutrinos and mu - type neutrinos , on the other hand , are located off - center at different radial positions corresponding to the temperature peaks .",
    "these neutrinos are mainly produced by the pair - processes in non - degenerate and positron - abundant environment .",
    "this is the reason why they are abundant off - center .",
    "we find that their populations agree very well with the local equilibrium distributions .",
    "the radial neutrino fluxes also reflect the deformed matter distributions .",
    "in fact , the radial fluxes near the pole are larger than those near the equator at the same radius , since the density gradient is steeper near the pole ( see fig .",
    "[ fig:2d - nudens ] ) .",
    "we show not only the radial neutrino flux but also the polar flux of electron - type anti - neutrinos in fig .",
    "[ fig:2d - nuflux ] to elucidate multi - dimensional transfer .",
    "the radial flux is enhanced near the pole as just mentioned .",
    "the polar flux , on the other hand , is significant in the middle region between the pole and the equatorial plane . because of the deformation",
    ", the density gradient is directed to the pole in general and is greatest in the middle region , since the axial symmetry and equatorial symmetry imposed in this computation force the density gradients radially directed near the pole and equator .",
    "we stress that this is a feature that can be captured properly only by the multi - dimensional transfer computations such as done in the current study and not by the ray - by - ray approximation .",
    "we note that the polar flux is significant even beyond 100 km , where an approximation by the polar gradient of the neutrino pressure @xcite may break down .",
    "we examine the energy and angle moments of neutrino distributions in figs .",
    "[ fig:2d - nueave ] and [ fig:2d - eddington ] .",
    "the flux factors , @xmath191 , are shown in the upper panel of fig .",
    "[ fig:2d - nueave ] as functions of radius along the two directions discussed above .",
    "the flux factors change from 0 at center to 1 at large radii for both directions .",
    "the transitional zone corresponds to the region with the optical depth @xmath31 and has a different radial location for each direction .",
    "the average energies , @xmath192 , are shown in the lower panel of fig .",
    "[ fig:2d - nueave ] as functions of radius .",
    "the radial dependence of energies for the three species of neutrinos reflects the thermodynamical states ( degenerate or not ) in the deformed core .",
    "the profile of the average energy for electron - type neutrinos follows roughly the density profile .",
    "the average energy declines rapidly as the density ( and hence the degeneracy parameter given by chemical potential divided by temperature ) decreases with radius .",
    "the profiles for other types of neutrinos ( electron - type anti - neutrinos and mu - type neutrinos ) , on the other hand , reflect the temperature profile , having a peak around 1020 km .",
    "the radial profiles near the equator are shifted outwards from those near the pole just as the other quantities seen above .",
    "as another measure of the transition from the opaque to transparent regimes , we show the eddington tensor as a function of radius along the same two directions in fig .",
    "[ fig:2d - eddington ] .",
    "the diagonal elements of the eddington tensor ( @xmath207- , @xmath208- and @xmath209-components ) are shown for mu - type neutrinos with three different energies .",
    "the diagonal elements are 1/3 in the central region , where the matter is opaque and the neutrino distributions are isotropic .",
    "the @xmath207-component increases with radius as the neutrino distributions become more forward - peaked , whereas @xmath208- and @xmath209-components decrease .",
    "all off - diagonal elements are found to be nearly zero at the central region and have small values also at large radii .",
    "the transition of the diagonal elements from 1/3 to 1 or 0 occurs around the neutrino sphere , which has larger radii for higher neutrino energies .",
    "we remark that the energy dependence is not so strong for electron - type neutrinos and anti - neutrinos and the radial profiles of the eddington tensor are more close to each other for the three neutrino energies ( not shown in the figure ) .",
    "this is because the isotropy of the neutrino distributions is maintained up to @xmath3100 km through the charged current process .",
    "this behavior is consistent with the analysis by @xcite .",
    "although the density profile is rather more extended in our model compared with theirs , they indeed found the delayed decoupling near the equator in their rotating model as seen in the right panel of their fig . 6 .",
    "the radial distributions of the eddington tensor also depends on the polar angle ( see top and bottom panels of fig .",
    "[ fig:2d - eddington ] ) .",
    "because of smaller density scale heights near the pole in the deformed core , the transition from the opaque to transparent regimes occurs at deeper and narrower locations near the pole as seen in fig .",
    "[ fig:2d - profile ] .",
    "these are just as expected intuitively for the oblate core and demonstrate that the new code works appropriately at least qualitatively for the 2d configurations considered here .",
    "we demonstrate here the performance of the new code in 3d realistic settings .",
    "we study the 3d neutrino transfer utilizing deformed profiles in a similar manner to those studied in ",
    "[ 2dconfig ] .",
    "we modify the deformed profiles further by adding the dependence on azimuthal angle , @xmath18 , in the scaling as @xmath210 the resulting 3d profiles are deformed maximally with polar dependence in the yz - plane ( @xmath18=@xmath90/2 ) , whereas they have no polar dependence in the zx - plane ( @xmath18=0 ) .",
    "these profiles are simple examples inspired by the asymmetric shape of supernova cores in the 3d standing accretion shock instability ( sasi ) @xcite .",
    "we first check the neutrino transfer through comparisons with the formal solutions in the same way as in 2d .",
    "we treat the electron - type neutrino with the emissions and absorptions .",
    "we set the spatial grid with @xmath160 , @xmath199 and @xmath200 and the angle grid with @xmath133 and @xmath134 .",
    "figure [ fig:3d - formal ] shows the comparison between the steady and formal solutions .",
    "four panels show the energy spectra at four locations with @xmath16=98.4 km in different directions .",
    "the left panels correspond to the spectra for two polar directions , @xmath201 ( top ) and 0.98 ( bottom ) on the meridian slice with @xmath18=0.262 radian ( near the zx - plane ) .",
    "the right panels correspond to the spectra for @xmath201 ( top ) and 0.98 ( bottom ) on the slice with @xmath18=1.309 radian ( near the yz - plane ) .",
    "the agreement between the two solutions is generally good for the wide range of energy , having relative errors within @xmath320 % at energies around 20 mev .",
    "larger errors at low and high energies arise due to the same reason as described in  [ stationary ] .",
    "the energy spectra in the right panels differ each other due to the deformation with polar dependence .",
    "the energy spectrum near the equator ( right top ) is harder than that near the pole ( right bottom ) due to different densities and temperatures at the two locations .",
    "the two energy spectra in the left panels are similar each other due to a nearly spherical geometry of the background .",
    "next , we examine the numerical results with the full set of neutrino reactions .",
    "we set the angle grid with @xmath133 and @xmath101 .",
    "we display in figs .",
    "[ fig:3d - profile.iph3 ] and [ fig:3d - profile.iph8 ] the density and fluxes of electron - type anti - neutrinos on the slices with @xmath18=0.436 and 1.309 radian , respectively , by color contour maps . figure [ fig:3d - profile.iph8 ] demonstrates the deformations of density and flux profiles near the yz - plane , having the background with strong polar - dependence .",
    "the deformed profile of neutrino density follows exactly the shape of the deformed profile of temperature .",
    "the radial flux is enhanced around the pole and the polar flux is appreciable in the middle region as discussed in  [ 2dconfig ] .",
    "the azimuthal flux is not significant due to a small gradient in the azimuthal direction near the yz - plane . in contrast , the density and radial flux near the zx - plane in fig .",
    "[ fig:3d - profile.iph3 ] have less deformed shapes than those near the yz - plane . while the polar flux has a certain contribution in the middle , the azimuthal flux has a significant magnitude due to the azimuthal dependence of the background near the zx - plane .",
    "we stress that our code properly describes the polar and azimuthal transfer , reflecting the deformation of the 3d supernova core .",
    "this is the advantage of the 3d boltzmann solver in 3d profiles .",
    "the non - radial transfer can not be described correctly in the ray - by - ray approach .",
    "we found that the polar and azimuthal fluxes are appreciable as compared with the radial flux in a wide region as seen in figs .",
    "[ fig:3d - profile.iph3 ] and [ fig:3d - profile.iph8 ] .",
    "the non - radial fluxes are significant even at @xmath211100 km and spread beyond the diffusion regime . in this case",
    ", the reliability of the flux limited diffusion approximation is doubtful .",
    "our code is , therefore , a unique tool to study the neutrino transfer in 3d configurations and to examine the approximations used in the state - of - the - art supernova simulations .",
    "we examine the energy and angle moments of the neutrino distributions in figure [ fig:3d - eavemu ] .",
    "contour plots show the angle moments , @xmath212 , and the average energies , @xmath192 , for electron - type anti - neutrinos on the slices with @xmath213 ( near the zx - plane : left ) and @xmath214 ( near the yz - plane : right ) radian .",
    "deformation is strong near the yz - plane and weak near the zx - plane due to the polar and azimuthal dependence .",
    "the angle moments have an isotropic value of 1/3 at the central region as shown by the deformed shape of contour lines .",
    "they approach @xmath30.8 at @xmath3500 km independent of the polar direction as the angle distributions approach a forward - peaked shape .",
    "the contour lines for the average energy have also a deformed shape , reflecting the deformed supernova core",
    ". the average energies at large radii ( @xmath31000 km , not shown in the figure ) do not show any significant asymmetry .",
    "figure [ fig:3d - eddington ] shows the elements of the eddington tensor as functions of radius along the two polar directions , @xmath201 ( top ) and @xmath202 ( bottom ) , on the slice with @xmath214 radian ( near the yz - plane ) .",
    "six elements of the tensor are shown for electron - type anti - neutrinos at energy grid point of 34.0 mev .",
    "the transitions from the isotropic values ( 1/3 for diagonal and 0 for non - diagonal elements ) occur further locations in the direction near the equator than those near the pole .",
    "this dependence on the polar direction is small near the zx - plane and the transitions occur similar locations ( not shown here ) .",
    "the magnitude of non - diagonal elements is appreciable at outer layers having the azimuthal dependence in the 3d supernova core .",
    "the transition from the isotropic regime to the free - streaming regime is described well by the new code as in the 1d and 2d cases .",
    "our code is also useful to examine the eddington tensors for general 3d profiles and to provide valuable information for the approaches using variable eddington factors .",
    "we have developed the numerical code to calculate the neutrino transfer with multi - energy and multi - angle in three dimensions for the study of core - collapse supernovae .",
    "the numerical code solves the boltzmann equations for the neutrino distributions by the discrete - ordinate ( s@xmath6 ) method .",
    "the time step is advanced by the fully implicit differencing .",
    "the neutrino distribution is a function of time , three spatial coordinates , neutrino energy and two angles .",
    "we solve , therefore , the time evolution of the distributions in six phase - space dimensions . an essential set of neutrino reactions ( emission , absorption , scattering and pair processes ) is implemented in the collision term of the boltzmann equation .",
    "the boltzmann equations are formulated in the inertial frame as the basis of our developments . in the current study for the static background",
    ", we drop the velocity dependent terms in the collision term .",
    "the collision term of the pair - processes is linearized by assuming the neutrino distributions for the counterpart of the neutrino pair .",
    "the set of equations for the discretized form of the boltzmann equations is formulated as a linear equation for the vector of neutrino distributions .",
    "the large sparse matrix with block diagonal matrices is solved by an iterative method .",
    "we have performed the numerical simulations by the 3d boltzmann solver to validate the numerical code and to apply it to the realistic profiles of supernova core .",
    "the numerical code of the 3d boltzmann solver describes correctly the neutrino transfer in the diffusion and free streaming limits .",
    "the collision term by the neutrino reactions has been checked by the formal solutions as well as the analytic evolution toward the equilibrium .",
    "the pair processes are well described in an approximate expression for the linearization of the collision term .",
    "we have examined the neutrino transfer in the profiles of the supernova cores before and after the bounce using the numerical results from the previous simulations under spherical symmetry .",
    "the 3d calculations using the spherical configuration show the good agreement in neutrino distributions with the spherical calculations .    we have demonstrated that the ability of the 3d numerical code to solve the neutrino transfer for artificially deformed supernova cores in 2d and 3d .",
    "the new code describes properly the multi - dimensional feature such as lateral and azimuthal fluxes , which can not be handled in approximate methods .",
    "the moments of energy and angle of neutrino distributions in 3d can be revealed by the new code and will be helpful to gauge simplified transfer approaches .    toward the full calculation of core - collapse supernovae by the neutrino - radiation hydrodynamics ,",
    "there are necessary developments on top of the current 3d code .",
    "first of all , we need to link the 3d boltzmann solver with the numerical code for the 3d hydrodynamics .",
    "this development for the neutrino - radiation hydrodynamics is now under way . in order to describe the neutrino transfer in hydrodynamics ,",
    "it is necessary to take into account the relativistic effects ( @xmath1 terms ) such as the doppler shifts of neutrino energy and the aberration of neutrino angles .",
    "we plan to evaluate the collision term by considering the lorentz transformation of the neutrino distributions between the inertial and comoving frames .",
    "this causes changes of neutrino energies by scatterings in the inertial frame even for the iso - energetic scattering in the comoving frame .",
    "therefore , the consideration of energy change in the collision term becomes mandatory .",
    "studies by the developments mentioned above will be reported as the following articles after the current study in series .",
    "further generalization of the 3d numerical code would require supercomputers in exa - scale . in principle , one has to include the energy - changing reactions such as electron - neutrino scatterings in the collision term .",
    "considering the energy coupling makes the size of block matrix larger and the computation formidable .",
    "the non - linear treatment of the pair processes requires iterations of the whole solution .",
    "the general relativistic treatment of the whole framework makes the computation further challenging .",
    "therefore , the full 3d simulations with the extensions mentioned above awaits the next generation supercomputers to perform .",
    "the current study proves that the calculation of the neutrino transfer in 3d is now feasible , marking the first step toward this direction .",
    "we are grateful to k. nakazato , k. kotake , k. kiuchi , n. ohnishi and h. suzuki for the fruitful collaborations and the profitable discussions on supernova simulations .",
    "we thank t. takiwaki for providing the data of profiles from his 3d simulations of core - collapse supernovae and h. nagakura and s. furusawa for collaborative works .",
    "k. s. is grateful to s. nasu and t. sato for the investigation on the evaluation of neutrino reactions .",
    "we express our gratitude to t .- h .",
    "janka , e. mller and w. hillebrandt for the hospitality at max planck institut fr astrophysik where the developement was initiated during our stay .",
    "k. s. expresses his thanks to c. ott and t. mezzacappa for valuable comments on the numerical methods of neutrino transfer in 2d and 3d .",
    "k. s. thanks the advice on parallel computing from h. matsufuru , a. imakura and t. sakurai as well as the support by s. hashimoto , s. aoki , m. shibata and h. toki toward the full simulation of 3d supernovae by supercomputing beyond the peta - scale . k. s. thanks also h. monden - torihata for the technical assistance on 3d graphics .",
    "the numerical computations in this work were performed on the supercomputers at research center for nuclear physics ( rcnp ) in osaka university , the university of tokyo , yukawa institute for theoretical physics ( yitp ) in kyoto university , japan atomic energy agency ( jaea ) and high energy accelerator research organization ( kek ) .",
    "a part of this work has been done during the research workshops : `` microphysics in computational relativistic astrophysics '' at the perimeter institute for theoretical physics in ontario , canada and `` extreme computing and its implications for the nuclear physics / applied mathematics / computer science interface '' ( int-11 - 2a ) at the institute for nuclear theory , university of washington , usa .",
    "k. s. would like to express his gratitude for their supports and the discussions exchanged with the participants during the stay .",
    "this work is partially supported by the grant - in - aid for scientific research on innovative areas ( nos . 20105004 , 20105005 ) and the grant - in - aid for the scientific research ( nos .",
    "19104006 , 21540281 , 22540296 ) from the ministry of education , culture , sports , science and technology ( mext ) in japan .",
    "this numerical study on core - collapse supernovae using the supercomputer facilities is supported by the hpci strategic program of mext , japan .",
    "the reversed transformation can be found in @xcite .",
    "the neutrino direction in the inertial frame is defined by two angles , @xmath19 and @xmath20 , with respect to these unit vectors .",
    "the polar angle between the neutrino direction , @xmath14@xmath15 , and the radial coordinate , @xmath218 , is denoted by @xmath19 .",
    "the azimuthal angle around the radial coordinate from the @xmath219-direction is denoted by @xmath20 .",
    "the three components of @xmath14@xmath15 are given by @xmath220 @xmath221 @xmath222 they can be expressed in terms of the angle variable as @xmath223 @xmath224 @xmath225      we arrange the radial , polar and azimuthal coordinates by @xmath43 , @xmath44 and @xmath45 grid points .",
    "we cover the neutrino energy and angles by @xmath46 , @xmath47 and @xmath48 grid points .",
    "hereafter , we use lowercase subscripts ( e.g. @xmath51 , @xmath226 ) for the mesh centers and uppercase subscripts ( e.g. @xmath227 , @xmath228 ) to index the location .",
    "we assign the integer index from 1 to @xmath229 for the cell centers and the integer index from 0 to @xmath229 for the cell interfaces , where @xmath229 is the number of grid points for the coordinates ( @xmath230 , @xmath44 and @xmath45 ) .",
    "the @xmath51-th cell center is located between the ( @xmath231)th and @xmath227th interfaces ( e.g. * ? ? ?",
    "the radial grid points at the cell interface are denoted by @xmath232 , which covers from @xmath233 to @xmath234 .",
    "we define the radial grid points at the cell center by @xmath235^{\\frac{1}{3 } } ~.\\ ] ] we determine the grid points for the neutrino angle , @xmath236 , by the points and weights obtained from the formula of the gaussian quadrature .",
    "the @xmath26-grid points for the cell center , @xmath237 , are given by the quadrature points .",
    "the @xmath26-grid points for the cell interface are determined by @xmath238 where @xmath239 are the quadrature weights for the cell containing @xmath237 . starting with @xmath240",
    ", we can determine the @xmath26-grid points up to @xmath241 .",
    "the angle factor at the cell interface , which is necessary for the evaluation of the @xmath26-advection , is obtained by @xmath242 the angle factor at the boundary is set as @xmath243 and those at other grid points are determined accordingly up to @xmath244 .",
    "we use indices @xmath51 and @xmath227 for spatial coordinates and @xmath226 and @xmath228 for neutrino angle coordinates , hereafter .",
    "we arrange the grid points for the polar coordinate , @xmath17 , in terms of @xmath245 in the same manner as the @xmath26-grid points described above .",
    "we set the grid for the cell center , @xmath246 , and the corresponding weights , @xmath247 , from the gaussian quadrature points .",
    "the grid points for the cell interface are determined by @xmath248 to cover from @xmath249 to @xmath250 .",
    "the angle factor at the cell interface for the polar advection is given by @xmath251 starting from the value at the boundary as @xmath252 .",
    "similarly , the @xmath20-grid points at the cell center are set by the gaussian quadrature with @xmath253 and @xmath254 .",
    "the grid points at the cell interface are determined by @xmath255 from @xmath256 to @xmath257 .",
    "the angle factor at the cell interface used for the @xmath20-advection is given by @xmath258 starting with @xmath259 .",
    "for three dimensional calculations , we need to cover @xmath20 from 0 to 2@xmath90 .",
    "we repeat the above procedure from @xmath257 to @xmath260 after dividing the whole angle range into two parts .",
    "this is to avoid the @xmath20-grid being asymmetric around the radial direction .",
    "the @xmath18-grid is given in a similar manner to @xmath20-grid .",
    "the @xmath18-grid points for the cell center are denoted by @xmath261 and those for the cell interface are given by @xmath262 the points , @xmath263 , and weights , @xmath264 , are taken from the gaussian quadrature points . finally , the energy grid points at the cell center are defined by @xmath265 from the energy grid points at the cell boundary , @xmath266 , covering the energy range from @xmath267 to @xmath268 .",
    "the energy integration is done by the cell volume for the energy phase space , @xmath269 , as @xmath270      we describe a discretized form for the advection terms in our scheme .",
    "the current approach is an extension of the method by @xcite adopting an interpolation between first- and second - order finite difference representation of the neutrino advection .",
    "we pay attention to the evaluation of quantities at the cell interfaces for a wide range of opacities .",
    "we assume the evaluation is done at the time step @xmath50 , although we drop here the index .",
    "first , we explain the advection terms for @xmath16 and @xmath26 which are the two basic variables used under spherical symmetry .",
    "the radial advection is expressed by @xmath271 = \\left [        \\mu_{\\nu }          \\frac{\\partial}{\\partial ( r^3 / 3 ) } ( r^{2 } f ) \\right ] = { \\mu_{\\nu}}_{j } ~ \\frac{3}{r_{i}^{3 } - r_{i-1}^{3 } }   ~ ( r_{i}^{2 } ~ f_{i } - r_{i-1}^{2 } ~ f_{i-1 } ) , \\ ] ] where @xmath272 and @xmath273 are the neutrino distributions at the cell interfaces for @xmath274 .",
    "the value of @xmath275 at the cell boundary is evaluated by @xmath276 for both inward and outward directions of neutrinos , depending on the sign of @xmath237 .",
    "for example , the expression for outward neutrinos ( @xmath277 ) becomes @xmath278 where @xmath279 is a weighting factor to bridge the upwind and central differencing .",
    "we note that the expression , @xmath280 , is obtained for the upwind differencing by setting @xmath281 , whereas the expression , @xmath282 , is obtained for the central differencing by setting @xmath283 .",
    "the value of @xmath279 is determined by a smooth function to connect the diffusion ( @xmath283 ) and free - streaming ( @xmath281 ) regimes .",
    "we employ the following expression @xmath284 based on the formula by @xcite . here",
    "the interval of radial grid points is defined by @xmath285 and the average of mean free paths is defined by @xmath286 .",
    "an adjustable factor , @xmath84 , is set to be 100 to ensure @xmath283 for the diffusion regime even when @xmath287 .",
    "the advection term for @xmath288 is given by @xmath289 \\right ]   = \\frac{3}{2 } ~ \\frac{r_{i}^{2 } - r_{i-1}^{2}}{r_{i}^{3 } - r_{i-1}^{3 } } ~ \\frac{1}{{d \\mu_{\\nu}}_{j } }   ~ \\left [ ( 1-{\\mu_{\\nu}}^2)_{j } f_{j } - ( 1-{\\mu_{\\nu}}^2)_{j-1 } f_{j-1 } \\right],\\ ] ] where we take the upwind differencing and set simply @xmath290 .",
    "we use the angle factor given by eq .",
    "( [ eqn : munu2 ] ) .",
    "the relation of eq .",
    "( [ eqn : munu2 ] ) must be used to guarantee the steady state for infinite homogeneous medium ( constant @xmath291 ) in the neutrino transfer under spherical symmetry by adopting the advection terms with eqs .",
    "( [ eqn : advection - radial ] ) and ( [ eqn : advection - munu ] ) as described in @xcite .",
    "next , we describe the advection terms for @xmath17 and @xmath20 , which are essential for the description under axial symmetry .",
    "we rewrite the @xmath17-advection term by using the variable @xmath292 and discretize the term by @xmath293   = \\left [ - \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}~{\\rm cos}~\\phi_{\\nu}}{r }     \\frac{\\partial}{\\partial \\mu } [ ~(1-\\mu^{2})^{\\frac{1}{2 } } f~ ] \\right ] \\nonumber \\\\ = - \\frac{3}{2 } ~ \\frac{r_{i_r}^{2 } - r_{i_r-1}^{2}}{r_{i_r}^{3 } - r_{i_r-1}^{3 } }   ( 1-{\\mu_{\\nu}}_{j_{\\theta}}^{2})^{\\frac{1}{2 } } { \\cos \\phi_{\\nu}}_{j_{\\phi}}~ \\frac{1}{d \\mu_{i_{\\theta } } }   ~ \\left [ ( 1-{\\mu}^2)^{\\frac{1}{2}}_{i_{\\theta } }    f_{i_{\\theta } }          - ( 1-{\\mu}^2)^{\\frac{1}{2}}_{i_{\\theta}-1 } f_{i_{\\theta}-1 } \\right ] ~.   \\end{aligned}\\ ] ] we use the angle factor given by eq .",
    "( [ eqn : mu2 ] ) .",
    "the factor , @xmath294 , determines the direction of advection and the evaluation of @xmath295 at the cell interface .",
    "depending on the sign of @xmath296 , the value at the interface is given by @xmath297 this expression is adopted to connect the diffusion and free - streaming limits smoothly by the factor , @xmath298 , in the same way as the one used in the radial advection .",
    "the form of @xmath298 is given in a similar form as eq .",
    "( [ eqn : beta - radial ] ) by replacing the width of grids and the average mean free path to the ones in polar direction .",
    "the advection term for @xmath20 is given by @xmath299   = \\left [ - \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}}{r }     \\frac{\\mu}{\\sqrt{1-\\mu^{2 } } }    \\frac{\\partial}{\\partial \\phi_{\\nu } } ( { \\rm sin}~\\phi_{\\nu } f ) \\right ] \\nonumber \\\\ = - \\frac{3}{2 } ~ \\frac{r_{i_r}^{2 } - r_{i_r-1}^{2}}{r_{i_r}^{3 } - r_{i_r-1}^{3 } }   ( 1-{\\mu_{\\nu}}_{j_{\\theta}}^{2})^{\\frac{1}{2 } } ~ \\frac{\\mu_{i_{\\theta}}}{(1-{\\mu_{i_{\\theta}}^{2})^{\\frac{1}{2 } } } } ~ \\frac{1}{{d \\phi_{\\nu}}_{j_{\\phi } } }   \\left [ ( \\sin \\phi_{\\nu})_{j_{\\phi } } f_{j_{\\phi } } - ( \\sin \\phi_{\\nu})_{j_{\\phi}-1 } f_{j_{\\phi}-1 } \\right ] ~ , \\end{aligned}\\ ] ] using the variable , @xmath292 . the angle factor is given by eq .",
    "( [ eqn : phinu2 ] ) .",
    "the sign of @xmath300 determines the direction of advection .",
    "we take the upwind differencing for the evaluation of @xmath301 at the cell interface through the relation as @xmath302 in the same manner as the spherical case , the combination of eqs .",
    "( [ eqn : mu2 ] ) and ( [ eqn : phinu2 ] ) guarantees the steady state for infinite homogeneous medium in the neutrino transfer under axial symmetry when the advection terms of @xmath17 and @xmath20 are expressed by eqs .",
    "( [ eqn : advection - polar ] ) and ( [ eqn : advection - phinu ] ) as described in @xcite .",
    "finally , we describe the advection term for @xmath18 , which is necessary for three dimensional calculations .",
    "the advection term is expressed in terms of @xmath292 as @xmath303   = \\left [ \\frac{\\sqrt{1-\\mu_{\\nu}^{2}}~{\\rm sin}~\\phi_{\\nu}}{r \\sqrt{1-\\mu^{2 } } }     \\frac{\\partial f}{\\partial \\phi } \\right ] \\nonumber \\\\",
    "= \\frac{3}{2 } ~ \\frac{r_{i_r}^{2 } - r_{i_r-1}^{2}}{r_{i_r}^{3 } - r_{i_r-1}^{3 } }   ( 1-{\\mu_{\\nu}}_{j_{\\theta}}^{2})^{\\frac{1}{2 } } ~ \\frac{{\\sin \\phi_{\\nu}}_{j_{\\phi}}}{(1-{\\mu_{i_{\\theta}}^{2})^{\\frac{1}{2 } } } } ~ \\frac{1}{{d \\phi}_{i_{\\phi } } } \\left [ f_{i_{\\phi } } - f_{i_{\\phi}-1 } \\right ] ~.\\end{aligned}\\ ] ] the evaluation of @xmath304 is made by @xmath305 depending on the sign of @xmath306 .",
    "the form of @xmath307 is given by a smooth function , which is similar to @xmath308 and @xmath298 .",
    "this form of @xmath18-advection fulfills the steady state in infinite homogenous matter and the advection vanishes when @xmath309 is constant .",
    "we define the moments of energy and angle of the neutrino distributions .",
    "all evaluations here are done using the quantities in the inertial frame , though we dropped superscripts for the compactness .",
    "first of all , the neutrino density is evaluated by @xmath310 the first moment of energy is defined by @xmath311 where the energy density of neutrinos is given by @xmath312    the first moment of angle is defined by @xmath313 where the radial number flux is given by @xmath314 the polar and azimuthal fluxes are obtained by @xmath315 @xmath316 the radial luminosity of neutrinos is defined by @xmath317 where the energy flux is given by @xmath318    the second moment of angle is defined by @xmath319 we evaluate the elements of the eddington tensor as defined by @xmath320 where the elements of the pressure tensor are defined by @xmath321 the subscripts , @xmath51 and @xmath226 , denote one of the three components of @xmath16 , @xmath17 and @xmath18 .",
    "the diagonal elements in the spherical coordinate are @xmath190 , @xmath322 and @xmath323 .",
    "the non - diagonal elements , @xmath324 , @xmath325 and @xmath326 , may be non - zero in 3d calculations , while they are zero under spherical symmetry .",
    "for the treatment with multi - energy group , we utilize the integrand of eqs .",
    "( [ eqn : energy ] ) and ( [ eqn : pressure ] ) with the angle average .",
    "we evaluate the eddington tensor for each energy zone by @xmath327 dropping off the common factor of the energy phase space .",
    "we describe briefly the size of memory and computational load necessary for the current simulations as well as larger simulations in future .",
    "the typical size of memory requirement for the numerical calculations in  [ 2dconfig ] and  [ 3dconfig ] is @xmath330 gb in the case of @xmath145 , @xmath199 and @xmath200 with @xmath147 , @xmath133 and @xmath101 .",
    "this includes the matrices for the equations and the vectors for the neutrino distributions for three species .",
    "we need @xmath3130 mb to store the neutrino distribution for each species .",
    "it takes @xmath3100 sec to proceed one time step on 1 node ( 32cpu ) of hitachi sr16000 .",
    "our largest calculations in the current report is the case of the diffusion of the 3d gaussian packet in  [ diffusion ] .",
    "it costs the memory of @xmath3900 gb on nec sx9 ( 8cpu ) for the case of a fine mesh .",
    "note that this specification of the computational speed is obtained within the basic optimization and the automatic parallelization .",
    "a parallel version of the numerical code for massive parallel architectures is ready for tests . in future",
    ", we would need the full coverage of the sphere with a high resolution by @xmath328 , @xmath329 and @xmath330 , for example , for spatial grid .",
    "the memory requirement would be @xmath36 tb for the program and @xmath326 gb for the neutrino distribution , which are available on the recent supercomputers .",
    "we plan to perform such large scale simulations after we optimize the numerical code with the parallelization ."
  ],
  "abstract_text": [
    "<S> we develop a numerical code to calculate the neutrino transfer with multi - energy and multi - angle in three dimensions ( 3d ) for the study of core - collapse supernovae . </S>",
    "<S> the numerical code solves the boltzmann equations for neutrino distributions by the discrete - ordinate ( s@xmath0 ) method with a fully implicit differencing for time advance . </S>",
    "<S> the boltzmann equations are formulated in the inertial frame with collision terms being evaluated to the zeroth order of @xmath1 . </S>",
    "<S> a basic set of neutrino reactions for three neutrino species is implemented together with a realistic equation of state of dense matter . </S>",
    "<S> the pair process is included approximately in order to keep the system linear . </S>",
    "<S> we present numerical results for a set of test problems to demonstrate the ability of the code . </S>",
    "<S> the numerical treatments of advection and collision terms are validated first in the diffusion and free streaming limits . </S>",
    "<S> then we compute steady neutrino distributions for a background extracted from a spherically symmetric , general relativistic simulation of 15m@xmath2 star and compare them with the results in the latter computation . </S>",
    "<S> we also demonstrate multi - d capabilities of the 3d code solving neutrino transfers for artificially deformed supernova cores in 2d and 3d . </S>",
    "<S> formal solutions along neutrino paths are utilized as exact solutions . </S>",
    "<S> we plan to apply this code to the 3d neutrino - radiation hydrodynamics simulations of supernovae . </S>",
    "<S> this is the first article in a series of reports on the development . </S>"
  ]
}