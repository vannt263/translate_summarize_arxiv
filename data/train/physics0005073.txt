{
  "article_text": [
    "the rapid computation of the transition rate _ by numerical simulation _ for an overdamped stochastic particle confined to a one - dimensional double - well potential ( fig .",
    "[ fig : potl ] ) is a deceptively simple problem , and of crucial importance to making progress in multi - dimensional systems .",
    "while straightforward unbiased simulation ultimately yields the rate to any desired precision ( e.g. , @xcite ) , it requires the simulator to endure many times the waiting period _ between _ the rare transition events ( fig .",
    "[ fig : time]a ) .",
    "such unbiased simulation , moreover , is utterly impracticable for larger systems  particularly biomolecules possessing thousands of atoms , for which simulating a waiting time of 1 millisecond could require tens or hundreds of centuries of computer time .",
    "the well - known analytic methods for rate computations in simple systems @xcite are also insufficient for high - dimensional , rough energy landscapes because many barriers and metastable states of unknown geometry intercede along multiple unknown pathways between the two states of interest ( see , e.g. , @xcite ) .    the inadequacy of both analytic methods and straightforward simulation for large biochemical systems points directly to the need for importance sampling and related methods . importance sampling techniques focus computational effort on transition events , typically generating an ensemble of transition trajectories from which to estimate rates and/or paths . yet despite the early successes and formal appeal of these methods , a quantitatively successful computational tool for large protein systems with @xmath2 atoms has not been achieved .",
    "we believe the apparently trivial bistable one - dimensional system must be completely understood _ in a simulation context _ before substantial progress can be expected for importance sampling in larger systems .",
    "the present paper is explicitly computational , or `` simulational '' : the sole objective is to develop efficient simulation methods for one - dimensional systems which are directly or indirectly applicable to large systems .",
    "we concern ourselves only with the `` dynamic importance sampling '' ( dims ) methods developed by woolf @xcite and zuckerman and woolf @xcite , which generate ensembles of fully independent transition trajectories . we hope and believe",
    "our results will be of practical use in other multi - dimensional methods , but such applications are beyond the scope of this work .",
    "rather , the `` bottom - line '' questions we attempt to answer are : ( i ) _ within the dims framework , what are the most efficient methods for rate computation ? _ ( ii ) _ using a well - defined measure , how efficient are these methods compared to unbiased simulation ? _ we will also discuss the maximum efficiency possible using dims and related methods in one - dimensional ( 1d ) problems , as well as attempting to extrapolate to larger systems .",
    "achieving efficiency for a 1d problem using dynamic importance sampling , as we will show , requires the appreciation of a variety of theoretical results  particularly relating to stochastic path integrals .",
    "the review by mortensen @xcite and gardiner s book @xcite give introductions to stochastic integrals  of which ito s and strantonovich s are the most basic types .",
    "historically , onsager and machlup first formulated a stochastic path integral to describe overdamped brownian dynamics @xcite . since then , uniqueness and other formal aspects of the onsager - machlup formulation have been discussed by a variety of workers ( e.g. , @xcite ) . indeed , formal properties of stochastic functional integrals also play an important role in the present investigation .",
    "these integrals have been used , for example , to address the question of the most likely crossing event ( see figs .  [",
    "fig : time]b , [ fig : cross_eb7 ] ) @xcite .",
    "related functional integral approaches directly address the smoluchowski ( overdamped fokker - planck ) equation for the evolution of the entire probability distribution @xcite .",
    "path integral formulations lead naturally to the notion of an average path , which is critical to the present discussion  even in one dimension . while the geometric pathway for barrier crossing is trivial in a one - dimensional potential like that of fig .",
    "[ fig : potl ] , the `` speed '' ( average displacement ) at every position constitutes another dimension of the average path  and a critical one to the present discussion .",
    "such 1d average paths ( average speeds and distributions ) were considered by dykman , mcclintock and coworkers @xcite and by luchinsky and mcclintock @xcite , both theoretically and experimentally .",
    "zuckerman and woolf @xcite considered average paths in higher dimensions , computationally , while the problem of finding optimal reaction paths in multi - dimensional systems has a long history ( e.g. , @xcite .",
    "the paper is organized as follows .",
    "we first review the basic formalism for overdamped langevin dynamics and importance sampling in section [ sec : back ] .",
    "section [ sec : mpp ] introduces pertinent path - integral results based on the onsager - machlup action , and reviews the so - called `` jacobian '' term in some detail , as well as presenting new numerical data .",
    "section [ sec : bias ] discusses a new method for producing an efficient , biased ensemble of trajectories , while section [ sec : results ] gives the actual results from the new biasing technique .",
    "section [ sec : multi ] addresses the relevance of our results to multidimensional problems .",
    "finally , conclusions and a summary of the results are given in section [ sec : sum ] .",
    "this section briefly reviews the fundamental stochastic dynamics equations and the dynamic importance - sampling formalism for rate computations .",
    "we consider solely stochastic dynamics governed by the overdamped langevin equation in the presence of gaussian white noise . in the notation of @xcite , such `` brownian dynamics '' are described by @xmath3 where @xmath4 is the configurational coordinate , @xmath5 is time , @xmath6 is the force , @xmath7 is the particle s `` mass '' , @xmath8 is the friction constant , and the noise @xmath9 is assumed gaussian with zero mean and variance given according to @xmath10 where @xmath11 is boltzmann s constant and @xmath12 the temperature .",
    "the equation ( [ brownian_eom ] ) is presumed to be simulated according to the `` ito - like '' ( euler ) discretization @xcite @xmath13 where the subscripts @xmath14 indicate quantities evaluated at time @xmath15 , so that @xmath16 , and @xmath17 is chosen from a gaussian distribution of zero mean and variance @xmath18 the discretization ( [ sim ] ) is considered to be ito - like because the force  assumed to be constant over the interval @xmath19  is evaluated at the beginning of the interval ; a loosely - termed `` stratonovich - like '' approach would instead consider , formally @xcite , @xmath20    we note that discretizations more sophisticated than the euler scheme ( [ sim ] ) are well known  i.e. , runge - kutta schemes of various orders @xcite .",
    "in explicit tests on _ rate calculations only _ for our simple system ( fig .",
    "[ fig : potl ] ) , the lowest - order runge - kutta ( heun ) method permitted only a marginally larger time step  without losing accuracy  which did not justify the additional computational expense .",
    "larger time steps tend to produce _ systematic _ errors , in addition to the easier - to - diagnose statistical error , regardless of the algorithm @xcite .",
    "rate calculations , moreover , may be especially sensitive .",
    "we also note that methods of higher - order than the heun algorithm are not of interest here , because computing higher - order derivatives is extremely costly for the larger biomolecular systems toward which the present research is ultimately oriented .",
    "thus , given our focus on rate computations and our interest in large systems , there seems little reason to employ anything more complicated than the euler procedure ( [ sim ] ) .",
    "it is useful to consider , in parallel to the dynamical algorithm , the equivalent probabilistic description of the dynamics ( [ sim ] ) .",
    "in particular , the explicit single - step transition probability density described above is given by @xmath21 ^ 2 / 2 \\sigma^2 \\right ] } \\ ; .\\ ] ] thus the probability density for a whole trajectory @xmath22 is given by the product of the single - step densities : @xmath23    importance sampling is effected @xcite by performing _ biased _ simulations which follow a prescription different from ( [ sim ] ) .",
    "naturally , trajectories generated from a biased simulation are distributed not according to @xmath24 , but according to some other function , @xmath25 .",
    "this alternative distribution can be used to compute probabilities and , hence , transition rates .",
    "one first requires the conditional probability @xmath26 to be in the final state ( `` b '' ) at time @xmath5 having started at @xmath27 at @xmath28 , which can be written in two equivalent ways for non - vanishing @xmath29 : @xmath30 where @xmath31 , and @xmath32 is an indicator function which is unity for @xmath4 in state b and zero otherwise . the approximation here is simply the neglect of the discretization error . in a biased simulation , the integral",
    "is estimated by @xmath33 where @xmath34 is a sampling ensemble of @xmath35 trajectories chosen according to @xmath29 , and where normalization , @xmath36 , is required .",
    "note that the function @xmath29 must be known for the simulation to be performed , just as ( [ trans_prob_density ] ) and ( [ qtilde ] ) are the distributions from which unbiased steps and trajectories are sampled .",
    "ultimately , rates are estimated by computing the slope of the linear regime in a probability vs. time plot , as discussed in sec .",
    "[ sec : bias ] .",
    "achieving efficiency for a 1d problem using dynamic importance sampling requires a variety of theoretical results for stochastic path integrals and their `` instantons . ''",
    "these approaches have been used , for example , to address the question of the most probable crossing event ( see figs .  [",
    "fig : time]b , [ fig : cross_eb7 ] ) , which can be derived in a straightforward way from the continuum onsager - machlup action used in the path integral formulation @xcite . in this section ,",
    "we discuss the onsager - machlup action and its optimization at somewhat greater length than is required for the computational aims of this paper .",
    "this is because , beyond the theoretical interest in the action and especially in the so - called `` jacobian '' term , some older literature deserves a fresh look and detailed discussion .",
    "the path - integral story begins with onsager and machlup @xcite and their well - known action for weighting continuum representations of overdamped brownian trajectories . in that formulation ,",
    "a _ continuous _",
    "trajectory  presumably intended to represent a smoothed stochastic trajectory  is weighted according to    @xmath37 } \\mbox { \\hspace{3em } where } \\\\",
    "\\label{action } s & = & \\mbox{$\\frac{1}{4}$ } \\int_{t_i}^{t_f } { { \\mathrm{d}}}t \\ ; { \\cal l}(t ) , \\mbox { \\hspace{3em } and } \\\\ \\label{som } { \\cal l}_{{{\\mathrm{om}}}}(t ; x , { \\dot{x } } ) & = & \\left [ { \\dot{x}}- \\frac { f(x ) } { m \\gamma } \\right]^2,\\end{aligned}\\ ] ]    and where @xmath38 and @xmath39 . in their original paper @xcite , onsager and machlup applied the euler - lagrange equation for functional minimization , @xmath40 to the case of a single harmonic well",
    ".    subsequent contributions amended the original onsager - machlup formulation of the action , ( [ action ] ) and ( [ som ] ) .",
    "first , stratonovich realized in 1962 @xcite that if one starts from the product of discrete - step probability densities ( [ qtilde ] ) and determines the continuum limit in a rigorous fashion , an additional term arises in the integral representation of the action ( [ action ] ) , so that instead of ( [ som ] ) , the effective lagrangian becomes @xmath41 this result was confirmed by bach",
    "in other words , the original description by onsager and machlup was incomplete for simulations performed according to the ito - like algorithm ( [ sim ] ) .",
    "note that this new term is proportional to the curvature of the potential and is dominant at a barrier top , for any non - zero noise amplitude ( @xmath42 ) .    in the mid 1970s graham",
    "@xcite re - derived the term as a jacobian resulting from changing variables from the fluctuation coordinate to the configuration coordinate  assuming a stratonovich - like discretization ( [ straton ] ) .",
    "thereafter , apparently , the term has been viewed as a jacobian , although the propriety of that name in a practical _ simulation _ context is questionable since , to the authors knowledge , only the ito discretization ( [ sim ] ) is usable precisely , and that results in a constant jacobian",
    ". more appropriate terminology might be `` stochastic correction term . ''",
    "both stratonovich and graham indicated , importantly , that the inclusion of the stochastic - correction/``jacobian '' term led to a path - integral representation of the probability distribution consistent with the overdamped fokker - planck ( smoluchowski ) equation .",
    "graham also derived the most probable crossing event associated with the corrected action using the euler - lagrange equation ( [ euler ] ) , namely @xcite , @xmath43 ^ 2    = \\left [ \\frac { f(x ) } { m\\gamma } \\right]^2       - \\frac{2 k_b t}{(m \\gamma)^2 } u''(x ) + c \\ ; , \\ ] ] where @xmath44 is a constant of integration .",
    "this result is called an `` instanton '' by field theorists ( e.g. , @xcite ) because it describes a rapid transition , as illustrated in fig .",
    "[ fig : time ] . to appreciate this , note that by taking either the positive or negative square root for @xmath45 in ( [ xcomj ] ) , the velocity of ascent is seen to be the same as for descent !",
    "yet this feature was apparently not appreciated until later ; see below .",
    "it will , however , prove central to our goal of obtaining efficiency in simulations .",
    "below , we also address the computational cost associated with computing a second derivative of the potential .",
    "it is worth noting that although the extremal path , formally , results when @xmath46 in ( [ xcomj ] ) [ from minimizing ( [ action ] ) with ( [ somj ] ) ] , one can not necessarily take the constant to be negative or even to vanish .",
    "observe that the left - hand side of ( [ xcomj ] ) must be positive .",
    "thus , in regions of relatively large positive curvature  such as near a well bottom  the second term of the right - hand side could exceed the first in magnitude , requiring @xmath47 . while this observation appears to be immaterial to our investigation of the simple bistable well ( see fig .",
    "[ fig : cross_eb7 ] ) , one could imagine the positivity of the constant having physical consequences in a more complicated potential with metastable intermediate states .",
    "other features of the most probable crossing have also proved of great interest .",
    "dykman and krivoglaz made important observations in their study of transitions in nonequilibrium systems using an uncorrected onsager - machlup functional integral , in 1979 @xcite . in a series of papers begun in 1989 and aimed primarily at systems with colored noise , bray , mckane and",
    "coworkers @xcite also provided some insights pertinent to the case of white noise _ without _ the correction term .",
    "( while the latter group included the jacobian term formally , it was omitted from their analysis of the low - temperature limit . )",
    "both groups derived essentially a special case of graham s result ( [ xcomj ] ) @xmath48 ^ 2 = \\left [ \\frac { f(x ) } { m\\gamma } \\right]^2 + c,\\ ] ] where @xmath44 is again a constant of integration which vanishes for the most probable case .",
    "it also is equivalent to graham s result at inflection points of the potential .",
    "bray , mckane and coworkers noted the crucial fact mentioned above : for systems with detailed balance ( i.e. , time - invariant potentials ) , the ascent described by @xmath49 is equally rapid as , and symmetric with , the descent ( see fig .  [",
    "fig : time]b ) .",
    "this point is also implicit in the work of dykman and krivoglaz .",
    "furthermore , both groups recognized that paradoxically the extremal trajectory ( @xmath50 ) _ never occurs _",
    "@xcite because an infinite amount of time is required to reach ( or descend from ) a parabolic barrier top !",
    "this may be seen by computing the barrier crossing time ,",
    "@xmath51    such apparently formal observations belie the fact that optimal paths have proven useful in a variety of recent studies .",
    "determined weighted _ distributions _ of paths ( including the optimal ) leading to large , non - transitioning fluctuations in a time - oscillatory potential @xcite .",
    "olender and elber @xcite discussed the onsager - machlup extremal barrier crossing , and employed a discrete version in developing an algorithm for steepest - descent path finding between known initial and final states .",
    "@xcite discussed extremal crossings in the context of rate calculations for fluctuating barriers .",
    "elber and shalloway suggested a temperature dependence for the integration constant of ( [ xcom ] ) to overcome the divergent - crossing time difficulty , and successfully distinguished optimal paths for different regimes of an effective temperature parameter @xcite .",
    "both in order to confirm the analytic results reviewed above and to gather data that could usefully inform our efforts to gain efficiency in rate computations , we studied numerically generated crossing events .",
    "we performed very long unbiased simulations of a particle moving according to ( [ sim ] ) in a one - dimensional bistable well ( fig .",
    "[ fig : potl ] ) and `` snipped out '' a large number of crossing events like the one shown in fig .",
    "[ fig : time]b . binning the observed step sizes of _ only _ the crossing events according to the @xmath4 position , fig .",
    "[ fig : cross_eb7 ] shows that the average step sizes @xmath52 closely follow the prediction ( [ xcomj ] ) which includes the stochastic correction term .",
    "the two theoretical predictions lacking the correction term  namely ( [ xcom ] ) with two values for @xmath44  appear far less adequate by contrast .",
    "we note that the binned distributions appear to be highly gaussian so that the average and most probable values essentially coincide .",
    "a comment on the data for @xmath53 in fig .",
    "[ fig : cross_eb7 ] is in order .",
    "the substantial turn - up of the data for @xmath54 is certainly an artifact of isolating crossing - events : by definition , the final step or steps are right - moving .",
    "thus , if one defines crossing events to end when the value @xmath55 is exceeded , rather than @xmath56 as in the figure , the turn - up occurs for correspondingly smaller @xmath4 values .",
    "interestingly , while the same argument applies to the left side of the figure , the data are not similarly affected .",
    "indeed , the asymmetry between the left and right edges of the plot is striking . while , at present , we can offer no convincing explanation , it is worth noting that the `` om+jacobian '' description becomes less than credible as @xmath4 increases beyond the right inflection point of the potential , @xmath57 .",
    "that description , ( [ xcomj ] ) with @xmath50 , suggests counter - intuitively that a particle which just completed a transition should fall more slowly than the drift velocity ( effectively given by `` om  no jacobian '' for @xmath58 in fig .",
    "[ fig : cross_eb7 ] ) .",
    "yet it is not clear to the present authors precisely why the applicability of the corrected om theory should be limited to the region between the inflection points ; intuitively , of course , the inflection points roughly mark the boundaries between the stable states and the barrier - top transition rate .",
    "the primary goal of the present work is to improve and quantify the level of efficiency in one - dimensional rate calculations . to that end",
    "we now introduce and evaluate a new biasing method , which is a variation on those discussed in our earlier work @xcite .",
    "the method combines two essential ingredients : biased crossing events which emulate the most probable path , together with a threshold at which the biasing is triggered .",
    "computing reaction rates by simulation requires the generation of an ensemble of appropriately weighted trajectories ( or a correspondingly long trajectory ) exhibiting many barrier - crossing events . while many sampling methods are capable of generating a suitable ensemble of trajectories in a long period of time , it is no easy task to rapidly generate a truly _ important _ ensemble  containing highly probable crossing events  even for an apparently trivial potential like a symmetric , one - dimensional double well .",
    "the reason is not hard to see . in an unbiased simulation ( [ sim ] ) , each step is chosen from a gaussian distribution centered at the deterministic step in the direction of the force . for",
    "_ crossing events _ which climb over a barrier , a trajectory necessarily takes steps in a direction _ opposing _ the force .",
    "as the center of the gaussian distribution is always downhill from the present step , the typical step in the _ ascent _ of a crossing event is in the `` tail '' of the gaussian distribution ( more or less so depending on the parameters entering into the width , @xmath59 ) .",
    "as the full probability for a crossing event is then a product of steps in the tail of the distribution , it seems clear that only small fluctuations about the most probable crossing event will occur .",
    "large fluctuations away from the most probable path will be exponentially damped out , as they require steps yet further out in the tail of the distribution .",
    "our interest in the most probable path for a crossing event , then , is hardly surprising : to generate an `` important '' ( albeit biased ) ensemble of trajectories , one must hew to the most probable path .",
    "this we shall do explicitly below , using the results quoted in sec .",
    "[ sec : mpp ] .",
    "but once one knows the most probable path for a single crossing event , the dims method still requires the generation of such events at appropriate intervals .",
    "that is , there is an ideal distribution of waiting times between events in a biased simulation ( cf .",
    "[ fig : time]a for the unbiased case ) .",
    "to see the reason why a distribution of wait times ( first passage times ) is required , consider fig .",
    "[ fig : evo ] , which demonstrates the rate calculation for biased _ and _ unbiased simulation .",
    "one first calculates the probability to arrive in the final state ( the right well in fig .",
    "[ fig : potl ] ) , having started in the initial state ( the left well ) , as a function of time .",
    "one then determines the slope of the linear regime . while an unbiased simulation of sufficient length will automatically generate data with roughly the same precision for all times shown along the horizontal axis in fig .",
    "[ fig : evo ] , a biased dims simulation must be designed to do so . as discussed in @xcite , one",
    "essentially has to evaluate a separate integral for each time point , so part of the goal is to spread the information gathered evenly over the necessary times .",
    "this is the motivation behind the `` thresholding '' detailed below .",
    "specifically , trajectories are generated according to the following algorithm .",
    "each trajectory is started from the minimum of the left well , @xmath60 , of the potential ( [ potl ] ) shown in fig .",
    "[ fig : potl ] , and run for a fixed total amount of time exceeding the transient time , @xmath61 .",
    "pre - defining a threshold value , @xmath62 , of the coordinate @xmath4 , we perform unbiased simulation while @xmath63 according to ( [ sim ] ) . if and",
    "when the threshold value is exceeded ( @xmath64 ) , we select steps according to @xmath65 with @xmath66 given by either the jacobian - augmented result ( [ xcomj ] ) or that without ( [ xcom ] ) , and with @xmath67 chosen from the same gaussian distribution as in the unbiased case . in other words , instead of using the deterministic step @xmath68 as in ( [ sim ] ) , we use the most probable step _ in a crossing event _ to emulate unbiased crossing events .",
    "the use of a threshold away from the well minimum ensures a sufficiently broad distribution of waiting times between the artificial crossing events , which in turn permits the acquisition of data for the range of times necessary to compute the rate as in fig .",
    "[ fig : evo ] .",
    "we note , however , that it is no more difficult to run a single long trajectory and compute correlation functions to determine rates ( e.g. , @xcite ) .",
    "if a heun scheme @xcite were used for the unbiased dynamics , the biased dynamics just given ( [ mpcsim ] ) could be readily modified in the same way the euler scheme itself ( [ sim ] ) is modified in the heun approach .",
    "given that the underlying continuum action should be the same for the two integration methods , a heun modification of ( [ mpcsim ] )  or even the unmodified version  should give similar results to those found here with the euler method .",
    "yet another refinement for the one - dimensional biasing techniques is possible , motivated by the time - dependent width of the gaussian noise , @xmath69 , required for the provably optimal computation of the probability _ density _ at a single point on a curvature - free potential surface @xcite .",
    "note that the biasing methods just described always used a constant width , @xmath70 given in ( [ natural_variance ] ) . in a spirit similar to wagner",
    "s approach described in @xcite , one can ask the question : `` what is the optimal sampling scheme to travel between two fixed points , with one intermediate step , on a surface with arbitrary curvature ? '' answering this question is not difficult and suggests that the local curvature influences the optimal width .    following wagner ( see @xcite ) , one needs to observe first that the optimal _ sampling density _ at time @xmath71 is exactly the distribution of _ unbiased _ two - step paths which begin at @xmath27 at @xmath28 and end at @xmath72 at @xmath73 .",
    "this constitutes the perfect _ sampling _ distribution because it is precisely that ( tiny ) subset of unbiased trajectories which end at the pre - defined value of interest , and which are distributed naturally .",
    "using the single - step gaussian distributions ( [ trans_prob_density ] ) , the two - step distribution is @xmath74 ^ 2                           + [ ( x_1 - x_0 ) - ( f_0/m\\gamma ) ] ^2                        } { 2 \\sigma^2 } \\right\\ } } \\ ; , \\ ] ] where @xmath59 still represents the unbiased value and @xmath75 again gives the force at @xmath76 . by rearranging the terms , completing the square and approximating @xmath77",
    ", one finds @xmath78 ^ 2                       } { 2 \\left[\\sigma/\\sqrt{2(1-\\alpha+\\alpha^2/2)}\\right]^2 } \\right\\ } } \\ ; , \\ ] ] where @xmath79 is a constant independent of @xmath80 in this approximation , and the dimensionless curvature is @xmath81 .",
    "the result ( [ curv - dist ] ) for the optimal distribution of @xmath80 values illustrates several interesting points .",
    "first , the distribution is independent of the force to first order in @xmath82 .",
    "second , while the correction to the expected mean of the distribution , @xmath83 , is second order in @xmath82 , that for the width , @xmath59 , is first order  noting that the factor @xmath84 is expected from the work of wagner and actually approaches unity for a large number of time steps @xcite .",
    "the optimal sampling width in fact _ decreases _ at the barrier top , where @xmath85 , in the small @xmath19 limit ( @xmath86 ) .",
    "thus , the distribution ( [ curv - dist ] ) motivates a further bias for sampling , namely use of the width @xmath87 for sampling from gaussian distributions near the point @xmath4 , where @xmath82 is to be computed using @xmath88 .",
    "we investigate this refinement in the next section .",
    "we demonstrate the capability of the dims algorithms of the previous section by quantifying their efficiency for rate computations in the simple bistable potential shown in fig .  [",
    "fig : potl ] , @xmath89 where @xmath90 is the barrier height and @xmath91 is the lengthscale of the problem .",
    "the central result is that one must account for the most probable crossing to gain maximum speed - up in rate computation as compared with unbiased simulation .",
    "not surprisingly , the efficiency increases with barrier height . yet even for the relatively low barrier height of @xmath92 ,",
    "we achieve roughly a 20-times efficiency improvement  i.e. , dims rate calculations are approximately 20 times as fast for a given level of precision .",
    "that factor increases to 300 for a @xmath1 barrier . while such gains will not be readily extendible to multi - dimensional systems , it is important to understand and demonstrate the ingredients necessary for optimal performance .    fig .  [",
    "fig : effic ] shows our results for the potential ( [ potl ] ) for two different barrier heights , @xmath93 and 9 .",
    "the biasing methods accounting for the most probable crossing are significantly superior for the larger barrier .",
    "the `` dims - wagner '' algorithm  which takes no account of the most probable path  refers to the technique described in ref .",
    "it performs only modestly well for the @xmath1 barrier , and its efficiency is very sensitive to the fixed simulation length .",
    "all the other dims procedures employed the algorithm of the previous section , ( [ mpcsim ] ) , above a threshold @xmath94 , with trajectories initiated at @xmath60 . the presence or absence of the `` jacobian '' ( stochastic correction term ) reflects whether ( [ xcomj ] ) or ( [ xcom ] ) was used to complete ( [ mpcsim ] ) , and `` curv '' indicates that the curvature - modified width ( [ sigma - samp ] ) was used in place of the unbiased width ( [ natural_variance ] ) .",
    "rates , @xmath95 , were calculated using the method noted in sec .",
    "[ sec : mot ] and fig .",
    "[ fig : evo ] .",
    "efficiency is computed by estimating the relative simulation lengths needed to obtain a desired degree of precision , given by the variance of the rate estimates , @xmath96 where @xmath97 is the number of simulations performed for each data point , @xmath98 is the rate computed for the @xmath99th simulation , and @xmath100 is the mean of the @xmath101 rate estimates .",
    "the horizontal arrow spanning the dims and unbiased results for @xmath102 at a precision of @xmath103 , for example , exceeds two decades  indicating that the dims computations are more than 100 times faster .",
    "the effectiveness of the dims formulation _ excluding _ the jacobian  i.e. , based on ( [ mpcsim ] ) and ( [ xcom ] ) with @xmath50  deserves further comment .",
    "while the jacobian - augmented dims simulation is slightly superior for @xmath102 , the insensitivity to including the correction term is surprising given the sharp contrast demonstrated in fig .",
    "[ fig : cross_eb7 ] .",
    "the lesson appears to be that , at least for the parameters studied , the motion in the immediate neighborhood of the barrier top ( where the correction term , proportional to the curvature , has greatest effect ) is less important to the anatomy of a crossing event than the ( rapid ) climb and descent . in the long term , the success of the uncorrected approach could facilitate the extension of dims to multi - dimensional systems , since that approach does not require computation of second derivatives of the potential .",
    "future work may show this to save a substantial amount of computer time .",
    "we note that our efficiency estimates have excluded the `` overhead '' cost of implementing the dims method .",
    "this cost depends on the optimization of one s code , and as it happens , our code is sub - optimal for _ _ un__biased simulation , so that there is no overhead at all .",
    "there are , however , inherent overhead costs in dims that can not be optimized away .",
    "while the dynamics employing the jacobian - augmented most probable path ( [ xcomj ] ) requires the computation of a second derivative at every step , our results show that the simpler form ( [ xcom ] ) is nearly as good and requires only the force . calculating the force ,",
    "it should be remembered , is not an overhead cost because this must be done in unbiased simulation ( [ sim ] ) anyway .",
    "the only notable cost inherent in the dims method , then , is computing the error associated with biased computation  in order to correct for it as discussed in refs .",
    "this correction entails computing the ratio of two gaussian terms ( or , equivalently , the difference of two logarithms ) at every step .",
    "compared with the fixed cost of unbiased simulation  computing the force and generating a high quality pseudo - random number at every step  and its inherent inefficiency with long waiting times , the dims costs are far overshadowed by the efficiency gains which here exceed one and two orders of magnitude .    for completeness",
    ", we give a number of further details , which apply to both the unbiased and dims results . a simulation consisted of @xmath104 trajectories ( see fig .",
    "[ fig : effic ] ) initiated at @xmath60 at time @xmath28 .",
    "the time steps were @xmath105 for @xmath92 ( having set @xmath106 ) and @xmath107 for @xmath102 .",
    "these were determined to be close to the maximum values for which the rate estimates did not change as @xmath19 increased in unbiased simulation .",
    "as discussed above , the rate is computed as the slope of the linear regime in a plot of the arrival probability ( to be in the right well , @xmath58 ) as a function of time ; see fig .",
    "[ fig : evo ] .",
    "the slopes ( rates , @xmath98 ) were computed from a least - squares fit to 10 data points , the @xmath5 values of which were held fixed for a given barrier height .",
    "the particle mass , @xmath7 , and the thermal energy , @xmath108 , were both set to 1 .",
    "note that fig .",
    "[ fig : cross_eb7 ] uses the parameters given in the caption .",
    "`` the system is so simple .",
    "how does one know whether a 300-time improvement in efficiency is impressive ? ''",
    "so a skeptic might wonder , and the attempt to answer seems a worthwhile exercise .",
    "the basic point is that computing a rate by simulation involves the simultaneous calculation of a series of difficult integrals of the form ( [ pbint ] ) discussed in sec .",
    "[ sec : back ] .",
    "each data point in fig .",
    "[ fig : evo ] is an estimate for such an integral .",
    "we can try to estimate the minimum number of trajectories needed for the rate computation by multiplying together estimates for the following : ( i ) the number of trajectories needed to estimate the probability _ density _ to be at a single location , @xmath4 , in state b at a given time , @xmath109 ; ( ii ) the number of discrete locations @xmath4 in state b required to estimate the probability for the whole state ; and , ( iii ) the number of independent time points needed to estimate a slope in the linear regime . regarding ( i ) , only in the case of a constant force can @xmath109 be computed exactly @xcite  equivalently , with a single trajectory .",
    "one might expect that at least 10 trajectories would be required for any real surface , setting ( i ) . in a similar manner for ( ii ) , at least 10 points should be required to characterize a state ( which , in principle , is known only numerically ) . the number of independent time points is a slightly more complex issue since some ( though not all ) trajectories from a given time point may also be used to estimate another .",
    "conservatively , then , we use the estimate three for ( iii ) . our estimate for the minimum number of trajectories required to calculate",
    "a rate is thus 300 .",
    "we believe our dims results of fig .  [",
    "fig : effic ] compare favorably with this heuristic  and conservative  theoretical minimum .",
    "while the results presented here for a one - dimensional potential seem a far cry from a high - dimensional biomolecular system , we believe they teach important lessons for the large system .",
    "the simplest point is that a biased trajectory must closely mimic the natural barrier - crossing dynamics if efficiency in rate computations is to be obtained .",
    "indeed , we have found that a poor bias can be worse than no bias at all .",
    "it is not enough to know  as one does automatically in one dimension  even the optimal geometric channel for a transition : the size of the steps along that geometric path are critical , as we have shown .",
    "although the problem of finding channels is extremely challenging in itself , let us ask `` how can one compute the rate for a large system assuming the channels are known ? '' a natural choice would be to start with an initial trajectory within each channel , and then attempt either to optimize it @xcite or to generate an ensemble of trajectories from it @xcite . given the importance of closely following the optimal course , it seems natural to use an optimization or sampling scheme which builds in the knowledge of the most probable path ( [ xcom ] ) and its multi - dimensional analog .",
    "the risks , otherwise , could be great : since a high - dimensional path will be very rough , it is easy to imagine a multi - step segment of a trajectory becoming trapped in a region of the potential surface with far too few or too many steps to be even close to optimal .",
    "one idea for overcoming this difficulty would be to use a scheme capable of removing and inserting time steps , in order to search for an appropriate distribution of steps along a pre - defined geometric path .",
    "we intend to pursue further investigations along these lines .    returning to the issue of finding multi - dimensional channels in the first place",
    ", we note that the dims method is ideally suited to attack this problem since it generates an ensemble of completely _ independent _ trajectories .",
    "indeed , we have already developed an algorithm which has proved capable of efficiently finding distinct , important channels in a multi - dimensional system @xcite .",
    "we have named the idea the `` soft - ratcheting algorithm , '' and we note that its efficiency is thus far limited to finding channels , rather than determining rates .",
    "the essence of the technique is simple : generate an unbiased step and accept it with a _ probability _ ( hence the `` softness '' ) depending on how far the trajectory has progressed toward the target state . to complete the calculation in the dims formulation ,",
    "one then estimates the overall acceptance probability  which is an inexpensive calculation in a large system .",
    "note that the soft - ratcheting algorithm requires no second derivatives of the potential .",
    "finally , a timescale problem could prove serious , even though we do not expect it to be nearly the handicap it is for molecular dynamics .",
    "in particular , a fundamental limitation of applying the dims method ( or a related approach ) to multi - dimensional problems is the barrier - crossing time , @xmath61 . in practical terms",
    ", @xmath61 shows up as the transient time prior to the linear regime in a plot used for rate evaluation ( fig .",
    "[ fig : evo ] ) .",
    "probability can not accrue , after all , until crossing events have occurred . in a large system , @xmath61 is the limiting timescale for applying a method like dims to computing rates .",
    "since a reasonable number , say @xmath104 , crossing events will be needed to estimate the rate , one would have to simulate for a time exceeding @xmath110 .",
    "the authors are unaware of any estimates of @xmath61 for biomolecular systems , but we note that  for the dims method to potentially yield a rate estimate  @xmath61 would have to be less than a nanosecond for a large , explicitly - solvated protein .",
    "recent work on large time steps @xcite holds promise , however , for attacking the timescale problem .",
    "we have demonstrated substantial increases in efficiency for simulation - based calculations of transition rates in bistable potentials with modest barrier heights , @xmath0 and @xmath1 , using new biasing methods within the dynamic importance sampling ( dims ) formulation @xcite .",
    "computations were sped up by a factor of approximately 300 for the @xmath1 barrier , and the primary results ( fig .",
    "[ fig : effic ] ) suggest the speed - up will increase significantly for larger barriers .",
    "the critical ingredient in our efficiency was close emulation of probable crossing events suggested by the onsager - machlup action , ( [ action ] ) and ( [ som ] ) .    the simple one - dimensional problem has been addressed from a variety of theoretical and numerical perspectives in an effort to pave the way for more difficult problems . in sec .",
    "[ sec : mpp ] we examined the stochastic correction  or `` jacobian ''  term ( [ somj ] ) in the onsager - machlup action from theoretical and numerical perspectives .",
    "there , we also discussed the desired distribution of waiting times between artificial crossing events , as well as the effect ( and utility ) of the curvature of the potential .",
    "after presenting the explicit results for efficiency levels in rate computations , we discussed the optimal efficiency one could hope to attain in principle .    in commenting on the extension of the dims method to large , high - dimensional systems in sec .",
    "[ sec : multi ] , we noted that the problem may be conceptually broken up into two parts : finding the geometric channels , and then sampling trajectories within those channels .",
    "the dims method is ideally suited for the first step , channel - finding , and we described an explicit algorithm effective in that capacity .",
    "our hope is that the results of the present paper will be useful in constructing techniques for the second stage , single - channel trajectory sampling .",
    "many people generously offered comments on early versions of the manuscript : ron elber , alan grossfield , christopher jarzynksi , rohit pappu , horia petrache , jonathan sachs , david shalloway , and katharina vollmayr - lee .",
    "the authors also thank david chandler for informative discussions , phillip geissler for pointing out ref .",
    "@xcite , and the referee for a number of informative comments , particularly regarding sec .",
    "[ sec : mpp ] .",
    "shlomo raz kindly provided additional computing facilities for this work .",
    "we gratefully acknowledge funding provided by the nih ( under grant gm54782 ) , the aha ( grant - in - aid ) , the bard foundation , and the department of physiology ."
  ],
  "abstract_text": [
    "<S> exploiting stochastic path integral theory , we obtain _ by simulation _ substantial gains in efficiency for the computation of reaction rates in one - dimensional , bistable , overdamped stochastic systems . </S>",
    "<S> using a well - defined measure of efficiency , we compare implementations of `` dynamic importance sampling '' ( dims ) methods to unbiased simulation . the best dims algorithms </S>",
    "<S> are shown to increase efficiency by factors of approximately 20 for a @xmath0 barrier height and 300 for @xmath1 , compared to unbiased simulation . </S>",
    "<S> the gains result from close emulation of natural ( unbiased ) , instanton - like crossing events with artificially decreased waiting times between events that are corrected for in rate calculations . </S>",
    "<S> the artificial crossing events are generated using the closed - form solution to the most probable crossing event described by the onsager - machlup action . while the best biasing methods require the second derivative of the potential ( resulting from the `` jacobian '' term in the action , which is discussed at length ) , algorithms employing solely the first derivative do nearly as well . </S>",
    "<S> we discuss the importance of one - dimensional models to larger systems , and suggest extensions to higher - dimensional systems . </S>"
  ]
}