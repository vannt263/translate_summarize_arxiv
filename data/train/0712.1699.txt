{
  "article_text": [
    "an important part of the application of the boundary element method ( bem ) to physical problems is the calculation of the field , from the solution on the boundary .",
    "this requires the evaluation of integrals which contain ` almost - singular ' integrands which are not properly handled by standard gaussian quadratures .",
    "for example , if we consider a two - dimensional potential problem , such as the laplace or helmholtz equations :    @xmath3    where @xmath4 is the wavenumber , the potential @xmath5 at some point in the field will be : @xmath6 where @xmath7 is the green s function for the problem , @xmath8 is the boundary of the domain with normal @xmath9 and variables of integration are indicated by subscript @xmath10 . in the case of the helmholtz equation , the singular behaviour of the green s function will be related to the green s function of the corresponding laplace equation  ( * ? ? ? * for example ) .",
    "the green s functions for the laplace equation will have a logarithmic singularity in the planar and axisymmetric case ( where the green s function is proportional to an elliptic integral ) and also in the case of an asymmetric problem in an axisymmetric domain  @xcite .    the green s function for the two - dimensional laplace equation is @xmath11 . if the boundary integral problem has been solved using the bem , the evaluation of the potential in the field gives rise , on each element , to an integral of the form : @xmath12 where @xmath13 is the local coordinate on the element , @xmath14 is a shape function , typically a polynomial , and @xmath15 and @xmath16 are the field point coordinates in the local coordinate system , figure  [ fig : bem : geometry ] .",
    "this integral is non - singular but suffers from an ` offstage singularity '  @xcite if the field point is near the element , so that the argument of the logarithm becomes small .    , @xmath17 .",
    "]    if it is required to determine the first or second derivatives of the potential , for example , to determine a velocity or velocity gradient in a fluid - dynamical problem , integrals of the form :    [ equ : int : deriv ] @xmath18^{1/2 } } +    l(t)g(x , y ,",
    "t)\\,{\\mathrm{d}}t,\\\\    \\label{equ : int:2 }    i^{(2)}(x , y ) & = \\int_{-1}^{1 } \\frac{l(t)}{(x - t)^{2}+y^{2 } } +    l(t)h(x , y , t)\\,{\\mathrm{d}}t ,    \\end{aligned}\\ ] ]    arise . by analogy with the case",
    "when @xmath2 , we refer to these integrals as ` near - singular ' and ` near - hypersingular ' respectively .",
    "when @xmath2 , the field point lies on the boundary and the integrals must be treated as cauchy principal values  @xcite or as a hadamard finite - part  @xcite . in this case , a number of procedures exist for the accurate evaluation of the integrals  ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* for example )    a recently - developed method  @xcite develops quadrature rules which can be used as ` plug - in ' replacements for standard gaussian quadratures in cases where the integrand contains singularities of the form of equations  ( [ equ : int ] ) and  ( [ equ : int : deriv ] )",
    ". an important feature of these rules is that they require no analysis of the integrand before use .",
    "when the potential is differentiated , yielding equation  ( [ equ : int:1 ] ) , the function @xmath19 will usually contain logarithmic singularities which must be properly accounted for , as well as the leading singularity .",
    "in many problems , the green s function will be complicated and the explicit identification of the singularities will be time - consuming .",
    "it is preferable to have a quadrature rule which correctly integrates all of the singularities present without requiring a detailed analysis .",
    "the previously published method  @xcite , generates such rules for singular and hypersingular integrals .",
    "this paper extends this method to ` near - singular ' and ` near - hypersingular ' integrals , giving a simple , easily implemented technique producing quadrature rules which are direct replacements for gaussian quadrature in bem codes .",
    "before developing the quadrature rules needed for near - singular integrals , it is worth examining the reason for the breakdown of standard gaussian quadrature . this will also give an indication of when specialized rules should not be used and standard quadratures are better .",
    "consider the integral : @xmath20^{1/2}}\\,{\\mathrm{d}}t,\\\\    & = \\frac{1}{r}\\int_{-1}^{1 } \\frac{1}{((t / r)^{2}-2t\\cos\\theta / r +      1)^{1/2 } } \\,{\\mathrm{d}}t,\\nonumber\\end{aligned}\\ ] ] where @xmath21 and @xmath22 .",
    "this can be expanded using the generating function for legendre polynomials  @xcite : @xmath23 to yield :    [ equ : expansion ] @xmath24^{1/2 } } & =      \\sum_{k=0}^{\\infty } \\frac{t^{k}}{r^{k+1}}p_{k}(\\cos\\theta),\\quad t < r\\\\      \\label{equ : expansion:2 }      & = \\sum_{k=0}^{\\infty }      \\frac{r^{k}}{t^{k+1}}p_{k}(\\cos\\theta),\\quad t > r .",
    "\\end{aligned}\\ ] ]    an @xmath25-point gaussian quadrature rule integrates exactly polynomials up to order @xmath26 .",
    "when @xmath27 , the integrand is well approximated by equation  ( [ equ : expansion:1 ] ) and the estimate of @xmath28 returned by gauss - legendre quadrature : @xmath29 will be accurate . if , however , @xmath30 , part of the integrand will be given by the inverse power series of equation  ( [ equ : expansion:2 ] ) which can not be correctly integrated by the standard gaussian quadrature . likewise , even if @xmath31 but is not large enough to make the terms of equation  ( [ equ : expansion:1 ] ) decay fast enough , there will be a large error in the estimate of @xmath28 . looking ahead to the results presented in  [ sec : tests ] , it is expected that standard gauss - legendre quadrature will give good results for large @xmath32 and/or in cases where @xmath33 is small .",
    "otherwise , a specialized rule will be necessary .",
    "the algorithm to be developed gives an @xmath25-point rule which integrates a function of the form : @xmath34^{1/2 } } +     c(x , y ,",
    "t)\\log[(x - t)^{2}+y^{2}]^{1/2 } + d(x , y , t),\\ ] ] where @xmath35 , @xmath36 , @xmath37 and @xmath38 are taken to be polynomials of order up to @xmath39 and the integral @xmath40 where @xmath41 are the quadrature points of an @xmath25-point gauss - legendre quadrature and the weights @xmath42 are to be determined .",
    "a previously - developed algorithm  @xcite for the computation of quadrature rules gives a method for the evaluation of @xmath42 when @xmath2 .",
    "the approach is conceptually simple  the weights are found as the solution to the system of equations : @xmath43w_{j } = m_{i},\\quad i=1,\\dots,4m,\\ ] ] where @xmath44 are the weighted legendre polynomials at the quadrature points @xmath45 : @xmath46^{1/2 } & m+1 \\leq i \\leq 2m,\\\\        p_{i-2m-1}(t_{j})/[(x - t_{j})^{2}+y^{2}]^{1/2 } & 2m+1 \\leq i \\leq 3m,\\\\        p_{i-3m-1}(t_{j})[(x - t_{j})^{2}+y^{2 } ] & 3m+1 \\leq i \\leq 4 m .",
    "\\end{array }    \\right.\\ ] ] and the moments @xmath47 are the integrals of @xmath48 @xmath49^{1/2}\\,{\\mathrm{d}}t        & m+1 \\leq i \\leq 2m,\\\\        \\int_{-1}^{1 } p_{i-2m-1}(t)/[(x - t)^{2}+y^{2}]^{1/2}\\,{\\mathrm{d}}t & 2m+1        \\leq i \\leq 3m,\\\\        \\int_{-1}^{1 } p_{i-3m-1}(t)[(x - t)^{2}+y^{2}]\\,{\\mathrm{d}}t & 3m+1 \\leq i \\leq 4 m .",
    "\\end{array }    \\right.\\ ] ] the system of equations is solved using the appropriate lapack solver  @xcite , in the least squares sense when @xmath50 and in the minimum norm sense when @xmath51 .",
    "the only issue which must be clarified is the evaluation of the moments , @xmath47 . in the case",
    "when @xmath2 , the integrals are true cauchy principal values or hadamard finite parts and there exist formulae for their evaluation in terms of associated legendre functions  @xcite or simple finite part integrals combined with exact gaussian quadratures  @xcite . in this case , however , such simple formulae are not available and a different approach is required .      the method outlined in  [ sec : rules ] for the evaluation of the quadrature weights @xmath42 requires the evaluation of the moments @xmath47 where @xmath52 where weighting function @xmath53 will be one of @xmath54^{1/2}$ ] or @xmath55^{-n/2}$ ] , @xmath56 or 2 .",
    "a general method can be applied to finding the integrals of weighted legendre polynomials , using basic functional relations and simple formulae for the integrals of elementary functions , readily found in standard references  @xcite .    assuming that integrals of the form @xmath57 can be evaluated ( the formulae required for this paper are given in the appendix ) , the expansion of powers of @xmath13 in terms of legendre polynomials  @xcite :    [ equ : legendre ] @xmath58    can be used to show that :    [ equ : legendre : int ] @xmath59    then",
    ", given the integrals @xmath60 , @xmath61 , the corresponding integrals of the weighted legendre polynomials , @xmath47 , can be evaluated via : @xmath62 and @xmath63 the evaluation can be carried out in place , with values of @xmath47 overwriting @xmath60 . in double precision , the procedure gives accurate results for @xmath64 before overflow errors cause problems . for bem applications , where the shape functions are typically of order no greater than  3 , this causes no special difficulties , but would limit use of the method in other areas .",
    "obviously , for any application other than straight elements with @xmath11 , a rule with @xmath65 will be needed , but it is unlikely that @xmath39 will need to be greater than  32 .",
    "to summarize , the procedure for computing a quadrature rule with @xmath25 points which can integrate functions of the form of equation  ( [ equ : quad : func2 ] ) where @xmath35 , @xmath36 , @xmath37 and @xmath38 are polynomials of order up to @xmath39 is as follows :    1 .   find the quadrature points @xmath41 for an @xmath25-point gaussian quadrature , using , for example , the method of davis and rabinowitz  @xcite ; 2 .",
    "evaluate the weighted legendre polynomials @xmath44 at each of the quadrature points ; 3 .",
    "compute the moments @xmath47 using the method of  [ sec : method : integrals ] ; 4 .   solve @xmath66w_{j}=m_{i}$ ] using an appropriate solver .",
    "the integral of @xmath1 is then approximated by : @xmath67",
    "the quadrature method developed in  [ sec : method ] is tested by applying it to the evaluation of a reference integral . before carrying out these tests ,",
    "it is of some interest to examine the behaviour of the quadrature weights @xmath42 with respect to the field point position .",
    "figure  [ fig : deviation ] shows the root mean square difference @xmath68 between the rule of this paper with @xmath69 , @xmath70 and a standard  64-point gaussian quadrature , with @xmath71^{1/2},\\ ] ] where @xmath72 are the weights of the standard rule .    , @xmath70 .",
    "]    the difference between the rules is shown as a function of @xmath32 and @xmath73 .",
    "it is clear that close to the element ( @xmath32 and/or @xmath73 small ) , the weights of the new quadrature are very large , as they have to cancel the large value of the integrand close to the near - singularity .",
    "further from the element , however , the integrand is better approximated by a polynomial and the weights come closer to those of the standard rule .",
    "the test of accuracy is to examine how well the new quadrature rule evaluates a reference integral .",
    "table  [ tab : error:2 ] shows the error in computing : @xmath74 for three values of @xmath32 over the range @xmath75 .",
    "the case of @xmath76 was ignored because for odd @xmath9 , @xmath77 which would not allow for a meaningful estimate of relative error which is defined : @xmath78^{1/2},\\ ] ] where @xmath79 is the value of @xmath28 estimated by numerical quadrature .",
    "tables  [ tab : error:2 ] and  [ tab : error:3 ] show the error @xmath80 , incurred using the method of this paper , compared to @xmath81 , the error using standard gauss - legendre quadrature , using low and high order rules .",
    "the calculation is carried out at three values of @xmath32 to examine the change in error with distance from the element and for various values of @xmath9 .",
    "table  [ tab : error:2 ] shows the error for @xmath82 , the important range for boundary element calculations , and a rule with @xmath83 and @xmath84 . from the first two columns of errors ,",
    "it is clear that the modified rule is far superior to the standard quadrature : its error is about twelve orders of magnitude lower than that of the gaussian quadrature .",
    "similarly , for @xmath85 , the mean error is much smaller , being no worse than about @xmath86 , rather than @xmath87 .",
    "once the field point is far from the element , however , at @xmath88 , both rules have similar accuracy .",
    ".root - mean - square error in reference integral computed with modified ( @xmath80 ) and standard ( @xmath81 ) quadratures at three values of @xmath32 , @xmath83 , @xmath84 .",
    "[ cols= \" < , < , < , < , < , < , < \" , ]     to examine the error behaviour in more detail , figures  [ fig : error : log:164][fig : error:2:164 ] show the relative error in computing : @xmath89^{1/2},\\\\    i_{0}^{(1)}(x , y ) & = \\int_{-1}^{1 } [ ( x - t)^{2}+y^{2}]^{-1/2},\\\\    i_{0}^{(2)}(x , y ) & = \\int_{-1}^{1 } [ ( x - t)^{2}+y^{2}]^{-1},\\end{aligned}\\ ] ] with error @xmath90 defined as : @xmath91 where @xmath92 is one of @xmath93 , @xmath94 , @xmath95 and @xmath96 is the corresponding estimate using the quadrature rule . in each case ,",
    "@xmath83 and @xmath84 and a sixteen point gaussian quadrature was also applied for comparison . in each case , for large distances from the element , @xmath88 , both quadrature techniques are accurate , with errors of the order of machine precision . when @xmath97 , however , the error incurred using gaussian quadrature is unacceptably large , while the modified rule gives very accurate answers , again of the order of machine precision . as might be expected ,",
    "the error from the gaussian quadrature is smaller as @xmath98 , due to the greater distance from the element , but it is never better than about @xmath99 , insufficient accuracy for most applications .    , @xmath84 .",
    "]    , @xmath84 . ]    , @xmath84 . ]",
    "finally , figure  [ fig : error:2:6416 ] illustrates an interesting point about the error behaviour of the quadrature rule as the number of quadrature points is increased .",
    "it shows the error in the near - hypersingular integral @xmath100 evaluated using a rule with @xmath69 and @xmath70 , with the error from a 64-point gaussian quadrature shown for comparison .",
    "the first point is that the gaussian quadrature is able to cope with the singularity for @xmath97 when @xmath101 , because it can integrate polynomials of high enough order to be able to correctly handle the expansion of the integrand in legendre polynomials .",
    "also , as in the previous cases , it can correctly evaluate the integral for @xmath88 .    the modified rule , however , has slightly worse error behaviour than for @xmath102 , with the maximum error being higher for @xmath97 and the error at @xmath88 being greater across the full range of @xmath73 .",
    "the error is still small , being less than @xmath86 , but the reason for the increase is unclear .",
    "it appears to be due to an ambiguity in expressing the integrand in terms of legendre polynomials : the near - hypersingular part of the integrand @xmath103 $ ] is a ratio of two polynomials which can be written as a sum of a proper elementary function and a polynomial .",
    "this polynomial term is then represented twice in the quadrature rule , being handled by the unweighted legendre polynomials , @xmath47 , @xmath104 in equation  ( [ equ : moments ] ) and by the weighted polynomials .",
    "an interesting question for future developments of the technique will be how best to choose the elementary functions for the quadrature rule to give optimal accuracy for a given @xmath25 .    , @xmath70 .",
    "a method of deriving quadrature rules for the evaluation of the ` near - singular ' integrals which arise in the boundary element method has been derived .",
    "the performance of the technique has been assessed by evaluation of reference integrals and it has been found that it outperforms standard gaussian quadrature rules with the same number of nodes for field points close to the element .",
    "the error in the integral increases slightly with the number of points in the rule , a point which is to be investigated in future work .",
    "to evaluate the required integrals of legendre polynomials using the procedure of  [ sec : method : integrals ] , we require a method of evaluating the integrals :                e.  anderson , z.  bai , c.  bischof , s.  blackford , j.  demmel , j.  dongarra , j.  du  croz , a.  greenbaum , s.  hammarling , a.  mckenney , and d.  sorensen . .",
    "society for industrial and applied mathematics , philadelphia , pa , third edition , 1999 ."
  ],
  "abstract_text": [
    "<S> a method of deriving quadrature rules has been developed which gives nodes and weights for a gaussian - type rule which integrates functions of the form : @xmath0^{1/2 } } +     c(x , y , t)\\log[(x - t)^{2}+y^{2}]^{1/2 } + d(x , y , t),\\ ] ] without having to explicitly analyze the singularities of @xmath1 or separate it into its components . </S>",
    "<S> the method extends previous work on a similar technique for the evaluation of cauchy principal value or hadamard finite part integrals , in the case when @xmath2 . </S>",
    "<S> the method is tested by evaluating standard reference integrals and its error is found to be comparable to machine precision in the best case . </S>"
  ]
}