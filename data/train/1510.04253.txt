{
  "article_text": [
    "the formation of stars is strongly connected to the molecular phase of the interstellar medium ( ism ; e.g. , @xcite , @xcite ) .",
    "since the molecular phase is naturally clumpy on different scales ( @xcite ) , it has become customary to divide the emission into isolated , independent entities named giant molecular clouds , a practice which began with the earliest surveys ( e.g. , @xcite ) .",
    "the first studies of the gmcs in the galaxy defined the standard paradigm of these objects , utilized also today to define new surveys of nearby galaxies . from the seminal paper of @xcite ,",
    "gmcs possess a h@xmath1 mass between @xmath2m@xmath3 , a mean h@xmath1 density of 300@xmath4 and an average size of 40pc . from the number density of the gmcs in the galactic ring",
    ", the authors also calculated that the galaxy should contain @xmath5 gmcs encompassing @xmath6 of the galactic molecular gas budget .",
    "later , more comprehensive studies of the gmcs ( e.g. @xcite ; @xcite ) , defined scaling relations between their properties that laid the foundations for a better understanding of the physics of the molecular ism . in particular , gmcs appear gravitationally bound , with a roughly constant mass surface density , and with supersonic velocity dispersions proportional to the square root of their sizes .",
    "multi - tracer observations have shown that the structure of the gmcs is essentially hierarchical : small scale dense clumps are always contained in larger , lower density gas envelopes ( see , e.g. @xcite , and references therein ) . taken together , these evidences suggest that gmcs are sustained against global collapse by turbulent motions ( e.g. , @xcite ) that might partially explain the low level of star formation efficiency observed in the galaxies ( e.g. @xcite ) .",
    "gmcs are generally identified by contouring images above a certain column density , or flux levels when line emission data cubes are used . from observations , therefore , clouds are a set of connected pixels ( either 2d or 3d ) above a certain threshold level .",
    "these operations were done by eye in earlier studies ( e.g. @xcite ) .",
    "however , the use of _ position - position - velocity _ ( ppv ) data cubes complicated the recognition of gmcs by eye . therefore several automatic algorithms have been developed , able to handle the third dimension , as well as large datasets with different levels of blending between structures .",
    "those algorithms are based either on iteratively fitting and subtracting a model to the molecular emission ( as ` gaussclumps ` , @xcite ; @xcite ) or on the `` friends - of - friends '' paradigm that connects pixels according to their neighbors and values , without assuming a particular shape for the objects to decompose ( as ` clumpfind ` , @xcite or ` cprops ` , @xcite ) .",
    "recently , gravity - based alternatives have also been proposed ( ` dendrograms ` , @xcite ; ` g - virial ` , @xcite ) . these latter approaches",
    "all assign individual pixels in a data cube to belong to single objects and gmc identification is thus a _ segmentation _ problem in the language of image processing . despite attempts to account for resolution and sensitivity biases ( @xcite ) , almost all algorithms for the cloud identification suffer from the influence of the survey design ( e.g. , @xcite ; @xcite ) . depending on the complexity of the molecular environment ,",
    "algorithms provide different results ( @xcite ) and sometimes misleading ones ( schneider & brooks 2004 ) .",
    "in particular , low resolution causes the blending of emission from unrelated clouds ( as in m51 , @xcite ) ; and high resolution makes segmentation algorithms identify cloud substructures as individual clouds . in a clumpy medium ,",
    "the friends - of - friends approach will naturally find objects with the scale of a few resolution elements .",
    "the situation is further complicated in velocity - crowded regions like the milky way .    in this paper",
    ", we consider the problem of gmc segmentation in the context of the more general theory of _",
    "cluster analysis_. _ clustering _ is an unsupervised ( no need for a training dataset ) classification of patterns that groups sets of data in such a way that data in the same group ( called a `` cluster '' ) are more similar to each other than to the data in other groups ( `` clusters '' ) .",
    "similarly , the process of finding gmcs in an image or in a data cube can be viewed as grouping pixels considered as part of a single entity as separated from others that are part of different entities .",
    "the concept of data clustering was originally introduced in anthropology by @xcite .",
    "clustering is now used by many disciplines to manage large quantities of data ( data mining ) or to reduce the data to learn information and make predictions ( machine learning ; for a general review about clustering , see @xcite ) .",
    "viewing gmc segmentation as a clustering problem allows us to create an algorithm able to overcome many of the limitations noted above ( in particular the over - division of the co emission caused by high resolution ) and to generate physically - oriented cloud catalogs .",
    "many clustering algorithms are based on graph theory ( e.g. , @xcite ) . in section  [ s : dendro ]",
    "we show how graph representations of star - forming complexes are naturally provided by dendrograms .",
    "dendrograms give a very detailed view of the global hierarchical structure within a molecular line data cube , but by themselves can not be used to identify clouds .",
    "nevertheless , graph abstraction furnishes a direct way to use the dendrogram for gmc segmentation .",
    "we will introduce in section  [ s : dendro ] the graph theory basis for the problem and the algorithm chosen for the cluster analysis : _ spectral clustering _",
    "( section  [ ss : spclust ] ) . in section",
    "[ s : scimes ] , we outline our method , ` scimes ` ( spectral clustering for interstellar molecular emission segmentation ) and the specific criteria that we use to extract discrete objects from the dendrograms of emission . in section  [",
    "s : test ] , we show how the different segmentation criteria influence the final cloud decomposition using data from the orion - monoceros region .",
    "we demonstrate the stability of the method with respect to changing dendrogram parameters , noise realizations and dataset resolution . in section  [ s : algo_comp ] , we compare our method with other cloud decomposition algorithms , and we show how different segmentations produce different cloud properties in term of scaling relations and mass spectra . we examine how a cloud decomposition together with the knowledge of the hierarchical structure of the clouds might improve our understanding about the dynamical state of the clouds in the orion - monoceros complex ( section  [ s : scal_rel ] ) . finally we discuss the novel aspects and possibilities offered by the algorithm in section  [ s : disc ] .",
    "we summarize the paper content and results in section  [ s : summary ] .",
    "a dendrogram is a tree diagram that represents the hierarchy of structures within some data .",
    "a dendrogram is composed of two types of structures : branches , which are structures that split into multiple sub - structures , and leaves , which are structures that have no sub - structure .",
    "branches can split up into branches and leaves , which allows hierarchical structures to be adequately represented .",
    "the term trunk is used to refer to a structure that has no parent structure .",
    "dendrograms provide a precise representation of the topology of star - forming complexes . to use dendrograms to identify clouds , we need to interpret the dendrogram in the framework of graph theory and cluster analysis .",
    "in this paper we use the dendrogram implementation defined in rosolowsky et al .",
    "( 2008 , hereafter : r08 ) that generalized the original concept of @xcite to three dimensional data cubes including standard molecular line techniques to characterize the structures defined by the dendrogram itself . here",
    "we give a brief description of the dendrogram technique that constitutes the core of the method we developed .    in astronomy",
    ", we define the _ dendrogram _ or _ structure tree _ as a `` stick man '' abstraction of the hierarchical structure of molecular gas ( see figure  [ f : dendro_graph ] ; figure  [ f : dendro_weight ] panels _ a _ , and _",
    "b _ ; and figure  [ f : orion_dendro ] ) .",
    "it represents how the three dimensional contours ( or isosurfaces at given emission levels ) in a position - position - velocity molecular line data cube nest inside each other .    following the terminology of @xcite , a dendrogram",
    "is composed of _ leaves _ and _ branches_. leaves represent three - dimensional contours that contain a single local maximum and define the top of the dendrogram . to suppress structure created by noise fluctuations , maxima",
    "are identified from all volumetric pixels in a data cube that have values larger than all of their neighbors over a box @xmath7 , where @xmath8 and @xmath9 are set to some significant numbers of spatial and spectral resolution elements , respectively . the total number of identified local maxima is subsequently decimated to account for the effects of the noise , as follows .",
    "a local maximum is eliminated if the isosurface that contains it has a volume lower than a certain number of pixels ( @xmath10 ) and/or if its peak is lower than a certain brightness temperature difference , @xmath11 , above the contour level where the local maximum merges with another local maximum . in this case , the emission profile that contains both local maxima is considered as a single object .",
    "pairs of isosurfaces join at specific contour levels named _",
    "merge _ levels . a vertical line in the dendrogram that connects two leaves",
    "is called a `` branch '' .",
    "the length of the branches represents the range of contour levels where the properties of the emission do not change significantly according to the connectivity criterion used ( see r08 for more details ) . the implementation by r08 forces the dendrogram technique to generate only binary mergers , i.e. defined by the joining of two single objects .",
    "eventually all branches and leaves in the dendrogram merge at a minimum temperature level to form the _ trunk _ of the structure tree .",
    "the minimum temperature level is generally fixed to @xmath12 times the noise fluctuation level ( @xmath13 ) .",
    "although dendrograms are effective abstractions of the hierarchical structure of molecular emission , they can not be used , by themselves , to identify molecular clouds .",
    "_ the main goal of this work is to provide a robust , mathematically - based method that finds the optimal cuts of a structure tree based solely on the properties of the data . _",
    "the partitioned structure tree then defines discrete objects , if they exist , within data . to do so",
    ", we will study dendrograms in the broader framework of graph theory , on which a large number of image analysis methods and clustering techniques rely .",
    "we first introduce some basics of graph theory .",
    "a graph is a mathematical entity defined as an ordered pair @xmath14 consisting of a set @xmath15 of `` vertices '' or `` nodes '' and a set @xmath16 of `` edges '' , which are 2-element subsets of @xmath17 ( i.e. , a single edge connects two vertices ) .",
    "practically , vertices represent the group of objects we wish to cluster and edges represent the connections , links or the relations between those objects ( figure  [ f : dendro_graph]_b _ ) .",
    "dendrograms can be viewed as graphs by associating the leaves ( local maxima ) as the vertices whose edge is the largest - level isosurface containing both the leaves . in the dendrogram ,",
    "the highest branch where two leaves join is mapped to a graph edge . considering a pair of vertices @xmath18",
    ", dendrograms can be further described as _ weighted _ graphs , where each edge has an associated non - negative value @xmath19 , i.e. , the connections between the objects have different `` strength '' .",
    "there are many possible choices for an edge weight , but in our application we use a weight given by the inverse of the merge level isosurface properties ( we will clarify this aspect in section  [ ss : spclust ] ) .",
    "a graph of a dendrogram for a single object is also _ fully _ or _ strongly connected _ where an edge exists between each pair of vertices , that is every vertex is connected to every other vertex in the graph or @xmath20 always .",
    "thus , every pair of leaves is associated with a structure at a certain hierarchical level ( see figure  [ f : dendro_graph ] ) .",
    "we consider the structures ( leaves and branches ) arising from the very bottom of the dendrogram all connected through an artificial `` super - structure '' that includes all of them : the trunk .",
    "the isosurface associated with the trunk is given by the union of all the isosurfaces associated to the structures arising from the trunk .",
    "finally , dendrogram graphs are also _ undirected _ , i.e. the relations between vertices are symmetric ( @xmath21 ) . in our application",
    ", we choose a symmetric weighting scheme since there is no apparent reason to consider a pair of leaves not connected on a one - to - one basis .",
    "dendrogram graphs are also _ simple _ , without self - loops ( @xmath22 ) since we are interested only in the relations between pairs of leaves .",
    "having recast the dendrogram as a graph , we can identify objects within the dendrogram using one of the large class of graph - based clustering techniques . among these , _ spectral clustering _ works well on fully connected , weighted , undirected , and simple graphs such as those derived from the dendrogram .",
    "spectral clustering uses the eigenvectors of a matrix that parametrizes the relationship strengths ( `` similarity '' ) between the graph nodes to conduct dimensionality reduction before performing a standard clustering in fewer dimensions .",
    "the clustering finds the optimal cut of the graph based upon the desired number of clusters ( @xmath23 ) , which must be provided as an input .",
    "+ the general algorithm of spectral clustering can be summarized in the following points ( e.g. @xcite ) : + ` input ` : a _ similarity matrix _",
    "@xmath24 such that @xmath25 is the similarity between the @xmath26th and the @xmath27th vertex , and @xmath23 is the number of clusters to generate . for the gmc segmentation problem",
    ", we describe how to construct @xmath24 and choose @xmath23 in sections",
    "[ ss : scimes_gmcaff ] and [ ss : scimes_sigma ] , respectively .    1 .",
    "construct the _ degree matrix _ @xmath28 and the _ graph laplacian _",
    "@xmath29 ( section [ sss : spclust_simmat ] , see also figure  [ f : spclust]b ) .",
    "2 .   compute the _",
    "spectral embedding _ , i.e. calculate the first @xmath23 larger eigenvalue eigenvectors @xmath30 of @xmath29 ( section [ sss : spclust_embed ] , see also figure  [ f : spclust]c ) .",
    "3 .   construct the matrix @xmath31 made by the @xmath23 eigenvectors @xmath30 as columns ( section [ sss : spclust_embed ] , see also figure  [ f : spclust]c ) .",
    "4 .   let @xmath32 be points in @xmath33 where @xmath34 , corresponding to the @xmath35th row of @xmath36 ( section [ sss : spclust_embed ] ) .",
    "5 .   cluster the points @xmath37 in @xmath33 with the _ k - means _",
    "algorithm into clusters @xmath38 ( section [ sss : spclust_kmeans ] , and figure  [ f : spclust]d ) .    ` output ` : clusters @xmath39 , which are sets of vertices in the original space such that @xmath40 if @xmath41 .",
    "+ popular variations of this algorithm can be found in @xcite and @xcite . in the following",
    "we will explain each step the spectral clustering algorithm , occasionally sacrificing the mathematical formalism in favor of intuition .",
    "the strength of the relation present between two nodes of the graph can be seen as the _ similarity _ that exists between them . in the most general sense",
    "this concept can also be related to the notion of distance : higher `` similarities '' between two objects imply that the `` distance '' between them is shorter . in graph theory , a similarity between a pair of vertices is quantified by the weight of the edge that connects the vertices .",
    "all the similarity between each pair of nodes in the graph can be collected in a _",
    "similarity matrix _ that further abstracts the graph and constitutes the main input of spectral clustering algorithms ( see figure  [ f : dendro_weight]c and figure  [ f : orion_affmats ] ) .",
    "the _ similarity matrix _ ( also called _ affinity _ or _ adjacency _ matrix ) , therefore , parametrizes the quantitative assessment of the relative similarity of each pair of vertices in the graph . for convenience we introduce the shorthand notation @xmath42 for the set of indexes @xmath43 , where @xmath44 represents the affinity matrix we are dealing with and @xmath12 is the number of objects or graph vertices .",
    "the affinity matrix provides a natural representations of the graph ; therefore in the case of a dendrogram - derived graph , @xmath24 is square ( @xmath45 ) , symmetric ( @xmath46 ) , with null main diagonal ( @xmath47 ; graph simplicity requirement ) and positive semidefinite ( graph strong connectivity requirement ) . since the graph represents the local neighborhood relationships , the affinity matrix itself should reflect the local neighborhoods .    to accomplish this",
    ", the affinity matrix is usually rescaled using a _ kernel _ function .",
    "a gaussian kernel is commonly used :    @xmath48    where the parameter @xmath49 controls the size of the neighborhoods and must be carefully chosen that produce more restrictive rescaling of the affinity matrix . ] . identifying an appropriate affinity matrix represents the most challenging task of the spectral clustering technique .",
    "affinity matrices can be potentially constructed using almost any property that can be seen as similarity or distance .",
    "the choice of similarity criterion together with the choice of @xmath49 influence the quality of the clustering partition we obtain . as an heuristic",
    ", good affinity matrices appear `` block diagonal '' ( after applying appropriate row / column permutations ) where the values on the boundary of each block is similar .",
    "most of spectral clustering - based algorithms make use of a different `` form '' of the affinity matrix called graph laplacian ( _ ( i)_-paragraph of the spectral clustering general algorithm in section [ ss : spclust ] ) , since its properties are more suitable for the spectral embedding .",
    "the unnormalized form of the graph laplacian @xmath29 is defined as @xmath50 , where @xmath28 , called _ degree matrix _ , is a diagonal matrix that contains the degrees @xmath51 of the vertices @xmath52 on the main diagonal .",
    "the degree of a vertex @xmath52 is defined as :    @xmath53    often , the `` symmetric normalized '' form of the laplacian is used : @xmath54 ( e.g. , @xcite ) , since it produces more general eigenvalue , better related to other graph invariants , and with a direct connection to spectral geometry and in stochastic processes ( @xcite ) .",
    "the graph laplacian fully represents the algebraic properties of the graph .",
    "the utility of the graph laplacian can be understood by considering a simpler type of graph that is unweighted and weakly connected ( i.e. , there are disconnected parts of the graph ) .",
    "the similarity matrix is then binary where @xmath55 if there is an edge between @xmath56 and @xmath57 and @xmath58 otherwise .",
    "then , @xmath59 is just the number of nodes connected to @xmath56 .",
    "the laplacian then has the degree along the diagonal and @xmath60 indicating a connection between @xmath56 and @xmath57 . in this view , the graph laplacian is the discrete version of the continuous laplacian operator @xmath61 ( i.e. the multi - variable second - derivative ) , operating on the graph .",
    "denser nodes are equivalent to `` bumps '' in the second derivative of a continuous function .",
    "several spectral features of the graph laplacian are very useful to quickly assess the global properties of the graph it represents .",
    "for example , the number of 0-valued eigenvalues of @xmath29 corresponds to the number of graph s connected components ( i.e. groups of nodes or `` clusters '' ) .",
    "indeed , each connected component forms a `` block '' in the laplacian matrix ( after appropriate permutations ) , therefore , the nodes of these components only have edges within themselves .",
    "each of these groups can be represented by a fully connected graph and their graph laplacian has only a single eigenvalue equal to 0 .",
    "since the graph laplacian is also positive - semidefinite , the second smallest eigenvalue is greater than zero .",
    "this eigenvalue is the _ algebraic connectivity _ of the graph and quantifies how well the graph is connected .",
    "the main utility of the spectral clustering is to map the data represented as a graph to a different vector space where the cluster properties of the data ( if they exist ) are enhanced .",
    "this is accomplished thanks to the properties of the graph laplacian through the _ spectral embedding _ ( second and third points of the spectral clustering general algorithm in section [ ss : spclust ] ) that changes the representation of the data points to points @xmath62 .",
    "the elements of first @xmath23 eigenvectors provide a lower - dimensional description of the block diagonal structure of the laplacian ( or the similarity matrix ) and of the @xmath23 connected components of the graph .",
    "a graphical description of this concept is reported in figure [ f : spclust ] .",
    "the data to cluster are mapped through the spectral embedding into @xmath32 points of @xmath33 . in this",
    "new `` clustering '' space , abstract description of similarity between vertices are translated into euclidean distance .",
    "the data in this space are easily clustered with common clustering algorithms such as _ k_-means that find groups where the intra - cluster distance is maximized while the inter - cluster similarity is minimized , given the desired number of clusters @xmath23 .",
    "the _ k_-means algorithm ( @xcite ) is the most popular algorithm for clustering given its conceptually simple idea and its fast convergence speed .",
    "the algorithm works in @xmath63 randomly or using some heuristic information ( @xcite ) by selecting @xmath23 `` means '' or `` centroids '' of the data to cluster , where the number of clusters @xmath23 is provided as input ( see section  [ sss : spclust_clnum ] for details by @xcite that optimizes the initial seeding of the random centers . ] ) .",
    "generally , @xmath64 , where @xmath12 is the number of objects to cluster , in this case the graph vertices or the dendrogram leaves .",
    "the @xmath23 clusters are then generated by associating every observation with the nearest mean .",
    "the centroids of each clusters are subsequently used as new `` means '' .",
    "the last two steps are iterated until convergence .",
    "the convergence is reached once the current centroids are at the same positions of the previous ones .",
    "the choice of the _ k_-means algorithm for identifying clusters is not fundamental .",
    "if the similarity function is appropriate for clustering the data , any cluster algorithm can be implied to obtain the final product .",
    "a common problem for several clustering algorithms is to select the number of clusters @xmath23 to be generated , which must be provided as an input . given this number , the algorithms proceed to find the best arrangement of the data within @xmath23 groups .",
    "various methods have been proposed to estimate @xmath23 ranging from theoretical approaches ( @xcite ) , to gap statistics ( @xcite ) , and stability approaches . for spectral clustering , the number of clusters can be guessed by analyzing the eigenvalues and the properties of the eigenvectors themselves ( e.g. @xcite ) .",
    "other methods aim to assess the quality of the clustering using measurements of the ratio of within - cluster and between - cluster similarities .",
    "an example of such a measure is the _ silhouette _ ( @xcite ) .",
    "the silhouette coefficient is defined as :    @xmath65    where @xmath66 represents the average similarity between the object @xmath26 and all other elements in the same cluster , @xmath67 is the average similarity between @xmath26 and all other elements in the next nearest cluster and @xmath68 .",
    "therefore the silhouette directly relates with the general definition of `` clustering '' ( see section [ s : intro ] ) : in particular , @xmath69 for dense ( high intra - cluster similarity ) and well separated clusters ( low inter - cluster similarity ) , @xmath70 for incorrect clustering and @xmath71 for overlapping clusters since it uses a hard assignment method : an object can not belong to two different clusters . ] .",
    "the average @xmath72 over all data of all clusters is a measure of how well the data have been partitioned and how appropriately @xmath23 has been chosen .",
    "the average silhouette is not a monotonic function of @xmath23 so the best number of clusters @xmath23 is determined by maximizing the silhouette .",
    "having introduced the mathematical framework needed to convert dendrograms into graphs and to optimally cut these graphs through spectral clustering , we now present our algorithm , ` scimes ` , to identify significant objects within the structure tree of molecular emission . `",
    "scimes ` uses the dendrogram as input produces different properties ( as effective radius , velocity dispersion , flux etc . )",
    "associated with the structures within the dendrogram .",
    "we observed that the _ luminosities _ of the emission within the isosurfaces and _ volumes _ of the isosurfaces are good criteria to define the similarity matrices at the top hierarchy between each pair of leaves ( section  [ sss : scimes_fluxvol ] ) .",
    "the affinity matrices are rescaled using a kernel through an appropriate choice of @xmath49 ( section  [ ss : scimes_sigma ] ) .",
    "the rescaled similarity matrices can be aggregated to obtain a cluster configuration that depends on all chosen affinity criteria .",
    "then an approximate number of clusters , @xmath73 , is estimated through a direct analysis of the final affinity matrix ( section  [ sss : scimes_mataggr ] ) .",
    "the degree matrix and laplacian are automatically defined as described in section  [ sss : spclust_simmat ] .",
    "nevertheless , the best number of clusters @xmath74 is ultimately defined through the silhouette ( see section  [ sss : spclust_clnum ] ) , running the spectral clustering algorithm several times , such that @xmath75 .",
    "finally , the clusters that do not correspond to single branches in the dendrogram are pruned and the remaining clusters are labeled to obtain the gmcs ( section  [ ss : scimes_rem ] ) .",
    "+ the dendrogram and the catalog of the structures within it ( ` scimes ` inputs ) are defined from a molecular line data cube using the python distribution ` astrodendro ` ( http://www.dendrograms.org/ ) .",
    "this dendrogram implementation package requires setting three input parameters : ` min_value ` below which any value is not considered in the dendrogram construction ( usually set to several times the sensitivity level of the dataset @xmath76 ) ; ` min_delta ` indicating how significant a leaf must be to be considered independent ( again set equal to several times the observation sensitivity ) ; ` min_pix ` , the minimum number of pixels needed for a leaf to be independent ( generally equal to the several times the observation beam ) .",
    "we use the spectral clustering and silhouette implementations by ` scikit - learn ` ( http://scikit-learn.org/stable/modules/clustering ) . in the following sections , we describe the different steps of the algorithm , connecting back to the formalisms summarized in section  [ s : dendro ] .",
    "defining good similarity criteria is the most important step of the clustering process , since the algorithm finds the optimal graph cuts based solely on the `` features '' of the similarity matrix , the secondary input of the spectral clustering algorithm , is also automatically guessed by scimes from the similarity matrix . ] and does not provide , at priori , any metric to understand the quality of the final clusters .    by default",
    "` scimes ` constructs the affinity matrices used for the clustering based on the `` volume '' and/or `` luminosity '' of the structures identified by the dendrogram . in the following , we describe the definition of these measurements and how to generate their associated similarity matrices .",
    "we define the edges of the dendrogram - derived graph from the properties of the largest - valued isosurfaces containing pairs of local maxima ( the vertices ; see also section [ ss : dendro_graph ] ) .",
    "those isosurfaces contain molecular emission , and the properties of that emission are used to weight the edges of the graph .",
    "to calculate these properties , the dendrogram implementation by r08 assumes the moment method @xcite . in this view , the @xmath26th pixel in a data cube can be identified with a brightness temperature @xmath77 , positions @xmath78 , @xmath32 , @xmath52 and sizes @xmath79 , @xmath80 , @xmath81 for the two spatial dimensions and the velocity dimension , respectively .",
    "therefore , the _ flux _ of the region corresponds to the zeroth moment , or the sum of all emission within the isosurface :    @xmath82    the flux can be converted into luminosity assuming a physical distance @xmath83 ( in parsecs ) to the target , yielding @xmath84 , the first clustering criterion used by our code .",
    "an isosurface has several morphological properties . to evaluate these properties ,",
    "the major axis of the spatial projected structure is first located using the principal component analysis .",
    "the spatial axes are rotated such that the major axis of the region is aligned with the @xmath85 axis , while the minor axis with the @xmath86 axis .",
    "the root - mean - squared ( rms ) sizes of the region are estimated from the intensity - weighted second moments along the two spatial dimensions :    @xmath87    where the sum runs over all pixels within the isosurface . combining the two measurements ,",
    "the rms size is then :    @xmath88    the radius of the spherical cloud can be related to @xmath89 through @xmath90 where @xmath91 ( @xcite , @xcite ) .",
    "the velocity dispersion is calculated as : @xmath92 we use as second similarity criterion the _ volume _ of the isosurface in ppv space : @xmath93    luminosity and volume have been chosen as the default clustering criteria for ` scimes ` for several reasons .",
    "first , those criteria are directly related to the basic physical descriptors of the molecular emission structures ( morphology , velocity , and emissivity ) and allow us to consider the structure neighborhood in both spatial and spectral directions , and in terms of co emission differences .",
    "second , luminosity and volume are monotonic and discontinuous properties of the isosurface related to the dendrogram .",
    "those values increase monotonically against a decrease in the dendrogram hierarchy level and produce large `` jumps '' in the affinity when two objects with similar volume of luminosity merge at a certain level ( figure  [ f : orion_affmats ] ) . by construction , the dendrogram is a monotonic structure , so the number of isolated isosurfaces should increase with the hierarchical level and it is easily recast into affinity matrices through the luminosity and the volume of its structures .",
    "those features of luminosity and volume criteria give well - behaved block diagonal similarity matrices that are preferred when working with spectral clustering ( see next section ) .",
    "the scaling parameter of the rescaling kernel ( described in section  [ sss : spclust_simmat ] ) can be directly calculated from those kind of matrices ; the number of clusters is easily guessed and , in general , corresponds to the number of blocks ( section  [ ss : scimes_sigma ] ) .",
    "` scimes ` accepts as input any kind of user - defined affinity matrix .",
    "nevertheless , the code might not behave as expected when non - monotonic and strictly continuous criteria are used . in this aspect",
    ", volume and luminosity can be associated to the number of volumetric pixel within a certain isosurface , and to the sum of the values of them , respectively . however , those properties are largely continuous functions of the dendrogram hierarchy level .",
    "this makes the estimation of scaling parameter and initial number of clusters difficult , providing unwanted mergers between the structures .",
    "luminosity and volume criteria are general , since they embody , by definition , distance information .",
    "however , for several applications , especially involving data of the galaxy , distances are rarely known .",
    "this entails some changes in the cloud segmentation provided by ` scimes ` .",
    "we discuss this issue in appendix  [ a : nodist ] .     to determine the best number of clusters @xmath74 , for selected values of @xmath49 .",
    "the behavior of the average silhouette is quite similar for both volume and luminosity criteria , although the profile for the luminosity criterion presents some ambiguities . nevertheless , the dependency on the value of @xmath49 is not as strong as expected .",
    "the values of @xmath49 chosen using the _ similarity histogram _ ( see section  [ ss : scimes_sigma ] and figure  [ f : orion_amshisto ] for details ) are indicated in the bottom left corner of each panel .",
    "the values are in pc@xmath94kms@xmath95 for the volume criteria ( upper panel ) and kkms@xmath95pc@xmath94 for the luminosity criteria ( lower panel ) .",
    "the profile of the chosen scaling parameters for the segmentation of the orion - monoceros dataset is indicated with gray thick lines .",
    "the insets at the top right corners of the plots show zoomed versions of the average silhouette profile around the peak.,title=\"fig:\",scaledwidth=50.0% ]   to determine the best number of clusters @xmath74 , for selected values of @xmath49 .",
    "the behavior of the average silhouette is quite similar for both volume and luminosity criteria , although the profile for the luminosity criterion presents some ambiguities . nevertheless , the dependency on the value of @xmath49 is not as strong as expected .",
    "the values of @xmath49 chosen using the _ similarity histogram _",
    "( see section  [ ss : scimes_sigma ] and figure  [ f : orion_amshisto ] for details ) are indicated in the bottom left corner of each panel .",
    "the values are in pc@xmath94kms@xmath95 for the volume criteria ( upper panel ) and kkms@xmath95pc@xmath94 for the luminosity criteria ( lower panel ) .",
    "the profile of the chosen scaling parameters for the segmentation of the orion - monoceros dataset is indicated with gray thick lines .",
    "the insets at the top right corners of the plots show zoomed versions of the average silhouette profile around the peak.,title=\"fig:\",scaledwidth=50.0% ]      having identified the similarity criteria we found useful to partition the molecular line emission , here we explain how to construct the related similarity matrices .",
    "we already showed that dendrograms can be seen as fully connected , simple , undirected and weighted graphs in section [ ss : dendro_graph ] .",
    "the weight of the edges is determined by the properties of the highest hierarchical level in term of brightness temperature at which a pair of leaves ( graph vertices ) `` join '' ( see figure [ f : dendro_graph ] ) .",
    "each merging level corresponds to molecular emission bounded by an isosurface . along the branches",
    "the properties do not change much and are continuous functions of the contour level . however where two branches merge , the properties change suddenly since the merged object contains more emission ( see figure [ f : dendro_weight ] ) .",
    "in general , higher hierarchical levels correspond to smaller isosurfaces and vice versa .",
    "therefore the weight of the edges will be equivalent to the inverse of the properties of the molecular emission embedded by the isosurface at that particular hierarchical level .",
    "considering two graph vertices labeled as @xmath96 ( i.e. , a pair of leaves in the dendrogram ) , we define the weight of the edge between them as    @xmath97    where @xmath98 indicates a property of the emission bounded by the highest - level isosurface containing the vertices . for the similarity criteria we established @xmath98 as either @xmath99 or @xmath100 .",
    "+      once all matrices have been rescaled using the kernel with the appropriate @xmath49 ( see section  [ ss : scimes_sigma ] for details ) , the matrices can be also _ aggregate _ into a single similarity matrix that embodies all the similarity criteria .",
    "this process follows the idea of @xcite for image segmentation .",
    "they construct two similarity matrices for their problem ( color image segmentation ) . after the rescaling the two matrices",
    "are multiplied element - wise . in the same way",
    ", we multiply our ( volume and luminosity ) kernel - rescaled similarity matrices element by element .",
    "the volume , luminosity , and/or the unique aggregate similarity matrices constitute the main input for the spectral clustering algorithm .",
    "indicates the number of affinities with a specific value .",
    "the values of @xmath49 used for the average silhouette test in figure  [ f : orion_siltest ] and section  [ ss : scimes_sigma ] correspond to the average value between the different modes in the histograms .",
    "the chosen scaling parameters for the segmentation of the orion - monoceros dataset are indicated with red lines.,title=\"fig:\",scaledwidth=50.0% ]      as for the choice of the right affinity criteria , selecting an optimal scaling parameter @xmath49 is essential because it might significantly affect the number of the clusters identified and the quality of the clustering .",
    "indeed , the scaling parameter determines how rapidly the similarity @xmath98 falls off with the distance between leaves @xmath26 and @xmath27 .",
    "given the assumed rescaling kernel ( section [ sss : spclust_simmat ] ) , a large @xmath49 merges the clusters resulting in an undesirable clustering ; but a too - small @xmath49 generates a weak similarity matrix where only the affinities of directly neighboring leaves are high .",
    "the graph theory literature does not provide firm criteria to select good scaling parameters .",
    "@xcite suggest that the right @xmath49 can be determined by evaluating the tightness of the clusters on the surface of a sphere .",
    "this criterion deals with the quality of the clustering , therefore the `` tightness '' of the clusters on the surface of a sphere can be determined , similar to how the number of clusters @xmath23 is set using the _ silhouette _ method ( section  [ sss : spclust_clnum ] ) . to test this method , we ran the spectral clustering algorithm on the orion - monoceros dataset ( see section  [ s : test ] ) several times with different values of scaling parameters ( figure  [ f : orion_amshisto ] ) ; and for all possible number of clustering configurations , i.e. @xmath101 , where @xmath12 is the number of leaves .",
    "the best clustering configuration is given by @xmath102 $ ] .",
    "figure  [ f : orion_siltest ] shows the results of the test .",
    "the average silhouette for both criteria presents a similar behavior .",
    "nevertheless , the index has a clear peak for the volume criteria at @xmath103 , while there is some ambiguity regarding the luminosity criteria , since the average silhouette profile presents two peaks at @xmath104 and @xmath105 . while selecting @xmath105 for the luminosity criterion",
    "produces a clustering configuration similar to the volume criterion , the choice @xmath104 merges orion a , ngc2149 and monoceros into a single object . surprisingly we note that the value of the silhouette , in general is not highly influenced by the selection of @xmath49 , but varies significantly according to the selected similarity criteria .",
    "although the above choices of similarity might be one of the most reliable criteria to constrain both @xmath49 and @xmath23 , it is not free from ambiguities .",
    "moreover , running the spectral clustering for all possible clustering configurations and for a quite large number of scaling parameter is computationally expensive .",
    "nevertheless , there is a natural way to efficiently select @xmath49 that might be of great interest in the segmentation of gmcs . from a similarity matrix",
    "we can build a _",
    "similarity histogram_. if the data form clusters , the histogram for their similarities will be multi - modal ( figure  [ f : orion_amshisto ] ) .",
    "in this view , the first mode corresponds to the average intra - cluster similarity , while the others to similarities between - clusters ( @xcite ) . by choosing the scaling parameter between the first two modes , the similarity values for the leaves forming clusters or single clouds ,",
    "are expected to be enhanced compared to the others .",
    "we note that this choice produces regular block diagonal matrices .",
    "therefore , a good choice of @xmath49 that does not underestimate or overestimate the size of the clusters is between the first and the second mode . for the algorithm",
    ", we use their median value .",
    "physically the scaling parameter picked in this way might indicate the characteristic maximal values of volume or luminosity that the clouds tend to exhibit .",
    "the criteria chosen to cluster the dendrogram are monotonic and produce very regular block diagonal matrices . having rescaled the affinity matrices with an educated guess of @xmath49 , the blocks that might be related to the final clusters stand out ( see figure  [ f : orion_affmats ] , lower row ) and the other affinity fall below 0.2 . ` scimes ` automatically counts the equal - size squares along the main diagonal after flagging all affinity @xmath106 and producing the starting value of the cluster number @xmath73 .",
    "this operation is conceptually similar to the counting of the connected components of the laplacian matrix through the fielder vector ( @xcite ) .",
    "the fielder vector is the first eigenvector of the laplacian matrix and , given the properties of the laplacian ( see section  [ sss : spclust_simmat ] ) , the zeroth elements of it represents the graph connected components if the graph is not fully connected .",
    "this method is more general than the one adopted by ` scimes ` .",
    "however , we observed that , for the chosen criteria , the simple counting of blocks gives @xmath73 closer to the best cluster number defined by the silhouette .     for details ) .",
    "the contours use the same color scheme as figure  [ f : orion_dendro ] and encompass isosurfaces corresponding to the clustered dendrogram branches of that figure.,title=\"fig:\",scaledwidth=40.0% ]   for details ) .",
    "the contours use the same color scheme as figure  [ f : orion_dendro ] and encompass isosurfaces corresponding to the clustered dendrogram branches of that figure.,title=\"fig:\",scaledwidth=40.0% ]   for details ) .",
    "the contours use the same color scheme as figure  [ f : orion_dendro ] and encompass isosurfaces corresponding to the clustered dendrogram branches of that figure.,title=\"fig:\",scaledwidth=40.0% ]      the most appropriate number of clusters , @xmath73 , is guessed using the similarity matrix histogram ( section [ ss : scimes_sigma ] , see also figure  [ f : orion_amshisto ] ) .",
    "then , the code runs for several values around @xmath73 and the @xmath23 value corresponding to the highest average silhouette is selected as the best number of clusters @xmath107 ( section [ sss : spclust_clnum ] ) .",
    "spectral clustering , by definition , groups all objects into different clusters .",
    "leaves that do not form isolate clusters , are grouped all together in sparse clusters without any neighbors in ppv space between constituent objects .",
    "these leaves are located and eliminated from the clustering labels .",
    "the final clouds are branches that contain only leaves in a single cluster .",
    "these clouds are , therefore , structures already considered by the original dendrogram algorithm and constitute the relevant objects embedded within the dendrogram .",
    "the application of the kernel , with a specific scaling parameter , to the similarity matrix enhances the similarity of pair of leaves above critical values for @xmath108 and @xmath109 and drastically reduces the others .",
    "accordingly the selected clouds would tend to present similar properties in terms of luminosity and volume .",
    "this implies that the clouds are found at different hierarchical level but with similar characteristic properties .",
    "in this section , we apply ` scimes ` to the orion - monoceros complex .",
    "this system is one of the most studied star formation regions in the galaxy with a well established set of clouds with a molecular mass @xmath110m@xmath3 ( @xcite , table 2 ) .",
    "it represents , therefore , an ideal testbed for the capabilities of the algorithm .",
    "the orion - monoceros complex dataset we use in our tests has been presented by ( * ? ? ?",
    "* figure  [ f : orion_cont ] ) .",
    "the @xmath0co(1 - 0 ) data were obtained with the 1.2 m millimeter wave telescope at the harvard - smithsonian center for astrophysics and present a spatial resolution of @xmath111 arcminutes corresponding to @xmath112pc at the average distance to the complex ( @xmath113pc ) .",
    "the field - of - view spans a region of @xmath114 or @xmath115pc@xmath116pc .",
    "the data cube has a velocity resolution of 0.65kms@xmath95 , over a @xmath117 range between @xmath118 to 19.5kms@xmath95 .",
    "however , most of the complex molecular emission is concentrated between 2 and 15kms@xmath95 .",
    "the data have a roughly uniform sensitivity of @xmath119k .",
    "+        figure  [ f : orion_dendro ] shows the dendrogram of the dataset obtained with typical parameter values ( ` min_delta`@xmath120 , ` min_npix`@xmath121 pixels ) .",
    "the ` min_value ` has been set to zero , since the datacube has been previously masked using the _ dilate mask _ approach ( @xcite ) .",
    "the technique works by masking pixels in two consecutive velocity channels in which the signal is above @xmath122 .",
    "these regions are then extended to include all adjacent pixels in which the signal is above @xmath123 .",
    "the rms noise @xmath76 of the gaussian distribution is estimated from the outlier - robust median absolute deviation ( mad ) of each spectrum . in this way",
    ", we retain most of the significant emission within the data cube , even when the noise is not spatially homogeneous .",
    "a catalog of each dendrogram structure has been generated using the ` astrodendro ` package ` ppv_catalog ` method , which measures moment - based properties at a set of levels in the dendrogram .",
    "further , the similarity matrices of figure  [ f : orion_affmats ] ( see section  [ sss : spclust_simmat ] ) have been obtained using the criteria in section  [ sss : scimes_fluxvol ] . to convert in physical units we use the distances of (",
    "* their table 2 ) .",
    "` scimes ` identified the scaling parameter @xmath124pc@xmath125kms@xmath95 and @xmath126kkms@xmath95pc@xmath125 for volume and luminosity criteria , respectively that have been used to rescale the matrices through the kernel . in order to make a comparison of different measurements",
    ", we ran ` scimes ` on the volume , luminosity , and aggregate criteria separately .",
    "the similarity matrices relative to these criteria are shown in the last row of figure  [ f : orion_affmats ] .",
    "direct analysis of the similarity matrices predicted cluster numbers @xmath127 for the volume , luminosity and aggregate criteria respectively .",
    "silhouette values equal to @xmath128 , however , identifies more appropriate cluster numbers @xmath129 . according to the criteria in section  [ ss : scimes_rem ] , three clusters have been removed from the volume - based segmentation , however no clusters have been removed from the luminosity and aggregate criteria - based segmentations .",
    "the final dendrogram decompositions are shown in figure  [ f : orion_dendro ] , while the corresponding maps of the objects identified by ` scimes ` , using the same color scheme of the dendrograms , in figure  [ f : orion_cont ] . +",
    "we immediately note that the canonical clouds of the orion - monoceros complex ( i.e. orion a - red contour , orion b - green contour , the northen filament - blue contour , monoceros - magenta contour , the crossbones - yellow contour , ngc2149 - cyan contour , the scissor - purple contour ) are always faithfully recognized by the algorithm as single entities providing segmentation close to a `` by - eye '' work .",
    "other smaller objects are included only if they encompass at least two leaves .      figures  [ f : orion_cont ] show the different orion - monoceros complex segmentations provided by volume , luminosity and aggregate criteria applied separately . in general , all notable clouds in the complex are retained regardless of which similarity criterion we use .",
    "a few additional , smaller objects are missed by the luminosity- and aggregate - based decompositions . by looking at the rescaled matrices in figure  [ f : orion_affmats ] ,",
    "the clouds of the complex appear as well - defined square sub - matrices within the main for the volume criterion .",
    "this matrix is therefore the dominant one once we aggregate the two basic criteria .",
    "indeed the silhouette value provided by the volume clustering configuration is very high ( 0.97 ) and higher than the values obtained using the other criteria ( 0.86 and 0.94 for luminosity and aggregate criteria respectively ) .",
    "therefore , for the following tests and analysis we will only consider the segmentation provided by the volume criterion .      to test the algorithm stability in the presence of noise and its ability to provide reliable results down to the noise level , we add beam - correlated noise to the orion - monoceros datacube .",
    "we analyze the properties of the notable clouds imposing the typical parameters ( see section  [ ss : test_oriondata ] ) and ` min_value ` @xmath130k for the generation of the dendrogram .",
    "we generate 10 datacubes with random noise realizations .",
    "we use ` scimes ` with the default settings and we perform the decomposition based on the volume matrix only . for all noise - added cubes ,",
    "the volume matrix shows scaling parameters that are quite stable : @xmath131pc@xmath94kms@xmath95 .",
    "table  [ t : noisereal ] reports the results of the test as mean value and standard deviation of the cloud properties measured for the different cubes .",
    "generally , ` scimes ` behaves well , yielding cloud properties that do not vary significantly with the different noise realizations : properties differ by only few percent up to a maximum of 15% between the cubes . nevertheless , adding random noise alters the significance of the local maxima of the original datacube , and consequently the connectivity of the various objects resulting in some changes in the cloud identification .",
    ".properties of the most notable orion - monoceros complex clouds .",
    "co luminosity , radius , and velocity dispersion are indicated as mean and standard deviation of the properties measured of the ten datacubes with different noise realizations . [",
    "cols=\"^,^,^,^ \" , ]",
    "in this paper we present ` scimes ` ( spectral clustering for interstellar molecular emission segmentation ) , which introduces a novel approach to segment the molecular medium based on dendrograms , graph theory , and clustering .",
    "we also introduced many new concepts for the study of the ism connected with the cloud decomposition and the multi - scale analysis of the molecular gas emission . here",
    "we discuss their scientific implications and the unique possibilities offered by the method .",
    "one of the main features of ` scimes ` is to provide objects with sizes significantly larger than the resolution element and not simply determined by the sensitivity of the data .",
    "this distinguishes our method from other algorithms for ism segmentation that are very much constrained by the size of the beam and channel width of the data set .",
    "indeed , clustering means grouping together entities that are similar and separating them from others which show a lower level of similarity .",
    "the clusters identified by ` scimes ` will be , in general , always larger than the resolution element . in a multi - scale ism",
    ", these objects can possess complex morphologies . in the orion - monoceros dataset",
    ", we found compact , round clouds as well as concave and elongated shapes .",
    "this unique feature of the algorithm allow for a more morphologically - oriented study of the molecular medium .",
    "nevertheless , for most extragalactic observations , the beam size is roughly the characteristic size of the gmcs .",
    "then , the leaves of the dendrogram already represent single clouds . in this case",
    ", the clusters would be collections of gmcs that might be useful for some applications and studies , but not for a gmc catalog",
    ". other algorithms would be more appropriate for identifying gmcs in that use case .    `",
    "scimes ` identifies structures that can be considered as single entities since the dendrogram leaves that compose these structures can be grouped together according to cluster theory .",
    "` scimes ` labels some dendrogram structures as independent from others relative to the similarity criteria chosen .",
    "those structure are , therefore , already present and cataloged by the dendrogram , and ` scimes ` can not find other objects that are not considered by the dendrogram . since the dendrogram is constructed considering the pixel neighborhood according to the dimension of the dataset , the structures identified by ` scimes ` in a ppv cube are velocity - connected",
    ". however , velocity - connected objects ( especially in the galaxy ) are not always at the same distance as in the case of the orion - monoceros complex ( but see appendix  [ a : nodist ] ) .",
    "if distances are known they can be provided as input to define the similarity matrices .",
    "the final segmentation would be more physically - oriented rather than data - oriented as for the orion - monoceros segmentation proposed in section  [ s : test ] .",
    "the flexibility of the dendrogram to operate on multidimensional datasets makes ` scimes ` already applicable for _ position - position _ images ( converting , for example , the `` volume '' criteria into an `` area '' criteria ) or _ position - position - position _ simulated cube ( e.g. duarte - cabral et al . in prep . ) .",
    "moreover , future developments for more simulation - oriented applications in the pppv or pppvvv domains are possible .",
    "the dendrogram - basis of ` scimes ` offers other advantages .",
    "the hierarchical structure is one of the main characteristics of the molecular medium that reflects its turbulent nature . within the identified objects ,",
    "this structure is readily available after the dendrogram creation .",
    "this might allow , for example , to study how turbulent energy is transferred and dissipated from the size of the clouds to smaller , inner , bound structures @xcite .    while cluster analysis is a novel approach in astronomy ,",
    "` scimes ` has been developed with standard clustering algorithms adapted from other disciplines to suit our needs .",
    "the data mining and machine learning literatures are rich in alternatives to spectral clustering ( e.g. , @xcite ) , k - means ( e.g. , @xcite ) , and the silhouette index ( e.g. desgraupes 2013 ) .",
    "our method might be improved or complemented in a number of different ways .",
    "` scimes ` starts by abstracting the dendrogram obtained from a star - forming complex into a graph , where the leaves of the dendrogram are seen as vertices of the graph and the hierarchical level where two leaves merge defines the connection ( edge ) between the nodes .",
    "a key step that strongly determines the final segmentation results is the choice of the similarity criteria or equivalently the weights of the graph edges .",
    "the current implementation of ` scimes ` makes use of two criteria , based on the ppv volume of the smallest isosurface containing the two leaves under consideration and the amount of flux ( or co luminosity , when distance information is available ) within it .",
    "those criteria are readily available from the dendrogram itself and appear to provide good results . moreover ,",
    "being cumulative properties , `` volume '' and `` luminosity '' provide well - behaved , block diagonal similarity matrices .",
    "in particular , within the volume - associated matrix the blocks corresponding to the classic clouds of the orion - monoceros complex stand out clearly and ` scimes ` has no difficulty in identifying them .",
    "the spectral clustering also requires insignificant cluster affinities to be rescaled out using , for instance , a gaussian kernel ( or its alternative version used in the paper ) . the gaussian kernel has a free `` scaling parameter '' to be set for this operation .",
    "we selected an optimal value for this parameter with an initial guess from the similarity matrix . in the case of the orion - monoceros complex",
    ", a volume of @xmath132pc@xmath94km / s corresponds to an effective radius @xmath133pc and a velocity dispersion @xmath134km / s .",
    "those quantities are very close to the usually cited characteristic scales of the gmcs ( e.g @xcite ) and ` scimes ` finds them through a pure data - driven analysis . given the clearly defined appearance of the affinity matrix , it seems that the objects in this star forming complex have a well - established maximum size and velocity dispersion .",
    "if a larger scale in the molecular hierarchy existed , the data of sufficiently wide area that ` scimes ` would be able to find it .",
    "in the same way , from the luminosity criterion , ` scimes ` selects a scaling parameter equal to 28128kkm / spc@xmath94 , equivalent , by assuming a galactic @xmath135m@xmath3/(kkm / spc@xmath94 ) ( e.g. @xcite ) , to @xmath136m@xmath3 , again similar to the average mass assumed for the gmcs in the milky way . `",
    "scimes ` finds those parameters , as well as the initial guess for the number of clusters , automatically via a direct analyses of the affinity matrix .",
    "these variables can be also imposed by the user if necessary .    for the orion - monoceros complex dataset we analyzed here ,",
    "the blocks of the similarity matrix associated with the luminosity criterion are not as well defined as in the volume matrix . for this dataset ,",
    "the luminosity is not a clustering criterion as good as the volume .",
    "additionally , the silhouette calculated for the best clustering configuration through the luminosity criterion is not as high as the one obtained from the volume criterion alone ( see section  [ ss : test_oriondata ] ) . the silhouette profile shown in figure  [ f : orion_siltest ] for the luminosity presents ambiguities that are not observed in the profile of the volume criterion . taken together",
    ", these evidences might indicate that for the particular tracers and resolution used to image the considered star forming region , the emission is better segmented through its morphological features , rather than the emission .",
    "for the given observation and scale , the relevant structures tend to have similar volumes rather than luminosities .    in this aspect ,",
    "the differences in ` scimes ` performance between the `` luminosity '' , and `` volume '' similarity criteria might be generally connected with the question of _ which is the `` right '' segmentation criterion for the clouds ? _ this question can be more generally posed as _ what is the physical mechanism responsible for the clumpiness of the molecular ism ? _ or _ are molecular clouds real , independent entities , and an important scale for the star formation process ?",
    "_ even so , the different criteria might produce segmentations that mimic a by - eye approach without being linked to a particular physical origin . nevertheless , the most innovative feature of ` scimes ` is the possibility to expand the friends - of - friends segmentation concept , where the `` friendship '' is set not simply by the value of neighboring pixels , but by real physical properties of the ism .",
    "indeed , the main strength of the spectral clustering is to shift every property that can be seen as a similarity into an euclidean space where clustering features are enhanced , with basically no restrictions .",
    "moreover , the isosurfaces associated with the graph edges are well - defined three - dimensional structures that posses their own physical properties . those properties can be applied to construct customized similarity matrices to be used to generate segmentation based on the physics one wants to explore . for example",
    ", similarity matrices can be obtained considering the amount of star formation within the isosurface , the abundance of a particular chemical tracer , the level of dust extinction , or kinematic properties .",
    "the products of such segmentation would be gas `` clusters '' having a characteristic maximum property defined by the similarity criteria utilized .",
    "moreover , through the matrix aggregation , various segmentations can be obtained aggregating several criteria together .",
    "the dominant one(s ) ( as in the case of `` volume '' versus `` luminosity '' ) would leverage lower similarities among the others .      according to their properties ,",
    "the objects identified by ` scimes ` in the orion - monoceros complex match with the general definitions of `` giant molecular cloud '' present in the literature .",
    "indeed , from the theoretical point of view , gmcs can be seen as the largest star formation - coherent regions @xcite , of which the size is expected to be characterized by the @xcite wavelength . for a toomre stability parameter @xmath137 close to unity ,",
    "this length - scale is roughly equal to the scale height of the gaseous disk ( @xcite ) . for observations ,",
    "however , the working definition of @xcite is usually adopted : gmcs are considered as appropriate sites of star formation , formed mostly from molecular gas , having masses @xmath110m@xmath3 , and sizes @xmath138pc , whose properties are noticeably different from the ambient medium ( @xcite ) . although the latter is used to design surveys aiming for gmc studies , it is not applicable in general , and many examples of objects that deviate for one or more of the characteristics listed above are found ( e.g. @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .    through this paper",
    "we proposed that gmcs can also be defined using the methodologies of the cluster analysis .",
    "conceptually , this new definition provides immediate advantages .",
    "first , it prompts gmcs with a solid mathematical formalism based on the framework of cluster analysis .",
    "second , the act of finding clusters might help to constrain theories of gmc formation .",
    "clustering means to group together objects or variables that share some observed qualities .",
    "alternatively , clustering means to partition or to divide a set of objects or variables into mutually exclusive classes whose boundaries reflect differences in the observed qualities of their members . in a similar fashion , a set of gas clumps can be grouped together if they possess common properties .",
    "if this is true , it is logical to think that those clumps might also share a common origin .",
    "various sets of common properties define a single entity ( e.g. a gmc , regarding the scale under consideration ) , the elements of which have followed a common evolutionary path , possibly with a single outcome ( e.g. , a coherent star formation ) . if some properties are shared but not others , the clumps might originate from the same phenomena , but they have followed different evolutionary paths perhaps shaped by different environmental conditions . instead if no property is shared , formation and evolution might be completely separate for the group of clumps under consideration .",
    "these properties can be distinguished into location in the ppv space and physical properties of the clumps , both encoded in ` scimes ` through the dendrogram and the specific set of affinity matrices considered , respectively .    in section  [ ss : test_robustpar ]",
    "we found out that a resolution of 10pc or better is needed for the algorithm to identify gmc - like objects . in the same way , not only gmcs , but also their sub - structures such as clumps or filaments ,",
    "might be associated with specific affinity matrices or clustering criteria , providing enough dynamical range to allow ` scimes ` to correctly characterize the hierarchical nature of their emission .",
    "this might help to find a common mathematical and physical definition for all molecular gas structures which could be viewed as subclasses of the more extended concept of `` molecular gas clusters '' . with this term we mean discrete regions of the molecular ism that share common properties as defined by a set of similarity matrices , including possibly a common formation and/or evolutionary history .",
    "we presented a generalization of the gmc segmentation problem based on graph theory and cluster analysis , to create ` scimes ` ( spectral clustering for interstellar molecular emission segmentation ) . `",
    "scimes ` is a novel and robust approach that faithfully reproduces the work of by - eye identification of gmcs using dendrograms of emission .",
    "dendrograms can be seen as mathematical graphs by considering the leaves as the vertices of the graph .",
    "the edges of the graph can be weighted using the properties of the highest - level isosurface containing each pair of leaves .",
    "those weights are collected into similarity matrices and passed to the spectral clustering .",
    "spectral clustering produces optimal cuts of the structure tree , which identifies the molecular clouds , while respecting the hierarchy of the dendrogram structures .",
    "we tested the method using data of the @xmath0co(1 - 0 ) emission from the orion - monoceros complex .",
    "we found that all canonical clouds of the complex ( e.g. , orion a , orion b , monoceros , the northern filament , ngc2149 , the crossbones and the scissors ) are correctly recognized by the algorithm .",
    "their properties were robust to changes in the dendrogram - generation parameters and different noise realizations .",
    "the results are quite stable in degrading the spatial resolution by a factor 10 but performance declines for resolutions @xmath139pc .",
    "` scimes ` performs best in complex environments and with high resolution data , such as those as provided by galactic plane surveys .",
    "this approach is thus complementary to other algorithms like clumpfind and cprops . when applied to well - resolved gmc data , clumpfind and cprops ( in `` cloud '' mode ) tend instead to over - divide the molecular emission .",
    "this behavior changes the shape of the mass spectra , which is more closely related to resolution - element - sized clump spectra rather than cloud spectra for high resolution surveys .",
    "all algorithms , however , introduce a significant amount of scatter in the scaling relations between cloud properties .",
    "we interpreted the scatter given by the properties of the objects identified by ` scimes ` as the result of real physical differences in the orion - monoceros clouds that leave traces in the measurement of the velocity dispersion . the scaling relations _ within _ the hierarchies of the different objects show much tighter correlations .    `",
    "scimes ` finds coherent regions within data cubes .",
    "those regions possess similar values of volume or integrated co luminosity .",
    "the regions ( clouds ) decomposed by the algorithm are quite similar if they are identified by the volume , or the luminosity of both criteria aggregated .",
    "nevertheless , the volume criterion appears to provide better clustering performance .",
    "` scimes ` offers also an opportunity to expand the `` friends - of - friends '' paradigm from the pixel neighborhood - based one to the physics - based one .",
    "indeed , similarity matrices can be generated through virtually every property of the ism , including star formation rate and chemical content .",
    "this operation also expands the concept of `` giant molecular cloud '' itself to be included in the broader class of the `` molecular gas clusters '' .",
    "we defined molecular gas clusters as a category of discrete objects within the molecular ism that share several common physical properties and can be segmented by a well - defined set of similarity criteria .",
    "the algorithm is publicly available and it is readily usable not only for ppv data cubes but also for the object identification in pp images and ppp simulations . in the same way , it can be tuned to recognize clumps or filaments , given enough dynamic range necessary for the correct construction of the gas emission hierarchy within the data .",
    "the authors thank the anonymous referee for the constructive comments that significantly help to improve the quality of the paper .",
    "the authors thank also veselina kalinova , diederik kruijssen , abou - moustafa karim , jaime pineda , andreas schruba , jens kauffmann , ke wang , volker ossenkopf , stephanie walch , friedrich wyrowski , arnaud belloche , alexander karim , alvaro sanchez - monge , laszlo szucs , sharon meidt , andrey shoom for the useful insight and discussions during the development of the method and the writing of the paper .",
    "er and dc are supported by a discovery grant from nserc of canada and research funding from the faculty of science at the university of alberta .",
    "adc acknowledges funding from the european research council for the fp7 erc starting grant project localstar .",
    "ah acknowledges support from the centre national detudes spatiales ( cnes ) and funding from the deutsche forschungsgemeinschaft ( dfg ) via grants schi 536/5 - 1 and schi 536/7 - 1 as part of the priority program spp 1573",
    "`` ism - spp : physics of the interstellar medium '' .",
    "robust distance estimations are rarely available especially for galactic studies . in this appendix , we show , therefore , how the orion - monoceros data segmentation changes without providing distance information to ` scimes ` . in this case , we need to consider the `` volume '' criterion as in equation  [ e : volume ] but measured in arcsec@xmath125km / s .",
    "the `` luminosity '' criterion is effectively turned into a `` flux '' criterion ( equation  [ e : flux ] ) measured in kkm / sarcsec@xmath125 .",
    "figures  [ f : orion_cont_nodist]-[f : orion_dendro_nodist ] show the results of the segmentation in terms of contoured integrated intensity maps , affinity matrices , and clustered dendrograms , as provided by volume , flux and aggregate criteria . ` scimes ` selected @xmath140arcsec@xmath125km / s for rescaling of the volume matrix , and @xmath141kkm / sarcsec@xmath125 for the flux matrix .",
    "further , the code guessed @xmath142 number of clusters for the three criteria , respectively .",
    "the silhouette analysis pointed out to more appropriate @xmath143 clusters .",
    "the silhouette values for the clustering criteria are sil @xmath144 .",
    "the final cluster cleaning eliminates 3 clusters from the final count of volume - criterion based segmentation , leaving the number of cluster found by the algorithm equal to 71 .",
    "one of the difference we note with respect to the distance - based decomposition is that the affinity matrices from both volume and flux are more alike : the blocks corresponding to the objects identified by ` scimes ` are well defined in both the matrices . in the same way ,",
    "the silhouette calculated from the flux decomposition in larger than the luminosity based one .",
    "dendrogram leaves form well separated clusters and all criteria provide quite accurate cloud segmentations .",
    "the main difference with respect to the decomposition generated attributing distances to the dendrogram structures is that monoceros and ngc2149 are identified as a single entity .",
    "however these clouds appear spatially separated , having different orientation and morphology .",
    "indeed , by turning the `` volume '' criterion into an `` area '' criterion ( by using @xmath145 instead of @xmath146 to weight the graph edges ) ` scimes ` separates this structure into two different clouds .",
    "nevertheless , monoceros and ngc2149 have similar velocity dispersions ( @xmath147km / s , respectively ) and centroid velocity ( @xmath148km / s , respectively ) .",
    "these structures are coherent in velocity and they have strong affinity in the velocity dispersion space .",
    "the high affinity in velocity dispersion washes out the lower affinity introduced by the area and makes ` scimes ` to merge monoceros and ngc2149 when the volume criterion ( without distance information ) is used .",
    "instead , through the distances reported in table 2 of @xcite monoceros is , in proportion to the units used , two times larger and the affinity with ngc2149 is much lower . in this case ,",
    "spatial affinities dominate the velocity dispersion ones and the two objects are separated .",
    "nevertheless , ngc2149 distance is not well determined . @xcite attributed it by averaging the distances to orion a and the southern filament , since background stars are not present for this cloud .",
    "we consider , therefore , that an association of ngc2149 with monoceros is possible , given the high velocity coherence of the two objects ."
  ],
  "abstract_text": [
    "<S> we present a generalization of the giant molecular cloud ( gmc ) identification problem based on cluster analysis . </S>",
    "<S> the method we designed , ` scimes ` ( spectral clustering for interstellar molecular emission segmentation ) considers the dendrogram of emission in the broader framework of graph theory and utilizes spectral clustering to find discrete regions with similar emission properties . for galactic molecular cloud structures , </S>",
    "<S> we show that the characteristic volume and/or integrated co luminosity are useful criteria to define the clustering , yielding emission structures that closely reproduce `` by - eye '' identification results . ` </S>",
    "<S> scimes ` performs best on well - resolved , high - resolution data , making it complementary to other available algorithms . using @xmath0co(1 - 0 ) data for the orion - monoceros complex </S>",
    "<S> , we demonstrate that ` scimes ` provides robust results against changes of the dendrogram - construction parameters , noise realizations and degraded resolution . by comparing ` scimes ` with other cloud decomposition approaches , </S>",
    "<S> we show that our method is able to identify all canonical clouds of the orion - monoceros region , avoiding the over - division within high resolution survey data that represents a common limitation of several decomposition algorithms . </S>",
    "<S> the orion - monoceros objects exhibit hierarchies and size - line width relationships typical to the turbulent gas in molecular clouds , although `` the scissors '' region deviates from this common description . ` scimes ` represents a significant step forward in moving away from pixel - based cloud segmentation towards a more physical - oriented approach , where virtually all properties of the ism can be used for the segmentation of discrete objects .    </S>",
    "<S> [ firstpage ]    ism : clouds  ism : structure  methods : analytical  techniques : image processing , dendrogram , graph theory , data mining , cluster analysis </S>"
  ]
}