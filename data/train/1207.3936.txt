{
  "article_text": [
    "in this article we will be interested in the asymptotic number of magic squares with their entries being prime numbers in @xmath2 $ ] when @xmath0 .",
    "the generalization of an important conjecture by hardy and littlewood , says ( conjecture 1.4 in @xcite ) :    [ conjehl ] ( generalised hardy - littlewood conjecture ) let @xmath7 , @xmath8 , @xmath9 , @xmath10 be positive integers , and let @xmath11 , @xmath12 , be a system of affine - linear forms ( none of the @xmath13 is constant and no two of them are rational multiples of each other ) with size @xmath14 , where each @xmath15 and @xmath16 is the standard basis for @xmath17 .",
    "let @xmath18^d$ ] be a convex body .",
    "then we have : @xmath19 where @xmath20 denotes the prime numbers , the archimedean factor @xmath21 is @xmath22 and the local factors @xmath23 are defined as @xmath24 for each prime @xmath25 with @xmath26 being the _ local von mangoldt function _ , @xmath27 , @xmath28 and @xmath29 if @xmath30 .    informally speaking , in the same sense that the prime number theorem states that if a random integer is selected near @xmath7 its probability of being prime is asymptotically @xmath31 , the conjecture asserts that the probability that a randomly selected point in @xmath32 `` of magnitude @xmath7 '' has prime entries in all its coordinates is asymptotically @xmath33 .",
    "green and tao introduced in @xcite a `` measure of how complicated such a problem is '' .",
    "it is called complexity ( or cauchy - schwarz complexity ) :    [ complexity ] if @xmath12 is a system of affine - linear forms , it has @xmath34-complexity at most @xmath35 if one can write the set of @xmath36 forms",
    "@xmath37 as a union of @xmath38 sets , in such a way that @xmath13 does not lie in the affine - linear span over @xmath39 of any of these sets .",
    "the complexity of @xmath40 is the least @xmath35 for which the system has @xmath34-complexity at most @xmath35 for all @xmath41 , or @xmath42 if no such @xmath35 exists .",
    "the main theorem of green and tao in that same article , says :    suppose that the inverse gowers - norm conjecture @xmath43 and the m@xmath44bius and nilsequences conjecture @xmath45 are true for some finite @xmath46 .",
    "then the generalised hardy - littlewood conjecture is true for all systems of affine - linear forms of complexity at most @xmath35 .    in @xcite the _ m@xmath44bius and nilsequences conjecture _ @xmath45 is proved for every @xmath35 and in @xcite the _ inverse gowers - norm conjecture _",
    "@xmath43 is proved for every @xmath35 .",
    "then , conjecture [ conjehl ] is in fact a theorem for every system of affine - linear forms of finite complexity .    for the problem of @xmath1 magic squares ,",
    "as we shall soon see , we will be dealing with linear instead of affine - linear forms . in section [ sec2basis ]",
    ", we will find suitable linear forms for our problem for every @xmath3 .",
    "in section [ seccomp ] , we will calculate the complexity of all these systems of linear forms . in section [ sec4vol ]",
    ", we will deal with the computation of the volumes of the polytopes that arise in our problem . in section [ sec5local ]",
    ", we will face the computation of the local factors @xmath23 . based on the work of the other sections , in section [ sec6asym ] we will be able to give our asymptotics .",
    "finally , in section [ sec7dif ] , we will show that the asymptotics are the same if we impose the condition that our magic squares must have different entries .",
    "for any @xmath3 , an @xmath1 @xmath47-magic square is an @xmath1 array with its @xmath48 entries being real numbers , in such a way that the sum of the elements in every row , column or any of the two main diagonals is the same , the magic sum @xmath49 .",
    "if all its entries are integers , we will say it is a @xmath50-magic square .    for every @xmath3 , @xmath1 @xmath47-magic squares have the structure of a @xmath47-vector space and @xmath1 @xmath50-magic squares form an abelian group with the sum , and so a @xmath50-module , and we will soon see that we can find a basis for this @xmath50-module .",
    "most of the time in this article we will be only interested in @xmath50-magic squares .",
    "when we want to specify that the @xmath48 entries of a magic square are different ( in fact , what is usually called a magic square is a @xmath50-magic square with different entries ) , we will explicitly state it .",
    "also , we will specify when we want the entries to belong to certain set ( e.g. @xmath51 or the primes in this set ) .    for a @xmath52 @xmath50-magic square , naming its entries @xmath53 from left to right and from top to bottom ( as we will always do in the rest of the article",
    "coordinates both as column vectors and as @xmath1 squares .",
    "so , we will sometines make an abuse of notation refering to the second row of a vector ( entries @xmath54 ) or its top - left to bottom - right diagonal ( entries @xmath55 ) . ] ) , we have : @xmath56 and since @xmath57 , we have that @xmath58 .",
    "so , if the integer @xmath59 , then @xmath60 and @xmath61 will be respectively @xmath62 and @xmath63 for some integer @xmath64 . in the same way , @xmath65 and @xmath66 will be respectively @xmath67 and @xmath68 for some integer @xmath69 .",
    "the other four entries of the square are now determined , as we can see in figure [ figura1 ] .",
    "[ cols=\"<,^,>,^,<,^ , > \" , ]     with this in mind , we define our basis for @xmath6 :    * ( elephant basis ) * for @xmath6 , consider the skeleton in an @xmath1 square consisting of all the elements of the first row , all the elements of rows 2 to @xmath70 except from the last one of each row and all the elements of row @xmath71 except from the second , the @xmath72-th and the last one . the @xmath1 elephant basis is formed by the @xmath73 @xmath1 @xmath50-magic squares that have one as an entry in one of the positions of the skeleton and zeros in all its other positions .        to see that the definition is right and that it gives us what we want , we prove the next lemma .",
    "[ lemaele ] for every @xmath6 the elephant basis is a @xmath50-basis for @xmath1 @xmath50-magic squares .",
    "first of all we will show that if we fix any integer entries in the positions of the skeleton ( in particular if one of them is 1 and all the rest are 0 ) , they determine a unique @xmath47-magic square which is also a @xmath50-magic square .",
    "we first observe that the skeleton contains the first row of the square , so adding the values in these positions gives the magic sum of the square .",
    "since the magic sum is an integer number , we can now determine the integer numbers of the last position of rows 2 to @xmath70 ( because of the sum on their rows ) , the last position of columns 1 , 3 to @xmath74 and @xmath71 ( because of the sum on their columns ) and the one in the bottom - right corner of the square ( because of the sum on its main diagonal ) .",
    "with these integers already determined , we can determine the integer in position 2 of row @xmath71 ( because of the sum on its main diagonal ) and the one in the last position of the same row ( because of the sum on its column ) .",
    "now , we can determine the integer in the second position of the last row ( because of the sum on its column ) and the one in position @xmath70 of row @xmath71 ( because of the sum of its row ) .",
    "the value in position @xmath70 of the last row is the only one left to be determined .",
    "since the sum of all the elements of the square is the same if we sum them by rows or by columns , we will of course obtain the same integer if we determine it with the values of column @xmath70 or the ones in the last row .",
    "now , the vectors are linearly independent by construction ( each of them has a 1 in a position where all the others have a 0 ) , and , given a @xmath50-magic square , we can look at the values it has in the positions of the skeleton and we can express it as the linear combination with these coefficients in the corresponding vectors of the elephant basis .",
    "so the elephant basis is a @xmath50-basis .",
    "following exactly the procedure described in the proof of lemma [ lemaele ] we can determine all the entries of all the squares in our elephant basis .",
    "if we write them as column vectors , one after another , forming a matrix , the rows will give us the linear forms we were looking for .",
    "figure [ matelebasis ] gives this @xmath75 matrix .",
    "we will identify each row of coefficients with the corresponding linear form .",
    "the @xmath73 forms marked in gray in the figure are the `` canonical '' linear forms with all their coefficients equal to zero except from one which is 1 and correspond with the positions of the skeleton of the elephant basis .",
    "we will call these the trivial linear forms .",
    "the other @xmath76 forms will be called the nontrivial linear forms .    of course , the first @xmath77 vectors ( columns ) have magic sum 1 and all the others have magic sum 0 . the pattern on each row , if we look at the blocks of @xmath71 columns indicated ( from column @xmath78 to column @xmath79 ) , should be obvious",
    ". maybe only some words about the patterns on the third and @xmath80-rd row from the bottom should be said .",
    "we explain what happens in the third row from the bottom ( the other is very similar ) .",
    "the first @xmath77 and the last @xmath74 positions do not give any problem , so we look at the @xmath74 blocks of @xmath71 positions from column @xmath78 to column @xmath79 . to obtain the second block from the first",
    "( observe that in the case @xmath81 the first block is @xmath82 ) , we substract 1 in the second position and add 1 in the third and also substract 1 in the @xmath72-nd and add 1 in the @xmath83-st . to obtain the third block from the second , the @xmath84 and @xmath85 on the left move one position to the right ( we substract 1 in the third position and add 1 in the fourth ) and the @xmath84 and @xmath85 on the right move one position to the left ( we substract 1 in the @xmath86-rd position and add 1 in the @xmath72-nd ) . and we continue in the same fashion .",
    ".,scaledwidth=140.0% ]    as we announced in our comment on page , obtaining @xmath73 trivial linear forms proves in particular that there is a matrix obtained from @xmath87 by elementary row operations , with @xmath76 of its columns being the vectors of the canonical basis of the @xmath76-dimensional space and with all the rest of its entries being integer numbers .",
    "in fact , we can very easily write such a matrix explicitly from the linear forms : the vectors of the canonical basis of the @xmath76-dimensional space will be in the @xmath76 columns of the matrix corresponding to the nontrivial linear forms and the other @xmath88 entries of the rows of @xmath87 will be the opposites of the coefficients of the nontrivial linear forms",
    ".    then we have our linear forms for every @xmath77 .",
    "we turn to the complexity problem .",
    "althought the results mentioned in section [ intro ] tell us that we can use conjecture [ conjehl ] as a theorem for every system of affine - linear forms of finite complexity , determining the exact complexity of a problem is theoretically important .",
    "problems of complexity 1 were essentially present in the work of hardy - littlewood and vinogradov , though not in this language . to solve problems of complexity 2 we need to use the results in @xcite , @xcite and @xcite . to solve problems of complexity 3 or higher we need to use the results in @xcite , @xcite and @xcite .",
    "we have @xmath50-basis ( or equivalently linear forms ) for @xmath52 , @xmath89 and @xmath1 ( for @xmath6 ) @xmath50-magic squares in figure [ figure3x3 ] , figure [ figure4 ] and figure [ matelebasis ] respectively .",
    "we will calculate the complexity ( see definition [ complexity ] ) of these systems of linear forms .",
    "the system of linear forms given by the @xmath50-basis of figure [ figure3x3 ] is , as we pointed out , @xmath91 .",
    "we will indentify these linear forms with the row vectors @xmath92 , @xmath93 , @xmath94 , @xmath95 , @xmath96 , @xmath97 , @xmath98 , @xmath99 and @xmath100 .",
    "the complexity of the system of linear forms given by the @xmath50-basis for @xmath52 @xmath50-magic squares of figure [ figure3x3 ] is 3 .",
    "first of all , we show that the @xmath34-complexity of every form is at most 3 . in order to see it , given the form @xmath34 , we split the others into four sets in such a way that the form @xmath34 can not be written as a linear combination over @xmath39 of the forms in any of the four sets .",
    "we write explicitly the four sets for every form :    * @xmath92-complexity at most 3 : @xmath101 , @xmath102 , + @xmath103 , @xmath104 . *",
    "@xmath93-complexity at most 3 : @xmath105 , @xmath106 , + @xmath107 , @xmath108 . *",
    "@xmath94-complexity at most 3 : @xmath109 , @xmath102 , + @xmath110 , @xmath111 . *",
    "@xmath95-complexity at most 3 : @xmath105 , @xmath106 , + @xmath112 , @xmath113 . *",
    "@xmath96-complexity at most 3 : @xmath114 , @xmath102 , + @xmath103 , @xmath104 .",
    "* @xmath97-complexity at most 3 : @xmath105 , @xmath106 , + @xmath103 , @xmath113 .",
    "* @xmath98-complexity at most 3 : @xmath109 , @xmath115 , + @xmath110 , @xmath111 .",
    "* @xmath99-complexity at most 3 : @xmath105 , @xmath106 , + @xmath107 , @xmath104 . *",
    "@xmath100-complexity at most 3 : @xmath101 , @xmath116 , + @xmath103 , @xmath104 .",
    "so the complexity of the system is at most 3 .",
    "now we will prove that , for example , the @xmath96-complexity has to be 3 and no less and this will prove that the complexity of the system is 3 .",
    "we suppose for a contradiction that we can split the other eight forms in three sets in such a way that @xmath96 is not in the linear span of any of these sets . since @xmath96 is in the linear span over @xmath39 of @xmath94 and @xmath98 , these two forms have to be in a different set , and the same happens with @xmath92 and @xmath100 . since we only have three sets",
    ", two of these four forms have to be in the same set , so we have that one form of the shape @xmath117 and one of the shape @xmath118 are in the same set , where @xmath119 can be @xmath120 or @xmath84 . in that set",
    "we can not have any other form , since @xmath96 would be in the linear span of them together with any @xmath121 .",
    "so the first of our three sets is of the form @xmath122 .",
    "now , since @xmath96 is in the linear span over @xmath39 of @xmath99 and @xmath93 , these two forms have to be in a different set , and the same happens with @xmath95 and @xmath97 .",
    "then , the two forms of the shape @xmath117 and @xmath118 that are not in our first set , must be in different sets , since if they are in the same set they would be the only two forms in that set and then we would have more than three sets .",
    "then a form of the shape @xmath117 is in the second set and a form of the shape @xmath118 is in the third .",
    "now , either @xmath99 and @xmath95 are in one of these sets and @xmath93 and @xmath97 in the other or @xmath99 and @xmath97 are in one these sets and @xmath93 and @xmath95 in the other . in the first case",
    ", @xmath123 is in the linear span of both sets , and @xmath96 in the linear span of the set with the form @xmath117 , which is a contradiction . in the second case",
    ", @xmath124 is in the linear span of both sets , and @xmath96 in the linear span of the set with the form @xmath118 , which is also a contradiction .",
    "this tell us two things , that complexity can be somewhat complicated and that for @xmath52 squares we need very `` strong '' and recent results .",
    "we write the vectors of the @xmath50-basis of figure [ figure4 ] as columns of a matrix ( see figure [ matele4 ] ) and , looking at the rows , we have the coefficients of the 16 linear forms , @xmath125 , we are interested in .",
    "we identify each form with its corresponding row vector in @xmath126 .",
    "because of the way we constructed the basis , observe that @xmath127 and @xmath128 are the vectors of the canonical basis of the 8-dimensional space .",
    "we analyse the @xmath13-complexity of each form :    * @xmath129 , @xmath130 , @xmath131 and @xmath132-complexities are at most 1 because @xmath129 , @xmath130 , @xmath131 and @xmath132 are linearly independent and not in the linear span of the rest ( all of them have a value different from 0 in their first position and all the rest have a zero in that position ) .",
    "* @xmath133 , @xmath134 , @xmath135 , @xmath136 and @xmath137-complexities are at most 1 because @xmath133 , @xmath134 , @xmath130 , @xmath135 , @xmath136 , @xmath137 and @xmath132 are linearly independent and not in the linear span of the rest ( all of them have a value different from 0 in their second or third positions and all the rest have a zero in both of these positions ) .",
    "* @xmath138 and @xmath139-complexities are at most 1 because @xmath140 , @xmath130 , @xmath131 , @xmath135 , @xmath136 , @xmath137 , @xmath132 and @xmath139 are linearly independent and not in the linear span of the rest ( all of them have a value different from 0 in their fourth position and all the rest have a zero in that position ) .",
    "* @xmath141 and @xmath142-complexities are at most 1 because @xmath143 , @xmath144 , @xmath145 , @xmath128 , @xmath135 , @xmath136 , @xmath137 and @xmath132 are linearly independent and @xmath141 and @xmath142 are not in the linear span of the other eight forms .",
    "* @xmath146 and @xmath147-complexities are at most 1 because @xmath144 , @xmath130 , @xmath135 , @xmath147 , @xmath137 and @xmath132 are linearly independent and not in the linear span of the rest ( all of them have a value different from 0 in their sixth position and all the rest have a zero in that position ) .",
    "* @xmath148-complexity is at most 1 because @xmath145 , @xmath130 , @xmath131 , @xmath147 , @xmath137 and @xmath132 are linearly independent and not in the linear span of the rest ( all of them have a value different from 0 in their seventh position and all the rest have a zero in that position ) .",
    "so the @xmath13-complexity of every form is at most 1 ( and it can not be less since the 16 linear forms are not , of course , linearly independent ) . then :    the complexity of the system of linear forms given by the @xmath50-basis for @xmath89 @xmath50-magic squares of figure [ figure4 ] is 1 .      recall that the `` white '' rows in figure [ matelebasis ] give the coefficients of the nontrivial linear forms of the elephant basis for every @xmath6 .",
    "[ lemacoefnont ] by elementary row operations in the @xmath149 matrix with the coefficients of the nontrivial linear forms of the elephant basis as rows ( matrix formed by the `` white '' rows in figure [ matelebasis ] ) , the matrix of figure [ nonteche ] can be obtained .",
    "the rows of the matrix        [ coef ]    list the coefficients of the linear combination of the rows in the matrix of coefficients of the nontrivial linear forms that give the rows of the matrix in figure [ nonteche ] .",
    "the complexity of the system of linear forms that define @xmath1 @xmath50-magic squares given by the elephant basis for @xmath6 is 1 .    from the previous result , and looking at figure [ nonteche ] ,",
    "we know that the @xmath76 nontrivial linear forms of the elephant basis are linearly independent ( the @xmath76 columns marked in gray have zeros in every position except from one ) .    given any trivial linear form different from the @xmath77-th one , it is impossible to write it as a linear combination of the rows of the matrix in figure [ nonteche ] ( and so as a linear combination of the nontrivial forms ) : if such a linear combination exists and we look at the positions corresponding to the columns in grey in figure [ nonteche ] at most one of them will be different from zero .",
    "this implies that all the coefficients of the linear combination except from at most one are zero .",
    "now , if the trivial linear form is different from the @xmath77-th one , it can not be obtained as a linear combination with only one nonzero coefficient of the rows in the matrix of figure [ nonteche ] because none of them is proportional to a trivial linear form .        if we join the first and third trivial linear forms ( @xmath150 and @xmath151 ) to the nontrivial linear forms , we have a set of @xmath152 linearly independent forms : the trivial form @xmath151 , say , is linearly independent with all the nontrivial ones by the last paragraph argument . now ,",
    "suppose for a contradiction that we had a linear combination of this linear form and all the nontrivial ones that gave @xmath150 as a result .",
    "then we would also have a linear combination of @xmath151 and the rows of the matrix of figure [ nonteche ] giving @xmath150 .",
    "the coefficients of this linear combination would be all zero except from , at most , the ones of the first and the third row of the matrix of figure [ nonteche ] and the one of @xmath151 .",
    "the coefficient of the first row would have to be different from zero .",
    "but this row has nonzero entries in positions were the third row and @xmath151 have zero entries . then",
    ", the linear combination giving @xmath150 is not possible .",
    "also , from the fact that the nontrivial linear forms together with @xmath150 and @xmath151 are linearly independent , we can deduce that there is only one possible linear combination of them giving the @xmath77-th trivial linear form ( the coefficients of @xmath150 and @xmath151 are 0 and the rest are given by the @xmath77-th row of the figure of the proof of lemma [ lemacoefnont ] ) . then ,",
    "if we take out of this set of forms the first nontrivial one ( which had a nonzero coefficient in that linear combination ) , it will not be possible to obtain the @xmath77-th trivial form as a linear combination .",
    "finally , none of the nontrivial forms can be obtained as a linear combination of all but the first and third linear forms , because every nontrivial linear form has a nonzero entry either in the first or in the third position .    these things",
    "prove that :    * given any trivial linear form different from the @xmath77-th one , its complexity is at most one because we can divide the rest in the set of trivial and the set of nontrivial ones and it will not be in the linear span of any of these sets . * given the @xmath77-th trivial form , its complexity is at most one because we can construct the next two sets with the rest of the forms : the first one with the first and third trivial forms and with all the nontrivial forms except from the first one ; the second one with the rest of the linear forms . * given any nontrivial linear form , its complexity is at most one because we can divide the rest of the forms in the next two sets : the first one with the first and third trivial forms and with all the other nontrivial forms ; the second one with the rest of the trivial forms .",
    "we already have systems of linear forms @xmath153 for every @xmath77 and we know their complexity .",
    "now , we have to choose a suitable convex body @xmath18^{n^2 - 2n}$ ] in conjecture [ conjehl ] .",
    "remember that for our problem we know that conjecture [ conjehl ] is a theorem , since we have finite complexity for every @xmath3 . recall that we are interested in counting the number of @xmath1 @xmath50-magic squares with their entries being primes in",
    "@xmath2 $ ] .    then , for each @xmath3 and @xmath154 , we will have @xmath155 , where the coefficients of @xmath13 are given in figures [ figure3x3 ] ( for @xmath4 ) , [ figure4 ] ( for @xmath5 ) and [ matelebasis ] ( for @xmath156 ) , and the term @xmath157 in conjecture [ conjehl ] will be the quantity we are interested in .",
    "the first observation is that @xmath158 is convex since it is the intersection of @xmath48 convex sets .",
    "we need to calculate the archimedean factor @xmath159 .",
    "since all the points in our @xmath158 belong also to @xmath160 , we have @xmath161 .",
    "since @xmath40 is a system of linear forms , the volume of @xmath162 will be equal to @xmath163 times the volume of the polytope defined by @xmath164 .",
    "so , we only have to compute @xmath165 for @xmath3 .",
    "observe that @xmath165 is important in its own right .",
    "@xmath166 is the volume of a convex polytope in @xmath167 which points with integer coordinates are in bijective correspondence with all the @xmath1 @xmath50-magic squares with entries in @xmath2 $ ] . for large @xmath7",
    ", the volume of @xmath162 will be asymptotically the same as the number of integer points in it , so the volume of this polytope gives an asymptotic for the number of @xmath1 @xmath50-magic squares with entries in @xmath168 $ ] when @xmath7 tends to infinity .",
    "we will talk about this in more detail in a moment .",
    "we have to calculate the volume of the polytope @xmath169 defined by the next 18 inequalities ( @xmath170 for @xmath171 ) : @xmath172 , @xmath173 , @xmath174 , @xmath175 , @xmath176 , @xmath177 , @xmath178 , @xmath179 , @xmath180 .",
    "each one of these pairs of inequalities defines a region bounded by two parallel planes and because we are in a tridimensional space we can `` see '' the polytope , which is the one of figure [ tetraedro ] .",
    ".,scaledwidth=60.0% ]    since the polytope is the disjoint union of two pyramids with area of their base equal to 1/2 and height 1/2 , each pyramid will have volume 1/12 and the polytope will have volume 1/6 .",
    "so , @xmath181 .    before jumping to the case @xmath182",
    ", we could think of a different approach to calculate the volume of this polytope , maybe one wich gives a better understanding or is more generalizable .",
    "an interesting thing to know will be the exact number of points with integer coordinates in @xmath183 for every @xmath7 .",
    "as we were discussing before , this will be the exact number of @xmath1 @xmath50-magic squares with entries in @xmath2 $ ] .",
    "we have to go to ehrhart s theory , and look at its fundamental result ( see , for example , @xcite or @xcite ) :    _ * ( ehrhart s theorem ) * _ if @xmath184 is a convex polytope whose vertices have rational coordinates , then the number of points with integer coordinates in the dilations @xmath185 for @xmath186 is a quasi - polynomial in @xmath7 whose degree is the dimension of @xmath184 and whose period divides the least common multiple of the denominators of the vertices of @xmath184 .    in this case , since the least common multiple of the denominators of the vertices of @xmath169 is 2 , we will have that the ehrhart quasipolymial has degree 3 and period at most 2 . a direct way to obtain the quasipolynomial , @xmath187 ,",
    "would be to interpolate it . for that we would need @xmath188 values .",
    "@xmath187 is the number of points with integer coordinates , @xmath189 , satisfying @xmath190 for @xmath171 and , with a computer ( or even by hand ! ) , it is easy to compute : @xmath191    now , we can interpolate our quasipolynomial @xmath192 which gives the exact number of points with integer coordinates in @xmath193 , i. e. the exact number of @xmath52 @xmath50-magic squares with entries in @xmath2 $ ] .",
    "the coefficient of the leading term is @xmath194 , exactly the volume of @xmath169 .",
    "this is not a coincidence , and it is a general fact that the leading coefficient of the ehrhart quasipolynomial of a polytope is its volume .",
    "it is an inmediate consequence of the observation that the volume of a @xmath8-dimensional polytope can be thought as the limit when @xmath195 of the number of integer points in its @xmath7-dilation divided by @xmath196 .",
    "with all this in mind , we can go to the next case .",
    "our approach is now clear .",
    "we want to calculate the volume of the polytope @xmath197 given by the 16 pairs of inequalities given by @xmath170 for @xmath198 , where the coefficients of @xmath199 are given by the @xmath34-th row of the matrix of figure [ matele4 ] . we know that the volume is given by the leading coefficient of the quasipolynomial , @xmath200 , that gives the exact number of integer points satisfying @xmath190 for @xmath198",
    ".    we will compute @xmath200 by interpolation .",
    "the period of @xmath200 divides the least common multiple of the denominators of the vertices of @xmath201 .",
    "so , in order to know how many values of @xmath200 we need to interpolate it , we have to calculate the vertices of the polytope .",
    "there are different methods to compute the vertices of a polytope ( see , for example , @xcite or @xcite for surveys of vertex finding algorithms ) .",
    "the most direct of them would be to look at all the intersections of 8 of the 32 equalities @xmath202 or @xmath203 for @xmath198 consisting of a single point and then checking if the point satisfies all the inequalities @xmath170 for @xmath198 .",
    "you do not want to do this by hand , but your computer will tell you that the 178 vertices of @xmath197 are the ones listed in appendix [ apena ] . the only important thing for us is that the denominators of the coordinates of the vertices are one , two or three , so their least common multiple is 6",
    ". then we are looking for a quasipolynomial , @xmath200 , of degree 8 and period dividing 6 . in order to interpolate @xmath200",
    "we would then need @xmath204 values .    in appendix [ apenb ]",
    "we calculate the 54 needed values . with them",
    "we interpolate our quasipolynomial and we have    which gives the exact number of points with integer coordinates in @xmath201 , i. e. the exact number of @xmath89 @xmath50-magic squares with entries in @xmath2 $ ] .",
    "the coefficient of the leading term , @xmath205 , is the exact volume of @xmath197 ( one can confirm this value , for example , with polymake ; see http://www.polymake.org/ ) .",
    "you may wish to compare the quasipolynomials @xmath187 and @xmath200 with the quasipolynomials of period 2 computed in @xcite , depending on the magic sum and not on a bound for the entries .",
    "then , @xmath206 .",
    "it is reasonable to think that if for the case @xmath52 we were able to interpolate our quasipolynomial by hand and for the case @xmath89 we could do it with some computer time , then for the case @xmath207 we would be able to interpolate the corresponding quasipolynomial with just a little more computer time .",
    "but this is not exactly the case . for the case of @xmath207 @xmath50-magic squares",
    ", we would have a polytope , @xmath208 , in a 15-dimensional space defined by 25 pairs of inequalities given by @xmath170 for @xmath209 .",
    "it is easy and fast to find some vertices of this polytope with denominators 3 , 5 , 7 and 8 , for example @xmath210 this means that the least common multiple of the denominators of the vertices of @xmath208 is at least @xmath211 . to interpolate a quasipolynomial of degree 15 and period dividing 840",
    "we would need @xmath212 values . in order to calculate , for example , the largest one of these values , in principle",
    ", one would have to consider the points with integer coordinates in @xmath213^{15}$ ] and check if the 20 inequalities given by the nontrivial linear forms are satisfied . even considering that we could reduce the number of values to roughly half ( 6719 values ) with ehrhart - macdonald reciprocity law ( see appendix [ apenb ] ) , and that with efficient programing the number of calculations can be further reduced , one would have to make a very very high number of checks .",
    "and of course this grows extremely quickly with @xmath77 .",
    "it is true that we could try finding the quasipolynomial with other ideas and also that for our problem we do not need the quasipolynomial @xmath214 but only its leading coefficient , which gives the volume of @xmath165 .",
    "and it is also true that there are many other ways to calculate the volume of a polytope .",
    "but , to the best of our knowledge , no known method would give a formula for the exact volume of @xmath165 for general @xmath77 , and giving the exact value of the volume would be hard even for relatively small values of @xmath77 .",
    "as an example illustrating this , for the birkhoff polytope , one of the most important and studied polytopes , which is a similar but definitely simpler is the convex polytope in @xmath215 whose points are the doubly stochastic matrices , i.e. the @xmath1 matrices whose entries are non - negative real numbers and whose rows and columns each add up to 1 .",
    "@xmath216 is a convex polytope with integer vertices ( which are well known ) . ]",
    "polytope than the one we are considering , the volume is only known for @xmath217 and the case @xmath218 took almost 17 years of computer time ( see @xcite and http://www.math.binghamton.edu/dennis/birkhoff/ ) .",
    "so we can not give a formula for the exact volume of the polytope @xmath165 , but we can prove that the volume will be a nonzero rational number . the fact that it will be a rational number is easy to see with our approach because the coefficients of the polynomials we are interpolating are given by the solutions of linear systems with integer coefficients .",
    "to show that the volume is never zero , we first make the next observation :    [ argumentosuma1 ] consider the linear forms given by the elephant basis for some @xmath6 .",
    "then , for every @xmath219 the sum of the coefficients of the linear form @xmath13 is 1 .",
    "since the sum of magic squares gives a magic square , when we add up the @xmath73 vectors of our elephant basis we obtain a magic square .",
    "the obtained magic square has 1 as an entry in all the positions of the skeleton of the elephant basis .",
    "then , this magic square is the only magic square with ones in all that positions , so it has to be the magic square with @xmath48 ones as entries . since the coefficients of @xmath13 are the entries on the @xmath34-th position of the vectors of the elephant basis , we are done .",
    "then , the point @xmath220 belongs to @xmath162 because @xmath221 for every @xmath219 .",
    "since all the coefficients of all our linear forms have absolute value less than or equal to @xmath77 ( see , for example , figure [ matelebasis ] ) then all the points @xmath222 for @xmath223 , where @xmath224 is the @xmath225-th vector of the canonical basis of the @xmath226-dimensional euclidean space , belong to @xmath165 . because the vectors joining @xmath227 to these @xmath73 points are linearly independent , we have that the convex hull of the @xmath228 points has nonzero volume , and because @xmath162 is convex we have that it contains that convex hull .",
    "then , @xmath165 has nonzero volume .",
    "since the volume of @xmath165 is less than or equal to one ( in fact it is much smaller than one ) because the inequalities given by the trivial linear forms define the unit cube , we have proved :    for every @xmath6 , @xmath229 where @xmath230 $ ] is the rational number that gives the volume of @xmath165 .",
    "the only ingredients we are missing in order to give our asymptotics are the local factors @xmath231 . recall that for each prime @xmath25 , @xmath232 where @xmath26 is the _ local von mangoldt function _",
    ", @xmath27 , defined by @xmath28 and @xmath29 if @xmath30 .",
    "then , the important point is determining for which elements @xmath233 , we have @xmath234 for every @xmath235 . in order to do that we will use the inclusion - exclusion principle . as we will observe , for small primes we can have a different behaviour but one can always determine a nice formula giving the value of @xmath236 for every @xmath25 from some point on .",
    "we can think we have the system of 9 linear forms @xmath237 , defined by @xmath91 , and we want to determine how many of the @xmath238 elements of @xmath239 give nonzero values modulo @xmath25 for all nine linear forms .",
    "we use the inclusion - exclusion principle .",
    "there are @xmath238 elements in @xmath239 .",
    "if none of the linear forms is trivial in @xmath239 , any one of them is cancelled for @xmath240 values of @xmath239 .",
    "we have to be careful because even if none of our linear forms is trivial in the integers , it could be the case that some of them were trivial when reducing modulo @xmath25 for some small values of @xmath25 . since all the coefficients of our linear forms are zeros , and plus or minus ones , this is not the case .    now",
    ", if none of the linear forms is a multiple of another , any of the @xmath241 systems formed by two of the linear forms is cancelled for @xmath25 values of @xmath239 .",
    "this is satisfied for every @xmath242 but for @xmath243 some of the linear forms are identical to others ( for example , the second one is the same as the fourth , the sixth and the eighth )",
    ". we will later study the case @xmath243 separately .",
    "the next step is computing , for every system of three of the linear forms , the rank of the matrix formed with their coefficients as rows .",
    "again , small primes can be tricky .",
    "for example , if we select the last three linear forms , the corresponding matrix with integer coefficients and its hermite normal form .",
    "for example , we can allow the next three _",
    "unimodular elementary row operations _ : interchanging two rows , multiplying one row by @xmath84 and adding an integer multiple of a row to another one .",
    "then , the hermite normal form of a matrix with coefficients in @xmath50 can be defined as the unique matrix obtained from it by _ unimodular elementary row operations _ such that the first nonzero entry of each row is positive and strictly to the right of the first nonzero entry of the row on top of it and such that all the entries in the same column than the first nonzero entry of each row are less than it and greater than or equal to 0 . ]",
    "are respectively : @xmath244    then , the matrix in our example has rank 2 in @xmath245 and has rank 3 in @xmath246 for every @xmath247 .",
    "we will also later study the case @xmath248 separately .",
    "it makes sense to compute the hermite normal form of all the matrices with the coefficients of 3 , 4 , 5 , 6 , 7 , 8 or the 9 forms as rows . if we then look at the largest of all the first nonzero elements of a row we will see that it is equal to 4 . then , we know that for every prime @xmath249 the hermite normal form of these matrices in @xmath50 has exactly the same rank when we reduce its coefficients modulo @xmath25 .",
    "this means that we can study at the same time @xmath250 for every prime @xmath249 .",
    "we have that 8 of the matrices with three of the linear forms as rows have rank 2 and the other 76 have rank 3 in @xmath50 .",
    "also , any matrix with 4 , 5 , 6 , 7 , 8 or the 9 forms as rows has rank 3 in @xmath50 .",
    "this means that we can use the inclusion - exclusion principle to deduce that for every prime @xmath249 the number of elements @xmath251 , with @xmath234 for every @xmath252 is : @xmath253    then , for every prime @xmath249 @xmath254    for @xmath243 , the four elements of @xmath255 starting with 0 cancel the fifth linear form .",
    "the element @xmath96 does not cancel any of the nine linear forms .",
    "the other three elements starting with one either cancel the first or the third linear form .",
    "then , @xmath256 . similarly ,",
    "for @xmath257 it is easy to see that the only two elements of @xmath258 which do not cancel any of the nine linear forms are @xmath96 and @xmath259 . then @xmath260 .      in this case",
    "we have the 16 linear forms which coefficients are given by the rows of the matrix of figure [ matele4 ]",
    ". we will determine how many of the @xmath261 elements of @xmath262 give nonzero values modulo @xmath25 for all the sixteen linear forms .",
    "first of all we compute the hermite normal form of all the matrices formed with some of the rows of the matrix of figure [ matele4 ] .",
    "the largest of all the first nonzero elements of a row appearing in all these matrices is @xmath263 , so , as before , for every prime @xmath249 the hermite normal form of these matrices in @xmath50 has exactly the same rank when we reduce its coefficients modulo @xmath25 .",
    "now we compute the ranks in @xmath50 of all these matrices and we have : all 16 one row matrices have rank 1 , all 120 two row matrices have rank 2 and all 560 three row matrices have rank 3 ; 10 four row matrices have rank 3 and 1810 have rank 4 ; 120 five row matrices have rank 4 and 4248 have rank 5 ; 708 six row matrices have rank 5 and 7300 have rank 6 ; 32 seven row matrices have rank 5 , 2656 have rank 6 and 8752 have rank 7 ; 433 eight row matrices have rank 6 , 6553 have rank 7 and 5884 have rank 8 ; 32 nine row matrices have rank 6 , 2656 have rank 7 and 8752 have rank 8 ; 708 ten row matrices have rank 7 and 7300 have rank 8 ; 120 eleven row matrices have rank 7 and 4248 have rank 8 ; 10 twelve row matrices have rank 7 and 1810 have rank 8 ; all 560 thirteen row matrices have rank 8 and the same thing happens with the 120 fourteen row matrices , the 16 fifteen row matrices and the only sixteen row matrix . by the inclusion - exclusion principle , for every @xmath249",
    "the number of elements @xmath264 , with @xmath234 for every @xmath265 is : @xmath266    then , for every prime @xmath249    @xmath267    there is @xmath120 element of @xmath268 and there are @xmath269 elements of @xmath270 not cancelling any of the sixteen linear forms , so @xmath271      in the general case , it is clear that we can follow the same steps .",
    "since every two of our linear forms are linearly independent , for primes @xmath272 we will have : @xmath273 where @xmath274 and @xmath275 are ( possibly different in each occasion ) polynomials in @xmath25 of degree less than or equal to @xmath276 and @xmath276 respectively .    the existence of the logarithm function makes the theory of infinite products essentially equivalent to the theory of infinite series .",
    "in particular , it is well known that ( see , for example , @xcite ) :    if @xmath277 is a sequence of real numbers such that @xmath278 and @xmath279 then @xmath280 converges to a nonzero real number .",
    "we know that for every prime , @xmath25 , we have @xmath281 because @xmath282 makes @xmath283 for every @xmath235 .",
    "also , since there is a constant , @xmath284 , such that for @xmath272 we have @xmath285 then , by the previous lemma , we deduce :    for every @xmath3 , @xmath286 converges to a strictly positive real number .",
    "the work of the previous sections and the results mentioned in the introduction prove the next three theorems :    the number of @xmath52 @xmath50-magic squares with their entries being prime numbers in @xmath2 $ ] is @xmath287 where @xmath288    observe that , apart from the asymptotics for 5-term arithmetic progressions of primes , this is one of the first `` natural '' applications of the work of green , tao and ziegler to a system of linear equations of complexity 3 ( see section [ seccomp ] ) .",
    "for @xmath182 we have complexity 1 ( see section [ seccomp ] ) and the asymptotic :    the number of @xmath89 @xmath50-magic squares with their entries being prime numbers in @xmath2 $ ] is @xmath289 where    @xmath290    finally , for @xmath6 ( see section [ seccomp ] ) we have complexity 1 and the `` order of magnitude of the asymptotics '' :    the number of @xmath1 @xmath50-magic squares with their entries being prime numbers in @xmath2 $ ] is @xmath291 where @xmath292 is a nonzero real number .",
    "up to this point we have not been careful with the fact that there could be repetitions among the entries of our @xmath50-magic squares . in this section",
    "we prove that the asymptotics for @xmath50-magic squares of primes with different entries are exactly the same as the asymptotics for @xmath50-magic squares of primes .",
    "we first observe :    [ cuadmagdif ] for every @xmath3 , there are well known constructions of @xmath1 @xmath50-magic squares with their @xmath48 entries being the first @xmath48 natural numbers ( these are usually called normal magic squares ) .    maybe the best known constructions for normal magic squares of odd side are the ones popularly known today by the names of simon de la loubre and bachet de mziriac . for normal magic squares of even side",
    "there are also different constructions , for example those of devedec to name some .",
    "all these constructions can be found in @xcite and many others very easily searching on the internet .",
    "the only important thing for us is that there exist magic squares with all their entries being different .",
    "with this in mind we can prove the next lemma .",
    "for every @xmath3 the number of @xmath1 @xmath50-magic squares with their entries being primes in @xmath2 $ ] is asymptotically equal to the number of @xmath1 @xmath50-magic squares with their entries being different primes in @xmath2 $ ] when @xmath0 .    in the same way that we proved that the @xmath76 equations defining @xmath1 magic squares were linearly independent exhibiting magic squares that satisfied some of the equations but not the others ( see page ) ,",
    "the fact that there are @xmath50-magic squares with all their entries different ( lemma [ cuadmagdif ] ) proves that any of the @xmath293 equations of the type @xmath294 for @xmath295 $ ] and @xmath296 $ ] is linearly independent with the @xmath76 equations defining @xmath1 magic squares ( see page ) .",
    "then , the number of @xmath50-magic squares with their entries being different elements of @xmath2 $ ] is @xmath297 .",
    "this is certainly @xmath298 and then we are done .",
    "the author would like to thank fundacin ramn areces for the postdoctoral grant he enjoys at the department of pure mathematics and mathematical statistics of the university of cambridge .",
    "he would also like to thank javier cilleruelo for the proposal of the problem , ben green for some valuable suggestions and both of them for their encouragement .",
    "the 178 vertices of @xmath197 in lexicographic order are :    @xmath299    @xmath300    these vertices were obtained with the algorithm described in section [ vol4x4 ] .",
    "exactly the same vertices are obtained using cddlib , the implementation of the double description method of motzkin , raiffa , thompson and thrall ( copyright by komei fukuda , http://www.ifor.math.ethz.ch/~fukuda/cdd_home/cdd.html ) .",
    "recall that @xmath200 is a quasipolynomial giving the exact number of integer points that satisfy @xmath190 for @xmath198 , where the coefficients of @xmath199 are given by the @xmath34-th row of the matrix of figure [ matele4 ] .",
    "since the degree of @xmath200 is 8 and its period divides 6 , we need 54 values of @xmath200 in order to interpolate it .    computing each one of these values",
    "essentially consists of checking for each one of the integer points in @xmath2 ^ 8 $ ] if it satisfies the 16 inequalities given by the eight nontrivial linear forms being between 0 and @xmath7 , including both of them .",
    "it is true that we can be clever and reduce considerably the number of checkings , but this gives us an idea of the order of magnitude of the number of checkings needed . with this in mind",
    ", it would be nice if we could reduce the number of values of @xmath200 needed to interpolate it .",
    "the next fundamental result ( see , for example , @xcite or @xcite ) allow us to reduce significantly that number of values , from 54 to roughly the first half of them .",
    "[ ehrmac ] _ * ( ehrhart - macdonald reciprocity law ) * _ suppose that @xmath184 is a convex polytope whose vertices have rational coordinates . then the evaluation of its ehrhart quasipolynomial , @xmath301 , at negative integers yields @xmath302 where @xmath303 is the number of integer points in the interior of the dilation @xmath185 .    how to obtain the values of @xmath304 from the values of @xmath305 ?",
    "@xmath303 is the number of points with integer coordinates in the interior of the polytope @xmath306 .",
    "a point is in the interior of @xmath162 if and only if it satisfies those @xmath307 inequalities but none of the corresponding equalities , so @xmath308 .",
    "because of the property that for every @xmath219 the coefficients of @xmath13 add up to 1 ( see lemma [ argumentosuma1 ] ) , substracting 1 to all of the coordinates of the elements of @xmath309 gives a biyection between this set and @xmath310 for @xmath311 .",
    "then , theorem [ ehrmac ] implies that in our case @xmath312        although in this case we can directly calculate with a computer the 54 values @xmath317 and we have done so! , this takes around 217 times the time it takes to calculate the above values .",
    "this explicitly shows the `` power '' of ehrhart - macdonald reciprocity law .",
    "matthias beck , moshe cohen , jessica cuamo and paul gribelyuk . _",
    "the number of `` magic '' squares , cubes and hypercubes .",
    "_ american mathematical monthly , vol .",
    "110 , no . 8",
    "( 2003 ) , pp .",
    "707 - 717 .",
    "matthias beck and dennis pixton . _ the ehrhart polynomial of the birkhoff polytope .",
    "_ discrete comput .",
    "geom . , 30 ( 2003 ) , pp .",
    "623 - 637 .",
    "matthias beck and sinai robins .",
    "_ computing the continuous discretely .",
    "_ springer ( 2009 ) .",
    "m. e. dyer . _",
    "the complexity of vertex enumeration methods .",
    "_ mathematics of operations research , vol . 8 , no . 3 ( 1983 ) , pp . 381 - 402",
    "eugne ehrhart .",
    "_ sur un problme de gomtrie diophantienne linaire .",
    "systmes diophantiens linaires .",
    "_ j. reine angew .",
    "( 1967 ) pp .",
    "ben green and terence tao .",
    "_ quadratic uniformity of the m@xmath44bius function .",
    "_ annales de linstitut fourier ( grenoble ) 58 , no . 6 , ( 2008 ) , pp .",
    "1863 - 1935 .",
    "ben green and terence tao .",
    "_ an inverse theorem for the gowers @xmath318-norm .",
    "edinburgh math .",
    "51 , no . 1 ( 2008 ) ,",
    "ben green and terence tao .",
    "_ linear equations in primes .",
    "_ annals of math .",
    "171 , no . 3 ( 2010 ) ,",
    "pp . 1753 - 1850 .",
    "ben green and terence tao .",
    "_ the m@xmath44bius function is strongly orthogonal to nilsequences .",
    "_ annals of math .",
    "175 , no . 2 ( 2012 ) ,",
    "541 - 566 .",
    "ben green , terence tao and tamar ziegler .",
    "_ an inverse theorem for the gowers @xmath319$]-norm .",
    "_ to appear in annals of math .",
    "konrad knopp . _ theory and application of infinite series .",
    "_ blackie & son limited , ( 1928 ) , pp .",
    "218 - 229 .",
    "maurice kraitchik .",
    "_ mathematical recreations .",
    "_ london : george allen & unwin ltd , ( 1943 ) , pp .",
    "148 - 152 .",
    "t. h. matheiss and david s. rubin . _",
    "a survey and comparison of methods for finding all vertices of convex polyhedral sets . _ mathematics of operations research , vol . 5 , no . 2 ( 1980 ) , pp .",
    "167 - 185 .",
    "p. mcmullen .",
    "_ lattice invariant valuations on rational polytopes .",
    "_ arch . math .",
    "( basel ) , 31 ( 1978/79 ) , pp .",
    "509 - 516 .",
    "james e. ward iii . _",
    "vector spaces of magic squares . _ mathematics magazine , vol .",
    "53 , no . 2 ( 1980 ) , pp .",
    "108 - 111 ."
  ],
  "abstract_text": [
    "<S> based on the work of green , tao and ziegler , we give asymptotics when @xmath0 for the number of @xmath1 magic squares with their entries being prime numbers in @xmath2 $ ] . </S>",
    "<S> for every @xmath3 we give appropriate systems of linear forms ( or equivalently basis ) describing all @xmath1 magic squares with integer entries and we calculate the complexity of these systems in the green and tao sense . we compute the precise asymptotics for the cases @xmath4 ( complexity 3 ) and @xmath5 ( complexity 1 ) , and the given algorithm works for @xmath6 ( complexity 1 ) . </S>",
    "<S> finally , we show that the asymptotics are exactly the same if we impose that all the entries of the magic squares have to be different . </S>"
  ]
}