{
  "article_text": [
    "this paper addresses reduction theory for discrete mechanical systems with abelian symmetry groups and its relation to variational integration . to establish the setting of the problem ,",
    "a few aspects of the continuous theory are first recalled ( see @xcite for general background ) .    *",
    "continuous reduction theory .",
    "* consider a mechanical system with configuration manifold @xmath1 and a symmetry group @xmath2 ( with lie algebra @xmath3 ) acting freely and properly on @xmath1 and hence , by cotangent lift on @xmath4 , with corresponding ( standard , equivariant ) momentum map @xmath5 . recall from reduction theory ( see @xcite , and references therein ) that , under appropriate regularity and nonsingularity conditions , the flow of a @xmath2-invariant hamiltonian @xmath6 naturally induces a hamiltonian flow on the reduced space @xmath7 , where @xmath8 is the isotropy subgroup of a chosen point @xmath9 . in the abelian case ,",
    "if one chooses a connection @xmath10 on the principal bundle @xmath11 , then @xmath12 is symplectically isomorphic to @xmath13 carrying the canonical symplectic structure modified by magnetic terms ; that is terms induced from the @xmath14-component of the curvature of @xmath10 .",
    "the lagrangian version of this theory is also well - developed . in the abelian case",
    ", it goes by the name of _ routh reduction _ , ( see , for instance @xcite ,  8.9 ) .",
    "the reduced equations are again equations on @xmath15 and are obtained by dropping the variational principle , expressed in terms of the routhian , from @xmath1 to @xmath16 . the nonabelian version of this theory was originally developed in @xcite , with important contributions and improvements given in @xcite .",
    "of course , reduction has been enormously important for many topics in mechanics , such as stability and bifurcation of relative equilibria , integrable systems , etc .",
    "we need not review the importance of this process here as it is extensively documented in the literature .",
    "* purpose , main results , and examples .",
    "* this paper presents the theory and illustrative numerical implementation for the reduction of discrete mechanical systems with abelian symmetry groups .",
    "the discrete reduced space has a similar structure as in the continuous theory , but the curvature will be taken in a discrete sense .",
    "the paper studies two examples in detail , namely satellite dynamics in the presence of the bulge of the earth ( the @xmath17 effect ) and the double spherical pendulum ( which has a nontrivial magnetic term ) . in each case",
    "the benefit of studying the numerics of the reduced problem is shown .",
    "roughly , the reduced computations reveal dynamical structures that are hard to pick out in the unreduced dynamics in a way that is reminiscent of the phenomena of pattern evocation , as in @xcite .",
    "another interesting application of the theory is that of orbiting multibody systems , studied in @xcite .",
    "we refer to @xcite for a review of discrete mechanics , its numerical implementation , some history , as well as references to the literature .",
    "the value of geometric integrators has been documented in a number of references , such as  @xcite . in the present paper , we shall focus , to be specific , on discrete euler  lagrange and variational symplectic runge - kutta schemes and their reductions .",
    "one could , of course , use other schemes as well , such as newmark , strmer - verlet , or shake schemes .",
    "however , we wish to emphasize that _ without theoretical guidelines , coding algorithms for the reduced dynamics need not be a routine procedure since the reduced equations are not in canonical form because of nontrivial magnetic terms_. for example , using darboux theorem to put the structure into canonical form so that standard algorithms can be used is not practical . we also remind the reader that there are real advantages to taking the variational approach to the construction of symplectic integrators . for example",
    ", as in @xcite , the variational approach provides the design flexibility to take different time steps at spatially different points in an asynchronous way and still retain all the advantages of symplecticity even though the algorithms are not strictly symplectic in the naive sense ; such an approach is well - known to be useful in molecular systems , for instance .    *",
    "motivation for discrete reduction .",
    "* besides its considerable theoretical interest , there are several practical reasons for carrying out discrete routh reduction .",
    "these are as follows :    1 .",
    "features that are clear in the reduced dynamics , such as relative equilibria and relative periodic orbits , can be obscured in the unreduced dynamics , and appear more complicated through the process of reconstruction and associated geometric phases .",
    "this is related to the phenomenon of _ pattern evocation _ that is an important practical feature of many examples , such as the double spherical pendulum @xcite and the stepping pendulum @xcite .",
    "going to a suitable ( but non - obvious ) rotating frame can `` evoke '' such phenomena ( see the movie at http://www.cds.caltech.edu/~marsden/research/demos/movies/wendlandt/pattern.mpg ) .",
    "this is essentially a window to the reduced dynamics , which the theory in the present paper allows one to compute directly .",
    "2 .   while directly studying the reduced dynamics can yield some benefits , it can be difficult to code using traditional methods .",
    "in particular , the presence of magnetic terms in the reduced symplectic form , as is the case with the double spherical pendulum , means that traditional symplectic methods for canonical systems do not directly apply ; if one attempts to do so , it may result ( and has in the literature ) in many inefficient coordinate changes when evoking darboux theorem to put things into canonical form .",
    "although simulating the reduced dynamics involves an initial investment of time in computing geometric quantities symbolically , these additional terms do not appreciably affect the sparsity of the system of equations to be solved .",
    "as such , direct coding of the reduced algorithms can be quite efficient , due to its reduced dimensionality .",
    "* two obvious generalizations . *",
    "the free and proper assumption that we make on the group action means that we are dealing with _",
    "nonsingular _ , that is , _ regular _ reduction ( see @xcite for the general theory of singular reduction and references to the literature ) .",
    "it would be interesting to extend the work here to the case of singular reduction but already the regular case is nontrivial and interesting .",
    "while our examples have singular points and the dynamics near these points is interesting , there is no attempt to study this aspect in the present paper .",
    "secondly , it would be interesting to generalize the present work to the case of nonabelian groups and to develop a discrete version of nonabelian routh reduction , ( as in @xcite ) .",
    "we believe that such a generalization will require the further development of the theory of discrete connections , which is currently part of the research effort on discrete differential geometry ( see @xcite , and references therein . )",
    "other future directions are discussed in the conclusions .    * other discrete reduction results .",
    "* we briefly summarize some related results that have been obtained in the area of reduction for discrete mechanics .",
    "first of all , there is the important case of _ discrete euler - poincar and lie - poisson reduction _ that were obtained in @xcite .",
    "this theory is appropriate for rigid body mechanics , for instance .",
    "another important case is that of _ discrete semidirect product reduction _ that was obtained in @xcite and applied to the case of the heavy top , with interesting links to discrete elastica .",
    "this case is of interest in the present study since the heavy top , as with the general theory of semidirect product reduction ( see @xcite ) , one can view the @xmath18 reduction of this problem as routh reduction .",
    "linking these two approaches is an interesting topic for future research",
    ".    * outline . * after recalling the notation from continuous reduction theory ,  [ s - disred ] develops discrete reduction theory , derives a reduced variational principle , and proves the symplecticity of the reduced flow . the relationship between continuous- and discrete - time reduction",
    "is also discussed .",
    "how the variational ( and hence symplectic ) runge - kutta algorithm induces a reduced algorithm in a natural way is shown in  [ s - srkred ] . in  [ s - summary ] we put together in a coherent way the main theoretical results of the paper up to that point . in ",
    "[ s - examples ] the numerical example of satellite dynamics about an oblate earth is given , and in  [ s - examples - dsp ] , the example of the double spherical pendulum , which has a non - trivial magnetic term , is given .",
    "lastly , in  [ s - computational ] , we address some computational and efficiency issues .",
    "in this section , it is assumed that the reader is familiar with continuous reduction theory as well as the theory of discrete mechanics ; reference is made to the relevant parts of the literature as needed .",
    "it will be useful to first recall some facts about discrete mechanical systems with symmetry ( see , for instance , @xcite for proofs . )    * discrete mechanical systems with symmetry .",
    "* let @xmath2 be a lie group ( which shortly will be assumed to be abelian ) that acts freely and properly ( on the left ) on a configuration manifold @xmath1 .",
    "given a discrete lagrangian @xmath19 that is invariant under the diagonal action of @xmath2 on @xmath20 , the corresponding * _ _ * discrete momentum map @xmath21 is defined by @xmath22 where @xmath23 denotes the derivative in the second slot and where @xmath24 is the infinitesmal generator associated with @xmath25 .",
    "the map @xmath26 is equivariant with respect to the diagonal action of @xmath2 on @xmath27 and the coadjoint action on @xmath28 .",
    "the * _ _ * discrete noether theorem states that the discrete momentum is conserved along solutions of the del ( discrete euler ",
    "lagrange ) equations , @xmath29 notice that @xmath30 where @xmath31 is the momentum map on @xmath4 ; i.e. , @xmath32 where @xmath33 is the discrete legendre transform .",
    "thus , for @xmath9 , we have @xmath34 . the symplectic algorithm ( usually called the _ position - momentum form of the algorithm _ )",
    "obtained on @xmath4 from that on @xmath27 via the discrete legendre transform thus preserves the standard momentum map @xmath35 .",
    "there will be a standing assumption in this paper , namely that the given discrete lagrangian @xmath36 is * _ _ * regular ; that is , for a point @xmath37 on the diagonal , the iterated derivative @xmath38 is a non - degenerate bilinear form . by the implicit function theorem",
    ", this implies that a point @xmath39 near the diagonal and the del equations uniquely determines the subsequent point @xmath40 in a neighborhood of the diagonal in @xmath27 ( or , if one prefers , for small time steps ) ; in other words , the del algorithm is well defined by the del equations .",
    "regularity also implies that the discrete legendre transformation @xmath41 is a local diffeomorphism from a neighborhood of the diagonal in @xmath27 to a neighborhood in @xmath4 . for a detailed discussion , see @xcite .    * reconstruction . *",
    "the following lemma gives a basic result on the reconstruction of discrete curves in the configuration manifold @xmath1 from those in * _ _ * shape space , defined to be @xmath42 .",
    "the lemma is similar to its continuous counterpart , as in , for example , @xcite , lemma 2.2 . the natural projection to the quotient",
    "will be denoted @xmath43 ; @xmath44 _ g$ ] ( the equivalence class of @xmath45 ) .",
    "let @xmath46 denote the * _ _ * vertical space at @xmath47 ; namely the space of all vectors at the point @xmath47 that are infinitesimal generators @xmath48 ; or in other words , the tangent space to the group orbit through @xmath47 .",
    "we say that the discrete lagrangian @xmath36 is * _ _ * group - regular if the bilinear map @xmath38 restricted to the subspace @xmath49 is nondegenerate .",
    "_ in addition to regularity , we shall make group - regularity a standing assumption in the paper . _",
    "the following result is fundamental for what follows .",
    "[ reconstruct - lemma ] fix @xmath9 and let @xmath50 be a sufficiently closely spaced discrete curve in @xmath51 .",
    "let @xmath52 be such that @xmath53 _ g = x_0 , [ q_1 ] _ g = x_1 $ ] and @xmath54 . then there is a unique closely spaced discrete curve @xmath55 such that @xmath56 _ g = x_k$ ] and @xmath57 , for @xmath58 .",
    "we must construct a point @xmath59 close to @xmath60 such that @xmath61 _ g = x_2 $ ] and @xmath62 ; the construction of the subsequent points @xmath63 then proceeds in a similar fashion .    to do this ,",
    "pick a local trivialization of the bundle @xmath64 where locally @xmath65 and write points in this trivialization as @xmath66 and @xmath67 , etc . given the points @xmath68 with @xmath69",
    ", we seek a near identity group element @xmath70 such that @xmath71 satisfies @xmath72 . according to equation ,",
    "this means that we must satisfy the condition @xmath73 for all @xmath25 . in the local trivialization , this reads @xmath74 where @xmath75 is right translation on @xmath2 by @xmath76 .",
    "consider solving the equation @xmath77 for @xmath78 as a function of the variables @xmath79 with @xmath14 fixed . by assumption , there is a solution for the case @xmath80 , @xmath81 and @xmath82 , namely @xmath83 ( a near identity group element ) .",
    "the implicit function theorem shows that when the point @xmath84 is replaced by the nearby point @xmath85 , there will be a unique solution for @xmath78 near @xmath86 provided that the derivative of the defining relation with respect to @xmath78 at the identity is invertible , which is true by group - regularity .",
    "since group regularity is @xmath2-invariant , the above argument remains valid as @xmath87 drifts from the identity .",
    "note that the above lemma makes no hypotheses about the sequences @xmath88 or @xmath89 satisfying any discrete evolution equations .    to carry out reconstruction in the continuous case",
    ", in addition to the requirements that the lifted curve in @xmath90 lie on the momentum surface , and that it projects to the reduced curve @xmath91 under @xmath92 , one also requires that it be second - order , which is to say that it is of the form @xmath93 .",
    "if a connection is given , then the lifted curve is obtained by integrating the _ reconstruction equation_again , see @xcite for details .",
    "the discrete analogue of the second - order curve condition is explained as follows .",
    "consider a given discrete curve as a sequence of points , @xmath94 in @xmath95 .",
    "lift each of the points in @xmath95 to the momentum surface @xmath96 .",
    "this yields the sequence , @xmath97 , which is unique up to an overall diagonal group action .",
    "the discrete analogue of the second - order curve condition is that this sequence in @xmath20 defines a discrete curve in @xmath1 , which corresponds to requiring that @xmath98 , for @xmath99 , which is clearly possible in the context of the reconstruction lemma .",
    "discrete reconstruction naturally leads to issues of discrete geometric phases , and it would be interesting to express the discrete geometric phase in terms of the discrete curvature on shape space ; this will surely involve some ideas from the currently evolving subject of discrete differential geometry and so we do not attempt to push this idea further at this point .    while many of the computations we present in this paper are in the setting of local trivializations , the results are valid globally through the construction given below .",
    "* identification of the quotient space .",
    "* now assume that @xmath100 is abelian so that @xmath101 acts on @xmath102 and so that the quotient space @xmath103 makes sense .",
    "we assume the above regularity hypotheses and freeness and properness of the action of @xmath2 so that this quotient is a smooth manifold .",
    "it is clear that the map @xmath104 given by @xmath105 _",
    "g \\rightarrow ( x , x^{\\prime } ) $ ] is well - defined , where the square brackets denotes the equivalence class with respect to the given @xmath2 action , and where @xmath106 _ g$ ] .",
    "the argument given in the reconstruction lemma shows that for a point @xmath107 , @xmath108 is a local diffeomorphism in a neighborhood of the point @xmath109 _ g$ ] . in fact",
    ", the uniqueness part of that argument shows that for two nearby points @xmath110 and @xmath111 in @xmath102 , if @xmath112 and @xmath113 , then @xmath114 .",
    "thus , there is a neighborhood @xmath115 of a given a chain of closely spaced points lying in @xmath102 with this property . saturating this neighborhood with the group action",
    ", we can assume that @xmath115 is @xmath2-invariant .",
    "restricted to @xmath115 , @xmath116 becomes a diffeomorphism to a neighborhood of the diagonal of @xmath117 .",
    "assume , as above , that @xmath118 is a discrete lagrangian that is invariant under the action of an abelian lie group @xmath2 on @xmath119 .",
    "in view of the preceding discussion , @xmath120 restricted to @xmath102 ( and in the neighborhood of a given chain of points in this set ) induces a well defined function @xmath121 of pairs of points @xmath122 in @xmath123 .",
    "this * _ _ * discrete reduced lagrangian will play an important role in what follows .",
    "* discrete reduction .",
    "* let @xmath124 be a solution of the discrete euler - lagrange ( del ) equations .",
    "let the value of the discrete momentum along this trajectory be @xmath14 .",
    "let @xmath125 _",
    "g$ ] , so that @xmath126 is a discrete shape space trajectory . since @xmath127 satisfies the discrete variational principle , it is appropriate to ask if there is a reduced variational principle satisfied by @xmath128 .    an important issue in dropping the discrete variational principle to the shape space is whether we require that the varied curves are constrained to lie on the level set of the momentum map .",
    "the constrained approach is adopted in @xcite , and the unconstrained approach is used in @xcite . in the rest of this section , we will adopt the unconstrained approach of @xcite , and will show that the variations in the discrete action sum , without assuming the variations at the endpoints vanish and evaluated on a solution of the discrete euler ",
    "lagrange equations , depends only on the quotient variations , and therefore drops to the shape space without constraints on the variations .",
    "if @xmath127 is a solution of the del equations , the interior terms in the variation of the discrete action sum vanish , leaving only the boundary terms ; that is , @xmath129    given a principal connection @xmath10 on @xmath1 , there is a horizontal - vertical split of each tangent space to @xmath1 denoted @xmath130 for @xmath131 .",
    "thus , @xmath132 as in continuous routh reduction , we will rewrite the terms involving vertical variations using the fact that we are on a level set of @xmath26 .",
    "namely , write the vertical variation as @xmath133 , where @xmath134 and use the definition of @xmath26 to give @xmath135 thus , the boundary terms can be expressed as @xmath136 and so , the variation of the discrete action sum , becomes @xmath137 & &    +   \\mathfrak{a}_\\mu ( q_n)\\cdot \\delta q_n - \\mathfrak{a}_\\mu ( q_0)\\cdot \\delta q_0 ,   \\label{e - dslhatb}\\end{aligned}\\ ] ] when restricted to solutions of the discrete euler - lagrange equations .",
    "motivated by the preceding equation , introduce the 1-form @xmath138 on @xmath20 defined by @xmath139 where @xmath140 are projections onto the first and the second components respectively .",
    "this allows us to expand the boundary terms involving @xmath141 into a telescoping sum , and rewrite in terms of the @xmath142-form @xmath138 as @xmath143 & &   + d_2 l_d(q_{n-1},q_n)\\cdot \\operatorname{hor}\\,\\delta q_n .",
    "\\label{e - dvp}\\end{aligned}\\ ] ] we now drop to the reduced space @xmath95 . consider the projection maps @xmath144 , and @xmath145 , and the inclusion maps , @xmath146 , and @xmath147 . then clearly , the following diagram commutes , @xmath148^{\\iota_{\\mu , d } } \\ar[d]_{\\pi_{\\mu , d } } & q\\times q \\ar[d]^{\\pi}\\\\ \\mathbf{j}_d^{-1}(\\mu)/g \\ ; \\ar@{^{(}->}[r]^{\\tilde{\\iota}_{\\mu , d } } & ( q\\times q)/g \\\\ } \\ ] ] by the @xmath2-invariance , @xmath120 drops to a function @xmath149 on the quotient @xmath150 , so that @xmath151 .",
    "the pullback ( in this case , the restriction ) of @xmath152 to @xmath153 is called the * _ _ * discrete reduced lagrangian and is denoted @xmath154 .",
    "thus , @xmath155 ; identifying @xmath153 with @xmath123 , this definition agrees with @xmath154 as defined earlier .",
    "[ l - encapsulate - legality ] the @xmath142-form @xmath138 on @xmath20 restricted to @xmath102 , drops to a @xmath142-form @xmath156 on @xmath157 and induces , ( for closely spaced points ) , via the map @xmath116 , a @xmath142-form that we denote by the same letter , on @xmath95 .",
    "similarly , the @xmath142-form @xmath158 on @xmath20 restricted to the momentum level set @xmath102 then drops to the @xmath142-form @xmath159 on on @xmath157 and induces , via the map @xmath116 , a @xmath142-form that we denote by the same letter , on @xmath95 .",
    "the equivariance of the projections @xmath160 with respect to the diagonal action on @xmath20 and the given action on @xmath1 , together with the invariance of the 1-form @xmath141 on @xmath1 imply that @xmath138 is invariant . since @xmath141 vanishes on vertical vectors for the bundle @xmath161 , it follows that @xmath138 vanishes on vertical vectors for the bundle @xmath162 .",
    "therefore , there is a 1-form @xmath163 on @xmath150 such that @xmath164 .    since @xmath151 , and the exterior derivative commutes with pull - back",
    ", it follows that @xmath165 . from @xmath166 ,",
    "we get @xmath167 .",
    "thus , the 1-form @xmath138 restricted to @xmath168 drops to the 1-form @xmath169 on @xmath153 .",
    "similarly , @xmath170 and so @xmath171 restricted to @xmath168 drops to the 1-form @xmath172 on @xmath153 .",
    "these @xmath142-forms push forward under the map @xmath173 in the manner that was explained earlier .    with the preceding lemma , and equation ,",
    "we conclude that @xmath174 & & + d_2 l_d(q_{n-1},q_n)\\cdot \\operatorname{hor}\\,\\delta q_n .",
    "\\label{e - predr}\\end{aligned}\\ ] ] assuming that @xmath175 vanishes at the endpoints , @xmath176 , and @xmath177 and consequently , the boundary terms vanish and we obtain the * _ _ * reduced discrete variational principle , @xmath178 in an analogous fashion to rewriting @xmath179 as @xmath180 , we do the same by for the @xmath156 term by defining , @xmath181 then , equating terms involving @xmath182 on the left hand side of to the corresponding terms on the right , we get the * _ _ * discrete routh ( dr ) equations giving dynamics on @xmath95 : @xmath183 note that these equations depend on the value of momentum @xmath14 .",
    "thus , if @xmath127 is a discrete curve satisfying the discrete euler - lagrange equations , the curve @xmath128 obtained by projecting @xmath127 down to @xmath51 satisfies the dr equations .",
    "now consider the converse , the discrete reconstruction procedure : given a discrete curve @xmath128 on @xmath51 that satisfies the dr equations , is @xmath128 the projection of a discrete curve @xmath127 on @xmath1 that satisfies the del equations ?",
    "let the pair @xmath184 be a lift of @xmath185 such that @xmath186 .",
    "let @xmath187 be the solution of the del equations with initial condition @xmath184 .",
    "note that @xmath127 has momentum @xmath14 .",
    "let @xmath188 be the curve on @xmath51 obtained by projecting @xmath127 . by our arguments above",
    ", @xmath189 solves the dr equations .",
    "however @xmath189 has the initial condition @xmath185 , which is the same as the initial condition of @xmath128 . by uniqueness of the solutions of the dr equations , @xmath190 .",
    "thus @xmath128 is the projection of a solution @xmath127 of the del equations with momentum @xmath14 .",
    "also , for a given initial condition @xmath191 , there is a unique lift of @xmath128 to a curve with momentum @xmath14 .",
    "such a lift can be constructed using the method described in lemma  [ reconstruct - lemma ] .",
    "thus , lifting @xmath128 to a curve with momentum @xmath14 yields a solution of the discrete euler - lagrange equations , which projects down to @xmath128 .",
    "we summarize the results of this section in the following theorem .",
    "[ t - drr ] let @xmath128 is a discrete curve on @xmath51 , and let @xmath127 be a discrete curve on @xmath1 with momentum @xmath14 that is obtained by lifting @xmath128 .",
    "then the following are equivalent .    1 .",
    "@xmath127 solves the del equations .",
    "@xmath127 is a solution of the discrete hamilton s variational principle @xmath192 for all variations @xmath193 of @xmath127 that vanish at the endpoints .",
    "3 .   @xmath128 solves the dr equations @xmath194 4 .",
    "@xmath128 is a solution of the reduced variational principle @xmath195 for all variations @xmath175 of @xmath128 that vanish at the endpoints .",
    "note that for smooth group actions , the order of accuracy will be equal for the reduced and unreduced algorithm .",
    "the dr equations define a discrete flow map @xmath196 .",
    "we already know that the flow of the del equations preserves the symplectic form @xmath197 on @xmath20 . in this section",
    "we show that the reduced flow @xmath198 preserves a _",
    "reduced _ symplectic form @xmath199 on @xmath95 , and that this reduced symplectic form is obtained by restricting @xmath197 to @xmath168 and then dropping to @xmath95 . in other words , @xmath200 the continuous analogue of this equation is @xmath201 recall from continuous reduction theory on the hamiltonian side that in the case of cotangent bundles , the projection @xmath202 can be defined as follows : if @xmath203 , then the * _ _ * momentum shift @xmath204 annihilates all vertical tangent vectors at @xmath205 , as shown by the following calculation : @xmath206 thus , @xmath207 induces an element of @xmath208 and @xmath209 is defined to be this element .",
    "let @xmath210 be the restriction of @xmath211 to @xmath102 .",
    "thus @xmath212 , where @xmath213 and @xmath214 are inclusions .",
    "define the map @xmath215 by @xmath216 by equation   and lemma  [ l - encapsulate - legality ] , this map is well - defined",
    ". the map @xmath217 will play the role of a reduced discrete legendre transform , and in contrast to the continuous theory , the momentum shift appears in the map @xmath217 , as opposed to the projection @xmath218 . as in the continuous theory , @xmath199 does involve magnetic terms .",
    "[ l - commute ] the following diagram commutes . @xmath219^{\\mathbb{f } ' } \\ar[d]_{\\pi_{\\mu , d } } & j^{-1}(\\mu ) \\ar[d]^{\\pi_\\mu}\\\\ s\\times s \\ar[r]^{\\hat{\\mathbb{f } } } & t^*s \\\\ } \\ ] ]    let @xmath220 .",
    "thus @xmath221 , and @xmath222    as noted above , @xmath223 is the element of @xmath224 determined by @xmath225 . for @xmath226 , we have @xmath227 where in the second equality , we used lemma  [ l - encapsulate - legality ] .",
    "thus , @xmath228 which means @xmath229 .    [ t - symp ]",
    "the flow of the dr equations preserves the symplectic form @xmath230 where @xmath231 is the @xmath232-form on @xmath51 obtained by dropping @xmath233 .",
    "furthermore , @xmath199 can be obtained by dropping to @xmath95 the restriction of @xmath197 to @xmath168 . in other words ,",
    "we give an outline of the steps involved ; the details are routine to fill in .",
    "the strategy is to first show that the restriction to @xmath168 of the symplectic form @xmath197 drops to a 2-form @xmath199 on @xmath95 .",
    "the fact that the discrete flow on @xmath20 preserves the symplectic form @xmath197 is then used to show that the reduced flow preserves @xmath199 .",
    "the steps involved are as follows .    1 .",
    "consider the 1-form @xmath235 on @xmath20 defined by @xmath236 .",
    "the 1-form @xmath235 is @xmath2-invariant , and thus the lie derivative @xmath237 is zero . 2 .",
    "since @xmath238 , @xmath197 is @xmath2-invariant .",
    "if @xmath239 is the inclusion , @xmath240 and @xmath241 are the restrictions of @xmath235 and @xmath197 respectively to @xmath168 .",
    "one checks that @xmath242 and @xmath243 are invariant under the action of @xmath2 on @xmath168 .",
    "if @xmath244 is an infinitesimal generator on @xmath168 , then @xmath245 this follows from the @xmath2-invariance of @xmath242 , and the fact that @xmath246 .",
    "4 .   by steps 2 and 3",
    ", the form @xmath243 drops to a reduced form @xmath199 on @xmath247 .",
    "thus , if @xmath248 is the projection , then @xmath249 . note that the closure of @xmath199 follows from the fact that @xmath243 is closed , which in turn follows from the closure of @xmath197 and the relation @xmath241 . 5 .",
    "if @xmath250 is the flow of the del equations , let @xmath251 be the restriction of this flow to @xmath252 .",
    "we know that @xmath251 drops to the flow @xmath198 of the dr equations on @xmath95 .",
    "since @xmath253 preserves @xmath197 , @xmath251 preserves @xmath243 . using this",
    ", it can be shown that @xmath198 preserves @xmath199 .",
    "note that it is sufficient to show that @xmath254 .",
    "it now remains to compute a formula for the reduced form @xmath199 .",
    "using lemma [ l - commute ] , it follows that @xmath255 thus @xmath256 , from which it follows that @xmath257 .",
    "incidentally , this expression shows that @xmath199 is nondegenerate provided the map @xmath258 is a local diffeomorphism .",
    "one can alternatively prove symplecticity of the reduced flow directly from the reduced variational principle ",
    "see  2.3.4 of @xcite .      as shown in @xcite ,",
    "if the discrete lagrangian @xmath36 approximates the jacobi solution of the hamilton - jacobi equation , then the del equations give us an integration scheme for the el equations . in our commutative diagrams",
    "we will denote the relationship between the el and del equations by a dashed arrow as follows : @xmath259 & ( q\\times q , del).}\\ ] ] this arrow can thus be read as `` the corresponding discretization '' . by the continuous and discrete noether theorems ,",
    "we can restrict the flow of the el and del equations to @xmath260 and @xmath168 respectively .",
    "the flow on @xmath260 induces a reduced flow on @xmath261 , which is the flow of the routh equations .",
    "similarly , the discrete flow on @xmath168 induces a reduced discrete flow on @xmath262 , which is the flow of the discrete routh equations .",
    "since the del equations give us an integration algorithm for the el equations , it follows that the dr equations give us an integration algorithm for the routh equations .    to numerically integrate the routh equations , we have two options :    1 .",
    "first solve the del equations to yield a discrete trajectory on @xmath1 , which can then be projected to a discrete trajectory on @xmath51 .",
    "2 .   solve the dr equations to directly obtain a discrete trajectory on @xmath1 .",
    "either approach yields the same result , which we express by the commutative diagram : @xmath263 \\ar[d]_{\\pi_{\\mu , l } }         & ( \\mathbf{j}_d ^{-1}(\\mu),del ) \\ar[d]^{\\pi_{\\mu , d}}\\\\         ( ts , r ) \\ar@{-->}[r ] & ( s\\times s , dr ) } \\ ] ]",
    "a well - studied class of numerical schemes for hamiltonian and lagrangian systems is the symplectic partitioned runge - kutta ( sprk ) algorithms ( see @xcite for history and details ) .",
    "we will adopt a local trivialization to express the sprk method in which the group action is addition . given a connection @xmath10 on @xmath1 , it can be represented in local coordinates as @xmath264 by rewriting the symplectic partitioned runge - kutta algorithm in terms of this local trivialization , and using the local representation of the connection , we obtain the following algorithm on @xmath265 : @xmath266\\\\ \\fl\\qquad x_i&=x_0+h\\sum a_{ij } \\dot{x}_j\\\\ \\fl\\qquad s_i&=s_0+h\\sum_j\\tilde{a}_{ij}\\dot{s}_j + \\left [ h \\sum_j \\left ( \\tilde{a}_{ij } \\mu \\frac{\\partial a}{\\partial x } ( x_j)\\dot{x}_j\\right)-\\left(\\mu a(x_i)-\\mu a(x_0)\\right)\\right]\\\\ \\fl\\qquad s_j&=\\frac{\\partial \\hat{r}^\\mu}{\\partial \\dot{x}}(x_j,\\dot{x}_j)\\\\ \\fl\\qquad \\dot{s}_j&= \\frac{\\partial \\hat{r}^\\mu}{\\partial x}(x_j,\\dot{x}_j ) -i_{\\dot{x}_j}\\beta_\\mu(x_j),\\label{e - rsrk - end}\\end{aligned}\\ ] ] this system of equations is called the * _ _ * reduced symplectic partitioned runge - kutta ( rsprk ) algorithm . a detailed derivation can be found in  2.5 of @xcite . as we obtained this system by dropping the symplectic partitioned runge - kutta algorithm from @xmath267 to @xmath265 , it follows that this algorithm preserves the reduced symplectic form @xmath268 on @xmath265 .",
    "since the sprk algorithm is an integration algorithm for the hamiltonian vector field @xmath269 on @xmath4 , the rsprk algorithm is an integration algorithm for the reduced hamiltonian vector field @xmath270 on @xmath265 .",
    "the relationship between cotangent bundle reduction and the reduction of the sprk algorithm can be represented by the following commutative diagram : @xmath271_{\\pi_{\\mu}}\\ar@{-->}[r ] & ( j^{-1}(\\mu),sprk ) \\ar[d]^{\\pi_{\\mu}}\\\\ ( t^*s , x_{h_\\mu } ) \\ar@{-->}[r ] & ( t^*s , rsprk ) } \\ ] ] the dashed arrows here denote the corresponding discretization , as in .",
    "the sprk algorithm can be obtained by pushing forward the del equations by the discrete legendre transform .",
    "see , for example , @xcite .",
    "by lemma [ l - commute ] , this implies that the rsprk algorithm can be obtained by pushing forward the dr equations by the reduced discrete legendre transform @xmath272 .",
    "these relationships are shown in the following commutative diagram : @xmath273^{\\mathbb{f}l_d } \\ar[d]_{\\pi_{\\mu , d } } & ( j^{-1}(\\mu),sprk ) \\ar[d]^{\\pi_\\mu } \\\\ ( s\\times s , dr ) \\ar[r]^{\\hat{\\mathbb{f } } } & ( t^*s , rsprk ) } \\ ] ]",
    "the relationship between routh reduction and cotangent bundle reduction can be represented by the following commutative diagram : @xmath274^{\\mathbb{f}l } \\ar[d]_{\\pi_{\\mu , l } } & ( j^{-1}(\\mu),x_h ) \\ar[d]^{\\pi_{\\mu}}\\\\ ( ts , r ) \\ar[r]^{\\mathbb{f}\\hat{r}^{\\mu } } & ( t^{*}s , x_{h_{\\mu } } ) } \\ ] ] we saw in  [ s - discts ] that if @xmath36 approximates the jacobi solution of the hamilton - jacobi equation , discrete and continuous routh reduction is related by the following diagram : @xmath275 \\ar[d]_{\\pi_{\\mu , l } } & ( j^{-1}_d(\\mu),del ) \\ar[d]^{\\pi_{\\mu , d}}\\\\ ( ts , r ) \\ar@{-->}[r ] & ( s\\times s , dr ) } \\ ] ] the dashed arrows mean that the del equations are an integration algorithm for the el equations , and that the dr equations are an integration algorithm for the routh equations .    pushing forward the del equation using the discrete legendre transform @xmath211 yields the sprk algorithm on @xmath4 , which is an integration algorithm for @xmath269 .",
    "this is depicted by : @xmath275 \\ar[d]_{\\mathbb{f}l } & ( j^{-1}_d(\\mu),del ) \\ar[d]^{\\mathbb{f}l_d}\\\\ ( j^{-1}(\\mu),x_h ) \\ar@{-->}[r ] & ( j^{-1}(\\mu),sprk ) } \\ ] ] the sprk algorithm on @xmath276 induces the rsprk algorithm on @xmath277 . as we saw in  [ s - srkred ] , this reduction process is related to cotangent bundle reduction and to discrete routh reduction as shown in the following diagram : @xmath278 \\ar[d]_{\\pi_{\\mu } } & ( j^{-1}(\\mu),sprk ) \\ar[d]^{\\pi_{\\mu } } & ( j^{-1}_d(\\mu),del ) \\ar[l]_{\\mathbb{f}l_d } \\ar[d]^{\\pi_{\\mu , d}}\\\\ ( t^{*}s , x_{h_{\\mu } } ) \\ar@{-->}[r ] & ( t^{*}s , rsprk ) & ( s\\times s , dr)\\ar[l]_{\\hat{\\mathbb{f } } } } \\ ] ] putting all the above commutative diagrams together into one diagram , we obtain figure [ fig : diagram ] .    @xmath279        \\ar'[d][dd]_{\\pi_{\\mu } } & & j^{-1}(\\mu),sprk \\ar[dd]^{\\pi_{\\mu } } \\\\",
    "j_l^{-1}(\\mu),el \\ar@{-->}[rr ] \\ar[ur]^{\\mathbb{f}l }        \\ar[dd]_{\\pi_{\\mu , l } } & & \\mathbf{j}_d ^{-1}(\\mu),del        \\ar[ur]^{\\mathbb{f}l_d } \\ar[dd]_(0.75){\\pi_{\\mu , d } } \\\\        & t^*s , x_{h_{\\mu } } \\ar@{-->}'[r][rr ] & & t^*s , rsprk \\\\",
    "ts , r \\ar@{-->}[rr ] \\ar[ur]^{\\mathbb{f}\\hat{r}^{\\mu } }        & & s \\times s , dr \\ar[ur]_{\\hat{\\mathbb{f } } }        } \\ ] ]",
    "an illustrative and important example of a system with an abelian symmetry group is that of a single satellite in orbit about an oblate earth .",
    "the general aspects and background for this problem are discussed in @xcite , and some interesting aspects of the geometry underlying it , are discussed in @xcite .",
    "the configuration manifold @xmath1 is @xmath280 , and the lagrangian is @xmath281 where @xmath282 is the mass of the satellite and @xmath283 is the gravitational potential due to the earth truncated at the first term in the expansion in the ellipticity @xmath284 here , @xmath2 is the gravitational constant , @xmath285 is the mass of the earth , @xmath286 is the radius of the earth , @xmath0 is a small non - dimensional parameter describing the degree of ellipticity , and @xmath287 is the third component of @xmath47 . in non -",
    "dimensional coordinates , @xmath288.\\ ] ] this corresponds to choosing space and time coordinates in which the radius of the earth is @xmath142 and the period of orbit at zero altitude is @xmath289 when @xmath290 ( spherical earth ) .",
    "the symmetry of interest to us is that of rotation about the vertical ( @xmath287 ) axis , so the symmetry group is the unit circle @xmath291 .",
    "using cylindrical coordinates @xmath292 for the configuration , the symmetry action is @xmath293 . since @xmath294 , @xmath295 , and",
    "@xmath296 are all invariant under this transformation , so too is the lagrangian .",
    "this action is clearly not free on all of @xmath297 , as the @xmath298-axis is invariant for all group elements .",
    "this is not a serious obstacle as the lifted action is free on @xmath299 and this is enough to permit the application of the intrinsic routh reduction theory .",
    "alternatively , one can simply take @xmath300 and then the theory literally applies .",
    "the shape space @xmath301 is thus the half - plane @xmath302 and we will take coordinates @xmath303 on @xmath51 . in doing so , we are implicitly defining a global diffeomorphism @xmath304 given by @xmath305 .",
    "the lie algebra @xmath3 for @xmath306 is the real line @xmath307 , and we will identify the dual with the real line itself @xmath308 . for a lie algebra element @xmath25 , the corresponding infinitesimal generator is given by @xmath309 the lagrange momentum map @xmath310 is given by @xmath311 which in our case is a scalar quantity , the vertical component of the standard angular momentum : @xmath312    consider the euclidean metric on @xmath280 , which corresponds to the kinetic energy norm in the lagrangian . from this metric",
    "we define the mechanical connection @xmath313 given by @xmath314 .",
    "the @xmath142-form @xmath315 on @xmath1 is thus given by @xmath316 .",
    "the exterior derivative of this expression gives @xmath317 , and so the reduced @xmath232-form is @xmath318 .",
    "the euler - lagrange equations for the lagrangian gives the equations of motion , @xmath319.\\ ] ] to calculate the reduced equations , we begin by calculating the routhian @xmath320 - \\mu\\dot{\\theta}.\\end{aligned}\\ ] ] we choose a fixed value @xmath14 of the momentum and restrict ourselves to the space @xmath260 , on which @xmath321 .",
    "the reduced routhian @xmath322 is the restricted routhian dropped to the tangent bundle of the shape space . in",
    "coordinates this is @xmath323 - \\frac{1}{2}\\mu^2.\\ ] ] recalling that @xmath318 , the routh equations can be evaluated to give @xmath324,\\ ] ] which describes the motion on the shape space .    to recover the unreduced euler - lagrange equations from the routh equations one uses the procedure of reconstruction",
    "this is covered in detail in @xcite .",
    "we discretize this system with a high - order discrete lagrangian . recall that the pushforward discrete lagrange map associated with this discrete lagrangian is a symplectic partitioned runge - kutta method .",
    "given a point @xmath325 we will take @xmath326 and @xmath327 to be the associated discrete legendre transforms . as the discrete momentum map is the pullback of the canonical momentum map , we have that @xmath328 take a fixed momentum map value @xmath14 and restrict @xmath36 to the set @xmath329 . dropping this to @xmath117",
    "now gives the reduced discrete lagrangian @xmath330 .",
    "more explicitly , @xmath36 depends on @xmath331 and @xmath332 , but group invariance implies that the group variables only enters in the combination @xmath333 .",
    "the condition @xmath334 can be inverted to eliminate the dependence of @xmath36 on @xmath333 , and @xmath36 can be expressed in terms of @xmath14 , @xmath335 , and @xmath336 , which yields @xmath154 .    as discussed in  [ s - srkred ]",
    ", the fact that we have taken coordinates in which the group action is addition in @xmath337 means that the pushforward discrete lagrange map associated with the reduced discrete lagrangian is the reduced method given by ( [ e - rsrk - start]-[e - rsrk - end ] ) .",
    "in fact , as the mechanical connection has @xmath338 and @xmath339 , the pushforward discrete lagrange map is exactly a partitioned runge - kutta method with hamiltonian equal to the reduced routhian .",
    "these are generically related by a momentum shift , rather than being equal .    given a trajectory of the reduced discrete system",
    ", we can reconstruct the unreduced discrete trajectory by solving for @xmath337 .",
    "correspondingly , a trajectory of the unreduced discrete system can be projected onto shape space to give a trajectory of the reduced discrete system .",
    "we compute the unreduced trajectories using the fourth - order sprk algorithm , and the reduced trajectories using the corresponding fourth - order rsprk algorithm .",
    "* solutions of the spherical earth system . *",
    "consider initially the system with @xmath290 .",
    "this corresponds to the case of a spherical earth , and so the equations reduce to the standard kepler problem .",
    "a slightly inclined circular trajectory is shown in figure [ fig : spherical ] , in both the unreduced and reduced pictures .",
    "note that the graph of the reduced trajectory is a quadratic , as @xmath340 is a constant .",
    "( spherical earth ) .",
    "[ fig : spherical],width=377 ]    we will now investigate the effect of two different perturbations to the system , one due to taking non - zero @xmath0 and the other due to the numerical discretization .    * the @xmath0 effect . * taking @xmath341 ( which is close the actual value for the earth ) , the system becomes near - integrable and experiences breakup of the kam tori .",
    "this can be seen in figure [ fig : j2 ] , where the same initial condition is used as in figure [ fig : spherical ] .    .",
    "observe that the non - spherical terms introduce precession of the near - elliptic orbit in the symmetry direction .",
    "[ fig : j2],width=377 ]    due to the fact that the reduced trajectory is no longer a simple curve , there is a geometric - phase - like effect which causes precession of the orbit .",
    "this precession can be seen in the thickening of the unreduced trajectory .",
    "* solutions of the discrete system for a spherical earth .",
    "* we now consider the discrete system with @xmath290 , for the second order gauss - legendre discrete lagrangian with stepsize of @xmath342 .",
    "the trajectory with the same initial condition as above is given in figure [ fig : spherical_numerical ] .     and",
    "the initial condition is the same as that used in figure [ fig : spherical ] .",
    "the numerically introduced precession means that the unreduced picture looks similar to that of figure [ fig : j2 ] with non - zero @xmath0 , whereas only by considering the reduced picture we can see the correct resemblance to the @xmath343 case of figure [ fig : spherical ] .",
    "[ fig : spherical_numerical],width=377 ]    as can be seen from the reduced trajectory , the discretization has caused a similar breakup of the periodic orbit as was produced by the non - zero @xmath0 .",
    "this induces precession of the orbit in the unreduced trajectory , in a way which is difficult to distinguish from the perturbation above due to non - zero @xmath0 if only the unreduced picture is considered . if the reduced pictures are consulted , however , then it is immediately clear that the system is much closer to the continuous time system with @xmath290 than to the system with non - zero @xmath0 .",
    "* solutions of the discrete system with @xmath0 effect . *",
    "finally , we consider the discrete system with non - zero @xmath341 .",
    "the resulting trajectory is shown in figure [ fig : j2_numerical ] , and it is clearly not easy to determine from the unreduced picture whether the precession is due to the @xmath0 perturbation , the discretization , or some combination of the two .     and",
    "the initial condition is the same as that used in figure [ fig : j2 ] .",
    "the unreduced picture is similar to that of both figures [ fig : j2 ] and [ fig : spherical_numerical ] . by considering the reduced picture the correct resemblance to [ fig : j2 ] .",
    "[ fig : j2_numerical],width=377 ]    taking the reduced trajectories , however , immediately shows that this discrete time system is structurally much closer to the non - zero @xmath0 system than to the original @xmath290 system .",
    "this confusion arises because both the @xmath0 term and the discretization introduce perturbations which act in the symmetry direction .",
    "while this system is sufficiently simple that one can run simulations with such small timesteps that the discretization artefacts become negligible , this is certainly not generally possible .",
    "this example demonstrates how knowledge of the geometry of the system can be important in understanding the discretization process , and how this can give insight into the behavior of numerical simulations .",
    "in particular , understanding how the discretization interacts with the symmetry action is extremely important .      in this example",
    "we have chosen cylindrical coordinates , thus making the group action addition in @xmath337 .",
    "one can always do this , as an abelian lie group is isomorphic to a product of copies of @xmath344 and @xmath291 , but it may sometimes be preferable to work in coordinates in which the group action is not addition .",
    "for example , cartesian coordinates in the present example .",
    "reasons for choosing a different coordinate system might include ease of computation , or simplicity of the expressions .    if we adopt a coordinate system wherein the group action is not expressed in terms of addition , the rsprk method is not applicable , but we can still apply the discrete routh equations to obtain an integration scheme on @xmath95 .",
    "the push forward of this under @xmath217 yields an integration scheme on @xmath265 .",
    "the trajectories on the shape space that we obtain in this manner could be different from those we would get with the rsprk method .",
    "however , in both cases we would have conservation of symplectic structure , momentum , and the order of accuracy would be the same",
    ". one could choose whichever approach is cheaper and easier .",
    "we consider the example of the double spherical pendulum which has a non - trivial magnetic term and constraints .",
    "the configuration manifold @xmath1 is @xmath345 , and the embedding linear space @xmath346 is @xmath347 .",
    "the position vectors of each pendulum with respect to the pivot point are denoted by @xmath348 and @xmath349 .",
    "these vectors are constrained to have lengths @xmath350 and @xmath351 respectively , and the pendula masses are denoted by @xmath352 and @xmath353 .",
    "the lagrangian is @xmath354 where @xmath76 is the gravitational constant , and @xmath355 is the unit vector in the @xmath298 direction . the constraint function @xmath356 is given by , @xmath357 using cylindrical coordinates @xmath358 , @xmath359 becomes @xmath360 where @xmath361 .",
    "furthermore , we can automatically satisfy the constraints by performing the substitutions , @xmath362 , and @xmath363 .",
    "the symmetry of interest to us is the simultaneous rotation of the two pendula about vertical ( @xmath298 ) axis , so the symmetry group is the unit circle @xmath291 . using cylindrical coordinates @xmath364 for the configuration , the symmetry action is @xmath365 . since @xmath366 , @xmath367 , @xmath368 , and @xmath369",
    "are all invariant under this transformation , so too is the lagrangian .",
    "this action is clearly not free on all of @xmath370 , as the @xmath298-axis is invariant for all group elements .",
    "however , this does not pose a problem computationally , as long as the trajectories do not pass through the downward hanging configuration , corresponding to @xmath371 . to treat the downward handing configuration properly",
    ", we would need to develop a discrete lagrangian analogue of the continuous theory of singular reduction described in @xcite .",
    "we will now show the geometric structures involved in implementing the rsprk algorithm .",
    "2.10.2 of @xcite for a detailed derivation .",
    "the lie algebra @xmath3 for @xmath306 is the real line @xmath307 , and we will identify the dual with the real line itself @xmath308 . for a lie algebra element @xmath25 , the corresponding infinitesimal generator is given by @xmath372 as such , the momentum map is given by @xmath373 which is simply the vertical component of the standard angular momentum .",
    "the locked inertia tensor is given by @xcite , @xmath374 the mechanical connection as a @xmath142-form is given by @xmath375^{-1 } \\left[\\left ( m_1+m_2\\right ) r_1 ^ 2\\mathbf{d}\\theta_1+m_2 r_2 ^ 2\\mathbf{d } \\theta_2\\right.\\\\ \\fl\\qquad\\qquad\\qquad\\left.+m_2 r_1 r_2 \\left ( \\mathbf{d}\\theta_1+\\mathbf{d}\\theta_2\\right ) \\cos",
    "\\varphi + \\left ( r_1 \\mathbf{d}r_2-r_2\\mathbf{d}r_1\\right ) \\sin \\varphi \\right].\\end{aligned}\\ ] ] the @xmath14-component of the mechanical connection is given by , @xmath376^{-1}\\\\ \\fl\\qquad\\qquad\\qquad\\times\\left\\{\\left[\\left ( m_1+m_2\\right ) r_1 ^ 2+m_2 r_1 r_2 \\cos \\varphi \\right ] \\mathbf{d}\\theta_1 + \\left [ m_2 r_2 ^ 2+m_2 r_1 r_2 \\cos \\varphi \\right ] \\mathbf{d}\\theta_2\\right\\}.\\end{aligned}\\ ] ] taking the exterior derivative of this @xmath142-form yields a non - trivial magnetic term on the reduced space , which drops to the quotient space to yield , @xmath377 \\\\ \\fl\\qquad\\qquad\\qquad\\times\\left [ m_1 r_1 ^ 2+m_2\\left ( r_1 ^ 2+r_2 ^ 2 + 2 r_1 r_2 \\cos\\varphi \\right ) \\right]^{-2 } \\mathbf{d}\\varphi\\wedge(r_2\\mathbf{d}r_1-r_1\\mathbf{d}r_2).\\end{aligned}\\ ] ] the local representation of the connection is given by @xmath378^\\mathrm{t},\\ ] ] and the amended potential @xmath379 has the form @xmath380\\\\",
    "\\fl\\qquad\\qquad\\qquad+2^{-1}\\mu^2   [ m_1 r_1 ^ 2+m_2(r_1 ^ 2+r_2 ^ 2 + 2r_1 r_2 \\cos\\varphi ) ] ^{-1}.\\end{aligned}\\ ] ] the routhian on the momentum level set is given by , @xmath381 recall that @xmath382 , where @xmath383 , and @xmath384 .",
    "then we obtain , @xmath385 the kinetic energy metric has the form @xmath386\\ ] ] this together with the expression for @xmath387 allows us to compute @xmath388 , and when combined with the formula for the amended potential @xmath379 gives the routhian @xmath389 .",
    "notice that all our expressions are in terms of the reduced variables on @xmath390 , so they trivially drop to yield @xmath391 .",
    "these expressions can then be directly substituted into the rsprk algorithm in equations ( [ e - rsrk - start]-[e - rsrk - end ] ) to obtain the example trajectories presented in the next subsection .",
    "we have computed the reduced trajectory of the double spherical pendulum using the fourth - order rsprk algorithm on the routh equations .",
    "we first consider the evolution of @xmath392 , @xmath393 , and @xmath394 , using the rsprk algorithm on the routh equations , as well as the projection of the relative position of @xmath353 with respect to @xmath352 onto the @xmath395 plane as seen in figure [ fig : rsprk ] .",
    "figure [ fig : energy_compare ] illustrates that the energy behavior of the trajectory is very good , as is typical of variational integrators , and does not exhibit a spurious drift .",
    "in contrast , the non - symplectic fourth - order runge - kutta applied to the unreduced dynamics has a systematic drift in the energy , even when using time - steps that are smaller by a factor of four .    , @xmath393 , @xmath394 , and the trajectory of @xmath353 relative to @xmath352 using rsprk.,width=377 ]     using rsprk ( left ) compared to the relative energy drift in a non - symplectic rk ( right).,width=377 ]",
    "* reduced vs. unreduced simulations . *",
    "the reduced dynamics can either be computed directly , by using the discrete routh or rsprk equations , or by computing in the unreduced space , and projecting onto the shape space .",
    "we discuss the relative merits of these approaches .    given a configuration space and symmetry group of dimensions @xmath396 and @xmath397 , respectively , we can either use a simpler algorithm in @xmath398 dimensions , or a more geometrically involved algorithm in @xmath399 dimensions . the reduced algorithm",
    "involve curvature terms that need to be symbolically precomputed , but these do not affect the sparsity of the system of equations , and the lower dimension results in computational saving that are particularly evident in the repeated , or long - time simulation of problems with a shape space of high codimension .",
    "an example which is of current engineering interest is the dynamics of connected networks of systems with their own internal symmetries , such as coordinated clusters of satellites modeled as rigid bodies with internal rotors .",
    "if the systems to be connected are all identical , the geometric quantities that need to be computed , such as the mechanical connection , have a particularly simple repeated form , and the small additional upfront effort in implementing the reduced algorithm can result in substantial computational savings due to the lower dimension of the reduced system .    *",
    "intrinsic vs.  non - intrinsic methods .",
    "* non - intrinsic numerical schemes , such as sprk applied to the classical routh equations , can have undesirable numerical properties due to the need for coordinate dependent local trivializations and the presence of coordinate singularities in these local trivializations , as is the case when using euler angles for rigid body dynamics .    in the case of non - canonical symplectic forms ,",
    "frequent computationally expensive coordinate changes are necessary when using standard non - intrinsic schemes , as documented in @xcite , due to the need to repeatedly apply darboux theorem to put the symplectic structure into canonical form .",
    "in contrast , intrinsic methods do not depend on a particular choice of coordinate system , and allow for the use of global charts through the use of containing vector spaces with constraints enforced using lagrange multipliers .",
    "coordinate singularities can affect the quality of the simulation in subtle ways that may depend on the numerical scheme . in the simulation of the double spherical pendulum , we notice spikes in the energy corresponding to times when @xmath392 or @xmath393 are close to @xmath400 .",
    "these errors accumulate in the non - symplectic method , but remain well - behaved in the symplectic method . alternatively",
    ", sharp spikes can be avoided altogether by evolving the equations on a constraint surface in @xmath401 , as opposed to choosing local coordinates that automatically satisfy the constraints . here",
    ", the increased cost of working in the containing linear space with constraints is offset by not having to transform between charts of @xmath402 , which can be significant if the trajectories are chaotic .",
    "an extensive discussion of the issue of representations and parametrizations of rotation groups and its implications for computation can be found in @xcite .",
    "methods which exhibit local conservation properties on each chart , may still exhibit a drift in the conserved quantity across coordinate changes . as discussed in @xcite , only methods in which the local representatives of the algorithm commute with coordinate changes exhibit geometric conservation properties that are robust .",
    "in particular , intrinsic methods retain their conservation properties through coordinate changes .",
    "another promising approach is to use the exponential map to update the numerical solution , which is the basis of lie group integrators , see  @xcite .",
    "the lie group approach can yield rigid body integrators that are embedded in the space of @xmath403 matrices but automatically evolve on the rotation group , without the use of constraints or reprojection . in @xcite , analogues of the explicit newmark and midpoint lie algorithm",
    "are presented that automatically stay on the rotation group , and exhibit good energy and momentum stability . a method based on generating functions and the exponential on riemannian manifolds",
    "is introduced in @xcite . in the variational",
    "setting , a lie group variational integrator for rigid body dynamics is described in @xcite , and higher - order generalizations can be found in @xcite .",
    "this paper derives the discrete routh equations on the discrete shape space @xmath95 , which are symplectic with respect to a non - canonical symplectic form , and retains the good energy behavior typically associated with variational integrators .",
    "furthermore , when the group action can be expressed as addition , we obtain the reduced symplectic partitioned runge - kutta algorithm on @xmath265 , that can be considered as a discrete analogue of cotangent bundle reduction . by providing an understanding of how the reduced and unreduced formulations are related at a discrete level , we enable the user to freely choose whichever formulation is most appropriate , and provides the most insight to the problem at hand .",
    "certainly one of the obvious things to do in the future is to extend discrete reduction to the case of nonabelian symmetry groups following the nonabelian version of routh reduction given in @xcite .",
    "there are also several problems , including the averaged @xmath17 problem , in which one can carry out discrete reduction by stages and relate it to the semidirect product work of @xcite .",
    "this is motivated by the fact that the semidirect product reduction theory of @xcite is a special case of reduction by stages ( at least without the momentum map constraint ) , as was shown in @xcite .    in further developing discrete reduction theory ,",
    "the discrete theory of connections on principal bundles developed in @xcite is particularly relevant , as it provides an intrinsic method of representing the reduced space @xmath150 as @xmath404 , where @xmath405 with @xmath2 acting by conjugation on @xmath2 .",
    "indeed , such a construction can be viewed as a connection on a lie groupoid , and it is natural to express discrete mechanics on @xmath20 in the language of pair groupoids , as originally proposed in @xcite .",
    "generalizations of this approach to arbitrary lie groupoids , as well as a discussion of the role of discrete connections in yielding a discrete analogue of the lagrange - poincar equations , can be found in @xcite .",
    "another component that is needed in this work is a good discrete version of the calculus of differential forms .",
    "note that in our work we found , being directed by mechanics , that the right discrete version of the magnetic @xmath232-form is the difference of two connection @xmath142-forms .",
    "it is expected that we could recover such a magnetic @xmath232-form by considering the discrete exterior derivative of a discrete connection form in a finite discretization of space - time , and taking the continuum limit in the spatial discretization .",
    "developing a discrete analogue of stokes theorem would also provide insight into the issue of discrete geometric phases .",
    "some preliminary work on a discrete theory of exterior calculus can be found in @xcite .",
    "we gratefully acknowledge helpful comments and suggestions of alan weinstein and the referees .",
    "smj supported in part by isro and drdo through the nonlinear studies group , indian institute of science , bangalore .",
    "ml supported in part by nsf grant dms-0504747 , and a faculty grant and fellowship from the rackham graduate school , university of michigan .",
    "jem supported in part by nsf itr grant aci-0204932 .",
    "40                      hairer , e. , s.  nrsett , and g.  wanner [ 1993 ] , _ solving ordinary differential equations i : nonstiff problems _ , volume  8 of _ springer series in computational mathematics_. springer - verlag , second edition .",
    "hairer , e. and g.  wanner [ 1996 ] , _ solving ordinary differential equations ii : stiff and differential - algebraic problems _ , volume  14 of _ springer series in computational mathematics_. springer - verlag , second edition .",
    "lee , t.  y. , m.  leok , n.  h. mcclamroch [ 2005 ] , a lie group variational integrator for the attitude dynamics of a rigid body with applications to the 3d pendulum , _ proc .",
    "ieee conf . on control applications _ , 962967 .",
    "marsden , j.  e. , j.  scheurle , and j.  wendlandt [ 1996 ] , visualization of orbits and pattern evocation for the double spherical pendulum . in kirchgssner ,",
    "k. , o.  mahrenholtz , and r.  mennicken , editors , _ iciam 95 : mathematical research _ ,",
    "volume  87 , pages 213232 .",
    "academie verlag .",
    "patrick , g. [ 1991 ] , _ two axially symmetric coupled rigid bodies : relative equilibria , stability bifurcations , and a momentum preserving symplectic integrator _ , phd thesis , university of california at berkeley ."
  ],
  "abstract_text": [
    "<S> this paper develops the theory of abelian routh reduction for discrete mechanical systems and applies it to the variational integration of mechanical systems with abelian symmetry . </S>",
    "<S> the reduction of variational runge - kutta discretizations is considered , as well as the extent to which symmetry reduction and discretization commute . </S>",
    "<S> these reduced methods allow the direct simulation of dynamical features such as relative equilibria and relative periodic orbits that can be obscured or difficult to identify in the unreduced dynamics .    </S>",
    "<S> the methods are demonstrated for the dynamics of an earth orbiting satellite with a non - spherical @xmath0 correction , as well as the double spherical pendulum . </S>",
    "<S> the @xmath0 problem is interesting because in the unreduced picture , geometric phases inherent in the model and those due to numerical discretization can be hard to distinguish , but this issue does not appear in the reduced algorithm , where one can directly observe interesting dynamical structures in the reduced phase space ( the cotangent bundle of shape space ) , in which the geometric phases have been removed .    </S>",
    "<S> the main feature of the double spherical pendulum example is that it has a nontrivial magnetic term in its reduced symplectic form . </S>",
    "<S> our method is still efficient as it can directly handle the essential non - canonical nature of the symplectic structure . </S>",
    "<S> in contrast , a traditional symplectic method for canonical systems could require repeated coordinate changes if one is evoking darboux theorem to transform the symplectic structure into canonical form , thereby incurring additional computational cost . </S>",
    "<S> our method allows one to design reduced symplectic integrators in a natural way , despite the noncanonical nature of the symplectic structure . </S>"
  ]
}