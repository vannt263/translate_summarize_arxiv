{
  "article_text": [
    "modified gravity theories @xcite are proposed as alternative to the dark energy scenarios @xcite to explain the observed accelerating expansion of our universe @xcite , and have attracted a lot of research interest recently . instead of invoking some sort of mysterious new energy component which drives the dynamics of the cosmos , these theories suggest that the universe is filled with only normal plus dark matter ( which is usually assumed to be cold ) , but the law of gravity can be different from that of standard general relativity ( gr ) on large scales , leading to the speed - up of the expansion rate .",
    "since the law of gravity is considered as universal , a modification to gr on large scales almost necessarily implies corresponding changes in the behaviour on small scales .",
    "any such changes from gr , however , is already highly constrained by numerous local tests of gravity @xcite , and this has rendered many models incompatible with experimental bounds .",
    "thus , any viable modified gravity theory should have some mechanism by which such modifications are suppressed and gr is restored in high - density regions such as the solar system , where those experiments have been carried out and the resulted bounds apply .",
    "such mechanisms are commonly referred to as ` screening mechanisms ' in the literature .",
    "obviously , to make the model theoretically appealing , the screening mechanism needs to be an inherent ( rather than add - on ) property of it , which comes from the dynamics of the theory .",
    "the screening effect means that gravity behaves in different manners in different environments , and such environmental dependence often boils down to a high degree of nonlinearity in the relevant field equations , which makes the study of such theories rather challenging and ( numerically ) demanding .    in most modified gravity theories studied so far",
    ", the modification to gr is realised by a dynamical scalar - type ( spin-0 ) field , which mediates the modified gravitational force .",
    "these theories could be roughly divided into two classes . in the first class of such theories ,",
    "the screening is achieved by nonlinear couplings of the scalar field to matter and/or a nonlinear potential governing the self - interaction of the scalar field .",
    "if the coupling and potential are appropriately specified , the scalar field may acquire a very heavy mass in dense regions , making it hardly propagating or mediating any force between matter particles , or extremely weakly coupled to matter such that the resulted modification to gr very small .",
    "the chameleon models @xcite , with @xmath0 gravity model @xcite ( see also @xcite ) as a special example , belong to the former case , while the dilaton @xcite and symmetron @xcite models belong to the latter case . in these models , @xmath0 gravity ( mainly the model of @xcite ) has been the most well - studied , and there have been many works which studied in detail its structure formation in the nonlinear regime , with the aid of @xmath1-body simulations @xcite . during this process , we have developed an efficient @xmath1-body code , ecosmog @xcite , based on the publicly available code ramses @xcite , which is massively parallelised using mpi and therefore makes large simulations for @xmath0 gravity possible . using the generic parameterisation for modified gravity theories of the first class @xcite , ecosmog has been recently extended to simulate general chameleon , dilaton and symmetron cosmologies @xcite .",
    "the other class of modified gravity theories involving scalar degrees of freedom , with the dvali - gabadadze - porrati ( dgp ) brane - world model @xcite as the most well - known example , realises the screening using nonlinear derivative self - couplings of a scalar field . here",
    ", the nonlinearity makes the gravitational fields of individual particle interfere so that the deviation from gr per particle is weakened in a collection of particles compared with that for an isolated particle .",
    "this is known as the vainshtein mechanism @xcite in the literature , which was originally introduced in the context of massive gravity to suppress the extra helicity modes of massive graviton to recover gr in the massless limit .",
    "the vainshtein mechanism occurs not only in the recently proposed nonlinear massive gravity @xcite and braneworld models but also in more general setups , such as the galileon model @xcite .",
    "the cosmological implications of the galileon model have been studied by many groups ( see , e.g.,@xcite ) in details . however , to date studies of large - scale structure formation in the nonlinear regime , even for the simplest case of dgp , have been very limited .",
    "the primary reason is that the field equations for these theories generally involve high products of second - order derivatives ( see below ) , which make them difficult to solve numerically .",
    "there have been a few works on @xmath1-body simulations for dgp @xcite , but these are so far limited to codes which , unlike ecosmog , have no mesh refinements . furthermore , for the code to solve the dgp equation one may have to smooth the underlying density field to reduce the noise , which certainly limits the force resolution of the simulations .    in this paper , we report the development and initial results of a new @xmath1-body code , ecosmog - v , which is a sibling version of ecosmog but for simulations of theories involving the vainshtein screening .",
    "we have made various tests of the code to be confident about its accuracy and reliability . using this code , we have studied the matter and velocity density fields in the self - accelerating branch of the dgp model .",
    "we find good agreement of our matter power spectrum with that of previous work @xcite , but the code enables us to go to even smaller scales and discover new interesting features .",
    "we also find that , like in the case of @xmath0 gravity @xcite , the velocity field is more strongly affected by the modification to gravity law , and this provides a potentially powerful cosmological test of the theory of gravity .",
    "the structure of this paper is as follows . in   [ sect : model ] we briefly describe the dgp model and the vainshtein screening mechanism , which lays down the essential theoretical background . in   [ sect : equations ] we present the relevant field equations in the form as they appear in our numerical simulation code , and introduce the algorithm used to solve these equations as well as its implementation . in   [",
    "sect : code_tests ] we will show the various checks which we have performed to ensure that our code works accurately in different situations and aspects . we then run a suite of 36 simulations for the dgp model and its variants , and use these to study their predictions about the matter and velocity fields , especially on small scales which have been un - probed by previous studies : the results are given in ",
    "[ sect : results ] .",
    "finally we summarise and outlook in ",
    "[ sect : summary ] .    throughout the paper we shall follow the metric convention @xmath2 , and set @xmath3 except in the expressions where @xmath4 appears explicitly .",
    "as an example of models that accommodate the vainshtein mechanism , we consider the self - accelerating branch of the dgp braneworld model because this is the model where the vainshtein mechanism has been studied in details ( e.g. ,  @xcite ) .",
    "this makes it possible to compare our new simulations with previous studies in the literature without the mesh refinements and demonstrate the power of the adaptive mesh technique to study the nonlinear clustering .",
    "however , we should note that this branch of the dgp model suffers from the ghost instability ( e.g. @xcite ) and it can not be considered as a physical model . moreover , this model is already strongly disfavoured by observations , and therefore should be considered as a toy model to test our code .",
    "we will report results on more physical models as follow - up works in the future .",
    "the friedman equation in the self - accelerating branch is given by @xmath5 in which @xmath6 is the cross - over length scale at which gravity becomes five - dimensional , @xmath7 is newton s constant on the four - dimensional brane where matter fields live and @xmath8 matter density . to reproduce the observed cosmic acceleration one typically needs @xmath9 .",
    "the friedman equation can be rewritten as @xmath10 where @xmath11 is the scale factor , @xmath12 today , and @xmath13 the subscript @xmath14 indicates that the quantity is evaluated today . under the quasi - static approximation , the poisson equation and the equation for the scalar field",
    "are given by @xcite @xmath15 = \\frac{8 \\pi g a^2}{3 \\beta(a ) } \\rho \\delta,\\ ] ] and @xmath16 where @xmath17 is the gravitational potential , @xmath18 is the spatial gradient operator and @xmath19 is matter density contrast .",
    "the function @xmath20 is defined by in the text hereafter for brevity . ] @xmath21 which can be written as @xmath22    if we linearise the equations , the poission equation is given by @xmath23 note that @xmath24 is always negative so the growth of structure formation is suppressed in this model .",
    "the relevant field equation in a spherically symmetric configuration can be written in the following form @xmath25 + \\frac{1}{r^2}\\frac{{{\\rm d}}}{{{\\rm d}}r}\\left[r^2\\frac{{{\\rm d}}\\varphi}{{{\\rm d}}r}\\right]\\nonumber\\\\ & = & \\frac{8\\pi g}{3\\beta}\\delta\\rho_ma^2,\\end{aligned}\\ ] ] in which @xmath26 is the matter density perturbation and @xmath27 is the scalar field ( i.e. , the brane bending mode ) , and @xmath24 is given in eq .",
    "( [ eq : beta ] ) . defining the mass enclosed in radius @xmath28 as @xmath29 we can rewrite eq .",
    "( [ eq : dgp ] ) as @xmath30 where for simplicity we have set @xmath12 , and @xmath31 is the newtonian acceleration caused by the mass @xmath32 at distance @xmath28 from the centre .",
    "to further simplify the situation , let us assume that @xmath33 is constant within radius @xmath34 and zero outside .",
    "then eq .",
    "( [ eq : dgp_eqn ] ) has the physical solution @xmath35g_n(r)\\end{aligned}\\ ] ] for @xmath36 and @xmath37g_n(r)\\end{aligned}\\ ] ] for @xmath38 .",
    "here we have defined the vainshtein radius @xmath39 by @xmath40 where @xmath41 is the schwarzschild radius .",
    "the fifth force is given by @xmath42 .",
    "so when @xmath43 we have @xmath44 meaning that above the vainshtein radius gravity is weakened ( because @xmath45 for the self - accelerating branch of the dgp model ) . on the other hand , when @xmath46 we have @xmath47 indicating that the fifth force gets suppressed well within the vainshtein radius .    as some useful examples",
    ", we have listed in the table  [ table : simulations ] the different radii of some objects .",
    "we could see that from objects as small as atoms to those as large as the milky way , the vainshtein radius is significantly larger than the physical size , and as a result the fifth force is negligible for those objects .",
    "radii @xmath34 ( physical size ) , @xmath48 ( schwarzschild radius ) and @xmath39 ( vainshtein radius ) of some typical objects .",
    "unit is meter . for estimation",
    "we have used @xmath49 and @xmath50 m . [ cols=\"<,^,^,^\",options=\"header \" , ]     [ table : simulations ]",
    "in this section we describe the @xmath1-body equations in appropriate units and their discretised versions which the ecosmog code solves to do cosmological simulations .      the code unit used in our code",
    "is based on the supercomoving coordinates of @xcite , which can be summarised as follows ( tilded quantities are expressed in the code unit ) : @xmath51 in which @xmath52 is the physical coordinate , @xmath53 is the critical density today , @xmath54 the fractional energy density for matter today , @xmath55 the particle velocity , @xmath56 the gravitational potential and @xmath4 the speed of light .",
    "in addition , @xmath57 is the size of the simulation box in unit of @xmath58mpc and @xmath59 the hubble expansion rate today in unit of @xmath60  km / s / mpc .",
    "note that with these conventions the average matter density is @xmath61 .",
    "all these quantities are dimensionless .    using these quantities ,",
    "the eom of the brane - bending mode can be written as @xmath62 & = & \\frac{\\omega_m a}{\\beta}\\left(\\tilde{\\rho}-1\\right)\\ \\ \\ \\ \\\\end{aligned}\\ ] ] in which we have defined a new dimensionless @xmath63 quantity @xmath64 for simplicity , from here on we shall ignore the tildes on all quantities in eq .",
    "( [ eq : code_unit ] ) , and unless otherwise stated these quantities are all in code unit where they appear .",
    "( [ eq : code_eqn ] ) can be regarded as a second - order algebraic equation for @xmath65 , which has two branches of solutions . to avoid undecidedness in which branch of solution ( which may cause numerical problems in the code ) to take , we first solve it analytically and get @xmath66,\\end{aligned}\\ ] ] where we have defined @xmath67 in which we have followed @xcite and used the operator - splitting trick to avoid the numerical problem due to imaginary square root .",
    "@xmath68 is a constant coefficient which is chosen to be @xmath69 .    obviously , to get meaningful result in the limit @xmath70",
    ", one has to take the @xmath71-branch of eq .",
    "( [ eq : two_branch ] ) , where @xmath71 is the signature of @xmath72 or equivalently of @xmath24 , namely @xmath73.\\end{aligned}\\ ] ] if a wrong branch is taken , then @xmath74 even when @xmath70 , i.e. , when the matter density field becomes uniform , and this is clearly a sign of inconsistency ( indeed one of our code tests below is related to this observation ) .",
    "the equation for the standard newtonian potential , on the other hand , is the same as in gr , and we have @xcite @xmath75 once both @xmath56 and @xmath27 are solved , the total gravitational potential in the dgp model , @xmath76 , follows , which can be differenced to find the total force under which particles move .",
    "of course , computers could only handle a finite number of operations , and therefore eqs .",
    "( [ eq : one_branch ] , [ eq : newton ] ) must be discretised before being put into a code to be solved .",
    "this is the task for this subsection .",
    "consider that we want to solve these equations on a three - dimensional mesh consisting of periodic cubic cells , with cell length @xmath77 , and denote the value of the scalar field at the centre of the @xmath78-th cell by @xmath79 ( and similarly for other quantities ) , then the discrete version of the field derivatives are @xmath80 where we have assumed one dimension for simplicity for @xmath81 and @xmath65 , the three - dimensional generalisations of which are trivial .    using these , it is straightforward to write down the discrete version of the poisson equation as    @xmath82    similarly , the eom for the brane - bending mode can be written as an operator equation @xmath83 , with    @xmath84,\\ \\ \\ \\\\end{aligned}\\ ] ]    where the superscript @xmath85 is used to label the level of the mesh ( or equivalently the size of the cell of that level ) , and we have defined    @xmath86\\nonumber\\\\ & & - \\frac{2}{h^4}w\\left(\\varphi_{i+1,j , k}+\\varphi_{i-1,j , k}-2\\varphi_{i , j , k}\\right)\\left(\\varphi_{i , j+1,k}+\\varphi_{i , j-1,k}-2\\varphi_{i , j , k}\\right)\\nonumber\\\\ & & - \\frac{2}{h^4}w\\left(\\varphi_{i+1,j , k}+\\varphi_{i-1,j , k}-2\\varphi_{i , j , k}\\right)\\left(\\varphi_{i , j , k+1}+\\varphi_{i , j , k-1}-2\\varphi_{i , j , k}\\right)\\nonumber\\\\ & & - \\frac{2}{h^4}w\\left(\\varphi_{i , j+1,k}+\\varphi_{i , j-1,k}-2\\varphi_{i , j , k}\\right)\\left(\\varphi_{i , j , k+1}+\\varphi_{i , j , k-1}-2\\varphi_{i , j , k}\\right)\\nonumber\\\\ & & + \\frac{1}{8h^4}\\big(\\varphi_{i+1,j+1,k}+\\varphi_{i-1,j-1,k}-\\varphi_{i+1,j-1,k}-\\varphi_{i-1,j+1,k}\\big)^2\\nonumber\\\\ & & + \\frac{1}{8h^4}\\big(\\varphi_{i+1,j , k+1}+\\varphi_{i-1,j , k-1}-\\varphi_{i+1,j , k-1}-\\varphi_{i-1,j , k+1}\\big)^2\\nonumber\\\\ & & + \\frac{1}{8h^4}\\big(\\varphi_{i , j+1,k+1}+\\varphi_{i , j-1,k-1}-\\varphi_{i , j+1,k-1}-\\varphi_{i , j-1,k+1}\\big)^2 + \\frac{\\alpha}{\\beta}\\omega_m\\delta_{i , j , k}.\\end{aligned}\\ ] ]    this equation can be solved using the newton - gauss - seidel relaxation method , for which the code iterates to update the value of @xmath79 in all cells , and at each iteration the field values changes as @xmath87 where we have    @xmath88    note that , in comparison with the corresponding equations in @xmath0 gravity @xcite , here the nonlinearity mainly exists in the term @xmath89 , which involves products of the derivatives .",
    "such a special property of the vainshtein screening makes it more difficult for the newton - gauss - seidel relaxations to converge .      as mentioned above , ramses and therefore ecosmog",
    "are amr codes .",
    "the code starts from a regular mesh which covers the whole simulation domain , which we call the domain grid , and adaptively refines the mesh if the effective number of dark matter particles in a given cell exceeds certain threshold @xmath90 . in this way",
    ", it gives sufficient resolution in high matter density regions and avoids wasting too much time on low density regions where resolution requirement is mild .",
    "the process of self - refinement goes on until finally all cells in the finest level do not satisfy the refinement criterion .",
    "whenever a refinement is created , it is used to compute the force experienced by the particles which fall in its domain , and the boundary conditions can be set by using the values interpolated from coarser levels ( see @xcite for more details ) .",
    "the essential features of the code that are relevant for modified gravity simulations have been described in detail in @xcite .",
    "here we only present the most relevant part for our vainshtein simulations .",
    "it is well known that , when using relaxation method to solve boundary value problems , the first few relaxations see the solution approach the true value quickly . the convergence then becomes slower as one gets closer to the true solution , making the method less efficient .",
    "this is because relaxation on the fine grid can only damp the short - wavelength fourier components of the error , leaving behind the smooth long - wavelength components which cause a global poor convergence .",
    "the common method which is used to tackle this problem is the mutligrid technique @xcite .",
    "the idea is simple : when the convergence rate becomes low on the fine grid , one _ coarsifies _ the discrete equation by interpolation , moves it to the coarser level and solves it there .",
    "the long - wavelength components of the error then decays quickly on the coarse grids , giving more accurate solution there , which can then be interpolated back to the fine grid .",
    "we follow the standard v - cycle in the arrangement of multigrid : the field equation is always solved from the finest to the coarsest grid , and then back . if convergence is not achieved ( see below ) , further v - cycles are used .",
    "the multigrid method can be easily applied to computations based on a regular mesh , since the corresponding coarser grids are also regular and satisfy periodic boundary conditions .",
    "for refinements , which generally have irregular shapes , however , much effort needs to be devoted to designing the corresponding coarser meshes and setting appropriate boundary conditions for them .",
    "one of the important features of ramses and ecosmog is that it solves the discrete equation using multigrid technique on _ both _ the domain grid _ and _ the refinements , which significantly speeds up the convergence .",
    "consider the eom for the brane - bending mode , which for simplicity can be written as @xmath91 on the fine level , where @xmath92 is the nonlinear operator acting on @xmath93 defined above .",
    "note that although we have @xmath94 for the dgp equation , we shall still keep @xmath95 in eq .",
    "( [ eq : fine_grid_eqn ] ) for the reason that will become clear soon .    after a certain number of pre - smoothing gauss - seidel iterations on the fine grid ,",
    "the convergence becomes slow because short - wavelength modes of the error have already decayed and long - wavelength modes are untouched .",
    "one arrives at an approximate solution @xmath96 on the fine level , which gives @xmath97 now consider what we call the residual equation , @xmath98 where @xmath99 is the residual .",
    "after coarsifying and certain rearrangements , we obtain the coarser - level equation as @xmath100 where @xmath101 is the _ restriction _ operator which compute the coarse - level values of quantities given their fine - level values by interpolation . after a number of relaxation iterations on the coarser level",
    ", we find an approximate solution @xmath102 , which has long - wavelength modes of the error further reduced , and therefore the fine - level solution can be corrected as @xmath103 where @xmath104 is the _ prolongation _ operator which does the opposite of the restriction operator , again by interpolation .    the _ truncation error _",
    "@xmath105 can be estimated as @xmath106 and similarly for other levels .",
    "this could provide a stopping ( convergence ) criterion for the multigrid iterations , which in our case is @xmath107 in which @xmath108 is some predefined constant , which is often set even smaller to be more conservative .",
    "useful as it is , we find that this criterion is often not needed because it is easy to get @xmath109 down to @xmath110 within a few to a few tens of iterations , particularly on the refinements .",
    "this is typically much smaller than the truncation error .",
    "in this section we present the results of several tests of the ecosmog - v code , which are essential for us to be confident about its reliability .",
    "for this purpose , we have performed several tests as shown in fig .",
    "[ fig : tests ] ( see the figure caption for more technical details ) .",
    "[ sect : code_tests ]      the simplest test one can possibly do for the code is by considering a homogeneous distribution of matter , in which case the scalar field @xmath27 remains a constant across the space , and its value can be arbitrary due to the shift symmetry in the eom .",
    "if the code works correctly , then any inhomogeneity in @xmath111 should quickly disappear after a few gauss - seidel iterations .    to check this",
    ", we set @xmath112 and use random values that follow a uniform distribution between @xmath113 and @xmath114 as the initial guess of @xmath79 .",
    "these are shown in the upper left panel of fig .",
    "[ fig : tests ] as the symbols , in which for clarity we have fixed the @xmath115 and @xmath116 coordinates .",
    "we then let the code do the gauss - seidel relaxation until the residual gets small enough , @xmath117 .",
    "after a few iterations this criterion is satisfied and the resulted @xmath118 are described by the solid lines .",
    "we can see clearly that the final solution is constant in space .",
    "we have shown two different initial guesses as blue squares and red circles respectively , and @xmath118 quickly converges to a constant , which is almost the same in both cases .      in one dimension we can check that @xmath119 , which means that the nonlinear term in the dgp equation simply vanishes .",
    "this provides another simple but very useful test of the code , because if there is something wrong in the nonlinear term in the code , then it is unlikely to vanish coincidentally and the solution for @xmath27 should be incorrect .",
    "following @xcite , we do two tests using one - dimensional density field .",
    "the first test uses a sine - type field , specified by @xmath120 where @xmath121 is a numerical coefficient which we take to be @xmath122 because the nonlinear term in the eom does not contribute in 1d configurations , it can be easily checked that the analytical solution for this density field is @xmath123 in the upper right panel of fig .",
    "[ fig : tests ] , we have presented this analytical solution ( blue solid curve ) together with the numerical solution from the code ( blue squares ) , which agree with each other very well .",
    "we have tried a few other numerical values of @xmath121 and found same agreements .",
    "note that the code uses periodic boundary condition , which is exactly satisfied in the sine case . in the gaussian case ,",
    "the density field is not perfectly periodic , but @xmath128 is sufficiently suppressed by the exponential factor in eq .",
    "( [ eq : delta_gaussian ] ) , and is close to zero at @xmath129 and @xmath130 , so that the periodic boundary condition approximately holds .      in the above",
    "we have tested the code for 1d density fields only .",
    "these tests show that the nonlinear term in the eom do not create any problem , but they are not sufficient to prove that the code can solve this term correctly when it does contribute . for",
    "the latter we need to do tests in three dimensions , of which the spherically symmetric cases are the simplest possibility .    following @xcite",
    ", here we assume that the matter density inside the sphere is constant , i.e. , we have a spherical overdensity . in code unit ,",
    "( [ eq : dvarphidr_in ] , [ eq : dvarphidr_out ] ) can be written as @xmath131r,\\end{aligned}\\ ] ] for @xmath132 and @xmath133r,\\end{aligned}\\ ] ] for @xmath36 , where @xmath28 is the comoving coordinate scaled by the boxsize @xmath57 , while @xmath34 is the radius of the spherical overdensity also scaled by @xmath57 .",
    "@xmath19 is the overdensity .",
    "given the value @xmath134 , these equations can be integrated to find @xmath135 numerically .",
    "we do this for two different cases , respectively @xmath136 and @xmath137 , which correspond to the same mass in the sphere , and the results are shown as the black solid curves in the lower panels of fig .  [ fig : tests ] . for comparison ,",
    "solutions from our numerical code are shown as blue squares in those panels .",
    "we can see that in both cases the two solutions agree very well , especially on small @xmath28 .",
    "far from the centre , the agreement becomes less perfect since the numerical integration does not assume periodicity of the spherical overdensity , while the numerical code uses period boundary condition so that the spherical density sees its own images .",
    "such an artificial discrepancy due to imposing periodic boundary conditions can also be seen in the point - mass test of @xcite , and it emphasises the importance of choosing large enough box sizes in cosmological simulations .",
    "one of the most important features of our code compared with existing codes in the literature is that it enables adaptive mesh refinements to improve on the resolution .",
    "it is therefore crucial to check that the solver works correctly on the refinements .    to check this ,",
    "we have placed a refined region which covers the spherical overdensity in the above test .",
    "the density field on the refinement is chosen to the exactly the same as that on the domain grid , and we fix the boundary condition in the edge cells of the refinement by interpolating from the coarser cells in the domain grid .",
    "the results are shown as red circles in the lower panels of fig .",
    "[ fig : tests ] , where we can see that in the domain covered by the refinement they agree with both the solution from numerical integration ( black solid curve ) and the results on the domain grid ( blue squares ) .",
    "we have also done tests using other values of @xmath19 and found similar agreements .",
    "these tests show that the code actually works quite well on both the domain grid and refinements . in the next section",
    ", we will show results of cosmological simulations using this code .",
    "to study the cosmological behaviour of the dgp model and the vainshtein mechanism , we have run a set of 36 @xmath1-body simulations using the ecosmog - v code . in this section",
    "we show the results from these simulations .",
    "as we have seen above , the self - accelerating branch of the dgp model shows a different background expansion history from that of @xmath138cdm , which itself can contribute to the different matter clustering seen in these two models .",
    "therefore , to see the effects of modified gravitational force and in particular the vainshtein mechanism more directly , it is better to compare the full dgp simulation with a corresponding newtonian simulation with the dgp background : this so - called _ qcdm model _",
    "@xcite is not a rigorous theoretical model and we consider it only for comparisons . also , we have simulated the _ linearised dgp model _ in which the nonlinear derivative coupling term is set to zero by hand so that the model has exactly the dgp background but particles feel an effective newton s constant given by @xmath139 because @xmath45 for the self - accelerating branch of the dgp model , the modified gravitational force is actually weaker than in gr .    to make statistic averages , we run six realisations of simulations for every model .",
    "the initial conditions are generated using the mpgrafic package @xcite at @xmath140 , from the same linear matter power spectrum but with different random seeds .",
    "strictly speaking , even at @xmath141 the matter clustering can be different in qcdm and dgp , but for the self - accelerating branch which we are studying here the difference in the linear matter power spectra is fairly small ( @xmath142 ) and so we have neglected it .",
    "the fact that we use the same initial conditions for simulations of different models makes sure that the initial density fields have the same phases , and so any difference in the matter power spectra that we find at later times will be a direct consequence of the different dynamics and force laws between the models .",
    "the cosmological parameters we use in the simulations are taken from the best - fitting self - accelerating dgp model using the wmap 5yr data @xcite . to be more specific , we have @xmath143 , \\omega_bh^2 , \\omega_ch^2 , \\omega_{\\rm rc } , \\sigma_8\\right\\}\\nonumber\\\\ & = & \\{0.66 , 0.998 , 3.01 , 0.0237 , 0.0888 , 0.138 , 0.536\\}.\\nonumber\\end{aligned}\\ ] ] note that @xmath144 is a derived parameter which makes the universe flat and @xmath145 is its current value for the linearised dgp model ( because to compute it uses linear perturbation theory ) .",
    "some of these parameters , such as @xmath146 , are used directly in the simulations , while all of them are used in generating the linear matter power spectra at @xmath147 .    to better understand the effects of varying the force resolution , we have simulated two different box sizes , respectively @xmath148mpc and @xmath149mpc . for both cases we use @xmath150 dark matter particles and",
    "the domain grid has 256 cells in each dimension .",
    "the cells are refined when the effective number of particles inside them exceeds 9.0 ( @xmath151 ) and the final refinement level has @xmath152 cells in each dimension if they were to cover the whole simulation box .",
    "the gauss - seidel relaxations stop when @xmath153 .",
    "thanks to the efficient mpi parallelisation , the simulations are pretty fast or decreases the convergence criterion @xmath154 .",
    "also , in the self - accelerating branch of dgp model considered here , matter clusters less than in qcdm because the fifth force actually weakens gravity ; in the normal - branch dgp , on the other hand , gravity is strengthened and matter cluster more strongly , which means there will be more refined grids and therefore the simulation takes longer to finish . ] : using 96 cpus the low - resolution ones finish within 2 hours ( wall - clock time ) and the high - resolution ones complete in less than 6 hours .",
    "the difference is partly because the high - resolution simulations also have more refined time steps , and partly because of the stronger fluctuation of the density field when constructed on a finer grid .",
    "note that although the dgp simulations are in general more difficult to converge than the @xmath0 simulations ( i.e. , more tunings of the code are needed ) , if they do converge they do it much more quickly .        in fig .",
    "[ fig : visual ] we have shown the density and velocity divergence fields in a slice of the simulation box .",
    "the velocity divergence field is defined as @xmath155 in which @xmath156 is the hubble expansion rate and @xmath157 is the velocity field of the dark matter particles . to measure the velocity field and its divergence from the particle positions and velocities we have used the delaunay tessellation field estimator ( dtfe ) code described in @xcite .",
    "the delaunay tessellation has the advantage that the velocity divergence field computed in this way is volume - averaged , rather than mass - averaged .",
    "it also avoids the problem of empty cells including no particles , which can arise in direct assignment methods of measuring the velocity field @xcite .    shown in the upper panels of fig .",
    "[ fig : visual ] are the logarithmic density field @xmath158 for one of the 6 realisations of the qcdm ( left ) , linearised dgp ( middle ) and full dgp ( right ) simulations .",
    "the colour scale is from @xmath159 ( black ) to @xmath160 ( white ) .",
    "the difference in the pattern and strength of clustering is barely visible by eye , but one can still see the stronger clustering in the qcdm model ( recall that the in dgp model gravity is weakened compared to qcdm ) , in particular in the cluster near the lower - right corner",
    ". a blink view of these panels also show that in qcdm the clusters are slight closer to each other , while the difference between linearised and full dgp is very small .",
    "similar patterns can be seen in the lower panels of fig .",
    "[ fig : visual ] , in which we show the corresponding velocity divergence fields .",
    "the velocity divergence field is positive in low - density regions where matter flows from the central part and the flow becomes faster as it approaches clumps of matter .",
    "this trend is reversed near clusters and filaments , where the velocity divergence field becomes negative since matter flows inwards here .",
    "inside clusters and filaments , the velocity divergence takes positive sign again , as noted by @xcite . since gravity is strongest in the qcdm model ,",
    "the matter flow is faster inside voids and near clusters , making the plot brighter in the low - density regions and the black regions near clusters thicker , though this is barely visible without blinking view ( one can however see the difference in the clusters near the lower right corner of each panel ) .      given that the difference is so visibly small , it is more useful to look at statistical quantities , such as the power spectra , to quantify the matter clustering , @xmath161 with @xmath162 and @xmath163 with @xmath164 for the velocity divergence field . in",
    "above @xmath165 means ensemble average .            in fig .",
    "[ fig : pk_z0 ] we show the relative difference of @xmath166 ( left panel ) and @xmath167 of the full ( blue symbols ) and linearised ( red symbols ) simulations from that of the qcdm simulation .",
    "the left panel agrees quite well with previous results such as those in @xcite , but extends to smaller scales due to the amr nature of our code .",
    "there are several notable features here :    1 .",
    "both the linearised and the full dgp simulations agree with the linear perturbation theory prediction on length scales larger than @xmath168  mpc@xmath169 .",
    "this indicates that , at least for the wmap5 best - fitting dgp model ( the self - accelerating branch ) , the nonlinearity in vainshtein mechanism becomes important at @xmath168  mpc@xmath169 , exactly where the nonlinearity in the underlying density field starts to make linear perturbation theory invalid .",
    "2 .   on scales smaller than @xmath168mpc@xmath169",
    ", the vainshtein effect can strongly suppress the deviation from qcdm compared to the linearised simulation ( where it is absent ) .",
    "this agrees with the result of @xcite .",
    "3 .   the amr property of our code enables us to measure the matter power spectra on significantly smaller scales than that of @xcite .",
    "indeed , the simulations show that the deviation from qcdm in @xmath166 decays to zero on small scales , in agreement with the halo model prediction of @xcite .",
    "the low - resolution simulations , with a larger box size , show better agreement with linear perturbation theory on large scales as expected .",
    "box size is an equally , if not more , important issue in our simulations , and should not be chosen to be too small as a compromise to achieve better resolutions .",
    "this reflects the importance of amr from a different angle .    in the framework of gr , fitting formulae such as the halofit",
    "have been developed to provide a mapping between the linear and nonlinear matter power spectra @xcite .",
    "but due to its simplicity , it is often misused to derive the nonlinear power spectrum in modified gravity models @xcite .",
    "[ fig : pk_z0 ] clearly shows that the halofit overestimates the deviation of dgp from qcdm on small scales .",
    "this is hardly surprising because halofit does not incorporate the effect of the vainshtein mechanism which helps to recover gr on small scales .",
    "the vainshtein mechanism is effective once the density perturbations become nonlinear @xcite , and brings the matter power spectrum back to the qcdm prediction on small scales .",
    "based on this observation , @xcite has suggested a simple way to modify the halofit to fit the nonlinear power spectrum in modified gravity models , which is called the parameterised - post friedman ( ppf ) fit .",
    "the ppf matter power spectrum is given by @xmath170 where @xmath171 measures the nonlinearity of the density perturbations @xmath172 @xmath173 is the linear matter power spectrum for the dgp model and @xmath174 is the power spectrum in the linearised model without the vainshtein mechanism , which can be obtained by simply applying halofit to the linear power spectrum for the dgp model .",
    "@xmath175 is the power spectrum in the qcdm model .",
    "as the nonlinearity becomes large @xmath176 , this formula ensures that the power spectrum in the full dgp model approaches the one in the qcdm model . in ref .",
    "@xcite , the free parameter @xmath177 in the ppf fit was estimated using the perturbation theory as @xmath178 and @xmath179 . using these predictions for @xmath177",
    ", we found that the ppf fit recovers the @xmath1-body simulation results very well ( figs .",
    "[ fig : pk_z0 ] and [ fig : pk_evo ] ) .",
    "this demonstrates that the vainshtein mechanism is working as expected in our full dgp simulations .",
    "the right panel of fig .",
    "[ fig : pk_z0 ] is the same as the left panel , but for the velocity divergence power spectra . here",
    ", the behaviour is very different .",
    "in particular , we see that the vainshtein mechanism already has effects on sales as large as @xmath180mpc@xmath169 , similar to what we have seen in our @xmath0 gravity simulations @xcite .",
    "furthermore , the deviation from qcdm on large scales ( @xmath181 ) is much larger than what we see in @xmath166 ( @xmath182 as is shown in the left panel ) .",
    "this means that observationally the velocity field , though more challenging to measure , can be more interesting in the tests of gravity .      finally , fig .",
    "[ fig : pk_evo ] shows the time evolutions of the matter ( left panel ) and velocity divergence ( right panel ) power spectra .",
    "in particular , we show @xmath183 and @xmath184 at three different epochs , with @xmath185 ( solid curves ) , @xmath186 ( dashed curves ) and @xmath187 ( dotted curves ) .",
    "results for the full ( linearised ) simulations are shown in blue squares ( red circles ) as before .",
    "the left panel of fig .",
    "[ fig : pk_evo ] shows that deviations from qcdm are smaller at earlier times , which is because @xmath188 is larger and @xmath189 is closer to @xmath190 at higher redshifts .",
    "the vainshtein effect is also weaker at the early times because the nonlinear term in the dgp equation is proportional to @xmath191 and therefore suppressed .",
    "however , the general observations that we have for @xmath185 , notably that the vainshtein mechanism suppresses the deviations from qcdm on smaller scales and eventually brings things back to gr , still apply here .",
    "the evolution pattern can be understood as follows :    1 .",
    "note that the deviation from qcdm essentially freezes on scales smaller than @xmath192mpc@xmath169 after @xmath187 , which shows that those scales become below the vainshtein radius so that they feel the standard gravity .",
    "the very large scales , on the other hand , are beyond the vainshtein radius until today and their evolution can be approximately described by linear perturbation theory .",
    "3 .   going from very large scales to intermediate scales , the nonlinearity of the matter density field first kicks in and makes the full dgp simulation behave similarly to the linearised simulation ( i.e. , @xmath193 initially decreases as @xmath194 increases ) .",
    "then , the vainshtein mechanism takes over and brings things back to the small - scale behaviour described above .",
    "this explains why @xmath193 appears to have a valley whose position depends on the cosmic epoch and shifts to larger scales with time .",
    "the velocity divergence power spectrum , on the other hand , shows very different properties from the matter power spectrum :    1 .   even on length scales as large as @xmath168mpc@xmath169 , @xmath167 in the full dgp simulations",
    "does not agree with linear - theory prediction , though in the linearised dgp simulations it does agree with linear theory on those scales .",
    "this implies that the vainshtein mechanism affects the velocity divergence even on such large scales , and it is in contrast to the matter power spectrum , which agrees with linear theory predictions in both the full and the linearised dgp simulations on those scales .",
    "this has an important implication in the measurement of the growth rate using redshift distortions .",
    "we need to carefully take into account the vainshtein effect even on large scales to extract the linear growth rate accurately .",
    "2 .   on small scales ,",
    "the vainshtein mechanism suppresses the deviation from qcdm , a but the velocity divergence power spectrum does not approach to the qcdm result even at @xmath195mpc@xmath169 whereas the matter power spectrum does .",
    "this implies that velocities hold a key to distinguish modified gravity models with the vainshtein mechanism from gr on small scales .",
    "we can also understand the pattern for @xmath196 .",
    "taking the linearised dgp simulation as an example , for which newton s constant is scaled by @xmath197 on all scales , so that in linear theory one would expect @xmath196 to be a constant at least on large scales , as we could see at early times ( @xmath187 ) . on small scales , the nonlinearity transfers power between different scales , causing the deviation from scale - independence .",
    "when clusters start to form , the @xmath198 field changes sign from the outside to the inside of halos , and its magnitude can become smaller . as gravity is stronger in the qcdm model , at a given time it has stronger clustering and more compact clusters , and",
    "so the scale at which @xmath198 changes sign is also smaller  this leads to , on average , an increase in @xmath199 on the typical halo - formation scale and a decrease on slightly larger scale , which gives rise to the peak we see in the plot of @xmath196 .",
    "the peak shifts to larger scales because the halo - formation scale increases in time .",
    "to summarise , in this paper we have reported the development and initial results of a new @xmath1-body code which is suitable for cosmological simulations in modified gravity theories which restore gr in high - density regions by nonlinear derivative couplings , such as the dgp and galileon gravity models .",
    "this code is based on our ecosmog code @xcite , which was originally developed for @xmath0 gravity simulations and later generalised to simulate generic modified gravity theories which restore gr using nonlinear self - interaction potentials @xcite .",
    "however , the solver for the nonlinear partial differential equation is different in both its algorithm and its implementations , making it essentially a new and independent code .      1 .",
    "it solves the scalar field on a mesh using nonlinear relaxation , which has good convergence properties @xcite .",
    "the density field on the mesh is obtained by assigning particles following the triangular - shaped - cloud scheme , and there is no need to pre - smooth it to achieve convergence .",
    "2 .   the mesh can be adaptively refined in high - density regions to achieve higher resolution and accuracy there , without affecting the overall performance .",
    "there is no need to smooth the density field on the refinements either .",
    "it is efficiently parallelised using mpi , which makes the simulations fast .",
    "this is important for modified gravity simulations which generally take much longer than corresponding gr simulations , and makes this code suitable for large and high - resolution cosmological simulations which are essential for us to fully understand the small - scale behaviour of such models , and to better explore the future high - precision observational data on the large - scale structures .",
    "we have made various tests of the code to make sure that it gives accurate solutions to simple situations such as uniform density field , 1d ( sine and gaussian ) density fields and spherical overdensites . because the most important feature of this code is the amr",
    ", we also tested the code on refinements and found that it works correctly .",
    "furthermore , our cosmological simulations predict the same behaviour of the matter power spectrum as that discovered in previous work @xcite .",
    "we have used our code to run a set of 36 simulations for the qcdm , linearised dgp and full dgp models .",
    "the amr nature enables us to probe scales smaller than those reached by previous simulations , and confirmed the halo - model prediction of @xcite that the full dgp matter power spectrum should go back to the qcdm result on small enough scales .",
    "we have also studied the velocity field in dgp gravity , and found that it is more strongly affected by the nonlinearity in both the underlying matter field and the vainshtein mechanism . even on large scales where the matter power spectra for the full and linearised dgp simulations agree",
    "quite well , we find noticeable difference between the velocity divergence power spectra of the two .",
    "this trend starts as early as @xmath200 , and by @xmath201 the deviation of @xmath167 from the corresponding qcdm result can be as large as more than @xmath202 , compared with the @xmath182 deviation in @xmath166 .",
    "this suggests that large - scale velocity fields can be a good probe of modified gravity theories such as the dgp .",
    "of course , the dgp model is disfavoured by various observational tests , but the beauty in the idea of vainshtein mechanism has motivated more general models which recover gr using nonlinear derivative couplings , notably the galileon models .",
    "recent studies of @xcite have largely advanced our knowledge in the linear perturbation behaviour of these models and found reasonable fits to the cmb and background expansion data , but still leave the open question about the region of validity of linear theory . to fully answer",
    "this question is crucial for cosmological tests of the galileon model , especially in light of the coming high - precision observational data , but this can only be achieved by studying the nonlinear regime of the structure formation numerically .",
    "our code is useful in this context , and could hopefully bring us one important step forward .",
    "bl acknowledges supports by the royal astronomical society and durham university .",
    "gbz is supported by the dennis sciama fellowship at the university of portsmouth .",
    "kk is supported by stfc grant st / h002774/1 , the leverhulme trust and the european research council .",
    "the simulations described in this paper were performed on the cosma machine at durham university .",
    "we thank wojtek hellwing for helps in measuring the velocity divergence power spectra and making the plots ."
  ],
  "abstract_text": [
    "<S> there has been a lot of research interest in modified gravity theories which utilise the vainshtein mechanism to recover standard general relativity in regions with high matter density , such as the dvali - gabadadze - porrati and galileon models . </S>",
    "<S> the strong nonlinearity in the field equations of these theories implies that accurate theoretical predictions could only be made using high - resolution cosmological simulations . </S>",
    "<S> previously , such simulations were usually done on regular meshes , which limits both their performance and the accuracy . in this paper , we report the development of a new algorithm and code , based on ecosmog , that uses adaptive mesh refinements to improve the efficiency and precision in simulating the models with vainshtein mechanism . </S>",
    "<S> we have made various code tests against the numerical reliability , and found consistency with previous simulations . </S>",
    "<S> we also studied the velocity field in the self - accelerating branch of the dgp model . </S>",
    "<S> the code , parallelised using mpi , is suitable for large cosmological simulations of galileon - type modified gravity theories . </S>"
  ]
}