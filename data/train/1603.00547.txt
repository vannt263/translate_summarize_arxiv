{
  "article_text": [
    "in algebraic geometry , the linear systems of divisors on curves are well studied ( cf .",
    "other authors studied linear systems of divisors on metric graphs , for example @xcite .",
    "baker and norine @xcite proved a graph - theoretic analogue of the riemann - roch theorem , and it was generalized to tropical curves ( which may contain unbounded rays ) independently by gathmann and kerber @xcite and by mikhalkin and zharkov @xcite .",
    "the theory of linear systems on metric graphs is applied to algebraic geometry , for example in @xcite .",
    "haase , musiker and yu @xcite studied the cell complex structure of @xmath0 and the tropical semi - module structure of @xmath2 , where @xmath1 is a divisor on a metric graph .",
    "this work is an extension of @xcite .",
    "we focus on the computation of the cell complex @xmath0 , namely given a metric graph @xmath3 and a divisor @xmath1 on it , how to find the cells in @xmath0 and the @xmath4-vector of @xmath0 .",
    "since @xmath0 may contain a large number of cells and some of these are complicated , the complexity of computation could be high .",
    "we introduce the _ anchor cell _ that serves as the landmarks to find other cells in @xmath0 . as a byproduct we can compute the extremal generators of @xmath2 .",
    "we implemented the algorithms and computed some examples - namely the canonical linear systems on some trivalent graphs .    a _ metric graph _",
    "@xmath3 is a connected undirected graph whose edges have positive lengths .",
    "a _ divisor _",
    "@xmath1 on @xmath3 is a formal finite @xmath5-linear combination @xmath6 of points @xmath7 in the edges of @xmath3 .",
    "the divisor is _ effective _ if @xmath8 for all @xmath9 .",
    "the _ degree _ of a divisor @xmath1 is @xmath10 .",
    "the _ support _ of a divisor @xmath1 on @xmath3 is the set @xmath11 , denoted as @xmath12 .",
    "a _ ( tropical ) rational function _",
    "@xmath4 on @xmath3 is a continuous function @xmath13 that is piecewise - linear on each edge of @xmath3 with finitely many pieces and integer slopes .",
    "the _ order _ @xmath14 of @xmath4 at a point @xmath9 is the sum of the outgoing slopes at @xmath15 along all directions .",
    "note that if @xmath15 is an interior point of a linear piece of @xmath4 , then there are two directions at @xmath15 , and @xmath15 has two opposite outgoing slopes , so @xmath16 .",
    "the _ principal divisor _ associated to @xmath4 is @xmath17 so the support of @xmath18 is always finite .",
    "two divisors @xmath1 and @xmath19 are _ linearly equivalent _ if @xmath20 for some rational function @xmath4 , denoted as @xmath21 . for any divisor @xmath1 on @xmath3 , let @xmath2 be the set of all rational functions @xmath4 on @xmath3 such that the divisor @xmath22 is effective , and @xmath23 , the _ linear system _ of @xmath1 .",
    "[ exa : c4 ] let @xmath3 be a metric graph with graph - theoretic type @xmath24 and equal edge lengths . below are examples of @xmath1 and @xmath25 .",
    "( 2,2 ) (0,2 ) ",
    "( 0,0 ) ; ( 0,0 ) circle ( 1pt ) ; ( 2,0 ) circle ( 1pt ) ; ( 2,2 ) circle ( 1pt ) ; ( 0,2 ) circle ( 1pt ) ; at ( 0,0 ) q ; at ( 2,0 ) r ; at ( 0,2 ) p ; at ( 2,2 ) s ;    ( 0,0 )  ( 2,0 )  ( 2,2 ) (0,2 )  ( 0,0 ) ; ( 0,0 ) circle ( 1pt ) ; ( 2,0 ) circle ( 1pt ) ; ( 2,2 ) circle ( 1pt ) ; ( 0,2 ) circle ( 1pt ) ; at ( 0,0 ) 2 ; at ( 2,0 ) 2 ; at ( 0,2 ) 2 ; at ( 2,2 ) 2 ;    ]    ( 0,0 )  ( 2,0 )  ( 2,2 ) (0,2 )  ( 0,0 ) ; ( 2,2 ) circle ( 1pt ) ; ( 0.5,2 ) circle ( 1pt ) ; ( 1.5,2 ) circle ( 1pt ) ; ( 1.33,0 ) circle ( 1pt ) ; ( 0,1 ) circle ( 1pt ) ;    at ( 2,2 ) 1 ; at ( 0.5,2 ) 1 ; at ( 1.5,2 ) 1 ; at ( 0,1 ) 2 ; at ( 1.33,0 ) 3 ; at ( 0,0 ) q ; at ( 2,0 ) r ; at ( 0,2 ) p ; at ( 2,2 ) s ;    the metric graph @xmath3 is determined by its graph - theoretic type and the lengths of its edges .",
    "the graph - theoretic type of @xmath3 is called the _ skeleton _ of @xmath3 , and",
    "the lengths of edges of @xmath3 are called the _",
    "metric _ of @xmath3 and denoted by @xmath26 . for an edge @xmath27 of @xmath3 we denote by @xmath28 the length of @xmath27 in @xmath26 . for any metric graph @xmath3 , the _ canonical divisor",
    "_ @xmath29 of @xmath3 is the divisor on @xmath3 with @xmath30 when @xmath15 is a vertex of @xmath3 and @xmath31 otherwise .",
    "when we fix the skeleton of @xmath3 , for any metric @xmath26 and divisor @xmath1 on @xmath3 we denote by @xmath32 the set @xmath2 and by @xmath33 the linear system @xmath0 .    given a metric graph @xmath34 and a divisor @xmath1 on @xmath3 .",
    "@xmath1 is _ vertex - supported _ if @xmath35 .",
    "note that @xmath12 is always a finite set .",
    "if @xmath1 is not vertex - supported , then we can refine @xmath3 to get a new metric graph whose set of vertices is @xmath12 .",
    "we shall assume from now on that @xmath1 is vertex - supported .",
    "also we may assume that @xmath0 is not empty , so if @xmath1 is not effective , we can consider an effective divisor @xmath36 .",
    "it is obvious that @xmath37 .",
    "we shall assume from now that @xmath1 is vertex - supported .    in section [ sec:|d|",
    "] , we present the cell complex structure of @xmath0 and introduce the _ anchor cells_. we use them as landmarks to find all cells in the complex and prove a combinatorial formula ( corollary [ cor : fvec ] ) for the @xmath4-vector of @xmath0 .",
    "we introduce an algorithm to compute the cells of @xmath0 given @xmath3 and @xmath1 . in section",
    "[ sec : r(d ) ] , we regard @xmath2 as a tropical semi - module ( convex set ) and introduce an algorithm to find the extremal generators of @xmath2 , using a result in @xcite based on the chip - firing technique . in section [ sec : exp ]",
    "we apply our algorithms to examples of trivalent graphs .",
    "finally we raise some open problems in section [ sec : q ] .",
    "in this section we present the cell complex structure of @xmath0 .      note that if @xmath38 is a constant rational function on @xmath3 , then for any rational function @xmath4 on @xmath3 , the divisor @xmath39 is equal to @xmath22",
    ". let @xmath40 be the set of constant functions on @xmath3 .",
    "the set @xmath41 can be identified with the linear system @xmath0 by the map @xmath42 .",
    "we adapt the formulation of @xmath0 as a cell complex in @xcite , which originates from @xcite and @xcite .",
    "[ def : cell ] we identify each open edge @xmath43 with the interval @xmath44 ( this implicitly gives an orientation of @xmath27 , while it is independent to the cell complex ) .",
    "then each cell of @xmath0 is characterized by the following data :    * a nonnegative integer @xmath45 for each @xmath46 ; * an ordered partition @xmath47 of positive integers for some edges @xmath43 ; * an integer @xmath48 for each @xmath43 .",
    "a divisor @xmath49 belongs to this cell if and only if the following statements hold :    * @xmath50 for each @xmath46 ; * for those @xmath43 with the partition above , the divisor @xmath49 on @xmath27 is expressed as @xmath51 , where @xmath52 ; for other edges @xmath27 , @xmath53 for all points @xmath15 in the interior of @xmath27 ; * for any @xmath25 such that @xmath54 , the outgoing slope of @xmath4 at the point @xmath55 is @xmath48 for each @xmath43 .",
    "the slopes @xmath48 are also required because two distinct rational functions in @xmath2 may lead to different effective divisors in @xmath0 with exactly the same values of the @xmath45 and the ordered partitions of @xmath56 .",
    "[ ext : cou ] let @xmath57 be a loop @xmath27 with one vertex @xmath58 and the length of @xmath27 equal to @xmath59 .",
    "let @xmath60 .",
    "then the two effective divisors in figure [ fig : cir ] belong to @xmath0 . for both , all @xmath45 are @xmath55 and all @xmath56 are @xmath59 with one part in the partition , while the slopes @xmath48 are different : one is @xmath61 and the other is @xmath62 .",
    "( 2,2 ) circle [ radius=2 ] ; ( 2,0 ) circle ( 1pt ) ; ( 0.27,3 ) circle ( 3pt ) ; at ( 2,0 ) v ; at ( 0.27,3 ) 3 ; at ( 1,0 ) -2 ; at ( 3,0 ) -1 ;    ( 2,2 ) circle [ radius=2 ] ; ( 2,0 ) circle ( 1pt ) ; ( 3.73,3 ) circle ( 3pt ) ; at ( 2,0 ) v ; at ( 3.73,3 ) 3 ; at ( 1,0 ) -1 ; at ( 3,0 ) -2 ;    a cell is represented by any divisor @xmath22 in it , because once we have the rational function @xmath25 , we can compute all data in definition [ def : cell ] .",
    "there is a natural question : how can we tell the dimension of a cell from a representative ?",
    "the following proposition is a good answer .",
    "( ( * ? ? ?",
    "* proposition 13))[prop : dim ] let @xmath1 be a vertex - supported effective divisor on a metric graph @xmath3 and @xmath63 be the set of vertices in @xmath3 . let @xmath64 be a cell in @xmath0 and @xmath49 a representative of @xmath64 .",
    "let @xmath65 .",
    "then @xmath66 is one less than the number of connected components in the graph @xmath67 .",
    "[ cor : dim ] let @xmath1 be a vertex - supported effective divisor on a metric graph @xmath3 and @xmath68 .",
    "then the dimension of the cell complex @xmath0 is at most @xmath69 .",
    "in addition , if @xmath3 is @xmath70-connected , then the dimension of the cell complex @xmath0 is at most @xmath71 .",
    "let @xmath64 be a cell in @xmath0 and @xmath49 a representative of @xmath64 . then @xmath72 .",
    "so the support of @xmath49 contains at most @xmath69 points . by definition , @xmath73 , so @xmath74 contains at most @xmath69 points as well .",
    "now we consider the connected components in the graph @xmath67 .",
    "first @xmath3 is connected . and",
    "each time we delete a point in @xmath74 , the number of connected components can increase by at most @xmath75 , because the deleted point is always interior to an edge of the current graph .",
    "therefore there are at most @xmath76 connected components in the graph @xmath67 .",
    "hence , by proposition [ prop : dim ] , we conclude that @xmath77 .",
    "if @xmath3 is @xmath70-connected , then when we delete one point in @xmath74 from @xmath3 , the remaining graph is still connected , so there are at most @xmath69 connected components in the graph @xmath67 .",
    "hence @xmath78 .",
    "in order to find the cells in @xmath0 , we need to know whether there are finitely many of them .",
    "fortunately we have the following theorem .",
    "* theorem 14))[thm : fin ] the cell complex @xmath0 has finitely many vertices .",
    "since each cell is uniquely determined by its vertices , we have the following corollary .",
    "[ cor : fin ] the cell complex @xmath0 has finitely many cells .",
    "in order to find the cells given @xmath3 and @xmath1 , one approach is that we first find the vertices of @xmath0 , then find other cells of @xmath0 . as for the vertices",
    ", it is straightforward to implement the method in the proof of ( * ? ? ? * theorem 6 ) .",
    "however , there might be many general cells in @xmath0 with rather complicated structures , because there might be many parts in the partition on one edge in the data in definition [ def : cell ] . to grasp the general cells in @xmath0",
    ", we introduce an important type of divisors and cells in @xmath0 that serve as landmarks .",
    "[ def : anc ] a divisor @xmath49 on @xmath3 is an _",
    "anchor divisor _ if for each edge of @xmath3 there is at most one its interior point @xmath15 with @xmath79 .",
    "a cell @xmath64 in @xmath0 is an _ anchor cell _ if all representatives @xmath49 of @xmath64 are anchor divisors",
    ".    the number of anchor divisors in @xmath0 could be infinite .",
    "for example if an anchor cell has dimension @xmath75 , then it contains infinitely many divisors and each such divisor is an anchor divisor .",
    "nonetheless , they all represent the same anchor cell because they share the same data in definition [ def : cell ] .",
    "one property of anchor cells is that they contain all vertices of @xmath0 .",
    "[ lem : ver ] each vertex of @xmath0 is an anchor cell .",
    "suppose that @xmath80 is not an anchor divisor .",
    "there exists an edge @xmath27 of @xmath3 and two distinct interior points @xmath81 of @xmath27 such that @xmath82 , then @xmath83 . after deleting @xmath84 and",
    "@xmath85 the graph is no longer connected .",
    "so the number of connected components in the graph @xmath67 is at least @xmath70 .",
    "hence , by proposition [ prop : dim ] , @xmath49 is the representative of a cell with dimension at least @xmath75 .",
    "therefore , if a divisor represents a vertex of @xmath0 , it must be an anchor divisor .",
    "so each vertex is an anchor cell .",
    "[ def : sa ] let @xmath86 be an anchor cell of @xmath0 .",
    "for each edge of @xmath3 we consider whether there is an ordered partition in the data of @xmath86 . if @xmath87 are the edges of @xmath3 such that in the data of @xmath86 there is an ordered partition @xmath88 on @xmath89 , then we define @xmath90",
    "; otherwise we define @xmath91 .",
    "the motivation for anchor cells is the following theorem .",
    "( association to anchor cells)[thm : anc ] let @xmath1 be a vertex - supported effective divisor on a metric graph @xmath3 .",
    "( 1 ) suppose @xmath92 is the set of all cells in @xmath0 and @xmath93 is the set of all anchor cells in @xmath0 . then there is a function @xmath94 such that for @xmath95 , let @xmath96 be a representative of @xmath64 . then @xmath97 is represented by an anchor divisor @xmath98 such that    a.   @xmath99 for all vertices @xmath58 of @xmath3 ; b.   the corresponding rational functions of @xmath98 and @xmath49 have the same slopes at the endpoints of every edge of @xmath3 .",
    "\\(2 ) let @xmath100 be the same map as in ( 1 ) .",
    "then for any anchor cell @xmath101 , we have @xmath102 furthermore , for @xmath103 , there are @xmath104 cells of dimension @xmath105 in @xmath106 .",
    "\\(1 ) given @xmath1 and @xmath49 , we construct @xmath98 as follows .",
    "let @xmath25 such that @xmath54 .",
    "then we construct another rational function @xmath107 .",
    "first we let @xmath108 for vertices @xmath58 of @xmath3 ; next we let @xmath109 for all points @xmath110 , where @xmath27 is an edge of @xmath3 such that @xmath111 ; for other edges @xmath27 of @xmath3 , we regard the open edge @xmath27 as the interval @xmath112 .",
    "suppose @xmath4 has @xmath113 linear pieces @xmath114 $ ] on @xmath27 , with slope @xmath115 , where @xmath116 . then for @xmath117",
    ", we have @xmath118 . since the adjacent linear pieces have different slopes , @xmath119 . while @xmath49 is effective , so @xmath120 .",
    "now we let @xmath121 have two linear pieces on @xmath27 , the one containing @xmath122 with slope @xmath123 , the one containing @xmath124 with slope @xmath125 .",
    "note that if @xmath126 then @xmath121 coincides with @xmath4 on @xmath27 . if @xmath127 , since @xmath128 , the graph of the two pieces of @xmath121 will intersect within the interval , so @xmath121 is well - defined on @xmath27 .",
    "in addition let @xmath129 be the intersection point of these two pieces , then @xmath130 .",
    "we let @xmath131 . by definition of @xmath121 , @xmath98 is effective and anchor , and @xmath98 satisfies both ( i ) and ( ii ) .",
    "\\(2 ) note that for @xmath95 , the two cells @xmath64 and @xmath97 share the same first and third parts of their data , and given any edge @xmath27 of @xmath3 , either both do not have a partition , or they have the partitions of the same positive integer .",
    "the only difference is that the partition of @xmath97 is always trivial , while the partition of @xmath64 could be arbitrary . given a positive integer @xmath132 , there are @xmath133 ordered partitions of @xmath132 objects in a row , because each partition corresponds to a @xmath134-tuple of @xmath135 , indicating whether or not to break the @xmath134 pairs of adjacent objects .",
    "in addition , for @xmath136 , there are @xmath137 ordered partitions with @xmath138 parts .",
    "then if @xmath139 is an interior point on edge @xmath89 with @xmath140 , the partition on @xmath89 of a preimage of @xmath86 has @xmath141 choices .",
    "once all partitions are determined , so is the preimage . then @xmath142",
    "furthermore , note that if the number of parts in the partition on one edge increases by @xmath75 , the number of connected components in proposition [ prop : dim ] also increases by @xmath75 , which means the dimension of the new cell is one more . then for @xmath103",
    ", the number of cells with dimension @xmath105 in @xmath106 equals to the number of the @xmath113-tuples of partitions of @xmath143 with @xmath144 parts in total .",
    "this number is @xmath104 by an easy argument of generating functions .",
    "the following corollary provides a combinatorial formula to compute the @xmath4-vector of @xmath0 given all of its anchor cells .",
    "[ cor : fvec ] let @xmath1 be a vertex - supported effective divisor on a metric graph @xmath3",
    ". for an anchor cell @xmath86 in @xmath0 , define @xmath145 as in theorem [ thm : anc ] .",
    "if @xmath146 are all anchor cells in @xmath0 , then for each @xmath147 the number of @xmath69-dimensional cells in the cell complex @xmath0 is the coefficient of @xmath148 in the generating function @xmath149    by theorem [ thm : anc](1 ) , each cell in @xmath0 is associated to a unique anchor cell of @xmath0 , i.e. @xmath150 . by theorem [ thm : anc](2 ) , the generating function for @xmath151 is @xmath152 .",
    "so the total generating function is just their sum .",
    "let @xmath3 have the skeleton of the complete bipartite graph @xmath153 and let @xmath29 be the canonical divisor on @xmath3 . if @xmath49 is the left divisor in figure [ fig : div ] , then @xmath49 has two chips on two edges respectively",
    ". then @xmath154 cells of @xmath155 are associated to @xmath49 . by theorem [ prop :",
    "dim ] , their dimensions are @xmath156 respectively .      with the anchor cells , we have the following approach for finding the cells of @xmath0 .",
    "a.   computing the anchor cells of @xmath0 ; [ enu : anc ] b.   given the anchor cells of @xmath0 , computing the other cells of @xmath0 .",
    "[ enu : asso ]    step ( [ enu : asso ] ) is done by corollary [ cor : fvec ] .",
    "we then explain implementations of step ( [ enu : anc ] ) .",
    "we first introduce some properties of anchor cells .",
    "[ lem:2piece ] let @xmath1 be a vertex - supported effective divisor on a metric graph @xmath3 .",
    "if @xmath25 and @xmath22 is an anchor divisor , then @xmath4 has at most two linear pieces on each edge of @xmath3 .",
    "for any edge @xmath27 of @xmath3 , suppose @xmath15 is an interior point of @xmath27 and it is the intersection of two linear pieces of @xmath4 with different slopes .",
    "then , by definition , we have @xmath157 .",
    "since @xmath1 is vertex - supported , @xmath158 . then @xmath159 . since @xmath25 ,",
    "the divisor @xmath22 is effective , so @xmath160 .",
    "however @xmath22 is an anchor divisor , meaning that there is at most one such point @xmath15 , so @xmath4 has at most two linear pieces on @xmath27 .    therefore if the outgoing slopes at the two endpoints of @xmath27 sum to @xmath55 , then @xmath4 is linear on @xmath27 ; otherwise @xmath4 has two linear pieces on @xmath27 and there is one interior point @xmath15 of @xmath27 such that @xmath160 .",
    "[ cor : anc ] let @xmath1 be a vertex - supported divisor on a metric graph @xmath3 . if @xmath64 is an anchor cell and it is represented by a divisor @xmath22 , then @xmath64 is uniquely determined by the outgoing slopes of @xmath4 at all vertices of @xmath3 .",
    "it suffices to show that given all those slopes , the data of @xmath64 are uniquely determined .",
    "firstly , the @xmath48 are determined given those slopes .",
    "secondly we show that the @xmath56 are also determined .",
    "if @xmath64 is an anchor cell and @xmath22 is a representative of @xmath64 , then @xmath22 is an anchor divisor . by lemma [ lem:2piece ]",
    ", @xmath4 has at most two linear pieces on each edge @xmath27 of @xmath3 .",
    "if @xmath4 is linear on @xmath27 , then the integer @xmath56 is zero for @xmath22 ; otherwise @xmath4 has two linear pieces on @xmath27 .",
    "suppose they have a common point @xmath58 .",
    "then @xmath161 is minus the sum of the two outgoing slopes at the endpoints of @xmath27 , so @xmath56 is still determined by those slopes .",
    "finally for each vertex @xmath58 of @xmath3 , @xmath162 .",
    "@xmath163 is known , and each @xmath164 , which is the sum of the outgoing slopes at v , is also determined , so @xmath45 is determined too .",
    "( ( * ? ? ?",
    "* lemma 7))[lem : bd ] let @xmath1 be an effective divisor on a metric graph @xmath3 and @xmath25 .",
    "then the slopes of all linear pieces of @xmath4 are between @xmath165 and @xmath166 .    by corollary [ cor : anc ] and lemma [ lem : bd ] , we can find all anchor cells by considering the @xmath167-tuple of outgoing slopes of all @xmath25 with at most two linear piece(s ) on each edge of @xmath3 .",
    "in particular we have a proof of the finiteness of anchor cells .",
    "next we implement this approach using linear programming algorithms .",
    "suppose @xmath57 , where @xmath168 is the set of vertices and @xmath169 is the set of edges . for @xmath170 , the edge @xmath171 has endpoints @xmath172 and @xmath173 , where @xmath174 , and the length of @xmath89 is @xmath175 .",
    "for @xmath176 let @xmath177 and @xmath178 .",
    "[ lem : ancfun ] let @xmath4 be a rational function defined on @xmath57 such that there are at most two linear pieces on each edge of @xmath3",
    ". denote by @xmath179 for @xmath176 and by @xmath180 the outgoing slope at @xmath172 and @xmath173 of @xmath171 for @xmath170 .",
    "then @xmath25 if and only if    * for each vertex @xmath181 we have the equations @xmath182 * for @xmath170 , either @xmath183 or @xmath184    suppose @xmath25 .",
    "note that for each @xmath176 we have @xmath185 , then @xmath186 for each @xmath170 , @xmath4 has either one or two linear piece(s ) on the edge @xmath171 .",
    "if there is one linear piece , then @xmath187 , and by definition of slope we have @xmath188 ; if there are two linear pieces , then there exists an interior point @xmath129 of @xmath171 such that @xmath4 is linear on both line segments @xmath189 and @xmath190 , and @xmath191 .",
    "note that @xmath192 , so @xmath193 .",
    "let @xmath15 be the length of the segment @xmath189 , then the length of the segment @xmath190 is @xmath194 . and by definition of slope we have @xmath195",
    "since @xmath196 can be any real number , we eliminate it and get @xmath197 then @xmath198 since @xmath129 is an anterior point of @xmath171 , we have @xmath199",
    ". then @xmath200 and @xmath201 .",
    "conversely , suppose for each @xmath176 ( [ eq : ver ] ) holds and for each @xmath170 , either ( [ eq:1pc ] ) or ( [ eq:2pc ] ) holds .",
    "for each @xmath170 , if @xmath187 then by ( [ eq:1pc ] ) @xmath4 is well - defined on @xmath171 and @xmath202 for all points @xmath203 in the interior of @xmath171 ; otherwise ( [ eq:2pc ] ) holds , by the chain inequalities @xmath4 is well - defined on @xmath171 with two linear pieces . since @xmath193 , we have @xmath202 for all points",
    "@xmath203 in the interior of @xmath171",
    ". finally for each @xmath176 , ( [ eq : ver ] ) holds .",
    "then @xmath204 .",
    "so @xmath4 is a well - defined rational function on @xmath3 with at most two linear pieces on each edge of @xmath3 and @xmath25 .",
    "note that if @xmath22 is an anchor divisor in @xmath0 , then it also has degree @xmath69 and its support has at most one intersection point with each open @xmath89 .",
    "thus we obtain a partition of @xmath69 into @xmath205 nonnegative integers : @xmath206 , where @xmath207 and @xmath208 .",
    "we call them as _ configurations _ of anchor divisors .",
    "note that there are @xmath209 configurations in total .",
    "[ cor : cfg ] suppose @xmath25 with the same notations as in lemma [ lem : ancfun ] .",
    "let @xmath206 be the configuration of the divisor @xmath22 , then for @xmath170 , we have @xmath210 and for @xmath176 we have @xmath211    now for each configuration @xmath206 , we consider the following system of linear constraints in ( [ eq:1pc ] ) , ( [ eq:2pc ] ) , ( [ eq : cfge ] ) , ( [ eq : cfgv ] )",
    ". here @xmath212 are parameters and @xmath213 are variables .",
    "then among the solutions of this system , each @xmath214-tuple of integers @xmath180 gives an anchor cell of @xmath0 .    for each @xmath215 , whether to apply ( [ eq:1pc ] ) or ( [ eq:2pc ] ) depends on the value of @xmath216 .",
    "lemma [ lem : ancfun ] and corollary [ cor : cfg ] gives rise to the following algorithm .",
    "the input is the metric graph @xmath57 , the edge lengths @xmath217 and the divisor @xmath1 .",
    "the output @xmath49 is a list of the anchor cells .",
    "@xmath218 @xmath219 @xmath220 @xmath221 @xmath222 @xmath223 the system of linear constraints in ( [ eq:1pc ] ) , ( [ eq:2pc ] ) , ( [ eq : cfge ] ) , ( [ eq : cfgv ] ) ( * ) next @xmath38 @xmath224 array of @xmath225 entries @xmath226 array of @xmath225 entries @xmath227 \\gets [ minimize(s_{j,1},s),maximize(s_{j,1},s ) ] \\cap \\mathbb{z}$ ] @xmath228 \\gets [ minimize(s_{j,2},s),maximize(s_{j,2},s ) ] \\cap \\mathbb{z}$ ] @xmath229 the cartesian product of @xmath230,\\ldots , a[m],b[1],\\ldots , b[m]$ ] @xmath231\\}$ ] * return * @xmath49    \\(1 ) we use integer programming method for step ( * ) . in maple 2015",
    "there is a command lpsolve that is able to do it .",
    "+ ( 2 ) in this algorithm we do not require the metric graph to be simple .",
    "we allow both loops and parallel edges .",
    "we can also deal with more general input .",
    "suppose the skeleton of @xmath3 is fixed , but the metric may vary . in this case",
    "the input is the metric @xmath232 , and the desired output is the set of anchor cells in @xmath0 .",
    "apparently we can apply the above approach once the @xmath217 are given , but since algorithm [ alg : anc ] needs to run the linear - programming subroutine @xmath209 times , it is not very efficient if we would like to compute for many different metrics .    instead , we can also view the @xmath217 s as variables",
    ". however @xmath233 appears in ( [ eq:2pc ] ) . in order to make the system of constraints linear",
    ", we have to let @xmath180 become parameters .",
    "so we take the approach in the proof of proposition [ thm : fin ] .",
    "we still have the equations and inequalities ( [ eq:1pc ] ) , ( [ eq:2pc ] ) , ( [ eq : cfge ] ) , ( [ eq : cfgv ] ) , but @xmath180 are parameters instead .",
    "now the parameters are @xmath234 and the variables are @xmath235",
    ". then we also need @xmath236 for @xmath22 being effective and @xmath237 for the edge lengths in @xmath26 are all positive .    by lemma [ lem : bd ]",
    ", we have @xmath238 .",
    "so there are finitely many possible values of them .",
    "now we have an empty list first and for each choice of @xmath239 , we check the feasibility of the system of linear constraints formed by ( [ eq:1pc ] ) , ( [ eq:2pc ] ) , ( [ eq : cfge ] ) , ( [ eq : cfgv ] ) , ( [ ein : eff ] ) , ( [ ein : pos ] ) .",
    "if it is feasible , then we find one anchor cell and save it to our list .",
    "the output is the set of anchor cells represented by divisors @xmath49 such that there exists some metric @xmath240 with @xmath241 .",
    "the advantage of this approach is that we can compute this list of all possible anchor cells in @xmath0 beforehand .",
    "then given a specific metric , we just plug in the values of @xmath217 and check the feasibility of each anchor cell in the list .",
    "in this section we present the properties of @xmath2 . if @xmath4 and @xmath121 are rational functions defined on @xmath3 , then @xmath242 is the rational function on @xmath3 with @xmath243 and @xmath244 is the rational function on @xmath3 with @xmath245 . in other words ,",
    "@xmath246 and @xmath247 are the _ tropical _ operations in the set of rational functions on @xmath3 . here",
    "we choose the max - plus algebra .",
    "( ( * ? ? ?",
    "* lemma 4 ) ) let @xmath1 be any divisor on a metric graph @xmath3 .",
    "the space @xmath2 is a tropical semi - module , i.e. it is closed under tropical addition and tropical scalar multiplication .",
    "we would like to find a minimal set of generators of the tropical semi - module @xmath2 .",
    "we use the notion of _ chip - firing _ @xcite .    for an effective divisor @xmath1 on @xmath3",
    "we regard it as a distribution of @xmath166 chips on @xmath3 : there are @xmath248 chips at each point @xmath9 .",
    "suppose that @xmath1 is effective and @xmath25 .",
    "for each linear piece @xmath249 of @xmath3 , if @xmath4 has slope @xmath250 from @xmath84 to @xmath85 , then we say that @xmath84 fires @xmath251 chips to @xmath85 when adding @xmath18 to @xmath1 .    for a metric graph @xmath3 , a _",
    "subgraph _ is a compact subset with a finite number of components .",
    "fix an effective divisor @xmath1 on @xmath3 .",
    "we say that a subgraph @xmath252 of @xmath3 can _ fire _ for @xmath1 if , for each boundary point @xmath15 of @xmath253 , the number of edges pointing out of @xmath252 is no greater than @xmath248 .",
    "a function @xmath25 is called _ extremal _ if for any @xmath254",
    ", the decomposition @xmath255 implies that @xmath256 .",
    "any generating set of @xmath2 must contain all extremal generators up to tropical scalar multiplication .",
    "( ( * ? ? ?",
    "* theorem 14(a)))[lem : ext ] if @xmath1 is a vertex - supported divisor on a metric graph @xmath3 and @xmath25 is extremal , then @xmath22 is a vertex of the cell complex @xmath0 .    by lemma [ lem : ext ] in order to find the extremal generators of @xmath2",
    ", it suffices to search among the vertices of @xmath0 .",
    "the next lemma is an important criterion for the extremal generators of @xmath2 .",
    "( ( * ? ? ?",
    "* lemma 5))[lem : fire ] let @xmath1 be any divisor on a metric graph @xmath3",
    ". then @xmath25 is extremal if and only if there do not exist two proper subgraphs @xmath257 and @xmath258 of @xmath3 such that they cover @xmath3 and both can fire on @xmath22 .    for a non - extremal @xmath25 ,",
    "the proper subgraphs @xmath257 and @xmath258 may not be obvious .",
    "see the example in figure [ fig : div ] , where @xmath3 is the metric graph with skeleton @xmath153 and all - equal metric , @xmath259 is the canonical divisor on @xmath3 .    ( 0,0 )  ( 0,6 )  ( 3,0 ) (6,6 ) ",
    "( 0,0 ) (6,6 ) ; ( 3,6 )  ( 3,0 ) ; ( 0,6 )  ( 6,0 ) ; ( 0,3 ) circle ( 3pt ) ; ( 3,0 ) circle ( 3pt ) ; ( 3,6 ) circle ( 3pt ) ; ( 6,3 ) circle ( 3pt ) ; at ( 0,3 ) 2 ; at ( 6,3 ) 2 ; at ( 3,0 ) 1 ; at ( 3,6 ) 1 ;    ( 0,3 )  ( 0,6 )  ( 3,0 ) (3,6 ) ",
    "( 6,3 ) ; ( 0,6 ) ",
    "( 6,0 ) ; ( 0,3 ) ",
    "( 0,1.8 ) ; ( 6,3 ) ",
    "( 6,4.2 ) ; ( 3,0 ) ",
    "( 3.5,1 ) ; ( 3,6 ) ",
    "( 2.5,5 ) ; ( 0,1.8 ) ",
    "( 2.5,5 ) ; ( 6,4.2 ) ",
    "( 3.5,1 ) ; ( 0,0 )  ( 6,6 ) ; ( 0,3 ) circle ( 3pt ) ; ( 3,0 ) circle ( 3pt ) ; ( 3,6 ) circle ( 3pt ) ; ( 6,3 ) circle ( 3pt ) ; at ( 0,3 ) 2 ; at ( 6,3 ) 2 ; at ( 3,0 ) 1 ; at ( 3,6 ) 1 ;    ( 0,3 )  ( 0,0 ) ",
    "( 3,6 ) (3,0 ) ",
    "( 6,3 ) ; ( 0,0 ) ",
    "( 6,6 ) ; ( 0,3 )  ( 0,4.2 ) ; ( 6,3 ) ",
    "( 6,1.8 ) ; ( 3,0 ) ",
    "( 2.5,1 ) ; ( 3,6 ) ",
    "( 3.5,5 ) ; ( 0,4.2 ) ",
    "( 2.5,1 ) ; ( 6,1.8 )  ( 6,0 ) ",
    "( 3.5,5 ) ; ( 0,6 ) ",
    "( 6,0 ) ; ( 0,3 ) circle ( 3pt ) ; ( 3,0 ) circle ( 3pt ) ; ( 3,6 ) circle ( 3pt ) ; ( 6,3 ) circle ( 3pt ) ; at ( 0,3 ) 2 ; at ( 6,3 ) 2 ; at ( 3,0 ) 1 ; at ( 3,6 ) 1 ;    our discussion suggests the following approach for computing all extremal generators of @xmath2 :    a.   find all anchor divisors in @xmath2 .",
    "b.   filter them by theorem [ prop : dim ] to get all vertices of @xmath0 .",
    "c.   filter the vertices by lemma [ lem : fire ] to get all extremal generators of @xmath2.[enu : ext ]    we introduce a method for step ( [ enu : ext ] ) . given an effective divisor @xmath54 on @xmath3 , we apply lemma [ lem : fire ] to check whether @xmath4 is extremal . note that if a proper subgraph can fire for @xmath49 , then its boundary is contained in @xmath260 .",
    "so we partition @xmath3 into connected subgraphs whose boundaries are contained in @xmath260 and we call them components .",
    "since @xmath260 is finite , so is the number of such components .",
    "we conclude that any subgraph that can fire for @xmath49 is a union of these components .",
    "for each such union , we ignore it if it is non - proper or can not fire for @xmath49 , then we have a finite list of all proper subgraphs of @xmath3 that can fire for @xmath49",
    ". finally we check whether there is a pair in the list that covers @xmath3 .",
    "in this section we apply our methods to some nontrivial examples .",
    "a metric graph is _ trivalent _ if the degree of every vertex is @xmath59 .",
    "trivalent graphs appear in the berkovich skeleton of many curves ( * ? ? ?",
    "* example 5.29 ) .",
    "this fact motivates us to compute the examples of trivalent metric graphs and the canonical divisor @xmath29 .    for the computations we performed below",
    ", our hardware is a laptop with intel core i5 - 6200u processor ( 2.3 ghz ) and 8 gb ram .",
    "the software is maple , version 2015 .",
    "all computations were single - threaded .",
    "the complete graph @xmath262 has @xmath263 vertices and its genus is @xmath59 .",
    "table [ tab : k4 ] shows the structure of @xmath264 and @xmath265 on @xmath261 given a particular metric @xmath26 . for @xmath266 let @xmath267 be the edge length between vertex @xmath138 and @xmath215 .",
    "a metric @xmath26 is given by @xmath268 .",
    "[ cols=\"^ \" , ]      + all - equal & 370 & 33 & @xmath269 & @xmath270 + & 460 & 63 & @xmath271 & @xmath272 + & 730 & 84 & @xmath273 & @xmath274 +    [ tab : k33 ]    [ rem : char ] by ( * ? ? ?",
    "* corollary 31 ) , the cell complex @xmath0 is contractible as a topological space .",
    "thus the euler characteristic of @xmath0 is always @xmath75 , which coincides with all the @xmath4-vectors we computed above .",
    "here are some open problems for further research on this topic .",
    "* fixing the skeleton of @xmath3 and @xmath1 , find the polyhedral cone decomposition of @xmath275 based on the cell structure of @xmath0 .",
    "in particular , determine the metrics @xmath26 such that @xmath33 has dimension @xmath276 .",
    "* given all the cells in @xmath0 , find the face lattice of @xmath0 . in general , if we apply chip - firing to a representative of a cell , we may obtain a representative of a cell on its boundary , but the rigorous argument is yet to be established . *",
    "given the skeleton of @xmath3 and @xmath1 , find non - trivial upper and lower bounds of the number of anchor cells ( or cells , vertices ) in @xmath0 and of the number of extremal generators in @xmath2 .",
    "10    m.  baker .",
    "specialization of linear systems from curves to graphs .",
    ", 2(6):613653 , 2008 .",
    "m.  baker and x.  faber .",
    "metrized graphs , laplacian operators , and electrical networks . , 415:1534 , 2006 .",
    "m.  baker and s.  norine .",
    "riemann - roch and abel - jacobi theory on a finite graph . , 215(2):766788 , 2007 .",
    "m.  baker , s.  payne , and j.  rabinoff .",
    "non - archimedean geometry , tropicalization , and metrics on curves .",
    ", 3(1):63105 , 2016 .",
    "a.  bjrner , l.  lovsz , and p.  w. shor .",
    "chip - firing games on graphs . , 12(4):283291 , 1991 .",
    "s.  brodsky , m.  joswig , r.  morrison , and b.  sturmfels .",
    "moduli of tropical plane curves .",
    ", 2(1):1 , 2015 .",
    "a.  gathmann and m.  kerber .",
    "a riemann  roch theorem in tropical geometry . , 259(1):217230 , 2008 .",
    "p.  griffiths and j.  harris . .",
    "john wiley & sons , 2014 .    c.  haase , g.  musiker , and j.  yu .",
    "linear systems on tropical curves . , 270(3 - 4):11111140 , 2012 .",
    "d.  maclagan and b.  sturmfels . ,",
    "volume 161 .",
    "american mathematical soc . ,",
    "g.  mikhalkin and i.  zharkov .",
    "tropical curves , their jacobians and theta functions . , 465:203230 , 2008 .",
    "the author is grateful to bernd sturmfels for his guidance and encouragement throughout this project .",
    "the author thanks madhusudan manjunath , ralph morrison and kristian ranestad for helpful discussions and comments .",
    "the author thanks yang an , matt baker and josephine yu for their precious suggestions .",
    "the author also thanks two anonymous referees for their critical comments on an earlier version of this work ."
  ],
  "abstract_text": [
    "<S> the linear system @xmath0 of a divisor @xmath1 on a metric graph has the structure of a cell complex . </S>",
    "<S> we introduce the anchor divisors and anchor cells in it - they serve as the landmarks for us to compute the f - vector of the complex and find all cells in the complex . </S>",
    "<S> a linear system can also be identified as a tropical convex hull of rational functions . </S>",
    "<S> we compute its extremal generators using the landmarks . </S>",
    "<S> we apply these methods to some examples - namely the canonical linear systems of some small trivalent graphs . </S>"
  ]
}