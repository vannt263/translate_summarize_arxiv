{
  "article_text": [
    "trapped laser - cooled ions represent a versatile experimental platform offering near - perfect control and tomography of a few body system in the classical and quantum domain  @xcite .",
    "the fact that both internal ( qubit ) and external ( normal modes of oscillation ) degrees of freedom can be manipulated in the quantum regime allows for many applications in the fields of quantum information processing and quantum simulation  @xcite .",
    "currently , a significant research effort is devoted to scaling these experiments up to larger numbers of qubits . a promising technology to achieve this goal",
    "are _ microstructured segmented ion traps _ , where small ion groups are stored in local potentials and ions are shuttled within the trap by applying suitable voltage ramps to the trap electrodes  @xcite . in order to enable scalable experiments in the quantum domain , these shuttling operations have to be performed such that the required time is much shorter than the timescales of the relevant decoherence processes .",
    "at the same time , one needs to avoid excitation of the ion s motion after the shuttling operation .",
    "these opposing requirements clearly call for the application of advanced control techniques .",
    "adiabatic ion shuttling operations in a segmented trap have been demonstrated in ref .",
    "recent experiments have achieved non adiabatic shuttling of single ions within a few trap oscillation cycles while retaining the quantum ground state of motion  @xcite .",
    "this was made possible by finding ` sweet spots '  in the shuttling time or removal of the excess energy accumulated during the shuttling by kicks of the trap potential . given the experimental constraints , it is natural to ask what the speed limitations for the shuttling process are . the impact of quantum effects for fast shuttling operations , i.e. , distortions of the wavepacket , also need to be analyzed , and it needs to be assessed whether quantum control techniques  @xcite may be applied to avoid these .",
    "moreover , from a control - theoretical perspective and in view of possible future application in experiment , it is of interest to analyze how optimized voltage ramps can be obtained .",
    "optimal control theory ( oct ) combined with classical equations of motion was employed in ref .",
    "@xcite to obtain optimized voltage ramps .",
    "quantum effects were predicted not to play a role unless the shuttling takes place on a timescale of a single oscillation period . in refs .",
    "@xcite , control techniques such as inverse engineering were applied to atomic shuttling problems .",
    "the transport of atomic wavepackets in optical dipole potentials was investigated using oct with quantum mechanical equations of motion  @xcite .",
    "the purpose of the present paper is to assess available optimization strategies for the specific problem of transporting a single ion in a microchip ion trap and to utilize them to study the quantum speed limit for this process  @xcite , i.e. , to determine the shortest possible time for the transport .",
    "although parameters of the trap architecture of ref .",
    "@xcite are used throughout the entire manuscript , we strongly emphasize that the qualitative results we obtain hold over a wide parameter regime .",
    "they are thus generally valid for current segmented ion traps , implemented with surface electrode geometry  @xcite or more traditional multilayer geometry .",
    "the paper is organized as follows .",
    "we start by outlining the theoretical framework in sec .",
    "[ subs : ttcp ] .",
    "in particular we review the combination of numerical optimization with classical dynamics in sec .",
    "[ subs : kloct ] and with wavepacket motion in sec .",
    "[ subs : qmoct ] . analytical solutions to the control problem , obtained from the harmonic approximation of the trapping potential ,",
    "are presented in secs .",
    "[ subsec : geometric ] and  [ subs : invmeth0 ] . section  [ subs : apcontrol ] is devoted to the presentation and discussion of our results .",
    "the control solutions for purely classical dynamics of the ion , obtained both numerically and analytically , yield a minimum transport duration as shown in sec .",
    "[ subs : kloct2 ] .",
    "we discuss in sec .",
    "[ subs : qmprop2 ] , how far these solutions correspond to the quantum speed limit .",
    "our results obtained by invariant - based inverse engineering are presented in sec .",
    "[ subs : invmeth ] , and we analyze the feasibility of quantum optimal control in sec .",
    "[ subs : qmoct2 ] .",
    "section  [ sec : concl ] concludes our paper .",
    "in the following we present the numerical methods we employ to control the transport of a single trapped ion . besides numerical optimization describing the motion of the ion either with classical mechanics or via wavepacket propagation ,",
    "we also utilize two analytical methods .",
    "this is made possible by the trap geometry which leads to an almost perfectly harmonic trapping potential for the ion at all times .",
    "we assume ponderomotive confinement of the ion at the rf - node of a linear segmented paul trap and a purely electrostatic confinement along the trap axis @xmath0 , see fig .",
    "[ fig : electrodes ] .",
    "this enables us to treat the dynamics only along this dimension .",
    "we consider transport of a single ion with mass @xmath1 between two neighboring electrodes , which give rise to individual potentials centered at @xmath2 and @xmath3 .",
    "this may be scaled up to @xmath4 electrodes and longer transports without any loss of generality .",
    "-axis . the rf electrodes for confinement of the ions along the @xmath0-axis are not shown .",
    "( b ) axial electrode potentials formed by applying a dc voltage to a facing pair of trap segments . for the specific scenario presented in this manuscript",
    ", we use @xmath5 m , @xmath6 m and @xmath7 m .",
    "each potential is generated from a single pair of segments , depicted in red in ( a ) and biased to 1@xmath8v with all the other dc electrodes grounded . , title=\"fig:\",scaledwidth=40.0% ] -axis . the rf electrodes for confinement of the ions along the @xmath0-axis are not shown .",
    "( b ) axial electrode potentials formed by applying a dc voltage to a facing pair of trap segments . for the specific scenario presented in this manuscript , we use @xmath5 m , @xmath6 m and @xmath7 m .",
    "each potential is generated from a single pair of segments , depicted in red in ( a ) and biased to 1@xmath8v with all the other dc electrodes grounded .",
    ", title=\"fig:\",scaledwidth=46.0% ]    the ion motion is controlled by a time - dependent electrostatic potential , @xmath9 with segment voltages @xmath10 , and normal electrode potentials on the trap axis , @xmath11 .",
    "they are dimensionless electrostatic potentials obtained with a bias of @xmath12  v at electrode @xmath13 and the remaining electrodes grounded ( see fig .",
    "[ fig : electrodes](b ) ) .",
    "these potentials are calculated by using a fast multipole boundary element method  @xcite for the trap geometry used in recent experiments  @xcite and shown in fig .",
    "[ fig : electrodes ] . in order to speed up numerics and obtain smooth derivatives ,",
    "we calculate values for @xmath11 on a mesh and fit rational functions to the resulting data .",
    "the spatial derivatives @xmath14 and @xmath15 are obtained by differentiation of the fit functions .",
    "previous experiments have shown that the calculated potentials allow for the prediction of ion positions and trap frequencies with an accuracy of one per cent  @xcite which indicates the precision of the microtrap fabrication process .",
    "an increase in the precision can be achieved by calibrating the trapping potentials using resolved sideband spectroscopy .",
    "this is sufficient to warrant the application of control techniques as studied here . for the geometry of the trap described in ref .",
    "@xcite , we obtain harmonic trap frequencies of about @xmath161.3  mhz with a bias voltage of -7  v at a single trapping segment .",
    "the individual segments are spaced 280  @xmath17 m apart .",
    "our goal is to shuttle a single ion along this distance within a time span on the order of the oscillation period by changing the voltages @xmath18 and @xmath19 , which are supposed to stay within a predetermined range that is set by experimental constraints .",
    "we seek to minimize the amount of motional excitation due to the shuttling process .      assuming the ion dynamics to be well described classically",
    ", we optimize the time dependent voltages in order to reduce the amount of transferred energy .",
    "this corresponds to minimizing the functional @xmath20 , @xmath21 i.e. , to miniziming the difference between desired energy @xmath22 and the energy @xmath23 obtained at the final time @xmath24 .",
    "@xmath25 is the update of each voltage ramp in an iteration step @xmath26 , and the second term in eq",
    ".   limits the overall change in the integrated voltages during one iteration .",
    "the weight @xmath27 is used to tune the convergence and limit the updates . to suppress updates near @xmath28 and @xmath29 the shape function @xmath30",
    "is chosen to be zero at these points in time . for a predominantly harmonic axial confinement ,",
    "the final energy is given by @xmath31 in order to obtain transport without motional excitation , we choose @xmath32 .",
    "evaluation of eq .",
    "requires solution of the classical equation of motion .",
    "it reads @xmath33 for a single ion trapped in the potential of eq .   and is solved numerically using a _ dormand - prince runge - kutta _",
    "integrator  @xcite .",
    "employing krotov s method for optimal control  @xcite together with the classical equation of motion , eq .  , we obtain the following iterative update rule : @xmath34 where @xmath26 denotes the previous iteration step .",
    "@xmath35 is a costate vector which evolves according to @xmath36 with its ` initial ' condition defined at the final time @xmath24 : @xmath37 the algorithm works by propagating @xmath38 forward in time , solving eq .   with an initial guess for @xmath10 and iterating the following steps",
    "until the desired value of @xmath20 is achieved :    1 .   obtain @xmath39 according to eq .   and propagate @xmath40 backwards in time using eq .  .",
    "2 .   update the voltages according to eq .   at each time",
    "step while propagating @xmath38 forward in time with the immediately updated voltages .",
    "the optimization algorithm shows rapid convergence and brings the final excitation energy @xmath23 as close to zero as desired .",
    "an example of an optimized voltage ramp is shown in fig .",
    "[ fig : guesscfoct](a ) .",
    "the voltages obtained are not symmetric under time reversal in contrast to the initial guess .",
    "this is rationalized by the voltage updates occurring only during forward propagation which breaks the time reversal symmetry .",
    "we find this behavior to be typical for the krotov algorithm combined with the classical equation of motion .",
    "when quantum effects are expected to influence the transport , the ion has to be described by a wave function @xmath41 .",
    "the control target is then to perfectly transfer the initial wavefunction , typically the ground state of the trapping potential centered around position @xmath2 , to a target wavefunction , i.e. , the ground state of the trapping potential centered around position @xmath3 .",
    "this is achieved by minimizing the functional @xmath42 here , @xmath43 denotes the wave function of the single ion propagated with the set of voltages @xmath10 , and @xmath44 is the target wave function .",
    "the voltage updates @xmath45 , scaling factor @xmath27 and shape function @xmath46 have identical meanings as in sec .",
    "[ subs : kloct ] .",
    "@xmath43 is obtained by solving the time - dependent schrdinger equation ( tdse ) , @xmath47 as in the classical case , optimization of the transport problem is tackled using krotov s method  @xcite . the update equation derived from eq .",
    "is given by @xmath48 with @xmath26 denoting the iteration step .",
    "@xmath49 is a costate wave function obeying the tdse with ` initial ' condition @xmath50 \\psi^{{\\operatorname{tgt}}}(x , t)\\,.\\ ] ] optimized voltages @xmath10 are obtained similarly to sec .",
    "[ subs : kloct ] , i.e. , one starts with the ground state , propagates @xmath41 forward in time according to eq .  , using an initial guess for the voltage ramps , and iterates the following steps until the desired value of @xmath20 is achieved :    1 .",
    "compute the costate wave function at the final time @xmath24 according to eq .   and propagate @xmath49 backwards in time , storing @xmath49 at each timestep .",
    "2 .   update the control voltages according to eq .   using the stored @xmath49 , while propagating @xmath41 forward using the immediately updated control voltages .",
    "equations   and   imply a sufficiently large initial overlap between the wave function , which is forward propagated under the initial guess , and the target state in order to obtain a reasonable voltage update .",
    "this emphasizes the need for good initial guess ramps and illustrates the difficulty of the control problem when large phase space volumes need to be covered .    to solve the tdse numerically",
    ", we use the chebshev propagator  @xcite in conjunction with a fourier grid  @xcite for efficient and accurate application of the kinetic energy part of the hamiltonian . denoting the transport time by @xmath24 and the inter - electrode spacing by @xmath51 , the average momentum during the shuttling",
    "is given by @xmath52 .",
    "typical values of these parameters yield a phase space volume of @xmath53 .",
    "this requires the numerical integration to be extremely stable . in order to ease the numerical treatment",
    ", we can exploit the fact that the wavefunction s spatial extent is much smaller than @xmath51 and most excess energy occurs in the form of classical oscillations .",
    "this allows for propagating the wave function on a small _ moving grid _ that extends around the instantaneous position and momentum expectation values  @xcite .",
    "the details of our implementation combining the fourier representation and a moving grid are described in  [ subs : qmprop ] .",
    "any optimization , no matter whether it employs classical or quantum equations of motion , starts from an initial guess . for many optimization problems , and in particular when using gradient - based methods for optimization ,",
    "a physically motivated initial guess is crucial for success of the optimization  @xcite .",
    "here , we design the initial guess for the voltage ramps such that the ion is dragged from position @xmath2 to @xmath3 in a smooth fashion .",
    "this is achieved as follows : the trapping potential @xmath54 can be described by the position of its local minimum @xmath55 .",
    "obviously , @xmath55 needs to fulfill the boundary conditions @xmath56 , @xmath57 . in order to ensure smooth acceleration and deceleration of the center of the trap",
    ", we also demand @xmath58 .",
    "a possible ansatz fulfilling these boundary conditions is given by a polynomial of order 6 , @xmath59 where @xmath60 denotes the transport distance and @xmath61 is a dimensionless time .    to derive initial guess voltages @xmath62",
    ", we use as a first condition that the local minimum of the potential coincides with @xmath55 .",
    "second , we fix the trap frequency @xmath63 to a constant value throughout the whole shuttling process , @xmath64 these equations depend on first and second order spatial derivatives of the electrode potentials . solving for @xmath65 , @xmath66 , we obtain @xmath67 an example is shown in fig .",
    "[ fig : guesscfoct ] .",
    "if the electrode potentials have translational symmetry , i.e. , @xmath68 , then @xmath69 .",
    "this condition is approximately met for sufficiently homogeneous trap architectures .",
    "ca@xmath70 ion from electrode 1 ( solid lines ) to electrode 2 ( dashed lines ) within 418@xmath8ns for an initial trap frequency of @xmath71mhz : initial guess voltage ramps ( a and b , black ) and ramps obtained by classical optimization ( a , blue ) and the invariant - based inverse engineering ( b , green).,title=\"fig:\",scaledwidth=45.0% ] ca@xmath70 ion from electrode 1 ( solid lines ) to electrode 2 ( dashed lines ) within 418@xmath8ns for an initial trap frequency of @xmath71mhz : initial guess voltage ramps ( a and b , black ) and ramps obtained by classical optimization ( a , blue ) and the invariant - based inverse engineering ( b , green).,title=\"fig:\",scaledwidth=45.0% ]      most current ion traps are fairly well described by a simple harmonic model , @xmath72 where @xmath73 is the trap frequency and @xmath74 are dimensionless control parameters which correspond to the electrode voltages . since the equations of motion can be solved analytically",
    ", one can also hope to solve the control problem analytically .",
    "one option is given by pontryagin s maximum principle  @xcite which allows to determine time - optimal controls .",
    "compared to numerical optimization which always yields local optima , pontryagin s maximum principle guarantees the optimum to be global .    in general , the cost functional , @xmath75 = \\int_0^t g(\\mathbf{y},\\mathbf{u } ) { \\ensuremath{\\ , \\textnormal{d}}}t\\,,\\ ] ] is minimized for the equation of motion @xmath76 and a running cost @xmath77 with @xmath78 and @xmath79 in our case .",
    "the optimization problem is formally equivalent to finding a classical trajectory by the principle of least action .",
    "the corresponding classical control hamiltonian that completely captures the optimization problem is given by @xmath80 with costate @xmath81 , obeying @xmath82 and @xmath83 a constant to compensate dimension .",
    "pontryagin s principle states that @xmath84 becomes maximal for the optimal choice of @xmath85  @xcite .    here",
    "we seek to minimize the transport time @xmath24 . the cost functional then becomes @xmath75 = \\int_0^{t_{\\rm{min } } } { \\ensuremath{\\ , \\textnormal{d}}}t = t_{\\rm{min}}\\,,\\ ] ] which is independent of @xmath86 itself and leads to @xmath87 . inserting the classical equations of motion @xmath88 ,",
    "the control hamiltonian becomes @xmath89 we bound @xmath90 and @xmath91 by @xmath92 which corresponds to the experimental voltage limit . since @xmath84 is linear in @xmath74 and @xmath93 , @xmath84 becomes maximal depending on the sign of @xmath94 , @xmath95 evaluating eq .   for @xmath84 of eq .",
    "leads to @xmath96 in view of eq .  , the only useful choice is @xmath97 . otherwise the second electrode would be biased to a positive voltage , leading to a repulsive instead of an attractive potential acting on the ion .",
    "the equations of motion for the costate thus become @xmath98 for a negative constant @xmath99 , @xmath94 is never going to cross zero .",
    "this implies that there will not be a switch in voltages leading to continuous acceleration . for positive @xmath99 there will be a zero crossing at time @xmath100 .",
    "the optimal solution thus corresponds to a single switch of the voltages .",
    "we will analyze this solution and compare it to the solutions obtained by numerical optimization below in section  [ subs : apcontrol ] .      for quantum mechanical equations of motion ,",
    "geometric optimal control is limited to very simple dynamics such as that of three- or four - level systems , see e.g. ref .",
    "a second analytical approach that is perfectly adapted to the quantum harmonic oscillator utilizes the lewis - riesenfeld theory which introduces dynamical invariants and their eigenstates  @xcite .",
    "this invariant - based inverse engineering approach ( iea ) has recently been applied to the transport problem  @xcite .",
    "the basic idea is to compensate the inertial force occurring during the transport sequence . to this end",
    ", the potential is written in the following form : @xmath101 the functions @xmath102 , @xmath103 , @xmath104 and @xmath105 have to fulfill constraints , @xmath106 where @xmath107 is a constant and @xmath108 an arbitrary function .",
    "we choose @xmath109 , @xmath110 , and @xmath55 to be the transport function of sec .",
    "[ subs : guessgen ] .",
    "this enables us to deduce the construction rule for @xmath111 , using eq .",
    ", @xmath112 such that @xmath111 compensates the inertial force given by the acceleration of the trap center . for the potential of eq .",
    ", the hermitian operator @xmath113 ^ 2 + \\frac{1}{2 } m \\omega_0 ^ 2 \\left(\\frac{x-\\alpha}{\\rho}\\right)^2 + u\\left(\\frac{x-\\alpha}{\\rho}\\right)\\ ] ] fulfills the invariance condition for all conceivable quantum states @xmath114 : @xmath115 = 0\\ ] ] with @xmath116 the hamiltonian of the ion .",
    "the requirement for transporting the initial ground state to the ground state of the trap at the final time corresponds to @xmath116 and @xmath117 having a common set of eigenfunctions at initial and final time .",
    "this is the case for @xmath118  @xcite .",
    "we can now identify @xmath108 in eq .   with the trapping potential of eq .  .",
    "the additional compensating force is generated using the same trap electrodes by applying an additional voltage @xmath119 .",
    "for a given transport function @xmath55 we therefore have to solve the underdetermined equation , @xmath120 where @xmath38 is given by the classical trajectory .",
    "since the ion is forced to follow the center of the trap we can set @xmath121 .",
    "the compensating force is supposed to be a function of time only , cf .",
    "eq .  , whereas changing the electrode voltages by @xmath119 will , via the @xmath11 , in general yield a position - dependent force .",
    "this leads to a modified second derivative of the actual potential : @xmath122 where @xmath123 denotes the change in trap frequency due to the compensation voltages @xmath119 , @xmath63 is the initially desired trap frequency , and @xmath62 is found in eq .  .",
    "a time - varying actual frequency @xmath124 might lead to wavepacket squeezing .",
    "however , since eq .",
    "is underdetermined , we can set @xmath125 leading to @xmath126 as desired . with this condition",
    "we can solve eq .   and obtain @xmath127 note that eq .",
    "depends only on the trap geometry .",
    "the transport duration @xmath24 enters merely as a scaling parameter via @xmath128 .",
    "an example of a voltage sequence obtained by this method is shown in ( b ) .",
    "the voltage curves are symmetric under time inversion like the guess voltages , that are derived from the same potential functions @xmath11 .",
    "we now apply the control strategies introduced in sec .",
    "[ subs : ttcp ] to a scenario with the parameters chosen to correspond to a typical experimental setting .",
    "the scaling of the classical speed limit is studied for a fixed maximum control voltage range and we show how in the limiting case the _ bang - bang _ solution is obtained . to verify the validity of the classical solution we are applying the obtained voltage ramps to a quantum mechanical wave packet propagation .",
    "similarly , we use the invariant - based approach and verify the result for a quantum mechanical propagation .",
    "v ( blue ) and ( b ) compares the results of numerical optimization for maximum voltages of 10@xmath8v ( blue ) , 20@xmath8v ( purple ) , and 30@xmath8v ( green ) .",
    "the spikes in ( b ) are due to voltage truncation .",
    ", title=\"fig:\",scaledwidth=45.0% ] v ( blue ) and ( b ) compares the results of numerical optimization for maximum voltages of 10@xmath8v ( blue ) , 20@xmath8v ( purple ) , and 30@xmath8v ( green ) .",
    "the spikes in ( b ) are due to voltage truncation .",
    ", title=\"fig:\",scaledwidth=45.0% ]     vs. maximum electrode voltage @xmath129 , obtained from numerical optimization of classical transport dynamics ( blue dots ) along with a fit to eq .  .",
    "we also indicate the analytic bang - bang result , eq .",
    ", derived for idealized , purely harmonic potentials ( purple dashed line ) being proportional to @xmath130 .",
    "the slopes of the curves are clearly similar , indicating the negligible impact of anharmonicities on the scaling of @xmath131 with @xmath129 .",
    "( b ) optimized voltages for the left electrode with @xmath132v : the shorter the transport time , the more the ramp approaches a square shape .",
    "the rectangular bang - bang - like solution is attained at @xmath133ns , where the classical control of energy neutral transport breaks down due to an insufficient voltage range.,title=\"fig:\",scaledwidth=44.0% ]   vs. maximum electrode voltage @xmath129 , obtained from numerical optimization of classical transport dynamics ( blue dots ) along with a fit to eq .  .",
    "we also indicate the analytic bang - bang result , eq .  , derived for idealized , purely harmonic potentials ( purple dashed line ) being proportional to @xmath130 .",
    "the slopes of the curves are clearly similar , indicating the negligible impact of anharmonicities on the scaling of @xmath131 with @xmath129 .",
    "( b ) optimized voltages for the left electrode with @xmath132v : the shorter the transport time , the more the ramp approaches a square shape .",
    "the rectangular bang - bang - like solution is attained at @xmath133ns , where the classical control of energy neutral transport breaks down due to an insufficient voltage range.,title=\"fig:\",scaledwidth=45.0% ]    in any experiment , there is an upper limit to the electrode voltages that can be applied .",
    "it is the range of electrode voltages that limits the maximum transport speed .",
    "typically this range is given by @xmath13410@xmath8v for technical reasons .",
    "it could be increased by the development of better voltage supplies .",
    "we define the minimum possible transport time @xmath135 to be the smallest time @xmath24 for which less than @xmath136 phonons are excited due to the total transport . to examine how @xmath137 scales as a function of the maximum electrode voltages @xmath129 , we have carried out numerical optimization combined with classical equations of motion .",
    "the initial guess voltages , cf .",
    "eqs .   and  , were taken to preserve a constant trap frequency of @xmath138  mhz for a @xmath139 ion .",
    "the transport ramps were optimized for a range of maximum voltages between 10 - 150  v and transport times between 10 ns and 300 ns with voltages truncated to @xmath140 during the updates .",
    "the results are shown in figs .",
    "[ fig : transportopts ] and  [ fig : classlimit ] .",
    "figure  [ fig : transportopts ] depicts the final excitation energy versus transport time , comparing the initial guess ( black ) to an optimized ramp with @xmath141v ( blue ) in fig .",
    "[ fig : transportopts](a ) . for the initial",
    "guess , the final energy displays an oscillatory behavior with respect to the trap period ( @xmath142s for @xmath143mhz ) as it has been experimentally observed in ref .",
    "@xcite , and an overall decrease of the final energy for longer transport times .",
    "the optimized transport with @xmath141v ( blue line in fig .  [ fig : transportopts](a ) ) shows a clear speed up of energy neutral transport : an excitation energy of less than 0.01 phonons is obtained for @xmath144s compared to @xmath145s .",
    "the speedup increases with maximum voltage as shown in fig .",
    "[ fig : transportopts](b ) .",
    "the variation of @xmath131 on @xmath129 is studied in fig .  [",
    "fig : classlimit](a ) .",
    "we find a functional dependence of @xmath146 with @xmath147s and @xmath148 .",
    "optimized voltages are shown in fig .",
    "[ fig : classlimit](b ) for the left electrode with @xmath132v .",
    "as the transport time decreases , the voltage ramp approaches a square shape .",
    "a bang - bang - like solution is attained at @xmath133ns .",
    "however , for such a short transport time , classical control of energy neutral transport breaks down due to an insufficient voltage range and the final excitation amounts to 5703 mean phonons .    in the following",
    "we show that for purely harmonic potentials , the exponent @xmath149 in eq .",
    "is universal , i.e. , it does not depend on trap frequency nor ion mass .",
    "it is solely determined by the bang - bang like optimized voltage sequences , where instantaneous switching between maximum acceleration and deceleration guarantees shuttling within minimum time .",
    "the technical feasibility of bang - bang shuttling is thoroughly analyzed in ref .",
    "the solution is obtained by the application of pontryagin s maximum principle @xcite as discussed in sec .",
    "[ subsec : geometric ] and assumes instantaneous switches . employing eqs .   and",
    ", the equation of motion becomes @xmath150 this can be integrated to @xmath151 with the boundary conditions @xmath152 , @xmath153 and @xmath154 .",
    "using the continuity of @xmath155 and @xmath0 at @xmath156 , we obtain @xmath157 notably , the minimum transport time is proportional to @xmath158 which explains the behavior of the numerical data shown in fig .",
    "[ fig : classlimit ] .",
    "this scaling law can be understood intuitively by considering that in the bang - bang control approach , the minimum shuttling time is given by the shortest attainable trap period , which scales as @xmath159 .",
    "assuming a trap frequency of @xmath160  mhz in eq .",
    ", corresponding to a trapping voltage of @xmath161v for our trap geometry , we find a prefactor @xmath162s . this is smaller than @xmath163s obtained by numerical optimization for realistic trap potentials .",
    "the difference can be rationalized in terms of the average acceleration provided by the potentials .",
    "for realistic trap geometries , the force exerted by the electrodes is inhomogeneous along the transport path .",
    "mutual shielding of the electrodes reduces the electric field feedthrough of an electrode to the neighboring ones .",
    "thus , the magnitude of the accelerating force that a real electrode can exert on the ion when it is located at a neighboring electrode is reduced with respect to a constant force generating harmonic potential with the same trap frequency .",
    "the minimum transport time of @xmath144s identified here for @xmath164v , cf . the blue line in fig .",
    "[ fig : transportopts](a ) , is significantly shorter than operation times realized experimentally . for comparison ,",
    "an ion has recently been shuttled within @xmath165s , leading to a final excitation of @xmath166 motional quanta  @xcite .",
    "optimization may not only improve the transport time but also the stability with respect to uncertainties in the time .",
    "this is in contrast to the extremely narrow minima of the final excitation energy for the guess voltage ramps shown in black in fig .",
    "[ fig : transportopts](a ) , implying a very high sensititivity to uncertainties in the transport time . for example , for the fourth minimum of the black curve , located at @xmath167s and close to the operation time of ref .",
    "@xcite ( not shown in fig .  [",
    "fig : transportopts](a ) ) , final excitation energies of less than 0.1 phonons are observed only within a window of 3@xmath8ns .",
    "optimization of the voltage ramps for @xmath168s increases the stability against variations in transport time to more than @xmath169ns .    in conclusion",
    "we find that optimizing the classical motion of an ion allows us to identify the minimum operation time for a given maximum voltage and improve the stability with respect to timing uncertainies for longer operation times .",
    "the analytical solution derived from pontryagin s maximum principle is helpful to understand the minimum time control strategy .",
    "numerical optimization accounts for all typical features of realistic voltage ramps .",
    "it allows for identifying the minimum transport time , predicting @xmath170 of the oscillation period for current maximum voltages and a trap frequency of @xmath171mhz .",
    "this number can be reduced to @xmath172 when increasing the maximum voltage by one order of magnitude .",
    "however , these predictions may be rendered invalid by a breakdown of the classical approximation .",
    "v ( red ) .",
    "also shown is a solution obtained by invariant based inverse engineering for a quantum mechanical harmonic oscillator ( green ) .",
    "for comparison , the final excitation energy obtained by solving the classical equation of motion with the optimized ramp is shown in light blue .",
    "note that for the initial guess ( black ) , the relative difference between wavepacket and classical motion is not visible on the scale of the figure ( less than @xmath173 ) .",
    "( b ) final wavefunction @xmath174 ( blue ) for classically optimized transport with @xmath175ns and @xmath164v and target wave function @xmath176 ( purple dashed ) . also shown is the scaled real part of the final wavefunction @xmath177 ( black dotted ) .",
    "the clearly visible spread of the wavepacket corresponds to squeezing of the momentum.,title=\"fig:\",scaledwidth=45.0% ] v ( red ) .",
    "also shown is a solution obtained by invariant based inverse engineering for a quantum mechanical harmonic oscillator ( green ) . for comparison ,",
    "the final excitation energy obtained by solving the classical equation of motion with the optimized ramp is shown in light blue .",
    "note that for the initial guess ( black ) , the relative difference between wavepacket and classical motion is not visible on the scale of the figure ( less than @xmath173 ) .",
    "( b ) final wavefunction @xmath174 ( blue ) for classically optimized transport with @xmath175ns and @xmath164v and target wave function @xmath176 ( purple dashed ) .",
    "also shown is the scaled real part of the final wavefunction @xmath177 ( black dotted ) .",
    "the clearly visible spread of the wavepacket corresponds to squeezing of the momentum.,title=\"fig:\",scaledwidth=43.0% ]    we now employ quantum wavepacket dynamics to test the classical solutions , obtained in sec .  [ subs : kloct2 ] .",
    "provided the trap frequency is constant and the trap is perfectly harmonic , the wave function will only be displaced during the transport . for a time - varying trap frequency , however , squeezing may occur  @xcite . in extreme cases , anharmonicities of the potential might lead to wavepacket dispersion . since these two effects are not accounted for by numerical optimization of classical dynamics",
    ", we discuss in the following at which timescales such genuine quantum effects become significant . to this end , we have employed the optimized voltages shown in fig .",
    "[ fig : classlimit](b ) in the propagation of a quantum wavepacket .",
    "we compare the results of classical and quantum mechanical motion in fig .",
    "[ fig : sqlimit](a ) , cf . the red and lightblue lines .",
    "a clear deviation is observed . also , as can be seen fig .",
    "[ fig : sqlimit](b ) , the wavefunction fails to reach the target wavefunction for transport times close to the classical limit @xmath178 .",
    "this is exclusively caused by squeezing and can be verified by inspecting the time evolution of the wavepacket in the final potential : we find the width of the wavepacket to oscillate , indicating a squeezed state .",
    "no wavepacket dispersion effects are observed , i.e. , the final wavepackets are still minimum uncertainty states , with @xmath179 .",
    "this means that no effect of anharmonicities in the potential is observed .",
    "an impact of anharmonicities is expected once the size of the wavefunction becomes comparable to segment distance @xmath51 ( see fig .  [",
    "fig : electrodes ] ) .",
    "then the wavefunction extends over spatial regions in which the potentials deviate substantially from harmonic potentials . for the ion shuttling problem",
    ", this effect does not play a role over the relevant parameter regime .",
    "the effects of anharmonicities in the quantum regime for trapped ions were thoroughly analyzed in ref .",
    "@xcite . squeezing increases",
    "@xmath137 from @xmath180s to @xmath181s for the limit of exciting less than 0.01 phonons , see the red curve in fig .  [",
    "fig : sqlimit](a ) , i.e. , it only triples the minimum transport time .",
    "we show that squeezing can be suppressed altogether in the following section .",
    "vs. maximum electrode voltage @xmath129 obtained by the invariant - based inverse engineering approach : the compensating force method for a trap frequency of @xmath171mhz using the transport function of eq .",
    "( red ) and for the limiting case of vanishing trap frequency ( black ) .",
    "also shown is the classical result from fig .",
    "[ fig : classlimit ] ( blue).,scaledwidth=50.0% ]    in the invariant - based iea , the minimal transport time is determined by the maximum voltages that are required for attaining zero motional excitation .",
    "the total voltage that needs to be applied is given by @xmath182 with @xmath62 and @xmath183 found in eqs .   and  .",
    "the maximum of @xmath10 , and thus the mininum in @xmath24 , is strictly related to the acceleration of the ion provided by the transport function @xmath55 , cf .",
    ". if the acceleration is too high , the voltages will exceed the feasibility limit @xmath129 .",
    "at this point it can also be understood why the acceleration should be zero at the beginning and end of the transport : for @xmath184 a non - vanishing correction voltage @xmath185 is obtained from eq .  .",
    "this implies that the voltages do not match the initial trap conditions , where the ion should be located at the center of the initial potential .",
    "we can derive a transport function @xmath55 compliant with the boundary conditions using eq .  .",
    "for this case , fig .",
    "[ fig : compforcelimit ] shows the transport time @xmath186 versus the maximum voltage @xmath187 that is applied to the electrodes during the transport sequence . for large transport times",
    ", the initial guess voltages @xmath188 dominate the compensation voltages @xmath189 .",
    "this leads to the bend of the red curve .",
    "when the trap frequency @xmath63 is lowered , the bend decreases . for the limiting case of no confining potential @xmath190 ,",
    "@xmath191 is solely determined by the compensation voltages . in this case",
    "the same scaling of @xmath191 with @xmath192 as for the optimization of classical dynamics is observed , cf .",
    "black and blue lines in fig .",
    "[ fig : compforcelimit ] . for large @xmath192",
    ", this scaling also applies to the case of non - zero trap frequency , cf .",
    "red line in fig .",
    "[ fig : compforcelimit ] .",
    "we have tested the performance of the compensating force by employing it in the time evolution of the wavefunction .",
    "it leads to near - perfect overlap with the target state with an infidelity of less than @xmath193 .",
    "the final excitation energy of the propagated wave function is shown in fig .",
    "@xmath194 ( green line ) for a maximum voltage of @xmath195v . for the corresponding minimum transport time , @xmath196ns",
    ", a final excitation energy six orders of magnitude below that found by optimization of the classical dynamics is obtained .",
    "this demonstrates that the invariant - based iea is capable of avoiding the wavepacket squeezing that was observed in sec .",
    "[ subs : qmprop2 ] when employing classically optimized controls in quantum dynamics .",
    "it also confirms that anharmonicities do not play a role since these would not be accounted for by the iea - variant employed here . note that an adaptation of the invariant - based iea to anharmonic traps is found in ref .",
    "similarly to numerical optimization of classical dynamics , iea is capable of improving the stability against variations in transport time @xmath24 .",
    "the final excitation energy obtained for @xmath168s stays below 0.1 phonons within a window of more than @xmath197ns .",
    "a further reduction of the minimum transport time may be achieved due to the freedom of choice in the transport function @xmath55 , by employing higher polynomial orders in order to reduce the compensation voltages @xmath183 , cf .",
    ". however , the fastest quantum mechanically valid transport has to be slower than the solutions obtained for classical ion motion .",
    "this follows from the bang - bang control being the time - optimal solution for a given voltage limit and the iea solutions requiring additional voltage to compensate the wavepacket squeezing .",
    "we can thus conclude that the time - optimal quantum solution will be inbetween the blue and black curves of fig .",
    "[ fig : compforcelimit ] .",
    "numerical optimization of the wavepacket motion is expected to become necessary once the dynamics explores spatial regions in which the potential is strongly anharmonic or is subject to strongly anharmonic fluctuations .",
    "this can be expected , for example , when the spatial extent of the wavefunction is not too different from that of the trap .",
    "correspondingly , we introduce the parameter @xmath198 , which is the wavefunction size normalized to the transport distance . while for current trap architectures ,",
    "such a scenario is rather unlikely , further miniaturization might lead to this regime .",
    "also , it is currently encountered in the transport of neutral atoms in tailored optical dipole potentials  @xcite .",
    "gradient - based quantum oct requires an initial guess voltage that ensures a finite overlap of the propagated wave function @xmath199 with the target state @xmath200 , see eq .  . otherwise , the amplitude of the co - state @xmath201 vanishes",
    "the overlap can also be analyzed in terms of phase space volume . for a typical ion trap setting with parameters as in fig .",
    "[ fig : electrodes ] , the total covered phase space volume in units of planck s constant is @xmath202 .",
    "this leads to very slow convergence of the optimization algorithm , unless an extremely good initial guess is available .",
    "( averaged over 100 iterations ) , versus relative size of the wavepacket @xmath203 for different optimization weights @xmath27 , cf .",
    "eq .  , ranging from @xmath204 ( leftmost line ) to @xmath205 ( rightmost line ) in powers of ten .",
    "the arrows indicate : ( 1 ) the parameters corresponding to current trap technology , ( 2 ) good convergence of quantum oct with the invariant - based iea still being valid , ( 3 ) fast convergence of quantum oct with invariant - based iea starting to fail .",
    "( b ) final wavefunction amplitudes for @xmath206 ( arrow ( 3 ) in ( a ) ) and classical optimization ( blue , fidelity of @xmath207 ) , iea ( green , @xmath208 ) , quantum oct ( red , fidelity of @xmath209 ) .",
    "also plotted is the target state ( purple dashed).,title=\"fig:\",scaledwidth=45.0% ]   ( averaged over 100 iterations ) , versus relative size of the wavepacket @xmath203 for different optimization weights @xmath27 , cf .",
    "eq .  , ranging from @xmath204 ( leftmost line ) to @xmath205 ( rightmost line ) in powers of ten .",
    "the arrows indicate : ( 1 ) the parameters corresponding to current trap technology , ( 2 ) good convergence of quantum oct with the invariant - based iea still being valid , ( 3 ) fast convergence of quantum oct with invariant - based iea starting to fail .",
    "( b ) final wavefunction amplitudes for @xmath206 ( arrow ( 3 ) in ( a ) ) and classical optimization ( blue , fidelity of @xmath207 ) , iea ( green , @xmath208 ) , quantum oct ( red , fidelity of @xmath209 ) . also plotted is the target state ( purple dashed).,title=\"fig:\",scaledwidth=45.0% ]    we utilize the results of the optimization for classical dynamics of sec .",
    "[ subs : kloct2 ] as initial guess ramps for optimizing the wavepacket dynamics and investigate the convergence rate as a function of the system dimension , i.e. , of @xmath203 .",
    "the results are shown in fig .",
    "[ fig : qmconv](a ) , plotting the mean improvement per optimization step , @xmath210 , averaged over 100 iterations , versus the scale parameter @xmath203 .",
    "we computed the convergence rate @xmath211 for different , fixed optimization weights @xmath27 in eq .  .",
    "the curves in fig .",
    "[ fig : qmconv](a ) are truncated for large values of @xmath211 , where the algorithm becomes numerically unstable .",
    "values below @xmath212 ( dashed grey line in fig .  [ fig : qmconv](a ) ) indicate an insufficient convergence rate for which no significant gain of fidelity is obtained with reasonable computational resources . in this case",
    "the potentials are insufficiently anharmonic to provide _ quantum _ control of the wavefunction .",
    "numerical optimization of the wavepacket dynamics is applicable and useful for scale parameters of @xmath213 and larger , indicated by arrows ( 2 ) and ( 3 ) in fig .",
    "[ fig : qmconv](a ) .",
    "then the wavefunction size becomes comparable to the transport distance , leading for example to a phase space volume of around @xmath214 for arrow ( 2 ) . at this scale",
    "the force becomes inhomogeneous across the wavepacket .",
    "this leads to a breakdown of the iea , as illustrated for @xmath215 in figs .",
    "[ fig : qmconv](b ) and  [ fig : schema ] .",
    "the fidelity @xmath216 for the iea drops below @xmath208 , whereas @xmath217 is achieved by numerical optimization of the quantum dynamics .    \\delta",
    "u_i(t)$ ] across the wavefunctions is caused by anharmonicities of the potential @xmath218 used to implement the compensating force .",
    "the relative spread of the force @xmath219 across the wavefunction is taken at the point in time , where the acceleration @xmath220 is maximal .",
    "@xmath221 increases to the range of several percent for large wavefunction extents .",
    "this leads to a drop in the fidelity @xmath216 .",
    "also shown is the fidelity @xmath222 obtained by optimizing the quantum dynamics .",
    "the cpu time @xmath223 required for optimization could be easily reduced by a factor of 8 in case ( 3 ) compared to case ( 2 ) due to the better convergence of quantum oct in this regime . ]",
    "l c l l l l l & @xmath203&@xmath219 & @xmath216 & @xmath222 & @xmath224 + ( 1)&@xmath225&@xmath226 & 1.000 & n / a & n / a + ( 2)&@xmath227&@xmath228 & 1.000 & 0.999 & 32.2 + ( 3)&@xmath229&@xmath230 & 0.946 & 0.999 & 4.3 +",
    "manipulation of motional degrees of freedom is very widespread in trapped - ion experiments . however , most theoretical calculations involving ion transport over significant distances are based on approximations that in general do not guarantee the level of precision needed for high - fidelity quantum control , especially in view of applications in the context of quantum technologies . as a consequence , before our work little was known about how to apply optimal control theory to large - scale manipulation of ion motion in traps , concerning in particular the most efficient simulation and control methods to be employed in different parameter regimes , as well as the level of improvement that optimization could bring .    with this in mind , in the present work we have investigated the applicability of several classical and quantum control techniques for the problem of moving an ion across a trap in a fast and accurate way",
    ". when describing the ion dynamics purely classically , numerical optimization yields transport times significantly shorter than a trapping period .",
    "the minimum transport duration depends on the maximal electrode voltage that can be applied and was found to scale as @xmath130 .",
    "the same scaling is observed for time - optimal bang - bang - like solutions that can be derived using pontryagin s maximum principle and assuming perfectly harmonic traps .",
    "not surprisingly , the classically optimized solutions were found to fail when tested in quantum wavepacket motion for transport durations of about one third of a trapping period .",
    "wavepacket squeezing turns out to be the dominant source of error with the final wavepacket remaining a minimum uncertainty state .",
    "anharmonic effects were found to play no significant role for single - ion shuttling over a wide range of parameters .",
    "wavepacket squeezing can be perfectly compensated by the control strategy obtained with the invariant - based inverse engineering approach .",
    "it amounts to applying correction voltages which can be generated by the trapping electrodes and which exert a compensating force on the ion .",
    "this is found to be the method of choice for current experimental settings .",
    "control methods do not only allow to assess the minimum time required for ion transport but can also yield more robust solutions . for transport times that have been used in recent experiments  @xcite , significantly larger than the minimum times identified here ,",
    "the classical solutions are valid also for the quantum dynamics . in this regime , both numerical optimization of classical ion motion and the inverse engineering approach yield a significant improvement of stability against uncertainties in transport time .",
    "compared to the initial guess voltages , the time window within which less than 0.1 phonons are excited after transport is increased by a factor of twenty for numerical optimization and a factor of five for the inverse engineering approach .",
    "further miniaturization is expected to yield trapping potentials where the wavepacket samples regions of space in which the potential , or potential fluctuations , are strongly anharmonic .",
    "also , for large motional excitations recent experiments have shown nonlinear duffing oscillator behavior @xcite , nonlinear coupling of modes in linear ion crystals @xcite and amplitude dependent modifications of normal modes frequencies and amplitude due to nonlinearities @xcite . in these cases , numerical optimization of the ion s",
    "quantum dynamics presents itself as a well - adapted and efficient approach capable of providing high - fidelity control solutions .",
    "the results presented in this paper provide us with a systematic recipe , based on a single parameter ( the relative wave packet size @xmath203 ) , to assess which simulation and control methods are best suited in different regimes .",
    "we observe a crossover between applicability of the invariant - based iea , for a very small wavefunction extension , and that of quantum oct , when the width of the wave function becomes comparable with the extension of the potential .",
    "both methods combined cover the full range of conceivable trap parameters .",
    "that is , no matter what are the trapping parameters , control solutions for fast , high - fidelity transport are available . in particular , in the regime @xmath231 , relevant for ion transport in chip traps , solutions obtained with the inverse engineering approach are fully adequate for the purpose of achieving high - fidelity quantum operations .",
    "this provides a major advantage in terms of efficiency over optimization algorithms based on the solution of the schrdinger equation .",
    "the latter in turn becomes indispensable when processes involving motional excitations inside the trap and/or other anharmonic effects are relevant .",
    "in this case , the numerical quantum oct method demonstrated in this paper provides a comprehensive way to deal with the manipulation of the ions external states .",
    "ks , up , haf and fsk thank juan gonzalo muga and mikel palmero for the discussions about the invariant based approach .",
    "haf thanks henning kaufmann for useful contributions to the numerical framework .",
    "the mainz team acknowledges financial support by the volkswagen - stiftung , the dfg - forschergruppe ( for 1493 ) and the eu - projects diamant ( fp7-ict ) , ip - siqs , the iarpa mqco project and the mpns cost action mp1209 .",
    "mhg and cpk are grateful to the daad for financial support .",
    "sm , fsk and tc acknowledge support from eu - projects siqs , diamant and picc and from the dfg sfb / trr21 .",
    "mhg , sm , tc and cpk enjoyed the hospitality of kitp and acknowledge support in part by the national science foundation under grant no .",
    "nsf phy11 - 25915 .",
    "for transport processes using realistic trap parameters , naive application of the standard fourier grid method  @xcite will lead to unfeasible grid sizes .",
    "this is due to the transport distance being usually 3 to 5 orders of magnitude larger than the spatial width of the wavepacket and possible acceleration of the wavepacket requiring a sufficiently dense coordinate space grid .",
    "to limit the number of grid points , a _ moving grid _ is introduced . instead of using a spatial grid that covers the entire transport distance , the grid",
    "is defined to only contain the initial wavepacket , in a window between @xmath232 and @xmath233 .",
    "the wavepacket @xmath234 is now propagated for a single time step to @xmath235 . for the propagated wave function",
    ", the expectation value @xmath236 is calculated , and from that an offset is obtained , @xmath237 by which @xmath232 and @xmath233 are shifted .",
    "the wavepacket is now moved to the center of the new grid , and the propagation continues to the next time step .",
    "the same idea can also be applied to momentum space .",
    "after the propagation step , the expectation value @xmath238 is calculated and stored as an offset @xmath239 . the wave function",
    "is then shifted in momentum space by this offset , which is achieved by multiplying it by @xmath240 .",
    "this cancels out the fast oscillations in @xmath241 .",
    "when applying the kinetic operator in the next propagation step , the offset has to be taken into account , i.e. , the kinetic operator in momentum space becomes @xmath242 .",
    "the combination of the moving grid in coordinate and momentum space allows to choose the grid window with the mere requirement of being larger than the extension of the wavepacket at any point of the propagation .",
    "we find typically 100 grid points to be sufficient to represent the acceleration within a single time step .",
    "the procedure is illustrated in fig .",
    "[ fig : moving_grid ] and the steps of the algorithm are summarized in table  [ tab : howtomovgrid ] .     for a single time step",
    "is shown in ( a ) .",
    "the resulting wave function has moved in position and has non - zero momentum . after shifting the grid in coordinate and momentum space , the propagated wave function",
    "is now centered on the new grid and has zero momentum ( b ) . ]",
    "l l l & & mathematical step & possible implementation + 1 . & calculate position mean & @xmath243 & @xmath244 + 2 . & transform to momentum space & & @xmath245 + 3 . & calculate momentum mean & @xmath246 & @xmath247 + 4 . &",
    "shift position & @xmath248 & @xmath249 + 5 .",
    "& transform to position space & & @xmath250 + 6 . & shift momentum & @xmath251 & @xmath252 + 7 . & update classical quantities & & @xmath253 +",
    "10 url # 1#1urlprefix[2][]#2 cirac i and zoller p 1995 _ phys .",
    "lett . _ * 74 * 4091                  rowe m  a , ben - kish a , demarco b , leibfried d , meyer v , beall j , britton j , hughes j , itano w  m , jelenkovic b , langer c , rosenband t and wineland d  j 2002 _ quantum information & computation _ * 2 * 257271"
  ],
  "abstract_text": [
    "<S> we investigate the performance of different control techniques for ion transport in state - of - the - art segmented miniaturized ion traps . </S>",
    "<S> we employ numerical optimization of classical trajectories and quantum wavepacket propagation as well as analytical solutions derived from invariant based inverse engineering and geometric optimal control . </S>",
    "<S> we find that accurate shuttling can be performed with operation times below the trap oscillation period . </S>",
    "<S> the maximum speed is limited by the maximum acceleration that can be exerted on the ion . when using controls obtained from classical dynamics for wavepacket propagation , wavepacket squeezing is the only quantum effect that comes into play for a large range of trapping parameters . </S>",
    "<S> we show that this can be corrected by a compensating force derived from invariant based inverse engineering , without a significant increase in the operation time . </S>"
  ]
}