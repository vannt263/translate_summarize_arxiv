{
  "article_text": [
    "the introduction of gene expression microarrays @xcite towards the end of the twentieth century initiated the start of a biotechnology revolution of rapidly evolving instruments capable of profiling a wide range of different molecular species at the cellular level . today , high resolution instruments , such as next - generation sequencing ( ngs ) technologies @xcite , are capable of generating counts of individual copies of , for example , different gene transcripts .",
    "experiments using these technologies are relatively expensive , resulting in studies with low numbers of biological replicates of treatments , making the efficient statistical design of such experiment critical . yet , with few exceptions , classically optimal designs based on the assumption of unit - treatment additivity ( i.e. functional independence of variances and covariances on their means ) continue to be used .",
    "optimal statistical designs are central to conducting efficient comparative experiments , enabling contrasts of treatment parameters to be estimated without bias and minimum variance while requiring minimum effort , subjects , or other resources . a rich body of literature on optimal designs @xcite has grown since the creation of this field of statistics @xcite . until very recently however , the criteria used to define optimal designs has depended on the assumption of unit - treatment additivity .    under additivity , optimal designs achieve their efficiency by dividing the experimental material into relatively homogeneous blocks and allocating treatments equally to blocks .",
    "full efficiency , whereby a model s treatment parameters can be estimated independently of its block parameters , is attained when treatments can be arranged in a complete block design @xcite , i.e. each treatment occurs equally frequently , usually once , in each block . however , as already noted , responses in many modern experiments are drawn from distributions such as the one and two parameter exponential families , e.g. , rna sequence counts from a negative binomial distribution @xcite .",
    "these violate additivity .",
    "our current work on single - factor experiments shows that optimal block designs from the classical setting can be importantly non - optimal when additivity is violated .",
    "@xcite was arguably the first to consider the problem of randomised experiments in the context of responses drawn from an exponential family distribution , with the objective being the difference between treatment groups in the canonical parameter .",
    "the approach taken by cox is to use conditioning to eliminate the blocking effects , and argued that local arguments can be made when in the presence of small effects and when asymptotic maximum likelihood theory is reasonable .",
    "the author also suggests that treating blocking as a random variable , which is the approach of this paper , is reasonable .",
    "the last decade has witnessed increasing interest in research on methods for the optimal design of experiments based on the structure of general exponential distributions . in @xcite , @xcite presented a comprehensive review of design issues for generalised linear models ( glms ) in the absence of any random parameters , discussing the dependence of optimal designs on the values of the canonical parameters of the model ; a problem which persists for generalised linear mixed models . using compromise criteria , @xcite proposed a method for finding exact designs robust to misspecification of the model s functional form for experiments involving several explanatory variables , where the factors take values along a bounded continuum .",
    "exact designs constrain the weights placed on each treatment combination so that , for a given sample size , the replication number of each treatment ( combination ) is an integer ( following the terminology of @xcite ) .",
    "in contrast , continuous designs do not use this constraint , and replication numbers are obtained by making nearest integer approximations .",
    "@xcite present results for generating d - optimal continuous designs for poisson regression where there are several continuous bounded factors .",
    "they also discuss the implementation of compromise designs to obtain designs that are robust to parameter misspecification .",
    "@xcite investigated poisson regression with a continuous predictor and random intercept .",
    "they argued that finding an optimal design using standard likelihood methods is cumbersome , even for simple models .",
    "the optimal block designs of experiments with multiple bounded continuous factors and correlated non - normal responses was first considered by @xcite .",
    "they used generalised estimating equations to incorporate block effects into the variance estimate for fixed effect parameters for glms .",
    "they considered both exchangeable and autoregressive correlation patterns , and presented two strategies for constructing block designs .",
    "the first strategy uses simulated annealing ( @xcite , @xcite and @xcite ) , while the second allocates the runs of the optimal unstructured design to blocks in an optimal way .",
    "@xcite present results that give d - optimal continuous factorial designs for logistic regression , and consider the use of exchange algorithms to find d - optimal exact designs in the absence of blocking variables .",
    "to date , work in developing methods for generating optimal block designs for experiments with responses drawn from an exponential family distribution has been carried out exclusively in the context of response surface models .",
    "we consider , in contrast , block designs for the much more widely applicable class of designs in which the values of the factor levels are fixed at the outset and play no role in design optimality . as far as we are aware , there are currently no methods available for generating optimal block designs in this setting .",
    "yet , as demonstrated by next - generation sequencing experiments , there is a very real and pressing need for such methods .    in this paper",
    ", we develop methods for generating optimal block designs for category - valued single factor - experiments with responses drawn from a poisson distribution , and with efficient estimation of contrasts of the model parameters being the objective . in section  [ sec : models ] we develop the notation and definitions needed to specify the generalised linear mixed model ( glmm ) for responses drawn from an exponential family of distributions and the corresponding pseudo - likelihood estimating equations . from these",
    "we derive the marginal fisher information matrix for the estimation of the fixed effects in the model . in section  [ sec : glmms - corrcount ] , we develop objective functions based on @xmath0 and for the efficient estimation of the fixed effects parameters in a poisson glmm . while these optimality criteria generally result in objective functions which require matrix inversion , we show that for poisson glmms with log link the objective functions can be simplified so that less inversion is necessary , leading to computational efficiency in the search for optimal designs .",
    "we use simulated annealing to search the set of competing designs for experiments of a given size , with the search space constrained to those designs which are locally optimal based on point prior estimates of the fixed effect parameters .",
    "our key inputs into the simulated annealing algorithm are described in section  [ sec : simulated - annealing ] . in section  [ sec : example ] we consider two examples , including a next - generation sequencing experiment , where we generate locally optimal block designs using the methods developed in sections  [ sec : glmms - corrcount ] and  [ sec : simulated - annealing ] .",
    "these show that , for a fixed number of blocks with constant block size , the replication of treatments in poisson glmm - based optimal designs are inversely proportional to the relative magnitudes of the treatments expected counts , which flies in the face of our traditional belief of optimality being achieved through the ( near- ) balanced allocation of treatments across blocks .",
    "they further show that , for experiments with non - negligible effect sizes , the poisson glmm - based optimal designs may be substantially more efficient than optimal designs from the classical setting assuming additivity .    with these methods in hand",
    ", experimenters will be enabled in correctly answering their research questions with minimum effort , subjects , or other resources .",
    "in this section we introduce generalised linear mixed models as an extension of both generalised linear models and of linear mixed models . as we progress to derive expressions for design optimality criteria , we observe that features of efficient designs for both generalised linear models and of linear mixed models are present in efficient designs for generalised linear mixed models .",
    "consider an experiment in which @xmath2 treatments are arranged in a completely randomised design comprising @xmath3 experimental units , where @xmath3 is a multiple of @xmath2 .",
    "we define a linear model for an @xmath4 vector of observations as @xmath5 where @xmath6 is a @xmath7 vector of parameters containing the fixed effects @xmath8 , denoting the overall mean of the observations , and @xmath9 , denoting the @xmath2 treatment effect parameters . the @xmath10 treatment design matrix , @xmath11 , characterises the allocation of treatments to experimental units and , therefore , the fixed effect parameters associated with each observation in @xmath12 .",
    "the @xmath13 vector of residual errors , @xmath14 , is assumed to be independently and identically distributed normal with constant variance .",
    "if the response variable does not give rise to this error distribution , then an alternative model needs to be considered .",
    "one such alternative is the generalised linear model ( glm ) .",
    "glms are used when the responses in @xmath12 are assumed to arise from a distribution belonging to the exponential family of distributions .",
    "such distributions include , for example , the binomial distribution for binary responses and the poisson distribution for count responses . in a glm",
    "the vector of mean responses , @xmath15 , and the linear predictors , @xmath16 , are related by a canonical link function , @xmath17 .",
    "this gives rise to the model form @xmath18 it follows that @xmath19 and @xmath20 , where @xmath21 and @xmath22 denote functions of the natural parameter , @xmath23 , and the dispersion parameter , @xmath24 , respectively , for the independent observations in @xmath12 .",
    "the maximum likelihood estimator , @xmath25 , of the fixed model effects , @xmath26 , in a glm is asymptotically normally distributed .",
    "the covariance matrix of @xmath25 is the inverse of the fisher information matrix which is derived from the log - likelihood function of the glm , i.e. @xmath27}{\\partial\\bs{\\beta}^2 } \\bigg\\ } = x^\\t wx,\\ ] ] where @xmath28 , @xmath29 $ ] and @xmath30 $ ] .",
    "hence , the information matrix depends on the link function , since @xmath31 , the design , @xmath32 , through the design matrix @xmath11 and the parameters in @xmath26 .",
    "responses in many modern experiments are drawn from distributions such as the one- and two - parameter exponential families , e.g. , rna sequence counts from a negative binomial distribution .",
    "here we focus exclusively on experiments in which responses from the treatment group are counts independently drawn from the one - parameter poisson distribution , i.e. @xmath33 , with canonical link function @xmath34 .",
    "consider now an experiment in which @xmath2 treatments are arranged in a generalised block design with @xmath35 blocking factors .",
    "we define the linear mixed model ( lmm ) for an @xmath13 vector of observations , @xmath12 , using the general matrix notation @xmath36 where the linear component , @xmath37 , represents the expected responses of the marginal model , with fixed effects parameter vector , @xmath26 , and treatment design matrix , @xmath11 , defined as in ( [ eq : lm ] ) . the vector of block random effect parameters @xmath38 is multivariate normally ( mvn ) distributed , with sub - vector @xmath39 , where @xmath40 , corresponding to the @xmath41th block factor , @xmath42 .",
    "the @xmath43 block design matrix , @xmath44 , characterises the association of experimental units and , therefore , random effect parameters with each observation in @xmath12 . finally",
    ", the @xmath13 vector of residual error parameters @xmath45 . in the following , we consider only the case where these errors are uncorrelated , i.e. @xmath46 .      the lmm estimating ( or normal ) equations are given by @xmath47    solving the estimating equations in ( [ eq : lmm - esteqns ] ) for the fixed model effects , @xmath26 , and a design @xmath32 yields the estimate @xmath48 , where the information matrix @xmath49 and the weight matrix @xmath50 .      extending either the lmm in ( [ eq : lmm ] ) to allow the observed responses to arise from a distribution in the exponential family , with linear predictor defined as in ( [ eq : link - fn ] ) , or the glm defined in ( [ eq : link - fn ] ) to also include random effects , yields the generalised linear mixed model ( glmm ) @xmath51 = x\\bs{\\beta } + z\\mathbf{q},\\ ] ] where @xmath52 denotes the vector of responses , conditional on the random effects @xmath53 , arising from an exponential family of distributions .",
    "the random effect parameter vector , @xmath54 , and vector of residual error parameters , @xmath14 , are defined as in ( [ eq : lmm ] ) . as expected ,",
    "when the link function , @xmath55 , is the identity , the glmm reduces to the ordinary lmm .      the pseudo - likelihood estimating equations for the glmm defined in ( [ eq : y|u ] ) are @xmath56 + where @xmath57 and @xmath58 is a pseudo - variable . in general , @xmath59 , @xmath60 and @xmath61 , where @xmath24 is the scale parameter of the response distribution .",
    "the fisher information matrix for the estimation of both the fixed and random effects is @xmath62 + @xcite . while it may be tempting to use the conditional form of the information matrix , @xmath63 , this does not ensure that the random effects are estimable . instead",
    ", we follow @xcite and @xcite and use the marginal information matrix for the estimation of the fixed effects .    for a generalised block design @xmath32",
    ", we partition the design matrix defined in ( [ eq : fim - glmm ] ) into four sub - matrices , i.e. @xmath64 = \\left[\\begin{array}{cc } m_{11 } & m_{12 } \\\\",
    "m_{21 } & m_{22 } \\end{array } \\right],\\ ] ] where sub - matrix @xmath65 contains the information pertaining to the fixed effects of interest , the efficiencies of which we would like to optimise , and @xmath66 contains the information for the remaining effects . for poisson regression in blocks",
    ", @xmath65 contains the information for the fixed effects in @xmath26 and @xmath66 contains the information for the random effects .",
    "then , from results on the inverse of a partitioned matrix @xcite , the marginal information matrix for the estimation of @xmath26 is given by @xmath67 in the next section , we derive ( [ eq : fim - glmm - fe ] ) for poisson regression with unstructured treatments in blocks .",
    "in this section we develop objective functions for the efficient estimation of the fixed effects in a poisson glmm for block designs with unstructured treatments .",
    "consider an experiment in which @xmath2 treatments are arranged in @xmath35 blocks of equal size @xmath68 .",
    "assuming observations @xmath69 from unit @xmath70 in block @xmath41 are conditionally poisson - distributed with expected value given by the rate parameter @xmath71 , where @xmath72 denotes the label for the treatment randomised to the @xmath73th unit , @xmath74 and @xmath75 .",
    "the glmm for this situation can be written as @xmath76 where @xmath77 denotes the response on the linear predictor scale , @xmath8 is the overall mean and @xmath78 is the fixed effect of treatment @xmath79 .",
    "the block effects , @xmath80 , are assumed to be random @xmath81 with @xmath82 for @xmath83 and zero otherwise .",
    "the residual errors , @xmath84 , associated with each unit are assumed @xmath85 and mutually uncorrelated .",
    "the model specified in ( [ eq : bd - glmm ] ) satisfies the glmm definition in ( [ eq : y|u ] ) , where @xmath86 $ ] , @xmath11 is the treatment design matrix , @xmath87 is a vector fixed effect treatment parameters and the vector of random effect parameters @xmath88 .",
    "since all blocks are of equal size @xmath68 , then the block design matrix @xmath89 , where @xmath90 , @xmath91 is an identity matrix of order @xmath35 , @xmath92 is a @xmath93 vector of ones , @xmath94 , and @xmath95 denotes the kronecker ( or outer ) product .    the poisson glmm with link function @xmath34 , as defined in ( [ eq : bd - glmm ] ) , can be expressed as a poisson  log - normal mixture , since @xmath96 and @xmath97 .",
    "it incorporates overdispersion through the residual parameters , @xmath84 , in a way that is consistent with how the random block effects are incorporated into the model .",
    "( see both @xcite and @xcite for a detailed discussion of this approach ) .",
    "an alternative analogous model is the negative binomial model which can be expressed as a poisson ",
    "gamma mixture model which is often used , for example , in the analysis of next generation sequencing data . in the poisson",
    "gamma mixture model , @xmath96 where @xmath98 for scale parameter @xmath24 .",
    "when searching for optimal designs , we need to specify a criterion which describes the relative amount of ( usually ) treatment information that is available from a design to achieve the objectives of the experiment .",
    "many of the commonly used criteria are based on properties of the fisher information matrix . here",
    "we focus our attention on finding designs that estimate contrasts of the fixed treatment effects as efficiently as possible , while ensuring that the random effects remain estimable .",
    "we then derive these objective functions for the poisson glmm for experimental designs with an unstructured treatment factor and a single block factor .",
    "we consider two optimality criteria : @xmath99optimality , or generalised @xmath100optimality , and @xmath1optimality for fixed effects .",
    "our implementation of both of these criteria depends on properties of the partitioned fisher information matrix in ( [ eq : fim - glmm ] ) .",
    "@xcite describe a @xmath99 optimal design as the design that minimises the determinant @xmath101 , where @xmath102 is a set of linear contrasts of the model parameters .",
    "we define the @xmath99optimal design , @xmath103 , over a class of competing designs , @xmath104 , as @xmath105 where @xmath106 denotes the determinant .",
    "the @xmath1optimality criterion is a modification of the @xmath107optimality criterion . @xcite",
    "define an @xmath107optimal design as the design that minimises the trace of the inverse of the fisher information matrix over @xmath104 .",
    "that is , the @xmath107optimal design is the design , @xmath108 , that is defined as @xmath109 @xcite then define the @xmath1optimal design , @xmath110 , as the design @xmath111    we now derive the expression for the @xmath99 and @xmath1optimality objective functions for the estimation of linear combinations of the treatment effects in the model in ( [ eq : bd - glmm ] ) .",
    "since contrasts of the fixed treatment effects are of interest , let the contrasts in @xmath102 be linear combinations of the entries in @xmath26 .",
    "in particular , we would like to estimate a set of orthogonal contrasts that form a basis for the degrees of freedom for treatment effects , so that the marginal information matrix is given by @xmath112 where @xmath113 , @xmath114 , @xmath115 .    in the case of a poisson glmm with a single blocking factor ,",
    "it follows from the pseudo - likelihood estimating equations in ( [ eq : pseudolik - glmm ] ) that @xmath116 , @xmath117 , @xmath118 = i_n$ ] and , hence , the weight matrix @xmath119 .",
    "for a block design with @xmath35 blocks of size @xmath68 , the block design matrix  @xmath120 and the diagonal covariance matrix corresponding to the random effects assuming @xmath121 for all @xmath41 and @xmath70 , is @xmath122 = g = \\left [ \\begin{array}{cc }      \\su2 i_b & \\bs{0 } \\\\",
    "\\bs{0 }   & \\sigma^2i_{bk } \\\\",
    "\\end{array}\\right].\\ ] ] substituting these matrix results into @xmath66 gives @xmath123\\end{aligned}\\ ] ] applying the results on the inverse of a sum @xcite to @xmath66 , i.e. @xmath124 and the fact that @xmath125 is block diagonal with the sub - matrix corresponding to the block given by @xmath126 we obtain @xmath127 where @xmath128.\\ ] ] it follows that @xmath129 is block diagonal with the sub - matrix , @xmath130 , where @xmath131 contains the rows if the design matrix corresponding to block @xmath41 and @xmath132    since @xmath102 contains only contrasts of the fixed effects , the expression for @xmath101 can be expressed in terms of the marginal information matrix for the fixed effects .",
    "it follows that the objective function for the @xmath99optimal design is given by @xmath133 while the objective function for the @xmath1optimal design is @xmath134 a full derivation is provided in the supplementary material .",
    "the following example illustrates the structure of these objective functions .",
    "suppose that we wish to find the optimal arrangement of @xmath135 treatments in @xmath136 blocks of size @xmath137 , and will observe a count response that we wish to model by the poisson glmm @xmath138 , where @xmath139 for @xmath140 , and @xmath141 .",
    "the components of the fisher information matrix , defined in ( [ eq : bd - glmm - a ] ) , are @xmath142 , @xmath119 , and @xmath143 .",
    "it follows that @xmath144^{\\t } \\diag(\\bs{\\lambda}_{r(i ) } ) [ \\bs{i}_2\\otimes \\bs{j}_3 | \\bs{i}_{6 } ] + \\left [ \\begin{array}{cc } ( 1/\\su2)i_2 & \\bs{0 } \\\\",
    "\\bs{0 }                                     & ( 1/\\s2)i_{6 }   \\end{array } \\right]\\\\ & = \\left [ \\begin{array}{c@{\\hspace{0.1cm}}c|c@{\\hspace{0.1cm}}c@{\\hspace{0.1cm}}c|c@{\\hspace{0.1cm}}c@{\\hspace{0.1cm}}c } \\lambda_{r(1,\\cdot ) } &                                0 & \\lambda_{r(1,1 ) } & \\lambda_{r(1,2 ) } & \\lambda_{r(1,3 ) } &                           0 &                           0 &                           0 \\\\ 0 & \\lambda_{r(2,\\cdot ) } &                           0 &                           0 &                          0 &   \\lambda_{r(2,1 ) } & \\lambda_{r(2,2 ) } & \\lambda_{r(2,3 ) } \\\\",
    "\\hline \\lambda_{r(1,1 ) }        &                               0 &    \\lambda_{r(1,1 ) } & 0 & 0 & 0 & 0 & 0 \\\\ \\lambda_{r(1,2 ) }        &                               0 &                            0 & \\lambda_{r(1,2 ) } & 0 & 0 & 0 & 0 \\\\ \\lambda_{r(1,3 ) }        &                               0 &                            0 & 0 & \\lambda_{r(1,3 ) } & 0 & 0 & 0 \\\\ \\hline 0                                & \\lambda_{r(2,1 ) }      &                            0 & 0 & 0 & \\lambda_{r(2,1 ) } & 0 & 0 \\\\ 0                                & \\lambda_{r(2,2 ) }      &                            0 & 0 & 0 & 0 & \\lambda_{r(2,2 ) } & 0 \\\\ 0                                & \\lambda_{r(2,3 ) }      &                            0 & 0 & 0 & 0 & 0 & \\lambda_{r(2,3 ) } \\end{array } \\right]\\\\ & \\hspace{1 cm } + \\left [ \\begin{array}{cc } ( 1/\\su2)i_2 & \\bs{0 } \\\\",
    "\\bs{0 }      & ( 1/\\sigma^2)i_{6 }   \\end{array } \\right]\\\\ \\ ] ] where @xmath145 and @xmath146.\\ ] ] the sub - matrix of the marginal information matrix , corresponding to block @xmath41 in the design , is given by @xmath147 \\\\ & \\hspace{1 cm } - \\frac{1}{1+\\frac{\\sigma^2_b}{\\sigma^2 + \\lambda^{-1}_{r(1,1)}}+\\frac{\\sigma^2_b}{\\sigma^2 + \\lambda^{-1}_{r(1,2)}}+\\frac{\\sigma^2_b}{\\sigma^2 + \\lambda^{-1}_{r(1,3 ) } } } \\times \\\\ & \\hspace{1 cm }   \\left [ \\begin{array}{ccc } \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,1)})^2 } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,1)})(\\sigma^2 + \\lambda^{-1}_{r(1,2 ) } ) } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,1)})(\\sigma^2 + \\lambda^{-1}_{r(1,3 ) } ) } \\\\",
    "\\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,2)})(\\sigma^2 + \\lambda^{-1}_{r(1,1 ) } ) } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,2)})^2 } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,2)})(\\sigma^2 + \\lambda^{-1}_{r(1,3 ) } ) } \\\\",
    "\\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,3)})(\\sigma^2 + \\lambda^{-1}_{r(1,1 ) } ) } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,3)})(\\sigma^2 + \\lambda^{-1}_{r(1,2 ) } ) } & \\frac{\\sigma^2_b}{(\\sigma^2 + \\lambda^{-1}_{r(1,3)})^2 } \\end{array } \\right],\\end{aligned}\\ ] ] with the corresponding structure of the second block taking a similar form .",
    "to investigate the optimal designs that are produced , table [ tab : smalleg ] gives the @xmath99optimal and @xmath1optimal designs for a variety of treatment means and and values of @xmath148 , with @xmath149 .",
    "we observe that as the size of the block variance increases relative to the treatment means , the optimal design becomes more balanced . for small block variances",
    "the effect of the different treatment variances becomes more dominant in determining the optimal design .",
    ".@xmath99- and @xmath1-optimal designs for three treatments with expected counts @xmath150 ( 1,1,1 ) , ( 1,1,2 ) , ( 1,2,4 ) or ( 1,4,16 ) , block variance @xmath151 , @xmath152 , or @xmath153 and @xmath149 .",
    "the relative efficiencies of the randomised complete block design are given in the final column [ cols=\"<,<,<,<,<,^,<,^ , < \" , ]",
    "generating or block designs requires an iterative search algorithm for which we have elected to use simulated annealing ( sa ) @xcite .",
    "since the design criterion to be minimised for both @xmath0 and ity is the generalised variance of @xmath154 , which for count data is functionally dependent on the treatment group means , we constrain the sa algorithm to search for locally optimal designs , i.e. designs that are optimal for a set of point priors for the expected treatment counts , @xmath155 , @xmath156 , and the variance components between blocks , @xmath157 , and residuals , @xmath158 .",
    "three key inputs are required by the sa algorithm : a starting design , an objective function and candidate generator procedure , which we now discuss .",
    "the sa algorithm is initialised with a starting design , @xmath159 , generated by randomly assigning treatments to blocks with objective function value @xmath160 . at each iteration a new design , @xmath161 , is generated by random exchanges of treatments in randomly selected experimental units in design @xmath162 at the previous iteration , where @xmath163 at the first iteration . since the sa algorithm searches for candidate designs which minimise the objective function",
    ", @xmath164 always replaces @xmath162 if @xmath165 , and has a small probability of replacing @xmath162 even it is a slightly worse design .",
    "the acceptance probability of a worse design depends on the so - called temperature of the algorithm , which is initially set high to enable the algorithm to escape local optima in early iterations .",
    "as the iterations continue the temperature gradually cools , and with it the probability of accepting worse designs . in this way",
    ", the algorithm converges to the global optimum within the constrained set of competing designs .    as discussed in section  [ sub : glmms - objfn ] , we consider two objective functions based on the ity and ity criteria , both defined in @xcite .",
    "the goal is search the space of candidate designs that minimise these functions .",
    "in contrast to block designs from the classical setting , where optimal efficiency is achieved by allocating treatments as equally as possible among blocks , optimal designs based on responses drawn from poisson distributions have treatment replication inversely proportional to their treatment means .",
    "our selection of a starting design , therefore , makes no assumption of equal replication or balance .",
    "consequently , a candidate design generating procedure which makes random exchanges of treatments between blocks is unsatisfactory .",
    "instead , we propose starting with a random design and then substitute the treatment assigned to a randomly chosen experimental unit in the design with a randomly chosen treatment from the treatment set .",
    "our preliminary testing of this strategy showed that , for some sets of design parameters ( i.e. number of treatments , blocks and block size ) and point priors , the sa algorithm converged very slowly and sometimes would get caught in local minima , even for reasonably high initial temperatures . to overcome these limitations ,",
    "our candidate design generating procedure includes an option for @xmath166 substitutions to be made at each iteration . a vector of probabilities @xmath167 where @xmath168 denotes the probability that @xmath169 experimental units will have treatment substitutions at a given iteration .",
    "the sa algorithm for performing the optimisation described above is implemented in the ` designglmm ` ` r ` package which is available from the comprehensive r archive network .",
    "we now consider two examples where we find optimal block designs for experiments in which responses are drawn from a poisson distribution using our sa algorithm .",
    "we consider a comparative experiment to assess the level of differential striatal gene expression between two mice strains using the illumina gaiix next - generation sequencing ( ngs ) platform @xcite .",
    "cdna , copied from amplified rna isolated from cells in the striatum of twenty - one mice ",
    "ten from the c57bl/6j strain ( strain 1 ) and eleven from the dba/2j strain ( strain 2 )  was loaded into individual lanes ( plots ) of three flow cells ( blocks ) for sequencing .",
    "the design used by @xcite comprised two flow cells with three replicates of strain 1 and four replicates of strain 2 , and a third flow cell with four replicates of strain 1 and three replicates of strain 2 .",
    "the question that we wish to answer is whether this design , or a different design with the same number of samples , is optimal for the estimation of strain effects .",
    "table [ tab bottomly data ] presents counts from four of the 36536 identified genes ( labelled a = ensmusg00000046994 , b = ensmusg00000039967 , c = ensmusg00000050141 and d = ensmusg00000033826 ) in this experiment , selected to represent the different effect sizes observed across the entire data set ( see recount resource @xcite ) .",
    "a per - gene glmm of the form presented in ( [ eq : bd - glmm ] ) was fitted to the count data yielding the parameter estimates shown in table  [ tab : ngs - param - est ] .",
    "we now use the effect sizes obtained from these estimates as point priors in searching for optimal designs for the estimation of the strain effect .",
    "table  [ tab : ngs - param - est ] shows that the size of the strain effect in genes a and b are quite small , with the relative abundances being approximately equal to 1 .",
    "however , these genes do differ when we consider the ratio of the between flow cell variation to the within flow cell variation ( i.e. @xmath170 ) of each . for gene",
    "a the between flow cell variation is 0.4 times that within cells , while for gene b this variance ratio is an order of magnitude larger .",
    "the design based on the point priors estimated from the gene a data consists of three flow cells , each comprising four replicates of strain 1 and three replicates of strain 2 , while the design based on the point priors estimated from the gene b data consists of three flow cells , each comprising three replicates of strain 1 and four replicates of strain 2 .",
    "in contrast , the strain effect is very large for genes c and d with 2000 more copies of gene c in strain 1 than strain 2 and , conversely , almost 28 times the number of copies of gene d in strain 2 than strain 1 . for both of these genes",
    "the magnitude of the variation between flow cells is comparable with that for genes a and b , however the within flow cell variation for genes c and d appears negligible . the design based on the point priors estimated from the gene c data consists of three flow cells , each comprising one replicate of strain 1 and replicates of strain 2 , while the design based on the point priors estimated from the gene d data consists of three flow cells , each comprising five replicates of strain 1 and two replicates of strain 2 .",
    "neither of these designs , nor those identified as optimal for genes a and b , is the same as the design used by @xcite .",
    "for each of genes a  d we now consider the relative performances of eight alternative designs , @xmath171  @xmath172 shown in table  [ tab : bottomly ] ,",
    "in which the twenty - one striatum cdna samples are arranged in three blocks ( flow cells ) , with seven samples per block .",
    "the treatments ( strains ) assigned to each flow cell are denoted by @xmath173 , where @xmath174 denotes the number of replicates of strain @xmath175 , @xmath176 .",
    "designs @xmath177 , @xmath178 , @xmath172 and @xmath179 are the designs given above for genes a to d , respectively",
    ". designs @xmath180 , with two blocks containing @xmath181 and one block containing @xmath182 , and @xmath183 , with two blocks each containing @xmath182 and one block containing @xmath182 , would be considered optimal and isomorphic under unit - treatment additivity .",
    "figure  [ fig : designeffs ] shows the per - gene relative efficiencies of designs @xmath171  @xmath172 using the point priors in table  [ tab : bottomly ] , where here we define relative efficiency of design @xmath161 as @xmath184 , i.e. the ratio of the value of the objective function , based on , for design @xmath161 relative to the largest value of the objective function across all eight designs , based on the point priors of gene @xmath185 , @xmath186 a , b , c , d. figure  [ fig : designeffs ] shows that designs @xmath180 and @xmath183 are optimal for genes a and b which each have a negligible strain effect . note that because these design are near - balanced they are also .",
    "these designs are not optimal , however , for genes c and d , where the strain effects are quite large . indeed , the larger the strain effect , the more substantial the loss in efficiency .",
    "cccccccc + @xmath171 & @xmath179 & @xmath177 & @xmath180 & @xmath183 & @xmath178 & @xmath187 & @xmath172 + @xmath188 & @xmath189 & @xmath181 & @xmath190 & @xmath191 & @xmath182 & @xmath192 & @xmath193 + & & & @xmath194 & @xmath195 & & & +     +      @xcite investigated the begging behaviour of nestling barn owls .",
    "they recorded the number of begging vocalisations , or calls , made by an offspring to its parent in the 15 minutes prior to the parent owl s arrival at the nest .",
    "of interest were the treatment factors gender ( of the parent ) and satiety ( food - deprived and food - satiated juvenile ) .",
    "see @xcite for a detailed discussion of these data .",
    "suppose that in a future similar study the researchers want to investigate 15 barn owl broods ( blocks ) each comprising 10 nestlings , what would be the optimal design ? treating the four combinations of gender and satiety as four levels of a single treatment factor , we fitted a poisson glmm to the data given in @xcite to obtain estimates of the requisite point priors .",
    "from this analysis we found that the mean number of calls for deprived females was @xmath196 , for deprived males was @xmath197 , for satiated females was @xmath198 and for satiated males was @xmath199 .",
    "the between nest standard deviation was @xmath200 and the within nest excess variation was @xmath201 .",
    "the design for this experiment is the one in which all 15 broods comprise the treatment allocation @xmath202 to nestlings . on the other hand ,",
    "the classically optimal design would consist of two broods each with the treatment allocations @xmath202 , @xmath203 , @xmath204 , @xmath205 , @xmath206 , and @xmath207 , with the remaining three broods being selected from these six combinations such that the treatments are as balanced as possible ( @xmath202 , @xmath207 , and @xmath206 , for instance ) .",
    "in this paper , we find optimal designs for poisson regression with a single unstructured treatment factor and a single variable that creates blocks of equal size .",
    "the methods discussed here are implemented in the ` r ` statistical software package ` designglmm ` , which is available on the comprehensive r archive network ( cran.r-project.org ) under a gpl3 license .",
    "we observe that for experiments where the treatment means are sufficiently different , and the block effect is not dominant , the optimal designs differ from those for linear models .",
    "this is because in a non  linear setting the fisher information matrix , and hence the optimal designs , depend on the values of the model parameters .",
    "the optimal designs for generalised linear mixed models depend on the functional form of the model and the values of the model parameters . in this paper , we have used a poisson  lognormal model , as discussed in @xcite and @xcite .",
    "many other model configurations are available for modelling count data , most notably the negative binomial model ( @xcite ) .",
    "@xcite presents yet other possibilities , including alternate mean  variance relationships and hurdle models .",
    "use of these alternate modelling approaches may yield optimal designs for the estimation of treatment effects which differ from those based on the poisson glmm .",
    "the objective functions considered in this paper assume that the treatment effects are of primary interest .",
    "specifically , a set of linear combinations of treatment effects are to be estimated with as small variance as possible , while being distinguishable from block effects . in some experiments ,",
    "researchers are also interested in estimating the block effects efficiently , which may give rise to different optimal designs .    in example 1 of section  [ sec : example ] , we considered the optimal design of a ngs experiment in which seven samples were placed onto individual lanes of three different flow cells . in generating optimal designs for this experiment , we considered only the variability between chips , and not between lanes .",
    "@xcite suggest that variation between lanes should also be a consideration .",
    "furthermore , some ngs experiments use a process called _ barcoding _ to place multiple samples onto a single lane .",
    "this would suggest that more complex design structures , such as row  column designs , may be appropriate .",
    "additional complications arise from the design of ngs experiments .",
    "for instance , ( * ? ? ?",
    "* eq.3 ) use an offset term , such as @xmath208 , to normalise the number of reads per lane , and is common practise in the modelling of ngs data ( see , for example mortazavi et al .",
    "2008 ) .",
    "we are currently looking at how we can address some of these issues in the optimal design of ngs experiments .",
    "other areas which require further investigation include incorporating prior distributions for each of the model parameters to develop bayesian optimal designs , and the investigation of alternative search algorithms that may be more efficient than simulated annealing in finding optimal designs .",
    "web appendix a , referenced in section  [ sec : glmms - corrcount ] , is available with this paper at the biometrics website on wiley online library .",
    "atkinson , a. , donev , a. , and tobias , r. ( 2007 ) . .",
    "oxford , uk : oxford univiversity press .",
    "auer , p.  l. and doerge , r.  w. ( 2010 ) . statistical design and analysis of rna sequencing data .",
    "405416 .",
    "bottomly , d. , walter , n. , hunter , j. , darakjian , p. , kawane , s. , buck , k. , searles , r. , mooney , m. , mcweeney , s. , and hitzemann , r. ( 2011 ) .",
    "evaluating gene expression in c57bl/6j and dba/2j mouse striatum using rna - seq and microarrays .",
    "e17820 .",
    "cox , d. ( 1988 ) . a note on design when response has an exponential family distribution . 161164 .",
    "craig , d.  w. , pearson , j.  v. , szelinger , s. , sekar , a. , redman , m. , corneveaux , j.  j. , pawlowski , t.  l. , laub , t. , nunn , g. , stephan , d.  a. , et  al .",
    "identification of genetic variants using bar - coded multiplexed sequencing .",
    "887893 .",
    "fisher , r.  a. ( 1926 ) . the arrangement of field experiments .",
    "503513 .",
    "frazee , a. , langmead , b. , and leek , j. ( 2011 ) .",
    "recount : a multi - experiment resource of analysis - ready rna - seq gene count datasets . 449 .",
    "haines , l.  m. ( 1987 ) .",
    "the application of the annealing algorithm to the construction of exact optimal designs for linear  regression models . 439447 .",
    "harville , d.  a. ( 1997 ) . .",
    "new york : springer - verlag .",
    "henderson , h.  v. and searle , s.  r. ( 1981 ) . on deriving the inverse of a sum of matrices .",
    "hilbe , j.  m. ( 2011 ) . .",
    "new york : cambridge university press .",
    "john , j.  a. and williams , e.  r. ( 1995 ) . .",
    "london : chapman & hall .",
    "khuri , a.  i. , mukherjee , b. , sinha , b.  k. , and ghosh , m. ( 2006 ) .",
    "design issues for generalized linear models : a review . 376399 .",
    "kirkpatrick , s. ( 1984 ) .",
    "optimization by simulated annealing : quantitative studies .",
    "975986 .",
    "kirkpatrick , s. , gelatt , c. , and vecchi , m. ( 1983 ) .",
    "optimization by simulated annealing .",
    "671680 .    lawless , j.  f. ( 1987 ) .",
    "negative binomial and mixed poisson regression .",
    "209225 .",
    "nettleton , d. ( 2014 ) .",
    "design of rna sequencing experiments .",
    "in datta , s. and nettleton , d. , editors , _ statistical analysis of next generation sequencing data _ , volume  4 of _ frontiers in probability and the statistical sciences _ , chapter  5 , pages 93119 .",
    "switzerland : springer international publishing .",
    "niaparast , m. and schwabe , r. ( 2013 ) .",
    "optimal design for quasi - likelihood estimation in poisson regression with random coefficients .",
    "296306 .",
    "roulin , a. and bersier , l. ( 2007 ) . nestling barn owls beg more intensely in the presence of their mother than in the presence of their father .",
    "10991106 .",
    "russell , k. , woods , d. , lewis , s. , and eccleston , j. ( 2009 ) .",
    "d - optimal designs for poisson regression models . 721730 .    schena , m. , shalon , d. , davis , r.  w. , and brown , p.  o. ( 1995 ) .",
    "quantitative monitoring of gene - expression patterns with a complementary - dna microarray .",
    "467470 .",
    "smith , k. ( 1918 ) . on the standard deviations of adjusted and interpolated values of an observed polynomial function and its constants and the guidance they give towards a proper choice of the distribution of observations .",
    "stroup , w.  w. ( 2012 ) . .",
    "boca raton fl : crc press .",
    "waite , t.  w. and woods , d.  c. ( 2015 ) .",
    "designs for generalized linear models with random block effects via information matrix approximations .",
    ".    woods , d. ( 2010 ) .",
    "robust designs for binary data : applications of simulated annealing . 2941 .",
    "woods , d. , lewis , s. , eccleston , j. , and russell , k. ( 2006 ) .",
    "designs for generalized linear models with several variables and model uncertainty . 284292 .",
    "woods , d.  c. and van  de ven , p. ( 2011 ) . blocked designs for experiments with correlated non - normal response .",
    "173182 .",
    "yang , j. and mandal , a. ( 2015 ) .",
    "d - optimal factorial designs under generalized linear models . 22642277 .    zuur , a. , ieno , e. , walker , n. , saveliev , a. , and smith , g. ( 2007 ) . .",
    "new york : springer science and business media .",
    "in this section , we present a full derivation for the marginal information matrix for the estimation of a set of contrasts of the fixed parameters @xmath210 for a poisson glmm .",
    "the marginal information matrix will is given by @xmath211^{-1 } b\\ ] ] where @xmath113 , @xmath114 , and @xmath115 . in this formulation ,",
    "@xmath212 , and @xmath213 is the covariance matrix of random effects . for poisson regression",
    ", we have @xmath214 = diag\\left[\\frac{\\partial \\log(\\pmb{\\lambda})}{\\partial \\pmb{\\lambda}}\\right ] = diag[\\lambda_1^{-1},\\lambda_2^{-1},\\ldots,\\lambda_t^{-1 } ] , \\\\",
    "v_{\\lambda}^{1/2 } & = diag\\left[\\left(\\frac{\\partial^2 b(\\theta)}{\\partial \\theta^2}\\right)^{1/2}\\right ] = diag\\left[\\left(\\frac{\\partial^2 \\exp(\\pmb{\\eta})}{\\partial \\pmb{\\eta}^2}\\right)^{1/2}\\right ] = diag[(\\lambda_1,\\lambda_2,\\ldots,\\lambda_t)^{1/2}],\\\\ a & = diag[1/a(\\phi ) ] = i_n,\\end{aligned}\\ ] ] and hence @xmath215 $ ] .",
    "if we assume that @xmath121 for all @xmath216 then @xmath217 = g =   \\left [ \\begin{array}{cc } \\sigma^2_b i_b & \\pmb{0 } \\\\",
    "\\pmb{0 }                       & \\sigma^2 i_{bk } \\\\",
    "\\end{array}\\right].\\ ] ] we can use this information to simplify the expression for @xmath218 so that it does not require matrix inversion .",
    "this will improve computation times for the simulated annealing algorithm .",
    "if we consider a block design with @xmath35 blocks of size @xmath68 .",
    "we then have that the block design matrix , @xmath219 $ ] , weight matrix @xmath220 and diagonal covariance matrix corresponding to the random effects @xmath213 .",
    "then @xmath221^tdiag(\\lambda_{r(i , j ) } ) [ \\pmb{i}_b\\otimes \\pmb{j}_k | \\pmb{i}_{bk } ] + \\left [ \\begin{array}{cc } \\frac{1}{\\sigma^2_b}\\pmb{i}_b & \\pmb{0 } \\\\ \\pmb{0 }                                     & \\frac{1}{\\sigma^2}\\pmb{i}_{bk }   \\end{array } \\right]\\end{aligned}\\ ] ]    using the inverse sum of matrices result of @xcite that @xmath222 we obtain @xmath223 now @xmath224 \\left[\\begin{array}{cc } \\sigma^2_b i_b & \\pmb{0}\\\\ \\pmb{0 }            & \\sigma^2 i_{bk } \\end{array } \\right ] \\left[\\begin{array}{l } i_b \\otimes \\pmb{j}_k^t\\\\ i_{bk }   \\end{array}\\right]\\\\ & = diag\\left(\\lambda^{-1}_{r(i , j)}\\right ) +   \\left[\\sigma^2_b i_b \\otimes \\pmb{j}_k \\pmb{j}_k^t + \\sigma^2 i_{bk}\\right]\\\\ & = diag\\left(\\sigma^2 + \\lambda^{-1}_{r(i , j)}\\right ) + \\sigma^2_b\\left[\\begin{array}{cccc } \\pmb{j}_k \\pmb{j}_k^t & \\pmb{0 }                       & \\cdots & \\pmb{0}\\\\ \\pmb{0 }                       & \\pmb{j}_k \\pmb{j}_k^t & \\cdots & \\pmb{0}\\\\ \\vdots                          & \\vdots                          & \\ddots & \\vdots\\\\   \\pmb{0 }                       & \\pmb{0 }                       & \\cdots & \\pmb{j}_k \\pmb{j}_k^t \\end{array}\\right]\\end{aligned}\\ ] ]    notice that this matrix is block diagonal , with @xmath35 blocks of size @xmath225 with similar structure . we can then express the @xmath226 block as @xmath227 this is of the form @xmath228 , where @xmath229 is invertable and square and @xmath230 and @xmath231 are column vectors , so we can invert this block using the sherman - morrison formula . then @xmath232      next , we can add the additional components that are not dependent on @xmath11 .",
    "so @xmath235 since @xmath236 $ ] , we have @xmath237 \\times \\sigma^2",
    "w^2\\\\ wzgz^t     & = \\left [ \\begin{array}{cccc } \\sigma^2_b \\pmb{\\lambda}_1 \\pmb{j}_k^t & \\pmb{0 }                                                     & \\cdots & \\pmb{0 } \\\\ \\pmb{0 }                                                  & \\sigma^2_b \\pmb{\\lambda}_2 \\pmb{j}_k^t & \\cdots & \\pmb{0 } \\\\",
    "\\vdots                                                     & \\vdots                                                         & \\ddots & \\vdots\\\\ \\pmb{0 }                                                  & \\pmb{0 }                                                     & \\cdots & \\sigma^2_b \\pmb{\\lambda}_b \\pmb{j}_k^t   \\end{array } \\right ] \\times \\sigma^2 w\\\\\\end{aligned}\\ ] ] where @xmath238 .",
    "since each of these matrices are block diagonal , the @xmath239 block of @xmath240 becomes @xmath241 where @xmath242 since @xmath243 and @xmath244 , which are constants , we obtain      since @xmath246 we can simplify to obtain @xmath247 it follows that @xmath209 is block diagonal with the @xmath248 block , @xmath249 , given by @xmath250 where @xmath131 contains the rows if the design matrix corresponding to block @xmath41 ."
  ],
  "abstract_text": [
    "<S> optimal block designs for additive models achieve their efficiency by dividing experimental units among relatively homogenous blocks and allocating treatments equally to blocks . </S>",
    "<S> responses in many modern experiments , however , are drawn from distributions such as the one- and two - parameter exponential families , e.g. , rna sequence counts from a negative binomial distribution . </S>",
    "<S> these violate additivity . </S>",
    "<S> yet , designs generated by assuming additivity continue to be used , because better approaches are not available , and because the issues are not widely recognised . </S>",
    "<S> we solve this problem for single - factor experiments in which treatments , taking categorical values only , are arranged in blocks and responses drawn from a poisson distribution . </S>",
    "<S> we derive expressions for two objective functions , based on @xmath0- and @xmath1-optimality , with efficient estimation of linear contrasts of the fixed effects parameters in a poisson generalised linear mixed model ( glmm ) being the objective . </S>",
    "<S> these objective functions are shown to be computational efficient , requiring no matrix inversion . </S>",
    "<S> using simulated annealing to generate poisson glmm - based locally optimal designs , we show that the replication numbers of treatments in these designs are inversely proportional to the relative magnitudes of the treatments expected counts . </S>",
    "<S> importantly , for non - negligible treatment effect sizes , poisson glmm - based optimal designs may be substantially more efficient than their classically optimal counterparts . </S>"
  ]
}