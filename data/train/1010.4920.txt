{
  "article_text": [
    "the emerging next - generation wireless systems adopt a multi - channel relaying architecture for broadband access and coverage improvement @xcite . as opposed to a narrow - band single - channel relay",
    ", a multi - channel relay has access to multiple channels , e.g. , different frequency channels or subcarriers in an orthogonal frequency division multiplexing ( ofdm ) system .",
    "it may receive a signal from one channel and transmit a processed version of the signal on a different channel .",
    "this _ multi - channel relaying capability _ can be exploited to choose forwarding channel adaptively for the incoming signals , taking advantage of the diverse strength of different channels .    in this work",
    ", we address the general problem of channel selection and power allocation strategies at multi - channel capable relays to forward data in a multi - hop relaying network .",
    "this problem involves two issues : 1 ) channel pairing ( cp ) : the pairing of incoming and outgoing channels at each relay ; 2 ) power allocation ( pa ) : the determination of power used to transmit signals on these channels . in general , for multi - hop relaying , there is strong correlation between cp and pa . intuitively , to maximize the source - destination performance , the choice of cp at each relay would affect the choices of cp at other relays , which further depends on the specific pa scheme used .",
    "the optimal system performance requires joint consideration of cp and pa .",
    "our goal is to maximize the end - to - end data rate in a multi - hop relaying network .",
    "one may view a cp scheme at each relay as a routing scheme embedded in the network router .",
    "however , despite bearing some resemblance , the cp problem differs from the conventional multi - channel routing problem : for channel pairing , the total cost of two paired incoming and outgoing links is not additive as it is typically assumed in the routing case . furthermore , the cost of each link can not be independently defined in cp .",
    "the source - destination achievable data rate is dictated by the end - to - end signal - to - noise ratio ( snr ) , which is a nonlinear function of the channel gain and power used on each link .      in this paper , we present a comprehensive solution for jointly optimizing cp and pa to maximize the source - destination data rate in a multi - channel multi - hop relay network .",
    "the main results in our work are summarized as follows :    * given fixed power allocation , the sorted - snr cp scheme is shown to be optimal in multi - hop relaying . specifically , cp can be separated into individual pairing problems at each relay , where the relay matches the incoming channels to the outgoing channels in the order of snrs seen over these channels . * the problem of joint cp and pa optimization can be decomposed into two separate problems which can be solved independently : first cp optimization , and then pa optimization .",
    "the decoupling of cp and pa optimization significantly reduces the problem search space and reduces the complexity of optimal solution .",
    "this separation principle holds for both amplify - and - forward ( af ) and decode - and - forward ( df ) relaying strategies , and for either total or individual power constraints imposed on the transmitting nodes . * in joint cp and pa optimization",
    ", the optimal cp is shown to be decoupled into per relay cp .",
    "the channels at two consecutive hops are optimally paired according to their channel gain order , without the need for knowledge of power allocation on each channel .",
    "this allows simple distributed relay implementation for optimal operation , as well as easily adapting to the network topology changes . * the solution for pa optimization in a multi - hop setting",
    "is proposed for both af and df relaying . for df relaying , we develop an algorithm through a dual - decomposition approach , where we are able to obtain the semi - closed - form pa expression .",
    "in addition to depicting power distribution across channels at an individual node , the pa expression allows us to characterize the interaction among the nodes for power determination on a multi - hop path .    the separation of joint cp and pa has been established for dual - hop ( single - relay ) df relaying in prior work under total power constraints @xcite and individual power constraints @xcite .",
    "it is somewhat surprising that such separation property is preserved in the general multi - hop relaying .",
    "in fact , the generalization from the dual - hop case to the multi - hop case is non - trivial . for the latter , in addition to being a function of power allocation , the pairing at each relay along the hops needs to be optimized jointly , adding an additional dimension for the optimization problem . intuitively , to maximize the source - destination rate , the choice of cp at each relay would affect the choices of cp at other relays , which also depend on the specific power allocation scheme used",
    "therefore , it is not apparent that the optimal cp can be decomposed into independent pairing problems at each relay , or that cp and pa can be separately considered . besides , the two different techniques used in @xcite to show the separation result are complicated . they can not be simply extended and applied to the multi - hop case .",
    "instead , we develop a new approach to attack the problem that leads to the separation principle of joint cp and pa for _ both af and df _ relaying in a general multi - hop setting , under either total or individual power constraints .",
    "our approach provides a rigorous and direct way in proving the separation result .",
    "we further provide numerical studies on the performance of jointly optimal cp and pa scheme and compare it with those of other alternatives for multi - channel multi - hop relaying .",
    "we will show that , although both cp and pa improves the performance , the optimal cp is more crucial than the optimal pa . in other words ,",
    "a major portion of the gain comes from the optimal cp .",
    "in addition , we will see that uniform pa with optimal cp achieves near - optimal performance even at moderately high snr , for af relaying .",
    "this significantly simplifies the pa implementation , without the need of centralized channel information for either cp or pa .",
    "the gain by the optimal cp widens with a higher level of channel gain variation across channels , or a larger number of channels , indicating that these factors can be judiciously exploited through cp .",
    "the optimal pa , on the other hand , is insensitive to these changes .",
    "finally , we will also show that the gain of jointly optimal cp and pa becomes more pronounced with an increasing number of hops .      for an ofdm system as a typical example of multi - channel systems , the concept of cp",
    "was first introduced independently in @xcite and @xcite for a dual - hop af relaying system where heuristic algorithms for pairing based on the order of channel quality were proposed . for relaying without the direct source - destination link available , @xcite used integer programming to find the optimal pairing that maximizes the sum snr .",
    "from a system - design perspective , the sorted - snr cp scheme was proposed in @xcite and was shown optimal for the noise - free relaying case , under the assumption of uniform power allocation .",
    "these works sparked interests for more research in this area . in the absence of the direct source - destination link , for the practical case of noisy - relay , by using the property of l - superadditivity of the rate function",
    ", the authors of @xcite proved that the sorted - snr cp still remains optimal for sum - rate maximization in dual - hop af relaying ofdm system .",
    "subsequently , it was further proved in @xcite , through a different approach , that the sorted - snr cp scheme is optimal for both af and df relaying in the same setup .",
    "when the direct source - destination link is available , @xcite presented two suboptimal cp schemes .",
    "for the same setup , a low complexity optimal cp scheme was later established in @xcite for dual - hop af relaying , and the effect of direct path on the optimal pairing was characterized .",
    "in addition , it was shown in @xcite that , under certain conditions on relay power amplification , among all possible linear processing at the relay , the channel pairing is optimal .",
    "the related problem of optimal pa for a dual - hop ofdm system was studied by many @xcite for different relay strategies and power constraints .",
    "the problem of jointly optimizing cp and pa was studied in a dual - hop ofdm system for af and df relaying in @xcite and @xcite , respectively , where the direct source - destination link was assumed available .",
    "the joint optimization problems were formulated as mixed integer programs and solved in the lagrangian dual domain .",
    "exact optimality under arbitrary number of channels was not established . instead , by adopting the time - sharing argument @xcite in their systems ,",
    "the proposed solutions were shown to be optimal in the limiting case as the number of channels approaches infinity .    without the direct source - destination link , jointly optimizing cp and pa for df relaying in a dual - hop ofdm system was investigated in @xcite and @xcite , where @xcite assumed a total power constraint shared between the source and the relay , and @xcite considered individual power constraints separately imposed on the source and the relay . in both cases ,",
    "two - step separate cp and pa schemes were proposed and then proved to achieve the jointly optimal solution . for this dual - hop setup",
    ", it was shown that the optimal cp scheme is the one that maps the channels solely based on their channel gains independent of the optimal pa solution .",
    "similar studies on the problem of cp and pa in _ dual - hop af _ relaying or _ multi - hop _ relaying have been scarce .",
    "the authors of @xcite proposed an adaptive pa algorithm to maximize the end - to - end rate under the total power constraint in a multi - hop ofdm relaying system . for a similar network with df relaying , @xcite studied the problem of joint power and time allocation under the long - term total power constraint to maximize the end - to - end rate .",
    "furthermore , in @xcite , the idea of using cp to further enhance the performance was mentioned in addition to pa .",
    "however , no claim was provided on the optimality of the pairing scheme under the influence of pa .",
    "the optimal joint cp and pa solution remained unknown .",
    "the rest of this paper is organized as follows . in section [ systemmodel ] ,",
    "we present the system model and joint optimization formulation . in section [ spwithoutpa ] ,",
    "given a fixed pa solution , we provide the optimal cp scheme based on the sorted snr for both af and df strategies .",
    "the joint optimization problem of cp and pa is considered in section [ pa_sp ] , where the separation principle between cp and pa optimization is established .",
    "the optimal pa solution is then discussed in section [ pa - multi - hop ] for multi - hop relaying under both total and individual power constraints .",
    "the numerical study are provided in section [ simulation ] , and finally we conclude the paper in section [ conclusion ] .",
    "we consider an @xmath0-hop relay network where a source node communicates with a destination node via @xmath1 intermediate relay nodes as illustrated in fig .",
    "[ fig1 ] . for broadband communication between the nodes , the frequency bandwidth",
    "is split into multiple subbands for data transmission .",
    "a practical system with such an approach is the ofdm system where the bandwidth is divided into @xmath2 equal - bandwidth channels .",
    "we denote by @xmath3 , for @xmath4 and @xmath5 , the channel response on channel @xmath6 over hop @xmath7 .",
    "the additive noise at hop @xmath7 is modeled as an i.i.d .",
    "zero mean gaussian random variable with variance @xmath8 .",
    "we define @xmath9 as the _ normalized _ channel gain against the noise power over channel @xmath6 of hop @xmath7 . in the rest of presentation",
    ", we simply refer to it as channel gain without causing confusion .",
    "we make the common assumption that the full knowledge of global channel gains is available at a central controller , which determines the optimal cp and pa .",
    "we further assume that the destination is out of the transmission zone of the source , and therefore , there is no direct transmission link . for @xmath0-hop relaying , a transmission from source",
    "to destination occupies @xmath0 equal time slots , one for each hop . in the @xmath7th slot , @xmath4 , the @xmath7th node ( the source node if @xmath10 , otherwise the @xmath11th relay node ) transmits a data block to the @xmath12th node ( the destination node if @xmath13 , otherwise the @xmath7th relay node ) on each channel .",
    "our study is constrained to half - duplex transmissions , where the relay nodes can not send and receive at the same time on the same frequency . however , the transmission of different data blocks in different hops may occur concurrently , depending on the scheduling pattern for spatial reuse of spectrum .",
    "[ c]source [ l]destination [ c]relay 1 [ c]relay ( m-1 ) [ c]hop 1 [ l]hop 2 [ c]hop @xmath0       we consider two types of relaying strategies : af and df . in af relaying",
    ", a relay amplifies the data received from an incoming channel and directly forwards it to the next node over an outgoing channel . in df relaying , a relay attempts to decode the received data from the previous node over each incoming channel and forwards a version of the decoded data on an outgoing channel to the next node .",
    "we consider the simple repetition - coding based df relaying @xcite , where the relay is required to fully decode the incoming message , re - encodes it with repetition coding , and forwards it to the intended user .",
    "the relay conducts cp , matching each incoming channel with an outgoing channel . as",
    "different channels exhibit various quality , a judicious cp scheme can potentially lead to significant improvement in system spectral efficiency .",
    "we denote path @xmath14 , where @xmath15 specifies the index of the channel at hop @xmath7 that belongs to path @xmath16 .",
    "for example , @xmath17 indicates that path @xmath16 consists of the third channel at hop @xmath18 , the fourth channel at hop @xmath19 , and the second channel at hop @xmath20 .",
    "once channel pairing is determined at all the relays , the total @xmath2 disjoint paths @xmath21 can be identified from the source to the destination .",
    "denote the power allocated to channel @xmath6 over hop @xmath7 by @xmath22 .",
    "the snr obtained on this channel is represented by @xmath23 . for each path",
    "@xmath16 , let @xmath24 represent the snr seen over hop @xmath7 on this path .",
    "let @xmath25 be the pa vector for all channels along path @xmath16 .",
    "the source - destination equivalent snr of path @xmath16 is denoted by @xmath26 . for af",
    "relaying , it is given by @xcite , @xmath27 and , in section [ pa - multi - hop ] , we will also use its upper bound @xcite , @xmath28 whose approximation gap vanishes as the snr becomes large . for df relaying , we have @xmath29    we consider two types of power constraints :    [ [ total - power - constraint ] ] total power constraint : + + + + + + + + + + + + + + + + + + + + + + +    the power assignment @xmath22 , for @xmath30 and @xmath31 , must satisfy the following aggregated power constraint @xmath32    [ [ individual - power - constraint ] ] individual power constraint : + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the power assignment @xmath22 , for @xmath5 , needs to satisfy the power constraint of the individual node @xmath7 , @xmath33 where @xmath34 denotes the maximum allowable power at node @xmath7 .",
    "our goal is to design a jointly optimal cp and pa strategy to maximize the source - destination rate under multi - hop relaying .",
    "the source - destination rate achieved through path @xmath16 is given by @xmath35 where @xmath36 is the spatial reuse factor .",
    "in multi - hop relaying that allows concurrent transmissions , @xmath36 takes value between @xmath19 and @xmath0 ( since @xmath37 under the half - duplex assumption ) .",
    "the sum rate of all paths determines the total source - destination rate of the system , denoted as @xmath38 , r_t = _",
    "i=1^n r_(_i,_i ) .",
    "[ total_rate ] it is a function of both @xmath39 and @xmath40 , which should be jointly optimized : @xmath41 where @xmath42 signifies element - wise inequality .",
    "in this section , we first consider the case when pa is fixed and given . in this case , the optimization problem in can be re - written as @xmath43 and the optimal cp @xmath44 is a function of @xmath40 . to simplify the notation , in this section we rewrite @xmath45 and @xmath46 and drop their dependency on @xmath47 with the understanding that @xmath40 is fixed . in the following ,",
    "we solve to obtain the optimal cp scheme under this fixed pa .",
    "we emphasize that here the generalization from the dual - hop case to the multi - hop case is non - trivial .",
    "intuitively , there is no obvious way to decouple the sequence of pairings at all @xmath1 relays .",
    "indeed , the _ equivalent _ incoming channel from a source to a relay and the _ equivalent _ outgoing channel from that relay to the destination depend on how the channels are paired over multiple hops .",
    "however , we will show that the optimal cp solution over multiple hops can in fact be decomposed into @xmath1 independent cp problems , where the mapping of incoming and outgoing channels at each relay is only based on the sorted snr over those channels , and therefore can be performed individually per hop .    in the following ,",
    "we first establish the optimality of the sorted - snr cp scheme for the case of @xmath48 and @xmath49 , and then we extend the result to arbitrary @xmath0 and @xmath2 .",
    "[ c]source [ l]destination [ c]relay 1 [ c]relay 2 [ c]@xmath50 [ l]@xmath51 [ c]@xmath52 [ c]@xmath53 [ l]@xmath54 [ l]@xmath55 [ l]@xmath56 [ l]@xmath57     we first consider a three - hop relaying network with two channels , as depicted in fig .",
    "[ fig3 ] . without loss of generality ,",
    "we assume channel @xmath18 exhibits equal or larger snr than channel @xmath19 over all the three hops , [ a1 ] _",
    "m,1_m,2 , m=1,2,3 . the optimal cp scheme for this case",
    "is given in proposition [ sorted_sp ] .",
    "for @xmath48 and @xmath49 , the solution to is the sorted - snr cp scheme performed on each relay , @xmath58 under condition .",
    "[ sorted_sp ]    the proof essentially exams possible path selections and shows that the sorted - snr per relay provides the highest source - destination sum rate for both af and df relaying .",
    "see appendix [ app : sorted_sp ] for details .      here",
    ", we provide an argument to extend the result in proposition [ sorted_sp ] to a system with an arbitrary number of channels .",
    "[ prop2 ] for @xmath48 and @xmath59 , the solution to is the sorted - snr cp scheme performed on each relay .",
    "suppose the optimal pairing does not follow the pairing rule of sorted snr .",
    "there is at least one relay ( say , relay @xmath19 ) that has two pairs of incoming and outgoing channels that are mis - matched according to their snr .",
    "that is , there exist two channels @xmath60 and @xmath61 over hop @xmath19 , and two channels @xmath62 and @xmath63 over hop @xmath20 that are respectively paired with each other while @xmath64 and @xmath65 .",
    "note that these two channel pairs belong to two disjoint source - destination paths that can be regarded as a 2-channel relay system . from proposition [ sorted_sp ]",
    ", we know that pairing channels @xmath60 with @xmath63 and @xmath61 with @xmath62 at relay @xmath19 achieves a higher rate than the existing pairing over these two paths .",
    "hence , by switching to this new pairing while keeping the other paths the same , we could increase the total rate .",
    "this contradicts our assumption on the optimality of a non - sorted snr cp scheme .",
    "hence , there is no better scheme than sorted - snr cp to obtain the maximum sum rate .",
    "building on proposition [ prop2 ] , we next extend the result for @xmath20-hop relaying to a relaying network with an arbitrary number of hops ( @xmath66 ) in the following proposition .",
    "[ propos1 ] the solution to is the sorted - snr cp scheme individually performed at each relay .",
    "we prove by induction .",
    "it is shown in proposition [ prop2 ] that the sorted - snr cp is optimal for @xmath48 .",
    "suppose the claim holds for @xmath67 .",
    "now consider @xmath68 as shown in fig .",
    "[ fig2](a ) .",
    "let @xmath69 be the received snr from the source to relay @xmath70 over the @xmath6th incoming channel of that relay .",
    "we establish @xmath2 equivalent channels between the source and relay @xmath70 , with snr over the @xmath6th channel as @xmath69 .",
    "then , the @xmath71-hop relaying network can be converted to a 3-hop network , with an equivalent relay whose incoming channels have snr @xmath72 and outgoing channels remain the same as those of relay @xmath70 , as shown in fig .",
    "[ fig2](b ) .",
    "hence , from proposition [ prop2 ] , the optimal cp is the one where @xmath72 and @xmath73 are sorted and paired at this equivalent relay , and @xmath73 and @xmath74 are sorted and paired at relay @xmath75 .",
    "note that the sorted - snr pairing at relay @xmath75 is independent of how the channels are paired at the other relays .",
    "next , ignore relay @xmath75 and replace it by equivalent channels from relay @xmath70 to the destination .",
    "we now have a @xmath75-hop network . from the induction hypothesis",
    ", the sorted - snr cp is optimal . in particular , the incoming and outgoing channels at each of relays @xmath76",
    "are sorted by their snr and paired . since the snrs @xmath72 at the equivalent relay are computed by applying or over these _ sorted and paired _ channels from the source to relay @xmath70 , it is not difficult to see that @xmath77 and @xmath72 are ordered in the same way",
    ". therefore , sorting and pairing @xmath72 and @xmath73 at the equivalent relay is the same as sorting and pairing @xmath77 and @xmath73 at relay @xmath70 .",
    "thus , we conclude that at each of relay @xmath78 , the incoming and outgoing channels are sorted and paired in order of their snr .",
    "the significance of proposition [ propos1 ] is that the optimal cp for @xmath0-hop relaying is decoupled into @xmath1 individual pairing schemes at each relay , each solely based on the snr of incoming and outgoing channels .",
    "this decoupling not only reduces the pairing complexity , but also reveals the distributed nature of optimal cp among multiple relays , thus allowing simple implementation that can easily adapt to network topology changes .    _",
    "remark : _ we point out that the existing result of optimal cp strategy for dual - hop relaying is not sufficient for the induction to prove proposition [ propos1 ]",
    ". notice that , in the proof , an @xmath0-hop network ( @xmath79 ) was transformed into an equivalent @xmath20-hop network . reducing a @xmath20-hop network to a dual - hop network would require combining relay nodes with either the source or the destination to form an equivalent node and equivalent channel gain .",
    "the dual - hop result can only be applied to pairing with the _ equivalent channels _ , but is not sufficient to show the actual physical channel should follow the same pairing strategy . therefore , proposition [ prop2 ] is necessary as the basis to prove the general @xmath0-hop case .",
    "in addition , in @xcite , the l - superadditivity property @xcite is used to show that the sorted - snr cp is optimal in dual - hop af relaying for sum - rate maximization .",
    "that is , if the source - destination rate over each path can be shown to be l - superadditive , it follows that sorted - snr pairing is optimal .",
    "however , l - superadditivity does not hold for the rate function in general multi - hop relaying , where the source - destination rate is a higher dimensional function defined on @xmath80 with respect to @xmath81 , for a given @xmath6 .",
    "thus , a similar proof for the optimality of sorted - snr in the dual - hop case is not available to the general multi - hop case .",
    "[ c]source [ l]destination [ c]relay 1 [ c]relay l-1 [ c]relay l [ c]@xmath82 [ c]@xmath83 [ c]@xmath84 [ c]@xmath85 [ c]@xmath86 [ c]@xmath87 [ l]@xmath88 [ c]equivalent [ c]relay [ c]equivalent relay [ l]@xmath89 [ l](a ) [ l](b ) -hop relaying network.,title=\"fig : \" ]",
    "so far , given a fixed pa scheme , we have found that the optimal cp scheme for is snr based , which depends on the transmission power allocated to each channel .",
    "we next present the solution for by jointly optimizing cp and pa .",
    "the apparent coupling of cp and pa makes a direct exhaustive search for the jointly optimal solution prohibitively complex .",
    "instead , we will show that the joint optimization problem can be decoupled into two separate cp and pa subproblems .",
    "specifically , we prove that the jointly optimal solution is obtained by pairing channels based on the order of their _ channel gains _ ( normalized against the noise power ) , followed by optimal pa over the paired channels .",
    "this separation principle holds for a variety of scenarios , including af and df relaying under either total or individual power constraints .",
    "our argument for the separation principle is briefly summarized as follows .",
    "we first show that , at a global optimum , the channel with a higher channel gain exhibits a larger snr .",
    "this relation reveals that the snr - based ordering of channels is the same as the one based on channel gain .",
    "hence , we conclude that the sorted cp scheme based on channel gain is optimal when pa is also optimized .",
    "let @xmath90 be the received snr under the optimal pa solution @xmath91 for hop @xmath7 and channel @xmath6 .",
    "for both total and individual power constraints , the following proposition establishes the equivalence between channel - gain ordering and snr - based ordering at the optimality .",
    "[ propossnr ] in the optimal cp and pa solution for , at each hop , the channel with better channel gain also provides a higher received snr , @xmath92 implies @xmath93 , for @xmath4 ; @xmath94 , and @xmath95 .",
    "we first provide a proof for a multi - hop system consisting of two channels .",
    "we then explain how it can be extended to a system with an arbitrary number of channels .",
    "[ [ n2 ] ] @xmath49 + + + + + + + + + + + + + + + + +    we prove the proposition by contradiction .",
    "let @xmath96 and @xmath97 represent the two disjoint source - destination paths corresponding to the optimal cp scheme .",
    "consider any hop @xmath7 along these paths . without loss of generality , let channel @xmath18 belong to @xmath97 , channel @xmath19 belong to @xmath96 , and @xmath98 .",
    "suppose at optimality @xmath99 , i.e. , @xmath100 , where @xmath101 and @xmath102 are the power allocated to channels @xmath18 and @xmath19 , respectively .",
    "let @xmath103 .",
    "consider the following alternate allocation of power between channels @xmath18 and @xmath19 over hop @xmath7 @xmath104 we further swap the two channels so that channel @xmath18 belongs to path @xmath96 and channel @xmath19 belongs to path @xmath97 . since @xmath105 and @xmath106 , the above procedure of power re - allocation and channel swapping does not change the end - to - end rate .",
    "@xmath107 where inequality is obtained from our assumption that @xmath108 , which can be rewritten as @xmath109 , and that @xmath98 .",
    "this contradicts our initial assumption that the original pa is globally optimal .    [",
    "[ n2 - 1 ] ] @xmath110 + + + + + + + + + + + + + + + + +    a similar proof by contradiction as it was used in section [ multi_subcarrier ] for proposition [ prop2 ] can be applied to generalize the above result to @xmath110 . for",
    "an @xmath2-channel relay system with @xmath110 , suppose the optimal cp scheme follows the pairing rule of the sorted cp based only on snr gain and not channel gain . as a result",
    ", there is at least one hop over which , between two channels , the channel with better channel gain demonstrates a lower snr .",
    "these two channels essentially belong to the two source - destination paths that can be considered as a @xmath19-channel relay system . from the above , we know that by just swapping these two channels and applying the alternate allocation of power in , the sum power is reduced while maintaining the same rate .",
    "this leads to a contradiction of our early assumption on the optimality of the sorted cp not being conducted based on the channel gain .",
    "[ thm ] the joint optimization of cp and pa in can be separated into the following two steps :    1 .",
    "obtain the optimal cp @xmath44 .",
    "the optimal cp @xmath44 is independent of @xmath111 and is performed individually at each relay in the order of sorted channel gain .",
    "2 .   obtain the optimal pa @xmath111 under the optimal cp @xmath44 : @xmath112    from proposition [ propos1 ] , with optimal pa @xmath111 , the sorted - snr cp gives the optimal @xmath44 . from proposition [ propossnr ] , at optimality , the sorted - snr cp is equivalent to sorting channel gains , which does not require the knowledge of @xmath111 .",
    "the optimal @xmath111 then can be obtained under the optimal cp , and we have the separation principle .",
    "decoupling the cp strategy from pa strategy significantly reduces the problem search space .",
    "in addition , the optimal cp strategy in the presence of multiple hops is further decoupled into independent sorting problems at each hop , which only depends on the channel gain on the incoming and outgoing channels .",
    "the complexity of the optimal cp strategy for each hop is that of sorting channel gain , which is @xmath113 .",
    "therefore , the total complexity of the joint cp and pa optimization is @xmath114 in addition to the complexity of pa optimization .",
    "so far we have obtained the optimal cp at all relays .",
    "we next find the optimal pa solution for a given cp scheme as in . with the channels paired at each relay , the system can be viewed as a regular multi - hop system . without loss of generality , we assume the channel gains at each hop are in descending order according to their channel index , @xmath115 , for @xmath4 . from proposition [ thm ] ,",
    "the channels with the same index are paired , and a path with the optimal cp consists of all the same channel index , @xmath116 . in the following ,",
    "we consider the pa optimization problem for total power and individual power constraints separately .",
    "the optimal pa solution with a total power constraint for a multi - hop relaying ofdm system was obtained in @xcite .",
    "the results can be directly applied here .",
    "we briefly state the solution for completeness .",
    "the pa optimization problem in with a total power constraint has the classical water - filling solution [ opt_pa_tot ] p_i^ * = ^+ i=1,,n , where @xmath117^+ = \\max(x,0)$ ] .",
    "the lagrange multiplier @xmath118 is chosen such that the power constraint in is met , and @xmath119 is an equivalent channel gain over the path @xmath120 .    for df relaying , the equivalent channel gain , denoted as @xmath121 ,",
    "is given by @xcite @xmath122 in other words , the equivalent channel gain is @xmath2 times the harmonic mean of the channel gain over each hop .",
    "it is obtained following the fact that , to maximize the source - destination rate on one path , the total power allocated to the path must be shared among the channels on this path such that all channels exhibit the same snr . the power allocated to each transmitting node on path @xmath123",
    "is given by [ popt_df_tot ] p^*_m , i=.    for af relaying , the exact expression for equivalent channel gain on path @xmath120 is difficult to obtain .",
    "however , its upper bound approximation can be expressed as @xcite @xmath124 in this case , the equivalent channel amplitude ( normalized against noise standard deviation ) is @xmath2 times the harmonic mean of the channel amplitude over each hop .",
    "it is obtained using the upper bound approximation of equivalent snr in over a path .",
    "the power allocated to each transmitting node on path @xmath123 is given by [ popt_af_tot ] p^*_m , i=. the pa solution in requires global channel gain information and therefore needs to be implemented in a centralized fashion .",
    "for df relaying , the source - destination sum rate in reduces to r^_t = _ n=1^n _ m=1,,m _ 2(1 + p_m , n a_m , n ) .",
    "[ eq_df_rate ] maximizing over @xmath125 under individual power constraints in can be cast into the following optimization problem using a set of auxiliary variables @xmath126^t$ ] : @xmath127 where @xmath128_{m\\times n}$ ] . since the objective function is linear , and all the constraints are convex , the optimization problem in is convex .",
    "for such a problem , slater s condition holds @xcite , and the duality gap is zero .",
    "thus , can be solved in the lagrangian dual domain .",
    "since the spatial reuse factor @xmath36 is a constant , we drop it for simplicity without affecting the optimization problem .",
    "consider the lagrange function for , ( , , , ) = _",
    "n=1^n r_n - _ n=1^n_m=1^m _ m , n(r_n- _ 2(1+p_m , n a_m , n ) ) - _ m=1^m _ m(_n=1^n p_m , n - p_mt ) [ lagrange_df ] where @xmath129_{m\\times n}$ ] with @xmath130 being the lagrange multiplier corresponding to constraint @xmath131 in , and @xmath132^t$ ] with @xmath133 being the lagrange multiplier associated with power constraint in @xmath134 in . the dual function is given by @xmath135    optimizing over @xmath136 for given @xmath137 , @xmath138 and @xmath139 yields _ m=1^m _ m , n = 1 , n=1,,n [ eq_kmkt ] . substituting this into @xmath140 , we obtain ( , , , ) = _ n=1^n_m=1^m ( _ m , n _ 2 ( 1+p_m , na_m , n ) - _ m p_m , n ) + _ m=1^m _ m p_mt .",
    "[ eq_lagpnk ]    it is clear that the dual function @xmath141 ) obtained by maximizing can be decomposed into @xmath142 subproblems @xmath143 with @xmath144 where @xmath145 for @xmath146 . by applying kkt conditions @xcite to , the optimal power allocation @xmath147 , as a function of @xmath130 and @xmath133 , is derived as @xmath148^+   \\label{eq_kktpw},\\ ] ] for @xmath5 and @xmath149 , where @xmath133 is chosen to meet the power constraint in .    finally ,",
    "the optimization problem in is equivalent to the dual problem @xmath150 this dual problem can be efficiently solved by using the _ projected _ subgradient method @xcite .",
    "analogous to a common subgradient method , a sequence of lagrange multipliers is generated which converges to the optimal @xmath151 and @xmath152 minimizing @xmath153 .",
    "this convergence is achieved provided that a suitable step size is chosen at each iteration @xcite .",
    "the difference between projected and normal subgradient methods lies in having an extra constraint @xmath154 . to satisfy this constraint , at each iteration , the projected subgradient method projects the columns of @xmath138 ( obtained by subgradient method ) onto a unit space to attain a set of feasible multipliers . at each iteration",
    ", a subgradient of @xmath155 at the current values of @xmath130 and @xmath133 is required .",
    "let @xmath156^t$ ] denote the subgradient , where @xmath157^t$ ] and @xmath158^t$ ] .",
    "it is obtained from as [ subgradient ] _ _ m , n = _ 2 ( 1+p^*_m , n a_m , n ) , for @xmath4 and @xmath5 , and _ _ m = p_m , n - _",
    "n=1^n p^*_m , n , for @xmath4 , where @xmath147 is obtained from .    for completeness , we summarize the projected subgradient algorithm for solving the dual problem :    1 .   initialize @xmath159 and @xmath160 .",
    "2 .   given @xmath161 and @xmath162 ,",
    "obtain the optimal values of @xmath147 in for all @xmath7 and @xmath6 .",
    "update @xmath163 through @xmath164^+,\\ ] ] for @xmath4 .",
    "similarly , update @xmath165 followed by unitary space projection = , [ projection]where ^(l+1)_m ,",
    "n = ^+ , for @xmath4 ; and @xmath5 .",
    "@xmath166 and @xmath167 are the step sizes at the @xmath168th iteration for multipliers @xmath169 and @xmath118 , respectively .",
    "4 .   let @xmath170 ; repeat from step 2 until convergence .    with the optimal @xmath171 and @xmath152 , the optimal power solution @xmath172 is determined as in , for @xmath149 and @xmath5 , p^*_m ,",
    "n = ^+ , [ eq_kktpwopt ] where @xmath173 satisfies the constraint , and at the same time , @xmath173 and @xmath174 are chosen so that the individual power constraints in constraint @xmath175 of are met .",
    "the expression of @xmath176 in provides some insight on the structure of the optimal pa for multi - hop df relaying : for a given @xmath138 , the power allocation across channels at each node is individually determined following a scaled version of the water - filling approach based on the channel gain .",
    "the scales are determined jointly among different hops to satisfy the condition of @xmath177 in .",
    "it essentially requires the received snr @xmath178 at each hop of the same path to be equal .",
    "we now consider the pa problem for af relaying .",
    "unlike df , the achievable source - destination sum rate for af is not generally concave in @xmath125 .",
    "therefore , we have a non - convex optimization problem formulated as @xmath179^{-1 } \\right ) \\label{opt_af } \\\\",
    "\\text{subject to } \\quad &",
    "i ) \\quad \\sum_{n=1}^n p_{m , n } \\le p_{mt } , \\quad m=1,\\cdots , m \\nn \\\\                  & ii)\\quad   \\mb{p } \\succeq 0 \\nn.\\end{aligned}\\ ] ] to find the pa solution we resort to an upper bound of the sum rate in . based on , an upper - bound approximation is given by [ rt_up ] r_t^ = _ n=1^n _ 2 ( 1 + ( _ m=1^m ) ^-1 ) .",
    "this upper bound becomes tight as the received snr @xmath180 over each channel increases .",
    "[ prop : rtup ] @xmath181 in is concave with respect to @xmath125 .",
    "the proof follows from the concavity of with respect to @xmath125 , which can be shown by considering its hessian matrix .",
    "the details are given in appendix  [ app : rtup ] .",
    "given lemma [ prop : rtup ] , the optimization of @xmath125 to maximize @xmath181 is a convex optimization problem , and we can solve it in the lagrangian dual domain using kkt conditions @xcite .",
    "although a closed - form or semi - closed - form solution for @xmath125 is difficult to obtain in this case , we can solve it numerically via standard convex optimization tools .",
    "in this section , we provide simulation examples to evaluate and compare the performance of the optimal joint cp and pa scheme with that of suboptimal cp and pa alternatives .",
    "we study different factors that affect the performance gap under these schemes .    besides the jointly optimized cp and pa scheme ,",
    "the following suboptimal schemes are used for comparison : 1 ) _ uniform pa with cp _ : the optimal sorted channel gain based cp is first performed . at each transmitting node ,",
    "the power is uniformly allocated on each subcarrier .",
    "in addition , for total power constraint , the total power is also uniformly allocated to each transmitting node .",
    "therefore , for individual power constraint , @xmath182 ; and for total power constraint , @xmath183 ; 2 ) _ opt .",
    "pa without cp _ : only power allocation is optimized but no pairing , the same incoming and outgoing channels are assumed ; 3 ) _ uniform pa without cp _ : the same incoming and outgoing channels are assumed , then uniform pa as in the case 1 is used .",
    "we use an ofdm system as an example of a multi - channel system , and refer each subcarrier as a channel in this case . for the multi - hop setup , equal distance is assumed from hop to hop , and is denoted by @xmath184 .",
    "no direct link between source and destination is available .",
    "the spatial reuse factor is set to @xmath185 ( interference is assumed negligible three hops away ) .",
    "we assume @xmath186 , unless it is otherwise specified .",
    "an @xmath75-tap frequency - selective fading channel is assumed for each hop .",
    "we define the _ average snr _ as the average received snr over each subcarrier at each receiving node under uniform power allocation .",
    "specifically , it is defined for different power constraint as follows : under the total power constraint , @xmath187 , where @xmath188 denotes the pathloss exponent and @xmath189 the noise variance ; under the individual power constraint , @xmath190 .",
    "we compare the the performance of various cp and pa schemes at different average snr levels .",
    "[ figdf2 ] shows the normalized source - to - destination per - subcarrier rate vs. the average snr , for df relaying under the total power constraint .",
    "the number of channels is set to @xmath191 .",
    "we observe that joint optimization of cp and pa provides significant performance improvement over the other schemes .",
    "in particular , compared with uniform pa without cp , the optimal cp alone provides 4db gain , and subsequently optimally allocating power provides an additional 1.5 - 2db gain .",
    "interestingly , it is evident that channel pairing alone provides more performance gain than power allocation alone does .",
    "[ figaf2 ] plots the normalized source - to - destination per - subcarrier rate vs. the average snr for af relaying under the total power constraint .",
    "again , @xmath191 is used . for schemes with pa optimization , the upper - bound @xmath181 in",
    "is used to obtain the pa solution .",
    "the actual rate @xmath38 obtained ( as in the objective function in ) with such pa solution provides a lower bound on the rate under the optimal pa . in fig .",
    "[ figaf2 ] , for the jointly optimal cp and pa scheme and optimal pa without cp scheme , we plot both upper bound and lower bound of the rate for the optimal pa solution .",
    "we see that these two bounds become tighter as the average snr increases , due to the improving accuracy of approximation @xmath181 .",
    "the pa solution derived using @xmath181 becomes near optimal .    comparing the performance of different cp and pa schemes shown in fig .",
    "[ figaf2 ] , it is seen that similarly as in the df case , joint optimization of cp and pa provides noticeable improvement over the other schemes .",
    "the gain mainly comes from choosing cp optimally , which provides around @xmath19db gain over no cp schemes .",
    "we further observe that , with optimal cp , the gap between optimal and uniform pa vanishes at higher snr , indicating that uniform pa achieves the optimal performance at a moderately high snr range ( around 15db ) .",
    "interestingly , this is not the case for the schemes _ without cp_. the intuition behinds this is the following : at relatively high snr , it is known that the water - filling pa solution in approaches a uniform allocation .",
    "thus , the total power is approximately equally distributed to different paths .",
    "the power on each path @xmath192 is then further assigned optimally to each channel on the path according to , which is typically not uniform .",
    "the exception is when each hop exhibits a similar channel gain .",
    "this is more likely to occur as a result of channel pairing , where channels with the same rank , more likely with similar strength , are paired with each other .",
    "therefore , with cp , the optimal pa approaches to a uniform allocation at a faster rate with increasing snr . , it approaches to a uniform allocation in all schemes with or without cp .",
    "the difference is the rate at which pa approaches to a uniform allocation .",
    "] this interesting observation suggests that , because of cp , at moderately high snr , we are able to reduce the centralized pa solution to a simple uniform pa which requires no global channel information without losing much optimality .",
    "note that the same argument is applicable to df relaying , but the optimal pa approaches to a uniform allocation at a much slower rate than that for af , which can be shown by comparing and .",
    "the range of snr values under consideration is too small to see the same effect in fig .",
    "[ figdf2 ] .    under individual power constraints , the performance comparison of cp and pa schemes are given in figs .",
    "[ figdf2_indw ] and [ figaf2_indw ] for df and af relaying , respectively .",
    "we assume @xmath193 .",
    "these figures further demonstrate the significant improvement by jointly optimizing cp and pa , where most of the gain comes from optimal cp .",
    "in addition , under af relaying , we again observe a near - optimal performance by uniform pa with cp at moderately high snr .",
    "this suggests that , under individual power constraints , the optimal pa is close to a uniform allocation at high snr as well when cp is adopted .",
    "this potentially simplifies greatly the pa implementation to achieve the optimal performance .      in this experiment , we show how the level of channel gain variation across @xmath2 channels affects the performance of various cp and pa schemes . towards this goal , we increase the number of taps of the time - domain frequency - selective channel ( the maximum delay of the frequency - selective channel ) .",
    "this increases the level of variation of the corresponding frequency response",
    "[ figdf_vs_ntaps ] and [ figaf_vs_ntaps ] plot the normalized per - subcarrier rate vs. the number of taps of the frequency - selective channel for df and af relaying , respectively .",
    "the number of subcarriers is set to @xmath191 and @xmath194db . as we see , the performance gap between the schemes with optimal cp and without cp increases as the level of channel gain variation increases .",
    "this demonstrates that the optimal cp schemes benefit from an increased level of channel diversity , which is utilized effectively through the channel pairing . on the other hand ,",
    "the relative gain of optimal pa to uniform pa is insensitive to such change and remains constant .      in this experiment",
    ", we examine the effect of the number of channels , under the same level of channel gain variation across channels , on the performance of various cp and pa schemes . for different @xmath2 , the subcarrier spacing ( bandwidth of each channel )",
    "is fixed . in order to set the same level of channel gain variation in frequency",
    ", we keep the maximum delay of the time - domain frequency - selective channel unchanged . figs .",
    "[ figdf_vs_nsub ] and [ figaf_vs_nsub ] demonstrate the normalized per - subcarrier rate with respect to @xmath2 for df and af relaying , respectively .",
    "the average snr is set to @xmath194db .",
    "we observes that the gap between the two sets of schemes , with and without cp , widens as the number of channels increases .",
    "the reason behind this observation is that , as more channels becomes available , they can be exploited more judiciously for pairing , and therefore , more gain is achieved by cp .",
    "the different pa schemes are not sensitive to the change of @xmath2",
    ".      in this experiment , we study how the number of hops affects the performance of various cp and pa schemes .",
    "for this purpose , we increase the number of hops while keeping the distance between each hop unchanged . figs .",
    "[ figdf_vs_mh ] and [ figaf_vs_mh ] illustrate the normalized per - subcarrier rate vs. the number of hops with total power constraint for df and af relaying , respectively .",
    "we set @xmath191 and @xmath194db . as expected , for all schemes , the normalized per - subcarrier rate decreases as the number of hops increases . for df",
    ", this is because on average the minimum rate among all hops decreases as the number of hops increases ; for af , the rate decreases due to noise amplification over hops .",
    "comparing different schemes , we observe that the performance of the jointly optimized cp and pa scheme has the slowest decay rate , and the performance of the schemes with cp decay is slower than those without cp . in other words ,",
    "the gain of optimal cp and pa is more pronounced as the number of hops increases .",
    "a multiple - fold gain is observed at a higher number of hops .",
    "in this paper , we have studied the problem of jointly optimizing spectrum and power allocation to maximize the source - to - destination sum rate for a multi - channel @xmath0-hop relaying network . for fixed power allocation",
    ", we have shown that the general cp problem over multiple hops can be decomposed into @xmath1 independent cp problems at each relay , where the sorted - snr cp scheme is optimal .",
    "we then proved that a jointly optimal solution for the cp and pa problems can be achieved by decomposing the original problem into two separate cp and pa problems solved independently .",
    "the solution obtained through the separate optimization bears considerably lower computational complexity compared with exhaustive - method alternatives .",
    "the separation principle was shown to hold for a variety of scenarios including af and df relaying strategies under either total or individual power constraints .",
    "for all these scenarios , the optimal cp scheme maps the channels according to their channel gain order , independent of the optimal pa solution . finally , the solution for pa optimization under the individual power constraints is derived for both af and df relaying .",
    "significant gains in data rate were demonstrated by employing jointly optimal cp and pa in multi - channel multi - hop relaying .",
    "it was also observed that more gain is obtained from optimal cp than optimal pa through judiciously exploiting variation among multiple channels .",
    "at relay @xmath18 , there are two ways to pair the channels : ( 1 ) channels @xmath18 and @xmath19 over hop @xmath18 are matched with channels @xmath18 and @xmath19 over hop @xmath19 , respectively ; ( 2 ) channels @xmath18 and @xmath19 over hop @xmath18 are matched with channels @xmath19 and @xmath18 over hop @xmath19 , respectively .",
    "these two ways of pairing lead to the following two sets of disjoint paths from the source to the destination : @xmath195 and @xmath196 , where the superscript @xmath197 in @xmath198 indicates a different set of path selection .    by considering the _ equivalent _ channels from the source to the second relay , using the existing optimality result for dual - hop relaying @xcite , it is easy to see that @xmath199 and @xmath200 are optimal for @xmath201 . furthermore , we only need to show @xmath202 for the case of @xmath199 and @xmath200 for both @xmath201 and @xmath203 , since the case of @xmath204 and @xmath205 for @xmath203 can be similarly proven .",
    "inequality for the af and df relaying cases are separately proven as follows :    [ [ af - relaying ] ] af relaying + + + + + + + + + + +    by inserting into inequality we need to show @xmath206 where @xmath207 the following lemma is used to prove    [ lemma2 ] with condition , we have @xmath208    by substituting ( [ qfuncs ] ) in the following term and expanding it , we have @xmath209 \\label{aa}\\\\ & \\le & 0 \\nn\\end{aligned}\\ ] ] where we have used the fact that @xmath210 to arrive at ( [ app : a1 ] ) . from condition , the first product term in ( [ aa ] ) is negative and the second product term is positive , and therefore we obtain the last inequality .",
    "consider the subtraction of the rhs from the lhs of ( [ inequal ] ) , @xmath211 \\nn \\\\ & \\geq & 0 , \\label{inequal3}\\end{aligned}\\ ] ] where the inequality holds because of lemma [ lemma2 ] , and the fact that @xmath212 , for @xmath213 and @xmath214 ; and the inequality ( [ inequal3 ] ) holds because of condition .",
    "[ [ df - relaying ] ] df relaying + + + + + + + + + + +    inserting into inequality , we need to show @xmath215 we can verify ( [ dfinequal ] ) by enumerating all possible relations among @xmath178 , for all @xmath216 and @xmath217 , subject to condition . for example , when @xmath218 , @xmath219 , @xmath220 , and @xmath221 , reduces to @xmath222 the above inequality clearly holds based on the assumption of @xmath223 relations .",
    "inequality can be similarly verified for all other @xmath223 relations .",
    "the details are omitted for brevity .",
    "let @xmath224 denote the end - to - end data rate on path @xmath6 , we have @xmath225 , @xmath5 , where _ n = ( _ m=1^m ) ^-1 .",
    "[ path_snr ] then @xmath226 .",
    "to show @xmath181 is concave in @xmath125 , it suffices to show that each @xmath224 is concave in @xmath227 .",
    "the concavity proof of @xmath224 follows the concavity of @xmath228 due to the composition rules which preserve concavity @xcite . for simplicity",
    ", we drop the subscript @xmath6 from notations in . in the following",
    "we prove that @xmath229 is concave in @xmath230 , where @xmath231^t$ ] .",
    "the second - order partial derivatives of @xmath229 are given by = ( _ i=1^m ) ^-2 + ( _ i=1^m ) ^-3 and = ( _ i=1^m ) ^-3 , kj .",
    "hence , the hessian matrix @xmath232 can be expressed as ^2(|p ) = ( _ i=1^m ) ^-3 ( -2(_i=1^m ) ( , , ) + 2 ^t ) , where @xmath233^t$ ] with @xmath234 , and @xmath235 denotes the diagonal matrix with diagonal elements being the elements in vector @xmath236 . to prove concavity",
    ", we need to show @xmath237 . for any vector @xmath238^t$ ] , we have @xmath239 where the inequality is obtained by using the cauchy - schwartz inequality @xmath240 for two vectors @xmath241^t$ ] and @xmath242^t$ ] , with @xmath243 and @xmath244 . therefore , @xmath237 .",
    "hsu , h .- j .",
    "su , and p .- h .",
    "lin , `` joint subcarrier pairing and power allocation for ofdm transmission with decode - and - forward relaying , '' _ ieee trans .",
    "signal processing _ , vol .",
    "59 , no .  1 ,",
    "399414 , jan . 2011"
  ],
  "abstract_text": [
    "<S> we study the problem of channel pairing and power allocation in a multi - channel multi - hop relay network to enhance the end - to - end data rate . </S>",
    "<S> both amplify - and - forward and decode - and - forward relaying strategies are considered . </S>",
    "<S> given fixed power allocation to the channels , we show that channel pairing over multiple hops can be decomposed into independent pairing problems at each relay , and a sorted - snr channel pairing strategy is sum - rate optimal , where each relay pairs its incoming and outgoing channels by their snr order . for the joint optimization of channel pairing and power allocation under both total and individual power constraints , we show that the problem can be decomposed into two separate subproblems solved independently . </S>",
    "<S> this separation principle is established by observing the equivalence between sorting snrs and sorting channel gains in the jointly optimal solution . </S>",
    "<S> it significantly reduces the computational complexity in finding the jointly optimal solution . the solution for optimizing power allocation </S>",
    "<S> is also provided . </S>",
    "<S> numerical results are provided to demonstrate substantial performance gain of the jointly optimal solution over some suboptimal alternatives . </S>",
    "<S> it is also observed that more gain is obtained from optimal channel pairing than optimal power allocation through judiciously exploiting the variation among multiple channels . </S>",
    "<S> impact of the variation of channel gain , the number of channels , and the number of hops on the performance gain is also studied through numerical examples . </S>"
  ]
}