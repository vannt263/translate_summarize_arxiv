{
  "article_text": [
    "bose - einstein condensation ( bec ) , whereby bosons form a condensate by macroscopically occupying the lowest energy state of the system , is a striking and important consequence of quantum statistics at low temperatures .",
    "the resultant long - range order manifests itself in phenomena such as macroscopic coherence and superfluidity . in general the condensate",
    "is depleted by correlation effects and through thermal population of excited states at finite temperatures .",
    "the former , termed _ quantum depletion _ , is particularly important for dense fluids such as liquid @xmath0 , where only around 10% of the atoms are condensed in the low temperature limit .",
    "in contrast , the quantum depletion in trapped , dilute gaseous becs @xcite is typically less than 1% @xcite .",
    "the noncondensed fraction is thus mainly composed of thermal excitations , and almost pure condensates can be prepared by evaporative cooling to very low temperatures .",
    "atomic vapors therefore allow unique opportunities to study the properties of bose condensates under a wide range of conditions , from the pure condensate phase to the noncondensed thermal cloud above the bec transition .",
    "the condensate in a dilute bose gas is well - described by means of a macroscopic wavefunction , which in the limit of low temperatures evolves according to the gross - pitaevskii ( gp ) equation .",
    "well - known techniques allow both numerical and analytical solutions of this equation , and comparisons with experiment at low temperatures show excellent agreement for both static and dynamical properties @xcite .",
    "however , generalizations of the theory to finite temperatures , where thermal excitations coexist with the condensate , have proved far more difficult . to accurately describe the dynamical behavior in this situation",
    "requires a theory which treats both components in a fully consistent manner .",
    "such theories have recently been formulated , but the challenge of obtaining explicit solutions has remained .",
    "what has been lacking in particular is a computationally feasible method for treating the dynamics of the thermal cloud .",
    "it is these computational aspects that concern us most in this paper .",
    "the earliest studies of dynamics at finite temperatures were based on the hartree - fock - bogoliubov ( hfb ) approximation @xcite . within this theory ,",
    "excitations of the condensate are obtained by solving the hfb equations which are derived by linearizing the gp equation about the equilibrium solution , or equivalently , from the grand canonical hamiltonian of the system @xcite .",
    "the frequencies of the excitations are identified with the collective modes of the condensate .",
    "this theory , however , is incomplete .",
    "although the excitations are thermally populated , the condensate in fact oscillates in the presence of a _",
    "static _ thermal cloud .",
    "this ignores the dynamical response of the thermal cloud to condensate fluctuations which is responsible for landau damping and associated frequency shifts . by the same token",
    ", the theory can not be used to account for the response of the system to external perturbations as typically used in experiments to excite the trapped gas @xcite .",
    "this problem becomes critical at high temperatures , where collective motion of the thermal cloud can exert a major influence on the condensate evolution , as reflected in experimental results for the mode frequency and damping rate .",
    "recent important work by morgan _",
    "et al._@xcite and giorgini @xcite has extended the hfb theory to include collisionless noncondensate dynamics within second - order perturbation schemes , and derived expressions for damping rates and frequency shifts of low - energy modes .",
    "a variant of these approaches is the dielectric response formulation of reidl _ et al .",
    "one limitation of these theories is the absence of collisions which require a kinetic theory for their description .",
    "quantum kinetic equations for becs have been developed by gardiner and collaborators @xcite , stoof @xcite and walser _ et al .",
    "however , calculations based on these theories are very difficult to carry out and as a result , they have not yet been used to study collective excitations .",
    "a somewhat simpler scheme is the one developed by zaremba , griffin and nikuni ( zgn ) @xcite , which treats the excitations semiclassically within the hartree - fock ( hf ) and popov approximations .",
    "one can then identify the excitations with a thermal cloud of particles , with dynamics governed by a boltzmann equation for the phase - space density . in analogy with its classical counterpart ,",
    "binary collisions between particles are described by means of a collision integral ; however , an additional collision integral arises to account for collisions with the condensate .",
    "the latter leads to an important modification of the gp equation which must now include a non - hermitian source term to account for the transfer of atoms into and out of the condensate .",
    "this process , taken together with mean field coupling between the two components , leads to damping and frequency shift of the condensate collective modes at finite temperature .",
    "the coupled gp and boltzmann equations are far from trivial to solve , and several approximations have been invoked in the literature in order to explore their properties .",
    "when the characteristic collisional time scale , @xmath1 , satisfies @xmath2 , where @xmath3 is the trap frequency , then collisions dominate and the system is said to be in the hydrodynamical regime .",
    "one can then take moments of the kinetic equation to derive a set of coupled hydrodynamic equations for the noncondensate which , together with similar equations for the condensate , can be solved under certain conditions @xcite . in the opposite collisionless regime , @xmath4 , stoof and co - workers @xcite",
    "have used a joint variational and moment scheme to model the condensate and noncondensate , respectively , while nikuni @xcite recently applied a moment method to study the scissors mode @xcite .",
    "although these moment methods provide some insight into the coupled dynamics of the two components , they constitute a truncated description which precludes coupling to internal degrees of freedom of the gas .",
    "thus , landau damping is neglected . in order to avoid this limitation , and to facilitate direct comparisons with experiment",
    ", one must resort to the full kinetic theory .",
    "it is therefore desirable to directly simulate the zgn equations without making approximations beyond those used to derive the equations themselves . in this paper , we describe a technique to calculate the dynamics of the thermal cloud using @xmath5-body simulations . within this approach ,",
    "a swarm of test particles is used to represent the evolution of the semiclassical phase - space density , while collisions are handled using a monte carlo sampling technique .",
    "the dynamics of the condensate on the other hand is determined by numerically propagating the gp equation using a split - operator fast fourier transform ( fft ) method .",
    "application of the method to the quadrupole @xcite and scissors @xcite modes has been discussed elsewhere , and in both cases , good agreement with experiment @xcite was found .",
    "although an outline of the numerical methods used was given in this earlier work , we give much more detail in the present paper .",
    "this paper is organized as follows . in sec .",
    "[ sec : zgn ] we briefly review the zgn formalism , before discussing our numerical methods in sec .   [ sec : numer ] . in sec .",
    "[ sec : results ] the monte carlo sampling is tested by comparison of equilibrium collision rates against semi - analytic calculations .",
    "landau and collisional damping rates for the monopole modes in spherical traps are also compared to previous theoretical treatments .",
    "we sum up and outline possible future research directions in the conclusion .",
    "we begin by reviewing the zgn formalism , which was derived and discussed in detail in ref .  @xcite . for",
    "a bose - condensed gas one can decompose the second - quantized field operator @xmath6 in the following manner @xmath7 where the ensemble average @xmath8 takes on a non - zero value due to bose broken symmetry , and is identified with the condensate wavefunction .",
    "the remaining field operator @xmath9 has a zero expectation value and corresponds to the noncondensed component of the cloud .",
    "the second - quantized hamiltonian for the system is given by @xmath10 \\hat{\\psi }   ( \\br ) } \\nonumber \\\\   & & \\mbox { } + \\frac{1}{2 } \\int { \\rm d}\\br \\ , { \\rm d}\\br'\\,\\hat{\\psi}^{\\dagger }   ( \\br ) \\hat{\\psi}^{\\dagger } ( \\br ' ) u_{\\rm int } ( \\br,\\br ' )   \\hat{\\psi } ( \\br ' ) \\hat{\\psi } ( \\br ) , \\label{eq : hamil}\\end{aligned}\\ ] ] where in most cases the trap is well approximated by a harmonic potential @xmath11 .",
    "we also assume a contact interaction , @xmath12 , with @xmath13 , where @xmath14 is the @xmath15-wave scattering length and @xmath16 is the atomic mass . using @xmath17 $ ] with ( [ eq : decomp ] ) and ( [ eq : hamil ] )",
    ", one can derive coupled equations of motion for the condensate and thermal cloud .",
    "in particular , the condensate order parameter evolves according to a generalized form of the gp equation @xmath18 - ir(\\br , t ) \\right ) \\phi(\\br , t ) , \\label{eq : gp - gen}\\ ] ] where @xmath19 and @xmath20 are the condensate and noncondensate densities respectively . in arriving at this equation",
    "we make the popov approximation whereby the so - called `` anomalous '' density , @xmath21 , is neglected .",
    "this sidesteps problems associated with including this term , such as ultraviolet divergences and an unphysical gap in the energy spectrum at low momenta @xcite . to go beyond this approximation in a consistent manner requires a careful treatment of interparticle collisions @xcite , and is beyond the scope of the present work .",
    "the source term @xmath22 is an important modification of the usual gp equation as it allows the normalization of the wavefunction @xmath23 to change with time .",
    "physically this is due to collisions between condensate and noncondensate atoms which have the effect of transferring atoms into or out of the condensate .",
    "the source term will be defined in terms of a collision integral later .",
    "it is convenient to describe the dynamics of the noncondensate in terms of the wigner operator @xcite , which leads to the definition of a phase - space distribution , @xmath24 , for the thermal excitations .",
    "the equation of motion for the noncondensate can then be written as a kinetic equation @xmath25 + c_{22 } [ f ] .",
    "\\label{eq : kinetic}\\ ] ] deriving this equation a number of approximations have been made , some of which have already been mentioned .",
    "importantly , the excitations are assumed to be semiclassical within the hf approximation ; an excitation with momentum @xmath26 possesses an energy @xmath27 , where the effective potential @xmath28 $ ] is composed of the trap potential as well as mean fields from the condensate and the thermal cloud .",
    "the noncondensate density appearing in this expression is given in terms of the distribution by @xmath29    the terms on the right - hand side of ( [ eq : kinetic ] ) are collision integrals that represent binary collisions between atoms .",
    "the @xmath30 term is familiar from the kinetic theory of a normal bose gas , and corresponds to the scattering of two atoms from initial to final thermal states .",
    "it is given by @xmath31 & = & \\frac{\\sigma}{\\pi h^3 m^2 } \\int { \\rm d}\\bp_2 { \\rm d}\\bp_3   { \\rm d}\\bp_4 \\delta(\\bp+\\bp_2-\\bp_3-\\bp_4 ) \\nonumber \\\\   & & \\qquad\\qquad \\times \\delta(\\epsilon+\\epsilon_2   -\\epsilon_3-\\epsilon_4 ) [ ( 1+f)(1+f_2)f_3 f_4 - f f_2 ( 1+f_3)(1+f_4 ) ] .",
    "\\label{eq : c22}\\end{aligned}\\ ] ] where @xmath32 and @xmath33 .",
    "the total bosonic cross - section is given by @xmath34 .",
    "the delta functions enforce momentum and energy conservation in the collision , while the factors @xmath35 account for bose - enhancement of the scattering .",
    "the analogous @xmath36 collision integral corresponds to collisions that involve a condensate atom in either the initial or final states .",
    "it is given by @xmath37&=&\\frac{\\sigma n_c}{\\pi m^2 } \\int { \\rm d}\\bp_2 { \\rm d}\\bp_3    { \\rm d}\\bp_4 \\delta(m\\bv_c + \\bp_2-\\bp_3-\\bp_4 )    \\delta(\\epsilon_c+\\epsilon_2-\\epsilon_3-\\epsilon_4 ) \\nonumber \\\\   & & \\quad \\times[\\delta(\\bp-\\bp_2)-\\delta(\\bp-\\bp_3)-\\delta(\\bp-\\bp_4 ) ]   [ ( 1+f_2)f_3 f_4 - f_2 ( 1+f_3)(1+f_4 ) ] , \\label{eq : c12}\\end{aligned}\\ ] ] where the local condensate velocity and energy are respectively given by @xmath38,\\ ] ] and @xmath39 here , @xmath40 is the condensate chemical potential defined as @xmath41 if the condensed and noncondensed components are in local equilibrium , the @xmath36 integral vanishes .",
    "conversely , when the system is perturbed from equilibrium the @xmath36 term acts to transfer atoms between the condensate and thermal cloud .",
    "these collisions then define the source term in ( [ eq : gp - gen ] ) according to @xmath42 .",
    "\\label{eq : rterm}\\ ] ] the relative numbers of condensate and thermal particles will then adjust as a function of time until local equilibrium is re - established .",
    "in this section we describe the numerical methods used to solve the zgn equations ( [ eq : gp - gen])([eq : rterm ] ) in the context of a dynamical simulation .",
    "we first discuss the numerical methods used to solve the gp and collisionless boltzmann equations .",
    "although these are based on well - established techniques ( see e.g.  @xcite ) we feel that our partly pedagogical discussion will be useful for those trying to reproduce our simulations , while highlighting the correspondence between the quantum and classical dynamics of the system .",
    "we then move on to discuss treatment of the @xmath30 and @xmath36 collision integrals by monte carlo sampling .",
    "finally , an overview of the simulations is provided , including a discussion of how one calculates the equilibrium initial state of the system , as well as estimating the phase - space density in real time for use in evaluating the collision integrals ( [ eq : c22 ] ) and ( [ eq : c12 ] ) .      for the benefit of the following discussion",
    "we rewrite the gp equation ( [ eq : gp - gen ] ) in the form @xmath43 the time dependence of the hamiltonian , @xmath44 , arises from the potential @xmath45 which also includes the non - hermitian source term @xmath46 . in most of our simulations",
    "the time dependence is dominated by the nonlinear condensate potential and it is this term which is the main source of numerical instabilities when the number of condensate atoms is large .",
    "it is therefore important to develop a numerical algorithm which is accurate even in this limit , and at the same time , numerically efficient .    a formal solution of the above equation is given by @xmath47 where the evolution operator @xmath48 has the expansion @xmath49 expanding the hamiltonian as a taylor series , @xmath50 we obtain @xmath51 the lowest order exponential approximant to this expansion is @xmath52 the error of second order is shown explicitly .",
    "the first term on the right hand side is of course exact for a time independent hamiltonian but significant errors arise when the hamiltonian is time dependent .",
    "these errors can be minimized by reducing the time step @xmath53 , but at the expense of increasing the computation time required to complete a simulation .",
    "since this imposes practical limits on the physical problems that can be addressed , a more accurate approximant is desirable .",
    "a higher order exponential approximant is provided by @xmath54 a comparison with ( [ uexpansion ] ) indeed confirms that the error is @xmath55 . to this order of accuracy",
    ", we can make use of ( [ taylor ] ) to estimate @xmath56 by reverse differencing , @xmath57 and thus obtain @xmath58 where @xmath59 with @xmath60 this is recognized as an approximation to the potential at time @xmath61 , the midpoint of the current time step , as obtained by a linear extrapolation from the potential at times @xmath62 and @xmath63 .",
    "the implementation of ( 17 - 19 ) is very simple and costs only a small additional amount of memory to store the potential from the previous time step .",
    "the actual numerical representation of the evolution operator can be achieved by various methods .",
    "one popular approach is the crank - nicholson method @xcite , where finite - differencing cayley s form for the operator leads to a set of linear equations for the wavefunction at discrete grid - points in @xmath64 .",
    "the problem then reduces to decomposition of a tridiagonal matrix at each time step and along each spatial dimension .",
    "in contrast , we favor a split - operator method , where a factorization of the exponential is effected by means of the baker - campbell - hausdorff ( bch ) formula .",
    "one finds that @xmath65 ,   \\left(t + { \\tilde{v}\\over 2 } \\right)\\right ] +    { \\mathcal{o } } ( \\delta t^4 ) .",
    "\\label{eq : gp - ssop}\\ ] ] the error generated by this approximation is of the same order as found in ( [ higher ] ) .",
    "applying the first term on the right hand side then evolves the wavefunction to second order accuracy in @xmath53 . in principle , higher order schemes can be constructed by splitting into more elaborate combinations of the @xmath66 and @xmath67 operators . however , to justify the effort , an improved approximation for @xmath68 is required .",
    "we have found that second order accuracy is sufficient for most applications , although difficulties do arise if the time scale of the simulations is exceedingly long .",
    "the split - operator scheme ( [ eq : gp - ssop ] ) is straightforward to implement with a discrete grid in position space .",
    "the two potential steps are applied by multiplying the wavefunction at each grid point by @xmath69 , while the kinetic term @xmath70 is conveniently treated in momentum space .",
    "the limiting step in the calculation is therefore the application of forward and inverse fast fourier transforms ( ffts ) at each time step , but efficient fft routines for arbitrary numbers of dimensions are readily available @xcite .",
    "the dynamical evolution of the wavefunction can thus be followed over a series of time - steps . alternatively , stationary solutions of the time independent gp equation can be easily found by evolving the time - dependent equation in imaginary time @xmath71 .",
    "a typical application provides some indication of the relative merits of the higher order approximant in ( [ higher ] ) as opposed to the lower order scheme in ( [ eq : evol - op ] ) . with the latter ,",
    "one finds a monotonic increase in the energy expectation value with time . in simulations of a collective mode",
    "this effect would be apparent as a slow increase in the mode amplitude , which is clearly undesirable when quantifying damping at finite temperatures .",
    "more importantly , since the rate of increase scales with the mode energy , higher frequency excitations tend to build in amplitude more rapidly .",
    "these excitations are initially generated at a low level by the numerics ; however over sufficiently long simulation times they eventually lead to instabilities in the wavefunction .",
    "these problems are essentially eliminated with the higher order scheme .",
    "the stability of the simulations is dramatically improved and the energy tends to oscillate with small amplitude about a constant value , rather than increasing monotonically .",
    "the improved stability allows much larger time - steps to be taken without compromising accuracy , leading to a considerable saving in computational effort .      in this section",
    "we discuss solution of the collisionless boltzmann equation ( @xmath72 ) using @xmath5-body simulations .",
    "the effect of collisions is dealt with later .",
    "collisionless boltzmann ( or vlasov ) equations which include mean - field interactions arise in many disparate fields , such as plasma physics , condensed matter physics and astrophysics . since the equation involves phase space variables in six dimensions , it is generally very difficult to solve using standard methods for treating partial differential equations .",
    "an alternative approach used extensively in the literature is to represent the phase - space density @xmath24 by a cloud of discrete test particles @xcite .",
    "the momentum and position of each particle in an external potential @xmath73 is then evolved according to newton s equations .",
    "the phase space distribution for this situation is given by @xmath74   \\delta [ \\bp - \\bp_i ( t)]\\ , ,   \\label{eq : discrete}\\ ] ] where the weighting factor is fixed by the requirement that the phase - space distribution is normalized to the number of physical atoms , @xmath75 , with @xmath76 . by using a sufficiently large number of test particles , @xmath77 , a reasonable approximation to the continuous phase space distribution",
    "is obtained .",
    "note that the number of test and physical particles is not necessarily equal .",
    "in fact , for a relatively small number of physical atoms ( @xmath78 ) it is essential to simulate more test particles ( @xmath79 ) in order to minimize the effects of a discrete particle description .",
    "conversely for large samples one can simulate fewer `` superparticles '' so that the calculations are not too intensive .",
    "the phase space variables are updated by advancing the position and momentum of each particle at discrete time steps @xmath53 .",
    "this is not as trivial as one might naively expect .",
    "conventional integration schemes for ordinary differential equations , such as classical runge - kutta methods , can lead to non - conservation of energy over long - time simulations when applied to hamiltonian systems .",
    "this results in spurious damping or excitation of the system .",
    "in contrast , symplectic integrators @xcite are used extensively in molecular dynamics ( md ) simulations since they possess several desirable properties , such as conservation of phase - space volume and of energy over a long period ( as is required in autonomous hamiltonian systems ) .",
    "we use a second - order symplectic integrator in our calculations , which is the classical analogue of the split - operator method discussed earlier . to show this",
    ", it is convenient to work within the lie formalism @xcite .",
    "consider the classical hamiltonian for a single particle , @xmath80 .",
    "the evolution of its phase - space coordinates @xmath81 is then determined by the equation @xmath82 where @xmath83 is the poisson bracket and @xmath84 is the liouville operator @xcite .",
    "one can then write @xmath85 splitting the hamiltonian into potential and kinetic terms , @xmath86 , the bch formula can be used again to show that @xcite @xmath87 one now sees the analogy with the quantum operator ( [ eq : gp - ssop ] ) , where both conserve energy to order @xmath88 .",
    "the effect of the classical operator ( [ eq : class - ssop ] ) in the simulations is to update the particle positions and velocities in three steps @xmath89 by analogy with ( [ extrap ] ) , @xmath90 should be the midpoint value of the potential , @xmath91 , when it is time - dependent . in our simulations , @xmath90 is the effective potential @xmath92 felt by the thermal atoms , where @xmath93 is the total density",
    ".      the effective potential @xmath48 is determined self - consistently as the system evolves in time , and includes the condensate mean field @xmath94 and the mean field generated by the thermal cloud @xmath95 .",
    "the latter is in general much weaker than the condensate mean field due to the larger spatial extent ( and therefore lower density ) of the thermal cloud .",
    "nevertheless , it is important to include this term in order to ensure the conservation of the total energy of the system .",
    "in addition , from the perspective of the condensate , the noncondensate mean field is necessary in order to account for the temperature - dependent damping and frequency shifts of condensate collective modes .",
    "although the calculation of the condensate mean field is straightforward , the use of discrete particles with a contact interatomic potential creates a problem in determining the noncondensate mean field . taken literally , the mean field consists of a series of delta peaks @xmath96 this expression clearly can not be used as it is to generate the forces acting on the test particles that are required in the md simulation .",
    "rather , the density @xmath97 must be replaced by a smooth and differentiable thermal cloud density and some smoothening operation is therefore needed .",
    "a possible first step might be to divide space into cells and to determine the mean density within each cell by binning the test particles appropriately .",
    "however , this binning procedure generates spatial discontinuities on the scale of the 3d grid being used that would still have to be smoothed out in some way .",
    "in addition , temporal discontinuities arise as particles migrate from one cell to another .",
    "these temporal fluctuations are of course spurious since they depend on the number of test particles and decrease in relative amplitude as this number is increased .",
    "it is apparent that the binned density has some undesirable properties associated with the statistical fluctuations in the number and positions of particles in each cell .    as an alternative to this binning procedure",
    ", we generate a smooth thermal cloud density by performing a convolution with a sampling ( or smoothening ) function @xmath98 which is normalized to unity .",
    "in particular , we define @xmath99 where we choose @xmath100 , i.e.  an isotropic gaussian sampling function of width @xmath101 .",
    "since @xmath102 , no force is exerted by a particle on itself and the sum can extend over all particles in the ensemble . ideally , the width of @xmath98 should be small compared to the curvature of the noncondensate density .",
    "if , at the same time , the number of particles contributing to the sum at a given position @xmath64 is large , it is clear that the sampled potential will be relatively smooth .",
    "note that the smoothening operation is equivalent to assuming a finite - ranged interatomic potential .",
    "the sampled potential ( or its gradient ) is needed at the position of each test particle and at the mesh points on which the condensate wavefunction is defined .",
    "however a direct summation for all points would be prohibitive .",
    "we therefore proceed by making use of a fft .",
    "first , each particle in the ensemble is assigned to points on the 3d cartesian grid using a cloud - in - cell method @xcite .",
    "this is most readily explained in 1d : consider a particle at position @xmath103 , between two grid points at @xmath104 and @xmath105 .",
    "the particle is assigned to both points with weightings @xmath106 and @xmath107 respectively , where @xmath108 .",
    "this can be viewed as a more sophisticated binning procedure in that it takes into account the actual positions of particles within the cells .",
    "the generalization to 3d is straightforward , where in this case the particle is assigned to the eight points which define the unit cell containing the particle .",
    "we then convolve the cloud - in - cell density with the sampling function by fourier transforming it and then multiplying it by the analytic ft of the sampling function .",
    "an inverse fft then generates the sampled potential on the 3d grid .",
    "this potential is used directly in the gp evolution , while the forces on the test particles are obtained by taking a numerical derivative and interpolating to the positions of the particles .",
    "this overall scheme is illustrated in fig .",
    "[ fig : density ] .",
    "the solid line shows the equilibrium thermal cloud density along a line through the center of an isotropic trap with trapping frequency @xmath109 , a system we study in more detail later .",
    "the trap contains a total of @xmath110 @xmath111rb atoms , and at a temperature of @xmath112 there are @xmath113 thermal atoms .",
    "the rapidly fluctuating dashed line is the density along this line produced by the cloud - in - cell method using a thermal distribution of @xmath114 test particles , that is , ten times the actual number of thermal atoms .",
    "the effect of statistical fluctuations is clearly evident . finally , the smooth dashed line is the result of the convolution using a width parameter of @xmath115 , where @xmath116 is the harmonic oscillator length for the trap being considered .",
    "( for comparison , the mesh size is @xmath117 . )",
    "it should be noted that the dramatic smoothening of the density achieved is partly a consequence of performing a full 3d convolution ; a 1d convolution of the cloud - in - cell density with the same width parameter would not reduce the amplitude of the spatial fluctuations to the same degree .",
    "finally , we compare the convolved density to the actual equilibrium density . apart from differences due to the statistical sampling of test particles",
    ", one can see that the peaks in the thermal cloud density at the edges of the condensate are slightly broader in the convolved density , as would be expected .",
    "however , the differences are minor and do not affect the dynamics of the system significantly . for consistency , the @xmath118 term appearing in @xmath73 is also convolved .",
    "the methods outlined so far allow one to follow the condensate wavefunction and trajectories of the atoms subject to a time - dependent potential , so long as the system is in the collisionless regime .",
    "however in general the collisional terms in the boltzmann equation will be nonzero @xmath119 , @xmath120 .",
    "in other words , during each time step there is a certain probability that a given test particle will collide with another thermal atom or with the condensate .",
    "if the typical collision timescale @xmath1 is such that @xmath121 , one can treat the free particle evolution and collisions separately .",
    "each particle s trajectory is first followed using the methods discussed in the previous section , and the possibility of collisions occurring is then considered at the end of the time step . probabilities for either @xmath30 or @xmath36 collisions are calculated in a way which is consistent with a monte carlo sampling of the collision integrals , as discussed below .",
    "we first give details for the @xmath30 integral ( [ eq : c22 ] ) , which physically corresponds to scattering of two thermal particles into two final thermal states .",
    "hence the process conserves the number of thermal atoms , @xmath122 .",
    "we are interested in the mean collision rate at a point @xmath64 ( as defined in appendix a ) , which is given by @xmath123 for our purposes it is convenient to express the integral in terms of new momentum variables ( @xmath124 , @xmath125 ) and ( @xmath126 , @xmath127 ) : @xmath128 and @xmath129 . @xmath124 and @xmath126 are proportional to the center - of - mass and relative momenta , respectively , of the incoming 1 and 2 particles . by implicity assuming energy and momentum conservation ( @xmath130 , @xmath131 ) one can rewrite ( [ eq:22-rate ] ) in the simplified form @xmath132 where @xmath133 , with @xmath134 a unit vector in a direction specified by the solid angle @xmath135 .",
    "calculation of the rate therefore involves integrals over all possible initial states and all scattering angles @xmath135 . in the equilibrium situation",
    ", this rate defines a local mean collision time @xmath136 according to @xmath137 where @xmath138 is the equilibrium thermal cloud density . as shown in @xcite , @xmath139 below @xmath140",
    "is a strong function of position for a trapped bose gas and is peaked at the edge of the condensate . in the classical ( i.e.  maxwell - boltzmann ) limit",
    ", @xmath141 reduces to @xmath142 , with @xmath143 .    to relate this to collision probabilities for individual atoms in our simulations requires sampling of the integral using a rejection method as discussed in detail in appendix a@xcite . at each time",
    "step atoms are first binned into cells of volume @xmath144 according to their position .",
    "the atoms within each cell are then paired at random , and a probability for a pair @xmath145 to collide in the time step @xmath53 is assigned according to @xmath146 the integral over @xmath135 can be evaluated by averaging over a sample of randomly selected final states which are obtained by choosing uniformly - distributed random values for the scattering variables @xmath147 and @xmath148 .",
    "however , in simulating the collision process , the velocities of the incoming particles must actually change to a specific , but random , pair of final velocities .",
    "these velocities lie on a sphere centered at @xmath149 with a radius @xmath150 and can be chosen by randomly selecting the scattering angle @xmath151 .",
    "the appropriate collision probability for this event is then @xmath152 this probability depends upon the phase space densities of the final states , @xmath153 , @xmath154 , reflecting bose statistics .",
    "if this single scattering probability is averaged over a random distribution of scattering angles @xmath151 we recover the average probability defined in ( [ avgprob ] ) .",
    "the simulation of @xmath30 collisions thus proceeds as follows .",
    "a pair of test particles @xmath145 in a given cell is chosen at random . whether a collision of this pair occurs is then tested by comparing @xmath155 to a random number @xmath156 uniformly distributed between 0 and 1 . if @xmath157 the collision is accepted , and the velocities of the test particles are updated accordingly . if @xmath158 , no collision occurs and the velocities of the colliding pair are unchanged . in either case , another pair is randomly selected and the procedure is repeated for all pairs in each cell of the sample .",
    "the @xmath36 collisions are treated in a similar manner to @xmath30 .",
    "the key difference here is that one of the collision partners is a condensate atom in a definite state , and it is necessary to distinguish the collisional processes which either transfer an atom into or out of the condensate .",
    "for example , the `` out '' collision rate as defined in ( [ agamout ] ) is given by @xmath159 this represents scattering of a thermal atom from the condensate to produce two thermal atoms .",
    "the reverse process gives the `` in '' collision rate defined in ( [ agamin ] ) : @xmath160 in obtaining ( [ eq:12in - rate ] ) we have interchanged the 2 and 3 labels in order to define an integral having the same @xmath161 weighting factor as in ( [ eq:12out - rate ] ) .",
    "these two integrals give the true  in \" and  out \" collision rates . however in the simulations , it is useful to drop the cubic terms @xmath162 which formally cancel exactly between the  in \" and  out \" rates .",
    "since these two rates are evaluated differently as explained below , this cancellation will not be numerically precise , and it is therefore preferable to eliminate the cubic terms from the calculation of collision probabilities . in the following ,",
    "we denote the rates with the cubic terms removed by @xmath163 .",
    "dropping these terms of course does not change the _ net _ rate of transfer from the condensate to the thermal cloud that actually takes place .",
    "the `` out '' term can be reduced by transforming the momentum variables as before , with the result @xmath164 where @xmath165 is the relative velocity of the initial states , corrected to account for energy conservation ( locally , the mean field energy of a thermal atom is higher than that of a condensate atom by an amount @xmath166 ) .",
    "now , if we consider each atom in the distribution @xmath161 in turn , the probability for collision with the condensate is given by @xmath167 in this case , the final thermal atom velocities @xmath168 , @xmath169 lie on a sphere of radius @xmath170 centered on @xmath171 , with a random scattering angle @xmath151 .    `` in '' collisions involve scattering of two thermal atoms to produce a condensate and a thermal atom .",
    "in the context of ( [ eq:12in - rate ] ) , the incoming atoms are labelled 2 and 4 , and the outgoing thermal atom is labelled 3 .",
    "energy - momentum conservation in ( [ eq:12in - rate ] ) dictates the condition @xmath172 .",
    "thus , unlike the case of @xmath30 collisions , one can not arbitrarily select a pair of 2 and 4 atoms from the sample since this condition will in general be violated and the collision can not occur .",
    "to proceed , we perform the integrations involving the delta functions in ( [ eq:12in - rate ] ) to obtain @xmath173 where @xmath174 is the velocity of thermal atom 2 relative to the local condensate velocity .",
    "the second integral is a two - dimensional integral over a velocity vector @xmath175 which is in a plane normal to @xmath176 .",
    "the velocity of the other incoming thermal atom , particle 4 , is given by @xmath177 while the velocity of the outgoing thermal atom is @xmath178    in the simulation one considers each thermal atom in the distribution @xmath161 in turn , then randomly selects two numbers that define the vector @xmath179 within a plane of area @xmath180 .",
    "the collision probability is then given by @xmath181 note that the area @xmath180 appears in this expression , which at first sight is disconcerting since it is an arbitrary number entering as a simulation parameter .",
    "however , we find that the total rate is largely independent of this area so long as the plane completely samples the occupied regions of phase space .",
    "we show results confirming this statement in the following section .",
    "this analysis yields probabilities for a particular atom to undergo  out \" or `` in '' collisions . to decide whether either event takes place ,",
    "another random number @xmath182 is chosen .",
    "if @xmath183 then an `` out '' collision is accepted ; the incoming thermal atom is removed from the ensemble of test particles and two new thermal atoms are created . on the other hand , if @xmath184 , then an `` in '' collision takes place and atom 2 is removed from the thermal sample .",
    "in addition , a second test particle , atom 4 , is removed and a new thermal atom , atom 3 , is created . in practice , it is exceedingly unlikely that a test particle will exist that will precisely match the required phase - space coordinates of particle 4 .",
    "we therefore search for a test particle in neighboring phase - space cells and remove this particle if one is found .",
    "this can be justified by remembering that we are only interested in describing the evolution in phase space in a statistical way  it is misleading to think of a direct correspondence between the test particles and physical atoms .",
    "if no test particle exists in the vicinity of @xmath169 , the local phase - space density @xmath185 , and hence @xmath186 , will be zero and the  in \" collision is precluded from occuring in any case .",
    "the above procedure leads to a change in the number of atoms in the thermal cloud . in order to conserve the total particle number the gp equation ( [ eq : gp - gen ] ) is propagated with the @xmath187-term which changes the normalization of the wavefunction and hence the condensate number",
    "this quantity can be evaluated from the monte carlo process decribed above by summing probabilities for particles around each grid point @xmath188 using ( [ eq : rterm ] ) , i.e. , @xmath189 in practice this assignment to grid points is performed with a cloud - in - cell approach similar to the one described earlier .",
    "of course the normalization of the condensate wavefunction varies continuously as opposed to the variation of the thermal atom number which changes by discrete jumps .",
    "nevertheless , one can show that the subsequent change in the condensate normalization is consistent with the addition or removal of atoms from the thermal cloud , so that the total particle number , @xmath190 , is conserved within statistical fluctuations ( @xmath191 ) .",
    "so far we have described various aspects of the numerical scheme .",
    "the aim of this subsection is to tie these disparate elements together with an overview of the simulation procedure as a whole .",
    "one of the main applications of our approach is to the study of small amplitude collective oscillations around the equilibrium state .",
    "the first requirement of such a calculation is therefore the self - consistent determination of the equilibrium thermal cloud distribution and condensate wavefunction .",
    "since the thermal excitations are treated semiclassically , the thermal cloud is described by the equilibrium bose distribution @xmath192 where @xmath193 \\}$ ] is the local fugacity and @xmath194 .",
    "it is straightforward to show that both the @xmath36 and @xmath36 collision integrals vanish in this case .",
    "the noncondensate density profile can be evaluated from ( [ eq : normdens ] ) and ( [ eq : bose - dist ] ) to yield @xmath195 where @xmath196 is the thermal de broglie wavelength .",
    "the equilibrium condensate wavefunction is obtained as the stationary solution of ( [ eq : gp - gen ] ) , with @xmath197 , and the corresponding eigenvalue defines the equilibrium chemical potential @xmath40 . since the condensate and thermal cloud are coupled by mean fields , the two components have to be determined self - consistently using an iterative procedure .",
    "details of this have been given by several authors ( see e.g.  @xcite or @xcite ) and will not be repeated here .    to represent the thermal cloud in the simulations , an ensemble of test particles must be defined . in the case of an equilibrium situation , this ensemble should have a phase - space distribution which is consistent with the bose equilibrium distribution in ( [ eq : bose - dist ] ) .",
    "this can be achieved using the following rejection algorithm @xcite .",
    "first , we distribute particles in position space according to the density @xmath198 . to do this ,",
    "we select three random numbers uniformly distributed between @xmath199 and @xmath200 , defining cartesian coordinates , @xmath201 , of a particle in the occupied region of position space .",
    "a further uniform deviate is then chosen from @xmath202 $ ] , where @xmath203 , and compared to the density at that point @xmath204 . if @xmath205 , the particle is discarded and another set of position coordinates selected . otherwise , if @xmath206 , the particle is accepted and one proceeds to specify its momentum by choosing another random number @xmath207 $ ] . a random number @xmath208 $ ] ( where @xmath209 $ ] , with @xmath210 the local fugacity ) is compared to @xmath211 to decide whether the momentum is accepted or rejected . in the case of rejection",
    "another @xmath212 is chosen , while if accepted two random angles are selected @xmath213 $ ] , @xmath214 $ ] , which in turn define the momentum vector @xmath215 .",
    "this procedure is repeated until @xmath77 test particles in the ensemble are accumulated .",
    "note that we have exploited the spherical symmetry of the equilibrium distribution in momentum space . in principle",
    ", a similar method can be applied to position space if the trap is spherically or cylindrically symmetric .",
    "a dynamical simulation can be initiated in one of two ways .",
    "either an appropriate nonequilibrium initial state is specified , or the system is dynamically excited with the application of an external perturbation .",
    "the latter parallels the procedure used experimentally to study small amplitude collective excitations , and usually amounts to some parametric manipulation of the trapping potential .",
    "although this might be the preferred approach , it is not always the most appropriate , especially when the excitation phase requires a prohibitively long simulation time .",
    "it is then more convenient to impose the perturbation on the initial state itself .",
    "here we are guided by the nature and symmetry of the collective mode being studied , as well as information gleaned from earlier calculations such as those based on the thomas - fermi approximation .",
    "for example , the nature of the density fluctuation or velocity field associated with the mode might be known and it is then advantageous to use this information in defining the initial state .",
    "a good example of this is the breathing , or monopole , mode in an isotropic trap . in this case",
    "the tf mode has a velocity field @xmath216 . to impose this velocity on the condensate one",
    "can simply multiply the ground state wavefunction by a phase factor @xmath217 . in the case of the thermal cloud",
    ", the same velocity field can be imposed by adding @xmath218 to the velocity of the @xmath219-th particle in the equilibrium ensemble .",
    "this procedure will predominantly excite the lowest monopole oscillation .",
    "although higher lying modes might also be mixed in to some extent , they have different frequencies and can usually be separated from the dominant mode when analyzing the dynamics .",
    "returning to the simulation procedure itself , the condensate wavefunction and thermal atom phase - space coordinates are updated in each time step @xmath53 according to the prescription detailed in sec .",
    "[ sec : part - ev ] .",
    "then , before treating collisions the thermal atoms are assigned to cells in position space .",
    "these are used for selecting pairs for @xmath30 collisions , as well as being further subdivided into momentum space elements in order to estimate the phase space density @xmath220 for calculating collision probabilities .",
    "since collisions are treated one cell at a time , the phase space density only needs to be calculated and stored for one particular cell .",
    "the @xmath36 and @xmath30 collisions are then treated using the monte carlo scheme described earlier and the momenta and number of thermal atoms ( test particles ) are updated .",
    "repeating for all of the cells yields the quantity @xmath187 from ( [ eq : r - calc ] ) which , when used in the gp propagation ( sec .",
    "[ sec : gp - eq ] ) , continuously evolves the number of atoms in the condensate . for numerical accuracy",
    "the positional cells should enclose regions of almost constant thermal density and fugacity , and are most conveniently treated using a spatial grid which reflects the ( elliptical ) geometry of the cloud .",
    "the momentum elements in contrast lie on a cartesian grid , where a cloud - in - cell method allows one to minimize statistical fluctuations while retaining a fine grid for precision .",
    "our first calculations are not simulations as such , but are instead checks of the monte carlo sampling technique we use to evaluate the @xmath36 and @xmath30 collision rates in real time . the physical situation we consider corresponds to the one discussed at the end of sec .",
    "[ sec : potential ] , namely @xmath221 @xmath111rb atoms at 250 nk in an isotropic trap .",
    "the equilibrium @xmath30 collision rate @xmath222 can be evaluated numerically directly from the expression in ( [ gamma22_out ] ) using the equilibrium distribution function ( [ eq : bose - dist ] ) .",
    "the result as a function of the radial coordinate @xmath223 is shown as the solid line in fig .  2 .",
    "the equilibrium @xmath36 collision rates can also be calculated using the equilibrium distribution ( [ eq : bose - dist ] ) and equilibrium condensate density @xmath224 in ( [ eq:12out - rate ] ) or ( [ eq:12in - rate ] ) . the  in \" and",
    "`` out '' rates are in fact equal to each other in equilibrium and will be denoted @xmath225 ( recall that these rates are calculated ignoring the cubic terms in the full expression ) .",
    "the result of the calculation as a function of @xmath223 is shown as the solid line in fig .",
    "one sees that both the @xmath36 and @xmath30 collision rates exhibit a maximum near to the condensate surface , where the fugacity @xmath226 approaches unity and the equilibrium bose distribution is strongly peaked at @xmath227 .",
    "however , in the case of @xmath30 collisions , the tail of the distribution decays more slowly since the thermal cloud density extends out to larger radii than the condensate .",
    "the monte carlo calculation of these rates involves a dynamical simulation of a sample of test particles moving in the equilibrium effective potential .",
    "the collisionless evolution of the particles in time provides an ergodic sampling of phase space . at each time step @xmath53 in the evolution ,",
    "the collision probabilities in ( [ eq:22-prob ] ) , ( [ eq : out - prob ] ) and ( [ eq : in - prob ] ) are calculated and summed to obtain a realization of the collision rates at a particular instant of time @xmath228 .",
    "for example , for @xmath30 collisions we have @xmath229 where the sum extends over all pairs of test particles in the cell of volume @xmath230 . by repeating this calculation over @xmath231 time steps and performing the average @xmath232",
    "we obtain the monte carlo estimate of the collision rate .",
    "the same procedure is used for the @xmath36  in \" and  out \" rates . to obtain histograms of the collision rate as a function of the radial position @xmath223",
    ", we bin the individual collision probabilities according to the positions of the colliding pair . the monte carlo results presented in figs .",
    "[ fig : eqm - c22 ] and [ fig : eqm - c12 ] were obtained with only @xmath233 time steps of size @xmath234 , which was already sufficient to give good statistics .",
    "a comparison with the direct numerical calculations shows very good agreement , the main error arising from estimating @xmath24 in real - time by binning particles into phase - space cells .",
    "this was confirmed by repeating the simulation but calculating the collision probabilities using the actual equilibrium bose distribution ( [ eq : bose - dist ] ) rather than the binned approximation to it .",
    "one can try to improve the binned distribution but there is a trade - off between using smaller phase - space cells which would provide a more accurate representation of the distribution , and larger cells which contain more particles and thus improve statistics .",
    "our choice of cell size tries to optimize these opposing requirements .",
    "the main observation to be made about fig .",
    "3 is that the  in \" and `` out '' @xmath36 rates are very similar , despite the very different appearance of the probabilities in ( [ eq : out - prob ] ) and ( [ eq : in - prob ] ) . note in particular that these results confirm that the  in \" rate is independent of the arbitrary area @xmath235 in ( [ eq : in - prob ] ) .",
    "it is of course important to minimize the difference between these two rates since any imbalance implies a net transfer of atoms between the condensate and thermal cloud which should not occur in equilibrium . on the other hand ,",
    "a calculated imbalance partly reflects the fact that the equilibrium state we start with is not the  numerical \" equilibirium state that is consistent with the various numerical approximations being made .",
    "in fact , we find that when a full simulation is carried out , the system relaxes to a new , slightly different equilibrium .",
    "in other words , the system automatically adjusts to compensate for the numerical approximations .",
    "nevertheless , it is desirable to avoid an imbalance to whatever extent possible . taking the collision rate histograms in fig .  3 and integrating over @xmath223 , we find a discrepancy between the total  in \" and  out \" rates of about 1% .",
    "this imbalance can be minimized by judicious choice of the shape of the phase space elements ( see sec .  [",
    "sec : overv ] ) and simulation of a larger sample of test particles , but a residual imbalance is unavoidable . since the quantities we are interested in , such as frequencies and damping rates , are weak functions of the number of condensate atoms ,",
    "a small residual drift in the condensate number will not affect our results significantly .",
    "this section presents the main results of the paper , where we simulate the monopole `` breathing '' mode in an isotropic trap .",
    "these calculations are not motivated by experiment which have yet to be performed in this geometry .",
    "rather , we are mainly interested in comparing our results to previous theoretical approaches for @xmath36 and landau damping which have relied on spherical symmetry .",
    "it should be emphasized that our calculations do not face this restriction , though the simple geometry does allow us to more readily observe and quantify effects ensuing from @xmath30 and @xmath36 collisions between atoms .",
    "in fact , as reported elsewhere @xcite , our methods have already been applied successfully to other experiments in anisotropic traps , most notably to the study of scissors modes in which a full 3d simulation is necessary .      as an important test of our treatment of @xmath36 collisions",
    ", we evaluate the damping of the monopole condensate mode within the so - called static thermal cloud approximation discussed by williams and griffin ( wg ) @xcite . in this approximation , one considers the dynamics of the condensate in the presence of a static equilibrium distribution of thermal atoms . due to the condensate oscillation",
    ", the condensate is no longer in local equilibrium with the noncondensate and as a result , @xmath36 collisions play a role in damping the mode .",
    "this effect enters through the @xmath187 term in the generalized gp equation ( [ eq : gp - gen ] ) .",
    "it should be emphasized that @xmath187 is provided by the theory and the relaxation it gives rise to is not introduced in a phenomenological way as is sometimes done @xcite .",
    "linearization of the gp equation leads to generalized bogoliubov equations which can be solved to determine collective mode frequencies and damping rates .",
    "the latter are of particular interest since they are directly related to the transfer of atoms between the condensate and thermal cloud as a result of @xmath36 collisions .",
    "the results obtained @xcite are in fact close to those found in the tf approximation which gives the damping rate @xcite @xmath236 where @xmath237 is the density fluctuation associated with the mode @xmath238 and @xmath239 .",
    "one sees that the damping in the tf approximation is given by a weighted average of the equilibrium @xmath36 collision rate .",
    "our simulation of the static thermal cloud approximation involves the propagation of the condensate wavefunction according to ( [ eq : gp - gen ] ) but with a stationary noncondensate mean field , @xmath240 . at the same time , the thermal atoms evolve in an effective potential defined by the condensate and noncondensate equilibrium densities .",
    "although the thermal atoms are not allowed to undergo collisions , their dynamical evolution allows one to perform a monte carlo sampling of phase space in order to generate the @xmath36 collision probabilities at each time step .",
    "these probabilites are then used to calculate the imaginary term , @xmath22 , in the gp equation according to ( [ eq : r - calc ] ) .",
    "these simulations can be compared directly with the calculations by wg @xcite and therefore provide a direct test of our simulation methods , in particular , the calculation of @xmath36 collision probabilities .",
    "it is important to quantify the errors that arise since they will also enter into our full simulations in which the effects of mean fields and collisions on the thermal cloud are included completely .",
    "the monopole mode is excited by initially scaling the equilibrium condensate wavefunction , @xmath241 , where the scale parameter @xmath107 is 0.95 .",
    "this dilation of the wavefunction is an alternative to imposing an initial velocity field as discussed in sec .",
    "[ sec : overv ] .",
    "the widths of the condensate wavefunction in the @xmath103 , @xmath242 , and @xmath226 directions are defined by mean - squared deviations , e.g. @xmath243 , where the moments are given by @xmath244 .",
    "plots of these widths show a damped oscillation , and to quantify the frequency @xmath245 and damping rate @xmath246 , we fit the data to an exponentially decaying sinusoid . since each direction gives slightly different values due to statistical fluctuations , we average over the three to obtain values for @xmath245 and @xmath246 .",
    "our numerical results are plotted with those of ref .",
    "@xcite in fig .",
    "[ fig : static ] .",
    "we find excellent agreement between the two approaches , except for the damping rate at @xmath247 which is somewhat lower than the wg result .",
    "this discrepancy arises through errors in estimating the phase - space density in the condensate surface region where the fugacity approaches unity and the distribution function @xmath248 is sharply peaked in momentum space around @xmath227 .",
    "the @xmath36 collision rate in this region is similarly enhanced , especially at higher temperatures .",
    "our binning procedure is of insufficient accuracy to fully capture this peak , and since the surface region is the major contributor to the @xmath36 damping , this then leads to an underestimate of the rate .",
    "we illustrate this point in fig .",
    "[ fig : static ] by plotting the result ( open circle ) of a simulation at @xmath249 nk which uses the analytical expression for @xmath250 in ( [ eq : bose - dist ] ) , as opposed to the binned phase - space density .",
    "we now find much better agreement with the wg damping result .",
    "the generally good agreement with wg for the frequency and damping rate confirms that collision rates can be reliably calculated using our monte carlo sampling methods .",
    "although the binning procedure introduces some minor errors into our simulations within the static thermal cloud approximation , we expect them to be even less important when the full dynamics of the thermal cloud is included .",
    "due to mean - field interactions with the condensate , the thermal cloud will be strongly perturbed in the surface region and the distribution in phase space will tend to be  smeared out \" , making the binning procedure more reliable .",
    "@xmath30 collisions compete against this effect by rethermalizing the particles to a bose distribution ; however , this can only make a significant difference if the collisional timescale is short compared to that of the oscillation .",
    "for the present calculations , we have @xmath251 and the gas is in the collisionless regime .",
    "we would therefore expect the thermal cloud dynamics to be very important in determining the damping due to @xmath36 collisions .    to illustrate this we have performed full simulations including mean - field interactions and collisions at @xmath252 nk and 30 nk .",
    "the results obtained with only @xmath30 collisions included are shown by open squares , while the results including @xmath36 collisions as well are shown by the full squares .",
    "one sees that the overall damping rate increases by only 5 - 10% when @xmath36 collisions are added in .",
    "in fact , collisions of either kind contribute little to the damping which is dominated by landau damping ( as discussed in the following subsection ) .",
    "furthermore , we find a small downward shift in the frequency compared to the zero temperature value , in contrast to the significant increase seen within the static approximation .",
    "this increase is due to the fact that the condensate is oscillating in the presence of the static mean field of the equilibrium thermal cloud which effectively enhances the oscillator frequency of the trap .",
    "this effect is eliminated when the thermal cloud is allowed to respond to the dynamic mean field of the condensate .",
    "as we shall further demonstrate in the following subsection , dynamic mean - field effects typically dominate the finite temperature behavior , with collisions playing a secondary but important supporting role in equilibrating the system .",
    "as regards the status of the static thermal cloud approximation , we conclude that it provides a useful method for qualitatively determining the effects of @xmath36 collisions on collective modes .",
    "however , its quantitative predictions for mode frequencies and damping rates are unreliable .      as our final example",
    ", we have performed simulations for the system studied by guilleumas and pitaevskii @xcite , namely @xmath253 atoms confined in an isotropic trap of frequency @xmath254 . to begin",
    ", we consider a total of @xmath255 atoms and excite the monopole mode by an initial scaling of the condensate radius by a factor of @xmath256 , with the thermal cloud initially in its equilibrium state .",
    "the condensate width oscillations are then followed over a time scale of @xmath257 . fig .",
    "[ fig : monopole ] shows damping rates and frequencies as a function of temperature found by fitting an exponentially decaying sinusoid to the time - dependent width . at each temperature",
    "three simulations are performed .",
    "the first involves free propagation of thermal test particles without collisions , corresponding to solving the collisionless boltzmann equation .",
    "the second includes @xmath30 collisions between thermal atoms , while the third includes both @xmath30 and @xmath36 collisions . at low temperatures ,",
    "all three simulations give similar results , reflecting the fact that the number of thermal atoms is small and collisions play a minor role .",
    "with increasing temperature , the differences between the simulations increase .",
    "qualitatively , the behaviour is similar to what was found previously for the scissors mode @xcite ; collisions have the effect of shifting the frequency downward as compared to the collisionless result , and significantly enhance the damping rate .",
    "the effect of @xmath30 collisions is particularly strong at high temperatures , which at first sight may seem surprising since @xmath30 collisions do not couple to the condensate directly .    to gain more insight into the collisional dependence of the damping , we focus on the time - dependent evolution for a particular temperature , @xmath258 ( @xmath259 , where @xmath260 @xcite is the transition temperature of the corresponding ideal gas in the thermodynamic limit ) . fig .  [",
    "fig : timecurve ] plots @xmath261 _ vs. _",
    "@xmath63 for the collisionless and full ( @xmath36+@xmath30 ) simulations . the initial damping rate in both calculations",
    "is seen to be similar , however at later times the collisionless oscillation departs from a simple exponential decay , and the oscillation amplitude tends to saturate .",
    "this behavior is not seen to the same degree when collisions are included . to quantify this behavior ,",
    "we define a local damping rate by fitting a damped sinusoid to the data within a window of width @xmath262 centered on the time @xmath63 .",
    "[ fig : dampcurve ] plots this local damping rate as a function of @xmath63 .",
    "we see large variations in the damping rate with time , with the largest rate occuring initially .",
    "the deviations from the initial value are largest in the collisionless case , where the damping rate dips nearly to zero .",
    "similar behavior is observed over the whole range of temperatures , and accounts for the lower damping rates obtained by fitting the entire data set .    to explain this behavior",
    ", we note that damping of the condensate oscillation is associated with the transfer of energy from the condensate to the thermal cloud .",
    "if this energy exchange is mediated by mean - field interactions , it is referred to as landau damping . from the point of view of the thermal cloud , the dynamic condensate mean field @xmath263 acts as an external perturbation which can lead to the excitation of thermal atoms . of course , the rate at which these excitations occur depends on the phase - space distribution of the thermal particles . in our simulations ,",
    "the thermal cloud is initially in an equilibrium state and the damping rate is observed to be independent of collisions .",
    "this damping is essentially pure landau damping and its magnitude is determined by the rate at which the oscillating condensate can do work on the equilibrium thermal distribution . in this respect ,",
    "our initial damping rate is analogous to conventional perturbation theory estimates ( as discussed below ) .",
    "as time progresses in our simulations , the thermal cloud begins to deviate from an equilibrium distribution and the magnitude of landau damping is correspondingly affected . evidently , the perturbation of the thermal distribution is such as to reduce the rate of energy transfer to the thermal atoms , whereupon the damping rate decreases with time as seen in fig .",
    "[ fig : dampcurve ] .",
    "the deviation is in fact a nonlinear effect as it was found to depend on the amplitude of the condensate oscillation .",
    "an analogous effect appears in the context of plasma oscillations , where landau damping is due to the energy transfer from the collective plasma wave to single - electron excitations @xcite .    in the absence of collisions",
    ", the distribution of thermal atoms continues to evolve in a complicated way and the effective damping rate exhibits an oscillatory time dependence",
    ". however , as soon as @xmath30 collisions are switched on , the damping rate deviates less strongly from its initial value .",
    "the effect of these collisions is to drive the thermal cloud towards a state of local equilibrium and the damping rate tends to maintain its original value .",
    "the inclusion of @xmath36 collisions has a similar effect and we find a damping rate which is almost time - independent when both collision processes are retained .",
    "however , @xmath36 collisions do more than simply equilibrate the thermal cloud since they also lead to the source term @xmath22 in the gp equation . as we have already discussed , this term gives rise to its own contribution to damping which is quite separate from landau damping .",
    "it should be emphasized that it is impossible to separate the total damping rate into individual components .",
    "mean - field and collisional effects are interrelated , and all must be included to completely account for the actual damping rates .",
    "we next turn to a comparison of our results with those of guilleumas and pitaevskii @xcite . since we have used quite different methods to calculate damping rates , it is useful to first discuss the perturbation theory calculation of landau damping used by these authors @xcite . within this approach ,",
    "landau damping is associated with the decay of a mode of oscillation ( with energy @xmath264 ) as a result of the excitation of a thermal quaisparticle from an initial state of energy @xmath265 to a final state of energy @xmath266 .",
    "the damping rate is then given by fermi s golden rule @xcite @xmath267   \\delta ( e_k - e_i - \\hbar \\omega_{\\rm osc } ) , \\label{eq : perturb}\\ ] ] where the sum is over all excitations that satisfy energy conservation , while the matrix element @xmath268 depends upon the form of the excitations .",
    "the thermal states are occupied according to the equilibrium bose distribution @xmath269 .",
    "this damping rate is therefore analogous to the _ initial _ damping rate we obtain in simulations which start with an equilibrium thermal distribution .",
    "guilleumas and pitaevskii @xcite evaluate ( [ eq : perturb ] ) as a function of temperature using bogoliubov excitations of the condensate as the thermal quasiparticles .",
    "these are determined from the bogoliubov equations for a fixed number of condensate atoms , @xmath270 ; the corresponding number of thermal atoms is then a function of temperature and is given by summing over the thermal occupation @xmath271 of the quasiparticle states . to actually evaluate the landau damping rate at the frequency of the monopole mode of interest ,",
    "the delta functions in ( [ eq : perturb ] ) are replaced by lorentzians of width @xmath272 .",
    "they show that the results obtained are essentially independent of this parameter .    to compare with these results we performed collisionless simulations and extracted the initial damping rate as discussed earlier .",
    "the comparison is made in fig .",
    "[ fig : gupi ] where results are presented as a function of temperature for @xmath273 and @xmath274 . given the completely different methods of calculation , the agreement is remarkable .",
    "the agreement persists even down to low temperatures where one might expect differences to appear as a result of our use of semiclassical hf excitations as opposed to the bogoliubov excitation spectrum .",
    "the fact that the agreement is as good as it is is perhaps understandable in view of the observation in ref.@xcite that the density of states in the hf and bogoliubov approximations are very similar .",
    "although the semiclassical hf approximation was not discussed , we would of course expect it to be close to the quantal hf result .",
    "since the density of thermal excitations is an important ingredient in the calculation of landau damping , we can begin to see why our semiclassical calculations give very similar results .",
    "in this paper we have provided a detailed description of the numerical scheme we have used to simulate trapped bose - condensed gases at finite temperatures , based on the zgn formalism which treats the thermal excitations semiclassically within a hartree - fock - popov approximation .",
    "the procedure involves solving simultaneously a generalized gross - pitaevskii equation for the condensate and a boltzmann kinetic equation for the thermal cloud .",
    "the two equations are coupled by mean fields and collisions , both of which influence the dynamics of the two components in significant ways .",
    "our scheme has been carefully tested to ensure that it provides an accurate description of the system dynamics .",
    "in particular , we have shown that @xmath5-body simulations , together with the monte carlo sampling of collisions , is an effective and reliable method for determining the thermal cloud dynamics .",
    "our scheme can be used to model the dynamics of the gas over a wide range of temperatures and physical conditions . as an example",
    ", we have studied the monopole `` breathing '' mode in a spherical trap .",
    "two sets of calculations were performed .",
    "the first provided a check of the treatment of collisions within the static thermal cloud approximation of williams and griffin @xcite .",
    "results within this approximation were reproduced , but full dynamical simulations indicated that the approximation is primarily useful as a qualitative indicator of the effect of @xmath36 collisions . unfortunately , its quantitative predictions for mode frequencies and damping rates can not be trusted .",
    "our second set of simulations focussed on landau damping .",
    "this is typically the dominant damping process for condensate modes at finite temperatures .",
    "however , the damping observed in a simulation , and by extension in real experimental situations , is determined by a delicate interplay of the mean - field excitation of the thermal cloud and collisions .",
    "the thermalizing effect of the latter strongly influences the rate at which mean - field excitations take place .",
    "we also compared our results for landau damping to those of guilleumas and pitaevskii @xcite , and very good agreement was found .",
    "this confirms that the semiclassical hf description of the thermal cloud reproduces the landau damping as calculated using bogoliubov excitations .",
    "this is not too surprising since the density of excitations in the two approximations is very similar .",
    "however , as we have already explained , the landau damping as determined by assuming the thermal cloud to be in an equilibrium state is not necessarily the damping that will be observed in an experiment .",
    "a consistent treatment of the dynamics of the condensate _ and _ thermal cloud is needed in order to make detailed comparisons with experiment .",
    "applications of our technique to other collective modes have also been made and are discussed elsewhere @xcite .",
    "our results for the temperature - dependent damping and frequency shifts are in good agreement with experiment for both quadrupole @xcite and scissors @xcite modes .",
    "this in itself confirms the accuracy of our theoretical formulation of the system dynamics and the numerical methods used .",
    "it is hoped , however , that the present paper provides more insight into the content of the theory and the reasons for its success .",
    "interesting future systems for study could include topological defects ( e.g.  vortices and skyrmions ) , optical lattices , and dynamical instabilities of surface modes in the presence of a rotating thermal cloud @xcite .",
    "we conclude with a few comments about where we may go next",
    ". it would be useful to incorporate bogoliubov excitations in the kinetic theory in place of hf excitations @xcite .",
    "although this does not seem to be important for landau damping , the hf approximation may not be good for certain situations where the thermal occupation of the lowest modes are significant ( e.g. , for large atom numbers or at low temperatures ) .",
    "another possibility is to implement a hybrid scheme , where highly - occupied , low - lying modes are treated using classical field methods @xcite , while the rest are treated semiclassically using the present technique . finally , it would be of interest to investigate the importance of going beyond the popov approximation by including the anomalous average , @xmath275 . in doing",
    "so one must be careful to ensure that the new model is gapless @xcite .",
    "this may involve renormalization of the coupling constant @xmath276 @xcite or replacing the contact potential by a generalized pseudopotential @xcite .",
    "we thank j. williams for providing the data in fig .  [",
    "fig : static ] .",
    "we would also like to acknowledge useful discussions with a. griffin , t. nikuni and j. williams .",
    "financial support was provided by nserc of canada .",
    "our purpose here is to show how a monte carlo evaluation of the collision rate in ( [ gamma22_out ] ) leads to a definition of collision probabilities to be used in the simulations .",
    "we first note that @xmath277 represents the number of atoms leaving the phase space volume element @xmath278 per unit time as a result of collisions .",
    "integrating this over momenta gives the number of atoms in @xmath279 suffering a collision per unit time .",
    "thus the mean collision rate per atom and per unit volume is @xmath280 which is the quantity displayed in ( [ eq:22-rate ] ) .",
    "we now write the required local collision rate as @xmath281 where @xmath282 is a point in 6-dimensional momentum space and the factor @xmath283 is considered as a weight function .",
    "we denote the maximum value of @xmath284 by @xmath285 and define the domain on which the integrand is nonzero by @xmath286 $ ] for each momentum component .",
    "choosing a point @xmath212 at random in the hypervolume @xmath287 , and a random number @xmath288 uniformly distributed on @xmath289 $ ] , the point @xmath212 is accepted if @xmath290 and the quantity @xmath291 is accumulated .",
    "the value of the integral is then given approximately as @xmath292 where @xmath5 is the number of random @xmath212 points chosen and the prime on the summation includes only those points for which @xmath293 . for @xmath294 , the integral is simply @xmath295 .",
    "thus , @xmath296 where @xmath297 is the total number of points accepted , and @xmath298    the sample of @xmath297 points accepted consists of @xmath297 @xmath299-values and @xmath297 @xmath300-values , each of which is distributed according to @xmath301 .",
    "this set of @xmath302 @xmath26-values can be identified with @xmath303 test particles in a cell of volume @xmath144 .",
    "if this set is to be representative of the local density , we must have @xmath304 with this identification , @xmath305 in other words , the collision rate can be estimated by sampling the test particles in the cell @xmath144 _ in pairs_. inserting the explicit form of @xmath276 for the 22 collision rate in ( [ gamma22_out ] ) , we have @xmath306 where the sum is now taken over pairs of test particles .",
    "this expression allows us to define the probability @xmath155 that a pair of atoms @xmath145 in the cell suffers a collision in a time interval @xmath307 : @xmath308 selecting atoms in pairs from each cell and assigning them a collision probability @xmath155 allows us to simulate the effect of collisions in a way which is consistent with the boltzmann collision integral .",
    "note that the factor of 2 in ( [ a8 ] ) accounts for the fact that 2 atoms are affected for each pair collision .",
    "this factor is therefore not included in the definition of the pair collision probability .",
    "we treat @xmath36 collisions somewhat differently .",
    "first , we note that the total rate of change of the number of thermal atoms per unit volume due to these collisions is @xmath309\\nonumber \\\\ & \\equiv & \\gamma_{12}^{\\rm out } - \\gamma_{12}^{\\rm in}\\,.\\end{aligned}\\ ] ] according to this definition , @xmath310 is the rate of decrease of the number of _ condensate _ atoms per unit volume as a result of a collision with a thermal atom ( hence the designation ` out ' ) .",
    "this rate can be estimated by writing @xmath311 where @xmath312 and @xmath313 is the remaining part of the integrand . a monte carlo sampling of the integral leads to the estimate @xmath314 where @xmath297 represents the number of atoms in the cell of volume @xmath230 .",
    "the probability of an atom in the cell suffering this kind of collision in the time interval @xmath53 is therefore @xmath315 which is the origin of the expression given in ( [ eq : out - prob ] ) .    the ` in ' collision rate",
    "is given by @xmath316 ( 1+f_3)\\ , , \\label{agamin}\\end{aligned}\\ ] ] where we have interchanged the particle labels 2 and 3 to obtain the second line in this equation .",
    "this rate corresponds to two thermal atoms scattering into a condensate atom and an outgoing thermal atom , and is thus the rate that atoms feed into the condensate as a result of collisions .",
    "although the collision of atoms 2 and 4 can be treated by the methods used to analyze the @xmath30 collision rate , it is preferable to define a single atom collision rate by writing this integral in the form of ( [ a12 ] ) and performing a monte carlo sampling with respect to the @xmath300 variable .",
    "this procedure leads to the collision probability _ per atom _",
    "@xmath317\\,,\\ ] ] which is simplified and discussed further in the body of the paper .",
    "m. h. anderson , j. r. ensher , m. r. matthews , c. e. wieman , and e. a. cornell , science * 269 * , 198 ( 1995 ) . c. c. bradley , c. a. sackett , j. j. tollett , and r. g. hulet , phys .",
    "* 75 * , 1687 ( 1995 ) .",
    "k. b. davis , m. o. mewes , m. r. andrews , n. j. van druten , d. s. durfee , d. m. kurn , and w. ketterle , phys .",
    "* 75 * , 3969 ( 1995 ) .",
    "f. dalfovo , s. giorgini , l. p. pitaevskii , and s. stringari , rev .",
    "* 71 * , 463 ( 1999 ) .",
    "d. a. w. hutchinson , e. zaremba , and a. griffin , phys .",
    "* 78 * , 1842 ( 1997 ) .",
    "r. j. dodd , m. edwards , c. w. clark , and k. burnett , phys .",
    "a * 57 * , r32 ( 1998 ) .",
    "a. griffin , phys .",
    "b * 53 * , 9341 ( 1996 ) .",
    "d. s. jin , m. r. matthews , j. r. ensher , c. e. wieman , and e. a. cornell , phys .",
    "rev . lett . * 78 * , 764 ( 1997 ) .",
    "d. m. stamper - kurn , h. -j .",
    "miesner , s. inouye , m. r. andrews , and w. ketterle , phys .",
    "lett . * 81 * , 500 ( 1998 ) .",
    "o. m. marag , g. hechenblaikner , e. hodby , and c. j. foot , phys .",
    "lett . * 86 * , 3938 ( 2001 ) . f. chevy , v. bretin , p. rosenbusch , k. w. madison , and j. dalibard , cond - mat/0111455 .",
    "s. a. morgan , j. phys .",
    "b * 33 * , 3847 ( 2000 ) .",
    "m. rusch , s. a. morgan , d. a. w. hutchinson , and k. burnett , phys .",
    "lett . * 85 * , 4844 ( 2000 ) .",
    "s. giorgini , phys . rev .",
    "a * 57 * , 2949 ( 1998 ) .",
    "s. giorgini , phys .",
    "a * 61 * , 063615 ( 2000 ) .",
    "j. reidl , a. csords , r. graham , and p. szpfalusy , phys .",
    "a * 61 * , 043606 ( 2000 ) . c. w. gardiner and p. zoller , phys .",
    "a * 61 * , 033601 ( 2000 ) , and references therein .",
    "h. t. c. stoof , j. low temp .",
    "phys . * 114 * , 11 ( 1999 ) .",
    "r. walser , j. williams , j. cooper , and m. holland , phys .",
    "a * 59 * , 3878 ( 1999 ) .",
    "t. nikuni , e. zaremba , and a. griffin , phys .",
    "* 83 * , 10 ( 1999 ) .",
    "e. zaremba , t. nikuni , and a. griffin , j. low temp . phys . * 116 * , 277 ( 1999 ) .",
    "t. nikuni and a. griffin , phys .",
    "a * 63 * , 033608 ( 2001 ) .",
    "m. j. bijlsma and h. t. c. stoof , phys .",
    "a * 60 * , 3973 ( 1999 ) .",
    "u. al khawaja and h. t. c. stoof , phys .",
    "a * 62 * , 053602 ( 2000 ) .",
    "t. nikuni , phys .",
    "a * 65 * , 033611 ( 2002 ) .",
    "d. guery - odelin and s. stringari , phys .",
    "* 83 * , 4452 ( 1999 ) .",
    "o. m. marag , s. a. hopkins , j. arlt , e. hodby , g. hechenblaikner , and c. j. foot , phys .",
    "lett . * 84 * , 2056 ( 2000 ) .",
    "b. jackson and e. zaremba , phys .",
    "lett . * 88 * , 180402 ( 2002 ) .",
    "b. jackson and e. zaremba , phys .",
    "* 87 * , 100404 ( 2001 ) .",
    "b. jackson and e. zaremba , laser phys .",
    "* 12 * , 93 ( 2002 ) .",
    "l. p. kadanoff and g. baym , _ quantum statistical mechanics _",
    "( addison - wesley , redwood city , 1989 ) .",
    "t. r. taha and m. j. ablowitz , j. comput .",
    "phys . * 55 * , 203 ( 1984 ) . j. m. sanz - serna and m. p. calvo , _ numerical hamiltonian problems _",
    "( chapman & hall , london , 1994 ) . w. h. press , s. a. teukolsky , w. t. vetterling , and b. p. flannery , _ numerical recipes in fortran _",
    "( cambridge university press , cambridge , 1992 ) .",
    "see e.g.  ` http://www.fftw.org ` .",
    "r. w. hockney and j. w. eastwood , _",
    "computer simulations using particles _",
    "( mcgraw - hill , new york , 1981 ) .",
    "h. yoshida , celest .",
    ". astron . * 56 * , 27 ( 1993 ) .",
    "i. prigogine , _ non - equilibrium statistical mechanics _ ( wiley , new york , 1962 )",
    ". h. wu , e. arimondo , and c. j. foot , phys .",
    "a * 56 * , 560 ( 1997 ) .",
    "j. e. williams and a. griffin , phys .",
    "a * 64 * , 013606 ( 2001 ) .",
    "l. p. pitaevskii , sov .",
    "jetp * 35 * 282 ( 1959 ) .",
    "s. choi , s. a. morgan and k. burnett , phys .",
    "rev . a * 57 * , 4057 ( 1998 ) .",
    "j. e. williams and a. griffin , phys .",
    "a * 63 * , 023612 ( 2001 ) .",
    "m. guilleumas and l. p. pitaevskii , phys .",
    "a * 61 * , 013602 ( 2000 ) .",
    "t. h. stix , _ the theory of plasma waves _ ( mcgraw - hill , new york , 1962 ) .",
    "platzman and s. j. buchsbaum , phys .",
    "fluids * 4 * , 1288 ( 1961 ) .",
    "l. p. pitaevskii and s. stringari , phys .",
    "a * 235 * , 398 ( 1997 ) .",
    "l. you , w. hoston , and m. lewenstein , phys .",
    "a * 55 * , r1581 ( 1997 ) .",
    "f. dalfovo , s. giorgini , m. guilleumas , l. pitaevskii , and s. stringari , phys .",
    "a * 56 * , 3840 ( 1997 ) .",
    "j. e. williams , e. zaremba , b. jackson , t. nikuni , and a. griffin , phys .",
    "* 88 * , 070401 ( 2002 ) .",
    "m. imamovi - tomasovi and a. griffin , j. low temp .",
    "* 122 * , 617 ( 2001 ) .",
    "a. sinatra , c. lobo , and y. castin , phys .",
    "* 87 * , 210404 ( 2001 ) ; cond - mat/0201217 .",
    "m. j. davis , s. a. morgan , and k. burnett , phys .",
    "lett . * 87 * , 160402 ( 2001 ) ; cond - mat/0201571 .",
    "d. a. w. hutchinson , r. j. dodd , and k. burnett , phys .",
    "* 81 * , 2198 ( 1998 ) .",
    "m. olshanii and l. pricoupenko , phys .",
    "lett . * 88 * , 010402 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> we consider a model of a dilute bose - einstein condensed gas at finite temperatures , where the condensate coexists in a trap with a cloud of thermal excitations . within the zgn formalism , the dynamics of the condensate is described by a generalized gross - pitaevskii equation , while the thermal cloud is represented by a semiclassical kinetic equation . </S>",
    "<S> our numerical approach simulates the kinetic equation using a cloud of representative test particles , while collisions are treated by means of a monte carlo sampling technique . a full 3d split - operator fast fourier transform method is used to evolve the condensate wavefunction . </S>",
    "<S> we give details regarding the numerical methods used and discuss simulations carried out to test the accuracy of the numerics . </S>",
    "<S> we use this scheme to simulate the monopole mode in a spherical trap . </S>",
    "<S> the dynamical coupling between the condensate and thermal cloud is responsible for frequency shifts and damping of the condensate collective mode . </S>",
    "<S> we compare our results to previous theoretical approaches , not only to confirm the reliability of our numerical scheme , but also to check the validity of approximations which have been used in the past . </S>"
  ]
}