{
  "article_text": [
    "lorentzian lattices , that is , integral symmetric bilinear forms of signature @xmath2 , play a major role in k3 surface theory and the structure theory of hyperbolic kac - moody algebras . in both cases , the lattices which are reflective , meaning that their isometry groups are generated by reflections up to finite index , play a special role . in the km case they provide candidates for root lattices of kma s with hyperbolic weyl groups that are large enough to be interesting . for k3 s",
    "they are important because a k3 surface has finite automorphism group if and only if its picard group is `` 2-reflective '' , meaning that its isometry group is generated up to finite index by reflections in classes with self - intersection @xmath3 ( see @xcite ) .",
    "if the picard group is not 2-reflective but is still reflective , then one can often describe the automorphism group of the surface very explicitly @xcite@xcite@xcite .",
    "the problem of classifying all reflective lattices of given rank , here @xmath4 , is also of interest in its own right from the perspectives of coxeter groups and arithmetic subgroups of @xmath5 .    in this paper",
    "we give the classification of reflective lorentzian lattices of rank  @xmath6 .",
    "there are of them up to scale , but this large number makes the result seem more complicated than it is .",
    "for example , lattices share a single weyl group ( in the table ) .",
    "our work is logically independent of nikulin s monumental paper @xcite , but follows it conceptually .",
    "his work had the same motivations as ours , and solves a problem both more general and more specific .",
    "he considered lorentzian lattices that satisfy the more general condition of being `` almost reflective '' , meaning that the weyl chamber is small enough that its isometry group is @xmath7 by finite .",
    "this is a very natural class of lattices from both the k3 and km perspectives .",
    "he also restricts attention to lattices that are strongly square - free ( ssf ) , which in rank  @xmath6 means they have square - free determinant .",
    "the full classification is desirable from the km perspective , because for example the root lattice even of a finite - dimensional simple lie algebra need not be ssf . on the other hand ,",
    "every lattice canonically determines a ssf lattice , so that his classification does yield all lattices whose reflection groups are maximal under inclusion .",
    "the ssf condition also enabled nikulin to use some tools from the theory of quadratic forms that we avoid .",
    "there are 1097 lattices in nikulin s 160 ssf lattices duality classes ( defined in section  [ sec - background ] ) , while our  lattices fall into  duality classes .",
    "most of our techniques run parallel to or are refinements of nikulin s methods .",
    "we have strived to keep the table of lattices to a manageable size , while remaining complete in the sense that the full classification can be mechanically recovered from the information we give .",
    "so we have printed only  of them and given operations to obtain the others . even after this reduction , the table is still large .",
    "the unabridged list of lattices is available separately as @xcite , including the gram matrices if desired .",
    "anyone wanting to work seriously with the lattices will need computer - readable data , which is very easy to extract from the tex source file of this paper .",
    "namely , by arcane computer tricks we have arranged for the tex source to be simultaneously a perl script that prints out all  lattices ( or optionally just some of them ) in computer - readable format .",
    "if the file is saved as say file.tex then simply enter perl file.tex at the unix command line .    for each reflective lattice @xmath8 , we worked out the conjugacy class of its weyl group @xmath9 in @xmath10 , the normalizers of @xmath9 in @xmath11 and @xmath10 , the area of its weyl chamber , its genus as a bilinear form over @xmath12 , one construction of @xmath8 for each corner of its chamber , and the relations among the lattices under @xmath13-duality and @xmath13-filling ( defined in section  [ sec - background ] ) .",
    "some summary information appears in section  [ sec - how - to - read ] , for example largest and smallest weyl chambers , most and fewest lattices with given weyl group , most edges ( ) , numbers of chambers with interesting properties like regularity or compactness , genera containing multiple reflective lattices , and the most - negative determinants and largest root norms .    here",
    "is a brief survey of related work .",
    "analogues of nikulin s work have been done for ranks @xmath14 and  @xmath15 by r.  scharlau @xcite and c.  walhorn @xcite respectively ; see also @xcite . in rank@xmath16 ,",
    "esselmann @xcite proved there are only @xmath1 reflective lattices , both in rank  @xmath17the even sublattice of @xmath18 ( recognized as reflective by borcherds @xcite ) and its dual lattice .",
    "also , nikulin @xcite proved that there are only finitely many reflective lattices in each rank , so that a classification is possible .",
    "the lattices of most interest for k3 surfaces are the 2-reflective ones , and these have been completely classified by nikulin @xcite@xcite and vinberg @xcite .    beyond these results ,",
    "the field is mostly a long list of examples found by various authors , with only glimmers of a general theory , like borcherds suggested almost - bijection between `` good '' reflection groups and `` good '' automorphic forms @xcite . to choose a few highlights , we mention coxeter and whitrow s analysis @xcite of @xmath19 , vinberg s famous paper @xcite treating @xmath20 for @xmath21 , its sequel with kaplinskaja @xcite extending this to @xmath22 , conway s analysis @xcite of the even unimodular lorentzian lattice of rank  @xmath23 , and borcherds method of deducing reflectivity of a lattice from the existence of a suitable automorphic form @xcite . before this , vinberg s algorithm @xcite was the only systematic way to prove a given lattice reflective .",
    "here is an overview of the paper . after providing background material in section  [ sec - background ] , we consider the shape of a hyperbolic polygon @xmath24 in section  [ sec - shape - of - polygon ] .",
    "the main result is the existence of @xmath6 , @xmath14 or @xmath15 consecutive edges such that the lines in the hyperbolic plane @xmath25 containing them are `` not too far apart '' .",
    "this is our version of nikulin s method of narrow parts of polyhedra @xcite@xcite , and some of the same constants appear .",
    "our technique is based the bisectors of angles and edges of @xmath24 , while his is based on choosing a suitable point @xmath13 of @xmath24 s interior and considering how the family of lines through @xmath13 meet @xmath26 .",
    "our method is simpler and improves certain bounds , but has no extension to higher - dimensional hyperbolic spaces , while his method works in arbitrary dimensions . for a more detailed comparison",
    ", please see the end of section  [ sec - shape - of - polygon ] .",
    "in section  [ sec - shape - of-2-dimensional - weyl - chamber ] we convert these bounds on the shape of the weyl chamber into an enumeration of inner product matrices of @xmath6 , @xmath14 or @xmath15 consecutive simple roots of @xmath9 .",
    "this is mostly a matter of organizing the parameters and calculations , since the computations themselves are just arithmetic . in section  [ sec - corner - symbols ]",
    "we introduce `` corner symbols '' .",
    "essentially , given @xmath8 and two consecutive simple roots @xmath27 and @xmath28 , we define a symbol like @xmath29 or @xmath30 displaying their norms , with the super- and subscripts giving enough information to recover the inclusion @xmath31 .",
    "so two lattices , each with a chamber and a pair of consecutive simple roots , are isometric by an isometry identifying these data if and only if the corner symbols and lattice determinants coincide .",
    "some device of this sort is required , even for sorting the reflective lattices into isometry classes , because the genus of a lattice is not a strong enough invariant to distinguish it . in one case ( see section  [ sec - how - to - read ] ) , two lattices with the same genus even have different weyl groups .",
    "we also use corner symbols in the proof of the main theorem ( theorem  [ thm - main - thm ] in section  [ sec - rank-3 ] ) and for tabulating our results .",
    "besides the proof of the main theorem , section  [ sec - rank-3 ] also introduces what we call the `` method of bijections '' , which is a general algorithm for determining whether a finite - index subgroup of a coxeter group is generated by reflections up to finite index .",
    "section  [ sec - how - to - read ] explains how to read the table at the end of the paper .",
    "that table displays lattices explicitly , together with operations to apply to obtain the full list of lattices .",
    "finally , in section  [ sec - conway - sloane ] we discuss the effects of various `` moves '' between lattices on the conway - sloane genus symbol ( * ? ? ?",
    "we also resolve a small error in their definition of the canonical @xmath1-adic symbol .",
    "computer calculations were important at every stage of this project , as explained in detail in section  [ sec - rank-3 ] .",
    "we wrote our programs in c++ , using the pari software library @xcite , and the full classification runs in around an hour on the author s laptop computer .",
    "the source code is available on request .",
    "although there is no a posteriori check , like the mass formula used when enumerating unimodular lattices @xcite , we can offer several remarks in favor of the reliability of our results .",
    "first , in the ssf case we recovered nikulin s results exactly ; second , many steps of the calculation provided proofs of their results ( e.g. , that a lattice is reflective or not ) ; and third , our list of lattices is closed under the operations of @xmath13-duality and @xmath13-filling ( see section  [ sec - background ] ) and `` mainification '' ( section  [ sec - how - to - read ] ) .",
    "this is a meaningful check because our enumeration methods have nothing to do with these relations among lattices .",
    "i am grateful to the max planck institute in bonn , where some of this work was carried out .",
    "for experts , the key points in this section are ( i ) lattices need not be integral and ( ii ) the definition of `` reflective hull '' .",
    "the notation @xmath32 indicates the @xmath12-span of some vectors .    _",
    "lattices : _ a lattice means a free abelian group @xmath8 equipped with a @xmath33-valued symmetric bilinear form , called the inner product",
    ". if @xmath8 has signature @xmath2 then we call it lorentzian . if the inner product is @xmath12-valued then @xmath8 is called integral . in this case",
    "we call the gcd of @xmath8 s inner products the scale of @xmath8 .",
    "we call @xmath8 unscaled if it is integral and its scale is  @xmath34 .",
    "the norm @xmath35 of a vector means its inner product with itself , and @xmath27 is called primitive if @xmath8 contains none of the elements @xmath36 , @xmath37 .",
    "@xmath8 is called if all its vectors have even norm , and otherwise .",
    "if @xmath8 is nondegenerate then its , written , means the set of vectors in @xmath38 having integer inner products with all of @xmath8 .",
    "so @xmath8 is integral just if @xmath39 . in this case",
    "@xmath8 s is defined as @xmath40 , a finite abelian group .",
    "the determinant @xmath41 is the determinant of any inner product matrix , and when @xmath8 is integral we have @xmath42 .",
    "_ roots : _ a root means a primitive lattice vector @xmath27 of positive norm , such that reflection in @xmath27 , given by @xmath43 preserves @xmath8 . under the primitivity hypothesis ,",
    "this condition on the reflection is equivalent to @xmath44 .",
    "now suppose @xmath45 are roots in a lattice @xmath8 , whose span is nondegenerate .",
    "then their reflective hull @xmath46 means @xmath47 the key property of the reflective hull is that it contains the projection of @xmath8 to @xmath48 . in the special case that @xmath45 generate @xmath8 up to finite index , we have @xmath49 then there are only finitely many possibilities for @xmath8 , giving us some control over a lattice when all we know is some of its roots .",
    "as far as i know , the reflective hull was first introduced in @xcite , in terms of the `` reduced discriminant group '' . for use in the proof of theorem  [ thmdef - finite - corner - symbols ] , we mention that if @xmath27 and @xmath28 are simple roots for an @xmath50 , @xmath51 , @xmath52 or @xmath53 root system , then @xmath54 is @xmath55 , @xmath56 , @xmath57 or trivial , respectively .",
    "_ weyl group : _ we write @xmath9 for the weyl group of @xmath8 , meaning the subgroup of @xmath58 generated by reflections in roots . when @xmath8 is lorentzian , @xmath58",
    "acts on hyperbolic space @xmath59 , which is defined as the image of the negative - norm vectors of @xmath60 in @xmath61 . for @xmath27 a root ,",
    "we refer to @xmath62 and the corresponding subset of @xmath59 as @xmath27 s mirror .",
    "the mirrors form a locally finite hyperplane arrangement in @xmath59 , and a weyl chamber ( or just chamber ) means the closure in @xmath59 of a component of the complement of the arrangement .",
    "often one chooses a chamber @xmath63 and calls it `` the '' weyl chamber . the general theory of coxeter groups ( see e.g. @xcite ) implies that @xmath63 is a fundamental domain for @xmath9 .",
    "note that @xmath63 may have infinitely many sides , or even be all of @xmath59 ( if @xmath8 has no roots ) .",
    "a lorentzian lattice @xmath8 is called reflective if @xmath63 has finite volume .",
    "the purpose of this paper is to classify all reflective lattices of signature @xmath0 . for a discrete group @xmath64 of isometries of @xmath59 , not necessarily generated by reflections",
    ", its reflection subgroup means the group generated by its reflections , and the weyl chamber of @xmath64 means the weyl chamber of this subgroup .",
    "_ simple roots : _ the preimage of @xmath63 in @xmath65 has two components ; choose one and call it @xmath66 . for every facet of @xmath66",
    ", there is a unique outward - pointing root @xmath27 orthogonal to that facet ( outward - pointing means that @xmath67 separates @xmath27 from @xmath66 ) .",
    "these are called the simple roots , and their pairwise inner products are@xmath68 . changing the choice of component simply negates to simple roots , so the choice of component will never matter to us .",
    "these considerations also apply to subgroups of @xmath9 that are generated by reflections .",
    "_ vinberg s algorithm : _ given a lorentzian lattice @xmath8 , a negative - norm vector @xmath69 ( called the controlling vector ) and a set of simple roots for the stabilizer of @xmath69 in @xmath9 , there is a unique extension of these roots to a set of simple roots for @xmath9 .",
    "algorithm @xcite finds this extension , by iteratively adjoining batches of new simple roots .",
    "if @xmath8 is reflective then there are only finitely many simple roots , so after some number of iterations the algorithm will have found them all .",
    "one can recognize when this happens because the polygon defined by the so - far - found simple roots has finite area .",
    "then the algorithm terminates . on the other hand ,",
    "if @xmath63 has infinite area then the algorithm will still find all the simple roots , but must run forever to get them . in this case",
    "one must recognize @xmath8 as non - reflective , which one does by looking for automorphisms of @xmath8 preserving @xmath63 .",
    "see section  [ sec - rank-3 ] for the details of the method we used . there is a variation on vinberg s algorithm using a null vector as controlling vector @xcite , but the original algorithm was sufficient for our purposes .",
    "_ @xmath13-duality : _ for @xmath13 a prime , the @xmath13-dual of a nondegenerate lattice @xmath8 is the lattice in @xmath38 characterized by @xmath70 for all primes @xmath71 , where @xmath72 is the ring of @xmath71-adic integers . applying",
    "@xmath13-duality twice recovers @xmath8 , so @xmath8 and its @xmath13-dual have the same automorphism group .",
    "when @xmath8 is integral one can be much more concrete : @xmath73 is the sublattice of @xmath74 corresponding to the @xmath13-power part of @xmath75 .",
    "the effect of @xmath13-duality on the conway - sloane genus symbol is explained in section  [ sec - conway - sloane ] .    in our applications",
    "@xmath8 will be unscaled , so the @xmath13-power part of @xmath75 has the form @xmath76 where @xmath77 and at least one of the @xmath78 s is @xmath79 . in this case",
    "we define the `` rescaled @xmath13-dual '' of @xmath8 as @xmath73 with all inner products multiplied by @xmath80 , where @xmath81 .",
    "this lattice is also unscaled , and the @xmath13-power part of its discriminant group is @xmath82 .",
    "repeating the operation recovers @xmath8 .",
    "we say that unscaled lattices are in the same duality class if they are related by a chain of rescaled @xmath13-dualities .",
    "our main interest in rescaled @xmath13-duality is that all the lattices in a duality class have the same isometry group , so we may usually replace any one of them by a member of the class with smallest @xmath83 .    _ @xmath13-filling : _",
    "suppose @xmath8 is an integral lattice , @xmath13 is a prime , and @xmath75 has some elements of order @xmath84 .",
    "then we define the @xmath13-filling of @xmath8 as the sublattice of @xmath74 corresponding to @xmath85 , where @xmath86 is the @xmath13-power part of @xmath75 and @xmath87 is the largest power of @xmath13 among the orders of elements of @xmath75 .",
    "one can check that @xmath88 is integral , and obviously its determinant is smaller in absolute value .",
    "the operation is not reversible , but we do have the inclusion @xmath89 . as for @xmath13-duality ,",
    "the effect of @xmath13-filling on the conway - sloane genus symbol is explained in section  [ sec - conway - sloane ] .",
    "_ ssf lattices : _ given any integral lattice @xmath8 , one can apply @xmath13-filling operations until no more are possible , arriving at a lattice whose discriminant group is a sum of cyclic groups of prime order . then applying rescaled @xmath13-duality for some primes @xmath13 leaves a lattice whose discriminant group has rank ( i.e. , cardinality of its smallest generating set ) at most @xmath90 .",
    "such a lattice is called strongly square - free ( ssf ) . for rank",
    "@xmath6 lattices this is equivalent to @xmath91 being square - free .",
    "nikulin s paper @xcite classified the ssf reflective lorentzian lattices of rank  @xmath6 .",
    "watson @xcite@xcite introduced operations leading from any lattice to a ssf one , and our operations are presumably special cases of his .",
    "in this section we develop our version of nikulin s method of narrow parts of polyhedra @xcite@xcite .",
    "we will prove the following theorem , asserting that any finite - sided finite - area polygon @xmath24 in @xmath25 has one of three geometric properties , and then give numerical consequences of them .",
    "these consequences have the general form : @xmath24 has several consecutive edges , such that the distances between the lines containing them are less than some a priori bounds . see the remark at the end of the section for a detailed comparison of our method with nikulin s .",
    "[ thmdef - shape - of - polygons ] suppose @xmath24 is a finite - sided finite - area polygon in @xmath25 .",
    "then one of its edges is , meaning that the angle bisectors based at its endpoints cross .",
    "furthermore , one of the following holds :    1 .",
    "[ case - there - exists - short - edge ] @xmath24 has a short edge orthogonal to at most one of its neighbors , with its neighbors not orthogonal to each other .",
    "[ case - there - exists - short - pair ] @xmath24 has at least @xmath15 edges and a @xmath92 , meaning : @xmath93 is a short edge orthogonal to its neighbors , @xmath94 is one of these neighbors , and the perpendicular bisector of @xmath93 meets the angle bisector based at the far vertex of @xmath94 .",
    "[ case - there - exists - close - pair ] @xmath24 has at least @xmath95 edges and a of short edges @xmath96 , meaning : @xmath93 and @xmath97 are short edges orthogonal to their neighbors , their perpendicular bisectors cross , and some ( i.e. , not short ) edge is adjacent to both of them .    for our purposes ,",
    "the perpendicular bisector of a finite - length edge of a polygon @xmath24 means the ray departing from the midpoint of that edge , into the interior of @xmath24 .",
    "the angle bisector at a finite vertex is a ray defined in the usual way , and the angle bisector at an ideal vertex means the set of points equidistant from ( the lines containing ) the two edges meeting there .",
    "we think of it as a ray based at the ideal vertex .    [ lem - rays - into - interior - of - p ] suppose @xmath24 is a convex polygon in @xmath98 and @xmath99 are distinct points of @xmath26 , numbered consecutively in the positive direction around @xmath26 , with subscripts read modulo  @xmath100 .",
    "suppose a ray @xmath101 departs from each @xmath102 , into the interior of @xmath24 .",
    "then for some neighboring pair @xmath103 of these rays , either they meet or one of them meets the open arc @xmath104 of @xmath105 .    when speaking of arcs of @xmath26 , we always mean those traversed in the positive direction",
    ". also , the proof works for the closure of any open convex subset of @xmath25 ; one should interpret @xmath26 as the topological boundary of @xmath24 in @xmath106 .",
    "by convexity of @xmath24 and the fact that @xmath101 enters the interior of @xmath24 , its closure @xmath107 meets @xmath26 at one other point @xmath108 .",
    "( we refer to @xmath107 rather than @xmath101 because @xmath108 might lie in @xmath109 . )",
    "now , @xmath108 lies in exactly one arc of @xmath26 of the form @xmath110 $ ] , and we define @xmath111 as the number of steps from @xmath102 to @xmath112 . formally : @xmath111 is the number in @xmath113 such that @xmath114 mod @xmath100 .",
    "now choose @xmath115 with @xmath111 minimal .",
    "if @xmath116 then @xmath101 meets @xmath104 or contains @xmath117 and we re done , so suppose @xmath118 .",
    "now , either @xmath119 meets @xmath104 , so we re done , or it meets @xmath101 , so we re done , or else @xmath120 lies in @xmath121\\sset(x_{i+1},x_{j+1}]$ ] . in the last case @xmath122 , so we have a contradiction of minimality .    to find a short edge ,",
    "apply lemma  [ lem - rays - into - interior - of - p ] with @xmath123 the vertices of @xmath24 and @xmath101 the angle bisector at @xmath102 .",
    "no @xmath101 can meet @xmath124 or @xmath125 $ ] , so some neighboring pair of bisectors must cross , yielding a short edge .",
    "suppose for the moment that some short edge is non - orthogonal to at least one of its neighbors .",
    "then conclusion   applies , except if its neighbors , call them @xmath94 and @xmath126 , are orthogonal to each other .",
    "this can only happen if @xmath24 is a triangle . in a triangle",
    "all edges are short and at most one angle equals @xmath127 .",
    "therefore conclusion   applies with @xmath94 or @xmath126 taken as the short edge .",
    "we suppose for the rest of the proof that every short edge of @xmath24 is orthogonal to its neighbors , because this is the only case where anything remains to prove .",
    "next we show that @xmath24 has@xmath128 sides ; suppose otherwise .",
    "we already treated triangles , so suppose @xmath24 is a quadrilateral . because @xmath25 has negative curvature , @xmath24 has a vertex with angle@xmath129 ; write @xmath130 and @xmath131 for the edges incident there .",
    "the angle bisector based there meets one of the other two edges ( perhaps at infinity ) , say the one next to @xmath130 .",
    "drawing a picture shows that @xmath130 is short .",
    "so @xmath24 has a short edge involved in an angle@xmath129 , a contradiction .",
    "next we claim that if @xmath93 and @xmath97 are adjacent short edges , say with @xmath97 at least as long as @xmath93 , then @xmath132 is a short pair .",
    "write @xmath133 for the perpendicular bisectors of @xmath93 , @xmath97 , write @xmath134 for the angle bisector at @xmath135 , and write @xmath136 ( resp .",
    "@xmath137 ) for the angle bisector at the other vertex of @xmath93 ( resp .",
    "@xmath97 ) .",
    "we hope the left half of figure  [ fig - shape - of - polygon ] will help the reader .",
    "now , @xmath136 meets @xmath134 because @xmath93 is short , and @xmath138 passes though @xmath139 because it is the perpendicular bisector of an edge whose two angles are equal .",
    "the same conclusions apply with @xmath140 in place of @xmath141 .",
    "furthermore , the intersection point @xmath142 is at least as far away from @xmath135 as @xmath143 is , because @xmath97 is at least as long as @xmath93 .",
    "if @xmath97 is strictly longer than @xmath93 , then @xmath138 enters the interior of the triangle bounded by @xmath134 , @xmath137 and @xmath97 by passing through @xmath134 .",
    "since @xmath138 can not meet @xmath97 , it must meet @xmath137 as it exits the triangle .",
    "so @xmath132 is a short pair .",
    "( in the limiting case where @xmath93 and @xmath97 have the same length , @xmath136 , @xmath138 , @xmath134 , @xmath144 and @xmath137 all meet at a single point . )",
    "now an argument similar to the one used for quadrilaterals shows that a pentagon has a short pair .",
    "namely , suppose @xmath93 is a short edge , and write @xmath145 for its neighbors and @xmath146 for their other neighbors .",
    "the perpendicular bisector of @xmath93 can not meet @xmath94 or @xmath126 ( since @xmath147 ) , so it meets @xmath148 or @xmath149 ( perhaps at infinity ) , say @xmath148 .",
    "then the angle bisector at @xmath150 either meets @xmath138 , so @xmath92 is a short pair , or it meets @xmath93 . in the latter case , @xmath94 is also short , and the previous paragraph assures us that either @xmath92 or @xmath151 is a short pair .",
    "this finishes the treatment of a pentagon , so we take @xmath24 to have@xmath152 edges in the rest of the proof .    at this point",
    "it suffices to prove that @xmath24 has a short pair , or a close pair of short edges .",
    "we apply lemma  [ lem - rays - into - interior - of - p ] again .",
    "let @xmath153 be the midpoints of the short edges and the vertices not on short edges , in whatever order they occur around @xmath105 .",
    "if @xmath102 is the midpoint of an edge , let @xmath101 be the perpendicular bisector of that edge .",
    "if @xmath102 is a vertex not on a short edge , let @xmath101 be the angle bisector there .",
    "lemma  [ lem - rays - into - interior - of - p ] now gives us some @xmath115 such that either @xmath101 and @xmath119 meet , or one of them meets @xmath104 .",
    "we now consider the various possibilities :    if both are angle bisectors then @xmath102 and @xmath154 must be the endpoints of one edge , or else there would be some other @xmath112 between them .",
    "the angle bisector based at an endpoint of the edge can not cross the interior of the edge , so @xmath101 and @xmath119 must cross , so the edge must be short .",
    "but this is impossible because then @xmath101 and @xmath119 would not be among @xmath155 .",
    "so this case can not occur .",
    "if one , say @xmath101 , is the perpendicular bisector of a short edge @xmath93 , and the other is an angle bisector , then we may suppose the following holds : the edge @xmath94 after @xmath93 is long , and @xmath119 is the angle bisector based at the endpoint of @xmath94 away from @xmath93 .",
    "otherwise , some other @xmath112 would come between @xmath102 and @xmath154 . if @xmath101 and @xmath119 meet then @xmath92 is a short pair .",
    "also , @xmath101 can not meet @xmath104 since @xmath156 .",
    "the only other possibility is that @xmath119 crosses @xmath93 between @xmath102 and @xmath157 .",
    "but in this case the angle bisectors based at the endpoints of @xmath94 would cross , so @xmath94 would also be short , a contradiction .",
    "finally , suppose @xmath101 and @xmath119 are the perpendicular bisectors of short edges @xmath158 .",
    "if @xmath158 are adjacent then one of the pairs @xmath132 , @xmath159 is a short pair ; so we suppose they are not adjacent .",
    "there must be exactly one edge between them , which must be long , for otherwise some other @xmath112 would come between @xmath102 and @xmath154 .",
    "if @xmath101 and @xmath119 cross then @xmath93 and @xmath97 forms a close pair of short edges and we are done . the only other possibility ( up to exchanging @xmath160 , @xmath161 ) is pictured in the right half of figure  [ fig - shape - of - polygon ] .",
    "namely , @xmath119 meets @xmath93 between @xmath157 and the midpoint of @xmath93 . in this case , the angle bisector based at @xmath157 either meets @xmath119 , so @xmath162 is a short pair , or it meets @xmath97 , which implies that @xmath94 is short , a contradiction .",
    "in lemmas  [ lem - numerical - consequences - of - short - edge][lem - numerical - consequences - of - close - short - edges ] we give numerical inequalities expressing the geometric configurations from theorem  [ thmdef - shape - of - polygons ] .",
    "we have tried to formulate the results as uniformly as possible . in each of the cases ( short edge , short pair , close pair of short edges ) , we consider three edges @xmath163 of a convex polygon in @xmath25 , consecutive except that there might be a short edge @xmath93 ( resp .",
    "@xmath97 ) between @xmath164 ( resp .",
    "@xmath165 ) and @xmath94 .",
    "we write @xmath166 for the corresponding outward - pointing unit vectors in @xmath167 ( and @xmath168 when @xmath158 are present ) .",
    "we define @xmath169 and @xmath170 , and the hypotheses of the lemmas always give upper bounds on them ( e.g. , if @xmath171 are adjacent then @xmath172 ) .",
    "the main assertion of each lemma is a constraint on @xmath173 , namely @xmath174 this may be regarded as giving an upper bound on the hyperbolic distance between ( the lines containing ) @xmath164 and @xmath165 .",
    "the bound plays a crucial role in section  [ sec - shape - of-2-dimensional - weyl - chamber ] .",
    "[ lem - numerical - consequences - of - short - edge ] suppose @xmath163 are consecutive edges of a polygon in @xmath25 .",
    "then @xmath175 , and @xmath94 is short if and only if @xmath176 .",
    "observe that @xmath177 and @xmath178 are vectors orthogonal to the angle bisectors based at @xmath179 and @xmath180 ; in fact they point outward from the region bounded by @xmath94 and these two bisectors .",
    "the bisectors intersect if and only if @xmath181 ( this is the condition that @xmath177 and @xmath178 have positive - definite inner product matrix . ) using @xmath182 and the definitions of @xmath183 and @xmath184 , then rearranging , yields @xmath176 . and @xmath185 is largest when @xmath183 and @xmath184 are , namely when @xmath94 is parallel to @xmath186 , yielding @xmath187 and @xmath188 .",
    "if a short edge is orthogonal to its neighbors , then its neighbors unit vectors inner product lies in @xmath189 .",
    "this is because @xmath190 when @xmath191 in lemma  [ lem - numerical - consequences - of - short - edge ] .",
    "we will use this in the next two lemmas .",
    "[ lem - numerical - consequences - of - short - pair ] suppose @xmath192 are distinct consecutive edges of a polygon in @xmath25 , with @xmath93 short and orthogonal to @xmath164 and @xmath94 . then @xmath193 and @xmath194 , and a necessary condition for @xmath92 to be a short pair is @xmath176 .",
    "furthermore , the projection @xmath195 of @xmath196 to the @xmath33-span of @xmath197 satisfies @xmath198    in this lemma , @xmath176 is necessary but not sufficient , while in lemma  [ lem - numerical - consequences - of - short - edge ] it was both .",
    "the reason for the difference is that here , if @xmath94 is short enough then the angle bisector at @xmath199 will exit @xmath24 before it can cross the perpendicular bisector of @xmath93 .",
    "a similar phenomenon occurs in the next lemma also .",
    "first we note that @xmath200 since @xmath164 and @xmath94 are ultraparallel",
    ". also , @xmath201 by the remark before the lemma .",
    "the proof that @xmath176 is exactly the same as in the previous proof , using the fact that @xmath177 is orthogonal to the perpendicular bisector of @xmath93 .",
    "( lemmas [ lem - numerical - consequences - of - short - edge][lem - numerical - consequences - of - close - short - edges ] acquire a certain unity when the perpendicular bisector of @xmath93 is regarded as the `` angle bisector '' of the ultraparallel edges @xmath164 and @xmath94 . )",
    "the inequality @xmath202 follows from @xmath203 .",
    "next , the @xmath33-span of @xmath197 is @xmath204 , so @xmath195 is got from @xmath196 by adding suitable multiples of @xmath205 and @xmath206 .",
    "computation reveals @xmath207 and then one can work out @xmath208 .",
    "finally , @xmath209 because @xmath195 was defined as an orthogonal projection of @xmath196 .",
    "[ lem - numerical - consequences - of - close - short - edges ] suppose @xmath210 are distinct consecutive edges of a polygon in @xmath25 , and assume @xmath93 and @xmath97 are short and orthogonal to their neighbors",
    ". then @xmath211 , @xmath212 , and a necessary condition for @xmath132 to be a close pair of short edges is @xmath176 .",
    "furthermore , the projection @xmath195 of @xmath196 to the @xmath33-span of @xmath213 satisfies , and similarly with primed and unprimed letters exchanged .",
    "finally , @xmath214    essentially the same as the previous one .",
    "the computation of @xmath215 is tedious but mechanical .",
    "the constants @xmath216 , @xmath217 and @xmath218 appearing in lemmas [ lem - numerical - consequences - of - short - edge][lem - numerical - consequences - of - close - short - edges ] are essentially the same as the constants @xmath219 , @xmath220 and @xmath221 in nikulin s ( 4.1.53 ) , ( 4.1.55 ) and ( 4.1.58 ) in ( * ? ? ?",
    "* theorem  4.1.8 ) .",
    "the factor of @xmath1 comes from the fact that he uses norm  @xmath1 vectors where we use unit vectors . and",
    "our short edge , short pair , close pair cases in theorem  [ thmdef - shape - of - polygons ] correspond to his type i , ii and iii narrow parts of polygons . in the short edge case",
    ", our condition that the short edge be non - orthogonal to one of its neighbors corresponds to nikulin s condition ( * ? ? ?",
    "* theorem  4.1.4 ) that the dynkin diagram of the @xmath6 roots be connected .    our results",
    "simplify his slightly in that we can suppose @xmath24 has@xmath128 ( resp .",
    "@xmath95 ) edges in the short pair ( resp .",
    "close pair ) cases .",
    "more important is our bound on @xmath222 in terms of @xmath223 and @xmath224 , which we believe is optimal .",
    "the analogous bounds in nikulin s paper are the second part of ( 4.1.4 ) , formula ( 4.1.10 ) or ( 4.1.55 ) , and formula ( 4.1.13 ) .",
    "our bounds are better and simpler in the short pair and close pair cases .",
    "they limit the size of the enumeration in the next section enough that we can avoid considering class numbers of imaginary quadratic fields , which nikulin uses in his section  3.2 .",
    "in this section we consider a lorentzian lattice @xmath8 of rank  3 , and assume that its weyl chamber @xmath63 possesses one of the features  from theorem  [ thmdef - shape - of - polygons ] .",
    "this always holds if @xmath63 has finite area .",
    "the goal is to restrict @xmath8 to one of finitely many possibilities ( up to scale ) .",
    "this is achieved in section  [ sec - rank-3 ] , but we do most of the work here , by showing that the simple roots corresponding to 3 , 4 or 5 suitable consecutive edges have one of finitely many inner product matrices ( up to scale ) .",
    "the point is not really this finiteness , which was already known by nikulin s finiteness theorem @xcite .",
    "what is important is that all possibilities are worked out explicitly .",
    "the main tool is lemma  [ lem - integerization - of - inner - products ] below , which allows one to obtain information about two roots of @xmath8 , given information about the corresponding unit vectors .",
    "in fact we will work with `` quasiroots '' of @xmath8 rather than roots ; the point is that the methods of this section can be used to gain control of the 3-dimensional lattice associated to any finite - area 2-dimensional face of any weyl chamber .",
    "the author intends to use this in higher - dimensional analogues of this paper . for purposes of classifying rank  3 reflective lattices",
    ", we will not need this generalization , so the reader may read `` root '' in place of `` quasiroot '' and assume that @xmath225 , @xmath226 , @xmath227 , @xmath228 and @xmath229 are always @xmath1 . for use in the general case , here is the definition .",
    "if @xmath8 is any lattice then we say that @xmath230 is a of @xmath8 of @xmath231 if @xmath232 is primitive , @xmath233 , and @xmath234 .",
    "notice that scaling a lattice up or down does nt affect the quasiroot weights .",
    "when a roman letter represents a quasiroot we will use the corresponding greek letter for its weight .",
    "a quasiroot of weight  2 is the same thing as a root , and quasiroot of weight  1 is the same thing as a generator of a 1-dimensional positive - definite summand of @xmath8 . of course , every primitive positive - norm vector of @xmath8 is a quasiroot of weight equal to its norm .",
    "but sometimes one has an a priori bound on the weights of quasiroots involved , independent of their norms .",
    "[ lem - integerization - of - inner - products ] suppose @xmath235 are quasiroots of weights @xmath136 , @xmath236 in a lattice @xmath8 , whose associated unit vectors satisfy @xmath237 for some @xmath238",
    ". then the inner product matrix of @xmath232 and @xmath138 is a rational number times @xmath239 for some positive integers @xmath240 satisfying @xmath241 .",
    "we will also use versions of this lemma with both @xmath242 signs replaced by @xmath243 or both by @xmath244 .",
    "these are formal consequences of this version .    we know",
    "@xmath245 and @xmath246 , so @xmath247 for some positive integers @xmath240 .",
    "this gives @xmath248 rewriting @xmath249 as @xmath250 yields @xmath241 .",
    "for convenience we scale the inner products so that @xmath251 , and then gives @xmath252 and @xmath253 .",
    "the hypothesis @xmath254 in the lemma is essential and annoying : when two quasiroots are orthogonal , their norms need not satisfy any relation at all . for example , in the proof of lemma  [ lem - shape - of-2d - se - integral - polygon ] , the hypothesis @xmath255 will be used to relate the norms of @xmath27 , @xmath256 and @xmath257 , an essential part of the proof . if we could do away with the non - orthogonality hypothesis in lemma",
    "[ lem - integerization - of - inner - products ] then we could carry out our enumeration of lattices using only the existence of a short edge .",
    "the possibility of orthogonality is what forces us to consider the more - complicated configurations of theorem  [ thmdef - shape - of - polygons ] .    the setup for lemmas  [ lem - shape - of-2d - se - integral - polygon][lem - shape - of-2d - cp - integral - polygon ] below is similar to that for lemmas  [ lem - numerical - consequences - of - short - edge][lem - numerical - consequences - of - close - short - edges ] .",
    "their hypotheses are exactly the `` outputs '' of the short edge , short pair and close pair cases of theorem  [ thmdef - shape - of - polygons ] .",
    "@xmath24 is a finite - sided finite - area polygon in @xmath25 , with angles at most @xmath127 , whose edges are the orthogonal complements of quasiroots of a rank  3 lorentzian lattice @xmath8 .",
    "@xmath164 , @xmath94 and @xmath165 are distinct edges of @xmath24 , consecutive except that there might be a short edge @xmath93 ( resp .",
    "@xmath97 ) between @xmath164 ( resp .",
    "@xmath165 ) and @xmath94 .",
    "we write @xmath258 ( and @xmath259 when @xmath158 are present ) for the outward - pointing quasiroots of @xmath8 orthogonal to @xmath260 .",
    "we suppose that @xmath27 , @xmath256 and @xmath257 ( and @xmath28 and @xmath261 if present ) are quasiroots of weights @xmath225 , @xmath227 and @xmath229 ( and @xmath226 and @xmath228 if relevant ) . as usual , we use hats to indicate the corresponding unit vectors . as in section  [ sec - shape - of - polygon ]",
    "we define @xmath169 , @xmath170 , @xmath262 and @xmath263 . in lemmas  [ lem - shape - of-2d - se - integral - polygon][lem - shape - of-2d - cp - integral - polygon ] @xmath183 , @xmath184 and @xmath264",
    "will be given by the formulas @xmath265 , @xmath266 and @xmath267 , where @xmath268 are non - negative integers described in the lemmas . in particular , @xmath185 is a function of @xmath269 .",
    "we have tried to make the treatment as uniform as possible , but the essential difference between orthogonal and non - orthogonal quasiroots forces separate treatment of the cases @xmath270 , @xmath271 in each of lemmas [ lem - shape - of-2d - se - integral - polygon ] and  [ lem - shape - of-2d - sp - integral - polygon ] .",
    "[ lem - shape - of-2d - se - integral - polygon ] suppose @xmath163 are consecutive edges of @xmath24 , @xmath94 is short , and @xmath255 .",
    "then the inner product matrix of @xmath258 is one of finitely many possibilities , up to scale .",
    "more precisely , let @xmath272 vary over all pairs of positive integers satisfying @xmath273 and let @xmath274 vary over @xmath275 and all pairs of positive integers satisfying @xmath276 . for fixed such @xmath269 ,",
    "let @xmath277 vary over all pairs of positive integers satisfying @xmath278 and @xmath279 then for some such @xmath268 , the inner product matrix of @xmath258 is a rational multiple of @xmath280    we have @xmath281 $ ] by hypothesis , so lemma  [ lem - integerization - of - inner - products ] says there exist positive integers @xmath282 with @xmath273 , such that @xmath283 have inner product matrix a rational multiple of @xmath284    now suppose @xmath271 .",
    "then the argument of the previous paragraph applies with primed and unprimed symbols exchanged . and by shortness of @xmath94 , @xmath176 ( lemma  [ lem - numerical - consequences - of - short - edge ] ) .",
    "then another application of lemma  [ lem - integerization - of - inner - products ] ( using the hypothesis @xmath285 ) shows there exist positive integers @xmath286 with @xmath287 , such that @xmath288 have inner product matrix a rational multiple of @xmath289 now we see @xmath290 so @xmath291 . this establishes .",
    "now we put all three @xmath292 matrices together by choosing the scale at which @xmath293 , leading to .",
    "it remains to consider the case @xmath270 .",
    "then we take @xmath294 and note that @xmath295 is indeed equal to @xmath296 , so this is consistent with the definition of @xmath184 . the same argument as before shows that @xmath288 have inner product matrix a rational multiple of .",
    "this time is trivially true because both sides vanish .",
    "now we put together and by choosing the scale at which @xmath297 .",
    "finally , using @xmath298 , the resulting inner product matrix is .",
    "[ lem - shape - of-2d - sp - integral - polygon ] suppose @xmath24 has at least @xmath15 edges , and @xmath192 are consecutive edges with @xmath92 a short pair .",
    "then the inner product matrix of @xmath299 is one of finitely many possibilities , up to scale .",
    "more precisely , let @xmath272 vary over all pairs of positive integers with @xmath300 and let @xmath274 vary over @xmath275 and all pairs of positive integers with @xmath276 .",
    "for fixed such @xmath269 , let @xmath277 vary over all pairs of positive integers satisfying @xmath301 for fixed such @xmath268 , let @xmath69 vary over all positive integers dividing @xmath302 . then for some such @xmath303 , the inner product matrix of @xmath299 is a rational multiple of @xmath304    lemma  [ lem - numerical - consequences - of - short - edge ] says that @xmath305 .",
    "so apply the previous proof with this inequality in place of @xmath306 .",
    "the result is that @xmath258 have inner products ( up to scale ) as in or , where @xmath268 have the stated properties up to and including . for the treatment of the inner product matrix of @xmath288 in that argument , note that @xmath285 by the fact that @xmath24 has at least @xmath15 edges . indeed",
    "@xmath164 and @xmath165 are not even adjacent .",
    "since @xmath24 has all angles@xmath307 , this says that the lines containing @xmath164 and @xmath165 are ultraparallel .",
    "this gives @xmath308 , which proves the @xmath309 inequality in .",
    "now we consider @xmath28 . as in lemma",
    "[ lem - numerical - consequences - of - short - pair ] , let @xmath195 be the projection of @xmath196 to @xmath310 , so the projection of @xmath257 is @xmath311 , which lies in @xmath312 since @xmath28 is a quasiroot of weight @xmath226 .",
    "therefore there is a positive integer @xmath69 such that @xmath313 , i.e. , @xmath314 on the other hand , @xmath257 is a quasiroot of weight @xmath229 , so @xmath315 . to work with this condition",
    "we define the integer @xmath316 where the last step uses .",
    "a calculation shows @xmath317 where @xmath302 is defined in . since @xmath318 is an integer we must have @xmath319 and @xmath320 .",
    "we have shown that @xmath303 have all the properties claimed , and all that remains is to work out the remaining entries in the inner product matrix .",
    "we have @xmath321 by the short pair hypothesis .",
    "referring to gives @xmath322 and referring to and gives @xmath323 this allows one to fill in the missing entries of and , using the values for @xmath324 given there .",
    "[ lem - shape - of-2d - cp - integral - polygon ] suppose @xmath24 has at least @xmath95 edges and @xmath210 are consecutive edges , with @xmath93 and @xmath97 forming a close pair of short edges .",
    "then the inner product matrix for @xmath325 is one of finitely many possibilities , up to scale .",
    "more precisely , let @xmath272 vary over all pairs of positive integers satisfying @xmath300 , and let @xmath274 vary over all pairs of positive integers satisfying @xmath326 .",
    "for fixed such @xmath269 , let @xmath277 vary over all pairs of positive integers satisfying @xmath327 where @xmath302 is defined as in and @xmath328 similarly , with primed and unprimed letters exchanged . for fixed such @xmath268 ,",
    "let @xmath329 vary over all pairs of positive integers with @xmath320 and @xmath330 , such that @xmath331 where @xmath332 then for some such @xmath333 , the inner product matrix of @xmath325 is a rational multiple of @xmath334    mostly this is a repeat of the @xmath335 cases of the previous proofs .",
    "follow the proof of lemma  [ lem - shape - of-2d - se - integral - polygon ] , using @xmath211 from lemma  [ lem - numerical - consequences - of - short - edge ] and @xmath336 from lemma  [ lem - numerical - consequences - of - close - short - edges ] .",
    "the result is that after rescaling , @xmath258 have inner products as in , where @xmath268 satisfy the conditions up to and including",
    ". then lemma  [ lem - shape - of-2d - sp - integral - polygon ] s analysis of @xmath302 and @xmath69 applies , and also applies with primed and unprimed symbols exchanged .",
    "this shows that @xmath337 have all the properties claimed except , and justifies all entries in except the @xmath338 entry . to work this out we use @xmath339 by , @xmath340 similarly , and formula for @xmath215 .",
    "the result is @xmath341 a calculation shows that this equals @xmath134 , defined in .",
    "this gives the last entry in the matrix .",
    "finally , is the condition that @xmath342 lies in @xmath343 and in @xmath344 , which holds because @xmath28 and @xmath261 are quasiroots .",
    "in this section we introduce a compact notation called a corner symbol for describing a corner in @xmath25 of the weyl chamber of a lattice @xmath8 of signature @xmath0 .",
    "it is a formalization of the ideas in @xcite , and is needed for the proof of our main theorem in section  [ sec - rank-3 ] and presenting our results in the table .",
    "but the reader should skip it until it is needed .    throughout this section",
    "suppose @xmath8 is a 3-dimensional lorentzian lattice and @xmath345 are consecutive edges of some weyl chamber .",
    "we will define the `` corner symbol '' @xmath346 , whose key property is that together with @xmath347 it characterizes @xmath348 up to isometry .",
    "first , there is a unique chamber @xmath349 of which @xmath345 are edges .",
    "choose a component @xmath66 of its preimage in @xmath350 .",
    "take @xmath351 to be simple roots corresponding to @xmath345 ; implicit in this definition is that they point away from @xmath66 .",
    "define @xmath352 as the primitive lattice vector in @xmath353 that lies in ( the closure of ) @xmath66 .",
    "we will define the corner symbol in terms of @xmath354 , so strictly speaking we should write @xmath355 or @xmath356 .",
    "but in the end the choice of @xmath66 is irrelevant because changing it simply negates @xmath354 .",
    "so @xmath346 will be well - defined .",
    "we will write @xmath357 and @xmath358 for @xmath359 and @xmath360 .",
    "first we will define corner symbols for corners in @xmath25 , and then for ideal vertices .",
    "the definitions involve some standard lattice - theoretic terms , which we define here for clarity .",
    "if @xmath8 is a lattice and @xmath318 a sublattice , then @xmath318 s saturation @xmath361 is defined as @xmath362 , and @xmath318 is called saturated if @xmath363 .",
    "now suppose @xmath8 is integral and @xmath318 is saturated",
    ". then @xmath8 lies between @xmath364 and @xmath365 , so it corresponds to a subgroup of @xmath366 .",
    "this subgroup is called the glue group of the inclusion @xmath367 .",
    "because of saturation , it meets the two summands @xmath368 , @xmath369 trivially .    [ thmdef - finite - corner - symbols ]",
    "suppose @xmath8 , @xmath370 , @xmath371 and @xmath352 are as stated , with @xmath352 defining a finite vertex of @xmath8 s weyl chamber .",
    "then for exactly one row of table  [ tab - finite - corner - symbols ] do they satisfy the conditions listed in the middle three columns .",
    "we define their as the entry in the first column . the corner symbol and",
    "@xmath372 determine the quadruple up to isometry , and @xmath373 is given in the last column in terms of @xmath372 , @xmath357 , @xmath358 and @xmath374 .",
    "here are some mnemonics for the notation .",
    "the subscript always gives the angle at that corner .",
    "the absence of a superscript indicates the absence of saturation and glue , so that @xmath375 is a summand of @xmath8 .",
    "an asterisk indicates the most complicated saturation and/or glue possible .",
    "the remaining superscripts are @xmath28 ( saturation but no glue ) , @xmath376 ( glue involving the left root ) , @xmath27 ( glue involving the right root ) , @xmath138 ( glue involving both roots ) and @xmath377 ( self - explanatory ) .    at a finite vertex of a weyl chamber , the angle is @xmath378 for @xmath379 , with @xmath370 and @xmath371 being simple roots for an @xmath50 , @xmath51 , @xmath52 or @xmath53 root system .",
    "the projection of @xmath8 to @xmath380 lies in the reflective hull of @xmath370 and @xmath371 ( see section  [ sec - background ] ) , and @xmath370 and @xmath371 are primitive in @xmath8 .",
    "this constrains the possible enlargements @xmath381 and @xmath382 so tightly that all possibilities are listed .",
    "( in the @xmath51 case there must be trivial saturation and nontrivial glue because otherwise every element of @xmath383 would extend to @xmath8 , so @xmath370 and @xmath371 would not be simple roots .",
    "similarly , most of the @xmath50 cases can only occur if @xmath384 . )",
    "also , @xmath373 is easy to work out in each case .",
    "the table shows how to reconstruct @xmath385 from knowledge of @xmath372 and the corner symbol .",
    "corner symbols at ideal vertices are more complicated .",
    "most of the information is contained in the structure of @xmath386 , which we encode as follows .",
    "[ lem - lemma - for - ideal - corner - symbols ] suppose @xmath8 is a @xmath1-dimensional integral lorentzian lattice and @xmath387 is primitive isotropic .",
    "then there is a unique primitive null vector @xmath388 with @xmath389 , and we define @xmath264 as @xmath390 and @xmath28 as @xmath391 $ ] .",
    "there exists a unique @xmath230 of the form @xmath392 with @xmath393 .",
    "the triple @xmath394 characterizes @xmath395 up to isometry .",
    "the triples that arise by this construction are exactly the triples of integers with @xmath396 , @xmath397 , @xmath398 , @xmath399 and @xmath400 .",
    "the uniqueness of @xmath401 is clear , and @xmath396 by construction . since @xmath391=s$ ]",
    ", @xmath8 lies between @xmath402 and @xmath403 , so it corresponds to a subgroup of order @xmath28 in @xmath404 . by the primitivity of @xmath352 and @xmath401",
    ", this subgroup meets the subgroups @xmath405 and @xmath406 trivially , so it must be the graph of an isomorphism between them .",
    "the existence and uniqueness of @xmath232 follows , as does the condition @xmath400 .",
    "the inner product matrix of @xmath8 with respect to the basis @xmath352 , @xmath232 is @xmath407 so integrality forces @xmath408 , hence @xmath398 .",
    "if @xmath28 satisfies this , then the rest of the matrix is automatically integral , which justifies our claim about which triples can arise . that @xmath394 determines @xmath395 follows from the intrinsic nature of our constructions .",
    "[ thmdef - ideal - corner - symbols ] suppose @xmath385 are as in theorem  [ thmdef - finite - corner - symbols ] , except that @xmath352 defines an ideal vertex of @xmath8 s weyl chamber .",
    "suppose also that @xmath352 and @xmath232 are the basis of @xmath386 associated to the pair @xmath409 by lemma  [ lem - lemma - for - ideal - corner - symbols ] .",
    "then for exactly one row of table  [ tab - ideal - corner - symbols ] do the conditions in the last two columns hold .",
    "we define the of @xmath385 to be the entry in the first column .",
    "the quadruple can be recovered up to isometry from its symbol and knowledge of @xmath410 .",
    ".corner symbols for ideal vertices of the weyl chamber of a 3-dimensional lorentzian lattice of determinant @xmath372 ; see theorem  [ thmdef - ideal - corner - symbols ] .",
    "note that the values of @xmath28 and @xmath226 appear , while the letters @xmath411 appear literally when relevant , for example @xmath30 . [ cols=\"^,^,^ \" , ]     in the initial state , @xmath412 and all pairs @xmath413 are marked `` unexplored '' .    at each iteration of the algorithm",
    "we choose an `` unexplored '' pair @xmath414 if one exists . if none does then the algorithm terminates .",
    "if @xmath415 then we mark the pair `` mirror '' . otherwise ,",
    "if @xmath416 then we mark the pair `` interior '' . otherwise , if @xmath417 for some @xmath418 then we mark the pair `` matched '' .",
    "otherwise we mark @xmath419 as `` interior '' and add @xmath420 to @xmath421 and all pairs @xmath422 to @xmath423 , and mark them `` unexplored '' .",
    "then we continue to the next iteration .    in the last case of this chain of otherwise s , note that @xmath424 , and by the conditions under which this case applies , @xmath425 lies in a coset of @xmath426 not represented by any previous member of @xmath421 .",
    "since there are only finitely many cosets of @xmath426 in @xmath427 , the algorithm must terminate .",
    "furthermore , at termination @xmath428 is @xmath426-equivalent to some member of @xmath421 , for every @xmath414 , or else @xmath428 would get adjoined to @xmath421 and the algorithm would continue .",
    "so @xmath421 is a complete set of coset representatives for @xmath426 in @xmath427 and the union @xmath429 is a fundamental domain for @xmath426 .",
    "also , whenever the algorithm adjoins a chamber @xmath430 to @xmath421 , it is already known that @xmath431 .",
    "it follows that both @xmath372 , @xmath432 lie in one weyl chamber of @xmath426 , and by induction that all of @xmath148 does .    at termination , each @xmath419",
    "is marked `` interior '' , `` matched '' or `` mirror '' .",
    "each facet marked `` interior '' really is in @xmath148 s interior , except perhaps for its boundary .",
    "if @xmath419 is marked `` matched '' , then there is a unique @xmath418 for which @xmath433 , and we define @xmath434 .",
    "this carries @xmath428 to @xmath432 , and lies in @xmath426 because it preserves @xmath435 .",
    "our main claim about the algorithm is the following :    [ thm - method - of - bijections ] @xmath426 is generated by the reflections across those facets @xmath436 for which @xmath419 is marked `` mirror '' and the @xmath437 for which @xmath419 is marked `` matched '' .",
    "the latter generate the stabilizer in @xmath426 of @xmath426 s weyl chamber .",
    "in particular , @xmath426 is generated by reflections up to finite index if and only if the group @xmath64 generated by all the @xmath437 is finite .",
    "the algorithm only marks @xmath419 as `` mirror '' if @xmath415 , and all the @xmath437 lie in @xmath426 by construction .",
    "so the supposed generators do in fact lie in @xmath426 .",
    "next we observe that @xmath437 preserves the weyl chamber of @xmath426 that contains @xmath148 ; this is just the fact that @xmath437 sends @xmath428 to @xmath432 , and @xmath428 lies in the same weyl chamber of @xmath426 as @xmath372 because @xmath438 .",
    "it follows that @xmath64 preserves this chamber of @xmath426 .",
    "now consider the polytope @xmath439 which is the union of the @xmath64-translates of @xmath148 ; it lies in this single chamber of @xmath426 .",
    "the reflection across any one of its facets is a @xmath64-conjugate of one of the reflections in our generating set , so lies in @xmath426 .",
    "it follows that @xmath439 is the whole of the weyl chamber for @xmath426 that contains it .",
    "all our claims follow from this .    in our situation , checking whether @xmath64 is finite amounts to checking whether the @xmath437 have a common fixed point in hyperbolic space , which is just linear algebra .",
    "when @xmath64 is finite , we take the @xmath64-images of the facets marked `` mirror '' .",
    "they bound @xmath426 s chamber , yielding simple roots for @xmath426 , which in our case is @xmath440 .",
    "at the end of the paper we exhibit the unscaled reflective lorentzian lattices of rank  3 .",
    "only lattices are displayed explicitly , and the rest are obtained by some simple operations .",
    "they are grouped according to the conjugacy classes of their weyl groups in @xmath441 .",
    "the first correspond to the main lattices in nikulin @xcite and are listed in the same order . then come the weyl groups of the lattices of nikulin s table  2 whose weyl groups have not been listed yet . the remainder are listed in no particular order . though we do not give details here , we classified the weyl groups up to commensurability ; they represent classes .    _ : _ for each weyl group , its euler characteristic is @xmath442 and the area of its weyl chamber is @xmath443 , where @xmath444 is given in the table .",
    "the largest area is ( ) and the smallest is ( ) . the number of lattices having that weyl group is listed ; the largest number is ( ) and the smallest is ( ) . for each @xmath445 we have numbered the printed lattices having that weyl group as @xmath446    _ : _ at the right side of the page we give the list of the chamber s angles @xmath447 in cyclic order .",
    "the largest number of edges is ( ) . of the different weyl chambers , are regular ( ) , have all ideal vertices ( ) , have all right angles , and are compact .",
    "_ : _ if the chamber has nontrivial isometry group then the list of angles is followed by `` @xmath448 '' or `` @xmath449 '' .",
    "the subscript @xmath100 gives the number of isometries and we write @xmath372 ( resp .",
    "@xmath63 ) when there are ( resp .",
    "are not ) reflections in this finite group .",
    "note the distinction between @xmath450 and @xmath451 .",
    "the largest @xmath452 appearing is @xmath453 ( ) and the maximal dihedral groups appearing are @xmath454 ( ) and @xmath455 ( ) .",
    "it happens very often that the chamber admits reflections , but in this case the reflections do nt preserve any of the lattices having that weyl group . in the dihedral case ,",
    "we have also indicated how the mirrors of the reflections meet the boundary of the chamber . a vertical line through a digit ( i.e. , @xmath456",
    ", @xmath457 , @xmath458 ) means that a mirror passes through that vertex , and a vertical line between two digits means that a mirror bisects the edge joining the two corresponding vertices .",
    "_ : _ for each lattice @xmath8 listed explicitly we give its genus , in one version of the notation of conway and sloane ( * ? ? ?",
    "that is , for each prime @xmath13 dividing twice the determinant , we give the @xmath13-adic symbol for @xmath459 .",
    "we have printed the symbol for the @xmath460 constituent explicitly to allow easy application of @xmath13-duality and @xmath13-filling ( see section  [ sec - conway - sloane ] ) . for @xmath461 we give their canonical @xmath1-adic symbol in the `` compartment '' notation , but see section  [ sec - conway - sloane ] because there is a minor error in their paper which requires adjusting the meaning of `` canonical '' .",
    "we have also suppressed the initial @xmath462 or @xmath463 that they use because it can be read from the displayed @xmath1-adic symbol , and we have suppressed the signature because it is always @xmath0 .",
    "for example , they would write @xmath464 in place of our @xmath465 .",
    "the reflective lattices represent genera , the largest number of reflective lattices in a genus is , and genera contain this many .",
    "when a listed lattice is not the only reflective lattice in its genus , this is noted in the table and we give additional information ; see `` '' below .",
    "_ : _ the structure of the discriminant group @xmath75 , and therefore the determinant of @xmath8 , can be read from the genus symbol .",
    "to do this one simply reads each symbol @xmath466 as the group @xmath467 , where @xmath71 is a prime power , and the string of symbols as the direct sum of groups .",
    "one ignores the sign , and when @xmath71 is even one also ignores any subscripts .",
    "for example , if @xmath8 has genus @xmath468 then discriminant group is @xmath469 .",
    "the most - negative determinant among all reflective lattices is . but",
    "a better measure of complexity considers only lattices which are minimal in their duality class , yielding .",
    "the largest prime factor among the determinants of our lattices is .",
    "_ : _ for some @xmath8 s in the table , appears after the genus ; it indicates how to construct some other lattices , not explicitly printed , from @xmath8 .",
    "a digit indicates the operation of @xmath13-filling ( see section  [ sec - background ] ) and @xmath470 indicates the operation of `` mainification '' .",
    "this has meaning when @xmath8 is odd and the @xmath471 jordan constituent of the @xmath1-adic lattice @xmath472 has dimension @xmath34 or  @xmath1 .",
    "it means passage to @xmath8 s even sublattice , followed by multiplying inner products by @xmath473 or @xmath474 to obtain an unscaled lattice .",
    "every automorphism of @xmath8 preserves @xmath8 s mainification . for rank @xmath6 lattices ,",
    "not admitting mainification is equivalent to being `` main '' in nikulin s terminology @xcite .",
    "we dislike our name for the operation , because the mainification of a lattice might not be main .",
    "a string of these symbols indicates that these operations should be applied in order , but usually the order is not important because the operations commute , except for mainification and @xmath1-filling .",
    "since all the primes involved are less than  10 , we have printed them without spaces .",
    "so for example indicates that @xmath8 s line on the table implicitly represents @xmath14 additional lattices .",
    "one is obtained by @xmath6-filling , one by @xmath6-filling followed by @xmath1-filling , one by @xmath6-filling followed by mainification , and one by mainification .",
    "a total of lattices are implicitly printed in this way .",
    "we only use this convention when each lattice obtained by the stated operations has the same weyl group as @xmath8 , so that simple roots for the derived lattices are scalar multiples of @xmath8 s .",
    "below for how to easily construct the inner product matrix and simple roots for lattices obtained in this way .",
    "it turns out that all of nikulin s lattices are implicitly printed in this fashion .",
    "we have indicated this by for example for @xmath475 .",
    "this means that the lattice got by applying @xmath1-filling and then @xmath6-filling to @xmath475 is numbered @xmath476 in nikulin s ( * ? ? ?",
    "* table  1 ) .",
    "we replace @xmath302 by @xmath328 to indicate lattices in his table  2 .",
    "we prepared our tables so that our simple roots come in the same order as his .",
    "also , some implicitly printed lattices share their genera with other reflective lattices ; we indicate this with an asterisk `` @xmath477 '' and provide some additional information in `` '' below .    _ : _ at the right we give the corner symbols at all the corners of the chamber in the same cyclic order used to list the angles of the weyl chamber .",
    "when @xmath11 contains a nontrivial isometry preserving the chamber , this isometry is always an involution , and we have written `` @xmath478 '' after the corner symbols .",
    "the full sequence of corner symbols is then got by concatenating two copies of the ones listed . by giving the corner symbols we have given enough information to reconstruct @xmath8 in several different ways .",
    "for example , the genus mentioned below contains @xmath479 , and to construct it we find a consecutive pair of roots , say @xmath480 ( the last root followed by the first one ) .",
    "so @xmath8 has roots of norms @xmath481 and  @xmath482 ; the subscript says they are orthogonal , and the absence of a superscript says that @xmath8 is generated by them and their orthogonal complement . since the determinant is @xmath483 , a generator for the complement has norm @xmath484 .",
    "so @xmath8 has inner product matrix @xmath485 $ ] .",
    "refer to section  [ sec - corner - symbols ] for full instructions on constructing @xmath8 from one of its corner symbols .",
    "the largest root norm among all reflective lattices ( resp .",
    "those minimal in their duality classes ) is ( resp . ) .",
    "_ : _ when one of our listed lattices @xmath8 shares its genus with another reflective lattice , we state what the other lattice is , either as a lattice in @xmath8 s duality class or by describing it in terms of another @xmath486 .",
    "we also give all chains of @xmath13-dualities that carry @xmath8 to a lattice isometric to @xmath8 .",
    "this information is required to reconstitute the full table from what we have printed .",
    "see `` '' below .",
    "a few implicitly - listed lattices also share their genera with other reflective lattices .",
    "the corresponding information for these lattices is the following :    reflective lattices having the same genus usually have the same weyl group .",
    "but the genus contains the reflective lattices @xmath487 and @xmath488 , which have weyl groups and .",
    "the only other genus with this property is the @xmath1-dual of this one .",
    "_ : _ this is the first displayed matrix .",
    "we did not seek bases in which the matrix entries are small , or bases related to the corners of the chamber .",
    "rather , they are in smith normal form relative to their duals , which is useful when applying @xmath13-filling and @xmath13-duality .",
    "namely , let @xmath489 be the elementary divisors of the inclusion @xmath490 , where @xmath491 .",
    "these can be read from the structure of @xmath75 , which can be read from the genus as explained under `` '' . with respect to the basis having the displayed inner product matrix",
    ", @xmath74 has basis @xmath492 , @xmath493 , @xmath494 .",
    "our lattices are unscaled , so @xmath495 is always  @xmath34 .",
    "_ : _ if @xmath8 admits a diagram automorphism , that is , an isometry preserving the weyl chamber ( other than negation ) , then this is an involution and we display it right after the inner product matrix .    _ : _ next we list the simple roots of @xmath8 .",
    "if @xmath8 has no diagram automorphism then all the simple roots are listed , in the order used for the corner symbols .",
    "if @xmath8 has a diagram automorphism then only the first half of the simple roots are displayed and the rest are got by applying the diagram automorphism .",
    "_ : _ the table of lattices is complete in the following sense .",
    "there are duality classes of reflective lattices , and each has exactly one member appearing in the table , explicitly and implicitly .",
    "the lattices printed explicitly always have minimal ( i.e. , least negative ) determinant in their duality classes .",
    "the full list of reflective lattices is obtained from our explicitly printed lattices by applying the stated operations and then applying all possible rescaled @xmath13-dualities .",
    "as stated , this is not quite explicit , because some chains of @xmath13-dualities may lead back to @xmath8 . a fancy way to say",
    "this is that @xmath8 s duality class is a homogeneous space for @xmath496 where @xmath497 is the set of primes dividing @xmath41 . to find the other lattices in the duality class , without duplicates , one must find a subgroup of @xmath496 acting simply - transitively , i.e. , a complement to the subgroup @xmath498 acting trivially .",
    "so one needs to know @xmath94 in order to reconstruct the full list of lattices without duplication . if @xmath8 is the unique reflective lattice in its genus ( which is almost always the case",
    ") then one can determine whether a given sequence of rescaled @xmath13-dualities yields a lattice isometric to @xmath8 by computing the genus of the result and comparing that to @xmath8 s .",
    "( see section  [ sec - conway - sloane ] for the easy computational details . ) otherwise , there is no easy way to determine this , and it is for this reason that we have listed the nontrivial elements of @xmath94 explicitly when @xmath8 shares its genus with another reflective lattice .",
    "we say `` elements '' but it turns out that @xmath94 is never larger than @xmath57 .",
    "_ : _ because of our choice of basis for the lattices ( see `` '' ) , applying @xmath13-filling is easy .",
    "let @xmath499 be the @xmath13-part of the first elementary divisor @xmath232 , and adjoin @xmath500 to @xmath8 .",
    "this has the effect of dividing the first row and column of the inner product matrix by @xmath13 , and multiplying the first coordinate of all roots by @xmath13 .",
    "( if @xmath501 then we would treat the second coordinate similarly , but this never happens because the explicitly printed lattices are all minimal in their duality classes . )",
    "the result is the inner product matrix for @xmath88 , and the simple roots of @xmath8 expressed in a basis for @xmath88 .",
    "it may be that some of @xmath8 s roots are divisible by @xmath13 in @xmath73 , so if necessary we divide by @xmath13 to make them primitive",
    ". they will be roots of @xmath88 since @xmath502 . when the filling operation is indicated in our tables ,",
    "these roots are a set of simple roots for @xmath88 .",
    "this is because we only indicate filling operations when they do nt change the weyl group .",
    "similar but slightly more complicated operations treat mainification and rescaled @xmath13-duality .",
    "genera of integer bilinear forms present some complicated phenomena , and conway and sloane introduced a notation for working with them that is as simple as possible ( * ? ? ?",
    "15 ) . in this section",
    "we state how to apply our operations of filling , duality and mainification in terms of their notation .",
    "we also correct a minor error in their formulation of the canonical @xmath1-adic symbol .    _ @xmath13-filling : _ this affects only the @xmath13-adic symbol .",
    "one simply takes the jordan constituent of largest scale @xmath503 and replaces @xmath504 by @xmath232 .",
    "( recall that @xmath13-filling is only defined if @xmath505 . )",
    "the scale of the resulting summand of @xmath506 may be the same as that of another constituent of @xmath8 . in this case one",
    "takes the direct sum of these sublattices of @xmath88 to obtain the @xmath80-constituent .",
    "the direct sum is computed as follows , where we write @xmath71 for @xmath80 : @xmath507 if @xmath71 is even . here the @xmath508 are signs , @xmath509 are the ranks and @xmath510 are the oddities . in short ,",
    "signs multiply and ranks and subscripts add , subject to the special rules involving @xmath463 . when @xmath461 , sometimes there is additional oddity fusion or opportunity for sign walking . here",
    "are some examples of @xmath1-filling : @xmath511_5 = [ 1 ^ 22 ^ 1]_1 \\\\   1 ^ 1_{-1}[4 ^ 18 ^ 1]_2 & { } \\to 1 ^ 1_{-1}[4 ^ 12 ^ 1]_2 = [ 1 ^ 12 ^ 14 ^ 1]_1 \\\\ 1 ^ 1_14 ^ 1_716 ^ 1_1 & { } \\to 1 ^ 1_14 ^ 1_7\\oplus4 ^ 1_1 = 1 ^ 1_14",
    "^ 2_0 \\\\ 1 ^ 2_{\\ii}4 ^ 1_1 & { } \\to 1 ^ 2_{\\ii}\\oplus1 ^ 1_1 = 1 ^ 3_1.\\end{aligned}\\ ] ]    _ rescaling : _ multiplying all inner products by a rational number @xmath28 has the following effect on the @xmath376-adic symbols for all primes @xmath376 that divide neither the numerator nor denominator of @xmath28 .",
    "the sign of a constituent @xmath512 is flipped just if @xmath100 is odd and the legendre symbol @xmath513 is  @xmath484 . if @xmath514 we must supplement this rule by describing how to alter the subscript .",
    "a subscript @xmath463 is left alone , while a subscript @xmath515 is multiplied by @xmath28 .",
    "_ rescaled @xmath13-duality : _ say @xmath516 is the largest scale appearing in the @xmath13-adic symbol .",
    "one obtains the rescaled @xmath13-dual by an alteration that does nt affect @xmath517 for @xmath518 , followed by rescaling by @xmath80 .",
    "so for @xmath518 the effect of rescaled @xmath13-duality is the same as that of rescaling .",
    "the @xmath13-adic symbol is altered by replacing the scale @xmath519 of each constituent by @xmath520 , leaving superscripts and subscripts alone .",
    "since one usually writes the constituents in increasing order of scale , this also reverses the order of the constituents .",
    "a single example of @xmath1-duality should illustrate the process : @xmath521    _ mainification : _ this is an alteration of @xmath8 that does nt affect @xmath517 for odd @xmath376 , followed by rescaling by @xmath473 or @xmath474 .",
    "so for odd @xmath376 mainification has the same effect as rescaling .",
    "recall that the mainification is only defined if @xmath8 is odd with @xmath471-constituent of rank  @xmath34 or  @xmath1 . referring to ( 33 ) and ( 34 ) of ( * ? ? ?",
    "15 ) , this means that the constituent is one of @xmath522 , @xmath523 , @xmath524 , @xmath525 , @xmath526 or @xmath527 . to find the @xmath1-adic symbol of @xmath528 , begin by altering the @xmath471-constituent as follows :",
    "@xmath529 the scale of the result may be the same as that of another constituent present , in which case one takes their direct sum as above .",
    "finally , one divides every scale by the smallest scale present ( @xmath1 or @xmath14 ) , leaving all superscripts and subscripts alone .",
    "this scaling factor is also the one to use to work out the effect on the odd @xmath376-adic symbols . here",
    "are some examples : @xmath530_0256 ^ 1_1{\\cdot}1 ^ 29 ^ 1 \\to [ 1 ^ 12 ^ 1]_064 ^ 1_1{\\cdot}1 ^ 29 ^ 1 \\\\ [ 1 ^ 12 ^ -4 ^ 1]_3{\\cdot}1^{-2}3 ^ - \\to [ 2 ^ -4 ^ 2]_3{\\cdot}1^{-2}3 ^ - \\to [ 1 ^ -2 ^ 2]_3{\\cdot}1^{-2}3 ^ 1.\\end{gathered}\\ ] ]    there is an error in the definition of the canonical @xmath1-adic symbol by conway - sloane ( * ? ? ?",
    "distinct @xmath1-adic symbols can represent isometric @xmath1-adic lattices , and conway and sloane give a calculus for reducing every @xmath1-adic symbol to a canonical form .",
    "first one uses `` sign walking '' to change some of the signs ( and simultaneously some of the oddities ) , and then one uses `` oddity fusion '' .",
    "`` compartments '' and `` trains '' refer to subchains of the @xmath1-adic symbol that govern these operations .",
    "( the compartments are delimited by brackets @xmath531 $ ] . )",
    "conway and sloane state that one can use sign walking to convert any @xmath1-adic symbol into one which has plus signs everywhere except perhaps the first positive - dimensional constituent in each train .",
    "this is not true : sign walking would supposedly take the @xmath1-dimensional lattice @xmath532 with total oddity @xmath533 to one of the form @xmath534 with total oddity @xmath79 .",
    "but the oddity of the first ( resp .",
    "second ) constituent must be @xmath535 ( resp .",
    "@xmath536 ) by ( 33 ) of ( * ? ? ?",
    "15 ) , so the total oddity can not be @xmath79 .",
    "so the canonical form we use is slightly more complicated : minus signs are allowed either on the first positive - dimensional constituent of a train , or on the second constituent of a compartment of the form @xmath537 with total oddity  @xmath14 or @xmath538 with total oddity  @xmath79 . here",
    "@xmath71 and @xmath27 are consecutive powers of @xmath1 .",
    "oddity fusion remains unchanged .",
    "note that the second form @xmath539_0 $ ] can only occur if the @xmath71-constituent is the first positive - dimensional constituent of its train . using ( * ? ? ?",
    "15 , thm .",
    "10 ) we checked that two @xmath1-adic lattices are isomorphic if and only if their canonical symbols ( in our sense ) are identical .",
    "nikulin , v. v. , quotient - groups of groups of automorphisms of hyperbolic forms of subgroups generated by 2-reflections .",
    "nauk sssr _ * 248 * ( 1979 ) no . 6 , 13071309 .",
    "english translation : _",
    "soviet math .",
    "dokl . _ * 20 * ( 1979 ) no . 5 , 11561158 ( 1980 ) ."
  ],
  "abstract_text": [
    "<S> we classify all the symmetric integer bilinear forms of signature @xmath0 whose isometry groups are generated up to finite index by reflections . </S>",
    "<S> there of them up to scale , whose distinct weyl groups fall into commensurability classes . </S>",
    "<S> this extends nikulin s enumeration of the strongly square - free cases . </S>",
    "<S> our technique is an analysis of the shape of the weyl chamber , followed by computer work using vinberg s algorithm and our `` method of bijections '' . </S>",
    "<S> we also correct a minor error in conway and sloane s definition of their canonical @xmath1-adic symbol . </S>"
  ]
}