{
  "article_text": [
    "a bayesian network is a directed graph ; that is , a set of nodes with arrows connecting some pairs of these nodes . each node is assigned a transition matrix . for a classical bayesian net ,",
    "each transition matrix is real , and the product the transition matrices for all the nodes gives a joint probability distribution for the states of all the nodes . for a quantum bayesian net ,",
    "each transition matrix is complex , and the product of the transition matrices gives a joint probability amplitude instead .",
    "a markov network is an undirected graph ; that is , a set of nodes with undirected links connecting some pairs of these nodes . each super - clique ( maximal fully - connected subgraph ) of the graph is assigned an affinity . for a classical markov net ,",
    "each affinity is real , and their product gives a joint probability distribution for the states of all the nodes . for a quantum markov net , each affinity is complex , and their product gives a joint probability amplitude instead .",
    "bayesian and markov networks will be defined more precisely later on in this paper .",
    "the literature on classical bayesian nets is vast .",
    "some textbooks that were invaluable in writing this paper are refs.@xcite,@xcite .",
    "classical bayesian nets were invented by geneticist sewall wright@xcite in the early 1930 s .",
    "the theory of bayesian nets was extended substantially by judea pearl@xcite@xcite@xcite and collaborators in the late 1980 s .",
    "they gave us the theory that culminates in the d - separation rules .",
    "see scheines@xcite for a more complete review of the history of d - separation .",
    "nowadays , classical bayesian nets are used widely in data mining , ai , etc .",
    "there exist only a small number of papers on quantum bayesian nets .",
    "the first paper@xcite on the subject appears to be mine . since then",
    ", i have written several papers applying quantum bayesian nets to quantum information theory@xcite and quantum computing@xcite .",
    "i have also written a mac application called quantum fog@xcite ( freeware but patented ) that implements the ideas behind quantum bayesian networks .",
    "laskey has also written some papers@xcite about quantum bayesian nets .",
    "it s known that any _ probability distribution _ can be represented by a bayesian net , and also by a markov net .",
    "it s known that any bayesian or markov net that represents a _ probability distribution _",
    ", is logically equivalent to a set of conditional independencies satisfied by the _ probability distribution_.    in this paper , we show that the last paragraph is true if we replace _ probability distribution _ by _ density matrix_.    we also show that the d - separation theorems of classical bayesian and markov networks generalize in a simple and natural way to quantum physics .",
    "the quantum d - separation theorems are shown to be closely connected to quantum entanglement .",
    "we show that the graphical rules for d - separation can be used to detect pairs of nodes ( or of node sets ) in a graph that are unentangled .",
    "cmi entanglement ( a.k.a .",
    "squashed entanglement)@xcite , a measure of entanglement originally discovered by analyzing bayesian networks , is an important part of the theory of this paper .",
    "this paper is fairly self - contained ; readers previously acquainted with quantum physics but not with classical bayesian nets should have no trouble following this paper .",
    "results about classical bayesian nets are derived in parallel with those about their quantum brethren .",
    "the paper has pretensions of being pedagogical .",
    "in this section , we define some notation , and review various prerequisite ideas that will be used in the rest of the paper .      as usual",
    ", @xmath0 will denote the integers , real numbers , and complex numbers , respectively .",
    "let @xmath1 , @xmath2 and @xmath3 . for @xmath4 such that @xmath5 , let @xmath6 .",
    "for any set @xmath7 , let @xmath8 denote the number of elements in @xmath7 .",
    "for any set @xmath7 , its power - set is defined as @xmath9 .",
    "this set includes the empty set @xmath10 and the full set @xmath7 .",
    "the power - set of @xmath7 is often denoted by @xmath11 because @xmath12 .",
    "let @xmath13 denote the kronecker delta function ; it equals 1 if @xmath14 and 0 if @xmath15 .    for any matrix @xmath16",
    ", @xmath17 will denote its complex conjugate , @xmath18 its transpose , and @xmath19 its hermitian conjugate .",
    "let @xmath20 denote a diagonal matrix with diagonal entries @xmath21 .    for any @xmath22 , @xmath23 will denote its phase . if @xmath24 , @xmath25 .",
    "for any expression @xmath26 , we will sometimes abbreviate    = . the abbreviation with the word",
    " numerator \" is especially helpful when @xmath26 is a long expression , and we want to write it only once instead of twice",
    ".    for @xmath27 , let    = f_1 f_2 .",
    "this notation saves horizontal space : it allows us to indicate the product of two numbers with the numbers written in a column instead of a row",
    ".    given expressions a , b , x , y , we will often say things like  a ( ditto , x ) is b ( ditto , y ) \" ; by this , we will mean that  a is b \" and  x is y \" .",
    "random variables will be denoted by underlined letters ; e.g. , @xmath28 .",
    "the set of values ( states ) that @xmath28 can assume will be denoted by @xmath29 .",
    "let @xmath30 . , in both classical and quantum physics , to be merely the label of a node in a graph , or an n - tuple @xmath31 of such labels . ] the probability that @xmath32 will be denoted by @xmath33 or @xmath34 , or simply by @xmath35 if the latter will not lead to confusion in the context it is being used .",
    "we will use @xmath36 to denote the set of all probability distributions with domain @xmath29 .    in this paper , we consider networks with @xmath37 nodes .",
    "each node is labelled by a random variable @xmath38 , where @xmath39 .",
    "for any @xmath40 , the ordered set of random variables @xmath38 @xmath41 ( ordered so that the integer indices @xmath42 increase from left to right ) will be denoted by @xmath43 or @xmath44 .",
    "for example , @xmath45 .",
    "we will often call the values that @xmath44 can assume @xmath46 or @xmath47 . for example , @xmath48 . we will often abbreviate @xmath49 or @xmath50 by just @xmath51 or @xmath52 .",
    "we will often call the values that @xmath52 can assume @xmath53 or @xmath54 .    in this paper , we will often divide by probabilities without specifying that they should be non - zero .",
    "most of the time , this cavalier attitude will not get us into trouble . that s because one can always replace all vanishing probabilities by a positive infinitesimal @xmath55 .",
    "our results can then be expressed as a power series in @xmath55 . as long as our inferences depend only on terms that are zeroth order in @xmath55",
    ", our inferences will be well - defined and unique as @xmath55 tends to 0 .",
    "there are , however , situations when dividing by a probability can be fatal .",
    "such situations ultimately boil down to trying to infer something from terms that are first order in @xmath55 ; for example , when we erroneously conclude that @xmath56 implies @xmath57 . in the future",
    ", we will divide by probabilities without assuming that they should be non - zero , except in those cases when doing so is being used to infer something that becomes false when @xmath58 .    in quantum physics",
    ", @xmath28 has a _ fixed , orthonormal _ basis @xmath59 associated with it . the vector space spanned by this basis",
    "will be denoted by @xmath60 . in quantum physics , instead of probabilities @xmath33 , we use  probability amplitudes \" ( or just  amplitudes \" for short ) @xmath61 ( also denoted by @xmath62 or @xmath63 ) . whereas @xmath64 and @xmath65 , @xmath66 . besides probability amplitudes",
    ", we also use density matrices .",
    "a density matrix @xmath67 is a hermitian , non - negative , unit trace operator acting on @xmath60 .",
    "we will use @xmath68 to denote the set of all density matrices acting on @xmath60 .",
    "if @xmath69 , @xmath70 , and @xmath71 , we will say that @xmath72 is a * partial trace of * @xmath73 , and @xmath73 is a * traced dm - extension of * @xmath72 . given a density matrix @xmath74 , its partial traces will be denoted by omitting its subscripts for the random variables that have been traced over . for example , @xmath75 .",
    "we will sometimes abbreviate @xmath76 by @xmath77 .",
    "this abbreviation is especially convenient when the label @xmath78 is a long expression , for then we only have to write @xmath78 once instead of twice .",
    "next , we review some basic definitions from graph theory .",
    "a * graph * @xmath79 is pair @xmath80 , where @xmath81 is a set of * nodes ( vertices ) * , and @xmath82 is a set of * connections ( edges ) * between some pairs of these nodes .",
    "( no self - connections allowed ) .",
    "a * subgraph * @xmath83 of a graph @xmath84 is a graph such that @xmath85 , and @xmath86 is defined as the subset of @xmath82 that survives after we erase from @xmath82 all edges that mention a node in @xmath87 .",
    "we will abbreviate * directed acyclic graph * by dag .",
    "a dag is a graph with arrows as its edges , and without any cycles .",
    "a * cycle * is a finite sequence of arrows that one can follow , in the direction of the arrows , and come back to where one started .",
    "the set of all possible dags with node labels @xmath52 will be denoted by @xmath88 .",
    "we will abbreviate * undirected graph * by ug .",
    "an ug is a graph with ( undirected ) links as its edges .",
    "the set of all possible ugs with node labels @xmath52 will be denoted by @xmath89 .",
    "one can also define hybrid graphs that contain both arrows and undirected links@xcite@xcite , but we wo nt consider them in this paper .    consider a dag whose nodes are labelled by @xmath52 .",
    "any node @xmath38 has parent nodes ( those with arrows pointing from them to @xmath38 ) and children nodes ( those with arrows pointing from @xmath38 to them ) .",
    "@xmath90 are defined as the sets of integer indices of the * parent and children nodes * of @xmath38 .",
    "for example , in fig.[fig - diamond - graphs](a ) , @xmath91 and @xmath92 .",
    "@xmath93 are defined as the sets of integer indices of the * ancestor and descendant nodes * of @xmath38 .",
    "that is , @xmath94 . by this",
    "we mean that @xmath95 is obtained by taking the union of the integer indices of the parents of @xmath38 , and of the parents of the parents of @xmath38 , and of the parents of the parents of the parents of @xmath38 , and so on .",
    "likewise , @xmath96 . the set of integer indices of the * non - descendants * of @xmath38 will be denoted by @xmath97 .",
    "the set of integer indices of the * non - ancestors * of @xmath38 will be denoted by @xmath98 .",
    "let @xmath99 for @xmath100 .",
    "in other words , we will use an overline over a set @xmath101 that does not include @xmath42 to denote the  closure \" set obtained by adding @xmath42 to @xmath101 .",
    "next consider an ug whose nodes are labelled by @xmath52 .",
    "any node @xmath38 has * neighbor nodes * ( those with links between @xmath38 and them ) .",
    "@xmath102 is defined as the set of integer indices of the neighbor nodes of @xmath38 .",
    "for example , in fig.[fig - diamond - graphs](b ) , @xmath103 .",
    "we will also use @xmath104 .    for either a dag or an ug ,",
    "a * path from node @xmath105 to node @xmath106 * is a finite sequence of nodes , starting with @xmath105 and ending with @xmath106 , such that adjacent nodes in the sequence are connected .",
    "note that for a dag , the arrows in a path need not all be oriented in the same sense .",
    "if they are , we call the path a * directed path*.    in a dag , a path from @xmath105 to @xmath106 can have 3 ( mutually exclusive and exhaustive ) types of nodes .",
    "a * serial node * @xmath28 equals one of the endpoints ( @xmath105 and @xmath106 ) , or else , it is connected to its path neighbors in this ( ) or this ( ) manner .",
    "a * divergence node * @xmath28 is connected to its path neighbors in this ( ) manner .",
    "a * convergence ( a.k.a .",
    "collider ) node * @xmath28 is connected to its path neighbors in this ( ) manner .",
    "a dag ( ditto , an ug ) is * fully connected * if it is impossible to add any more legal arrows ( ditto , links ) to it .",
    "a fully connected subgraph ( of either a dag or an ug ) is called a * clique*. a clique for which there is no larger clique that contains it , is called a * super - clique*. for any graph @xmath79 , we define @xmath107 ( a subset of @xmath108 ) to be the set of the super - cliques of @xmath79 . for example , @xmath107 for both graphs in fig.[fig - diamond - graphs ] is @xmath109 .",
    "a * classical bayesian network * is a dag with labelled nodes ( let @xmath110 be the labels ) , together with a transition matrix @xmath111 associated with each node @xmath38 of the graph .",
    "the quantities @xmath111 are probabilities ; they are non - negative and satisfy @xmath112 .",
    "the probability of the whole net is defined as the product of the probabilities of the nodes .",
    "a * quantum bayesian network * is a dag with labelled nodes ( let @xmath110 be the labels ) , together with a transition matrix @xmath113 associated with each node @xmath38 of the graph .",
    "the quantities @xmath113 are probability amplitudes ; they satisfy @xmath114 .",
    "the probability amplitude of the whole net is defined as the product of the amplitudes of the nodes .",
    "for example , for the quantum bayesian net of fig.[fig - diamond - graphs](a ) , one has    a(x_1,x_2,x_3,x_4 ) = a(x_4|x_2,x_3)a(x_3|x_1)a(x_2|x_1)a(x_1 ) , where @xmath115 for @xmath116 .",
    "a * classical ( ditto , quantum ) markov network * is an ug with labelled nodes ( let @xmath110 be the labels ) , together with an affinity @xmath117 ( ditto , @xmath118 ) associated with each super - clique @xmath119 of the graph .",
    "the probability ( ditto , probability amplitude ) of the whole net is defined as the normalized product of the affinities of the super - cliques of @xmath79 .",
    "for example , for the quantum markov net of fig.[fig - diamond - graphs](b ) , one has    a(x_1,x_2,x_3,x_4 ) = , where @xmath115 for @xmath116 .",
    "we will sometimes use @xmath120 to denote a bayesian ( ditto , markov ) network associated with a dag ( ditto , ug ) @xmath79 .",
    "next , we review some basic definitions from information theory@xcite .",
    "first consider classical physics .",
    "for any @xmath121 , the * entropy * ( a measure of the variance of @xmath122 ) is defined by    h ( ) = -_x p(x)p(x ) .",
    "sometimes the entropy is denoted instead by @xmath123 .",
    "cmi ( usually pronounced ",
    "see - me \" ) stands for  conditional mutual information \" . for @xmath124 , the * cmi * ( a measure of conditional information transmission )",
    "is defined by    h(:|)= _ x , y , e p(x , y , e ) . in general , @xmath125 . when @xmath126 , cmi degenerates into the * mutual information * @xmath127 .",
    "note that    h(:|)&= & _ x , y , e p(x , y , e ) + & = & h ( , ) + h ( , ) - h ( , , ) - h ( ) .",
    "[ eq - h - cmi - expanded ] classical cmi satisfies the chain rule    h(:_1,_2|)= h(:_1|_2,)+ h(:_2| ) .",
    "now consider quantum physics .",
    "for @xmath69 , the * entropy * is defined by    s ( ) = -_x ( _ _ ) .",
    "sometimes the entropy is denoted instead by @xmath128 or by @xmath129 , where @xmath130 is a traced dm - extension of @xmath72 . for @xmath131 ,",
    "the * cmi * is defined by analogy to eq.([eq - h - cmi - expanded ] ) :    s(:|)= s ( _ , ) + s ( _ , ) - s ( _ , , ) - s ( _ ) . in general , @xmath132 ( this is known as the strong subadditivity of quantum entropy ) .",
    "sometimes the cmi is denoted instead by @xmath133 , where @xmath130 is a traced dm - extension of @xmath134 .",
    "when @xmath126 , cmi degenerates into the * mutual information * @xmath135 . just like classical cmi , quantum cmi satisfies the chain rule    s(:_1,_2|)= s(:_1|_2,)+ s(:_2| ) .",
    "[ eq - quant - cmi - chain - rule ]    given @xmath136 , the * cmi entanglement * ( an information theoretic measure of quantum entanglement ) is defined as    e^cmi(:)= _ _ , , k ( s__,,(:| ) ) , where the infimum ( a generalized minimum ) is taken over the set @xmath119 of all density matrices @xmath131 such that @xmath137 .",
    "sometimes , the cmi entanglement is denoted instead by @xmath138 , or by @xmath139 , where @xmath130 is a traced dm - extension of @xmath140 .",
    "cmi entanglement is also known by the less scientific name of  squashed entanglement \" . for more information about cmi entanglement ,",
    "see ref.@xcite .",
    "if we apply the definition of cmi entanglement to the right hand side of eq.([eq - quant - cmi - chain - rule ] ) , we get    s(:_1,_2|)2e^cmi(:_1 ) + 2e^cmi(:_2 ) .",
    "now we are free to apply the definition of cmi entanglement to the left hand side of the previous equation to get :    e^cmi(:_1,_2)e^cmi(:_1 ) + e^cmi(:_2 ) .",
    "[ eq - synerg ] eq.([eq - synerg ] ) can be called * super - additivity of the right side argument of @xmath141*. since entanglement is symmetric ( i.e. , @xmath142 ) , there is also * super - additivity of the left side argument @xmath141*. eq.([eq - synerg ] ) can also be called the * synergism of entanglement * , because the whole has more entanglement than the sum of its parts .",
    "if the inequality in eq.([eq - synerg ] ) were in the opposite direction , we could call it * sub - additivity * or * anti - synergism*.",
    "in this section , we define meta density matrices , and purifications of density matrices .",
    "we show that any density matrix has a purification .",
    "a pure density matrix @xmath143 of the form @xmath144 will be called a * meta density matrix*. if @xmath145 is the full joint amplitude associated with a bayesian or markov network @xmath120 , we will call @xmath146 the * meta density matrix of the network @xmath120*.    suppose @xmath40 and @xmath147 . given a density matrix @xmath148",
    ", we will call any pure density matrix @xmath149 such that @xmath150 , a * traced purification of @xmath130*. more generally , if @xmath151 where the operator @xmath152 is not a trace operator , we will call @xmath146 a * generalized purification of @xmath130*.    crucial to this paper is the well known fact that any density matrix has a traced purification .",
    "next , we will present a proof of this fact .",
    "our proof is a nice showcase of bayesian net ideas and of our notation .",
    "consider any @xmath153 .",
    "let    = _ x , x ( x , x ) .",
    "let @xmath154 be the matrix with entries @xmath155 , where @xmath156 labels its rows and @xmath157 its columns .",
    "@xmath154 is a hermitian matrix so it can be diagonalized .",
    "let @xmath158 , where @xmath159 is a unitary matrix , and @xmath160 is a real , diagonal matrix . set @xmath161 and @xmath162 , where @xmath163 . then    ( x , x ) = _ j a(x|j ) |a|^2(j ) a^*(x|j ) . if we define    = _ x , j a(x|j)a(j ) , then    = _ ( ) . a bayesian net representation of the previous equation is = ( ) .",
    "the @xmath164 over the @xmath165 is intended to indicated that node @xmath165 should be traced over .",
    "note that the eigenvectors of @xmath130 become the transition amplitudes of node @xmath105 , whereas the square root of the eigenvalues of @xmath130 become the amplitudes of node @xmath165 .",
    "we ve shown that any density matrix @xmath130 has a traced purification @xmath146 .",
    "thus , without loss of generality , we need only consider meta density matrices @xmath146 and those density matrices obtained by applying measurement operators to @xmath146 . in this section ,",
    "we describe a ",
    "complete \" set of measurement operators that can be applied to a meta density matrix to obtain all measurable probabilities codified within it .",
    "first , consider classical physics .",
    "in particular , consider @xmath37 random variables @xmath52 described by a probability distribution @xmath166 .",
    "suppose    = z_visz_sum , [ eq - zn - is - vis - and - sum ] where @xmath167 and @xmath168 are disjoint sets . here",
    " vis \" stands for  visible \" and  sum \" for  summed \" .",
    "the probability that @xmath169 is defined as    p ( ) = _ p(x . ) .",
    "@xmath167 can also be spilt into two parts .",
    "let    z_vis = z_postz_pre , [ eq - zvis - parts ] where @xmath170 and @xmath171 are disjoint sets .",
    "the conditional probability that @xmath172 given @xmath173 is defined as    p(| ) = . the conditional expected value ( a.k.a .",
    "conditional expectation ) of any complex valued function @xmath174 of the random variable @xmath175 is defined as :    e[f()| = ] = _ f ( ) p(| ) .",
    "[ eq - cl - expect ]    visible ( either pre or post viewed ) and hidden nodes will be indicated on a bayesian network by the node decorations show in fig.[fig - slot - symbols ]    next , consider quantum physics .",
    "in particular , consider @xmath37 random variables @xmath52 described by a pure state    = _",
    "x. a(x . ) , or , equivalently , by the meta density matrix    = =( ) .",
    "our next goal is to generalize the classical physics definitions eqs.([eq - zn - is - vis - and - sum ] ) to ( [ eq - cl - expect ] ) to quantum physics .",
    "let    = z_vis z_sum , z_sum = z_asum z_psum , where @xmath167 , @xmath176 and @xmath177 are disjoint sets . here ",
    "asum \" stands for  amplitude summed \" and  psum \" stands for  probability summed \" .",
    "the probability that @xmath169 is defined as    p()_\\ = .",
    "[ eq - q - pvis - amp ] note that , contrary to the classical physics case , this probability depends on which random variables are summed coherently ( a summed ) and which are summed incoherently ( p summed ) .",
    "we ve indicated this dependence by the subscript @xmath178 .",
    "the backslash in this notation is intended to evoke a mental picture of the diagonal of a matrix , because the variables that are p summed are",
    " diagonalized \" ( why we say these variables are diagonalized will become clear to the reader later on , once he sees eq.([eq - qprob - diag - op ] ) ) . as in the classical physics case ,",
    "let    z_vis = z_postz_pre , where @xmath170 and @xmath171 are disjoint sets .",
    "the conditional probability that @xmath172 given @xmath173 is defined , in analogy to the classical physics case , by    p(| ) _ \\ = .",
    "[ eq - q - cond - prob ] consider a hermitian operator @xmath179 acting on @xmath180 .",
    "suppose @xmath181 are the eigenstates of @xmath179 , so that    _ = _ _ . in analogy to the classical physics case , one defines the conditional expected value of @xmath179 by    e[_| = ] _ \\ = _ _ p(| ) _ \\ .    at this point",
    ", we have achieved our goal of generalizing the classical physics definitions eqs.([eq - zn - is - vis - and - sum ] ) to ( [ eq - cl - expect ] ) to quantum physics . in doing so",
    ", we ve introduced the probability @xmath182 .",
    "the rest of this section will be devoted to explaining how this probability can be measured .    to measure @xmath182 instead of @xmath183 ,",
    "one restricts the range of the random variable @xmath184 to the single value @xmath185 .",
    "of course , one must also divide (  normalize \" ) the restricted meta density matrix by a constant so that its trace remains 1 .",
    "next , we show how to measure @xmath183 .",
    "note that @xmath186 given by eq.([eq - q - pvis - amp ] ) can be expressed as the expected value , in the meta density matrix @xmath146 , of a projection operator @xmath187 :    p()_\\ = .",
    "[ eq - quant - prob - as - exp - of-3projs ] the projection operator @xmath187 consists of a product of 3 mutually commuting projection operators defined by    ^(a ) = ( ) ,    ^(b ) = ( ) , and    ^(c ) = _ ( ) . in @xmath188",
    ", we use the  average \" state vector @xmath189 , for @xmath190 .",
    "this vector is defined as    = .",
    "the fact that @xmath186 can be expressed as an expected value of a projection operator suggests one way of measuring it .",
    "suppose @xmath191 is an operator acting on @xmath192 .",
    "it is convenient at this point to define the following super - operators acting on @xmath191 :    e_=x ( _ , ) = _ , ,    e _",
    "( _ , ) = _ x , x _ , ,    _ ( _ , ) = _ x _ , ,    _ ( _ , ) = _ x _ , .",
    "we ve shown in parenthesis on the right hand side what we call these operators .",
    "note that @xmath193 diagonalizes @xmath191 partially .",
    "@xmath194 diagonalizes it fully . to be a function that takes a vector @xmath195 and returns a diagonal matrix with @xmath195 along its diagonal .",
    "here we are defining a different @xmath196 function .",
    "both of these functions return a diagonal matrix , but they have different domains .",
    "we will use the symbol @xmath196 for both of these functions .",
    "which function we mean will be clear from the context . ]",
    "note that @xmath197 for @xmath198 .",
    "on the other hand ,    e__= _ .",
    "[ eq - esig - diag ] fig.[fig - meas - symbols ] gives node decorations that will be used to indicate these operators when acting on a bayesian network .    in eq.([eq - quant - prob - as - exp - of-3projs ] ) , we obtained @xmath186 as an expected value of a projection operator .",
    "alternatively , @xmath186 can be obtained by successive applications of the operators @xmath199 , @xmath200 , @xmath201 , and @xmath202 to @xmath146 :    [ eq - quant - prob - as - meas - of - mu ] p()_\\ & = & + & = & .",
    "[ eq - qprob - diag - op ] eq.([eq - qprob - diag - op ] ) follows from eq.([eq - esig - diag ] ) . here",
    ", the operators @xmath199 , @xmath200 , @xmath201 , and @xmath202 can be interpreted as measurements ( or lack thereof ) of the density matrix they act upon . numerically .",
    "conditioning on @xmath173 is already implemented in the current version , 2.0 , of quantum fog ; it corresponds to allowing only one  active \" state for each of the nodes @xmath38 for @xmath203 . on the other hand ,",
    "only a special case of the distinction between p - summed and a - summed is implemented in version 2.0 . in version 2.0 , @xmath204 is always assumed to equal the set of external nodes minus the set of visible ones .",
    "more general sets @xmath204 will be implemented in future versions of quantum fog . ]    in eqs.([eq - quant - prob - as - meas - of - mu ] ) , @xmath205 means observe ( = measure ) the random variable @xmath204 , and then forget the outcome .",
    "@xmath206 means measure of the random variable @xmath175 once .",
    "@xmath207 means do no observe the random variable @xmath208 .",
    "it remains for us to interpret @xmath209 as a measurement .    for any density matrix @xmath210 ,",
    "the operator @xmath211 is what is called a von neumann measurement .",
    "it can be implemented physically in two steps : ( 1 ) measure the random variable @xmath105 ; if the outcome is @xmath212 , emit @xmath213 , and ( 2 ) repeat the measurement many times , without discriminating on any of the outcomes ( mathematically , this corresponds to summing over the outcomes @xmath212 of the measurements ) .",
    "a second way of implementing @xmath211 is as follows .",
    "the bayesian net ( ) ( ) with transition matrix @xmath214 can be replaced by a bayesian net ( )()()with transition matrix @xmath215 , where @xmath216 @xmath217 .",
    "assume that the variables @xmath218 are i.i.d .",
    "( independent , identically distributed ) classical random variables , and each is uniformly distributed over @xmath219 $ ] .",
    "let an overline denote an average over these variables .",
    "an effect of adding the node @xmath220 to the network is that we must replace    _",
    ", = _ x , y , x,y _ xy , xy by    _ ^,=_x , y , x,y _ xy , xy e^i_x e^-i_x .",
    "clearly ,    = _ _ , , and , one has @xmath221 , but this is not a show stopper , since the density matrix only enters linearly in the formula for the expected value of any observable . ]",
    "= _ = _ , for any operator @xmath152 acting on @xmath192 .",
    "thus , the operator @xmath211 can be implemented physically merely by taking many measurements for which @xmath222 varies randomly .",
    "a third way of implementing @xmath211 is by adding an additional node that is traced over .",
    "for example , suppose @xmath223 can be expressed in the form    _ = _ ( ) , = ( _ x a(x ) ) .",
    "[ eq - diag - begone - bef - x ] we can introduce a node @xmath165 such that @xmath224 and @xmath225",
    ". then    _ = tr _",
    "( ) , = ( _ x , j ^x_j a(j ) ) .",
    "[ eq - diag - begone - aft - x ] @xmath146 is a generalized purification of @xmath72 whereas @xmath226 is a traced one . by expressing @xmath72 in terms of @xmath226 instead of @xmath146 ,",
    "we get rid of the @xmath211 operator at the expense of adding an additional node @xmath165 that we trace over .",
    "a bayesian network representation of the essence of eqs.([eq - diag - begone - bef - x ] ) and ( [ eq - diag - begone - aft - x ] ) is :    = ( ) . as a more general example of this method of implementing @xmath227 , suppose @xmath228 can be expressed in the form    _ , = _ ( ) , = ( _ y , xa(y|x)a(x ) ) .",
    "[ eq - diag - begone - bef - yx ] once again , introduce a node @xmath165 such that @xmath224 and @xmath225 .",
    "then    _ , = _ ( ) , = ( _ y , x , j a(y|x)^x_j a(j ) ) , [ eq - diag - begone - aft - yx ] a bayesian network representation of the essence of eqs.([eq - diag - begone - bef - yx ] ) and ( [ eq - diag - begone - aft - yx ] ) is :    ( ) = ( ) ( ) .",
    "the schmidt decomposition is very popular in the quantum information theory literature . as an illustration of the use of the entry - sum operator @xmath229 ,",
    "let us consider the schmidt decomposition from the point of view of bayesian networks .",
    "the schmidt decomposition is the statement that given a pure state @xmath230 of the form    _ 1 = ( _ x , y a(x , y ) ) , the coefficients @xmath231 can be expressed in the form    a(x , y ) = _ j a(x|j ) a(y|j)a(j ) , [ eq - basic - schmidt ] where @xmath232 , @xmath233 , @xmath234 , @xmath235 .",
    "the fact that any @xmath231 can be expressed in the form given by eq.([eq - basic - schmidt ] ) is a re - statement of the singular value decomposition theorem .",
    "this is why .",
    "let @xmath154 be the matrix with entries @xmath231 , where @xmath156 labels its rows and @xmath236 its columns . according to the singular value decomposition theorem ,",
    "@xmath154 can be expressed in the form @xmath237 , where @xmath159 and @xmath81 are unitary matrices and @xmath160 is a non - negative , diagonal matrix . if we let @xmath161 , @xmath238 , @xmath239 , then eq.([eq - basic - schmidt ] ) follows .    to obtain a bayesian net picture of the schmidt decomposition ,",
    "note that if we define @xmath240 by    _ 2 = ( _ x , y , j a(x|j ) a(y|j)a(j ) ) , then    e _",
    "( _ 2)&= & ( _ x , y , j a(x|j ) a(y|j)a(j ) ) + & = & _ 1 .",
    "[ eq - bnet - schmidt ]    eq.([eq - bnet - schmidt ] ) is illustrated by fig.[fig - schmidt ] .",
    "eq.([eq - bnet - schmidt ] ) gives an example of the use of the entry - sum operator @xmath229 .",
    "note that this operator takes a pure state of tensor rank @xmath241 into a pure state of tensor rank @xmath242 .",
    "indeed ,    e _",
    "( _ x , aa(x , a))= ( _ x , aa(x , a ) ) .",
    "@xmath229 also takes a pure state of tensor rank @xmath243 into a non - negative number . indeed , for @xmath244 ,    e _ = |_a|^2 .    note that when @xmath245 , the entry - sum operator @xmath246 equals the entry operator @xmath247 .",
    "thus , @xmath247 can be viewed as a special case of @xmath246 .",
    "it s clear that @xmath247 inherits from @xmath246 the property that : it takes a pure state of tensor rank @xmath241 into a pure state of tensor rank @xmath242 , and it takes a pure state of tensor rank @xmath243 into a non - negative number .",
    "suppose @xmath248 is a pure density matrix , and @xmath130 is a density matrix , and @xmath249 , where @xmath250 and @xmath251 .",
    "we ve shown that @xmath252 , and @xmath253 both take a pure density matrix to another pure density matrix , so one can easily find a pure density matrix @xmath254 such that @xmath255 , where @xmath256 and @xmath257 .",
    "we ve shown that each operator @xmath258 can be traded for an extra node that is traced over .",
    "thus , one can easily find a pure density matrix @xmath259 such that @xmath260 , where @xmath261 . to summarize , given a generalized ( i.e , made with entry , entry - sum , trace and diag operators ) purification of @xmath130 , one can easily find a traced purification of @xmath130 .",
    "a generalized purification of @xmath130 might be convenient for certain purposes , but not for others .",
    "luckily , it can be easily replaced by a traced one .",
    "in this section , we define conditional amplitudes .",
    "these are a natural generalization of conditional probabilities .",
    "consider a meta density matrix @xmath144 its complex amplitude @xmath145 can be parameterized as    a(x . )",
    "= e^i(x.)(x . ) , where the @xmath262 are real and @xmath263 .",
    "choose an arbitrary state of @xmath51 , and call it the * reference state * @xmath264 .",
    "it is convenient to constrain @xmath262 by assuming that it vanishes at the reference state :    ( x.^o)=0 . for @xmath40 and @xmath265",
    ", we define    ( ) = ( , ) ,    p()= _ p(x . ) , and    a ( ) = e^i ( ) ( ) .    for disjoint sets @xmath266",
    ", we define    ( |)= ( , ) - ( ) ,    p(|)= , and    a(|)= .",
    "note that ( |)=0 ,    phase ( ) = ( x.)-(y . ) , and    ( x. ) = phase ( ) .",
    "this section , divided into 3 subsections , explores the notion of conditional independence in both classical and quantum physics .",
    "henceforth , by an * independency * , we will mean a triplet @xmath267 , where @xmath268 are disjoint .",
    "( if @xmath7 and @xmath119 are disjoint but overlap with @xmath82 , replace @xmath267 by @xmath269 ) .",
    "if the sets @xmath7 and @xmath119 both contain more than one element , we will call it a * global independency*. if @xmath270 , we will say that @xmath267 is an * all - encompassing independency*. we will use the word * i - set * as an abbreviation for  independencies set \" ; that is , a set whose members are independencies .",
    "it is convenient to introduce a symbol for the set of all possible independencies :    ( ) = \\{i : i = ( | ) ; j , k , e } .      in this section ,",
    "we define classical conditional independence and three quantum analogues of it , type - a , type - cmi , and type- .",
    "consider first classical physics and probability .",
    "let @xmath268 be disjoint sets .",
    "we say @xmath44 and @xmath31 are * conditionally independent * given @xmath271 iff    p ( , | ) = p(| ) p(| ) , , .",
    "[ eq - prob - cond - indep ] eq.([eq - prob - cond - indep ] ) is clearly equivalent to requiring that    p(| , ) = p(| ) , or    p(| , ) = p(| ) .we define the function @xmath272 by the statement : @xmath273 is true iff eq.([eq - prob - cond - indep ] ) is true",
    ". think of @xmath274 as a  truth function \" that decides whether its argument is false=0 or true=1 .",
    "in classical physics , conditional independence and vanishing cmi are equivalent . indeed ,    [ th - class - cmi ] h(:)=0 p(x , y)= p(x)p(y ) x ,",
    "y , and h(:|)=0 p(x , y|e)= p(x|e)p(y|e ) x , y , e .    the proof can be found in ref.@xcite .",
    "now consider quantum physics .",
    "our goal is to find the quantum counterpart of eq.([eq - prob - cond - indep ] ) and theorem [ th - class - cmi ] .",
    "consider a meta density matrix @xmath144 .",
    "let @xmath268 be disjoint sets .",
    "we say @xmath44 and @xmath31 are * type - a conditionally independent * given @xmath271 iff    a ( , | ) = a(| ) a(| ) , , .",
    "[ eq - amp - cond - indep ] we say @xmath44 and @xmath31 are * type - cmi conditionally independent * given @xmath271 iff s _",
    "( : | ) = 0 .",
    "[ eq - cmi - cond - indep ] ( note that we trace over all random variables @xmath275 such that @xmath276 ) .",
    "we say @xmath44 and @xmath31 are * type - conditionally independent * given @xmath271 iff s _ _",
    "( ) ( : | ) = 0 . [ eq - cmip - cond - indep ]    we define the function @xmath277 by the statement : @xmath278 is true iff eq.([eq - amp - cond - indep ] ) is true . likewise , @xmath279 iff eq.([eq - cmi - cond - indep ] ) . likewise , @xmath280 iff eq.([eq - cmip - cond - indep ] ) .    in classical physics ,",
    "type - a and type - cmi conditional independence are equivalent , but in quantum physics , neither one implies the other",
    ". we will give counterexamples of this later .",
    "but first , we will give easy - to - check necessary and sufficient conditions for a vanishing quantum cmi .",
    "for @xmath210 ,    s__(:)=0 _ = _ _ , [ eq - q - indep - nec - suf ] where @xmath72 and @xmath281 are partial traces of @xmath282 . for @xmath283 ,    s__(:|)=0",
    "_ = _ e w(e ) _",
    "^(e)_^(e ) , [ eq - q - cond - indep - nec - suf ] where @xmath284 , and , for all @xmath285 , @xmath286 , @xmath287 .",
    "eq.([eq - q - cond - indep - nec - suf ] ) implies eq.([eq - q - indep - nec - suf ] ) .",
    "proving @xmath288 for eq.([eq - q - cond - indep - nec - suf ] ) is a simple calculation .",
    "it was pointed out in ref .",
    "proving @xmath289 for eq.([eq - q - cond - indep - nec - suf ] ) is much more technical . a weak version of it was proven in ref.@xcite .",
    "the strong version presented here was first proven in ref.@xcite .",
    "[ th - icmi - iff ] consider a meta density matrix @xmath144 .",
    "suppose @xmath290 are disjoint sets , @xmath291 , and @xmath292 .",
    "let @xmath293 .",
    "@xmath294 iff @xmath295    _ = w ( ) ^()_1 ( , ) ^()_2 ( , ) , [ eq - tau - cmi - p - equiv ] where @xmath296 , and where , for @xmath297 , @xmath298 , @xmath299 .",
    "define @xmath130 by    & = & _ _ + & = & _ _ _ .",
    "+ & & [ eq - rho - def - for - tau - cmi - p ] @xmath294 is equivalent to @xmath300 .    recall that for any @xmath301 ,    s__sol(:|)=0 _ sol= _ w ( ) _ ^ ( ) _ ^ ( ) .",
    "[ eq - s - rho - sol ]    ( @xmath289 ) by setting @xmath130 equal to @xmath302 , we prove eq.([eq - tau - cmi - p - equiv ] ) .",
    "( @xmath288)by plugging eq.([eq - tau - cmi - p - equiv ] ) into eq.([eq - rho - def - for - tau - cmi - p ] ) , we show that @xmath130 satisfies the right hand side of eq.([eq - s - rho - sol ] ) , so it satisfies the left hand side of the same equation .",
    "we are finally ready to prove that for type - a and type - cmi conditional independence , neither one of these implies the other .",
    "suppose @xmath290 are disjoint sets , and @xmath293 .",
    "@xmath303 and @xmath304 .",
    "also , @xmath305 and @xmath306 .",
    "also , @xmath307 .",
    "let @xmath291 , and @xmath292 . for our counterexamples",
    ", we will assume @xmath308 , @xmath309 , @xmath310 , where @xmath311 are boolean variables .",
    "we will take @xmath312 , and indications of any dependence on @xmath313 will be suppressed .",
    "we will take @xmath314 to be our reference state ( i.e. , the state @xmath315 for which @xmath316 .",
    "we will abbreviate @xmath317 by @xmath318 .",
    "@xmath307 is obvious .",
    "since we will assume @xmath312 , our example of @xmath305 will also prove @xmath303 .",
    "likewise , our example of @xmath306 will also prove @xmath304 .",
    "( * proof of @xmath319 * ) assume    \\ {    l a(x_1,x_2,a ) = _",
    "x_1,x_2 ^ 1,1 + _",
    "x_1,x_2,a = _ x_1,x_2,a^1,1,0 , -2    . .",
    "this @xmath320 satisfies    _ a = _",
    "x_1,x_1 ^ 1,1 _",
    "x_2,x_2 ^ 1,1 .",
    "therefore , @xmath294 is true .",
    "this @xmath320 also satisfies    \\ {    l a(x_1,x_2 ) = _",
    "x_1,x_2 ^ 1,1 e^i_110 = ^1,1_x_1,x_2e^i + a(x_1 ) = _",
    "x_1 ^ 1 e^i_100 = ^1_x_1 + a(x_2 ) = _",
    "x_2 ^ 1 e^i_010 = ^1_x_2    . .",
    "hence a(x_1,x_2)a(x_1)a(x_2 ) , which means @xmath321 is false .",
    "( * proof of @xmath322 * ) assume    \\ {    l a(x_1,x_2,a ) = + _ x_1,x_2,a = _ x_1,x_2,a^1,1,1 , -2    . .",
    "this @xmath320 satisfies    \\ {    l a(x_1,x_2 ) = = + a(x_1 ) = = + a(x_2 ) = =    . .",
    "therefore ,    a(x_1,x_2)= a(x_1)a(x_2 ) , which means @xmath321 is true .",
    "this @xmath320 also satisfies    _ a = .",
    "[ eq - a - biprod - eg ] let s show that assuming @xmath294 leads to a contradiction .",
    "theorem [ th - icmi - iff ] implies ( i ) and eq.([eq - a - biprod - eg ] ) implies ( ii ) in the following :    phase[_1(0,0)_2(1,0 ) ] phase ( _ a ) 0 , and    phase[_1(1,1)_2(1,0 ) ] phase ( _ a ) phase ( 1 + e^i ) .",
    "since @xmath323 and @xmath324 are supposed to be real , the right hand sides of the two previous equations are supposed to be equal .",
    "they arent  a contradiction .",
    "there is , however , one subset of @xmath325 over which @xmath326 and @xmath327 agree .",
    "[ th - tau - a - tau - cmip - connection ] suppose @xmath290 are disjoint sets , and @xmath293 . if @xmath328 , then @xmath329 .    according to theorem [ th - icmi - iff ] , @xmath294 is equivalent to :",
    "= w ( ) ^()_1 ( , ) ^()_2 ( , ) , where @xmath330 is a probability distribution , and for @xmath331 , @xmath298 , @xmath332 are density matrices .",
    "@xmath321 , on the other hand , is equivalent to    a ( , , ) = a(| ) a(| ) a ( )",
    ". clearly , @xmath321 implies @xmath294 . to show that @xmath294 implies @xmath321 ,",
    "define @xmath333 , @xmath334 , and , for @xmath331 , @xmath335 .",
    "consider the following * reduction and combination rules * for independencies :    1 .   *",
    "( decomposition/@xmath336)*@xmath337 2 .   *",
    "( weak union/@xmath338)*@xmath339 3 .   *",
    "( contraction/@xmath340)*@xmath341 and @xmath342 4 .   * ( intersection/@xmath343)*@xmath344 and @xmath341 and @xmath345    the function @xmath346 remains to be specified .",
    "@xmath347 stand for mutually exclusive n - tuples of the form @xmath31 for some @xmath348 .",
    "rules @xmath349 and @xmath350 perform a  reduction \" whereas @xmath351 and @xmath352 perform a  combination \" .",
    "an independency @xmath353 has 3 slots . in the above rule statements",
    ", we ve denoted all random variables in the second slot ( slot-2 ) by the letter @xmath354 with a subscript .",
    "the above rule statements start with the rule name , in parenthesis . within the parenthesis , to the left of the slash",
    "is the name given by judea pearl in ref.@xcite .",
    "to the right of the slash is a new name , first given in this paper . in the new rule names",
    ", the symbol @xmath355 stands for implication , and there is one number , indicating the number of @xmath354 s in slot-2 , for each independency .",
    "for example , in rule @xmath356 , there are : one @xmath354 in slot-2 of the first independency , one @xmath354 in slot-2 of the second independency , two @xmath354 s in slot-2 of the third independency .",
    "the prime in @xmath357 indicates that , besides there being one @xmath354 in slot-2 , there also is one @xmath354 in slot-3 .",
    "note that in rule ( d ) above , we specify that @xmath358 .",
    "that s because , as we shall see , this rule arises from one of those unusual cases , mentioned earlier , in which dividing by a probability causes trouble .",
    "later on , we will state and prove theorems whose proof assumes rule ( d ) .",
    "the fact that such theorems assume rule ( d ) will show up in that they inherit @xmath358 as one of their premises .",
    "next we will show that the reduction and combination rules are obeyed by @xmath326 and @xmath359 .",
    "[ eq - class - irules ] the above reduction and combination rules are true in classical physics with @xmath360 .",
    "the classical cmi satisfies    ^h_1= ^h_2 + ^h_3 .",
    "permuting @xmath361 and @xmath362 in the previous equation yields    ^h_4= ^h_5 + ^h_6 .",
    "recall that the cmi is non - negative .",
    "* proof of ( a)(@xmath336):@xmath363 .",
    "* proof of ( b)(@xmath338):@xmath364 .",
    "* proof of ( c)(@xmath340):@xmath365 .",
    "* proof of ( d)(@xmath343 ) : we want to show that @xmath366 .",
    "why would this be ? @xmath367 and @xmath368 imply , respectively , p(x , y_1,y_2,e ) = p(x|y_2,e)p(y_1|y_2,e)p(y_2,e ) , [ eq - prob - x - y1-y2-e ] and + p(x , y_1,y_2,e ) = p(x|y_1,e)p(y_2|y_1,e)p(y_1,e ) .",
    "[ eq - prob - x - y2-y1-e ] we can equate the right hand sides of the two previous equations , and then divide both sides of the resulting equation by @xmath369 ( here we use @xmath358 ) .",
    "this yields ( i ) below . since we can vary @xmath361 and @xmath362 independently in equation ( i ) below , equation ( ii ) follows .",
    "+ p(x|y_1,e ) p(x|y_2,e ) p(x|e ) .",
    "[ eq - x - indep - y1-y2 ] combining eqs.([eq - prob - x - y1-y2-e ] ) and ( [ eq - x - indep - y1-y2 ] ) then yields , + p(x , y_1,y_2 , e ) = p(x|e)p(y_1,y_2,e ) , which , in turn , yields + p(x , y_1,y_2| e ) = p(x|e)p(y_1,y_2|e ) .",
    "the above reduction and combination rules are true in quantum physics with @xmath370 .",
    "* proof of ( a)(@xmath336 ) : the premise is that + a(x , y_1,y_2|e ) = a(x|e ) a(y_1,y_2|e ) .",
    "[ eq - type - a - rule - a - probs ] eq.([eq - type - a - rule - a - probs ] ) implies + p(x , y_1,y_2|e ) = p(x|e ) p(y_1,y_2|e ) . summing both sides of the previous equation over @xmath361 yields + p(x ,",
    "y_2|e ) = p(x|e ) p(y_2|e ) .",
    "[ eq - prob - x - y2-at - e ] eq.([eq - type - a - rule - a - probs ] ) also implies + ( x , y_1,y_2|e ) = ( x|e ) ( y_1,y_2|e ) .",
    "[ eq - type - a - rule - a - theta ] if , in the previous equation , we set @xmath361 to its reference state @xmath371 , we get + ( x , y_2|e ) = ( x|e ) ( y_2|e ) .",
    "[ eq - theta - x - y2-at - e ] combining eqs.([eq - prob - x - y2-at - e ] ) and ( [ eq - theta - x - y2-at - e ] ) yields + a(x , y_2|e ) = a(x|e ) a(y_2|e ) .",
    "* proof of ( b)(@xmath338 ) : one has + a(x|y_1,y_2,e ) a(x|e ) a(x|y_2,e ) .",
    "( i ) follows from the premise @xmath372 .",
    "plugging the premise into rule ( a)@xmath373 gives ( ii ) .",
    "* proof of ( c)(@xmath340 ) : one has + a(x|y_1,y_2,e ) a(x|y_2,e ) a(x|e ) .",
    "( i ) follows from the part @xmath374 of the premise .",
    "( ii ) follows from the other part @xmath375 of the premise .",
    "* proof of ( d)(@xmath343 ) : the premise is that a(x|y_1,y_2,e ) = a(x|y_2,e ) , [ eq - type - a - rule - b - premise-1 ] and + a(x|y_1,y_2,e )",
    "= a(x|y_1,e ) . thus , if @xmath376 , + a(x|y_2,e)=a(x|y_1,e)=a(x|e ) .",
    "[ eq - type - a - rule - b - compare ] combining eqs.([eq - type - a - rule - b - premise-1 ] ) and ( [ eq - type - a - rule - b - compare ] ) now yields + a(x|y_1,y_2,e ) = a(x|e ) .    exercise for reader : find out whether @xmath377 and @xmath327 satisfy the reduction and combination rules .      in this section ,",
    "we define certain * probabilistic i - sets * ; that is , i - sets whose members are defined in terms of a probability distribution ( or a meta density matrix ) .",
    "first consider classical physics .",
    "for any @xmath378 , define    \\(p ) = \\ { i : i= ( | ) ; j , k , e ; ^p(i ) } .",
    "next consider quantum physics .",
    "for any meta density matrix @xmath143 of the form @xmath144 , let ( a ) = \\ { i : i= (     for @xmath379 , when we say that an * i - set @xmath380 is satisfied by @xmath381 * , we will mean that @xmath382 for all @xmath383 ( or , equivalently , @xmath384 ) .",
    "in this section , we show that any probability distribution can be represented by a fully connected dag .",
    "we also show that any quantum density matrix can be represented by a fully connected dag . in classical and quantum physics , omitting certain arrows from this fully connected graph indicates certain probabilistic independencies .      in this section ,",
    "we define a chain rule and factorization according to a dag , both for classical and quantum physics .",
    "first consider classical physics .",
    "let @xmath385 .",
    "for @xmath386 , the @xmath122 chain rule is    _ 7 = _ 4 _ 2 _ 1 . [ eq - cla - chain - rule - n3 ] we have indicated under each conditional probability the number of degrees of freedom that it holds , assuming that @xmath387 . for arbitrary @xmath37 ,",
    "the @xmath122 chain rule is    p(x . ) = _ j=1^n",
    "[ eq - cla - chain - rule ]    now consider quantum physics .",
    "suppose @xmath143 is a meta density matrix of the form @xmath144 .",
    "in analogy to eq.([eq - cla - chain - rule - n3 ] ) , we would like the @xmath388 chain rule for @xmath386 to be    a(x_3,x_2,x_1 ) = a(x_3|x_2,x_1 ) a(x_2|x_1 ) a(x_1 ) .",
    "[ eq - qua - chain - rule - n3 ]    the @xmath122 chain rule eq.([eq - cla - chain - rule - n3 ] ) was stated without proof , because the equation is well known , and very easy to prove . on the other hand , the @xmath388 chain rule eq.([eq - qua - chain - rule - n3 ] )",
    "is new , so we prove it next .    from various definitions in section [ sec - cond - amp ] , we get    [ eq-3-cond - theta ] ( x_3|x_2,x_1 ) = ( x_3,x_2,x_1)- ( x^o_3,x_2,x_1 ) ,    ( x_2|x_1 ) = ( x^o_3,x_2,x_1)- ( x^o_3,x^o_2,x_1 ) , and    ( x_1 ) = ( x^o_3,x^o_2,x_1)- ( x_3^o , x^o_2,x^o_1 ) . summing eqs.([eq-3-cond - theta ] ) ( more precisely , equating the sum of the left hand sides of eqs.([eq-3-cond - theta ] ) to the sum of the right hand sides ) yields    ( x_3|x_2,x_1)+ ( x_2|x_1)+ ( x_1)= ( x_3,x_2,x_1 ) .",
    "[ eq - qua - theta - rule - n3 ] the previous equation , and the @xmath122 chain rule , together imply :    _ 7 _ 7 = _ 4 _ 4 _ 2 _ 2 _ 1 _ 1 .",
    "we have indicated under each quantity the number of degrees of freedom it holds , assuming @xmath387 .",
    "the previous equation is equivalent to eq.([eq - qua - chain - rule - n3 ] ) , which we set out to prove . for arbitrary @xmath37 , eq.([eq - qua - theta - rule - n3 ] ) generalizes to    ( x. ) = _ j=1^n ( x_j | ) . the previous equation , and eq.([eq - cla - chain - rule ] ) ( the @xmath122 chain rule ) , together imply the @xmath388 chain rule :    a(x . ) = _ j=1^n",
    "[ eq - qua - chain - rule ]    note that the conditional amplitudes @xmath389 used above have * constrained phases ( cp ) * , meaning that their phases are subject to the constraint that @xmath390 be real for all @xmath391 .",
    "let @xmath154 be the matrix with entries @xmath389 , with the rows of @xmath154 labelled by the states of @xmath38 and the columns labelled by the states of @xmath392 .",
    "cp means that @xmath154 must have one row ( the one with @xmath393 ) consisting entirely of real numbers . on the other hand ,",
    "quantum fog allows conditional amplitudes @xmath389 with * free phases ( fp ) * , meaning that the phases of @xmath389 are arbitrary .",
    "clearly , it is often convenient , not just in quantum fog , to allow fp amplitudes .",
    "luckily , one can always replace an fp amplitude @xmath389 by a product of cp amplitudes .",
    "this is how . to simplify our notation ,",
    "let @xmath394 and @xmath395 .",
    "replace an fp amplitude @xmath396 by a product of three cp amplitudes @xmath397 and @xmath398 :    a(b|a)= _ a,a  a(b|a  ) a(a|a ) a(a|a ) , [ eq - lp - equals-3cp ] where @xmath399 .",
    "@xmath396 can be interpreted as the transition matrix of node @xmath400 in a subgraph ( ) ( ) .this subgraph is being replaced by a markov - chain graph ( ) (  ) ( )().define the following matrices :    = f , [ a(b|a  ) ] = c_1 , [ a(a|a ) ] = c_2 , [ a(a|a ) ] = c_3 .",
    "eq.([eq - lp - equals-3cp ] ) , expressed in matrix form , is    f = c_1 c_2 c_3 .",
    "suppose the first row of @xmath401 is @xmath402 $ ] , where @xmath403 .",
    "let    l c_1= f(e^-i_1,e^-i_2,,e^-i_3 , ",
    ", e^-i_n _ ) + c_2= ( 1,e^i_2,e^i_3 ,  , e^i_n _ ) + c_3= ( e^i_1,1,1 ,  , 1 )    .",
    "the matrices @xmath404 all have at least one row that consisting entirely of reals , so these matrices specify cp amplitudes .",
    "( if global phases are allowed , only 2 c s are necessary ) .",
    "we end this section by defining graphic factorization . in classical physics",
    ", we say @xmath263 * factors according to * @xmath405 iff    p(x . ) = _ j=1^n p(x_j| ) . in quantum physics , for a meta density matrix @xmath143 of the form @xmath144 , we say @xmath388 * factors according to * @xmath405 iff    a(x . ) = _ j=1^n a(x_j| ) .    by virtue of the @xmath122 ( ditto , @xmath388 ) chain rule , any probability distribution ( ditto , probability amplitude ) of @xmath52 factors according to an @xmath37-node fully - connected dag .",
    "if the probability distribution ( ditto , probability amplitude ) has higher symmetry , then it may also factor according to another @xmath37-node graph that possess fewer arrows than the fully - connected one .      in section [ sec - prob - indep ] , we defined some probabilistic i - sets .",
    "the elements of a * probabilistic i - set * are defined in terms of a probability distribution ( or a meta density matrix ) . in this section ,",
    "we define some graphic i - sets for a dag .",
    "the elements of a * graphic i - set * are defined with respect to a graph .    for @xmath405 ,",
    "we define ( loc = local , glo = global )    _ loc(g)= \\{i : i = ( _ j | ) , j } , and    _",
    "glo(g)= \\{i : i = ( | ) ; j , k , e ; ( i ) } .",
    "the function @xmath406 will be defined later on .",
    "for example , if @xmath79 is the graph of fig.[fig - diamond - graphs](a ) , then    _ loc(g)=\\ { ( _ 3 _ 2 | _ 1 ) , ( _ 4 _ 1 | _ 2 , _ 3 ) } .      in this section , we show that a probability distribution ( ditto , probability amplitude ) factors according to a dag iff the probability distribution ( ditto , probability amplitude ) satisfies a graphic i - set .    as motivation for the main theorem of this section , let @xmath79 be the dag of fig.[fig - diamond - graphs](a ) .",
    "note that @xmath407 iff @xmath408 for all @xmath409 .",
    "therefore , for the graph @xmath79 of fig.[fig - diamond - graphs](a ) , @xmath407 is equivalent to    \\",
    "{    l ^p(_3 _ 2 | _ 1 ) + ^p(_4 _ 1 | _ 2 , _ 3 )    . .",
    "[ eq - i - set - diamond - graphs ] eq.([eq - i - set - diamond - graphs ] ) is itself equivalent to    \\ {    l p(x_3|x_2,x_1)=p(x_3|x_1 ) + p(x_4|x_3 , x_2,x_1)=p(x_4|x_3,x_2 )    . .",
    "[ eq - p - reduct - diamond ] define @xmath410 and @xmath411 as the following two probability distributions of @xmath52 :    p_chain(x.)= p(x_4|x_3,x_2,x_1 ) p(x_3|x_2,x_1 ) p(x_2|x_1 ) p(x_1 ) , [ eq - p - chain - diamond ] and    p_graph(x.)= p(x_4|x_3,x_2 ) p(x_3|x_1 ) p(x_2|x_1 ) p(x_1 ) .",
    "[ eq - p - graph - diamond ] @xmath410 comes from the @xmath122 chain rule and @xmath411 from the definition of factorization according to the graph of fig.[fig - diamond - graphs](a ) . from eqs.([eq - p - reduct - diamond ] ) , ( [ eq - p - chain - diamond ] ) and ( [ eq - p - graph - diamond ] ) , it is clear that : if @xmath408 for all @xmath409 , then @xmath412 .",
    "the converse statement is also true .",
    "this is why .",
    "@xmath412 implies    p(x_4|x_3,x_2,x_1 ) p(x_3|x_2,x_1 ) = p(x_4|x_3,x_2 ) p(x_3|x_1 ) .",
    "[ eq - pchain - pgraph - diamond ] summing both sides over @xmath413 gives @xmath414 . combining this result with eq.([eq - pchain - pgraph - diamond ] ) then gives @xmath415 .",
    "thus , eqs.([eq - p - reduct - diamond ] ) are obeyed .",
    "we have just proven , albeit only for the graph of fig.[fig - diamond - graphs](a ) , the following theorem :    suppose @xmath405 and @xmath263.@xmath122 factors according to @xmath79 iff @xmath407 .",
    "the proof is a special case of the proof of the next theorem .",
    "suppose @xmath405 and @xmath143 is a meta density matrix of the form @xmath144 .",
    "@xmath388 factors according to @xmath79 iff @xmath416 .    without loss of generality",
    ", we can assume that the nodes are labelled so that @xmath417 for all @xmath42 .",
    "this means that we can always add arrows to @xmath79 until we generate a fully connected graph @xmath418 such that @xmath419 .",
    "we will call @xmath418 a * proper fully - connected extension * of @xmath79 .",
    "what we need to prove can now be rephrased as : a_chain = a_graph ^a(_j | ) j , where    a_chain(x . ) = _ j=1^n",
    "a(x_j| ) , a_graph(x . ) = _ j=1^n a(x_j| ) .    ( @xmath288 )",
    "define @xmath420 .",
    "since @xmath421 and @xmath422 , it follows from reduction rule @xmath336 that @xmath423 .",
    "thus , a(x_j| ) & = & a(x_j| , ) + & = & a(x_j| ) .",
    "( @xmath289)@xmath424 implies that    _",
    "j=1^n p(x_j| ) = _ j=1^n",
    "[ eq - pchain - is - pgraph ]    * sum both sides of eq.([eq - pchain - is - pgraph ] ) over @xmath425 .",
    "get @xmath426 .",
    "* divide both sides of eq.([eq - pchain - is - pgraph ] ) by @xmath427 , and then sum both sides over @xmath428 .",
    "get @xmath429 .",
    "* divide both sides of eq.([eq - pchain - is - pgraph ] ) by @xmath430 , and then sum both sides over @xmath431 .",
    "get @xmath432 .",
    "* divide both sides of eq.([eq - pchain - is - pgraph ] ) by @xmath433 , and then sum both sides over @xmath434 .",
    "get @xmath435 . * and so on .",
    "thus , by induction ,    p(x_j | ) = p(x_j | ) [ eq - prob - prev - to - pa ] for all @xmath42 .",
    "@xmath424 also implies that    _",
    "j=1^n ( x_j | ) .",
    "[ eq - thetachain - is - thetagraph ] recall that @xmath436 .",
    "* set @xmath437 in eq.([eq - thetachain - is - thetagraph ] ) .",
    "get @xmath438 . *",
    "set @xmath439 in eq.([eq - thetachain - is - thetagraph ] ) and subtract @xmath440 from both sides . get @xmath441 . *",
    "set @xmath442 in eq.([eq - thetachain - is - thetagraph ] ) and subtract @xmath443 from both sides . get @xmath444 . *",
    "set @xmath445 in eq.([eq - thetachain - is - thetagraph ] ) and subtract @xmath446 from both sides . get @xmath447 .",
    "* and so on .",
    "thus , by induction ,    ( x_j | ) = ( x_j | ) [ eq - theta - prev - to - pa ] for all @xmath42 . combining eq.([eq - prob - prev - to - pa ] ) and ( [ eq - theta - prev - to - pa ] ) yields    a(x_j | ) = a(x_j | ) [ eq - amp - prev - to - pa ] for all @xmath42 . note that @xmath448 .",
    "from a proper fully - connected extension of @xmath79 , it is clear that    a(x_j | ) = a(x_j | ) for all @xmath42 .",
    "combining the previous two equations yields    a(x_j | ) = a(x_j | ) for all @xmath42 .",
    "define @xmath449 .",
    "the previous equation can be written as @xmath450 , which means that @xmath451 .",
    "thus , @xmath452 .      in the last section",
    ", we showed that a probability distribution @xmath122 ( or a probability amplitude @xmath388 ) factors according to a dag iff it satisfies a certain non - global , graphic i - set .",
    "does a similar result hold if the non - global graphic i - set is replaced by a global graphic one ?",
    "this section will be devoted to answering this question .    to develop some intuition , we begin by considering fig.[fig - dsep - main - cases ] , which shows some simple bayesian net examples .",
    "column 1 of fig.[fig - dsep - main - cases ] shows four dags in which , respectively , node @xmath28 is :    1 .   a serial node of a path from @xmath105 to @xmath106 , 2 .",
    "(  common cause \" graph ) a divergence node of a path from @xmath105 to @xmath106 3 .",
    "(  common effect \" ,  explaining away \" graph ) a convergence ( a.k.a .",
    "collider ) node of a path from @xmath105 to @xmath106 4 .",
    "the descendant of a collider node of a path from @xmath105 to @xmath106 .",
    "column 2 of fig.[fig - dsep - main - cases ] illustrates two special cases of the graphs in column 1 : ( 1 ) no node is grounded , ( 2 ) only node @xmath28 is grounded .",
    "nodes decorated with a @xmath453 are summed over for @xmath360 and traced over for @xmath370 .    in fig.[fig - dsep - main - cases ] , the argument of @xmath454 is an independency whose third slot is filled with the grounded nodes . in fig.[fig - dsep - main - cases ] , the grounded nodes are always either @xmath28 or nothing .",
    "an independency with no grounded nodes is unconditional . in the classical physics case ,",
    "column 3 of fig.[fig - dsep - main - cases ] gives the truth values ( t = true , f = false ) of @xmath408 , for the graphs in column 2 . in the quantum physics case ,",
    "column 3 gives the values of @xmath321 .",
    "next , we show how we calculated the truth values of @xmath321 in fig.[fig - dsep - main - cases ] .",
    "let @xmath455 .",
    "rows 1 and 2 ( graphs in which @xmath28 is a serial node ) satisfy    a(x , y , a ) = a(y|a)a(a|x)a(x)=a(y|a)a(x|a)a(a ) , [ eq - dsep - table - serial ] for all @xmath456 .",
    "eq.([eq - dsep - table - serial ] ) implies    p(x , y)= _ a p(y|a)p(x|a)p(a)p(x)p(y ) , a(x , y)a(x)a(y ) .",
    "@xmath457 is false so @xmath458 is false too .",
    "eq.([eq - dsep - table - serial ] ) implies    a(x , y|a)=a(y|a)a(x|a ) , so @xmath459 is true .",
    "rows 3 and 4 with divergence node @xmath28 must have the same truth values as rows 1 and 2 with serial node @xmath28 .",
    "that s because the bayesian nets ( ) ( ) ( ) and ( ) ( ) ( ) are indistinguishable : they both represent the same full joint amplitude . indeed , @xmath460 for the first and @xmath461 for the second , and @xmath462 .    rows 5 and 6 ( graphs in which @xmath28 is a collider node ) satisfy    a(x , y , a ) = a(a|x , y)a(y)a(x ) , for all @xmath456 . therefore , @xmath463 , @xmath464 .",
    "hence , @xmath458 is true .",
    "@xmath465 is false so @xmath459 is false too .",
    "rows 7 and 8 ( graphs in which @xmath28 is a descendant of a collider node ) satisfy a(x , y , a , b)=a(a|b)a(b|x , y)a(x)a(y ) , for all @xmath466 .",
    "therefore , @xmath463 , @xmath464 .",
    "hence , @xmath458 is true .",
    "@xmath465 is false so @xmath459 is false too .",
    "note that the calculations of the truth values of @xmath408 in fig.[fig - dsep - main - cases ] are a special case of the just presented calculations of the truth values of @xmath321 .",
    "the moral of fig.[fig - dsep - main - cases ] , is that grounding a serial node or a divergence node interrupts information transmission between @xmath105 and @xmath106 .",
    "a non - vacuous message has variation in it , and a grounded node in its path prevents transmission of this variation .",
    "however , grounding a collider or a descendant of a collider has the opposite effect : it allows information transmission ( this is called the  explaining away \" phenomenon ) .    so far , this section has presented merely anecdotal evidence .",
    "next , we will state and prove some general theorems .",
    "consider any @xmath405 .",
    "suppose @xmath268 are disjoint sets .",
    "let @xmath467 .",
    "we will abbreviate  dependency separation \" by  d - sep \" or just  sep \" .",
    "we define the function @xmath406 by the statement : @xmath468 is true iff all paths @xmath469 in @xmath79 from a node in @xmath44 to a node in @xmath31 are blocked by @xmath271 .",
    "@xmath469 is blocked by @xmath271 \" iff there exists a node @xmath470 that satisfies one of the following :    1 .",
    "@xmath471 is a non - collider of @xmath469 and @xmath472 .",
    "2 .   @xmath471 is a collider of @xmath469 and @xmath473    [ th - bnet - prob - dsep ] ( classical d - separation theorem ) suppose @xmath405 and @xmath263",
    ". if @xmath122 factors according to @xmath79 then @xmath474 .",
    "the proof of this theorem can be found in the literature@xcite@xcite .",
    "[ th - bnet - amp - dsep ] ( quantum d - separation theorem ) suppose @xmath405 and @xmath143 is a meta density matrix of the form @xmath144 .",
    "if @xmath388 factors according to @xmath79 then @xmath475 .",
    "the proof of this theorem is a simple generalization of the proof of theorem [ th - bnet - prob - dsep ] .",
    "one can also prove a weak converse of the d - separation theorem .",
    "the weak converse theorem@xcite shows that @xmath476 is in some sense the maximal set for which the d - separation theorem holds .",
    "for this reason , ref.@xcite describes the d - separation theorem as a proof of soundness and its weak converse as a proof of completeness .",
    "in this section , we show that any probability distribution can be represented by a fully connected ug .",
    "we also show that any quantum density matrix can be represented by a fully connected ug . in classical and quantum physics , omitting certain links from this fully connected graph indicates certain probabilistic independencies .      in this section ,",
    "we define a power - set rule and factorization according to an ug , both for classical and quantum physics . the @xmath122 power - set rule is well known , but not by that name , which is ours . in some sense , the @xmath122 ( ditto , @xmath388 ) power - set rule is to markov nets what the @xmath122 ( ditto , @xmath388 ) chain rule is to bayesian nets .",
    "( p power - set rule ) any @xmath263 can be expressed as p(x.)= _ j : j e^ ( ) , [ eq - prob - power - set - rule ] where @xmath477 is defined by    ( ) = _ j:jj(-1)^|j - j| p ( , ) .",
    "[ eq - prob - lam - def ] ( note that if for some point @xmath478 , @xmath479 , then @xmath480 for some @xmath7 . instead of permitting such infinities , as we do , some authors restrict this theorem by adding a premise that @xmath358 . )",
    "the proof is a special case of the proof of the next theorem .",
    "( a power - set rule ) given a meta density matrix @xmath143 of the form @xmath144 , @xmath388 can be expressed as    a(x.)= _ j : j e^ ( ) , [ eq - amp - power - set - rule ] where @xmath477 is defined by    ( ) = _ j:jj(-1)^|j - j| a ( , ) .",
    "[ eq - amp - lam - def ] ( note that if for some point @xmath478 , @xmath481 , then @xmath482 for some @xmath7 . instead of permitting such infinities , as we do , some authors restrict this theorem by adding a premise that @xmath483 . )",
    "performing a mobius inversion ( see appendix [ app - mobius ] ) on eq.([eq - amp - lam - def ] ) , we get    a ( , ) = _ j:jj ( ) . replacing @xmath7 by @xmath484 in the previous equation yields :    a(x.)= _ j : j ( ) .    for @xmath37 random variables , the @xmath122 ( ditto , @xmath388 )",
    "chain rule contains @xmath37 factors whereas the @xmath122 ( ditto , @xmath388 ) power - set rule contains @xmath485 .",
    "thus , a power - set rule is not as useful as a chain rule for practical purposes like numerical calculation .",
    "it is mainly used to prove other theorems .",
    "we end this section by defining graphic factorization . in classical physics",
    ", we say @xmath263 * factors according to * @xmath486 iff @xmath122 can be expressed in the form of    p(x.)= _ jsuper - cliques(g ) e^ ( ) . in quantum physics , for a meta density matrix @xmath143 of the form @xmath144 , we say @xmath388 * factors according to * @xmath486 iff @xmath388 can be expressed in the form of a(x.)= _ jsuper - cliques(g ) e^ ( ) .",
    "[ eq - amp - factor - acc - ug ]    when @xmath79 is fully connected , eq.([eq - amp - factor - acc - ug ] ) reduces to @xmath487 , which is always possible .",
    "thus , any probability distribution ( ditto , probability amplitude ) of @xmath52 factors according to an @xmath37-node fully - connected ug .",
    "if the probability distribution ( ditto , probability amplitude ) has higher symmetry , then it may also factor according to another @xmath37-node graph that possess fewer links than the fully - connected one .      in section [ sec - bnet - graph - iset ] , we defined some graphic i - sets for a dag . in this section , we define some graphic i - sets for an ug .    for @xmath486 ,",
    "we define ( loc = local , glo = global )    _ pair(g)= \\{i : i=(_j_1_j_2| ) , j_1ne(j_2 ) ; j_1,j_2 } ,    _",
    "loc(g)= \\{i : i = ( _ j | ) , j } , and    _",
    "glog)= \\{i : i = ( | ) ; j , k , e ; ( i ) } . the function @xmath406 will be defined later on .      in this section ,",
    "we show that a probability distribution ( ditto , probability amplitude ) factors according to an ug iff the probability distribution ( ditto , probability amplitude ) satisfies a graphic i - set .",
    "[ th - prob - fact - iff - local - iset ] suppose @xmath486 and @xmath263 .",
    "@xmath122 factors according to @xmath79 @xmath488 @xmath489 .",
    "the proof is a special case of the proof of the next theorem .",
    "[ th - amp - fact - iff - local - iset ] suppose @xmath486 and @xmath143 is a meta density matrix of the form @xmath144 .",
    "@xmath388 factors according to @xmath79 @xmath488 @xmath490 .",
    "if the number of nodes @xmath37 is one then the theorem is satisfied trivially , so assume @xmath491 .",
    "recall @xmath388 factors according to @xmath79 iff    a(x . )",
    "= _ jsuper - cliques(g ) e^ ( ) .",
    "[ eq - in - proof - amp - factors ] note that @xmath490 iff @xmath492 for all @xmath493 such that @xmath494 .",
    "( @xmath288)(this direction would require a premise @xmath483 if we were nt permitting infinite @xmath495 ) .",
    "consider any @xmath40 .",
    "suppose @xmath496 are any two elements of @xmath7 ( there may or may not be a link between @xmath497 and @xmath498 at this point ) .",
    "let @xmath499 denote @xmath500 .",
    "note that for any function @xmath501    _ j:jjf_j= _ : ( f _ + f_\\{j_1,j_2 } + f_\\{j_1 } + f_\\{j_2 } ) .",
    "[ eq - jp - to - jpm ] now define @xmath502 by    = ( , ) . using eq.([eq - jp - to - jpm ] ) , eq.([eq - amp - lam - def ] ) can be re - written as    ( ) = _ : ( -1)^|-| .",
    "[ eq - amp - fancy - lam - def ] if @xmath497 and @xmath498 are not in the same super - clique , then there is no link between them .",
    "@xmath494 so @xmath492 , so    a(x_j_1,x_j_2|)= a(x_j_1|)a(x_j_2| ) , [ eq - xj1-xj2-indep - given - xi ] for all @xmath503 and @xmath504 .",
    "when eq.([eq - xj1-xj2-indep - given - xi ] ) is true , the right hand side of eq.([eq - amp - fancy - lam - def ] ) vanishes . in conclusion , if @xmath505 but @xmath497 and @xmath498 are not in the same super - clique , then @xmath506 in general , @xmath507 .",
    "( this would require @xmath483 if infinite @xmath495 were not permitted . ) but we have shown that @xmath477 vanishes for any @xmath40 which is not a super - clique of @xmath79 .",
    "thus , eq.([eq - in - proof - amp - factors ] ) follows .",
    "( @xmath289 ) let @xmath493 such that @xmath494 .",
    "define @xmath508 .",
    "@xmath497 and @xmath498 must belong to different super - cliques of @xmath79 .",
    "this fact and eq.([eq - in - proof - amp - factors ] ) together imply that there exist sets @xmath509 ( not necessarily disjoint ) such that @xmath510 and such that @xmath145 can be expressed as a product of two terms as follows :    a(x_j_1 , x_j_2 , ) = _ 1(x_j_1 , ) _ 2(x_j_2 , ) .",
    "[ eq - amp-2factors ] as usual , let @xmath511 .",
    "the previous equation implies that @xmath166 can be expressed as a product of two terms as follows :    p(x_j_1 , x_j_2 , ) = q_1(x_j_1 , ) q_2(x_j_2 , ) .",
    "[ eq - prob-2prod - j12 ] summing both sides of eq.([eq - prob-2prod - j12 ] ) over @xmath512 , over @xmath513 and over both , gives , respectively ,    p(x_j_1 , ) = q_1(x_j_1 , ) _ 2 ( ) , [ eq - prob-2prod - j1 ]    p(x_j_2,)= _ 1 ( ) q_2(x_j_2 , ) , [ eq - prob-2prod - j2 ] and    p()= _ 1 ( ) _ 2 ( ) . [ eq - prob-2prod - j ] from eqs.([eq - prob-2prod - j12 ] ) to ( [ eq - prob-2prod - j ] ) , it is clear that    p(x_j_1 , x_j_2 | ) = p(x_j_1 | ) p(x_j_2 | ) .",
    "[ eq - prob - indep - j12 ] eq.([eq - amp-2factors ] ) implies that @xmath262 can be expressed as a sum of two terms as follows :    ( x_j_1 , x_j_2,)= _ 1(x_j_1 , ) + _ 2(x_j_2 , ) . [ eq - theta-2sum ] eq.([eq - theta-2sum ] ) immediately yields    ( x_j_1 , x_j_2|)&= & ( x_j_1 , x_j_2 ) - ( x^o_j_1 , x^o_j_2 , ) + & = & \\ {    l [ _ 1(x_j_1 , ) + _ 2(x_j_2 , ) ] + -[_1(x^o_j_1 , ) + _ 2(x^o_j_2 , ) ]    . ,    ( x_j_1|)&= & ( x_j_1 , x^o_j_2| ) + & = & _ 1(x_j_1 , ) - _ 1(x^o_j_1 , ) , and    ( x_j_2|)&= & ( x^o_j_1 , x_j_2| ) + & = & _ 2(x_j_2 , ) - _ 2(x^o_j_2 , ) . thus ,    ( x_j_1 , x_j_2| ) = ( x_j_1| ) + ( x_j_2| ) .",
    "[ eq - theta - indep - j12 ] combining eqs.([eq - prob - indep - j12 ] ) and ( [ eq - theta - indep - j12 ] ) , we get    a(x_j_1 , x_j_2| ) = a(x_j_1| ) a(x_j_2| ) .      in the last section",
    ", we showed that a probability distribution @xmath122 ( or a probability amplitude @xmath388 ) factors according to an ug iff it satisfies a certain non - global , graphic i - set .",
    "does a similar result hold if the non - global graphic i - set is replaced by a global graphic one ?",
    "this section will be devoted to answering this question .",
    "consider any @xmath486 .",
    "suppose @xmath268 are disjoint sets .",
    "let @xmath467 .",
    "we define the function @xmath406 by the statement : @xmath468 is true iff all paths @xmath469 in @xmath79 from a node in @xmath44 to a node in @xmath31 are blocked by @xmath271 .",
    "@xmath469 is blocked by @xmath271 \" iff there exists a node @xmath470 that satisfies @xmath472 .",
    "[ th - prob - glo - iff - loc - iff - pair ] suppose @xmath486 and @xmath263 . for @xmath514 ,",
    "let @xmath515 denote the statement @xmath516 .",
    "@xmath517 . if @xmath358 , @xmath518 .",
    "the proof is a special case of the proof of the next theorem .",
    "[ th - amp - glo - iff - loc - iff - pair ] suppose @xmath486 and @xmath143 is a meta density matrix of the form @xmath144 .",
    "for @xmath514 , let @xmath515 denote the statement @xmath519 .",
    "@xmath517 . if @xmath483 , @xmath518 .",
    "* proof that @xmath520 * : let @xmath521 .",
    "@xmath468 so @xmath321 .    *",
    "proof that @xmath522 * : suppose @xmath523 and @xmath494 .",
    "@xmath524 and @xmath525 so , using the reduction rule @xmath338 , we get @xmath526 .    *",
    "proof that @xmath527 * : suppose @xmath268 are disjoint sets .",
    "let @xmath528 .",
    "note that @xmath529 is equivalent to : @xmath526 for @xmath494 .",
    "what we want to prove is @xmath530 , which is equivalent to : @xmath531 .",
    "if we can prove the theorem when @xmath270 , then the other cases will follow .",
    "this is why .",
    "suppose @xmath532 and @xmath533 .",
    "assume @xmath468 .",
    "since @xmath468 is true , either @xmath534 or @xmath535 must be true .",
    "for if both were false , there would be a path from a node in @xmath44 to a node in @xmath31 that was not blocked by @xmath271 , contradicting @xmath468 .",
    "in general , all the nodes that are not in @xmath536 , can be put in either the @xmath7 side ( if they are d - separated from the @xmath119 side ) or the @xmath119 side ( if they are d - separated from the @xmath7 side ) .",
    "thus , there exist disjoint sets @xmath537 and @xmath538 such that @xmath539 , @xmath540 , @xmath541 , and such that @xmath542 satisfies @xmath543 . if we can prove that @xmath544 , then , by virtue of the reduction rule @xmath336 , @xmath321 will follow .",
    "it now remains for us to prove the theorem for the fat case when @xmath270 .",
    "the proof is by induction in @xmath545 .    when @xmath546 , @xmath547 , @xmath548 , @xmath549 .",
    "assume @xmath468 .",
    "it follows that @xmath550 .",
    "hence , @xmath551 .",
    "hence , @xmath321",
    ".    now assume @xmath531 when @xmath552 and try to prove it for @xmath553 .",
    "either @xmath8 or @xmath554 is greater than two , so we may assume , without loss of generality , that @xmath555 .",
    "let @xmath556 and @xmath557 .",
    "let @xmath558 , and @xmath559 .",
    "assume @xmath468 .",
    "it follows that @xmath560 and @xmath561 . furthermore , @xmath562 and @xmath563 so , by the inductive hypothesis , @xmath564 and @xmath565 . by virtue of the combination rule @xmath343 ( here we use @xmath483 ) , @xmath564 and @xmath565 together",
    "imply @xmath321 .",
    "[ th - mnet - prob - dsep ] ( classical d - separation theorem ) suppose @xmath486 and @xmath263 .",
    "if @xmath358 and @xmath122 factors according to @xmath79 , then @xmath474 .    follows from theorems [ th - prob - fact - iff - local - iset ] and [ th - prob - glo - iff - loc - iff - pair ] .",
    "[ th - mnet - amp - dsep ] ( quantum d - separation theorem ) suppose @xmath486 and @xmath143 is a meta density matrix of the form @xmath144 .",
    "if @xmath483 and @xmath388 factors according to @xmath79 , then @xmath475 .    follows from theorems [ th - amp - fact - iff - local - iset ] and [ th - amp - glo - iff - loc - iff - pair ] .",
    "in this section , we show that the quantum d - separation rules for bayesian and markov graphs can be used to detect pairs @xmath566 in a graph that are unentangled .    for @xmath405 ,",
    "define    _ glo(g)= \\ { ( , ) : j , k ; ( | ) } . for @xmath486 , define @xmath567 in the same way .",
    "the function @xmath568 has been defined previously .",
    "its definition is different for dags than for ugs .    for a meta - density matrix @xmath144 ,",
    "define    ( a)= \\ { ( , ) : j , k ; e^cmi_(:)=0 } .",
    "[ th - dsep - ent ] suppose @xmath405 ( ditto , @xmath486 ) and @xmath143 is a meta density matrix of the form @xmath144 .",
    "if @xmath388 factors according to @xmath79 , then @xmath569 .",
    "assume @xmath388 factors according to @xmath405 ( ditto , @xmath486 ) .",
    "let @xmath570 be disjoint sets .",
    "let @xmath571 .",
    "let @xmath528 .",
    "assume @xmath468 .",
    "the quantum d - separation theorem , namely theorem [ th - bnet - amp - dsep ] ( ditto , theorem [ th - mnet - amp - dsep ] ) , tells us that if @xmath468 , then @xmath321 .",
    "but we know from theorem [ th - tau - a - tau - cmip - connection ] that , because @xmath572 is all - encompassing , @xmath329 .",
    "it follows that @xmath573 .",
    "this and the definition of cmi entanglement imply that @xmath574 .",
    "suppose @xmath40 , and we are given a density matrix @xmath575 with a _ generalized _",
    "purification @xmath149 .",
    "suppose @xmath576 are disjoint sets , and we want to decide whether @xmath577 vanishes .",
    "note that to apply theorem [ th - dsep - ent ] , we should first replace @xmath146 by a _ traced _",
    "purification @xmath226 of @xmath130 .",
    "the reason is that we are interested in @xmath577 .",
    "this quantity is not necessarily equal to @xmath578 , but it is always equal to @xmath579 .    in a nutshell ,",
    "theorem [ th - dsep - ent ] tells us that , if @xmath580 are disjoint sets , and @xmath581 , then @xmath574 . and",
    "now , some examples .",
    "let @xmath582 mean that we ca nt conclude anything about the value of @xmath583 .",
    "the bayesian nets ( ) ( ) ( ) and ( ) ( ) ( ) both have @xmath584 because @xmath28 can be grounded and @xmath585 . on the other hand , the bayesian net ( ) ( ) is equivalent to @xmath586 , for which @xmath587 , so @xmath588 . the bayesian net ( ) ( )",
    "( ) also has @xmath588 , because grounding @xmath28 allows transmission of information between @xmath105 and @xmath106 .    a parting observation : suppose @xmath589 are disjoint sets .",
    "let @xmath590 , @xmath591 , and @xmath592 .",
    "it s not hard to convince oneself that @xmath593 \\leftrightarrow [ d_1,d_2\\in\\cald_{glo}(g)]$ ] . by the synergism of entanglement , @xmath594\\rarrow [ d_1,d_2\\in\\cald(a)]$ ] , but",
    "the opposite implication does not appear to be true .",
    "if we define a perfect graph as one for which @xmath595 , then it appears that no all graphs are perfect .",
    "in this appendix , we prove the mobius inversion theorem .      for any finite set @xmath7 , consider a table of arbitrary complex numbers , where the rows and columns of the table are both labelled by the elements of @xmath11 .",
    "suppose we want to sum over the elements of the table that are below its main diagonal .",
    "fig.[fig - powset - table ] illustrates the table for @xmath596 .",
    "the shaded entries of fig.[fig - powset - table ] are the entries we want to sum over .",
    "two simple methods for carrying out such a sum are:(1 ) sum first over rows and then over columns , ( 2 ) sum first over columns and then over rows . of course , whether we use method ( 1 ) or ( 2 ) , the final value of the sum will not change . this simple observation , that the final value of the sum does not depend on the order of summation , can be stated more formally as    _ j:jj _",
    "j:jj = _ j:jj _ j:jjj .",
    "by @xmath597 we mean the sum of all subsets @xmath598 of @xmath7 , including the empty set @xmath10 and @xmath7 . note that we use @xmath599 ( i.e. , @xmath7 with one or more primes ) to denote subsets of @xmath7 .",
    "_ d : dd ( -1)^|d| = ( d , ) .",
    "[ eq - mobius - delta - fun ] for example , suppose @xmath600 .",
    "fig.[fig - powset - lattice ] lists all the subsets @xmath601 of @xmath160 .",
    "it associates each distinct @xmath601 with a different node of a lattice .",
    "( subsets with the same number of elements are in the same horizontal level .",
    "subsets in lower horizontal levels have more elements .",
    "links connect subsets that differ only by one element . )",
    "if we sum @xmath602 over all the nodes of the lattice of fig.[fig - powset - lattice ] , we get zero , since the number of even - order subsets equals the number of odd - order subsets .",
    "this is true for any set @xmath160 except for the empty set , which has only a single even - order subset , itself .",
    "eq.([eq - mobius - delta - fun ] ) yields"
  ],
  "abstract_text": [
    "<S> we show that any quantum density matrix can be represented by a bayesian network ( a directed acyclic graph ) , and also by a markov network ( an undirected graph ) . </S>",
    "<S> we show that any bayesian or markov net that represents a density matrix , is logically equivalent to a set of conditional independencies ( symmetries ) satisfied by the density matrix . </S>",
    "<S> we show that the d - separation theorems of classical bayesian and markov networks generalize in a simple and natural way to quantum physics . </S>",
    "<S> the quantum d - separation theorems are shown to be closely connected to quantum entanglement . </S>",
    "<S> we show that the graphical rules for d - separation can be used to detect pairs of nodes ( or of node sets ) in a graph that are unentangled . </S>",
    "<S> cmi entanglement ( a.k.a . squashed entanglement ) </S>",
    "<S> , a measure of entanglement originally discovered by analyzing bayesian networks , is an important part of the theory of this paper . </S>"
  ]
}