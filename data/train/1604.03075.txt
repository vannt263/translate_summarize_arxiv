{
  "article_text": [
    "high - resolution , em imaging allows one to identify synapses , such as the one shown in figure [ fig : synapse_ex ] below . in this example , there is a electron dense region corresponding to the synapse at the pre - synaptic body .",
    "this consists of different transport apparatus , such as vesicles , that abut the neuronal membrane . in a data set that contains numerous organelles of varying electron density ( , imaging intensity ) and neuronal membrane that intricately weaves throughout , identifying synapses can be challenging . when creating a connectome",
    ", an annotator will typically scan the data set or a traced neuron and manually identify and mark these sites . even for organisms as small as a fruit fly ,",
    "there are upwards of 100 million connections , making the process of manual annotation intractable .",
    "an example of a synapse in the drosophila optic lobe .",
    "the larger yellow bullseye marks the pre - synaptic structure , which we refer to as a t - bar due to its shape , and the smaller yellow dots mark three post - synaptic densities ( psds ) that partner with the marked t - bar.,scaledwidth=50.0% ]    consequently , there have been recent research efforts to automate synapse detection using machine learning , which we discuss below in section  [ sec : background ] .",
    "however , existing techniques for automated synapse detection have primarily been applied to detection in mammalian tissue .",
    "it is unclear , then , how well such approaches would translate when applied to synapse detection in drosophila tissue .",
    "in contrast to synapses in the mammalian brain , which are predominantly monadic , involving a single pre - synaptic site and post - synaptic site , synapses in the drosophila are mostly polyadic , involving multiple post - synaptic partners for a given pre - synaptic site  @xcite .",
    "for example , figure  [ fig : synapse_ex ] shows a pre - synaptic site with three post - synaptic partners .",
    "these neuronal processes are often difficult to segment , which makes identifying the post - synaptic partners non - trivial , even given the pre - synaptic site .",
    "prior work on automated synapse identification has also focused only on the detection problem in isolation . however , synapse detection is one step in a larger pipeline , whose final goal is the extraction of a connectome from the em data .",
    "therefore , we are interested not only in individual synapse detection accuracy , but in how synapse detection integrates into this larger system , and how errors in individual steps in that system combine when evaluating the final produced connectome .    for instance",
    ", one straightforward method for reliably using automated synapse detections in an em pipeline is as hints for manual annotation , as done by plaza  @xcite . by manually verifying detections , errors in the final connectome",
    "are minimized , but at the expense of human effort and time .",
    "an alternative would be to simply accept all detected synapses above a certain confidence threshold , but there has been no prior work on whether such a prediction would result in a meaningful connectome . in particular ,",
    "many connections between neurons are formed from a high number of synaptic contacts , and therefore one might hope that automated algorithms are capable of faithfully reconstructing such high strength connections , but this has not yet been experimentally tested .    moreover , extracting a connectome is also dependent upon automatic neuron segmentation .",
    "in addition to possibly being outright incorrect , a segmentation may also be noisy along a border .",
    "both cases may potentially cause errors in the connectivity graph when combined with automated synapse identification output .",
    "therefore , in this paper , we introduce algorithms that enable fully automatic synapse prediction and evaluate the results of the end - to - end process from the standpoint of the final produced connectome .",
    "specifically , key contributions of our approach and results include :    1 .",
    "an algorithm that generalizes well over a large data set with minimal supervision required , 2 .",
    "new metrics to better evaluate synapse prediction in realistic settings , 3 .",
    "empirical results analyzing end - to - end accuracy of the proposed approach on a publicly available connectome data set  @xcite , demonstrating high performance and preservation of biological pathways , in particular relative to a baseline using body - proximity as a proxy for synaptic contact .",
    "an automated approach for synapse identification in em images using machine learning was first proposed by kreshuk  , who use a random forest ( rf ) classifier on hand - selected image features to detect synapses  @xcite . in subsequent work ,",
    "kreshuk  extend this method by applying graph cut on the synapse probabilities to obtain a segmentation of each putative synapse , extracting object - level features given the segmentation , and then applying a rf classifier to determine whether each segmented region is a synapse or not  @xcite .",
    "becker  attempt to generate more informative features , by conditioning on the synaptic cleft , thereby allowing features to be extracted from consistent spatial locations relative to the putative synapse  @xcite .",
    "these features are then used as input to adaboost for synapse detection .",
    "jagadeesh  consider the problem of large - scale synapse detection in a large image volume  @xcite .",
    "they first use a fast interest point detector based on image - thresholding to generate proposals for possible synapse locations .",
    "they then use feature descriptors hand - designed to extract information about relevant biological biological structures , namely vesicles , clefts , and ribbons .",
    "these features are used as input to an svm or multiple kernel learner for patch - based synapse detection .",
    "biological preparation has also been considered as a means toward aiding in automated synapse detection .",
    "navlakha  apply a technique for selectively staining for synapses , leading to more pronounced opacity at synaptic sites , and leaving non - synaptic membranes unstained  @xcite .",
    "they propose a high - throughput method for automated detection by first filtering down to a candidate set of patches , then applying an svm to classify each patch as synapse or non - synapse .",
    "while this technique can be used to compute statistics on synapses such as density , since the membranes are left unstained , it can not be used in conjunction with segmentation and therefore can not be directly used for extracting a connectome .",
    "most recently , roncal  also consider large - scale synapse detection , presenting two different techniques  @xcite .",
    "they propose a fast rf classifier using hand - selected features , including a filter designed for vesicle detection .",
    "this rf classifier yields similar results to becker  @xcite , but with approximately half the run - time .",
    "they also propose a deep learning classifier for synapse detection , which yields superior results to the fast rf classifier but approximately two orders of magnitude slower .",
    "the above approaches were evaluated on synapse detection in mammalian tissue , assuming a single post - synaptic site for each pre - synaptic site .",
    "several approaches also make additional assumptions on the data , such as being able to reliably identify the synaptic cleft to extract spatially consistent features  @xcite , or having feature descriptors hand - tuned for particular biological structures  @xcite .",
    "the method of kreshuk  @xcite was adapted for pre - synaptic site detection / proposal by plaza  @xcite , but labeling post - synaptic partners was performed manually .    as mentioned in the introduction , synapse detection in drosophila",
    "can be more challenging , due to the polyadic nature of such synapses , where pre - synaptic sites have multiple post - synaptic partners , and where post - synaptic processes can often be small and difficult to segment . to address this difficulty in drosophila synapse detection , kreshuk  specifically studied the problem of synaptic partner assignment . conditioned on ground - truth neuron segmentation and synapse detection , they formulate a pairwise graphical model wherein nodes of the model represent possible assignments between two neurons @xmath0 at a putative synapse , , neuron @xmath1 is pre - synaptic and neuron @xmath2 is post - synaptic .    in this work ,",
    "we propose a complete system for automated synapse detection , capable of handling polyadic synapses as found in drosophila .",
    "our system uses unsupervised feature learning , and takes as training data simple point - wise annotations of pre- and post - synaptic sites , and therefore can be applied to new data sets with relatively minimal supervision . by comparison ,",
    "existing methods as discussed above , that require hand - designed features to extract high - level information such as vesicles and ribbons , may not be appropriate for new data sets , or may require significant manual effort to tune or re - design the feature descriptors .",
    "in contrast to kreshuk  , we evaluate our system on completely - automated , noisy segmentation .",
    "our system for automated synapse detection proceeds in two distinct steps .",
    "first , independent of any segmentation , we apply a classifier to automatically identify pre - synaptic sites in the drosophila , which are often referred to as t - bars , due to their t - like shape , formed by a pedestal and platform structure .",
    "next , conditioned on predicted t - bar locations and a segmentation , we apply a second classifier to predict partnering post - synaptic densities ( psds ) for the identified t - bars .",
    "we describe each of these steps in more detail in the next two sections .",
    "we will also be releasing source code that implements the proposed methods .",
    "the first step in our automated synapse detection pipeline is to detect the pre - synaptic t - bar sites .",
    "an example of a t - bar can be seen in figure  [ fig : synapse_ex ] . due to its distinct structure , we focus on first predicting t - bars in isolation , independent of both segmentation and psd prediction , and delay the problem of determining the potentially multiple psd partners until after segmentation , as psds are typically more ambiguous and difficult to identify .",
    "we note that this approach of splitting t - bar and psd prediction into separate steps , with psd prediction aided by segmentation , has also been taken for manual synapse detection  @xcite .    for automated t - bar detection ,",
    "we make use of deep and wide multiscale recursive ( dawmr ) networks  @xcite . we give the highlights of our approach here",
    "; for more details , see huang and plaza  @xcite .    unlike the problem of image segmentation , which is naturally framed as a voxel - wise prediction problem ( at each voxel ,",
    "predict whether that voxel belongs to a cell boundary or not ) , t - bar detection is an object detection problem , which we formulate as predicting , for each t - bar , a point annotation , specifying the spatial coordinates of the center of the t - bar . to generate voxel - wise training data for the dawmr network ,",
    "we simply consider any voxels within a certain radius of a t - bar point annotation to be a positive example , and all other voxels to be negative examples .",
    "we find that the dawmr networks are able to successfully learn from this simple training data , allowing for less manual supervision effort relative to methods and tasks that require dense labeling .    to generate final t - bar point predictions from the voxel - wise output of the dawmr network , we spatially smooth the voxel - wise predictions , selecting the voxels with highest confidence , and apply non - maxima suppression .",
    "we make two notes concerning evaluation of t - bar prediction , in the context of a larger connectomics pipeline .",
    "first , it is important to consider the precision / recall ( pr ) curve for the automated predictions .",
    "different applications may have different misclassification costs , leading to different thresholds along different points of the pr curve .",
    "for instance , if very high fidelity is required , one may need to select a threshold for high recall , at the expensive of precision , whereas if the final goal is to determine strong connections in the connectome with some tolerance for small errors , the optimal threshold may be to select for the precision / recall break even point .",
    "second , t - bar prediction accuracy can be computed by requiring , for instance , that predicted t - bars be within a specified distance of a ground - truth t - bar to be counted as a correct match , as in huang and plaza  @xcite .",
    "however , ultimately , the exact location of a t - bar annotation will be abstracted as one endpoint of an edge in a connectomic graph , indicating the pre - synaptic body .",
    "therefore , the primary concern is that annotation be placed in the correct neuron .",
    "thus , when a segmentation is available , t - bar prediction accuracy should be computed by further requiring that the predicted t - bar fall within the same segment as the ground - truth t - bar .    due to this interaction with the segmentation when evaluating t - bar performance accuracy , it may be beneficial to post - process the t - bar predictions .",
    "for instance , we find that our t - bar detection often places the annotation in the distinctive dark t - like structure itself , which , due to its dark intensity , can cause problems for automated segmentation .",
    "we therefore find a benefit in slightly shifting t - bar predictions within a small radius to the brightest intensity voxel , helping the annotation be placed in a non - ambiguous region relative to the segmentation .",
    "once we have automated t - bar predictions and a ( possibly automated ) segmentation , we condition on this information in order to predict the post - synaptic densities ( psds ) that partner with each t - bar .",
    "for a given t - bar , we can consider all nearby segments as potentially having a partner psd .",
    "more precisely , we use the set of segments that have non - empty intersection with a sphere of a given radius , centered at a given t - bar , as the candidate set of bodies that may be post - synaptic to the t - bar .",
    "we exclude the segment containing the t - bar itself , and therefore make no attempt at predicting autapses .",
    "additionally , we do not attempt to identify cases where a single t - bar makes multiple connections to the same post - synaptic body , and thus any such biological multiple connections will at most be predicted as a single synapse .    with this set - up",
    ", we have a binary classification problem , where for each t - bar and each candidate segment , we wish to determine if the candidate segment contains an actual psd and thus forms a synapse with the t - bar . for classification",
    ", we use a multi - layer perceptron ( mlp ) . to generate the feature representation",
    ", we estimate the interface of the synapse between the t - bar segment and candidate segment , by dilating both segments by varying amounts and letting the estimated interface be the intersection .",
    "we then pool a set of simple image features over the interface , computing statistics such as size of the interface and image intensity within the interface ( such as number of voxels with intensity lower than some set threshold ) .",
    "one important consideration is that psd prediction performance will depend on both the accuracy of the psd predictor itself as well as the performance of the algorithm used to generate the segmentation .",
    "therefore , it may be necessary to tune the psd predictor with an awareness of the behavior of the segmentation algorithm . for instance",
    ", we found that dark intensity values such as those found at a boundary , as well as at t - bars , would often present difficulties for the segmentation algorithm .",
    "this ambiguity could lead to , for instance , small parts of the t - bar segment being incorrectly assigned to a neighboring segment .",
    "although such localized errors would not have a large effect on the topology of the segmentation ( in terms of rand error , for example ) , they can have a large effect on the proposed feature representation and hence psd classifier .",
    "therefore , we attempt to make the classifier more robust to such errors by ignoring the segmentation at voxels with such dark intensity values .",
    "as discussed above , to properly evaluate automated synapse detection performance in the context of a larger pipeline , it is important to consider the full performance curve as the threshold on classifier confidence is varied .",
    "this allows for synapse prediction to be evaluated at the appropriate threshold for varying misclassification costs , which will depend on the final application being considered .",
    "one straightforward metric for evaluating detection at the individual synapse level is to produce a precision / recall ( pr ) curve . under the view of the connectome as a graph ,",
    "with directed edges between nodes ( representing neurons ) defined by synapses , we can consider two variations for computing pr .",
    "first , we can view the connectome as a weighted graph , and compute pr by considering each individual synapse as a ground - truth label that is to be predicted .",
    "second , we can consider the connectome as an unweighted graph , and compute pr by considering each edge ( formed by any number of synapses between a pair of neurons ) as a ground - truth label to be predicted .",
    "the above methods for computing pr are two ways of dealing with the finding from connectomic studies that many connections between neurons consist of multiple synapses  @xcite .",
    "this multiplicity may be a weight on the synapse strength , or may be a mechanism for robustness . in either case ,",
    "a general assumption in many connectomic efforts is that important biological connections will have some multiplicity greater than one .",
    "therefore , we would like to consider a range of metrics that will better reflect whether a set of automated synapse predictions is actually good enough for use in connectomic studies .",
    "computing pr with a weighted graph requires that the automated predictions match the ground - truth precisely in terms of strength , without regard to topology .",
    "for example , predicting an edge of strength 7 for a ground - truth edge of strength 9 is equivalent to missing an edge of strength 2 ( in terms of recall value ) , which may be inappropriate if we do not care about precisely determining the multiplicity of strong connections .",
    "computing pr with an unweighted graph , on the other hand , evaluates the automated predictions solely in terms of unweighted topology .",
    "therefore , no penalty is incurred for not correctly determining multiplicity , but missing an edge of multiplicity 1 is equivalent to missing an edge of multiplicity 7 .",
    "one simple modification that can be made to the unweighted graph computation is to consider the unweighted graph produced by thresholding the edge weights by some value @xmath3 ( in both the predicted and ground - truth connectomes ) .",
    "for @xmath4 , we have the original unweighted pr ; for @xmath5 , we focus only on stronger predicted and ground - truth edges , with multiplicity of at least @xmath3 .",
    "we can also examine performance of a given classifier over different sets of curves as we vary this threshold @xmath3 .      by thresholding the edge weights at some @xmath5 and computing unweighted pr",
    ", we focus on the strong edge connections and ignore potentially noisy weak connections .",
    "however , there is still a strong boundary effect , where , for instance , a predicted edge of strength @xmath6 for a corresponding ground - truth edge of strength @xmath3 is counted as a false negative , the same as if the predicted edge strength had been simply zero .",
    "this harsh decision boundary may also be problematic from the standpoint of potential small errors in the manually annotated ground - truth .",
    "we would like a metric that focuses on identifying clear error cases in the automated predictions .",
    "we therefore introduce an asymmetric variant of the above thresholded pr curve .",
    "let the asymmetric @xmath7 thresholded pr curve ( with @xmath8 ) be defined as follows : consider the ( weighted ) ground - truth connectome graph @xmath9 and the predicted graph @xmath10 produced by applying some classifier threshold , and let @xmath11 be the weight of a given edge @xmath12 in @xmath9 , and similarly for @xmath13 .",
    "recall is then computed as @xmath14}{\\sum_e [ g(e)\\geq t_1]},\\ ] ] where the square iverson brackets evaluate to 1 if the condition inside is true and 0 otherwise . in other words , the total set of positive ground - truth instances consists of all edges with ground - truth weight greater than @xmath15 , but the subset of true positives allows for edges with predicted weight greater than the smaller @xmath16 .",
    "conversely , precision is computed as @xmath17}{\\sum_e [ p(e)\\geq t_1]}.\\ ] ] here the total set of positive predicted instances consists of all edges with predicted weight greater than @xmath15 , but the subset of true positives allows for edges with ground - truth weight greater than the smaller @xmath16 .    from the above precision / recall definitions",
    ", it can be seen that asymmetric @xmath7 thresholded pr upper bounds the original symmetric thresholded pr at @xmath18 .",
    "this more lenient performance measure focuses on the more clear , egregious errors , where there is a strong edge in either the ground - truth or predicted connectome graph but a weak or no edge in the other graph .",
    "we can also report these types of errors directly as connections ( falsely ) added and connections missed .",
    "let connections missed be the set of edges @xmath12 such that @xmath19 .",
    "the number of connections missed is an unnormalized version of @xmath20 .",
    "let connections added be the set of edges @xmath12 such that @xmath21 .",
    "the number of connections added is an unnormalized version of @xmath22 .",
    "when plotting number of connections added versus number of connections missed , we normalize these values by the number of edges in the ground - truth connectome after thresholding , , the number of edges @xmath12 such that @xmath23 , to put curves with different values of @xmath15 on the same scale .    by using asymmetric thresholded pr and connections added / missed ,",
    "we can focus on strong error cases when comparing sets of predictions and be robust to small amounts of labeling noise .",
    "these error measures also more clearly indicate to what extent strong biological connections are being missed or false introduced through prediction .",
    "in this section , we present a case study of our proposed synapse detection system on data from the drosophila optic lobe . the data set that we use comprises 7 columns of the medulla .",
    "details of the data can be found in plaza  @xcite and takemura  @xcite , and the raw em image data , fib-25 , is available online .",
    "we give results of the individual steps of our pipeline , full end - to - end results , results using the proposed error metrics focusing on clear error cases , comparison against a surface area contact baseline , and results in the context of preserving biological findings .",
    "t - bar precision / recall .",
    "( this figure and subsequent figures best viewed in color . )",
    "the dashed red curve indicates pr when the only constraint for a match between a predicted t - bar and a ground - truth t - bar is that the two locations fall within a specified distance of each other .",
    "the dotted blue curve gives pr when a match is further constrained to enforce that the predicted t - bar and ground - truth t - bar both fall within the same segment , in the ground - truth segmentation .",
    "finally , the solid green curve gives pr with the segmentation constraint , if the predicted t - bar locations are first shifted slightly , away from potentially ambiguous regions .",
    "see the accompanying text and section  [ sec : tbar ] for more discussion.,scaledwidth=45.0% ]    we first train a t - bar detector using the system described above in section  [ sec : tbar ] , using the ground - truth annotations contained in one @xmath24 subcube of the total volume .",
    "figure  [ fig : fib25_tbar ] gives the precision / recall curve for the automated predictions over the entire data volume .",
    "the plot highlights two important points that were made in section  [ sec : tbar ] : first , t - bar prediction accuracy should ideally be assessed within the context of segmentation and the final produced connectome graph , rather than only considering the distance between predicted and ground - truth t - bar locations . a predicted t - bar that is very close to a ground - truth t - bar , but placed in the wrong ground - truth segment ,",
    "will lead to errors in the connectome graph .",
    "this is highlighted in the difference between the dashed red curve and the dotted blue curve .",
    "consequently , second , the t - bar detector may need to be aware of the behavior of the corresponding segmentation algorithm . in our case",
    ", we found that by simply shifting the predicted t - bar locations slightly , toward brighter image voxels , this would move the predictions away from dark image regions that are more difficult or ambiguous for the segmentation algorithm , and therefore improve performance when applying the segmentation constraint .",
    "psd precision / recall , where each psd is considered separately ( weighted view of connectome graph , see section  [ sec : metrics ] ) .",
    "performance is computed both when access to the ground - truth segmentation is available during psd detection ( ground - truth / gt segm ) , and when only the fully - automated , predicted segmentation is available during psd detection ( predicted / pd segm ) . *",
    "left : * plot of psd prediction performance in isolation , using ground - truth t - bar locations . *",
    "right : * plot of end - to - end performance , using predicted t - bar locations : using a larger set of predicted t - bars with confidence greater than 0.60 ( tbar0.60 ) , and a smaller set of predicted t - bars with confidence greater than 0.73 ( tbar0.73).,title=\"fig:\",scaledwidth=45.0% ]   psd precision / recall , where each psd is considered separately ( weighted view of connectome graph , see section  [ sec : metrics ] ) . performance is computed both when",
    "access to the ground - truth segmentation is available during psd detection ( ground - truth / gt segm ) , and when only the fully - automated , predicted segmentation is available during psd detection ( predicted / pd segm ) . *",
    "left : * plot of psd prediction performance in isolation , using ground - truth t - bar locations . *",
    "right : * plot of end - to - end performance , using predicted t - bar locations : using a larger set of predicted t - bars with confidence greater than 0.60 ( tbar0.60 ) , and a smaller set of predicted t - bars with confidence greater than 0.73 ( tbar0.73).,title=\"fig:\",scaledwidth=45.0% ]    next , we evaluate the performance of the psd predictor .",
    "we consider performance both under the scenario in which we have access to the ground - truth segmentation , and in which we only have access to a predicted , fully - automated segmentation .",
    "we first make a note about the `` ground - truth segmentation '' .",
    "this segmentation was produced by starting from an automated segmentation ( separate and distinct from the fully - automated segmentation we use for synapse prediction ) , and manually proofreading the segmentation by applying merge and split operations as necessary .",
    "this ground - truth segmentation therefore aims to get the correct general topology , but is not refined to the point of necessarily assigning a correct label at the voxel level , and additionally may have orphan fragments that were not merged into larger bodies .",
    "one important consequence is that , when we compute performance using this ground - truth segmentation , we typically ignore all predictions that fall into such orphan fragments , defined as segments that contain neither a ground - truth t - bar nor ground - truth psd .",
    "in other words , predictions that fall into such fragments are not counted when computing precision . additionally , we shift psd point annotations using the same criteria as when shifting t - bar annotations as mentioned above .",
    "we first evaluate psd prediction assuming that we have access to ground - truth t - bar locations , in order to evaluate the performance of the psd detector on its own .",
    "this performance is given in the left plot of figure  [ fig : fib25_psd ] .",
    "next , we evaluate psd prediction using predicted t - bar locations .",
    "we consider two possible sets of t - bar predictions , one at a more conservative threshold of t - bars with confidence above 0.60 , and a more aggressive threshold of t - bars with a confidence above 0.73 . for both cases ,",
    "we compute precision / recall considering each psd separately , corresponding to a weighted view of the connectome graph .",
    "importantly , we note that although performance is best when the ground - truth segmentation is available during psd prediction , our psd predictor is still able to achieve close performance using the automated , predicted segmentation",
    ".       global connectome graph precision / recall . * left : * the top blue curves show pr of the connectome graph , with the dashed curve computing pr using a weighted view of the graph edges , and the solid curve computing pr using a unweighted binary view of the graph edges .",
    "these curves are computed using the filtered set of bodies in the ground - truth segmentation , as described in section  [ sec : psd_perf ] . for reference ,",
    "the bottom red curves show weighted and unweighted pr if all bodies ( adding in orphan segments ) are considered . *",
    "right : * comparison against the baseline of using ground - truth body - proximity as a proxy for synaptic contact .",
    "all curves show unweighted pr on the filtered set of bodies.,title=\"fig:\",scaledwidth=45.0% ]   global connectome graph precision / recall .",
    "* left : * the top blue curves show pr of the connectome graph , with the dashed curve computing pr using a weighted view of the graph edges , and the solid curve computing pr using a unweighted binary view of the graph edges .",
    "these curves are computed using the filtered set of bodies in the ground - truth segmentation , as described in section  [ sec : psd_perf ] . for reference ,",
    "the bottom red curves show weighted and unweighted pr if all bodies ( adding in orphan segments ) are considered . *",
    "right : * comparison against the baseline of using ground - truth body - proximity as a proxy for synaptic contact .",
    "all curves show unweighted pr on the filtered set of bodies.,title=\"fig:\",scaledwidth=45.0% ]    we next give a full end - to - end evaluation of our synapse detection pipeline , with respect to the final generated connectome . as determining an acceptable prediction accuracy is difficult without considering the particular connectomics application domain , we present a range of performance curves using our proposed error metrics .",
    "additionally , we compare against a baseline using neuronal - body proximity / contact as a proxy for synaptic contact . for this baseline",
    ", we use the _ ground - truth _ segmentation .",
    "we randomly sample points at boundaries between ground - truth segments , and then randomly select the direction of the synapse ( pre- and post - synaptic bodies ) . for this proximity - based comparison , we also compute precision / recall using an undirected view of the connectome graphs , thereby allowing for matches even if the predicted direction of synapse was incorrect .",
    "the left plot of figure  [ fig : fib25_syn ] gives the precision / recall of our proposed system , using the fully - automated predicted segmentation .",
    "we fix the threshold for t - bars at 0.73 , accepting all t - bars above this threshold , and vary the threshold for the psd detector to generate pr curves , under both a weighted and unweighted view of the connectome graph edges .",
    "the right plot shows a comparison against the baseline using body - proximity as a proxy for synaptic contact . even using the ground - truth segmentation , and computing the undirected edge pr",
    ", this baseline performs much worse .",
    "next , we evaluate synapse detection performance using our proposed variants to precision / recall , as shown in figure  [ fig : fib25_syn_thresh ] .",
    "we give curves when thresholding the edges at different values @xmath3 , , a ( unweighted ) edge is preserved in the connectome graph if the original edge weight is greater than @xmath3 .",
    "if @xmath4 , then the curve is equivalent to the above unweighted graph pr .",
    "we also give curves using our proposed asymmetric thresholded",
    "@xmath7 pr . we again compare with the baseline of using body - proximity .",
    "thresholded global connectome graph precision / recall .",
    "* left : * the solid blue curve shows the unweighted pr from the previous figure , which is equivalent to a threshold of @xmath4 .",
    "the red curves give symmetric thresholded pr at @xmath25 .",
    "the green curves show asymmetric thresholded pr at @xmath26 . *",
    "right : * comparison against the baseline using body - proximity .",
    "focusing on strong error cases shows that while the proposed method only makes a few mistakes at @xmath27 , the body - proximity baseline still performs comparatively poorly.,title=\"fig:\",scaledwidth=45.0% ]    thresholded global connectome graph precision / recall .",
    "* left : * the solid blue curve shows the unweighted pr from the previous figure , which is equivalent to a threshold of @xmath4 .",
    "the red curves give symmetric thresholded pr at @xmath25 .",
    "the green curves show asymmetric thresholded pr at @xmath26 . *",
    "right : * comparison against the baseline using body - proximity .",
    "focusing on strong error cases shows that while the proposed method only makes a few mistakes at @xmath27 , the body - proximity baseline still performs comparatively poorly.,title=\"fig:\",scaledwidth=45.0% ]    we give another view of synapse detection performance , using our metrics of connections strongly added and missed , in figure  [ fig : fib25_syn_addmiss ] . for the case of thresholding with @xmath27 , we have a total of about 2000 edges in the ground - truth connectome with a weight of at least @xmath28 .",
    "using our proposed system , we can recover approximately 99% of these edges ( 1% connections missed ) while introducing only 1% falsely added connections . by comparison , from the right plot in figure  [ fig : fib25_syn_addmiss ]",
    ", we can see that using body - proximity as a proxy for synaptic connection , when thresholding by @xmath27 and considering the directed graph , the normalized number of connections added and missed is approximately 50%/50% .",
    "therefore , even with this error metric that focuses on clearer , more ambiguous errors , this baseline approach is missing half the ground - truth connections and adding in approximately the same number of false connections .",
    "thresholded global connectome graph connections added / missed . *",
    "left : * the curves show errors in terms of connections that added and missed , using the same thresholds as the pr curves in figure  [ fig : fib25_syn_thresh ] . *",
    "right : * comparison against the baseline using ground - truth body - proximity , both directed and undirected edges.,title=\"fig:\",scaledwidth=45.0% ]    thresholded global connectome graph connections added / missed . * left : * the curves show errors in terms of connections that added and missed , using the same thresholds as the pr curves in figure  [ fig : fib25_syn_thresh ] . *",
    "right : * comparison against the baseline using ground - truth body - proximity , both directed and undirected edges.,title=\"fig:\",scaledwidth=45.0% ]    lastly , we present plots comparing automatic versus manual synapse counts when restricting edges to a core set of bodies and connectome , used in a study by takemura  @xcite . figure  [ fig : fib25_count ] gives scatter plots , where each point gives the automated and manual synapse count for an edge in the connectome .",
    "as mentioned above in section  [ sec : psd ] , our proposed system has limitations in that it does not attempt to predict autapses , and predicts at most one connection from a t - bar to a given post - synaptic body .",
    "we therefore also give a comparison of automatic versus manual counts , shown in the right , after removing autapses and collapsing multiple connections from a single t - bar to the same post - synaptic body .",
    "comparison of manual and automatic synapse counts , where each point indicates the counts for an edge in the connectome .",
    "edge weights of zero have been shifted to 0.5 to appear on the log plot .",
    "dashed lines indicate @xmath29 and @xmath30 .",
    "* left : * comparison with full ground - truth connectome . *",
    "right : * comparison after removing ground - truth autapses and collapsing multiple connections from one t - bar to the same post - synaptic body.,title=\"fig:\",scaledwidth=45.0% ]    comparison of manual and automatic synapse counts , where each point indicates the counts for an edge in the connectome .",
    "edge weights of zero have been shifted to 0.5 to appear on the log plot .",
    "dashed lines indicate @xmath29 and @xmath30 .",
    "* left : * comparison with full ground - truth connectome . *",
    "right : * comparison after removing ground - truth autapses and collapsing multiple connections from one t - bar to the same post - synaptic body.,title=\"fig:\",scaledwidth=45.0% ]    we note that , for strong edges with a synapse count of 25 or above , our automated predictions fall within the indicated bounds of @xmath29 and @xmath30 .",
    "we can also examine edges in the automated and ground - truth connectome for which the corresponding connectome has a synapse count of zero .",
    "we can thus see that , for all edges with a manual synapse count of at least 5 , we are able to recover the edge , in the sense that the automated prediction gives a synapse count of at least one .",
    "conversely , for all edges with an automated synapse count of at least 8 , the edge appears in the ground - truth connectome , as the manual synapse count is at least one .",
    "in this paper , we have proposed an end - to - end system for automatic synapse detection in em image data , capable of handling the polyadic synapses found in drosophila .",
    "we have additionally proposed a set of metrics to better assess the quality of a set of synapse predictions and whether such predictions are sufficiently accurate to be of use in connectomic studies .",
    "we evaluate our system on the drosophila seven column medulla data set , and show that it is capable of reconstructing high multiplicity synaptic connections , preserving biological pathways , while only making a small number of clear errors , and greatly outperforms a baseline using body proximity as a proxy for synaptic connection .",
    "one current limiting factor in our proposed system is the amount of run - time required for inference , as we scale analysis to larger image volumes .",
    "we have experimented with producing synapse predictions for image volumes as large as several tera - voxels ; in these case , distributed inference over a cluster of up to two thousand nodes took on the order of several weeks .",
    "the majority of this time is spent on the initial t - bar detection step . however , in on - going work , we have experimented with a convolutional architecture for t - bar detection , and traded off width ( number of feature maps ) for increased depth , and have seen improvements in speed while maintaining performance ."
  ],
  "abstract_text": [
    "<S> extracting a connectome from an electron microscopy ( em ) data set requires identification of neurons and determination of connections ( synapses ) between neurons . as manual extraction of this information </S>",
    "<S> is very time - consuming , there has been extensive research effort to automatically segment the neurons to help guide and eventually replace manual tracing . until recently , </S>",
    "<S> there has been comparatively less research on automatically detecting the actual synapses between neurons . </S>",
    "<S> this discrepancy can , in part , be attributed to several factors : obtaining neuronal shapes is a prerequisite first step in extracting a connectome , manual tracing is much more time - consuming than annotating synapses , and neuronal contact area can be used as a proxy for synapses in determining connections .    </S>",
    "<S> however , recent research has demonstrated that contact area alone is not a sufficient predictor of synaptic connection @xcite . moreover , as segmentation has improved , we have observed that synapse annotation is consuming a more significant fraction of overall reconstruction time ( upwards of 50% of total effort ) . </S>",
    "<S> this ratio will only get worse as segmentation improves , gating overall possible speed - up . </S>",
    "<S> therefore , we address this problem by developing algorithms that automatically detect pre - synaptic neurons and their post - synaptic partners . in particular , pre - synaptic structures are detected using a deep and wide multiscale recursive network ( dawmr ) , and post - synaptic partners are detected using a multilayer perceptron ( mlp ) with features conditioned on the local segmentation .    </S>",
    "<S> this work is novel because it requires minimal amount of training , leverages advances in image segmentation directly , and provides a complete solution for polyadic synapse detection . </S>",
    "<S> we further introduce novel metrics to evaluate our algorithm on connectomes of meaningful size . </S>",
    "<S> these metrics demonstrate that complete automatic prediction can be used to effectively characterize most connectivity correctly . </S>"
  ]
}