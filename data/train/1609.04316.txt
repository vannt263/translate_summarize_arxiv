{
  "article_text": [
    "the brain is thought to consist of a network of interconnected , interacting components whose architecture is critical for the emergence of adaptive behaviors and cognition  @xcite .",
    "graph theory provides a powerful means to assess topology and organization of brain connectivity networks , like those derived from mri and other neuroimaging methods  @xcite . within this framework ,",
    "the brain is represented as a network of @xmath0 nodes interconnected by @xmath1 links .",
    "typically , the nodes correspond to anatomically defined brain regions and the links to a measure of interregional interaction or similarity  @xcite . for resting state functional connectivity networks ,",
    "edge weights are defined as interregional temporal correlations in the fluctuations of the bold signals , and the resulting graph can be represented by a correlation adjacency matrix .",
    "the arcs of structural connectivity networks ( the `` connectome '' ) , conversely , reflect the number of white matter tracts connecting any two regions .",
    "brain networks have also been defined on the basis of intersubject anatomical covariance  @xcite , co - activation of different brain regions across individuals subjected to experimental tasks  @xcite or pharmacological challenges  @xcite .",
    "all of these networks are `` weighted '' by definition , i.e. their edges are associated with real numbers representing a measure of the strength of pairwise interactions between nodes .",
    "graph  theoretical analysis of these networks has contributed substantially to our understanding of the topological organization of brain connectivity , revealing a small - world , rich - club structure  @xcite and the presence of hub regions characterized by high connectivity and network centrality .",
    "additionally , a number of studies ( reviewed in  @xcite ) have investigated the modular structure of brain connectivity networks , highlighting cohesive clusters of nodes that are more densely connected among themselves than with the rest of the network . in the graph - theory jargon , these disjoint clusters are sometimes dubbed `` communities '' , remnant of early investigations in the field of social sciences  @xcite .",
    "topological modularity is thought to reflect functional and anatomical segregation , a feature that may confer robustness and adaptivity to brain networks .",
    "moreover , the degree of clustering within functional connectivity graphs may provide a measure of the balance between segregation and integration underlying brain function  @xcite .",
    "finally , the identification of modules and their boundaries is important to understand the topological function of hub regions within the network  @xcite .",
    "indeed , hubs sharing a large number of within - module edges may be critical to determine segregation of sub - structures within the network , while hubs connecting different modules are responsible for network integration  @xcite .",
    "alterations in the community structure of the brain have been observed in several neuropsychiatric conditions , including alzheimer disease  @xcite , schizophrenia  @xcite and chronic pain  @xcite , and assessment of the brain modular organization may provide a key to understanding the relation between aberrant connectivity and brain disease .    following initial work by  @xcite",
    ", several graph theoretical methods have been deployed to investigate the modular structure of brain networks  @xcite . typically , these methods rely on the optimization of a fitness function that measures the quality of a network partition against that of an ensemble of randomized networks with similar statistical properties ( the `` null model '' ) .",
    "optimization of the fitness function of choice is often computationally demanding and scales steeply with increasing network size .",
    "hence , heuristics are needed to calculate nearly optimal partitions of large networks , like those derived from neuroimaging data , within reasonable computation time  @xcite .    a seminal finding in graph theory",
    "is that clustering methods based on optimization of a global function suffer from a resolution limit  @xcite , as they are unable to resolve modules that are smaller than a scale determined by the size of the entire network .",
    "this problem was first demonstrated for newman s modularity  @xcite , a method included in the brain connectivity toolbox  @xcite and most frequently applied to the analysis of neuroimaging data .",
    "subsequent work by various groups has demonstrated that the resolution limit is quite pervasive and affects , to a different extent , many other methods based on optimization of a global fitness functions  @xcite , including reichardt and bornholdt s  @xcite , arenas and gomez  @xcite , ronhovde and nussinov s  @xcite , rosvall and bergstrom s ( _ infomap _ )  @xcite and others .",
    "the introduction of a resolution parameter has been proposed as a means to mitigate the problem by adjusting the resolving power of the function to a specific scale  @xcite .",
    "however , this approach enables resolution of smaller clusters at the expense of larger ones , which may be unduly subdivided , thus resulting in partitions with relatively uniform cluster size distributions that do not capture the complex modular structure of real - world networks  @xcite .",
    "recently , we have assessed the effects of the resolution limit on the analysis of brain connectivity networks  @xcite .",
    "specifically , we have shown that this limitation severely curtails the ability to detect small , but functionally and anatomically meaningful clusters of nodes even when they present high densities of intra - cluster edges .",
    "moreover , we showed that resolution - limited methods , like newman s modularity , do not reflect the multiple scales of the organization of brain connectivity networks , where small and large modules can coexist .",
    "we have also demonstrated that surprise , a conceptually different fitness function grounded in probability theory , behaves like a resolution - limit - free function  @xcite .",
    "maximization of surprise , based on an algorithm dubbed fagso , revealed a heterogeneous distribution of modules within brain resting state and coactivation networks .",
    "if confirmed , these findings would suggest that a substantial revision of current models of brain modular structure may be in order .",
    "a fundamental limitation of surprise lies in its definition in terms of discrete probability and binomial coefficients that make it applicable only to binary networks , i.e. graphs with edge values @xmath2 or @xmath3 .",
    "this may represent a substantial drawback , for it requires binarization of brain connectivity networks , thus discarding potentially important information contained in the edge weight distribution .",
    "moreover , different binarization procedures may lead to different network representations for the same connectivity dataset .",
    "therefore , an extension of surprise to weighted networks would be highly desirable , and would provide a new and important tool to study the modular organization of brain connectivity beyond the resolution limit .",
    "capitalizing on recent development in the field of statistical physics of complex networks  @xcite , here we describe and demonstrate the use of asymptotical surprise , a weighted counterpart to surprise , in the study of the modular structure of weighted networks .",
    "moreover , we propose a new algorithm , dubbed paco ( partitioning cost optimization ) for the maximization of asymptotical surprise .",
    "the performance of this novel approach is assessed on synthetic networks with pre - defined ground - truth modular structures , and compared to some of the leading graph partitioning methods .",
    "importantly , we demonstrate our approach in networks derived from synthetic data that mimic different structures , levels of noise and variability , such as those observed in functional connectivity experimental data . indeed ,",
    "improved resolution afforded by asymptotical surprise may imply increased vulnerability to spurious modules resulting from noisy correlations .",
    "it is therefore important to assess the benefits of increased resolution against the limitations arising from intrinsic data variability .",
    "finally , we apply asymptotical surprise to weighted functional connectivity networks from resting state fmri data .",
    "the implications of the heterogeneous , multiscale community structure revealed by this resolution - limit - free method are discussed in the context of the current models of the brain modular organization .",
    "here we briefly summarize the terminology and the notation that will be used throughout the paper . a binary graph",
    "@xmath4 is a representation of a set @xmath5 of @xmath0 nodes , also called _ vertices _ , connected by @xmath1 links ( or edges ) , in a set @xmath6 .",
    "the adjacency matrix @xmath7 of a binary graph is a square @xmath8 symmetric matrix with elements @xmath9 when an edge exists between vertex @xmath10 and @xmath11 and @xmath3 otherwise .",
    "we denote the total number of possible links in the graph as @xmath12 .",
    "a weighted graph @xmath13 assigns as a set of edge weights @xmath14 to the links . for weighted graphs ,",
    "the adjacency matrix is square , symmetrical and has real elements .",
    "a clustering @xmath15 of @xmath16 is a partitioning of @xmath5 into disjoint sets of nodes , @xmath17 , which we call modules or communities .",
    "each module consists of @xmath18 nodes , @xmath19 edges and @xmath20 pairs of nodes . on weighted graphs we define @xmath19 as the sum of edge weights inside a community .",
    "the sum of edges internal to all communities , @xmath21 and the intra - cluster pairs @xmath22 are @xmath23 and @xmath24 respectively .",
    "surprise  @xcite is a quality measure of the partition of a binary network that has its roots in probability theory . for a given partition @xmath25",
    ", surprise represents the probability that a graph drawn uniformly at random from the set of all graphs with @xmath0 nodes , @xmath12 pairs and @xmath1 edges has at least as many intra - cluster edges as @xmath16 . intuitively the lower the probability the better the partition .    for binary networks ,",
    "surprise can be computed within the discrete probability theory of urn models as : @xmath26 due to numerical precision problems in the evaluation of large binomial coefficients , @xmath27 is often taken as measure of quality of the partition , with higher values corresponding to better clustering .",
    "surprise quantifies the extent of the departure of the distribution of intra - cluster nodes and edges from that of a randomly drawn partition with the same internal density as in the original graph  @xcite . in the limit of large networks",
    ", surprise can be approximated by a binomial distribution : this observation led to weighted definition of surprise @xmath28 , dubbed asymptotical surprise  @xcite :    @xmath29    where , for brevity of notation , @xmath30 and @xmath31 are the observed and expected fraction of intra - cluster links relatively and @xmath32 is the binary kullback - leibler divergence  @xcite .    in the framework of information theory  @xcite",
    ", asymptotical surprise represents the kullback - leibler divergence between the observed and expected fraction of intra - cluster edges ; it encodes the information lost when the prior distribution @xmath33 is used to approximate the posterior distribution @xmath34 .",
    "kullback - leibler divergence is a quasi - distance on probability distributions as it is always non - negative , non - symmetric and zero only when @xmath35 like binary surprise .",
    "asymptotical surprise has a simpler formulation than binary surprise as there are no binomial coefficients to evaluate and it has been shown to be resolution - limit - free in the limit of large networks  @xcite .",
    "finding the optimal partition of a graph is an np - hard problem  @xcite and practical implementations of community detection rely on heuristic approaches that enable finding nearly - optimal solutions in a reasonable computation time .",
    "here we introduce a powerful and general method for the optimization of asymptotical surprise dubbed paco ( partitioning cost optimization ) .",
    "paco is a non - deterministic agglomerative algorithm based on fagso and , like the louvain method , has an element of randomness that enables a more efficient exploration of the partition landscape .",
    "the operating principle of paco is based on the triadic closure property , i.e. the fact that in real - world networks nodes with many common neighbors are more likely to be neighbors .",
    "this transitive neighborhood property underlies the formation of communities of nodes  @xcite . in principle , any measure of structural similarity between nodes could guide a community detection heuristic toward the optimal partition .",
    "specifically , paco uses the jaccard index  @xcite , a measure of the fraction of overlap between the neighbors in common between nodes , as the guiding principle for the agglomeration of similar nodes in the same community .    in the first phase of paco",
    ", the jaccard metric is evaluated for every edge .",
    "more formally , for an edge @xmath36 the jaccard index is computed as @xmath37 where @xmath38 and @xmath39 are the neighboring nodes of @xmath40 and @xmath41 respectively .",
    "the agglomerative process starts with an initial partition where every vertex represents a community on its own .",
    "this partition has @xmath0 communities and no intra - cluster edges .",
    "the edges of the graph are then ranked in decreasing order by their jaccard index and iteratively , for every edge in the sorted list , endpoint nodes are merged only if they belong to different communities . in this case one of the two endpoints , selected by chance , is assigned to the other s endpoint community and the increment of surprise is computed : if it is positive , the partition is updated together with the new value of surprise ( or asymptotical surprise ) , otherwise the algorithm proceeds to the next edge .",
    "detailed pseudocode for paco is shown in the supplementary materials , figure s1 .",
    "the main difference between paco and its predecessor fagso is the data structure used to store the community structure .",
    "fagso maintains the community structure in a disjoint - set data structure and when one vertex is moved into another s community , the two modules are merged into one ( supplementary materials , figure s2 ) .",
    "conversely , paco moves single nodes between different communities , and never merges modules ( supplementary materials , figure s2 , boxes c , d ) .",
    "this results in a more finely - grained optimization that allows a better exploration of the quality function landscape .      here",
    "we introduce a theoretically sound method for the generation of synthetic fc networks that mimic properties of resting state fmri networks , including noise and intersubject variability , while presenting a pre - determined ground - truth modular structure against which the performance of community detection algorithms can be tested .",
    "the general idea is that , starting from an adjacency matrix with a given modular structure , we can generate time - courses for each of the nodes whose pairwise correlations reproduce the edge structure of the original matrix .",
    "noise can be added to the time - courses , and the resulting correlation matrix will provide a noisy representation of the original one",
    ". this procedure can be repeated multiple times to produce different datasets that represent different `` subjects '' in the study .    in practical terms ,",
    "given an undirected weighted graph @xmath42 whose community structure is known a - priori , we have calculated its nearest positive definite matrix  @xcite and its cholesky decomposition , i.e. an upper triangular matrix @xmath43 such that @xmath44 .",
    "starting from uncorrelated variables @xmath45 , we have generated correlated random variables @xmath46 such that @xmath47 . additionally , we have injected different levels of noise into @xmath48 prior to the computation of the correlation matrix .",
    "schematic of this procedure is shown in figure  [ fig : flowchart ] .",
    "we tested this idea on two different models of planted partition : a variant of the ring of cliques  @xcite and the lancichinetti - fortunato - radicchi ( lfr ) network  @xcite , whose degree distribution and modular structure can be tuned to replicate topological features of real - world networks , including scale freeness  @xcite and the presence of densely interconnected cores  @xcite .",
    "one important finding in  @xcite is that brain networks are organized in modules with heterogeneous size distributions .",
    "we implemented this property in our two types of benchmark networks .",
    "for the first test , we generated a ring of cliques with @xmath49 nodes , and sizes of the cliques sampled from a power - law with exponent @xmath50 minimum and maximum clique size respectively @xmath51 , @xmath52 .",
    "for each subject of the sample , we synthesized @xmath53 time - points for each node using the ` neurosim r ` package  @xcite .",
    "we set the baseline value of all the time series to @xmath54  @xcite .",
    "finally , we correlated the original synthetic time series @xmath55 by multiplication with the matrix @xmath56 , obtained the correlated time series @xmath48 and added rician noise to @xmath48 independently for each area .",
    "the simulated data @xmath48 did not include slow drift components , simulated physiological noise , nor spatial noise .",
    "the average snr was defined as @xmath57 where @xmath58 is the average magnitude of the signal and @xmath59 is the standard deviation of the noise  @xcite .    in order to be more exhaustive and extend the validity of results",
    ", we repeated the same procedure on weighted lfr networks with @xmath60 nodes , sampling nodes degree from a power - law with exponent @xmath61 , average degree @xmath62 and maximum degree @xmath63 .",
    "we set the topological mixing coefficient , i.e. the fraction of intra - cluster and inter - cluster links , to @xmath64 .",
    "planted community sizes ranged from @xmath65 to @xmath66 nodes and were sampled from a power law with exponent @xmath67 .",
    "group - level correlation matrices were computed by fisher - transforming and averaging individual instances of the above matrices .",
    "sparsification was obtained by removing edges with weights below a threshold determined by percolation analysis  @xcite .",
    "this approach measures the size of the largest connected component of the network upon iterative removal of the weakest edges and enables data - driven determination of the optimal sparsification threshold that preserves network structure and connectedness while removing potentially spurious correlations .",
    "the community structure of the resulting weighted sparsified matrices was detected by asymptotical surprise optimized with paco and compared against two widely used methods , infomap  @xcite and newman s modularity  @xcite , that are affected by the resolution limit , albeit to different extents . in newman s modularity , the size of the smallest detectable cluster is of the order of the square root of the number of edges in the entire network  @xcite .",
    "infomap has a limit that depends on the overall number of inter - cluster edges  @xcite .",
    "these two methods are based on different principles to detect the community structure of a graph .",
    "modularity finds the optimal partition by maximizing intra - cluster edge - density against that of a configuration model  @xcite .",
    "optimization of this fitness function is typically performed using the louvain method , a greedy agglomerative clustering algorithm that works on hierarchical refinements of the network s partitions .",
    "here we used the louvain implementation available in the brain connectivity toolbox  @xcite .",
    "the idea behind infomap is the minimization of the description length  @xcite of a random walker defined on the network through a set of heuristics . for this study we used the infomap implementation available in the ` igraph-0.7.1 ` package  @xcite .    for all methods , including paco ,",
    "we launched @xmath68 independent runs , and picked the membership corresponding to the partition with the best value of the fitness function , the maximum for modularity and asymptotical surprise , the minimum for infomap .",
    "our implementation of paco as well as the code to generate benchmark lfr networks was written in ` c++ ` with bindings in matlab , octave , python .",
    "the software is available upon request .      for each method",
    ", we analyzed the level of agreement of the detected community structure against the planted one in terms of normalized mutual information ( nmi )  @xcite .",
    "additionally , we used two different coefficients of similarity between partitions : sensitivity and specificity .",
    "to this end , we quantified the confusion matrix @xmath69 between the detected and planted modules .",
    "each element @xmath70 is the number of nodes in the planted community-@xmath10 that appear in the detected community-@xmath11 .",
    "for each planted community we scored as true positives ( tp ) the nodes correctly identified as belonging to the ground - truth community , and as false positives ( fp ) the nodes wrongly assigned to a community ; similarly false negatives ( fn ) were nodes wrongly classified in different communities and true negatives ( tn ) the nodes correctly classified as out of the community .",
    "sensitivity , defined as @xmath71 , decreases with increasing number of false negatives .",
    "specificity instead is defined as @xmath72 and decreases when many nodes are wrongly assigned in the same community . additionally , we computed accuracy and matthew correlation coefficient ( see supplementary materials for definitions ) .",
    "we applied asymptotical surprise maximization by paco to a reference resting state fmri functional connectivity dataset from healthy subjects  @xcite made available to the scientific community through the public brain connectivity toolbox  @xcite .",
    "detailed experimental and image processing procedures are described in the original paper  @xcite , alongside with the ethical statements .    in short ,",
    "fmri data were acquired from 27 healthy volunteers at 3 t .",
    "gradient echo - planar imaging data were collected for 5 min with 2s tr and 13 and 31 ms echo - times .",
    "thirty six interleaved 3 mm slices with in - plane resolution of @xmath73 mm were acquired .",
    "time series were extracted from 638 brain regions defined by a template  @xcite , corrected for motion and band - passed ( 0.010.1hz ) .",
    "functional connectivity was defined in terms of pairwise pearson correlations at a subject s level .",
    "a group - level functional connectivity matrix was calculated by averaging individuals matrices after fisher - transform , and thresholded to retain 18625 edges , as described in crossley et al .",
    "we used brainnetviewer as a tool for the visualization of the communities on brain templates  @xcite .",
    "we compared the quality of the partitions of the synthetic benchmark networks obtained by asymptotical surprise with those of infomap  @xcite and newman s modularity  @xcite . figure [ fig : nmisensitivityspecificityringclique ] shows normalized mutual information , sensitivity and specificity of the three methods applied to the ring of cliques for different sample sizes and snrs ; no - noise condition is represented as `` inf '' .",
    "this model network was constructed to test the ability of the three methods to retrieve heterogeneous community structures under various noise conditions .",
    "as expected , all methods showed better performance with increasing snr and number of subjects , as noise and intersubject variability introduce spurious edges that hinder the ability to retrieve the planted structure .",
    "partitions obtained with newman s modularity showed the lowest nmi with respect to the planted partition under all conditions .",
    "sensitivity of newman s modularity did not exceed @xmath74 even for high snrs and a large number of subjects , a consequence of its stronger resolution limit . for this network , infomap performed substantially better in terms of nmi against the planted partition , with a sensitivity that was superior to that of modularity across the spectrum of conditions .",
    "asymptotical surprise showed highest nmi and sensitivity across conditions , consistent with its resolution - limit - free behavior .",
    "asymptotical surprise proved superior in terms of nmi and sensitivity in the low snr regimes , and in the presence of relatively large intersubject variability as mimicked by the generation of different instances of the ring of cliques ( see methods section ) .",
    "specificity of asymptotical surprise was not inferior to the other methods under all conditions , thus ruling out increased vulnerability to false positives , at least in this particular model network .",
    "comparable results were obtained for the lfr network ( figure  [ fig : nmisensitivityspecificitylfr ] ) , a model graph that replicates the distribution of nodal degree observed in many real - world networks , including those representing brain functional connectivity .",
    "all three methods showed similar values of nmi for high snr and a large number of subjects , with a plateau reaching maximum sensitivity with a group sample bigger than @xmath75 and snr above @xmath76 .",
    "sensitivity was only slightly worse for modularity , but it should be noted that for the lfr network the size distribution of the planted modules was narrower than for the ring of cliques ( figure  [ fig : lfrringclique ] ) , thus making the resolution limit less evident .    in the lower snr regime ,",
    "asymptotical surprise presented the best performance in terms of nmi and sensitivity , with a slower decay for decreasing snr .",
    "specificity was almost equivalent across the three methods , with a quick convergence to the maximum value of 1 for high snr and good performance ( around @xmath77 ) for low snr .",
    "asymptotical surprise presented a faster decay with decreasing snr .",
    "however , it should be noticed that the scale of specificity has a very narrow range ( @xmath77-@xmath78 ) , and the differences between the three methods were relatively small .    for the sake of completeness , we also computed accuracy and matthew correlation coefficient for the same model networks , shown in the supplementary materials . notably , infomap showed a large variability in accuracy for lower snrs and number of subjects . under closer examination , however , it appeared that the increased variance for infomap was due to occasional runs in which the algorithm only retrieved one or two large modules .",
    "this is a known problem with infomap and other algorithms based on random walks that depends on the need to parametrize the teleportation step in order to make the dynamics ergodic  @xcite .",
    "altogether , the picture that emerges from the analysis of accuracy and mcc is entirely consistent with the results shown in this section .",
    "figure  [ fig : partitioncomparison ] shows a comparison between the modular structure of the resting state fmri dataset obtained with newman s modularity , infomap and asymptotical surprise . for each method",
    ", we had @xmath68 independent runs and picked the partition with the best value of the respective fitness functions ( @xmath79 , @xmath80 , @xmath81 , for modularity , infomap and asymptotical surprise , respectively ) .",
    "the three methods showed significantly different partitions , with a number of detected communities of 10 , 19 and 47 for modularity , infomap and asymptotical surprise , respectively .",
    "interestingly , modularity detected a relatively uniform size distribution , consistent with the intrinsic scale built into the fitness function .",
    "infomap showed a wider distribution of module sizes , with number of nodes ranging between 156 and 3 , while surprise showed the largest spread , and included communities as small as single nodes ( singletons ) .",
    "figure  [ fig : cervellini4x4 ] shows the 16 largest modules detected by asymptotical surprise , ranked by number of nodes comprised in each community . the first and largest module ( fig .",
    "[ fig : cervellini4x4]a ) includes the pre- and post - central gyri , part of the supramarginal gyrus and supplementary motor area . the second community ( fig .",
    "[ fig : cervellini4x4]b ) consists largely in nodes belonging to the occipital lobe : the visual areas and the surrounding calcarine sulcus , the lingual and fusiform gyrus . the third module ( fig .",
    "[ fig : cervellini4x4]c ) reflects the default mode network , spanning the temporo - parietal cortex , the medial prefrontal cortex and the posterior cingulate / precuneus .",
    "the nodes involved in the executive frontal functions form the fourth largest community .",
    "interestingly , nodes in the communities d , e , g are the major players that take part in the so - called fronto parietal attentional network  @xcite .",
    "the auditory network , comprising temporal areas , was detected as a distinct community ( fig .",
    "[ fig : cervellini4x4]f ) .",
    "deeper structures emerge as separate modules in fig .",
    "[ fig : cervellini4x4]h , with subcortical areas including the basal ganglia , i.e. putamen , globum pallidum , caudate nucleus and the whole thalamus .",
    "the hippocampus and the parahippocampal gyrus were identified as separate communities ( o and p ) .",
    "additional , smaller substructures are shown in the third and forth row of figure  [ fig : cervellini4x4 ] , including the supplementary motor area ( fig .",
    "[ fig : cervellini4x4]j ) and the orbital ( fig .",
    "[ fig : cervellini4x4]m ) and orbitofrontal ( fig .",
    "[ fig : cervellini4x4]i ) modules , containing nodes from brodmann area 47 .",
    "partitions of the functional connectivity network obtained by newman s modularity and infomap are reported in the supplementary materials section ( figures s4 and s5 ) .",
    "newman s modularity retrieved four large , relatively uniform communities , corresponding to the default mode network , the central network , occipital and frontoparietal networks .",
    "this is in keeping with previous studies using modularity optimization by spectral decomposition  @xcite , and consistent with the strong resolution limit that affects this method .",
    "additionally , a few smaller modules were found by louvain optimization of newman s modularity , corresponding to the basal ganglia , the hippocampal / parahippocampal formation and two asymmetrically distributed subcortical clusters .",
    "infomap identified 19 communities of various sizes , also shown in the supplementary materials section , figure s5 .",
    "the largest modules showed a close correspondence with those identified by asymptotical surprise , albeit with some notable differences .",
    "by way of example , the largest component includes the motor - sensory and auditory modules , identified as separate communities by asymptotical surprise .",
    "the default mode network retrieved by infomap includes parts of the temporal cortices that are not normally associated with the dmn .",
    "similarly , hippocampus and the parahippocampal modules were merged by infomap , and resolved as individual modules by asymptotical surprise .",
    "other modules , including the visual , associative and executive networks ( c , e and f in figure s5 , respectively ) were qualitatively very similar to those identified by asymptotical surprise .",
    "altogether , the picture that emerges is consistent with the idea that the resolution limit is more severe in newman s modularity than in infomap , and that asymptotical surprise presents the best resolving power among the three methods in a real - world network with finite snr and variability as the resting state functional connectivity network used for this study .",
    "the performance of asymptotical surprise optimization by paco was assessed in model graphs with a built - in community structure , and compared with two established community detection methods .",
    "we have chosen two synthetic benchmark networks , the ring of cliques and the lfr network .",
    "the ring of cliques presents a clear - cut modular structure by construct , with modules corresponding to complete subgraphs of variable sizes sampled from a power - law distribution .",
    "this toy network proved useful to assess the effects of the resolution limit in the presence of a wide distribution of cluster sizes .",
    "the effects of this limit were particularly apparent for newman s modularity ( figure  [ fig : nmisensitivityspecificityringclique ] ) , that showed poor sensitivity even for noiseless rings of cliques , plateauing at a value of @xmath74 .",
    "this is consistent with the findings of  @xcite , that showed that for modularity the resolution limit is set by the square root of the total number of edges in the graph . for infomap ,",
    "this limit is less severe and is determined by the number of inter - cluster edges  @xcite .",
    "accordingly , the effects of the resolution limit were not apparent in this model network , where modules are sparingly connected by single edges .",
    "asymptotical surprise presented the best performance , consistent with the idea that this cost function is quasi - resolution limit free  @xcite .",
    "however , real brain networks are characterized by heterogeneous distributions of node degree , with fat tails and power - law decays  @xcite .",
    "such heterogeneity is critical , as it determines some of the remarkable features of brain connectivity networks , including resilience to random failure and rich - clubness  @xcite . to provide a more realistic benchmark",
    ", we used the lancichinetti - fortunato - radicchi algorithm  @xcite , that makes it possible to generate networks with realistic and tunable power law degree distribution and community sizes .    for lfr networks ,",
    "the difference in performance in the low - noise regime was more nuanced for the three methods compared in this study , possibly a result of a fuzzier community structure of the lfr network compared to the ring of cliques , and of the narrower distribution of cluster sizes .",
    "however , the picture appears different when noise and intersubject variability were injected into the network structure .",
    "noise and other sources of variability in the data can significantly affect the structure of the resulting network representation .",
    "noisy fmri time - courses , for example , may introduce spurious correlations in brain functional connectivity networks .",
    "this problem may be particularly relevant for methods endowed with high resolution , like asymptotical surprise , that may be more vulnerable to false positives generated by the mis - assignment of peripheral nodes , particularly in small clusters .",
    "hence , the resolving power of community detection methods should be gauged against specificity , which maybe affected by noise in the distribution of edges that define the network s structure . however , to the best of our knowledge , this aspect has never been considered in the existing literature assessing the performance of community detection algorithms as applied to the study of brain connectivity .    to this end",
    ", we have devised methods to inject noise , with amplitude and spectral distribution that mimic those of experimental noise , into networks with a well defined planted structure . moreover , we have generated difference instances for each network , corresponding to different subjects in a group , to account for intersubject variability that occurs in typical neuroimaging studies .",
    "unsurprisingly , for all methods and networks , detection of the planted structure improved with decreasing levels of noise , and with increasing number of subjects in the study .",
    "however , asymptotical surprise appeared to provide a superior performance in terms of nmi and sensitivity to the planted structure for lower snrs in both types of networks , while its specificity was in line with that of resolution - limited methods like newman s and infomap ( figures [ fig : nmisensitivityspecificityringclique],[fig : nmisensitivityspecificitylfr ] ) .",
    "this rules out the idea that the higher sensitivity to small clusters of asymptotical surprise may be detrimental in noisy networks , making it more vulnerable to small , spurious modules .",
    "application of asymptotical surprise maximization to a group - level , resting state functional connectivity network from the brains of @xmath82 healthy subjects revealed a heterogeneous distribution of modules , with large and small modules coexisting in the optimal partition .",
    "this is in keeping with previous findings with binary surprise  @xcite .",
    "these modules closely reflect functional networks reported in many studies using independent component analysis or other multivariate methods , including the sensorimotor , visual , default mode , executive , and attentional networks . moreover , anatomically defined subcortical structures , like the hippocampus and parahippocampal formations emerged as independent moduli .",
    "while this is entirely consistent with our understanding of the neurofunctional and anatomical organization of the human brain , the accuracy of asymptotical surprise in identifying these networks is notable .",
    "indeed , surprise , like other graph - based community detection methods , divides networks into disjoint clusters of nodes on the basis of topological criteria . while a correspondence between topological modularity and functional networks identified by , e.g , independent component analysis may be expected , it is not a given , for they are defined on different principles . indeed",
    ", multivariate methods like ica separate components on the basis of the statistical independence of the time - courses , and do not convey information regarding the mutual relationship between modules nor about their topological organization .",
    "previous studies applying resolution - limited methods like newman s modularity to the same dataset hereby analyzed  @xcite found a few , large modules encompassing large - scale networks , but failed to identify finer , neurofunctionally plausible substructures like those shown in the present study .",
    "infomap , on the other hand , proved sensitive to heterogeneously distributed clusters , thus implying that this method does not have an intrinsic scale , like modularity and variations thereof based on the introduction of a resolution parameter .",
    "however , asymptotical surprise appears to provide superior performance in identifying small subnetworks , particularly in the presence of noise , thus suggesting that this method may represent a new standard for community detection in brain networks .",
    "it should also be noted that no symmetry constraint was imposed , and the symmetrical bilateral distribution of nodes in the retrieved modules arises entirely from asymptotical surprise optimization .",
    "hierarchical clustering methods have been extensively applied to investigate the structure of brain connectivity networks , showing smaller and smaller clusters as the modules are iteratively subdivided  @xcite .",
    "maximization of asymptotical surprise reflects the optimal cut through the dendrogram representing connectivity at these different levels of subdivision , and provides information on the optimal partition of the network .",
    "hence , the heterogeneous distribution of cluster sizes retrieved by asymptotical surprise suggests that multiple scales of structure exist at the same level of the dendrogram .",
    "the presence of heterogeneously distributed modules in functional connectivity networks has important consequences for our understanding of the brain functional organization . by way of example",
    ", it has been shown that highly connected nodes , or hubs , are critically important in brain connectivity networks , and may play different roles depending on their position and connectivity distribution within and between modules  @xcite .",
    "hubs that primarily connect to nodes within the same community are dubbed `` provincial hubs '' , and are thought to be responsible for the definition and stability of the modules .",
    "conversely , hubs that connect different modules are referred to as `` connector hubs '' and ensure integration of the activity of the network .",
    "the classification of hubs strongly depends on the modular structure that is considered , and inaccurate partitioning due to the resolution limit can lead to the wrong interpretation of their role in the interplay between segregation and integration of brain function  @xcite .",
    "the present study suggests that this may have been the case in previous studies , in which resolution limited methods characterized by an intrinsic scale have been used , and provides a solution that will enable more accurate classification of hubs and nodes .",
    "finally , abnormal functional connectivity has been observed in a number of neurological and psychiatric diseases , but the coarse resolution of methods like newman s modularity  @xcite may have not detected differences in the modular organization of networks in patients compared to healthy controls . the improved resolution and sensitivity to",
    "multiscale structure afforded by asymptotical surprise may provide a powerful means to assess the brain functional architecture in disease states , thus contributing a potential imaging - based marker and a key to interpret the functional effects of aberrant connectivity .",
    "some caution should be taken in the interpretation of the graphs in figures [ fig : nmisensitivityspecificityringclique ] and [ fig : nmisensitivityspecificitylfr ] .",
    "indeed , the snrs of the synthetic networks we have generated reflect noise with features , like a rician distribution , that mimic some , but not all aspects of the variability of experimental data . by way of example",
    ", the brain parcellation scheme applied to define the nodes , and the heterogeneity of voxels within these parcels , may play a role that is difficult to model in toy networks  @xcite .",
    "hence , the simulated sensitivity and specificity as a function of snr and number of subjects should not be taken as absolute values to be used in the power and sample size estimation in real experimental designs .",
    "nevertheless , these simulations provide useful information on the dependence of these parameters on noise levels , and a rigorous means to assess the relative merits of different community detection methods .",
    "finally , we should note that the maximum value of asymptotical surprise calculated with paco is an index of quality of the entire partition , and not of individual modules .",
    "hence , individual modules may not all have the same strength of internal cohesiveness relative to their connection with other modules .",
    "we have found hints of this phenomenon in the comparison of nearly - optimal partitions obtained in the @xmath68 runs of paco that we have performed to find the optimal community structure for this network .",
    "the overall community structure appeared to be robust , with most modules persistently emerging in every nearly - optimal partition , but in some cases we observed pairs of modules splitting or merging in otherwise similar solutions .",
    "most notably , this was observed for the thalamus that in some instances was merged with the basal cluster and in others featured as a separate module .",
    "this phenomenon may be less critical for methods like newman s modularity that have an intrinsic scale and retrieve uniformly distributed modules .",
    "we have extended the use of surprise , a resolution - limit - free fitness function for the study of the modular structure of complex networks , to weighted brain functional connectivity networks .",
    "specifically , we have developed a novel method , dubbed paco , for the optimization of asymptotical surprise , a weighted counterpart of surprise in the limit of large networks .",
    "we have applied paco optimization of asymptotical surprise in synthetic networks to evaluate the relative merits of this novel approach against newman s modularity and infomap , two of the leading methods used for community detection in brain connectivity networks .",
    "specifically , we have implemented a process to inject noise into networks endowed with a ground - truth modular structure to assess the trade - off between improved resolution afforded by asymptotical surprise and potential sensitivity to spurious correlations introduced by variability in the data .",
    "asymptotical surprise optimization proved superior to existing methods in terms of sensitivity and accuracy in detection of the planted structure as measured by normalized mutual information , while showing comparable specificity .",
    "we have also applied our approach to the partitioning of functional connectivity networks from resting state fmri experiments .",
    "direct comparison with other methods clearly demonstrated improved capability to identify neurofunctionally plausible and anatomically well - defined substructures otherwise concealed by the resolution limit .",
    "asymptotical surprise revealed a complex modular structure of resting state connectivity , with communities of widely different sizes reflecting distributed functional networks alongside with small , anatomically or functionally defined modules .",
    "this evidence corroborates the idea that the resolution limit has negatively affected current models of the brain modular organization and the identification of the hubs responsible for integration of functional modules .",
    "the application of methods like asymptotical surprise provides a novel , powerful approach to study the modular structure of brain connectivity beyond this limit .",
    "the authors wish to thank prof .",
    "edward bullmore and prof .",
    "nicholas crossley for providing data and templates , and prof .",
    "pasquina marzola for her continuing support .",
    "this project has received funding from the european union s horizon 2020 research and innovation program under grant agreement no 668863 .",
    "c.b , c.n , a.b . conceived the experiments , c.n .",
    ", c.b . conducted the experiments , c.n .",
    "c.b , and a.b . wrote the paper and reviewed the analysis .",
    "all authors reviewed the manuscript .",
    "our implementation of paco as well as the code to generate benchmark lfr networks was written in ` c++ ` with bindings in matlab , octave , python .",
    "this software is available upon request .",
    "the authors declare no competing financial interests .",
    "10 url # 1`#1`urlprefix[2]#2 [ 2][]#2    & .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    , , , & .",
    "_ _ * * , ( ) .    & _ _ * * , ( ) .    .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .",
    "http://dx.doi.org/10.1002/mrm.21179 .    ,",
    "& _ _ * * , ( ) .    & . _",
    "_ * * , ( ) .",
    "& _ _ * * , ( ) .    &",
    "_ _ * * , ( ) .    , & _ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .",
    "http://dx.doi.org/10.1016/j.tics.2013.09.012 .",
    "_ et  al . _ .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .",
    "_ et  al . _",
    "_ _ * * , ( ) .    , , , & _ _ * * , ( ) .    , , , &",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .    & _ _ * * , ( ) .    & _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .    & _ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "& _ _ * * , ( ) .    &",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & _ _ ( , ) .    .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & _ _ * * , ( ) . http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3286928{&}tool=pmcentrez{&}rendertype=abstract[http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3286928\\{&}tool=pmcentrez\\{&}rendertype=abstract ] .    , , ,",
    "_ _ * * , ( ) . http://arxiv.org/abs/1601.07574 . .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .",
    ", & _ _ * * , ( ) .    &",
    ". _ _ * * , ( )",
    ".    _ et  al .",
    "_ _ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "http://dx.doi.org/10.1038/nrn3901 .",
    ", & _ _ * * , ( ) .    .",
    ", @xmath83 , @xmath63 , @xmath64 , @xmath84 , @xmath51 , @xmath52 .",
    "the layout of ( b ) was generated with the graph - tool library  @xcite.,scaledwidth=100.0% ]"
  ],
  "abstract_text": [
    "<S> graph theory provides a powerful framework to investigate brain functional connectivity networks and their modular organization </S>",
    "<S> . however , most graph - based methods suffer from a fundamental resolution limit that may have affected previous studies and prevented detection of modules , or `` communities '' , that are smaller than a specific scale . </S>",
    "<S> surprise , a resolution - limit - free function rooted in discrete probability theory , has been recently introduced and applied to brain networks , revealing a wide size - distribution of functional modules  @xcite , in contrast with many previous reports . however , the use of surprise is limited to binary networks , while brain networks are intrinsically weighted , reflecting a continuous distribution of connectivity strengths between different brain regions . here </S>",
    "<S> , we propose asymptotical surprise , a continuous version of surprise , for the study of weighted brain connectivity networks , and validate this approach in synthetic networks endowed with a ground - truth modular structure . </S>",
    "<S> we compare asymptotical surprise with leading community detection methods currently in use and show its superior sensitivity in the detection of small modules even in the presence of noise and intersubject variability such as those observed in fmri data . </S>",
    "<S> finally , we apply our novel approach to functional connectivity networks from resting state fmri experimenta , and demonstrate a heterogeneous modular organization , with a wide distribution of clusters spanning multiple scales .    </S>",
    "<S> * keywords : * brain networks , modularity , community detection , functional connectivity , asymptotical surprise . </S>"
  ]
}