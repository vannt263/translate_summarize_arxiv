{
  "article_text": [
    "during the past decade there has been considerable activity in studying the effect trait differences may have on the rates of speciation and extinction in the evolution of species ( @xcite gives an excellent presentation of these recent developments ) . the possibility that diversification may be trait dependent implies that these rates should not be inferred using standard trait independent methods .",
    "new likelihood methods that make better use of phylogenetic information were recently developed : `` bisse '' for binary state speciation and extinction , @xcite ; `` quasse '' for quantitative traits @xcite ; `` geosse '' for geographic character traits @xcite , `` classe '' for punctuated modes of character change @xcite ; and were used to make new conclusions about a number of different clades ( see @xcite for a recent survey ) .    inferring the evolutionary process",
    "poses in general a non - trivial reconstruction problem , as neither the rates nor the ancestral states in the phylogeny of present day species are known .",
    "the underlying ancestral trees are typically assumed to be known and reconstructed from aligned dna sequence data .",
    "predicting ancestral states is then typically done with one of a number of heuristic methods based on the principle of either : counting , maximum parsimony , or maximum likelihood . in such studies a markov chain of state changes is assumed to propagate down from the root along the given tree .",
    "many interesting theoretical results exist on the ability to reconstruct ancestral states along the tree and the state at the root from the states observed at the leaves ( see @xcite for a survey and @xcite for some recent developments ) for which results from statistical physics theory have been particularly useful ( @xcite ) .",
    "the focus so far was on reconstructing hidden states along the underlying tree , rather than parameters of the markov chain which propagates them . in phylogenetics",
    "the underlying tree is assumed to be either a random discrete binary tree , or a random yule tree generated by a neutral pure birth process .",
    "the shape of such a tree has the distribution of ` equal rates markov ' ( erm ) , and the tree resulting after propagating types can be called a _ multi - type erm tree_. we extend the model of propagating types down the tree to also include correlations of types between edges with the same branch - point .",
    "consequently , information on leaves will be insufficient for reconstruction and we will also use correlated substructures of the tree .",
    "inference for evolutionary processes whose birth and death rates are trait dependent adds an additional layer of mathematical difficulty .",
    "if we have a trait with finitely many variants ( or a continuum of variants is discretized into finitely many bins ) the full tree evolves according to a multi - type birth - death process , in which rates of speciation to different offspring types and the rate of extinction is specific to the type of that lineage .",
    "in such a branching process the shape of the tree and its edge lengths are inseparable from the distribution of states on the lineages .",
    "both the ratio of speciation to extinction rates for each state , as well as the transitions from a certain state to another play an important role in how the ancestral states are distributed along the tree .",
    "the ancestral tree of this branching process , obtained by pruning away the extinct lineages , turns out to be a random tree we call _ multi - type yule tree with mutations_. in such a tree the chance of a lineage splitting is state dependent , which leaves a signature on which splits are more frequent than others and is reflected in the proportion of different types of splits at the tips of the tree .",
    "we will use this information in the reconstruction of model parameters .",
    "very few theoretical results have been obtained for ancestral trees of multi - type branching processes .",
    "deriving an exact distribution for the ancestral tree is unsurprisingly challenging , as determining the likelihood of any split requires the knowledge of the parental type , and hence also all ancestral states on that lineage .",
    "in @xcite we developed a coalescent point - process approach to generating ancestral trees using the tips in an infinite ( quasi - stationary ) multi - type galton - watson branching processes .",
    "this construction relied on a horizontal exploration of the tips which was developed in @xcite and extended in @xcite ( the standard vertical coalescent construction is not possible for branching processes with type - dependent offspring distributions ) .",
    "it can be used for simulating and computing likelihood of ancestral trees , but calculating its statistical features is not easy , except in some very special cases .",
    "instead we focus on analyzing newly introduced a priori models on possible ancestral tree shapes . our _ multi - type erm tree _",
    "is a discrete time model that is a extension of markov propagation models on a random tree generated by a mechanism which picks a random leaf to extend on .",
    "our _ multi - type yule tree with mutations _ is a continuous time model and is a multi - type generalization of the tree generated by a pure birth process . in order to investigate their topological features we analyze the number of different types of cherries and different types of pendants in the tree : _ cherries _",
    "are pairs of leaves that are only one edge away from each other , and _ pendants _ are leaves that are more than a single edge away from another leaf .",
    "we use the random recursive mechanisms for generating splits in the trees to obtain exact results for finite sized trees , as well as asymptotic results as the trees grow in size .",
    "the distribution of the number of pendants and cherries in the tree reflects the model parameters and can be used to infer them .    for the multi - type erm random trees , we identify the mean number of cherries and their variance ( propositions  [ prop : meanscherries ] and  [ prop : varcherries ] ) , and also derive asymptotic results as the number of leaves in the tree grows ( theorems  [ thm : polya - coro-1 ] and  [ thm : polya - coro-2 ] ) .",
    "we use the limiting fraction of different cherries to infer the multi - type probabilities in the model ( corollary  [ cor : erminferrence ] ) .",
    "examples of particular models for multi - type erm trees are discussed in section  [ subsec : ermcases ] .",
    "for the multi - type birth - and - death process we first identify the process obtained by pruning away the extinct lineages ( proposition  [ prop : ancestral ] ) as a specific type of a multi - type yule tree with mutations . using the distribution of types at the leaves ( lemma  [ lem : meannudependant - eq ] )",
    "we find the distribution of different cherries and pendants ( propositions  [ prop : meanmudependant ] and  [ prop : meangamma ] ) in a general multi - type yule tree with mutations .",
    "we also derive their asymptotics in the long term limit ( theorem  [ thm : limit - eta - tdepnotcomm ] ) and provide the way in which the original speciation and extinction rates can be inferred from these topological features ( corollary  [ cor : contsinferrence ] ) .",
    "consider a ( single type ) random tree constructed recursively , from a single node leaf , by picking at each step one leaf uniformly at random and creating a branch - point by attaching two new leaves to it .",
    "the distribution of this tree is called ` equal rates markov ' ( erm ) ( first investigated in @xcite ) and has a long list of mathematical results associated to it ( @xcite ) . trees with this distribution can be generated in a number of different ways , forwards in time - by using a ( pure birth ) yule process stopped the first time it reaches a prescribed number of leaves and ignoring the random lengths of its branches , or backwards in time - starting from a prescribed number of leaves using a neutral ( coalescent ) moran process .",
    "they have been used in numerous studies as a null model in investigating pattterns in tree shapes ( @xcite ) . in terms of its statistical",
    "features the number of cherries @xmath0 for a tree with @xmath1 leaves is known ( @xcite ) to have the following properties : @xmath2=\\frac{n}{3}\\,\\,\\mbox { for } n\\geq 3,\\,\\,\\,\\,\\,{\\mathbb}{v}[c_n]=\\frac{2n}{45}\\,\\,\\mbox { for } n\\geq 5;\\ ] ] and their distribution satisfies a central limit theorem : @xmath3 their results were shown using an extended plya urn process ( see @xcite or @xcite ) .",
    "we consider a multi - type version of this random tree , where each node ( branch - points and leaves ) has a type @xmath4 associated with it .",
    "the shape of the tree is constructed in the same way as in the single type process , with each leaf having the same chance , regardless of its type , of being picked at random to create the next branch - point with two new leaves attached to it .",
    "the types of the two leaves being attached , however , depend on the type of the leaf that they are being attached to . for each type",
    "@xmath5 the probabilities @xmath6 determine the chance that a leaf of type @xmath7 has types @xmath8 attached to it .",
    "since we do not distinguish between different embeddings of the tree in the plane , we can w.l.o.g .",
    "assume @xmath9 .",
    "we call this tree a _ multi - type erm tree_. the random tree with types is distributed as a markov field ( with propagation matrix @xmath10 ) on an erm tree .",
    "note that , for each @xmath7 , @xmath11 . in order to avoid trivial cases that generate only single type trees we will assume throughout that @xmath12 .",
    "+     +    for the sake of simplicity we consider @xmath13 .",
    "there are @xmath14 different types of cherries @xmath15 and @xmath16 different types of pendants @xmath17 , as illustrated in figure  [ fig : cherriestypes ] .",
    "figure  [ fig : treecherries ] illustrates cherries in an example of a tree with @xmath18 leaves .      for a tree with @xmath1",
    "leaves we let @xmath19 denote the number of leaves of type 1 , @xmath20 the number of leaves of type 2 , and @xmath21 the number of cherries of type @xmath22 .",
    "their means are relatively straightforward to calculate .",
    "[ lem : meanleaves ] assume the probabilities @xmath23 satisfy for @xmath24 and @xmath25 .",
    "then , @xmath26 , @xmath27=\\frac{c_2n}{2-c_1+c_2}-\\frac{(2c_2 -(2-c_1+c_2)\\nu_1(2))\\gamma(n-1+c_1-c_2)}{(2-c_1+c_2)\\gamma(c_1-c_2 + 2)\\gamma(n)},\\ ] ] where @xmath28 is the gamma function , and @xmath29 .",
    "+ analogous formula holds for @xmath30 $ ] in which : @xmath31 is replaced by @xmath32 @xmath33 , @xmath34 is replaced by @xmath35 @xmath36 ( notice @xmath37 ) , and @xmath38 is replaced by @xmath39 .",
    "+    the result follows from a straightforward recursion , for any @xmath40 , we have @xmath41&=&\\left(\\frac{n_1q_1^{12}}{n-1}+\\frac{(n - n_1 - 1)q_2^{22}}{n-1}\\right){\\mathbb}p[n_1(n-1)=n_1]\\\\ & + & \\left(\\frac{(n_1 - 1)q_1^{11}}{n-1}+\\frac{(n - n_1)q_2^{12}}{n-1}\\right){\\mathbb}p[n_1(n-1)=n_1 - 1]\\\\ & + & \\left(\\frac{(n - n_1 + 1)q_2^{11}}{n-1}\\right){\\mathbb}p[n_1(n-1)=n_1 - 2]\\\\ & + & \\left(\\frac{(n_1 + 1)q_1^{22}}{n-1}\\right){\\mathbb}p[n_1(n-1)=n_1 + 1].\\\\\\end{aligned}\\ ] ] this yields a recurrence relation for the generating function @xmath42x^{n_1}$ ] , which when differentiated and evaluated at @xmath43 results in the recurrence relation for @xmath44 @xmath45 and solving it we obtain the claimed result .",
    "[ rem : meansspecial ] the condition @xmath46 rules out trivial cases generating single type trees @xmath47 of only type 1 or type 2 ( depending on initial type ) . the condition @xmath48 rules out the unusual special case of completely alternating types @xmath49 . however , a number of interesting cases are covered by our results , as shown at the end of this section .",
    "[ prop : meanscherries ] under the same conditions ( @xmath50 ) as in lemma  [ lem : meanleaves ] , @xmath51 , for @xmath52,\\;\\ ; \\mu_{1}^{12}(n):={\\mathbb}{e}[c_{1}^{12}(n)],\\;\\ ; \\mu_{1}^{22}(n):={\\mathbb}{e}[c_{1}^{22}(n)]\\ ] ] we have @xmath53 where @xmath54",
    "are as in lemma  [ lem : meanleaves ] , the constants @xmath55 are @xmath56 and the initial values are @xmath57 and @xmath58 analogous formulae hold for @xmath59,\\;\\ ; \\mu_{2}^{12}(n):={\\mathbb}{e}[c_{2}^{12}(n)],\\;\\ ; \\mu_{2}^{22}(n):={\\mathbb}{e}[c_{2}^{22}(n)]\\ ] ] in which : probabilities @xmath60 are replaced by @xmath61 , @xmath38 is replaced by @xmath62 , @xmath31 and @xmath34 are replaced by @xmath63 and @xmath64 respectively ( as in lemma  [ lem : meanleaves ] ) , the constants @xmath55 remain the same if the initial type is interchanged , and @xmath65 are replaced by @xmath66 obtained by fully interchanging types in the formulae for @xmath65 .    since at each step",
    "new leaves are attached in pairs , there is no need to keep track of the number of different pendants .",
    "it suffices to keep track of the number of different types of leaves and only of the cherries of the specific type we are trying to calculate .",
    "let @xmath67\\ ] ] denote the joint probability function for @xmath68 and @xmath69x^{n_1}y^{k}\\ ] ] its generating function .",
    "using recursion arguments , for any @xmath70 , we have @xmath71 for cherries of type @xmath72 , @xmath73 for cherries of type @xmath74 , and @xmath75 for cherries of type @xmath76 .",
    "each of these equations yields a recurrence relation for the corresponding joint generating function @xmath77 by summing over @xmath78 and @xmath79 . differentiating and evaluating them at",
    "then provides recurrences for the means @xmath80 @xmath81 solving which , with the expression for @xmath44 from lemma  [ lem : meanleaves ] , gives the claimed formulae .",
    "simple algebra shows that the mean numbers of all cherries @xmath82 add up to @xmath83 , corresponding to the known mean number of cherries in a single - type erm tree .",
    "[ prop : varcherries ] assume that @xmath84 for @xmath85 as in lemma  [ lem : meanleaves ] .",
    "then , @xmath86 , for @xmath87 , \\;\\ ; \\sigma_{1}^{12}(n):={\\mathbb}{v}[c^{12}_1(n ) ] , \\;\\ ; \\sigma_{1}^{22}(n):={\\mathbb}{v}[c^{22}_1(n)]\\ ] ] we have @xmath88 the same asymptotics hold for @xmath89,\\;\\ ; \\sigma_{2}^{12}(n):={\\mathbb}{v}[c_{2}^{12}(n)],\\;\\ ; \\sigma_{2}^{22}(n):={\\mathbb}{v}[c_{2}^{22}(n)]\\ ] ] as the exponents @xmath37 are the same in these cases .    using recurrence relations for the generating functions @xmath90 from the proof of proposition  [ prop : meanscherries ] , taking second derivatives in @xmath91 and evaluating them at @xmath92 yields recurrence equations for the variances for the number of cherries for each of the types @xmath93 and @xmath94 , respectively . for @xmath95 let @xmath96 from equations for @xmath97 we obtain the recurrence relation for @xmath98 as @xmath99 the equations for @xmath100 satisfy the recurrence relations , for any @xmath101 @xmath102 where @xmath103 is the second moment for the number of leaves @xmath104 of type @xmath105 ( see lemma  [ lem : meanleaves ] ) and satisfies the recurrence , for @xmath106 @xmath107 from this we have the variances to be @xmath108 explicitly solving these equations for the variances requires much more complicated calculations than for the means . using maple yields formulae which are quite long and cluttered .",
    "however , expanding these formulae with respect to @xmath1 we obtain the asymptotic results above .      to illustrate how multi - type erm trees for different speciation models give different cherry distributions , we consider particular cases corresponding to specific values of @xmath23 : + ( a ) the _ ` single type '",
    "_ model is the trivial one in which the only type in the tree is the initial one : @xmath109 ( @xmath110 ) ; + ( b ) the  _ alternating type _ model is one in which one type can only attach to itself leaves of the other type : @xmath111 ( @xmath112 ) + ( c ) in the _ ` neutral to type ' _ model the branch - point type does not determine the probabilities of leaf types : for each @xmath9 : @xmath113 is independent of whether @xmath114 ( @xmath115 ) ; + ( d ) in the _ ` only mixed type ' _ model each type has only mixed types attached to it : @xmath116 for both @xmath114 ( @xmath117 ) ; + ( e ) the _ ` asymmetric change in type ' _ represents a model where one type can be randomly gained from the other but once gained can no longer be lost : @xmath118 or @xmath119 ( @xmath120 ) ;    [ table : mean - particular ]    [ cols=\"<,^,^ \" , ]      +      to consider the full structure ( with correlations ) of all the cherries in a multi - type erm , we also need to keep track of the number of different pendants @xmath121 of type @xmath122 in a tree with @xmath1 leaves .",
    "let @xmath123 be a single vector representing different types of cherries and pendants + @xmath124 its asymptotic behaviour as @xmath125 can be characterized in terms of a strong law .",
    "[ thm : polya - coro-1 ] assume the probabilities @xmath23 are such that to every cherry it is possible to eventually attach every other cherry . then , as @xmath126    @xmath127 .\\ ] ] where @xmath128 are as in lemma  [ lem : meanleaves ] .",
    "the condition is a form of _ irreducibility _ of the cherry state space .",
    "it can be relaxed for multi - type tree models in which certain types of cherries are not at all appearing in the tree .",
    "we get the same strong law results on a state space ( the vector @xmath129 , the matrix @xmath130 ) that is restricted to the set of cherries that can appear in the tree , on which the condition holds .",
    "the proof relies on a pya urn representation of the different types of cherries and pendants : an _ extended plya urn process _",
    "@xmath131 is a markov chain on @xmath132 where the coordinates of the random vector @xmath133 represent the number of balls of type @xmath134 in an urn at step @xmath1 .",
    "the process starts at @xmath135 and at each step balls of different types are added or removed from it .",
    "each ball type has associated to it a positive weight @xmath136 and a random vector @xmath137 taking values in @xmath132 , such that : @xmath138 as well as @xmath139 .    the weights and random vectors together characterize the distribution of the transition matrix for the markov chain : + ( i ) at each step a ball is randomly selected from the urn with the probability of selecting a ball of type @xmath7 proportional to its weight @xmath140 , that is the probability of drawing a ball of type @xmath7 at time @xmath141 is @xmath142 ; + ( ii ) if a ball of type @xmath7 was selected , then the number of balls of different types to be added to the urn is drawn according to the distribution @xmath143 .",
    "the condition @xmath144 means the selected ball that is removed from the urn may or may not be replaced on that step .",
    "it is useful to assume the urn never becomes empty , @xmath145 .",
    "let @xmath146 .",
    "the generating matrix of a plya urn is defined as @xmath147 , whose eigenvalues in decreasing order of real parts are denoted by @xmath148 ( perron - frobenius implies that @xmath149 is real valued ) .",
    "the urn is called irreducible if , for any @xmath150 , given the urn starts with a single ball of type @xmath7 it is eventually possible to add a ball of type @xmath151 to the urn .",
    "an complete treatment of extended plya urns is given in @xcite .",
    "we state here only the results stated that are key for our proof .",
    "assume the urn is such that : ( a ) it is irreducible ; ( b ) @xmath152 , ( c ) @xmath149 and @xmath153 are simple eigenvalues with left and right eigenvectors @xmath154 and @xmath155 satisfying @xmath156 and @xmath157 ; ( d ) @xmath158 .",
    "the last condition implies that the set of eigenvectors @xmath159 satisfying @xmath160 consists either only of @xmath153 or it is empty . under these assumptions",
    "theorem   3.21 of @xcite insures that , in the limit as @xmath125 , @xmath161    the process of constructing a multi - type erm tree can be viewed as a plya urn process : the balls of different types are all the different types of cherries and different types of pendants . for @xmath13",
    "we have @xmath162 , as shown in figure 1 .",
    "the ball types corresponding to any of the cherries have a weight @xmath163 , and those corresponding to pendants have a weight @xmath164 , as it is twice as likely to choose a cherry than a pendant when a leaf is picked uniformly at random .",
    "careful consideration of the multi - type erm construction rules ( a cherry being selected means that a new pair of leaves is to be added to a randomly chose one of its leaves ) shows that the generating matrix of this plya urn process is : @xmath165\\ ] ] whose eigenvalues can be shown to be : @xmath166 , @xmath167 , @xmath168 and @xmath169 .",
    "the normalized right and left eigenvectors of the largest real eigenvalue can be calculated in terms of the multi - type probabilities to be @xmath170 ,                             \\quad \\bm u_1 = \\left[\\displaystyle\\begin{array}{c } 2\\\\ 2\\\\ 2\\\\2\\\\ 2\\\\ 2\\\\ 1\\\\ 1\\\\ 1\\\\1\\\\ \\end{array}\\right]\\ ] ] if we assume that @xmath171 , this excludes the case when the generated erm tree is of a single type only , the urn process is irreducible , and also @xmath172 is a simple eigenvalue . as all the assumptions are satisfied ,",
    "applying the theorem for plya urns we obtain the claimed results .",
    "this agrees with our earlier result from proposition  [ prop : meanscherries ] as the means of the number of cherries obtained earlier in fact satisfy @xmath173/n\\to \\bm v_{1i}$ ] , for @xmath174 as @xmath125 .",
    "also , by restricting the state space to possible types of cherries the strong law result can be used on all of our special cases of multi - type erm models , and compared to the means calculated for finite @xmath1 , except for the case of ` asymmetric change ' in which type 111 is a sink for the process .",
    "a central limit law for its ( normalized ) asymptotic distribution holds as well .",
    "[ thm : polya - coro-2 ] assume @xmath23 satisfy @xmath171 , .",
    "then , + * ( i ) * if @xmath175 , as @xmath176 , @xmath177 with @xmath178\\ ] ] where the constant @xmath179is given by @xmath180 the explicit expressions for entries marked by @xmath181 are omitted as they represent the covariances between cherries and the pendants ; and expressions for the entries marked by a @xmath182 are omitted because they are follow from the symmetry of the covariance matrix . + * ( ii ) * if @xmath183 , as @xmath176 , @xmath184 where @xmath185 can be obtained explicitly only in some special cases .",
    "the proof again relies on the corresponding result for our specific plya urn described in the proof of theorem  [ thm : polya - coro-1 ] : if we assume all the conditions there plus @xmath186 , theorems  3.22 and  3.23 of @xcite insure that , as @xmath125 : + ( i ) if @xmath187 , then @xmath188 where the covariance matrix is given by @xmath189 with @xmath190 , @xmath191 , and @xmath192 ; + ( ii ) if @xmath193 , then @xmath194 where the covariance matrix is given by @xmath195 with @xmath196 as above and + the two options on the eigenvalues correspond to : , respectively . to explicitly calculate the covariance matrix @xmath197 in ( i )",
    "we need to find the normalized right and left eigenvectors corresponding to the second largest eigenvalue @xmath153 , which are given in term of the multi - type probabilities as @xmath198,\\quad \\bm u_2=\\frac{1}{c_2}\\left[\\displaystyle\\begin{array}{c}-2(2-c_1)\\\\                              c_1+c_2 - 2\\\\                             2\\\\                             2\\\\                            c_1+c_2 - 2\\\\                            -2(2-c_1)\\\\                            c_1 - 2\\\\                             1\\\\                              1\\\\                               c_1 - 2\\\\ \\end{array}\\right].\\ ] ] computing the matrix @xmath199_{1\\le i , j\\le 10}$ ] gives lengthy expression for its entries @xmath200 further lengthy and cumbersome linear algebra ( computed using maple ) provides the given entries for the variances and covariances of different types of cherries in @xmath197 as claimed .",
    "calculating the matrix @xmath185 in ( ii ) is even more involved , due to its integral expressions , and can not be made to simplify other than in some very special cases .",
    "+    the results above are consistent with our calculations of asymptotics for the variances of the number of cherries in proposition  [ prop : varcherries ] .",
    "when @xmath183 implies @xmath201 and @xmath202 , and the individual variances are @xmath203 .",
    "when @xmath175 the additional factor @xmath204 comes from covariances in numbers of different types of cherries .",
    "the asymptotic strong law allows us to approximate unknown multi - type probabilities for erm trees with a large number of leaves using counts of different types of cherries on the tree .",
    "[ cor : erminferrence ] if the proportion of different types of cherries in a multi - type erm tree is given by @xmath205 and the number of leaves @xmath1 in the tree is large , one can approximately recover the multi - type probabilities of the model to be @xmath206 @xmath207 as long as the total number of cherries with branch - point of type 1 and of type 2 are non - zero .",
    "this result is completely intuitive from a law of large numbers perspective : the multi - type probabilities for having a branch - point of type @xmath22 are given by the limiting fraction of cherries of type @xmath22 .",
    "our results on the variability of the number of cherries allows one to make a more precise statement about the error one is making using such an approximation when the number of leaves is finite .    in the standard markov propagation model on trees the probabilities for the types of two leaves attaching to the same branch - point are independent",
    "these are given by a stochastic transition matrix @xmath208_{i , j\\in\\{1,\\ldots , k\\}}$ ] where @xmath209 is the probability that a leaf of type @xmath151 will attach to a type @xmath7 . in our notation",
    "this gives probabilities @xmath210 and @xmath211 .",
    "reconstruction of types for markov propagation models has been extensively studied ( see @xcite ) .",
    "we only illustrate how the information on cherries can be used as a proxy to determine whether robust reconstruction is possible or not . without going into all the details we recall that ` reconstruction problem is solvable ' if there exist two different types which when used at the root of the tree propagate asymptotically different distributions ( measured by total variation ) on the leaves of the tree .",
    "this roughly means that the leaf types contain a non - vanishing amount of information on the type of the root of the tree as the number of leaves @xmath176 . a key result ( @xcite )",
    "then states that on a binary tree the reconstruction problem is solvable when @xmath212 , where @xmath153 is the second largest eigenvalue of the propagation matrix @xmath213 . when @xmath214 this condition becomes @xmath215 which , using corollary  [ cor : erminferrence ] , is equivalent to @xmath216",
    "consider a random tree with edge lengths , constructed from an originating node , using a pure birth process . by rescaling time",
    "one can relate any such tree to one whose birth rate is 1 , even when the rate is time varying .",
    "the distribution of this tree is called yule tree ( first considered in the biological context by @xcite ) , and has been used extensively as a null model in investigating speciation process .",
    "this is due to the fact that its distribution is precisely that of the ancestral tree reconstructed from any birth - death branching process with constant rates ( @xcite ) - an _ ancestral tree _ is obtained from a full tree of the process by pruning away all the branches without any extant species .",
    "when the branch lengths of a yule tree are ignored ( given the same length ) this produces the uniform distribution on ranked tree shapes ( a _ ranked tree _",
    "is one in which the order of branching events matters ) with labelled tips , and when the ranking is also ignored it produces the ( single - type ) erm distribution on binary trees ( @xcite ) .    we consider a multi - type version of this tree obtained as the ancestral tree reconstructed from a multi - type birth - death process .",
    "let @xmath217 denote a multi - type birth - death process on @xmath218 types , whose coordinates provide the count of different types in the population @xmath219 .",
    "let @xmath220 and let @xmath221 denote the full tree of @xmath222 .",
    "let @xmath223 denote the ancestral tree obtained by pruning away all lineages of @xmath221 which do not have any extant lineages at time @xmath224 ( the law of @xmath223 depends on @xmath224 but for simplicity we omit @xmath224 from its notation ) .",
    "an illustration of an ancestral tree associated with a multi - type birth - death process is shown in figure  [ fig : birthdeathtrees ] .",
    "let @xmath225 denote the population size process of the ancestral tree @xmath223 ( clearly we have @xmath226 , @xmath227 $ ] : @xmath228 ) .",
    "we call @xmath229 the _ reconstructed ancestral process _ of @xmath230 and derive its law , which turns out to be a multi - type pure birth process with time varying rates and an added ability to switch types along a single lineage .",
    "+    [ lem : ancestral - markovian ] the reconstructed ancestral process @xmath229 of @xmath230 is a markov process .    in the event that @xmath231 there is nothing to prove , so we consider @xmath229 on the event @xmath232 ( and @xmath233 as well ) .    for any @xmath234 let @xmath235 , we denote the joint distribution of @xmath229 at these times by @xmath236.\\ ] ] we first show , by induction , that @xmath237 @xmath238 this is evident for @xmath239 . assume the equation is true @xmath240 with @xmath241 .",
    "notice that @xmath242p_{t_1;t_1,\\ldots , t_n}(\\bm z_1;\\bm w_1,\\ldots,\\bm w_n).\\ ] ] the branching property of the birth - death process @xmath230 guarantees independence of its subtrees originating from non - overlapping subsets of individuals present at any time @xmath243 .",
    "since all individuals surviving at time @xmath224 must be descendants of the process @xmath229 , we have @xmath244\\nonumber\\\\ & = & c_{\\bm z_1,\\bm w_1}\\p\\left [ \\bm w({t_j})=\\bm w_j,\\,1\\le j\\le n\\,\\big|\\,\\bm z({t_1})=\\bm w_1\\right]p_{\\bm z_1-\\bm w_1}^{\\bm 0}(t_1,t)\\nonumber\\\\ & = & c_{\\bm z_1,\\bm w_1}p_{t_1;t_1,\\ldots , t_n}(\\bm w_1;\\bm w_1,\\ldots,\\bm w_n)p_{\\bm z_1-\\bm w_1}^{\\bm 0}(t_1,t)\\end{aligned}\\ ] ] where @xmath245 denotes the combinatorial number of distinct ways of choosing @xmath246 out of @xmath247 individuals , and @xmath248 $ ] is the extinction probability by time @xmath224 of the process @xmath230 started at time @xmath249 with @xmath250",
    ".    given @xmath251 , the process @xmath252 is the sum of birth - death processes defined by subtrees @xmath253 , originated by one of each of the @xmath254 individuals at time @xmath243 .",
    "we may assume that each @xmath255 is started by an individual of type @xmath256 , where @xmath257 is some ordering of the @xmath254 surviving originator types .",
    "probability for the surviving lineages is @xmath258\\\\ & = & \\p\\big [ \\bm w({t_j})(\\mathcal t^{(i)})\\neq 0\\ , \\forall i,\\;\\ , \\sum_{i=1}^{|\\bm w_1| } \\bm w({t_j})(\\mathcal t^{(i)})=\\bm w_j , \\,\\forall 2\\le j\\le n\\big]\\end{aligned}\\ ] ] where @xmath259 denotes the number of individuals of @xmath255 at time @xmath249 which have a surviving lineage at time @xmath224 .",
    "since the subtrees @xmath255 are independent @xmath260 where @xmath261 denotes the unit @xmath79-dimensional vector whose @xmath7-th coordinate is 1 and all other coordinates are 0 , and the summation is over all possible decompositions of @xmath262 into vectors @xmath263 with all nonzero coordinate values , for each @xmath264 . by the inductive hypothesis ( [ eq : markovian - induc ] ) for @xmath265 , the probabilities in the product on the right side are equal to @xmath266\\end{aligned}\\ ] ] where the last equality follows from ( [ eq : markovian - cond-0 ] ) and ( [ eq : markovian - cond-1 ] ) since @xmath267\\\\ \\!\\!\\!\\!\\!\\!&&=\\!\\!\\!\\!\\sum_{\\bm z_{n-1}\\ge \\bm w_{n-1 } } \\!\\!\\!\\!\\!\\!\\!\\ ! \\p[z({t_n-1})=\\bm z_{n-1}|\\bm z({t_1})=\\bm e_{\\tau^{(i)}}]c_{\\bm z_{n-1};\\bm w_{n-1}^{(i ) } } p^{\\bm 0}_{\\bm z_{n-1}-\\bm w_{n-1}}(t_{n-1},t ) \\\\ & & \\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\cdot\\p[\\bm w({t_n})=\\bm",
    "w_n^{(i)}|\\bm w({t_{n-1}})=\\bm z({t_{n-1}})=\\bm w_{n-1}^{(i)}]\\\\ \\\\",
    "\\!\\!\\!\\!&&=\\,\\p[\\bm w({t_n})=\\bm w_n^{(i)}|\\bm w({t_{n-1}})=\\bm z({t_{n-1}})=\\bm w_{n-1}^{(i)}]p_{t_1;t_{n-1}}(\\bm e_{\\tau^{(i)}};\\bm w^{(i)}_{n-1}).\\end{aligned}\\ ] ]    as the first factor on the right side above does not depend on @xmath268 the sum in ( [ eq : markovian - ind - trees ] ) may be split into outer sums , over @xmath269 , and an inner sum , over @xmath270 that is equal to @xmath271.\\ ] ] by the same argument using splitting over independent subtrees , but this time splitting the individuals at time @xmath272 into subsets of sizes @xmath273 , we can show that this sum contributes to the outer sums a factor of @xmath274= \\frac { p_{t_0;t_{n-1},t_n}(\\bm z_0;\\bm w_{n-1},\\bm w_n ) } { p_{t_0;t_{n-1}}(\\bm z_0;\\bm w_{n-1 } ) } , \\ ] ] where the last equality follows again from equations ( [ eq : markovian - cond-0 ] ) and ( [ eq : markovian - cond-1 ] ) , and combining with the outer sums in ( [ eq : markovian - ind - trees ] ) implies @xmath275 as wanted . by using once again equations ( [ eq : markovian - cond-0 ] ) and ( [ eq : markovian - cond-1 ] ) ,",
    "this becomes equation ( [ eq : markovian - induc ] ) for step @xmath1 .",
    "equation ( [ eq : markovian - induc ] ) may be written in terms of conditional probabilities as @xmath276\\\\ = \\p\\left[\\bm w({t_n})=\\bm w_n\\,\\big|\\,\\bm w({t_{n-1}})=\\bm w_{n-1},\\,\\bm z({t_0})=\\bm z_0\\right]\\end{aligned}\\ ] ] which implies the markov property for @xmath277 .",
    "[ prop : ancestral ] assume the multi - type birth - death process @xmath230 has birth rates @xmath278 ( @xmath279= rate at which any type @xmath7 gives birth to a type @xmath151 ) and death rates @xmath280 ( @xmath281= rate at which any type @xmath7 dies ) .",
    "then , for any @xmath220 , the reconstructed ancestral process @xmath229 is a pure birth process with birth rates @xmath282 ( @xmath283= rate at which type @xmath7 gives birth to type @xmath151 ) and mutation rates @xmath284 ( @xmath285= rate at which type @xmath7 changes into type @xmath151 ) at time @xmath286 , given by @xmath287 where @xmath288 $ ] are the extinction probabilities for @xmath230 .",
    "when there is only one type , for example @xmath7 , this reduces to a pure birth process with time varying birth rate @xmath289 as previously established ( @xcite ) .",
    "the extinction probabilities @xmath290 can be shown to satisfy a system of differential equations ( @xcite , @xcite ) @xmath291    by lemma  [ lem : ancestral - markovian ] , the reconstructed ancestral process @xmath277 is markov , so it suffices to show that its only transitions are changes of the form @xmath292 and @xmath293 and calculate their rates .",
    "the set of possible transition changes for @xmath230 , and the fact that @xmath294 is non - decreasing , imply the form of changes for @xmath229 : an addition of @xmath261 occurs iff there is a birth event and both the new lineage and the parent lineage survive to @xmath224 , an addition of @xmath295 occurs iff there is a birth event and only the new lineage survives to @xmath224 ( see figure  [ fig : birthdeathtrees ] for an example ) .    considering the possible values of the underlying birth - death process @xmath230 for a transition in @xmath296 $ ] , using ( [ eq : markovian - cond-1 ] ) , we get @xmath297\\nonumber\\\\   & & = \\displaystyle\\frac{\\displaystyle\\sum_{\\bm z\\ge \\bm w}\\p[\\bm w(t+\\delta t)=\\bm w+\\bm e_j,\\bm w(t)=\\bm w,\\bm z(t)=\\bm z]}{\\displaystyle\\sum_{\\bm z\\ge w}\\p[\\bm w(t)=\\bm w,\\bm z(t)=\\bm z]}\\nonumber\\\\ & & = \\displaystyle\\frac{\\displaystyle\\sum_{\\bm z\\ge \\bm w}\\p[\\bm z(t)=\\bm z]c_{\\bm z,\\bm w}\\sum_{i=1}^k \\bm w_i{b}_i^{ij}\\delta t\\big(\\bm 1-\\bm p^{\\bm 0}(t+\\delta t , t)\\big)^{\\bm w+\\bm e_i}\\bm p^{\\bm 0}(t+\\delta t , t)^{\\bm z-\\bm w}+o(\\delta t)}{\\displaystyle\\sum_{\\bm z}\\p[\\bm z(t)=\\bm z]c_{\\bm z,\\bm w}(\\bm 1-\\bm p^{\\bm 0}(t , t))^{\\bm w}\\bm p^{\\bm 0}(t , t)^{\\bm z-\\bm w}}\\nonumber\\\\   & & = \\sum_{i=1}^k\\bm w_i { b}_i^{ij}(1-p_{\\bm e_j}^{\\bm 0}(t , t))\\delta t+o(\\delta t).\\end{aligned}\\ ] ] where we used notation @xmath298 , @xmath299 + similarly for @xmath300 @xmath301 \\nonumber\\\\ & & = \\displaystyle\\frac{\\displaystyle\\sum_{\\bm z}\\p[\\bm z(t)=\\bm z]c_{\\bm z,\\bm w}\\ , \\bm w_i{b}_i^{ij}\\delta t\\big(\\bm 1-\\bm p^{\\bm 0}(t+\\delta t , t)\\big)^{\\bm w+\\bm e_j-\\bm e_i}\\bm p^{\\bm 0}(t+\\delta t , t)^{\\bm z-\\bm w+\\bm e_i}+o(\\delta t)}{\\displaystyle\\sum_{\\bm z}\\p(\\bm z(t)=\\bm z)c_{\\bm z,\\bm w}(\\bm 1-\\bm p^{\\bm 0}(t , t))^{\\bm w}\\bm p^{\\bm 0}(t , t)^{\\bm z-\\bm w}}\\nonumber\\\\   & & = \\displaystyle\\frac{\\bm w_j { b}_i^{ij}(1-p_{\\bm e_j}^{\\bm 0}(t , t))p_{\\bm e_i}^{\\bm 0}(t , t)}{1-p_{\\bm e_i}^{\\bm 0}(t ,",
    "t)}\\delta t+o(\\delta t).\\end{aligned}\\ ] ]    transition rates ( [ eq : ancestral - transition - birth ] ) and ( [ eq : ancestral - transition - mutation ] ) correspond to those of a pure birth process allowing for mutations along the lineages as claimed in ( [ eq : ancestral - rates ] ) .    in continuous time @xmath302 nodes of different types",
    "have different time varying _ weights _ , such that at any time the probability of a node of certain type is chosen to be the next node with a branch - point ( binary or unary ) is proportional to this weight .",
    "the weight of a node of type @xmath7 is @xmath303 where @xmath304 is the overall rate of events for type @xmath7 .",
    "the probabilities of a node of type @xmath7 having a binary branch - point ( of type @xmath7 and @xmath151 ) versus a unary branch - point ( of type @xmath305 ) are @xmath306    contrary to the single type case , it is not possible to rescale time and relate this to a yule process with constant rates of birth and mutations , because the rate at which the time needs to be rescaled depends on the type of the node that was involved in the last branching event .",
    "this information is dependent on the randomness of the tree and is not simply a deterministic function of time as it is in the single type case .",
    "consequently , ignoring the edge lengths and possibly the ranking of branching events in these trees does not produce any logical model on multi - type discrete trees .",
    "topologically it results in multi - type discrete trees which are no longer regular binary ones , as in addition to binary branch - points they also have unary branch - points ( with the type attached being necessarily different ) .",
    "figure  [ fig : yuletrees ] illustrates obtaining such a discrete tree .     +    however , as in the single - type case , near the present ( @xmath307 ) probabilities of extinction @xmath308 are approximately zero , and birth and mutation rates in the ancestral tree are approximately constant @xmath309 , and @xmath310",
    "this allows one to infer birth rates of the process using results on constant rate multi - type yule trees described in the next section ( see corollary  [ cor : contsinferrence ] ) . knowing the values of lineage through time plots for different types ( @xmath311 )",
    "will then allow one to also infer death rates of the process .",
    "[ rem : fromyuletoerm ] if we consider multi - type yule trees with mutations whose birth rates @xmath312 and mutation rates @xmath313 are constant , ignoring edge lengths results in a useful model on multi - type discrete trees : each node of type @xmath7 is chosen to be the next branch - point with probability proportional to its weight @xmath314 once chosen the branch - point is binary with attached leaves of types @xmath150 , or unary with attached leaf of type @xmath305 , respectively , with probabilities @xmath315 the distribution of different types of cherries and pendants in the tree should provide information about its birth and mutation rates .",
    "however , the approaches for obtaining their distribution using generating functions and recursive relations ( when the number of leaves is finite ) , as well as the polya urn approach for their asymptotic distribution ( as the number of leaves grows ) , are completely unwieldly .",
    "the more appropriate approach is to analyze distributions of different types of cherries and pendants in the original continuous time trees as shown in the next section .",
    "we consider a multi - type birth process with mutations constructed using time - dependent birth rates @xmath316 and mutation rates @xmath317 , and call its associated tree a _ multi - type yule tree with mutations_. for generality , we allow for the birth events to result in an instantaneous change of type for the parent node as well , so that birth rates for a parent node of type @xmath7 are indexed in the superscript by any @xmath318 giving a birth event of type @xmath22 ( rather than only having birth events of types @xmath319 as in ancestral trees of the previous section ) . consequently , each birth event is a branch - point ( with no special designation in the continuing lineages ) and in order not to distinguish between different planar embeddings we will w.l.o.g .",
    "assume that @xmath9 ( as in the multi - type erm case ) .",
    "for @xmath79 types this model has @xmath320 parameters .    due to mutations in the model ( producing unary branch - points ) we need to precise a definition of multi - type cherries and pendants in such a tree .",
    "since the sequence of mutation events along a lineage is typically not available in data , we will focus on the types at the topological end - points of the structure .",
    "we first let the topology of the tree be defined only by binary branch - points , while unary branch - points are ignored .",
    "the cherries and pendants are then defined in this topology as they would be in a regular binary tree .",
    "this means that the type of each cherry and each pendant is defined by the type values at the end nodes of the cherry or pendant . respectively .",
    "figure  [ fig : yuletrees ] illustrates a two - type yule tree with mutations which has only one cherry of type 222 and only one pendant of type 22 .",
    "in general there are @xmath321 different types of cherries ( we do nt differentiate between different planar embeddings of a cherry type ) , @xmath322 different types of pendants ( sequence of mutations along a lineage can revert to the original type ) , and @xmath79 different types of leaves .      for a multi - type yule tree with mutations ,",
    "we let @xmath323 denote the number of leaves of types @xmath324 , respectively , at time @xmath249 .",
    "let @xmath325 denote the number of cherries of type @xmath22 , and @xmath326 the number of pendants of type @xmath122 at time @xmath249 .",
    "we next consider their means , which are relatively straightforward , although quite complicated , to calculate .",
    "[ lem : meannudependant - eq ] let @xmath327 be the vector of leaf means , @xmath328 , \\forall i$ ] . then",
    ", @xmath329 @xmath330 where @xmath331 is the @xmath332 matrix with entries @xmath333_{\\ell_1,\\ell_2}=\\left\\{\\begin{array}{lc } \\displaystyle q_{\\ell_1}^{\\ell_1\\ell_1}(t)-\\sum_{\\substack{i\\leq j \\\\",
    "i , j\\neq\\ell_1 } } q_{\\ell_1}^{ij}(t)-\\sum_{i\\neq\\ell_1 } q_{\\ell_1}^{i}(t ) & \\mbox { when } \\ell_1=\\ell_2\\\\ \\\\ \\displaystyle 2 q_{\\ell_2}^{\\ell_1\\ell_1}(t)+ q_{\\ell_2}^{\\ell_1}(t)+\\sum_{j < \\ell_1 } q_{\\ell_2}^{j\\ell_1}(t)+\\sum_{j > \\ell_1 }",
    "q_{\\ell_2}^{\\ell_1 j}(t ) & \\mbox { when } \\ell_1\\neq \\ell_2.\\end{array}\\right.\\ ] ]    the matrix formulation is equivalent to the claim that each @xmath334 for @xmath335 satisfies @xmath336 to see why this is true , observe that in the time interval @xmath337 the number of leaves of type @xmath338 increases by 2 iff we have a birth event of type @xmath339 for some @xmath340 .",
    "it increases by 1 iff we have a birth event of type @xmath341 for some @xmath342 or for @xmath343 , or if we apply a change of type @xmath344 for some @xmath340 . the number of leaves of type @xmath338 decreases by 1 only by having birth events of types @xmath345 or by having type changes @xmath346 for @xmath342 .",
    "[ rem : meannudependant ] if @xmath331 in lemma  [ lem : meannudependant - eq ] is such that it commutes with @xmath347 @xmath348 , then the vector of leaf means can be given explicitly as @xmath349 if @xmath331 is a constant ( time - independent ) matrix @xmath196 .",
    "+          [ prop : meanmudependant ] let @xmath353 be the vector of cherry means of types @xmath345 , for @xmath354 . then , @xmath329 @xmath355 where @xmath356^\\mathsf{t}\\ ] ] and @xmath357 is a @xmath358 matrix with entries @xmath359_{\\ell ij,\\ell m n}=\\left\\{\\begin{array}{ll } -(q_{i}(t)+q_{j}(t ) ) , & \\mbox { when } ( m , n)=(i , j)\\\\ \\delta_{m , i } q_{n}^i(t)+ \\delta_{n , i}q_{m}^i(t ) , & \\mbox { when } ( m , n)\\neq ( i , j),\\ , i= j\\\\    \\delta_{m , i}q_{n}^j(t)+ \\delta_{m , j}q_{n}^i(t)+ \\delta_{n , i}q_{m}^j(t)+ \\delta_{n , j}q_{m}^i(t ) , & \\mbox { when } ( m , n)\\neq ( i , j),\\ , i\\neq j.\\end{array}\\right.\\ ] ] where , for @xmath360 , @xmath361 is the overall rate of events occurring to a lineage of type @xmath7 @xmath362 and where entries in the matrix @xmath357 are ordered in a consistent way with that of types in the vectors @xmath363 , @xmath364 .    we show that each @xmath365 satisfies the following differential equation when @xmath366 @xmath367 and when @xmath300 it satisfies @xmath368 this can be seen from the fact that the number of cherries of type @xmath345 will increase by 1 iff a cherry of type @xmath345 is added by a birth event to a lineage of type @xmath338 , or there is a mutation along a lineage of a cherry which from a cherry of some different type produces a cherry of type @xmath345 .",
    "the number of cherries of type @xmath345 will decrease by 1 iff there is a mutation along a lineage of a type @xmath345 cherry , or there is a birth event along one of its lineages producing a cherry of some different type .",
    "[ rem : adiagdominant ] the matrix @xmath357 is diagonally dominant by columns , as : in a column @xmath369 every rate of the form @xmath370 and every rate of the form @xmath371 appears exactly once ( when @xmath372 each one appears twice ) and the sum of these rates is less than or equal to @xmath373 .",
    "we will use this fact in upcoming proofs .",
    "[ prop : meangamma ] let @xmath374 be the vector of pendant means . then , @xmath329 @xmath375 where @xmath376 is a @xmath377 matrix with entries @xmath378_{\\ell m , ij}=\\left\\{\\begin{array}{rl } -q_{m}(t ) & \\mbox { when } ( \\ell , m)=(i , j)\\\\    q_{j}^m(t ) & \\mbox { when } \\ell = i,\\ , m\\neq j\\\\ 0 & \\mbox { otherwise . } \\end{array}\\right.\\ ] ] and @xmath379 is a @xmath380 matrix with entries @xmath381_{\\ell m,\\ell ' i j}=\\left\\{\\begin{array}{rl}\\displaystyle 2\\sum_{j_1\\leq j_2}q_{m}^{j_1j_2}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = i = j\\\\    \\displaystyle \\sum_{j_1\\leq j_2}\\ q_{i}^{j_1j_2}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = j >",
    "i\\\\    \\displaystyle \\sum_{j_1\\leq j_2}\\   q_{j}^{j_1j_2}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = i < j\\\\   0 & \\mbox { otherwise}.\\end{array}\\right.\\ ] ]    we show that each @xmath382 satisfies @xmath383 to see this , observe that the number of pendant edges of type @xmath384 will increase by 1 if a mutation of type @xmath385 occurs on a pendant edge of type @xmath386 .",
    "also , it will increase by 1 if a birth event happens adding any cherry of type @xmath22 to any cherry of type @xmath387 @xmath388 , or if a cherry of type @xmath389 is added to a cherry of type @xmath390 .",
    "the number of pendant edges of type @xmath384 will decrease by 1 iff any birth event adding a cherry or mutation occurs on a pendant edge of type @xmath384 .",
    "we next consider what happens to the tree structure of the multi - type yule process with mutations as @xmath391 .",
    "the random total number of leaves @xmath392 grows as well , so we need to consider the fraction of different types of cherries and pendants .",
    "we start with results in case the birth @xmath393 and mutation @xmath313 rates in the process are constant ( time independent ) and then generalize to the time varying case .",
    "the matrix @xmath331 from lemma  [ lem : meannudependant - eq ] has nonnegative entries , except possibly for those on the diagonal . by the perron - frobenius theorem ,",
    "if it is irreducible , there exists a largest simple eigenvalue @xmath394 of @xmath331 with right and left eigenvectors @xmath395 , respectively .",
    "we can assume that @xmath396 .",
    "in case that @xmath397 is time independent , we have the following result .",
    "recall @xmath398 is the mean total number of leaves in the tree .",
    "[ lem : limit - eta - tind ] if @xmath397 and is irreducible , then @xmath399 , if it converges , satisfies @xmath400 where @xmath159 is the largest real eigenvalue of @xmath196 with coresponding right eigenvector @xmath401 .",
    "furthermore , if @xmath402 , then @xmath403 , if it converges , satisfies @xmath404    using @xmath405 in the differential equation for @xmath406 from proposition  [ prop : meanmudependant ] we get @xmath407 assuming that @xmath408 exists , taking limit as @xmath409 on both sides and using the fact that @xmath410 is continuous , we get @xmath411    let @xmath412 denote the jordan representation form of the matrix @xmath196 , so that @xmath413 and @xmath414 .",
    "by corollary [ cor : meanrho ] , @xmath415 similarly , using lemma  [ lem : meannudependant - eq ] , @xmath416 we claim that @xmath417 is invertible .",
    "this is true because @xmath418 is diagonally dominant by columns ( see remark [ rem : adiagdominant ] ) , and @xmath419 ( @xmath398 is positive and increasing ) , which means that @xmath417 is diagonally dominant by columns as well .",
    "hence , from ( [ eq : differentialeta ] ) we get @xmath420 the proof for @xmath421 follows in the analogous steps , using @xmath422 , the differential equation for @xmath423 from proposition  [ prop : meangamma ] and the fact that @xmath424 is also diagonally dominant .",
    "[ thm : limit - eta - tdepnotcomm ] if all the birth rates and mutation rates in the long term converge to limits @xmath425 and @xmath426 such that the matrix @xmath427 is irreducible with maximum eigenvalue @xmath159 and corresponding right and left eigenvectors @xmath428 and @xmath429 respectively ; then , assuming the limits below exist , @xmath430 and @xmath431    the proof is similar to that in the constant rate case .",
    "replacing @xmath405 in the differential equation for @xmath406 from proposition  [ prop : meanmudependant ] , we get @xmath432 since @xmath408 exists , taking @xmath409 on both sides , we get @xmath433 from lemma  [ lem : meannudependant - eq ] we have @xmath434 , and defining @xmath435 , we have @xmath436 which taking @xmath437 on both sides gives @xmath438 by assumption the matrix @xmath427 has all finite entries and is irreducible , hence the vector @xmath439 only has positive entries and the perron - frobenious theorem implies that this vector is the eigenvector @xmath428 and that @xmath440 .",
    "we now claim that @xmath441 is invertible .",
    "this is true because @xmath357 is diagonally dominant by columns ( again see remark [ rem : adiagdominant ] ) , and @xmath442 ( since @xmath398 is positive and increasing ) , which means that @xmath441 is diagonally dominant by columns as well .",
    "hence , ( [ eq : differentialetadependant ] ) implies @xmath443 as claimed .",
    "the proof for @xmath421 follows in the analogous steps , replacing @xmath422 in the differential equation for @xmath423 from proposition  [ prop : meangamma ] and using the fact that @xmath424 is also diagonally dominant .    in the special case that @xmath329 the matrices @xmath331",
    "are irreducible , mutually diagonalizable , to matrices @xmath444 , and have the same right and left eigenvectors @xmath445 for their corresponding maximum eigenvalues @xmath394 , we can give a shorter proof : from corollary  [ cor : meanrho ] ; @xmath446 since the dominating terms are only those involving @xmath447 with @xmath448 as right and left eigenvectors of @xmath331 respectively ; also , @xmath449 and substituting these in ( [ eq : differentialetadependant ] ) gives the desired result .",
    "the asymptotic results allow one to infer the birth and mutation rate parameters of the models based on the number of cherries and pendants .",
    "note that in the constant rate case , we have @xmath450 parameters , and we have @xmath451 statistics which satisfy the relation : @xmath452 .",
    "one nonetheless needs some form of additional information in order to infer the model parameters , as in the following result .",
    "let @xmath453 denote the overall birth rates for each type .",
    "[ cor : contsinferrence ] if the long term birth rates @xmath454 and the maximum real eigenvalue @xmath159 of @xmath455 are known , then the limits of the birth and mutation rates can be expressed in terms of the limiting fractions of cherries and pendants @xmath456 and @xmath457 , where @xmath458^{\\rm t}$ ] , @xmath459 and @xmath460 $ ] .",
    "observe that we can express @xmath461 and @xmath462 in terms of @xmath463 as @xmath378_{\\ell m , ij}=\\left\\{\\begin{array}{cl } -r_{m}(t)-\\displaystyle\\sum_{i\\neq m}q_{m}^i(t ) & \\mbox { when } ( \\ell , m)=(i , j).\\\\     q_{j}^m(t ) & \\mbox { when } \\ell = i,\\ , m\\neq j.\\\\ \\\\0 & \\mbox { otherwise . }",
    "\\end{array}\\right.\\ ] ] and , @xmath381_{\\ell m,\\ell ' i j}=\\left\\{\\begin{array}{cl}\\displaystyle 2r_{m}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = i = j.\\\\   \\\\",
    "r_{i}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = j > i.\\\\   \\\\",
    "r_{j}(t ) & \\mbox { when } \\ell=\\ell',\\ , m = i < j.\\\\ \\\\ 0 & \\mbox { otherwise}.\\end{array}\\right.\\ ] ]    since @xmath159 is known , theorem  [ thm : limit - eta - tdepnotcomm ] implies we have @xmath464 a linear system which , knowing the values of @xmath454 and @xmath159 , and given the values of @xmath465 and @xmath466 from statistics of cherries and pendants , depends only on the limits of the mutation rates @xmath467 , @xmath468 .    for each solution of this system in terms of the limiting mutation rates",
    ", we will have the values of @xmath469 for @xmath470 which can subsequently be used in each of the systems @xmath471 which is in fact a linear system in the branching rates because @xmath472 it is therefore possible to get solutions of this system in terms of the limiting birth rates by expressing in terms of vectors @xmath473 as claimed .",
    "[ rem : reversibility - type - independent ] in the special case that the overall birth rates @xmath474 are constants and @xmath475 are independent of type , the maximum eigenvalue of @xmath196 is simply @xmath476 , so in order to infer the birth and mutation rates we only need to know the overall growth rate @xmath477 and the statistics on the fractions of cherries and pendants .      to illustrate how",
    "the asymptotic fractions of cherries and pendants can be used to infer the birth @xmath393 and mutation @xmath478 rates in the model we consider two particular cases of the _ ` symmetric change of type ' _ models with @xmath214 .",
    "we will assume that the two overall birth rates @xmath479 are independent of the type @xmath480 , that birth rates are symmetric in parent type @xmath481 , and that the same holds for mutation rates @xmath482 .",
    "we consider the following two such models :    \\(a ) ` cladogenetic change ' model in which change in type can only occur at birth events and occurs independently for the offspring and parent : @xmath483 where @xmath484 is the probability of type change at a birth event ;    \\(b ) ` anagenetic change ' model in which change in type can only occur along the lineage : @xmath485 where @xmath486 is the relative rate of mutation along a lineage .",
    "+ ( a ) since in the cladogenetic case all mutation rates are zero , by corollary  [ cor : contsinferrence ] we only need to solve the system of equations @xmath487 for the rates @xmath488 .",
    "we have that the matrix @xmath196 is @xmath489=r\\left[\\begin{array}{cc } 1 - 2p & 2p\\\\ 2p & 1 - 2p\\end{array}\\right],\\ ] ] with eigenvalue @xmath476 and corresponding right eigenvector @xmath490^{\\rm t}$ ] .",
    "we have @xmath491 and the matrices @xmath492 are @xmath493=\\left[\\begin{array}{ccc}-2r&0&0\\\\0&-2r&0\\\\0&0&-2r\\end{array}\\right].\\ ] ] solving the above system of equations for @xmath494 in terms of the asymptotic fractions of cherries and pendants @xmath495 $ ] for @xmath496 and @xmath497 $ ] gives @xmath498^{\\rm t}$ ] , for @xmath499 .",
    "birth rates then are @xmath500 this implies that the asymptotic fractions of cherries together with @xmath486 satisfy @xmath501 note that if we ignore edge lengths in this tree , we essentially get the random discrete tree arising from the symmetric markov propagation model , briefly discussed at the end of subsection  [ subsec : ermlimits ] , in which the propagation matrix @xmath213 is symmetric with @xmath502 .",
    "+ ( b ) in the anagenetic case , by corollary  [ cor : contsinferrence ] we need to solve the system of equations @xmath503 for the mutation rates @xmath504 .",
    "the matrix @xmath196 is @xmath489=r\\left[\\begin{array}{cc } 1-p&p   \\\\ p & 1-p\\end{array}\\right],\\ ] ] with eigenvalue @xmath476 and corresponding right eigenvector @xmath490^{\\rm t}$ ] .",
    "also @xmath505 , the matrix @xmath506 is @xmath507=r\\left[\\begin{array}{cccc}-(2+p)&p&0&0\\\\p&-(2+p)&0&0\\\\0&0&-(2+p)&p\\\\0&0&p&-(2+p ) \\end{array}\\right]\\ ] ] and the matrix @xmath462 is @xmath508 = \\left[\\begin{array}{cccccc}2r&r&0&0&0&0\\\\0&r&2r&0&0&0\\\\0&0&0&2r&r&0\\\\0&0&0&0&r&2r \\end{array}\\right]\\ ] ] solving the above system for @xmath504 in terms of the asymptotic fractions of cherries and pendants @xmath495 $ ] for @xmath496 and @xmath497 $ ] implies that the asymptotic fractions of cherries and pendants as well as @xmath486 satisfy @xmath509 the matrices @xmath492 are @xmath493=r\\left[\\begin{array}{ccc}-2(1+p)&0&0\\\\0&-2(1+p)&0\\\\0&0&-2(1+p)\\end{array}\\right]\\ ] ] and the value of @xmath486 should make the system of equations @xmath510 with @xmath511^{\\rm t } , \\bm q_{(2)}=[0,0,r]^{\\rm t}$ ] a consistent one . with @xmath486 as above , birth and mutation rates then are @xmath512    our results can be used together with what is previously known about predictive accuracy of a reconstruction method , such as maximum parsimony , majority rule and maximum likelihood , for the ancestral states .",
    "predictive accuracy is measured in terms of the expected value ( over all sample trees in the random model ) of the probability that the predicted type of the root is correct .",
    "there are a number of known results ( @xcite , @xcite ) on when a reconstruction method for the type of the root in the tree is more accurate than a uniform guess on its value . for the above models of symmetric change of type ( with @xmath214 ) the results of @xcite state that the predictive accuracy of the maximum parsimony method is asymptotically 1/2 iff @xmath513 ; and",
    "the predictive accuracy of any method is asymptotically 1/2 if @xmath514 ; where @xmath515 denotes the substitution rate in this symmetric propagation model .",
    "results of @xcite state that majority rule is more accurate than a uniformly random guess iff @xmath516 .",
    "our expressions for @xmath517 allow one to approximately determine whether in a given tree the type of the root can be accurately predicted by one of these methods or not .",
    "+ unfortunately , inference of birth and mutation rates can not be used in the _ ` asymmetric change of type ' _ models , such as :          consider a general multi - type yule tree on @xmath214 types but without mutations .",
    "its overall birth rates @xmath522 and @xmath523 are generally not the same , which implies that the probabilities at which lineages of each type are chosen to be the next one to give birth are not the same ( there is ` non - neutrality ' in types ) .",
    "let @xmath524 and @xmath525 denote the weights proportional which lineages of types 1 and 2 , respectively , get chosen to give birth ( see remark  [ rem : fromyuletoerm ] .",
    "for any two such models @xmath526 and @xmath527 we can compare the weights @xmath528 and @xmath529 of choosing type @xmath105 lineages .",
    "we provide a comparison between the asymptotic fraction of different types of cherries @xmath530^{\\rm t}$ ] and @xmath531^{\\rm t}$ ] in the two models based on the comparison of their weights @xmath532 and @xmath533 of choosing a lineage of different types to give birth .",
    "[ prop : comparison ] assume that the birth rates @xmath526 and @xmath527 in the two models are such that , their limits @xmath534 satisfy @xmath535 then , the asymptotic proportions of cherries of type 1 and type 2 in the two models satisfy monotonicity in terms of weights @xmath528 and @xmath529 given by @xmath536 where @xmath537 denote the limiting weights of type 1 lineages .",
    "theorem  [ thm : limit - eta - tdepnotcomm ] implies that the vectors @xmath495 $ ] for @xmath496 satisfy @xmath538 since we are considering multi - type yule models with mutation rates @xmath539 , the matrix @xmath540 from proposition  [ prop : meanmudependant ] depends only on @xmath541 and @xmath542 .",
    "let @xmath543 denote the probabilities that a birth event at a lineage of type @xmath338 results in types @xmath544 ( see remark  [ rem : fromyuletoerm ] ) in the limit as @xmath409",
    ". then @xmath545 and the assumption on the limiting birth rates becomes @xmath546 substituting all this into the equations for @xmath547 above , and using @xmath548 , we obtain expressions for @xmath549 that are written entirely in terms of probabilities @xmath550 and weight @xmath528 : @xmath551 @xmath552 @xmath553 @xmath554 @xmath555 @xmath556 in order to prove the monotonicity of @xmath557 as a function of @xmath528 for @xmath558 , it suffices to check their first derivate with respect to @xmath528 : @xmath559 @xmath560 @xmath561 @xmath562 @xmath563 @xmath564 and the result follows .",
    "the assumption for the limiting birth rates can be satisfied in relevant models .",
    "for example , in a process where at a birth event types of the two continuing lineages are assigned according to a markov process with transition probabilities @xmath565 , the probabilities @xmath550 are @xmath566 @xmath567 and the assumption ( [ condition - splitting - prob ] ) is equivalent to @xmath568 .    in the special case when the overall birth rates are equal @xmath569 ( ` neutral ' underlying tree shape )",
    ", if edge lengths in the multi - type yule tree without mutations are ignored the resulting distribution on the tree is that of a corresponding multi - type erm model .",
    "accordingly , the asymptotic fractions of cherries we obtained in the proof of proposition  [ prop : comparison ] are in fact the same as asymptotic fractions obtained in theorem  [ thm : polya - coro-1 ] for the multi - type erm trees with probabilities @xmath570 .",
    "99 aldous , d.j .",
    "( 1996 ) + probability distributions on cladograms . _ random discrete structures _ , ( i m a volumes math.appl .",
    "76 ) , 1 - 18 .",
    "aldous , d.j .",
    "( 2001 ) + stochastic models and descriptive statistics for phylogenetic trees , from yule to today .",
    "_ stat.sci .",
    "_ 16(1 ) : 2334 .",
    "aldous , d. , popovic , l. ( 2005 ) + a critical branching process model for biodiversity .",
    "probab . _ * 37 * 10941115 . doi : 10.1239/aap/1134587755 fitzjohn , r.g .",
    "( 2010 ) + quantitative traits and diversification .",
    "_ 59:619 - 633 fitzjohn , r.g .",
    "( 2012 ) + what drives biological diversification ? detecting traits under species selection .",
    "university of british columbia , phd thesis .",
    "gascuel , o. , steel , m. ( 2014 ) + predicting the ancestral character changes in a tree is typically easier than predicting the root state .",
    "_ 63 ( 3 ) , 421 - 435 .",
    "goldberg , e. e. , igic , b. ( 2012 ) + tempo and mode in plant breeding system evolution .",
    "_ evolution _ 66:3701 - 3709 .",
    "goldberg , e. e. , lancaster , l.t . ,",
    "ree , r.h .",
    "( 2011 ) + phylogenetic inference of reciprocal effects between geographic range evolution and diversification .",
    "_ 60:451 - 465 harding , e.f .",
    "( 1971 ) + the probabilities of rooted tree - shapes generated by random bifurcation . _",
    "_ 3:4477 .",
    "janson , s. ( 2004 ) + functional limit theorems for multitype branching processes and generalized plya urns .",
    "_ stochastic processes and their applications _ ,",
    "jones , g. ( 2011 ) + calculations for multi - type age - dependent binary branching processes . _ j. of math .",
    "_ , 63(1):3356 .",
    "lambert , a. , popovic , l. ( 2013 ) + the coalescent point - process of branching trees .",
    "prob . _ 23(1):99144 .",
    "doi : 10.1214/11-aap820 maddison , w.p .",
    ", midford , p.e . , otto , s.p .",
    "( 2007 ) + estimating a binary character s effect on speciation and extinction .",
    "_ 56.5 : 701 - 710 .",
    "mckenzie , a. , steel , m. ( 2000 ) + distributions of cherries for two models of trees .",
    "_ mathematical biosciences _ 164(1):8192 .",
    "mode , c.j .",
    "( 1962 ) + some multi - dimensional birth and death processes and their applications in population genetics . _ international biometric society _ , 18(4):543567 .",
    "mooers , a.o . , heard , s.b .",
    "( 1997 ) + inferring evolutionary process from phylogenetic tree shape .",
    "_ quarterly review of biology_:3154 .",
    "mossel , e. ( 2004 ) phase transitions in phylogeny . _",
    "_ 356(6):2379 - 2404 mossel , e. ( 2004 ) survey - information flow on trees .",
    "_ dimacs series in discrete mathematics and theoretical computer science . _ 63:155 - 170 .",
    "mossel , e. , steel , m. ( 2005 ) + how much can evolved characters tell us about the tree that generated them ? _ mathematics of evolution and phylogeny _ , 384 - 412 .",
    "mossel , e. , steel , m. ( 2014 ) + majority rule has transition ration 4 on yule trees under a 2-state symmetric model _",
    "j. of theor .",
    "biol._. nee , s. , may , r.h . , harvey , p.h .",
    "( 1994 ) + the reconstructed evolutionary process . _",
    "b _ , 344(1309):305 - 311 . ng , j , smith , s.d .",
    "( 2014 ) + how traits shape trees : new approaches for detecting character state - dependent lineage diversification . _ j. evol .",
    "( published online 25 jul ) .",
    "doi : 10.1111/jeb.12460 popovic , l. , rivas , m. ( 2014 ) + the coalescent point - process of multi - type branching trees .",
    "_ 124(12):41204148 .",
    "smythe , r.t .",
    "( 1996 ) + central limit theorems for urn models , _ stochastic processes and their applications _ , 65(1):115137 .",
    "yule , g.u . a mathematical theory of evolution , based on the conclusions of dr .",
    "j. c. willis ( 1924 ) + _ philos .",
    "london ser .",
    "b _ , 213:2187 ."
  ],
  "abstract_text": [
    "<S> we introduce two models for multi - type random trees motivated by studies of trait dependence in the evolution of species . our discrete time model , the _ multi - type erm tree _ , </S>",
    "<S> is a generalization of markov propagation models on a random tree generated by a binary search or ` equal rates markov ' mechanism . </S>",
    "<S> our continuous time model , the _ multi - type yule tree with mutations _ , is a multi - type generalization of the tree generated by a pure birth or yule process . </S>",
    "<S> we study type dependent topological properties of these two random tree models . </S>",
    "<S> we derive asymptotic results that allow one to infer model parameters from data on types at the leaves and at branch - points that are one step away from the leaves .    _ running head . _ the multi - type yule process . </S>",
    "<S> + _ msc subject classification ( 2000 ) . </S>",
    "<S> _ + _ key words and phrases . _ ancestral tree  </S>",
    "<S> multi - type branching process </S>",
    "<S>  yule tree  </S>",
    "<S> binary search tree  </S>",
    "<S> tree topology  parameter reconstruction . </S>"
  ]
}