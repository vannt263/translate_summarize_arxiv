{
  "article_text": [
    "at low temperatures a three - dimensional ( 3d ) bose gas can undergo a phase transition to a bose - einstein condensate .",
    "in contrast , thermal fluctuations prevent a two - dimensional ( 2d ) bose gas from making a phase transition to an ordered state , in accordance with the mermin - wagner - hohenberg theorem @xcite .",
    "however , the 2d bose gas supports topological defects in the form of vortices , and in the presence of interactions can instead undergo a berezinskii - kosterlitz - thouless ( bkt ) @xcite transition to a quasi - coherent superfluid state .",
    "the bkt transition was first observed in liquid helium thin films @xcite , however , more recently , evidence for this transition has been found in dilute bose gases @xcite ( also see @xcite ) .",
    "ultracold gases have proven to be beautiful systems for making direct comparisons between experiment and _ ab initio _ theory .",
    "experiments in the 2d regime present a new challenge for theory as strong fluctuations invalidate mean - field theories ( e.g.  see @xcite ) , and only recently have quantum monte carlo @xcite and classical field ( c - field ) @xcite methods been developed that are directly applicable to the experimental regime .    in this paper we study a uniform bose gas of finite spatial extent and parameters corresponding to current experiments .",
    "to analyze this system we use the projected gross - pitaevskii equation ( pgpe ) , a c - field technique suited to studying finite temperature bose fields with many highly occupied modes .",
    "we develop a technique for extracting the superfluid density based on linear response properties , and use this to understand the relationship between superfluidity and condensation in the finite system .    with this formalism",
    "we then examine two important applications : first , we provide a quantitative validation of the interference technique used in the ens experiment to determine the nature of two - point correlation in the system . to do this we simulate the interference pattern generated by allowing two independent 2d systems to expand and interfere .",
    "then applying the experimental fitting procedure to analyze the interference pattern we can extract the inferred two point correlations , which we can then compare against the _ in situ _ correlations that we calculate directly .",
    "second , we examine the correlations between vortices and antivortices in the system to directly quantify the emergence of vortex - antivortex pairing in the low temperature phase .",
    "a similar study was made by giorgetti _",
    "_ using a semiclassical field technique @xcite .",
    "we find results for vortex number and vortex pair distributions consistent with their results , and we show how a coarse graining procedure can be used to reveal the unpaired vortices in the system .",
    "we now briefly outline the structure of this paper : in sec .",
    "[ sform ] we review the 2d bose gas and relevant bkt physics . in sec .",
    "[ sec : method ] we outline the c - field technique and how it is specialized to describing a uniform , but finite , 2d bose gas . in sec .",
    "[ sec : res ] we present our main results , before concluding .",
    "here we consider a dilute 2d bose gas described by the hamiltonian @xmath0 where @xmath1 is the atomic mass , @xmath2 , and @xmath3 is the bosonic field operator .",
    "we take the two - dimensional geometry to be realized by tight confinement in the @xmath4 direction that restricts atomic occupation to the lowest @xmath4 mode .",
    "the dimensionless 2d coupling constant is @xmath5 with @xmath6 the spatial extent of the @xmath4 mode we have @xmath7 . ] and @xmath8 the s - wave scattering length .",
    "we will assume that @xmath9 so that the scattering is approximately three - dimensional @xcite , a condition well - satisfied in the ens and nist experiments @xcite . for reference ,",
    "the ens experiment reported in @xcite had @xmath10 , whereas in the nist experiments @xmath11 @xcite .",
    "in contrast to experiments we focus here on the uniform case ; no trapping potential in the @xmath12 plane is considered .",
    "we perform finite sized calculations corresponding to a square system of size @xmath13 with periodic boundary conditions . working in the finite size regime",
    "simplifies the simulations and is more representative of current experiments .",
    "we note that the thermodynamic limit corresponds to taking @xmath14 while keeping the density , @xmath15 , constant .",
    "the bkt superfluid phase has several distinctive characteristics , which we briefly review .",
    "below the bkt transition the first - order correlations decay according to an inverse power law : @xmath16 systems displaying such _ algebraic decay _ are said to exhibit _ quasi - long - range order _ @xcite .",
    "this is in contrast to both the high temperature ( disordered phase ) in which the correlations decay exponentially , and long - range ordered case of the 3d bose gas in which @xmath17 for @xmath18 .",
    "nelson and kosterlitz @xcite found that the exponent of the algebraic decay is related to the ratio of the superfluid density and temperature . to within logarithmic corrections @xmath19 where @xmath20 is the superfluid density and",
    "@xmath21 is the thermal de broglie wavelength .",
    "furthermore , nelson and kosterlitz showed that this ratio converges to a universal constant as the transition temperature , @xmath22 , is approached from below : @xmath23 ( i.e. ,  @xmath24 ) .",
    "thus , the superfluid fraction undergoes a universal jump from @xmath25 to @xmath26 as the temperature decreases through @xmath22 .",
    "another important indicator of the bkt transition is the behavior of topological excitations , which are quantized vortices and antivortices in the case of a bose gas .",
    "a single vortex has energy which scales with the logarithm of the system size . at low temperatures",
    "this means that the free energy for a single vortex is infinite ( in the thermodynamic limit ) , and vortices can not exist in isolation .",
    "as originally argued in @xcite , the entropic contribution to the free energy also scales logarithmically with the system size , and will dominate the free energy at high temperatures allowing unbound vortices to proliferate .",
    "this argument provides a simple estimate for the bkt transition temperature .",
    "although unbound vortices are thermodynamically unfavored at @xmath27 , bound pairs of counter - rotating vortices may exist since the total energy of such a pair is finite .",
    "this leads to a distinctive qualitative characterization of the bkt transition : as the temperature increases through @xmath22 pairs of vortices unbind .      while the relation @xmath26 between the superfluid density and temperature at the transition is universal , the total density , @xmath28 , at the transition is not .",
    "general arguments @xcite suggest that the transition point for the dilute uniform 2d bose gas is given by @xmath29 where @xmath30 is a constant .",
    "prokofv , ruebenacker and svistunov @xcite studied the homogeneous bose gas using monte carlo simulations of an equivalent classical @xmath31 model on a lattice . using an extrapolation to the infinite - sized system",
    ", they computed a value for the dimensionless constant , @xmath32 . by inverting eq .",
    "( [ critpsd ] ) , we obtain the bkt critical temperature for the infinite system @xmath33 we use the superscript @xmath34 to indicate that this result holds in the thermodynamic limit .",
    "we briefly outline the pgpe formalism , which is developed in detail in ref . @xcite .",
    "the bose field operator is split into two parts according to @xmath35 where @xmath36 is the coherent region c - field   and @xmath37 is the incoherent field operator ( see @xcite ) .",
    "these fields are defined as the low and high energy projections of the full quantum field operator , separated by the cutoff wave vector @xmath38 . in our theory",
    "this cutoff is implemented in terms of the plane wave eigenstates @xmath39 of the time - independent single particle hamiltonian , that is , @xmath40 with @xmath41 .",
    "the fields are thus defined by @xmath42 where the @xmath43 are bose annihilation operators , the @xmath44 are complex amplitudes , and the sets of quantum numbers defining the regions are @xmath45      in general , the applicability of the pgpe approach to describing the finite temperature gas relies on an appropriate choice for @xmath38 , so that the modes at the cutoff have an average occupation of order unity . in this work",
    "we choose an average of five or more atoms per mode using a procedure discussed in appendix [ sec : sim_details ] .",
    "this choice means that all the modes in @xmath46 are appreciably occupied , justifying the classical field replacement @xmath47 .",
    "in contrast the @xmath48 region contains many sparsely occupied modes that are particle - like and would be poorly described using a classical field approximation .",
    "because our 2d system is critical over a wide temperature range , additional care is needed in choosing @xmath46 .",
    "typically strong fluctuations occur in the infrared modes up to the energy scale @xmath49 . above this energy",
    "scale the modes are well described by mean - field theory ( e.g.  see the discussion in @xcite ) . for the results we present here ,",
    "we have @xmath50 for simulations around the transition region and at high temperature . at temperatures well below @xmath22 , the requirement of large modal occupation near",
    "the cutoff competes with this condition and we favor the former at the expense of violating eq .  .",
    "the equation of motion for @xmath36 is the pgpe @xmath51 where the projection operator @xmath52 formalizes our basis set restriction of @xmath36 to the @xmath46 region .",
    "the main approximation used to arrive at the pgpe is to neglect dynamical couplings to the incoherent region @xcite .",
    "we assume that eq .",
    "( [ pgpe ] ) is ergodic @xcite , so that the microstates \\{@xmath36 } generated through time evolution form an unbiased sample of the equilibrium microstates .",
    "time averaging can then be used to obtain macroscopic equilibrium properties .",
    "we generate the time evolution by solving the pgpe with three adjustable parameters : ( i ) the cutoff wave vector , @xmath38 , that defines the division between @xmath46 and @xmath48 , and hence the number of modes in the @xmath46 region ; ( ii ) the number of @xmath46 region atoms , @xmath53 ; ( iii ) the total energy of the @xmath46 region , @xmath54 .",
    "the last two quantities , defined as @xmath55 are important because they represent constants of motion of the pgpe , and thus control the thermodynamic equilibrium state of the system .      to characterize the equilibrium state in the @xmath46 region it is necessary to determine the average density , temperature and chemical potential , which in turn allow us to characterize the @xmath48 region ( see sec .",
    "[ sec : above_cutoff ] ) .",
    "these and other @xmath46 region quantities can be computed by time - averaging , e.g , the average @xmath46 region density is given by @xmath56 where @xmath57 is a set of @xmath58 times ( after the system has been allowed to relax to equilibrium ) at which the field is sampled .",
    "we typically use 2000 samples from our simulation to perform such averages over a time of @xmath59 s. another quantity of interest here is the first order correlation function , which we calculate directly via the expression @xmath60    derivatives of entropy , such as the temperature ( @xmath61 ) and chemical potential ( @xmath62 ) can be calculated by time averaging appropriate quantities constructed from the hamiltonian ( [ ec ] ) using the rugh approach @xcite .",
    "the detailed implementation of the rugh formalism for the pgpe is rather technical and we refer the reader to refs .",
    "@xcite for additional details of this procedure .",
    "a major extension to the formalism of the pgpe made in this work is the development of a method for extracting the superfluid fraction , @xmath20 , from these calculations . for this",
    "we use linear response theory to relate the superfluid fraction to the long wavelength limit of the second order momentum density correlations .",
    "an extensive discussion of this approach , and the numerical methods used to implement it , are presented in appendix [ sec : superfluid_fraction ] .",
    "occupation of the @xmath48 region modes , @xmath63 , accounts for about 25% of the total number of atoms at temperatures near the phase transition .",
    "we assume a time independent state for the @xmath48 region atoms defined by a wigner function @xcite , allowing us to calculate quantities of interest by integrating over the above - cutoff momenta , @xmath64 @xcite .",
    "our assumed wigner function corresponds to the self - consistent hartree - fock theory as applied in @xcite . in two dimensions",
    "this is @xmath65 where @xmath66 is the hartree - fock energy , @xmath67 is the @xmath48 region density , and @xmath68 is the chemical potential ( shifted by the mean - field interaction with the @xmath48 region atoms ) . note that the average densities are constant in the uniform system , so @xmath69 has no explicit @xmath70 dependence , however , we include this variable for generality when defining the associated correlation function .    the @xmath48 region density appearing in eq .",
    "is given by @xmath71 with corresponding atom number @xmath72 ; total number is simply @xmath73 an analytic expression for @xmath67 and simplified procedure for numerically calculating the first order correlation function of the @xmath48 region atoms , @xmath74 , can be obtained by taking integrals over the phase space .",
    "these results are discussed in appendix [ sec : above_cutoff_integrals ] .",
    "generating equilibrium classical fields with given values of @xmath54 and @xmath76 is straightforward since the pgpe simulates a microcanonical system ( see appendix [ sec : initial_given_ec_nc ] ) .",
    "however , we wish to simulate systems with a given temperature and total number . as described in the preceding two sections these can only be determined after a simulation has been performed . in appendix",
    "[ sec : sim_details ] we outline a procedure for estimating values of @xmath54 and @xmath76 for desired values of @xmath75 and @xmath61 based on a root finding scheme using a hartree - fock - bogoliubov analysis for the initial guess .",
    "we choose simulation parameters in analogy with the paris experiment of hadzibabic _",
    "et al . _",
    "this experiment used an elongated atomic cloud of approximately @xmath77 @xmath78rb atoms , with a spatial extent ( thomas - fermi lengths ) of 120 @xmath79 m and 10 @xmath79 m along the two loosely trapped @xmath80 and @xmath81 directions .",
    "the tight confinement in the @xmath4 direction was provided by an optical lattice .",
    "although our simulation is for a uniform system , we have chosen similar parameters where possible .",
    "our primary simulations are for a system in a square box with @xmath82 @xmath79 m , with @xmath83 @xmath78rb atoms .",
    "we also present results for systems with @xmath84 @xmath79 m and @xmath85 @xmath79 m at the same density in order to better understand finite - size effects .",
    "all simulations are for the case of @xmath86 corresponding to the experimental parameters reported in @xcite .    the cutoff wave vector @xmath38 varied with temperature to ensure appropriate occupation of the highest modes ( see sec .  [ cregionchoice ] ) .",
    "for the 100 @xmath79 m system , the number of @xmath46 region modes ranged between 559 at low temperatures to 11338 at the highest temperature studied .      in order to make a direct comparison with the experimental results of @xcite , we have generated synthetic interference patterns and implemented the experimental analysis technique .",
    "our simulated imaging geometry is identical to that found in @xcite , with expansion occurring in the @xmath4-direction .",
    "the interference pattern is formed in the @xmath80-@xmath4 plane via integration of the density along the @xmath81-direction ( `` absorption imaging '' ) .",
    "our algorithm for obtaining the interference pattern due to our classical field is very similar to that presented in @xcite .",
    "our above cutoff thermal cloud is taken into account separately .",
    "we consider a pair of fields @xmath87 from different times during the simulation , chosen such that the fields can be considered independent .",
    "the 3d wavefunction corresponding to each field is reconstructed by assuming a harmonic oscillator ground state in the tight - trapping direction .",
    "these two reconstructed fields are spatially separated by @xmath88 @xmath79 m , corresponding to the period of the optical lattice in @xcite .",
    "given this initial state , we neglect atomic interactions and only account for expansion in the tightly - trapped direction .",
    "this yields a simple analytical result for the full classical field @xmath89 at later times .",
    "the contribution of the above - cutoff atoms is included by an incoherent addition of intensities .",
    "the result is integrated along the @xmath81-direction to simulate the effect of absorption imaging with a laser beam , that is , @xmath90 } , \\\\",
    "\\psi_{\\text{\\bf{c}}}^{(t ) }      & = \\psi_{\\text{\\bf{c}}}^{(1)}(x , y , z,\\tau)+\\psi_{\\text{\\bf{c}}}^{(2)}(x\\!-\\!\\delta , y , z,\\tau).\\end{aligned}\\ ] ] rather than integrate the full field along the @xmath81-direction , we use only a slice of length @xmath91 @xmath79 m in keeping with the experimental geometry of ref .  @xcite .",
    "the interference patterns , @xmath92 , generated this way contained fine spatial detail not seen in the experimental images . to make a more useful comparison to experiment it is necessary to account for the finite optical imaging resolution by applying a gaussian convolution in the @xmath80-@xmath4 plane with standard deviation 3 @xmath79 m . @xcite .",
    "in accordance with the paris experiment , we use a 22  ms expansion time to generate interference patterns for quantitative analysis ( see sec .",
    "[ g1interfere ] ) . to obtain characteristic interference images for display in @xcite ,",
    "the experiments used a shorter 11 ms expansion @xcite .",
    "we exhibit examples of interference patterns at various temperatures in fig .",
    "[ fig : interference_eg ] , for this shorter expansion time .",
    "these images show a striking resemblance to the results presented in ref .",
    "@xcite .",
    "synthetic interference patterns generated from the 50 @xmath79 m grid by simulation of the experimental procedure of ref .",
    "( a ) at low temperatures , @xmath93 , the interference fringes are straight .",
    "( b ) just below the transition temperature , @xmath94 , the fringes become wavy due to decreased spatial phase coherence .",
    "phase dislocations become common at temperatures above the transition , ( c ) @xmath95 , and ( d ) @xmath96 .",
    "these `` zipper patterns '' indicate the presence of free vortices .",
    "( e ) when simulation of the finite imaging resolution is disabled , the zipper patterns from the field in sub figure ( d ) are no longer clearly visible ; the high - frequency details obscure the phase information without providing obvious additional information about the existence of vortex pairs .",
    ", title=\"fig:\",height=238 ]   synthetic interference patterns generated from the 50 @xmath79 m grid by simulation of the experimental procedure of ref .",
    "( a ) at low temperatures , @xmath93 , the interference fringes are straight .",
    "( b ) just below the transition temperature , @xmath94 , the fringes become wavy due to decreased spatial phase coherence .",
    "phase dislocations become common at temperatures above the transition , ( c ) @xmath95 , and ( d ) @xmath96 .",
    "these `` zipper patterns '' indicate the presence of free vortices .",
    "( e ) when simulation of the finite imaging resolution is disabled , the zipper patterns from the field in sub figure ( d ) are no longer clearly visible ; the high - frequency details obscure the phase information without providing obvious additional information about the existence of vortex pairs .",
    ", title=\"fig:\",height=238 ]      for a 2d bose gas in a box we expect a nonzero condensate fraction due to the finite spacing of low - energy modes .",
    "a central question is whether we can observe a distinction between the crossover due to bose condensation and that due to bkt physics . to address this question",
    "we have computed both the condensate and superfluid fractions from our dynamical simulations .    the condensate fraction in a homogeneous system is easily identified as the average fractional occupation of the lowest momentum mode .",
    "this is directly available from our simulations as a time average of the @xmath97 mode of the classical field , @xmath98    extracting the superfluid fraction from dynamical classical field simulations provides a more difficult challenge .",
    "for this we use linear response theory to relate the superfluid fraction to the long wavelength limit of the second order momentum density correlations .",
    "details concerning the technique are given in appendix [ sec : superfluid_fraction ] .",
    "( color online ) .",
    "condensate fraction ( solid dots ) and superfluid fraction ( crosses ) as functions of temperature for the 100 @xmath79m@xmath99 grid . the transition temperature in the thermodynamic limit , @xmath100 @xcite , is shown as a vertical dot - dashed line .",
    "the vertical dashed line shows our estimate for the transition temperature in the finite system .",
    "the thick solid line is the condensate fraction for an ideal bose gas in the grand canonical ensemble with the same number of atoms and periodic spatial domain .",
    "the superfluid fraction becomes negative in places because the extrapolation of the momentum correlations to @xmath101 is sensitive to statistical noise at high temperature ( see appendix [ sec : superfluid_fraction_numerics ] for details ) . , width=302 ]     ( color online ) .",
    "detail of the superfluid fraction near the transition temperature .",
    "solid dots represent the calculation based on momentum correlations as described in appendix [ sec : superfluid_fraction ] .",
    "results for the largest and smallest grids are shown ( left and right , respectively ) .",
    "the data for the 100 @xmath79 m grid is omitted for clarity , but lies between the curves shown as expected .",
    "open circles represent the calculation of the superfluid fraction from the associated fitted values for the decay coefficient @xmath102 , via eq .  .",
    "the open circles terminate where the power law fitting procedure fails .",
    ", width=302 ]    figure [ fig : fc_fs_vs_t ] compares the results for the superfluid and condensate fractions computed on the 100 @xmath79 m grid .",
    "these results are qualitatively similar to the results for the larger and smaller grids . in particular",
    ", we note that there is no apparent separation between temperatures at which the superfluid and condensate fractions fall to zero . also shown in fig .",
    "[ fig : fc_fs_vs_t ] is the condensate fraction for the ideal bose gas confined to an identical finite - size box in the grand canonical ensemble .",
    "the large shift between ideal and computed transition temperatures indicates the effect of interactions in the 2d system . because the average system density is uniform ,",
    "this large shift is to due to critical fluctuations ( also see @xcite ) .    in our calculations",
    "we identify the transition temperature , @xmath22 , as where the superfluid fraction falls off most rapidly ( i.e. , the location of steepest slope on the @xmath20 versus @xmath61 graph ; see fig .",
    "[ fig : fc_fs_vs_t ] ) . as the system size increases",
    ", this transition temperature moves toward the value for an infinite - sized system , @xmath100 @xcite .",
    "this effect is illustrated by the behavior of the superfluid fraction in fig .",
    "[ fig : fs_all_vs_t ] .      algebraic decay of the first order correlations , as described by eq .",
    ", is a characteristic feature of the bkt phase . above the bkt transition",
    ", the first order correlations should revert to the exponential decay expected in a disordered phase .    the normalized first order correlation function , @xmath103 is defined by @xmath104 where @xmath105 is the unnormalized first order correlation function @xcite .      in the pgpe formalism",
    "the @xmath46 and @xmath48 contributions to the correlation function are additive @xcite , that is , @xmath106 where @xmath107 and @xmath74 are defined in eqs .   and , respectively .",
    "it is interesting to note that @xmath107 and @xmath74 individually display an oscillatory decay behavior  originating from the cutoff  an effect which correctly cancels when the two are added together .",
    "having calculated @xmath103 , we obtain the coefficient @xmath102 by fitting the algebraic decay law , eq .  , using nonlinear least squares ; sample fits are shown in fig .",
    "[ fig : alpha_fit_eg ] .",
    "the fit is conducted over the region between 10 and 40 de  broglie wavelengths .",
    "the short length scale cutoff is to avoid the contribution of the non - universal normal atoms , for which the thermal de  broglie wavelength sets the appropriate decay length .",
    "the long distance cutoff is chosen to be small compared to the length scale @xmath13 , to avoid the effect of periodic boundary conditions on the long range correlations .",
    "the quality of the fitting procedure , and the breakdown of expression at the bkt transition can be observed by adding an additional degree of freedom to the fitting function .",
    "in particular , at each temperature we fit the quadratic @xmath108 and extract the parameter @xmath109 ( @xmath110 is discarded ) . the abrupt failure of the fits",
    "can be observed in the inset of fig .",
    "[ fig : alpha_comparison ] as a sudden increase in the value of @xmath111  an effect which is in excellent agreement with the value of @xmath22 as estimated from the superfluid fraction .",
    "( color online ) .",
    "sample fits to the algebraic decay of @xmath103 at various temperatures , ranging from below to above the transition .",
    "high temperatures correspond to curves at the bottom of the figure which have rapid falloff of @xmath103 with distance .",
    "fits are shown on a log - log scale in the inset to emphasize the failure of a power law in describing the behavior of @xmath103 at high temperature .",
    ", width=302 ]     ( color online ) .",
    "comparison of two methods for determining the algebraic decay coefficient @xmath112 for the first order correlation function @xmath113 .",
    "the line with circle markers represents direct fits to @xmath103 .",
    "these fits fail at the transition temperature as shown by the sharply diverging value of @xmath111 in the inset .",
    "the filled points represent the values @xmath114 obtained from a simulation of the experimental analysis procedure of @xcite , described in sec .",
    "[ g1interfere ] .",
    "horizontal dotted lines at 0.25 and 0.5 correspond to the expected values of @xmath115 just below and above the transition , respectively @xcite .",
    "the vertical line is the bkt transition temperature , as estimated from the superfluid fraction calculated in sec .",
    "[ sec : fc_fs ] .",
    ", width=302 ]      so far a direct probe of the _ in situ _ spatial correlations has not been possible , although important progress has been made by the nist group @xcite . in the experiments of hadzibabic _",
    "@xcite a scheme proposed by polkovnikov _",
    "@xcite was used to infer these correlations from the `` waviness '' of interference patterns produced by pair of quasi-2d systems ( see sec .  [ siminterference ] ) . in this section",
    "we simulate the experimental data analysis method , and compare inferred predictions for the correlation function against those we can directly calculate .",
    "this allows us to characterize the errors associated with this technique arising from finite size effects and finite expansion time .    to make this analysis we follow the procedure outlined in @xcite .",
    "we fit our numerically generated interference patterns ( see sec .  [ siminterference ] ) to the function @xmath116},\\ ] ] where @xmath117 is a gaussian envelope in the @xmath4-direction , @xmath118 is the interference fringe contrast , @xmath119 is the fringe spacing and @xmath120 is the phase of the interference pattern in the @xmath4-direction .",
    "defining the function @xmath121 the nature of spatial correlations is then revealed by the manner in which @xmath122 decays with @xmath123 . in particular , we identify the parameter @xmath115 , defined by @xmath124 @xcite . for an infinite 2d system in the superfluid regime ( @xmath125 ) @xmath126",
    "( i.e. @xmath115 corresponds to the algebraic decay of correlations ) . for @xmath127 , where correlations decay exponentially , @xmath115 is equal to @xmath128 .",
    "fitting @xmath122 to the algebraic decay law @xmath129 we can determine @xmath115 .",
    "a comparison between @xmath115 inferred from the interference pattern and @xmath102 obtained directly from @xmath103 is shown in fig .",
    "[ fig : alpha_comparison ] .",
    "both methods give broadly consistent predictions for @xmath102 when @xmath27 , however our results show that there is a clear quantitative difference between the two schemes , and that @xmath115 underestimates the coefficient of algebraic decay in the system ( i.e. using @xmath115 in eq .",
    "( [ eqn : alpha_rhos_t ] ) would overestimate the superfluid density ) .",
    "near and above transition temperature , where the fits to @xmath103 fail , we observe that @xmath115 converges toward @xmath128 .",
    "the agreement between @xmath102 and @xmath115 in the low temperature region improves as the size of the grid is increased .",
    "the simplest description of the bkt transition is that it occurs as a result of vortex pair unbinding : at @xmath27 vortices only exist in pairs of opposite circulation , which unbind at the transition point to produce free vortices that destroy the superfluidity of the system .",
    "however , to date there are no direct experimental observations of this scenario , and theoretical studies of 2d bose gases have been limited to qualitative inspection of the vortex distributions . in the c - field approach vortices and their dynamics are clearly revealed , unlike other ensemble - based simulation techniques where the vortices are obscured by averaging .",
    "this gives us a unique opportunity to investigate the role of vortices and pairing in a dilute bose gas .",
    "we detect vortices in the c - field microstates by analyzing the phase profile of the instantaneous field ( see appendix [ sec : vortex_detection ] ) .",
    "an example of a phase profile of a field for @xmath27 is shown in fig .",
    "[ fig : vortex_pairing_eg](a ) .",
    "the vortex locations reveal a pairing character , that is , the close proximity of pairs of positive ( clockwise ) and negative ( counterclockwise ) vortices relative to the average vortex separation .",
    "an important qualitative feature of our observed vortex distributions is that at high temperatures , pairing does not disappear from the system entirely .",
    "indeed , most vortices at high temperature could be considered paired or grouped in some manner , as shown in fig .",
    "[ fig : vortex_pairing_eg](b ) .",
    "perhaps this is not surprising , since positive and negative vortices have a logarithmic attraction , and we observe them to create and annihilate readily in the c - field dynamics .",
    "however , this does indicate that the use of pairing to locate the transition may be ambiguous , and we examine this aspect further below .",
    "( color online ) .",
    "phase profile of a c - field with vortices indicated .",
    "vortices with clockwise ( white @xmath130 ) and anticlockwise ( black @xmath131 ) circulation .",
    "the phase of the classical field is indicated by shading the background between dark blue ( phase 0 ) and light yellow ( phase @xmath132 ) .",
    "( a ) distinctive pairing below the transition at @xmath133 ( b ) a `` vortex plasma '' above the transition at @xmath134 . , width=264 ]    it is also of interest to measure the number of vortices , @xmath135 , present in the system as a function of temperature ( see fig .  [",
    "fig : nv_vs_t ] ) . at the lowest temperatures the system is in an ordered state , and the energetic cost of having a vortex is prohibitive .",
    "as the temperature increases there is a rapid growth of vortex population leading up to the transition point followed by linear growth above @xmath22 .",
    "total number of vortices ( dots ) and number of unpaired vortices ( circles ) as a function of temperature near the transition .",
    "while @xmath135 at the transition temperature is already very high , @xmath136 becomes nonzero only close to the transition , providing clear evidence of vortex unbinding at work .",
    "the inset shows the variation in the total number over the full temperature range of the simulations . above the transition temperature",
    "the growth in the number of vortices becomes linear with temperature .",
    ", width=302 ]      the most obvious way to characterize vortex pairing is by defining a pair distribution function for vortices of opposite sign . adopting the notation of @xcite ,",
    "this is @xmath137 where @xmath138 is the vortex density function which consists of a sum of delta - spikes , @xmath139 for positive vortices at positions @xmath140 .",
    "we use the analogous definition for @xmath141 .",
    "the associated dimensionless two - vortex correlation function is @xmath142 the angular average of @xmath143 can be calculated directly from the detected vortex positions using a binning procedure on the pairwise distances @xmath144 , and is shown in fig .",
    "[ fig : pairing_pdfs ] .",
    "these results quantify the effect discussed earlier : positive and negative vortices show a pairing correlation which does not disappear above @xmath22 .",
    "the characteristic size of this correlation , given by twice the width of the peak feature in fig .",
    "[ fig : pairing_pdfs ] , is @xmath145 m ( taking full width half maximum ) .",
    "the shape of our pairing peak is qualitatively similar to that described in @xcite .",
    "however , in contrast to their results the width does not appear to change appreciably with temperature .",
    "additional simulations show that increasing the interaction strength causes the peak to become squarer and wider .",
    "it is clear that while the pair size and strength revealed in @xmath146 does not change appreciably as the transition is crossed , the amount of pairing relative to the background uncorrelated vortices changes considerably .",
    "this background of uncorrelated vortices is given by the horizontal plateau @xmath147 at large @xmath148 as shown in the inset .",
    "( color online ) .",
    "angular average of the two - vortex pair distribution functions for vortices of opposite sign .",
    "three temperatures centered about the transition are shown : dot markers @xmath149nk @xmath150 , @xmath151 ; circle markers @xmath152nk @xmath153 , @xmath154 ; cross markers @xmath155nk @xmath156 , @xmath157 .",
    "the vertical dotted line shows the value of the healing length at @xmath158 .",
    "the main plot shows @xmath143 normalized by the positive vortex density ; comparable magnitudes for the peaks near @xmath159 show that vortex pairing remains important over the range of temperatures studied , not only below the transition .",
    "the inset shows @xmath143 in the natural dimensionless units for which @xmath147 as @xmath160 .",
    ", width=302 ]      the function @xmath161 clearly indicates the existence of vortex pairing in the system .",
    "however , it does not provide a convenient way to locate the transition temperature , since a large amount of pairing exists both below and above the transition : the expected number of neighbors for any given vortex  roughly , the area of the pairing peak of @xmath162 shown in fig .",
    "[ fig : pairing_pdfs ]  does not change dramatically across the transition .",
    "@xmath163 is the expected density of positive vortices .",
    "we desire a quantitative observation of vortex unbinding at the transition and have therefore investigated several measures of vortex pairing . of positive vortices and the set @xmath164 of negative vortices .",
    "] however , measures based directly on the full set of vortex positions seem to suffer from the proliferation of vortices at high temperature  an effect which tends to wash out clear signs of vortex unbinding . with this in mind",
    ", we have developed a procedure for measuring the number of _ unpaired _ vortices in our simulations , starting from the classical field rather than the full set of vortex positions .",
    "the basis of our approach for detecting unpairing is to coarse - grain the classical field by convolution with a gaussian filter of spatial width ( standard deviation ) @xmath165 .",
    "this removes all vortex pairs on length scales smaller than than @xmath165 .",
    "figure [ fig : coarsegrain ] shows the count of remaining vortices as a function of filter width , along with some examples of coarse - grained fields . for @xmath166 ,",
    "the number of remaining vortices levels off and only decreases slowly with increasing @xmath165 .",
    "ultimately the number of remaining vortices goes to zero as @xmath167 .",
    "setting the filter width to be larger than the characteristic pairing distance , @xmath168 , yields a coarse - grained field from which the pairs have been removed , but unpaired vortices remain . in our simulations",
    "we have @xmath169 @xmath79 m ; we take the vortices which remain after coarse - graining with a gaussian of standard deviation @xmath170 @xmath79 m to give an estimate of the number of unpaired vortices , @xmath136 .",
    "figure [ fig : nv_vs_t ] shows that @xmath136 becomes nonzero only near the transition , in contrast to @xmath135 which is nonzero well below @xmath22 .",
    "the sharp increase in @xmath136 at @xmath22 is a quantitative demonstration of vortex unbinding at work .",
    "( color online ) .",
    "the coarse - graining procedure : number of vortices as a function of filter width for a temperature near the transition .",
    "the smooth curve is an average over many realizations of the field , whereas the stepped curve shows typical behavior of the number for a single field .",
    "insets show the coarse - grained fields for various filter widths ; the transformation removes vortex - antivortex pairs which are separated by approximately less than the standard deviation of the filter . in this example",
    "@xmath171 unpaired vortices remain at @xmath172 @xmath79 m .",
    ", width=302 ]    in the experiment of ref .",
    "@xcite , the fraction of interference patterns with dislocations ( e.g. , see figs .",
    "[ fig : interference_eg](c ) and ( d ) ) was measured . while isolated vortices are clearly identified by interference pattern dislocations",
    ", a lack of spatial resolution in experiments means that this type of detection method obscures the observation of tightly bound vortex pairs .",
    "the experimental resolution of 3 @xmath79 m is broadly consistent with the scale of the coarse - graining filter ( i.e. , @xmath172 @xmath79 m ) . with this in mind",
    ", we introduce the quantity @xmath173 , defined as the probability of observing an unpaired vortex in a @xmath174 @xmath79 m control volume at a given temperature . @xmath79",
    "m in order to compare results between simulations with different grid sizes . ] for the 50 @xmath79 m grid we have simply @xmath175 .",
    "computing @xmath173 from our simulations yields the results shown in fig .",
    "[ fig : pairing2 ] .",
    "our results show a dramatic jump in @xmath176 at a temperature that is consistent with the transition temperature @xmath22 determined from the superfluid fraction calculation presented in sec .",
    "[ sec : fc_fs ] .",
    "( color online ) .",
    "comparison of vortex unpairing measures .",
    "the dots are our pairing measure based on coarse - graining the field .",
    "circles represent the pairing as determined by the number of dislocations in the simulated interference patterns .",
    "this was the same method used in the experimental analysis of @xcite and coincides remarkably well with our coarse - graining based measure .",
    "both curves are consistent with the vertical line showing the transition temperature @xmath22 as determined from the superfluid fraction calculation in sec .",
    "[ sec : fc_fs ] .",
    "the inset shows the calculated coarse - grained pairing measure for all three grid sizes , along with vertical lines showing the estimates for @xmath22 derived from the superfluid fraction calculations .",
    ", width=302 ]    from the definition , we expect that @xmath176 should be close to the experimentally measured frequency of dislocations . to demonstrate this relationship , we have simulated interference patterns ( as described in sec .",
    "[ siminterference ] ) and detected dislocations using the experimental procedure of ref .",
    "@xcite : a phase gradient @xmath177 was considered to mark a dislocation whenever @xmath178 rad@xmath179 m . from this",
    "we can compute the probability of detecting at least one dislocation as a function of temperature . as shown in fig .",
    "[ fig : pairing2 ] , the results of this procedure compare very favorably with our measure of pairing based on @xmath176 .",
    "we note that inhomogeneous effects in experiments probably broaden the jump in @xmath176 appreciably compared to our homogeneous results .",
    "in this paper we have used c - field simulations of a finite - sized homogeneous system in order to investigate the physics of the 2d bose gas in a regime corresponding to current experiments .",
    "we have directly computed the condensate and superfluid fractions as a function of temperature , and made comparisons to the superfluid fraction inferred by the first order correlation function , and using the interference scheme used in experiments .",
    "our results for these quantities provide a quantitative test of the interference scheme for a finite system .",
    "a beautiful possibility is the direct experimental observation of vortex - antivortex pairs , their distribution in the system , and hence a quantitative measurement of their unbinding at the bkt transition .",
    "we have calculated the vortex correlation function across the transition and provided a coarse - graining scheme for distinguishing unpaired vortices .",
    "these results suggest that the dislocations observed in experiments , due to limited optical resolution , provide an accurate measure of the unpaired vortex population and accordingly are a strong indicator of the bkt transition .",
    "we briefly discuss the effect that harmonic confinement ( present in experiments ) would have on our predictions .",
    "the spatial inhomogeneity will cause the superfluid transition to be gradual , occurring first at the trap center where the density is highest , in contrast to our results where the transition occurs in the bulk .",
    "so far the superfluid fraction for the trapped system has been determined by using the universality result for the critical density in the homogeneous gas @xcite in combination with the local density approximation @xcite .",
    "it would be interesting to be able to compute the superfluid fraction independently as we have done here ; however it is not clear how to do so .",
    "bisset _ et al . _",
    "@xcite used an extension of the c - field method for the trapped 2d gas to examine @xmath103 and found similar results for the onset of algebraic decay of correlations at the transition .",
    "their analysis was restricted to the small region near the trap center where the density is approximately constant ; we expect the results of our vortex correlation function and the coarse - graining scheme should similarly be applicable to the trapped system in the central region . except in very weak traps ,",
    "the size of this region is relatively small and will likely prove challenging to measure experimentally .    our results for",
    "the homogeneous gas emphasize the clarity with which _ ab initio _ theoretical methods can calculate quantities directly observable in experiments , such as interference patterns .",
    "this should allow direct comparisons with experiments , providing stringent tests of many - body theory .",
    "the authors are grateful for several useful discussions with keith burnett and zoran hadzibabic .",
    "cjf and mjd acknowledge financial support from the australian research council centre of excellence for quantum - atom optics .",
    "pbb is supported by frst contract nerf - uoox0703 .",
    "here we outline our procedure for determining the properties of the @xmath46 region and the steps used to create initial states for the pgpe solver .",
    "the @xmath46 region itself is characterized by the cutoff momentum @xmath38 , while the initial states are characterized by the energy @xmath54 and number @xmath76 .",
    "we want to obtain values of these three properties which are consistent with a specified temperature @xmath61 and total number of atoms @xmath75 .      to generate an initial estimate of the @xmath46 region parameters we solve the self - consistent hartree - fock - bogoliubov ( hfb ) equations in the so - called popov approximation @xcite to find an approximate thermal state for the system at a temperature @xmath61 .",
    "the resulting state is a bose einstein distribution of quasiparticles interacting only via the mean - field , expressed in terms of the quasiparticle amplitudes @xmath180 and @xmath181 .",
    "occupations for the @xmath46 region field may be computed directly from the quasiparticle occupations via @xmath182 where @xmath183 is the bose einstein distribution and @xmath184 is the quasiparticle energy which is obtained by solving the bogoliubov - de  gennes equations self consistently   @xcite .",
    "this allows us to compute the cutoff as the maximum value of @xmath185 consistent with sufficient modal occupation : @xmath186 we choose @xmath187 for the sufficient occupation condition on the @xmath46 region modes .",
    "the number of atoms below the cutoff may be computed directly from the sum of the condensate number @xmath188 and the number of @xmath46 region excited state atoms , @xmath189 : @xmath190    for the total energy below the cutoff , we use the expression @xmath191}\\end{gathered}\\ ] ] where @xmath192 . rearranging ,",
    "this is @xmath193}.\\end{aligned}\\ ] ] the expression differs from eq .",
    "( 22 ) of @xcite as we have retained the zeroth order ( constant ) terms that are required to match the energy scale of the hfb analysis to the zero point of energy in the classical field simulations .",
    "a simple comparison between simulations at varying temperatures can only be carried out if the total number of atoms is fixed .",
    "this presents a problem in our simulations : although the number of atoms and energy of the @xmath46 region can be directly specified ( see sec .",
    "[ sec : initial_given_ec_nc ] ) , we may only determine the total number after performing a simulation .",
    "this is because the number of atoms in the @xmath48 region depends on the temperature and chemical potential which are calculated by ergodic averaging of the @xmath46 region simulations .",
    "formally , this may be stated as a root - finding problem : solve @xmath194 with initial guess provided by the solution to the hfb analysis in sec .",
    "[ sec : hfb ] . although both @xmath76 and @xmath54 affect the total number @xmath75 , we choose to fix @xmath76 to the initial guess and to vary @xmath54 until the desired total number is found .",
    "we note that evaluating the function @xmath195 is very computationally expensive and difficult to fully automate since it involves a simulation and several steps of analysis . for this reason we use a nonstandard root finding procedure : for the first iteration we simulate three energies about the initial guess @xmath54 such that the results crudely span @xmath196 ; these three simulations can be performed in parallel which significantly reduces the time to a solution .",
    "a second guess was obtained by quadratic fitting of @xmath54 as a function of @xmath75 which gives @xmath75 accurate to within about 5% of @xmath196 .",
    "an addition iteration using the same interpolation method takes @xmath75 to within 0.3% , which we consider sufficient .",
    "we note that changing @xmath54 during the root finding procedure means we have no direct control over the final temperature of each specific simulation . in our case",
    "this is not a problem because we only require a range of temperatures spanning the transition . in principle",
    "one could solve for a given temperature by allowing @xmath76 to vary in addition to @xmath54 .",
    "we compute initial conditions for the @xmath46 region field in a similar way to @xcite . using the representation for the @xmath46 region given by eq .",
    ", the task is to choose appropriate values for the @xmath197 . as a first approximation ,",
    "choose the smallest value for a momentum cutoff @xmath198 such that the field with coefficients @xmath199 has energy greater than @xmath54 . here",
    "@xmath200 is chosen so that the field has normalization corresponding to @xmath76 atoms , and @xmath201 is a randomly chosen phase which is fixed for each mode at the start of the procedure .",
    "the random phases allow us to generate many unique random initial states at the same energy .    by definition",
    ", the field defined by has energy slightly above the desired energy .",
    "this problem is solved by mixing it with the lowest energy state : @xmath202 using a root finding procedure to converge on the desired energy @xmath54 .",
    "the scheme generates random realizations of a non - equilibrium field with given @xmath54 and @xmath76 which are then simulated to equilibrium before using ergodic averaging for computing statistics .",
    "our assumed self - consistent wigner function ( sec .  [ sec : above_cutoff ] ) for the @xmath48 region atoms takes a particularly simple form in the homogeneous case : @xmath203    the above - cutoff density may then be found by direct integration : @xmath204},\\end{aligned}\\ ] ] with @xmath205 the thermal de broglie wavelength .    in a similar way",
    ", the assumed wigner function allows any desired physical quantity to be estimated via a suitable integral .",
    "a particular quantity of interest in the current work is the first order correlation function , which can be obtained from the wigner function as @xcite @xmath206    this integral is of the general form @xmath207 for constants @xmath200 and @xmath208 . noting that @xmath209 depends only on the length , @xmath148 of @xmath210 , and transforming @xmath211 to polar coordinates @xmath212 , we have @xmath213}^2 j_0(r\\kappa),\\end{aligned}\\ ] ] ( see ( * ? ? ?",
    "* p902 ) for the bessel function identity ) .",
    "thus we obtain @xmath214 in terms of a one dimensional integral which may be performed numerically : @xmath215",
    "the defining feature of a `` charge-@xmath1 '' vortex is that the phase @xmath216 of the complex field @xmath217 changes continuously from @xmath218 to @xmath219 around any closed curve which circles the vortex core .",
    "we express our field @xmath220 on a discrete grid in position space ; the aim of vortex detection is then to determine which grid plaquettes ( that is , sets of four adjacent grid points ) contain vortex cores .    to obtain the phase winding about a plaquette ,",
    "first consider the phase at two neighboring grid points a and b. we are interested in the unwrapped phase difference @xmath221 between the grid points ; unwrapping ensures that the phase is _ continuous _ between a and b. ( in the discrete setting such continuity is poorly defined ; the best we can do is to correct for the possibility of @xmath132 phase jumps by adding or subtracting factors of @xmath132 so that @xmath222 . )",
    "the unwrapped phase differences around a grid plaquette tell us a total phase change @xmath223 where @xmath224 is the winding number or `` topological charge '' .    due to the necessity of unwrapping the phase ,",
    "a four - point grid plaquette can not unambiguously support vortices with charge larger than one .",
    "luckily , such vortices are energetically unfavorable in 2d bose gases @xcite so we need only concern ourselves with detecting vortices with winding number @xmath225 in this work .",
    "the positions obtained from a given run of our vortex detection algorithm are the labeled @xmath226 and @xmath164 for winding numbers @xmath227 and @xmath228 , respectively .",
    "one of the important characteristics of the bkt transition is the presence of superfluidity , even in the absence of conventional long range order . in the following",
    "we describe a method to calculate the superfluid fraction from our classical field description .",
    "the method is attractive because it makes use of momentum correlations which may be extracted directly from our equilibrium simulations without any need to introduce additional boundary conditions or moving defects .",
    "our derivation is based on the procedure presented in @xcite , ( see also @xcite and @xcite ) .",
    "the central idea is to establish a relationship between i ) the autocorrelations of the momentum density in the simulated ensemble and ii ) the linear response of the fluid to slowly moving boundaries ; ( i ) is a quantity we can calculate , while ( ii ) is related to the basic properties of a superfluid via a simple thought experiment .    to connect the macroscopic , phenomenological description of superfluidity with our microscopic theory , we make use of the thought experiment shown schematically in fig .  [ fig : superfluid_thought_expt](b ) : consider an infinitely long box , @xmath208 containing superfluid , and accelerate the box along its long axis until it reaches a small velocity @xmath229 .",
    "due to viscous interactions with the walls , such a box filled with a normal fluid should have a momentum density at equilibrium of @xmath230 .",
    "the notation @xmath231 denotes an expectation value in the ensemble with walls moving with velocity @xmath229 .    because superfluids are nonviscous , the observed value for the momentum density in a superfluid is less than the value @xmath232 expected for a classical fluid . in landau s two - fluid model",
    "we attribute the observed momentum density , @xmath233 , to the `` normal fraction '' where @xmath234 is the normal fluid density .",
    "the superfluid fraction remains stationary in the lab frame , even at equilibrium and makes up the remaining mass with density @xmath235 .    in order to apply the usual procedures of statistical mechanics to the thought experiment",
    ", we consider two frames : the `` lab frame '' in which the walls move with velocity @xmath229 in the @xmath80-direction and the `` wall frame '' in which the walls are at rest .    [ ] [ ] @xmath229 [ ] [ ] @xmath236 [ ] [ ] @xmath237 [ ] [ ] superfluid [ ] [ ] @xmath238 [ ] [ ] @xmath123 [ ] [ ] a ) [ ] [ ] b ) [ ] [ ] c ) [ ] [ ] d )   thought experiment used in deriving the superfluid density .",
    "the walls move with velocity @xmath229 in the @xmath80 direction . to begin with",
    ", we imagine that the superfluid sits in a box of dimensions @xmath239 as shown in a ) .",
    "we later take the limit as the box walls recede to infinity to get the thermodynamic limit d ) .",
    "the order of the limits is critically important : the path b ) leads to superflow while the path c ) results in the entire fluid moving along with the walls .",
    ", title=\"fig:\",width=302 ]    assuming that the fluid is in thermal equilibrium with the walls , the density matrix in the grand canonical ensemble is given by the usual expression @xmath240 where @xmath241 is the hamiltonian of the system in the wall frame and @xmath242 .",
    "a galilean transformation relates @xmath241 to the hamiltonian in the lab frame , @xmath243 , where @xmath244 is the total momentum , @xmath245 is the total mass and @xmath246 is the momentum density operator at point @xmath70 .",
    "the expectation value for the momentum density in the presence of moving walls is then given by the expression @xmath247 , \\\\    & = \\frac{\\operatorname{tr}{\\big ( e^{-\\beta(h - \\hat{{{\\mathbf{}}}{p}}\\cdot { { \\mathbf{}}}{u } + ( m u^2 / 2 - \\mu ) n)}{\\hat{{{\\mathbf{}}}{p}}}({{\\mathbf{}}}{x } ) \\big ) } }    { \\operatorname{tr}{\\big ( e^{-\\beta(h - \\hat{{{\\mathbf{}}}{p}}\\cdot { { \\mathbf{}}}{u } + ( m u^2 / 2 - \\mu ) n } \\big)}}.\\end{aligned}\\ ] ] expanding this expression to first order in @xmath229 yields @xmath248 where all the expectation values on the right hand side are now taken in the _ equilibrium _ ensemble with the walls at rest . since @xmath249 in our equilibrium ensemble , this simplifies to @xmath250 where @xmath251 is a dyad [ i.e. , a rank - two tensor ; the outer product of @xmath246 and @xmath252 .    to make further progress , we wish to take the limit as the system gets very large ( write `` @xmath253 '' ) . to this end",
    ", we first consider some properties of the correlation functions in the infinite system .",
    "the infinite system is homogeneous , which implies that @xmath254 for any @xmath255 , where @xmath256 indicates an average in the infinite system .",
    "as a consequence , we may express the correlations  in the infinite system  in terms of the fourier transform in the relative coordinate @xmath257 : @xmath258 where all the important features of the correlations are now captured by the tensor @xmath259 because of the isotropy of the fluid in the infinite system , @xmath260 obeys the transformation law @xmath261 for any @xmath262 orthogonal matrix @xmath263 .",
    "this implies that @xmath264 may be decomposed into the sum of longitudinal and transverse parts : @xmath265 where @xmath266 , @xmath267 and @xmath268 is the identity .",
    "the transverse and longitudinal functions @xmath269 and @xmath270 are scalars which depend only on the length @xmath211 .",
    "we now return our attention to the finite system .",
    "if the finite box @xmath208 is large then the momentum correlations in the bulk will be very similar to the values for the infinite system .",
    "therefore , when @xmath70 and @xmath271 are far from the boundaries , we may approximate @xmath272 which in combination with eq .   yields @xmath273 here we have defined the nascent delta function @xmath274 which has the property @xmath275 as @xmath253 .",
    "we are now in a position to carry out the limiting procedure to increase the box size to infinity .",
    "however , care must be taken because the simple expression @xmath276 is not well defined without further qualification of the limiting process @xmath277 .    to resolve this subtlety",
    "we must insert a final vital piece of physical reasoning .",
    "let us assume for simplicity that @xmath229 is directed along the @xmath80-direction , and the box @xmath208 is aligned with the @xmath80 and @xmath81 axes with dimensions @xmath278 . as shown in fig .",
    "[ fig : superfluid_thought_expt ] , there are two possibilities for taking the limits , representing different physical situations .    on the one hand [ fig .",
    "[ fig : superfluid_thought_expt](b ) ] , we may take the limit @xmath279 first , which gives us an infinitely long channel in which superfluid can remain stationary while only the normal fraction moves with the walls in the @xmath80-direction .",
    "we have @xmath280 where we use the fact that @xmath281 can be decomposed into the product @xmath282 with @xmath283 as @xmath14 . employing the decomposition of @xmath264 given in eq .",
    "allows the density of the normal fraction to be related to the transverse component of @xmath264 evaluated at zero : @xmath284    on the other hand [ fig .",
    "[ fig : superfluid_thought_expt](c ) ] we may take the limit @xmath285 first , resulting in an infinitely long channel  with velocity _ perpendicular _ to the walls  in which the entire body of the fluid must move regardless of the superfluidity . in a similar way to the previous paragraph , @xmath286 , and making use of the decomposition in eq .",
    ", the total density is related to the longitudinal component of the correlations : @xmath287    with these expressions , the normal fraction @xmath288 may finally be expressed directly as @xmath289 while the superfluid fraction is @xmath290 .",
    "thus , we have expressed the superfluid and normal fractions in terms of a correlation function which can be directly computed from our simulation results .      to determine the superfluid fraction for our system",
    ", we need to estimate the tensor of momentum density correlations @xmath264 from the simulation results . for our finite system constrained to a periodic simulation box , we may compute the momentum correlations only at discrete grid points . the discrete analogue of eq .",
    "leads to the expression @xmath291 where the constant of proportionality is not important to the final result , and @xmath292 are the discrete fourier coefficients of @xmath293 over our simulation box .",
    "the momentum density operator is given by @xmath294}\\ ] ] which may be derived by considering the continuity equation for the number density , @xmath295 .",
    "for a given classical field eq .  , the fourier coefficients of @xmath296 may be written as @xmath297 where @xmath298 is the area of the system .",
    "computing a value for all @xmath299 at each time step , we then evaluate @xmath260 via the usual ergodic averaging procedure using eq .  .",
    "having evaluated @xmath260 , we are left with performing the decomposition into longitudinal and transverse parts . for this , simply note that eq .",
    "implies @xmath300 , and @xmath301 , where @xmath302 is a unit vector perpendicular to @xmath303 .",
    "values for @xmath269 and @xmath270 may be collected for all angles as a function of @xmath211 , and a fitting procedure used to perform the extrapolation @xmath304 ; this procedure is illustrated in fig .",
    "[ fig : sfl_lims_eg ] . at low temperatures ,",
    "the extrapolation is quite reliable , but becomes more difficult near the transition where sampling noise increases and @xmath305 changes rapidly near @xmath306 . without a known functional form , we settled for a quadratic weighted least squares fit of @xmath307 and @xmath308 versus @xmath211 .",
    "a weighting of @xmath309 was used to counteract the fact that the density of samples of @xmath264 vs @xmath211 scales proportionally with @xmath211 due to the square grid on which @xmath260 is evaluated .",
    "the logarithm was used to improve the fits of @xmath269 very near the transition where it varies non - quadratically near @xmath306 . the fitting procedure and extrapolation to",
    "@xmath306 generally produces reasonable results , but is somewhat sensitive to numerical noise . for this reason ,",
    "the computed superfluid fraction at high temperatures is not exactly zero ( see fig .  [",
    "fig : fc_fs_vs_t ] ) .",
    "( color online ) .",
    "example fitting and extrapolation to @xmath306 for the transverse and longitudinal components of the momentum density autocorrelation tensor , @xmath264 .",
    "the apparent functional form for @xmath269 and @xmath270 changes with temperature  particularly near the transition  which along with the sampling noise makes them difficult to fit reliably .",
    "the data shown corresponds to a temperature slightly below the transition .",
    ", width=302 ]"
  ],
  "abstract_text": [
    "<S> recent experiments on ultracold bose gases in two dimensions have provided evidence for the existence of the berezinskii - kosterlitz - thouless ( bkt ) phase via analysis of the interference between two independent systems . in this work </S>",
    "<S> we study the two - dimensional quantum degenerate bose gas at finite temperature using the projected gross - pitaevskii equation classical field method . </S>",
    "<S> while this describes the highly occupied modes of the gas below a momentum cutoff , we have developed a method to incorporate the higher momentum states in our model . </S>",
    "<S> we concentrate on finite - sized homogeneous systems in order to simplify the analysis of the vortex pairing . </S>",
    "<S> we determine the dependence of the condensate fraction on temperature and compare this to the calculated superfluid fraction . by measuring the first order correlation function </S>",
    "<S> we determine the boundary of the bose - einstein condensate and bkt phases , and find it is consistent with the superfluid fraction decreasing to zero . </S>",
    "<S> we reveal the characteristic unbinding of vortex pairs above the bkt transition via a coarse - graining procedure . </S>",
    "<S> finally , we model the procedure used in experiments to infer system correlations [ hadzibabic et al . , </S>",
    "<S> nature * 441 * , 1118 ( 2006 ) ] , and quantify its level of agreement with directly calculated _ in situ _ correlation functions . </S>"
  ]
}