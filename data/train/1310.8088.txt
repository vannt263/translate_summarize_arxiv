{
  "article_text": [
    "_ mancala _ is a family of traditional african games played in many versions and under many names .",
    "it comprises a circular list of _ holes _ containing zero or more _ seeds_. a move consists of selecting a nonempty hole , taking all its seeds and _ sowing _ them in the subsequent holes , one seed per hole .",
    "here we study an idealized version of this called _ open mancala _ ( see @xcite , where the game is called _ open owari _ ) .",
    "we assume there is an infinite sequence of holes .",
    "further we assume that the nonempty holes are consecutive ; such a configuration is described by a sequence of positive integers @xmath0 , @xmath1 , giving the number of seeds in each nonempty hole , starting from the leftmost one .",
    "we assume a move always selects the leftmost nonempty hole , sowing to the right .",
    "thus the leftmost nonempty hole always advances of one position .",
    "it is clear that the sequence of configurations becomes periodic in a finite time .",
    "the periodic configurations have been completely classified ( @xcite ) : see section [ sec : notations ] .",
    "this game is related to a card game called _ bulgarian solitaire _ , discussed by gardner @xcite in a 1983 _ scientific american _ column .",
    "indeed , that game is isomorphic to the case of open mancala where @xmath2 for @xmath3 ( monotone mancala ) , see section [ sec : bulgarian ] .",
    "gardner mentioned a conjecture on the maximum number of moves before the onset of periodicity when the number of cards is of the form @xmath4 .",
    "the conjecture was proved independently a few years later by igusa @xcite and etienne @xcite . in 1998 ,",
    "griggs & ho @xcite revisited the result and proposed a new conjecture in the case of a generic number of cards . due to the isomorphism between monotone mancala and bulgarian solitaire , our result is strongly related to this conjecture .",
    "however , our results apply to open mancala , not to the monotone variant , hence the conjecture about the bulgarian solitaire remains unproven .",
    "the main result of the paper is the optimal bound for the maximum number of moves , before open mancala reaches periodicity , as a function of @xmath5 , the number of seeds . in section",
    "[ sec : lower ] we prove the lower bound by producing , for any @xmath5 , a configuration that requires exactly that number of moves . in section [ sec : smon ] we introduce the main tool in proving the upper bound , namely _",
    "@xmath6-monotonicity_. in section [ sec : upper ] we prove that every configuration reaches periodicity within that number of moves .",
    "we denote by @xmath7 the set of nonnegative integers and by @xmath8 the set of strictly positive integers . by @xmath9 , @xmath10 ,",
    "we denote the @xmath11-th triangular number @xmath12 where in particular @xmath13 .    a _ configuration _",
    "@xmath14 is a sequence of nonnegative numbers @xmath0 , @xmath15 , that is @xmath16 .",
    "the _ support _ @xmath17 of a configuration @xmath14 is the set of indices @xmath18 .    a _ mancala configuration _",
    "@xmath14 is a configuration having a _ connected _ support of the form @xmath19 for some @xmath20 .",
    "the index @xmath21 is called the _ length _ of the configuration . in the special case of the _ zero _ configuration , we shall conventionally define its length to be zero .",
    "we shall denote by @xmath22 the set of all mancala configurations .    if @xmath23 , its _ mass _ is the number @xmath24 we denote by @xmath25 the set of all mancala configurations of mass @xmath5 .",
    "the _ mancala _ game , in our setting , is a discrete dynamical system associated with a function @xmath26 mapping the space of _ mancala _ configurations @xmath22 in itself .",
    "[ def : move ] the _ sowing _ of a mancala configuration @xmath14 is an operation on @xmath14 that results in a new configuration @xmath27 defined as follows : @xmath28 conventionally , @xmath29 maps the empty configuration into itself .",
    "it is clear that @xmath29 preserves the mass of a configuration , so that it can be restricted to @xmath25 .",
    "it is convenient to define the ( right ) _ shift _ operator @xmath30 , that acts on generic sequences simply by a change in the indices .    [ def : shift ] if @xmath31 is a sequence , the sequence @xmath32 is defined by @xmath33    clearly , the result of the shift operator is never a mancala configuration ( with the exception of the empty configuration ) .",
    "both @xmath29 and @xmath30 can be iterated , the symbol @xmath34 ( resp .",
    "@xmath35 ) denoting the result of @xmath11 repeated applications of @xmath29 ( resp .  of @xmath30 ) .",
    "the shift operator has a left inverse @xmath36 , defined by @xmath37 and satisfying @xmath38 for any configuration @xmath14 .",
    "we say that @xmath39 if @xmath40 for all @xmath41 .",
    "moreover we say that @xmath42 if @xmath43 and @xmath44 .",
    "if @xmath14 , @xmath45 are two integer sequences ( in particular if any of them is a configuration in @xmath22 ) , we define the sum and difference @xmath46 componentwise : @xmath47 .",
    "it is easy to check that if @xmath14 , @xmath48 and @xmath39 , then @xmath49 .",
    "[ defn : monotone ] a configuration is called _ monotone _ if it is weakly decreasing , i.e. if @xmath2 whenever @xmath3 .",
    "if @xmath14 is a monotone configuration , then so it is @xmath50 .",
    "moreover , if @xmath23 has length @xmath51 , then @xmath52 is monotone .",
    "the following special configurations play an important role .",
    "[ def : mg ] for a given @xmath10 we define the special mancala configuration @xmath53 with mass @xmath9 and length @xmath11 , called _ _ marching group _ _ of order @xmath11 , as follows : @xmath54    [ def : amg ] a mancala configuration @xmath14 such that @xmath55 for some @xmath10 is called an _ augmented marching group _ of order @xmath11 .",
    "it satisfies @xmath56 .",
    "notice that a marching group is a particular case of an augmented marching group .",
    "the following important theorem about augmented marching groups is readily proved .",
    "see ( * ? ? ?",
    "* theorems 1 and 2 ) .",
    "[ teo : periodic ] augmented marching groups are the _ only _ periodic configurations for @xmath29 and , if @xmath57 , then the period of @xmath14 is a divisor of @xmath58 .",
    "marching groups are the _ only _ fixed points for @xmath29 .",
    "a remarkable fact about open mancala is that every configuration becomes an augmented marching group , and hence periodic , after a finite number of moves .",
    "the paper is devoted to find an optimal bound on such a number of moves which depends only on the mass of the initial configuration .",
    "[ def : depthdiameter ] the _ depth _ of a configuration @xmath14 is its distance from the periodic configuration , _ i.e. _ the number of moves needed to reach periodicity . for @xmath59",
    "we call the _ depth of @xmath25 _ , denoted by @xmath60 , the maximal depth of all configurations @xmath14 with @xmath61 .",
    "the _ diameter _ of a configuration is the number of moves before the first repetition .",
    "it is equal to its depth plus the length of the period minus one .",
    "the maximal diameter of all configurations of mass @xmath5 is called the _ diameter of @xmath25_.    clearly if @xmath62 the diameter of @xmath25 equals its depth @xmath60 , whereas if @xmath63 , @xmath64 the diameter of @xmath25 is bounded above by @xmath65 .",
    ", more precisely a lower bound is given by @xmath66 where @xmath67 is the smallest divisor of @xmath58 larger than @xmath68 . ]",
    "the number @xmath60 can be seen also as the depth of a graph .",
    "indeed , for a given @xmath69 we can construct the directed graph @xmath70 having the configurations in @xmath25 as nodes and an arc from @xmath14 to @xmath71 whenever @xmath72 .",
    "the graph @xmath70 contains exactly @xmath73 nodes .",
    "cycle _ of @xmath70 correspond to sequences of moves that repeat periodically .",
    "a configuration is periodic if it belongs to a cycle .    in the case",
    "@xmath74 , if we remove all arcs connecting two periodic configurations ( arcs that belong to a cycle ) , the remaining graph @xmath75 is a disjoint union of trees rooted at a periodic configuration , and in each tree all arcs point toward the root . in this",
    "setting , @xmath60 represents the depth of @xmath70 , _",
    "i.e. _ the maximal depth of the trees of @xmath75 .",
    "we can view the mancala configurations and mancala moves in a way reminiscent of the energy levels for the electrons in an atom .",
    "let us consider the subset @xmath76 given by @xmath77 it is convenient to think of the integers @xmath78 and @xmath79 as a numbering of square cells instead of coordinates of points , in a way similar to the familiar sea - battle game .",
    "each square cell in @xmath80 can either be empty or contain a single seed .",
    "the _ column _ index @xmath78 corresponds to one of the holes in the mancala game , so that @xmath0 , where @xmath81 , is the total number of occupied cells in column @xmath78 of @xmath80 .",
    "we shall also associate an _ energy _ to a seed positioned in cell @xmath82 , given by its second coordinate @xmath79 .",
    "the @xmath11-th level of @xmath80 is the set @xmath83 of cells having energy @xmath11 .",
    "finally we let the seeds free to immediately _ fall _ down without changing their column , but decreasing their energy ( the second coordinate of their current position ) provided the new position ( and all those in between ) are free .",
    "the mancala configuration @xmath23 then corresponds to a positioning of seeds in @xmath80 such that @xmath82 is occupied by a seed if and only if @xmath84 ( see figure [ fig : energyexample ] ) .",
    "( 0,0 ) ; in 0, ... ,4 ( 0,0 )  ( 1,0 ) ",
    "( 1,1 ) ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; in 0, ... ,2 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0,0 )  ( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath85 ;    ( 0,5 )  ( 0,0 ) ; in 0, ... ,4 ( 0,0 ) ",
    "( 1,1 ) ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0,0 )  ( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath86 ;    ( 0,5 )  ( 0,0 ) ; in 0, ... ,4 ( 0,0 )  ( 1,0 )  ( 1,1 ) ; ( 0,0 )  ( 0,0 ) node[right , xshift=0cm , yshift=-0.4cm]@xmath87-th level ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; in 0, ... ,2 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0,0 )  ( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath88 ;    ( 0,5 )  ( 0,0 ) ; in 0, ... ,4 ( 0,0 )  ( 1,0 )  ( 1,1 ) ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; in 0, ... ,2 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0,0 ) ",
    "( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath89 ;    ( 0,5 ) ",
    "( 0,0 ) ; in 0, ... ,4 ( 0,0 )  ( 1,0 ) ",
    "( 1,1 ) ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0,0 ) ",
    "( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath90 ;    ( 0,5 ) ",
    "( 0,0 ) ; in 0, ... ,4 ( 0,0 )  ( 1,0 ) ",
    "( 1,1 ) ; ( 0,0 ) ",
    "( 0,0 ) node[right , xshift=0cm , yshift=-0.4cm]@xmath87-th level ; in 0, ... ,2 in 0 , ... , ( 0.5,0.5 ) circle ( 0.4 ) ; in 0, ... ,2 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 3.5,4.5 )  ( 3.5,3.5 ) ; ( 0,0 )  ( 0,0 ) node[right , xshift=2cm , yshift=0.25cm]@xmath91 ;    a _ mancala move _ can now be viewed in this setting as follows .",
    "firstly , each seed is moved one position to the left without changing its energy level , while seeds in column @xmath68 are _ rotated _ to the last column of that energy level .",
    "namely , a seed at position @xmath82 is moved in the new position @xmath92 if @xmath93 , @xmath94 if @xmath95 .",
    "this is just a left rotation of the seeds of each level , so that cells will receive at most one seed .",
    "secondly we let gravity pack all the seeds in each column at the lowest energy possible .",
    "we notice that if all energy levels up to @xmath11 are completely filled , then a mancala move does not change those levels ( up to a rearrangement of the seeds ) , and all the action takes place from the lowest level that is not completely filled , say @xmath58 , up to the highest level that is not completely empty .",
    "lowest active level _ is the lowest level that is not completely filled .",
    "the overall energy of a configuration ( the sum of the individual energy of every seed ) does not change after the first part of the move ( the rotation within each energy level ) whereas it can decrease during the second part ( vertical downward shift ) .",
    "[ def : gap ] we shall call _ gap _ an empty cell at the lowest energy level , say @xmath11 , that is not completely filled",
    ". we shall think of a gap as an _ absent seed _ , and in this respect we can _ follow _ a gap through mancala moves as it rotates left along its energy level .",
    "a gap can be filled when it receives a seed that falls from above after a move , and this can happen only when the gap is in column @xmath11 .",
    "the filling of a gap at the lowest energy level that is not completely filled is permanent , since there is no possibility of further energy decrease for seeds at that energy level .",
    "all gaps will be eventually filled , provided there are sufficiently many seeds at energy levels larger than @xmath11 .",
    "in order to prove a good lower bound @xmath96 for the depth @xmath60 we need to find appropriate configurations and to compute the number of moves required to reach a periodic configuration ( which is an augmented marching group ) .",
    "let @xmath63 with @xmath97 .",
    "@xmath98-biaugmented marching group _ is a mancala configuration @xmath99 of the form @xmath100 where @xmath53 is the marching group of order @xmath11 and @xmath101 is an increment of the form @xmath102 for some @xmath103 .",
    "the second ( resp .",
    "fourth ) row in the definition is void if @xmath104 ( resp . if @xmath105 ) .",
    "clearly such a configuration is not an augmented marching group .",
    "suitable choices of @xmath98 and @xmath106 ( compatible with the definition above ) allow to obtain all the values of @xmath107 such that @xmath108 .",
    "[ prop : biaugmented1 ] a @xmath98-biaugmented marching group has depth @xmath109 , _",
    "i.e. _  it becomes an augmented marching group exactly after @xmath109 moves .    if @xmath104 , a direct check shows that after two moves we obtain an augmented marching group .",
    "if @xmath110 , let us _ color _ the seedthe idea of",
    "the colored seed is due to bouchet  ( * ? ? ?",
    "* section 3 ) ] in the first hole which is at the energy level @xmath111 ( the highest energy level ) ; we agree that the colored seed is the last to be sown in the mancala move , so that it moves at the energy level @xmath111 until it falls on the level @xmath58 , when the configuration becomes an augmented marching group .",
    "notice that the lowest active level is @xmath58 .",
    "the colored seed is again at the leftmost position after exactly @xmath111 moves , while @xmath58 is the period of the seeds moving in the lowest active level .",
    "hence the first `` hole '' at level @xmath58 , which were in position @xmath112 at the beginning , gets one step closer to the colored seed every @xmath111 moves . at the end ,",
    "the configuration becomes a @xmath113-biaugmented marching group in @xmath114 moves , and in two further moves it becomes periodic .",
    "as an example , figure [ fig : energyexample ] shows the energy - level interpretation of a @xmath115-biaugmented marching group with @xmath116 and its evolution .",
    "the gray circle in the pictures is the colored seed of the proof .",
    "let @xmath117 with @xmath118 .",
    "@xmath98-biaugmented marching group of the second kind _ is a configuration @xmath99 of the form @xmath119 , where @xmath120 is the marching group of order @xmath121 and @xmath101 is an increment of the form @xmath122 for some @xmath123 .",
    "again , such a configuration is not an augmented marching group .",
    "the depth of a @xmath98-biaugmented marching group of the second kind is given by @xmath124 , _",
    "i.e. _  it becomes an augmented marching group precisely after @xmath125 moves .",
    "let us color red the seeds which are at the beginning in the energy level @xmath58 , and blue the ones in the energy level @xmath11 , which is the lowest active level .",
    "as in the proof of the previous proposition , we agree that the colored seeds are the last to be sown in every mancala move , the red seed ( if present ) being sown after the blue one . in that way , the blue seeds remain forever at the level @xmath11 , while one of the red seeds will eventually lose one energy level , when the configuration becomes an augmented marching group .",
    "we track the evolution of the colored seeds , which move in the two highest energy levels .",
    "the pattern of red seeds rotates with a period @xmath58 , while the pattern of blue seeds rotate with a period of @xmath11 ; hence the pattern of red seeds slowly slides one position to the right with respect to the pattern of blue seeds every @xmath11 moves , and the value of @xmath98 decreases by one .",
    "when @xmath104 , it is easy to see that after @xmath11 moves a red seed reaches the lower level .",
    "hence the initial configuration takes exactly @xmath125 moves in order to reach periodicity .",
    "we define the _ heaviside configuration _ @xmath126 by @xmath127    we shall also study the special configuration @xmath128 with a single seed in all holes @xmath15 : although @xmath128 is not in @xmath22 since it has unbounded support , the sowing @xmath29 is still well - defined .    [",
    "theorem : ones ] let @xmath129 and @xmath130 with @xmath131 .",
    "then the configuration after @xmath132 moves starting from @xmath128 is given by @xmath133    it is easy to check that exactly at every move @xmath134 the configuration becomes greater than the marching group @xmath135 , hence we have the result for @xmath136 . in particular , for any @xmath137 the leftmost element of the sequence at time @xmath138 is given by @xmath139 .",
    "hence in the subsequent move we have to add one seed in the holes with indices @xmath140 and then shift all piles of one position to the left ( dropping the leftmost ) .",
    "if @xmath141 we get @xmath142 and the result follows by induction . if @xmath143 , then @xmath144 and we have to add one seed to the piles with indices @xmath140 , which contain the values @xmath145 , to begin with .",
    "again the result follows immediately .",
    "[ rem : truncatedheaviside ] notice that at time @xmath146 , @xmath131 we moved at most @xmath11 seeds ( @xmath147 , so that we do not touch the piles at position @xmath148 , which came from @xmath149 shifts to the left .",
    "this means that proposition [ theorem : ones ] holds for a starting configuration @xmath150 with @xmath63 ( we denote it by ` 1^n ` ) until time @xmath149 , with truncation to zero for elements with index @xmath148 .",
    "moreover , the number of seeds in the leftmost pile ( index @xmath151 ) is exactly @xmath11 at times between @xmath152 and @xmath153 and is @xmath58 at time @xmath154 if @xmath155 .",
    "[ rem : truncatedheaviside2 ] in the special case @xmath156 ( @xmath157 ) we can exactly describe the resulting configuration at time @xmath158 .",
    "this is done by observing that the number of seeds in the first pile ( remark [ rem : truncatedheaviside ] ) is the same as for the full @xmath128 sequence up to time @xmath9 , meaning that the sowing process is exactly the same .",
    "we can thus recover the resulting sequence at time @xmath9 by subtracting from the missing seeds in their expected position ( @xmath159 ) obtaining @xmath160 or equivalently @xmath161 where @xmath162 is the sequence with one in position 1 and zero elsewhere .",
    "now we want to analyze the evolution of the augmented sequence obtained from @xmath150 by adding a seed at the position with index @xmath67 .",
    "we can write the sequence as @xmath163 where @xmath164 denotes the sequence with a @xmath68 at the position @xmath67 and zero elsewhere . the analysis can be conveniently done by using again bouchet s trick , see footnote  [ fn : bouchet ] . in this way",
    "the evolution of the augmented configuration coincides exactly with the evolution of the non - augmented configuration with the addition of the colored seed , to be positioned appropriately .    at each sowing the colored seed moves one position to the left ; when it reaches the leftmost pile ( index @xmath151 ) , at the next move its new position depends on how large the pile is .",
    "we however know precisely how the heaviside sequence evolves , so that we can explicitly predict the position of the colored seed at each time .",
    "we are particularly interested in the case where @xmath156 and @xmath165 with @xmath166 .",
    "[ teo : augmentedheaviside ] the _ colored _ seed in the evolution of the augmented heaviside sequence @xmath167 with @xmath156 and @xmath168 , @xmath166 is located at position @xmath169 at time @xmath158 .",
    "after @xmath170 moves the colored seed reaches the leftmost pile which , according to proposition [ theorem : ones ] , will contain also @xmath171 noncolored seeds .",
    "this is true even in the special case @xmath172 , where the colored seed is added at the rightmost nonempty pile of the sequence @xmath150 , see remark [ rem : truncatedheaviside ] .",
    "this covers the case @xmath172 .",
    "if @xmath173 , at time @xmath174 the colored seed will go into the hole with index @xmath175 and will be again into the leftmost pile at time @xmath176 . if @xmath177 we can again resort to proposition [ theorem : ones ] and conclude that the leftmost pile will contain the colored seed and @xmath175 noncolored seeds at that time .",
    "this argument can be repeated for @xmath98 cycles as long as @xmath178 with the leftmost pile containing @xmath179 noncolored seeds at time @xmath180 . by taking @xmath181 , the largest admissible value , we have the colored seed in the leftmost pile at time @xmath182 together with @xmath11 noncolored seed . at the next time",
    "@xmath183 the colored seed will be sown in position @xmath58 and will move left of one position in the next @xmath184 moves so that at time @xmath185 it will be in the hole at position @xmath186 , which concludes the proof .",
    "the method of coloring seeds can be also used with more than one seed , provided that we do not place two or more colored seeds in the same hole and as long as the colored seeds do not interact ( staying all in different piles ) . thanks to lemma [ teo : augmentedheaviside ]",
    "we indeed have noninteracting colored seeds for @xmath9 moves if we place them in positions with indices of the form @xmath174 for a set of values @xmath166 : if two of them would land in the same pile during the evolution , then the expected position given by lemma [ teo : augmentedheaviside ] would be the same , which is not the case .",
    "we can thus exactly predict their position at time @xmath158 , there will be a colored seed in position @xmath6 , if and only if there was a colored seed in position @xmath187 .",
    "if this is true for @xmath188 ( with the addition of @xmath189 colored seeds ) , recalling remark [ rem : truncatedheaviside2 ] we obtain a @xmath98-biaugmented marching group . by proposition  [ prop : biaugmented1 ] ,",
    "the biaugmented marching group will become periodic after exactly @xmath109 further moves .",
    "we want to construct , for a given @xmath63 , a configuration that takes as long as possible to become periodic . in view of the previous discussion to achieve this goal it is mostly convenient to place the colored @xmath107 seeds in the rightmost positions with index of the form @xmath174 .",
    "we call _ augmented heaviside sequence _ the configuration of mass @xmath63 , @xmath190 , and length @xmath191 , which is obtained from @xmath192 by adding a seed in the rightmost @xmath193 positions having index of the form @xmath174 ( in particular there will be no added seeds if @xmath194 ) .    as an example , the augmented heaviside sequence with mass @xmath195 is given by    1 1 1 1 1 1 2 1 1 1 2 1 1 1 1 2 .",
    "the preceding arguments give a proof of the following    [ teo : lower1 ] let @xmath63 with @xmath97 . then the corresponding augmented heaviside sequence becomes an @xmath196-biaugmented marching group after @xmath9 moves .",
    "in particular , its evolution becomes periodic after exactly @xmath197 moves with @xmath198    the choice @xmath199 is a limit case corresponding to @xmath200 , and we have @xmath201 .",
    "moreover if we write @xmath202 with @xmath203 , then @xmath204 and @xmath197 in can be equivalently written as @xmath205 .",
    "direct inspection allows to show that for @xmath206 the particular biaugmented marching group at which we arrive at time @xmath9 evolves into an augmented marching group having period of length exactly @xmath58 ( and not a proper divisor ) .",
    "hence the diameter of the evolution is @xmath207 .",
    "we now consider the augmented heaviside sequence corresponding to @xmath208 : it has length @xmath58 , contains an increment at all the positions of the form @xmath174 , @xmath166 and the total number @xmath5 of seeds is itself a triangular number . in the rightmost positions",
    ", this sequence has a @xmath115 followed by @xmath121 ones and a final @xmath115 .",
    "given @xmath209 , let us remove from this sequence the rightmost @xmath210 piles , obtaining a configuration with mass @xmath211 .",
    "equivalently , we can obtain the same configuration starting from the augmented heaviside sequence corresponding to @xmath212 and joining to the right a sequence of @xmath107 piles with one seed each .",
    "let us call _ truncated augmented heaviside sequence _ such a configuration .",
    "as an example , the truncated augmented heaviside sequence with mass @xmath213 is given by    1 2 1 2 1 1 2 1 1 1 2 1 1 .",
    "[ prop : truncated ] the truncated augmented heaviside sequence with @xmath63 , @xmath118 , becomes a @xmath214-biaugmented marching group of the second kind after @xmath215 moves .",
    "simply color the rightmost sequence of ones and track their position during the first @xmath215 moves of the augmented heaviside sequence of proposition [ teo : lower1 ] with @xmath121 in place of @xmath11 and @xmath143 .",
    "[ teo : lower2 ] a truncated augmented heaviside sequence with @xmath63 , @xmath118 , becomes periodic after exactly @xmath216 moves .    if @xmath217 or @xmath218 , the function @xmath219 is not defined by the previous corollary , and we shall conventionally set it to @xmath220 .    as for the augmented heaviside sequences of section [ sec :",
    "augheaviside ] , the special biaugmented marching group of the second kind at which we arrive if @xmath155 evolves to an augmented marching group with period exactly @xmath58 , and again we have a diameter given by @xmath221 .      in the special case @xmath222 , @xmath223 , we need a further type of configuration .    for @xmath222 , @xmath223 , we define the _ biaugmented heaviside sequence _ in the following way : take the truncated augmented heaviside sequence for @xmath224 , and then add a third seed in the pile with two seeds at position @xmath225 .    as an example",
    ", @xmath226 produces the sequence    1 2 1 2 1 1 2 1 1 1 2 1 1 1 1 3 1 1 .",
    "[ teo : lower3 ] the biaugmented heaviside sequence with @xmath227 becomes periodic after exactly @xmath228 moves .",
    "let us color the extra added third seed in the pile at position @xmath225 . by construction , without the colored seed the biaugmented heaviside sequence becomes a truncated augmented heaviside sequence with mass @xmath229 , hence by proposition  [ prop : truncated ] , after @xmath230 moves we have an @xmath231-biaugmented marching group of the second kind with an extra seed ( corresponding to an increment of @xmath232 with respect to the marching group ) in the leftmost pile .",
    "the argument we used to study the biaugmented marching groups can be adapted to the present case , proving that the periodic configuration is reached exactly after the same number of moves as for the biaugmented marching group of the second kind : @xmath125 with @xmath233 and @xmath234 .",
    "hence the initial configuration becomes periodic after @xmath235    also in this case a direct inspection of the resulting augmented marching group allows to show that its period is exactly @xmath58 , and again the diameter of the special plateau sequence is @xmath236 .",
    "the lower bound @xmath237 is only defined for special values of @xmath5 , of the form @xmath238 , and we conventionally set it to @xmath220 in all the other cases .",
    "we can now gather the three lower bounds and define @xmath239 so that the previous results can be summarized as the following :    @xmath240    simply gather the results obtained in propositions [ teo : lower1 ] , [ teo : lower3 ] and corollary [ teo : lower2 ] .",
    "a plot of the function @xmath96 for @xmath241 can be seen in figure  [ fig : ldepth ] .     for @xmath241 .",
    "we have @xmath242 . ]",
    "there is an explicit way to express the lower bound @xmath96 . indeed , writing @xmath243 in the form @xmath244 with @xmath245 and @xmath246 , one can prove that @xmath247 notice that the middle case occurs only when @xmath11 is even .",
    "in this section we introduce one of the main notions of the paper , namely _ @xmath6-monotonicity_. firstly we define a sequence which is strictly related to the energy levels interpretation of the mancala game .    [ def : energyseq ] given a mancala configuration @xmath23 we define the _ energy sequence _ @xmath248 as follows : setting @xmath249 , we define @xmath250 and extend it on @xmath251 as a periodic function of period @xmath252 .",
    "notice that if @xmath253 we actually use values of @xmath14 outside its support , so that we have @xmath254 for @xmath255 .",
    "we have that @xmath256 if and only if @xmath257 for all @xmath258 .",
    "[ def : smon ] given @xmath259 and @xmath23 , we say that @xmath14 is _",
    "@xmath6-monotone _ if :    * @xmath260 , and * its energy sequence @xmath261 satisfies the inequality @xmath262    ( notice that the first requirement @xmath260 is redundant if @xmath263 ) .",
    "it is convenient to introduce also the ( void ) notion of @xmath113-monotonicity , satisfied by all mancala configurations .",
    "[ def : increasingplateau ] let @xmath264 .",
    "an _ increasing plateau of length @xmath6 _ is a subset of @xmath265 consecutive values @xmath266 of an energy sequence such that @xmath267    it is readily proved that a configuration is @xmath6-monotone if and only if each increasing plateau has length at least @xmath6 .",
    "let us give a few examples of @xmath6-monotone configurations :    * 1 2is @xmath113-monotone but not @xmath68-monotone * 1 1 1is @xmath68-monotone but not @xmath115-monotone * 4 1 1andare @xmath115-monotone but not @xmath268-monotone * 5 2 2 1andare @xmath268-monotone but not @xmath87-monotone * 6 3 3 2 1andare @xmath87-monotone but not @xmath269-monotone .",
    "if a mancala configuration is @xmath270-monotone , then it is also @xmath271-monotone for any @xmath272 .",
    "moreover , a configuration is an augmented marching group if and only if it is @xmath6-monotone for all @xmath273 .",
    "[ rem : weakstrong ] the notions of monotonicity , in the sense of definition  [ defn : monotone ] , and of @xmath68-monotonicity , in the sense of the previous definition , are slightly different . for instance , the sequence 4 2 is monotone but not @xmath68-monotone .",
    "however , if a configuration @xmath14 is monotone , then @xmath50 is @xmath68-monotone .",
    "hence , in view also of next theorem , during the evolution of a configuration there is at most one time when it is monotone but not @xmath68-monotone .    in passing , we observe that any @xmath68-monotone sequence has a predecessor that is merely monotone , _",
    "i.e. _  a @xmath68-monotone configuration can be obtained by applying a move to some monotone configurations .",
    "hence the maximal depth / diameter in the family of monotone configurations is exactly one plus the maximal depth / diameter in the family of @xmath68-monotone configurations .",
    "the following theorem shows that the class of @xmath6-monotone configurations is closed under mancala moves .",
    "[ teo : smonclosed ] if @xmath14 is @xmath6-monotone , then @xmath50 is @xmath6-monotone .",
    "let us set @xmath274 , @xmath275 , @xmath261 and @xmath276 .",
    "clearly any mancala configuration is at least @xmath113-monotone , hence the set of @xmath113-monotone configurations is closed under mancala moves .",
    "a direct check shows that the property @xmath260 is preserved under a mancala move whenever @xmath14 is a monotone configuration , indeed we have @xmath277 , whence @xmath278 .",
    "consequently the set of @xmath68-monotone configurations is closed under mancala moves .",
    "now assume that @xmath279 , hence we have to check only the values of the energy sequence .",
    "we divide the proof in five cases .    * case @xmath280 .",
    "* we have @xmath281 and the new period is @xmath282 . since @xmath279 , then @xmath14 is monotone and @xmath283 , hence we have @xmath284 and the new energy sequence @xmath285 is obtained by a left - shift of @xmath286 possibly followed by the insertion of a new value . indeed @xmath287 for @xmath288 and @xmath289 , since @xmath290 . if @xmath291 , then @xmath292 and the new energy sequence @xmath285 is exactly a left - shift of @xmath286 , so that @xmath71 is itself @xmath6-monotone . if @xmath293 , then @xmath294 and the new value to be inserted is @xmath295 ( being @xmath296 ) and it is equal to the previous value @xmath297 .",
    "since inserting a value in the sequence can not destroy the @xmath6-monotonicity property if it is equal to the previous ( or the next ) value , we can conclude that @xmath71 is @xmath6-monotone .",
    "* case @xmath298 .",
    "* we have @xmath299 and @xmath300 .",
    "since @xmath283 we have @xmath301 , so that @xmath302 and @xmath303 .",
    "moreover , @xmath304 implies that @xmath305 , so that @xmath306 .",
    "using the inequalities above we conclude @xmath307 the energy sequence @xmath285 is obtained from the energy sequence @xmath286 with the following operations :    1 .",
    "translate the values of @xmath286 to the left of one position @xmath308 .",
    "this has no impact on the @xmath6-monotonicity ; 2 .",
    "decrease by one the values with indices in the range @xmath309 ; 3 .",
    "remove the value at index @xmath252 and extend to @xmath251 with period @xmath310 .",
    "the last two operations can only impact @xmath6-monotonicity in the case of indices @xmath311 with @xmath312 ( up to addition of multiples of @xmath310 ) . however using we have @xmath313 .",
    "* case @xmath314 . *",
    "the argument is similar to the previous , but now becomes @xmath315 moreover the set of indices ( within the period @xmath316 ) where we decrease the energy by one ( step 2 above ) reduces to @xmath317 and is further reduced to the single index @xmath318 after removal of the energy value with index @xmath252 ( step 3 above ) .",
    "now suppose by contradiction that @xmath319 with @xmath311 , @xmath312 .",
    "this is only possible if both @xmath320 and @xmath321 .",
    "the latter equation implies @xmath322 and , in view of the discussion above , it can be rewritten as @xmath323 which contradicts the @xmath6-monotonicity of @xmath14 .",
    "* case @xmath324 and @xmath291 .",
    "* it turns out that @xmath325 .",
    "moreover @xmath326 whereas @xmath327 , so that @xmath328 .",
    "the resulting energy @xmath285 can be obtained by a left shift of @xmath286 followed by removal of element at index @xmath252 , which is the same as first removing the element at index @xmath68 of @xmath286 and then performing a left shift . the fact that @xmath329 allows to ensure that the removal of the value @xmath330 does not impact the @xmath6-monotonicity , which is then unaffected by the final left shift .    * case @xmath324 and @xmath293 .",
    "* it turns out that in this case @xmath331 and that the energy sequence of @xmath71 is just a left - shift of the energy sequence of @xmath14 : @xmath332 .",
    "these five cases cover all possible situations so that we conclude the proof .    for particular configurations it is possible to prove that repeated mancala moves actually increase the order of monotonicity .",
    "the following is our first important result for which the distinction between monotonicity and @xmath68-monotonicity is crucial .",
    "for instance , the result is false for the sequence ` 4 2 ` , which is monotone but not @xmath68-monotone .",
    "[ teo : incrmon ] let @xmath23 , @xmath273 and @xmath333 such that    1 .",
    "@xmath14 is @xmath6-monotone ; 2 .",
    "@xmath334 ; 3 .",
    "@xmath335 , ( i.e. @xmath336 ) .    then @xmath337 ( the configuration after @xmath98 moves ) is @xmath338-monotone .",
    "denote by @xmath71 the configuration obtained after @xmath98 moves . since we apply a number of moves that is larger than the length of the sequence",
    ", it follows that @xmath71 is at least @xmath68-monotone ( it is already monotone after @xmath339 moves , hence @xmath68-monotone after @xmath340 moves by remark [ rem : weakstrong ] ) .",
    "this covers the case @xmath341 , and we can suppose @xmath259 .",
    "in particular we can assume that @xmath342 where the first inequality follows from requirement ( ii ) and the second inequality comes from ( iii ) and constraint ( i ) of definition [ def : smon ] .",
    "using the energy level interpretation of the game , we want to track the position after @xmath98 moves of the seeds with energy larger than @xmath98 . first observe that requirement ( ii ) implies that all energy levels up to the @xmath343-th are completely filled and that seeds at level @xmath98 ( which is not completely filled ) are subjected to @xmath98 rotations to the left and end up at the same initial position .",
    "a seed in column @xmath78 ( notice that requirement ( iii ) implies that @xmath344 ) at level @xmath345 is also rotated @xmath98 times to the left , however the @xmath346-th energy level has length @xmath347 , so that it will end up in column @xmath348 and can possibly decrease its energy ( that is , its height ) once or more than once . requirements ( i ) and ( iii ) imply that there is no seed at height @xmath349 in the first @xmath6 columns , whereas seeds in column @xmath350 and height at least @xmath349 get moved to the right after the set of @xmath98 moves .",
    "this allows to conclude that @xmath351 for all @xmath311 , @xmath352 , where @xmath276 is the energy sequence of @xmath71 given by definition [ def : energyseq ] .",
    "if there were no energy decrease , then all increasing plateaus would increase their length by @xmath68 and the @xmath338-monotonicity would follow . the decrease in energy after each move involves all seeds in the final columns and it can be easily checked that it maintains the @xmath338-monotonicity .",
    "[ def : qcanonical ] let @xmath333 , @xmath353 and @xmath99 .",
    "we say that @xmath14 is @xmath98-canonical if    1 .",
    "@xmath334 ; 2 .",
    "@xmath335 , in particular @xmath14 * is not * @xmath354 ; is the lowest that is not completely filled . ]",
    "the gap ( see definition [ def : gap ] ) in the rightmost position ( column @xmath98 ) in the energy level at height @xmath98 is the last to be filled after repeated moves .",
    "notice that requirement @xmath355 implies that the @xmath98-th energy level will eventually fill up completely .    due to the central importance of @xmath98-canonical configurations a few remarks",
    "are in order .",
    "the value @xmath98 of a @xmath98-canonical configuration is necessarily the height of the lowest active energy level ( the lowest level that is not completely filled ) .",
    "this follows from requirements ( 1 ) and ( 2 ) of the above definition .",
    "hence a configuration can not be @xmath98-canonical with two different values of @xmath98 .    in view of the comments following definition [ def : gap ] , in particular the fact that _ filling a gap _ is permanent",
    ", we can indeed define a _ filling order _ on the gaps at level @xmath98 .",
    "all the gaps ( at level @xmath98 ) will be eventually filled due to requirement @xmath355 , and we can identify the gap that will be filled last .",
    "an augmented marching group can not be @xmath98-canonical , since if @xmath99 is an augmented marching group with @xmath355 then @xmath356 .",
    "this is incompatible with requirement ( 2 ) of definition [ def : qcanonical ] .",
    "[ rem : sameq ] since the gap in the rightmost position of a @xmath98-canonical configuration @xmath14 returns in the same position after every sequence of exactly @xmath98 moves , it follows that the @xmath98-th energy level fills up after exactly @xmath357 moves , for some @xmath358 .",
    "in particular @xmath359 .",
    "moreover @xmath360 is itself a @xmath98-canonical configuration for all @xmath361 and there are no other @xmath98-canonical configurations in between .    as an example , let us consider the configuration @xmath362 , it satisfies requirements ( 1 ) and ( 2 ) of definition [ def : qcanonical ] with @xmath363 ( see figure [ fig : ex55362 ] for an energy - level interpretation ) , it has three gaps at the energy level @xmath364 with three seeds at higher level , enough to completely fill the sixth energy level ( @xmath365 ) .",
    "however this configuration is not a @xmath364-canonical configuration because the rightmost gap in column @xmath364 is not the last filled .",
    "this can only be seen by letting the configuration evolve and annotating the filling order of the three gaps . in this example",
    "only seven mancala moves are sufficient to see that the gap in column @xmath364 is filled first , whereas the gap that is filled last is the one originally in column @xmath268 .",
    "the configuration @xmath366 ( obtained from the previous one with three mancala moves ) is indeed a @xmath364-canonical configuration .",
    "as noted in remark [ rem : sameq ] , after six mancala moves we have either another @xmath364-canonical configuration or the sixth level becomes completely filled .",
    "it turns out that we have a total of four other @xmath364-canonical configurations , one after each sequence of six moves starting from the @xmath364-canonical configuration ` 9 5 3 2 2 ` .",
    "( 0,3.8 ) ; ( 4 , 3.8 ) ",
    "( 4 , 4 ) ; in 4, ... ,5 ( 0,0 )  ( 1,0 )  ( 1,1 ) ; ( 0,0 ) ",
    "( 0,0 ) node[right , xshift=0cm , yshift=-0.3cm]@xmath269-th level ; in 0, ... ,4 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath115 ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath268 ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath68 ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ;    ( 0,6 )  ( 0,3.8 ) ; ( 4 , 3.8 ) ",
    "( 4 , 4 ) ; in 4, ... ,5 ( 0,0 )  ( 1,0 ) ",
    "( 1,1 ) ; in 0, ... ,4 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath68 ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath115 ; ( 0.5,0.5 ) circle ( 0.1 ) node[right , xshift=0.0cm , xshift=-0.5mm]@xmath268 ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ;    ( 0,6 )  ( 0,3.8 ) ; ( 4 , 3.8 )  ( 4 , 4 ) ; in 4, ... ,5 ( 0,0 ) ",
    "( 1,1 ) ; in 0, ... ,4 ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ; ( 0.5,0.5 ) circle ( 0.1 ) ; ( 0.5,0.5 ) circle ( 0.4 ) ;    [ teo : maxmoncanon ] a @xmath98-canonical configuration can not be @xmath343-monotone .",
    "in other words it is at most @xmath367-monotone .",
    "let @xmath14 be a @xmath98-canonical configuration , @xmath368 ; hence @xmath369 .",
    "now suppose by contradiction that @xmath14 is also @xmath343-monotone ; this implies that @xmath370 by ( i ) of definition  [ def : smon ] .",
    "set @xmath261 ( the energy sequence ) , with period @xmath371 , hence @xmath372 either @xmath373 or @xmath374 .",
    "energy levels strictly larger than @xmath98 must also be present , otherwise @xmath14 would be an augmented marching group , incompatible with @xmath98-canonicity . hence there must exist an increasing plateau , and its length can not be longer than @xmath375 due to the periodicity of @xmath286 , which is at most @xmath339 . on the other hand",
    ", @xmath343-monotonicity implies that the length of every increasing plateau is at least @xmath376 , a contradiction .",
    "in this section we shall fix @xmath377 for some @xmath10 and consider a mancala configuration @xmath99 .",
    "we let @xmath14 evolve ( applying mancala moves ) until it reaches an augmented marching group ; we denote by @xmath378 the result of @xmath379 mancala moves , so that in particular @xmath380 .",
    "let @xmath381 be the smallest time @xmath132 for which @xmath382 is an augmented marching group , in particular @xmath383 .",
    "we also denote by @xmath384 the smallest time @xmath132 such that @xmath385 .    during the evolution @xmath382",
    "will occasionally become a @xmath98-canonical configuration .",
    "specifically we indicate with @xmath386 the times before @xmath387 when we have a @xmath98-canonical configuration for some @xmath388 , @xmath389 can be itself @xmath98-canonical , however @xmath390 would imply @xmath391 , hence @xmath392 . in other words ,",
    "if we restrict @xmath393 , then @xmath389 can not be @xmath98-canonical .",
    "we call such times _ critical times_. specifically we have a sequence @xmath394 such that @xmath395 is a @xmath396-canonical configuration",
    ".    consider two consecutive critical times @xmath397 and @xmath398 .",
    "remark [ rem : sameq ] applied to @xmath395 tells us that after @xmath396 moves , we have either another @xmath396-canonical configuration , with no other @xmath98-canonical configurations in between , in which case @xmath399 and @xmath400 , or we have just filled the @xmath396-th energy level so that we have @xmath401 and @xmath402 . in both cases we have @xmath403 .",
    "we can now apply lemma [ teo : incrmon ] to @xmath395 with @xmath404 and conclude that the @xmath6-monotonicity of @xmath405 increases strictly . since @xmath406 is @xmath113-monotone , we obtain by induction that @xmath405 is @xmath78-monotone and that @xmath389 is @xmath6-monotone .",
    "it is possible for the set of critical times to be empty . in this case",
    "we shall see that the filling up of the energy levels is very fast .",
    "[ teo : stepcanon ] if @xmath334 and @xmath407 , then there exists @xmath408 such that either @xmath409 or @xmath410 is a @xmath98-canonical configuration . if @xmath14 is itself @xmath98-canonical , the result holds true with @xmath411 ( besides the trivial value @xmath412 ) .",
    "if the @xmath98-th energy level is full , then there is nothing to prove , otherwise locate the gap that will be filled last in column @xmath79 .",
    "if @xmath413 we already have a @xmath98-canonical sequence , otherwise we apply @xmath79 moves in order to rotate the gap position into column @xmath98 , now we either have a @xmath98-canonical sequence or we filled the @xmath98-th energy level .",
    "the second part of the lemma easily follows by first performing a single move and then reasoning as in the first part .",
    "[ teo : emptycrit ] if the set of critical times is empty ( @xmath414 ) , then one has @xmath415 ,",
    "i.e. @xmath416    it can be readily seen by repeated applications of the previous lemma .",
    "similarly , the @xmath417-canonical sequence @xmath406 is reached after at most @xmath418 moves , i.e. @xmath419 .",
    "now let @xmath420 ( notice that @xmath421 ) , and decompose @xmath422 if @xmath423",
    "we first apply one move to @xmath395 and then invoke lemma [ teo : stepcanon ] @xmath424 times , concluding that @xmath425    on the other hand , if @xmath426 then @xmath427 ( remark [ rem : sameq ] ) . in the end",
    "we have the estimate @xmath428 at each critical time we gain one level of monotonicity , so that @xmath429 is @xmath430-monotone .",
    "the maximal possible value of @xmath431 is @xmath432 , which gives an upper bound @xmath433 for the @xmath6-monotonicity of @xmath429 ( theorem [ teo : maxmoncanon ] ) and hence we have @xmath434 .",
    "we get @xmath435    to obtain the configuration @xmath390 we need to apply a move to @xmath429 and again invoke lemma [ teo : stepcanon ] ( more than once if @xmath436 ) for a total of at most @xmath437 moves .",
    "we notice that the last term in the previous sum is also present in the sum that defines @xmath438 , so that using we arrive at @xmath439 we summarize the previous analysis in the following lemma .",
    "[ teo : balance ] let @xmath377 and @xmath99 .",
    "then there exists @xmath440 such that after at most @xmath441 moves the resulting configuration @xmath382 satisfies :    1 .",
    "@xmath385 ; 2 .",
    "@xmath382 is @xmath6-monotone .",
    "if @xmath62 or @xmath156 then the resulting configuration is an augmented marching group .    [ def : functionw ] given @xmath442 two integers ,",
    "we define @xmath443 by @xmath444 the value of @xmath445 can be explicitly computed by first expressing @xmath446 with @xmath447 and @xmath448 ( euclidean division ) and then using the formula for the sum of the first natural numbers .",
    "we end up with @xmath449 .",
    "we have the special values    * @xmath450 , @xmath451 if @xmath452 ( only one term in the above sum ) , * @xmath453 if @xmath454 ( two terms in the above sum ) , * @xmath455 if @xmath456 ( more than two terms in the above sum ) .    moreover ,",
    "if @xmath457 then @xmath445 is strictly increasing with respect to @xmath458 and strictly decreasing with respect to @xmath459 .",
    "we can then `` invert '' @xmath445 with respect to @xmath459 and define the function @xmath460 which is ( weakly ) decreasing with respect to @xmath461 and ( weakly ) increasing with respect to @xmath458 .",
    "we have the special values    * @xmath462 if @xmath463 , * @xmath464 , if @xmath465 .",
    "referring to figure [ fig : vmap ] the value of @xmath443 can be graphically interpreted as the number of unit squares completely included in the right triangle having base ( long cathetus ) of length @xmath458 and height ( short cathetus ) of length @xmath466 .",
    "( 0,2.333 ) ",
    "( 0,0 ) ; in 0, ... ,3 ( 0,0 ) ",
    "( 0,1 ) ; ( 0,0 ) ",
    "( 0,0 )  ( 1,1 ) ",
    "( 0,1 ) ;    with the same graphical interpretation in mind function @xmath467 can be viewed as the maximal value of @xmath459 such that the right triangle of sides @xmath458 and @xmath466 contains at least @xmath461 unit squares .    for @xmath468 , let us consider a @xmath11-canonical configuration . by lemma [ teo : stepcanon ] , after a cycle of @xmath11 moves we have that the resulting configuration is either itself @xmath11-canonical or it has just become larger than @xmath53 .",
    "iterating this procedure , we want to relate the number of cycles needed to become larger than @xmath53 with the degree of monotonicity of the configuration .",
    "[ teo : cyclenumbound ] let @xmath469 with @xmath63 , @xmath223 and suppose that    1 .",
    "@xmath14 is a @xmath11-canonical configuration ; 2 .",
    "@xmath14 is @xmath6-monotone for some @xmath273 .",
    "let @xmath470 denote the number of cycles of @xmath11 moves that are required to become larger than @xmath53 and suppose that @xmath471 .",
    "then @xmath472 equivalently , reasoning by contradiction , we have the upper bound @xmath473    first we analyze the case @xmath474 , so that @xmath259 . since the configuration is @xmath6-monotone and @xmath11-canonical , in this case @xmath475 , hence @xmath476 , @xmath477 @xmath478 and so on , where @xmath286 is the energy sequence @xmath261 .",
    "then the total number of seeds with energy above @xmath11 can not be larger than @xmath479 .",
    "this is obtained by observing that we have a sequence of @xmath98 plateaus of length @xmath6 and increasing height from @xmath113 to @xmath340 and a final top plateau of length @xmath184 and height @xmath98 .",
    "this implies that @xmath480 where the `` @xmath220 '' is a consequence of the fact that the @xmath11-th energy level is not completely full . for a generic value of @xmath481",
    "we simply perform @xmath482 cycles of @xmath11 moves obtaining a configuration with level of monotonicity @xmath483 with still @xmath484 and we can resort to the special case discussed above",
    ".      the following lemma will be fundamental in proving the optimal upper bound .",
    "[ teo : magico ] let @xmath99 with @xmath63 , @xmath485 , and denote by @xmath486 the number of @xmath98-canonical configurations encountered during the evolution of @xmath14 , with @xmath487 .",
    "then the total number @xmath488 of canonical configurations encountered , and hence the least level of monotonicity of the first configuration that becomes larger than ( or equal to ) @xmath53 , is bounded by @xmath489 in particular , for @xmath490 we have @xmath491 and for @xmath492 we have @xmath493 where we used the special values of function @xmath494 computed in definition [ def : functionw ] .",
    "if @xmath495 for all @xmath98 , then we can resort to corollary [ teo : emptycrit ] and conclude immediately",
    ". otherwise , set @xmath496 and let @xmath497 be the largest value of @xmath98 such that @xmath498 .",
    "we apply lemma [ teo : cyclenumbound ] with @xmath499 , @xmath500 and @xmath501 and obtain an upper bound for @xmath502 that , since @xmath503 can be written as @xmath504 or equivalently as @xmath505 where the last inequality follows from the monotonicity of @xmath494 with respect to its arguments .    the evolution of a configuration @xmath469 , with @xmath63 and @xmath64 ,",
    "will be decomposed into two stages :    1 .",
    "the evolution from the beginning up to the first time @xmath132 when @xmath385 , where as usual @xmath506 ; 2 .",
    "the subsequent evolution until we reach an augmented marching group .",
    "the duration of each of these stages will be estimated from above with bounds that depend upon a few parameters and we shall find a uniform bound valid for all possible feasible choices of such parameters finally obtaining an upper bound for @xmath60 .    we need some further lemmas .    [ teo : augmentedifrmonotone ] let @xmath469 and let @xmath11 be the largest integer such that @xmath256 .",
    "write @xmath63 and suppose that @xmath14 is @xmath107-monotone",
    ". then @xmath14 is an augmented marching group .    by contradiction",
    "suppose that @xmath14 is not an augmented marching group , then the energy sequence has an element with value @xmath11 ( otherwise @xmath507 ) and an element with value @xmath111 ( otherwise @xmath14 would be an augmented marching group ) .",
    "this implies the existence of an increasing plateau at level @xmath58 , which must have length at least @xmath107 .",
    "an energy level of @xmath58 at position @xmath78 is possible without using one of the @xmath107 exceeding seeds only if @xmath508 , however if that position is part of the increasing plateau , then the seed at level @xmath111 must necessarily stay on top of a seed at level @xmath58 . in all cases we need at least @xmath509 seeds to build such an increasing plateau , which contradicts the assumptions .",
    "[ teo : nolongersuboptimal ] let @xmath99 with @xmath63 , @xmath131 , @xmath256 and @xmath6-monotone .",
    "if @xmath510 becomes an augmented marching group , then @xmath511    using the energy level interpretation we identify the gap at level @xmath58 that will be filled last , and call @xmath512 its column index .",
    "we consider two cases .    *",
    "case @xmath513 or @xmath514 .",
    "*    the first term @xmath193 in the estimate is then the maximal number of moves that are required to move that gap into the rightmost @xmath515-th column .",
    "we observe that starting from that configuration the augmented marching group will be obtained exactly after a number of moves multiple of @xmath58    after each cycle of @xmath58 moves the level of monotonicity increases at least of one unit ( lemma [ teo : incrmon ] ) , so that after @xmath516 cycles of @xmath58 moves we obtain a configuration @xmath71 that is at least @xmath231-monotone .",
    "now we want to prove that @xmath231-monotonicity ( and not higher ) is actually impossible under the circumstances .",
    "this would imply at least @xmath107-monotonicity that in turn implies that we have an augmented marching group thanks to lemma [ teo : augmentedifrmonotone ] .",
    "suppose then by contradiction that @xmath71 is @xmath231-monotone but not @xmath107-monotone and hence it is not an augmented marching group .",
    "this means that the gap at level @xmath58 , column @xmath58 is still empty .",
    "the energy sequence of @xmath71 has then both elements at level @xmath11 and elements at level @xmath111 , so that there exists at least an increasing plateau at level @xmath58 ( i.e. a sequence of energy elements as contiguous positions at level @xmath58 following an element at level @xmath11 and preceding an element at level @xmath111 ) .",
    "such plateau has length at least @xmath193 due to the @xmath231-monotonicity .",
    "now recall that we have an excess of @xmath107 seeds with energy larger or equal to @xmath58 ( levels @xmath11 and below are completely filled thanks to the assumptions ) .",
    "column @xmath111 is the only one having energy @xmath58 with no need to use one of the excess seeds , however we have barely enough seeds to form an increasing plateau of length @xmath193 which requires @xmath509 seeds that reduce to @xmath107 only if we take advantage of the energy step at column @xmath111 .    recalling that column @xmath58 has energy level @xmath11 ( the gap is still empty ) , the only possible disposition of the @xmath107 excess seeds is the one with @xmath193 of them in columns @xmath68 to @xmath193 ( energy @xmath58 ) and the last excess seed itself in column @xmath193 ( then with energy @xmath111 ) .",
    "this configuration becomes an augmented marching group after exactly @xmath107 moves , however we know that an augmented marching group is reached after a multiple of @xmath58 moves and hence @xmath517 , a contradiction .    since @xmath231-monotonicity is impossible for @xmath71 ,",
    "then we have at least @xmath107-monotonicity and hence we have an augmented marching group .    * case @xmath518 . *    let us consider the result of the evolution as soon as it becomes an augmented marching group and call it @xmath71 , the position of the `` marked '' gap is then column @xmath58 and it has just been filled with the last of the @xmath107 seeds the were originally at energy levels larger then @xmath58 . immediately to the left of this seed",
    "there is a contiguous sequence of , say , @xmath519 seeds , @xmath520 at level @xmath58 , preceded by a gap in column @xmath521 .",
    "clearly this latter gap ( let us call it `` gap number @xmath115 '' ) can be traced back to its corresponding position in the initial configuration @xmath14 , and will originally be empty in @xmath14 and will continue to be empty during the whole evolution .",
    "it is located in column @xmath522 of @xmath14 , to the left of the marked gap ( in column @xmath512 ) .",
    "no seed at energy larger then @xmath58 ( they are the `` active '' seeds , the only ones that `` move '' with respect to the @xmath58 level ) can ever cross or reach the column containing gap number @xmath115 , so that the active seeds originally to the left of gap number @xmath115 or to the right of the marked gap ( call this region the `` outer region '' ) can ever interact with the region between gap number @xmath115 and the active gap .    without loss of generality",
    "we can then suppose that the outer region has reached its final configuration already in @xmath14 .",
    "this actually means that there are no active seeds to the right of the marked gap .",
    "the final step is then to observe that in this situation @xmath14 can be interpreted as the result of the evolution ( with @xmath523 moves ) from a configuration @xmath524 that itself satisfies the hypotheses of this lemma and the marked gap already in the @xmath58 position ( in other words we can `` steal '' a few moves ) and we can resort to the first case of the lemma .",
    "the proof is thus complete .",
    "we now analyze the evolution of @xmath469 , @xmath63 , @xmath131 .",
    "we denote with @xmath273 the number of @xmath98-canonical configurations encountered during the evolution with @xmath525 .    using lemma [ teo : magico ]",
    "we obtain the constraint @xmath526 , which in particular gives @xmath527 the third estimate is actually just a special case of the second one ; the first and second estimates coincide for @xmath107 in the common interval @xmath528 .    as usual",
    "we denote by @xmath378 and we set    * @xmath529 the smallest time such that @xmath530 * @xmath531 the smallest time such that @xmath532 is an augmented marching group .",
    "[ teo : timesestimates ] we have the following estimates :    1 .",
    "@xmath533 ; 2 .",
    "@xmath534 if @xmath535 ; 3 .",
    "@xmath536 if @xmath537 .",
    "the first point is exactly lemma [ teo : balance ] .",
    "point ( 2 ) is simply lemma [ teo : augmentedifrmonotone ] .",
    "point ( 3 ) follows from lemma [ teo : nolongersuboptimal ]    we then have a total estimate of @xmath538 as a function of @xmath6 that reads as follows :    @xmath539    clearly in the case @xmath537 it is most convenient to take @xmath414 , whereas if @xmath535 the maximum value is achieved by selecting the largest possible value of @xmath6 , which is dictated by the constraints .",
    "we recall from section [ sec : lower ] the definition of @xmath96 as    @xmath540    [ teo : mainresult ] let @xmath63 with @xmath541 and @xmath131",
    ". then @xmath542 .",
    "the case @xmath543 corresponds to @xmath544 , easily studied manually .    in view of the results of section",
    "[ sec : lower ] it suffices to prove the upper bound @xmath545 .",
    "let @xmath469 .",
    "we invoke lemma [ teo : balance ] so that there exists @xmath6 satisfying the constraints such that after at most @xmath546 moves the resulting configuration is @xmath6-monotone and @xmath547 .",
    "now we enforce lemma [ teo : timesestimates ] and distinguish three cases .    * case @xmath490 . *",
    "if @xmath535 , we use the first inequality of in to conclude @xmath548    if @xmath537 , using @xmath549 , and @xmath550 , i.e. @xmath551 we have @xmath552 so that in any case @xmath553 .    * case @xmath554 .",
    "*    again we distinguish the case @xmath535 , together with the third inequality of to obtain @xmath555    whereas if @xmath537 , again using @xmath549 we have    @xmath556    * case @xmath557 . *",
    "we start with the case @xmath537 and again use @xmath549 to get    @xmath558    finally , if @xmath535 , enforcing the second inequality in , using @xmath559 we obtain    @xmath560    we have covered all the possible cases and the proof is complete .    the previous theorem [ teo : mainresult ] , and in particular the upper bound @xmath545 also allows to compute the maximal diameter of @xmath25 :    the diameter of @xmath25 ( see definition [ def : depthdiameter ] ) is given by @xmath561 where @xmath562 is the maximal period of an augmented marching group , i.e. @xmath563 if @xmath62 is a triangular number , otherwise @xmath564 if @xmath63 , with @xmath565 , is not a triangular number .    that the diameter can not exceed @xmath561 immediately follows from theorem [ teo : mainresult ] . the reverse inequality follows from the constructions of section [ sec : lower ] , in particular we make use of proposition [ teo : lower1 ] , corollary [ teo : lower2 ] , proposition [ teo : lower3 ] and the discussion about the period of the resulting augmented marching groups following each of these results .",
    "the notion of @xmath6-monotonicity naturally introduces a sort of graduation on the graph of moves . indeed ,",
    "theorem [ teo : smonclosed ] asserts that the subgraph obtained by considering only the @xmath6-monotone configurations for some @xmath273 is closed under mancala moves ( no arc leaves this subset ) .",
    "it is then natural to ask what is the depth of such subgraphs .",
    "more precisely , for @xmath566 let us denote by @xmath567 and @xmath568 the subsets of @xmath25 given by @xmath569 similarly , with @xmath570 and @xmath571 we denote the subgraphs of @xmath70 having nodes in @xmath567 and @xmath568 respectively .",
    "then the _ depth _ of @xmath570 , denoted by @xmath572 , is the maximal distance from a node of @xmath570 to a periodic configuration . in this context , recalling that @xmath113-monotonicity is a void notion , our main theorem [ teo : mainresult ] gives a value for @xmath573 . it would be desirable to have a result about the depth @xmath572 for any value of @xmath6 ; unfortunately , at the moment we are not able to extend our result to nontrivial values of @xmath6 .",
    "especially the value @xmath574 is interesting : indeed , remark [ rem : weakstrong ] relates @xmath575 to @xmath571 and in particular their respective depth .",
    "adding one to @xmath576 we obtain the depth of the graph of monotone configurations .",
    "this is of special interest in view of the following    the monotone mancala graph is isomorphic to the graph of the bulgarian solitaire @xcite,@xcite,@xcite .    the bulgarian solitaire , already mentioned in the introduction , is played as follows .",
    "the starting position consists of a number of piles , each with a ( possibly different ) number of cards .",
    "each move consists in removing one card from each pile and collecting the removed cards in a new pile .",
    "piles that become empty are simply neglected and the order of the piles ( and of the cards in a pile ) is inessential .",
    "we can associate a mancala configuration to a bulgarian solitaire configuration by defining @xmath0 equal to the number of piles with at least @xmath78 cards . in this way we obtain a valid mancala configuration which is clearly monotone .",
    "it can be readily shown that this correspondence is one to one and that it is consistent with the respective game rules .",
    "hence , the depth of the bulgarian solitaire subgraph is given by @xmath577 .",
    "the following conjecture is stated in @xcite :    let @xmath63 with @xmath541 and @xmath131 .",
    "the depth of @xmath575 is given by @xmath578    in @xcite the authors proved this result for some special values of @xmath5 , while the above expression is proved to be a lower bound .",
    "our computer simulations validates the conjecture for values up to @xmath579 , improving the previous limit of @xmath580 .",
    "the authors are grateful to the anonymous reviewers for their precious suggestions .",
    "a. bouchet , _",
    "owari i. marching groups and periodical queues _ , 2005 , preprint ( http://isgem.rpi.edu/files/1545 ) a. bouchet , _ owari ii .",
    "marching groups and bulgarian solitaire _ , 2005 , preprint ( http://isgem.rpi.edu/files/1546 ) h. bruhn , _ periodical states and marching groups in a closed owari _ , discrete math .",
    "* 308 * ( 2008 ) , no .  16 , 36943698 ."
  ],
  "abstract_text": [
    "<S> we determine the optimal bound for the maximum number of moves required to reach a periodic configuration of _ open mancala _ </S>",
    "<S> ( also called open owari ) , inspired by a popular african game . </S>",
    "<S> a mancala move can be interpreted as a map from the set of compositions of a given integer in itself , thus relating our result to the study of the corresponding finite dynamical system . </S>"
  ]
}