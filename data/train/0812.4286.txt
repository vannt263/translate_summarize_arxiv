{
  "article_text": [
    "let @xmath1 be the moduli of degree @xmath2 genus one stable maps @xcite to @xmath0 and let @xmath3 be the primary component that is the closure of the open subset of all stable morphisms @xmath4\\in \\mpd$ ] with smooth domains . in @xcite , vakil - zinger found a canonical desingularzation @xmath5 of @xmath6 by performing `` virtual '' blowing - ups on @xmath1 .",
    "they also showed that for @xmath7 and @xmath8 , the pull - back universal family over @xmath9 , the direct image sheaf @xmath10 is locally free .",
    "those desingularizations are useful for applying atiyah - bott localization formula to the hyperplane relation proved by li - zinger in @xcite . while the desingularization result in @xcite is algebro - geometric , its proof is analytic in nature .",
    "this paper provides an algebro - geometric approach to these desingularization results .",
    "it will be a part of an algebro - geometric approach of the relation between ordinary and reduced genus one gw - invariants of complete intersection in products of projective spaces @xcite .",
    "it will also serve as our first step to generalize the structure results on moduli spaces of genus one stable maps to higher genera .    our proof consists of two stages .",
    "at first , we use the classical method of studying special linear series on curves to give an algebro - geometric proof of the local equations of @xmath1 , obtained by zinger in @xcite .",
    "after that , we `` modular '' blow up @xmath1 and prove that the resulting stack has smooth irreducible components . the blowup construction used in this paper follows that in @xcite .",
    "we now briefly outline our approach .",
    "since a stable map @xmath4 $ ] to a projective space @xmath0 is given by @xmath11 : c\\lra\\pn,\\quad u_i\\in h^0(u\\sta \\so(1)),\\ ] ] its deformation is determined by the combined deformation of the curve @xmath12 and the sections @xmath13 .",
    "since moduli spaces of curves is smooth , the singularity of @xmath1 is caused by the non - locally freeness of the direct image sheaf @xmath14 of the universal family @xmath15 of @xmath1 .    to study the non - locally freeness of the direct image sheaf , by assigning to each stable map @xmath4 $ ] the divisor @xmath16 ,",
    "locally we can view @xmath1 as a stack over the artin stack @xmath17 of pairs @xmath18 of genus one nodal curves @xmath12 and effective divisors @xmath19 . over each chart",
    "@xmath20 , by picking an auxiliary section of the universal curve @xmath21 with @xmath22 the tautological divisor , we construct explicitly a complex @xmath23 $ ] whose sheaf cohomology gives the cohomology @xmath24 .",
    "we then apply the deformation theory of nodal curves to derive a simple explicit form of the homomorphism @xmath25 in @xmath26 . under a suitable trivialization ,",
    "@xmath27 where each @xmath28 is a suitable product of the pull back of regular functions whose vanishing loci are irreducible components of nodal curves in @xmath17 .",
    "this description enables us to derive explicit local equations of @xmath1 ( see theorem [ thm : localequtree ] ) .",
    "they are analogous to the equations described by zinger @xcite .    to construct the desingularization of the moduli space",
    ", we introduce the artin stack @xmath29 of pairs @xmath30 of genus one nodal curves @xmath12 with non - negative weights @xmath31 , meaning that @xmath32 for all irreducible @xmath33 .",
    "the stack @xmath29 is smooth and contains closed substacks @xmath34 whose general point is a pair @xmath30 such that @xmath12 consists of a smooth elliptic curve @xmath35 with @xmath36 rational curves attached to @xmath35 and the restriction of @xmath37 to @xmath35 is zero , while its restriction to the other components of @xmath12 in non - zero .",
    "we then blow up @xmath29 successively along @xmath38 , @xmath39 , @xmath40 , etc . , to obtain @xmath41 .",
    "the desingularization of @xmath1 is @xmath42    after a detailed study of the lifting of the local equations of @xmath1 mentioned earlier , we prove that the irreducible components of @xmath43 are smooth and intersect transversally .",
    "we also prove that for each irreducible component @xmath44 with @xmath45 the pull - back universal family on @xmath46 , the direct image sheaf @xmath47 is locally free .",
    "it is of rank @xmath48 over the desingularization of the primary component and of rank @xmath49 elsewhere .",
    "we comment that the results for the primary component were proved by vakil - zinger @xcite .",
    "weighted graph was also used to study stable maps to @xmath50 by pandharipande @xcite .",
    "this paper is organized as follows . in  2 , we outline our approach , stating the main desingularization theorems [ thm : m1 ] and [ thm : m2 ] , and the main local structure theorems [ thm : equ1 ] and [ thm : equ3 ] . in  3 ,",
    "we introduce the notion of weighted rooted trees of weighted nodal curves . in the following section , we state and",
    "prove the main structural result of the direct image sheaf @xmath51 .",
    "finally , in  5 we prove the theorems stated in  2 .",
    "we d like to thank zinger for numerous suggestions on improving the presentation of the paper and for pointing out several oversights .",
    "the second author also thanks him for valuable discussion during their collaboration .",
    "the first author was partially supported by nsa ; the second author was partially supported by nsf dms-0601002 .    throughout the paper ,",
    "we fix an arbitrary algebraically closed base field @xmath52 .",
    "all schemes in this paper are assumed to be noetherian over @xmath52 .",
    "in this section , we state our main results .",
    "let @xmath12 be a curve .",
    "we set @xmath53 a weighted nodal curve is a pair @xmath30 consisting of a connected nodal curve @xmath12 and a weight assignment @xmath54 .    for any scheme @xmath55 and flat family of nodal curves",
    "@xmath56 , a weight assignment of @xmath57 is a section @xmath37 of the sheaf @xmath58 , where @xmath59 is the subsheaf consisting of all sections @xmath37 whose restrictions @xmath60 to any closed point @xmath61 lies in @xmath62 . here",
    "@xmath60 is the image of @xmath37 under the pullback homomorphism @xmath63 .",
    "a flat family of weighted nodal curves over @xmath55 is a pair @xmath64 of a flat family of nodal curves over @xmath55 together with a weight assignment over @xmath57 .",
    "we say that two families of weighted nodal curves @xmath64 and @xmath65 are equivalent if there is an isomorphism @xmath66 such that @xmath67 .",
    "a weighted nodal curve is called stable if every smooth ghost ( weight 0 ) rational curve @xmath68 , @xmath69 contains at least three nodes of @xmath12 . fixing a genus @xmath70",
    ", we form a groupoid @xmath71 that sends any scheme @xmath55 to the set of all equivalence classes of flat families of stable weighted nodal curves of genus @xmath72 over @xmath55 .    mimicking the proof that the stack @xmath73 of nodal curves of genus @xmath72 is an artin stack , we obtain    the groupoid @xmath74 is a smooth artin stack of dimension 3g-3 .",
    "the projection @xmath75 by forgetting the weight assignment is tale .",
    "note that @xmath74 is the disjoint union of infinitely many smooth components , each of which is indexed by the total weight of the weighted curves .",
    "because of the stablity requirement , each component is of finite type",
    ".      @xmath76    to describe the desingularization of @xmath1 , the notion of core curve is pivotal .",
    "the core of a connected genus - one curve @xmath12 is the unique smallest ( by inclusion ) subcurve of arithmetic genus one .",
    "the core of a weighted curve @xmath77 is called ghost if the induced weight on the core is zero .",
    "the stack @xmath29 contains an open substack @xmath78 consisting of weighted curves with non - ghost cores .",
    "the complement @xmath79 admits a natural partition according to the number of rational trees attached to the ghost core curves : @xmath80 is the subset of pairs @xmath30 such that @xmath12 can be obtained from the ghost core @xmath81 by attaching @xmath36 ( connected ) trees of rational curves to the core @xmath35 at @xmath36 distinct smooth points of @xmath35 .",
    "then @xmath82 .",
    "we let @xmath34 be the closure of @xmath80 .",
    "we can successively blow up @xmath29 along the loci @xmath34 .",
    "the locus @xmath38 is a cartier divisor ; blowing up along @xmath38 does nothing .",
    "we start by blowing up @xmath29 along the locus @xmath39 , which is a smooth codimension 2 closed substack of @xmath29 ; we denote the resulting stack by @xmath83}$ ] , which is smooth .",
    "inductively , after obtaining @xmath84}$ ] , we blow it up along the proper transform @xmath85,k } \\subset \\fm\\uwt_{1,[k-1]}$ ] of the closed substack @xmath86 .",
    "since @xmath85,k}$ ] is a smooth closed substack of @xmath84}$ ] of codimension @xmath36 , the new stack is smooth .",
    "we continue this process for all @xmath87 .",
    "since each connected component of @xmath88 is of finite type , the blowup process on this component will terminate after finitely many steps .",
    "therefore , the limit stack , which is the blowup of @xmath88 along the proper transforms of @xmath34 in @xmath89}$ ] for all @xmath90 , is a well - defined smooth artin stack ; we denote this stack by @xmath91 .    to induce a blowup on @xmath1",
    ", we form the fiber product @xmath92 here the morphism @xmath93 is defined as follows .",
    "the first chern class @xmath94 gives a weight assignment to the domain curves of the universal family @xmath95 of @xmath96 , making @xmath97 a family of weighted nodal elliptic curves .",
    "this family then defines a tautological morphism @xmath98 that is a lift of the tautological morphism @xmath99 .",
    "note that since @xmath94 has degree @xmath2 , defining @xmath100 requires blowing up @xmath88 along the proper transforms of @xmath34 from @xmath101 to @xmath102 .",
    "that is , @xmath103}.\\ ] ]    we can now succinctly reformulate the end result of the virtual blowup construction of @xcite .",
    "@xmath100 is a dm - stack with normal crossing singularities .    for a refined version of this theorem with explicit local equations ,",
    "see theorem [ thm : inductioncase = d ] .",
    "desingularizations of the sheaves @xmath104 over @xmath100 are essential ingredients in computing genus one gw - invariants of complete intersections @xcite .",
    "the blowup @xmath100 contains a primary irreducible component whose generic points are stable maps with non - ghost elliptic core .",
    "we denote this component by @xmath105 .",
    "the other irreducible components are indexed by the set of all partitions of @xmath2 .",
    "for @xmath106 either @xmath107 or a partition of @xmath2 , let @xmath108 be the pull back of the universal map over @xmath1 .",
    "the following theorem is due to vakil - zinger @xcite .    for every @xmath109 ,",
    "the direct image sheaf @xmath110 is a locally free sheaf over @xmath111 with @xmath106 either @xmath107 or a partition of @xmath2 .",
    "it is of rank @xmath112 when @xmath113 and of rank @xmath114 otherwise .",
    "we will treat the two theorems in the reverse order from what was done in @xcite .",
    "specifically , we will first prove a structure result for the direct image sheaf @xmath115 for all positive integers @xmath36 .",
    "we then derive local defining equations for @xmath1 and @xmath100 , and obtain theorems [ thm : m1 ] and [ thm : m2 ] as corollaries .      for later use",
    ", we form the artin stack of stable pairs @xmath18 of ( connected ) nodal elliptic curves @xmath12 with effective divisors @xmath116 supported on the smooth loci of @xmath12 . here",
    "@xmath18 is stable if any smooth rational curve in @xmath12 disjoint from @xmath117 contains at least three nodes of @xmath12 .",
    "we denote this stack by @xmath17 .",
    "it maps to @xmath88 by sending @xmath18 to @xmath118 .",
    "the morphism @xmath119 is smooth and has connected fibers .",
    "in particular , the connected components of @xmath17 are indexed by the degree of the effective divisors .    for any closed point @xmath4 \\in \\mpd$ ] , we let @xmath120 : c \\lra \\pn , \\quad",
    "u_i \\in \\gamma ( c , u^ * \\so_{\\pn}(1)),\\ ] ] be the associated stable morphism . by a change of homogeneous coordinates on @xmath0",
    ", we can assume that @xmath121 is a smooth simple divisor @xmath117 of degree @xmath2 .",
    "once @xmath122 is fixed , we can choose @xmath123 to be the constant section @xmath124 .",
    "under this convention , the remaining sections @xmath125 are uniquely determined by the morphism @xmath126 .",
    "consequently , deforming @xmath127 is equivalent to deforming the pair @xmath128 and the sections @xmath129 .",
    "we next choose a small open neighborhood @xmath4\\in u$ ] in @xmath1 .",
    "let @xmath130 be the the universal family over @xmath131 with @xmath132 the fiber over @xmath4 $ ] .",
    "let @xmath133 $ ] ( where @xmath134 $ ] are the homogeneous coordinates of @xmath0 ) . by shrinking @xmath131 if necessary",
    ", we can assume that @xmath135 is away from the singular points of the fibers @xmath136 .",
    "this way , we obtain a morphism @xmath137 \\in u \\longmapsto ( c ' ,   c ' \\cap\\cs).\\ ] ]    we now construct the deformation space of the data @xmath138 .",
    "we let @xmath139 be a smooth chart of @xmath140 that contains the image of @xmath141 ; let @xmath142 be the tautological family over @xmath143 with @xmath144 for some point @xmath145 , and let @xmath146 be the projection .",
    "we set @xmath147 .",
    "set theoretically , our deformation space is the union @xmath148 .",
    "the deformation is singular at points where the core curve of @xmath149 is ghost due to @xmath150 .",
    "the algebraic construction of the deformation space is via a standard trick .    by shrinking @xmath143 if necessary , we can find a section @xmath151 of @xmath152 , away from @xmath153 , such that it passes through smooth parts of the core curves of all fibers of @xmath152 .",
    "because @xmath154 is effective and has positive degree on the core curve of every fiber of @xmath152 , we have r^1 _ * ( ) = 0 .",
    "we let @xmath155 be the total space of the vector bundle @xmath156 and let @xmath157 be the projection .",
    "then the tautological restriction homomorphism @xmath158 lifts to a section f ( _ , p^ * _ * ( ( ) ^n| _ ) ) .",
    "let @xmath159 .",
    "then there is a canonical open immersion @xmath160(@xmath161 ) @xmath162 .",
    "these local equations are made explicit in theorem [ thm : localequtree ] .",
    "we let @xmath163 be the blowup described in [ inductive - blowups ] .",
    "we form the fiber product @xmath164 let @xmath165 be the projection . then @xmath166 is the total space of the pull back bundle @xmath167 .",
    "the immersion @xmath168 of theorem [ thm : equ1 ] induces an immersion @xmath169 .",
    "let @xmath170 be the projection and let @xmath171 be the pull back section in @xmath172 .",
    "after shrinking @xmath143 if necessary and fixing a suitable trivialization @xmath173 , we can find @xmath174 regular functions @xmath175 over @xmath176 such that @xmath177 further , each @xmath178 and @xmath179 has smooth vanishing locus and the vanishing locus of their product @xmath180 has normal crossing singularities .",
    "note that some @xmath181 may be invertible . for more explicit local equations for @xmath100",
    "; see theorem [ thm : inductioncase = d ] .",
    "in this section , we discuss the combibatorics of the dual graphs of nodal curves and introduce terminally weighted trees for weighted elliptic nodal curves .",
    "this combibatorics is not strictly necessary for our presentation , but they do make our exposition more intuitive and formulas more elegant .",
    "let @xmath182 be a connected rooted tree with @xmath183 its root .",
    "the root @xmath183 defines a unique partial ordering on the set of all vertices of @xmath182 according to the descendant relation so that the root is the unique _ minimal _ element ; all non - root vertices are descendants of the root @xmath183 .",
    "we call a vertex terminal if it has no descendants ; in the combinatorial world , this is also called a leaf .",
    "equivalently , a non - root terminal vertex is a non - root vertex that has exactly one edge connecting to it . following this convention ,",
    "the root is terminal only when @xmath182 consists of a single vertex . in the following , given a rooted tree @xmath182 we denote by @xmath184 the set of its vertices , by @xmath185 its non - root vertices , and by @xmath186 its terminal vertices .",
    "note that for any vertex @xmath187 in @xmath182 , there is a unique ( directed ) path between @xmath183 and @xmath187 ; this is the maximal chain of vertices @xmath188    next we consider weighted rooted trees .",
    "a weighted rooted tree is a pair @xmath189 consisting of a rooted tree @xmath182 together with a function on its vertices @xmath190 , called the weight function .",
    "a vertex is positive if its weight is positive ; a ghost vertex is a vertex with zero weight .",
    "the total weight of the tree is the sum of all its weights .    in this paper",
    ", we will consider only _ terminally weighted _ rooted trees .",
    "a weighted rooted tree @xmath189 is terminal if all terminal vertices are positive and all positive vertices are terminal ; it is called stable ( resp .",
    "semistable ) if every ghost non - root vertex has at least three ( resp .",
    "two ) edges attached to it .",
    "when the weight @xmath37 is understood , we will use @xmath182 to denote the weighted rooted tree @xmath191 as well as its underlying rooted tree @xmath182 with weights removed .",
    "4.5 cm    ( 3 , 15 ) ( 45,2 )    .5 cm    figure 1 .",
    "two trees      for positive @xmath2 , we let @xmath192 ( resp .",
    "@xmath193 ) be the set of all stable ( resp .",
    "semistable ) terminally weighted rooted trees of total weight @xmath2 .",
    "the set @xmath192 is finite , while @xmath194 is infinite .",
    "the set @xmath194 admits the following geometrical operations that will be useful for our discussion .",
    "the first operation is _ pruning _ a tree .",
    "given @xmath195 , to prune @xmath182 from a vertex @xmath187 , we simply remove all descendants ( i.e. those @xmath196 with @xmath197 ) and the edges connecting the removed vertices .",
    "after pruning @xmath182 from @xmath187 , the new graph has @xmath187 as its terminal vertex .",
    "if @xmath182 is a weighted tree , we define the weight of @xmath187 in the pruned tree to be the sum of the original weight of @xmath187 and the weight of the removed vertices ; we keep the weights of the other vertices unchanged .",
    "note that the resulting pruned tree is terminally weighted as well .",
    "the second operation is _ collapsing _ a vertex .",
    "collapsing a vertex @xmath187 in @xmath182 is a two - step process : first merge @xmath187 with its unique ascendent , removing the edge between them and assigning the sum of their weights to the merged vertex , and then prune the resulting tree along all positively weighted non - terminal vertices , repeating the process as long as possible .",
    "the third operation is _ specialization _ : it is the inverse operation of a collapsing .",
    "the fourth operation is _ advancing _ a vertex .",
    "let @xmath187 be a vertex in @xmath182 and let @xmath198 be its direct ascendant . to advance @xmath187 , replace every edge connecting @xmath199 to a direct descendant @xmath200 other than @xmath187 by an edge connected @xmath200 to @xmath187 and then prune the resulting tree along all positively weighted non - terminal vertices , repeating the process as long as possible .",
    "( 3 , 15 ) ( 20,2 )    .5 cm    figure 2 .",
    "operations on weighted trees    instead of drawing a picture , a weighted rooted tree can also be described compactly as follows .",
    "here is an example .",
    "let @xmath201.\\ ] ] this is a weighted rooted tree whose root is @xmath183 ; the other vertices are labelled by @xmath202 .",
    "the vertices inside a square bracket are the descendants of the vertex immediately proceeding the bracket ; the weights of the terminal vertices @xmath203 , @xmath204 , and @xmath2 are indicated in the following parenthesis . collapsing @xmath205 , we obtain @xmath206 $ ] .",
    "advancing @xmath205 , we get @xmath207 $ ] .",
    "advancing @xmath203 , we obtain @xmath208 $ ] .    when the weight function is irrelevant to the discussion",
    ", we will drop any reference to weights .",
    "for example , the above tree @xmath182 would then be written as @xmath209 $ ]    in this compact representation of a tree , pruning a tree from a vertex @xmath187 means removing the bracket immediately after @xmath187 and assigning it the total weight of the vertices inside the bracket .",
    "collapsing a ghost vertex @xmath187 is removing the vertex @xmath187 as well as the closest brackets @xmath210[,]@xmath211 associated to it . advancing a ghost vertex @xmath187 is moving all the other vertices located inside of the same square bracket as @xmath187 into the square bracket following @xmath187 .",
    "observe that advancing can make a stable tree semistable .",
    "for example , consider the stable tree @xmath212 , c]]$ ] .",
    "if we advance @xmath205 , we obtain @xmath213]$ ] , which is semistable but not stable , since the vertex @xmath203 has only two edges attached to it .",
    "@xmath76    to keep track of the changes of the strata of @xmath1 after blowups , we need the notion of monoidal transformations of weighted trees .",
    "we begin with the following .",
    "let @xmath182 be a semi - stable terminally weighted tree with root @xmath183 and at least one non - root vertex .",
    "the trunk of @xmath182 is the maximal chain @xmath214 of vertices in @xmath182 such that each vertex @xmath200 with @xmath215 has exactly one immediate descendant .    in this case , we abbreviate the trunk by @xmath216 ; we call @xmath217 the branch vertex of @xmath182 if it is not a _ terminal _ vertex .",
    "otherwise we call @xmath182 a path tree .",
    "when @xmath218 , we say the tree has no trunk .",
    "figure 1 shows two trees : the first one has no trunk ; the second one has a trunk .",
    "let @xmath182 be a tree with trunk @xmath219 .",
    "then @xmath182 can be obtained by attaching @xmath220 rooted trees , called branches , @xmath221 , to the trunk so that the roots of @xmath222 are direct descendants of @xmath217 . according to our convention",
    ", @xmath182 can be expressed as @xmath223:=o[v_1[\\cdots[v_r[\\gamma_1',\\cdots,\\gamma_\\ell']]]].\\ ] ] the tree @xmath182 has no branches if and only if it is a path - tree .",
    "let @xmath224 denote the number of branches of @xmath182 .",
    "we call @xmath182 simple if all of the branches are stable",
    ".    a monoidal transform of a simple terminally weighted tree @xmath225 is a tree obtained by advancing one of the immediate descendants of the branch vertex of  @xmath225 , if @xmath225 has a branch vertex .",
    "we denote the set of monoidal transforms of @xmath182 by @xmath226 .",
    "note that every tree in @xmath192 is simple , and if @xmath225 is a simple tree , so is every monoidal transform of @xmath225 .",
    "let @xmath182 be a simple terminally weighted tree and @xmath227 .",
    "then either @xmath228 , which is when @xmath229 is a path - tree , or @xmath230 .",
    "the same conclusion holds when @xmath229 is a collapsing of @xmath182 at a direct descendant of the branch vertex .",
    "if @xmath231 is the result of advancing a direct descendant @xmath187 of the branch vertex @xmath199 of @xmath225 and @xmath187 is not terminal , then the direct descendants of @xmath187 in @xmath231 are the direct descendants of @xmath187 in @xmath225 and the direct descendants of @xmath199 in @xmath225 other than  @xmath187 .",
    "furthermore , @xmath187 is the branch vertex of @xmath231 in this case ; thus , @xmath232 . on the other hand ,",
    "if @xmath187 is terminal in @xmath225 , then @xmath231 is the path from @xmath183 to @xmath187 in @xmath225 .",
    "the proof of the second statement is similar .",
    "to index the strata of the various blowups of @xmath1 , we introduce the following .",
    "we set @xmath233}=\\lambda_d$ ] and define @xmath234}$ ] inductively for @xmath235 : @xmath236}=\\{\\gamma \\in \\lambda_{d,[k-1 ] } | { \\rm br } ( \\gamma ) \\ge k+1\\ } \\cup \\{\\gamma \\in { \\rm mon } ( \\gamma ' ) | \\gamma ' \\in   \\lambda_{d,[k-1 ] } , { \\rm br } ( \\gamma ' ) = k \\}.\\ ] ]    for any @xmath237}$ ] with @xmath238 , either @xmath239 or @xmath240 .",
    "in particular , @xmath241}$ ] consists of path trees only .",
    "first , the fact the total weight of a terminally weighted tree @xmath182 is @xmath2 implies that @xmath242 .",
    "the assertion of the lemma holds for @xmath243 . on the other hand , lemma [ mon1 ] implies that if the assertion holds for @xmath36 , then it also holds for @xmath244 .",
    "let @xmath12 be a connected nodal genus one curve .",
    "we associate to @xmath12 the dual @xmath245 , with vertices corresponding to the irreducible components of @xmath12 and the edges to the nodes of  @xmath12 .",
    "since the arithmetic genus of @xmath12 is @xmath246 , either @xmath247 has a unique vertex corresponding to the genus one irreducible component of @xmath12 or @xmath247 contains a unique loop . in the first case , we designate that vertex the _ root _ of @xmath248 ; in the latter case we shall contract the whole loop to a single vertex and designate it the _ root _ of the resulting tree .",
    "we will call the resulting rooted tree the _ reduced dual tree _ of @xmath12 and denoted it by @xmath249 .",
    "next we consider a weighted nodal genus one curve @xmath250 .",
    "the weight @xmath37 induces weights on the vertices of the dual graph @xmath247 of @xmath12 .",
    "if @xmath247 contains a loop , then upon contracting the loop , we assign the resulting root the total weight of the loop . this way",
    ", we obtain a natural weighted tree @xmath251 associated to the weighted curve @xmath250 .    in general , the @xmath249 with this weight function may not be terminally weighted . if not",
    ", we can prune @xmath249 along all positively weighted non - terminal vertices to obtain a terminally weighted rooted tree .",
    "we call the result the terminally weighted rooted tree of @xmath250 and denoted it by @xmath252 . in the case",
    "that @xmath250 is understood , we shall write it simply as @xmath182 .",
    "following this construction , each terminal vertex @xmath187 of @xmath182 is a positively weighted vertex of @xmath247 .",
    "we let @xmath253 be the union of all irreducible components of @xmath12 whose associated vertices @xmath254 ( in @xmath247 ) satisfy @xmath255 . then",
    ", @xmath253 is a tree of rational curves .",
    "further , if @xmath182 has zero weight root and @xmath256 are its terminal vertices , then @xmath257 is the maximal weight zero connected subcurve of @xmath12 that contains the core elliptic curve .",
    "any stable map @xmath258 \\in \\mpd$ ] naturally gives rise to a weighted nodal genus one curve @xmath250 , where the weight of an irreducible component of @xmath12 is the degree of the map @xmath196 on that component .",
    "we will then call the associated terminally weighted rooted tree of @xmath250 the terminally weighted rooted tree of the stable map @xmath259 $ ] .",
    "we denote it by @xmath260 } , w)$ ] .",
    "it is stable .    for any @xmath261 ,",
    "we define @xmath262 be the subset of all @xmath263}\\in\\mpd$ ] whose associated terminally weighted rooted trees is @xmath182 .",
    "each @xmath262 is a smooth , locally closed substack of @xmath1 ; together they form a stratification of @xmath1 .",
    "suppose @xmath264 has @xmath265 terminal vertices , indexed by @xmath266 and of weights @xmath267 with @xmath268 . without the weight , @xmath182 is the _ reduced dual graph _ of some genus 1 nodal curve .",
    "we denote by @xmath269 the stratum in @xmath270 consisting of stable genus 1 curves whose _ reduced dual graph _ is @xmath182 with terminal vertices replaced by the corresponding marked points .",
    "then @xmath262 is ( up to equivalence by automorphisms ) @xmath271 , [ { u_i},c_i , q_i]_1^\\ell)\\in m_{\\gamma}\\times\\prod_{i=1}^\\ell\\overline m_{0,1}(\\pn , d_i ) \\mid { u_1}(p_1)=\\cdots={u_\\ell}(p_\\ell)\\bigr\\}.\\ ] ] since @xmath0 has ample tangent bundle , @xmath272 smooth and the evaluation morphisms @xmath273 are submersions .",
    "hence @xmath262 is smooth .",
    "in this section , we state and prove structure results of the direct image sheaf @xmath51 .",
    "let @xmath12 be a proper nodal curve with arithmetic genus @xmath274 .",
    "we call a node @xmath275 of @xmath12 a separating node if @xmath276 is disconnected .",
    "similarly , we call an irreducible component @xmath33 a separating component if @xmath277 is disconnected .    along the same line , we introduce    an inseparable curve is a connected curve with no separating node ; an inseparable component of @xmath12 is an inseparable subcurve of @xmath12 that is not a proper subcurve of another inseparable subcurve of @xmath12 .",
    "we say that a ( separating ) node @xmath275 separates @xmath278 and @xmath279 if @xmath278 and @xmath280 lie in different connected components of @xmath276 ; we say that the node @xmath275 lies between @xmath278 and @xmath280 in this case .",
    "we let @xmath281}$ ] be the collection of all nodes that lie between @xmath278 and @xmath280 .",
    "this notion extends beyond nodes : for any smooth point @xmath282 , we denote by @xmath283 the inseparable component of @xmath12 that contains @xmath284 ; we say @xmath284 ( or @xmath283 ) separates or lies between @xmath278 and @xmath279 if @xmath278 and @xmath280 lie in different connected components of @xmath285 .    for a nodal elliptic curve @xmath12 and two distinct smooth points @xmath203 and",
    "@xmath205 on the core of @xmath12 , we have h^0 ( c , _ c(a - b))=",
    "0 h^1 ( c , _",
    "c(a - b))= 0 ; for any point @xmath286 of @xmath12 distinct from @xmath287 , we have h^0 ( c , _ c(+ a - b))= 1 h^1 ( c , _ c(+ a - b))= 0 .",
    "let @xmath288 be a scheme , @xmath117 a cartier divisor of @xmath288 , and @xmath289 a closed subscheme of @xmath288 .",
    "we will write @xmath290 for the restriction @xmath291 .",
    "our aim is to describe the structure of @xmath292 ; we let @xmath293 in the rest of this section .",
    "when we investigate the structure of @xmath1 via @xmath294 , we will specialize to @xmath295 .",
    "consider the substack @xmath296 of the artin stack @xmath17 of pairs @xmath18 of nodal elliptic curves with effective degree @xmath2 divisors @xmath19 .",
    "let @xmath297 be a point with the divisor @xmath117 simple and supported on the smooth locus of @xmath12 .",
    "we let @xmath298 be a smooth chart containing @xmath128 . again , let @xmath142 be the tautological family over @xmath143 with @xmath299 for some point @xmath145 and @xmath300 be the projection ; set @xmath147 . as in [ a ] , we choose a general section @xmath301 of @xmath152 and this time around also an additional general section @xmath302 of @xmath152 such that they are disjoint from @xmath153 and pass through the core of every fiber of @xmath152 .",
    "this is possible after shrinking @xmath143 if necessary . by the mittag - leffler exact sequence ,",
    "the sheaf @xmath303 over @xmath143 is the kernel sheaf of : _ * ( ) _ * _ ( ) .",
    "the complex of locally free sheaves of @xmath304-modules @xmath305=[\\rho _ * \\sl(\\ca ) \\mapright{\\psi } \\rho_*\\so_{\\ca}(\\ca)]\\ ] ] has sheaf cohomology @xmath306 $ ] .",
    "further , for any scheme @xmath307 with the induced family @xmath308 since @xmath309 , by cohomology and base change , @xmath310).\\ ] ]    to get hold of the sheaf @xmath51 , we shall study the local structure of the homomorphism . as in [ simpldivisor]-[deform ] , we only need to consider the case that @xmath117 is a smooth simple divisor on @xmath12 ; we will assume that this holds .",
    "we may also assume that @xmath143 is affine .",
    "after shrinking @xmath143 and an tale base change if necessary , we may assume that @xmath311 , where @xmath312 are disjoint sections of the family @xmath152 .",
    "to the sheaf @xmath313 , the standard inclusion @xmath314 provides us a section @xmath315 , called the obvious section . to capture other sections",
    ", we consider the inclusion of sheaves @xmath316 and the induced inclusions @xmath317 both are locally free since @xmath318 and @xmath319 by . by riemann - roch , @xmath320 is invertible and the rank of @xmath321 is @xmath322 .",
    "we then let @xmath323 and @xmath324 be the evaluation homomorphisms . obviously , @xmath325 . since @xmath143 is assumed affine , the sheaf @xmath326 .",
    "we have    1 .",
    "@xmath327 ; 2 .",
    "@xmath328 ; 3 .",
    "@xmath329 is an isomorphism , and @xmath330    consequently , the sheaf @xmath331 is a direct sum of @xmath304 with the kernel of the homomorphism @xmath332    taking the direct image of the exact sequence @xmath333 we obtain the exact sequence @xmath334 clearly , @xmath335 . also , @xmath336 is surjective because the obvious section @xmath337 maps surjectively onto @xmath338 . finally , because @xmath143 is affine , @xmath339 .",
    "therefore , the sequence @xmath340 is exact and splits .",
    "this proves ( 1 ) .",
    "the second is obvious .",
    "we now obtain the third .",
    "since both sheaves @xmath341 and @xmath342 are locally free , we only need to show that for any closed @xmath343 , @xmath344 is an isomorphism . because @xmath345 of @xmath346 and @xmath347 are zero , by base change , this is equivalent to that the tautological homomorphism @xmath348 is an isomorphism . because both sides are of equal dimensions , it suffices to show that it is injective . for this , we look at the composite of @xmath349 with @xmath350 obviously , @xmath351 for @xmath352 and is an isomorphism for @xmath353 .",
    "this shows that @xmath354 is injective .",
    "this proves the last claim of the lemma .",
    "the homomorphism @xmath355 then is completely determined by the homomorphism _",
    "i _ i : _ i _ * _ i _ ( + - )",
    "_ * _ ( ) .",
    "the homomorphism _ i : _ * _ i _ * _ ( ) will be our focus in the next subsection .      our strategy is to find an explicit expression for @xmath356 so that its vanishing locus has precise geometric meaning . for this",
    ", we need some regular functions associated to the smoothing of nodes . by the deformation theory of nodal curves , for each separating node @xmath357 there is a regular function @xmath358 so that @xmath359 is the locus where the node @xmath275 is not smoothed ; the divisor @xmath360 is an irreducible smooth cartier divisor .    for any @xmath361",
    ", we introduce @xmath362 we then collect all the nodes @xmath275 that lie between @xmath363 and @xmath203 ( cf .",
    "[ nodes ] ) and form the product of their associated functions @xmath364 : _ [ , a]=_qn_[_i , a]_q . in case @xmath365}=\\emptyset$ ] , we set @xmath366}=1 $ ] .",
    "there are trivializations @xmath367 and @xmath368 such that the homomorphism @xmath356 is given by _ i= _ [ _ i , a ] : _ * _ i _ * _ ( ) .",
    "since @xmath143 is affine , we fix a trivialization @xmath369 , and keep the trivialization @xmath370 mentioned before . this way , @xmath371 then the proposition is equivalent to that as divisors , _ i ( 0)=_q n_[_i , a]_q(0)= _ q n_[_i , a ] _ q.    we next let @xmath372 be either a point or a smooth affine curve , we let @xmath373 be @xmath374 over @xmath375 , and let @xmath376 be the corresponding pull back divisors . since @xmath377 , by cohomology and base change , the natural homomorphism @xmath378 is an isomorphism .",
    "finally , let @xmath379 be the composite @xmath380 then , if @xmath375 is a smooth curve not contained in @xmath381 , as divisors , @xmath382    we now prove the claim .",
    "first let @xmath375 be a smooth point away from @xmath383 } } \\sigma_q$ ] .",
    "then @xmath384 , @xmath385 , and @xmath386 lie in the same inseparable component of @xmath387 .",
    "therefore @xmath388 and @xmath389 because @xmath390    if @xmath375 is a smooth point in @xmath360 for some @xmath391}$ ] , then @xmath385 and @xmath386 lie in different inseparable components of @xmath387 .",
    "this time , @xmath392 .",
    "therefore , for the same reason as above , @xmath393 .",
    "this proves that @xmath356 vanishes exactly along @xmath383 } } \\sigma_q$ ] .",
    "it remains to show that @xmath356 vanishes at first order only along @xmath360 , @xmath394}$ ] . to prove this we only need to study @xmath356 near a general point @xmath395 .",
    "we let @xmath396 be an affine curve passing through @xmath397 and transversal to @xmath360 at @xmath398 . after shrinking @xmath399 if necessary ,",
    "the family @xmath400 is the blowup of a family of smooth elliptic curves @xmath401 at a point @xmath402 .",
    "we let @xmath403 be the projection and let @xmath404 be the rational component , which is also the exceptional divisor of @xmath387 .",
    "let @xmath405 , @xmath406 , and @xmath407 be the image divisors in @xmath408 . then @xmath409 further , since @xmath410 , the cokernel of the inclusion _",
    "r__r(_r , i-_r+_r)_r__r(_r , i+_0-_r+_r ) is @xmath411 , which is isomorphic to @xmath412 .",
    "therefore , since @xmath413 , @xmath379 factors through a homomorphism @xmath414 as shown in the commutative diagram @xmath415 since the lower horizontal arrow is an isomorphism , @xmath414 is an isomorphism .",
    "combined with that the cokernel of is @xmath412 , this proves that @xmath379 has precisely order one vanishing at @xmath399 .",
    "for the convenience of reference , we record an immediate consequence of proposition [ keyprop ] .",
    "there are trivializations @xmath367 and @xmath416 such that the homomorphism @xmath25 is given by _",
    "i=1^m _ i : _ i=1^m _ * _ i _ * _ ( ) , _",
    "[ _ i , a ] .    the homomorphism can be further simplified .",
    "recall that @xmath143 is a neighborhood of @xmath417 .",
    "the pair @xmath128 induces a weighted curve @xmath250 with @xmath418 .",
    "we let @xmath182 be the terminally weighted tree of @xmath250 with terminal vertices @xmath419 according to our convention , each non - root vertex @xmath420 corresponds to a connected subcurve @xmath421 ( c.f .  [ reducedgraph ] ) ; on the subcurve @xmath253 there is a unique separating node @xmath275 of @xmath12 that separates @xmath253 and the remainder part @xmath422 .",
    "we call this node @xmath275 the node associated to @xmath187 .",
    "with such node identified , for each vertex @xmath187 we define @xmath423 where @xmath275 the associated node of @xmath187 . for any terminal vertex @xmath424",
    ", we let @xmath425 } =   \\prod_{i \\succeq v\\succ o}\\zeta_v.\\ ] ]    the direct image sheaf @xmath426 is a direct sum of @xmath427 with the kernel sheaf of the homomorphism _ i=1^_i:_^ _ , _ i=_[i , o ] .",
    "we express @xmath117 as @xmath428 , and continue to denote by @xmath429 the terminal vertices of @xmath182 . by our construction of the terminally weighted tree @xmath182 of the weighted curve @xmath250 of the pair @xmath18 ( cf .",
    " [ reducedgraph ] ) , each @xmath200 is associates to a connected tree @xmath430 of rational curves ; there is a unique irreducible component @xmath431 of @xmath430 closest to the core of @xmath12 .",
    "again , by the construction of @xmath182 , at least one of @xmath432 lies on @xmath431 ; we pick one and index it by @xmath363 .",
    "further , for every @xmath433 , there is @xmath434 , such that @xmath363 is between the point @xmath203 ( of the core curve of @xmath12 ) and @xmath435 ( @xmath363 and @xmath435 can be on the same irreducible component ) .",
    "this shows that @xmath366 } | \\zeta_{[\\delta_j , a]}$ ] ; thus , every @xmath436}$ ] is divisible by one of @xmath437},\\cdots,\\zeta_{[\\delta_\\ell , a]}$ ] .",
    "thus in the expression , we can choose a new basis for @xmath438 so that with respect to the new trivialization @xmath439_j=1^m _ j_^m , @xmath439 the homomorphism @xmath440 has the form @xmath441 together with lemma [ lemm : usefulfacts ] and corollary [ maincoro ] , this proves the theorem .",
    "in this section , we prove the theorems stated in  2 . in the meantime , we describe local defining equations for @xmath1 in terms of weighted trees .",
    "recall that in theorem [ thm : equ1 ] , for any @xmath4\\in\\mpd$ ] we first pick a small open subset @xmath4\\in u\\sub \\mpd$ ] and a homogeneous coordinate @xmath134 $ ] of @xmath0 so that the pull back divisor @xmath442 $ ] is a family of simple divisors on the domain family @xmath97 of the universal family @xmath443 of @xmath131 ; the family @xmath97 coupled with the divisor @xmath444 $ ] defines a tautological morphism @xmath445 .",
    "we next pick a smooth chart @xmath446 so that its image contains the image of @xmath141 .",
    "let @xmath447 .",
    "we now construct the promised open immersion : _ .",
    "we let @xmath455 be the composition of the projection @xmath456 with @xmath457 ; let @xmath458 , @xmath459 , be the pull back sections in @xmath460 . according to our convention , @xmath461 is the section @xmath246 induced by the inclusion @xmath462 .",
    "this way , all other @xmath463 , @xmath464 , are canonically defined .",
    "as mentioned in [ a ] , we have a section @xmath301 of @xmath152 .",
    "its pull back section in @xmath465 is @xmath466 . because @xmath467 , by the cohomology and base change theorem , we have canonical isomorphism ^ * _ * ( ) ",
    "_ * ( ) .",
    "we let @xmath468 be the inclusion .",
    "then @xmath469 is a section of @xmath470 . on the other hand ,",
    "since @xmath471 is the vector bundle @xmath472 , defining a @xmath143-morphism @xmath473 is equivalent to giving a section of the pull back sheaf @xmath474 .",
    "we define the morphism @xmath106 in to be the one induced by the homomorphism ( s)=((s_1),,(s_n)):_()^n . to complete the proof , we need to show that @xmath106 factors through @xmath475 and the factored morphism @xmath476 is an open immersion .",
    "we first check that @xmath106 factors . by definition ,",
    "@xmath106 factors if the pull back @xmath477 .",
    "let @xmath478 be the projection . by definition",
    ", @xmath479 is the composite @xmath480 where @xmath481 is the tautological section and @xmath482 is the restriction homomorphism .",
    "therefore , @xmath483 is the composite @xmath484 since @xmath485 , @xmath486 is the composite @xmath487 therefore @xmath483 is the composite @xmath488 since @xmath489 , we get @xmath490 .",
    "this proves that @xmath106 factors through @xmath491    we next prove that @xmath492 is an open immersion .",
    "we let @xmath493 and let @xmath494 be the tautological immersion . because @xmath471 is the total space of the vector bundle @xmath472 on @xmath143 , the morphism @xmath495 is equivalent to giving a section ( homomorphism ) @xmath496 at the same time , @xmath497 is equivalent to the vanishing of the composite of the homomorphisms : _ z p()^n p(()^n| _ ) .",
    "we remark that because @xmath498 , by the universality property of morphisms to @xmath471 , ^*(s_)=(s ) : _ ^*p()^n ( ) ^n .    to continue",
    ", we will show that the vanishing provides us a family of stable morphisms parameterized by an open subset of @xmath289 that contains @xmath499 .",
    "we let @xmath500 because @xmath501 , by the cohomology and base change theorem , we have the canonical identity @xmath502 this identity transforms into _ _ z  ( _ z)^n  ( _ z)^n|__z .",
    "because @xmath503 is zero and the kernel of the second arrow is @xmath504 , @xmath505 factors through a unique homomorphism s=(s_1,,s_n  ) : _ _ z^n . let @xmath506 be the section @xmath246 of @xmath507 .",
    "the @xmath508 sections @xmath509 considered as sections of @xmath510 on @xmath511 define a morphism [ s_0,,s_n  ] : _ z \\{s_0== s_n=0}.    to analyze the domain of this morphism , we notice that due to , the morphism [ s_0,,s_n]=[s_0,,s_n] : =_u=_u , where @xmath512 is the lift of @xmath492 to @xmath465 .",
    "therefore @xmath513 because @xmath514 is proper , there is an open @xmath515 containing @xmath499 so that @xmath516 we let @xmath517 be the restriction of to @xmath518 .",
    "finally , because restricting to @xmath499 this morphism is a family of stable morphisms , possibly after shrinking @xmath519 if necessary , @xmath520 is a family of stable morphisms .",
    "we let @xmath521 be the tautological morphism induced by the family @xmath520 .",
    "because of the identity , the composite of @xmath522 with @xmath523 is identical to the projection @xmath524 . therefore , if we let @xmath525 @xmath526 is open and @xmath492 factor through @xmath527    we claim that , with @xmath526 endowed with the open subscheme structure of @xmath289 , the morphism @xmath528 is an isomorphism . to prove this",
    ", we will construct the inverse of @xmath528 .",
    "let @xmath529 be the morphism induced by @xmath530 .",
    "because the composite @xmath529 with the tautological @xmath141 is identical to the composite of @xmath531 with @xmath446 , the pair @xmath532 lifts to a morphism @xmath533 because of the identity , the composite @xmath534 is identical to the projection @xmath535 .",
    "this implies that @xmath536 . on the other hand",
    ", @xmath537 is exactly the inclusion @xmath538 , again due to the identity , therefore @xmath539 .",
    "thus @xmath528 is an isomorphism .",
    "this proves the theorem .",
    "the first is in a direct form : to every non - root vertex @xmath541 , we associate the coordinate function of @xmath542 indexed by @xmath203 : @xmath543 . to a terminal vertex @xmath544 , we associate @xmath545 coordinate functions @xmath546 .",
    "we then set @xmath547}w_{b , e},\\quad z_{[b , o]}=   \\prod_{b \\succeq a \\succ o } \\zetaz_a.\\ ] ] we make a convention that if @xmath548 , we define @xmath549 and hence @xmath550 .",
    "the second is by induction on @xmath551 .",
    "_ if @xmath203 is a terminal vertex , we set @xmath552 with @xmath553 as before . if @xmath554 $ ] with @xmath555 having roots @xmath200 , then set @xmath556 _",
    "the third is in terms of the bracket representation of @xmath182 .",
    "each @xmath557 is derived from @xmath182 by dropping the root @xmath183 , replacing each ghost vertex @xmath203 by its associated function @xmath558 , replacing each terminal vertex @xmath205 by @xmath559 , replacing `` , '' by `` @xmath560 '' , and replacing `` [ '' `` ] '' by `` ( '' `` ) '' .",
    "the resulting expression @xmath557 is identical to the one from the second method .    take @xmath209 $ ] ( see the first tree in figure 1 ) .",
    "the domain of a generic @xmath561 in @xmath262 has a genus-1 ghost component labelled by the root @xmath183 , a genus zero ghost component labelled by @xmath205 , and three rational tails labelled by @xmath203 , @xmath204 and @xmath2 , respectively .",
    "the tails @xmath203 are attached to the genus 1 ghost component .",
    "tails @xmath204 and @xmath2 are attached to the rational component @xmath205 . by the first approach , @xmath562 by the second , @xmath563 } = \\zetaz_aw_{a ,",
    "e}+\\zetaz_b(\\zetaz_cw_{c , e}+\\zetaz_dw_{d , e}).\\ ] ] by the third , @xmath564    we now describe the local model of the singularity type of @xmath1 near @xmath262 .",
    "we let @xmath565 where @xmath566 ( resp .",
    "@xmath265 ) is the cardinality of @xmath185 ( resp .",
    "@xmath186 ) .",
    "the expressions @xmath557 then become regular functions on @xmath567 after we identify @xmath568 with the coordinate function of the @xmath203-th copy of @xmath569 and identity @xmath570 with the coordinate function of the @xmath205-th copy of @xmath571 in the @xmath572-th component of the product @xmath573 .",
    "let @xmath4\\in\\mpd$ ] be a closed point with associated terminally weighted rooted tree @xmath182 .",
    "we let @xmath582 be as in theorem [ thm : equ1 ] .",
    "theorem [ thm : key ] provides trivializations @xmath583 so that the restriction homomorphism @xmath584 is given by @xmath585}\\oplus 0 : \\bl\\oplus_{b\\in \\vg^t}\\so_\\cv\\br \\oplus \\so_\\cv^{\\oplus ( d-\\ell+1 ) } \\lra\\so_\\cv.\\ ] ]    the composite homomorphism @xmath586 induces a morphism @xmath587 the regular functions @xmath588 define a morphism = _ a_a : _ a = v_. together , they define a morphism : _ _ b^t^ne_= v_(_b^t^n .",
    "we comment that since deformations of nodal curves are unobstructed , the morphisms @xmath414 and @xmath589 are smooth .      finally , because @xmath591 is smooth and @xmath592 is an open immersion , and thus smooth , the composite ( f=0)_z_e_is smooth . also , it is clear that a lift @xmath593 of @xmath259\\in\\mpd_\\gamma$ ] is mapped to a point in @xmath594 .",
    "this proves that @xmath1 has singularity type @xmath182 at @xmath258 $ ] .      for the purposes of keeping track of blowups of @xmath1 , we need to classify the singularity types of the blowups of @xmath574 .",
    "such types will be classified by simple weighted rooted trees that are monoidal transformations and collapsings of @xmath182 .",
    "we first classify the singularity types of the space @xmath574 for a simple terminally weighted tree @xmath182 .",
    "the singularity type of a @xmath595 is defined by its associated tree @xmath596 .",
    "let @xmath595 ( resp .",
    "@xmath597 ) and let @xmath598 ( resp .",
    "@xmath599 ) be its coordinate representation .",
    "the non - vanishing of @xmath568 identifies a subset of @xmath185 : @xmath600 we let @xmath596 be the collapsing of @xmath182 at vertices in @xmath601 .",
    "we now investigate the blowing up of @xmath574 .",
    "let @xmath602 it is clear that @xmath603 is smooth and locally closed .",
    "in general , the closure @xmath604 of @xmath605 in @xmath606 is quite complicated .",
    "however , in the case when @xmath607 , @xmath604 is smooth and bears a simple description .",
    "let @xmath616 be the trunk of @xmath182 and let @xmath617 be the direct - descendants of the branch point @xmath217 .",
    "then @xmath605 consists of those @xmath599 so that @xmath618 its closure is given by the vanishing of all @xmath619 : _ ,",
    "k=\\{_a_1==_a_k=0}. by the definition of @xmath596 , @xmath620 if and only if @xmath621 .",
    "the second claim is clear .",
    "we now consider the blowup of @xmath606 along @xmath604 in the case @xmath622 .",
    "we let @xmath623= o[v_1[\\cdots[v_r[\\gamma_1,\\cdots,\\gamma_k]]\\cdots]],\\ ] ] and let @xmath624 be the root of @xmath625 ; thus , @xmath626 are the direct descendants of the branch point @xmath217 of @xmath182 . accordingly , _ , e(z , w)=(z_v_1z_v_r)(z_a_1__1,e + + z_a_k__k , e ) .",
    "we denote the blowup of @xmath606 along @xmath604 by @xmath627}$ ] and define @xmath628}=z_\\gamma\\times_{v_\\gamma } v_{\\gamma,[k]}.\\ ] ] the scheme @xmath629}$ ] is a subscheme of @xmath630 defined by the equations @xmath631 for @xmath632 .",
    "( here @xmath633 $ ] is the homogeneous coordinate on @xmath634 . ) in the affine open subset @xmath635 , we have @xmath636 for @xmath637 .",
    "thus , over this chart , @xmath629}$ ] is defined by ( z_v_1z_v_r)_a_i ( _ _ i , e + _ j i u_j _ _",
    "j , e ) = 0 , 1 e n.    there are two cases . if @xmath625 is a single - vertex tree , then becomes ( z_v_1z_v_r_a_i ) ( w_a_i , e + _",
    "j i u_j _ _ j , e ) = 0 , 1 e n. after introducing @xmath638 , becomes z_v_1z_v_r_i w_a_i , e=0 , 1 e n. this is the system associated to the tree @xmath639 $ ] , a path tree containing vertices @xmath640 .",
    "it is also the advancing @xmath624 in @xmath182 and thus is in @xmath226 .",
    "this shows that @xmath641 } \\cap \\{u_i=1\\ } \\cong z_{\\gamma'}$ ] .    if @xmath625 is a nontrivial rooted tree and is of the form @xmath642 $ ] , where @xmath643 because @xmath182 is simple by assumption , the system becomes ( z_v_1z_v_r)_a_i ( _ s=1^m _ b_s _ _ s,e+ _ j i u_j _ _ j , e ) = 0,1en , where @xmath644 is the root of @xmath645 . after replacing @xmath646 by @xmath647 , ( noticing that the system does not contain the variables @xmath619 , )",
    "this is the system associated to the tree @xmath648 that is obtained from @xmath182 by advancing the vertex @xmath624 .",
    "this shows that @xmath641 } \\cap \\{u_i=1\\ } \\cong z_{\\gamma'}$ ] .",
    "consider @xmath209 $ ] .",
    "then we have @xmath654 we blow up @xmath574 along the locus @xmath655 the blown - up is a subspace of @xmath656 defined by equations @xmath657 , where @xmath658 $ ] are the homogeneous coordinates of @xmath659 . in the affine open subset @xmath660 ,",
    "the equation @xmath661 becomes @xmath662 it has normal crossing singularities , and the resulting system is associated to the tree @xmath663 $ ] , the advancing of @xmath203 of @xmath664 $ ] . in the affine open subset @xmath665 ,",
    "the equation @xmath661 becomes @xmath666 this is the system associated to the tree @xmath667 $ ] , the advancing of @xmath205 of @xmath664 $ ] .",
    "we begin with recalling the notations and facts about the blown - up @xmath100 . in [ theta ]",
    ", we introduced @xmath80 that is a smooth locally closed substack of @xmath88 of ghost core elliptic curves attached on @xmath36 distinct smooth points with @xmath36-rational tails ; @xmath34 is the closure of @xmath80 . in [ inductive - blowups ] , we successively blow up @xmath88 along proper transforms of @xmath34 .",
    "inductively , after obtaining @xmath84}$ ] , we blow it up along the proper transform @xmath668 } \\subset \\fm\\uwt_{1,[k-1]}$ ] of @xmath669 .",
    "we denote by @xmath670 } \\sub \\fm\\uwt_{1,[k]}$ ] the proper transform of @xmath671 .",
    "we let @xmath672}\\sub \\fm\\uwt_{1,[k]}$ ] be the exceptional divisor of the @xmath673}\\to \\fm\\uwt_{1,[k-1]}$ ] .",
    "finally , we denote @xmath91 the resulting limit stack .",
    "as the image of @xmath674 is disjoint from @xmath34 for @xmath675 , the fiber product @xmath100 can be defined after @xmath2-th blowing up of @xmath88 : @xmath103}.\\ ] ] to pave a way for our proof , we also need to record the intermediate blowup spaces .",
    "for this , we introduce for @xmath676 @xmath677 } = \\mpd \\times_{\\fmw } \\fm\\uwt_{1,[k]}.\\ ] ]      to each closed point @xmath679}$ ] we can find a graph @xmath680}$ ] and a smooth morphism @xmath681}$ ] whose image contains @xmath682 of which the following holds : + ( i ) .",
    "there are smooth chart @xmath683}\\uwt$ ] and smooth morphisms @xmath684 , @xmath685 , @xmath686 , and @xmath687 shown below , making",
    "the diagram commutative @xmath688}\\\\ @vv{\\psi_\\gamma}v @vv{p_\\gamma}v @vvv\\\\ v_\\gamma @<{\\phi_\\gamma } < < \\cv_\\gamma @ > > > \\fm_{1,[k]}\\uwt ; \\end{cd}\\ ] ] ( ii ) for any @xmath689 , @xmath690}\\uwt}\\mathring\\theta_i =   w_{\\ga}\\times_{v_{\\ga}}\\mathring\\pi_{\\ga , i}.\\ ] ]    the proof is by induction on @xmath36 . in the case",
    "@xmath243 , the desired morpisms are provided in the proof of theorem [ thm : localequtree ] .",
    "suppose @xmath608 and the lemma holds for a closed point @xmath691}$ ] .",
    "let @xmath692 etc .",
    ", be the corresponding data provided by the statement of the lemma .",
    "if @xmath613 or @xmath614 , then @xmath693}$ ] , while by ( ii ) with @xmath36 replaced by @xmath694 and lemma 5.12 @xmath695}\\uwt}\\theta_k= \\eset.\\ ] ] thus , @xmath682 does not lies over the blowing up center of @xmath89}\\uwt$ ] , and is in @xmath696}$ ] . by shrinking @xmath692 if necessary , the morphism @xmath697 ( provided by the inductive assumption ) lifts to @xmath698}$ ] and the @xmath36-version of the statements ( i ) and ( ii ) are identical to its @xmath699-version .    if @xmath609 , we define @xmath700}$ ] to be the fiber product using the right square of ( see below ) . by the property ( ii ) and the construction of the blowups @xmath701}\\uwt\\to\\fm_{1,[k-1]}\\uwt$ ] and @xmath627}\\to v_\\gamma$ ]",
    ", there is a unique @xmath702}$ ] making the left square a fiber product :      this shows that @xmath703}\\uwt } \\fm_{1,[k]}\\uwt = w_\\gamma\\times_{v_\\gamma } v_{\\gamma,[k]},\\ ] ] which is smooth over @xmath629}=z_\\gamma\\times_{v_\\gamma } v_{\\gamma,[k]}$ ] .",
    "therefore , by lemma 5.14 @xmath704}\\uwt } \\fm_{1,[k]}\\uwt$ ] is covered by smooth morphisms @xmath705}\\uwt } \\fm_{1,[k]}\\uwt\\ ] ] with @xmath706}$ ] that satisfy the statements of the lemma . finally , because @xmath707}=\\widetilde{m}_1(\\pn , d)_{[k-1]}\\times_{\\fm_{1,[k-1]}\\uwt } \\fm_{1,[k]}\\uwt,\\ ] ] the lemma follows .",
    "we now describe a stratification of @xmath100 .",
    "we define an equivalence relation on @xmath708}$ ] by demanding that @xmath709 if @xmath182 is isomorphic to @xmath182 as rooted but unweighted trees .",
    "note that @xmath692 and @xmath710 has isomorphic germs at their origin if and only if @xmath711 . for @xmath680}$",
    "] , we denote by @xmath712 $ ] the equivalence class of @xmath182 in @xmath204 .    for any point @xmath713}$ ] , we let @xmath714 } ) \\and ( \\eta , w_\\ga ) \\lra ( x , z_\\gamma)\\ ] ] be the smooth morphisms provided by the previous lemma .",
    "we define @xmath715= [ \\gamma_x]$ ] . by the comment in the previous paragraph ,",
    "the equivalence class @xmath715 $ ] is independent of the choice of the chart covering @xmath716 .",
    "therefore , we can define @xmath717 , [ k ] } = \\{\\xi \\in \\wmpd_{[k ] } \\mid [ \\gamma_\\xi]= [ \\gamma]\\}.\\ ] ] in general , @xmath718 , [ k]}$ ] is a disjoint union of closed substacks .              for each @xmath724}$ ] , it follows from the proof of lemma [ adhoc ] that to each @xmath725 , we can find an tale @xmath726 , a scheme @xmath727 and a smooth morphism @xmath728 with an open embedding @xmath729 .",
    "let @xmath730 be induced by . by the same reasoning as in the proof of theorem [ thm : localequtree ] , if we let @xmath731 and @xmath732 be the natural morphism ( similarly defined as ) , then @xmath733 since @xmath734}$ ] , @xmath182 is of the form @xmath735]$ ] with @xmath736 .",
    "hence each @xmath737 this proves the theorem .",
    "finally , since the primary component @xmath738 of @xmath739 is irreducible and of dimension @xmath740 , thus the primary component @xmath105 of @xmath100 , which is the proper transform of @xmath738 , is smooth and is defined by @xmath741 in each chart .        * theorem [ thm : m2 ] . * _ for any @xmath742 , the direct image sheaf @xmath743 is locally free over every component @xmath111 where @xmath106 is either 0 or a partition of @xmath2 .",
    "it is of rank @xmath744 when @xmath113 and of rank @xmath745 otherwise . _    for @xmath746",
    ", we set @xmath747 and follow the notations introduced earlier .",
    "we let @xmath748 be any point and let @xmath749 its image . we pick a local chart @xmath159 of @xmath750 , and introduce @xmath751",
    "then @xmath752 is a chart of @xmath100 .",
    "continue to write @xmath142 the tautological family over @xmath143 , we set @xmath753 here the second equality in each set of identities follows from the universality of @xmath17 .",
    "we let @xmath754 and @xmath755 .",
    "the square        for @xmath25 , by it is the direct sum of the zero homomorphism on @xmath304 with @xmath759}.\\ ] ] therefore , @xmath757 is given by a direct sum of the zero homomorphism with the pullbacks of @xmath760}$ ] .",
    "we now let @xmath761\\cdots ] ] \\in \\lambda_{d , [ d]}$ ] be the tree associated to @xmath762 and let @xmath182 be the tree associated to @xmath716 . by lemma [ adhoc ] , to @xmath763}$ ] we can find an tale neighborhood @xmath764 and a scheme @xmath765 with smooth morphisms @xmath766 ( we can assume @xmath767 . ) by the inductive construction of [ induc - blowup ] , we know that the tree @xmath229 is obtained from @xmath182 by successively advancing vertices until a terminal vertex is advanced .",
    "assume that @xmath768 is the terminal vertex ( in @xmath182 ) that is advanced in the last step ( here we adopt the indexing scheme as arranged in the proof of theorem [ thm : key ] ) .",
    "then by following the same inductive construction of [ induc - blowup ] step by step , we obtain @xmath439^*_i= z_v_1 z_v_r ^*_i",
    "| ^*_j .@xmath769 _ * ( ) = ^ * _ * ( ) = _",
    "^*_*_i _ w_^m+1,@xmath439 we see that the kernel of @xmath757 is a direct sum of @xmath770 with the kernel of the homomorphism @xmath771    now if @xmath772 , then @xmath773 does not vanish at general points of @xmath774 .",
    "hence the kernel sheaf of @xmath757 is locally free of rank @xmath322 over @xmath774 .",
    "if @xmath775 for @xmath106 a partition of @xmath2 , then , one of @xmath776 vanishes along @xmath777 .",
    "hence the kernel sheaf of @xmath757 is locally free of rank @xmath778 over @xmath777 .",
    "this proves the theorem .      finally , we point out that all the main results in this paper generalize directly to moduli space of genus one stable maps with marked points .",
    "this extension requires introducing blowup loci involving the marked points analogous to those described in @xcite .",
    "m. kontsevich , _ enumeration of rational curves via torus actions .",
    "_ in : the moduli space of curves , ed . by r. dijkgraaf , c. faber ,",
    "g. van der geer , progress in math .",
    "129 , birkhuser , 1995 , 335368 ."
  ],
  "abstract_text": [
    "<S> we describe an algebro - geometric approach to vakil - zinger s desingularization of the main component of the moduli of genus one stable maps to @xmath0 @xcite . </S>",
    "<S> the new approach provides complete local structural results for this moduli space as well as for the desingularization of the entire moduli space and should fully extend to higher genera . </S>"
  ]
}