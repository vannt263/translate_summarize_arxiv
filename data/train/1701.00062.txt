{
  "article_text": [
    "mesoscopic analysis methods @xcite are among the most valuable tools available to applied network scientists and theorists alike .",
    "their aim is to identify regularities in the structure of complex networks , thereby allowing for a better understanding of their function @xcite , their structure @xcite , their evolution @xcite , and of the dynamics they support @xcite .",
    "community detection is perhaps the best - known method of all @xcite , but it is certainly not the only one of its kind @xcite .",
    "it has been shown , for example , that the separation of nodes in a core and a periphery occurs in many empirical networks @xcite , and that this separation gives rise to more exotic mesoscopic patterns such as overlapping communities @xcite .",
    "this is but an example  there exist multitudes of decompositions in structures other than communities that explain the shape of networks both clearly and succinctly @xcite .",
    "the stochastic block model ( sbm ) has proven to be versatile and principled in uncovering these patterns @xcite . according to this simple generative model ,",
    "the nodes of a network are partitioned in blocks ( the _ planted partition _ ) , and an edge connects two nodes with a probability that depends on the partition .",
    "the sbm can be used in any of two directions : either to generate random networks with a planted mesoscopic structure @xcite , or to infer the hidden mesoscopic organization of real complex networks , by fitting the model to network datasets @xcite  perhaps its most useful application .",
    "stochastic block models offer a number of advantages over other mesoscopic pattern detection methods @xcite .",
    "one , there is no requirement that nodes in a block be densely connected , meaning that blocks are much more general objects than communities .",
    "two , the sound statistical principles underlying the sbm naturally solve many hard problems that arise in network mesoscopic analysis ; this includes the notoriously challenging problem of determining the optimal number of communities in a network @xcite , or of selecting among the many possible descriptions of a network @xcite .",
    "another consequence of the statistical formulation of the sbm is that one can rigorously investigate its limitations .",
    "it is now known , for example , that the sbm admits a _ resolution limit _",
    "@xcite akin to the limit that arises in modularity  based detection method @xcite .",
    "the limitations that have attracted the most attention , however , are the _ detectability limit _ and the closely related concept of _ consistency limit _ @xcite .",
    "the sbm is said to be detectable for some parameters if an algorithm can construct a partition correlated with the planted partition , using no information other than the structure of a single  infinitely large  instance of the model .",
    "it is said to be consistent if one can _ exactly _ recover the planted partition . therefore , consistency begets detectability , but not the other way around .",
    "understanding when and why consistency ( or detectability ) can be expected is important , since one can not trust the partitions extracted by sbm if it operates in a regime where it is not consistent ( or detectable ) @xcite .    due to rapid developments over the past few years",
    ", the locations of the boundaries between the different levels of detectability are now known for multiple variants of the sbm , in the limit of infinite network sizes .",
    "if the average degree scales at least logarithmically with the number of nodes , then the sbm is consistent @xcite , unless the constant multiplicative factor is too small , in which cas the sbm is then detectable , but not consistent .",
    "if the average degree scales slower than logarithmically , then the sbm is at risk of entering an _ undetectable _ phase where no information on the planted partition can be recovered from the network structure @xcite .",
    "this happens if the average degree is a sufficiently small constant independent of the number of nodes .",
    "these asymptotic results are , without a doubt , extremely useful .",
    "many efficient algorithms have been developed to extract information out of hardly consistent instances @xcite .",
    "striking connections between the sbm and other stochastic processes have been established in the quest to bound the undetectable regime from below @xcite .",
    "but real networks are not infinite objects .",
    "thus , many of the findings of these asymptotic theories do not carry over to real networks ",
    "one can only _ assume _ that the asymptotic derivations are robust enough to inform us on finite cases .",
    "the objective of our contribution is to investigate detectability in _",
    "finite _ networks generated by the sbm .",
    "the remainder of the paper is organized as follows .",
    "we begin by formally introducing the sbm and the necessary background in sec .",
    "[ section : stochastic_block_model ] .",
    "we use this section to briefly review important notions , including inference ( sec .",
    "[ subsection : stochastic_block_model - inference ] ) , as well as the consistency and detectability of the infinite sbm ( sec .",
    "[ subsection : stochastic_block_model - related_work ] ) . in sec .  [ section : finite_limit ] , we present a necessary condition for detectability , and show that it is always met , on average , by finite instances of the sbm .",
    "we then establish the existence of a large equivalence class with respect to this notion of average detectability . in sec .",
    "[ section : eta - detectability ] , we introduce the related concept of @xmath0detectability and investigate the complete detectability distribution , beyond its average . in sec .  [",
    "section : case_study ] , we apply the perfectly general framework of secs .  [ section : finite_limit][section : eta - detectability ] to a constrained variant of the sbm : the general modular graph model of ref .",
    "the results of this section hold for a broad range of models , since the general modular graphs encompass the symmetric sbm , the planted coloring model and many other models as special cases .",
    "we gather concluding remarks and open problems in sec .",
    "[ section : discussion ] .",
    "two appendices follow .",
    "the first investigates the interplay between noise and our notion of average detectability ( appendix  [ appendix : noisy_sbm ] ) ; the second establishes a connection between our framework and random matrix theory ( appendix  [ appendix : connection_with_rmt ] ) .",
    "the stochastic block model is formally defined as follows : begin by partitioning a set of @xmath1 nodes in @xmath2 blocks of fixed sizes @xmath3 , with @xmath4 .",
    "denote this partition by @xmath5 , where @xmath6 is the set of nodes in the @xmath7^th^ block . then , connect the nodes in block @xmath6 to the nodes in block @xmath8 with probability @xmath9 . in other words",
    ", for each pair of nodes @xmath10 , set the element @xmath11 of the adjacency matrix @xmath12 to 1 with probability @xmath13 and to 0 otherwise , where @xmath14 is the block of @xmath15 .",
    "note that for the sake of clarity , we will obtain all of our results for simple graphs , where edges are undirected and self - loops ( edges connecting a node to itself ) are forbidden .",
    "this implies that @xmath16 and that @xmath17 .",
    "we will think of this process as determining the outcome of a random variable , whose support is the set of all networks of @xmath1 nodes . due to the independence of edges , the probability ( likelihood ) of generating a particular network @xmath18",
    "is simply given by the product of @xmath19 bernoulli random variables , i.e. , @xmath20^{1-a_{ij}}[p_{\\sigma(v_i)\\sigma(v_j)}]^{a_{ij}}\\;,\\ ] ] where @xmath21 is the @xmath22 matrix of connection probabilities of element @xmath9 ( sometimes called the affinity or density matrix ) , and @xmath23 is a shorthand for `` @xmath24 '' .",
    "it is easy to check that the probability is properly normalized over the set of all networks of @xmath1 distinguishable nodes .    a useful alternative to eq",
    ".   expresses the likelihood in terms of the number of edges between each pair of blocks @xmath25 rather than as a function of the adjacency matrix @xcite .",
    "notice how the number of edges @xmath26 appearing between the sets of nodes @xmath6 and @xmath8 is at most equal to @xmath27 each of these @xmath28 edges exists with probability @xmath9 .",
    "this implies that @xmath26 is determined by the sum of @xmath29 bernoulli trials of probability @xmath9 , i.e. , that @xmath26 is a binomial variable of parameter @xmath9 and maximum @xmath29 .",
    "the probability of generating a particular instance @xmath18 can therefore be written equivalently as @xmath30 where @xmath31 and @xmath32 are jointly determined by the partition @xmath33 and the structure of @xmath18 , and @xmath34 denotes `` @xmath35 '' .    having a distribution over all networks of @xmath1 nodes , one",
    "can then compute average values over the ensemble .",
    "for example , the average degree of node @xmath15 is given by @xmath36 where @xmath37 is the kronecker delta .",
    "the expression correctly depends on the block @xmath38 of @xmath15 ; nodes in different blocks will in general have different average degree .",
    "averaging over all nodes , one finds the average degree of the network @xmath39 this global quantity determines the density of the sbm when @xmath40 .",
    "the sbm is said to be dense if @xmath41 , i.e. , if @xmath9 is a constant independent of @xmath1 .",
    "it is said to be sparse if @xmath42 , i.e. , if @xmath43 goes to zero as @xmath44 . in the latter case , a node has a constant number of connections even in an infinitely large network  a feature found in most large scale real networks @xcite .    for finite instances",
    ", it will often be more useful to consider the average density directly .",
    "it is defined as the number of edges in @xmath18 , normalized by the number of possible edges , i.e. , @xmath45 where @xmath46 , and @xmath47 the dense versus sparse terminology is then clearer : the density of sparse networks goes to zero as @xmath48 , while dense networks have a nonvanishing density @xmath49 .      depending on the elements of @xmath21 , the sbm can generate instances reminiscent of real networks with , e.g. , a community structure @xcite ( @xmath50 ) or a core - periphery organization @xcite ( @xmath51 and @xmath52 ) .",
    "however , the sbm really shines when it is used to infer the organization in blocks of the nodes of real complex networks  this was , after all , its original purpose @xcite .    to have inferred the mesoscopic structure of a network ( with the sbm )",
    "essentially means that one has found the partition @xmath53 and density matrix @xmath54 that best describes it . in principle , it is a straightforward task , since one merely needs to ( a ) assign a likelihood @xmath55 to each pair of partition and parameters [ see eqs .",
    " ] , then ( b ) search for the most likely pair ( @xmath53 , @xmath54 ) . since there are exponentially many possible partitions , this sort of enumerative approach is of little practical use .",
    "fortunately , multiple approximate and efficient inference tools have been proposed to circumvent this fundamental problem .",
    "they draw on ideas from various fields such as statistical physics @xcite , bayesian statistics @xcite , spectral theory @xcite and graph theory @xcite , to name a few , and they all produce accurate results in general",
    ".      one could expect perfect recovery of the parameters and partition from most of these sophisticated algorithms .",
    "this is called the consistency property .",
    "it turns out , however , that all known inference algorithms for the sbm , as diverse as they might be , fail on this account .",
    "and their designs are not at fault , for there exists an explanation of this generalized failure .",
    "consider the density matrix of elements @xmath56 @xmath57 , it is clear that the block partition is irrelevant  the generated network can not and will not encode the planted partition .",
    "thus , no algorithm will be abe to differentiate the planted partition from other partitions .",
    "it is then natural to assume that inference will be hard or impossible if @xmath58 , where @xmath59 is a very small perturbation for networks of @xmath1 nodes ; there is little difference between the uniform case and this perturbed case .",
    "in contrast , if the elements of @xmath21 are widely different from one another , e.g. , if @xmath60 and @xmath61 for @xmath62 , then easy recovery should be expected .",
    "understanding where lies the transition between these qualitatively different regimes has been the subject of much recent research ( see ref .",
    "@xcite for a thorough survey ) . as a result",
    ", the regimes have been clearly separated as follows : ( i ) the undetectable regime , ( ii ) the detectable ( but not consistent ) regime and ( iii ) the consistent regime ( and detectable ) .",
    "it has further been established that the scaling of @xmath63 with respect to @xmath1 determines which regime is reached , in the limit @xmath40 .",
    "the sbm is said to be _ strongly consistent _ if its planted partition can be inferred perfectly , with a probability that goes to 1 as @xmath40 ( it is also said to be in the _ exact recovery _",
    "another close but weaker definition of consistency asks that the probability of misclassifying a node goes to zero with @xmath40 ( the _ weakly consistent _ or _ almost exact recovery _",
    "these regimes prevail when @xmath21 scales at least as fast as @xmath64 , where @xmath65 is a @xmath22 matrix of constants @xcite . predictably , most algorithms ( e.g. , those of refs .",
    "@xcite ) work well in the exact recovery phase regime , since it is the easiest of all .    in the _ detectable _ ( but not consistent ) regime , exact recovery is no longer possible ( the _ partial recovery _",
    "the reason is simple : through random fluctuations , some nodes that belong to , say , block @xmath66 , end up connecting to other nodes as if they belonged to block @xmath67 .",
    "they are thus systematically misclassified , no matter the choice of algorithms .",
    "this occurs whenever @xmath68 , or @xmath69 , with @xmath70 a function of @xmath1 that scales slower than @xmath71 .",
    "the discovery of the third regime  the _",
    "undetectable regime_arguably rekindled the study of the fundamental limits of the sbm . in this regime , which occurs when @xmath68 and @xmath65 is more or less uniform , it is impossible to detect a partition that is even correlated with the planted one .",
    "that is , one can not classify nodes better than at random , and no information on the planted partition can be extracted .",
    "thus , some parametrizations of the sbm are said to lie below the _ detectability limit_. this limit was first shown to exist using informal arguments from statistical physics and random matrix theory @xcite , and has since been rigorously investigated in refs .",
    "@xcite , among others .",
    "there exist many efficient algorithms that are reliable above the detectability limit , for almost all parameterizations of the sbm ; noteworthy examples include belief - propagation @xcite , and spectral algorithms based on the ordinary @xcite and weighted @xcite non - backtracking matrix , as well as matrices of self - avoiding walks @xcite .",
    "when the number of blocks is too large , most of these algorithms are known to fail well above the information theoretic threshold , i.e. , the point where it can be proven that the partition is detectable .",
    "it has been therefore conjectured in ref .",
    "@xcite , that the undetectable regime is further separated in two phases : a truly undetectable regime , and a regime where detection is not achievable _",
    "efficiently_. in the latter , it is thought that one _ can _ find a good partition , but only by enumerating all partitions  a task of exponential complexity .",
    "detectability and consistency are well separated phases of the infinite stochastic block model .",
    "a minute perturbation to the parameters may potentially translate into widely different qualitative behaviors .",
    "the picture changes completely when one turns to finite instances of the model .",
    "random fluctuations are not smoothed out by limits , and transitions are much less abrupt .",
    "we argue that , as a result , one has to account for the complete distribution of networks to properly quantify detectability , i.e. , define detectability for _ network instances _ rather than parameters .",
    "this , in turn , commands a different approach that we now introduce .",
    "consider a single network @xmath18 , generated by the sbm with some planted partition @xmath33 and matrix @xmath72 , where @xmath73 is a matrix of ones , @xmath7 a constant , and @xmath74 a matrix of ( small ) fluctuations .",
    "suppose that the average density equals @xmath63 , and consider a second density matrix @xmath75 for which the block structure has no effect on the generative process .",
    "if an observer with _ complete knowledge _ of the generative process and its parameters can not tell which density matrix , @xmath21 or @xmath75 , is the most likely to have generated @xmath18 , then it is clear that _ this particular instance _ does not encode the planted partition . as a result",
    ", it will be impossible to detect a partition correlated with the planted partition .",
    "this idea can be translated into a mathematical statement by way of a likelihood test . for a sbm of average density @xmath63 ,",
    "call the ensemble of erds - rnyi graphs of density @xmath63 the ensemble of _ equivalent random networks_. much like the sbm ( see sec .",
    "[ section : stochastic_block_model ] ) , its likelihood @xmath76 is given by the product of the density of @xmath19 independent and identically distributed bernoulli variables , i.e. , @xmath77 where @xmath78 is the total number of edges in @xmath18 .",
    "the condition is then the following : given a network @xmath18 generated by the sbm of average density @xmath63 and density matrix @xmath21 , one can detect the planted partition @xmath33 if the sbm is more likely than its equivalent random ensemble of density @xmath63 , i.e. , @xmath79 a similar condition has been used in ref .",
    "@xcite and @xcite to pinpoint the location of the detectability limit in infinite and sparse instances of the sbm .",
    "but nothing forbids its application to the finite size problem ; one will see shortly that it serves us well in the context of finite size detectability",
    ".      the ( equivalent ) normalized log - likelihood ratio @xmath80 will be more practical for our purpose .",
    "this simple transformation brings the line of separation between models from @xmath81 to @xmath82 , and prevents the resulting quantity from becoming too large .",
    "more importantly , it changes products into sums , and allows for a simpler expression @xmath83 + \\alpha_{rs}\\!\\log\\!\\!\\left[\\frac{1-p_{rs}}{1-\\rho}\\right]\\!\\!\\bigg\\}.       \\label{eq : normalized_log_likelihood}\\ ] ]    $ ] .",
    "each color denotes a block @xcite .",
    "( e - f ) empirical distribution of the normalized log - likelihood obtained from @xmath84 samples of @xmath85 . the bins in which the instances ( c - d ) fall are colored in red .",
    "notice that a negative log - likelihood ratio is associated with some instances in ( f ) .",
    ", title=\"fig : \" ] $ ] .",
    "each color denotes a block @xcite .",
    "( e - f ) empirical distribution of the normalized log - likelihood obtained from @xmath84 samples of @xmath85 . the bins in which the instances ( c - d ) fall are colored in red .",
    "notice that a negative log - likelihood ratio is associated with some instances in ( f ) .",
    ", title=\"fig : \" ] + $ ] .",
    "each color denotes a block @xcite .",
    "( e - f ) empirical distribution of the normalized log - likelihood obtained from @xmath84 samples of @xmath85 . the bins in which the instances ( c - d ) fall are colored in red .",
    "notice that a negative log - likelihood ratio is associated with some instances in ( f ) .",
    ", title=\"fig : \" ]    we will focus , for the remainder of this contribution , on the case where network instances @xmath18 of @xmath1 nodes are drawn from the sbm of parameters @xmath86 . from this point of view , @xmath85 can be seen as a random variable whose support is the networks of @xmath1 nodes with labeled nodes ( see fig .  [",
    "fig : log_likelihood_full_distribution ] ) . since @xmath21 , @xmath63 , @xmath87 and @xmath88 are all parameters",
    ", @xmath85 is simply a weighted sum of binomial distributed random variables @xmath89 , with a constant offset .",
    "its average will be a prediction of the detectability for the ensemble ( sec .",
    "[ section : average_detectability ] ) , and the probability @xmath90 will give the fraction of instances that are undetectable for the selected parameters ( sec .  [",
    "section : eta - detectability ] ) .",
    "because likelihood ratio tests can be understood as quantifying the amount of evidence for a hypothesis ( compared to a null hypothesis ) , there will be two interpretations of @xmath85 .",
    "on the one hand , the condition @xmath91 will provide a lower bound on detectability ; if @xmath92 , then we can safely say that the instance @xmath18 is information theoretically undetectable .",
    "however , @xmath93 does not necessarily mean that the instance is information theoretically detectable .",
    "this is due to the fact that the condition @xmath91 is necessary but not sufficient , since we assume a complete knowledge of the generative process in calculating @xmath85 .    on the other hand",
    ", we will interpret @xmath85 operationally as a measure of the difficulty of the inference problem .",
    "a large ratio of a hypothesis @xmath94 to its null model @xmath95 implies that the hypothesis is a much better explanation of the data than @xmath95 .",
    "we may therefore say that @xmath85 is , in some sense , a measure of how easy the inference of @xmath33 is .",
    "after all , since the @xmath96 and @xmath97 only differ by the mesoscopic organization of edges , @xmath98 should be taken to mean that the inferred partition is not an artifact of the procedure .",
    "many empirical results will validate this interpretation ( sec .",
    "[ section : case_study ] ) .",
    "the average of a log - likelihood ratio is also known as the kullback - leibler ( kl ) divergence @xmath99 of two hypotheses @xcite , i.e. @xmath100 since the kl divergence is always greater or equal to zero , with equality if and only if @xmath101 , and since @xmath91 is only a necessary condition for detectability , the average @xmath102 will not be enough to conclude on detectability of the sbm , except for the case @xmath101 .",
    "also goes to 0 at @xmath103 , and a more careful scaling analysis is necessary to conclude on the detectability of sparse instances . ] results pertaining to @xmath102 will therefore be best interpreted in terms of inference difficulty .",
    "even if the average log - likelihood ratio is always positive ( assuming @xmath104 ) , it can be extremely close to zero for density matrix @xmath21 `` close '' to @xmath105 [ fig .",
    "[ fig : log_likelihood_full_distribution ] ( f ) ] .",
    "in fact , as we will see in sec .  [ section : eta - detectability ] , @xmath106 implies that there are instances for which @xmath107 , i.e. , truly undetectable instances .",
    "therefore , whenever the average is small , we may also interpret @xmath102 as a measure of detectability in the rigorous sense .",
    "while eq .   has a precise information theoretic interpretation , there exists an equivalent form , both more compact and easier to handle analytically .",
    "it is given by @xmath108 where @xmath109 is the binary entropy of @xmath110 $ ] .",
    "this expression can be derived in two different ways .",
    "the simplest and most obvious of the two derivations is by direct computation of the average eq .   over the joint distribution of the random variables",
    "@xmath31 ; the second derivation follows from the extensivity of kl divergence for independent random variables.see supplemental material for more details on the mathematical development . ]",
    "the bounds of @xmath102 will give us an intuition for what the easiest and hardest detectability problems might look like .",
    "the kl divergence is never negative , and eq .",
    "shows that the maximum of @xmath102 is @xmath111 ; the average of the normalized log - likelihood is thus confined to the interval @xmath112 an example of parameters that achieves the upper bound would be the sbm of density matrix @xmath113 , @xmath114 , with @xmath115 $ ] , i.e. , the `` ensemble '' of disconnected @xmath116cliques ( which contains a single instance ) . an example of parameters that achieves the lower bound would be @xmath101 , but also @xmath117 [ see eq .  ] .",
    "this goes to show that detectability is not guaranteed in sparse networks .      equation also reveals connections between the qualitative regimes of the sbm , since it induces equivalence classes in the parameter space of the model , with respect to @xmath102 .",
    "that is , it induces subset of parameters which all satisfy @xmath118 where @xmath119 is a constant that defines the equivalence class .    in the next paragraphs",
    ", we will characterize these equivalence classes in two complementary ways .",
    "first , we will look for global transformations that preserve @xmath119 and map parameters @xmath120 to some other  not necessarily close  pair of parameters @xmath121 . provided that they satisfy a number of standard constraints , these transformations will be shown to correspond to the symmetry group of the set of _ hypersurfaces _ @xmath122 .",
    "second , we will consider eq .",
    "explicitly and use it to obtain an approximate hypersurface equation . this equation will be used in later sections to determine the location of the hypersurfaces that separate the parameter space of the sbm in different detectability phases .",
    "we first look for the set of @xmath119preserving global transformations , i.e. , all transformations @xmath123 of the form @xmath124 valid at every point of the parameter space .",
    "this is a broad definition and it must be restricted if we are to get anything useful out of it . intuitively , we do not want these transformations to change the space on which they operate , so it is natural to ask that they be space - preserving . under the ( reasonable ) constraint that these transformations are invertible as well , we can limit our search for @xmath119preserving transformations to the symmetry group of the parameter space",
    ".    we will be able to harness known results of geometry and algebra once the parameter space of the sbm is properly defined .",
    "this space is in fact the cartesian product of two parameter spaces : the parameter space of @xmath87 and that of @xmath21 .",
    "since there is @xmath125 free parameters in both @xmath87 and @xmath21 , the complete space is of dimension @xmath126 .",
    "it is the product of the @xmath127dimensional hypercube  in which every point corresponds to a choice of @xmath21- , and the @xmath128dimensional simplex  in which every point corresponds to a choice of @xmath87 .",
    "the latter is a simplex due to the normalization @xmath129 .",
    "now , the symmetry group of the @xmath127dimensional hypercube and that of the @xmath128dimensional regular simplex are well - known @xcite : they are respectively the hyperoctahedral group @xmath130 and the symmetric group @xmath131 . their action on @xmath87 and @xmath21 can be described as @xmath132 where @xmath133 , and where both @xmath134 and @xmath135 are permutations of the indexes @xmath136 . while the symmetries of @xmath137 are automatically symmetries of the parameters , the converse is not true .",
    "we therefore look for transformations @xmath138 that satisfy @xmath139 it turns out that this constraint is satisfied if and only if @xmath140 and @xmath141 @xmath57 , i.e. , for transformations of the form    [ eq : symmetry ] @xmath142    with @xmath143 @xcite .",
    "the permutation component of the symmetry is not to be confused with the symmetries generated by relabeling blocks : the latter only leads to @xmath144 different symmetries , whereas the former correctly generates @xmath145 symmetries , or a total of @xmath146 symmetries once they are compounded with @xmath147 .",
    "the symmetries come about because the ordering of summation of the terms @xmath148 in eq .   does not matter , and both @xmath149 and @xmath150 are preserved when @xmath151 .    as an example of symmetry , let us focus on the special transformation @xmath152 @xmath57 with @xmath153 , i.e. , the only transformation that does not change the block structure of the model .",
    "since networks generated by these parameters can be seen as complement of one another ( i.e. , an edge present in @xmath18 is absent from @xmath154 , and vice - versa ) , we may call this transformation the _ graph complement _ transformation .",
    "the fact that it preserves detectability can be understood on a more intuitive level with the following argument .",
    "suppose that we are given an unlabeled network @xmath18 generated by the sbm and that we are asked to confirm or infirm the hypothesis that it was , in fact , generated by the sbm .",
    "even if nothing is known about the generative process , we can take the complement of the network  a trivial ( and reversible ) transformation .",
    "but this should not help our cause .",
    "after all , this transformation can not enhance or worsen detectability since no information is added to or removed from @xmath18 in the process .",
    "so we expect that @xmath119 be preserved , and it is . because all other symmetries affect the block structure through a change of @xmath87 ,",
    "what the above result shows is that there is no other `` information - preserving '' transformation that can be applied to @xmath18 without a prior knowledge of its planted partition .",
    "we now turn to the problem of finding compact and explicit formulas that describe the hypersurfaces of constant @xmath102 in the parameter space [ see eq .  ] . in so doing",
    "we will have to be mindful of the fact that the scale @xmath88 intervenes in the calculation , even though it is absent from our expression for @xmath102 .",
    "this can be made explicit by rewriting eq .",
    "as @xmath155 ; it is easy to see that any given hypersurface will be comparatively closer to the region @xmath156 in larger networks .",
    "we focus on the universal behavior of the hypersurfaces and remove all references to the scale of the problem by defining @xmath157predictions for real systems can be recovered by reverting to the correct scale .",
    "while eq .",
    "is easily stated , it is not easily solved for , say , @xmath158 .",
    "the average normalized log - likelihood ratio involves a sum of logarithmic terms ; the hypersurface equation is thus transcendental . to further complicate matters , there are @xmath159 degrees of freedom and the number of free parameters grow quadratically with @xmath2 . as a result",
    ", little can be said of truly general instances of the sbm  at least analytically .",
    "all is not hopeless , however , because there are approximation methods that work well when the number of free parameters is not too large .",
    "we sketch the idea here , and apply it to a simpler variant of the sbm in the case study of sec .",
    "[ section : case_study ] .",
    "expanding the binary entropy functions @xmath150 around @xmath56 @xmath160 drastically simplifies the hypersurface equation . leaving the term @xmath149 untouched",
    ", we find from eq .",
    "@xmath161\\;.\\ ] ] due to the normalization of @xmath162 , all terms in @xmath149 cancel out , and the definition @xmath163 allows us to eliminate the first order terms as well .",
    "we are therefore left with @xmath164\\;,\\ ] ] where @xmath63 is fixed and @xmath120 take on values constrained by both eqs .   and .",
    "we then resort to a change of parameters and choose @xmath165 as one of the parameters . selecting the @xmath166 other parameters @xmath167 such that @xmath168 , we obtain the form @xmath169 hypersurfaces are therefore ellipsoids when @xmath170 .    besides the simplicity of eq .  , there are two additional arguments for dropping the higher order terms in eq .  .",
    "one , the series is invariant under the symmetry @xmath171 @xmath57 only if we limit ourselves to the second order expression : it easily verified that @xmath172(p_{rs}-\\rho)^k\\end{gathered}\\ ] ] is off by a sign for odd powers of @xmath173 under the mapping @xmath174 , which also implies @xmath175 .",
    "two , the true hypersurfaces enclose sets of parameters which are convex with respect to @xmath21 , and so does the hypersurface implicitly defined in eq .  .",
    "the convexity of the hypersurface follows from the fact that the sublevel set of a convex function encloses a convex set @xcite , and from the observation that @xmath102 is convex with respect to @xmath21 [ this is easy to show with eq .   and the log - sum inequality @xcite ] .",
    "the convexity of the approximate level set is trivial to the second order , since it is an ellipsoid [ eq .  ] .",
    "however , the approximate level set need not be convex when higher order terms are included . together , these two observations tell us that while not exact , eq .   captures the important _ qualitative _ features of the problem , and that it is not necessarily true of approximate solutions with only a few extra terms .",
    "in the previous section , we have computed the average @xmath102 and used it to obtain equivalence among the parameters , with respect to detectability .",
    "we have also shown that @xmath176 for most parameters , i.e. , that we could not use the necessary condition @xmath91 to conclude on the _ undetectability _ of the finite sbm , on average . as we will now argue , this conclusion must be further refined ; the full distribution of @xmath85 leads to a more accurate picture of detectability .      consider a parametrization @xmath177 of the sbm which yields @xmath178 . turning to the distribution of @xmath85 for this parametrization , one expect to find @xmath107 with non - zero probability ( unless the distribution of @xmath85 concentrates on @xmath179 ) .",
    "therefore , @xmath102 could be indicative of detectability for some _ fraction _ of the networks generated by the sbm .",
    "let us formalize this notion and introduce the concept of @xmath0detectability .",
    "we will say that the ensemble of networks generated with the sbm of parameters @xmath86 is @xmath0detectable if @xmath180 that is , @xmath0 gives the fraction of networks in the ensemble which evades the necessary condition for undetectability . if @xmath181 , then detection is impossible , in the sense that most instances are best described by the null hypothesis @xmath96 . if @xmath182 , then most instances contain statistical evidence for @xmath33 ; detection can not be ruled out on the basis of the log - likelihood test .",
    "we must compute the complete distribution or the cumulative distribution function of @xmath85 to determine @xmath0 .",
    "an exact result is out of reach since the outcome of @xmath85 is determined by a weighted sum of independent binomial variables with non - identical distributions . in the following paragraphs , we give an approximate derivation based on the central limit theorem ",
    "it agrees extremely well with empirical results for all but the smallest networks .",
    "equation gives the normalized log - likelihood ratio as a sum of independent binomial random variables ; it can be written as    @xmath183    where the constants @xmath184 and @xmath185 are given by @xmath186\\ ; ,      \\label{eq : normalized_log_likelihood_x_rs}\\\\      c = \\sum_{r\\leq s}\\alpha_{rs}\\log\\left[\\frac{1-p_{rs}}{1-\\rho}\\right]\\ ; ,      \\label{eq : c_clt }     \\end{aligned}\\ ] ] and where @xmath187 .",
    "the central limit theorem ( clt ) predicts that the distribution of an appropriately rescaled and centered transformation of @xmath85 will converge to the normal distribution @xmath188 if the number of summed random variables @xmath125 goes to infinity . in the finite case",
    ", @xmath127 obviously violates the conditions of the clt , but it nonetheless offers a good approximation of the distribution of @xmath85 ( see fig .  [",
    "fig : clt_quality ] ) .    .",
    "both histograms aggregate @xmath84 samples of @xmath85 .",
    "the prediction of the clt is shown in red [ see eqs .   ] .",
    "we plot for comparison the gaussian kernel density estimate ( kde ) of @xmath189 ( dashed black line , hidden by the clt curve ) .",
    "equation   predicts @xmath190 and @xmath191 ; for the sample shown , numerical estimates yield @xmath192 and @xmath193 .",
    ", title=\"fig : \" ] + .",
    "both histograms aggregate @xmath84 samples of @xmath85 .",
    "the prediction of the clt is shown in red [ see eqs .   ] .",
    "we plot for comparison the gaussian kernel density estimate ( kde ) of @xmath189 ( dashed black line , hidden by the clt curve ) .",
    "equation   predicts @xmath190 and @xmath191 ; for the sample shown , numerical estimates yield @xmath192 and @xmath193 .",
    ", title=\"fig : \" ]    to apply the clt , we first define the centered and normalized variable @xmath194 where @xmath195\\notag\\\\      & = \\sum_{r\\leq s } \\frac{\\alpha_{rs}}{m^{\\max}}\\ p_{rs}(1-p_{rs})x_{rs}^2\\end{aligned}\\ ] ] is the sum of the variances of the @xmath127 scaled binomial variables @xmath196 , and where @xmath197    is the sum of their means [ we have used eq .   in the last step ] .",
    "the clt then tells us that @xmath198 , approximately .",
    "recall that the cumulative distribution function of a normal random variable can be expressed in terms of the error function as @xmath199\\;.\\end{aligned}\\ ] ] now , assuming that @xmath200 is indeed normally distributed we can use the fact that @xmath201 is equivalent to @xmath202 $ ] to compute @xmath0 . writing @xmath203 as @xmath102 [ see eq .  ] , we find @xmath204\\;,\\ ] ] i.e. , a ( approximate ) equation in closed form for @xmath0 .",
    "crucially , eq .   predicts that @xmath0 can never be smaller than @xmath205 .",
    "this comes about because ( i ) @xmath176 and ( ii ) @xmath131 is a sum of variances , i.e. , a positive quantity .",
    "there are therefore two possible limits which will yield @xmath206 and @xmath207 : either @xmath156 or @xmath208 .",
    "some care must be exerted in analyzing the case @xmath156 ; equations   tell us that the distribution of @xmath85 is concentrated on @xmath209 when its average is exactly equal to 0 .",
    "we conclude that @xmath207 is never reached but only approached asymptotically , for parameters that yield @xmath210 , with @xmath211 small but different from zero .",
    "the consequence of @xmath212 is that at most half of the instances of the sbm can be declared undetectable on the account of the condition @xmath107 .",
    "we can immediately reach a few conclusions on the interplay between the notions of average and @xmath0detectability .",
    "first , the symmetries of @xmath102 , ( see sec .",
    "[ subsubsection : symmetries_avg_detectability ] ) translates into symmetries for @xmath0 . to see this ,",
    "first notice that @xmath131 is conserved under the mapping @xmath213",
    "@xmath214 ^ 2 & \\mapsto [ -x_{rs}(1-p_{rs},1-\\rho)]^2\\;,\\\\    p_{rs}(1-p_{rs } ) & \\mapsto ( 1-p_{rs})p_{rs}\\;.\\end{aligned}\\ ] ] and that a permutation of the indexes @xmath134 only changes the order of summation of the terms of @xmath131 .",
    "second , hypersurfaces of constant average detectability need not be hypersurfaces of constant @xmath0detectability .    to investigate this second important aspect of the connection between average detectability and @xmath0detectability ,",
    "let us further approximate eq .  .",
    "the maclaurin series of the error function is , to the first order , @xmath215\\right\\}\\notag\\;,\\\\      & \\approx \\frac{1}{\\sqrt{2\\pi } } \\frac{{\\langle \\mathcal{l } \\rangle}}{s_{q^ * } } + \\frac{1}{2}\\;.      \\label{eq : eta_maclaurin}\\end{aligned}\\ ] ] this is a reasonably accurate calculation of @xmath0 when @xmath102 is small , i.e. , close to the _ average _ undetectable regime .",
    "( recall that we do not allow diverging @xmath131 for the reasons stated in sec .",
    "[ subsec : eta_clt ] ) .",
    "it then becomes clear that on the hypersurfaces where @xmath216 is constant ( and close to 0 ) , @xmath217 is conserved rather than @xmath0 itself .",
    "equation embodies a trade - off between accuracy ( @xmath0 ) and variance ( @xmath131 ) : in the regions of the hypersurface of constant @xmath102 where the variance is large , @xmath0 must be comparatively small , and vice - versa .",
    "now , turning to the complementary case where @xmath102and consequently @xmath0is close to its maximum , we obtain a simple criterion for 1detectability based the asymptotic behavior of @xmath218 .",
    "it is reasonable to define a ( small ) threshold @xmath138 beyond which @xmath219 for all practical purposes .",
    "the error function goes asymptotically to @xmath220 with large values of its argument , but reaches its maximum of @xmath221 very quickly , so quickly , in fact , that @xmath222 is numerically equal to 1 to the 10^th^ decimal place .",
    "asking that the argument of @xmath218 in eq .",
    "be greater than this practical threshold , we obtain the inequality @xmath223 for @xmath220detectability .",
    "whenever the inequality holds , the associated ensemble is 1detectable with a tolerance threshold @xmath138 , i.e. , we can say that for all practical purposes , there are no instances of the sbm which are necessarily is not sufficient for detectability , some instances could still be undetectable . ] undetectable .",
    "the stochastic block model encompasses quite a few well - known models as special cases ; noteworthy examples include the _ planted partition model _",
    "@xcite , the closely related _ symmetric sbm _ ( ssbm )",
    "@xcite , the _ core - periphery model _ @xcite , and many more .",
    "these simplified models are important for two reasons .",
    "one , they are good abstractions of structural patterns found in real networks , and a complete understanding of their behavior with respect to detectability is therefore crucial .",
    "two , they are simple enough to lend themselves to a thorough analysis ; this contrasts with the general case , where simple analytical expressions are hard to come by . in the paragraphs that follow ,",
    "we investigate the _ general modular graph model _ ( gmgm ) @xcite , a mathematically simple , yet phenomenologically rich simplified model .",
    "thanks to its simpler parametrization , we obtain easily interpretable versions of the expressions derived in secs .",
    "[ section : finite_limit][section : eta - detectability ] .",
    "the gmgm can be seen as constrained version of the sbm , in which _ pairs _ of blocks assume one of two roles : inner or outer pairs .",
    "if a pair of blocks @xmath25 is of the `` inner type '' , then one sets @xmath224 .",
    "if a pair of blocks @xmath25 is of the `` outer type '' , then one sets @xmath225 .",
    "the resulting density matrices can therefore be expressed as @xmath226 where @xmath227 is a @xmath22 indicator matrix [ @xmath228 if @xmath229 is an inner pair ] , and where @xmath230 is a length @xmath2 vector of ones .",
    "a non - trivial example of a density matrix of this form is shown in fig .",
    "[ fig : general_modular_graph ] ( a ) .",
    "the figure is meant to illustrate just how diverse the networks generated by the gmgm may be , but it is also important to note that the results of this section apply to _ any _ ensemble whose density matrix can be written as in eq .  .",
    "this includes , for example , the @xmath2block ssbm , obtained by setting @xmath231 and @xmath232 .    whilst the parametrization in terms of @xmath233 and @xmath234 is simple",
    ", we will prefer an arguably more convoluted parameterization which is also more revealing of the natural symmetries of the gmgm ( in line with the transformation proposed in sec .",
    "[ subsubsection : hypersurfaces ] ) .",
    "the first natural parameter is the average density , which can be computed from eqs .   and and which equals    [ eq : natural_gmg_params ] @xmath235\\;,\\notag\\\\          & = \\beta p_{{\\mathrm{in } } } + ( 1-\\beta)p_{{\\mathrm{out}}}\\;,\\end{aligned}\\ ] ] where @xmath236 is the fraction of _ potential _ edges that falls between block pairs of the inner type .",
    "the second natural parameter is simply the difference @xmath237    the absolute value of @xmath238 quantifies the distance between the parameters of the gmgm and that of the equivalent random ensemble ; its sign tells us which type of pairs is more densely connected . in this natural parametrization",
    "the density matrix takes on the form @xmath239 , i.e. , a uniform matrix of @xmath63 with perturbation proportional to @xmath240 for the inner pairs .",
    "it might appear that we have increased the complexity of the model description , since the additional parameter @xmath241 now appears in the definition of the density matrix .",
    "it is , however , not the case , because we could consider the combined parameter @xmath242 .",
    "therefore , eqs .",
    " , together with @xmath227 and @xmath243 , suffice to unambiguously parametrize the model .",
    "the average normalized log - likelihood ratio @xmath102 is tremendously simplified in the natural parametrization of the gmgm ; it is straightforward to show that the ratio takes on the compact ( and symmetric ) form @xmath244\\big\\ } \\\\- ( 1-\\beta)\\big\\{h(\\rho ) -   h\\bigl[\\rho-\\beta\\delta\\bigr]\\big\\ } \\;,\\end{gathered}\\ ] ] by using @xmath245 together with the inverse of eqs .  ",
    ":    [ eq : natural_gmg_params_inverse ] @xmath246    in fig .",
    "[ fig : general_modular_graph ] ( b ) , we plot @xmath247 in the @xmath248 space  hereafter the density space  for the indicator matrix @xmath227 shown in fig .",
    "[ fig : general_modular_graph ] ( a ) ( and unequal block sizes , see caption ) .",
    "unsurprisingly , @xmath102 is largest when the block types are clearly separated from one another , i.e. , when @xmath249 is the largest .",
    "notice , however , how large separations are _ not _",
    "achievable for dense or sparse networks .",
    "this is due to the fact that not all @xmath248 pairs map to probabilities @xmath250 in @xmath251 $ ] .",
    "the region of the density space which _ does _ yield probabilities is the interior of the quadrilateral whose vertices are , in @xmath248 coordinates : @xmath252 .",
    "changing the value of @xmath241 skews this accessible region and , presumably , the functions that are defined on it , such as @xmath247 .",
    "we also show on fig .",
    "[ fig : general_modular_graph ] ( b ) two members of the level set defined by @xmath253 .",
    "as mentioned previously , the exact functional form of this family of hypersurfaces ( here simply curves ) seems elusive , but an approximate solution is available . using the method highlighted in sec .",
    "[ section : average_detectability ] , we find , to the second order , @xmath254 ^ 2 + ( 1-\\beta)(\\beta\\delta)^2\\;.      \\label{eq : hypersurface_gmg}\\end{aligned}\\ ] ] equation fixes the relative value of all parameters on the line where @xmath255 . solving for @xmath238 , we find @xmath256 also shown on fig .  [",
    "fig : general_modular_graph ] ( b ) for comparison .",
    "figure [ fig : general_modular_graph ] highlights the accuracy of our approximation when @xmath119 is small .",
    "but it also highlights its inaccuracy when @xmath119 is large ; @xmath257 forces @xmath258 to pass through a region where @xmath259 , i.e. , a region where the omitted terms on the rhs of eq .",
    "contribute heavily .",
    "fortunately , this is not so problematic , since most detectability related phenomena  phase transitions , undetectable instances , etc.arise near @xmath260 , i.e. , where the approximation works .",
    "while @xmath247 takes on a particularly compact form once we substitute @xmath158 by the natural parameters of the gmgm , the same can not be said of @xmath261 .",
    "some analytical progress can be made by , e.g. , noticing that only two types of terms are involved in the calculation of @xmath131 , but , ultimately , the resulting expression is no more useful than the simple eq .",
    "and eq .  .",
    "we will therefore omit the calculation of @xmath0 .    in fig .",
    "[ fig : general_modular_graph ]  ( c ) we plot @xmath261 in the density space [ using eq .  ] .",
    "we also display the numerical solutions of @xmath262 for two values of @xmath263 .",
    "the figure highlights just how quickly @xmath0 goes to 1 as a function of @xmath238 , even for the fairly small system sizes considered : we find that @xmath264 for _ any _ value of @xmath63 , as soon as @xmath265 .",
    "the condition is therefore a _ weak _ one .",
    "it allows us to determine that some parameters are overwhelmingly undetectable , but only when @xmath238 is very close to 0 .",
    "figure [ fig : general_modular_graph ] also shows how increases in variance translate into decreases in accuracy [ see eq .  ] : following a line of constant ( and relatively small ) @xmath238 , one can see that @xmath0 is minimized close to @xmath266 , i.e. , near the maximum of variance .",
    "this is characteristic of many parameterizations of the sbm and gmgm ; it turns out that , for fixed @xmath1 , the hardest detection problems are not confined to vanishing densities .",
    "in fact , values of @xmath63 closer to @xmath205 are associated with a comparatively larger interval of @xmath238 for which detection is hard .      in secs .",
    "[ section : average_detectability][section : eta - detectability ] , we have proved that there are @xmath146 transformations that preserve @xmath247 and @xmath261 .",
    "we could therefore go about computing the symmetries of the gmgm by listing all of these transformations in terms of @xmath267 .",
    "but since there are only 3 free parameters in the gmgm , we can also choose an alternative route and directly solve @xmath268 by , e.g. , obtaining a linear system from the taylor series of @xmath247 .",
    "this simpler approach yields the following set of @xmath119preserving transformations for the model :    [ eq : gmg_syms ] @xmath269    it is straightforward to check that these transformations form a group , whose product is the composition of two transformations .",
    "a cayley table reveals that the group is isomorphic to the klein four - group @xmath270 .    at a glance",
    ", one immediately notices a large gap between the predicted number of symmetries ( @xmath146 ) and the actual number of symmetries ( @xmath271 , independent of @xmath2 ) .",
    "it is explained by the fact that every symmetry of the general sbm maps onto one of the four transformations listed in eq .",
    "pairs of blocks in the eyes of our formalism : a single inner pair and a single outer pair , with , respectively , a fraction @xmath241 and @xmath272 of all possible edges . ]",
    "a sizable fraction of the symmetries reduce to eq  , since permutations @xmath134 can not modify the natural parameters of the gmgm : the type of block pair @xmath25characterized by @xmath9is permuted alongside its share of potential edges @xmath273 .",
    "another important fraction of the symmetries is accounted for by the `` graph complement transformation '' : any transformation @xmath274 plus a permutation reduces to eq .  .",
    "this leaves two symmetries , which happen to be artifacts of our choice of nomenclature . to see this ,",
    "_ rename _ pair types , i.e. , call inner pairs `` outer pairs '' and vice - versa .",
    "neither the density @xmath63 nor @xmath249 will change . but both the sign of @xmath238 and the value of @xmath241 will be altered . with this in mind , it becomes clear that eq",
    ".   corresponds to the permutation symmetry , and that eq",
    ".   corresponds to the graph complement symmetry , both up to a renaming of the types .     and @xmath275 $ ] .",
    "all empirical results are averaged over @xmath276 independent instances of the sbm .",
    "we infer the partition of each of these instances with an optimal metropolis - hasting algorithm , seeded with the planted partition and the correct ensemble parameters @xcite .",
    "( a ) average rnmi of the planted and the inferred partition of the ssbm ( of @xmath277 nodes ) in the density space .",
    "solid red lines mark the border of the 1detectability region , with tolerance threshold @xmath278 , see eq .  .",
    "dotted black lines show the two solutions of @xmath279 , see eq .  .",
    "( b)(c ) phase transition at constant @xmath280 for networks of @xmath277 nodes ( b ) and @xmath281 nodes ( c ) .",
    "circles indicate the fraction of instances for which a correlated partition could be identified , while diamonds show the average of the rnmi ( lines are added to guide the eye ) .",
    "blue solid curves show @xmath282 , see eq .  .",
    "the shaded region lies below the kesten - stigum bound @xmath283 ( here with @xmath284 ) .",
    "the dotted lines show the two solutions of @xmath285 .",
    ", title=\"fig : \" ]   and @xmath275 $ ] .",
    "all empirical results are averaged over @xmath276 independent instances of the sbm .",
    "we infer the partition of each of these instances with an optimal metropolis - hasting algorithm , seeded with the planted partition and the correct ensemble parameters @xcite .",
    "( a ) average rnmi of the planted and the inferred partition of the ssbm ( of @xmath277 nodes ) in the density space .",
    "solid red lines mark the border of the 1detectability region , with tolerance threshold @xmath278 , see eq .  .",
    "dotted black lines show the two solutions of @xmath279 , see eq .  .",
    "( b)(c ) phase transition at constant @xmath280 for networks of @xmath277 nodes ( b ) and @xmath281 nodes ( c ) .",
    "circles indicate the fraction of instances for which a correlated partition could be identified , while diamonds show the average of the rnmi ( lines are added to guide the eye ) .",
    "blue solid curves show @xmath282 , see eq .  .",
    "the shaded region lies below the kesten - stigum bound @xmath283 ( here with @xmath284 ) .",
    "the dotted lines show the two solutions of @xmath285 .",
    ", title=\"fig : \" ]   and @xmath275 $ ] .",
    "all empirical results are averaged over @xmath276 independent instances of the sbm .",
    "we infer the partition of each of these instances with an optimal metropolis - hasting algorithm , seeded with the planted partition and the correct ensemble parameters @xcite .",
    "( a ) average rnmi of the planted and the inferred partition of the ssbm ( of @xmath277 nodes ) in the density space .",
    "solid red lines mark the border of the 1detectability region , with tolerance threshold @xmath278 , see eq .  .",
    "dotted black lines show the two solutions of @xmath279 , see eq .  .",
    "( b)(c ) phase transition at constant @xmath280 for networks of @xmath277 nodes ( b ) and @xmath281 nodes ( c ) .",
    "circles indicate the fraction of instances for which a correlated partition could be identified , while diamonds show the average of the rnmi ( lines are added to guide the eye ) .",
    "blue solid curves show @xmath282 , see eq .  .",
    "the shaded region lies below the kesten - stigum bound @xmath283 ( here with @xmath284 ) .",
    "the dotted lines show the two solutions of @xmath285 .",
    ", title=\"fig : \" ]        it will be instructive to put our framework to the test and compare its predictions with numerical experiments that involve inference , i.e. , the detection of the planted partition of actual instances of the gmgm . the procedure will be the following : ( i ) generate an instance of the model , ( ii ) run an inference algorithm on the instance , and ( iii ) compute the correlation of the inferred and planted partition .",
    "the average detectability @xmath102 should predict the point where the average correlation becomes significant ( see below for a precise definition ) , and @xmath0detectability should give an upper bound on the fraction of correlated instances . before we proceed",
    ", let us emphasize that the outcome of these experiments is influenced by a number of factors .",
    "since it is conjectured that there exists a gap between information - theoretically feasible inference and efficiently achievable inference @xcite , we will have to be careful in choosing an inference algorithm  otherwise we would run at risk of confounding the sources of error .",
    "even for the size considered , enumeration is impossible ; we must therefore resort to an approximate algorithm .",
    "we use an efficient algorithm based on the metropolis - hasting algorithm of ref .  @xcite .",
    "unlike belief propagation @xcite , it works well on dense networks with many short loops . in the spirit of refs .",
    "@xcite we initialize the algorithm with the planted partition itself , to achieve our information theoretic threshold , even if efficient inference is not possible @xcite .",
    "we must also define precisely what is meant by correlated inference if we are to quantify our experiment .",
    "crucially , we have to account for finite size effects that could introduce spurious correlations .",
    "the so - called renormalized normalized mutual information ( rnmi ) of ref .",
    "@xcite appears a good choice .",
    "much like the well - known nmi @xcite , the rnmi is bounded to the [ 0 , 1 ] interval , and @xmath286 means that the planted partition @xmath287 and the inferred partition @xmath288 are identical . unlike the nmi , @xmath289 signals the absence of correlation between the two partitions , even in finite networks .      in fig .",
    "[ fig : general_modular_graph_transition ]  ( a ) , we plot @xmath290 in the density space of the gmgm .",
    "we use the parameters @xmath291 , and @xmath115 $ ] ( i.e. , the ssbm ) , since the resulting ensemble is conjectured to be the hardest of all , with respect to detectability @xcite .",
    "two important parallels can be drawn between the results shown in fig .",
    "[ fig : general_modular_graph_transition ]  ( a ) and the functional form of @xmath247 and @xmath261 [ shown in fig .  [ fig : general_modular_graph ]  ( b)(c ) for a different gmgm ] .",
    "first , notice how the boundary that marks the onset of the ( theoretically ) 1detectable region partitions the density space in two qualitative regimes : a regime where perfect detection is possible _ for all instances _ , and a region where it is not .",
    "there is , of course , some level of arbitrariness involved in selecting the threshold @xmath138 [ see eq .  ] .",
    "but the fact that a line of constant @xmath0 partitions the space is a hint that while @xmath107 is not sufficient for undetectability , there exists a level of significant @xmath292 for which @xmath85 properly separates detectable and undetectable instances .    the second important parallel concerns hypersurfaces of constant @xmath102 and their connection with @xmath293 .",
    "we have argued in sec .",
    "[ section : average_detectability ] that @xmath102 can be seen as a measure of how easy the inference problem is : large positive values , in particular , indicate a high level of significance of the hypothesis @xmath97 .",
    "it is not surprising , therefore , that there exists a hypersurface of constant @xmath102 which _ also _ partitions the density space in two qualitative regions : within the information - theoretical framework itself .",
    "however , random matrix theory offers some insights as to why one should have @xmath294 , see appendix [ appendix : connection_with_rmt ] for details .",
    "] one where @xmath295 and one where @xmath293 is clearly greater than zero . on this hypersurface ,",
    "the average level of significance is the same for all parameterizations of the gmgm ; our results show that the inference problem is also equally hard .",
    "one could argue that these parallels are not so obvious in fig .",
    "[ fig : general_modular_graph_transition ]  ( a ) ; we therefore focus on a subset of the density space in fig .",
    "[ fig : general_modular_graph_transition ]  ( b)-(c ) to make our case clearer . in these figures , we plot the same information , but only for networks of constant density @xmath280 and size @xmath277 ( b ) and @xmath281 ( c ) .",
    "we also show the probability @xmath296 that the inferred partition is correlated with the planted partition . this a direct measurement of the fraction of detectable instances , which we compare against @xmath282 .",
    "it never reaches 0 , because random fluctuations produce correlated partitions even when @xmath101 ( the rnmi corrects for the _ average _ correlation ) . if @xmath91 were a necessary and sufficient condition for detectability , then @xmath282 and @xmath297 would correspond perfectly .",
    "but since @xmath91 is only a _ necessary _ condition , @xmath298 acts as an upper bound rather than an exact expression , i.e. , @xmath299 can never be greater than @xmath298 .",
    "two further observations must be made .",
    "first , it is known that in the sparse two - blocks ssbm , the transition between undetectable and detectable regions @xcite occurs on the so - called kesten - stigum ( ks ) bound  located at @xmath283 for finite size instances . despite the fact that this bound was derived for infinite ensembles , it holds very well in the finite case , as shown in fig .",
    "[ fig : general_modular_graph_transition ] ( b)(c ) .",
    "but the finite size approach has the potential to be more precise .",
    "building upon the interpretation of @xmath102 as a measure of the average difficulty of the inference problem , we set a threshold @xmath300 on the average detectability . for this choice of threshold ,",
    "the approximate hypersurface equation predicts a transition at @xmath301 very close to the ks bound , but with a correction for nonvanishing densities .",
    "interestingly , one can also motivate this choice of threshold with random matrix theory ( see appendix  [ appendix : connection_with_rmt ] for details ) .",
    "second , in asymptotic theories , the sbm is either said to be undetectable with overwhelming probability , or the converse .",
    "the finite size approach is more nuanced in the sense that it accounts for random fluctuations , which are also manifest in empirical results [ see the curves @xmath296 ] .",
    "while @xmath0detectability is not perfect , as is argued above , it nonetheless accounts for a sizable portion of the uncorrelated instances ( since it dips well below @xmath303 near @xmath260 ) .",
    "building upon ideas from statistical theory , we have developed a framework to study the information - theoretic detectability threshold of the finite size sbm .",
    "our analysis relies on two different interpretations of the log - likelihood ratio @xmath85 of the sbm and its equivalent random ensemble .",
    "we have used the rigorous interpretation of @xmath85 to put a necessary condition on detectability .",
    "we have then computed the distribution of @xmath85 , and proved that up to half of the instances of the finite size sbm could be declared undetectable on the basis of this simple test alone .",
    "we have further argued that the average of @xmath85 could be interpreted as a measure of inference difficulty .",
    "this interpretation has proved to be fruitful ; starting with a compact form for @xmath102 , we have established the existence of a large equivalence class with respect to average detectability . in appendix",
    "[ appendix : noisy_sbm ] , we have shown that @xmath85 can also be used to prove that , quite naturally , detectability decreases when the datasets are noisy . using a correspondence with the finite size kesten - stigum bound ( as well as with random matrix theory , see appendix  [ appendix : connection_with_rmt ] ) , we have presented numerical evidence that the hypersurface @xmath300 separates detectable from undetectable instances in a special case of the sbm .",
    "the unifying theme of this contribution has been the idea that @xmath102 quantifies both detectability and consistency in the finite size sbm .",
    "this interpretation leaves many questions open for future works .",
    "perhaps the most important of all : can one justify the threshold @xmath304 within the framework of the theory itself , with no recourse to the ks bound or random matrix theory ?",
    "a second important question pertains to sufficiency : can one modify the condition to make it necessary _ and _ sufficient ? or is a completely different approach needed ? in asymptotic analyses of the limit , one can use different conditions to bound the limit from above and below , as is done in ref .",
    "can a similar approach be fruitfully applied to finite instances ?    in closing , let us mention a few of the many possible generalizations of the methods introduced .",
    "first , it will be important to verify how our approach behaves in the limit @xmath40 .",
    "how this limit is taken will matter .",
    "in particular , we believe that our framework has much to say about the limit where @xmath305 , since it does not assume poisson distributed degree , unlike other asymptotic theories of the limit .",
    "second , we see no major obstacle to a generalization of our methods to other generative models of networks with a mesoscopic structure .",
    "this includes , for example , the consistency of graphons , a subject whose study has been recently undertaken @xcite .",
    "changing the null model from the equivalent random network ensemble to the configuration model @xcite could even allow an extension to degree - corrected sbm @xcite .",
    "we thank guillaume st - onge and charles murphy for useful discussions and comments . this work has been supported by the fonds de recherche du qubec - nature et technologies ( j .- g.y .",
    ", p.d ) , the conseil de recherches en sciences naturelles et en gnie du canada ( l.j.d . ) and the james s. mcdonnell foundation postdoctoral fellowship ( l.h .- d . ) , and grant dms-1622390 from the national science foundation ( l.h .- d . ) .",
    "p.d . and e.l .",
    "are grateful to d.  ct ( p.d . , e.l ) and p.  mathieu ( e.l . ) for financial support .",
    "one almost never has a perfect knowledge of the structure of real networks .",
    "the culprit can lie at the level of data collection , storage , transmission  or a combination of the above , but the outcome is the same : some edges are spurious and others are omitted @xcite . to model imperfect knowledge",
    ", we will suppose that instances of the sbm first go through a noisy channel where @xmath138 modifications ",
    "random edge removals or additions  are applied to the structure . only then are we asked to tell which of hypotheses @xmath97 and @xmath96 is the most likely .",
    "it should be clear that it will be harder to separate the two hypotheses , since noise is not necessarily aligned with the planted partition .",
    "we will approach the problem with the following _ universal perturbation process _ ( upp ) : at each step @xmath306 of this process , a new random edge is added with probability @xmath307 ; otherwise , a random edge is removed .",
    "if a new edge must be added , then it is selected uniformly from the set of non - edges .",
    "if an edge must be removed , then it is selected uniformly from the set of edges already present in the network .",
    "this randomization step is then repeated @xmath138 times .",
    "we call this process universal because one can map arbitrary perturbation patterns onto one or successive upp with different parameters  @xmath307 .    to prove that @xmath102 decreases as a result of any sufficiently long upp",
    ", we will show that the total derivative @xmath308 is negative everywhere . in so doing , we assume that the process can be approximated as a continuous one ( both with regards to `` time '' @xmath306 and discrete quantities such as @xmath26 ) .",
    "admittedly , a more rigorous approach would be needed to settle the matter unequivocally , but we argue that the method presented in this appendix give a good intuition for the problem .    without specifying the dynamics , and using eq .",
    ", one can compute @xmath309 = \\alpha_{rs } x_{rs}\\;,\\ ] ] where @xmath184 is identical to eq .  .",
    "this leaves the @xmath310 terms , whose expressions are determined by the perturbation dynamics . for the upp , the evolution of @xmath311 is determined by the set of differential equations @xmath312}{\\sum_{r\\leq s}m_{rs}(t)}\\ ! + \\ ! \\frac{c\\ [ m^{\\max}_{rs } - m_{rs}(t)]}{m^{\\max } - \\sum_{r\\leq s}m_{rs}(t)}.\\ ] ] the first term accounts for edge removal events , which occur with probability @xmath313 and involve edges that connect nodes in blocks ( @xmath6 , @xmath8 ) with probability @xmath314 .",
    "a similar argument leads to the second term , which accounts for edge creation events .",
    "equation can be transformed into an equation for @xmath310 by dividing through by @xmath28 , and then using the definitions @xmath315 and @xmath316 .",
    "we find @xmath317\\ ; ,      \\label{eq : appendix_p_rs_t}\\ ] ] which , upon substitution in eq .",
    ", yields @xmath318 \\left [ \\frac{f(c ) f(\\rho)}{f(p_{rs } ) } - 1\\right]\\;,\\ ] ] where @xmath319/[\\rho n(n-1)]$ ] is a non - negative factor , and where we have defined @xmath320 .",
    "it turns out that the sum is not only globally negative , but that each term is also individually negative , i.e. , @xmath321 \\left [ \\frac{f(c ) f(\\rho)}{f(p_{rs } ) } - 1\\right ] \\leq 0\\qquad \\forall r\\leq s.\\ ] ] this comes about because the sign of the logarithm always matches that of the bracket .    to prove this statement",
    ", we treat 5 different cases and use the following identities repeatedly : @xmath322 the cases are :    1 .   if @xmath323 : the logarithm equals 0 and the upper bound of eq",
    ".   holds .",
    "2 .   if @xmath324 and @xmath325 : the logarithm is positive [ see eq .  ] .",
    "the bracket is also positive , since inequality can be rewritten as @xmath326 using the fact that @xmath327 .",
    "this simplifies to @xmath328 , in line with our premise .",
    "if @xmath324 and @xmath329 : the logarithm is positive . using our premise , we conclude that @xmath330 and @xmath331",
    ". therefore , @xmath332 , i.e. , the bracket is positive .",
    "if @xmath333 and @xmath334 : the logarithm is negative . using our premise , we conclude that @xmath335 and @xmath336 .",
    "therefore , @xmath337 , i.e. , the bracket is negative .",
    "5 .   if @xmath333 and @xmath338 : the logarithm is negative .",
    "the bracket is also negative , since the converse of inequality can be rewritten as @xmath339 using the fact that @xmath340 .",
    "this simplifies to @xmath341 , in line with our premise .",
    "this list covers all cases , and therefore completes the proof that @xmath342 , i.e. , that average detectability decreases as a result of the application of a upp .",
    "in refs .  @xcite it is argued that sbm is undetectable when the extremal eigenvalues of the modularity matrix of its instances merge with the so - called `` continuous eigenvalue band '' .",
    "it is proved in ref .",
    "@xcite that this occurs when @xmath343 for the 2 block ssbm with poisson distributed degrees . since we are concerned with the finite case , let us first modify this result to account for binomial distributed degrees instead .",
    "it turns out that the corrected condition is found by substituting the expectations of poisson variables [ in the rhs of eq .",
    "] by that of binomial variables .",
    "this leads to @xmath344}\\;,\\ ] ] or , in terms of the natural parameters of the gmgm , @xmath345 this equation bears striking similarity with eq .  , our approximate equation for curves of constant @xmath102 .",
    "in fact , for the 2 block ssbm ( @xmath346 ) , the latter reads @xmath347 one obtains an exact equivalence between the two expressions by setting @xmath348 . the fact that modularity based spectral methods can not infer a correlated partition if @xmath349 [ eq .  ] can thus be understood as stemming from a lack of statistical evidence for the sbm .",
    "66ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase 10.1016/j.physrep.2009.11.002 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( )",
    "@noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) link:\\doibase 10.1073/pnas.0605965104 [ * * , ( ) ] @noop _ _  ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ( ,  )  pp .   @noop * * ,   ( ) @noop ( ) @noop ( ) @noop ( ) @noop _ _  ( , ) @noop ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.6084/m9.figshare.1164194 [ `` , ''  ] ( ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop _ _  ( , ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( ) @noop * * , ( ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )    * finite size analysis of the detectability limit of the stochastic block model + supplemental material *",
    "[ thm : avg_l ] let @xmath97 be the distribution over all graphs of @xmath1 nodes prescribed by the stochastic block model of parameters @xmath158 and block size vector @xmath243 .",
    "let @xmath96 be the distribution over all graphs of @xmath1 nodes , as prescribed by the erd - rnyi model @xmath350 , where @xmath351 is the average density and where @xmath352 is a function of @xmath243 .",
    "define @xmath85 as the random variable @xmath353 whose support is all graphs of @xmath1 nodes , drawn from distribution @xmath97 .",
    "then , @xmath354 where @xmath355 is the kullback - leibler divergence and @xmath356 is the binary entropy function .",
    "the first equality follows directly from the definition of the average of @xmath85 . in the main text",
    ", we argued that it was straightforward to show by direct calculation that @xmath102 led to @xmath357 ; we now carry out this calculation explicitly (  [ subsec : direct_proof_avg ] ) .",
    "we also give an alternative proof of theorem [ thm : avg_l ] , where we obtain the expression in terms of difference of entropies directly from the kl divergence (  [ subsec : info_proof_avg ] ) .",
    "note that to lighten the text , we will use `` @xmath34 '' as an abbreviation of the more precise `` @xmath358 '' .      as we show in the main text",
    ", one can think of the support of @xmath137 as all vertex labeled graphs of @xmath1 nodes , but also as all symmetric matrices @xmath359 with entries in @xmath360 and upper bounds given by @xmath361 .",
    "in other words , all graphs drawn from the sbm of parameters @xmath362 can be mapped to a particular realization of @xmath363 , drawn with probability @xmath364 } = \\prod_{r\\leq s } { \\mathrm{pr}\\left[m_{rs}\\right]}$ ] , where @xmath365}=\\binom{m_{rs}^{\\max}}{m_{rs } } p_{rs}^{m_{rs}}(1-p_{rs})^{m_{rs}^{\\max}-m_{rs}}$]is the probability mass function of the binomial distribution .    using this simpler definition of the random variable @xmath137",
    ", we write its expectation as @xmath366 } \\left\\ { \\sum_{r\\leq s } \\frac{m_{rs}}{m^{\\max } } \\log\\left[\\frac{p_{rs}}{\\rho}\\frac{1-\\rho}{1-p_{rs}}\\right ] + \\sum_{r\\leq s } \\alpha_{rs } \\log\\left[\\frac{1-p_{rs}}{1-\\rho}\\right]\\right\\}\\;.\\ ] ] it is straightforward to check that by the linearity of expectations @xmath367 }   \\sum_{r\\leq s } \\frac{m_{rs}}{m^{\\max } }   \\log\\left[\\frac{p_{rs}}{\\rho}\\frac{1-\\rho}{1-p_{rs}}\\right ]      & = \\sum_{r\\leq s } \\log\\left[\\frac{p_{rs}}{\\rho}\\frac{1-\\rho}{1-p_{rs}}\\right ]   \\frac{1}{m^{\\max}}\\sum_{\\bm{m } } { \\mathrm{pr}\\left[\\bm{m}\\right ] }     m_{rs } \\notag\\;,\\\\      & = \\sum_{r\\leq s } \\log\\left[\\frac{p_{rs}}{\\rho}\\frac{1-\\rho}{1-p_{rs}}\\right ]   \\frac{1}{m^{\\max } }   { \\langle m_{rs } \\rangle}\\notag\\;,\\\\      & = \\sum_{r\\leq s } \\log\\left[\\frac{p_{rs}}{\\rho}\\frac{1-\\rho}{1-p_{rs}}\\right]\\alpha_{rs}p_{rs}\\;,\\end{aligned}\\ ] ] where we have used @xmath368 to get the last equality . since the second summation in eq .",
    "is independent of @xmath363 , one obtains directly @xmath369 p_{rs } + \\log\\left[\\frac{1-p_{rs}}{1-\\rho}\\right]\\right\\}\\;,\\notag\\\\     & =   - \\sum_{r\\leq s } \\alpha_{rs } \\bigl[(1-p_{rs})\\log(1-\\rho ) + p_{rs}\\log \\rho\\bigr ] + \\sum_{r\\leq s } \\alpha_{rs } [ ( 1-p_{rs})\\log(1-p_{rs } ) + p_{rs}\\log p_{rs}]\\;,\\notag\\\\     & = h(\\rho ) -\\sum_{r\\leq s } \\alpha_{rs}\\ , h(p_{rs } ) \\;.\\label{eq : average_likelihood}\\end{aligned}\\ ] ] the final result follows from ( i ) the definition @xmath370 , ( ii ) the normalization of @xmath371 and ( iii ) the fact that the average density can be written as @xmath372 .",
    "we now provide an alternative proof of theorem [ thm : avg_l ] for the equation @xmath373 $ ] .",
    "the following chain rule holds for the kullback - leibler divergence @xcite : @xmath374 where @xmath375 are joint distributions for @xmath376 on the same supports @xmath377 .",
    "it is easy to see that if @xmath378 and @xmath379 are independent according to both distributions @xmath380 and @xmath2 , then the divergence is additive , i.e , @xmath381 this property trivially generalizes to an arbitrary number of random variables @xcite . because the distribution over all graphs can be seen as a product of independent distributions over all edges , we may write the kullback - leibler divergence as @xmath382 where @xmath383 and @xmath384 are the bernoulli random variables that govern the existence of the edge linking nodes @xmath15 and @xmath385 , according to the distribution @xmath97 and @xmath96 .",
    "these variables have two outcomes : either the edge exists with probability @xmath386 ( resp .",
    "@xmath387 ) , or does not with probability @xmath388 ( resp .",
    "@xmath389 ) . we write",
    "@xmath390 as an abbreviation of @xmath14 , the index of the block to which node @xmath15 belongs .",
    "the divergence associated with an edge is therefore @xmath391 where @xmath356 is , again , the binary entropy . now , taking @xmath392 for all pairs and summing over all edges [ see eq .  ] , we find , after grouping terms by types , @xmath393\\;.\\ ] ] the final result follows from the definition of the average density , after one substitutes @xmath28 for @xmath394 .",
    "[ thm : symmetries ] all transformations @xmath395 of the parameter space of the sbm that are ( i ) reversible , ( ii ) space - preserving , and ( iii ) valid at every point of the parameter space can be written as    [ eq_group : transformation_unconstrained_algebraic ] @xmath396    where @xmath397 and where @xmath398 and @xmath399 are permutations that acts on the set @xmath400 . under the additional constraint that @xmath401 be preserved by @xmath402 and equal to @xmath119 , one must have @xmath403    the ( constrained ) transformation that act on @xmath9 can be seen as an element of group @xmath404 . if @xmath405 , where @xmath2 is the dimension of @xmath87 and @xmath21 , then @xmath134 and @xmath135 can be seen as elements of the symmetric group @xmath406 .",
    "the constrained symmetry group is therefore @xmath407 , and it is of order @xmath408 .",
    "let us first introduce new notation to clarify the proof of theorem [ thm : symmetries ] .",
    "first , we will define vectors @xmath409 and @xmath410 whose entries are the @xmath127 entries of the upper triangle ( and diagonal ) of @xmath21 and @xmath87 .",
    "we use @xmath411 to denote the standard scalar product between vectors @xmath412 and @xmath413 in @xmath414 .",
    "thus , in particular , we will write the average density as @xmath415 and the average detectability as @xmath416 \\ ! p_{rs",
    "} + \\log\\!\\!\\left[\\frac{1-p_{rs}}{1-\\rho}\\right]\\!\\right\\}\\;,\\notag \\\\    & = \\braket{\\alpha|u(\\bm{\\alpha},\\bm{p})}\\ ; , \\label{eq : braket_def_l}\\end{aligned}\\ ] ] where @xmath417 is @xmath127dimensional vector parametrized by @xmath120 , whose entries are given by @xmath418 we also introduce @xmath419 and @xmath420 , two @xmath421 permutation matrices such that @xmath422 and @xmath423 , where @xmath424 is the element @xmath425 of vector @xmath412 ( we use double indexes in the vectors to emphasis the matrix to vector change in notation ) . in this notation , eqs .",
    "are given by    [ eq_group : transformation_unconstrained_matricial ] @xmath426    where @xmath427 is a diagonal matrix with element @xmath428 on the diagonal , where @xmath429 is the identity matrix , and where @xmath430 is also a diagonal matrix .",
    "the first part of theorem [ thm : symmetries ] follows trivially from the definition of the parameter space , and from the fact that transformations which meet requirements ( i ) , ( ii ) and ( iii ) are the symmetries of this space . since @xmath87 takes its value in the standard simplex of dimension @xmath128 and",
    "since @xmath21 is confined to the @xmath127dimensional unit cube , the complete parameter space is given by the cartesian product of both space  we can simply compose the symmetry group of both spaces to obtain the complete symmetry group .",
    "the symmetry group of the standard simplex and that of the unit cube are well - known results in geometry and algebra @xcite : the symmetry group of the @xmath127-dimensional unit cube is isomorphic to the hyperoctahedral group @xmath130 , and the symmetry group of the @xmath128-dimensional standard simplex is isomorphic to the symmetric group @xmath131 .",
    "their action can be written as in eq .",
    " , which proves the first part of the theorem .",
    "to prove the second part of the theorem , we look for the subset of all transformations of the form that also preserve @xmath102 , i.e. , transformations @xmath138 in @xmath431 that map @xmath120 to @xmath121 and that satisfy @xmath432 it is easy to check that if @xmath433 and @xmath434 with @xmath435 , then the average density equals @xmath436 with the same constraint on the permutations and @xmath437 , the average of the normalized log likelihood is given by , in the transformed parameters , @xmath438 - \\sum_{r\\leq s}\\alpha_{\\pi(r , s)}h[\\gamma + ( 1 - 2\\gamma)p_{\\pi(r , s)}]\\;,\\\\                                            & = h(\\rho ) -",
    "\\sum_{r\\leq s}\\alpha_{rs } h(p_{rs } )                                            = { \\langle \\mathcal{l}(\\bm{\\alpha},\\bm{p } ) \\rangle}\\;,\\end{aligned}\\ ] ] since @xmath439 and permutations can be ignored ( they induce an irrelevant reordering of the sum ) .",
    "the constrained transformations therefore preserve @xmath102 .",
    "+ the above calculation is the sufficient part of the proof . to complete the proof",
    "we must show that @xmath102 is conserved _ only if _ @xmath434 and @xmath433 .",
    "first , we note that by the properties of the scalar product and permutation matrices , we have the following obvious symmetry @xmath440 which is valid for all permutation matrices @xmath419 .",
    "we use this symmetry to `` shift '' all permutation matrices to the second part of the scalar product representation of @xmath102 , i.e. we write @xmath441 ( we use the fact that @xmath442 is a permutation matrix by definition ) .",
    "now , from eq .  , it is clear that we will have @xmath443 if and only if @xmath444 where @xmath445 .",
    "since @xmath446 is analytic in @xmath87 , we can expand it by using taylor series ; this creates an infinite series of constraints that must all be satisfied .",
    "in particular , condition will be satisfied only if @xmath447 this is true if and only if , for all @xmath136 , one has @xmath448 where @xmath449 . here",
    ", @xmath450 is the transformed vector @xmath451 , on which the inverse of permutation @xmath134 is also applied .",
    "note that in writing condition we have used @xmath452 in the denominators .",
    "let us now suppose that @xmath87 tends to the point @xmath453 , which is such that @xmath454 for all @xmath136 except for @xmath455 ( i.e. , @xmath456 ) . in this limit , eq",
    ".   reads @xmath457 which is trivially satisfied when @xmath455 but not otherwise .",
    "let us suppose @xmath458 and expand the equation around @xmath459",
    ". from this second series expansion one concludes that the equality is satisfied if either @xmath460 or @xmath461 . in both cases",
    ", the indices must match , which implies that @xmath462 . by repeating the same argument for all @xmath463 ,",
    "we conclude that @xmath464 .",
    "thus , the map @xmath465 is a symmetry only if @xmath466 .",
    "this leaves the last part open , i.e. , the proof that @xmath434 .",
    "let us , by contradiction , assume that @xmath428 differs from one set of indices to the other and define the sets @xmath467 and @xmath468 by @xmath469 then one can write @xmath470 where @xmath471 returning to eq .   for @xmath472 and using the newfound fact that @xmath473 which implies @xmath474 ( no more permutations ) , we find @xmath475 this can only be true if @xmath476 , i.e. , if @xmath477 or @xmath478 .",
    "therefore , @xmath141 @xmath479 , with @xmath435 .",
    "[ thm : convexity ] @xmath401 is convex with respect to @xmath21 .",
    "this property of @xmath102 is  perhaps surprisingly  not a consequence of the convexity of the kl divergence .",
    "instead , it follows from the log - sum inequality .",
    "we prove that @xmath401 is convex with respect to @xmath21 by showing that it satisfies the convexity condition @xmath480 explicitly for all @xmath481 $ ] .",
    "again , for the sake of clarity , we will use the notation developed in the previous section , and , in particular , write the density as @xmath482 . focusing on one of the terms on the lhs of eq .",
    ", we have @xmath483\\log\\frac{(1-t)p_{rs } + tq_{rs } } { ( 1-t)\\braket{\\alpha|p}+t\\braket{\\alpha|q}}+ [ 1-(1-t)p_{rs } - tq_{rs}]\\log\\frac{1-(1-t)p_{rs } - tq_{rs}}{1-(1-t)\\braket{\\alpha|p}-t\\braket{\\alpha|q } }   \\bigg\\}\\\\      = \\alpha_{rs}\\bigg\\{[(1-t)p_{rs } + tq_{rs } ] \\log\\frac{(1-t)p_{rs } + tq_{rs } } { ( 1-t)\\braket{\\alpha|p}+t\\braket{\\alpha|q}}\\\\+ [ ( 1-t)(1-p_{rs})+t(1-q_{rs})]\\log\\frac{(1-t)(1-p_{rs})+t(1-q_{rs})}{(1-t)(1-\\braket{\\alpha|p})+t(1-\\braket{\\alpha|q } ) }   \\bigg\\ }      \\label{eq : term_explicit }    \\end{gathered}\\ ] ] it is easy to see that the log - sum inequality @xmath484 can be applied to both parts of eq .   to separate terms by their coefficients @xmath485 and @xmath306 . repeating the same operation on all terms yields inequality  .",
    "[ cor : detect_easy ] define @xmath486 as the average of the random variable @xmath487\\;,\\ ] ] where @xmath18 is drawn from the sbm of parameters @xmath120 , and where @xmath488 are the maximum likelihood estimator of @xmath489 computed from the planted partition @xmath33 , i.e. , @xmath490 where @xmath491 and @xmath492 .",
    "then , the following inequality holds @xmath493    from the calculations of sec .",
    "[ section : proof_avg_l ] , we know that @xmath102 can be written as @xmath494 or , equivalently , as @xmath495 where @xmath496 and @xmath497 are the expected values of the estimators .",
    "jensen s inequality then prescribes @xmath498    corollary  [ cor : detect_easy ] says that estimating the parameters simplifies the detection problem _ under certain particular conditions_a result whose consequence are not immediately obvious .",
    "it can be understood on an intuitive level as follows : suppose that we use the density matrix @xmath499 ( with @xmath500 ) and that , for the sake of simplicity , @xmath115 $ ] . then , consider the instance with edge count matrix @xmath501,[n^2/4,0]]$ ]",
    ". the likelihood ratio will be much smaller if one compares hypotheses with the true parameters instead of with the parameters estimated from @xmath33 .",
    "one could argue that a large ratio would be appropriate here ; the partition is , after all , very clear .",
    "but the instance actually contains little information on the planted partition , since the observed structure is _ not _ due to the planted partition but instead to an extreme random fluctuation .",
    "corollary  [ cor : detect_easy ] can therefore be taken as a cautionary tale : parameter estimation _ creates _ statistical evidence , and it must be handled carefully .",
    "in the main text , we have analyzed the general modular graph model of ref .",
    "@xcite and have shown how our framework yielded nicely interpretable expressions for such a low - dimensional model .",
    "we now investigate another simple model  the general two blocks sbm  which also lends itself to exhaustive analysis .      the parametrization of the two blocks sbm is specified with the 3 probabilities @xmath502 as well as the two blocks sizes , @xmath503 and @xmath504 .",
    "it contains the core - periphery model ( with @xmath505 and @xmath506 ) and the ssbm ( @xmath507 ) as special cases .",
    "we follow the path laid out in our analysis of the gmgm and obtain a natural parametrization in terms of average density and displacement from the equivalent random model .",
    "the simplest parameterization of this kind is perhaps    [ eq : two_blocks_params ] @xmath508    figure [ fig : two_block_sbm ] ( a ) illustrates the change of variables",
    ". it amounts to placing ourselves in a plane of constant density in the @xmath509 space , then measuring the distance from the point @xmath510 in the @xmath511 and @xmath512 direction .",
    "again , much like in the case of the gmgm , not all @xmath513 tuples correspond to probabilities  it is only true for the region of the constant density plane contained inside @xmath251 ^ 3 $ ] .",
    "when @xmath63 is close to 0 or 1 , this region is a triangle . at intermediate values of @xmath63 , parts of the triangle lie outside the cube of probabilities  the region is then a polygon of more than 3 edges , see fig .",
    "[ fig : two_block_sbm ] ( b ) for an example .",
    "we do not investigate the general 2 blocks sbm as thoroughly as the gmgm , since much of the results and observations are identical to those of the previous case study .",
    "it will , however , be instructive to consider the average detectability and symmetries of this simple model .",
    "the average log - likelihood @xmath102 is , in the @xmath514 space , @xmath515\\right\\}\\notag\\\\                                                        + ( 1-\\beta)^2&\\left\\{h(\\rho ) - h\\left [ \\rho + \\frac{\\beta^2}{1 - 2\\beta(1-\\beta)}\\delta_x - 2\\beta(1-\\beta)\\delta_y \\right]\\right\\}\\notag\\\\                                                        + 2\\beta(1-\\beta)&\\left\\{h(\\rho ) - h\\left [ \\rho + [ 1 - 2\\beta(1-\\beta)]\\delta_y \\right]\\right\\}\\;,\\end{aligned}\\ ] ] our main objective in studying the two - blocks sbm is to showcase anew the technique introduced in the main text to compute the hypersurfaces of constant @xmath102 .",
    "the first step is to invert the parametrization   @xmath516 upon substitution of these parameters in @xmath517\\;,\\ ] ] one finds @xmath518 + \\delta_y^2[\\alpha_{12}(1-\\alpha_{12})]\\;.\\end{aligned}\\ ] ]        equation predicts that these hypersurfaces are ellipses in the plane of constant density @xmath63 , centered at @xmath519 , with major axis @xmath520 and minor axis @xmath521 .",
    "this result is put to the test in fig .",
    "[ fig : two_block_sbm ] ( b ) , where we also show numerical solutions for comparison",
    ". agreement is , once again , excellent when @xmath119 is not too large , while @xmath522 leads to significant errors in our prediction . following the ellipses in fig .",
    "[ fig : two_block_sbm]-(c ) shows that that the easiest inference problems  those where @xmath102 is the largest  are the ones in the corner on the edges of the accessible region .",
    "these regions are those where block pairs are well segregated , i.e. , the bipartite ensemble with @xmath523 [ top - corner ] , the perfectly assortative cases with @xmath524 where @xmath525 is a constant [ bottom edge ] .",
    "the purpose of the parametrization @xmath513 is to facilitate the calculation of hypersurfaces of constant @xmath102 . for the gmgm",
    ", the natural parametrization also had the added benefit of highlighting the symmetries naturally .",
    "this needs not be the case in all variants of the sbm , as we now show .",
    "let us first simplify the notation ; we define @xmath241 as the fraction of nodes that belong to block @xmath66 , i.e. , @xmath526 and @xmath527 ( not to be confused with the @xmath241 of the gmgm ) . in the limit where @xmath528 , we then have @xmath529 since the parametrization assigns a special significance to the @xmath530 direction , the symmetries that involve these two blocks [ and _ not _ the @xmath531 pair ] , are the simplest . by direct enumeration",
    ", one finds    @xmath532    i.e. , the identity , the pure graph complement , the permutation of block pairs ( 0,0 ) and ( 1,1 ) , and the same permutation accompanied by the graph complement . notice how this subset of transformation forms , once again , a group isomorphic to the klein four - group .",
    "the transformation equations would be , however , much less compact if we were to list transformations involving , say , cyclic permutations of the blocks .",
    "this situation is common : choices of parameters that favor a particular pair of blocks will yield compact symmetry equations for this pair of blocks , but not the others .",
    "therefore symmetries are , in general , best expressed directly in terms of @xmath87 and @xmath21 , unless the model has a special and all encompassing parametrization  like the gmgm .",
    "in this short section , we detail the inference algorithm used in the case studies of the main text .",
    "optimal inference can be achieved ( quite inefficiently ) by evaluating the complete posterior distribution of the model @xmath533 for all possible partitions .",
    "the idea is to construct the marginal distribution @xcite @xmath534 which gives the probability that node @xmath15 is in block @xmath6 , given a network @xmath18 and some generating parameter @xmath21 and @xmath243 [ @xmath14 denotes the index of the block of node @xmath15 in partition @xmath535 .",
    "it is easy to see that we can then maximize the probability of guessing the partition correctly by assigning nodes according to @xmath536 while this method is attracting , it runs into an important problem very quickly , for it is impossible to compute the marginal distribution exactly for networks of even moderate size  an exponential number of terms is involved .",
    "there are multiple ways to circumvent this problem .",
    "a popular method is to construct the marginal distribution directly , using a belief propagation ( bp ) algorithm @xcite ( see ref .",
    "@xcite for an overview of related method ) .",
    "bp based methods are extremely efficient , since their complexity is of the order of the number of edges in the network @xcite .",
    "moreover , they work virtually perfectly for all practical purposes @xcite .",
    "the only problem is that bp algorithms rely on the hypothesis that the network is locally tree - like ; this is never entirely true , but still a reasonable approximation for sparse instances of the sbm .",
    "unfortunately , since our analysis calls for accurate results in all regimes ( i.e. , not only on sparse networks ) , we are forced to turn an inefficient alternative of bp , the markov chain monte carlo ( mcmc ) method @xcite .",
    "_ sample _ from the posterior distribution and can therefore be used to estimate the marginal distribution of eq .  .",
    "we will use one of the simplest implementation of the mcmc method , the metropolis - hastings algorithm .",
    "one only needs to specify a _",
    "proposal distribution _",
    "( given a partition @xmath537 , what is the probability that the next partition in the chain is @xmath538 ? ) and an _ acceptance probability _",
    "@xmath539 proportional to @xmath540 for all proposed transitions .",
    "the proposal distribution usually intervenes in the calculation of @xmath541 but will not be needed here , since we opt for a symmetric distribution ( see next paragraph ) .",
    "the chain formed by accepting transitions @xmath542 with probability @xmath543 is then ergodic if a number of conditions are met ( e.g. , the proposal distribution must respect the detailed balance )",
    ".    our proposal distribution will be simple : take a node at random , and assign it to a random block ( see ref .",
    "@xcite for a more efficient alternative ) .",
    "one can easily check that this distribution meets all the necessary conditions for the ergodicity of the markov chain .",
    "following an argument analogous to that of ref .",
    "@xcite , we find that the acceptance probability associated to this proposal distribution is @xmath544^{k_r^{(i)}}\\!\\!\\left[\\frac{p_{ss}(1-p_{rs})}{p_{rs}(1-p_{ss})}\\right]^{k_s^{(i)}}\\!\\ !",
    "\\left[\\frac{1-p_{rs}}{1-p_{rr}}\\right]^{n_r -1}\\!\\!\\left[\\frac{1-p_{ss}}{1-p_{rs}}\\right]^{n_s }    \\prod_{l\\neq r , s } \\left[\\frac{p_{ls}(1-p_{rl})}{p_{rl}(1-p_{ls})}\\right]^{k_l^{(i)}}\\!\\!\\!\\!\\left[\\frac{1-p_{ls}}{1-p_{rl}}\\right]^{n_l}\\ ; ,    \\label{eq : a_sbm_single}\\end{gathered}\\ ] ] if node @xmath15 is switched from block @xmath6 to block @xmath8 , with @xmath545 denoting the number of neighbors of node @xmath15 in block @xmath6 . since there are @xmath546 terms in eq .",
    ", transition probabilities can be calculated in @xmath547 time , assuming that products and exponentiations are @xmath548 , and that one keeps @xmath549 items in memory to track the neighborhoods and the block assignments .",
    "updating the memberships and neighborhoods is then a @xmath550 operation .",
    "the memory cost can be reduced to @xmath551 if the neighborhoods @xmath552 are computed on the fly .",
    "this comes at no significant costs since keeping the memory up - to - date is as expensive as computing the memberships every time .",
    "we give a reference implementation of the algorithm at www.github.com/jg-you/sbm_canonical_mcmc .",
    "also , we note that if one samples from the general modular graph model ( gmgm ) , the algorithmic complexity is dramatically reduced , since the acceptance probability then simplifies to @xmath553^{k_s^{(i)}-k_r^{(i)}}\\left[\\frac{1-p_{in}}{1-p_{out}}\\right]^{(n_s - k_s^{(i)})-(n_r - k_r^{(i ) } ) + 1}\\ ; ,    \\label{eq : a_ppm_single}\\ ] ] i.e. , the transition probability only depends on the blocks of the nodes involved in the mcmc move .      in a normal",
    "setting  where the planted partition is not known ",
    "one would initialize the metropolis - hastings at random or using the partition generated by a simpler algorithm .",
    "but since we are interested in _ detectability _ , we might as well initialize the chain with the planted partition itself .",
    "if the partition is undetectable , then the algorithm will show no particular preference for this initial configuration and `` wander away '' towards partitions uncorrelated with the planted partition .",
    "however , if the partition is detectable , then the chain will concentrate around the initial configuration , and the marginal distribution will yield a distribution correlated with the planted partition .",
    "this choice of initial condition is not merely a trick to avoid transients : it also allows correlated recovery even in the _ hard phase _ , where the planted partition is detectable , but exponentially hard to find .",
    "in this phase , the planted partition is identifiable but not globally stable , in the sense that many other locally optimal partitions exist @xcite .",
    "when this is the case , an algorithm that relies on local information  such as the metropolis - hastings algorithm  cannot be expected to identify the correct partition . by seeding the algorithm with the planted partition ,",
    "we ensure that it will be found ( if it is detectable ) .      even though we seed the inference algorithm with the planted partition",
    ", the chain can still go through a transient before it settles in its steady state , since the planted partition need not be typical of the stationary distribution .",
    "this can cause problems , since one must ensure that the chain has settled before the sampling begins  otherwise biased results are to be expected . in fig .",
    "[ fig : mcmc_calibration ] , we show the distance between the partition currently consider by the algorithm and the initial condition for different parametrization of the gmgm .",
    "these results show that the transient can be extremely long when there is little difference between the parameters of the ensemble and that of the equivalent random ensemble .",
    "for instance , the bottom panel of fig .",
    "[ fig : mcmc_calibration ] show that the algorithm is still in the transient after @xmath554 steps , when it is applied to instances of the gmg with @xmath291 , @xmath555 $ ] , @xmath280 and @xmath556 . to avoid biases",
    "we only start sampling after an initial burn - in period of @xmath557 steps ( when @xmath277 ) and of @xmath558 steps ( when @xmath281 ) . the numerical results of fig  [ fig : mcmc_calibration ] indicate that the chain will have settled by then , on average .     nodes and ( bottom panel ) @xmath281 nodes .",
    "the vi is a metric that quantifies the distance between two partitions @xcite .",
    "its maximum equals @xmath559 when the two compared partition have both @xmath2 clusters and @xmath560 ( this is the case here ) . each line shows the average of ( top panel ) @xmath561 ( bottom panel ) @xmath562 independent mh run , using a random network instance and the planted partition as an initial condition each time .",
    "we only show positive values of @xmath238 for the sake of clarity ; the results are similar for negative values of @xmath238 .",
    ", title=\"fig : \" ]   nodes and ( bottom panel ) @xmath281 nodes .",
    "the vi is a metric that quantifies the distance between two partitions @xcite .",
    "its maximum equals @xmath559 when the two compared partition have both @xmath2 clusters and @xmath560 ( this is the case here ) .",
    "each line shows the average of ( top panel ) @xmath561 ( bottom panel ) @xmath562 independent mh run , using a random network instance and the planted partition as an initial condition each time .",
    "we only show positive values of @xmath238 for the sake of clarity ; the results are similar for negative values of @xmath238 .",
    ", title=\"fig : \" ]    11ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( ,  ) @noop _ _  ( ,  ) @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> it has been shown in recent years that the stochastic block model is undetectable in the sparse limit , i.e. , that no algorithm can identify a partition correlated with the partition used to generate an instance , if the instance is sparse and infinitely large . </S>",
    "<S> real networks are however finite objects , and one can not expect all results derived in the infinite limit to hold for finite instances . in this contribution , we treat the finite case explicitly . </S>",
    "<S> we give a necessary condition for finite size detectability in the general sbm , using arguments drawn from information theory and statistics . </S>",
    "<S> we then distinguish the concept of average detectability from the concept of instance - by - instance detectability , and give explicit formulas for both definitions . using these formulas </S>",
    "<S> , we prove that there exist large equivalence classes of parameters , where widely different network ensembles are equally detectable with respect to our definitions of detectability . in an extensive case study </S>",
    "<S> , we investigate the finite size detectability of a simplified variant of the sbm , which encompasses a number of important models as special cases . </S>",
    "<S> these models include the symmetric sbm , the planted coloring model , and more exotic sbms not previously studied . </S>",
    "<S> we obtain a number of explicit expressions for this variant , and also show that the well - known kesten - stigum bound does not capture the phenomenon of finite size detectability  even at the qualitative level . </S>",
    "<S> we conclude with two appendices , where we study the interplay of noise and detectability , and establish a connection between our information - theoretic approach and random matrix theory . </S>"
  ]
}