{
  "article_text": [
    "pressure is one of the fundamental thermodynamic variables . the calculation of pressures in fluid systems using computer simulations is generally considered to be a routine task .",
    "however , difficulties arise in the presence of long - range interactions . here",
    ", we investigate the calculation of pressures in computer simulations of charged and polar systems , where the long - range coulomb interactions are commonly treated with ewald lattice summation@xcite or physically equivalent methods like particle - mesh ewald,@xcite kubic - harmonic expansions,@xcite or lekner sums.@xcite a mechanistic definition of the pressure leads to the standard virial expression .",
    "a thermodynamic definition of the pressure is based on the volume dependence of the helmholtz free energy .",
    "when the coulomb interactions are resummed by using , e.g. , the ewald method , the resulting effective pair interactions depend explicitly on the volume .",
    "in addition , self interactions are present that also depend on the volume . as a consequence ,",
    "the virial and thermodynamic pressures are not identical for finite coulomb systems , even though the two pressures are expected to converge in the thermodynamic limit .",
    "the paper is organized as follows : in section [ sec : theory ] , we derive expressions for the virial and thermodynamic pressures . in section [ sec : presscoul ] , we study the pressure in systems with long - range coulomb interactions . for the thermodynamic pressure , we derive a simple formula that can be readily implemented in standard molecular dynamics or monte carlo codes . in sections [ sec : sim ] and [ sec : spce ] , we study the system size dependence of the virial and thermodynamic pressures for the extended simple point charge ( spc / e ) water model@xcite under standard conditions .",
    "the pressure @xmath0 can be calculated from a mechanistic prescription equating the exterior and interior forces on the container .",
    "this leads to the virial expression for the pressure in an atomic system,@xcite @xmath1 where @xmath2 is the number density of particles ; @xmath3 is boltzmann s constant ; @xmath4 is the temperature ( @xmath5 ) ; and @xmath6 is the volume .",
    "the sum extends over the scalar product betwen particle positions @xmath7 and forces @xmath8 exerted on particle @xmath9 due to other particles in the system .",
    "@xmath10 denotes a canonical average . for computer simulations under periodic boundary conditions with pair forces , it is convenient to rewrite the virial equation in a form that makes the translational invariance explicit : @xmath11 where @xmath12 and @xmath13 is the pair force exerted on particle @xmath9 by particle @xmath14 , derived from a pair potential @xmath15 ; and the sum is over all pairs of particles in the system .    for a system of rigid polyatomic molecules",
    "@xmath16 with interaction sites @xmath17 and @xmath18 , one obtains an analogous formula when the forces @xmath19 between molecular sites are projected onto a vector @xmath20 between the `` centers '' of the two molecules ( e.g. , the center of mass ) , @xmath21 here , @xmath22 is the net force between two rigid molecules , summed over molecular sites @xmath17 and @xmath18 .",
    "otherwise , the constraint forces maintaining the rigidity of the molecules have to be included explicitly in eq .",
    "( [ eq : virial_pair_mol ] ) .",
    "the thermodynamic expression for the pressure is derived from the relation between the pressure @xmath23 , the helmholtz free energy @xmath24 , and the volume @xmath6 , @xmath25 the statistical - mechanical relation between the free energy @xmath24 and the partition function @xmath26 for @xmath27 identical classical particles in a canonical ensemble is : @xmath28 where @xmath29 is planck s constant ; @xmath30 is the hamiltonian ; and the integration extends over the positions @xmath31 and momenta @xmath32 of all particles . in taking the volume derivative eq .",
    "( [ eq : p_therm ] ) , the kinetic energy @xmath33 is independent of the volume .",
    "transforming the positional coordinates into dimensionless form , @xmath34 , and pulling out a factor @xmath35 from the integral , leads to the ideal gas term @xmath36 for the pressure .",
    "the non - ideal contributions are contained in the volume dependence of the potential energy @xmath37 , @xmath38 typically , @xmath37 does not depend explicitly on the volume .",
    "the volume dependence of @xmath37 then arises from the volume scaling of the particle positions . in the absence of an explicit volume dependence",
    ", we can express @xmath39 as @xmath40 with @xmath41 . by using @xmath42 and combining eqs .",
    "( [ eq : pcanon ] ) and ( [ eq : dudv ] ) , we find the corresponding thermodynamic pressure to be equivalent to the mechanistic pressure eq .",
    "( [ eq : virial ] ) .",
    "the identity between the virial and thermodynamic pressures , eqs .",
    "( [ eq : virial ] ) and ( [ eq : pcanon ] ) , does not hold if the potential depends explicitly on the system volume .",
    "such an explicit volume dependence arises in computer simulations of charged and polar substances , when the long - range coulomb interactions are resummed , e.g. , by using the ewald method.@xcite    we first split the total potential energy @xmath37 into a short - range part @xmath43 and a long - range coulomb part @xmath44 , @xmath45 the pressure @xmath46 corresponding to @xmath43 contains the ideal - gas term and the contributions from short - range pair interactions , @xmath47 where the short - range forces @xmath48 are those derived from the short - range part @xmath43 of the potential energy .",
    "note that the virial and thermodynamic expressions for @xmath46 are equivalent , and therefore the subscripts `` _ v _ '' or `` _ t _ '' have been omitted in eq .",
    "( [ eq : pshort ] ) .",
    "next , we consider the pressure arising from the potential energy @xmath44 of long - range coulomb interactions . in ewald lattice summation ,",
    "the charges in a periodically replicated simulation box interact with an effective potential . that potential is obtained from a summation over all periodic images .",
    "in addition , a self interaction arises from interactions with a particle s own images .",
    "this leads to a coulomb energy @xmath44 for a system of partial charges @xmath49 at positions @xmath50 : @xmath51\\nonumber\\\\ & &   + \\frac{1}{2 } \\sum_{i }    \\sum_{\\alpha } { q_{i\\alpha}}^2 \\lim_{{\\bf r}\\rightarrow 0 }    \\left[\\varphi({\\bf r})-\\frac{1}{|{\\bf r}|}\\right]~.\\end{aligned}\\ ] ] the first sum is the intermolecular contribution ; the second and third sums are the intramolecular contributions , with the self interactions contained in the third sum .",
    "@xmath52 is the effective , resummed coulomb potential , with a fourier representation:@xcite @xmath53 where the @xmath54 sum extends over the reciprocal lattice corresponding to the lattice vectors @xmath55 of periodically replicated simulation boxes . in a cubic lattice of length @xmath56",
    ", we have @xmath57 , and @xmath58 , where @xmath9 , @xmath14 , and @xmath59 are integers .",
    "it is numerically convenient to partly transform @xmath52 into real space , leading to its ewald lattice sum representation , @xmath60 @xmath61 is a convergence parameter chosen to accelerate numerical convergence .",
    "the value of @xmath52 is independent of @xmath61,@xcite @xmath62 the self - interactions in @xmath44 are given by the interactions of a unit point charge with its periodic images , subtracting the bare self interaction , @xmath63 , with the appropriate limit taken for @xmath64 .",
    "for a given box shape , @xmath52 scales with the box volume @xmath6 as    [ eq : phiscale ] @xmath65    where star superscripts denote volume - independent quantities .",
    "this follows from eq .",
    "( [ eq : phi_four ] ) with volume scaling @xmath66 and @xmath67 .",
    "the same scaling is true trivially for the direct @xmath68 interactions . for an ionic system of point charges without bond constraints ,",
    "( [ eq : pcanon ] ) and ( [ eq : phiscale ] ) immediately lead to an expression for the thermodynamic pressure in terms of the coulomb energy @xmath44 , @xmath69 equation  ( [ eq : pionic ] ) gives the well - known relation between the pressure and energy of an ionic system , for which the coulomb energy is a homogeneous function of degree @xmath70 in the coordinates.@xcite      for a system of rigid molecules , we find the following volume scaling :    [ eq : molscal ] @xmath71~,\\\\      \\frac{\\partial}{\\partial v } \\frac{1}{|{\\bf r}_{i\\alpha i\\beta}| } &      = & -\\frac{1}{3v}\\left[\\frac{1}{|{\\bf r}_{i\\alpha i\\beta}| } +      \\frac{\\partial}{\\partial { \\bf r}_{i\\alpha i\\beta } }      \\frac{1}{|{\\bf r}_{i\\alpha i\\beta}|}\\cdot { \\bf          d}_{i\\alpha i\\beta}\\right ] \\equiv 0~ ,      \\label{eq : drv }    \\end{aligned}\\ ] ]    where @xmath20 is the distance vector between two molecule centers ; @xmath72 is the vector from the center to site @xmath17 ; and @xmath73 .",
    "equation  ( [ eq : drv ] ) follows from the volume independence of the intramolecular distance vector @xmath74 . combining eqs .",
    "( [ eq : uew ] ) and ( [ eq : molscal ] ) , we find for the volume derivative of the coulomb energy : @xmath75      \\cdot { \\bf d}_{i\\alpha j\\beta}\\right .    \\nonumber\\\\&&\\left .",
    "+ \\sum_{i }      \\sum_{\\alpha,\\beta \\atop \\alpha<\\beta }      \\left[\\frac{\\partial}{\\partial { \\bf r}_{i\\alpha i\\beta } }        q_{i\\alpha } q_{i\\beta }   \\left(\\varphi({\\bf r}_{i\\alpha            i\\beta})-\\frac{1}{|{\\bf r}_{i\\alpha i\\beta}|}\\right)\\right ]      \\cdot { \\bf d}_{i\\alpha i\\beta }    \\right\\}~.\\end{aligned}\\ ] ] we can simplify @xmath76 further by expressing it in terms of the intermolecular forces @xmath77 exerted by site @xmath78 onto site @xmath79 , @xmath80 and the intramolecular forces @xmath81 , @xmath82   = - { \\bf f}^{\\rm ( intra)}_{i\\beta      i\\alpha}~.\\end{aligned}\\ ] ] this leads to @xmath83 the sums over pairs of sites @xmath84 and @xmath85 can be rewritten as a single sum over all sites .",
    "this is possible because the distances @xmath86 are intramolecular and are continuous when a particle crosses the box boundary ( i.e. , @xmath87 does not change when the periodic images of the particles @xmath9 or @xmath14 are used ) .",
    "this results in @xmath88~,\\end{aligned}\\ ] ] where @xmath89 is the net intermolecular force on site @xmath84 , @xmath90 and @xmath91 is the net intramolecular force on site @xmath84 , @xmath92 it is advantageous to add the intra and intermolecular forces because in common ewald - sum implementations the fourier term already contains the sum of both inter and intramolecular contributions which are thus not easily separated .",
    "we define the net coulomb force @xmath93 on site @xmath84 as the sum of the inter and intramolecular forces , @xmath94 we then find for the thermodynamic pressure of a system of rigid molecules : @xmath95 thus the presence of intramolecular constraints in rigid polyatomic molecules resulted in a force term to be subtracted from the pressure of the purely ionic system , eq .",
    "( [ eq : pionic ] ) .",
    "note that the forces @xmath96 in eq .",
    "( [ eq : pmol ] ) are derived from the coulomb energy @xmath44 alone .",
    "additional ideal - gas and short - range contributions to the pressure are reflected in @xmath46 .",
    "the infinite ewald lattice is implicitly embedded in a conducting medium with dielectric constant @xmath97 , corresponding to `` tin - foil '' boundary conditions .",
    "this is the appropriate choice for a conducting medium .",
    "however , for a polar substance it can be advantageous to use a reaction - field dielectric constant @xmath98 similar to that of the bulk medium.@xcite the resulting correction to the coulomb energy @xmath99",
    "is@xcite @xmath100 @xmath101 is the instantaneous dipole moment of the simulation volume arising from the dipole moments @xmath102 of individual molecules , @xmath103 for rigid molecules the @xmath102 do not change with volume .",
    "the reaction - field correction , eq .",
    "( [ eq : eps_rf ] ) , thus scales as @xmath104 , @xmath105 the forces derived from the reaction - field correction are @xmath106 by using eq .",
    "( [ eq : m ] ) , we can express the sum of reaction - field forces projected onto the intramolecular distance vectors in terms of the reaction - field energy @xmath107 , @xmath108 accordingly , the volume derivative of the reaction - field energy @xmath109 can be written as @xmath110~.\\end{aligned}\\ ] ] the correction eq .",
    "( [ eq : eps_rf ] ) for a finite reaction - field dielectric constant @xmath98 then leads to an expression for the thermodynamic pressure analogous to eq .",
    "( [ eq : pmol ] ) , @xmath111~.\\end{aligned}\\ ] ] here , the forces @xmath112 are derived from the coulomb energy @xmath113 @xmath114 and contain the reaction field contribution @xmath115 defined in eq .",
    "( [ eq : dumdr ] ) .",
    "we emphasize the simplicity of the pressure expressions eqs .",
    "( [ eq : pmol ] ) and ( [ eq : pmol_m ] ) for systems of rigid molecules .",
    "the coulomb energy contribution @xmath116 is analogous to that of the corresponding ionic system , eq .",
    "( [ eq : pionic ] ) , corrected for the presence of constraint forces . a more or less equivalent expression for the pressure in coulombic systems treated with ewald summation",
    "was derived before by smith,@xcite and similarly by boulougouris _",
    "et al._@xcite .",
    "however , in those derivations the volume derivative was carried out explicitly for the ewald energy . also , the derivations start from an approximate expression for the ewald energy that does not include the full real - space lattice sum and self terms",
    ". therefore , the derivations did not arrive at a closed expression and the simplicity of the results given here was masked .",
    "expressions for the pressure tensor @xmath117 for ewald summation were derived previously by nos and klein,@xcite and heyes,@xcite as discussed by alejandre _",
    "et al._,@xcite as well as by others.@xcite however , the tensor character does not lend itself easily to a compact notation for the bulk pressure @xmath118 in a homogeneous system .",
    "equations  ( [ eq : pionic ] ) , ( [ eq : pmol ] ) , and ( [ eq : pmol_m ] ) have the advantage of being independent of the specific method used to evaluate the energies and forces .",
    "all that is needed is the total coulomb energy and forces at all sites that are consistent with that energy .",
    "this is what molecular dynamics codes will normally produce at no additional cost .",
    "the coulomb interactions can then be evaluated by using conventional ewald sums,@xcite particle - mesh ewald,@xcite kubic - harmonic expansion@xcite , or lekner sums.@xcite for approximate coulomb energy calculations such as reaction - field@xcite or generalized reaction - field methods,@xcite eqs .",
    "( [ eq : pionic ] ) , ( [ eq : pmol ] ) , and ( [ eq : pmol_m ] ) suggest an evaluation of the pressure that is formally consistent with that of ewald sums and physically equivalent methods .",
    "to investigate the quantitative differences between the virial and thermodynamic pressures , we study a model of water at standard conditions ( 298  k temperature , 997.07 kg m@xmath119 mass density corresponding to a number density of @xmath120 nm@xmath119 ) .",
    "we use the spc / e model of water,@xcite formed by a lennard - jones center on the oxygens , @xmath121 where @xmath122 kj nm@xmath123/mol and @xmath124 kj nm@xmath125/mol .",
    "in addition , the spc / e model carries three partial charges .",
    "the hydrogen and oxygen sites carry charges @xmath126 and @xmath127 , respectively , where @xmath128 is the elementary charge .",
    "the oxygen - hydrogen bond length is 0.1 nm , the hydrogen - oxygen - hydrogen bond angle is @xmath129 deg .",
    "we use metropolis monte carlo simulations for the canonical sampling,@xcite where the translational and rotational move widths are chosen to give an acceptance rate of about 40 per cent .",
    "ewald summation is used for the electrostatic interactions , with @xmath130 where @xmath56 is the length of the cubic box .",
    "a spherical cutoff of @xmath131 is used for the real space interactions ( charge and lennard - jones ) .",
    "the real - space potentials are shifted by a constant , such that they are zero at the cutoff .",
    "the fourier space sum is truncated at @xmath132 , leading to @xmath133 @xmath54 vectors being considered .",
    "a reaction - field dielectric constant of @xmath134 has been used in all simulations .",
    "standard finite - size corrections were applied to the lennard - jones contributions to pressure and potential energy.@xcite    system sizes of @xmath135 , 32 , 64 , 128 , 256 , and 512 water molecules are studied . starting from random configurations",
    ", these systems have been equilibrated for at least 250000 monte carlo passes .",
    "( one pass corresponds to one attempted move for each of the @xmath27 particles . ) in the production runs , the energy as well as the virial and thermodynamic pressures are calculated every tenth pass .",
    "table  [ tab : p ] contains the simulation characteristics , as well as results for the virial and thermodynamic pressures .",
    "the thermodynamic pressure is calculated using eq .",
    "( [ eq : pmol_m ] ) .",
    "the virial pressure is calculated using eq .",
    "( [ eq : virial_pair_mol ] ) , where the pair forces are derived from the total potential energy @xmath136 . also included in table  [ tab : p ] are results for the average potential energy per particle .",
    "( to compare with the experimental energy , one has to add a polarization correction of 5.22 kj / mol.@xcite ) errors are obtained from a block analysis,@xcite plotting calculated standard deviations of the mean as a function of the number of blocks used .",
    "the reported error is then the plateau value reached in the limit of long blocks with typically more than about 10000 monte carlo passes .",
    "the system size dependence of the virial and thermodynamic pressure is shown in fig .",
    "[ fig : p ] . from table  [",
    "tab : p ] and fig .",
    "[ fig : p ] , we find that @xmath137 and @xmath23 converge to the same value of about @xmath138 mpa ( 1 mpa = 10 bar ) for large system sizes , with a statistical error of about 2 mpa .",
    "this convergence is expected as the thermodynamic and virial pressure should be identical in the thermodynamic limit . however , the thermodynamic pressure exhibits a considerably weaker system size dependence than the virial pressure .",
    "the thermodynamic pressure for as few as 64 spc / e water molecules is in agreement with large system sizes .",
    "the virial pressure , on the other hand , scales as roughly @xmath139 for small to intermediate system sizes , with its value off by about one order of magnitude for @xmath140 .",
    "we emphasize that for typical system sizes of @xmath141 , the virial and thermodynamic pressures are identical within statistical errors for spc / e water under standard conditions .",
    "figure  [ fig : gxx ] shows the radial distribution functions of water oxygens and hydrogens , which were calculated also in the corners of the cubic simulation box with appropriate weights .",
    "we find that the the radial distribution functions for @xmath142 water molecules are practically indistinguishable , whereas the @xmath135 and @xmath143 simulations are somewhat more structured beyond the first peaks .",
    "these slight structural differences could explain the deviations of the thermodynamic pressure for those small system sizes .",
    "we caution that these are results for the specific thermodynamic state ( room temperature and standard density ) studied here , and we expect more pronounced finite - size effects , e.g. , for low densities .    in constant pressure",
    "simulations,@xcite the box volume is rescaled according to the `` instantaneous pressure '' obtained from individual configurations by omitting the canonical average @xmath144 in the pressure formulas above .",
    "it is therefore important that not only the average but also the instantaneous pressure driving the volume fluctuations be correct . as measures of discrepancy between the virial and thermodynamic pressures @xmath137 and",
    "@xmath23 , we use the correlation coefficient @xmath145 and the average absolute deviation minus the deviation of the averages , @xmath146 ,    [ eq : deviation ] @xmath147    where instantaneous pressures @xmath23 and @xmath137 are used .",
    "results for @xmath145 and @xmath146 are listed in table  [ tab : p ] .",
    "the cross - correlation coefficient @xmath145 indicates strong correlation , with @xmath145 values between 0.90 and 0.997 for @xmath135 to @xmath148 .",
    "however , the average absolute deviation @xmath146 between the two pressures is significant even for systems of 512 water molecules , scaling approximately as @xmath149 .",
    "therefore , in constant pressure simulations , the use of the thermodynamic pressure appears advantageous .    in an earlier study of pressure effects on the stability of hydrophobic aggregates in water,@xcite we determined the thermodynamic pressure of spc water@xcite as a function of density using eq .",
    "( [ eq : pmol_m ] ) .",
    "for the temperature and density studied here ( @xmath150 k , @xmath120 nm@xmath119 ) , we found a pressure of about @xmath151 mpa for spc water . from the density dependence of the pressure",
    ", we determined a compressibility factor @xmath152 for spc water , where @xmath153 is the isothermal compressibility .",
    "that compressibility factor is in excellent agreement with the experimental value of 0.062 .",
    "we have derived a simple , compact expression for the coulomb contribution to the thermodynamic pressure in a system treated with ewald lattice summation . for a system of point ions ,",
    "we recover the well - known relation between the pressure and potential energy .",
    "we then derive an expression for the pressure in a system of rigid molecules carrying point charges .",
    "the pressure in such a system can be calculated from the total energy and the forces at each site alone .",
    "this makes the implementation of that pressure formula trivial , because both energy and forces are produced routinely in molecular dynamics codes .",
    "moreover , these formulas are entirely independent of the particular method used to resum the coulomb interactions .",
    "ewald summation , particle - mesh ewald,@xcite kubic - harmonic expansions,@xcite and lekner sums@xcite can be used readily . for approximate reaction - field methods,@xcite expressions for the pressure",
    "are suggested by analogy .",
    "we have compared the thermodynamic pressure , obtained from the volume dependence of the helmholtz free energy , with the mechanistic virial pressure .",
    "we find that for rigid spc / e water at standard conditions , the two pressures are approximately equal ( within errors of about 2 mpa ) for systems larger than @xmath154 water molecules . for smaller systems ,",
    "the virial pressure exhibits a pronounced system - size dependence , whereas the thermodynamic pressure can be calculated accurately by using as few as 64 spc / e water molecules .",
    "h.  j.  c. berendsen , j.  p.  m. postma , w.  f. van gunsteren , and j. hermans , in _ intermolecular forces : proceedings of the 14th jerusalem symposium on quantum chemistry and biochemistry _ , edited by b. pullman ( reidel , dordrecht , holland , 1981 ) , pp .  331342 .",
    ".characteristics and results of the monte carlo simulations of spc / e water .",
    "statistical errors are one estimated standard deviation of the mean . also included are the cross - correlation coefficient @xmath145 and the absolute deviation @xmath146 , as defined in eq .",
    "( [ eq : deviation ] ) . [ cols=\">,>,>,>,>,<,>\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> ewald summation and physically equivalent methods such as particle - mesh ewald , kubic - harmonic expansions , or lekner sums are commonly used to calculate long - range electrostatic interactions in computer simulations of polar and charged substances . </S>",
    "<S> the calculation of pressures in such systems is investigated . </S>",
    "<S> we find that the virial and thermodynamic pressures differ because of the explicit volume dependence of the effective , resummed ewald potential . </S>",
    "<S> the thermodynamic pressure , obtained from the volume derivative of the helmholtz free energy , can be expressed easily for both ionic and rigid molecular systems . for a system of rigid molecules , the electrostatic energy and the forces at the atom positions </S>",
    "<S> are required , both of which are readily available in molecular dynamics codes . </S>",
    "<S> we then calculate the virial and thermodynamic pressures for the extended simple point charge ( spc / e ) water model at standard conditions . </S>",
    "<S> we find that the thermodynamic pressure exhibits considerably less system size dependence than the virial pressure . from an analysis of the cross correlation between the virial and thermodynamic pressure , </S>",
    "<S> we conclude that the thermodynamic pressure should be used to drive volume fluctuations in constant - pressure simulations . </S>"
  ]
}