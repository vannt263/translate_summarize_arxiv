{
  "article_text": [
    "there are lots of works searching for the explosion mechanisms of core - collapse supernovae ( ccsne ) , however we have still not obtained any conclusive results in these decades .",
    "recent works , both observational and theoretical ones , show several indications that their explosions are commonly aspherical . for instance , @xcite obtained late - time spectra for a lot of ccsne and showed that the explosion morphologies of stars without h envelope are close to bipolar configurations .",
    "furthermore , non - axisymmetric explosion is found from the observation of sn 2005bf by @xcite . in their report",
    ", they presented an optical spectropolarimetric observation of type ib supernova 2005bf and claimed that sn 2005bf can be explained as unipolar explosion and also the direction of launched unipolar blob is tilted from the symmetric axis .",
    "therefore , the asphericities might be key ingredients to understand the explosion mechanisms , especially for a subset class of ccsne such as type ib sne .",
    "these asphericities found from the observations are thought to be products of hydrodynamical instabilities occurring in the vicinity of the proto neutronstars ( pnss ) . from the previous theoretical / numerical works",
    ", it is widely known that there are many types of hydrodynamical instabilities which would occur during ccsne , such as : the ledoux convection @xcite : vortical - acoustic instability @xcite : magneto hydrodynamical instabilities , e.g. , magneto rotational instability ( mri ) @xcite or kelvin helmholtz instability : rotational instabilities , e.g. , dynamical bar - mode instability @xcite , secular instability @xcite , low-@xmath3 instability @xcite . which of these instabilities would occur depends on progenitor mass , the rotational / magnetic field velocity configuration , the interaction between matters and neutrinos , etc .",
    "among these mechanisms , rotational instabilities are common byproducts of relatively fast - spinning progenitors and their subsequent collapses .",
    "if ratio of rotational to gravitational potential energy @xmath4 , at core bounce , exceeds @xmath5 then the dynamical bar - mode instability appears @xcite .",
    "simple estimate , in which we assume the angular momentum is almost conserved during core collapse , gives us a rough lower limit of the central angular velocity @xmath6 , at pre - collapse stage which exceeds @xmath7 rad / s .",
    "such rotational speed is at least @xmath8 times faster than the results of recent stellar evolutional calculations @xcite .",
    "even if progenitor does not spin so rapidly at the beginning , the secular instability may be appeared if @xmath9 and also if some dissipative mechanisms exist such as the viscosity , the neutrino radiation or the gravitational radiation reaction @xcite . recently , another interesting rotational instability is reported to occur in ccsne which is the low-@xmath3 instability @xcite .",
    "this is the resonance instability across the corotation point inside the differentially rotating area and occurs with more reasonable value @xmath10 or with relatively slow initial spin rate @xmath11 rad / s .",
    "such a slow rotation is more realistic compared to aforementioned two mechanisms .",
    "these rotational instabilities are intrinsically three dimensional , non - axisymmetric phenomena . in the ideal mhd limit , which is a reasonable assumption in the ccsne context , the non axisymmetric motion always convert the toroidal magnetic field into the poloidal component by dragging the toroidal magnetic field .",
    "then , if the differential rotation exists , the converted poloidal magnetic field is again converted back into the toroidal ones .",
    "such a closed cycle never takes place in the axisymmetric motion and may play important roles to amplify magnetic field via , e.g. , the dynamo mechanism @xcite or the mri . strongly amplified magnetic field ( @xmath12 g ) launches high velocity outflow along the rotational axis @xcite due to the magneto - spring or the magneto - centrifugal effects @xcite and may leave highly magnetized ( @xmath13 g at surface ) neutronstar which is a so - called `` magnetar '' @xcite .",
    "another feature of the magneto - rotational explosion is , through these magneto - rotational effects , the explosion morphology becomes highly aspherical .",
    "since the explosion morphology shows stronger asphericity in case of energetic explosion such as hypernova ( hn ) or sn associated with gamma - ray burst ( grb ) @xcite , the magneto rotational effects are considered to be more important to such hyper energetic ccsne than the normal ones .",
    "as just described , the non axisymmetric effects may play important roles and should be examined by three dimensional numerical simulations .",
    "however , up to the present date , there are only a few numerical works about ccsne with three dimensional mhd ( see , e.g. , @xcite ) . in @xcite , they calculated a number of numerical models aiming for the gravitational wave signature during core collapse , including two types of realistic eoss , various magnetic - rotational configurations and a neutrino parametrization / leakage scheme . in their work , they showed the low-@xmath1 instability appears when the progenitor rotates @xmath14 rad / s or faster and alters the gravitational wave radiation .",
    "as for the explosion dynamics , they reported that bipolar outflow is driven by strong magnetic field if the initial central magnetic field strength is the order of @xmath15 g @xcite .",
    "this is because the magnetic field of the order of @xmath15 g is easily amplified , a factor of @xmath16 @xcite , simply by the compression and the rotational winding effects during core collapse .",
    "magnetic pressure with @xmath17 g is comparable to matter pressure in the vicinity of the surface of pns and thus drives bipolar outflow .",
    "the amplification factor ( @xmath16 ) hardly depends on the initial strength unless some other nonlinear amplification mechanisms work . in the 3d context",
    "however the non axisymmetric motion may trigger the previously mentioned nonlinear amplification mechanisms ( e.g. , mri ) and may alter the amplification factor or the time scale comparing to axisymmetric motion .",
    "therefore , especially when the initial magnetic field is much weaker than @xmath18 g , the axisymmetric assumption may not be suitable for the ccsne .",
    "additionally , since the strength of the order of @xmath18 g is considered to be unrealistically strong for pre - collapse stage , it should be examined how the initially weak ( or more realistic ) magnetic field , e.g. , @xmath19 g , is amplified and whether it affects the explosion dynamics or not .",
    "another challenge for numerical simulations of ccsne is the treatment of general relativistic effects .",
    "since the gravity plays intrinsic role and also some very massive progenitors ( @xmath20 , see , @xcite ) form black halls ( bhs ) , we can not say any conclusive results about the explosion mechanisms of ccsne without taking account of the general relativity ( gr ) . as same as the context of 3d mhd works of ccsne , there are not so many works done by mhd simulations including gr effects ( see , e.g. , @xcite ) and furthermore 3d grmhd works of ccsne have not been done yet .    in this paper , we describe our newly developed two 3d - mhd codes for ccsne simulation .",
    "their features are as follows .",
    "both codes employ adaptive mesh refinement ( amr ) technique and can cover wide dynamical ranges from the central compact object ( @xmath8 km ) to beyond the several times of iron core radius ( @xmath21 km ) or more .",
    "self gravity is included in the newtonian approximated mhd code and the dynamical metric is included in grmhd code .",
    "high resolution shock capturing scheme is adopted in both codes and can handle the shock discontinuity without numerical viscosity .",
    "we use the staggered mesh algorithm and adopt the constrained - transport method to evolve the magnetic field .",
    "we have done many test problems and confirmed their abilities .",
    "this paper is organized as follows . from sec .",
    "[ sec : nmhdcode ] to [ sec : amr ] , we describe our numerical codes , their detailed properties and adopted techniques . in sec.[sec : nmhdtest ] and [ sec : grmhdtest ] , we report several numerical tests of newtonian approximated and general relativistic codes , respectively .",
    "section [ sec : collapse ] shows our first core - collapse supernovae calculations and their initial setups .",
    "we summarize in section [ sec : summary and discussions ] .",
    "we adopt cgs units for nmhd code and geometrical units for grmhd code in which @xmath22 . in our practical calculations of a collapse of @xmath0 star , in sec . [",
    "sec : collapse ] , physical quantities are notated in cgs units .",
    "greek / latin indices run through 0 - 3/1 - 3 .",
    "our nmhd code solves ideal nmhd equations written in conservative forms together with source terms of self gravity , which are written in the following form : @xmath23 and poisson s equation for gravitational potential @xmath24 where , in eq .",
    "( [ eq : nmhdeqs ] ) @xmath25 \\\\ \\label{eq : nmhdflux } { \\bf f}&= & \\left [ \\begin{array}{c } \\rho { \\bf u } \\\\ \\rho { \\bf uu}+\\left(p_{\\rm tot}+\\frac{\\bf b\\cdot b}{8\\pi}\\right){\\bf i}-\\frac{\\bf bb}{4\\pi }",
    "\\\\ \\left(e+p_{\\rm tot}+\\frac{\\bf b\\cdot b}{8\\pi}\\right){\\bf u}-\\frac{\\bf ( u\\cdot b)b}{4\\pi } \\\\ { \\bf ub - bu } \\\\",
    "\\end{array } \\right]\\\\ \\label{eq : nmhdsrc } { \\bf s}&= & \\left [ \\begin{array}{c } 0 \\\\ -\\rho\\nabla\\phi\\\\ -\\rho{\\bf u}\\cdot \\nabla \\phi\\\\ 0 \\\\ \\end{array } \\right]\\end{aligned}\\ ] ] eq .",
    "( [ eq : nmhdeqs ] ) represents the conservation of mass , momentum , energy and the faraday s law . @xmath26 , @xmath27 , @xmath28 , @xmath29 , @xmath30 , @xmath31 and @xmath32 are rest - mass density , fluid velocity , magnetic field , energy density , total pressure , gravitational potential and @xmath33 unit matrix , respectively . the energy density and the total pressure",
    "are expressed as + @xmath34 @xmath35 here , @xmath36 and @xmath37 are gas pressure and internal energy density , respectively , and are related via the equation of state , @xmath38 .",
    "we also define primitive variables @xmath39 which is uniquely obtained from conservative variables * q * via eos .",
    "we employ staggered mesh and all variables except magnetic field are defined at cell center while , for instance , @xmath40(i , j , k ) is defined in cell surface ( i+1/2 , j , k ) .",
    "hereafter we use @xmath41 and do not express `` @xmath42 '' , unless otherwise stated .    to solve time dependent equation ( [ eq : nmhdeqs ] ) , in our cartesian eulerian grid ,",
    "we adopt roe - type upwind solver in which numerical flux @xmath43 is defined in cell surface ( see fig.[pic : f1 ] ) .",
    "following @xcite , @xmath43 is constructed from the spectral decomposition of the system and expressed as @xmath44/2\\ ] ] here the index @xmath45 represents position immediate left / right of the cell boundary , i.e. , when we evaluate the numerical flux at ( i+1/2 , j , k ) , the position @xmath46 and @xmath47 stand for ( i+1/2 - 0 , j , k ) and ( i+1/2 + 0 , j , k ) , respectively . @xmath48/@xmath49 and @xmath50",
    "correspond to left / right eigenvectors and eigenvalues of the system , respectively , and defined in cell surface .",
    "originally , in @xcite , they decompose the system into eight spectral modes in which one mode carries the monopole moment of magnetic field .",
    "meanwhile , we adopt the constrained transport method for time evolution of magnetic field and we thus consider only seven modes in our nmhd code ( for explicit expressions of seven eigenvectors , see @xcite ) .",
    "eigenvalues @xmath50 are defined as @xmath51 here @xmath52 is the fluid velocity normal to cell boundary ; @xmath53 the fast magnetosonic speed ; @xmath54 the slow magnetosonic speed ; @xmath55 the @xmath56 speed .",
    "@xmath57 are expressed by @xmath58 where , @xmath59 takes @xmath60 in eq .",
    "( [ eq : fastslow ] ) , @xmath61 represents magnetic field component normal to cell boundary and @xmath62 is the speed of sound .",
    "the speed of sound @xmath62 in a general form of eos can be defined by @xmath63 since we define the conservative variables other than magnetic field at cell center , we have to interpolate to obtain those values at immediate left / right of cell boundary . as for the interpolation ,",
    "we adopt the monotonized central ( mc ) method @xcite as @xmath64 additionally , we employ total variational diminishing ( tvd ) scheme which has second order convergence in space ( see @xcite ) and we briefly summarize how we implement it into our nmhd code below . in tvd scheme ,",
    "summation respect to the spectral modes in eq .",
    "( [ eq : froe ] ) is modified as @xmath65 in eq .",
    "( [ eq : tvdsum ] ) we consider @xmath66 directional numerical flux @xmath67 defined at ( i+1/2 , j , k ) and @xmath68\\\\ g_l&=&{\\rm sign}(g_{\\rm i})\\ { \\rm max}\\left[0,\\ { \\rm min}(|g_{\\rm i}|,\\ g_{\\rm i-1}{\\rm sign}(g_{\\rm i } ) ) \\right]\\\\ \\gamma_{\\rm m}&= & \\left ( \\begin{array}{ccc } ( g_r - g_l)/ldq_{\\rm m , i } & { \\rm for } & ldq_{\\rm m , i}\\ne0 \\\\ 0 & { \\rm otherwise } &   \\end{array } \\right.\\\\ q_l\\left(x\\right)&= & \\left ( \\begin{array}{ccc } \\frac{x^2}{4\\varepsilon}+\\varepsilon & { \\rm for } & |x|<2\\varepsilon\\\\    \\end{array } \\right.\\\\ \\varepsilon&= & \\left ( \\begin{array}{ccc } 0.01 & { \\rm for } & m=1,7\\\\ 0.1 & { \\rm for } & m=2,6\\\\ 0.1 & { \\rm for } & m=3,5\\\\ 0 & { \\rm for } & m=4 \\end{array } \\right.\\end{aligned}\\ ] ] after we obtain the numerical fluxes in all sides of cell , the conservative variables other than magnetic field are updated through predictor and corrector steps @xcite . in predictor step , @xmath69 is updated from time level @xmath70 to @xmath71 by @xmath72 , i.e. , @xmath73 and in corrector step from time level @xmath70 to @xmath74 by @xmath75 with using predicted values , i.e. , @xmath76 this method is second order convergence with respect to time .    on the other hand , as for the time evolution of magnetic field @xmath77 , we adopt the constrained transport ( ct ) scheme @xcite in which @xmath77 is evolved as @xmath78 electric field @xmath79 for ct scheme is defined at the cell edge ( see fig.[pic : f1 ] ) and is evaluated from roe - type numerical flux , eq .",
    "( [ eq : froe ] ) , with appropriate interpolation .",
    "we simply express the electric field as @xmath80 here the upper suffixes in the right hand side denote components of the numerical flux .",
    "@xmath81 and @xmath82 components of the electric field are obtained straightforwardly by permutation as @xmath83 and @xmath84 , respectively .    in self gravitating system , the source term contains gravitational potential which is obtained by solving poisson equation ( our method to solve poisson equation with amr framework is described in sec .",
    "[ sec : poisson solver under the amr framework ] ) . since solving poisson equation is very time consuming task , we solve it only once in one hydrodynamical time step @xcite after predictor step is completed . practically , in predictor step , we extrapolate gravitational potential @xmath85 at @xmath70th time level via @xmath86 and then predict variables at @xmath87th time level through eq .",
    "( [ eq : predictor ] ) .",
    "after the predictor step is completed , we solve poisson equation by using @xmath88 . in corrector step ,",
    "we fully evolve the @xmath70th time level to @xmath89th variables by using @xmath90 and @xmath91 .",
    "even though we extrapolate gravitational potential at @xmath70th time level , our numerical results do not show any large error in conservation of energy and numerical convergence is also achieved ( described later in sec .",
    "[ sec : energy and angular momentum conservations ] ) .    on a final note ,",
    "we mention about a numerical instability which is characteristic to roe - type scheme .",
    "even though roe - type numerical flux is less numerically dissipative and has good shock capturing ability , one problem arises which is a so - called `` odd - even decoupling '' .",
    "this instability appears when the shock normal is directed parallel to the grid alignment . to avoid this instability ,",
    "we adopt `` carbuncle cure '' in our nmhd code by following @xcite .",
    "formalism of our grmhd code is based mainly on @xcite .",
    "it can be divided into two parts , one is mhd part and the other is einstein s equation part .",
    "mhd part describes time evolution of matter on the background of spacetime metric and the metric is evolved according to einstein s equation through the so - called `` baumgarte - shapiro - shibata - nakamura ( bssn ) '' formalism ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    before going to brief summary of our method",
    ", we describe our fundamental variables of mhd and metric parts .",
    "we set fundamental variables of mhd part as rest - mass density @xmath26 , specific internal energy @xmath37 , 4-velocity @xmath92 and magnetic field @xmath93 measured by a comoving observer . for metric part , the 3-metric @xmath94 and the extrinsic curvature @xmath95 are the fundamental ones adopting the 3 + 1 formulation of `` arnowitt - deser - misner ( adm ) '' formalism @xcite",
    ". then the line element of the spacetime can be expressed as @xmath96 here @xmath97 are the lapse function and the shift vector , respectively , and determined by arbitrary chosen gauge condition ( sec .",
    "[ sec : gauge ] ) .",
    "hypersurface of constant @xmath98 is foliated in the spacetime so that a unit normal vector @xmath99 to this hypersurface becomes @xmath100    fundamental metrics @xmath94 , @xmath95 are converted to 5 variables in bssn formalism which are ; the conformal exponent @xmath101 , here @xmath102 is the determinant of 3-metric @xmath94 ; the conformal 3-metric @xmath103 ; the trace of the extrinsic curvature @xmath104 ; the tracefree extrinsic curvature @xmath105 ; and three auxiliary variables @xmath106 , here \" @xmath107  represents partial derivative with respect to @xmath108 direction .",
    "hereafter , @xmath109 and @xmath110 denote the covariant derivatives with respect to @xmath111 and @xmath94 , respectively .",
    "stress energy tensor for ideal magneto - hydrodynamical fluid is expressed as @xmath112 here @xmath113 is enthalpy and we define magnetic pressure as @xmath114 . with these settings ,",
    "we define other useful quantities which are ; 3-velocity @xmath115 observed by eulerian observer at rest ; and magnetic field @xmath116 observed in the fluid flame , i.e. , @xmath117 .",
    "@xmath118 @xmath119 here @xmath120 is the lorentz factor .",
    "we also define primitive / conservative variables @xmath121 as @xmath122= \\left [ \\begin{array}{cc } \\rho e^{6\\phi } w \\\\ e^{6\\phi}((\\rho",
    "h+b^2)w u_i-\\alpha b^tb_i ) \\\\",
    "e^{6\\phi}((\\rho h+b^2)w^2-(p+b^2/2)-(\\alpha b^t)^2)-\\rho_{\\ast } \\\\",
    "b^i   \\\\ \\end{array } \\right]\\end{aligned}\\ ] ]      basic equations of magneto - hydrodynamical part in general relativistic form are written as the following conservative - like equations .",
    "@xmath123 @xmath124 @xmath125 @xmath126 where @xmath127 and these equations can be expressed in the form of @xmath128 .    our procedure to evolve the mhd conservative variables @xmath129 is similar to our nmhd code except we use the hll ( harten - lax - van leer ) flux @xcite and not roe - type one .",
    "hll - flux is less numerically expensive compared to roe - flux , since we only have to consider the two fastest left and right going wave speed without considering eigenvectors like expressed in eq .",
    "( [ eq : froe ] ) , however hll - flux has sufficient capability to follow shocks and is suitable for our aims . the fastest left / right going wave speed",
    "are evaluated from 4th order eigenvalue problem ( see , eqs . ( 58 ) , and ( 63 - 65 ) , in * ? ? ?",
    "we solve this problem by iterative newton method with given sound speed .",
    "following @xcite , the sound speed @xmath62 is defined as @xmath130}\\ ] ] by solving 4th order eigenvalue problem the fastest left / right going wave speed @xmath131 ( correspond to @xmath131 in eq .",
    "( [ eq : eigenroe ] ) ) can be obtained .",
    "we evaluate @xmath132 and @xmath133 at immediate left and right of the cell boundary by adopting several types of reconstruction schemes such as monotonized central ( mc ) or piecewise linear method ( plm ) . in this paper",
    ", we adopt only mc method which has second order convergence with respect to space .",
    "then the fastest left / right going wave speed @xmath134 at cell boundary are defined as @xmath135 with these wave speed , we define hll flux , by following @xcite , as @xmath136 here @xmath137 and @xmath138 is an appropriate flux vector in eqs .",
    "( [ eq : grmass]-[eq : grfaraday ] ) .",
    "solenoidal constraint of magnetic field is satisfied by ct scheme as the same procedure as nmhd .",
    "once we update conservative variables @xmath129 , we have to obtain primitive variables @xmath139 by solving following three coupled equations with iterative newton method .",
    "@xmath140 we employ the same recovering procedure as proposed in @xcite with adopting `` safe - guess values '' when the iteration does not converge .",
    "next we describe our method to evolve metric part . as",
    "previously mentioned we evolve bssn variables ( @xmath141 ) according to following equations ( see , e.g. , @xcite ) , .",
    "@xmath142^{\\rm trf}+\\alpha(k\\tilde a_{ij}-2\\tilde a_{ik } \\tilde \\gamma ^{kl}\\tilde a_{jl } ) \\\\ \\label{eq : bssn4 } ( \\partial_t-\\mathcal{l}_\\beta)k&=&-\\delta \\alpha + \\alpha ( \\tilde a_{ij}\\tilde a^{ij}+k^2/3)+4\\pi \\alpha ( s_0 e^{-6\\phi}+\\gamma^{ij}s_{ij } ) \\\\ \\label{eq : bssn5 } ( \\partial_t-\\beta^k\\partial_k)f_i&=&-16\\pi\\alpha e^{-6\\phi}s_i   \\nonumber \\\\ & + & 2\\alpha\\left[f^{jk}\\tilde a_{ij , k}+{f^{jk}}_{,k}\\tilde a_{ij}-\\tilde a^{jk}h_{jk , i}/2 + 6\\phi_{,j}\\tilde a^j_i-2k_{,i}/3\\right ] \\nonumber \\\\ & + & \\delta^{jk}\\left[-2\\alpha_{,k}\\tilde a_{ij}+{\\beta^l}_{,k}h_{ij , l}+(\\tilde\\gamma_{il}{\\beta^l}_{,j}+\\tilde\\gamma_{jl}{\\beta^l}_{,i}-2\\tilde\\gamma_{ij}{\\beta^l}_{,l}/3)_{,k}\\right]\\end{aligned}\\ ] ] in these eqs . ( [ eq : bssn1]-[eq : bssn5 ] ) , @xmath143 is @xmath144 derivative with respect to @xmath145 ; \" trf  denotes trace - free operator ; @xmath146 ; @xmath147 and @xmath148 .",
    "@xmath149 is the ricci tensor and consisted of two parts in the form of @xmath150 for explicit forms of the ricci tensor and several notes when calculating the ricci scalar , see @xcite .",
    "we evolve these bssn variables by the second order scheme in space ( e.g. , appendix of * ? ? ?",
    "* ) and by the iterative crank - nicholson scheme with three steps in time .",
    "many recent numerical simulations in full general relativity adopt fourth order scheme in space such as @xcite or @xcite .",
    "however , such higher order scheme is necessary especially when the metric is highly distorted such as around the bh .",
    "our numerical simulations with a relatively low mass star ( @xmath0 ) do not show any bh formation and we thus consider second order scheme is acceptable at this time .",
    "for the metric , there are several mathematical and physical constraints . as for",
    "the mathematical constraints , @xmath151 and @xmath152 should be satisfied .",
    "we enforce following two artificial procedures @xmath153 after each update to maintain numerical stability .",
    "physical constraints are the hamiltonian and momentum constraints .",
    "@xmath154 we do not enforce any artificial modifications to satisfy these constraints , though monitor these values just as our code check . however , we enforce hamiltonian constraint every time we refine / coarsen the amr blocks by solving above poisson like non - linear equation([eq : hamiltoniancon ] ) .",
    "we monitor @xmath155 defined by @xmath156}dx^3}\\end{aligned}\\ ] ] to check the hamiltonian constraint and accuracy of our code . here , @xmath157 is proper rest mass and defined by eq .",
    "( [ eq : mbar ] ) .",
    "hyper - surface at constant time @xmath98 can be foliated in spacetime arbitrary , but is usually chosen so as to keep time evolution numerically most stable .",
    "as for the time slicing condition which determines lapse ( @xmath158 ) , we adopt several choices in our grmhd code such as `` the approximate maximal slicing '' or `` harmonic slicing '' or `` 1+log '' slicing conditions . since the approximate maximal slicing condition requires to solve poisson like non - linear equation every time step and very time consuming method , we usually adopt 1+log gauge condition given by @xmath159 we have implemented `` dynamical gauge condition '' for shift ( @xmath145 ) , following @xcite , which is given by solving @xmath160 where , @xmath75 is the numerical time step . by imposing these gauge conditions ,",
    "we do not suffer from time consuming poisson like equations at every time step , while we do not encounter any numerical instabilities throughout our calculations of core collapse of massive star .      in grmhd code , global quantities such as total baryon rest mass @xmath157",
    "; adm mass @xmath161 ; total angular momentum along the rotational ( z ) axis @xmath162 ; internal energy @xmath163 ; magnetic energy @xmath164 ; kinetic energy @xmath165 ; rotational kinetic energy @xmath166 are defined as expressed below ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "@xmath167dx^3\\\\ \\label{eq : jtot } j_z&=&\\int { \\left[\\frac{\\tilde a^x_y-\\tilde a^y_x}{8\\pi}+xs_y - ys_x+\\frac{xk_{,y}-yk_{,x}}{12\\pi}-\\frac{x\\tilde \\gamma^{ij}_{,y}\\tilde a_{ij}- y\\tilde \\gamma^{ij}_{,x}\\tilde a_{ij}}{16\\pi}\\right]e^{6\\phi}dx^3}\\\\ \\label{eq : eint } e_{\\rm int}&=&\\int \\rho_\\ast \\varepsilon dx^3\\\\ \\label{eq : tkin }",
    "t_{\\rm kin}&=&\\int \\rho_\\ast hu_i v^i dx^3\\\\ \\label{eq : trot } t_{\\rm rot}&=&\\int \\rho_\\ast hu_\\phi v^\\phi dx^3\\\\ \\label{eq : emag } e_{\\rm mag}&=&\\int \\frac{b^2}{2 } w e^{6\\phi } dx^3\\end{aligned}\\ ] ] then the gravitational potential energy @xmath168 is defined by @xmath169 . because of our formulae for mhd part and because of our amr scheme ( see , sec .",
    "[ sec : boundary of amr blocks ] ) , @xmath157 is conserved with high accuracy . on the other hand , conservation of @xmath161 which is guaranteed from the einstein s equation in the absence of gravitational radiation",
    "is violated due to the accumulation of numerical errors in our ccsne simulations .",
    "then , several % fluctuation appears ( see , fig.[pic : f40 ] in sec .",
    "[ sec : grmhdtest ] ) which is approximately 2 - 3 orders larger compared to that of @xmath157 in our ccsne simulations .",
    "consequently even though our initial condition satisfies @xmath170 ( i.e. , gravitationally trapped system ) , there sometimes appear that @xmath171 during calculation .",
    "therefore we estimate the gravitational potential energy as @xmath172 and apply it to such as the rotational to gravitational energy @xmath173 .",
    "one of difficulties in computational astrophysics is that we have to handle wide dynamical range in a limited computational resource .",
    "for instance , in the context of ccsn simulation , the pns is a size of @xmath17410 km and on the other hand radius of the iron core is the order of @xmath175 km .",
    "if we cover such a vast range ( several times of the iron core ) with a uniform resolution , e.g. , @xmath176 m to resolve interior of the pns , it becomes impossible to calculate with our limited computational resource .",
    "we thus raise resolution in the vicinity of proto - neutronstar and , at the same time , lower resolution far from the centre .",
    "to realize such situation , we incorporate the amr technique ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) into our codes .      in our codes ,",
    "computational domain is divided into `` @xmath177 '' ( hereafter , amr block ) and every amr block consists of @xmath178 cubic cells and of 2 additional cells as ghost zones in every side of block .",
    "every amr block belongs to a refinement level `` @xmath179 '' and if the refinement level @xmath179 is raised by one , the amr block is divided into 8 blocks with halved cell width . on the other hand , if all @xmath180 neighboring amr blocks are assigned to lower their refinement level by one , 8 blocks merge into one block with twice cell width .",
    "our codes are fully parallelized and adopt message passing interface ( mpi ) for communication between different nodes .",
    "then it requires load balancing in amr frame work .",
    "our method for this purpose is like this .",
    "three dimensional structure of amr blocks are projected on one dimensional structure connected by _",
    "\" hilbert _ `` space filling curve @xcite . along the @xmath181 curve",
    ", amr blocks are numbered sequentially .",
    "then amr blocks projected on one dimension are allocated to all computational nodes in a straight forward manner .",
    "using such a projection scheme , e.g. , connecting by @xmath181 curve , enables us to minimize the data transfer between different computational nodes .",
    "this is because surface area of a ' ' chunk \" of amr blocks allocated in one node by above method is minimized as much as possible and , thus , we can minimize time to spare for the data communication .",
    "cc    -@xmath182 : @xmath181 curves filling two dimensional area covered by uniform amr blocks with three different levels .",
    "@xmath183-@xmath184 : @xmath181 curves filling two dimensional area covered by nonuniform amr blocks with four different amr levels . in this panel ,",
    "amr blocks are allocated to 8 nodes and blocks allocated to one node are connected through one sequential line .",
    "@xmath185 : three dimensional extension of @xmath186-@xmath182 panel with two different levels .",
    ", width=188 ]    in @xmath186-@xmath182 panel of fig.[pic : filling_curve.epsamr_conf.eps ] , we display an example of @xmath181 curve in two dimension . in this figure , asterisks(circles , crosses ) denote centers of cells with width 0.5(0.25 , 0.125 ) and lines are @xmath181 curves . as seen in this panel , two dimensional structure of amr blocks is projected on one dimension . in @xmath184-@xmath186 panel",
    ", we again display @xmath181 curve which fills two dimensional computational domain covered by blocks of four different amr levels .",
    "background colors represent amr levels and blocks connected one curve are allocated to one computational node .",
    "therefore , in this panel , all amr blocks are allocated to 8 nodes with maintaining load balancing . in @xmath187 panel",
    ", we also display three dimensional extension of @xmath181 curves with two different amr levels for reference .    by adopting such method",
    ", our amr structure has flexibility to refine or coarsen amr blocks locally .      in nmhd code",
    ", we have to solve poisson equation in the form of @xmath188 for the self gravity and ; in grmhd code , poisson like non linear equation in the form of @xmath189 for the initial hamiltonian and momentum constraints . here @xmath190 is a given @xmath191 matrix , @xmath192 is a given @xmath193 vector and @xmath66 is a solution we seek which is @xmath193 vector .",
    "@xmath194 is a total number of amr blocks . in grmhd",
    ", @xmath195 is a vector containing non - linear term of @xmath66 .",
    "we adopt iterating method , the so called `` biconjugate gradient stabilized ( bicgstab ) '' @xcite method to solve such huge simultaneous equations .",
    "our strategy for solving this equation under our amr structure is ; ( 1 ) we set an amr level @xmath179 which is 0 at initial ; ( 2 ) for all amr boxes whose amr levels are larger or equal to @xmath179 , we project their physical quantities , such as the density , to boxes of amr level @xmath179 by the coarsening procedure and construct @xmath196 ; ( 3 ) we then solve equation by bicgstab on the uniform mesh with appropriate boundary conditions at the interface of amr level @xmath179 and @xmath197 and also at the outer boundary ; ( 4 ) increment @xmath179 by one and repeat these procedures from ( 1 ) again .",
    "note that , we have to pay special attention at the interface of different amr level , i.e. , @xmath179 and @xmath197 . at here",
    ", we have to connect both the solutions and their first derivation smoothly , otherwise there appear some non - physical divergence . to avoid this",
    ", we adopt quadratic and bilinear interpolation methods following @xcite to evaluate ghost zone values of amr level @xmath179 , e.g. , @xmath198 and @xmath199 in fig.[pic : buffer.eps ] . here , we summarize our interpolation method in two dimension .",
    "three dimensional extension can be done in a straightforward manner .",
    "if we seek gravitational potential @xmath198 , we first have to obtain @xmath200 at @xmath201 which is derived via @xmath202 here , mc@xmath203 is the monotonized central method .     and",
    "@xmath197 , respectively.,width=245 ]    then @xmath198 is derived via quadratic interpolation @xmath204 @xmath205 which is required to evaluate @xmath206 is obtained by following equation @xmath207 three dimensional extension of this smoothening method is done by replacing , e.g , eq.([eq : phia ] ) , with bilinear interpolation @xmath208 on the other hand , lower level ghost zone value @xmath209 is derived by @xmath210 procedure and this is simply averaging @xmath31 over the @xmath211 ( or @xmath180 in 3d ) adjacent cells via @xmath212      to guarantee the conservation law and the solenoidal constraint of magnetic field , we have to reflux the numerical flux , eqs .",
    "( [ eq : froe ] ) and ( [ eq : fhll ] ) , and the electric field , eq.([eq : electricfield ] ) , at where amr boxes of different levels are contacting . in fig.[pic : refluxing.eps ] , we display schematic picture of refluxing procedures .",
    "for instance , the numerical flux @xmath213 belonging to amr level @xmath197 and defined at cell boundary is replaced by summation of @xmath214 which belong to amr level @xmath179 .",
    "similarly , as for the electric filed , the electric field @xmath215 defined at cell edge is replaced by summation of @xmath216 .",
    "these procedures ensure the conservation and the solenoidal constraint below the round off error .     and the electric field @xmath217 .",
    "left two and right boxes belong to amr level @xmath197 and @xmath179 , respectively .",
    ", width=226 ]    additionally , as for the ghost zones , we have to obtain physical variables every after the time updating and this procedure is sorted into three cases .",
    "( 1)for amr box whose neighbor has the same amr level , we simply copy all physical variables .",
    "( 2)for amr box whose neighbor has lower level , ghost zone variables are interpolated and are sent from lower to higher level box . for this interpolation , we use the same method as used in our poisson solver ( described in sec .",
    "[ sec : poisson solver under the amr framework ] ) other than the magnetic field @xmath77 . as for the magnetic field",
    ", we have to interpolate while maintaining the solenoidal constraint and this is done by adopting the same method proposed by @xcite .",
    "( 3)if amr level of the neighbor is higher , physical variables are evaluated by `` @xmath218 '' procedure . in our codes , this restriction procedure is simply averaging the variables of @xmath180 adjacent cells which is the same method as used in our poisson solver ( sec .",
    "[ sec : poisson solver under the amr framework ] ) .      during time evolution of the bssn variables",
    ", we have to derive the spatial derivatives of metrics not only along one direction , e.g. , @xmath219 , but also the cross derivatives , e.g. , @xmath220 to obtain such as the ricci tensor . therefore ,",
    "if there exist some discontinuity in the spatial derivatives across the amr refinement boundary , spurious oscillations of the bssn variables appear near the refinement boundary . since the time marching is simultaneous across all the amr boxes in our codes",
    ", there is no time lag between different amr levels .",
    "however , we should carefully interpolate the buffer zone s metrics especially for amr boxes whose neighbors have lower amr levels than theirs .",
    "this situation is the same as that appeared in our poisson solver ( sec .",
    "[ sec : poisson solver under the amr framework ] ) and we adopt the same strategy to obtain the buffer zone s variables . in addition",
    "we have to evaluate the metrics along the edge of amr block ( e.g. , @xmath221 ) for the cross derivatives and this evaluation can be done in a similar manner as that in the normal buffer zone s case .",
    "for instance , if we seek a metric @xmath222 at @xmath223 , @xmath224 which corresponds to @xmath200 in eq .",
    "( [ eq : phia ] ) is replaced by @xmath225 then , in a straight forward manner of eq .",
    "( [ eq : quadratic ] ) , @xmath226 can be derived by @xmath227    however , we can not completely suppress the spurious oscillations in the refinement boundary and , in such case , adding numerical dissipation is sometimes useful @xcite .",
    "even though we do not add the dissipation at present codes , we do not suffer from growth of the noises and the code crash .",
    "several tests of the bssn evolution with amr structure are summarized in sec.[sec : testdynamical ] .",
    "in this section , we introduce several test problems done by our newly developed 3dmhd code in the newtonian approximation .",
    "we verified the accuracies of our new amr - nmhd code through several test suites .",
    "we calculated several 1-d hydrodynamical shock tube tests and compared to the exact solutions obtained from the code he - e1rpexact of the library @xmath228@xcite .",
    "we show one test in fig.[pic : f30 ] in which we assumed ideal gas with adiabatic index @xmath229 .",
    "the mesh width of exact solution is 1/1000 , meanwhile , the `` effective '' mesh width of our numerical run s are 1/2048 , 1/512 , 1/128 for @xmath230 , @xmath231 and @xmath232 dots , respectively .",
    "+ test 1 ) @xmath233    for mhd shock tube test , we show the same test described in @xcite with three different types of the eoss in fig.[pic : f31 ] .",
    "+ test 2 ) @xmath234 initial total pressure @xmath30 , which excludes the magnetic pressure , is divided into three parts such as the gas @xmath235 , the degenerate @xmath236 and the radiation @xmath237 pressure term .",
    "+ @xmath238 internal energy has also three parts corresponding to the gas @xmath239 , the fermi @xmath240 and the radiation @xmath241 energy as defined by the following .",
    "@xmath242 here @xmath243 and eos a ) corresponds to the original model reported in @xcite .    .",
    "each line corresponds to different eos shown at the top . ]    from fig.[pic : f30]-[pic : f31 ] , we see that our code captures the discontinuities accurately and also no numerical instabilities are seen .      as for the tests of our poisson solver , we set two types of spherically symmetric density distribution like below which have analytical solutions and compare our results with analytical ones .",
    "+ test 3 ) homogeneous sphere of radius r and density @xmath244 + test 4 ) centrally condensed sphere with density distribution @xmath245 @xmath246 these tests are the same tests done in @xcite and have analytical solutions , thus we can easily check the accuracy of our poisson solver(for analytical formulae , see * ? ? ?",
    "we set @xmath247 cm , @xmath248 g @xmath249 and @xmath250 cm for both tests 3 ) & 4 ) .",
    "fig.[pic : f32 ] shows our numerical results with comparing analytical ones .",
    "@xmath251 and @xmath252 two panels show @xmath253 and @xmath254 , respectively . here , @xmath255 is the numerical result of the poisson equation and @xmath256 is the analytical one",
    ". deviations of our numerical results from the analytical ones are @xmath257% and we also find neither kink nor jump of both @xmath255 and @xmath258 at the interface of different amr level boxes .",
    "therefore , we consider our poisson solver under amr structure works with sufficient accuracy .      in this subsection , we check our nmhd code s accuracy against the energy and the angular momentum conservations .",
    "since we consider one of energy source of the formation of bipolar outflow is the extracted angular momentum , we have to carefully trace the time evolution of angular momentum . as for the test of angular momentum transfer ,",
    "we follow the collapse of a non - magnetized and rotating 25m@xmath259 star with the adiabatic gas with index @xmath229 . if no magnetic field exists and the fluid is adiabatic gas , the angular momentum is not transported .",
    "result is shown in fig.[pic : f33 ] .",
    "abscissa and vertical axes represent the specific angular momentum and the total mass in solar mass unit which is the summation of fluid elements having less or equal to the corresponding specific angular momentum on the abscissa axis , respectively .",
    "if the angular momentum conservation is maintained , the curves do not change its form in time and we thus see the angular momentum conservation is well maintained from this figure .        as for the energy conservation test , we calculate collapse of a rotating and magnetized 15m@xmath259 star ( corresponds to model `` nb12r020sf '' described later in sec.[sec : collapse ] ) . in fig.[pic : f34 ] , we display time evolutions of various energy components and the error in energy conservation in @xmath182 panel and the magnified view around the time of core bounce with different numerical resolutions to see the numerical convergence in @xmath184 panel . as for the numerical convergence test",
    ", the computational domain is chosen as @xmath260$]km for @xmath261 curves and @xmath262$]km for @xmath263 ones .",
    "then the minimum grid widths become @xmath264 and @xmath265 m. from fig.[pic : f34 ] , we see the energy conservation is well maintained and also see the numerical convergence is achieved within the range of our adopted numerical resolutions .",
    "in this section , we introduce several test problems done by our newly developed 3dgrmhd code .      as for the basic test",
    ", we calculated the relativistic brio & wu mhd shock tube test ( see , * ? ? ?",
    "* ; * ? ? ?",
    "* ) with fixed flat metric and the results are shown in fig.[pic : f35 ] .    in this figure",
    ", we show two models with different gauge conditions and compare with the exact solutions obtained from @xcite .",
    "one is @xmath266 and represented by @xmath232 lines and the other is @xmath267 and plotted by crosses .",
    "time slice is taken at @xmath268 and @xmath269 for @xmath270 and 2 , respectively .",
    "in addition , for non - zero shift gauge ( @xmath271 ) model , results are shifted to @xmath272 to let it coincides with other results .",
    "we can see our grmhd code can handle the non - zero gauge conditions and shocks .      in this subsection , we test our grmhd code in a strongly curved and fixed spacetime . as for the test ,",
    "we evolve the bondi accretion flow with / without magnetic field and compare our results to analytical solution which are obtained according to @xcite .",
    "it is known that the radial magnetic field does not influence the bondi accretion @xcite and , thus , we add the initial magnetic field via @xmath273\\ ] ] in this test , we adopt kerr - schild coordinate @xmath274 here , the metric @xmath275 is written in spherical polar coordinate .",
    "event horizon locates @xmath276 and outer boundary is set at @xmath277 .",
    "we excise the computational domain @xmath278 and simply connect the non- and excised region with first order extrapolation .",
    "we run four models with two different resolutions ( @xmath279 ) and @xmath280 ( or @xmath281 ) and @xmath282 . in fig.[pic : bondi ] , we show the rest density profiles of magnetized models at @xmath283 in @xmath182 panel and l2 norm of the errors in density in @xmath184 panel .",
    "the errors in @xmath284 models are multiplied by @xmath285 to show the second order convergence . from this test",
    ", we see that our grmhd code which employs hll flux with mc limiter actually reproduces the second order convergence and also that our code can treat the strongly curved spacetime .",
    "cc      to check whether our two codes satisfy the solenoidal constraint for the magnetic field , we have checked the value @xmath287 .",
    "fig.[pic : f36 ] display @xmath287 in the central @xmath288\\times[0,100]\\times[0,100]$]km@xmath289 region from one representative model of grmhd models . in this region ,",
    "three different amr level boxes exist . at this moment",
    ", it almost reaches core bounce time and three times refinement procedures have been done since the initiation of calculation . from this figure",
    ", we see that solenoidal constraint is well maintained below the round - off error which tells us that both the refinement procedures and the electric field refluxing work well .      in this subsection",
    ", we test our dynamical metric solver written by the bssn formalism with and without matters .",
    "first test is to follow the linearized gravitational waves , the so called `` teukolsky wave '' @xcite , in a vacuum space .",
    "following @xcite , we adopt the same mode @xmath290 and the initial wave amplitude is set to @xmath291 . for time slicing gauge condition , we adopt `` 1 + log '' condition ( see , sec . [",
    "sec : gauge ] ) . in this test",
    ", we also check the influence of the boundary where different amr level boxes are contacting . in fig.[pic : f37 ] , the initial condition ( a component of the extrinsic curvature , @xmath292 ) and amr structure are displayed .    as seen in this figure , the inner region of @xmath293",
    "is covered by maximum amr level meshes which we vary as @xmath294 , 2 and 3 to see convergence of the error .",
    "we extract the metric variables @xmath295 and @xmath296 at ( x , y , z)=(4.2 , 0 , 0 ) and compared them with analytical ones in fig.[pic : f38 ] .",
    "@xmath297 curves are analytical solutions ( see , e.g. , @xcite ) and @xmath298 curves are numerical results .",
    "numerical resolutions are @xmath299 , 0.156(@xmath300-@xmath301 ) and 0.312(@xmath263 ) . from @xmath186 panel of fig.[pic : f38 ] , we see that the errors decrease with increasing numerical resolution .",
    "next test is an evolution of rigidly rotating neutronstar in equilibrium state .",
    "initial parameters are the central rest density @xmath302 and the central angular velocity @xmath303 .",
    "we use the polytropic eos @xmath304 where @xmath305 and @xmath306 and assume rigid rotation . with these parameters ,",
    "the central lapse is @xmath307 and the adm / baryon masses are @xmath308/@xmath309 .",
    "outer boundary is taken at @xmath310 and the equatorial radius of the ns is @xmath311 . in fig.[pic : f39 ] , we display 4 models with two different numerical resolutions @xmath312 ( models a and c ) , @xmath313 ( models b and d ) .",
    "models c and d are evolved with fixed matter distribution and only metrics are evolved , while , in models a and b , both matters and metrics are evolved . @xmath251 and @xmath252 panels display time evolutions of deviations of the central lapse and the adm mass from their initial values , respectively . in the @xmath252 panel",
    ", we also display the time evolutions of baryon mass for models a and b with thick lines . from this figure",
    ", we see that models c and d keep their initial configurations within 1@xmath314 , while fully evolved models a and b show gradual decrease(increase ) of adm mass(central lapse ) . in this test ,",
    "our treatment of the low density region outside of the ns is like this .",
    "we set the floor density value as @xmath315 and , in every time step , for all cells whose density is smaller than @xmath316 , we assume them as vacuum .",
    "then their density and velocity are reset to @xmath317 and 0 , respectively .",
    "we consider that this treatment is too simple and , e.g. , the conservation of baryon mass is violated as seen in thick lines .",
    "however , in the context of ccsne , we currently do not have to treat vacuum space and , additionally , models a and b show numerical convergence with respect to grid resolution , we consider our gr code works with sufficient level for our aims .      in the end , we mention about the influence of amr refinement procedures during the collapse and about the numerical convergence . in grmhd models , we refine the amr blocks as the central density grows to save the computational time .",
    "typically the total number of amr blocks increases from @xmath318 at initial to @xmath16 at core bounce .",
    "we check whether this refinement procedure breaks such as the hamiltonian constraint or the adm mass conservation .    in fig.[pic : f40 ] , we plot the central lapse @xmath158 , the error of the hamiltonian constraint @xmath319 ( see , eq . ( [ eq : l1normhamiltoniancon ] ) ) and the adm mass normalized by its initial value of magnetorotational collapse of a 100@xmath320 star with zero metallicity @xcite .",
    "such a highly massive star is considered to form bh and a good objection to test our grmhd code .",
    "initial conditions and the adopted eos are the same as those used in model `` gb12r020sf '' ( see , sec.[sec : collapse ] ) and the minimum cell width is @xmath321 m . we also plot the deviation of the total angular momentum along the rotational axis from its initial value @xmath322 , here @xmath323 is defined by eq .",
    "( [ eq : jtot ] ) and @xmath324 is the value at @xmath325 ms . in this test ,",
    "the total number of amr blocks increases from 792 to 11432 through three times refinement procedures until the time of core bounce .",
    "the adm mass and the total angular momentum should be almost constant until the core bounce and for a short while after it .",
    "this is because it takes @xmath326km/@xmath327ms till the gravitational radiation , emitted at core bounce around the center , reaches the outer boundary 5000 km . from this test , we find that the total angular momentum are conserved within @xmath328 until the time of core bounce .",
    "in addition , the time evolution of the central lapse is smooth and no influence of the refinement procedures is seen .",
    "as for the hamiltonian constraint , @xmath329 is kept within several percentage until the time of core bounce except @xmath330 ms and after a short while from the core bounce .",
    "we consider that the sudden increase of @xmath329 during @xmath330 ms is due to the low resolution and thus the next refinement at @xmath331 ms suppresses the error .",
    "after the core bounce at @xmath332 ms , @xmath329 increases gradually due to the collapse but not rapidly and finally the calculation is crushed .",
    "we found the apparent horizon @xcite is formed at the end of the calculation and we thus consider the bh is born .    in fig .",
    "[ pic : grconverge ] , we display magnified views of fig .",
    "[ pic : f40 ] around the time of core bounce with two different numerical resolutions .",
    "we put the outer boundary at 5000 km for lower resolution model and 4000 km for higher one and maintain the amr structure almost the same in both models .",
    "then the cell widths of the higher resolution model are 0.8 times smaller than those of lower resolution model . in fig .",
    "[ pic : grconverge ] , @xmath263 and @xmath261 lines correspond to higher ( minimum cell width is @xmath333 m ) and lower ( @xmath321 m ) resolution model , respectively . from this figure",
    ", we see that the good numerical convergence is achieved .",
    "in this section , we calculate magneto rotational collapse of a @xmath335 progenitor star as our practical test using gr / nmhd codes and check their abilities .",
    "we follow the gravitational collapse with varying the initial magnetic field , the stiffness of the eos and the initial central angular velocity .",
    "we first describe our initial setups and then show results after subsection [ sec : results ] .",
    "we adopt a parametric type eos ( e.g. , * ? ? ?",
    "* ) in this study .",
    "it is divided into two parts , `` cold '' and `` thermal '' part .",
    "the cold part is expressed as @xmath336 where , we fix @xmath337 in cgs units and @xmath338 are determined from the continuity of @xmath339 at @xmath340 .",
    "@xmath341 corresponds to the nuclear density @xmath342 .",
    "polytropic indexes represent physical processes occurring during core collapse such as the electron - capture , onset of the neutrino - trap and the nuclear repulsive force .",
    "we adopt two types of polytropic indexes and , for convenience , we call `` soft '' and `` stiff '' eos as summarized in table [ tb : pcold ]",
    ". stiff eos corresponds to the models reported in @xcite and soft eos adopts smaller polytropic index compared to the stiff case in the range of @xmath343 .",
    "that density region corresponds to the electron capture regime .",
    "cccccccc 1 & @xmath344 & @xmath345 & 4/3 & & @xmath344 & @xmath345 & 4/3 + 2 & @xmath346 & @xmath347 & 1.29 & & @xmath346 & @xmath348 & 1.31 + 3 & @xmath349 & @xmath350 & 1.32 & & @xmath351 & @xmath352 & 4/3 + 4 & @xmath353 & @xmath354 & 2.5 & & @xmath353 & @xmath355 & 2.5 + [ tb : pcold ]    the thermal part is expressed by @xmath356 and we fix the index of the thermal part as @xmath357 in this study .",
    "then the total pressure @xmath36 and internal energy @xmath37 contributed from both thermal and cold part are written by @xmath358      in nmhd models , we did not change their initial amr structures and fixed them . on the other hand",
    ", we turn on the switch of amr and refine amr boxes in the vicinity of center in grmhd models .",
    "this is because , the time step @xmath359 to keep the courant - friedrichs - lewy condition ( cfl condition ) is determined from the maximum wave speed which usually becomes that of dynamical background and not hydrodynamical wave speed ( i.e. , the fast magneto sonic ) in grmhd models .",
    "the wave speed of the dynamical background is nearly the speed of light @xmath360 and hardly change throughout the time evolution and also not depend on the hydrodynamical properties such as maximum density .",
    "we set @xmath359 as @xmath361 in grmhd models to keep the cfl condition where @xmath362 is the minimum cell width in the computational domain .",
    "if we set maximum @xmath363 as the maximum allowed one ( @xmath364 in this study ) from the beginning of calculation , it takes too much time until corebounce since the time step depends solely on @xmath362 . therefore in grmhd models , we set maximum @xmath363 as 5 at the beginning and then increment it as the collapse proceeds to save computational time .",
    "we define the criterion to increment the maximum amr level ( i.e. , refine the amr boxes in the vicinity of center ) that every time the central density exceeds",
    "@xmath365 g @xmath249 .",
    "influences of box refinements are described in sec .",
    "[ sec : box refinement ] .",
    "the outer boundary is taken at 5000 km from the origin and @xmath178 amr boxes with 0 refinement level ( @xmath366 ) cover the whole computational domain which is @xmath260$]km .",
    "we set the maximum allowed amr refinement level to 8 in standard model and to 9 for high resolution model , thus the highest resolution is @xmath367 m in standard and @xmath368 m in high resolution run . in standard models , the central region of @xmath369$]km",
    "is covered by @xmath370 and @xmath371 km is covered by @xmath372 ( see , fig.[pic : amrstructure.eps ] ) .",
    "on the other hand in high resolution run , the central regions of @xmath373 , 60 , 30 km are covered by @xmath370 , 8 , 9 , respectively .",
    "since the most dynamical and active region is above the surface of central core ( @xmath374 km ) and inside the prompt shock ( @xmath375 km ) , we increase resolutions as much as possible in this region .",
    "then the total numbers of amr blocks become @xmath376 in standard run and @xmath377 in high resolution run .",
    "our progenitor is a @xmath0 star with the metallicity z=0.02 and the pre - collapse model is taken from @xcite which calculates stellar evolution with spherical symmetry .",
    "we add rotation and magnetic field to the spherical progenitor model .",
    "since little is known about the rotational law and magnetic field configuration in the central iron core and its surroundings at the pre - collapse stage , we assume the rotational law such as @xmath378 where @xmath379 , @xmath380 and @xmath381 is the parameter which is set as @xmath382 cm in this study .",
    "these configurations are commonly used rotational law in which the core , within @xmath383 , rotates rigidly with angular velocity @xmath384 and differentially beyond that .",
    "both equations represent same rotational profile , since in the newtonian limit of eq .",
    "( [ eq : rotlawgrmhd ] ) becomes eq .",
    "( [ eq : rotlawnmhd ] ) by replacing @xmath385 and @xmath386 , where @xmath387 is a component of cylindrical flat metric .",
    "as for the initial magnetic field configuration , to ensure divergence - free constraint , we adopt the following form of vector potential ( see , e.g. , * ? ? ?",
    "@xmath388 where @xmath389 are the parameters and @xmath390 .",
    "@xmath391 is fixed as @xmath382 cm in this study .",
    "this vector potential represents almost uniform magnetic field within @xmath392 and dipole - like magnetic field configuration beyond @xmath392 with the central magnetic field strength @xmath393 .",
    "we calculated several models with various initial magnetic field strength @xmath394 , in eq .",
    "( [ eq : vectorpotential ] ) , and central angular velocity @xmath395 , in eq .",
    "( [ eq : rotlawnmhd]-[eq : rotlawgrmhd ] ) .",
    "we also add random perturbation to trigger asymmetric motion in the form of velocity with 5% amplitude when the maximum density exceeds @xmath396",
    "g @xmath249 .",
    "such perturbation is added in the central sphere of radius @xmath382 cm via @xmath397 in this equation , @xmath391 is a parameter fixed with @xmath398 cm and @xmath399 is a random number . here",
    ", we have to comment about the momentum constraint , eq.([eq : momentumcon ] ) , in grmhd model , since the momentum constraint would be violated by adding the perturbation . in our practical simulations , the momentum constraint @xmath400",
    "is not kept strictly 0 during time evolution due to the numerical error . in our grmhd model `` gb12r020sf '' , for instance , @xmath401 defined by eq.([eq : l1normmomentumcon ] )",
    "is @xmath402 before the perturbation is added .",
    "@xmath403}dx^3}\\end{aligned}\\ ] ] by adding the perturbation , this value increases to @xmath404 . on the other hand , the error after core bounce is around @xmath405 in both models with and without the perturbation and we thus consider that the violation of the momentum constraint by the perturbation is negligibly small within the range of our numerical accuracy .",
    "cccccccccc nb00r02st & 0e0 & 2 & 0e0 & 0.135 & -6.46e51 & & 2.0483 & & stiff + nb12r02st & 4.8e12 & 2 & 2.95e-4 & 0.135 & -6.46e51 & & 2.0483 & & stiff + nb00r02sf & 0e0 & 2 & 0e0 & 0.135 & -6.46e51&&2.0483 & & soft + nb12r02sf & 4.8e12 & 2 & 2.95e-4 & 0.135 & -6.46e51 & & 2.0483 & & soft + nb12r06sf & 4.8e12 & 6 & 2.95e-4 & 1.22 & -6.46e51&&2.0483 & & soft + nb09r02sf & 1e9 & 2 & 1.15e-11 & 0.135 & -6.46e51 & & 2.0483 & & soft + gb00r02sf & 0e0 & 2 & 0e0 & 0.132 & -6.62e51 & 0.994 & 2.0688 & 2.0673 & soft + gb12r02sf &",
    "4.8e12 & 2 & 2.00e-4 & 0.132 & -6.62e51 & 0.994 & 2.0688 & 2.0673 & soft + [ tb : model ]    model names and adopted parameters are summarized in table [ tb : model ] .",
    "the first character `` n '' and `` g '' of model names indicate that the calculation is done by nmhd and grmhd code , respectively .",
    "numbers after `` b '' and `` r '' represent the exponent of magnetic field strength and the central angular velocity , respectively .",
    "the last characters st / sf represents stiff / soft eos adopted . as for the initial magnetic field strength",
    ", we adopted 0 , @xmath406 and @xmath407 g so that we can easily check the roles of magnetic field .",
    "the initial magnetic field is first amplified mainly through the compression and the rotational winding effects during collapse from previous many studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "for instance , the compression mechanism amplifies the magnetic field about @xmath408 times @xcite and then @xmath409 g is amplified to @xmath410 g which is equivalent strength to that of magnetar @xcite .",
    "@xcite studied stellar evolution with including magnetic field and rotation and they reported the strength of magnetic field is of the order of @xmath411 g or weaker and the poloidal magnetic field is much weaker , approximately @xmath412 , than the toroidal component .",
    "thus our initial condition with purely poloidal and extremely strong magnetic field might be unrealistic one , however we employ such initial condition to see the effects of magnetic field easily and also to compare our results with other previous studies .",
    "in addition to the very strong initial magnetic field models , we calculated one model ( nb09r02sf ) with initially weak magnetic field @xmath413 g in a high resolution run .",
    "since , there are possibly several non linear magnetic field amplification mechanisms in the vicinity of pns such as mri or dynamo mechanism which are intrinsically 3d phenomena , we examine how the initially weak magnetic field is amplified through this model . as for the central angular velocity @xmath384",
    "we adopt 2 or 6 ( rad / s ) . in @xcite , they calculated the evolutions of various rotating stars with changing initial stellar mass and metallicity .",
    "their results are that @xmath414 star with solar metallicity ( @xmath415 ) has @xmath416 at the end of silicon burning stage .",
    "they also reported that lower initial metallicity raises the final angular velocity due to lower mass loss rate .",
    "@xcite did similar works to @xcite , though they included magnetic effects .",
    "their results showed magnetic torques lower the local specific angular momentum approximately one order of magnitude compared to non - magnetic field cases .",
    "however these two works are done by one dimensional calculations and are not still conclusive results .",
    "thus , even though our adopted parameters are comparatively faster than the theoretical works those values may be reasonable .      in grmhd calculations",
    ", we have additional setups to be done which are constraining the hamiltonian and momentum equations ( [ eq : hamiltoniancon ] ) and ( [ eq : momentumcon ] ) .",
    "to solve eqs .",
    "( [ eq : hamiltoniancon]-[eq : momentumcon ] ) , we assume conformally flat metric for initial condition , in which @xmath417 ( therefore , @xmath418 ) and @xmath419 . then , following @xcite , constraint equations become the following 4 equations to obtain rest of bssn variables @xmath255 and @xmath420 and gauge variables @xmath158 and @xmath421 . @xmath422 where @xmath423 is the laplacian in flat space .",
    "we solve above 4 equations by iterative method with initial guess as @xmath424 , @xmath425 , @xmath270 , @xmath426 . then first , we evaluate conservative variables @xmath129 from given metrics and primitive variables @xmath139 from a progenitor model .",
    "second , we solve above each equation .",
    "we iterate these two procedures until sufficient convergence is achieved . after these procedures",
    ", the hamiltonian constraint @xmath427 at initial is kept below arbitrary chosen small number ( in our calculations @xmath428 is adopted ) .",
    "we first show the time evolutions of the maximum density @xmath429 in fig.[pic : f2 ] , which tells us rough overview of how the core collapse proceeds . in this study our calculations are done in full three - dimension and the central density does not always become the maximum one , thus we do not use central value .",
    "however all of our models show that the maximum density exists nearly the center . in fig.[pic : f2 ] , each line corresponds to different model and the model names are shown in the bottom part . from this figure",
    ", we can find @xmath429 is increased @xmath430 30% in grmhd models when compared with corresponding nmhd models ( e.g. , `` gb12r020sf '' vs `` nb12r020sf '' ) .",
    "we however do not see any rapid increase of @xmath429 which possibly indicates collapse toward bh formation .",
    "another feature is that the central density gradually increases after core bounce when the magnetic field exists , on the other hand the central density decreases in non - magnetized models ( e.g. , @xmath298 vs @xmath232 solid curves ) .",
    "this difference means that the magnetic torque works strongly and the maximum density increases due to the angular momentum transfer . in rapidly rotating model",
    "`` nb12r060sf '' , the maximum density at core bounce marginally exceeds the nuclear density ( @xmath431 g @xmath249 ) and it is thus not rotational supported core bounce but due to the nuclear repulsive force which is the same as the rest of models . in this model",
    ", @xmath429 eventually relaxes to similar value to other models after several oscillations .",
    "we also summarize physical properties at core bounce in table [ tb : corebounce ] .",
    "ccccc nb00r02st & 3.54 & 0 & 3.62 & - + nb12r02st & 3.55 & 6.17e-4 & 3.58 & - + nb00r02sf & 3.95 & 0 & 3.00 & - + nb12r02sf & 3.96 & 5.88e-4 & 2.82 & - + nb12r06sf & 2.25 & 165e-1 & 13.9 & - + nb09r02sf & 3.98 & 2.88e-11 & 3.04 & - + gb00r02sf & 4.87 & 0 & 2.25 & 0.839 + gb12r02sf & 4.87 & 2.31e-4 & 2.20 & 0.839 + [ tb : corebounce ]    fig .",
    "[ pic : rhox ] displays time evolution of density profiles along the @xmath66 axis in model nb12r020sf(@xmath182 ) and nb12r020st(@xmath184 ) .",
    "numbers beside each line denote time in ms .",
    "prompt shock which is formed at core bounce moves outward and then stays around @xmath432 - 300 km in model nb12r020sf , on the other hand the shock moves further out in stiff eos model nb12r020st .",
    "model nb12r020st adopts same eos as that of @xcite and our result seen in the prompt shock propagation agrees well with their results .    in fig.[pic :",
    "f3 ] , we display time evolutions of the rotational , internal and magnetic energies in @xmath182 four panels and we also plot comparison between grmhd(gb12r020sf ) and nmhd(nb12r020sf ) models in @xmath184 two panels .",
    "the magnetic energy of model `` nb09r020sf '' is too small compared to other strong field models and we display it separately with different range in @xmath187-@xmath184 panel .",
    "we see that the rotational and the internal energies are kept almost constant or gradual increase after core bounce , on the other hand the magnetic energy increases rapidly , approximately @xmath433 orders , after core bounce . in strongly magnetized models ( @xmath434-@xmath435 panel ) , the final magnetic energies saturate around @xmath436ergs .",
    "when we compare grmhd and nmhd models , shown in @xmath184 two panels , the evolution tracks look similar except @xmath437 and @xmath164 after @xmath438ms .",
    "we consider the difference is originated from the bipolar - outflow and will be described in sec .",
    "[ sec : formationofoutflow ] .",
    "finally we compare our results shown here with those reported by other groups .",
    "@xcite reported magnetorotational collapse in axisymmetry with various initial rotation , magnetic field and eos and also with including general relativistic effects by replacing spherical newtonian potential with `` tolman - oppenheimer - volkoff '' potential .",
    "they showed that maximum rest mass density is increased several 10 % after core bounce when they compare gr and newtonian models and also that the magnetic field works to raise the maximum rest mass density .",
    "these features agree to ours since @xmath439% rise in the maximum density in our grmhd model can be seen .",
    "additionally , if we compare our results with previous three - dimensional nmhd work reported by @xcite , similar time evolutions are obtained such as time evolution of various energy components and also the shock propagation ( as seen in fig .",
    "[ pic : rhox ] ) .",
    "thus , we consider the results shown here are common and robust features .",
    "next , we describe the formation of bipolar outflow . in all of our strongly magnetized models ,",
    "bipolar outflow is formed in a similar manner and we thus present mainly one representative model `` nb12r020sf '' in this subsection .",
    "fig.[pic : rho5rho7 ] and fig.[pic : rho8rho9 ] show the density contour in model `` nb12r020sf '' at different time slices .",
    "fig.[pic : f5f7 ] and fig.[pic : f8f9 ] are the same as fig.[pic : rho5rho7 ] but are with the color coded contour of plasma beta ( @xmath440 ) in logarithmic scale and the flow velocity in @xmath441 arrows .",
    "@xmath442 curves represent the iso - density contour .",
    "the depicted region is @xmath443$]km and , in each panel , @xmath187-@xmath182 , @xmath186-@xmath182 and @xmath186- @xmath184 part represents @xmath444 ( equatorial ) , @xmath445 and @xmath446 plane , respectively .    as shown in these figures , the strongly magnetized regions where @xmath447 reaches @xmath448 appear along the rotational axis , which means the magnetic pressure is comparable to the matter pressure .",
    "then high velocity outflow is launched along the rotational axis ( see , fig.[pic : f10f13 ] for nmhd and fig.[pic : f21f22 ] for grmhd ) while inflow appears along the equatorial plane .",
    "cc     two panels are `` nb12r020sf '' and @xmath184 two are `` nb00r020sf '' and @xmath449 km is drawn .",
    "the central spherical - like shells represent iso - density surfaces and the outermost shell ( @xmath231 ) corresponds to @xmath450 g @xmath249 .",
    "@xmath451 lines are the magnetic field lines .",
    "translucent and opaque @xmath232 surfaces are iso - radialvelocity surfaces and each corresponds to @xmath452 cm @xmath453 ( translucent ) and @xmath454 cm @xmath453 ( opaque ) . in non - magnetized model ``",
    "nb00r020sf '' , high velocity bipolar outflow did not appear .",
    ", width=188 ]     two panels are `` nb12r020sf '' and @xmath184 two are `` nb00r020sf '' and @xmath449 km is drawn .",
    "the central spherical - like shells represent iso - density surfaces and the outermost shell ( @xmath231 ) corresponds to @xmath450 g @xmath249 .",
    "@xmath451 lines are the magnetic field lines .",
    "translucent and opaque @xmath232 surfaces are iso - radialvelocity surfaces and each corresponds to @xmath452 cm @xmath453 ( translucent ) and @xmath454 cm @xmath453 ( opaque ) . in non - magnetized model ``",
    "nb00r020sf '' , high velocity bipolar outflow did not appear .",
    ", width=188 ]    cc     two panels are `` nb12r020sf '' and @xmath184 two are `` nb00r020sf '' and @xmath449 km is drawn .",
    "the central spherical - like shells represent iso - density surfaces and the outermost shell ( @xmath231 ) corresponds to @xmath450 g @xmath249 .",
    "@xmath451 lines are the magnetic field lines .",
    "translucent and opaque @xmath232 surfaces are iso - radialvelocity surfaces and each corresponds to @xmath452 cm @xmath453 ( translucent ) and @xmath454 cm @xmath453 ( opaque ) . in non - magnetized model ``",
    "nb00r020sf '' , high velocity bipolar outflow did not appear .",
    ", width=188 ]     two panels are `` nb12r020sf '' and @xmath184 two are `` nb00r020sf '' and @xmath449 km is drawn .",
    "the central spherical - like shells represent iso - density surfaces and the outermost shell ( @xmath231 ) corresponds to @xmath450 g @xmath249 .",
    "@xmath451 lines are the magnetic field lines .",
    "translucent and opaque @xmath232 surfaces are iso - radialvelocity surfaces and each corresponds to @xmath452 cm @xmath453 ( translucent ) and @xmath454 cm @xmath453 ( opaque ) . in non - magnetized model ``",
    "nb00r020sf '' , high velocity bipolar outflow did not appear .",
    ", width=188 ]    cc     but of grmhd models ( @xmath182 ; `` gb12r020sf  and @xmath184 ; ' ' gb00r020sf  ) .",
    "both snapshots are taken at t=87 ms .",
    ", width=188 ]     but of grmhd models ( @xmath182 ; `` gb12r020sf  and @xmath184 ; ' ' gb00r020sf  ) .",
    "both snapshots are taken at t=87 ms .",
    ", width=188 ]    on the other hand , non - magnetized models and weakly magnetized model `` nb09r020sf '' do not form any bipolar outflow as seen from two @xmath184 panels of fig.[pic : f10f13 ] .",
    "when we compare grmhd(gb12r020sf ) and nmhd(nb12r020sf ) models , we see that the shock front of bipolar outflow moves faster , approximately a factor of 2 , in grmhd model as can be seen in fig .",
    "[ pic : shockp.eps ] .",
    "since the bipolar outflow is driven by the angular momentum transfer ( described in the next section ) , higher velocity outflow reflects that gb12r020sf extracts larger angular momentum compared to nb12r020sf .",
    "then the magnetic energy is increased while the rotational energy is decreased as seen in @xmath184-@xmath187 panel of fig .",
    "[ pic : f3 ] .      in this section",
    ", we describe the driving mechanisms of the outflow .",
    "as mentioned in previous subsection , all strongly magnetized models exhibit high velocity outflow along the rotational axis .",
    "the ultimate energy source of outflow is the angular momentum transfer from the central object which can be seen from fig.[pic : f14f17 ] . in this figure ,",
    "the angular velocities along the @xmath66 axis of different models at different time slices are shown .",
    "cc    cc    for instance , from left two panels , we can see the angular velocity within @xmath455 km decreases rapidly , a factor of several , from @xmath456ms to @xmath457 - 90ms . on the other hand , non - magnetized models ( right two panels )",
    "do not show any deceleration ( note that kink in the angular velocity profile at @xmath458 km shown in @xmath459ms of `` nb00r020sf '' is originated from such as meridional circulation or displacement of the mass center ) .",
    "from this fact , the angular momentum is extracted from the central object by the magnetic field .",
    "the extracted angular momentum is first converted to the magnetic field mainly via the magnetic field lapping . then , there are two types of driving mechanisms of the outflow , the magneto - spring and the magneto - centrifugally supported mechanisms .",
    "we consider , from @xmath182 two panels of fig.[pic : f10f13 ] , that initial mechanism is the magneto - spring effect and then it transitions to the magneto - centrifugally supported mechanism .",
    "this is because from fig.[pic : f10f13 ] , we see the magnetic field lines are highly twisted inside the shell at the onset of launching the outflow ( t=120ms ) , however this twisted configuration is stretched eventually , as if the compressed spring would do , toward the north - south direction as seen in t=171ms panel .",
    "final magnetic field configuration is less toroidal dominant compared to that of t=120ms and the matters stream away along these helical magnetic field lines .",
    "cc    this is also seen in fig.[pic : f18f20 ] which shows time evolutions of the outflow velocity ( @xmath460 ) , the toroidal magnetic field ( @xmath461 ) and angle @xmath462 between the magnetic field and the velocity vector , along the rotational axis of model `` nb12r020sf '' . from @xmath434-@xmath184 panel ,",
    "we find the strongly amplified @xmath461 at @xmath463ms and @xmath464 km which shortly disappears . at the same time",
    ", the high velocity region appears in the @xmath434-@xmath182 panel .",
    "the angle @xmath465 is nearly @xmath466 at @xmath467 km and @xmath468ms which indicates that the outflow is driven by the gradient of magnetic pressure ( i.e. , the magneto spring effect ) .",
    "then @xmath469 is accelerated up to @xmath470 km along the magnetic field ( @xmath471 , i.e. , the magneto centrifugal effect ) .    in @xcite",
    ", they calculated 2d axisymmetric grmhd simulations and reported mhd outflow is first driven by the magneto - spring effect and eventually by the magneto - centrifugally supported mechanism .",
    "thus our results of launching processes of mhd outflow are qualitatively similar to theirs .",
    "as described in the previous subsection , our results seen in dynamical evolutions are qualitatively the same as those reported in previous 2d axisymmetric mhd works ( for nmhd see , e.g. , @xcite and for grmhd see , e.g. , @xcite ) in the way that the equatorial inflow and the bipolar outflow along the rotational axis due to the magnetic field .",
    "we also calculated several models with tilted magnetic field axis against the rotational axis to induce larger non - axisymmetry and found the outflow is driven along the rotational axis similar to @xcite . according to many previous studies , both in gr and the newtonian limit ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , the nascent neutronstar is sensitive to the rotational instability predominated by the `` m=1 '' non - axisymmetric mode within our initial rotational parameter range . to confirm our code",
    "can actually reproduce some nonaxisymmetric modes characteristic to rotational collapse of massive stars , we monitor the non - axisymmetry with the same approach as @xcite .",
    "we decompose the density into the fourier components along the equatorial ring of radius 40 km which is is beyond the central rigidly rotating region and inside the prompt shock ( see , fig.[pic : rhox ] ) .",
    "fourier amplitude of mode `` m '' is defined as the following equations .",
    "@xmath472 in fig.[pic : f23 ] , we plot the time evolutions of normalized mode amplitude @xmath473 .    from this figure , we see that m=4 mode is the most dominant mode before core bounce ( @xmath474ms ) since our cartesian grid induces quadrupole numerical noise at initial .",
    "however , the linear amplification phase starts immediately after core bounce and several ms later it reaches the non - linear phase ( @xmath475ms ) . during the non - linear phase ,",
    "dominant mode becomes m=1 and their normalized amplitude exceed @xmath476 .",
    "this is consistent with the structure , a so - called one - armed spiral structure seen in @xcite .",
    "since @xmath477 at core bounce reaches @xmath478% and also keeps @xmath479% after core bounce , we consider that the low-@xmath3 instability causes this non - axisymmetric configuration . like",
    "these , even though the outflow structure is almost axisymmetric from broader perspective , non - axisymmetry develops and show significantly large mode amplitude in the vicinity of center in the self gravitating system .",
    "this non - axisymmetry may alter the gravitational wave form @xcite .",
    "next , we describe about the amplification of initially weak magnetic field ( @xmath480 g ) in model `` nb09r020sf '' . as mentioned above in sec.[sec : formationofoutflow ] , only through the field - wrapping and the compression mechanism , the magnetic field can not be amplified strongly enough to drive the outflow soon after the core bounce as seen in other models with initially strong magnetic field",
    ". however , there might be several magnetic field amplification mechanisms to be occurred after core bounce such as the mri or the dynamo mechanism @xcite in addition to the aforementioned linear mechanisms .",
    "if some of these mechanisms operate within dynamical time scale , the saturated magnetic field is considered to possess enough capability to affect the explosion dynamics .",
    "the largest difference between 3d and 2d(axisymmetric ) in the amplification of the magnetic field is conversion from toroidal to poloidal magnetic field , since the toroidal to poloidal conversion can never happen in 2d axisymmetric motion .",
    "this is because , from the faraday s law , time evolution of a poloidal component @xmath481 becomes @xmath482 here , `` pol '' and `` tor '' represent a poloidal and toroidal component , respectively , and `` pol@xmath483 '' is a perpendicular one to both the `` pol '' and `` tor '' components . in axisymmetry , @xmath484 and thus @xmath485 can not be converted to @xmath481 , however in full 3d , several non - axisymmetric fluid motions ( e.g. , the parker or the tayler or the convective instabilities ) let @xmath486 and close the conversion cycle ( i.e. , from poloidal to toroidal and toroidal to poloidal ) . through our weakly magnetized model `` nb09r020sf '' , we examine how the magnetic field is amplified after core bounce and whether the amplified magnetic field affect the explosion dynamics or not .    in fig.[pic :",
    "f24f27 ] , we display time evolution of the magnetic field strength in logarithmic scale of model `` nb09r020sf '' which is high resolution run .",
    "cc    cc    within @xmath487 km , strength of the magnetic field shows stratified configuration compared to @xmath374 km and is amplified strongest ( @xmath488 g ) among the numerical domain . since , within @xmath489 km , matters rotate differentially with the steepest angular velocity gradient ( see , fig.[pic : f14f17 ] ) , the magnetic field strength is higher than the value of central region @xmath490 km where the rotation is almost rigid .",
    "magnitude of the amplification is @xmath491 which is close to the value predicted by compression and we thus consider the dominant field amplification mechanisms within @xmath489 km are compression and the rotational winding effect .",
    "in contrast , we see the region @xmath374 km is highly non - homologous and the magnetic field configuration pattern changes momentarily , however the maximum strength keeps the same level of the order of @xmath492 g throughout our calculation ( @xmath493ms after core bounce ) . the stochastic configuration pattern beyond @xmath494 km is mainly triggered by the entropy driven convection .",
    "the reason is like this .",
    "there are several candidates to configure such flow pattern such as the convective motion , the mri , the parker instability ( or the magnetic buoyancy ) or the tayler instability .",
    "however , among them , the growth time scales of the tayler and the parker instabilities are too long and they are inefficient during our calculation time .",
    "for instance , the growth time scale of the tayler instability is the order of the @xmath495 crossing time of the system and @xmath496 h according to @xcite in a weakly magnetized limit . as for the parker instability",
    ", the growth time scale ( @xmath497 ) can be estimated by using the frequency of the magnetic buoyancy @xmath498 as @xmath499 . according to @xcite ,",
    "@xmath498 is defined by using the the @xmath495 velocity @xmath55 , the speed of sound @xmath62 , the toroidal magnetic field @xmath461 and the rest mass density @xmath26 as @xmath500 where , @xmath501 , @xmath502 is the entropy and @xmath503 is the gravitational acceleration . in",
    "what follows , we adopt a pseudo - entropy defined by @xmath504 . in fig .",
    "[ pic : bvfreq ] , we display color coded contour of @xmath505 ( @xmath184 ) in addition to the brunt-@xmath506 frequency @xmath507 ( @xmath182 ) defined by@xmath508 in log scale of model `` nb09r020sf '' .",
    "cc    in each panel , color - less area is where @xmath509 has positive value and is thus stable region against each mechanism .",
    "the specific angular momentum with positive gradient with respect to @xmath510 has stabilizing effect on the convective motion , however it has negative gradient in our models and the unstable region becomes larger when we consider the contribution from it ( i.e. , the solberg - h@xmath511iland criterion ) . from fig .",
    "[ pic : bvfreq ] , we see the pns is convectively and magnetic buoyantly unstable .",
    "however , the growth time scale of each mechanism differs widely , @xmath512ms for convection and @xmath513s for magnetic buoyancy .",
    "since our calculation time is @xmath493ms after core bounce , the parker instability does not grow while the convection can grow sufficiently within our simulation times . the convective - dynamo is thus considered to contribute to the magnetic field amplification mechanism .",
    "we also examine the possibility of the mri . since , from local linear analysis , the mri would occur when the rotation is differential with negative angular velocity gradient @xcite . from fig.[pic : f14f17 ] , we see inside the shock ( @xmath514 km ) has negative angular velocity gradient and is thus unstable against the mri . however , to follow the mri by numerical simulation , the critical wave length of the mri `` @xmath515 '' has to be resolved at least @xmath8 numerical grids @xcite . here , @xmath515 is defined by @xmath516 in fig.[pic : f28f29 ] , we display the ratio of the critical wave length @xmath515 to the local numerical grid width in @xmath182 panel and rough estimation of the growth time scale of the fastest growing mri mode `` @xmath517(ms ) '' in log scale in @xmath184 panel .",
    "@xmath517 is defined by ( see , * ? ? ?",
    "@xmath518    cc    from @xmath182 panel of this figure , we see the most part has negative value and therefore the mri can not be resolved .",
    "we have to employ @xmath519 times higher resolution ( @xmath520 m ) to resolve the mri or , if we adopt @xmath8 times larger initial magnetic field ( @xmath521 g ) , we possibly manage to do it with our high resolution run marginally , since the wave length @xmath515 is proportional to @xmath522 . here , we comment about our strongly magnetized models ( @xmath523 g ) . if we extend what we mentioned just above ( i.e. , to adopt stronger initial magnetic field ) , we may easily resolve the mri since the critical wave length @xmath515 is approximately @xmath524 times larger compared to weakly magnetized model . from fig .",
    "[ pic : f28f29 ] , we can estimate the wave length as @xmath525 m ( @xmath526 region ) and @xmath527 m ( @xmath528 region ) for @xmath529 km where the resolution is @xmath530 m . then in the strongly magnetized models , @xmath515 multiplied @xmath524 becomes @xmath531 km .",
    "however , the system scale ( i.e. , inside the prompt shock ) is @xmath532 km and therefore those modes which have larger wave length than the system can not last . in case",
    "an mri mode lasts and if we can resolve it , the magnetic field soon reaches saturation strength in several times of the growth time scale .",
    "@xcite derived the saturated magnetic field strength @xmath533 as @xmath534 and it becomes @xmath535 g with our initial rotational parameter .",
    "all of our strongly magnetized models exhibit saturated magnetic field strength of the order of @xmath13 g after core bounce ( the value is consistent with those reported by previous many studies , e.g. , for nmhd @xcite , for grmhd , @xcite and for 3d works , @xcite ) .",
    "the value is comparable to @xmath533 and we thus consider the initially strong magnetic field is first amplified by the compression and the winding effect with the amplification magnitude of the order of @xmath536 and then the mri operates to amplify the magnetic field up to the saturation strength ( in * ? ? ?",
    "* ; * ? ? ?",
    "* they reported the mri operates with adopting similar initial magnetic field strength @xmath537 g ) .",
    "however , since just only the linear amplification mechanisms amplify the magnetic field up to @xmath535 g which is close to the mri saturation level , to see the effects of the mri amplification more clearly , we have to adopt sufficiently weak magnetic field ( e.g. , @xmath538 g ) which does not reach @xmath533 only through the linear amplification mechanisms but sufficiently strong to resolve by numerical simulation .    as for the calculation time , the length of 40 ms after core bounce is marginally sufficient for the inner region ( @xmath539 km ) from the @xmath184 panel of fig .",
    "[ pic : f28f29 ] , however beyond that region we have to evolve more than several hundreds ms .",
    "if we capture the linear amplification , it may reaches the saturation phase within the several rotational periods . at this saturation phase , whether the magnetic field is sufficiently strong to affect the explosion dynamics and how the magnetic field configuration is can not be clarified without numerical simulation and this would be our future work .",
    "the explosion mechanisms of the core - collapse supernovae have been unknown and fascinating problems for several decades .",
    "recent observations show several common features seen in the ccsne that some types of them are bipolar like and sometimes non - axisymmetric explosions .",
    "motivated by these , we now have to take into account the effects of asymmetry into numerical works to uncover the explosion dynamics .",
    "fortunately , recent development of computational resources enable us to handle the numerical simulations in the context of three dimension .",
    "we therefore have developed two types of three dimensional magneto hydrodynamical codes .",
    "one is in the newtonian approximation ( nmhd ) and the other is in the full general relativity ( grmhd ) .",
    "the features of our codes are ; ( 1 ) adoptive mesh refinement to cover the wide dynamical ranges ; ( 2 ) high resolution shock capturing scheme with roe - like ( in nmhd ) and hll ( in grmhd ) flux ; ( 3 ) several reconstruction schemes to maintain high spatial resolution ; ( 4 ) time update of the matters and the metric is done by the iterative crank - nicholson scheme ; ( 5 ) the constrained transport to evolve the magnetic field ; ( 6 ) any types of the eos can be adopted ; ( 7 ) the poisson solver with biconjugate gradient stabilized method under our amr structure to solve the self gravity ( in nmhd ) and the non - linear poisson like equations for the hamiltonian and the momentum constrains ( in grmhd ) .    in this paper , we described our numerical methods in detail and did several tests to confirm their abilities through the simple shock tube tests ; the poisson solver for the spherically distributed matters ; conservation of the mass , the energy and the local / global angular momentum ; the quadrupole linearized gravitational wave ; the rotating neutronstar in equilibrium states and so on . through these tests",
    ", we confirmed that our codes reproduce the numerical error convergence predicted by our adopted reconstruction schemes and also confirmed that the accuracy of our code is sufficient to follow the dynamical evolution of ccsne . and as for the first test of ccsn simulation , we calculated collapse of a @xmath0 progenitor with varying the initial magnetic field strength , the angular velocity and the stiffness of the polytropic eos by our grmhd and nmhd codes .",
    "our main results and some discussions are as the following .",
    "\\(1 ) after a short while ( @xmath540ms ) from the time of core bounce , high velocity ( @xmath541 cm @xmath453 ) bipolar outflow is driven from surface of the proto - neutronstar ( @xmath542 km ) and moves through along the rotational axis .",
    "the bipolar outflow does not appear in the non - magnetized and the initially weak magnetized models which indicate the outflow is magnetically driven outflow .",
    "the energy source of this outflow is the extracted angular momentum of the central proto - neutronstar which is transfered by the magnetic torque .",
    "the driving mechanisms are first by the magneto spring effect and then we consider the magneto centrifugally supported outflow .",
    "\\(2 ) in our self gravitating system , the non - axisymmetry develops immediately after the core bounce with the linear amplification at first and soon reaches the non - linear phase .",
    "the dominant non - axisymmetric mode is the m=1 mode during the non - linear phase and the one - armed spiral structure is also can be seen . since our initial rotational velocity ( @xmath543 rad / s ) satisfies the low-@xmath1 instability criterion ( @xmath544% ) after core bounce , we consider that these non - axisymmetric , spiral mode is originated from the low-@xmath1 instability . however , these non - axisymmetric motions are confined in the vicinity of the center and , in general terms , the global structure of bipolar outflow is qualitatively the same as those reported in previous 2d axisymmetric mhd works in the way that the equatorial inflow and the bipolar outflow along the rotational axis .",
    "\\(3 ) in weakly magnetized model in which the initial central , poloidal magnetic field is @xmath450 g , the convective over turn highly deforms the magnetic field configuration .",
    "however , with our resolution of @xmath545 m and limited computational time ( @xmath493ms after core bounce ) , we did not find the exponential growth of the magnetic field which can be seen if the magneto - rotational instability works .",
    "if we employ 10 times higher resolution or 10 times stronger initial magnetic field , we possibly capture the mri marginally .",
    "time scale of the mri is @xmath546(1 ) ms inside @xmath547 km which is comparable to the dynamical time scale and is sufficiently short to follow by the numerical simulation . even if the mri operates in a weakly magnetized model , whether the mri amplifies the magnetic field strongly enough to affect the explosion dynamics or not and whether the amplified magnetic field contributes to launch the outflow are big issues .",
    "especially , since the the amplified magnetic field through the mri would be less directional ( i.e. , the magnetic field is not amplified intensively along the rotational axis as seen in fig.[pic : f10f13 ] & [ pic : f21f22 ] ) , we have to examine whether the amplified magnetic field affect the mangeto - rotational explosion scenario .",
    "\\(4 ) by comparing grmhd and nmhd models , we found that the gravitational effect works a little bit stronger in grmhd models which can be seen in the increase of the central density as @xmath439% .",
    "however , the global dynamical evolutions are similar such as the time of core bounce and formation of the bipolar outflow .",
    "therefore we consider that the newtonian approximation for the low mass range ( @xmath548 ) is acceptable at least for several ten ms after core bounce . in this study ,",
    "our progenitor is a @xmath0 star which is small among the mass range of ccsne progenitors and thus , if we adopt much larger mass such as @xmath549 , the general relativistic effects become stronger and the qualitative differences may be appeared even in a similar time scale as those used in this report . such high mass range calculations are now in progress and will be reported in near future .    to confirm the validation of numerical results",
    ", we have to connect them to the observations .",
    "one important observed object is the gravitational wave .",
    "since we can not observe directly in the vicinity of the center of ccsne by the electro - magetic wave , the gravitational wave is one of the limited ways with which we can observe directly . in this report , though we do not evaluate the gravitational wave forms , the non - axisymmetric motion and the bipolar configuration appear .",
    "these motions alter the gravitational wave forms as reported by @xcite and we will examine the effects of , e.g. , the progenitor mass or the non - axisymmetric motions or the magnetic field in the context of full general relativity",
    ". this will be our future work .",
    "another object to confirm is the ejected elements accompanied with the explosions .",
    "ccsne eject abundant heavy elements which are synthesized during the progenitor s main sequence age to their final fate and also during the explosion via , such as , @xmath510-process nucleosynthesis @xcite .",
    "however , the ejected chemical compositions and abundances depend on the detailed properties of the explosion dynamics and we can still not explain the observed chemical abundances , one reason is due to the lack of comprehension about the explosion dynamics . by comparing our numerical results with the observations , we can feed back the observational studies to our numerical models and input physics .",
    "numerical computations were carried out on cray xt4 at center for computational astrophysics , cfca , of national astronomical observatory of japan .",
    "this work was partly supported by grants - in - aid for jsps fellows and for the scientific research from the ministry of education , science and culture of japan ( 20105004 ) .",
    "we are grateful to an anonymous referee for his / her valuable and constructive comments .",
    "acheson , d. j. , 1979 , solar physics , 62 , 23 akiyama , s. , wheeler , j. c. , meier , d. l. , & lichtenstadt , i. , 2003 , , 584 , 954 alcubierre , m. & br@xmath550gmann , b. , 2001 , , 63 , 104006 ant@xmath551n , l. , zanotti , o. , miralles , j. a. , mart@xmath552 , j. m. , ib@xmath553ez , j. m. , font , j. a. , & pons , j. a. , 2006 , , 637 , 296 arnowitt , r. , deser , s. , & misner , c. w. , 1962 , `` gravitation : an introduction to current research '' , louis witten ed .",
    "( wiley 1962 ) , chapter 7 , pp 227265 balbus , s. a. , & hawley , j. f. , 1991 , , 376 , 214 balsara , d. s. , & spicer , d. , s. , 1999 , journal of computational physics , 149 , 270 balsara , d. , 2001 , journal of computational physics , 174 , 614 baumgarte , t. w. , & shapiro , s. l. , 1999 , , 59 , 024007 berger , m. j. & colella , p. , 1989",
    ", journal of computational physics , 82 , 64 blondin , j. m. , mezzacappa , a. , & demario , c. , 2003 , , 584 , 971 brio , m. , & wu , c. c. , 1988 , j. comput .",
    ", 75 , 400 burrows , a. , dessart , l. , livne , e. , ott , c. d. & murphy , j. , 2007 , , 664 , 416 cerd@xmath554-dur@xmath554n , p. , font , j. a. , dimmelmeier , h. , 2007 , , 474 , 169 cerd@xmath554-dur@xmath554n , p. , font , j. a. , ant@xmath551n , l. , & m@xmath555ller , e. , 2008 , , 492 , 937 de villiers , j. & hawley , j. f. , 2003 , , 589 , 458 duez , m. d. , marronetti , p. , & shapiro , s. l. , 2003 , , 67 , 024004 duncan , r. c. , & thompson , c. , 1992 , , 392 , l9 etienne , z. b. , faber , j. a. , liu , y. t. , shapiro , s. l. , taniguchi , k. & baumgarte , t. w. , 2008 , , 77 , 084002 fujimoto , s. , hashimoto , m. , kotake , k. , & yamada , s. , 2007 , , 656 , 382 giacomazzo , b. , & rezzolla , l. , 2006 , j. fluid mech .",
    "562 , 223 hanawa , t. , mikami , h. , & matsumoto , t. , 2008 , journal of computational physics , 227 , 7952 harten , a. , lax , p. & van leer , b. , 1983 , on upstream differencing and godunov type methods for hyperbolic conservation laws .",
    "siam review .",
    "25(1 ) , pp 35 - 61 hawley , j. f. , smarr , l. l. & wilson , j. r. , 1984 , , 277 , 296 heger , a. , woosley , s. e. & spruit , h. c. , 2005 , , 626 , 350 hilbert , d. , 1891 , mathematische annalen , 38 , 459 hirschi , r. , meyner , g. & maeder , a. , 2004 , , 425 , 649 imamura , j , n. , pickett , b. k. , & durisen , r. h. , 2003 , , 587 , 341 keil , w. , janka , h .- t .",
    ", & m@xmath550ller , e. , 1996 , , 473 , l111 kiuchi , k. , shibata , m. , & yoshida , s. , 2008 , , 78 , 024029 kotake , k. , sawai , h. , yamada , s. , & sato , k. , 2004 , , 608 , 391 komissarov , s. s. , 1999 , , 303 , 343 kuroda , t. , wanajo , s. , & nomoto , k. , 2008 , , 672 , 1068 maeda , k. , et al .",
    "2008 , science , 319 , 1220 matsumoto , t. , 2007 , publ .",
    "japan . , 59 , 905 mikami , h. , sato , y. , matsumoto , t. , & hanawa , t. , 2008 , , 683 , 357 nakamura , t. , oohara , k. & kojima , y. , 1987 , progress of theoretical physics supplement , 90 , 1 obergaulinger , m. , aloy , m.a . ,",
    "dimmelmeier , h. & m@xmath550ller , e. , 2006 , , 457 , 209 obergaulinger , m. , cerd@xmath556-dur@xmath556n , p. , m@xmath550ller , e. , & aloy , m.a . , 2009 , , 498 , 241 ott , c. d. , ou , s. , tohline , j. e. , & burrows , a. , 2005 , , 625 , l119 ott , c. d. , dimmelmeier , h. , marek , a. , janka , h .-",
    "t . , hawke , i. , zink , b. & schnetter , e. , 2007 , , 98 , 261101 ott , c. d. , 2009 , classical and quantum gravity , 26 , 204015 powell , k. g. , roe , p. l. , linde , t. j. , gombosi , t. i. , & de zeeuw , d. l. , 1999 , journal of computational physics , 154 , 284 press , w.h . , flannery , b. p. , teukolsky , s. a. & vetterling , w. t. , 1992 , numerical recipes in fortran : the art of scientific computing , 2nd ed .",
    "cambridge , england : cambridge university press , pp740 - 744 rampp , m. , m@xmath550ller , e. , & ruffert , m. , 1998 , , 332 , 969 ryu , d. , jones , t. w. , & frank , a. , 1995 , , 452 , 785 sawai , h. , kotake , k. , & yamada , s. , 2005 , , 631 , 446 scheidegger , s. , fischer , t. , whitehouse , s. c. , & liebend@xmath557rfer , m. , 2008 , , 490 , 231 scheidegger , s. , k@xmath558ppeli , r. , whitehouse , s. c. , fischer , t. , & liebend@xmath557rfer , m. , 2009 , , 514 , a51 schnetter , e. , hawley , s. h. & hawke , i. , 2004 , classical and quantum gravity , 21 , 1465 shibata , m. , & nakamura , t. , 1995 , , 52 , 5428 shibata , m. , 1997 , , 55 , 2002 shibata , m. , 1999 , progress of theoretical physics , 101 , 1199 shibata , m. , & ury@xmath559 , k. , 2002 , progress of theoretical physics , 107 , 265 shibata , m. , karino , s. , & eriguchi , y. , 2003 , , 343 , 619 shibata , m. , 2003 , , 595 , 992 shibata , m. , & sekiguchi , y. , 2005 , , 72 , 044014 shibata , m. , liu , y. t. , shapiro , s. l. , & stephens , b. c. , 2006 , , 74 , 104026 stone , j.m .",
    ", & norman , m.l . , 1992 , , 80 , 753 takahara , m. , & sato , k. , 1998 , , 335 , 301 takiwaki , t. , kotake , k. , & sato , k. , 2009 , , 691 , 1360 tanaka , m. , et al . , 2009 , , 692 , 1131 tanaka , m. , kawabata , k. s. , maeda , k. , iye , m. , hattori , t. , pian , e. , nomoto , k. , mazzali , p. a. , & tominaga , n. , 2009 , , 699 , 1119 teukolsky , s. a. , 1982 , , 26 , 745 thompson , c. , & duncan , r. c. , 1993 , , 408 , 194 thompson , t. a. , quataert , e. & burrows , a. , 2005 , , 620 , 861 toro , e.f . 1999 ,",
    "@xmath228 , a library of source codes for teaching , research and applications .",
    "numeritek ltd .",
    ", www.numeritek.com truelove , j. k. , klein , r. i. , mckee , c. f. , holliman ii , j. h. , howell , l. h. , greenough , j. a. & woods , d. t. , 1998 , , 495 , 821 umeda , h. , & nomoto , k. , 2008 , , 673 , 1014 van der vorst , h. , 1992 , siam journal on scientific computing , 13 , 631 van leer , b. , 1977 , journal of computational physics , 23 , 263 wanajo , s. , itoh , n. , ishimaru , y. , nozawa , s. , & beers , t. c. , 2002 , , 577 , 853 watts , a. l. , andersson , n. , & jones , d. i. , 2005 , , 618 , l37 wheeler , j. c. , meier , d. l. , & wilson , j. r. , 2002 , , 568 , 807 yo , h .- j . , baumgarte , t. w. , & shapiro , s. l. , 2002 , , 66 , 084026 yoon , s .- c . , & langer , n. , 2005 , , 443 , 643 zlochower , y. , baker , j. g. , campanelli , m. & lousto , c. o. , 2005 , , 72 , 024021"
  ],
  "abstract_text": [
    "<S> we introduce our newly developed two different , three dimensional magneto hydrodynamical codes in detail . </S>",
    "<S> one of our codes is written in the newtonian limit ( nmhd ) and the other is in the fully general relativistic code ( grmhd ) . </S>",
    "<S> both codes employ adaptive mesh refinement and , in grmhd , the metric is evolved with the `` baumgarte - shapiro - shibata - nakamura '' formalism known as the most stable method at present . </S>",
    "<S> we did several test problems and as for the first practical test , we calculated gravitational collapse of a @xmath0 star . </S>",
    "<S> main features found from our calculations are ; ( 1 ) high velocity bipolar outflow is driven from the proto - neutronstar and moves through along the rotational axis in strongly magnetized models ; ( 2 ) a one - armed spiral structure appears which is originated from the low-@xmath1 instability ; ( 3 ) by comparing grmhd and nmhd models , the maximum density increases about @xmath2 in grmhd models due to the stronger gravitational effect . </S>",
    "<S> these features agree very well with previous studies and our codes are thus reliable to numerical simulation of gravitational collapse of massive stars . </S>"
  ]
}