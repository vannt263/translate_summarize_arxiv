{
  "article_text": [
    "with continuous urbanization of the global population , researchers are getting more and more aware that it is important to have a better understanding of crowd behavior under certain circumstances .",
    "experts from different fields , including sociologists , psychologists , ecologists , physicists , mathematicians and computer scientists use their different perspectives to model and analyze the crowd .",
    "one typical and important application of the crowd behavior study is the evacuation problem in emergency situations .",
    "although the human behavior can be very complicated in these situations , researchers have made lots of effort to model , analyze and simulate the crowd with different approaches for the purpose of minimizing the total societal loss .    from the pure social psychology point of view , there are models such as the theory of planned behavior form i. ajzen @xcite .",
    "sime linked the psychology part and the engineering part of the crowd behavior problem in @xcite . from the engineering aspect ,",
    "one commonly used macroscopic approach is to consider the whole crowd as one entity that is described by a density function and use tools such as fluid mechanics and partial differential equations to conduct analysis .",
    "this continuum setting of the crowd has been used , e.g. , in @xcite and @xcite .",
    "the disadvantage of this type of approach relies on the fact that a density approximation of the human crowd is not adequate when the density is low . on the other hand ,",
    "low computational cost is obviously the advantage of the approach , especially when the scale of the crowd is large enough .",
    "another method for crowd analysis is by using the tool of multi - agent systems theory that has rapidly developed in the past decades .",
    "compared to the continuum setting , multi - agent system analysis can be seen as a microscopic model that focuses on individual behaviors .",
    "part of the idea came from animal flocking observation and modeling such as reynolds model in @xcite in 1987 .",
    "this kind of approach was used , e.g. , in @xcite , @xcite .",
    "one of the most widely used models , the social force model in @xcite , also uses this setting . with the theory development in multi - agent consensus problems ,",
    "researchers do strict analysis for linear multi - agent systems , e.g. , in @xcite",
    ". however , many models for human crowd are highly nonlinear , which makes the analysis much harder due to the lack of theoretical support for nonlinear systems .",
    "the computation cost is also a big issue for numerical experiments . nevertheless , the advantage is the accuracy of individual states if compared to macroscopic approaches .    among the multi - agent crowd models ,",
    "there is one type of model called leader - follower model that divides the crowd into two groups based on their roles .",
    "these models are very useful for example in the evacuation problem , where the rescue workers act as leaders and the general public can be considered as followers .",
    "such models can be found for example in @xcite , @xcite and @xcite . a central issue for leader - follower models is controllability . in @xcite",
    ", the controllability of linear leader - follower models is discussed in detail .",
    "unfortunately , the system becomes uncontrollable in most cases of realistic linear models . in @xcite ,",
    "an optimal control approach is used for control design even though the system is not controllable for the evacuation problem . in leader - follower",
    "based models , the formation of the followers is in general very hard to control by only the leaders , since the system is often uncontrollable .",
    "unfortunately , the possibility of shaping the crowd is seldom discussed in the literature since the shape is less restrictive than the formation and maybe more elaborate to control . in this paper",
    ", we will study the moments of the crowd , which have a strong connection to the shape as showed in @xcite and @xcite . by using dynamic programming techniques",
    ", we will attack the question of shaping the crowd .    in the method introduced later in this article",
    ", we will design a controller so that the shape of the crowd will track approximately some desired shape during the process .",
    "although the asymptotic behavior of the crowd is important , the transient phase is even more critical for crowd control problems .",
    "lyapunov stability analysis does not cover the transient behavior of the system in a straightforward manner , thus is not used in the paper .",
    "we instead introduce a new control design approach by using optimal control theory .",
    "moreover , the leaders will need only the moments information together with their own states to calculate their movement as time evolves even though the optimal control problem has all the followers positions and velocities as its state variables .",
    "this make the method introduced in the paper more practical since individual states are in general very hard to measure .",
    "the numerical method introduced is shown to be efficient enough for on - line implementation as well .",
    "the outline of this paper is as follows : in section ii , the basic leader - follower model is stated and the moments of the crowd are defined .",
    "there is a short discussion about the moments tracking problem in general and the motivation why the optimal control approach is used in this paper .",
    "the optimal control problem is introduced and approximately solved in section iii by using model predictive control tools . in section iv",
    ", some improvements of the method are made to handle numerical issues while several detailed experiments are carried out to test the capability and robustness of the method .",
    "a short conclusion can be found in section v together with a brief outline for future work .",
    "we will study the behavior of two types of agents in a two dimensional space .",
    "the first type of agents are called _ followers_.",
    "we assume that there are @xmath0 followers in total , and their motion follows some simple rules that mostly depend on the relative positions and velocities among them and on those to the other type of the agents - the _ leaders_. the @xmath1 leaders , on the other hand , have better knowledge of the whole environment and can plan their motion accordingly . based on the situation of the whole crowd , the leaders should behave in an optimal way to guide the followers to reach certain goals .",
    "the position of follower @xmath2 is denoted by a vector @xmath3 , and its velocity denoted by @xmath4 .",
    "the position of leader @xmath5 is denoted by @xmath6 , and its velocity by @xmath7 .",
    "suppose that without the leaders , the influence from follower @xmath8 to follower @xmath2 is modeled as @xmath9 . by assuming unit mass for each follower , we can write @xmath10 where @xmath11 is a coefficient to model the damping effect such as resistance or physical limit of the agent .",
    "when follower @xmath2 senses any of the leaders , the influence by the leader is added to the model : @xmath12 the functions @xmath13 and @xmath14 will be defined or described later . note that here we sum up all the terms with the @xmath1 leaders , meaning that the leader - follower interaction is state - based .",
    "there is no predesigned network .",
    "if @xmath14 has no zeros in its domain , then the followers can always sense all the leaders and be influenced more or less by all of them .    for the leader @xmath5 , we have @xmath15 so it has the same damping coefficient as the followers and @xmath16 is the input to be designed in order to fulfill certain tasks .",
    "we denote @xmath17    if there is a cost function defined over time and a terminal cost to be minimized , then we can formulate an optimal control problem : @xmath18 for @xmath19 , and @xmath20 , where the set @xmath21 is the feasible that will be specified later . the solution to this problem",
    "@xmath22will give a proper control input for the leaders .      in order to shape the crowd ,",
    "we need at least some statistic properties of it . in this article",
    ", we make use of moments of the agents position .",
    "there are two ways to define moments :      the _ ( raw ) moment _ of _ order _ @xmath8 is defined by @xmath23 where @xmath24 and @xmath25 are the @xmath26 , @xmath27 coordinate for @xmath28@xmath29 with @xmath30 .",
    "the _ centralized moment _ is defined by @xmath31 and @xmath32    it is not hard to show that one can calculate all the centralized moments by knowing all the raw moments and vise versa .",
    "if not particularly stated , we will only use the raw moments in the rest of the paper .",
    "the moments have a strong relationship with the shape of the crowd .",
    "if the shape and the distribution in the shape is known , one can approximate the moments by @xmath33 where @xmath34 is the shape , and @xmath35 is the density function of the distribution . on the other hand ,",
    "if all the moments @xmath36 with @xmath37 are given , then one can approximate the shape , assuming it is convex and a uniform distribution , by a @xmath38-polygon by using a modified method similar to the one introduced in @xcite .",
    "it is noticeable that the scale of the leader - follower model : @xmath39 for @xmath19 , and @xmath20 becomes very large when the number of followers increases .",
    "hence , individual control will be difficult even if the whole system is controllable , which is not always the case .",
    "this gives a motivation to look into the statistical properties of the crowd instead .",
    "because of the strong connection between the moments and the shape , we can setup a moments tracking problem if we want to do shape tracking .",
    "namely , from a desired shape  signal \" and a desired density distribution , we can calculate the corresponding desired moments .",
    "if moments of the crowd could track the desired moments , then the crowd should more or less follow the desired shape .",
    "the more moments we track , the better the performance should be .",
    "theoretically , if we can derive the evolution of the moments @xmath36 with @xmath40 and their time derivatives by functions only using @xmath36 , @xmath41 and @xmath42 , then we will obtain a , probably nonlinear , system with @xmath36 and @xmath41 and @xmath43 as its states @xmath44 as its control . furthermore , if this system is controllable , them for any continuous moments signal , we can get a minimum energy feedback control to track those moments .",
    "however , it is impossible in general to write down this type of system without using any information from @xmath45 and @xmath46 defined previously if no approximation is made . even if for some special @xmath13 and @xmath14 functions , one can write down the system of moments , it is inaccessible for almost all cases that we have examined .",
    "this is still true even if one simplifies the leader - follower dynamics into a single integrator system .",
    "the analysis of some specific models are made in @xcite and is omitted here due to the space limitation .",
    "another way to deal with the tracking problem of an uncontrollable system is by setting a cost function for the system and using optimal control techniques to solve it .",
    "a very standard cost function is the quadratic errors between the real moments and the desired moments signals . given a sequence of nonnegative scalars @xmath47 with @xmath40 , we can setup the following optimal control problem : @xmath48 where @xmath49 is the given signal for @xmath50 to track .",
    "the analytic solution is possible to find only if @xmath13 and @xmath14 are simple functions such as linear functions .",
    "one can use pontryagin s minimum principle ( pmp ) to solve such type of problem similar to the method used in @xcite .",
    "however , these two functions are usually nonlinear in practical models , which implies that pmp is to hard to solve . for the dynamic programming approach ,",
    "if we can find a cost to go function @xmath51 that satisfies the hamilton - jacobi - bellman equation , then the optimal control can be calculated by partial derivatives of @xmath51 .",
    "the hjb equation of ( [ ocp221 ] ) can be written as : @xmath52 with the boundary condition @xmath53 the minimum of the right - hand side in equation ( [ hjb1 ] ) is reached when @xmath54 where @xmath55 is the unit vector of @xmath56 . if we plug this back to ( [ hjb1 ] ) , we get @xmath57    unfortunately , this partial differential equation is also very difficult to solve since the number of variables is proportional to the number of followers , which means the complex of solving the pde becomes very high .",
    "meanwhile , even if the hjb equation is sovable , one needs all the followers states to calculate the optimal control , which is very difficult to implement in practice .",
    "hence we will introduce a suboptimal control by using moments information as feedback while the complexity of the algorithm is low enough .",
    "in this section , we will study a special problem , which gives a reasonable model for crowd behavior .",
    "let us make the following assumption for @xmath14 :    the function @xmath14 is composed of two parts , a position consensus part and a velocity alignment part .",
    "there are two functions that give different weight to these two parts which only depend on the positions of the leader and the follower , i.e. , @xmath58 where @xmath59 and @xmath60 are real valued functions .",
    "ideally , both @xmath59 and @xmath60 should be functions of the distance @xmath61 to make the model reasonable in practice .",
    "moreover , @xmath59 should be relatively large when @xmath62 is large while @xmath60 should dominate when @xmath62 is close to zero .",
    "this is due to the fact that catching up the leader is more important when the distance is large while moving in the same direction makes more sense when the distance is already short enough .    with these assumptions we can rewrite the hjb equation ( [ hjb2 ] ) as @xmath63 where the notations @xmath64 and @xmath65 are introduced for simplicity .      in order to avoid using all the followers states @xmath45 and @xmath46 , we want to derive @xmath51 as a function of @xmath36 with @xmath40 , @xmath66 , @xmath67 , @xmath68 and @xmath69 only , which means that the followers positions only appear in the moments and their velocities",
    "only appear in the time derivative of the first order moments . in this section",
    ", we will show that this can be achieved with an approximated hjb equation .",
    "the hamilton - jacobi - bellman equation ( [ hjb3 ] ) can be approximated in such a way so that the cost - to - go function @xmath51 has @xmath70 with @xmath40 , @xmath66 , @xmath67 , @xmath68 and @xmath69 as its variables .",
    "assuming that there is a function @xmath71 that satisfies ( [ hjb3 ] ) , then we have the following equations because of the chain rule : @xmath72 @xmath73 then we can write the hjb equation for @xmath74 as @xmath75    unfortunately , there are still terms on the right - hand side of the equation that contain @xmath45 and @xmath46 , which implies that the assumption does not hold in general .",
    "we need to approximate those terms in order to get rid of @xmath45 and @xmath46 . in order to do the approximation",
    ", we need to make some further assumptions :    * @xmath76 , meaning that the follower - follower interactions are symmetric . as a result",
    ", we get @xmath77 . *",
    "the terms of the form @xmath78 can be approximated by @xmath79 for any scalar function @xmath80 , where @xmath81 .",
    "this leads to the following approximation @xmath82 and @xmath83 if we regard @xmath45 and @xmath46 as random variables , then this assumption is equivalent to saying that @xmath45 and @xmath46 are independent . *",
    "the functions @xmath84 and @xmath85 can be approximated by polynomials of @xmath86 with degree less than @xmath87 for a given @xmath88 , i.e. , @xmath89 this approximation can be usually achieved by taylor expansion around certain points if the function @xmath59 and @xmath60 are  good \" enough ( smooth and not very steep ) .",
    "once we can use polynomials to approximate @xmath59 and @xmath60 , we will have @xmath90 and similarly we have + @xmath91    with the above assumptions the hjb equation ( [ hjb4 ] ) can be finally written as : @xmath92 with the boundary condition @xmath93    if there are upper bounds for the errors we made during the approximations and if the original hjb equation ( [ hjb3 ] ) is stable backward in time , then the solution @xmath94 to ( [ hjb5 ] ) is close to the solution to ( [ hjb3 ] ) .      even though we can approximate the hjb equation so that it has all the moments and leaders states as variables , solving this type of pde numerically is still difficult .",
    "there is no efficient method for solving general pdes with more than four variables .",
    "at the same time , the approximation of the hjb equation performs poorly if the time horizon is big since the errors grow larger in this case .",
    "we use model predictive control as a remedy . in particular , we optimize over a relatively short time period and apply the derived optimal control for only a few steps and repeat the procedure . at time @xmath95 and for a certain integer @xmath96 , we optimize over @xmath97 time length in the future and apply the obtained optimal control for @xmath98 .",
    "then the sub - problem becomes : @xmath99 note that we have a terminal cost here and the cost function @xmath100 may also be different form the original problem .",
    "there is no universal way to model the new cost functions @xmath101 and @xmath100 . since we still want to avoid using individual state information for the followers , we should choose @xmath101 and @xmath100 to be functions of the moments only . here ,",
    "since the goal is still moments tracking , we keep using the old cost function @xmath102 during the process , which equals to @xmath103 . the terminal cost should be used to approximate the tail optimal cost of the states , which theoretically should be the solution of the hjb equation at time @xmath104 . however ,",
    "this solution is unavailable beforehand . here",
    "we add the final errors for the derivative of the first order moments , i.e. , @xmath105 , in addition to all the moments errors as an approximation of the tail cost .",
    "the corresponding approximated hjb equation of problem ( [ mpc1 ] ) will be @xmath106 with the boundary condition : @xmath107    the complexity of numerically solving the partial differential equation ( [ hjbmpc ] ) grows exponentially with @xmath108 , which means we can not handle a long period prediction . on the other hand",
    ", the whole mpc approach may lead to an unstable closed - loop system if @xmath108 is too small .",
    "there is a tradeoff between the numerical complexity and the stability of the approach , which will be discussed and examined with a numerical experiment in the next section .",
    "we will implement the optimal control approach on a specific model to show the capability and robustness of it .",
    "let us use the following settings : @xmath109 which means there are 100 followers and 4 leaders .",
    "the moments we want to track is up to the fifth orders , i.e. , @xmath36 with @xmath110 because we will deal with 4-polygon now .",
    "the reference signal for the moments are calculated from integrating @xmath111 over a moving and shrinking square when assuming a uniform distribution .",
    "namely , we want the followers uniformly spread inside a moving square while following the leaders .",
    "the center of the square should initially be located at the origin and slowly move to a point called  exit \" at the position of @xmath112 . in this case , there is a potential numerical problem of the approach in that for high order moments , the scale of their value becomes quite big .",
    "for example , the 5-order moment @xmath113 may become @xmath114 , which is much bigger than @xmath115 when the followers reach the exit .",
    "therefore , we change to a new coordinate system in each mpc iteration as below .",
    "when we want to solve ( [ mpc1 ] ) in each mpc iteration , we change the coordinates in order to make the current center - of - mass of the follower crowd , @xmath116 to be the new origin . by doing this",
    ", the measured moments then become the centralized moments we defined in ( [ moments2.2 ] ) .",
    "the reference signal needs to be updated as well and there are two ways doing that :    integrate the functions @xmath111 over the original desired shape in the new coordinate system .",
    "some extra calculations are needed in each iteration step .",
    "track the original first order moments @xmath117 and @xmath118 in the new coordinate system while the other ( centralized ) moments track signals generated by integrating over a shape centered on the origin .",
    "since those reference signals can be calculated off - line , this approach will speed up the calculation .",
    "however , the objective is changed from  the crowd should follow ` this ' shape trajectory \" to  the center of the crowd should follow ` this ' path while the whole crowd should form ` this ' shape \" .",
    "the second approach alters the objective a little while not changing the ultimate goal of shape tracking , and is used in the simulation to simplify the computation .",
    "we use the following functions for the model : @xmath119 @xmath120 @xmath121 @xmath122 where @xmath123 and @xmath124 can be tuned for the test purpose .",
    "note that the moments we write here should already be transformed accordingly as we mentioned above .    we still need to do polynomial approximation of the functions @xmath59 and @xmath60 by using taylor expansions .",
    "the expansion should be taken around the center - of - mass of the follower crowd , which is now the origin in the new coordinate system , and the degree of the polynomial should be @xmath125",
    ". the expansion will look like : @xmath126 where @xmath127 , @xmath128 , @xmath129 , and the higher order partial derivatives are denoted in the same pattern , for @xmath130 . note that both the variables @xmath45 , @xmath68 and the functions @xmath59 , @xmath60 should be already transformed into the new coordinate system here .",
    "once we have all the information needed , we should solve ( [ hjbmpc ] ) with the boundary condition ( [ boundaryhjbmpc ] ) .",
    "we use the backward explicit finite difference method to solve the pde by approximating the partial derivatives as : @xmath131 and @xmath132 where @xmath133 can be @xmath36 , @xmath66 , @xmath67 , @xmath134 , or @xmath135 .",
    "then we can solve for the function value of @xmath94 at time @xmath136 .    with the setting we made",
    ", there are 38 non - time variables for @xmath94 and each partial derivative needs function values at two points in the later time to approximate , which results to a complexity of @xmath137 that grows exponentially with @xmath108 as mentioned above .",
    "fortunately , it is still fast to solve with @xmath138 .",
    "the simulations we make below assume @xmath138 and @xmath139 .      in this simulation ,",
    "the 100 followers are initially randomly distributed in the area of @xmath140\\times[-50,50]$ ] while the 4 leaders start at @xmath141 .",
    "the desired shape is a shrinking square first moving from the origin to the point @xmath142 , and then to the point @xmath112 where the exit is .",
    "when the square reaches the exit , it will stay there with the size @xmath143 for a while .",
    "we want the crowd to be uniformly spread in the desired shape .",
    "the coefficients in the cost functions are set to be @xmath144where @xmath30 .",
    "the total length of the simulation is 120s .",
    "figure [ sim1 ] gives four snapshots of the simulation and figure [ sim1e ] gives the weighted tracking errors , where @xmath145 , up to the fourth order .",
    "the oscillation of the tracking error is expected since it is a double integrator model and the prediction horizon @xmath97 is short .     up to the fourth order.,width=268 ]      in this experiment , we have the same setting of the followers and the leaders but add some obstacles in the environment as a disturbance to test the robustness of the method .",
    "the leaders will not take the extra disturbance from the obstacles into account when they calculate the optimal control , while both followers and leaders will react to the obstacles in their dynamics with an additional obstacle avoidance term : @xmath146 where @xmath147 models the obstacle avoidance force for the obstacle @xmath8 . in this simulation",
    ", we set two round obstacles and model the forces as @xmath148where @xmath149 is the center of the obstacle and @xmath150 is its radius , for @xmath151 .",
    "we choose @xmath152    figure [ sim2 ] shows that the method is still able to give a correct control signal when the followers and the leaders are passing by the obstacle .      in this experiment , we use almost the same setting as that in the first simulation except that we increase the number of leaders to 8 .",
    "the increase of the amount of leaders does decrease the errors slightly for all the orders .",
    "however , the performance improvement in terms of shape is hardly noticeable . in figure",
    "[ sim3 ] , the followers form a circle in the end instead of the desired square , which could be considered to be worse than the shape generated by 4 leaders in figure [ sim1 ] although the errors in figure [ sim3e ] turn to be smaller than those in figure [ sim1e ] .",
    "since the moments of the crowd have a strong connection to its shape , we use moments to control the shape of the crowd . an optimal moments tracking problem",
    "is introduced in the paper and solved numerically with only using moments information as feedback . in order to further reduce the computational complexity ,",
    "a model predictive control algorithm is used .",
    "three numerical experiments show that the method solves the moments tracking problem efficiently enough and can handle certain disturbance in the model .",
    "the performance of the optimal controller is acceptable even during the transient phase in the simulations .",
    "future work involves using local measurements of the moments to design a distributed leading strategy for the leaders . a better understanding of the relationship between the moments and shapes may give a more practical cost function to achieve a better performance in terms of shaping .",
    "r. olfati - saber and r.m .",
    "murray ,  flocking with obstacle avoidance : cooperation with limited communication in mobile networks \" , _ proceedings of the 42nd ieee conference on decision and control _ , vol . 2 , 2003 , pp .",
    "2022 - 2028 .",
    "a. jadbabaie , j. lin , and a.s .",
    "morse ,  coordination of groups of mobile autonomous agents using nearest neighbor rules \" , _ automatic control , ieee transactions on _ , vol.48 , no . 6 , pp .",
    "988 - 1001 , june 2003 .",
    "t. eren , w. whiteley , b. d. anderson , a. s. morse , and p. n. belhumeur ,  information structures to secure control of rigid formations with leader - follower architecture \" , _ american control conference , 2005 .",
    "proceedings of the 2005 _ , pp .",
    "2966 - 2971 , 2005 ."
  ],
  "abstract_text": [
    "<S> in a crowd model based on leader - follower interactions , where positions of the leaders are viewed as the control input , up - to - date solutions rely on knowledge of the agents coordinates . in practice , it is more realistic to exploit knowledge of statistical properties of the group of agents , rather than their exact positions . in order to shape the crowd , </S>",
    "<S> we study thus the problem of controlling the moments instead , since it is well known that shape can be determined by moments . </S>",
    "<S> an optimal control for the moments tracking problem is obtained by solving a modified hamilton - jacobi - bellman ( hjb ) equation , which only uses the moments and leaders states as feedback . </S>",
    "<S> the optimal solution can be solved fast enough for on - line implementations . </S>"
  ]
}