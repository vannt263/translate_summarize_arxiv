{
  "article_text": [
    "galaxy - galaxy gravitational lensing is a powerful astrophysical tool for studying the distribution of matter , including dark matter , in galaxies @xcite",
    ". one promising application of lensing is to study and measure the properties of dark matter substructures in the lens galaxy @xcite . in recent years",
    ", this promise has been realised in several lens systems which are thought to contain at least one dark substructure @xcite . in these studies ,",
    "the lens was modelled as a superposition of a smooth component ( such as an elliptical power - law matter distribution ) plus a pixellized `` non - parametric '' correction term .",
    "the estimated spatial structure of the correction term provides clues about the locations of possible substructures . in a second modelling step ,",
    "the lens is assumed to be a smooth overall component plus a compact `` blob '' near any locations suggested by the correction term .",
    "this kind of inference has also been done with point - like multiple images of quasars @xcite .    in this paper",
    ", we introduce an approach for solving this same problem ( inferring the number and properties of dark substructures given an image ) in a more direct fashion , by fitting a model with an unknown number of substructures directly to the image data .",
    "however , with appropriate modifications , it may also prove useful in other galaxy - galaxy lens modelling areas .",
    "one example is time - delay cosmography , which requires realistically flexible lens models , and reliable quantification of the uncertainties @xcite .",
    "lens modelling has been a topic of much interest over the last two decades .",
    "most approaches are based on bayesian inference @xcite , maximum likelihood @xcite or variations thereof .",
    "these approaches may be categorized according to the following criteria :    1 .   whether to use a simply parameterized ( e.g. a srsic profile ) ,",
    "moderately flexible ( e.g. a mixture model , * ? ? ?",
    "* ) or free - form ( e.g. pixellated ) model for the surface brightness profile of the source ; 2 .   whether to use a simply parameterized ( e.g. singular isothermal ellipsoid [ sie ] ) or flexible model ( e.g. pixellated ) for the mass profile of the lens ; and 3 .",
    "how to compute the results ( e.g. optimization methods , markov chain monte carlo [ mcmc ] with source parameters marginalized out analytically , or mcmc with the source parameters included ) .",
    "recent sophisicated approaches investigating different prior assumptions and computational approaches include @xcite , @xcite , and @xcite .",
    "each approach involves tradeoffs between convenience and realism .",
    "simply parameterized models , such as srsic surface brightness profiles for the source , and singular isothermal ellipsoid plus external shear ( sie+@xmath0 ) models for the lens , are very convenient .",
    "they only have a few adjustable parameters , and they capture ( to `` first order '' ) relevant prior information that we have about the source and lens profiles . of course , they are clearly simplifications , and can produce misleading results if the actual profile is very different from any member of the assumed family .",
    "on the other hand , pixellated models for the source ( e.g. * ? ? ? * ) or the lens ( e.g. * ? ? ?",
    "* ) can in principle represent `` any '' source surface brightness profile or lens projected density profile .",
    "however , the prior distribution over pixel values is often chosen to be a multivariate gaussian for mathematical reasons , so that the source can be analytically marginalized out @xcite .",
    "unfortunately , a multivariate gaussian prior over pixel intensities usually corresponds to a poor model of our prior beliefs about the source .",
    "it assigns virtually zero prior probability to the hypothesis that the source actually looks like a galaxy , and very high prior probability to the hypothesis that the source looks like noise ( or blurred noise ) .",
    "these priors also assign nonzero probability to negative surface brightness or density values ; in fact , the marginal prior probability that any pixel is negative is typically 0.5 .",
    "@xcite argued that an ideal modelling approach lies somewhere between simply - parameterised and pixellated models , which is also a motivation behind the investigation of shapelets by @xcite .",
    "one way of achieving this is with mixture models .",
    "the source and the lens can be built up from a mixture of a moderate number ( from a few to a few hundred ) of simply parameterised components .",
    "for the source , this allows us to incorporate prior knowledge about the local correlations ( the surface brightness at any particular point is likely to be similar to that at a nearby point ) and the fact that most of the sky is dark @xcite .",
    "the @xcite model also allowed for multi - band data , and allowed for our expectation that the image may or may not be similar in different bands .",
    "the present paper is similar in approach to @xcite .",
    "the main differences are : i ) we use a simpler and faster set of basis functions ; ii ) we apply it to the lens as well as the source , allowing for the possibility of substructure ; and iii ) the implementation is based on a c++ template library developed by @xcite which allows for hierarchical priors and trans - dimensional mcmc to be implemented in a relatively straightforward manner .",
    "however , in the present paper we do not account for multi - band data ; this will be reserved for a future contribution .",
    "the source code for this project is available at http://www.github.com/eggplantbren/lensing2 .",
    "if we are interested in detecting and measuring the properties of possible dark substructures in a lens galaxy , a superposition of an unknown number of `` blobs '' is the most natural model . in addition , if we want to constrain the mass function of these blobs ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , we will need a hierarchical model which specifies the prior probability distribution for the masses conditional on some hyperparameters . inferring the mass function of the blobs",
    "then reduces to calculating the posterior distribution for the hyperparameters .",
    "this is related to the general principle that we should ( ideally ) construct our inference methods so that the quantities we infer directly answer our scientific questions @xcite . here",
    ", we are referring to the mass function of the substructures within a single lens galaxy . an additional level of hierarchy would be needed to answer questions about a sample of lens galaxies .",
    "we now describe the details of our model and its parameterization .",
    "the motivation for most of our modelling choices is a compromise between computational efficiency , realism , and ease of implementation .",
    "none of the choices we have made are final in any sense ; rather , this model should be considered a proof of concept .",
    "we encourage exploration of other choices .",
    "since we can compute marginal likelihoods , bayesian model comparison between our choices here and any proposed alternatives should be straightforward , if a union of our hypothesis space and another can be considered a reasonable model of prior uncertainty .",
    "the surface brightness profile of the source is assumed to be composed of a sum of a finite number of `` blobs '' , or basis functions , in order to allow some flexibility while incorporating prior information about the non - negativity of surface brightness , and the spatial correlation expected in real surface brightness profiles . for computational speed , we choose the following functional form for the surface brightness profile of a single blob centered at the origin : @xmath1 where @xmath2 , @xmath3 is the width of the blob , and @xmath4 is the total flux of the blob ( i.e. the integral of the surface brightness over the entire domain ) .",
    "these basis functions are inverted paraboloids , which are faster to evaluate than gaussians , since they do not contain an exponential function .",
    "in addition , the finite support means that each blob will evaluate to zero over a large fraction of the domain which confers an additional speed advantage .",
    "more conventional choices such as gaussians are possible , as are alternative compact basis functions , perhaps inspired by the smoothed particle hydrodynamics literature @xcite .",
    "alternative choices , such as srsic profiles , may be more realistic despite their computational cost .",
    "this is especially likely in the case of an early - type source galaxy ( e.g. * ? ? ?",
    "such modifications are possible without great effort using the rjobject library , and once implemented , the marginal likelihood can be compared across different choices for the source model .",
    "if our model contains @xmath5 such blobs , positioned at @xmath6 with widths @xmath7 and total fluxes @xmath8 , the overall surface brightness profile is : @xmath9 where @xmath10 . under these assumptions ,",
    "the source can be described in its entirety by the following parameters : @xmath11 where @xmath12 denotes the parameters for source blob @xmath13 : @xmath14 the dimensionality of the parameter space for the source depends on the minimum and maximum values of @xmath5 , which we set to 0 and 100 respectively ( more detail about priors is given in section  [ sec : priors ] ) .",
    "therefore the source is described by 1  401 parameters .",
    "the surface mass density profile of the lens is modelled as a superposition of a singular isothermal ellipsoid plus external shear ( sie+@xmath0 ) and @xmath15 circular lens `` blobs '' .",
    "the sie+@xmath0 is a simple and widely used lens model with analytically available deflection angles , and is intended to account for the bulk of the lensing effect due to the smooth spatial distribution of ( visible and dark ) matter in the lens galaxy .",
    "unfortunately , along with simplicity comes a lack of realism , and generalising the smooth lens model is an important future step .",
    "the softened power law elliptical mass density or spemd model is a popular generalization of the sie where the deflection angles can still be computed quickly using the approximations given by @xcite .",
    "ultimately , concentric mixtures of smooth components may be the most useful for realistic inference of the density profile of the halo .",
    "a common approach in the lensing community , that is similar in spirit , is a superposition of an elliptical power law , external shear , and a pixellated potential correction .",
    "however , the direct use of blobs is closer to the scientific question at hand when investigating postential dark substructures .",
    "the sie+@xmath0 has nine free parameters : the ( circularized ) einstein radius @xmath16 , axis ratio @xmath17 , central position @xmath18 , orientation angle @xmath19 , the external shear @xmath0 , and the orientation angle of the external shear , @xmath20 .",
    "the @xmath15 lens blobs are intended to model possible dark or faint substructures in the projected mass profile of the lens .",
    "a lensing blob with mass @xmath21 and width @xmath22 centered at the origin has the following surface mass density profile : @xmath23 which is the same as the surface brightness profile of a source blob .",
    "the deflection angles for a single blob are : @xmath24 where @xmath25 .",
    "these do not depend on any computationally expensive functions such as square roots or exponentials . for @xmath15",
    "such blobs the deflection angles are summed over all blobs .",
    "therefore the lens can be entirely described by the following parameters :    @xmath26    where @xmath27 denotes the parameters for lens blob @xmath13 : @xmath28 and @xmath29 describes the parameters for the sie+@xmath0 component : @xmath30    since the model is not of fixed dimension ( the number of source and lens `` blobs '' is unknown ) , we used a trans - dimensional mcmc sampler based on reversible jump mcmc @xcite .",
    "this framework has been used successfully in many astronomical inference problems ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "we implemented the mcmc using the rjobject software @xcite , a c++ library for implementing trans - dimensional mcmc with hierarchically - specified priors when the model is a `` mixture model '' or similar , as is the case here .",
    "the rjobject library uses the diffusive nested sampling algorithm ( dns ; * ? ? ?",
    "* ) for its sampling , but the trans - dimensionality is handled by the mcmc moves .",
    "therefore , the marginal likelihood we obtain is one that involves a sum over the hypothesis space for @xmath5 and @xmath31 . in other words",
    ", we do not need separate runs with different trial values of @xmath5 and @xmath31 .",
    "previous astronomical applications of rjobject include @xcite and  @xcite .",
    "proposal moves for the parameters ( positions and masses of the source and lens blobs ) , and birth / death moves to add or remove blobs to the source or lens , are handled internally by rjobject and fit into the general framework described in @xcite .",
    "the prior probability distributions for all hyperparameters , parameters , and the data , are given in table  [ tab : priors ] , and a factorization of the joint distribution is displayed in figure  [ fig : pgm ] . with these priors , we aim to express a large degree of prior uncertainty ( hence the liberal use of uniform , log - uniform , and cauchy distributions ) .",
    "however , we also specify some priors hierarchically to allow ( for example ) blobs to cluster around a typical central position , rather than implying a high probability for substructure positions being spread uniformly ( in a frequency sense ) over the sky .",
    "we also applied hierarchical priors to the substructure masses ( and source fluxes ) so that , while the typical order of magnitude of the masses is unknown , the masses themselves are likely to be roughly the same order of magnitude .",
    "the hyperparameters of these distributions can also be interpreted as straightforward answers to questions about the substructure mass function .    [ cols=\"<,<,<\",options=\"header \" , ]     we assign somewhat informative ( but heavy - tailed ) cauchy priors to the central positions of the source and the lens .",
    "one might object to the cauchy priors for the central positions ( and argue instead for gaussians ) on the basis that they do not have rotational symmetry .",
    "however , the priors we are assigning are prior only to the values of the data pixel intensities only , and not other facts about the data , such as its dimensions in arc seconds , or its rectangular shape . given these , there is no reason to insist on rotational symmetry .",
    "the cauchy priors are intended to enhance the plausibility ( relative to what a uniform prior would imply ) that the lens and source are somewhere near the centre of the image , but in a cautious way .",
    "the `` circular '' conditional prior for the blob positions has the following density : @xmath32 where @xmath33 .",
    "this results from an exponential distribution ( with expectation @xmath34 ) for the radial coordinate and a uniform distribution for the angular coordinate in plane polar coordinates .",
    "this was chosen ( as opposed to a more `` obvious '' choice such as a normal distribution ) for computational reasons : the rjobject code requires a function to transform from uniform(0 , 1 ) distributions to this distribution and back ( making use of cumulative distribution functions and their inverses ) , and the normal would have required the use of special functions for this .          the conditional prior for the data given the parameters is a product of independent gaussian distributions , one for each pixel .",
    "the mean of the gaussian is given by the `` mock '' noise - free image we would expect based on the parameters . the standard deviation of the gaussian is a combination of three terms ; the first ( denoted @xmath35 ) is a `` noise map '' which is loaded from a file , the second is an unknown constant @xmath36 which applies to the whole image , and the third is proportional to the square root of the mock image , with proportionality constant @xmath37 .",
    "this is usually called the `` sampling distribution '' , or sometimes just the `` likelihood '' . however , sampling distribution is misleading since no physical frequency distribution exists which is being sampled from .",
    "the term likelihood is also usually used to refer to the scalar function of the parameters obtained when the data are known . for a discussion of the view that this object is really a prior distribution ,",
    "see @xcite .",
    "it is common to provide a `` variance image '' to lens modelling software , which specifies the standard deviations used in the likelihood function .",
    "however , telescopes do not provide variance images .",
    "it also does not make sense to specify vague priors prior to the image pixel values but posterior to the variance image ( which usually resembles the image itself , and therefore would be highly informative ) .",
    "allowing the standard deviation of the gaussian in the likelihood to depend on the mock image brightness is a more principled way of modelling our actual inferential situation .",
    "nevertheless , we allow for an input variance image as well , which can be used for ad - hoc masking of troublesome regions ( such as unmodelled flux from other sources ) .",
    "computing the posterior distribution over the parameters of such a model requires that we can implement markov chain monte carlo ( mcmc ) over the space of possible sources and lenses . to compute the posterior distribution for the parameters ( of which there are 24464 , depending on the values of @xmath5 and @xmath31 ) , we use diffusive nested sampling @xcite , a form of nested sampling @xcite that uses the metropolis algorithm to move around the parameter space .",
    "the proposal distributions for the blob parameters ( both source and lens ) are handled by the rjobject library @xcite .",
    "this includes birth and death proposals that increase or decrease either @xmath5 , or @xmath31 , as well as proposals that move the blobs ( in their parameter space ) while keeping the number of blobs fixed .",
    "rjobject also facilitates proposals that change the hyperparameters ( either for the lens or the source ) while keeping the actual blobs in place , as well as proposals that change the hyperparameters and shift all of the relevant blobs in so they are appropriate for the new values of the hyperparameters .",
    "evaluating the likelihood function requires that we compute a `` mock '' image from the current setting of the parameters .",
    "this mock image is calculated using standard ray - tracing methods with a uniform grid of @xmath38 rays fired per image pixel .",
    "however , certain kinds of proposals do not affect the image in any way , such as those which change the noise parameters . for efficiency we do not recompute the mock image in these cases .",
    "to demonstrate the method , we generated a simulated dataset where the lens was an sie@xmath39 profile with a single additional substructure .",
    "the image is shown in figure  [ fig : image1 ] , and consists of 100 @xmath40 100 pixels .",
    "the point spread function ( psf ) was compact and was defined on a 5 @xmath40 5 grid .",
    "the data was created by firing only one ray per pixel , and the inference was also carried out under the same level of approximation . since the model assumptions are all correct for this image , the demonstration here is purely to illustrate the computational tractability of the problem , and the kind of outputs the method can produce .",
    "the sie@xmath39 parameters were , to three significant figures , @xmath41 , where the length units in the image plane are arbitrary , and rotation angles are measured in radians . the single substructure is located at @xmath42 , about halfway between the center and the upper left image .",
    "its mass is 2.50 units , using the convention where the critical density is 1 . for comparison ,",
    "the sie mass within its critical ellipse is @xmath43 units .",
    "lens close to the center of the image , indicated by the white circle , plus a single substructure close to the top left image ( indicated by a star symbol ) .",
    "the image was blurred by a psf and had some noise added . in an arbitrary system of units",
    ", this image extends from -8 to 8 in the @xmath44 and @xmath45 directions.[fig : image1 ] ]    we executed the code to generate 5,000 samples from the `` mixture of constrained priors '' distribution of dns .",
    "our thinning factor was @xmath46 , so @xmath47 mcmc iterations were actually performed , taking approximately 48 hours on a modest desktop pc .",
    "after resampling these samples to reflect the posterior distribution , we were left with 500 ( equally weighted ) posterior samples .",
    "the posterior distributions for complex models , such as the mixture models used here , are often challenging and unintuitive to summarise .",
    "one effective way to visualise the uncertainty in the inferences is to play a movie where each frame is a sample from the posterior distribution .",
    "the degree to which the frames differ from each other conveys the uncertainty remaining after taking the data into account .    for the purposes of a paper , static summaries are more convenient than movies .",
    "one useful summary is based on the concept of empirical measure .",
    "the _ empirical measure _ of the substructure positions is a function that takes the actual substructure positions @xmath48 and produces a `` density function '' over two dimensions , composed of delta functions at the positions themselves : @xmath49    intuitively , the empirical measure is a mathematical object that is like an `` infinite resolution histogram '' , in this case a two dimensional histogram , of the substructure positions .",
    "being a function of the actual substructure positions , the empirical measure is not available to us since we do not know those positions with certainty .",
    "however , we have samples from the posterior distribution for those positions , and can use these ( trivially ) to create samples from the posterior distribution for the empirical measure .",
    "we can also summarise this posterior , for example , by taking its expected value .",
    "the posterior expected value of the empirical measure is : @xmath50 where @xmath51 denotes all parameters and hyperparameters ( including the @xmath15s ) and `` @xmath52 '' is an integral and summation over the entire parameter space .",
    "since we can approximate posterior expectations using monte carlo , we can obtain the expected value of the empirical measure using : @xmath53 where @xmath54 is the number of posterior samples .",
    "the resulting function is an `` image '' with a point mass wherever a substructure occurred . for visualisation purposes the image",
    "can be blurred , or calculated at a lower resolution by replacing the dirac - delta function with a discrete version which returns a nonzero constant if a substructure appears in a pixel or zero otherwise .",
    "the masses of the smooth and substructure components of the lens are usually of interest .",
    "since the total mass of an sie lens is infinite , the question needs to be redefined , so we ask about the mass within some aperture of finite area . for an sie ,",
    "the mass ( in dimensionless units based on the critical density ) within the critical ellipse is simply @xmath55 .",
    "however , the blobs have finite total masses @xmath56 . to obtain the posterior distribution for the lens masses",
    ", one must be clear about exactly which mass they are talking about , and many definitions are possible , although some might be more meaningful or well constrained than others .",
    "in the present paper we do not address the question of exactly which quantities related to the density profile of the lens are most scientifically interesting .",
    "nevertheless , we can verify that the results of the inference do behave in understandable ways .",
    "for example , in figure  [ fig : masses1 ] , we plot the joint posterior distribution for the sie mass within its critical ellipse and the total substructure mass over the entire domain .",
    "as one would expect , there is a strong dependence between these two quantities in the posterior distribution , as mass in the sie can be traded off with mass in substructures to some extent , while the model remains ( loosely speaking ) `` consistent with the data '' .    ]",
    "the posterior distribution for @xmath31 is also clearly of interest , and is displayed in figure  [ fig : n_lens1 ] .",
    "the prior for this parameter was uniform from 0 to 10 ( inclusive ) , and the possibility @xmath57 has been ( loosely speaking ) `` ruled out '' by the image data . the true solution ( @xmath58 )",
    "has the highest probability .",
    "however , the possibilities with @xmath59 are still fairly plausible , since it s possible that a very small substructure exists , and it s also possible that two substructures near each other could mimic the effect of one . the degree to which these possibilities are plausible",
    "is related to the choice of prior for the blob amplitudes and positions .    ,",
    "the number of substructures in the lens .",
    "the prior was uniform and the true value used to generate the data was 1 .",
    "however , the data is only informative enough to suppress the probability of values above 1 slightly , since it is possible ( given this data ) that low mass substructures might exist somewhere , or that what we think is one substructure might actually be two close together , and other such possibilities .",
    "[ fig : n_lens1 ] ]    the estimated marginal likelihood of our model ( averaged over all parameters including @xmath31 and @xmath5 ) is @xmath60 \\approx -14141.4 $ ] , and the information ( kullback - leibler divergence from the prior to the posterior ) is @xmath61 nats .",
    "the information represents the degree of compression of the posterior distribution with respect to the prior , and can be interpreted quite literally as how much was learned about the parameters from the data .",
    "it is also straightforward to estimate from nested sampling @xcite .",
    "its definition is : @xmath62 \\ , d\\boldsymbol{\\theta}\\end{aligned}\\ ] ] and we can build intuition about its meaning based on some simple examples .",
    "one such example is a uniform prior over a volume @xmath63 and a posterior which is uniform over a smaller volume @xmath64 contained within @xmath63 . in this case @xmath65",
    "therefore , a value of @xmath66 nats implies the posterior distribution occupies roughly @xmath67 of the prior volume .    ]    for the sampled parameter values representing the posterior distribution , there was no structure in the residuals ( not shown ) , when normalised by the noise standard deviation in each pixel .",
    "this is unsurprising since the model assumptions are entirely correct for this dataset .",
    "to further test the algorithm , we created a `` harder '' simulated image , where the lens consisted of an sie+@xmath0 profile plus 10 additional substructures .",
    "the image is shown in figure  [ fig : image2 ] . with the easy dataset ,",
    "there was little hope of measuring the substructure mass function parameter @xmath68 since there was only a single substructure which would provide little information about @xmath68 ( only constraining its general order of magnitude ) , even if its mass were measured perfectly .",
    "( whose centre is indicated by a white circle ) and ten substructures .",
    "only five of the substructures ( star symbols ) occured within the square image boundary , but the other five still have an effect on the image .",
    "[ fig : image2 ] ]    as with the ` easy ' dataset , we generated 5,000 samples from the dns target distribution and thinned by a factor of @xmath46 , so @xmath47 mcmc iterations were actually performed , taking approximately 60 hours .",
    "the slower runtime in this case was because @xmath69 , more cpu time was spent exploring parts of the hypothesis space where @xmath31 is high .",
    "the run resulted in 557 equally - weighted posterior samples .",
    "the posterior distribution for the sie mass and the total substructure mass is given in figure  [ fig : masses2 ] .",
    "the samples can be viewed as a movie at www.youtube.com/watch?v=o3ppfksk248 .    , but for the ` harder ' simulated dataset .",
    "[ fig : masses2 ] ]    to demonstrate the claim that we can infer something about the mass function of substructures directly from the image data , we have plotted the posterior distribution for @xmath68 , the hyperparameter for the substructure masses , in figure  [ fig : mu_lens ] .",
    "the true value was 1 , and the posterior distribution indicates a fairly wide uncertainty range that is at least consistent with the true value in some sense . given that the image only contained a few substructures whose masses could be measured with any accuracy , the large uncertainty is not surprising .    , the hyperparameter which determines the prior expected value of substructure masses , given the ` harder ' simulated data .",
    "the true value ( in arbitrary units ) was 1 , which is indicated by the vertical line .",
    "[ fig : mu_lens ] ]    , but for the ` harder ' simulated dataset .",
    "the true number of substructures was 10 , which also happens to be the posterior mode .",
    "only five substructures were located within the domain of the image , but @xmath69 is probable because the spread - out positions of the substructures imply that @xmath70 is probably large .",
    "[ fig : n_lens2 ] ]    , but for the ` harder ' simulated dataset . for all of the substructures located close to the ring , the positions were well constrained .",
    "there was weak evidence for some substructures that did not in fact exist .",
    "[ fig : substructures2 ] ]    the estimated marginal likelihood of our model , for the ` harder ' simulated data , is @xmath60 \\approx -5671.9 $ ] , and the information ( kullback - leibler divergence from the prior to the posterior ) is @xmath71 nats . as with the easy dataset , the standardised residuals of the sampled models resembled noise .",
    "as a further demonstration the method , we apply it to the g - band data of the cosmic horseshoe j1004 + 4112 @xcite taken with the isaac newton telescope ( int ) .",
    "the image is shown in figure  [ fig : image3 ] .",
    "for this system , more data is available ( i and u band data , as well as more recent hubble space telescope ( hst ) imaging ) , although the g - band image is the highest signal - to - noise of the int images .",
    "the source redshift is @xmath72 , and the lens is a massive luminous red galaxy at @xmath73 .",
    "unfortunately our current implementation does nt allow for multi - band data ( unlike @xcite ) , and is quite slow when running on the larger hst image .",
    "therefore this section should be considered a further demonstration of the technique , and not a thorough study of this system .    ]",
    "we generated 5,000 samples from the dns target distribution and thinned by a factor of @xmath46 , so @xmath47 mcmc iterations were actually performed , taking approximately 40 hours .",
    "after resampling , this resulted in 718 equally weighted posterior samples .",
    "although this image is smaller than the simulated data ( @xmath74 pixels ) , we fired @xmath75 rays per pixel for greater accuracy .    the joint posterior distribution for the sie mass total substructure mass for the cosmic horseshoe is given in figure  [ fig : masses3 ] .",
    "as with the simulated data ( figure  [ fig : masses1 ] ) , we see an expected negative correlation between these two quantities . however , the points are not as smoothly distributed in this case ( we discuss this issue further in section  [ sec : convergence ] ) .",
    "an upper `` limit '' on the sie mass , with 95% posterior probability , is @xmath76 solar masses .",
    "the algorithm has also found some possibilities where the substructure mass is much greater than this . in these cases ,",
    "the substructures are far from the image  it is the environment that is being modelled .",
    "the posterior distribution for @xmath31 ( figure  [ fig : n_lens3 ] ) also shows some evidence for more than zero substructures .",
    "in particular , the prior probability for @xmath77 was 10/11 @xmath78 0.91 , whereas the posterior probability is approximately 0.997 .",
    "this corresponds to a bayes factor of about 300 in favour of @xmath77 versus the alternative @xmath79 .    , but for the cosmic horseshoe .",
    "the joint posterior distribution for the sie mass ( integrated within its critical ellipse , which is not the critical curve of the lens overall ) , and the total mass in substructures .",
    "the units are defined by the critical density , so that a mass of @xmath80 units would have an einstein radius of one arcsecond . to calculate the masses in solar masses",
    ", we assumed a flat cosmology with @xmath81 , @xmath82 , and @xmath83 km / s / mpc .",
    "[ fig : masses3 ] ]    , but for the cosmic horseshoe . the posterior distribution for the number of lens substructures in the cosmic horseshoe system .",
    "there is moderate evidence in favour of the hypothesis that @xmath84.[fig : n_lens3 ] ]    despite weak evidence for the existence of substructure , when we examine the expected value of the empirical measure of substructure positions ( figure  [ fig : substructures3 ] ) we find no consistency in their positions , unlike for the simulated data ( figure  [ fig : substructures1 ] ) .",
    "this situation is not uncommon .",
    "for example , @xcite found evidence for a large number of keplerian signals in a time series , but the number of such signals with well constrained properties was much lower .",
    "related to this , we can compute posterior probabilities for any hypothesis about the substructure masses . with 95% probability",
    "the substructure mass is less than 1.53@xmath85 solar masses and with 75% probability it is less than 5.10@xmath86 solar masses .",
    "as the einstein ring itself implies a mass of about @xmath87 solar masses , these summaries are affected by the possibility of blobs outside the main einstein ring .    as with any inference , the results presented here may be sensitive to many of the input modelling assumptions , and a slightly different ( yet still reasonable ) set of choices might yield different results .",
    "for example , if the density profile of the lens was smooth but not of the sie form , and the data were informative enough to show this , the current model would only be able to explain the data by adding substructures .",
    "hence , an alternative explanation for these results is that , rather than containing a substructure , the density profile of the lens is simply not within the sie@xmath39 family .",
    "in fact , some of the posterior samples obtained contain massive substructures outside of the image , which could be modelling higher - order effects of the environment beyond what is captured by the simple external shear model .",
    "this is one way of violating the sie@xmath39 assumption , and another is simply to have a different projected density profile .",
    "one way of further investigating this is to use a different family of smooth lens models and doing model selection based on the marginal likelihoods .",
    "another option which we defer to future work is to implement a more flexible model ( such as a mixture of concentric elliptical lenses ) .",
    "this result is consistent with that of @xcite , who found a slight preference for an elliptical power law profile over the sie ( which is a specific case of an elliptical power law ) .",
    "another potential inadequacy of our model is the assumption that the psf is known . in practice",
    ", the psf is often estimated from the image of nearby star(s ) , or from theoretical knowledge of the telescope ( especially in the case of space based imaging ) . however ,",
    "if the psf is misspecified , or in fact varies across the image , this could induce subtle effects in the imaging which our current model could only explain using substructure .    , but for the cosmic horseshoe .",
    "the positions of substructures encountered in the mcmc sampling for the cosmic horseshoe ; technically a monte carlo approximation to the posterior expected value of the empirical measure of substructure positions .",
    "unlike figure  [ fig : substructures1 ] , for the cosmic horseshoe there is little consistency in the positions of the substructures .",
    "[ fig : substructures3 ] ]    the estimated marginal likelihood of our model is @xmath60 \\approx -6948.5 $ ] , and the information ( kullback - leibler divergence from the prior to the posterior ) is @xmath88 nats .",
    "three example models ( lens and source ) sampled from the posterior are shown in figure  [ fig : sources ] .",
    "the model was able to fit the data down to the noise level .",
    "the `` effective sample size '' returned by dns , which we have described as the number of posterior samples , takes into account the fact dns s target distribution is not the posterior .",
    "however , it does not take autocorrelation into account , and thus can present an optimistic picture of the accuracy of any monte carlo approximations to posterior quantities .",
    "most standard diagnostic techniques used in mcmc can be applied here .",
    "the simplest of these is a check of reproducibility .",
    "if different runs yield substantially different results , the mcmc output should be treated with caution .",
    "for example , in figure  [ fig : masses3 ] , there is a correlation between the mass attributed to the sie component and that attributed to substructures .",
    "however , the distribution also appears somewhat `` lumpy '' or multimodal .",
    "this may not be a feature of the actual posterior distribution , but could arise due to imperfect sampling . whereas a standard metropolis sampler would move around very slowly in the hypothesis space , dns naturally spends a non - negligible fraction of the time sampling the prior .",
    "therefore , a particle exploring the parameter space can `` forget '' its good - fitting position , move somewhere completely different , and find another good - fitting model in a different location .",
    "this is a natural feature of the algorithm ( and is also present in related algorithms such as parallel tempering ) . despite this",
    ", the patchy nature of figure  [ fig : masses3 ] suggests that posterior exploration is still challenging in this problem .",
    "the results for the simulated data ( figure  [ fig : masses1 ] ) were less complex because of the definite existence of one substructure .",
    "its mass and position provide some information about the hyperparameters @xmath89 , restricting the probability that high mass substructures exist far from the image .",
    "we have developed a trans - dimensional bayesian approach motivated directly by the question of whether dark substructures exist in a lens galaxy , given image data . by making use of the diffusive nested sampling algorithm @xcite and the rjobject library @xcite",
    ", we outsource the difficulties associated with choosing metropolis proposals for a hierarchical model of non - fixed dimension .",
    "the model allows for source and lens `` blobs '' to appear as needed to explain the data .",
    "the prior for the blobs properties is specified hierarchically , to more realistically model sensible prior beliefs , and to tie the model parameters directly to questions of scientific interest such as the mass function of substructures .    as a proof of concept",
    ", we demonstrated the successful recovery of a single substructure from simulated data for which all of the model assumptions were true .",
    "we then applied the method to an image of the cosmic horseshoe system and found moderate evidence in favour of the existence of a substructure , or at the very least , a departure from a simple sie+@xmath0 lens profile .",
    "the main output of our method is a set of posterior samples , each representing a plausible scenario for the lens and the source given the data and the assumed prior information .",
    "these samples can be displayed as a movie , which is a very useful method for intuitively understanding the remaining uncertainty .",
    "any posterior summaries of interest can be produced from the samples , but the interpretation of many of these summaries is not necessarily straightforward .",
    "we have suggested that the posterior expectation of the empirical measure of substructure positions is one of the most helpful summaries .",
    "the model assumptions used in this paper are fairly simple . in future work",
    "we intend to generalize the model to multi - band data , and extend the smooth lens model beyond the overly simplistic sie+@xmath0 assumption .",
    "applications to other systems are also forthcoming , as well as variants on the model using different conditional priors for the substructure properties given the hyperparameters .",
    "it is a pleasure to thank phil marshall ( stanford ) , tommaso treu ( ucla ) , ross fadely ( nyu ) , alan heavens ( edinburgh ) , and the referee for valuable discussion .",
    "thomas lumley ( auckland ) also deserves credit for ending bjb s usage of the jet colormap .",
    "this work was funded by a marsden fast start grant from the royal society of new zealand ."
  ],
  "abstract_text": [
    "<S> we introduce a bayesian solution to the problem of inferring the density profile of strong gravitational lenses when the lens galaxy may contain multiple dark or faint substructures . </S>",
    "<S> the source and lens models are based on a superposition of an unknown number of non - negative basis functions ( or `` blobs '' ) whose form was chosen with speed as a primary criterion . </S>",
    "<S> the prior distribution for the blobs properties is specified hierarchically , so the mass function of substructures is a natural output of the method . </S>",
    "<S> we use reversible jump markov chain monte carlo ( mcmc ) within diffusive nested sampling ( dns ) to sample the posterior distribution and evaluate the marginal likelihood of the model , including the summation over the unknown number of blobs in the source and the lens . </S>",
    "<S> we demonstrate the method on two simulated data sets : one with a single substructure , and one with ten . </S>",
    "<S> we also apply the method to the g - band image of the `` cosmic horseshoe '' system , and find evidence for more than zero substructures . however , these have large spatial extent and probably only point to misspecifications in the model ( such as the shape of the smooth lens component or the point spread function ) , which are difficult to guard against in full generality .    [ firstpage ]    gravitational lensing : strong  methods : data analysis  methods : statistical </S>"
  ]
}