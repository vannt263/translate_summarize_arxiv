{
  "article_text": [
    "a _ network _ @xmath2 is a triple of a directed graph @xmath3 , a specified set @xmath4 of nodes called _ terminals _ , and a nonnegative integer - valued edge - capacity @xmath5 .",
    "@xmath6-path _ is a ( directed ) path joining distinct terminals .",
    "a _ multiflow _ ( _ multicommodity flow _ ) is a pair @xmath7 of a set @xmath8 of @xmath6-paths and a nonnegative flow - value function @xmath9 satisfying the capacity constraint : @xmath10 for @xmath11 .",
    "given a nonnegative terminal weight @xmath12 , the flow - value @xmath13 of multiflow @xmath14 is defined by @xmath15 , where @xmath16 and @xmath17 denote the start node and the end node of @xmath18 , respectively .",
    "then the _ @xmath0-weighted maximum multiflow problem _ is formulated as :    @xmath0-mfp : : :    maximize @xmath13 over all multiflows    @xmath19 in @xmath2 .    for a special terminal weight @xmath0",
    ", the @xmath0-mfp has a nice integrality property .",
    "for example , consider @xmath20 and @xmath21 .",
    "then the max - flow min - cut theorem says that the maximum flow value is equal to the minimum @xmath22-cut value and there always exists an _",
    "integral _ maximum flow ( maximum flow @xmath7 for which @xmath23 is integer - valued ) .",
    "consider the case where @xmath24 for all distinct @xmath25 , and network is eulerian .",
    "lomonosov  @xcite and frank  @xcite independently proved that the maximum flow value is equal to the sum of the minimum @xmath26-cut value over @xmath27 and there exists an integral maximum multiflow .",
    "the goal of this paper is to classify weight functions @xmath28 for which @xmath0-mfp possesses such a combinatorial min - max relation .",
    "this classification problem , called the _ fractionality problem _ , was raised by karzanov for the undirected @xmath0-mfp ( @xmath29 is undirected and @xmath0 is symmetric ) ; see @xcite .",
    "it is well - known that the lp - dual to @xmath0-mfp is a linear optimization over metrics on node set @xmath30 . in 90 s , karzanov  @xcite found a remarkable fact that all possible candidates of optimal metrics are embedded into _ a metric space on a polyhedral complex associated with @xmath0_. this polyhedral complex is known as the _ tight span _ , which was earlier introduced by isbell  @xcite and dress  @xcite independently . then the lp - dual reduces to a _ facility location problem _ on the tight span .",
    "furthermore , if the tight span has a sufficiently nice geometry ( dimension at most two ) , then one can obtain a combinatorial min - max relation from its shape . otherwise ( dimension at least three ) , one can conclude that @xmath0-mfp has no such a combinatorial duality relation .",
    "recently , this beautiful theory was further extended by the first author , and the fractionality problem for the undirected @xmath0-mfp was roughly settled  @xcite .",
    "our previous paper  @xcite started to develop an analogous duality theory for directed multiflows . in the directed case ,",
    "the lp - dual is a linear optimization over _ possibly asymmetric _ metrics , which we call _ directed metrics_. we introduced a directed version @xmath1 of the tight span ( _ directed tight span _ ) . in the case of metric @xmath0-mfp",
    "( @xmath0 is a directed metric ) , we showed that the lp - dual reduces to a facility location problem on @xmath1 ; see ( * ? ? ?",
    "* section 4 ) .",
    "moreover , in the case where a network is eulerian , this lp - dual further reduces to a facility location problem on the _ tropical polytope _",
    "@xmath31 spanned by @xmath0 , which was earlier introduced by develin - sturmfels  @xcite in the context of the tropical geometry .",
    "the main contribution of this paper extends this duality theory for possibly nonmetric weights and solves the fractionality problems ( i ) for @xmath0-mfp and ( ii ) for eulerian @xmath0-mfp ( which is @xmath0-mfp on an eulerian network ) . in section  [ sec : duality ] , we establish a general duality relation for @xmath0-mfp with a possibly nonmetric weight @xmath0 . as well as the metric case ,",
    "the lp - dual reduces to a facility location on the directed tight span @xmath1 ( theorem  [ thm : t - dual ] ) .",
    "however , in eulerian case , we need a more careful treatment for the nonmetricity of @xmath0 .",
    "we newly introduce the _ slimmed tropical polytope _",
    "@xmath32 , which is a certain subset of the tropical polytope and coincides with it if @xmath0 is a metric .",
    "then we prove that the lp - dual to an eulerian @xmath0-mfp reduces to a facility location on @xmath32 ( theorem  [ thm : r - dual ] ) . in section  [ sec : integrality ] , we show the integrality theorem ( theorem  [ thm : integrality ] ) that ( i ) if @xmath33 , then every @xmath0-mfp has an integral optimal multiflow , and ( ii ) if @xmath34 then every eulerian @xmath0-mfp has an integral optimal multiflow .",
    "we remark that the former result can be proved by a reduction to the minimum cost circulation .",
    "the second result includes lomonosov - frank theorem for directed free multiflows  @xcite and ibaraki - karzanov - nagamochi s directed version of the multiflow locking theorem  @xcite as special cases .",
    "we give a combinatorial characterization of weights @xmath0 with @xmath35 in terms of _ oriented trees _",
    "( theorem  [ thm : dim1 ] ) , and explain a relationship among these results . in section  [ sec : unbounded ] , we show that the one - dimensionality of the directed tight span and the slimmed tropical polytope are best possible for the integrality .",
    "theorem  [ thm : unbounded ] says that if @xmath36 , then there is no positive integer @xmath37 such that every @xmath0-mfp has a @xmath38-integral optimal multiflow , and that if @xmath39 , then there is no positive integer @xmath37 such that every eulerian @xmath0-mfp has a @xmath38-integral optimal multiflow .    [ [ notation . ] ] notation .",
    "+ + + + + + + + +    the sets of real numbers and nonnegative real numbers are denoted by @xmath40 and @xmath41 , respectively .",
    "the set of functions from a set @xmath42 to @xmath40 ( resp .",
    "@xmath43 ) is denoted by @xmath44 ( resp .",
    "@xmath45 ) . for a subset @xmath46 , the characteristic function @xmath47 is defined by @xmath48 for @xmath49 and @xmath50 for @xmath51 . we particularly denote by @xmath52 the all - one function in @xmath44 .",
    "for @xmath53 , @xmath54 means @xmath55 for each @xmath56 , and @xmath57 means @xmath58 for each @xmath56 . for @xmath59 ,",
    "@xmath60 is defined by @xmath61 for each @xmath56 . for a set @xmath18 in @xmath62 , a point @xmath63 in @xmath18",
    "is said to be _ minimal _ if there is no other point @xmath64 with @xmath65 .    for a set @xmath6 , a nonnegative real - valued function @xmath66 on @xmath67 having zero diagonals @xmath68 @xmath69",
    "is called a _ directed distance_. we regard a terminal weight @xmath70 as a directed distance . a directed distance @xmath66 on a set @xmath6",
    "is called a _ directed metric _ if it satisfies the triangle inequality @xmath71 for every triple @xmath72 .",
    "a _ directed metric space _ is a pair @xmath73 of a set @xmath6 and a directed metric @xmath66 on @xmath6 . for a directed metric @xmath66 on @xmath74 , and two subsets @xmath75 , let @xmath76 denote the minimum distance from @xmath77 to @xmath78 : @xmath79 in our theory , the following directed metric @xmath80 on @xmath62 is particularly important : @xmath81 we remark that @xmath82 whenever @xmath83 . for a directed or undirected graph @xmath29 , its node set and edge set",
    "are denoted by @xmath30 and @xmath84 , respectively .",
    "if directed , an edge with tail @xmath85 and head @xmath86 is denoted by @xmath87 .",
    "if undirected , we do not distinguish @xmath87 and @xmath88 . in a network @xmath2 , a non - terminal node",
    "is called an _ inner node_. for a node @xmath89 , we say `` _ @xmath85 fulfills the eulerian condition _ '' if the sum of the capacities @xmath90 over edges @xmath87 leaving @xmath85 is equal to that over edges entering @xmath85 . a network @xmath2 is said to be _ inner eulerian _ if every inner node fulfills the eulerian condition , and is said to be _ totally eulerian _ if every node fulfills the eulerian condition . _",
    "a directed distance and directed metric is often simply called a distance and a metric , respectively . _",
    "let @xmath2 be a network and let @xmath0 be a directed distance on @xmath6 .",
    "we denote by @xmath91 the optimal value of @xmath0-mfp for @xmath2 . the linear programing dual to @xmath0-mfp is given by @xmath92 we are going to represent lpd as a facility location problem on a metrized polyhedral complex associated with @xmath0 .",
    "let @xmath93 and @xmath94 be copies of @xmath6 . for an element @xmath27 , the corresponding elements in @xmath93 and @xmath94 are denoted by @xmath95 and @xmath96 , respectively .",
    "we denote @xmath97 by @xmath98 . for a point @xmath99 , the restrictions of @xmath63 to @xmath93 and @xmath94",
    "are denoted by @xmath100 and @xmath101 , respectively , i.e. , @xmath102 .",
    "consider the following unbounded polyhedron in @xmath103 : @xmath104 let @xmath105 be a directed metric on @xmath103 defined as @xmath106 we endow @xmath107 and its subsets with this directed metric .",
    "for a subset @xmath108 in @xmath107 , we denote by @xmath109 the set of nonnegative points in @xmath108 .",
    "also for @xmath27 we denote by @xmath110 the set of points @xmath111 with @xmath112 ; if @xmath113 then @xmath114 is the set of points @xmath111 with @xmath115 .    for a subset @xmath116 , consider the following _ facility location problem _ on @xmath108 : @xmath117 let @xmath118 denote the minimum value of this problem . then the following weak / strong duality holds :    for a network @xmath2 and a directed distance @xmath0 on @xmath6 , we have    * @xmath119 for any subset @xmath116 , and * @xmath120 .",
    "we first note the following property :    for @xmath25 and @xmath121 we have @xmath122.[clm : rsrt ]    indeed , @xmath123 , where we use @xmath124 .",
    "it suffices to show ( 2 ) .",
    "take a map @xmath125 feasible to flp .",
    "let @xmath66 be a metric on @xmath30 defined by @xmath126 .",
    "by ( [ clm : rsrt ] ) , we have @xmath127 for @xmath25 .",
    "thus @xmath66 is feasible to lpd with the same objective value .",
    "conversely , take a metric @xmath66 feasible to lpd .",
    "define @xmath128 by @xmath129 for @xmath27",
    ". then @xmath130 .",
    ". moreover @xmath132 .",
    "thus @xmath133 is feasible to flp for @xmath134 . by triangle inequality we have @xmath135 .",
    "since @xmath136 is nonnegative , we have @xmath137 .    in the following",
    ", we are going to determine `` reasonably small '' subsets @xmath116 for which the strong duality holds ( i ) for general networks and ( ii ) for eulerian networks . in the next subsection ( section  [ subsec : tightspans ] ) ,",
    "we introduce the directed tight span @xmath1 and a fiber @xmath138 of the tropical polytope as subsets in @xmath107 , and list their fundamental properties , shown by our previous paper  @xcite . in section  [ subsec : relation ] , we show that the strong duality holds for @xmath139 in every network ( theorem  [ thm : t - dual ] ) .",
    "we introduce a notion of a slimmed section and show that the strong duality holds for a slimmed section @xmath140 in every eulerian network ( theorem  [ thm : r - dual ] ) .",
    "consider the following ( non - convex ) polyhedral subsets in @xmath107 : @xmath141 we call @xmath1 the _ directed tight span_. the polyhedron @xmath142 has the linearity space @xmath143 .",
    "the projection @xmath144 is known as the _ tropical polytope _ generated by matrix @xmath145 ; see develin and sturmfels  @xcite .",
    "we note the relation : @xmath146 . in the inclusions",
    ", @xmath1 is a subcomplex ( i.e. , a union of faces ) of @xmath107 , and @xmath147 is a subcomplex of @xmath1 .",
    "a subset @xmath140 is called a _ section _ if the projection @xmath148 is bijective .",
    "a subset @xmath149 is said to be _ balanced _ if there is no pair @xmath150 of points in @xmath108 such that @xmath151 or @xmath152 .",
    "in fact , the projection @xmath153 is surjective and there always exists a balanced section in @xmath147  ( * ? ? ? * lemma 2.4 ) . figure  [ fig : qmu ] illustrates @xmath154 , @xmath155 , and @xmath156 for all - one distance on a @xmath157-set @xmath158 . in this case",
    ", @xmath159 holds , @xmath154 consists of three infinite strips with a common side , @xmath155 is a folder consisting of three triangles , and @xmath156 is a star of three leaves .    the rest of this subsection is devoted to listing basic properties of these polyhedral sets .",
    "they were proved in ( * ? ? ?",
    "* section 2 ) .",
    "the most important property for us is the existence of _ nonexpansive retractions _ among them .",
    "[ [ a .- nonexpansive - retractions . ] ] a. nonexpansive retractions .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    for two directed metric spaces @xmath160 and @xmath161 , a map @xmath162 is said to be _ nonexpansive _ if @xmath163 for all pairs @xmath164 . by a _ cycle _",
    "@xmath165 of @xmath74 we mean a cyclic permutation @xmath166 of a finite ( multi-)set in @xmath74 . its _ length _",
    "@xmath167 is defined by @xmath168 also , @xmath162 is said to be _ cyclically nonexpansive _ if @xmath169 for all cycles @xmath165 in @xmath74 .",
    "a map from a set @xmath74 to its subset @xmath170 is said to be a _ retraction _ if it is identity on @xmath6 .",
    "there exists a nonexpansive retraction @xmath171 with @xmath172 for @xmath173 .",
    "there exists a cyclically nonexpansive retraction @xmath174 .    for any balanced section @xmath140 , the retraction @xmath175 determined by the relation @xmath176",
    "is cyclically nonexpansive .",
    "[ fact : nonexpansive ]    see figure  [ fig : retract1 ] for the retraction in ( 3 ) .",
    "[ [ b .- geodesics - and - embedding . ] ] b. geodesics and embedding .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    a path @xmath177 is the image of a continuous map @xmath178 \\to \\rr^{s^{cr}}$ ] .",
    "the length of @xmath18 from @xmath179 to @xmath180 is defined by the supremum of @xmath181 over all @xmath182 and @xmath183 .",
    "for simplicity , we restrict @xmath184 to be sufficiently nice : @xmath184 is injective and",
    "its length is finite .",
    "a subset @xmath149 is said to be _ geodesic _ if each pair @xmath185 of points is joined by a path in @xmath108 having length @xmath186 from @xmath63 to @xmath187 .",
    "@xmath1 , @xmath138 , @xmath188 and any balanced section in @xmath138 are all geodesic .",
    "[ fact : geodesic ]    for @xmath27 , let @xmath189 be the point in @xmath103 defined by @xmath190 namely @xmath189 is composed by @xmath191-th column and @xmath191-th row vectors of @xmath0 ( as a matrix ) .",
    "for any balanced section @xmath108 in @xmath188 we have @xmath192 .",
    "for @xmath25 we have @xmath193",
    ".    if @xmath0 is a metric , then @xmath194 for each @xmath27 .",
    "[ fact : embedding ]    in particular , if @xmath0 is a metric , then metric space @xmath73 is isometrically embedded into any balanced section @xmath108 in @xmath188 by @xmath195 .",
    "[ [ c .- tight - extensions . ] ] c. tight extensions .",
    "+ + + + + + + + + + + + + + + + + + + +    for a metric @xmath0 on @xmath6 , an _ extension _ of @xmath0 is a metric @xmath66 on @xmath74 with @xmath170 and @xmath196 for @xmath25 , and it is said to be _ tight _ if there is no other extension @xmath197 on @xmath74 with @xmath198 and @xmath199 .",
    "also an extension @xmath66 on @xmath74 of @xmath0 is said to be _ cyclically tight _ if there is no other extension @xmath197 on @xmath74 such that @xmath200 for all cycles @xmath165 in @xmath74 and @xmath201 for some cycle @xmath165 .",
    "every cyclically tight extension is a tight extension .",
    "the converse is not true .",
    "for example , @xmath20 , @xmath202 , @xmath203 , and consider two extensions @xmath204 on @xmath74 defined by @xmath205 then @xmath66 is tight , but not cyclically tight . indeed , for every pair @xmath206 if @xmath207 , then @xmath208 or @xmath209 ; this means that we can not decrease @xmath210 keeping the triangle inequality .",
    "compare @xmath66 with @xmath197 .",
    "then @xmath200 for all cycles @xmath165 , and @xmath211 .",
    "thus @xmath66 is not cyclically tight .    every tight extension and cyclically tight extension",
    "are embedded into @xmath212 and @xmath213 , respectively .",
    "we use this fact in section  [ sec : unbounded ] .",
    "let @xmath0 be a metric on @xmath6 and @xmath66 its extension on @xmath74 .",
    "* @xmath66 is tight if and only if there is an isometric embedding @xmath214 such that @xmath215 for each @xmath27 .",
    "* @xmath66 is cyclically tight if and only if there is an isometric embedding @xmath216 such that @xmath215 for each @xmath27 and @xmath217 is balanced .",
    "[ fact : extension ]    here an _",
    "isometric embedding _ from @xmath160 to @xmath161 is a map @xmath218 satisfying @xmath219 for all @xmath164 .    [",
    "[ d .- further - technical - stuffs . ] ] d. further technical stuffs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    for a point @xmath220 , let @xmath221 denote the bipartite graph on @xmath98 with edge set @xmath222 .",
    "a point @xmath173 belongs to @xmath1 if and only if @xmath223 has no isolated node @xmath224 with @xmath225 .",
    "a point @xmath226 belongs to @xmath138 if and only if @xmath223 has no isolated node .    for @xmath227 ,",
    "the dimension of the minimal face of @xmath1 containing @xmath63 is equal to the number of components in @xmath223 having no node @xmath224 with @xmath228 .    for @xmath229 ,",
    "the dimension of the minimal face of @xmath138 containing @xmath63 is equal to the number of components in @xmath223  ( * ? ? ?",
    "* proposition 17 ) .",
    "any @xmath37-dimensional face @xmath230 in @xmath212 is isometric to a @xmath37-dimensional polytope in @xmath231 .",
    "@xmath232 holds for @xmath233 and for @xmath234 .",
    "@xmath1 has dimension at most @xmath235 if and only if @xmath1 is a path isometric to a segment in @xmath236 .",
    "[ fact : technical ]    the property ( 3 ) follows from ( * ? ? ?",
    "* ( 2.1 ) ) .",
    "our technical arguments use a method of perturbing a point @xmath237 to another point @xmath238 . for a node subset @xmath239 in a graph @xmath223 , the set of nodes in @xmath240 incident to @xmath239",
    "is denoted by @xmath241 .",
    "the following consideration is a basis for our perturbation method , which has a similar flavor of manipulating dual variables in bipartite matching problems :    for @xmath242 , let @xmath243 for small @xmath244 , and @xmath245 .",
    "* @xmath246 ( @xmath247 ) is necessary for keeping the nonnegativity of @xmath248 . *",
    "put @xmath249 so that @xmath250 .",
    "* then all edges joining @xmath251 and @xmath252 vanish in @xmath253 .",
    "* therefore , @xmath248 belongs to @xmath188 if and only if each node in @xmath251 is joined to @xmath254 in @xmath223 .",
    "* we can increase @xmath255 until some coordinate of @xmath248 in @xmath256 reaches zero or there appears an edge joining @xmath256 and @xmath254 .",
    "[ fact : movement ]    here the fourth implication uses ( [ fact : technical ] )  ( 1 ) .",
    "first we establish strong duality relations for general networks and for inner eulerian networks , which are easy consequences of the existence of nonexpansive retractions  ( [ fact : nonexpansive ] ) .",
    "[ thm : t - dual ] let @xmath0 be a directed distance on @xmath6 .",
    "* @xmath257 holds for every network @xmath2 . *",
    "@xmath258 holds for every balanced section @xmath108 in @xmath188 and every inner eulerian network @xmath2 .",
    "take an optimal map @xmath133 for flp with @xmath134 .",
    "take a nonexpansive retraction @xmath259 in  ( [ fact : nonexpansive ] )  ( 1 ) .",
    "consider the composition @xmath260 .",
    "then @xmath261 is also feasible , and does not increase the objective value .",
    "thus we have ( 1 ) .",
    "next we show ( 2 ) .",
    "suppose that @xmath2 is inner eulerian .",
    "then the capacity function @xmath262 is decomposed into the sum of the incidence vectors of cycles @xmath263 and @xmath6-paths",
    "@xmath264 ( possibly repeating ) . take an optimal map @xmath133 for flp with @xmath139 .",
    "then we have @xmath265 we can take a cyclically nonexpansive retraction @xmath266 by ( 2),(3 ) in ( [ fact : nonexpansive ] ) .",
    "since @xmath267 for each @xmath27 by ( [ fact : embedding ] )  ( 1 ) , @xmath268 is identity on @xmath269 and thus @xmath270 is also feasible .",
    "moreover , by cyclically nonexpansiveness , @xmath271 holds and also @xmath272 holds by @xmath273 for @xmath25 . hence @xmath270 is also optimal .",
    "we give some examples .",
    "consider the all - one distance @xmath0 on a 3-set @xmath158 ; recall figure  [ fig : qmu ] .",
    "then the flp is a location problem on a directed metric space on a folder consisting of three triangles , each of which is isometric to triangle @xmath274 in @xmath275 .",
    "suppose that the network is inner eulerian .",
    "we can take a balanced section @xmath108 in @xmath188 , which is a tree . by a cyclically nonexpansive retraction from @xmath188 to @xmath108",
    ", the flp reduces to a location problem on the tree @xmath108 ; see figure  [ fig : retract1 ] .",
    "consider the @xmath276-commodity flow case ; let @xmath277 , and let @xmath278 and let the other distances be zero .",
    "then @xmath1 is given by @xmath279 , which is isometric to a square @xmath280 in @xmath275 .",
    "terminal regions @xmath281 correspond to four sides as in figure  [ fig:2commodity ] . in this case , @xmath159 holds , and moreover @xmath188 itself is a balanced section .",
    "in contrast to the previous example , the region contraction in flp does not occur if the inner eulerian condition is imposed .",
    "[ [ slimmed - sections - and - eulerian - condition - on - terminals . ] ] slimmed sections and eulerian condition on terminals .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    next we consider the case where some of terminals fulfill the eulerian condition . in this case",
    ", the strong duality holds for further smaller subsets in @xmath138 , called _",
    "slimmed sections_. to define a slimmed section , we need several ( somewhat technical ) notions .",
    "recall notions of @xmath223 and @xmath282 associated with @xmath229 ; see section  [ subsec : tightspans ]  d. let @xmath283 be the set of subsets @xmath42 of @xmath6 such that @xmath284 for all @xmath285 ; obviously @xmath286 . for @xmath287 ,",
    "let @xmath288 denote the set of points @xmath229 with @xmath289 for @xmath290 and @xmath291 for @xmath292 ; in particular @xmath293 .",
    "a point @xmath63 in @xmath138 is called a _ fat _ relative to @xmath42 if @xmath294 , and @xmath295 or @xmath296 .",
    "the _ degenerate set _",
    "@xmath297 relative to @xmath42 is the set of points @xmath63 in @xmath288 with @xmath298 or @xmath299 .",
    "any point in a degenerate set is a fat .",
    "a _ proper fat _ is a fat not belonging to any degenerate set .",
    "let @xmath300 be the subset of @xmath138 obtained by deleting all proper fats .",
    "we consider the following equivalence relation @xmath301 on @xmath300 : @xmath302 if @xmath303 , or for some @xmath287 , both @xmath63 and @xmath187 belong to @xmath297 and @xmath304 .",
    "the quotient @xmath305 is called the _ slimmed tropical polytope _ associated with @xmath0 , and is denoted by @xmath32 .",
    "the tropical polytope and the slimmed tropical polytope are the same if @xmath0 is a metric .",
    "[ prop : slim ] if @xmath0 is a metric , then @xmath138 has no fat , and hence @xmath306 .    by @xmath307 for @xmath290 and ( [ fact : embedding ] )",
    "( 3 ) , @xmath308 is a single point @xmath189 for @xmath290 . in @xmath309 ,",
    "node @xmath95 is incident to all nodes in @xmath94 , and @xmath96 is incident to all nodes in @xmath93 ; thus @xmath189 is never a fat .",
    "again we consider special sections in @xmath300 , called _ slimmed sections_. here a section is a subset of @xmath300 bijectively projected into @xmath32 . we first define a slimmed section @xmath108 in @xmath310 , which is a section such that it is balanced , and for each @xmath287 , there is no pair @xmath311 such that @xmath312 for all @xmath313 or @xmath314 for all @xmath315 .",
    "next , a slimmed section @xmath108 in @xmath300 is a section such that it is balanced and @xmath316 for some slimmed section @xmath317 in @xmath310 ( recall that the projection from @xmath188 to @xmath31 is surjective ) .",
    "figure  [ fig : ex ] depicts two examples of @xmath188 together with @xmath223 for an interior point @xmath63 in each face .    in the left example",
    ", @xmath188 is obtained from a folder of two triangles by attaching one segment on the top . here",
    "any point in triangles except upper edges is a proper fat relative to @xmath318 .",
    "so @xmath310 is a star of three edges , and is a slimmed section . in the right example",
    ", @xmath188 is the union of square and segment .",
    "although there is no proper fat , points in the square except the left and right corners form a section of degenerate set @xmath319 .",
    "a slimmed section is obtained by replacing the square by an appropriate curve connecting the left and right corners ; see figure  [ fig : retract2 ] .",
    "a terminal @xmath27 is said to be _ proper _ if @xmath320 has no fat . a network @xmath2 is said to be _ properly inner eulerian _ ( relative to @xmath0 ) if every node except proper terminals fulfills the eulerian condition .",
    "the main result here is the following :    [ thm : r - dual ] let @xmath0 be a directed distance on @xmath6 .",
    "* @xmath258 holds for every slimmed section @xmath108 in @xmath310 and every properly inner eulerian network @xmath2 . *",
    "@xmath258 holds for every slimmed section @xmath108 in @xmath300 and every totally eulerian network @xmath2 .",
    "the proof uses the following new retraction lemma :    [ lem : slimmed ] for any slimmed section @xmath108 in @xmath188 , there exists a cyclically nonexpansive retraction @xmath268 from @xmath155 to @xmath108 with @xmath321 for each @xmath27 .",
    "the proof of this lemma is given in the end of this subsection .",
    "assuming lemma  [ lem : slimmed ] , we prove theorem  [ thm : r - dual ] .",
    "let @xmath322 be the set of proper terminals .",
    "take an optimal map @xmath323 for flp .",
    "as in the proof of theorem  [ thm : t - dual ] , there are cycles @xmath324 and @xmath322-paths @xmath325 such that ( [ eqn : cipj ] ) holds .",
    "take a cyclically nonexpansive retraction @xmath268 in lemma  [ lem : slimmed ] .",
    "then @xmath326 is feasible to flp with @xmath108 . since @xmath268 is cyclically nonexpansive , @xmath327 and @xmath328 , where the second inequality follows from the fact that @xmath268 is identity on @xmath114 for each proper terminal @xmath329 .",
    "thus @xmath270 and @xmath133 have the same objective value . the statement ( 2 )",
    "follows from ( 1 ) and ( [ fact : nonexpansive ] )  ( 3 ) .",
    "figure  [ fig : retract2 ] illustrates cyclically nonexpansive retractions in the examples of figure  [ fig : ex ] . again the 2-commodity tight span in figure  [ fig:2commodity ] has no fat ; the region contraction in flp does not occur even if the totally eulerian condition is imposed .    as a corollary",
    ", we obtain topological properties of slimmed sections :    [ cor : topology ] let @xmath140 be a slimmed section .    * @xmath108 is contractible and geodesic , and so is @xmath114 for @xmath27 . * if @xmath330 , then @xmath331 for @xmath25 .    ( 1 ) .",
    "a cyclically nonexpansive map is continuous in the euclidean topology  ( * ? ? ?",
    "* remark 2.4 ) .",
    "so @xmath108 is homotopy equivalent to convex set @xmath332 , which is contractible . since @xmath332 is geodesic , so is @xmath108 ; see ( * ? ? ?",
    "* section 2.3 ) . since @xmath114 is a retract of a face of @xmath332 , it is contractible and geodesic by the same argument .",
    "consider the eulerian network @xmath2 such that @xmath333 and the other capacities are zero .",
    "obviously @xmath334 .",
    "by @xmath335 , there is @xmath121 with @xmath336 .",
    "necessarily @xmath337 and @xmath338 by ( [ clm : rsrt ] ) .    [",
    "[ proof - of - lemmalemslimmed . ] ] proof of lemma  [ lem : slimmed ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the proof , we denote by @xmath339 and @xmath340 the projections of @xmath138 to @xmath341 and @xmath342 , respectively .",
    "these projections are bijective and isometric by ( [ fact : technical ] )  ( 4 ) . for @xmath343 , we can lift @xmath187 to @xmath229 with @xmath344 by @xmath345 .",
    "we remark that @xmath346 for @xmath347 and @xmath348 .",
    "let @xmath78 be any balanced section in @xmath188 .",
    "by @xmath349 and ( [ fact : embedding ] )  ( 1 ) , @xmath78 includes @xmath308 for all @xmath287 .",
    "one can verify from ( [ fact : movement ] ) that a point @xmath347 is a fat if and only if for small @xmath244 we have @xmath350 or @xmath351 ( use the property that any node @xmath224 with @xmath228 is incident to @xmath352 by nonnegativity of @xmath0 ) .",
    "based on this , for @xmath353 , consider the map @xmath354 on @xmath78 obtained by the following process . for each @xmath347",
    ", add @xmath355 to @xmath100 , where @xmath356 is the maximum nonnegative real in @xmath357 $ ] such that @xmath358 belongs to the closure of @xmath359 .",
    "then lift the resulting point @xmath187 to @xmath360 with @xmath361 , and define @xmath362 .",
    "extend @xmath354 to a map @xmath363 by defining it to be identity on the points not in @xmath308 .    in above @xmath364 , the following key property holds :    for @xmath365 with @xmath366 , if @xmath187 is not a proper fat relative to any proper subset @xmath367 , then we have @xmath368 [ clm : key ]    by ( [ fact : technical ] )  ( 4 ) , we may consider @xmath369 instead of @xmath370 .",
    "the first relation is obvious from definition of @xmath80 ; see @xcite .",
    "we show the second . we claim that @xmath371 has an edge @xmath372 joining @xmath373 and @xmath374 .",
    ". then @xmath375 .",
    "since @xmath287 , @xmath284 holds for all @xmath376 .",
    "hence we have @xmath377 for @xmath378 and @xmath379 for @xmath313 . since @xmath380 , necessarily @xmath381 ( proper inclusion ) , and @xmath187 is a proper fat relative to @xmath382 with @xmath383 ; a contradiction . for an edge @xmath384 joining @xmath373 and @xmath374",
    ", we have @xmath385 , where we use @xmath386 by @xmath384 and @xmath387 .",
    "therefore we have ( @xmath388 ) @xmath389 .",
    "thus we have @xmath390 where the second equality uses @xmath391 for all @xmath392 and the third uses ( @xmath388 ) .",
    "we can define @xmath393 by changing roles of @xmath136 and @xmath394 , and an analogous property holds .",
    "let @xmath395 and @xmath396 ( well - defined ) .",
    "next we study the image of @xmath397 .",
    "let @xmath398 for @xmath347 .",
    "then @xmath399 necessarily has an edge joining @xmath373 and @xmath374 . therefore if @xmath400 is a fat , then it is a fat relative to @xmath401 ( proper inclusion ) , or @xmath400 is _ @xmath394-maximal _ in @xmath402 in the sense that @xmath403 for every @xmath244 .",
    "also if @xmath63 belongs to @xmath402 , then @xmath400 is an @xmath394-maximal point with @xmath404 ; see the right of figure  [ fig : retract2 ] .",
    "again an analogous property holds for @xmath405 by changing roles of @xmath394 and @xmath136 .",
    "let @xmath406 .",
    "then the image @xmath407 does not contain a proper fat relative to @xmath42 .",
    "let @xmath408 be the subset of @xmath78 obtained by deleting all proper fats and replacing each @xmath402 by the set of its @xmath136-maximal points .",
    "order all subsets @xmath409 in @xmath283 so that @xmath410 implies @xmath411 .",
    "then the composition @xmath412 is a retraction from @xmath78 to @xmath408 .",
    "we show that @xmath413 is cyclically nonexpansive .",
    "let @xmath414 . take a cycle @xmath165 in @xmath415 .",
    "we prove that @xmath416 is a monotone nonincreasing function .",
    "it suffices to show @xmath417 for small @xmath244 . by construction , @xmath165 does not contain proper fats relative to any @xmath367 . by ( [ clm : key ] ) , for a consecutive pair @xmath418 in @xmath165 we have @xmath419 since the number of consecutive pairs @xmath418 with @xmath420 is equal to that with @xmath421 , summing up ( ) over all consecutive pairs yields @xmath417 .",
    "the argument for @xmath422 is similar .",
    "thus @xmath268 is cyclically nonexpansive .",
    "we next verify that @xmath408 is slimmed .",
    "indeed , take an arbitrary pair @xmath423 of @xmath136-maximal points in @xmath402 .",
    "then there are edges @xmath424 joining @xmath256 and @xmath425 .",
    "hence @xmath426 , and @xmath427 .",
    "finally we construct a cyclically nonexpansive retraction from @xmath188 to any slimmed section .",
    "any slimmed section @xmath108 in @xmath310 is obtained from a balanced section @xmath78 by deleting all proper fats and replacing each @xmath402 by a subset @xmath428 with the properties that ( i ) there is no pair @xmath429 with @xmath312 for all @xmath313 or @xmath314 for all @xmath315 , and ( ii ) for each @xmath430 there uniquely exists @xmath431 with @xmath432 .",
    "it suffices to give a cyclically nonexpansive map from @xmath433 to @xmath108 . for each @xmath287",
    ", we can define a map @xmath434 on @xmath408 as : for each @xmath435 , define @xmath436 to be the point @xmath248 in @xmath428 determined by the relation @xmath437 , and to be identity on the other points .",
    "so it suffices to prove that @xmath434 is cyclically nonexpansive ; consider the composition of @xmath434 for all @xmath287 .",
    "one can verify this fact in the essentially same way as above .",
    "the projection of @xmath402 to @xmath438 is isometry , and the image of @xmath428 is a balanced set in @xmath438 .",
    "so we can apply the method in the proof of ( * ? ? ?",
    "* lemma 2.7 ) ; the details are left to readers .",
    "the geometry of @xmath1 and @xmath32 crucially affects the integrality of @xmath0-mfp .",
    "the dimension of @xmath1 is defined by the largest dimension of faces of @xmath1 .",
    "the dimension of @xmath32 is defined by the largest dimension of faces @xmath230 of @xmath300 in modulo @xmath301 ; intuitively , it is the dimension of its slimmed section .",
    "the main goal of this section is to prove the following integrality theorem :    [ thm : integrality ] let @xmath0 be a directed distance on @xmath6 .    * if @xmath439 , then @xmath0-mfp has an integral optimal multiflow for every network @xmath2 . *",
    "if @xmath34 , then @xmath0-mfp has an integral optimal multiflow for every properly inner eulerian network @xmath2 ( relative to @xmath0 ) .",
    "the first statement ( 1 ) is reducible to the minimum cost circulation .",
    "so we mainly concentrate on the second statement ( 2 ) and its consequences .",
    "the rest of this section is organized as follows . in next section  [ subsec : prelim ] ,",
    "we give basic definitions for cuts , cut distances , and oriented - tree realizations .",
    "then , in section  [ subsec : proof ] , we prove theorem  [ thm : integrality ]  ( 2 ) . in section  [ subsec :",
    "combinatorial ] , we give a useful `` combinatorial version '' of theorem  [ thm : integrality ]  ( 2 ) , and derive ( slight ) extensions of lomonosov - frank theorem for directed free multiflows and ibaraki - karzanov - nagamochi s directed version of the multiflow locking theorem . in section  [ subsec : reduction ] , we prove ( 1 ) by a reduction to the minimum cost circulation .",
    "a _ partial cut _ on a set @xmath6 is an ordered pair @xmath440 of disjoint subsets @xmath441 .",
    "we particularly call @xmath440 a _ cut _ if @xmath442 . for a partial cut @xmath440 on @xmath6 , the",
    "_ cut distance _",
    "@xmath443 is defined by @xmath444 in a network @xmath2 , for a node subset @xmath445 , let @xmath446 denote the set of edges leaving @xmath42 . for a partial cut @xmath440 on @xmath6 , the following relation is nothing but the max - flow min - cut theorem : @xmath447 an _ oriented tree _",
    "@xmath448 is a directed graph whose underlying undirected graph is a tree . for a nonnegative edge length @xmath449 ,",
    "we define directed metric @xmath450 on @xmath451 as follows . for two nodes @xmath452 , the distance @xmath453 is defined by the sum of edge - length @xmath454 over edges @xmath455 such that the unique walk from @xmath224 to @xmath456 passes through @xmath457 in order @xmath458 .",
    "namely @xmath450 does not count the edge - length of edges with the opposite direction .",
    "a _ subtree _ of @xmath448 is a subgraph whose underlying undirected graph is a tree . for a directed distance @xmath0 on @xmath6 , an _ oriented - tree realization _",
    "@xmath459 is a triple of an oriented tree @xmath448 , a nonnegative edge - length @xmath460 , and a family @xmath461 of subtrees indexed by @xmath6 such that @xmath462 deletion of an edge @xmath463 in @xmath448 decomposes @xmath448 into two connected components @xmath464 so that @xmath465 contains @xmath224 .",
    "this yields a partial cut @xmath466 of @xmath6 by @xmath467 and @xmath468 . from definition of @xmath469",
    ", one can easily see @xmath470      suppose @xmath35 .",
    "then we can take a slimmed section @xmath108 represented as a union of one - dimensional faces of @xmath310 ; see the proof of lemma  [ lem : slimmed ] . by ( 3 ) and ( 4 ) in ( [ fact : technical ] ) , each segment in @xmath108 is isometric to a segment in @xmath236 . since @xmath108 is contractible ( corollary  [ cor : topology ] ) , the 1-skeleton graph @xmath448 of @xmath108 is a tree .",
    "orient this @xmath235-skeleton graph @xmath448 so that for each edge @xmath457 ( segment @xmath471 $ ] ) , @xmath63 is oriented to @xmath187 @xmath472 @xmath473 ( and @xmath474 ) .",
    "also let @xmath475 for ( oriented ) edge @xmath476",
    ". then we obtain an oriented tree @xmath448 with edge - length @xmath460 .",
    "let @xmath477 be the set of vertices ( endpoints of segments ) of @xmath108 . since @xmath108 is geodesic ( corollary  [ cor : topology ]  ( 1 ) ) , @xmath478 is isometric to @xmath479 . for @xmath27 ,",
    "let @xmath480 be the subgraph induced by @xmath114 ( well - defined since @xmath114 is a subcomplex of @xmath108 ) .",
    "since @xmath114 is also contractible ( corollary  [ cor : topology ]  ( 1 ) ) , @xmath480 is a subtree . summarizing these facts together with corollary  [ cor : topology ]  ( 2 )",
    ", we can conclude that @xmath481 is an oriented - tree realization of @xmath0 .    * i. * we first prove the following min - max relation : @xmath482 this means that flp becomes a _ discrete location problem _ on @xmath483 . by construction of @xmath448",
    ", it suffices to show the first equality , that is , there is an optimal map @xmath484 for flp with @xmath485 .",
    "take any optimal map @xmath486 .",
    "suppose that there is an interior point @xmath400 of some segment @xmath471 $ ] in @xmath108 with @xmath487 .",
    "take a sufficiently small positive @xmath244 .",
    "increase @xmath255 until @xmath488 or @xmath489 or @xmath490 or @xmath491 .",
    "let @xmath492 be defined by @xmath493 then both @xmath494 and @xmath495 are feasible . since @xmath496 for @xmath497 $ ] and",
    "@xmath108 is geodesic , the following holds : @xmath498 therefore both @xmath494 and @xmath495 are optimal . for at least one of @xmath499 ,",
    "say @xmath494 , the number of points @xmath500 with @xmath501 decreases .",
    "let @xmath502 .",
    "we can repeat this procedure until @xmath503 .",
    "this proves claim  ( [ eqn : minmax ] ) .",
    "second we derive the following min - cut expression : @xmath504 @xmath505 follows from @xmath506 , where the inequality follows from ( [ eqn : cutrep ] ) , and the equality follows from the max - flow min - cut theorem ( [ eqn : mfmc ] ) .",
    "let @xmath507 be an optimal map in ( [ eqn : minmax ] ) .",
    "let @xmath508 be the metric on @xmath30 defined by @xmath509 for @xmath510 .",
    "then @xmath508 has an oriented - tree realization @xmath511 . again the deletion of edge @xmath512 yields a cut @xmath513 of @xmath30 with @xmath514 , and @xmath515 .",
    "thus @xmath516 .",
    "* finally , we show the existence of an integral optimal multiflow .",
    "we use the splitting - off technique . by multiplying edges",
    ", we may assume that each edge has unit capacity .",
    "for a pair @xmath517 of consecutive edges , the splitting - off operation is to delete @xmath87 and @xmath518 and add a new edge from @xmath85 to @xmath519 ( of unit capacity ) . if the splitting - off operation does not decrease the optimal multiflow value , then from any optimal multiflow in the new network after the splitting - off we obtain an optimal multiflow in the initial network , and we can apply the inductive argument ( on the number of edges ) .",
    "consider any optimal ( fractional ) multiflow @xmath14 .",
    "suppose that there is a pair @xmath517 of consecutive edges such that some path in @xmath8 with nonzero flow - value passes through @xmath520 in order .",
    "if such a pair does not exist , then @xmath19 is already an integral multiflow .",
    "we show that the splitting - off at @xmath517 is successful .",
    "suppose that the splitting - off decreases the optimal flow - value .",
    "by ( [ eqn : mincut ] ) , there are @xmath521 and @xmath522 attaining the minimum of @xmath523 such that ( @xmath388 ) @xmath524 or @xmath525 .",
    "since @xmath19 is an optimal multiflow for weight @xmath526 , i.e. , a maximum ( single commodity ) @xmath466-flow , each path in @xmath8 ( with nonzero flow - value ) must meet @xmath527 at most once .",
    "this contradicts ( @xmath388 ) .",
    "we have already shown that if @xmath35 , then we obtain an oriented - tree realization of @xmath0 by @xmath32 , and the min - max relation ( [ eqn : minmax ] ) from this realization .",
    "the next theorem states that if @xmath0 is realized by an oriented tree , then one can get such a min - max relation directly ( without calculating @xmath32 ) .",
    "let @xmath528 denote the maximum flow - value with respect to @xmath0 over all integral multiflows in @xmath2 .",
    "[ thm : comb_minmax ] let @xmath0 be a directed distance on @xmath6 having an oriented - tree realization @xmath529 , and let @xmath2 be an inner eulerian network such that the eulerian condition is fulfilled by each terminal @xmath191 with @xmath480 being neither a single node nor a directed path . then the following relation holds : @xmath530 & & = \\sum_{e \\in e{\\mit\\gamma } } \\alpha(e )   \\min \\{c(\\partial x ) \\mid a_e \\subseteq x \\subseteq vg \\setminus b_e \\ } , \\nonumber\\end{aligned}\\ ] ] where @xmath466 is a partial cut on @xmath6 determined by the deletion of edge @xmath521 .",
    "the proof uses the next proposition , which says that @xmath310 is ( essentially ) a geometric realization of an oriented - tree realization @xmath531 .",
    "[ prop : realization ] suppose that @xmath0 has an oriented - tree realization @xmath531 so that @xmath532 contains all single - node subtrees .",
    "let @xmath533 consist of elements @xmath191 such that @xmath480 is a single node @xmath534 .",
    "then the following holds :    * @xmath535 \\mid s , t \\in s_0 , v_sv_t \\in e{\\mit\\gamma } \\}$ ] .",
    "* @xmath536 \\mid t , u \\in s_0 , v_tv_u \\in ef_{s } \\}$ ] for @xmath27 . *",
    "@xmath310 itself is a slimmed section .",
    "* @xmath320 has no fat if @xmath480 is a single node or a directed path .",
    "see section  [ subsec : tightspans ]  b for definition of @xmath189 .",
    "the proof is a routine verification , but rather technical .",
    "so the proof is given in the end of this subsection . in ( 4 ) the converse ( only - if part ) also holds .",
    "however we omit the proof , which is also a lengthy verification .    assuming proposition  [ prop : realization ]",
    ", we complete the proof of theorem  [ thm : comb_minmax ] .",
    "suppose that @xmath0 is realized by @xmath537 .",
    "we can add isolated terminals to @xmath2 so that @xmath461 includes all single - node subtrees .",
    "thus we may assume that @xmath537 fulfills the hypothesis in proposition  [ prop : realization ] .",
    "consider a slimmed section @xmath538 .",
    "then the 1-skeleton graph of @xmath108 coincides with @xmath448 .",
    "hence we can apply the arguments ( e.g. , ( [ eqn : minmax ] ) , ( [ eqn : mincut ] ) ) in the previous subsection .",
    "we give characterizations of a class of distances @xmath0 with @xmath35 .",
    "two partial cuts @xmath440 and @xmath539 are said to be _ laminar _ if @xmath540 or @xmath541 or @xmath542 or @xmath543 .",
    "a family @xmath544 of partial cuts is said to be _ laminar _ if every pair in @xmath544 is laminar .",
    "[ thm : dim1 ] for a directed distance @xmath0 on @xmath6 , the following conditions are equivalent :    * @xmath35 . *",
    "@xmath0 has an oriented - tree realization .",
    "* there are a laminar family @xmath544 of partial cuts on @xmath6 and a positive weight @xmath545 such that @xmath546    we have already seen ( 1 ) @xmath547 ( 2 ) in section  [ subsec : proof ] .",
    "theorem  [ thm : unbounded ]  ( 2 ) in section  [ sec : unbounded ] says that if @xmath39 then there is no integer @xmath37 such that @xmath0-mfp has a @xmath38-integral multiflow for every eulerian network .",
    "therefore , by theorem  [ thm : comb_minmax ] , if @xmath0 has an oriented - tree realization , then @xmath35 necessarily holds .",
    "thus we have ( 2 ) @xmath547 ( 1 ) .",
    "the equivalence ( 2 ) @xmath472 ( 3 ) is not difficult , and is essentially obtained by @xcite ( in an undirected version ) .    [ [ directed - multiflow - locking - theorem . ] ] directed multiflow locking theorem .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath544 be a set of partial cuts on terminal set @xmath6 in a network .",
    "we say that a multiflow @xmath19 _ locks _",
    "@xmath544 if @xmath19 is simultaneously a maximum @xmath440-flow for all partial cuts @xmath440 in @xmath544 . in the case where @xmath544 is laminar , there are an oriented - tree @xmath448 and a family @xmath461 of subtrees such that @xmath544 coincides with the set @xmath548 of partial cuts on @xmath6",
    ". consider distance @xmath549 .",
    "then @xmath0 is realized by @xmath550 . here",
    "@xmath480 is a directed path if ( and only if ) there is no pair @xmath551 with @xmath552 and @xmath553 or @xmath554",
    ". apply theorem  [ thm : comb_minmax ] to @xmath0 . from the last equality in ( [ eqn : comb_minmax ] ) , an optimal multiflow is necessarily optimal to @xmath555-mfp for each @xmath556 ; see the argument after ( [ eqn : mincut ] ) .",
    "this implies the following :    let @xmath544 be a laminar family of partial cuts on @xmath6 , and let @xmath2 be an inner eulerian network . if the eulerian condition is fulfilled by each terminal @xmath191 having a pair @xmath557 with @xmath552 and @xmath553 or @xmath554 , then there is an integral multiflow locking @xmath544 .",
    "this includes ibaraki - karzanov - nagamochi s result for laminar cuts .",
    "let @xmath544 be a laminar family of cuts on @xmath6 .",
    "for every inner eulerian network @xmath2 , there is an integral multiflow locking @xmath544 .",
    "[ [ distances - and - commodity - graphs . ] ] 0 - 1 distances and commodity graphs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    suppose the case where @xmath0 is @xmath558-valued . in this case , @xmath0 can be identified with a _",
    "commodity graph _",
    "@xmath559 by @xmath560 . for a commodity graph @xmath559 on @xmath6 ,",
    "let @xmath561 denote the corresponding 0 - 1 distance on @xmath6 defined by @xmath562 .",
    "in the case where @xmath559 is a complete digraph , lomonosov and frank independently established the following min - max relation :    let @xmath559 be a complete digraph on @xmath6 .",
    "for every inner eulerian network @xmath2 , we have @xmath563    this theorem can be regarded as a special case of theorem  [ thm : comb_minmax ] .",
    "indeed , the all - one distance is realized by a star with the sink ( or source ) as its center .",
    "so we can extend this theorem to a class of commodity graphs having oriented - tree realizations .",
    "a _ quasi - complete digraph _",
    "@xmath559 is a simple digraph having a node subset @xmath564 such that    * all edges are incident to @xmath564 , * the subgraph induced by @xmath564 is a complete digraph , and * all edges between @xmath564 and @xmath565 leave @xmath564 or enter @xmath564 .",
    "the node set @xmath564 is said to be the _ complete part _ , and @xmath559 is said to be _ source - type _ if the edges between @xmath564 and @xmath565 enter @xmath564 and is said to be _ sink - type _ otherwise . for a quasi - complete digraph @xmath559 with complete part @xmath566 , the corresponding @xmath558-valued distance @xmath561 has an oriented - tree realization by a star @xmath448 of @xmath567 leaves @xmath568 such that the center @xmath569 is a source if @xmath559 is source - type , and is a sink if @xmath559 is sink - type .",
    "indeed , for @xmath570 , let @xmath571 be the subtree consisting of one node @xmath572 .",
    "for a node @xmath573 , if @xmath191 is joined to @xmath574 , then let @xmath575 be the subtree consisting of nodes @xmath576 .",
    "then one can verify that @xmath577 is a required realization .",
    "in particular , each node @xmath191 having at least @xmath578 edges is associated with a single node or a directed path in @xmath448 . by theorem  [ thm : comb_minmax ] , we have the following :    let @xmath559 be a quasi - complete digraph on @xmath6 with complete part @xmath564 , and let @xmath2 be an inner eulerian network such that the eulerian condition is fulfilled by each terminal @xmath191 incident to at most @xmath579 edge in @xmath559 . then the following holds : @xmath580 & & \\quad = \\left\\ { \\begin{array}{ll } \\displaystyle \\sum_{s \\in t } \\min \\{c(\\partial x ) \\mid   s \\in x \\subseteq vg \\setminus n_h(s ) \\ } &   { \\rm if}\\ \\mbox{$h$ is sink - type , } \\\\    & \\\\",
    "\\displaystyle \\sum_{s \\in t } \\min \\{c(\\partial x ) \\mid   n_h(s ) \\subseteq x \\subseteq vg \\setminus s \\ } &   { \\rm",
    "if}\\ \\mbox{$h$ is source - type , } \\end{array}\\right . \\nonumber\\end{aligned}\\ ] ] where @xmath581 is the set of nodes incident to @xmath191 in @xmath559 .    a _ multipartite extension _ of a graph @xmath559 is a graph obtained by replacing each node @xmath456 by a node subset @xmath582 and joining each pair",
    "@xmath583 exactly when @xmath584 .",
    "trivially we can further extend this relation ( [ eqn : min - max01 ] ) to the case where @xmath559 is a multipartite extension of a quasi - complete digraph ( by super sink / source argument ) .",
    "also we easily see from theorem  [ thm : dim1 ] the following :    for a simple digraph @xmath559 on @xmath6 , the following conditions are equivalent :    * @xmath585 . *",
    "@xmath559 is a multipartite extension of a quasi - complete digraph .",
    "[ [ proof - of - propositionproprealization . ] ] proof of proposition  [ prop : realization ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    take an arbitrary @xmath586 .",
    "we first claim @xmath587 . since @xmath480 is a single node @xmath534",
    ", we have @xmath588 for @xmath589 .",
    "thus @xmath590 .",
    "next we give a description of @xmath309 .",
    "delete @xmath534 from @xmath448 .",
    "let @xmath591 be the resulting connected components .",
    "for @xmath592 , let @xmath593 be the set of elements @xmath594 such that @xmath595 belongs to @xmath596 .",
    "let @xmath597 be the set of elements @xmath594 such that @xmath595 contains @xmath534 .",
    "then @xmath598 is a partition of @xmath6 .",
    "a pair @xmath599 has an edge in @xmath309 if and only if a shortest path from @xmath595 to @xmath600 can pass through the node @xmath534 .",
    "we remark that tracing an edge in reverse direction takes zero length .",
    "then we see the following :    * pair @xmath601 has an edge if and only if @xmath602 .",
    "* each pair @xmath603 has an edge .",
    "* @xmath95 is incident to each element in @xmath94 and @xmath96 is incident to each element in @xmath93 .",
    "so there is no isolated node , and thus we have @xmath604 . by ( c ) , @xmath189 is not a fat .",
    "thus @xmath587 and in particular @xmath605 by ( a , b ) .",
    "also we see :    * for @xmath606 there is @xmath607 such that either @xmath608 or @xmath609 .    indeed , by assumption , there is @xmath610 such that @xmath611 is a node in @xmath612 incident to @xmath534 .",
    "then @xmath613 , and @xmath608 if @xmath614 and @xmath609 if @xmath615 .",
    "next we claim :    if a face @xmath230 of @xmath310 contains @xmath189 , then @xmath616 $ ] for some @xmath610 with @xmath617 or @xmath618 .",
    "if true , then we obtain the first statement ( 1 ) ( since @xmath619 is connected ) .",
    "perturb @xmath189 into @xmath63 so that @xmath620 and @xmath621 ( i.e. , @xmath63 belongs to a face containing @xmath189 ) .",
    "let @xmath622 be the set of nodes @xmath623 with @xmath624 , and let @xmath625 be the set of nodes @xmath623 with @xmath626 . recall ( [ fact : movement ] ) . necessarily @xmath627 ; otherwise there is an isolated node in @xmath223 .",
    "we claim    * @xmath628 or @xmath629 for some @xmath630 .",
    "suppose that both @xmath631 and @xmath632 are nonempty .",
    "since @xmath633 by ( a ) , @xmath634 implies that @xmath632 is isolated .",
    "so @xmath635 is nonempty , and has an edge incident to @xmath632 .",
    "let @xmath636 with @xmath637 .",
    "necessarily each @xmath595 for @xmath638 includes edge @xmath512 joining @xmath534 and @xmath639 ( otherwise @xmath640 is incident to all elements in @xmath641 ) , and moreover @xmath512 leaves @xmath534 ( otherwise there is no edge between @xmath642 and @xmath641 ) . by this property , there is no edge joining @xmath643 and @xmath644 in @xmath309 ( and in @xmath223 ) .",
    "thus @xmath63 is a proper fat relative to @xmath645 ; a contradiction .",
    "also @xmath646 is impossible by ( a , d ) .",
    "we may suppose @xmath628 .",
    "we show @xmath647 for some @xmath648 .",
    "suppose true .",
    "then we can see @xmath649 for some @xmath244 . by ( d ) , there is @xmath607 with @xmath650 and @xmath651 $ ] , as required .",
    ". then @xmath653 by ( a ) , and @xmath223 has no edge between @xmath654 and @xmath625 .",
    "this means that @xmath63 is a proper fat relative to some @xmath655 ; a contradiction . in the argument above",
    ", we can see that the perturbed @xmath63 never belongs to any degenerate set ; so @xmath138 has no degenerate set .",
    "this implies ( 3 ) . the claim ( 2 )",
    "can be verified in a straightforward manner .",
    "let @xmath656 be a terminal such that @xmath595 is a single node or a directed path .",
    "take any @xmath586 with @xmath534 belonging to @xmath595",
    ". then @xmath189 belongs to @xmath657 .",
    "again perturb @xmath189 into @xmath658 .",
    "it suffices to show @xmath659 . in the partition @xmath660 for @xmath309",
    ", @xmath656 belongs to @xmath597 .",
    "as above , consider @xmath661 .",
    "then @xmath628 or @xmath629 for some @xmath630 . from the assumption that @xmath595 is a single node or a directed path",
    ", one can see that @xmath640 is incident to all nodes in @xmath93 except @xmath662 for which @xmath612 includes the tail of @xmath595 , and that @xmath663 is incident to all nodes in @xmath94 except @xmath644 for which @xmath639 includes the head of @xmath595 .",
    "from this fact , either @xmath647 or @xmath664 ; otherwise edge @xmath665 vanishes in @xmath223 and this implies @xmath666 .",
    "thus we can verify @xmath659 as above .",
    "suppose @xmath439 . in this case",
    ", @xmath1 is also a tree .",
    "thus the argument in section  [ subsec : proof ] is applicable . however , by ( [ fact : technical ] )  ( 5 ) @xmath1 is a path isometric to a segment in @xmath236 .",
    "therefore by ( [ fact : embedding ] )  ( 2 ) there is a family @xmath667 \\mid s \\in s \\}$ ] of segments in @xmath40 such that @xmath668 by using this expression , we show that @xmath0-mfp is reducible to the minimum cost circulation .",
    "let @xmath2 be a network .",
    "for each terminal pair @xmath22 with @xmath669 , add new edge ( terminal edge ) @xmath670 with edge - cost @xmath671 . then consider the minimum cost circulation problem on the new network ; this is a relaxation of @xmath0-mfp .",
    "as is well - known , there is an integral minimum cost circulation .",
    "this circulation can be decomposed into the sum of the incidence vectors for some ( possibly repeating ) cycles .",
    "if each cycle contains at most one terminal edge , then we obtain an integral optimal multiflow by deleting the terminal edge from each cycle .",
    "so suppose that there is a cycle @xmath165 containing at least two terminal edges .",
    "then @xmath165 is the union of terminal edges @xmath672 and @xmath6-paths @xmath673 , where @xmath37 is an odd integer , and @xmath674 is an @xmath675-path .",
    "we claim @xmath676 where we let @xmath677 .",
    "the lhs ( @xmath678 ) is the negative of the cost of the cycle @xmath165 and the rhs is the total flow - value of @xmath6-paths @xmath679 ( with unit flow - values ) .",
    "suppose that the claim ( [ eqn : cost<=value ] ) is true . by decomposing each cycle into @xmath6-paths as above",
    ", we obtain an integral multiflow @xmath19 whose total flow - value @xmath13 is at least the negative of the total cost of the mincost relaxation problem .",
    "so @xmath19 is optimal .",
    "the claim ( [ eqn : cost<=value ] ) can be seen as follows .",
    "move point @xmath85 in @xmath40 as @xmath680 . in each odd step , the point @xmath85 moves in the negative direction since @xmath681 .",
    "in particular the total move over odd steps coincides with @xmath682 . since the point @xmath85 returns to the initial point , @xmath682 is at most the total move in the positive direction over even steps , which equals the rhs in ( [ eqn : cost<=value ] ) .",
    "the integrality theorem ( theorem  [ thm : integrality ] ) in the previous section is best possible .",
    "the goal of this section is to establish the unbounded fractionality property :    [ thm : unbounded ] let @xmath0 be a directed distance on @xmath6 .    * if @xmath36 , then there is no positive integer @xmath37 such that @xmath0-mfp has a @xmath38-integral optimal multiflow for every network @xmath2 . * if @xmath39 , then there is no positive integer @xmath37 such that @xmath0-mfp has a @xmath38-integral optimal multiflow for every totally eulerian network @xmath2 .    in the following ,",
    "the edge set of a complete digraph ( without loops ) on a set @xmath74 is denoted by @xmath683 .",
    "we regard a function @xmath684 with zero diagonals @xmath685 for @xmath686 as @xmath687 ; we simply denote @xmath688 by @xmath689 .",
    "we utilize edmonds - giles lemma for rational polyhedra ; see ( * ? ? ?",
    "* section 22.1 ) :    for an integer @xmath690 , a rational polyhedron @xmath691 is @xmath38-integral if and only if @xmath692 is a @xmath38-integer for each integral vector @xmath693 for which the minimum is finite .",
    "[ eqn : tdi ]    here a polyhedron @xmath18 is said be _",
    "@xmath38-integral _ if each face of @xmath18 contains a @xmath38-integral vector , and @xmath694 denotes the standard inner product in @xmath695 . for a finite set @xmath696 ,",
    "consider the following two unbounded polyhedra : @xmath697 note that @xmath698 is pointed , and @xmath699 is not pointed .",
    "then @xmath700 is finite if and only if @xmath136 is nonnegative , and if finite , then it equals @xmath701 .",
    "also @xmath702 is finite if and only if @xmath703 is totally eulerian , and if finite , then it equals @xmath701 .",
    "hence it suffices to show :    [ prop : dual_unbounded ] let @xmath0 be a directed distance on @xmath6 , and let @xmath37 be any positive integer .    * if @xmath36 , then @xmath698 is not @xmath38-integral for some @xmath696 . * if @xmath704 , then @xmath699 is not @xmath38-integral for some @xmath696 .    indeed , if a @xmath38-integral optimal multiflow always exists , then the optimal value is always @xmath38-integral , and @xmath698 is @xmath38-integral for all @xmath74 by ( [ eqn : tdi ] ) .",
    "the rest of this section is devoted to the proof of this proposition .",
    "we note the following relation for two metrics @xmath204 on @xmath74 , which follows from the cycle decomposition of a circulation .",
    "@xmath705 if and only if @xmath706 ( @xmath707 ) for some @xmath708 . [ clm : congruent ]      we begin with preliminary arguments . a metric @xmath709",
    "is said to be _ minimal _ if there is no other metric @xmath710 with @xmath198 and @xmath199 , and is said to be _",
    "@xmath711-minimal _ if there is no other metric @xmath710 with @xmath712 and @xmath200 for all cycles @xmath165 .",
    "we first give characterizations of minimal and @xmath711-minimal metrics .",
    "let @xmath66 be a metric on @xmath6 .",
    "then @xmath66 defines the equivalence relation on @xmath6 by @xmath713 @xmath714 @xmath715 .",
    "let @xmath716 $ ] denote the equivalence class including @xmath85 , and let @xmath717 $ ] denote the set of edges from @xmath716 $ ] to @xmath718 $ ] .",
    "an edge @xmath719 is said to be _ extremal _ if there is no edge @xmath720 $ ] with @xmath721 .",
    "an edge @xmath87 is extremal if and only if @xmath722 $ ] is extremal .",
    "so a class @xmath717 $ ] is said to be _ extremal _ if @xmath87 is extremal .",
    "let @xmath723 be the directed graph on @xmath6 with edge set @xmath724 .",
    "[ lem : minimal ] let @xmath66 be a directed metric in @xmath725 .    * @xmath66 is minimal if and only if every extremal class meets an edge in @xmath723 .",
    "* @xmath66 is @xmath711-minimal if and only if every extremal class meets a cycle in @xmath726 .",
    "we note that @xmath727 for @xmath722 $ ] and @xmath728 if @xmath716 = [ y]$ ] .",
    "in particular @xmath87 is never extremal if @xmath716 = [ y]$ ] ( and @xmath729 ) . in most cases",
    ", we may consider the case where each class consists of one edge .",
    "if part : by condition we can not decrease @xmath66 on extremal classes .",
    "consequently we can not decrease @xmath66 on non - extremal classes by the triangle inequality .",
    "only - if part : suppose that some extremal class @xmath717 $ ] fulfills @xmath730 for @xmath731 $ ] .",
    "we can decrease @xmath66 on @xmath717 $ ] with keeping triangle inequality .",
    "( 2 ) . for @xmath732 , let @xmath733 be defined by @xmath734 for @xmath719 . by definition and ( [ clm : congruent ] ) , we see :    * @xmath66 is @xmath711-minimal if and only if @xmath733 is minimal for every @xmath732 with @xmath735 . * the set of extremal edges of @xmath66 is the same as that of @xmath733 .    first we show the if part ( of ( 2 ) ) .",
    "take any @xmath732 with @xmath735 , and take any extremal class @xmath736 $ ] of @xmath733 .",
    "since @xmath736 $ ] is also an extremal class for @xmath66 by ( @xmath737 ) , @xmath736 $ ] meets a cycle @xmath165 in @xmath723 .",
    "therefore @xmath738 .",
    "by @xmath739 , @xmath63 is constant on @xmath165 ; in particular @xmath740 on @xmath165 .",
    "this means that @xmath741 is minimal by ( 1 ) .",
    "thus @xmath66 is @xmath711-minimal by ( @xmath742 ) .",
    "we show the only - if part .",
    "suppose that some extremal class @xmath736 $ ] does not meet any cycle . in this case , there is a node subset @xmath743 such that @xmath744 \\subseteq u$ ] , @xmath745 \\subseteq s \\setminus u$ ] , and there is no edge entering @xmath239 ( consider the strong component decomposition of @xmath723 ) . for a sufficiently small @xmath244 , let @xmath732 be defined by @xmath746 for @xmath747 and @xmath748 for @xmath749",
    ". then @xmath750 and @xmath751 for @xmath752 $ ] .",
    "thus @xmath741 is not minimal , and @xmath66 is not @xmath711-minimal .",
    "second we recall the notion of extreme metrics .",
    "a metric @xmath66 on a finite set @xmath74 is called _ extreme _ if @xmath66 lies on an extreme ray the polyhedral cone @xmath753 formed by all metrics on @xmath74 .",
    "also @xmath66 is _ @xmath711-extreme _ if the projection @xmath754 is extreme in @xmath755 .",
    "we give a family of extreme metrics .",
    "consider the refinement sequence of triangulations of a plane triangle @xmath756 in @xmath757 by congruent triangles , as in figure  [ fig : gamma ] .",
    "let @xmath758 be the metric obtained by restricting @xmath759 to the vertex set of the @xmath760-th triangulation .",
    "[ lem : gamma ] @xmath758 is extreme and @xmath711-extreme .",
    "one can easily verify that @xmath761 is extreme .",
    "suppose @xmath762 for some metrics",
    "we show @xmath764 for some positive @xmath460 .",
    "we observe that the restriction of @xmath758 to each triangle is isometric to @xmath765 , which is extreme . since the triangulation is _",
    "connected _ , we can take a common positive @xmath460 such that @xmath766 for @xmath150 in any triangle .",
    "for an arbitrary pair @xmath150 of vertices , there is a path @xmath767 lying on the triangulation graph such that @xmath768 . by @xmath762 , this equality must hold for @xmath197 .",
    "hence , we have @xmath769 .",
    "thus we have @xmath770 .",
    "next we consider the @xmath711-extremality .",
    "as above , the @xmath711-extremality of @xmath758 @xmath771 reduces to that of @xmath761 by the following observations : for an arbitrary cycle @xmath165 there is a cycle @xmath772 in the graph with @xmath773 , and for an arbitrary cycle @xmath772 in the graph there are cycles @xmath774 each of which belongs to a triangle such that @xmath775 .",
    "the @xmath711-extremality of @xmath761 also follows from a routine calculation , and is left to readers . _",
    "suppose @xmath776 . by ( [ clm : congruent ] )",
    ", @xmath777 implies the same equality for @xmath778 , which in turn implies the same equality for @xmath197 . by using it",
    ", we can show @xmath779 for @xmath780 .",
    "suppose that @xmath0 is a metric . in this case",
    ", @xmath698 is represented as @xmath781 recall the notions in section  [ subsec : tightspans ]  c. then , metric @xmath66 is minimal in @xmath698 if and only if @xmath66 is a tight extension of @xmath0 .",
    "also @xmath66 is @xmath711-minimal in @xmath698 if and only if @xmath66 is a cyclically tight extension of @xmath0 .",
    "we first prove proposition  [ prop : dual_unbounded ]  ( 2 ) .",
    "@xmath306 by proposition  [ prop : slim ] .",
    "we can take a balanced section @xmath108 in @xmath188 containing a @xmath276-dimensional face @xmath230 , which is isometric to a polygon in @xmath275 by ( [ fact : technical ] )  ( 3 ) .",
    "therefore we can take a subset @xmath239 in @xmath230 whose metric induced by @xmath80 is isometric to @xmath782 for some @xmath783 .",
    "fix an integer @xmath690 . by ( [",
    "fact : extension ] )  ( 2 ) , for an arbitrary integer @xmath182 , we can take a cyclically tight extension @xmath66 on @xmath74 having @xmath782 as a submetric .",
    "take a sufficiently large @xmath760 . since @xmath754 belongs to a bounded face of @xmath784 , we can decompose @xmath66 into a convex combination of cyclically tight extensions @xmath785 in modulo @xmath786 such that @xmath787 is an extreme point in @xmath788 for @xmath570 . since @xmath66 has @xmath782 as a submetric and @xmath758",
    "is @xmath711-extreme , some @xmath789 has a submetric @xmath790 with @xmath791 for some @xmath792 .",
    "therefore @xmath793 for some @xmath794 .",
    "since @xmath789 is cyclically tight , it is embedded into @xmath795 .",
    "therefore @xmath796 is bounded by the diameter of @xmath188 ( bounded set ) .",
    "since @xmath760 is sufficiently large , we have @xmath797 .",
    "hence face @xmath798 has no @xmath38-integer vector . proposition  [ prop : dual_unbounded ] ( 1 ) can be shown in a similar manner .",
    "since @xmath1 has a 2-dimensional face , we can take a tight extension @xmath66 having @xmath782 as a submetric .",
    "since @xmath698 is pointed and @xmath66 belongs to a bounded face in @xmath698 by minimality , we can decompose @xmath66 into a convex combination of extreme points in @xmath698 . for a sufficiently large @xmath760 ,",
    "one of the summands is not @xmath38-integral as above .",
    "suppose that @xmath0 is not a metric .",
    "for a distance @xmath799 on @xmath6 and a subset @xmath743 , the restriction of @xmath799 to @xmath239 is denoted by @xmath800 .",
    "[ lem : extend ] let @xmath66 be a directed metric in @xmath698 .    * if @xmath801 is minimal in @xmath725 and @xmath66 is a tight extension of @xmath801 , then @xmath66 is minimal in @xmath698 . * if @xmath801 is @xmath711-minimal in @xmath725 and @xmath66 is a cyclically tight extension of @xmath801 , then @xmath66 is @xmath711-minimal in @xmath698 .",
    "\\(1 ) is obvious from definition . (",
    "2 ) is not so obvious .",
    "we utilize lemma  [ lem : minimal ] by extending @xmath0 to @xmath802 by @xmath803 and @xmath804 for @xmath805 .",
    "take an extremal class @xmath717 $ ] of @xmath66 .",
    "we show @xmath717 \\cap e_s \\neq \\emptyset$ ] .",
    "if true , then @xmath717 \\cap e_s$ ] is also an extremal class in @xmath801 and meets a cycle of @xmath806 by the @xmath711-minimality of @xmath801 ( lemma  [ lem : minimal ]  ( 2 ) ) ; this cycle also belongs to @xmath807 .",
    "extend @xmath801 to @xmath808 by @xmath809 and @xmath810 for @xmath805 . since @xmath66 is a cyclically tight extension of @xmath801 ,",
    "@xmath66 is @xmath711-minimal in @xmath811 . by lemma  [ lem : minimal ]  ( 2 ) , @xmath717 $ ] meets a cycle @xmath165 in @xmath812 .",
    "if this cycle belongs to @xmath813 , then by @xmath814 for @xmath815 the triangle equality we have @xmath716 = [ y]$ ] and thus @xmath717 $ ] is never extremal ; a contradiction .",
    "therefore @xmath165 meets distinct nodes in @xmath6 . by the triangle inequality and @xmath816 on @xmath813",
    "we may assume that @xmath165 includes a path @xmath817 with distinct @xmath818 .",
    "in particular @xmath819 .",
    "since @xmath820 and @xmath87 is extremal , @xmath821 , and thus @xmath822,[y])= ( [ u ] , [ v])$ ] .",
    "so @xmath717 \\cap e_s \\neq \\emptyset$ ] .",
    "our final goal is the following :    [ lem : dominant ] let @xmath0 be a directed distance on @xmath6 .    * if @xmath823 , then there is a minimal metric @xmath66 in @xmath725 with @xmath824 . * if @xmath39 , then there is a @xmath711-minimal metric @xmath66 in @xmath725 with @xmath825 .",
    "assuming the validity of this lemma , we complete the proof of theorem  [ thm : unbounded ] .",
    "we only show ( 2 ) in this theorem ; again ( 1 ) can be shown in a similar way . by this lemma",
    ", we can take a @xmath711-minimal metric @xmath66 in @xmath725 with @xmath825 .",
    "take a cyclically tight extension @xmath197 of @xmath66 such that @xmath197 contains @xmath782 as a submetric for sufficiently large @xmath760 . since @xmath197 is @xmath711-minimal ( lemma  [ lem : extend ]  ( 2 ) ) , @xmath197 is decomposed , in modulo @xmath786 , into a convex combination of @xmath711-minimal metrics @xmath826 such that each @xmath789 is an extreme point of @xmath827 .",
    "some @xmath798 has no @xmath38-integral point , as in the metric case .",
    "let us start the proof . for @xmath220 , let @xmath828 be the set of elements @xmath27 with @xmath829 .",
    "our argument crucially relies on the following claim :    for @xmath220 , there is a minimal metric @xmath830 such that @xmath831 , and @xmath832 [ clm : ek(p ) ]    replacing @xmath63 by @xmath833 for some @xmath460 if necessary , we may assume that @xmath63 is nonnegative .",
    "let @xmath66 be the distance on @xmath6 defined by @xmath834 then @xmath66 is a metric , more precisely , @xmath66 is realized by a subdivision of a star .",
    "we try to decrease @xmath835 for @xmath836 with @xmath837 with keeping the triangle inequality .",
    "since one of @xmath838 and one of @xmath839 are positive , there is no @xmath840 such that @xmath841 or @xmath842 .",
    "let @xmath843 for small @xmath244 and @xmath836 with @xmath837 ; we remark @xmath844",
    ". then @xmath66 does not violate the triangle inequality .",
    "so @xmath66 is not minimal , and we can take a minimal metric @xmath845 with @xmath199 .    [ [ proof - of - lemmalemdominant1 . ] ] proof of lemma  [ lem : dominant ]  ( 1 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    by ( [ fact : technical ] )  ( 2 ) , we can take a point @xmath227 such that @xmath846 has at least @xmath37 components having no @xmath623 with @xmath228 .",
    "take a minimal metric @xmath66 in ( [ clm : ek(p ) ] ) .",
    "let @xmath847 .",
    "consider the restrictions @xmath848 of @xmath0 to @xmath239 and @xmath849 of @xmath63 to @xmath850 .",
    "then @xmath849 belongs to @xmath851 and @xmath852 has @xmath37 components . by ( [ fact : technical ] )  ( 2 ) we have @xmath853 .",
    "one can easily see that @xmath851 is the surjective image of the projection of @xmath1 ; necessarily @xmath854 .",
    "[ [ proof - of - lemmalemdominant2 . ] ] proof of lemma  [ lem : dominant ]  ( 2 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    suppose that @xmath855 for @xmath856 .",
    "we try to find a triple @xmath857 of @xmath743 , a metric @xmath66 on @xmath239 , and @xmath858 such that @xmath66 is @xmath711-minimal in @xmath859 and @xmath860 has at least @xmath157 components , which implies lemma  [ lem : dominant ]  ( 2 ) by ( [ fact : technical ] )  ( 2 ) and the following claim .    for @xmath743 ,",
    "let @xmath66 be a @xmath711-minimal metric in @xmath859 .",
    "then there is a @xmath711-minimal metric @xmath508 in @xmath725 with @xmath861 .",
    "extend @xmath66 to @xmath197 in @xmath725 with @xmath862",
    ". then @xmath197 may not be @xmath711-minimal in @xmath725 .",
    "we can take a @xmath711-minimal metric @xmath508 in @xmath725 such that @xmath863 for all cycles @xmath165 in @xmath6 .",
    "since @xmath66 is @xmath711-minimal in @xmath864 , we have @xmath865 . then @xmath866 is a translation of @xmath867 , and hence @xmath868 .",
    "since every point @xmath869 can be extended to a point in @xmath870 , we have @xmath871 .",
    "we can take @xmath872 such that @xmath873 belongs to the interior of @xmath37-dimensional face in @xmath32 for @xmath856 .",
    "there are three cases :    * @xmath874 has at least @xmath157 components and @xmath875 .",
    "* @xmath874 has at least @xmath157 components and @xmath876 ( @xmath63 belongs to @xmath877 ) .",
    "* @xmath874 has at least @xmath878 components one of which is a ( complete bipartite ) component of nodes @xmath879 ( @xmath63 belongs to the interior of @xmath880 ) .    in the following , for a distance @xmath799 on @xmath6 and a point @xmath99 ,",
    "we denote by @xmath881 the directed graph on @xmath6 with @xmath882 ( possibly including loops ) .",
    "we first consider case ( i ) .",
    "suppose that @xmath883 is strongly connected .",
    "since @xmath875 , by ( [ clm : ek(p ) ] ) we can take a minimal metric @xmath830 and @xmath884 .",
    "so @xmath860 also has at least @xmath157 components ; @xmath825 . by definition and construction , @xmath885 .",
    "therefore @xmath723 is also strongly connected , which immediately implies the @xmath711-minimality of @xmath66 by lemma  [ lem : minimal ]  ( 2 ) .",
    "thus @xmath886 is a required triple .",
    "suppose that @xmath883 is not strongly connected .",
    "take a chordless cycle @xmath887 ( without repeated nodes ) .",
    "since @xmath875 , equivalently , @xmath883 has no loop , the cycle length @xmath567 is at least two .",
    "suppose @xmath888 .",
    "then let @xmath889 , and @xmath890 ( the restriction of @xmath63 to @xmath850 ) .",
    "then @xmath891 is a cycle of length @xmath567 , and @xmath892 is a matching of size @xmath567 ( has @xmath567 components ) . according to ( [ clm : ek(p ) ] ) , we can take a minimal metric @xmath893 with @xmath894 and @xmath895 .",
    "thus @xmath896 is strongly connected , and @xmath857 is a required triple .",
    "suppose that there is no simple chordless cycle of length at least @xmath157 in @xmath897 .",
    "since each node has both entering and leaving edges , we can take from @xmath897 two disjoint 2-cycles @xmath898 , @xmath899 without edges from @xmath900 to @xmath901 .",
    "let @xmath902 , and @xmath890 .",
    "again we can take a minimal metric @xmath893 with @xmath895 . for small positive @xmath255 ,",
    "decrease @xmath63 by @xmath255 on @xmath903 and increase @xmath63 by @xmath255 on @xmath904 .",
    "then @xmath860 has four components consisting of four disjoint edges @xmath905 .",
    "suppose that @xmath66 is not @xmath711-minimal ( otherwise @xmath857 is a required triple ) .",
    "so we may assume that @xmath906 has an extremal edge from @xmath907 to @xmath900 , and has no edge from @xmath908 to @xmath901 .",
    "then we can construct a @xmath711-minimal metric from @xmath66 by adding @xmath909 for @xmath244 and decreasing some of @xmath910 . for keeping @xmath894 , decrease @xmath63 by @xmath255 on @xmath903 and increase @xmath63 by @xmath255 on @xmath904 .",
    "then the resulting @xmath860 is a matching consisting of the four edges .",
    "thus @xmath857 is a required triple .",
    "next we consider case ( iii ) .",
    "let @xmath911 and let @xmath890 .",
    "then @xmath912 has no isolated node .",
    "obviously , @xmath912 has at least @xmath157 connected components , and @xmath913 .",
    "thus @xmath914 .",
    "therefore , the situation reduces to case ( i ) .",
    "finally we consider case ( ii ) .",
    "we use the same projection idea .",
    "take @xmath915 .",
    "let @xmath916 and @xmath917 be the sets of nodes @xmath224 covered only by @xmath918 and @xmath919 , respectively .",
    "suppose @xmath920 .",
    "then let @xmath921 , and let @xmath890 .",
    "then @xmath828 decreases , @xmath922 , and @xmath912 has at least @xmath157 connected components .",
    "suppose that both @xmath923 and @xmath924 are nonempty .",
    "for a small positive @xmath255 , decrease @xmath63 by @xmath255 on @xmath925 and increase @xmath63 by @xmath255 on @xmath926 .",
    "then @xmath828 decreases , @xmath872 , and @xmath874 has at least @xmath927 connected components .",
    "suppose that one of @xmath923 and @xmath924 , say @xmath924 , is empty .",
    "then @xmath919 is necessarily incident to @xmath928 ; otherwise @xmath63 is a proper fat relative to @xmath929 , a contradiction . for a small positive @xmath255 ,",
    "decrease @xmath63 by @xmath255 on @xmath923 and increase @xmath63 by @xmath255 on @xmath918 . again",
    "@xmath872 ( @xmath919 is still covered ) , and @xmath874 has at least @xmath878 connected components ; repeat it until @xmath875 .",
    "after that , the situation reduces to case ( i ) .",
    "we thank the referee for careful reading and helpful comments . the first author is supported by a grant - in - aid for scientific research from the ministry of education , culture , sports , science and technology of japan .",
    "the second author is supported by nanzan university pache research subsidy i - a-2 for the 2008 academic year",
    ".        a. w. m. dress , trees , tight extensions of metric spaces , and the cohomological dimension of certain groups : a note on combinatorial properties of metric spaces , _ advances in mathematics _",
    "* 53 * ( 1984 ) , 321402 .",
    "a. frank , on connectivity properties of eulerian digraphs , in : _ graph theory in memory of g. a. dirac _",
    "( sandbjerg , 1985 ; l. dvling andersen , i. tafteberg jakobsen , c. thomassen , b. toft , p.d .",
    "vestergaad , eds . ) , north - holland , amsterdam , 1989 , pp ."
  ],
  "abstract_text": [
    "<S> in this paper we address a topological approach to multiflow ( multicommodity flow ) problems in directed networks . given a terminal weight @xmath0 , we define a metrized polyhedral complex , called the directed tight span @xmath1 , and prove that the dual of @xmath0-weighted maximum multiflow problem reduces to a facility location problem on @xmath1 . </S>",
    "<S> also , in case where the network is eulerian , it further reduces to a facility location problem on the tropical polytope spanned by @xmath0 . by utilizing this duality </S>",
    "<S> , we establish the classifications of terminal weights admitting combinatorial min - max relation ( i ) for every network and ( ii ) for every eulerian network . </S>",
    "<S> our result includes lomonosov - frank theorem for directed free multiflows and ibaraki - karzanov - nagamochi s directed multiflow locking theorem as special cases .    </S>",
    "<S> keywords : multicommodity flows , metrics , min - max theorems , facility locations </S>"
  ]
}