{
  "article_text": [
    "the neolithic ( 10,0004500 bc ) , the last period of the stone age , was the dawn of a new era in the development of the human race .",
    "its defining innovation , the transition from foraging to food production based on domesticated cereals and animals , was one of the most important steps made by humanity in moving toward modern societies . among dramatic changes resulting from the advent of farming were sedentary living , rapid population growth , gradual emergence of urban conglomerates , division of labor and the development of complex social structures .",
    "another important innovation of the period was pottery making .",
    "the mechanism of the spread of the neolithic remains an important and fascinating question .",
    "the most striking large - scale feature of this process is its regular character , whereby farming technologies spread across europe at a well - defined average speed of about @xmath0 km@xmath1year . impressive and convincing",
    "evidence for this emerged as soon as radiocarbon ( @xmath2c ) dates for early neolithic sites became available [ @xcite ] , and later studies have confirmed the early results [ @xcite ] .",
    "figure  [ figrcarb ] displays the @xmath2c dates used in our analysis , and they clearly show the gradual , regular spread of the neolithic over a time span of over 4000 years from its origin in the near east around 9000 years ago , to the north - west of europe .",
    "c - dated early neolithic sites used in our analysis and their age ( calibrated bc , color coded ) .",
    "right - hand panel : the dimensionless diffusivity @xmath3 in the wavefront model ( [ nul ] ) , with a mild linear gradient toward south , local topographic variations , and the gradual decline to zero away from the coastlines . ]",
    "it is worth emphasising that `` the neolithic '' is not a single phenomenon and , although it is often characterized by archaeologists as a `` package '' of related traits , the individual elements of the package need not have been transmitted simultaneously .",
    "this might suggest the need to model each distinct element separately .",
    "however , several elements do appear to have traveled together during the spread of farming into most of europe [ @xcite ] and the local transition to the full package may have been more rapid than has often been assumed [ @xcite ] .",
    "therefore , we choose to model the neolithic spread as a single phenomenon .    despite the overall regular character of the expansion",
    ", there are notable regional variations in the spread of the neolithic [ @xcite ] .",
    "careful analysis of the radiometric and archaeological evidence has identified various major perturbations : first , slowing down at topographic obstacles such as mountain ranges .",
    "second , latitudinal retardation above 54@xmath4n latitude [ @xcite ] , presumably due to competition with the pre - existing mesolithic population , whose density was especially high in the north [ @xcite ] ; the negative influence of the soil type and harsher climate in the north also can not be excluded .",
    "third , significant acceleration along the danube  rhine corridor and the west mediterranean [ @xcite ] ; see also @xcite .",
    "these variations in the rate of spread complicate quantitative interpretations of the @xmath2c data .",
    "moreover , the data themselves are far from being complete and accurate .",
    "there are inherent errors from the radiocarbon measurement in the laboratory [ @xcite ] and uncertainties in the conversion of the @xmath2c into the calendar age , known as the calibration of the @xmath2c dates [ @xcite ] .",
    "further errors result from archaeological factors , such as uncertain attribution of the dated object to the early farming activity , disturbed stratigraphy of archaeological sites , etc .",
    "[ @xcite ] .",
    "perhaps even more importantly , objects related to the first appearance of farming at a given location are not necessarily related to the first arrival of farming to its larger region .",
    "the occupation of many neolithic sites could be a secondary process behind the wave of advance .",
    "the only obvious method to identify such sites is by continuity with its neighbors .",
    "given the obviously random nature of the demographic processes underlying the neolithic expansion , and the abundance of both random and systematic errors in the quantitative ( mainly radiometric ) evidence available , it is clear that serious statistical analysis is required to quantify the spread of the neolithic .",
    "all previous work in this direction has determined the parameter selection for various models and assessed goodness of fit by using parameter scans . to the best of our knowledge ,",
    "the present paper is the first to use formal statistical inference methods to determine appropriate ranges for model parameters and assess the fit of the model .",
    "we use a carefully selected set of @xmath2c dates for the earliest neolithic sites across europe to fit a model of the neolithic expansion .",
    "the model relies on the fundamental fact , established empirically as briefly explained above , that the incipient farming spread at a nearly constant average speed .",
    "we also include regional variations in the speed associated with the latitudinal gradient , topography and major waterways .",
    "our statistical model adopts an error structure which accounts for both measurement error in the radiocarbon dating process and a spatial error process which smooths departures from the wavefront model .",
    "we describe how to obtain the bayesian posterior distribution for the unknown model parameters using simulations from the deterministic model .",
    "simulations of the expanding neolithic front are computationally expensive , even at a prescribed deterministic velocity , precluding their use for bayesian inference .",
    "therefore , we construct a gaussian process emulator [ @xcite ] for the model , that is , a stochastic approximation to the arrival times obtained from this model .",
    "such methods are widely used in the computer models literature ; see , for example , @xcite and references therein . rather than build a complex space  time emulator to describe the wavefront model , we pragmatically build individual emulators for each site and rely on the spatial gaussian error process to smooth across geographical space .",
    "finally , we fit this emulator model to our data and describe the inferences we draw .",
    "the remainder of this paper is organized as follows .",
    "we describe the @xmath2c data used in our analysis in section  [ secradiodata ] .",
    "the implementation of the wavefront model and the statistical model which links the wavefront model to the data are presented in section  [ rdwf ] .",
    "the gaussian process emulator model and its use in constructing an inference scheme are the subject of sections  [ secemulator ] and  [ secinference ] .",
    "finally , the results of fitting our model to the radiocarbon data are reported in section  [ secresults ] , and we conclude with a discussion in section  [ secdiscuss ] .",
    "it is clear from the discussion in section  [ secintroduction ] that @xmath2c data need to be carefully selected for model parameter inference .",
    "databases of radiocarbon dates contain several thousand entries for neolithic sites across europe [ e.g. , @xcite ] , but a relative minority of them are suitable for the studies of the initial spread of the neolithic . in this paper , we use carefully selected @xmath2c dates from 302 earliest neolithic sites in southern and western europe from the compilation of @xcite , where a detailed discussion of the selection criteria can be found .",
    "the objects dated include grains and seeds , pottery , bone , shells and animal horns , wood , charcoal and peat , and soil .",
    "we note that , in general , there may be issues in using such a heterogeneous data set , such as those relating to `` chronometric hygiene '' and the problems that may arise with certain materials or treatments ; see , for example , @xcite and the discussion in @xcite .",
    "however , we are not aware of any issues with the provenance of the samples we use in our analysis ; see @xcite for further details .",
    "the putative origin of the expansion is in an extended region in the near east , and , following the results of @xcite , later confirmed by many authors , it is reasonable to place it near jericho . similarly to @xcite , the starting date and position are adopted as 6572 bc and @xmath5n , @xmath6e ) , the tell kashkashok site near jericho .",
    "many sites in the selection have several dates ( often 310 , and occasionally ) which can be treated as the arrival time contaminated by errors .",
    "each date is published together with the accuracy of radiocarbon measurement in the laboratory , but we recall that other sources of random and systematic errors are present as well .",
    "suppose that , at site @xmath7 , we have @xmath8 calibrated @xmath2c dates @xmath9 ( @xmath10 , @xmath11 ) and their standard deviations @xmath12 .",
    "these data are calculated from the central 99.7% interval of the calibrated probability distributions for each object , obtained using calibration curve intcal04 : @xcite .",
    "specifically , each @xmath9 is taken to be the midpoint of its calibrated interval and @xmath12 to be one - sixth of the length of the interval .",
    "this data set can be found in the supplementary material [ @xcite ] for this paper .",
    "we can calculate summaries for the data at each site , namely , an arrival time @xmath13 and its accuracy @xmath14 , as defined in this context by @xcite , by appropriately weighting the data , as @xmath15    clearly , there is some loss of information in not using the full calibrated probability distribution for each object .",
    "however , to include this within our analysis by using , for example , a normal mixture model representation for each distribution , would make our analysis considerably more complicated . in any case , the model we do use in our analysis is one for the weighted means @xmath13 , whose calibrated distributions will be roughly normally distributed due to the central limit theorem .",
    "the left - hand panel of figure  [ figrcarb ] shows the sites on the map , color - coded according to the arrival time @xmath13 .",
    "the wave of advance model has a deep mathematical basis .",
    "such fronts are the salient feature of a wide class of phenomena that involve an exponential growth of some quantity ( in this case , the population density ) and its spread via random walk or related diffusion ; see @xcite and references therein .",
    "this behavior is captured by the classical equation of @xcite and @xcite , known as the fkpp equation , of the form @xmath16 where @xmath17 is the population density , a function of position @xmath18 and time @xmath19 , @xmath20 is the growth rate of the population ( the difference of the birth and death rates per unit area ) , @xmath21 is the carrying capacity of the landscape ( the maximum sustainable population density ) , and @xmath22 is the diffusivity , a measure of human mobility . for constant  @xmath21 , this equation has obvious solutions @xmath23 and @xmath24 .",
    "solutions of the initial value problem for this equation in a homogeneous domain , with a localized initial condition , have the form of a wave of advance , @xmath25 in one dimension , where the solution changes from @xmath23 ahead of the wavefront to @xmath24 behind it .",
    "the width of the transition region ( an internal boundary layer ) is of order @xmath26 and , in one dimension , the front propagates at a constant speed @xmath27 independently of @xmath21 . in two dimensions , the constant - speed propagation provides a good approximation as soon as the radius of curvature of the front becomes much larger than @xmath28 . for parameter values characteristic of the neolithic expansion  for example , @xmath29 year@xmath30 and @xmath31 km@xmath32 s@xmath30 ( see the discussions in sections  [ sectregvar ] and  [ sectbayesinf ] ) , providing @xmath33 km s@xmath30the front width is @xmath34 km , and the model of a wavefront propagating at a constant speed is safely applicable at the continental scales of 1001000 km .",
    "even though we aim at an inference for the speed of the neolithic expansion , we find it convenient to present our results with reference to the fkpp model .",
    "in particular , @xmath35 is parameterized in terms of @xmath20 and @xmath22 since these quantities admit a direct interpretation in terms of human behavior .",
    "nevertheless , we emphasize that the inference that follows does not depend in any fundamental way on the fkpp equation , or on the assumptions of the demographic processes underlying it ; the results we present may simply be considered as providing statistical constraints on the speed of a wavefront @xmath35 , independently of any interpretation of the mechanisms behind this wave .",
    "a discrete version of the wavefront model , suitable for numerical simulations , is constructed as follows .",
    "we select the point source of the population and then , at a small radius from this point , we arrange a small number of test points ( `` particles '' ) on a circle around it , with the position of particle @xmath7 denoted by @xmath36 , where @xmath37 and @xmath38 are the geographical latitude and longitude , respectively",
    ". this allows us to compute the local tangent and normal vectors of the front , in particular , the local unit outward normal @xmath39 ( in the direction of the advancing front ) . at each time step",
    "we move each particle along @xmath39 with the _ local _ velocity @xmath40 given by ( [ bu ] ) .",
    "the wavefront thus expands outward in time ; in a homogeneous , isotropic domain , the expansion would take the form of concentric circles , but in the heterogeneous and anisotropic domain used here ( described in detail below ) , the expansion is irregular and tracks the front obtained from the corresponding fkpp model . at the continental scale ,",
    "the earth s curvature is noticeable and we work on a spherical surface of the appropriate radius .",
    "the separation of the particles increases as the front expands , and an additional particle is introduced between any two particles if their separation exceeds a specified value @xmath41 .",
    "conversely , if the front contracts , particles that are closer than @xmath42 are removed .",
    "we take @xmath41 to be equal to the grid spacing ( introduced below ) of 4  arc - minutes , that is , between 3 km at 60@xmath4n and 7 km at 30@xmath4n .",
    "it is important to monitor the particle ordering along the front after adding or removing particles in order to maintain a continuous wavefront .    when the front encounters an obstacle ( e.g. , a mountain range ) , its flanks move round it and then have to merge behind the obstacle .",
    "the merger is implemented by applying algorithms initially used to model the evolution of magnetic flux tubes in astrophysical simulations , and so described in more detail in @xcite .",
    "briefly , we check , at each time - step , if any two particles ( which are not neighbors ) are closer than @xmath41 ; if so , the particle ordering is switched to `` short - circuit '' any ( almost closed ) loops that have arisen .",
    "the front then propagates further , leaving behind closed loops which are then removed from the simulation since they do not affect the front arrival time .",
    "the front speed ( [ eqfrontspeed ] ) depends on the product of @xmath20 and @xmath22 , so that these parameters can not be estimated simultaneously from studies of the front propagation .",
    "the growth rate is rather well constrained by biological and anthropological factors : @xcite reports values in the range 0.0290.035 year@xmath30 and @xcite suggest the range 0.0030.03 year@xmath30 . here ,",
    "for comparability with our own recent studies [ e.g. , @xcite ] , we take @xmath29 year@xmath30 , corresponding to a generation time of 30 years .",
    "this choice does not limit the applicability of our model .",
    "if , for example , a slightly different value of @xmath20 is preferred , then the reported values of @xmath22 need only to be scaled so that the product @xmath43 remains unchanged .    to make the problem tractable",
    ", we adopt a specific spatial variation of the diffusivity and seek inference for its magnitude , just a single scalar parameter .",
    "such assumptions unavoidably involve significant arbitrariness ; however , a well - informed assumption is justifiable if it results in a model that fits the observations to a satisfactory degree .",
    "thus , we represent the diffusivity in the form @xmath44 where @xmath45 is the constant - dimensional magnitude and @xmath3 is a dimensionless function of position whose magnitude is of order unity and whose form is assumed to be known .",
    "we prescribe @xmath3 to depend solely on the topography ( altitude above the sea level ) and latitude as described below .",
    "early farming does not appear to have been practical at high altitudes in the temperate zones considered here [ e.g. , sites in the alpine foreland are not found on land above 1 km : @xcite ] ; to include this effect in our model , we smoothly reduce @xmath3 to zero at around this height .",
    "also , in order to allow for coastal sea travel , @xmath3 exponentially decreases with the distance @xmath46 to the nearest land .",
    "finally , we include a linear decrease of @xmath22 toward the northern latitudes .",
    "altogether , we adopt the following form for the dimensionless diffusivity : @xmath47 where @xmath48 is the altitude , @xmath49 is the latitude , and we recall that @xmath50 corresponds to the seas .",
    "both @xmath48 and @xmath46 are complicated functions of position reflecting the topography and coastlines of europe . of course",
    ", the choice of these particular forms are only a crude and exploratory attempt to capture the dependence on latitude and altitude .",
    "however , we have found our results not to be too sensitive to minor changes in these functions .",
    "the altitude data have been taken from the etopo1 1-minute global relief database [ @xcite ] . as a reasonable compromise between computational efficiency and spatial accuracy",
    ", we use a @xmath51 grid with a spatial resolution of 4 arc - minutes between @xmath52w and @xmath53e in longitude and @xmath54n and @xmath55n in latitude .",
    "the boundaries of the domain explored and the spatial variation of @xmath3 are shown in figure  [ figrcarb ] .",
    "significant regional anomalies revealed by archaeological and radiometric evidence are the early neolithic linearbandkeramik ( lbk , linear pottery ) culture that propagated in 55004900 bc along the danube and rhine rivers at a speed of at least 4 km@xmath1year [ @xcite ] and the impressed ware culture ( 50003500 bc ) that spread along the west mediterranean coastline at an even higher speed .",
    "the latter could be as high as 10 km@xmath1year [ @xcite ] .",
    "@xcite included directed spread ( advection ) along the major river paths and coastlines into their mathematical model to achieve a significant improvement in the fit to @xmath2c dates .",
    "we include advection along the danube ",
    "rhine river system and the coastlines using world map data from @xcite , in the form of tangent vectors of the coastlines and river paths , @xmath56 and @xmath57 , respectively , given at irregularly spaced positions . to remap the data to the regular grid introduced above",
    ", we use the original data weighted with @xmath58 , where @xmath59 is the distance between the grid point and the data point , and the chosen scale of 15 km contains 25 grid separations at latitudes 30@xmath460@xmath4n .    with the unit tangent vectors for the coastlines and river paths",
    "thus defined , the magnitudes of the respective local front velocities , @xmath60 and @xmath61 , are subject to inference .",
    "in other words , the local front velocity is given by @xmath62 where @xmath63 .",
    "since , unlike the geographical data , the points defining the front are not necessarily at the nodes of the regular grid , we used bilinear interpolation from the four closest grid points to calculate @xmath3 ( and thus @xmath35 ) , @xmath56 and @xmath57 at the front positions .",
    "we note that the accuracy of the wavefront model was tested by comparing it with numerical solutions of ( [ eqfkpp ] ) for a wide range of parameter values ; the agreement was invariably quite satisfactory with a typical deviation of 40 years .",
    "we model the radiocarbon dates for each object at each site as being a noisy version of those dates predicted by the wavefront model , explicitly allowing for three types of error introduced in section  [ secintroduction ] : the date @xmath9 of object @xmath64 at a site @xmath7 ( location @xmath65 ) , for @xmath10 , @xmath11 , is modeled as @xmath66 where @xmath67 is the deterministic wavefront arrival time , a function of @xmath68 , and @xmath69 and @xmath70 are independent error terms following a standard normal distribution . here",
    "@xmath71 allows for spatially inconsistent data , @xmath12 is the standard deviation of the @xmath2c measurement in the laboratory and calibration , and @xmath72 is a global error term . between them , the @xmath73 and @xmath72 terms allow for mismatches between our model and the data : @xmath73 allows for a certain level of variability between the arrival times at nearby sites , while @xmath72 allows for an additional global variability ( with no spatial correlation ) . as well as the mismatch arising when a simple large - scale model is applied to a process with inherent variability on smaller scales , these terms will also allow our model to be fairly robust to any problems in our radiocarbon data such as the misinterpretation of sites of secondary neolithic occupation as being indicative of the wave of first arrival .",
    "we note that some authors [ e.g. , @xcite ] choose to model the start - date of a `` first arrival phase '' using an additional parameter for each site , with the explicit expectation that all individual samples will fall after this date . however , our wavefront model attempts to capture the neolithic transition over much larger spatial and temporal scales and so we choose not to incorporate such detailed temporal effects .",
    "we model the spatially smooth error process @xmath73 using a zero mean gaussian process ( gp ) prior [ @xcite ] with covariance function @xmath74 , that is , @xmath75 we impose smoothness by taking a gaussian kernel for the covariance function so that the covariance between spatial errors at locations @xmath18 and @xmath76 is @xmath77 the parameters of this function control the overall level of variability and smoothness of the process , with larger values of the length scale @xmath78 giving smoother realizations and thereby down - weighting sites with different dates relative to nearby sites .    in the following analysis it will be more straightforward to work with an equivalent model for the summary statistics @xmath79 in ( [ eqtisigmai ] ) , namely , @xmath80 where the @xmath81 and @xmath82 are independent error terms following a standard normal distribution .",
    "thus , the inferential task is to make plausible statements about the wavefront model parameters @xmath83 , the global error term @xmath72 and the gaussian process hyperparameters @xmath84 and @xmath78 .",
    "we adopt a bayesian approach to inference and express our prior uncertainty for the unknown quantities through a density @xmath85 .",
    "the speed of spread reported by @xcite , together with the growth rate discussed in section  [ sectregvar ] , suggests @xmath86 km@xmath32year .",
    "the spread reported for the lbk culture [ e.g. , @xcite ] suggests @xmath87 km@xmath1year . the spread reported for the impressed ware culture [ @xcite ] would suggest @xmath88 km@xmath1year . however",
    ", this study is restricted to the western mediterranean and we believe this parameter would take a smaller value over the european continent such as @xmath89 km@xmath1year .",
    "we do not expect the wavefront model to fit the data well in all regions , so we expect a relatively large value of @xmath72 ( compared with the accuracy of individual dates ) , @xmath90 years .",
    "the magnitude of @xmath84 , which models the variability in dates between spatially nearby sites , is difficult to estimate , but the maximum accuracy of laboratory radiocarbon measurements ( which will probably be the smallest source of variability within our model ) suggests a minimum significant value of @xmath91 years .",
    "the mean minimum separation of radiocarbon - dated sites suggests @xmath92 .",
    "we use the values above to guide our choice of mode for the prior distribution . in view of the uncertainties in these values",
    ", we make the prior rather diffuse , with independent components .",
    "specifically , we use the log - normal and inverse - gamma distributions , with @xmath93 let @xmath94 and @xmath95 denote the observed arrival times and those from the wavefront model ( evaluated at @xmath83 ) .",
    "then , using ( [ statmodel ] ) , the data model is an @xmath96-dimensional normal distribution , with @xmath97 where @xmath98 , @xmath99 has @xmath100th element @xmath101 , and @xmath102 are the locations of the radiocarbon - dated sites .",
    "combining both sources of information ( the data / model and the prior ) gives the joint posterior density as @xmath103 in practice , the posterior density is analytically intractable and we therefore turn to a sampling - based approach to make inferences .",
    "markov chain monte carlo ( mcmc ) methods can readily be applied to this problem , but such schemes will typically need many thousands or millions of evaluations of @xmath104 , each requiring a full simulation of the wavefront model expanding across the whole of europe .",
    "this takes around 10 seconds on a quad - core cpu with a clock speed of 2.67 ghz and the code parallelized using openmp .",
    "this computational cost prohibits the use of an mcmc scheme for sampling from the posterior distribution of the unknown quantities . to proceed , we therefore seek a faster approximation of the first arrival times from the wavefront model .",
    "the first arrival times from the wavefront model can be approximated by using both deterministic and stochastic methods such as cubic splines and gaussian processes , respectively . these approximations ( known as emulators ) are determined by first setting up an experimental design consisting of a number of locations and parameter values , and then computing the ( deterministic ) first arrival times from the wavefront model using the locations and parameter values in the design . finally , the proposed emulator is fitted to this model output . in line with many other authors , for example , @xcite and @xcite",
    ", we favor using gaussian processes to emulate the first arrival times , as they not only fit this model output exactly and interpolate smoothly between design points but also quantify levels of uncertainty around interpolated values . rather than build a complex emulator whose inputs are both site location and wavefront model parameters , we pragmatically build individual ( parameter only ) emulators for each site and rely on a spatial gaussian error process to smooth the resulting spatial inhomogeneities .",
    "this strategy is viable because the inference scheme described later in section  [ secinference ] only requires emulation at the 302 sites in the radiocarbon data set .",
    "one possible drawback is that it does produce site - specific emulators that are not as spatially smooth as the more complex emulator .",
    "however , there are significant computational benefits of building separate emulators for each of the 302 sites , as they work in a smaller input space and can be computed in parallel .",
    "the output from a single simulation of the wavefront model with input parameter values @xmath68 gives the front arrival time for all sites .",
    "consider the arrival time @xmath105 at a single site @xmath7 .",
    "we model the emulator for the arrival time at this site using a gaussian process with mean function @xmath106 and covariance function @xmath107 , that is , @xmath108 a suitable form for the mean function can be determined by noting that the great - circle distance @xmath28 from the source of the wavefront is approximated by @xmath109 , where @xmath110 is the front speed given by ( [ bu ] ) and @xmath111 is the arrival time .",
    "hence , @xmath112 and therefore we seek @xmath113 where @xmath114 are coefficients to be determined , which account for the relative importance of diffusivity , coastal and river speeds .",
    "we determine them using ordinary least squares fits .",
    "note that the mean function depends on @xmath115 to be consistent with  ( [ eqfrontspeed ] ) .",
    "we use a stationary gaussian covariance function @xmath116 where @xmath117 is the length scale at site @xmath7 along the @xmath118-axis , as is widely used in similar applications since it leads to realizations that vary smoothly over the input space [ @xcite ] .",
    "we describe how to make inferences about the parameters @xmath119 of these site - specific covariance functions in section  [ secemfit ] .",
    "suppose that @xmath120 simulations of the ( computationally expensive ) wavefront model are available to us , each providing the arrival time at each radiocarbon - dated site .",
    "let @xmath121 denote the @xmath120-vector of arrival times resulting from the wavefront model with input values @xmath122 , where @xmath123 .",
    "from ( [ eqgprelation ] ) we have @xmath124 where @xmath125 is the mean vector with @xmath64th element @xmath126 and @xmath127 is the variance matrix with @xmath128th element @xmath129 .",
    "we can use the simulations to model the front arrival times corresponding to other values of the input parameters . indeed , suppose we need to simulate front arrival times at a collection of @xmath130 new design points @xmath131 .",
    "this is straightforward as , with the local emulators , the arrival times are mutually independent and the distribution of the arrival time @xmath132 at site @xmath7 conditional on the training data @xmath133 can be determined using standard properties of the multivariate normal distribution as @xmath134 where @xmath135 note that , to simplify the notation , we have dropped the dependence in these expressions on the hyperparameters @xmath119 , where @xmath136 .",
    "before we can fit the gaussian process emulators , we need to obtain the training data from the wavefront model .",
    "these data are obtained by running the emulators at a particular experimental design ; see section  [ secexptdesign ] for details . given the @xmath2c arrival times and the training data ,",
    "it is possible in theory to fit the emulator and statistical model ( [ statmodel ] ) jointly using an mcmc scheme .",
    "however , this is likely to be extremely computationally expensive , and we therefore fit the emulator and the statistical model separately .",
    "this approach is advocated by @xcite and adopted by @xcite , among others .",
    "details on how we fit the emulators and demonstrate their accuracy can be found in sections  [ secemfit ] and  [ secemval ] .",
    "we are now in a position to build an inference algorithm using the site - specific stochastic emulators @xmath137 instead of the deterministic wavefront model @xmath67 . in doing so , we fix each emulator s hyperparameters @xmath138 at their posterior mean .",
    "it is possible to undertake inferences allowing for uncertainty in the hyperparameters .",
    "we describe methods for doing this in section  [ sechyperuncer ] and also show that allowing for such uncertainty in our analysis has only a very minor affect on the posterior distribution and hence on our inferences .    using the subscript @xmath139 to denote the use of the emulators , the ( joint ) posterior density for the unknown parameters in the statistical model , replacing ( [ statmodel ] ) , is @xmath140 where @xmath141 @xmath142 has @xmath7th element @xmath143 and , to allow for emulator uncertainty , we redefine @xmath144 , where @xmath145 . sampling from the posterior distribution ( [ jpstatm ] )",
    "can be achieved by using a metropolis ",
    "hastings scheme similar to that described in section  [ secemfit ] .",
    "specifically , we use correlated normal random walks to propose updates on a log - scale in separate blocks for @xmath83 , @xmath72 and the parameters @xmath146 that govern spatial smoothness .",
    "the covariance structure of the innovations was chosen using a series of short trial runs .",
    "we found that running the mcmc scheme for 1 m iterations after a burn - in of 100k iterations and thinning by taking every 100th iterate gave a sample of @xmath147k ( effectively uncorrelated ) values from the posterior distribution .",
    "figure  [ figpostplots ] shows the marginal and joint posterior densities of the key parameters of the wavefront model ( the diffusivity @xmath45 , the coastal velocity @xmath60 and the river - path velocity @xmath61 ) and also the parameters of the statistical model ( the global error @xmath72 , and the gaussian process hyperparameters @xmath84 and @xmath78 ) .",
    "the reduction in uncertainty from the prior to the posterior , which is considerable for most parameters , shows that the data have clearly been informative .",
    ", @xmath60 and @xmath61 , and marginal posterior densities ( bottom row , left to right ) for the residual uncertainty parameter @xmath72 and the spatial gp hyperparameters @xmath84 and @xmath78 .",
    "the prior densities are shown in dashed red . ]",
    "the posterior distributions of the wavefront model are in reasonable agreement with the range of values suggested by previous studies .",
    "for example , the mode of the marginal posterior for the diffusivity @xmath45 is around 20 km@xmath32year , which corresponds to a global rate of spread of @xmath148 km@xmath1year .",
    "the modal values for the amplitudes of the advective velocities , @xmath149 km@xmath1year and @xmath150 km@xmath1year , are rather lower than the values suggested in the archaeological literature which motivated their study [ @xcite ] . regarding the coastal speed @xmath60 ,",
    "this could be explained by an accelerated spread only being required in the west mediterranean , whereas our model applies it to the whole european coastline ; an alternative model , allowing regional variations in coastal effects , may produce different results .",
    "the relatively small value for @xmath61 is perhaps more surprising , given the prevailing archaeological picture of relatively rapid spread of the lbk culture in the danube and rhine basins .",
    "it may be that the earliest dates associated with the lbk culture do not correspond particularly well to spread as a continuous wave and that an alternative model might also be preferable here . after taking account of the overall level of fit of our current model , the dates within this region",
    "are satisfactorily explained with a relatively weak advective enhancement of the background diffusive spread .",
    "it is also plausible that the slightly enhanced value of @xmath45 ( compared with many of the studies cited in section  [ secintroduction ] ) results in the relatively low values for @xmath60 and @xmath61 .    the marginal posterior distribution for the global error parameter @xmath72 is centred on a value of around 575 years ( see figure  [ figpostplots ] ) .",
    "this value quantifies the mismatch between our mathematical model of the spread and the local variations present in the actual spread .",
    "thus , our inference suggests that a simple large - scale wave of advance , while remaining a good model on the continental scale , should only be considered a good model on time scales of order 600 years ( and thus length scales of order 600 km ) or greater ; on shorter time scales , significant local variations should be expected .",
    "mismatch between model and data is also allowed in our spatial term , @xmath73 ; the marginal posterior distributions for its amplitude ( @xmath151 ) and length scale ( @xmath152 ) are relatively tightly peaked around values of order 30 years and @xmath153 , respectively .",
    "the latter value suggests that correlations between dates at nearby sites are effectively significant within distances of order 750 km .",
    "( note that this is approximately the length scale on which @xmath72 suggests that the variations should be expected within the large scale model , so that the two results are consistent . )",
    "however , the amplitude @xmath151 is relatively small compared with @xmath72 , suggesting that `` within region '' variation is not particularly significant , in comparison with larger scale deviations from the model .",
    "we can examine the operation of the spatial gaussian process in more detail by looking at its distribution at various sites .",
    "now @xmath154 where @xmath155 and so posterior realizations from the spatial process can be obtained using the mcmc output @xmath156 , @xmath157 , by simulating from @xmath158 , @xmath157 .",
    "for example , the posterior spatial process at the uk site monamore ( @xmath159w , @xmath160n ) has mean 21.7 years and standard deviation 33.0 years , and this small mean reflects both the good fit of the wavefront model at this site and at its neighboring sites ; see figure  [ figrcarb ] .",
    "in contrast , the french site greifensee ( @xmath161w , @xmath162n ) has mean -726 years and standard deviation 453  years , and this large mean highlights that the data from this site is inconsistent with its neighbors .",
    "we use predictive simulations to assess the validity of the statistical model and thereby the underlying model of the propagating wavefront .",
    "the ( joint ) posterior predictive distribution of the arrival times @xmath163 at the @xmath164 radiocarbon sites can be determined in a similar way to that for the ( posterior ) spatial process .",
    "first we have @xmath165 where @xmath166 and @xmath167 is the spatial gaussian process evaluated at the sites",
    ". we can integrate over @xmath168 in closed form using ( [ eqzeta ] ) to obtain @xmath169 and thereby determine the predictive arrival time distribution by simulating realizations from @xmath170 , @xmath157 .",
    "figure  [ pred ] shows the radiocarbon dates for four randomly chosen sites together with their posterior predictive    c dates ( red squares , displaced vertically for presentation purposes ) and their predictive densities ( solid ) for four randomly chosen sites : monamore ( @xmath171 ) , vrsnik - tarinci ( @xmath172 ) , galabnik ( @xmath173 ) and greifensee ( @xmath174 ) . ]",
    "distributions determined using this simulation technique .",
    "these sites are at monamore ( @xmath159w , @xmath160n ) , vrsnik - tarinci ( @xmath175e , @xmath176n ) , galabnik ( @xmath177e , @xmath178n ) and greifensee ( @xmath161w , @xmath162n ) .",
    "the @xmath2c dates cluster very close to the mode of the posterior densities in three cases and the discrepant site ( d ) is the one discussed in the previous section whose data is not consistent with its neighboring sites .",
    "very encouragingly , we found similar clustering of site dates around their predictive mode for around 90% of the 302 sites .",
    "we conclude that the wavefront model ( or more properly , the emulators ) provides an adequate description of the data .",
    "figure  [ smoothedpred ] illustrates how the wavefront moves across europe via a map of the means of the posterior predictive distributions ( figure  [ pred ] ) generated by interpolating the mean arrival time at each site onto a regular mesh , using cubic interpolation with the matlab routine ` griddata ` . in the same figure we also display the standard deviation of the predictive distributions interpolated in the same manner , highlighting areas where there is large uncertainty in the timing of the wavefront arrival from our model",
    "our main goal in this paper has been to develop generic statistical tools rather than to propose a more complex model for the spread of the neolithic than , for example , @xcite , @xcite and @xcite .",
    "our approach to inferring parameters of the neolithic expansion is based on a direct application of the wavefront model . to alleviate the computational demands of the mcmc scheme",
    ", we constructed gaussian process emulators for the arrival time of the wavefront at each of the 302 radiocarbon - dated sites in our data set , with the input parameters obtained from the wavefront model .",
    "this approach has been shown to perform well and is likely to do so for other spatio - temporal models that have complex space  time dependencies and are slow to simulate .",
    "this paper represents the first attempt of statistical inference for quantitative models of the neolithic dispersal based on modern statistical methods , providing an opportunity for a more detailed and reliable analysis of the data than ever before .",
    "we have improved upon earlier model fitting for the neolithic expansion by avoiding the introduction of a maximum precision of the early neolithic @xmath2c age determinations at 100200 years , obtained as the minimum empirical standard deviation of @xmath2c dates in large homogeneous data sets for key neolithic sites [ @xcite ] .",
    "in fact , results presented here remain unaffected when such a maximum precision is introduced .",
    "this was not the case with the earlier analyses , and the robustness of the inference procedure suggested here is encouraging .",
    "we believe that we have demonstrated the usefulness of our method as a generic tool and that adopting a statistically rigorous approach constitutes a significant advance on previous `` wave of advance '' models of the neolithic .",
    "the posterior distribution of the parameters of our wavefront model ( @xmath179 ) provides clearly bounded constraints on the human processes underlying the spread of farming .",
    "also , the posterior distribution of the parameters of our statistical model ( @xmath180 ) allows a quantitative assessment of the utility of our wavefront model ( including the limits of applicability of such a large - scale model to smaller regions ) .",
    "the latter point has important implications for the archaeological interpretation of the neolithic transition in europe and should contribute to the ongoing debate about the characterization of the spread as a continuous phenomenon .",
    "for example , @xcite argues that the expansion of farming was characterized by sporadic events , punctuated by long periods without outward expansion ; rowley - conwy includes the spread of the lbk and impressed ware cultures as rapid events of this type . in light of the difficulties encountered here in modeling these spreads , noted in the previous section",
    ", it would be of interest to consider alternative models , which are perhaps better able to model the expansion within the relevant regions .    in terms of future work",
    ", the wavefront model can be improved in several respects .",
    "most importantly , a more detailed description of regional variations appears to be necessary . in particular",
    ", @xmath2c data suggest that the accelerated spread along the coastlines is most pronounced in the western mediterranean and around the iberian peninsula , but not on the north sea and black sea coasts",
    ". the approach presented here can be readily generalized to include such a variation and to provide a useful estimate or an upper limit on the coastal propagation speed in northern europe .",
    "also , our understanding of the neolithic spread can be enriched by adding other parameters to our model , such as the starting time and position of the source of the neolithic expansion , and even additional sources as suggested by @xcite , based on the @xmath2c evidence and corroborated by @xcite using archaeobotanical evidence .",
    "another major improvement would be to use the published @xmath2c dates directly for inference , rather than combining them at each site as in ( [ eqtisigmai ] ) .",
    "model fits to the original radiocarbon data without preliminary selection , unavoidably involving subjective and possibly poorly justified criteria , have never been attempted in the studies of the neolithic [ @xcite ] .",
    "a perennial question in the ongoing debate about the nature of the neolithic is the mechanism of the spread of the agropastoral lifestyle .",
    "the wavefront model used here applies equally well to demic spread , involving migration of people , and to cultural diffusion , that is , the transition to farming due to indigenous adaptation and knowledge transfer [ @xcite ] .",
    "however , cultural diffusion may be modeled more explicitly , in terms of multiple , mutually - interacting populations ; see , for example , @xcite , @xcite and @xcite .",
    "we intend to explore the fit of some of these other models and to determine how plausible these different models are as explanations of the radiocarbon data .",
    "in order to fit the emulators , we first need to obtain the training data by running the wavefront model at a suitable choice of @xmath83-values .",
    "computing resources available to us allowed a @xmath181-point design .",
    "although using a regular lattice design is appealingly simple , it is not particularly efficient . instead",
    ", we adopt a more commonly used design for fitting gaussian processes , namely , the latin hypercube design ( lhd ) [ @xcite ] . designs of this class are space - filling in that they distribute points within a hypercube in parameter space more efficiently than a lattice design .",
    "our 200-point lhd was constructed using the ` maximin ` option in the matlab routine ` lhsdesign ` .",
    "we set the lower bounds of the hypercube to be the origin and used the upper one percentiles of the prior distribution as its upper bounds .",
    "the routine then simulated 5000 lhds and took the design which maximized the minimum distance between design points .",
    "we then used a sequential strategy in which we repeatedly ran the inference algorithm ( described in the following section ) , used the results to determine a conservative estimate of a hypercube containing all points in the mcmc output ( and therefore plausibly containing all of the posterior density ) , and then generated another lhd .",
    "the final lhd used for inferences on @xmath182 in this paper is contained within the hypercube @xmath183 .      at site",
    "@xmath7 , this essentially requires the determination of the posterior distribution of the emulator s hyperparameters using the training data @xmath133 from the wavefront model evaluated at the emulator s design points .",
    "we adopt fairly diffuse independent log - normal priors for the gp hyperparameters , with @xmath184 and @xmath185 .",
    "then their ( joint ) posterior density is @xmath186 where @xmath187 for notational simplicity , we have dropped the explicit dependence of the training data @xmath188 , the mean @xmath189 and the covariance matrix @xmath190 on the training points @xmath191 .",
    "it is fairly straightforward to implement an mcmc scheme to simulate realizations from this posterior distribution .",
    "we used a metropolis ",
    "hastings scheme in which proposals for each hyperparameter were made on a log - scale using ( univariate ) normal random walks .",
    "a suitable magnitude of the innovations ( their variance ) was adopted after a series of short trial runs .",
    "for each site - specific emulator , the mcmc scheme was run for 500k iterations after a burn - in of 50k iterations and the output thinned by taking every 50th iterate , giving a total of 10k ( almost uncorrelated ) iterates to be used for inference .",
    "figure  [ fighyperparam ] shows the marginal posterior densities of the emulator hyperparameters for site 1 , the achilleion     and @xmath192 ( from left to right ) for the achilleion site",
    ". dashed ( red ) curves : the corresponding prior probability densities . ]",
    "site , located at latitude @xmath193n , longitude @xmath194e .",
    "note that these posterior densities have relatively small variability and are robust to the parameter choice for the prior of the hyperparameters , and both these features are typical of all the sites in our data set",
    ".      the accuracy of our fitted emulators as an approximation to the wavefront model can be assessed by using a variety of graphical and numerical methods .",
    "our assessment was based on the fit at a set of parameter values that were not used to fit the emulator : we used a @xmath195-point latin hypercube design @xmath196 .",
    "first , for each site @xmath7 , we obtained the arrival times @xmath197 from the propagating front model .",
    "we then obtained realizations of the emulator at these design points which properly accounted for the uncertainty in the hyperparameters by using ( [ empred ] ) and the realizations from the mcmc fit of the emulator .",
    "plots of the emulator s mean and 95% credible region showed that the emulators provided a reasonably accurate fit to the wavefront output .",
    "we note that these plots were very similar to those determined by fixing the hyperparameters at their posterior means .",
    "we also assessed the fit of our emulators by using a numerical statistic taken from @xcite which compares the emulator output with that from the wavefront model allowing for the site - specific accuracy and correlation between design points .",
    "this statistic is the site - specific mahalanobis distance md@xmath198 , @xmath11 , where @xmath199 which has a scaled @xmath200-distribution in the case of the gp emulator with fixed hyperparameters , with @xmath201 . in our calculations",
    "we have fixed the hyperparameters at their posterior means .",
    "figure  [ figemulatortest ] shows the mahalanobis distance at each     for each site , together with its distribution s upper @xmath202 point ( dashed red line at @xmath203 ) .",
    "right panel : the spatial distribution of sites colored according to the mahalanobis distance .",
    "]    site , together with the upper @xmath202 point of its distribution , and the spatial distribution of the mahalanobis distance .",
    "the figure confirms that the emulators provide a reasonable fit throughout the design space and that there is no obvious spatial dependence in the fit of the emulators .",
    "we note that these diagnostics gave similar conclusions for all values in the posterior sample of @xmath138 and for different lhds without any systematic site - specific biases .    .",
    "left panel : a histogram of all pit values from each of the 302 sites .",
    "right panel : the @xmath204 statistic , computed at each site , assessing the goodness of fit of the pit values to a uniform distribution .",
    "the 95% point of the @xmath205 distribution is plotted as a dashed line . ]    finally , we have assessed the distributional fit of the emulators by calculating the probability integral transform ( pit ) values [ @xcite ] for each site at each of the 100 points in the design .",
    "again , we fix the hyperparameters at their posterior means .",
    "a well fitting emulator should produce values from the standard uniform distribution .",
    "a  histogram of the pit values over all sites is shown in figure  [ figpittest ] .",
    "the figure also shows a summary of how closely the pit values from each site resemble the standard uniform distribution .",
    "here we use a pearson @xmath204 statistic after binning the data into ten equal sized bins and so also show the 95% point of the @xmath205 distribution .",
    "this figure confirms that the emulator fits are satisfactory .      in section  [ secinference ]",
    "we describe how to obtain realizations from the posterior distribution ( [ jpstatm ] ) when fixing the emulator hyperparameters at their posterior mean . here",
    "we extend the method to take account of hyperparameter uncertainty by using their realizations @xmath206 obtained when fitting the emulators .",
    "we first describe an mcmc scheme in which the emulators themselves are marginalized over hyperparameter uncertainty . in this case",
    ", the marginal distribution of @xmath137 can be well approximated by an equally weighted normal mixture , namely , @xmath207 where @xmath208 and @xmath209 are given by ( [ emmean ] ) and ( [ emvar ] ) .",
    "therefore , the ( emulator ) likelihood in ( [ jpstatm ] ) can be written as @xmath210 where @xmath211 is the density of an @xmath96-dimensional normal distribution with mean @xmath212 and covariance matrix @xmath213 , @xmath214 has @xmath7th element @xmath215 and , to allow for the emulator uncertainty , we redefine @xmath216 , where @xmath145 . sampling from the posterior distribution when using this ( emulator ) likelihood can be achieved by using the same methods as described in section  [ secinference ]",
    "however , a major drawback of using this scheme is the time taken to calculate the ( emulator ) likelihood at each iteration .",
    "therefore , we prefer to use an mcmc scheme which uses a joint update for the model parameters and the hyperparameters and has ( [ jpstatm ] ) as a marginal distribution .",
    "specifically , in the joint update , the value proposed for the hyperparameters is sampled from the posterior realizations described above .",
    "although this scheme has a much larger state space , each mcmc iteration is considerably faster than in the marginal scheme and we have found it to have good convergence properties.=1     and for the statistical model parameters @xmath217 allowing for uncertainty in the hyperparameters ( black curves ) and for fixed hyperparameters ( dashed red curves ) . ]    we ran the mcmc scheme for 1 m iterations ( after a burn - in of 100k iterations ) , and then thinned the output taking every 100th iterate to leave an effectively uncorrelated sample of 10k draws from the posterior densities .",
    "figure  [ figpostplotsnew ] shows the marginal posterior distributions allowing for emulator hyperparameter uncertainty and for fixed hyperparameters .",
    "we note that it is difficult to distinguish between these cases .",
    "similar conclusions were found ( when comparing fixed with uncertain hyperparameters ) for the site - specific posterior distribution of the spatial process @xmath218 and for the predictive distributions @xmath219 .",
    "the authors would like to thank an editor and three anonymous referees for their constructive comments on an earlier draft ."
  ],
  "abstract_text": [
    "<S> we consider parameter estimation for the spread of the neolithic incipient farming across europe using radiocarbon dates . </S>",
    "<S> we model the arrival time of farming at radiocarbon - dated , early neolithic sites by a numerical solution to an advancing wavefront . </S>",
    "<S> we allow for ( technical ) uncertainty in the radiocarbon data , lack - of - fit of the deterministic model and use a gaussian process to smooth spatial deviations from the model . </S>",
    "<S> inference for the parameters in the wavefront model is complicated by the computational cost required to produce a single numerical solution . </S>",
    "<S> we therefore employ gaussian process emulators for the arrival time of the advancing wavefront at each radiocarbon - dated site . </S>",
    "<S> we validate our model using predictive simulations .    ,    ,    , </S>"
  ]
}