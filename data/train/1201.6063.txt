{
  "article_text": [
    "let us consider an electron beam propagating in vacuum along the @xmath1-axis , subject to transverse and orthogonal electric and magnetic fields @xmath113 and @xmath31 lying in the @xmath26 plane . in this section , we assume the two fields to be spatially uniform , as in standard wien filters , but we will release this assumption later on . if the magnetic field direction makes an angle @xmath32 with the @xmath33-axis , we may write @xmath114 and @xmath115 . as scalar and vector potentials , we may then take @xmath116 and @xmath117 , respectively . in the non - relativistic approximation and neglecting all coulomb self - interaction effects ( small charge density limit ) , the electron beam propagation is described by pauli s equation @xmath15\\tilde\\psi\\ ] ] where @xmath16 is the spinorial two - component wave - function of the electron beam , @xmath17 and @xmath18 are the electron charge and mass , @xmath19 is the derivative with respect to the time variable @xmath20 , @xmath21 is the electron magnetic moment , with @xmath22 the bohr s magneton , @xmath23 the electron @xmath24-factor , and @xmath25 the pauli matrix vector .",
    "we seek a monochromatic paraxial - wave solution with average linear momentum @xmath30 and average energy @xmath118 in the form @xmath119\\tilde u(x , y , z)$ ] , where @xmath120 is taken to be a slow - varying envelope spinor field . inserting this _ ansatz _ in eq .",
    "( [ eq : pauli ] ) and neglecting small terms in the @xmath1 derivatives of @xmath121 , we obtain the paraxial pauli equation @xmath122 where @xmath123 is the laplacian in the beam transverse plane and @xmath124 is the de broglie wavevector along the beam axis . in deriving eq .",
    "( [ eq : utilde ] ) we set @xmath125 , so as to cancel out the average lorentz force on the beam .",
    "equation ( [ eq : utilde ] ) determines the evolution of the spinor field @xmath121 along the axis @xmath1 .",
    "this equation can be solved analytically for the case of a gaussian input beam , as given by @xmath126 $ ] for @xmath9 , where @xmath127 is the beam waist and @xmath128 the input spinor , corresponding to an arbitrary spin superposition @xmath129 .",
    "a straightforward calculation shows that the solution is given by @xmath130 where @xmath131 is the matrix @xmath132 where @xmath133 and the scalar gaussian factor @xmath134 is given by @xmath135 with @xmath136 where @xmath137 and @xmath138 .    the matrix @xmath131 given in eq .",
    "( [ eq : m ] ) corresponds to eq .",
    "2 in the main paper and describes the magnetic - field - induced larmor spin precession during propagation and the associated geometric phases discussed in the main paper .",
    "the precession length @xmath139 corresponds to two full spin rotations .",
    "in addition to the spin dynamics , from eq .",
    "( [ eq : q2 ] ) , we find that the wavefront complex curvature radius @xmath140 in the direction perpendicular to the magnetic field @xmath31 changes periodically with spatial period @xmath141 .",
    "these oscillations correspond to the well known astigmatic lensing effect of the wien filter .      in this section",
    ", we consider `` @xmath52-filter '' field geometries with cylindrical symmetry , described by the following expression for the magnetic field ( with the vector given in cartesian components ) : @xmath142 where the angle @xmath32 is now the following function of the azimuthal angle : @xmath51 where @xmath52 is an integer and @xmath53 a constant . as discussed in the main paper , such a field pattern must have a singularity of topological charge @xmath52 at the beam axis @xmath5 .",
    "in particular , by imposing the vanishing of the field divergence , we find that the radial factor @xmath54 , i.e. , the field vanishes on the axis for negative values of @xmath52 , while it diverges for positive values of @xmath52 . in the latter case",
    ", there must be a field source on the axis .",
    "the electric field will be taken to have an identical pattern , except for a local @xmath57 rotation , so as to balance everywhere the lorentz force .",
    "we are particularly interested in the negative @xmath52 geometries , which do not require to have a field source at the beam axis .",
    "for example , the @xmath59 case corresponds to the standard quadrupole geometry , while @xmath58 corresponds to an hexapole one .",
    "the electron propagation problem in such non - uniform field can only be solved approximately or numerically .",
    "a second - order geometrical optics solution is reported in ref .",
    "@xcite , which includes also a detailed analysis of spin precession but without considering the geometric phase effect ( as well as the magnetic dipole forces ) .",
    "this analysis shows that , to first order , a balanced wien filter having quadrupole or hexapole geometry but vanishing dipole term ( as in our @xmath52-filter ) is already stigmatic , i.e. it preserves the cylindrical symmetry without need for further corrections .",
    "the only beam lensing or distortion effects enter as higher - order aberrations ( i.e. , the @xmath143 term in eq .",
    "( 31 ) of ref.@xcite ) .    to further analyze the behavior of our @xmath52-filter ,",
    "we have performed ray - tracing simulations of the electron propagation for a quadrupole geometry ( @xmath59 ) .",
    "the magnetic and electric fields have been calculated using comsol finite - elements simulation ( www.comsol.com ) .",
    "the ray - tracing routines therein contained have been used to assess the shape of the beam at the exit of the filter starting from an input beam having 100 kev of enery that is shaped as a ring , with a radius @xmath66 of 100 @xmath65 m .",
    "the magnetic field at @xmath66 needed to obtain the tuning condition @xmath44 is 3.5 mt , with a corresponding electric field of 575 kv / m .",
    "these are obtained in our geometry with an electrode potential difference of @xmath67 kv and a magnetization of 135 a / mm .",
    "the fields need to be set to the design - values with a precision of 1 part in @xmath68 .",
    "the electron velocity to be used as initial conditions in the simulations must be obtained from a model of the fringe fields . for the simplest description of the input fringe fields ,",
    "i.e. the so - called sharp cut - off fringing field ( scoff ) model , the transverse velocity components remain constant and nil , i.e. @xmath144 , while the @xmath1-component @xmath145 `` just inside '' the filter is given by the following expression : @xmath146 where @xmath147 is the velocity outside the filter .",
    "this condition is derived from the conservation of energy and also ensures the conservation of the canonical momentum of the electrons entering the wien filter and hence the conservation of their wavefront orientation .",
    "projection on the @xmath26 plane of the simulated trajectories of the electrons starting from a circle of radius @xmath64 @xmath65 m .",
    "the trajectories are shown with a color growing darker as @xmath1 is increased.,width=302 ]    the results of ray - tracing simulations are reported in fig .  2 of the main paper and in fig .",
    "[ fig : aberrations ] of the present manuscript , which show how a circle of electron positions representative of the input beam becomes deformed during the propagation into a quadrupole - lobed shape , due to second- or higher - order aberrations . for optimizing the performances of our proposed device , in particular in the spin - polarization filter application , these aberrations should probably be compensated by additional electron optics ( e.g. , octupole electrostatic lenses ) .",
    "nevertheless , even for no aberration compensation , the vortex effect giving rise to the radial separation of the two spin components discussed in the spin - polarization application is expected to be preserved , owing to its topological stability .",
    "we now evaluate the effects of the force associated with the magnetic dipole of the electrons in the magnetic field gradient of the wien filter .",
    "this is the force used in stern - gerlach experiments and the only spin - dependent force acting on the electrons , so it is important to assess its effects in detail . at",
    "any given point inside the filter , assuming that the magnetic dipole of the electron is @xmath148 , where @xmath149 is the corresponding spin vector , the associated magnetic force is @xmath150 where the gradient must be taken while keeping @xmath151 constant , i.e. acting only on the magnetic field coordinates .",
    "for our classical estimate , the magnetic dipole evolution can be described by the precession equation @xmath152 assuming a starting magnetic moment parallel to the @xmath1 axis , the magnetic dipole will rotate around the local magnetic field direction . in the approximation in which aberrations are neglected , each electron travels along a parallel ray with constant transverse coordinates , and hence sees a uniform magnetic field , given by eq .",
    "( [ eq : b ] ) .",
    "therefore , the magnetic dipole at any given point inside the filter will be given by the following expression : @xmath153 \\label{eq : mu}\\end{aligned}\\ ] ] where @xmath154 is the total spin precession angle at @xmath1 , for a trajectory at radius @xmath66 .",
    "taking the scalar product between @xmath151 and @xmath31 and then the gradient with respect to the coordinates of @xmath31 only , we find that the magnetic dipole force is only directed along the azimuthal direction and given by @xmath155 where @xmath156 denotes the unit vector along the azimuthal direction and we have used eq .",
    "( [ eq : alpha ] ) for taking the @xmath157 derivative .",
    "equation ( [ eq : f ] ) can be used for two purposes .",
    "first , we can verify that the ray deflection inside the wien filter due to this force is negligible .",
    "indeed , integrating the force in the time @xmath158 needed for a full @xmath159 rotation of the spin ( or spin flip ) , we obtain the overall momentum change @xmath160 we can see from this equation that the momentum variation is of the same order as the quantum uncertainty in momentum of the electron wavefunction , taking into account that the position uncertainty is of the same order of the beam size @xmath66 ( as it is also expected based on bohr impossibility theorem , as discussed further below ) .",
    "this momentum change produces negligible effects in the electron propagation across the filter , although it instead becomes relevant in the far field . indeed ,",
    "it is precisely this force that produces the orbital angular momentum change at the basis of our spin selection .",
    "indeed , we will now show that the torque associated with the magnetic dipole force is that responsible for the oam change of the electrons .",
    "the @xmath1-component torque of this force is given by @xmath161 where @xmath162 is the @xmath1 component of the electron spin angular momentum @xmath149 . since this torque acts on the oam of the electrons @xmath163 , we find the following angular momentum coupling law : @xmath164 once integrated for the entire flight time , corresponding to a full spin flip , this coupling law returns the same result reported in the main paper for the oam variation induced by the spin flip .",
    "this correspondence proves that the effect , and the only effect , of the magnetic dipole force acting on the electrons is the change of oam already considered by including the geometric phase shift in the wavefunction emerging from the filter .",
    "therefore , the only significant effect of this force appears in the far field and is exactly the effect that we propose to utilize to separate electrons according to their spin .",
    "the actual fringe fields depend on the electrodes and magnetic poles geometry .",
    "it is however safe to assume that the fringe fields extend only for a longitudinal distance along the @xmath1 axis that is comparable to the transverse aperture of the wien filter , and therefore much smaller than the filter length , in the large length - to - gap ratio limit .",
    "moreover , the transverse components of the fringe fields can be taken to have exactly the same multipolar geometry as the fields inside the wien , and hence will give rise to similar effects both in lensing and spin precession .",
    "their overall effect is therefore only to change the effective length of the filter .",
    "however , in addition there will also be a longitudinal @xmath1 component that must be taken into account . in the lensing effect ,",
    "only the @xmath1 component of the electric field plays a role , by ensuring the validity of the condition ( [ eq : initialv ] ) .",
    "the @xmath1 component of the magnetic fields does not affect the ray propagation , since it exerts a vanishing lorentz force .",
    "however , the latter may affect the spin precession .",
    "if we assume that the input electrons have a spin parallel to the @xmath1 axis , then the @xmath1 component of the fringe magnetic field does nothing .",
    "however , the spin may be somewhat rotated away from the @xmath1 axis by the transverse fringe magnetic field , and in this case the longitudinal component will induce some non - uniform precession around the @xmath1 axis that may partly depolarize the beam .",
    "this effect will however be proportional to the time spent by the particles in the fringe field region , and hence will be negligible in the large length - to - gap ratio limit .",
    "we may also consider the idealized limit of an extremely thin fringe field region in which the electric and magnetic fields vary rapidly from the vanishing values they have away from the wien filter to the values they acquire well inside the filter , which then remain perfectly constant .",
    "this is the scoff limit mentioned above . in particular , in the scoff limit the vector potential @xmath14 must go from zero to the value @xmath165 $ ] describing the multipolar magnetic field inside the filter",
    ". this rapid transition does not give rise to any magnetic field , because it is curl - free .",
    "therefore , the scoff limit has vanishing magnetic fringe fields and therefore absolutely no effect on the spin , nor on the lensing behavior of the filter . on the other hand , in the scoff",
    "limit the electric potential must go from zero to the nonzero value @xmath166 describing the multipolar electric field inside the filter .",
    "this in turn implies the presence of a very strong longitudinal electric fringe field that is responsible for the change of velocity given by eq .",
    "( [ eq : initialv ] ) .",
    "we stress that this idealized scoff description of the fringe fields needs not being realistic , but it is sufficient to identify the ineliminable effects that the fringe field impose to the electrons , and therefore the possible fundamental limitations that may arise from them .",
    "we report in fig .",
    "[ fig : spintem ] the sketch of a possible tem microscope incorporating the proposed spin - polarization filter based on the @xmath52-filter .",
    "such a device could be used to perform spin - sensitive tem microscopy on magnetic materials or spintronic devices .",
    "it includes the four stages discussed in the main paper , i.e. ( i ) the fork hologram to set the initial oam , ( ii ) the @xmath52-filter to couple oam to spin , ( iii ) an imaging stage to go in the fourier plane , ( iv ) an aperture to select a single spinorbit component , as well as the additional electron optics needed for imaging and collimating the beam .",
    "the input aperture of the system is defined by the fork hologram mask and has a typical radius of few microns @xcite .",
    "the output iris needed to select a single spin polarization can be set to a radius of few tens of microns , by carefully selecting the aperture plane position with respect to the focal plane .",
    "it will be presumably convenient to work slightly off focus to obtain larger beam waists without the need to introduce additional magnifying optics .",
    "we note here in passing that in the new generation of tem microscopes with aberration - corrected probe a larger number of lenses are available for beam control , and in particular a pair of hexapoles",
    ". it could be worth then exploring the possibility of using directly these lenses as an effective @xmath52-filter , without introducing additional optical elements . in this configuration , the magnetic hexapoles with opposite sign",
    "could be used to produce the polarization , while also compensating the introduced aberration .",
    "however stability issues might arise for large fields and the effect of fringing fields on the spin may also not be negligible , in this case , as the length - to - gap ratio would not be very large . therefore , further analysis and simulations will be necessary in order to assess this possibility .",
    "in our treatment we fully included the diffraction effects only in the free propagation ( through a lensing system ) taking place after the @xmath52-filter device .",
    "indeed , this stage is where the correlation between oam and radial profile develops and is then exploited for separating the different spin components . this free propagation ,",
    "ending in the far - field and giving rise to the beam profiles shown in fig .",
    "3 of the main paper , has been evaluated using a fully quantum mechanical treatment .",
    "the diffraction effects are obviously important in the propagation from near to far field , and in particular in determining the presence or absence of destructive interference effects at the vortex position that are essential in our proposed scheme",
    ".    one may wonder if we can legitimately ignore the diffraction effects in the other stages of our proposed setup .",
    "for the propagation through the @xmath52-filter , we could assess directly the role of diffraction in the case of homogeneous field , for which we have both the exact solution of pauli s equation ( including diffraction ) and the classical trajectory solutions .",
    "we find that diffraction is only relevant if we look at the electron beam very close to a focal point , where its width becomes of the order of few nanometers . away from the focus ,",
    "the ensemble of classical trajectories reproduces perfectly well the quantum beam evolution .",
    "this result is not surprising , as in the @xmath52-filter all length scales are 89 orders of magnitude larger than the electron wavelength @xmath167 , which is of few picometers for energies of the order of 100 kev ( typical of electron microscopes ) .",
    "therefore , we may safely assume that diffraction can be ignored also in inhomogeneous @xmath52-filter geometries , as long as no focusing occurs inside the filter .",
    "our classical ray - tracing simulations confirm that we avoid a focusing inside the @xmath52-filter .",
    "it should be also noted that in designing and analyzing electron - optics elements as those commonly used in electron microscopy , it is quite standard to ignore quantum effects and use classical ray tracing or geometrical optics .",
    "the input and output apertures , being again about 7 orders of magnitude larger than the electron wavelength , will also give negligible diffraction effects ( only some radial fringes extremely close to the aperture edges are expected , which should not affect the proper working of the proposed setup ) .      as reported in ref .",
    "@xcite , few years after the discovery of electron spin , several experiments were proposed ( and sometimes attempted ) aimed at separating electrons according to their spin , mainly by exploiting inhomogeneous magnetic fields acting on the magnetic dipole associated with it ( similar to the stern - gerlach experiment ) . in 1929 ,",
    "niels bohr demonstrated a sort of `` impossibility theorem '' @xcite , stating that no stern - gerlach - like experiment ( including knauer s proposal , in which an electric field was used to balance the lorentz force ) could be used to separate electrons according to their spin by more than a small fraction of the beam transverse extension .",
    "this was related to the uncertainty principle and to the unavoidable orthogonal magnetic field accompanying the required magnetic field gradient .",
    "a simple explanation of this result is that the spin magnetic moment vanishes in the classical limit @xmath168 , so all attempts at separating particles according to the magnetic - moment force occurring in a magnetic field gradient give rise to a vanishing separation in the classical limit , and hence a separation that is comparable to quantum uncertainty .",
    "actually , this statement has been later proved not to be strictly valid ( see , e.g. , refs.@xcite ) , although it remains extremely hard to overcome in practice .",
    "our approach is however fundamentally different from past attempts .",
    "indeed , we exploit the quantum nature itself of the electrons to operate the spin separation ( as such , our proposal bears some similarities with a very recently proposed scheme for spin - polarization in which electron diffraction is also exploited @xcite ) .",
    "as we have seen , the magnetic dipole force in our device acts only in the azimuthal direction , which is not the direction along which we separate the electrons .",
    "the torque associated with this force imparts the oam variation corresponding to the azimuthal geometric phase .",
    "however , at the exit of our wien filter the electrons show no significant spatial separation according to the spin .",
    "it is then the subsequent free propagation and diffraction that acts to separate the electrons along the radial direction , which is not the direction of the main field gradient .",
    "in particular , an efficient radial separation is ensured by the presence of a vortex at the beam axis for one spin component and not for the other . in other words",
    ", we use the quantum wavy nature of the electrons to separate them according to the spin , and hence our method is not subject to bohr s impossibility theorem . as a further argument , even in the classical stern - gerlach approach bohr s theorem does not forbid the creation of spin - polarized components at the edges of the beam , so that by suitable aperturing it should be possible to generate spin - polarized beams , although with very low efficiency .",
    "our method is also based on selecting only an edge of the beam , although this is done in the radial direction and the efficiency is strongly improved by the vortex - related destructive interference effects .",
    "finally , we note that in our geometry the unavoidable orthogonal magnetic field associated with the azimuthal field gradient generating the dipole forces , which is the main source of problems in the stern - gerlach approach to spin - polarized electron separation , is already taken into account and corresponds to the radial magnetic field of the quadrupole or hexapole configuration .",
    "so its effect has been already fully considered in our treatment .",
    "16ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop ( ) see the supplemental material in the appendix .  and  ,  eds .",
    ",  @noop _ _  ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we propose the design of a space - variant wien filter for electron beams that induces a spin half - turn and converts the corresponding spin angular momentum variation into orbital angular momentum ( oam ) of the beam itself , by exploiting a geometrical phase arising in the spin manipulation . </S>",
    "<S> when applied to a spatially - coherent input spin - polarized electron beam , such device can generate an electron vortex beam , carrying oam . </S>",
    "<S> when applied to an unpolarized input beam , the proposed device in combination with a suitable diffraction element can act as a very effective spin - polarization filter . </S>",
    "<S> the same approach can be also applied to neutron or atom beams .    </S>",
    "<S> phase vortices in electronic quantum states have been widely investigated in condensed matter , for example in connection with superconductivity , the hall effect , etc . only very recently , </S>",
    "<S> however , free - space electron beams exhibiting controlled phase vortices have been experimentally generated in transmission electron microscope ( tem ) systems , using either a spiral phase plate obtained from a stack of graphite thin films @xcite , or a `` pitchfork '' hologram manufactured by ion beam lithography @xcite . in a cylindrical coordinate system @xmath0 with the @xmath1 axis along the beam axis </S>",
    "<S> , a vortex electron beam is described by a wavefunction having the general form @xmath2 , where @xmath3 is a ( nonzero ) integer and @xmath4 vanishes at @xmath5 . as in the case of atomic orbitals , @xmath3 is the eigenvalue of the @xmath1-component orbital angular momentum ( oam ) operator @xmath6 ( in units of the reduced planck constant @xmath7 ) , and therefore an electron beam of this form carries @xmath8 of oam per electron @xcite . </S>",
    "<S> the recent experiments on electron vortex beams were inspired by the singular optics field , in which similar phase or holographic tools have been used in the last twenty years ( see , e.g. , @xcite and references therein ) . in optics , a recently introduced alternative approach to the generation of vortex beams is based on the `` conversion '' of the angular momentum variation occurring in a spin - flip process into orbital angular momentum of the light beam , when the latter is propagating through a suitable spatially variant birefringent plate @xcite . in this paper , we propose that a beam of electrons traveling in free space undergoes a similar `` spin - to - orbital angular momentum conversion '' ( stoc ) process in the presence of a suitable space - variant magnetic field . the same approach may work also for neutrons , or any other particle endowed with a spin magnetic moment ( e.g. , atoms , ions ) . of course , in the case of electrons , as for other charged particles , the magnetic field , besides acting on the spin , will also induce forces that must be compensated in order to avoid strong beam distortions or deflections . such compensation may be obtained by a suitable electric field , and this leads us to conceiving the proposed apparatus essentially as a _ space - variant wien filter_. such apparatus can be exploited for generating vortex </S>",
    "<S> electron beams when a spin - polarized beam is used as input . </S>",
    "<S> conversely , if a pure vortex beam is used in input , by means e.g.  of a holographic method , one can use the stoc process for filtering a single spin - polarized component of the input beam , as we will show further below .    </S>",
    "<S> let us consider an electron beam propagating in vacuum along the @xmath1-axis and crossing a region of space lying between @xmath9 and @xmath10 in which it is subject to electric and magnetic fields @xmath11 and @xmath12 , where @xmath13 and @xmath14 are the scalar and vector potentials , respectively . in the non - relativistic approximation and neglecting all coulomb self - interaction effects ( small charge density limit ) , </S>",
    "<S> the electron beam quantum propagation and spin evolution are generally described by pauli s equation @xmath15\\tilde\\psi\\ ] ] where @xmath16 is the spinorial two - component wave - function of the electron beam , @xmath17 and @xmath18 are the electron charge and mass , @xmath19 is the derivative with respect to the time variable @xmath20 , @xmath21 is the electron magnetic moment , with @xmath22 the bohr s magneton , @xmath23 the electron @xmath24-factor , and @xmath25 the pauli matrix vector .    as a first step , </S>",
    "<S> we consider the simpler case in which the electric and magnetic fields are taken to be uniform , lying in the transverse plane @xmath26 , and arranged as in standard wien filters @xcite , i.e. perpendicular to each other and balanced so as to cancel the average lorentz force , i.e. @xmath27 where @xmath28 and @xmath29 are the electric and magnetic field moduli , and @xmath30 the average beam momentum . the magnetic field @xmath31 is also taken to form an arbitrary angle @xmath32 with the axis @xmath33 within the @xmath26 plane . </S>",
    "<S> for this case , we solved the full pauli s equation in the paraxial slow - varying - envelope approximation for an input beam having a gaussian profile and an arbitrary uniform input spin state @xmath34 , where @xmath35 and @xmath36 denote a state for which the spin is parallel or antiparallel to the @xmath1 axis , respectively . </S>",
    "<S> the complete expression of the resulting spinorial wave - function is given in the supplemental material ( sm ) @xcite , while here we summarize the main findings . </S>",
    "<S> the beam propagation behavior corresponds to the well known astigmatic lensing in the plane perpendicular to the magnetic field . </S>",
    "<S> more precisely , the beam undergoes periodic width oscillations , with a spatial period @xmath37 , where @xmath38 is the cyclotron radius . </S>",
    "<S> this lensing phenomenon is also predicted by a classical ray theory , when properly taking into account the effect of the input fringe fields @xcite . </S>",
    "<S> the output spin state is instead given by the following general expression ( eq . 4 in sm @xcite ) </S>",
    "<S> @xmath39 \\nonumber\\\\ & & + a_2\\left[\\cos(\\delta/2 ) { |\\!\\downarrow\\rangle } + \\sin(\\delta/2 ) ie^{-i\\alpha}{|\\!\\uparrow\\rangle}\\right ] , \\label{eq : spinor}\\end{aligned}\\ ] ] where @xmath40 and @xmath41 . </S>",
    "<S> this spinorial evolution corresponds to the classical larmor precession of the spin with spatial period @xmath42 , @xmath43 being the total precession angle . </S>",
    "<S> however , in addition to the spin precession , eq .  </S>",
    "<S> ( [ eq : spinor ] ) predicts the occurrence of wavefunction phase shifts . </S>",
    "<S> in particular , for a @xmath35 or @xmath36 input state and a total spin precession of exactly half a turn , i.e. @xmath44 or @xmath45 , the wavefunction acquires a phase shift given by @xmath46 , where @xmath32 is the magnetic field orientation angle mentioned above and the @xmath47 sign is fixed by the input spin orientation ( @xmath48 for @xmath35 and @xmath49 for @xmath36 ) . </S>",
    "<S> these phase shifts can be interpreted as a special case of _ geometric berry phases _ arising from the spin manipulation @xcite .    </S>",
    "<S> let us now move on to the case of a spatially variant magnetic field . </S>",
    "<S> we consider multipolar transverse field geometries with cylindrical symmetry , described by the following expression for the magnetic field ( with the vector given in cartesian components ) : @xmath50 , where the angle @xmath32 is now the following function of the azimuthal angle : @xmath51 where @xmath52 is an integer and @xmath53 a constant . </S>",
    "<S> clearly , such a field pattern must have a singularity of topological charge @xmath52 at @xmath5 . </S>",
    "<S> in particular , by imposing the vanishing of the field divergence , we find that the radial factor @xmath54 , i.e. , the field vanishes on the axis for @xmath55 , while it diverges for @xmath56 . in the latter case </S>",
    "<S> , there must be a field source on the axis . </S>",
    "<S> we call `` @xmath52-filter '' a balanced wien filter whose magnetic field distribution in the beam transverse plane obeys eq.([eq : alpha ] ) . </S>",
    "<S> the electric field will be taken to have an identical pattern , except for a local @xmath57 rotation , so as to balance the lorentz force . </S>",
    "<S> some examples of such @xmath52-filter field distributions are shown in fig .  </S>",
    "<S> [ fig : q - filter - topology ] .     </S>",
    "<S> ( color online ) electric ( upper panels ) and magnetic ( lower panels ) field @xmath52-filter geometries for different topological charges : ( a ) @xmath58 , ( b ) @xmath59 , ( c ) @xmath60 , and ( d ) @xmath61 ; in all cases @xmath62.,width=321 ]    we are particularly interested in the negative @xmath52 geometries , which do not require to have a field source at @xmath5 . for example </S>",
    "<S> , the @xmath59 case corresponds to the standard quadrupole geometry of electron optics , while @xmath58 corresponds to the hexapole one . </S>",
    "<S> wien filters with such geometries have been already developed in the past for the purpose of correcting chromatic aberrations @xcite . moreover , </S>",
    "<S> inhomogeneous wien filters including several multipolar terms have been also considered for the purpose of spin manipulation , with the added advantage of obtaining a stigmatic lensing behavior @xcite . </S>",
    "<S> a possible design of the @xmath59 filter with quadrupolar geometry is shown in fig.[fig : device ] .     </S>",
    "<S> ( color online ) electrodes and magnetic poles geometry of a @xmath52-filter with @xmath59 ( quadrupole ) , seen in cross - section ( a ) and in three - dimensional rendering ( b ) . </S>",
    "<S> the filter length is set to 50 cm . in panel ( a ) , the calculated vector potential @xmath63 ( in false colors ) , which is also roughly proportional to the electric potential , and the projection on the @xmath26 plane of the simulated electron ray trajectories for 100 kev energy are also shown ( see sm for details about the simulations @xcite ) , for a ring - shaped input beam with radius @xmath64 @xmath65 m ( ray color grows darker for increasing @xmath1 ) . in panel ( c ) a zoomed - in view of the central region . </S>",
    "<S> the magnetic field at @xmath66 needed to obtain the tuning condition @xmath44 is 3.5 mt , with a corresponding electric field of 575 kv / m . </S>",
    "<S> these are obtained with an electrode potential difference of @xmath67 kv and a magnetization of 135 a / mm . </S>",
    "<S> the fields need to be set to the design - values with a precision of 1 part in @xmath68.,width=321 ]    in such non - uniform field geometry we can not solve analytically the full pauli s equation . </S>",
    "<S> however , the beam propagation is already well described by classical dynamics and can be derived either analytically , using a power - expansion in @xmath66 @xcite , or by numerical ray tracing . in the former case , we find that to first order the @xmath52-filter for @xmath69 is already stigmatic , i.e. , it preserves the beam circular symmetry . </S>",
    "<S> only second - order corrections introduce aberration effects @xcite . </S>",
    "<S> this behavior is confirmed by our numerical ray - tracing simulations ( see sm for details @xcite ) , which show relatively weak higher - order aberrations ( see fig .  [ </S>",
    "<S> fig : device ] ) . </S>",
    "<S> it should be noted that these simulations have been performed for realistic values of the electric and magnetic fields , as required to obtain a spin precession of half a turn across a propagation distance of 50 cm at a beam radius of 100 @xmath65 m . </S>",
    "<S> these calculations are expected to reproduce very well the electron density behavior ( and spin precession ) as would be obtained from pauli s equation . </S>",
    "<S> however , pauli s equation predicts an additional purely quantum phenomenon , namely the geometric phase already discussed above . in a semi - classical approximation </S>",
    "<S> , the geometric phase will still be given by @xmath46 , where @xmath32 is however now position - dependent and given by eq .  </S>",
    "<S> ( [ eq : alpha ] ) . more specifically , neglecting the aberrations , </S>",
    "<S> each possible electron trajectory within a beam is straight and parallel to the @xmath1 axis . </S>",
    "<S> therefore , the electrons travelling in a given trajectory will experience a constant magnetic field of modulus @xmath70 and orientation @xmath71 . </S>",
    "<S> the set of all electrons travelling at a given radius @xmath66 will then undergo a uniform spin precession by angle @xmath72 and , if @xmath73 ( i.e. , for a spin half - turn rotation ) , they will also acquire a _ space - variant geometric phase _ given by @xmath74 , with the @xmath47 sign determined by the input spin orientation . </S>",
    "<S> in other words , the outgoing wavefunction acquires a phase factor @xmath75 , with @xmath76 , corresponding to a vortex beam with oam @xmath77 . in a quantum mechanical notation , spin - polarized input electrons with given initial oam @xmath3 passing through a @xmath52-filter </S>",
    "<S> undergo the following transformations : @xmath78 where the ket indices now specify both the spin state ( arrows ) and the oam eigenvalue .    </S>",
    "<S> equations ( [ eq : qftransf ] ) show that , in passing through the @xmath52-filter , a fraction @xmath79 of the electrons in the beam will flip their spin and acquire an oam @xmath77 , while the remaining fraction @xmath80 will pass through the filter with no change . when @xmath45 , then @xmath44 and all electrons are spin - flipped and acquire the corresponding oam . in the specific case @xmath60 , the spin angular momentum variation for the electrons undergoing the spin inversion is exactly balanced by the oam variation , so that the total electron angular momentum remains unchanged in crossing the filter . </S>",
    "<S> this is the pure `` spin - to - orbital conversion '' stoc process mentioned in the introduction , and it occurs for @xmath60 because this geometry is rotationally invariant and therefore no angular momentum can be exchanged with the field sources in the filter . in the @xmath81 case , the input spin still controls the sign of the oam variation , but the total beam angular momentum is not conserved and some angular momentum is exchanged with the field sources . </S>",
    "<S> we note that this oam variation can be also explained as the effect of the spin - related magnetic - dipole force acting on the electrons within the magnetic field gradients , as more fully discussed in the sm @xcite .    </S>",
    "<S> the `` tuning '' condition @xmath45 or @xmath44 can be achieved in principle for a given radius @xmath66 by adjusting the strength of the magnetic and electric fields or the device length @xmath82 . </S>",
    "<S> since the precession angle @xmath43 is @xmath66-dependent , however , this tuning condition can be applied to the entire beam only if it is shaped as a ring , i.e. with all electron density peaked at a given radius @xmath66 . </S>",
    "<S> vortex beams with oam @xmath83 typically have a doughnut shape , so they approximate a ring fairly well . </S>",
    "<S> on the other hand a gaussian input beam ( with @xmath84 ) can not be fully transformed , as @xmath85 at @xmath5 , where the beam has the maximum density . in such cases , </S>",
    "<S> only a fraction @xmath86 of the electrons would be converted .    </S>",
    "<S> so far we have assumed a spin - polarized input beam . however , high brightness ( i.e. , spatially coherent ) spin - polarized electron beams , suitable for high - resolution tem applications , are not so easily available . </S>",
    "<S> state - of - the - art spin - polarized sources may achieve a brightness of 10@xmath87 a @xmath88 sr@xmath89 and a polarization purity of up to 90% @xcite ( and the source decays with time due to laser - induced damage ) . </S>",
    "<S> it is interesting then to analyze the effect of the @xmath52-filter on a initially unpolarized electron beam , having arbitrary initial oam @xmath3 . </S>",
    "<S> such input can be simply viewed as a statistical mixture in which 50% of the electrons are in the state @xmath90 and 50% in the state @xmath91 . after passing through a tuned @xmath52-filter , </S>",
    "<S> the beam becomes a 50 - 50 mixture of states @xmath92 and @xmath93 , for which spin and oam are correlated ( if the @xmath52-filter is not tuned , the fraction of converted electrons decreases to @xmath94 in each spinorbit state , and there will be a residual @xmath95 fraction of electrons in states @xmath90 and @xmath91 ) . as we discuss now , this spin - oam correlation can be exploited for making an effective electron beam spin - polarization filter . </S>",
    "<S> such filter requires four basic elements in sequence ( as shown in fig .  2 of sm @xcite ) : </S>",
    "<S> ( i ) an oam manipulation device , such as a fork hologram @xcite , to set @xmath96 ; ( ii ) a @xmath52-filter with @xmath97 , generating a mixture of electrons in states @xmath98 and @xmath99 ; ( iii ) a free propagation ( or imaging ) stage that allows these two states to develop different radial profiles by diffraction , because of their different oam values ; ( iv ) a circular aperture for finally separating the two states . in particular , in stage </S>",
    "<S> ( iii ) state @xmath98 will acquire a radial doughnut distribution , as in laguerre - gaussian modes with oam @xmath100 , which vanishes close to the beam axis as @xmath101 , while state @xmath99 will become approximately gaussian , with maximum intensity at the beam axis , as shown in figs.[fig : iris]a , b . </S>",
    "<S> therefore , a suitable iris ( fig.[fig : iris]c ) will select preferentially the electrons in the fully polarized state @xmath99 . </S>",
    "<S> an optical oam sorter exploiting a similar approach has been demonstrated recently @xcite .     </S>",
    "<S> ( color online ) electron beam profiles in the far field of the @xmath52-filter for the @xmath84 component ( panel a ) and the @xmath102 component ( panel b ) , and a possible discriminating iris radius ( panel c ) @xmath103 to be used to separate them in order to make a spin - polarization filter . </S>",
    "<S> panel ( d ) shows the intensity profiles of the same components ( @xmath84 - blue dot - dashed line , @xmath102 - green dashed line ) and of the possible residual @xmath104 component for an untuned @xmath52-filter ( red solid line ) . </S>",
    "<S> @xmath105 is the gaussian beam waist radius in the far - field plane . </S>",
    "<S> a realistic value for the iris radius is of the order of several tens of microns ( obtained by setting the aperture some distance after the focal plane of the second condensor),width=302 ]    a specific calculation for the case @xmath106 and an iris radius equal to the beam waist @xmath105 in the `` far field '' yields a transmission efficiency of our device of 55.5% ( not including the losses arising in the oam - manipulation device ) and a polarization degree @xmath107 , where @xmath108 are the two spin - polarized currents , of @xmath109 . </S>",
    "<S> higher degrees of polarization can be obtained at the expense of the efficiency by reducing the iris diameter or by employing higher @xmath52 values ( or vice versa ) . </S>",
    "<S> it is worth noting that this apparatus works also with a partially tuned @xmath52-filter , as in this case the unmodified electron beam component is left in the initial oam state @xmath110 and therefore is also cut - away by the iris . </S>",
    "<S> an untuned @xmath52-filter will however have an efficiency reduced by the factor @xmath79 . </S>",
    "<S> the aberrations introduced by the @xmath52-filter , even if left uncorrected , might also affect its efficiency but not its main working principle , as this is based on the vortex effect , which is protected by topological stability . </S>",
    "<S> finally , the possible spin depolarization effect of fringe fields can be neglected if the length - to - gap ratio of the filter is large enough @xcite .    </S>",
    "<S> we note that the spin - filter application discussed above is a new counterexample of the old statement by bohr that free electrons can not be spin - polarized by exploiting magnetic fields , due to quantum uncertainty effects @xcite . </S>",
    "<S> the reason why we can overcome bohr s arguments is essentially that we do not use the magnetic forces directly to obtain the separation , but take advantage of quantum diffraction itself , as also proposed recently in ref .  </S>",
    "<S> @xcite ( see sm for a fuller discussion @xcite ) .    in conclusion </S>",
    "<S> , we believe that the @xmath52-filter device described in this paper can be manufactured relatively simply , for applications in standard electron beam sources such as those used in tems or other kinds of electron microscopes . in combination with current field - effect unpolarized electron sources , such filter might provide a spin - polarized source with a brightness @xmath111 a @xmath88 sr@xmath89 , about two orders of magnitude higher than the current state of the art . </S>",
    "<S> this result , if it will be proved practical enough , may open the way to a spin - sensitive atomic - scale tem , e.g. suitable for investigating complex magnetic order in matter or for spintronic applications .    </S>",
    "<S> we acknowledge the support of the fet - open program within the 7@xmath112 framework programme of the european commission under grant no . 255914 , phorbitech . </S>"
  ]
}