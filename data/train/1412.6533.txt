{
  "article_text": [
    "galaxy clusters are the largest gravitationally bound systems in our universe .",
    "they typically contain hundreds of galaxies and are detected in a broad range of frequencies . in particular , we observe strong x - ray radiation from the hot intra cluster medium ( icm ) , which is mainly caused by continuous free - free emission of thermal electrons and discrete metal lines .",
    "observations show that clusters contain roughly ten per cent of their total mass in a hot baryonic gas component with temperatures up to several @xmath0 k ( corresponding to about 15 kev ) at typical densities of @xmath1 @xmath2 .    the state of the icm and its related physical properties are crucial to investigate and learn about the formation and evolution of galaxy clusters .",
    "the gas is partially heated at the virial shock by the gravitational infall and furthermore raised in temperature by shocks within the icm . galactic winds driven by the star formation process and feedback of active galactic nuclei ( agn ) inject additional kinetic and thermal energy to the hot cluster medium .",
    "radiative processes within the icm , such as thermal bremsstrahlung or metal lines @xcite allow the gas to cool and loose energy . furthermore , all galaxy cluster are known to host magnetic fields with strengths up to several @xmath3 g @xcite , which influences the dynamics of the hot plasma .",
    "the structure and the amplitude of the cluster magnetic fields guide the propagation of charged particles and contribute to the equation of motion via the lorentz force .",
    "the magnetic field lines are assumed to be highly tangled and twisted on small scales , which then will contribute of the heating of the plasma by magnetic reconnection ( e.g. * ? ? ?",
    "little is know about the magnetic field structure as its mapping is observationally challenging @xcite .",
    "we discuss the influence of the anisotropic magnetic field on plasma transport processes and in particular on thermal conduction . from a microscopic point of view thermal conduction",
    "is the heat transport due to collisions of electrons .",
    "therefore , it strongly depends on temperature , which allows us to use probes of the hot icm to study large - scale transport of heat . from a macroscopic point of view",
    "thermal conduction can be modelled as a diffusion process re - distributing internal energy .",
    "usually , the so called spitzer conduction ( see * ? ? ?",
    "* ) is used as a general formulation and multiplied with an efficiency factor , which changes with and depends on the astrophysical environment .",
    "this original formulation assumes an isotropic movement of electrons and corresponding distribution of collisions . as galaxy clusters host significantly strong magnetic fields",
    "the influence of the magnetic fields onto thermal conduction has to be taken into account .",
    "since particle movement perpendicular to magnetic field lines is restricted , the assumption of isotropic collisions does not hold any longer and thermal conduction is coupled to the magnetic field topology .",
    "this result in different heat transport timescales parallel and perpendicular to the magnetic field .",
    "however , the magnetic fields needs to be sufficiently strong to dominate the mean free path @xcite .",
    "observational evidence in galaxy clusters of suppressed perpendicular heat transport is found in so called cold fronts , i.e. regions with a rather stable temperature gradient , but no pressure gradient @xcite .",
    "this phenomenon demonstrates the insulation of gas with respect to conduction most probably through magnetic fields @xcite .",
    "moreover , turbulent magnetic fields also become a very interesting case to study giving rise to different ways to estimate efficiency factors averaging the suppression effect over volume . for example",
    "@xcite proposed that spitzer conduction should be suppressed by a factor of about 1/300 , while @xcite claimed that conduction can still be efficient up to 1/5 of the spitzer value in highly turbulent environments .",
    "thermal conduction was frequently discussed as a heating source to balance cooling losses in galaxy clusters in order to explain why hot gas is observed despite the cooling times being smaller than the cluster life times .",
    "however , the impact of this effect is questioned and even less significant , when the anisotropies of the magnetic field are included . for detailed discussions of this problem we refer to @xcite , @xcite , @xcite , @xcite , @xcite , @xcite and @xcite .    in pioneering work ,",
    "usually a factor of 1/3 is multiplied onto the spitzer value as a correction for the influence magnetic fields ( e.g. @xcite , supported by work presented in @xcite ) .",
    "we present a numerical implementation of the anisotropic heat transport equation including the seeding and evolution of magnetic fields applied to cosmological simulations of galaxy clusters .",
    "a solver for anisotropic thermal conduction is already part of several commonly used grid based codes , which solve the equations of magnetohydrodynamics ( mhd ) . for implementation details and cluster simulations",
    "see for example @xcite , @xcite , @xcite ( athena code ) , @xcite ( flash code ) or @xcite ( enzo code ) . however , we present the first implementation of anisotropic thermal conduction into a smoothed particle magnetohydrodynamics ( spmhd ) code .",
    "in contrast to the eulerian methods , which discretise the volume , sph discretises the mass and is commonly used in simulations of structure formation .",
    "the lagrangian nature of sph ensures the conservation of energy , momentum and angular momentum and allows to resolve large density gradients .",
    "for a recent review on the sph method we refer to @xcite .",
    "in this paper we present simulations performed with the n - body / sph code gadget @xcite with the non - ideal mhd implementation based on @xcite and @xcite .",
    "the sph code evolves entropy as the thermodynamical variable of choice @xcite .",
    "additionally , we include several improvements for sph such as the wendland kernel functions @xcite .",
    "our cosmological simulations include sub - grid models for radiative cooling , star formation and supernova feedback as described by @xcite .",
    "furthermore , we employ a supernova seeding scheme for the magnetic field @xcite in contrast to previous simulations using uniform initial magnetic fields ( e.g. * ? ? ?",
    "we use and extend the existing implementation of isotropic thermal conduction by @xcite with the conjugate gradient solver described in @xcite .",
    "the paper is structured as follows . in section [ phenomenologyconduction ]",
    "we explain the physics behind ( anisotropic ) thermal conduction , and describe our sph implementation in section [ numericalimplementation ] .",
    "section [ tests ] presents several test problems before we analyse simulations of galaxy cluster formation in section [ applicationgeneral ] .",
    "we start with a brief introduction in the physical properties and concepts of isotropic as well as anisotropic conduction .      according to @xcite",
    "we can write down a conduction heat flux resulting from a temperature gradient as @xmath4 with the conduction coefficient @xmath5 .",
    "for an idealized lorentz gas we can assume spitzer conductivity , which equals a coefficient of @xmath6 with @xmath7 the average proton number of the plasma , the coulomb logarithm @xmath8 and electron temperature @xmath9 , mass @xmath10 and elementary charge @xmath11 .",
    "most important is the strong dependence of conductivity on the electron temperature .",
    "therefore , we assume that thermal conduction has an important influence mainly on very hot gas , as for example in the central regions of massive galaxy clusters where the plasma reaches temperatures up to about @xmath12 .    in fact , we need to multiply the idealized spitzer conductivity by an additional factor @xmath13 : @xmath14 this factor has been calculated by @xcite and is highly dependent on the average proton number of the plasma . @xmath15 for a pure proton electron plasma and rises up close to 1 for large values of @xmath7 .",
    "@xcite describe a way to calculate the average proton number by summation over all ions in the plasma . applying a primordial hydrogen - helium plasma",
    ", they find a value of @xmath16 .",
    "using the tabulated values in @xcite we obtain a factor of @xmath17 .",
    "when used for cosmological simulations one often assumes a primordial gas distribution . a typical value for an effective conductivity @xmath5 is e.g. given by @xcite @xmath18 or @xmath19 with the electron number density @xmath20 and the mean free path of the electrons @xmath21 . because of the inverse dependence on mass we infer that electrons give a much stronger contribution to heat conduction than protons",
    "this is reasonable since lighter particles have higher thermal velocities at a fixed temperature and can be accelerated much easier .",
    "therefore , the amount of collisions in a given time span are drastically increased for low mass particles .",
    "consequently , only electrons are considered in the calculation and we omit the index @xmath11 in our equations hereafter .",
    "we neglect any dependency of the coulomb logarithm on temperature and electron density and use @xmath22 , which is a fairly good approximation for typical plasmas in our study .",
    "more precise calculations for different collision events ( e.g. electron - electron or electron - proton ) can be found for example in @xcite .",
    "what remains is the strong dependence on temperature to the power of @xmath23 .",
    "furthermore , we need to apply an important correction .",
    "so far we assumed , that the typical length scale of the temperature gradient @xmath24 is always much larger than the mean free path .",
    "however , for very low density plasmas one can not expect a high conductivity even if the temperature rises a lot , since scatterings and therefore energy transfer events happen only at a very low rate .",
    "@xcite have calculated the saturated heat flux for this case as @xmath25 interpolating between these findings and the common spitzer conduction coefficient we estimate a corrected heat flux as @xmath26 alternatively , we can redefine the conduction coefficient as @xmath27 this modified spitzer conduction is applicable to galaxy clusters and giant elliptical galaxies if magnetic fields are not taken into account .",
    "for a detailed discussion we refer to @xcite .    finally , we can write the effect of thermal conduction as a change of specific internal energy @xmath28 which depends on the density @xmath29 and on the heat flux directed anti - parallel to the temperature gradient .      next , we add magnetic fields to the picture . as previously mentioned , thermal conduction is based on coulomb collisions of charged particles . except these collisions particles",
    "are allowed to move freely in the plasma . however , in the presence of magnetic fields the movement perpendicular to the field lines is restricted .",
    "the electrons move on spiral trajectories around the field lines .",
    "the frequency of the circular motion , which depends on the strength of the magnetic field @xmath30 , is called larmor- or gyrofrequency : @xmath31 to see how this affects the capability of electrons to transport energy , we present some phenomenological ideas and scaling relations on how a general electron diffusion process is affected by magnetic fields , following @xcite . due to the similar microscopic origin",
    "we infer the same relations to hold also for thermal conduction .",
    "this connection is motivated through some scaling relations starting with the ideal gas law @xmath32 assuming a more or less constant density we infer @xmath33 knowing that the source of a heat flux corresponds to the time evolution of pressure and using eq .",
    "( [ eqbasicheatflux ] ) we obtain @xmath34 discretising the derivatives by typical length and time scales we get for the conduction coefficient @xmath35 where we can identify the diffusion coefficient @xmath36 .",
    "according to this relation , the two coefficients behave similarly and we can therefore apply the following scaling relations on an implementation of anisotropic thermal conduction .      at first",
    ", we connect the mean free path and collision time via the particle s velocity @xmath38 .",
    "a typical diffusion coefficient of units @xmath39 can be defined as @xmath40 since particle movement parallel to the magnetic field is not restricted , the diffusion along the field lines should not be affected , which corresponds to @xmath41 .",
    "we assume that motion of particles perpendicular to magnetic field lines is only possible by jumps between cyclotron trajectories , which results in a diffusion coefficient like @xmath42 therefore , the relation between the two coefficients is @xmath43 this is however only valid if @xmath44 , ergo if the gyroradius is much smaller than the mean free path . in other words , we need the magnetic field to impose a notable restriction onto the electrons movement . in the regime of",
    "@xmath45 we have to change the relation in order to ensure @xmath46 : @xmath47 to evaluate this relation for a given system we require the collision time or the corresponding frequency @xmath48 with the plasma frequency @xmath49 and the debye length @xmath50 putting these relations together we finally obtain @xmath51    to check the order of magnitude of the fraction of perpendicular and parallel diffusion coefficient , we use typical values for the magnetic field strength , temperature and density in galaxy clusters ( see section [ introduction ] ) .",
    "( [ eqdiffusionbsquared ] ) results in a factor of @xmath52 which means that conduction perpendicular to the magnetic field is be typically extremely suppressed in the icm .    in a different approach @xcite",
    "derive a criterion for the minimum magnetic field which is needed for anisotropic conduction of @xmath53 which makes it easier to validate the criterion .",
    "however , these relations are only phenomenological estimates.additionally , perpendicular diffusion is overlayed with turbulence transport processes , which are extremely difficult to describe",
    ". however , laboratory experiments show , that the scaling with the magnetic field effectively changes from @xmath37 to @xmath54 , which characterises so called bohm diffusion . according to the calculations above we construct a scaling relation for this kind of behaviour of @xmath55 we assume an electrons movement with their thermal speed @xmath56 and neglect further influences for example by plasma instabilities .",
    "we get in total @xmath57 which allows a much stronger diffusion orthogonal to the magnetic field lines for typical values .",
    "a more detailed analysis with similar results is given for example in @xcite .",
    "for highly tangled magnetic fields @xcite discuss if the coherence length should replace the gyroradius .",
    "however , they find that this assumption is wrong .",
    "this matches the considerations of @xcite who present that tangled magnetic fields do not suppress thermal conduction very strongly , despite general believe .",
    "their results state a reduction factor of @xmath58 which is an average over the local angles between magnetic field lines and the temperature gradient .",
    "we briefly analyse this behaviour for totally random magnetic field configurations in section [ temperaturestep ] .    summing up",
    ", thermal conduction perpendicular to magnetic fields lines with reasonable field strengths is in general almost totally suppressed .",
    "when we come into a regime where we need to apply scaling relations regarding the magnetic fields , the ratio @xmath59 scales either like @xmath37 or @xmath54 .      we finalize our considerations and derive the anisotropic conduction equation . in principle , there are different possible approaches .",
    "we briefly repeat the immediate requirements for the resulting scheme :    * unchanged isotropic conduction if the magnetic field is parallel to the temperature gradient , * strong suppression of energy transfer via conduction if the magnetic field is perpendicular to the temperature gradient , * scaling of the suppression factor inverse with the magnetic field strength to some power .",
    "the first two requirements are easily fulfilled by multiplying the projection of the magnetic field onto the temperature gradient to the conduction coefficient @xmath60 this approach has the advantage that it requires barely any change in the existing numerical scheme presented in @xcite and does not cost much additional computation time . however , it does not fulfil the third requirement . here",
    "we have no possibility to introduce a scaling of the suppression dependent on the actual strength of the magnetic field .",
    "we therefore would have to assume a sufficiently strong magnetic field , which can not be guaranteed in the whole computational domain at all times .",
    "problems arise especially in combination with a magnetic seeding mechanism when no initial magnetic field is present .",
    "instead we follow a different derivation by splitting up the conduction equation into a part parallel and a part perpendicular to the magnetic field and assign different conduction coefficients to both parts @xmath61}}.\\ ] ] with @xmath62 being the normalised magnetic field vector .",
    "please note , that we can easily regain the isotropic equation from this by setting @xmath63 or @xmath64 .",
    "plugging in the relation between parallel and perpendicular diffusion we derived earlier , it can be seen that all of our requirements are fulfilled .",
    "we reshuffle the terms for better handling .",
    "@xmath65}}\\label{eqconductionfinalsecondapproach}\\ ] ]    from section [ anisotropicthermalconduction ] we know that within galaxy clusters mainly @xmath66 . however , we can not simply neglect the second term along the temperature gradient . comparing the absolute values of the two terms",
    "we see , that except of @xmath66 the first term contains a @xmath67 which can be arbitrarily small and make both terms comparable in magnitude .",
    "if the magnetic field and the energy gradient are almost totally perpendicular , the second term dominates and can not be neglected .",
    "in this section we derive our numerical representation of anisotropic thermal conduction .    before transforming eq .",
    "( [ eqconductionfinalsecondapproach ] ) into sph formalism we note that the second term can be handled similar to the isotropic implementation just with a different coefficient . for details",
    "we refer to @xcite . here",
    "we discuss only on the first term .",
    "initially , the term suggests a split - up of the calculation of temperature gradient and divergence .",
    "however , this requires a large amount of additional computation time , since it needs an additional sph loop , but also leads to further numerical errors due to the effective second kernel derivative introduced ( see @xcite ) .",
    "furthermore , chaining sph discretisations can introduce strongly growing numerical errors and should be avoided .    instead , we derive a consistent formulation with only one sph loop following the example of @xcite , who developed an sph scheme for a similar diffusion equation in radiative transfer . in the following calculations latin indices like @xmath68 ,",
    "@xmath69 and @xmath70 always denote particles while greek indices like @xmath71 , @xmath72 indicate components of tensors .",
    "before we start discretising the modified conduction equation , we have to find a better estimate for mixed second derivatives .",
    "the derivation is at first similar to the one presented by @xcite , but gets more complicated since we also need mixed derivatives .",
    "consider an arbitrary quantity @xmath73 at @xmath74 which we expand around @xmath75 @xmath76 with the distance vector .",
    "we multiply both sides by @xmath77 and integrate over @xmath78 .",
    "the first order term vanishes due to antisymmetry of the integrand and we solve for the second order term .",
    "more detailed calculations are presented in appendix [ appendixsecondorder ] .",
    "assuming q is a second order tensor quantity , we can rewrite the equation to @xmath79}}\\bmath{\\nabla}_i { \\ensuremath{w_{ij}}}}{{\\ensuremath{\\left| { \\ensuremath{\\bmath{x}_{ij}}}\\right|}}^2 } \\label{eqmixedsecondderivativeestimatefirst}\\ ] ] and @xmath80}}\\bmath{\\nabla}_i { \\ensuremath{w_{ij}}}}{{\\ensuremath{\\left| { \\ensuremath{\\bmath{x}_{ij}}}\\right|}}^2 } \\label{eqmixedsecondderivativeestimatesecond}\\ ] ] with the substituted tensor @xmath81 this is a very compact and neat formulation and we use @xcite to check this formula for consistency .",
    "consider @xmath82 .",
    "then we get @xmath83 putting this into eq .",
    "( [ eqmixedsecondderivativeestimatefirst ] ) or ( [ eqmixedsecondderivativeestimatesecond ] ) we recover the result which can be obtained for the isotropic implementation , where only non - mixed second derivatives are needed : @xmath84    before we further analyse the properties of these approximation formulas let us at first review our basic equation .    as previously mentioned we consider only the part of eq .",
    "( [ eqconductionfinalsecondapproach ] ) parallel to the magnetic field ( the first term ) .",
    "the term conducting along the temperature gradient can be handled isotropically , which is described in @xcite .",
    "we start by writing the equation in component form : @xmath85}}. \\label{eqanisoconductioncomponents}\\ ] ] furthermore , we define the components of a tensor @xmath86 as @xmath87    next , we write the equation only in terms of mixed second derivatives : @xmath88    now we use eq .",
    "( [ eqmixedsecondderivativeestimatefirst ] ) and ( [ eqmixedsecondderivativeestimatesecond ] ) to estimate the second derivatives in eq .",
    "( [ eqconductionanisosecondderivatives ] ) .",
    "re - factoring the terms leads to a compact expression for particle _",
    "i _ : @xmath89}}\\bmath{\\nabla}_i { \\ensuremath{w_{ij}}}.\\ ] ] finally , we discretise the integral and rewrite the temperature to specific internal energy : @xmath90}}\\bmath{\\nabla}_i { \\ensuremath{w_{ij}}}\\label{eqansiofinalfinal }          \\end{array}\\ ] ] with the mean molecular mass @xmath3 and the adiabatic index @xmath91 .",
    "this equation allows us to calculate the effects of anisotropic conduction without an additional sph loop .",
    "one convenient property is that we managed to generate the term @xmath92 like in the isotropic conduction case .",
    "this ensures only conduction if the temperatures of two particles differ and the sign takes care of the heat flux direction .",
    "there might still be a problem with this approximative formula . to ensure the correct flow of internal energy from hot to cold ( according to the second law of thermodynamics ) the tensor @xmath93 must be positive definite . however , from the definition of a variable with tilde ( eq .",
    "( [ eqtildevariabledef ] ) ) we see , that this tensor does not necessarily fulfil this condition . for",
    "a very anisotropic setup heat flows in the wrong direction .",
    "in addition to a violation of classical thermodynamics this leads to numerical instabilities . to overcome this problem we have basically two options which are both artificial and",
    "therefore might negatively influence onto our discretisation formula in general :    1 .   implement a limiter in the code , which checks for non physical heat flows .",
    "2 .   change the tensor to a more isotropic version , which is always positive definite .    since it is more straight forward and computationally cheaper we follow @xcite and use the second option : we add an isotropic component to the anisotropic tensor in order to prevent temperature flowing from cold to warm regions .",
    "we already have a pure isotropic component which is however proportional to @xmath94 and it is not clear if this is already sufficient .",
    "therefore , we do not forget about this _ fully anisotropic _ formulation , but further investigate the behaviour in our tests and cluster simulations in the next sections .",
    "we add an artificial isotropic component and replace the tensor @xmath95 by @xmath96 calculations carried out by @xcite show that we need to set @xmath97 .",
    "we use the minimum value to prevent a large error in the estimate .",
    "this leads to @xmath98 , which is computationally very cheap since we have to compute @xmath99 for each particle , anyway .",
    "we call this formulation the _ isotropised _ discretisation",
    ".    we can check , that @xmath99 itself is positive definite by diagonalising it : @xmath100    similar problems of non physical heat fluxes arise also in grid code solutions and are not an intrinsic problem of sph formulations ( see e.g. * ? ? ?",
    "finally , we address the time integration of the resulting equation .",
    "@xcite show how to apply a symmetry enforcing finite difference scheme .",
    "this is a fairly simple and computationally cheap approach , however , they conclude that a kernel averaging of the temperature is required to suppress the effects of small - scale noise in the temperature distribution .",
    "therefore , an additional sph loop is required , which greatly increases the computational cost .    in contrast , @xcite considered an implicit integration scheme . that requires again an additional sph loop but has the advantage of much more accurate results for larger conduction time steps , therefore reducing the computational cost .",
    "they chose the so called conjugate gradient ( cg ) method which is basically an algorithm to solve a matrix inversion problem .",
    "instead of fully inverting the matrix , it is also used as an iterative approximation method with very good convergence properties .",
    "a detailed discussion of the algorithmic properties is for example given by @xcite .",
    "due to the advantages in overall computational cost and precision we use the conjugate gradient method to solve the anisotropic conduction equation . at",
    "first , we need to ensure , that our equation suffices the requirements of the cg solver . to discuss the properties consider the following equation which we want to solve for the vector @xmath101 : @xmath102 for the algorithm to succeed , we place a few constraints on the matrix @xmath103 : it needs to be real , symmetric and positive definite .",
    "because the equations do not contain imaginary parts , the first condition is always fulfilled .",
    "symmetry corresponds to conservation of energy , which should always be fulfilled for an energy transport scheme .",
    "if this was not the case self - consistently from the derivation , we would have to symmetrise the result afterwards .",
    "derived above have to be multiplied by @xmath104 .",
    "] we see if this property is fulfilled after writing down the equation explicitly as a matrix inversion problem .",
    "the positive definiteness can be argued as follows : in the continuous limit the matrix becomes diagonal .",
    "positive definite for a symmetric and real matrix means that the eigenvalues are positive . in our case",
    "this corresponds to heat being transported only anti - parallel to the temperature gradient following the 2nd law of thermodynamics .",
    "we argued about positive definiteness already in section [ finalnumerics ] : the fully anisotropic formulation can violate this condition , which can therefore lead to non - physical heat flows as well as numerical instabilities , since the cg method in principle requires it to be given .",
    "the isotropised version is constructed such that it definitely fulfils positive definiteness .",
    "now we show how to write eq .",
    "( [ eqansiofinalfinal ] ) in cg formalism .",
    "discretising the timestep using @xmath105 we get for the part along the magnetic field lines @xmath106 with @xmath107    we can then write this as the matrix equation @xmath108 with :    * @xmath109 * @xmath110 * @xmath111    now , we check again if the energy is conserved properly ( except for numerical errors ) .",
    "@xmath95 and therefore @xmath112 and @xmath103 are symmetric , which is exactly the property we identified with energy conservation .",
    "for the isotropised version we get the same equations just without the tilde above each @xmath99 and therefore same argumentation holds .",
    "next , we carry out several tests for the different implementations .",
    "we use rather simple test cases for which we can verify the behaviour analytically , before we apply it to a physically challenging problem like galaxy cluster evolution .    for all of the following tests we use initial conditions with `` glass - like '' particle distributions .",
    "therefore , we rule out any alignment effects which arise by the definition of a grid .",
    "even if the test setups could be done in one or two dimensions , we perform all tests in a fully three dimensional set - up .",
    "furthermore , we run the simulations with gas only and disable any accelerations on the sph particles which would come from self - gravity or the mhd equations . with this approach ,",
    "we ensure that hydrodynamical properties like the density and the internal energy are computed correctly in their respective sph loops , but we evolve only the conduction equation to thoroughly test the behaviour of our implementations .",
    "we always start by describing a test case and the derivation of an analytic solution . we are only be able to derive an analytic solution for a constant conduction coefficient , which we enforce in our code for the test problems instead of using spitzer conduction .",
    "afterwards we show the behaviour of the existing code ( i.e. isotropic conduction ) with a reference run and further present our results with the new anisotropic approaches ( fully anisotropic and isotropised ) .    finally , we present a more complicated test , where we allow a temperature dependent spitzer conduction and check the influence of different prescriptions for perpendicular suppression .      at first , we reproduce the first test of @xcite and slightly modify it , so that we can apply it to the new anisotropic conduction implementation .",
    "the basic idea is to set - up a temperature step and let the particles exchange heat .",
    "we fix the particle positions ( and also the magnetic field , which we add later ) and therefore only evolve the conduction equation . also considering a fixed conduction coefficient instead of spitzer conduction we can pull the @xmath5 out of the divergence and",
    "get @xmath113 this simplified conduction equation can be solved analytically ( depending on the initial conditions ) and we compare to the simulation results .",
    "we assume a gas with constant density and use @xmath114 with the specific heat capacity @xmath115 .",
    "we rewrite eq .",
    "( [ eqsimplifiedconductioneq ] ) to @xmath116 with the so called thermal diffusivity @xmath117 , which is simply a diffusion coefficient , as discussed in section [ anisotropicthermalconduction ] .",
    "for this temperature step problem it is sufficient to solve the equation in one dimension .",
    "the more general solution can be inferred later and basically differs only in some pre - factors .",
    "following @xcite and @xcite this equation can be solved through fourier transformation . for details",
    "please see appendix [ appendixtemperaturestep ] .",
    "we describe the initial internal energy distribution with the following step function :    @xmath118    with @xmath119 being the position of the temperature step , @xmath120 the height and @xmath121 the mean value .",
    "we get in total @xmath122    at first , we cross check our calculations with the existing implementation of isotropic conduction . the result",
    "is shown in fig .",
    "[ figconduction1a ] .",
    "the sph particles are directly plotted as black points without any binning or additional smoothing .",
    "the result matches well with the analytic solution .",
    "therefore , the existing implementation works even for sudden temperature jumps .    ) ) , the black dots are sph particles . both solutions match very well . ]",
    "the next step is to include a magnetic field into the test problem to check the new anisotropic implementation . for simplicity",
    "we keep the magnetic field fixed .",
    "we introduce a homogeneous field in direction @xmath123 .",
    "hence , there is an angle of @xmath124 between the @xmath125-field and the energy gradient , which is in our set - up parallel to the @xmath126-axis .",
    "the results of the fully anisotropic conduction version are plotted in fig .",
    "[ figconduction1all ] in the top left box .",
    "this implementation reproduces the analytic solution quite well ; however , we get more scatter than in the run with isotropic conduction .",
    "it is still not yet clear what the origin for this noise exactly is , but for a cosmological simulation this is of less importance , since thermal conduction is not the dominating effect modifying and the scatter is smoothed out .",
    "probably , this formulation does not ensure a positive definite transport matrix , which induces errors into the conjugate gradient solver .",
    "however , we see that for a @xmath124 magnetic field we do not need an artificial isotropisation to obtain a stable solution .",
    "the top right panel shows the results using the isotropised formulation .",
    "clearly , we never get the exact analytic result , since the isotropisation is artificially added into the numerics , but our result is close to the real solution .",
    "in contrast to the fully anisotropic formulation we get less scatter since the anisotropic part of the equation is mixed with an isotropic component and therefore has a weaker effect .",
    "furthermore , we ensure positive definiteness of the transport matrix which guarantees stability of the algorithm .",
    "so far we performed all tests with a magnetic field @xmath124 to the temperature gradient . to exclude the arbitrariness of this choice and to study in more detail the different implementations we carry out the tests also with two other setups :    * a magnetic field along the temperature gradient to check if the isotropic case can be recovered with the new code at sufficient accuracy . * the other extreme case of a magnetic field perpendicular to the temperature gradient to see if the different implementations really recover total suppression of heat flux .    in the middle row of fig .",
    "[ figconduction1all ] we show the results for a parallel magnetic field again for both implementations .",
    "the fully anisotropic implementation recovers the analytic solution very well , however , with some noise .",
    "the amount of noise is about the same as with a the diagonal magnetic field .",
    "since we have no difference to isotropic conduction in the case of a parallel magnetic field we see , that the noise can not origin from computational instability due to a non positive definite transport matrix . in comparison , we find less scatter but",
    "the same expected offset in the isotropised run as before .    in the bottom row",
    "we show similar plots for a magnetic field perpendicular to the temperature gradient . from our preconditions",
    "we expect no conduction in this case , so the initial conditions should stay constant except for numerical noise . for the fully anisotropic derivation we find a rather stable solution , as expected . however , we encounter the regime , where the anisotropy is strong enough for heat to flow in the wrong direction .",
    "we expected that behaviour and therefore , implemented the isotropised variation .",
    "we do not expect to see this behaviour any more in simulations , where other processes are included and immediately damp the instabilities .",
    "the isotropised approach can by construction not show a stable solution for this setup : the anisotropic part may be suppressed , but the isotropic part continues to work independently of the magnetic field .",
    "we find that while the conduction parallel to magnetic field lines is damped , we gain an amplification of the perpendicular component .",
    "these violate the initial assumptions of our derivation for the sake of enforcing a physical heat flux .",
    "we consider different test setups to find out , which formulation should be used .      at last , we check whether our implementation reproduces the common idea to approximate anisotropic conduction by an isotropic implementation damped by a factor of @xmath127 .",
    "we imprint a random magnetic field onto our initial problems and fit the analytic solution with fitting parameter @xmath5 to it .",
    "we find factors of about 0.33 at different times matching our expectations .",
    "the fully anisotropic approach usually shows slightly smaller values than the isotropised version , however the difference is very small .",
    "we emphasize that besides scatter , the shape of the analytic solution is reproduced very well .",
    "we conclude that unphysical errors like in the bottom left part of fig .",
    "[ figconduction1all ] will probably not arise in simulations with turbulent magnetic fields .      since the temperature step test contained an artificial discontinuity we test the code also with a similar setup but taking a smooth temperature distribution .",
    "following @xcite we take a sinusoidal temperature distribution at @xmath128 . at first",
    ", we derive the analytic solution for the initial conditions : @xmath129 with a generic wavenumber @xmath70 .",
    "the result is : @xmath130    assuming periodic boundary conditions we need to add an initial offset to prevent negative energies : @xmath131    we chose the arbitrary values of @xmath132 erg / g and @xmath133 erg / g .",
    "including a magnetic field we expect a reduced conduction with coefficient        we perform this test with both implementations of anisotropic conduction and three magnetic field configurations with @xmath134 , @xmath124 and @xmath135 to the @xmath126-axis .",
    "the results are shown in fig .",
    "[ figconduction2 ] .    basically , we find a similar behaviour as for the temperature step problem : the isotropised impelmentation shows always an offset from the analytic solution ( weaker conduction parallel and stronger conduction perpendicular to the magnetic field ) , while the fully anisotropic implementation reproduces the solution very well .",
    "we emphasise two main differences to our previous results :    the amount of scatter for the fully anisotropic implementation is similar to what we get for the isotropised run .",
    "since there is no strong discontinuity in this setup the amount of scatter is way lower than for the temperature step test .",
    "furthermore , we do not get any numerical artifacts in our results and even full suppression of conduction with a perpendicular magnetic field for the fully anisotropic implementation .",
    "therefore , this approach produces the best results as long as there are no sudden temperature jumps .",
    "next , we test how the code behaves for a more complex scenario .",
    "similar to the second test from @xcite we set - up a sphere of hot gas .",
    "we use spherical symmetric initial conditions for the internal energy in the form of @xmath136 for this test case we only show a qualitative comparison of the different runs , to see if the anisotropy is reproduced well .        in fig .",
    "[ figconduction3 ] we show our test results using isotropic conduction and both anisotropic approaches for a magnetic field in @xmath126 direction .",
    "the comparison shows well the different overall effect of the three implementations .",
    "the more anisotropy the approach contains the lower the temperature decline in the inner region .",
    "additionally , we see the stronger anisotropy in the middle panel compared to the right one through the ellipticity of the resulting profile .    in total , this agrees with our previous findings .",
    "again there are no strange artifacts visible in any of the runs .",
    "we conclude that the fully anisotropic approach should be fairly unproblematic to use while it gives us more exact results according to the properties we formulated at the beginning .",
    "therefore , we consider only this formulation .",
    "finally , we again set up a temperature step problem but now we investigate the behaviour of the suppression mechanism described in section [ anisotropicthermalconduction ] .",
    "we use typical values for temperature and density as they are found in hot regions of galaxy clusters and use a homogeneous magnetic field of the form @xmath137 with .",
    "the results are shown in fig .",
    "[ figconduction4 ] .        at the beginning we set up the temperature step at @xmath138 kpc . the generally expected behaviour is , that the discontinuity propagates to the low temperature regime while the two levels close in on the mean temperature .",
    "we have run the different set - ups with either totally suppressed conduction perpendicular to the magnetic field and both phenomenologically motivated scaling relations presented in section [ anisotropicthermalconduction ] .",
    "we can identify the following different behaviours when varying the magnetic field strength :    * @xmath139 : the magnetic field is strong enough to fully suppress perpendicular conduction no matter which prescription we use .",
    "* @xmath140 : the linear scaling relation results in an increased net conduction while the quadratic scaling still suppresses perpendicular conduction strongly .",
    "* @xmath141 : both prescriptions allow a certain amount of perpendicular conduction however there is no clear relation between both .",
    "the denominator of the suppression factor on the higher energy level is larger than one which results in a stronger suppression when the factor is squared . however , it is smaller than one for the low energy level",
    ". this is illustrated by fig .",
    "[ figconduction4hist ] . * @xmath142 : the relation between linear and quadratic scaling has fully flipped : while both allow for a lot of perpendicular conduction now we get more net conduction with the quadratic formula * @xmath143 : the magnetic field is so weak that it can not suppress perpendicular conduction any more with either of the discussed scaling relations .    .",
    "particles at the higher plateau get a stronger suppression for the quadratic formalism while particles at the lower plateau show the opposite behaviour.,title=\"fig : \" ] initial conditions    in total , we see that a proper treatment of perpendicular conduction is important mostly for very small magnetic field strengths",
    ". we can not judge from this test which prescription is the better , however , it is important to include a prescription if small magnetic fields require proper treatment . additionally , we note that even if we take into account only hot gas , the suppression is still also dependent on density , which means that also particles with stronger magnetic fields can require this proper description .      after all tests",
    "we come to the following conclusions :    * the isotropised formulation for anisotropic conduction ensures that the solving algorithm is stable and does not lead to non - physical heat conduction .",
    "however , it violates the prerequisites we used to derive an anisotropic formulation .",
    "* we find that the fully anisotropic formulation behaves sufficiently well for adequately smooth temperature distributions .",
    "since the degree of instability should be small in comparison to hydrodynamical effects we only apply this formulation in our cosmological simulations .",
    "* we have briefly investigated the effects of different scalings for perpendicular suppression and further inquire their behaviour in simulations of galaxy clusters .",
    "in this section we present zoomed in re - simulations of massive coma - like galaxy clusters selected from large gpc sized cosmological boxes , where the parameters for a @xmath144cdm cosmology with @xmath145 , @xmath146 , @xmath147 and @xmath148 .",
    "we select five clusters from the original set of simulations presented in @xcite to study the effect of thermal conduction within galaxy clusters .",
    "these galaxy clusters have virial masses of @xmath149 corresponding to virial radii of typically @xmath150 . calculated virial properties for all runs are listed in table [ tabcluster ] .",
    "more details about the selection of the galaxy clusters and the generation of the initial conditions can be found in @xcite .    at first",
    ", we select one isolated and relaxed looking galaxy cluster ( ) to perform several simulations testing different settings for the implementation of thermal conduction .",
    "[ figmapsg5699754 ] displays projected temperature maps of 5 mpc wide and thick slices through the cluster , demonstrating the effect of thermal conduction on the temperature structure .",
    "the upper left panel shows the reference run without any thermal conduction .",
    "then , from left to right and top to bottom the suppression factor is reduced ( i.e. the conduction efficiency is increased ) for the case of isotropic heat conduction .",
    "the last panel bottom right shows the result for anisotropic heat conduction , where we include the linearly scaling perpendicular suppression factor as displayed before ( see section [ anisotropicthermalconduction ] ) .",
    "as shown already in @xcite , where similar simulations have been carried out with an earlier version of the implementation of isotropic heat conduction , we see that in such massive ( and therefore hot ) galaxy clusters , isotropic conduction has a strong effect on the temperature distribution . with less suppression of thermal conduction , more heat gets transported from the central part of the cluster to the outskirts and even more dramatically visible , local temperature fluctuations get smoothed out . in contrast , the simulation with anisotropic heat conduction shows only a very mild smoothing of the temperature fluctuations compared to the control run .",
    "this can also be seen in fig .",
    "[ figemissivity1 ] , where we show the emissivity distributions for all the isotropic and one anisotropic run . the larger the isotropic conduction coefficient",
    "the more the distribution is taylored around the mean temperature , ( e.g. the cluster gets more isothermal ) , while the peak increases and shifts to slightly higher temperatures .",
    "2.5 mpc ) of the inner part of the relaxed cluster at @xmath151 .",
    "the upper left panel shows the simulation with isotropic conduction for @xmath152 .",
    "the other three maps show the runs with anisotropic thermal conduction for different treatment of the perpendicular case ( see section- [ anisotropicthermalconduction ] ) . ]    to investigate the effect of details in the different treatment of perpendicular conduction for the anisotropic heat conduction , fig .",
    "[ figmapsg5699754zoom ] shows temperature maps zooming onto the central 2.5 mpc of our test cluster .",
    "here we compare the isotropic thermal conduction with a suppression factor of @xmath153 with three anisotropic runs with different treatment of the perpendicular component : fully suppressed ( ) , linear ( ) and quadratic ( ) proportionality to the magnetic field strength .",
    "it is clearly visible that the detailed choice of treatment of the perpendicular component has a quite significant effect on the outcome .",
    "still , none of the anisotropic runs show such a strong smoothing of local temperature fluctuations as the isotropic conduction simulation , even if we allow for conduction to become rather isotropic for weak magnetic fields .",
    "it also makes a notable difference if we use the linear or the quadratic formula to calculate the perpendicular suppression factor .    ) . ]",
    "this gets again more clear when looking at the emissivity distributions for the different anisotropic runs shown in fig .",
    "[ figemissivity2 ] .",
    "while including a perpendicular suppression coefficient proportional to @xmath54 shrinks the distribution a bit , since it contains overall more conduction , we see clearly a different picture for the case proportional to @xmath37 .",
    "we find that this prescription suppresses conduction perpendicular stronger for most particles which results in less conduction compared to the linear case .",
    "therefore , we see the emissivity distribution broadening again , even beyond the case with zero thermal conduction .    .",
    "the temperature profiles are normalized by the mean temperature within the virial radius for each respective run . ]    a more quantitative analysis is shown in fig .",
    "[ figradialtempprofiles ] , where the scaled , radial temperature profiles are presented in the upper panel . here",
    "it can be clearly seen that the stronger we choose the isotropic conduction coefficient , the more internal energy is transported outwards beyond the virial radius . in agreement with previous studies in @xcite ,",
    "isotropic thermal conduction at a level of 1/3 of the spitzer value already leads to an isothermal temperature distribution in the inner part of the galaxy cluster .",
    "regarding anisotropic conduction we include two runs , the one with full suppression perpendicular to magnetic field lines as well as the one using the linearly scaling suppression factor .",
    "while the totally suppressed run resembles almost zero level of isotropic thermal conduction , the temperature profile of the latter one lies somewhere between @xmath154 and @xmath155 for isotropic thermal conduction .",
    "the entropy profiles in the lower panel are in general more difficult to interpret .",
    "here , already the reference run builds up a significant entropy core ( in line with what was reported for the non ideal mhd simulations in @xcite ) .",
    "their shape is rather similar for all runs and due to combined effects including the different implementations of thermal conduction the trends are not easy to interpret and seem to depend on the local dynamical structures in the core of the galaxy cluster .",
    "as inferred from observations by @xcite with the one predicted for the simulated relaxed cluster with the different treatment of the thermal conduction ( as labelled ) . ]    finally , we can compare the simulated cluster to a sample of observations with _ xmm - newton _ presented by @xcite , where they measured the width of the temperature fluctuations within the central part ( e.g. within @xmath156 ) of a sample of galaxy clusters .",
    "[ figcomp1 ] shows these observational data points over plotted with results for our different implementations of thermal conduction within our simulations .",
    "please note that here we not only use the central galaxy cluster but also make use of a smaller galaxy cluster present within our simulation , which has a temperature of roughly 1 kev .",
    "for the case of isothermal conduction we see that the high isotropic conduction coefficients ( e.g. @xmath157 and @xmath158 ) produce results which are below the observed temperature fluctuations for the high temperature system , similar to the findings in @xcite . for the low temperatures all implementations are consistent with the observations .",
    "in contrast , the anisotropic runs are matching with the simulations without thermal conduction .",
    "interestingly , the simulation with the quadratic dependency of the suppression factors shows the largest temperature fluctuations , in line with the broader temperature distribution shown before .",
    "to enforce the idea of a proper treatment of perpendicular conduction we display the range of suppression factors for all hot particles in one of our simulations in fig .",
    "[ figsupfac ] at several redshifts .",
    "since conduction scales strongly with the temperature of the plasma , we take into account only the most important contributors to thermal conduction , selecting particles within the hot atmosphere of groups and clusters by requesting their temperatures @xmath159 to exceed @xmath160 k. as the typical formation time of clusters and groups is around @xmath161 , the amount of particles within this hot gas phase increases significantly until the redshift approaches @xmath161 . while either suppression formulation results in fairly low suppression factors for the bulk of particles , there are significant differences in the amount of particles which have moderate suppression factors up to the regime of almost unsuppressed conduction",
    ". furthermore , it seems that the quadratic formula produces in general lower factors and therefore less net conduction than the linear one .",
    "as we have already seen in our tests in section [ tempstepperp ] the two formulations show opposite behaviour in different regimes .",
    "this is driven by the distribution of the magnetization of particles .",
    "while in the outer parts of clusters and groups there are many particles which never experienced supernova seeding events and therefore can have very low values of the magnetic field @xmath162 , while in the very high density regions in the cores of clusters and groups , almost all particles have magnetic fields at @xmath3 g levels . still particles sitting in extreme density peaks can also contribute to this opposite behaviour .    to further investigate the effect of the different treatments of thermal conduction we select the same four , coma like galaxy clusters ( _ g0272097 _ , _ g1657050 _ , _ g4606589 _ and _ g6802296 _ ) as in @xcite and simulate them with zero thermal conduction , isotropic conduction at a level of @xmath157 and anisotropic thermal conduction using the linear scaling for the perpendicular case . table [ tabcluster ] lists the general properties of the resulting galaxy clusters .    .calculated virial masses [ @xmath163/h ] , virial radii [ mpc / h ] and mass fraction of collapsed baryons ( stars + gas with @xmath164 ) for all runs .",
    "different conduction settings do not alter the global halo properties significantly .",
    "the fraction of collapsed baryons seems to grow slightly with increasing net conduction . for further cross reference our initial conditions with the numbering used by @xcite . [ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     while the virial properties of the halo are basically unchanged , the amount of condensated baryons in form of stars and cold gas changes with the treatment of thermal conduction",
    ". this fraction slightly grows with increasing net conduction , similar to previous findings @xcite , again indicating that thermal conduction alone is not able to prevent cooling in the centers of cluster .",
    "although , due to the inclusion of magnetic fields , the fraction of condensed baryons is smaller than in previous numerical studies , it is still larger than previous observations @xcite . however , more recent observational studies by @xcite indicate a significantly larger amount of stars in the central galaxies of clusters than previously thought . ultimately , including anisotropic thermal conduction seems not to change the amount of cold baryons in the center of simulated galaxy clusters significantly .",
    "the respective temperature maps for all five clusters with the three settings for thermal conduction are shown in fig .",
    "[ figmapsmoreics ] .",
    "the four additional clusters show a a very similar behaviour as we saw before in the relaxed one .",
    "temperature is transported outwards with the isotropic conduction using @xmath157 , while substructures are strongly smoothed out , where as the run with anisotropic conduction shows only mild smoothing of temperature fluctuations .",
    "one interesting aspect gets clearly visible in fig .",
    "[ figradialtempprofilesall ] , where we present the corresponding radial temperature profiles for five clusters for the three different runs .",
    "again , we see that isotropic conduction leads to a significant flattening of the temperature profile embedding a cold core with varying size and moderate temperature . the simulations without thermal conduction",
    "show a rising temperature profile towards the center with a much larger drop of temperature within the central core .",
    "the simulations with anisotropic thermal conduction where we used the linear scaling for the perpendicular component shows a more bimodal temperature profile .",
    "some clusters show very similar temperature profiles compared to the simulations without any thermal conduction , some have a very pronounced cold core .",
    "the sample is much to small to draw robust conclusions but this indicates that in the case of anisotropic thermal conduction the amount of heat transport is strongly varying with the current dynamical state of the cluster and therefore might contribute to the observed bimodality of cool core and non cool core clusters .",
    "the temperature for all runs drops lower than the specific mean temperature of gas inside the virial radius at about 40 to 45 per cent of the virial radius .     as inferred from observations by @xcite with the one predicted for the set of simulated clusters , including also some less massive ones which are found within the high resolution region of the zoomed simulations .",
    "the different colors correspond to the simulations without thermal conduction ( black ) , isotropic thermal conduction with @xmath165 ( red ) and anisotropic thermal conduction , where the perpendicular term is evaluated using the linear scaling ( pink ) . ]    finally , we compare the temperature fluctuations of the full set of our simulations to the _ xmm - newton _ observations presented by @xcite .",
    "similar as before , beside the central , massive cluster we also take other clusters found in the high resolution region into account , allowing us to get also some objects with various temperatures , sampling the low temperature region . fig .",
    "[ figcomp2 ] shows the comparison of the data with our simulations without thermal conduction , with isotropic conduction using @xmath165 and with anisotropic conduction including linear scaling for the perpendicular component . while the simulated clusters with isotropic conduction using @xmath157 fall significantly below the bulk of data points for clusters above 5 kev , the simulations without thermal conduction and with anisotropic thermal conduction seem to represent the observed data points reasonably well .",
    "still a more clearly selected set of simulated galaxy clusters across the whole temperature range as well as observations in the high temperature regime are needed to draw more robust conclusions .",
    "we derive and discuss a numerical scheme for anisotropic thermal conduction in the presence of magnetic fields .",
    "we present a discretisation for sph and implement our new method into the cosmological simulation code gadget .",
    "we show a variety of standard tests as well as cosmological simulations of galaxy cluster formation with different choice of conduction parameters , where we combined the new conduction implementation with a supernova seeding scheme for the magnetic field ( beck et al .",
    "2013 ) , leading to a self consistent evolution of magnetic fields within the cosmic structures .",
    "our numerical scheme for anisotropic conduction in sph solves the corresponding equations using a conjugate gradient solver , and therefore need only a very small amount of extra computational effort in the mhd version of gadget .",
    "however , the straight forward derivation can violate the second law of thermodynamics in cases of strong anisotropies and large jumps in temperature .",
    "additionally , this can causes an unstable behaviour of the conjugate gradient solver in the presence of extremely sharp jumps of temperature .",
    "typically , this problem is solved by introducing a correction which ensures positive definiteness of the linear equation system by adding an artificial isotropic component . however",
    ", this correction can lead to significant , artificial heat flow perpendicular to the magnetic field and it is therefore questionable if such a numerical correction is useful in a realistic environment , where it can hide the effect of anisotropic conduction . in general , for any realistic situation , our anisotropic implementation with fully suppressed perpendicular term is already stable enough so that we do not have to add an artificial , destructive isotropisation term .",
    "however , a closer look at the term of the perpendicular conduction coefficient reveals that the amount of suppression of the perpendicular conduction coefficients can scale with either with @xmath54 or with @xmath37 @xcite . depending on other plasma properties",
    ", these two scalings can have different relative effect on the amount of perpendicular heat transport . to test them , we perform cosmological simulations of the formation of galaxy clusters with different implementations of the perpendicular transport coefficients . we also compare the results with a fully isotropic implementation of heat transport for different values of the suppression of thermal conduction with respect to the classical spitzer value .",
    "our main results can be summarised as follows :    * temperature maps from simulated galaxy clusters show that isotropic thermal conduction not only transports heat outwards , but also smoothes small - scale features .",
    "anisotropic conduction seems to resemble isotropic transport with coefficients like @xmath166 ; however , prominent substructures in the temperature distribution survive due to insulation by magnetic field lines . *",
    "radial temperature profiles change differently when applying anisotropic thermal conduction depending on the dynamical evolution of the cluster .",
    "some profiles are very similar to those without thermal conduction showing a rising profile with a large drop towards the center while others show a very pronounced cool core .",
    "in contrast , isotropic conduction produce flattened , almost isothermal temperature profiles in the central regions .",
    "* we show the relevance of a proper treatment of perpendicular conduction instead of only parallel transport . at all times",
    "we find a significant amount of particles with temperatures @xmath167 k for which a non negligible perpendicular component is assigned .",
    "these particles sit either in regions with negligible magnetic field or at gas density peaks .",
    "* we calculate emissivity distributions and compare to observed temperature fluctuations of @xcite .",
    "we find that simulations with either zero or anisotropic conduction reflect the observational data points best , whereas isotropic conduction with @xmath168 shows a clear lack of temperature fluctuations compared to the observational data points . in comparison , although clearly visible , the differences for the different descriptions for perpendicular conduction show only mild changes in the amount of temperature fluctuations . here",
    "a significant increase of number of simulated galaxy clusters as well as many more observations of high temperature clusters will be needed to discriminate between them .",
    "* we compare the fractions of cold gas and stars in different simulations and find a weak dependence on the conduction parameters .",
    "conduction seems not to play a key role in suppressing cooling in galaxy clusters , but due to the coupling of the suppression factors to the local dynamical state of the cluster , the anisotropic conduction might contribute to the observed bimodality of cool core and non cool core systems .    in conclusion ,",
    "anisotropic thermal conduction is not a dynamically dominant process within galaxy clusters , but can influence the evolution of small - scale structure . in",
    "contrary to isotropic heat conduction , it produces a reasonable amount of temperature fluctuations compared to observations and still allows locally for transport of heat . in general , it comes only with a small amount of computational cost for cosmological spmhd codes and eliminates the need for a free efficiency parameter . in the future",
    ", a sample of cosmological boxes will allow a better statistical analysis of the detailed temperature structure and the role of anisotropic thermal conduction in galaxy clusters .",
    "this will help to gain further knowledge about the scaling relations of perpendicular conduction or the importance of small - scale plasma instabilities .",
    "we thank volker springel for access to the developer version of gadget .",
    "aa gives special thanks to his colleagues max imgrund , marco huser and carsten uphoff for very useful discussions during the creation of this work .",
    "kd and amb are supported by the dfg research unit 1254 magnetisation of interstellar and intergalactic media and by the dfg cluster of excellence ` origin and structure of the universe ' .",
    "kd is supported by the sfb - transregio tr33 the dark universe.    99    andreon s. , 2010 , mnras , 407 , 263    avara m. j. , reynolds c. s. , bogdanovi t. , 2013 , apj , 773 , 171    balogh m. l. , pearce f. r. , bower r. g. , kay s. t. , 2001 , mnras , 326 , 1228    beck a. m. , lesch h. , dolag k. , kotarba h. , geng a. , stasyszyn f. a. , 2012 , mnras , 422 , 2152    beck a. m. , dolag k. , lesch h. , and kronberg p. p. , 2013 ,",
    "mnras , 435 , 3575    binney j. & cowie l. l. , 1981 , apj , 247 , 464    bogdanovi t. and reynolds c. s. , balbus s. a. , parrish i. j. , 2009 , apj , 704 , 211    bonafede a. , dolag k. , stasyszyn f. , murante g. , borgani s. , 2011 , mnras , 418 , 2234    bregman j. n. , david l. p. , 1989 ,",
    "apj , 341 , 49    brookshaw l. , 1985 , asa proc . , 6 , 207    chandran b. d. g. , cowley s. c. , 1998 , phys . rev .",
    "lett . , 80 , 3077    cleary p. w. , monaghan j. j. , 1999 , j. comp .",
    ", 148 , 227    cowie l. l. , mckee c. f. , 1977 , apj , 211 , 135    dehnen w. , aly h. , 2012 , mnras , 425 , 1068    dolag k. , stasyszyn f. , 2009 , mnras , 398 , 1678    dolag k. , jubelgas m. , springel v. , borgani s. , rasia e. , 2004 , apj , 606 , l97    fabian a. c. , 1994 , ann . rev . of a&a , 32 , 277    fabian a. c. , 2002 , lighthouses of the universe : the most luminous celestial objects and their use for cosmology , springer - verlag , p. 24",
    "fabian a. c. , sanders j. s. , taylor g. b. , allen s. w. , crawford c. s. , johnstone r. m. , iwasawa k. , 2006 , mnras , 366 , 417    frank - kamenezki d. , vorlesungen ber plasmaphysik , veb deutscher verlag der wissenschaften    frank k. a. , peterson j. r. , andersson k. , fabian a. c. , sanders j. s. , 2013 , apj , 764 , 46    golant v. e. , zhilinsky a. p. , sakharov , i. e. , fundamentals of plasma physics , john wiley & sons australia    huba j. d. , 2011 , nrl plasma formulary    jubelgas m. , springel v. , dolag k. , 2004 , mnras , 351 , 423    komarov s. v. , churazov e. m. , schekochihin a. a. , 2014 , mnras , 440 , 1153    kravtsov a. , vikhlinin a. , meshscheryakov a. , 2014 , arxiv:1401.7329    kronberg p. p. , 1994",
    "phys . , 57 , 325    landau l. d. , lifschitz e. m. , 2007 , lehrbuch der theoretischen physik vi hydrodynamik , harri deutsch gmbh    lin y .- t . , mohr j. j. , stanford s. a. , 2003 , apj , 591 , 749    loeb a. , 2002 , new astron . , 7 , 279    narayan r. , medvedev m. v. , 2001 , apj , 562 , l192    owers m. s. , nulsen p. e. j. , couch w. j. , 2011 , apj , 741 , 122    owers m. s. , nulsen p. e. j. , couch w. j. , markevitch m. , 2009 , apj , 704 , 1349    parrish i. j. , stone j. m. , 2005 , apj , 633 , 334    peterson j. r. , fabian a. c. , 2006 , phys .",
    ", 427 , 1    peterson j. r. , kahn s. m. , paerels f. b. s. , kaastra j. s. , tamura t. , bleeker j. a. m. , ferrigno c. , jernigan j. g. , 2003 , apj , 590 , 207    petkova m. , springel v. , 2009 , mnras , 396 , 1383    pistiner s. , shaviv g. , 1996 , apj , 459 , 147    price d. j. , j. comp .",
    "phys . , 231 , 759    rasia e. , lau e. t. , borgani s. , nagai , d. , dolag k , avestruz c. , granato g. l. , mazzotta p. , murante g. , nelson k. , ragone - figueroa c. , apj , 791 , 96    rechester a. b. , rosenbluth m. n. , 1978 , phys .",
    "lett . , 40 , 38    rosner r. , tucker w. h. , 1989 , apj , 338 , 761    ruszkowski m. , lee d. , brggen m. , parrish , i. j. , oh s. p. , 2011",
    ", apj , 740 , 81 ,    saad y. , 2003 , iterative methods for sparse linear systems , 2nd edition , society for industrial and applied mathematics    sarazin c. l. , 2008 , a pan - chromatic view of clusters of galaxies and the large - scale structure : gas dynamics in clusters of galaxies , p. 1 , springer netherlands    sarazin c. , 1986 , x - ray emission from clusters of galaxies , rev .",
    "phys . , 58 , 1    sharma p. , hammett g. w. , 2007 , j. comp .",
    "phys . , 227 , 123    spitzer l. , 1956 , physics of fully ionized gas , interscience publishers    spitzer l. , hrm r. , 1953 , phys . rev .",
    "lett . , 89 , 977    springel v. , 2005 , mnras , 364 , 1105    springel v. , hernquist l. , 2002 , mnras , 333 , 649    springel v. , hernquist l. , 2003 , mnras , 339 , 289    springel v. , yoshida n. , white s. d. m. , 2001 , new astron .",
    ", 6 , 79    taylor g. b. , gugliucci n. e. , fabian a. c. , sanders j. s. , gentile g. , allen s. w. , 2006 , mnras , 368 , 1500    tormen g. , moscardini l. , yoshida n. , 2004 , mnras , 350 , 1397    vazza f. , brunetti g. , gheller c. brunino r. , 2010 , new astron . , 15 695    voigt l. m. , fabian a. c. , 2004 , mnras , 347 , 1130    zakamska n. l. , narayan r. , 2003 , apj , 582 , 162",
    "we show the solution of the modified eq .",
    "( [ eqqnumericstaylor ] ) solved for the second order term , which we need to compute the mixed second derivatives in the conduction equation . at first , the kernel derivative is expressed as @xmath169    looking at the first order error term of the modified eq .",
    "( [ eqqnumericstaylor ] ) , we see , that @xmath170 since for all possibilities of @xmath71 , @xmath91 and @xmath13 there is always at least one component , where the integral vanishes because of an antisymmetric integrand .",
    "all indices range from 1 to 3 , so there is always one component with an odd amount of @xmath171 .",
    "the denominator and @xmath172 are even with respect to @xmath74 , so the integral vanishes .",
    "the next step is to calculate the integrals of the second order error term with a substitute as @xmath173    we distinguish between the following three cases , which we address one after another :    1 .",
    "at least three indices are unequal 2 .   all indices are equal 3 .",
    "the indices form two pairs , e.g. @xmath174 and @xmath175      if at least three of the four indices are unequal , then there is at least one integration where the integrand contains only a single @xmath171 component .",
    "since the denominator and @xmath172 are even functions with respect to @xmath74 , the integrand for this component is in total an odd function which vanishes when integrating over the whole ( symmetric ) domain .",
    "therefore , the integral is zero .      if all indices are equal , we start the calculations with substituting the integration variable @xmath176 without further implications on the integration",
    ". then eq .",
    "( [ eqsecondordererrorterm ] ) simplifies to @xmath177 where we used the short hand notation @xmath178 .",
    "since @xmath172 is only dependent on @xmath179 we choose spherical coordinates for @xmath171 .",
    "we can arbitrarily choose the rotation of our coordinate system . for simplicity",
    "we let @xmath180 be along the @xmath181-axis of the coordinate system .",
    "this results in @xmath182 we can easily perform the @xmath183 and @xmath184 integrations and obtain @xmath185 next , we perform a partial integration , where the boundary term vanishes , since the kernel is monotonically decreasing towards zero . it remains : @xmath186 because of the kernel normalisation condition .",
    "this last case can be calculated pretty similar , except that we have to chose two indices , which have to be unequal .",
    "we choose @xmath187 and @xmath188 . again , written in spherical coordinates we get @xmath189 using the results from the @xmath190-integration before we calculate and the total result is :    @xmath191    so basically @xmath159 is only non zero , if we have two pairs of indices .      plugging everything back into the modified eq .",
    "( [ eqqnumericstaylor ] ) gives : @xmath192 to infer a general behaviour we take a look at an example with @xmath193 @xmath194 since we want to infer an approximation for second order mixed derivatives of @xmath73 , we have to linearly combine terms for different choices of @xmath91 and @xmath13 .",
    "it can be found that , @xmath195 and cyclic permutation for other second derivatives .",
    "a similar formula applies for mixed derivatives . consider for example",
    "@xmath196 it is better to keep both parts separated to explicitly indicate the symmetry for simplicity in the assembly process .",
    "from this example we get directly @xmath197 and cyclic permutations .    combining the equations ( [ eqsecondordernonmixed ] ) and ( [ eqsecondordermixed ] ) we see that all @xmath198 occur times a factor of 5/2 minus a trace term times 1/2 .",
    "this finding is represented by the substition eq .",
    "( [ eqtildevariabledef ] ) in our final result .",
    "we show the derivation of the analytic solution of the conduction equation for the temperature step test ( section [ temperaturestep ] ) .",
    "we start with the fourier transformation of the specific internal energy in both directions :      and @xmath200 the conduction equation expressed in fourier space is @xmath201 with the simple solution @xmath202 using @xmath203 we express the unknown coefficient in terms of the initial condition in real space @xmath204 we insert this result into the reverse fourier transformation ( eq .",
    "( [ eqfourierbacktrafo ] ) ) and obtain @xmath205 at first , we perform the integration over @xmath206 . for this",
    "we rewrite the exponentials completing the square to bring them into gaussian form , which is a simple integration and get @xmath207 at this point we need to use the specific initial conditions of our problem .",
    "for the temperature step they are defined as          we split this expression into two parts : one which is multiplied by @xmath121 and one which is multiplied by @xmath211 .",
    "the @xmath121 term can be simply integrated , since it is again only a gaussian integral , which results in @xmath212 . for a little consistence check",
    "consider @xmath213 then we get @xmath214 , which is what we would expect for a isothermal region without any other effects than thermal conduction ."
  ],
  "abstract_text": [
    "<S> we present an implementation of physically motivated thermal conduction including the anisotropic effects of magnetic fields for smoothed particle hydrodynamics ( sph ) . </S>",
    "<S> the diffusion of charged particles and therefore thermal conduction is mainly proceeding parallel to magnetic field lines and suppressed perpendicular to the field depending on the local properties of the plasma . </S>",
    "<S> we derive the sph formalism for the anisotropic heat transport and solve the corresponding equation with an implicit conjugate gradient scheme . </S>",
    "<S> we discuss several issues of unphysical heat transport in the cases of extreme ansiotropies or unmagnetized regions and present possible numerical workarounds .    </S>",
    "<S> we implement our new algorithm into the cosmological n - body / sph simulation code gadget and study its behaviour in several fully three dimensional test cases . </S>",
    "<S> our test setups include step - functions as well as smooth temperature distributions allowing us to investigate the stability and accuracy of our scheme . in general , we reproduce the analytical solutions of our idealised test problems , and obtain good results in cosmological simulations of galaxy cluster formations . within galaxy clusters , </S>",
    "<S> the anisotropic conduction produces a net heat transport similar to an isotropic spitzer conduction model with an efficiency of one per cent . </S>",
    "<S> in contrast to isotropic conduction our new formalism allows small - scale structure in the temperature distribution to remain stable , because of their thermal decoupling caused by surrounding magnetic field lines . compared to observations , isotropic conduction with more than 10 per cent of the spitzer value leads to an oversmoothed temperature distribution within clusters , while the results obtained with anisotropic thermal conduction reproduce the observed temperature fluctuations well .    a proper treatment of heat transport including the suppression by perpendicular magnetic fields is crucial especially in the outskirts of clusters and also in high density regions . </S>",
    "<S> it s connection to the local dynamical state of the cluster also might contribute to the observed bimodal distribution of cool core and non cool core clusters . </S>",
    "<S> our new scheme significantly advances the modelling of thermal conduction in numerical simulations and overall gives better results compared to observations .    </S>",
    "<S> [ firstpage ]    conduction - magnetic fields - methods : numerical - galaxies : clusters : intracluster medium </S>"
  ]
}