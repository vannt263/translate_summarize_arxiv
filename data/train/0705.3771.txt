{
  "article_text": [
    "the single - point formulas discussed so far are based on eq .",
    "( [ der ] ) , with @xmath57 , and eventually require diagonalizing the hamiltonian at the @xmath2 point only , ergo solving the schrdinger equation with periodic boundary conditions on the supercell .",
    "this is by far the most common choice among car - parrinello practitioners , although other choices are possible .    in order to extend our single - point formulas to more general boundary conditions it would be enough to switch from eq .",
    "( [ der ] ) ( at @xmath58 ) to alternative expressions for the directional derivatives .",
    "the only important requirement is that the two eigenstates therein differ by a supercell reciprocal vector .    for the sake of simplicity we explicitly deal here only with the 2d case of antiperiodic boundary conditions , corresponding to a zone - boundary single point :",
    "in fact , antiperiodic eigenstates obtain by choosing the special @xmath15-vector @xmath59 .",
    "it is then expedient to define even @xmath60 and to switch from eq .",
    "( [ der ] ) to = _ 0 ( - ) , [ der1 ] where now the @xmath61 subscript indicates the derivative in the direction of @xmath62 . in terms of such derivatives the magnetization formula , eq .",
    "( [ mean4 ] ) reads m = i m ( h_0 + _ n0 -2 ) , [ mean5 ] and similarly for the chern number .    in the case of a large supercell we approximate eq .",
    "( [ der1 ] ) with its @xmath57 value , noticing that all the needed states obtain from a single hamiltonian diagonalization at @xmath63 .",
    "in fact @xmath64 and @xmath65 , where @xmath66 is a reciprocal - lattice vector .",
    "while the states @xmath67 are to be used as they stand , the states @xmath68 , @xmath69 , and @xmath70 must be regularized to their dual counterpart , by means of the obvious analogue of eq .",
    "( [ dual ] ) .",
    "one then uses these states in eq .",
    "( [ der1 ] ) with @xmath57 and finally in eq .",
    "( [ mean5 ] ) ."
  ],
  "abstract_text": [
    "<S> the key formula for computing the orbital magnetization of a crystalline system has been recently found [ d. ceresoli , t. thonhauser , d. vanderbilt , r. resta , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 74 * , 024408 ( 2006 ) ] : it is given in terms of a brillouin - zone integral , which is discretized on a reciprocal - space mesh for numerical implementation . </S>",
    "<S> we find here the single @xmath0-point limit , useful for large enough supercells , and particularly in the framework of car - parrinello simulations for noncrystalline systems . </S>",
    "<S> we validate our formula on the test case of a crystalline system , where the supercell is chosen as a large multiple of the elementary cell . </S>",
    "<S> we also show that  somewhat counterintuitively  even the chern number ( in 2d ) can be evaluated using a single hamiltonian diagonalization .    </S>",
    "<S> the position operator @xmath1 is ill - defined within periodic boundary conditions . owing to this , </S>",
    "<S> both the macroscopic ( electrical ) polarization and the macroscopic orbital magnetization are nontrivial quantities in condensed - matter theory . </S>",
    "<S> the former has been successfully tamed since the early 1990s , when the modern theory of polarization , based on a berry phase , was developed.@xcite the latter , instead , remained an unsolved problem until 2005 . since then , several important papers have appeared@xcite and continue to appear.@xcite before 2005 only linear - response properties related to orbital magnetization were successfully addressed,@xcite while we stress that the present work , as well as refs .  , addresses `` magnetization itself '' .    </S>",
    "<S> a general formula , valid for crystalline systems within a given single - particle hamiltonian , was provided in ref .  </S>",
    "<S> , hereafter referred to as i. this is the magnetic analogue of the ( by now famous ) king - smith and vanderbilt formula for electrical polarization.@xcite both formulas are discretized on a regular mesh of @xmath0 points for numerical implementation </S>",
    "<S> . however , most simulations for noncrystalline systems , particularly those of the car - parrinello type,@xcite are routinely performed by diagonalizing the hamiltonian at a single @xmath0 point ( the @xmath2 point ) in a large supercell . </S>",
    "<S> the reduction from many points to a single point is far from being trivial ; nonetheless a successful single - point formula for electrical polarization emerged since 1996 , and is universally used since then.@xcite we provide here the magnetic analogue of such formula . as a byproduct </S>",
    "<S> , one can even evaluate the chern number  @xcite using a single @xmath0 point . </S>",
    "<S> this looks like an oxymoron , given that the chern number is by definition a loop integral in reciprocal space : but our formula can be regarded as the limiting case where the loop shrinks to a single point .    </S>",
    "<S> the general formula of i applies to normal periodic insulators ( where the chern invariant vanishes ) , chern insulators ( where the chern invariant is nonzero ) , and metals . </S>",
    "<S> aiming at first - principle implementations within any flavor of dft , the single - particle hamiltonian is the kohn - sham one.@xcite as for the analogous case of electrical polarization , there is no guarantee that the kohn - sham magnetization coincides with the actual one . </S>",
    "<S> nonetheless , previous studies within linear - response methods indicate that even for orbital magnetization the error is small.@xcite    as in i , we assume a vanishing macroscopic magnetic field @xmath3 , hence a lattice - periodical hamiltonian . we let @xmath4 and @xmath5 be the bloch eigenvalues and eigenvectors of @xmath6 , respectively , and @xmath7 be the corresponding eigenfunctions of the effective hamiltonian h_= e^-i h e^i ; [ hk ] we normalize them to one over the crystal cell of volume @xmath8 . as in i </S>",
    "<S> , the notation is intended to be flexible as regards the spin character of the electrons . </S>",
    "<S> if we deal with spinless electrons , then @xmath9 is a simple index labeling the occupied bloch states ; factors of two may trivially be inserted if one has in mind degenerate , independent spin channels . </S>",
    "<S> for the sake of simplicity , we rule out the metallic case here . for both normal insulators and chern insulators the macroscopic orbital magnetization @xmath10 is , according to i : m _ & = & - [ m ] + & & i m _ </S>",
    "<S> n d*k * ( h_+ _ n -2 ) , where greek subscripts are cartesian indices , @xmath11 is the antisymmetric tensor , @xmath12 , @xmath13 is the chemical potential ( fermi energy ) , the integration is over the reciprocal cell , and the sum over cartesian indices is implied . for insulators </S>",
    "<S> the number of states with energy @xmath14 is independent of @xmath15 ; we implicitly understand the sum in eq .  </S>",
    "<S> ( [ m ] ) as on these states only .    as usual , </S>",
    "<S> a noncrystalline system can be dealt with in a supercell framework , by addressing an artificial crystal with a large unit cell , actually larger than the relevant correlation length . </S>",
    "<S> one key feature of eq .  ( [ m ] ) is its gauge - invariance in the generalized sense : by this we mean that eq .  </S>",
    "<S> ( [ m ] ) is invariant by unitary mixing of the occupied states among themselves at a any given @xmath15 . </S>",
    "<S> thanks to such key feature eq .  </S>",
    "<S> ( [ m ] ) is invariant by cell doubling . </S>",
    "<S> in fact , starting with a cell ( or supercell ) of given size , we may regard the same physical system as having double periodicity ( in all directions ) , in which case the integration domain in eq .  </S>",
    "<S> ( [ m ] ) gets `` folded '' and shrinks by a factor @xmath16 , while the number of occupied eigenstates gets multiplied by a factor of @xmath17 . </S>",
    "<S> it is easy to realize that these are in fact _ the same _ eigenstates as in the unfolded case , apart possibly for a unitary transformation , irrelevant here . as for actual computations , the discretized form of eq .  </S>",
    "<S> ( [ m ] ) adopted in i turns to be invariant by cell doubling to within @xmath18 , provided the @xmath0-point mesh is chosen consistently .    for a large supercell of volume @xmath8 </S>",
    "<S> the integration domain in eq .  </S>",
    "<S> ( [ m ] ) becomes small . </S>",
    "<S> therefore the integral can be accurately approximated by the value of the integrand at @xmath19 , times the reciprocal - cell volume : m _ - i m _ </S>",
    "<S> n ( h_0 + _ </S>",
    "<S> n0 -2 ) . </S>",
    "<S> [ mean ] notice that eq .  </S>",
    "<S> ( [ m ] ) can be safely approximated with eq .  </S>",
    "<S> ( [ mean ] ) because the _ integrand _ is a gauge - invariant quantity ; the apparently analogous case of polarization is more difficult , since the integrand therein is gauge - dependent , and the single - point formula requires a less straightforward treatment.@xcite as for the derivatives in eq .  </S>",
    "<S> ( [ mean ] ) , they can be evaluted in two ways : either `` analytically '' ( by means of perturbation theory ) , or `` numerically '' ( by means of finite differences ) .    </S>",
    "<S> the analytical - derivative approach relies on the perturbation formula = _ m n , [ pert ] where @xmath20 is the @xmath21-component of the velocity operator = i[h , ] = . </S>",
    "<S> _ h_|_=0 . </S>",
    "<S> [ v ] eq .  ( [ pert ] ) is convenient for tight - binding implementations , where the sum is over a small number of terms . </S>",
    "<S> we also notice that the matrix representation of @xmath22 , for use in eqs .  </S>",
    "<S> ( [ hk ] ) and ( [ v ] ) , is usually taken to be diagonal on the tight - binding basis .    </S>",
    "<S> the numerical - derivative approach looks more convenient for first - principle implementations , since it requires neither the ( slowly convergent ) sum over states , nor the matrix elements of the velocity operator . in order to give the most general formulation for non - rectangular cells it is expedient to switch to a coordinate - independent form . in order to shorten the equations , in all of the following developments of eq .  </S>",
    "<S> ( [ mean ] ) a sum over the occupied states is implied .    if @xmath23 are the shortest reciprocal vectors of the supercell , eq .  </S>",
    "<S> ( [ mean ] ) can be identically recast as - i m ( h_0 + _ n0 -2 ) . </S>",
    "<S> [ mean2 ] where a sum over @xmath24 is implied , and @xmath25 indicates the partial derivative in the direction of @xmath23 : = _ 0 ( - ) . </S>",
    "<S> [ der ] notice that eq .  </S>",
    "<S> ( [ der ] ) implicitly assumes that @xmath26 is a differentiable function : but this is generally _ not _ the case when the eigenstates are obtained from numerical diagonalization . </S>",
    "<S> the discretization must then be done in a specific gauge : as in i , we fix the problem by adopting the `` covariant derivative '' approach , introduced in refs .   and  . </S>",
    "<S> one defines the overlap matrix @xmath27 , and the `` dual '' states = _ </S>",
    "<S> n s^-1 _ nn ( ) , [ dual ] which enjoy the property @xmath28 . using this , approximating eq .  </S>",
    "<S> ( [ der ] ) with its @xmath29 value , and inserting in eq .  </S>",
    "<S> ( [ mean2 ] ) we finally get - i m ( h_0 + _ n0 -2 ) . </S>",
    "<S> [ mean3 ] next , we wish to evaluate @xmath30 without actually diagonalizing the hamiltonian at @xmath31 . </S>",
    "<S> to this aim , we notice that the state @xmath32 obeys periodic boundary conditions and is an eigenstate of @xmath33 corresponding , possibly , to a different occupied eigenvalue . </S>",
    "<S> the transformation in eq .  </S>",
    "<S> ( [ dual ] ) restores the correct ordering anyhow ; therefore we can simply identify @xmath34 , transform to the dual states by means of eq .  </S>",
    "<S> ( [ dual ] ) , and insert into eq .  </S>",
    "<S> ( [ mean3 ] ) which eventually becomes the single - point , @xmath35 formula , aimed at .    for a two - dimensional ( 2d ) system </S>",
    "<S> the magnetization is a pseudoscalar , and the analogue of eq .  </S>",
    "<S> ( [ mean3 ] ) reads m = - i m ( h_0 + _ </S>",
    "<S> n0 -2 ) . </S>",
    "<S> [ mean4 ] similarly , the single - point formula for the chern number reads c = - i m . </S>",
    "<S> [ chern ]     ( @xmath36 ) . </S>",
    "<S> solid lines connecting nearest neighbors indicate a real hopping amplitude @xmath37 ; dashed arrows pointing to a second - neighbor site indicates a complex hopping amplitude @xmath38 . </S>",
    "<S> arrows indicate sign of the phase @xmath39 for second - neighbor hopping . ]    as in previous works ,  @xcite we find expedient to validate the present findings on the haldane model hamiltonian:@xcite it is comprised of a 2d honeycomb lattice with two tight - binding sites per primitive cell with site energies @xmath40 , real first - neighbor hoppings @xmath37 , and complex second - neighbor hoppings @xmath41 , as shown in fig .  </S>",
    "<S> [ fig : haldane ] . within this two - band model , </S>",
    "<S> one deals with insulators by taking the lowest band as occupied . following the original notations@xcite </S>",
    "<S> we choose the parameters @xmath42 , @xmath43 and @xmath44 . as a function of the flux parameter @xmath39 , </S>",
    "<S> this system undergoes a transition from zero chern number to @xmath45 when @xmath46 . </S>",
    "<S> here we address periodic supercells made of @xmath47 primitive cells , up to @xmath48 ( 2048 sites ) , taking the lowest @xmath49 orbitals as occupied .    before actually addressing magnetization , we start benchmarking the accuracy of our single - point formula for the chern number , whose value is known exactly as a function of the parameters of the model . </S>",
    "<S> the convergence of the chern number  computed from eq .  </S>",
    "<S> ( [ chern ] ) and its analytical - derivative analogue  as a function of the supercell size , is shown in fig .  </S>",
    "<S> [ fig : f2 ] , for @xmath50 , where the exact value is 1 . both approaches ( analytical and numerical derivative ) </S>",
    "<S> converge very fast . </S>",
    "<S> for instance the numerical - derivative approach yields an error of @xmath51 for @xmath52 , and smaller than @xmath18 for @xmath48 . </S>",
    "<S> we are showing here the results for a @xmath39 value well inside the @xmath53 domain . </S>",
    "<S> we also find that the convergence worsens near the transition point @xmath54 .    numerical evaluation of chern numbers is a staple tool in the theory of the quantum hall effect , where supercells are routinely used to account for disorder and/or electron - electron interaction . </S>",
    "<S> however , even in a supercell framework , a discrete reciprocal mesh ( or equivalently a mesh of phase boundary conditions ) has been invariably used in the algorithms implemented so far.@xcite here we have shown that , provided the supercell is large enough , no mesh is needed : the chern number can be evaluated from a single hamiltonian diagonalization ( with a single choice of boundary condition ) . </S>",
    "<S> the rationale behind our finding is simple : the chern number is by definition an integral , whose integration domain shrinks to a single point in the limit of a large supercell .    </S>",
    "<S> the single - point orbital magnetization @xmath55 of the model system , computed from eqs .  </S>",
    "<S> ( [ mean ] ) and ( [ mean4 ] ) as a function of the supercell size , is shown in fig .  </S>",
    "<S> [ fig : f3 ] , again for @xmath56 . in this case </S>",
    "<S> the analytical - derivative approach converges definitely better , showing in fact the same kind of relative error as the chern number , while the numerical - derivative approach proves somewhat less accurate .    in conclusion </S>",
    "<S> , we provide here the key formulas for computing the orbital magnetization of a condensed system from first principles in a supercell framework and using a single @xmath0 point , to be used as they stand within car - parrinello simulations in an environment which breaks time - reversal symmetry . </S>",
    "<S> we have validated the present formulas on a simple tight - binding model hamiltonian in 2d , and checked their ( fast ) convergence with the supercell size . </S>",
    "<S> last but not least , we have proved that even the chern number  which has a paramount relevance in quantum - hall - effect simulations  can be computed from a single hamiltonian diagonalization , and converges fast with the supercell size .    </S>",
    "<S> we acknowledge fruitful discussions with d. vanderbilt and t. thonhauser . </S>",
    "<S> work partly supported by onr through grant n00014 - 03 - 1 - 0570 . </S>"
  ]
}