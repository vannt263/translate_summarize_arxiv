{
  "article_text": [
    "the fundamental laws of physics can ( without exceptions ) be related to certain continuous symmetries . in other words , by requiring that a model should be invariant with respect to a certain symmetry , the model is more or less completely determined .",
    "the standard model of particle physics @xcite and gravitation @xcite are examples of such theories .    as an example , a model with a complex scalar field , i.e. , a model of charged bosons , and a requirement of local @xmath0-invariance , or gauge invariance ,",
    "will immediately yield the maxwell - klein - gordon ( mkg ) theory , which in the non - relativistic limit reduces to maxwell - schrdinger theory .",
    "in addition to defining the theory , the continuous symmetries give rise to conserved quantities through noether s theorem(s ) @xcite , and the local @xmath0-symmetry of the mkg - model ensures the conservation of local electric charge .    in particle physics , and especially in the qcd - part of the standard model , numerical calculations",
    "are often done using lattice gauge theory ( lgt ) @xcite .",
    "this is a numerical procedure , actually motivated from the continuous theory , designed to preserve the underlying continuous gauge symmetry . in a previous article",
    "this discretization scheme was applied to the mkg - equation , with emphasis on the continuous @xmath0-symmetry and conservation laws deduced from discrete versions of noether s theorem(s ) @xcite . by preserving the @xmath0-symmetry of the mkg - model on the discrete level , a discrete equivalent of the conservation of local electric charge is immediate , which not only makes the scheme consistent , but is also a good indicator of stability . by a more standard discretization of the model , the local @xmath0-symmetry",
    "is broken , which again implies that the scheme is not consistent with the continuous formulation .",
    "this will also reveal itself through the fact that the physical observables calculated are dependent on the gauge chosen , obviously in conflict with the continuous model .",
    "a similar breaking of the continuous local @xmath0-symmetry has been a known issue with discretizations of the schrdinger equation coupled to an external electromagnetic field .",
    "for example in atomic physics , results are known to depend on the gauge in which the calculation is done @xcite  a most unfortunate situation indicating that the calculations are not correct .",
    "gauge dependence also leads to interpretation problems of the results .",
    "it is the goal of the present paper to show how gauge invariant discretizations may be built from existing ones with little or no extra effort in the implementations .",
    "simple gauge invariant grid discretizations of schrdinger operators have been studied in previous articles in the lgt formalism with promising results @xcite .",
    "the key to success in lgt is that it does not approximate the covariant derivative as a linear combination of the gradient and the gauge potential , an element of the lie - algebra under consideration , since such an approximation leads to non - local terms when discretizing the gradient , and a question of gauge invariance is meaningless since one compare fields at different spacetime points .",
    "instead lgt uses forward - euler / central difference approximation of the gradient in the various directions , which as argued is not gauge invariant , and then defines the covariant derivative through the way non - local terms are made gauge invariant in the continuous theory .",
    "this is done via the wilson line @xcite , to be discussed in the next section , which effectively localize non - local terms by parallel transport with the gauge potential as a key ingredient . by defining the covariant derivative in this way , the discrete theory is immediately manifestly gauge invariant .",
    "the aim of this article is to expand the lgt formulation to allow for completely general grid discretizations in arbitrary local coordinates of the spatial manifold .",
    "grid discretizations are widely used , and include most numerical discretizations of schrdinger operators in use today , such as pseudospectral methods based on the discrete fourier transform or chebyshev polynomials .",
    "we also generalize the discussion to arbitrary coordinate systems , and some care is needed in case some of the coordinates are periodic when using global approximations ( e.g. , chebyshev or fourier expansions ) .",
    "the paper is organized as follows : in section [ sec : schroedinger ] we introduce the time dependent schrdinger equation in general coordinates . in section [ sec : discretization ] and [ sec : covariant ] we discuss gauge invariant spatial grid discretizations .",
    "we proceed in section [ sec : time ] to discuss gauge invariant time integration .",
    "finally , in section [ sec : results ] we present some numerical results shedding light on the difference between gauge invariant and gauge dependent schemes , before we close with some concluding remarks in section [ sec : conclusion ] .",
    "we consider a particle with charge @xmath1 and mass @xmath2 coupled to an external electromagnetic ( em ) field @xcite @xmath3 .",
    "this is a semiclassical approach because the em - field is obviously affected by the particle , but if we assume that the coupling is weak the approximation can be justified .",
    "we will work in the non - relativistic regime , but our considerations could easily be transmitted to a relativistic model .",
    "moreover , the generalization to more than one particle is straightforward , since the em fields only enter a many - body hamiltonian at the one - body level , i.e. , the interparticle interactions are independent of the em fields .",
    "we are considering a spacetime domain @xmath4 , with coordinates @xmath5 , where @xmath6 is the time coordinate , and",
    "@xmath7 is a point in the spatial domain , usually taken to be euclidean space , but can in general be a riemannian manifold . in any case , we may work in local coordinates @xmath8 , viz , @xmath9 , with the induced metric tensor @xmath10 assumed to be time - independent .",
    "the wavefunction at some time @xmath11 is then a complex valued scalar function @xmath12 .",
    "in addition , the em - field is described by a gauge potential @xmath13 , where @xmath14 is a real valued function and @xmath15 is a real valued one - form . in coordinate basis one usually identifies one - forms with vectors .",
    "thus , if @xmath16 are basis one - forms and @xmath17 are basis vectors there is a one - to - one correspondence between @xmath18 and @xmath19 .",
    "note , we use the einstein summation convention except where noted",
    ". the components of @xmath15 and @xmath20 are related by the metric , i.e. @xmath21 , and the physical em fields @xmath3 are given by @xmath22 where we use the shorthand @xmath23 .    in the following we work in units such that @xmath24 .",
    "the dynamics of the system is governed by the time dependent schrdinger equation reading @xmath25\\psi(t , x ) , \\ ] ] where @xmath26 is the covariant derivative in the temporal direction , and where the `` covariant laplace - beltrami '' operator @xmath27 is defined by @xmath28 with @xmath29 being the covariant derivative in the direction @xmath30 .",
    "moreover , @xmath31 is the ( generalized ) canonical momentum operator .",
    "the term @xmath32 is simply the kinetic energy operator , and @xmath33 is an external potential .",
    "a fundamental property of the time dependent schrdinger equation is that it is invariant under local gauge transformations , i.e. equation is invariant under the following set of transformations @xmath34 where @xmath35 is a real valued function meaning that @xmath36 , the lie - algebra of @xmath0 ( consult e.g. @xcite for theory on lie - groups and lie - algebras ) .",
    "one says that the theory is invariant under local @xmath0-transformations , meaning that the physical observables are not affected by the transformations .",
    "in particular , we note that the electric and magnetic fields are not affected by the transformations . moreover ,",
    "if @xmath37 $ ] is an observable , then the expectation value @xmath38 is gauge invariant , viz , @xmath39 where @xmath40 denotes the standard inner product in @xmath41 .    the usual way to write eqn .",
    "( [ eq : schroedinger ] ) is @xmath42\\psi(t , x),\\notag\\end{aligned}\\ ] ] where the hamiltonian @xmath43 depends on the fields @xmath44 .",
    "it is well - known that for any two @xmath11,@xmath45 , the formal solution to is given by @xmath46 , where the propagator @xmath47 is @xmath48 with @xmath49 being the standard time - ordering operator .",
    "the propagator depends on the fields @xmath44 in the case of the current hamiltonian , and under a gauge transformation with parameter @xmath50 we have @xmath51 where @xmath52 and @xmath53 .",
    "many discretizations of eqn .   approximate the wave function @xmath54 at a given time @xmath6 on a finite grid @xmath55 ( i.e. , @xmath56 ) in order to obtain a semi - discrete formulation in which @xmath57 $ ] still depends continuously on time",
    ". we shall here consider grids which in the local coordinates are cartesian products of one - dimensional grids , i.e. , @xmath58 where @xmath59 figure [ fig : grid ] illustrates this in the case of polar coordinates in the plane .",
    "we may list the elements of @xmath55 using multi - indices , i.e. , @xmath60 and the multi - indices may again be mapped one - to - one with @xmath61 , where @xmath62 is the total number of grid points .",
    "thus , we obtain a discrete hilbert space @xmath63 $ ] of dimension @xmath64 .    .",
    "in local coordinates @xmath65 the grid @xmath55 is a cartesian product , while in on the manifold @xmath66 the grid instead has a ( discrete ) rotational symmetry .",
    "a coordinate curve for constant @xmath67 is also illustrated . in this case , the curve becomes a circle . ]    the natural basis to use in the space @xmath68 is the set of functions @xmath69 such that @xmath70 .",
    "these functions are referred to as the cardinal basis @xcite or the nodal basis . for any @xmath71",
    ", we now have @xmath72 a linear operator @xmath73 on @xmath74 may be represented by its action on this basis , which determines an @xmath75 matrix with elements @xmath76 , viz , @xmath77(x_\\beta).\\ ] ] thus , for @xmath71 , @xmath78(x_\\alpha ) = \\sum_\\beta x_{\\alpha\\beta}\\psi(x_\\beta).\\ ] ] at times , we will omit the brackets and write @xmath79 for the product @xmath80 evaluated at @xmath81 , as usually there is no danger of confusion .",
    "likewise , multiplication by @xmath82 ( or any continuous @xmath83 over @xmath84 ) defines a linear operator , and for @xmath71",
    "we will write this simply as @xmath85 .    the grid discretization invariably comes with a discrete approximation to the ( field - free , i.e. , @xmath86 ) laplace - beltrami operator @xmath87 , although the exact procedure to fix this discrete operator may vary .",
    "we may assume that this discretization is composed of discrete derivatives in each spatial direction @xmath88 composed with some fixed functions of the coordinates , but the exact form is of no consequence to us .    to clarify these statements ,",
    "consider for example cartesian coordinates in two spatial dimensions for which @xmath89 . in a finite difference approximation we typically have a standard 5-point central difference stencil , i.e. , @xmath90 where @xmath91 is a forward difference , @xmath92 a backward difference , so that @xmath93 is the standard 3-point central difference operator in the @xmath88-direction , viz , @xmath94 ,     \\label{eq : stencil}\\ ] ] with @xmath95 being the mesh width .",
    "we have suppressed other spatial coordinates than @xmath96 in the latter equation .    as a different example , consider polar coordinates @xmath97 in two dimensions , for which @xmath98 the form of the radial part of this operator leads initially to several different schemes by either expressing it as @xmath99 and _ then _ discretizing , or instead attack the original difference operator . in a general coordinate system there will of course be even more possibilities .    in any case , the discrete laplace - beltrami operator will be on the form @xmath100 where @xmath101 are arbitrary approximations to each partial derivative @xmath102 .",
    "we abuse notation a little , as in general we allow @xmath103 . in the cartesian",
    "coordinate example above , @xmath104 .",
    "in general , however , we assume that like in this example , @xmath105 is the product of @xmath30 discrete derivative operators @xmath106 , @xmath107 , so that @xmath108 with @xmath109 .    the usual way to discretize @xmath27 , on the other hand , which we here will call a",
    "`` nave '' discretization , is to employ a similar `` recipe '' as in the examples to eqn .",
    "after insertion of @xmath110 and simplifying the expression .",
    "this , however , _",
    "always _ leads to non - gauge invariant discretizations , as we will discuss in section [ sec : covariant ] .    as an example of the nave approach ,",
    "consider again the polar coordinate case , and for simplicity assume @xmath111 for which we obtain @xmath112 assuming further that @xmath113 , i.e. , that @xmath15 is given in the coulomb gauge , we get @xmath114 the nave discretization of eqn .",
    "is then given by inserting the usual grid discretizations of @xmath115 , @xmath116 and @xmath117 .",
    "our prescription for a manifestly gauge invariant discretization of @xmath27 in eqn .   is simply to replace _ all _ occurrences of approximations @xmath118 of @xmath119 in the field - free nave discretization with a certain corresponding approximation @xmath120 to @xmath121 , derived using methods from lgt as mentioned in the introduction , and whose final expression is given in eqn .",
    "( [ eq : global - discrete - cov2 ] ) below . in other words ,",
    "@xmath122 which will be gauge invariant .",
    "this approximation is often quite different from the standard nave discretization .",
    "consider first the case when @xmath84 is a one - dimensional manifold @xmath123 .",
    "the reason for this is that in the general case , the differentiation operator @xmath119 can be viewed as a differential operator on the coordinate curves , these being one - dimensional manifolds .",
    "similarly , a generic discrete @xmath91 can be viewed as an operator acting on grid functions over the one - dimensional `` coordinate grids '' obtained by fixing all but the @xmath124th component of the multi - index @xmath125 in eqn .  .",
    "equivalently , @xmath91 defines a discrete differentiation operator acting on functions over a discretization of the coordinate curve ; see fig .",
    "[ fig : grid ] .",
    "any one - dimensional manifold @xmath84 will _ either _ be topologically equivalent to a circle _ or _ an interval , which may be bounded or unbounded .",
    "for example , in polar coordinates @xmath126 in @xmath127 the angular coordinate curves are circles of radius @xmath67 while the radial coordinate curves are rays from the origin @xmath128 to infinity with an angle @xmath129 relative to the @xmath130-axis .",
    "we write @xmath131 for the sole coordinate , omit the time dependence , and @xmath132 for the covariant derivative . under gauge transformations ,",
    "@xmath133 transforms as @xmath134 =    e^{{\\mathrm{i}}q\\lambda(x ) } d_a e^{-{\\mathrm{i}}q\\lambda(x)},\\ ] ] where @xmath135 .",
    "intuitively , since @xmath84 is one - dimensional , one should be able to transform away @xmath136 completely , by selecting @xmath137 .",
    "however , if @xmath84 is ( topologically ) a circle ( with the point @xmath138 identified with @xmath139 , for simplicity ) , this is not possible : there are one - forms @xmath136 which are _ not _ the derivative of some zero - form @xmath140 . on the circle , it is precisely the constant functions @xmath141 , since then @xmath142 is _ not _ a zero - form : it is not periodic in @xmath130 unless @xmath143 ! if , on the other hand , @xmath84 is topologically an interval , @xmath136 may be transformed away .",
    "these considerations may become clearer when we observe that , locally , we may write @xmath144 where @xmath145 whenever @xmath84 is topologically an interval , we can choose @xmath137 , and this expression is global , since then @xmath146 for @xmath84 being topologically a circle , no such @xmath140 exists globally , unless @xmath143 .      let @xmath68 be the discrete hilbert space corresponding to an @xmath64-point discretization of @xmath147 , being either a circle or an interval as described above .",
    "thus , @xmath148 is given by @xmath149 in the case of a circle , we identify @xmath150 and @xmath151 to impose periodic boundary conditions .",
    "we let @xmath152 be the mesh width , and typically @xmath153 .",
    "let @xmath154 be a discrete differential operator on @xmath155 , and we assume for the moment that @xmath154 is a _ local _ operator , in the sense that as @xmath156 , only a finite number of points in the neighborhood of @xmath157 are used to differentiate @xmath158 . as a consequence , there is a largest @xmath159 such that for any smooth function @xmath160 over @xmath161 , @xmath162 where the term @xmath163 is equal to the truncation error , and we say that @xmath154 is a @xmath164th order approximation",
    ". examples of local discretizations are finite differences of any order , but not pseudospectral methods using for example chebyshev polynomials or the discrete fourier transform .    for any ( discrete or smooth ) @xmath165 , the nave discretization @xmath166 of @xmath133 reads @xmath167 this operator is not gauge invariant .",
    "let @xmath140 be given , and consider @xmath168 clearly , this comes about since @xmath169 is only an approximation .",
    "however , the continuous covariant derivative @xmath133 comes about if one tries to construct a gauge invariant classical field theory @xcite : since for any differentiable @xmath165 , @xmath160 and @xmath170 transforms differently if @xmath171 , the limit @xmath172\\ ] ] has no simple transformation law .",
    "notice that for finite @xmath95 , @xmath173/h$ ] is the standard forward difference operator .",
    "we could just as well consider the limit @xmath174 for any local discrete differentiation operator .    introducing a comparator function @xmath175 with the transformation law @xmath176 we see that for any @xmath177 , the function @xmath178 transforms in the same way as @xmath160 .",
    "explicitly , the comparator is given by @xmath179 for any finite @xmath95 , consider again the discrete difference operator @xmath154 applied to @xmath178 , but acting on the variable @xmath177 , i.e. , @xmath180(x_k ) .",
    "\\label{eq : local - discrete - cov}\\ ] ] the notation implies that the discrete derivative is evaluated at @xmath181 .",
    "this operator is obviously gauge invariant , so that @xmath182    the path from @xmath130 to @xmath177 is in general ambiguous if @xmath84 is a circle : we may move either clockwise or anti - clockwise , and also through several revolutions before ending up at @xmath177 .",
    "however , as @xmath156 , we desire our discrete @xmath183 to converge to @xmath133",
    ". the truncation error does not vanish unless we choose the _ shortest _ path , with vanishing length .",
    ".   implies that for any smooth @xmath160 , @xmath184(x ) = d_a\\psi(x ) + o(h^p).\\ ] ]      the fact that @xmath154 was a _",
    "local _ approximation to the derivative was crucial above , as it allowed us to resolve path ambiguity .",
    "approximation this is not the case .",
    "a global approximation @xmath185 to @xmath186 in general has _ exponential _ order of approximation as it utilizes _ all _ grid points @xmath187 to estimate the derivative .",
    "that is , for any smooth @xmath160 , the truncation error is @xmath188 , i.e. @xmath189 so that the order of approximation in fact increases as @xmath190 .",
    "as @xmath175 may depend on path , and as @xmath130 and @xmath177 have arbitrary separation in a global method , the limit @xmath156 does not resolve the path ambiguity .",
    "the only way to overcome this , is to ensure that the comparator itself is path - independent .",
    "this is the case if and only if @xmath191 for some smooth @xmath192 , since then the fundamental theorem of analysis yields @xmath193 independently of the path taken . for @xmath84 being a circle , this means that @xmath136 must be the derivative of a _ periodic _ function .",
    "we therefore decompose the one - form @xmath136 as @xmath194 where @xmath195 is a constant such that @xmath196 for some smooth @xmath140 .",
    "formally , @xmath195 is the projection of @xmath136 onto the orthogonal complement of the range @xmath186 , i.e. , @xmath197 .",
    "the decomposition is unique and it always exists .",
    "we may say that @xmath198 is the `` largest part of @xmath15 that may be transformed away . ''",
    "we then obtain @xmath199 for the covariant derivative .",
    "it is clear that if @xmath195 is nonzero , it may never be transformed away using a gauge transformation .    in the case of @xmath84 being an interval , @xmath200 , implying @xmath201 , and we get @xmath202 where any anti - derivative of @xmath136 may be used . for @xmath84 being a circle , however , @xmath203 since @xmath204 is not periodic unless @xmath143 .",
    "it is straightforward to show that @xmath205    we define a modified path independent comparator given by @xmath206.\\ ] ] since it is independent of path , we may write @xmath207 where @xmath208 is any reference point . combining eqns .",
    "( [ eq : with - constant ] ) and ( [ eq : local - discrete - cov ] ) we get @xmath209(x_k ) - { \\mathrm{i}}q a_0 \\psi(x_k ) ,    \\label{eq : global - discrete - cov}\\ ] ] and using eqn .",
    "we may rewrite this as @xmath210 which may be a more practical expression to implement . this covariant derivative is valid for any one - dimensional manifold topology and any discretization of the derivative , and we note that in particular for @xmath143 , it is equivalent to the original expression for local discrete derivatives .      for global methods ,",
    "the one - dimensional case necessitated the computation of @xmath195 given by eqn .  .",
    "as the covariant derivative in this case was gauge equivalent to using the nave discretization with a constant @xmath211 , one may wonder what we have to gain from the approach in this case : why not use the standard nave discretization using this particular , and physically equivalent , gauge ?",
    "most manifolds are , however , not one - dimensional . in this section , the case of @xmath212 being a general @xmath213-dimensional manifold is treated by simply defining @xmath183 for each spatial direction . in this case",
    "it is in general _ not _ true that the method becomes gauge equivalent to a nave discretization : we may not find an @xmath15 such that the problem may be solved with a nave discretization .",
    "said in another way , on @xmath214 , the splitting becomes @xmath215 where @xmath216 is the part of @xmath15 which may not be transformed away , and this is of course not a constant function in general .    in the @xmath217th direction , at the point @xmath218 , the continuous covariant derivative",
    "is given by @xmath219 being an operator that constructs the @xmath217th component of a one - form field , i.e. , @xmath220\\psi(x)$ ] is a one - form field with components @xmath221 .",
    "as discussed in section [ sec : discretization ] , we are given discretized derivative operators @xmath222 ( we suppress the subscript `` @xmath95 '' in the sequel , and also the distinction between local and global discrete differentiation operators @xmath223 ) which only involves grid points along the @xmath217th coordinate curve at @xmath224 ; see fig .  [",
    "fig : grid ] for an illustration .",
    "thus , @xmath222 may be viewed as a discrete derivative on discretization of a one - dimensional manifold ( the @xmath217th coordinate curve at @xmath81 ) with grid @xmath225 . from section [ sec : one - dim ]",
    ", we then have the discrete covariant derivatives @xmath226 given by @xmath227 where @xmath228 is the quantity @xmath195 in eqn .",
    "( [ eq : decomp1d ] ) for @xmath229  in general not a constant since it depends on the other coordinates @xmath230 , @xmath231 .",
    "neither is it given by the decomposition .",
    "moreover , @xmath232 ( or more precisely @xmath233 ) is the corresponding path - independent comparator for differentiation in the @xmath217th direction .    to be precise , we write out these quantities in the general case .",
    "the quantity @xmath234 is zero for coordinate curves that are topological intervals , such as the radial coordinate curves in polar coordinates . for periodic coordinates , such as the angle @xmath129 in polar coordinates , the coordinate curves are circles . in that case , @xmath235 where @xmath236 is the length of the coordinate curve . in polar coordinates , @xmath237 , and @xmath238 .",
    "the comparator function @xmath239 is now given by @xmath240 where the arbitrary reference point has been chosen as @xmath241 .",
    "gauge invariance of @xmath226 follows from the gauge invariance in the one - dimensional case .",
    "clearly , gauge invariance necessitates calculating the comparator functions and @xmath228 .",
    "however , these enter the discretizations only as multiplicative operators which are diagonal in the nodal basis .",
    "it is therefore a one - time calculation inducing little overhead in general .",
    "thus far we have studied a discretization of the time - dependent schrdinger equation in continuous time . however ,",
    "when solving the problem numerically one needs to discretize the model in time as well .",
    "again , with inspiration from classical lgt this can be done manifestly gauge invariant for every scheme with a grid based approximation of the time derivative .    the standard way to propagate",
    "the schrdinger equation ( [ eq : schroedinger ] ) is to attack the form instead , viz , @xmath242\\psi(t , x ) ,    \\label{eq : schroedinger - noncovariant}\\ ] ] and then use standard techniques to integrate , analogously to the nave spatial discretizations .",
    "however , this will of course lead to non - gauge invariant solutions .",
    "let us consider how gauge invariant formulations of some simple schemes can be constructed . for simplicity",
    ", we will assume that the wave function @xmath54 is only sampled at equally spaced points in time , i.e. , @xmath243 with @xmath244 .",
    "at each time @xmath245 , we write @xmath246 for the corresponding spatially discrete wave function .",
    "let @xmath247 be a local approximation , and assume that a nave discretization of a generic schrdinger equation with hamiltonian @xmath43 is given by @xmath248 where @xmath249 is the hamiltonian @xmath43 evaluated at @xmath250 . here , @xmath251 are constants , the notation indicating that only a finite number of such constants are involved .",
    "such schemes include the standard implicit crank - nicholson and leap - frog schemes @xcite .",
    "for the crank - nicholson scheme , @xmath252 is the forward euler discretization , while @xmath253 ( @xmath254 and @xmath255 ) . for the leap - frog scheme , @xmath252 is the centered difference with step length @xmath256 and @xmath257 ( with @xmath258 ) . using similar considerations as in section [ sec : covariant ] for spatial differentiation operators ,",
    "the corresponding gauge invariant discretization of for arbitrary fields @xmath14 becomes @xmath259 where @xmath260 , with @xmath261 being the comparator for the time coordinate .",
    "the hamiltonian @xmath262 is given by @xmath263 and _ excludes _ the term @xmath264 which is now absorbed into the covariant derivative @xmath265 .",
    "we now observe something peculiar : the scalar field @xmath266 may be transformed away _ globally _ by the gauge parameter @xmath267 , yielding the so - called temporal gauge . in this gauge @xmath268",
    ", so the gauge invariant scheme reduces to the nave scheme  of course with a different hamiltonian @xmath269 .",
    "in fact , these considerations hold for _ any _ gauge invariant numerical integration scheme : gauge invariance implies that the temporal gauge in particular may be used , for which the integration method reduces to the nave non - gauge invariant scheme applied to @xmath270 .",
    "notice , however , that the latter operator is _ time dependent _ , even if @xmath271 and the fields @xmath15 and @xmath14 are time - independent functions .    to make this statement precise ,",
    "let @xmath272 be a general numerical propagation scheme for a generic hamiltonian @xmath43 , i.e. , it approximates the propagator @xmath273 in eqn .  , viz , @xmath274 where @xmath275 is the truncation error of the scheme .",
    "thus , the wave function @xmath276 is propagated by @xmath277    assuming that @xmath278 is a gauge invariant generalization of @xmath279 applied to the hamiltonian @xmath280 , it must transform according to eqn .  .",
    "the temporal gauge is achieved by selecting @xmath281 given by @xmath282 which gives @xmath283 we obtain @xmath284 where @xmath285 must be equal to the original gauge dependent propagator applied to the hamiltonian @xmath286 .",
    "it is not always easy to identify an expression for @xmath287 in a general gauge , but from the above considerations , the temporal gauge is sufficient anyway .",
    "the selection of a particular gauge for time integration may seem unnatural .",
    "however , it is the structure of the schrdinger equation together with the fact that any field @xmath14 may be transformed away that yields this conclusion .",
    "the vector potential @xmath15 can not in general be transformed away  therefore we should not choose a particular gauge for spatial operators .",
    "@xcite , some promising gauge invariant eigenvalue calculations are shown using the classical lgt formalism , i.e. , with standard finite differences in space . in ref .",
    "@xcite higher - order finite differences are used , and the results are equally promising .",
    "even though the published experiments are all with the `` standard '' example of a uniform magnetic field in the @xmath288-direction applied to a planar system , there is little doubt that the gauge invariant formulations offer favorable properties over the non - gauge invariant methods , as there are always gauges that behave very badly .",
    "one may simply choose a rapidly oscillating gauge parameter @xmath50 to completely destroy the accuracy .",
    "choosing the `` right gauge '' in a non - gauge invariant scheme may not at all be simple or even possible . in any case , a gauge independent method will `` factor out '' any non - physical effect of the choice of gauge , making interpretations easier , and it is reasonable to expect that gauge invariance should stabilize the discretization because of this .",
    "we focus here on time integration only .",
    "the benefit of employing spatially gauge invariant schemes has already been established in e.g. @xcite .",
    "a gauge invariant discretization of the time - dependent schrdinger equation could enable practitioners to push the limits of what is possible to compute and interpret .",
    "we consider a single particle in a one - dimensional system ; a very simple system but one whose numerical properties are reflected in more realistic settings .",
    "we set @xmath289 , and consider the schrdinger equation on the form @xmath290\\psi(t , x ) = -\\frac{1}{2}[\\partial_x -    ia(t , x)]^2\\psi(t , x ) .",
    "\\label{eq : se1d}\\ ] ] we consider a spatial truncation @xmath291\\subset\\mathbb{r}$ ] , and use a finite difference discretization with @xmath292 equally spaced grid points @xmath293 , @xmath294 .",
    "the grid spacing is given by @xmath295 .",
    "thus , at a time @xmath11 , @xmath296 is our discrete wave function .",
    "a common situation in atomic physics arise when one considers the so - called dipole approximation @xcite , in which the fields @xmath15 and @xmath14 take the form @xmath297 corresponding to a time - dependent electric field @xmath298 and @xmath299 .",
    "these fields are of course not solutions of maxwell s equations . the particular gauge in eqn .",
    "is referred to as the length - gauge .",
    "the so - called velocity gauge is obtained by transforming away @xmath266 using the gauge parameter @xmath300 , i.e. , it is the temporal gauge .",
    "we obtain @xmath301 the wave functions in the two gauges are of course related by @xmath302 .",
    "these two gauges are commonly studied , and may give different results in actual calculations ; a sure sign of a significant error .    a common choice for @xmath303 is @xmath304 describing an oscillating electric field with frequency @xmath305 .",
    "using finite differences , a typical nave semi - discretization of eqn .",
    "is @xmath306\\psi(t , x_j ) \\notag \\\\ & = & \\frac{1}{2}\\left[-\\delta^+\\delta^- + { \\mathrm{i}}(a\\delta^- +    \\delta^+ a ) + a^2 + 2\\phi\\right]\\psi(t , x_j ) .",
    "\\label{eq : se1d2}\\end{aligned}\\ ] ] where @xmath307 is a forward difference , and @xmath308 is a backward difference . as earlier , @xmath15 and @xmath14",
    "should be interpreted as diagonal multiplication operators . as @xmath309 , it is easy to see that the operator on the right hand side of eqn .",
    "is actually hermitian .",
    "the corresponding gauge invariant semi - discretization is , in the temporal gauge , @xmath310\\psi(t , x_j ) ,    \\label{eq : se1d3}\\ ] ] with @xmath311 $ ] being the comparator function .    to integrate eqns .   and",
    "in time , we select a somewhat non - standard approach .",
    "it is well - known that an approximation to @xmath273 for a given hamiltonian @xmath43 is @xmath312 where the error is @xmath313 .",
    "propagating @xmath314 using @xmath315 gives an error increasing roughly linearly as function of the number of time steps .",
    "the integral is evaluated using gauss - legendre quadrature using two evaluation points , giving practically no error in the integral as long as @xmath303 does not oscillate too rapidly .",
    "we choose @xmath316 and @xmath317 for the electrical field , and integrate for @xmath318 , so that the electric field oscillate exactly three times before we terminate the calculation .",
    "the spatial domain is of length @xmath319 , and we use @xmath320 points .    we choose @xmath321 as initial condition ( which is normalized numerically in the calculations ) .",
    "the analytic solution using this particular problem ( on whole of @xmath322 ) can be computed in closed form , but we choose instead to perform a reference calculation using a pseudospectral discretization using @xmath323 points and a much smaller time step , giving in this case practically no error .",
    "figure [ fig : numerical1 ] shows the error @xmath324 as function of @xmath11 in the three cases . clearly , the velocity gauge has somewhat smaller error , and also the length gauge and gauge invariant calculations have almost indistinguishable errors .",
    "the latter fact can easily be understood by inserting @xmath325 into the semi - discrete formulations , and noting that @xmath326 and @xmath327 are unitarily equivalent , i.e. , having the same eigenvalues .",
    "the semidiscrete equations are thus actually equivalent , and any discrepancy showing in the graphs for the gauge invariant scheme and the length - gauge calculation comes from errors in the time integration .",
    "the spectrum of @xmath328 is _ not _ equivalent to that of @xmath326 when @xmath329 , however .",
    "in fact , it is readily established that the latter operator has eigenvalues depending strongly on @xmath15 , and therefore on the particular gauge used .",
    "hence , it is expected that the velocity gauge , or any other gauge in which @xmath329 , should perform _ worse _ than either of the other gauges in the generic case .",
    ".[fig : numerical1 ] the velocity gauge ( dashed / dotted green ) has somewhat larger error than the gauge invariant ( solid black ) and the length gauge ( dotted red ) calculations .",
    "the low error in the velocity gauge is a `` stroke of luck '' when compared with fig .",
    "[ fig : numerical2 ] , where the velocity gauge has the largest error .",
    "notice that the oscillations of the em - fields clearly affect the errors . ]    to test this statement , we perform a calculation using a different field @xmath266 in the length gauge , namely @xmath330 which may describe incoming electromagnetic waves ( e.g. , a laser ) along the @xmath130 axis .",
    "figure [ fig : numerical2 ] shows the errors as function of @xmath11 in this case , using @xmath331 , clearly showing that the velocity gauge indeed has the larger error .",
    "moreover , a `` mixed gauge '' calculation is shown , where the length gauge fields are transformed using a gauge parameter @xmath332 , chosen somewhat arbitrarily .",
    "now , both @xmath15 and @xmath14 are non - vanishing , and the error is seen to behave accordingly .",
    "we notice that the gauge invariant calculations in both cases are well - behaved , and no choice of gauge will of course affect the calculations . moreover ,",
    "the length gauge is equivalent to the gauge invariant calculations _ only _ when @xmath86 ; this holds in general in one dimensional systems , but of course not in arbitrary dimensions , where the magnetic field usually can not be transformed away in this way .",
    ".[fig : numerical2 ] the gauge invariant ( solid black ) and the length gauge ( dotted red ) calculations have the smallest errors , while the velocity gauge ( dot - dash , green ) has clearly the largest error .",
    "this should be contrasted with the results in fig .",
    "[ fig : numerical1 ] , where the velocity gauge has the smallest error . ]",
    "we have discussed a method based on lgt to convert virtually any grid - based scheme for the time - dependent schrdinger equation ( [ eq : schroedinger2 ] ) to a gauge invariant scheme , in both space and time .",
    "we have considered discretization in arbitrary coordinates on arbitrary spatial manifolds .",
    "the theory is directly generalizable to many - particle systems as the em - fields obviously only enter at one - body level in the many - body hamiltonian .",
    "moreover , the computational overhead of the gauge invariant schemes compared to the original ones are negligible .    our numerical simulations of time - dependent problems , albeit simplistic , indicate that the gauge invariant schemes perform on average better than standard schemes , even though the original `` nave '' scheme may be better in specific cases ."
  ],
  "abstract_text": [
    "<S> grid - based discretizations of the time dependent schrdinger equation coupled to an external magnetic field are converted to manifest gauge invariant discretizations . </S>",
    "<S> this is done using generalizations of ideas used in classical lattice gauge theory , and the process defined is applicable to a large class of discretized differential operators . in particular , popular discretizations such as pseudospectral discretizations using the fast fourier transform can be transformed to gauge invariant schemes . </S>",
    "<S> also generic gauge invariant versions of generic time integration methods are considered , enabling completely gauge invariant calculations of the time dependent schrdinger equation . </S>",
    "<S> numerical examples illuminating the differences between a gauge invariant discretization and conventional discretization procedures are also presented . </S>"
  ]
}