{
  "article_text": [
    "with fast - growing computer technology , monte carlo ( mc ) simulations have with much success been used to study various statistical systems including neural networks , problems in biology and chemistry , lattice - gauge theories and optimisation problems in various areas , not to mention statistical physics , to study the properties of phase transitions and critical phenomena .",
    "most mc simulations concentrate on importance sampling for the canonical or microcanonical gibbs ensemble , introduced by metropolis _",
    "et al _ @xcite .",
    "the thermodynamic average , @xmath0 , of an observable @xmath1 can be estimated @xcite as @xmath2 where @xmath3 represents a configuration at time @xmath4 of a system with hamiltonian @xmath5 , @xmath6 is the inverse temperature ( with boltzmann constant @xmath7 ) , @xmath8 an averaging time ( with @xmath9 ) , and @xmath10 a sampling probability .",
    "if @xmath10 is chosen to be constant , very few samples contribute significantly to the sums in the above equation , and a very long time is required to get a reasonable estimate of @xmath0 .",
    "importance sampling comes in if one chooses @xmath10 as the boltzmann weight @xmath11 .",
    "it is generally a good sampling algorithm , but can fail to access all the parts of the phase space in available computer time . indeed , in many situations , this approach or similar ones face severe ergodicity problems if there exist many high barriers between all the possible lowest- ( or nearly - lowest- ) energy configurations , as , e.g. , in certain lennard - jones systems ( see , e.g. , @xcite ) and in spin glasses ( see , e.g. , @xcite ) , to cite only two examples from statistical physics .    to overcome these , at least for a large part , it has been suggested that it could be more efficient to reconstruct the gibbs ensemble from a simulation with other ensembles ( e.g. , a so - called `` multicanonical mc simulation '' ) than to simulate it directly ( see @xcite and references therein ) .",
    "one of these approaches goes under the name of the _ entropy sampling monte carlo method _ ( esmc ) .",
    "it works as follows .",
    "let the probability of occurence of a configuration @xmath12 with energy @xmath13 be denoted as @xmath10 , and the probability of occurence of a state with energy @xmath13 as @xmath14 .",
    "the term `` state '' stands here for the set of all configurations that have the same energy .",
    "they are related to each other through @xmath15 where i have introduced the entropy , @xmath16 , of the state with energy @xmath13 .",
    "their number is @xmath17 . in the metropolis mc method @xcite ,",
    "the canonical distribution of states is obtained , along with ergodicity , by a markovian sequence in which the transition probabilities , @xmath18 and @xmath19 , between a pair of configurations @xmath12 and @xmath20 are determined by the _ detailed balance _",
    "condition @xmath21}{\\exp[-\\beta e(x)]}\\,\\ , .\\ ] ] it can be shown rigorously that , in the case of a traditional mc simulation , this condition ensures a simulation of the system with an equilibrium distribution which is just the gibbs distribution @xcite .",
    "the esmc method is , however , based on the probability distribution of states , in which the probability of occurence of a configuration with energy @xmath13 is proportional to the exponential of the _ negative _ entropy , @xmath22 in a esmc simulation the probability of occurence of a configuration with energy @xmath13 is therefore anti - proportional to the number of configurations with that energy . in this way , the probabilities of occurence of all states equal the same constant .",
    "an mc algorithm that does the job is one that is based on the detailed balance condition @xmath23}{\\exp[-s(e(x))/k]}\\,\\ , .\\ ] ] in all other aspects , the formalism of the esmc procedure follows then the usual metropolis procedure .",
    "it is therewith easy to show ( using the methods exhibited , e.g. , in @xcite ) that the esmc algorithm simulates the system in such a way that all states occur with the same probability .",
    "hence , the algorithm provides for a ( one - dimensional ) _ random walk through the system s energy space_.    in this spirit , monte carlo sampling with respect to unconventional ensembles has received some attention ( see , e.g. , @xcite and references therein ) in recent years . in the `` multicanonical ensemble ''",
    "approach @xcite , one samples configurations such that the exact reconstruction of canonical expectation values becomes feasible for a desired temperature range .",
    "multicanonical and related sampling has allowed considerable gains in situations with `` supercritical '' slowing down , such as    \\(i ) first order phase transitions @xcite , ( for a recent review see , e.g. , @xcite ) ,    \\(ii ) systems with conflicting constraints , such as spin glasses @xcite or proteins @xcite .",
    "the reconstruction of canonical expectation values requires knowledge of the entropy values of the / an important part of the energy range ( see equation ( [ erg ] ) ) , but leaves innovative freedom concerning the optimal shape @xcite .",
    "considerable practical experience exists only for algorithms where one samples such that :    \\(a ) the probability density is flat in a desired energy range @xmath24 .",
    "\\(b ) each configuration of fixed energy @xmath13 appears with the same likelihood .",
    "it should be noted that condition ( b ) is non  trivial . a simple algorithm @xcite exists to achieve ( a ) , but which gives up ( b ) .",
    "exact connection to the canonical ensemble is then lost .",
    "such algorithms are interesting particularly for hard optimisation problems , but may be unsuitable for canonical statistical physics . the present paper focuses on achieving ( a ) and ( b ) .    to achieve a flat energy distribution , the appropriate unnormalised weight factor in equation ( [ erg ] ) is @xmath16 . however , before simulations , the entropy function @xmath16 is usually not known .",
    "otherwise we would have solved the problem in the first place . presumably , reluctance about simulations with an a  priori unknown weight factor is the main reason why the earlier umbrella sampling @xcite never became popular in statistical physics .    in the more recent papers [ 934 ]",
    "it has been suggested to overcome this loophole by simulating with approximate entropy values , obtained by guessing or a short gibbs run , and then successively simulating with ever better estimates of the real entropy . for , if an incorrect entropy function , @xmath25 , is used in equation ( [ dbs ] ) instead of @xmath16 , then the states with @xmath26 will have a larger probability to occur than in an exact esmc simulation , and , therefore , will be sampled more frequently ; similarly , those states with @xmath27 will have a smaller one and will be sampled less frequently . because the entropy function , @xmath16 , is proportional to the logarithm of the number of configurations in the corresponding states , which in turn is proportional to the number of visits to the states expected by the simulation , an iterative process in which runs with ever better",
    "@xmath28 are construed can be constructed . in practice ,",
    "one simulates with @xmath29 for an `` appropriately '' long time , then @xmath30 is constructed , one simulates with @xmath30 for some time , etc , and one hopes , supported by intuition , that the @xmath28 gradually approach the exact @xmath16 .",
    "this assumption has , however , up to now never been shown to hold rigorously , nor is there anything known on convergence properties .",
    "nevertheless , for first order phase transitions in non - random systems , like ferromagnets , the problem of the a  priori unknown weight factor in the above algorithms is rather elegantly overcome by means of finite size scaling methods @xcite .",
    "a sufficiently accurate estimate is obtained by extrapolation from the already simulated smaller lattices .",
    "the smallest lattices allow still for efficient canonical simulations . for systems with conflicting constraints",
    "the situation is less satisfactory .",
    "considerable attention `` by hand '' may be needed .    in this paper ,",
    "i investigate more closely the recently proposed _",
    "free energy monte carlo _",
    "algorithm @xcite from which the entropy can be obtained in the large - time limit without attention `` by hand '' .",
    "i have applied the algorithm to the infinite - range , the two - dimensional and the three - dimensional ferromagnet .",
    "where possible , i have compared the results to the values that are known exactly",
    ". one further application of the algorithm is the surmounting of energy barriers and/or a thorough exploration of the system s energy space . in this paper ,",
    "i concentrate on magnetic systems , which have a discrete energy spectrum .",
    "however , the algorithm is easily extended to other systems ( whose energy spectrum would have to be discretised for the use of a computer anyway ) .    in the next section ,",
    "i describe the algorithm and show that , under certain conditions , the algorithm converges indeed towards the correct entropy distribution .",
    "numerical results are exhibited in the third section .",
    "i conclude finally in the last section with some outlooks and further comments concerning the application of this algorithm to systems other than magnets .",
    "i will now specify the algorithm which achieves the goal of obtaining the entropy function in the large - time limit .",
    "for definiteness , i will formulate the algorithm for ising spin systems , containing a total number of @xmath31 spins .",
    "i will enumerate the different states of the system by their energy , going from smallest to largest in value .",
    "let @xmath32 denote the energy of the state with label @xmath33 , say @xmath34 ( so that @xmath35 is the total number of energy levels ) .",
    "let furthermore @xmath36 be the ( estimated ) entropy of the state with label @xmath33 , at time @xmath37 . at time @xmath38 ,",
    "i initialise @xmath39 for all @xmath33 .",
    "we will see below that only entropy differences matter in the algorithm so that the initialisation constant can in principle be chosen arbitrarily .",
    "the initialisation to zero is , however , preferable in the actual implementation of the algorithm on a computer , as mentioned below .",
    "the _ free energy monte carlo _ ( femc ) algorithm then works as follows .",
    "let us assume that , at time @xmath37 , the system is in configuration @xmath12 , with energy @xmath40 , i.e. , with label @xmath41 .",
    "then , go through the following steps at time @xmath42 :    1 .   select one spin index @xmath43 for which the spin @xmath44 is considered for flipping ( @xmath45 ) .",
    "2 .   calculate the transition probability @xmath46 to pass from configuration @xmath12 to configuration @xmath20 which is obtained from @xmath12 by effectuating the considered spin flip .",
    "[ in this present form the algorithm is still rather an `` entropy monte carlo '' than a `` free energy monte carlo '' algorithm ; i will dwell on the full version of the latter below . ] 3 .   draw a random number , @xmath47 , uniformly distributed between zero and one",
    "4 .   if @xmath48 , flip the spin , otherwise do not flip it . in any case , the configuration of spins obtained at the end of step 4 .",
    "is counted as the `` new configuration '' , @xmath49 .",
    "now update the values of the entropy ( @xmath50 ) : @xmath51 where @xmath52 is a pre - chosen positive function which is sufficiently small in the large - time limit , @xmath41 the label of energy of the configuration @xmath12 , and @xmath53 denotes the kronecker symbol .",
    "go to 1 . or end .",
    "let us just note here that by the choice of @xmath54 as above , i ensured that the simulation verifies a detailed balance condition `` locally '' , i.e. , at every time step .",
    "furthermore , in the proof of the convergence of the algorithm below , i will use a different update rule for the entropy values , namely , @xmath55 in this latter case , i shall also assume that the sum over @xmath33 of @xmath56 is normalised to equal the total number of configurations , @xmath57 , at time @xmath38 .",
    "the choice of the update rule , equation ( [ step5a ] ) , then ensures that this normalisation holds for all times , @xmath37 .",
    "if @xmath52 is chosen to be small , then @xmath36 can take on quasi - continuously values between @xmath58 and @xmath59 , i.e. , @xmath60 $ ] and the corresponding ( estimated ) number of configurations is bounded to values between @xmath61 and @xmath57 .",
    "the interchanging of the less calculation intensive update rule , equation ( [ step5 ] ) , with equation ( [ step5a ] ) is possible because only differences in entropy enter into the calculation of the transition probability . after every time step ,",
    "one should imagine , using equation ( [ step5 ] ) , that the `` zero '' ( baseline of the entropy values ) has been shifted upwards .",
    "the entropy may then be obtained as a time average over instantaneous entropy values , and normalising these values with the help of the total number of configurations , @xmath57 .",
    "the only problem one has to cope with , when using the original algorithm , is that one may have to substract the `` baseline '' from all entropy values every so often to avoid overflows or numerical inaccuracies when substracting large numbers of equal order of magnitude from each other .",
    "the above version of the algorithm does not deserve to be called an femc algorithm just yet , as only the entropy enters .",
    "however , if one wants to detect the minima ( or maxima ) in the energy space , it may be useful to change the transition probability of the algorithm to read : @xmath62 where now the transition probability does not depend solely on ( instantaneous ) entropy differences , but on ( instantaneous ) _ free energy _ differences , @xmath63 being the `` inverse temperature '' as usual .",
    "if @xmath63 is large , the temperature is small , and the system stays preferably in configurations with low energy ( if one were to take @xmath63 small or even negative ( ! ) one stays obviously preferably in configurations with high energy ) .",
    "this can be illustrated in particular at the beginning of the algorithm , when the entropy differences are zero , and one performs a gradient descent algorithm towards a local or global minimum out of which one is then taken by a gradual increase in ( instantaneous ) entropy differences .",
    "i will dwell on this aspect further below . with this replacement of the transition probability , the monte carlo algorithm",
    "can now truly be called _ free energy monte carlo ( femc ) algorithm _ . in the next subsection ,",
    "i will , however , consider again the @xmath64 case only , for simplicity .",
    "i will now write down a master equation for the probability , @xmath65 , to be at time @xmath37 in a state with energy @xmath32 and an ( estimated ) entropy function , @xmath66 ( @xmath50 ) . by introducing a dependence on @xmath67",
    ", we will avoid a time dependence in the transition probabilities in the master equation below .",
    "furthermore , in this notation ( and using the version of the algorithm with equation ( [ step5a ] ) where the estimated values for the number of configurations per energy is bounded ) , the fact that the convergence of the master equation to a ( unique ) limit - distribution is ensured mathematically rigorously is easily noticed ( using the methods of @xcite ) . in the following",
    ", i will also write @xmath68 for the transition probability of moving from a configuration with energy @xmath69 to one with energy @xmath32 , given that at that time , the estimated entropy function is @xmath67 . for simplicity",
    ", i will consider the specific case of the infinite - range ferromagnet in which there are only transitions between configurations where the corresponding states are `` nearest - neighbours '' in energy space .",
    "furthermore , i will take @xmath70 to be small , but constant .",
    "the generalisation to other systems is straightforward .",
    "i consider an infinite - range ising ferromagnet consisting of @xmath31 spins , @xmath44 ( @xmath71 ) , connected by bonds of strength @xmath72 ( i will set @xmath73 in what follows for simplicity ) .",
    "the system s hamiltonian , @xmath74 , therefore reads @xmath75 as usual , the possible values are @xmath76 .",
    "i will say that a spin , @xmath44 , points upwards if @xmath77 and downwards otherwise . the number , @xmath33 , of upwards pointing spins is @xmath78 i will enumerate the different states of the system by their energy , going from smallest to largest in value . by symmetry ,",
    "all configurations with @xmath33 or @xmath79 upwards pointing spins have the same energy @xmath80 the total number of energy levels , @xmath81 , is therefore @xmath82\\,\\ , .\\ ] ] here the ( gauss ) brackets , @xmath83 $ ] , indicate the smallest integer equal or larger than @xmath12 , as usual .",
    "so , the variable @xmath33 in equation ( [ el ] ) runs from @xmath61 to @xmath84 .",
    "it is finally to note that , to every energy level , @xmath32 , corresponds an entropy , @xmath85 , that is easily calculated for the infinite - range ising ferromagnet . by symmetry ,",
    "the number of configurations , @xmath86 , with energy @xmath32 is twice the bernoulli number obtained by selecting @xmath33 spins out of the @xmath31 , if @xmath87 , and equals the bernoulli number for @xmath88 , i.e. , @xmath89 the entropy values are therefrom obtained by taking the natural logarithm ( i set @xmath90 here and from now on for simplicity ) .      the probability distribution @xmath65 ( where @xmath91 ) evolves in one time step @xmath92 ( chosen here to equal @xmath93 ) as follows @xmath94 the first two terms come from the probability of moving between time @xmath37 and @xmath95 into the state with energy @xmath32 with estimated entropy function @xmath67 and the other ones from the probability of not leaving it .",
    "the functions @xmath96 differ from @xmath67 by the values obtained from applying the algorithm at time @xmath37 to a configuration with label @xmath97 to the function @xmath96 and getting @xmath67 , i.e. , @xmath98 the factors in front of the transition probabilities reflect the number of spins which can be flipped in the configuration at time @xmath37 to obtain a configuration with energy @xmath32 . more generally , they reflect they ratio of the respective volume fraction of the total configuration space .",
    "it is tacitly understood that for @xmath99 and @xmath100 the appropriate expressions in the equation above are zero .    to see whether the algorithm is really providing convergence towards the correct entropy function ,",
    "i define yet another probability distribution , the probability @xmath101 to obtain at time @xmath37 an entropy function @xmath67 .",
    "this probability distribution should become a delta - peak on the true entropy function if one lets the time , @xmath37 , go to infinity and then takes the limit @xmath102 .",
    "this amounts to our goal that the algorithm gives a good approximation of the true entropy in the infinite - time limit .",
    "let therefore @xmath103 using equation ( [ tdt ] ) , the time evolution of this probability distribution can be written down , @xmath104 i will now consider this equation in the infinite - time limit .",
    "further convergence properties , which are easily obtained analytically in the case of the infinite - range ferromagnet , shall be published elsewhere  @xcite .",
    "as mentioned in the previous subsection , the probability distribution @xmath65 converges , for @xmath105 , to a stationary distribution , @xmath106 .",
    "therefore , also @xmath101 converges to a stationary distribution , @xmath107 .",
    "this distribution verifies the equation @xmath108 and we shall see in the following that after developing this equation in orders of @xmath70 and then taking the @xmath102-limit , the estimated entropy function coincides with the true entropy function . [ note here that the limit @xmath105 and @xmath102 are not interchangeable .",
    "taking @xmath109 first is the limit of performing a random walk in configuration space  ! ]    at time @xmath37 , we have the following update @xmath110 and i have written @xmath111 to indicate the energy level of the configuration at time @xmath37 .",
    "as @xmath111 , and therewith also @xmath36 for all @xmath33 , is the result of a stochastic process , both @xmath111 and @xmath36 for all @xmath33 are random variables .",
    "let us therefore define @xmath112 to be the probability of being in a configuration with energy @xmath113 at time @xmath37 , and develop it in the infinite - time limit [ note again that the limit exists  ! ] in orders of @xmath70 , @xmath114    the change in entropy @xmath115 between time @xmath37 and time @xmath42 is @xmath116+{\\cal o}(\\epsilon^2)\\,\\ , , \\qquad \\epsilon\\to 0\\,\\ , .\\ ] ] now , we know that @xmath117 exists , so that we have the stationarity condition @xmath118 where @xmath119 denotes a time average ( over time @xmath8 ) , with @xmath120 , while holding @xmath121 fixed .",
    "indeed , this average in the infinite - time - limit is nothing but the same as the result of a simulation at equilibrium .    using equation ( [ ds ] ) and developing the left - hand - side of equation ( [ sc ] ) in orders of @xmath70 , @xmath122 we can rewrite the stationarity condition , ( [ sc ] ) , as @xmath123+{\\cal o}(\\epsilon^2)\\,\\ , , \\qquad \\epsilon\\to 0\\,\\ , , \\ ] ] and the right - hand - side must vanish order by order , in particular , @xmath124 where i just have to emphasise again that the limits on both sides of equation ( [ o1 ] ) exist .",
    "note now that the right - hand - side of equation ( [ o1 ] ) is independent of @xmath33 , and therefore a constant , and that the left - hand - side of equation ( [ o1 ] ) , using equation ( [ limp ] ) , equals @xmath125 by normalisation , we hence have @xmath126 this means that in the infinite - time limit , all energy levels are equally probable to occur .",
    "this fact is at the origin of the possibility to replace equation ( [ step5 ] ) by equation ( [ step5a ] ) in the update of the algorithm in step 5 . , ensuring that indeed on average , only the `` zero''/the baseline increases .",
    "furthermore , if the algorithm is local in the sense that `` neighbouring '' configurations imply `` neighbouring '' energies , then the typical time to reach an energy level , @xmath127 , starting from another one , @xmath128 , scales like @xmath129 , as a general result from what is known about one - dimensional random walks .",
    "we still have to show that the equilibrium values for the ( estimated ) entropy function obtained through the simulation do indeed , to zeroth order in @xmath70 , equal the true entropy values ot the system .",
    "let us first note that @xmath130 where @xmath131 is the equilibrium probability for the configuration @xmath132 , with energy @xmath133 , to occur . in the following ,",
    "we will also write the shorthand @xmath134 for the probability of being in a configuration @xmath132 , with energy @xmath133 , and @xmath112 when considering time - dependent properties , respectively . furthermore , by definition , we have @xmath135 where @xmath136 is the true entropy of level @xmath137 and therefore @xmath138 the master equation ( [ evpot ] ) for the considered algorithm reads in the considered infinite - time limit @xmath139 i.e. , using equation ( [ tp ] ) for the transition probabilities and developing in orders of @xmath70 , @xmath140 and similarly the equations for @xmath99 and @xmath100 .",
    "+ defining the difference @xmath141 for @xmath142 and using @xmath143 in the above system of equations , solving for @xmath144 , then @xmath145 , and so forth , it is easy to see that the unique solution of the system ( [ sysso ] ) is indeed @xmath146 it is likewise easy to see that with this identity the first and the third , and the second and the fourth , terms in every equation of ( [ sysso ] ) cancel each other , respectively , by detailed balance . hence , to lowest order in @xmath70 , the estimated entropy function indeed coincides with the true entropy function of the system .",
    "i have applied the algorithm to the infinite - range , the two - dimensional and the three - dimensional ferromagnet to see how well the simplest version of the algorithm ( the `` @xmath64 femc algorithm '' ) performs on obtaining the entropy values of the considered systems and on overcoming energy barriers .",
    "more specifically , in the case of the infinite - range ferromagnet , where i know the entropy ( or number of configurations ) exactly , i have investigated the convergence to the correct values of the entropy as well as the passage times ( `` tunneling times '' ) between the `` all - spins up '' and `` all - spins down '' ground states . in the case of the two- and three - dimensional ferromagnets , i have also studied these passage times in order to see whether the algorithm really provides for a quick `` tunneling '' through the energy barriers . a more thorough study on the rle of the ratio of @xmath70 and @xmath63 in the truly femc algorithm on the tunneling times shall be published elsewhere @xcite .",
    "last but not least , i have compared the values obtained using the algorithm with the ones known exactly for the case of the 4x4x4-ferromagnet .",
    "the values of @xmath70 that i use are between @xmath147 and @xmath148 .",
    "certainly , @xmath70 should tend to zero with increasing @xmath37 to obtain even more accurate values of the entropy .",
    "however , the smaller @xmath70 is already in the earlier stages of the algorithm , the longer it takes to reach the asymptotic stage .",
    "if one takes @xmath70 too small at the start of the algorithm , one risks to never leave , during the time of the simulation , the regime where effectively one samples according to performing a random walk in configuration space , as the differences in the entropy values will stay too small in the available simulation time .",
    "a good way to measure whether one has reached the asymptotic regime of the algorithm yet or not is to keep track of the sampled energies : if the histogram of the energies , averaged over a long enough period of time , is flat , asymptotics are reached .",
    "some comments on the large-@xmath70 limit are also in place . for @xmath70 of order @xmath93 or larger ,",
    "the transition probability ( [ tp ] ) of accepting a move becomes essentially @xmath61 or @xmath93 , as the differences in estimated entropy values for the different levels become larger than @xmath93 , hence the argument of the @xmath149 .",
    "this has the following consequences .",
    "if , e.g. , one is at time @xmath37 , say , in a configuration of the level @xmath111 , and the values of the estimated entropy values at the adjacent levels @xmath150 are @xmath151 , then moves are ( essentially ) accepted iff the level of the considered update , @xmath152 , is @xmath153 .",
    "the algorithm can be viewed as putting a brick of height @xmath70 at every time step onto a wall which is building up during the process .",
    "if the height of the wall at the adjacent place ( level ) whereto the move at time @xmath42 is considered is lower , the move is accepted with probability @xmath154 , if the wall is of equal height , the move is accepted with probability @xmath155 , and else it is ( essentially always ) rejected .",
    "it is easy to notice that on average the wall will be of equal height for all levels if one substracts a running ( increasing ) baseline .",
    "this leads to the observed fact that all energy levels occur with equal probability , albeit the fact that the weight factors in the algorithm are not proportional to the true entropy values ( on average ) .",
    "i have considered systems which contained @xmath156 spins where @xmath157 .",
    "i have compared runs where the `` tunneling times '' where measured from the beginning with ones where the tunneling times of the first @xmath158 ( @xmath159 ) monte carlo steps ( mcs ; defined as usual as the time needed to update all @xmath31 spins in the system ) were not taken into account .",
    "the ( expected ) experience from these runs is that the distribution of tunneling times , its mean ( @xmath160 ) and random mean square ( rms ) value ( @xmath161 ) remained essentially unaltered .",
    "however , to be on the safe side , i have not counted the tunnelings observed during the first @xmath162 mcs in the runs whose results are displayed in the following . in all of the different runs , the histogram of the energies , averaged at the same time than the ( instantaneous ) entropy values , is flat , i.e. , fluctuates around the mean number of sampled configurations per energy to within at most a small fraction of a percent for small system sizes and up to at most @xmath163 for the largest systems considered .",
    "the results shown in the figures have been obtained with a total number of @xmath164 mcs .",
    "i have fixed @xmath70 to equal @xmath165 , @xmath166 , and @xmath167 , respectively .",
    "this implies that the values @xmath160 and @xmath161 , the mean and the rms value of the tunneling times , have been obtained for @xmath168 from 149338 values for @xmath169 to 659 values for @xmath170 , for @xmath171 from 148726 values for @xmath169 to 1218 values for @xmath170 , for @xmath147 from 146682 values for @xmath169 to 1826 values for @xmath170 . to check for statistical reliability of the data ,",
    "i have also performed slightly shorter and longer runs .",
    "the error bars that i have got from these runs , at fixed averaging times ( of the instantaneous entropy ) , are smaller than the size of the symbols in the figures .",
    "the distributions for the tunneling times , @xmath4 , themselves are , however , intrinsically very broad ( their width is of the order of their mean ) with an accordingly long tail , possibly power - law - like .",
    "this can be seen in figure  1 , where the distribution , @xmath172 , of the `` tunneling times '' , @xmath4 , is shown for a run of @xmath173 mcs and @xmath171 with @xmath174 spins . in total ,",
    "14941 tunnelings have been observed during the last @xmath175 mcs , therefrom 45 events with a tunneling time larger than @xmath176 mcs .    in the runs displayed in the figures of this subsection ,",
    "at most @xmath177 tunneling events with times above @xmath178 occured for @xmath179 , this number rapidly decreasing with system size to at most @xmath180 such events for @xmath181 .",
    "the statistics for the larger systems may , indeed , be insufficiant because of the long tail of the distribution ( the effect of a reduction of the measured @xmath160 can clearly be seen in figure  2 for the runs with @xmath171 and @xmath182 respectively @xmath183 spins ) .",
    "however , the resulting error should not alter the results significantly .",
    "figure  2 shows the increase of @xmath160 with the number of the spins in the system on a log  log scale .",
    "i have fitted straight lines ( by eyesight ) to the data points in figure  2 , corresponding to the fits @xmath184 , for the different values of @xmath70 .",
    "because of higher statistical reliablitity of the results of the smaller size systems these have been taken account more than the ones of the larger size systems .",
    "the results for the fit parameters are @xmath185 remember that the exponent for a random walk in energy space is @xmath186 from the general results on one - dimensional random walks .    in figure  3",
    "the increase of @xmath161 with the number of the spins in the system is displayed on a log  log scale .    here the straight lines corresponding to the fits @xmath187",
    "give @xmath188 we see from the figures that the width of the distribution is of the order of its mean , which can be noted easily already for @xmath189 , where one knows the ( power - law - like ) distribution of the tunneling times and its properties analytically .    in all of the above simulations ,",
    "i have compared the obtained values for the entropy with the true ones , from equation ( [ defomega ] ) .",
    "depending on the value of @xmath70 , on the number of times that i averaged over the ( estimated instantaneous ) entropy values and on the total time of the simulation , i got more and less accurate results . in any case , for the runs of figures  2 and  3 , the error was typically of the order of @xmath70 . in figure  4 , a comparison of the entropy values , obtained for a system containing @xmath190 spins , using the algorithm with @xmath171 and running it for a total of 50960 mcs , with the exact values is shown .    as can be seen from figure  4 , the matching of the values ( of the number of configurations , not of the entropy  ! )",
    "is quite impressive , taking into account the fact that there are @xmath191 configurations .",
    "i have also compared it in the figure to the values obtained by a run with a larger number of mcs , namely 1040960 mcs , but performing a local random walk in configuration space . in this last run ,",
    "i have counted the configurations during the run and normalised the sum of all the hits to @xmath191 .",
    "it is easily seen from the figure that , in contrast to the femc algorithm ( with much fewer mcs  ! ) , ergodicity has been lost , configurations with energy @xmath32 for @xmath192 have not even been sampled  !    in conclusion , the femc algorithm provides for ergodicity of the system in the used computer time , and satisfactory estimates of the entropy for @xmath70 in the range between @xmath167 and @xmath165 .",
    "if one is rather interested in smaller tunneling times , one should however run the algorithm with larger @xmath70 .      in the case of the two - dimensional ferromagnet",
    "i have performed runs on systems of linear size @xmath193 , where @xmath194 , and for the three - dimensional ferromagnet on systems of linear size @xmath193 , where @xmath195 .",
    "again , i have compared runs where the tunneling times where measured from the beginning with ones where the tunneling times of the first @xmath158 ( @xmath159 ) mcs were not taken into account and observed that the distribution of the tunneling times , its mean and rms value remained essentially unaltered .",
    "however , to be again on the safe side , i have not counted the tunnelings observed during the first @xmath162 mcs in the runs whose results are displayed in the following . in all of the different runs , the histogram of the energies , averaged at the same time than the ( instantaneous ) entropy values , is flat to within the same percentages as in the infinite - range ferromagnet .",
    "the results shown in figure  5 ( for the two - dimensional ferromagnet ) have been obtained with a total number of @xmath164 mcs . as these runs were done mainly to test the tunneling ability of the algorithm ,",
    "i have fixed @xmath70 to equal @xmath167 .",
    "this implies that the values @xmath160 and @xmath161 , the mean and the rms value of the tunneling times , have been obtained from 106825 values for @xmath196 to 14 values for @xmath197 .",
    "the same statistical errors as for the infinite - range ferromagnet play a rle here .",
    "the distributions for the tunneling times , @xmath4 , themselves are , again , intrinsically very broad ( their width is of the order of their mean  ! ) with an accordingly long tail . in the runs displayed in the figure @xmath198 tunneling events occured with times larger than @xmath178 for @xmath196 down to @xmath93 for @xmath197 .",
    "the statistics for the larger systems may again be insufficiant because of the long tail of the distribution .",
    "figure  5 shows the increase of @xmath160 and @xmath161 with the volume of the system on a log  log scale .",
    "i have fitted straight lines ( by eyesight ) to the data points in figure  5 , corresponding to the fits @xmath184 .",
    "the results for the fit parameters are @xmath199 we notice again from the figure that the width of the distribution is of the order of its mean .",
    "the results shown in figure  6 ( for the three - dimensional ferromagnet ) have also been obtained with a total number of @xmath164 mcs and @xmath147 .",
    "this implies that the values @xmath160 and @xmath161 have been obtained from 443 values for @xmath196 down to 6 values for @xmath200 . in the runs displayed in the figure ,",
    "3 tunneling events occured with times larger than @xmath178 for @xmath196 down to @xmath61 for @xmath200 .",
    "the statistics for the larger systems may again be insufficiant because of the long tail of the distribution .",
    "figure  6 shows the increase of @xmath160 and @xmath161 with the volume of the system on a log  log scale .",
    "finally , i have also determined approximate values of the entropy for the 4x4x4-ferromagnet in order to compare them to the ones known exactly @xcite .",
    "the resulting comparison can be seen in figure  7 .",
    "the femc simulation of a total of @xmath201 mcs ( of which the first 100000 mcs were discarded from the measurements ; during the last 20000 mcs the entropy was averaged over the instanteneous values of every 100th mcs ) has been done with fixed @xmath148 .    as can be seen from the figure , the matching of the values ( of the number of configurations , not of the entropy  ! ) is again quite impressive , taking into account the fact that there are @xmath202 configurations .",
    "i have also compared it in the figure to the values obtained by a run performing a local random walk in configuration space , of even more mcs , namely @xmath175 mcs . in this latter run ,",
    "i have counted the configurations sampled during the run and normalised the sum of all the hits to @xmath202 .",
    "it is easily seen from the figure that , in contrast to the femc algorithm , ergodicity has again been lost , configurations with energies @xmath203 have not even been sampled  !    in conclusion , the femc algorithm provides also for the two- and three - dimensional ferromagnets for ergodicity of the system in the used computer time , and satisfactory estimates of the entropy for @xmath70 in the range between @xmath167 and @xmath204 .",
    "if one is rather interested in smaller tunneling times , one should however again run the algorithm with larger @xmath70 .",
    "recently monte carlo sampling with respect to unconventional ensembles has received some attention [ 934 ] .",
    "multicanonical and related sampling has allowed considerable gains in situations with `` supercritical '' slowing down , such as first order phase transitions @xcite and systems with conflicting constraints , such as spin glasses @xcite or proteins @xcite .",
    "they seem , however , still be haunted by some difficulties , in particular for the latter systems @xcite .    for first order phase transitions of non - random systems",
    "the problem of the a  priori unknown entropy is rather elegantly overcome by means of finite size scaling methods @xcite .",
    "a sufficiently accurate estimate is obtained by extrapolation from the already simulated smaller lattices .",
    "the smallest lattices allow still for efficient canonical simulations .",
    "for the three - dimensional ising ferromagnet it is clear that the finite size scaling methods employed in @xcite provide reliable estimates of the multicanonical parameters . on the other hand",
    ", this approach breaks down @xcite for the important class of disordered systems .",
    "for instance for spin glasses one has to perform the additional average over quenched random variables ( the coupling constants ) .",
    "different choices of these random variables define different realisations of the ( finite - size ) system which imply different entropy functions for the different realisations .",
    "then algorithms like the one of this paper become crucial , but the ising ferromagnet is still a suitable testing ground to set quantitative performance scales .    in this paper ,",
    "i have introduced a new algorithm in the above spirit .",
    "i have analytically proven that the entropy of a system can be obtained from a _ free energy monte carlo _ algorithm at infinite temperature ( @xmath64 in equation ( [ femc ] ) ) in the infinite - time limit and applied the algorithm to the infinite - range as well as to the two- and three - dimensional ferromagnets .",
    "i have simulated these systems to obtain the entropy function and to investigate the `` tunneling times '' of getting from one energy minimum to another one .",
    "the results are very encouraging :          in particular , the last fact , the retaining of the ergodicity , should allow for a calculation of physical quantities , such as correlation functions , through equation ( [ erg ] ) near zero temperature where conventional mc simulations fail .",
    "it is also interesting to use the full femc algorithm ( with nonvanishing @xmath63 ) .",
    "more results with the latter shall be published elsewhere @xcite .",
    "it is particularly interesting to determine the best choice of the parameters @xmath70 and @xmath63 and of their ratio to overcome energy barriers in the least amount of time and to explore the energy space for minima or more generally extrema .",
    "also , more analytical details and properties of the algorithm can be obtained for the case of the infinite - range ferromagnet @xcite .",
    "it shall be interesting to apply the algorithm in the cases where hitherto ergodicity problems have not allowed to obtain results .",
    "one last application of the algorithm should be mentioned here . constructing a general model of on - line",
    "learning is an important challenge in the theory of learning and its application .",
    "a plausible definition of the goal of supervised learning from examples is to find a weight vector @xmath206 that minimises the generalisation error , @xmath207 .",
    "a general model of batch learning , in which the learner has free access to a fixed set of examples , is based on minimisation of the total training error .",
    "indeed , as the size of the training set , @xmath208 , grows this procedure converges uniformly to the minimum of the generalisation error . in systems with continuously varying weights ,",
    "the rate of convergence to this limit follows generically a power law @xcite .",
    "a similar general model does not yet exist for on - line learning , where , at each time step , the learner receives a single new example and is unable to store previous examples in memory .",
    "the conventional on - line algorithm is based on the gradient of the instantaneous error @xcite . for a sufficiently small learning rate",
    ", it converges to a local minimum of @xmath207 but not necessarily to the global one .",
    "more importantly , it is not applicable to learning of boolean functions or of other discrete valued functions which are extremely useful for decision and classification tasks .",
    "recently , an _ on - line gibbs algorithm _ has been proposed @xcite as the first on - line algorithm that guarantees convergence to the minimal generalisation error for non - smooth systems , in particular for systems with discrete valued outputs or threshold hidden units .",
    "the price that is paid is an increased complexity of the computation at each presentation of examples . in particular , for systems in which the generalisation error has local minima , the on - line gibbs algorithm may require a slow annealing schedule of the temperature variable , used in the algorithm , which might yield a slow global convergence rate .",
    "in addition , the algorithm relies on the possibility of updating the weights by small increments .",
    "consequently , it is inapplicable to systems with _",
    "discrete valued weights_. in the case of the femc algorithm , gradient descent and escaping from minima can be combined naturally ( see equation  ( [ femc ] ) ) so that the femc may offer a valuable alternative to optimise the learning procedure .",
    "serious questions concerning on - line learning are still open , most importantly the one is on the _ global convergence rate _ , which is yet unknown in general .",
    "n.  metropolis , a.w .",
    "rosenbluth , m.n .",
    "rosenbluth , a.h .",
    "teller , and e.  teller , _ j.  chem .",
    "phys . _  * 21 * ( 1953 ) 1087 .",
    "fosdick , _ methods comput .",
    "_  * 1 * ( 1963 ) 245 .",
    "see j.p .",
    "valeau and d.n .",
    "card , _ j.  chem",
    "* 57 * ( 1972 ) 5457 .",
    "torrie and j.p .",
    "valleau , _ j.  comput",
    ".  phys . _  * 23 * ( 1977 ) 187",
    ". k.  binder and a.p .",
    "young , _ rev .",
    "* 58 * ( 1986 ) 801 .",
    "m.  mzard , g.  parisi , and m.a .",
    "virasoro , _ spin glasses and beyond _ , world scientific , singapore ( 1987 ) .",
    "fischer and j.a .",
    "hertz , _ spin glasses _ , cambridge university press , cambridge  ( 1991 )",
    ". h.  rieger , _ monte carlo studies of ising spin glasses and random field systems _ , in : _ annual reviews of computational physics ii _",
    ", d.  stauffer ( ed . ) , world scientific , singapore ( 1995 ) .",
    "berg , _ hep - lat/9503019 _ , _",
    "j.  stat .",
    "phys . _  * 82 * ( 1996 ) 323 .",
    "van  kampen , _",
    "stochastic processes in physics and chemistry _ , north - holland , amsterdam@xmath209oxford@xmath209new york@xmath209tokyo ( 1981 ) .",
    "thill , _ cond - mat/9703233_. b.  berg and t.  neuhaus , _ phys .  lett .",
    "b _  * 267 * ( 1991 ) 249 .",
    "b.  berg and t.  neuhaus , _ phys .",
    "lett . _  * 68 * ( 1992 ) 9 . b.  berg and t.  celik , _ phys .  rev",
    ".  lett . _  * 69 * ( 1992 ) 2292",
    ". b.  berg and t.  celik , _ int .",
    "j.  mod.phys .",
    "c _  * 3 * ( 1992 ) 1251 .",
    "lyubartsev , a.a .",
    "martsinowski , s.v .",
    "shevkunov , and p.n .",
    "vorontsov  velyaminow , _",
    "j.  chem .",
    "phys . _  * 96 * ( 1992 ) 1176 .",
    "e.  marinari and g.  parisi , _ europhys .",
    "* 19 * ( 1992 ) 451 .",
    "b.  berg , _ int .",
    "j.  mod .",
    "c _  * 3 * ( 1992 ) 311 .",
    "a. hller , _ z.  phys .",
    "* 88 * ( 1992 ) 79 .",
    "b. hesselbo and r. stinchcombe , _ phys .",
    "rev.lett._  * 74 * ( 1995 ) 2151 . c.  borgs and s.  kappler , _ phys .",
    "lett .  a _",
    "* 171 * ( 1992 ) 2011 .",
    "b.  berg , u.  hansmann , and t.  neuhaus , _",
    "z.  phys .",
    "b _  * 90 * ( 1993 ) 229 .",
    "b.  grossmann and m.l .",
    "laursen , _ nucl .",
    "* 408 * , ( 1993 ) 637 .",
    "k.  rummukainen , _ nucl .",
    "* 390 * ( 1993 ) 621 .",
    "a.  billoire , t.  neuhaus , and b.  berg , _",
    "nucl.phys .",
    "b _  * 396 * ( 1993 ) 779 .",
    "a.  billoire , t.  neuhaus , and b.  berg , _ nucl.phys .",
    "* 413 * ( 1994 ) 795 .",
    "j.  lee , _ phys .",
    "lett . _  * 71 * ( 1993 ) 211 [ and erratum * 71 * ( 1993 ) 2353 ] .",
    "b.  berg , u.  hansmann , and y.  okamoto , _",
    "j.  phys.chem._  * 99 * ( 1995 ) 2236 .",
    "u.  hansmann and y.  okamoto , _ j.  comput .",
    "_  * 14 * ( 1993 ) 1333 . m .-",
    "hao and h.a .",
    "scheraga , _ j.  phys .",
    "_  * 98 * ( 1994 ) 4940",
    ". b.  berg , u.  hansmann , and t.  celik , _ phys .",
    "* 50 * ( 1994 ) 16444 .",
    "w.  kerler and p.  rehberg , _ phys .",
    "e _  * 50 * ( 1994 ) 4220 .",
    "w.  janke and s.  kappler , _ phys .",
    "_  * 74 * ( 1995 ) 212",
    ". w.  janke , _ recent developments in monte  carlo simulations of first - order phase transitions _",
    ", in _ computer simulations studies in condensed matter physics vii _ ( proceedings in physics 78 , pp .",
    "2944 ) , d.p .",
    "landau , k.k .",
    "mon , and h .- b .",
    "schttler ( eds ) , springer , berlin@xmath209heidelberg@xmath209new york@xmath209london@xmath209paris@xmath209tokyo ( 1994 )",
    ". b.  berg , _ nature _",
    "* 361 * ( 1993 ) 708 .",
    "thill , unpublished .",
    "pearson , _ phys .",
    "b _  * 26 * ( 1982 ) 6285 .",
    "seung , h.  sompolinsky , and n.  tishby , _ phys .",
    "* 45 * ( 1992 ) 6056 .",
    "s.  haykin , _ neural networks : a comprehensive foundation _ , macmillan college , new york ( 1994 ) .",
    "t.  heskes and b.  kappen , _ phys .",
    "* 44 * ( 1991 ) 2718 .",
    "kim and h.  sompolinsky , _ phys .",
    "lett . _  * 76 * ( 1996 ) 3021 ."
  ],
  "abstract_text": [
    "<S> in this paper , i investigate more closely the recently proposed _ </S>",
    "<S> free energy monte carlo _ algorithm that is devised in particular for calculations where conventional monte carlo simulations struggle with ergodicity problems . </S>",
    "<S> the simplest version of the proposed algorithm allows for the determination of the entropy function of statistical systems and/or performs entropy sampling at sufficiently large times . </S>",
    "<S> i also show how this algorithm can be used to explore the system s energy space , in particular for minima .    </S>",
    "<S> pacs numbers : 05.50.+q , 11.15.ha , 64.60.fr , 75.50.hk , 87.10.+e , 02.60.pn . , </S>",
    "<S> 02.70.lq , 05.20.-y +    = 10000 1.5ex plus 0.5ex minus 0.5ex </S>"
  ]
}