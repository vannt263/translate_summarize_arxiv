{
  "article_text": [
    "the application of random matrix theory to the analysis of correlations of financial time - series has been widely studied by @xcite in the case of gaussian matrices and by @xcite in the non - gaussian case .",
    "the non - gaussian case is more realistic but also more difficult .",
    "one of the reasons of these difficulties is that it is not straightforward to use variances and covariances as a measure of risk in the non - gaussian case as it is in the gaussian case .",
    "@xcite approaches this problem by mapping asymptotically power - law distributed assets in a non - linear way onto gaussian variables whose covariances provide a new measure of dependence between non - normal returns .    in this paper",
    ", however , we are going to forget that price returns have `` fat '' tails , as it was first suggested by @xcite and then proved by @xcite in a thorough statistical analysis , and test the case of gaussian random matrices . here",
    "it is the correlation matrix that measures the mutual dependence of normally distributed financial time series and this is the quantity we will investigate .    in this ensemble of random matrices",
    "there are several universal quantities , i.e. quantities which are the same for both a particular random matrix and the average over the whole ensemble . in principle",
    "then we can measure these quantities for a financial correlation matrix , compare them with those from the ensemble , which will be defined in the next section , and then extract information about the underlying correlations between stocks .",
    "one universal quantity is the eigenvalue distribution .",
    "the density of eigenvalues for financial correlation matrices seems to be divided into two or more clearly separated parts ( see fig .",
    "[ fig : correl100 ] ) .",
    "the first part , comprising the majority of the spectrum , corresponds to small eigenvalues .",
    "the other parts contain very few eigenvalues that are generally much larger than those from the first group .",
    "the components of these other groups are clearly separated from the first group and from one another . since eigenvalue spectra in the ensemble have a similar structure the method consists in modifying the spectrum , replacing each group of eigenvalues by groups of degenerate eigenvalues and reconstructing the correlation matrix from that modified spectrum and the eigenvectors of the original financial correlation matrix .",
    "this method is valid only under certain assumptions .    1",
    ".   the financial time series should comprise gaussian stochastic processes and 2 .",
    "the underlying matrix of stock correlations should have only a small number of distinct eigenvalues @xmath0 for @xmath1 that are clearly separated from one another @xmath2 .    in this paper",
    "we examine the method for gaussian distributed pseudo - random variables conforming to given correlations .",
    "we test the extent to which one can reproduce the underlying correlations from gaussian time series of a given finite length .",
    "furthermore , we apply the algorithm to historical time series of the standard and poor s 500 index and compare the results to a different `` denoising '' algorithm suggested by @xcite .",
    "the paper is organized as follows . in section [ sec",
    ": anal ] we briefly discuss the theoretical approach , in section [ sec : fit ] we describe the procedure of fitting the theory to measured data .    in the sections",
    "[ sec : simul ] and [ sec : results ] we discuss the simulation and the results for financial data . in section [ sec : optportf ] we discuss whether the amount of noise removed from the measured correlation matrix of gaussian processes is sufficient for the cleaned matrix to be used for portfolio management purposes .",
    "we conclude with a brief discussion .",
    "consider a ensemble of normally distributed stochastic processes @xmath3 for @xmath4 and @xmath5 .",
    "whose joint probability density reads : @xmath6 ) d { \\bf x}\\end{aligned}\\ ] ] with a normalization factor @xmath7 that ensures + @xmath8 .",
    "the estimator of correlations in these processes is defined in the usual way : @xmath9    it follows from this definition that the processes @xmath10 and @xmath11 with different indices @xmath12 are correlated only if the times are the same @xmath13 , i.e. @xmath14 now we can calculate analytically certain averages over the ensemble of stochastic processes @xmath10 called wishart matrices @xcite . in particular it is possible @xcite , to obtain a closed form expression for the trace of a statistically averaged matrix that involves an estimator @xmath15 of the cross correlations .",
    "this resolvent is defined as follows : @xmath16^{-1 } \\right >       = \\int tr\\left [ z - \\frac{1}{t } { \\bf x } { \\bf x^t } \\right]^{-1 }          p\\left ( { \\bf x } \\right ) d{\\bf x }     \\label{eq : greensfct}\\ ] ] where the integral on the right - hand - side stands for @xmath17 integrals over each of the variables @xmath10 in the limits from @xmath18 to @xmath19 .",
    "the result reads : @xmath20 \\label{eq : resolvent}\\ ] ] in the case when the underlying correlation matrix @xmath21 has only few distinct eigenvalues @xmath22 with multiplicities @xmath23 for @xmath24 the resolvent satisfies an algebraic @xmath25-order algebraic equation of the form : @xmath26 where @xmath27 the following two constraints are imposed on the parameters @xmath28 : @xmath29 and @xmath30 .",
    "these follow from the fact that the correlation matrix @xmath21 has a dimension @xmath31 and a trace @xmath31 .",
    "the resolvent is a useful tool for calculating the density of eigenvalues @xmath32 of the estimator of the correlation matrix @xmath15 in the limit @xmath33 .",
    "the density of eigenvalues @xmath34 is related to the resolvent as follows : @xmath35 \\label{eq : doewishart}\\end{aligned}\\ ] ] and is universal , which means that it does nt matter whether we perform the average over the ensemble of wishart matrices in ( [ eq : densityofeigenvalues ] ) or whether we drop the brackets @xmath36 and compute the sum over eigenvalues of a particular representative of the ensemble .",
    "numerically , the density of eigenvalues @xmath34 is computed by solving the algebraic equation ( [ eq : resolventdef ] ) for @xmath37 , taking the imaginary part of the solution and dividing it by @xmath38 .",
    "it is not difficult to realize that the imaginary part of the resolvent @xmath34 is different from zero only if @xmath39 belongs to certain intervals @xmath40 such that @xmath41 ( see fig .",
    "[ fig : doebands ] ) .    for more details of this approach",
    "we refer the interested reader to original works by @xcite .",
    "we now discuss how to fit the density of eigenvalues @xmath34 in the ensemble of random matrices to @xmath42 corresponding to cross - correlations of financial time series .",
    "as mentioned in the introduction , eigenvalue spectra of cross - correlation matrices of financial time series consist of clearly separated groups of eigenvalues to be referred to as bands .",
    "each band corresponds to one term in the sum on the right - hand - side of equation ( [ eq : resolventdef ] ) .",
    "the parameters @xmath43 and @xmath44 of the resolvent are determined , roughly , by the number of eigenvalues in the @xmath45th band and by the location of the midpoint of the band .",
    "we calibrate the parameters of the resolvent against market data in the following manner .",
    "after computing the eigenvalues of the estimator of correlations ( [ eq : estimator ] ) we calculate the histogram of eigenvalues and the smoothed density of eigenvalues @xmath42 which is defined as a sum of narrow gaussians pin - pointed at all eigenvalues , i.e @xmath46 the smoothed density @xmath42 is used to find the preliminary location of bands , i.e. their midpoints @xmath47 , and the numbers of eigenvalues belonging to bands @xmath43 . having determined the parameters we compute the resolvent @xmath48 from equation ( [ eq : resolventdef ] ) by finding complex roots of a polynomial equation ( computations are carried out with multiple precision due to high susceptibility of polynomial - roots to errors in coefficients ) and then taking the imaginary part to get the @xmath34 in the ensemble of wishart matrices .",
    "finally we compute the optimal parameters @xmath44 , subject to the constraints , by minimizing the deviation between @xmath42 and @xmath34 using a down - hill simplex method  a multi - dimensional minimization routine from nelder and mead @xcite .",
    "the parameters @xmath43 are not altered in the procedure .",
    "the minimization is carried out in @xmath49-dimensional space .",
    "specifically we minimize the sum of relative differences of moments : @xmath50 where @xmath51 and the `` empirical '' mean @xmath52 refers to the density of eigenvalues of the measured estimator of correlations .    from the optimal parameters @xmath43 and @xmath44 we reconstruct the spectrum by replacing the eigenvalues of the estimator @xmath15 by @xmath53 with degeneracy @xmath54 , @xmath55 with degeneracy @xmath56 and so on until @xmath57 with degeneracy @xmath58 . having done that we construct the `` cleaned '' correlation matrix @xmath59 by multiplying a diagonal matrix @xmath60 with the new eigenvalues on the diagonal by two matrices on the right and left side respectively . on the right - hand side",
    "we have a matrix @xmath61 whose rows are eigenvectors of @xmath15 , on the left - hand side we have the transposition @xmath62 .",
    "it means that @xmath63 .",
    "finally we check the `` degree of cleaning '' , which we define as the deviation between the estimator and the cleaned estimator @xmath64 .",
    "in order to check the reliability of the output of the algorithm applied to real data we perform monte - carlo simulations . at each time step @xmath65",
    "we generate @xmath31 correlated gaussian processes @xmath66 with given cross - correlations @xmath67 .",
    "this is done by generating at each time step @xmath31 uncorrelated gaussian processes @xmath68 , by means of the box - mueller algorithm @xcite , and building from them @xmath31 linear combinations @xmath69 with coefficients that depend on eigenvalues @xmath70 and eigenvectors @xmath71 of the underlying correlation matrix @xmath67 .",
    "now we compute the estimator of the correlation matrix ( [ eq : estimator ] ) , diagonalize it and compute the smoothed density of eigenvalues @xmath42 from formula ( [ eq : denseigsmooth ] ) with @xmath72 of the order of the mean level spacing between consecutive eigenvalues .",
    "the results are shown in fig .",
    "[ fig : eigenvalden ] .",
    "having obtained the preliminary estimates of parameters @xmath43 and @xmath44 we carry out the rest of the computation , as described at the end of the previous section , and obtain the `` cleaned '' correlation matrix @xmath73 .",
    "we quantify the `` goodness of cleaning '' by comparing the mean deviations @xmath74 and @xmath75 .",
    "the dependence of the `` goodness of cleaning '' on the length of time series @xmath76 is shown in figs .",
    "[ fig : testdenoise],[fig : testdenoise1 ] .",
    "we can see two desirable features in the figures .",
    "firstly the deviation @xmath75 of the estimator from the underlying matrix decreases with increasing length of time series .",
    "this has nothing to do with the cleaning procedure and is only a manifestation of the fact that the estimator @xmath15 approaches the estimated matrix @xmath67 monotonously as @xmath77 .",
    "secondly the `` goodness of cleaning '' improves with decreasing @xmath78 ( see inset in figs . [",
    "fig : testdenoise],[fig : testdenoise1 ] ) .",
    "indeed it drops from @xmath79(@xmath80 ) to @xmath80(@xmath81 ) in figs [ fig : testdenoise ] and [ fig : testdenoise1 ] respectively .",
    "we can , therefore , say that for gaussian processes the noise filtering algorithm removes 15%26% and 26%30% noise @xmath82 for the both correlation matrices tested in in items ( [ it : correlmat1 ] ) and ( [ it : correlmat2 ] ) , sec .",
    "[ sec : simul ] respectively .",
    "finally a remark with respect to the choice of the underlying correlation matrix @xmath67 .",
    "since the magnitudes of the eigenvalues of @xmath15 for financial correlation matrices differ considerably we need to take the underlying correlation matrix with the same property .",
    "we require @xmath67 to have three distinct eigenvalues @xmath83 , with degeneracies @xmath84 , @xmath85 and @xmath86 respectively , such that @xmath87 and @xmath88 . since the trace of the correlation matrix is @xmath31 there are certain constraints imposed on the @xmath39 s .",
    "now , we take two choices of @xmath67 , namely :    1 .",
    "@xmath89 with @xmath90 being a fourier transform of a piece - wise constant function with three distinct values .",
    "+ here @xmath91 where @xmath92 and @xmath93 . the matrix @xmath94 which has three distinct eigenvalues @xmath95 with degeneracies @xmath96 respectively[it : correlmat1 ] .",
    "2 .   a block - matrix that consists of @xmath97 blocks @xmath98 of dimensions @xmath99 for @xmath100 on the diagonal and zeroes elsewhere .",
    "the blocks itself have a structure @xmath101 where @xmath102 .",
    "this choice is dictated by the fact there may exist groups of stocks on the market , which have the property that two stocks are only correlated if they belong to the same group .",
    "this means that @xmath103 for @xmath104 and @xmath105 . in the following we choose @xmath106 for simplicity and also because it renders the smallest eigenvalue of all block matrices to be the same .",
    "the minimal dimension of such matrix @xmath67 that has three distinct eigenvalues @xmath107 with degeneracies @xmath84 , @xmath85 and @xmath86 and for which @xmath87 and @xmath88 is @xmath108 .",
    "the matrix contains four blocks of dimension @xmath109 and three blocks of of dimension @xmath110 and the parameter @xmath111 in each block is @xmath112[it : correlmat2 ] .",
    "having tested the algorithm on gaussian stochastic processes we now apply it to daily financial data from the standard and poor s 500 stock group . here",
    "we check if the eigenvalues @xmath39 and their degeneracies @xmath113 , which we obtain as a result of the minimization procedure described above , correspond to eigenvalues obtained by @xcite and @xcite .",
    "what one did there was to order the eigenvalues in ascending order , divide them into groups ( there were usually only two groups , the `` noisy part '' containing most eigenvalues and one separated eigenvalue much larger than the rest ) and replace the eigenvalues from the group by one degenerated eigenvalues equal to the mean over eigenvalues from the group ( in order to conserve the trace of the correlation matrix ) .",
    "in other words the group of eigenvalues @xmath114 was replaced by one eigenvalue @xmath115 with a degeneracy @xmath116 .",
    "we have performed computations for groups of stocks with a fixed length @xmath117 days and with a growing number of stocks @xmath31 .",
    "the optimal eigenvalues and their degeneracies are shown in table [ tab : eigenvalloc ] . as we can see the algorithm is stable",
    ", i.e. it produces results which are close to that @xmath118 obtained by @xcite for different values of @xmath31 . in other words",
    "we have shown that the minimization of deviations between the spectrum of eigenvalues of the measured estimator of cross - correlations and the spectrum of eigenvalues of a certain random matrix amounts , approximately , to the procedure by @xcite and @xcite , i.e. to replacing each group of eigenvalues by one single , degenerated eigenvalue whose value is equal to the mean over the group . however , as we can see in table [ tab : eigenvalloc ] , the eigenvalues @xmath39 and @xmath118 do not match exactly .",
    "this is due to the fact that sometimes it is difficult to define a band ( see figs . [",
    "fig : correl100][fig : correl435 ] ) in the spectrum of the measured estimator .",
    "this depends on the smoothing parameter @xmath72 in ( [ eq : denseigsmooth ] ) .",
    "moreover , it is not quite clear that the minimization routine will lead us to the global minimum .",
    "if there are more than @xmath119 bands then it is quite likely for the algorithm to get stuck in a local minimum , which will be hard to distinguish from the global minimum .",
    "indeed , in the last row in table [ tab : eigenvalloc ] the underlying eigenvalues @xmath39 s and the mean eigenvalues @xmath118 do not match but even though the deviation @xmath120 is of the same order than in previous rows .    from table [ tab : eigenvalloc",
    "] we see that the minimization was convergent in a reasonable time ( the number @xmath121 of function evaluations was reasonable ) even if there were several parameters to be optimized .",
    ".eigenvalues and degeneracies @xmath39 and @xmath113 of the underlying correlation matrix mean eigenvalues @xmath118 in the consecutive bands , the sum of relative differences of moments @xmath120 of the empirical correlation matrix and the corresponding `` stochastic '' matrix , i.e. that of the wishart matrix ensemble , the deviation @xmath64 of the `` cleaned '' estimator from the measured estimator , the number of parameters @xmath122 optimized and the number of function evaluations @xmath121 in the downhill - simplex method needed to achieve a tolerance of @xmath123 .",
    "data correspond to daily historical times series ( @xmath117 days ) of different groups of stocks of the standard and poor s 500 group of shares .",
    "[ tab : eigenvalloc ] [ cols=\"<,<,<,<,<,<,<,<\",options=\"header \" , ]",
    "according to @xcite the optimal portfolio @xmath124 of independent , correlated gaussian stochastic processes , that ensures the smallest possible risk @xmath125 subject to the constraint @xmath126 reads : @xmath127 practical applications of this recipe are limited because the weights @xmath28 are very sensitive to perturbations of the matrix elements @xmath67 .",
    "we have tested the sensitivity in the following simple experiment .",
    "having perturbed the correlation matrix @xmath67 with gaussian noise with mean zero and variance @xmath128 , i.e @xmath129 where @xmath130 we measure the average relative variation @xmath131 in the markovitz weights defined in ( [ eq : portfolioweigths ] ) . here",
    "@xmath28 and @xmath132 are related to the matrices @xmath67 and @xmath133 respectively .",
    "the results are shown in fig .",
    "[ fig : markowitzweightsvariat ] . as we can see",
    "an addition of only 1% noise ( @xmath134 = 0.01 ) makes the markovitz weights change already by 25% ( @xmath135 = 0.25 ) . on the other hand in fig .",
    "[ fig : testdenoise1 ] we see that the estimator of correlations @xmath15 differs from the underlying correlation matrix @xmath67 by approximately 0.8%1.2% for @xmath78 = 0.050.1 . in sec .",
    "[ sec : simul ] we concluded that the algorithm removes on average 25% noise once the ration @xmath136 .",
    "therefore the noise contamination of the `` cleaned '' correlation matrix reduces to 0.6%0.9% and this gives us , from fig.[fig : markowitzweightsvariat ] , a decrease of the variation @xmath135 in markovitz weights 0.130.17 and 0.220.3 in case of the smallest and largest values of @xmath78 respectively .",
    "we see that the relative percentage variation in the markovitz - weights after applying the `` cleaning '' procedure is about @xmath137 @xmath138 25% .",
    "we have proved that the qualitative cross - correlations `` cleaning '' procedure suggested by @xcite and @xcite corresponds to a numerical minimization problem , namely to the problem of minimizing deviations between the eigenvalue spectrum of the measured cross - correlations and the spectrum of a random matrix .",
    "moreover , we have shown qualitatively that if the ratio @xmath136 the algorithm filters out roughly 25% noise from gaussian distributed stochastic processes , which corresponds to a percentage correction of the markovitz weights by roughly 25% .",
    "quantification of this statement will be desirable .",
    "h. markovitz , _ portfolio selection : efficient diversification of investments _ , j.wiley and sons , new york , ( 1959 ) ; elton e.j . and",
    "gruber m.j .",
    ", _ modern portfolio theory and investment analysis _ , j.wiley and sons , new york , ( 1995 ) bouchaud j.p . and",
    "potter m. , _ theory of financial risks . from statistical physics to risk management",
    "_ , cambridge university press , cambridge , united kingdom , ( 2000 )"
  ],
  "abstract_text": [
    "<S> this paper examines the applicability of random matrix theory to portfolio management in finance . starting from a group of normally distributed stochastic processes with given correlations we devise an algorithm for removing noise from the estimator of correlations constructed from measured time series . </S>",
    "<S> we then apply this algorithm to historical time series for the standard and poor s 500 index . </S>",
    "<S> we discuss to what extent the noise can be removed and whether the resulting underlying correlations are sufficiently accurate for portfolio management purposes .    </S>",
    "<S> random - matrix theory ; cross - correlations ; econophysics ; numerical optimization    pacs numbers : 02.50.sk,02.60.pn,05.40.ca,05.90.+m </S>"
  ]
}