{
  "article_text": [
    "a standard way to transform one binary tree into another is by performing ` subtree - prune - and - regraft ' ( @xmath1 ) moves ( definitions are given below ) .",
    "these operations are of particular interest for phylogenetic trees . for a pair of binary trees with @xmath6 labelled leaves ( including the root ) ,",
    "it was shown by allen and steele @xcite in @xmath7 that the maximum number of @xmath1 moves required to change one into the other , @xmath8 , is between @xmath9 and @xmath10 .",
    "martin and thatte  @xcite show the existence of a common subtree of size @xmath11 , which brings the upper - bound for @xmath8 down to @xmath12 .",
    "+ ding , grunewald and humphries @xcite show that @xmath8 is actually @xmath4 .",
    "we give an extended version of this result for the rooted and unrooted cases .",
    "we also show that if one of the trees is fixed arbitrarily and the other is chosen to maximise the number of spr moves required to turn one into the other , then still @xmath4 moves are required .",
    "we prove the last result by showing that for a fixed pair of binary trees , we can label the leaves in such a way that @xmath13 moves are required to turn one into the other .",
    "this result is set in a more general context of agreement forests for sets of @xmath14 trees .",
    "we also show that if two trees chosen independently , uniformly at random , then the expected number of moves required to transform one into the other is @xmath5 [ theorem [ thm : expectation ] ] .",
    "subtree transfer operations are subtly different when acting on rooted trees as opposed to unrooted trees .",
    "some papers have considered @xmath1 and @xmath2 moves as acting on different classes of binary tree .",
    "we give a unified treatment here ; when dealing with rooted - subtree - prune - and - regraft ( @xmath2 ) moves , we insist that one of the leaf - labels be @xmath15 , and this leaf acts effectively as the root of the tree .",
    "we insist that the root has degree @xmath16 and it behaves in exactly the same manner as the other leaves for @xmath1 and @xmath0 moves .. this is equivalent to our definition ( see definition [ def : b ] ) .",
    "simply add a new leaf , adjacent to the degree-@xmath17 root , label it @xmath15 and make it the new root . ]    in the subsections below we define binary trees , the three subtree transfer operations @xmath0 , @xmath1 and @xmath2 , and the corresponding metrics they induce over the class of binary trees .",
    "( 160,80 ) ( 30,65)(30,55)(30,45 ) ( 0,0)(15,22.5)(30,45 ) ( 30,0)(22.5,11.25)(15,22.5 ) ( 60,0)(45,22.5)(30,45 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,65 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,-13 ) ( 30,-13 ) ( 60,-13 ) ( 30,73 ) ( 120,0 ) ( 20,40)(20,30)(20,20 ) ( 0,0)(10,10)(20,20 ) ( 40,0)(30,10)(20,20 ) ( 0,60)(10,50)(20,40 ) ( 40,60)(30,50)(20,40 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,-13 ) ( 40,-13 ) ( 0,68 ) ( 40,68 )    [ def : b ] let @xmath18 be a non - empty , finite set . if @xmath19 , then a _ binary leaf - labelled tree _ with leaf - label set @xmath18 is a finite tree which has @xmath17 types of vertex :    * _ tree _ vertices of degree @xmath20 , and * _ leaf _ vertices of degree @xmath16 , labelled with the set @xmath18 ( there is a bijection between the leaves and @xmath18 ) .    if @xmath21 , the leaf labelled @xmath15 is called the _ root _ of the tree . in the trivial case ,",
    "when @xmath22 is a singleton , then the trivial graph containing only one vertex , labelled @xmath23 , is considered to be a binary leaf - labelled tree , and its vertex is called a leaf .",
    "let @xmath24 be the set of all binary leaf - labelled trees , with label set @xmath18 .",
    "for a leaf - labelled tree @xmath25 , let @xmath26 denote the label set of @xmath25 ; so if @xmath27 then @xmath28 .",
    "for trees @xmath29 and @xmath30 in @xmath24 , we say @xmath29 is isomorphic to @xmath30 ( denoted @xmath31 ) if there is a graph isomorphism preserving leaf labels ; if there is a bijection @xmath32 such that @xmath33 is an edge in @xmath29 if and only if @xmath34 is an edge in @xmath30 and for each leaf @xmath35 of @xmath29 , @xmath35 and @xmath36 are labelled with the same element of @xmath18 . for non - empty @xmath37 , let @xmath38 be the minimal subtree of @xmath25 that contains all the leaves with labels in @xmath39 .",
    "let @xmath40 be the tree formed by suppressing any vertices of degree @xmath17 from @xmath38 .",
    "so @xmath41 in this paper , @xmath18 will usually be @xmath42 , i.e. @xmath43 . so @xmath44 is @xmath45 for @xmath46 and in general for @xmath47 , the number is given by @xmath48      ( 200,120)(-10,0 ) ( -10,0 ) ( 30,30)(30,20)(30,10 ) ( 30,30)(45,30)(60,30 ) ( 30,80)(30,90)(30,100 ) ( 30,80)(55,80)(80,80 ) ( 60,80)(60,90)(60,100 ) ( -10,17)@xmath15 ( 28,-7)@xmath16 ( 63,17)@xmath17 ( -11,82)@xmath20 ( 22,106)@xmath49 ( 60,107)@xmath50 ( 83,85)@xmath51 ( 0,80)(7.5,72.5)(15,65 ) ( 30,80)(22.5,72.5)(15,65 ) ( 0,30)(7.5,37.5)(15,45 ) ( 30,30)(22.5,37.5)(15,45 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,10 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,80 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,100 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,100 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,80 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 15,45)(15,55)(15,65 ) ( 140,0 ) ( 60,30)(52.5,37.5)(45,45 ) ( 30,30)(37.5,37.5)(45,45 ) ( 30,30)(30,20)(30,10 ) ( 60,80)(52.5,72.5)(45,65 ) ( 30,80)(37.5,72.5)(45,65 ) ( 30,80)(30,90)(30,100 ) ( 60,80)(70,80)(80,80 ) ( 60,80)(60,90)(60,100 ) ( -10,17)@xmath15 ( 28,-7)@xmath16 ( 63,17)@xmath17 ( -11,82)@xmath20 ( 22,106)@xmath49 ( 60,107)@xmath50 ( 83,85)@xmath51 ( 30,80)(15,80)(0,80 ) ( 30,30)(15,30)(0,30 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,10 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,80 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,100 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,100 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,80 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 45,45)(45,55)(45,65 ) ( 95,50 )    [ def : tbr ] a tree - bisection - and - reconnection ( tbr ) on a tree @xmath52 , for @xmath53 , is a two step process :    1 .   _",
    "( bisection step ) _ delete an edge @xmath54 from @xmath29 ( this edge is called the _ bisection _ edge ) and then suppress all degree @xmath17 vertices ( the edges created by these suppressions are called _ new _ edges ) to obtain a pair @xmath55 of binary trees with @xmath56 .",
    "( the number of new edges is @xmath17 , unless the bisection edge was incident with a leaf . in the later case ,",
    "there is only one new edge and either @xmath57 or @xmath58 is an isolated vertex . ) 2 .   _",
    "( reconnection step ) _",
    "connect @xmath57 and @xmath58 by creating an edge between the midpoint of an edge in @xmath57 and the midpoint of an edge in @xmath58 .",
    "this edge is called the _ reconnecting _ edge .",
    "( in the case that @xmath57 or @xmath58 is an isolated vertex , instead the reconnecting edge is incident to this vertex . )    see figure  [ fig : tbrdefinition ] : on the left the bisection edge is blue and the green edges will form the new edges , and on the right the blue edge is the reconnection edge and the green edges are the new edges .",
    "if @xmath27 , and @xmath59 is the result of performing a tbr on @xmath25 , then @xmath60 because @xmath59 must be connected , acyclic , and all non - leaf vertices have degree @xmath20 .",
    "let @xmath61 denote the set of pairs @xmath62 such that @xmath59 can be obtained from @xmath25 by performing a single tbr move .",
    "[ prop : sym1 ] @xmath63 if and only if @xmath64 .",
    "if @xmath65 is a tbr which transforms @xmath25  into  @xmath59 , then we can find a tbr , @xmath66 which transforms @xmath59  into  @xmath25 using the following construction .",
    "firstly use the reconnecting edge of @xmath65 as the bisection edge of @xmath66 .",
    "the two components formed will be identical to the two components formed when the bisection step of @xmath65 was performed .",
    "if @xmath65 had two new edges , then we can let the reconnecting edge of @xmath66 be an edge between the midpoints of these edges .",
    "if @xmath65 had one new edge then one part , say @xmath58 must be an isolated vertex @xmath35 , and so we can let the reconnecting edge of @xmath66 be an edge between @xmath35 and the midpoint of the edge in @xmath57 which was the new edge of @xmath65 .",
    "the spr move ( definition [ def : spr ] ) is an operation on binary trees whereby a subtree is removed from one part of the tree and regrafted to another part of the tree .",
    "spr moves feature in many papers , see for example : @xcite and @xcite .",
    "these spr moves are widely used by tree - searching software packages , like paup @xcite and garli @xcite , used in phylogenetic research .",
    "( 230,60 ) ( 0,0 ) ( 0,0)(7.5,15)(15,30 ) ( 15,30)(15,45)(15,60 ) ( 45,60)(52.5,30)(60,0 ) ( 30,0)(22.5,15)(15,30 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 15,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 15,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 45,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 10,68 ) ( -5,-14 ) ( 45,68 ) ( 60,-14 ) ( 20,25 ) ( 28,-14 ) ( 108,30 ) ( 170,0 ) ( 0,0)(7.5,30)(15,60 ) ( 45,30)(45,45)(45,60 ) ( 45,30)(52.5,15)(60,0 ) ( 30,0)(37.5,15)(45,30 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 15,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 45,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 45,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 10,68 ) ( -5,-14 ) ( 45,68 ) ( 60,-14 ) ( 34,25 ) ( 28,-14 )    [ def : spr ] a _ subtree - prune - and - regraft _ ( spr ) move taking @xmath67 from @xmath68 to @xmath69 is an operation which can be performed on a tree @xmath52 , as long as @xmath70 are distinct edges ( vertices @xmath71 need not be distinct ; possibly @xmath72 , @xmath73 , @xmath74 or @xmath75 ) and the path from @xmath76 to @xmath77 contains @xmath78 .",
    "a spr move is a two step process :    * _ ( prune step ) _ delete edges @xmath79 , @xmath80 and replace them with @xmath68 , then * _ ( regraft step ) _ delete edge @xmath69 and replace it with @xmath81 and @xmath82 .",
    "let @xmath83 denote the set of pairs @xmath84 such that @xmath27 and @xmath59 is the result of a spr move on @xmath25 .",
    "if @xmath21 and the path from @xmath15 to @xmath77 passes through @xmath78 , then this is called a _ rooted - subtree - prune - and - regraft _ ( rspr ) move .",
    "let @xmath85 denote the set of pairs @xmath84 such that @xmath59 is the result of an rspr move on @xmath25 .",
    "see figure  [ fig : sprdefinition ] . by definition ,",
    "an rspr move is a special case of a spr move .",
    "it is not difficult to check that a spr move is a special case of a tbr move .",
    "informally , a spr move is any tbr move in which one of @xmath57 or @xmath58 is an isolated vertex or one of the endpoints of the reconnecting edge is the midpoint of one of the new edges .",
    "therefore any valid spr move performed on a binary tree in @xmath24 will result in a tree in @xmath24 , and moreover : @xmath86 if we think of the edges as being oriented away from the root , then an rspr move is any spr move that preserves these orientations .",
    "[ prop : sym2 ] if @xmath87 then @xmath88 .",
    "moreover , if @xmath89 then @xmath90 .",
    "suppose that we start with a tree @xmath25 and perform the spr move ( or similarly the rspr move ) taking @xmath67 from @xmath68 to @xmath69 , and thus obtain @xmath59 .",
    "then starting at @xmath59 , we can perform the ` inverse ' spr move ( or rspr move ) taking @xmath67 from @xmath69 to @xmath68 , and thus we obtain @xmath25 .    not all spr moves can be achieved with a single rspr move . indeed , we may need an arbitrary number of rspr moves to simulate one spr move .",
    "for example the trees in figure [ fig : rsprnotspr ] differ by a single spr by pruning off the single leaf labelled @xmath15 , and then regrafting it appropriately . in example",
    "[ ex : spr_using_rspr ] we will show that at least @xmath91 rspr moves are required to transform one into the other .",
    "( 200,95)(-10,0 ) ( 40,60)(40,67.5)(40,75 ) ( 0,0)(20,30)(40,60 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(30,15)(20,30 ) ( 80,0)(60,30)(40,60 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,75 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 56,-2 ) ( 80,-13 ) ( 45,83 ) ( 120,0 ) ( 40,60)(40,67.5)(40,75 ) ( 0,0)(20,30)(40,60 ) ( 20,0)(35,22.5)(50,45 ) ( 40,0)(50,15)(60,30 ) ( 80,0)(60,30)(40,60 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,75 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 56,-2 ) ( 80,-13 ) ( 45,83 )    the following proposition is lemma 2.7 ( 2b ) in @xcite .",
    "[ prop : tbrusingsprs ] any tbr move can be achieved using at most @xmath17 sprs ; if @xmath63 , then there exists some @xmath92 such that @xmath93",
    ".      the @xmath1-distance ( definition [ def : distance ] ) has been the subject of several publications , for example @xcite , @xcite , @xcite .",
    "the problem of determining the rspr - distance between a pair of trees was shown to be @xmath94-hard by bordewich and semple @xcite in @xmath95 .",
    "we shall see later , that all of the values in the following definition are finite .    for @xmath96 and any subtree transfer operation @xmath97 ,",
    "define the @xmath98-distance between @xmath25 and @xmath59 ( denoted @xmath99 ) , to be the minimum number of @xmath98 moves required to change @xmath25 into @xmath59 .",
    "when discussing rspr moves , we assume @xmath21 . by propositions [ prop : sym1 ] and [ prop :",
    "sym2 ] , this distance is symmetric . for @xmath100 and @xmath101 \\cup \\ { 0 \\}$ ] ,",
    "let @xmath102 denote the @xmath98-_diameter _ of the class @xmath24 ; @xmath103 and moreover , let @xmath104 denote the @xmath98-_radius _ of the class @xmath24 ; @xmath105 [ def : distance ]    the following is an immediate consequence of @xmath106 .",
    "[ obs : trivial_bounds ] for any @xmath107 , and any integer @xmath108 , we have @xmath109 .",
    "moreover , @xmath110      the values of the radius and diameter for @xmath111 are given in figure  [ tab : small_values ] .",
    "the asymptotic values of the radius and diameter are given in the following theorem .",
    "for each @xmath107 , both @xmath102 and @xmath104 are @xmath4 .",
    "[ thm : extreme ]    by observation [ obs : trivial_bounds ] , it suffices to give an upper bound for the rspr - diameter and a lower bound for the tbr - radius , both of the form @xmath4 .",
    "these bounds are given explicitly in lemmas [ lem : ub_d_raf ] and [ lem : lb_r_uaf ] respectively .",
    "[ thm : expectation ] if @xmath25 and @xmath59 are chosen uniformly at random from @xmath112 \\cup \\ { 0 \\ } ) $ ] , then @xmath113 = n - \\theta(n^{2/3})\\ ] ] for any @xmath107 .    again by observation [ obs :",
    "trivial_bounds ] , it suffices to give an upper bound for the expected rspr - distance and a lower bound for the expected tbr - distance , both of the form @xmath5 .",
    "these bounds are given explicitly in lemmas [ lem : ub_expect_raf ] and [ lem : lb_expect_uaf ] respectively .",
    "the upper - bound in theorem  [ thm : extreme ] is proved in this section using rooted agreement forests .",
    "the definition of a rooted agreement forest given here is equivalent to that used by bordewich and semple @xcite .",
    "[ def : raf ] let @xmath21 , and let @xmath115 be a set of @xmath14 trees .",
    "a _ rooted agreement forest _ of @xmath116 is a partition @xmath117 of @xmath18 , such that for all @xmath118 :    * the subtrees @xmath119 , @xmath120 , @xmath121 , @xmath122 are disjoint , and * @xmath123 for @xmath124 .",
    "let @xmath125 be the minimal possible value of @xmath126 ; the minimal number of parts in a rooted agreement forest of @xmath116 . when @xmath127 , we write @xmath128 for @xmath129 .",
    "when @xmath47 and @xmath130 , we can always construct a trivial rooted agreement forest with @xmath131 parts by setting @xmath132 and @xmath133 for @xmath134 .",
    "therefore @xmath135 for any @xmath96 .",
    "three minimal agreement forests are depicted in figure [ fig : rafdefinition ] .",
    "@xmath136 = \\ {    ( 80,40)(-10,20 ) ( 30,60)(30,50)(30,45 ) ( 0,0)(15,22.5)(30,45 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(30,15)(20,30 ) ( 60,0)(45,22.5)(30,45 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 33,67 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 60,-13 )    c @xmath137 + @xmath137 + @xmath137 + @xmath137 + ,    ( 80,40)(-10,20 ) ( 30,60)(30,50)(30,45 ) ( 0,0)(15,22.5)(30,45 ) ( 20,0)(30,15)(40,30 ) ( 40,0)(45,7.5)(50,15 ) ( 60,0)(45,22.5)(30,45 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 33,67 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 60,-13 )    } @xmath136    ( 400,50 ) ( 0,0 ) ( 30,30)(30,40)(30,50 ) ( 30,30)(15,15)(0,0 ) ( 30,30)(45,15)(60,0 ) ( 20,0)(20,5)(20,10 ) ( 40,0)(40,5)(40,10 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,50 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 33,57 ) ( 0,-15 ) ( 20,-15 ) ( 40,-15 ) ( 60,-15 ) ( 160,0 ) ( 30,40)(30,25)(30,10 ) ( 30,10)(25,5)(20,0 ) ( 30,10)(35,5)(40,0 ) ( 0,0)(0,5)(0,10 ) ( 60,0)(60,5)(60,10 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,40 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 33,47 ) ( 0,-15 ) ( 20,-15 ) ( 40,-15 ) ( 60,-15 ) ( 320,0 ) ( 10,10)(5,5)(0,0 ) ( 10,10)(15,5)(20,0 ) ( 50,10)(45,5)(40,0 ) ( 50,10)(55,5)(60,0 ) ( 10,10)(10,13)(10,16 ) ( 50,10)(50,13)(50,16 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 33,37 ) ( 0,-15 ) ( 20,-15 ) ( 40,-15 ) ( 60,-15 )    the following result is proved by bordewich and semple @xcite , building on the work of hein et al @xcite .",
    "we give a proof here for completeness .",
    "[ lem : rafl ] if @xmath25 and @xmath59 are any two trees in @xmath24 , then @xmath138    let @xmath139 be a sequence with @xmath140 for all @xmath141 .",
    "if we perform all the _ prunes _ of these rspr moves ( and none of the _ regrafts _ ) , then the result will be a partition of the leaves into a valid ( rooted ) agreement forest for @xmath25 and @xmath59 .",
    "therefore @xmath142 now we will show that @xmath143 , by induction on @xmath144 . for the base case @xmath145 , the only agreement forest with one component would be @xmath146 itself , thence @xmath147 .",
    "for the inductive step @xmath148 , it suffices to show that there exists some @xmath149 such that @xmath150 and @xmath151 .",
    "let @xmath152 be an agreement forest for @xmath84 of @xmath148 parts and wlog @xmath153 .",
    "we can construct @xmath154 from @xmath155 explicitly :    * wlog @xmath156 is one of the subtrees of @xmath59 that is connected to @xmath157 by a path @xmath158 , which does not intersect @xmath159 for any @xmath160 .",
    "* let @xmath161 be the first edge on the path @xmath162 from @xmath120 to @xmath119 , where @xmath77 is in @xmath120 and @xmath78 is not .",
    "if @xmath78 is a leaf ( i.e. if @xmath163 and @xmath164 is the root ) then we do not perform an rspr move .",
    "otherwise @xmath78 is a tree vertex .",
    "let @xmath165 and @xmath166 be the two neighbours of @xmath78 other than @xmath77 .",
    "* now we can prune @xmath25 at @xmath54 ( that is , take @xmath67 from its current position on @xmath68 ) and then regraft it to form @xmath154 such that @xmath167 in the case that @xmath163 is a singleton , this involves regrafting at the only edge incident with the root of @xmath25 . otherwise ( if @xmath168 ) this involves regrafting at an internal edge of @xmath119 corresponding to where the path @xmath158 joins @xmath157 .",
    "we know that @xmath169 is an agreement forest for @xmath170 , because of for all @xmath160 :    * @xmath171 does not intersect @xmath172 , * @xmath173 does not intersect @xmath159 , * and @xmath174 .",
    "hence @xmath175 , which ( by the inductive hypothesis ) means that @xmath176 and therefore @xmath177 as required .",
    "( 100,130)(0,10 ) ( 40,130)(30,115)(20,100 ) ( 40,130)(50,115)(60,100 ) ( 20,100)(40,100)(60,100 ) ( 20,80)(10,65)(0,50 ) ( 20,80)(30,65)(40,50 ) ( 0,50)(20,50)(40,50 ) ( 60,100)(65,90)(70,80 ) ( 70,80)(55,57.5)(40,35 ) ( 70,80)(85,57.5)(100,35 ) ( 40,35)(70,35)(100,35 ) ( 40,130 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 38,138 ) ( 30,105 ) ( 10,55 ) ( -20,100 ) ( 24,87 ) ( 20,80)(20,90)(20,100 )    ( 90,130)(0,5 ) ( 40,130)(30,115)(20,100 ) ( 40,130)(50,115)(60,100 ) ( 20,100)(40,100)(60,100 ) ( 60,90)(75,67.5)(90,45 ) ( 30,45)(60,45)(90,45 ) ( 30,35)(20,20)(10,5 ) ( 30,35)(40,20)(50,5 ) ( 10,5)(30,5)(50,5 ) ( 40,130 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 38,138 ) ( 30,105 ) ( 20,10 ) ( -20,100 ) ( 35,75 ) ( 32,36 ) ( 20,35)(0,60)(18,90 ) ( 18,90)(1,2)0 ( 60,100)(60,95)(60,90 ) ( 60,90)(45,67.5)(30,45 ) ( 30,45)(30,40)(30,35 )    the rspr - distance between a pair of trees is often used as a measure of the discrepancy between a pair of binary trees .",
    "so @xmath125 can be seen as generalisation of this notion from pairs of trees to arbitrary large sets of trees .",
    "[ ex : spr_using_rspr ] let @xmath25 and @xmath59 be the two caterpillar trees in figure [ fig : rsprnotspr ] , which differ only by a single spr changing the location of the root .",
    "the other leaves in @xmath25 are ordered in the usual ( @xmath178 ) order from the root , while in @xmath59 they are in the reverse order .",
    "we will show here that @xmath179 . by the rooted agreement forest lemma ( lemma [ lem : rafl ] )",
    "this means @xmath180 and so @xmath181 to show @xmath179 , notice that @xmath182 is never isomorphic to @xmath183 because the leaf neasrest to @xmath15 in @xmath182 is the smallest of @xmath184 while the leaf nearest to @xmath15 in @xmath185 is the largest . therefore if @xmath186 is a rooted agreement forest for @xmath187 , with @xmath153 , then @xmath188 and @xmath189 for all @xmath190 .",
    "so @xmath191 and therefore @xmath192 .",
    "the next two lemmas provide an explicit construction to find an agreement forest for arbitrary @xmath193 .",
    "[ lem : cut ] let @xmath43 , let @xmath52 be a binary tree with a root and let @xmath194 $ ] be a real number .",
    "it is possible to remove a single edge from @xmath29 , so that the number of leaves in the component not containing the root is in the interval @xmath195 .",
    "( 140,125 ) ( 70,125)(70,115)(70,105 ) ( 0,0)(35,52.5)(70,105 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(65,37.5)(90,75 ) ( 60,0)(65,7.5)(70,15 ) ( 80,0)(70,15)(60,30 ) ( 100,0)(105,7.5)(110,15 ) ( 120,0)(100,30)(80,60 ) ( 140,0)(105,52.5)(70,105 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 100,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 120,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 140,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 70,125 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 75,105 ) ( 93,75 ) ( 68,60 ) ( 48,30 ) ( 73,15 ) ( 58,130 )    wlog",
    "let @xmath21 be the root . for each vertex",
    "@xmath196 let @xmath197 be the set of leaves @xmath77 such that @xmath78 is on the path between @xmath15 and @xmath77 .",
    "for every non - leaf vertex @xmath198 , @xmath199 where @xmath200 are the neighbours of @xmath198 which are not on the path from @xmath198 to the root . moreover , if @xmath35 is a leaf then @xmath201 ( unless @xmath202 , in which case @xmath203 ) .",
    "therefore , for each tree - node @xmath204 , there exists a neighbour @xmath205 such that @xmath206 now construct a path @xmath207 , such that @xmath208 is the root , @xmath209 is the neighbour of the root and equation   holds for each @xmath210 .",
    "this sequence terminates when @xmath211 is a leaf .",
    "so the sequence decreases from @xmath212 and never decreases by a factor less than @xmath213 in a single step .",
    "hence there must be some @xmath214 such that @xmath215 if edge @xmath216 is deleted , then @xmath217 is precisely the set of leaves in the component containing @xmath218 .",
    "[ lem : divide_tree_equally ] for @xmath219 , let @xmath52 and let @xmath165 be a real number greater than @xmath16 .",
    "it is possible to divide @xmath29 into disjoint subtrees such that each leaf lies in a subtree , each subtree contains less than @xmath165 leaves and at most one subtree contains less than @xmath220 leaves .",
    "( by induction ) the case @xmath221 is trivial .",
    "if @xmath222 , then we can use lemma  [ lem : cut ] iteratively to prune off subtrees with less than @xmath165 ( but at least @xmath220 ) leaves until the remaining tree has less than @xmath165 leaves left ( this remainder might have less than @xmath220 leaves ) .",
    "[ lem : ub_d_raf ] for @xmath223 , and any collection @xmath224 , @xmath225    ( 140,125 ) ( 40,0)(65,37.5)(90,75 ) ( 140,0)(105,52.5)(70,105 ) ( 70,125)(70,115)(70,105 ) ( 0,0)(35,52.5)(70,105 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(50,15)(60,30 ) ( 60,0)(65,7.5)(70,15 ) ( 80,0)(70,15)(60,30 ) ( 100,0)(105,7.5)(110,15 ) ( 120,0)(100,30)(80,60 ) ( 140,0)(115,37.5)(90,75 ) ( 80,60)(85,67.5)(90,75 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 100,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 120,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 140,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 70,125 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 )    ( by construction ) divide each @xmath226 into @xmath227{\\frac{n+1}{k+1 } } \\right\\rfloor$ ] ( possibly empty ) disjoint connected parts , @xmath228 such that each part contains less than @xmath229 leaves .",
    "this is possible by letting @xmath230 in lemma [ lem : divide_tree_equally ] .",
    "now , let us define a _",
    "token _ to be any map @xmath231 \\rightarrow [ t]$ ] .",
    "for any token @xmath232 , define @xmath233 we say that @xmath232 is _ good _ if @xmath234 , and we say a pair @xmath235 is _ compatible _ if @xmath236 for all @xmath237 . now",
    "if @xmath29 is a set of pairwise compatible , good tokens , then we can construct an agreement forest of @xmath238 parts in the following manner :    * for each @xmath239 , construct a part of size @xmath17 using labels in @xmath240 , * all other labels are put in their own part of size @xmath16 .    the paths between labels in each part of this partition will be disjoint because the tokens are compatible . hence this is a valid agreement forest .",
    "now let @xmath29 be any maximal set of compatible good tokens ( i.e. every good token that is not in @xmath29 is incompatible with a token in @xmath29 ) .",
    "then for each label @xmath241 either @xmath242 for some non - good token @xmath243 , or @xmath244 for some @xmath239 .",
    "so let us count :    * there are @xmath6 labels in total , * at most @xmath245 non - good tokens , each with at most @xmath16 label in @xmath246 , and * less than @xmath247 labels in @xmath248 for each token @xmath239",
    ".    therefore @xmath249 .",
    "substituting @xmath250{\\tfrac{n+1}{k+1 } } \\right\\rfloor$ ] , we can compute @xmath251 since the above inequality is strict and @xmath252 are both integers , we can tighten the bound to : @xmath253{\\frac{n+1}{k+1}}\\ ] ] as required .    setting @xmath127 in lemma  [ lem : ub_d_raf ] and then applying the rooted agreement forest lemma  ( [ lem : rafl ] ) gives @xmath254 which yields a suitable upper bound in theorem  [ thm : extreme ] .",
    "the upper bound in theorem [ thm : expectation ] is established in this section .",
    "in fact lemma [ lem : ub_expect_raf ] is stronger because the underlying unlabelled trees are not chosen randomly .",
    "[ lem : ub_expect_raf ] let @xmath14 be a fixed integer .",
    "let @xmath101 \\cup \\ { 0 \\}$ ] and let @xmath255 be an arbitrary set of @xmath256 trees in @xmath24 . if @xmath116 is obtained by performing a permutation of the leaf - labels of each @xmath257 ( the permutations are chosen independently and uniformly at random ) , then @xmath258 \\leq n - \\omega\\left ( n^{2/(k+1 ) } \\right)\\ ] ] as @xmath259 .",
    "( 140,170)(0,-15 ) ( 58,155 ) ( -5,-25 ) ( 55,-25 ) ( 135,-25 ) ( 70,150)(70,145)(70,135 ) ( -20,0)(25,67.5)(70,135 ) ( 0,0)(-5,7.5)(-10,15 ) ( 40,0)(70,45)(100,90 ) ( 60,0)(65,7.5)(70,15 ) ( 80,0)(70,15)(60,30 ) ( 100,0)(85,22.5)(70,45 ) ( 140,0)(115,37.5)(90,75 ) ( 160,0)(115,67.5)(70,135 ) ( -20,0)(-10,15)(0,30 ) ( 20,0)(10,15)(0,30 ) ( 120,0)(125,7.5)(130,15 ) ( 130,15)(110,45)(90,75 ) ( 160,0)(130,45)(100,90 ) ( 90,75)(95,82.5)(100,90 ) ( -25,-8)(-25,-10)(-25,-12 ) ( -25,-12)(0,-12)(25,-12 ) ( 25,-8)(25,-10)(25,-12 ) ( 35,-8)(35,-10)(35,-12 ) ( 35,-12)(60,-12)(85,-12 ) ( 85,-8)(85,-10)(85,-12 ) ( 115,-8)(115,-10)(115,-12 ) ( 115,-12)(140,-12)(165,-12 ) ( 165,-8)(165,-10)(165,-12 ) ( -20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 100,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 120,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 140,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 160,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 70,150 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 )    set @xmath260 { \\frac{kn^{k-1}}{2 } } \\right\\rfloor$ ] and @xmath261 .",
    "now for each @xmath257 , let @xmath262 be disjoint subtrees of @xmath29 such that the number of leaves in each @xmath263 is exactly @xmath166 .",
    "this is possible by lemma  [ lem : divide_tree_equally ] ( set @xmath264 ) and taking subtrees as necessary .",
    "let @xmath265 be the tree obtained by the random labelling of @xmath29 , and let @xmath266 be the subtrees of @xmath25 corresponding to @xmath267 respectively .",
    "call @xmath268 a _ good _ set if for each @xmath265 , the leaves labelled @xmath269 all lie in the same @xmath226 .",
    "we say that a good pair of distinct labels @xmath270 is _ spoiled _",
    "if for some @xmath265 , there is another good pair @xmath271 in the same subtree @xmath226 of @xmath25 as @xmath272 and @xmath273 .",
    "we call a pair _ super _ if it is good but not spoiled .",
    "we have @xmath274 because for any @xmath265 the probability that @xmath275 is @xmath276 , and given that @xmath277 the probability that @xmath278 is @xmath279 . similarly : @xmath280 since @xmath281 being good if and only if @xmath270 and @xmath282 are both good , we can see that @xmath283 now fix a good pair @xmath270 with @xmath284 for some @xmath265 .",
    "if @xmath285 and @xmath286 are chosen from @xmath287 , we compute an upper bound on the probability that @xmath271 is a good pair . for each @xmath288 , the probability that @xmath289 is @xmath290 and given that @xmath291 , the probability that @xmath292 is at most @xmath293 .",
    "therefore @xmath294 now let @xmath295 denote the set of all pairs @xmath296 distinct from @xmath270 , which lie in the same @xmath226 as @xmath270 for some @xmath265 . using the union bound , the probability that @xmath270 is super is bounded below by @xmath297       \\label{eq : union_bound}\\ ] ] where the sum ranges over all @xmath298 .",
    "there are at most @xmath299 such pairs with @xmath300 , and at most @xmath301 such pairs with @xmath302 .",
    "substituting equations ( [ eq : bound1 ] ) and ( [ eq : bound2 ] ) into ( [ eq : union_bound ] ) yields the lower bound @xmath303.\\ ] ] the values @xmath304 and @xmath305 were chosen so that the factors in the above expression are positive and so this bound is @xmath306 . therefore ,",
    "if @xmath39 is the number of super pairs , then @xmath307 = \\binom{n+1}{2 } { \\mathbb{p}}\\big ( \\ { x_1,x_2 \\ } \\mbox { super } \\big ) = \\omega\\left ( n^{2/(k+1)}\\right).\\ ] ] now let us partition the labels such that each super pair forms a part of size two ( super pairs are disjoint by definition ) , and all other labels are in individual parts .",
    "this partition is a valid agreement forest , because if @xmath308 and @xmath309 are any super pairs , then for any @xmath265 we know that @xmath310 is contained within @xmath226 and @xmath311 is contained within @xmath312 for some @xmath313 .",
    "hence @xmath314 and so @xmath258 \\leq n+1-{\\mathbb{e}}[s ] = n - \\omega\\big ( n^{2/(k+1 ) } \\big ) .",
    "\\eqno\\qedhere\\ ] ]    if we set @xmath127 in lemma  [ lem : ub_expect_raf ] and apply the rooted agreement forest lemma ( lemma  [ lem : rafl ] ) we see that @xmath315 \\leq n - \\omega\\big ( n^{2/3 } \\big).\\ ] ] if @xmath316 is chosen uniformly at random , then a random relabelling of the leaves would not affect the distribution , so the last inequality gives the upper bound in theorem  [ thm : expectation ] .",
    "the lower bound in theorem [ thm : extreme ] is established in lemma  [ lem : lb_r_uaf ] at the end of this section . the proofs in this section",
    "use a notion similar to the rooted agreement forest from the previous section ; definition [ def : uaf ] and lemma [ lem : uafl ] below are analogous to definition [ def : raf ] and lemma [ lem : rafl ] , for @xmath0s instead of @xmath2s .",
    "[ def : uaf ] let @xmath115 be a set of @xmath14 trees .",
    "an _ unrooted agreement forest _ of @xmath116 is a partition @xmath117 of @xmath18 , such that for all @xmath118 :    * the subtrees @xmath119 , @xmath120 , @xmath121 , @xmath122 are disjoint , and * @xmath317 for @xmath318 .",
    "let @xmath319 be the minimal possible value for @xmath126 ; the minimal number of parts in an unrooted agreement forest of @xmath116 .",
    "when @xmath127 , we write @xmath320 for @xmath321 .    @xmath136 = \\ {    ( 80,40)(-10,20 ) ( 30,60)(30,50)(30,45 ) ( 0,0)(15,22.5)(30,45 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(30,15)(20,30 ) ( 60,0)(45,22.5)(30,45 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 28,67 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 60,-13 )    c @xmath137 + @xmath137 + @xmath137 + @xmath137 + ,    ( 80,40)(-10,20 ) ( 30,60)(30,50)(30,45 ) ( 0,0)(15,22.5)(30,45 ) ( 20,0)(30,15)(40,30 ) ( 40,0)(45,7.5)(50,15 ) ( 60,0)(45,22.5)(30,45 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,60 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 28,67 ) ( 0,-13 ) ( 20,-13 ) ( 40,-13 ) ( 60,-13 )    } @xmath136    ( 60,50 ) ( 0,0 ) ( 0,0)(10,10)(20,20 ) ( 20,0)(20,10)(20,20 ) ( 40,0)(40,10)(40,20 ) ( 60,0)(50,10)(40,20 ) ( 20,20)(30,20)(40,20 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 30,50 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 28,60 ) ( 0,-14 ) ( 20,-14 ) ( 40,-14 ) ( 60,-14 )    [ lem : uafl ] if @xmath25 and @xmath59 are any two trees in @xmath24 , then @xmath322    let @xmath323 , be a sequence satisfying @xmath324 for each @xmath325 $ ] .",
    "if we perform all the _ bisections _ of these tbr moves ( and none of the _ reconnections _ ) , then the result will be an agreement forest of at most @xmath326 parts . therefore @xmath327 now we show @xmath328 , by induction on @xmath126 . for the base case @xmath145 ,",
    "any agreement forest with one component must be @xmath146 itself , thence @xmath329 .",
    "for the inductive step @xmath148 , it suffices to show that there exists some @xmath154 with @xmath330 , such that @xmath331 .",
    "let @xmath332 be an agreement forest for @xmath84 .",
    "we can construct @xmath154 from @xmath155 explicitly :    step 1 : : :    choose @xmath54 , the bisection edge , arbitrarily from the edges    not in @xmath333 for any @xmath237 .",
    "we know that such    an edge exists because @xmath148 .    the deletion of @xmath54 forms two non - empty components @xmath334 and @xmath335 .",
    "note that each of the parts @xmath333 lie completely within one of @xmath334 or @xmath335 .",
    "step 2 : : :    now arbitrarily choose a pair of parts @xmath336 and    @xmath337 , such that @xmath338 lies in    @xmath334 and @xmath339 lies in @xmath335 .",
    "let @xmath158 be the path in @xmath59 from a vertex in    @xmath340 to a vertex in @xmath341 .",
    "step 3 : : :    let @xmath209 be the last vertex on @xmath158 which    lies in a part @xmath157 ( not necessarily distinct from    @xmath340 ) such that @xmath119 lies in    @xmath334 .",
    "let @xmath342 be first vertex after    @xmath209 in @xmath158 which lies in a part    @xmath156 ( not necessarily distinct from    @xmath341 ) .",
    "by definition , @xmath120 must lie in    @xmath335 ( see figure [ fig : uaflemma ] ) .",
    "so the path between @xmath209 and @xmath342 has no vertices in any @xmath159 except for its endpoints .",
    "now @xmath209 corresponds to the midpoint of an edge in @xmath343 , which in turn corresponds to a path @xmath344 in @xmath334 ( or else @xmath345 and @xmath346 is a singleton ) .",
    "similarly @xmath342 corresponds to a @xmath347 in @xmath335 ( or @xmath348 ) .",
    "step 4 : : :    construct @xmath154 to be the reconnection of    @xmath334 and @xmath335 by an edge between the    midpoint of an edge in @xmath344 and the midpoint of an edge    in @xmath347 ( if @xmath346 or @xmath349 is a    singleton , then simply use its vertex as the endpoint of the    reconnecting edge ) .    by construction ,",
    "@xmath330 because we constructed @xmath154 by performing a tbr move on @xmath25 .",
    "moreover @xmath350 , so @xmath351 is an agreement forest for @xmath170 , of size @xmath352 .",
    "we now present a result concerning permutations ( lemma  [ lem : orderings ] ) and a property of @xmath116 that guarantees large @xmath319 ( lemma  [ lem : deleting_edges ] ) .",
    "these two lemmas are the two crucial steps required for the proof of the main result of this section ( lemma  [ lem : lb_r_uaf ] ) .",
    "( 130,50)(-10,0 ) ( 0,30)(65,30)(130,30 ) ( 0,0 ) ( 0,40)(-10,40)(-13,20 ) ( 0,40)(10,40)(13,20 ) ( 0,0)(-16,0)(-13,20 ) ( 0,0)(16,0)(13,20 ) ( -11,10 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,40)(-10,40)(-13,20 ) ( 0,40)(10,40)(13,20 ) ( 0,0)(-16,0)(-13,20 ) ( 0,0)(16,0)(13,20 ) ( -11,10 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 90,0 ) ( 0,40)(-10,40)(-13,20 ) ( 0,40)(10,40)(13,20 ) ( 0,0)(-16,0)(-13,20 ) ( 0,0)(16,0)(13,20 ) ( -11,10 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 130,0 ) ( 0,40)(-10,40)(-13,20 ) ( 0,40)(10,40)(13,20 ) ( 0,0)(-16,0)(-13,20 ) ( 0,0)(16,0)(13,20 ) ( -11,10 ) ( 0,30 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,23 ) ( 35,48 ) ( 85,48 )    [ lem : orderings ] for any given integers @xmath353 such that @xmath354{n+1}$ ] , let @xmath130",
    ". there exist @xmath256 permutations @xmath355 such that for any distinct @xmath356 there exists some @xmath237 such that @xmath357    ( by construction ) represent each @xmath241 by the @xmath256-tuple @xmath358 of non - negative integers such that    * @xmath359 , and * @xmath360 for all @xmath361 .    if @xmath362 , then this is exactly representing @xmath78 in base @xmath166 . for larger @xmath78 , we allow the coefficient of @xmath363 to exceed @xmath364 .",
    "now let @xmath365 be the identity permutation , and for each @xmath366 we define @xmath367 so that @xmath368 see figure [ fig : orderings ] for an illustration . if @xmath369 then for @xmath370 and @xmath371 ( i.e. @xmath372 ) we have @xmath373 this is an equality when @xmath374 ( i.e. when @xmath6 is a perfect @xmath375 power ) , and increasing @xmath3 can only increase the number of labels @xmath376 such that @xmath377 is between @xmath378 and @xmath379 .",
    "+ now we fix distinct @xmath356 and wlog @xmath380 . there are four cases :    1 .",
    "@xmath381 for some @xmath237 2 .",
    "@xmath382 3 .",
    "@xmath383 and @xmath384 for all @xmath237 .",
    "4 .   @xmath383 and @xmath385 for some @xmath386 .",
    "we treat each of these cases separately .",
    "case 1 : : :    all @xmath376 such that @xmath387 must    have @xmath377 between @xmath378 and    @xmath379 .",
    "there are at least @xmath363 such    @xmath376 .",
    "case 2 : : :    wlog @xmath388 and @xmath389 for    @xmath390 for some @xmath370 .",
    "subbing this into    equation ( [ eq : order ] ) yields @xmath391 case 3 : : :    if @xmath392 and @xmath393 for all    @xmath394 , then    @xmath395 .",
    "case 4 : : :    we have @xmath392 and there is some @xmath370 ,    @xmath388 and @xmath393 for all    @xmath390 . substituting this into equation ( [ eq : order ] ) yields    @xmath396    ( 200,250 ) ( 0,0)(0,50)5 ( 0,0)(100,0)(200,0 )",
    "( 200,0)(200,25)(100,25 ) ( 100,25)(0,25)(0,50 ) ( 0,0)(50,0)5 ( 0,0 ) ( 0,0 ) ( 0,250)(50,250)(100,250 ) ( 0,250)(50,0)3 ( 0,0 ) ( 0,0 ) ( -4.5,-3.2 ) ( 45.5,-3.2 ) ( 95.5,-3.2 ) ( 145.5,-3.2 ) ( 195.5,-3.2 ) ( -4.5,46.8 ) ( 45.5,46.8 ) ( 95.5,46.8 ) ( 145.5,46.8 ) ( 195.5,46.8 ) ( -8.5,96.8 ) ( 41.5,96.8 ) ( 91.5,96.8 ) ( 141.5,96.8 ) ( 191.5,96.8 ) ( -8.5,146.8 ) ( 41.5,146.8 ) ( 91.5,146.8 ) ( 141.5,146.8 ) ( 191.5,146.8 ) ( -8.5,196.8 ) ( 41.5,196.8 ) ( 91.5,196.8 ) ( 141.5,196.8 ) ( 191.5,196.8 ) ( -8.5,246.8 ) ( 41.5,246.8 ) ( 91.5,246.8 ) ( -70,-3.2 )    ( 200,250 ) ( 0,0)(50,0)2 ( 0,0)(0,100)(0,250 ) ( 0,0)(25,0)(25,125 ) ( 25,125)(25,250)(50,250 ) ( 0,0)(0,50)6 ( 0,0 ) ( 0,0 ) ( 150,0)(-50,0)2 ( 0,0)(25,0)(25,100 ) ( 25,100)(25,200)(50,200 ) ( 50,0)(50,100)(50,200 ) ( 50,0)(0,50)5 ( 0,0 ) ( 0,0 ) ( 100,0)(100,125)(100,250 ) ( 100,0)(0,50)6 ( 0,0 ) ( 0,0 ) ( -4.5,-3.2 ) ( 45.5,-3.2 ) ( 95.5,-3.2 ) ( 145.5,-3.2 ) ( 195.5,-3.2 ) ( -4.5,46.8 ) ( 45.5,46.8 ) ( 95.5,46.8 ) ( 145.5,46.8 ) ( 195.5,46.8 ) ( -8.5,96.8 ) ( 41.5,96.8 ) ( 91.5,96.8 ) ( 141.5,96.8 ) ( 191.5,96.8 ) ( -8.5,146.8 ) ( 41.5,146.8 ) ( 91.5,146.8 ) ( 141.5,146.8 ) ( 191.5,146.8 ) ( -8.5,196.8 ) ( 41.5,196.8 ) ( 91.5,196.8 ) ( 141.5,196.8 ) ( 191.5,196.8 ) ( -8.5,246.8 ) ( 41.5,246.8 ) ( 91.5,246.8 ) ( 220,-3.2 )    [ lem : deleting_edges ] let @xmath397 be positive integers , let @xmath130 and let @xmath193 be a set of @xmath256 trees . for each @xmath265 let @xmath398 be a partition of the vertices of @xmath25 into at most @xmath399 connected parts .",
    "if for all but @xmath376 pairs of distinct labels @xmath356 there is at least one @xmath265 such that the leaves labelled with @xmath78 and @xmath77 are in different parts of @xmath25 , then @xmath400    let @xmath401 be an agreement forest of @xmath116 and let @xmath402 be a forest with leaves labelled by @xmath18 for some @xmath265 ( by definition [ def : uaf ] it does nt matter which @xmath265 we choose ) .",
    "each tree @xmath265 can be divided into the forest @xmath403 by deleting at most @xmath404 edges .",
    "let these edges be called _ hot _ edges .",
    "there is a total of at most @xmath405 hot edges ( at most @xmath404 in each @xmath265 ) .",
    "an edge in @xmath25 might not correspond to any edge in @xmath155 , moreover there many be several edges that correspond to the same edge in @xmath155 . in any case",
    ", each hot edge corresponds to at most one edge in @xmath155 .",
    "therefore if we delete all the edges in @xmath155 corresponding to hot edges , then we delete at most @xmath405 edges .",
    "+ the result of the deletion of these edges would be a forest of at least @xmath406 components because @xmath376 is an upper bound on the number of pairs of leaves in the same component .",
    "therefore @xmath155 must have had @xmath407 components .",
    "[ lem : lb_r_uaf ] let @xmath14 , let @xmath408 and let @xmath130",
    ". if @xmath409 is a collection of binary trees each with @xmath6 leaves , then there exists @xmath410 such that @xmath226 is a labelling of the leaves of @xmath263 , and @xmath411{n } + 1.\\ ] ]    first set @xmath412{n+1 } \\right\\rfloor \\ ; , \\;\\ ; t = \\left\\lceil \\frac{2n}{b^{k-1}-2b^{k-3 } } \\right\\rceil \\;\\ ;   \\mbox{and } \\;\\ ; a = \\frac{2n}{t } \\leq b^{k-1 } - 2b^{k-3}.\\ ] ] then divide each @xmath263 into at most @xmath399 connected parts , @xmath413 ( using lemma [ lem : divide_tree_equally ] ) so each part contains less than @xmath165 leaves .",
    "now it suffices to label the leaves of each @xmath263 such that for any pair of distinct labels @xmath356 , there is some @xmath237 such that @xmath78 and @xmath77 are in different parts of @xmath263 , and then apply lemma  [ lem : deleting_edges ] ( with @xmath414 ) .",
    "+    ( 256,125 ) ( 70,125)(70,115)(70,105 ) ( 0,0)(35,52.5)(70,105 ) ( 20,0)(15,7.5)(10,15 ) ( 40,0)(65,37.5)(90,75 ) ( 60,0)(65,7.5)(70,15 ) ( 80,0)(70,15)(60,30 ) ( 120,0)(100,30)(80,60 ) ( 140,0)(105,52.5)(70,105 ) ( -2,-14 ) ( 0,0 ) ( 20,0 ) ( 40,0 ) ( 60,0 ) ( 80,0 ) ( 100,0 ) ( 120,0 ) ( 140,0 ) ( 59,130 ) ( 70,38 ) ( 89,27 ) ( 0,60 ) ( 160,60 ) ( 240,60)(240,70)(240,80 ) ( 240,60)(232,55)(224,50 ) ( 222,36 ) ( 254,36 ) ( 230,85 ) ( 100,0)(105,7.5)(110,15 ) ( 110,15)(95,37.5)(80,60 ) ( 80,60)(70,45)(60,30 ) ( 60,30)(65,22.5)(70,15 ) ( 240,60)(248,55)(256,50 ) ( 0,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 20,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 40,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 60,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 80,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 100,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 120,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 140,0 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 70,125 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 240,80 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 224,50 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 ) ( 256,50 ) ( 0,0 ) ( -0.25,0.25 ) ( -0.5,0.5 ) ( -0.75,0.75 ) ( -1.0,1.0 ) ( -1.25,1.25 ) ( -1.5,1.5 ) ( -1.75,1.75 ) ( 0,0 )    to achieve this : first ( by lemma  [ lem : orderings ] ) find @xmath256 permutations of @xmath18 such that for any two distinct labels @xmath356 there is some @xmath415 such that @xmath416 . then assign labels to the leaves of @xmath263 in the order given by @xmath417 , firstly to all the leaves of @xmath418 , then @xmath419 , then @xmath420 , and so on .",
    "for any distinct @xmath78 and @xmath77 , consider a permutation @xmath417 in which @xmath416 .",
    "if some @xmath421 contained both @xmath78 and @xmath77 , then it would have to also contain the labels @xmath422 but this is impossible since each @xmath421 has size less than @xmath165 .",
    "thus by lemma  [ lem : deleting_edges ] , @xmath423 for constant @xmath256 , one can easily observe that @xmath424{n}$ ] as @xmath259 .",
    "for an explicit bound ( using @xmath408 ) , we can show @xmath425{n } + 1 $ ] , in the following manner : @xmath426{n+1 } \\right\\rfloor > \\sqrt[k]{n+1 } \\left ( 1 - \\frac{1}{\\sqrt[k]{n+1 } } \\right ) \\\\",
    "& > \\sqrt[k]{n } \\left ( 1 - \\frac{1}{3k } \\right ) \\\\",
    "\\implies b^2 - 2 & > \\sqrt[k]{n^2 } \\left ( \\left ( 1 - \\frac{1}{3k } \\right)^2 - \\frac{2}{9k^2 } \\right ) \\\\ & > \\sqrt[k]{n^2 } \\left ( 1 - \\frac{1}{k } \\right ) \\\\",
    "\\therefore t & = \\left\\lceil \\frac{2n}{b^{k-3}(b^2 - 2 ) } \\right\\rceil \\\\ & \\leq \\left\\lceil \\frac{2n}{n^{(k-1)/k } \\left ( 1 - \\frac{k}{3k } \\right ) } \\right\\rceil \\\\ & \\leq 3n^{1/k}+1.\\end{aligned}\\ ] ]    if @xmath427 is obtained from @xmath116 by a permutation , @xmath428 , of the labels ( i.e. the leaf labeled @xmath78 in @xmath226 is labelled @xmath197 in @xmath429 for all @xmath241 and all @xmath430 $ ] ) then @xmath431 .",
    "therefore in the above lemma , we could have constructed @xmath116 so that one of the trees has a particular labelling , say @xmath334 . now if we set @xmath127 and apply the unrooted agreement forest lemma ( [ lem : uafl ] ) then @xmath432 for all integers @xmath433 .",
    "this bound is trivial since @xmath434 . ]",
    "this is a suitable lower bound for theorem  [ thm : extreme ] .",
    "[ lem : lb_expect_uaf ] let @xmath14 , let @xmath3 be a positive integer , let @xmath130 , and let @xmath435 be binary trees each with @xmath6 leaves . if @xmath410 is chosen uniformly at random such that each @xmath226 is a labelling of the leaves of @xmath263 , then @xmath436 > n - ( 2k+1)n^{2/(k+1 ) } + 1.\\ ] ]    first set @xmath437 then , using lemma  [ lem : divide_tree_equally ] , divide each @xmath226 into @xmath399 ( possibly empty ) connected parts , so that each part has less than @xmath165 leaves : @xmath438 . for distinct @xmath356 , notice that @xmath439 now let @xmath440 be the set of pairs of distinct labels @xmath441 such that for each @xmath237 , @xmath78 and @xmath77 are in the same part @xmath442 .",
    "explicitly @xmath443 since the labellings are chosen independently , @xmath444 for all @xmath356 . now let @xmath445 . by the linearity of expectation @xmath446 = \\binom{n+1}{2 } { \\mathbb{p } } ( \\ { x , y \\ } \\in z ) <",
    "n^2 \\left ( \\frac{a-1}{n } \\right)^k < n^{2/(k+1)}.\\ ] ] since @xmath447 and @xmath448 \\leq n^{2/(k+1)}$ ] , we can applying lemma  [ lem : deleting_edges ] to get @xmath449       & \\geq n - k(t-1 ) - { \\mathbb{e}}[z ] + 1\\\\       & > n - ( 2k+1)n^{2/(k+1 ) } + 1.\\tag*{\\qedhere }      \\end{aligned}\\ ] ]    setting @xmath127 in lemma [ lem : lb_expect_uaf ] and choosing @xmath57 and @xmath58 uniformly and independantly , ( so that @xmath450 is distributed uniformly ) gives @xmath451 \\geq n-5n^{2/3}+1 $ ] . applying the unrooted agreement forest lemma ( [ lem : uafl ] )",
    "gives @xmath452 \\geq n - 5n^{2/3}.\\ ] ] which is a suitable lower bound for theorem  [ thm : expectation ] ."
  ],
  "abstract_text": [
    "<S> three standard subtree transfer operations for binary trees , used in particular for phylogenetic trees , are : tree bisection and reconnection ( @xmath0 ) , subtree prune and regraft ( @xmath1 ) and rooted subtree prune and regraft ( @xmath2 ) . for a pair of leaf - labelled binary trees with @xmath3 leaves , </S>",
    "<S> the maximum number of such moves required to transform one into the other is @xmath4 , extending a result of ding , grunewald and humphries . </S>",
    "<S> we show that if the pair is chosen uniformly at random , then the expected number of moves required to transfer one into the other is @xmath5 . </S>",
    "<S> these results may be phrased in terms of agreement forests : we also give extensions for more than two binary trees . </S>"
  ]
}