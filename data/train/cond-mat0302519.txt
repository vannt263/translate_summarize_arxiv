{
  "article_text": [
    "a wide range of systems with important applications are governed by a fine interplay between the atomistic processes occurring within a small region of the system and the slow dynamics occurring within the bulk .",
    "a large list of examples arise in complex flows near interfaces ( polymers or colloids near surfaces , wetting , drop formation , melting , crystal growth from a fluid phase , moving interfaces of immiscible fluids or membranes , to name only a few ) .",
    "the computational expense of realistic - size simulations of these problems via standard molecular dynamics ( md ) is prohibitive , and such kind of studies require new algorithms which can retain the benefit of the atomistic description of matter where it is really needed , while treating the bulk of the system by much less costly continuum fluid mechanics methods .",
    "several hybrid algorithms of this sort have been proposed in the recent literature . in general , to couple the particle region p and the continuum region c , such hybrid schemes use an overlapping region comprised of two buffers c@xmath1p and p@xmath0c , which account for the two - way transfer of information : from c to p and _ vice versa _ ( see fig .",
    "1 ) . while the p@xmath0c transfer essentially consists of a coarse - graining procedure , at c@xmath1p one needs to reconstruct the dynamics of a large collection of particles with only the limited prescription from the c region as input .",
    "moreover , in performing this reconstruction , the number of unphysical artifacts added ( as maxwell dmons ) should be minimized far as possible .",
    "this task is very complicated and represents in fact the heart of any hybrid scheme .",
    "hybrid algorithms for fluids are relatively recent .",
    "the elegant method introduced by garcia",
    "_ et al . _",
    "@xcite for rarefied gases couples fluxes arising from a direct simulation monte carlo ( dsmc ) scheme to another region described by computational fluid dynamics ( cfd ) .",
    "the dsmc is set at the finest grid scale of an adaptive mesh refinement hierarchy , while a cfd semi - implicit solver is used at the upper level scales . in passing ,",
    "we note that the scheme may , in principle , be implemented using an ( md - continuum ) liquid description , although in this case the c - solver must be completely explicit to avoid having to change the particle s energy in the iterations of the implicit scheme .    in the case of liquids ,",
    "the state of the art is relatively less developed due to the complications arising from the interparticle forces . a pioneering work by oconnel and thompson @xcite coupled momentum by imposing the local continuum velocity at c@xmath0p via a crude constraint lagrangian dynamics .",
    "hadjiconstantinou and patera @xcite introduced a reservoir region to impose boundary conditions on the p region ( this reservoir being the equivalent of the c@xmath0p domain defined here ) . while in residence in the reservoir , particles were given at each time step , a velocity drawn from a maxwellian distribution with mean and variance consistent with the velocity and temperature of the c - flow . to obtain the boundary condition for the c region the authors used a low order polynomial to smooth the field variables derived from p at the p@xmath0c region .",
    "in order to match the boundary conditions for both the p and c regions , hadjiconstantinou and patera @xcite implemented an iterative scheme ( based on the schwarz alternating method ) that is suitable for steady incompressible flows .",
    "liao and yip @xcite proposed a sophisticated method ( called the thermodynamic field estimator ) to extract continuum fields from the particle data by means of maximum likehood inference .",
    "this idea may be used to ameliorate the p@xmath0c coupling when the flow presents large gradients , albeit at a rather large computational cost . to transfer momentum on the p region liao and",
    "yip @xcite proposed a new maxwell dmon , called reflecting particle method .",
    "a drawback is that the pressure gradient is then an outcome of the simulation , rather than an input .",
    "finally , flekkoy _ et al . _",
    "@xcite used the idea of coupling - through - fluxes and also implemented mass transfer .",
    "however , energy transfer was still not allowed and only steady flows were considered . the main purpose of the present work is to broaden the scope of such hybrid schemes towards a general description allowing mass , momentum and energy coupling in unsteady flows .",
    "a question of central interest is to decide what kind of information needs to be transfered at c@xmath1p and p@xmath0c .",
    "there are essentially two possibilities , to transfer either generalised forces ( fluxes of conserved quantities ) or the local values of the averaged - variables . both kinds of approaches can be found in the published literature . here , in the context of energy transfer ,",
    "we show that under unsteady flows it is not sufficient to impose the local c - quantities at the boundary of p ; instead , it is necessary to couple through fluxes .",
    "another possible benefit of flux - coupling was pointed out by flekkoy _",
    "@xcite who stated that this procedure transcends the problem of working with fluids whose constitutive relations may be only partially or incompletely known .",
    "although we agree that the flux - based coupling is the correct matching procedure , we show nevertheless that if the transport coefficients at c and p are disparate enough , the hybrid scheme fails to couple the time evolution of both domains .",
    "hence , in such cases , the evaluation of transport coefficients ( using standard microscopic techniques , at least for the range of densities and temperatures under study ) is an unavoidable requirement for the correct behaviour of the hybrid scheme .    the rest of the paper proceeds as follows .",
    "the equations governing the continuum and particle regions and the averaging procedures are presented in sec . [ 2 ] .",
    "the core of the scheme , describing the c@xmath0p coupling for momentum , energy and mass fluxes , is presented in sec [ 3 ] .",
    "general requirements on the coarse - graining length and time scales are discussed in section [ req ] .",
    "the unsteady flows under which the scheme has been tested ( decay of longitudinal and transversal waves ) are presented in sec .",
    "[ hyd ] and in sec .",
    "[ 4 ] we discuss the results of these tests as far as the main hydrodynamic and thermodynamic variables are concerned . finally sec .",
    "[ con ] is devoted to conclusions .",
    "the domain decomposition of the hybrid scheme is depicted in fig . 1 .",
    "two regions need to be distinguished : the particle region p , and the continuum region c. region p is composed of an ensemble of particles interacting through prescribed interparticle potentials and evolving in time through newtonian dynamics . in order to illustrate the coupling procedure",
    "a lennard - jones ( lj ) fluid will be considered",
    ". within p a number @xmath2 of particles , located at @xmath3 ( the subscript @xmath4 denoting the @xmath5 particle ) interacts through the lj potential @xmath6 $ ] .",
    "each particle has a mass @xmath7 , velocity @xmath8 and energy @xmath9 ( @xmath10 ) .",
    "their equations of motion , @xmath11 are solved via standard molecular dynamics ( md ) at time steps @xmath12 , where @xmath13 is the characteristic time of the lj potential . throughout the rest of the paper ,",
    "all quantities will be expressed in reduced units of the lj potential : @xmath14s ) , @xmath15 cm ) , @xmath16 , @xmath17 g ) and @xmath18k ) for time , length , energy , mass and temperature , respectively ( the numerical values correspond to argon ) .",
    "on the other hand , within the c region the relevant variables are the macroscopic local densities associated with the conserved quantities , the number density @xmath19 , the energy density @xmath20 and the momentum density @xmath21 ( related to the local mean velocity @xmath22 by @xmath23 ) . in",
    "what follows the spatial coordinates of the macroscopic fields are denoted by capital letters @xmath24 , while the the microscopic coordinates are designated by lower case letters .",
    "the conservation laws for the local densities are @xmath25 where the specific energy @xmath26 , includes the translational energy , the thermal kinetic energy and the potential energy @xmath27 .",
    "the momentum flow contains contributions from convection @xmath28 and the pressure tensor @xmath29 , the latter including the local hydrostatic pressure @xmath30 and the viscous stress tensor , which satisfy a newtonian constitutive relation , as shown by previous previous md descriptions of the lj - fluid @xcite , @xmath31 the energy current includes convection @xmath32 , dissipation @xmath33 and conduction @xmath34 , which can be expressed in terms of the local temperature gradients and the thermal conductivity @xmath35 , through fourier s law @xmath36 . in order to close the above equations it is necessary to know the caloric @xmath37 and thermal equations of state @xmath38 and the constitutive relations for the transport coefficients ( shear and bulk viscosities and thermal conductivity ; @xmath39 , @xmath40 and @xmath35 respectively ) in terms of a set of independent thermodynamic variables , such as @xmath41 and @xmath42 .",
    "the equations of state for a lj - fluid were extracted from johnson _",
    "_ @xcite and the transport coefficients @xmath39 , @xmath35 and @xmath40 from heyes @xcite and borgelt _ et al . _ @xcite .",
    "the variables relevant to the c region are the slower ones . using any standard continuum fluid dynamics solver ( e.g. based on a finite volume method ) the evolution of the c - variables",
    "will be traced at time intervals @xmath43 and evaluated within cells of volume @xmath44 whose size and location is given by the nodes of a certain mesh , @xmath45 , @xmath46 .",
    "it will be assumed that the size of the c@xmath0p and p@xmath0c regions are the same size as those of the cells used in the spatial discretisation of the selected continuum solver , say @xmath47 . in general",
    "both @xmath48 and @xmath49 may depend on the type of solver used for the c - region , or on the characteristic length of the particular phenomena under study , nevertheless , various intrinsic constraints on @xmath48 and @xmath49 will be mentioned in sec.[req ] .",
    "averages are needed in order to transfer information from the faster time and shorter length - scale particle dynamics to the slower and longer coarse - grained description . in order to deal with unsteady , non - equilibrium scenarios , averages need to be local on the slower time scale and in",
    "the coarse - grained spatial coordinates . for any particle variable ,",
    "say @xmath50 , we define the following averages : @xmath51 where the summation in eq .",
    "( [ sum ] ) is made over the @xmath52 particles inside the cell @xmath53 .",
    "the averaging procedure is needed to translate the p and c `` languages '' to and from each domain .",
    "this translation is done within the overlapping region , where the two descriptions of matter coexist ( see fig .",
    "1 ) . in particular , within the p@xmath0c cells the many degrees of freedom arising from the particle dynamics are coarse - grained to provide boundary conditions at the `` upper '' c - level .",
    "as long as the number of degrees of freedom is very much larger at p than at c , this operation is rather straightforward and is based on the microscopic derivation of continuum fluid dynamics @xcite .",
    "we adopt the approach advocated by flekkoy _",
    "@xcite , in making the information transferred from p to c to be the coarse - grained particle - fluxes of conserved quantities .",
    "these are    @xmath54    where @xmath55 is the number of particles inside the p@xmath0c cell and @xmath56 is the surface vector shown in fig",
    "by contrast , within the c@xmath0 p cells , the particle dynamics must be modified to conform to the averaged - dynamics prescribed by the continuum description .",
    "in other words , one needs to construct a sort of `` generalised boundary condition '' for the particle dynamics .",
    "as pointed out in all previous papers on the subject @xcite , this represents the most demanding challenge in that one needs to _ invent _ a way to reconstruct the microscopic dynamics of a large number of particles , based on only a few properties of the local continuum variables .",
    "moreover , to ensure that the effect on the inner p - region is minimised , it is crucial to reduce as much as possible the unphysical artifacts , such as maxwell dmons , that are added to the particle dynamics at c@xmath0p .",
    "the present work is focused on this problem , which lies at the heart of any hybrid scheme .",
    "this part of the hybrid scheme can be alternatively stated as the imposition of generalised ( mass , momentum and energy ) boundary conditions on an md simulation box . to deal with this task",
    "we have coupled the particle region to a collection of flows ( with explicit analytical solution ) , which involve the whole set of conserved quantities exchanged ( mass , momentum and energy ) . in this sense , in the present work",
    "our c - solver is not numerical but rather analytical . in particular",
    ", we use the initial ( non - equilibrium ) state imposed at p to calculate the time - dependent analytical solution at c. this c - flow is then imposed on the p region during the rest of the simulation , meaning that ( appart from the initial state ) the hybrid coupling used in the tests presented here works in one direction only ( from c to p ) .",
    "following flekkoy _",
    "@xcite , at c@xmath0 p we shall communicate fluxes of conserved quantities .",
    "these fluxes correspond to mass , momentum and energy transfers through the outer interface of the c@xmath0 p cell ( the w - surface in fig .",
    "1 ) . flekkoy _",
    "@xcite obtained these fluxes from the values of the continuum variables at the centre of the control cell , @xmath57 , instead of at the exact position of the c@xmath0p interface , @xmath58 .",
    "we have found that it is essential to take into account this apparently unimportant technicality when dealing with unsteady scenarios .",
    "let us consider a general conservation equation , with @xmath59 where @xmath60 is the flux of @xmath27 and the source term vanishes , @xmath61 , as in eqs .",
    "( [ mass])-([ener ] ) . integrating over the control cell c@xmath0p , @xmath62 for illustration we shall restrict analysis to the one - dimensional ( 1d )",
    "situation depicted in fig .",
    "1 . in this case one obtains , @xmath63 where the subscripts @xmath64 ( east ) and @xmath65 ( west ) denote that the variables are measured at @xmath66 and @xmath58 respectively .",
    "the surface vectors , @xmath67 and @xmath68 are shown in fig . 1 , and in eq .",
    "( [ int.vol ] ) use has been made of @xmath69 .",
    "the r.h.s . of eq .",
    "( [ int.vol ] ) is the flux current of @xmath27 through the interface @xmath65 of the control cell , which is precisely the ( generalised ) force we want to introduce on the particles at the c@xmath0p buffer .",
    "we note that only under steady flows does @xmath70 ( to see this , integrate eq .",
    "( [ cons ] ) from @xmath57 to @xmath58 ) : hence only in this case does the evaluation of the fluxes at @xmath71 using the continuum variables at @xmath72 lead to the same converged steady state as if the variables at @xmath71 were used ( although the transients may of course differ ) .",
    "it is possible to provide an estimate of the global error arising from evaluating the flux at a position @xmath72 shifted @xmath73 with respect @xmath71 , over a certain time interval @xmath74 . in the case of the momentum equation",
    "the deviation of the stress contribution to the momentum flux @xmath75 at any instant would be of order @xmath76 , with @xmath77 is the distance to the c@xmath0p interface ( @xmath78 in fig .",
    "1 ) . assuming that the mean velocity field can be expressed as @xmath79 ( @xmath80 being the dominant wavenumber ) and using the newtonian constitutive relation for the viscous tensor in eq .",
    "( [ tau ] ) , one obtains @xmath81 , where @xmath82 is the longitudinal viscosity . as a particular example we consider a longitudinal wave and evaluate the error along a cycle , @xmath83 ( where @xmath84 is the sound velocity ) . as a crude estimate , the accumulated error of the cell - averaged momentum",
    "@xmath85 is of order @xmath86 ; using @xmath87 , @xmath88 and @xmath89 , one obtains @xmath90 , for the typical wavenumbers considered here @xmath91 .",
    "simulations carried out with the momentum flux evaluated at @xmath72 yield relative errors of the averaged velocity at c@xmath0p of the same order of magnitude as this estimate ( see sec [ momt ] and fig .",
    "we observe that most computational fluid dynamics ( cfd ) codes provide the continuum variables at the centre of the control cells ( i.e. , at @xmath72 ) , so that in order to evaluate the fluxes pertaining to the c@xmath0p exchange it would first be necessary to make use of simple interpolation techniques .",
    "the fluxes arising from the continuum equations ( on the r.h.s . of eqs .",
    "( [ flux.mass]-[flux.energ ] ) ) are imposed on the particle ensemble at the c@xmath0p cells through expressions involving atomistic variables ( those on the r.h.s . of ( [ flux.mass]-[flux.energ ] ) ) .",
    "@xmath92    where henceforth , @xmath93 indicates the vector of the outermost interface of the c@xmath0p cell , pointing towards c. the nomenclature used here follows that of flekkoy _ et al .",
    "_ @xcite : @xmath94 indicates the number of particles inserted ( @xmath95 ) or removed ( @xmath96 ) from c@xmath0p per unit of time ; the velocity of the inserted / removed particles is @xmath97 ; @xmath98 is the external force applied to each particle @xmath4 within the c@xmath0p cell .",
    "the total external force is @xmath99 , where the summation is over the @xmath100 particles inside c@xmath0p .",
    "finally , @xmath101 indicates the energy of the inserted / removed particles and @xmath102 refers to an externally imposed heat current .    as mentioned by flekkoy _",
    "@xcite , insertion of eq .",
    "( [ flux.mass ] ) into eq.([flux.mom ] ) shows that the rates of change of momentum due to convection and local stresses are correctly introduced if @xmath103 and @xmath104 , respectively .",
    "note that @xmath105 is the hydrostatic pressure force ( pointing inwards the c@xmath0p cell ) , while the viscous contribution @xmath106 depends on the local velocity gradient .",
    "the balance of the energy flux requires some extra conditions . in eq .",
    "( [ flux.energ ] ) the convection , dissipation and conduction of energy are balanced if @xmath107 , @xmath108 and @xmath109 respectively .",
    "let us now consider in more detail how the scheme deals with momentum , energy and mass transfer from c to p.      the condition @xmath103 ensures the balance of momentum convection .",
    "if the mass flux points towards the p region ( @xmath110 ) , this condition is fulfilled by choosing the velocity of the inserted particles from a maxwellian distribution according to the local temperature at the c@xmath0p cell , @xmath111 . concerning particle removal @xmath112",
    ", we note that if the average velocity at the c@xmath0p cell is equal to the continuum velocity @xmath113 , then the average velocity of the subset of extracted particles would be precisely @xmath114 .",
    "hence the condition of velocity continuity at c@xmath0p is needed to ensure the correct balance of momentum convection .",
    "the change of momentum due to local stresses establishes the overall external force exerted on the particle region .",
    "therefore one needs to determine how the overall external force is distributed on each individual particle .",
    "@xcite distributed the force according to a certain function @xmath115 satisfying @xmath116 , @xmath117 .",
    "normalisation leads to @xmath118 where @xmath119 runs perpendicular to the c@xmath0p interface and the applied force is made constant along each @xmath49 .",
    "as @xmath115 tends to infinity as @xmath120 , the applied force diverges as one approaches the c@xmath0p interface ; hence the density nearby @xmath58 is very small or zero .",
    "the function @xmath115 is thus endowed with a two - fold purpose : it ensures a limiting extension to p ( as the hydrostatic pressure force always points towards the p region , particles will never cross the c@xmath0p interface outwards ) while also guaranteeing the existence of a small region where particles can be inserted with very low risk of overlapping .    despite the benefits of the @xmath115 function for distributing the externally imposed momentum",
    ", we decided to use @xmath121 for all @xmath119 inside the c@xmath0p cell .",
    "the reasons for this choice will become clear when explaining the energy exchange , below .",
    "the first implication of @xmath121 is that the external force is equally distributed among all the particles within the c@xmath0p cell . in other words ,",
    "@xmath98 no longer depends on the particle label @xmath122    the second implication of @xmath121 is that the particle density profile near the c@xmath0p interface no longer vanishes , so one needs an efficient way to resolve the problem of overlap on the insertion of new particles .",
    "this task is carried out by the usher algorithm , as explained below . finally in order to ensure a finite extent of the particle region , if a particle ( @xmath4 ) crosses outwards the c@xmath0p interface ( in fig .",
    "1 , @xmath123 , with @xmath124 ) with velocity @xmath125 it is substituted by another one ( @xmath126 ) with @xmath127 , @xmath128 and with @xmath129 . in this way , the overall momentum is strictly conserved before and after the particle exchange .",
    "the balance of advected energy requires that @xmath130 . decomposing the particle energy into the kinetic and potential parts @xmath131 ^ 2/2 + \\psi^{\\prime}$ ]",
    ", one sees that , since the new particles are drawn from a maxwell distribution , @xmath132 ^ 2/2\\right>=u^2/2 + 3t/2 $ ] .",
    "by contrast , the balance of potential energy @xmath133 is much less straightforward to implement .",
    "this condition is fulfilled by the usher algorithm , described below .",
    "one needs to satisfy the following balance of heat dissipation : @xmath134 this condition does not generally hold if the external force is distributed according to an arbitrary @xmath115 . indeed it is not even clear that a function @xmath115 exists satisfying @xmath135 and enabling the heat dissipation balance in eq .",
    "( [ dis ] ) . in any case ,",
    "such a function @xmath136 would depend on the particle s velocity distribution and then the problem of finding @xmath136 would become a formidable task at each time step .",
    "the advantage of using @xmath121 now becomes clear .",
    "as long as @xmath98 does not depend on the particle label , one can greatly simplify the l.h.s . of eq .",
    "( [ dis ] ) equation to obtain , @xmath137 the last equality follows from construction of the overall force @xmath138 and from the continuity of velocity @xmath139 .",
    "the condition @xmath140 requires the establishment of a heat current along the c@xmath0p cell representing the conduction of energy . this may be implemented by various means ; for instance , following the idea of evans and coworkers @xcite one may include an extra force which pulls the `` hotter '' particles towards the direction of the heat flux and conserves the overall momentum .",
    "alternatively , one may try to impose a chapman - enskog velocity distribution with the desired heat flux , at some region inside the c@xmath0p buffer . in this work we have made use of the phenomenological fourier s law , @xmath141 .",
    "a temperature gradient is imposed along each c@xmath0p cell by using a set of nos - hoover thermostats ( nht ) placed along the direction of the heat flux .",
    "the outer and inner thermostats are located a distance @xmath142 apart , and the temperature difference between both set to @xmath143 .",
    "typically , at each c@xmath0p cell we have used a set of two or three nht s along a distance of @xmath144 or @xmath145 .",
    "the values of the @xmath146-parameter appearing in the nht formulation @xcite were chosen small enough to minimise unphysical dynamics , i.e. , we have chosen @xmath147 .",
    "the main benefit of using the nos - hoover formulation is the small distortion these thermostats introduce to the particle dynamics compared with other ways of implementing thermostatting @xcite",
    ".      one important condition on the particle insertion , inherited from the balance of potential energy , is @xmath133 ( see sec . [ enerbal ] ) . to deal with this task",
    ", our strategy has been to place the new particles in positions where @xmath148 .",
    "as @xmath27 is , roughly speaking , the energy needed to insert a new particle , we shall insert particles with energies close to the local chemical potential . in any case , this implies that the insertions need to be made in very precise positions which depend on the configuration of the rest of the particles . to this end",
    "we have developed an algorithm ( usher ) that guides each new inserted particle to a position where the potential energy is equal to @xmath27 ( up to a pre - specified threshold ) .",
    "a brief explanation is given below ( see delgado - buscalioni and coveney @xcite for further details ) . we first note that while the usher algorithm guides a new particle to a correct location , the rest of the particles remain frozen in position .",
    "usher essentially performs the following steps :    1 .",
    "place the new particle ( @xmath149 ) at an initial position inside c@xmath0p , @xmath150 .",
    "2 .   evaluate @xmath151 and @xmath152 typically one can use @xmath153 .",
    "3 .   move the new particle according to the update rule @xmath154 where @xmath155 , with @xmath156 in reduced units 4 .",
    "evaluate the relative difference between the specific internal energy of the new particle , @xmath157 , and that prescribed by the continuum , @xmath27 : @xmath158 5 .",
    "the particle is correctly inserted if @xmath159 is small enough ( typically @xmath160 ) .",
    "let us show how the usher algorithm easily overcomes the problem of possible initial overlap with pre - existing particles .",
    "an overlap leads to very large values of the interparticle force , @xmath161 , so in this case @xmath162 and @xmath163 .",
    "but by construction , during the interval @xmath164 the new particle moves a distance of the order of the particle size @xmath165 in the direction of minimum energy , just enough to avoid any initial overlap . then , as the particle steadily moves towards a local minimum of energy , @xmath166 decreases , and @xmath164 increases until it becomes larger than @xmath167 .",
    "then , @xmath168 is fixed .",
    "for liquid densities varying between @xmath169 , the usher algorithm typically needs 15 - 90 iterations ( single - force evaluations ) to correctly place a new particle @xcite . by introducing the particles with @xmath170",
    ", we found that , upon averaging over @xmath49 , the condition @xmath133 holds within about @xmath171 ( even using values of @xmath159 as large as @xmath172 ) .",
    "until now we have not mentioned any limitation on the sizes of the coarse mesh and time step @xmath48 and @xmath173 .",
    "comments on this topic are very scarce in the previous literature on hybrid methods for fluids . moreover , since the local averages are made using these spatial and temporal windows , it is also appropriate to formulate any condition on @xmath48 and @xmath49 before presenting the results of the tests carried out for different flows .",
    "continuum fluid dynamics rest on the local equilibrium assumption .",
    "this means that , in order to define a local thermodynamic and hydrodynamic state characterising the coarse - grained variables at the c@xmath0p and p@xmath0c cells , the size of these cells needs to be greater than the mean free path @xmath174 extracted from the particle dynamics . moreover the local equilibrium within each cell should be attained on times scales smaller than @xmath49",
    "this means that @xmath49 has to be larger than the collision time @xmath175 . in summary , @xmath176 and @xmath177 . in the case of a lj - fluid it is possible to use the hard - sphere approximation to make an order - of - magnitude estimate , @xmath178 and @xmath179 .",
    "these conditions become less restrictive at larger densities ; as an example , for @xmath180 , @xmath181 and a typical md time - step @xmath182 , local equilibrium would require @xmath183 integration steps .      conditions on @xmath48 and @xmath49 are firstly imposed by the smallest characteristic length and time scales involved in the process under investigation ( say @xmath184 and @xmath185 respectively ) . practically , to correctly recover the smallest spatio - temporal flow pattern",
    "one needs at least 8 points per period , so @xmath186 and @xmath187 .",
    "the numerical stability of the c - solver algorithm may also impose limitations . as mentioned in sec .",
    "i , algorithms with explicit time discretisation are better suited for the c - solver of a hybrid scheme .",
    "a necessary condition for their numerical stability is @xmath188 , where c is the courant number and @xmath189 the maximum characteristic flow velocity .",
    "the value of @xmath189 depends on the physical process one is dealing with but , to provide numbers in the present discussion , let us assume that we are dealing with low or moderate reynolds numbers .",
    "then , if the process is a diffusive one , @xmath190 ; alternatively , if sound waves are relevant within the flow , @xmath191 . in summary , the computational window for @xmath49 should be , @xmath192 . using the maximum grid - spacing allowed , @xmath193 , one obtains the computational windows for @xmath194 shown in fig . 2 _ versus _",
    "@xmath41 , for @xmath195 , @xmath196 and @xmath197 .",
    "as expected , a sound wave requires smaller time steps than a diffusive process . for large enough @xmath198",
    ", the temporal and spatial computational window may be highly localised ; e.g. for @xmath181 one should use @xmath199 if waves with wavelength smaller than @xmath200 need to be captured by the coarse - grained description . as the density decreases these conditions become much more restrictive , until the acoustic time finally becomes smaller than the collision time ( see fig .",
    "2 ) . also , in rarefied gases , if @xmath201 , the mean free path becomes larger than the wavelength , but here we shall not be concerned with situations where the navier - stokes equations are not appropriate ( see garcia _",
    "_ for further discussion @xcite ) .",
    "as already mentioned our hybrid scheme has been tested under stationary and unsteady flows .",
    "typical stationary nonequilibrium states were considered , such as heat conduction profiles @xcite and couette profiles @xcite .",
    "the microscopic reconstruction of these flows has been well studied in the literature that nothing new may added here . in passing ,",
    "we note the transient times to achieve the steady state from the rest solution were found to be in agreement with the diffusive times @xmath202 and @xmath203 .",
    "the rest of the discussion will be focused on our choice of unsteady scenarios , which are described by the decay of transversal and longitudinal waves .",
    "these flows are now briefly presented , using standard hydrodynamics .",
    "consider a fluid at equilibrium characterised by homogeneous mass density , @xmath204 , specific energy @xmath205 and a vanishing mean velocity @xmath206 .",
    "our procedure is to perturb this equilibrium state with different hydrodynamic fields @xmath207 ( periodic in the @xmath119 direction , i.e. @xmath208 ) and then make use of the c@xmath0p coupling scheme described in sec . [ 3 ] to verify that , within the particle region , the subsequent evolution towards equilibrium is carried out in a hydrodynamically consistent way .",
    "if use is to be made of the linear hydrodynamic theory , the externally induced perturbations should be small enough to guarantee that the relaxation process is always governed by the linearised mass , momentum and energy equations ( [ mass])-([ener ] ) @xcite .",
    "we defer further discussion of this point to sec . [ 4 ] below .    as is customary , to solve the linearised set of equations a laplace - fourier transform ( lft ) is first performed @xcite .",
    "the lft of any perturbative variable , say @xmath209 , will be denoted as @xmath210 the lft of the linearised equation ( [ mass])-([ener ] ) leads to the following algebraic system for @xmath211 @xcite , @xmath212 where the hydrodynamic matrix is , @xmath213 we note that instead of using @xmath214 , the energy equation is expressed in terms of temperature fluctuations .",
    "also , for clarity it is better to write the solution @xmath215 in terms of the @xmath216 fourier - transformed perturbative heat density @xmath217 and pressure @xmath218 .",
    "these quantities are related to @xmath219 and @xmath220 through the relations @xmath221 here @xmath222 and @xmath223 are the specific heat at constant pressure and volume , respectively ; @xmath224 , is the adiabatic coefficient ; @xmath225 is the thermal diffusivity ; @xmath226 the thermal expansion coefficient ; and the kinematic longitudinal viscosity , @xmath227 is related to the sound attenuation coefficient , @xmath228 , through @xmath229 .",
    "finally @xmath230 and the adiabatic speed of sound is @xmath231 .",
    "provided that , in the hydrodynamic limit , the wavelengths of the perturbations are much larger than the mean interparticle distance , it is sufficient to obtain the solution of eq .",
    "( [ pertu.eq ] ) up to @xmath232 @xcite .",
    "putting @xmath233 into eqs .",
    "( [ pertu.eq ] ) and ( [ linearlf ] ) , leads , after some algebra , to the following identities @xmath234 and , using eqs .",
    "( [ q(r , t ) ] ) and ( [ p(r , t ) ] ) , @xmath235 where the following propagators have been introduced , @xmath236    the shear or transverse modes correspond to momentum perturbations along either @xmath237 and/or @xmath238 axis ( i.e. perpendicular to the wavevector @xmath239 ) ; from eqs .",
    "( [ lfjy ] ) and ( [ lfjz ] ) it is clear that they are completely decoupled",
    ". the remaining hydrodynamic variables @xmath240 are coupled and conform to three longitudinal modes which can be divided into two subgroups : two sound modes ( involving longitudinal momentum and pressure at constant entropy ) and one heat mode ( involving heat diffusion ) .",
    "the fact that the heat density is an independent mode is evident from eq .",
    "( [ lfq ] ) , where it is seen that it relaxes diffusively @xmath241 .",
    "we note that @xmath242 is essentially the fluctuation of the entropy density @xmath243 @xcite . from eqs .",
    "( [ lfjx ] ) and ( [ lfp ] ) it is easily shown that the two sound modes ( @xmath244 ) decay like @xmath245 .",
    "the coupling scheme was implemented and tested in the set - up shown in fig .",
    "3 . the system is periodic along @xmath237 and @xmath238 directions and the gradients of the continuum variables are set along the @xmath119 direction .",
    "the particle region occupies a region of size @xmath246 around @xmath247 and of size @xmath248 along the periodic directions .",
    "the p region is divided into control cells of size @xmath48 where in local averages are taken .",
    "the centres of the two c@xmath0p slabs ( the outermost cells ) are situated at @xmath249 .",
    "the deviation from the local equilibrium assumption was monitored in terms of the relative difference of the cell - averaged pressure and energy with respect the values given by the equation of state of johnson _ et al .",
    "_ ref @xcite . around a distance @xmath250",
    "away from the c@xmath0p interface the typical maximum deviations were only about @xmath251 .",
    "the initial perturbative flow was prepared by first letting the p region relax until a vanishing and homogeneous mean flow was obtained . then , during a small time interval ( @xmath252 ) , the particle velocities were periodically changed according to a maxwellian distribution with the desired velocity profile and local cell temperature .",
    "the resulting initial state was then analysed to extract the fourier components of the whole set of flow variables ( @xmath253 , @xmath41 , @xmath42 , @xmath254 , p ) . for the sake of consistency these were extracted by fourier transforms of the cell - averaged variables",
    "@xmath255 where @xmath256 ( @xmath257 and ; @xmath258 for @xmath259 , @xmath260 otherwise . in any case",
    ", it was checked that the fourier transform of the microscopic variables @xmath261 yields essentially the same output as eqs .",
    "( [ fourier ] ) and ( [ fourier.s ] ) .",
    "the initial fourier transforms calculated from eqs .",
    "( [ fourier ] ) were injected into eqs .",
    "( [ lft])-([lfp ] ) to obtain the time - evolution of the continuum variables .",
    "these , in turn , were used to calculate the fluxes imposed on the c@xmath0p cells over time .",
    "the transport coefficients used were those reported in the literature @xcite . as an interesting check , it was found that the coupling scheme failed significantly if the transport coefficients used in the c - region differed by more than about @xmath262 from those of the lj fluid . in particular , the oscillation frequency of the averaged particle velocity differed with respect to that of c , while correlations decayed at a faster rate than those of the c - flow .",
    "therefore , in cases where the constitutive relations are not known , this result means that it is first necessary to measure the transport coefficients from the particle dynamics ( using any standard molecular technique ) , before applying the hybrid scheme , particularly if unsteady flows are to be studied .",
    "the wavelengths of the initial perturbations were chosen to be much larger than the mean free path , i.e. @xmath263 , in order to work within the hydrodynamic regime .",
    "in other words , the dependence of the transport coefficients on the wavenumber was negligible @xcite .",
    "the amplitudes of the initial perturbation were chosen small enough to ensure that the subsequent relaxation process could be described by linear theory .",
    "in particular , if @xmath264 is the maximum fourier amplitude of the velocity , the typical values of the reynolds number at @xmath216 [ re@xmath265 were re@xmath266 . as @xmath267 decays exponentially , convection was present only in the first stages of the relaxing flow , but it was not strong enough to produce significant deviations from the linear theory ( non - linear effects become dominant for re@xmath268 @xcite ) .",
    "the maximum mach number was less than @xmath269 , and density fluctuations were around @xmath270 .    in another test",
    "the hybrid scheme was applied to a fluid in mechanical ( @xmath271 ) and thermodynamical equilibrium ( @xmath181 , @xmath272 , @xmath273 , @xmath274 ) during a longer simulation ( 50@xmath275 ) to check for any possible spurious drift in the overall momentum and energy ( note that eq .",
    "( [ flux.mass ] ) ensures the mass conservation by construction ) . during this calculation ,",
    "the total momentum inside the p region was conserved up to @xmath276 and the total energy fluctuated @xmath277 around its equilibrium value .",
    "the size of these fluctuations is consistent with the system size ( which contained @xmath278 particles and a specific heat of @xmath279 ) . note that the total energy of the system can not be conserved because a part the system is connected to a thermostat and it also receives mechanical energy from c.      in order to test the transfer of momentum flux along the direction perpendicular to the c@xmath0p interface , planar shear waves along @xmath119 were excited in a lj - fluid with @xmath181 , @xmath197 and @xmath280 ( the error bar comes from ref.@xcite ) .",
    "these waves were created by imposing sinusoidal @xmath237-velocity profiles @xmath281 .",
    "figure 4 shows results for perturbations with @xmath282 in a system with @xmath283 , @xmath284 and @xmath285 cells ( @xmath286 ) .",
    "the filled circles in figure 4a correspond to the main fourier component of the velocity @xmath287 for a calculation using wavenumber @xmath288 .",
    "the relaxation process is indeed exponential , until the noise - to - signal ratio becomes large enough ( around @xmath289 ) and , the observed decay rate @xmath290 agrees perfectly with the theoretical value @xmath291 . to explicitly appreciate the effect of the hybrid coupling we show ( open circles in fig .",
    "4a ) the outcome of a calculation in which the unsteady shear stress contribution to the external force @xmath292 was set to zero , leaving just the contribution of the equilibrium hydrostatic pressure .",
    "as expected , if less momentum flux is provided towards p , the decay rate is appreciably slower ( @xmath293 ) than the hydrodynamic one ( @xmath294 ) .",
    "figure 4b shows the autocorrelation function ( acf ) of @xmath295 for another perturbation with an slightly different wavenumber , @xmath296 . the good agreement with the theoretical decay",
    "[ @xmath297 , in dashed line ] shows that the scheme is able to deal with small variations in the perturbation shape .",
    "longitudinal waves transport mass , momentum and both mechanical and thermal energy ; they are therefore perfectly suited for an overall test of the hybrid scheme behaviour . in our",
    "set - up the wavevector of these waves was perpendicular to the c@xmath0p interface and they were generated by imposing mean velocities along the @xmath119 direction as either pure cosinusoidal , sinusoidal profiles , or combinations of both profiles . as explained before , the particle velocities were extracted from maxwell - boltzmann distributions at the local mean velocities and at a constant temperature .",
    "the mean velocity profile induces pressure , density and energy fluctuations with a periodic pattern in the @xmath119 direction .",
    "the temporal behaviour of the main flow variables is now described .",
    "one of the main problems involved in the hybrid mass transfer at c@xmath0p is that although the continuum flux is a floating point number , one can only possibly exchange an integer number of particles . in order to adhere closely as possible to the prescribed continuum mass flux ,",
    "the following procedure is followed during each interval @xmath298 , @xmath299 , @xmath300 .",
    "first one evaluates the quantity @xmath301 this floating point number , which represents the number of particles that should cross the c@xmath0p interface along @xmath298 , is converted into an integer @xmath302 by the following construction : @xmath303 + \\delta{\\xi}(t - t_k ) \\\\ & & \\delta{\\xi}(t - t_k ) = \\mathrm{int}\\left[\\int_{t_k}^{t-\\delta t_p } ( \\xi(t^{\\prime } ) -\\delta n(t^{\\prime}))\\,dt^{\\prime}\\right]\\end{aligned}\\ ] ] where @xmath304 is such that @xmath305 and @xmath306 . the deviation @xmath307 assimilates the errors made through successive rounding off ( @xmath308 $ ] ) .",
    "when @xmath309 becomes larger than one ( at @xmath310 ) a particle is added to ( or extracted from ) @xmath311 and the corrector @xmath312 is then reset to zero . to minimise the effect on the remaining particles over each interval @xmath49 ,",
    "the particle crossings are regularly separated in time , at a rate as close as possible to @xmath313 . as illustrated in fig .",
    "5 , this kind of procedure enables us to follow rather closely the desired mass flux .",
    "figures 7 , 8 and 9 show the time dependence of the fourier components of the main hydrodynamic and thermodynamic variables .",
    "dashed lines correspond to the theoretical trends obtained via the inverse fourier transform of eqs .",
    "( [ lft])-([lfp ] ) .    for the reasons explained in sec [ uns ]",
    ", it is particularly important to ascertain that the averaged velocity at c@xmath0p correctly follows the desired continuum flow velocity .",
    "figure 6 shows the instantaneous @xmath314 and time averaged velocity @xmath315 at both c@xmath0p cells .",
    "we obtained very good agreement , the deviation of @xmath316 with respect the continuum value being less than about @xmath317 along most part of the damped oscillation ( see fig .",
    "the importance of evaluating the continuum fluxes at precisely the c@xmath0p interface ( @xmath71 in fig .",
    "1 ) , is illustrated in fig .",
    "6 by comparison with the outcome of a calculation in which the fluxes are evaluated at @xmath318 . for this calculation",
    ", the deviation with respect to the continuum prescription is clear and its magnitude agrees with the estimate made in sec .",
    "[ uns ] , @xmath319 .",
    "figure 7a shows the time evolution of the fourier amplitudes of the velocity in one of the calculations ( a pure cosinusoidal perturbation with @xmath320 ) .",
    "the overall velocity @xmath321 remains close to zero , confirming that the method conserves the initial total momentum .",
    "the @xmath322 component ( initially set to zero ) has been also included to display the level of noise . the autocorrelation function ( acf ) of @xmath323",
    "is shown in fig .",
    "7b for two runs with different initial profiles ( for more details see the caption of fig . 7 ) .",
    "these data were fitted to the hydrodynamic expression arising from eq .",
    "( [ lfjx ] ) and in fig . 7",
    "these fits are shown with dashed lines .",
    "the best fit to the velocity was obtained with @xmath324 and @xmath325 , while for the acf it yielded @xmath326 and @xmath327 .",
    "these values coincide , within the error bars , with those imposed by the c - flow ( obtained upon insertion of the transport coefficients reported in the literature @xcite ) @xmath328 and @xmath329 , respectively .",
    "we start by observing that , unlike longitudinal momentum and pressure , the relaxation of density , temperature and energy perturbations includes not only an acoustic part , but also an entropic contribution proportional to @xmath330 [ see eqs .",
    "( [ lft])-([enu ] ) ] .",
    "however , as the initial perturbation considered was a mechanical one ( @xmath331 ) , the entropic contribution is rather small .",
    "this can be seen in the theoretical expressions written in fig . 6 : the amplitude at @xmath216 of the entropic part of any heat - related variable is nearly six times smaller than its mechanical counterpart .",
    "this observation led us to a more careful study of the effect of heat conduction .",
    "as explained in sec [ cond ] , heat currents through each c@xmath0p cell were created by imposing several ( typically two ) nos - hoover thermostats ( nht s ) placed close to the c@xmath0p interface over a distance of @xmath145 .",
    "we found it very informative to study the effect of the number @xmath332 of nht s per c@xmath0p cell ( notation : @xmath332-nht@xmath333 ) on the collective behaviour of the system . in some calculations ,",
    "this number was reduced to merely 1-nht@xmath333 , in such a way that only the local temperature prescribed by the continuum was imposed ( and not the heat flux ) .",
    "the results of this comparison may be seen in figs . 8 and 9 .",
    "calculations using 1-nht@xmath333 yielded essentially the same evolution of the velocity and pressure as those with a larger number of nht s , although the pressure for the 1-nht@xmath333 case showed a slight phase - lag , see fig .",
    "this is not surprising as @xmath253 and p are governed by acoustic terms and are independent of heat transfers . using 1-nht@xmath333 ,",
    "deviations on @xmath219 , @xmath214 and @xmath220 with respect to the hydrodynamic trend are indeed appreciable , while results with 2-nht@xmath333 adhere closely to the analytical curves ( see fig .",
    "8) . in any case , the calculation of the entropy production is the best way to highlight the completely different qualitative behaviour of 1-nht@xmath333 with respect to two ( or more ) nht@xmath333 .",
    "the entropy fluctuations , or more precisely the perturbation of heat @xmath242 , was calculated using eq .",
    "( [ q(r , t ) ] ) .",
    "we note that , in order to reproduce the steady diffusive heat decay in eq .",
    "( [ lfrho ] ) , an exact cancellation of the acoustic oscillations coming from @xmath219 and @xmath220 is necessary [ see eqs .",
    "( [ lfrho])and ( [ lft ] ) ] . as stated above , the contribution associated with heat diffusion in eqs .",
    "( [ lfrho ] ) and ( [ lft ] ) is rather small compared to the mechanical one .",
    "this observation indicates that small mechanically - driven fluctuations around the local thermodynamic equilibrium may become large enough to alter the purely exponential heat decay . in other words ,",
    "( [ q(r , t ) ] ) and ( [ lfq ] ) provide a demanding test of the coupling scheme under the present flow .",
    "figure 9 shows the main fourier component of the heat perturbation @xmath217 obtained for 1- and 2-nht@xmath333 .",
    "the dashed lines correspond to the theoretical expectation .",
    "it is evident that the 1-nht@xmath333 case does not obey the second law of thermodynamics at all . on the contrary , a rather good agreement with the theoretical trend",
    "is obtained when using at least 2-nht@xmath333 . in fig .",
    "9 , it is seen that the behaviour measured in the 2-nht@xmath333 case exhibits fluctuations around the theoretical straight line . typically , the largest excursions last around @xmath334 from pure exponential decay .",
    "as previously stated , they may be due to the weakness of the entropy perturbation , but to confirm this statement we plan in the future to study some `` heat - driven '' flows ( such as a heat pulse with initial zero mean velocity ) .",
    "we have presented the core of a hybrid continuum - particle method for moderate - to - large fluids which couples mass , momentum and energy transfers between two regions , c and p , described respectively by continuum fluid dynamics and by discrete particle newtonian dynamics . both domains overlap within a coupling region divided into two sub - cells which account for the two - way exchange : c@xmath0p and p@xmath0c . while the procedure at the p@xmath0c cell is simply to average the particle - based ( mass , momentum and energy ) fluxes in order to supply open boundary conditions to the c domain , the operations at the c@xmath0p cell are much less straightforward as they need to reconstruct a large number of ( particles ) degrees of freedom only from the knowledge of the three fluxes of conserved - quantities arising within c. the present work has been concerned with extending the c@xmath0p coupling to arbitrary rates of mass , momentum and energy transfer . to this end",
    ", the proposed method have been tested under unsteady flows which demand conformance to the whole set of conserved variable densities .",
    "in particular , we have considered the set of relaxing flows arising from hydrodynamics , namely longitudinal and transversal waves .",
    "we have followed the idea proposed by flekkoy _",
    "@xcite , in the sense that the scheme is explicitly based on direct flux exchange between the c and p regions .",
    "in order to deal with unsteady scenarios , we have shown that the fluxes injected into the particle region from the continuum region need to be measured exactly at the c@xmath0p interface and not at the nodes of the continuum lattice .",
    "the implementation of flux exchanges requires the supply of energy currents to the particle system arising from the c domain due to advection , dissipation and conduction . to inject the correct amount of advected energy , the particle - averaged specific energy at the c@xmath0p cell needs to be equal to the continuum value .",
    "this can only be achieved if the new inserted particles are placed at positions where the ( inter - particle ) potential energy equals the c - specified internal energy per unit mass .",
    "this severe condition has been implemented by the usher algorithm , whose purpose is two - fold : to provide the correct mass transfer rate and to ensure the balance of energy advection . in the proposed scheme ,",
    "the balance of energy dissipation arises naturally , provided that the cell - averaged velocity and the injected momentum flux equal their continuum counterparts .",
    "this is made possible by applying the external force according to a flat distribution , instead of a biased one as used by flekkoy _",
    "@xcite but as a result , the new particles have to be inserted within a non - vanishing density environment .",
    "this is sorted out by the usher in a very efficient way .",
    "energy conduction has been implemented by using a set of nos - hoover thermostats adjacent to the c@xmath0p interface , whose temperature and position are determined through the continuum local temperature gradient .",
    "confirmation of the validity of this procedure is obtained from the correct rate of entropy production computed in our simulations of longitudinal waves .",
    "we showed that using only one thermostat per c@xmath0p cell ( i.e. providing only the local value of @xmath42 but not the heat flux ) leads to negative entropy production .",
    "therefore , in the context of energy transfer , this result reinforces the central importance of coupling - through - fluxes proposed by flekkoy _",
    "et al _ @xcite",
    ".    enhancements to the present scheme are under investigation and merit some discussion here .",
    "the number density at c@xmath0p may be controlled by a feedback algorithm which preserves the momentum flux balance .",
    "other kinds of implementations for the energy transport by conduction also deserve to be considered .",
    "finally , we plan to implement the p@xmath0c coupling in conjunction with a finite volume cfd solver in 3d . in order to extend the coupling scheme to higher dimensions",
    "some additional complications will need to be adressed .",
    "first , a mass flux will be assigned to each cell within an array of neighbourings c@xmath0p cells . to adhere to mass continuity",
    ", particles will then have to be inserted within precisely defined finite regions and the insertion algorithm may have to pay an extra computational cost for this restriction of the search domain",
    ". we have checked , however , that the distance travelled by the usher algorithm from the initial trial position to the final insertion site is rather small @xcite ( typically less than 1@xmath165 and less than 0.5@xmath165 on average ) so we do not expect any significant extra cost if the search for insertion sites is done within volumes larger than @xmath335 . in higher dimensions",
    "one may also have to smooth to some extent the variations of the mean mechanical quantities imposed along the c@xmath0p region .",
    "to this end , it may be necessary to interpolate the external force along neighbouring c@xmath0p cells in such a way that the local momentum flux imposed at each c@xmath0p cell is still preserved . in the same way , although the maxwell distribution , used here to choose the velocities of the new particles , proved to be sufficient to ensure momentum continuity for 1d coupling ( i.e , with no neighbouring c@xmath0p cells ) , it may be convenient to use a chapman - enskog distribution in higher dimensions .",
    "this latter distribution enables the average velocity of the inserted particles to conform to the velocity gradient along neighbouring c@xmath0p cells .",
    "we hope to report our findings in these areas in future publications .",
    "we gratefully acknowledge fruitful discussions with e. flekkoy , p. espaol , g. ciccotti and r. winkler and useful comments from b. boghosian , a. ladd and i. paganobarraga .",
    "this work is supported by the european union through a marie curie fellowship ( hpmf - ct-2001 - 01210 ) to rd - b .",
    "d. m. heyes , chem .",
    "lett . , * 153 * ( 4 ) , 319 ( 1988 ) p. borgelt , c. hoheisel and g. stell , phys .",
    "a * 42*(2 ) , 789 ( 1990 ) .",
    "d. j. evans and g. p. morris , _ statistical mechanics of nonequilibrium liquids _",
    "( academic press , london , 1990 ) .        after submission but",
    "prior to publication of this paper we have implemented further improvement in the usher algorithm .",
    "the new usher scheme , to appear in ref.@xcite , reduces the number of iterations to 8 - 30 for densities within the range @xmath169 .    c. trozzi and g. ciccotti , phys .",
    "a , * 29 * , 916 - 925 , ( 1984 ) ; a. tenenbaum , g. ciccotti , and renato gallico , phys .",
    "rev . a * 25 * 2778 ( 1982 ) .",
    "hansen and i.r .",
    "mcdonald , _ theory of simple liquids _",
    "( academic press , london , 1986 ) .",
    "d. j. tritton , _ physical fluid dynamics _ ( oxford science publications , 1988 ) .",
    "p cell , where the c - flow is communicated to p , and a p@xmath0c cell , where particle averaged - fluxes are injected into the c - flow . dashed lines delimit the control cells of the c solver , with area @xmath336 and grid - spacing @xmath48 .",
    "the letters o , w and e denote the centre of a cell and its west and east surfaces , respectively .",
    "the main cell s vectors ( @xmath67 , @xmath68 and @xmath56 ) have been indicated ( see text ) . ]",
    "plotted _ versus _ the number density @xmath41 .",
    "variables are expressed in the lj reduced units ( @xmath165 for length and @xmath337 for time ) . as discussed in sec .",
    "[ reqh ] , @xmath49 has to be greater than the collision time @xmath175 ( the thick solid line ) and smaller than @xmath338 ( indicated with dashed and dash - dotted lines ) .",
    "the typical flow velocity @xmath189 is chosen to be either the sound velocity @xmath191 or the diffusive velocity @xmath339 , according to each case discussed in sec .",
    "the grid - spacing is @xmath340 , where @xmath198 is the largest wavenumber to be captured within the flow . ]",
    "direction , while @xmath237 and @xmath238 are periodic .",
    "the hybrid coupling is applied at the c@xmath0p cells and the heat current is established along the nos - hoover thermostatted regions whose thickness is set between @xmath341 .",
    "we used @xmath342 , @xmath343 and @xmath344 . ]",
    "( in units of @xmath345 , with @xmath346 ) .",
    "results correspond to a transversal wave with wavenumber @xmath288 .",
    "comparison is made between a calculation in which the full expression of the external force @xmath292 was imposed ( filled circles ) and another which did not include the viscous contribution ( open circles ) .",
    "the dashed line is the correct hydrodynamic decay .",
    "( b ) the nondimensional autocorrelation function ( acf ) of @xmath347 for another transversal perturbation with @xmath296 , showing the theoretical decay in the ( partially hidden ) dashed line . in all cases the initial amplitude was @xmath348 and @xmath283 , @xmath284 .",
    "in abscissas , time is nondimensionalized with the lj reduced time unit @xmath337 . ]     at the rightmost c@xmath0p cell , along a simulation of a longitudinal wave with @xmath349 inside a region ( @xmath350 , @xmath351 ) with @xmath352 and @xmath353 .",
    "the initial perturbative velocity profile was @xmath354 .",
    "the dashed line is the continuum prescription @xmath355 ( see text ) .",
    "time has been nondimensionalized with @xmath337 . ]",
    "p cells for the same parameters as in fig .",
    "the dashed line is the continuum prescription ( partially hidden ) . in ( a )",
    "we show the outcome of a calculation in which the momentum flux from the c - region was evaluated at @xmath58 ( see fig .",
    "1 ) ; the instantaneous @xmath356 velocities are shown in lighter dotted lines , while thicker solid lines are the time - averaged velocities @xmath357 . in ( b ) we show the time - averaged velocities for another calculation with the same parameters as in ( a ) , but evaluating the momentum flux at @xmath57 .",
    "all variables are nondimensionalised with the lj potential units ( @xmath165 for length and @xmath346 for time ) . ]",
    "-velocity @xmath358 for the pure cosinusoidal perturbation of fig .",
    "5 . in ( b ) , the nondimensional autocorrelation function ( acf ) of @xmath359 , corresponding to the pure cosinusoidal perturbation ( solid line ) and to another initial perturbation with @xmath360 ( dash - dotted line ) . in ( a ) and ( b )",
    "the dashed line is the theoretical hydrodynamic solution .",
    "the remaining parameters are the same as those in fig .",
    "variables are nondimensionalised with the lj potential units ( @xmath165 for length and @xmath337 for time ) . ]    , ( b ) density @xmath361 ) , ( c ) energy per particle @xmath362 , and ( d ) pressure @xmath363 .",
    "all quantities are nondimensionalised with the lj potential units ( @xmath165 for length and @xmath16 for energy ) .",
    "comparison is made between a simulation with two nos - hoover thermostats per c@xmath0p cell ( 2-nht@xmath333 ) , and another using only one ( 1-nht@xmath333 , dotted line ) . in each figure , the analytical hydrodynamic expressions for the dominant fourier component ( in dashed lines ) are explicitly written .",
    "the initial amplitudes were @xmath364 , @xmath365 , @xmath366 , and @xmath367 . ]",
    "time - averaged along @xmath368 ( and multiplied by @xmath369 ) .",
    "the parameters are the same as those of fig . 5 ( and 8) and heat density is in units of @xmath370 .",
    "the dashed line corresponds to the theoretical decay .",
    "comparison is made between two ( 2-nht@xmath333 ) and one ( 1-nht@xmath333 ) nos - hoover thermostats per c@xmath0p cell .",
    "the latter violates the second law of thermodynamics . ]"
  ],
  "abstract_text": [
    "<S> the aim of hybrid methods in simulations is to communicate regions with disparate time and length scales . here </S>",
    "<S> , a fluid described at the atomistic level within an inner region p is coupled to an outer region c described by continuum fluid dynamics . </S>",
    "<S> the matching of both descriptions of matter is made across an overlapping region and , in general , consists of a two - way coupling scheme ( c@xmath0p and p@xmath0c ) which conveys mass , momentum and energy fluxes . </S>",
    "<S> the contribution of the hybrid scheme hereby presented is two - fold : first it treats unsteady flows and , more importantly , it handles energy exchange between both c and p regions . </S>",
    "<S> the implementation of the c@xmath0p coupling is tested here using steady and unsteady flows with different rates of mass , momentum and energy exchange . </S>",
    "<S> in particular , relaxing flows described by linear hydrodynamics ( transversal and longitudinal waves ) are most enlightening as they comprise the whole set of hydrodynamic modes . applying the hybrid coupling scheme after the onset of an initial perturbation , the cell - averaged fourier components of the flow variables in the p region ( velocity , density , internal energy , temperature and pressure ) evolve in excellent agreement with the hydrodynamic trends . it is also shown that the scheme preserves the correct rate of entropy production . </S>",
    "<S> we discuss some general requirements on the coarse - grained length and time scales arising from both the characteristic microscopic and hydrodynamic scales . </S>"
  ]
}