{
  "article_text": [
    "since its invention almost 20 years ago , scanning force microscopy ( sfm)@xcite has become an extremely powerful tool for a huge variety of nanoscale investigations . with respect to resolution and sensitivity , dynamic scanning force microscopy ( dsfm)@xcite seems to be the most promising technique .",
    "even though ( true ) atomic resolution was first achieved with contact mode in liquid environment@xcite , now atomic resolution studies are generally performed with dsfm working in uhv environment@xcite .",
    "recently even sub - atomic resolution has been reported using dsfm @xcite . in spite of the impressing advances of sfm and dsfm",
    "we believe that the ultimate limit of these techniques is still an open issue . for most applications ,",
    "the temperature at which quantum limits become relevant , @xmath0 , is well below typical temperature ranges used in sfm .",
    "correspondingly , either thermal vibration of the cantilever@xcite , or fundamental limits of the detection technique used@xcite - related to shot noise of the detection particles  - determine the resolution in sfm and dsfm . in most practical applications , the fundamental limit of sfm and dsfm is set by thermal noise .",
    "thermal noise in an sfm set up is the consequence of the equipartition theorem , which relates the mean energy of the cantilever with the thermal energy @xmath1 , @xmath2 where @xmath3 is the ( mean square ) displacement of the cantilever induced by thermal fluctuation , and @xmath4 is its force constant . for high resolution distance measurements stiff cantilevers@xcite",
    "should be used ( @xmath5 , with @xmath6 fluctuation of tip - sample distance ) , while for high resolution force measurements soft cantilevers@xcite are needed ( @xmath7 ) .",
    "although the mean displacement and the mean force fluctuation of the cantilever are important quantities , in many applications they do not directly determine resolution , either because appropriate filtering significantly reduces the measured noise , or because the sfm technique used -as for example dsfm- is not directly limited by the displacement or the force .    in typical dsfm applications",
    "the cantilever is excited at or near its natural frequency and the variation of its resonant properties -oscillation amplitude , resonance frequency or quality factor - are recorded . for imaging applications in liquids or air usually",
    "the oscillation amplitude is used as control parameter that defines constant tip - sample distance  and the frequency shift is measured as secondary channel . in uhv applications dsfm operation is the other way , the frequency shift is the control parameter for tip - sample distance and the oscillation amplitude -dissipation energy- is measured as secondary channel . at the moment dsfm is the most sensitive sfm technique to measure tip - sample interaction , which is detected as a shift of the resonance frequency of the system .",
    "therefore , with regard to the ultimate limits of sfm a key issue -to be discussed in the present work- is to understand in detail the effect of thermal fluctuations on dsfm detection schemes and in particular on frequency detection . at present , the thermal noise density of a frequency measurement is assumed to be@xcite@xmath8 with @xmath9 the quality factor , @xmath10 the resonance frequency , @xmath11 the ( root mean square ! ) oscillation amplitude and @xmath12 the bandwidth of the measurement . note that this relation diverges for small oscillation amplitude and is proportional to the square root of the measurement bandwidth .    in the present work we will revise in detail how thermal fluctuation limits the measurement of frequency shift .",
    "we find that neither for large bandwidth measurements nor for low oscillation amplitude relation [ freqnoiseold ] is correct .",
    "we present a general relation valid for all ranges of amplitude and bandwidth that agrees with relation [ freqnoiseold ] in the low bandwidth and large amplitude range . finally , we present experimental data that unambiguously proves the validity of the general relation obtained in this work .",
    "a thorough discussion of frequency detection and dsfm is out of the scope of the present work ( see the excellent original works@xcite or recent reviews by garcia and perez@xcite and giessibl@xcite ) , nevertheless we think it is important to revise some of its basic principles .",
    "the focus of this revision is rather on a comprehensive physical explanation of the technique than on a profound analysis of the underlying physiscs and statistical mechanics ( see@xcite ) or the electronic details of its implementation(see @xcite ) .",
    "an externally driven sfm cantilever -usually driven by inertial forces- is a textbook example of a harmonic oscillator . in many aspects sfm and modern gravitational wave detectors",
    "are governed by the same basic principles ( see , for example , @xcite ) .",
    "as described in detail in appendix a , the dynamic properties of such a system are described by the quality factor @xmath9 , by a driving amplitude @xmath13 and by its natural angular frequency @xmath14 , with @xmath10 natural frequency and @xmath15 effective mass of the cantilever@xcite . in the steady state regime , the response of the system to a harmonic excitation @xmath16 can be described by a ( complex ) amplitude @xmath17 , or by two components @xmath18 and @xmath19 , the in - phase and out of phase components of the oscillation , corresponding to the real and complex parts of the complex amplitude @xmath17 .",
    "the time response of the system is then @xmath20 where @xmath21 is the phase between the driving force and the response . at its natural frequency",
    "@xmath10 the phase is @xmath22 , the ( complex ) oscillation amplitude is @xmath23 and the in - phase component @xmath24 vanishes .",
    "figure 1 shows a schematic set - up of the main components used in a dsfm detection electronics .",
    "the multiplication stages together with the filters essentially calculate the two components @xmath18 and @xmath19 -relations [ xcomp ] and [ ycomp ] in appendix a- from the measured oscillation of the cantilever @xmath25 .",
    "when enabled , the pi - controller of the dsfm detection electronics adjusts the driving frequency @xmath10 of the excitation signal in order to have @xmath26 . in this way , the system is locked to the natural frequency of the cantilever , tracks this frequency if it varies due to tip - sample interaction and generates an output proportional to the shift of the resonance frequency .",
    "in addition to the main dsfm components figure 1 shows the signals ( in the frequency domain ) along the different points in the dsfm detection path .",
    "a key component of any dsfm detection unit is the voltage ( vco ) or numerically ( nco ) controlled oscillator that generates the excitation and reference signals for the lock - in detection scheme . in most applications this oscillator drives the piezo that induces motion of the cantilever .",
    "the corresponding deflection @xmath25 is analyzed by multiplication with two reference signals in quadrature .",
    "we will first assume the most general case where the frequency @xmath27 of the cantilever motion and that of the reference oscillator are different .",
    "then , multiplication of the deflection signal @xmath28 with the reference signal @xmath29 results in two quadrature signals @xmath30 and @xmath31 with frequency components at @xmath32 , and @xmath33 . as shown in appendix a , @xmath34 and @xmath35 can be obtained from @xmath18 and @xmath19 by multiplication with ( @xmath36 ) , where @xmath37 is a rotation matrix generating a clockwise rotation with frequency @xmath38 , and @xmath39 is a rotation matrix generating a counter - clockwise rotation with frequency @xmath40 . in the frequency domain",
    "the signal @xmath25 is thus splitted and shifted to the sum and to the difference frequency ( see figure 1 ) .",
    "after the multiplication stages the two quadrature signals @xmath34 and @xmath35 are low - pass filtered over a timespan proportional to the time constant @xmath41 of the filter .",
    "the precise time domain signals are determined in appendix a. again , two matrices @xmath42and @xmath43 can be defined ( relations [ mtaudel ] and [ mtausum ] in appendix a ) , corresponding to a clockwise and counter - clockwise rotation with the frequencies @xmath38 and @xmath40 . as compared to the first matrices , these `` filtered '' matrices have delay angles @xmath44 and @xmath45 as well as multiplicative factors @xmath46 and @xmath47 .",
    "usually , in dsfm the signal entering the dsfm detection unit is at the natural frequency @xmath10 , and the reference is at the same frequency @xmath48",
    ". then multiplication of the input signal with the reference signals will result in spectra around @xmath49 and @xmath50 . in this case",
    "@xmath51 , with @xmath52 the identity matrix , and we find , using relations [ mtaudel ] and [ mtausum ] : @xmath53 these signals can be conveniently represented in the frequency domain ( see fig.1 ) , where the first peak at @xmath49 is one - sided ( since no negative frequency exists ) and the second at @xmath50 is two - sided . in typical dsfm applications",
    "the filter is usually set so that @xmath54 , then it blocks the @xmath55 component and passes the signals from dc to @xmath56 . the value of @xmath41 determines the speed and the cleanness  of the signals .",
    "large time constants ( small bandwidth ) results in clean but slow response , while , conversely , small - time constants will result in unclean  signals  in particular with significant @xmath57 component - but with fast response . in our system we have found that time constants of @xmath58 to @xmath59 give the optimum compromise between speed and cleanness .    in the frequency domain , the fourier transforms of the signals @xmath34  and @xmath35 are simply multiplied by the frequency - dependent gain of the filter .",
    "depending on the time  constant of the filter , the total amount of signal may be decreased .",
    "the calculation of the total signal @xmath60 measured around a frequency @xmath61 within a certain bandwidth @xmath12 is performed most conveniently in frequency space:@xmath62 where @xmath63 is the ( spectral ) signal density ( unit : @xmath64 ) and @xmath65 the effective bandwidth of the filter .",
    "the signal densities corresponding to @xmath66 and @xmath67 in the frequency domain are @xmath68 and @xmath69 , respectively , being @xmath70 and @xmath71 the fourier transforms of the quadrature signals @xmath34 and @xmath35 , and @xmath72 the ( complex ) gain of the filter ( see figure 1 ) .",
    "if the @xmath9 factor is low -as in air and in liquids- the signals @xmath73 and @xmath74 can be directly used for dsfm .",
    "in fact , for low q factors and low tip - sample interaction the frequency shift @xmath75 induced by tip - sample interaction is smaller than the width of the resonance ( @xmath76 ) . assuming the validity of the harmonic approximation for the dynamics of the cantilever , the signal @xmath77 is then proportional to the frequency shift , and the signal @xmath67 is proportional to the oscillation amplitude , which in air and liquids is generally used as control parameter . for high @xmath9 factors ,",
    "however , the width of the resonance is smaller than the frequency shifts induced by tip - sample interaction .",
    "moreover , high @xmath9-factors imply that the oscillation amplitude needs a long settling time ( of the order of @xmath78 ) to reach its steady state value@xcite . in this case",
    "it is necessary to track the resonance frequency using phase locked loop techniques@xcite .",
    "this is implemented with a pi - controller that essentially adjusts the frequency of the voltage or numerically controlled oscillator ( vco or nco , see fig .",
    "1 ) so that the @xmath66 component vanishes ; the phase of the oscillation is then kept at @xmath22 and the system is always at resonance .",
    "the output of the pi - controller is then directly proportional to the frequency shift , and this is the signal used in typical dsfm applications .",
    "the pi - controller represents , from an electronic point of view , a filter with a well defined bandwidth and gain .",
    "the time constant of the filters following the multiplication stages and the bandwidth and gain of the pi - controller have to be chosen so that the overall closed loop system is stable@xcite .",
    "since the precise set up of the pi - controller does not modify the essential physics to be discussed here we will assume - to simplify the discussion - an ideal controller that instantaneously transmits variations of @xmath73 to the vco .",
    "the time response of the overall system is then determined by the time constant of the filters after the multiplication stage , which induce a delay of order @xmath41 .",
    "in addition to the coherent  signal @xmath79 induced by the external excitation of the cantilever , in the present context also the incoherent  contribution due to thermal noise , @xmath80 , is important@xcite .",
    "the total motion of the cantilever is thus @xmath81 .",
    "when this motion is transduced into an electrical signal , the position detector will add some instrumental noise @xmath82 , the total signal entering the dsfm detection unit is then @xmath83 , where @xmath84 is a constant that describes the sensitivity ( unit : v / nm ) of the photodetector electronics .",
    "the key question is now : how does this signal pass the dsfm detection unit and what is the final noise of the frequency output ?",
    "the equipartition theorem discussed above ( relation [ equipartition ] ) relates the total thermal displacement to the force constant of the cantilever and the temperature of the system .",
    "however , since the dsfm - detection system performs non - trivial processing of the input signal , the precise spectrum of the thermal noise has to be taken into account in order to calculate the noise of the frequency output and thus the precise limit of dsfm .",
    "a detailed discussion of thermal noise in sfm set - ups is out of the scope of the present work ( see , for example@xcite ) . in a simple picture ,",
    "the noise density of the cantilever motion can be obtained by observing that the equipartition theorem ( equation [ equipartition ] ) relates the mean energy of the cantilever with the thermal energy @xmath1 .",
    "assuming that the effective thermal noise `` force '' driving the cantilever has a constant spectral noise density @xmath85 ( unit : @xmath86 ) , this coupling strength and the mechanical gain @xmath87 of the cantilever ( relation [ gain ] ) define the spectral response of the thermal spectrum @xmath88 of the cantilever : @xmath89 @xmath87 .",
    "the equipartition theorem ( relation [ equipartition ] ) then implies:@xmath90 the second integral gives @xmath91 , therefore the thermal noise density @xmath85 is@xmath92 the thermal noise density defines the coupling of the thermal bath into the sfm system .",
    "it depends on the quality factor and thus on the dissipation properties of the system .",
    "as the quality factor increases , thermal fluctuations induce less thermal force  on the system , that is , coupling of the thermal bath and the tip - sample system becomes weaker .",
    "the thermal fluctuation of the cantilever position measured experimentally with a dsfm detection unit is calculated from the noise density in analogy to relation [ signaltotal]:@xmath93 for low frequencies , that is , for frequencies well below the resonance frequency @xmath94 and the total thermal fluctuation within a bandwidth @xmath12 is @xmath95 . at the resonance frequency @xmath96 and",
    "the total thermal fluctuation is @xmath97 as is well known from the literature .",
    "while the first relation is usually correct for static sfm applications , the second requires the condition that the measurement bandwidth is smaller than the width of the resonance curve : @xmath98 .",
    "we note that in general this assumption may not be correct .",
    "in fact , for typical imaging applications ( scan speed of 1 second / line , 250 points / line ) a minimum bandwidth of 250hz is required , which implies @xmath99 for typical cantilevers ( @xmath100 khz ) in order to fulfill the `` small bandwidth '' approximation . however , in uhv much higher @xmath9 values have been reported@xcite . note that  the relation  @xmath101 overestimates the thermal noise for large bandwidth , in fact for @xmath102 the total thermal noise according to relation [ amplitudenoiseliterature ] would be larger than @xmath103 , which is non - physical since it is in contradiction with the equipartition theorem ( rel .",
    "[ equipartition ] ) .",
    "as discussed below , for a sufficiently large bandwidth the total thermal noise is @xmath104  and is independent of the measuring bandwidth .",
    "a simple illustrative approximation for the spectral noise density of the tip - sample system is @xmath105{l}% \\sqrt{\\frac{q}{q+1}}\\alpha_{th}~\\ \\",
    "\\text{{\\small for } } 0\\leq\\nu<\\nu _ { 0}\\left (   1-\\frac{\\pi}{4q}\\right )   \\ \\text{{\\small and } } \\nu_{0}\\left ( 1+\\frac{\\pi}{4q}\\right )   < \\nu<\\nu_{0}\\left (   1+\\frac{\\pi}{2q}\\right )",
    "\\\\ \\sqrt{\\frac{q}{q+1}}q~\\alpha_{th}~\\ \\ \\text { { \\small for } } \\nu_{0}\\left ( 1-\\frac{\\pi}{4q}\\right )   < \\nu<\\nu_{0}\\left (   1+\\frac{\\pi}{4q}\\right ) \\\\ 0~\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\text { { \\small for } } \\nu\\geq\\nu_{0}\\left ( 1+\\frac{\\pi}{2q}\\right ) \\end{array } \\right\\}\\ ] ] this approximation shown in figure 2 satisfies as the correct noise density the relations @xmath106 , width of the peak of the order @xmath107 , total noise @xmath108 and , for large @xmath9 , @xmath109 .",
    "the relation of noise in the `` peak '' , to that in the `` flat '' part is @xmath110 . for high @xmath9 factors",
    "most of the noise is in the resonance peak of the curve , and @xmath111 .",
    "therefore dsfm does not reduce but rather increase the total thermal noise as compared to static sfm .",
    "however , the signal to noise ratio is not modified : at low frequencies ( static sfm ) a driving force @xmath112 will induce the motion @xmath113 , and the signal to noise ratio is @xmath114 , while if this force is applied at resonance it will induce a response @xmath115 and , for sufficiently small bandwidth , the thermal noise is @xmath116 .",
    "noise and signal are therefore amplified equally . correspondingly , dsfm increases sensitivity by a factor of @xmath9 as compared to static sfm , but the ( theoretical ) signal to noise ratio is unchanged .",
    "finally , we note that in normal applications the thermal fluctuations of the @xmath117 and @xmath118 component are uncorrelated , and that both should have the same amount of fluctuation ( see , however , @xcite ) . then , since @xmath119 , it follows that @xmath120 , therefore @xmath121 and  for the total thermal fluctuation of the @xmath117 and @xmath118 components : @xmath122 .",
    "to calculate the frequency noise , the relation@xmath123 will be used . with @xmath124 ( see relation [ phase ] ) the only unknown quantity is the phase noise @xmath125 .",
    "the phase , as defined by relation ( [ phase ] ) is @xmath126 .",
    "we will assume that dsfm is operated in the phase looked loop mode and is thus always at resonance , then @xmath127 and @xmath128 , with @xmath129 the oscillation amplitude at resonance .",
    "the correct calculation of the phase noise is non - trivial , since the phase is a non - linear function of the two variables @xmath130 and @xmath131 , which is non - regular at the origin and thus the common rules for noise / error propagation have to be applied with care . the correct calculation based on statistical mechanics",
    "is presented in appendix b. here we will assume that a finite oscillation is applied to the cantilever in order to prevent the system to be near the origin of the @xmath132 phase space . then , the mean phase is @xmath133@xcite and the fluctuation of the phase is @xmath134 . using the relation @xmath135 we have , with @xmath136 , @xmath137 and @xmath138 , @xmath139 and finally , with @xmath140 and relation [ xyzrelation ] we find for the phase noise measured around a center frequency @xmath61 with a bandwidth @xmath65 : @xmath141    for large oscillation amplitude , the phase noise is therefore @xmath142 , which can be interpreted as a variation of the phase due to thermal fluctuation of magnitude @xmath143 of the @xmath117-component when the @xmath118-component has an oscillation amplitude @xmath144 .",
    "for very small oscillation amplitude , relation [ phasenoise2 ] would give @xmath145 .",
    "however , as discussed above ,  at the origin of the @xmath146 phase space the phase is mathematically not well defined , relation ( [ phasenoise ] ) can not be used , and relation [ phasenoise2 ] is not accurate . on physical arguments one would expect a uniform distribution of phase , that is , a ( normalized ) probability distribution @xmath147 , which has a mean deviation @xmath148 .",
    "as shown in appendix b this is correct in the limit of vanishing oscillation ( see inset of figure 3 ) .",
    "the correct relation for the phase noise has no simple functional relation with the oscillation amplitude , therefore we propose@xmath149 as approximation for the correct phase fluctuation which has the correct large and low oscillation behavior .",
    "figure 3 shows the known large oscillation behavior for phase noise , the correct relation calculated in the appendix as well as  the approximations according to relations  [ phasenoise ] and relation [ phasenoisebetter ] with the correct small and large oscillation limits .    with relation [ freqnoise ]",
    "we finally obtain for the total frequency noise : @xmath150 in order to discuss this relation , and to compare with the results known from the literature , we will consider the different approximations for large and low oscillation amplitudes , as well as for small and large bandwidth . for ( very ) low bandwidth , and large oscillation amplitude",
    "we obtain , using relation [ amplitudenoiseliterature]@xmath151 which is similar to the result reported in the literature@xcite ( relation [ freqnoiseold ] ) . as discussed in the previous section ,",
    "this ( very ) `` low bandwidth approximation '' is usually not valid . on the contrary",
    ", we believe that in most applications the bandwidth is larger than the width of the resonance curve",
    ". then , as long as instrumental noise is negligible , the correct approximation would be a `` large bandwidth '' approximation where all the thermal noise is `` seen '' by the dsfm - detection system . in this case",
    "the corresponding ( total ) frequency noise is@xmath152 which is @xmath153 for large amplitude and for @xmath154 for low amplitude .",
    "the characteristic frequency determining the thermal frequency noise is therefore the width @xmath107 of the resonance curve , and for low oscillation amplitudes ( @xmath155 ) the thermal frequency noise is essentially given by the width of the resonance curve .",
    "in particular , this implies that , as demonstrated recently for spectroscopy applications@xcite , dsfm is possible without external excitation of the tip - sample system .",
    "moreover , we believe that a properly designed dfsm - electronics should be able to lock onto the thermal noise of the cantilever .",
    "in order to confirm the validity of the relations just discussed , noise measurements have been made as a function of the bandwidth and the oscillation amplitude . a commercial sfm - system based on optical beam deflection@xcite",
    "was used to measure cantilever motion and analysis of cantilever oscillation was performed either with the dsfm electronics@xcite or with a digital lock - in amplifier@xcite . the set - up of the sfm system and the essential features of the dsfm",
    "electronics are shown in figure 1@xcite .",
    "a cantilever with a nominal force constant @xmath156@xcite was used and the tip was kept at a large ( @xmath157 ) distance from the sample . for this kind of cantilever , relation [ equipartition ] gives a total mean ( rms ) fluctuation of @xmath158 .",
    "figure 4 shows the the spectral noise measurement of the cantilever movement acquired with the digital locking amplifier@xcite . to characterize the spectral noise density and to discriminate thermal noise against other ( technical ) noise sources",
    "this data is fitted to the function @xmath159 the lorentzian function is used to describe the thermal noise density of the cantilever , and the constant @xmath160 is introduced to describe any additional ( technical ) noise ( see also @xcite ) .",
    "> from the fit to the experimental data , a quality factor @xmath161 , a natural frequency @xmath162 , a thermal noise density @xmath85=26.4@xmath163 fm/@xmath164 and a constant @xmath160=17@xmath165 fm/@xmath164 is found .",
    "the inset of figure 4 shows the total noise as a function of bandwidth , with the central frequency of the noise measurements at the resonance peak . in this log - log plot the square root dependence of the total noise on bandwidth for small bandwidth is clearly recognized from the slope @xmath166 . for high bandwidth , the total noise saturates",
    "this saturation occurs for a bandwidth of the order of the width of the resonance curve @xmath167 , in good agreement with the discussion above ( relations [ phasenoise2 ] and [ freqnoiselargebw ] ) and the data obtained from the spectral noise density .",
    "we note that the saturation of noise is only observed if other noise sources are negligible , which is clearly the case in our measurements .",
    "then , as the bandwidth of noise measurement is increased only the thermal noise in the resonance peak is seen  by the dsfm detection unit . if other noise sources are not negligible , then , as the bandwidth of the dsfm detection unit is increased ( @xmath168 ) , the detection unit will `` see '' this additional noise and the total noise will not saturate . instead",
    ", it will continue to increase with the square root dependence known from the literature@xcite .",
    "if the technical noise is appreciable , a total noise well above the theoretical value @xmath104 for thermal noise can be experimentally observed since thermal and technical noise is measured .",
    "finally , figure 5 shows the noise of the frequency as a function of oscillation amplitude .",
    "two different regimes are recognized : a constant regime for low oscillation amplitude where the total noise is independent of oscillation amplitude and a second regime where , as evidenced by the slope @xmath169 in the @xmath170 vs. @xmath171 plot , the noise decreases with the inverse of the oscillation amplitude .",
    "the transition range of this graph corresponds to an oscillation amplitude @xmath172 , in good agreement with the value for the thermal oscillation amplitude obtained from the frequency noise measurement shown in figure 4 .",
    "in the present work we have revised dsfm frequency detection and have analyzed how the thermal fluctuation of the cantilever is processed by a dsfm detection electronics .",
    "we find a general relation for the frequency noise as a function of a bandwidth and oscillation amplitude .",
    "this relation is correct for all possible values of parameters , while the relation known so far from the literature is only correct for a particular range .",
    "we find that for sufficiently large bandwidth -that is , small time constants of the dsfm detection electronics- essentially all the thermal noise of the cantilever is measured . in this case",
    "the width of the resonance peak is the characteristic noise of any dsfm frequency measurement for small oscillation amplitude , while for larger oscillation amplitude the noise decreases linearly with the oscillation amplitude . in the large amplitude and ( very ) low bandwidth limit",
    "our general relation converges within a constant factor , to the relation known from the literature .",
    "we are convinced that the results presented in this work are relevant for the precise determination of the ultimate limits of dsfm .",
    "in particular , our general relation shows that for small oscillation amplitudes the frequency noise does not diverge , but rather converges towards a finite value .",
    "therefore , small oscillation dsfm might be much more competitive than considered up to now .",
    "dsfm without external oscillation , that is , driven by thermal noise , might be possible not only for the measurement of tip - sample interaction , but also for imaging applications .",
    "since many high precision measurements sfm measurements  -in particular in the field of electrostatic and magnetic force microscopy- are ultimately based on frequency measurements we believe that the present work will also improve understanding and optimization of these related sfm techniques and shed light on the ultimate limit of scanning force microscopy in different important applications .",
    "the authors acknowledge stimulating discussions with a. urbina , j. gmez , l. colchero and a. gil .",
    "the authors also thank atomic force f&e gmbh , and in particular mr .",
    "ludger weisser ,  for supplying the cantilevers  used .",
    "this work was supported by the spanish ministry of science and technology through the projects nan2004 - 09183-c10 - 3 and mat2006 - 12970-c02 - 01 .",
    "in the harmonic approximation , the fundamental equation describing the dynamics of a sfm - system is that of the forced harmonic oscillator , @xmath173 , where @xmath4 is the force constant of the system , @xmath174 its ( effective ) mass , @xmath175 the constant describing the damping in the system and @xmath176 the external force driving the oscillator . with the definitions @xmath177 , @xmath178 , and assuming a harmonic driving force @xmath179 , where @xmath13 is a displacement determined by the driving force ( @xmath180 ) ,",
    "this equation is transformed into@xmath181 note that , in order to avoid recurrent @xmath182 factors the angular frequency @xmath183 will be used here instead of the frequency @xmath27 as in the main text . for the steady state motion",
    "this equation can be solved algebraically with the classical ansatz @xmath184:@xmath185 from which the complex amplitude @xmath186 is determined as@xmath187 a dimensionless ( but complex ) mechanical gain @xmath188 can be defined so that  @xmath189 . for the discussion that will follow ,",
    "it is more convenient to describe the complex amplitude @xmath186 in cartesian coordinates : @xmath190 where @xmath191 and @xmath192 are the in - phase and out of phase components of the oscillation . then the complex amplitude is @xmath193 and the time response to the driving source @xmath194 is @xmath195 with a phase @xmath196",
    "this phase describes the delay between the driving source and the response and is @xmath197 as described in the main text , to experimentally determine state of a harmonic oscillator , the measured deflection @xmath25 is multiplied with two reference signals @xmath198 and @xmath199 to obtain two quadrature signals @xmath200 with @xmath201 and @xmath202 . with the definitions@xmath203{cc}% \\cos(\\omega_{\\delta}t ) & \\sin(\\omega_{\\delta}t)\\\\ -\\sin(\\omega_{\\delta}t ) & \\cos(\\omega_{\\delta}t ) \\end{array } \\right )   \\text { and } \\mathbf{m}_{\\sigma}(t)=\\frac{1}{2}\\left ( \\begin{array } [ c]{cc}% \\cos(\\omega_{\\sigma}t ) & \\sin(\\omega_{\\sigma}t)\\\\ \\sin(\\omega_{\\sigma}t ) & -\\cos(\\omega_{\\sigma}t ) \\end{array } \\right)\\ ] ] the output of the two multiplication stages can be written in matrix notation as @xmath204 .",
    "the corresponding time evolution can thus be decomposed into one vector rotating clockwise with the frequency @xmath205 and another one rotating counter - clockwise with the frequency @xmath206 .",
    "after the multiplication stage the two quadrature signals @xmath34 and @xmath35 are low - pass filtered . for a simple first order low pass the corresponding time domain signals are@xmath207 again , two matrices@xmath208{cc}% \\cos(\\omega_{\\delta}t)-\\omega_{\\delta}\\tau\\sin(\\omega_{\\delta}t ) & \\sin ( \\omega_{\\delta}t)+\\omega_{\\delta}\\tau\\cos(\\omega_{\\sigma}t)\\\\ -\\sin(\\omega_{\\delta}t)-\\omega_{\\delta}\\tau\\cos(\\omega_{\\delta}t ) & \\cos(\\omega_{\\delta}t)-\\omega_{\\delta}\\tau\\sin(\\omega_{\\delta}t ) \\end{array } \\right )   \\text { } \\label{mtaudel}\\\\ \\mathbf{m\\tau}_{\\sigma}(t )   &   = \\frac{1}{2(1+\\tau^{2}\\omega_{\\sigma}^{2}% ) } \\left ( \\begin{array } [ c]{cc}% \\cos(\\omega_{\\sigma}t)-\\omega_{\\sigma}\\tau\\sin(\\omega_{\\sigma}t ) & \\sin ( \\omega_{\\sigma}t)+\\omega_{\\sigma}\\tau\\cos(\\omega_{\\sigma}t)\\\\ \\sin(\\omega_{\\sigma}t)+\\omega_{\\sigma}\\tau\\cos(\\omega_{\\sigma}t ) & -\\cos(\\omega_{\\sigma}t)+\\omega_{\\sigma}\\tau\\sin(\\omega_{\\sigma}t ) \\end{array } \\right )   \\label{mtausum}%\\end{aligned}\\ ] ] can be defined .",
    "the first matrix , @xmath209 , corresponds to a clockwise rotation with the frequency @xmath205 and a delay angle @xmath210  while the second matrix , @xmath43 , corresponds to a counter - clockwise rotation with the frequency @xmath206 and a delay angle @xmath211 .      for the calculation of the variation of the phase",
    ", we will assume that the variables @xmath130 and @xmath131 are gaussian variables . at resonance ,",
    "as discussed above @xmath212 and @xmath213 , therefore their probability distributions are described by@xmath214    these distributions are normalized and have the variance @xmath215 . to calculate the distribution of the phase ,",
    "first its probability function has to be calculated according to the general relation ( see , for example , @xcite),@xmath216 which in our case leads to @xmath217   \\right )   \\right )   \\nonumber\\\\ &   = \\frac{1}{2\\pi}\\left (   e^{-a_{os}^{2}/a_{th}^{2}}+\\sqrt{\\pi}\\;\\frac{a_{os}% } { a_{th}}\\;e^{-a_{os}^{2}\\sin^{2}\\left (   \\varphi\\right )   /a_{th}^{2}}% \\cos\\left (   \\varphi\\right )   \\left (   1+\\operatorname{erf}\\left [   \\frac{a_{os}% } { a_{th}}\\cos\\left (   \\varphi\\right )   \\right ]   \\right )   \\right ) \\label{phasedistribution}%\\end{aligned}\\ ] ] where @xmath218=2/\\sqrt{\\pi}% % tcimacro{\\tint } % % beginexpansion { \\textstyle\\int } % endexpansion dx~e^{-x^{2}}$ ] is the normalized error function ( @xmath219=1 $ ] ) .",
    "this probability distribution is plotted in the inset of figure 3 for the range of oscillation amplitudes @xmath220 . for large oscillation amplitude @xmath221",
    "the first term can be neglected , in addition we can assume @xmath222\\simeq1 $ ] , and only very small angles contribute to the probability amplitude ( @xmath223 ; @xmath224 ) then , with @xmath225 , we find @xmath226 which is a normalized gaussian probability distribution of the angle @xmath227 with variance @xmath228 , in agreement with the high excitation limit of eq .",
    "[ phasenoise2 ] .",
    "we note that the ratio @xmath225 can be interpreted as the fluctuation of the phase due to thermal variation @xmath143 of the x - component when the y - component of the oscillation is fixed at @xmath144 ( for @xmath221 thermal fluctuation of the y - component essentially gives no contribution to phase noise ) . for small oscillation",
    "amplitudes the second term in [ phasedistribution ] is small and we find , to first order in @xmath229 , @xmath230 the angle probability distribution therefore becomes non - gaussian and ultimately uniform ( see inset of figure 3 ) , as is expected for vanishing oscillation amplitude . the mean value of this ( normalised ) angle distribution is @xmath231 , and its square deviation @xmath232 .",
    "the correct phase error @xmath233 calculated from the probability distribution [ phasedistribution ] is plotted in figure 3 , together with the different approximations discussed in this work .",
    "fig1_dsfm.pdf                                    j. colchero , procedures in scanning probe microscopy , chaper 1.3.3.1 `` bouncing beam deflection '' , 122 - 128 , editors : a. engel , j. frommer , h. gaub , a. gewirth , r. guckenberger , m - h .",
    "hara , w.  heckel and b. parkinson , john wiley & sons ( 1998 ) .",
    "we note that the different use of frequency @xmath27 and angular frequency @xmath234 may lead to considerable confusion . in the present work",
    "we will try to define all quantities in such a way that their functional appearance is the same , independently of whether frequency or angular frequency is used .",
    "mostly frequency will be used , and the use of angular frequency will be limited to terms like @xmath235 and @xmath236 where the factor @xmath182 -as in @xmath237-would be unnecessary bulky . in particular spectral densities -as in [ densitynoise]- are referred to frequency and not to angular frequency .",
    "this may seem evident since we assume that the system is at resonance .",
    "mathematically , however , it is important that a finite oscillation amplitude `` defines '' the mean angle : @xmath238 , for @xmath239 , while for @xmath240 this relation -and thus the mean angle- is undefined .",
    "note , however , that an optional oscillation amplitude gain control , usually used in dsfm to measure dissipation , is not included in figure 1 . for the frequency noise measurements to be discussed here the gain control of the dsfm electronics was disabled and is thus not relevant in the present context .",
    "j. colchero , procedures in scanning probe microscopy , chapter 1.3.3.12 `` force calibration '' , pp .",
    "133 - 138 , editors:.a .",
    "engel , j. frommer , h. gaub , a. gewirth , r. guckenberger , m - h .",
    "hara , w.  heckel and b. parkinson , john wiley & sons ( 1998 ) .",
    "more precisely : only for constant noise density the increase of total noise with will have a square root dependence .",
    "note that if the noise density has essentially two ranges , one where the thermal noise is dominant and another one where a ( constant ) technical noise density is relevant , in the log - log plot this will give rise to two regions , both with slope 1/2 and thus parallel , but with a slight offset induced by the transition from the frequency range dominated by thermal noise to the frequency range dominated by technical noise ."
  ],
  "abstract_text": [
    "<S> thermal fluctuation of the cantilever position sets a fundamental limit for the precision of any scanning force microscope . in the present work </S>",
    "<S> we analyse how these fluctuations limit the determination of the resonance frequency of the tip - sample system . </S>",
    "<S> the basic principles of frequency detection in dynamic scanning force microscopy are revised and the precise response of a typical frequency detection unit to thermal fluctuation of the cantilever is analysed in detail . a general relation for thermal frequency noise </S>",
    "<S> is found as a function of measurement bandwidth and cantilever oscillation . for large oscillation amplitude and low bandwidth </S>",
    "<S> , this relation converges to the result known from the literature , while for low oscillation amplitude and large bandwidth we find that the thermal frequency noise is equal to the width of the resonance curve and therefore stays finite , contrary to what is predicted by the relation known so far . </S>",
    "<S> the results presented in this work fundamentally determine the ultimate limits of dynamic scanning force microscopy . </S>"
  ]
}