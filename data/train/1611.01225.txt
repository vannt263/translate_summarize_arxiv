{
  "article_text": [
    "consensus methods are widely used to combine phylogenetic trees into a single phylogeny .",
    "traditionally , consensus methods have been applied as a technique for combining information from diverse data sources @xcite .",
    "more recently , consensus methods are most commonly used as a technique for summarizing output from mcmc analyses ( e.g. @xcite ) , or estimating species trees from gene trees ( e.g. @xcite ) .    in these situations ,",
    "consensus methods provide a way to combine phylogenetic trees into a single tree representing the underlying evolutionary history of the species under study .",
    "suppose we have a collection of trees for a set @xmath0 of taxa that we have combined by some consensus method to produce an estimate @xmath1 of the tree for @xmath0 . in future",
    ", we may collect data on additional species , build trees from these data , and infer a consensus tree @xmath2 from these trees .",
    "of course , the tree inferred for our original set of species @xmath0 may well differ from what we obtain today . but suppose that the trees they use to build their consensus tree agree exactly with the trees we have today once we restrict attention to relationships between the species in @xmath0 . in that case , we might hope that the tree we obtain by restricting @xmath2 to @xmath0 should also agree with our existing tree @xmath1 , or at least be a refinement of @xmath1 ( perhaps because the additional taxa help us to resolve polytomies that can not be resolved at present ) .",
    "in other words , if the future phylogenies agree with our present ones when restricted to the taxa we have available today , can we hope that the evolutionary relationships established today using consensus are ` safe ' in the sense that different branching orders need not be postulated in future ?",
    "we call this property of a consensus method _ extension stability_. it asserts that if a consensus tree has been produced from a profile of trees , and a new species is added to each of them , one expects that the new consensus tree on the profile of extended trees will restrict back down to the consensus of the original profile ( or at least display the same monophyletic clusters ) . a formal definition is given in the next section , and fig .",
    "[ f : motivation ] illustrates this concept for a particular consensus method ( majority rule ) applied to a particular input profile of three binary trees . in this example",
    ", an additional taxon @xmath3 appears in different places in the input trees , however the consensus tree on the full taxon set ( including @xmath3 ) still displays the original consensus relationship between the original taxa @xmath4 .",
    "for other profiles , majority rule consensus can fail to satisfy extension stability .",
    "and @xmath5 is the resolved tree @xmath6 .",
    "if an additional taxon @xmath3 is analysed and the resulting trees @xmath7 agree with @xmath8 and @xmath5 up to the placement of @xmath3 , then the majority rule consensus of the trees still displays the original relationship @xmath6 once taxon @xmath3 is removed.,width=377 ]    in this paper , we explore a very simple question : which , if any , reasonable consensus methods can achieve this goal ?",
    "surprisingly , there are standard methods ( including adams consensus ) that do not satisfy extension stability @xcite . the question of whether ` reasonable ' extension stable consensus functions exist at all was left open in that paper . here we show that remarkably , in general , no such consensus function exists .",
    "our ` no - go ' theorem is of a similar spirit but quite different from ( and deeper than ) the non - existence result of proposition 2 from @xcite .",
    "we do , however , show that under certain restrictions , either on the profile of input trees or by modifying the extension stability condition , there exist consensus methods ( including adams consensus ) that are stable in this limited sense .    in a later section",
    ", we also consider a further type of stability condition that arises when trees ( rather than taxa ) are added .",
    "this condition means that one can simply update the existing consensus tree when a new input tree is sampled , and the result will be the same as re - analysing the entire sequence of input trees . we show that certain methods have this property but that known methods that preserve nesting or triplet relationships do not .",
    "our approach provides further applications of the axiomatic approach to consensus methods in systematic biology pioneered by f.r .",
    "mcmorris and colleagues over more than three decades ( for an overview , see @xcite , with more recent results in @xcite , @xcite ) .",
    "this has led to a range of theorems which demonstrate that no consensus method can simultaneously satisfy various combinations of criteria , each of which seems both desirable and reasonable . in some cases ,",
    "the results are particular to unrooted trees ( for example , @xcite ) while in other cases they apply in the rooted setting .",
    "this axiomatic approach is motivated , in part , by the celebrated theorem of kenneth arrow @xcite who showed that four seemingly very plausible criteria can not be simultaneously achieved by any voting method .",
    "while these ` impossibility ' results ( in voting theory and in phylogenetics ) may be seen as negative , they have the positive effect of focusing attention on which criteria should be dropped , or at least weakened , to devise methods that achieve various combinations of desirable attributes .",
    "* trees and clusters *    in this paper , we deal exclusively with rooted phylogenetic trees and ( following @xcite ) , we will let @xmath9 denote the set of rooted phylogenetic trees on leaf set @xmath10 of taxa .",
    "cluster _ of a tree is a subset of the leaves that forms a monophyletic clade ( i.e. it is the set of all leaves that are descendants of some vertex ) .",
    "it is well known that the set of clusters of any rooted phylogenetic tree forms a hierarchy ( i.e. two clusters are either disjoint or one is a subset of the other ) and there is a one - to - one correspondence between the trees in @xmath9 ( up to equivalence ) and the set of hierarchies on @xmath10 that contain @xmath10 and the singleton elements ( and not containing the empty set ) .",
    "a tree @xmath11 _ refines _ a tree @xmath12 if every cluster of @xmath1 is present in @xmath2 ; we denote this by writing @xmath13 .",
    "thus @xmath9 forms a partially ordered set ( poset ) with the star tree as the unique minimal element and the binary ( fully resolved ) trees as the maximal elements ( @xmath9 is also a median semilattice , which is a concept that has been developed in more general consensus settings @xcite ) . given a tree @xmath12 and a subset @xmath14 of @xmath10 , we let @xmath15 be the tree obtained from @xmath1 by restricting @xmath1 to just the leaves in @xmath14 . when @xmath16 and @xmath17 is binary , we say that this tree is a _ rooted triple _ and",
    "is _ displayed _ by @xmath1 ( we write @xmath6 if this rooted triple has @xmath18 as a cherry and @xmath19 as the third leaf ) .",
    "* consensus methods *    a _ profile _ of trees from @xmath9 is an ordered tuple of trees @xmath20 for some @xmath21 ; we call these trees the ` input trees ' . notice that the same tree can appear more than once",
    ". a ( phylogenetic ) _ consensus method _ is a function @xmath22 that , for every set @xmath14 of taxa and every number @xmath23 , associates to each profile of @xmath21 trees from @xmath24 a corresponding tree in @xmath24 .",
    "the most widely used consensus method in contemporary phylogenetics is probably _ majority rule _ , which returns the tree that has clusters present in more than half of the input trees .",
    "variations on this include _ strict consensus _ , which returns the tree that has clusters present in every input tree , and _",
    "loose consensus _ , which returns the tree that has clusters that are ( i ) present in at least one input tree and ( ii ) are compatible with all other input trees .",
    "more recent variations on these consensus methods have also been devised , including the majority ( + ) method @xcite and frequency - difference consensus @xcite .",
    "all these methods satisfy the ( pareto ) property that if a cluster is present in all the input trees , then that cluster will also be present in the output .",
    "another type of consensus method outputs the tree that occurs most often in the profile ( in the case of ties , then some consensus of these tied trees  perhaps using majority rule or strict consensus  can be applied ) .",
    "such methods are particularly relevant when summarising a posterior distribution on trees from a sample generated by mcmc .",
    "a quite different class of consensus methods aims to also preserve other features shared across the input trees , such as nestings or 3-taxon relationships .",
    "we describe two such methods .",
    "one is the well - known _ adams consensus _",
    "method @xcite , which preserves nestings , and which we denote by @xmath25 .",
    "the other is a lesser known consensus method , called _ local consensus _ in @xcite , and is based on applying the build algorithm of @xcite to the set of rooted triples shared by all the input trees in the profile ; we will here refer to this method as _",
    "aho consensus _",
    ", denoted by @xmath26 .    both adams and aho consensus associate to each profile",
    "@xmath27 a partition @xmath28 of @xmath10 that forms the maximal clusters of the consensus tree . for adams",
    "consensus , @xmath28 equals the nonempty intersections of the maximal clusters of the trees in @xmath29 . for aho consensus , @xmath28 is the connected components of the graph @xmath30 , where @xmath31 is the set of pairs @xmath32 for which there is an element @xmath33 with @xmath6 displayed by every tree in @xmath29 ( we will refer to this as the _ build graph _ for @xmath29 ) .",
    "once @xmath28 has been determined , each method then repeats the same process on the restriction of @xmath29 to each set @xmath34 , eventually producing a hierarchy of sets on @xmath10 and thus a well - defined consensus tree in @xmath9 ( for further details , see @xcite ) .    both adams and aho consensus",
    "satisfy the following property of being _",
    "pareto on rooted triples _ , which is the following condition :",
    "@xmath35 this condition is equivalent to the following property ( for all @xmath36 ) : @xmath37 note that any consensus method that is pareto on rooted triples is also pareto on clusters .",
    "adams consensus also has the property that if @xmath6 is displayed by @xmath38 , then at least one tree in @xmath29 must display @xmath6 @xcite .",
    "all the consensus methods we have discussed ( strict consensus , loose consensus , majority rule , adams and aho consensus ) also satisfy the following property : given a profile @xmath29 and its consensus tree , if one adds the consensus tree to the profile , then the consensus on the enlarged profile is unchanged . formally , this is the condition that : @xmath39 where @xmath40 refers to the concatenation of the sequence @xmath29 with the consensus tree @xmath41 .",
    "this is analogous to the behaviour of the averages of real numbers ( indeed , @xmath42 is the average of @xmath43 if and only if @xmath44 ) .",
    "a proof that eqn .",
    "( [ stab ] ) holds for the main consensus methods mentioned so far is provided in the appendix .",
    "condition ( [ stab ] ) corresponds to an `` invariance '' property in @xcite .",
    "to move beyond the study of particular consensus methods , we impose only very minimal requirements on a possible consensus method . for this paper , we will call a consensus method @xmath22 `` regular '' if it satisfies the following three minimal axioms :    1 .   *",
    "unanimity*. if the trees in @xmath29 are all the same tree @xmath1 , then @xmath45 .",
    "* anonymity*. changing the order of the trees in @xmath29 does not change @xmath41 .",
    "* neutrality*. changing the labels on the leaves of the trees in @xmath29 simply relabels the leaves of @xmath41 in the same way .",
    "anonymity corresponds to a mathematical condition referred to as commutativity .",
    "it is the condition that for any profile @xmath46 and any permutation @xmath47 on @xmath48 , we have : @xmath49 , where @xmath50 is the profile @xmath51 nearly all existing consensus methods satisfy this condition of not taking the order of the input trees into account .",
    "moreover , even for consensus methods that do allow trees to be ranked according to the strength of support , such methods should still be able to deal with inputs in which the trees are to be regarded of equal value , and in that case unanimity should hold .",
    "neutrality @xcite corresponds to a mathematical condition referred to as equivariance . informally speaking , it is the requirement that the names given to the objects labelling the leaves of the tree should not play any special role in deciding how the consensus tree is determined .",
    "for example , if ` dog ' and ` cat ' were interchanged in each input tree , then the output tree should just be the same consensus tree but with ` dog ' and ` cat ' interchanged .    more precisely , given a bijection @xmath52 , and any tree @xmath12 , let @xmath53 be the tree in @xmath54 obtained from @xmath1 by replacing leaf @xmath3 with leaf @xmath55 for each @xmath56 .",
    "then neutrality is the condition that for any profile @xmath46 and any bijection @xmath52 , we have @xmath57 , where @xmath58 .",
    "we will refer to any consensus method that satisfies these three properties  unanimity , anonymity and neutrality  as a _",
    "regular _ consensus method .",
    "all standard phylogenetic consensus methods ( e.g. strict consensus , majority rule , loose consensus and adams consensus ) satisfy these properties .",
    "the additional property that is the main focus of this paper is _ extension stability _ , which is defined as follows .    1 .",
    "* extension stability*. for every phylogenetic profile @xmath29 consisting of trees from a leaf set @xmath10 of arbitrarily large size , and any nonempty set @xmath59 , @xmath60    extension stability was defined in @xcite , though it was referred to there as a  weak independence\"condition .",
    "it is different from any of the eight  stability conditions \" @xmath61@xmath62 defined and studied by @xcite , and weaker than the closest analogue in that list , namely @xmath63 .",
    "indeed , any consensus method that satisfies unanimity and extension stability is also pareto on rooted triples ( eqns .",
    "[ trip1 ] , [ trip2 ] ) .",
    "strict consensus satisfies the reverse inequality described by extension stability , namely : @xmath64 ( the short proof is given in the appendix ) .",
    "the fact that this inequality can be strict is well known .",
    "for example , if @xmath65 , where @xmath3 is a ` rogue ' taxon ( external to @xmath14 ) which positions itself in different places across the trees in @xmath29 , then the strict consensus of the trees in the resulting profile can be largely unresolved ( and so remains unresolved when restricted to @xmath14 ) compared to the strict consensus of the trees on the pruned leaf set @xmath14 .",
    "an example of this phenomenon arises in the study of whale phylogeny in @xcite , where the inclusion of the extinct taxon _ andrewsarchus _ causes the strict consensus tree to be much less resolved than if it is removed ( as shown in appendix fig . 2 of that paper ) .",
    "this reverse form of extension stability ( eqn .  ) fails to capture , however , the requirement that information ( clusters ) determined today is ` safe ' when future trees agree with the ones of today on the taxa subset @xmath14 . to make this more obvious ,",
    "observe that another regular consensus method satisfying eqn .",
    "is the rather trivial consensus method @xmath22 for which @xmath41 is always the star tree ( on the same leaf set as @xmath29 ) , except when @xmath29 is of the form @xmath66 , in which case @xmath67 .",
    "note that there are regular consensus methods that satisfy a restriction of the extension stability property where @xmath10 is required to be sufficiently small .",
    "for example , strict consensus satisfies these properties for @xmath68 , while for @xmath69 , adams consensus satisfies the extension property ( however , that method does not satisfy this property for @xmath70 as fig .  [",
    "f : adams.binary ] shows ) .",
    "notice that extension stability requires that any consensus choice we make on a small leaf set will still apply for profiles of larger trees when we restrict these down to smaller leaf sets ; we will see that this provides additional constraints , since the consensus trees on the sub - problems need to at least be compatible ( consistent with _ some _ tree ) .",
    "there are also regular consensus methods ( e.g. adams consensus ) that satisfy a restriction of the extension stability property where @xmath14 is required to have size at most 3 ( regardless of the size of @xmath71 ) .",
    "also , if we were to drop any one of the conditions required for a consensus method to be regular , then , as noted in @xcite , one can readily construct a method that is extension stable and satisfies the other regularity conditions .",
    "for example , if we drop anonymity , we can simply take the consensus of @xmath72 to be @xmath73 .",
    "the observation that adams consensus ( a standard and regular consensus method ) fails to satisfy this extension stability  thanks to an example by r. powers , reported in @xcite  is the starting point of this study ( a simpler example involving binary trees that shows that adams consensus fails is given in figure  [ f : adams.binary ] ) .",
    "the question of whether _ any _ regular consensus method can satisfy extension stability , left open by @xcite , is a main focus of this paper .",
    "we begin with some positive results .",
    "in this section , we describe some particular settings where extension stability provably holds for certain consensus methods .",
    "the _ height _ of a rooted phylogenetic tree is the length of the longest path from the root to a leaf .",
    "we now show that for profiles of trees of height at most two , which we call _ level 2 _ trees , there exist regular consensus functions that are extension stable .",
    "two such methods are adams and aho consensus .",
    "note that these are different consensus methods on level 2 trees , since for the profile @xmath74 , @xmath75 whereas @xmath76 is the star tree .",
    "[ posthm ] if all trees in the profile @xmath29 have height at most 2 , then adams consensus @xmath25 and aho consensus @xmath26 are both extension stable .",
    "suppose that every tree in @xmath77 ( a profile of trees each having leaf set @xmath10 ) has height at most 2 .",
    "then for any subset @xmath14 of @xmath10 , @xmath78 also has this property ( every tree in @xmath78 has height at most 2 ) . to prove the result it is sufficient to show that every rooted triple in @xmath79 is also displayed by @xmath38 .",
    "if @xmath6 is a rooted triple displayed by @xmath79 , then for every @xmath80 , the restricted tree @xmath81 contains a maximal cluster @xmath82 that contains @xmath83 and @xmath84 , and for a least one of these clusters , @xmath19 is not also present ( if @xmath4 are contained in @xmath82 for all @xmath80 , then we never get @xmath6 by the level 2 condition , but if @xmath85 are in separate maximal clusters for some tree in @xmath78 we get the unresolved triple in @xmath79 ) .",
    "using the fact that each tree in @xmath29 has height at most 2 , it follows that @xmath83 and @xmath84 appear together in a maximal cluster of each tree in @xmath29 , and at least one of these maximal clusters does not contain @xmath19 , so @xmath6 is displayed by @xmath38 .",
    "for aho consensus , the maximal clusters of @xmath86 are the connected components of the build graph @xmath87 , and the maximal clusters of @xmath76 are the connected components of the build graph @xmath30 . since @xmath88 and @xmath89 , a maximal cluster of @xmath86 is the intersection of a maximal cluster of @xmath76 with @xmath14 , and so is present as a cluster in @xmath90 . moreover , the build graph @xmath91 for any maximal cluster @xmath92 of @xmath86 is disconnected ( by the height 2 condition ) , so every cluster of @xmath86 is present in @xmath93 , as required .",
    "we note that the consensus problem on level 2 trees has close links with the consensus problem on partitions , itself an area of active research ( see for example , @xcite ) .",
    "the following condition is a special case of extension stability , since it applies only when the consensus of the restricted profile is binary ( i.e. fully resolved ) .    1 .",
    "_ binary extension stability_. for every phylogenetic profile @xmath29 consisting of trees from a leaf set @xmath10 of arbitrarily large size , and any nonempty set @xmath59 , if @xmath94 is a binary tree , then it equals @xmath95",
    "a second restricted form of extension stability is that obtained by restricting the choice of @xmath14 to either the clusters of @xmath41 or to clusters present in all trees in @xmath29 .",
    "more formally , we can define the following two properties :    1 .   _ extension stability for clusters ( i)_. for every phylogenetic profile @xmath29 consisting of trees from a leaf set @xmath10 of arbitrarily large size , and any nonempty set @xmath59 , if @xmath14 is a cluster of @xmath41 , then @xmath96    1 .",
    "_ extension stability for clusters ( ii)_. for every phylogenetic profile @xmath29 consisting of trees from a leaf set @xmath10 of arbitrarily large size , and any nonempty set @xmath59 , if @xmath14 is a cluster of every tree in @xmath29 then @xmath96    it turns out there are regular consensus methods that satisfy all these restricted versions of extension stability , and , once again , adams consensus suffices .",
    "the proof of the following result is provided in the appendix .",
    "[ ad2 ] adams consensus satisfies binary extension stability , extension stability for clusters ( i ) and extension stability for clusters ( ii ) .",
    "we turn now to our main result , which is the following arrow - type theorem .",
    "[ mainthm ] no regular consensus method @xmath22 is extension stable on profiles of two trees .    in order to prove this theorem",
    ", we first require a lemma .",
    "[ bryantlem ] suppose that @xmath22 is regular consensus method which is extension stable and let @xmath29 be the profile of the two trees @xmath8 in fig .",
    "[ f : bryfig ] . in that case",
    ", @xmath97 is a cluster of @xmath41 .",
    "suppose that @xmath41 does not contain the cluster @xmath97 ( we will derive a contradiction ) .",
    "restricting the profile to the leaves @xmath98 , we have identical trees @xmath99 , so by unanamity @xmath100 .",
    "thus @xmath41 is one of the trees @xmath101 with @xmath19 placed as shown in fig .",
    "[ f : bryfig ] .",
    "let @xmath102 be the profile @xmath103 obtained by mapping @xmath104 to @xmath105 and reversing the order of the trees . if @xmath41 equals @xmath106 , @xmath107 or @xmath108 then , by unanimity ( and anonymity ) , @xmath109 must equal @xmath110 , @xmath111 or @xmath112 respectively . in all three cases , @xmath41 and @xmath109",
    "resolve the triple @xmath4 differently , so the two consensus trees are incompatible .    now consider the profile @xmath113 in fig .",
    "[ f : bryfig ] , and observe that @xmath114 and @xmath115 .",
    "we have assumed that @xmath22 is extension stable so that @xmath116 refines @xmath117 , and @xmath118 refines @xmath119 .",
    "this is a contradiction , as @xmath41 and @xmath109 are incompatible .",
    ".,width=302 ]    this contradiction was based on the assumption that @xmath41 does not contain the cluster @xmath97 , thus @xmath41 contains this cluster .",
    "consider the profile @xmath29 consisting of the two trees shown in fig .",
    "[ f : theseus ] , suppose that @xmath41 is a regular consensus method that satisfies extension stability , and let @xmath120 ( we will derive a contradiction ) .     of two trees used in the proof by contradiction argument for establishing theorem  [ mainthm].,width=321 ]",
    "we apply lemma  [ bryantlem ] repeatedly . for the leaf set @xmath121",
    ", we deduce that @xmath122 has the nontrivial cluster @xmath123 and so displays @xmath124 , while for the leaf set @xmath125 , the tree @xmath126 has the nontrivial cluster @xmath127 and so displays @xmath128 .",
    "consequently , by extension stability , @xmath124 and @xmath128 must both be displayed by @xmath1 , and therefore @xmath129 is also displayed by @xmath1 .    repeating this argument for @xmath42 , with the leaf set @xmath130",
    ", we deduce that @xmath122 has the nontrivial cluster @xmath131 and so displays @xmath132 , while for the leaf set @xmath133 , the tree @xmath134 has the nontrivial cluster @xmath135 and so displays @xmath136 .",
    "consequently , by extension stability , @xmath132 and @xmath136 must both be displayed by @xmath1 , and therefore @xmath137 is also displayed by @xmath1 .",
    "however , this contradicts the conclusion of the previous paragraph that @xmath129 is displayed by @xmath1 , and this contradiction implies that such a consensus method @xmath22 exists can not exist .",
    "* remarks : * the example used in the proofs of theorem  [ mainthm ] and lemma  [ bryantlem ] shows that the height bound in theorem  [ posthm ] is tight .",
    "that is , although there are regular consensus methods that are extension stable on an arbitrary number of trees of height at most 2 , when we move to height 3 , even for just two trees , extension stability can be impossible to achieve for any consensus method .",
    "so far , the stability properties we have considered ( extension stability and its variations / restrictions ) involve adding taxa to extend a given profile of trees . in this final section ,",
    "we consider the taxa as being fixed and investigate a stability condition that applies as phylogenies are added to the profile .",
    "suppose a consensus tree @xmath1 has been built from a sequence of input trees @xmath138 and then a new input tree @xmath139 becomes available .",
    "a natural question now arises : is the resulting consensus of these @xmath21 trees the same as simply taking the consensus of the most current consensus tree @xmath1 and the new tree @xmath139 ? for certain methods ( e.g. strict consensus ) , this applies , whereas for others ( e.g. majority rule ) , it can fail .",
    "more formally , consider the following condition : for all @xmath140 , and every profile @xmath141 , we have : @xmath142 where @xmath143 is the profile obtained by removing tree @xmath144 from the last position in the profile to give a profile of length @xmath145 . if @xmath22 satisfies property ( [ ass ] ) , we say that it is _",
    "associatively stable_. associative stability is computationally desirable , since all the information required to update a consensus tree when a new input tree arises is the current consensus tree , not the list of previous input trees used to produce it .",
    "notice that any consensus method @xmath22 on @xmath9 can be regarded as a binary operation @xmath146 on this set , by letting @xmath147 .",
    "if @xmath22 is a regular consensus method , this operation is both commutative and ( by unanimity ) it is also idempotent ( i.e. @xmath148 ) and , if @xmath22 is also associatively stable , then the operation @xmath146 is associative ( i.e. @xmath149 ) .",
    "note that the associativity of @xmath146 is a weaker condition than associative stability .",
    "moreover , any regular consensus method that is associatively stable has the property that for any profile @xmath150 the following product @xmath151 is well - defined , takes the same value for any ordering @xmath152 of the trees in @xmath29 , and can be computed by repeatedly taking pairwise consensus operations on trees ( placing the brackets arbitrarily ) .",
    "the proof of the following result is provided in the appendix .",
    "[ natlem ] if @xmath22 is a regular consensus method that is associatively stable then @xmath41 depends only on the set of trees present in @xmath29 and not on their frequency .",
    "it follows that consensus methods like majority rule are not associatively stable .",
    "although strict consensus satisfies associative stability , loose consensus fails to have this property .",
    "a simple example is provided by the profile @xmath153 for which @xmath154 is a cluster of @xmath155 but @xmath154 is not a cluster of @xmath41    adams consensus is associatively stable for profiles of trees having height 2 , but not for profiles of trees of height four .",
    "aho consensus fails to be associatively stable even for profiles of trees having height 2 .",
    "adams consensus is associatively stable for any profile @xmath29 of trees of height 2 , since the nontrivial clusters of @xmath38 consist of the nonempty intersections of the nontrivial clusters of the trees in @xmath29 , and intersection is an associative operation on sets .",
    "however , adams consensus is not associative ( and so not associatively stable ) in general , by virtue of the example provided in fig .",
    "[ f : both_fail ] , which involves three trees of height 4 .",
    "aho consensus also fails to be associative for the profile in fig .",
    "[ f : both_fail ] , but a simpler example shows that this method also fails associativity on trees of height 2 . consider the profile @xmath156 consisting of three trees of height 2 .",
    "we have @xmath157 and so @xmath158 ; however as we noted earlier , @xmath76 is the star tree .",
    "thus aho consensus fails to be associative ( and thereby associatively stable ) on trees of height 2 .",
    "we have explored two notions of stability for consensus methods : one where taxa are added , and the other where trees are added . in the former setting we have answered a question left open by @xcite : not only are no current consensus methods extension stable in general , but it is impossible to design one that is while retaining the usual ( ` regular ' ) properties expected of any consensus method ( theorem  [ mainthm ] ) . in other words ,",
    "whichever method is used to combine trees , it may still be necessary to revise phylogenetic relationships in future , even when the new trees on the taxa they originally considered agree with the original trees on which those relationships were established .",
    "however , if the new taxa lie outside a cluster ( monophyletic clade ) that appears in the consensus tree , then existing relationships can be preserved ( theorem  [ ad2 ] ) , at least for certain consensus methods .",
    "we also investigated the stability of consensus methods as trees , rather than taxa , are added .",
    "associative stability is the requirement that the current consensus tree provides a sufficient summary of the earlier input trees when we wish to update our phylogeny when presented with a new input tree , rather than having to recompute the consensus afresh using all the input trees .",
    "certain methods ( e.g. strict consensus ) satisfy associative stability , however we showed that certain other methods fail to satisfy it except in special cases .",
    "because our results in these sections are stated quite generally , they apply to the performance of consensus methods across a wide range of applications in systematic biology , including inferring species trees from gene trees @xcite , summarizing the posterior distribution of trees in bayesian phylogenetics @xcite , and inferring a species tree from a collection of species trees obtained from different studies .",
    "our results also raise a number of interesting questions for further work which we now discuss .",
    "we saw from theorem  [ posthm ] that adams and aho consensus are extension stable for trees of height at most 2 .",
    "however , adams is not extension stable for trees of greater height , even when the trees are binary .",
    "an example is the profile in figure  [ f : adams.binary ] . for this example , the aho consensus method does not violate extension stability ; however , it is easy to find two non - binary trees and a subset @xmath14 for which it does ( e.g. the profile @xmath159 in fig .  [",
    "f : bryfig ] , which consists of the trees @xmath160 and @xmath161 and @xmath162 ) . moreover ,",
    "by resolving the polytomies in each tree in two different ways , we obtain a profile of four binary trees on which aho consensus violates extension stability for the same set @xmath14 .    ) whereas the adams consensus trees restricted to two subsets ( bottom ) display the rooted trees @xmath6 and @xmath163 respectively ( and so are not compatible with any tree ) .",
    ", width=302 ]    these observations , together with the results in the previous sections , suggest our first question :    * is there a regular consensus method that satisfies extension stability when the method is restricted to profiles of binary trees ? or even just to profiles of",
    "_ two _ binary trees ?    regarding associative stability ,",
    "we have seen that although some methods , such as strict consensus , satisfy this property , other methods ( including loose consensus , majority consensus , adams and aho consensus ) fail to be associative .",
    "this raises our second interesting open question .",
    "* is there a regular consensus method that satisfies associative stability and is pareto on rooted triples ?",
    "in addition to these questions , further topics that may be useful to consider are extensions of the concepts and results we have described to allow profiles of trees in which each tree comes with given branch lengths and/or a weight ( e.g. a posterior probability assignment ) .",
    "one step in this direction has been provided in a recent study ( @xcite ) into the consistency and stability of on - line updating of bayesian posterior distributions on trees as new data is obtained .",
    "finally , certain consensus methods not discussed here , such as greedy consensus @xcite may involve a randomisation step , such as breaking a tie arbitrarily .",
    "strictly speaking , such methods are not consensus methods ( i.e. functions ) as we have defined them , however all the axioms we have studied could be rephrased as properties that apply when a consensus tree is a random variable whose distribution is determined by the input trees .",
    "we thank the university of canterbury erskine fund for financial support for this project .",
    "we thank f. r. mcmorris and peter lockhart for advice regarding background literature .",
    "we also thank f. r. mcmorris and a second ( anonymous ) reviewer for numerous helpful suggestions .",
    "4    1ada86 adams , e. n. ( 1986 ) .",
    "n - trees as nestings : complexity , similarity , and consensus . j. classif . 3:299317 .    2aho81 aho , a. v. , sagiv , y. szymanski , t. g. and ullman , j. d. ( 1981 ) , inferring a tree from lowest common ancestors with an application to the optimization of relational expressions , siam",
    ". j. comput . ,",
    "10 : 405421",
    ".    3arr arrow , k. j. ( 1950 ) , a difficulty in the concept of social welfare , journal of political economy 54(4 ) : 328346 .    4bar3 barthlemy , j - p . , mcmorris , f.r",
    ". and powers , r.c .",
    "stability conditions for consensus functions defined on @xmath164trees . mathematical computation and modelling 22(1 ) : 7987 .",
    "5bry03 bryant , d. 2003 .",
    "a classification of consensus methods for phylogenetics , in bioconsensus , dimacs working group meetings on bioconsensus , dimacs series in discrete mathematics and theoretical computer science , vol .",
    "61 , m. f. janowitz , f .- j .",
    "lapointe , f. r. mcmorris , b. mirkin , and f. s. roberts , eds . ,",
    "american mathematical society , providence , 163184 .",
    "6day03 day , w.h.e . , and mcmorris , f. r. 2003 .",
    "axiomatic consensus theory in group choice and biomathematics .",
    "frontiers in applied mathematics 29 , siam , philadelphia , 2003 .",
    "7deg09 degnan , j. h. , degiorgio , m. , bryant , d. , and rosenberg , n. a. ( 2009 ) .",
    "properties of consensus methods for inferring species trees from gene trees .",
    "syst . biol .",
    "58:3554 .",
    "vu16 dinh , v. , darling , a.e . and matsen , f.a .",
    "online bayesian phylogenetic inference : theoretical foundations via sequential monte carlo .",
    "arxiv:1610.08148 [ q-bio.pe ]    8don11 dong , j. , fernndez - baca , d. , mcmorris , f. r. , and powers , r. c. 2011 . an axiomatic study of majority - rule ( + ) and associated consensus functions on hierarchies .",
    "discrete applied mathematics 159 : 20382044 .",
    "9gei09 geisler , j. h. , and theodor , j. m. ( 2009 ) , hippopotamus and whale phylogeny , nature 458 : e1e5 .",
    "gue11 gunoche , a. 2011 .",
    "consensus of partitions : a constructive approach , advances in data analysis and classification , 5 : 215229 .",
    "10hol08 holder , m. t. , sukumaran , j. , and lewis , p. o. ( 2008 ) , a justification for reporting the majority - rule consensus tree in bayesian phylogenetics , syst .",
    "57(5):814821 .",
    "11jan jansson , j. , shen , c. and sung , w .- k .",
    "algorithms for the majority rule ( + ) consensus tree and the frequency difference consensus tree , in algorithms in bioinformatics ( proceedings of wabi 2013 ) , lecture notes in computer science , vol . 8126 , a. darling and j. stoye , eds . ,",
    "springer , berlin / heidelberg , 141155 .",
    "12mcm85 mcmorris , f.r .",
    "axioms for consensus functions on undirected phylogenetic trees , mathematical biosciences 74 : 1721 .",
    "mcm95 mcmorris , f.r . and powers , r.c . 1995 .",
    "the median procedure in a formal theory of consensus , siam j. discr .",
    "math . 8 : 507516 .",
    "mcm12 mcmorris , f. r. , mulder , h.m . and ortega , o. 2012 . the @xmath165-function on trees .",
    "networks , 60 : 94102 .",
    "13mcm mcmorris , f.r . and powers , r.c . 2016 .",
    "some axiomatic limitations for consensus and supertree functions on hierarchies .",
    "biol . 404 : 342347 .",
    "14sem03 semple , c. and steel , m. 2003 .",
    "oxford university press , oxford .",
    "15vel steel , m. and velasco , j. 2014 .",
    "axiomatic opportunities and obstacles for inferring a species tree from gene trees .",
    "63(5 ) : 772778 .",
    "16ste00 steel , m. , bcker , s. , and dress , a.w.m . 2000 .",
    "simple but fundamental limits for supertree and consensus tree methods .",
    "49(2 ) : 363368 .",
    "swo91 swofford , d. l. 1991 .",
    "when are phylogeny estimates from molecular and morphological data incongruent . in : phylogenetic analysis of dna sequences ( pp .",
    "295333 ) , oxford university press .",
    "the condition @xmath166 holds for strict consensus , loose consensus , majority rule , adams consensus and aho consensus .",
    "it is straightforward to verify that strict consensus and loose consensus satisfy this property . for majority rule ,",
    "suppose that @xmath167 is a cluster in @xmath41 .",
    "then @xmath167 is a cluster in more than half the trees in @xmath29 , and since @xmath167 is a cluster of @xmath41 also , @xmath167 is a cluster in more than half the trees of @xmath168 .",
    "thus , @xmath167 is a cluster of @xmath169 .",
    "conversely , if @xmath167 is not a cluster of @xmath41 , then @xmath167 is a cluster in at most half the trees in @xmath29 , and since @xmath167 is therefore not in @xmath41 , @xmath167 is a cluster in less than half the trees of @xmath168 .",
    "thus @xmath167 is not a cluster of @xmath169 .    for aho consensus ,",
    "observe that the rooted triples displayed by @xmath76 contain the set @xmath170 of rooted triples that are displayed by every tree in @xmath29 , the set of rooted triples displayed by every tree in @xmath171 equals @xmath170 and therefore : @xmath172        we establish the binary extension stability property first .",
    "the proof relies on the fact that adams consensus satisfies a type of converse to unanimity when the trees are binary .",
    "namely , if the adams tree is a binary tree then every input tree has to be identical to this tree . formally , @xmath173 to see that this holds for @xmath174 ,",
    "suppose that @xmath38 is a binary tree .",
    "then ( i ) all of the trees in @xmath29 must have exactly two maximal proper clusters , and ( ii ) the pair of maximal proper clusters of each tree in @xmath29 is the same for each tree in @xmath29 . property ( i )",
    "holds because if one tree had three maximal proper clusters , then , by construction , @xmath38 would contain at least three maximal proper clusters and so would not be binary . for property ( ii ) , observe that if there were two binary trees in @xmath29 that had a different pair of maximal clusters , say @xmath175 and @xmath176 , then at least three nonempty intersections exist in the set @xmath177 , and so , once again , @xmath38 would have at least three maximal proper clusters and so would not be binary .",
    "thus , the maximal proper clusters of @xmath38 agree with the maximal proper clusters of each tree in @xmath29 .",
    "the recursive nature of the adams consensus construction now means that this argument can be repeated at subsequent levels , to ensure that the trees in @xmath29 are all binary and identical .",
    "it follows that if @xmath79 is a binary tree @xmath1 on @xmath14 , then @xmath178 , and so each rooted triple displayed by @xmath1 is also displayed by @xmath38 , and hence @xmath1 is displayed by @xmath38 .",
    "now , since @xmath1 is binary , this means that @xmath179 , as claimed .    to establish extension stability for clusters ( i ) , notice that if @xmath14 is a cluster of @xmath38 , then , by the recursive nature of the adams consensus method , @xmath180 , which is an even stronger condition than extension stability for clusters ( i ) . for extension stability for clusters",
    "( ii ) , if @xmath14 is a cluster of each tree in @xmath29 , then @xmath14 is a cluster of @xmath38 , and so ( again by the recursive nature of the adams consensus method ) we have @xmath180 , which establishes the property .      for @xmath46 ,",
    "let @xmath181 be a list of the distinct trees that appear at least once in @xmath29 ( so that @xmath182 ) .",
    "thus @xmath183 for some surjection @xmath184 .",
    "we will show that @xmath185 , which establishes the lemma . since @xmath22 is associatively stable , we can write @xmath186 , and since @xmath22 satisfies commutatively it follows that @xmath187 , where @xmath188 is the number of times that tree @xmath189 appears in @xmath29 , and @xmath190 [ @xmath188 times ] .",
    "unanimity now ensures that @xmath191 for all @xmath192 , so @xmath185 as claimed ."
  ],
  "abstract_text": [
    "<S> consensus methods are widely used for combining phylogenetic trees into a single estimate of the evolutionary tree for a group of species . as more taxa </S>",
    "<S> are added , the new source trees may begin to tell a different evolutionary story when restricted to the original set of taxa . </S>",
    "<S> however , if the new trees , restricted to the original set of taxa , were to agree exactly with the earlier trees , then we might hope that their consensus would either agree with or resolve the original consensus tree . in this paper </S>",
    "<S> , we ask under what conditions consensus methods exist that are ` future proof ' in this sense . while we show that some methods ( e.g. adams consensus ) have this property for specific types of input , we also establish a rather surprising ` no - go ' theorem : </S>",
    "<S> there is no ` reasonable ' consensus method that satisfies the future - proofing property in general . </S>",
    "<S> we then investigate a second notion of ` future proofing ' for consensus methods , in which trees ( rather than taxa ) are added , and establish some positive and negative results . </S>",
    "<S> we end with some questions for future work . </S>"
  ]
}