{
  "article_text": [
    "flow and transport through highly heterogeneous porous and fractured media may be poorly predicted with equivalent homogeneous models that are characterized by effective hydraulic parameters . the impact of heterogeneity manifests in heavy tails of solute breakthrough curves or recovery curves during water flooding of an oil reservoir which is not captured well by such models .",
    "this behavior may originate from the local non - equilibrium of the flow or transport processes which are observed on a large scale .",
    "transport behavior caused by local non - equilibrium has been investigated for solute @xcite and heat @xcite transport in groundwater and for two phase flow processes like oil recovery @xcite or unsaturated flow @xcite . when flow and transport is considered in a medium where non - equilibrium behavior is relevant",
    ", the full porous medium structure needs in principle to be represented in a flow or transport model , in order to capture the local processes . for a fractured rock",
    "this means that fractures and rock matrix need to be resolved in a model , which is computationally very expensive .",
    "as , however , tailing often needs to be captured in a model prediction , large effort has been spent to develop simplified modeling approaches that are less expensive , but can still capture the main features .",
    "this applies also to two - phase flow problems , such as modeling of oil recovery .",
    "the classical approaches on darcy scale to model flow and transport in fracture networks are the equivalent porous media ( epm ) approach , the discrete fracture ( df ) approach and the multi - continuum approach @xcite . for the epm",
    ", the fractures are modeled together with the surrounding rock matrix as an equivalent porous media @xcite and are thus represented by a variation of flow or transport parameters of the rock matrix locally .",
    "these approaches are often too simplified to capture tailing effects . for the df approach ,",
    "the rock matrix continuum is superimposed by lower dimensional elements , which represent the fractures .",
    "when applying a numerical scheme to solve the resulting models for the df approach , a fine discretization is required to accurately represent the local differences in flow and transport parameters , especially at the interfaces between matrix and fractures @xcite .",
    "multi - continua approaches conceptualize the fractured medium in terms of a mobile primary continuum , the fracture network , and a series of less mobile secondary continua , the matrix blocks , which communicate with the primary continuum through properly posed continuity conditions at the interfaces between the continua .",
    "mass transfer processes in the primary continuum equilibrate fast over the scale of a representative elementary volume and therefore are represented through a spatial average .",
    "thus , the complex spatial structure of the fracture network is represented in an effective way as an equivalent porous medium , while the slower processes in the secondary continua participate in the average mass transfer in terms of non - local sink - source terms .",
    "common multi - continua models @xcite include the dual continua ( dc ) and triple continua ( tc ) @xcite and the multiple interacting continua ( minc ) models @xcite .",
    "dual porosity ( dp ) models or mobile - immobile models are a special case of the dc model . in fractured rock",
    "it is obvious to distinguish two zones : the fracture network and the matrix blocks .",
    "the fracture network represents the mobile zone , where `` fast '' flow or transport processes takes place , and the matrix blocks represent immobile zones , characterized by slow exchange processes . when the fracture network is sufficiently well connected @xcite , so that an rev for the fracture network can be defined @xcite , it is feasible to model the fracture network and the matrix blocks by applying a mass balance for each zone separately . the crucial point in this type of models is the modeling of the processes in the immobile zone respectively the exchange fluxes between mobile and immobile zone .",
    "the dp model can be solved numerically for each zone directly @xcite or can be simplified using transfer functions or the multirate mass transfer ( mrmt ) approach .    in the transfer function approach ( for example @xcite )",
    ", the exchange between mobile and immobile zone is approximated as a linear or nonlinear single rate mass transfer and the immobile zone is represented as a fully mixed system .",
    "different types of transfer functions have been reported for diffusive solute transport , capillary counter - current flow during two - phase flow or flow driven by gravity @xcite .",
    "a mrmt approach is obtained if the response of the immobile zone is modeled by a sink / source term that is non - local in time .",
    "the kernel of the time integration can be considered a memory function .",
    "the memory function can be expanded into a sum of exponential functions @xcite .",
    "exponential functions are the analytical solution for single rate transfer processes .",
    "this means that , for example , diffusion like mass transfer can be modeled by a distribution of single rate transfer processes , hence mrmt model @xcite .",
    "the mrmt and transfer function approaches differ from each other when applied to fracture networks . for the transfer function approach",
    "there is one transfer function or one single rate transfer process for each block size @xcite .",
    "the block size distribution is then modeled by a superposition of transfer functions and the resulting model is referred as multi rate double porosity ( mrdp ) model .",
    "mrmt models can also be represented by superpositions , however , the superposition does not necessarily represent a superposition over block sizes , but the superposition is also due to the expansion of the memory function into exponentials to capture dynamics different from single rate transfer .",
    "naturally , a superposition over different block sizes can be carried out on top of that .    despite the variety of different approaches to model two - phase flow in fractures in a simplified way , while capturing the effect of the heterogeneous structure , they are not much applied in practice .",
    "one reason is that more parameters are required than for a two - phase flow model in a homogeneous medium and it is not so clear how these parameters could be estimated .",
    "this is in particular true if fracture networks are considered .",
    "also , concepts are often tested with media with one single fracture ( for example @xcite ) , but not often for fracture networks .",
    "geiger et al .",
    "@xcite studied a fracture network without taking heterogeneity in the capillary forces into account .    in this contribution",
    "we show the applicability of a mrmt model ( presented in @xcite ) for immiscible two phase flow to two dimensional fracture networks , where the flow in the fracture network is simplified by a single continuum .",
    "we present timescales for characterizing flow in fracture networks to quantify conditions where the mrmt model is needed to make good predictions of recovery .",
    "we also make suggestions how parameters of the mrmt model for a fracture network can be estimated .",
    "the parameters are calculated by analyzing fracture and matrix geometry .",
    "we show two approaches to approximate the global memory functions for the mrmt model , both of them based on a superposition of functions obtained from a scaling of a reference memory function . in the one case",
    "the reference memory function is calculated numerically and in the other case it is approximated by a truncated power law function . to demonstrate the methods",
    ", we consider a forced imbibition scenario in a fracture network and spontaneous imbibition driven by capillary pressure in the matrix blocks .",
    "we compare the results of the one dimensional mrmt model with estimated parameters and the results of a full two dimensional two phase flow model applying the epm approach , where the code dumux @xcite is used .",
    "although we focus on fractured media , all concepts can be easily transferred to highly heterogeneous porous media in general .",
    "the heterogeneous medium would be split into a fast domain ( equivalent to the fracture domain ) and a stagnant domain ( equivalent to the matrix domain ) .",
    "this paper is organized as follows . in the second section",
    "we show the equations for two phase flow in porous media and the upscaled mrmt model . in section 3 , we discuss a scaling approach to calculate the parameters for the mrmt model . in section 4 , we apply the mrmt model with estimated parameters to different fracture networks and conclude with a discussion . in the appendix",
    ", we show how to numerically solve the mrmt as mrdp model .",
    "schematic representation of fractured media.,width=377 ]",
    "in this section , we outline the two - phase flow equations that describe immiscible displacement in fractured and porous media .",
    "we then generalize the multi - rate mass transfer model derived in @xcite to more realistic media , which are characterized by a distribution of immobile regions with different characteristic capillary diffusion time scales .",
    "we model the horizontal flow of two incompressible and immiscible fluids in a rigid porous media .",
    "based on the surface tension , one fluid is referred to as the wetting phase ( index @xmath0 , e.g. , water ) and the other one as the non - wetting phase ( index @xmath1 , e.g. , oil ) .",
    "each phase is described by a phase pressure @xmath2 ( @xmath3 ) and normalized saturation @xmath4 ( - ) , with @xmath5 , which fulfill @xmath6 .",
    "conservation of mass for each fluid is expressed as    [ full : model ] @xmath7 where @xmath8 ( - ) is porosity .",
    "the specific discharge @xmath9 ( @xmath10 ) for each phase is modeled by darcy s law neglecting gravity @xmath11 where @xmath12 ( @xmath13 ) is the intrinsic permeability tensor , @xmath14 ( - ) is the relative permeability of phase @xmath15 , and @xmath16 its viscosity ( @xmath17 ) .",
    "the capillary pressure is defined as the pressure difference between non - wetting and wetting phase and is assumed to be a unique function of saturation , @xmath18    equations   are referred below as the full model .",
    "they are the starting point for the derivation of the mrmt model , which is outlined below . a detailed derivation from the full model to the mrmt model by homogenization theory",
    "is presented in @xcite .    by introducing the total darcy velocity @xmath19",
    ", the full model   can be cast in the fractional flow formulation for the saturation of the wetting phase @xmath20 as in  @xcite @xmath21 where the fractional flow functions are defined as @xmath22 and @xmath23 .",
    "the phase mobilities are @xmath24 and the total mobility is @xmath25 .",
    "the incompressibility of each fluid phase gives for the total darcy velocity @xmath26 .",
    "as outlined in the introduction , the mrmt model divides the fractured media into a mobile zone @xmath27 , the connected primary continuum , and a suite of immobile zones @xmath28 , the secondary continua .",
    "quantities referring to the fracture domain in the following are marked by the subscript @xmath29 , while quantities referring to the matrix domain are denoted by a subscript @xmath30 .",
    "quantities referring to the secondary continuum @xmath31 are marked by the subscript @xmath31 .    in the fracture network",
    "the flow is assumed to be viscous dominated , while in the matrix blocks spontaneous countercurrent imbibition is assumed to be the dominating flow process , so that viscous flow can be neglected .",
    "the fracture and matrix continua communicate through the continuity of capillary pressure and fluxes at their interface .",
    "the non - local two phase flow model presented in  @xcite is derived from   by applying homogenization theory to a media which consists of a fracture continuum and a single class of immobile continua characterized by the same geometry and physical characteristics .",
    "we generalize here this non - local model to account for mass exchange between a mobile continuum and a spectrum of immobile continua characterized by multiple exchange rates .",
    "the mass balance equation for the average fracture saturation @xmath32 in such a medium is given by @xmath33 where the angular brackets denote the average over the immobile zone of type @xmath31 ( cf .",
    "the single squares in figure 1 ) , @xmath34 the distribution density @xmath35 measures the relative frequency of immobile zones of type @xmath31 which are characterized by the same geometry and physical properties .",
    "the average total darcy velocity in the fracture continuum is denoted by @xmath36 .",
    "we defined the effective volume ratio @xmath37 with @xmath38 intrinsic porosity and @xmath39 total volume of the fracture domain , and @xmath40 and @xmath41 the average porosity and total volume of the matrix domain .",
    "the effective volume ratio of the immobile zone of type @xmath31 is given by @xmath42 with @xmath43 the intrinsic porosity of the immobile zone of type @xmath31 .",
    "the saturation @xmath44 of the immobile continuum @xmath31 is given by the mass conservation equation @xmath45 = 0 , \\label{eq : matrixdiffusion}\\end{aligned}\\ ] ] where the non - linear capillary diffusivity is defined as in  @xcite @xmath46 the capillary pressure - saturation relationship in the immobile zones of type @xmath31 is given by @xmath47 , which is proportional to @xmath48 ( leverett scaling ) with @xmath49 the permeability of immobiles zones of type @xmath31 . as a result , we have the scaling of @xmath50 with permeability .",
    "the boundary conditions for each matrix block @xmath51 are imposed by the saturation in the surrounding fracture @xmath52 i.e. , continuous capillary pressure over the interface between fracture and matrix , which thus assumes local capillary equilibrium in the medium .",
    "the initial saturation is denoted by @xmath53 .",
    "equation ( [ eq : matrixdiffusion ] ) quantifies the spontaneous imbibition of the wetting fluid into the matrix and needs to be solved for the given geometry of the individual matrix block .",
    "it is a non - linear diffusion equation , whose solutions have the characteristic boltzmann scaling , i.e. , a saturation front scales with @xmath54 .",
    "as outlined in  @xcite , the flux term in   is linearized by approximating the capillary diffusivity @xmath55 by a suitably chosen constant value , @xmath56 constant .",
    "the determination of an equivalent constant diffusion coefficient from the non - linear diffusion problem is discussed in section  [ sec : capillarytimescales ] . this substitution yields a linear diffusion equation for the saturation @xmath44 of immobile zones of type @xmath31 , @xmath57 = 0 . \\label{eqim3}\\end{aligned}\\ ] ] the linearized diffusion equation   can be solved using the method of green s functions  @xcite .",
    "this gives for the spatially averaged saturation in regions @xmath31 @xmath58 where the boundary saturation @xmath59\\}$ ] is enforced by continuity of capillary pressure .",
    "the green s function @xmath60 solves the linearized problem   for the unit pulse @xmath61 on the boundary and the initial condition of @xmath62 .",
    "the local memory function is defined by the spatial average over the green s function as @xmath63 inserting   into the right side of   gives the following closed form equation for @xmath32 @xmath64 where we defined the global memory function @xmath65 by @xmath66 explicit analytical solutions for the local memory functions @xmath67 can be obtained for slabs , cylinders and spheres  @xcite . for more complex geometries of the matrix domain @xmath68 , the local memory functions can be obtained numerically  @xcite .",
    "( [ upscaled : model ] ) is the upscaled model for the full problem described in section 2.1 .",
    "it has only one primary variable , the fracture saturation @xmath32 , and it is parameterized with the two - phase flow parameters for the fracture and with the memory function @xmath65 . the memory function is thus the core of the upscaled model .",
    "in the following we discuss the characteristic time scales of the mobile fracture domain and the immobile matrix domains , first in the light of the application limits of the mrmt approach , and second to relate the geometrical and physical properties of the immobile domains to the global memory function .      in this subsection , we discuss the conditions for the assumptions made in the mrmt model posed in the previous section : viscous dominated fast flow in the fracture network and capillary dominated slow flow in the matrix blocks . to this end",
    ", we suggest a definition of time scales , which characterize fracture and matrix flow .",
    "the characteristic time scale for the viscosity dominated fluid displacement in the fracture domain is given by @xmath69 where @xmath70 is the cross - sectional area of the fracture network available for injection , and @xmath71 is the total flux at the inlet boundary , and @xmath72 the saturation at breakthrough averaged over the whole fracture domain .",
    "the viscous time scale @xmath73 compares the volume available for the wetting fluid to the the volumetric flow rate in the fracture domain .",
    "this corresponds to the characteristic breakthrough time at the outlet .",
    "the mean saturation @xmath72 before breakthrough can be found by analyzing the fractional flow function as described in @xcite or can be estimated by @xmath74 , when the rarefaction wave of the displacement solution is negligible .",
    "the viscous time scale @xmath75 for the matrix blocks may be related to @xmath73 by @xmath76 .",
    "thus , viscous flow in the matrix is negligible for @xmath77 , provided that flow in the fractures is viscous dominated .",
    "the capillary diffusion time scales @xmath78 of an immobile region of type @xmath31 can be estimated from an analytical solution for countercurrent imbibition as described by the non - linear diffusion equation   with the boundary conditions given by  . as pointed out above",
    ", a saturation front displays the characteristic @xmath54 scaling of a diffusive front .",
    "mcworther and sunada @xcite give an analytical solution for the displacement of a saturation isoline for imbibition into a slab characterized by porosity @xmath43 and diffusivity @xmath79 , @xmath80 where @xmath81 denotes the position of the invading front .",
    "it is specific for a given saturation .",
    "the functions @xmath82 and @xmath83 are defined in @xcite implicitly by @xmath84 we obtain a characteristic front depth @xmath85 , and with that a characteristic time scale by averaging   over saturation from the initial saturation @xmath86 to the boundary saturation @xmath87 , which gives @xmath88 where we set @xmath89 and @xmath90 .",
    "equation   sets the equivalent constant diffusivity @xmath91 in  .",
    "note that @xmath91 scales with hydraulic conductivity as @xmath92 .",
    "we define now the characteristic capillary diffusion time scale as time @xmath93 at which the average front has reached the length scale @xmath94 such that @xmath95 notice that this capillary diffusion time scale is derived from a 1d solution , where counter current flow into one block happens from two sides . in a 2d block , where counter current flow occurs from four sides , the capillary diffusion time scale yields @xmath96 the characteristic length scale for the matrix is the shortest distance that is passed by the capillary counter current displacement front , until two front positions meet .",
    "it is can be estimated by @xcite @xmath97 where @xmath98 is the volume of the immobile region of type @xmath31 .",
    "it has @xmath99 faces @xmath100 , each of which has the area @xmath101 and a distance @xmath102 to the volumetric center of the matrix block .",
    "for a two dimensional rectangular block with a width @xmath103 and length @xmath104 one obtains @xmath105 note that this implies that matrix blocks can be anisotropic . for the mrmt model , the non - equilibrium aspects of the immobile zone , this means the time behavior before it equilibrates with the mobile zone , is important because this is when the matrix - fracture transfer strongly influences the front speed in the fracture network .",
    "we therefore use the length scale   to derive the capillary diffusion time scale @xmath78  , which reflects this non - equilibrium aspects well .",
    "this is discussed in more detail in [ comparison : timescales ] .",
    "the global memory function @xmath65 in is at the heart of the mrmt modeling approach .",
    "it encodes the mass transfer between mobile and immobile zones , and its structure reflects the geometry and heterogeneity of the immobile regions  @xcite that are no longer resolved in the upscaled model .",
    "as indicated by   and  , the global memory function can in principle be determined by ( i ) calculating the local memory functions @xmath106 for the matrix geometry of each block type @xmath31 of the fracture network , and ( ii ) determining the weighted sum over the local memory functions using the volume fractions of each type @xmath31 of immobile zones .",
    "the most general and accurate method would be to ( numerically ) determine the local memory function @xmath106 for each matrix geometry and to average them .",
    "although the calculation of the local memory functions needs to be done only once at the beginning of the simulation , this method is not very practical .",
    "below , we present two different ways to estimate the local memory functions .",
    "both methods are based on a scaling approach for the local memory functions @xmath106 .",
    "this reduces the effort to calculating only one local reference memory function @xmath107 .",
    "the distribution over the local functions is obtained by rescaling the reference function with the capillary diffusion time scales @xmath78 obtained from the matrix geometry of the single blocks .",
    "the local reference memory function @xmath107 is here calculated with two different methods .",
    "for the first method , it is calculated on a reference block numerically .",
    "the second method is based on approximating the local memory functions by an analytical function .    the local memory functions @xmath106 scale with respect to the characteristic capillary diffusion time scale @xmath78 determined in the previous section .",
    "this can be seen as follows .",
    "equation   for the green function @xmath60 can be non - dimensionalized by scaling @xmath108 and @xmath109 with @xmath94 and @xmath93 given by   and  .",
    "thus we obtain for the green function the governing equation @xmath110 with the boundary condition @xmath111 . the local memory function",
    "is then given by @xmath112 \\approx \\frac{1}{t_\\omega } \\hat \\varphi(t / t_\\omega).\\end{aligned}\\ ] ] note that the term in the square brackets depends on the properties of the immobile zone predominantly through the time scale @xmath93 .",
    "if the immobile zones have the same topological characteristics , which we assume is the case , we can in good approximation disregard the specificities of the particular geometry of the immobile zones .",
    "thus we approximate the memory function by the scaling form on the right side of  , which defines the scaling function @xmath113 .",
    "this scaling function can then be estimated from the memory function for a single immobile domain @xmath114 as @xmath115 the memory function for an immobile domain @xmath114 behaves as @xmath116 for @xmath117 and decreases exponentially fast for @xmath118  @xcite .",
    "thus , the scaling function @xmath119 shows the @xmath120 decay for @xmath121 and a sharper decrease for @xmath122 .    the global memory function",
    "is now given in terms of the scaling function @xmath119 as @xmath123 where @xmath124 denotes the probability density function ( pdf ) of characteristic capillary time scales .",
    "it can be expressed in terms of the distributions of the geometric and physical characteristics of the immobile zones through having the explicit expression   for @xmath93 . in practice ,",
    "the integral will be transformed to a sum over all matrix block types .",
    "if the matrix blocks have the same permeability @xmath125 , the dependency of the local memory functions on the capillary diffusion time scale @xmath78 can be reformulated into a dependency on the characteristic length scale @xmath126 , as defined in eq .",
    "( [ eq : ma ] ) .",
    "the local memory function @xmath127 can then be obtained from the local memory function @xmath128 @xmath129    in general , the pdf of time scales , @xmath124 , can be related to the pdf of matrix block properties , which can be estimated directly from information about the fracture network . for simplicity ,",
    "we assume that the intrinsic immobile porosities are the same for all regions such that @xmath130 .",
    "furthermore we assume that the effective capillary diffusion depends on the physical properties of the medium only through its dependence on the hydraulic conductivity such that @xmath131 with @xmath83 a constant .",
    "the time scale @xmath93 then reads as @xmath132 we write the in general coupled pdf @xmath133 of @xmath94 and @xmath49 as @xmath134 where @xmath135 is the conditional pdf of @xmath136 given @xmath137 . thus , the pdf of time scales can be written as @xmath138 if the immobile regions are all of equal conductivity but variable extensions , the distribution of characteristic time scales simplifies to @xmath139 note that the flow behavior is controlled by the distribution of mass transfer time scales @xmath124 , in particular for large times .",
    "long residence times can be caused equally by low hydraulic conductivities and large sizes of the immobile regions .",
    "for the sake of computational efficiency , the test cases studied in the following consider a distribution of characteristic matrix length scales while the hydraulic conductivity is kept constant .",
    "besides the pdf for capillary diffusion time scale distribution , the reference memory function @xmath119 needs to be determined in order to calculate the global memory function from eq .",
    "( [ eq : scaling ] ) .",
    "we suggest here two different methods to do that .    in the first method",
    ", the local memory function @xmath128 is obtained from the numerical solution of the capillary diffusion problem   for a single immobile region of type @xmath114 .",
    "the pragmatical aspects are outlined in  [ num : memoryfunction ] .",
    "we use then the scaling relation   in order to determine @xmath119 from the numerically calculated local memory function @xmath128 .",
    "the second method approximates @xmath140 directly by the parametric form @xmath141 where @xmath142 denotes the gamma function .",
    "the scaling function   has similar characteristics as the scaling function obtained from the first method through  , but a simple analytical form . with this approximation ,",
    "no numerical solutions are needed .",
    "notice that the cut - off behavior of the local memory function for the non - linear diffusion problem is different from the exponential decay of the surrogate scaling form  .",
    "this is due to the fact that the non - linear diffusion coefficient   decreases with decreasing saturation .",
    "this leads to a smoother break - off behavior than the exponential cut - off of  @xcite .",
    "this is illustrated in figure  [ fig : memoryfunctions ] , where a local memory function is shown together with its approximation by a truncated power law .",
    "also shown in the figure are the global memory functions for a test example ( discussed later ) , resulting from the superposition of the local ones .",
    "memory functions with a single capillary diffusion time scale @xmath78 and memory functions for a distribution of capillary diffusion timescales from example 2 in section  [ sec : test - cases ] , width=377 ]      the mrmt model is strictly valid only for the case that flow in the fractures is viscous dominated and that flow in the matrix is capillary dominated , with a time scale that is comparable or larger than the viscous time scale in the fractures . to quantify flow regimes , the time scales defined by ( [ eq : tqf ] ) for viscous forces and by ( [ eq : td_thiswork ] ) for capillary forces have to be compared .    when the viscous time scale in the fracture network is much smaller than the capillary diffusion time scale in the fracture network , i.e. , @xmath143 , viscous flow dominates and capillary forces can be disregarded in the fractures .",
    "whether viscous forces in the matrix are relevant or not , depends on the permeability contrast , as outlined above .    when the flow in the fracture is faster than countercurrent flow in the matrix , @xmath144 , the matrix blocks are completely surrounded by the wetting phase in a short time compared to the typical relaxation time for the matrix counter current flow .",
    "if the time scales are in the same range , this condition is not fulfilled and the assumptions made to calculate the exchange fluxes are not exactly met .",
    "if the time scales are strongly separated ( @xmath145 ) and one is only interested in the process for times smaller than @xmath78 , one could avoid a mrmt model and simply model flow in the fracture network only .    in case that the flow in the matrix is faster than the flow in the fracture , @xmath146 , local equilibrium conditions hold and a single equivalent porous medium describes the averaged flow well . in this case a mrmt approach is not necessary .",
    "we demonstrate the applicability of the mrmt model for two - phase flow in fracture networks with two illustrative examples . with the the first example we want to demonstrate the applicability of the mrmt model   to fracture networks in general , using the criteria discussed above . with the second example , we want to show that the model works for complex fracture networks and that using an approximate memory function by scaling a reference function either obtained numerically or approximated by a truncated power law leads to useful predictions of recovery curves . to validate the simulation results of the mrmt model , we compare these results to the results of a full implicit 2d model   implemented in dumux @xcite .",
    "top : domain 1 is a simple fracture network for the first example . bottom : domain 2 is the complex fracture network for the second example .",
    "the fractures are light gray and the matrix blocks are dark gray .",
    "we compare the results of the models in the observation volume only to minimize boundary effects .",
    ", width=377 ]    .spatial parameters for both examples . the capillary pressure curves and the relative permeability",
    "are parameterized with the mualem - van genuchten model .",
    "[ tab : spatial - parameters ] [ cols= \" < , < , < , < , < \" , ]     the fractured media for both examples are shown in figure [ fig : fracture - networks ] and the flow parameters can be found in table [ tab : spatial - parameters ] and [ tab : parameters - for - example-1 ] . for the examples we simulate oil recovery from these fractured media during a water flooding of the reservoir .",
    "water ( density @xmath147 , viscosity @xmath148 ) is the wetting fluid and oil ( @xmath149 , @xmath150 ) is the non - wetting fluid . at the beginning ,",
    "the fractured media are almost filled with oil and matrix and fracture are in capillary equilibrium .",
    "the water saturation in the matrix blocks is @xmath151 and in the fracture network @xmath152 .",
    "the boundary conditions for the fracture network are a constant inflow for the wetting phase ( @xmath153 m/s for the simple and @xmath154 m/s for the complex fracture network ) over the fracture sections of the left boundary and a no - flow boundary for the non - wetting phase on the fracture at the left boundary . on the fracture at the right boundary",
    ", there is a constant non - wetting pressure @xmath155pa and a constant water saturation of @xmath156 .",
    "the upper and the lower boundary and on all matrix boundaries are no - flow boundaries for both phases . for the full 2d model the fracture networks",
    "as shown in figure [ fig : fracture - networks ] are used as parameter fields using the boundary and initial conditions as described above . for the mrmt model",
    ", we simulate an equivalent 1d fracture domain with homogeneous parameters .",
    "the parameters for the mrmt model are calculated from the structure in the observation volume ( see figure [ fig : fracture - networks ] ) .",
    "an image analysis of the structure gives the total volumes @xmath157 and @xmath158 of the fracture respectively of the matrix , the cross - sectional area @xmath70 of the fracture network at the inlet as well as the width @xmath103 and length @xmath104 of each matrix block .",
    "these values are needed to calculate the parameters for the mrmt model such as the effective volume ratio @xmath159 , the total darcy velocity @xmath160 and the local memory functions @xmath127 .",
    "the global memory function is then calculated from all local memory functions using   as @xmath161 where the integral in eq .",
    "( [ eq : scaling ] ) is now a sum and the distribution function @xmath162 is now the relative number of blocks of type @xmath31 , @xmath163 .",
    "the boundary condition for the mrmt model is a saturation of @xmath164 at the left boundary .",
    "this boundary condition can be found from the fractional flow function for a constant inflow for the wetting phase and a no - flow boundary for the non - wetting phase .    for the mrmt model of the simple fracture network the fracture",
    "is discretized into 300 volume elements resulting in a cell size of @xmath165 cm . for the mrmt model of the complex fracture network",
    "the fracture is discretized into 600 volume elements resulting in a cell size of @xmath166 cm .",
    "the memory functions are expanded into exponential functions , making the model equivalent to one with a mobile continuum and a number of n independent immobile single rate transfer continua . the matrix is therefore represented by another n@xmath167300 respectively n@xmath167600 cells , where n is the number of immobile boxes . for the full 2d model the domain for the simple fracture network is discretized into 180 ( perpendicular to the flow direction ) @xmath167 3000 ( in flow direction ) elements resulting in a cell size of @xmath168 cm .",
    "the domain for the complex fracture network is discretized in 445 @xmath167 1422 elements resulting in a cell size of @xmath169 cm .    as simulation results the wetting fluid saturation distribution from the detailed simulation , the breakthrough curve , here defined as the averaged non - wetting saturation in the fracture at the right boundary of the observation volume and the oil recovery @xmath170",
    "are analyzed .",
    "the oil recovery is the percentage of removable oil , that is recovered from the full domain .",
    "the recovery is    @xmath171    here @xmath172 and @xmath173 are the movable water saturation , calculated as    @xmath174    where @xmath157 and @xmath158 are the total volumes of the fractures respectively the total volume of the matrix blocks . in the examples these are the volume of the fractures",
    "respectively the volume of the matrix blocks in the observed volume as defined in figure [ fig : fracture - networks ] .",
    "@xmath175 is the maximal water saturation . in these examples",
    "the maximal water saturation is @xmath176 in the fracture network and in the matrix blocks .      in the first example , we want to show the applicability of the model by comparing the full 2d model to the 1d mrmt model for different ratios of viscous time scale in the fracture and the capillary diffusion time scale in the matrix blocks .",
    "we keep the viscous timescale @xmath73 for the fracture constant and vary the timescale @xmath78 for the capillary flow in the matrix blocks by varying the intrinsic permeability in the matrix block .",
    "we show four different cases as given in table [ tab : parameters - for - example-1 ] . for the first case ( a ) we have a faster flow in the matrix than in the fracture , @xmath177 and for the second case ( b ) the time scales are comparable @xmath178 . for the third and fourth cases ( c1 , c2 ) we choose the parameters such that @xmath179 , and expect that the flow in the fracture is much faster than the flow in the matrix .",
    "the parameters for the mrmt model can be found from the geometry of the fracture network and the flow parameters .",
    "we calculate @xmath180 for the volume ratio and @xmath181 for the flow velocity . in this study case ,",
    "all local memory functions @xmath127 are calculated numerically ( see [ num : memoryfunction ] for details ) . for the numerical simulation",
    ", we use a cartesian grid with a cell size of @xmath182 . the global memory function",
    "is then calculated from  ( [ eq : globalmemory2 ] ) .",
    "saturation distribution for cases a , b , c1 and c2 with increasing capillary diffusion time scale from top to bottom , at the time when the mass of oil in the fracture is reduced to 50% in the observed region compared to the initial state .",
    "this takes place for a at @xmath183s , for b at @xmath184s , for c1 at @xmath185 and for c2 at @xmath186s.,width=453 ]     saturation distribution for cases a , b , c1 and c2 with increasing capillary diffusion time scale from top to bottom , at the time when the mass of oil in the matrix is reduced to 50% in the observed region compared to the initial state .",
    "this takes place for a at @xmath187s , for b at @xmath188s , for c1 at @xmath189s and for c2 at @xmath190s.,width=453 ]    the saturation distributions from the full 2d models can be found in figures [ fig : sat - profiles - fracture-50 ] and [ fig : sat - profiles - matrix-50 ] . in figure",
    "[ fig : sat - profiles - fracture-50 ] we show the saturation distribution , when the mass of oil in the fracture is reduced to 50% compared to the initial state and in figure [ fig : sat - profiles - matrix-50 ] we show the saturation distribution , when the mass of oil in the matrix is reduced to 50% compared to the initial state to verify the time scales .",
    "the results of the mrmt model and the full 2d model can be compared in figure [ fig : results_simple ] .",
    "breakthrough curve ( top ) and recovery ( bottom ) for the full 2d models and the mrmt models for the first example .",
    ", width=377 ]    breakthrough curve ( top ) and recovery ( bottom ) for the full 2d models and the mrmt models for the first example . ,",
    "width=377 ]    as expected from the time scales in table [ tab : parameters - for - example-1 ] , we find two different types of flow in the fracture network ( see figures [ fig : sat - profiles - fracture-50 ] and [ fig : sat - profiles - matrix-50 ] ) . in the cases",
    "c1 and c2 ( table [ tab : parameters - for - example-1 ] ) , the flow in the fracture is faster than the flow in the matrix .",
    "the fracture fills up first and the matrix blocks fill up after the breakthrough .",
    "it should be noted that although there are different matrix block sizes in the fracture network ( see figure [ fig : fracture - networks ] ) , the time scale for filling due to capillary counter current flow is almost the same for all of them .",
    "the shortest length scale of the matrix blocks is the distance to the outer boundaries , which is the same for all matrix blocks .",
    "the tailing ( see figure [ fig : results_simple ] ) is caused by an interaction of matrix - fracture transfer and rarefaction in the fracture network . as the capillary diffusion time scale @xmath78 is representative for all matrix blocks ,",
    "it predicts when the recovery in the full system is almost complete .",
    "the tailing in the breakthrough curves in figure [ fig : results_simple ] have for this reason all the same slope in the log - log plot ( caused by the rarefaction ) and break off at different times , which correspond in the case c1 and c2 to the capillary diffusion time scale @xmath78 ( @xmath191 s for c1 and @xmath192 s for c2 ) . in case",
    "a and b this time scale would be before breakthrough time .",
    "the resulting non - equilibrium flow behavior is well represented by the presented mrmt model .    in the cases",
    "a and b ( table [ tab : parameters - for - example-1 ] ) , where the flow in the fracture is equally fast or slower than the flow in matrix , the displacement front in the fracture stops when it touches a matrix block , until this matrix block is filled up and continues to move after that .",
    "this becomes apparent in figures [ fig : sat - profiles - fracture-50 ] and [ fig : sat - profiles - matrix-50 ] . here",
    "the flow in the matrix is unidirectional .",
    "when comparing the recovery curves in figure [ fig : results_simple ] it can be seen that , despite the questionable approximation of the matrix flow as counter - current , the mrmt model still gives a good representation of the process , also for case b. the flow behavior in the fracture network for this case can be modeled with an equilibrium model , as can clearly be observed in figures [ fig : sat - profiles - fracture-50 ] and [ fig : sat - profiles - matrix-50 ] , and there is no need for the mrmt model .",
    "an equilibrium model is just a simpler option .",
    "however , we would like to stress that the mrmt model , although in this case more complex than needed , does make good predictions of the averaged flow .",
    "the timescales that are here suggested differentiate between these flow behaviors and can be used to estimate the flow regime .",
    "the capillary diffusion time scale characterizes the flow for the matrix well and the length scale ( [ eq : ma ] ) of ma et al .",
    "@xcite gives a good estimate for the relevant length scale of the matrix blocks that is needed to estimate the time scale for counter current flow .",
    "this capillary diffusion time scale @xmath78 can be used to parameterizes the local memory function in the matrix block and will be used in the estimation suggested in the next section .      in the second example",
    "we demonstrate the scaling approaches to approximate the memory functions .",
    "the benefits of this mrmt model emerge for broad distributions of local capillary diffusion time scales .",
    "these time scales depend on different properties of the matrix blocks such as the characteristic length scale , the intrinsic permeability or the porosity . for the sake of computational efficiency we focus on the variability of length scales of the matrix blocks and choose a simple geometry for the fracture network .",
    "the resulting complex fracture network can be found in figure  [ fig : fracture - networks ] .",
    "this network seems artificial , however , we would like to stress that a more realistic representation of the shapes of the matrix blocks would not lead to a very different distribution of characteristic length scales or a qualitatively different breakthrough curve ( tested with a smaller test case and not shown ) .",
    "however , it would have been computationally too expensive , considering that the calculations shown took several months on a computer cluster .",
    "also , one could have included a variability of permeabilities and other parameters in the matrix blocks .",
    "this leads , however , to very slow convergence of the numerical simulations and would not add anything to the distribution of capillary diffusion time scales .",
    "the characteristic length scales in our test example vary over one order of magnitude .",
    "this results in a distribution of capillary diffusion time scales over two orders of magnitude as shown in figure  [ fig : histogramm ]",
    ". these capillary diffusion time scales @xmath78 are larger than the advective timescale @xmath73 . in this regard",
    "this example is similar to the first test cases c1 and c2 .    for this complex fracture network , it is computationally expensive to calculate all local memory functions numerically",
    ". therefore we demonstrate the two different methods introduced before . for the first method",
    "we calculate one local memory function for a reference block @xmath114 numerically ( see [ num : memoryfunction ] for details ) .",
    "then we approximate all other local memory functions by scaling this reference memory function @xmath128 with the associated characteristic length scales of the matrix blocks .",
    "we evaluate this by numerical interpolation .",
    "for the characteristic length ( [ eq : mablock ] ) , we estimate the length and width of each block in the fracture network with image analysis .    for the second method",
    ", we approximate the local memory functions by a truncated power law , which is given by ( [ eq : truncated_power_law ] ) and ( [ scaling ] ) as @xmath193 here we calculate the mcworther solution once to calculate the capillary diffusion time scales @xmath78 in the matrix blocks , but we do not need to do any numerical simulations on 2d grids to find the local memory functions .    for both methods , the global memory function is calculated with  .",
    "the other parameters for the mrmt model can be found from the geometry of the fracture network and the flow parameters .",
    "the volume ratio is @xmath194 and the mean total darcy velocity is @xmath195 m/s .    for comparison we also set up the mrmt model with a memory function where only one local memory function derived with a single capillary diffusion time scale @xmath196",
    "is used as global memory function .",
    "this means , no superposition is carried out , but the assumption is made that one capillary diffusion time scale is representative for the whole matrix domain . for this",
    "we use the averaged capillary diffusion time scale , @xmath197s ( cf .",
    "figure [ fig : histogramm ] ) . the associated memory function is calculated numerically .    to summarize the parameterization : the parameters for the mrmt model are calculated from fluid and material properties and the structure of the fracture network .",
    "the memory function is the crucial parameter to capture the fracture matrix exchange .",
    "it is calculated for the fracture network from the distribution ( see figure [ fig : histogramm ] ) of matrix block sizes and the hydraulic parameters of the matrix blocks .",
    "other details of the structure , like the location of each block in the fracture network , are not important , because the flow in the fracture is faster than the flow in the matrix .",
    "all memory functions for this example are shown in figure  [ fig : memoryfunctions ] .",
    "the saturation distribution from the full 2d model for a time before and after breakthrough can be found in figure [ fig : saturation - profiles - complex ] .",
    "the results obtained with the mrmt model with approximated global memory functions and the full 2d model can be compared in figure [ fig : result_complex ] .",
    "histogramm of the capillary diffusion time scales in the matrix blocks for the complex fracture network , width=377 ]    saturation distribution obtained with the full 2d model before ( top ) and after ( bottom ) breakthrough for the complex fracture network . , width=453 ]    breakthrough curve ( top ) and recovery ( bottom ) for the full 2d model and the mrmt model for the complex fracture network.,width=377 ]    breakthrough curve ( top ) and recovery ( bottom ) for the full 2d model and the mrmt model for the complex fracture network.,width=377 ]    the mrmt models that consider the full distribution of time scales matches the recovery curves as well as the breakthrough curves of the detailed model well ( see figures  [ fig : results_simple ] and [ fig : result_complex ] ) . in particular the averaged breakthrough time and the late time behavior",
    "can be reproduced by this mrmt models .",
    "there are some differences around the breakthrough time .",
    "the recovery curve as well as the breakthrough curve of the detailed model are spread around the breakthrough time .",
    "this has two reasons : ( i ) the detailed model considers capillary diffusion in the fractures .",
    "furthermore ( ii ) the saturation front speed in the detailed model varies locally .",
    "this can be seen clearly in figure  [ fig : saturation - profiles - complex ] .",
    "this is caused by local variations in the fracture geometry and in the retardation due to fracture matrix exchange .",
    "neither capillary diffusion nor a distribution of front speed are captured in the mrmt model , so that the mrmt model simulates a mean breakthrough .",
    "the tailing of the breakthrough curve ( see figure [ fig : result_complex ] ) is caused by rarefaction in the fracture domain and by the superposition of the different breakthrough times . in comparison with the mrmt model with",
    "the single averaged capillary diffusion time scale , the tailing of the breakthrough curve shows a different slope .",
    "this different slope is caused by the distribution of capillary diffusion time scales ( figure  [ fig : histogramm ] ) , which is not captured when using only one equivalent local memory function . because the global memory functions calculated from the truncated power law and the numerical simulations differ at late time ( see figure  [ fig : memoryfunctions ] ) it is expected , that the memory function derived from the numerical simulation is more accurate .",
    "the breakthrough time depends on flow rate at the inlet and on the matrix - fracture transfer .",
    "the flow rate at the inlet is the same for all mrmt models . the mrmt model with",
    "the single averaged capillary diffusion time scale shows an earlier breakthrough than the mrmt model with the full global memory function , because this model ignores the fast capillary diffusion time scales .",
    "therefore this model underestimates the matrix - fracture transfer at early times .",
    "this can be read from the memory functions in figure  [ fig : memoryfunctions ] directly .    overall the mrmt model with the averaged capillary diffusion timescale results in earlier breakthrough and does not match the tailing of the full 2d model .",
    "the solution of the one dimensional mrmt model that capture the full distribution of capillary diffusion time scales matches the solution of the full two dimensional model for the complex fracture network , despite the simplifications made .",
    "this illustrates that all capillary diffusion time scales need to be considered in a case of a complex fracture network .",
    "we show the application of a mrmt model with pre - estimated parameter functions to simulate immiscible displacement in complex fracture networks . in order to estimate the applicability of the mrmt approach",
    ", we introduced time scales to characterize the flow in fracture and matrix .",
    "the presented model is valid for imbibition cases , when the flow in the fracture is faster than the flow in the matrix and the fracture network is sufficiently well connected .",
    "the parameters for the mrmt model can be predicted from fluid and material properties and the structure of the fracture network .",
    "the global memory function can be calculated from the weighted sum of volume percentage of the local memory functions for each matrix block in the fracture network .",
    "the local memory function for a single block can be calculated numerically or it could be approximated or by using a truncated power law parameterization using the capillary diffusion timescale as break off time .",
    "it is practical to approximate the local memory functions for other matrix blocks by scaling a reference memory function .",
    "the mrmt model presented here can be transformed to and solved as mrdp model .",
    "therefore , it is easy to implement this model in existing mrdp simulators .",
    "it would only be necessary to expand the pre - estimated global memory function into exponential functions ( see appendix [ implmrmt ] ) .",
    "the mrdp medium would need as many continua as there are expansion terms for the memory function .",
    "the parameters could be read directly from the expansion . however , the model is based on assumptions that should be pointed out clearly .",
    "we assume that the structure of the fractured rock is known .",
    "the information about the block size distribution and the hydraulic properties of all materials are needed to calculate the parameters for the mrmt model .",
    "the hydraulic parameters and the reference memory function for a real setup could be obtained from laboratory experiments using samples from bore cores , for example .",
    "information about the structure of fracture network is more difficult to obtain and could be available from outcrops .",
    "a reconstruction of the fracture network from outcrops will only be an estimation .",
    "it should , however , be noted that only the distribution of block sizes is needed to calculate the global memory function , while details about the locations of the matrix blocks are not required .",
    "furthermore , the definition of the matrix block sizes may be difficult for real three dimensional fracture networks .",
    "the topology of two - dimensional networks is fundamentally different from that of three - dimensional networks , where matrix blocks might not be completely surrounded by fractures .",
    "a fundamental assumption of the upscaled multi - rate mass transfer model is that the fracture network itself can be represented by a continuum with effective properties .",
    "the fracture network is here represented as a fairly homogeneous continuum with a straightforward way to estimate effective parameters because the focus of this paper is to capture the fracture - matrix exchange in an upscaled model .",
    "if the fracture network is complex with lots of dead ends and not well - defined matrix blocks , the approximation of the global memory function from the superposition of scaled blocks is expected to become more complex or to fail .",
    "the fracture network needs to be sufficiently well connected .",
    "this is related to the requirement that a macroscopic representative elementary volume needs to exist for the medium .",
    "if this is not fulfilled , the continuum approach for the fracture network fails and it may be better to apply the dfm approach .    if the fracture network is heterogeneous , but representable as a continuum , the upscaled model for the fracture needs to be extended by effective parameters and possibly by effective processes . in the complex fracture network",
    ", we found a spreading of the front caused by the heterogeneity of the fracture network itself .",
    "this front spreading may be captured by an additional dispersion term for flow in the fracture network  @xcite .",
    "strong fracture network heterogeneity and long rage structures , as caused , for instance by variation in the fracture aperture , may cause preferential flow paths .",
    "such a scenario might happen if there are few intersecting fractures with large aperture in a network with smaller aperture fractures .",
    "this might lead to a fast breakthrough along these preferential paths , while other parts of the fracture network do not contribute to the displacement process . the capillary flow within these passive fractures will be much weaker than that into the matrix blocks . in this case",
    ", the fracture network would need be represented by a more advanced upscaled continuum model .",
    "a possible approach would be so separate the fracture network itself into a mobile continuum , containing the contributing fractures , and assign non - participating fractures to a second immobile continuum with little exchange or even represent it with a reduced porosity of the medium .",
    "the topology of these non - participating fractures will influence the global memory function , as they will form barriers in the matrix blocks .",
    "the pre - estimation of these continua for a given fracture network is not straight forward and goes beyond the scope of this work .",
    "we would like to stress that this applies to fracture networks with long range structures only .",
    "if the apertures of the fractures are highly heterogeneous , but the correlation scale of aperture variability is much smaller than the intersecting length of fractures , the flow parameters of the fracture might need to be represented by effective parameters .",
    "apart from the fracture network and the fracture apertures , the surrounding matrix is usually also influenced by heterogeneous material structure .",
    "this is not addressed in this work , but could be included straight away for the case that heterogeneity is moderate , meaning the variance of parameter contrasts is low and the correlation length of heterogeneity is small .",
    "if the matrix is moderately heterogeneous , the two - phase flow parameters in the matrix can be considered effective parameters , describing the spatial average distribution . for slow flow that is locally in equilibrium , such as for capillary counter current flow ,",
    "this is a reasonable approach .",
    "if heterogeneity is strong , the matrix can not be described well as one continuum . in this case the minc approach @xcite could be suitable .    a comparable effect causing preferential flow paths is segregation of fluids due to buoyancy .",
    "gravity is not considered in this model , but will influence the flow in the fractured rock .",
    "gravity affects the flow in the fracture network more than the flow in the matrix , as the gravity number , which compares gravity to capillary forces @xcite , is proportional to the permeability of the medium .",
    "if the injection of fluid is horizontal ( for example in a deep aquifer layer ) , gravity will lead to a flow segregation with the denser fluid flowing in the fractures at the bottom of the layer ( e.g. , * ? ? ? * ) ) .",
    "the approach outlined in this paper could be used in a straight forward manner , but would require a two or three dimensional extension of the mrmt model , which is straightforward in the presented framework .",
    "this work was supported by the compute cluster , which is funded by the leibniz university hanover , the lower saxony ministry of science and culture ( mwk ) and by the german research association ( dfg ) under the grant ne 824 10 - 1 .",
    "we gratefully acknowledge the help of bernd flemisch from the university of stuttgart with the dumux model . m.d .",
    "acknowledges the funding from the european research council through the project mhetscale ( grant agreement no .",
    "the mrmt model   is numerically solved as presented in silva et al .",
    "@xcite or tecklenburg et al . @xcite .",
    "other schemes might be possible , such as suggested by di donato et al . @xcite .    to avoid carrying out an integration over time in the numerical scheme , which requires a very large amount of storage",
    ", the convolution integral modeling the sink source term is approximated by a sum of single rate transfer functions following @xcite .",
    "hence , the global memory function can be approximated by a sum of @xmath99 exponential functions .",
    "@xmath198    here @xmath199 ( - ) are weighting coefficients and @xmath200 ( @xmath201 ) are the transfer rates .",
    "the exponential functions can be considered the solutions of the mass balance in immobile boxes with single rate transfer with the fracture domain .",
    "@xmath202    the convolution integral in   can with this approach be approximated by a weighted sum of single rate transfer functions with @xmath99 immobile boxes ( see @xcite for details ) .",
    "@xmath203    @xmath204 ( - ) is the saturation in the immobile box @xmath205 , we then find the weights @xmath206 by minimizing the functional    @xmath207    for the logarithms of the times , @xmath208 , we choose evenly distributed values between @xmath209 and @xmath210 .",
    "for @xmath211 we choose a fraction of the time step size @xmath212 and for @xmath213 the maximum simulation time @xmath214 . in the simulation",
    "we use five exponential functions per decade . here",
    "@xmath215 is the first and @xmath216 is the last time step of the simulation .    with the approximation of the kernel of the convolution integral by a sum of exponential functions",
    ", we can now solve the mrmt   following @xcite .",
    "we introduce a one dimensional grid with volumes @xmath51 to discretize the upscaled fracture network .",
    "each volume @xmath51 is connected to @xmath99 immobile boxes @xmath205 representing the matrix .",
    "the initial fracture saturation is @xmath217 and the initial matrix saturation is @xmath218 for all boxes @xmath205 and volumes @xmath51 .",
    "we apply an operator splitting scheme : first the exchange between matrix and fracture is evaluated , then the flow in the fracture is solved by an upwind finite volume method and explicit euler time integration as described in @xcite .    assuming @xmath219 to be constant between time steps @xmath220 and @xmath221 , each single rate transfer ( [ eq : singlerate ] ) can be solved analytically using @xmath222 as the initial condition .",
    "@xmath223    the exchange between the fracture and the immobile box @xmath205 can be found by substituting ( [ eq : single_analytisch ] ) into ( [ eq : singlerate ] ) and with defining @xmath224 :    @xmath225    we calculate the exchange between fracture and matrix to get the intermediate fracture saturation @xmath226    @xmath227    from this intermediate fracture saturation @xmath226 we calculate the advective flow in the fracture using upwind fluxes .",
    "when @xmath228 , the fracture saturation is    @xmath229    here the time step size is controlled by the courant friedrich levy criterion .",
    "the immobile boxes are updated using ( [ eq : single_analytisch ] ) as @xmath230 and then the averaged saturation in the matrix can be calculated as    @xmath231",
    "the green s function or memory function is defined as a response of the system to a delta pulse .",
    "this is equivalent to the time derivative of a response to a heaviside step function . with this equivalent",
    "the local memory function can be determined numerically .    in a numerical simulation",
    "it is more practical to apply a heaviside stepfunction @xmath232 as boundary condition than a delta pulse .",
    "this step function from the initial saturation @xmath233 to the saturation @xmath234 approximates the matrix saturation at the interface between fracture and matrix during a flooding of the fracture network .",
    "the matrix saturation is @xmath235 before the front arrives .",
    "when the front arrives the interface saturation immediately jumps to @xmath236 due to the strong contrast in capillary entry pressures between the fracture and the matrix .",
    "the saturation @xmath237 ( representing the response to a heavyside step ) was here obtained with a dumux simulation by solving ( [ full : model ] ) on a single matrix geometry .",
    "therefore we use the parameters for the matrix block from the detailed problem .",
    "the initial condition is @xmath233 and the boundary condition is @xmath238 as discussed above .",
    "we calculate the spatially averaged saturation @xmath239 for each timestep .",
    "then the memory function can be calculated from ( [ smav ] ) as    @xmath240    where the time derivative is carried out by a numerical approximation , here a finite difference .",
    "the memory function is normalized , as @xmath241 .",
    "comparison of capillary diffusion time scales @xmath78 for imbibition into rectangular matrix blocks .",
    "@xmath242 is the time , where the recovery is 30% to consider unperturbed capillary flow only.,width=453 ]    we now compare the new capillary diffusion time scale ( [ eq : td_thiswork ] ) to other capillary diffusion time scales from the literature that are used to parameterize mrmt or mrdp models . in these works , in contrast to our approach , the breakoff due to the interference of the displacement front with the matrix block boundaries is considered relevant .",
    "we focus on time scales based on the analytical solution of mcworther and sunada @xcite , because schmid and geiger  @xcite compared different capillary time scales and rated this as the best approach .",
    "the mrdp model of maier et al .",
    "@xcite uses a timescale @xmath243^{2},\\label{eq : tmaier}\\ ] ] that represents the time , when the volume of water imbibed is equal to the pore volume of a slab of thickness @xmath244 .",
    "the mrmt model of tecklenburg et al .",
    "@xcite uses the timescale @xmath245^{2},\\label{eq : ttecklenburg2013}\\ ] ] which corresponds to the time when the front invading into a slab arrives at the boundary .",
    "these capillary diffusion timescales are compared with the numerical solution of   for rectangular matrix blocks using dumux .",
    "we simulate 40 scenarios with a boundary condition of @xmath246 at all interfaces , an intrinsic permeability @xmath247 and a grid size of @xmath248 .",
    "the following parameters were chosen for a van genuchten parameterization from the given interval by a random hypercube algorithm : block length @xmath249 and width @xmath250 , van genuchten @xmath251 and @xmath252 and the initial saturation @xmath253 .    in these simulations",
    "one can observe an early time behavior , where the recovery is diffusive with @xmath254 scaling , and a late time behavior , when the recovery slows down until the matrix block is full ( not shown ) . as we consider the early time behavior as the crucial one ,",
    "we compare here the time where the recovery in the numerical simulation is 30% and compare this ( due to the diffusive time behaviour of solution ) to @xmath255 times the capillary diffusion time scales @xmath78 .    in figure",
    "[ fig : comparison - of_td ] we compare the timescale @xmath256 to 0.09 times the analytical capillary diffusion timescales ( [ eq : ttecklenburg2013 ] ) , ( [ eq : tmaier ] ) and ( [ eq : td_thiswork ] ) .",
    "we choose the timescale ( [ eq : td_thiswork ] ) to characterize the flow in the matrix blocks , because this timescale matches the early counter current flow behavior better than the other timescales .",
    "10 url # 1`#1`urlprefixhref # 1#2#2 # 1#1    b.  zinn , l.  c. meigs , c.  f. harvey , r.  haggerty , w.  j. peplinski , c.  freiherr von schwerin , experimental visualization of solute transport and mass transfer processes in two - dimensional conductivity fields with connected regions of high conductivity , environ .",
    "technol . 38",
    "( 2004 ) 39163926 .",
    "http://dx.doi.org/10.1021/es034958g [ ] .",
    "s.  a. mckenna , l.  c. meigs , r.  haggerty , tracer tests in a fractured dolomite : 3 .",
    "double - porosity , multiple - rate mass transfer processes in convergent flow tracer tests , water resources research 37  ( 5 ) ( 2001 ) 11431154 . http://dx.doi.org/10.1029/2000wr900333 [ ] .",
    "r.  haggerty , c.  f. harvey , c.  freiherr  von schwerin , l.  c. meigs , what controls the apparent timescale of solute mass transfer in aquifers and soils ?",
    "a comparison of experimental results , water resources research 40  ( 1 ) ( 2004 ) w01510 .",
    "http://dx.doi.org/10.1029/2002wr001716 [ ] .",
    "p.  k. kang , t.  le  borgne , m.  dentz , o.  bour , r.  juanes , impact of velocity correlation and distribution on transport in fractured media : field evidence and theoretical model , water resources research 51  ( 2 ) ( 2015 ) 940959 .",
    "http://dx.doi.org/10.1002/2014wr015799 [ ] .",
    "m.  v. klepikova , t.  le  borgne , o.  bour , k.  gallagher , r.  hochreutener , n.  lavenant , passive temperature tomography experiments to characterize transmissivity and connectivity of preferential flow paths in fractured media , journal of hydrology 512 ( 2014 ) 549562 .",
    "http://dx.doi.org/10.1016/j.jhydrol.2014.03.018 [ ] .",
    "i.  neuweiler , d.  erdal , m.  dentz , a non - local richards equation to model unsaturated flow in highly heterogeneous media under nonequilibrium pressure conditions , vadose zone journal 11  ( 3 ) ( 2012 ) vzj20110132 .",
    "http://dx.doi.org/10.2136/vzj2011.0132 [ ] .",
    "g.  d. donato , m.  blunt , streamline - based dual - porosity simulation of reactive transport and flow in fractured reservoirs , water resources research 40 ( 2004 ) w04203 .",
    "http://dx.doi.org/10.1029/2003wr002772 [ ] .",
    "wu , g.  qin , r.  ewing , y.  yalchin  efendiev , z.  kang , y.  ren , a multiple - continuum approach for modeling multiphase flow in naturally fractured vuggy petroleum reservoirs , in : international oil & gas conference and exhibition in china , 2006 , pp .",
    "http://dx.doi.org/10.2118/104173-ms [ ] .",
    "k.  pruess , brief guide to the minc - method for modeling flow and transport in fractured media , earth science division .",
    "lawrence berkeley laboratory , university of california , berkeley ( 1992 ) 10179280http://dx.doi.org/10.2172/10179280 [ ] .",
    "a.  b. tatomir , a.  szymkiewicz , h.  class , r.  helmig , modeling two phase flow in large scale fractured porous media with an extended multiple interacting continua method , computer modeling in engineering & sciences 77  ( 2 ) ( 2011 ) 81111 .",
    "http://dx.doi.org/10.3970/cmes.2011.077.081 [ ] .",
    "p.  andersen , s.  evje , h.  kleppe , a model for spontaneous imbibition as a mechanism for oil recovery in fractured reservoirs , transport in porous media 101  ( 2 ) ( 2014 ) 299331 . http://dx.doi.org/10.1007/s11242-013-0246-7 [ ] .",
    "b.  ramirez , h.  kazemi , m.  al - kobaisi , e.  ozkan , a.  s. , a critical review for proper use of water / oil / gas transfer functions in dual - porosity naturally fractured reservoirs : part i , spe reservoir evaluation & engineering 12  ( 2 ) ( 2009 ) 200210 . http://dx.doi.org/10.2118/109821-pa [ ] .",
    "m.  al - kobaisi , h.  kazemi , b.  ramirez , e.  ozkan , a.  s. , a critical review for proper use of water / oil / gas transfer functions in dual - porosity naturally fractured reservoirs : part ii , spe reservoir evaluation & engineering 12  ( 2 ) ( 2009 ) 211217 . http://dx.doi.org/10.2118/124213-pa [ ] .",
    "a.  s.  a. abushaikha , o.  r. gosselin , matrix - fracture transfer function in dual - media flow simulation : review , comparison and validation , europec / eage conference and exhibition , rome , italy , 9 - 12 june ( 2008 ) spe113890mshttp://dx.doi.org/10.2118/113890-ms [ ] .",
    "m.  willmann , j.  c.  x. sanchez - vila , o.  silva , m.  dentz , coupling of mass transfer and reactive transport for nonlinear reactions in heterogeneous media , water resour .",
    "46 ( 2010 ) w07512 . http://dx.doi.org/10.1029/2009wr007739 [ ] .",
    "r.  haggerty , s.  m. gorelick , multiple - rate mass transfer for modeling diffusion and surface reactions in media with pore - scale heterogeneity , water resour .",
    "31  ( 10 ) ( 1995 ) 23832400 . http://dx.doi.org/10.1029/95wr10583 [ ] .",
    "j.  carrera , x.  snchez - vila , i.  benet , a.  medina , g.  galarza , j.  guimer , on matrix diffusion : formulations , solution methods and qualitative effects , hydrogeology journal 6 ( 1998 ) 178190 .",
    "http://dx.doi.org/10.1007/s100400050143 [ ] .",
    "j.  tecklenburg , i.  neuweiler , m.  dentz , j.  carrera , s.  geiger , c.  abramowski , o.  silva , a non - local two - phase flow model for immiscible displacement in highly heterogeneous porous media and its parametrization , advances in water resources 62 ( 2013 ) 475487 , part c. http://dx.doi.org/10.1016/j.advwatres.2013.05.012 [ ] .",
    "s.  geiger , m.  dentz , i.  neuweiler , a novel multi - rate dual - porosity model for improved simulation of fractured and multi - porosity reservoirs , spe journal 18  ( 04 ) ( 2013 ) 670684 .",
    "http://dx.doi.org/10.2118/148130-pa [ ] .",
    "b.  flemisch , m.  darcis , k.  erbertseder , b.  faigle , a.  lauser , k.  mosthaf , s.  mthing , p.  nuske , a.  tatomir , m.  wolff , r.  helmig , dumux : \\{dune } for multi - phase , component , scale , physics , ... flow and transport in porous media , advances in water resources 34  ( 9 ) ( 2011 ) 11021112 . http://dx.doi.org/10.1016/j.advwatres.2011.03.007 [ ] .",
    "b.  noetinger , t.  estebenet , up - scaling of double porosity fractured media using continuous - time random walks methods , transp .",
    "porous media 39 ( 2000 ) 315337 .",
    "p.  gouze , z.  melean , t.  le  borgne , m.  dentz , j.  carrera , non - fickian dispersion in porous media explained by heterogeneous microscale matrix diffusion , water resources research 44 ( 2008 ) w11416 . http://dx.doi.org/10.1029/2007wr006690 [ ] .",
    "s.  ma , n.  r. morrow , z.  xiaoyun , generalized scaling of spontaneous imbibition data for strongly water - wet systems , journal of petroleum science and engineering 18  ( 3 ) ( 1997 ) 165178 .",
    "http://dx.doi.org/10.1016/s0920-4105(97)00020-x [ ] .",
    "i.  neuweiler , s.  attinger , w.  kinzelbach , p.  king , large scale mixing for immiscible displacement in heterogeneous porous media , transport in porous media 51 ( 2003 ) 278314 . http://dx.doi.org/10.1023/a:1022370927468 [ ] .",
    "o.  silva , j.  carrera , m.  dentz , s.  kumar , a.  alcolea , m.willmann , a general real - time formulation for multi - rate mass transfer problems , hydrol .",
    "earth syst .",
    "( 2009 ) 13991411 .",
    "http://dx.doi.org/10.5194/hess-13-1399-2009 [ ] .",
    "k.  schmid , s.  geiger , universal scaling of spontaneous imbibition for arbitrary petrophysical properties : water - wet and mixed - wet states and handy s conjecture , journal of petroleum science and engineering 101 ( 2013 ) 4461 .",
    "c.  maier , k.  schmid , m.  a. elfeel , s.  geiger , multi - rate mass - transfer dual - porosity modelling using the exact analytical solution for spontaneous imbibition , in : 75th eage conference & exhibition incorporating spe europec 2013 , society of petroleum engineers , 2013 , pp .",
    "http://dx.doi.org/10.2118/164926-ms [ ] ."
  ],
  "abstract_text": [
    "<S> we study modeling of two - phase flow in highly heterogeneous fractured and porous media . </S>",
    "<S> the flow behaviour is strongly influenced by mass transfer between a highly permeable ( mobile ) fracture domain and less permeable ( immobile ) matrix blocks . </S>",
    "<S> we quantify the effective two - phase flow behaviour using a multirate rate mass transfer ( mrmt ) approach . </S>",
    "<S> we discuss the range of applicability of the mrmt approach in terms of the pertinent viscous and capillary diffusion time scales . </S>",
    "<S> we scrutinize the linearization of capillary diffusion in the immobile regions , which allows for the formulation of mrmt in the form of a non - local single equation model . </S>",
    "<S> the global memory function , which encodes mass transfer between the mobile and the immobile regions , is at the center of this method . </S>",
    "<S> we propose two methods to estimate the global memory function for a fracture network with given fracture and matrix geometry . </S>",
    "<S> both employ a scaling approach based on the known local memory function for a given immobile region . with the first method , the local memory function </S>",
    "<S> is calculated numerically , while the second one employs a parametric memory function in form of truncated power - law . </S>",
    "<S> the developed concepts are applied and tested for fracture networks of different complexity . </S>",
    "<S> we find that both physically based parameter estimation methods for the global memory function provide predictive mrmt approaches for the description of multiphase flow in highly heterogeneous porous media .    </S>",
    "<S> multi - rate mass - transfer models , two - phase flow , upscaling , fractured media , dual - porosity , fracture networks , memory function , process time scales , immiscible displacement </S>"
  ]
}