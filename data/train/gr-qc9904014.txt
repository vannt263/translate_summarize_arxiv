{
  "article_text": [
    "the einstein equations for the structure of spacetime were first published in 1916 when einstein introduced his famous general theory of relativity .",
    "this theory of gravity has remained essentially unchanged since its discovery , and it provides the underpinnings of modern theories of astrophysics and cosmology .",
    "the theory is essential in describing phenomena such as black holes , compact objects , supernovae , and the formation of structure in the universe .",
    "unfortunately , the equations are a set of highly complex , coupled , nonlinear partial differential equations involving 10 functions of 4 independent variables .",
    "they are among the most complicated equations in mathematical physics .",
    "for this reason , in spite of more than 80 years of intense study , the solution space to the full set of equations is essentially unknown .",
    "most of what we know about this fundamental theory of physics has been gleaned from linearized solutions , highly idealized solutions possessing a high degree of symmetry ( e.g. , static , or spherically or axially symmetric ) , or from perturbations of these solutions .    over the last 30 years",
    "a growing research area , called numerical relativity , has developed , where computers are employed to construct numerical solutions to these equations .",
    "although much has been learned through this approach , progress has been slow due to the complexity of the equations and inadequate computational power .",
    "for example , an important astrophysical application is the 3d spiraling coalescence of two black holes ( bh ) or neutron stars ( ns ) , which will generate strong sources of gravitational waves . as has been emphasized by flanagan and hughes , one of the best candidates for early detection by the laser interferometer network",
    "is increasingly considered to be bh mergers@xcite .",
    "the imminent arrival of data from the long awaited gravitational wave interferometers ( see , e.g. , ref .",
    "@xcite and references therein ) has provided a sense of urgency in understanding these strong sources of gravitational waves .",
    "such understanding can be obtained only through large scale computer simulations using the full machinery of numerical relativity .",
    "furthermore , the gravitational wave signals are likely to be so weak by the time they reach the detectors that reliable detection may be difficult without prior knowledge of the merger waveform .",
    "these signals can be properly interpreted , or perhaps even detected , only with a detailed comparison between the observational data and a set of theoretically determined `` waveform templates '' . in most cases ,",
    "these waveform templates needed for gravitational wave data analysis have to be generated by large scale computer simulations , adding to the urgency of developing numerical relativity . however , a realistic 3d simulation based on the full einstein equations is a highly non - trivial task  based on axisymmetric black hole calculations performed during late 1980 s and algorithms available at the time ",
    "one can estimate the time required for a reasonably accurate 3d simulation of , say , the coalescence of a compact object binary , to be at least 100,000 cray y - mp hours !",
    "but there is good reason for optimism that such problems can be solved within the next decade .",
    "scalable parallel computers , and efficient algorithms that exploit them , are quickly revolutionizing computational science , and numerical relativity is a great beneficiary of these developments . over the last years",
    "the community has developed 3d codes designed to solve the complete set of einstein equations that run very efficiently on large scale parallel computers .",
    "we will describe below one such code , called `` cactus '' , that has achieved 142 gflops on a 1024 node cray t3e-1200 , which is more than 2000 times faster than 2d codes of a few years ago running on a cray y - mp ( which also had only about 0.5% the memory capacity of the large t3e ) .",
    "such machines are expected to scale up rapidly as faster processors are connected together in even higher numbers , achieving teraflop performance on real applications in a few years .",
    "numerical relativity requires not only large computers and efficient codes , but also a wide variety of numerical algorithms for evolving and analyzing the solution . because of this richness and complexity of the equations , and the interesting applications to problems such as black holes and neutron stars ,",
    "natural collaborations have developed between applied mathematicians , physicists , astrophysicists , and computational scientists in the development of a single code to attack these problems .",
    "there are various large scale collaborative effort in recent years in this direction , including the nsf black hole grand challenge project ( recently concluded ) , the nasa neutron star grand challenge project and the ncsa / potsdam / wash u numerical relativity collaboration .",
    "we introduce in this paper a code called `` cactus '' , which is developed by the ncsa / potsdam / wash u collaboration , and is employed in the nasa neutron star grand challenge project",
    ". we will describe some of the algorithms and capabilities of this code in this paper . in the next sections we will first give a brief description of the numerical formulation of the theory of general relativity , and discuss particular difficulties associated with numerical relativity .",
    "the discussion will necessarily be brief .",
    "examples are mostly drawn from work carried out by our ncsa / potsdam / wash u numerical relativity collaboration .",
    "we also provide url addresses for web pages containing graphics and movies of some of our results .",
    "to conclude this brief introduction , a statement of where we stand in terms of simulating general relativistic compact objects is in order .",
    "the nsf black hole grand challenge project and related work achieved long term stable evolution of single black hole spacetimes under certain conditions  @xcite , but there is still a long way to go before the spiraling coalescence can be computed .",
    "the presently on - going nasa neutron star grand challenge project recently succeeded in evolving grazing collision of two neutron stars using the full einstein - relativistic hydrodynamic system of equations , with a simple equation of state .",
    "while the inspiral coalescences of two neutron stars is _ not _ a stated goal of the nasa project , we expect to be able to carry out preliminary studies of the inspiral coalescences in the next few years .",
    "the final goal of a full solution of the problem including radiation transport and magneto - hydrodynamics for comparison between numerical simulations and observations in gravitational wave astronomy ( waveform templates ) and high energy astronomy ( @xmath0 ray burst ) will take many more years , hopefully building on the effort described in this paper .",
    "the nakamura group also reports preliminary success in evolving several orbits with a fully relativistic gr - hydro code  @xcite .",
    "the generality and complexity of the einstein equations make them an excellent and fertile testing ground for a variety of broadly significant computing issues .",
    "they form a system of dozens of coupled , nonlinear equations , with thousands of terms , of mixed hyperbolic - elliptic type , and even undefined types , depending on coordinate conditions .",
    "this rich and general structure of the equations implies that the techniques developed to solve our problems will be immediately applicable to a large family of diverse scientific applications .",
    "the system of equations breaks up naturally into a set of constraint equations , which are elliptic in nature , evolution equations , which are `` hyperbolic '' in nature ( more on this below ) , and gauge equations , which can be chosen arbitrarily ( often leading to more elliptic equations ) .",
    "the evolution equations guarantee ( mathematically ) that the elliptic constraints are satisfied at all times provided the initial data satisfied them .",
    "this implies that the initial data are not freely specifiable .",
    "moreover , although the constraints are satisfied mathematically during evolution , it will not be so numerically .",
    "these problems are each discussed in turn below .",
    "first , however , we point out that a much simpler theory , familiar to many , has all of these same features .",
    "maxwell s equations describing electromagnetic radiation have : ( a ) elliptic constraint equations , demanding that in vacuum the divergence of the electric and magnetic fields vanish at all times ; ( b ) evolution equations , determining the time development of these fields , given suitable initial data that satisfies the elliptic constrain equations ; and ( c ) gauge conditions that can be applied freely to certain variables in the theory , such as some components of the vector potential . some choices of vector potential lead to hyperbolic evolution equations for the system , and some do not .",
    "we will find all of these features present in the much more complicated einstein equations , so it is useful to keep maxwell s equations in mind when reading the next sections .",
    "in the standard 3 + 1 adm approach to general relativity,@xcite , the basic building block of the theory  the spacetime metric  is written in the form @xmath1 using geometrized units such that the gravitational constant @xmath2 and the speed of light @xmath3 are both equal to unity . throughout this paper",
    ", we use latin indices to label spatial coordinates , running from 1 to 3 .",
    "the ten functions @xmath4 are functions of the spatial coordinates @xmath5 and time @xmath6 .",
    "indices are raised and lowered by the `` spatial 3metric '' @xmath7 . notice that the geometry on a 3d spacelike hypersurface of constant time ( i.e. , @xmath8 ) is determined by @xmath7 . as we will see below",
    ", the einstein equations control the evolution in time of this 3d geometry described by @xmath7 , given appropriate initial conditions .",
    "the lapse function @xmath9 and the shift vector @xmath10 determine how the slices are threaded by the spatial coordinates .",
    "together , @xmath9 and @xmath11 represent the coordinate degrees of freedom inherent in the covariant formulation of einstein s equations , and can therefore be chosen , in some sense , `` freely '' , as discussed below .",
    "this formulation of the equations assumes that one begins with an everywhere spacelike slice of spacetime , that should be evolved forward in time .",
    "due to limited space , we will not discuss promising alternate treatments , based on either characteristic , or null foliations of spacetime@xcite , or on asymptotically null slices of spacetime@xcite .",
    "the constraints can be considered as the relativistic generalization of the poisson equation of newtonian gravity , but instead of a single linear elliptic equation there are now four , coupled , highly nonlinear elliptic equations , known as the hamiltonian and momentum constraints . under certain conditions , the equations decouple and can be solved independently and more easily , and this is how they have been usually treated .",
    "recently , techniques have been developed that allow one to solve the constraints in a more general setting , without making restrictive assumptions that lead to decoupling@xcite .",
    "in such a system the four constraint equations are solved simultaneously .",
    "this may prove useful in generating new classes of initial data .",
    "however , at present there is no satisfactory algorithm for controlling the physics content of the data generated .",
    "the major remaining work in this direction is to develop a scheme that is capable of constructing the initial data that describe a _ given _ physical system .",
    "that is , although we have schemes available to solve many variations on the initial value problem , it is difficult to specify in advance , for example , what are the precise spins and momenta of two black holes in orbit , or even if the hole _ are _ in orbit .",
    "this can generally only be determined after the equations have been solved and analyzed .",
    "the elliptic operators for these equations are usually symmetric , but they are otherwise the most general type , with all first and mixed second derivative terms present .",
    "the boundary conditions , which can break the symmetry , are usually linear conditions that involve derivatives of the fields being solved . in any case , once the initial value equations have been solved , initial data for the evolution problem result .",
    "we illustrate the central idea of constructing initial data with vacuum spacetimes for simplicity .",
    "the application of the algorithm presented here to a general spacetime with matter source is currently routine in numerical relativity .",
    "the full 4d einstein equations can be decomposed into six evolution equations and four constraint equations .",
    "the constraints may be subdivided , in turn , into one hamiltonian ( or energy ) constraint equation , @xmath12 and three momentum constraint equations ( or one vector equation ) , @xmath13 in these equations @xmath14 is the extrinsic curvature of the slice , related to the time derivative of @xmath7 by @xmath15 here we have introduced the 3d spatial covariant derivative operator @xmath16 associated with the 3metric @xmath7 ( i.e. @xmath17 ) , and the 3d scalar curvature @xmath18 computed from @xmath7 .",
    "these four constraint equations can be used to determine initial data for @xmath7 and @xmath14 , which are to be evolved with the evolution equations to be discussed below .",
    "these equations ( 2,3 ) are referred to as constraints because , as in the case of electrodynamics , they contain no time derivatives of the fundamental fields @xmath7 and @xmath14 , and hence do not propagate the solution in time .",
    "next , we will sketch the standard method for obtaining a solution to these constraint equations .",
    "we follow york and coworkers ( e.g. , @xcite ) by writing the 3metric and extrinsic curvature in `` conformal form '' , and also make use of the simplifying assumption @xmath19 which causes the hamiltonian and momentum constraints to completely decouple ( note that actually the equations decoupled with @xmath20 but we will discuss only the simplest case here ) .",
    "we write @xmath21 where @xmath22 and the transverse tracefree part of @xmath23 is regarded as given , i.e. , chosen to represent the physical system that we want to study . under the conformal transformation , with @xmath19",
    "we find that the momentum constraint becomes @xmath24 where @xmath25 is the 3d covariant derivative associated with @xmath22 ( i.e. , @xmath26 ) . in vacuum ,",
    "black hole spacetimes @xmath23 can often be solved analytically . for more details on how to solve the momentum constraints in complicated situations ,",
    "please see @xcite .",
    "the remaining unknown function @xmath27 , must satisfy the hamiltonian constraint .",
    "the conformal transformation of the scalar curvature is @xmath28 where @xmath29 and @xmath30 is the scalar curvature of the known metric @xmath22 . plugging this back in to the hamiltonian constraint and dividing through by @xmath31",
    ", we obtain @xmath32 an elliptic equation for the conformal factor @xmath27 .",
    "to summarize , one first specifies @xmath22 and the transverse tracefree part of @xmath23 `` at will '' , choosing them to be something `` closest '' to the spacetime one wants to study .",
    "then one solves ( [ eq10 ] ) for the conformal extrinsic curvature @xmath23 .",
    "finally , ( [ psieq ] ) is solved for the conformal factor @xmath27 , so the full solution @xmath7 and @xmath14 can be reconstructed . in this process",
    "the elliptic equations are solved by standard techniques , e.g. , the conjugate gradient  @xcite or multigrid methods  @xcite . in situations where there is a black hole singularity ,",
    "there could be added complications in solving the elliptic equations , and special treatments would have to be introduced , e.g. , the `` puncture '' treatment of @xcite , or employing an `` isometry '' operation to provide boundary conditions on black hole throats , ensuring identical spatial geometries inside and outside the throat ( see , e.g. ,  @xcite , or  @xcite for more details ) .    while this is a well established process for generating an initial data set for numerical study",
    ", there is a fundamental difficulty in using this approach to generate initial data corresponding to a physical system one wants to evolve , e.g. , a coalescing binary system .",
    "it is not clear how to choose the `` closest '' @xmath22 , and the corresponding free components in @xmath23 , so that the resulting @xmath7 and @xmath14 represents the inspiraling system at its late stage of inspiral .",
    "this late stage is the so - called `` intermediate challenge problem '' of binary black holes  @xcite , an area of much current interest .        with the initial data @xmath7 and @xmath14 specified ,",
    "we now consider their evolution in time .",
    "there are six evolution equations for the 3metric @xmath7 that are second order in time , resulting from projections of the full 4d einstein equations onto the 3d spacelike slice @xcite .",
    "these are most often written as a first - order - in - time system of twelve evolution equations , usually referred to as the `` adm '' evolution system  @xcite : @xmath33 \\nonumber\\\\      &    & + \\beta^{c}d_{c}k_{ab}+            k_{ac}d_{b}\\beta^{c}+k_{cb}d_{a}\\beta^{c}\\ ; .\\label{excurv evolution}\\end{aligned}\\ ] ] here @xmath34 is the ricci tensor of the 3d spacelike slice labeled by a constant value of @xmath6 .",
    "note that these are quantities defined only on a @xmath35 hypersurface , and require only the 3metric @xmath7 in their construction .",
    "do not confuse them with the conventional 4d objects ! the complete set of einstein equations are contained in constraint equations ( [ hamiltonian constraint ] ) , ( [ momentum constraint ] ) and the evolution equations ( [ excurv evolution ] ) , ( [ metric evolution ] ) .",
    "note that ( [ metric evolution ] ) is simply the definition of the extrinsic curvature @xmath14 ( [ kdef ] ) .",
    "these equations are analogous to the evolution equations for the electric and magnetic fields of electrodynamics . given the `` lapse '' @xmath9 and `` shift '' @xmath11 , discussed below , they allow one to advance the system forward in time .      the evolution equations ( [ excurv evolution ] ) , ( [ metric evolution ] ) have been presented in the `` standard adm form '' , which has served numerical relativity well over the last few decades .",
    "however , the equations are enormously complicated ; the complication is hidden in the definition of the curvature tensor @xmath34 and the covariant differentiation operator @xmath16 . in particular",
    ", although they describe physical information propagating with a finite speed , the system does not form a hyperbolic system , and is not necessarily the best for numerical evolution .",
    "other fields of physics , in particular hydrodynamics , have developed very mature numerical methods that are specially designed to treat the well studied flux conservative , hyperbolic system of balance laws having the form @xmath36 where the vector @xmath37 displays the set of variables and both `` fluxes '' @xmath38 and `` sources '' @xmath39 are vector valued functions . in hydrodynamic systems",
    ", it often turns out that the characteristic matrix @xmath40 projected into any spacelike direction can often be diagonalized , so that fields with definite propagation speeds can be identified ( the eigenvectors and the eigenvalues of the projected characteristic matrix ) .",
    "one important point is that in ( [ 3dbalance ] ) all spatial derivatives are contained in the flux terms , with the source terms in the equations containing no derivatives of the eigenfields .",
    "all of these features can be exploited in numerical finite difference schemes that treat each term in an appropriate way to preserve important physical characteristics of the solution .",
    "amazingly , the complete set of einstein equations can also be put in this `` simple '' form ( the source terms still contain thousands of terms however ) . building on earlier work by choquet - bruhat and ruggeri@xcite , bona and mass began to study this problem in the late 1980 s , and by 1992 they had developed a hyperbolic system for the einstein equations with a certain specific gauge choice@xcite ( see below ) . here by hyperbolic , we mean simply that the projected characteristic matrix has a complete set of eigenfields with real eigenvalues .",
    "this work was generalized recently to apply to a large family of gauge choices@xcite .",
    "the bona - mass system of equations is available in the 3d `` cactus '' code  @xcite , as is the standard adm system , where both are tested and compared on a number of spacetimes .",
    "the bona - mass system is now one among many hyperbolic systems , as other independent hyperbolic formulations of einstein s equations were developed@xcite at about the same time as ref .",
    "@xcite . among these other formulations",
    "only the one originally devised in ref .",
    "@xcite has been applied to spacetimes containing black holes@xcite , although still only in the spherically symmetry 1d case ( a 3d version is under development@xcite . ) hence , of the many hyperbolic variants , only the bona - mass family and the formulations of york and co - workers have been tested in any detail in 3d numerical codes . notably among the differences in the formulations , the bona - mass and fritelli families contain terms equivalent to second time derivatives of the three metric @xmath7 , while many other formulations go to a higher time derivative to achieve hyperbolicity . another comment worth making is that for harmonic slicing , both the bona - mass and york families have characteristic speeds of either zero , or light speed . for maximal",
    "slicing , they both reduce to a coupled elliptic - hyperbolic system .",
    "the bona - mass system ( at least ) also allows for an additional family of explicit algebraic slicings , with the lapse proportional to an explicit function of the determinant of the three ",
    "metric , and in those cases one can also identify gauge speeds which can be different from light speed ( harmonic slicing is one example of this family where the gauge speed corresponds to light speed ) . some of these slicings , such as `` 1+log ''  @xcite , have been found to be very useful in 3d numerical evolutions .",
    "this information about the speed of gauge and physical propagation can be very helpful in understanding the system , and can also be useful in developing numerical methods",
    ". only extensive numerical studies will tell if the various hyperbolic formulations live up to their promise .",
    "reula has recently reviewed , from the mathematical point of view , most of the recent hyperbolic formulations of the einstein equations@xcite ( this article , in the online journal `` living reviews in relativity '' , will be periodically updated ) .",
    "it is important to realize that the mathematical relativity field has been interested in hyperbolic formulations of the einstein equations for many years and some systems that could have been suitable for numerical relativity were already published in the 1980s@xcite .",
    "however , these developments were generally not recognized by the numerical relativity community until recently .",
    "most of what has been attempted in numerical relativity evolution schemes is built on explicit finite difference schemes .",
    "implicit and iterative evolution schemes have been occasionally attempted , but the extra cost associated has made them less popular .",
    "we now describe the basic approach that has been tried for both the standard adm formulation and more recent hyperbolic formulations of the equations .",
    "[ [ adm - evolutions ] ] adm evolutions + + + + + + + + + + + + + +    the adm system of evolution equations is often solved using some variation of the leapfrog method , similar to that described in have been used successfully .",
    "the most extensively tested is the `` staggered leapfrog '' , detailed in axisymmetric cases in ref .",
    "@xcite and in 3d in ref .",
    "@xcite , but other successful versions include full leapfrog implementations used in 3d by @xcite and @xcite . for the adm system ,",
    "the basic strategy is to use centered spatial differences everywhere , march forward according to some explicit time scheme , and hope for the best !",
    "generally , this technique has worked surprisingly well until large gradients are encountered , at which time the methods often break down .",
    "the problem is that the equations in this adm form are difficult to analyze , and hence ad hoc numerical schemes are often tried without detailed knowledge of how to treat specific terms in the equations , or how to treat instabilities when they arise .",
    "a recent development is that of the `` deloused '' leapfrog , which amounts to filtering the solution@xcite . also recently",
    ", the iterative crank - nicholson scheme has been found effective in suppressing some instabilities that occur  @xcite .    [ [ hyperbolic - evolutions ] ] hyperbolic evolutions + + + + + + + + + + + + + + + + + + + + +    the hyperbolic formulations are on a much firmer footing numerically than the adm formulation , as the equations are in a much simpler form that has been studied for many years in computational fluid dynamics . however , the application of such methods to relativity is quite new , and hence the experience with such methods in this community is relatively limited .",
    "furthermore , the treatment of the highly nonlinear source terms that arise in relativity is very much unexplored , and the source terms in einstein s equations are much more complicated than those in hydrodynamics .    a standard technique for equations having flux conservative form is to split eq .",
    "( [ 3dbalance ] ) into two separate processes .",
    "the transport part is given by the flux terms @xmath41 the source contribution is given by the following system of _ ordinary _ differential equations @xmath42 numerically , this splitting is performed by a combination of both flux and source operators .",
    "denoting by @xmath43 the numerical evolution operator for system ( [ 3dbalance ] ) in a single timestep , we implement the following combination sequence of subevolution steps : @xmath44 where @xmath45 , @xmath39 are the numerical evolution operators for systems ( [ 3dtransport ] ) and ( [ 3dsources ] ) , respectively .",
    "this is known as `` strang splitting ''  @xcite .",
    "as long as both operators @xmath45 and @xmath39 are second order accurate in @xmath46 , the overall step of operator @xmath47 is also second order accurate in time .",
    "this choice of splitting allows easy implementation of different numerical treatments of the principal part of the system without having to worry about the sources of the equations .",
    "additionally , there are numerous computational advantages to this technique , as discussed in @xcite .",
    "the sources can be updated using a variety of ode integrators , and in `` cactus '' the usual technique involves second order predictor - corrector methods .",
    "higher order methods for source integration can be easily implemented , but this will not improve the overall order of accuracy .",
    "however , in special cases where the evolution is largely source driven@xcite , it may be important to use higher order source operators , and this method allows such generalizations .",
    "the details can be found in ref .",
    "@xcite .",
    "the implementation of numerical methods for the flux operator is much more involved , and there are many possibilities , ranging from standard choices to advanced shock capturing methods@xcite . among standard methods , the maccormack method , which has proven to be very robust in the computational fluid dynamics field ( see , e.g. , ref .",
    "@xcite and references therein ) , and a directionally split lax - wendroff method have been implemented and tested extensively in `` cactus '' .",
    "these schemes are fully second order in space and time .",
    "shock capturing methods have been shown to work extremely well in 1d problems in numerical relativity  @xcite , but their application in 3d is an active research area full of promise , but as yet , unfulfilled .",
    "the details of these methods , as they are applied to the bona - mass formulation of the equations , can be found in refs .",
    "@xcite .",
    "if the constraints are satisfied on the initial hypersurface , the evolution equations then guarantee that they remain satisfied on all subsequent hypersurfaces .",
    "thus once the initial value problem has been solved , one may advance the solution forward in time by using only the evolution equations .",
    "this is the same situation encountered in electrodynamics as discussed above .",
    "however , in a numerical solution , the constraints will be violated at some level due to numerical error .",
    "they hence provide useful indicators for the accuracy of the numerical spacetimes generated .",
    "traditional alternatives to this approach , which is often referred to as `` free evolution '' , involve solving some or all of the constraint equations on each slice for certain metric and extrinsic curvature components , and then simply monitoring the `` left over '' evolution equations .",
    "this issue is discussed further by choptuik in @xcite , and in detail for the schwarzschild spacetime in @xcite .",
    "new approaches to this problem of constraint vs. evolution equations are currently being pursued by lee  @xcite , among others .",
    "this approach is to advance the system forward using the evolution equations , and then adjust the variables slightly so that the constraints are satisfied ( to some tolerance ) , i.e. , the solution is projected onto the constraint surface . because there are many variables that go into the constraints ,",
    "there is not a unique way to decide which ones to adjust and by how much .",
    "but one can compute the `` minimum '' perturbation to the system , which corresponds to projecting to the _ closest _ point on the constraint surface .",
    "other approaches , similar in spirit to each other , have been suggested by detweiler  @xcite and brodbeck et al  @xcite .",
    "the detweiler approach restricts the numerical evolution to the constraint surface by adding terms to the evolution equations ( [ metric evolution ] ) , ( [ excurv evolution ] ) terms which are proportional to the constraints .",
    "numerical tests of the scheme using gravitational wave spacetimes have recently been carried out , showing promising results  @xcite .",
    "kinematic conditions for the lapse function @xmath9 and shift vector @xmath48 have to be specified for the evolution equations ( [ metric evolution ] ) , and ( [ excurv evolution ] ) . with @xmath7 and @xmath14 satisfying the constraint on the initial slice ,",
    "the lapse and shift can be chosen _",
    "arbitrarily _ on the initial slice and thereafter .",
    "these are referred to as gauge choices , analogous to the choice of the gauge function @xmath49 in electrodynamics .",
    "einstein did not specify these quantities ; they are up to the numerical relativist to choose at will .",
    "[ [ lapse . ] ] lapse .",
    "+ + + + + +    the choice of lapse corresponds to how one chooses 3d spacelike hypersurfaces in the 4d spacetime .",
    "the `` lapse '' of _ proper _ time along the normal vector of one slice to the next is given by @xmath50 , where @xmath51 is the _ coordinate _ time interval between slices .",
    "as @xmath52 can be chosen at will on a given slice , some regions of spacetime can be made to evolve farther into the future than others .",
    "there are many motivations for particular choices of lapse .",
    "a primary concern is to ensure that it leads to a stable long term evolution .",
    "it is easy to see that a naive choice of the lapse , e.g. , @xmath53 , the so - called geodesic slicing , suffers from a strong tendency to produce coordinate singularities  @xcite .",
    "a related concern is that one would like to cover the region of interest in an evolution , say , where gravitational waves generated by some process could be detected , while avoiding troublesome regions , say , inside black holes where singularities lurk ( the so - called `` singularity avoiding '' time slicings ) .",
    "another important motivation is that some choices of @xmath9 allow one to write the evolution equations in forms that are especially suited to numerical evolution .",
    "finally , computational considerations also play important role in choice of the lapse ; one prefers a condition for @xmath9 that does not involve great computational expense , while also providing smooth , stable evolution .",
    "some `` traditional '' choices of the lapse used in the numerical construction of spacetimes are  @xcite : ( 1 . ) lagrangian slicing , in which the coordinates are following the flow of the matter in the simulation .",
    "this choice simplifies the matter evolution equations , but it is not alway applicable , e.g. , in a vacuum spacetime or when the fluid flow pattern becomes complicated .",
    "maximal slicing ,  @xcite in which the trace of the extrinsic curvature is required to be zero always , i.e , @xmath54 .",
    "the evolution equations of the extrinsic curvature then lead to an elliptic equation for the lapse @xmath55 the maximal slicing has the nice property of causing the lapse to `` collapse '' to a small value at regions of strong gravity , hence avoiding the region that a curvature singularity is forming .",
    "it is one of the so - called `` singularity avoiding slicing conditions '' .",
    "maximal slicing is easily the most studied slicing condition in numerical relativity .",
    "constant mean curvature , where we let @xmath56 different from zero , a choice often used in constructing cosmological solutions .",
    "algebraic slicing , where the lapse is given as an algebraic function of the determinant of the three metric .",
    "algebraic slicing can also be singularity avoiding  @xcite . as there is no need to solve an elliptic equation as in the case of maximal slicing ,",
    "algebraic slicing is computationally efficient . some algebraic slicings ( e.g. , the harmonic slicing in which @xmath9 is set proportional to the square root of the determinant of the 3-metric @xmath57 ) also make the mathematical structure of the evolution equations simpler .",
    "however , the local nature of the choice of the lapse could lead to noise in the lapse  @xcite and the formation of `` shock '' like features in numerical evolutions  @xcite .",
    "the former problem can be dealt with by turning the algebraic slicing equation to an evolution equation with a diffusion term  @xcite , but the latter problem does not seem to have a simple solution .",
    "in addition to these most widely used `` traditional '' choices of the lapse , there are also some newly developed slicing conditions whose use in numerical relativity though promising remain to be largely unexplored  @xcite : ( 5 . )",
    "k - driver .",
    "this is a generalization of the maximal slicing in which the extrinsic curvature , instead of being set to zero , is required to satisfy the condition @xmath58 where c is some positive constant .",
    "this was first brought up by eppley ,  @xcite and recently investigated in of the extrinsic curvature , when numerical inaccuracy causes it to drift away from zero , is `` driven '' back to zero exponentially . when combined with the evolution equations , ( [ kdrive ] ) again leads to an elliptic equation for the lapse .",
    "this choice of the lapse is shown  @xcite to lead to a much more stable numerical evolution in cases where one wants to avoid large values of the extrinsic curvature .",
    "the optimal choice of the constant @xmath3 as well as a number of variations on this `` driver '' scheme are presently being studied .",
    "@xmath59- driver .",
    "this is another use of the `` driver '' idea . in this case , the time rate of change of the determinant of the three metric @xmath60 is driven to zero  @xcite . in the absent of a shift vector or if the shift has zero divergence , this reduces to the k - driver .",
    "this choice of the lapse , which has the unique property of being able to respond to the choice of the shift , demands extensive investigations and evaluations .    [",
    "[ shift . ] ] shift .",
    "+ + + + + +    the shift vector describes the `` shifting '' of the coordinates from the normal vector as one moves from one slice to the next .",
    "if the shift vanishes , the coordinate point @xmath61 will move normal to a given 3d time slice to the next slice in the future .",
    "please refer to york  @xcite or cook  @xcite , for details and diagrams .",
    "the choice of shift is perhaps less well developed than the choice of lapse in numerical relativity , and many choices need to be explored , particularly in 3d .",
    "the main purpose of the shift is to ensure that the coordinate description of the spacetime remains well behaved throughout the evolution . with an inappropriate or poorly chosen shift",
    ", coordinate lines may move toward each other , or become very stretched or sheared , leading to pathological behavior of the metric functions that may be difficult to handle numerically .",
    "it may even cause the code to crash , if for example , two coordinate lines `` touch '' each other creating a `` coordinate singularity '' ( i.e. , the metric becomes singular as the distance @xmath62 between two coordinate lines goes to zero ) .",
    "two important considerations for appropriate shift conditions are the ability to prevent large shearing or drifting of coordinates during an evolution , and the ability to control the coordinate location of a physical object , e.g. , the horizon of a black hole .",
    "these considerations are discussed below .",
    "the development of appropriate shift conditions for full 3d evolution , for systems without symmetries , is an important research area that needs much attention .",
    "geometrical shift conditions that can be formulated without reference to specific coordinate systems or symmetries seem to be desirable .",
    "the basic idea is to develop a condition that minimizes the stretching , shearing , and drifting of coordinates in a general way .",
    "a few examples have been devised which partially meet these goals , such as `` minimal distortion '' , `` minimal strain '' , and variations @xcite , but much more investigations are needed .",
    "new gauge conditions , based on these earlier proposals , have recently been proposed but not yet tested in numerical simulations  @xcite .",
    "it is important to emphasize that the lapse and shift _ only _ change the way in which the slices are chosen through a spacetime and where coordinates are laid down on every slice , and do _ not _ , in principle , affect any physical results whatsoever .",
    "they _ will _ affect the value of the metric quantities , but not the physics derived from them . in this respect",
    "the freedom of choice in the lapse and shift is analogous to the freedom of gauge in electromagnetic systems .    on the other hand ,",
    "it is also important to emphasize that proper choices of lapse and shift are crucial for the numerical construction of a spacetime in the einstein theory of general relativity , in particular in a general 3d setting . in a general 3d simulation without symmetry assumption",
    ", there is no preferred choice of the form of the metric ( e.g. , a diagonal 3-metric , or @xmath63 as in spherical symmetry ) , hence forcing us to deal with the gauge degree of freedom in relativity in full .",
    "this , when coupled with the inevitable lower resolution in 3d simulations , often leads to development of coordinate singularities , when evolved without a sophisticated choice of lapse and shift .",
    "indeed the success of the `` driver '' idea suggested  @xcite that in order to obtain a stable evolution over a long time scale , it is important to ensure that the coordinate conditions used are not only suitable for the geometry of the spacetime being evolved , but also that _ the conditions themselves are stable_. that is , when the condition is perturbed , e.g. , by numerical inaccuracy , there is no long term secular drifting .",
    "we regard the construction of an algorithm for choosing a suitable lapse and shift for a general 3d numerical simulation to be one of the most important issues facing numerical relativity at present .      in order to make numerical relativity a tool for computational general relativistic astrophysics ,",
    "it is important to combine numerical relativity with traditional tools of computational astrophysics , and in particular relativistic hydrodynamics .",
    "while a large amount of 3d studies in numerical relativity have been devoted to the _ vacuum _ einstein equations , the spacetime dynamics with a non - vanishing source term remains a large uncharted territory . as astrophysics of compact objects that needs general relativity for",
    "its understanding is attracting increasing attention , general relativistic hydrodynamics will become an increasingly important subject as astrophysicists begin to study more relativistic systems , as relativists become more involved in studies of astrophysical sources .",
    "this promises to be one of the most exciting and important areas of research in relativistic astrophysics in the coming years .",
    "previously , most work in relativistic hydrodynamics has been done on fixed metric backgrounds . in this approximation the fluid",
    "is allowed to move in a relativistic manner in strong gravitational fields , say around a black hole , but its effect on the spacetime is not considered . over the last years",
    "very sophisticated methods for general relativistic hydrodynamics have been developed by the valencia group led by jos m. ibez  @xcite .",
    "these methods are based on a hyperbolic formulation of the hydrodynamic equations , and are shown to be superior to traditional artificial viscosity methods for highly relativistic flows and strong shocks .",
    "however , just fixed background approximation is inadequate in describing a large class of problems which are of most interest to gravitational wave astronomy , namely those with substantial matter motion generating gravitational radiation , like the coalescences of neutron star binaries .",
    "as will be discussed in more detail below , we are constructing a multi - purpose 3d code for the nasa neutron star grand challenge project  @xcite that contains the full einstein equations coupled to general relativistic hydrodynamics .",
    "the spacetime part of the code is based on the `` cactus '' code ; the hydrodynamic part consists of both an artificial viscosity module ,  @xcite and a module ( mahc hyperbolic_hydro ) based on modern shock capturing schemes  @xcite .    the `` mahc '' general relativistic hydro code at present contains three hydro evolution methods  @xcite : a flux split method , roe s approximate riemann solver  @xcite and marquina s approximate riemann solver  @xcite .",
    "all three are based on finite - difference schemes employing approximate riemann solvers to account explicitly for the characteristic information of the equations .",
    "these schemes are particularly suitable for astrophysics simulations that involve matter in ( ultra)relativistic speeds and strong shock waves .    in the flux split method , the flux is decomposed into the part contributing to the eigenfields with positive eigenvalues ( fields moving to the right ) and the part with negative eigenvalues ( fields moving to the left ) .",
    "these fluxes are then discretized with one sided derivatives ( which side depends on the sign of the eigenvalue ) .",
    "the flux split method presupposes that the equation of state of the fluid has the form @xmath64 , which includes , e.g. , the adiabatic equation of state .",
    "the second scheme , roe s approximate riemann solver  @xcite is by now a `` traditional '' method for the integration of non - linear hyperbolic systems of conservation laws .",
    "@xcite this method makes no assumption on the equation of state , and , is more flexible than the flux split methods .",
    "the third method , the marquina s method , is a promising new scheme.@xcite it is based on a flux formula which is an extension of shu and osher s entropy - satisfying numerical flux  @xcite to systems of hyperbolic conservation laws . in this scheme there are no artificial intermediate states constructed at each cell interface .",
    "this implies that there are no riemann solutions involved ( either exact or approximate ) ; moreover , the scheme has been proved to alleviate several numerical pathologies associated to the introduction of an _ averaged _ state ( as roe s method does ) in the local diagonalization procedure ( see  @xcite ) . for a detailed comparison of the three schemes and their coupling to dynamical evolution of spacetimes ,",
    "see  @xcite .",
    "the availability of the hyperbolic hydro treatment and its coupling to the spacetime evolution code is particularly noteworthy . with the development of a hyperbolic formulation of the einstein equations described above , the _",
    "entire _ system can be treated as a single system of hyperbolic equations , rather than artificially separating the spacetime part from the fluid part .",
    "such a unified treatment based on the `` mahc '' module is presently under construction by our ncsa / potsdam / washu collaboration .",
    "appropriate conditions for the outer boundary have yet to be derived for 3d numerical relativity . in 1d and 2d relativity codes ,",
    "the outer boundary is generally placed far enough away that the spacetime is nearly flat there , and static or flat ( i.e. , copying data from the next - to - last zone to the outer edge ) boundary conditions can usually be specified for the evolved functions . however , due to the constraints placed on us by limited computer memory , this is not currently possible in 3d .",
    "adaptive mesh refinement will be of great use in this regard , but will not substitute for proper physical treatment .",
    "most results to date have been computed with the evolved functions kept static at the outer boundary , even if the boundaries are too close for comfort in 3d !",
    "there are several other approaches under development that promise to improve this situation greatly that we will not have room to explore in detail here , but should be mentioned .",
    "generally , one has in mind using cauchy evolution in the strong field , interior region where , say , black holes are colliding .",
    "this outer part of this region will be matched to some exterior treatment designed to handle what is primarily expected to be outgoing radiation .",
    "two major approaches have been developed by the nsf black hole grand challenge alliance , a large us collaboration working to solve the black hole coalescence problem , and other groups .",
    "first , by using perturbation theory , it is possible to identify quantities in the numerically evolved metric functions that obey the regge - wheeler and zerilli wave equations that describe gravitational waves propagating on a black hole background .",
    "these can be used to provide boundary conditions on the metric and extrinsic curvature functions in an actual evolution , as described in a recent paper  @xcite .",
    "this is an excellent step forward in outer boundary treatments that should work to minimize reflections of the outgoing wave signals from the outer boundary . in tests with weak waves ,",
    "a full 3d cauchy evolution code has been successfully matched to the perturbative treatment at the boundary , permitting waves to escape from the interior region with very little reflection .",
    "alternatively , `` cauchy - characteristic matching '' attempts to match spacelike slices in the cauchy region to null slices at some finite radius , and the null slices can be carried out to null infinity .",
    "3d characteristic evolution codes have progressed dramatically in recent years , and although the full 3d matching remains to be completed , tests of the scheme in specialized settings show promise@xcite .",
    "one can also use the hyperbolic formulations of the einstein equations to find eigenfields , for which outgoing conditions can in principle be applied@xcite in 1d . in 3d this technique is still under development , but it shows promise for future work .",
    "finally , there is another hyperbolic approach which uses conformal rescaling to move the boundary to infinity  @xcite .",
    "these methods have different strengths and weaknesses , but all promise to improve boundary treatments significantly , helping to enable longer evolutions than are presently possible .",
    "the techniques described so far are generic in their application in numerical relativity .",
    "but in this section we describe a few problems that are characteristic of black holes , and special algorithms under development to handle them .",
    "black hole spacetimes all have in common one problem : singularities lurk within them , which must be handled numerically . developing suitable techniques for doing so is one of the major research priorities of the community at present .",
    "if one attempts to evolve directly into the singularity , infinite curvature will be encountered , causing any numerical code to break down .",
    "traditionally , the singularity region is avoided by the use of `` singularity avoiding '' time slices , that wrap up around the singularity .",
    "consider the evolution shown in fig .",
    "[ singularity ] .",
    "a star is collapsing , a singularity is forming , and time slices are shown which avoid the interior while still covering a large fraction of the spacetime where waves will be seen by a distant observer .",
    "however , these slicing conditions by themselves do not solve the problem ; they merely serve to delay the onset of instabilities . as shown in fig .",
    "[ singularity ] , in the vicinity of the singularity these slicings inevitably contain a region of abrupt change near the horizon , and a region in which the constant time slices dip back deep into the past in some sense .",
    "this behavior typically manifests itself in the form of sharply peaked profiles in the spatial metric functions  @xcite , `` grid stretching ''  @xcite or large coordinate shift  @xcite on the bh throat , etc .",
    "numerical simulations will eventually fail due to these pathological properties of the slicing .",
    "[ singularity ]      the cosmic censorship conjecture suggests that in physical situations , singularities are hidden inside bh horizons . because the region of spacetime inside the horizon is causally disconnected from the region of interest outside the horizon , one is tempted numerically to cut away the interior region containing the singularity , and evolve only the singularity - free region outside , as originally suggested by unruh@xcite .",
    "this has the consequence that there will be a region inside the horizon that simply has no numerical data .",
    "to an outside observer no information will be lost since the regions cut away are unobservable .",
    "because the time slices will not need such sharp bends to the past , this procedure will drastically reduce the dynamic range , making it easier to maintain accuracy and stability . since the singularity is removed from the numerical spacetime ,",
    "there is in principle no physical reason why bh codes can not be made to run indefinitely without crashing .",
    "we spoke innocently about the bh horizon , but did not distinguish between the _ apparent _ and _ event _ horizon .",
    "these are very different concepts ! while the event horizon , which is roughly a null surface that never reaches infinity and never hits the singularity , may hide singularities from the outside world in many situations , there is no guarantee that the apparent horizon , which is the ( outermost ) surface that has instantaneously zero expansion everywhere , even exists on a given slice !",
    "( by `` zero expansion '' we mean that the surface area of outgoing bundles of photons normal to the surface is constant",
    ". hence , the surface is `` trapped . '' ) methods for finding event horizons in numerical spacetimes are now known , and will be discussed below . but event horizons can only be found after examining the _ history _ of an evolution that has been already been carried out to sufficiently late times@xcite . hence they are useless in providing boundaries as one integrates _",
    "forward _ in time . on the other hand the apparent horizon ,",
    "if it exists , can be found on any given slice by searching for closed 2surfaces with zero expansion .",
    "although one should worry that in a generic bh collision , one may evolve into situations where no apparent horizon actually exists , let us cross that bridge if we come to it .",
    "methods for finding apparent horizons will also be discussed below , but for now we assume that such a method exists .    given these considerations ,",
    "there are two basic ideas behind the implementation of the apparent horizon boundary condition ( ahbc ) , also known as black hole excision :    _ ( a ) _ it is important to use a finite differencing scheme which respects the causal structure of the spacetime .",
    "since the horizon is a one - way membrane , quantities on the horizon can be affected only by quantities outside but not inside the horizon : all quantities on the horizon can in principle be updated solely in terms of known quantities residing on or outside the horizon .",
    "there are various technical details and variations on this idea , which is called `` causal differencing''@xcite or `` causal reconnection''@xcite , but here we focus primarily on the basic ideas and results obtained to date .",
    "_ ( b ) _ a shift is used to control the motion of the horizon , and the behavior of the grid points outside the bh , as they tend to fall into the horizon if uncontrolled .    an additional advantage to using causal differencing is that it allows one to follow the information flow to create grid points with proper data on them , as needed inside the horizon , even if they did not exist previously .",
    "( remember above that we have cut away a region inside the horizon , so in fact we have no data there . )",
    "one example is to let a bh move across the computational grid .",
    "if a bh is moving physically , it may also be desirable to have it move through coordinate space .",
    "otherwise , all physical movement will be represented by the `` motion '' of the grid points . for a single bh moving in a straight line",
    ", this may be possible ( though complicated ) , but for spiraling coalescence this will lead to hopelessly contorted grids .",
    "the immediate consequence of this is that as a bh moves across the grid , regions in the wake of the hole , now in its exterior , must have previously been inside it where no data exist ! but with ahbc and causal differencing this need not be a problem .",
    "does the ahbc idea work ?",
    "preliminary indications are very promising . in spherical symmetry ( 1d ) ,",
    "numerous studies show that one can locate horizons , cut away the interior , and evolve for essentially unlimited times ( @xmath65 , where @xmath66 is the black hole mass ) .",
    "the growth of metric functions can be completely controlled , errors are reduced to a very low level , and the results can be obtained with a large variety of shift and slicing conditions , and with matter falling in the bh to allow for true dynamics even in spherical symmetry@xcite .    in 3d ,",
    "the basic ideas are similar but the implementation is much more difficult . the first successful test of these ideas to a schwarzschild bh in 3d used horizon excision and a shift provided from similar simulations carried out with a 1d code@xcite .",
    "the errors were found to be greatly reduced when compared even to the 1d evolution with singularity avoiding slicings .",
    "another 3d implementation of the basic technique was provided by brgmann  @xcite .",
    "this was a proof of principle , but more general treatments are following .",
    "daues extended this work to a full range of shift conditions  @xcite , including the full 3d minimal distortion shift  @xcite .",
    "he also applied these techniques to dynamic bh s , and collapse of a star to form a bh , at which point the horizon is detected , the region interior to the horizon excised , and the evolution continued with ahbc .",
    "the focus of this work has been on developing general gauge conditions for single bh s without movement through a grid . under these conditions , bh s have been accurately evolved well beyond @xmath67 .",
    "the nsf black hole grand challenge alliance had focussed on development of 3d ahbc techniques for moving schwarzschild bhs@xcite . in this work ,",
    "analytic gauge conditions are provided , which are chosen to make the evolution static , although the numerical evolution is allowed to proceed freely .",
    "this moving hole is the first successful 3d test of populating grid points with data as they emerge in the bh wake .",
    "these new results are significant achievements , and show that the basic techniques outlined above are not only sound , but are also practically realizable in a 3d numerical code .",
    "however , there is still a significant amount of work to be done !",
    "the techniques have yet to be applied carefully to distorted bh s , with tests of the waveforms emitted .",
    "they have not been applied to rotating bh s of any kind ; they have not been applied to colliding bh s with horizon topology change , and moving black holes have yet to be evolved in ahbc with a nonanalytic gauge choice .",
    "there are still clearly many steps to be taken before the techniques will be successfully applied to the general bh merger problem .",
    "we now turn to the description of several important tools that have been developed to analyze the results of a numerical evolution , carried out by some numerical evolution scheme . the evolution will generally provide metric functions on a grid , but as described above these functions are highly dependent on both the coordinate system and gauge in which the system is evolved . determining _ physical _ information , such as whether a black hole exists in the data , or what gravitational waveforms have been emitted , are the subjects of this section .",
    "as described above , black holes are defined by the existence of an event horizon ( eh ) , the surface of no return from which nothing , not even light , can escape . the event horizon is the boundary that separates those null geodesics that reach infinity from those that do not .",
    "the global character of such a definition implies that the position of an eh can only be found if the whole history of the spacetime is known . for numerical simulations of black hole spacetimes in particular",
    ", this implies that in order to locate an eh one needs to evolve sufficiently far into the future , up to a time where the spacetime has basically settled down to a stationary solution .",
    "recently , methods have been developed to locate and analyze black hole horizons in numerically generated spacetimes , with a number of interesting results obtained  @xcite .",
    "in contrast , an apparent horizon ( ah ) is defined locally in time as the outer - most marginally trapped surface  @xcite , i.e. a surface on which the expansion of out - going null geodesics is everywhere zero .",
    "an ah can therefore be defined on a given spatial hypersurface . a well known result  @xcite guarantees that if an ah is found , an eh must exist somewhere outside of it and hence a black hole has formed .      the expansion @xmath68 of a congruence of null rays moving in the outward normal direction to a closed surface can be shown to be  @xcite @xmath69 where @xmath70 is the covariant derivative associated with the 3-metric @xmath71 , @xmath72 is the normal vector to the surface , @xmath73 is the extrinsic curvature of the time slice , and @xmath74 is its trace .",
    "an ah is then the outermost surface such that @xmath75 this equation is not affected by the presence of matter , since it is purely geometric in nature .",
    "we can use the same horizon finders without modification for vacuum as well as non - vacuum spacetimes .",
    "the key is to find a closed surface with normal vector @xmath72 satisfying this equation .      as apparent horizons are defined by the vanishing of the expansion on a surface , a fairly obvious algorithm to find such a surface involves minimizing a suitable norm of the expansion below some tolerance while adjusting test surfaces .",
    "minimization algorithms for finding apparent horizons were among the first methods developed  @xcite .",
    "more recently , a 3d minimization algorithm was developed and implemented by the potsdam / ncsa / washu group , applied to a variety of black hole initial data and 3d numerically evolved black hole spacetimes  @xcite .",
    "essentially the same algorithm was also implemented independently by baumgarte _ et.al .",
    "_  @xcite .",
    "the basic idea behind a minimization algorithm is to assume the surface can be represented by a function @xmath76 , expand it the in terms of some set of basis functions , and then minimize the integral of the square of the expansion @xmath77 over the surface . for example , one can parameterize a surface as @xmath78 the surface under consideration will be taken to correspond to the zero level of @xmath79 . the function @xmath80",
    "is then expanded in terms of spherical harmonics : @xmath81 similar techniques were developed by  @xcite .    at an ah the expansion integral over the surface",
    "should vanish , and we will have a global minimum . of course , since numerically we will never find a surface for which the integral vanishes exactly , one must set a given tolerance level below which a horizon is assumed to have been found .",
    "minimization algorithms for finding ah s have a few drawbacks : first , the algorithm can easily settle down on a local minimum for which the expansion is not zero , so a good initial guess is often required . moreover , when more than one marginally trapped surface is present , as is often the case , it is very difficult to predict which of these surfaces will be found by the algorithm : the algorithm can often settle on an inner horizon instead of the true ah .",
    "again , a good initial guess can help point the finder towards the correct horizon .",
    "finally , minimization algorithms tend to be very slow when compared with ` flow ' algorithms of the type described in the next section . typically , if @xmath82 is the total number of terms in the spectral decomposition , a minimization algorithm requires of the order of a few times @xmath83 evaluations of the surface integrals ( where in our experience ` a few ' can sometimes be as high as 10 ) .",
    "this algorithm has been implemented in the `` cactus '' code for 3d numerical relativity  @xcite .",
    "for more details of the application of this algorithm , see refs .",
    "@xcite .      a second method that has been implemented in the `` cactus '' code is the `` fast flow '' method proposed by gundlach  @xcite . starting from an initial guess for the @xmath84 , it approaches the apparent horizon through the iteration @xmath85 where @xmath86 labels the iteration step , @xmath87 is some positive definite function ( `` a weight '' ) , and @xmath88 are the harmonic components of the function @xmath89 . various choices for the weight @xmath87 and the coefficients @xmath90 and @xmath91 parameterize a family of such methods .",
    "the fast flow algorithm in cactus uses @xmath92^{-1 } , \\ ] ] where @xmath93 is the flat background metric associated with the coordinates @xmath94 , and @xmath95 with @xmath96 and @xmath97 . here",
    "@xmath3 is a variable step size , with a typical value of @xmath98 .",
    "@xmath99 is the maximum value of @xmath100 one chooses to use in describing the surface .",
    "the iteration procedure is a finite difference approximation to a parabolic flow , and the adaptive step size is chosen to keep the finite difference approximation roughly close to the flow limit to prevent overshooting of the true apparent horizon .",
    "the adaptive step size is determined by a standard method used in ode integrators : we take one full step and two half steps and compare the resulting @xmath84 .",
    "if the two results differ too much one from another , the step size is reduced .    other methods for finding apparent horizons , based directly on computing the jacobian of the finite differenced horizon equation , have been developed@xcite and successfully used in 3d . for details",
    ", please see these references .",
    "the ah is defined locally in time and hence is much easier to locate than the event horizon ( eh ) in numerical relativity .",
    "the eh is a global object in time ; it is traced out by the path of outgoing light rays that _ never _ propagate to future null infinity , and _ never _ hit the singularity .",
    "( it is the boundary of the causal past of future null infinity @xmath101 . ) in principle one needs to know the entire time evolution of a spacetime in order to know the precise location of the eh .",
    "however , in spite of the global properties of the eh , hope is not lost for finding it very accurately , even in a numerical simulation of finite duration . here",
    "we discuss a method to find the eh , given a numerically constructed black hole spacetime that eventually settles down to an approximately stationary state at late times . in principle , as the eh is a null surface , it can be found by tracing the path of null rays through time .",
    "outward going light rays emitted just outside the eh will diverge away from it , escaping to infinity , and those emitted just inside the eh will fall away from it , towards the singularity . in a numerical integration it is difficult to follow accurately the evolution of a horizon generator forward in time , as small numerical errors cause the ray to drift and diverge rapidly from the true eh .",
    "it is a physically unstable process .",
    "but we can actually use this property to our advantage by considering the time - reversed problem . in a global sense in time ,",
    "any outward going photon that begins near the eh will be _ attracted _ to the horizon if integrated _",
    "backward _ in time  @xcite . in integrating backwards in time ,",
    "it turns out that it suffices to start the photons within a fairly broad region where the eh is expected to reside .",
    "such a horizon - containing region , as we call it , is often easy to determine after the spacetime has settled down to approximate stationarity .",
    "the crucial point is that when integrated backward in time along null geodesics , this horizon - containing region shrinks rapidly in `` thickness '' , leading to a very accurate determination of the location of the eh at earlier times .",
    "note that it is the earlier time when the black hole is under highly dynamical evolution that we are really interested in .    although one can integrate individual null geodesics backward in time",
    ", we find that there are various advantages to integrate the entire null surface backward in time .",
    "a null surface , if defined by @xmath102 satisfies the condition @xmath103 hence the evolution of the surface can be obtained by a simple integration , @xmath104 the inner and outer boundary of the horizon containing region when integrated backward in time , will rapidly converge to practically a single surface to within the resolution of the numerically constructed spacetime , i.e. , a small fraction of a grid point .",
    "an accurate location of the event horizon is hence obtained .",
    "we henceforth shall represent the horizon surface as the function @xmath105 .",
    "aside from the simplicity of this method , there are a number of technical advantages as discussed in  @xcite .",
    "one particularly noteworthy point is that this method is capable of giving the caustic structure of the event horizon if there is any ; for details see  @xcite .",
    "the function @xmath105 provides the complete coordinate location of the eh through the spacetime ( or a very good approximation of it , as shown in  @xcite ) .",
    "this function by itself directly gives us the topology and location of the eh .",
    "when combined with the induced metric function on the surface , which is recorded throughout the evolution , it gives the intrinsic geometry of the eh .",
    "when further combined with the spacetime metric , all properties of the eh including its embedding can be obtained . moreover , as the normal of @xmath106 gives the null generators of the horizon , it is an easy further step to determine the null generators , and hence the complete dynamics of the horizon in this formulation .",
    "as described in a series of papers , the event horizon , once found with such a method , can be analyzed to provide important information about the dynamics of black holes in a numerically generated spacetime  @xcite .",
    "the gravitational radiation emitted is one of the most important quantities of interest in many astrophysical processes .",
    "the radiation is generated in regions of strong and dynamic gravitational fields , and then propagated to regions far away where it will someday be detected .",
    "we take the approach of computing the generation and evolution of the fields in a fully nonlinear way , while analyzing the radiation with a perturbation formulation in the regions where it can be so treated .",
    "the theory of black hole perturbations is well developed .",
    "one identifies certain perturbed metric quantities that evolve according to wave equations on the black hole background .",
    "these perturbed metric functions are also dependent of the gauge in which they are computed .",
    "we use a _ gauge - invariant _",
    "prescription for isolating wave modes on black hole background , developed first by moncrief  @xcite .",
    "the basic idea is that although the perturbed metric functions transform under coordinate transformations ( gauge transformations ) , one can identify certain linear combinations of these functions that are invariant to first order of the perturbation .",
    "these gauge - invariant functions are the quantities that carry true physics , which does not depend on coordinate systems .",
    "they obey the wave equations describing waves propagating on the fixed blackhole background .",
    "there are two independent wave modes , even- and odd - parity , corresponding to the two degrees of freedom , or polarization modes , of the waves .",
    "a _ waveform extraction _ procedure has been developed that allows one to process the metric and to identify the wave modes .",
    "the gravitational wave function ( often called the `` zerilli function '' for even - parity or the `` regge - wheeler function '' for odd - parity ) can be computed by writing the metric as the sum of a background black hole part and a perturbation : @xmath107 where the perturbation @xmath108 is expanded in spherical harmonics and their tensor generalizations and the background part @xmath109 is spherically symmetric . to compute the elements of @xmath108 in a numerical simulation ,",
    "one integrates the numerically evolved metric components @xmath110 against appropriate spherical harmonics over a coordinate 2sphere surrounding the black hole , making use of the orthogonality properties of the tensor harmonics .",
    "this process is performed for each @xmath111 mode for which waveforms are desired .",
    "the resulting functions @xmath112 can then be combined in a gauge - invariant way , following the prescription given by moncrief@xcite .",
    "for each @xmath113 mode , this gauge invariant gravitational waveform can be extracted when the wave passes through `` detectors '' at some fixed radius in the computational grid .",
    "this procedure has been described in detail in  @xcite , and more generally in refs .",
    "it works amazingly well , allowing extraction of waves that carry very small energies ( of order @xmath114 or less , with @xmath66 being the mass of the source ) away from the source .",
    "the procedure should apply to any isolated source of waves , such as colliding black holes , neutron stars , etc .",
    "if the sources are rotating , this procedure should be generalized to use the teukolsky formalism describing perturbations about a kerr black hole , but this has not yet been done . instead , the spherical perturbation theory ( with a few minor modifications ) has been applied to distorted rotating black holes with satisfactory results  @xcite .",
    "before we describe our computational methods in the following subsections , we summarize the computational challenges of numerical relativity discussed above .",
    "it is in response to these challenges that we have devised the computational methods .",
    "@xmath115 computational challenges due to the complexity of the physics involved : the einstein equations are probably the most complex partial differential equations in all of physics , forming a system of dozens of coupled , nonlinear equations , with thousands of terms , of mixed hyperbolic , elliptic , and even undefined types in a general coordinate system .",
    "the evolution has elliptic constraints that should be satisfied at all times . in simulations without symmetry , as would be the case for realistic astrophysical processes , codes can involve hundreds of 3d arrays , and ten of thousands of operations per grid point per update . moreover , for simulations of astrophysical processes , we will ultimately need to integrate numerical relativity with traditional tools of computational astrophysics , including hydrodynamics , nuclear astrophysics , radiation transport and magneto - hydrodynamics , which govern the evolution of the source terms ( i.e. , the right hand side ) of the einstein equations .",
    "this complexity requires us to push the frontiers of massively parallel computation .",
    "@xmath115 challenge in collaborative technology : the integration of numerical relativity into computational astrophysics is a multi - disciplinary development , partly due to the complexity of the einstein equations , and partly due to the physical systems of interest .",
    "solving the einstein equations on massively parallel computers involves gravitational physics , computational science , numerical algorithm and applied mathematics .",
    "furthermore , for the numerical simulations of realistic astrophysical systems , many physics disciplines , including relativity , astrophysics , nuclear physics , and hydrodynamics are involved .",
    "it is therefore essential to have the numerical code software engineered to allow co - development by different research groups _ and _ groups with different expertise .",
    "@xmath115 the numerical construction of a spacetime itself presents unique challenges : according to the singularity theorems of general relativity , regions of strong gravity often generate spacetime singularities . due to the need to avoid spacetime singularities  @xcite , and to obtain long term stability in the numerical simulations , sophisticated control of the coordinate system",
    "is needed for the construction of a numerical spacetime .",
    "this dynamic interplay between the spacetime being constructed and the computational coordinate choice itself ( `` gauge choice '' ) is a unique feature of general relativity that makes the numerical simulations much more demanding . besides extra computational power ,",
    "advanced visualization tools , preferably real time interactive `` window into the oven '' visualization , are particularly useful in the numerical construction .",
    "the multi - scale problem : astrophysics of strongly gravitating systems inherently involves many length and time scales .",
    "the microphysics of the shortest scale ( the nuclear force ) , controls macroscopic dynamics on the stellar scale , such as the formation and collapse of neutron stars ( nss ) . on the other hand ,",
    "the stellar scale is at least 10 times _ less _ than the wavelength of the gravitational waves emitted , and many orders of magnitude less than the astronomical scales of their accretion disk and jets ; these larger scales provide the directly observed signals .",
    "numerical studies of these systems , aiming at direct comparison with observations , fundamentally require the capability of handling a wide range of dynamical time and length scales .",
    "all of these issues lead to important research questions in computational science . here",
    "we give an overview of some of our effort in these directions , focusing on performance and coding issues on parallel machines , and on the development of a community code that incorporates all the mathematical and computational techniques described above ( and many more ) , in a collaborative infrastructure for numerical relativity .",
    "when expanded out in a particular coordinate system the evolution equations for the full einstein equations in the 3@xmath1161 formulation have many thousands of terms .",
    "these are usually derived and coded in fortran with a symbolic manipulator package such as mathematica or macsyma .",
    "however , these packages often generate fortran expressions that are unsuitable for most compilers , even on traditional supercomputers .",
    "we often exceed internal compiler limits on length of expression , number of continuation lines , number of arguments to a subroutine , number of nested parentheses , and so forth .",
    "so our code generation techniques need to be carefully massaged before an efficient , working code is generated .",
    "the evolution equations are generally written out using explicit finite difference schemes , which are very popular for hyperbolic systems of equations .",
    "these equations are good candidates for the `` simd '' style approach to programming parallel machines .",
    "( simd stands for `` single instruction multiple data '' , which means an operation like `` add arrays a and b together '' can be carried out completely in parallel , with the same instruction ( add ) on multiple data elements in memory .",
    "this is also a so - called `` data parallel '' operation , since the same operation is applied simultaneously to all data elements of arrays a and b in parallel , and no communications are required between processors . ) until recently , in our research group 3d codes have been generally written in this style using data parallel fortran90 and cmfortran style languages . with this approach , communications between processors , required for example when",
    "computing derivatives ( which require knowledge of neighboring data points in memory ) , are handled by the compilers without need for the user to do anything .",
    "we have used the c - preprocessor to incorporate a few different code blocks so that we can maintain a single source file for several machines .",
    "( for an excellent review of many modern approaches to parallel computing , including further information on many of the concepts and acronyms common in computational science , see , e.g. ,  @xcite , available both in print and on - line ) .",
    "using this global approach we previously developed a single code , called h3expresso , that achieved over 15 gflops on the 512 node cm-5 and about 8 gflops on the 16 processor cray c-90 .",
    "this code was one of the fastest applications on either machine  @xcite .",
    "we performed a detailed comparative study of this code on many architectures , including the c-90 , convex spp-1200 , t3d , cm-5 , sgi power challenge , and sp-2 , achieving excellent scaling all machines .",
    "these results are possible because of the very high computation / communication ratio inherent in the einstein equations .",
    "the hyperbolic equations contain thousands of terms to be evaluated , while the only communications required are in computing finite differences for numerical derivatives .",
    "however , this data parallel approach is not the best one to follow with more modern microprocessor based scalable supercomputers , such as the sgi / cray origin 2000 and cray t3d and t3e , due largely to the use of caches that boost performance of a single node .",
    "it is worth commenting on how we have adapted the h3expresso code to a `` message passing '' language like mpi , with single processor optimizations , which then led to to the development of the new cactus code described below .",
    "( mpi stands for `` message passing interface '' , a standard communications library now available on most parallel computers , that allows the user to explicitly control the communication of data between processors when required  @xcite",
    ". this can be more efficient than allowing the compiler to handle this automatically . )    due to the data - parallel nature of the code , many of the temporaries evolved in solving the hyperbolic equations ( [ 3dbalance ] ) , notably the sources and the fluxes , are created as 3d arrays .",
    "this allows fairly easy parallelization of the code with mpi .",
    "since the only finite differencing in the code is on the fluxes , they are the only variables which need communication , and thus we can easily do an mpi - based communication with these variables during our update loop .    unfortunately , one of the major problems of the data parallel programming model is that it requires the creation of large numbers of 3d temporary arrays to store source or flux terms . on a system like the cm-5 , this technique was crucial in obtaining performance ; the arrays were distributed and were stored on the vector units , so the system could operate on them quickly and communicate them transparently . however , with single statements for entire arrays with large degrees of complexity , each assignment requires a sweep through the complete memory space .",
    "cache locality is impossible , and the code performs very poorly in an out - of - cache regime .",
    "hence , to achieve high single processor performance on more modern microprocessor based architectures special attention has to be paid to rewriting expressions to maximize the use of the processor cache .    using the experience gained from exploring issues of parallelism and single processor performance with the h3expresso code , we have developed from the scratch a new 3d einstein equation code , the `` cactus '' code , which integrates important design decisions for modern hpc ( standard acronym for `` high performance computing '' ) architectures from the outset :    * the numerical kernals for the einstein equations , needed by all users ,",
    "are highly optimized for modern microprocessor based architecture .",
    "* other routines ( e.g. , waveform extraction ) are written by the community of users in either c or fortran . *",
    "it obtains parallelism through mpi , not through compiler technologies . in the following ,",
    "we describe some details of single processor performance , parallelism and the code s collaborative infrastructure .      in `` cactus '' , we achieve parallelism using ghost - zone domain decomposition .",
    "that is , we decompose a global domain over our processors , and place an overlap region on each processor .",
    "then each single processor is responsible for updating the interior of their local region , and a mpi communication synchronizes the boundary zones after communications .",
    "we have also optimized for the particular structure of our equations .",
    "the straightforward way to set up our communication patterns would be an algorithm like    ....    for ( it = 0 to maxit ) {      update interior for a time step dt      update ghost zones for all grid functions    } ....    however , many of our variables have no flux .",
    "since we generally use a strang split in the hyperbolic evolution , which allows us to update our source and flux evolution separately , the integration of these flux - free variables is a completely spatially de - coupled point local ode .",
    "these variables need no communication whatsoever , in absence of flux .",
    "thus , we can re - write the above loop as    ....    for ( it = 0 to maxit ) {      evolve sources for dt/2      evolve fluxes for dt      update ghost zones for all grid functions which have a flux      evolve sources for dt/2    } ....    in practice , this algorithm allows us to reduce our communication cost , resulting in excellent scaling , in addition to excellent single processor performance .",
    "[ fig : nt_scal ]    [ fig : cactus_scal ]    these techniques have enabled `` cactus '' to be a highly portable and efficient code for numerical relativity and astrophysics .",
    "it has been tested and performed very well on three very different parallel architectures : the sgi origin 2000 system , the sgi / cray t3e system , and a cluster of 128 nt workstations , developed at ncsa , running pentium ii processors . in fig .",
    "[ fig : cactus_scal ] we show scaling results achieved on a cray t3e-600 , and in fig .  [",
    "fig : nt_scal ] we show the scaling results achieved on both the origin 2000 and the nt cluster .",
    "presently , the sgi origin , with 250mhz r10000 processors , has more than three times the per processor performance of the 300mhz pentium ii in the nt cluster , but the trend is very encouraging .",
    "these results indicate that codes like this can be run efficiently in parallel on a wide variety of machines .",
    "finally , we have recently tested the code on a 1024 node t3e-1200 ( provided for the nasa neutron star grand challenge project  @xcite for performance tests ) , achieving 142gflops and linear scaling up to 1024 nodes .",
    "the version of the code tested is the so - called gr3d code developed for the nasa grand challenge project .",
    "gr3d is a version of `` cactus '' code for spacetime evolution coupled to a riemann solver based relativistic hydrodynamic code ( mahc hyperbolic_hydro ) that has recently been released ( available at http://wugrav.wustl.edu/codes/gr3d/ ) .",
    "performance information for the `` cactus '' code will also be kept up to date at http://cactus.aei-potsdam.mpg.de .    in the following",
    "we give a summary of the performance test .",
    "the test was carried out with the released version without special tuning for this 1024 node machine .",
    "we note that the full set of the einstein equations with the perfect fluid source , as solved in this code , involved a large number of 3d arrays .",
    "the huge number of grid points used ( 644 x 644 x 1284 , or 500 x 500 x 996 respectively for 32 and 64 bits ) is made possible by reduced memory footprint of the code .",
    "_ _ : 1024 node t3e-1200 with 512 mb per node    _ _ : may 10 , 1998    ....                                    32 bit              64 bit -------------------------------------------------------------------- grid size per processor            84x84x84            66x66x66 processor topology                 8 x8",
    "x16            8 x8 x16 total grid size                    644 x 644 x 1284    500 x 500 x 996 single proc mflop / sec              144.35              118.33 aggregate gflop / sec                142.2               115.8 scaling efficiency                 96.2\\%               95.6\\% -------------------------------------------------------------------- ....    previously , the largest production simulations in 3d numerical relativity have been limited to about @xmath117 or less , and applied to distorted 3d black hole systems  @xcite .",
    "when such large machines as the test t3e described above are made available for routine production simulations , we expect to further improve the results of the such black hole simulations , and perform more general 3d calculations involving distorted rotating black holes , coalescences of neutron stars , gravitational waves , as well as other interesting problems in general relativistic astrophysics .",
    "while `` cactus '' is our third generation 3d numerical relativity code , it is our first generation of code in which we paid special attention to the difficult software engineering problem of collaborative code development , maintenance and management .",
    "our earlier generations of 3d numerical relativity codes ( the so - called `` g '' and `` h '' codes , described in  @xcite ) involving about a dozen researchers in the potsdam / ncsa / wash u collaboration , have made us keenly aware of the issues and difficulties involved in distributed collaborative code development .",
    "for the `` cactus '' code , a collaborative infrastructure has been essential . as of this writing",
    ", several dozen collaborators at 7 institutions are using the code for various research projects , and we aim at further making it a truly community code for the investigation of general relativistic astrophysics .",
    "`` cactus '' is hence designed to minimize barriers to the community development and use of the code , including the complexity associated with both the code itself and the networked supercomputer environments in which simulations and data analyses are performed .",
    "this complexity is particularly noticeable in large multidisciplinary simulations such as ours , because of the range of disciplines that must contribute to code development ( relativity , hydrodynamics , astrophysics , numerics , and computer science ) and because of the geographical distribution of the people and computer resources involved in simulation and data analysis .",
    "the collaborative technologies that we are developing within cactus include :    @xmath115 _ a modular code structure and associated code development tools_. cactus defines coding rules that allow one , with only a working knowledge of fortran or c , to write new code modules that are easily plugged in as `` thorns '' to the main cactus code ( the `` flesh '' ) .",
    "the `` flesh '' contains basic computational infrastructure needed to develop and connect parallel modules into a working code .",
    "all told , the `` flesh '' is thousands of lines of highly optimized c and fortran , not counting some utility libraries , makefile , and perl scripts .",
    "it allows one to plug in not only different physics modules , such as the basic einstein solver , other formulations of the equations , analysis routines , etc . , but also different parallel domain decomposition modules , i / o modules , utilities , elliptic solvers , and so forth .",
    "a thorn may be any code that the user wants , in order to provide different initial data , different matter fields , different gauge conditions , visualization modules , etc .",
    "thorns need not have anything to do with relativity : the flesh could be used as basic infrastructure for any set of pde s , from newtonian hydrodynamics equations to yang mills equations , that are coded as thorns .",
    "the user inserts the hook to their thorn into the flesh code in a way that the thorn will not be compiled unless it is designated to be active .",
    "we have developed a makefile and perl - based thorn management system that , through the use of preprocessor macros that are appropriately expanded to the arguments of the flesh and additional arguments defined by each thorn , is able to create a code which can configure itself to have a variety of different modules .",
    "this ensures that _ only _ those variables needed for a particular simulation are actually used , and that no conflicts can be created in subroutine argument calling lists .",
    "@xmath115 _ a consistency test suite library . _",
    "an increased number of thorns makes the code more attractive to its community but also increases the risk of incompatibilities .",
    "hence , we provide technology that allows each developer to create a test / validation suite for their own thorn .",
    "these tests are run prior to any check in of code to the repository , ensuring that new code reproduces results consistent with previous one , and hence can not compromise the work of other developers relying on a given thorn .",
    "so , how does a user use the code ?",
    "a detailed user guide will be available with the code when it is released during 1999 ( see http://cactus.aei-potsdam.mpg.de ) , but in a nutshell , one specifies which physics modules , and which computational / parallelism modules , are desired in a configuration file , and makes the code on the desired architecture , which can be any one of a number of machines from sgi / cray origin or t3e , dec alpha , linux workstations or clusters , nt clusters , and others .",
    "the make system automatically detects the architecture and configures the code appropriately .",
    "control of run parameters is then provided through an input file .",
    "additional modules can be selected from a large community - developed library , or new modules may be written and used in conjunction with the pre - developed modules .",
    "our experiences with cactus up to now suggest that these techniques are effective .",
    "it allows a code of many tens of thousands of lines , but with a compact flesh that is possible to maintain despite the large number of people contributing to it .",
    "the common code base has enhanced the collaborative process , having important and beneficial effects on the flow of ideas between remote groups .",
    "this flexible , open code architecture allows , for example , a relativity expert to contribute to the code without knowing the details of , say , the computational layers ( e.g. , message passing or amr libraries ) or other components ( e.g. , hydrodynamics ) .",
    "this is an area that we plan to invest more effort into in the coming few years .",
    "3d simulations of einstein s equations are very demanding computationally . in this section",
    "we outline the computational needs , and techniques designed to reduce them .",
    "we will need to resolve waves with wavelengths of order @xmath118 or less , where @xmath66 is the mass of the bh or the neutron star .",
    "although for schwarzschild black holes , the fundamental @xmath119 quasinormal mode wavelength is @xmath120 , higher modes , such as @xmath121 and above , have wavelengths of @xmath122 and below .",
    "the bh itself has a radius of @xmath123 .",
    "more important , for very rapidly rotating kerr bh s , which are expected to be formed in realistic astrophysical bh coalescence , the modes are shifted down to significantly shorter wavelengths@xcite .",
    "as we need at least 20 grid zones to resolve a single wavelength , we can conservatively estimate a required grid resolution of about @xmath124 . for simulations of time scales of order",
    "@xmath125 , which will be required to follow coalescence , the outer boundary will probably be placed at a distance of roughly @xmath126 from the coalescence , requiring a cartesian simulation domain of about @xmath127 across .",
    "this leads to about @xmath128 grid zones in each dimension , or about @xmath129 grid zones in total . as 3d codes to solve the full einstein equations have typically 100 variables to be stored at each location , and simulations are performed in double precision arithmetic , this leads to a memory requirement of order 1000 gbytes ! ( in fairness to some groups that use spectral methods instead of finite differences ( e.g. , the meudon group ) , we should point out highly accurate 3d simulations can now be achieved on problems that are well suited to such techniques , using much less memory !",
    "@xcite ) .",
    "the largest supercomputers available to scientific research communities today have only about @xmath130 of this capacity , and machines with such capacity will not be routinely available for some years . furthermore , if one needs to double the resolution in each direction for a more refined simulation , the memory requirements increase by an order of magnitude .",
    "although such estimates will vary , depending on the ultimate effectiveness of inner or outer boundary treatments , gauge conditions , etc . , they indicate that barring some unforeseen simplification , some form of adaptive mesh refinement ( amr ) that places resolution only where it is required is not only desirable , but essential .",
    "the basic idea of amr is to use some set of criteria to evaluate the quality of the solution on the present time step .",
    "if there are regions that require more resolution , then data are interpolated onto a finer grid in those regions ; if less resolution is required , grid points are destroyed",
    ". then the evolution proceeds to the next time step on this hierarchy of grids , where the process is repeated .",
    "these rough ideas have been refined and applied in many applications now in computational science .",
    "there are several efforts ongoing in amr for relativity .",
    "choptuik was the early pioneer in this area , developing a 1d amr system to handle the resolution requirements needed to follow scalar field collapse to a bh@xcite .",
    "as an initially regular distribution of scalar field collapses , it will require more and more resolution as its density builds up .",
    "the grid density required to resolve the initial distribution may not even see the final bh .",
    "further , as pulses of radiation propagate back out from the origin , they , too may have to be resolved in regions where there was previously a coarse grid .",
    "choptuik s amr system , built on early work of berger and oliger@xcite , was able to track dynamically features that develop , enabling him to discover and accurately measure bh critical phenomena that have now become so widely studied@xcite .",
    "based on this success and others , and on the general considerations discussed above , full 3d amr systems are under development to handle the much greater needs of solving the full set of 3d einstein equations .",
    "a large collaboration , begun by the nsf black hole grand challenge alliance , has been developing a system for distributing computing on large parallel machines , called distributed adapted grid hierarchies , or dagh .",
    "dagh was developed to provide mpi - based parallelism for the kinds of computations needed for many pde solvers , and it also provides a framework for parallel amr .",
    "it is one of the major computational science accomplishments to come out of the alliance . developed by manish parashar and jim browne , in collaboration with many subgroups within and without the alliance ,",
    "it is now being applied to many problems in science and engineering .",
    "one can find information about dagh online at http://www.cs.utexas.edu / users / dagh/.    at least two other 3d software environments for amr have been developed for relativity : one is called hll , or hierarchical linked lists , developed by lee wild and bernard schutz@xcite ; another , called bam , was the first amr application in 3d relativity developed by brgmann  @xcite .",
    "the hll system has recently been applied to the test problem of the zerilli equation ( discussed above ) describing perturbations of black holes@xcite .",
    "this nearly 30 year old linear equation is still providing a powerful model for studying bh collisions , and it is also being used as a model problem for 3d amr . in this work , the 1d zerilli equation is recast as a 3d equation in cartesian coordinates , and evolved within the amr system provided by hll . even though the 3d zerilli equation is a single linear equation , it is quite demanding in terms of resolution requirements , and without amr it is extremely difficult to resolve both the initial pulse of radiation , the blue shifting of waves as they approach the horizon , and the scattering of radiation , including the normal modes , far from the hole .",
    "in this article we have attempted to review the essential mathematical and computational elements needed for a full scale numerical relativity code that can treat a variety of problems in relativistic astrophysics and gravitation .",
    "various formulations of the einstein equations for evolving spacelike time slices , techniques for providing initial data , the basic ideas of gauge conditions , several important analysis tools for discovering the physics contained in a simulation , and numerical algorithms for each of these items have been reviewed .",
    "unfortunately , we have only been able to cover the basics of such a program , and in addition many promising alternative approaches have necessarily been left out .    as one can see , the solution to a single problem in numerical relativity requires a huge range of computational and mathematical techniques .",
    "it is truly a large scale effort , involving experts in computer and computational science , mathematical relativity , astrophysics , and so on . for these reasons , aided by collaborations such as the nsf black hole grand challenge alliance and the ncsa / potsdam / washu collaboration",
    ", there has been a great focusing of effort over the last years .",
    "a natural byproduct of this focusing has been the development of codes that are used and extended by large groups .",
    "a code must have a large arsenal of modules at its disposal : different initial data sets , gauge conditions , horizon finders , slicing conditions , waveform extraction , elliptic equation solvers , amr systems , boundary modules , different evolution modules , etc .",
    "furthermore , these codes must run efficiently on the most advanced supercomputers available .",
    "clearly , the development of such a sophisticated code is beyond any single person or group .",
    "in fact , it is beyond the capability of a single community ! different research communities , from computer science , physics , and astrophysics , must work together to develop such a code .    as an example of such a project",
    ", we described briefly the `` cactus '' code , developed by a large international collaboration@xcite .",
    "this code is an outgrowth of the last 5 years of 3d numerical relativity development primarily at ncsa / potsdam / washu , and builds heavily on the experience gained in developing the so - called `` g '' and `` h '' codes  @xcite .",
    "presently , it is being developed collaboratively by these groups in collaboration with groups at palma , valencia , physical research laboratory in india , and computational science groups at u. of illinois , and argonne national lab .",
    "the code has a very modular structure , allowing different physics , analysis , and computational science modules to be plugged in .",
    "in fact , versions of essentially all the modules listed above are already developed for the code .",
    "for example , several formulations of einstein s equations , including the adm formalism and the bona - mass hyperbolic formulation , can be chosen as input parameters , as can different gauge conditions , horizon finders , hydrodynamics evolvers , etc .",
    "it is being tested on bh spacetimes , such as those described above , as well as on pure wave spacetimes , self - gravitating scalar fields and hydrodynamics .",
    "it has also been designed to connect to dagh ultimately for parallel amr .",
    "this code was also designed as a community code .",
    "after first developing and testing it within our rather large community of collaborators , it will be made available with full documentation via a public ftp server maintained at aei and a mirroring site at washu . by having an entire research community using and contributing to such a code ,",
    "we hope to accelerate the maturation of numerical relativity .",
    "information about the code is available online , and can be accessed at http://cactus.aei-potsdam.mpg.de .",
    "* acknowledgments * it is a pleasure to acknowledge many friends and colleagues who have contributed to the work described in this article , some of which was derived from papers we have written together .",
    "the cactus code was originally started by joan mass and paul walker at aei , and the mahc general relativistic hydrodynamic module was started by mark miller at wash u ; these were then opened up to development by our entire research groups at potsdam , washington university , and ncsa ( the ncsa / potsdam / wash u collaboration ) , and elsewhere , notably the university of the balearic islands in spain , the university of valencia , argonne national lab , and physical research lab ( prl ) in india . without the contributions from people at all these institutions , the work described here would not have been possible .",
    "thanks to tom goodale and ed evans for carefully reading the manuscript and suggesting improvements , to tom clune for performance tuning and scaling results for the t3e , and to staff at ncsa for helping study the performance of the code on the origin 2000 and nt workstations . this work has been supported by aei , ncsa , nsf grant no .",
    "phy-96 - 00507 , nasa hpcc / ess grand challenge applications grant no .",
    "nccs5 - 153 , nsf mrac allocation grant no .",
    "mca93s025 , and hong kong rgc grant cuhk 4189/97p .",
    "j. libson , j. mass , e. seidel , and w .- m .",
    "suen , in _ the seventh marcel grossmann meeting : on recent developments in theoretical and experimental general relativity , gravitation , and relativistic field theories _ , edited by r.  t. jantzen , g.  m. keiser , and r. ruffini ( world scientific , singapore , 1996 ) , p.  631 ."
  ],
  "abstract_text": [
    "<S> the astrophysics of compact objects , which requires einstein s theory of general relativity for understanding phenomena such as black holes and neutron stars , is attracting increasing attention . in general relativity , gravity is governed by an extremely complex set of coupled , nonlinear , hyperbolic - elliptic partial differential equations . </S>",
    "<S> the largest parallel supercomputers are finally approaching the speed and memory required to solve the complete set of einstein s equations for the first time since they were written over 80 years ago , allowing one to attempt full 3d simulations of such exciting events as colliding black holes and neutron stars . in this paper we review the computational effort in this direction , and discuss a new 3d multi - purpose parallel code called `` cactus '' for general relativistic astrophysics . </S>",
    "<S> directions for further work are indicated where appropriate . </S>"
  ]
}