{
  "article_text": [
    "clusters of galaxies , acting as gravitational lenses , introduce a statistical anisotropy in the shapes of faint background galaxies . in the weak distortion regime it is possible to construct ( see e.g. @xcite ) a ` polarization ' statistic @xmath4  a certain measure of the ellipticity of the background galaxy  whose expectation value is proportional to , and therefore provides a direct measurement of , the gravitational shear @xmath5 , where @xmath6 is the surface potential for the lens .",
    "the precision with which one can determine @xmath0 is of course limited by the number of background galaxies , and care must be taken to allow for systematic bias from seeing and removal of artificial anisotropy , but several groups have now shown that the shear can be detected to a reasonably high level of significance .",
    "the list of shear fields mapped around clusters includes a1689 ( @xcite ) , a2218 ( @xcite ) , cl1409 + 52 ( @xcite ) , ms1224 + 20 ( @xcite ) , cl0024 + 17 ( @xcite ) , cl1455 + 22 and cl0016 + 16 ( @xcite ) .",
    "the lens surface potential is related to the dimensionless surface density @xmath7 by @xmath8 . in an earlier paper ( kaiser & squires 1993 ; hereafter ks93 ) we proposed a method for reconstructing the surface density from the shear .",
    "writing the shear as @xmath9 , where the 2-component integro - differential operator is @xmath10 one can readily show that @xmath11 .",
    "the green s function for this operator is @xmath12 with @xmath13 , so we obtain @xmath14 and this 2-dimensional convolution integral can in turn be replaced by a discrete sum over the background galaxies to give the estimator @xmath15 where @xmath16 is the mean surface number density of the background galaxies .    unfortunately the kernel @xmath17 is infinite in extent , so this requires , strictly speaking , data extending to infinity . with finite data",
    "the estimate as written above becomes biased , as discussed in ks93 and illustrated in the simulations presented there .",
    "near the center of the field on which we have data , this simply results in a nearly constant suppression in the reconstructed surface density , and since the baseline surface density is ambiguous in any case this is relatively benign .",
    "however , near the edge of the data the _ shape _ becomes biased and one typically finds the density goes negative in a trough around the cluster and then rises again as one approaches the edge . the algorithm effectively tries to generate a lens that has a shear pattern like that observed within the region surveyed , but which falls to zero outside the data boundary .",
    "one immediate consequence of this is that there must be zero net mass in the reconstruction .",
    "because of this we have tended to augment our 2-dimensional reconstructions by aperture mass measurements ( @xcite ) which do not suffer from this bias .",
    "this raises the interesting question : since the shear is a non - local function of the surface density  so the shear within some region is determined in part by the surface density outside  is it possible to uniquely determine @xmath1 from local measurements ?",
    "the answer is affirmative , subject only to the qualification that one can add an arbitrary constant to @xmath1 .",
    "one way to see this is from the expression for the angular gradients of @xmath1 in terms of gradients of the shear ( kaiser 1995 ) : @xmath18 = \\left [ \\begin{array}{c } \\gamma_{1,1 } + \\gamma_{2,2 } \\\\",
    "\\gamma_{2,1 } - \\gamma_{1,2 } \\end{array } \\right ] \\equiv \\bf{u}\\ ] ] this relation follows directly from the expressions for @xmath1 and @xmath0 in terms of @xmath6 above , and ` projects out ' a certain linear combination of the shear gradients which are locally determined .",
    "thus with perfect data we could determine @xmath1 at any point relative to the value at some arbitrary reference point simply by performing a line integral of the observable @xmath3 .",
    "this also provides an alternative way to visualize the convolution integral equation ( [ eq : ks93 ] ) ; if one averages over radial line integrals from points on some very distant boundary ( on which we assume that @xmath19 and @xmath1 vanish ) to a ` target ' point @xmath20 , we obtain a two dimensional integral , and integrating by parts to express everything in terms of the shear rather than its gradients we obtain equation ( [ eq : ks93 ] ) . equation ( [ eq : gradkappa ] ) is valid in the weak distortion regime  the main focus of this paper  but can be readily extended into the strong - distortion regime ( kaiser 1995 ) .",
    "the above argument gives a qualitative insight on how to account for the bias in the original algorithm and several groups have exploited the above relations to develop unbiased surface density estimators ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) . in this paper",
    ", we address the reconstruction problem from a variety of perspectives .",
    "first we expand on some simple alternative solutions to the finite - field problem where we determine the surface density relative to some well - defined reference region as sketched in figures [ fig : paths]a , b , c . in ",
    "[ sec : method ] we show that in general , if one uses a line integral averaging scheme then one can formulate an expression for @xmath1 relative to the appropriate reference value as an integral like equation ( [ eq : ks93 ] ) , but with @xmath21 .",
    "the benefits of this approach are twofold : by performing the line integrations and averaging analytically we are able to construct practical estimators as simple discrete sums over the background galaxy shear estimates , so with this method it is relatively straightforward to obtain rigorous estimates of the statistical uncertainty in the reconstruction arising from random intrinsic ellipticities .",
    "second , the analysis reveals how problematic boundary terms ( @xmath22-function terms in the kernel @xmath23 ) inevitably arise if one restricts the reference region geometry to a 1-dimensional line , and how they can be avoided .",
    "another inversion algorithm has been proposed ( @xcite ) that is not only unbiased , but also attempts , in some sense , to minimize the contribution due to noise .",
    "since the gradient of the shear is related to @xmath24 , in the absence of noise , the curl of @xmath24 should be zero . in practice",
    ", noise adds a rotational part to the surface density gradient and the seitz & schneider algorithm attempts to minimize this .",
    "we show however that this technique also gives rise to boundary terms which tend to inflate the noise in the reconstructions and give quite similar results to other methods that give large weight to galaxies near the boundary .",
    "in  [ sec : fourier ] we develop a new discrete fourier transform based inverse gradient operator which can be implemented with an fast fourier transform ( fft ) . because of periodic boundary conditions , applying the familiar algebraic inverse gradient operator @xmath25 ( or its generalization for finitely spaced data ) does not recover the true surface density from @xmath26 .",
    "in fact , for zero padded data , one recovers precisely the bias inherent in the original ks93 method .",
    "we show how to remove this bias and derive a fourier - space inverse gradient operator which exactly recovers a scalar field from its gradient . unfortunately",
    ", this method does not seem to be optimal in terms of its low frequency noise , but the method has the advantages that it is simple , fast , and can readily be extended to apply in the non - linear regime where the data provide one with a map of @xmath27 ( where the low - frequency noise is not an important issue ) .",
    "fourthly , we consider regularized inversion methods for constructing the surface density . in general terms , this approach arises from fitting a series of general models for the underlying surface density and attempting to determine which the most probable model for the true surface density , given a particular set of observations .",
    "this style of approach leads to two difficulties .",
    "first , if we fit a model with only a few free parameters , then we severely restrict the reconstructions to some basic forms  in effect the reconstructions will reflect our prejudice for what we expect rather than allowing the data to determine the surface density . however if we allow the model to be very general , then we are essentially introducing a large number of free parameters and the inversion become ill - conditioned .",
    "we pursue this scheme of many - parameter inversion in  [ sec : mp ] and  [ sec : ml ] and explore two methods to regularize the inversion based on the maximum likelihood and maximum entropy techniques .",
    "the foregoing analyzes yield several estimators all of which are unbiased .",
    "we address the question of what estimator is most desirable in practice in ",
    "[ sec : noise ] .",
    "they are really precisely equivalent for perfect data , and the only rationale for choosing one method is how well it performs with real , noisy data . for any particular quantity",
    "one chooses to measure from a reconstruction the question is well defined and one can objectively determine the best solution .",
    "the problem is deciding what are the quantities of interest , which is a somewhat subjective issue . here",
    "we focus on the low frequency noise in the reconstructions .",
    "this seems reasonable since the whole purpose of these modifications to equation ( [ eq : ks93 ] ) is to cure the bias which is essentially a low frequency phenomenon . to explore this",
    "we first make simulated reconstructions using a variety of geometries .",
    "we then make a more objective and quantitative comparison by seeing how well these methods perform for particular low - frequency measurements .    in  [ sec : apertures ] we derive some useful results for estimating the mass within an aperture . while this can be done by performing ` aperture densitometry ' on the reconstruction ,",
    "we show that with a simple modification of formula for one of the direct reconstruction methods , one can measure the aperture mass as a single summation over the shear estimates .",
    "this greatly simplifies the estimation of the statistical uncertainty .",
    "how to do this for a circular aperture has been described elsewhere ( @xcite ) and here we generalize this to obtain a useful bound on the mass within apertures of arbitrary shape .    finally , we consider what appears at first sight to be a quite different approach to this problem .",
    "gauss law in 2-d equates the mass inside a loop and the integral of the normal gravity around the loop . since the shear is the spatial derivative of the gravity one can thereby derive an expression for @xmath28 as a certain integral of the shear around the boundary",
    "this provides a generalization of equation ( [ eq : tangentialshear ] ) to non - circular loops .",
    "our hope was that this would give a different estimator  the construction we use in  [ sec : method ] being highly and arbitrarily restricted to averages over straight line integrals  but it turns out that the result is exactly equivalent to our case - b estimator ( see below ) and so we consign this to an appendix .",
    "from equation ( [ eq : gradkappa ] ) we see that it is technically possible to determine @xmath1 at any point relative to the value at some arbitrary reference point simply by performing a line integral of the observable @xmath3 . clearly then",
    ", one could recover @xmath1 by simply averaging @xmath29 over radial lines from the boundary of the observed region , as suggested by kaiser _",
    "( 1995 ) and illustrated schematically in figure [ fig : paths]a , and an algorithm to implement such a scheme was developed by schneider ( 1994 ) .",
    "schneider s algorithm evaluates the line integrals numerically . to do this the shear estimates are first binned into grid of cells and then smoothed .",
    "the gradients of the shear ( and hence gradients of @xmath1 ) are approximated by discrete differences on the smoothed shear field and @xmath3 is then numerically integrated along a family of lines extending from each point on the plane to the boundary .",
    "now the geometry for the line integrals is actually slightly different from that shown in figure [ fig : paths]a , but shares the key property that the boundary points are the same for each target point so , for perfect data at least , this procedure should generate an exact and unbiased reconstruction .",
    "the bias in the low spatial frequency behavior in the ks93 estimator is a real problem  especially if one is interested in the mass profile in the outer parts of cluster  and schneider s algorithm is an interesting attempt to avoid this , but it has one somewhat disturbing feature .",
    "the line integrals of gradients of the shear give rise to integrals of the shear plus boundary terms . in the averaging over lines , the former become two dimensional integrals which are very similar in form to the convolution integral in equation ( [ eq : ks93 ] ) , and are relatively straightforwardly implemented as discrete sums over galaxies .",
    "the latter , however , become line integrals of the shear around the perimeter .",
    "as we will see , these make an important contribution , especially to the low frequency components of the reconstruction , but they are very difficult to estimate reliably .",
    "the problem is that if the shear is smoothed then its value at the boundary will tend to be biased . on the other hand ,",
    "if the smoothing radius is taken to be very small then the boundary shear must be estimated by averaging over a small number of galaxies and this will inflate the statistical uncertainty in the reconstruction .    as discussed elsewhere",
    "( @xcite ) there is a simple yet general relation between the mean tangential shear around a circular loop and the mean surface density within that loop . defining the tangential shear as @xmath30",
    " it measures the stretching of the galaxies along the loop  and the mean interior surface density as @xmath31 , one finds @xmath32 this is easily derived from gauss law ( see appendix [ sec : aperturesappendix ] ) , and can been used to estimate the mass within a circular aperture ( @xcite ) . if we simply evaluate @xmath33 out to some radius @xmath34 we obtain the surface density at the origin minus @xmath35 , the mean over the disk .",
    "now by definition @xmath36 , where @xmath37 denotes the mean of @xmath1 _ on _ the loop , from which it follows that @xmath38 .",
    "comparing with equation ( [ eq : tangentialshear ] ) we can see that if we were to change our reference surface density from @xmath39 to @xmath37 the only effect is to introduce the pure boundary term @xmath40 .",
    "our analysis shows that it is technically impossible to measure the surface density relative to the mean on a boundary of infinitesimal width  which is perhaps hardly surprising  but allows the possibility that one measure @xmath1 relative to a well defined reference strip of thin but finite width , which would give an approximation to schneider s method but without the bias , or any similar alternative such as figure [ fig : paths]b .    in this section ,",
    "we construct expressions for @xmath1 as averages of line integrals of @xmath3 from a set of points uniformly distributed over some reference region for the various geometries illustrated schematically in figure [ fig : paths ] ( although the square geometry is only illustrative and the analysis below applies general survey geometries )",
    ". then , using equation ( [ eq : gradkappa ] ) , we obtain explicit expressions for @xmath1 as some integral over the shear field which can then readily be converted in  [ sec : estimators ] to form practical estimators of @xmath1 given a set of shear estimates .",
    "we first construct an estimator for @xmath41 where @xmath37 is the mean surface density on the boundary of the data region .",
    "place the origin of coordinates at the ` target point ' @xmath20 where we wish to measure @xmath1 .",
    "let the boundary of the region on which we have data be @xmath42 , parameterised by azimuthal angular coordinate @xmath43 .",
    "we will assume that the entire boundary is visible from any interior point where we will attempt to estimate @xmath1 .",
    "the mean of @xmath1 on the boundary is @xmath44 where @xmath45 , with @xmath46 the length of the perimeter , with tangent vector @xmath47 .",
    "taking the average over radial paths to the boundary as in figure [ fig : paths]a we find @xmath48 substituting equation ( [ eq : gradkappa ] ) for @xmath3 and integrating by parts to express everything in terms of @xmath19 rather than its derivatives we obtain @xmath49 where @xmath50 where we have defined the differential operator @xmath51\\ ] ] and where the loop integral is taken around the perimeter with @xmath52\\ ] ] with the origin placed at the center of a circular survey region we recover the ks93 kernel and , as expected , the surface term is just the mean tangential shear on the boundary . equations [ eq : kappahat1 ] , [ eq : k1 ] , [ eq : y1 ] provide the generalization for points off the axis and/or non - circular survey geometries .",
    "this is clearly very similar to schneider s method .",
    "let us clarify this .",
    "his method consists of two sequential operations on the data .",
    "the first is the smoothing of the shear field to produce a fine grid of @xmath0 values .",
    "the second consists of differencing these binned values , grouping the various components together to make @xmath3 and then integrating .",
    "let us ignore the smoothing for now .",
    "now the second step is just some linear operation on the input grid of shear values , and could be written out as a linear sum : @xmath53 .",
    "what we have done above is to explicitly calculate the coefficients @xmath54 in this sum .",
    "now in fact schneider measures @xmath1 relative to a slightly different average on the boundary , and uses a slightly different geometry for the rays along which the line integrals are performed , but these are irrelevant details .",
    "the worrying thing which emerges from our analysis is the presence of the boundary term , which means that the grid points on the boundary receive a very high weight in this sum . now",
    "as we have seen , the contribution of this term to @xmath55 is on the order of the mean shear on the boundary , which is roughly equal to @xmath39 , so clearly the contribution to the low spatial frequency components in the reconstruction from this surface term is substantial , and since the goal here was to fix the bias in the low - frequency behavior of ks93 , it is important that the method get this right .",
    "it is hard to see how this can be , since if the shear field is smoothed then the value on the boundary will be biased .",
    "one the other hand with a small smoothing length the boundary term must be calculated by averaging over a small number of galaxies and this will inflate the statistical uncertainty .",
    "let us now construct instead an estimator of @xmath56 ; where the zero - point is now set to be @xmath57 , with @xmath58 . taking the average over radial lines to the origin from each point within the survey region , as illustrated in figure [ fig : paths]b , we have @xmath59 this is very similar in form to equation [ eq : kappahat0 ] , but now the function @xmath60 is replaced by the function @xmath61 which vanishes on the boundary , so substituting from equation ( [ eq : gradkappa ] ) and integrating by parts we obtain @xmath62 where now @xmath63 but no boundary term .",
    "a geometric picture of this kernel may be obtained as follows : in polar coordinates ( @xmath64 ) we find @xmath65 where @xmath66@xmath67@xmath68,@xmath69@xmath70 is the 2-dimensional rotation matrix and , since @xmath71 , we have @xmath72 with @xmath73 . now from inspection of figure",
    "[ fig : angles ] one can see that @xmath74 , and the perpendicular distance from the origin to the tangent is @xmath75 , so we find @xmath76 where the ` unit polar ' is defined to be @xmath77\\ ] ] and hence @xmath78 this is very similar to equation ( [ eq : ks93 ] ) . both equations ` project out ' a particular component of the shear . in equation ( [ eq : ks93 ] )",
    "this is simply the tangential shear ; i.e.  the stretching perpendicular to the line from the origin to the measurement point . in equation ( [ eq : kappahat4 ] )",
    "the component projected out measures the stretching along the direction which bisects the normal to the vector @xmath79 and the boundary tangent direction .",
    "the orientation of @xmath80 is shown in figure [ fig : angles ] .",
    "we can now readily generalize this analysis to the case where the reference region does not fill the entire data region or has some complicated geometry so that lines from the target point may pass in and out of the reference region , perhaps many times .",
    "if we think of the ends of the lines in figure [ fig : paths]b , c as lying on a unit spaced regular 2-dimensional grid ( and let the unit length be very small ) then @xmath81 is just the sum over line integrals .",
    "clearly , if we excise part of the reference region say , we must simply remove the contribution from all the paths which originate in the excised region . in the general situation a line from the target point ( with some given azimuthal angle @xmath43 ) will pass through the boundary of the reference region ( which need not be simply connected ) at points @xmath82 .",
    "let the points be sorted in order of increasing distance so the most distant point is @xmath83 .",
    "the mathematical expression of the subtraction described above is the generalized kernel @xmath84 where @xmath85 , and @xmath86 and where @xmath87 is the heaviside function .",
    "the surface density is then given by equation ( [ eq : kappahat3 ] ) as before , but with @xmath88 now the area of the reference region .",
    "this is illustrated in figure [ fig : general ] for the case of a simply connected reference region which only partially fills the region on which we have data .",
    "if the target point @xmath20 lies inside the reference region ( upper plot ) then the line through @xmath89 crosses the boundary just once and we have @xmath90 if the target point lies outside the reference region then either the line from @xmath20 though @xmath89 misses the reference region completely ( in which case @xmath91 ) or it crosses it twice at @xmath92 and @xmath93 as illustrated in the lower panel , and we then have .",
    "@xmath94    we can now easily construct the kernel for case - c , where we have two nested boundaries ; we simply subtract the kernel calculated as above for the inner boundary from that for the outer .",
    "this also allows the possibility that the outer boundary might lie inside the actual data boundary .",
    "case - c approaches case - a in the limit that the reference strip is infinitesimally thin .",
    "if we use a narrow but finite width strip we should obtain something very similar to case - a , but without the bias inherent in schneider s method .",
    "these formula were derived for the special case where the spatial origin coincides with target point . for a general choice of origin",
    "we have @xmath95 where , for case - b for example , @xmath96 , where we have explicitly shown the dependence of the boundary point on the target and measurement points .",
    "an illustrative and interesting case is that of the case - b kernel for a rectangular survey geometry .",
    "erecting lines from the target point ( the point at which we hope to measure @xmath1 ) to the corners of the rectangle divides it into n , s , e and w quadrants . from equation ( [ eq : kappahat4 ] ) we find , in the n and s sectors respectively , @xmath97 where @xmath98 is half height of the rectangle , and @xmath99 .",
    "similarly , for galaxies in the e and w sectors we have @xmath100 and @xmath101 where @xmath102 is the half - width .",
    "this kernel , is shown in the figure [ fig : kernels ] for various target positions .",
    "the pattern is qualitatively similar to the ks93 kernel , which is also shown for comparison , but now depends in a non trivial way on @xmath20 .",
    "note also the discontinuity along the divisions between the n , s , e , w sectors .",
    "as we will see , these give rise to spurious , but essentially harmless , linear features in the reconstruction .",
    "also shown in figure [ fig : kernels ] are the kernels for the case of circular reference region lying within the survey region ( assumed square for simplicity ) .",
    "if we define @xmath103 , and @xmath104 where @xmath105 is the radius of the survey and let @xmath106 then for case - b , setting @xmath107 and dropping primes we have @xmath108 + { r_0 q^2 \\over z r^3 } \\left [ \\begin{array}{c } x x_0 - y y_0\\\\ x y_0 + y x_0 \\end{array } \\right]\\ ] ] these formulae are only valid if both target and observation point lie within the survey disk , and must be modified if the target or observation point lie outside as discussed above .",
    "the case - b and case - c circular kernels are in each case very similar , and the main difference is just the extra term around the annulus .",
    "as one makes the width of the reference region smaller the kernel in the annulus increases in inverse proportion and so , in the limit of a very thin annulus we end up giving infinite weight to the infinitesimal number of galaxies lying in the annulus .",
    "given a catalogue of background galaxy ellipticities @xmath4 which , suitably defined ( e.g.  @xcite ) , give a set of estimates of @xmath0 at their locations @xmath109 , we can form the estimator @xmath110 whose expectation value is just @xmath111 minus the appropriate reference value , and where @xmath112 are a set of weights that we can tune to optimize performance . alternatively , one could bin the galaxies on some grid , calculate the mean shear estimate @xmath113 for each bin , and then evaluate @xmath114 as a discrete sum with appropriate weights .",
    "these two approaches are equivalent in the limit of small bin size .",
    "for uniformly sampled points ( say on a fine grid ) the weights should clearly all be equal .",
    "given some random realization of background galaxy positions the constant weight estimator is no longer ideal : the kernel we are effectively applying is @xmath115 which differs from the true kernel because of the fluctuating density of the background galaxies .",
    "a uniform weighting scheme therefore introduces a _ multiplicative _ element of noise , which can be removed by weighting each galaxy in inverse proportion to the local density of neighbors .",
    "however , the _ additive _ error arising from the random intrinsic ellipticities will consequently increase .",
    "the optimum weight therefore depends on signal to noise , with constant weight preferred in low signal to noise situations . for typical clusters",
    "the distinction between these is minor as to get into a regime of high s / n one really has to look at large - scale features and then the poissonian fluctuations in the background galaxy number density are small .",
    "henceforth we will consider the uniform weight estimator @xmath116    what about allowance for contamination by cluster galaxies ?",
    "if one assumes that they simply add a randomly oriented component to the background galaxy population then one should simply use equation ( [ eq : kappahat5 ] ) as it stands but with @xmath16 determined away from the cluster .",
    "if , however , the light from the cluster galaxies masks a significant fraction of the background galaxies one should boost the weight given to the surviving galaxies by an appropriate amount .",
    "note that all the the kernels are strongly divergent at @xmath117 , naively suggesting a logarithmic divergence in the kernel integral if we simply count powers of @xmath34 .",
    "however , this divergence is not real . consider the case b kernel given in equation ( [ eq : k2 ] ) .",
    "if we make a taylor expansion of @xmath0 about the origin then it is only the zeroth order term which threatens to produce a divergence , gradients or higher order terms being clearly convergent . for @xmath0",
    "= constant , we can integrate equation ( [ eq : kappahat3 ] ) by parts .",
    "if we restrict the integration to some patch around the origin we find @xmath118_{x_1}^{x_2}\\\\ + \\int dx(x \\gamma_2 - y \\gamma_1 ) \\left[p^2/r^2\\right]_{y_1}^{y_2 } \\end{array}\\ ] ] this is a boundary term which vanishes identically if we take the boundary to be @xmath119 = constant .",
    "thus , if we define the integral in equation ( [ eq : kappahat3 ] ) as the limit as @xmath120 of @xmath121 it is then clearly non - divergent .",
    "a closely related issue is the question of noise in the surface density estimator given in equation ( [ eq : kappahat5 ] ) arising from the divergence of the kernel .",
    "the reconstruction is the sum of random ` shots ' convolved with the kernel , now considered a function of @xmath122 . clearly , if we make an unsmoothed reconstruction we will find divergent ` butterfly ' patterns at the location of each galaxy . in the case of the ks93 kernel",
    "it is easy to see that this noise is a purely high frequency phenomenon and goes away on smoothing the final density field .",
    "the reason for this is that the kernels @xmath123 , @xmath124 vary as @xmath125 , @xmath126 so the coupling to long wavelength fourier modes is highly suppressed . here essentially the same is true , but we have to be a little careful . in the ks93 estimator one can simply soften the divergence by replacing @xmath127 for some tiny softening length which merely suppresses overshoot in the computer .",
    "were we to do that here , there would be a divergent coupling to low frequency modes because of the asymmetry of the kernel pattern which , in reality , would be cut - off by the finite pixel size in the reconstruction .",
    "the answer is to soften the kernels by multiplying by some function @xmath128 where @xmath129 is a small parameter and where @xmath130 for @xmath131 and @xmath132 for @xmath133 ( the function used in the simulations shown below was @xmath134 ) . in principle",
    ", the long wavelength behavior of the reconstruction should be independent of the parameter @xmath129 provided it is ` sufficiently small ' .",
    "a slight technical problem with this is that the scale length of the softening becomes small for those galaxies near the boundary and so quite a small pixel size is required in order to resolve this properly .",
    "another way of approaching the problem is to notice that from equation ( [ eq : gradkappa ] ) , @xmath135 = 0 in the absence of noise .",
    "hence for real , noisy data , a sensible suggestion is that the rotational component of the gradients of the shear field should , in some sense , be minimized .",
    "seitz and schneider ( 1995 ) show that by adopting two reasonable assumptions : 1 ) the rotational component should vanish if the shear is a gradient field and 2 ) there is no systematic rotation over the data field , then there is a unique specification for decomposing the gradient of @xmath1 into a gradient and rotational part .",
    "the details are involved but the main result is that this gives an expression for @xmath1 in the familiar format as a convolution of the gradients of the shear with a kernel : @xmath136 where @xmath137 is defined in equation ( [ eq : gradkappa ] ) .",
    "the problem arises when we attempt to express this with respect to the shear , instead of its gradients . in solving for the kernel , seitz and schneider",
    "are effectively solving a neumann problem , where the kernel is a gradient vector field with @xmath138 on the boundary , and where @xmath139 is the unit normal to the boundary . integrating equation ( [ eq : ssconvolution ] ) by parts",
    ", we obtain an estimate for the surface density as a convolution of a kernel with the shear estimates _ plus _ a boundary term , much like our case - a estimator .",
    "one might expect then , that the limitation of this method is very similar to the case - a estimator ( or thin reference region case - c ) : to estimate the gradients of the shear field , it is necessary to introduce some smoothing .",
    "this will bias the estimate near the boundary , or inflate the noise if the smoothing is reduced .",
    "the latter is particularly problematic .",
    "the presence of a boundary term tends to give very large weight to a few galaxies near the boundary and this introduces a worrisome low frequency fluctuation in the reconstructions - yet it was just this feature we are attempting to reduce in considering alternatives to the original ks93 estimator .",
    "we return to this problem more quantitatively in ",
    "[ sec : noisepower ] .",
    "we can construct a binned estimate of @xmath140 by binning @xmath0 values on regular grid and then discrete differencing .",
    "hence we can obtain binned estimates for @xmath26 , via equation ( [ eq : gradkappa ] ) .",
    "the finite field methods have attempted to determine @xmath1 by averaging over line integrals .",
    "an alternative method to determine @xmath1 is obtained by using fourier transforms .",
    "the clear advantage here is that the gradient operator in real - space becomes algebraic in k - space .",
    "an added bonus is that fast fourier transforms are computationally cheap to perform so the inversion is easy to do numerically .",
    "we display such an implementation scheme here .",
    "consider first , for clarity , a 1-dimensional process , and imagine we have some discrete process @xmath141 $ ] ( this might be a discretely sampled continuous field : @xmath141 = f(n \\delta x)$ ] ) and make the discrete difference @xmath142 = f[n+1 ] - f[n]\\ ] ] now we can construct the fourier transforms ( ft ) of @xmath143 , @xmath144 , for any samples of finite length @xmath145 : @xmath146 = \\sum\\limits_{n=1}^{n } f[n ] e^{2 \\pi",
    "i n k / n } \\cr \\tilde \\eta[k ] = \\sum\\limits_{n=1}^{n } \\eta[n ] e^{2 \\pi",
    "i n k / n } } \\end{matrix}\\ ] ] the question is , how are @xmath147 $ ] and @xmath148 $ ] related ?",
    "in particular , if we are given the latter , can we recover the former ?",
    "now for continuous fields @xmath149 , @xmath150 , the derivative operator in fourier space is just multiplication by @xmath151 , so we recover the ft of @xmath143 by dividing ft of @xmath144 by @xmath151 .",
    "this is not defined for @xmath152 , so this tells us we can not recover the dc component  again , this is not problematic as the dc level can not be determined from shear measurements alone in any case .",
    "it is well known that with for discrete fts the discrete difference operator is multiplication by @xmath153 rather than @xmath151 , but there is a little more to it than that because of the periodic boundary conditions : if one simply multiplies @xmath147 $ ] by @xmath153 then one obtains the ft of the derivative of @xmath154 $ ] but taken with periodic boundary conditions which differs from the real discrete derivative of @xmath154 $ ] at the end points .    the actual relation between @xmath147 $ ] and @xmath148 $ ] is easily obtained : @xmath155 & = & \\sum\\limits_{n=1}^{n } \\eta[n ] e^{2 \\pi",
    "i n k / n } = \\sum\\limits_{n=1}^{n } ( f[n+1 ] - f[n ] ) e^{2 \\pi i n k / n } \\nonumber \\cr & = & \\sum\\limits_{n=2}^{n+1 } f[n ] e^{2 \\pi i ( n - 1 ) k / n } - \\sum\\limits_{n=1}^{n } f[n ] e^{2 \\pi",
    "i n k / n } \\nonumber \\cr & = & f[n+1 ] - f[1 ] + ( e^{-2\\pi i k / n } - 1 ) \\sum\\limits_{n=1}^{n } f[n ] e^{2 \\pi",
    "i n k / n } \\nonumber \\cr & = & \\sum\\limits_{n=1}^{n } \\eta[n ] + ( e^{-2\\pi i k / n } - 1 ) \\tilde f_k \\nonumber \\cr & = & \\tilde \\eta[0 ] + ( e^{-2\\pi i k / n } - 1 )   \\tilde f[k ] \\nonumber\\end{aligned}\\ ] ] so the solution of our inversion problem is @xmath156 = { \\tilde \\eta[k ] - \\tilde \\eta[0 ] \\over e^{-2\\pi i k / n } - 1}\\ ] ]    as before , this is not defined for @xmath152 , but also differs from usual formula @xmath148 / ( e^{-2\\pi i k / n } - 1)$ ] for @xmath157 . one way to implement this is simply to modify @xmath158 $ ] , the last element of the @xmath159 $ ] array , to be minus the sum of the other elements .",
    "that is , we construct @xmath160 = \\eta[n ] - \\delta_{nn } \\sum\\limits_{n ' = 1}^n \\eta[n ' ] = \\eta[n ] - \\delta_{nn } \\tilde \\eta[0]\\ ] ] which then has discrete transform @xmath161 =   \\tilde \\eta[k ] - \\tilde \\eta[0]$ ] .",
    "the above analysis can be extended to the case of 2 dimensions , as is applicable for our problem .",
    "we can estimate directly from the data the two partial derivatives @xmath162 and @xmath163 and , in principle , we can use either to estimate @xmath1 .",
    "fourier transforming , we obtain two measures of @xmath1 : @xmath164 & = & \\frac{\\widetilde{\\kappa_{,x}}[k_x , k_y ] }              { e^{2\\pi i k_x / n_x } - 1 } \\nonumber \\\\ \\tilde \\kappa_b[k_x , k_y ] & = & \\frac{\\widetilde{\\kappa_{,y}}[k_x , k_y ] }              { e^{2\\pi i k_y / n_y } - 1 } \\end{aligned}\\ ] ]    as with the ks93 method expressed in fourier space these two estimators have noise which varies strongly with direction in @xmath165-space , so we combine these with weights @xmath166 , @xmath167 , which , for high frequencies at least , gives the optimal combination : @xmath168 = \\frac{k_x^2}{k^2 } \\tilde\\kappa_a[k_x , k_y ] +      \\frac{k_y^2}{k^2 } \\tilde\\kappa_b[k_x , k_y]\\ ] ]    it is very simple to implement this technique .",
    "one simply bins the shear estimates onto a grid ( this can be very fine as the fft is very fast , and the fact that most of the grid cells are actually empty causes no problem ) .",
    "we then apply the two discrete difference operators to this grid of shear values and then combine the gradients according to equation ( [ eq : gradkappa ] ) which , for a very fine grid , produces an image ( or rather pair of images ; one for each component of the gradient ) which is largely zero and has a little l - shaped pattern at the location of each galaxy and we then simply apply the fft , calculate @xmath169 according to the two equations directly above , and then inverse transform .",
    "the results from this are very hard to distinguish visually from e.g. our other best methods , but , as we shall see , the noise power analysis suggests that the low - frequency performance of this method is somewhat worse than the best methods .",
    "doing the inversion in fourier space also leads to the attractive possibility to perform the non - linear lensing inversion .",
    "it is possible to construct the quantity @xmath170 from observable quantities ( kaiser 1995 ) , in exact analogy with equation ( [ eq : gradkappa ] ) . thus simply replacing @xmath1 by @xmath171 in the equations above",
    "gives a prescription for doing the inversion , even in the non - linear regime .",
    "from the finite field ` direct reconstruction ' methods , we obtain the @xmath1 estimate as a simple convolution of the data with some geometric kernels .",
    "this is guaranteed to be numerically stable and unbiased and has well defined and calculable noise properties .",
    "these are all nice features but the methods explored all presuppose that we have uniform sampling of the data .",
    "if one has highly inhomogeneous sampling ( and perhaps large holes in the data ) , one could imagine modifying the estimators derived here by bending the paths to avoid holes or noisy regions , but it it not clear that this is the best thing to do .",
    "a closely related issue is that we have concentrated on using the shear data on some area to determine @xmath1 on the same region , yet ( as our aperture mass statistics clearly show ) the shear is also rich in information on @xmath1 outside the data region .",
    "a quite different approach that can address the above problems is to attempt to find the most probable solution for the underlying surface density , given the set of observed shear estimates . to determine this",
    ", we construct the log - likelihood of a model @xmath172 .",
    "an apparent problem is that @xmath19 is determined in part by @xmath1 values outside the grid .",
    "one solution would be to extend the model to include more grid points , but this is somewhat costly . here",
    "instead we exploit the local expression for @xmath3 in terms of @xmath173 in equation ( [ eq : gradkappa ] )    for a @xmath1 field which is smooth on the scale of the grid , a grid of estimates of @xmath174 ( obtained from the measured shear values by applying an appropriate discrete difference operator form of the rhs of equation ( [ eq : gradkappa ] ) ) should be equal to the same operator applied to the model @xmath1-grid with gaussian distributed , but non - trivially correlated , gaussian residuals . what we are doing is using the discrete difference form of equation ( [ eq : gradkappa ] ) to project from the data that part which is locally determined , and then solving for the most likely @xmath1-configuration assuming we were provided only with this reduced from of the data .",
    "we present two methods to do this . in  [ sec : mp ] , we calculate the most probable @xmath1 field assuming a gaussian prior .",
    "this is similar to the method applied by kaiser and stebbins ( 1991 ) to reconstruct the local density field form peculiar velocity data .",
    "we also reformulate in real - space the problem in terms of a standard maximum likelihood analysis in  [ sec : ml ] .",
    "we approach the problem from the following perspective : given a set of observations ( e.g. shear estimates for @xmath175 galaxies ) , we want to _ fit _ a model for the underlying surface density . to be physically useful",
    ", the model must be as unrestrictive and general as possible .",
    "we take @xmath176 where we assume the surface density is periodic inside some box of side l  this is nonrestrictive as we can always zero - pad our data region to impose periodic boundary conditions . allowing @xmath177 fourier modes in our model , we rewrite equation ( [ eqn : finite_kappamodel ] ) as @xmath178 we have complete freedom in determining to fourier coefficients @xmath179 .",
    "a standard approach is to find the most probable set @xmath179 given the observed data .",
    "this implies we minimize @xmath180 ^ 2\\ ] ] with respect to @xmath181 so that @xmath182      y_k ( { \\bf r}_i ) \\chi_{\\alpha k}\\ ] ] for @xmath183 which labels the two shear components .",
    "this becomes a matrix equation @xmath184 where @xmath185 is an @xmath186 matrix and @xmath187 is a vector of length @xmath188 . to solve for the maximum likelihood @xmath189",
    ", we need to invert a @xmath190 matrix , which , in general , will be singular for any reasonably large number of k - modes .",
    "we regularize this inversion with a solution in the style of maximum entropy reconstructions . the probability of the model @xmath189 given the observed data @xmath191 and some prior information @xmath192 is @xmath193 and we want to maximize the probability to determine the `` best fit '' model for @xmath189 .",
    "this analysis yields the same equations as before but we including some prior knowledge to constrain , and hence regularize , the solutions . for gaussian uncertainties of the measurements ,",
    "the first term on the rhs of equation ( [ eqn : finite_bayest ] ) is as before @xmath194    we take as our prior model @xmath192 the assumption that the fourier coefficients are drawn from a gaussian distribution with a power spectrum @xmath195 .",
    "this adds a diagonal strip to the matrix equation so that @xmath196 and hence the matrix inversion is non - singular for an arbitrary number of fourier modes .",
    "this is very similar in spirit to the maximum probability reconstructions of the density field from peculiar velocities employed by kaiser & stebbins ( 1991 ) .",
    "we adopt a white noise @xmath197 power spectrum  this is often viewed as a maximally non - committal choice  and allow the amplitude to be a varying parameter . setting large amplitude for the power ( i.e. large @xmath198 ) corresponds to little regularization , while a small power amplitude tends to heavily bias the recovered signal downwards . the optimal amount to use",
    "is determined empirically .",
    "we run extensive simulations for a given @xmath175 to test the sensitivity of the reconstruction to the amplitude of the power selected .",
    "we find that there is a plateau where the reconstruction is insensitive to the input power ( the reconstruction is stable to variations about this amplitude ) .",
    "this is a very nice feature as we can tune the regularization so that the inversion is well behaved , yet we are not forcing the solutions to some particular form by the choice of our prior .",
    "we now construct an algorithm in real - space to calculate the maximum - likelihood @xmath1-field configuration ( considered as a grid of @xmath199 values ) given a set of shear estimates binned on a similar grid .",
    "we present the simple problem where we are given a binned set of shear values with equal noise .",
    "the generalization to unequal noise is straightforward and is not presented here .",
    "as before , we need to construct the log - likelihood @xmath172 , exploiting the local relationship between @xmath200 and observable shear estimates .",
    "we write the shear - vector estimates as the @xmath201 matrix @xmath202 where @xmath183 labels the shear component and @xmath203 which ranges from @xmath204 to @xmath205 is a compound index labeling the position where @xmath206 and where the individual coordinate indices are @xmath207 and @xmath208 .",
    "similarly we denote the model grid of surface density values by the vector @xmath209 .",
    "however , since the discrete differencing will only determine @xmath1 modulo an additive constant we make @xmath209 of dimension @xmath205 .",
    "this effectively forces the corner element @xmath210 to be zero , though one is free to adjust the zero - point after the reconstruction to any chosen reference value .",
    "there are several possible ways to implement the discrete differencing operator .",
    "we will use @xmath211 where the derivative fields @xmath212 live on an interleaved @xmath213 grid with @xmath214 , and where @xmath215    the discrete difference form of the rhs of equation ( [ eq : gradkappa ] ) is @xmath216 or @xmath217 with @xmath218 while the lhs is @xmath219 , with the summation extending from @xmath220 to @xmath221 .",
    "the correlation matrix for the residuals is defined as @xmath222 and is easily calculated since in the absence of any distorting influence ( and assuming gaussian distributed independent errors on the shear - vector estimates ) @xmath223 so @xmath224 and so the log - likelihood is @xmath225 where we have defined the @xmath226 matrix @xmath227 .",
    "minimization of @xmath228 wrt @xmath209 results in @xmath229 where @xmath230 and @xmath231 where we have defined @xmath232 and @xmath233    unfortunately , the matrix @xmath88 is singular ; it has a null space consisting of quasi - oscillatory vectors , any combination of which dotted with a on left gives zero on the rhs .",
    "adding a 9-point laplacian tickhonov - miller regularization ( see num recipes , 2nd ed ; chapter on inverse methods ) seems to solve this nicely .",
    "we now maximize @xmath234 i.e.  we add to the ` chi - squared ' an extra term consisting of some multiple of the variance in the 2nd derivative field @xmath235 , and we now obtain the matrix equation @xmath236 where @xmath237 is the `` trade - off parameter '' and @xmath238 is the laplacian smoothing operator ( we define @xmath239 for all grid points @xmath34 , but for for points on the perimeter , where the sum in equation ( [ eq : laplacian ] ) would extend outside the grid , we set @xmath240 ) .",
    "the effect of the regularization is to suppress the spurious ` null - modes ' which have strong high frequency components .",
    "the trade - off parameter , @xmath237 , can be thought of as a dial that either makes the solution very smooth ( for large @xmath237 ) , or allows the solution to fit all of the data points ( for small @xmath237 ) . for practical implementations ,",
    "one wants to choose some intermediate regularization that fits the data acceptably well , while smoothing out some of the noise fluctuations and conditioning the inversion process . in simulations",
    ", we find that for @xmath241 the result is a heavily smoothed reconstruction . for small @xmath237 ,",
    "the inversion is somewhat insensitive to the precise @xmath237 value ( unless it is so small that the matrix inversions blow up ) .",
    "this is an important feature  the answers given by this method will not be prejudiced by any reasonable choice for the regularization , and the user has some freedom in setting this parameter .",
    "so far we have constructed a whole family of estimators which all , given perfect data , return an exact reconstruction of the density field .",
    "the finite - field kernels each measure @xmath1 relative to a different baseline , but are all really equivalent since we can always add any constant we like to force a particular normalization after the fact .",
    "for example , you might particularly want to measure the surface density in some region relative to its value in the reference strip shown in figure [ fig : paths]c .",
    "you could of course use the case - c estimator without further ado .",
    "you could equally well use case - b , measure the value of the reconstruction in your chosen strip and then readjust the baseline .",
    "if this gives an estimate with lower statistical uncertainty then you should do so .",
    "our estimators are weighted sums of observed background ellipticities ; we think of each galaxy giving a noisy estimate of the shear at its location , the noise arising in part from the random intrinsic ellipticity and in part from the measurement error .",
    "the statistical uncertainty depends on how the weight is distributed among the background galaxies ; generally speaking , the more uniform the weight the smaller the statistical uncertainty .",
    "clearly the kernels are always rather sharply peaked towards the target point .",
    "this generates a @xmath242 divergence in the kernels .",
    "this is a common feature for all the methods and is also largely irrelevant since , as discussed , it generates predominantly high frequency noise which goes away when we smooth .",
    "here we are more interested in the low spatial frequency behavior of the reconstruction since this is where the bias appears in equation ( [ eq : ks93 ] ) . for random background ellipticities",
    "the reconstruction will be a superposition of ` inverse kernel ' patterns .",
    "the low - frequency behavior of these patterns is somewhat different for the different methods . in case - c type methods , for a narrow reference strip ,",
    "the galaxies in the reference region receive rather large weight , becoming infinite in the limit as the width tends to zero .",
    "moreover , the value of the kernel in the annulus depends only weakly on the target position provided the target point is not close to the edge .",
    "thus we would expect that for a random realization of reference annulus galaxy ellipticities one will generate a noise fluctuation of random amplitude , but which will be rather coherent and flat in the center of the reconstruction .      as a first , qualitative test we can compare reconstructions made with simulated data . to make these simulations we generate random gaussian variates @xmath243 , @xmath244 for randomly scattered galaxies .",
    "the rms 1-component shear error is @xmath245 .",
    "this seems to be quite a good value , determined observationally from field galaxies .",
    "we then add a small systematic shift calculated for a particular lens model .",
    "we place the cluster at z  =  0.2 and the galaxies in a plane at z  =  0.9 .",
    "we display the reconstructed surface density using the various methods in figure [ fig : simulation ] .",
    "all of the reconstructions have been smoothed with a 2  pixel gaussian .",
    "the algorithm of seitz & schneider was employed using circular geometry for calculational ease .    surprisingly , the bias in the original ks estimator is not very strong - even though the input mass distribution is not axisymmetric- and the bias seems only appreciable in the very corners of the reconstruction .",
    "the results are all somewhat similar in the signal recovery .",
    "of course , the overall amplitude of the case - c type estimators is higher than for case - b but this is irrelevant as the baseline surface density is unmeasurable from the shear measurements alone .",
    "however , the the noise properties vary significantly among the methods . with the case - c estimator ,",
    "the presence of the boundary term in the reconstruction gives rise to much higher noise , especially near the edge of the reconstruction .",
    "the same is true for the fourier method .",
    "qualitatively , one favors the methods that have the smallest noise fluctuations and the case - c estimators seem to perform the worst in these simulations .    while these simulations are very simplistic , they are indicative of the type of behavior we expect .",
    "the various estimation techniques are all very similar in the signal they recover .",
    "however , the case - c type estimators  estimators with boundary terms  tend to have the most obvious worrisome noise properties . in the next section",
    ", we explore this more quantitatively by calculating the statistical properties of the noise for the various types of estimators .      for sufficiently high galaxy number density",
    "we expect that the noise will approach a gaussian process by virtue of the central limit theorem . in that limit everything we need to know about the noise field",
    "is encoded in its power spectrum or autocorrelation function . as discussed , we are primarily interested in the performance of these methods for recovering low frequency signals .",
    "we do this in two ways : the first is to calculate the noise - power for the various methods , and the second is to calculate the variance in a specific ` aperture mass ' statistic .    to estimate the noise power we have generated a large number of realizations for randomly oriented galaxies .",
    "for each of these we estimate the power and then average the power over the realizations . in doing this",
    "we came upon a slight technical problem ; all of the finite - field methods tend to produce ` hot - spots ' around galaxies close to the edge of the survey region .",
    "these tend to be worse for the case - c type estimator , but are present in all cases .",
    "if we naively measure the power over the whole survey area we find that these leak though into the low frequency modes ( this is partly due to lack of resolution but is also partly a real , resolution independent , effect ) , artificially enhancing the low frequency power .",
    "this is somewhat discouraging , since the motivation for developing these methods was to cure the bias in the ks93 reconstruction , and we seem to have exchanged this for a lack of precision .    to make a meaningful comparison we have cropped each image to remove a strip 16 pixels wide around the edge .",
    "the low - frequency noise power is shown in figure [ fig : power ] .",
    "for each finite - field method we have chosen two different values ( @xmath246 and @xmath247 ) for the softening parameter @xmath129 .",
    "as expected the low - frequency power is very insensitive to @xmath129 ( provided it is small at least ) .",
    "we have also calculated the noise power using the maximum probability method with @xmath248 , and two amplitudes of the power amplitude that vary by a factor of five .",
    "we also display the results using the maximum likelihood method using trade - off parameters @xmath249 and @xmath250 .",
    "our calculation of the noise power spectrum differs from that of seitz & schneider . in figure  3 of their paper",
    "they make a similar attempt to calculate the noise power spectrum .",
    "their results are puzzling however .",
    "for the original ks93 estimator , we expect @xmath251 for a pure noise field .",
    "seitz & schneider plot @xmath252 , which , judging from the points in their figure , varies as @xmath253 for long - wavelengths .",
    "indeed all of the power spectra they calculate seem to diverge for long wavelengths .",
    "one explanation of this may be the lack of resolution in their simulations . as we discussed before ,",
    "the finite - field kernels have a @xmath242 divergence and a softening of this divergence is required . with coarse resolution ,",
    "the @xmath254 dependence in the kernel is not sampled finely enough and there is a leakage into the low frequency power .",
    "we find that for all of the methods , it is necessary to use much finer resolution to compensate for this effect . indeed ,",
    "when we employ the same resolution they used , we reproduce their curves . with finer resolution",
    "however , we obtain somewhat different results .",
    "the main difference among the noise power in all of the methods is that the estimators with boundary terms have a much noisier zero - frequency component .",
    "this is present in the case - c estimators and the seitz & schneider algorithm .",
    "as discussed , this is because the small number of galaxies in the annulus give a random fluctuation in the reconstruction which is nearly independent of target position .",
    "this is rather interesting .",
    "one motivation for choosing a case - c type estimator is that for a monotonic cluster profile one would expect this estimator to give a higher signal .",
    "what we are finding is that the price for this is increased noise , so this is largely counterproductive .",
    "similarly , the presence of the boundary term in the seitz & schneider algorithm introduces a large fluctuation in the long wavelength noise power .",
    "the maximum likelihood direct reconstruction method has behavior similar to the other methods at high frequencies .",
    "the obvious difference in this method is the presence of an enormous and very rapid divergence at small wavenumber .",
    "this suggests that for a pure noise reconstruction , the most likely solutions determined for the inversion are models with a large low frequency components .",
    "while a model with , for example , a gradient across the field seems very unlikely , this seems to be telling us that it is more likely than any other .",
    "this reflects the role of the trade - off parameter in our regularization  we can adjust it so that the reconstruction is either very smooth ( large regularization ) or , at the other extreme , returns a model that fits each and every data point ( and hence has large variations ) .",
    "what we find is that for a broad choice of trade - off parameters , the result is very stable and relaxes to a model with long wavelength fluctuations .",
    "dialing down the trade - off parameter to attempt to reduce the smoothness imposed on the inversion yields no improvement  the inversion becomes ill - conditioned .",
    "the fourier method has , not surprisingly , a long wavelength fluctuation as well .",
    "this simply comes from the fact that we are altering the data to overcome the periodic boundary condition problem .",
    "we have experimented with cropping the reconstruction area to attempt to remove this boundary effect and indeed find some improvement . however , there is some leakage into the long wavelength modes for any reasonable trimming .",
    "the behavior of the maximum probability method looks most promising .",
    "we see that for reasonable regularization , we obtain a flat noise power spectrum with the lowest amplitude of all the methods considered here .",
    "it is important to get the regularization correct as we see from the top curve in the maximum probability noise power spectrum  with too little amplitude in the prior power , the low frequency modes are amplified .",
    "however , for any given data set with some specified geometry and number of galaxies , we can determine the required regularization empirically so that the inversion is well behaved with no bias in the recovered signal .",
    "two - dimensional images of the mass distribution are nice , but sometimes one would like to estimate some gross property such as the mass contained within a given aperture . now one could always take the reconstruction , and integrate over the area in question , but then calculating the statistical uncertainty would seem to be a complicated business , particularly if the reconstruction is smoothed .",
    "in fact one can construct statistics which measure the mass within an aperture with a single summation over the galaxies .",
    "this is simpler , and has correspondingly simple statistical properties .",
    "moreover , these statistics can be designed to use only the data outside the aperture , which is useful if one wishes to minimize the contamination of the background galaxy population by faint cluster members , or to avoid regions where the weak shear approximation may not be valid .    as discussed in the introduction , from equation ( [ eq : tangentialshear ] ) , the integral in equation ( [ eq : ks93 ] ) truncated at inner and outer radii @xmath255 , @xmath256 ,",
    "is equal to @xmath257 ; if we make @xmath256 large this will tend to @xmath258 , and in general gives a lower bound on @xmath258 .",
    "this statistic is quite different in nature from equation ( [ eq : gradkappa ] ) which shows how observations on some region determine the surface density on the same region ( modulo a constant ) . here",
    "the statistic measures , or places a bound on , the mass in some region with observations taken outside that region .",
    "as we show in appendix [ sec : aperturesappendix ] , one can derive equation ( [ eq : tangentialshear ] ) from gauss law .",
    "this gives the mass within an aperture as the integral of the normal component of @xmath259 around the aperture boundary , while the shear measures second derivatives of @xmath6 , so it is not surprising that if we differentiate the mass enclosed with respect to the aperture radius this picks out some average of the shear on the boundary .",
    "here we will first derive equation ( [ eq : tangentialshear ] ) from equation ( [ eq : kappahat4 ] ) and then generalize it to non - circular apertures .",
    "if we take a circular survey of radius @xmath260 and place the origin at the center then @xmath261 and @xmath262 , so @xmath263 and equation ( [ eq : kappahat4 ] ) becomes @xmath264 so for concentric disks we find @xmath265 where @xmath266 and which gives a rigorous lower bound on the mass interior to @xmath255 , or , in differential form , @xmath267 which is equivalent to equation ( [ eq : tangentialshear ] ) .",
    "now @xmath39 can be thought of as a smoothing of @xmath1 with a top - hat window function , and @xmath268 is a compensated top hat filter .",
    "a general circularly symmetric smoothing of @xmath1 can be expressed as @xmath269 with @xmath270 to verify this result , integrate the lhs of equation [ eq : generalkappabar ] by parts to obtain an integral involving @xmath39 and then integrate by parts once again and replace derivatives of @xmath39 by @xmath271 using equation ( [ eq : dkappabardlnp ] ) .",
    "equation ( [ eq : windows ] ) provides a simple way to construct the ks93-style estimator for an arbitrarily smoothed reconstruction .",
    "note that even if @xmath272 has compact support @xmath273 will still have an extended tail @xmath274 unless @xmath275 vanishes  i.e.  unless we have a compensated filter .",
    "the argument leading to equation ( [ eq : circaperturekappabar ] ) also works for non - circular apertures .",
    "the key point is that the form of the kernel in equation ( [ eq : kappahat4 ] ) depends only on the _ shape _ of the boundary , so if we consider two nested boundaries of the same shape and orientation and take the difference in their @xmath276 values there is exact cancellation within the inner boundary curve and the result will only depend on the data between the curves .",
    "if we let the outer boundary be @xmath42 and the inner one be @xmath277 with scale factor @xmath278 , then @xmath279 where @xmath88 is the area inside the boundary @xmath42 , or in differential form @xmath280 where the averaging is understood to be over the thin ribbon separating two neighboring self - similar curves curves .",
    "it is straightforward to generalize the aperture mass statistic to inner and outer curves of different shapes ; simply choose some point within the inner aperture as origin , evaluate equation ( [ eq : kappahat4 ] ) for the two boundaries and take the difference , but the resulting statistic will now depend on the data within the inner aperture .",
    "we have explored the problem of reconstructing the surface density by direct and regularized inversion methods .",
    "the direct methods employ averaging over line integrals of the shear gradients exploiting equation ( [ eq : gradkappa ] ) .",
    "while we have restricted attention to straight lines , there is still a wide range choice in the geometry of the reference region . by performing the integrations by parts",
    "analytically we have been able to show explicitly how the estimator can be constructed as a weighted sum of galaxy ellipticities , greatly simplifying the estimation of the surface density and its uncertainty .",
    "we have presented analytic forms for the kernel for simple rectangular and circular survey geometries .",
    "our analysis has revealed a fundamental problem with attempts to measure @xmath1 relative to its value on the boundary of the data region ( as in the first method developed by schneider ) .",
    "we find that this is simply not attainable without introducing very large statistical uncertainty and/or bias .",
    "we have shown however that one can construct an estimator of @xmath1 relative to its value in some finite strip around the boundary , but the performance of this estimator seems to be no better than a simpler estimator where the baseline is set to the average over the whole region ( our case - b estimator ) .",
    "we have also shown how this particular estimator arises naturally if one develops ( starting from gauss law ) a differential relation between the mass enclosed within a boundary and the shear on the boundary .",
    "we have studied a new estimation technique proposed by seitz & schneider and have shown that it too possesses a boundary term and suffers from the same limitation as the method discussed above .    with fine grid resolution , we calculated the noise power spectrum for all the of the reconstruction methods .",
    "we find that , in general , estimators such as the case - c type or the seitz & schneider algorithm which give large weight to galaxies near the boundary have large long wavelength components in the noise power . among the methods that are classified as direct reconstruction , the case - b type estimators have more desirable noise properties than any estimator containing the boundary term .",
    "using a quite different approach , we have shown how one can construct an exact inverse gradient operator in discrete fourier transform space .",
    "this method has some distinct advantages : it is extremely fast ; it can be applied with a very fine grid to avoid losing any spatial resolution ( the real resolution limit is set by the noisy nature of the shear estimates ) ; and it is very easily extended to the strong - lensing regime . unfortunately , the low - frequency noise power seems to be somewhat higher than for the regularized maximum likelihood method for instance .",
    "we also formulated two regularized inversion methods based on the maximum probability and maximum likelihood techniques .",
    "as with the direct reconstruction methods , we discriminate among the performance of these estimators by their noise properties .",
    "we find that the maximum likelihood estimator with the usual 9-pt laplacian regularizer contains very large low frequency noise components .",
    "the maximum probability method , however , seems to be the most promising . with modest regularization ,",
    "the noise power spectrum is flat at all wavelengths , with essentially no bias in the recovered signal .",
    "were we given some data and told we could only apply one of the methods described here then that is what we would choose .",
    "the method is somewhat more costly in computer time than e.g. ks93 or the fourier inverse gradient operator , but not unreasonably so for realistic numbers of galaxies .",
    "we are confident that this paper is not the last word that will be said on the subject .",
    "the area promises to be rich , simply because there are potentially infinitely many ways to recover the surface density from the shear . crudely speaking this is because we are provided with two real scalar fields @xmath243 and @xmath244 which is much more information than we need to recover the single scalar @xmath1 , so there are many ways one can squander this information and yet still recover an unbiased answer .",
    "all we have done here is to apply a geometric construction to generate a family of viable estimators , and we have then compared their statistical performance .",
    "we have no way of knowing whether there might not be much better estimators out there somewhere , but perhaps the similarity in noise power for the methods we have considered is telling us something .",
    "consider a circular loop of radius @xmath34 and with azimuthal coordinate @xmath43 . at each point on the circle",
    "construct locally cartesian coordinates @xmath281 along the outward normal and tangential directions @xmath282 . by gauss law ,",
    "the mass contained within the loop is @xmath283 so @xmath284 but @xmath285 where the _ tangential shear _ is @xmath286 . in components in the general coordinate frame @xmath287 ) .",
    "hence @xmath288 where @xmath289 and @xmath290 .",
    "this is equivalent to equation ( [ eq : tangentialshear ] ) .",
    "let us now generalize this to non - circular apertures . take some arbitrary point as origin and consider the self - similar family of closed curves @xmath291 where @xmath292 is a cyclic parameter around the curve and @xmath293 is a scale factor .",
    "if we consider two neighboring curves then vector connecting points with the same @xmath292 has length @xmath294 , and if we erect orthogonal locally normal and tangential coordinates @xmath295 , such pairs have separation @xmath296 , @xmath297 where @xmath298 and where @xmath299 and @xmath300 . by gauss law , @xmath301 and @xmath302 where @xmath303 are unit vectors .",
    "taylor expanding @xmath304 to 1st order and replacing @xmath305 by @xmath306 with parallel component of the shear @xmath307 defined to be @xmath308 , and with the orthogonal component of the shear @xmath309 , we have @xmath310 but the integral here is just the integral of @xmath311 over the area @xmath312 in the ribbon between the two curves , and we therefore have , for @xmath313 , @xmath314 or @xmath315 where the averaging is understood to be over the thin ribbon .    now",
    "the area is @xmath316 where @xmath317 is the area enclosed within the curve @xmath318 , so we have @xmath319 if we take @xmath320 to be the perimeter of the data region and let @xmath321 then we obtain a measure of @xmath1 at a point ( the origin ) relative to the mean over the data region and the result is precisely equivalent to equation ( [ eq : kappahat4 ] ) . for finite @xmath293",
    "we obtain the mass enclosed within the aperture @xmath322 as an integral over the data lying outside the aperture just as in  [ sec : apertures ] .    the alternative derivation given in this section",
    "is not entirely pointless , however , since because of the redundancy in the data  we appear to have a two component field @xmath323 but in reality both @xmath243 and @xmath244 are derived from a single scalar surface potential function @xmath324  there are many different estimators which measure the same physical quantity but which have different noise characteristics . a simple example of this is equation ( [ eq : tangentialshear ] ) to which we could , if we were perverse , add any multiple of the integral of @xmath325 around the loop which physically must vanish and so , with real data , will add pure noise .",
    "it was therefore not entirely a foregone conclusion that these two different approaches would give the same result , but in fact they do ."
  ],
  "abstract_text": [
    "<S> weak lensing observations measure the shear field @xmath0 , and hence the gradient of the dimensionless surface density @xmath1 . </S>",
    "<S> we present several new algorithms to recover @xmath1 from shear estimates on a finite region and compare how they perform with realistically noisy data . </S>",
    "<S> the reconstruction methods studied here can be divided into two classes : direct reconstruction and regularized inversion techniques . </S>",
    "<S> the direct reconstruction techniques express the surface density as a two - dimensional integral of the shear field : @xmath2 . </S>",
    "<S> this allows one to construct an estimator for @xmath1 as a discrete sum over background galaxy ellipticities which is straightforward to implement , and allows a rigorous yet simple estimate of the noise arising from random intrinsic background galaxy ellipticities . </S>",
    "<S> we study three types of direct reconstruction methods : 1 ) @xmath1-estimators that measure the surface density at any given target point relative to the mean value in some reference region 2 ) a method that explicitly attempts to minimize the rotational part of @xmath3 that is due to noise and 3 ) a novel , exact fourier - space inverse gradient operator . </S>",
    "<S> we also develop two ` regularized maximum likelihood ' methods , one of which employs the conventional discrete laplacian operator as a regularizer and the other uses regularization of all components in fourier space . </S>",
    "<S> we compare the performance of all the estimators by means of simulations and noise power analysis . </S>",
    "<S> a general feature of these unbiased methods is an enhancement of the low - frequency noise power which , for some of the methods , can be quite severe . </S>",
    "<S> we find the best performance is provided by the maximum likelihood method with fourier space regularization , although some of the other methods perform almost as well .    </S>",
    "<S> epsf    @scaling.95 # 1@scaling#1    # 1    # 1 # 1 # 1 </S>"
  ]
}