{
  "article_text": [
    "the prospect of building quantum information processors that probably outperform their classical counterparts has sparked enormous interest in this field of research @xcite .",
    "however , the development of actual quantum computers remains in its infancy that lots of current relevant experimental works are still proof - of - principle demonstrations and are carried on relatively small number of qubits @xcite .",
    "bringing the great potential of quantum computers to reality requires precise and universal control over the degrees of freedom that are used as qubits @xcite .",
    "the challenges lie not only on robust control against noises from the environment , but also on how to reduce the operational errors due to imperfections in the control procedure .",
    "the task of constructing effective pulse controls is demanding for large quantum systems because of their huge hilbert state space .",
    "it is thus natural to take scalable pulse control synthesization as one of the central problems in the quantum control research field .",
    "liquid - state nmr offers an excellent testbed for benchmarking various quantum algorithms @xcite and developing sophisticated quantum control techniques @xcite . finding appropriate control fields that can accomplish the target unitary propagator is crucial for these experiments .",
    "employment of optimal control theory to solve this problem proves to be a great success . in small - size systems , through gradient - based numerical search high accuracy solutions ( e.g. , well beyond an error correction threshold around @xmath0 per gate in the case of depolaring noise ) can be sought .",
    "however , as the method involves in full simulation of the system evolution , it is intrinsically inefficient . the alternative approach to brute force optimization , is to implement the quantum gates through soft pulses that are of predefined shapes like rectangular or gaussian wave @xcite .",
    "for example , a rotational gate on an assigned qubit can be realized by a rotating gaussian that is on resonance , but just approximately .",
    "the imperfections have to be figured out and taken care of .",
    "actually they are captured by lower order average hamiltonian theory , thus avoiding simulation of full range of the system dynamics . as to an entire quantum circuit and its corresponding soft pulse network , a systematic and scalable compilation programme to reduce the imperfections",
    "was built @xcite .",
    "the feasibility of this method was confirmed in a number of experiments @xcite , and complicated dynamic control has been achieved for a system with up to 12 qubits @xcite .",
    "the studies on the pulse network compiler technique in the above mentioned works are limited to corrections of errors that arise from zeroth order average hamiltonian @xcite .",
    "this restricts the kind of operations that can be dealt with in this framework .",
    "for instance , bloch - siegert shift as a first order effect causes phase errors ( which can be moved freely within the pulse network ) for single - qubit rotations , but would induce off - resonance errors for operations that rotate several qubits simultaneously .",
    "therefore , in this paper we take into account the first order error terms so as to increase the control fidelity to a higher level . with the application of average hamiltonian theory , we are able to derive a set of general correction rules for adjusting the selective pulse shapes .",
    "we also make numerical tests on concrete nmr molecules , including the control tasks of multi - frequency excitation , multiple - qubit rotation and systematic circuit compilation , to demonstrate the effectiveness of our correction rules .",
    "to start , we give a brief description of the basics of liquid - state nmr system .",
    "interested readers are refered to standard textbooks such as @xcite for more details .",
    "the liquid nmr sample we are considering consists of an ensemble of @xmath1 non - magnetically equivalent spin-1/2 nuclei .",
    "the @xmath2 identity @xmath3 and the spin operators @xmath4 and their direct products , are introduced to form a basis of the system s state space . on occasions",
    "we shall use the shorthand notation @xmath5 , which satisfies the commuting relations : ( i ) @xmath6 = i   i_{\\phi + \\pi/2}$ ] and ( ii ) @xmath7 = i\\sin(\\phi_2 - \\phi_1 ) i_z$ ] .",
    "the sample is placed in a large static magnetic field ( strength @xmath8 ) with its direction , by convention , being defined as the @xmath9 axis .",
    "this magnetic field splits the energy levels of the spin states aligned with and against it , giving a hamiltonian in zeeman terms , that is , @xmath10 where @xmath11 , @xmath12 and @xmath13 are the gyromagnetic ratio , chemical shift and larmor frequency of the @xmath14-th spin respectively .",
    "each qubit is associated to a value @xmath14 and addressable through a pulse with a frequency corresponding to its chemical shift . for nuclear spins in molecules that are rapidly tumbling ,",
    "their effective interaction mechanism are the isotropic part of the indirect electron - mediated interaction ( also called @xmath15 coupling ) through chemical bonds . if the coupling strengths are much smaller than the differences of the resonant frequencies , the system is then considered to be weakly coupled , and the spin - spin hamiltonian simply takes the following form @xmath16 where @xmath17 is the coupling strength between spins @xmath18 and @xmath14 . external radiofrequency ( rf ) field @xmath19",
    "is exerted upon the sample , providing the control hamiltonian @xmath20 an arbitrary unitary operation can be implemented through a control pulse @xmath21 combined with the system hamiltonian @xmath22 .",
    "one important type of rf excitation is the frequency selective pulse .",
    "it is designed to excite spins over a limited frequency region , while minimizing influences to spins that are outside this region .",
    "a selective pulse can be thought of as a rotating pulse shape that is on - resonance with the nuclei to be excited . to judge the selectivity of a given pulse shape , it is routine to examine its excitation profile , i.e. , dependence of the amount of excitation over the resonance offset .",
    "a high quality excitation profile should satisfy that : ( i ) within the excitation region , full excitation is achieved and ( ii ) outside the excitation region , excitation is suppressed .",
    "selective pulse shape design has been extensively studied in the nmr literature and various optimization methods were proposed @xcite .",
    "the problem is in principle nonlinear , making it rather difficult to devise a universal method that applies to all circumstances .",
    "however , in the case of small - tip - angle excitations ( i.e. , linear regime ) , there does exist a simple description that exploits the close relationship between a rf envelope s excitation profile and its fourier transform .",
    "this linearized treatment results in a number of general and instructive rules in selective pulse shape design .",
    "for instance , it suggests that a rf envelope s selectivity increases for longer pulse length and softer pulse energy .",
    "the finite - length duration of a pulse also affects its excitation pattern . in the remainder of this section",
    ", we present an analysis of gaussian pulse shape and how to choose appropriate parameters to increase its selectivity .    _ gaussian selective pulse_.",
    "let @xmath23 be an ideal normalized gaussian envelope that extends to @xmath24 : @xmath25 here @xmath26 is the variance parameter .",
    "in the problem of small flip angle @xmath27 excitation , we use a selective pulse @xmath28 which when on resonance would generate the right angle of rotation . for a spin precessing at frequency @xmath29 and initially polarized at the north pole of the bloch sphere , the @xmath9 component of the magnetization of the final state , by zeroth order average hamiltonian theory ,",
    "is @xmath30 here @xmath31 is the fourier transform of @xmath23 and is thus again a gaussian .",
    "therefore the excitation profile goes @xmath32 the leading term is a gaussian with variance @xmath33 .",
    "suppose the suppresion region is @xmath34 , that is , the amount of excitations in this region is below some level .",
    "let @xmath35 where @xmath36 is some prescribed precision requirement , then there should be @xmath37 a practical pulse in experiment is of finite length , and hence is of truncated form . the fourier transform of this truncated window",
    "is the convolution of the gaussian with a dirichlet kernel , which results in the formation of the spectral main - lobe with accompanying side - lobes whose peak levels depend on the parameter @xmath26 and @xmath38 .",
    "therefore , the width of the gaussian has to be sufficiently long so that the truncation only causes negligible errors .",
    "[ profile ] gives numerical simulations showing how the gaussian parameters affect the excitation profile .",
    "file 180sigma2.txt ; file 180sigma3.txt ; file 180sigma4.txt ; ;",
    "in the circuit model of quantum computation , a quantum algorithm is implemented through a sequence of single - qubit rotations and two - qubit coupling gates @xcite .",
    "the coupled logic can originate from the natural couplings in the quantum system involved . in solution nmr ,",
    "the scheme of coupling any designated pair of spins so as to perform a target two - qubit gate can be made efficient by using decoupling and recoupling techniques with ideal @xmath39 pulses @xcite .",
    "therefore , a circuit can always be decomposed into a train of local single - spin operations separated by free evolutions between these operations .",
    "let us then , without loss of generality , represent an arbitrary circuit by @xmath40 as follows : @xmath41 where @xmath42 is the action time of the @xmath43-th operation @xmath44 @xmath45 here @xmath46 denotes a rotational transformation of the @xmath14-th spin for an angle @xmath47 ( @xmath48 ) along axis @xmath49 ( @xmath50 ) in x - y plane .",
    "control pulses that are able to generate these unitary operators can be found by numerical searching according to some distance or fidelity measure .",
    "however , the computational costs would soon become unaffordable for larger systems .",
    "the relatively easier alternative would be applying frequency selective pulses .",
    "as mentioned in the previous section , a selective pulse shape on resonance with a specific spin can excite that spin selectively .",
    "thus , to rotate the @xmath14-th qubit , we use a selective pulse of the following form @xmath51 here @xmath52 $ ] with @xmath38 denoting the pulse length , @xmath53 is some normalized symmetric pulse shape satisfying @xmath54 to rotate the spins simultaneously , one intuitively adds the corresponding selective pulses together @xmath55 not surprisingly , this control pulse does not exactly implement the wanted operation and becomes less effective for increasing number of qubits that are to be excited .",
    "it is then necessary to analyze what kinds of error come in and what corrections must be made to the pulse parameters for the goal of improving control fidelity .",
    "component field ; red : @xmath56 component field ) .",
    "when transformed into the resonant rotating frame , it can be seen that with discretization , the spin would experience a distorted control field which rotates the spin about a slightly altered axis .",
    "( b ) illustration of bloch - siegert effect .",
    "when spin - selective pulses are applied simultaneously to two spins , the pulse at one spin temporarily shifts the frequency of the another . as a result",
    ", the pulse on the other spin , without irradiation frequency correction , will be off - resonance and the resulting rotations deviate significantly from the desired operation . ]",
    "\\(1 ) _ choice of @xmath38 and @xmath26 .",
    "_ each selective pulse envelope @xmath57 should be of good enough selectivity , which is measured by the ability to excite an assigned resonance without appreciably affecting near neighbours . given the values of the qubits precession frequencies , it then gets clear on the configuration of the desired excitation profile . in mathematical terms",
    ", this requires that @xmath58 to meet the condition above , gaussian is preferred to rectangle pulse , as its associated excitation profile is better localized in frequency domain @xcite .",
    "our example presented in the last section is helpful for choosing appropriate values of the gaussians variances and widths .",
    "\\(2 ) _ correction of @xmath27 and @xmath59 due to input pulse discretization .",
    "_ although smooth pulses are ideal , the system limitations force us to discretize the pulse into many time slices .",
    "there is also the possibility that sometimes we would like the pulse to be of less number of slices so that the time cost of simulating system evolution could be reduced .",
    "[ error](a ) suggests that discretization procedure results in deviations of the rotational angle and rotational axis .",
    "the imperfections here have to be taken into account .",
    "\\(3 ) _ correction of @xmath60 due to bloch - siegert shift .",
    "_ it has long been known that a selective irradiation on a particular spin will cause an offset - dependent @xmath9 rotational phase shift to the evolution of another spin , that is , the so - called bloch - siegert ( bs ) shift @xcite . as a higher order averaging effect ,",
    "this amounts to shift the resonant frequency of the spins even that are far outside the excitation region ( see fig . [ error](b ) ) .",
    "eliminating bloch - siegert shifts is a frequently encountered subject and there have been a lot of relavent research works .",
    "however , the common methods , such as using additional soft pulses to balancing the frequency shifts of the spins @xcite , or brute - force optimization of the pulse shapes @xcite , are not suited for the present task . the more convenient approach would be to adjust the irradiation frequencies of the pulse @xmath61 so that each of them can match the corresponding shifted resonance @xcite .",
    "\\(4 ) _ pre- and post - error representation .",
    "_ it is especially important to be aware of that , the propagator ( denoted by @xmath62 ) generated by a single - spin selective pulse does not simply equal to the ideal operation .",
    "their actual relation has been exploited in @xcite : to first order approximation , and if @xmath63 , there exists the following general pre- and post - error decomposition scheme @xmath64 where @xmath65 and @xmath66 takes the following form @xmath67 the parameters @xmath68 are phase errors due to spin precession and bloch - seigert effect , and @xmath69 are coupled evolution errors . in @xcite there is described an efficient procedure of numerically seeking for these error terms , which are then compensated by using a general pulse compiler programme .",
    "although for multi - spin selective excitation the representation eq .",
    "( [ pre - post ] ) still holds ( as we will see in the next section ) , determining the phase errors by numerical optimization would not be a good choice now .",
    "experiences show that phase and coupling errors are not likely to be both eliminated completely with simple general rules .",
    "we now formulate the central problem to study in this work in a more precise way .",
    "we are going to use multiple - qubit selective pulse to implement the ideal operation eq .",
    "( [ uideal ] ) .",
    "let the pulse be of length @xmath38 , and be divided into @xmath70 pieces , let @xmath71 denote the length of each time step , for the @xmath72-th time interval @xmath73 , set @xmath74 =   \\sum\\limits_{k=1}^n { \\frac{\\theta'_k } { { 2\\pi } } { g}_k [ m ] ( \\cos ( \\omega'_k m\\tau + \\varphi'_k ) , \\sin ( \\omega'_k m\\tau + \\varphi'_k ) ) } . \\nonumber\\ ] ] the corresponding control hamiltonian reads @xmath75 = \\sum\\limits_{k=1}^n \\sum\\limits_{j=1}^n { \\theta'_j { g}_{j } [ m ] i^k_{\\omega'_j m\\tau + \\varphi'_j } } ,    \\label{control}\\ ] ] our goal is then to find correction rules for @xmath76 , @xmath77 and @xmath78 to increase the fidelity of representation eq .",
    "( [ pre - post ] ) .",
    "average hamiltonian theory has frequently been used to generate an expansion in the effective hamiltonian .",
    "it offers a powerful framework for analyzing and removing unwanted terms in the hamiltonian by periodic perturbations without requiring full knowledge of the system dynamics .",
    "the formalism can be described as follows . in the multi - rotating frame @xmath79",
    "the system evolves according to @xmath80,\\ ] ] where @xmath81 and @xmath82 , according to expression eq .",
    "( [ control ] ) , is a piecewise continuous function , that is , for the @xmath72-th time interval @xmath73 : @xmath83 i^k_{\\omega'_j m\\tau -\\omega_k t + \\varphi'_j } } .",
    "\\label{rf}\\ ] ] let @xmath84 denote the dyson time ordering operation , the time evolution operator in the interaction picture will be formally written as @xmath85 the magnus expansion @xcite , permits calculation of the effective propagator @xmath86 for the entire sequence @xmath87 in which the first two terms are given by @xmath88    dt_1 } dt_2}.   \\nonumber \\end{aligned}\\ ] ] provided that the applied pulse is sufficiently soft in a suitable sense ( e.g. , a converging criterion would be @xmath89 for some constant @xmath90 @xcite ) , then @xmath91 and @xmath92 will capture most of the system behaviours .",
    "now we substitute eq .",
    "( [ rf ] ) into the above expressions .",
    "the zeroth order averaged hamiltonian is    @xmath93 \\left [ \\cos(\\omega'_j m\\tau -\\omega_k t + \\varphi'_j ) i_x^k + \\sin(\\omega'_j m\\tau -\\omega_k t + \\varphi'_j ) i_y^k \\right ] dt } \\right ) }   \\nonumber \\\\ & = h_j + \\frac{1}{t } \\sum\\limits_{k=1}^n \\sum\\limits_{j=1}^n \\sum\\limits_{m=1}^m { \\left(\\theta'_j { g}_j [ m ] \\tau\\frac { \\sin(\\omega_k\\tau/2)}{\\omega_k \\tau/2 }    i^k_{(\\omega'_j-\\omega_k ) m\\tau + \\omega_k \\tau/2 + \\varphi'_j }     \\right ) } \\nonumber   \\end{aligned}\\ ] ]    recall that we have assumed good selectivity of the gaussian shapes ( see eq .",
    "( [ gproperty ] ) ) , we here thus for the above expression only retain those terms for which @xmath94 as otherwise the operator @xmath95 would be fast oscillating such that the relative summation vanishes .",
    "now , we set @xmath96 for the reason that will be seen instantly .",
    "then , we have @xmath97 where @xmath98 \\tau   \\cos\\left(\\delta\\omega_k ( m\\tau - t/2)\\right )",
    "\\right ) } ,   \\nonumber \\\\ \\zeta'_k & =   \\sum\\limits_{m=1}^m { \\left ( { g}_k [ m ] \\tau \\sin\\left(\\delta\\omega_k ( m\\tau - t/2)\\right ) \\right)}.   \\nonumber\\end{aligned}\\ ] ] @xmath99 is close to 1 as @xmath100 is small .",
    "@xmath101 actually vanishes because @xmath57 is symmetric , while @xmath102 is antisymmetric with respect to @xmath103 . to ensure that the @xmath14-th spin is rotated by the desired angle",
    ", we set @xmath104 consequently , we obtain @xmath105 next , we calculate @xmath92 . obviously that there is @xmath106 where @xmath107    dt_1 } dt_2 } , \\nonumber \\\\ \\mathcal{h}^{(1)}_2   & = \\frac{-i}{2 t } \\int_0^t { \\int_0^{t_2 } { \\left [ h_j ,   h^i_\\text{rf}(t_1 ) \\right ]    dt_1 } dt_2 } , \\nonumber   \\\\ \\mathcal{h}^{(1)}_3   & = \\frac{-i}{2 t }",
    "\\int_0^t { \\int_0^{t_2 } { \\left [ h^i_\\text{rf}(t_2 ) , h_j \\right ]    dt_1 } dt_2}.\\nonumber\\end{aligned}\\ ] ] we will only consider the first term , which corresponds to the transient bloch - siegert shift . the estimation procedure is put in the appendix . with a lengthy derivation , we got the following expression ( see eq .",
    "( [ h111 ] ) ( [ h112 ] ) ) @xmath108 with @xmath109 determined by @xmath110     { g}_{k } [ m_1 ]    ( m_1-m_2 )   \\right ] }   \\nonumber\\ ] ] and @xmath111 denoting the transient bloch - siegert shift for the @xmath14-th spin : @xmath112 here the definition of @xmath113 is given in eq .",
    "( [ e ] ) . to elimintate the bloch - siegert shifts in @xmath114",
    ", we have to set the detunings as follows @xmath115 eventually , we get the result @xmath116 here @xmath117 is 1 if @xmath118 and is 0 if @xmath119 . back to the lab frame , there is @xmath120 here we used the trotter expansion : @xmath121 when @xmath122 is much smaller than @xmath123 .",
    "in the last section , in deriving the pre- and post- representation for @xmath62 we have fixed eq .",
    "( [ varphi]),([theta ] ) and ( [ omega ] ) , which we regard as to be the pulse parameter correction rules that we are seeking for . solving these error compensation equations",
    "requires numerical nonlinear optimization .",
    "nonetheless , reasonable approximations can be made to simplify the rules , e.g. , @xmath124 as @xmath100 is small .",
    "summarily , we state our main results as follows .",
    "suppose we are using control pulse of the form eq .",
    "( [ control ] ) to do operation eq .",
    "( [ uideal ] ) , suppose the selective pulse shapes are symmetric gaussian envelopes with good selectivity , and the values of the irradiation frequencies , rotational angles and rotational phases are respectively determined according to the following rules :    @xmath125    { g}_{k } [ m_1 ]    ( m_1-m_2 )   \\right ] } } , \\\\",
    "\\varphi'_k & = \\varphi_k - \\omega_k \\tau/2 - \\delta \\omega_k t/2 , \\\\",
    "\\theta'_k   & = \\frac{\\displaystyle \\frac{\\omega_k \\tau/2 } {   \\sin(\\omega_k\\tau/2 ) } \\theta_k}{\\displaystyle \\sum\\limits_{m=1}^m { \\left ( g_k[m ] \\tau \\cos(\\delta\\omega_k ( m\\tau -t/2 ) )   \\right ) } } .\\end{aligned}\\ ] ]    then to first order dynamics , there will be @xmath126 with the pre - errors and post - errors given by    @xmath127    we give a very quick discussion of the correction rules in the following two cases :    \\(1 ) _ with state assumptions .",
    "_ in the selective pulse driven state transfer problem , if the starting state or the ending state is in some known specific state that are commutative with @xmath9 rotations , then the phase tracking calculations can be simplified .",
    "examples of such specific states include pseudopure state and maximally mixed state @xcite",
    ". basically , the correction formula for @xmath128 will be : ( i ) if pre - error term @xmath129 does not affect starting state , then @xmath130 ; ( ii ) if post - error term @xmath131 does not affect ending state , then @xmath132 .",
    "\\(2 ) _ zeroth order correction . _",
    "if we only correct phase and angle parameters , but keep the frequencies of the gaussians unchanged , this can be thought of as zeroth order correction , in agreement with @xcite .",
    "we will compare the performances of zeroth and first order correction for multiple - qubit rotations in the next section .",
    "now let s see how to compile a selective pulse network . as indicated by eq .",
    "( [ mainformula ] ) , there mainly involves two types of errors , namely @xmath133 and @xmath134 rotations .",
    "apparently , for a complicated network , most pulses give the right @xmath134 evolution ( see eq .",
    "( [ pre - beta ] ) , ( [ post - beta ] ) ) , except for a few that are at the very start or end of the network . while the previous compiler method in ref .",
    "@xcite employed a further subprogramme to optimize the delyas between the pulses , in our formulation we are not going to alter the locations of the selective pulses .",
    "although this strategy sacrifices some fidelity for sure , the benefits would be making the compilation activity rather simple on the whole . as for @xmath133 error terms",
    ", the crucial point is that ( see @xcite ) , whenever there is a rotation about @xmath9 say @xmath135 : ( i ) if it is followed by a period of free evolution , their order can be interchanged ; ( ii ) if it is followed by a transverse rotation @xmath136 , it can be moved across that rotation according to : @xmath137 .",
    "therefore @xmath9 rotations , whenever encountered , actually need not be executed and can always be moved one step forward till the end of the network .",
    "one keeps in track of @xmath9 error accumulation process , and by doing so one can readily figure out the right measurements to take after finishing the circuit .",
    "next section will give a concrete control instance demonstrating how this method works .",
    "in this section , we perform numerical simulations using our correction procedure on two physical systems , namely ( i ) iodotrifluroethylene ( c@xmath138f@xmath139i ) dissolved in d - chloroform , which contains three @xmath140f nuclei :        and ( ii ) pre-@xmath141c - labeled dichlorocyclobutanone derivative dissolved in d6-acetone , which contains seven labeled carbon nuclei and serves as a seven - qubit system when the @xmath142h nuclei are decoupled :        the system hamiltonian parameters ( all in hz ) as given in the tables are extracted from @xcite and @xcite respectively : diagonal elements of the tables give chemical shifts with respect to the base frequency for @xmath140f or @xmath141c transmitters ; off - diagonal elements give @xmath15 coupling terms .",
    "component of the magnetization of a spin as a function of its frequency .",
    "the spin starts out along @xmath143 and is subject to seven simultaneous gaussian - shaped pulses ( @xmath144 ms , @xmath145 , @xmath146 @xmath147s ) with carrier frequencies on resonance with dichlorocyclobutane s seven qubits respectively . shown in the zoomed - up inset plot",
    "is a bs shift of 62.53 hz and unideal inversion , which then is perfectly corrected with parameter calibration .",
    "the data of the inverted magnetization at the seven sites are ( from left to right in order ) : -0.9999,-0.9975,-0.9997,-0.9997,-0.9963,-0.9993,-0.9991 . ]",
    "single- and multi- qubit @xmath39 rotational transformations on dichlorocyclobutane , using the selective pulse compilation method . for all selective excitations ,",
    "we use gaussian pulse shapes with @xmath144 ms , @xmath148 and @xmath146 @xmath147s .",
    "we also plotted the numerical results under the condition of zero couplings and first - order correction for comparison ( brown ) . ]    in -1,0,1 ( 0 , ) ",
    "( 2.5 , ) ; in -1,0,1 ( 4.5 , )  ( 7 , ) ; in -1,0,1 ( 9 , )  ( 11.5 , ) ; in -1,0,1 ( 13.5 , )  ( 16 , ) ;    at ( -0.5,1 ) @xmath149 ; at ( -0.5,0 ) @xmath150 ; at ( -0.5,-1 ) @xmath151 ;    ( 1.25 - 1,1 - 0.3 ) rectangle ( 1.25 + 1,1 + 0.3 ) ; at ( 1.25,1 ) @xmath152 ;    ( 2.5,-1.1 )  ( 4.5,-1.1 ) ; at ( 3.5,-1.5 ) @xmath153 ; in -1,0,1 ( 2.5 , )  ( 4.5 , ) ; ( 3,-0.5 )  ( 3,-1 ) ; ( 3.5,0.5 )  ( 3.5,0 ) ; ( 3.5,1.5 )  ( 3.5,1 ) ; ( 4,-0.5 )  ( 4,-1 ) ;    ( 5.75 - 1,1 - 0.3 ) rectangle ( 5.75 + 1,1 + 0.3 ) ; at ( 5.75,1 ) @xmath154 ;    ( 7,-1.1 )  ( 9,-1.1 ) ; at ( 8,-1.5 ) @xmath153 ; in -1,0,1 ( 7 , )  ( 9 , ) ; ( 7.5,-0.5 )  ( 7.5,-1 ) ; ( 8,0.5 )  ( 8,0 ) ; ( 8,1.5 ) ",
    "( 8,1 ) ; ( 8.5,-0.5 ) ",
    "( 8.5,-1 ) ;    ( 10.25 - 1,1 - 0.3 ) rectangle ( 10.25 + 1,1 + 0.3 ) ; at ( 10.25,1 ) @xmath155 ;    ( 11.5,-1.1 )  ( 13.5,-1.1 ) ; at ( 12.5,-1.5 ) @xmath156 ; in -1,0,1 ( 11.5 , )  ( 13.5 , ) ; ( 12,0.5 )  ( 12,0 ) ; ( 12.5,1.5 )  ( 12.5,1 ) ; ( 12.5,-0.5 )  ( 12.5,-1 ) ; ( 13,0.5 ) ",
    "( 13,0 ) ; ( 14.75 - 1,1 - 0.3 ) rectangle ( 14.75 + 1,1 + 0.3 ) ; at ( 14.75,1 ) @xmath157 ;    in -2.5,-3.5,-4.5 ( 0 , )  ( 0.5 , ) ; in -2.5,-3.5,-4.5 ( 2.5 , )  ( 5 , ) ; in -2.5,-3.5,-4.5 ( 7 , )  ( 9.5 , ) ; in -2.5,-3.5,-4.5 ( 11.5 , )  ( 16 , ) ; at ( 16.5,-2.5 ) @xmath158 ; at ( 16.5,-3.5 ) @xmath159 ; at ( 16.5,-4.5 ) @xmath160 ;    ( 0.5,-4.6 )  ( 2.5,-4.6 ) ; at ( 1.5,-5 ) @xmath156 ; in -2.5,-3.5,-4.5 ( 0.5 , )  ( 2.5 , ) ; ( 1,-3 ) ",
    "( 1,-3.5 ) ; ( 1.5,-2 ) ",
    "( 1.5,-2.5 ) ; ( 1.5,-4 ) ",
    "( 1.5,-4.5 ) ; ( 2,-3 ) ",
    "( 2,-3.5 ) ;    ( 3.75 - 1,-2.5 - 0.3 ) rectangle ( 3.75 + 1,-2.5 + 0.3 ) ; at ( 3.75,-2.5 ) @xmath161 ; ( 3.75 - 1,-3.5 - 0.3 ) rectangle ( 3.75 + 1,-3.5 + 0.3 ) ; at ( 3.75,-3.5 ) @xmath162 ;    ( 5,-4.6 )  ( 7,-4.6 ) ; at ( 6,-5 ) @xmath163 ; in -2.5,-3.5,-4.5 ( 5 , )  ( 7 , ) ; ( 5.5,-2 )  ( 5.5,-2.5 ) ; ( 6,-3 )  ( 6,-3.5 ) ; ( 6,-4 )  ( 6,-4.5 ) ; ( 6.5,-2 )  ( 6.5,-2.5 ) ;    ( 8.25 - 1,-3.5 - 0.3 ) rectangle ( 8.25 + 1,-3.5 + 0.3 ) ; at ( 8.25,-3.5 ) @xmath164 ;    ( 9.5,-4.6 )  ( 11.5,-4.6 ) ; at ( 10.5,-5 ) @xmath163 ; in -2.5,-3.5,-4.5 ( 9.5 , )  ( 11.5 , ) ; ( 10,-2 )  ( 10,-2.5 ) ; ( 10.5,-3 )  ( 10.5,-3.5 ) ; ( 10.5,-4 )  ( 10.5,-4.5 ) ; ( 11,-2 )  ( 11,-2.5 ) ;    ( 12.75 - 1,-3.5 - 0.3 ) rectangle ( 12.75 + 1,-3.5 + 0.3 ) ; at ( 12.75,-3.5 ) @xmath165 ; ( 12.75 - 1,-4.5 - 0.3 ) rectangle ( 12.75 + 1,-4.5 + 0.3 ) ; at ( 12.75,-4.5 ) @xmath166 ;    ( 15 - 0.8,-3.5 - 0.3 ) rectangle ( 15 + 0.8,-3.5 + 0.3 ) ; at ( 15,-3.5 ) @xmath167 ; ( 15 - 0.8,-4.5 - 0.3 ) rectangle ( 15 + 0.8,-4.5 + 0.3 ) ; at ( 15,-4.5 ) @xmath168 ;    fig .",
    "[ 7qubitprofile ] shows the simulated seven - site inversion profile , with each site corresponding to a resonant frequency of a carbon of labeled dichlorocyclobutanone , using and not using the frequency shift correction scheme .",
    "not corrected , it can be seen that the centers of the inversion profiles have shifted in frequency and the inversion is incomplete .",
    "corrected , the inversion profile is almost perfect ; there is very little leftover @xmath169 magnetization at the seven sites .",
    "this example demonstrates the application of our rules in constructing multi - frequency selective excitation pulse , which can be used for multiple - qubit gates .",
    "[ zzzzzzz ] shows the simulated final state fidelity for @xmath39 rotational state - to - state transfer problem on the labeled dichlorocyclobutanone .",
    "the initial state is assumed to be the seven - correlated spin operator @xmath170 , and the set of target @xmath39 operations is @xmath171 which contains in total 127 elements .",
    "the state fidelity formula used for the simulation reads @xmath172/2 ^ 7 .",
    "\\label{statef}\\ ] ] it can be readily seen from the figure that : ( i ) with only zeroth order correction , as the number of qubits being excited increases the fidelity decreases drastically and accordingly becomes more and more unacceptable ; ( ii ) after first - order correction the fidelity is improved to the level of 0.98 .",
    "this example demonstrates the application of our rules to perform multiple - qubit rotations .",
    "now we present an example of compiling a selective pulse network on the three - qubit sample iodotrifluroethylene .",
    "the network is intended to implement the @xmath173-dimensional quantum fourier transform @xmath174 , which is defined according to @xmath175 one of its circuit realizations , in terms of binary representation , is given as below @xcite    in 3,4,5 ( 0 , )  ( 6 , ) ; at ( -0.5,5 ) @xmath149 ; at ( -0.5,4 ) @xmath150 ; at ( -0.5,3 ) @xmath151 ; at ( 6.5,5 ) @xmath158 ; at ( 6.5,4 ) @xmath159 ; at ( 6.5,3 ) @xmath160 ;    ( 0.5 - 0.3,5 - 0.3 ) rectangle ( 0.5 + 0.3,5 + 0.3 ) ; at ( 0.5,5 ) @xmath176 ; ( 1.5 - 0.3,5 - 0.3 ) rectangle ( 1.5 + 0.3,5 + 0.3 ) ; at ( 1.5,5 ) @xmath177 ; ( 1.5,4 ) circle [ radius=0.05 ] ; ( 1.5,4 ) to ( 1.5,5 - 0.3 ) ; ( 2.5 - 0.3,5 - 0.3 ) rectangle ( 2.5 + 0.3,5 + 0.3 ) ; at ( 2.5,5 ) @xmath38 ; ( 2.5,3 ) circle [ radius=0.05 ] ; ( 2.5,3 ) to ( 2.5,5 - 0.3 ) ; ( 3.5 - 0.3,4 - 0.3 ) rectangle ( 3.5 + 0.3,4 + 0.3 ) ; at ( 3.5,4 ) @xmath176 ; ( 4.5 - 0.3,4 - 0.3 ) rectangle ( 4.5 + 0.3,4 + 0.3 ) ; at ( 4.5,4 ) @xmath177 ; ( 4.5,3 ) circle [ radius=0.05 ] ; ( 4.5,3 ) to ( 4.5,4 - 0.3 ) ; ( 5.5 - 0.3,3 - 0.3 ) rectangle ( 5.5 + 0.3,3 + 0.3 ) ; at ( 5.5,3 ) @xmath176 ;    where @xmath176 , @xmath177 and @xmath38 are hadamard gate , phase gate and @xmath178 gate respectively .",
    "first , we convert the above circuit into the same form as eq .",
    "( [ cideal ] ) .",
    "as @xmath9 rotations do not require real physical pulses , we convert as many transverse rotations as possible into them .",
    "[ qft ] shows the resulting circuit .",
    "this ideal circuit exclusive of the final @xmath9 rotations can be written as @xmath179 with @xmath180 , note that all these operations are separated in time .",
    "let @xmath181 denote the corresponding operation to the truncated circuit from the start to time @xmath42 , that is , @xmath182 thus , @xmath183 equals to the fourier transform @xmath174 , up to @xmath9 rotations and permutation of basis .",
    "now we replace the ideal rotational operations in the circuit by selective pulses .",
    "not surprisingly the imperfections soon accumulate , causing severe reduction of control accuracy . with application of the compilation method",
    "as described in the previous section , there is , the evolution generated by the pulse network up to time @xmath42 : @xmath184 , where @xmath185 represents post @xmath9 errors . as @xmath185 is irrelevant , we just compare @xmath186 with @xmath181 .",
    "[ qftdata ] gives the results , from which we find that the error rate is greatly decreased as expected .",
    "the compilation procedure is quite efficient that it finishes within just seconds . from the data ,",
    "the transform produced by the compiled pulse sequence is of fidelity about 0.9735 compared with @xmath174 ignoring observation phase adjustment . although finding a pulse of almost perfect fidelity for @xmath174 can be easily done through optimal searching , what we demonstrate here is a scalable way of doing quantum computation with taking selective pulse as building elements for the control .    ) . (",
    "a ) the calibrated pulse length of the selective pulse used for implementing the @xmath43-th operation @xmath187 .",
    "( b ) the calculated fidelity between @xmath186 and @xmath181 . ]",
    "we have developed an effective and simple scheme to adjust the pulses in a selective pulse network to improve quantum control .",
    "computing the corrections for each pulse shape is straightforward and no optimization is involved thus the compilation procedure is quite efficient .",
    "the framework developed in this paper is in several aspects different from ref .",
    "@xcite , among which most distinctly : ( i ) an ideal circuit is given in advance , based on which our pulse network compilation is done , i.e. , we do not use an optimization programme ( sequence compiler ) to adjust the time delays between the selective pulses .",
    "therefore it gains simplicity of compilation procedure at the cost of lowering the control accuracy ; ( ii ) we have taken into account multiple - qubit operations , which requires us to make analysis of the first order average hamiltonian .",
    "we have confirmed , with a series of numerical tests , that our method can be applied to increase control fidelity .",
    "the control techniques developed here could be easily incorporated into existing pulse design schemes .",
    "we expect them to be applied to larger molecules and be extended to other experimental systems .",
    "jun li completed part of this study while visiting the institute for quantum computing at the university of waterloo and acknowledges for what he has learned from the pulse design methods and programmes developed in raymond laflamme s research group .",
    "this work is supported by the national basic research program of china ( 973 program , grant no .",
    "2014cb921403 ) , the national key research and development program ( grant no .",
    "2016yfa0301201 ) , the foundation for innovative research groups of the national natural science foundation of china ( grant no .",
    "11421063 ) , the major program of the national natural science foundation of china ( grant no .",
    "11534002 ) , the state key development program for basic research of china ( grant nos . 2014cb848700 and 2013cb921800 ) , the national science fund for",
    "distinguished young scholars ( grant no .",
    "11425523 ) , and the national natural science foundation of china ( grant no .",
    "11375167 ) .",
    "the first order averaged hamiltonian has the following expression @xmath188 i^{k_2}_{\\omega'_{j_2 } m_2\\tau -\\omega_{k_2 } t_2 + \\varphi'_{j_2 } } } ,    \\sum\\limits_{k_1=1}^n \\sum\\limits_{j_1=1}^n { \\theta'_{j_1 } { g}_{j_1 } [ m_1 ] i^{k_1}_{\\omega'_{j_1 } m_1\\tau - \\omega_{k_1 } t_1 + \\varphi'_{j_1 } } }   \\right ] dt_1 dt_2 \\right ]   \\nonumber \\\\ = { } & \\frac{1}{2 t }    \\sum\\limits_{k=1}^n \\sum\\limits_{j_2=1}^n \\sum\\limits_{j_1=1}^n   \\left ( \\sum\\limits_{m_2=1}^m \\sum\\limits_{m_1=1}^{m_2 }   \\int_{(m_2 - 1)\\tau}^{m_2\\tau }   \\int_{(m_1 - 1)\\tau}^{m_1\\tau } - \\sum\\limits_{m_2=1}^m \\sum\\limits_{m_1=m_2 }   \\int_{(m_2 - 1)\\tau}^{m_2\\tau }   \\int_{t_2}^{m_1 \\tau } \\right ) \\nonumber \\\\ { } &    \\left [ \\theta'_{j_2}\\theta'_{j_1 } { g}_{j_2 } [ m_2 ] { g}_{j_1 } [ m_1 ]   \\sin \\left((\\omega'_{j_1 } m_1 - \\omega'_{j_2 } m_2)\\tau - \\omega_{k } ( t_1 -   t_2 ) + \\varphi'_{j_1 } - \\varphi'_{j_2 } \\right ) i^{k}_z   dt_1 dt_2   \\right ] \\nonumber\\end{aligned}\\ ] ] there is @xmath189 { g}_{j_1 } [ m_1 ] \\tau^2 \\frac{\\sin^2(\\omega_k\\tau/2)}{(\\omega_k \\tau/2)^2 }   \\sin \\left (   ( \\omega'_{j_1 } - \\omega_{k } ) m_1\\tau -(\\omega'_{j_2 } - \\omega_{k } ) m_2\\tau + \\varphi'_{j_1 } - \\varphi'_{j_2 } \\right )    i^k_z   \\right ]    \\nonumber \\\\ { } & - \\frac{1}{2 t }    \\sum\\limits_{k=1}^n \\sum\\limits_{j_2=1}^n \\sum\\limits_{j_1=1}^n   \\sum\\limits_{m=1}^m \\left [ \\theta'_{j_2}\\theta'_{j_1 } { g}_{j_2 } [ m ] { g}_{j_1 } [ m ]   \\frac{\\tau}{\\omega_k }   \\right.\\nonumber \\\\ { } & \\left .",
    "\\left ( \\frac{\\sin(\\omega_k\\tau/2)}{\\omega_k \\tau/2 } \\cos ( ( \\omega'_{j_2 } - \\omega'_{j_1 } ) m\\tau - \\omega_k \\tau/2 + \\varphi'_{j_1 } - \\varphi'_{j_2 } )   - \\cos ( ( \\omega'_{j_2 } - \\omega'_{j_1 } ) m\\tau + \\varphi'_{j_1 } - \\varphi'_{j_2 } )   \\right ) i^k_z \\right ] \\label{bsshift}\\end{aligned}\\ ] ] here , again we would retain only those terms for which @xmath190 @xmath191 \\tau^2   \\frac{\\sin^2(\\omega_k\\tau/2)}{(\\omega_k \\tau/2)^2 } \\left (   \\sum\\limits_{m_1=1}^{m_2 } { { g}_{j } [ m_1 ]   \\sin \\left((\\omega'_{j } - \\omega_{k } ) ( m_1-m_2)\\tau \\right ) } \\right )   i^k_z   \\right ] }   \\nonumber   \\\\ { } &",
    "- \\frac{1}{2 t }    \\sum\\limits_{k=1}^n \\sum\\limits_{j=1}^n    \\sum\\limits_{m=1}^m \\left [ { \\theta'_{j}}^2 { g}_j[m]^2 \\frac{\\tau}{\\omega_k } \\left(\\frac{\\sin(\\omega_k\\tau)}{\\omega_k \\tau } - 1 \\right ) i^k_z \\right].\\end{aligned}\\ ] ] the latter summation is negligible .",
    "we divide @xmath114 into two parts : @xmath192 for @xmath193 and @xmath194 for @xmath195 . for @xmath193 : @xmath196    { { g}_{k } [ m_1 ]   \\sin \\left(\\delta \\omega_{k } ( m_1-m_2)\\tau \\right ) }   } \\right ) i^k_z } \\nonumber \\\\ \\approx { } &   \\frac{1}{2 t } \\sum\\limits_{k=1}^n { \\left(\\delta \\omega_{k } { \\theta'_{k}}^2 \\tau^3 \\frac{\\sin^2(\\omega_k\\tau/2)}{(\\omega_k \\tau/2)^2 } \\sum\\limits_{m_2=1}^m \\sum\\limits_{m_1=1}^{m_2 } {   { g}_{k } [ m_2 ]    { { g}_{k } [ m_1 ]    ( m_1-m_2 ) } } \\right ) i^k_z } \\nonumber   \\\\ = { } &    \\sum\\limits_{k=1}^n { \\eta_k \\delta \\omega_{k } i^k_z } .",
    "\\label{h111}\\end{aligned}\\ ] ]        this is readily established , using integration by parts iteratively .",
    "therefore we have @xmath199 as our expression is a summation rather than an integral , we thus uses the analogue formula , that is , summation by parts ( known as the abel s lemma ) .    in @xcite , approximate expression for the transient bloch - siegert shifts were given .",
    "following their approaches , we made a derivation for the general case at the appendix , the result is @xmath200 it can be readily verified that in the case of rectangle wave irradiation , it reduces to the normal bloch - siegert shift .",
    "the estimation proceeds as follows @xmath201   \\sin \\left((\\omega'_{j } - \\omega'_{k } ) ( m_1-m_2)\\tau    \\right ) } \\nonumber \\\\ \\approx { } & \\left . \\left\\ { { g}_{j } [ m_1 ] \\frac{- \\cos \\left((\\omega'_{j } - \\omega'_{k } ) ( m_1-m_2 ) \\tau",
    "\\right)}{(\\omega'_{j } - \\omega'_{k})\\tau } \\right\\}\\right\\vert_{m_1=1}^{m_2 }    \\nonumber \\\\ \\approx { } & \\frac { { g}_{j } [ m_2 ] } { ( \\omega'_{j } - \\omega'_{k})\\tau } ( -1 + \\cos \\left((\\omega'_{j } - \\omega'_{k } ) ( 1-m_2 ) \\tau   \\right ) ) .",
    "\\nonumber\\end{aligned}\\ ] ] substitute the above equation into @xmath194 and omitting the fast oscillating sum , we finally get @xmath202 where we have defined @xmath203 \\tau}. \\label{e}\\ ] ]        l. m. k. vandersypen , m. steffen , g. breyta , c. s. yannoni , m. h. sherwood , and i. l. chuang , _ experimental realization of shor s quantum factoring algorithm using nuclear magnetic resonance _ , nature ( london)*414 * , 883 ( 2001 ) .",
    "n. khaneja , t. reiss , c. kehlet , t. schulte - herbrggen , s. j. glaser , _ optimal control of coupled spin dynamics : design of nmr pulse sequences by gradient ascent algorithms _",
    ", j. magn .",
    "reson . * 172 * , 296 ( 2005 ) .            c. negrevergne ,",
    "t. s. mahesh , c. a. ryan , m. ditty , f. cyr - racine , w. power , n. boulant , t. havel , d. g. cory , and r. laflamme , _ benchmarking quantum control methods on a 12-qubit system _ , phys .",
    "lett . * 96 * , 170501 ( 2006 ) .",
    "w. zheng , y. yu , j. pan , j. zhang , j. li , z. li , d. suter , x. zhou , x. peng , and j. du , _ hybrid magic state distillation for universal fault - tolerant quantum computation _ ,",
    "rev . a * 91 * , 022314 ( 2015 ) .",
    "d. lu , h. li , d. trottier , j. li , a. brodutch , a. p. krismanich , a. ghavami , g. i. dmitrienko , g. long , j. baugh , and r. laflamme , _ experimental estimation of average fidelity of a clifford gate on a 7-qubit quantum processor _ ,",
    "lett . * 114 * , 140505 ( 2015 ) .",
    "s. zhang and d. g. gorenstein , _ bloch - siegert shift compensated and cyclic irradiation sidebands eliminated , double - adiabatic homonuclear decoupling for @xmath141c- and @xmath205n - double - labeled proteins _ , j. magn .",
    "* 132 * , 81 ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> in creating a large - scale quantum information processor , the ability to construct control pulses for implementing an arbitrary quantum circuit in a scalable manner is an important requirement . for liquid - state nuclear magnetic resonance ( nmr ) quantum computing </S>",
    "<S> , a circuit is generally realized through a sequence of selective soft pulses , in which various control imperfections exist and are to be corrected . in this work , </S>",
    "<S> we present a comprehensive analysis of the errors arisen in a selective pulse network by using the zeroth and first order average hamiltonian theory . </S>",
    "<S> effective correction rules are derived for adjusting important pulse parameters such as irradiation frequencies , rotational angles and transmission phases of the selective pulses to increase the control fidelity . </S>",
    "<S> simulations show that applying our compilation procedure for a given circuit is efficient and can greatly reduce the error accumulation . </S>"
  ]
}