{
  "article_text": [
    "a striking link between rooted trees and vector fields on an affine space @xmath0 has been established by a. cayley @xcite as early as 1857 . the interest for this correspondence has been renewed since j. butcher showed the key role of rooted trees for understanding runge - kutta methods in numerical approximation @xcite .",
    "the modern approach to this correspondence can be summarized as follows : the product on vector fields on @xmath0 defined by : @xmath1 is left pre - lie , which means that for any vector fields @xmath2 the associator @xmath3 is symmetric with respect to @xmath4 and @xmath5 . on the other hand ,",
    "the free pre - lie algebra with one generator ( on some base field @xmath6 ) is the vector space @xmath7 spanned by the planar rooted trees @xcite .",
    "the generator is the one - vertex tree @xmath8 , and the pre - lie product on rooted trees is given by grafting : @xmath9 where @xmath10 is the rooted tree obtained by grafting the rooted tree @xmath11 on the vertex @xmath12 of the tree @xmath13 .",
    "hence for any vector field @xmath4 on @xmath0 there exists a unique pre - lie algebra morphism @xmath14 from @xmath7 to vector fields such that @xmath15 .",
    "this can be generalized to an arbitrary number of generators , since the free pre - lie algebra on a set @xmath16 of generators is the span of rooted trees with vertices coloured by @xmath16 . in this case , for any collection @xmath17 of vector fields , there exists a unique pre - lie algebra morphism @xmath18 from the linear span @xmath19 of coloured trees to vector fields on @xmath0 , such that @xmath20 for any @xmath21 .",
    "+ the vector fields @xmath22 ( or @xmath23 in the coloured case ) are the _ elementary differentials _ , building blocks of the b - series @xcite which are defined as follows : for any linear form @xmath24 on @xmath25 where @xmath26 is the empty tree , for any collection of vector fields @xmath27 and for any initial point @xmath28 , the corresponding b - series is a formal series in the indeterminate @xmath29 given by : @xmath30 here @xmath31 is the number of vertices of @xmath13 , and @xmath32 is its symmetry factor , i.e. the cardinal of its automorphism group @xmath33 . for any vector field @xmath4 , the exact solution of the differential equation : @xmath34 with initial condition @xmath35 admits a ( one - coloured ) b - series expansion at time @xmath36 , and its approximation by any runge - kutta method as well @xcite .",
    "the formal transformation @xmath37 is a formal series with coefficients in @xmath38 . + we will be interested in _ canonical b - series _",
    "@xcite , i.e. such that the formal transformation @xmath39 is a symplectomorphism for any collection of hamiltonian vector fields @xmath27 . here",
    ", the dimension @xmath40 is even , and @xmath41 is endowed with the standard symplectic structure : @xmath42 and a vector field @xmath43 is hamiltonian if there exists a smooth map @xmath44 such that : @xmath45 recall that the poisson bracket of two smooth maps @xmath46 on @xmath41 is given by : @xmath47 hence hamiltonian vector fields are those vector fields @xmath4 which can be expressed as : @xmath48 for some @xmath49 .",
    "a b - series turns out to be canonical if and only if the following condition holds for any rooted trees @xmath11 and @xmath13 ( * ? ? ?",
    "* theorem 2 ) : @xmath50 where @xmath51 is the right butcher product , defined by grafting the tree @xmath13 on the root of the tree @xmath11 .",
    "this result is also valid in the coloured case .",
    "the infinitesimal counterpart of this result expresses as follows ( @xcite , theorem ix.9.10 for one - colour case ) : a b - series @xmath39 with @xmath52 defines a hamiltonian vector field for any hamiltonian vector field @xmath4 if and only if : @xmath53 let us call the b - series of the type described above _ hamiltonian b - series_. our interest in non - rooted trees comes from the following elementary observation : the two rooted trees @xmath51 and @xmath54 are equal as non - rooted trees , and one is obtained from the other by shifting the root to a neighbouring vertex . as an easy consequence of , any hamiltonian b - series @xmath39 has to satisfy that if two rooted trees @xmath11 and @xmath13 are equal as non - rooted trees , then : @xmath55 this implies that , modulo a careful account of the signs involved , hamiltonian b - series are naturally indexed by non - rooted trees rather than by rooted ones .",
    "the sign is plus or minus according to the parity of the minimal number of  root shifts \" @xmath56 that are required to change @xmath11 into @xmath13 .",
    "+ in the present paper we address the following question : _ what survives from the pre - lie structure at the level of non - rooted trees ? _",
    "there is a natural linear map @xmath57 from non - rooted trees to ( the linear span of ) rooted trees , sending a tree to the sum of all its rooted representatives , with alternating signs .",
    "its precise definition involves a total order on rooted trees introduced by a. murua @xcite .",
    "we propose a binary product @xmath58 on the linear span of non - rooted trees , which is roughly speaking an alternating sum of all trees obtained by linking a vertex of the first tree with a vertex of the second tree .",
    "theorem [ main ] is the key result of the paper .",
    "it implies the fact that @xmath58 is a lie bracket and that @xmath57 is a lie algebra morphism , the lie bracket on rooted trees being given by antisymmetrizing the pre - lie product . +",
    "* acknowledgements :* this article came out from a workshop in december 2012 at ntnu in trondheim .",
    "the authors thank elena celledoni , kurusch ebrahimi - fard , brynjulf owren and all the participants for illuminating discussions .",
    "the third author also thanks ander murua and jesus sanz - serna for sharing references and for their encouragements .",
    "this work is partly supported by campus france , phc aurora 24678zc .",
    "the third author also acknowledges a support by agence nationale de la recherche ( projet carma ) .",
    "we denote by @xmath59 ( resp .",
    "@xmath60 ) the set of non - planar rooted ( resp .",
    "non - rooted ) trees .",
    "we denote by @xmath7 ( resp .",
    "@xmath61 ) the vector spaces freely generated by @xmath59 ( resp .",
    "@xmath60 ) .",
    "the projection @xmath62 is defined by forgetting the root .",
    "it extends linearly to @xmath63 .",
    "rooted trees will be denoted by latin letters @xmath64 , non - rooted trees by greek letters @xmath65 .",
    "we will also use `` free tree '' as a synonymous for `` non - rooted tree '' . for any free tree @xmath66 and for any vertex @xmath12 of @xmath66 , we denote by @xmath67 the unique rooted tree built from @xmath66 by putting the root at @xmath12 .",
    "recall that any rooted tree @xmath13 is obtained by grafting rooted trees @xmath68 on a common root : @xmath69 the trees @xmath70 are called the _ branches _ of @xmath13 .",
    "a. murua defines in @xcite a total order on the set of ( one - colour ) rooted trees in a recursive way as follows : the _ canonical decomposition _ of a tree @xmath13 is given by @xmath71 where @xmath72 is the maximal branch of @xmath13 .",
    "the maximality is to be understood with respect to the total order , supposed to be already defined for trees with number of vertices strictly smaller than @xmath31 .",
    "then @xmath73 if and only if :    * either @xmath74 , * or @xmath75 and @xmath76 , * or @xmath75 , @xmath77 and @xmath78 .    in the one - colour case ,",
    "the total order of the first few trees is : @xmath79 if we prescribe a total order on the set of colours @xmath16 and allow the set of one node coloured trees to inherit this order , incorporating this into the definition above gives a total order on the set of coloured rooted trees .",
    "note that the structure of the one - colour order is not entirely preserved , as , for example , for two colours @xmath80 we have @xmath81 whereas @xmath82 .",
    "+      this notion has been introduced in @xcite , where the authors describe order conditions for canonical b - series coming from runge - kutta approximation methods .",
    "let @xmath39 be a hamiltonian b - series .",
    "according to , we have @xmath83 for any rooted tree @xmath13 .",
    "any non - rooted tree @xmath66 such that there exists a rooted tree @xmath11 with @xmath84 is called a _ superfluous tree _ , and a rooted tree @xmath13 is said to be superfluous if its underlying free tree @xmath85 is . such trees never appear in a hamiltonian b - series . for any free tree @xmath86 ,",
    "its _ canonical representative _ is the maximal element of the set @xmath87 for the total order above .",
    "the following lemma gives a characterization of superfluous trees :    [ lem : superfluous ] let @xmath86 have two distinct vertices @xmath12 and @xmath88 such that @xmath89 is the canonical representative of @xmath66 . then :    1 .   @xmath12 and @xmath88 are the two ends of a common edge in @xmath66 , 2",
    ".   there exists @xmath90 such that @xmath91 .",
    "first of all , the maximal branch of @xmath67 contains @xmath88 ( and vice - versa ) . indeed , suppose the maximal branch of @xmath67 does not contain @xmath88 ( and hence vice - versa ) .",
    "let @xmath92 where @xmath93 is the branch of @xmath67 containing @xmath88 and @xmath94 similarly .",
    "it is clear that @xmath94 contains all branches of @xmath67 except @xmath93 .",
    "hence @xmath95 and as @xmath96 we have @xmath97 , a contradiction .",
    "now suppose that @xmath12 and @xmath88 are not neighbours , and choose a vertex @xmath98 between @xmath12 and @xmath88 , i.e. such that there is a path from @xmath12 to @xmath88 of meeting @xmath98 .",
    "the maximal branch of @xmath99 can not contain both @xmath12 and @xmath88 ; suppose it does not contain @xmath12",
    ". then it is a subtree of the maximal branch @xmath67 and hence contains strictly less vertices .",
    "looking at the canonical decompositions : @xmath100 we have then @xmath101 , which immediately yields @xmath102 , which is a contradiction .",
    "this proves the first assertion , and the second assertion follows immediately .",
    "there are four superfluous free trees with six vertices or less .",
    "the corresponding superfluous rooted trees are : @xmath103 we denote by @xmath104 the set of superfluous free trees and by @xmath105 the set of non - superfluous trees , hence @xmath106 .",
    "the corresponding linear spans will be denoted by @xmath107 and @xmath108 .",
    "we have @xmath109 , which leads to a linear isomorphism : @xmath110      we keep the notations of the previous subsection . for any non - superfluous tree @xmath111",
    "we denote by @xmath112 the unique vertex such that @xmath113 is the canonical representative of @xmath66 .",
    "the group of automorphisms of @xmath66 is the subgroup @xmath114 of the group of permutations @xmath115 of @xmath116 which respect the tree structure , i.e. such that , for any @xmath117 , there is an edge between @xmath12 and @xmath88 if and only if there is an edge between @xmath118 and @xmath119 .",
    "+ for any rooted tree",
    "@xmath13 we also denote by @xmath33 its group of automorphisms , i.e. the subgroup of the group of permutations @xmath115 of @xmath120 which respect the rooted tree structure .",
    "it obviously coincides with the stabilizer of the root in @xmath121 .",
    "now for any non - superfluous free tree @xmath66 it is obvious from lemma [ lem : superfluous ] that @xmath114 fixes the vertex @xmath112 , hence @xmath122 .",
    "+ now @xmath114 acts on the set of vertices @xmath116 .",
    "moreover , for any vertex @xmath12 this group acts transitively on the subset of possible roots for @xmath67 , namely : @xmath123 hence @xmath124 identifies itself with the homogeneous space : @xmath125 this immediately leads to the following proposition , which is implicit in the proof of lemma ix.9.7 in @xcite :    [ prop : sym ] let @xmath66 be a non - superfluous free tree , let @xmath13 be a rooted tree such that @xmath126 , and let @xmath127 be the number of vertices @xmath128 such that @xmath129 .",
    "then : @xmath130      let @xmath131 and @xmath66 be two non - rooted trees , and let us choose a vertex @xmath12 of @xmath131 and a vertex @xmath88 of @xmath66 .",
    "we will denote by @xmath132 the non - rooted tree obtained by taking @xmath131 and @xmath66 together and adding a new edge between @xmath12 and @xmath88 .",
    "this linking operation is related to grafting of rooted trees as follows : for any other choice of vertices @xmath98 of @xmath131 and @xmath133 of @xmath66 we have : @xmath134",
    "the linear map @xmath135 is defined for any non - rooted tree @xmath66 by : @xmath136 and extended linearly . here",
    "@xmath137 is equal to @xmath138 if @xmath66 is superfluous , and is equal to @xmath139 ( resp .",
    "@xmath140 ) if @xmath66 is not superfluous and if the number of requested root shifts to change @xmath67 into the canonical representative of @xmath66 is even ( resp .",
    "this number , which we denote by @xmath141 , is indeed unambiguous for non - superfluous trees according to lemma [ lem : superfluous ] .",
    "we obviously have : @xmath142 for any @xmath143 .",
    "the introduction of the map @xmath57 is justified by the fact that , according to , and proposition [ prop : sym ] , rooted trees involved in hamiltonian b - series do group themselves under terms @xmath144 with @xmath86 .",
    "indeed ,    @xmath145    now let us define a binary product on @xmath61 by the formula : @xmath146 with @xmath147 .",
    "[ main ] we have @xmath148 for any @xmath149 , and @xmath150 if @xmath131 or @xmath66 is superfluous .",
    "the product @xmath58 is antisymmetric , and the following relation holds : @xmath151.\\ ] ]    a computation of the left - hand side gives : @xmath152 and computing the right - hand side gives : @xmath153=&-&\\sum_{v , x\\in\\cal v(\\sigma),\\,w\\in\\cal v(\\tau ) }      \\varepsilon(v,\\sigma)\\varepsilon(w,\\tau)\\tau_w\\to_x\\sigma_v\\\\      & + & \\sum_{v\\in\\cal v(\\sigma),\\,w , y\\in\\cal v(\\tau ) }      \\varepsilon(v,\\sigma)\\varepsilon(w,\\tau)\\sigma_v\\to_y\\tau_w.\\end{aligned}\\ ] ] exchanging @xmath98 and @xmath12 in the first sum , and @xmath133 and @xmath88 in the second , we get : @xmath153=&-&\\sum_{v , x\\in\\cal v(\\sigma),\\,w\\in\\cal v(\\tau ) }      \\varepsilon(x,\\sigma)\\varepsilon(w,\\tau)\\tau_w\\to_v\\sigma_x\\\\      & + & \\sum_{v\\in\\cal v(\\sigma),\\,w , y\\in\\cal v(\\tau ) }      \\varepsilon(v,\\sigma)\\varepsilon(y,\\tau)\\sigma_v\\to_w\\tau_y.\\end{aligned}\\ ] ] the first assertion is immediate since @xmath154 vanishes if @xmath155 is superfluous .",
    "the second assertion is also immediate , since @xmath156 vanishes if @xmath131 or @xmath66 is superfluous .",
    "the antisymmetry comes from the fact that @xmath12 and @xmath88 are neighbours in @xmath132 .",
    "+    1 .   if @xmath131 or @xmath66 is superfluous , any individual term in both sides vanishes .",
    "if @xmath131 and @xmath66 are not superfluous it may happen that @xmath157 is superfluous for some @xmath158 and @xmath159 .",
    "the corresponding term @xmath160 in @xmath161 vanishes . on the other hand ,",
    "the sum of all terms in @xmath162 $ ] corresponding to the couple @xmath163 chosen above writes down as : @xmath164 the distance @xmath165 between @xmath98 and @xmath12 in @xmath131 is defined as the length of the ( unique ) path joining @xmath98 and @xmath12 in @xmath131 .",
    "it is clearly equal modulo @xmath166 to the sum @xmath167 .",
    "similarly , @xmath168 modulo @xmath166 . hence , using and we get : @xmath169 now the distance @xmath165 is the same if we compute it in @xmath131 or in @xmath155 , and similarly for @xmath170",
    ". finally , using the fact that @xmath12 and @xmath88 are neighbours in @xmath155 , we have @xmath171 for any @xmath172 , the distance being computed in @xmath155 .",
    "this finally gives : @xmath173 which vanishes since @xmath155 is superfluous .",
    "3 .   finally ,",
    "if @xmath131 , @xmath66 and @xmath155 are not superfluous , using and , both sides will be equal if we have : @xmath174 using the fact that @xmath12 and @xmath88 are neighbours , it rewrites as : @xmath175 these two last identities are always verified : looking for example at the right - hand side of the first one , moving vertex @xmath12 to a neighbour will change both @xmath176 s by @xmath177 .",
    "it remains then to jump from neighbour to neighbour up to @xmath98 .",
    "the proof of the second identity is completely similar .",
    "using the identification of @xmath178 with @xmath108 , a straightforward consequence of theorem [ main ] is the following :    the linear map @xmath57 is an injection of @xmath108 into @xmath7 , and the product @xmath179 verifies : @xmath180.\\ ] ]    as a consequence , the product @xmath58 satisfies the jacobi identity , and @xmath57 is an embedding of lie algebras .",
    "keeping the previous notations , the vector field @xmath181 is hamiltonian for any ( decorated ) non - rooted tree @xmath66 .",
    "hence it can be uniquely written as @xmath182 for some @xmath183 , called the _ elementary hamiltonian _ associated with @xmath66 .",
    "we compute : @xmath186\\\\ & = & \\left[\\cal f_{\\underline a}\\big(\\wt x(\\sigma)\\big),\\,\\cal f_{\\underline a}\\big(\\wt x(\\tau)\\right]\\\\ & = & \\cal f_{\\underline a}\\left([\\wt x(\\sigma),\\,\\wt x(\\tau)]\\right)\\\\ & = & \\cal f_{\\underline a}\\circ\\wt x(\\sigma\\diamond\\tau)\\\\ & = & \\{h_{\\underline a}(\\sigma\\diamond\\tau),-\\}.\\end{aligned}\\ ] ] one concludes by using the uniqueness of the hamiltonian representation of a hamiltonian vector field .",
    "e.  hairer , c.  lubich , g.  wanner , _ geometric numerical integration _",
    "structure - preserving algorithms for ordinary differential equations , vol . * 31 * , springer series in computational mathematics .",
    "springer - verlag , berlin , 2002 ."
  ],
  "abstract_text": [
    "<S> we explore the relationship between ( non - planar ) rooted trees and free trees , i.e. without root . </S>",
    "<S> we give in particular , for non - rooted trees , a substitute for the lie bracket given by the antisymmetrization of the pre - lie product .    </S>",
    "<S> * keywords * : rooted trees ; b - series ; trees ; hamiltonian vector fields .    * math . </S>",
    "<S> subject classification * : 16w30 ; 05c05 ; 16w25 ; 17d25 ; 37c10    = cmr8 = cmr7 = cmr5 </S>"
  ]
}