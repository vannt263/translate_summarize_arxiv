{
  "article_text": [
    "invariants are a popular concept in object recognition and image retrieval  @xcite .",
    "they aim to provide descriptions that remain constant under certain geometric or radiometric transformations of the scene , thereby reducing the search space .",
    "they can be classified into global invariants , typically based either on a set of key points or on moments , and local invariants , typically based on derivatives of the image function which is assumed to be continuous and differentiable .",
    "the geometric transformations of interest often include translation , rotation , and scaling , summarily referred to as _ similarity _ transformations . in a previous paper  @xcite , building on work done by schmid and mohr  @xcite , we have proposed differential invariants for those similarity transformations , plus _ linear _ brightness change . here",
    ", we are looking at a _ non - linear _ brightness change known as _ gamma correction_.    gamma correction is a non - linear quantization of the brightness measurements performed by many cameras during the image formation process .",
    "the idea is to achieve better _ perceptual _ results by maintaining an approximately constant ratio between adjacent brightness levels , placing the quantization levels apart by the _ just noticeable difference_. incidentally , this non - linear quantization also precompensates for the non - linear mapping from voltage to brightness in electronic display devices  @xcite .",
    "gamma correction can be expressed by the equation @xmath0 where @xmath1 is the input intensity , @xmath2 is the output intensity , and @xmath3 is a normalization factor which is determined by the value of @xmath4 . for output devices , the ntsc standard specifies @xmath5 . for input devices like cameras ,",
    "the parameter value is just inversed , resulting in a typical value of @xmath6 .",
    "the camera we used , the sony 3 ccd color camera dxc  950 , exhibited @xmath7 . for the kodak megaplus xrc camera ]",
    "[ fig : gammacorr ] shows the intensity mapping of 8-bit data for different values of @xmath4 .",
    "it turns out that an invariant under gamma correction can be designed from first and second order derivatives .",
    "additional invariance under scaling requires third order derivatives .",
    "derivatives are by nature translationally invariant .",
    "rotational invariance in 2-d is achieved by using rotationally symmetric operators .",
    "the key idea for the design of the proposed invariants is to form suitable ratios of the derivatives of the image function such that the parameters describing the transformation of interest will cancel out .",
    "this idea has been used in  @xcite to achieve invariance under linear brightness changes , and it can be adjusted to the context of gamma correction by  at least conceptually  considering the _ logarithm _ of the image function . for simplicity , we begin with 1-d image functions .",
    "let @xmath8 be the image function , i.e.  the original signal , assumed to be continuous and differentiable , and @xmath9 the corresponding gamma corrected function .",
    "note that @xmath8 is a special case of @xmath10 where @xmath11 .",
    "taking the logarithm yields @xmath12 with the derivatives @xmath13 , and @xmath14 .",
    "we can now define the invariant @xmath15 under gamma correction to be @xmath16{0mm}{13 mm }          & = $ \\frac{\\gamma\\ , \\frac{f'(x)}{f(x ) } }                  { \\gamma\\ , \\frac{f(x)\\,f''(x ) - f'(x)^2}{f(x)^2}}$ \\\\          & = $ \\frac{f(x)\\,f'(x)}{f(x)\\,f''(x ) - f'(x)^2}$   \\end{tabular}\\ ] ] the factor @xmath3 has been eliminated by taking derivatives , and @xmath4 has canceled out .",
    "furthermore , @xmath15 turns out to be completely specified in terms of the _ original _ image function and its derivatives , i.e.  the logarithm actually does nt have to be computed .",
    "the notation @xmath17 indicates that the invariant depends on the underlying image function @xmath8 and location @xmath18  the invariance holds under gamma correction , not under spatial changes of the image function .",
    "a shortcoming of @xmath15 is that it is undefined where the denominator is zero .",
    "therefore , we modify @xmath15 to be continuous everywhere : @xmath19{0mm}{8 mm }      { \\normalsize $ \\theta_{m12\\gamma}=$ }         & $ \\frac{f\\,f'}{f\\,f '' - { f'}^2}$            & { \\normalsize if $ |f\\,f'| < |f\\,f '' - { f'}^2|$ } \\\\         & $ \\frac{f\\,f '' - { f'}^2}{f\\,f'}$            & { \\normalsize else } \\\\",
    "\\end{tabular}\\ ] ] where , for notational convenience , we have dropped the variable @xmath18 .",
    "the modification entails .",
    "note that the modification is just a heuristic to deal with poles .",
    "if all derivatives are zero because the image function is constant , then differentials are certainly not the best way to represent the function .",
    "if scaling is a transformation that has to be considered , then another parameter @xmath20 describing the change of size has to be introduced .",
    "that is , scaling is modeled here as variable substitution  @xcite : the scaled version of @xmath8 is @xmath21 .",
    "so we are looking at the function @xmath22 where the derivatives with respect to @xmath18 are @xmath23 , @xmath24 , and @xmath25 . now",
    "the invariant @xmath26 is obtained by defining a suitable ratio of the derivatives such that both @xmath4 and @xmath20 cancel out : @xmath27{0mm}{10 mm }          & = $ \\frac{g^2 g'\\,g ' '' - 3\\,g\\,{g'}^2 g '' + 2\\,{g'}^4 }                   { g^2 { g''}^2   - 2\\,g\\,{g'}^2 g '' +   \\ { g'}^4}$   \\end{tabular}\\ ] ] analogously to eq .",
    "( [ eq : thm12 g ] ) , we can define a modified invariant @xmath28{0mm}{8 mm }      { \\normalsize $ \\theta_{m123\\gamma}=$ }         & $ \\frac{g^2 g'\\,g ' '' - 3\\,g\\,{g'}^2 g '' + 2\\,{g'}^4 }                { g^2 { g''}^2   - 2\\,g\\,{g'}^2 g '' +   \\ { g'}^4}$            & { \\normalsize if cond2 } \\\\         & $ \\frac{g^2 { g''}^2   - 2\\,g\\,{g'}^2 g '' +   \\ { g'}^4 }                { g^2 g'\\,g ' '' - 3\\,g\\,{g'}^2 g '' + 2\\,{g'}^4}$            & { \\normalsize else } \\\\",
    "\\end{tabular}\\ ] ] where condition cond1 is @xmath29 @xmath30 , and condition cond2 is @xmath31 @xmath32 @xmath33 .",
    "again , this modification entails .",
    "it is a straightforward albeit cumbersome exercise to verify the invariants from eqs .",
    "( [ eq : th12 g ] ) and  ( [ eq : th123 g ] ) with an analytical , differentiable function . as an arbitrary example",
    ", we choose @xmath34 the first three derivatives are @xmath35 , @xmath36 , and @xmath37 .",
    "then , according to eq .",
    "( [ eq : th12 g ] ) , @xmath38 .",
    "if we now replace @xmath8 with a gamma corrected version , say @xmath39 , the first derivative becomes @xmath40 , the second derivative is @xmath41 , and the third is @xmath42 . if we plug these derivatives into eq .",
    "( [ eq : th12 g ] ) , we obtain an expression for @xmath43 which is identical to the one for @xmath17 above .",
    "the algebraically inclined reader is encouraged to verify the invariant @xmath44 for the same function .",
    "[ fig : analyex ] shows the example function and its gamma corrected counterpart , together with their derivatives and the two modified invariants .",
    "as expected , the graphs of the invariants are the same on the right as on the left .",
    "note that the invariants define a many - to - one mapping .",
    "that is , the mapping is not information preserving , and it is not possible to reconstruct the original image from its invariant representation .",
    "if @xmath45 or @xmath46 are to be computed on images , then eqs .  ( [ eq : th12 g ] ) to  ( [ eq : thm123 g ] ) have to be generalized to two dimensions .",
    "this is to be done in a rotationally invariant way in order to achieve invariance under similarity transformations .",
    "the standard way is to use rotationally symmetric operators .",
    "for the first derivative , we have the well known _",
    "gradient magnitude _ , defined as @xmath47 where @xmath48 is the 2-d image function , and @xmath49 , @xmath50 are partial derivatives along the x - axis and the y - axis . for the second order derivative",
    ", we can use the linear _ laplacian _",
    "@xmath51 horn  @xcite also presents an alternative second order derivative operator , the _",
    "quadratic variation _",
    "@xmath52 since the qv is not a linear operator and more expensive to compute , we use the laplacian for our implementation . for the third order derivative ,",
    "we can define , in close analogy with the quadratic variation , a _",
    "cubic variation _ as @xmath53    the invariants from eqs .",
    "( [ eq : th12 g ] ) to  ( [ eq : thm123 g ] ) remain valid in 2-d if we replace @xmath54 with @xmath55 , @xmath56 with @xmath57 , and @xmath58 with @xmath59 .",
    "this can be verified by going through the same argument as for the functions .",
    "recall that the critical observation in eq .",
    "( [ eq : th12 g ] ) was that @xmath4 cancels out , which is the case when all derivatives return a factor @xmath4 .",
    "but such is also the case with the rotationally symmetric operators mentioned above .",
    "for example , if we apply the gradient magnitude operator to @xmath60 , i.e.  to the logarithm of a gamma corrected image function , we obtain @xmath61 returning a factor @xmath4 , and analogously for @xmath62 , qv , and cv .",
    "a similar argument holds for eq .",
    "( [ eq : th123 g ] ) where we have to show , in addition , that the first derivative returns a factor @xmath20 , the second derivative returns a factor @xmath63 , and the third derivative returns a factor @xmath64 , which is the case for our 2-d operators .      while the derivatives of continuous , differentiable functions are uniquely defined , there are many ways to implement derivatives for _ sampled _ functions .",
    "we follow schmid and mohr  @xcite , ter haar romeny  @xcite , and many other researchers in employing the derivatives of the gaussian function as filters to compute the derivatives of a sampled image function via convolution .",
    "this way , derivation is combined with smoothing .",
    "the 2-d zero mean gaussian is defined as @xmath65 the partial derivatives up to third order are @xmath66 , @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 .",
    "they are shown in fig .",
    "[ fig : gausskernels ] . we used the parameter setting @xmath75 and kernel size @xmath76",
    "with these kernels , eq .",
    "( [ eq : th12 g ] ) , for example , is implemented as @xmath77 at each pixel @xmath78 , where @xmath79 denotes convolution .",
    "we evaluate the invariant @xmath45 from eq .",
    "( [ eq : thm12 g ] ) in two different ways .",
    "first , we measure how much the invariant computed on an image without gamma correction is different from the invariant computed on the same image but with gamma correction .",
    "theoretical , this difference should be zero , but in practice , it is not .",
    "second , we compare template matching accuracy on intensity images , again without and with gamma correction , to the accuracy achievable if instead the invariant representation is used .",
    "we also examine whether the results can be improved by prefiltering .",
    "a straightforward error measure is the _ absolute error _ , @xmath80 where `` 0gc '' refers to the image without gamma correction , and gc stands for either `` sgc '' if the gamma correction is done synthetically via eq .",
    "( [ eq : gammacorr ] ) , or for `` cgc '' if the gamma correction is done via the camera hardware . like the invariant itself ,",
    "the absolute error is computed at each pixel location @xmath81 of the image , except for the image boundaries where the derivatives and therefore the invariants can not be computed reliably .",
    "[ fig : imas ] shows an example image .",
    "the sgc image has been computed from the 0gc image , with @xmath82 .",
    "note that the gamma correction is done _",
    "after _ the quantization of the 0gc image , since we do nt have access to the 0gc image before quantization .",
    "[ fig : accuinv ] shows the invariant representations of the image data from fig .",
    "[ fig : imas ] and the corresponding absolute errors . since , we have .",
    "the dark points in fig .  [ fig : accuinv ] , ( c ) and  ( e ) , indicate areas of large errors .",
    "we observe two error sources :    * the invariant can not be computed robustly in homogeneous regions .",
    "this is hardly surprising , given that it is based on differentials which are by definition only sensitive to spatial changes of the signal .",
    "* there are outliers even in the sgc invariant representation , at points of very high contrast edges .",
    "they are a byproduct of the inherent smoothing when the derivatives are computed with differentials of the gaussian .",
    "note that the latter put a ceiling on the maximum gradient magnitude that is computable on 8-bit images .",
    "in addition to computing the absolute error , we can also compute the relative error , in percent , as @xmath83 then we can define the set @xmath84 of _ reliable points _ , relative to some error threshold  @xmath85 , as @xmath86 and @xmath87 , the percentage of reliable points , as @xmath88 where @xmath89 is the number of valid , i.e.  non - boundary , pixels in the image .",
    "[ fig : reliapts ] shows , in the first row , the reliable points for three different values of the threshold @xmath85 .",
    "the second row shows the sets of reliable points for the same thresholds if we gently prefilter the 0gc and cgc images . the corresponding data for the ten test images from fig .",
    "[ fig : imadb ] is summarized in table  [ tab : reliaperc ] .",
    "derivatives are known to be sensitive to noise .",
    "noise can be reduced by smoothing the original data before the invariants are computed . on the other hand , derivatives should be computed as locally as possible . with these conflicting goals to be considered , we experiment with gentle prefiltering , using a gaussian filter of size @xmath90=1.0 .",
    "the size of the gaussian to compute the invariant @xmath45 is set to @xmath91=1.0 .",
    "note that @xmath90 and @xmath91 can _ not _ be combined into just one gaussian because of the non - linearity of the invariant .",
    "with respect to the set of reliable points , we observe that after prefiltering , roughly half the points , on average , have a relative error of less than 20% .",
    "gentle prefiltering consistently reduces both absolute and relative errors , but strong prefiltering does not .",
    "template matching is a frequently employed technique in computer vision . here",
    ", we will examine how gamma correction affects the spatial accuracy of template matching , and whether that accuracy can be improved by using the invariant @xmath45 .",
    "an overview of the testbed scenario is given in fig .",
    "[ fig : templloca ] . a  small template of size @xmath92 , representing the search pattern ,",
    "is taken from a 0gc intensity image , i.e.  without gamma correction .",
    "this query template is then correlated with the corresponding cgc intensity image , i.e.  the same scene but with gamma correction switched on .",
    "if the correlation maximum occurs at exactly the location where the 0gc query template has been cut out , we call this a _ correct maximum correlation position _ , or cmcp",
    ".    the correlation function @xmath93 employed here is based on a normalized mean squared difference @xmath94  @xcite : @xmath95 where @xmath1 is an image , @xmath96 is a template positioned at @xmath78 , @xmath97 is the mean of the subimage of @xmath1 at @xmath78 of the same size as @xmath96 , @xmath98 is the mean of the template , and @xmath99 .",
    "the template location problem then is to perform this correlation for the whole image and to determine whether the position of the correlation maximum occurs precisely at @xmath78 .",
    "[ fig : matchtempl ] demonstrates the template location problem , on the left for an intensity image , and on the right for its invariant representation .",
    "the black box marks the position of the original template at ( 40,15 ) , and the white box marks the position of the matched template , which is incorrectly located at ( 50,64 ) in the intensity image . on the right , the matched template ( white )",
    "has overwritten the original template ( black ) at the same , correctly identified position .",
    "[ fig : correlexmpl ] visualizes the correlation function over the whole image .",
    "the white areas are regions of high correlation .",
    "the example from figs .",
    "[ fig : matchtempl ] and  [ fig : correlexmpl ] deals with only _ one _ arbitrarily selected template . in order to systematically analyze the template location problem , we repeat the correlation process for all possible template locations",
    ". then we can define the _ correlation accuracy _ ca as the percentage of correctly located templates , @xmath100 where @xmath101 is the size of the template , @xmath102 is the set of correct maximum correlation positions , and @xmath89 , again , is the number of valid pixels .",
    "we compute the correlation accuracy both for unfiltered images and for gently prefiltered images , with @xmath103 .",
    "[ fig : corrcorrelpts ] shows the binary correlation accuracy matrices for our example image .",
    "the cmcp set is shown in white , its complement and the boundaries in black .",
    "we observe a higher correlation accuracy for the invariant representation , which is improved by the prefiltering .",
    "we have computed the correlation accuracy for all the images given in fig .",
    "[ fig : imadb ] .",
    "the results are shown in table  [ tab : ca ] and visualized in fig .",
    "[ fig : correlaccuras ] .",
    "we observe the following :    * the correlation accuracy ca is higher on the invariant representation than on the intensity images .",
    "* the correlation accuracy is higher on the invariant representation with gentle prefiltering , @xmath103 , than without prefiltering .",
    "we also observed a decrease in correlation accuracy if we increase the prefiltering well beyond @xmath103 .",
    "by contrast , prefiltering seems to be always detrimental to the intensity images ca .",
    "* the correlation accuracy shows a wide variation , roughly in the range 30%@xmath10490% for the unfiltered intensity images and 50%@xmath104100% for prefiltered invariant representations .",
    "similarly , the gain in correlation accuracy ranges from close to zero up to 45% . for our test images",
    ", it turns out that the invariant representation is always superior , but that does nt necessarily have to be the case . * the medians and means of the cas over all test images confirm the gain in correlation accuracy for the invariant representation . * the larger the template size , the higher the correlation accuracy , independent of the representation .",
    "a larger template size means more structure , and more discriminatory power .",
    "we have proposed novel invariants that combine invariance under gamma correction with invariance under geometric transformations . in a general sense ,",
    "the invariants can be seen as trading off derivatives for a power law parameter , which makes them interesting for applications beyond image processing .",
    "the error analysis of our implementation on real images has shown that , for sampled data , the invariants can not be computed robustly everywhere .",
    "nevertheless , the template matching application scenario has demonstrated that a performance gain is achievable by using the proposed invariant .",
    "bob woodham suggested to the author to look into invariance under gamma correction .",
    "his meticulous comments on this work were much appreciated .",
    "jochen lang helped with the acquisition of image data through the acme facility  @xcite .",
    "d.  forsyth , j.  mundy , a.  zisserman , c.  coelho , c.  rothwell , `` invariant descriptors for 3-d object recognition and pose '' , _ ieee transactions on pattern analysis and machine intelligence _ , vol.13 ,",
    "no.10 , pp.971 - 991 , oct.1991 .",
    "d.  pai , j.  lang , j.  lloyd ,  r. woodham , `` acme , a telerobotic active measurement facility '' , sixth international symposium on experimental robotics , sydney , 1999 .",
    "see also : http://www.cs.ubc.ca/nest/lci/acme/"
  ],
  "abstract_text": [
    "<S> _ this paper presents invariants under gamma correction and similarity transformations . </S>",
    "<S> the invariants are local features based on differentials which are implemented using derivatives of the gaussian . </S>",
    "<S> the use of the proposed invariant representation is shown to yield improved correlation results in a template matching scenario . _ </S>"
  ]
}