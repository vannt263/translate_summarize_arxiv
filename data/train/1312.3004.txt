{
  "article_text": [
    "in recent years the goal of petaflop computing has been achieved by replying on massively parallel systems .",
    "this development requires a new approach to the efficient utilization of computing resources ; moreover , improvements in methodology in computational statistical physics have also taken place .",
    "one such improvement , known as `` wang  landau sampling '' , was described at the iiird brazilian meeting on simulational physics in 2003 . in wang ",
    "landau ( wl ) sampling , the _ a priori _ unknown density of states @xmath0 of a system is determined iteratively by performing a random walk in energy space ( @xmath1 ) and sampling configurations with probability @xmath2 ( i.e. with a `` flat histogram '' )  @xcite .",
    "this procedure has proven very powerful for studying wide ranging problems with complex free energy landscapes because it circumvents the long time scales typically encountered near phase transitions or at low temperatures .",
    "the method also facilitates the calculation of thermodynamic quantities , including the free energy , at any temperature from a _ single _ simulation .",
    "landau sampling is also a generic monte carlo procedure with only a few adjustable parameters , and it has been applied successfully to quite diverse problems including spin glasses , polymers , protein folding , lattice gauge theory , etc . , see  @xcite for examples . over the years ,",
    "the method itself was subject to multiple studies and various improvements to it have been proposed  @xcite , but the underlying simplicity remains intact .",
    "a few simple attempts at parallelization of the wl algorithm have been undertaken , but these are useful only for a relatively small number of processors ( cores ) .",
    "one early approach  @xcite was to subdivide the total energy range into smaller sub - windows , each sampled by an independent wl random walker .",
    "the total simulation time is limited by the convergence of the slowest walker , but it can be tuned somewhat by an unequal partition of energy space . nevertheless , an optimal load balancing is impossible due to the _ a priori _ unknown irregularities in the complex free energy landscape , and the individual energy intervals can not be reduced arbitrarily due to systematic errors introduced because some regions of configurational space then become inaccessible .    an alternative scheme is to have multiple random walkers work simultaneously on the _ same _ density of states ( and histogram ) .",
    "although this approach seemingly avoids some problems , a  recent , massively parallel implementation  @xcite revealed that correlations among the walkers could lead to a systematically underestimation of @xmath0 in `` difficult to access '' energy regions .",
    "a  proposed remedy to this problem was to add an `` ad hoc '' bias to the modification factor ; but such inter - dependencies are highly problematic ; besides the fact that an appropriate bias is , again , _ a priori _ unknown . it is also important to note that the effective round - trip times of the individual walkers are not improved by such an approach .",
    "our new approach  @xcite is a _",
    "generic _ parallel method which combines the advantageous dynamics of the original wang ",
    "landau sampling scheme with the idea of replica - exchange monte carlo  @xcite .",
    "we begin by splitting up the total energy range into @xmath3 smaller sub - windows with large overlap between adjacent windows .",
    "the extent of the overlap @xmath4 should be chosen to strike a balance between fast convergence of @xmath0 and a reasonable exchange acceptance rate ; an overlap of , e.g. , @xmath5 is a good choice  @xcite . see fig .",
    "[ fig:1 ] for a visualization of a  corresponding generic setup .",
    "each energy sub - window is sampled by multiple ( @xmath6 ) , _ independent _ wl walkers .",
    "the key to this approach is that configurational or replica exchanges are allowed among wl instances of overlapping energy windows during the course of the simulation . as a  consequence",
    ", each replica can travel through the entire energy space .",
    "the replica exchange move does not bias the overall wl procedure and , thus , guarantees the flexibility to apply it to any valid wl update / convergence rule ( e.g. , the @xmath7 algorithm  @xcite ) .",
    "furthermore , our hierarchical parallelization approach imposes _ no _ principal limitation to the number of wl walkers or energy ranges so that it is possible to design setups which scale up to many thousands of  cpus .",
    "example of a splitting of the global energy range into nine equal - size intervals with a constant overlap of @xmath8 .",
    "there are nine walkers in each energy interval , arrows indicate the generic replica - exchange path . ]",
    "the standard wl algorithm  @xcite estimates the density of states , @xmath0 , in an energy range @xmath9 $ ] using a single random walker . during the simulation",
    ", trial moves are accepted with a probability @xmath10 $ ] , where @xmath11 ( @xmath12 ) is the energy of the original ( proposed ) configuration . the estimation of @xmath0 is continuously adjusted and improved using a modification factor @xmath13 ( as @xmath14 ) which progressively approaches unity as the simulation proceeds , while a histogram @xmath15 keeps track of the number of visits to each energy @xmath1 during a given iteration .",
    "when @xmath15 is sufficiently `` flat '' , the next iteration begins with @xmath15 reset to zero and @xmath13 reduced by some predefined rule ( e.g. @xmath16 ) .",
    "the simulation terminates when @xmath13 reaches a small enough @xmath17 at which point the accuracy of @xmath0 is proportional to @xmath18 for flat enough @xmath15  @xcite .    in our parallel wl scheme , each random walker performs standard wl sampling in its energy sub - window . after a certain number of monte carlo steps , a `` replica exchange ''",
    "is proposed between two random walkers , @xmath19 and @xmath20 , where walker @xmath19 chooses swap partner @xmath20 from a neighboring sub - window at random .",
    "let @xmath21 and @xmath22 be the configurations that the random walkers @xmath19 and @xmath20 are carrying before the exchange ; @xmath23 and @xmath24 be their energies , respectively . from the detailed balance condition",
    "the acceptance probability @xmath25 for the exchange of configurations @xmath21 and @xmath22 between walkers @xmath19 and @xmath20 is : @xmath26\\,,\\ ] ] where @xmath27 is the instantaneous estimator for the density of states of walker @xmath19 at energy @xmath23 , cf .",
    "also  @xcite .",
    "illustration of the process of connecting density of states pieces after the simulation .",
    "( a ) individual pieces from four overlapping energy sub - windows ( labeled @xmath19 ) .",
    "( b ) the inverse microcanonical temperature @xmath28@xmath29/\\mathrm{d}e$ ] .",
    "grid lines indicate the positions where neighboring data coincide best ; individual curves are shifted with respect to each other for clarity .",
    "( c ) connected global density of states .",
    "the color codes show which part originates from which energy sub - window . ]",
    "an important new feature of our formalism is the provision of every random walker with its own @xmath0 and @xmath15 which are updated individually .",
    "also , each walker must fulfill the wl flatness criterion _ independently _ at each iteration , ensuring that systematic errors as found in  @xcite can not occur .",
    "when _ all _ random walkers within an energy sub - window have attained flat histograms , their estimators for @xmath0 are averaged and redistributed among themselves before simultaneously proceeding to the next iteration .",
    "this procedure reduces the statistical error during the simulation with @xmath30  @xcite , i.e. as for uncorrelated wl simulations . furthermore ,",
    "increasing @xmath6 can improve the convergence of the wl sampling by reducing the risk of statistical outliers in @xmath0 which would slow down subsequent iterations .",
    "alternatively , it allows us , in principle , to use a weaker flatness criterion , leading to an additional potential speed - up  @xcite .",
    "the simulation terminates when all @xmath3 energy intervals have attained @xmath17 , and we are left with @xmath3 fragments of @xmath0 with overlapping energy intervals , see fig .",
    "[ fig:2]a for an example .",
    "the pieces are then used to calculate a single @xmath0 over the entire energy range with the joining point for any two overlapping density of states pieces chosen where the inverse microcanonical temperatures @xmath31/\\textrm{d}e$ ] best coincide ( see fig .",
    "[ fig:2]b ) .",
    "this guarantees that there are no non - differentiable points in the microcanonical entropy @xmath32 $ ] , which would lead to artificial peaks in observables like the heat capacity .",
    "we set neighboring density - of - state pieces equal at those joining points and cut away superfluous parts to yield a continuous density of states , see fig .",
    "[ fig:2]c . to estimate statistical errors , we repeat the simulation a few times and apply resampling methods ( bootstrapping )  @xcite .",
    "note that for each resampled global density of states , the joining points between neighboring pieces of data are at different positions .",
    "in order to assess the generality and performance of this novel parallel wl scheme , we applied it to multiple intrinsically different models .",
    "we shall concentrate on two examples here : the well studied 10-state potts model in 2 dimensions showing a strong first - order transition , and a continuum model of amphiphilic molecules in solution showing multiple structural transitions during the lipid bilayer formation .",
    "the hamiltonian for the 10-state potts model is given by @xmath33 where the @xmath34 are spin variables which can take ten different ( integer ) values , and @xmath35 refers to all nearest neighbor spin pairs .",
    "@xmath36 is the total number of spins , @xmath37 the linear lattice size .",
    "using single spin flip updates , serial generalized - ensemble monte carlo methods are able to study system sizes of about @xmath38 within reasonable time ( order of weeks )  @xcite .",
    "figure  [ fig:3 ] shows the density of states for the @xmath39 lattice , which we obtained in a few hours by employing @xmath40 parallel walkers ( the energy range is split into @xmath41 sub - windows with an overlap of 75% , three walkers are deployed in each window ) , and the respective canonical distribution at the finite size transition temperature .",
    "the density of states covers almost @xmath42 orders of magnitude and transition states at the phase transition are suppressed by a factor of @xmath43 .",
    "data for the @xmath44 2d 10-state potts model .",
    "( a ) logarithm of the density of states obtained by our parallel wl scheme with equal - size sub - windows .",
    "( b ) probability density ( normalized to @xmath45 at the peaks ) at the critical temperature .",
    "transition states are suppressed by a factor of @xmath43.,scaledwidth=90.0% ]    the finite - size transition temperature @xmath46 is measured to be @xmath47 .",
    "we estimate the critical temperature in the thermodynamic limit from results of system sizes up to @xmath48  @xcite .",
    "our extrapolated value of @xmath49 is in excellent agreement with the exactly known @xmath50  @xcite .    besides this remarkable accuracy and absolute acceleration",
    ", our algorithm shows very good weak scaling behavior for these lattice models .",
    "this means that we can keep the simulation time almost constant when making the system larger if we also increase the number of computing cores by the same factor .",
    "in contrast , for serial runs this time increases rapidly with increasing system size .",
    "see fig .",
    "[ fig:4 ] for illustration , where we show the simulation times for both serial and parallel runs .",
    "absolute run times are rough estimates , @xmath3 is the number of energy sub - windows for parallel runs .     relative mc time to terminate serial wl runs for different system sizes for the 2d potts model ( open circles ) and for parallel runs ( filled circles ) .",
    "the number of energy windows @xmath3 increases according to the increase in system size . ]      to show how this parallel approach can open up new vistas we also applied the method to a  very distinct and particularly challenging molecular problem of high interest in biochemistry and pharmaceutical science : a coarse - grained continuum model for the self - assembly of amphiphilic molecules ( lipids ) in explicit solution . in this model ,",
    "amphiphilic molecules , each of which is composed of a polar ( p ) head and two hydrophobic ( h ) tail monomers ( p  h ",
    "h ) , are surrounded by solvent particles ( w ) , see fig .",
    "[ fig:5]a .",
    "the interactions between h and w molecules as well as those between h and p molecules , are purely repulsive and given by the following potential : @xmath51 with @xmath52 being the distance between two particles .",
    "all other interactions between non - bonded particles are of lennard - jones type : @xmath53\\,.\\ ] ] as is usual when simulating generic coarse - grained models , we use reduced units , i.e. , set @xmath54 and @xmath55 , where x - y stands for h - h , p - p , p - w , and w - w interactions .",
    "furthermore , we set @xmath56 with @xmath57 , cf .",
    "@xcite for similar models .",
    "bonded monomers are connected by a fene - wca  @xcite potential : @xmath58    + u_\\mathrm{lj}(r_{ij})+\\epsilon^\\ast\\,,\\ ] ] where we set @xmath59 and @xmath60 ; and @xmath61 for @xmath62 or else @xmath63 .",
    "reptation trial move : a ) amphiphilic molecules are composed of a polar ( p ) head bead and two hydrophobic ( h ) tail beads , and surrounded by solution particles ( w ) .",
    "b ) intermediate step ( not a valid configuration ) .",
    "c ) final reptation move configuration after particle reassignment.,scaledwidth=67.0% ]    such models offer qualitatively different technical challenges compared to the potts model and simulations of sufficiently large setups to study the bilayer formation are _ impossible _ for all practical purposes with traditional , single walker monte carlo methods .",
    "besides local displacement moves , we introduce a reptation move which facilitates creation ( and persistance ) of highly ordered bilayer structures . during this move",
    ", a solution particle ( w ) , randomly chosen amongst all which are within a distance @xmath64 of either the head or the tail of a given amphiphilic molecule , is `` captured '' and the respective other end of the lipid is `` released ''  ( fig .  [ fig:5]b ) . to restore a valid configuration , particle types",
    "are then adapted correspondingly ( fig .",
    "[ fig:5]c ) .",
    "note that due to generally different numbers of `` close '' solution particles at both ends of the lipid , forward and backward moves have different selection probabilities , and this bias must be corrected in the monte carlo acceptance probability .",
    "we used a system containing @xmath65 particles in total , including @xmath66 lipid molecules .",
    "one monte carlo sweep consists of @xmath67 updates , on average @xmath68 of which are reptation moves .",
    "the size of the simulation box is chosen such that the number density @xmath69 .",
    "data for the @xmath65-particle amphiphilic lipid model .",
    "( a ) logarithm of the density of states obtained with equal sub - windows as shown in fig .",
    "[ fig:1 ] and normalized probability density at the critical temperature .",
    "signs of a multi - stage transition can be seen in the right peak .",
    "inset pictures show example configurations with @xmath70 and @xmath71 , respectively .",
    "( b ) first and second derivative of the microcanonical entropy ( `` microcanonical analysis '' ) .",
    "see text for details.,scaledwidth=90.0% ]    the density of states @xmath0 over an energy range covering the complete lipid bilayer formation from random solutions to frozen bilayers spans @xmath72 orders of magnitude ( fig .",
    "[ fig:6]a ) and can not be sampled by single , serial wang ",
    "landau walkers in any reasonable time . during the bilayer formation",
    "multiple transitions occur , some almost simultaneously , as can be seen in the inset of fig .",
    "[ fig:6]a where a dip in the right peak of the canonical distribution is found . to understand such interlaced transitions we examine the microcanonical inverse temperature  @xmath73 and its derivative  @xmath74 ( see fig .",
    "[ fig:6]b . )",
    "there is a clear , double back - bending in the inverse microcanonical temperature  @xcite , indicating first - order like transitions  @xcite , and two well separated peaks in @xmath74 .",
    "what we see here is a particular feature of the microcanonical point of view : the pre - transition occurs at higher energies , but lower ( microcanonical ) temperature .",
    "it is important to note that our algorithm does not miss such features .",
    "a ) path of a single replica ( contributing to data shown in fig .",
    "[ fig:6 ] ) through the 13 energy sub - windows during the first @xmath75 mc sweeps .",
    "replica exchanges are attempted every @xmath76 sweeps .",
    "b ) and c ) data from the viewpoint of one of the wl walkers in the lowest - energy sub - window .",
    "we plot the i d of the replica which contributed to the histograms of that walker over time ( b ) and the corresponding histogram ( c ) .",
    "all replicas contributed to the density of states estimator of that particular walker at some point ( none of the histogram bins has zero entries).,scaledwidth=70.0% ]    before we consider the physics of the lipid bilayer formation in detail , we need to comment on another technical aspect of our method . due to the restricted local energy ranges ,",
    "wl walkers are also restricted to the corresponding parts of the phase space with the potential of locking out parts of the overall phase space during the simulation .",
    "the replica - exchange mechanism serves as a countermeasure to this source of systematic error ; hence , we must assure ourselves that each replica can actually walk through the entire energy space . as an example , in fig .",
    "[ fig:7]a we show the path of a replica through energy sub - windows . in this setup , we split the energy range into 13 overlapping sub - windows and deploy three wl walkers in each window . at the beginning of the simulation one replica , with an energy inside the walker s energy sub - window ,",
    "is assigned to each of the 39 walkers .",
    "hence , from another point of view , one can demand that every wl walker , restricted to its small energy range , should be visited by all replicas during the simulation .",
    "this is shown in fig .",
    "[ fig:7](b and c ) for a walker in the lowest - energy window .",
    "the histogram of visits ( fig .",
    "[ fig:7]c ) verifies that the walker is actually visited by all replica ( no histogram bin is empty ) . even though this analysis does not guarantee that we covered all of phase space during the simulation ( in fact",
    ", one can never determine this ) , the opposite behavior could indicate systematic errors .",
    "returning to the physical results , we first separate the energy scale for the interaction between solution particles from all others  @xcite , to get a more unaltered look at the actual transitions inside the lipid bilayer : we set @xmath77 . after estimating the density of states @xmath0 , we continued generating data with fixed weights @xmath2 and measure distributions @xmath78 for geometrical observables @xmath79 to characterize the main structural phases .",
    "we measure the following observables :    [ [ the - bond - order - parameter - s_mathrmmolmathrmhead ] ] the bond order parameter @xmath80  @xcite : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xmath81    is a measure for the average orientation of bonds with respect to a given direction in the simulation box .",
    "@xmath82 is the angle between a bond connecting the head and center bead in a lipid and the x , y , or z - direction , such that the order parameter is maximal  , and @xmath83 denotes the average over the respective bonds of all lipids .",
    "for perfectly aligned bonds @xmath84 takes the maximum value of @xmath85 , its minimal value is @xmath86 , where all bonds are perpendicular to a certain axis , e.g. , for lipids forming a perfect cylinder and taking the cylinder axis as reference . for spherical or random configurations",
    "the parameter is close to @xmath63 , independently of the reference axis .",
    "[ [ diagonal - elements - of - the - gyration - tensor - of - the - largest - amphiphilic - cluster - and - prolateness ] ] diagonal elements of the gyration tensor of the largest amphiphilic cluster and prolateness  @xcite : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to measure these quantities it is necessary to define and detect the largest cluster of amphiphilic molecules in the system at every measurement .",
    "this is efficiently done by a continuous implementation of the hoshen - kopelman algorithm  @xcite . in analogy to  @xcite two amphiphilic molecules",
    "are defined to be neighbors whenever a tail monomer of one molecule is within a distance @xmath87 from a tail monomer of the other molecule .",
    "furthermore , as the extension of clusters is usually larger than the simulation box size and in order to calculate meaningful quantities , all measurements are done in unfolded coordinates , i.e. , all pieces of a cluster connected only via the periodic boundaries will be moved such that the whole cluster is connected in free space .",
    "the diagonal elements of the gyration tensor of the largest lipid cluster are calculated as follows : @xmath88 where @xmath20 labels an individual particle , @xmath89 is the position vector , @xmath90 indicates one of the principal directions @xmath91 , @xmath92 , or @xmath93 and @xmath94 is the position of the center of mass of the unfolded cluster in that direction .",
    "we use @xmath67 here for the total number of particles belonging to the cluster .",
    "we derive the prolateness @xmath95 from the components of the gyration tensor in three dimensions : @xmath96 where @xmath97 is the trace of the gyration tensor and @xmath98 , with @xmath99 and @xmath100 being the unity matrix .",
    "the prolateness approaches its maximal value of @xmath101 for thin cylinders or rod like structures ( @xmath102 ) and its minimum value of @xmath103 for disks ( @xmath104 ) .",
    "analysis of main structural phases during the bilayer formation .",
    "top views on the two - dimensional energy  bond - order ( a ) and energy - prolateness histograms ( b ) measured during a wl production run .",
    "c ) shows representative structures .",
    "top row : single lipid representation , bottom row : cluster representation .",
    "solution particles ( w ) are not shown for clarity.,scaledwidth=90.0% ]    figure  [ fig:8 ] ( a and b ) shows top views of the histograms @xmath105 and @xmath106 .",
    "data is combined from all energy sub - windows , the grid - line positions correspond to energies at which  @xmath74 ( cf . fig .",
    "[ fig:6 ] ) exhibits peaks . for @xmath107",
    "we see disordered , random solutions ( @xmath108 ; phase `` 0 '' ) , at @xmath109 cluster with a preferred orientation start to form ( `` ia '' ) .",
    "those clusters become more and more disc - like ( @xmath110 ) and lipid molecules align @xmath111 ( `` ib '' ) , but are still `` liquid - like '' .",
    "phase `` ii '' can be seen as an intermediate phase where two lipid layers separate and finally form a bilayer with `` crystallized '' lipids ( phases `` iii '' ) .",
    "figure  [ fig:8]c shows representative structures from all phases with corresponding property sets @xmath112 . for clarity ,",
    "solution particles are not shown but were always included in simulations . for a  comprehensive , more biochemical discussion of bilayer formation and structural changes in the bilayer ,",
    "see  @xcite .",
    "such a complete thermodynamic analysis of a system of this size , including explicit solution particles , was previously impossible using monte carlo techniques .",
    "the proposed parallel wang ",
    "landau method , however , enables us to enter a domain which had been dominated by molecular dynamics simulations , bringing along all the advantages of generalized ensemble mc techniques .",
    "we have described a generic , parallel framework for wang ",
    "landau simulations based on the concepts of energy range splitting , replica exchange monte carlo , and multiple random walkers .",
    "the method is simple , generally applicable , and leads to significant advantages over traditional , single - walker wl sampling .",
    "most importantly , it is readily adaptable to parallel systems with an arbitrary number of processors ( cores ) including systems with many thousands of cores .",
    "as shown in two examples , our parallel wl framework allows us to successfully simulate previously inaccessible systems .",
    "the reasons are two - fold : first , each walker is now responsible for sampling a smaller configurational phase space , leading to faster convergence .",
    "second , the replica exchange process revitalizes walkers in trapped states and avoids an erroneous bias in @xmath0 due to potential ergodicity breaking .",
    "we demonstrated weak scaling behavior and the coverage of the entire energy space .",
    "analyses of the strong scaling abilities and the influence of the number of walkers on the statistical error are given elsewhere  @xcite ."
  ],
  "abstract_text": [
    "<S> combining traditional wang  landau sampling for multiple replica systems with an exchange of densities of states between replicas , </S>",
    "<S> we describe a general framework for simulations on massively parallel petaflop supercomputers . </S>",
    "<S> the advantages and general applicability of the method for simulations of complex systems are demonstrated for the classical 2d potts spin model featuring a strong first - order transition and the self - assembly of lipid bilayers in amphiphilic solutions in a continuous model . </S>"
  ]
}