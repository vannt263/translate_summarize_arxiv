{
  "article_text": [
    "in quantitative finance , the interest rate curve has been intensely studied and modeled in terms of stochastic differential equations ( sde ) , assuming for this curve a temporal evolution which satisfies the non - arbitrage opportunity in a complete and efficient market @xcite .",
    "such restriction implies that the model at hand needs to be calibrated by the market prices of the most liquid instruments , bond prices being a representative example .",
    "these in turn are decomposed in more elementary units , the so called _ zero coupon bonds_. these are , roughly speaking , financial instruments that pay one unit of currency at a certain future date ( maturity ) .",
    "the price of these latter instruments will characterize the average behavior of the interest rate curve @xcite . on the other hand , the fluctuations of the interest rate curve with respect to its average , the so called volatility , is quantified through market instruments such as _ caps _ and _ floors _ @xcite .",
    "a cap pays the difference between a certain rate and a certain prespecified level ( strike ) if this difference is positive , while the floor pays off the difference between the strike and the value of the rate , if positive .",
    "the relation that links the cap or floor premium with the volatility is the well known black - scholes formula @xcite . + interested in the calibration of zero coupon bond prices together with cap / floor prices , in this paper",
    "we address the heath - jarrow - morton model ( hjm ) which in its natural formulation is described in @xcite .",
    "the main interest of the hjm approach is set on the fact that it provides a broad mathematical formulation @xcite , where most of market observed features can be taken into account .",
    "this was nt the case of preceding seminal models such as black - derman - toy model or hull - white models @xcite , where the model parameters were very difficult to calibrate in terms of market observed patterns .",
    "furthermore , those models only incorporated one source of stochasticity , and therefore the only possible mode in the interest rate curve was the parallel movement . only lognormal or normal statistical distributions of the short rate were possible .",
    "these distributions for the short rate arise in distributions for different maturities of the libor rates , which are far away from those implied in the markets .",
    "conversely , hjm models are not afflicted by these drawbacks .",
    "the hjm framework @xcite is general , in the sense that many previous models describing the term structure of interest rates can be understood as particular cases of a hjm model , that in turn can incorporate as many risk factors as needed in order to accurately describe the evolution of the rate s curves .",
    "the formulation of the hjm can be extended to incorporate several stochastic factors ; hence , the simulated interest rates curve movements could include deformation modes that changes the initial slope and convexity of this curve , in order to describe the covariance and autocorrelation structures present in the time behaviour of the interest rate curve . additionally , the probability distribution function of interest rates can be exogenously defined by means of local volatility functions ( of deterministic or stochastic nature ) in order to match option prices as quoted in the market . + the major drawback of hjm models is set on the continuous nature of its state variables ( the continuous time structure of forward rates ) , what leads to an infinite amount of state variables @xcite .",
    "therefore , in general , these models are non - markovian in finite dimensions , and thus can only be solved by using fitted monte carlo techniques which are eventually slow and computationally delicate .",
    "this is of course problematic for practical purposes , since financial industry requires models that can be integrated in real time with reasonable accuracy . quite interestingly",
    ", hjm models can be in some particular situations transformed into a low order markovian system @xcite , and therefore can be subsequently mapped to a partial differential system due to the well known feynman - kac formula @xcite .",
    "numerical methods for solving partial differential systems can consequently apply @xcite .",
    "although integration of pde is typically faster than monte carlo simulations of the associated sde system , in practice one needs additional optimization methods for calibration ( conjugate gradient , genetic algorithms ) , thus requiring a large number of evaluations of the model . to find out fast and efficient model evaluations ( numerical solvers )",
    "is therefore demanding in financial industry .",
    "+ in this paper , we propose a full numerical methodology to optimize such issues . amongst the plethora of different hjm models , we address here a _ single factor",
    "_ hjm model with _",
    "stochastic volatility_. this choice is justified on practical reasons ( this is a realistic enough model which is actually used in the financial industry @xcite ) and can be argued as it follows : ( i ) _ single factor _ :",
    "principal component analysis of the covariance matrix associated to historic data of the interest rate curve suggest that the first eigenvalue has a weight of @xmath0 @xcite .",
    "( ii ) _ stochastic volatility _ : the preliminary hjm models used to model the stochastic behavior of the interest rate market by a single wiener process that drives the forward rate processes ( that is to say , there was a single source of stochasticity in the models ) . in the last years , some authors have introduced @xcite , according to empirical evidence , a new source of stochasticity in the description of the volatility evolution , leading to the so called stochastic volatility hjm models @xcite .",
    "+ amongst all the possible stochastic volatility functions , we will focus on those which are separable , that is , that can be factorized in the product of a stochastic function and a time dependent deterministic function and another deterministic function that depends on the maturity . again , this choice is nt random , much on the contrary , the resulting hjm model turns to be markovian in only three dimensions , and can therefore be mapped and evaluated within a pde framework .",
    "we will present a complete numerical integration of the model based on finite differences schemes and crank - nicholson temporal integrators . in order to drastically improve the computational efficiency of the method ( that is , reaching fast computation time while preserving good accuracy )",
    ", we employ a scale analysis for the mesh optimization and , for the first time in financial models ( as far as we are aware ) , alternating direct implicit ( adi ) schemes , techniques borrowed from computational fluid dynamics .",
    "the rest of the paper goes as follows : section  [ sec : curvacuponcero ] focuses on the interest rate market , defining the zero coupon bond as the trading derivative .",
    "then , section  [ hjm ] presents the single factor hjm model with stochastic volatility .",
    "the model is markovianised using subsidiary state variables , as usual , and the specific volatility function enables a 3d pde formulation .",
    "section  [ numerical ] and [ nummethod ] describe the full numerical method .",
    "the numerical validation is depicted in section [ validation ] .",
    "after some additional remarks regarding the numerical methods ( section [ additional ] ) , in section [ conclusion ] we conclude .",
    "in the interest rate market , the zero coupon bonds are taken as the most basic market instruments in the sense that any other financial quantity related to interest rates can be derived from them .",
    "these assets merely pay a monetary unit in a given future time that is called the expiration date , and the current price as a function of the expiration date is determined by the so called zero coupon bond curve ( zcbc ) .",
    "we will formally denote this curve as it follows : @xmath1 where @xmath2 stands for the present time ( valuation date ) , @xmath3 stands for the bond expiration date and @xmath4 is merely the zero coupon bond price ( zcbp ) .",
    "we will also assume from now on that zcbc fulfills the necessary regularity conditions .",
    "+ by definition , zcbc is such that :    * the zcbp that expires at the present time is 1 ( trivially ) : @xmath5 .",
    "* zcbp @xmath6 $ ] and is a monotonically decreasing function ( this property is assumed in order to avoid the existence of arbitrage ) .",
    "it is worth saying that in exceptional macroeconomic situations , it is actually possible that the latter property does nt hold , due to the intervention of central banks : of japan , in order to encourage investors to buy their currency @xcite .",
    "+ provided the preceding properties , there always exists a function @xmath7 such that @xmath8 and consequently , @xmath9 fulfills : @xmath10 > from a financial point of view , @xmath11 is interpreted in terms of the interest rate that an investor would receive if he sells in @xmath2 a zero coupon bond with expiration date @xmath3 and buys another with expiration date @xmath12 .",
    "this bond is the so called forward rate of interest . in particular",
    ", the short term rate of interest @xmath13 fulfills : @xmath14 and is of special interest because it quotes the return of an investment of one monetary unit in the present time , @xmath15 , that is redeemed an infinitesimal time later , @xmath16 .",
    "the single factor hjm model under hands is originally represented by the stochastic differential equation for the short rate @xmath13 ( details can be found in @xcite ) @xmath17dt,\\end{aligned}\\ ] ] where @xmath18 is a subsidiary state variable with no financial meaning , employed to markovianise the model , @xmath19 is a positive constant and @xmath20 is a wiener process .",
    "the volatility function @xmath21 is defined through @xmath22 where @xmath23 is a wiener process , @xmath24 and @xmath25 are deterministic functions of time ( @xmath26 $ ] ) , @xmath27 is a stochastic variable that drives the rate variance , @xmath28 is a constant that estimates the mean reversion speed of the process @xmath27 , @xmath29 is a constant that estimates the correlation between the short rate and the volatility ( hence @xmath30 $ ] ) , and @xmath31 is the volatility associated to @xmath27 , which in this case is simply a deterministic function of time . + defining @xmath32 , we have @xmath33dt + \\eta ( t , x(t ) ) dw(t),\\end{aligned}\\ ] ] where @xmath20 is another wiener process . it can be analytically shown that the price of the zero coupon bond in this formulation reads @xmath34 the hjm model is thereby fully characterized .",
    "the state variables belong to the following range : @xmath35      given the above model formulation , now we would like to price contracts whose future payoffs depend on the evolution of the yield curve , that is to say , those payoffs are deterministic functions of the zcbp at certain times",
    ". let @xmath36 be the price in a given time @xmath2 , of a contract that pays in @xmath37 in terms of @xmath38 , where @xmath39 denotes the payoff function .",
    "the simplest example of this situation is the zero coupon bond whose payoff function is a constant function , @xmath40 .",
    "the so called caplet  @xcite is another example of a payoff function , frequently traded in the market : @xmath41 where @xmath3 is the contract s expiration date , @xmath42 is the contract s payment date and @xmath43 , where @xmath44 stands for the strike and is a positive constant . in this paper",
    "we focus on both the zero coupon bond and the caplet as the derivatives under study .",
    "+ in these terms , the price of an interest rate derivative depends on time and space @xmath45 and fulfills the following partial differential equation : @xmath46 where the feynman - kac formula @xcite is applied to map the stochastic problem into a pde one ( note that the financial notation for the derivatives -the so called greeks- is not used here ) .",
    "the coefficients @xmath47 are functions of the space variables @xmath48 and time , but their dependence has been omitted for clarity .",
    "these coefficients are given by    @xmath49    the boundary / terminal conditions of the problem are different depending on the payoff function . for the cases of the zero coupon bond and the caplet ,",
    "these are given by : +    * _ zero coupon bond with expiration date @xmath3 : _ the terminal condition simply reads @xmath50 in the limit @xmath51 the payoff is zero , and consequently one boundary condition is : @xmath52 now , when @xmath53 the pde reduces to @xmath54 in the boundary @xmath55 the pde reads @xmath56 that is analytically solvable ( lagrange s method yields a solution of the type @xmath57 , where @xmath58 is a generic function that must be determined to fulfill the boundary conditions ) .",
    "finally , note that the boundaries @xmath59 and @xmath60 are not relevant in this case as long as the zero coupon bond price is not a function of @xmath61 .",
    "+ * _ caplet _ : the terminal condition is given by @xmath62 just as in the case of the zero coupon pde , the boundary condition for @xmath51 is @xmath63 when @xmath53 the pde reduces to : @xmath64 in the limit @xmath55 , the pde and its boundary condition have the following shape : @xmath65 thereby we have : @xmath66 in the case @xmath59 we will have @xmath67 and when @xmath68 the pde reduces to @xmath69 that in this case can only be solved numerically .",
    "+ additionally , when @xmath68 the following identity is commonly assumed to hold : @xmath70 and will be taken into account in the numerical development .      in order to fully specify the preceding pde ,",
    "the constants and functions implicitly defined in the hjm model have to be initialized . as a reference guide , and for the sake of an order of magnitude estimation , we introduce the characteristic market parameters in 2007 : + -_initial zero coupon curve _ :    * @xmath71    -_volatility function _ :    * @xmath72 * @xmath73 * @xmath74 * @xmath75 * @xmath76 * @xmath77    observe that in a practical situation , for the calibration , values of the parameters need to be optimized using _",
    "e.g. _ a conjugated gradient or genetic algorithm , iterating several times the model evaluation and comparing the results with the market data .",
    "this is also supposed to be done in real time , and therefore it is of fundamental importance that the model evaluation ( numerical method ) is as efficient as possible . in this work",
    "we focus on this fundamental issue and propose a numerical methodology that enables an efficient evaluation of the model ( suitable for real time execution ) , while the global calibration problem ( the aforesaid optimization method ) is not addressed .",
    "before solving numerically equation ( [ 1 ] ) and in order to optimize the numerical approach and reduce its computational cost , we need to make some preliminary analysis .",
    "three points are of major importance , namely ( i ) the study of some analytical solutions will provide information about the system s solution itself , ( ii ) a detailed scale analysis of the problem will help to optimize the mesh resolution , increasing it only where / when needed .",
    "finally , some considerations regarding the metric will also be addressed .",
    "+      the first case considers the solution of the zero coupon bond curve with expiration date @xmath3 .",
    "as far as this solution does not depend explicitly on @xmath61 ( non - arbitrage conditions yield a volatility independent zcbp ) , we assume @xmath68 without lack of generality in order to simplify the system of equations . furthermore",
    ", constant @xmath19 is generally small ( volatility function depends on @xmath19 ) and we have thus assumed that it is also null .",
    "hence , the partial differential equation reduces to : @xmath78 with the additional condition @xmath79 .",
    "we can trivially map this pde into a system of ordinary differential equations of the following shape : @xmath80 with initial conditions @xmath81 , and @xmath82 being a parameter . + it is indeed easy to check that its solution is : @xmath83 note that not assuming a null value for @xmath19 is equivalent to substitute @xmath84 by the function @xmath85 , which is defined in ( [ gs ] ) .",
    "+ the usefulness of this analytical solution is twofold : first , it will serve to validate the numerical method , and second , it will stand as as boundary condition for the ( more general ) caplet problem .      in the financial realm , reducing the computing time as well as the computational cost ( in terms of memory resource , for instance ) is fundamental .",
    "an adequate temporal and spatial scale analysis will enable us to increase the mesh resolution only where / when needed , what leads to a saving of computational resources .",
    "typically , this scale analysis is done by adimensionalizing the equations under study and consequently comparing the relevance of the respective terms ( this technique is broadly used in fluid mechanics when performing the scale analysis of the navier - stokes equations , for instance  @xcite ) .",
    "+ scales are indeed determined by the variables characteristic values , as well as by the boundary conditions . in the case of the cap problem ,",
    "the variable of reference is the interest @xmath86 ( @xmath87 $ ] , that is to say , a percentage ) .",
    "we can rescale this variable as : @xmath88 in such a way that the characteristic value of @xmath89 is the unity ( @xmath90 is usually the forward rate of interest observed at value date ) .",
    "now , having in mind that the cap s boundary condition reads @xmath91 where @xmath92 , we may define the characteristic time @xmath93 as : @xmath94 finally , taking into account the relation between @xmath13 and @xmath82 ( equation [ eqn2 ] ) : @xmath95 with these rescaled variables , the original equation takes the following shape : @xmath96 where @xmath97 ( note that the @xmath98 marks have been eliminated for notation simplicity ) .",
    "no rescaling has been applied to both @xmath61 and @xmath99 as long as there s no dominant scale defined ( the latter rescaling would nt affect the resultant equation ) .      by introducing metrics in the independent variables ( @xmath48 )",
    ", we can transform the problem s domain into a computational domain which is usually simpler , and consequently concentrate the mesh points in the areas under study . in our case of study ( cap ) , provided that the solution is likely to live in the strike s neighborhood ( k ) , this should be the most dense zone .",
    "following tavella @xcite , we have used an hyperbolic - like metric generally defined as : @xmath100 @xmath101    @xmath102 , z \\in [ z_{0},z_{\\infty } ] , \\mbox {   being    }   z=(r , v , \\mbox { or } y ) .",
    "\\label{metrica}\\ ] ]    in order to get a mesh that is accurate enough in the zone under study , the parameters @xmath103 have to be correctly chosen for each dimension of the problem .",
    "+ it is worth saying that the introduction of these kind of metrics does nt modify the system of equations in a substantial manner .",
    "note that the derivatives with respect of the new variables can be expressed as :    @xmath104 and @xmath105 thereby , if we denote @xmath106 , and @xmath107 , where @xmath108 is a generic variable from @xmath109 and @xmath110 its respective transform , the original system of equations ( [ eqnfinal ] ) will only differ from the new one in the substitution of functions @xmath111 , @xmath112 by : @xmath113 @xmath114 @xmath115 while hitherto we have only defined metrics in the direction of the independent coordinates , it is actually possible to employ more complex transformations that involve several variables ( @xmath116 ) .",
    "however , it is likely that the integration domain would nt in that case be cartesian anymore , and consequently the finite difference scheme would nt apply .",
    "furthermore , while these types of metrics would eventually enable us to eliminate the cross derivative terms in ( [ eqnfinal ] ) ( transforming the original equation into its canonical form ) , this transformation would on the other side modify the frontiers of the problem from straight to curve lines , something that not desirable in any case .",
    "+ once the preliminary insights have been put forward , we will describe in the next sections the numerical method employed to integrate equation ( [ eqnfinal ] ) as well as the results that we have obtained .",
    "as commented above , the equation under hands is ( [ eqnfinal ] ) : @xmath117 let us define a new temporal variable @xmath118 where @xmath3 stands for the maturity .",
    "the integration should then be done for @xmath119 $ ] .",
    "note that equation ( [ eqnfinal ] ) is parabolic for @xmath13 and @xmath61 and hyperbolic for @xmath82 .",
    "+ in the particular problems concerning the estimation of financial derivatives , the execution time of numerical tools is an issue of fundamental importance . according to this fact",
    ", it seems suitable to apply second order schemes for the discretization of both temporal and spatial partial derivatives , as far as these schemes show optimal computational cost and adequate precision . in a second step",
    ", one has to decide whether to apply explicit or implicit schemes .",
    "naturally , the simplest option is always to tackle explicit schemes , which are fast and easy to implement .",
    "however , it is easy to check that due to the second derivatives , the following relation holds for the temporal and spatial resolutions    @xmath120    this relation implies that in order to achieve a precision of say @xmath121 in the solution , a time step would need @xmath122 iterations .",
    "moreover , the coefficients of the derivatives are powers of @xmath13 , @xmath61 or @xmath82 , and the integration domain ranges to the infinite . since the time step is inversely proportional to those coefficients , the problem comes to be even more delicate .",
    "we can thus conclude that explicit temporal schemes wo nt fit in this case due to their inevitably lengthy behavior .",
    "thereby , we will have to choose implicit schemes for the temporal integration .",
    "these have the following general expression :    @xmath123 where we have employed the usual numerical methods notation @xmath124 and @xmath125 . here",
    "@xmath28 stands for an explicit scheme for @xmath126 ( euler scheme ) while it stands for implicit schemes when @xmath127 .",
    "more concretely , @xmath128 characterizes the so called euler implicit scheme and finally @xmath129 characterizes the second order crank - nicholson scheme .",
    "we will use the latter one as the temporal integrator as it is adequate to be used within adi schemes ( this will be explained further in the text ) .",
    "+ the first , second and cross spatial derivatives , are discretized by centered finite difference schemes as it follows :    @xmath130    where @xmath131 is a generic variable that stands for @xmath13 , @xmath61 or @xmath82 .",
    "the notation @xmath132 , @xmath133 and @xmath134 describes the above difference schemes . gathering both spatial and temporal schemes , we come to a final discretization of the following kind : @xmath135 where @xmath136 is the discretized solution vector in a structured mesh of dimension ( @xmath137 ) .",
    "+ it is worth saying that the use of centered difference schemes allows us to obtain a compact stencil .",
    "for instance , note that the discretized equation in the point @xmath138 only contains information of @xmath139 .",
    "focusing on variable @xmath13 , equation ( @xmath140 ) would adopt the shape : @xmath141 + where @xmath142 is a tridiagonal matrix @xcite representing the spatial discretization of @xmath143 in @xmath144 ( equation ( [ discreta ] ) ) , according to the discretization schemes depicted in equation ( [ esquema ] ) .",
    "@xmath145 , @xmath146 and @xmath147 will be defined equivalently ( see below ) .",
    "+ tridiagonal systems are indeed quite easy to implement and solve ( for instance , the thomas algorithm  @xcite solves a tridiagonal system in @xmath148 operations , where n is the order of the system ) .",
    "this goodness will enable the use of alternating direction implicit schemes ( adi ) @xcite as will be shown further in the text .",
    "+ finally , taking into account that the equation is indeed linear , it can be written as : @xmath149   \\nonumber   \\\\ + ( 1-\\theta )   \\delta t \\left [ l_r(t^n , r_i , v_j , y_k ) u^{n } + l_v(t^n , v_j ) u^{n}+    l_y(t^n , r_i , v_j , y_k ) u^{n}\\right ] \\nonumber \\\\",
    "+    \\delta t l_{rv}(t^n , r_i , v_j ) u^{n } +   \\delta t b(t^n , r_i , v_j ) , \\nonumber\\end{aligned}\\ ] ] and realigning , @xmath150 ( u^{n+1}-u^{n } )   \\nonumber   \\\\ =   \\delta t \\left[l_r(t^{n},r_i , v_j , y_k ) + l_v(t^{n},v_j)+   l_y(t^{n},r_i , v_j , y_k ) + l_{rv}(t^n , r_i , v_j)\\right ] { u^n}+   \\delta t b(t^n , r_i , v_j ) \\nonumber",
    "\\\\ =   \\delta t f(u^n , t^{n},r_i , v_j , y_k ) .",
    "\\label{adiecu}\\end{aligned}\\ ] ] note that the operators @xmath151 include the terms related to the spatial discretization .",
    "these operators , treated implicitly , give rise to a system of equations(@xmath152 ) which in general has 7 diagonals , and whose resolution can be performed applying either direct or iterative methods .",
    "however , each one of them treated separately can be rewritten as a tridiagonal matrix , whose resolution is trivial as commented above . note also that the operators @xmath151 have neumann boundary conditions and consequently do not include any dirichlet - like information .",
    "+ finally , note that the mixed derivative term ( @xmath147 ) is only treated explicitly , because otherwise its inclusion in the implicit scheme would eliminate the tridiagonal structures , and would consequently avoid the use of adi schemes that will be described in what follows .",
    "this fact does not affect in any case neither to the convergence nor the precision of the numerical solution .",
    "detailed numerical analysis and validation of the mixed derivative term has been already performed by different authors : examples of implementation for the fluid mechanics problems are given in @xcite , and a detailed analysis of numerical stability analysis and convergence can be found in @xcite .",
    "the adi schemes belong to the category of splitting methods @xcite , used in the resolution of multidimensional pde systems .",
    "the key idea behind these methods is to separate the original multidimensional problem in several unidimensional split problems .",
    "then , each split problem can be under certain conditions reduced to the resolution of a tridiagonal system of equations .",
    "these conditions are related to the use of centered spatial operators in structured meshes , which is our case .",
    "+ adi schemes were initially introduced by douglas , peaceman and rachford @xcite in order to integrate , using finite difference schemes , the well known navier - stokes equations describing the fluid motion .",
    "some modifications have been put forward so far ( see for instance @xcite , in order to apply these schemes to either stationary or non stationary problems . in this work we will use an adi scheme recently put forward by hout & welfert @xcite , called the douglas scheme . +",
    "consider equation ( [ adiecu ] ) , this one can be formally written as : @xmath153\\delta u^n = \\delta t f(u^n)\\ ] ]    the douglas scheme applies thus in the following way :    @xmath154 @xmath155=\\delta u^0\\ ] ] @xmath156=\\delta \\tilde u^1\\ ] ] @xmath157=\\delta \\tilde u^2\\ ] ] @xmath158    note that each step only requires the resolution of a tridiagonal system of dimension @xmath159 , @xmath160 , or @xmath161 .",
    "the unconditional convergence of this scheme has been proved for @xmath162 ( crank - nicholson ) in 2-dimensional systems with constant coefficients@xcite .",
    "however no similar study has been performed so far in the 3-dimensional case with variable coefficients @xcite , which is nonetheless our case .",
    "special attention will be thus paid to the convergence behavior of the solution . + it is worth saying at this point that the craig & sneyd @xcite method is an apparent improvement to the douglas scheme ( in terms of the solution precision ) when mixed derivative are present , while being more expensive computationally speaking .",
    "we actually have also tackled this adi scheme , but given that no such improvement has been observed , we will only focus on the douglas scheme .",
    "finally , the douglas scheme , as any other adi scheme , is an approximate factorization ( af ) of the original equations with the errors of order @xmath163 for 3d problems .",
    "an efficient subiteration procedure can be applied to eliminate the af .",
    "this method , known as huang s approximate factorization correction @xcite , has been also checked in this context , but it is computationally more expensive and no additional improvements have been observed in the range of accuracy we are working .",
    "we have done two kind of studies in order to validate the numerical methods : + ( i ) first , we have compared the numerical solution of the zero coupon curve or deduction curve with its analytical solution , in two different situations , and + ( ii ) second , we have compared the numerical solution of a caplet with the one obtained by a 2d - heston model @xcite ( it is easy to check that the model under study behaves , for @xmath164 , as a heston model for the libor rate with identical parameters ) .      in the first study we consider the parameters and the initial zero coupon curve depicted in section [ sec : parametrostipicosdemercadoparaelmodelohjm ] .",
    "thereby , the forward rate of interest is constant @xmath165 and it has a null derivative . in figures ( [ fig1]-[fig2 ] )",
    "we compare the theoretical zero coupon curve with the one obtained through numerical simulations with @xmath166 , @xmath167 , and @xmath168 .",
    "concretely , figure ( [ fig1 ] ) shows the error for different meshes .",
    "note that this one is always below @xmath169 even for coarse meshes . as a result , we have set the mesh reference values to @xmath170 . in figure ( [ fig2 ] )",
    "we plot the convergence of the solution as a function of the number of time steps per year .",
    "notice that from 12 steps per year , in a given mesh the variations are quite small ( @xmath171 ) .",
    "+ in figures ( [ fig3 ] ) and ( [ fig4 ] ) we show the error s spatial distribution for a given set of parameters , assuming @xmath172 ( figure ( [ fig3 ] ) ) or @xmath173 ( figure ( [ fig4 ] ) ) respectively .",
    "note that in the former case , some non desirable errors take place in the infinite boundary , which can actually propagate into the zone under study @xmath174 ( figure ( [ fig3 ] ) ) .    up to know the numerical method is validated , as far as the solution s error is confined , in the zone under study , around @xmath175 . however , as long as the analytical solution strongly depends on the initial curve , it is necessary to check whether if the precision of the numerical method holds for more realistic curves ( with non null forward rate interest curve derivative ) . for that task ,",
    "in a second example we tackle a new initial zero coupon curve , which is not anymore a continuous curve but a discrete valued one ( figure ( [ fig5 ] ) ) .",
    "its derivative is plotted in figure ( [ fig6 ] ) and stands for the forward rate of interest curve , and its second derivative is plotted in figure ( [ fig7 ] ) . +",
    "as long as the curve is expressed in terms of discrete values , we need to perform a smoothing approximation in order to introduce it in the simulation .",
    "notice that the solution s smoothness will strongly depend with the smoothness of this initial curve ( this is due to the fact that the temporal derivative of the solution is related to the derivative of the forward rate of interest curve ) .",
    "an appropriate solution to this problem is to approximate the initial curve with splines  @xcite , in order to have a piecewise function with continuous second derivative @xmath176 , and consequently have a solution with continuous temporal derivative .    according to this approximation",
    ", we have performed the same simulations and analysis as for the first study .",
    "conclusions are plotted in figures ( [ fig8]-[fig10 ] ) . as expected",
    ", the fact that the derivative of the forward rate of interest curve is non null has a net effect in the precision of the solution . while it is quite easy to achieve convergence of order o(@xmath169 ) , it comes necessary to overrefine the mesh ( figure ( [ fig8 ] ) ) or alternatively increase the number of time steps ( figure ( [ fig9 ] ) ) in order to go beyond @xmath177 . nevertheless ,",
    "as is shown in figure ( [ fig10 ] ) , the error s spatial distribution is quite similar to the one found in the first study : we can conclude that the numerical method correctly reproduces the expected results .",
    "the second validation test consists in making a comparison between the results obtained with several caplets and those obtained by the heston model , which is an already validated model @xcite . + in order to optimize the mesh s size",
    ", we have performed a previous analysis of the numerical scheme s convergence ( both in spatial and temporal discretizations ) .",
    "some of the results are plotted in figure ( [ fig11 ] ) , where we represent the evolution of a generic caplet s prime as a function of @xmath159 , @xmath160 , @xmath161 and @xmath178 .",
    "notice that we need at least a mesh size of 100x40x40 if we seek variations of the prime below @xmath169 . with a reference mesh of 100x40x40",
    ", the number of time steps does not affect practically the results .",
    "+ the difference between the solutions of the two models are plotted in figures ( [ fig12 ] ) and ( [ fig13 ] ) , both for the premium and for the volatility .      in the following table",
    "we have plotted , as a reference guide , the required computation time for different caplets .",
    "simulations have been run in a mesh of @xmath179 , with @xmath180 steps per year , in a @xmath181 processor ( 3.2 ghz , 1 gb ram ) .",
    "results are quite satisfactory .    [ cols=\"^,^,^,^\",options=\"header \" , ]     for illustration , the numerical solutions obtained for the caplet s prime and the greeks @xmath182 and @xmath183 are shown in figures ( [ fig17],[fig18],[fig19 ] ) respectively .",
    "the computations have been performed for tmc=2 , tc=1 and ntotal=12 and the pictures are shown at y=0 .",
    "as commented in section [ metrics ] , it is highly recommendable to introduce a metric layer in the numerical method , such that the domain under study transforms into a computational domain which is typically easier to handle ( in most cases , this one is the unity cube ) , as long as this domain enables the use of structures uniform meshes , where one can concentrate the mesh points wherever needed .",
    "the mesh that has been used in this work is hyperbolic ( see eq .",
    "[ metrica ] ) , following tavella @xcite .",
    "one of the main properties of these meshes is that one can concentrate as many points as needed in the inner regions of the zone under study , in order to achieve a better resolution .",
    "it is thus convenient to fix the parameters related to the domain transformation .",
    "for instance , @xmath13 will transform according to :    @xmath184 @xmath185    where the jacobian of the transformation reads :    @xmath186    we have then four parameters @xmath187 to fix :    * * @xmath188 * define the real domain of study . obviously @xmath189 . on the other side",
    ", @xmath190 must be such that his values does nt modify the solution in the zone under study ( that is , close to the strike ) .",
    "there is no recipe in order to find the adequate value , but after some preliminary estimations and taking into account the boundary conditions , we have set @xmath191 . * * @xmath192 * defines the region under study , that is , a neighborhood of the strike . * * @xmath193 * this parameter provides a measure of the mesh s stretching , i.e. the number of points that will be concentrated in the zone of interest -close to the strike- .",
    "concretely , the smaller @xmath193 , the larger concentration . given that its value also affects the jacobian of the transformation , it is desirable that @xmath193 is such that the jacobian be close to 1 . in figure ( [ fig14 ] )",
    "we plot this dependence , for @xmath194 .",
    "note that for @xmath195 , the jacobian reaches the unity .",
    "a similar study for @xmath61 e @xmath82 lead us to fix @xmath196 y @xmath197 .    as a summary ,",
    "the metric s characteristic values are :    @xmath198    @xmath199      following tavella @xcite , as far as the payoff is typically a discontinuous function , small variations in the strike lead to a non smooth behavior of the solution .",
    "this is not desirable and therefore some numerical techniques should be applied in order to soften it :    * perform a dynamical modification of the mesh , related to the payoff s shape .",
    "this is an elegant solution , however for practical purposes this technique is not well fitted as long as it usually leaves to mesh interpolation .",
    "* soften the initial / final conditions . in order to do so",
    ", one can define an average initial / final condition in the following terms : + @xmath200 where @xmath201 is a control element centered in the mesh point @xmath202 .",
    "the effect of this average is represented in figures ( [ fig15]-[fig16 ] ) .",
    "note that the hjm model under hands is only convective for variable @xmath82 ( first derivatives are null for every variable but @xmath82 ) .",
    "when @xmath167 , the solution s characteristic crosses the domain , what indicates that the boundary takes some information from inside .",
    "consequently , the discretization of both the interior and the boundary should be consistent , and then a second order scheme should be applied to the boundary discretization .",
    "we have implemented two different possibilities in the numerical scheme :    * advanced first order differences : @xmath203 * advanced second order differences : @xmath204    and quite surprisingly , no significative differences have been found between both schemes results .",
    "in this paper we have proposed a complete numerical methodology to efficiently solve a single factor hjm model with stochastic volatility .",
    "for this task we have first markovianised and reformulated the model in terms of a three dimensional pde system . the numerical method involved finite - difference and crank - nicholson schemes for the spatial and temporal discretization respectively . in order to decrease the computing time without loosing precision ,",
    "we have successfully applied adi schemes and performed a preliminary scale analysis to optimize the mesh resolution .",
    "the validation of the numerical schemes has been done comparing the numerical solution of some test curves ( zero coupon bond , caplet ) with analytical models and a heston model respectively .",
    "the goodness of the results in terms of low computation time ( order of seconds in a standard pc ) and good accuracy ( typical errors obtained either for artificial or quite realistic forward interest rate curves havent gone beyond @xmath121 in any case ) suggest that the method is suitable to be applied in realistic applications , concretely in the financial industry . + * acknowledgments * the authors thank anonymous referees for their helpful suggestions .",
    "ll acknowledges financial support from grants fis2009 - 13690 and s2009esp-1691 .",
    "31    john c. hull , _ options , futures , and other derivatives _ ,",
    "4th edition , prentice hall , ( 1999 ) .",
    "r. rebonato , interest - rate term - structure pricing models : a review , _ proc .",
    "soc . lond .",
    "a _ * 460 * , 2043 ( 2003 ) .    heath , jarrow , morton , bond pricing and the term structure of interest rates : a new methodology for contingent claim valuation , _ econometrica _ * 60 * , 1 ( 1992 ) .",
    "l. andersen and v. piterbarg , _ interest rate modeling _",
    ", atlantic financial press , ( 2010 ) .",
    "p. ritchken and l. sankarasubramanian , on markovian representations of the term structure , _ working paper series _ * 9214 * , federal reserve bank of cleveland ( 1992 ) .",
    "baxter , general interest rate models and the universality of hjm , in _ financial derivatives _ , edited by m.a.h .",
    "dempster and s.r .",
    "pliska , cup ( 1997 ) .",
    "a. caverhill , when is the short rate markovian ? , _ mathematical finance _ * 4 * , 4 ( 1994 ) .",
    "p. ritchken , l. sankarasubramanian , volatility structures of forward rates and the dynamics of the term structure , _ mathematical finance _ * 5 * , 1 ( 1995 ) .",
    "k. inui , m. kijima , a markovian framework in multi - factor heath - jarrow - morton models , _ journal of financial and quantitative analysis _ * 33 * , 3 ( 1998 ) . c. chiarella , o.k .",
    "kwon , forward rate dependent markovian transformations of the heath - jarrow - morton term structure model , _ finance and stochastics _ * 5 * , 2 ( 2001 ) . c. chiarella , o.k .",
    "kwon , finite dimensional affine realisations of hjm models in terms of forward rates and yields , _ review of derivatives research _ * 6 * , 129 - 155 ( 2003 ) .",
    "i. karatzas , s.e .",
    "shreve , _ brownian motion and stochastic calculus _",
    ", graduate texts in mathematics , 2ed , springer ( 1991 ) .",
    "duffy , _ finite difference methods in financial engineering : a partial differential equation approach _",
    ", wiley ( 2006 ) .",
    "d. tavella , c. randall , _ pricing financial instruments : the finite difference method _ , wiley ( 2000 ) .",
    "o. cheyette , markov representation of the heath - jarrow - morton model .",
    "available at ssrn : http://ssrn.com/abstract=6073 or doi:10.2139/ssrn.6073 , march 26 , barclays - san francisco , ca office ( 2001 ) .",
    "paper : v. piterbarg , tarns : models , valuation , risk sensitivities , _ wilmott magazine _ ( 2004 ) pp : 62 - 71 .",
    "r. rebonato , on the simultaneous calibration of multi - factor log - normal interest - rate models to black volatilities and to the correlation matrix , _ journal of computational finance _ * 2 * , 4 ( 1999 ) .",
    "r. rebonato , _ volatility and correlation _ , 2nd edition , john wiley & sons ( 2004 ) .",
    "p. cotton , j - p .",
    "fouque , g. papanicolaou , r. sircar , stochastic volatility corrections for interest rate derivatives , _ mathematical finance _ * 14 * , 2 ( 2004 ) .    c. chiarella , o.k .",
    "kwon , a complete markovian stochastic volatility model in the hjm framework , _ asia - pacific financial markets _ * 7 * , 4 ( 2000 ) .    http:@xmath205 .",
    "munson , _ fundamentals of fluid mechanics _ , wiley ( 2007 ) .",
    ", cambridge university press ( 2007 ) .",
    "peaceman , h.h .",
    "rachford , the numerical solution of parabolic and elliptic differential equations , _ siam _ * 3 * , ( 1955 ) pp .",
    "28 - 41 .",
    "s. mckee , d.p .",
    "wall , and s.k .",
    "wilson , an alternating direction implicit scheme for parabolic equations with mixed derivative and convective terms , _ journal of comput .",
    "_ * 126 * , 64 - 76 ( 1996 ) .",
    "g. h. klopfer , r.f .",
    "van der wijngaart , c.m . hung and j.t .",
    "onufer , a diagonalized dominant alternating direction implicit ( d3adi ) scheme and subiteration correction , _",
    "aiaa-1998 - 2824 _ ( 1998 )    k.j .",
    "hout and b.d .",
    "welfert , stability of adi schemes applied to convection - diffusion equations with mixed derivative terms .",
    ", _ applied numerical mathematics _ * 57 * , 1,19 - 35 ( 2007 ) .",
    "j. douglas , h.h .",
    "rachford , on the numerical solution of heat conduction problems in two and three space variables , _ trans .",
    "_ * 82 * , ( 1956 ) pp .",
    "421 - 439 .",
    "steger , implicit finite difference simulation flow about arbitrary geometries with applications to airfoils , _ aiaa paper _ 77 - 665 ( 1977 ) .",
    "craig and a.d .",
    "sneyd , an alternating - direction implicit scheme for parabolic equations with mixed derivatives , _ comp .",
    "* 16 * ( 1988 ) .",
    ", width=302,height=302 ]"
  ],
  "abstract_text": [
    "<S> this paper considers the single factor heath - jarrow - morton model for the interest rate curve with stochastic volatility . </S>",
    "<S> its natural formulation , described in terms of stochastic differential equations , is solved through monte carlo simulations , that usually involve rather large computation time , inefficient from a practical ( financial ) perspective . </S>",
    "<S> this model turns to be markovian in three dimensions and therefore it can be mapped into a 3d partial differential equations problem . </S>",
    "<S> we propose an optimized numerical method to solve the 3d pde model in both low computation time and reasonable accuracy , a fundamental criterion for practical purposes . </S>",
    "<S> the spatial and temporal discretization are performed using finite - difference and crank - nicholson schemes respectively , and the computational efficiency is largely increased performing a scale analysis and using alternating direction implicit schemes . several numerical considerations such as convergence criteria or computation time are analyzed and discussed .    quantitative finance , computational finance , numerical methods for pde </S>"
  ]
}