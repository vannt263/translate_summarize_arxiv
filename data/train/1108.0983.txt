{
  "article_text": [
    "assuming that we have a global model and a regional model of higher accuracy defined in a subregion inside the global region , we aim to produce a forecast which is better than the one from each model by using information from both models .",
    "we test two data assimilation methods .",
    "the first method is based on techniques most commonly used in current practice and has recently been tested in @xcite . in this method , the global and the regional data assimilations are done separately , and the regional model receives information from the global model through the boundaries during the integration phase , but the global model does not receive information from the regional model . the second method , which we call the joint state method , is proposed in this paper . in this method , the global and regional data assimilations are coupled simultaneously using information contained in both the global and the regional forecast states , and the regional model receives information from the global model through the boundaries during the integration phase as in the separate analysis method .",
    "we use the local ensemble transform kalman filter ( letkf ) algorithm for data assimilation .",
    "this algorithm allows efficient implementation of the localization technique proposed by @xcite . in order to test our global / regional assimilation techniques we use numerical experiments based on simple atmospheric ` toy ' models proposed in @xcite in conjunction with simulated observations",
    "we compare results of our joint state method and results of the separate analysis method .",
    "we find that better forecasts are produced by using the joint state method than by using the separate analysis method .",
    "we note that our proposed scheme would most likely be of potential interest for centers , where both global and limited area forecasts and analyses are prepared .",
    "the organization of the paper is the following .",
    "section  [ model ] introduces the atmospheric toy models that we use .",
    "section  [ analysis ] describes the data assimilation schemes by the joint state method and by the separate analysis method .",
    "section  [ integration ] describes how the regional model is coupled to the global model at the boundaries of the subregion during the integration phases of forecast cycles .",
    "section  [ results ] compares the results of our joint state method to those of the separate analysis method .",
    "section  [ conclusion ] gives further discussion and summarizes our conclusions .",
    "@xcite introduced three simple , spatially discrete , 1-dimensional models that have been proven to be useful for testing weather data assimilation methods . here",
    "we will use lorenz s model 2 ( which shows smooth propagating waves ) and the more refined lorenz model 3 ( which shows small scale activities on top of smooth waves ) .",
    "lorenz model 3 is the following equation for the evolution of a scalar state variable @xmath0 at spatial location @xmath1 , @xmath2_{k , n } + b^2 [ y , y]_{1,n } + c [ y , x]_{1,n } - x_n -b y_n + f,\\label{z}\\ ] ] where @xmath1 is an integer , @xmath3 , and @xmath4 , @xmath5 , and @xmath6 are parameters , and a periodic boundary condition is used ( @xmath7 ) .",
    "the convention of index counting starting from 0 is used throughout this paper .",
    "@xmath8-component vectors @xmath9 and @xmath10 are defined as @xmath11 where the prime notation on @xmath12 signifies that the first and the last terms in the summation are divided by two , and @xmath13 is a parameter .",
    "the bracket of any two vectors @xmath9 and @xmath10 is defined as @xmath14_{k , n } = & \\sum_{j =- j}^{j } { } ' \\sum_{i =- j}^{j } { } ' ( -x_{n-2k - i } y_{n - k - j}\\nonumber\\\\ & + x_{n - k+j - i } y_{n+k+j } ) / k^2\\label{bracket}\\end{aligned}\\ ] ] when @xmath15 is even , and @xmath12 is replace by @xmath16 when @xmath15 is odd ; @xmath17 when @xmath15 is even , and @xmath18 when @xmath15 is odd , where @xmath15 is a parameter .",
    "model 3 reduces to model 2 when @xmath19 .",
    "in particular , for @xmath19 , eq .  ( [ x ] )",
    "yields @xmath20 , which by eq .",
    "( [ y ] ) implies that @xmath21 .",
    "thus , after changing notation , @xmath22 and @xmath23 , we obtain @xmath24_{k , m } - z_m + f,\\label{model2}\\ ] ] where @xmath25 is used to denote a point on the coarser grid of the global model .",
    "we use lorenz model 3 with parameter values @xmath26 to generate our simulated true dynamics , and lorenz model 2 with @xmath27 for the global model defined at every fourth grid point of the true model ( @xmath28 ) .",
    "thus the grid points for eq .",
    "( [ model2 ] ) occur at @xmath29 , where @xmath30 .",
    "we assume that , between analyses , eq .  ( [ model2 ] ) for @xmath31 gives an approximation of the dynamical evolution of @xmath32 at the grid points @xmath33 .",
    "when referring to locations or lengths of regions , we use the coordinate system of the true model throughout this paper ( @xmath34 ) . for the regional model , we define a subregion extending from @xmath35 to @xmath36 grid , and use lorenz model 3 with the same parameter values as the true model . in order to integrate this regional model",
    ", we must evaluate the bracket quantities on the right hand side of eq .",
    "( [ z ] ) defined by eq .",
    "( [ bracket ] ) . for @xmath1 too close to @xmath37 ( @xmath38 ) this involves @xmath9 , @xmath10 , and @xmath39 values at grid points outside the subregion , @xmath40 ( @xmath41 ) . also , from eq .",
    "( [ x ] ) , @xmath42 in the regional model ( and hence also @xmath43 ) depends on @xmath44 values in @xmath45 ( @xmath46 ) if @xmath1 is within a distance @xmath13 of @xmath37 ( @xmath38 ) . to evaluate these quantities , we use estimates of the required values of @xmath44 obtained from interpolation of the global values @xmath31 onto the @xmath1-grid",
    ". these interpolations essentially play the role of boundary conditions for the regional model .",
    "we selected 15 evenly spaced observation points starting from @xmath47 ( @xmath48 ) .",
    "notice that all the observation points are at grid points defined in the global model .",
    "we construct simulated observations by adding random noise drawn from independent gaussian distributions of standard deviation 1 to the true state values at the observation points .",
    "we compare two data assimilation methods .",
    "the first method does data assimilation for the global model and the regional model separately , while the second method , which we call the joint state method , forms a combined state from the global model and the regional model and does data assimilation on the combined state .",
    "the intuition motivating our second method is that we expect the global and the regional estimates will both benefit from information exchange between them .",
    "we use letkf for both methods .",
    "see @xcite for an explanation of letkf .    for the separate analysis method , we use letkf without much modification . for the global analysis , at each grid point @xmath33 defined in the global model , we define a local patch @xmath49 $ ] of size @xmath50 with @xmath51 , use the ensemble transform kalman filter ( etkf ) to obtain an analysis for the @xmath52 state values in each patch .",
    "this yields local patch analyses for each ensemble member . as done by others ( e.g. , * ? ? ?",
    "* ) , we then use these patch analyses to form the global analysis states for each ensemble member by defining the value of the global ensemble field at each point @xmath29 to be the analysis state value of that ensemble member in the center of patch @xmath33 . for the regional analysis , at each grid point @xmath1 defined in the regional model , we define a local patch , limiting the size near the two boundaries of the subregion so that the local patch is defined only inside the subregion , use etkf , and take the patch analysis value at grid point @xmath1 .",
    "thus the global local patches always have size @xmath50 , but the regional local patches have variable sizes depending on @xmath1 . for @xmath1 located in the subregion and also far away from the boundaries ,",
    "the regional local patch has size @xmath50 , while for @xmath1 near the boundaries ( @xmath53 or @xmath54 ) , the regional local patch is the intersection , @xmath49\\cap[n_0,n_1]$ ] , and has a size less than @xmath50 .    for the joint state method",
    ", we use the same local patch size , @xmath51 . for each grid point",
    "@xmath1 defined either in the global model or in the regional model , we define a global local patch and a regional local patch ( where , as before , the regional patch is the intersection , @xmath49\\cap[n_0,n_1]$ ] , which for some @xmath33 will be empty ) . for each such grid point @xmath1",
    ", we define a vector @xmath55 by taking state values of the global local patch , and @xmath56 by taking state values of the regional local patch , and we then form a local joint state vector @xmath57 by concatenating @xmath55 and @xmath56 , i.e. , @xmath58 we also form a local observation vector @xmath59 by taking observations in the local patches ( from grid point @xmath60 to @xmath61 ) .",
    "we define a local cost function @xmath62 for grid point @xmath1 as follows , @xmath63^t \\mathsf{r}^{-1 } \\left[\\mathbf{y}^{(n)}_o-\\mathbf{h}^{(n)}(\\mathbf{x}^{(n)})\\right]\\nonumber\\\\ & + \\kappa \\left[\\mathbf{g}^{(n)}_g(\\mathbf{x}^{(n)}_g ) - \\mathbf{g}^{(n)}_r(\\mathbf{x}^{(n)}_r)\\right]^t \\left[\\mathbf{g}^{(n)}_g(\\mathbf{x}^{(n)}_g ) - \\mathbf{g}^{(n)}_r(\\mathbf{x}^{(n)}_r)\\right],\\nonumber\\end{aligned}\\ ] ] where @xmath64 and @xmath65 are the local mean and the covariance matrix of the background ensemble , respectively , @xmath66 is a local observation operator defined as @xmath67 where @xmath68 is the observation location of the @xmath69 observation in the local patch , @xmath70 is the global state value at location @xmath68 , and @xmath71 is the regional state value at location @xmath68 .",
    "@xmath72 is a vector that consists of the state values of the global state at the grid points defined both in the global and the regional local patches .",
    "similarly , @xmath73 is a vector that consists of the state values of the regional state at the grid points defined both in the global and the regional local patches . @xmath74 and @xmath75 are parameters .",
    "the third term is a constraint term that penalizes large differences between the estimates of the global and regional model states .",
    "we determine the value of x that minimizes the cost function @xmath62 with the letkf algorithm @xcite .",
    "in general , if our technique were to be applied in an operational setting , the grid points of the global and the regional models within the subregion will not coincide . in that case , to calculate the third term in @xmath62 , an interpolation from the grid points of the regional model to the grid points of the global model or vice versa could be employed before the values of the regional and the global models are subtracted .",
    "similarly , in an operational setting the observations are not at grid points , and @xmath76 would then include interpolation .",
    "we define a smoothed regional state for the initial condition of the regional model for integration between analysis times as follows .",
    "after the analysis phase , we define spatial transition intervals of length 10 starting from the boundaries and ending inside the subregion .",
    "we then modify the regional analysis values in the transition intervals by taking weighted linear averages of the global analysis values and the regional analysis values .",
    "we do this in order to make the transition between the global model and the regional model smooth at the boundaries . for @xmath1 such that @xmath77 , we modify the regional ensemble members by @xmath78 where @xmath79 and @xmath80 are the values of the @xmath81 global and regional ensemble members at grid point @xmath1 , respectively , and the subregion for the regional model is @xmath82=[240,720]$ ] .",
    "after performing the above smoothing process , we integrate each global and regional ensemble members for 6 hours using a fourth - order runge - kutta method , dividing 6 hours into 24 time steps .",
    "we integrate the global ensemble members independent of the regional ensemble members . for the integration of the regional ensemble members",
    ", we use the necessary interpolated values of the corresponding global ensemble members outside the subregion at each runge - kutta time step to synchronize the global and the regional model at the boundaries .",
    "before we tested the joint state method and the separate analysis method , we ran forecast cycles with 40 ensemble members using the global and the regional models separately and found that multiplicative covariance inflation factors of 0.024 and 0.02 for the global and the regional analyses , respectively , produce the lowest rms state estimate errors .",
    "we henceforth use these values in our data assimilations . for the joint state method",
    ", we found that @xmath83 and @xmath84 in eqs .",
    "( [ cost function ] ) and ( [ parameter b ] ) give the lowest rms state estimate errors , and we use these values in all of our subsequent applications of the joint state method .",
    "we first tested the separate analysis method and the joint state method without boundaries .",
    "that is , we used the whole region for both the global and regional models .",
    "thus , there is no coupling between the global model and the regional model at the boundaries during the integration phases . in this setup , aside from the correlations induced by common observations in their assimilations , the separate analysis method corresponds to having independent global and regional forecasts . for the joint state method",
    ", the coupling between the global and regional models occurs only at the analysis phases .",
    "figure  [ whole region ] shows the rms errors of state estimates given by the means of the ensemble members as a function of the grid point .",
    "the values were averaged over 10000 forecast cycles , discarding the values of 1000 initial cycles .",
    "the green and the black colors correspond to the global and the regional values obtained from the separate analysis method .",
    "the blue and the red colors correspond to the global and the regional values obtained from the joint state method .",
    "error minima occur at the observation points .",
    "the figure shows that the two regional rms errors are almost the same , while the global rms errors from the joint state method are much lower than the global rms errors of the separate analysis case indicating that , as one would expect , the information from the regional model substantially improved the estimate of the global model .",
    "now , we take a subregion @xmath82=[240 , 720]$ ] , and introduce coupling between the global model and the regional model at the two boundaries during the integration phase . figures  [ subregion](a ) and [ subregion](b ) show the rms errors of the analysis and of a 1 day forecast , respectively , using the same color scheme as in fig .",
    "[ whole region ] .    .",
    "the additional purple curves show the rms - error values when assimilations were done globally using the true model ( lorenz model 3 ) .",
    "the two vertical dashed lines at grid points 240 and 720 indicate the boundaries of the subregion . ]",
    "the two vertical dashed lines at grid points 240 and 720 indicate the boundaries of the subregion .",
    "the additional purple curves show the rms - error values in the perfect model scenario in which the forecast model was the true model ( lorenz model 3 ) which was used globally throughout the entire space . we view this as setting a standard for the best that could ever be done .",
    "these figures show that the joint state method performs better than the separate analysis method for both the global prediction and the regional prediction .",
    "we note that the global forecast obtained from the joint state method is better than the corresponding one from the separate analysis method even outside the subregion .",
    "this can be explained by the fact that the better global state estimates inside the subregion at the analysis phases can make better forecasts outside the subregion during the integration phases , and these better forecasts outside the subregion can make the regional forecasts better inside the subregion by providing better information at the boundaries during the integration phases .",
    "we also note that the global analysis improvements that result from use of the joint state method are greater to the right of the subregion than to its left .",
    "this is consistent with the fact @xcite that , for these models , waves ( and hence the information they carry ) have group velocities that are predominantly rightward .",
    "in this paper we formulated a joint state method for regional forecasting .",
    "using simulations employing simple models , we have numerically tested our method by comparing analysis and forecast results obtained using our method with results obtained using a separate analysis method .",
    "we found that the global forecast in the whole region and the regional forecast in the subregion are both noticeably improved when the joint state method is used compared to when the separate analysis method is used .",
    "this work suggests several topics for future work .",
    "most importantly , will the encouraging results from experiments using our lorenz model set - up continue to apply when tests on real situations are done ?",
    "what is the effect of regional model error ?",
    "what are the benefits of applying our coupled analysis scheme to situations with multiple ( perhaps overlapping ) regional analyses ?",
    "this work was supported by nsf grant atm-0935538 and onr grant n000140910589 .",
    "ott , e. , hunt , b.  r. , szunyogh , i. , zimin , a.  v. , kostelich , e.  j. , corazza , m. , kalnay , e. , patil , d.  j. and yorke , j.  a. 2004 .",
    "a local ensemble kalman filter for atmospheric data assimilation .",
    "_ tellus _ * 56a * ,  415428 ."
  ],
  "abstract_text": [
    "<S> we propose a data assimilation scheme that produces the analyses for a global and an embedded limited area model simultaneously , considering forecast information from both models . </S>",
    "<S> the purpose of the proposed approach is twofold . </S>",
    "<S> first , we expect that the global analysis will benefit from incorporation of information from the higher resolution limited area model . </S>",
    "<S> second , our method is expected to produce a limited area analysis that is more strongly constrained by the large scale flow than a conventional limited area analysis . </S>",
    "<S> the proposed scheme minimizes a cost function in which the control variable is the joint state of the global and the limited area models . </S>",
    "<S> in addition , the cost function includes a constraint term that penalizes large differences between the global and the limited area state estimates . </S>",
    "<S> the proposed approach is tested by idealized experiments , using ` toy ' models introduced by lorenz in 2005 . </S>",
    "<S> the results of these experiments suggest that the proposed approach improves the global analysis within and near the limited area domain and the regional analysis near the lateral boundaries . </S>",
    "<S> these analysis improvements lead to forecast improvements in both the global and the limited area models . </S>",
    "<S> +   +   + </S>"
  ]
}