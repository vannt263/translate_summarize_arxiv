{
  "article_text": [
    "the primary motivation to develop the presented techniques and perform the associated investigations is the need for the efficient simulation of nonlinear dynamical systems .",
    "numerical integration of nonlinear field equations is a difficult problem even if the metric is fixed .",
    "an obvious complication is that the field propagates in infinite space - time , but the computational resources are finite .",
    "fortunately , infinity can be brought to finite distance by compactifying space - time , with a conformal rescaling of the metric @xcite .",
    "a well - chosen coordinate transformation can also increase the efficiency of numerical calculations . however , a good transformation is often hard to find , especially when time evolution changes the system drastically , or in the presence of more than two different scales .",
    "some examples are black hole formation , black hole merger , compact binary stars , etc .",
    "the sizes of such gravitational radiation sources are very small compared to the produced wavelength , which is much smaller than the distance from the detector .",
    "different length scales must be considered simultaneously , but it is extremely hard if time evolution is simulated on a uniform grid . adaptive mesh refinement ( amr ) algorithms overcome these difficulties by using a coarse base grid which is refined automatically at `` interesting '' locations for more precise calculation @xcite .",
    "the precision also depends on the order of numerical schemes used . according to hbner ,",
    "fourth order calculations are at least two orders of magnitude more efficient than second order @xcite .",
    "nevertheless , only second order calculations are known to be used by amr codes in numerical relativity so far , although several implementations of the algorithm were developed since choptuik s pioneering work @xcite .",
    "our choice of the fourth order runge - kutta scheme is also supported by the result of hansen , khokhlov and novikov .",
    "they found that among the methods they investigated , this is the most efficient one in terms of accuracy and dissipation @xcite .",
    "problems where gravity is coupled to matters fields are complicated to start with , thus the code will be applied first to study simpler systems , physical fields in flat space - time .",
    "the simplest possible massive field is the free klein - gordon field , the time evolution of which is investigated in case of spherical symmetry in this paper .",
    "this system is known to provide certain surprises in numerical simulations @xcite , moreover there is a straightforward means of checking the efficiency of the developed numerical method by making use of the analytic solution to the initial value problem .",
    "however , in contrast to the usual scenarios , there is no compact central object in this system that could keep any part of the initial disturbance from radiating away . instead of studying the central region where vibration with decreasing amplitude is left behind ,",
    "the aim is the simulation of the field at larger distances , where a hypothetical detector could be placed . as the wave propagates outwards and approaches @xmath0 , its wavelength approaches zero , partly due to a physical effect @xcite , partly because of the space compactification .",
    "hence for an accurate simulation of the long - range behavior , finer and finer subgrids are needed as the wave gets closer to @xmath0 .",
    "interaction will be included in forthcoming studies .",
    "plans include the verification of earlier numerical results on the logarithmic decay of @xmath1 breathers @xcite and the study of excitations of bogomolnyi - prasad - sommerfield magnetic monopoles . in the latter case",
    ", a previous study @xcite will be extended by the inclusion of the higgs field s self interaction . in both of these settings ,",
    "nonlinear massive fields evolve in fixed minkowski space - time .",
    "the code is based on the berger - oliger algorithm @xcite . at the initial time ( @xmath2 )",
    ", it starts with a uniform grid , where the values in the grid points are determined by the initial condition . based on local error estimations of the first integration step ,",
    "child grids may be generated and filled with values of the initial condition function .",
    "this procedure is applied recursively , until either the local error becomes lower than the chosen tolerance in each point or the maximum refinement level is reached . in later integration steps ,",
    "if a refinement level contains point(s ) with relatively large errors , then finer levels are regridded in child to parent order ( finest first ) .",
    "when a level is regridded , new points are interpolated using old points from the same level and the parent level .",
    "the same refinement ratio @xmath3 is used on each level . for the refinement criteria , richardson error estimation of an arbitrarily chosen function @xmath4",
    "the grid is refined if @xmath5 where @xmath6 is the numerical integration operator , @xmath7 , @xmath8 is the order of the method , @xmath9 is the field and @xmath10 is the error tolerance ( see @xcite ) .",
    "the exact form of @xmath4 proved to be irrelevant , provided that it has an approximate linear dependence on the field components .",
    "for example , the square root of the energy density was a good choice in klein - gordon simulations , but the value of field @xmath9 was equally good . for simplicity ,",
    "i choose the latter in all simulations .",
    "to reach high precision in the numerical calculations , only symmetric finite difference and interpolation schemes are used whenever it is possible .",
    "space interpolation is simplified by aligning new subgrids with their parent grid .",
    "time interpolation can be avoided in one space dimension , because it is possible to apply relatively large grid margins without noticeable efficiency loss .",
    "the initial subgrid margin is proportional to @xmath3 and it shrinks in each step , until the time becomes equal to the time on the enclosing coarser grid .",
    "( see fig .",
    "[ rk4r2.fig ] . ) then the new values on the margin are determined by space interpolation .",
    "because of the above - mentioned proportionality , @xmath3 should not be too large , otherwise the large margin sizes could result in unnecessary slowdown . in case of a larger refinement ratio , less refined levels are needed for the same precision , but a smaller @xmath3 has the benefit that the mesh can adapt more closely to the solution . in my tests , simulations using double refinement were slightly more efficient ( by about 5% ) than triple refinement , thus i choose @xmath11 .    for time and space",
    "discretization , the same order of accuracy was used .",
    "second order runge - kutta time integration with second order space discretization and third order space interpolation , fourth order runge - kutta with fourth order space discretization and fifth order interpolation .",
    "the presented numerical results are calculated in fourth order .",
    "a fourth order centered finite difference scheme uses 5=2 + 1 + 2 points , thus the numerical error propagates 2 points in each step",
    ". however , to avoid instabilities , an artificial dissipation term containing the sixth order sixth derivative was also applied  @xcite : @xmath12 where i used @xmath13 .",
    "it increases error propagation velocity to 3 points per step .",
    "therefore refined grid margins must be shrunk by 3 points in each step .",
    "the fourth order runge - kutta method consists of 4 substeps , thus the overall loss of refined margin points is @xmath14 in a coarse time step , see fig .",
    "[ rk4r2.fig ] .",
    "however , a 24-point wide margin would not be sufficient if the refined and the coarse grid have their origins ( zero index points ) or right edges at the same location .",
    "after a coarse time step , the coarse margin shrinks to 24 - 12=12 points .",
    "although the leftmost refined margin point ( with index @xmath15 ) coincides with the leftmost coarse margin point ( @xmath16 ) at this time , its neighbor ( @xmath17 ) is not in a lucky position , it must be interpolated from coarse margin points .",
    "fifth order centered interpolation requires 3 points on both sides , but there is only one coarse point ( @xmath16 ) on the left side in this case .",
    "choosing a slightly wider initial margin , with at least 28 points , can solve this problem .",
    "then the coarse margin shrinks to 28 - 12=16 points which is enough to interpolate all refined margin points .    for the fifth order interpolation of field values at point @xmath18 ,",
    "the following formula is used : @xmath19 where @xmath20 , ... , @xmath21 are the indexes of the six known points ( from the coarse grid and the previous refined grid ) and @xmath22 , ... , @xmath23 are coefficients .",
    "the 6 coefficients are determined by fixing the function values , the derivatives and the second derivatives in points @xmath24 and @xmath25 .",
    "( derivatives are approximated in fourth order of accuracy from 2 + 1 + 2 points . )",
    "their values depend on the distance ( and existence ) of the nearest old fine grid .",
    "[ o5interpolation.tbl ]    the possible cases are shown in table  [ o5interpolation.tbl ] .",
    "a free , spherically symmetric klein - gordon field is described by the equation @xmath26 where @xmath27 is the mass parameter and minkowski metric is used , @xmath28 .",
    "fodor and rcz @xcite have shown that for arbitrary initial data with compact support the evolution of this system can be characterized by the formation of self similarly expanding shells built up of high frequency oscillations : @xmath29 where @xmath30 are the contours of the shells ; the form of this function depends on the initial condition .",
    "an important property of this solution is that both the frequency and the wave number of oscillations on the outer shell grows proportionally to @xmath31 . to prove it , we determine these quantities as the partial derivatives of the cosine s argument : @xmath32 the outer edge expands with the velocity of light , @xmath33 , hence the frequency in a short distance @xmath34 from the outer edge is approximately equal to the wave number , their values can be estimated using the following formula : @xmath35    to remove the @xmath36 coordinate singularity from eq .",
    "[ freekg.eq ] , the `` unphysical '' field @xmath37 is used instead of @xmath38 .",
    "space is compactified using a transformation as in refs.@xcite : @xmath39 where @xmath40 and @xmath41 .    to simplify numerical calculations ,",
    "the second derivatives are removed from the field equation by introducing the partial derivatives of @xmath9 as new variables @xmath42 and @xmath43 . then the field equation ( [ freekg.eq ] )",
    "can be written as a system of 3 first order partial differential equations and a constraint condition : @xmath44 _ boundary conditions .",
    "_ for the numerical calculation of derivatives near @xmath45 , information on the parity properties of the functions must be applied . whenever the field @xmath38 is smooth",
    ", it has to be an even function of @xmath46 .",
    "hence @xmath9 and @xmath42 are odd and @xmath43 is even : @xmath47 the behavior of function @xmath9 near the other boundary is also important for similar reasons .",
    "the field @xmath38 vanishes in @xmath0 , thus the function values for @xmath48 points are supposed to vanish too : @xmath49 the initial condition is a smooth , motionless hunch on the @xmath50 hypersurface : @xmath51 in the simulations , i used a hunch at @xmath52 , with parameters @xmath53 , @xmath54 ( center of hunch in @xmath3 ) , @xmath55 ( half - width in @xmath3 ) , @xmath56 and @xmath57 .",
    "this disturbance is initially close to the origin , thus it is expected to reach @xmath0 , the future null infinity , at about @xmath58 like the null geodesic denoted by dashed line on fig .",
    "[ penrose.fig ] .",
    "the simulations reproduced the most important feature of the analytical result by fodor and rcz @xcite , the self similarly expanding shells built up of higher frequency oscillations .",
    "the amplitudes of these high frequency `` carrier waves '' are modulated by the @xmath59 function in eq .",
    "( [ phi.shells.eq ] ) . as the shells expand and approach @xmath0 , the",
    "_ @xmath46-length _",
    "( the wavelength in @xmath46 coordinate units ) of the carrier wave approaches zero , thus finer and finer grids are needed to simulate its propagation .",
    "accordingly , to zoom into the vicinity of @xmath60 , the number of refinement levels must be increased , see fig .",
    "[ timeslice5.fig ] .    at @xmath2 , the grid",
    "is only refined in a small range enclosing the initial hunch .",
    "then the refinement follows the @xmath38 waves , it moves outwards and expands .",
    "when the waves approach @xmath0 , the peak of the refinement level function begins to increase , see fig .",
    "[ meshref.fig ] .",
    "since the exact solution of the current problem is known , it might be possible to replace mesh refinement by a uniform mesh together with a clever time dependent coordinate transformation . the mesh refinement structure shown on fig .",
    "[ meshref.fig ] foreshadows the complications in finding such a transformation in space ; a hunch like this can not be smoothed using a simple , monotonous function for @xmath61 .",
    "there are complications also for @xmath62 , because the frequency of oscillations on the outer shell increases in time ( see eq .",
    "( [ freq.outershell.eq ] ) ) .",
    "moreover , even if an easily calculable transformation exists which makes mesh refinement unnecessary , the equal time surfaces would be different with the new coordinates , making it hard to transform the results back to the @xmath63 system .",
    "_ convergence .",
    "_ the 4th order convergence of the algorithm was verified by calculating the    time dependence of the convergence factor @xmath64 where @xmath65 is the @xmath66 norm and @xmath67 is the numerical solution of function @xmath9 in case of a base grid with @xmath68 spacing .",
    "locations and sizes of refined subgrids are stored and reused in calculations with the finer base grids ( @xmath69 ) .",
    "[ convergence.fig ] shows the absolute errors and the convergence factor for some unigrid and amr simulations .",
    "the @xmath70 curves start with a plateau at a height of approximately @xmath71 , proving fourth order convergence .",
    "however , the order of convergence falls off near @xmath58 because of the abrupt increase of absolute error when the wave reaches future null infinity ( @xmath0 ) and the @xmath46-length of oscillations reaches zero , making even the finest mesh resolution insufficient .",
    "_ energy conservation _ is violated numerically as the @xmath46-length of waves approaching @xmath0 decrease below grid resolution . to check this ,",
    "the following quantity is calculated instead of total energy : @xmath72 where @xmath10 is the energy density and @xmath73 is the energy flow .",
    "numerically lost energy is mostly contained in the second term . by substituting @xmath74",
    ", we get the total energy which is not conserved numerically . to `` restore energy conservation '' at a given @xmath75",
    ", @xmath76 must be decreased .",
    "both @xmath77 and @xmath76 have a critical value below which energy is conserved with acceptable precision : @xmath78 , where @xmath79 . above the critical values ,",
    "energy is lost : @xmath80 .",
    "[ energy.fig ] shows the energy contour lines on the @xmath81 plane where only 95% or 99% of the initial energy is conserved : @xmath82 .",
    "the conservation bound can be pushed outwards both in @xmath76 and @xmath77 by increasing the number of refinement levels .",
    "_ central range .",
    "_ as time evolves , the wave packet propagates outwards , leaving less and less matter in the center .",
    "the amplitude of oscillations decrease asymptotically as @xmath83 ( see refs .",
    "function @xmath9 and its derivatives also decrease , thus one may suppose that a unigrid simulation is enough here .",
    "i tested this assumption by performing unigrid ( 256 , 512 and 4096 points ) and amr simulations ( 256 points on base grid , 1 and 4 refinement levels ) .",
    "errors and the norm of function @xmath9 were calculated by restricting integrations to @xmath84 .",
    "most of the matter leaves this range before @xmath85 , thus function @xmath9 becomes `` smoother '' and the grid is not refined at later times here .",
    "consequently , the error of the @xmath86 unigrid and the same base resolution amr simulations are close for a while .",
    "however , the unigrid error starts to increase much faster at about @xmath87 .",
    "this abrupt degradation proves that error can propagate inwards from outside ( @xmath88 ) .",
    "hence the unigrid error is only `` acceptable '' for @xmath89 , while the 4-level amr calculation reaches the same level of inaccuracy much later , at about @xmath90 .",
    "see the curves with labels `` @xmath91 '' and `` @xmath92 '' on fig .  [ error_near_centre.fig ] .",
    "on the same plot , it can also be seen that the error of a high precision unigrid run is smaller than that of the corresponding amr with the same maximum precision .",
    "compare the curve labeled with `` 512 '' ( unigrid ) to the `` @xmath93 '' curve ( amr , 1.5 times faster ) , and `` @xmath94 '' to `` @xmath92 '' ( amr , 4 times faster ) .",
    "however , the amr error curve increases much slower than the unigrid error curve , hence they meet at a certain time after which amr is more accurate .",
    "if the amr error tolerance is small enough , then the error at their meeting point is also small",
    ".    note that by restricting attention to the central range in @xmath46 , a much longer simulation was possible in @xmath75 .",
    "this feature can also be seen on the energy conservation curves on fig .",
    "[ energy.fig ] , where @xmath77 increases when @xmath76 is decreased .",
    "[ speed.tbl ]    _ speed tests . _",
    "the time of a unigrid simulation is proportional to the total number of grid points in the spacetime domain : @xmath95 where @xmath96 is the grid spacing and @xmath97 is the number of dimensions of the spacetime grid , @xmath98 in this case .",
    "when using amr , the same resolution can be reached much faster because only a small part of the grid is refined . in case of 10 refinement levels , amr would be two orders of magnitude faster than a corresponding unigrid run .",
    "amr / unigrid run time ratios can be approximated by calculating the ratio of the total number of grid points in the spacetime domain ( @xmath99 for unigrid and @xmath100 for amr ) , then adding the overhead ( @xmath101 ) of the amr algorithm .",
    "the @xmath102 formula is a good approximation for the measured times in table  [ speed.tbl ] , in case of 5 or more refinement levels .",
    "the formula ( [ runtimefit.eq ] ) can be fitted nicely to amr run times also .",
    "these fittings were performed at constant error tolerance values ( @xmath103 , @xmath104 and @xmath105 ) for simplicity .",
    "the result is that for small @xmath77 values , the `` effective dimension '' @xmath97 increases with @xmath77 until a plateau is reached near @xmath106 , at a height of @xmath107 .",
    "further testing was performed with nonlinear 1 dimensional klein - gordon fields and periodic boundary conditions , @xmath108 , by adding a fourth order self interaction term to the lagrangian : @xmath109 the initial condition at @xmath110 is the motionless hunch used earlier in eqs .",
    "( [ f.inithunch.eq]-[ft.inithunch.eq ] ) but substituting @xmath3 by @xmath111 , @xmath9 by @xmath38 , @xmath42 by @xmath112 and using the parameter values @xmath113 , @xmath114 , @xmath115 , @xmath116 .",
    "test problems include massive ( @xmath117 , @xmath118 and @xmath119 , @xmath120 ) , massless ( @xmath121 ) , free ( @xmath122 ) cases and the sine - gordon field : @xmath123 in each of these cases , the initial hunch at @xmath124 splits and its two parts propagate in opposite directions . at @xmath125",
    "they reach the periodic boundaries @xmath126 where they pass through each other .",
    "they meet again at @xmath127 , almost restoring the initial state but in a distorted form . as a consequence of the translation invariance and the lack of nonlinear coordinate transformations , the derivatives and the numerical error",
    "do not increase substantially during the movement of the hunches , the number of required mesh refinement levels for a given error tolerance is determined by the initial state and preserved later .",
    "another test was performed with the @xmath1 breather described by the lagrangian : @xmath128 for the numerical simulation of this system , i compactified space using the same transformation as earlier in eq .",
    "( [ coords.tr.eq ] ) , @xmath129 with @xmath53 .",
    "time @xmath130 is not transformed .",
    "the initial condition is the same as that used by geicke @xcite , it contains a kink and an antikink in @xmath131 .",
    "the radiation of the initial `` kick '' involves the outwards propagation of a wave with decreasing @xmath46-length . as it propagates outwards , more and more levels of refinement",
    "are activated until it vanishes ( in @xmath132 if the base grid spacing is @xmath133 ) .",
    "then only the smooth , stable , oscillating wave remains near the origin and refinement is no longer needed .",
    "i performed simulations without further energy loss until @xmath134 using a @xmath135 base grid .",
    "however , i found energy loss in case of finer base grids .",
    "i also found that increased precision in the simulation of the initial radiation does not necessarily increase precision near the origin in the long run .",
    "the same amount of energy disappears with the same rate if mesh refinement is not used at all in case of @xmath136 and @xmath137 .",
    "further experimenting is needed for the verification of the statement of geicke @xcite about the logarithmic decay of this system .",
    "a new amr code was developed for integrating field equations numerically in time .",
    "it is tested thoroughly using fourth order runge - kutta method and fourth order space discretization , but it is also possible to use other numerical schemes .",
    "the main test problem is the simulation of a spherically symmetric klein - gordon field in a special coordinate system ( [ coords.tr.eq ] ) with compactified space coordinate .",
    "the exact solution of this problem is known , thus it is possible to calculate the absolute error of the numerical simulation . by calculating the errors of amr simulations with different base grid spacings ,",
    "the fourth order convergence of the algorithm was shown .",
    "the numerical violation of energy conservation was also investigated ; i determined the space - time boundaries of the `` well - behaving '' range .",
    "inside this space - time volume , the sum of the total energy and its integrated outgoing flux is constant with an acceptable precision . the time boundary @xmath77 is a monotonically decreasing function of the maximum space",
    "coordinate @xmath76 ( see fig .",
    "[ energy.fig ] ) .",
    "it means that energy is conserved numerically for longer time if a smaller central range is examined in space .",
    "the error of the simulation behaves similarly ; longer runs can be `` closer '' to the exact solution if the error norm is calculated only in a small central range .",
    "the speed of the algorithm was also tested , in case of 10 refinement levels the amr algorithm was two orders of magnitude faster than the extrapolated time of the corresponding unigrid run .",
    "i would like to thank istvn rcz and gyula fodor for the suggestions , especially for the initial idea to develop an amr code .",
    "i also thank them for the stimulating discussions .",
    "00 j. frauendiener , living rev .",
    "relativity * 7 * ( 2004 ) 1 .",
    "m. j. berger and j. oliger , j. comput .",
    "* 53 * ( 1984 ) 484 - 512 .",
    "p. hubner , class .",
    "* 16 * ( 1999 ) 2823 - 2843 . m. w. choptuik , phys . rev . lett . * 70 * ( 1993 ) 9 - 12",
    ". j. hansen , a. khokhlov , i. novikov , int .",
    "* d13 * ( 2004 ) 961 .",
    "g. fodor and i. rcz , phys",
    "* d68 * ( 2003 ) 044022 .",
    "j. geicke , phys . rev .",
    "* e49 * ( 1994 ) 3539 - 3542 . g. fodor and i. rcz , phys",
    "* 92 * ( 2004 ) 151801 .",
    "v. moncrief , proc . of the workshop on mathematical issues in numerical relativity , santa barbara ( 2000 ) , http://online.itp.ucsb.edu/online/numrel00/moncrief/ s. hod and t. piran , phys",
    "* d58 * ( 1998 ) 044018 ."
  ],
  "abstract_text": [
    "<S> numerical evolution of the spherically symmetric , massive klein - gordon field is presented using a new adaptive mesh refinement ( amr ) code with fourth order discretization in space and time , along with compactification in space . </S>",
    "<S> the system is non - interacting thus the initial disturbance is entirely radiated away . </S>",
    "<S> the main aim is to simulate its propagation until it vanishes near @xmath0 . by numerical investigations of the violation of the energy balance relations , the space - time boundaries of `` well - behaving '' </S>",
    "<S> regions are determined for different values of the amr parameters . </S>",
    "<S> an important result is that mesh refinement maintains precision in the central region for longer time even if the mesh is only refined outside of this region . </S>",
    "<S> the speed of the algorithm was also tested , in case of 10 refinement levels the algorithm was two orders of magnitude faster than the extrapolated time of the corresponding unigrid run . </S>"
  ]
}