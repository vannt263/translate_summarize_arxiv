{
  "article_text": [
    "in most single - pass free - electron laser ( fel ) facilities , the undulator line is segmented by drift sections , where instruments for beam focusing , trajectory correction and diagnostics are installed . often",
    "time , phase shifters are also installed in the drift sections  @xcite .",
    "conventional phase shifters are compact magnetic chicanes , made up of either permanent magnets or electromagnets .",
    "the magnetic chicane enables the increase of the electron path length in the drift section , thus adjusting the phase angle between the electron beam and the optical field .",
    "a common use of phase shifters is phase correction , i.e.  to make the phase angle in the preceding undulator segment equal to that in the subsequent undulator segment .",
    "this facilitates the constructive interference of the optical fields emitted in the two undulator segments . without the phase correction ,",
    "the velocity difference between electrons and light in the drift section can lead to an unwanted change in the phase angle , which causes destructive interference of the optical fields .",
    "another use of phase shifters is the suppression of the fundamental wavelength in harmonic lasing , so as to increase the spectral brightness of the desired harmonic  @xcite .",
    "in addition to phase correction and fundamental wavelength suppression , phase shifters can also be used for sustaining the energy extraction beyond the initial saturation point , thus enhancing the fel efficiency .",
    "this is achieved by applying appropriate phase jumps , purposely altering the phase angle between the electron beam and the optical field .",
    "the efficiency enhancement by this phase jump method is demonstrated numerically in refs .",
    "@xcite and  @xcite .    in this article ,",
    "we further the studies by developing a physics model of the phase jump method , and verifying it with numerical simulations .",
    "our model illustrates the particle dynamics in the longitudinal phase space , and enables a deeper understanding of the physics behind the energy extraction process .",
    "apart from the phase jump method , another common technique for fel efficiency enhancement is undulator tapering , which involves the variation of the undulator parameter and/or the undulator period along the undulator line  @xcite . in ref .",
    "@xcite , the authors highlight the similarities between phase jumps and undulator tapering . in this article",
    ", we supplement the discussion by contrasting the differences between the two techniques , with the aid of our physics model .",
    "the phase jump method is particularly useful in fel facilities with fixed - gap undulators , which can not be tapered easily . in such facilities ,",
    "phase shifters can be installed in the existing drift sections , and the drift sections can be expanded if necessary . with the phase jump method ,",
    "the fel efficiency can be enhanced without replacing all the fixed - gap undulator segments by variable - gap ones .",
    "consider an fel which comprises planar undulator segments , with a phase shifter installed in every drift section .",
    "all undulator segments have the same length @xmath0 , meaning that the distance between every two successive phase shifters is constant throughout the fel .    in the following ,",
    "we develop a one - dimension , steady - state model of the phase jump method , which sustains the growth of radiation power at the fundamental wavelength beyond the initial saturation point .",
    "in particular , we are interested in the effect of the phase jumps alone , in the absence of undulator tapering . we therefore restrict ourselves to a constant undulator period @xmath1 and a constant undulator parameter @xmath2 where @xmath3 is the absolute value of the electron charge , @xmath4 is the electron rest mass , @xmath5 is the speed of light , and @xmath6 is the peak undulator field .",
    "in addition , we assume the amplitude @xmath7 and phase @xmath8 of the optical field to be slowly varying in the course of the fel interaction .",
    "the energy of an electron can be expressed as @xmath9 , and the resonant energy @xmath10 is defined by @xmath11 where @xmath12 is the radiation wavelength .    in the case of monochromatic seeding , @xmath13 is the wavelength of the seed radiation , and @xmath14 is determined by @xmath13 through eq .",
    "( [ eq : resonance ] ) . in the case of self - amplified spontaneous emission ( sase ) , @xmath14 is determined by the energy of the incoming electron beam , and @xmath13 is determined by @xmath14 through eq .",
    "( [ eq : resonance ] ) .    with undulator tapering ,",
    "the undulator parameter @xmath15 decreases with the distance @xmath16 along the fel . according to the definition in eq .",
    "( [ eq : resonance ] ) , @xmath14 decreases with @xmath16 to retain the radiation wavelength @xmath13 . in the absence of undulator",
    "tapering , however , @xmath15 is constant . according to the definition in eq .",
    "( [ eq : resonance ] ) , @xmath14 remains constant to retain @xmath13 .",
    "in other words , the resonant energy is constant in the phase jump method .",
    "this allows us to express the energy of an electron as the relative deviation from the resonant energy , by the variable @xmath17 even though the resonant energy is constant by definition , if the electrons themselves can decrease in @xmath18 beyond the initial saturation point , they can continue to transfer energy to the optical field .      in the analysis of phase jumps , we are not interested in the absolute phase of an electron . instead , it is more convenient to consider the phase of an electron with respect to the ponderomotive potential well , given by @xmath19    let @xmath20 $ ] be the original phase of an electron at the start point of a drift section , and @xmath21 $ ] be the target phase at the end point of the same drift section .",
    "the phase jump is then the difference : @xmath22.\\ ] ]    note the sign convention that a _ positive _ @xmath23 corresponds to shifting the electron _ forward _ in @xmath24 . also , @xmath25 corresponds to mere phase correction , whereby the phase angle introduced by the electron - light velocity difference in the drift section is compensated exactly .    in practice",
    ", a conventional phase shifter applies the phase jump by increasing the electron path length .",
    "it can only shift electrons backward in @xmath24 , but not forward .",
    "thus , if the required @xmath23 is positive , we need to shift the electron backward to another potential well by a phase of @xmath26 , where @xmath27 is a positive integer .    as a side note ,",
    "this phase jump method for efficiency enhancement can , in principle , be implemented in combination with the isase technique  @xcite for bandwidth reduction .",
    "this is done by choosing a large @xmath27 , so that the optical field emitted by the electrons towards the tail of the bunch may develop correlations with the electrons towards the head of the bunch , thus increasing the coherence length .      in our model",
    "of the phase jump method , we concern ourselves with the electron dynamics in the longitudinal phase space @xmath28 . in the undulator segments , the longitudinal dynamics of an electron can be described by two equations of motion : @xmath29 a derivation of these equations is given in ref .",
    "@xcite .    in eq .",
    "( [ eq : eta ] ) , the quantity @xmath30 is the angular frequency of the synchrotron oscillation , which has the dimension of inverse length .",
    "meanwhile , @xmath31 is the bessel factor for planar undulators , with @xmath32 $ ] . by substituting eq .",
    "( [ eq : eta ] ) into the derivative of eq .  ( [ eq : psi ] ) , we can verify that the longitudinal dynamics satisfies the pendulum equation @xmath33      the equations of motion  ( [ eq : eta ] ) and  ( [ eq : psi ] ) satisfy the hamilton equations for the hamiltonian @xmath34 the electron trajectories in the longitudinal phase space @xmath28 are given by the level set of the function @xmath35 , and are shown in fig .",
    "[ fig : four_quadrants ] .    , with electron trajectories shown by the blue curves .",
    "the red curve is the _ separatrix _ , and the region enclosed by it is the _ ponderomotive bucket_. the straight lines @xmath36 and @xmath37 divide the space into four quadrants , as indicated by the roman numerals . ]    in particular , the trajectory highlighted in red is known as the _",
    "separatrix_. along the separatrix , the hamiltonian has the value @xmath38 the region enclosed by the separatrix is known as the _ ponderomotive bucket_. within the bucket , @xmath39 .",
    "the trajectories are closed orbits , and the electrons are _",
    "trapped_. outside the bucket , @xmath40 .",
    "the trajectories are unbounded , and the electrons are _",
    "detrapped_.    the maximum @xmath18 value along the separatrix gives the half - height of the bucket , @xmath41 invoking the definition of the synchrotron frequency in eq .",
    "( [ eq : syncfreq ] ) , we obtain the proportionality @xmath42 meaning that the bucket half - height @xmath43 increases with the optical field amplitude @xmath7 .    in fig .",
    "[ fig : four_quadrants ] , the horizontal line @xmath36 and the vertical line @xmath37 divide the longitudinal phase space into four quadrants , as indicated by the roman numerals .",
    "in quadrants i and ii , @xmath44 . in quadrants iii and iv , @xmath45 . according to eq .",
    "( [ eq : eta ] ) , this implies @xmath46 in quadrants i and ii , and @xmath47 in quadrants iii and iv . in other words , electrons decelerate in quadrants i and ii , and accelerate in quadrants iii and iv . due to the conservation of energy , energy is transferred to the optical field in quadrants i and ii , and energy is absorbed from the optical field in quadrants iii and iv .    in quadrants",
    "i and iv , @xmath48 . in quadrants",
    "ii and iii , @xmath49 . according to eq .",
    "( [ eq : psi ] ) , this implies that electrons have increasing @xmath24 in quadrants i and iv , and decreasing @xmath24 in quadrants ii and iii .",
    "the essence of the phase jump method is microbunch deceleration .",
    "the aim is to decelerate the microbunched beam after the initial saturation , so that it can continue to radiate coherently .",
    "thus , the phase jumps should commence in the vicinity of the initial saturation point , where the microbunching is fully developed .    in the exponential regime , the phase shifters",
    "should be configured for @xmath25 , or there will be disruption in the microbunching development . for sase fels in particular ,",
    "applying phase jumps in the exponential regime can also lead to a red or blue shift in the radiation wavelength , depending on the positions and magnitudes of the phase jumps  @xcite .          to analyze the microbunch deceleration , it is convenient to follow the motion of an average particle within the microbunch @xmath50 .",
    "let @xmath51 be the coordinates of the average particle in the longitudinal phase space .",
    "they can be defined as @xmath52 where @xmath53 is the number of particles in @xmath50 .",
    "microbunch deceleration takes place in quadrants i and ii , where particles decelerate and transfer energy to the optical field ( see fig .  [ fig : four_quadrants ] ) .",
    "thus , the general principle of the phase jump method is to maximize the time that the average particle spends in the deceleration quadrants ( i and ii ) , and minimize the time that the average particle spends in the acceleration quadrants ( iii and iv ) .    in the longitudinal phase space @xmath28 ,",
    "a phase jump moves a particle horizontally .",
    "if the average particle lies in quadrant iv , then we should choose a phase jump that moves it into quadrant i. if it lies in quadrant iii , then we should move it into quadrant ii . if it lies in quadrant ii but is about to enter quadrant iii , then we should move it to a slightly larger phase within quadrant ii ( i.e. away from quadrant iii ) .",
    "the mechanism is illustrated in fig .",
    "[ fig : decel_cycle ] .",
    "suppose that the average particle has an original phase @xmath54 at the start point of a drift section , as indicated by position 1 .",
    "we then apply a phase jump @xmath55 , so that the average particle arrives at a target phase @xmath56 at the end point of the drift section , as indicated by position 2 .    at position 2",
    ", the electrons enter an undulator segment , and follow the phase space trajectories described by eqs .",
    "( [ eq : eta ] ) and  ( [ eq : psi ] ) .",
    "in particular , the average particle follows the blue solid curve .",
    "so long as @xmath57 , the microbunch decelerates , and transfer energy to the optical field . during this energy transfer ,",
    "the optical field amplitude @xmath7 increases slowly , and the bucket half - height @xmath43 increases slowly according to the proportionality  ( [ eq : h_propto_e0 ] ) .",
    "the average particle then arrives at position 3 , as it reaches the end point of the undulator segment .",
    "depending on the length @xmath0 of the undulator segment , position 3 can be located in either quadrant ii or iii . in quadrant iii , where @xmath58 , the microbunch absorbs energy from the optical field .    within the undulator segment , @xmath59 and @xmath60 of the average particle have changed by @xmath61 and @xmath62 , respectively .",
    "provided that @xmath63 , the microbunch has a net deceleration , and hence a net energy transfer to the optical field .",
    "the end point of the undulator segment is also the start point of the next drift section .",
    "we can then repeat this microbunch deceleration cycle , by taking position 3 of the old cycle as position 1 of the new cycle .",
    "the cycle can continue until the end of the last undulator segment .    as the cycle continues , the microbunch moves towards the bottom of the ponderomotive bucket .",
    "close to the bottom of the bucket , further phase jumps will move the microbunch out of the bucket .",
    "in other words , we can divide the energy extraction process beyond the initial saturation point into three main stages : ( i ) the in - bucket regime , ( ii ) the out - of - bucket regime , and ( iii ) the final saturation regime .    with an appropriate choice of the target phase @xmath64 in every phase jump",
    ", we can have @xmath63 in every undulator segment between the initial saturation and the final saturation .",
    "obtaining the precise value of the optimal @xmath64 is a matter of empirical phase scan .",
    "but from a theoretical perspective , there are general criteria for a good choice of @xmath64 within the deceleration quadrants .",
    "the in - bucket regime is the first stage beyond the initial saturation point . at this stage ,",
    "microbunch deceleration takes place along the closed orbits within the ponderomotive bucket .      in the single - cycle microbunch deceleration illustrated in fig .",
    "[ fig : decel_cycle ] , the energy extraction is the most efficient if the average particle stays within the deceleration quadrants throughout the entire undulator segment , and never manages to enter quadrant iii . for this to be the case , the chosen target phase @xmath64 must satisfy the criterion @xmath65    in order to proceed from here , we obtain an expression for @xmath66 by integrating both sides of eq .",
    "( [ eq : psi ] ) with respect to @xmath16 over one undulator segment .",
    "this yields @xmath67 within the undulator segment , we expect the average particle to decelerate , and @xmath68 should therefore be more negative than the original value @xmath69 right before the undulator segment .",
    "hence , @xmath70 ) and  ( [ eq : delta_psi_segm ] ) , we obtain the lower bound @xmath71 for the choice of @xmath64 : @xmath72 when configuring each phase shifter , @xmath64 needs to be at least @xmath71 , for the average particle to _ have a chance _ of avoiding the acceleration quadrants .",
    "if @xmath64 is less than @xmath71 , then the average particle will _ definitely _ enter quadrant iii within the upcoming undulator segment .      during the in - bucket regime",
    ", we should keep the average particle in the bucket as long as possible .",
    "this allows us to fully exploit the in - bucket regime before the average particle becomes detrapped .",
    "thus , the upper bound @xmath73 for the target phase @xmath64 is given by the separatrix in the deceleration quadrants ( see fig .  [",
    "fig : decel_cycle ] ) . this can be expressed mathematically as @xmath74    to proceed from eq .",
    "( [ eq : psi_max_criterion ] ) , we can substitute the right - hand side by eq .",
    "( [ eq : h_sep ] ) , and the left - hand side by eq .",
    "( [ eq : h ] ) with @xmath75 .",
    "cognizant of the fact that @xmath76 , we can then solve for @xmath73 , and obtain the expression @xmath77 this is the upper bound for the choice of @xmath64 , in order to avoid entering the out - of - bucket regime .      within the first few cycles of the mechanism depicted in fig .",
    "[ fig : decel_cycle ] , the average particle should have reached the @xmath49 region , i.e. quadrants ii and iii . for the microbunch deceleration to be efficient",
    ", the average particle should stay within quadrant ii , without entering quadrant iii .",
    "however , this will not be possible if @xmath66 is too large ( see fig .",
    "[ fig : decel_cycle ] ) . from the inequality  ( [ eq : delta_psi_segm ] ) , we notice that @xmath66 increases with the undulator segment length @xmath0 .",
    "this imposes an upper limit on @xmath0 .",
    "as a particle undergoes one complete orbit in the ponderomotive bucket , it travels down the undulator magnet by a distance of one synchrotron period @xmath78 . as the particle sweeps across one quadrant in the bucket , it undergoes a quarter of a complete orbit , and travels down the undulator magnet by a distance of @xmath79 .",
    "thus , for the average particle to stay within a single quadrant ( namely , quadrant ii ) , an undulator segment should be no longer than @xmath79 . since @xmath80 varies with @xmath16 ,",
    "the requirement for the undulator segment length is @xmath81.\\ ] ]      as the microbunch deceleration cycle continues , the relative energy deviation @xmath60 of the average particle becomes more and more negative , meaning that @xmath82 becomes larger with every phase jump .    throughout the in - bucket regime",
    ", @xmath71 increases with @xmath82 according to eq .",
    "( [ eq : psi_min ] ) , and @xmath73 decreases with @xmath82 according to eq .",
    "( [ eq : psi_max ] ) .",
    "as the average particle is close to the bottom of the bucket , we will eventually encounter a scenario where @xmath83 .",
    "in such a scenario , it is no longer possible to choose a target phase @xmath64 in the range of @xmath84 .",
    "we are then forced to choose @xmath85 , and move the average particle out of the bucket .",
    "this marks the end of the in - bucket regime , and the beginning of the out - of - bucket regime .",
    "in the out - of - bucket regime , the trajectories in the longitudinal phase space @xmath28 are unbounded . nonetheless , microbunch deceleration is possible .",
    "the mechanism is similar to that in the in - bucket regime , and is illustrated in fig .",
    "[ fig : out - of - bucket_mechan ] .",
    "the deceleration efficiency in each undulator segment depends on the slope of the particle trajectory in the deceleration quadrants of the @xmath28 space .",
    "the steeper is the slope , the higher is the rate at which a particle loses energy .",
    "the slope is given by the derivative @xmath86 .",
    "dividing eq .",
    "( [ eq : eta ] ) by eq .",
    "( [ eq : psi ] ) , we can obtain an expression for the derivative as follows : @xmath87 note that in the deceleration quadrants , we have @xmath88 and hence @xmath89 . as a result , @xmath90 is inversely proportional to @xmath91 , and the deceleration efficiency decreases with @xmath91 .    for the in - bucket regime , @xmath92 . for the the out - of - bucket regime , @xmath93 .",
    "thus , the deceleration efficiency is lower in the out - of - bucket regime than in the in - bucket regime .",
    "as the microbunch deceleration cycle continues , the deceleration efficiency decreases with every undulator segment .      for the in - bucket regime",
    ", the deceleration in an undulator segment can be made more efficient by keeping the average particle in the deceleration quadrants and preventing it from entering the acceleration quadrants .",
    "this argument also applies to the out - of - bucket regime .",
    "thus , the lower bound for a good @xmath64 in the out - of - bucket regime is also given by eq .",
    "( [ eq : psi_min ] ) : @xmath94      in the out - of - bucket regime , the average particle is already outside the bucket .",
    "the separatrix does not impose any limit on @xmath64 . in principle , the upper limit of @xmath64 in the out - of - bucket regime is @xmath95 , which is the maximum phase in the deceleration quadrants .",
    "however , it is not favourable to let the average particle get too close to @xmath95 , or a fraction of the particles within the microbunch will leak into the @xmath96 region , which corresponds to the acceleration quadrants associated with the bucket ahead .",
    "in that region , particles absorb energy from the optical field .",
    "the precise upper bound for the choice of @xmath64 depends on the @xmath24 spread of the microbunch . but roughly speaking , the upper bound for a good @xmath64 is _ slightly below _",
    "@xmath95 .      according to the relation ( [ eq : delta_psi_segm ] ) , @xmath97 increases with @xmath82 . at some point in the out - of - bucket regime",
    ", @xmath82 will have become so large that @xmath98 this signifies the onset of the final saturation regime .    beyond that point , it is no longer possible to prevent the average particle from moving into quadrant iii within a single undulator segment , regardless of the choice of @xmath64 ( see fig .",
    "[ fig : out - of - bucket_mechan ] ) .",
    "the microbunch deceleration cycle then becomes inefficient , and @xmath99 approaches zero .",
    "as @xmath99 approaches zero , the inequality  ( [ eq : delta_psi_segm ] ) can be approximated by @xmath100 with this approximation , the relative energy deviation at the onset of the final saturation regime is then @xmath101    the final saturation point is reached when @xmath102 , i.e.  when it is no longer possible to maintain a net transfer of energy from microbunch to the optical field .      when specifying a phase jump , it is important to remember that the specified value is only valid for particles at a certain reference energy . in other words ,",
    "a particle which is not at the reference energy will experience a different phase jump from the specified value .    in applying the phase jump method , it is convenient to use the resonant energy @xmath10 as the reference energy , as it is constant .",
    "but in our physics model , we are mainly concerned about the phase jump applied to the average particle , which has @xmath103 in general .",
    "therefore , we need a conversion formula between the phase jump @xmath104 for the average particle and the phase jump @xmath105 for particles at the resonant energy .",
    "to obtain such a conversion formula , we model the phase - shifting chicane as a one - period undulator , with undulator period @xmath106 and deflection parameter @xmath107 . after the one undulator period , the slippage @xmath108 is given by @xmath109    for particles at the resonant energy , @xmath110 .",
    "the slippage @xmath108 is related to the phase jump @xmath105 by @xmath111 where @xmath13 ( without the caret ) is the actual radiation wavelength of the fel .",
    "the negative sign in the equation arises from the sign convention of @xmath105 .    in general",
    ", the average particle has @xmath103 . in the same one - period undulator , the average particle experiences a different slippage @xmath112 , which is related to the phase jump @xmath104 by @xmath113    to proceed from here , we take the differential on both sides of eq .",
    "( [ eq : phase_shifter_undulator ] ) , and obtain @xmath114 as usual , @xmath60 is the relative energy deviation of the average particle . using eqs .",
    "( [ eq : psi_jump_r ] ) , ( [ eq : psi_jump_a ] ) and ( [ eq : slippage_diff ] ) , we can eliminate @xmath13 , @xmath108 and @xmath115 .",
    "this results in the conversion formula @xmath116      apart from the phase jump method , undulator tapering is another common technique for efficiency enhancement in fels . in this subsection , we compare and contrast the two techniques .",
    "in particular , we discuss the similarities and differences between our phase jump model and the classic kroll - morton - rosenbluth ( kmr ) model  @xcite of undulator tapering .",
    "both models make use of one - dimensional hamiltonian mechanics to describe the particle dynamics in the longitudinal phase space @xmath28 .",
    "the kmr tapering model follows the motion of a resonant particle , which defines the stable point in the middle of the ponderomotive bucket .",
    "our phase jump model follows the motion of the average particle within the microbunch .    in the kmr model",
    ", we directly control the undulator parameter @xmath15 , and move the resonant particle vertically in the @xmath28 space . in our phase jump model",
    ", we directly control the phase jump @xmath23 , and move the average particle horizontally in the @xmath28 space .    in both models ,",
    "the energy extraction is sustained beyond the initial saturation point by bringing a fraction of particles towards lower energies .",
    "as these particles decelerate , energy is transferred to the optical field , due to the conservation energy .    however , the underlying principle of the particle deceleration is different in the two models . in the kmr model ,",
    "particle deceleration relies on the deceleration of the bucket itself . in our phase jump model ,",
    "particle deceleration relies on the microbunch deceleration cycle .    in the kmr model",
    ", the bucket moves towards lower energies during the energy extraction . in this process ,",
    "the phase of the resonant particle increases , and the width of the bucket decreases . in our phase jump model ,",
    "the bucket is stationary , and does not reduce in width . during the energy extraction process , the optical field amplitude increases , and the height of the bucket increases .    in the kmr model , particles need to be trapped in the bucket in order to decelerate . in our phase jump model , the microbunch deceleration cycle continues in the out - of - bucket regime .",
    "energy extraction outside the bucket is impossible for the former , but possible for the latter .    in the kmr model , the efficiency of particle deceleration",
    "is determined by the rate at which the bucket decreases in energy .",
    "this , in turn , depends on the @xmath117 , the rate at which the undulator parameter decreases along the undulator line . in the phase jump model ,",
    "the efficiency of particle deceleration is determined by @xmath118 , the slope of the particle trajectory in the longitudinal phase space .",
    "this , in turn , depends on the relative energy deviation @xmath60 of the average particle , as evident by eq .",
    "( [ eq : decel_eff ] ) .    in the kmr model ,",
    "the undulator segment length required for the efficient deceleration of particles is @xmath119 $ ] , as discussed in ref .",
    "@xcite . in our phase jump model ,",
    "the requirement is @xmath119/4 $ ] , which is a more stringent one .    in the kmr model ,",
    "the main causes of the final saturation are the weakening of refractive guiding and the detrapping of particles . in our phase jump model ,",
    "the main causes of the final saturation are the decrease of @xmath120 and increase of @xmath97 with particle energy .",
    "our physics model of the phase jump method is a one - dimensional and steady - state one . for the purpose of verifying the model",
    ", we perform a three - dimensional and steady - state simulation study , using the numerical simulation code genesis  @xcite .",
    "we first define a case for the simulation study .",
    "the main parameters are listed in table  [ table : sim_par ] .",
    "lcc & & +   + [ -1em ] electron beam energy & @xmath9 & 5 gev + energy spread & @xmath121 & @xmath122 + beam current & @xmath123 & 3 ka + normalized emittance & @xmath124 & 0.4 mm mrad + average of beta function & @xmath125 & 7 m + radiation wavelength & @xmath13 & 2  + undulator period & @xmath126 & 20 mm + undulator parameter & @xmath15 & 1.35 + length of each undulator segment & @xmath0 & 1 m + length of each drift section & @xmath127 & 0.2 m +    in the chosen case , sase is the start - up mechanism of the fel .",
    "the effective shot - noise power is 830  w.    planar undulator segments are used .",
    "undulator tapering is not implemented .    the lattice for strong focusing is in a fodo configuration , with one quadrupole magnet in every other drift section .",
    "the length of the fodo cell is 4.8  m. within the fodo cell , the centres of the two quadrupole magnets are separated by a distance of 2.4  m. the length of each quadrupole magnet is 80  mm .",
    "the strengths of the quadrupole magnets and the initial twiss parameters are matched self - consistently to give the average beta @xmath125 specified in table  [ table : sim_par ] .    in the genesis simulations ,",
    "we place a phase shifter in every drift section , by putting an ` ad ` element in the external magnet file .",
    "we control the phase jump by setting the ` ad ` element to an appropriate value .      in order to obtain information about the initial saturation point ,",
    "we first run the simulation in the absence of phase jumps , by setting @xmath25 for all drift sections .",
    "the simulation shows that the initial saturation occurs at @xmath128 m within the 32th undulator segment .",
    "the saturation power is 2 gw . at the initial saturation point , the bunching factor @xmath129 is the highest , and has a value of 0.4 .",
    "we then repeat the simulation with the introduction of phase jumps .",
    "we start the phase jumps in the vicinity of the initial saturation point , where the microbunching is fully developed .",
    "thus , the first non - zero phase jump occurs in the drift section at @xmath130  m , immediately preceding the 32th undulator segment .",
    "meanwhile , we keep @xmath25 for all the drift sections before @xmath130  m.    while there are infinite possible sets of phase jump values , we shall discuss one chosen set which yields an increase in radiation power beyond the initial saturation .",
    "it is possible to obtain even higher radiation power by fine - tuning the phase jump values .",
    "however , the purpose of this simulation study is to verify the physics model , and not to optimize the radiation power by phase scanning .          figure  [ fig : evolution_curves](a ) shows the radiation power @xmath131 as a function of @xmath16 , for the chosen set of phase jumps . along the radiation power curve , there are short , straight , horizontal sections , where the power is neither increasing nor decreasing .",
    "these sections correspond to the drift sections , where the radiation does not exchange energy with the electron beam .",
    "after the first non - zero phase jump at @xmath130  m , the radiation power continues to grow .",
    "up until @xmath132  m , the power grows monotonically .",
    "but after that , the power fluctuates . within every undulator segment , the power first increases ,",
    "and then decreases .",
    "nonetheless , there is still a net power increase .    in the undulator segment which begins at @xmath133  m",
    ", there is no longer a net power increase within an undulator segment .",
    "this indicates the arrival of the final saturation .",
    "the power at the final saturation is 36 gw , which is 18 times the power at the initial saturation .",
    "the fel efficiency can be defined as the power ratio of the output radiation to the injected electron beam . with this definition ,",
    "the chosen set of phase jumps enhance the fel efficiency by a factor of 18 .",
    "it is possible to obtain an even larger enhancement factor by fine - tuning the phase jump values . but",
    "again , the purpose of this simulation study is to verify the physics model , and not to perform a thorough optimization by phase scanning .",
    "we now turn our attention to the average particle within the microbunch .",
    "the relative energy deviation @xmath60 of the average particle is defined by eq .",
    "( [ eq : eta_bar ] ) . figure  [ fig : evolution_curves](b ) shows @xmath60 as a function of @xmath16 .    before the first non - zero phase jump at @xmath130  m",
    ", @xmath60 remains close to zero , meaning that the energy of the average particle is close to the resonant energy .",
    "after the first non - zero phase jump at @xmath130  m , @xmath60 exhibits an overall decreasing trend .",
    "the energy of the average particle deviates further and further from the resonant energy .",
    "this is an evidence of microbunch deceleration .",
    "as @xmath60 becomes more and more negative , the rate of @xmath60 decrease becomes lower and lower .",
    "this agrees with the prediction of eq .",
    "( [ eq : decel_eff ] ) .    up until @xmath132  m",
    ", @xmath60 decreases monotonically .",
    "but after that , @xmath60 fluctuates . comparing fig .",
    "[ fig : evolution_curves](a ) and  ( b ) , we notice that a decrease in @xmath60 corresponds to an increase in @xmath131 , and vice versa .",
    "this can be explained by the conservation of energy .",
    "when @xmath60 decreases , the microbunch loses energy .",
    "this energy is transferred to the radiation , leading to an increase in @xmath131 .",
    "the onset of the final saturation regime is defined by eq .",
    "( [ eq : final_sat_onset ] ) . according to this definition ,",
    "the final saturation regime begins when @xmath134 . as seen in fig .",
    "[ fig : evolution_curves](b ) , this corresponds to @xmath135  m.      the ponderomotive phase @xmath59 of the average particle is defined by eq .",
    "( [ eq : eta_bar ] ) . figure  [ fig : evolution_curves](c ) shows @xmath59 as a function of @xmath16 . after the first non - zero phase jump at @xmath130  m , @xmath59 oscillates in @xmath16 .",
    "the upward slopes coincide with the drift sections , while the downward slopes coincide with the undulator segments . in other words ,",
    "a crest coincides with the start point of an undulator segment , while a trough coincides with the end point of an undulator segment .    in terms of the microbunch deceleration cycle",
    "( see figs .",
    "[ fig : decel_cycle ] and  [ fig : out - of - bucket_mechan ] ) , a crest corresponds to position 2 , while a trough corresponds to position 1 or 3 . the period of the oscillation is one microbunch deceleration cycle . the crest value of each cycle is the target phase @xmath64 .",
    "the phase change represented by an upward slope is @xmath23 , while the phase change represented by a downward slope is @xmath66 .",
    "figure  [ fig : evolution_curves](c ) also shows the lower bound @xmath71 and the upper bound @xmath73 for the target phase @xmath64 in each drift section .",
    "the values are given by eqs .",
    "( [ eq : psi_min ] ) and  ( [ eq : psi_max ] ) .",
    "recall that @xmath73 is defined by the separatrix of the ponderomotive bucket in the @xmath136 region , and that @xmath71 is the minimum requirement for the average particle to avoid entering the @xmath45 region .    in fig .",
    "[ fig : evolution_curves](c ) , the region immediately after the first non - zero phase jump at @xmath130  m is the in - bucket regime , as evident by the fact that @xmath137 .",
    "the decrease of @xmath73 with @xmath16 reflects that the average particle is moving towards the bottom of the bucket .    in the in - bucket regime",
    ", @xmath64 is made to increase with @xmath71 , so as to fulfill the requirement that @xmath138 . as a result",
    ", the average particle is prevented from entering the @xmath45 region . within every undulator segment , the average particle transfers energy to the radiation , without absorbing energy from the radiation .",
    "this explains the monotonic decrease of @xmath60 [ see fig .",
    "[ fig : evolution_curves](b ) ] .",
    "prior to @xmath139  m , the choice of @xmath64 satisfies the requirement that @xmath140 .",
    "but in the vicinity of @xmath139  m , the average particle is so close to the bottom of the bucket that we encounter the situation where @xmath141 .",
    "we are then forced to choose @xmath85 , thus placing the average particle outside the bucket .",
    "this marks the beginning of the out - of - bucket regime .    even though the average particle is outside the bucket , a fraction of the particles in the microbunch are still inside the bucket .",
    "for the next two periods of the oscillation , a part of the microbunch follows the in - bucket trajectories , while a part of the microbunch follows the out - of - bucket trajectories .",
    "the average particle , tracing the average behaviour of the entire microbunch , moves in and out of the bucket . at @xmath142  m , @xmath143 , indicating that the average particle is at the same energy level as the lowest point of the bucket .    in the out - of - bucket regime , @xmath71 continues to increase , and becomes closer and closer to @xmath95 .",
    "however , we want to prevent the average particle from getting too close to @xmath95 , or a fraction of the particles in the microbunch will enter the acceleration region associated with the bucket ahead .",
    "this concern forces us to choose @xmath144 .",
    "the consequence is that the average particle enters the @xmath45 region , thus absorbing energy from the radiation .",
    "hence , @xmath60 no longer decreases monotonically [ see fig .  [",
    "fig : evolution_curves](b ) ] .",
    "instead , @xmath60 decreases and increases within a single undulator segment .",
    "the final saturation regime begins at @xmath135  m , where @xmath145 [ see fig .",
    "[ fig : evolution_curves](c ) ] . in this regime",
    ", it is no longer possible to prevent the average particle from entering the @xmath45 region , regardless of the choice of @xmath64 . as the average particle enters deep into the @xmath45 region , the energy extraction becomes far less effective .",
    "next , we observe the microbunch deceleration cycle directly in the longitudinal phase space @xmath28 .",
    "figure  [ fig : comic_strip_1 ] shows a cycle in the in - bucket regime .",
    "figure  [ fig : comic_strip_2 ] shows a cycle during the transition from the in - bucket regime to the out - of - bucket regime .",
    "figure  [ fig : comic_strip_3 ] shows a cycle at the onset of the final saturation regime .    in each of these phase space snapshots ,",
    "the red curve represents the separatrix of the ponderomotive bucket , and the red dot represents the average particle .",
    "these snapshots clearly show that the electron beam remains microbunched along the undulator line . from these snapshots , it is also apparent that the microbunch moves towards lower @xmath18 as @xmath16 increases , verifying the microbunch deceleration once again .    in each cycle , position  1 corresponds to the start point of the drift section , position  2 the end point of the drift section , and position  3 the end point of the subsequent undulator segment .    in position  1 and position  2",
    ", the average particle has the same @xmath18 .",
    "this is expected , as the phase jump @xmath23 changes only the phase , but not the energy , of the average particle .    in the transition from position  2 to position  3 ,",
    "the particles pass through an undulator segment , where there is energy exchange between the particles and the radiation .",
    "the energy exchange alters the bucket half - height @xmath43 slightly .",
    "this is also expected , as @xmath43 depends on the slowly varying optical field amplitude @xmath7 according to the proportionality  ( [ eq : h_propto_e0 ] ) .",
    "in all the three cycles shown here , the average particle ends up with a lower @xmath18 at position  3 than at position  1 , meaning that there is a net energy transfer from the microbunch to the radiation in the undulator segment .",
    "the motion of the average particle in these snapshots reflects the mechanism depicted in figs .",
    "[ fig : decel_cycle ] and  [ fig : out - of - bucket_mechan ] .       over the entire undulator line . ]",
    "figure  [ fig : avg_par_trajectory ] shows the trace of the average particle in the longitudinal phase space @xmath28 over the entire undulator line",
    ". within the trace , there are straight , horizontal sections , each representing the transition from position 1 to position 2 within a microbunch deceleration cycle .    as the average particle moves from high @xmath18 to lower @xmath18 , the @xmath18 spacing between successive horizontal sections decreases , meaning that the amount of energy lost by the average particle decreases with every cycle . in other words ,",
    "the deceleration efficiency decreases with @xmath18 , as predicted by eq .",
    "( [ eq : decel_eff ] ) .    at @xmath146 ,",
    "the @xmath18 spacing between successive horizontal sections approaches zero .",
    "there is no longer a net energy transfer from the microbunch to the radiation .",
    "this indicates the arrival of the final saturation .      in the simulation ,",
    "the synchrotron period @xmath80 varies as a function of @xmath16 ( data not shown ) .",
    "the smallest value is @xmath147 = 5.9 $ ]  m , which occurs at @xmath142  m. with a undulator segment length of @xmath148  m as specified in table  [ table : sim_par ] , the requirement  ( [ eq : lsegm_required ] ) is satisfied .",
    "our physics model of the phase jump method is a steady - state one . for the purpose of verifying the model ,",
    "we have conducted the numerical simulations in the steady - state mode .",
    "so far , time - dependent effects have not been taken into consideration . to lay the foundation for future studies ,",
    "we dedicate this section to a brief discussion on a time - dependent phenomenon , namely , the growth of sidebands in the fel power spectrum .    for undulator tapering ,",
    "sideband growth is a known issue , which degrades the spectral brightness at the desired fel wavelength .",
    "this is discussed , for instance , in refs .",
    "@xcite ,  @xcite , and  @xcite .",
    "the phase jump method has a similar nature to undulator tapering as a technique for enhancing the fel power beyond the initial saturation .",
    "this prompts us to question whether sideband growth is an issue in the phase jump method as well .",
    "the origin of the sidebands is the oscillation of the particle phase @xmath24 with the distance @xmath16 along the undulator line . for undulator tapering ,",
    "the period of the oscillation is the synchrotron period @xmath80 .",
    "this causes the growth of sidebands at  @xcite @xmath149    for the phase jump method , provided that the undulator segment length @xmath0 satisfies the requirement  ( [ eq : lsegm_required ] ) , the average particle never undergoes one complete orbit within the ponderomotive bucket after the initial saturation , as the orbit is disrupted by the applied phase jumps . nonetheless , the phase @xmath59 of the average particle still oscillates along the undulator line , as seen in fig .",
    "[ fig : evolution_curves](c ) .",
    "the period of this oscillation is the distance between successive phase shifters , given by @xmath150 .",
    "therefore , we expect this oscillation to trigger sidebands at @xmath151    according to eq .",
    "( [ eq : sideband_wavelengths ] ) , it is , in principle , possible to influence the sidebands by varying @xmath0 and @xmath127 as functions of @xmath16 .    with the parameter values listed in table  [ table : sim_par ] , eq .",
    "( [ eq : sideband_wavelengths ] ) yields @xmath152 , which lie outside the fel bandwidth . in attempt to verify this prediction ,",
    "we repeat the numerical simulation in time - dependent mode .",
    "the resulting graph of radiation power versus @xmath16 ( not shown here ) agrees qualitatively with fig .",
    "[ fig : evolution_curves](a ) .",
    "however , sidebands are not seen in the average power spectrum of 30 shots ( not shown here ) .",
    "further investigation is needed to achieve a full understanding of time - dependent effects in the phase jump method .",
    "in this article , we have examined the underlying physics of the phase jump method for enhancing the efficiency of an fel .",
    "we have developed a one - dimensional , steady - state physics model , and we have verified it with three - dimensional , steady - state numerical simulations .    the physics model illustrates the post - saturation energy extraction process in the longitudinal phase space .",
    "it considers an average particle within the microbunch , and describes the microbunch deceleration cycle inside and outside the ponderomotive bucket .",
    "the model sets out the selection criteria for the target phase in each phase jump , describes the mechanism of the final saturation , and gives an upper limit for the undulator segment length . with the aid of our physics model",
    ", we have also discussed the similarities and differences between the phase jump method and undulator tapering .",
    "b.  diviacco et al . , `` phase shifters for the fermi @ elettra undulators '' , in _ proceedings of the 2nd international particle accelerator conference , san sebastian , spain _ ( jacow , geneva , switzerland , 2011 ) , p.3278 .    h.  g.  lee et al . , `` design and fabrication of prototype phase shifter for pal xfel '' , in _ proceedings of the 4th international particle accelerator conference , busan , korea _ ( jacow , geneva , switzerland , 2013 ) , p.3564 .",
    "a.  a.  varfolomeev , t.  v.  yarovoi , and p.  v.  bousine , `` possible enhancement of sase fel output field intensity induced by local phase jump '' , nucl .  instrum .",
    "methods phys .",
    "a * 407 * , 296 ( 1998 ) .",
    "d.  ratner , z.  huang , and a.  chao , `` enhancing fel power with phase shifters '' , in _ proceedings of the 29th international free - electron laser conference , novosibirsk , russia _ ( jacow , geneva , switzerland , 2007 ) , p.69 .",
    "n.  m.  kroll , p.  l.  morton , and m.  n.  rosenbluth , `` free - electron lasers with variable parameter wigglers '' , ieee j.  quantum electronics * 17 * , 1436 ( 1981 ) .",
    "+ a.  mak , f.  curbis , and s.  werin , `` model - based optimization of tapered free - electron lasers '' , phys .",
    "st accel .",
    "beams * 18 * , 040702 ( 2015 ) .",
    "p.  schmser , m.  dohlus , and j.  rossbach , in _ ultraviolet and soft x - ray free - electron lasers : introduction to physical principles , experimental results , technological challenges _",
    "( springer , berlin , germany , 2008 ) , p.29 .",
    "j.  wu et al . , `` x - ray spectra and peak power control with isase '' , in _ proceedings of the 4th international particle accelerator conference , shanghai , china _ ( jacow , geneva , switzerland , 2013 ) , p.2068 ."
  ],
  "abstract_text": [
    "<S> the efficiency of a free - electron laser can be enhanced by sustaining the growth of the radiation power beyond the initial saturation . </S>",
    "<S> one notable method is undulator tapering , which involves the variation of the gap height and/or the period along the undulator . </S>",
    "<S> another method is the introduction of phase jumps , using phase - shifting chicanes in the drift sections separating the undulator segments . in this article </S>",
    "<S> , we develop a physics model of this phase jump method , and verify it with numerical simulations . </S>",
    "<S> the model elucidates the energy extraction process in the longitudinal phase space . </S>",
    "<S> the main ingredient is the microbunch deceleration cycle , which enables the microbunched electron beam to decelerate and radiate coherently beyond the initial saturation . </S>",
    "<S> the ponderomotive bucket is stationary , and energy can even be extracted from electrons outside the bucket . </S>",
    "<S> the model addresses the selection criteria for the phase jump values , and the requirement on the undulator segment length . </S>",
    "<S> it also describes the mechanism of the final saturation . in addition </S>",
    "<S> , we discuss the similarities and differences between the phase jump method and undulator tapering , by comparing our phase jump model to the classic kroll - morton - rosenbluth model . </S>"
  ]
}