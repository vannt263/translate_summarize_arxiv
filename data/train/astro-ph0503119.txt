{
  "article_text": [
    "the 21 cm line of neutral atomic hydrogen ( ) is a key probe of the galactic interstellar medium .",
    "although the cold ( @xmath1  k ) gas distribution is difficult to map in  emission ,  self - absorption ( hisa ) allows cold foreground gas to be distinguished from warmer background gas at the same radial velocity @xcite . until recently",
    ", hisa has been studied in limited low - resolution maps ( e.g. , @xcite ) , or in a few isolated objects at higher resolution ( e.g. , @xcite ) , but no detailed , systematic surveys have been made .",
    "high resolution allows feature structure to be studied and unabsorbed background brightness to be estimated accurately .",
    "coverage of a wide area enables an unbiased look at the hisa population , e.g. , without the a priori expectation that hisa is found only in molecular clouds .",
    "high - resolution , wide - area hisa surveys have now become possible with the advent of several major  synthesis surveys : the canadian galactic plane survey ( cgps ; @xcite ) , the southern galactic plane survey ( sgps ; @xcite ) , and the vla galactic plane survey ( vgps ; @xcite ) .",
    "past hisa studies have identified absorption features by eye , but this approach is no longer adequate .",
    "the very richness of the synthesis survey data sets requires that they be analyzed in a rigorous , repeatable manner .",
    "we have therefore designed automated algorithms to identify and extract hisa features from  longitude - latitude - velocity @xmath0 data cubes .    in this paper , we describe our hisa search and extraction algorithms . we also explain how we have tested our software with model data to determine its reliability under a range of different conditions .",
    "large surveys are playing an increasingly significant role in modern astrophysics , and it is essential that their underlying methods are understood so their results can be interpreted properly . following criteria established in @xcite ( @xcite ; hereafter paper  i ) , our hisa search software seeks finely - structured dark features against bright backgrounds that can not be confused with simple gaps in  emission .",
    "although its parameters are optimized to identify hisa in the cgps , the software is easily adapted to work with other surveys ( e.g. , the vgps : @xcite ) .",
    "the cgps uses a hexagonal grid of full - synthesis fields with single - dish observations to enable the detection of all scales of  structure down to the synthesized beam .",
    "the cgps  data have a @xmath2 beam , 0.824  velocity sampling , and a field - center noise of @xmath3  k in empty channels ; @xmath4 doubles when the 107  primary beam is filled with 100  k emission , and it can be up to 60% greater between field centers . the initial phase of the survey mapped a @xmath5 region along the galactic plane with longitudes @xmath6 and latitudes @xmath7 ( @xmath8 ) , and extensions in both @xmath9 and @xmath10 have followed .",
    "below , we describe our method of hisa identification and extraction at some length (  [ sec : ext ] ) and evaluate the method s performance with models (  [ sec : eval ] ) .",
    "a companion paper presents the results of our hisa search of the @xmath5 phase i cgps ( @xcite ; hereafter paper  ii ) .",
    "subsequent papers in this series will apply the hisa search to other data sets .",
    "many hisa features are apparent to the eye ( e.g. , see figs .  [",
    "fig : real_hisa_id_maps_overview ] - [ fig : real_hisa_id_stage_spectra ] ) , but a complete visual search is unlikely to be uniform , repeatable , or thorough , and it is also impractical given the sheer volume and complexity of the cgps data .",
    "thus , an automated search is needed .",
    "the search algorithm should find features meeting simple criteria that can be confirmed by eye , but it should also be tested with model data to evaluate its performance quantitatively (  [ sec : eval ] ) .",
    "the nature and appearance of hisa dictate how it can be identified .",
    "first , while the cold  from which it arises can have any extent , no hisa feature can exceed the @xmath0 boundaries of its bright background emission , or it ceases to be absorption .",
    "second , hisa must have different @xmath0 structure than the background  for it to be distinguishable from background fluctuations .",
    "we choose to search for hisa that is more finely - structured than the background , since this is consistent with the first constraint , most cgps hisa that can be visually identified is of this nature , and the exceptions ( e.g. , @xcite ) are difficult to identify algorithmically .",
    "we seek  features that can only be explained as hisa .",
    "we prefer this conservative approach over the alternative of including significant false detections in our survey sample .",
    "as given in paper  i , our conditions for distinguishing hisa from simple gaps in  emission are : ( 1 ) narrower line widths than most observed emission features ; ( 2 ) steeper line wings ; ( 3 ) more small - scale angular structure ; and ( 4 ) a minimum  emission background level . the first two conditions are related for gaussian line profiles , since these have line wing slopes proportional to amplitude over width , but real hisa need not be gaussian .",
    "the last condition excludes the finely - structured emission gaps that are common at interarm velocities in the outer galaxy , where smooth , bright  backgrounds are often absent .",
    "these four criteria exclude hisa on larger angular and velocity scales or against weaker backgrounds , but they are adequate for capturing most visible features .",
    "we do not require the extra condition of molecular line emission to confirm hisa features ( e.g. , @xcite ) , since many hisa features are visible without  emission in the cgps ( paper  i ; @xcite ) and in other surveys ( e.g. , @xcite ) .",
    "we tried and rejected many different methods before selecting the algorithm described in this paper .",
    "discarded techniques include various derivative measures to detect sharp edges , spatial and spectral curvature tests to look for dips , fourier and wavelet filtering methods , and unsharp masking .",
    "most of these were successful in locating the strongest features , but few were robust against noise , and many also produced large numbers of artifacts and false detections .",
    "the latter were especially frequent in methods that used only spectral or spatial searches rather than both combined .",
    "our chosen method is based on a variant of the clean algorithm @xcite developed by @xcite ( hereafter the sdi clean ) .",
    "we remove large - scale spectral and spatial emission structures from the  data iteratively and flag the small - scale negative residuals as self - absorption features . for computational efficiency , these operations are carried out separately on the spectrum at each spatial position @xmath11 and on the channel map at each radial velocity @xmath12 in the data cube , and the results are combined afterward .",
    "the identified hisa is then subtracted from the  cube , and the whole process is repeated until significant hisa can no longer be found ; such iteration allows features larger than the chosen clean scales to be mapped .",
    "the two spectral and spatial search algorithms are described below .",
    "each has been tuned to find as much visually identifiable hisa as possible while minimizing false detections .",
    "the latter are further reduced by subsequently requiring the hisa at any 3-d position @xmath0 to be detected by both searches (  [ sec : ext_dt ] ) .",
    "the two algorithms were tuned by visually comparing the search output against the observed  for many different parameter value combinations , using a range of different hisa features with different  emission backgrounds in the cgps data .",
    "the parameters that yielded the most complete hisa detections with the fewest false detections were used in the model - based search performance evaluations (  [ sec : eval ] ) and in the cgps hisa survey ( paper  ii ) .    in the following discussions ,",
    "the galactic coordinate variables @xmath0 are replaced by their pixel coordinate analogs @xmath13 . adopted values for the search parameters",
    "are given in square brackets [  ] .",
    "these give the best performance for a hisa search of cgps data , but they may not be universal .",
    "in particular , the best filter scales and minimum background level may differ for hisa searches elsewhere in the galaxy .      at each spatial position @xmath14",
    ", the spectral search algorithm builds an approximation of the `` unabsorbed spectrum '' @xmath15 that would be observed if no hisa were present .",
    "the algorithm assumes that @xmath15 can be constructed from gaussian functions of a characteristic width @xmath16 that is narrower than the dominant emission features but broader than the width of any expected hisa feature .",
    "any channels in which the observed spectrum @xmath17 deviates significantly negatively from @xmath15 are flagged as possible hisa .",
    "the iterative procedure used to derive @xmath15 is a modification of the sdi clean .",
    "@xmath15 is initially set to zero , and the `` residual spectrum '' @xmath18 is set equal to @xmath19 , a smoothed version of @xmath17 .",
    "smoothed data are used to improve the signal - to - noise for the cleaning process .",
    "@xmath19 is a _ spatial _ average of @xmath20 pixels centered at @xmath14 , i.e. , the average of @xmath21 intensities where @xmath22 and @xmath23 [ and @xmath24 pixels @xmath25 .",
    "independent of this spatial averaging , the _ spectral _ _ rms _  noise @xmath26 in @xmath17 is computed as the lowest of three _ rms _  noise measures over equal thirds of @xmath17 . in the clean loop ,",
    "the following steps are performed :    1 .   if @xmath27 , the peak value of @xmath18 , is less than a preset fraction  [ 3% ] of the peak value of @xmath19 , the iteration ceases .",
    "2 .   for any channel @xmath28",
    "where @xmath18 exceeds a given clip level  [ 0.8 ] @xmath29 , a `` correction spectrum '' @xmath30 is set to a preset gain [ 0.25 ] @xmath31 ; elsewhere , @xmath30 is set to zero .",
    "@xmath30 is convolved with a gaussian whose full width at half maximum ( fwhm ) is @xmath16 [ 8  ] , and the resulting spectrum is added to @xmath15 .",
    "the new residual spectrum is set to @xmath32 , and @xmath33 , the _ rms _  of all _ positive _ values of @xmath18 is computed over all channels . as @xmath15 approaches @xmath19 , @xmath33 decreases ; if @xmath34 , the iteration is terminated .",
    "if the iteration has not terminated due to one of the above convergence criteria , and a maximum number of loops [ 1000 ] has not been reached , steps 1 - 5 are repeated .",
    "after the clean loop is completed , adjacent channels where @xmath35 a factor @xmath36  [ @xmath37 are grouped into `` segments '' of suspected hisa . in each segment ,",
    "@xmath19 and @xmath15 are evaluated at the channel @xmath38 where @xmath18 has a local minimum .",
    "if @xmath39 , the segment is rejected as a likely noise feature . if @xmath40 , where @xmath41 is a preset brightness level  [ 30  k ] , the segment is rejected as having an insufficiently bright background to identify hisa clearly .",
    "a second , more conservative @xmath42  [ 70  k ] is applied later when the spatial and spectral search results are combined (  [ sec : ext_dt ] ) .",
    "a gaussian profile is fitted to the absorption magnitude spectrum @xmath18 of each remaining channel segment .",
    "real hisa line profiles may not be gaussian , but this shape is assumed for simplicity . for computational speed , the central channel of the gaussian is fixed at @xmath38 , and the fwhm is fixed at one of two values , @xmath43 [ 2.0 ] or @xmath44 [ 4.0 ] , to capture hisa with a range of widths .",
    "model tests (  [ sec : eval ] ) show that many features outside this range are also detected . in each fit , a sloping linear base level is derived along with the gaussian amplitude @xmath45 and the standard deviation @xmath46 of the fit . a fit is rejected as statistically unreliable if @xmath47  [ 2.0 ] or @xmath48 .",
    "it can also be rejected if @xmath17 lacks a morphological `` dip '' at @xmath38 .",
    "this is determined with a filter function that returns a value of 1.0 for a dip between two equal peaks , 0.5 for a `` dip '' that drops only to the level of the adjacent spectral data on one side of @xmath38 , and 0.0 on a linearly rising or falling spectrum .",
    "fits that return a value below the chosen threshhold [ 0.6 ] are rejected .",
    "this filter inhibits the detection of hisa on the edges of emission features that are steeper than @xmath16 would allow ; otherwise , significant false hisa detections result . for accepted fits , the channels in a _",
    "narrow _ or _ broad _ hisa spectrum ( both initially zero ) are set equal to the fitted gaussian if the amplitude exceeds a given fraction [ 5% ] of @xmath45 .",
    "then , a `` detected '' hisa spectrum is created that consists of the maximum value in each channel from the _ narrow _ and _ broad _ gaussian fits to the hisa line profile , to ensure full detection of the feature . in the case where the _ broad _ line wings do not correspond to real hisa in a narrow feature ,",
    "these will not be detected by the spatial search and will be removed at a later stage of analysis .    finally , when the hisa amplitudes have all been computed , these are spatially smoothed [ with a 1.5  beam ] to join together groups of flagged `` flecks '' into more coherent features , and those that are sufficiently weak and isolated are culled if their amplitude falls below a specified threshhold [ 2  k ] .",
    "an additional cosmetic improvement is made by excluding strong hica from the set of spectrally - identified hisa .",
    "this is done by dropping any sight lines from the search that contain channels whose continuum - subtracted line brightness is significantly negative , i.e. , if @xmath49 .",
    "weaker hica will survive this filter to contaminate the set of detected hisa .",
    "such contamination is difficult to remove in a way that leaves the `` pure '' hisa in the same sight lines intact .    to illustrate the algorithm",
    ", we plot the  spectrum of paper  i s perseus hisa globule ( @xmath50 ) in figure  [ fig : globule_spectrum_raw ] and several stages of the algorithm s analysis in figure  [ fig : globule_spectrum_hi_dips ] .",
    "these  data supersede those used in paper  i , which contained a flaw that had no serious impact on the results .",
    "appendix  [ app : erratum ] gives further details .    in figure",
    "[ fig : globule_spectrum_hi_dips ] , the estimation of @xmath15 converged when the peak residual became less than 3% of the initial spectral peak , giving @xmath51  k ( the dashed line indicates a negative deviation of twice this value ) .",
    "suspected hisa was identified in eight channel segments .",
    "one of these ( 4 ) had no counterpart dip in @xmath17 .",
    "six others were rejected because @xmath52  k. for simplicity , we used @xmath53  k here to show what would survive the ultimate @xmath54  k filter . in the remaining segment ( 5 )",
    ", channels in which the `` merged '' hisa spectrum ( maximum of the narrow and broad hisa spectra ) is non - zero were then flagged as having `` detected '' hisa .",
    "note that , because of the initial smoothing , the detected hisa has a smaller amplitude than in figure  [ fig : globule_spectrum_raw ] .",
    "the full hisa amplitude is recovered when the spectral and spatial search results are merged (  [ sec : ext_dt ] ) .",
    "the spatial search algorithm is similar in principle to the spectral search , although it does not attempt to fit absorption features with gaussian shapes , nor does it require that they satisfy a morphological `` dip '' filter .",
    "it begins by estimating the unabsorbed brightness distribution @xmath55 in a given spectral channel @xmath28 .",
    "the algorithm assumes that @xmath55 can be constructed from two - dimensional circular gaussian components of a characteristic width @xmath56 that is narrow enough to represent most  emission structure but broader than any expected hisa features .",
    "clearly the choice of @xmath56 limits the angular size of hisa features that will be detected , although this can be alleviated with repeated searches .",
    "the iterative procedure used to derive @xmath55 is again a modification of the sdi clean .",
    "@xmath55 is initially set to zero , and the residual map @xmath57 is set equal to @xmath58 , a spatially smoothed copy of the observed channel map @xmath59 .",
    "use of @xmath58 , computed as an @xmath20 pixel average of @xmath59 [ with @xmath60 pixels @xmath61 , improves the clean convergence . on a larger angular scale [ 20 ] , an estimate of the typical _ rms _  noise @xmath26 in @xmath59 and its gross variation across the channel map are derived in a manner similar to the spectral _ rms _  noise in  [ sec : ext_spectral ] . from this , the average _ rms _  noise in @xmath58 , termed @xmath62 , and its variation over the map are deduced . in the clean loop ,",
    "the following steps are performed :    1 .",
    "@xmath27 , the mth [ 10th ] highest value of @xmath57 , is found .",
    "this is chosen rather than the peak value so that the iteration process is not dominated by one noisy pixel .",
    "if @xmath27 is less than a preset fraction [ 3% ] of the peak value of @xmath58 , the iteration ceases . 2 .",
    "for any pixel @xmath14 where @xmath57 exceeds a given clip level  [ 0.5 ] @xmath29 , a correction map @xmath63 is set to a preset gain [ 0.25 ] @xmath64 ; elsewhere , @xmath63 is set to zero .",
    "@xmath63 is convolved with a 2-d gaussian whose fwhm is @xmath56 [ 20 ] , and the resulting image is added to @xmath55 .",
    "the new residual map is set to @xmath65 , and the _ rms_value @xmath33 of the _ positive _ values of @xmath57 is computed . in deriving @xmath33 ,",
    "allowance is made for the fact that the noise may vary across the image by applying suitable weights to the values of @xmath57 . if @xmath66 , the iteration is terminated .",
    "if the iteration has not terminated due to one of the above convergence criteria , and a preset maximum number of loops [ 1000 ] has not been reached , steps 1 - 5 are repeated .",
    "after the clean loop is completed , all pixels where @xmath67 a factor @xmath36  [ @xmath37 are noted , as are those where @xmath68 .",
    "a map of `` suspected hisa '' is set equal to @xmath69 for all pixels @xmath14 where either condition is met and zero elsewhere .",
    "this map is then filtered to remove pixels with amplitudes less than a specified cutoff [ 4  k ] , as well as those for which @xmath70  [ 30  k ] .",
    "lastly , as in the spectral algorithm , the suspected hisa map is smoothed [ with a 1.5  beam ] to improve feature coherence , and a final cull is made of smoothed amplitudes below a lower threshhold [ 2  k ] ; surviving features are deemed `` detected hisa '' .",
    "the spatial search is illustrated in figure  [ fig : globule_xcut_hi_abs ] , with longitude profiles taken through the perseus hisa globule position ( @xmath71 ) from one channel map at different stages of processing .",
    "the determination of @xmath55 took 114 iterations , ending when @xmath33 became less than @xmath72  k.        the physical properties of the absorbing gas can not be understood without knowing the hisa brightness temperature amplitude @xmath73 , where @xmath74 is the observed brightness on the hisa feature , and @xmath75 is the unabsorbed emission that would be measured if no hisa were present . since only @xmath76 is directly observed at the hisa position , @xmath77 must be estimated from @xmath78 , the  brightness off the hisa feature in space and/or velocity . for clarity , we note that @xmath77 represents _ all _ of the unabsorbed emission along the line of sight at radial velocity @xmath79 .",
    "the emission from behind the hisa feature that is subject to absorption is @xmath80 , where @xmath81 ; the exact value of @xmath82 depends upon the sight - line geometry ( see paper  i ) .",
    "several means of estimating @xmath77 have been used in past studies . in the spectral domain ,",
    "the velocity edges of a hisa feature can be fitted with straight lines @xcite or more complex functions @xcite to estimate @xmath77 at intervening velocities . in the spatial domain",
    ", the  brightness at positions adjacent to the hisa feature can be used directly as @xmath77 ( paper  i ; @xcite ) or as anchor points for spatial fits across the feature @xcite .",
    "a variant on this approach assumes hisa is sufficiently diluted in the broad beam of a single dish telescope to use the single dish spectrum at the feature position as @xmath77 @xcite .",
    "our approach is more general .",
    "we group the hisa volume - pixels ( voxels ) identified in   [ sec : ext_spectral]-[sec : ext_spatial ] into contiguous 3-d features in the spectral line cube . for each feature",
    ", we estimate @xmath77 by interpolating the @xmath78 values of the non - hisa voxels that border the feature in @xmath0 space .",
    "the interpolation uses a 3-d gaussian weighting function to ensure smoothness on the scale of the feature .",
    "specifically , at each position @xmath0 within the hisa feature ,    @xmath83    where @xmath84 indexes the list of @xmath85 off - hisa voxels with coordinates @xmath86 , and the weight @xmath87 is given by    @xmath88 \\;\\ ; .\\ ] ]    the gaussian dispersions @xmath89 are set so that each fwhm ( @xmath90 ) is half the maximum length of any contiguous row of hisa voxels in that dimension , with fwhm lower limits of 1.2  and 3.3  and upper limits of 20and 8  , the hisa search clean scales .",
    "the result is somewhat similar to that of 1-d spectral fitting methods , but its structure is constrained by all three dimensions of the  data .",
    "this method yields @xmath77 and @xmath91 estimates superior to those of our separate spectral and spatial searches .",
    "the @xmath77 estimation algorithm considers two confidence levels of hisa .",
    "first , a _ union _",
    "filter requiring a hisa identification from either the spectral or spatial search is applied .",
    "this filter includes nearly every hisa feature that the eye can detect , as well as many non - hisa features that are discarded later .",
    "all accepted voxels are grouped into tentative hisa features and interpolated over to obtain @xmath77 , which is subtracted from the unsmoothed data to get @xmath91 with the full cgps angular resolution .",
    "then , an _ intersection _ filter requiring hisa identification in _ both _ spectral and spatial searches is applied .",
    "voxels not satisfying this filter are unflagged as hisa , and their @xmath77 is reset to the observed  brightness . computing @xmath77 and @xmath91 for a union voxel set and applying",
    "an intersection filter afterward ensures that ( 1 ) only the most likely hisa features survive , and ( 2 ) any `` penumbral '' contamination from undetected hisa in their @xmath78 voxels is minimized ; otherwise , @xmath77 and @xmath92 could be significantly underestimated .",
    "an alternative is to interpolate only over hisa satisfying the intersection filter with all union - filter voxels dropped from the @xmath78 ensemble , but this frequently leaves too few edge voxels for a robust @xmath77 estimate .",
    "three additional filters are applied with the intersection filter .",
    "voxels with @xmath93 are discarded , as are those in the noisy peripheries of the survey and those for which @xmath94 [ 70  k ] , a stricter value than the previous @xmath41 [ 30  k ] of   [ sec : ext_spectral]-[sec : ext_spatial ] .",
    "the peripheral culling rejects hisa voxels with cgps field mosaic weights @xmath95 , the lowest weight that occurs between synthesis field centers . since @xmath96",
    ", this allows a maximum noise of 1.618 times the field center value ( see @xcite ) , which is typically @xmath97  k for the @xmath98  k levels of our hisa features .",
    "the choice of @xmath54  k is empirically based .",
    "as noted in paper  i and  [ sec : ext_strategy ] , finely - structured  emission is common in the cgps data where the total amount of emission is low , i.e. , off the plane and at interarm velocities . without some sort of @xmath99 filtering , the hisa identification software is easily fooled in these regions , flagging many false hisa features adjacent to and between sharp - edged emission .",
    "we are confident these are false hisa features , since the absorbing  would have to be unrealistically cold to absorb against such faint  backgrounds , and such apparently strong features are far less abundant in brighter emission fields where they should be easier to detect and where more gas should be found generally .",
    "there is no single @xmath42 value that excludes all such false hisa while retaining all real hisa .",
    "we chose @xmath54  k to balance these two needs , with greater priority placed on the first .",
    "for the cgps , 70  k rejects essentially all false hisa arising from sharp emission edges while keeping most real hisa .",
    "the model tests of  [ sec : eval ] show that the false hisa rejection is quite successful .",
    "a few cases of some real hisa being missed or truncated are discussed below and in paper  ii .",
    "figures  [ fig : real_hisa_id_maps_overview]-[fig : real_hisa_id_spectra ] illustrate the hisa amplitude extraction process with sample channel maps and spectra that include the same features shown in figures  [ fig : globule_spectrum_raw]-[fig : globule_xcut_hi_abs ] . these give the initial  data , the @xmath91 amplitudes computed in different stages of the analysis , and the final @xmath77 .",
    "as the figures show , most of the visually apparent hisa is readily extracted .",
    "some residual hisa remains in @xmath77 , but its amplitude is a few k at most ; the @xmath91 value of @xmath100  k extracted for the perseus globule is only 2  k weaker than that obtained with the more conservatively - chosen paper  i spatial @xmath78 boxes ( table  [ tab : cg_prop ] )",
    ".    the hisa identification software can not detect features larger than its clean scales [ 8  and 20 ] and instead flags only their darkest parts . to overcome this limitation",
    ", we feed the @xmath77 cubes back into our search algorithms to identify hisa missed on the previous pass (  [ sec : ext_strategy ] ) .",
    "subsequent @xmath91 extractions are made with unions of hisa flags from all prior search passes but always use the original data for @xmath78 .",
    "three such passes are adequate for the cgps  data set . of the hisa voxels",
    "extracted in all three passes , 86.5% were found in the first pass , 11.2% in the second , and only 2.3% in the third . for brevity , figures  [ fig : real_hisa_id_maps_overview]-[fig : real_hisa_id_spectra ] display only third - pass results , which differ little from the first pass for this example . a case with more dramatic differences between passes",
    "is illustrated in figures  [ fig : real_hisa_id_stage_maps ]  & [ fig : real_hisa_id_stage_spectra ] .",
    "features this big require multiple passes to capture .",
    "hisa flagging is significantly improved after the first pass in both the spatial and spectral domains .",
    "we show only first- and third - pass results here , since the second pass closely resembles the third .",
    "after three passes , hisa flagging is incomplete in only a few places due to @xmath101  k truncation , mostly near the northern edge of the map ( fig .",
    "[ fig : real_hisa_id_stage_maps ] ) . aside from minor losses from @xmath77 changes ,",
    "the flagged hisa generally increases , with the fraction of the total flagged per pass being 72.9% , 22.5% , and 4.6% for passes 1 , 2 , and 3 .",
    "the smooth @xmath102 structure in figures  [ fig : real_hisa_id_stage_maps ] & [ fig : real_hisa_id_stage_spectra ] shows that our @xmath77 estimation method follows the large - scale  emission brightness reasonably well .",
    "we have chosen to attribute fine - scale structure in @xmath76 to @xmath91 , leaving @xmath77 smooth on the scale of the hisa feature .",
    "this approach presumes that the absorbing gas is finely structured and the  background is not , consistent with our adopted hisa identification strategy (  [ sec : ext_strategy ] ) .",
    "such consistency allows the identified hisa structure to be removed so that subsequent search passes do not flag it again .",
    "if however some @xmath76 structure arises from @xmath77 ( e.g. , @xcite ) , the true @xmath91 is smoother than we have found .",
    "we feel that our choice of method is reasonable for most circumstances .",
    "small - scale  emission structure is common in the general ism but appears minimized in the bright , smooth  fields where we see most cgps hisa .",
    "the eye is the first means of identifying hisa features that meet the appropriate criteria , and the search algorithms of  [ sec : ext ] were designed primarily to mimic visual detection .",
    "however , the eye can be fooled ; for example , it often finds false patterns in noise , perhaps due to evolutionary pressures to spot predators @xcite .",
    "we made our hisa search and extraction algorithms as rigorous as possible , but they remain limited by a number of factors , including :    1 .   * @xmath77 faintness : * to avoid confusion with emission gaps at low column densities , hisa detection is blocked if @xmath101  k. where this occurs , small features or parts of large ones may be missed .",
    "* @xmath77 underestimation : * we assume @xmath77 is not finely structured and estimate it from @xmath78 voxels surrounding the hisa feature in 3-d . however , many hisa features occur near spectral emission peaks .",
    "if @xmath103 , then we underestimate @xmath77 and @xmath92 . both can also be underestimated if hisa flagging is incomplete and an unidentified `` penumbra '' of faint hisa contaminates @xmath78 .",
    "* noise degradation : * despite smoothing , some low - amplitude hisa will be lost to noise .",
    "whole features may be missed , or just their cores may be detected , making them appear smaller , clumpier , and more fragmented than they really are .",
    "in addition , false hisa detections will be introduced by noise fluctuations at low @xmath92 .",
    "* overlarge structure : * by design , the hisa search algorithms can not flag whole features larger than the adopted @xmath104 and @xmath105 clean filter scales .",
    "the use of multiple search passes eases this limitation but may not remove it entirely .",
    "* unresolved structure : * small - scale hisa structure may be diluted or missed entirely if undersampled .",
    "angular structure down to the @xmath106 cgps beam is seen ( paper  i ) , so smaller - scale structure seems likely .",
    "hisa linewidths narrower than the cgps nyquist limit of @xmath107 also exist @xcite .",
    "such linewidths are rare in random hica sight lines ( e.g. , @xcite ) , but since continuum backgrounds can be brighter than backgrounds , hica can include warmer absorbing gas than hisa , and it s possible that hisa lines may be narrower on average .",
    "hisa velocity dilution is thus a real concern in synthesis surveys , while angular dilution will be more severe for single - dish telescopes ; no present instrumentation can adequately sample both the angular and velocity structure of hisa .    to evaluate such limitations objectively and quantitatively , we tested our software s ability to extract hisa features from model  data .",
    "our goal was to understand ( 1 ) what fraction of hisa the software detects , ( 2 ) how many detections are false positives , and ( 3 ) how much the detected features differ in size and amplitude from their input versions .",
    "the model 21 cm spectral line cubes were sums of noisy , positive - amplitude emission backgrounds and noise - free , negative - amplitude absorption features .",
    "gas properties and radiative transfer effects were not considered , as these are irrelevant to the detection software s performance . to test this under varying conditions ,",
    "64 randomly - configured model cubes were made .",
    "each cube used the standard cgps pixel and channel sizes , with dimensions half those of a standard cgps mosaic cube for computational efficiency : @xmath108 ( @xmath109 voxels ) .",
    "sample model data are shown in figure  [ fig : hockey_pucks ] .",
    "each model hisa feature was given a cylindrical shape in the  line cube , with a gaussian velocity profile and a flat - disk spatial profile convolved with a 60  circular beam .",
    "although simple , these angular and velocity profiles are similar enough to typical hisa for testing purposes .",
    "the features , known as `` hockey pucks '' for their usually oblate aspects in the cgps voxel grid , are parameterized by their unconvolved angular fwhm @xmath110 , velocity fwhm @xmath111 , and ( negative ) central amplitude @xmath112 .",
    "2048 hockey pucks were inserted into each model cube with random sizes , amplitudes , and positions .",
    "the @xmath0 and @xmath112 distributions were uniformly random , except that puck overlaps in @xmath0 were prevented , with a minimum separation of 1 voxel enforced between pucks at an absorption threshhold of 0.005  k. the @xmath110 and @xmath111 distributions were skewed toward small features , with relative probabilities of @xmath113 and @xmath114 .",
    "this was done to counter the fact that larger pucks have more voxels .",
    "we measured angular and velocity widths locally from each voxel in the performance analysis (  [ sec : eval_anal ] ) , and @xmath115 and @xmath116 made our voxel - based size distributions more evenly sampled .",
    "the puck parameter ranges used were @xmath117 , @xmath118 , and @xmath119  k @xmath120 @xmath100  k. @xmath121 results in `` unresolved '' structures that get diluted in the cgps beam similarly , @xmath122  , which would occur for purely thermal linewidths at 2.73  k , would be unresolved by the cgps in velocity .",
    "both cases test the detection limits for fine - scale hisa structure . at the other extreme , the software s sensitivity to structures larger than the 20  and 8clean filter scales is also tested .",
    "the background emission fields were similarly constructed of random ensembles of cylindrically - symmetric components .",
    "these differed from the hockey puck absorption features in that they had positive amplitudes , simple gaussian angular profiles , and minimum sizes equal to the clean scales .",
    "they were also allowed to overlap and fill the entire cube , so we refer to them as emission components rather than discrete features .",
    "size ranges were @xmath123 and @xmath124 , with @xmath125 and @xmath126 the same as for the hisa pucks .",
    "the amplitude range was @xmath127  k @xmath128 @xmath129 $ ]  k , where the component volume @xmath130 , @xmath131 , and the @xmath132 distribution was further skewed as @xmath133 . these adjustments placed most of the power at large scales , as is seen in real  emission @xcite .",
    "4096 components were summed to make each model cube s emission field .",
    "this was subsequently rescaled to give a median brightness temperature of 70  k , so that half the cube on average would allow hisa detections , and @xmath134  k effects could be easily studied .    for greater realism",
    ", noise was added to the  model .",
    "a 3-d field of uncorrelated gaussian random voxel noise was convolved with a 60  fwhm gaussian beam and a 1.319  fwhm gaussian velocity point spread function ( psf ) to mimic the structure of correlated noise in the cgps data , and the _ rms _  noise amplitude was scaled to match the 6  k level found in cgps field centers filled with 100  k emission . unlike the cgps noise , the model noise does not vary with distance from field centers , its beam is declination - independent , and its velocity psf is not the true cgps velocity psf , which is the fourier transform of a gaussian truncated at 20% of peak amplitude , with an effective fwhm of @xmath135 channels .",
    "however , none of these differences should seriously affect the performance analysis .",
    "the same procedures used to search for hisa in the cgps data (  [ sec : ext ] ) were applied to the model data .",
    "the software performance was then evaluated by comparing the input and extracted absorption .",
    "each of the 64 model cubes was analyzed separately , and the results were merged afterward to maximize coverage of the model parameter space .",
    "four observables were extracted from the hisa data : the absorption amplitude @xmath91 , unabsorbed brightness @xmath77 , angular width @xmath136 , and velocity width @xmath137 of the absorption .",
    "all four were measured at each voxel @xmath0 position rather than on a per - feature basis , because the cgps hisa has complex structure , and properties can vary within one feature .",
    "however , @xmath136 and @xmath137 are still aggregate properties that depend on the local distribution of hisa around them .    the velocity width @xmath137 measures the line fwhm . for each hisa voxel , all hisa contiguous in @xmath79 at the same @xmath11 position is examined to find the channel with maximum @xmath92 . on either side of this channel , the closest channels for which @xmath138 are identified ; non - hisa channels with @xmath139 are included if necessary .",
    "the half - maximum velocities are refined to sub - channel accuracy by linear interpolation .",
    "the difference between them is @xmath137 .",
    "this @xmath137 is assigned to all hisa voxels in the same velocity grouping at the same @xmath11 .",
    "we make no attempt to correct for instrumental broadening ( e.g. , @xcite ) , since this is nontrivial for the complex line structure of some hisa , and only the narrowest features will be broadened significantly in the cgps .",
    "figure  [ fig : da_dv_examples ] shows a sample map of @xmath137 . on average , the broader linewidths occur in larger hisa features .    the angular width @xmath136 measures the diameter of the largest circle containing the @xmath11 position and zero non - hisa voxels at the same velocity .",
    "this scheme measures the edge - to - edge feature width on a local scale . unlike the fwhm - based @xmath137 , @xmath136 uses the full hisa extent .",
    "experiments with an angular fwhm proved too sensitive to complex internal structure in the @xmath140 distribution to be interpreted easily .",
    "the resulting @xmath136 measures can be a bit larger than the fwhm - based hockey puck @xmath110 , especially for large puck amplitudes @xmath112 , but since the same @xmath136 measure is taken of the hisa model inputs and outputs , the method is internally consistent .",
    "figure  [ fig : da_dv_examples ] illustrates how @xmath136 is measured . from each hisa voxel",
    ", the angular offset @xmath141 to the nearest non - hisa voxel with the same velocity is found .",
    "@xmath142 maps hisa `` skeletons '' whose ridge - like maxima equal half the local width of the feature . to build a @xmath136 map , we step over all @xmath11 positions and write @xmath143 to all points @xmath144 in a new map for which @xmath145 , where the largest imposed @xmath146 value is always retained .",
    "this yields the angular width of hisa filamentary structure at that velocity .",
    "the hisa extraction software s performance was measured in three ways : the `` throughput '' fraction @xmath147 of model hisa detected ; the `` true fraction '' @xmath148 of hisa detections corresponding with model input ; and the `` drifts '' @xmath149 , @xmath150 , @xmath151 , and @xmath152 between input and output properties . all were measured as functions of the hisa observables @xmath153 , which define a 4-d parameter space in which the software performance is evaluated .",
    "the @xmath0 positions and @xmath153 properties were first tabulated for all hisa voxels in both the input and output model @xmath0 cubes .",
    "the 4-d voxel count histograms @xmath154 and @xmath155 were constructed from these voxel tables , using bin dimensions of 2.5  k @xmath156 2.5  k @xmath156 0.5  @xmath156 0.5 . in parallel , the voxel count histogram @xmath157 was made from all input voxels with output at the same @xmath0 , and @xmath158 was made from all output voxels with input at the same @xmath0 .",
    "throughputs and true fractions were then derived as @xmath159 and @xmath160 . from the subset of voxels appearing in both",
    "the input and output hisa cubes , four 4-d drift histograms of the average changes undergone by @xmath161 , @xmath162 , @xmath163 , and @xmath164 as functions of @xmath165 were assembled , e.g. , as @xmath166 , with the average taken over all hisa voxels in @xmath0 with the same @xmath165 properties .",
    "the 4-d performance histograms were computed for all 64 hisa models , which were identical apart from different random number inputs .",
    "the results were merged together into a single set of histograms and smoothed with 4-d gaussians to improve the performance measure reliability and coverage of the parameter space .",
    "variable smoothing scales were used , because the parameter space coverage was sparser in some areas than in others .",
    "the smoothing fwhm were @xmath167 , @xmath168 , @xmath169 , and @xmath170 , with minimum values of 6.0  k , 6.0  k , 1.0 , and 1.319  to match the model @xmath171 and cgps resolution .",
    "this scheme preserved structure in the well - sampled parts of the parameter space and interpolated it smoothly elsewhere .",
    "@xmath155 histograms were also computed for all 36 mosaic cubes of real cgps hisa and summed together to assess the distribution of observed hisa in the survey . as with the hisa feature catalog in paper  ii , sight lines with @xmath172  k were excluded .        to examine general @xmath153 parameter distributions and trends , we made 2-d projections of the unsmoothed model @xmath173 and @xmath174 and the real cgps @xmath174 by summing the counts along the 2 other axes in the 4-d parameter space .",
    "a number of these 2-d projections are shown in figure  [ fig:4hist_counts ] .",
    "the input models fill ranges of @xmath175  k , @xmath176  k , @xmath177 , and @xmath178 , with peaks at @xmath179  k and small @xmath92 and @xmath136 ; the @xmath137 distribution was relatively flat .",
    "the peaked @xmath91 and @xmath136 distributions occurred despite the shapes chosen for the puck property distributions (  [ sec : eval_mod ] ) .",
    "the low-@xmath92 peak is due to faint hisa in feature line wings and spatial envelopes .",
    "the low-@xmath136 peak results from @xmath136 being measured from hisa voxels above a minimum @xmath92 , which makes pucks appear smaller off the line center . in a similar way , pucks with the same @xmath110 have greater @xmath136 if @xmath180 is larger , and no voxels with @xmath181  and @xmath182  k are found .",
    "the extracted model @xmath91 peak is shifted to @xmath183  k. a tail of strong absorption extends to @xmath184  k.",
    "although they account for only 2% of the total hisa voxels , these @xmath185  k points demonstrate that some @xmath91 drift occurs .",
    "the extracted @xmath77 is truncated at @xmath186  k but otherwise appears unchanged from the input model .",
    "large @xmath136 and @xmath137 values are both truncated as predicted in ",
    "[ sec : eval_mot ] , although less severely for @xmath136 , since the non - gaussian angular profiles better survive the clean process .",
    "iterative extraction (  [ sec : ext ] ) allows much of the puck structure @xmath187  to be recovered here , but the purely gaussian puck velocity profiles with @xmath188  are cleaned out of the data with great efficiency .",
    "peaks at the same location as the input data but is more concentrated .",
    "@xmath137 is also now concentrated toward low values .",
    "the cgps hisa @xmath91 has a larger range than in the extracted models , due to a few very strong features like ghisa 079.88@xmath1890.62@xmath18902 and ghisa 091.90@xmath1893.27@xmath19003 ( see paper  ii for feature details ) .",
    "its @xmath91 peak is similar to the models. the cgps hisa is truncated for @xmath101  k as well as @xmath191  k , where the maximum  brightness is reached .",
    "@xmath136 peaks at the same scale as the model output but has a lower maximum scale , perhaps because real hisa is more porous .",
    "the model output @xmath137 range is slightly exceeded .",
    "the @xmath137 peak and maximum value are both a little broader than for the extracted model hisa .",
    "the cgps hisa fills almost the same parameter space as the extracted model hisa .",
    "since some model parameter ranges are larger on input than output , the ranges of real hisa properties may exceed those observed in the cgps .",
    "hisa with @xmath101  k is already known ( e.g. , @xcite ) , and hisa with @xmath192 , @xmath193 , or @xmath194  k is possible , although @xmath195 is required by the 4-component radiative transfer equation ( paper  ii , eqn .  1 ) , where @xmath196 is the spin ( excitation ) temperature of the absorbing gas .",
    "also , @xmath136 is limited by feature porosity .",
    "ghisa 091.90@xmath1893.27@xmath19003 exceeds the @xmath136 limit in gross extent but is not completely solid .",
    "larger features are known ( e.g. , the @xcite `` cold cloud '' toward the galactic center ) , but their porosity at 1  resolution has not been reported .",
    "the input models had no built - in correlations of feature properties , and the same is largely true for the real hisa .",
    "certainly @xmath91 and @xmath77 are not related in the cgps , except that the strongest @xmath91 s prefer some @xmath77 values over others .",
    "however , the peak cgps @xmath136 and @xmath137 both increase gradually with @xmath92 out to @xmath197  k , @xmath198 , and @xmath199 .",
    "these trends have considerable scatter , and there are weaker versions in the extracted model hisa .",
    "but if they reflect real hisa behavior , then stronger absorption is more likely to have larger contiguous angular structure or broader linewidths , although @xmath136 and @xmath137 do not correlate as well with each other as they do with @xmath91 .",
    "figure  [ fig:4hist_fid_fot ] presents selected 2-d slices through the 4-d parameter space to illustrate the behavior of the throughput @xmath147 and true fraction @xmath148 .",
    "these have been smoothed as described in  [",
    "sec : eval_anal_meas ] .",
    "we find that most hisa is detected if it is significantly stronger than the noise , larger than a few beams , narrower than a few , and has @xmath200",
    "k. furthermore , the vast majority of detected hisa is reliable , except for hisa that can be mimicked by beam - scale noise fluctuations .",
    "the throughput is high for much of the parameter space : @xmath201 where @xmath202  k , @xmath200  k , @xmath203 , and @xmath204 , reaching a maximum of @xmath205 where all of these criteria are well - met .",
    "where one or more of them is not met , @xmath147 drops rapidly , with @xmath206 for @xmath207  k , @xmath208  k , @xmath209 , or @xmath210 . most of this behavior can be explained as losing features in the noise , underbright @xmath77 , or overbroad linewidths poorly fitted by the spectral search method s @xmath44 [ 4 ] gaussians (  [ sec : ext_spectral ] ) .",
    "however , low @xmath147 seems to occur for low @xmath136 even when @xmath92 is large .",
    "this suggests some beam - scale hisa features may be missed by our search if they are isolated from larger structures .",
    "the perseus hisa globule of paper  i is detected easily , but it is also attached to the complex ghisa 139.01@xmath1890.96@xmath19040 .    by contrast , narrow - line hisa is detected with great efficiency : high @xmath147 is found for @xmath137 as low as the 0.8  cgps channel width , so long as @xmath211  k. to allay the concerns of @xcite , lines narrower than this should also be detectable if their intrinsic amplitudes are larger to compensate for spectral dilution .",
    "a thermally broadened @xmath212  k hisa line would be diluted by a factor of 2.4 but easily detected if @xmath213  k. hisa of this strength or greater is common in the cgps .",
    "the true fraction has much simpler behavior : @xmath214 almost everywhere that @xmath202  k , @xmath215 , or @xmath216 . if none of these holds , noise fluctuations in the data produce significant false positive detections , with @xmath217 in the worst cases .",
    "figure  [ fig:4hist_drift ] illustrates trends in the parameter drifts @xmath149 , @xmath151 , and @xmath152 . since @xmath218 (  [ sec : ext_dt ] ) and @xmath76 is fixed , @xmath219 . with minor exceptions , the behavior of all the parameter drifts is fairly simple : @xmath92 and @xmath77 are often underestimated by a few k in well - detected features , while incomplete detections of large features ( e.g. , fig .",
    "[ fig : hockey_pucks ] ) cause @xmath136 and @xmath137 to be underestimated as well .",
    "the drift in @xmath91 is positive , i.e. , toward reduced amplitudes , if these three conditions are met : @xmath220 the 6  k noise level , @xmath221 80  k , and @xmath222 2 .",
    "if one of them is not met , @xmath223 .",
    "there is no strong dependence on @xmath137 .",
    "the amount of drift is typically a few k , with a range of @xmath224  k in most areas but more negative for @xmath225  k. the @xmath149 behavior has a similar shape to @xmath147 above , suggesting that detection sensitivity governs @xmath91 drift .",
    "features with intrinsically low @xmath92 , low @xmath77 , or very small @xmath136 appear to have larger @xmath92 ( and @xmath77 ) if they are detected .",
    "but @xmath147 shows most are _ not _ detected ; those that are represent a biased sample in which @xmath92 and @xmath77 happened to be boosted in the right direction to make them detectable . by contrast",
    ", easily detectable features appear to have lower @xmath92 than they should . since @xmath219 , their @xmath77 is underestimated as well ; one of the mechanisms noted in  [ sec : eval_mot ] may be to blame .",
    "but whether positive or negative , the magnitude of @xmath149 is usually only a few k. the large drifts that produced the @xmath91 outliers in the model @xmath174 results (  [ sec : eval_res_dist ] ; fig .",
    "[ fig:4hist_counts ] ) are exceptional cases .",
    "the drift in @xmath136 is negative everywhere that @xmath226 1 .",
    "it covers a range of @xmath227 , becoming steadily more negative for larger @xmath136 , with only minor dependencies on other parameters .",
    "the small positive drifts occur when @xmath228 hisa is augmented by beam - scale noise fluctuations ; @xmath228 can occur in the line wings of 1features , since pucks appear smaller off the line center (  [ sec : eval_res_dist ] ) .",
    "the much larger negative drifts are from those large features that are incompletely detected , as confirmed by visual inspection of the @xmath0 data ( e.g. , fig .",
    "[ fig : hockey_pucks ] ) .",
    "some of these partial detections are caused by @xmath134  k boundaries , but most are from noise . 2- and 3-@xmath229 noise fluctuations frequently poke holes in fairly strong features , reducing their @xmath136 measures .",
    "this is especially common in the line wings where @xmath92 is less .",
    "the drift in @xmath137 is positive only where both @xmath230 and @xmath231 and is negative everywhere else .",
    "it covers a range of @xmath232 , becoming steadily more negative for larger @xmath137 , with only minor dependencies on other parameters . as with @xmath151",
    ", noise degradation is a major cause of this @xmath152 trend .",
    "but in addition , the spectral hisa search itself is optimized for the detection of hisa linewidths @xmath233 , and gaussian features broader than 8  are cleaned out almost entirely (  [ sec : eval_res_fid_fot ] ) .",
    "lastly , features near emission peaks may have @xmath77 underestimated (  [ sec : eval_mot ] ) , leading to @xmath92 underestimates in line wings , and thus @xmath137 underestimation . since our @xmath77 estimation is not a simple linear interpolation (  [ sec : ext_dt ] ) , this effect may not be as severe as that noted by @xcite , but the @xmath234 results above for well - detected features suggest it is not zero either .",
    "@xcite also note that @xmath77 gradients will cause @xmath137 to be narrower than the hisa optical depth profile fwhm , and the line center in @xmath91 will appear shifted from @xmath235 , the maximum optical depth .",
    "however , the performance of our hisa software is only concerned with @xmath91 , so these biases do not apply here . and",
    "while our voxel - based evaluation method is not able to track changes of position , visual inspection shows that filaments and other structures within features do not shift between input and output ; only the centroids of whole features may shift if the features are not completely detected .",
    "these results have many uses .",
    "in addition to statistically describing how well hisa is detected , they can be applied directly to particular features to assess their reliability and completeness .",
    "the former is done by measuring @xmath153 at each hisa voxel @xmath0 position and interpolating @xmath148 from the 4-d histogram described in  [ sec : eval_res_fid_fot ] .",
    "@xmath148 is the likelihood that a hisa detection represents real absorption .",
    "we have determined @xmath148 for each cgps hisa voxel .",
    "figure  [ fig : feature_with_fot ] shows @xmath148 contours on a sample hisa feature .",
    "the hisa detection reliability in this case is quite high . in paper",
    "ii , we use @xmath236 in analyses of total cgps hisa coverage and the distributions of weak and strong absorption .",
    "we also assess the completeness of our hisa detections .",
    "the actual detection fraction @xmath147 is not recoverable from observed data , but we consider the fraction of detections with @xmath237  k , since such hisa has @xmath238 if its size and strength are appreciable (  [ sec : eval_res_fid_fot ] ) .",
    "we have described algorithms that identify and extract  self - absorption ( hisa ) features in high - resolution  21 cm line data cubes .",
    "these algorithms were designed to carry out a hisa survey of cold  in the initial @xmath239 phase of the arcminute - resolution canadian galactic plane survey ( cgps ) , but they should have more general applicability .",
    "our search algorithms use clean - based spatial and spectral filtering to remove large - scale emission structure and identify hisa as significant negative residuals .",
    "features identified in both spectral and spatial domains are flagged as hisa , and the unabsorbed brightness @xmath77 along the feature sightline is estimated from a 3-d interpolation of the off - feature brightness temperature @xmath78 .",
    "hisa detections in overly noisy regions are rejected , as are those for which @xmath101  k , lest significant false detections result from gaps between sharply - structured emission features with faint backgrounds . in order to capture features larger than the clean filter scale , identified hisa",
    "is removed and the search process is repeated ; a total of three such passes suffices for the cgps data .",
    "we performed detailed tests of our hisa - finding software with model data to determine its detection limits , false positive rates , and measurement biases as functions of feature size , amplitude , and background field brightness .",
    "the tests show that hisa is well detected within the software design criteria , with high detection rates for hisa significantly stronger than the noise level , larger than a few beams , narrower than a few , and with @xmath200  k. at the same time , the bulk of hisa detections are reliable , with very low false positive rates in most parts of the parameter space except those occupied by beam - scale noise fluctuations .",
    "measurement drifts are small in well - detected features , with @xmath77 underestimated by a few k due to contamination of @xmath78 by faint , undetected hisa near the feature . where detections are truncated by noise fluctuations or faint @xmath77",
    ", the bias may be somewhat larger .",
    "incomplete detections also make features appear smaller in angular size and linewidth than in reality due to truncation .",
    "this paper is the third in an ongoing series investigating hisa at high resolution in the galactic plane .",
    "a companion paper ( paper  ii ) presents hisa survey results for the cgps .",
    "subsequent papers will further analyze the cgps hisa and also examine hisa in cgps extensions and in the vla galactic plane survey .",
    "we thank w. mccutcheon , t. landecker , and j. stil for a number of useful discussions on this project , and the anonymous referee for constructive comments on the manuscript .",
    "j. stil helped with multipanel figure layout .",
    "we are very grateful to r. gooch for tireless computing support , including continued expansion of the capabilities of the karma visualization software package @xcite , which was used extensively for this work .",
    "the dominion radio astrophysical observatory is operated as a national facility by the national research council of canada .",
    "the canadian galactic plane survey ( cgps ) is a canadian project with international partners .",
    "the cgps is described in @xcite .",
    "the main cgps data set is available at the canadian astronomy data centre .",
    "the cgps is supported by a grant from the natural sciences and engineering research council of canada .",
    "the  data in the vicinity of @xmath240 have been revised from those used in paper  i. a single synthesis field was assigned the wrong flux scale in the  data used in that paper , and this error was not discovered until after publication . as a result , the hisa amplitudes presented in paper  i for the perseus hisa complex and globule features were in error , and the correct hisa amplitudes are smaller than those found in paper  i. with revised data , these features have warmer spin temperatures and lower optical depths than those derived in paper  i , but the column densities and masses are only mildly affected .",
    "table  [ tab : cg_prop ] lists the corrected results for both features .",
    "the correct globule spectrum is plotted in figure  [ fig : globule_spectrum_raw ] , and the positions of both features are marked in figure  [ fig : real_hisa_id_maps_zoom ] .",
    "the local hisa filament presented in paper  i was unaffected by this problem .",
    "baker , p. l. , & burton , w. b. 1979 , , 35 , 129 bania , t. m. , & lockman , f. j. 1984 , , 54 , 513 colgan , s. w. j. , salpeter , e. e. , & terzian , y. 1988 , , 328 , 275 feldt , c. 1993 , , 276 , 531 gibson , s. j. 2002 , asp conf .",
    "276 , _ seeing through the dust : the detection of  and the exploration of the ism in galaxies _ , eds .",
    "a. r. taylor , t. l. landecker , & a. g. willis , 235 gibson , s. j. , taylor , a. r. , dewdney , p. e. , & higgs , l. a. 2000 , , 540 , 851 ( paper  i ) gibson , s. j. , taylor , a. r. , higgs , l. a. , brunt , c. m. , & dewdney , p. e. 2005 , , submitted ( paper  ii ) gibson , s. j. , taylor , a. r. , stil , j. m. , higgs , l. a. , dewdney , p. e. , & brunt , c. m. 2004 , in _ how does the galaxy work ?",
    "a galactic tertulia with don cox and ron reynolds _ , eds .",
    "e. j. alfaro , e. prez , & j. franco ( dordrecht : kluwer academic publishers ) , 47 gooch , r. 1996 , asp conf .",
    "ser .  101 , _ astronomical data analysis software and systems v _ , eds . g. h. jacoby & j. barnes , 80 green , d. a. 1993 , , 262 , 327 hasegawa , t. , sato , f. , & fukui , y. 1983 , , 88 , 658 hgbom , j. a. 1974 , , 15 , 417 kavars , d. w. , dickey , j. m. , mcclure - griffiths , n. m. , gaensler , b. m. , & green , a. j. 2003 , , 598 , 1048 kerton , c. r. 2005 , , accepted knapp , g. r. 1974 , , 79 , 527 knee , l. b. g. , & brunt , c. m. 2001 , , 412 , 308 levinson , f. h. , & brown , r. l. 1980 , , 242 , 416 li , d. , & goldsmith , p. f. 2003 , , 585 , 823 mcclure - griffiths , n. m. , green , a. j. , dickey , j. m. , gaensler , b. m. , haynes , r. f. , & wieringa , m. h. 2001 , , 551 , 394 .",
    "mccutcheon , w. h. , shuter , w. l. h. , & booth , r. s. 1978 , , 185 , 755 minter , a. h. , lockman , f. j. , langston , g. i. , & lockman , j. a. 2001 , , 555 , 868 montgomery , a. s. , bates , b. , & davies , r. d. 1995 , , 273 , 449 peebles , p. j. e. 1993 , _ principles of physical cosmology _",
    "( princeton : princeton university press ) , 35 peters , w. l. , & bash , f. n. 1987 , , 317 , 646 riegel , k. w. , & crutcher , r. m. 1972 , , 18 , 55 steer , d. g. , dewdney , p. e. , & ito , m. r. 1984 , , 137 , 159 taylor , a. r. , et al .",
    "2003 , , 125 , 3145 taylor , a. r. , stil , j. m. , dickey , j. m. , mcclure - griffiths , n. m. , martin , p. g. , rothwell , t. , & lockman , f. j. 2002 , asp conf .",
    "276 , _ seeing through the dust : the detection of  and the exploration of the ism in galaxies _ , eds .",
    "a. r. taylor , t. l. landecker , & a. g. willis , 68 van der werf , p. p. , goss , w. m. , & vanden bout , p. a. 1988 , , 201 , 311    ll|cc|cc + & @xmath76 [ k ] &  69 &  71 &  47 &  62 + & @xmath78 [ k ] &  107 &  99 & 112 &  104 + & @xmath91 [ k ] & @xmath241 & @xmath242 & @xmath243 & @xmath244 + & + & @xmath196 [ k ] & @xmath245 & @xmath246 & @xmath247 & @xmath248 + & @xmath249 & @xmath250 & @xmath251 & @xmath252 & @xmath253 + & @xmath254 [ 10@xmath255  @xmath256 & @xmath257 & @xmath258 & @xmath259 & @xmath260 + & @xmath261 [ @xmath262 & @xmath263 & @xmath264 & @xmath265 & @xmath266 + & @xmath267 [ ] & @xmath268 & @xmath269 & @xmath270 & @xmath271 +   + & @xmath196 [ k ] & @xmath272 & @xmath272 & @xmath272 & @xmath272 + & @xmath249 & @xmath273 & @xmath274 & @xmath275 & @xmath276 + & @xmath254 [ 10@xmath255  @xmath256 & @xmath277 & @xmath278 & @xmath279 & @xmath280 + & @xmath261 [ @xmath262 & @xmath281 & @xmath281 & @xmath281 & @xmath281 + & @xmath267 [ ] & @xmath282 & @xmath283 & @xmath284 & @xmath285 + & @xmath286 [ 10@xmath255  @xmath256 & @xmath287 & @xmath288 & @xmath289 & @xmath290 + & @xmath291 [ @xmath262 & @xmath292 & @xmath292 & @xmath292 & @xmath292 + & @xmath293 [ ] & @xmath294 & @xmath295 & @xmath296 & @xmath283 + [ tab : cg_prop ]"
  ],
  "abstract_text": [
    "<S> we describe algorithms that detect 21 cm line  self - absorption ( hisa ) in large data sets and extract it for analysis . </S>",
    "<S> our search method identifies hisa as spatially and spectrally confined dark  features that appear as negative residuals after removing larger - scale emission components with a modified clean algorithm . </S>",
    "<S> adjacent hisa volume - pixels ( voxels ) are grouped into features in @xmath0 space , and the  brightness of voxels outside the 3-d feature boundaries is smoothly interpolated to estimate the absorption amplitude and the unabsorbed  emission brightness . </S>",
    "<S> the reliability and completeness of our hisa detection scheme have been tested extensively with model data . </S>",
    "<S> we detect most features over a wide range of sizes , linewidths , amplitudes , and background levels , with poor detection only where the absorption brightness temperature amplitude is weak , the absorption scale approaches that of the correlated noise , or the background level is too faint for hisa to be distinguished reliably from emission gaps . </S>",
    "<S> false detection rates are very low in all parts of the parameter space except at sizes and amplitudes approaching those of noise fluctuations . </S>",
    "<S> absorption measurement biases introduced by the method are generally small and appear to arise from cases of incomplete hisa detection . </S>",
    "<S> this paper is the third in a series examining hisa at high angular resolution . a companion paper ( paper  ii ) uses our hisa search and extraction method to investigate the cold atomic gas distribution in the canadian galactic plane survey . </S>"
  ]
}