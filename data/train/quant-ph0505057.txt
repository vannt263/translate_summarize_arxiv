{
  "article_text": [
    "quantum computers are many - body systems with a large but finite number @xmath1 of qubits because the efficiency of computation becomes relevant only when @xmath1 is large @xcite . although the entanglement is considered to play crucial roles in speedup as compared with classical computers @xcite , there are many types of entanglement and many measures or indices of entanglement for many - body systems @xcite .",
    "it is therefore interesting to explore which type of entanglement is relevant and which measure or index quantifies such entanglement .",
    "recently , an index @xmath0 of _ macroscopic entanglement _ , which implies that the state has superposition of macroscopically distinct states , was proposed and studied in refs .",
    "@xcite : a pure state , which is homogeneous or effectively homogeneous ( see refs .  @xcite and secs .",
    "[ sec : grover - analytic]-[sec : shor ] ) , is entangled macroscopically iff it has @xmath2 .",
    "although the term ` macroscopic entanglement ' are sometimes used in different ways , we follow these references .",
    "most importantly , the macroscopic entanglement _ as defined by this index _ is directly related to fundamental stabilities of many - body quantum states ( see ref .",
    "@xcite and sec .",
    "[ sec : p ] ) .",
    "moreover , it was shown rigorously that any _ pure _ states with @xmath2 in systems of _ finite _",
    "@xmath1 do _ not _ approach pure states in the _ infinite _ system as @xmath3 @xcite .",
    "noting that macroscopically entangled states have such anomalous properties , one of the authors gave the conjecture that a quantum computer should utilize macroscopically entangled states in some stages of the computation when it performs a quantum algorithm that is much more efficient than any classical algorithms ( ref .",
    "@xcite and sec .",
    "[ sec : conj ] ) .    in the previous paper @xcite",
    ", we confirmed this conjecture in the case of shor s factoring algorithm @xcite .",
    "since shor s algorithm is a representative quantum algorithm for solving structured problems @xcite , it is very interesting to study whether the conjecture is correct in the case of quantum algorithms for solving _ unstructured _ problems .",
    "furthermore , in ref .",
    "@xcite we identified macroscopic entanglement of only two states , the state after the modular exponentiation and the final state , among many quantum states appearing in shor s algorithm , because it was difficult to identify macroscopic entanglement of general states .",
    "it is also interesting to study whether the other states in shor s algorithm are entangled macroscopically .",
    "recently , an efficient method of calculating the index @xmath0 was developed and successfully applied to many - magnon states @xcite and to chaotic many - body states @xcite .",
    "this method , called the variance - covariance matrix ( vcm ) method , enables us to study the macroscopic entanglement of general states .    in this paper , we study macroscopic entanglement of quantum states of quantum computers performing grover s quantum search algorithm @xcite , which is a representative algorithm for solving unstructured problems @xcite .",
    "the results show that the above conjecture is correct also in this case .",
    "we also investigate macroscopic entanglement of all quantum states appearing in shor s factoring algorithm , using the vcm method , and the above conjecture is confirmed again .",
    "these results suggest the relevance of macroscopic entanglement in solving hard problems by quantum computers .",
    "the paper is organized as follows . in sec .",
    "[ sec : p ] , we briefly explain the index @xmath0 of the macroscopic entanglement . section [ sec : conj ] restates the conjecture in a more detailed form than refs .",
    "@xcite and @xcite .",
    "analytic results for grover s quantum search algorithm are given in sec .",
    "[ sec : grover - analytic ] , by which the conjecture is confirmed . to see details of evolution of entanglement , we present results of numerical simulations of a quantum computer that performs grover s quantum search algorithm in sec .",
    "[ sec : grover - numerical ] .",
    "shor s factoring algorithm is studied in sec .",
    "[ sec : shor ] , and the conjecture is again confirmed .",
    "discussions and conclusions are given in sec .",
    "[ sec : dc ] .",
    "the index @xmath0 of macroscopic entanglement was proposed and studies in refs .",
    "@xcite . in this section ,",
    "we briefly explain it to establish the notations and for reader s convenience .",
    "we consider quantum states which are homogeneous , or effectively homogeneous as in quantum chaotic systems @xcite and in quantum computers ( see secs .",
    "[ sec : grover - analytic]-[sec : shor ] and ref .",
    "for such a state , we consider a family of similar states of various sizes , and denote the state of size @xmath1 by @xmath4 .",
    "we say @xmath4 ( or a quantum system ) is _ macroscopic _ if for every quantity of interest the term that is leading order in @xmath1 gives the dominant contribution @xcite .",
    "we say @xmath4 is _ entangled macroscopically _ if the state has ` superposition of macroscopically distinct states ' @xcite .",
    "in general , however , the term in the quotation marks is quite ambiguous @xcite .",
    "for example , it would be obvious that a ` cat state ' @xmath5 of a quantum computer with @xmath1 qubits has such superposition , whereas how about the following state @xcite ? @xmath6    recently , a reasonable index @xmath0 of macroscopic entanglement was proposed for pure states @xcite . for @xmath7 , this index is defined by @xcite @xmath8 where @xmath9 and @xmath10 is an additive operator , i.e. , a sum of local operators @xcite ; see , e.g. , eqs .",
    "( [ add_op_0 ] ) below .",
    "the index @xmath0 ranges over @xmath11 ( see appendix [ appendix_range ] ) . according to refs .",
    "@xcite , a pure state is entangled macroscopically if @xmath2 @xcite , whereas it may be entangled but _ not _ macroscopically if @xmath12 .",
    "for example , the ` w state , ' @xmath13 , has @xmath14 , hence its entanglement is _ not _ macroscopic @xcite .",
    "this is reasonable because the w state corresponds to a single - magnon state in a ferromagnet , which is quite a normal state .",
    "since both the w state and product states have @xmath14 , they belong to the same class with respect to the macroscopic entanglement . on the other hand",
    ", we can show that @xmath2 for @xmath15 of eq .",
    "( [ eq : dws ] ) , hence is entangled macroscopically .",
    "physically , @xmath15 is superposition of single - domain - wall states which have different positions of the domain wall .    it is worth mentioning that a generalized index @xmath16 , which can be applied to mixed states as well , and a method for detecting macroscopic entanglement were proposed in ref .",
    "@xcite . however , we do not discuss these points in this paper because we treat pure states only .",
    "evaluation of a measure or index of entanglement often becomes intractable for large @xmath1 .",
    "fortunately , this is not the case for @xmath0 , i.e. , there is an efficient method of calculating @xmath0 @xcite .    for qubit systems",
    ", an additive operator can be expressed as @xmath17 .",
    "\\label{add_op_0}\\ ] ] here , @xmath18 and @xmath19 ( @xmath20 ) denote the identity and the pauli operators , respectively , acting on the qubit at site @xmath21 , and @xmath22 s and @xmath23 s are complex numbers which are independent of @xmath1 . for convenience ,",
    "we here allow non - hermitian additive operators , as in refs .  @xcite .",
    "since we are interested in @xmath24 , we henceforth drop @xmath25 from eq .",
    "( [ add_op_0 ] ) @xcite , i.e. , @xmath26 without loss of generality , we normalize @xmath23 s as @xmath27 the @xmath28 in eq .",
    "( [ def : p ] ) is thus taken over all possible choices of @xmath23 s satisfying this condition .",
    "let us define the variance - covariance matrix ( vcm ) for a pure state @xmath29 by @xmath30 where @xmath31 , @xmath32 , and @xmath33 .",
    "it was shown in ref .",
    "@xcite that the maximum eigenvalue @xmath34 of the vcm is related to @xmath0 of @xmath29 as @xmath35 hence , we can calculate @xmath0 by calculating @xmath34 , which can be done in a poly@xmath36 time because the vcm is a @xmath37 hermitian matrix .",
    "furthermore , from the eigenvector(s ) of the vcm corresponding to @xmath34 , we can find the _ maximally - fluctuating additive operator(s ) _",
    "@xmath38 , which satisfies @xcite @xmath39      it was shown in ref .",
    "@xcite that @xmath0 is directly related to fundamental stabilities , including decoherence and stability against local measurements , of many - body states @xcite . regarding decoherence by weak perturbations from noises or environments , it was shown that for any state with @xmath14 its decoherence rate @xmath40 by _ any _ of such perturbations _ never _ exceeds @xmath41 . for a state with @xmath2 , on the other hand",
    ", it is possible to _ theoretically construct _ a noise or environment that makes @xmath40 of the state @xmath42 .",
    "this does _ not _ necessarily mean that such a fatal noise or environment _ exists in real systems _ : it depends on physical situations @xcite . in this view , a more fundamental stability is the stability against local measurements , which was proposed and defined in ref .  @xcite . from the theorem proved there , we can see that a state with @xmath2 is _ not _ stable against local measurements , i.e. , there exists a _ local _",
    "observable by measurement of which the state changes drastically .",
    "furthermore , it was also proved rigorously that any _ pure _ states with @xmath2 in systems of _ finite _",
    "@xmath1 do _ not _ approach pure states in the _ infinite _ system as @xmath3 @xcite .",
    "these observations indicate that pure states with @xmath2 are quite anomalous many - body states .",
    "this led to the conjecture of ref .",
    "@xcite , which will be restated more clearly in sec.[sec : conj ] .",
    "if this conjecture is correct , @xmath0 is one of indices that are most directly related to efficiency of quantum computation , among many measures and indices of entanglement .",
    "this conjecture has been confirmed in ref .",
    "@xcite for shor s factoring algorithm , which is a representative algorithm for structured problems , and will be confirmed in this work for grover s quantum search algorithm , which is a representative algorithm for unstructured problems .    the index @xmath0 was also studied for many - magnon states in ref .",
    "@xcite , and for many - body chaotic states in ref .",
    "comparison with another measure of entanglement were also made in these references .",
    "most importantly , many states were found such that they are almost maximally entangled in another measure but their @xmath0 is minimum , @xmath14 .",
    "many other states are also found such that their @xmath0 is maximum , @xmath2 , but their entanglement is small in another measure .",
    "this demonstrates the well - known fact that a simple statement such as ` more efficiency of computation requires more entanglement ' is meaningless unless the measure or index of the entanglement is specified . in this paper , we focus on the macroscopic entanglement as measured by the index @xmath0 .",
    "consider a computational problem , the _",
    "fastest _ classical algorithm for which takes @xmath43 steps when the size of the input is @xmath1 bits .",
    "we consider quantum computers that solves the same problem . here , to be definite , we mean quantum circuits by ` quantum computers . '",
    "there are many different circuits for a single quantum algorithm .",
    "we say _ a quantum algorithm @xmath44 solves this problem much faster than classical algorithms _ if some quantum circuit of @xmath44 takes only @xmath45 steps which is much less than @xmath43 in the sense that @xmath46 \\over \\ln l } % { \\ln \\ln \\left [ q_{\\rm cl}^{\\rm min}(l ) / q(l ] \\right )   % \\over % \\ln",
    "l } \\geq \\mbox{a positive constant , for large $ l$}. \\label{eq : faster}\\ ] ] here , in the case of the search problem of grover , we count each oracle call as one step in defining @xmath43 and @xmath45 .",
    "let @xmath47 be the _ minimum _ number of qubits of such circuits that satisfy this inequality .",
    "our conjecture is as follows : if a quantum computer which has @xmath48 qubits performs @xmath44 with @xmath45 steps that satisfies inequality ( [ eq : faster ] ) , and if @xmath49 where @xmath50 denotes a constant that is independent of @xmath1 , then a macroscopically entangled state(s ) of size @xmath41 or more appears in the quantum computer during the computation @xcite .",
    "although it would be hard to determine @xmath47 of a general algorithm , we assume optimistically in this paper that the simple circuits of secs .  [ sec : grover - numerical ] and [ sec : shor ] for grover s quantum search and shor s factoring algorithms , respectively , would satisfy eq .",
    "( [ eq : l = l0+o1 ] ) .    in the case of grover",
    "s quantum search algorithm , for example , the left - hand side of inequality ( [ eq : faster ] ) approaches @xmath51 as @xmath3 ( thus the inequality is satisfied ) if the number of the solutions @xmath52 is @xmath53 .",
    "furthermore , it seems reasonable to assume that @xmath54 because the index register requires @xmath1 qubits , and more qubits may be required for the oracle , the conditional phase shift , and so on .",
    "as we will show in this paper , macroscopically entangled states of size @xmath41 indeed appear during the computation if @xmath55 .",
    "note that we are considering quantum computers which have almost the minimum number @xmath48 of qubits to perform @xmath44 .",
    "this is because it is generally possible to mask macroscopic entanglement if one can add arbitrarily many qubits to the computer .",
    "we exclude such uninteresting possibility by imposing eq .",
    "( [ eq : l = l0+o1 ] ) .",
    "however , it is worth mentioning that one can easily generalize the above conjecture to the case where a quantum error correction @xcite is used in the computer .",
    "that is , although the number of _ physical _ qubits does not satisfy eq .",
    "( [ eq : l = l0+o1 ] ) in such a case , one can identify each _ logical _ qubit with a large qubit .",
    "then , eq .  ( [ eq : l = l0+o1 ] ) is satisfied for the number of the large qubits , and the conjecture can be applied if the macroscopic entanglement is defined in terms of the large qubits .",
    "since we only consider pure states in this paper , a macroscopically entangled state is a state with @xmath2 .",
    "hence , the above conjecture may be stated roughly as follows : _ a quantum algorithm that is much faster than classical algorithms utilizes some state(s ) with @xmath2_. note that this does _ not _ claim that _ all _ states with @xmath2 would be useful to fast quantum computation .",
    "in particular , the conjecture does _ not _ claim that _ all _ macroscopically entangled states appearing in the computation would be relevant to fast quantum computation .",
    "this point will be discussed in secs .",
    "[ sec : relevance - g ] and [ sec : relevance - s ] by showing examples .",
    "furthermore , the following fact is worth mentioning .",
    "for some macroscopically entangled states of size @xmath1 , there are quantum circuits that convert a product state into such a state in @xmath41 steps _ if the target state with @xmath2 is known _ when the circuits are designed .",
    "this fact has _ nothing _ to do with our conjecture .",
    "the point is that in quantum computation the states that appear at , e.g. , the middle point of the computation are _ unknown _ when the circuits are designed , because the states depend on the solutions of the problems to be solved .",
    "the above conjecture claims the appearance of macroscopically entangled states in this case .",
    "consider the problem of finding a solution to the equation @xmath56 among @xmath57 possibilities , where @xmath58 is a function , @xmath59 if the number @xmath52 of solutions is @xmath53 , this ` search problem ' is hard in the sense that classical algorithms take @xmath60 steps .",
    "a quantum computer using grover s quantum search algorithm solves this problem much faster , with @xmath61 steps @xcite , and inequality ( [ eq : faster ] ) is satisfied .",
    "hence , grover s algorithm is a representative quantum algorithm for unstructured problems @xcite .",
    "we investigate the index @xmath0 of quantum states appearing in a quantum computer that performs this algorithm . as a quantum computer , we consider the index register of @xmath1 qubits , and thus eq .",
    "l = l0+o1 ] ) is clearly satisfied .",
    "suppose that the equation @xmath56 has @xmath52 solutions @xmath62 .",
    "if we put @xmath63 then the state @xmath64 just after the first hadamard transformation ( see eq .",
    "( [ hadamard ] ) below ) is represented as @xcite @xmath65 here , the angle @xmath66 is given by @xmath67 the grover iteration @xmath68 , where @xmath69 denotes the oracle operator , performs the rotation by angle @xmath66 in the direction @xmath70 in the two - dimensional subspace spanned by @xmath71 and @xmath72 .",
    "the state @xmath73 after @xmath74 ( @xmath75 ) iterations is therefore given by @xcite @xmath76 hence , by repeating the grover iteration @xmath77 times , one can find a solution to the search problem with probability @xmath78 .",
    "here , @xmath79 denotes the smallest integer among those larger than or equal to @xmath80 . when @xmath81 , in particular , we have @xmath82 and @xmath83      when @xmath84 , eqs .",
    "( [ eq : alpha ] ) and ( [ eq : beta ] ) reduce to @xmath85 and @xmath86 , respectively .",
    "since @xmath64 and @xmath87 are product states , we find that @xmath14 for @xmath64 , @xmath71 and @xmath72 . for @xmath73 , on the other hand , eq .",
    "( [ eq : g^kpsiht= ] ) gives the expectation value of the ` @xmath88 component of the magnetization ' @xmath89 as @xmath90 on the other hand , @xmath91 equations ( [ eq : pkmxpk ] ) and ( [ eq : pkmx2pk ] ) yield @xmath92 we thus find that @xmath93 , i.e. , @xmath2 , if @xmath94 in a similar manner , we can also show that @xmath95 , where @xmath96 , for these states .",
    "[ in order to show that @xmath2 for @xmath73 , it is sufficient to find _ one _ additive observable which fluctuates macroscopically , as seen from the definition ( [ def : p ] ) . ] since @xmath97 , condition ( [ eq : sin2=o(1 ) ] ) is satisfied for _ all _ @xmath74 such that @xmath98 where @xmath99 is an arbitrary small positive constant independent of @xmath100 . for example ,",
    "all @xmath74 s such that @xmath101 satisfy this condition , according to eq .  ( [ rapprox ] ) .",
    "we therefore conclude that most @xmath73 s in the grover iteration processes are entangled macroscopically ( i.e. , @xmath2 ) when @xmath84 , whereas @xmath14 for the initial and final states .",
    "note that the above result explicitly shows that @xmath0 is well defined for @xmath73 s , although they are _ not _ strictly homogeneous in general .",
    "we say this fact as ` @xmath73 s are _ effectively homogeneous _ , ' as in refs .",
    "@xcite .      when @xmath55 and @xmath102 , we have @xmath103 and @xmath104 . since @xmath64 is a product state , @xmath14 for @xmath64 and @xmath71 .",
    "however , unlike the case of @xmath84 , @xmath72 can have @xmath2 .",
    "for example , suppose that @xmath105 and the two solutions are @xmath106 and @xmath107 .",
    "then , @xmath108 is a state with @xmath2 because @xmath109 , where @xmath110 .    for @xmath73 with @xmath111 , on the other hand , eqs .",
    "( [ eq : pkmxpk])-([eq : pkmx2pk-2 ] ) hold also in this case . hence , the discussion including eqs .",
    "( [ eq : sin2=o(1 ) ] ) and ( [ eq : cond - k ] ) also holds .",
    "therefore , we conclude that _ most @xmath73 s in the grover iteration processes are entangled macroscopically , i.e. , @xmath2 , when @xmath55 _ , whereas @xmath14 for the initial state . for the final state ,",
    "@xmath0 depends on the nature of the solutions .",
    "the case of @xmath55 is most important and interesting because condition ( [ eq : faster ] ) is clearly satisfied .",
    "in contrast , the cases of large @xmath52 such as @xmath113 and @xmath112 are uninteresting because condition ( [ eq : faster ] ) is not satisfied . for completeness , however , we briefly discuss the case of @xmath112 as an example of such uninteresting cases .",
    "when @xmath112 , grover s algorithm does not necessarily use macroscopically entangled states .",
    "for example , suppose that @xmath100 is a multiple of @xmath114 and all multiples of @xmath114 less than @xmath100 are solutions .",
    "then , @xmath115 .",
    "hence , all @xmath73 s are product states except for the last three qubits .",
    "since entanglement of @xmath53 qubits can not be the macroscopic entanglement , we find that @xmath14 for all @xmath73 s .",
    "this does not contradicts with the conjecture of sec .",
    "[ sec : conj ] because condition ( [ eq : faster ] ) is not satisfied when @xmath112 .      from the results of secs .",
    "[ sec : m=1 ] and [ sec : m = o(1 ) ] , we confirm the conjecture of sec .  [ sec : conj ] for grover s quantum search algorithm , at least for the most important case of @xmath55 . on the other hand , as mentioned in sec .",
    "[ sec : conj ] , the conjecture does _ not _ claim that _ all _ macroscopically entangled states appearing in the computation would be essential to fast quantum computation .",
    "we now study this point .",
    "when @xmath116 , we have seen that most @xmath73 s such that inequality ( [ eq : cond - k ] ) is satisfied are entangled macroscopically ( i.e. , @xmath2 ) , whereas the final state @xmath117 may or may not be so depending on the number and natures of the solutions .",
    "this fact suggests the following : the macroscopic entanglement of most @xmath73 s should be relevant to the speedup by grover s algorithm , whereas the macroscopic entanglement of the final state ( and states close to the final state ) should be irrelevant .",
    "we argue that this is indeed the case .",
    "the irrelevance of any entanglement of the final state is obvious .",
    "in fact , to get a solution one performs measurement on @xmath118 are destroyed by , say , external noises , the probability distribution of @xmath88 , and thus the success probability of getting a solution , is almost unaffected because the measurement diagonalizes the computational basis , which includes @xmath119 .",
    "in contrast , if the macroscopic entanglement of one of @xmath73 s which satisfy inequality ( [ eq : cond - k ] ) is destroyed , the success probability is significantly reduced .",
    "for example , for @xmath120 with @xmath84 , we have @xmath121 which is entangled macroscopically because @xmath122 and @xmath87 are macroscopically distinct from each other . if the quantum coherence between @xmath64 and @xmath87 are destroyed in @xmath120 , the state turns into the mixed state , @xmath123 if one applies the grover iterations another @xmath124 times , this state evolves into @xmath125 when one performs measurement diagonalizing the computational basis on this degraded final state , the probability of getting the correct result @xmath126 is quite small because @xmath127 is much different from @xmath87 .",
    "therefore , the macroscopic entanglement of @xmath120 , i.e. , the quantum coherence between @xmath64 and @xmath87 , is crucial to faster computation . in a similar manner",
    ", we can show that the macroscopic entanglement of most @xmath73 s is crucial to faster computation .",
    "in the analysis of sec .  [ sec : grover - analytic ] , we have considered entanglement of @xmath128 ( @xmath129 ) . in actual quantum computations , the grover iteration @xmath130 is realized as a series of local and pair - wise operations @xcite .",
    "hence , many intermediate states appear during the steps between @xmath73 and @xmath131 . although the macroscopic entanglement of @xmath73 s is sufficient for confirming our conjecture , we now study entanglement not only of @xmath73 s but also of such intermediate states in order to see details of evolution of entanglement . for this purpose , we numerically simulate a quantum computer that performs grover s quantum search algorithm . as in the previous section ,",
    "we consider the index register of @xmath1 qubits as a quantum computer , and thus eq .  ( [ eq : l = l0+o1 ] ) is clearly satisfied .",
    "we simulate the case of @xmath84 because this case is most fundamental in the search problem .",
    "the solution @xmath132 is chosen randomly .",
    "we have confirmed that this random choice of a solution makes no significant differences on the results of the numerical simulations presented below .    as the initial state , a register @xmath133 composed of @xmath1 qubits",
    "is set to be the following product state ; @xmath134 firstly , the hadamard transformation is performed by successive applications of the hadamard gate on individual qubits in @xmath133 , and the quantum state evolves into @xmath135 then we apply the grover iteration @xmath136 , which consists of two hadamard transformations , an oracle operation @xmath137 , and a conditional phase shift @xmath138 , which works as @xmath139 each hadamard transformation requires @xmath1 operations of the hadamard gate .",
    "the oracle @xmath137 is constructed depending on the function @xmath140 , and requires its own workspace qubits and computational steps .",
    "however , since the oracle is not a proper part of the grover s algorithm , we simulate the operation of @xmath137 as a one - step operation , and its workspace is not included in the simulation .",
    "the execution of the conditional phase shift @xmath138 requires @xmath41 pairwise unitary operations . for simplicity ,",
    "we simulate @xmath138 as a one - step operation . as a result",
    ", each grover iteration is simulated by @xmath141 steps of operations .",
    "after the applications of the grover iterations @xmath142 times , the state @xmath143 evolves to @xmath144 finally , by performing a measurement on @xmath133 , one can obtain the solution @xmath132 with a sufficiently high probability .",
    "we do not simulate this measurement process .",
    "the total computational steps @xmath45 in our simulation is thus @xmath145      figure [ grover9 ] plots @xmath146 along the steps of grover s algorithm , for @xmath147 when @xmath148 , respectively .",
    "figure [ initial_g ] is a magnification from the @xmath51st to @xmath149th steps for @xmath150 , whereas a magnification from the @xmath151th to @xmath152th steps for @xmath153 is shown in fig .",
    "[ middle_g ] .     of the vcm of quantum states appearing in grover",
    "s quantum search algorithm for @xmath147 when @xmath148 , respectively , as functions of the step of the algorithm .",
    "the horizontal line represents the value of @xmath146 for product states , @xmath154 . ]    , from the @xmath51st to @xmath149th steps for @xmath150 . `",
    "ht ' represents the hadamard transformation , whereas @xmath69 and @xmath155 represent the oracle operation and conditional phase shift , respectively , in a single grover iteration @xmath130 .",
    "]    , from the @xmath151th to @xmath152th steps for @xmath153 . `",
    "ht ' represents the hadamard transformation , whereas @xmath69 and @xmath155 represent the oracle operation and conditional phase shift , respectively , in a single grover iteration @xmath130 . ]",
    "it is seen that @xmath154 for all states from @xmath156 to @xmath143 , i.e. , during the initial hadamard transformation , which is denoted as ` ht ' from the @xmath51st to @xmath114th steps in fig .",
    "[ initial_g ] .",
    "this is because all these states are product states , for which we can easily show that @xmath157 ( appendix [ appendix ] ) .",
    "when the stage of grover iterations begins , @xmath146 grows gradually , as seen from figs .",
    "[ grover9 ] and [ initial_g ] . in each grover iteration ,",
    "[ initial_g ] and [ middle_g ] show that @xmath146 changes when @xmath69 is operated , whereas it is kept constant during the subsequent hadamard transformation .",
    "then , it changes again when @xmath155 is operated , whereas it is kept constant again during the subsequent hadamard transformation .",
    "as the grover iterations are repeated , @xmath146 continues to increase as a whole , until it takes the maximum value after about @xmath124 times applications of @xmath130 .",
    "further applications of @xmath130 reduce @xmath146 , as seen from fig .",
    "[ grover9 ] , toward @xmath158 for @xmath159 , which is approximately a product state as seen from eq .",
    "( [ grpsi0 ] ) .    to determine @xmath0",
    ", we note that @xmath146 s are of the same order of magnitude for all states from @xmath160 to @xmath161 for each @xmath1 , as seen from figs .",
    "[ initial_g ] and [ middle_g ] .",
    "hence , they have the same value of @xmath0 as @xmath160 .",
    "therefore , from the result of the previous section , we conclude that all states from @xmath160 to @xmath161 have @xmath2 for all @xmath74 which satisfies inequality ( [ eq : cond - k ] ) . as a demonstration , we plot @xmath146 s of @xmath162 , @xmath163 and @xmath164 in fig .",
    "[ maxflug ] as functions of @xmath1 .",
    "since @xmath146 s are all proportional to @xmath1 , we can confirm that @xmath2 , i.e. , these states are entangled macroscopically .",
    "note that fig .",
    "[ maxflug ] also demonstrates again that @xmath0 is well defined , although the states are not strictly homogeneous .",
    "s of @xmath162 ( diamonds ) , @xmath163 ( crosses ) and @xmath164 ( squares ) , as functions of @xmath1 .",
    "the dotted lines are the guides to the eyes , whereas the horizontal line represents the value of @xmath146 for product states , @xmath154 . ]",
    "the results of secs .",
    "[ sec : grover - analytic ] and [ sec : grover - numerical ] for grover s quantum search algorithm , which is a representative algorithm for unstructured problems , are summarized as follows .",
    "when the number of solutions @xmath116 , the search problem is hard in the sense that classical algorithms take @xmath60 steps .",
    "this case is most important and interesting because condition ( [ eq : faster ] ) is clearly satisfied . in this case",
    ", we have shown that most @xmath73 s in grover s algorithm are entangled macroscopically ( @xmath2 ) , and thus the conjecture of sec .",
    "[ sec : conj ] is confirmed .",
    "we have also found that the final state @xmath117 may or may not be so depending on the number and natures of the solutions .",
    "the conjecture does _ not _ claim that _ all _ macroscopically entangled states appearing the computation would be relevant to fast quantum computation .",
    "we have shown that the macroscopic entanglement of most @xmath73 s is crucial to faster computation , whereas that of the final state is irrelevant .",
    "the cases of large @xmath52 such as @xmath113 and @xmath112 are uninteresting in view of quantum computation because condition ( [ eq : faster ] ) is not satisfied . for completeness",
    ", we briefly discuss the case of @xmath112 as an example of such uninteresting cases , and have shown that grover s algorithm does not necessarily use macroscopically entangled states .",
    "in this section , we study shor s factoring algorithm @xcite , as a representative algorithm for structured problems @xcite .",
    "let @xmath165 be a positive integer to be factored , @xmath166 a random number co - prime to @xmath165 which satisfies @xmath167 , and @xmath168 the ` order , ' i.e. , the least positive integer which satisfies @xmath169 ( @xmath170 ) .",
    "for a given pair of @xmath165 and @xmath166 , one can find the value of @xmath168 efficiently using shor s algorithm .",
    "the first and second registers are denoted by @xmath171 and @xmath172 , respectively , which have @xmath1 and @xmath173 qubits .",
    "we take @xcite @xmath174 we assume that this model satisfies eq .",
    "( [ eq : l = l0+o1 ] ) . note , however , that even if @xmath172 could be replaced with a shorter register , the main result of this section would not change because , as shown below , only the qubits of @xmath171 are entangled macroscopically .",
    "the initial state @xmath175 is the product of two product states @xmath176 and @xmath177 of @xmath171 and @xmath172 , respectively .",
    "we denote by @xmath178 , @xmath179 , and @xmath180 the states just after the hadamard transformation , modular exponentiation ( me ) , and discrete fourier transformation ( dft ) , respectively . for the dft",
    ", we employ the quantum circuit of sec .  v of ref .",
    "@xcite , which costs @xmath181 steps .",
    "the final states is @xmath180 . as in ref .",
    "@xcite , we represent the process @xmath182 simply as the product of @xmath1 controlled unitary transformations , because @xmath171 takes a major role @xcite . as a result",
    ", the states appearing during the modular exponentiation in our simulations correspond to @xmath1 representative states out of @xmath183 states . as a result of this simplification ,",
    "the total number @xmath45 of computational steps in our simulation becomes @xmath184 which is smaller than @xmath183 steps of a real computation . to find the macroscopic entanglement",
    ", we shall evaluate @xmath146 of the states that appear during the computation , as a function of @xmath185 .",
    "[ since @xmath186 , we will obtain the same results for @xmath0 if we evaluate @xmath146 as a function of @xmath1 . ]",
    "figure [ n21y2r6 ] plots the maximum eigenvalue @xmath146 of the vcm along the steps of the algorithm , when @xmath187 , for which @xmath188 .",
    "it is seen that @xmath154 for all states from @xmath156 to the end of the hadamard transformation .",
    "this is because all these states are product states , for which @xmath157 ( appendix [ appendix ] ) . when the stage of the modular exponentiation begins , @xmath146 grows , until it becomes @xmath189 for @xmath179",
    "then , throughout the stage of the discrete fourier transformation , @xmath146 keeps large values , slightly changing step by step .     of quantum states appearing in shor",
    "s factoring algorithm when @xmath187 , for which @xmath188 , as a function of the step of the algorithm . ]     of quantum states appearing in shor s factoring algorithm when @xmath190 , for which @xmath188 , as a function of the step of the algorithm . ]    for other values of @xmath191 , and thus for other values of @xmath192 according to eq .",
    "( [ l1l2 ] ) , we find that @xmath146 behaves similarly if @xmath191 gives @xmath188 .",
    "for example , fig .",
    "[ n104y55r6 ] plots @xmath146 when @xmath193 , for which @xmath188 again , and @xmath194 .",
    "it is seen that @xmath146 behaves similarly to the case of fig .",
    "[ n21y2r6 ] . therefore , as in ref .",
    "@xcite , we study the dependence of @xmath146 on @xmath192 by varying @xmath191 _ under the condition that it gives the same value of the order @xmath168 _ , @xmath188 . in this case , the states in shor s algorithm become effectively homogeneous for which @xmath0 is well defined , as shown in ref .",
    "@xcite and in the following .",
    "figure [ maxflus ] plots the @xmath192 dependence of @xmath146 that is calculated in this way for three representative states including @xmath195 , the state at the @xmath196-th step of the dft stage ( i.e , just after the pair - wise unitary transformations targeting @xmath197 qubits of @xmath171 are finished ) , and the final state @xmath198 . for each state , @xmath146 increases linearly with increasing @xmath192 .",
    "therefore , @xmath2 for these states . in a similar manner",
    ", we find that all states after the modular exponentiation have @xmath2 for @xmath188 , i.e. , they are macroscopically entangled .",
    "we have also obtained the same conclusion for other values of @xmath168 ranging from @xmath199 to @xmath200 , except when @xmath168 becomes an integral power of @xmath199 ( i.e. , @xmath201 ) , for which we find that states with @xmath2 are not necessarily used .     of @xmath195 ( diamonds ) , the state at the @xmath196-th step of the dft stage ( squares ) , and the final state @xmath198 ( crosses ) , for @xmath188 , as functions of @xmath185 .",
    "the horizontal line represents the value of @xmath146 for product states , @xmath154 . ]    note that we already found in the previous work @xcite that the _ two _ states , @xmath179 and @xmath180 , are macroscopically entangled by studying _",
    "specific _ additive operators . in the present work , in contrast",
    ", we have proved the macroscopic entanglement of _ all _ states after the modular exponentiation , by surveying _ all _ possible additive operators by the vcm method .",
    "this demonstrates the power of the vcm method .",
    "another advantage of the vcm method is that one can identify the maximally - fluctuating additive operator(s ) from the eigenvector(s ) corresponding to @xmath146 .",
    "for example , @xmath179 for @xmath188 have two degenerate eigenvectors corresponding to @xmath146 , from which we find that the following two operators are the maximally - fluctuating additive operators : @xmath202 for other values of @xmath168 , other operators become the maximally - fluctuating additive operators . in particular , the absence of operators of @xmath203 in eqs .",
    "( [ a_1 ] ) and ( [ a_2 ] ) are accidental , i.e. , such operators are included in the sums of the maximally - fluctuating additive operators for other values of @xmath168 .",
    "note that @xmath204 and @xmath205 do not contain operators of the second register @xmath206 .",
    "this fact shows that the first register @xmath207 are entangled macroscopically , whereas @xmath206 is not , in consistency with the result of ref .",
    "@xcite .      in the above simulations of shor s algorithm ,",
    "measurement is not performed during the quantum computation . in the original paper by shor @xcite , on the other hand , measurement diagonalizing the computational basis is performed on @xmath172 when the stage of the modular exponentiation is finished @xcite .",
    "we also simulate this case .",
    "of quantum states appearing in shor s factoring algorithm with measurement of the second register at the end of the modular exponentiation , when @xmath187 , for which @xmath188 , as a function of the step of the algorithm .",
    "after the measurement , denoted by the asterisk , two different profiles of @xmath146 appear depending on the outcome of the measurement . ]",
    "figure [ n21y2r6_m ] plots @xmath146 under the same condition as fig .",
    "[ n21y2r6 ] except that the measurement is performed at the end of the modular exponentiation . by the measurement ,",
    "the state of @xmath172 is determined to be one of the states @xmath208 where @xmath209 .",
    "therefore , @xmath146 can take @xmath168 different profiles after the measurement .",
    "only two different profiles of @xmath146 appear in fig .",
    "[ n21y2r6_m ] because those for @xmath210 happen to be identical and those for @xmath211 happen to be identical .",
    "both profiles of @xmath146 are quite similar to the profile of fig .",
    "[ n21y2r6 ] .",
    "therefore , the measurement on @xmath172 at the end of the modular exponentiation does not suppress the macroscopic entanglement .",
    "we have found that in shor s factoring algorithm _ all _ states after the modular exponentiation are macroscopically entangled for almost all nontrivial values of @xmath212 , i.e. , except for the special case where their values are such that the order @xmath168 becomes an integral power of @xmath199 .",
    "[ this exceptional case will be discussed again in sec .",
    "[ sec : dc ] . ]",
    "this again supports the conjecture of sec .",
    "[ sec : conj ] .",
    "however , as in the grover s algorithm , this does _ not _ mean that all of such states could be relevant to the faster computation .",
    "in fact , we already showed in ref .",
    "@xcite that the macroscopic entanglement of the final state @xmath180 is irrelevant to the faster computation , whereas that of @xmath179 is crucial",
    ". this crucial macroscopic entanglement of @xmath179 does not disappear even if measurement is performed on the second register just after the modular exponentiation is finished .",
    "therefore , as in the grover s algorithm , macroscopic entanglement plays an essential role in shor s factoring algorithm .",
    "we have investigated macroscopic entanglement of quantum states in quantum computers that perform grover s quantum search algorithm and shor s factoring algorithm . here , we say a state is entangled macroscopically iff it has superposition of macroscopically states . as a well - defined index of macroscopic entanglement , we have employed the index @xmath0 that was proposed and studied in refs .",
    "@xcite . using the method developed in ref .",
    "@xcite , we have calculated this index as a function of the step of each algorithm .    for both algorithms",
    ", we have found that whether macroscopically entangled states are used or not depends on the numbers and properties of the solutions to the problem to be solved . when the solutions are such that the problem becomes hard in the sense that classical algorithms take more than polynomial steps to find a solution , macroscopically entangled states are always used in grover s algorithm and used almost always ( i.e. , except when the order @xmath168 is an integral power of @xmath199 ) in shor s algorithm .",
    "since grover s and shor s algorithms are representative ones for unstructured and structured problems , respectively , our results support strongly the conjecture ( see sec .  [",
    "sec : conj ] ) that quantum computers should utilize macroscopically entangled states that is defined by @xmath0 in some stages of the computation when they solve hard problems much faster than any classical algorithms .",
    "note that there are many different states with @xmath2 in many - qubit systems . which ones are used depends on the quantum algorithms and the inputs .",
    "note in particular that this conjecture does _ not _ claim that _ all _ states with @xmath2 would be useful in quantum computation .",
    "furthermore , among states with @xmath2 that do appear during quantum computation , some can be irrelevant to efficient computation , as discussed in secs .",
    "[ sec : relevance - g ] and [ sec : relevance - s ] and in ref .",
    "@xcite .",
    "it is interesting to take the contraposition of the conjecture , i.e. , _ if macroscopically entangled states are not used throughout a quantum algorithm which satisfies eq .",
    "( [ eq : l = l0+o1 ] ) then there must exist a classical algorithm that can solve the problem as efficiently as the quantum algorithm , i.e. , inequality ( [ eq : faster ] ) is not satisfied_. this may be used to explore _ classical _ algorithms with the help of knowledge about quantum algorithms .",
    "for example , we have found that shor s factoring algorithm does _ not _ necessarily use macroscopically entangled states in the exceptional case where the order @xmath168 is an integral power of @xmath199 . according to the above contraposition",
    ", this suggests that there would exist a classical algorithm that efficiently solve the problem in this special case .",
    "we thank a. hosoya for valuable discussions .",
    "the range of @xmath0 is @xmath11 . for a system composed of l qubits ,",
    "this can easily be shown as follows @xcite .",
    "let @xmath213 be the eigenvalues of the variance - covariance matrix @xmath214 , eq .",
    "( [ vcm ] ) , which is a @xmath37 non - negative hermitian matrix . since @xmath215 for every @xmath216 and @xmath21",
    ", we find @xmath217 therefore , according to eq .",
    "( [ emax = lp-1 ] ) , @xmath218 .",
    "on the other hand , @xmath219 because @xmath220 these arguments can be easily generalized to more general systems .",
    "in this appendix , we show that @xmath221 for a pure state @xmath222 if it is a product state , @xmath223 where @xmath224 denotes a state of the qubit at site @xmath21 ( @xmath225 ) .",
    "the vcm of such a state becomes a block - diagonal matrix @xmath226\\ ] ] where @xmath227 is a @xmath228 matrix whose @xmath229 element ( @xmath32 ) is given by @xmath230 therefore , @xmath146 is given by the maximum one among the maximum eigenvalues of @xmath227 s . by a unitary transformation of this @xmath228 matrix such",
    "that @xmath231 becomes an eigenstate of the transformed @xmath232 , we can transform @xmath227 into @xmath233\\ ] ] since the maximum eigenvalue of this matrix is @xmath199 , we find that @xmath221 .",
    "although this might sound strange to the reader who is not familiar with quantum theory of infinite systems , its physics may be understood as follows .",
    "consider a cat state @xmath5 of size @xmath1 as the simplest example .",
    "if @xmath1 is finite , there exist observables that have non - vanishing matrix elements between @xmath234 and @xmath235 .",
    "the expectation values of such observables discriminate between the pure state @xmath29 and the mixed state @xmath236 .",
    "if we take the @xmath3 limit , on the other hand , quantum theory of infinite systems require that every observables should be a function of field operators within a _ finite _ region in an infinite space . as a result , there are no observables that have non - vanishing matrix elements between the @xmath3 limits of @xmath234 and @xmath235 .",
    "this implies that @xmath237 is not a pure state .",
    "more mathematically speaking , @xmath237 is not a vector state of an irreducible representation . for details ,",
    "see ref .",
    "@xcite and references cited therein .",
    "a.  shimizu , talk presented at the 4th symposium on quantum effects and related physical phenomena ( december 20 - 21 , 2000 , tokyo , japan , unpublished ) ; a.  shimizu and t.  miyadera , in _ proceedings of the 56th annual meeting of the physical society of japan _",
    "( physical society of japan , 2001 ) , paper no . 28pyn-6 .",
    "although the macroscopic entanglement is defined for a family of similar states , it is customary to talk about the macroscopic entanglement of a state of a particular size @xcite .",
    "this is the same custom as the computational complexity : although it is defined for a family of various sizes of the input , it is customary to talk about the computational complexity for a particular size .",
    "for example , one often says that factoring a number of @xmath238 bits is hard .    in this paper",
    ", we use two symbols @xmath239 and @xmath240 to represent asymptotic behavior of a function @xmath241 as @xmath3 : @xmath242 if @xmath243 constant @xmath244 , whereas @xmath245 if @xmath246 is finite .",
    "equation ( 16 ) of ref .",
    "@xcite has a typo : actual calculations were performed by taking @xmath1 and @xmath173 as given by eqs .",
    "( [ l1l2 ] ) of the present paper .",
    "anyway , such small difference of @xmath50 does not matter to discuss @xmath0 ."
  ],
  "abstract_text": [
    "<S> we investigate macroscopic entanglement of quantum states in quantum computers , where we say a quantum state is entangled macroscopically if the state has superposition of macroscopically distinct states . the index @xmath0 of the macroscopic entanglement is calculated as a function of the step of the computation , for grover s quantum search algorithm and shor s factoring algorithm . </S>",
    "<S> it is found that whether macroscopically entangled states are used or not depends on the numbers and properties of the solutions to the problem to be solved . </S>",
    "<S> when the solutions are such that the problem becomes hard in the sense that classical algorithms take more than polynomial steps to find a solution , macroscopically entangled states are always used in grover s algorithm and almost always used in shor s algorithm . </S>",
    "<S> since they are representative algorithms for unstructured and structured problems , respectively , our results support strongly the conjecture that quantum computers utilize macroscopically entangled states when they solve hard problems much faster than any classical algorithms . </S>"
  ]
}