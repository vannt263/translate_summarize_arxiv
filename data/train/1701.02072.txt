{
  "article_text": [
    "since the introduction in 1937 and its popularization in 1975 @xcite , the photoplethysmography ( ppg ) has become an essential optical technique in the healthcare and its mechanism has been extensively studied @xcite .",
    "it is noninvasive , economic , comfortable , and easy - to - install . in recent years ,",
    "due to the advances of sensor technologies , different types of ppg signals are available via non - contact sensors @xcite .",
    "furthermore , the ppg has became a standard equipped sensor in diverse mobile devices for the healthcare , and an important component in the internet of things @xcite .",
    "in addition to its healthcare application , it is widely applied to diverse problems , like monitoring the hemodynamics under the hyper- or microgravity environment @xcite , music therapy @xcite , etc .",
    "the ppg contains a lot of physiological dynamic information , ranging from the peripheral oxygen saturation , information about the autonomic system , the cardiac and the respiratory dynamics , to the hypovolemic status @xcite . in the past decades",
    ", several indices have been proposed for clinical needs and extensively applied .",
    "examples include the heart rate and respiratory rate monitoring , pleth variability index for the fluid status assessment , surgical pleth index for the stress evaluation , sleep apnea detection , to name but a few .",
    "see @xcite for a review and more information . in recent years",
    ", the ppg was embraced by different scientific communities .",
    "a common research interest is learning physiological information from the ppg , particularly the fine physiological dynamic like the heart rate variability ( hrv ) and the respiratory rate variability ( rrv ) that traditionally were studied directly from the electrocardiogram or the breathing flow signal .",
    "this kind of information , when combined with the widely installed ppg sensors , has a great potential in different healthcare markets that opens a channel to the next generation medical care equipment .",
    "however , analyzing the hrv and rrv from the ppg is not as easy as deriving the above - mentioned indices , particularly when we have only one channel ppg sensor . the fundamental step toward this analysis is obtaining the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the ppg , which requires more sophisticated tools beyond standard signal processing tools .",
    "the main difficulty comes from the time - varying heart rate and respiratory rate , and the non - sinusoidal ppg oscillation .",
    "the time - varying heart and respiratory rates broaden the spectrum , and the non - sinusoidal oscillation inevitably mixup the spectral information for the cardiac activity and respiratory activity .",
    "the broadened and mixup spectrum prohibits us from applying the standard signal processing techniques .",
    "the problem is even more challenging since the signal is often contaminated by nonstationary uncertainties , like noise and motion artifacts , particularly in the daily environment . in the past few years",
    ", several methods have been proposed to solve this challenge , but to the best of our knowledge , methods with solid mathematical supports that are able to extract ihr and irr simultaneously from the single - lead ppg signal are limited , except some ad hoc approaches @xcite .",
    "thus , a new mathematical pipeline for this challenging signal processing problem is needed . also , a comparison of the method on multiple publicly available databases is also less reported . in this work ,",
    "we provide a systematic solution to this difficult task in a unified way .",
    "we propose a new signal processing technique based on a _ nonlinear masking technique _ to accurately learn the ihr and irr simultaneously from the ppg , compare our results with existing methods , and report the state - of - the - art results on two publicly available databases , capnobase benchmark database ( http://www.capnobase.org ) and icassp 2015 signal processing cup ( http://www.zhilinzhang.com/spcup2015/ ) .",
    "the proposed algorithm is composed of two steps .",
    "first , a novel nonlinear mask is designed from the short time fourier transform ( stft ) of the recorded ppg , which is applied to enhance the ihr and irr information @xcite .",
    "the ihr and irr information is further sharpened by taking the phase information of the stft of the recorded ppg into account @xcite .",
    "we call the resulting information the _ de - shaped spectrogram_. second , we extract the ihr and irr from the de - shaped spectrogram .",
    "we call the proposed algorithm @xmath0 .",
    "the @xmath0 algorithm is illustrated in figure [ flowchart ] .",
    "the nonlinear mask is novel in the sense that it is determined directly from the recorded ppg , so the information in the ppg can be accurately preserved to the maximum .",
    "the detailed description of the @xmath0 algorithm is given in section [ section : methods ] .",
    "the mathematical foundation of the nonlinear mask used in @xmath0 have been reported in @xcite , and we have summarized the theoretical material in section [ section : reviewcepstrum ] in the online supplementary information ( si ) for the interested reader .",
    "= [ draw , -latex ] = [ thick,->,>=stealth ]    ( start ) input ppg @xmath1 + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ; ( stftamp ) spectrogram + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ; ( istct ) nonlinear mask + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ; ( stftphase ) phase function + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ;    ( dssst ) de - shaped spectrogram + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ; ( ce ) curve extraction + the flow chart of the proposed algorithm , @xmath0 , to extract the instantaneous heart rate ( ihr ) and instantaneous respiratory rate ( irr ) from the recorded ppg signal .",
    "a typical recorded ppg signal lasting for 20 seconds is shown on the left .",
    "the short time fourier transform ( stft ) , and hence the spectrogram , of the input ppg signal are then evaluated .",
    "the intensity of the spectrogram at a point @xmath2 in the time - frequency plane indicates how strong the signal oscillates at time @xmath3 and frequency @xmath4 .",
    "the dark curve around 1.6hz represents the ihr , while the gray curve around 3.2hz ( and 4.8hz , 6.4hz , etc .",
    "the frequency axis above 4hz is not shown ) comes from the non - sinusoidal oscillation of the cardiac activity .",
    "similarly , the dark curve around 0.3hz represents the irr , while the gray curve around 0.6hz comes from the non - sinusoidal oscillation of the respiratory activity . with the stft and the spectrogram of the ppg signal , the nonlinear mask",
    "is then designed from the spectrogram and the phase function is determined from the stft .",
    "the intensity of the phase function at a point @xmath2 in the time - frequency plane indicates the angle of the complex value of the stft at time @xmath3 and frequency @xmath4 , which ranges from @xmath5 to @xmath6 . by applying the nonlinear mask and the phase function of the stft to the spectrogram",
    ", the spectrogram is improved and we obtain the de - shaped spectrogram . the darker curve around 1.6 hz represents the ihr and the lighter curve around 0.3 hz represents the irr .",
    "the curves corresponding to the ihr and irr are extracted from the de - shaped spectrogram , which are shown as the red and blue curves respectively superimposed on the de - shaped spectrogram.,title=\"fig : \" ] ; ( output ) output ihr and irr ;    ( start.east ) (stftamp.west ) ; ( start.east ) to [ out=290,in=170 ] ( stftphase.west ) ; ( start.east ) to [ out=70,in=190 ] ( istct.west ) ; ( istct.south ) (dssst.175 ) ; ( stftamp.east ) (dssst.west ) ; ( stftphase.north ) (dssst.185 ) ; ( dssst.east ) (ce.west ) ; ( ce.south ) (output.north ) ;",
    "it is well known that `` how fast the heart beats '' and `` how fast one breathes '' provide important physiological information , and we commonly use the terminologies , heart rate ( hr ) and respiratory rate ( rr ) , to refer to that information . however , in general , the hr and rr are not scientifically well defined if the the measurement scale is not specified .",
    "when the measurement scale is infinitesimal , the hr and rr become ihr and irr needed for the physiological variability analysis . on the other hand , the commonly encountered quantities regarding `` how frequent the heart beats and how frequent one breathes '' are the averaged hr ( ahr ) and averaged rr ( arr ) which are derived by counting how many beats or breaths take place over a provided window .",
    "in other words , if we view the ihr and irr as continuous time series , the ahr and arr could be viewed as the low - pass filtered ihr and irr that comes from the window smoothing technique . to specifically evaluate the performance of the @xmath0 algorithm",
    ", we have to specify the measurement scale .    in this section ,",
    "we report the analysis result of the @xmath0 algorithm .",
    "the numerical implementation details of the @xmath0 algorithm are available in section [ section : numericaldetails ] in the online si .",
    "the capnobase benchmark database ( http://www.capnobase.org ) consists of recordings of spontaneous or controlled breathing in static patients . the icassp 2015 signal processing cup ( http://www.zhilinzhang.com/spcup2015/ ) , instead , contains recordings from pulse oximeter positioned on the wrist of running subjects . in addition to reporting the ihr and irr estimation results",
    ", we also provide an up - to - date summary of existing reported results for a fair comparison .",
    "the capnobase benchmark database includes forty - two 8-minutes segments from 29 pediatric and 13 adults cases containing reliable recordings of spontaneous or controlled breathing . for each subject ,",
    "the ecg , capnometry , and ppg signals were recorded at 300 hz , 25 hz , and 100 hz respectively .",
    "all signals were recorded with s/5 collect software ( datex  ohmeda , finland ) .",
    "the ppg and capnometry were automatically up - sampled to be of 300 hz sampling rate .",
    "furthermore , the database contains a reference arr as well as the information regarding the beginning of each expiration , both derived from the capnogram waveform identified by experts .",
    "moreover , reference ahr as well as r - peak locations derived from the ecg waveform are also provided , which are also determined by the experts .",
    "the @xmath0 method provides estimates for the ihr and irr , which are instantaneous in nature .",
    "however , we point out here that , to the best of our knowledge , the methods proposed so far in the literature for the capnobase benchmark datasets provide ahr and arr information ; that is , they do not focus on computing _ instantaneous rates _ , but _ average rates _ over a time window , which is in most cases set to be around 60 seconds . thus , to have a fair comparison",
    ", we also provide the result based on the ahr and arr that are evaluated from smoothing the estimated irr and ihr over a 60 seconds window shifted of 30 seconds each time .",
    "we refer to this variation of the method as _ @xmath0 - 60s_.    denote @xmath7 , where @xmath8 is the number of observations , to be the reference information , that are either the ihr or irr ( respectively the ahr and arr ) which are either provided directly by the experts and included in the database , or evaluated from the r peaks and the beginning timestamps of expirations , and denote @xmath9 to be the estimated ihr or irr determined by @xmath0 ( respectively the estimated ahr or arr determined by @xmath0 - 60s ) .",
    "following what has been done in the literature , we assess the performance of the proposed algorithm using the unnormalized root mean square error ( rms ) and the mean absolute error ( mae ) , which are defined as @xmath10    in addition to simultaneously estimate the ihr and irr , one challenge we face in studying ppg signals is the possible presence of artifacts .",
    "the capnobase benchmark database include in each dataset information regarding potential intervals in the ppg , ecg and capnometry waveforms that contain artifacts .",
    "the methods reported in the literature use this information to skip the measurement errors over windows that are considered unreliable , if not even entire datasets ; see , for example , @xcite . instead , to mimic the real scenario ,",
    "when we evaluate the proposed @xmath0 method , we do not exclude any of the 42 datasets and we do include all their intervals , even those supposed to contain artifacts . for such intervals the provided ground truth",
    "is simply given as interpolation of the nearby reliable values ; see the right panel in figure [ fig : capno_artifacts2 ] .",
    "this of course introduce a bias in the error values we compute .",
    "particularly , the performance of the proposed method can be consistently improved if we remove intervals containing artifacts .",
    "we discuss more in details this aspect in section [ supp : capnobase ] in the online si .",
    "the rms and mae of the @xmath0 and @xmath0 - 60s are then evaluated and reported . in tables [",
    "tab : capno_stats ] , we provide the summary statistics of the rms and mae for the respiratory and heart rate obtained from the proposed algorithm .",
    "the performance of other methods proposed so far in the literature , and their chosen windows for averaging , are also included for a comparison .",
    "it is clear that the @xmath0 provides a satisfactory ihr and irr estimation , while the ahr and arr provided by @xmath0 - 60s perform better than the other methods proposed in the literature .",
    ".summary of root mean square error ( rms ) and mean absolute error ( mae ) of the respiratory rate ( rr ) and heart rate ( hr ) estimation for the capnobase benchmark database .",
    "the unit for the rr is breaths per minute , and the unit for the hr is beats per minute . except @xmath0 ,",
    "the methods proposed so far in the literature do not focus on computing _ instantaneous rates _ , but _ average rates _ over a time window .",
    "n / a : not available .",
    "std : standard deviation .",
    "@xmath11 : first quartile .",
    "@xmath12 : third quartile . [ cols=\"^,^,^,^,^,^,^,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> despite the population of the noninvasive , economic , comfortable , and easy - to - install photoplethysmography ( ppg ) sensor , a mathematically rigorous and stable algorithm to simultaneously extract the fundamental physiological information , including the instantaneous heart rate ( ihr ) and the instantaneous respiratory rate ( irr ) , from the single - channel ppg signal is lacking . a novel signal processing technique , called the de - shape synchrosqueezing transform , </S>",
    "<S> is provided to tackle this challenging task . </S>",
    "<S> the algorithm is applied to two publicly available batch databases , one is collected during intense physical activities , for the reproducibility purpose and the state - of - the - art results are obtained compared with existing reported outcomes . </S>",
    "<S> the results suggest the potential of the proposed algorithm to analyze the signal acquired from the widely available wearable devices , even when a subject exercises .    </S>",
    "<S> * keyword : * de - shape synchrosqueezing transform , photoplethysmography , instantaneous heart rate , instantaneous respiratory rate </S>"
  ]
}