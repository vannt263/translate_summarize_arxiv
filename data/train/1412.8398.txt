{
  "article_text": [
    "fourier - based algorithms , or `` fft '' methods for short , are an efficient approach for computing the mechanical response of composites . initially restricted to linear - elastic media ,",
    "fft tools are nowadays employed to treat more involved problems , ranging from viscoplasticity  @xcite to crack propagation  @xcite . in fft methods ,",
    "the microstructure is defined by 2d or 3d images and the local stress and strain tensors are computed along each pixel or `` voxel '' in the image . coupled with automatic or semi - automatic image segmentation techniques  @xcite , this allows for the computation of the mechanical response of a material directly from experimental acquisitions , like focused ion beam or 3d microtomography techniques  @xcite .",
    "the latter often deliver images containing billions of voxels , for which fft methods are efficient  @xcite .",
    "this allows one to take into account representative volume elements of materials which are multiscale by nature such as concrete or mortar  @xcite . from a practical viewpoint ,",
    "the simplicity of fft methods is attractive to researchers and engineers who need not be experts in the underlying numerical methods to use them .",
    "nowadays , fft tools are available not only as academic or free softwares  @xcite but also as commercial ones  @xcite .    in the past years",
    ", progress has been made in the understanding of fft algorithms .",
    "vondejc and co - workers have recently shown that the original method of moulinec and suquet  @xcite corresponds , under one technical assumption , to a particular choice of approximation space and optimization method  @xcite ( see also  @xcite ) .",
    "this property allows one to derive other fft schemes that use standard optimization algorithms , such as the conjugate gradient method . in this regard , making use of variational formulations , efficient numerical methods have been proposed that combine ffts with an underlying gradient descent algorithm  @xcite .",
    "different approximation spaces or discretization methods have also been proposed , where , contrary to the original scheme , the fields are not trigonometric polynomials anymore .",
    "brisard and dormieux introduced `` energy - based '' fft schemes that rely on galerkin approximations of hashin and shtrikman s variational principle  @xcite and derived modified green operators consistent with the new formulation .",
    "they obtained improved convergence properties and local fields devoid of the spurious oscillations observed in the original fft scheme  @xcite . in the context of conductivity , accurate local fields and improved convergence rates",
    "have also been obtained from modified green operators based on finite - differences  @xcite .",
    "these results follow earlier works where continuum mechanics are expressed by centered  @xcite or `` forward and backward '' finite differences  @xcite .",
    "this work focuses on the effect of discretization in fft methods .",
    "it is organized as follows .",
    "we first recall the equations of elasticity in the continuum ( sec .",
    "[ sec : problem ] ) .",
    "we give the lippmann - schwinger equations and the `` direct '' and `` accelerated '' fft schemes in sec .",
    "( [ sec : greencont ] ) . in sec .",
    "( [ sec : disc ] ) , a general formulation of the green operator is derived that incorporates methods in  @xcite , and a new discretization scheme is proposed .",
    "the accuracy of the local stress and strain fields are examined in sec .",
    "( [ sec : accuracy ] ) whereas the convergence rates of the various fft methods are investigated in sec .",
    "( [ sec : rate ] ) . we conclude in sec .",
    "( [ sec : conclusion ] ) .",
    "we are concerned with solving the equations of linear elasticity in a square or cubic domain @xmath0^d$ ] in dimension @xmath1 ( @xmath2 or @xmath3 ) : @xmath4 , \\quad\\ ] ] where @xmath5 is the strain field , @xmath6 the stress field , @xmath7 the displacement vector field , @xmath8 the local elasticity tensor and @xmath9 is a point in @xmath10 .",
    "tensorial components refer to a system of cartesian coordinates @xmath11 in 2d and @xmath12 in 3d .",
    "the material has an isotropic local elastic response that reads : @xmath13 where @xmath14 is the kronecker symbol and @xmath15 and @xmath16 are constant - per - phase lam s first and second coefficients .",
    "the local bulk modulus @xmath17 and the elastic moduli take on values : @xmath18 in phase @xmath19 . for simplicity ,",
    "we restrict ourselves to binary media and , by convention , @xmath20 is the matrix and @xmath21 the inclusions .",
    "hereafter , we fix poisson s ratios in each phase to @xmath22 so that , in 3d and 2d  @xcite , we have @xmath23 .",
    "the contrast of properties @xmath24 reads : @xmath25 where @xmath26 . in the matrix",
    ", we also fix @xmath27 ( @xmath2 or @xmath3 ) , @xmath28 ( @xmath2 or @xmath3 ) , @xmath29 ( @xmath2 ) , @xmath30 ( @xmath31 ) , so that the local properties of the material are parametrized by one unique variable , the contrast of properties @xmath24 . in 3d",
    ", the young modulus is @xmath32 in the matrix and @xmath33 in the inclusion .",
    "the medium is porous when @xmath34 and rigidly - reinforced when @xmath35 .",
    "periodic boundary conditions are applied with the material subjected to an overall strain loading @xmath36 : @xmath37 where @xmath38 is the normal at the boundary @xmath39 of the domain @xmath10 , oriented outward , @xmath40 denotes anti - periodicity and @xmath41 denotes the spatial mean over @xmath10 .",
    "the resulting effective elastic tensor @xmath42 is computed from : @xmath43",
    "fourier methods are by principle based on the lippmann - schwinger equations .",
    "the latter follow from  ( [ eq : a1 ] ) and  ( [ eq : a2 ] ) as  @xcite : @xmath44 where we have introduced a homogeneous `` reference '' elasticity tensor @xmath45 and its associated polarization field @xmath46 and green operator @xmath47 . in the above we assume @xmath48 so that @xmath49 holds .",
    "the green operator has , in the fourier domain , the closed form  @xcite : @xmath50^{-1 } q_l   \\right\\rbrace_\\textnormal{sym},\\ ] ] where @xmath51 are the fourier wave vectors and the subscript @xmath52 indicates minor symmetrization with respect to the variables @xmath53 and @xmath54 .",
    "hereafter , we assume that @xmath45 is a symmetric , positive - definite , isotropic tensor defined by its bulk ( @xmath55 ) and shear ( @xmath56 ) moduli , or lam coefficient ( @xmath57 ) . accordingly , when @xmath51 , the green operator @xmath47 is also symmetric definite and we have : @xmath58.\\ ] ]    the `` direct scheme ''  @xcite consists in applying eqs .",
    "( [ eq : ls ] ) iteratively as : @xmath59 in moulinec and suquet s method , the convolution product ( @xmath60 ) above is computed as an algebraic product in the fourier domain , making use of  ( [ eq : green0b ] ) .",
    "discrete fourier transforms are used to switch between the space @xmath10 and fourier domain @xmath61 .",
    "this amounts to representing the strain field as a trigonometric polynomial  @xcite of the form : @xmath62 where @xmath63 is the discrete fourier transform of @xmath5 . accordingly : @xmath64 similar forms are used for the stress and displacement fields . in practice , the domain @xmath10 is discretized on a square or cubic grid of @xmath65 voxels and the operator @xmath66 in  ( [ eq : green0 ] ) is evaluated along equispaced fourier modes : @xmath67 as noted in  @xcite , when @xmath68 is even , the relation : @xmath69 where @xmath70 is the complex conjugate of @xmath66 , is not verified when one of the components of @xmath71 is equal to the highest frequency @xmath72 ( i.e. @xmath73 ) . as a consequence , the backward fourier transform of @xmath74 used to compute the strain field has non - zero imaginary part even if @xmath75 is purely real . to fix this problem , we follow  @xcite and set : @xmath76 this choice enforces @xmath77 at the concerned fourier modes . in doing so",
    ", the strain field @xmath78 in  ( [ eq : ft ] ) is not strictly - speaking irrotational , because of the lack of constraint at high fourier modes for the strain field .",
    "we briefly mention another option that we explored in this work .",
    "it consists in forcing the symmetry by replacing @xmath66 with : @xmath79 when one of the components of @xmath71 equals @xmath80 , which enforces @xmath81 at the highest modes .",
    "numerical experiments indicate that the choice for @xmath66 at the highest frequencies has little influence on the convergence rate , except at small resolution . when @xmath82 pixels , faster convergence was achieved with the choice @xmath83 .",
    "furthermore , in the 2d example studied in this work , the choice @xmath83 led to smaller oscillations , consistently with observations in  @xcite .",
    "the use of  ( [ eq : forcing ] ) was therefore not pursued further .",
    "we emphasize that , when @xmath68 is odd , this discrepancy disappears and no special treatment is needed .",
    "refined fft algorithms have been introduced to overcome the slow convergence rate of the direct scheme , observed for highly - contrasted composites , most notably the `` accelerated scheme ''  @xcite and `` augmented lagrangian ''  @xcite methods . in this work ,",
    "we use the extension of the accelerated scheme to elasticity  @xcite : @xmath84.\\ ] ] the convergence rates of the accelerated and direct schemes depend on the choice of the reference tensor @xmath45 . for the accelerated scheme the optimal choice is  @xcite : @xmath85 for the direct scheme , upper bounds on the eigenvalues of the green operator",
    "suggest the choice  @xcite : @xmath86 with @xmath87 .",
    "in this section , we derive the expression of a modified green operator @xmath88 that replaces @xmath47 defined in  ( [ eq : green0b ] ) and  ( [ eq : contmodes ] ) . we give it in a form that includes previously - proposed modified operators  @xcite and",
    "also introduce a new one .      in the following ,",
    "we assume that the strain and stress fields are defined on a grid of points in 2d , one per pixel .",
    "( [ eq : ft ] ) and  ( [ eq : ft2 ] ) are used to apply discrete fourier transforms , but we do not postulate a representation in the continuum anymore .",
    "the equilibrium and strain admissibility conditions  ( [ eq : a1 ] ) are approximated by means of finite differences on which we apply the discrete transforms  ( [ eq : ft ] ) and  ( [ eq : ft2 ] ) . in  @xcite , this results in the following form : @xmath89,\\ ] ] where @xmath90 and @xmath91 represent `` discrete '' gradient and divergence operators , respectively . in the centered scheme",
    ", one takes @xmath90 equal to : @xmath92 whereas in scheme  @xcite , one chooses , for @xmath90 : @xmath93 these expressions correspond , respectively , to the centered scheme : @xmath94 and to the forward - and - backward difference scheme : @xmath95 using  ( [ eq : discfour ] ) , the resulting green operator reads : @xmath96^{-1 } k_l^*({\\bm{q } } )   \\right\\rbrace_\\textnormal{sym},\\ ] ] which is homogeneous in @xmath90 , so that , with @xmath97 : @xmath98   } , \\ ] ] where @xmath99 denotes the real part of the enclosed quantity . the denominator on the right - hand side is strictly positive due to the triangle inequality .",
    "hereafter , the operator @xmath88 is denoted by @xmath100 when @xmath101 and by @xmath102 when @xmath103 . note that the operator @xmath47 in  ( [ eq : green0b ] ) is recovered from  ( [ eq : green1 ] ) by setting @xmath104 .",
    "now the green operator @xmath88 is complex and follows the minor and major symmetries : @xmath105^*.\\ ] ] furthermore we have : @xmath106 for the schemes  ( [ eq : mul1 ] ) and  ( [ eq : wil071 ] ) , including when @xmath72 and when @xmath68 is even , because @xmath107 is real at the frequency @xmath72 .",
    "therefore , the fix  ( [ eq : hfreq ] ) in sec .",
    "( [ sec : greencont ] ) is not necessary .",
    "however , a problem of a different nature arises when using the centered scheme  ( [ eq : mul2 ] ) when @xmath68 is even .",
    "( [ eq : green1 ] ) does not define the green operator @xmath100 at the three frequencies @xmath108 , @xmath109 and @xmath110 , for which @xmath111 .",
    "this is because the second equation in  ( [ eq : mul1 ] ) has in general non - unique solutions for the displacement field @xmath7 .",
    "indeed , when @xmath68 is even , the displacement is defined up to a linear combination of @xmath112-voxels periodic fields .",
    "they are given by the following @xmath113 independent fields : @xmath114 the operator @xmath100 remains finite when @xmath71 approaches one of the modes @xmath115 , @xmath109 or @xmath110 , but can not be continuously extended at these modes . to fix this problem",
    ", we set , for the centered scheme : @xmath116 which enforces @xmath81 at the highest frequencies .",
    "the strain field @xmath5 is accordingly admissible , and the stress field @xmath6 is divergence - free , in the sense of  ( [ eq : mul1 ] ) .",
    "we explored the alternate choice @xmath117 in  ( [ eq : mulfix ] ) .",
    "almost identical convergence rates and oscillations were observed for the two options , however the choice @xmath117 does not produce an irrotational strain field and is not considered further .",
    "we emphasize that no special treatment is required for the operator @xmath102 at high frequencies since @xmath118 when @xmath51 .    by substituting @xmath47 with @xmath100 or @xmath102 in ( [ eq : ds ] ) and",
    "( [ eq : as ] ) , we derive `` direct '' and `` accelerated '' schemes that solve  ( [ eq : mul1 ] ) or  ( [ eq : wil071 ] ) . in the limit of very fine resolution , we have @xmath119 when @xmath120 , which guarantees that the strain and stress fields do not depend on the employed discretization .",
    "this property holds for any choice of @xmath90 such as @xmath121 when @xmath120 .    on the one hand ,",
    "derivatives are estimated more locally in the forward - and - backward scheme  ( [ eq : wil072 ] ) than in the centered scheme  ( [ eq : mul2 ] ) , which is important along interfaces .",
    "on the other hand , the forward - and - backward scheme does not treat symmetrically the two angle bisectors @xmath122 and @xmath123  @xcite . in a domain containing a single centered disc , the scheme produces fields that break the axial symmetries of the problem .",
    "in fact , the discretization  ( [ eq : wil071 ] ) is actually one of four possible choices , all of them breaking the symmetries .",
    "attempts to force the symmetry by averaging over the four green operators or over the fields themselves , as proposed in  @xcite , are not explored in this work .",
    "the fomer method indeed leads to less accurate `` diffuse '' local fields .",
    "the latter necessitates to run four different computations , in 2d , instead of one , which is cumbersome .    in the rest of this section , we derive a discrete scheme in 2d different from  ( [ eq : mul1 ] ) and  ( [ eq : wil071 ] ) . in this scheme ,",
    "the displacement field is evaluated at the @xmath124 corners of the pixels and the strain and stress fields are evaluated at the centers of the pixels .",
    "we first express these fields in the @xmath125-rotated basis : @xmath126 by : @xmath127 where uppercase indices refer to components in the rotated grid .",
    "we discretize  ( [ eq : a1 ] ) in the rotated basis by the centered differences ( see fig .",
    "[ fig:2drot ] ) :    [ eq : discfull ] @xmath128\\label{eq : discfulleps}&\\end{aligned}\\ ] ]    where @xmath9 lie at the centers of the pixels and @xmath129 lie at the corners . expressing back  ( [ eq : discfull ] ) in the original cartesian grid @xmath11 and applying the backward discrete fourier transform  ( [ eq : ft ] ) we arrive again at  ( [ eq : discfour ] ) with the following expression for @xmath90 : @xmath130 we denote by @xmath131 the corresponding green operator , derived by substituting @xmath132 in  ( [ eq : green1 ] ) .",
    "the operator @xmath131 is real and also verifies : @xmath133 however , when @xmath68 is even , @xmath134 when @xmath135 and @xmath131 is not defined by  ( [ eq : green1 ] ) at this frequency . again , this is because ( [ eq : discfulleps ] ) gives the displacement field up to linear combinations of the @xmath124 independent fields @xmath136 ( see  [ eq : muldisp ] ) .",
    "accordingly we set : @xmath137 which enforces strain compatibility and stress equilibrium , in the sense of  ( [ eq : discfull ] ) .     a pixel with edges parallel to the cartesian axis @xmath11 . superimposed : @xmath125-rotated basis ( @xmath138 .",
    "the strain and stress fields are evaluated at the pixel center @xmath9 ( square ) . the displacement and the divergence of the stress field lie along the pixel corners ( disks ) .",
    ", width=151 ]      we follow the same methodology in 3d .",
    "the equilibrium and strain admissibility conditions  ( [ eq : discfour ] ) are unchanged , as well as the expression for the vectors @xmath139 in  ( [ eq : mul2 ] ) and  ( [ eq : wil072 ] ) resulting from  ( [ eq : mul1 ] ) and  ( [ eq : wil071 ] ) . in 3d , we also extend  ( [ eq : wil14 ] ) as : @xmath140 for the rotated scheme . the strain and stress fields",
    "are now evaluated at the centers of the voxels and the displacement field at their corners .",
    "derivatives of the displacement are estimated by differences at opposite corners . for the strain components @xmath141 and @xmath142 :    [ eq : disc3deps ] @xmath143,\\\\ \\varepsilon_{12}({\\bm{x}})&\\approx &   \\frac{1}{8 }    \\sum_{\\substack{m=\\pm 1\\\\ n=\\pm 1}}\\left[u_2\\left({\\bm{x}}+\\frac{{\\mathbf{e}}_1+m{\\mathbf{e}}_2+n{\\mathbf{e}}_3}{2}\\right )                          -u_2\\left({\\bm{x}}-\\frac{{\\mathbf{e}}_1-m{\\mathbf{e}}_2-n{\\mathbf{e}}_3}{2}\\right ) \\nonumber\\right.\\\\    & & + \\left .",
    "u_1\\left({\\bm{x}}+\\frac{{\\mathbf{e}}_2+m{\\mathbf{e}}_1+n{\\mathbf{e}}_3}{2}\\right )                          -u_1\\left({\\bm{x}}-\\frac{{\\mathbf{e}}_2-m{\\mathbf{e}}_1-n{\\mathbf{e}}_3}{2}\\right)\\right ] , \\label{eq : disc3d12}\\end{aligned}\\ ] ]    where @xmath9 lie at the center of a voxel .",
    "the expression for the strain component @xmath144 ( resp .",
    "@xmath145 ) is obtained after exchanging the indicia @xmath146 and @xmath112 ( resp . @xmath146 and @xmath3 ) in  ( [ eq : disc3d11 ] ) . the component @xmath147 ( resp .",
    "@xmath148 ) is derived from  ( [ eq : disc3d12 ] ) by exchanging the indicia @xmath3 and @xmath146 ( resp . @xmath3 and @xmath112 ) .",
    "stress divergence is discretized in a similar manner .",
    "its first component reads : @xmath149,\\end{aligned}\\ ] ] where @xmath9 lie at one of the _ edges _ of a voxel .",
    "the components @xmath150 and @xmath151 are obtained from  ( [ eq : disc3dsig ] ) by circular permutations of the indicia @xmath146 , @xmath112 and @xmath3 .",
    "we note that  ( [ eq : disc3deps ] ) and ( [ eq : disc3dsig ] ) are the natural generalization of  ( [ eq : discfull ] ) to @xmath31 , expressed in the cartesian basis @xmath12 .    in 3d , eq .",
    "( [ eq : discfour2 ] ) yields , for the green operator : @xmath152     - \\mu^0 r_ir_jr_k^*r_l^ *   } {      \\mu^0\\left[2(\\lambda^0+\\mu^0)-\\lambda^0\\left|r_1 ^ 2+r_2 ^ 2+r_3 ^ 2\\right|^2\\right ]    } \\ ] ] where again @xmath97 and @xmath153 is the symmetric second - order tensor : @xmath154 with @xmath155 the imaginary part of the enclosed complex quantity . like in 2d",
    ", the operator @xmath88 follows minor and major symmetries  ( [ eq : greensym ] ) .",
    "again , the operators @xmath100 , @xmath102 and @xmath131 are derived using the expression for @xmath88 in  ( [ eq : green3 ] ) with @xmath101 , @xmath156 and @xmath157 , respectively . the symmetries  ( [ eq : greensym2 ] ) and  ( [ eq : grsym ] ) are verified in 3d as well . but",
    "again , a special treatment is needed for @xmath100 and @xmath131 when @xmath68 is even , at the modes @xmath71 for which @xmath158 .",
    "like in 2d , the displacement is undefined at these frequencies and the fourier coefficients of the strain field are zero and so we set @xmath159 at these frequencies .",
    "more precisely , we apply ( [ eq : mulfix ] ) when @xmath31 and , for the rotated scheme : @xmath160    the operators @xmath100 , @xmath102 and @xmath131 are , in 2d and 3d , periodic functions where , contrary to @xmath47 , high frequencies are cut .",
    "accordingly , we expect faster convergence rates for schemes using operators derived from finite differences and more exact local fields , as was previously observed in the conductivity problem  @xcite .",
    "we also expect higher accuracy for the local fields when employing @xmath131 rather than the other discrete operators @xmath102 and @xmath100 .",
    "first , the operator @xmath131 is based on centered differences which are more precise than forward and backward differences , used in @xmath102 .",
    "second , derivatives are evaluated more locally when using @xmath131 rather than @xmath100 . indeed , the latter are computed at points separated by @xmath112 voxels for @xmath100 instead of @xmath161 ( in 2d ) or @xmath162 voxels ( in 3d ) for @xmath131 .",
    "the above considerations guided the choice for the discretization schemes  ( [ eq : disc3deps ] ) and  ( [ eq : disc3dsig ] ) , leading to @xmath157 and @xmath131 .",
    "clearly , many other choices are possible , and eq .  ( [ eq : green3 ] ) gives a general class of green operators based on finite - differences .",
    "the latter depend on the choice for the complex vector @xmath90 .",
    "however , a systematic investigation of such discrete schemes is beyond the present study .    in the the rest of this study",
    ", we estimate the accuracy of the local fields and of the effective properties predicted by the various schemes , as well as their convergence rates .",
    "we denote by ds and as the direct and accelerated schemes defined by  ( [ eq : ds ] ) and  ( [ eq : as ] ) respectively , when @xmath47 is used .",
    "we denote by @xmath163 , @xmath164 , @xmath165 and @xmath166 , @xmath167 and @xmath168 , the same algorithms obtained by substituting @xmath47 with @xmath169 respectively .",
    "we emphasize that , for a given green operator , the direct and accelerated schemes produce the same strain and stress fields , up to round - off errors .",
    "hereafter we consider the 2d ` four - cell ' microstructure , where the periodic domain @xmath10 is divided into @xmath124 identical squares of surface fraction @xmath170% .",
    "its non - trivial solution with singular fields at the corners makes it a good benchmark for numerical schemes .",
    "furthermore , the microstructure is discretized exactly at any resolution , provided @xmath68 is even . in the following , we make use of a simplified version of the four - cell microstructure made of a single quasi - rigid square inclusion embedded in a matrix ( fig .  [",
    "fig : micro2d ] ) .",
    "we set the contrast to @xmath171 .",
    "the material is subjected to the macroscopic strain loading : @xmath172 we determine the strain and stress fields predicted by fft schemes when using the green operators @xmath47 or @xmath169 .",
    "the fields are computed using the accelerated scheme  ( [ eq : as ] ) at discretizations @xmath173 , @xmath174 and @xmath175 .",
    "iterations are stopped when the strain and stress fields maximum variation over two iterations in any pixel is less than @xmath176 .",
    "these variations are the effect of round - off errors in double precision floating point numbers .",
    "these computations allow us to compare the effect of the discretization , independently of the algorithm used for convergence .",
    "we focus on the stress component @xmath177 parallel to the applied loading in a small region @xmath178 ^ 2 $ ] around the corner of the inclusion ( fig .",
    "[ fig : accuracy2d ] ) . at low resolution @xmath173 ,",
    "numerical methods predict values as large as @xmath179 in a few pixels , because of the singularity of the stress field at the corner . to highlight the field patterns , we threshold out the values above @xmath180 , which amount to @xmath181% of the pixels . using the same color scale for all images , the smallest stress value , equal to @xmath182 , is shown in dark blue whereas the highest , equal to @xmath180 , is in dark red .",
    "green , yellow and orange lie in - between .",
    "as expected , in the limit of very fine resolution , all methods tend to the same local stress field , as shown by the similar field maps obtained at resolution @xmath183 .",
    "however , use of the green operator @xmath47 leads to spurious oscillations along the interfaces of the inclusion , up to resolutions as big as @xmath184 pixels , a side - effect noticed in  @xcite in conductivity .",
    "the oscillations do not disappear after computing local averages of the fields ( not shown ) .",
    "strong oscillations are produced by schemes using  @xmath100 as well , not only in the quasi - rigid inclusion , but also in the matrix .",
    "we observe checkerboard patterns in the former , and vertical and horizontal alignments in the latter , at resolution @xmath185 .",
    "these oscillations are greatly reduced by the use of @xmath102 .",
    "still , due to the non - symmetric nature of @xmath102 , the stress is not correctly estimated along a line of width @xmath146 pixel oriented upward from the inclusion corner .",
    "similar patterns are observed , in other directions , along the three other corners of the inclusion ( not shown ) .",
    "these issues are solved when using @xmath131 which produces a stress field that respects the symmetries of the problem .",
    "furthermore , use of @xmath131 greatly reduces oscillations compared to @xmath47 and @xmath100 .",
    "elementary periodic domain @xmath186 ^ 2 $ ] containing a square inclusion with elastic moduli @xmath187 , @xmath188 ( top - left , shown in white ) embedded in a matrix ( shown in gray ) with elastic moduli @xmath189 , @xmath190 . ,",
    "width=151 ]    [ cols=\"<,^,^,^,^ \" , ]      contrary to the previous sections , we now consider a microstructure without singularities ( edges or corners ) and focus on the effect of the green operator discretization on the effective elastic properties . in the rest of this section ,",
    "the elementary domain @xmath10 contains one spherical inclusion of volume fraction @xmath191% , so that the material is a periodic array of spheres .",
    "the spheres are very soft with contrast of properties @xmath192 .",
    "we compute the effective elastic modulus @xmath193 produced by either @xmath47 or @xmath169 at increasing resolutions @xmath194 , @xmath195 , @xmath196 , @xmath197 and @xmath198 .",
    "again , we use the accelerated scheme and iterations are stopped when the stress field maximum variation over two iterations in any pixel is less than @xmath199 .",
    "results are shown in fig .",
    "( [ fig : eff ] ) and are compared with the analytical estimate in  @xcite .",
    "when the resolution increases , the effective elastic modulus @xmath193 increases up to a limit value that we estimate to about @xmath200 , for all schemes .",
    "as observed in other studies  @xcite , very large systems are needed to compute this estimate at a high precision .",
    "this is especially true of the green operator @xmath47 which has the slowest convergence with respect to the system size . at fixed resolution ,",
    "the error on the predictions given by @xmath47 is about @xmath112 times larger than the one provided by @xmath131 , which , among all methods , gives the best estimate .",
    "the operators @xmath100 and @xmath102 stand in - between .",
    "this is another indication of the benefits of the operator @xmath131 .",
    "apparent elastic modulus @xmath193 estimated by fft methods using the green operators @xmath47 and @xmath169 ( black and red ) , at increasing resolution @xmath68 .",
    "orange : estimate in  @xcite ; violet : estimate of the asymptotic effective modulus @xmath193 using fft data .",
    ", width=340 ]",
    "in this section , we estimate the rates of convergence of the direct and accelerated schemes ds , ds@xmath201 , as and as@xmath201 , that use the various green operators .",
    "all schemes enforce stress equilibrium at convergence only , therefore we follow  @xcite and consider a criterion based on the @xmath202-norm : @xmath203 where @xmath204 is the precision and the normalizing factor @xmath205 is the frobenius norm : @xmath206 in  ( [ eq : criterion ] ) we set @xmath207 for the schemes using @xmath169 and @xmath208 when using the green operator @xmath47 , so that @xmath209 is the divergence of the stress field in the fourier domain , estimated according to the various discretization schemes .",
    "we now estimate the convergence rates on a random microstructure . in the following ,",
    "the domain @xmath10 is a ( periodized ) boolean model of spheres of resolution @xmath210 and volume fraction @xmath211% , below the percolation threshold of the spheres  of about @xmath212%  @xcite . to obtain meaningful comparisons",
    ", we use the same randomly - generated microstructure for all schemes .",
    "this particular configuration contains @xmath213 spheres of diameter @xmath214 voxels , about @xmath215 times smaller than the size of @xmath10 .",
    "taking @xmath216 for the reference poisson ratio , we compute numerically the number of iterations @xmath217 required to reach the precision @xmath218 , for varying reference young moduli @xmath219 , in the range @xmath220 .",
    "we consider the boolean model of spheres with contrast @xmath221 and the various accelerated schemes as and as@xmath201 ( fig .",
    "[ fig : convref0 ] ) . within the range @xmath222",
    ", the number of iterations @xmath217 is about the same for all accelerated schemes .",
    "when @xmath223 , however , @xmath217 is a strongly increasing function of @xmath219 for scheme as , contrary to the other schemes as@xmath201 . for the latter",
    ", @xmath224 decreases with @xmath219 up to a local minimum , beyond which variations are much less sensitive to @xmath219 .",
    "one unique local minimum around @xmath225 is found for scheme as@xmath226 , whereas the schemes as@xmath227 and as@xmath228 exhibit two local minima .",
    "the effect of the poisson ratio is also investigated numerically .",
    "we let @xmath229 and @xmath230 for various values of @xmath219 with @xmath221 and observe a strong increase of the number of iterations @xmath217 , for the schemes as and as@xmath201 .",
    "the same behavior is observed for the direct scheme ds and ds@xmath201 with @xmath231 .",
    "therefore , in the following , we fix the poisson ratio to @xmath232 for the reference tensor , for all schemes and all contrast of properties @xmath24 .",
    "this leaves one parameter , @xmath219 , to optimize on .",
    "we use the gradient descent method to determine a local minimum of @xmath217 for arbitrary contrast and scheme ds , ds@xmath201 , as and as@xmath201 . as above",
    ", @xmath217 is the number of iterations necessary to reach @xmath218 .",
    "we choose @xmath233 for schemes ds , ds@xmath201 and @xmath234 for schemes as and as@xmath201 as initial guess for @xmath219 , suggested by  ( [ eq : ref ] ) and  ( [ eq : refacc ] ) . at each step , we determine if @xmath219 is to be increased or decreased , by comparing @xmath217 with @xmath235 where @xmath236 .",
    "it frequently happens that @xmath237 . in that case",
    ", we compare the values of the precision @xmath238 after @xmath217 iterations and follow the direction that minimizes @xmath238 .",
    "iterations are stopped whenever @xmath217 is unchanged after two descent steps .",
    "the gradient descent method determines a local minimum rather than the global minimum , which is sub - optimal . to check the validity of the results ,",
    "further numerical investigations are carried out for @xmath231 , @xmath239 and schemes ds and ds@xmath201 .",
    "the method predicts the global minimum in these cases .",
    "this also holds for schemes as and as@xmath240 with @xmath221 , @xmath241 , but not for scheme @xmath166 with @xmath221 .",
    "however , in this case the number of iterations @xmath217 are very similar at the two local minima , as shown in fig .",
    "( [ fig : convref0 ] ) . in the following ,",
    "the results given by the gradient descent method are used as - is .",
    "number of iterations @xmath217 required to achieve convergence , as a function of the reference young modulus @xmath219 , for the accelerated schemes as and as@xmath201 using various green operators .",
    "convergence is achieved when the precision @xmath242 is reached .",
    "the microsctructure is a boolean model of quasi - porous spheres with @xmath221 .",
    ", width=340 ]    results for the optimal reference @xmath219 are indicated in fig .",
    "( [ fig : convref ] ) . for the direct scheme",
    ", the optimal reference follows  ( [ eq : ref ] ) with @xmath243 , independently of the green operator used .",
    "values of @xmath244 smaller than @xmath245 lead to non - converging schemes . for the accelerated schemes , the situation is less simple , and differs depending on the green operator in use . for the scheme as with green operator  @xmath47 ,",
    "the choice  ( [ eq : refacc ] ) is optimal except in the region @xmath246 where the value of @xmath219 tend to a small constant of about @xmath247 .",
    "similar behavior is found for the schemes as@xmath248 for which : @xmath249 with @xmath250 for @xmath166 and @xmath251 for @xmath168 .",
    "similar behavior has been observed numerically in  @xcite , in the context of conductivity . for the scheme @xmath167 that uses @xmath102 , the optimal choice for @xmath219 follows the same pattern as above with @xmath252 except in the region",
    "this behavior is an effect of the presence of two local minima , similar to that shown in fig .",
    "( [ fig : convref0 ] ) for @xmath221 .",
    "convergence rates , computed with optimized reference , are represented in fig .",
    "( [ fig : convrate ] ) as a function of the contrast , in log - log scale .",
    "results for @xmath34 ( strictly porous media ) have been included in the same graph ( left point ) . as is well - established  @xcite , the number of iterations in the direct scheme ds scales as @xmath24 when @xmath254 and @xmath255 when @xmath256 .",
    "for the accelerated scheme as , the number of iterations is smaller and follows @xmath257 when @xmath254 and @xmath258 when @xmath256 , with one exception . at very high contrast of properties @xmath259 , including at @xmath34",
    ", convergence is reached after a finite number of iterations , about @xmath260 .",
    "this particular behavior is presumably sensitive to the value choosen for the requested precision @xmath242 .",
    "when @xmath261 , the schemes ds@xmath201 and as@xmath201 , that use @xmath169 , converge after a number of iterations not exceeding @xmath262 .",
    "as shown in fig .",
    "( [ fig : convrate ] ) , the number of iterations is nearly constant in the range @xmath263 .",
    "as expected , the accelerated schemes as@xmath201 are faster than the direct schemes ds@xmath201 , with scheme as@xmath226 proving the fastest . with this scheme and",
    "when @xmath261 , the number of iterations is at most @xmath264 .",
    "again , these results are qualitatively similar with that given in  @xcite in the context of conductivity",
    ".    for rigidly - reinforced media ( @xmath265 ) , the number of iterations of schemes ds@xmath201 and as@xmath201 follow the same powerlaw behaviors , with respect to @xmath24 , as that of ds or as . in all considered schemes",
    ", the number of iterations continuously increases with the contrast .",
    "differences are observed between the various accelerated schemes as and as@xmath201 , with as@xmath226 the fastest . the use of green operators associated to the problem for the strain field , as undertaken here , results in convergence properties that are worse in the region @xmath265 than when @xmath261 . in this respect , benefits are to be expected from the use of dual green operators  @xcite , associated to the problem for the stress fields",
    ".     optimal reference young modulus @xmath219 as a function of the contrast of properties @xmath24 , for the various fft methods , in log - log scale .",
    "direct schemes : black and red ( nearly superimposed to one another ) ; accelerated schemes : blue and green . results for a porous material ( @xmath34 ) are indicated at the left of the graph . the material is a boolean model of spheres with volume fraction @xmath211% . , width=340 ]     number of iterations as a function of the contrast of properties @xmath24 , for the various fft methods , in log - log scale .",
    "direct schemes : black and red ; accelerated schemes : blue and green .",
    "results for a porous material ( @xmath34 ) are indicated at the left of the graph .",
    "the material is a boolean model of spheres with volume fraction @xmath211% .",
    ", width=340 ]      in this section , we focus on the accelerated schemes as and as@xmath201 and examine the rate of convergence of the various schemes with respect to the effective elastic moduli .",
    "we consider the same boolean microstructure as given in sec .",
    "( [ sec : rate ] ) but discretized on higher resolution grids of @xmath266 and @xmath267 voxels .",
    "the volume fraction of the spheres are respectively @xmath268% and @xmath269% . for simplicity , the contrast of properties take on two values @xmath192 and @xmath270 , so that the spheres are quasi - porous or quasi - rigid .",
    "we perform iterations of the schemes as and as@xmath201 using the optimized reference moduli found in the previous section , on the lower resolution grid .",
    "we apply the macroscopic strain loading : @xmath271 at each iteration and for each scheme , we compute the elastic modulus @xmath193 , derived from the mean @xmath272 of the stress component @xmath273 .",
    "the convergence rate toward the elastic modulus is represented in fig .",
    "( [ fig : itporous ] ) for quasi - porous spheres with @xmath173 and in fig .",
    "( [ fig : itrigid ] ) for quasi - rigid spheres with @xmath274 . in fig .",
    "( [ fig : itporous ] ) , for the sake of clarity , the elastic moduli are represented by symbols once every @xmath214 iterations , except for the first five iterations of the scheme as@xmath226 which are all represented .",
    "dotted lines are guide to the eyes . in the porous case , much better convergence is obtained with scheme as@xmath226 than with schemes as and as@xmath275 , as shown in fig .",
    "( [ fig : itporous ] ) .",
    "the estimate for @xmath193 predicted by as and as@xmath275 present strong oscillations that are much reduced with as@xmath226 .",
    "after about @xmath276 iterations , the estimate given by as@xmath226 is valid to a relative precision of @xmath277 . to achieve the same precision , more than @xmath278 iterations",
    "are needed for schemes as and as@xmath275 .",
    "the situation is notably different for quasi - rigid spheres ( fig .  [",
    "fig : itrigid ] ) . for all schemes ,",
    "a much higher number of iterations is required to determine the elastic modulus @xmath193 with a precision of @xmath277 .",
    "the slower convergence rate follows that observed in sec .",
    "( [ sec : rate ] ) , where convergence is much poorer for @xmath265 than for @xmath261 , and where as@xmath226 is less advantageous compared to the other schemes . nevertheless , in this case also , as shown in fig .",
    "( [ fig : itrigid ] ) , smaller oscillations are observed in the estimate for @xmath193 when using as@xmath226 rather than schemes as or as@xmath275 .",
    "estimate of the elastic modulus @xmath193 as a function of the number iterations performed , for a 3d boolean model of quasi - porous spheres .",
    "black symbols : accelerated schemes as , as@xmath228 , as@xmath227 ; red : scheme as@xmath226 ( orange : hashin and shtrikman upper bound ) . , width=340 ]     estimate of the elastic modulus @xmath193 as a function of the number iterations performed , for a 3d boolean model of quasi - rigid spheres .",
    "black lines : accelerated schemes as , as@xmath228 , as@xmath227 ; red : scheme as@xmath226 .",
    ", width=340 ]",
    "in this work , a novel discretization method has been proposed in 2d and 3d for use in fourier - based schemes .",
    "the core of the proposed scheme is a simple modification of the green operator in the fourier domain .",
    "the results obtained confirm those achieved in the context of conductivity  @xcite . compared to schemes using trigonometric polynomials as approximation space , or to other finite - differences methods , superior convergence rates",
    "have been observed in terms of local stress equilibrium , but also in terms of effective properties .",
    "more importantly , the solution for the local fields , predicted by the new discretization scheme is found to be more accurate than that of other methods , especially at the vicinity of interfaces .",
    "this property is important when applying fft methods to solve more complex problems like large strain deformation  @xcite .",
    "the new method also provides better estimates for the effective elastic moduli .",
    "furthermore , its estimates does not depend on the reference medium , because the scheme is based on a finite - differences discretization of continuum mechanics .",
    "although not explored in this work , the modified green operator can be used with most other fft iterative solvers , like the `` augmented lagrangian ''  @xcite or with fft algorithms that are less sensitive to the reference  @xcite , leading to the same local fields .",
    "dunant , b.  bary , a. b. giorla , c.  pniguel , j.  sanahuja , c.  toulemonde , a. b. tran , f.  willot , and j.  yvonnet . a critical comparison of several numerical methods for computing effective properties of highly heterogeneous materials .",
    ", 58:112 , 2013 .",
    "j.  escoda , f.  willot , d.  jeulin , j.  sanahuja , and c.  toulemonde .",
    "estimation of local stresses and elastic properties of a mortar sample by fft computation of fields on a 3d image .",
    ", 41(5):542556 , 2011 .",
    "s.  brisard and l.  dormieux .",
    "combining galerkin approximation techniques with the principle of hashin and shtrikman to derive a new fft - based numerical method for the homogenization of composites .",
    ", 217(220):197212 , 2012 .",
    "f.  willot , b.  abdallah , and y .- p .",
    "fourier - based schemes with modified green operator for computing the electrical response of heterogeneous media with accurate local fields . , 98(7):518533 , 2014 .",
    "f.  willot and y .- p .",
    "fast fourier transform computations and build - up of plastic deformation in 2d , elastic - perfectly plastic , pixelwise - disordered porous media . in _ d. jeulin , s. forest ( eds ) , `` continuum models and discrete systems cmds 11 '' _ , pages 443449 , paris , 2008 .",
    "cole des mines .",
    "n.  lahellec , j .- c .",
    "michel , h.  moulinec , and p.  suquet .",
    "analysis of inhomogeneous materials at large strains using fast fourier transforms . in _ proc .",
    "iutam symposium on computational mechanics of solid materials at large strains _ , pages 247258 .",
    "kluwer academic publishers , 2001 ."
  ],
  "abstract_text": [
    "<S> we modify the green operator involved in fourier - based computational schemes in elasticity , in 2d and 3d . the new operator is derived by expressing continuum mechanics in terms of centered differences on a rotated grid . </S>",
    "<S> use of the modified green operator leads , in all systems investigated , to more accurate strain and stress fields than using the discretizations proposed by moulinec and suquet  ( 1994 ) or willot and pellegrini  ( 2008 ) . </S>",
    "<S> moreover , we compared the convergence rates of the `` direct '' and `` accelerated '' fft schemes with the different discretizations . </S>",
    "<S> the discretization method proposed in this work allows for much faster fft schemes with respect to two criteria : stress equilibrium and effective elastic moduli .    </S>",
    "<S> fft methods , homogenization , heterogeneous media , linear elasticity , computational mechanics , spectral methods </S>"
  ]
}