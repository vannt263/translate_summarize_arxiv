{
  "article_text": [
    "the monte carlo method has become one of the most popular methods to perform radiative transfer simulations .",
    "one of the greatest advantages of the monte carlo method is its conceptual simplicity . instead of solving the radiative transfer equations that describe the radiation field",
    ", monte carlo simulations actually follow the photon packages that make up the radiation field in a very natural way .",
    "this ensures that , compared to other approaches to multi - dimensional radiative transfer problems , the practical implementation of monte carlo radiative transfer is surprisingly straightforward .",
    "this simple , straightforward approach also enables the inclusion of additional ingredients , such as the polarization of scattered light @xcite , the kinematics of the sinks and sources @xcite and gas ionization and recombination processes @xcite . on the other hand ,",
    "probably the most important disadvantage of the monte carlo method is the appearance of poisson noise , which is inherently tied to the probabilistic nature of the method . in pure monte carlo radiative transfer simulations ,",
    "the noise in any observed property goes as @xmath0 with @xmath1 the number of photon packages , which means that one needs to quadruple the number of photon packages to halve the errors . due to this slow convergence ,",
    "radiative transfer simulations based on the most simple application of the monte carlo method are very inefficient and have difficulties to compete with other methods .",
    "fortunately , in the many years since the first applications of the monte carlo method to radiative transfer simulations , several intelligent optimization techniques have been invented to increase the efficiency of the monte carlo techniques .",
    "these techniques , equivalent to so - called variance reduction techniques in monte carlo integration , aim at reducing the noise by including deterministic elements into the probabilistic simulation .",
    "one of the first examples of such techniques is the well - known forced first scattering technique , already included in the first implementations of monte carlo radiative transfer .",
    "other noise - reduction techniques that have strongly increased the efficiency of the monte carlo method include the use of weighted photon packages @xcite , the peel - off technique @xcite , the treatment of absorption as a continuous rather than a discrete process , the frequency distribution adjustment technique @xcite and the use of polychromatic photon packages @xcite .",
    "one aspect of monte carlo radiative transfer where no significant noise reduction techniques have been presented is the last step in the life cycle of the photon packages , namely their detection .",
    "the goal of most monte carlo radiative transfer simulations is to determine the observed surface brightness distribution at some observer s position . to construct the observed surface brightness distribution ,",
    "some kind of detector must be simulated , on which the photon packages that leave the system are recorded . in the spirit that monte carlo radiative transfer simulations mimic the real physical processes as naturally as possible , the simulated detectors are usually natural ( idealized ) representations of actual ccd detectors .",
    "they basically consist of a two - dimensional array of pixels , which act as a reservoir for the incoming photon packages .",
    "when a photon package leaves the system and arrives at the location of the observer , the correct bin is determined and the luminosity recorded in the bin is increased with the luminosity of the photon package . at the end of the simulation , the detector",
    "is read out like a ccd detector and the surface brightness distribution is constructed .    while this approach seems the most natural way to simulate the detection of photon packages in a monte carlo simulation , it might not be the most efficient",
    ". we must be aware that , although we are simulating a real detection as closely as possible , we have _ more _ information at our disposal than real observers . the maximum information that a real observer can obtain ( in the academic limit of perfect noise - free observations and instruments ) when imaging with a ccd detector , is the number of photon packages that arrive in each of his pixels . as numerical simulators , we have at our disposal the full information on the precise location of the impact of each photon package on the detector .",
    "it would be a pity to throw away this useful additional information just in order to mimic the behaviour of a real ccd detector .",
    "the goal of this paper is to investigate how this additional information can be used to decrease the noise in the estimated surface brightness distributions and hence to increase the efficiency of monte carlo radiative transfer simulations . in section  2",
    "we describe the classical way of detecting photon packages as a smoothing process , similar to the averaging processes encountered in the smoothed particle hydrodynamics framework for hydrodynamical simulations .",
    "we use this similarity between both processes to construct a new set of _ smart _ detectors , which aim at curing two drawbacks of the classical detectors . in section  3",
    "we test the accuracy and performance of these smart detectors and compare them with the classical detector .",
    "the results are summarized and discussed in section  4 .",
    "a typical detector in monte carlo simulations is based on a realistic ccd detector .",
    "it consists of a rectangular two - dimensional array of bins of dimension @xmath2 placed on the plane of the sky .",
    "we denote the centre positions of these bins as @xmath3 , @xmath4 when the @xmath5th photon package hits the detector at a certain position @xmath6 , we find out in which bin it will end , and we add the luminosity @xmath7 carried by photon package to the number of previously detected photon packages in this particular bin . at the end of the simulation ,",
    "we determine our estimate @xmath8 for the surface brightness at the position @xmath9 by summing the contribution of all photon packages that have been recorded in that bin and correcting for the surface of the bin , @xmath10 where @xmath11      \\;0      & \\quad      \\text{else}.    \\end{cases}\\ ] ]      for an interesting point of view on simulating the detection of photon packages and the calculation of the surface brightness distribution , we now shift to another important technique in computational astrophysics , namely smoothed particle hydrodynamics or sph @xcite .",
    "sph is a computational technique for hydrodynamical simulations in which the a fluid is represented as a finite collection of fluid elements . to estimate the value of a physical field @xmath12 at an arbitrary position @xmath13",
    ", we must perform local averages over volumes of nonzero extent ( i.e.  over a finite number of fluid particles ) . the mean or smoothed value of @xmath12 , denoted as @xmath14",
    "can be determined through kernel estimation , @xmath15 where @xmath16 is the so - called smoothing kernel , which should be normalized according to @xmath17 and which typically is strongly peaked about @xmath18 .",
    "in particular , if the fluid mass distribution @xmath19 is represented by a flow of @xmath1 particles with mass @xmath20 , we have @xmath21 and the estimate @xmath22 for the mass distribution is given by @xmath23 the standard interpretation of this formula is to see the fluid elements that make up the representation of the fluid not as point - like particles , but as particles with a smoothed smeared out mass distribution @xmath24 .",
    "the total density at any position @xmath13 is then the sum of the contribution of the @xmath1 particles in the fluid .",
    "returning back to our simulated ccd detector , we note that we can write expression  ( [ isfirstformula ] ) as @xmath25 with @xmath26 a function defined as @xmath27\\ ,",
    "\\\\    \\times    \\left [      \\frac{h\\left(y+\\tfrac12\\delta\\right )        -        h\\left(y-\\tfrac12\\delta\\right)}{\\delta }    \\right]\\ , \\label{wheavi}\\end{gathered}\\ ] ] with @xmath28 the heaviside step function . comparing equations  ( [ is - discr ] ) and ( [ sphmd ] )",
    "we immediately see a connection between the computation of the ( three - dimensional ) mass density in fluids in the sph formalism and the computation of the ( two - dimensional ) surface brightness in a monte carlo radiative transfer simulation .",
    "we can make this connection clearer by rewriting equation  ( [ is - discr ] ) as @xmath29 with @xmath30 since this latter expression is nothing but the `` true '' surface brightness distribution corresponding to @xmath1 photon packages hitting the detector plane ( each photon package results in a dirac delta function ) , equation  ( [ is - cont ] ) is the direct analogue of the sph basic equation  ( [ sphbasic ] ) .",
    "the bottom - line is that we can interpret the radiation field at the plane of the sky as a fluid , which is represented by a finite number of smoothed photon packages .",
    "each smoothed photon package corresponds to a smeared out surface brightness distribution @xmath31 .",
    "formula  ( [ is - discr ] ) shows that the total observed surface brightness distribution at the positions @xmath32 is the sum of the contributions of each of these photon packages .",
    "we have seen that we can interpret the determination of the surface brightness distribution in a monte carlo radiative transfer simulation as a smoothing operation similar to the averaging in sph hydrodynamical simulations .",
    "as in sph simulations , we can consider using a different kernel  in the present case this corresponds to a different kind of detector . in principle",
    ", there is no restriction on the shape of the function @xmath26 apart from the normalization condition @xmath33 and the requirement that @xmath26 is a centrally peaked function .",
    "this freedom allows us to construct _ smart _ detectors which improve upon a number of potential disadvantages of the traditional detector .",
    "a first drawback of the smoothing kernel  ( [ wheavi ] ) is that it is not isotropic , meaning that it has a preferential direction .",
    "not all photon packages hitting the detector at the same given distance from a grid point @xmath9 have the same impact on the surface brightness . for example , a photon package hitting the detector at @xmath34 will not contribute at all to the surface brightness @xmath35 , whereas a photon package hitting the detector at @xmath36 at the same distance , will fully contribute to the estimate of the surface brightness at this grid point .",
    "it is obvious that this problem is solved when we consider circularly symmetric smoothing kernels @xmath37 .",
    "a second drawback of the classical detector is that it does not take into account all the information that is contained in the impacting photon package . for every photon package that falls onto our detector , we know the exact location of the impact .",
    "the only information that a classical simulated detector uses is the bin in which this location falls , without any discrimination of the exact location within this bin .",
    "as argued in the introduction , it would be a pity to not use this information just for the sake of simulating a real ccd detector . to solve the second problem , we need to look for kernels that give more weight to impacts very close to the grid points than to impacts at larger distance , which means that we need a kernel @xmath38 that is a monotonically decreasing function of @xmath39 .",
    "these are just minor limitations and still leave a lot of room for different smart detectors",
    ". we can inspire ourselves on the smoothing kernels that are often used in sph simulations .",
    "the prototypical normalized kernel is a gaussian , in two dimensions , @xmath40 the parameter @xmath41 in this expression , and in all other kernels we will discuss , is called the smoothing length .",
    "it gives the width of the area over which the smoothing is effective ( we will later determine the optimal value for this parameter ) .",
    "an important drawback of the gaussian kernel is its infinite support , meaning that every photon package impacting on the detector has a finite contribution to the surface brightness at all grid points .",
    "every photon package hence in principle requires a summation over all grid points , at most of which it contributes an absolutely negligible contribution .",
    "these efficiency problems are resolved by introducing smoothing kernels with a compact support .",
    "several compact support kernels have been used in the sph literature , the most popular of them being kernels based on b - splines .",
    "the @xmath42 spline kernel @xcite in two dimensions takes the form @xmath43",
    "\\;(\\tfrac32-u)^2      & \\quad      \\text{if $ \\tfrac12\\leq u\\leq\\tfrac32 $ } ,      \\\\[0.5em ]      \\;0      & \\quad      \\text{else } ,    \\end{cases } \\label{m3splinekernel}\\ ] ] with @xmath44 .",
    "it has a continuous first derivative . a similar spline kernel but with a continuous second derivative is the @xmath45 spline smoothing kernel , introduced by .",
    "its two - dimensional form is @xmath46      \\;\\tfrac14\\,(2-u)^3      & \\quad      \\text{if $ 1\\leq u\\leq 2 $ } ,      \\\\[0.5em ]      \\;0      & \\quad      \\text{else}.    \\end{cases } \\label{m4splinekernel}\\ ] ] in principle , we have not requested that the kernel is everywhere non - negative .",
    "some sph simulations have adopted so - called superkernels , which are accurate to third or fourth order , but which necessarily become negative in some part of the domain .",
    "the most famous example of such kernels is the supergaussian kernel @xcite but examples with finite support have also been considered .",
    "using such superkernels could potentially increase the accuracy of the smoothing process , but it can have serious consequences when there is a sharp change in the surface brightness : an undershoot occurs and the recorded surface brightness may become negative . in order to avoid such situations , we stick to positive kernels .      based on the three smoothing kernels  ( [ gaussiankernel ] ) , ( [ m3splinekernel ] ) and ( [ m4splinekernel ] ) we can construct three different kinds of smart detectors . remains to determine which value to take for the smoothing length @xmath41 for each of these smart detectors .",
    "obviously , @xmath41 should be large enough to make the smoothing operation meaningful , whereas too large values of @xmath41 will tend to over - smooth and wash away the details of the surface brightness distribution .",
    "we want the smoothing lengths comparable with the pixel scale , such that the noise in the images remains uncorrelated on a pixel - by - pixel scale ( as for a classical detector ) .",
    "our determination of the optimal smoothing length is derived from the requirement that the effective area or `` resolution '' of the smoothing kernel should be identical to the resolution of the classical detector .",
    "there are various possibilities to identify the effective area of a two - dimensional centrally peaked function .",
    "probably the most general one is the total dispersion @xmath47 , defined through @xmath48 one can readily verify that the classical detector kernel  ( [ wheavi ] ) has a dispersion @xmath49 . requiring that the resolution of the other smoothing kernels are equal to this value we find as reference smoothing lengths @xmath50 figure  [ kernels.pdf ] shows a comparison of the three different smoothing kernels with their optimal smoothing lengths .",
    "+                        we tested the accuracy and the performance of our smart detectors using two toy analytical surface brightness distributions on the plane of the sky .",
    "the first is a simple plummer model , characterized by the circularly symmetric surface brightness distribution @xmath51 with @xmath52 the total luminosity and @xmath53 a scale parameter .",
    "we took the value @xmath54 , implying that the core of the model is well resolved by the detector grid .",
    "the second model is an exponential disc model , rotated over an angle of 20 degrees , @xmath55 with @xmath56 and @xmath57 the scalelength and scaleheight respectively . choosing the disc parameters as @xmath58 and @xmath59",
    ", we create a model with a relatively sharp edge and a strong gradient in the surface brightness distribution .",
    "we have used a classical detector and three smart detectors based on the smoothing kernels  ( [ gaussiankernel ] ) , ( [ m3splinekernel ] ) and  ( [ m4splinekernel ] ) , each of them with a total of @xmath60 grid points . for each model , we ran a set of monte carlo simulations with the number of photon packages varying between @xmath61 and @xmath62 , taking into account that each detector measures the same set of photon packages ( i.e.  we use the same monte carlo realisation for simulations with different detectors ) .    ,",
    "defined in equation  ( [ chi2 ] ) , of the plummer model for different detectors as a function of the total number of photon packages in the simulation .",
    ", scaledwidth=45.0% ]    the different panels of figure  [ images.pdf ] show the resulting measured surface brightness distribution @xmath63 for the various detectors for the simulations with @xmath64 .",
    "looking at this set of images , it is immediately clear that the smart detectors manage to qualitatively reproduce the surface brightness distribution accurately . for a measure of the accuracy of the different detectors , we consider the noise as the difference between the measured surface brightness and the theoretical surface brightness in each pixel , weighted by the expected poisson noise @xmath65 in each pixel , @xmath66 figure  [ noise.pdf ] show the noise images corresponding to the plummer model images from figure  [ images.pdf ] .",
    "it is clear that these images are qualitatively very similar ; thanks to the appropriate choice of the smoothing lengths for the different kernels , there is no correlation in the noise on a pixel - by - pixel scale . a quantitative analysis of these noise images ,",
    "however , shows that the level of the noise in the smart detectors is suppressed .",
    "this is most easily demonstrated using the total noise level , which we define as @xmath67 ^ 2 , \\label{chi2}\\ ] ] where the sum runs over all pixels .",
    "a factor @xmath68 is included in this formula to guarantee that the noise is asymptotically independent of the total number @xmath1 of photon packages used in the simulation .",
    "figure  [ plummerchi2.pdf ] shows the value of @xmath69 for the different detectors as a function of the total number of photon packages in the simulation .",
    "this figure demonstrates that all smart detectors reduce the noise compared to the classical detector .",
    "the most efficient detector is the one based on the @xmath42 spline kernel ; for this detector the noise is reduced by about 10% . for the @xmath45 spline kernel , the most popular finite support kernel in sph simulations , the noise reduction is slightly less efficient ( about 8% ) , whereas for the gaussian kernel the noise reduction is about 5% .",
    "we have constructed our smart detectors based on two fundamental changes applied to the classical detector smoothing kernel  ( [ wheavi ] ) , namely making it circularly symmetric and choosing a smoothly decreasing function of radius .",
    "we can investigate which of these two changes has the most important impact on the noise reduction by constructing two new smoothing kernels in which only one of these two changes is taken into account .",
    "on the one hand , the circularly symmetric analogue of the classical detector kernel  ( [ wheavi ] ) is readily found , @xmath70 .",
    "\\label{cclassicalkernel}\\ ] ] we find in the usual way @xmath71 as reference smoothing length . on the other hand , the rectangular version of the @xmath42 spline kernel  ( [ m3splinekernel ] )",
    "is @xmath72 with @xmath73      \\;\\tfrac12\\,(\\tfrac32-u)^2      & \\quad      \\text{if $ \\tfrac12\\leq u\\leq\\tfrac32 $ } ,      \\\\[0.5em ]      \\;0      & \\quad      \\text{else}.    \\end{cases}\\ ] ] for this kernel we obtain @xmath74 .    in figure  [ testchi2.pdf ]",
    "we plot the total noise parameter @xmath69 of these two new smart detectors in comparison with the classical detector and the circularly symmetric @xmath42 spline detector .",
    "not surprisingly , we find that also these two new detectors suppress the noise compared to the classical detector , but not as efficiently as the @xmath42 spline detector .",
    "the noise reduction in a detector based on the rectangular @xmath42 spline kernel  ( [ rm3splinekernel ] ) is more effective than the noise reduction in the circular analogue  ( [ cclassicalkernel ] ) of the classical detector .",
    "this means that applying a proper weight to the photon packages according to their distance from the grid points is the most important change if we want efficient noise reduction .",
    "of the plummer model for the rectangular and circular equivalents of the classical detector and the smart @xmath42 spline detector.,scaledwidth=45.0% ]",
    "we have focused on an ill - studied area of monte carlo radiative transfer simulations where a significant noise reduction can be achieved , namely the detection of photon packages and the corresponding construction of the observed surface brightness distribution .",
    "the motivation of this work was the fact that the classical detectors used in monte carlo simulations , while closely mimicking a real ccd detector , do not use the full amount of information that is available .",
    "based on the similarities between the construction of the surface brightness distribution on a detector in monte carlo radiative transfer simulations and the calculation of the density in sph hydrodynamical simulations , we have constructed a set of smart detectors .",
    "these smart detectors improve on two aspects of the classical detector : they assign the same weight to all photon packages hitting the detector at the same distance from a grid point and they give more weight to impacts close to a grid point than to impacts at larger distances .",
    "we have tested different kinds of smart detectors , based on different smoothing kernels frequently encountered in sph simulations , namely a gaussian kernel and two spline - based kernels with finite support .",
    "we have shown that these new detectors , while preserving the same effective resolution , reduce the noise in the surface brightness distributions compared to the classical detectors .",
    "it is demonstrated that the lion s share of this noise reduction is due to a proper weighing of the photon packages with the distance between the impact location and the grid point .",
    "the most efficient smart detector is found to be a detector based on the @xmath42 spline kernel , for which the noise reduction amounts to some 10% .",
    "while this might seem a modest improvement , one should take into account that the noise reduction in monte carlo simulation goes as @xmath0 .",
    "a reduction of the noise with 10% is hence equivalent to a reduction of the number of photon packages with 20% , which is a significant improvement .",
    "moreover , it should be stressed that this noise reduction basically comes for free , since the practical implementation of the smart detectors is straightforward and the additional computational cost is completely negligible .",
    "we hence strongly recommend the use of smart detectors in monte carlo radiative transfer simulations .",
    "the link with sph simulations might stimulate to look for further ways to optimize the estimates of the surface brightness distribution .",
    "one major difference between our current problem and the interpolation in sph simulations is that we use a fixed smoothing length , whereas sph simulations typically use a spatially ( and temporally ) varying smoothing length .",
    "this way it is possible to take full advantage of the particle distribution to resolve local density structures .",
    "each particle in an sph simulation typically has an individual smoothing length which is fine - tuned such that each particle interacts with a similar number of neighbors .",
    "unfortunately , it seems hard to introduce variable smoothing lengths here in our current monte carlo radiative transfer case .",
    "the main difference is that the smoothing procedure in sph is executed when all particle positions are known , whereas in monte carlo radiative transfer the photon packages gradually hit the detector and they must be smoothed out onto the detector before it is known where the other photon packages will arrive .",
    "it is impossible to know _ a priori _ how many neighbors a photon package will ultimately have and hence to adapt the smoothing length on an individual basis .",
    "one could potentially do a test run with a limited number of photon packages to obtain a first crude estimate of the expected surface brightness distribution and adapt the smoothing lengths accordingly .",
    "however , a more elegant option seems to apply an adaptive filtering to the simulated images _",
    "after _ the simulation .",
    "several approaches have been developed for this goal such as wavelet - based algorithms , adaptive binning techniques or adaptive kernel smoothing techniques @xcite ."
  ],
  "abstract_text": [
    "<S> many optimization techniques have been invented to reduce the noise that is inherent in monte carlo radiative transfer simulations . </S>",
    "<S> as the typical detectors used in monte carlo simulations do not take into account all the information contained in the impacting photon packages , there is still room to optimize this detection process and the corresponding estimate of the surface brightness distributions . </S>",
    "<S> we want to investigate how all the information contained in the distribution of impacting photon packages can be optimally used to decrease the noise in the surface brightness distributions and hence to increase the efficiency of monte carlo radiative transfer simulations .    </S>",
    "<S> we demonstrate that the estimate of the surface brightness distribution in a monte carlo radiative transfer simulation is similar to the estimate of the density distribution in an sph simulation . </S>",
    "<S> based on this similarity , a recipe is constructed for smart detectors that take full advantage of the exact location of the impact of the photon packages . </S>",
    "<S> several types of smart detectors , each corresponding to a different smoothing kernel , are presented . </S>",
    "<S> we show that smart detectors , while preserving the same effective resolution , reduce the noise in the surface brightness distributions compared to the classical detectors . </S>",
    "<S> the most efficient smart detector realizes a noise reduction of about 10% , which corresponds to a reduction of the required number of photon packages ( i.e.  a reduction of the simulation run time ) of 20% . as the practical implementation of the smart detectors is straightforward and </S>",
    "<S> the additional computational cost is completely negligible , we recommend the use of smart detectors in monte carlo radiative transfer simulations .    </S>",
    "<S> radiative transfer  methods :  numerical </S>"
  ]
}