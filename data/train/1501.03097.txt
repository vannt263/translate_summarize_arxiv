{
  "article_text": [
    "given a group @xmath0 , another group @xmath2 is said to be _ fully residually @xmath0 _ ( or _ discriminated by @xmath0 _ ) if , given any finite subset @xmath3 , @xmath4 , there exists a homomorphism @xmath5 , such that @xmath6 for all @xmath7 .",
    "the study of groups discriminated by various classes of groups has been ongoing since the early twentieth century , with increased activity often occuring as other equivalent characterizations of such groups , and applications in different fields , are found .",
    "for example , the development of algebraic geometry over groups allowed finitely generated groups discriminated by a free group @xmath8 to be considered as coordinate groups of irreducible systems of equations over @xmath8 .",
    "this helped enable solutions to tarski s problems on the elementary theory of free groups , given independently by kharlampovich - myasnikov and sela ( @xcite and @xcite ) .    throughout",
    ", we let @xmath1 be an arbitrary fixed torsion - free hyperbolic group .",
    "while some of the theory of fully residually free groups can be generalized easily to groups discriminated by @xmath1 , in general groups discriminated by @xmath1 are more difficult to work with for several reasons .",
    "unlike finitely generated fully residually free groups , finitely generated fully residually @xmath1 groups may be not finitely presented and can contain finitely generated subgroups with no finite presentation , so algorithmic results can often be more difficult to obtain .    in @xcite , grigorchuk provided the following topological perspective of finitely generated fully residually @xmath0 groups , which also has the benefit of providing grammatically convenient terminology .",
    "the _ set of marked groups on @xmath9 generators _ , denoted @xmath10 , is the set @xmath11 , where @xmath12 is an ordered set of generators ( repeats allowed ) for @xmath0 , @xmath13 , and @xmath14 iff the bijection @xmath15 gives an isomorphism of @xmath0 and @xmath16 .",
    "@xmath10 can also be thought of as cayley graphs on @xmath9 generators , epimorphisms from @xmath17 , or normal subgroups of @xmath17 .",
    "now for @xmath18 , define @xmath19 , where @xmath20 is the maximum value such that @xmath21 , where @xmath22 is the ball of radius @xmath23 in @xmath17 .",
    "considering elements of @xmath10 as normal subgroups of @xmath17 this metric defines the _ space of marked groups on @xmath9 generators _ , and a group is said to be a @xmath0-limit group if it has a marking which is the limit of markings of subgroups of @xmath0 in this space .",
    "note that the above metric is an ultrametric on the set of subsets of @xmath17 , so it defines a totally discontinuous metric space ( so compact by tychonoff s theorem ) , and since the set of normal subgroups @xmath17 is closed under the inherited metric , @xmath10 is compact .",
    "there are numerous conditions equivalent to a group being a @xmath0-limit group , particularly when @xmath0 is an equationally noetherian group ( i.e. every system of equations with @xmath9 variables over @xmath0 is equivalent to a finite system of equations ) , for example , finitely generated fully residually @xmath0 groups are exactly @xmath0-limit groups .",
    "some other relevant equivalent conditions can be found in section [ section : limit - grps ] .",
    "our first main theorem shows that , for a fixed torsion - free hyperbolic group @xmath1 , the condition of being an iterated generalized double over @xmath1 ( terminology introduced by champetier and guirardel in @xcite for free groups ) is equivalent to being a @xmath1-limit group .",
    "a group @xmath0 is a _",
    "generalized double _ over a @xmath1-limit group @xmath2 if it splits as @xmath24 , or @xmath25 , where @xmath26 and @xmath27 are finitely generated such that :    1 .",
    "@xmath28 is a non - trivial abelian group whose images are maximal abelian subgroups in the vertex groups . 2 .",
    "there is an epimorphism @xmath29 which is injective on each vertex group    note that each vertex group is discriminated by @xmath1 .",
    "a group is an _ iterated generalized double over @xmath1 _ if it belongs to the smallest class of groups @xmath30 that contains @xmath1 , and is stable under free products and the construction of generalized doubles over groups in @xmath30 .",
    "champetier and guirardel showed in @xcite that a group is an @xmath8-limit group if and only if it is an iterated generalized double over a free group @xmath8 .",
    "our first main theorem shows that the same holds for @xmath1-limit groups .",
    "[ gamma - igd ] @xmath0 is a @xmath1-limit group if and only if it is an iterated generalized double over @xmath1    theorem [ gamma - igd ] is proved in section [ sec : igd ] .",
    "the proof relies on bass - serre theory and embedding @xmath1-limit groups into groups obtained by a finite number of extensions of centralizers , starting with @xmath1 . such embeddings were shown to exist in @xcite via embeddings into @xmath1-ntq groups ( defined in section [ section : alg - geo ] ) .",
    "some details about those embeddings , which are relevant in later proofs , are given in section [ section : homoms ] .",
    "since the proof of theorem [ gamma - igd ] is more elementary , we present it first .    recall that the grushko decomposition of a finitely generated group @xmath0 is the free product decomposition @xmath31 , where @xmath32 is a free group of finite rank , and each @xmath33 is non - trivial , freely indecomposable , and not infinite cyclic ( see @xcite ) .",
    "this decomposition is unique up to permutation of the conjugacy classes of the @xmath33 in @xmath0 .    in section [ section : jsj ] , we describe a canonical decomposition of a certain type , called a primary jsj decomposition , for a freely indecomposable group , which encodes all abelian splittings .",
    "primary jsj decompositions were shown to exist for @xmath1-limit groups in @xcite .    in order to state our second main theorem ( the proof of which relies on the background given in section [ section : homoms ] ) ,",
    "we mention here one significant construction from @xcite .",
    "this construction ( of a hom - diagram ) gives a finite number of homomorphisms @xmath34 from a coordinate group @xmath35 of a system of equations over @xmath1 , into @xmath1-ntq groups @xmath36 this finite collection has the property that all homomorphisms from @xmath35 to @xmath1 factor through it .",
    "an algorithm to construct some hom - diagram for @xmath35 was given in @xcite . in section [ hom ]",
    "we will describe a canonical hom - diagram that encodes all the homomorphisms from @xmath37 into @xmath1 and canonical ntq groups that correspond to branches of this diagram .    in section [ decomp : max - quotients ]",
    "we prove the following theorem , which is our second main result .",
    "[ 11]let @xmath38 is a finite system of equations over @xmath1 .",
    "there is an algorithm to construct a canonical hom - diagram and a complete set of canonical ntq groups ( and systems ) for @xmath39",
    "we start with some basic theory of algebraic geometry over groups . for more background , see @xcite .",
    "let @xmath0 be a group generated by a finite set @xmath26 and @xmath40 the free group on @xmath41 . for @xmath42=g*f(x)$",
    "] , the expression @xmath43 is called a _ system of equations _ over @xmath0 , and a _ solution _ of @xmath43 in @xmath0 , is a @xmath0-homomorphism @xmath44\\rightarrow g$ ] such that @xmath45 ( a @xmath0-homomorphism is determined by @xmath46 ; the notation @xmath47 means that @xmath48 corresponds to a solution of @xmath12 ) .",
    "denote the set of all solutions of @xmath43 in @xmath0 by @xmath49 , the _ algebraic set defined by @xmath12_. define the zariski topology on @xmath50 by taking algebraic sets as a pre - basis of closed sets .",
    "note that the algebraic set @xmath49 uniquely corresponds to the normal subgroup @xmath51|\\forall z\\in g^n(s(z , a)=1\\rightarrow t(z , a)=1)\\}$ ] in @xmath52 $ ] , called the _",
    "radical _ of @xmath12 . call @xmath53/r(s)$ ] the _ coordinate group _ of @xmath12 .",
    "every solution of @xmath43 in @xmath0 can be described as a @xmath0-homomorphism @xmath54 .",
    "a system of equations @xmath43 is said to be ( strictly ) _ quadratic _ if each @xmath55 that appears in @xmath12 , appears at most ( exactly ) twice , where @xmath56 also counts as an appearance .",
    "there are four standard quadratic equations : @xmath57=1 ; n\\geq 1\\ ] ] @xmath58\\prod_{i=1}^mc_i^{z_i}d=1 ; n , m\\geq 0,n+m\\geq 1\\ ] ] @xmath59 @xmath60 where @xmath61 and @xmath62 are non - trivial elements of @xmath0 .",
    "note that for any strictly quadratic word @xmath63 $ ] , there is a @xmath0-automorphism of @xmath52 $ ] that takes @xmath12 to a standard quadratic word .",
    "also , there is a punctured surface associated to each standard quadratic equation , specifically an orientable surface of genus @xmath9 with zero punctures for ( [ closedorientable ] ) , an orientable surface of genus @xmath9 with @xmath64 punctures for ( [ boundorientable ] ) , a non - orientable surface of genus @xmath9 and zero punctures for ( [ closednonorientable ] ) , and a non - orientable surface of genus @xmath9 with @xmath64 punctures for ( [ boundnonorientable ] ) . for a standard quadratic equation @xmath12 , let @xmath65 be the euler characteristic of the associated surface .",
    "a system of equations @xmath43 over a group @xmath0 generated by @xmath26 , is called _ triangular quasi - quadratic over @xmath0 _ or @xmath0-tq , if it can be partitioned into subsystems : @xmath66 @xmath67 @xmath68 @xmath69 where @xmath70 is a partition of @xmath71 , + and setting @xmath72/r_g(s_i,\\ldots , s_n)$ ] for @xmath73 and @xmath74 , we have @xmath75 for @xmath76 and @xmath77 .",
    "furthermore , for each @xmath78 the subsystems @xmath79 must have one of the following forms :    a.   @xmath79 is quadratic in @xmath80 b.   @xmath81=1,[x , u]=1|x , y\\in x_i , u\\in u\\}$ ] where @xmath82 c.   @xmath81=1|x , y\\in x_i\\}$ ] d.   @xmath79 is empty    the number @xmath9 is called the _ depth _ of the system    notice that it may be assumed that every subsystem of form ( i ) is actually a single quadratic equation in standard form .",
    "also , it can be checked directly that @xmath83/r_{g_{i+1}}(s_i)$ ] .",
    "@xmath43 is called _ non - degenerate triangular quasi - quadratic over @xmath0 _ or @xmath0-ntq if it is @xmath0-tq and for every @xmath78 , the system @xmath84 has a solution in @xmath85 , and if @xmath79 is of form ( ii ) the set @xmath86 generates a centralizer in @xmath85 .",
    "a _ regular _",
    "@xmath0-ntq system is a @xmath0-ntq system in which each non - empty quadratic equation @xmath79 is in standard form , and either @xmath87 and the quadratic equation has a non - commutative solution in @xmath85 , or it is an equation of the form @xmath88d=1 $ ] or @xmath89[x_2,y_2]=1 $ ] .",
    "finally a group is called a _",
    "( regular ) @xmath0-ntq group _ if it is isomorphic to the coordinate group of a ( regular ) @xmath0-ntq system of equations .",
    "note that in sela s work ( @xcite ) , _ @xmath90-residually free towers _ provide an analagous structure to @xmath8-ntq groups , and in the work of casals - ruiz and kazachkov ( @xcite ) , _ graph towers _ are , in a certain sense , higher dimensional analogues of ntq systems for working with right angle artin groups .",
    "note that if @xmath0 is toral relatively hyperbolic , every @xmath0-ntq group is also toral relatively hyperbolic ( @xcite ) .",
    "recall farb s definition that a finitely generated group @xmath0 is said to be hyperbolic relative to finitely generated subgroups @xmath91 if the _ coned - off cayley graph _",
    "obtained from the cayley graph of @xmath0 by contracting each coset @xmath92 , to a point , is hyperbolic , and the _ bounded coset property _ is satisfied ( @xcite ) .",
    "@xmath0 is said to satisfy the bounded coset property if any two quasi - geodesics in the coned - off cayley graph , with the same endpoints , enter and exit cosets @xmath93 a bounded distance apart or , if only one passes through a coset it does so for a bounded distance .",
    "see @xcite,@xcite,@xcite,@xcite for other equivalent definitions of relatively hyperbolic groups .",
    "a group @xmath0 hyperbolic relative to a collection @xmath91 is _ toral _ if @xmath0 is torsion - free and each @xmath94 is a non - cyclic free abelian group .    if @xmath0 is a hyperbolic group we will often have a situation when @xmath95 is not just @xmath0 but the free product of @xmath0 and finite number of hyperbolic groups which are conjugates of subgroups of @xmath0 .",
    "a coordinate group of an ntq system over such @xmath95 will be also called a @xmath0-ntq group .",
    "there are numerous important equivalent characterizations of @xmath0-limit groups , when @xmath0 is equationally noetherian , which give some motivation for the study of these groups .",
    "we reference some of the characterizations here .",
    "( @xcite theorem a , some specific equivalences from @xcite and @xcite ) let @xmath2 be a finitely generated group and @xmath0 an equationally noetherian group .",
    "the following are equivalent :    1 .",
    "@xmath2 is a @xmath0-limit group 2 .",
    "@xmath2 is fully residually @xmath0 3 .",
    "@xmath2 embeds in an ultrapower of @xmath0 4 .",
    "@xmath96 5 .",
    "@xmath97 6 .",
    "@xmath2 is the coordinate group of an irreducible ( in the zariski topology ) algebraic set over @xmath0 defined by a system of coefficient - free equations ( call such a system an _ irreducible system _ )    there is an analagous theorem for the case with coefficients ( @xcite theorem",
    "b ) . recall that the elementary theory of a group @xmath0 , denoted @xmath98 , is the set of all first - order sentences that are true in @xmath0 . the universal theory of @xmath0 , denoted",
    "@xmath99 is the set of true first - order sentences formed using only universal quantifiers , and the the existential theory of @xmath0 , denoted @xmath100 is the set of true first - order sentences formed using only existential quantifiers .    in the same paper kharlampovich and myasnikov",
    "prove the existence of some very useful embeddings of particular @xmath0-limit groups .",
    "[ th4](@xcite theorems d and e ) let @xmath0 be a fixed toral relatively hyperbolic group .",
    "a.   every @xmath0-limit group embeds into a @xmath0-ntq group .",
    "b.   every @xmath0-limit group embeds into a group obtained by finitely many extensions of centralizers , starting with @xmath0 ( i.e. an iterated extension of centralizers over @xmath0 ) .    since in this case",
    "@xmath0-ntq groups and iterated extensions of centralizers over @xmath0 are easily shown to be @xmath0-limit groups , and subgroups of @xmath0-limit groups are again @xmath0-limit groups , the properties of embedding into a @xmath0-ntq group , or embedding into an iterated extension of centralizers over @xmath0 , are both equivalent to being a @xmath0-limit group . since torsion - free hyperbolic groups are toral relatively hyperbolic",
    ", we will often rely on the existence of such embeddings for a @xmath1-limit group .",
    "we can now prove theorem [ gamma - igd ] .",
    "we start with the following useful elementary example of a generalized double .",
    "[ extcent ] a free rank one extension of centralizer over @xmath1 , @xmath101=1>=\\gamma*_{c_\\gamma(u)}$ ] , is a generalized double over @xmath1    let @xmath102 @xmath103    @xmath104 is injective on @xmath1 and by definition a centralizer is maximal abelian in @xmath1 .",
    "this fact , along with the fact that @xmath1-limit groups are exactly subgroups of iterated extensions of centralizers over @xmath1 is enough to prove one direction of theorem [ gamma - igd ] .",
    "let @xmath0 be a generalized double over a @xmath1-limit group @xmath2 .",
    "then @xmath0 is a @xmath1-limit group .",
    "first consider the case where @xmath0 is an amalgamated product .",
    "let @xmath104 be the map from @xmath0 to @xmath2 as in the definition of generalized double .",
    "denote the images of @xmath105 under @xmath104 by @xmath106 , @xmath107 , and @xmath108 respectively .",
    "let @xmath109 be the maximal abelian subgroup of @xmath2 containing @xmath108 .",
    "consider the group @xmath110=1,c\\in\\hat{c}>$ ] . since @xmath2 embeds into an iterated centralizer extension of @xmath1 , so does @xmath111 .",
    "let @xmath112 ; clearly @xmath113 .",
    "we claim that @xmath114 .",
    "this can be showed using normal forms .",
    "in particular , the maps @xmath115 and @xmath116 defined by composing the restrictions of @xmath104 to @xmath26 and @xmath27 respectively with the natural embedding of @xmath106 and @xmath107 into @xmath117 ( and in the case of @xmath116 , composing with conjugation by the stable letter @xmath118 in between ) , are injective ( only the conjugation need be checked , and this follows since @xmath118 is stable letter for @xmath111 ) by theorem 1.6 of @xcite .",
    "so define @xmath119 by @xmath120 for each word in @xmath0 in normal form ( @xmath121 ) . since if @xmath122 then @xmath123 and @xmath124 so @xmath125 , we have @xmath126 in normal form .",
    "since every element of @xmath117 has normal form of @xmath127 , @xmath104 is an isomorphism .",
    "then @xmath0 embeds into @xmath111 and so by theorem [ th4 ] , @xmath0 is a @xmath1-limit group .",
    "the case for @xmath25 is similar , since @xmath128 ( and using the fact that if images of @xmath129 do nt coincide then they must be conjugate by commutative transitivity ) again embeds into @xmath111 .    to prove the converse , we make additional use of bass - serre theory .",
    "[ construct : igd]every @xmath1-limit group @xmath0 can be constructed by iterated generalized doubles over @xmath1 .",
    "@xmath130 at 114 36 @xmath131 at 143 73 @xmath132 at 173 109 @xmath133 at 121 95 @xmath134 at 130 137 @xmath135 at 68 77 @xmath136 at 40 101 @xmath137 at 206 96 @xmath138 at 240 79 @xmath139 at 254 54 @xmath140 at 262 29 @xmath141 at 311 51 @xmath142 at 283 64 @xmath143 at 247 140 @xmath144 at 219 130 @xmath145 at 308 119 @xmath146 at 278 131 @xmath147 at 291 177 @xmath148 at 293 155 @xmath149 at 118 234 @xmath150 at 194 231 @xmath151 at 54 202 @xmath152 at 196 257 @xmath153 at 132 183 @xmath154 at 72 176 @xmath155 at 159 213 @xmath156 at 142 253        assume that @xmath0 is freely indecomposable .",
    "@xmath0 embeds into an iterated extension of centralizers @xmath157 over @xmath1 .",
    "@xmath157 is an iterated generalized double over @xmath1 .",
    "we claim that every subgroup of @xmath157 is also an iterated generalized double .",
    "we proceed by induction .",
    "let @xmath158=1>$ ] for some @xmath1-limit group @xmath2 and @xmath159 .",
    "let @xmath160 .",
    "so @xmath157 is an hnn extension @xmath161 .",
    "now by bass - serre theory , @xmath0 acts ( without inversions ) on a tree with vertices given by the cosets @xmath162 ( stabilizers are the groups @xmath163 ) , and edges @xmath164 ( corresponding to groups @xmath165 ) , for each coset representative @xmath166 .",
    "in particular the initial vertex of the edge @xmath164 is @xmath162 and terminal vertex of @xmath164 is @xmath167 .",
    "every coset @xmath162 has a representative of the form @xmath168 where the @xmath169 are representatives for cosets of @xmath28 in @xmath2 , @xmath170 and the @xmath171 are non - zero except possibly @xmath172 and @xmath173 .",
    "now for each edge @xmath168 , the terminal vertex is @xmath174 and the initial vertex is @xmath175 if @xmath176 , and @xmath177 if @xmath178 .",
    "see figure [ fig : bstree ] ( vertex cosets are in red , edge cosets in blue ) .",
    "we want to show the the corresponding edge group in the quotient graph of groups is maximal abelian in the corresponding vertex groups .",
    "now @xmath179 and @xmath180 .",
    "clearly @xmath181 , and since @xmath182 we have @xmath183 .",
    "+ finally , @xmath184 .",
    "a conjugate of a centralizer is again a centralizer in the corresponding conjugate of the ambient group ( this can be easily checked directly ) , and centralizers are maximal abelian .",
    "so intersecting a maximal abelian subgroup and it s ambient group with the same group @xmath0 preserves maximality of the abelian subgroup ( again , this can be easily checked directly ) .",
    "also , clearly every conjugate @xmath185 is isomorphic to @xmath2 , and so each @xmath186 can be mapped monomorphically to @xmath2 . since",
    "any free factor of a @xmath1-limit group is a @xmath1-limit group , the proposition is proved .",
    "theorem [ gamma - igd ] follows ( since free products of @xmath1 limit groups are also @xmath1-limit groups ) .",
    "in this section we descibe properties of jsj decompositions decompositions of groups .",
    "we refer to @xcite , @xcite , @xcite , and @xcite for further background on various notions of jsj decompositions for groups .",
    "recall that a _ splitting _ of a group @xmath0 is a graph of groups decomposition .",
    "a splitting is _ abelian ( cyclic ) _ if all edge groups are abelian ( cyclic ) .",
    "elementary _ splitting is one in which the graph of groups has exactly one edge .",
    "a splitting is _ reduced _ if the image of each edge group is a proper subgroup of the corresponding vertex group .",
    "a splitting of a group @xmath0 is _ essential _ if it is reduced , all edge groups are abelian and for each edge group @xmath157 , if @xmath187 for some @xmath188 , then @xmath189 .",
    "a reduced splitting of @xmath0 is _ primary _ if it is essential and each noncyclic abelian subgroup of @xmath0 can be conjugated into some vertex group of the splitting .",
    "an elementary splitting @xmath190 can be _ unfolded _ if there is another splitting @xmath191 where @xmath192 is a proper subgroup of @xmath28 and @xmath193 .",
    "an elementary splitting @xmath194 can be _ unfolded _ if there is another splitting @xmath195 where the image of @xmath192 in @xmath196 is a proper subgroup of @xmath28 , and @xmath197 where @xmath118 is the stable letter of @xmath194 .",
    "we say a splittings in _ unfolded _ if no elementary splitting can be unfolded .    for an arbitrary freely indecomposable @xmath1-limit group @xmath2 , in @xcite ( theorem 1.10 ) , the existence of a reduced unfolded splitting of @xmath2 , w which is called an abelian jsj decomposition of @xmath2 ,",
    "is given which satisfies the following properties :    a.   every maximal qh subgroup of @xmath2 is conjugate to a vertex group of the jsj , ( so every qh subgroup of @xmath2 can be conjugated into a vertex group of the jsj ) , and every vertex group of the jsj which is not conjugate to a maximal qh subgroup of l is elliptic in any abelian subgroup of @xmath2 .",
    "b.   any elementary abelian splitting of @xmath2 which is hyperbolic in another elementary abelian splitting , can be obtained from the jsj by cutting a 2-orbifold corresponding to a maximal qh subgroup of @xmath2 along a weakly essential simple closed curve . c.   any elementary abelian splitting of @xmath2 which is elliptic with respect to every other elementary elementary abelian splitting of @xmath2 ,",
    "can be obtained from the jsj by a sequence of collapsings , foldings , and conjugations .",
    "d.   any two reduced unfolded abelian splittings of @xmath2 satisfying the above three properties can be obtained from one another by a sequence of slidings , conjugations , and modification of boundary monomorphisms by conjugations e.",
    "all non - cyclic abelian subgroups are elliptic .",
    "we now present some constructions from @xcite , along with some similar background from @xcite in the free group case , which give finitely many homomorphisms of @xmath35 into @xmath1-ntq groups , among which all maximal @xmath1-limit quotients of @xmath35 are included as images .",
    "so if @xmath12 is irreducible , these include at least one embedding of @xmath35 .",
    "consider an elementary abelian splitting of a group @xmath0 .",
    "if we have @xmath198 , for @xmath199 define an automorphism @xmath200 such that @xmath201 for @xmath7 and @xmath202 for @xmath203 .",
    "if instead we have @xmath204 then for @xmath199 we define @xmath200 such that @xmath201 for @xmath7 and @xmath205 .",
    "call the @xmath206 a _ dehn twist _ obtained from the corresponding elementary abelian splitting of @xmath0 . if @xmath0 is an @xmath1-group , where @xmath1 is a subgroup of one of the factors @xmath26 or @xmath27 , then dehn twists that fix elements of the group @xmath207 are called _ canonical dehn twists_. similarly , one can define canonical dehn twists with respect to an arbitrary fixed subgroup @xmath208 of @xmath0 .",
    "let @xmath209 [ resp .",
    "@xmath210 be the set of all abelian splittings of @xmath0 [ resp .",
    "the set of all abelian splittings such that @xmath211 is elliptic ] .",
    "let @xmath212 [ @xmath213 be an abelian splitting of a group @xmath0 and @xmath214 be either a qh or an abelian vertex of @xmath215 .",
    "then an automorphism @xmath216 is called a _ canonical automorphism _ corresponding to the vertex @xmath214 if @xmath217 satisfies the following conditions :    a.   @xmath217 fixes ( up to conjugation ) element - wise all vertex group in @xmath215 , other than @xmath214 .",
    "note that @xmath217 also then fixes ( up to conjugation ) all the edge groups",
    ". b.   if @xmath214 is a qh vertex in @xmath215 , then @xmath217 is a dehn twist ( canonical dehn twist ) corresponding to some essential @xmath218-splitting of @xmath0 along a cyclic subgroup of @xmath214 . c.   if @xmath214 is an abelian subgroup then @xmath217 acts as an automorphism on @xmath214 which fixes all the edge subgroups of @xmath214 .",
    "let @xmath219 be an edge in an abelian splitting @xmath215 of a group @xmath0 .",
    "let @xmath216 .",
    "call @xmath220 a _ canonical automorphism corresponding to the edge @xmath219 _ if @xmath217 is a dehn twist of @xmath0 with respect to the elementary splitting of @xmath0 along the edge @xmath219 , induced from the splitting @xmath215 . if @xmath221 , then @xmath217 must fix @xmath1 element wise .",
    "the group of canonical automorphisms of a freely indecomposable group @xmath0 with respect to an abelian splitting @xmath215 is the subgroup @xmath222 generated by all canonical automorphisms of @xmath0 corresponding to all edges , all @xmath223 vertices , and all abelian vertices of @xmath215 .",
    "if @xmath0 is not a @xmath224 then include conjugation as well .",
    "the group of canonical automorphisms of a free product is the direct product of the canonical automorphism groups of factors .      in this section",
    "we describe how to encode solutions to equations over @xmath1 using a hom - diagram .",
    "we begin by describing similar hom - diagram for equations over free groups .",
    "there is an algorithm described in @xcite that , given a system of equations @xmath226 over the free group @xmath227 , constructs ( canonically ) a diagram , which encodes the solutions of @xmath12 .",
    "specifically , it constructs a directed , finite , rooted tree @xmath228 that has the following properties :    a.   each vertex @xmath229 of @xmath228 is labelled by a pair @xmath230 , where @xmath214 is an @xmath8-quotient of @xmath0 and @xmath231 the subgroup of canonical automorphisms in @xmath232 ( with respect to a jsj decomposition @xmath233 of @xmath214 , which can be constructed algorithmically by @xcite ) .",
    "the root @xmath234 is labelled by @xmath235 and every leaf is labelled by @xmath236 where @xmath237 is some finite set ( called _ free variables _ ) .",
    "each @xmath214 , except possibly @xmath238 , is fully residually @xmath8 .",
    "b.   every ( directed ) edge @xmath239 is labelled by a proper surjective + @xmath8-homomorphism @xmath240 . c.   for every @xmath241",
    ", there is a path @xmath242 , where @xmath243 is a leaf labelled by @xmath236 , elements @xmath244 , and a @xmath8-homomorphism @xmath245 such that @xmath246 considering all such @xmath8-homomorphisms @xmath247 , the family of the above sequences of homomorphisms is called the _ fundamental sequence _ over @xmath8 corresponding to @xmath248 .",
    "d.   the canonical splitting of each fully residually free group @xmath214 is its grushko decomposition followed by the abelian jsj decompositions of the factors .    in @xcite",
    "it s shown , given a finite system of equations @xmath47 over @xmath1 , how to construct a similar diagram encoding @xmath249 .",
    "we briefly review the construction here .",
    "first construct the systems @xmath250 over @xmath8 from the system @xmath47 over @xmath1 by taking canonical representatives in @xmath251 for elements of @xmath1 ( which exists by theorem 4.5 of @xcite ) , see lemma 3 in @xcite for more details on the construction of these systems .",
    "construct the free group solution tree @xmath252 , as described above , for each system @xmath253 .",
    "we form a new , larger tree @xmath254 by taking a root vertex @xmath234 labelled by @xmath255 , attaching it to the root vertex of each @xmath252 by an edge labelled by @xmath256 , where @xmath257 is the homomorphism induced by canonical representatives . for each leaf @xmath229 of @xmath252 , labelled by @xmath258 , build a new vertex @xmath259 labelled by @xmath260 and an edge @xmath261 labelled by the epimorphism @xmath262 which is induced from @xmath263 by acting as the identity on @xmath264 .",
    "we call a path @xmath265 from the root @xmath266 to a leaf @xmath243 a _ branch _ @xmath267 of @xmath254 .    now",
    "associate to each branch @xmath267 the set @xmath268 consisting of all homomorphisms @xmath269 of the form @xmath270 where @xmath271 and @xmath272 .",
    "@xmath268 is called the _ fundamental sequence _ over @xmath1 corresponding @xmath267 . since @xmath273 is in bijective correspondence with the set of functions @xmath274 , all elements of @xmath268",
    "can be effectively constructed .    a fundamental sequence over @xmath1 such that :    1 .",
    "the image of each non - abelian vertex group is non - abelian .",
    "2 .   for each @xmath275",
    ", @xmath276 is injective on rigid subgroups , edge groups , and images of edge groups in abelian vertex groups in @xmath277 .",
    "3 .   for each @xmath275 , @xmath23 a rigid subgroup in @xmath277 and @xmath278 , @xmath279 , the abelian vertex groups in @xmath277 connected to @xmath23 by edge groups @xmath280 with the maps @xmath281 , then @xmath276 is injective on the subgroup @xmath282",
    ".    is called a _ strict fundamental sequence_. by @xcite ; , there is an algorithm constructing an equivalent tree @xmath225 encoding @xmath249 where all fundamental sequences are strict .",
    "each strict fundamental sequence @xmath268 determines a @xmath1-ntq group @xmath283 ( with depth of @xmath1-ntq system equal to the length of @xmath267 ) into which @xmath35 maps by a homomorphism @xmath284 .",
    "the proof of this given in @xcite ; relies on a ` reworking process ' , which converts @xmath8-ntq systems ( where @xmath8 is a free group ) into appropriate @xmath1-ntq systems .    after constructing the hom - diagram @xmath225 ,",
    "each branch @xmath267 corresponding to a strict fundamental sequence @xmath268 is obtained from a strict fundamental sequence over @xmath8 .",
    "considering the corresponding @xmath8-ntq systems as systems of equations over @xmath1 gives groups through which all homomorphisms from @xmath35 to @xmath1 factor , but may kill certain parts of the ntq structure .",
    "the reworking process fixes those degenerate portions , while maintaining the factoring of all homomorphisms @xmath285 through a least one of the resulting @xmath1-ntq groups . for each @xmath8-ntq system @xmath43 ,",
    "the reworking process constructs a new system of equations @xmath286 over @xmath1 by adding new variables and new equations depending on the form of @xmath12 ( see @xcite , section 3.3 ) .",
    "the resulting system is in @xmath1-ntq form .",
    "so after the reworking process we now have the homomorphisms @xmath284 for each strict fundamental sequence @xmath268 .",
    "let @xmath287 be a system of equations with a solution in a group @xmath0 .",
    "we say that a system of equations @xmath288 is _ compatible _ with @xmath287 over @xmath0 , if for every solution @xmath86 of @xmath287 in @xmath0 , the equation @xmath289 also has a solution in @xmath0 . more generally , a formula @xmath290 in the language @xmath291 is _ compatible _ with @xmath287 over @xmath0 , if for every solution @xmath292 of @xmath287 in @xmath0 there exists a tuple @xmath293 over @xmath0 such that the formula @xmath294 is true in @xmath0 .",
    "suppose now that a formula @xmath290 is compatible with @xmath295 over @xmath0 .",
    "we say that @xmath290 _ admits a lift to a generic point _ of @xmath296 over @xmath0 ( or just that it has an _",
    "@xmath12-lift _ over @xmath0 ) , if the formula @xmath297 is true in @xmath298 ( here @xmath237 are variables and @xmath71 are constants from @xmath298 ) .",
    "finally , an equation @xmath299 , which is compatible with @xmath300 , admits a _",
    "complete @xmath12-lift _ if every formula @xmath301 , which is compatible with @xmath302 over @xmath0 , admits an @xmath12-lift .",
    "we say that the lift ( complete lift ) is _ effective _ if there is an algorithm to decide for any equation @xmath303 ( any formula @xmath301 ) whether @xmath303 ( the formula @xmath301 ) admits an @xmath12-lift , and if it does , to construct a solution in @xmath304    we now decribe the construction of particular families of solutions , called _ generic families _ , of a ntq system which imply nice lifting properties over that system . consider a fundamental sequence with corresponding ntq system @xmath43 of depth @xmath305 .",
    "we construct generic families iteratively for each level @xmath306 of the system , starting at @xmath307 and decreasing @xmath306 .",
    "there is an abelian decomposition of @xmath308 corresponding to the ntq structure .",
    "let @xmath309 be the vertex groups of this decomposition given some arbitrary order .",
    "we construct a generic family for level @xmath306 , denoted @xmath310 , by constructing generic families for each vertex group in order .",
    "we denote a generic family for the vertex group @xmath311 by @xmath312 . if there are no vertex groups , in other words the equation @xmath313 is empty ( @xmath314 ) we take @xmath310 to be a sequence of growing different merzljakov s words ( defined in @xcite , section 4.4 ) .    if @xmath315 is an abelian group then it corresponds to equations of the form @xmath316=1 $ ] or @xmath317=1 $ ] , @xmath318 , where @xmath319 runs through a generating set of a centralizer in @xmath320 .",
    "a solution @xmath321 in @xmath320 to equations of these forms is called _ @xmath27-large _ if there is some @xmath322 with each @xmath323 such that @xmath324 or @xmath325 , for @xmath326 ( possibly renaming @xmath327 ) .",
    "a generic family of solutions for an abelian subgroup @xmath315 is a family @xmath328 such that for each @xmath329 in any increasing sequence of positive integers @xmath330 there is a solution in @xmath328 which is @xmath329-large .",
    "if @xmath315 is a qh vertex group of this decomposition , let @xmath12 be the surface associated to @xmath315 .",
    "we associate two collections of non - homotopic , non - boundary parallel , simple closed curves @xmath331 and @xmath332 .",
    "these collections should have the propery that @xmath333 is a disjoint union of three - punctures spheres and one - punctured mobius bands , each of the curves @xmath334 intersects at least one of the curves @xmath335 non - trivially , and their union fills the surface @xmath12 ( meaning the collection @xmath336 have minimal number of intersections and @xmath337 is a union of topological disks ) .",
    "let @xmath338 be automorphisms of @xmath315 that correspond to dehn twists along @xmath339 , and @xmath340 be automorphisms of @xmath315 that correspond to dehn twists along @xmath341 .",
    "we define iteratively a basic sequence of automorphisms @xmath342 ( compare with section 7.1 of @xcite where one particular basic sequence of automorphisms is used ) , which is determined by a sequence of of @xmath343-tuples @xmath344    let @xmath345    @xmath346    @xmath347    assuming generic families have already been constructed for @xmath311 , @xmath348 , and for every vertex group in levels @xmath349 , and that @xmath350 is a family of growing powers of dehn twists for edges on level @xmath306 , set @xmath351 for @xmath352 ( in other words the generic family for level @xmath353 is the generic family of the last vertex group at that level ) and set @xmath354 . let @xmath355 the canonical epimorphism .",
    "let @xmath356 be the collection of all compositions of generic solutions for previous vertex groups .",
    "we then say that @xmath357 where each @xmath358 is some positive integer , is a generic family for @xmath315 if it has the following property : given any @xmath9 and any tuple of positive numbers @xmath359 with @xmath360 for @xmath361 , @xmath362 contains a homomorphism @xmath363 such that the tuple    @xmath364    grows faster than @xmath365 in the sense that @xmath366 and @xmath367 .",
    "finally we set @xmath368 to be a generic family of solutions for the @xmath0-ntq system @xmath43 .",
    "notice @xmath369 @xmath1-discriminates @xmath35 .    if @xmath370 is a generic family of solutions for a regular ntq - system @xmath371 , then for any equation @xmath372 the following is true : if for any solution @xmath373 there exists a solution of @xmath374 , then @xmath375 admits a complete @xmath376-lift . if the ntq - system @xmath371 is not regular , then for any equation @xmath372 the following is true : if for any solution @xmath373 there exists a solution of @xmath374 , then @xmath375 admits a complete @xmath376-lift into corrective extensions of @xmath371 ( see @xcite for definition of corrective extension )",
    ". there is a finite number of these extensions and any solution of @xmath371 factors through one of them .",
    "consider the equation @xmath88=[a , b]$ ] over a torsion - free hyperbolic group @xmath1 .",
    "define the following @xmath1-automorphisms of @xmath377=\\gamma*f(x)$ ] : @xmath378 @xmath379 notice that big powers of these automorphisms produce big powers of elements .",
    "let @xmath380 for some positive integer @xmath381 , and define : @xmath382 where @xmath383 .",
    "now take the solution @xmath384 of @xmath88=[a , b]$ ] with @xmath385 and consider the family of mappings @xmath386 where for each @xmath9 , @xmath387 is an infinite set of @xmath9-tuples of large natural numbers .",
    "then @xmath362 is a generic family of solutions in @xmath1 for @xmath88=[a , b]$ ] .    finally , if @xmath388 is maximal @xmath1-limit quotient of @xmath35 ( there is no another @xmath1-limit quotient @xmath389 such that the map sending images of generators of @xmath35 in @xmath389 into their mages in @xmath388 can be extended to a proper homomorphism ) , then since a discriminating family of homomorphisms for @xmath388 factors through some branch @xmath267 of @xmath225 , there is some @xmath284 with @xmath390",
    "each maximal @xmath1-limit quotient is isomorphic to @xmath391 , with @xmath392 irreducible system , so there is a ( canonical ) fundamental sequence , with automorphisms on the top level corresponding to a jsj decomposition of @xmath391 , which factors through a @xmath1-ntq groups @xmath305 ( as in section 7 of @xcite ) .",
    "this gives the canonical embeddings of every @xmath1-limit group @xmath2 into some @xmath1-ntq groups , as mentioned in section [ section : limit - grps ] .",
    "we then define a generic family of homomorphisms for such a @xmath1-limit group @xmath391 to be a generic family for a @xmath1-ntq group @xmath305 into which it embeds canonically in this manner .",
    "the following is a simple but useful observation .",
    "[ gen : factor ] let @xmath47 be a finite system of equations over @xmath1 .",
    "let @xmath388 is the image of the group @xmath35 in a @xmath1-ntq group @xmath305 corresponding to a strict fundamental sequence in @xmath225 .",
    "then a generic family of @xmath1-homomorphisms from @xmath388 to @xmath1 corresponding to the jsj decomposition of h and its images on all levels factors through one of the branches of the solution tree .    by construction of the solution tree for @xmath47",
    ", there is some generic family of solutions for @xmath388 . for this family , at each level of the solution tree , since there is finitely many branchings , some family factoring through at least one must be a generic family as well .",
    "let @xmath1 be a torsion free non - elementary hyperbolic group , @xmath388 a subgroup of @xmath1 given by generators .",
    "we will describe a certain procedure that constructs a group @xmath208 , @xmath393 such that @xmath208 is quasi - convex in @xmath1 and every abelian splitting of @xmath208 induced from a splitting of @xmath1 induces also a splitting of @xmath388 .",
    "we will call this @xmath208 a _ quasi - convex closure of @xmath388_.    if @xmath388 is elliptic in a cyclic splitting of @xmath1 , we consider instead of @xmath1 a vertex group @xmath394 containing a conjugate of @xmath388 .",
    "such a subgroup @xmath394 is quasi - convex and hyperbolic as a vertex group , and the quasi - convexity constants can be found effectively .",
    "then we consider a splitting of @xmath394 , and continue this process until @xmath388 is not elliptic in any decomposition of the corresponding vertex group @xmath395",
    ". then we extend @xmath388 to the corresponding conjugate @xmath208 of @xmath395 .",
    "this subgroup @xmath208 is a _ quasi - convex closure of @xmath388_. hierarchical accessibility for hyperbolic groups is proved in @xcite .",
    "notice that @xmath208 is relatively quasi - convex , therefore hyperbolic .",
    "in section [ section : sol - tree ] we constructed the tree of strict fundamental sequences ( or a @xmath396-diagram ) encoding all solutions of a finite system @xmath47 of equations over @xmath1 using the tree of fundamental sequences for `` covering '' systems of equations over @xmath8 .",
    "canonical @xmath396-diagram _ that encodes all the homomorphisms from @xmath37 into @xmath1 has some additional properties .",
    "it is a tree of canonical strict fundamental sequences ( in @xcite , section 7.6 , a similar tree was called the ( augmented ) canonical embedding tree @xmath397 ) , and corresponding ntq systems .",
    "all the homomorphisms from @xmath37 into @xmath1 factor through a finite number of @xmath1-limit quotients in all @xmath396-diagrams .",
    "homomorphisms from these limit quotients to @xmath1 in a canonical @xmath396-diagram are given by compositions of canonical automorphisms corresponding to a jsj decomposition of ( the free factors of ) @xmath1-limit groups in the vertices of the tree with the canonical homomorphisms from the @xmath1-limit groups into their maximal standard ( proper ) @xmath1-limit quotients , and at the end with either a fixed embedding of a @xmath1-limit group in the diagram into conjugates of @xmath1 , or substitutions of the terminal free groups that appear in the diagram into @xmath1 .",
    "the existence of such a diagram can be proved similarly to a free group case , and it is proved in @xcite . this diagram is not necessary unique because the jsj decompositions involved are not unique .    for each branch of this tree @xmath398 where @xmath399 are freely indecomposable conjugates of subgroups of @xmath1",
    "there is a strict fundamental sequence assigned .",
    "we assign an ntq system to this branch as follows .",
    "let @xmath400 be an abelian jsj decomposition of @xmath401 .",
    "for each edge @xmath219 between two rigid subgroups we extend the centralizer of the image of the edge group in @xmath95 by a new letter .",
    "then the fundamental group of the subgraph of groups generated by the rigid subgroups in @xmath400 will be embedded into this iterated centralizer extension @xmath402 of @xmath403 .",
    "we also attach abelian and qh subgroups of @xmath400 to @xmath402 and obtain the new group @xmath404 such that @xmath401 is embedded into @xmath404 . applying the same construction to @xmath405 etc .",
    ", we construct iteratively a new group @xmath406 , which is almost ntq ( except that @xmath95 is not necessarily a hyperbolic group ) and contains @xmath407 as a subgroup .",
    "we now extend each subgroup @xmath408 by its quasi - convex closure @xmath409 .",
    "denote the obtained group by @xmath305 .",
    "this group @xmath305 is ntq and total relatively hyperbolic .",
    "each @xmath409 is freely indecomposable .",
    "the set of all ntq groups corresponding to the canonical @xmath396-diagram is _ a complete set of canonical ntq groups_.    theorem 2 states that for a finite system of equations over @xmath1 , @xmath38 there is an algorithm to construct a complete set of canonical ntq groups ( and systems ) for @xmath39",
    "we now begin proving our second main result . the proof is based on the observation that those branches of the tree @xmath410 that contain generic families of homomorphisms for maximal @xmath1-limit quotients of @xmath37 , actually , correspond to ( almost ) canonical ntq systems .    on the set of @xmath1-limit groups @xmath411 , where @xmath412 is the ntq group corresponding to a branch of @xmath410 , we define a partial order as follows . for given elements",
    "@xmath413 we say that @xmath414 if every canonical map @xmath415 can be split as @xmath416 , where @xmath417 and @xmath384 is a @xmath1-epimorphism from @xmath408 onto @xmath418 .",
    "( @xmath408 is embedded into @xmath412 that contains @xmath1 , this embedding defines some conjugates of subgroups of @xmath1 that are subgroups of @xmath408 , therefore these subgroups should be mapped by @xmath384 into conjugates of subgroups of @xmath1 . )",
    "let @xmath420 generate @xmath35 , and for each branch @xmath267 in @xmath225 , let @xmath421 be the images of the homomorphisms into the corresponding @xmath1-ntq groups .",
    "we proceed by considering the finite collection @xmath422 , and the finite collection of pairs @xmath423 .",
    "we test each pair @xmath424 to see if the map @xmath425 defined by @xmath426 extends to a homomorphism sending conjugates of subgroups of @xmath1 to conjugates of subgroups of @xmath1 , in which case @xmath427 is a quotient of @xmath389 . if @xmath427 is a quotient of @xmath389 , then @xmath427 is a maximal @xmath1-limit group if and only if @xmath389 is a maximal @xmath1-limit quotient isomorphic to @xmath427 .",
    "so if @xmath321 extends to such a homomorphism we may remove @xmath427 from the collection @xmath422 , and all pairs @xmath428 from the collection @xmath423 , without losing any ( equivalence class ) of maximal @xmath1-limit group .",
    "we will show that every @xmath429 which is not a maximal @xmath1-limit group will be removed , and so we are left with only a collection of maximal @xmath1-limit quotients of @xmath35 .",
    "first we describe an algorithm which tests a pair @xmath424 .",
    "let @xmath430 , @xmath431 , and @xmath432 , @xmath433 , be @xmath1-ntq systems such that @xmath434 and @xmath435 .",
    "there are words @xmath436 and @xmath437 for @xmath73 .",
    "let variables @xmath438 correspond to conjugating elements @xmath439 .",
    "then if the following first order formula is true in @xmath1 , @xmath321 must extend to a homomorphism sending conjugates of subgroups of @xmath1 to conjugates of subgroups of @xmath1 : @xmath440 @xmath441 +   + in other words , for each @xmath1-homomorphism @xmath442 there is a @xmath1-homomorphism @xmath443 such that @xmath444 ( here @xmath445 and @xmath446 are restricted to @xmath427 and @xmath389 .",
    "denote the above formula in @xmath1 , as constructed from the pair @xmath447 , by @xmath448 .",
    "we now describe an algorithm to test if @xmath448 is true .",
    "every conjunction of equations is equivalent to some single equation , so let @xmath449 be an equation equivalent to + @xmath450    by theorem 2.3 in @xcite ( this is the torsion - free hyperbolic analogue of the paramaterization theorem for free groups in @xcite ) , @xmath448 is true in @xmath1 if and only if the corresponding equation @xmath451 ( with @xmath452 considered as coefficients in @xmath453 ) has a solution in @xmath453 , where @xmath453 belongs to the ( canonical ) set of corrective extensions of @xmath454 ( see @xcite for precise definition ) . to obtain each corrective extension , for some abelian vertex groups @xmath33 of @xmath454 ,",
    "abelian groups @xmath455 with @xmath456 are constructed exactly by adding particular roots to each @xmath33 .",
    "however , the paramaterization theorem does not directly imply what those particular roots are . to find which roots to add , and construct the corrective extensions and check them for solutions , we use dahmani s construction ( @xcite ) of canonical representatives for elements in @xmath454 ( since it is toral relatively hyperbolic with parabolic subgroups given by the abelian vertex groups @xmath457 of the ntq structure ) in the free product @xmath458 ( theorem 4.4 in @xcite ) .",
    "these canonical representatives give a disjunction of equations @xmath459 , which is equivalent to a single equation @xmath460 , over @xmath458 .",
    "solutions for @xmath451 exist in @xmath454 if and only if solutions for @xmath460 exist in @xmath458 .",
    "canonical representives also exist for @xmath453 ( toral relatively hyperbolic as well ) , and using those , the equation @xmath451 over @xmath453 ( with @xmath452 considered as coefficients in @xmath453 ) induces the same equation @xmath460 over a free product @xmath461 with the same roots added to the same abelian subgroups .",
    "this is because dahmani s construction of canonical representatives , applied to equivalent systems of triangular equations , give new equations corresponding to the `` middles '' of the triangles which , if the middles are `` short '' ( as in hyperbolic case ) , are determined by @xmath451 , and if the middles belong to parabolic subgroups , are just commuting equations .",
    "so similarly , solutions for @xmath451 exist in @xmath453 if and only if solutions for @xmath460 exist in @xmath461 .",
    "it is these free product extensions which can be found and checked algorithmically , since solving equations in @xmath462 is just solving equations in each factor , and in the abelian factors , conventional linear algebraic methods of finding solutions determine the finite index extensions ( by giving which roots of elements are needed for solutions ) . then checking for a solution in @xmath461 is just checking in @xmath8 , which can be done algorithmically by @xcite .",
    "we now show that every non - maximal @xmath1-limit quotient is removed .",
    "if @xmath389 is not a maximal @xmath1-limit quotient , then there exists a @xmath1-ntq group @xmath463 such that @xmath464 and @xmath465 .",
    "so @xmath389 is then removed from the collection @xmath422 , and the proposition is proved .",
    "a.   finds all maximal ( with respect to the order defined above ) @xmath1-limit quotients of @xmath35 , each given as the image @xmath408 of a homomorphism @xmath466 , where @xmath412 is a @xmath1-ntq group . b.",
    "if @xmath388 is a maximal quotient , finds the grushko decomposition of @xmath388 .",
    "the first statement follows from the previous proposition .",
    "we show how to construct a free decomposition of the image @xmath388 of @xmath284 , for each strict fundamental sequence @xmath268 .",
    "if @xmath388 is a free product then there is a solution of the system @xmath47 in @xmath467 .",
    "therefore we can solve the corresponding systems induced by canonical representatives of elements from @xmath467 in the group @xmath468 .",
    "then we will see the free product decomposition of the corresponding ntq group over @xmath467 ( since generators of each copy of @xmath1 do not interact in the ntq structure).the same ntq group can be considered as an ntq group over @xmath1 if instead of the second copy of @xmath1 we take @xmath1 conjugated by a new element . since @xmath388 is a maximal @xmath1-limit quotient , the ntq group corresponding to @xmath388 must be freely decomposable , and we will obtain the induced free product decomposition of @xmath388 ( given by generators in the free factors of the ntq group ) .    [ maxx ] suppose a branch @xmath267 of the tree @xmath410 contains a generic family of homomorphisms for a canonical ntq group @xmath305 of a maximal @xmath1-limit quotient @xmath388 of @xmath37 . then the ntq group @xmath283 corresponding to the branch @xmath267 is a free product of ntq groups such that one of these ntq groups @xmath469 differs from @xmath305 as follows :    1 .",
    "the graphs ( in graph of groups decomposition ) corresponding to different levels of @xmath469 are the same as the graphs corresponding to different levels of @xmath305 .",
    "mqh subgroups corresponding to qh vertices on corresponding levels of @xmath469 and @xmath305 are the same .",
    "abelian vertex groups of @xmath305 are direct summands of corresponding abelian vertex groups of @xmath469 .",
    "terminal conjugates of subgroups of @xmath1 in @xmath305 are subgroups of corresponding conjugates of subgroups of @xmath1 in @xmath469 .",
    "since we know how to obtain a free decomposition of @xmath388 , we can suppose now that @xmath388 is freely indecomposable . by ( @xcite , theorem 1.22 ) ( that is an analogue of the parameterization theorem @xcite ) ,",
    "there is a homomorphism from @xmath469 to a corrective extension @xmath470 of @xmath305 that is a retract of @xmath305 .",
    "@xmath470 is obtained from @xmath305 by extending some abelian vertex groups @xmath26 to abelian vertex over - groups @xmath196 such that @xmath26 has finite index in @xmath196 .",
    "( lemma 2.13 in @xcite ) if @xmath471 is a qh - subgroup of @xmath0 and @xmath472 , and not conjugate into the fundamental group of the graph of groups obtained by removing @xmath471 , then either @xmath473 has finite index in @xmath471 and is a qh subgroup of @xmath388 or @xmath388 is a non - trivial free product .",
    "therefore for each mqh subgroup @xmath471 of @xmath469 , the intersection @xmath474 is a finite index subgroup of @xmath471 , and there is a retract from @xmath471 to @xmath474 .",
    "this implies that @xmath475 .",
    "going inductively from the top to the bottom and using the fact that all fundamental sequences under consideration are strict , we prove statements 1 , 2 , 3 for all levels of @xmath305 and @xmath469 .",
    "statement 4 follows automatically .",
    "recall that every maximal @xmath1-limit quotient of @xmath35 is isomorphic to the image of at least one homomorphisms @xmath284 , corresponding to a strict fundamental sequence in @xmath225 , with notation as in section [ subsection : gen - fam ] .",
    "[ jsj ] suppose @xmath389 is a quotient of @xmath37 in @xmath476 , and the splitting of @xmath389 induced from the top level of @xmath476 is not a jsj decomposition",
    ". then there exists @xmath477 such that @xmath478 and @xmath477 is a quotient of @xmath37 in @xmath463 .    a generic family for @xmath389 ( mapping subgroups of @xmath1 in the decomposition of @xmath389 into conjugated of themselves ) factors through a strict fundamental sequence corresponding to some @xmath479 let @xmath477 be the image of @xmath480 in @xmath463 .",
    "then the subgroups @xmath481 participating in the construction of @xmath477 from proposition 3 have the property that , for any homomorphism @xmath482 , they are mapped into conjugates of themselves .",
    "since this is true for every solution from a generic family for @xmath389 factoring through @xmath463 , these subgroups @xmath483 must be conjugate into conjugates of subgroups of @xmath1 that are used in the construction of @xmath389 .",
    "then by theorem 2.3 in @xcite , there is a homomorphism @xmath484 from @xmath463 to a corrective extension of @xmath389 , mapping images of the generators of @xmath37 into images of the generators and mapping @xmath483 into conjugates of subgroups of @xmath1 .",
    "the restriction of @xmath484 on @xmath477 is a homomorphism from @xmath477 to @xmath389 .",
    "after we found all maximal @xmath1-limit quotients @xmath485 we have to find canonical fundamental sequences and ntq groups associated with them .",
    "we know that they have to have properties mentioned in proposition [ maxx ] .",
    "therefore we have to find their abelian vertex groups and their bottom level .",
    "the notion of the induced fundamental sequence and ntq system was introduced in section 7.12 , @xcite and in @xcite .",
    "we wish to construct the induced fundamental sequence for the maximal @xmath1-limit quotient @xmath388 in its ntq group @xmath305 .",
    "we also suppose that a generic family of homomorphisms for @xmath388 factors through @xmath305 . in this case we do not need to apply the whole procedure for the construction of the induced fundamental sequence because mqh subgroups of a canonical ntq group for @xmath388 are the same as the mqh groups for @xmath305 .",
    "[ construct : decomp ] let @xmath388 be the image of the group @xmath35 , where @xmath47 is a finite system of equations over @xmath1 , in a @xmath1-ntq group @xmath305 corresponding to a strict fundamental sequence in @xmath225 .",
    "suppose also that @xmath388 is a maximal @xmath1-limit quotient of @xmath35 .",
    "there is an algorithm to construct an induced ntq system for @xmath388 .    in the proof of proposition 4",
    "we described how to see if @xmath388 is a free product .",
    "therefore we can suppose further that @xmath388 is freely indecomposable .",
    "let @xmath486 be the @xmath8-ntq group from which @xmath305 is formed , as in @xcite .",
    "at the top level of @xmath486 ( corresponding to the equation @xmath487 of the ntq system @xmath487 , there is the pre - image ( with respect to the homomorphism from @xmath486 to @xmath305 corresponding to the homomorphism from @xmath8 to @xmath1 ) of @xmath388 .",
    "the whole pre - image is not finitely generated .",
    "we will construct a finitely generated freely indecomposable pre - image @xmath488 .",
    "first , notice that the full pre - image should have non - trivial intersection with some conjugate of each vertex group on each level of @xmath486 and corresponding conjugates of edge groups that are not mapped to the identity , because @xmath388 has non - trivial intersection with their images .",
    "we begin with elements @xmath489 and will keep adding conjugates of the relations of @xmath1 until we obtain a pre - image with the property that it is freely indecomposable and has non - trivial intersection with some conjugate of each vertex group and corresponding conjugates of edge groups that are not mapped to the identity .",
    "denote it by @xmath490 .",
    "we now consider the decomposition of @xmath491 where qh and abelian vertex groups correspond to the top level of @xmath486 , and the coordinate group corresponding to all the other levels below is a free product of rigid subgroups ( maybe just one rigid subgroup ) . by bass - serre theory ( see , for example , @xcite ) , this decomposition induces ( by intersecting @xmath488 with conjugates of vertex and edge groups ) a splitting @xmath492 of @xmath488 . extending the centralizers of all the edges between rigid subgroups of @xmath493 by elements from abelian subgroups mapped to the identity on the next level , we obtain a decomposition where there is no edges between rigid subgroups .",
    "we do this on all the levels of @xmath305 and obtain an ntq group @xmath476 . through the reworking process , we obtain a @xmath1-ntq group from @xmath476 .",
    "this group can be taken as the induced ntq group for @xmath388 .",
    "canonical fundamental sequences for @xmath388 factor through the family of induced ntq groups found in proposition [ construct : decomp ] .",
    "this family satisfies the properties of canonical ntq groups .",
    "we have to consider separately those fundamental sequences for @xmath491 that are not strict , but they factor through a finite number of proper quotients of @xmath491 , and these proper quotients are finitely presented and can be algorithmically constructed ( because there is a finite number of ways for a fundamental sequence to be not strict .",
    "theorem 2 is proved .",
    "99 g. baumslag , a. myasnikov , and v. remeslennikov .",
    "_ algebraic geometry over groups .",
    "i. algebraic sets and ideal theory_. j. algebra , 219(1):1679 , 1999 . b. bowditch .",
    "_ relatively hyperbolic groups_. preprint , 1999 . m. casals - ruiz , i. kazachkov . _",
    "real cubings and graph towers_. arxiv:1110.0174 . c. champetier , v. guirardel . _ limit groups as limits of free groups_. israel j. math . , 146:175 , 2005 .",
    "combinatorial group theory : a topological approach_. cambridge univ .",
    "press , 1989 .",
    "f. dahmani .",
    "_ existential questions in ( relatively ) hyperbolic groups_. israel j. math .",
    ", 173:91124 , 2009 . f. dahmani , d. groves . _ the isomorphism problem for toral relatively hyperbolic groups_. publ . math .",
    "hautes etudes sci .",
    ", ( 107):211290 , 2008 .    c. drutu , m. sapir .",
    "_ relatively hyperbolic groups with rapid decay property _ , int . math .",
    "res . not .",
    "( 2005 ) 11811194 .",
    "_ relatively hyperbolic groups_. geom .",
    ", 8(5):810840 , 1998 . k. fujiwara , p. papasoglu .",
    "_ jsj decompositions of finitely presented groups and complexes of groups _ ,",
    "funct . anal .",
    "16 , no 1 ( 2006 ) , 70 - 125 .",
    "r. grigorchuk , _ degrees of growth of finitely generated groups and the theory of invariant means_. math .",
    "25:2 , 259 - 300 , 1985 ( russian original : izv .",
    "akad nauk .",
    "sssr ser . mat .",
    "48 , no.5 , 939 - 985 , 1984 ) .",
    "m. gromov .",
    "_ hyperbolic groups _ , from : `` essays in group theory '' , math .",
    "publ . 8 , springer , new york ( 1987 ) 75263 d. groves . _ limit groups for relatively hyperbolic groups , i. the basic tools_. algebr .",
    ", 9(3 ) ( 2009 ) , 1423 - 1466 .",
    "d. groves . _ limit groups for relatively hyperbolic groups .",
    "ii . makanin- razborov diagrams_. geom .",
    ", 9:23192358 , 2005 .",
    "d. groves , h. wilton .",
    "_ conjugacy classes of solutions to equations and inequations over hyperbolic groups_. j. topology ( 2010 ) 3 ( 2 ) : 311 - 332 .",
    "v. guirardel , g.levitt .",
    "_ jsj decompositions : definitions , existence and uniqueness .",
    "i : the jsj deformation space_. arxiv:0911.3173 , 2009 .",
    "w. jaco , p. shalen , _ seifert fibered spaces in 3-manifolds_. mem .",
    "( 1979 ) , no . 220 .",
    "k. johannson , _ homotopy equivalences of 3-manifolds with boundaries_. lecture notes in mathematics , 761 .",
    "springer , berlin , 1979 .",
    "o. kharlampovich , j. macdonald .",
    "_ effective embedding of residually hyper- bolic groups into direct products of extensions of centralizers_. accepted to j. of group theory , february 2013 .",
    "preprint at arxiv:1202.3835v1 .",
    "o. kharlampovich , a. myasnikov .",
    "_ effective jsj decompositions_. in groups , languages , algorithms , volume 378 of contemp .",
    ", pages 87 212 .",
    "soc . , 2005 .",
    "o. kharlampovich , a. myasnikov .",
    "_ elementary theory of free non - abelian groups_. journal of algebra , 2006 , volume 302 , issue 2 , p. 451 - 552",
    ".        l. louder .",
    "_ krull dimension for limit groups iv : adjoining roots_. arxiv:0812.1816 , dec 2008 .",
    "l. louder , n. touikan , strong accessibility for finitely presented groups , arxiv:1302.5451 .",
    "lyndon , p.e .",
    "schupp . _ combinatorial group theory_. ergebnisse der mathematik und ihrer grenzgebiete , band 89 .",
    "springer - verlag , berlin - new york , 1977 .",
    "g. makanin , _ decidability of universal and positive theories of a free group_. ( english translation ) mathematics of the ussr - izvestiya 25 ( 1985 ) , 7588 ; original : izvestiya akademii nauk sssr , seriya matematicheskaya 48 ( 1984 ) , 735749",
    ".        e. rips , z. sela . _ canonical representatives and equations in hyperbolic groups_. invent . math .",
    ", 120(3):489512 , 1995 .",
    "e. rips and z. sela .",
    "_ cyclic splittings of finitely presented groups and the canonical jsj decomposition_. ann . of math .",
    "( 2 ) , 146(1):53109 , 1997 .",
    "p. scott , t. wall .",
    "_ topological methods in group theory _ in homological group theory ( proc .",
    "sympos . , durham , 1977) , pp . 137203 , london mathematical society lecture notes series , vol .",
    "36 , cambridge university press , cambridge - new york , 1979 .",
    "_ diophantine geometry over groups vi . the elementary theory of a free group_. geom .",
    ", 16(3):707730 , 2006 . z. sela .",
    "_ diophantine geometry over groups vii .",
    "the elementary theory of a hyperbolic group_. proc .",
    "( 3 ) , 99(1):217273 , 2009 .",
    "_ diophantine geometry over groups ii_,completions , closures and formal solutions .",
    "israel j. math . 134",
    "( 2003 ) , 173254 ."
  ],
  "abstract_text": [
    "<S> we show that , given a finitely generated group @xmath0 as the coordinate group of a finite system of equations over a torsion - free hyperbolic group @xmath1 , there is an algorithm which constructs a canonical solution diagram . </S>",
    "<S> additionally , we show that a group is a @xmath1-limit group if and only if it is an iterated generalized double over @xmath1 . </S>"
  ]
}