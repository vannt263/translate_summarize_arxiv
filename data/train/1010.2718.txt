{
  "article_text": [
    "we consider the heart of a living organism that occupies a fixed domain @xmath0 , which is assumed to be a bounded open subset of @xmath1 with lipschitz boundary @xmath2 . a prototype model for the cardiac electrical activity",
    "is the following nonlinear reaction - diffusion system @xmath3= { i_{\\mathrm{app } } } , \\qquad ( t , x)\\in q,\\\\          & \\pt v + \\div \\left({\\ensuremath{\\mathbf{m}}}_e(x){\\mathrm{\\nabla}}u_e\\right )          + h[v]={i_{\\mathrm{app } } } ,          \\qquad ( t , x)\\in q ,      \\end{split }      \\right.\\ ] ] where @xmath4 denotes the time - space cylinder @xmath5 .    this model , called the bidomain model , was first proposed in the late 1970s by tung @xcite and is now the generally accepted model of electrical behaviour of cardiac tissue ( see henriquez @xcite , keener and sneyd @xcite ) .",
    "the functions @xmath6 and @xmath7 represent the _ intracellular _ and _ extracellular _ electrical potentials , respectively , at time @xmath8 and location @xmath9 .",
    "the difference @xmath10 is known as the _ transmembrane _ potential .",
    "the conductivity properties of the two media are modelled by anisotropic , heterogeneous tensors @xmath11 and @xmath12 .",
    "the surface capacitance of the membrane is usually represented by a positive constant @xmath13 ; upon rescaling , we can assume @xmath14 .",
    "the stimulation currents applied to the intra- and extracellular spaces are represented by an @xmath15 function @xmath16 .",
    "finally , the _ transmembrane ionic current _",
    "$ ] is computed from the potential @xmath18 .",
    "the system is closed by choosing a relation that links @xmath17 $ ] to @xmath18 and specifying appropriate initial - boundary conditions .",
    "we stress that realistic models include a system of odes for computing the ionic current as a function of the transmembrane potential and a series of additional `` gating variables '' aiming to model the ionic transfer across the cell membrane ( see , e.g. , @xcite ) .",
    "this makes the relation @xmath19 $ ] non - local in time .",
    "herein we focus on the issue of discretisation in space of the bidomain model .",
    "the presence of the odes , some of them being quite stiff , greatly complicates the issue of discretisation in time .",
    "it also results in a huge gap between theoretical convergence results and the practical computation of a reliable solution .",
    "we surmise that the precise form of the relations that link @xmath17 $ ] to @xmath18 is not essential for the validation of the space discretisation techniques . therefore , as in @xcite",
    ", we study under the greatly simplifying assumption that the ionic current is represented locally , in time and space , by a nonlinear function @xmath20 .",
    "however , such a simplification allows to mimic , to a certain extent , the depolarisation sequence in the cardiac tissue , taking the ionic current term @xmath17 $ ] to be a cubic polynomial ( bistable equation ) ; this choice models the fast inward sodium current that initiates depolarisation ( cf .",
    ", e.g. , @xcite ) .    in the context of electro - cardiology",
    "the relevant boundary condition would be a neumann condition for the fluxes associated with the intra- and extracellular electrical potentials : @xmath21 it serves to couple the heart electrical activity with the much weaker electrical phenomena taking place in the torso .",
    "the simplest case is the one of the isolated heart , namely @xmath22 .",
    "for the mathematical study we are heading to , we consider rather general mixed dirichlet - neumann boundary conditions of the form @xmath23 where @xmath24 is partitioned into sufficiently regular parts @xmath25 and @xmath26 , and @xmath27 denotes the @xmath28-a.e .",
    "defined exterior unit normal vector to the neumann part @xmath25 of the boundary @xmath29 . to keep the analysis simple ,",
    "let us assume that @xmath30 ; for @xmath31 , we assume @xmath32 ( in fact , we consider @xmath31 extended to @xmath33 functions ) .    regarding the initial data , we prescribe only the transmembrane potential : @xmath34    clearly , and are invariant under the simultaneous change of @xmath35 into @xmath36 , @xmath37 .",
    "in the case @xmath38 , @xmath39 , also is invariant under this change ; therefore , for the sake of being definite , we normalise @xmath40 by assuming @xmath41 it is easy to see that the existence of solutions to , requires the compatibility condition @xmath42    notice that the diffusion operators @xmath43 in are linear in the gradient @xmath44 , heterogeneous & anisotropic , and time - independent ; these assumptions seem to be sufficiently general to capture the phenomena of the electrical activity in the heart .",
    "more general models with time - dependent and nonlinear in @xmath45 diffusion of the leray - lions type were studied in @xcite .",
    "here we assume that @xmath46 is a family of symmetric matrices , uniformly bounded and positive definite : @xmath47 in particular , we have @xmath48 .",
    "now let us describe in detail the ionic current function @xmath49 .",
    "we assume that @xmath50 is a continuous function , and that there exist @xmath51 and constants @xmath52 such that @xmath53 @xmath54 for the later use , we set @xmath55 it is rather natural , although not necessary , to require in addition that @xmath56 according to @xcite , the most appropriate value is @xmath57 , which means that the non - linearity @xmath58 is of cubic growth at infinity .",
    "assumptions , are automatically satisfied by any cubic polynomial @xmath58 with positive leading coefficient .    a number of works have been devoted to the theoretical and numerical study of the above bidomain model .",
    "colli franzone and savar @xcite prove the existence of weak solutions for the model with an ionic current term driven by a single ode , by applying the theory of evolution variational inequalities in hilbert spaces .",
    "sanfelici @xcite considered the same approach to prove the convergence of galerkin approximations for the bidomain model .",
    "veneroni in @xcite extended this technique to prove existence and uniqueness results for more sophisticated ionic models .",
    "bourgault , coudire and pierre @xcite prove existence and uniqueness results for the bidomain equations , including the fitzhugh - nagumo and aliev - panfilov models , by applying a semigroup approach and also by using the faedo  galerkin method and compactness techniques .",
    "recently , bendahmane and karlsen @xcite proved the existence and uniqueness for a nonlinear version of the simplified bidomain equations by using a uniformly parabolic regularisation of the system and the faedo  galerkin method .",
    "regarding finite volume ( fv ) schemes for cardiac problems , a first approach is given in harrild and henriquez @xcite .",
    "coudire and pierre @xcite prove convergence of an implicit fv approximation to the monodomain equations .",
    "we mention also the work of coudire , pierre and turpault @xcite on the well - posedness and testing of the ddfv method for the bidomain model .",
    "bendahmane and karlsen @xcite analyse a fv method for the bidomain model with dirichlet boundary conditions , supplying various existence , uniqueness and convergence results .",
    "finally , bendahmane , brger and ruiz @xcite analyse a parabolic - elliptic system with neumann boundary conditions , adapting the approach in @xcite ; they also provide numerical experiments .    in this paper , as in @xcite",
    ", we use a finite volume approach for the space discretisation of and the backward euler scheme in time . due to a different choice of the finite volume discretisation",
    ", we drop the restrictions on the mesh and on the isotropic and homogeneous structure of the tensors @xmath59 imposed in @xcite .",
    "we also consider general boundary conditions .",
    "the space discretisation strategy we use is essentially the one described and implemented by pierre @xcite and coudire et al .",
    "more precisely , we utilise different types of ddfv discretisations of the 3d diffusion operator ; in addition to the scheme of @xcite , we examine the schemes described in @xcite ( see also @xcite ) and @xcite .",
    "it should be noticed that @xmath60 bidomain simulations on slices of the @xmath61 heart are also of interest .",
    "the standard 2d ddfv construction can be applied to problem , , on 2d polygonal domains ; the 3d convergence results readily extend to the 2d case .",
    "the ddfv approximations were designed specifically for anisotropic and/or nonlinear diffusion problems , and they work on rather general ( eventually , distorted , non - conformal and locally refined ) meshes .",
    "we refer to hermeline @xcite , domelevo and omns @xcite , delcourte , domelevo and omns @xcite , andreianov , boyer and hubert @xcite , and herbin and hubert @xcite for background information on ddfv methods .",
    "most of these works treat 2d linear anisotropic , heterogeneous diffusion problems , while the case of discontinuous diffusion operators have been treated by boyer and hubert in @xcite .",
    "hermeline @xcite treats the analogous 3d problems , @xcite treats the stokes problem , and the work @xcite is devoted to the nonlinear leray - lions framework",
    ".    a number of numerical simulations of the full bidomain system ( the pde for @xmath35 plus odes for @xmath17 $ ] ) coupled with the torso can be found in @xcite .",
    "our study can be considered as a theoretical and numerical validation of the ddfv discretisation strategy for the bidomain model . for both a fully time - implicit scheme and a linearised time - implicit scheme ,",
    "we prove convergence of different ddfv discretisations to the unique solution of the bidomain model .",
    "then numerical experiments are reported to document some of the features of the ddfv space discretisations .",
    "a rescaled version of model , together with a cubic shape for @xmath62 $ ] , is used to simulate the propagation of excitation potential waves in an anisotropic medium . in our tests , we combine 2d and 3d ddfv schemes for the diffusion terms with fully explicit discretisation of the ionic current term ; thus numerical experiments validate this scheme , although we were not able to justify its convergence theoretically .",
    "convergence of the numerical solutions towards the continuous one is measured in three different ways : the first two ones are aimed at physiological applications ( convergence for the activation time and for the propagation velocity ) , whereas the third one corresponds to the norm used in theorem  [ th : convergence ] .",
    "implementation is detailed .",
    "due to a large number of unknowns and a relatively large stencil of the 3d ddfv schemes , a careful preconditioning is needed for the bidomain system matrix that has to be inverted at each time step .",
    "the preconditioning strategy we adopted here is developed in @xcite : it provides an almost linear complexity with respect to the matrix size for the system matrix inversion .",
    "the preconditioning combines the idea of hierarchical matrices decomposition @xcite with heuristics referred to as the _ monodomain _ approximation @xcite .",
    "the remaining part of this paper is organised as follows : in section [ sec : theory - wellposedness ] we give the definition of a weak solution to , , .",
    "moreover , we recast the problem into a variational form , from which we deduce an existence and uniqueness result . in section [ sec : ddfv ] we describe one of the 3d ddfv schemes , while in section [ sec : scheme - and - results ] we formulate two  backward euler in time \" &  ddfv in space \" finite volume schemes , and state the main convergence results .",
    "the proofs of these results are postponed to section [ sec : convergenceproof ] ; their basis being section [ sec : discretecalculus ] , where we recall some mathematical tools for studying ddfv schemes . finally , section [ sec : numerics ] is devoted to numerical examples .",
    "we introduce the space @xmath63 in the case @xmath39 , we also use the quotient space @xmath64 . the dual of @xmath65",
    "is denoted by @xmath66 , with a corresponding duality pairing @xmath67 .",
    "we assume that the dirichlet data @xmath31 in are sufficiently regular , so that @xmath68 ( we keep the same notation for the functions @xmath31 and their traces ) .",
    "for the sake of simplicity , we assume that @xmath69 finally , we require that @xmath70    [ def : weak - sol ] a weak solution to problem , , is a triple of functions @xmath71 and such that , , are satisfied in @xmath72 . in the case",
    "@xmath39 , we normalise @xmath73 by requiring .",
    "[ rem : al - def]it is not difficult to show that definition  [ def : weak - sol ] is equivalent to a `` variational '' formulation of problem , , , in the spirit of alt and luckhaus @xcite . indeed ,",
    "a triple @xmath74 satisfying is a weak solution of problem , , if and only if , , are satisfied in the space @xmath75 .",
    "this means precisely that the distributional derivative @xmath76 can be identified with an element of @xmath75 , and with this identification there holds @xmath77 for all @xmath78 , and @xmath79 for all @xmath80 such that @xmath81 and @xmath82 .",
    "we have the following chain rule :    [ lem : chain - rule ] assume that @xmath83 and @xmath84 .",
    "then @xmath85    this type of result is well known ; for example , it can be proved along the lines of alt and luckhaus @xcite and otto @xcite ( see also @xcite and ( * ? ? ?",
    "* theorme ii.5.11 ) ) .",
    "the following lemma is a technical tool adapted to the weak formulation of definition  [ def : weak - sol ] .",
    "[ lem : regularisation ] let @xmath86 be a lipschitz domain . there exists a family of linear operators @xmath87 from @xmath88 into @xmath89 such that + - for all @xmath90 , @xmath91 converges to @xmath92 in @xmath88 ; + - for all @xmath93 , @xmath91 converges to @xmath92 in @xmath94 .",
    "let us stress that the linearity of @xmath95 is essential for the application of this lemma .",
    "it is used to regularise @xmath35 , so that one can take @xmath96 as test functions in ; for example , a priori estimates for weak solutions and uniform bounds on their galerkin approximations will be obtained in this way .",
    "in addition , a straightforward application of the lemma is the following uniqueness result :    [ theo : l^2-contraction ] assume and .",
    "then there exists a unique weak solution @xmath74 to problem , , .",
    "moreover , if @xmath97 is another weak solution of problem , , corresponding to the initial function @xmath98 , then @xmath99 in addition , if holds then @xmath18 depends continuously in @xmath94 on @xmath100 in @xmath101 .",
    "continuous dependence of the solution on @xmath102 , @xmath103 , @xmath31 can be shown with the same technique , using in addition the cauchy - schwarz inequality on @xmath104 and the trace inequalities for @xmath105 functions .",
    "let @xmath106 , @xmath107 .",
    "we take @xmath108 as test function in the first equation of , and @xmath109 in the second equation of .",
    "we subtract the resulting equations and apply the chain rule of lemma  [ lem : chain - rule ] ; using the linearity of @xmath95 and the other properties listed in lemma  [ lem : regularisation ] , and subsequently sending @xmath110 , we finally arrive at @xmath111 for a.e .",
    "@xmath112 , we let @xmath113 converge to the characteristic function of @xmath114 $ ] .",
    "thanks to the monotonicity assumption on @xmath115 , we deduce @xmath116 by the gronwall inequality , the @xmath117 continuous dependence property stated in the theorem follows .    next , if holds , from the hlder inequality and the evident estimate @xmath118 we infer that @xmath119 goes to zero as @xmath120 tends to zero .    finally , if @xmath121 , not only do we have @xmath122 , but also @xmath123 because of the strict positivity of @xmath124 and the boundary / normalisation condition in @xmath125 .",
    "it remains to prove the regularisation result .    for simplicity",
    "we consider separately the two basic cases .",
    "+ @xmath126 pure dirichlet bc case . + extend @xmath92 by zero for @xmath127 .",
    "take a standard family of mollifiers @xmath128 on @xmath129 supported in the ball of radius @xmath130 centred at the origin .",
    "introduce the set @xmath131 .",
    "take @xmath132 such that @xmath133 , @xmath134 in @xmath135 , @xmath136 , and @xmath137 .",
    "define @xmath138 by construction , @xmath139 maps @xmath140 to @xmath141 . from standard properties of mollifiers and",
    "the absolute continuity of the lebesgue integral , one easily deduces that if @xmath142 , then @xmath143 converges to @xmath92 in @xmath94 as @xmath110 .",
    "next , consider @xmath144 .",
    "we have @xmath145 , and thus @xmath146 in @xmath15 as above .",
    "in particular , @xmath147 is bounded in @xmath15 .",
    "similarly , @xmath148 is bounded in @xmath15 and converges to @xmath149 in @xmath15 .",
    "since @xmath150 it remains to show that @xmath151 converges to zero in @xmath15 as @xmath110 . by standard properties of mollifiers , it is sufficient to prove that @xmath152 in @xmath153 as @xmath110 , which follows from an appropriate version of the poincar inequality .",
    "indeed , in the case @xmath154 is lipschitz regular , we can fix @xmath155 and cover @xmath156 by a finite number of balls @xmath157 ( eventually rotating the coordinate axes in each ball ) such that for all @xmath158 , for all @xmath159 the set @xmath160 is contained in the strip @xmath161 for some lipschitz continuous function @xmath162 on @xmath163 and some @xmath164 .",
    "hence by the standard poincar inequality in domains of thickness @xmath130 , we have @xmath165",
    ". then @xmath166 and the right - hand side converges to zero as @xmath110 , by the absolute continuity of the lebesgue integral .",
    "+ @xmath126 pure neumann bc case .",
    "+ we use a linear extension operator @xmath167 from @xmath125 into @xmath168 such that @xmath169 is mapped into @xmath170 .",
    "such an operator is constructed in a standard way , using a partition of unity , boundary rectification and reflection ( see , e.g. , evans @xcite ) .",
    "we then define @xmath139 by the formula @xmath171 .",
    "+ @xmath126 the general case : mixed dirichlet - neumann bc .",
    "+ it suffices to define @xmath172 , introduce @xmath132 as in the dirichlet case , introduce @xmath167 as in the neumann case , and take @xmath173 .",
    "[ rem : spacee]we have seen that the following space appears naturally : @xmath174 introducing its dual @xmath175 and the corresponding duality pairing @xmath176 ; we have @xmath177 whenever the limit exists .    now , using remark  [ rem : al - def ] and lemma  [ lem : regularisation ] , it is not difficult to recast problem , , into the following formal framework : @xmath178    in view of remarks [ rem : al - def ] and [ rem : spacee ] , we can apply some of the techniques used by alt and luckhaus @xcite to deduce an existence result from the uniform boundedness in @xmath179 of the galerkin approximations of our problem ( cf .",
    "the uniform bound in @xmath179 is obtained using the chain rule of lemma  [ lem : chain - rule ] , the gronwall inequality and the assumptions , on the ionic current .",
    "the arguments of the existence proof will essentially be reproduced in section  [ sec : convergenceproof ] ; therefore we omit the details here .    in view of the uniqueness and continuous dependence result of theorem  [ theo : l^2-contraction ] and its proof",
    ", we can end this section by stating a well - posedness result .",
    "[ theo : existence ] assume , and .",
    "there exists one and only one solution to problem , , .",
    "if in addition holds , then the solution depends continuously in the space @xmath179 on the initial datum in @xmath101 .",
    "we make an idealisation of the heart by assuming that it occupies a polyhedral domain @xmath86 of @xmath180 .",
    "we discretise the diffusion terms in using the implicit euler scheme in time and the so - called discrete duality finite volume ( ddfv ) schemes in space .",
    "the ddfv schemes were introduced for the discretisation of linear diffusion problems on @xmath60 unstructured , non - orthogonal meshes by hermeline @xcite and by domelevo and omns @xcite .",
    "they turned out to be well suited for approximation of anisotropic and heterogeneous linear or non - linear diffusion problems .",
    "our application requires a 3d analogue of the 2d ddfv schemes .",
    "three versions of such 3d ddfv schemes have already been developed ; we shall refer to them as @xmath181 , @xmath182 and @xmath183 .",
    "we refer to @xcite for version @xmath181 ; version @xmath182 that we describe in section  [ ssec : meshingb ] below was developed in @xcite and @xcite ; we refer to @xcite for version @xmath183 . in this paper",
    ", we show the convergence of any of these schemes , using only general properties of ddfv approximations .",
    "in the 3d ddfv approach of @xcite ( version @xmath181 ) and in the one of @xcite , @xcite ( version @xmath182 ) , the meshes consist of control volumes of two kinds , the primal and the dual ones .",
    "version @xmath183 also includes a third mesh . for cases",
    "@xmath182 and @xmath183 , primal volumes and dual volumes form two partitions of @xmath86 , up to a set of measure zero . in case @xmath181 , the primal volumes form a partition of @xmath0 , and the dual volumes cover @xmath0 twice , up to a set of measure zero .",
    "some of the dual and primal volumes are considered as `` dirichlet boundary '' volumes , while the others are the `` interior '' volumes ( this includes the volumes located near the neumann part @xmath25 of @xmath29 ) . with each ( primal or dual ) interior control volume",
    "we associate unknown values for @xmath184 ; dirichlet boundary conditions are imposed on the boundary volumes .",
    "the neumann boundary conditions will enter the definition of the discrete divergence operator near the boundary ; it is convenient to take them into account by introducing additional unknowns associated with `` degenerated primal volumes '' that are parts of the neumann boundary @xmath25 .",
    "we consider the space @xmath185 of discrete functions on @xmath0 ; a discrete function @xmath186 consists of one real value per interior control volume . on @xmath185",
    "an appropriate inner product @xmath187 is introduced , which is a bilinear positive form .",
    "both primal and dual volumes define a partition of @xmath0 into diamonds , used to represent discrete gradients and other discrete fields on @xmath0 .",
    "the space @xmath188 of discrete fields on @xmath0 serves to define the fluxes through the boundaries of control volumes .",
    "a discrete field @xmath189 on @xmath0 consists of one @xmath180 value per `` interior '' diamond . on @xmath188 an appropriate inner product @xmath190",
    "is introduced .",
    "a discrete duality finite volume scheme is determined by the mesh , the discrete divergence operator @xmath191 obtained by the standard finite volume discretisation procedure ( with values @xmath192 given by the neumann boundary condition on @xmath25 ) , and by the associated discrete gradient operator .",
    "more precisely , the discrete gradient operator @xmath193 is defined on the space of discrete functions extended by values @xmath194 in volumes adjacent to @xmath26 ; it is defined in such a way that the discrete duality property holds : @xmath195 here @xmath196 corresponds to the homogeneous dirichlet boundary condition of discrete functions defined also on the control volumes adjacent to @xmath197 . ]",
    "@xmath198 on @xmath26 , and @xmath192 denotes the discrete neumann boundary datum for @xmath199 .",
    "further , @xmath200 denotes an appropriately defined product on the neumann part @xmath25 of the boundary @xmath29 , and @xmath201 denotes the boundary values on @xmath25 of @xmath202 .",
    "the precise definitions of these objects are given below for version @xmath182 .",
    "in @xcite and @xcite,@xcite , the definitions of dual volumes and @xmath187 differ ; but both methods can be analysed with the same formalism .",
    "the construction in @xcite only differs by its use of three meshes based on three kinds of control volumes .",
    "this also changes the definition of @xmath187 .",
    "the main difference between the three frameworks lies in the interpretation of @xmath203 in terms of functions . in each case",
    "@xmath203 is thought as a piecewise constant function .",
    "the three following lifting between @xmath185 and @xmath204 are considered : @xmath205 \\dsp \\frac{1}{3 } v^\\ptmrond\\!\\!+\\!\\frac{2}{3 } v^\\ptdmrond &   \\text{for version $ ( b)$ described in \\cite{abk - fvca5,abk , andrbend } , \\cite{herm3,herm4}}\\\\[9pt ]",
    "\\dsp \\frac{1}{3 } v^\\ptmrond\\!\\!+\\!\\frac{1}{3 } v^\\ptdmrond\\!+\\!\\frac{1}{3}v^{\\scriptstyle \\ptdiezmrond } & \\text{for version $ ( c)$ described in \\cite{coudierehubert } } , \\end{array } \\right.\\ ] ] with @xmath206 and @xmath207 representing the discrete solutions on the primal and the dual mesh , respectively , and with @xmath208 ( in the scheme of @xcite ) representing the solution on the third mesh .",
    "we have for instance @xmath209 ( with @xmath210 the characteristic function of @xmath211 ) , the definitions of@xmath207 , @xmath208 are analogous .    in all the three cases , appropriate definitions of the spaces @xmath212 , the scalar products @xmath213 , and the operators @xmath214 , lead to the discrete duality property .      in this subsection",
    "we describe the objects and the associated discrete gradient and divergence operators for version @xmath182 of the scheme .",
    "more details and generalisations can be found in @xcite .",
    "@xmath126 a _ partition _ of @xmath0 is a finite set of disjoint open polyhedral subsets of @xmath0 such that @xmath0 is contained in their union , up to a set of zero three - dimensional measure .",
    "a `` double '' finite volume mesh of @xmath0 is a triple @xmath215 described in what follows .",
    "@xmath126 first , let @xmath216 be a partition of @xmath0 into open polyhedral with triangular or quadrangular faces .",
    "we assume them convex .",
    "assume that @xmath29 is the disjoint union of polygonal parts @xmath26 ( for the sake of being definite , we assume it to be closed ) and @xmath25 ( that we therefore assume to be open ) .",
    "then we require that each face of the polyhedra in @xmath216 either lies inside @xmath0 , or it lies in @xmath26 , or it lies in @xmath25 ( up to a set of zero two - dimensional measure ) .",
    "each @xmath217 is called a _ primal control volume _ and is supplied with an arbitrarily chosen _ centre _",
    "@xmath218 ; for simplicity , we assume @xmath219 .",
    "further , we call @xmath220 ( respectively , @xmath221 ) the set of all faces of control volumes that are included in @xmath25 ( resp . , in @xmath26 ) .",
    "these faces are considered as degenerate control volumes ; those of @xmath221 are called _ boundary primal volumes_. for @xmath222 or @xmath223 , we choose a centre @xmath224 .    finally , we denote @xmath225 ; @xmath226 is the set of _ interior primal volumes _ ; and we denote by @xmath227 the union @xmath228 .",
    "@xmath126 we call _ neighbours _ of @xmath229 , all control volumes @xmath230 such that @xmath229 and @xmath231 have a common face ( by convention , a degenerate volume @xmath232 or @xmath223 has a unique face , which coincides with the degenerate volume itself ) .",
    "the set of all neighbours of @xmath229 is denoted by @xmath233 .",
    "note that if @xmath234 , then @xmath235 ; in this case we simply say that @xmath229 and @xmath231 are ( a couple of ) neighbours . if @xmath229,@xmath231 are neighbours , we denote by @xmath236 the _ interface ( face ) _",
    "@xmath237 between @xmath229 and @xmath231 .",
    "@xmath126 we call _ vertex _ ( of @xmath216 ) any vertex of any control volume @xmath217",
    ". a generic vertex of @xmath216 is denoted by @xmath238 ; it will be associated later with a unique _ dual control volume _ @xmath239 .",
    "each face @xmath236 is supplied with a _ face centre _",
    "@xmath240 which should lie in @xmath236 ( the more general situation is described in @xcite ) . for two _ neighbour vertices _",
    "@xmath238 and @xmath241 ( i.e. , vertices of @xmath226 joined by an edge of some interface @xmath242 or boundary face ) , we denote by @xmath243 the middle - point of the segment @xmath244 $ ] .    @xmath126 now if @xmath245 and @xmath246 , assume @xmath247 are two neighbour vertices of the interface @xmath236 .",
    "we denote by @xmath248 the tetrahedra formed by the points @xmath249 .",
    "a generic tetrahedra @xmath248 is called an _ element _ of the mesh and is denoted by @xmath250 ( see figure  [ fig - puresubdiamond ] ) ; the set of all elements is denoted by @xmath251 .     with  triangular base @xmath236,width=230 ]",
    "@xmath126 define the volume @xmath252 associated with a vertex @xmath238 of @xmath216 as the union of all elements @xmath253 having @xmath238 for one of its vertices .",
    "the collection @xmath254 of all such @xmath252 forms another partition of @xmath0 .",
    "if @xmath255 , we say that @xmath252 is an ( interior ) _ dual control volume _ and write @xmath256 ; and if @xmath257 , we say that @xmath252 is a _ boundary dual control volume _ and write @xmath258 .",
    "thus @xmath259 .",
    "any vertex of any dual control volume @xmath260 is called a _",
    "dual vertex _",
    "( of @xmath254 ) .",
    "note that by construction , the set of vertices coincides with the set of dual centres @xmath238 ; the set of dual vertices consists of centres @xmath218 , face centres @xmath240 and edge centres ( middle points ) @xmath243 .",
    "picturing dual volumes in 3d is a hard task ; cf .",
    "@xcite for version @xmath181 and @xcite for version @xmath183 .",
    "@xmath126 we denote by @xmath261 the set of _ ( dual ) neighbours _ of a dual control volume @xmath252 , and by @xmath262 , the _ ( dual ) interface _ @xmath263 between dual neighbours @xmath252 and @xmath264 .",
    "@xmath126 finally , we introduce the partitions of @xmath0 into diamonds and subdiamonds .",
    "if @xmath265 are neighbours , let @xmath266 be the convex hull of @xmath218 and @xmath236 and @xmath267 be the convex hull of @xmath268 and @xmath236 . then the union @xmath269 is called a _ diamond _ and is denoted by @xmath270 .",
    "if @xmath271 are neighbours , and @xmath247 are neighbour vertices of the corresponding interface @xmath236 , then the union of the four elements @xmath248 , @xmath272 , @xmath273 , and @xmath274 is called _ subdiamond _ and denoted by @xmath275 . in this way , each diamond @xmath276 gives rise to @xmath277 subdiamonds ( where @xmath277 is the number of vertices of @xmath236 ) ; cf .",
    "the next item and fig .",
    "[ fig-3d ] .",
    "each subdiamond is associated with a unique interface @xmath236 , and thus with a unique diamond @xmath276 .",
    "we will write @xmath278 to signify that @xmath279 is associated with @xmath280 .",
    "we denote by @xmath281,@xmath282 the sets of all diamonds and the set of all subdiamonds , respectively .",
    "generic elements of @xmath281,@xmath282 are denoted by @xmath280,@xmath279 , respectively .",
    "notice that @xmath281 is a partition of a subdomain of @xmath86 ( only a small neighbourhood of @xmath25 in @xmath0 is not covered by diamonds ) .     of 3d ddfv mesh ) , width=480 ]    @xmath126 ( see figure  [ fig-3d ] ) the following notations are only needed for an explicit expression of the discrete divergence operator ( and also for the proof of the discrete duality given in @xcite ) .",
    "it is convenient to orient the axis @xmath283 of each diamond @xmath280 .",
    "whenever the orientation is of importance , the primal vertices defining the diamond will be denoted by @xmath284 in such a way that the vector @xmath285 has the positive orientation . the oriented diamond is then denoted by @xmath286 .",
    "we denote by @xmath287 the corresponding unit vector , and by @xmath288 , the length of @xmath285 .",
    "we denote by @xmath289 the unit normal vector to @xmath290 such that @xmath291 .    fixing the normal @xmath292 of @xmath290 induces an orientation of the corresponding face @xmath290 , which is a convex polygon with @xmath277 vertices ( we only use @xmath293 or @xmath294 ) :",
    "we denote the vertices of @xmath290 by @xmath295 , @xmath296\\!]$ ] , enumerated in the direct sense . by convention",
    ", we assign @xmath297 .",
    "we denote by @xmath298 the unit normal vector pointing from @xmath295 towards @xmath299 , and by @xmath300 , the length of @xmath301 .    to simplify the notation , we will drop the @xmath229 s in the subscripts and denote the objects introduced above by @xmath302,@xmath303,@xmath304,@xmath305,@xmath306 and by @xmath307,@xmath308,@xmath309 whenever @xmath286 is fixed .",
    "we also denote by @xmath310 the middle - point @xmath311 of the segment @xmath312 $ ] , and by @xmath313 , the centre @xmath314 of @xmath290 .",
    "@xmath126 for a diamond @xmath315 , we denote by @xmath316 the orthogonal projection of @xmath180 onto the line spanned by the vector @xmath317 ; we denote by @xmath318 the orthogonal projection of @xmath180 onto the plane containing the interface @xmath290 .",
    "@xmath126 we denote by @xmath319 the three - dimensional lebesgue measure of @xmath320 which can stand for a control volume , a dual control volume , or a diamond . in particular , for @xmath222 , @xmath321 : these volumes are degenerate . for a subdiamond @xmath322 , we have the formula @xmath323 .",
    "note the mixed product is positive , thanks to our conventions on the orientation in @xmath324 and because we have assumed that @xmath325 .",
    "[ rem : diamonds , subdiamonds ] diamonds permit to define the discrete gradient operator , while subdiamonds permit to give formulas for the discrete divergence operator ( see , and , below , respectively ) .    in the context of @xmath60 `` double '' schemes ,",
    "introducing diamonds is quite standard ( see , e.g. , @xcite ) .",
    "subdiamonds are `` hidden '' in the @xmath60 construction : they actually coincide with diamonds .",
    "+ [ ssec : fctsfieldsdata ]    @xmath126 a _ discrete function _",
    "@xmath326 on @xmath327 is a pair @xmath328 consisting of two sets of real values @xmath329 and @xmath330 .",
    "the set of all such functions is denoted by @xmath185 .",
    "@xmath126 a _ discrete field _",
    "@xmath331 on @xmath0 is a set @xmath332 of vectors of @xmath333 .",
    "the set of all discrete fields is denoted by @xmath334 . if @xmath335 is a discrete field on @xmath0 , we assign @xmath336 whenever @xmath278 .",
    "@xmath126 a _ discrete dirichlet datum _",
    "@xmath194 on @xmath26 is a pair @xmath337 consisting of two sets of real values @xmath338 and @xmath339 . in practise , @xmath340 ( resp . ,",
    "@xmath341 ) can be obtained by averaging the `` continuous '' dirichlet datum @xmath342 over the boundary volume @xmath343 ( resp .",
    ", over the part of @xmath26 adjacent to the boundary dual volume @xmath252 ) ; if @xmath342 is continuous , the mean value can be replaced by the value of @xmath342 at @xmath218 ( resp .",
    ", at @xmath238 ) .",
    "we refer to @xcite for details .",
    "@xmath126 a _ discrete neumann datum @xmath344 on @xmath25 _ is a set of real values @xmath345 .    in practice ,",
    "@xmath346 can be obtained by averaging the `` continuous '' neumann datum @xmath347 over the degenerate volume @xmath348 . in the case @xmath349",
    ", one should be careful while using approximate quadratures to produce @xmath192 from @xmath347 . indeed",
    ", some compatibility conditions between neumann data and source terms may arise while discretising elliptic equations ( this is the case of system , because the difference of the two equations of the system is an elliptic equation , and the compatibility condition is needed for the solvability of the system ) .",
    "the compatibility condition , expressed in terms of @xmath350 , should be preserved at the discrete level .",
    "this is the case for the above choice of @xmath192 : indeed , we have the equality @xmath351 .",
    "+ @xmath126 on the set @xmath185 of discrete functions @xmath326 on @xmath327 , we define the _ discrete gradient _ operator @xmath352 $ ] with dirichlet data @xmath194 on @xmath26 : @xmath353 where the entry @xmath354 of the discrete field @xmath355 relative to @xmath315 is @xmath356 \\dsp \\dprojd({{\\nabla}}_{\\!\\ptd } w^\\pttau ) = { { \\nabla}}f(\\cdot ) , \\end{array } \\right .",
    "{ \\end{equation}}where \\begin{itemize } \\item[$\\cdot$ ] $ f(\\cdot)$ is the affine function from $ { { \\mathbb r}}^3 $ to $ { { \\mathbb r}}$   that is constant in the direction $ \\ndotplus$ orthogonal to $ \\kil$ and that is   the { \\it ad hoc } affine   interpolation ( namely , \\eqref{eq : interpolation } below ) of the values $ w^*_i$ at the vertices $ x^*_i$ , $ i=1,\\ldots , l$ , of $ \\kil$ ;    \\smallskip \\item[$\\cdot$ ] for the vertices of $ \\dm$ lying in $ \\om\\cup\\gamma_n$ , $ \\wdot\\!=\\!w_\\ptkdot,\\,\\wplus\\!=\\!w_\\ptkplus$ , $ w^*_i = w_{\\ptk^{\\!*}_{\\!i}}$ , etc .",
    "( we use the simplified notation in the diamond $ \\dm=\\dm^{\\ptkdotikplus}$ , as depicted in figure~\\ref{fig-3d } ) .   for the vertices of $ \\dm$ that lie in $ \\gamma_d$ ,",
    "the values of $ g^\\pttau$ are used : e.g. , if $ x_\\ptkdot\\in\\gamma_d$ , then we set $ \\wdot:=g_\\ptkdot$ in the above formula.\\smallskip \\end{itemize }    clearly , if $ l=3 $ there is a unique consistent interpolation of the values $ w_1,w_2,w_3$. for $ l\\geq 4 $ , no consistent interpolation exists , and   we choose the linear form in $ w^*_{\\!i}$ that leads to the expression \\begin{equation}\\label{eq : interpolation } \\dprojd({{\\nabla}}_{\\!\\ptd } w^\\pttau ) \\!=\\ !",
    "\\frac 2{\\sum_{i=1}^l \\,\\langle\\,\\ndotplus,\\overrightarrow{\\xdotplus \\xidemi},\\overrightarrow{x^*_i x^*_{i\\hspace*{-1pt}+\\!1}}\\,\\rangle}\\ ; \\sum_{i=1}^l   ( w^*_{\\!i\\hspace*{-1pt}+\\!1}-w^*_{\\!i})\\ ;   \\bigl[\\ndotplus\\times \\overrightarrow{\\xdotplus \\xidemi}\\bigr];\\ ] ] it is shown in @xcite that this choice is exact on affine functions , and that it leads to the discrete duality formula . for an explicit formula of @xmath354 , note that @xmath357 , @xmath358 are given ; then one expresses @xmath354 as @xmath359 \\biggr\\}\\ ] ]    [ rem : discrgradsense ] in , the primal mesh @xmath227 serves to reconstruct one component of the gradient , which is the one in the direction @xmath304 .",
    "the dual mesh @xmath254 serves to reconstruct , with the help of the formula , the two other components , which are those lying in the plane containing @xmath290 .",
    "the same happens for version @xmath181 of the scheme . on the contrary ,",
    "version @xmath183 only reconstructs one direction of the discrete gradient on the mesh @xmath360 , while the third direction is reconstructed on a third mesh that we denote by @xmath361 .",
    "[ rem : consistaffines ] we stress that our gradient approximation is consistent ( see @xcite for the proof ) .",
    "indeed , let @xmath362 be the values at the points @xmath363 , respectively , of an affine on @xmath364 function @xmath365 .",
    "then @xmath366 coincides with the value of @xmath367 on @xmath280 .",
    "@xmath126 on the set @xmath334 of discrete fields @xmath331 , we define the _ discrete divergence _",
    "operator @xmath368 $ ] with neumann data @xmath192 on @xmath25 : @xmath369 where the entries @xmath370 ( for @xmath217 ) and @xmath371 of the discrete function @xmath372 on @xmath0 are given by @xmath373 \\dsp \\forall\\,\\dk\\in \\dmrond,\\;\\ ; \\div_{\\!\\!\\ptdk }",
    "\\vec \\frond^\\pttau=   \\frac{1}{\\vol(\\ptdk ) } \\sum_{\\ptd\\in\\ptdrond : \\ , \\ptd\\cap \\ptdk\\neq\\text{\\o } } \\int_{\\ptptl\\ptdk\\cap\\ptd}\\vec \\frond_d\\cdot n_\\ptdk , \\end{array}\\ ] ] where @xmath374 ( resp . , @xmath375 ) denotes the exterior unit normal vector to @xmath229 ( resp .",
    ", to @xmath252 ) .",
    "further , for @xmath222 , we mean that @xmath374 points inside @xmath0 , and we adapt the following formal definition : @xmath376 thus , although @xmath377 is zero , in calculations we only use the products @xmath378 , which are well defined thanks to convention . in practise , the discrete equations corresponding to volumes of @xmath220 will always read as @xmath379 notice that the values of the neumann data @xmath192 only appear in the convention for the degenerate primal volumes @xmath380 ; at the same time , in the volumes @xmath252 adjacent to @xmath25 the data @xmath192 are taken into account indirectly .",
    "namely , let @xmath252 be a dual volume adjacent to @xmath25 , and let @xmath280 be a diamond intersecting @xmath252 and adjacent to @xmath25 ; then the value @xmath381 used for the definition of @xmath382 is linked to the data @xmath192 via equations .",
    "the formulas are standard for divergence discretisation in finite volume methods ; their interpretation is straightforward , using the green - gauss theorem .",
    "the consistency of the discrete divergence operator ( in the weak sense ) can be inferred by duality from the one of the discrete gradient operator ( remark  [ rem : consistaffines ] ) and from the discrete duality property ; see proposition  [ propconsistency](iii ) and @xcite .    for the explicit calculation of the right - hand sides in , one can further split diamonds into subdiamonds",
    "in a generic subdiamond , we use the following notation . consider @xmath383",
    "; it is associated with a unique oriented diamond which we denote @xmath286 , so that @xmath279 is of the form @xmath322 . in order to cope with the vector orientation issues , given @xmath322 we define @xmath384 for @xmath385 , we denote by @xmath386 the set of all subdiamonds @xmath387 such that @xmath388 . in the same way , for @xmath256 we define the set @xmath389 of the subdiamonds intersecting @xmath252 .",
    "then , using the notation @xmath390 for the mixed product on @xmath180 , we can express formulae as @xmath391 \\dsp \\forall\\,\\dk\\in \\dmrond\\;\\;\\;\\ ; \\div_{\\!\\!\\ptdk }",
    "\\vec \\frond^\\pttau=   \\frac{1}{2\\vol(\\ptdk ) } \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\sum_{\\hspace*{5mm}\\pts\\in\\ptdvrond(\\ptdk)}\\!\\!\\!\\!\\!\\!\\!\\ ! ( -1)^\\ptepssdk \\ ! \\langle\\,\\vec \\frond_{\\!\\pts } , \\overrightarrow{\\xdot\\xplus } , \\overrightarrow{\\xdotplus\\xidemi}\\,\\rangle . \\end{array}\\ ] ] in , each subdiamond @xmath279 in @xmath386 ( or in @xmath389 ) has the form @xmath322 , with some @xmath392 ; the notations @xmath393 refer to @xmath322 ( see figure  [ fig-3d ] ) .",
    "details can be found in @xcite .",
    "[ rem : reduction - to - duality ] in practise it is not necessary to calculate the discrete divergence ; indeed , with the help of the duality property , one can express the discrete system of equations in the dual form , where the calculation of the discrete divergence of the solution is replaced by the calculation of the discrete gradient of a test function .",
    "thus , as for the so - called mimetic finite difference methods , in order to formulate a ddfv scheme it is sufficient to calculate discrete gradients .",
    "this amounts to the `` discrete weak formulation '' we use in the sequel .",
    "@xmath126 recall that @xmath185 is the space of all discrete functions on @xmath0 . for @xmath394 , set @xmath395    recall that @xmath396 is the space of discrete fields on @xmath0 . for @xmath397 , set @xmath398    @xmath126 recall that in , for version @xmath182 of the scheme , given a discrete function @xmath202 , we set @xmath399 then the function @xmath400 can be defined as the trace of @xmath202 on @xmath25 .",
    "this means , @xmath401 where for @xmath402-a.e @xmath403 , @xmath229 and @xmath252 are uniquely defined by the fact that @xmath404 .",
    "@xmath126 finally , for @xmath200 , we simply use the @xmath117 scalar product on @xmath25 .    now a straightforward adaptation of the proof of the discrete duality property in @xcite yields the desired discrete duality property .",
    "the time - implicit ddfv finite volume schemes for problem , , can be formally ( up to convention ) written under the following general form : @xmath405 \\dsp \\frac{v^{\\pttau , n+1 } - v^{\\pttau , n}}{\\delt } -\\div^\\pttau_{\\!\\!s_i^{\\pttau , n+1}}[{\\ensuremath{\\mathbf{m}}}_{i}^\\pttau{{\\nabla}}^\\pttau_{\\!g_i^{\\!\\pttau , n+1 } } u_i^{\\pttau , n+1}]+ h^{\\pttau , n+1 } -{i_{\\mathrm{app}}}^{\\pttau , n+1}=0,\\\\[5pt ] \\dsp \\frac{v^{\\pttau , n+1 } - v^{\\pttau , n}}{\\delt } + \\div^\\pttau_{\\!\\!s_e^{\\pttau , n+1}}[{\\ensuremath{\\mathbf{m}}}_{e}^\\pttau { { \\nabla}}^\\pttau_{\\!g_e^{\\!\\pttau , n+1 } } u_e^{\\pttau , n+1}]+ h^{\\pttau , n+1 } -{i_{\\mathrm{app}}}^{\\pttau , n+1}=0,\\\\[8pt ] \\dsp   v^{\\pttau , n+1}-(u_i^{\\pttau ,",
    "n+1}-u_e^{\\pttau , n+1})=0 , \\end{array}\\right.\\ ] ] @xmath406 for two rigorous interpretations of , see definition  [ def : scheme - solution ] below .",
    "we normalise @xmath407 by requiring , for all @xmath408 , @xmath409 ( the last condition is only meaningful for the meshing @xmath183 ) .",
    "the triple @xmath410 constitutes the unknown discrete functions at time level @xmath27 ; @xmath411 and @xmath412 stand for the projections of the initial datum @xmath100 and the source term @xmath102 on the space of discrete functions .",
    "similarly , @xmath413,@xmath414 are suitable projections of the dirichlet and neumann data @xmath415 , respectively .",
    "notice that the boundary data are taken into account in the definition of the discrete operators @xmath416 , @xmath417 .",
    "the matrices @xmath418 are the projections of @xmath419 on the diamond mesh .",
    "we will mainly work with the mean - value projections ; e.g. , the projection @xmath420 on @xmath421 of @xmath100 would be the discrete function with the entry @xmath422 corresponding to a control volume @xmath229 . for regular functions , the centre - valued projection @xmath423 can be considered , where the entry @xmath424 corresponds to a volume @xmath229",
    ". we refer to sections  [ ssec : fctsfieldsdata ] ,  [ ssec : proj - ops ] for details on the projection operators in use .    a relation that links @xmath425 to @xmath426 closes the scheme ; we consider the following two choices : the fully implicit scheme , @xmath427 and the linearised implicit scheme @xmath428 where @xmath420 is the projection operator acting from @xmath204 into the space of the corresponding discrete functions ; further , @xmath429 define the piecewise constant functions reconstructed according to from the values @xmath430 ( for versions @xmath181 and @xmath182 ) or @xmath431 ( for version @xmath183 ) .",
    "the same convention applies to @xmath432 .",
    "we refer to section  [ ssec : reaction - term ] for a detailed description of such discretisation of the ionic current term .",
    "[ rem : h - reconstruction]in the discretisation of the ionic current term @xmath20 , the choice , is made to reconstruct the @xmath433 function @xmath434 and then to re - project it on the mesh @xmath421 .",
    "this is tricky and it may seem unnatural .",
    "but we explain in section  [ ssec : reaction - term ] that this is the way to ensure that the structure of the reaction terms in the discrete equations yields exactly the same _ a priori _ estimates as for the continuous problem .",
    "the seemingly simpler choice @xmath435 ( instead of ) does not have good structure properties ; we can justify the convergence of the associated scheme by adding a penalisation term ( cf .",
    "@xcite ) whose role is to make small the differences @xmath436 , for @xmath437 , in the left - hand side of the scheme .",
    "[ def : scheme - solution ] a _ discrete solution _ is a set @xmath438}$ ] ( in the sequel , we denote it by @xmath439 ) satisfying the initial data , the normalisation equations , and the closure relation or ; moreover , it should solve system in the following sense : + @xmath440 equalities in hold component per component for all entries corresponding to primal volumes @xmath441 and those corresponding to the dual volumes @xmath256 ; + @xmath440 for the entries corresponding to @xmath222 , convention is used , that is , the equations take the form @xmath442 and @xmath443    equivalently , @xmath439 is a discrete solution if @xmath444 and for all @xmath445 , for all @xmath446 $ ] the following identities hold : @xmath447 \\dsp\\qquad\\qquad   + \\cleft s_i^\\pttau , \\ph^{\\ptl\\pttau } \\cright_{\\gamma_n } + \\bleft h^{\\pttau , n+1}-{i_{\\mathrm{app}}}^{\\pttau , n+1 } , \\ph^\\pttau\\bright_\\om = 0,\\\\[8pt ] \\dsp \\frac1{\\delt } \\bleft{v^{\\pttau , n+1 } - v^{\\pttau , n}},\\ph^\\pttau\\bright_\\om -\\aleft { \\ensuremath{\\mathbf{m}}}_{i}^\\pttau{{\\nabla}}^\\pttau_{\\!g_e^{\\!\\pttau , n+1 } } u_e^{\\pttau , n+1},{{\\nabla}}^\\pttau_0 \\ph^\\pttau\\aright_\\om\\\\[5pt ] \\dsp\\qquad\\qquad   - \\cleft s_e^\\pttau , \\ph^{\\ptl\\pttau } \\cright_{\\gamma_n } + \\bleft h^{\\pttau , n+1}-{i_{\\mathrm{app}}}^{\\pttau , n+1 } , \\ph^\\pttau\\bright_\\om = 0 . \\end{array}\\right.\\ ] ]    notice that the equivalence of the two above formulations of is easy to establish ; namely , the discrete duality property is used together with the choice of discrete test functions @xmath448 that only contain one non - zero entry .",
    "the existence of solutions to the discrete equations is obtained in a standard way from the brouwer fixed - point theorem and the coercivity enjoyed by our schemes ; the uniqueness proof mimics the one of theorem  [ theo : l^2-contraction ] .",
    "more precisely , we have    [ prop : schemeexist ] assume , .",
    "whenever @xmath449 , for all given boundary data satisfying ( if @xmath349 , we add to the scheme ) and for all given initial data there exists one and only one discrete solution to the scheme , ; likewise , there exists one and only one discrete solution to the scheme , .",
    "moreover , for fixed boundary data , the discrete @xmath117 contraction property holds for the @xmath450 component of the solution of the fully implicit scheme , , : indeed , for all @xmath451 $ ] , @xmath452    [ rem : optimization]let us point out that the fully implicit scheme leads , at each time level , to a nonlinear system of equations , and to compute the solution given by proposition  [ prop : schemeexist ] ( or , rather , a reasonable approximation to it ) we can use the following variational formulation of the scheme : @xmath453   & \\!\\!\\!j\\bigl[u_i^\\pttau , u_e^\\pttau\\bigr]\\,:=\\ , \\frac 1{2\\delt }   \\bleft   v^\\pttau\\,,\\,v^\\pttau \\bright_\\om - \\frac 1{\\delt }   \\bleft   v^\\pttau\\,,\\,v^{\\pttau , n } \\bright_\\om   +   { \\dsp\\int_\\om } h(v^{\\pttau}(\\cdot))\\\\[8pt ]   & \\qquad\\qquad\\qquad+ \\aleft { \\ensuremath{\\mathbf{m}}}_i^{\\pttau }   { { \\nabla}}^\\pttau_{g_i^{\\pttau , n+1 } } u^\\pttau\\,,\\ ,   { { \\nabla}}^\\pttau_{g_i^{\\pttau , n+1 } } u^\\pttau   \\aright_\\om \\\\[8pt ] & \\qquad\\qquad\\qquad+ \\aleft { \\ensuremath{\\mathbf{m}}}_e^{\\pttau }   { { \\nabla}}^\\pttau_{g_e^{\\pttau , n+1 } } u^\\pttau\\,,\\ ,   { { \\nabla}}^\\pttau_{g_e^{\\pttau , n+1 } } u^\\pttau   \\aright_\\om\\\\[8pt ]   & \\qquad\\qquad\\qquad- \\cleft s_i^{\\pttau , n+1}\\,,\\ ,   u_i^{\\ptl\\pttau}\\cright_{\\gamma_n}-\\cleft s_e^{\\pttau , n+1}\\ , ,   \\,u_e^{\\ptl\\pttau}\\cright_{\\gamma_n }   - \\bleft   { i_{\\mathrm{app}}}^{\\pttau , n+1}\\,,\\,v^\\pttau \\bright_\\om,\\\\[14pt ]   & \\text{where $ v^\\pttau:=u_i^\\pttau - u_e^\\pttau$ ,   and $ h : z\\mapsto \\int_0^z h(s)\\,ds$ is the primitive of $ h$ }   \\end{array }   \\right.\\ ] ] ( in the case @xmath349 , the constraint should be added on the domain of the functional @xmath454 ) . similarly to the argument in @xcite , it is checked from the discrete duality formula and from formula in section  [ ssec : reaction - term ] that the scheme is the euler - lagrange equation for the above problem . from the properties of",
    "@xmath455 it follows that for @xmath456 , we are facing a minimisation problem for the convex coercive functional @xmath454 .",
    "thus descent iterative methods can be used for solving the discrete system at each time step .",
    "now we can state the main result of this paper .",
    "[ th : convergence ] assume , hold with some @xmath457 .",
    "assume that the family of meshes satisfies the regularity assumptions , , ( and the analogous restrictions on the mesh @xmath361 , for version @xmath183 ) stated in section  [ ssec : meshesregularity ] .",
    "then    * the sequence of solutions @xmath458 to the fully implicit scheme , , , converges , as the approximation parameters @xmath459 tend to zero , to the unique solution @xmath74 of problem , , ; the convergence is strong in @xmath460 .",
    "moreover , the discrete gradients converge to @xmath461 strongly in @xmath462 ; * for any @xmath463 , the statement analogous to ( i ) holds for the discrete solutions of the linearised implicit scheme , , , .    if @xmath349 , the constraint should be added to the equations of the scheme .",
    "in the same vein , the standard 2d ddfv construction can be applied to problem , , on 2d polygonal domains .",
    "the convergence result of theorem  [ th : convergence](i ) remains true , and the one of theorem  [ th : convergence](ii ) extends to all @xmath464 .",
    "we stress that the realistic case @xmath57 is covered by our convergence results .",
    "for a given mesh @xmath421 of @xmath0 as described in section  [ sec : ddfv ] , the size of @xmath421 is defined as @xmath465 if the assumption @xmath466 is relaxed , @xmath467 must be replaced with @xmath468 in the above expression .    in what follows",
    ", we will always think of a family of meshes such that @xmath469 goes to zero .         in different finite volume methods , one always needs some qualitative restrictions on the mesh @xmath421 ( such as , e.g. , @xmath224 , or the convexity of volumes and/or diamonds , or the mesh orthogonality , or the delaunay condition on a simplicial mesh ) . for the convergence analysis with respect to families of such meshes , it is convenient ( though not always necessary ) to impose shape regularity assumptions .",
    "these assumptions are quantitative : this means that the `` distortion '' of certain objects in a mesh is measured with the help of a regularity constant @xmath470 , which is finite for each individual mesh but may get unbounded if an infinite family of meshes is considered . for the 3d ddfv",
    "meshes presented in this paper , there are two main mesh regularity assumptions .",
    "first , we require several lower bounds on @xmath471 : @xmath472 \\end{array}\\\\ \\begin{array}{ll } \\text{$\\forall$ diamonds $ \\dm$ with vertices $ \\xk,\\xl$ and with}&\\\\ \\text{neighbour dual vertices $ x_\\ptdk , x_\\ptdl$ } , \\diam(\\dm)\\leq \\regmesh \\min\\{\\dkl,\\ddkdl\\}. \\end{array } \\end{array } \\right.\\ ] ] further , we need a bound on the inclination of the ( primal and dual ) interfaces with respect to the ( dual or primal ) edges : @xmath473 \\text{$\\forall$ neighbour vertices $ \\xdk,\\xdl$ of $ \\kil$ , the angle $ \\alpha^*_{\\!\\ptdk\\!\\!,\\ptdl}$ between $ \\overrightarrow{\\xdk \\xdl}$ } \\\\ \\text{and $ \\overrightarrow{x_{\\ptdk\\pti\\ptdl}x_\\ptkil}$ is separated from $ 0 $ and $ \\pi$ , i.e. , $ \\regmesh \\cos \\alpha^*_{\\!\\ptdk\\!\\!,\\ptdl}\\geq 1$}. \\end{array}\\right.\\ ] ]    also a uniform bound on the number of neighbours of volumes / diamonds is useful : @xmath474 for version @xmath183 of the scheme , we impose in addition conditions on the third mesh @xmath361 ; moreover , the number of vertices of a diamond is restricted by @xmath470 .",
    "recall that for versions @xmath181 and @xmath182 we assume that all diamond has five ( @xmath475 ) or six ( @xmath476 ) vertices , because the faces of the primal volumes are assumed to be triangles or quadrilaterals ; and the convergence results are shown for the case of triangular primal faces .    for versions @xmath181 and @xmath182 , when the number @xmath277 of vertices of a face @xmath236 exceeds three , the kernel of the linear form used to reconstruct the discrete gradient in @xmath276 is not reduced to a constant at the vertices of @xmath477 .",
    "this is a problem , e.g. , for the discrete poincar inequality and for the proof of discrete compactness . in general , the situation with @xmath478 vertices is not clear ; for example , the discrete poincar inequality holds on every individual mesh , but it is not an easy task to prove that the embedding constant is uniform , even under rigid proportionality assumptions on the meshes .",
    "the uniform cartesian meshes is one case with @xmath479 that can be treated ( see @xcite ) , but they are not suitable for the application we have in mind .    in this paper , for a certain range of values of the power @xmath480 in",
    ", , we use sobolev embedding inequalities of the discrete @xmath105 spaces into @xmath481 , @xmath482 ; for these results to hold , we may also require @xmath483      here we gather basic consistency results for the ddfv discretisations .",
    "heuristically , for a given function @xmath484 on @xmath0 , the projection of @xmath484 on a mesh @xmath421 and subsequent application of the discrete gradient @xmath485 should produce a discrete field sufficiently close ( for @xmath469 small ) to @xmath486 .",
    "similarly , for a given field @xmath487 , the adequate projection on the mesh and the application of @xmath488 to this projection should yield a discrete function close to @xmath489 . in this paper",
    ", we mainly use the mean - value projections . for scalar functions on @xmath0 , two projections on @xmath185 ( which has two components , namely the projections on @xmath226 and on @xmath360 )",
    "are used : @xmath490 @xmath491 in case @xmath229 is a degenerate volume in @xmath220 , @xmath377 is zero and we replace the corresponding entry of @xmath492 by the mean value @xmath493 of @xmath484 over the face @xmath380 .",
    "similarly , the neumann data @xmath103 will be taken into account through the values @xmath494 for @xmath232 .",
    "further , if we are interested in the values of @xmath484 on the dirichlet part of the boundary , then we use the projection @xmath495 in particular , the dirichlet data @xmath31 will be taken into account in this way . for @xmath180-valued fields on @xmath0 , we use the projection on @xmath396 defined by @xmath496    with each of these discrete functions , we associate piecewise constant functions of @xmath497 on @xmath0 , on @xmath26 or on @xmath25 , according to the sense of the projection ; then we can study convergence , e.g. , of @xmath498 to @xmath499 in lebesgue spaces , as @xmath500 .",
    "for the data @xmath100,@xmath102 , @xmath59 , @xmath31 , @xmath103 , we need the consistency of the associated projection operators ( recall that @xmath100,@xmath102 are projected on the meshes @xmath216 and @xmath360 , @xmath59 are projected on the diamonds , @xmath31 are projected on the boundary volumes , and @xmath103 are projected on the degenerate interior primal volumes @xmath222 ) .",
    "these consistency results can be shown in a straightforward way ( see , e.g. , @xcite ) ; for example , we have @xmath501 in @xmath101 , and @xmath502 in @xmath503 .",
    "note that for the study of weak compactness in sobolev spaces and convergence of discrete solutions , the consistency results can be formulated for test functions only ( and the consistency for @xmath504 is formulated in a weak form , except on very symmetric meshes ) .",
    "these results are shown under the regularity restrictions , , on the mesh ; let us give the precise statements .",
    "[ propconsistency ] let @xmath421 be a 3d ddfv mesh of @xmath0 as described in section  [ sec : ddfv ] .",
    "let @xmath470 measure the mesh regularity in the sense of , , .",
    "then the following results hold : + ( i )   for all @xmath505 , @xmath506 and for version @xmath183 , the analogous estimates hold for @xmath507 . +",
    "analogous estimates hold for the projections @xmath508 .",
    "similarly , for all @xmath509 , @xmath510 ( ii )   for all @xmath511 , @xmath512 ( iii )   for versions @xmath181 and @xmath182 , assume that each primal interface @xmath236 is a triangle . for each @xmath509 and for all @xmath513 , @xmath514",
    "we refer to @xcite for a proof of this result .       + the key fact here is the following remark : @xmath515 indeed , for variants @xmath516 it has been already observed in the proof of proposition  [ propconsistency](iii ) that the restriction @xmath293 on the number @xmath277 of dual vertices of a diamond @xmath286 allows for a control by @xmath517 of the divided differences : @xmath518 ( here @xmath519 and by our convention , @xmath520 , @xmath521 ; cf .  figure  [ fig-3d ] ) . for version @xmath183 ,",
    "this kind of control is always true for the divided differences along the edges of any of the three meshes .",
    "consequently , for a proof of the different embeddings , we can treat the primal and the dual meshes in @xmath421 separately , as if our scheme was one with the two - point gradient reconstruction .",
    "first we give discrete ddfv versions of the embeddings of the discrete @xmath522 spaces , where we refer to the embedding into @xmath523 ( the poincar inequality ) , into @xmath524 with @xmath525 , @xmath526 ( the critical sobolev embedding ) , as well as the compact embeddings into @xmath527 for all @xmath528 or @xmath529 .",
    "[ prop : poincare - and - sobolev ] let @xmath421 be a 3d ddfv mesh of @xmath0 as described in section  [ sec : ddfv ] .",
    "let @xmath470 measure the mesh regularity in the sense and .",
    "assume ( for versions @xmath181 and @xmath182 ) that each primal interface @xmath236 is a triangle .",
    "let @xmath530 . then @xmath531 moreover , @xmath532    notice that for the poincar inequality ( the first statement ) , assumption is not needed , cf .",
    "@xcite for a proof .",
    "actually , with the hint of ( * ? ? ?",
    "* lemma 2.6 ) the sobolev embeddings for @xmath533 can be obtained without using .",
    "the statement follows in a very direct way from the proofs given in @xcite . because of , the assumption that the primal mesh faces are triangles ( i.e. , @xmath293 ) is a key assumption for the proof . in some of the proofs in these papers",
    "one refers to admissibility assumptions on the mesh ( such as the mesh orthogonality and assumptions of the kind `` @xmath534 '' , see @xcite ) , yet , as in @xcite ( where the proof of the poincar inequality is given for the @xmath60 case ) , these assumptions are easily replaced by the bounds @xmath535 that stem from the mesh regularity assumptions and .",
    "the embeddings of the discrete @xmath536 space contain an additional term in the right - hand side , which is usually taken to be either the mean value of @xmath326 on some fixed part @xmath537 of the boundary @xmath29 ( used when a non - homogeneous dirichlet boundary condition on @xmath537 is imposed ) , or the mean value of @xmath326 on some subdomain @xmath538 of @xmath0 ( the simplest choice is @xmath539 , used for the pure neumann boundary conditions ) .",
    "let us point out that the strategy of eymard , gallout and herbin in @xcite actually allows to obtain sobolev embeddings for the `` neumann case '' as soon as the poincar inequality is obtained .",
    "for the proof , one bootstraps the estimate of @xmath540 .",
    "first obtained from the poincar inequality with @xmath541 , it is extended to @xmath542 with the discrete variant ( * ? ? ?",
    "* lemma 5.2 ) ( where one can exploit ) of the nirenberg technique . in the same way",
    ", the bound of @xmath540 is further extended to @xmath543 and so on , until one reaches the critical exponent @xmath544 .",
    "the details are given in @xcite . moreover , the poincar inequality for the `` neumann case '' ( i.e. , the embedding into @xmath101 of the discrete analogue of the space @xmath545 ) and for the case with control by the mean value on a part of the boundary , was shown in @xcite , @xcite . thus we can assume that the analogue of proposition  [ prop : poincare - and - sobolev ] with the additional terms @xmath546 , @xmath547 or @xmath548,@xmath549 in the right - hand side of the estimates is justified .",
    "notice that the compactness of the sub - critical embeddings is easy to obtain by interpolation of the @xmath550 embedding with the compact @xmath433 embedding derived from the helly theorem ( indeed , the @xmath433 estimate of @xmath355 can be seen as the @xmath551 estimate of the piecewise constant functions @xmath552 and @xmath553 ) .    finally , notice that the same arguments that yield the poincar inequality with a homogeneous boundary condition also yield the trace inequality @xmath554 ( the inequalities on the mesh @xmath360 and , for the case @xmath183 , on the mesh @xmath361 are completely analogous ) .",
    "these inequalities are useful for treating non - homogeneous neumann boundary conditions on a part @xmath25 of @xmath29 .      in relation with proposition  [ prop : poincare - and - sobolev](ii ) , let us stress that there is no reason that the components @xmath555 , @xmath556 of a sequence @xmath557 of discrete functions with @xmath558 bounded discrete gradients converge to the same limit .",
    "counterexamples are constructed starting from two distinct smooth functions discretised , one on the primal mesh @xmath227 , the other on the dual mesh @xmath254 .",
    "however , the proposition below shows that in our 3d ddfv framework , we can assume that the `` true limit '' of the discrete functions @xmath559 , @xmath560 or @xmath561 coincides with the limit of .",
    "[ prop : asymptcompactness ]   + ( i ) let @xmath562 be discrete functions on a family @xmath563 of 3d ddfv meshes of @xmath0 as described in section  [ sec : ddfv ] , parametrised by @xmath564 .",
    "assume @xmath565 and let @xmath566 , for some fixed boundary datum @xmath567 .",
    "assume that the family @xmath568}$ ] is bounded in @xmath569 .",
    "assume ( for versions @xmath181 and @xmath182 ) that each primal interface @xmath236 is a triangle .",
    "assume that @xmath570 } { { \\rm reg}(\\tau_h)}<+\\infty$ ] , where @xmath571 measures the regularity of @xmath572 in the sense , , and .",
    "according to the type of 3d ddfv meshing considered , let us assimilate @xmath573 into the piecewise constant functions @xmath574 defined by ; furthermore , let us assimilate the discrete gradient @xmath575 to the function @xmath576 on @xmath0 .",
    "then for any sequence @xmath577 converging to zero there exists @xmath578 such that , along a sub - sequence , @xmath579 ( ii ) if @xmath349 , and if the additional assumption of uniform boundedness of @xmath580 is imposed ( with the analogous bound on the mesh @xmath361 for version @xmath183 ) , then holds with @xmath581 .",
    "let us illustrate the ddfv techniques by giving the ideas of the proof .",
    "we justify ( i ) for the case of the meshing described in section  [ sec : ddfv ] and the homogeneous dirichlet boundary condition on @xmath582 .",
    "the case of a non - homogeneous dirichlet condition is thoroughly treated in @xcite , for the 2d ddfv schemes .",
    "the case of neumann boundary conditions is the simplest one .",
    "the strong compactness claim follows by the compactness of the subcritical sobolev embeddings of proposition  [ prop : poincare - and - sobolev ] .",
    "the weak @xmath117 compactness of the family @xmath583 is immediate from its @xmath101 boundedness .",
    "thus if @xmath365 is the strong @xmath117 limit of a sequence @xmath584 as @xmath585 and @xmath586 is the weak @xmath117 limit of the associated sequence of discrete gradients @xmath587 , it only remains to show that @xmath588 in the sense of distributions and that @xmath365 has zero trace on @xmath29 .",
    "these two statements follow from the identity @xmath589 that we now prove .",
    "we exploit the discrete duality and the consistency property of proposition  ( i),(iii ) .",
    "take the projection @xmath590 , @xmath591 and write the discrete duality formula @xmath592 according to the definition of @xmath593 , the first term in is precisely the integral over @xmath0 of the scalar product of the constant per diamond fields @xmath587 and @xmath594 . by proposition  ( i ) and the definition of @xmath586",
    ", this term converges to the first term in as @xmath585 .",
    "similarly , introducing the projection @xmath595 of @xmath596 on @xmath597 , from the definition of @xmath598 , proposition  ( i ) and the definition of @xmath573 in , we see that , as @xmath585 , @xmath599 it remains to invoke proposition  ( iii ) and the @xmath204 bound on @xmath587 to justify the fact that @xmath600 for a proof of ( ii ) use the versions of the compact sobolev embeddings with control by the mean value in @xmath0 , and use test functions @xmath499 compactly supported in @xmath0 .",
    "we discretise our evolution equations in space using the ddfv operators as described above . in this time - dependent framework ,",
    "analogous consistency properties , poincar inequality and discrete @xmath602 compactness properties hold .",
    "to be specific , given a ddfv mesh @xmath421 of @xmath0 and a time step @xmath603 , one considers the additional projection operator @xmath604}\\subset l^1(\\om ) , \\qquad f^{n}(x):=\\frac 1{\\ptdelt}\\int_{(n\\hspace*{-1pt}-\\!1)\\ptdelt}^{n\\ptdelt } f(t , x)\\ , dt.\\ ] ] here @xmath605 can mean a function in @xmath606 or a field in @xmath607 .",
    "the greatest integer smaller than or equal to @xmath608 is denoted by @xmath609 .",
    "we define discrete functions @xmath610 on @xmath5 as collections of discrete functions @xmath611 on @xmath0 parametrised by @xmath612\\cap { { \\mathbb n}}$ ] .",
    "discrete functions @xmath610 on @xmath613 and discrete fields @xmath614 are defined similarly .",
    "the associated norms are defined in a natural way ; e.g. , the discrete @xmath615 norm of a discrete function @xmath616 is computed as @xmath617 to treat space - time dependent test functions and fields as in proposition  [ propconsistency ] , one replaces the projection operators @xmath420 ( and its components @xmath618,@xmath619 ) , @xmath620 and @xmath621 by their compositions with @xmath622 .",
    "then the statements and proof of proposition  [ propconsistency ] can be extended in a straightforward way .",
    "also the statements of proposition  [ prop : asymptcompactness ] extend naturally to the time - dependent context ; one only has to replace the statement with the weak @xmath33 convergence statement : @xmath623 as @xmath624 .",
    "it is natural that strong compactness on the space - time cylinder @xmath5 does not follow from a discrete spatial gradient bound alone ; one also needs some control of time oscillations .",
    "it is also well known that this control can be a very weak one ( cf . ,",
    "e.g. , the well - known aubin - lions and simon lemmas ) . in the next section , we give the discrete version of one of these results .",
    "below we state a result that fuses a basic space translates estimate ( for the `` compactness in space '' ) with the kruzhkov @xmath433 time compactness lemma ( see @xcite ) . actually , the kruzhkov lemma is , by essence , a local compactness result . for the sake of simplicity , we state the version suitable for discrete functions that are zero on the boundary ; the corresponding @xmath626\\times \\om)$ ] version can be shown with the same arguments ( cf .",
    "@xcite ) , and this local version can be used for all boundary conditions .",
    "[ prop : kruzhkovlemma ] let @xmath627 be a family of discrete functions on the cylinder @xmath5 corresponding to a family @xmath628 of time steps and to a family @xmath563 of 3d ddfv meshes of @xmath0 as described in section  [ sec : ddfv ] ; we understand that @xmath629 .",
    "assume that @xmath570 } { { \\rm reg}(\\tau_h)}<+\\infty$ ] , where @xmath571 measures the regularity of @xmath572 in the sense and .",
    "assume ( for versions @xmath181 and @xmath182 ) that all primal interfaces @xmath236 for all meshes @xmath572 are triangles . for each @xmath630",
    ", assume that the discrete functions @xmath631 satisfy the discrete evolution equations @xmath632$},\\quad      \\frac{v^{\\pttau_h,{n+1}}-v^{\\pttau_h , n}}{\\delt}=\\div^{\\!\\pttau_h}\\ ,      \\vec \\frond^{\\pttau_h , n+1}+f^{\\pttau_h , n+1}\\ ] ] with some initial data @xmath633 , source terms @xmath634 and discrete fields @xmath635 .    assume that there is a constant @xmath636 such that the following uniform @xmath606 estimates hold : @xmath637 and + @xmath638 assume that the families @xmath639 , @xmath640 are bounded in @xmath204 .",
    "then for any sequence @xmath577 converging to zero there exist @xmath641 such that , extracting if necessary a sub - sequence , @xmath642    notice that we only use the full strength of proposition  [ prop : kruzhkovlemma ] to treat the linearised implicit scheme . for the fully implicit scheme , more traditional ( although not much simpler ) @xmath117 versions of time translation estimates , inspired by the technique of @xcite , can be used ( see @xcite ) .      consider the general situation where @xmath365 is discretised on a ddfv mesh .",
    "moreover , assume that we also need to discretise some scalar function @xmath643 ( in our context , this is the ionic current term @xmath58 ; in general reaction - diffusion systems , @xmath644 may represent reaction terms ) .",
    "then we discretise such reaction term on a 3d ddfv mesh of the kind @xmath182 by taking , for @xmath645 , @xmath646 in other words , @xmath647    with this choice , we have for all @xmath530 and for all @xmath648 , @xmath649 for schemes @xmath181 and @xmath183 , we use similar projection formulas with the expression of @xmath650 given by ; this always leads to the formula @xmath651 by the definition of @xmath650 , the definition of @xmath652 , and jensen s inequality , we get @xmath653    finally , notice that such choice of discretisation of the ionic current term does not enlarge the stencil of the ddfv scheme used for the discretisation of the diffusion .",
    "the proof follows closely the existence proof for problem , , mentioned in section  [ sec : theory - wellposedness ] .",
    "( proof of proposition [ prop : schemeexist ]  uniqueness of a discrete solution ) .",
    "although remark  [ rem : optimization ] can be used to infer the existence and uniqueness of a discrete solution , let us give a proof that contains the essential calculations also utilised in the subsequent steps .",
    "for the uniqueness and the continuous dependence claim we reason as in theorem  [ theo : l^2-contraction ] , omitting the regularisation step .",
    "namely , using for two solutions @xmath654 and @xmath655 , by subtraction we get    @xmath656 \\dsp \\qquad\\quad -(-1)^{i , e}\\ , \\div^\\pttau_{\\!\\!s_{i , e}^{\\pttau , n+1}}[\\,{\\ensuremath{\\mathbf{m}}}_{i , e}^\\pttau \\ ; \\bigl({{\\nabla}}^\\pttau_{\\!g_{i , e}^{\\!\\pttau , n+1 } } u_{i , e}^{\\pttau , n+1 } \\!\\!-\\ ! { { \\nabla}}^\\pttau_{\\!g_{i , e}^{\\!\\pttau , n+1 } } \\hat u_{i , e}^{\\pttau , n+1 } \\bigr)\\ , ] \\,=\\,0 \\end{array}\\ ] ] with @xmath657 , @xmath658 and @xmath659 , @xmath660 for all @xmath27 , we take the scalar product @xmath652 of equations @xmath661 with the discrete functions @xmath662 , respectively ( more precisely , we use the discrete weak formulations with test function @xmath448 )",
    ". then we subtract the relation obtained for @xmath663 from the relation obtained for @xmath664 .",
    "finally , we use the discrete duality property on the divergence terms .",
    "notice that the boundary terms vanish , because both solutions correspond to the same dirichlet and neumann data @xmath665 ; in particular , we can use because @xmath666 further , the terms coming from @xmath25 are @xmath667 .",
    "the outcome of the calculation is the following equality : @xmath668 then we sum over @xmath669 $ ] , @xmath670 . using the convexity inequality @xmath671 , the positivity of @xmath672 and the definition of @xmath673 , using we get @xmath674 then the second term is non negative , and we get from and the discrete gronwall inequality .",
    "in particular , it follows that for fixed initial and boundary data there is uniqueness of @xmath675 for all @xmath676 .",
    "then , returning to , we find out that there is uniqueness for @xmath677 for all @xmath27 .",
    "we conclude the uniqueness of @xmath678 using the discrete poincare inequality ( and , in the case @xmath349 , using condition ) .",
    "( proof of proposition [ prop : schemeexist ]  existence of a discrete solution ) . regarding the question of existence ,",
    "we reason by induction in @xmath27 . using the discrete weak formulation with the test function @xmath679 ,",
    "subtracting the equations obtained for subscripts @xmath664 and @xmath663 , we find @xmath680 then using the condition @xmath681 , property , the cauchy - schwarz inequality and the equivalence of all norms on @xmath185 , we deduce the _ a priori _",
    "estimate @xmath682 the left - hand side allows us to bound the discrete solutions _ a priori _ , if @xmath565 .",
    "the case of pure neumann bc is slightly more delicate .",
    "we take advantage of the above estimate to apply the leray - schauder topological degree theorem .",
    "let us look at the most delicate case @xmath349 .    for @xmath683 $ ] , we consider the initial data @xmath684 , the dirichlet and neumann boundary data @xmath685 and @xmath686 , and the source term @xmath687 .",
    "we consider a family @xmath688 of maps on the space @xmath689 defined as follows .",
    "first , given an element in @xmath690 denoted @xmath691 , introduce the following notation for the expressions in the left - hand side of equations with data scaled by @xmath692 : @xmath693 + h^{\\pttau , n+1 } - \\theta { i_{\\mathrm{app}}}^{\\pttau , n+1 } , \\\\ \\alpha_e^\\theta ( u^{\\pttau,\\delt}):=\\frac{v^{\\pttau , n+1 } - v^{\\pttau , n}}{\\delt } + \\div^\\pttau_{\\!\\!\\theta s_e^{\\pttau , n+1}}[{\\ensuremath{\\mathbf{m}}}_{e}^\\pttau { { \\nabla}}^\\pttau_{\\!\\theta g_e^{\\!\\pttau , n+1 } } u_e^{\\pttau , n+1}]+ h^{\\pttau , n+1 } -\\theta{i_{\\mathrm{app}}}^{\\pttau , n+1 } , \\\\ \\gamma^\\theta ( u^{\\pttau,\\delt}):=v^{\\pttau , n}-(u_i^{\\pttau , n}-u_e^{\\pttau , n } ) ; \\\\ \\end{array}\\ ] ] recall that for the volumes @xmath232 , the convention applies , so that the entry of @xmath694 corresponding to the volumes @xmath232 should be taken equal to @xmath695 , where the diamond @xmath280 is the one with @xmath696 .",
    "then we define @xmath688 as the element of @xmath697 given by @xmath698 .",
    "this definition implies that @xmath688 maps @xmath690 into itself , thanks to the definition of the discrete divergence ( which ensures the consistency of the fluxes ) and to the constraint that is preserved at the discrete level .",
    "with this definition , it is evident that the zeros of @xmath688 are solutions of the scheme with data scaled by @xmath692 .",
    "the estimate that we have just deduced is uniform in @xmath692 ; it provides a uniform in @xmath692 bound on some norm of possible zeros of @xmath688 in @xmath690 . therefore from the leray - schauder theorem and the existence of a trivial zero of @xmath699 we infer existence of a zero for @xmath688 , in particular for @xmath700 .",
    "( estimates of the discrete solution ) .",
    "we make the same calculation as in step 1 , but with @xmath701 set to zero ; and we sum over @xmath702 . using the convexity inequality @xmath671 , the positivity of @xmath672 and the definition of @xmath673 , using we get the identity @xmath703 using the cauchy - schwarz inequality , property , the trace inequality for each components of the solution , and the discrete gronwall inequality , we deduce the following uniform bounds : @xmath704 where @xmath705 depends on @xmath706 , and @xmath707 . as usual , in order to obtain , the case @xmath349 is treated separately , using the normalisation property for @xmath73 , the @xmath15 bound on @xmath18 and the fact that @xmath708 .",
    "( continuous weak formulation for the discrete solutions ) .",
    "we take a test function @xmath709\\times\\bigl(\\om\\!\\cup\\!\\gamma_n\\bigr)\\bigr)$ ] and discretise it as follows : @xmath710 then we use the discrete weak formulation with test function @xmath711 at time level @xmath27 , and sum over @xmath27 .",
    "what we get is @xmath712 the equation for the components @xmath713 is analogous .",
    "we use summation by parts on the first term in , the lipschitz continuity of @xmath714 , the definition of @xmath715 and proposition  [ propconsistency](i ) , to see that this term equals @xmath716 where @xmath717 denotes a generic remainder term such that @xmath718 as @xmath719 .",
    "thanks to , the second term in is merely @xmath720 because the discrete gradients are constant per diamond , thanks to the definition of @xmath721 and to the discrete gradient consistency result of proposition  [ propconsistency](ii ) , the third term in is equal to @xmath722 similarly , thanks to further consistency results , the two last terms in can be rewritten as @xmath723 gathering the above calculations , we end up with the weak form of the discrete equation : @xmath724 the constant @xmath705 depends on the data of the problem , @xmath0 and @xmath470 .",
    "the second equation of the system is analogous , with @xmath725 replaced by @xmath713 and with signs changed accordingly .",
    "( convergences via compactness ) .",
    "all the convergences below are along a sub - sequence of a sequence @xmath726 of time steps and meshes with @xmath727 tending to zero as @xmath728 . in what follows",
    ", we drop the subscripts `` @xmath729 '' in the notation ; indeed , after the identification of the limits , the uniqueness of a solution to problem  , , will permit to suppress the extraction argument .    from and the compactness results in sections  [ ssec : w1p ] ,  [ ssec : time - dep ]",
    ", we readily find that @xmath730 as @xmath719 ; and @xmath731 . because @xmath732 , analogous convergences hold for @xmath450 and its discrete gradient , the corresponding limits being @xmath733 and @xmath734 , respectively .    moreover ,",
    "if @xmath735 , @xmath736 , we can use the compactness result of section  [ ssec : compl^1q ] and infer the strong convergence of @xmath737 in @xmath140 ; by the preceding remark , the limit is identified with @xmath18 . in the case of other boundary conditions , we use the local version of proposition  [ prop : kruzhkovlemma ] ( shown in @xcite for traditional finite volume schemes ; the adaptation to ddfv schemes is straightforward ) . up to now",
    "we only have the @xmath738 convergence of @xmath737 to @xmath18 . in both cases , the uniform up - to - the - boundary estimate and the interpolation argument yield the strong convergence of @xmath737 to @xmath18 in @xmath739 , for all @xmath740 , and the weak @xmath94 convergence .",
    "in particular , thanks to the growth assumption on @xmath58 we have @xmath741    ( passage to the limit in the continuous weak formulation ) . in view of the properties , of step 5 ,",
    "the passage to the limit in and the corresponding equation for @xmath713 is straightforward .",
    "we conclude that the limit triple @xmath742 of @xmath743 is a weak solution of problem  , , . in view of the uniqueness of a weak solution",
    ", we can bypass the  extraction of a sub - sequence \" part in step 5 .",
    "this ends the convergence proof .",
    "( strong convergences ) .",
    "we will prove that the functions @xmath744 and their discrete gradients converge strongly to @xmath35,@xmath44 , respectively , in @xmath15 , while @xmath450 converges strongly to @xmath18 in @xmath94 . to this end , we will utilise monotonicity arguments to improve the weak convergences to the strong ones .    by the established weak convergences and the strong @xmath117 convergence of @xmath745 and ( for version @xmath183 ) of @xmath746 to @xmath100 , we get @xmath747 & \\qquad\\qquad = \\frac{1}{2}\\int_\\om |v^0|^2+\\iint_q { i_{\\mathrm{app}}}\\,v + \\int_0^t\\!\\!\\int_{\\gamma_n } \\bigl(s_i u_i+s_e u_e   \\bigr ) .",
    "\\label{eq : equal - limits}\\end{aligned}\\ ] ] first , as in step 2 , take the discrete solutions @xmath748 as test functions in the discrete equations and subtract the resulting identities . next , with the help of the regularisation lemma  [ lem : regularisation ] , take @xmath35 as test functions in the two equations of the system , and subtract the resulting identities .",
    "comparing the two relations with the help of , using in addition inequality , we infer @xmath749    furthermore , let us assume for simplicity that @xmath750 , @xmath751 ( which means that @xmath752 and @xmath753 , so that the fatou lemma can be used ) ; to treat the general case , use the test function @xmath754 in order to absorb the terms containing @xmath755 into the term @xmath756 .    by the fatou lemma and properties of weak convergence ( with respect to weighted vector - valued @xmath15 spaces with weights the matrices @xmath757 ) ,",
    "we conclude that the above inequality is actually an equality .",
    "using the fact that weak convergence plus convergence of norms yields strong convergence in uniformly convex banach spaces , using an easy refinement of the fatou lemma   \\;\\ ; \\longrightarrow \\;\\ ; \\biggl[\\ ; f_n\\to f   \\text{\\;in $ l^1(\\om)$ } \\text{\\;as $ n\\to\\infty$ } \\;\\biggr]$ ] . ]",
    "( convergence of the integrals implies the strong convergence ) , we conclude that @xmath758 using the lower bound in and the vitali theorem , we infer that @xmath759 converges to @xmath760 , thus the weak @xmath94 convergence of @xmath737 to @xmath18 is upgraded to the claimed strong convergence .",
    "finally , the strong @xmath15 convergence of the discrete gradients of @xmath744 ensures a uniform estimate on their translates in time : @xmath761 then the discrete poincar inequality yields a uniform control of the @xmath15 time translates @xmath762 of @xmath744 ( here we also use the uniform time translates of the discrete dirichlet data @xmath763 ; as usual , the case @xmath349 is treated separately ) .",
    "because we can control the space translates of @xmath744 through the uniform @xmath15 estimate of @xmath764 ( see section  [ ssec : poincaresobolev ] ) , we conclude that @xmath744 converge strongly in @xmath15 to to @xmath35 .",
    "[ rem : strong - convergences]under some stronger proportionality assumptions on the meshes , consistency properties similar to those of proposition  [ propconsistency](i),(ii ) hold not only for test functions , but also for functions in @xmath33 ( cf .",
    "@xcite ) . using the argument of @xcite",
    ", we conclude that the discrete solution @xmath744 converges strongly in @xmath101 to @xmath35 . indeed , from the discrete poincar inequality we derive the estimate @xmath765 and analogous estimates on the meshes @xmath360 and ( for version @xmath183 ) @xmath361 .",
    "then the consistency and strong convergence of the discrete gradients imply the desired result : we find @xmath766 as @xmath719 , and so forth .",
    "we follow step by step the preceding proof and indicate the modifications needed to take into account the linearised - implicit treatment of the ionic current term .",
    "we notice that throughout the calculations of the preceding proof , @xmath767 where we have set @xmath768 for @xmath769 $ ] , and by @xmath770 we mean the function @xmath771 .    .",
    "we can not get the continuous dependence with the same technique , but by induction , we get uniqueness .",
    "indeed , as soon as the uniqueness of @xmath772 is justified , we have @xmath773 this inequality plays the same role as the non - negativity of the second term in .    .",
    "the arguments are unchanged , except for .    . the estimates and remain true",
    "notice that the function @xmath774 is non - negative .",
    "therefore the estimate is replaced by the following one : @xmath775 now we use new arguments .",
    "namely the discrete sobolev embedding inequality of section  [ ssec : poincaresobolev ] yields a uniform @xmath776 bound on @xmath450 ; then interpolation with the @xmath777 bound ensures that @xmath778    . the main difference is the way we ensure the strong @xmath140 convergence of @xmath450 and the weak @xmath140 convergence of the associated ionic current term @xmath779 it is sufficient to treat the nonlinear part of @xmath780 ;",
    "thus we can `` forget '' about the two last terms in .",
    "let us first notice that the definition of @xmath774 and the growth bound on @xmath58 imply that for some constant @xmath781 we have @xmath782 then the assumption @xmath783 made in theorem  [ th : convergence](ii ) and the uniform @xmath784 bound on @xmath450 ensure the equi - integrability of the functions @xmath785 on @xmath4 . now for any measurable set @xmath786 , for all @xmath787 , @xmath788 thus estimate and the aforementioned equi - integrability of @xmath785 ensure the equi - integrability of the ionic current term @xmath780 .",
    "in particular , from we infer @xmath140 bounds on the components of the discrete function @xmath789 : @xmath790 for version @xmath183 , the term on @xmath361 is also controlled . at this stage , the full strength of proposition  [ prop : kruzhkovlemma ] is put into service : indeed , we only have the @xmath433 control of the right - hand side of the discrete evolution equations .",
    "we infer the strong @xmath140 convergence ( along a sub - sequence ) for @xmath450 . then from the vitali theorem and the fact that @xmath791 in @xmath140 and a.e . , we get the strong convergence of @xmath780 to @xmath20 .    .",
    "the arguments remain unchanged , taking into account .",
    "for the numerical simulations , the bidomain problem is reformulated in terms of @xmath18 and @xmath73 only ; the elimination of @xmath792 , thanks to the relation @xmath10 , decreases the number of unknowns per primal / dual volume from three to two .    in terms of @xmath18 and @xmath73 ,",
    "the parabolic type problem is turned into the following elliptic - parabolic problem : @xmath793= { i_{\\mathrm{app}}}\\qquad ( t , x)\\in q.      \\end{split }      \\right.\\ ] ] for @xmath794 , problem is equivalent to the original problem ; indeed , the first line in results from the summation of the two lines in , with @xmath795 .",
    "the bidomain problem will be considered under formulation throughout this section .",
    "we point out that numerical schemes associated with formulation are equivalent with numerical schemes for the formulation , following the same algebraic operations on the discrete equations .",
    "a scaling parameter @xmath796 has also been introduced in .",
    "its presence clearly makes no difference for the mathematical study of the previous sections , but it greatly helps the solutions of to behave as excitation potential waves ( which waves is supposed to model ) .",
    "more precisely , following the analysis in @xcite , such a scaling parameter together with a cubic shape for @xmath17:=v(v-1)(v-\\alpha)$ ] provide a simplified model for spreading of excitation in the myocardium ; the parameters @xmath796 and @xmath797 have been set respectively to 1/50 and 0.2 .",
    "the way excitation waves are generated is detailed in subsection [ subsec : num - settings ] .    the convergence of the ddfv space discretisations for the bidomain problem has been justified in theorem  [ th : convergence ] for two different discretisations ( the fully implicit in time and the linearised semi - implicit one ) of the ionic current term .",
    "here we complement these theoretical studies by the numerical experiments on the third ( and the most important in practise ) case of fully explicit in time discretisation of the ionic current term .",
    "the implementation of the scheme is detailed in section  [ subsec : num - implem ] .",
    "although the theoretical study of this scheme is made difficult for technical reasons , we do observe convergence numerically .",
    "the convergence result in theorem [ th : convergence ] involves a comparison between the exact solution and the discrete solution in the @xmath15 norm , the discrete solution being interpreted as the weighted sum of two piecewise constant functions ( on the primal and on the dual cells ) . the practical computation of this @xmath117 distance is difficult .",
    "namely , a ( coarse ) numerical solution on a given ( coarse ) mesh has to be compared with a second ( reference ) numerical solution computed on a reference mesh aimed to reproduce the exact solution , unknown in practise .",
    "the reference mesh will not be here a refinement of the coarse one , thus the precise computation of an @xmath117 norm between the coarse and the reference numerical solutions , thought as piecewise constant functions , is an awful task .",
    "therefore we use a slightly different convergence indicator , as presented in section  [ subsec : num - results ] .",
    "the quantity provides a more convenient measure of the square of the @xmath15 norm .",
    "the convergence with respect to this variant of discrete @xmath117 norm will be studied here . notice that under reasonable regularity assumptions on the mesh , the two discrete @xmath117 norms are equivalent .",
    "convergence will be studied both in 2d and in 3d .",
    "the introduction of the two dimensional case is mostly intended to confirm the results in dimension three : because of the numerical facilities in dimension two ( smaller growth of the problem size under refinement ) , it allows a deeper insight into the asymptotic behaviours .",
    "problem is considered for a reaction term @xmath62 $ ] set on the domain @xmath798^d$ ] , @xmath799 denoting the space dimension .",
    "we consider solutions under the form of excitation potential waves spreading from the domain centre towards its boundary , as depicted in figure [ fig:2d - prop ] in the two dimensional case , relatively to some medium anisotropy detailed below .",
    "the transmembrane potentials @xmath800 and @xmath801 have been recorded at the same times , namely @xmath802 , for @xmath803 unit of time , @xmath804 and @xmath805 .",
    "the corresponding numerical solutions are denoted @xmath806 and @xmath807 .",
    "a relative error in the @xmath15 norm between @xmath800 and @xmath801 is introduced as follows : @xmath808    numerical results are given in table [ tab : space - time - conv ] : convergence both in 2d and in 3d is observed .",
    "the two dimensional case results indicate an order two convergence relatively to the mesh size . as in the first test case ,",
    "such a conclusion is not possible in the three dimensional case : a much finer reference mesh ( not affordable ) would be needed .",
    "colli franzone , l.  guerri , and s.  tentoni . mathematical modeling of the excitation process in myocardial tissue : influence of fiber rotation on wavefront propagation and potential field .",
    "( 2):155235 , 1990 .",
    "p. colli franzone and g. savar . .",
    "in _ evolution equations , semigroups and functional analysis ( milano , 2000 ) _ , volume  50 of _ progr .",
    "nonlinear differential equations appl .",
    "_ , pp . 4978 .",
    "birkhuser , basel , 2002 .",
    "k. domelevo , s. delcourte and p. omnes .",
    "discrete - duality finite volume method for second order elliptic equations , in : f. benkhaldoun , d. ouazar , s. raghay ( eds . ) , , hermes science publishing , 2005 , pp . 447458 .",
    "r.  eymard , t.  gallout , and r.  herbin .",
    "discretisation of heterogeneous and anisotropic diffusion problems on general non - conforming meshes .",
    "sushi : a scheme using stabilisation and hybrid interfaces , ( doi:10.1093/imanum / drn084 ) , 2009 ."
  ],
  "abstract_text": [
    "<S> we prove convergence of discrete duality finite volume ( ddfv ) schemes on distorted meshes for a class of simplified macroscopic bidomain models of the electrical activity in the heart . </S>",
    "<S> both time - implicit and linearised time - implicit schemes are treated . </S>",
    "<S> a short description is given of the 3d ddfv meshes and of some of the associated discrete calculus tools . </S>",
    "<S> several numerical tests are presented . </S>"
  ]
}