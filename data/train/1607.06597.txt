{
  "article_text": [
    "the classical sylvester - gallai theorem states that any finite non - collinear point set in @xmath7 spans at least one _ ordinary line _ ( a line containing exactly two of the points ) .",
    "a more sophisticated statement is the so - called dirac - motzkin conjecture , according to which every non - collinear set of @xmath8 points in @xmath7 determines at least @xmath9 ordinary lines .",
    "this conjecture was proved by green and tao @xcite for all sufficiently large @xmath1 .",
    "their proof was based on a structure theorem , which roughly states that any point set with a linear number of ordinary lines must lie mostly on a cubic curve ( see theorem [ thm : gt ] for a precise statement ) .",
    "it is natural to ask the corresponding question for _ ordinary circles _ ( circles that contain exactly three of the given points ) ; see for instance @xcite*section  7.2 or @xcite*chapter  6 .",
    "elliott @xcite introduced this question in 1967 , and proved that any @xmath1 points , not all on a line or a circle , determine at least @xmath10 ordinary circles .",
    "( throughout the paper , by @xmath11 we mean a function @xmath12 such that @xmath13 for some constant @xmath14 and all sufficiently large @xmath1 .",
    "thus , @xmath15 is a function @xmath12 satisfying @xmath16 for sufficiently large @xmath1 . ) he suggested , cautiously , that the optimal bound is @xmath17 .",
    "elliott s result was improved by blintov and blint @xcite*remark , p.  288",
    "to @xmath18 , and zhang @xcite obtained @xmath19 .",
    "zhang also gave constructions of point sets on two concentric circles with @xmath2 ordinary circles .",
    "we will use the results of green and tao to prove that @xmath20 is asymptotically the right answer , thus disproving the bound suggested by elliott @xcite .",
    "nassajian mojarrad and de zeeuw proved this bound in an earlier preprint @xcite , which is subsumed by this paper , and will not be published independently .",
    "we will find the exact minimum number of ordinary circles , for sufficiently large @xmath1 , and we will determine which configurations attain or come close to that minimum .",
    "we make no attempt to specify the threshold implicit in the phrase ` for sufficiently large @xmath1 ' ; any improvement would depend on an improvement of the threshold in the result of green and tao @xcite . for small @xmath1 , the bound @xmath21 due to",
    "zhang @xcite remains the best known lower bound on the number of ordinary circles .",
    "green and tao @xcite also solved ( for large @xmath1 ) the even older _ orchard problem _ , which asks for the exact maximum number of lines passing through exactly three points of a set of @xmath1 points in the plane .",
    "we refer to @xcite for the history of this problem .",
    "the upper bound @xmath22 is easily proved by double counting , but it is not the exact maximum . using group laws on certain cubic curves , one can construct @xmath1 non - collinear points with @xmath23 @xmath24-point lines , and green and tao @xcite proved ( for large @xmath1 ) that this is optimal .",
    "this does not follow directly from the dirac - motzkin conjecture , but it does follow from the above - mentioned structure theorem of green and tao for sets with few ordinary lines ( theorem [ thm : gt ] ) .",
    "the analogous orchard problem for circles asks for the maximum number of circles passing through exactly four points from a set of @xmath1 points .",
    "as far as we know , this question has not been asked before .",
    "we determine the exact maximum and the extremal sets for all sufficiently large @xmath1 .",
    "our first main result concerns the minimum number of ordinary circles spanned by a set of @xmath1 points , not all lying on a line or a circle , and the structure of sets of points that come close to the minimum .",
    "the first part of the theorem solves problem  6 in @xcite*section  7.2 .",
    "[ thm : main ]    1 .",
    "[ parti ] if @xmath1 is sufficiently large , the minimum number of ordinary circles determined by @xmath1 points in @xmath7 , not all on a line or a circle , equals @xmath25 2 .",
    "let @xmath26 be sufficiently large . if a set @xmath0 of @xmath1 points in @xmath7 determines fewer than @xmath27 ordinary circles , then @xmath0 lies on the disjoint union of two circles , or the disjoint union of a line and a circle .    in section  [ sec :",
    "constr ] , we will describe constructions that meet the lower bound in part  [ parti ] of theorem [ thm : main ] . for even @xmath1 ,",
    "the bound in part  [ parti ] is attained by certain constructions on the disjoint union of two circles , while for odd @xmath1 , the bound is attained by constructions on the disjoint union of a line and a circle .",
    "the main tools in our proof are circle inversion and the structure theorem of green and tao @xcite for sets with few ordinary lines , together with some classical results about algebraic curves and their interaction with inversion .",
    "let us define a _",
    "generalised circle _ to be either a circle or a line .",
    "because inversion maps circles and lines to circles and lines , it turns out that in our proof it is more natural to work with generalised circles .",
    "alternatively , we could phrase our results in terms of the _ inversive plane _ ( or _ riemann sphere _ )",
    "@xmath28 , where @xmath29 is a single point that lies on all lines , which can then also be considered as circles .",
    "yet another equivalent view would be to identify the inversive plane with the sphere @xmath30 via stereographic projection , and consider circles on @xmath30 , which are in bijection with generalised circles .",
    "all our statements about generalised circles in @xmath7 could thus be formulated in terms of circles in @xmath28 or on  @xmath30 .",
    "we define an _ ordinary generalised circle _ to be one that contains three points from a given set .",
    "our proof of theorem [ thm : main ] proceeds via an analogous theorem for ordinary generalised circles , which turns out to be somewhat easier to obtain .",
    "[ thm : ordgencircles ]    1 .",
    "if @xmath1 is sufficiently large , the minimum number of ordinary generalised circles determined by @xmath1 points in @xmath7 , not all on a generalised circle , equals @xmath31 2 .",
    "[ genpartii ] let @xmath26 be sufficiently large .",
    "if a set @xmath0 of @xmath1 points in @xmath7 determines fewer than @xmath27 ordinary generalised circles , then @xmath0 lies on two disjoint generalised circles .",
    "we also solve the analogue of the orchard problem for circles ( for sufficiently large @xmath1 ) .",
    "we define a _ @xmath32-point generalised circle _ to be a ( generalised ) circle that passes through exactly four points of a given set of @xmath1 points .",
    "the ` circular cubics ' in part  [ genpartii ] will be defined in section [ sec : circularcurves ] .",
    "[ thm : orchard ]    1 .",
    "if @xmath1 is sufficiently large , the maximum number of @xmath32-point generalised circles determined by a set of @xmath1 points in @xmath7 is equal to @xmath33 2 .",
    "let @xmath26 be sufficiently large . if a set @xmath0 of @xmath1 points in @xmath7 determines more than @xmath34 @xmath32-point generalised circles , then up to inversions , @xmath0 lies on an ellipse or a smooth circular cubic .",
    "theorem  [ thm : orchard ] remains true if we replace ` generalised circles ' by ` circles ' .",
    "this is because we can apply an inversion to any set of @xmath1 points with a maximum number of generalised circles in such a way that all straight - line generalised circles become circles .",
    "therefore , the maximum is also attained by circles only .",
    "the proofs of the above theorems are based on the following structure theorems in the style of green and tao @xcite .",
    "the first gives a rough picture , by stating that a point set with relatively few ordinary generalised circles must lie on a bicircular quartic , a specific type of algebraic curve of degree four that we introduce in section [ sec : circularcurves ] .",
    "[ thm : weak ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 . if a set @xmath0 of @xmath1 points in @xmath7 spans at most @xmath5 ordinary generalised circles , then all but at most @xmath6 points of @xmath0 lie on a bicircular quartic .",
    "ball @xcite concurrently obtained a similar result as a consequence of a structure theorem for ordinary planes in @xmath36 .",
    "he shows that @xmath1 points with @xmath37 ordinary circles must lie mostly on a quartic curve .",
    "we define bicircular quartics in section [ sec : circularcurves ] ; they can be reducible , so in theorem [ thm : weak ] the set @xmath0 may also lie mostly on a lower - degree curve contained in a bicircular quartic .",
    "our proof actually gives a more precise list of possibilities .",
    "the curve that @xmath0 mostly lies on can be : a line ; a circle ; an ellipse ; a line and a disjoint circle ; two disjoint circles ; a circular cubic that is acnodal or smooth ; or a bicircular quartic that is an inverse of an acnodal or smooth circular cubic .    a more precise characterisation of the possible configurations with few ordinary generalised circles is given in the following theorem .",
    "the group structures referred to in the theorem are defined in section  [ sec : groups ] ; the circular points at infinity ( @xmath38 and @xmath39 ) referred to in case  [ caseiii ] are introduced in section [ sec : circularcurves ] ; and the ` aligned ' and ` offset ' double polygons are defined in section  [ sec : constr ] .",
    "[ thm : strong ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 .",
    "if a set @xmath0 of @xmath1 points in @xmath7 spans at most @xmath5 ordinary generalised circles , then up to inversions and similarities , @xmath0 differs in at most @xmath6 points from a configuration of one of the following types :    1 .",
    "[ casei ] a subset of a line ; 2 .",
    "[ caseii ] a subgroup of an ellipse ; 3 .",
    "[ caseiii ] a coset @xmath40 of a subgroup @xmath41 of a smooth circular cubic , for some @xmath42 such that @xmath43 , where @xmath38 and @xmath39 are the two circular points at infinity ; 4 .",
    "[ caseiv ] a double polygon that is ` aligned ' or ` offset ' .",
    "conversely , every set of these types defines at most @xmath44 ordinary generalised circles .    in section",
    "[ sec : circularcurves ] , we carefully introduce circular cubics and bicircular quartics , and show their connection to inversion . in section [ sec : groups ] , we define group laws on these curves , which help us construct point sets with few ordinary ( generalised ) circles in section [ sec : constr ] . in section [ sec :",
    "proof ] , which forms the core of our proof , we derive theorems [ thm : weak ] and [ thm : strong ] from the structure theorem of green and tao @xcite . in section [ sec : extremal ] , we combine the structure theorems with our analysis of the constructions from section [ sec : constr ] to establish the precise statements in theorems [ thm : main ] , [ thm : ordgencircles ] , and [ thm : orchard ] .",
    "the key tool in our proof is _ circle inversion _ , as it was in the earlier papers @xcite on the ordinary circles problem ; the first to use circle inversion in sylvester - gallai problems was motzkin @xcite .",
    "the simple reason for the relevance of circle inversion is that if we invert in a point of the given set , an ordinary circle through that point is turned into an ordinary line .",
    "thus we can use results on ordinary lines , like those of green and tao @xcite , to deduce results about ordinary circles . to do this successfully , we need a thorough understanding of the effect of inversion on algebraic curves , and in particular we need to introduce the special class of _ circular curves_.      in this subsection , we work in the real projective plane @xmath45 , and partly in the complex projective plane @xmath46 .",
    "see for instance @xcite*appendix a for an appropriate introduction to projective geometry .",
    "we use the homogeneous coordinates @xmath47 $ ] for points in @xmath45 or @xmath46 , and we think of the line with equation @xmath48 as the line at infinity . an affine algebraic curve in @xmath7 , defined by a polynomial @xmath49 $ ] ,",
    "can be naturally extended to a projective algebraic curve , by taking the zero set of the homogenisation of @xmath50 .",
    "this curve in @xmath45 then extends to @xmath46 , by taking the complex zero set of the homogenised polynomial .",
    "an algebraic curve in @xmath45 is _ circular _ if it contains @xmath38 and @xmath39 . for @xmath52 , an algebraic curve in @xmath45",
    "is _ @xmath53-circular _ if it has singularities of multiplicity at least @xmath53 at both @xmath38 and @xmath39 .",
    "a classical reference for circular curves is johnson @xcite , while a more modern one is werner @xcite .",
    "let us make the definition more explicit in three concrete cases .    a _ generalised circle _",
    "is an algebraic curve of degree two that contains @xmath38 and @xmath39 ; equivalently , it is a curve in @xmath45 defined by a homogeneous polynomial of the form @xmath54 where @xmath55 , and @xmath56 $ ] is a non - trivial linear form . if @xmath57 , then the curve is a circle , while if @xmath58 , the curve is the union of a line with the line at infinity .",
    "a _ circular cubic _ is an algebraic curve of degree three that contains @xmath38 and @xmath39 ; equivalently , it is any curve in @xmath45 defined by a homogeneous polynomial of the form @xmath59 where @xmath60 , and @xmath61 $ ] is a non - trivial quadratic homogeneous polynomial .",
    "note that we do not require a circular cubic to be irreducible or smooth .",
    "for instance , the union of a line and a circle is a circular cubic , and so is the union of any conic with the line at infinity ( take @xmath62 in ) .    a _",
    "bicircular quartic _ is an algebraic curve of degree four that is @xmath63-circular ; equivalently , it is any curve in @xmath45 defined by a homogeneous polynomial of the form @xmath64 where @xmath65 , and @xmath61 $ ] is a non - trivial homogeneous quadratic polynomial ( see @xcite*section 8.2 for a proof that a quartic is @xmath63-circular if and only if its equation has the form ) .",
    "a noteworthy example of a bicircular quartic is a union of two circles , for which it is easy to see that the curve has double points at @xmath38 and @xmath39 , since both circles contain those points .",
    "every circular cubic is contained in a bicircular quartic , since for @xmath58 in we get a union of a circular cubic and the line at infinity .",
    "a non - circular conic is also contained in a bicircular quartic , since for @xmath66 in we get a union of a conic and @xmath67 , which is a double line at infinity .",
    "[ def : circular ] the _ circular degree _ of an algebraic curve @xmath68 in @xmath45 is the smallest @xmath53 such that @xmath68 is contained in a @xmath53-circular curve of degree @xmath69 .    the circular degree is well - defined , since given any curve @xmath68 of degree @xmath53 , we can add @xmath53 copies of the line at infinity , to get a @xmath53-circular curve of degree @xmath69 .",
    "for example , a line has circular degree one , since its union with the line at infinity is a @xmath70-circular curve of degree two .",
    "a conic that is not a circle has circular degree two , since its union with two copies of the line at infinity is a @xmath63-circular curve of degree four .",
    "similarly , a circular cubic has circular degree two , since its union with the line at infinity is a @xmath63-circular curve of degree four .",
    "we can thus classify curves of low circular degree as follows :    * _ circular degree one _ : lines and circles ( that is , generalised circles ) ; * _ circular degree two _ : non - circular conics , circular cubics , and bicircular quartics ; * _ circular degree three _ : non - circular cubics , circular quartics , @xmath63-circular quintics , and @xmath24-circular sextics .",
    "this classification is important to us , because we will see that circular degree is invariant under inversion .",
    "we have defined circular curves and circular degrees in the projective plane , because that is their most natural setting . in the rest of the paper , to avoid confusion between the projective and inversive planes , we will use these notions for curves in @xmath7 , with the understanding that to inspect the definitions we should consider @xmath45 and @xmath46 .",
    "circular curves are intimately related to circle inversion , which we now introduce .",
    "a general reference is @xcite .",
    "[ def : inversion ] let @xmath71 be the circle with centre @xmath72 and radius @xmath73 .",
    "the _ circle inversion _ with respect to @xmath71 is the mapping @xmath74 defined by @xmath75 for @xmath76 .",
    "we write @xmath77 for @xmath78 .",
    "we call @xmath79 the _ centre _ of the inversion @xmath80 .    in the inversive plane @xmath81 , the inversion map can be completed by setting @xmath82 and @xmath83 , so that inversions take generalised circles to generalised circles .",
    "the group of transformations of the inversive plane generated by the inversions and the similarities is called the inversive group .",
    "it is known that a bijection of the inversive plane that takes generalised circles to generalised circles has to be an element of this group , and that any element of this group is either a similarity or an inversion followed by an isometry @xcite*theorem  6.71 .",
    "the image of an algebraic curve in @xmath7 under an inversion is also an algebraic curve , in the following sense .    for any algebraic curve @xmath68",
    "there is an algebraic curve @xmath84 such that @xmath85 we refer to @xmath84 as the _ inverse of @xmath68 with respect to the circle @xmath71 _ , and abuse notation slightly by writing @xmath86 . also , since for different choices of radius @xmath87 , @xmath88 differs only by a dilatation in @xmath79 , we will often only consider the inverse @xmath89 and refer to it as the _ inverse of @xmath68 in the point @xmath79_.",
    "if a curve has degree @xmath90 , then its inverse has degree at most @xmath91 @xcite*theorem 4.14 . if @xmath68 is irreducible , then its inverse is also irreducible .",
    "note that inverses of algebraic curves can behave somewhat unintuitively ; for instance , proposition [ prop : ellipseandacnodal ] states that the inverse of an ellipse has an isolated point , which is surprising if one thinks of an ellipse as just a closed continuous curve .",
    "it is well known that the inverses of generalised circles are again generalised circles .",
    "it turns out that , more generally , circular degree is preserved under inversion .",
    "we now make precise what this means for curves of low circular degree .",
    "a proof can be found in the classical paper @xcite ; for a more modern reference , see @xcite*section 9.2 .",
    "[ lem : inversion ] let @xmath92 be a curve of circular degree @xmath53 .",
    "then :    1 .",
    "the inverse of @xmath93 in a point on @xmath93 is a line ; the inverse of @xmath93 in a point not on @xmath93 is a circle .",
    "[ inversion - case2 ] the inverse of @xmath94 in a singular point on @xmath94 is a non - circular conic ; the inverse of @xmath94 in a regular point on @xmath94 is a circular cubic ; the inverse of @xmath94 in a point not on @xmath94 is a bicircular quartic .",
    "[ inversion - case3 ] the inverse of @xmath95 in a singularity of multiplicity three is a non - circular cubic ; the inverse of @xmath95 in a singularity of multiplicity two is a circular quartic ; the inverse of @xmath95 in a regular point on @xmath95 is a @xmath63-circular quintic ; the inverse of @xmath95 in a point not on @xmath95 is a @xmath24-circular sextic .",
    "one particular subcase of case  [ inversion - case2 ] will play an important role in our paper , and we state it separately in proposition [ prop : ellipseandacnodal ] .",
    "a proof can be found in @xcite*p .",
    "let us recall that an _",
    "acnodal cubic _ is a singular cubic with a singularity that is an isolated point ; for example , @xmath96 is an acnodal circular cubic with a singularity at the origin .",
    "[ prop : ellipseandacnodal ] the inverse of an ellipse in a point on the ellipse is an acnodal circular cubic with the centre of inversion as its singularity ; the inverse of an acnodal circular cubic in its singularity is an ellipse through the singularity .",
    "for example , the inverse of the cubic @xmath96 in its singularity at the origin is the ellipse @xmath97 .",
    "the extremal configurations in our main theorems are all based on group laws on certain circular curves .",
    "it is well - known that irreducible smooth cubics ( elliptic curves ) have a group law ( see for instance @xcite ) .",
    "these groups play a crucial role in the work of green and tao @xcite .",
    "the reason that these groups are relevant to ordinary lines is the following collinearity property of this group ( when defined in the standard way ) .",
    "three points on the curve are collinear if and only if in the group they sum to the identity element . for this property to hold",
    ", the identity element must be an inflection point . here",
    "we will define a group in a slightly different way ( described for instance in @xcite*section 1.2 ) , in which the identity element is not necessarily an inflection point , and the same collinearity property does not hold .",
    "however , for circular cubics , we show that we can choose the identity element so that we get a similar property for concyclicity .",
    "first let @xmath68 be any irreducible cubic , write @xmath98 for its set of regular points , and pick an arbitrary point @xmath99 .",
    "we describe an additive group operation @xmath100 on the set @xmath98 for which @xmath101 is the identity element .",
    "the construction is depicted in figure  [ fig : cir_elliptic ] .",
    "fig1 ( 75,84)@xmath101 ( 6.5,40.5)@xmath102 ( 44,39)@xmath103 ( 81.5,37.5)@xmath104 ( 77.8,65)@xmath105 ( 73.5,13.4)@xmath106 ( 44.7,28.2)@xmath107    given @xmath108 , let @xmath104 be the third intersection point of @xmath68 and the line @xmath109 , and define @xmath105 to be @xmath110 , the third intersection point of @xmath68 and the line through @xmath104 and @xmath101 . when @xmath111 , the line @xmath109 should be interpreted as the tangent line at @xmath102 ; when @xmath112 , the line through @xmath104 and @xmath101 should be interpreted as the tangent line to @xmath68 at @xmath101 .",
    "we refer to @xcite for a more careful definition and a proof that this operation really does give a group .    now consider a circular cubic @xmath68 .",
    "since the circular points @xmath38 and @xmath39 lying on it are conjugate , @xmath68 has a unique real point on the line at infinity , which we choose as our identity element @xmath101 .",
    "we define the point @xmath106 to be the third intersection point of the tangent line to @xmath68 at @xmath101 ( if there is no third intersection point , then @xmath101 is an inflection point , and we consider @xmath101 itself to be the third point ) . throughout this paper",
    "we will use @xmath106 to denote this special point on a circular cubic ; note that @xmath106 is not fixed like @xmath38 and @xmath39 , but depends on @xmath68 . also note that @xmath106 is real , since it corresponds to the third root of a real cubic polynomial whose other two roots correspond to the real point @xmath101 .",
    "observe that @xmath113 since @xmath114 , and by definition @xmath115 .    with this group law",
    ", we no longer have the property that three points are collinear if and only if they sum to @xmath101 ( unless @xmath101 happens to be an inflection point ) .",
    "nevertheless , one can check that three points @xmath116 are collinear if and only if @xmath117 .",
    "more important for us , four points of @xmath98 lie on a generalised circle if and only if they sum to @xmath106 .",
    "this amounts to a classical fact ( see @xcite*article 225 for an equivalent statement ) , but we include a proof for completeness .",
    "we use the following version of the cayley - bacharach theorem , due to chasles ( see @xcite ) .",
    "[ thm : cb ] suppose two cubic curves in @xmath118 with no common component intersect in nine points , counting multiplicities .",
    "if @xmath68 is another cubic curve containing eight of these intersection points , counting multiplicities , then @xmath68 also contains the ninth .",
    "recall from section  [ sec : circularcurves ] that a generalised circle , viewed projectively , is either a circle , or the union a line with the line at infinity .",
    "[ prop : cir_elliptic ] let @xmath68 be an irreducible circular cubic in @xmath45 , and let @xmath119 be points that are not necessarily distinct . a generalised circle intersects @xmath68 in the points @xmath120 ( taking into account multiplicity ) if and",
    "only if @xmath121 .",
    "we consider the cubic @xmath68 extended to @xmath46 .",
    "we first show the forward direction .",
    "all statements in the proof should be considered with multiplicity .    if the generalised circle is the union of a line @xmath122 and the line at infinity @xmath123 , then @xmath124 intersects @xmath68 in @xmath125 .",
    "since @xmath122 intersects @xmath68 in at most three points , one of the points @xmath120 must equal @xmath101 , say @xmath126 .",
    "since @xmath123 also intersects @xmath68 in at most three points , we must have @xmath127 .",
    "thus @xmath128 are collinear , and we have @xmath129 , by the definition of the group law .",
    "it then follows from @xmath126 that @xmath121 .",
    "suppose next that the generalised circle is a circle @xmath130 , and intersects @xmath68 in @xmath125 .",
    "the construction that follows is depicted in figure  [ fig : cb ] .",
    "fig2 ( 48,78)asymptote ( 23,56)@xmath102 ( 50,54.5)@xmath103 ( 55.5,31.2)@xmath131 ( 15,45)@xmath130 ( 1,58)@xmath132 ( 82.2,52)@xmath104 ( 86,78)@xmath133 ( 75.1,30.5)@xmath105 ( 1,23.5)@xmath134 ( 21.4,27.1)@xmath135    let @xmath133 be the line through @xmath101 and @xmath104 ( and thus through @xmath105 ) , @xmath132 the line through @xmath102 and @xmath103 ( and thus through @xmath104 ) , and @xmath134 the line through @xmath131 and @xmath105 .",
    "note that @xmath130 and @xmath136 intersect in @xmath38 and @xmath39 .",
    "then @xmath137 and @xmath138 are two cubic curves that intersect in nine points , of which the eight points @xmath102 , @xmath103 , @xmath131 , @xmath104 , @xmath105 , @xmath101 , @xmath38 , and @xmath39 certainly lie on @xmath68 ; the remaining point is the third intersection point of @xmath139 and @xmath140 beside @xmath131 and @xmath141 , which we denote by @xmath142 . by theorem",
    "[ thm : cb ] , @xmath68 contains @xmath142 . by the group law on @xmath68 , we have @xmath143 .",
    "moreover , @xmath142 must be the sixth intersection point of @xmath68 and @xmath130 beside @xmath144 , which is @xmath90 , so @xmath145 . by the definition of the group law , this implies @xmath146 , so @xmath147 , and finally @xmath148 .",
    "for the converse , suppose that @xmath121 , and let @xmath142 be the fourth point where the generalised circle @xmath130 through @xmath128 intersects @xmath68",
    ". then , by what we have just shown , @xmath149 , and it follows that @xmath150 , and @xmath120 lie on @xmath130 .",
    "this proposition is a consequence of the more general fact that six points on a circular cubic lie on a conic if and only if they sum to @xmath151 .",
    "( in the standard group structure on a cubic , where the identity @xmath101 is chosen as an inflection point , they would sum to @xmath101 ; see @xcite*theorem 9.2 . )",
    "since a generalised circle in @xmath45 is a conic containing @xmath38 and @xmath39 , and @xmath152 , it follows that four points @xmath120 ( possibly including @xmath101 ) lie on a generalised circle if and only if they sum to @xmath106 .",
    "we now define group laws on two other types of curves of circular degree two , and observe that they satisfy similar concyclicity properties .",
    "let us note at this point that most bicircular quartics can also be given a group structure ( if an irreducible bicircular quartic has no singularities besides @xmath38 and @xmath39 , then it is a curve of genus one , and thus has a group law by @xcite*section iii.3 ) .",
    "however , in our proofs we will handle bicircular quartics by inverting in a point on the curve , which by lemma [ lem : inversion ] transforms a bicircular quartic into a circular cubic .",
    "for that reason , we do not need to study the group law on bicircular quartics separately .",
    "[ [ ellipses . ] ] ellipses .",
    "+ + + + + + + + +    we discuss a group law on ellipses , although we do not actually need it in our proof , because inversion lets us transform an ellipse into an acnodal cubic ( proposition [ prop : ellipseandacnodal ] ) , which we have already given a group structure in the previous section .",
    "nevertheless , we treat the group law on ellipses here because it is especially elementary , and it would be strange not to mention it .",
    "consider the ellipse @xmath130 given by the equation @xmath153 , with @xmath154 .",
    "for any point @xmath155 , we project @xmath102 vertically to the point @xmath156 on the unit circle around the origin , as in figure  [ fig : ellipse ] , and call the angle @xmath157 the _ eccentric angle _ of @xmath102 .",
    "we define the sum of two points @xmath158 to be the point @xmath159 whose eccentric angle is @xmath160 .",
    "this gives @xmath130 a group structure isomorphic to @xmath161 .",
    "the identity element is @xmath162 , and the inverse of a point is its reflection in the @xmath42-axis .",
    "we have the following classical fact that describes when four points on an ellipse are concyclic ( see @xcite for the oldest reference we could find , and @xcite*problem 17.2 for two detailed proofs ) .",
    "( -1.5,0 ) rectangle ( 3.3,4.8 ) ; ( 0,0 )  ( 0.:0.4 ) arc ( 0.:59.807322877532016:0.4 )  cycle ; ( 0.89,2.34 ) ellipse ( 2.0480822869644038 cm and 1.1569533500436997 cm ) ; plot(,(7.9092 - 0.*)/3.38 ) ; ( 0.89,2.34 ) circle ( 2.0480822869644038 cm ) ; ( 0.89,2.34) ( 1.92,3.34 ) ; ( 1.92,0 )  ( 1.92,4.8 ) ; ( 0.89,2.34) ( 1.92,4.110237569982443 ) ; ( 1.92,3.34 ) circle ( 1.2pt ) ; ( 2.1,3.45 ) node @xmath102 ; ( 0.89,2.34 ) circle ( 1.2pt ) ; ( 1.92,4.110237569982443 ) circle ( 1.2pt ) ; ( 2.1,4.35 ) node @xmath156 ; ( 1.46,2.54 ) node @xmath157 ;    [ prop : ellipse ] four points @xmath163 are concyclic if and only if @xmath164 .",
    "we may allow two of the points to be equal , in which case the circle through the three distinct points is tangent to the ellipse at the repeated point .",
    "another way to look at this group law is that we are parametrising the ellipse using lines through @xmath162 ( see for instance @xcite*section 1.1 ) .",
    "more precisely , each point @xmath155 corresponds to the line @xmath165 ; @xmath165 makes an angle @xmath166 with the @xmath42-axis , and the set of lines through @xmath101 thus has a group structure equivalent to the one above .",
    "this view lets us relate the group on the ellipse to the group on the acnodal cubic . by proposition [ prop : ellipseandacnodal ] , inverting in @xmath101 maps the ellipse to an acnodal circular cubic @xmath68 , with @xmath101 becoming the isolated point of the cubic .",
    "the lines through @xmath101 now parametrise the cubic , and this parametrisation gives the same group on @xmath68 as the line construction that we gave in section  [ ssec : irreducible ] ( see @xcite*section 3.7 ) .    [",
    "[ concentric - circles . ] ] concentric circles .",
    "+ + + + + + + + + + + + + + + + + + +    we now define a group on the union of two disjoint circles . for notational convenience",
    ", we identify @xmath7 with @xmath167 .",
    "after an appropriate inversion , we can assume the circles to be @xmath168 with @xmath169 , and we represent each element of @xmath170 as @xmath171 with @xmath172 ( with the obvious convention @xmath173 and @xmath174 ) .",
    "we define a group operation on @xmath170 by @xmath175 which turns @xmath170 into a group isomorphic to @xmath176 , with identity element @xmath177 .",
    "we again have the following concyclicity property , which is easily seen using symmetry .",
    "[ prop : double - polygon - concyclic ] points @xmath178 and @xmath179 lie on a generalised circle if and only if @xmath164 . if @xmath111 or @xmath180 , then the generalised circle is tangent at that point .",
    "let @xmath130 be the ellipse defined by @xmath181 , with the group structure introduced in section [ sec : groupsonother ] .",
    "let @xmath182 .",
    "we have a finite subgroup of size @xmath1 given by @xmath183 by proposition [ prop : ellipse ] , the circle through any three points @xmath184 passes through the point @xmath185 .",
    "therefore , the only way @xmath186 spans an ordinary circle is when @xmath90 coincides with one of the points @xmath128 ( which occurs if the circle is tangent to @xmath130 at that point ) .",
    "it follows that the number of ordinary circles is equal to @xmath187 which is @xmath188 .    similarly , the number of @xmath32-point circles is equal to @xmath189 which is , by inclusion - exclusion , equal to @xmath190 , where @xmath191 is the number of solutions in @xmath192 to the equation @xmath193 and @xmath194 is the number of solutions in @xmath192 to the equation @xmath195 .",
    "this works out to @xmath196      let @xmath68 be an irreducible circular cubic , and let @xmath100 be the group operation defined in section [ ssec : irreducible ] .",
    "it is well known ( see for instance @xcite ) that the group @xmath197 is isomorphic to the circle @xmath161 if @xmath68 is acnodal or if @xmath68 is smooth and has one connected component , and is isomorphic to @xmath198 if @xmath68 is smooth and has two connected components . let @xmath199 be a subgroup of order @xmath1 of @xmath98 , and let @xmath200 be such that @xmath201 for some @xmath202 . by proposition [ prop : cir_elliptic ] , the number of ordinary generalised circles in the coset @xmath203 equals @xmath204 which is easily seen to equal @xmath205 .",
    "similarly , the number of ordinary circles in @xmath203 equals @xmath206 which also equals @xmath205 .    as in the previous construction , if @xmath207 ( equivalently , @xmath208 ) then the number of @xmath32-point circles is equal to @xmath190 , where @xmath191 is the number of solutions in @xmath199 to the equation @xmath209 and @xmath194 is the number of solutions in @xmath199 to the equation @xmath210 . if @xmath199 is cyclic , then we get the same numbers as in the previous construction .",
    "otherwise , @xmath211 , @xmath212 , and the number of @xmath32-point circles equals @xmath213 which is greater than the corresponding number in the previous construction .",
    "let @xmath214 be even and set @xmath215 .",
    "we identify @xmath7 with @xmath167 .",
    "let @xmath216 be the circle with centre the origin and radius one , and @xmath217 the circle with centre the origin and radius @xmath169 .",
    "let @xmath218 and @xmath219 .",
    "thus , @xmath220 and @xmath221 are the vertex sets of regular @xmath222-gons on @xmath216 and @xmath217 that are ` aligned ' in the sense that their points lie at the same set of angles from the common centre ( see figure [ fig : aligned ] ) .",
    "let @xmath223 . by proposition  [ prop : double - polygon - concyclic",
    "] , the points @xmath224 , @xmath179 are collinear or concyclic if and only if @xmath225 .",
    "in particular , if @xmath111 , then the generalised circle through the three points is tangent to @xmath216 .",
    "it follows that if @xmath226 , the ordinary generalised circles of @xmath186 are exactly those through @xmath227 or through @xmath228 where @xmath229 , with @xmath230 .    for generic @xmath169",
    ", we then obtain that the number of ordinary generalised circles equals @xmath231 ( although @xmath232 and @xmath233 are not ordered , we either have two points on @xmath216 or two points on @xmath217 ) .",
    "this equals @xmath234 if @xmath222 is even and @xmath235 if @xmath222 is odd .",
    "that is , for generic @xmath87 , we obtain @xmath236 ordinary generalised circles if @xmath237 and @xmath238 ordinary generalised circles if @xmath239 .    if we choose @xmath240 ( there are @xmath241 choices for @xmath87 ) , then the tangent lines at points of @xmath220 pass through two points of @xmath221 , so are ordinary generalised circles .",
    "thus , for these choices of @xmath87 we lose @xmath222 ordinary circles , and obtain @xmath242 ordinary circles if @xmath237 and @xmath236 ordinary circles if @xmath239 .",
    "note that this is much less than the number of ordinary circles given by constructions  [ constr : ellipse ] and  [ constr : cubic ] .",
    "similarly , the number of @xmath32-point generalised circles spanned by @xmath186 equals @xmath243 which is @xmath244 , also much less than the number in constructions  [ constr : ellipse ] and  [ constr : cubic ] .",
    "( -2.2,-2.2 ) rectangle ( 2.2,2.2 ) ; ( 0.,0 . ) circle ( 2.cm ) ; ( 0.,0 . ) circle ( 1.cm ) ; ( 0.49422649730810375,0.8560254037844387 ) circle ( 0.9942767863877447 cm ) ; ( -0.3,-0.5196152422706631 ) circle ( 1.4 cm ) ;    ( 2.,0 . ) circle ( 1.4pt ) ; ( 1.,1.7120508075688772 ) circle ( 1.4pt ) ; ( -1.,1.7320508075688772 ) circle ( 1.4pt ) ; ( -2.,0 . ) circle ( 1.4pt ) ; ( -1.,-1.7320508075688772 ) circle ( 1.4pt ) ; ( 1.,-1.7320508075688772 ) circle ( 1.4pt ) ; ( 1.,0 . ) circle ( 1.4pt ) ; ( 0.5,0.8660254037844386 ) circle ( 1.4pt ) ; ( -0.5,0.8660254037844386 ) circle ( 1.4pt ) ; ( -1.,0 . ) circle ( 1.4pt ) ; ( -0.5,-0.8660254037844386 ) circle ( 1.4pt ) ; ( 0.5,-0.8660254037844386 ) circle ( 1.4pt ) ;    ( -2.2,-2.2 ) rectangle ( 2.2,2.2 ) ; ( 0.,0 . ) circle ( 2.cm ) ; ( 0.,0 . ) circle ( 1.cm ) ; ( 0.6562278325107631,1.1366199472494412 ) circle ( 0.6702984246947132 cm ) ; ( -0.26168644528051416,-0.45325421887794337 ) circle ( 1.4766271094389718 cm ) ; ( 0.375,-0.6495190528383289 ) circle ( 1.25 cm ) ; ( -0.375,0.6495190528383289 ) circle ( 1.25 cm ) ;    ( 2.,0 . ) circle ( 1.4pt ) ; ( 1.,1.7120508075688772 ) circle ( 1.4pt ) ; ( -1.,1.7320508075688772 ) circle ( 1.4pt ) ; ( -2.,0 . ) circle ( 1.4pt ) ; ( -1.,-1.7320508075688772 ) circle ( 1.4pt ) ; ( 1.,-1.7320508075688772 ) circle ( 1.4pt ) ; ( 0.,1 . ) circle ( 1.4pt ) ; ( 0.8660254037844386,0.5 ) circle ( 1.4pt ) ; ( 0.8660254037844386,-0.5 ) circle ( 1.4pt ) ; ( 0.,-1 . ) circle ( 1.4pt ) ; ( -0.8660254037844386,0.5 ) circle ( 1.4pt ) ; ( -0.8660254037844386,-0.5 ) circle ( 1.4pt ) ;      we modify the previous construction by rotating @xmath221 around the origin by an angle of @xmath245 .",
    "this results in @xmath246 and @xmath247 ( see figure  [ fig : offset ] ) . as before , if @xmath226 , the ordinary circles ( including straight lines through exactly three points ) of @xmath248 are exactly those through @xmath249 or through @xmath250 , where @xmath251 with @xmath230 .",
    "for generic @xmath169 , we now have to count the number of ordered triples in the set @xmath252 this equals @xmath253 if @xmath222 is even and @xmath235 if @xmath222 is odd . that is , for generic @xmath87",
    ", we obtain @xmath254 ordinary generalised circles if @xmath237 , worse than construction  [ constr : even ] , and @xmath238 ordinary generalised circles if @xmath255 , the same number as in construction  [ constr : even ] .    again ,",
    "if we choose @xmath240 ( there are @xmath241 choices for @xmath87 ) , we lose @xmath222 ordinary circles .",
    "thus , we obtain @xmath236 ordinary circles if @xmath255 , the same number as in construction  [ constr : even ] .    as in construction  [ constr : even ] , we get @xmath256 @xmath32-point circles .",
    "let @xmath257 be odd .",
    "take construction  [ constr : even ] with @xmath258 points and remove an arbitrary point @xmath259 .",
    "first assume that @xmath222 is odd .",
    "before we remove @xmath79 , there are @xmath235 ordinary generalised circles .",
    "of these , there are @xmath260 tangent at @xmath79 .",
    "there are also @xmath261 ordinary generalised circles through @xmath79 tangent at some point of @xmath221 .",
    "thus , by removing @xmath79 , we destroy @xmath262 ordinary generalised circles and create @xmath263 new ones .",
    "therefore , @xmath264 has @xmath265 ordinary generalised circles .",
    "that is , there are @xmath266 ordinary generalised circles if @xmath267 .",
    "next assume that @xmath222 is even .",
    "before we remove @xmath79 , there are @xmath234 ordinary generalised circles , of which there are @xmath268 through two different points of @xmath221 tangent at @xmath79 , and there are also @xmath269 ordinary generalised circles through @xmath79 tangent at a point of @xmath221 .",
    "as before , we obtain @xmath270 ordinary generalised circles .",
    "thus , we obtain @xmath271 ordinary generalised circles if @xmath272 .    instead of starting with construction  [ constr : even ] , we can take the ` offset ' construction  [ constr : offset ] and remove a point .",
    "it is easy to see that when @xmath267 we obtain the same number of ordinary generalised circles , while if @xmath272 we obtain more .",
    "since there are no @xmath273-point circles in constructions  [ constr : even ] and [ constr : offset ] when @xmath274 , removing a point does not add any @xmath32-point circle , but destroys @xmath275 of them .",
    "we thus get @xmath256 @xmath32-point generalised circles , which is asymptotically the same as in constructions  [ constr : even ] and [ constr : offset ] .",
    "we can use inversion to make new constructions out of old ones .",
    "invert construction  [ constr : odd ] in the removed point @xmath79 .",
    "the resulting point set has @xmath222 points on a circle and @xmath261 points on a line disjoint from the circle .",
    "every ordinary circle after the inversion corresponds to an ordinary generalised circle not passing through @xmath79 before the inversion .",
    "if @xmath222 is odd , there are @xmath260 ordinary generalised circles tangent at @xmath79 and a further @xmath261 ordinary generalised circles through @xmath79 tangent to @xmath217 , so we obtain @xmath276 ordinary circles . for even @xmath222",
    "we similarly obtain @xmath277 ordinary circles .",
    "that is , we have @xmath278 ordinary circles when @xmath267 and @xmath279 ordinary circles when @xmath272 .",
    "if we remove another point from this inverted construction , we obtain a set of @xmath1 points where @xmath1 is even , with @xmath280 ordinary circles .      if we invert construction  [ constr : ellipse ] in a point on the ellipse that is not in the set @xmath186 , then by proposition  [ prop : ellipseandacnodal ] , we obtain points on an acnodal circular cubic ( without its acnode ) as in construction  [ constr : cubic ] , with the same number of ordinary and @xmath32-point generalised circles .    if we invert a circular cubic in a point not on the curve , then we obtain a bicircular quartic by lemma  [ lem : inversion ] .",
    "there will again be @xmath205 ordinary circles ( or ordinary generalised circles ) and @xmath281 @xmath32-point circles among the inverted points .",
    "the proofs of our structure theorems for sets with few ordinary circles crucially rely on the following structure theorem for sets with few ordinary lines due to green and tao  @xcite . recall that an _ ordinary line _ is a line containing exactly two points of the given point set .",
    "[ thm : gt ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 . if a set @xmath0 of @xmath1 points in @xmath7 spans at most @xmath282 ordinary lines , then @xmath0 differs in at most @xmath6 points from an example of one of the following types :    1 .",
    "@xmath283 points on a line ; 2 .",
    "@xmath222 points each on a line and a disjoint conic , for some @xmath284 ; 3 .",
    "@xmath285 points on an acnodal or smooth cubic .",
    "we commence the proof of theorem  [ thm : weak ] .",
    "let @xmath0 be a set of @xmath1 points spanning at most @xmath5 ordinary generalised circles .",
    "we wish to show that @xmath0 lies mostly on a bicircular quartic ( we will repeatedly use ` mostly ' to mean ` for all but @xmath6 points ' ) .    note that for at least @xmath286 points @xmath79 of @xmath0 , there are at most @xmath287 ordinary circles through @xmath79 , hence the set @xmath288 spans at most @xmath287 ordinary lines .",
    "let @xmath289 be the set of such points . for @xmath1",
    "sufficiently large depending on @xmath4 , applying theorem  [ thm : gt ] to @xmath288 for any @xmath290 gives that @xmath288 lies mostly on a line , a line and a conic , an acnodal cubic , or a smooth cubic .",
    "if there exists @xmath290 such that @xmath288 lies mostly on a line , then inverting again in @xmath79 , we see that @xmath0 must lie mostly on a line or a circle .",
    "if there exists @xmath290 such that @xmath288 lies mostly on a line @xmath291 and a disjoint conic @xmath130 , we have two cases , depending on whether @xmath79 lies on @xmath291 or not .    if @xmath292 , we invert again in @xmath79 to find that @xmath0 lies mostly on the union of @xmath291 and @xmath293 . by lemma  [ lem : inversion ] ,",
    "@xmath293 is either a circle ( if @xmath130 is a circle ) or an irreducible bicircular quartic ( if @xmath130 is a non - circular conic ) .",
    "furthermore , @xmath79 is the only point that could possibly lie on both @xmath291 and @xmath293 . since roughly",
    "@xmath9 points of @xmath0 lie on @xmath291 , there must be another point @xmath294 that does not lie on @xmath293 . in @xmath295 ,",
    "the line @xmath291 remains a line , and by definition of @xmath289 the set @xmath295 spans few ordinary lines , so theorem  [ thm : gt ] tells us @xmath296 is a conic .",
    "it follows from lemma  [ lem : inversion ] that @xmath293 can not be a quartic , since we inverted in the point @xmath297 outside @xmath293 and did not obtain a quartic .",
    "that means @xmath293 has to be a circle , and it is disjoint from @xmath291 .",
    "thus , @xmath0 lies mostly on the union of a line and a disjoint circle .    if @xmath298 , we invert in @xmath79 to see that @xmath0 lies mostly on the union of the circle @xmath299 and the curve @xmath293 , which is either a circle or a quartic . again",
    "@xmath79 is the only point that can lie on both curves .",
    "inverting in another point @xmath300 , @xmath301 becomes a line , so theorem  [ thm : gt ] tells us that @xmath296 is a conic , so that @xmath293 must be a circle disjoint from @xmath299 as before .",
    "thus , @xmath0 lies mostly on the union of two disjoint circles .",
    "the case that remains is when for all @xmath302 , the set @xmath288 lies mostly on an acnodal or smooth cubic @xmath68 .",
    "fix such a @xmath79 , and consider @xmath303 , which mostly contains @xmath0 . if @xmath68 is not a circular cubic , then by the classification in section [ sec : circularcurves ] it has circular degree three , so @xmath303 has circular degree three as well .",
    "for any @xmath304 other than @xmath79 , the curve @xmath305 is also a cubic curve , by the definition of @xmath289 and theorem [ thm : gt ] . by case  [ inversion - case3 ] of lemma  [ lem : inversion ] , this can only happen if @xmath297 is a singularity of @xmath68 . but an irreducible cubic has at most one singularity , which is a contradiction",
    ". so @xmath68 must be a circular cubic that is acnodal or smooth . if @xmath68 is acnodal , then @xmath303 is either a bicircular quartic ( if @xmath306 ) , an acnodal circular cubic ( if @xmath79 is a regular point of @xmath68 ) , or a non - circular conic ( if @xmath79 is the singularity of @xmath68 ) . in the last case ,",
    "the conic is an ellipse by proposition [ prop : ellipseandacnodal ] .",
    "if @xmath68 is smooth , then @xmath303 is either a bicircular quartic or a smooth circular cubic .",
    "we have encountered the following curves that @xmath0 could mostly lie on : a line , a circle , an ellipse , a disjoint union of a line and a circle , a disjoint union of two circles , a circular cubic , or a bicircular quartic .",
    "all of these are subsets of bicircular quartics , which proves the statement of theorem [ thm : weak ] .",
    "@xmath307      we now prove theorem  [ thm : strong ] .",
    "first of all , as explained in section  [ sec : constr ] , a subgroup of an ellipse and an appropriate coset of a subgroup of a smooth circular cubic both have at most @xmath308 ordinary generalised circles , and a double polygon has at most @xmath309 ordinary generalised circles .",
    "it follows from lemma  [ lemma : stability ] below that if we add and/or remove @xmath6 points , then there will be at most @xmath44 ordinary generalised circles .",
    "[ lemma : stability ] let @xmath186 be a set of @xmath1 points in @xmath7 with @xmath310 ordinary generalised circles .",
    "let @xmath311 be a set that differs from @xmath186 in at most @xmath4 points : @xmath312 .",
    "then @xmath311 has at most @xmath313 ordinary generalised circles .    first note",
    "that if we add a point to any set of @xmath1 points , we create at most @xmath314 ordinary generalised circles .",
    "secondly , since two circles intersect in at most two points , the number of @xmath32-point circles through a fixed point in a set of @xmath1 points is at most @xmath315 , so by removing a point we create at most @xmath316 ordinary generalised circles .",
    "it follows that by adding and removing @xmath6 points , we create at most @xmath317 ordinary generalised circles .",
    "next , let @xmath0 be a set of @xmath1 points with at most @xmath5 ordinary generalised circles . from the proof of theorem  [ thm : weak ] above",
    ", we see that @xmath0 differs in at most @xmath6 points from a line , a circle , an ellipse , a disjoint union of a line and a circle , a disjoint union of two circles , a circular cubic , or a bicircular quartic .",
    "moreover , in the proof we saw that the circular cubic must be acnodal or smooth , and that the bicircular quartic has the property that if we invert in a point on the curve , the resulting circular cubic is acnodal or smooth .",
    "using inversions , we can reduce the number of types of curves that we need to analyse further .    *",
    "if @xmath0 lies mostly on a line , then we are in case  [ casei ] of theorem  [ thm : strong ] , so we are done . *",
    "if @xmath0 lies mostly on a circle , then inverting in a point on the circle puts us in case  [ casei ] again . *",
    "if @xmath0 lies mostly on an ellipse , then inverting in a point of the ellipse places @xmath0 mostly on an acnodal circular cubic . *",
    "if @xmath0 lies mostly on a bicircular quartic , then inverting in any regular point on the curve gives us a circular cubic .",
    "as mentioned above , this cubic is acnodal or smooth . * if @xmath0 lies mostly on a line and a disjoint circle , then an inversion in a point not on the line or circle places @xmath0 mostly on two disjoint circles . *",
    "if @xmath0 lies mostly on the disjoint union of two circles , we can apply an inversion that maps the two disjoint circles to two concentric circles @xcite*theorem 1.7 .",
    "so , up to inversions , we need only consider the cases when @xmath0 lies mostly on an acnodal or smooth circular cubic , or on two concentric circles .",
    "we do this in lemmas  [ lem : cir_elliptic ] and [ lem:2cir ] below , which will complete the proof of theorem  [ thm : strong ] .",
    "to determine the structure of @xmath0 , we use a variant of a lemma from additive combinatorics that was used by green and tao @xcite .",
    "it captures the principle that if a finite subset of a group is almost closed under addition , then it is close to a subgroup .",
    "the following statement is proposition a.5 in @xcite .",
    "[ prop : a5 ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 .",
    "let @xmath318 , @xmath319 , @xmath26 be three subsets of some abelian group @xmath320 , all of cardinality within @xmath4 of @xmath1 .",
    "suppose there are at most @xmath282 pairs @xmath321 for which @xmath322 .",
    "then there is a subgroup @xmath323 and cosets @xmath40 , @xmath324 such that @xmath325    the variant that we need is a simple corollary of proposition  [ prop : a5 ] .",
    "[ cor : four ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 .",
    "let @xmath318 , @xmath319 , @xmath26 , @xmath326 be four subsets of some abelian group @xmath320 , all of cardinality within @xmath4 of @xmath1 .",
    "suppose there are at most @xmath5 triples @xmath327 for which @xmath328 .",
    "then there is a subgroup @xmath323 and cosets @xmath40 , @xmath324 , @xmath329 such that @xmath330    by the pigeonhole principle , there exists an @xmath331 such that there are at most @xmath332 ( where @xmath333 ) pairs @xmath334 for which @xmath335 , or equivalently @xmath336 .",
    "applying proposition  [ prop : a5 ] , we have a subgroup @xmath323 and cosets @xmath324 , @xmath329 such that @xmath337    since @xmath338 , we repeat the argument above to obtain @xmath339 such that there are at most @xmath340 pairs @xmath341 with @xmath342 , and proposition  [ prop : a5 ] gives a subgroup @xmath343 and cosets @xmath344 , @xmath345 such that @xmath346    from this , it follows that @xmath347 , hence @xmath348 .",
    "since @xmath349 is not empty , it has to be a coset of @xmath350 . if @xmath351 , then @xmath352 , a contradiction .",
    "therefore , @xmath353 and @xmath354 .",
    "so we have @xmath355 .",
    "since @xmath356 , we obtain @xmath357 as well .",
    "[ lem : cir_elliptic ] let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 .",
    "suppose @xmath0 is a set of @xmath1 points in @xmath7 spanning at most @xmath5 ordinary generalised circles , and all but at most @xmath4 points of @xmath0 lie on an acnodal or smooth circular cubic @xmath68 .",
    "then there is a coset @xmath40 of a subgroup @xmath358 , with @xmath359 , such that @xmath360 .",
    "let @xmath361 .",
    "then @xmath362 , and by lemma  [ lemma : stability ] , @xmath289 spans at most @xmath44 ordinary circles .",
    "if @xmath102 , @xmath103 , @xmath363 are distinct , then by proposition  [ prop : cir_elliptic ] , the generalised circle through @xmath102 , @xmath103 , @xmath131 meets @xmath68 again in the unique point @xmath364 .",
    "this implies that @xmath365 for all but at most @xmath44 triples @xmath102 , @xmath103 , @xmath366 , or equivalently @xmath367 . applying corollary  [ cor : four ] with @xmath368 and @xmath369 , we obtain @xmath370 and a coset @xmath40 such that @xmath360 and @xmath371 , which is equivalent to @xmath372 .",
    "thus we have @xmath373 , which implies @xmath359 .    [ lem:2cir ]",
    "let @xmath35 and let @xmath1 be sufficiently large depending on @xmath4 .",
    "suppose @xmath0 is a set of @xmath1 points in @xmath7 spanning at most @xmath5 ordinary generalised circles .",
    "suppose all but at most @xmath4 of the points of @xmath0 lie on two concentric circles , and that @xmath0 has @xmath374 points on each .",
    "then , up to similarity , @xmath0 differs in at most @xmath6 points from an ` aligned ' or ` offset ' double polygon .    by scaling and rotating",
    ", we can assume that @xmath0 lies mostly on the two concentric circles @xmath375 and @xmath376 , @xmath169 , which we gave a group structure in section [ sec : groupsonother ] .    let @xmath377 and @xmath378",
    ". then @xmath379 , and by lemma  [ lemma : stability ] , @xmath380 spans at most @xmath44 ordinary circles . if @xmath178 and @xmath381 with @xmath382 , then by lemma  [ prop : double - polygon - concyclic ] , the generalised circle through @xmath102 , @xmath103 , @xmath131 meets @xmath383 again in the unique point @xmath384 .",
    "this implies @xmath385 for all but at most @xmath44 triples @xmath386 with @xmath387 and @xmath388 . applying corollary  [ cor : four ] with @xmath389 , @xmath390 and @xmath391 , we get cosets @xmath40 and @xmath392 of @xmath383 such that @xmath393 and @xmath394 , where @xmath395 and @xmath396 .",
    "it follows that @xmath397 , hence @xmath41 is a cyclic group of order @xmath398 , and @xmath399 and @xmath392 are the vertex sets of regular @xmath222-gons inscribed in @xmath216 and @xmath217 , respectively , either ` aligned ' or ` offset ' depending on whether @xmath400 or not .",
    "together these lemmas prove theorem [ thm : strong ] .",
    "it just remains to remark that if @xmath0 differs in @xmath6 points from a coset on an acnodal circular cubic , then we apply inversion in its singularity . by proposition [ prop : ellipseandacnodal ]",
    ", we obtain that @xmath0 differs in @xmath6 points from a coset @xmath399 of a finite subgroup @xmath41 of an ellipse , where @xmath401 .",
    "thus , @xmath42 is a point of the ellipse with eccentric angle a multiple of @xmath402 . after a rotation",
    ", we can assume that @xmath403 , which is case  [ caseii ] of theorem [ thm : strong ] .",
    "in this section we prove theorems  [ thm : main ] , [ thm : ordgencircles ] , and [ thm : orchard ] .",
    "we first consider generalised circles .",
    "suppose @xmath0 is an @xmath1-point set in @xmath7 spanning fewer than @xmath404 ordinary generalised circles , and that @xmath0 is not contained in a generalised circle .",
    "applying theorem  [ thm : strong ] , we can conclude that , up to inversions , @xmath0 differs in @xmath405 points from one of the following examples : points on a line , a coset of a subgroup of an acnodal or smooth circular cubic , or a double polygon .",
    "let @xmath122 be a line such that @xmath410 .",
    "for any @xmath411 and @xmath412 there are at most @xmath413 non - ordinary circles through @xmath79 , @xmath297 , another point on @xmath414 , and another point in @xmath415",
    ". therefore , there are at least @xmath416 ordinary circles through @xmath79 .",
    "this holds for any of the @xmath417 points @xmath411 , and we obtain at least @xmath418 ordinary circles .",
    "it is easy to see that when @xmath419 , @xmath418 is minimised when @xmath420 .",
    "[ lem : extremal_cubic ] suppose @xmath408 differs in @xmath4 points from a coset @xmath399 of an acnodal or smooth circular cubic , where @xmath421 and @xmath422",
    ". then @xmath0 spans at least @xmath423 ordinary circles .",
    "suppose that @xmath0 differs in @xmath4 points from @xmath399 .",
    "we know from construction  [ constr : cubic ] that @xmath399 spans @xmath424 ordinary circles , all of which are tangent to @xmath68 .",
    "we show that adding or removing @xmath4 points destroys no more than @xmath340 of these ordinary circles , so that the resulting set @xmath0 still spans at least @xmath423 ordinary circles .",
    "suppose we add a point @xmath425 .",
    "for @xmath426 , at most one circle tangent to @xmath68 at @xmath79 can pass through @xmath297 .",
    "thus , adding @xmath297 destroys at most @xmath1 ordinary circles .",
    "now suppose we remove a point @xmath426 .",
    "since ordinary circles of @xmath399 correspond to solutions of @xmath427 or @xmath428 , there are at most @xmath429 solutions for a fixed @xmath79 . thus removing @xmath79",
    "destroys at most @xmath429 ordinary circles .    repeating @xmath4 times , we see that adding or removing @xmath4 points to or from @xmath399 destroys at most @xmath340 ordinary generalised circles out of the @xmath430 spanned by @xmath399 .",
    "this proves that @xmath0 spans at least @xmath423 ordinary circles .    from the two lemmas above",
    "we know that there is an absolute constant @xmath26 such that a set of @xmath1 points , not all collinear or concyclic , spanning at most @xmath431 ordinary generalised circles , differs in @xmath405 points from case  [ caseiv ] in theorem  [ thm : strong ] .",
    "this case , where @xmath0 is close to the vertex set of a double polygon , requires a more careful analysis of the effect of adding or removing points .",
    "denote the two circles by @xmath216 and @xmath217 .",
    "we use @xcite*theorem 6.1 , which states that for ( not necessarily distinct ) algebraic curves @xmath434 of constant degree , and finite sets @xmath435 , the number of collinear triples @xmath436 , with @xmath437 distinct , is bounded by @xmath438 , unless @xmath439 is a line or a cubic .",
    "let @xmath440 and @xmath441 . set @xmath442 for @xmath443 .",
    "every line with at least one point of @xmath220 and two points of @xmath444 corresponds to a collinear triple in @xmath445 .",
    "since the union of two circles is not a line or a cubic , we can apply the theorem to get the bound @xmath433 for the number of collinear triples in @xmath0 with one point in @xmath216 and two points in @xmath217 .",
    "similarly , the number of collinear triples in @xmath0 with one point in @xmath217 and two points in @xmath216 is also @xmath433 .",
    "since a line intersects @xmath170 in at most four points , we also obtain the bound @xmath433 for the number of lines with at least three points .",
    "[ lem : add / remove ] let @xmath186 be a double polygon with @xmath222 points on each circle .",
    "let @xmath446 be a set of @xmath1 points , where @xmath318 is a subset of @xmath186 with @xmath447 points and @xmath319 is a set disjoint from @xmath186 with @xmath448 points .",
    "then @xmath0 spans at least @xmath449 ordinary generalised circles .",
    "consider first the number of ordinary generalised circles spanned by @xmath451 .",
    "as we saw in construction  [ constr : odd ] , removing a point @xmath452 destroys at most @xmath453 ordinary generalised circles spanned by @xmath186 , and adds @xmath454 ordinary generalised circles . noting that there are at most @xmath222 @xmath32-point generalised circles spanned by @xmath186 that go through any two given points of @xmath318",
    ", we thus have by inclusion - exclusion that @xmath451 determines at least @xmath455 ordinary generalised circles .",
    "now consider adding @xmath456 to @xmath186 . for any pair of points from @xmath457 ,",
    "adding @xmath456 creates a new ordinary generalised circle , unless the generalised circle through the pair and @xmath297 contains three or four points of @xmath457 .",
    "we already saw that the number of ordinary generalised circles hitting a fixed point is @xmath429 , so it remains to bound the number of @xmath32-point generalised circles of @xmath186 that hit @xmath297 .",
    "if @xmath297 lies on one of the concentric circles , then no @xmath32-point generalised circles hit @xmath297 , so we can assume that @xmath297 does not .",
    "applying inversion in @xmath297 reduces the problem to bounding the number of @xmath32-point lines determined by a subset of two circles . by proposition",
    "[ prop : rsz ] , this number is bounded by @xmath433 , so @xmath79 lies on at most @xmath433 of the @xmath32-point generalised circles spanned by @xmath186 .",
    "adding @xmath297 to @xmath186 thus creates at least @xmath458 ordinary generalised circles .",
    "note that each @xmath459 that was removed destroys at most @xmath1 of these circles .",
    "adding @xmath297 to @xmath457 also destroys at most @xmath429 ordinary circles , since for each @xmath460 there is only one circle tangent at @xmath79 and going through @xmath297 , and for each @xmath459 , at most @xmath222 ordinary circles spanned by @xmath451 go through @xmath79 .",
    "finally , since there are at most @xmath461 circles through two points of @xmath319 that also go through two points of @xmath451 , @xmath446 spans at least @xmath462 ordinary generalised circles .",
    "suppose that @xmath0 is a set of @xmath1 points in @xmath7 with fewer than @xmath463 ordinary generalised circles , where @xmath26 is sufficiently large .",
    "without loss of generality , @xmath1 is also sufficiently large . by lemmas  [ lem : extremal_line ] and [ lem : extremal_cubic ] , we need only consider the case where @xmath0 differs by @xmath405 points from a double polygon . in the notation of lemma",
    "[ lem : add / remove ] , we have @xmath446 and @xmath464 , which implies that @xmath465 and @xmath466 .",
    "so @xmath0 is either equal to @xmath186 , or is obtained from @xmath186 by removing one point , which are exactly the cases in constructions  [ constr : even ] , [ constr : offset ] , and  [ constr : odd ] . in particular , the minimum number of ordinary generalised circles occurs in construction  [ constr : even ] when @xmath467 , in construction  [ constr : odd ] when @xmath468 , and in constructions  [ constr : even ] and [ constr : offset ] when @xmath255 .",
    "let @xmath0 be a set of @xmath1 points not all on a line or a circle , with at most @xmath469 ordinary circles , for a sufficiently large @xmath26 . by a simple double counting argument",
    ", there are at most @xmath470 @xmath24-point lines , so there are at most @xmath471 ordinary generalised circles . by theorem  [ thm : strong ] , up to inversions and up to @xmath405 points , @xmath0 lies on a line , an ellipse , a smooth circular cubic , or two concentric circles . by lemmas  [ lem : extremal_line ] and [ lem : extremal_cubic ] , the first three cases give us at least @xmath472 ordinary circles , contrary to assumption .",
    "therefore , we only need to consider the case where , when @xmath0 is transformed by an inversion to @xmath289 , we have @xmath473 , where @xmath186 is a double polygon ( ` aligned ' or ` offset ' ) , and @xmath474 , @xmath475 .    by lemma  [ lem :",
    "add / remove ] , @xmath289 has at least @xmath476 ordinary generalised circles , which gives us the inequality @xmath477 , which in turn gives us @xmath478 and @xmath479 .",
    "therefore , @xmath289 lies on two concentric circles , and @xmath0 lies on the disjoint union of two circles or the disjoint union of a line and a circle .",
    "suppose that @xmath480 ( and @xmath479 ) .",
    "then @xmath289 has @xmath481 ordinary generalised circles .",
    "those passing through the centre of the inversion that transforms @xmath0 to @xmath289 , are inverted back to straight lines passing through three points of @xmath0 . as in the proof of lemma  [ lem :",
    "add / remove ] , there are @xmath482 ordinary generalised circles that pass through any point of @xmath318 .",
    "also , we can use lemma  [ lemma : tangent ] below to show that there are at most @xmath429 ordinary generalised circles spanned by @xmath457 that intersect in the same point not in @xmath186 .",
    "indeed , by lemma  [ lemma : tangent ] , there are at most @xmath9 ordinary generalised circles of @xmath186 that intersect in the same point @xmath483 .",
    "furthermore , for each point @xmath484 there are @xmath429 generalised circles through @xmath79 , @xmath297 , and two more points of @xmath186 .",
    "it follows that there are @xmath429 ordinary generalised circles spanned by @xmath457 through @xmath79 .",
    "thus , if the centre of inversion is in @xmath318 , @xmath0 has @xmath472 ordinary circles , which is a contradiction if @xmath26 is chosen large enough . on the other hand ,",
    "if the centre of inversion is not in @xmath318 , then @xmath0 has @xmath481 ordinary circles , also a contradiction .      next",
    ", suppose that @xmath1 is even .",
    "if @xmath486 , then there are @xmath472 ordinary generalised circles and through both points of @xmath318 there are @xmath482 ordinary generalised circles .",
    "if we invert in one of these points in @xmath318 , we obtain a set with @xmath487 ordinary circles ( as in construction  [ constr : linecircle ] ) , which is not extremal .",
    "otherwise , @xmath488 , @xmath289 is as in constructions  [ constr : even ] or [ constr : offset ] , and there are at least @xmath489 ordinary generalised circles if @xmath467 and @xmath490 if @xmath255 .",
    "let @xmath79 be the centre of the inversion that transforms @xmath0 to @xmath289 .",
    "then all the @xmath24-point lines of @xmath0 are inverted to ordinary circles in the double polygon @xmath289 , all passing through @xmath79 . by lemma  [ lemma :",
    "tangent ] below , there are at most @xmath9 ordinary circles that intersect in the same point not in @xmath289 .",
    "thus , in @xmath0 there at most @xmath9 @xmath24-point lines , and the number of ordinary circles ( not including lines ) is at least @xmath491 if @xmath467 and @xmath489 if @xmath255 , which match construction  [ constr : even ] ( and construction  [ constr : offset ] if @xmath255 ) , if the radii are chosen so that each vertex of the inner polygon has an ordinary generalised circle that is a straight line tangent to it .",
    "finally , suppose that @xmath1 is odd .",
    "then @xmath492 and @xmath289 is as in construction  [ constr : odd ] , with @xmath280 ordinary generalised circles .",
    "it follows that @xmath0 must be as in construction  [ constr : linecircle ] , with @xmath493 ordinary circles if @xmath494 and @xmath495 ordinary circles if @xmath496 .",
    "this finishes the proof .",
    "[ lemma : tangent ] let @xmath186 be a double polygon ( ` aligned ' or ` offset ' ) with @xmath222 points on each circle . then a point @xmath497 lies on at most @xmath222 ordinary generalised circles spanned by @xmath186 .",
    "denote the inner circle by @xmath216 and the outer circle by @xmath217 , both with centre @xmath101 .",
    "we proceed by case analysis on the position of @xmath297 with respect to @xmath216 and @xmath217 .",
    "note that for each point @xmath452 , at most one of the ordinary generalised circles tangent at @xmath79 can go through @xmath297 .",
    "if @xmath297 lies inside @xmath216 , then @xmath297 lies on at most @xmath222 ordinary generalised circles spanned by @xmath186 , since ordinary generalised circles tangent to @xmath216 can not pass through @xmath297 . similarly ,",
    "if @xmath297 lies outside @xmath217 , it lies on at most @xmath222 ordinary generalised circles , since ordinary generalised circles tangent to @xmath217 lie inside @xmath217 .    the remaining case to consider is when @xmath297 lies in the annulus bounded by @xmath216 and @xmath217 . consider the subset @xmath498 of points @xmath79 such that there exists an ordinary generalised circle tangent at @xmath79 going through @xmath297 . consider the four circles passing through @xmath297 and tangent to both @xmath216 and @xmath217 .",
    "they touch @xmath216 at @xmath499 and @xmath217 at @xmath500 as in figure  [ fig : bitangent_circles ] .",
    "( 18.194872338766768:0.69 ) arc ( 18.194872338766768:69.51268488527734:0.69 )  cycle ; ( 0,0 )  ( -110.48731511472266:0.57 ) arc ( -110.48731511472266:-18.194872338766785:0.57 )  cycle ; ( 5.,0.5 ) circle ( 2.5 cm ) ; ( 5.,0.5 ) circle ( 5.cm ) ; ( 5.4375,1.6709371246996996 ) circle ( 3.75 cm ) ; ( 5.4375,-0.6709371246996997 ) circle ( 3.75 cm ) ; ( 8.5625,1.6709371246996996 ) circle ( 1.25 cm ) ; ( 8.5625,-0.6709371246996997 ) circle ( 1.25 cm ) ; ( 0,0 ) ",
    "plot[domain=0.31756042929152123:1.213225223149386,variable=](1.*5.*cos(r)+0.*5.*sin(r),0.*5.*cos(r)+1.*5.*sin(r ) )  cycle ; ( 0,0 ) ",
    "plot[domain=4.35481787673918:5.9656248778880645,variable=](1.*2.5*cos(r)+0.*2.5*sin(r),0.*2.5*cos(r)+1.*2.5*sin(r ) )  cycle ; plot[domain=0.31756042929152123:1.213225223149386,variable=](1.*5.*cos(r)+0.*5.*sin(r),0.*5.*cos(r)+1.*5.*sin(r ) ) ; plot[domain=4.35481787673918:5.9656248778880645,variable=](1.*2.5*cos(r)+0.*2.5*sin(r),0.*2.5*cos(r)+1.*2.5*sin(r ) ) ; plot[domain=0.31756042929152134:1.9283674304404066,variable=](1.*2.5*cos(r)+0.*2.5*sin(r),0.*2.5*cos(r)+1.*2.5*sin(r ) ) ; plot[domain=5.0699600840302:5.9656248778880645,variable=](1.*5.*cos(r)+0.*5.*sin(r),0.*5.*cos(r)+1.*5.*sin(r ) ) ; ( 5.,0.5 ) circle ( 2pt ) node[left ] @xmath101 ; ( 9.,0.5 ) circle ( 2pt ) ; ( 9.45,0.5 ) node @xmath297 ; ( 4.125,-1.8418742493994003 ) circle ( 2pt ) node[below ] @xmath501 ; ( 7.375,-0.2806247497997997 ) circle ( 2pt ) node[right ] @xmath502 ; ( 7.375,1.2806247497998 ) circle ( 2pt ) ; ( 7.23,0.97 ) node @xmath503 ; ( 4.125,2.8418742493993996 ) circle ( 2pt ) node[below ] @xmath504 ; ( 6.75,-4.183748498798798 ) circle ( 2pt ) node[above ] @xmath505 ; ( 9.75,-1.0612494995995996 ) circle ( 2pt ) node[right ] @xmath506 ; ( 9.75,2.0612494995995996 ) circle ( 2pt ) node[right ] @xmath507 ; ( 6.75,5.183748498798798 ) circle ( 2pt ) node[above ] @xmath508 ; ( 5.33,0.8 ) node @xmath509 ; ( 5.15,0.2 ) node @xmath510 ; ( 2.79,0.5 ) node @xmath216 ; ( 0.29,0.5 ) node @xmath217 ;    any circle through @xmath297 tangent to @xmath216 and intersecting @xmath217 in two points , must touch @xmath216 on one of the open arcs @xmath511 or @xmath512 . similarly , any circle through @xmath297 tangent to @xmath217 and intersecting @xmath216 in two points , must touch @xmath217 on one of the open arcs @xmath513 or @xmath514 .",
    "it follows that @xmath248 must be contained in the relative interiors of one of these four arcs .",
    "since @xmath186 consists of @xmath222 equally spaced points on each of @xmath216 and @xmath217 , @xmath515 where @xmath510 and @xmath516 are as indicated in figure  [ fig : bitangent_circles ] . in order to show that @xmath517 , it suffices to show that the angle sum @xmath518 is strictly less than @xmath519",
    "this is clear from figure  [ fig : bitangent_circles ] ( note that @xmath520 are collinear with @xmath501 and @xmath508 on opposite sides of @xmath101 ) .",
    "let @xmath0 be a set of @xmath1 points in @xmath7 with at least @xmath521 @xmath32-point generalised circles .",
    "let @xmath522 denote the number of @xmath523-point lines ( @xmath524 ) and @xmath525 the number of @xmath523-point circles ( @xmath526 ) in @xmath0 . by counting unordered triples of points ,",
    "we have @xmath527 hence @xmath528 and @xmath529 , so we can apply theorem  [ thm : strong ] .",
    "we next consider each of the cases of that theorem in turn .",
    "if all except @xmath405 are vertices of two regular @xmath222-gons on concentric circles where @xmath530 , then we know from constructions  [ constr : even ] , [ constr : offset ] , and  [ constr : odd ] that @xmath0 determines at most @xmath531 @xmath32-point generalised circles , again contrary to assumption .",
    "suppose next that @xmath532 , where @xmath41 is a finite subgroup of order @xmath533 of a smooth circular cubic , @xmath318 is a subset of @xmath40 with @xmath534 points , and @xmath319 is a set disjoint from @xmath40 with @xmath535 points",
    ". then @xmath536 .",
    "the number of @xmath32-point generalised circles in @xmath40 is @xmath537 .",
    "we next determine an upper bound for the number of @xmath32-point generalised circles in @xmath0 .    for each @xmath538 ,",
    "let @xmath539 be the set of @xmath32-point generalised circles of @xmath40 that pass through @xmath79",
    ". then @xmath540 and @xmath541 for distinct @xmath542 . by inclusion - exclusion , we destroy at least @xmath543 @xmath32-point generalised circles by removing @xmath318 , and we still have at most @xmath544 @xmath32-point generalised circles in @xmath545 .    for each @xmath546 ,",
    "the number of ordinary generalised circles spanned by @xmath40 passing through @xmath79 is at most @xmath547 .",
    "this is because each such generalised circle is tangent to the cubic at one of the points of @xmath40 , and there is only one generalised circle through @xmath79 and tangent at a given point of @xmath40 .",
    "also , for each pair of distinct @xmath548 , there are at most @xmath547 generalised circles through @xmath79 and @xmath297 and two points of @xmath40 ; and for any three @xmath549 there are at most @xmath405 generalised circles through @xmath550 and one point of @xmath40 .",
    "therefore , again by inclusion - exclusion , by adding @xmath319 we gain at most @xmath547 @xmath32-point generalised circles .",
    "it follows that the number of @xmath32-point generalised circles determined by @xmath0 is @xmath551 since we assumed that @xmath552 we obtain @xmath553",
    ". therefore , @xmath554 and @xmath555 .",
    "the maximum number of @xmath32-point circles in a coset has been determined in constructions  [ constr : ellipse ] and [ constr : cubic ] .",
    "the final case , when all but @xmath405 points of @xmath0 lie on an ellipse , can be reduced to the previous case . indeed , by lemma  [ prop : ellipseandacnodal ] ,",
    "if we invert the ellipse in a point on the ellipse , we obtain an acnodal circular cubic , and then the above analysis holds verbatim for the group of regular points on this cubic ."
  ],
  "abstract_text": [
    "<S> an ordinary circle of a set @xmath0 of @xmath1 points in the plane is defined as a circle that contains exactly three points of @xmath0 . </S>",
    "<S> we show that if @xmath0 is not contained in a line or a circle , then @xmath0 spans at least @xmath2 ordinary circles . </S>",
    "<S> moreover , we determine the exact minimum number of ordinary circles for all sufficiently large @xmath1 and describe all point sets that come close to this minimum . </S>",
    "<S> we also consider the circle variant of the orchard problem . </S>",
    "<S> we prove that @xmath0 spans at most @xmath3 circles passing through exactly four points of @xmath0 . here </S>",
    "<S> we determine the exact maximum and the extremal configurations for all sufficiently large @xmath1 .    </S>",
    "<S> these results are based on the following structure theorem . </S>",
    "<S> if @xmath1 is sufficiently large depending on @xmath4 , and @xmath0 is a set of @xmath1 points spanning at most @xmath5 ordinary circles , then all but @xmath6 points of @xmath0 lie on an algebraic curve of degree at most four . </S>",
    "<S> our proofs rely on a recent result of green and tao on ordinary lines , combined with circular inversion and some classical results regarding algebraic curves . </S>"
  ]
}