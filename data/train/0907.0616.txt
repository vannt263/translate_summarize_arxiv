{
  "article_text": [
    "it is well - known that every first - order property on words is expressible using at most three variables @xcite .",
    "the subclass of properties expressible with only two variables is also quite interesting and well - studied ( fact [ fact ] ) .    in this paper",
    "we prove precise structure theorems that characterize the exact expressive power of first - order logic with two variables on words .",
    "our results apply to @xmath3<@xmath4{2}$ ] and @xmath5 $ ] , the latter of which includes the binary successor relation in addition to the linear ordering on string positions .    for both languages ,",
    "our structure theorems show exactly what is expressible using a given quantifier depth , @xmath0 , and using @xmath1 blocks of alternating quantifiers , for any @xmath2 . using these characterizations",
    ", we prove that there is a strict hierarchy of alternating quantifiers for both languages .",
    "the question whether there was such a hierarchy had been completely open since it was asked in @xcite . as another consequence of our structural results ,",
    "we show that satisfiability for @xmath6 $ ] , which is -complete in general @xcite , becomes -complete once we only consider alphabets of a bounded size .",
    "our motivation for studying @xmath7 on words comes from the desire to understand the trade - off between formula size and number of variables .",
    "this is of great interest because , as is well - known , this is equivalent to the trade - off between parallel time and number of processors @xcite .",
    "adler and immerman @xcite introduced a game that can be used to determine the minimum size of first - order formulas with a given number of variables needed to express a given property .",
    "these games , which are closely related to the communication complexity games of karchmer and wigderson @xcite , were used to prove two optimal size bounds for temporal logics @xcite .",
    "later grohe and schweikardt used similar methods to study the size versus variable trade - off for first - order logic on unary words @xcite .",
    "they proved that all first - order expressible properties of unary words are already expressible with two variables and that the variable - size trade - off between two versus three variables is polynomial whereas the trade - off between three versus four variables is exponential .",
    "they left open the trade - off between @xmath8 and @xmath9 variables for @xmath10 .",
    "while we do not directly address that question here , our classification of @xmath7 on words is a step towards the general understanding of the expressive power of @xmath11 needed for progress on such trade - offs .",
    "our characterization of @xmath6 $ ] and @xmath5 $ ] on words is based on the very natural notion of @xmath0-ranker ( definition [ def : n - ranker ] ) . informally , a ranker is the position of a certain combination of letters in a word .",
    "for example , @xmath12 and @xmath13 are 1-rankers where @xmath14 is the position of the first ` a ` in @xmath15 ( from the left ) and @xmath16 is the position of the first ` b ` in @xmath15 from the right .",
    "similarly , the 2-ranker @xmath17 denotes the position of the first ` c ` to the right of the first ` a ` , and the 3-ranker , @xmath18 denotes the position of the first ` b ` to the left of @xmath19 .",
    "if there is no such letter then the ranker is undefined .",
    "for example , @xmath20 and @xmath21 is undefined .",
    "our first structure theorem ( theorem [ thm : ranker - char ] ) says that the properties expressible in @xmath22<@xmath4{2}{n}$ ] , i.e. first - order logic with two variables and quantifier depth @xmath0 , are exactly boolean combinations of statements of the form , `` @xmath23 is defined '' , and `` @xmath23 is to the left ( right ) of @xmath24 '' for @xmath8-rankers , @xmath23 , and @xmath25-rankers , @xmath24 , with @xmath26 and @xmath27 . a non - quantitative version of this theorem was previously known @xcite . in fact",
    "[ fact ] : a `` turtle language '' is a language of the form `` @xmath23 is defined '' , for some ranker , @xmath23 . ] furthermore , a quantitative version in terms of iterated block products of the variety of semi - lattices is presented in @xcite , based on work by straubing and thrien @xcite .",
    "surprisingly , theorem [ thm : ranker - char ] can be generalized in almost exactly the same form to characterize @xmath28 $ ] where there are at most @xmath1 blocks of alternating quantifiers , @xmath2 .",
    "this second structure theorem ( theorem [ thm : alt - ranker - char ] ) uses the notion of @xmath29-ranker where there are @xmath1 blocks of @xmath30 s or @xmath31 s , that is , changing direction in rankers corresponds exactly to alternation of quantifiers . using theorem [ thm : alt - ranker - char ]",
    "we prove that there is a strict alternation hierarchy for @xmath32 $ ] ( theorem [ thm : alt - hierarchy ] ) but that exactly at most @xmath33 alternations are useful , where @xmath34 is the size of the alphabet ( theorem [ thm : alt - alphabet ] ) .",
    "the language @xmath5 $ ] is more expressive than @xmath6 $ ] because it allows us to talk about consecutive strings of symbols using the ordering : @xmath35 . ] . for @xmath5",
    "$ ] , a straightforward generalization of @xmath0-ranker to @xmath0-successor - ranker allows us to prove exact analogs of theorems [ thm : ranker - char ] and [ thm : alt - ranker - char ] .",
    "we use the latter to prove that there is also a strict alternation hierarchy for @xmath36 $ ] ( theorem [ thm : suc - alt - hierarchy ] ) .",
    "since in the presence of successor we can encode an arbitrary alphabet in binary , no analog of theorem [ thm : alt - alphabet ] holds for @xmath5 $ ] .",
    "the expressive power of first - order logic with three or more variables on words has been well - studied .",
    "the languages expressible are of course the star - free regular languages @xcite .",
    "the dot - depth hierarchy is the natural hierarchy of these languages .",
    "this hierarchy is strict @xcite and identical to the first - order quantifier alternation hierarchy @xcite .",
    "many beautiful results on @xmath7 on words were also already known .",
    "the main significant outstanding question was whether there was an alternation hierarchy .",
    "the following is a summary of the main previously known characterizations of @xmath6 $ ] on words . for a detailed treatment of all these characterizations , we refer the reader to @xcite .",
    "[ fact ] let @xmath37 .",
    "the following conditions are equivalent :    1 .",
    "@xmath38 $ ] 2 .",
    "@xmath39 is expressible in unary temporal logic 3 .",
    "@xmath40 $ ] 4 .",
    "[ ul ] @xmath39 is an unambiguous regular language 5 .",
    "the syntactic semi - group of @xmath39 is a member of * da * 6 .",
    "@xmath39 is recognizable by a partially - ordered 2-way automaton 7 .",
    "[ turtle ] @xmath39 is a boolean combination of `` turtle languages ''    the proofs of our structure theorems are self - contained applications of games .",
    "all of the above characterizations follow from these results .",
    "furthermore , we have now exactly connected quantifier and alternation depth to the picture , thus adding tight bounds and further insight to the above results .",
    "for example , one can best understand item [ ul ] above  that @xmath6 $ ] on words corresponds to the unambiguous regular languages  via theorem [ thm : unique - rankers ] which states that any @xmath32 $ ] formula with one free variable that is always true of at most one position in any string , necessarily denotes an @xmath0-ranker .    in the conclusion of @xcite , the authors define the subclasses of rankers with one and two blocks of alternation .",
    "they write that , ``  turtle languages might turn out to be a helpful tool for further studies in algebraic language theory . ''",
    "we feel that the present paper fully justifies that prediction .",
    "turtle languages  aka rankers  do provide an exceptionally clear and precise understanding of the expressive power of @xmath41 on words , with and without successor .    in summary ,",
    "our structure theorems provide a complete classification of the expressive power of @xmath7 on words in terms of both quantifier depth and alternation .",
    "they also tighten several previous characterizations and lead to the alternation hierarchy results .",
    "we begin the remainder of this paper with a brief review of logical background including games , our main tool . in sect .",
    "[ sec : fo2 ] we formally define rankers and present our structure theorem for @xmath22<@xmath4{2}{n}$ ] . the structure theorem for @xmath42<@xmath4{2}{n}{m}$ ]",
    "is covered in sect .",
    "[ sec : fo2-alt ] , including our alternation hierarchy result that follows from it .",
    "[ sec : fo2-suc ] extends our structure theorems and the alternation hierarchy result to @xmath3<,@xmath4{2}$ ] . finally , we discuss applications of our structural results to satisfiability for @xmath3<@xmath4{2}$ ] in sect .",
    "[ sec : satisfiability ] .",
    "we recall some notation concerning strings , first - order logic , and games .",
    "see @xcite for more details , including the proof of facts [ fact : ef1 ] and [ fact : ef2 ] .",
    "@xmath43 will always denote a finite alphabet and @xmath44 the empty string . for a word @xmath45 and @xmath46 $ ] ,",
    "let @xmath47 be the @xmath48-th letter of @xmath15 ; and for @xmath49 $ ] a subinterval of @xmath50 $ ] , let @xmath51}$ ] be the substring @xmath52 . slightly abusing notation , we identify a word @xmath45 with the logical structure @xmath53 . here @xmath54 are all unary relation symbols , and @xmath55 and @xmath56 are the only two variables .",
    "if not specified otherwise , we have @xmath57 by default , and for all @xmath58 , @xmath59 .",
    "furthermore , we write @xmath60 for the word structure @xmath15 with the two variables set to @xmath48 and @xmath61 , respectively , and @xmath62 for the word structure @xmath15 with @xmath63 .",
    "thus @xmath64 , and @xmath65 iff @xmath66 .",
    "we use @xmath67<@xmath4 $ ] to denote first - order logic with a binary linear order predicate @xmath68 , and @xmath69 < , @xmath4 $ ] for first - order logic with an additional binary successor predicate .",
    "@xmath70 refers to the restriction of first - order logic to use at most two distinct variables , and quantifier depth @xmath0 .",
    "@xmath71 is the further restriction to formulas such that any path in their parse tree has at most @xmath1 blocks of alternating quantifiers , and @xmath72 .",
    "we write @xmath73 to mean that @xmath74 and @xmath75 agree on all formulas from @xmath76 , and @xmath77 if they agree on @xmath78 .",
    "we assume that the reader is familiar with our main tool : the game . in each of the @xmath0 moves of the game @xmath79",
    ", samson places one of the two pebble pairs , @xmath55 or @xmath56 on a position in one of the two words and delilah then answers by placing that pebble s mate on a position of the other word .",
    "samson wins if after any move , the map from the chosen points in @xmath74 to those in @xmath75 , i.e. , @xmath80 , @xmath81 is not an isomorphism of the induced substructures ; and delilah wins otherwise .",
    "the fundamental theorem of games is the following :    [ fact : ef1 ] let @xmath82 , @xmath83 .",
    "delilah has a winning strategy for the game @xmath79 iff @xmath73 .",
    "thus , games are a perfect tool for determining what is expressible in first - order logic with a given quantifier - depth and number of variables .",
    "the game @xmath84 is the restriction of the game @xmath79 in which samson may change which word he plays on at most @xmath85 times .",
    "[ fact : ef2 ] let @xmath82 and let @xmath86 with @xmath87 .",
    "delilah has a winning strategy for the game @xmath84 iff @xmath88 .",
    "we end this section with a simple lemma that will be useful whenever we want to prove that there is a formula expressing a property of strings . with this lemma",
    ", it suffices to show that for any pair of strings , one with the property in question and one without , there is a formula that distinguishes between these two particular strings .",
    "[ lem : fin - equiv ] let @xmath89 and let @xmath90 be a logic closed under boolean operations with only finitely many inequivalent formulas . if for every @xmath91 and every @xmath92 there is a formula @xmath93 such that @xmath94 and @xmath95 , then there is a formula @xmath96 such that for all @xmath97 , @xmath98 .",
    "let @xmath99 , and let @xmath100 be a maximal subset of @xmath101 containing only inequivalent formulas . since @xmath90 contains only finitely many inequivalent formulas , @xmath100 is finite . for every @xmath91",
    ", we define the finite sets of formulas @xmath102",
    ". since all these sets are subsets of the finite set @xmath100 , there can only be finitely many of them .",
    "thus there is a finite set @xmath103 such that @xmath104 .",
    "now we set @xmath105 we have @xmath96 and for every @xmath97 , @xmath106 as required .",
    "it is well - known @xcite that for any @xmath107 , the logics @xmath76 and @xmath78 , both with and without the successor predicate , have only finitely many inequivalent formulas .",
    "thus the above lemma applies to these logics .",
    "we define boundary positions that point to the first or last occurrences of a letter in a word , and define an @xmath0-ranker as a sequence of @xmath0 boundary positions . in terms of @xcite ,",
    "boundary positions are turtle instructions and @xmath0-rankers are turtle programs of length @xmath0 .",
    "the following three lemmas show that basic properties about the definedness and position of these rankers can be expressed in @xmath3<@xmath4{2}$ ] , and we use these results to prove our structure theorem .",
    "[ def : boundary - position ] a _ boundary position _ denotes the first or last occurrence of a letter in a given word .",
    "boundary positions are of the form @xmath108 where @xmath109 and @xmath58 .",
    "the interpretation of a boundary position @xmath108 on a word @xmath110 is defined as follows .",
    "@xmath111 \\mid w_i = \\mathtt{a}\\ } & \\text{if } d = \\rright\\\\        \\max\\{i \\in [ 1 , |w| ] \\mid w_i = \\mathtt{a}\\ } & \\text{if } d = \\rleft      \\end{cases}\\ ] ] here we set @xmath112 and @xmath113 to be undefined , thus @xmath114 is undefined if @xmath115 does not occur in @xmath15 .",
    "a boundary position can also be specified with respect to a position @xmath116 $ ] .",
    "@xmath117 \\mid w_i = \\mathtt{a}\\ } & \\text{if } d = \\rright\\\\        \\max\\{i \\in [ 1 , q-1 ] \\mid w_i = \\mathtt{a}\\ } & \\text{if } d = \\rleft      \\end{cases}\\ ] ]    [ def : n - ranker ] let @xmath0 be a positive integer .",
    "an _ @xmath0-ranker _",
    "@xmath23 is a sequence of @xmath0 boundary positions .",
    "the interpretation of an @xmath0-ranker @xmath118 on a word @xmath15 is defined as follows .",
    "@xmath119    instead of writing @xmath0-rankers as a formal sequence @xmath120 , we often use the simpler notation @xmath121 .",
    "we denote the set of all @xmath0-rankers by @xmath122 , and the set of all @xmath0-rankers that are defined over a word @xmath15 by @xmath123 .",
    "furthermore , we set @xmath124 } r_i$ ] and @xmath125 } r_i(w)$ ] .",
    "let @xmath23 be an @xmath0-ranker .",
    "as defined above , we have @xmath126 for boundary positions @xmath127 .",
    "@xmath8-prefix ranker _ of @xmath23 for @xmath128 $ ] is @xmath129 .",
    "[ def : order - type ] let @xmath130 .",
    "the _ order type _ of @xmath48 and @xmath61 is defined as @xmath131    [ lem : ranker - sides ] let @xmath0 be a positive integer , let @xmath132 and let @xmath133 .",
    "samson wins the game @xmath134 where initially @xmath135 .",
    "we only look at the case where @xmath136 and @xmath137 since all other cases are symmetric to this one . for @xmath138 samson",
    "has a winning strategy : if @xmath23 is the first occurrence of a letter , then samson places @xmath56 on @xmath139 and delilah can not reply .",
    "if @xmath23 marks the last occurrence of a letter in the whole word , then samson places @xmath56 on @xmath140 .",
    "again , delilah can not reply with any position and thus loses .",
    "( 7cm,3.3cm)[fr ]    for @xmath141 , we look at the prefix ranker @xmath142 of @xmath23 .",
    "one of the following two cases applies .    1 .   ( 7cm,2.8cm)[r ] @xmath143 , as shown in fig .",
    "[ fig : ranker - sides-2 ] .",
    "samson places pebble @xmath56 on @xmath139 , and delilah has to reply with a position that is to the left of @xmath144 .",
    "she can not choose a position in the interval @xmath145 , because this section does not contain the letter @xmath146 .",
    "thus she has to choose a position left of or equal to @xmath147 . by induction samson",
    "wins the remaining game .",
    "2 .   ( 7cm,3.3cm)[fr ] + @xmath148 , as shown in fig .",
    "[ fig : ranker - sides-3 ] .",
    "samson places @xmath56 on @xmath140 , and delilah has to reply with a position to the right of @xmath149 and thus to the right of @xmath139 .",
    "she can not choose any position in @xmath150 , because this interval does not contain the letter @xmath151 , thus delilah has to choose a position to the right of or equal to @xmath152 . by induction samson wins the remaining game .",
    "[ lem : ranker - def ] let @xmath0 be a positive integer , and let @xmath153 . there is a formula @xmath154<@xmath4{2}{n}$ ] such that for all @xmath155 , @xmath156 .    using lemma @xmath157 it suffices to consider arbitrary @xmath158 with @xmath159 and @xmath160 , and using fact [ fact : ef1 ]",
    ", it suffices to show that samson wins the game @xmath134 .",
    "if @xmath161 , the shortest prefix ranker of @xmath23 , is not defined over @xmath75 , the letter referred to by @xmath161 occurs in @xmath74 but does not occur in @xmath75 .",
    "thus samson easily wins in one move .",
    "( 5cm,3.3cm)[fr ]    otherwise we let @xmath162 be the shortest prefix ranker of @xmath23 that is undefined over @xmath75 .",
    "thus @xmath163 is defined over both words . without loss of generality",
    "we assume that @xmath164 .",
    "this situation is illustrated in fig .",
    "[ fig : rankpos-4 ] .",
    "notice that @xmath75 does not contain any ` a ` s to the left of @xmath165 , otherwise @xmath166 would be defined over @xmath75 .",
    "samson places @xmath55 in @xmath74 on @xmath167 , and delilah has to reply with a position right of or equal to @xmath165 .",
    "now lemma [ lem : ranker - sides ] applies and samson wins in @xmath168 more moves .    [",
    "lem : ranker - exp ] let @xmath0 be a positive integer and let @xmath153 .",
    "there is a formula @xmath169<@xmath4{2}{n}$ ] such that for all @xmath97 and for all @xmath170 $ ] , @xmath171 @xmath172 @xmath173 .    as in the proof of lemma [ lem : ranker - def ]",
    ", it suffices to show that for arbitrary @xmath132 , samson wins the game @xmath174 where initially @xmath175 and @xmath176 .",
    "if @xmath140 is defined over @xmath75 , then we can apply lemma [ lem : ranker - sides ] immediately to get the desired strategy for samson .",
    "otherwise we use the strategy from lemma [ lem : ranker - def ] .",
    "[ thm : ranker - char ] let @xmath74 and @xmath75 be finite words , and let @xmath177 .",
    "the following two conditions are equivalent .    1 .   1",
    ".   @xmath178 , and , 2 .   for all @xmath179 and @xmath180 , @xmath181 2 .",
    "@xmath73    notice that condition ( i)(a ) is equivalent to @xmath182 .",
    "instead of proving theorem [ thm : ranker - char ] directly , we prove the following more general version on words with two interpreted variables .",
    "[ thm : structure - variables ] let @xmath74 and @xmath75 be finite words , let @xmath183 $ ] , let @xmath184 $ ] , and let @xmath177 .",
    "the following two conditions are equivalent .    1 .   1 .   @xmath178 , and , 2 .   for all @xmath179 and @xmath180 , @xmath181 , and , 3 .",
    "@xmath185 , and , 4 .   for all @xmath179 , @xmath186 and @xmath187 2 .",
    "@xmath188    for @xmath189 , ( i)(a ) , ( i)(b ) and ( i)(d ) are vacuous , and ( i)(c ) is equivalent to ( ii ) .",
    "for @xmath190 , we prove the two implications individually using induction on @xmath0 .",
    "we first show `` @xmath191 '' . assuming that ( i ) holds for @xmath177 but fails for @xmath192 , we show that @xmath193 by giving a winning strategy for samson in the game on the two structures .",
    "if ( i)(c ) does not hold , then samson wins immediately .",
    "if ( i)(d ) does not hold for @xmath192 , then samson wins by lemma [ lem : ranker - sides ] .",
    "if ( i)(a ) or ( i)(b ) do not hold for @xmath192 , then one of the following three cases applies .    1 .",
    "there is an @xmath194-ranker that is defined over one word but not over the other .",
    "there are two @xmath0-rankers that do not agree on their ordering in @xmath74 and @xmath75 .",
    "3 .   there is an @xmath194-ranker that does not appear in the same order on both structures with respect to a @xmath8-ranker where @xmath195 .",
    "we first look at case ( 2 ) where there are two rankers @xmath196 that disagree on their ordering in @xmath74 and @xmath75 . without loss of generality",
    "we assume that @xmath197 and @xmath198 , and present a winning strategy for samson in the @xmath199 game . in the first move he places @xmath55 on @xmath139 in @xmath74 .",
    "delilah has to reply with @xmath140 in @xmath75 , otherwise she would lose the remaining @xmath0-move game as shown in lemma [ lem : ranker - sides ] . let @xmath200 be the @xmath201-prefix - ranker of @xmath24 .",
    "we look at two different cases depending on the ordering of @xmath200 and @xmath24 .",
    "( 7cm,3.3cm)[fr ]    for @xmath202 , the situation is illustrated in fig .",
    "[ fig : char - order-1 ] . in his second move",
    ", samson places @xmath56 on @xmath203 .",
    "delilah has to reply with a position to the left of @xmath149 , but she can not choose any position from the interval @xmath204 because it does not contain the letter @xmath205 .",
    "so she has to reply with a position left of or equal to @xmath206 , and samson wins the remaining game as shown in lemma [ lem : ranker - sides ] .",
    "( 7cm,3.3cm)[fr ]    for @xmath207 , the situation is illustrated in fig .",
    "[ fig : char - order-2 ] . in his second move ,",
    "samson places pebble @xmath56 on @xmath208 , and delilah has to reply with a position to the right of @xmath144 , but she can not choose anything from the interval @xmath209 because this section does not contain the letter @xmath210 .",
    "thus she has to reply with a position right of or equal to @xmath211 , and samson wins the remaining game as shown in lemma [ lem : ranker - sides ] .",
    "( 5.8cm,3.3cm)[fr ]    now we look at cases ( 1 ) and ( 3 ) , assuming that case ( 2 ) does not apply .",
    "we know that condition ( i ) from the statement of the theorem fails , but still all @xmath0-rankers agree on their ordering . in both case ( 1 ) and case ( 3 ) , there are two consecutive @xmath0-rankers @xmath212 with @xmath213 and a letter @xmath58 such that without loss of generality ` a ` occurs in the segment @xmath214 but not in the segment @xmath215 .",
    "we describe a winning strategy for samson in the game @xmath216 .",
    "he places @xmath55 on an ` a ` in the segment @xmath217 of @xmath74 , as shown in fig .",
    "[ fig : char - final ]",
    ". delilah can not reply with anything in the interval @xmath218 .",
    "if she replies with a position left of or equal to @xmath140 , then @xmath55 is on different sides of the @xmath0-ranker @xmath23 in the two words .",
    "thus lemma [ lem : ranker - sides ] applies and samson wins the remaining @xmath0-move game . if delilah replies with a position right of or equal to @xmath203 , then we can apply lemma [ lem : ranker - sides ] to @xmath24 and get a winning strategy for the remaining game as well .",
    "this concludes the proof of `` @xmath191 '' .    to show `` ( i )",
    "@xmath219 ( ii ) '' , we assume ( i ) for @xmath192 , and present a winning strategy for delilah in the @xmath199 game on the two structures .",
    "in his first move samson picks up one of the two pebbles , and places it on a new position . without loss of generality",
    "we assume that samson picks up @xmath55 and places it on @xmath74 in his first move .",
    "if @xmath220 for any ranker @xmath221 , then delilah replies with @xmath222 . this establishes ( i)(c ) and ( i)(d ) for @xmath0 , and thus delilah has a winning strategy for the remaining game by induction .",
    "if samson does not place @xmath149 on any ranker from @xmath223 , then we look at the closest rankers from @xmath224 to the left and right of @xmath149 , denoted by @xmath225 and @xmath226 , respectively .",
    "let @xmath227 and define the @xmath194-ranker @xmath228 .",
    "on @xmath74 we have @xmath229 . because of ( i)(a ) @xmath230 is defined on @xmath75 as well , and",
    "because of ( i)(b ) , we have @xmath231 . if @xmath232 is not contained in the interval @xmath233 , then delilah places @xmath55 on @xmath234 , which establishes ( i)(c ) and ( i)(d ) for @xmath0 .",
    "thus by induction delilah has a winning strategy for the remaining game .",
    "( 7cm,3.3cm)[fr ]    if both pebbles @xmath149 and @xmath232 occur in the interval @xmath235 , then we need to be more careful . without loss of generality",
    "we assume @xmath236 as illustrated in fig .",
    "[ fig : rankchar-1 ] .",
    "thus delilah has to place @xmath55 in the interval @xmath237 and at a position with letter @xmath227 .",
    "we define the @xmath192-ranker @xmath238 . from ( i)(d ) we know that @xmath230 appears on the same side of @xmath56 in both structures , thus we have @xmath239 .",
    "delilah places her pebble @xmath55 on @xmath234 , and thus establishes ( i)(c ) and ( i)(d ) for @xmath0 .",
    "by induction , delilah has a winning strategy for the remaining game .",
    "a fundamental property of an @xmath0-ranker is that it uniquely describes a position in a given word .",
    "now we show that the converse holds as well : any position in a word that can be uniquely described with an formula can also be described by a ranker ( lemma [ lem : unique - rankers ] ) . furthermore , any formula that describes a unique position in any given word is equivalent to a boolean combination of rankers ( theorem [ thm : unique - rankers ] ) .",
    "[ def : unique - pos ] a formula @xmath240<@xmath4{2}$ ] with @xmath55 as a free variable is a _ unique position formula _ if for all @xmath97 there is at most one @xmath170 $ ] such that @xmath241 .",
    "[ lem : unique - rankers ] let @xmath0 be a positive integer and let @xmath242<@xmath4{2}{n}$ ] be a unique position formula .",
    "let @xmath243 and let @xmath244 $ ] such that @xmath245",
    ". then @xmath246 for some ranker @xmath247 .",
    "suppose for the sake of a contradiction that there is no ranker @xmath247 such that @xmath248 . because the first and last positions in @xmath74 are described by 1-rankers , we know that @xmath249 .",
    "we construct a new word @xmath75 by doubling the symbol at position @xmath48 in @xmath74 , @xmath250 . by assumption",
    ", there is no @xmath0-ranker that describes position @xmath48 in @xmath74 . a brief argument by contradiction shows that there are also no @xmath0-rankers that describe positions @xmath48 or @xmath251 in @xmath75 : assuming that such a ranker exists , let @xmath23 be the shortest such ranker .",
    "thus none of the prefix rankers of @xmath23 point to either positions @xmath48 or @xmath251 in @xmath75 .",
    "this means that all prefix rankers of @xmath23 are interpreted in exactly the same way on both @xmath74 and @xmath75 , and irrespective of whether @xmath140 points to @xmath48 or @xmath251 , we have have @xmath252 , a contradiction . hence all @xmath0-rankers are insensitive to the doubling of @xmath253 , and the two words @xmath74 and @xmath75 agree on the definedness of all @xmath0-rankers and on their ordering . by theorem [ thm : structure - variables ]",
    ", we thus have @xmath254 , which contradicts the fact that @xmath255 is a unique position formula .",
    "[ thm : unique - rankers ] let @xmath0 be a positive integer and let @xmath242<@xmath4{2}{n}$ ] be a unique position formula .",
    "there is a @xmath256 , and there are mutually exclusive formulas @xmath257<@xmath4{2}{n}$ ] and rankers @xmath258 such that @xmath259 } \\left ( \\alpha_i \\land \\varphi_{r_i } \\right)\\ ] ] where @xmath260<@xmath4{2}{n}$ ] is the formula from lemma [ lem : ranker - exp ] that uniquely describes the ranker @xmath166 .",
    "let @xmath261 be the set of all types of words over @xmath43 with one interpreted variable . because there are only finitely many inequivalent formulas in",
    ", @xmath261 is finite .",
    "let @xmath262 be the set of all types that satisfy @xmath255 .",
    "we set @xmath263 and let @xmath264<@xmath4{2}{n}$ ] be a description of type @xmath265 .",
    "thus @xmath266 } \\alpha_i$ ] .    now suppose that @xmath267 .",
    "thus @xmath268 for some @xmath48 .",
    "by lemma [ lem : unique - rankers ] @xmath269 for some @xmath270 .",
    "thus @xmath271 since @xmath272 and @xmath273 is a complete @xmath70 formula .",
    "thus @xmath274 so @xmath255 is in the desired form .",
    "we define alternation rankers and prove our structure theorem ( theorem [ thm : alt - ranker - char ] ) for @xmath42<@xmath4{2}{n}{m}$ ] .",
    "surprisingly the number of alternating blocks of @xmath31 and @xmath30 in the rankers corresponds exactly to the number of alternating quantifier blocks .",
    "the main ideas from our proof of theorem [ thm : ranker - char ] still apply here , but keeping track of the number of alternations does add complications .",
    "[ def : alt - ranker ] let @xmath107 with @xmath87 .",
    "@xmath1-alternation @xmath0-ranker _ , or @xmath29-ranker , is an @xmath0-ranker with exactly @xmath1 blocks of boundary positions that alternate between @xmath30 and @xmath31 .",
    "we use the following notation for alternation rankers .",
    "@xmath275 , j \\in [ 1,n ] } r_{i , j}(w)\\\\    r^\\star_{m\\rright , n}(w )    & : = r^\\star_{m-1,n}(w ) \\cup \\bigcup_{i \\in [ 1,n ] } r_{m\\rright , i}(w)\\end{aligned}\\ ] ]    [ lem : alt - ranker - sides ] let @xmath1 and @xmath0 be positive integers with @xmath87 , let @xmath132 , and let @xmath276 .",
    "samson wins the game @xmath277 where initially @xmath278 .",
    "furthermore , samson can start the game with a move on @xmath74 if @xmath23 ends with @xmath30 , @xmath279 and @xmath280 , or if @xmath23 ends with @xmath31 , @xmath281 and @xmath282 .",
    "he can start the game with a move on @xmath75 if @xmath23 ends with @xmath30 , @xmath281 and @xmath283 , or if @xmath23 ends with @xmath31 , @xmath279 and @xmath280 .",
    "if @xmath284 , then we can immediately apply the base case from the proof of lemma [ lem : ranker - sides ] .",
    "samson wins in one move , placing his pebble on @xmath74 or @xmath75 as specified .    for the remaining cases ,",
    "we assume without loss of generality that @xmath23 ends with @xmath30 and that @xmath136 and @xmath285 .",
    "let @xmath142 be the @xmath201-prefix ranker of @xmath23 .",
    "this situation is illustrated in fig .",
    "[ fig : ranker - sides-2 ] of lemma [ lem : ranker - sides ] .",
    "samson places @xmath56 on @xmath139 , and creates a situation where @xmath286 and @xmath287 .",
    "if @xmath142 ends with @xmath31 , then by induction samson wins the remaining game and thus he has a winning strategy for the game .",
    "if @xmath142 ends with @xmath30 , then by induction samson wins the remaining game starting with a move on @xmath74 , and thus he has a winning strategy for the game .",
    "[ lem : alt - ranker - def ] let @xmath1 and @xmath0 be positive integers with @xmath87 and let @xmath288 .",
    "there is a @xmath289<@xmath4{2}{n}{m}$ ] such that for all @xmath97 , @xmath290 .    using lemma @xmath157 it suffices to consider arbitrary @xmath158 with @xmath291 and @xmath292 , and using fact [ fact : ef1 ]",
    ", it suffices to show that samson wins the game @xmath277 .",
    "let @xmath162 be the shortest prefix ranker of @xmath23 that is undefined over @xmath75 , and we assume without loss of generality that this ranker ends with the boundary position @xmath293 for some @xmath58 .",
    "this situation is illustrated in fig .",
    "[ fig : rankpos-4 ] for lemma [ lem : ranker - exp ] . in his first move samson",
    "places @xmath55 on @xmath167 and thus forces a situation where @xmath294 and @xmath295 .",
    "if @xmath163 ends with @xmath31 , then according to lemma [ lem : alt - ranker - sides ] , samson wins the remaining game starting with a move on @xmath74 .",
    "otherwise @xmath163 ends with @xmath30 , and thus by lemma [ lem : alt - ranker - sides ] samson wins the remaining game starting with a move on @xmath75 .",
    "[ lem : alt - ranker - exp ] let @xmath1 and @xmath0 be positive integers with @xmath87 and let @xmath288 .",
    "there is a formula @xmath296<@xmath4{2}{n}{m}$ ] such that for all @xmath97 and for all @xmath170 $ ] , @xmath297 .    as in the proof of lemma [ lem : alt - ranker - def ]",
    ", it suffices to show that samson wins the game @xmath277 where initially @xmath298 and @xmath176 .",
    "depending on whether @xmath23 is defined over @xmath75 , we use the strategies from lemma [ lem : alt - ranker - sides ] or lemma [ lem : alt - ranker - def ] .",
    "[ thm : alt - ranker - char ] let @xmath74 and @xmath75 be finite words , and let @xmath86 with @xmath87 .",
    "the following two conditions are equivalent .    1 .   1",
    ".   @xmath299 , and , 2 .   for all @xmath300 and for all @xmath301",
    ", we have + @xmath302 , and , 3 .   for all @xmath300 and @xmath303 such that @xmath23 and @xmath24 end with different directions , @xmath302 2 .   @xmath77    just as before with theorem [ thm : ranker - char ] , instead of proving theorem [ thm : alt - ranker - char ] directly , we prove a more general version that applies to words with two interpreted variables .",
    "the statement of the general version is asymmetric with respect to the roles of the two structures @xmath74 and @xmath75 .",
    "this is necessary because of the correspondence between quantifier alternations ( i.e. alternations between @xmath74 and @xmath75 in the game ) and alternations of directions in the rankers .",
    "this asymmetry already affected the statement of lemma [ lem : alt - ranker - sides ] , where samson s winning strategy starts with a move on the specified structure .",
    "in fact , as the proof of the following theorem shows , he does not have a winning strategy that starts with a move on the other structure .",
    "we remark that conditions ( i)(a ) through ( i)(e ) of the general theorem are completely symmetric with respect to the roles of @xmath74 and @xmath75 , and only conditions ( i)(f ) and ( ii ) are asymmetric .",
    "theorem [ thm : alt - ranker - char ] follows directly from the general theorem , since here @xmath304 , thus conditions ( i)(e ) and ( i)(f ) or trivially true , and the equivalence holds with the roles of @xmath74 and @xmath75 reversed as well .",
    "let @xmath74 and @xmath75 be finite words , let @xmath183 $ ] , let @xmath305 $ ] , and let @xmath86 with @xmath87 .",
    "the following two conditions are equivalent .    1 .   1",
    ".   @xmath299 , and , 2 .   for all @xmath300 and for all @xmath301",
    ", we have + @xmath302 , and , 3 .   for all @xmath300 and @xmath303 such that @xmath23 and @xmath24 end with different directions , @xmath302 4 .",
    "@xmath185 , and , 5 .   for all @xmath306 , @xmath307 and @xmath308 , and , 6 .   for all @xmath300 , and @xmath309 , 1",
    "if @xmath23 ends on @xmath30 and @xmath252 , then @xmath310 2 .",
    "if @xmath23 ends on @xmath30 and @xmath311 , then @xmath312 3 .",
    "if @xmath23 ends on @xmath31 and @xmath252 , then @xmath313 4 .",
    "if @xmath23 ends on @xmath31 and @xmath314 , then @xmath315 2 .",
    "delilah wins the game @xmath42<@xmath4{2}{n}{m}((u , i_1 , i_2 ) , ( v , j_1 ,      j_2))$ ] if samson starts with a move on @xmath316 .    as in the proof of theorem [ thm : ranker - char ] , we use induction on @xmath0 . for @xmath317 , condition ( i)(d )",
    "just by itself is equivalent to ( ii ) , and all other conditions of ( i ) are vacuous . for @xmath190 , we we first show `` @xmath318 ( i ) @xmath219 @xmath318 ( ii ) '' .",
    "suppose that ( i ) holds for @xmath29 , but fails for @xmath319 .",
    "if ( i)(d ) does not hold then samson wins immediately .",
    "if ( i)(e ) does not hold for @xmath319 , then by lemma [ lem : alt - ranker - sides ] , samson wins the @xmath319-game on @xmath320 , starting with a move on either @xmath74 or @xmath75 .",
    "if samson can start with a move on @xmath74 , we have established that ( ii ) is false . otherwise , we reverse the roles of @xmath74 and @xmath75 , and observe that condition ( i)(e ) still remains the same .",
    "thus , even if samson needs to start with a move on @xmath75 , he still has a winning strategy , and ( ii ) does not hold for @xmath319 .",
    "if ( i)(f ) does not hold for @xmath319 , then again by using lemma [ lem : alt - ranker - sides ] , samson wins the @xmath319-game on @xmath320 starting with a move on @xmath74 .",
    "if one of ( i)(a ) , ( i)(b ) or ( i)(c ) fail , then we show that samson has a winning strategy for the game @xmath321 .",
    "we observe that it does not matter what structure samson chooses for his first move , since all of ( i)(a ) , ( i)(b ) and ( i)(c ) are completely symmetric with respect to the roles of @xmath74 and @xmath75 .",
    "thus if samson s winning strategy starts with a move on @xmath75 , we can reverse the roles of @xmath74 and @xmath75 and get a winning strategy starting with move on @xmath74 .",
    "one of the following cases applies .    1 .",
    "there is a ranker @xmath322 that is defined over one structure but not over the other .",
    "this first case applies if ( a ) fails for @xmath319 .",
    "if condition ( 2 ) fails for @xmath323 , then there are two @xmath0-rankers for which it fails , or an @xmath194-ranker and an @xmath0-ranker .",
    "this leads to the following two cases .    1 .",
    "there are two rankers @xmath291 and @xmath324 that disagree on their order , i.e. @xmath325 .",
    "2 .   there are two rankers @xmath326 and @xmath324 that disagree on their order .    in a similar fashion , we obtain the remaining two cases if condition ( 3 ) fails for @xmath323 .    1",
    ".   there are rankers @xmath327 that end on different directions and disagree on their order .",
    "2 .   there are rankers @xmath326 and @xmath328 that end on different directions and disagree on their order .",
    "we look at the cases ( 2 ) and ( 4 ) first , then deal with case ( 1 ) assuming that cases ( 2 ) and ( 4 ) do not apply , and finally look at cases ( 3 ) and ( 5 ) .    for case",
    "( 2 ) , we assume that @xmath197 , as illustrated in fig .",
    "[ fig : alt - rankchar - order ] .",
    "the situation for @xmath329 is completely symmetric .",
    "depending on the last boundary position of @xmath23 , one of the following two subcases applies .    1",
    ".   @xmath23 ends with @xmath30 .",
    "samson places @xmath55 on @xmath139 in his first move . if delilah replies with a position to the left of @xmath203 or equal to @xmath203 , then @xmath137 .",
    "thus we can apply lemma [ lem : alt - ranker - sides ] to get a winning strategy for samson in the remaining game that starts with a move on @xmath74 .",
    "if delilah replies with a position to the right of @xmath203 , samson has a winning strategy for the remaining game .",
    "thus we have a winning strategy for samson in the game .",
    "2 .   @xmath23 ends with @xmath31 .",
    "this is similar to the previous case , but now samson places @xmath55 on @xmath140 in his first move . if delilah replies with a position to the right of @xmath208 , or equal to @xmath208 , then as above we get a winning strategy for samson in the remaining game that starts with a move on @xmath75 .",
    "otherwise we get a winning strategy for samson with only @xmath85 alternations for the remaining game .",
    "thus again he has a winning strategy for the game .    for case",
    "( 4 ) , samson s winning strategy is very similar to the previous case .",
    "if @xmath197 and @xmath23 ends with @xmath30 , then samson places @xmath55 on @xmath139 in his first move .",
    "if delilah replies with a position to the right of @xmath139 , then samson s winning strategy is as above .",
    "otherwise @xmath55 is on different sides of @xmath24 and samson has a winning strategy for the remaining game that starts with a move on @xmath74 .",
    "all together , he has a winning strategy for the game .",
    "the remaining three cases ( ordering of @xmath139 and @xmath208 and ending direction of @xmath23 ) work in the same way .    similar to what we did in the proof of theorem [ thm : ranker - char ] , we can reduce the remaining cases to an easier situation where a certain segment contains a certain letter in one structure , but not in the other structure , and then apply lemma [ lem : alt - ranker - sides ] to obtain a winning strategy for samson .    to deal with case ( 1 ) , we assume that the previous two cases , ( 2 ) and ( 4 ) , do not apply . without loss of generality ,",
    "say that the @xmath319-ranker @xmath23 is defined over @xmath74 but not over @xmath75 .",
    "let @xmath330 be the letter in @xmath74 at position @xmath139 .",
    "we define the following sets of rankers .",
    "@xmath331 notice that all rankers from @xmath332 appear to the left of all rankers from @xmath333 in @xmath74 . from the inductive hypothesis , and from the fact that both cases ( 2 ) and ( 4 ) do not apply",
    ", it follows that over @xmath75 , all rankers from @xmath332 appear to the left of all rankers from @xmath333 as well .",
    "however , the rankers from @xmath332 and @xmath333 by themselves do not necessarily appear in the same order in both structures .",
    "we look at the ordering of these rankers in @xmath75 , and let @xmath225 be the rightmost ranker from @xmath332 and @xmath226 be the leftmost ranker from @xmath333 . by construction , we have @xmath334 , so the segment @xmath335 in @xmath74 contains the letter @xmath336 .",
    "let @xmath337 be the @xmath0-prefix - ranker of @xmath23 , and observe that @xmath337 is defined on both structures and that @xmath337 is contained in either @xmath332 or @xmath333 .",
    "because @xmath23 is not defined on @xmath75 , the letter @xmath336 does not occur in @xmath75 either to the right of @xmath337 if @xmath338 , or to the left of @xmath337 if @xmath339 .",
    "thus the segment @xmath335 does not contain the letter @xmath336 in @xmath75 .",
    "( 5.7cm,3.3cm)[fr ]    now we know that @xmath336 occurs in the segment @xmath335 in @xmath74 but not in @xmath75 , and thus we have established the situation illustrated in fig .",
    "[ fig : alt - ranker - char - middle ] .",
    "samson places his first pebble on an @xmath336 within this section of @xmath74 , and delilah has to reply with a position outside of this section .",
    "no matter what side of the segment she chooses , with lemma [ lem : alt - ranker - sides ] samson has a winning strategy for the remaining game and thus wins the game .    in cases ( 3 ) and ( 5 )",
    ", we again assume that cases ( 2 ) and ( 4 ) do not apply , and we look at the same sets of rankers , @xmath332 and @xmath333 , and at @xmath337 , the @xmath0-prefix - ranker of @xmath23 .",
    "we assume that @xmath197 and that @xmath23 ends with @xmath30 , all three other cases are completely symmetric .",
    "notice that @xmath337 is an @xmath340-ranker , or an @xmath29-ranker that ends with @xmath30 .",
    "thus both structures agree on the ordering of @xmath337 and @xmath24 .",
    "the relative positions of all these rankers are illustrated in fig .",
    "[ fig : alt - ranker - char - closest ] . as above ,",
    "let @xmath225 be the rightmost ranker from @xmath332 and let @xmath226 be the leftmost ranker from @xmath333 , with respect to the ordering of these rankers on @xmath75 .",
    "again we know that @xmath334 and therefore the segment @xmath335 of @xmath74 contains an @xmath336 . notice that @xmath341 and @xmath342 , thus @xmath343 .",
    "thus the segment @xmath335 does not contain the letter @xmath336 in @xmath75 , providing samson with a winning strategy as argued above .",
    "( 6.2cm,2.5cm)[fr ]    to prove `` ( i ) @xmath219 ( ii ) '' , we assume that the theorem holds for @xmath0 , and that ( i ) holds for @xmath319 , and we present a winning strategy for delilah in the game @xmath321 where samson starts with a move on @xmath74 .    if samson places @xmath55 on a ranker @xmath344 , then delilah replies by placing @xmath55 on the same ranker on @xmath75 .",
    "since ( i)(b ) holds for @xmath319 , this establishes ( i)(e ) and ( i)(f ) for @xmath29 .",
    "it also establishes ( i)(e ) and ( i)(f ) for @xmath340 with reversed roles of @xmath74 and @xmath75 .",
    "thus we can apply the inductive hypothesis to get a winning strategy for delilah in the remaining game .",
    "if @xmath345 after samson s first move , then delilah replies with @xmath346 .",
    "we use the inductive hypothesis to argue that delilah wins the remaining @xmath0-move game , no matter what structure samson chooses for his next move .",
    "if he chooses to play on @xmath74 , then the remaining game is an @xmath29-game . since in the first move delilah set @xmath347",
    ", we have ( i)(e ) and ( i)(f ) for @xmath29 , and thus the inductive hypothesis applies and delilah wins the remaining game . on the other hand ,",
    "if samson chooses to play on @xmath75 for the next move , the remaining game is an @xmath340-game , since he started with a move on @xmath74 .",
    "because delilah set @xmath347 in the first move , ( i)(e ) for @xmath319 implies both ( i)(e ) and ( i)(f ) for @xmath340 with reversed roles of @xmath74 and @xmath75 .",
    "thus we can again use the inductive hypothesis to get a winning strategy for delilah in the remaining game .",
    "otherwise we assume that @xmath348 after samson s first move , the case for @xmath349 is completely symmetric .",
    "we look at the following two sets of rankers .",
    "@xmath350 on @xmath74 , all rankers from @xmath332 occur to the left of all rankers from @xmath333 .",
    "since ( i)(c ) holds for @xmath319 , this is also true for the positions of these rankers on @xmath75 .",
    "let @xmath336 be the letter samson places his pebble on . to establish both ( i)(e ) and ( i)(f ) for @xmath29",
    ", delilah needs to find an @xmath336 in @xmath75 that is to the right of all rankers from @xmath332 and to the left of all rankers from @xmath333 .",
    "we define @xmath351 and have delilah place her pebble @xmath144 on the rightmost ranker from @xmath352 on @xmath75 .",
    "this position of course is labeled with an @xmath336 . since on @xmath74",
    "all rankers from @xmath353 occur to the left of or at @xmath149 , all of them occur strictly to the left of @xmath232",
    ". since all rankers in @xmath352 are from @xmath354 or @xmath355 , we can apply ( i)(e ) and ( i)(f@xmath356 ) , and we see that all of these rankers also appear to the left of @xmath357 .",
    "therefore we have @xmath358 , which makes sure that delilah does not lose in this move , and also establishes ( i)(d ) .",
    "to complete the inductive step , we need to argue that delilah s move also establishes ( i)(e ) and ( i)(f ) , both for @xmath29 , and for @xmath340 with reversed roles of @xmath74 and @xmath75 . then , using the inductive hypothesis , delilah has a winning strategy for the remaining game , no matter what side samson chooses for his next move .",
    "we observe that all rankers from @xmath352 appear to the right of the rankers from @xmath333 .",
    "this is true by definition on @xmath74 , and holds for @xmath75 because ( i)(b ) and ( i)(c ) hold for @xmath319 . since delilah placed @xmath144 on a ranker from @xmath352 , we have ( i)(e ) , ( i)(f@xmath356 ) and ( i)(f@xmath359 ) for @xmath29 for all all rankers from @xmath333 . and",
    "since delilah placed @xmath144 on the rightmost of the rankers from @xmath352 , we know that all rankers from @xmath332 appear to the left of @xmath144 , just as they do on @xmath74",
    ". thus we have ( i)(e ) , ( i)(f@xmath356 ) and ( i)(f@xmath359 ) for the rankers from @xmath332 as well , and therefore for all rankers mentioned in those conditions .    all rankers from @xmath360 that appear at @xmath149 are in @xmath361 , since we already dealt with the case where @xmath149 does appear at a ranker from @xmath362 .",
    "since delilah chose @xmath144 as the rightmost ranker from @xmath352 , all of these rankers appear to the left of or at @xmath144 , and we have established ( i)(f@xmath363 ) for @xmath29 . for condition ( i)(f@xmath364 ) , we need to argue about @xmath365 . from ( i)(b ) and ( i)(c ) for @xmath319 , we know that all rankers from @xmath365 appear to the right of or at the same position as the rankers from @xmath352 on @xmath75 , just as they do on @xmath74 .",
    "thus ( i)(f@xmath364 ) holds as well .",
    "now that we have established ( i ) for @xmath29 , we use the inductive hypothesis to get a winning strategy for delilah for the remaining game if samson s next move is on @xmath74 . for the case where his next move is on @xmath75",
    ", we only need to establish ( i ) for @xmath340 , but with reversed roles of @xmath74 and @xmath75 . reversing the roles of the two structures only affects condition ( i)(f ) , and ( i)(f ) for @xmath340 follows immediately from ( i)(e ) for @xmath29 .",
    "thus delilah also wins the remaining game if samson s next move is on @xmath75 .",
    "using theorem [ thm : alt - ranker - char ] , we show that for any fixed alphabet @xmath43 , at most @xmath366 alternations are useful .",
    "intuitively , each boundary position in a ranker says that a certain letter does not occur in some part of a word .",
    "alternations are only useful if they visit one of these previous parts again .",
    "once we visited one part of a word @xmath367 times , this part can not contain any more letters and thus is empty .",
    "[ thm : alt - alphabet ] let @xmath43 be a finite alphabet , let @xmath132 and @xmath368 .",
    "if @xmath369 , then @xmath73 .",
    "suppose for the sake of a contradiction that @xmath369 and @xmath370 .",
    "thus , using theorem [ thm : alt - ranker - char ] , @xmath74 and @xmath75 agree on the definedness of all @xmath371-rankers , and on their order with respect to all @xmath372-rankers and some @xmath373-rankers .",
    "but since @xmath370 , @xmath74 and @xmath75 need to disagree on the properties of some other ranker .",
    "let @xmath374 with @xmath375 be the shortest such ranker . we know that @xmath23 has more than @xmath367 blocks of alternating directions , say @xmath23 is an @xmath1-alternation ranker for some @xmath376",
    "let @xmath377 be the indices of the boundary positions at the end of each block , i.e. where @xmath378 , @xmath379 points to a different direction than @xmath380 . for the last of those indices we have @xmath381 .",
    "we look at the prefix rankers of @xmath23 up to the end of each alternating block , @xmath382 , and the intervals defined by these prefix rankers .",
    "we set @xmath383 $ ] , @xmath384 if @xmath385 points to the right , and @xmath386 if @xmath385 points to the left .",
    "for all @xmath387 $ ] let , @xmath388 & \\text{if $ p_{k_i}$ points to the right}\\\\        [ r_{k_i}(u)+1 , r_{k_i-1}(u)-1 ] & \\text{if $ p_{k_i}$ points to the left }      \\end{cases}\\ ] ] notice that by definition the letter mentioned in @xmath378 does not occur in the interval @xmath389 .",
    "suppose that for all @xmath387 $ ] we have @xmath390 .",
    "then the letter mentioned in @xmath378 has to occur in the interval @xmath391 of @xmath74 , but the interval @xmath392 of @xmath74 can not contain any of the @xmath367 distinct letters .",
    "therefore @xmath393 and we have a contradiction .    otherwise there is an @xmath394 $ ] such that @xmath395 .",
    "we will construct a ranker @xmath24 that is shorter than @xmath23 , does not have more alternations than @xmath23 and occurs at exactly the same position as @xmath23 in both @xmath74 and @xmath75 .",
    "the main idea for this construction is that if @xmath396 , then it is not useful to enter this interval at all . by our assumption ,",
    "@xmath74 and @xmath75 disagree on some property of the ranker @xmath23 , and thus on some property of the shorter ranker @xmath24 .",
    "this contradicts our assumption that @xmath23 was the shortest such ranker .",
    "now we show how to construct a shorter ranker @xmath24 that occurs at the same position as @xmath23 .",
    "we assume without loss of generality that @xmath378 points to the left .",
    "in this case we have @xmath397 $ ] .",
    "we look at the relative positions of the rankers @xmath398 with respect to the ranker @xmath399 . we know",
    "that @xmath400 , and we are interested in the right - most of the rankers @xmath398 that is still outside of the interval @xmath391 .",
    "let @xmath401 be this ranker .",
    "thus we have @xmath402 we know that @xmath369 , thus by theorem [ thm : alt - ranker - char ] , these rankers occur in exactly the same order in @xmath75 .",
    "now we set @xmath403 .",
    "because @xmath74 and @xmath75 agree on the ordering of the relevant rankers , we have @xmath404 and @xmath405 .",
    "therefore we have reduced the size of a prefix of @xmath23 without increasing the number of alternations , and thus have a shorter ranker @xmath24 that occurs at the same position as @xmath23 in both structures .    in order to prove that the alternation hierarchy for @xmath7 is strict , we define example languages that can be separated by a formula of a given alternation depth @xmath1 , but that can not be separated by any formula of lower alternation depth . as theorem [ thm : alt - alphabet ] shows , we need to increase the size of the alphabet with increasing alternation depth .",
    "we inductively define the example words @xmath406 and @xmath407 and the example languages @xmath408 and @xmath409 over finite alphabets @xmath410 . here",
    "@xmath48 , @xmath1 and @xmath0 are positive integers .",
    "@xmath411 notice that @xmath406 and @xmath407 are almost identical  if we delete only one @xmath412 from @xmath413 , we get @xmath407 . finally , we set @xmath414 and @xmath415 .",
    "a formula @xmath255 _ separates _ two languages @xmath416 if for all @xmath417 we have @xmath418 and for all @xmath419 we have @xmath420 or vice versa .",
    "[ lem : alt - hierarchy - exp ] for all @xmath421 , there is a formula @xmath422<@xmath4{2}{m}$ ] that separates @xmath408 and @xmath409 .    for @xmath423 , we can easily separate @xmath424 and @xmath425 with the formula @xmath426 . for all larger @xmath1",
    ", we show that the two languages @xmath408 and @xmath409 differ on the ordering of two @xmath427-alternation rankers .",
    "then by theorem [ thm : alt - ranker - char ] there is an formula that separates @xmath408 and @xmath409 .",
    "we inductively define the rankers @xmath428    for @xmath429 , it is easy to see that @xmath430 , but @xmath431 . for @xmath432 ,",
    "these rankers disagree on their order as well . to prove this , we prove the following two equalities .",
    "@xmath433 to prove this , we first use the definitions above and write @xmath434 the letter @xmath435 does not occur in the word @xmath436 , and thus @xmath437 points to the first position in @xmath438 right after the copy of @xmath436 . we observe that @xmath439 starts with @xmath31 , and that @xmath439 is defined on @xmath436 .",
    "thus the evaluation of the remainder of @xmath440 on @xmath438 never leaves the copy of @xmath436 , and we have @xmath441 for the second part of the equality , we have @xmath442 as above , the letter @xmath443 does not occur in the word @xmath444 , and thus @xmath445 points to the position in @xmath436 right before the copy of @xmath444 .",
    "the ranker @xmath446 starts with @xmath30 , and @xmath446 is defined on @xmath444 .",
    "thus , just as above , the evaluation of the remainder of @xmath439 on @xmath436 never leaves the copy of @xmath444 , and we have @xmath447 exactly the same holds for the other rankers ( @xmath448 ) and words @xmath449 ) .",
    "we have @xmath450    now an easy inductive argument , based on the two equalities we just proved , shows that the rankers disagree on their order .",
    "therefore condition ( i)(b ) of theorem [ thm : alt - ranker - char ] fails for any pair of words , and there is a formula in that separates @xmath408 and @xmath409 .",
    "[ lem : alt - hierarchy - nexp ] for @xmath421 , @xmath451 , and all @xmath177 , we have @xmath452 .    because we do not have constants , there are no quantifier - free sentences .",
    "thus @xmath42<@xmath4{2}{n}{0}$ ] does not contain any formulas and the statement holds trivially for @xmath423 .    for @xmath453 and any @xmath454",
    ", we claim that exactly the same @xmath340-rankers are defined over @xmath406 and @xmath407 , and that all @xmath340-rankers appear in the same order with respect to all @xmath455-rankers and all @xmath456-rankers that end on a different direction .",
    "once we established this claim , the lemma follows immediately from theorem [ thm : alt - ranker - char ] .",
    "we already observed that @xmath406 and @xmath407 are almost identical .",
    "the only difference between the two words is that @xmath406 contains the letter @xmath412 in the middle whereas @xmath407 does not .",
    "thus we only have to consider rankers that are affected by this middle @xmath412 .",
    "we claim that any ranker that points to the middle @xmath412 of @xmath406 requires at least @xmath85 alternations .",
    "furthermore , we claim that any such ranker needs to start with @xmath30 for even @xmath1 and with @xmath31 for odd @xmath1 .",
    "we prove this by induction on @xmath1 .",
    "for @xmath457 we have @xmath458 .",
    "any @xmath0-ranker that starts with @xmath31 can not reach the first @xmath412 , thus we need a ranker that starts with @xmath30 .",
    "for odd @xmath432 we have @xmath459 .",
    "any @xmath0-ranker that starts with @xmath30 can not leave the first block of @xmath460 symbols of this word and thus not reach the middle @xmath412 .",
    "therefore we need to start with @xmath31 , and in fact use @xmath461 at some point , because we would not be able to leave the last section of @xmath462 otherwise . but with @xmath461 we move past all of @xmath462 , and we need one alternation to turn around again . by induction , we need at least @xmath463 alternations within @xmath462 , and thus @xmath85 alternations total .    the argument for even @xmath1 is completely symmetric .",
    "thus we showed that we need at least @xmath85 alternation blocks to point to the middle @xmath412 .",
    "furthermore , we showed that if we have exactly @xmath85 alternation blocks , then the last of these blocks uses @xmath30 .",
    "therefore we only need to consider @xmath427-alternation rankers that end on @xmath30 and pass through the middle @xmath412 .",
    "it is easy to see that all of these rankers agree on their ordering with respect to all other @xmath464-alternation rankers , and with respect to all @xmath427-alternation rankers that end on @xmath31 .",
    "to summarize , we showed that @xmath406 and @xmath407 satisfy condition ( i ) from theorem [ thm : alt - ranker - char ] for @xmath85 alternations .",
    "thus the two words agree on all formulas from .",
    "our example words are constructed such that for @xmath465 , @xmath406 and @xmath407 can be distinguished by the ordering of two @xmath427-rankers . in the case @xmath466 for example",
    ", we can use the two rankers @xmath467 and @xmath468 . a formal argument for all @xmath1",
    "is given in @xcite .",
    "there we also argue that the example words @xmath406 and @xmath407 agree on the definedness of all @xmath340-rankers , and that these rankers appear in exactly the same order with respect to shorter rankers . thus the two languages @xmath408 and @xmath409",
    "can not be separated by any @xmath469<@xmath4{2}{m-1}$ ] formula .",
    "thus we have the following theorem .",
    "[ thm : alt - hierarchy ] for any positive integer @xmath1 , there is a @xmath422<@xmath4{2}{m}$ ] and there are two languages @xmath470 such that @xmath471 separates @xmath408 and @xmath409 , but no @xmath472<@xmath4{2}{m-1}$ ] separates @xmath408 and @xmath409 .",
    "the theorem immediately follows from lemma [ lem : alt - hierarchy - exp ] and lemma [ lem : alt - hierarchy - nexp ] .",
    "theorem [ thm : alt - hierarchy ] resolves an open question from @xcite .",
    "we extend our definitions of boundary positions and rankers from sect .  [",
    "sec : fo2 ] to include the substrings of a given length that occur immediately before and after the position of the ranker .",
    "a _ @xmath473-neighborhood boundary position _ denotes the first or last occurrence of a substring in a word .",
    "more precisely , a @xmath473-neighborhood boundary position is of the form @xmath474 with @xmath109 , @xmath475 , @xmath58 and @xmath476 .",
    "the interpretation of a @xmath473-neighborhood boundary position @xmath477 on a word @xmath478 is defined as follows .",
    "@xmath479 \\mid w_{i - k } \\ldots w_{i+\\ell }        = s \\ , \\mathtt{a } \\ , t\\ }        & \\text{if } d = \\rright\\\\        \\max\\{i \\in [ k+1 , |w|-\\ell ] \\mid w_{i - k } \\ldots w_{i+\\ell }        = s \\ , \\mathtt{a } \\ ,",
    "t\\ }        & \\text{if } d = \\rleft      \\end{cases}\\ ] ] notice that @xmath480 is undefined if the sequence @xmath481 does not occur in @xmath15 .",
    "a @xmath473-neighborhood boundary position can also be specified with respect to a position @xmath116 $ ] .",
    "@xmath482        \\mid w_{i - k } \\ldots w_{i+\\ell } = s \\ , \\mathtt{a } \\ , t\\ }        & \\text{if } d = \\rright\\\\        \\max\\{i \\in [ k+1 , \\min\\{q-1 , |w|-\\ell\\ } ]         \\mid w_{i - k } \\ldots w_{i+\\ell } = s \\ , \\mathtt{a } \\ , t\\ }        & \\text{if } d = \\rleft      \\end{cases}\\ ] ]    observe that @xmath483-neighborhood boundary positions are identical to the boundary positions from definition [ def : boundary - position ] . as before in the case without successor , we build rankers out of these boundary positions .",
    "the size of the boundary position neighborhoods grows linearly from the first boundary position to the last one , reflecting the remaining quantifier depth for successor moves at those positions .",
    "an _ @xmath0-successor - ranker _",
    "@xmath23 is a sequence of @xmath0 neighborhood boundary positions , @xmath484 , where @xmath127 is a @xmath485-neighborhood boundary position and @xmath486 $ ] .",
    "the interpretation of an @xmath0-successor - ranker @xmath23 on a word @xmath15 is defined as follows .",
    "@xmath119 we denote the set of all @xmath0-successor - rankers that are defined over a word @xmath15 by @xmath487 , and set @xmath488 } \\mathit{sr}_i(w)$ ] .",
    "because we now have the additional atomic relation @xmath489 , we need to extend our definition of order type as well .",
    "[ def : suc - order - type ] let @xmath130 .",
    "the _ successor order type _ of @xmath48 and @xmath61 is defined as @xmath490    with this new definition of @xmath0-successor - rankers , our proofs for lemmas [ lem : ranker - sides ] , [ lem : ranker - def ] , [ lem : ranker - exp ] and theorem [ thm : ranker - char ] go through with only minor modifications .",
    "instead of working through all the details again , we simply point out the differences .",
    "first we notice that @xmath491-successor - rankers are simply @xmath491-rankers , so the base case of all inductions remains unchanged . in the proofs of lemmas [ lem : ranker - sides ] , [ lem : ranker - def ] and [ lem : ranker - exp ] , and in the proof of `` ( ii ) @xmath219 ( i ) '' from theorem [ thm : ranker - char ] , we argued that delilah can not reply with a position in a given section because it does not contain a certain ranker and therefore it does not contain the symbol used to define this ranker .",
    "now we need to know more  we need to show that delilah can not reply with a certain letter in a given section that is surrounded by a specified neighborhood , given that this section does not contain the corresponding successor - ranker .",
    "whenever samson s winning strategy depends on the fact that an @xmath0-successor - ranker does not occur in a given section , he has @xmath492 additional moves left .",
    "so if delilah does not reply with a position with the same letter and the same neighborhood , samson can point out a difference in the neighborhood with at most @xmath201 additional moves .    for the other direction of theorem [ thm : ranker - char ] , we need to make sure that delilah can reply with a position that is contained in the correct interval , has the same symbol and is surrounded by the same neighborhood .",
    "where we previously defined the @xmath0-ranker @xmath493 or @xmath494 , we now include the @xmath201-neighborhood of the respective positions chosen by samson .",
    "thus we make sure that samson can not point out a difference in the two words , and delilah still has a winning strategy .",
    "thus we have the following three theorems for .",
    "[ thm : suc - structure ] let @xmath74 and @xmath75 be finite words , and let @xmath177 .",
    "the following two conditions are equivalent .    1 .   1",
    ".   @xmath495 , and , 2 .   for all @xmath496 and for all @xmath497 , + @xmath498 2 .",
    "@xmath73    [ thm : suc - alt - structure ] let @xmath74 and @xmath75 be finite words , and let @xmath86 with @xmath87 .",
    "the following two conditions are equivalent .    1 .   1",
    ".   @xmath499 , and , 2 .   for all @xmath500 and for all @xmath501 , + @xmath502 , and , 3 .   for all @xmath500 and @xmath503 such that @xmath23 and @xmath24 end with different directions , @xmath502 2",
    "@xmath77    [ thm : suc - alt - hierarchy ] let @xmath1 be a positive integer .",
    "there is a @xmath422<,@xmath4{2}{m}$ ] and there are two languages @xmath504 such that @xmath471 separates @xmath408 and @xmath409 , but there is no @xmath472<,@xmath4{2}{m-1}$ ] that separates @xmath408 and @xmath409 .",
    "we use the same ideas as before in theorem [ thm : alt - hierarchy ] .",
    "we define example languages that now include an extra letter ` b ` to ensure that the successor predicate is of no use . as before , we inductively construct the words @xmath406 and @xmath407 and use them to define the languages @xmath408 and @xmath409 .",
    "@xmath505    finally we set @xmath506 and @xmath507 .",
    "notice that the ` b`s are not necessary to distinguish between the two languages @xmath408 and @xmath409 , and thus the proof of lemma [ lem : alt - hierarchy - exp ] goes through unchanged and we have a formula @xmath508<,@xmath4{2}{m}$ ] that separates @xmath408 and @xmath409 . to see that no @xmath469<,@xmath4{2}{m-1}$ ] formula can separate @xmath408 and @xmath409",
    ", we observe that any @xmath201-neighborhood in the words @xmath406 and @xmath407 contains all ` b`s except for at most one letter @xmath509 for some @xmath510 $ ] .",
    "thus the proof of lemma [ lem : alt - hierarchy - nexp ] goes through here as well .",
    "the proof of theorem [ thm : suc - alt - hierarchy ] is given in @xcite , and mostly identical to the proof of theorem [ thm : alt - hierarchy ] .",
    "we use @xmath0 copies of an extra letter between any two letters in our example words , and thus ensure that the successor predicate is not useful .",
    "the complexity of satisfiability for @xmath6 $ ] was investigated in @xcite . there",
    "it is shown that any satisfiable @xmath511 $ ] formula has a model of size at most exponential in @xmath0 .",
    "it follows that satisfiability for @xmath6 $ ] is in , and a reduction from shows that satisfiability for @xmath6 $ ] is -complete . using our characterization of @xmath6 $ ]",
    ", wilke observed that satisfiability becomes @xmath512-complete if we look at binary alphabets only @xcite .",
    "we generalize this observation and show that satisfiability for @xmath6 $ ] is @xmath512-complete for any fixed alphabet size .",
    "in contrast to this , satisfiability for @xmath5 $ ] is @xmath513-complete even for binary alphabets @xcite , since in the presence of a successor predicate we can encode an arbitrary alphabet in binary . before we state and",
    "prove the two theorems of this section , we prove a simple technical lemma first .",
    "[ lem : equiv - word - replace ] let @xmath514 . if @xmath515 , then @xmath516 .",
    "we argue that delilah has a winning strategy for the game @xmath517 : if samson places a pebble in @xmath74 or @xmath15 , delilah replies with the identical position in @xmath74 or @xmath15 in the other structure . if samson places a pebble in @xmath75 or @xmath518 , delilah replies according to her winning strategy in the game @xmath519 .",
    "all of these moves obviously preserve the ordering of the pebbles , and thus delilah wins .",
    "[ thm : small - model ] let @xmath177 and let @xmath520 $ ] be a formula over a @xmath8-letter alphabet . if @xmath255 is satisfiable , then @xmath255 has a model of size @xmath521 .",
    "the proof of theorem [ thm : small - model ] is presented in @xcite .",
    "we argue that any fixed word has as most @xmath521 positions that can be reached with @xmath0-rankers , and thus we have a word of size @xmath521 that satisfies the given formula .",
    "let @xmath15 be an arbitrary model of @xmath255 .",
    "we use induction on @xmath8 to show how to construct a new model of size @xmath521 that satisfies @xmath255 . for @xmath522 , i.e. a single letter alphabet",
    ", we observe that an @xmath0-ranker can only point to a position within the first or last @xmath0 letters of @xmath15 .",
    "we let @xmath523 be a copy of @xmath15 with all letters after the first @xmath0 letters and before the last @xmath0 letters removed .",
    "the words @xmath15 and @xmath523 agree on the existence and ordering of all @xmath0-rankers , thus we can apply theorem [ thm : ranker - char ] and it follows that @xmath524 .    for the inductive case , we partition @xmath15 into segments , where each segment is a maximal sequence of the same letter . for example , the word @xmath525 has two segments , @xmath526 and @xmath527 .",
    "first , we let @xmath523 be a copy of @xmath15 where we cut down all segments that are longer than @xmath528 to exactly @xmath528 letters .",
    "since no @xmath0-ranker can point to a position within any segment after the first @xmath0 letters and before the last @xmath0 letters of that segment , we have @xmath524 .",
    "now we partition the word @xmath523 such that @xmath529 , where @xmath530 and for every @xmath531 , @xmath253 is a string of maximal length that uses exactly @xmath8 different letters , @xmath532 is a segment , and @xmath533 is a string over at most a @xmath8-letter alphabet . we observe that this partition is unique : if @xmath336 is the last of the @xmath534 letters in our alphabet to appear in @xmath523 , starting from the left , then @xmath535 is the left - most segment of @xmath336 s , and @xmath536 is everything up to that segment .",
    "now @xmath537 is the left - most segment after @xmath535 of the letter that appears last after @xmath535 , and so on .",
    "we can point to a position in segment @xmath538 with an @xmath0-ranker , but no @xmath0-ranker that starts with @xmath30 can point to a position to the right of @xmath538 . similarly , we partition @xmath523 , now starting from the right , such that @xmath539 , where @xmath540 and for every @xmath541 , @xmath542 is a string of maximal length that uses exactly @xmath8 different letters , @xmath543 is a segment , and @xmath544 is a string over at most a @xmath8-letter alphabet .",
    "again , this partition is unique and any @xmath0-ranker that starts with @xmath31 can not point to a position to the left of @xmath545 .",
    "we also notice that both partitions have the same number of segments , i.e. @xmath546 , since any substring @xmath547 from the first partition contains all letters of the alphabet and thus has to contain at least one segment @xmath548 from the second partition , and vice versa .",
    "if both partitions use more than @xmath528 segments , then the segment @xmath538 of the first partition occurs to the left of the segment @xmath545 of the second partition . in this case",
    "we construct the word @xmath549 .",
    "@xmath550 agrees with @xmath523 on all @xmath0-rankers , and thus @xmath551 .",
    "every one of the strings @xmath552 and @xmath553 uses at most @xmath8 different letters , therefore we can apply the inductive hypothesis and replace each of these strings with an equivalent string of length @xmath521 , as explained in lemma [ lem : equiv - word - replace ] .",
    "thus we have constructed a word of length @xmath554 that satisfies @xmath255 .",
    "if the partitions have at most @xmath528 segments , then we combine the two partitions such that @xmath555 , where @xmath556 , and for every @xmath557 , @xmath558 is one of the original segments @xmath559 and @xmath560 . as above , we use the inductive hypothesis to replace all strings @xmath561 with equivalent strings of length @xmath521 , and thus construct a new string of length @xmath554 that satisfies @xmath255 .",
    "satisfiability for @xmath6 $ ] where the size of the alphabet is bounded by some fixed @xmath562 is -complete .",
    "membership in @xmath512 follows immediately from theorem [ thm : small - model ]  we nondeterministically guess a model of size @xmath521 where @xmath0 is the quantifier depth of the given formula , and verify that it is a model of the formula .",
    "now we give a reduction from @xmath563 .",
    "let @xmath564 be a boolean formula in conjunctive normal form over the variables @xmath565 .",
    "we construct a @xmath6 $ ] formula @xmath566 $ ] , where @xmath567 says that every model has size exactly @xmath0 , and where we replace every occurrence of @xmath568 in @xmath564 with a formula @xmath569 of length @xmath570 which says that the @xmath48-th letter is a @xmath491 .",
    "the total length of @xmath255 is @xmath571 , and @xmath255 is satisfiable iff @xmath564 is satisfiable .",
    "we proved precise structure theorems for , with and without the successor predicate , that completely characterize the expressive power of the respective logics , including exact bounds on the quantifier depth and on the alternation depth .",
    "using our structure theorems , we showed that the quantifier alternation hierarchy for is strict , settling an open question from @xcite .",
    "both our structure theorems and the alternation hierarchy results add further insight to and simplify previous characterizations of .",
    "we hope that the insights gained in our study of @xmath41 on words will be useful in future investigations of the trade - off between formula size and number of variables .",
    "we would like to thank thomas wilke for pointing out the consequences of our structural results to the satisfiability problem for @xmath6 $ ] .",
    "we are also very thankful to two anonymous reviewers , whose detailed comments and suggestions significantly improved the presentation of our results ."
  ],
  "abstract_text": [
    "<S> it is well - known that every first - order property on words is expressible using at most three variables . </S>",
    "<S> the subclass of properties expressible with only two variables is also quite interesting and well - studied . </S>",
    "<S> we prove precise structure theorems that characterize the exact expressive power of first - order logic with two variables on words . </S>",
    "<S> our results apply to both the case with and without a successor relation .    for both languages , </S>",
    "<S> our structure theorems show exactly what is expressible using a given quantifier depth , @xmath0 , and using @xmath1 blocks of alternating quantifiers , for any @xmath2 . using these characterizations , we prove , among other results , that there is a strict hierarchy of alternating quantifiers for both languages . </S>",
    "<S> the question whether there was such a hierarchy had been completely open . as another consequence of our structural results , </S>",
    "<S> we show that satisfiability for first - order logic with two variables without successor , which is -complete in general , becomes -complete once we only consider alphabets of a bounded size . </S>"
  ]
}