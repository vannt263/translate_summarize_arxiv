{
  "article_text": [
    "the observation of bose - einstein condensation ( bec ) in dilute alkali gases @xcite heralds a new era in the study of quantum fields .",
    "it offers a unique opportunity to carry out experiments in the laboratory for which theoretical calculations beginning from a microscopic model of the system are tractable",
    ". however , such calculations are fraught with difficulties at finite temperatures .",
    "while equilibrium perturbation theories have had much success @xcite dynamical calculations often require severe approximations to be made .    in ref .",
    "@xcite we developed an approximate formalism to describe the dynamics of a thermal bose condensate based on the gross - pitaevskii equation ( gpe ) .",
    "this description is valid when the low - lying modes of the system are classical , satisfying the criterion @xmath0 .",
    "this is analogous to the situation in laser physics , where the highly occupied laser modes can be well described by classical equations .",
    "we proceeded by dividing the field operator into a classical region represented by a wave function @xmath1 describing the condensate and its coherent excitations , with the remainder of the field described by the quantum operator @xmath2 .",
    "we derived an equation of motion for @xmath1 that we called the finite temperature gross - pitaevskii equation ( ftgpe ) .",
    "the ftgpe is a rather complicated equation , however , and in ref .",
    "@xcite we briefly described the first results from the simpler projected gross - pitaevkskii equation ( pgpe ) obtained by neglecting the operator @xmath2 .",
    "these results demonstrate that the gpe alone can represent thermal bose gases . in this paper",
    "we elaborate on these results and describe our method in more detail .",
    "we also consider the effect of strong particle interactions on the thermal distributions and investigate the appearance of vortices in our simulations .",
    "the use of the dynamical gpe at finite temperature was originally proposed by svistunov , kagan , and co - workers @xcite . despite this suggestion first appearing in 1991 ,",
    "there have been relatively few numerical studies based on this approach .",
    "_  have performed calculations of the approach to equilibrium of a near ideal superfluid @xcite , while marshall _ et al .",
    "_ @xcite carried out a qualitative study of evaporative cooling using a 2d gpe .",
    "references @xcite also use classical methods to represent thermal bose - condensed systems .",
    "similar approximations to other quantum field equations have been successful elsewhere @xcite .",
    "this paper is organised as follows . in sec .",
    "[ outline ] we give a brief derivation of the finite temperature gross - pitaevskii equation . in sec .",
    "[ pgpe ] we describe and justify the simplification of the ftgpe to the projected gross - pitaevskii equation , before describing the simulations we have carried out in sec .",
    "[ simulations ] .",
    "section  [ sec : equil_evidence ] presents the qualitative evidence that the simulations have reached equilibrium , while sec .",
    "[ quantitative ] carries out a quantitative analysis of our numerical data .",
    "section  [ frac_vortex ] discusses the behaviour of the condensate fraction , specific heat , and vorticity of the system with temperature , before we conclude in section  [ conclusions ] .",
    "a full derivation of the ftgpe and a discussion of the physics described by each of the terms can be found in ref .",
    "@xcite . here",
    "we outline the derivation beginning with the equation of motion for the bose field operator @xmath3 where @xmath4 is the effective interaction strength at low momenta , @xmath5 is the _ s_-wave scattering length , and",
    "@xmath6 is the particle mass .",
    "@xmath7 is the single - particle hamiltonian defined by @xmath8 where @xmath9 is the external trapping potential , if any is present .",
    "the route to the usual gpe is to assume that the full field operator can be replaced by a wave function @xmath1i.e .",
    "that _ all _ quantum fluctuations can be neglected .",
    "we proceed instead by defining a projection operator @xmath10 such that @xmath11 where the region @xmath12 is _ determined _ by the requirement that @xmath13 , and the set @xmath14 defines some basis in which the field operator is approximately diagonal at the boundary of @xmath12 . for these modes , the quantum fluctuation part of the projected field operator",
    "can be ignored , and so we replace @xmath15 and write @xmath16    defining the operator @xmath17 and @xmath18 , operating on eq .",
    "( [ eqn : field_operator ] ) with @xmath10 and taking the mean value results in what we call the finite temperature gpe @xmath19 this equation describes the full dynamics of the coherent region and its coupling to an effective heat bath described by @xmath2 . in general , the non - equilibrium evolution depends on the coupling between these two regions and the exchange of energy and particles that this allows .",
    "the ftgpe must be complemented by an equation of motion for @xmath2 and in principle this can be obtained using a form of quantum kinetic theory .",
    "the only approximation that has been made in the derivation of the ftgpe is that the modes represented by @xmath20 must satisfy the criterion of classicality , that is @xmath0 .",
    "the ftgpe is a non - perturbative equation , and therefore we expect that it will be valid in the region of the phase transition as long as only the highly occupied modes are treated . there is perhaps a misperception in the bec community that the gpe is only valid at @xmath21 .",
    "however , it is well known that close to the phase transition a classical description of the longer length scales involved is completely appropriate .",
    "this is exactly what the gpe describes , and in fact it has been used as a model of phase transitions in other areas of condensed matter physics .",
    "indeed our model has the same energy functional for these modes as used in the classical renormalization group theory of the superfluid phase transition .",
    "it therefore seems reasonable to expect that the same approximations are valid in this case .",
    "the physical processes described by the various terms of eq .",
    "( [ eqn : ftgpe ] ) are discussed in detail in ref .",
    "@xcite . in this paper",
    "we concentrate on a simplification of the ftgpe which is effectively a model of a restricted system .",
    "this allows us to demonstrate some of the properties of the gpe without having to solve the more complicated equation .",
    "in this paper , we wish to show that the gpe _ alone _ can describe evolution of general configurations of the coherent region @xmath12 towards an equilibrium that can be parameterised by a temperature .",
    "we therefore ignore all terms involving @xmath2 in eq .",
    "( [ eqn : ftgpe ] ) and concentrate on the first line @xmath22 which we call the projected gross - pitaevskii equation ( pgpe ) .",
    "although eq .",
    "( [ eqn : pgpe ] ) is completely reversible , it is well known that deterministic nonlinear systems with only a few degrees of freedom exhibit chaotic , and hence ergodic behaviour @xcite .",
    "if many modes are occupied , the pgpe contains many degrees of freedom and it is therefore reasonable to expect it to evolve to equilibrium ( except for specially chosen initial conditions such as eigenstate solutions ) .",
    "the projected gpe describes a microcanonical system .",
    "however , if the region @xmath12 is large , then its fluctuations in energy and particle number in the grand canonical ensemble would be small .",
    "hence we expect the final equilibrium state of the projected gpe to be similar to that of the finite temperature gpe coupled to a bath @xmath2 with the appropriate chemical potential and temperature .",
    "the detailed non - equilibrium dynamics of the system _ will _ depend on the exchange of energy and particles between @xmath12 and the bath  however , we leave the coupling of @xmath1 and @xmath2 to be addressed in future work .      the spatial representation of the projection operation is written @xmath23 and this operation must be carried out numerically every time we calculate the nonlinear term in the pgpe .",
    "this is a very time consuming operation in general , taking many times longer than calculating @xmath24 itself .",
    "the operation is much simpler numerically if we use a plane - wave basis in our projector @xmath25 where @xmath26 is the volume of our system . in this case",
    "( [ eqn : projector ] ) becomes simply the application of a forward fourier transformation to our function @xmath27 , followed by an inverse fourier transformation that includes only the modes in the coherent region .",
    "thus our numerical procedure is @xmath28 \\bigg\\},\\end{aligned}\\ ] ] where fft and ifft refer to the forward and inverse fast fourier transform operations respectively , and @xmath29 is the representation of the projector @xmath10 in fourier space .",
    "there are very efficient routines available to carry out ffts , and so we find that it is extremely advantageous numerically to define our projector in the plane - wave basis .      for any non - periodic trapping potential , the use of a plane - wave basis is at odds with our requirement that the basis must approximately diagonalise @xmath1 at the boundary of the region @xmath12 .",
    "in fact , it may not even satisfy this requirement for a periodic potential if the boundary of the coherent region occurs at a low enough energy .",
    "if we consider a homogeneous system , however , the plane - wave basis will always satisfy our requirements . in this case",
    "the effect of a condensate on the excitations of the system is simply to mix modes of momenta @xmath30 and @xmath31 .",
    "thus even if @xmath1 is not diagonalised at the boundary of @xmath12 , we can still apply the projector cleanly in fourier space . for these reasons ,",
    "the simulations that we present in this paper are for the homogeneous bose gas .",
    "we intend to address the issue of projectors for the trapped bose gas in future work .",
    "a direct advantage of simulating the homogeneous system is that the condensate occupation is readily identified as the @xmath32 component of the wave function .",
    "this is in contrast to the trapped case , where the condensate mode changes with the condensate fraction . in general the condensate fraction must be determined by diagonalisation , which can be a very time consuming procedure @xcite .",
    "we have performed simulations for a fully three - dimensional homogeneous bose gas with periodic boundary conditions .",
    "the dimensionless equation we compute is @xmath33 where the normalisation of the wave function has been defined to be @xmath34 the nonlinear constant is @xmath35 where @xmath36 is the total number of particles in the system , and @xmath37 is the period .",
    "our dimensionless parameters are @xmath38 , wave vector @xmath39 , energy @xmath40 , and time @xmath41 , with @xmath42 .",
    "the two parameters that determine all properties of the system are the projector @xmath10 and the nonlinear constant @xmath43 .",
    "we have chosen a projection operator such that all modes included in the simulations have @xmath44 , which enables us to use a computationally efficient numerical grid of @xmath45 points .",
    "this means that 13997 modes are included in the system .",
    "[ [ grid - size - and - aliasing ] ] grid size and aliasing + + + + + + + + + + + + + + + + + + + + + +    the nonlinear term of the gpe can generate momentum components up to three times larger than those which exist in the original wave function .",
    "thus it would seem that calculating the term @xmath46 on a grid only slightly larger than the projector would cause problems with aliasing",
    ". the correct procedure would be instead to calculate this term on a grid size of @xmath47 points before performing the projection operation .    to check the effect of grid size we have performed simulations where the nonlinear term was calculated on grids of size 32 , 64 , and 96 points , and found that there is no difference in the equilibrium properties of the system .",
    "the detailed dependence of the condensate population during evolution is different in detail for each size grid , but follows the same average curve .",
    "the same behaviour is observed when adjusting the accuracy parameter of our adaptive step size algorithm for evolving the gpe .",
    "we attribute this behaviour to the deterministic chaos exhibited by the system .",
    "any small numerical error is eventually magnified such that the system follows a quite different microscopic path through phase space , although the resulting macroscopic ( average ) properties are unaffected .",
    "we note that the choice of the nonlinear constant determines only the ratio of @xmath49 .",
    "this means that for a given value of @xmath48 , we can choose the parameters @xmath36 , @xmath50 and @xmath37 such that our condition @xmath51 is always satisfied for a given physical situation .",
    "we have performed three series of simulations with nonlinearities of @xmath52 , @xmath53 , and @xmath54 .",
    "the highest value of @xmath48 was chosen such that all the states contained in the calculation are phonon - like for a large condensate fraction .",
    "the boundary between phonon - like and particle - like states for the homogeneous gas is @xmath55 where we have defined @xmath56 to be the condensate number within the volume @xmath57 , and thus @xmath58 is the condensate density . converting eq .",
    "( [ eqn : k0 ] ) to dimensionless units we find that @xmath59 and therefore for a condensate fraction of @xmath60 we have @xmath61 we find that computations with smaller values of @xmath48 take comparatively longer to reach equilibrium .",
    "this is because the equilibration rate is approximately proportional to @xmath62 , whereas the minimum time - step required for a given accuracy in the numerical integration of the pgpe only increases slowly with decreasing @xmath43 .    to give an indication of how these dimensionless parameters compare to experimental setups , for @xmath63 we can choose @xmath64rb atoms with @xmath65 and @xmath66 @xmath67 m to give a number density of about @xmath68 @xmath69similar to current experiments on bec in traps .",
    "we begin our simulations with strongly non - equilibrium wave functions with a chosen total energy @xmath70 .",
    "we construct these by populating the amplitudes of the wave function components @xmath71 in the expansion @xmath72 the populations @xmath73 are chosen such that the distribution is as flat as possible , while the phases of the amplitudes are chosen at random @xcite .",
    "the total energy @xmath70 is a constraint on the distribution of amplitudes .",
    "the energy of a pure condensate is @xmath74 , all of this being due to interactions  the kinetic energy is zero . to have a wave function with an energy not much larger than @xmath75",
    ", the occupations of the @xmath76 state and the @xmath77 states can not be equal .",
    "( we use the notation @xmath78 . )",
    "therefore , for the lowest energy simulations the initial condensate population is necessarily larger than the excited state populations .    to ensure that the initial wave functions are sufficiently randomised , we enforce the condition that all 123 states with @xmath79 must have some initial population , while all other components may be unoccupied . for low energies ,",
    "when this distribution including the condensate can not be totally flat , we keep the populations of the components with @xmath80 equal , and adjust the condensate population such that the wave function has the energy we require .",
    "an example of this situation is shown in fig .",
    "[ fig : wave1](a ) for the @xmath81 initial wave function in the @xmath63 simulation series .",
    "for simulations with a sufficiently high total energy @xmath70 that the inner 123 components may have equal population , we continue to add further shells of higher @xmath82 to our wave function .",
    "the amplitudes of the inner components are readjusted to maintain the required normalisation .",
    "this causes the energy of the system to increase monotonically with each new shell until we find two wave functions that bound the energy we are looking for , differing only in their outermost shell .",
    "we then adjust the population of the outermost shell downwards until we reach the required energy .",
    "this procedure is necessary due to the nonlinearity of the problem . in the case of the ideal gas ( @xmath83 )",
    ", we can calculate the kinetic energy ( and hence the total energy ) of the wave function simply by knowing the distribution of @xmath73 , via @xmath84 however , for @xmath85 we must also add the interaction energy of the wave function to the total energy .",
    "this is @xmath86 and depends nontrivially on the @xmath87 .",
    "further images of initial and final state wave functions are shown in fig .",
    "[ fig : wave1 ] in _",
    "k_-space , and fig .",
    "[ fig : wave2 ] in real space .",
    "plane in momentum space for the @xmath63 , @xmath88 simulations .",
    "( a ) base 10 logarithm of the _ k_-space wave function at @xmath89 ( b ) base 10 logarithm of the _ k_-space wave function at @xmath90 once the system has reached equilibrium . ]",
    "plane in real space for the @xmath63 , @xmath88 simulation .",
    "( a ) base 10 logarithm of the real - space wave function at @xmath89 ( b ) base 10 logarithm of the real - space wave function at @xmath90 once the system has reached equilibrium . ]      the pgpe is evolved in the interaction picture , using a fourth - order runge - kutta method with adaptive step size determined by estimating the fifth - order truncation error .",
    "the acceptable relative truncation error was set to be @xmath91 for all components with an occupation of @xmath92 .",
    "this resulted in typical time steps as presented in table  [ tab : time_steps ] , which could be integrated in a reasonable time on a modern workstation .",
    "we evolve the initial wave functions for at least twice as long as it takes for the system to reach equilibrium , based on the observation of the behaviour of the condensate fraction ( see sec .",
    "[ sec : equil_evidence ] ) . the time period for each value of @xmath43",
    "is also given in table  [ tab : time_steps ] .",
    "thus the longest of these simulations required @xmath93 time steps .",
    "cccc @xmath94 &    .the typical minimum and maximum time steps for the simulations .",
    "the minimum is for high energy simulations , and the maximum for low energy . [",
    "cols=\"^ \" , ]      + 500 & 4 & 6 & 2.0 + 2000 & 1.6 & 4.4 & 0.4 + 10000 & 0.45 & 1.2 & 0.2 +",
    "although the pgpe is completely reversible , the final state wave functions displayed in figs .  [",
    "fig : wave1 ] and  [ fig : wave2 ] indicate that the simulations have evolved the system to an apparent equilibrium state .",
    "k_-space distributions have evolved from initially being flat to a form that is peaked at the centre , and tails away towards the edges .",
    "also , there is a smoothing out of both the phase and density profiles of the real - space wave function . after a certain time of evolution @xmath95",
    ", the plots for the wave functions appear to be isomorphic for @xmath96 .",
    "we would like to note that the equilibrium properties depend only on the total energy and momentum of the initial wave function ",
    "they are independent of the shape of the initial distribution in @xmath82-space .",
    "we have performed simulations with non - spherical initial wave functions , and found that they evolve to a spherical equilibrium state . also , as the gpe conserves momentum , for the condensate to form in the @xmath97 mode the initial distribution must have zero total momentum .",
    "we have performed simulations where the initial distribution had a finite momentum , and observed the condensate to form in a non - zero momentum state as expected .    to determine the properties of the system at equilibrium , in theory we should carry out many different simulations each with the same initial populations but with different choices of the initial phases , and then take the ensemble average . however",
    ", this is an extremely large computational task .",
    "instead , we assume the ergodic theorem applies , such that the time average over the evolution of a single system at equilibrium is equivalent to the ensemble average over many different systems .",
    "we therefore perform a time - average over the last 50 wave functions saved , all with @xmath96 .",
    "strong evidence that the simulations have reached equilibrium is provided by the time dependence of the condensate population . for all simulations",
    "this settles down to an average value ( dependent on the energy @xmath70 ) that fluctuates by a small amount .",
    "the initial time evolution of the condensate fraction for five different energies with @xmath63 is shown in fig .",
    "[ fig : n0_evolution ] .     for four different simulation energies with @xmath63 . from top to bottom : @xmath98 .",
    "the simulations were run until @xmath90 .",
    "other values of the nonlinearity give qualitatively similar results.,width=325 ]    the average condensate occupation in equilibrium for all simulations for the @xmath99 case are presented in fig .",
    "[ fig : n0ve](a )",
    ". the fluctuations of the condensate population are indicated by the ( barely visible ) vertical lines at each point , and these are largest for the @xmath100 simulation . for comparison , the corresponding curve for the ideal gas",
    "is plotted in fig .",
    "[ fig : n0ve](b ) .",
    "we can see that for @xmath101 the curve is linear up to the transition point , but the @xmath99 curve displays a distinct bulge in this region .",
    "the shape of the corresponding curves for @xmath102 and @xmath53 fall in between the @xmath101 and @xmath54 cases .    .",
    "the barely discernible vertical lines on each point indicate the magnitude of the fluctuations .",
    "( b ) the curve for the same system , but calculated for the ideal gas.,width=325 ]      further evidence of equilibrium is provided by the distribution of the particles in momentum space .",
    "rather than using the plane - wave basis , we transform the wave functions into the quasiparticle basis of quadratic bogoliubov theory .",
    "for the homogeneous gas , this theory can be solved analytically and we can write the quasiparticle amplitude @xmath103 as @xmath104 where @xmath105 and @xmath106 is given by @xmath107 in this last equation , the dimensionless wave vector @xmath108 is given by @xmath109 with @xmath110 as defined in eq .",
    "( [ eqn : k0 ] ) .",
    "the normalisation condition @xmath111 is automatically satisfied by eq .  ( [ homo_uk_vk ] ) . from eq .",
    "( [ eqn : k0_dim ] ) we can see that the sole parameters of the transformation are the condensate fraction @xmath112 , and the nonlinear constant @xmath43 .",
    "we time average the populations of the quasiparticles states @xmath113 as was described in sec .  [ sec : equil_evidence ] to give @xmath114 , and finally average over angle so that we can produce a one dimensional plot of @xmath115 .",
    "this distribution for four different simulation energies and @xmath63 is shown in fig .",
    "[ fig : qp_distribution ] .    , crosses @xmath116 , circles @xmath100 , dots @xmath117 .",
    "the mean condensate occupation for the first three distributions is off axis.,width=325 ]    we can see that the shape of the curves is surprisingly smooth for each energy , suggesting that the system is in equilibrium .",
    "the plot of the distribution for any individual wave function is scattered about the average .",
    "we have also determined the fluctuations of the population of the quasiparticle modes .",
    "the grand canonical ensemble for the bose gas predicts the relationship @xmath118 for @xmath119 , which in the classical limit @xmath120 gives @xmath121 this is indeed the behaviour that we observe .",
    "although we are evolving a microcanonical system , in this case there are such a large number of modes that the remainder of the system acts as a bath for any individual mode and the result still applies .",
    "while the data presented in sec .",
    "[ sec : equil_evidence ] indicates that the pgpe is evolving the system to equilibrium , as yet we have presented no quantitative evidence . to demonstrate conclusively that equilibrium has been reached , we need to be able to assign a _ temperature _ to the simulations . in this section",
    "we measure a temperature for a given simulation by comparing the distribution function of the numerical simulations against a predicted energy spectrum .",
    "the gpe is the high occupation ( classical ) limit of the full equation for the bose field operator , eq .",
    "( [ eqn : field_operator ] ) .",
    "therefore , in equilibrium we expect the mean occupation of mode @xmath122 to be the classical limit of the bose - einstein distribution  i.e .  the equipartition relation    @xmath123    where @xmath82 labels the _ eigenstates _ of the system . in general",
    "these will be some type of quasiparticle mode .",
    "manipulating eq .",
    "( [ eqn : occupation ] ) , we find that @xmath124 the equilibrium condensate occupation according to the equipartition relation will be given by eq .",
    "( [ eqn : occupation ] ) with @xmath125 and @xmath126 ( the condensate eigenvalue ) . from this expression",
    "we can solve for the chemical potential @xmath127 substituting this result into eq .",
    "( [ eqn : disperse_fit ] ) , and converting to dimensionless units we find @xmath128 where @xmath129 is the dimensionless temperature .",
    "once equilibrium has been reached for a single simulation , we make use of eq .",
    "( [ eqn : fit ] ) to measure the quantity @xmath130 . decomposing the wave functions in some basis and time - averaging",
    "the populations determines @xmath131 as a function of the variable @xmath82 , as is plotted in fig .",
    "[ fig : qp_distribution ] .",
    "this completely specifies the rhs of eq .",
    "( [ eqn : fit ] ) and it remains to determine the quantities on the lhs .    in this section we consider three different methods of either predicting or measuring the function @xmath132 .",
    "if the basis we have used for our decomposition is a good one , and our prediction for @xmath132 is correct , then this curve will have the same shape as the rhs of eq .",
    "( [ eqn : fit ] ) .",
    "the constant of proportionally determined by a fitting procedure will then give the temperature @xmath130 .",
    "before we describe our methods and results , we would like to note that the quantity we refer to throughout the remainder of this paper as the temperature is the variable @xmath130 as determined by the numerical fitting procedures described above . we have not yet established that this is the true temperature as defined by thermal equilibrium with a heat reservoir .",
    "however , we believe that if we were to solve the ftgpe with @xmath133 acting as a heat bath , then the temperature determined in the coherent region via this method would agree with the bath temperature .      in the limit of large condensate fraction @xmath134 , we expect the bogoliubov transformation to provide a good basis . for the homogeneous case",
    "the dispersion relation is analytic , and is given by @xmath135^{1/2 } , \\label{eqn : bog_disperse}\\ ] ] where @xmath136 is the speed of sound and @xmath137 is the absolute energy of a mode with wave vector @xmath82 . in our dimensionless units",
    "this becomes @xmath138 the condensate fraction is determined from the numerical results , and so when the bogoliubov dispersion relation is valid we can determine a temperature for the simulations by substituting eq .",
    "( [ eqn : bog ] ) in eq .",
    "( [ eqn : fit ] ) .    , which is shown as the dots .",
    "( a ) @xmath139 , @xmath140 and @xmath141 , with a best fit temperature from bogoliubov theory of @xmath142 .",
    "( b ) @xmath63 , @xmath143 and @xmath144 , with a best fit temperature from bogoliubov theory of @xmath145 .",
    ", width=325 ]      we have carried out this analysis for all the simulation data . for the @xmath146 case , the measured distributions are in excellent agreement with the bogoliubov dispersion relation for all energies , and we have been able to extract the corresponding temperature for each simulation .",
    "however , this is not the case for the more strongly interacting systems . for @xmath147 ,",
    "the bogoliubov relation is a good fit only for simulations with @xmath148 ( @xmath149 ) , or for energies above the bec transition point . for the @xmath150 case , good agreement",
    "is found only for the lowest energy simulation with @xmath143 and @xmath151 .",
    "sample fits of the simulation data to the bogoliubov dispersion relation are shown in fig .",
    "[ fig : bog_dispersion ] for cases where the agreement is good .",
    "( an example of this procedure for where the bogoliubov spectrum is not appropriate is given in fig .",
    "[ fig : full_theory ] ) .",
    "the reason for the limited range of agreement is because the bogoliubov transformation diagonalises only a quadratic approximation to the full hamiltonian .",
    "it neglects terms that are cubic and quartic in non - condensate operators , assuming that they are small ( these are discussed in detail below ) .",
    "this is a good approximation for the @xmath139 simulations  at large condensate fraction the dispersion relation is only slightly shifted from the non - interacting relation @xmath152 , and at smaller condensate fractions the difference is negligible .",
    "hence we can fit a temperature up to and above the bec transition .    for the @xmath147 case the higher order terms become important above @xmath153 , and for the strongest interaction strength of @xmath63 , they are important for all but the lowest energy simulation we consider . for the higher energy simulations the shape of eq .",
    "( [ eqn : fit ] ) no longer agrees with eq .",
    "( [ eqn : bog ] ) , and we must use a more sophisticated theory to predict the dispersion relation .    above the transition point , however , there is no condensate and the ideal gas dispersion relation is a reasonable description of the system .      as the occupation of the quasiparticle modes becomes significant at large interaction strengths ,",
    "the cubic and quartic terms of the many - body hamiltonian that are neglected in the bogoliubov transformation become important . in ref .",
    "@xcite morgan develops a consistent extension of the bogoliubov theory to second order that leads to a gapless excitation spectrum .",
    "this theory treats the cubic and quartic terms of the hamiltonian using perturbation theory in the bogoliubov quasiparticle basis .",
    "this results in energy - shifts of the excitations away from the bogoliubov predictions of eq .",
    "( [ eqn : bog_disperse ] ) .",
    "expressions for the energy - shifts of the excitations are given in sec .",
    "6.2 of ref .",
    "they have the form @xmath154 where @xmath155 [ @xmath156 is the shift in energy of a quasiparticle in mode @xmath82 due to the cubic [ quartic ] hamiltonian , and @xmath157 describes the shift due to the change in the condensate eigenvalue . in the high - occupation limit",
    "we find @xmath158 where @xmath159 is the dimensionless anomalous average , defined by @xmath160    the expression for @xmath155 is derived from second - order perturbation theory , and is rather complicated .",
    "we have @xmath161 , \\label{de3}\\ ] ] where    @xmath162    in which @xmath163 , and @xmath164 is another form of the dimensionless energy of mode @xmath82 , with @xmath165 as earlier .",
    "the numerical calculation of the energy shifts is not a trivial task , and have used two methods to determine the shifts for our simulations .",
    "the first procedure is to calculate the shifts directly using the population data from the simulations .",
    "we therefore    1 .",
    "calculate the quasiparticle populations @xmath166 for the last 50 wave functions of our simulation based on a condensate population @xmath167 , and then average these over time .",
    "calculate the energy shifts for mode @xmath168 using these populations as the input .",
    "3 .   average the shifts over angle to give a one - dimensional function of @xmath82 .",
    "this results in plots of the energy shifts that are somewhat scattered due to the finite size of the system .",
    "the expressions for the shifts eqs .",
    "( [ dea][dec ] ) contain poles when energy matches occur , and hence the numerical calculation is performed using an imaginary part in the denominator .",
    "the size of this imaginary part does not affect the shape of the curve in the limit that it is small , but it does affect the amount of scatter in the shifts .",
    "we have performed sample calculations allowing @xmath37 to increase while keeping other parameters of the system constant , and this makes the curve smoother .    , @xmath169 simulation , and appear to be approximately gapless as @xmath170 .",
    "the upper curves are for the @xmath63 , @xmath171 simulation , and exhibit a gap as @xmath170.,width=325 ]    the second procedure only makes use of the condensate fraction and the _ total _ number of quasiparticles , rather than the population of the individual levels . by assuming the bogoliubov spectrum is a good estimate of the energies ( which must be true for the perturbation theory to be valid )",
    ", we can estimate the temperature @xmath172 using the normalisation constraint on the populations @xmath173 where we have used the approximation @xmath174 that is valid when there is a condensate present .",
    "the lhs as well as the value of @xmath175 are determined by the simulations , and the bogoliubov relation eq .",
    "( [ eqn : bog ] ) is used for the energies .",
    "once the estimated temperature @xmath176 is determined , we use the equipartition bogoliubov relation for the populations in eqs .",
    "( [ dea][dec ] ) , and then approximate the sums by numerical integration to calculate the shifts to the levels .",
    "we find that this gives curves that agree on average with those calculated using the first method , but are much smoother . a comparison of the two methods",
    "is given in fig .",
    "[ fig : shift ] .      for the @xmath177 simulations , the quasiparticle populations extracted from the simulations are in much better agreement with the energy spectrums from the second order theory than with those from ordinary bogoliubov theory .",
    "we find that most of the measured distributions for the @xmath177 case are well described by the second order theory .",
    "sample results are presented in fig .",
    "[ fig : full_theory](a ) .    however , this is not the case for the @xmath99 simulations .",
    "in fact we find that the energy spectrum is shifted in the opposite direction to that inferred from the simulations , and that there is a energy gap for @xmath170 .",
    "the reasons for this are discussed below .",
    "the validity of the second order theory is constrained by the requirement @xcite @xmath178 where @xmath179 is the condensate density .",
    "this corresponds in our dimensionless units to @xmath180 for the results of fig .",
    "[ fig : full_theory ] with @xmath177 , @xmath169 this parameter is 0.14 and so we are beginning to probe the boundary of validity of the theory . at higher @xmath70 the shifts become of the order of the unperturbed energies , and",
    "hence the results are unreliable . in this region",
    "even higher order terms are important , and the second order theory can no longer be expected to give good results . from our calculations",
    "it seems that this parameter should be @xmath181 for the theory to be valid .",
    "we would like to emphasize , however , that the gpe suffers no such limitations .",
    "it is non - perturbative and thus we expect that it will be valid all the way through the transition region as long as the high occupation number condition is satisfied .    , the solid curve is for dispersion relation predicted by second order theory , and the dashed curve is the dispersion relation predicted by bogoliubov theory .",
    "( a ) @xmath177 , @xmath169 , and @xmath182 .",
    "second order theory gives a good fit to the numerical results with a best fit temperature of @xmath183 .",
    "( b ) @xmath63 , @xmath171 , and @xmath184 .",
    "the shape of the second order theory dispersion relation does not agree with the population data from the simulation , and the gap is apparent as @xmath185 .",
    "the grey curve plots the energies as determined by the method described in sec .",
    "[ nonpert ] with a best fit temperature of @xmath186.,width=325 ]      in the course of this work it has become apparent that while the second order theory is gapless for infinite systems , this is not the case for systems such as ours with a finite momentum cutoff .",
    "the individual terms in the perturbation expansion given by eqs .",
    "( [ de1 ] ) and ( [ de3 ] ) contain contributions that are proportional to @xmath187 ( infrared divergent ) and a constant ( gap ) in the low @xmath82 limit . for a homogeneous system",
    "these terms cancel exactly when the upper limit of the integrals is infinite , and this leaves a gapless spectrum @xcite .",
    "however , in a system with a momentum cutoff these terms do not exactly cancel , with the result that there is a gap in the predicted excitation spectrum as @xmath188 .",
    "briefly , this gap arises because the energy shifts @xmath189 of eq .",
    "( [ de1 ] ) only involve the quantity @xmath159 .",
    "this is obtained from eq .",
    "( [ eqn : kappa ] ) via a sum over all states below the cutoff where the summand depends only on a single wavevector .",
    "in contrast the shift @xmath155 of eq .",
    "( [ de3 ] ) involves a sum over states where the summand depends on two wavevectors @xmath190 and @xmath191 ( related by momentum conservation ) _ both _ of which must be below the cutoff .",
    "this difference in the restrictions on the summations leads to a lack of complete cancellation in the corresponding shifts at low energy and the appearance of a gap in the excitation spectrum .    for the homogeneous gas",
    ", we can calculate the size of the gap predicted by the second order theory analytically . replacing the summations by integrations , we find that the leading order contribution to the energy shift in the limit @xmath188 is @xmath192 where @xmath193 as before and @xmath194 where @xmath195 is the momentum cutoff . in the limit @xmath196",
    "we have @xmath197 and so @xmath198 tends to a constant ( the gap ) .",
    "the size of the gap tends to zero as the momentum cutoff @xmath199 tends to infinity but otherwise it is finite .",
    "we stress that eq .",
    "( [ dek_gap ] ) is only the low @xmath82 limit of the exact result . for our simulations",
    "there is a minimum wavevector in the problem so it is possible for the terms of order @xmath108 to be larger than the gap contribution given above .",
    "this is the case for the simulations with @xmath200 where @xmath199 is reasonably large and the gap is therefore small .",
    "the result of eq .",
    "( [ dek_gap ] ) contains the small parameter that controls the validity of the second order theory in the usual case where there is no momentum cutoff [ c.f .",
    "( [ eqn : validity ] ) ] .",
    "however , the result also depends explicitly on the cutoff @xmath195 so in this case there is a second parameter in the theory . for perturbation theory to be valid",
    "we require that the predicted energy shifts are small compared to the unperturbed energies , i.e. that @xmath201 .",
    "we therefore obtain a second criterion for the validity of the second order theory which is @xmath202 this result should hold for all momenta in the simulations , and in particular for the smallest value of @xmath108 . for the @xmath177 , @xmath169 simulations",
    "the left hand side is @xmath203 for @xmath204 . in this case",
    "the gap is negligible and the dominant contribution to the energy shifts comes from the terms of order @xmath108 in eq .",
    "( [ dek_gap ] ) .",
    "the small parameter of the theory is therefore given by eq .",
    "( [ eqn : validity ] ) . however , for the @xmath63 , @xmath143 simulations the left hand side is of order 0.12 . in this case",
    "the gap is not negligible and we can not use second order theory to define a temperature .",
    "this result is somewhat surprising since , even for a condensate fraction of 80% the small parameter of eq .",
    "( [ eqn : validity ] ) is of order 0.07 , and it does seem reasonable to expect that perturbation theory should be applicable . this does not appear to be the case , however , and we have so far been unable to determine the root cause of this problem .",
    "it is worth noting that the numerical simulations themselves have no difficulties in this regime and do not predict a gap at low momentum .",
    "this is because the gpe is non - perturbative and indeed this is one of the main reasons for using it to study the properties of bose condensed systems at finite temperature .",
    "the disagreement between the second order theory and the numerical simulations is illustrated in fig .",
    "[ fig : full_theory](b ) , where it can be seen that even despite the gap , the shifts the theory predicts are in the wrong direction in comparision with the simulations .",
    "the failure of second order theory for the @xmath63 simulations caused us to investigate other possible methods of determining the temperature once the system was in equilibrium .",
    "this has lead to what seems to be a method of determining the temperature that does not rely on perturbation theory , and we describe it here .",
    "we found earlier that the bogoliubov spectrum gave a good prediction of the populations of the quasiparticle levels for the lowest energy simulation in the @xmath63 series with @xmath143 .",
    "therefore it seems reasonable that the bogoliubov _ basis _ should remain a good one for perturbation theory for the next simulation with @xmath205 , even though the second order theory can not be used to calculate the energy shifts .",
    "therefore we attempted another method to determine the absolute energy of each quasiparticle level .",
    "if we are using a good basis , then on a short time scale the quasiparticles should be independent , with amplitudes evolving according to @xmath206 thus by measuring the gradient of the phase of each quasiparticle we can determine its energy .    to determine the energy spectrum for a single simulation , our numerical procedure was as follows .    1 .",
    "take the last 50 wave functions saved for a simulation once it has reached equilibrium , and evolve each of these individually for a very short period .",
    "one hundred wave functions are saved for each of the 50 simulations .",
    "2 .   transform the wave functions into the quasiparticle basis , and measure the energy of each quasiparticle , determined by a linear fit to the phase of each amplitude for all 50 simulations .",
    "3 .   average over all 50 energy spectrums to give a single three dimensional spectrum .",
    "4 .   finally ,",
    "average over angle to give a one dimensional energy spectrum .",
    "this gives us a dispersion relation @xmath207 which can then be compared to a plot of @xmath208 .",
    "if the shapes of the curves agree , then a temperature can be determined via eq .",
    "( [ eqn : fit ] ) as in the earlier sections .",
    "we first tested this procedure on the @xmath177 simulation series , and found that this method was in good agreement with the second order theory calculations , the two approaches assigning the same temperature to the various simulations .",
    "we then moved onto the @xmath63 simulations .",
    "we found the surprising result that not only did the shape of the plots of the curves for @xmath209 and @xmath210 agree for the lower energy simulations where the parameter of eq .",
    "( [ eqn : validity ] ) was small , it also agreed when it was of the order of , and greater than one .",
    "this was unexpected , as it would seem likely that near the phase transition when interactions are strong that the bogoliubov quasiparticle basis would no longer be sufficiently good for this method to be accurate .",
    "an example of the energy spectrum and its fit to the population data is shown in fig .",
    "[ fig : full_theory](b ) .    as a further test we carried out the same procedure described above , but using the plane wave basis rather than the bogoliubov quasiparticle basis .",
    "intuitively it would seem that this would no longer work  but we found that not only did it give the same temperatures as the quasiparticle basis for the @xmath63 simulations , it also agreed with the temperatures determined using second order theory for the @xmath177 simulations .",
    "using the three methods described in the previous section , we have been able to measure an equilibrium temperature for _ all _ simulations in this paper .",
    "we are confident of the results determined from both bogoliubov and second order theory ; however unfortunately we do not have any results to compare with for the strongly interacting regime where the non - perturbative method was used .",
    "we can only conclude that the temperatures extracted using this method agree numerically with the other two methods in the weakly interacting regime , and that the values obtained seem reasonable and basis independent elsewhere .",
    "we intend to test this method further in the future using a numerical `` ideal gas thermometer '' .    in this section",
    "we move on to consider how other system properties such as condensate fraction , specific heat , and vorticity vary with the temperature @xmath130 .",
    "it is usual when considering how the condensate fraction varies with the other properties of the system to plot it against temperature , rather than against energy as we have done in fig .",
    "[ fig : n0ve ] .",
    "we are now in a position to present this data , and it is displayed in fig .",
    "[ fig : n0_v_t ] .",
    "we can see that a major effect of increasing the nonlinearity is to increase the condensate fraction at any given temperature .",
    "this can be understood in the bogoliubov regime by considering the shape of the dispersion relation .     for four different interaction strengths .",
    "the open circles are for @xmath211 , crosses for @xmath212 , solid dots for @xmath52 , and the solid line is for the ideal gas .",
    "the shift in the transition temperature is positive with increasing interaction strength @xmath48 . , width=325 ]    the bogoliubov dispersion relation eq .",
    "( [ eqn : bog ] ) shows that for a given condensate fraction , a larger value of @xmath43 will result in an increase in the energy of any mode @xmath82 relative to the condensate .",
    "this leads directly to the observation that for a fixed condensate fraction , an increase in the nonlinearity must lead to an increase in the temperature .",
    "however , as @xmath213 in the transition region , the energy - momentum relationship tends towards the ideal gas dispersion relation , and therefore the transition temperature will not be greatly shifted over a wide range of nonlinearities .",
    "there has been some discussion recently in the literature about the shift in the transition temperature for the homogeneous interacting bose gas , with some authors even disagreeing in the direction of the shift ( e.g. see ref .",
    "@xcite and references within ) . for the pgpe system described in this paper by eq .",
    "( [ eqn : pgpe ] ) , we can see from fig .",
    "[ fig : n0_v_t ] that the shift is positive , although as yet we have made no effort to quantify this .",
    "this would require many more simulations to be run , especially in the transition region , and for the temperatures to be determined more accurately .",
    "it seems plausible that future simulations of the full ftgpe ( [ eqn : ftgpe ] ) or approximations to it could be used to quantitatively measure the shift in the critical temperature for the homogeneous bose gas when the lowest energy modes are sufficiently classical .",
    "however , the terms coupling the ftgpe to the effective bath @xmath133 may be difficult to implement computationally , and at the present time we are unsure how to proceed in this direction .      in fig .  [",
    "fig : specific](a ) we plot the energy of the simulations due to excited states @xmath214 versus temperature , where @xmath215 is the energy of the system at @xmath216 .",
    "we can see that at low temperatures for all interaction strengths this is a straight line , with a slope of about 13996the number of excited modes in the system .",
    "this is as expected  the average energy contained in a given mode @xmath82 is @xmath217 when there is a condensate present and @xmath218 . at higher temperatures ,",
    "however , the energy rises above the equipartition prediction for non - zero interaction strength @xmath43 , and this is an indication that there are no longer independent modes in the system .    , crosses for @xmath212 , solid dots for @xmath219 , and the solid line is for the ideal gas .",
    "( a ) plot of the energy versus temperature for all four interaction strengths considered . ( b )",
    "plot of the specific heat for all four interaction strengths . ]",
    "the derivative of this curve with respect to temperature gives the specific heat , and this quantity is plotted in fig .",
    "[ fig : specific](b ) .",
    "the messy nature of this plot is due to small uncertainties in the measured temperature which are amplified when the temperature difference between successive simulations is calculated .",
    "however , the plot does display an interesting feature . for non - zero interaction strength",
    ", the specific heat appears to reach a peak at the transition temperature , and the height of this peak increases with the value of @xmath43somewhat reminiscent of the lambda transition in superfluid helium . once again",
    ", further simulations and more accurate determination of the temperature are required for quantitative investigation of this effect .",
    "this will be the subject of future work .",
    "a further quantity of interest is the vorticity of the system in equilibrium .",
    "it has been argued that vortices may be important in the superfluid transition of @xmath220he , reducing the superfluid density near the transition point @xcite . with this in mind , we have studied the presence of vortex lines in our simulations .",
    "recently berloff and svistunov",
    "@xcite have considered the evolution of topological defects in the evolution of a bose gas from a strongly non - equilibrium state .",
    "a vortex is a topological excitation , characterised in a wave function by @xmath221",
    "\\cdot d{\\bf l } = 2 \\pi n,\\ ] ] where @xmath12 is a closed contour , and @xmath222 is a non - zero integer , the sign of which indicates the circulation of the vortex .",
    "the continuous variation of the phase from zero to @xmath223 around such a contour implies that there must be a discontinuity in the phase within the loop .",
    "the only way that this can be physical is for the wave function to have zero amplitude at the spatial position of the phase singularity .    in a two - dimensional wave function",
    "the centre of vortices are zero - dimensional points , and they can be easily counted to give a measure of the vorticity of the system . however , in three dimensions vortices form lines and rings , and the equivalent quantity of the 2d measure of vorticity would be to calculate the length of all vortex structures in the wave function .",
    "this would be a somewhat complicated procedure numerically , and so we have devised a different technique .",
    "we increase the spatial resolution of our wave functions to be @xmath224 points , so that the grid spacing is smaller than the vortex healing length @xmath225 , defined by @xmath226 we do this by extending the wave function in _ k_-space , and then fourier transforming to real space .",
    "this does not require any extra information , as for @xmath227 we have @xmath228 .",
    "we then count the number of vortex lines passing through every @xmath229 plane , and take the average over all planes .",
    "it seems that this is a reasonable measure of the vorticity of the wave function , and it should be similar to the measurement of the length of the vortex structures discussed above .",
    "we have analysed the data from the simulations using this procedure .",
    "we find that when the energy of the simulation is sufficiently high that there are vortices present , the time evolution of the vorticity is a good indicator for when the system reaches equilibrium .",
    "as is the case for the condensate population , the vorticity tends to an equilibrium value which fluctuates by a small amount ( much smaller than the fluctuations in the condensate population ) .",
    "simulation series .",
    "the number of vortex lines per plane are indicated by open circles with the scale on the left vertical axis , and the condensate fraction by dots with the scale on the right vertical axis .",
    "( b ) the number of vortex lines per plane plotted against temperature for all three simulation series .",
    "open circles are @xmath63 , crosses are @xmath177 , and dots are @xmath139 . ]    .",
    "( a ) @xmath81 , ( b ) @xmath230 , ( c ) @xmath100 .",
    "each point corresponds to where a vortex line was detected in the horizontal plane .",
    "several vortex rings are visible in the figures.,width=325 ]    a plot of the vorticity against system energy is shown in fig .  [",
    "fig : vortices](a ) for the @xmath63 simulation ( the curves are qualitatively similar for the other nonlinearities ) .",
    "we see that there is a minimum energy required for vortices to be present in the system at equilibrium .",
    "also , as we reach this energy the plot of condensate occupation versus energy appears to dip . this same behaviour is observed for the @xmath139 and @xmath53 cases , but it occurs at a higher condensate fraction , and is not as pronounced .",
    "there is no corresponding departure from linearity in the ideal gas case , as was seen in fig .",
    "[ fig : n0ve](b ) .",
    "a plot of the number of vortex lines versus temperature for all the simulations is shown in fig .",
    "[ fig : vortices](b ) , and this displays a large increase in the vorticity near the transition temperature for @xmath231 .",
    "even the @xmath232 case appears to show a small jump in this region .",
    "a more in - depth analysis of this behaviour will be carried out in a subsequent extension of this work .",
    "finally , a three - dimensional visualisation of the network of vortex lines is shown in fig .",
    "[ fig : vortex_tangle ] for three simulation energies for the @xmath63 simulations .",
    "each point corresponds to where a vortex line was detected in the horizontal planes , and for the lowest two energies several vortex rings are clearly visible .",
    "we have presented what we believe is compelling evidence that the projected gross - pitaevskii equation is a good approximation to the dynamics of the classical modes of a bose gas .",
    "we have described how to carry out the projection technique in the homogeneous case with periodic boundary conditions , and have shown that starting with a randomised wave function with a given energy , the projected gpe evolves towards an equilibrium state .",
    "we have analysed the numerical data in terms of quadratic bogoliubov theory , and also the gapless , finite temperature theory of ref .",
    "@xcite in the classical limit .",
    "we have found that both the occupation and energies of the quasiparticles agree quantitatively with the predictions when these theories are valid .    outside the range of perturbation",
    "theory we have proposed another technique that has allowed us to determine a temperature for the pgpe simulations in equilibrium .",
    "this method agrees with the perturbative methods when they are valid . using this definition ,",
    "we have found that increasing the nonlinearity @xmath43 leads to both an increase in the transition temperature , and in the specific heat of the system at the critical point .",
    "we have also presented evidence that suggests vortices may play some role in the transition .",
    "the projected gpe is a simple equation but it appears to describe very rich physics , only some of which we have considered here ."
  ],
  "abstract_text": [
    "<S> we demonstrate that the time - dependent projected gross - pitaevskii equation ( gpe ) derived earlier [ davis _ et al . </S>",
    "<S> _ , j. phys . </S>",
    "<S> b * 34 * , 4487 ( 2001 ) ] can represent the highly occupied modes of a homogeneous , partially - condensed bose gas . </S>",
    "<S> contrary to the often held belief that the gpe is valid only at zero temperature , we find that this equation will evolve randomised initial wave functions to a state describing thermal equilibrium .    in the case of small interaction strengths or low temperatures , our numerical results can be compared to the predictions of bogoliubov theory and its perturbative extensions . </S>",
    "<S> this demonstrates the validity of the gpe in these limits and allows us to assign a temperature to the simulations unambiguously .    however , the gpe method is non - perturbative , and we believe it can be used to describe the thermal properties of a bose gas even when bogoliubov theory fails . </S>",
    "<S> we suggest a different technique to measure the temperature of our simulations in these circumstances . using this approach </S>",
    "<S> we determine the dependence of the condensate fraction and specific heat on temperature for several interaction strengths , and observe the appearance of vortex networks . </S>",
    "<S> interesting behaviour near the critical point is observed and discussed . </S>"
  ]
}