{
  "article_text": [
    "the magnetic compass points to the north since the earth is surrounded by a dipolar magnetic field . in the 19th century , gauss showed that the origin of this geomagnetic field resides in the earth s interior .",
    "it is now broadly accepted that the geomagnetic field is generated by a self - excited electric current in the earth s core , which is a double - layered spherical region of radius @xmath1 km .",
    "the inner part of the core , called the inner core ( radius @xmath2 km ) , is iron in solid state , and the outer part , called the outer core ( radius @xmath3 : @xmath4 ) , is also iron but in liquid state due to the high temperature of the planetary interior .",
    "the electrical current is generated by magnetohydrodynamic ( mhd ) dynamo action ",
    "the energy conversion process from flow energy into magnetic energy  of the liquid iron in the outer core .",
    "this geodynamo phenomenon is the target of our simulation reported in this paper .    in the last few decades ,",
    "computer simulation has emerged as a central research method for geodynamo study  @xcite . from the beginning of this new and exciting simulation area",
    ", we have been making important contributions by combining large scale simulation and advanced visualization technology : demonstration of the strong magnetic field generation by mhd dynamo  @xcite , physical mechanism of the dipole field generation  @xcite , and spontaneous and repeated reversals of the dipole moment ( north - south polarity )  @xcite .",
    "recently , we have proposed a new grid system for spherical geometry based on the overset ( or chimera ) grid methodology .",
    "we have applied this new spherical grid to geodynamo simulation . in this paper",
    ", we report the development of this new geodynamo simulation code and its performance on the earth simulator  @xcite , of japan agency for marine - earth science and technology ( jamstec ) , japan .",
    "since the earth s outer core is a spherical shell region between the inner core and the mantle , we need a numerically efficient spatial discretization method for a spherical shell geometry in order to achieve high performance on massively parallel computers .    in our previous geodynamo simulations , we used a finite difference method based on the latitude - longitude grid in spherical polar coordinates with the radius @xmath3 ( @xmath5 ) , colatitude @xmath6 ( @xmath7 ) , and the longitude @xmath8 ( @xmath9 ) . due to the existence of the coordinate singularity and grid convergence near the poles of the latitude - longitude grid",
    ", we had to take special care at the poles and this inevitably degraded the numerical efficiency and the performance of our previous dynamo code .",
    "since the finite difference method is suitable for massively parallel computers , especially massively parallel vector supercomputers like the earth simulator , we have decided to further exploit the possibilities of the finite difference method in spherical geometries , and to explore a new spherical grid system as the base of the spherical finite difference method .",
    "there is no grid mesh that is orthogonal all over a spherical surface and , at the same time , free of coordinate singularity or grid convergence problems .",
    "so , we decompose the spherical surface into subregions .",
    "the decomposition , or dissection , enables us to cover each subregion by a grid system that is individually orthogonal and singularity - free .",
    "the dissection of the computational domain generates internal borders between the subregions . in the overset grid approach  @xcite ,",
    "the subdomains are permitted to partially overlap one another on their borders .",
    "the overset grid is also called an overlaid grid , or composite overlapping grid , or chimera grid  @xcite .",
    "it is now one of the most important grid techniques in computational aerodynamics .",
    "recently , we have proposed a new overset grid for spherical geometry  @xcite .",
    "the grid is named `` yin - yang grid '' after the symbol for yin and yang in the chinese philosophy of complementarity .",
    "the yin - yang grid is composed of two identical and complemental component grids . compared with other possible spherical overset grids ,",
    "the yin - yang grid is simple in its geometry as well as metric tensors .",
    "a remarkable feature of this overset grid is that the two identical component grids are combined in a complemental way with a special symmetry .",
    "the yin - yang grid has already been applied to a mantle convection simulation in a spherical shell geometry with detailed benchmark tests  @xcite .",
    "the yin - yang grid has also been applied to simulations of the global circulation of the atmosphere , ocean , and their coupled system @xcite .",
    "there are several varieties of yin - yang grid  @xcite .",
    "the most basic type , adopted in the geodynamo simulation reported in this paper , is shown in fig .",
    "[ fig : basicyinyang ] .",
    "it has two components  yin and yang  that are geometrically identical ( exactly the same shape and size ) ; see fig .",
    "[ fig : basicyinyang](a ) .",
    "we call the two component grids the `` yin grid '' ( or _ n_-grid ) and the `` yang grid '' ( or _ e_-grid ) .",
    "they are combined to cover a spherical shell with partial overlap on their borders as shown in fig .",
    "[ fig : basicyinyang](b ) .",
    "each component grid is , in fact , a part of the latitude - longitude grid on a spherical surface .",
    "( it is piled up in the radial direction ) .",
    "a component grid , say the yin grid , is defined as a part of low - latitude region of the usual latitude - longitude grid : @xmath10 around the equator in latitude ( between @xmath11n and @xmath11s ) , and @xmath12 in longitude .",
    "another component grid , the yang grid , is defined in the same way but in different spherical coordinates .",
    "the virtual north - south axis of the yang grid is located on the equator of the yin grid s coordinates .",
    "the relation between yin coordinates and yang coordinates is written in cartesian coordinates by @xmath13 where @xmath14 is the yin grid s cartesian coordinates and @xmath15 is yang grid s .",
    "note that the forward and inverse transformations between yin and yang are given in the same form , which is a reflection of the complementary relation between the yin and yang grids .",
    "it should be stressed that the yin grid and yang grid are identical in shape , geometry , grid , and metric tensors .",
    "this means that all subroutines designed for , say the yin grid , can be used for the yang grid with no modification .",
    "in addition to this geometrical symmetry , the yin grid and yang grid are in complementary coordinates relative to each other as indicated by eq .",
    "( [ eq : a05 ] ) .",
    "this means that any interaction or communication from a grid point on yin to a grid point on yang is exactly the same as that from yang to yin .",
    "this fact makes the yin - yang - based computer code very concise and efficient .",
    "another advantage of the yin - yang grid resides in the fact that the component grid ( yin or yang ) is nothing but a ( part of ) latitude - longitude grid .",
    "this means that we can directly deal with the equations to be solved with the vector form in the usual spherical polar coordinates ; components of a flow vector @xmath16 , for example , can be written as @xmath17 in the program .",
    "the analytical forms of metric tensors such as for laplacian in spherical coordinates are well known . since we can directly code the basic equations as they are formulated in spherical coordinates",
    ", we can make use of various resources of mathematical formulas , program libraries , and tools that have been developed in spherical polar coordinates .    following the general overset methodology  @xcite ,",
    "interpolations are applied on the boundary of each component grid to set the boundary values , or internal boundary conditions .",
    "when one sees the component grid of the basic yin - yang grid shown in fig .",
    "[ fig : basicyinyang ] in the mercator projection , it is a rectangle ; the four corners intrude most into the other component grid .",
    "even if the grid mesh is taken to be infinitesimally small , the overlapping area has still non - zero ratio of about @xmath18 of the whole spherical surface .",
    "we obtain two solutions ",
    "one from the yin side and other from the yang side  in the overlapped area .",
    "this might be a slight ( @xmath18 ) waste of computational time , but the `` double solution '' causes no problem in actual calculations .",
    "the difference between the two solutions is within the discretization error that is omnipresent on the sphere in any case .",
    "the difference between the solutions is so small that we do not need to `` blend '' the double solutions there in the post processing for the data visualization ; we just choose one of the two solutions and the resulting visualization shows smooth pictures .",
    "there is no indication of the internal border between the yin and yang grids ( e.g. , fig .",
    "[ fig : columns ] below ) .",
    "if one still desires to minimize the overlapped area , it is possible by modifying the component grid s shape from the rectangle .",
    "it is obvious that a yin - yang grid with a minimum overlap region can be constructed by a division , or dissection , using a closed curve on a sphere that cuts the sphere into two identical parts .",
    "there are infinite number of such dissections of a sphere .",
    "two examples of them``baseball type dissection '' and `` cube type dissection '' can be found in @xcite .",
    "since the physical model for the geodynamo simulation is the same as our previous one and described in our papers  ( e.g. , * ? ? ?",
    "* ) , here we describe it only briefly .",
    "we consider a spherical shell vessel bounded by two concentric spheres .",
    "the inner sphere of radius @xmath19 denotes the inner core and the outer sphere of @xmath20 denotes the core - mantle boundary .",
    "an electrically conducting fluid is confined in this shell region .",
    "both the inner and outer spherical boundaries rotate with a constant angular velocity @xmath21 .",
    "we use a rotating frame of reference with the same angular velocity .",
    "there is a central gravity force in the direction of the center of the spheres .",
    "the temperatures of both the inner and outer spheres are fixed ; hot ( inner ) and cold ( outer ) . when the temperature difference is sufficiently large , a convection motion starts when a random temperature perturbation is imposed at the beginning of the calculation . at the same time",
    "an infinitesimally small , random `` seed '' of the magnetic field is given .",
    "the system is described by the following normalized mhd equations : @xmath22 @xmath23 @xmath24 @xmath25 with @xmath26 here the mass density @xmath27 , pressure @xmath28 , mass flux density @xmath29 , magnetic field s vector potential @xmath30 are the basic variables in the simulation .",
    "other quantities ; magnetic field @xmath31 , electric current density @xmath32 , and electric field @xmath33 are treated as subsidiary fields .",
    "the ratio of the specific heat @xmath34 , viscosity @xmath35 , thermal conductivity @xmath36 and electrical resistivity @xmath37 are assumed to be constant .",
    "the vector @xmath38 is the gravity acceleration and @xmath39 is the radial unit vector ; @xmath40 is a constant .",
    "we normalize the quantities as follows : the radius of the outer sphere @xmath41 ; the temperature of the outer sphere @xmath42 = 1 ; and the mass density at the outer sphere @xmath43 .",
    "the spatial derivatives in the above equations are discretized by second - order central finite differences in spherical coordinates : ( @xmath3 , @xmath6 , @xmath8 ) .",
    "the fourth - order runge - kutta method is used for the temporal integration .",
    "there are six free parameters  including three dissipation constants ; viscosity @xmath35 , thermal conductivity @xmath36 , and electrical resistivity @xmath37in this mhd system .",
    "we basically set the same parameter values adopted in our previous simulation that showed repeated dipole reversals  @xcite except for the three dissipation constants ; we set each of them 10 times smaller than in the previous simulation .",
    "this means that the fluid s reynolds number and magnetic reynolds number are both 10 times larger , the rayleigh number  an index of the vigor of thermal convection  is 100 times larger , @xmath44 , and the ekman number is @xmath45 .",
    "thus we can achieve more turbulent , and therefore more realistic simulations compared with our previous simulations .",
    "we have developed a new geodynamo simulation code ( hereafter `` yycore '' code ) for the earth simulator by converting our previous geodynamo code , which was based on the traditional latitude - longitude grid , into the yin - yang grid .",
    "we use the fortran90 language and the mpi library .",
    "we make use of the module unit of fortran90 to keep concise and neat program structure .",
    "all subroutines and functions are module subprograms .",
    "( there are no external subprograms . ) in order to realize data hiding and encapsulation in the module level , we set the default attribute of module data and subprograms be ` private ` .",
    "the yycore code has about 6,200 lines of source ( including comments ) .",
    "there are 12 modules and 1 main program .",
    "the total number of module - subprograms are 153 . among them , 48 subprograms are public ( global scope ) .",
    "we have found that the code conversion from our previous latitude - longitude - based code into the new yin - yang - based code is straightforward and rather easy .",
    "this is because most of the yin - yang grid code shares source lines with the latitude - longitude grid code : our previous geodynamo code was basically a finite - difference mhd solver on spherical coordinates with a full span of colatitude @xmath46 and longitude @xmath47 ; on the other hand , the yin - yang grid code ( yycore ) is also a finite - difference mhd solver on the spherical coordinates , but with just the smaller span of colatitude ( @xmath48 ) and longitude ( @xmath49 ) .",
    "the major difference is the new boundary condition ( interpolation ) for the communication between yin grid and yang grid .",
    "our experience with the rapid and easy conversion from latitude - longitude code into yin - yang code should be encouraging for others who have already developed codes that are based on latitude - longitude grids in the spherical coordinates , and who are bothered by numerical problems and inefficiency caused by the pole singularity .",
    "we would like to suggest that they try the yin - yang grid .",
    "since the yin grid and yang grid are identical , dividing the whole computational domain into a yin grid part and a yang grid part is not only natural but also efficient for parallel processing .",
    "in addition to this yin - and - yang division , further domain decomposition within each grid is applied to achieve high performance on the earth simulator , a massively parallel computer .    the earth simulator , whose hardware specifications are summarized in table  i has three different levels of parallelization : vector processing in each arithmetic processor ( ap ) ; shared - memory parallelization by 8 aps in each processor node ( pn ) ; and distributed - memory parallelization by pns .    in our yycore code , we apply vectorization in the radial dimension of the three - dimensional ( 3d ) arrays for physical variables .",
    "the radial grid size is 255 or 511 , which is just below the size ( or doubled size ) of the vector register of the earth simulator ( 256 ) to avoid bank conflicts in the memory  @xcite .",
    "we use mpi both for the inter - node ( distributed memory ) parallel processing and for the intra - node ( shared memory ) parallel processing .",
    "this approach is called `` flat - mpi '' parallelization .",
    "as we mentioned above , we first divide the whole computational domain into two identical parts  here we call them `` panels''that correspond to the yin grid s domain and the yang grid s domain in fig .",
    "[ fig : basicyinyang](a ) . in the yycore code , ` mpi_comm_split ` is invoked to split the whole processes into two groups .",
    "( the total number of processes is even . )",
    "the world communicator is stored in a variable named ` grunner%world%communicator ` , where ` grunner ` is a nested derived type .",
    "for further parallelization within a panel , there are several choices for the method of domain decomposition . here",
    "we choose two - dimensional decomposition in the horizontal space , colatitude @xmath6 and longitude @xmath8 , in each panel .",
    "for this purpose , we call ` mpi_cart_create ` to make a two - dimensional process array with optimized rank order .    for the intra - panel communication , ` mpi_send ` and ` mpi_irecv ` are called between nearest neighbor processes .",
    "each process has four neighbors ( north , east , south , and west ) .",
    "the rank numbers for the neighbors , obtained by invoking ` mpi_cart_shift ` with the panel s communicator ` grunner%panel%communicator ` , are also stored in ` grunner ` .",
    "communication between two groups ( yin and yang ) is required for the overset interpolation .",
    "this communication is implemented by ` mpi_send ` and ` mpi_irecv ` under ` grunner%world%communicator ` .",
    ".specifications of the earth simulator . [ cols=\">,>\",options=\"header \" , ]     [ tab:03 ]",
    "for geodynamo study , it is necessary to follow the time development of the mhd system until the thermal convection flow and the dynamo - generated magnetic field are both sufficiently developed and saturated .",
    "( initially , both the convection energy and the magnetic energy are negligibly small . ) for the case of grid size of @xmath50 with @xmath51 processes , it took six hours of wall clock time until both the dynamo - generated magnetic field and convection flow energy reached to a saturated , and balanced , level .",
    "in normalized time units , this is about @xmath52 of the magnetic free decay time .",
    "this suggests that we need to integrate more time until we observe the dynamical features of the geodynamo such as the repeated dipole reversals @xcite .    .",
    "in these visualizations , grid points are reduced by a factor of @xmath53 .",
    "( a ) convection flow in the equatorial plane viewed from the north ; ( b ) same data as ( a ) but viewed from @xmath54 ; ( c ) columnar convection cells viewed in the equatorial plane .",
    "two colors indicate cyclonic and anti - cyclonic convection columns ; ( d ) same data as ( c ) , closer view .",
    ", scaledwidth=85.0% ]    as we described in section  iii , the fundamental variables in our simulation are the magnetic vector potential @xmath55 , the mass flux density @xmath56 , pressure @xmath28 , and the mass density @xmath27 .",
    "it is convenient for data visualization / analysis purpose to store the cartesian components of the magnetic field @xmath57 , velocity @xmath58 , vorticity @xmath59 , and temperature @xmath60 . during one simulation run of 6 hours of wall clock time",
    ", we saved the 3-dimensional data 127 times , and about @xmath61 gb of data was generated in total .",
    "it is known that thermal convection motion in a rapidly rotating spherical shell is organized as a set of columnar convection cells .",
    "the number of convection columns increases and the flow and the generated magnetic field becomes turbulent as shown in fig .",
    "[ fig : columns ] , which was obtained in the simulation of @xmath51 processors with @xmath62 grid points .",
    "in this paper , we reported the development of a new geodynamo simulation code and presented its performance on the earth simulator .",
    "the base grid is the yin - yang grid , which is a spherical overset grid composed of two identical component grids .",
    "the achieved performance is 15.2 tflops by 4096 processors with @xmath63 grid points in a spherical shell .",
    "we would like to thank prof .",
    "tetsuya sato , director of the earth simulator center , for his support and encouragement .",
    "we also thank all members of the earth simulator center , especially hiromitsu fuchigami , shigemune kitawaki , hitoshi murai , satoru okura , and hitoshi uehara for their technical support and discussion .",
    "we also thank dr .",
    "daniel s.  katz for polishing the language in the manuscript .",
    "satoru shingu , hiroshi takahara , hiromitsu fuchigami , masayuki yamada , yoshinori tsuda , wataru ohfuchi , yuji sasaki , kazuo kobayashi , takashi hagiwara , shin ichi habata , mitsuo yokokawa , hiroyuki itoh , and kiyoshi otsuka . a 26.58 tflops global atmospheric simulation with the spectral transform method on the earth simulator . , 2002",
    "masaki yoshida and akira kageyama .",
    "application of the yin - yang grid to a thermal convection of a boussinesq fluid with infinite prandtl number in a three - dimensional spherical shell .",
    ", 31:doi:10.1029/2004gl019970 , 2004 ."
  ],
  "abstract_text": [
    "<S> for realistic geodynamo simulations , one must solve the magnetohydrodynamic equations to follow time development of thermal convection motion of electrically conducting fluid in a rotating spherical shell . </S>",
    "<S> we have developed a new geodynamo simulation code by combining the finite difference method with the recently proposed spherical overset grid called yin - yang grid . </S>",
    "<S> we achieved performance of 15.2 tflops ( @xmath0 of theoretical peak performance ) on 4096 processors of the earth simulator . </S>"
  ]
}