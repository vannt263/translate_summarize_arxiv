{
  "article_text": [
    "the density matrix renormalization group ( dmrg ) is a powerful numerical technique for the simulation of one - dimensional ( 1d ) strongly correlated quantum systems @xcite . its concise formulation in terms of matrix product states ( mps ) @xcite provides a framework for the efficient computation of ground states and the real - time evolution of pure states .",
    "three quite different approaches were developed that extend it to the simulation of finite - temperature properties .",
    "the historically first was the quantum transfer - matrix renormalization group @xcite which has some technical complications such as the non - hermiticity of the quantum transfer matrix .",
    "the second one relies on a purification of the mixed state @xcite that can be encoded in matrix product form @xcite .",
    "these matrix product purifications ( mpp ) were successfully applied to calculate for example finite - temperature correlation and response functions of quantum spin chains @xcite .",
    "as , e.g. , described in ref .",
    "@xcite , the employed mpps are in one - to - one relation with matrix product density operators ( mpdo ) @xcite .",
    "however , mpp computations remain challenging , because the simulation on an enlarged hilbert space can lead to a considerable growth of entanglement , making them costly at low temperatures .",
    "more recently , an alternative approach was developed that avoids the purification and hence the enlarged hilbert space .",
    "instead , one samples over a cleverly chosen set of pure quantum states , called minimally entangled typical thermal states ( metts ) @xcite .",
    "the efficiency of the metts algorithm is limited by the statistical error induced by the sampling @xcite .    in this work , we describe and demonstrate how symmetries can be utilized to improve the efficiency of the metts algorithm .",
    "recently , it was shown in ref .",
    "@xcite how grand - canonical metts simulations of response functions can be made substantially more efficient by switching to symmetric states just before the real - time evolution . however , note that this does not affect the actual metts sampling algorithm because the imaginary - time evolution is not changed . here",
    ", we discuss symmetric metts algorithms for both canonical and grand - canonical ensembles .    if the system and its environment exchange energy and there is a conserved quantity @xmath1 , the equilibrium state of the system is given by the ( here , unnormalized ) _ canonical ensemble _",
    "@xmath2 with @xmath3 being the projection of the hamiltonian onto the quantum number @xmath4 subspace @xmath5 of the full hilbert space @xmath6 . similarly , if system and environment also exchange the quantity associated with @xmath1 , the equilibrium state is the _ grand - canonical ensemble _",
    "@xmath7 here , the lagrange multiplier @xmath8 fixes the expectation value of @xmath1 . in more complex cases with multiple conserved quantities",
    "@xmath9 , one can also consider ensembles like @xmath10 $ ] .",
    "the transitions in the markov chain of metts samples are determined by projective measurements with respect to a collapse basis that can be freely chosen .",
    "this choice strongly affects the statistical properties of the resulting samples @xcite . in this work ,",
    "we introduce novel collapse bases for symmetric metts simulations .",
    "to be able to conserve global quantum numbers @xmath4 and to increase efficiency , we go beyond bases of single - site product states and carry out the projective measurements on blocks of several sites .",
    "we discuss the influence of the collapse basis choice on the convergence of the algorithm and introduce fourier and haar - random block bases which are , as we call it , _ efficiently mixing_.    the structure of this work is as follows . in sec .",
    "[ sec : symmetries ] we review how symmetries can be utilized in the matrix product state representation to achieve a significant speedup in the simulations .",
    "we briefly summarize the original metts algorithm without the use of symmetries in sec .",
    "[ sec : metts ] . in sec .",
    "[ sec : ce ] , we discuss how to use symmetries in the simulation of canonical ensembles .",
    "we go on to introduce maximally and efficiently mixing ( symmetric ) collapse bases in sec .",
    "[ sec : bases ] and summarize the factors influencing convergence speeds in sec .",
    "[ sec : factors ] .",
    "[ sec : ce - xxz ] applies the techniques to spin-@xmath0 xxz chains .",
    "a symmetric metts algorithm for the simulation of grand - canonical ensembles is introduced and demonstrated in sec .",
    "[ sec : gce ] .",
    "we summarize and conclude in sec .",
    "[ sec : conclusions ] .",
    "let us consider a lattice system with @xmath11 sites and orthonormal on - site basis states @xmath12 .",
    "matrix product states ( mps ) for the system have the form @xmath13 with @xmath14 and @xmath15 matrices @xmath16 . the @xmath17 are also called bond dimensions and we require @xmath18 such that the matrix product yields a scalar coefficient .",
    "we are concerned with states @xmath19 that are eigenstates of a conserved quantity @xmath1 . for simplicity , we restrict our considerations to a single abelian symmetry such as conservation of total particle number or magnetization .",
    "however , everything generalizes in a very similar manner to the cases of multiple conserved quantities and non - abelian symmetries @xcite . for the latter , one exploits that dependencies inside each multiplet are given by clebsch - gordan coefficients as exemplified by the wigner - eckart theorem .    for an abelian symmetry , the conserved quantity has the form @xmath20 with @xmath21 .",
    "we can construct an mps with quantum number @xmath4 by imposing selection rules on the tensor elements @xmath22_{a_i , b_i}$ ] .",
    "specifically , one assigns quantum numbers @xmath23 and @xmath24 to the matrix indices , imposes the selection rule @xmath25_{a_i , b_i } \\neq 0 \\quad\\text{only if}\\quad q(a_i)+q(\\sigma_i)=q(b_i),\\ ] ]        sets @xmath26 , and sets @xmath27 .",
    "this ensures that @xmath28 .    explicitly enforcing these conditions by decomposing the tensors into symmetry blocks leads to a significant speedup and improved accuracy of the mps algorithms .",
    "the numerically most costly operations are typically singular value decompositions ( svd ) of the tensors in the mps .",
    "these then reduce to cheaper svds of the symmetry blocks .",
    "the strategy employed in the minimally entangled typical thermal states ( metts ) algorithm @xcite is to decompose the thermal density matrix @xmath29 , with @xmath30 or @xmath31 , into a sum of projectors @xmath32 with metts @xmath33 here , @xmath34 are an appropriate orthonormal basis for the full system with @xmath35 .",
    "as discussed later , we choose block product states . as described in refs .",
    "@xcite , one can efficiently generate a markov chain @xmath36 of metts in mps form according to their ( unnormalized ) probabilities @xmath37 by repeated imaginary - time evolution steps @xmath38 and projective measurements @xmath39 .",
    "the evolution step can be executed with time - dependent dmrg ( tdrmg ) @xcite .",
    "the transition probabilities @xmath40 obey detailed balance @xmath41 thermal expectation values @xmath42 can then be computed by averaging @xmath43 over the markov chain .",
    "if the states @xmath44 are ( block ) product states , the projective measurements can be executed in a sweep through the lattice by doing local projective measurements .    in the following ,",
    "we discuss how symmetries can be utilized in metts simulations for canonical and grand - canonical ensembles , i.e. , how the conservation of @xmath45 eigenvalues can be used to substantially reduce computation costs .",
    "please note that ref .",
    "@xcite shows how to generate symmetric metts for the grand - canonical ensemble for the evaluation of time - dependent quantities ( study of quenches or response functions ) . to this purpose ,",
    "non - symmetric metts , which are not @xmath1 eigenstates , have been generated .",
    "symmetric metts are generated from these in subsequent symmetric collapses .",
    "while this does not provide any computational advantage for the imaginary - time evolution and the evaluation of static quantities , it can make subsequent real - time evolutions of the metts , in which the symmetries are exploited , much more efficient @xcite .",
    "what is described in the following , offers an efficient way to already utilize symmetries during the imaginary - time evolution .",
    "conceptually , it is straightforward to simulate canonical ensembles using symmetric metts .",
    "one simply needs to restrict the initial state and the collapse basis @xmath46 to the correct symmetry sector .",
    "in particular , one should work with an orthonormal basis @xmath47 of @xmath5 .",
    "if these states are ( block ) product states , they can be easily encoded as symmetric mps with small bond dimensions , where matrix indices obey the constraint . as the hamiltonian @xmath3 commutes with @xmath1 ,",
    "the symmetry constraints on the mps also hold during the imaginary - time evolution @xmath48 . now , the projective measurements @xmath39 need to be done such that also @xmath49 has quantum number @xmath4 . if we use a symmetric collapse basis ( i.e. , every basis state is a @xmath1 eigenstate ) , we always stay in the same symmetry sector as transition probabilities @xmath50 , in the projective measurements , vanish for states @xmath49 with quantum number @xmath51 . inside the symmetry sector with quantum number @xmath4 , detailed balance is fulfilled as in eq .  .    in practice , using the same symmetric collapse basis for every transition in the markov chain can however be very inefficient , because it often leads to strong autocorrelations between subsequent metts samples .",
    "this is obvious for infinite temperature , where we would be stuck in the initial state of the markov chain .",
    "to arrive at an efficient algorithm , one needs to alternate between different symmetric bases . to this purpose ,",
    "we introduce novel symmetric collapse bases and discuss their properties in the following ( sec .",
    "[ sec : bases ] ) .",
    "after completion of this work , we noticed ref .",
    "@xcite . to our knowledge",
    "it is the only previous work trying to simulate canonical ensembles with metts .",
    "in particular , a canonical ensemble for the bose - hubbard model in the gapped mott regime was simulated , only using the @xmath52 eigenbasis , i.e. , fock states . because of the strong autocorrelations , only every 200th metts sample was included in the final ensemble .",
    "it is possible and often advantageous to switch between different collapse bases in order to decrease autocorrelation times in the markov chain .",
    "for example , one can do projective measurements using a basis @xmath46 for all odd iteration steps and a second basis @xmath53 for all even iteration steps .",
    "detailed balance is still fulfilled in every second iteration step , as @xmath54 where @xmath44 and @xmath49 are from basis 1 and @xmath55 from basis 2 .",
    "a simple example is to collapse alternatingly to @xmath56 and @xmath57 eigenstates , respectively , for a spin-@xmath0 system as described in ref .",
    "@xcite . for a general system with a @xmath58-dimensional local state space ( e.g. , the bose - hubbard model with a maximum of @xmath59 particles per site )",
    ", one can generate haar - random collapse bases for each iteration step and lattice site @xcite .",
    "note that in both cases , these measurements break the symmetry associated with the conservation of total magnetization @xmath60 or total particle number @xmath61 , respectively , because the basis states are not symmetry eigenstates .",
    "such metts computations hence simulate the grand - canonical ensemble and symmetries can in general not be utilized .",
    "if we use a single collapse basis @xmath46 such as @xmath56 eigenstates for a spin system or @xmath52 eigenstates for a system of bosons or fermions , there is no dynamics at all at infinite temperature ( @xmath62 ) .",
    "starting from an arbitrary initial state @xmath44 , transitions to all other basis states are impossible such that the metts simulation is stuck in the state @xmath44 .",
    "having the metts dynamics at high temperatures in mind , we can minimize autocorrelation times by switching between collapse bases @xmath46 and @xmath53 with minimum overlap , i.e. , when overlaps @xmath63 are as small as possible .",
    "this guarantees that , at least at high temperatures , transitions to many states are possible and of similar probability . for @xmath62 and a hilbert space of dimension @xmath64",
    ", we then have transition probabilities @xmath65 @xmath66 and also @xmath67 @xmath68 .",
    "more generally , we call a sequence of @xmath69 bases _ maximally mixing _ , if @xmath70 @xmath68 at infinite temperature , where @xmath71 are the transition probabilities after @xmath69 steps , i.e. , when having cycled once through all @xmath69 collapse bases .",
    "one example of maximally mixing bases are the bases @xmath72 and @xmath73 of @xmath56 and @xmath57 eigenstates for a spin-@xmath0 system @xcite . here , @xmath74 and @xmath75 .",
    "unfortunately , this choice of bases is not applicable if we want to exploit the conservation of the total magnetization .    we may call a sequence of @xmath69 bases _ efficiently mixing _ if , at infinite temperature , there are many nonzero @xmath69-step transition probabilities @xmath76 of comparable ( small ) amplitude for every @xmath77 , and if the transitions grant ergodicity .    in the following ,",
    "we give specific examples for maximally mixing or at least efficiently mixing collapse bases that are also applicable for symmetric metts , i.e. , when global quantum numbers are conserved .",
    "inspired by the discrete fourier transform , one can construct maximally mixing bases for any @xmath64-dimensional hilbert space . with a first orthonormal basis @xmath78",
    ", we can choose a second basis as @xmath79 which we call the _ fourier basis _ with respect to @xmath80 .",
    "as @xmath81 @xmath82 we have indeed @xmath83 and also @xmath84 @xmath85 at infinite temperature .",
    "note that we are free to reorder the states @xmath86 .",
    "hence , permutations can be used to construct different versions of the fourier basis .    in principle",
    ", we could use this approach to construct _ global _ symmetric collapse bases that are maximally mixing .",
    "let us discuss this using the example of a spin system .",
    "given an orthonormal basis @xmath72 of @xmath56 eigenstates for the magnetization @xmath87 subspace @xmath88 , we can identify the states @xmath89 with @xmath86 , where @xmath90 , and obtain their fourier basis @xmath91 according to eq .  .",
    "these two bases of @xmath88 are maximally mixing .",
    "we call the metts scheme in which one alternates between collapses in this fourier basis and the @xmath56 eigenbasis `` sf - sz '' ( _ symmetric fourier _ w.r.t",
    ".  @xmath92 ) .",
    "it is illustrated in fig .",
    "[ fig : collapse_drawing ] .",
    "however , such a global fourier transform is technically infeasible because the basis states @xmath93 are in general highly entangled . on average ,",
    "their entanglement entropy is extensive , causing exponentially growing computation costs . to avoid this problem",
    "while retaining the efficient mixing property , we divide the lattice into blocks of @xmath94 lattice sites . for each of these blocks",
    ", we have an @xmath56 eigenbasis and can construct a fourier basis for each symmetry sector of that block .",
    "this is scheme `` sf@xmath94-sz '' in fig .",
    "[ fig : collapse_drawing ] . for a spin-@xmath0 system with magnetization conservation ,",
    "the @xmath95-dimensional hilbert space of a @xmath94-site block is decomposed into @xmath96 symmetry sectors with magnetizations @xmath97 and corresponding subspace dimensions @xmath98 . for each of these subspaces",
    ", we construct collapse bases according to eq .   with @xmath86 referring in this case to the @xmath56 eigenstates of some fixed magnetization on the block ( in some ordering ) .",
    "these bases are maximally mixing within each symmetry sector , but there are no transitions between different symmetry sectors of a block . finally , in order to achieve ergodicity also at infinite temperature and to enhance the dynamics of fluctuations in general , we can shift blocks in every second block collapse by @xmath99 sites as illustrated in fig .",
    "[ fig : collapse_drawing ] .",
    "eigenbasis on each site ( sz ) .",
    "below , we alternate between the sz basis and its global symmetric fourier transform ( sf - sz ) .",
    "these are maximally mixing . in practice , we approximate the sf - sz scheme by restricting the basis construction to blocks of @xmath94 sites , which are shifted by @xmath99 lattice sites for every second collapse ( sf@xmath94-sz ) .",
    "alternatively , a haar - random symmetric basis can be chosen on these blocks ( sr@xmath94-sz ) .",
    "one can also omit the sz - collapse in every second step and only use the fourier basis , again shifting blocks in every second collapse ( sf@xmath94 ) . the swap collapse randomly partitions the lattice into pairs of sites , where , on each pair , the eigenstates of the swap operator are chosen .",
    "the overall collapse basis is the tensor product of these .",
    "again , we approximate the ideal swap collapse by restricting the pairing to blocks of @xmath94 sites ( swap@xmath94 ) , where we shift by @xmath99 sites in every second collapse . ]",
    "it is instructive to shortly discuss the nature of the resulting metts dynamics for an example .",
    "the simplest case is a spin-@xmath0 system in the symmetry sector with a single up - spin , @xmath100 .",
    "first , consider infinite temperature , @xmath62 .",
    "with global maximally mixing bases such as the symmetric fourier @xmath101 bases ( sf - sz ) , every second collapse , the up - spin jumps with equal probability to any new site . in the corresponding block scheme sf@xmath94-sz , the up - spin does a random walk ( diffusive ) whose average step size is proportional to the block size @xmath94 .",
    "in contrast , for zero temperature ( @xmath102 ) , every metts is equal to the ground state in @xmath88 , for which , for hamiltonians of interest , the up - spin is delocalized .",
    "so , at low temperatures , the position of the up - spin after each sz collapse does not change because of the mixing property of the bases , but mainly because of the delocalization due to the imaginary - time evolution .",
    "several variations of this idea are conceivable .",
    "one is to use haar - random , symmetry - conserving collapse bases instead of the fourier bases .",
    "so , instead of applying eq .   to obtain the second basis , one can draw a haar - random basis for each symmetry sector of each @xmath94-site block .",
    "we call the corresponding symmetric metts schemes `` sr@xmath94-sz '' .",
    "while such collapse bases , for the same block size @xmath94 , perform very similarly at high temperatures , their efficiencies at finite temperatures may be quite different and will in general also depend on the system parameters .    for both the sf@xmath94-sz and sr@xmath94-sz bases , where blocks are shifted in every second collapse , we noticed that in practice , the intermediate sz collapses for every second sample are not really necessary .",
    "they actually result in somewhat slower convergence in our exemplary benchmark simulations .",
    "this can again be understood by considering the overlaps of the different basis states .",
    "we denote the schemes where sz collapses are omitted by sf@xmath94 and sr@xmath94 .",
    "the symmetric fourier and random block bases naturally have non - symmetric counterparts that can be applied in simulations of grand - canonical ensembles without symmetries .",
    "one simply omits the partitioning of the hilbert space into symmetry sectors and uses eq .   or the haar - random choice in the full @xmath94-site hilbert space .",
    "such non - symmetric fourier bases are always maximally mixing .",
    "let us briefly mention another variation that we pursued for the construction of efficiently mixing symmetric collapse bases .",
    "it is based on the swap operator that acts on a pair of lattice sites and swaps their quantum states . for two spins-@xmath0 ,",
    "it is @xmath103 let @xmath104 act on sites @xmath105 and @xmath106 of the lattice . as @xmath107=0 $ ] , we can use a symmetric eigenbasis of the swap operator , @xmath108 as a collapse basis on pairs of sites .",
    "ideally , we would randomly select arbitrary pairs of lattice sites @xmath109 and choose the swap eigenbasis on each of these pairs , forming the global collapse basis as their tensor product ( `` swap '' in fig .",
    "[ fig : collapse_drawing ] ) . to avoid extensive entanglement",
    ", we again restrict the random pairing of sites to blocks of @xmath94 lattice sites ( `` swap@xmath94 '' in fig .",
    "[ fig : collapse_drawing ] ) .",
    "again , we shift the blocks by @xmath99 lattice sites in every second collapse . for block size @xmath110",
    ", the symmetric fourier basis coincides with the swap basis .",
    "there are two key factors that influence the convergence of observables in the metts algorithm .",
    "first , the choice of the collapse bases @xmath111 ( @xmath112 ) determines the metts ensembles @xmath113 from which we sample .",
    "if we could draw independent samples without any autocorrelations , the statistical error of an observable @xmath114 would solely depend on the distribution of its measurement values @xmath115 and their corresponding probabilities @xmath37 in the metts ensemble .",
    "second , the collapse bases influence the strength of autocorrelations between metts samples .    to see the interplay of collapse bases and observables , consider , e.g. , the operator @xmath116 in a spin-@xmath0 system with spin - flip symmetry . at high temperatures ( @xmath117 )",
    ", every metts sample equals its corresponding basis state up to corrections of order @xmath118 , i.e. , @xmath119 .",
    "now , if we collapse into states @xmath44 that are eigenstates of @xmath120 and @xmath121 , we have @xmath122 and , hence , @xmath123 .",
    "the distribution of measurement values in this metts ensemble is peaked around the expectation value @xmath124 , leading to small statistical errors .",
    "if , however , we choose basis states @xmath125 that are eigenstates of @xmath126 and @xmath127 , we have @xmath128 , and @xmath129 with probabilities @xmath130 , leading to large statistical errors .",
    "note that if our observable of interest happened to be , say , @xmath120 , the effect would be exactly reversed .",
    "hence , there is no generally optimal choice of collapse bases as the answer also depends on the observables of interest . at low temperatures ,",
    "the metts become similar to the ground state of the system and , provided it is non - degenerate , the distribution of measurement values is strongly peaked around the ground state expectation value for any collapse basis .",
    "for the effect of autocorrelations , consider first the nave way of simulating canonical ensembles by the same symmetry eigenbasis @xmath46 for every collapse ( e.g. , `` sz '' in fig .",
    "[ fig : collapse_drawing ] ) . at infinite temperature ,",
    "as discussed previously , the markov chain can not leave its initial state because @xmath131 . for small values of @xmath118 ,",
    "the probability that two subsequent samples are equal is still high because @xmath132 .",
    "thus , the collapse may occasionally induce a few transitions , but autocorrelations between subsequent samples remain high .",
    "one obtains slow diffusive dynamics in the markov chain ( left panel in fig .",
    "[ fig : diffusion ] ) . this can be resolved by using a sequence of efficiently mixing bases . for a spin-@xmath0 system with magnetization conservation",
    ", we can , e.g. , alternate between sz collapses and the corresponding symmetric fourier or haar - random block bases .",
    "the larger we choose the blocks , the better the markov chain explores the state space due to reduced autocorrelations ( center and right panel in fig .",
    "[ fig : diffusion ] ) .",
    "heisenberg chain with zero magnetization and system size @xmath133 .",
    "for the canonical ensemble at inverse temperature @xmath134 , we show the classical product states @xmath89 after the collapse , using the sz collapse ( left panel ) and alternating between sz and the symmetric haar - random collapse ( sr@xmath94-sz ) with block sizes @xmath135 ( center ) and @xmath136 ( right panel ) .",
    "note that for sr@xmath94-sz , we can only show the product state for every second sample ( after the sz collapses ) .",
    "the markov chains are thermalized ( first @xmath137 samples discarded ) . ]    a third factor are of course the system parameters .",
    "they become more important at lower temperatures .",
    "as the temperature is lowered , the metts @xmath138 get closer and closer to the ground state .",
    "typically , deviations from the ground state are localized if the system is gapped , and delocalized if the system is critical . for our block collapse bases ,",
    "localized deviations then lead again to diffusive dynamics in the metts and autocorrelations may considerably depend on specifics of the chosen bases .",
    "delocalized deviations generally lead to short autocorrelation times .",
    "in the following , we demonstrate the influence of the collapse bases on convergence speeds for spin-@xmath0 xxz chains @xcite with hamiltonian @xmath139 with varying values of the anisotropy parameter @xmath140 .",
    "we focus on symmetric metts computations for the canonical ensemble ( ce ) with zero magnetization and also compare the convergence speeds to those of non - symmetric simulations of the grand - canonical ensemble ( gce ) . the convergence behavior for different temperatures , observables , and collapse bases is shown in fig .",
    "[ fig : collapse_convergence ] .",
    "it demonstrates how our novel collapse bases can significantly improve the convergence in practice .",
    "the statistical error of the metts sampling is quantified as follows .",
    "first , we compute quasi - exact observables using the purification approach @xcite which has been adapted to also describe canonical ensembles and utilize symmetries @xcite . for the error of @xmath141 metts",
    ", we generate several sets of @xmath141 subsequent samples , and take the root mean square of the average deviations of the observable from the quasi - exact reference data in each set .",
    "the dmrg truncation weight @xmath142 and the trotter time step @xmath143 were chosen such that the corresponding errors are negligible compared to the statistical error .",
    "see , e.g. , ref .",
    "@xcite for details or ref .",
    "@xcite for a general review .    in fig .",
    "[ fig : collapse_convergence ] , the first two columns show results for the isotropic antiferromagnet ( @xmath144 in eq .  ) at inverse temperatures",
    "@xmath145 and @xmath146 , and the third column shows results for the point @xmath147 in the gapped nel phase at inverse temperature @xmath148 .",
    "the rows correspond to different observables : the energy per site , @xmath149 , and the correlators @xmath150 and @xmath151 . at high temperatures ( @xmath145 ) , using only the sz collapse leads to strong autocorrelations that slow down the convergence for all three observables shown here .",
    "this problem can be alleviated by choosing the efficiently mixing symmetric fourier or symmetric haar - random collapse bases . in many cases , the symmetric fourier bases work slightly better than the symmetric random bases .",
    "errors reduce with increasing block sizes @xmath94 . of course , larger block sizes also increase computation costs . for the correlator @xmath151",
    ", the simple sz collapse leads , for the chosen temperatures , to relatively small statistical errors .",
    "this can be attributed to the fact that the distribution of measurement values is peaked around the ( small ) expectation values @xmath151 , while it is broader for our novel block bases sf@xmath94 and sr@xmath94 .",
    "still , the latter reduce autocorrelations between samples : the curves corresponding to our new block bases roughly follow the @xmath152 convergence , while the sz - curves start rather flat , which is due to the autocorrelations . in the combination of both effects , the novel block bases typically outperform the simple sz collapse , sometimes reducing errors by an order of magnitude .    for the critical system at low temperatures ( center column in fig .",
    "[ fig : collapse_convergence ] ) , the metts errors are relatively independent of the chosen collapse bases .",
    "our interpretation is that , in this case , the metts are similar to the ground state with deviations from it being delocalized such that the particular choice of the collapse bases in the blocks is not as decisive . for the gapped phase at low temperatures ( right column in in fig .",
    "[ fig : collapse_convergence ] ) , however , the metts errors vary significantly for the different bases .",
    "our interpretation is that , in this case , deviations from the ground state are much more localized such that the distributions of measurement values and autocorrelations depend considerably on the basis choice . for both values of @xmath140 , the fourier bases ( sf@xmath94 ) provide the best results .    to compare convergence speeds , fig .",
    "[ fig : collapse_convergence ] also shows metts errors for a simulation of the gce using the non - symmetric metts algorithm , where one alternates between the @xmath153 and @xmath154 collapse bases .",
    "the comparability is of course somewhat limited as the ce and gce are not equivalent for our finite systems .",
    "overall , the statistical errors in the simulation of the ce with our novel symmetric collapse bases are comparable to and sometimes considerably smaller than those of the gce simulation using the sx - sz bases . hence , beyond cases where one specifically wants to study the ce , simulating the ce with symmetries can be an efficient variant of the metts algorithm when one is interested in the thermodynamic limit , where the ce and the gce yield the same thermal averages .",
    "the symmetry - breaking versions of the fourier and haar - random bases can also be applied in simulations of the gce without symmetries . in many cases ,",
    "this improves the convergence of the sampling as illustrated for the antiferromagnetic spin-@xmath0 heisenberg chain in fig .",
    "[ fig : gce_without_symmetries ] . here , we use haar - random symmetry - breaking collapse bases ( r@xmath94 ) on blocks of @xmath155 and @xmath146 sites and compare the statistical errors of the thermal energy per site .",
    "the behavior observed here is typical : the statistical errors reduce as the block size is increased .",
    "note , however , that larger block sizes also increase computation costs per sample , especially when symmetries are not utilized .",
    "except for ref .",
    "@xcite , metts have so far been used exclusively to simulate grand - canonical ensembles @xcite , alternating between different collapse bases that break the symmetry of the system to reduce autocorrelations . in this case ,",
    "basis states are not eigenstates of the conserved quantities ( @xmath1 ) and it is hence in general not possible to exploit symmetries in the mps representation of the metts .    in the following ,",
    "we discuss a modification of the algorithm to simulate grand - canonical ensembles under utilization of symmetries .",
    "heisenberg chain ( @xmath144 in eq .  ) at inverse temperature @xmath134 .",
    "we show metts errors for the energy per site @xmath149 as a function of the number of samples @xmath141 .",
    "the curves compare non - symmetric haar - random collapse bases ( r@xmath94 ) on blocks of @xmath156 , @xmath157 , @xmath158 , and @xmath146 sites . ]          as illustrated in fig .",
    "[ fig : gce_scheme_ensembles ] , we employ small collections of symmetric metts to exploit symmetries in the dmrg time - evolution . starting from an initial symmetric basis state @xmath44 with some quantum number @xmath4",
    ", we use imaginary - time evolution to obtain the corresponding symmetric metts sample @xmath138 , where symmetries can be utilized in the tdmrg algorithm as described in sec .",
    "[ sec : symmetries ] .",
    "after the evaluation of observables , we apply a collapse that breaks the symmetry such that the resulting basis state @xmath49 only has contributions from a small number of different symmetry sectors .",
    "we write the new basis state as a superposition of ( normalized ) symmetry eigenstates , @xmath159 where @xmath160 is the component with quantum number @xmath161 .",
    "subsequently , the @xmath160 are evolved in imaginary time separately , again exploiting symmetries .",
    "the dmrg time evolution @xcite usually entails a trotter decomposition . after each time step @xmath162 ,",
    "the mps should be renormalized to avoid numerical problems due to the exponential norm decay .",
    "so , after each time step , we multiply the evolved state @xmath106 by a factor @xmath163 . in order to keep the different renormalizations in the separate time evolutions of the states @xmath160 consistent",
    ", we have to determine their relative weights @xmath164 .",
    "these can be obtained by multiplying the renormalization factors @xmath165 , @xmath166 ^ 2 = \\exp\\big[2\\sum_s\\log r^{(j)}_s\\big].\\ ] ] as indicated , we do not actually multiply the @xmath165 but rather accumulate the sum of their logarithms because the @xmath167 decay exponentially in the system size and inverse temperature @xmath118 .",
    "one should take care , that the factors @xmath165 do not comprise the norm change due to the dmrg truncations of bond dimensions , but only the norm change due to the application of evolution operators @xmath168 .    with the resulting normalized states",
    "@xmath169 , the normalized metts sample is then given by @xmath170 and @xmath171 .",
    "however , note that we can evaluate any observable @xmath172 without explicitly encoding the superposition @xmath173 as an mps according to @xmath174 . for symmetry - conserving observables",
    "@xmath175=0 $ ] we have @xmath176 for @xmath177 as @xmath178 @xmath179 , and the expression reduces to the simple sum @xmath180    subsequently , the small collection of symmetric metts is collectively collapsed to a new single symmetric basis state @xmath181 , using , e.g. , any of the symmetric collapse bases described in sec .",
    "[ sec : bases ] .",
    "the transition probabilities for this projective measurement can be obtained using @xmath182 in eq .  .",
    "we end up with a single state @xmath181 that has one of the quantum numbers @xmath183 .",
    "this procedure is repeated , alternating between symmetry - breaking and symmetric collapse bases to explore the different symmetry sectors according to their weights in the gce until the estimates of observables have reached the desired accuracy .",
    "as described , we suggest to alternate between symmetric and symmetry - breaking collapse bases , where elements of the latter should only have components from a few different symmetry sectors to allow for an efficient simulation .    for a spin-@xmath0 system with conservation of the total magnetization , a simple choice is based on the sz collapse . for even iteration steps",
    ", we can use the @xmath56 eigenbasis . for odd iteration steps",
    ", we randomly select @xmath184 sites on which the @xmath185 eigenbasis is used as the collapse basis , while the @xmath92 eigenbasis is used on all other sites .",
    "it is straightforward to obtain the symmetric components , @xmath186 in eq .",
    ", of the non - symmetric basis states in mps form . with these bases , the total magnetizations of subsequent symmetric samples ( @xmath138 and @xmath187 in fig .",
    "[ fig : gce_scheme_ensembles ] ) differ by @xmath188 .    to reduce autocorrelations",
    ", one can start from any of the efficiently mixing symmetric block bases discussed in sec .",
    "[ sec : bases ] and , for odd iteration steps , modify the collapse basis for some randomly selected blocks to allow for changes of the conserved quantities , similar to the role of the @xmath185 eigenbasis above .",
    "we test the algorithm for the isotropic spin-@xmath0 heisenberg antiferromagnet , corresponding to @xmath144 in eq .  . for collapses , we alternate between 4-site block symmetric fourier bases ( sf4 with blocks shifted by 2 sites in every second use ) , and nonsymmetric bases , where the @xmath185 eigenbasis is used for @xmath184 randomly selected sites and the @xmath92 eigenbasis for all other sites ( `` sz / sx '' ) .",
    "[ fig : gce_paths_ensembles ] shows trajectories of the total magnetization @xmath189 occurring in the markov chain and the probability distribution @xmath190 of the magnetization in the gce , obtained by the mpdo approach that was introduced in ref .",
    "the rows in fig .",
    "[ fig : gce_paths_ensembles ] show data for different values of @xmath184 in the symmetry - breaking collapse .",
    "the columns correspond to different inverse temperatures @xmath134 , @xmath158 , and @xmath146 .",
    "whenever we use the symmetric collapse basis ( even steps @xmath191 in the markov chain ) , the metts sample is an @xmath192 eigenstate with magnetization @xmath193 . for odd @xmath191",
    ", @xmath193 is the @xmath192 expectation value .",
    "note that for @xmath194 , we alternate between the @xmath154 eigenbasis and the sf4 bases ( sf4-sx collapse ) .    in all cases ,",
    "the markov chain appropriately explores the symmetry sectors according to their weights . at lower temperatures ,",
    "the distribution is peaked around the center ( @xmath195 ) , while at higher temperatures , a large number of symmetry sectors contribute significant weight to the gce . in the zero - temperature limit @xmath102 , where the system is in its ground state with quantum number @xmath195 , the symmetry - breaking collapse forces the resulting superposition to have components with @xmath196 . however , for low temperatures , the imaginary - time evolution essentially projects onto the ground state , such that all contributions with @xmath196 are exponentially suppressed .",
    "the parameter @xmath184 determines the speed with which the markov chain can explore the symmetry sectors .",
    "it limits the maximum change in magnetization that can be achieved in a single symmetry - breaking collapse .        comparing with quasi - exact purification data , fig .",
    "[ fig : gce_convergence_ensembles ] shows the error of the algorithm as a function of the number of samples .",
    "the dmrg truncation weight @xmath142 and the trotter step - size @xmath143 were again chosen such that the error is dominated by the statistical error .",
    "see ref .",
    "@xcite for a detailed discussion of the interplay of different error sources in the metts algorithm .",
    "we consider the same observables as in fig .",
    "[ fig : collapse_convergence ] , namely the energy per site @xmath149 and the correlators @xmath150 and @xmath151 , all at inverse temperatures @xmath134 , @xmath158 , and @xmath146 .",
    "the error of the energy expectation value decreases with increasing @xmath184 until @xmath197 . for the nearest - neighbor correlator @xmath150 the variations with @xmath184 are rather small . for the correlator @xmath151 at the highest temperature ( @xmath134 )",
    ", errors increase with increasing @xmath184 , and , at the lower temperatures ( @xmath198 ) , the variations with respect to @xmath184 are again rather small .",
    "these properties can again be explained through the competition between autocorrelations and the spread in the distribution of measurement values .    in general , fig .",
    "[ fig : gce_convergence_ensembles ] shows that also for rather small values of @xmath184 , the error of our new symmetric metts algorithm is comparable to the error of the original simulation of the gce without the use of symmetries , where one alternates between @xmath56 and @xmath57 eigenbases on all sites ( sx - sz collapse ) .",
    "hence , the use of symmetries can make metts simulations significantly more efficient .",
    "we have demonstrated how the metts algorithm can be modified to allow for the utilization of symmetries .",
    "conceptually , this is straightforward for the canonical ensemble  one just needs to employ collapse bases that respect the symmetries of the system . in practice , it is important to cycle through a set of different collapse bases to reduce autocorrelation times . to this purpose ,",
    "we have introduced and tested _ efficiently mixing _ collapse bases such as fourier bases and haar - random bases which involve states that are entangled within blocks of several sites .",
    "we have also introduced an efficient algorithm for the simulation of the grand - canonical ensemble under utilization of symmetries , using small collections of symmetric metts .",
    "explicitly encoding symmetries in the mps representation of the quantum states leads to a considerable speedup in the imaginary - time evolution and can hence make the sampling significantly more efficient . for both ensembles ,",
    "we have discussed the effect of the collapse bases on the convergence of the metts algorithm .",
    "good bases grant short autocorrelation times in the markov chain of metts samples and a narrow distribution of measurement values for the observables of interest .",
    "mikeska and a.  k. kolezhuk , in _ quantum magnetism _ ,",
    "645 of _ lecture notes in physics _ , edited by u. schollwck , j. richter , d.  j.  j. farnell , and r.  f. bishop ( springer , berlin , 2004 ) , pp ."
  ],
  "abstract_text": [
    "<S> based on the density matrix renormalization group ( dmrg ) , strongly correlated quantum many - body systems at finite temperatures can be simulated by sampling over a certain class of pure matrix product states ( mps ) called minimally entangled typical thermal states ( metts ) . </S>",
    "<S> when a system features symmetries , these can be utilized to substantially reduce mps computation costs . </S>",
    "<S> it is conceptually straightforward to simulate canonical ensembles using symmetric metts . in practice , it is important to alternate between different symmetric collapse bases to decrease autocorrelations in the markov chain of metts . to this purpose , we introduce symmetric fourier and haar - random block bases that are _ efficiently mixing_. we also show how grand - canonical ensembles can be simulated efficiently with symmetric metts . </S>",
    "<S> we demonstrate these approaches for spin-@xmath0 xxz chains and discuss how the choice of the collapse bases influences autocorrelations as well as the distribution of measurement values and , hence , convergence speeds . </S>"
  ]
}