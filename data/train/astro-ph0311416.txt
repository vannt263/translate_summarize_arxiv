{
  "article_text": [
    "chopping scans are widely used in radioastronomy as they provide an efficient way to reduce the adverse effects that any instabilities present either in the sky signal or some telescope equipment can have on the detection of weak signals .",
    "a chopping scan is defined as a mode of observation where the telescope s secondary mirror is rotated back and forth through some angle and where the signals from both `` end '' positions are integrated separately and subtracted from each other .",
    "this mode is to be compared with the so - called on - off position ( beam switching ) scan where the telescope actually moves back and forth from one end position to the other .",
    "because of the much greater speed at which the secondary mirror can move compared to the telescope , the signal subtraction happens much faster and thus an increase in the ability to detect weak signals . by moving or chopping the secondary mirror even at a relatively low frequency ( e.g.",
    ", 1 hz ) one can obtain a significant improvement in baseline quality when compared to a typical beam switch . in what will follow ,",
    "the secondary mirror displacements are in units of arcseconds as measured on the sky .    at the caltech submillimeter observatory ( cso ) a chopping secondary mirror assembly was installed in 1994 and has since been used both for heterodyne receivers and bolometer cameras ( e.g. , sharc and hertz ) observations .",
    "it is composed , in part , of a carbon fiber mirror mounted on a dc brushless motor along with a system of counterweights which greatly reduces the amount of vibration noise transmitted to the observatory s receivers or cameras .",
    "the huge advantage that this vibration suppression technique brings , for the detection of weak signals comes , however , at the cost of an increase in the inertia of the chopper assembly which causes a reduction in the speed and an increase in the settling time in the response of the system .",
    "we show in figure [ cap : pid ] a block diagram of the chopping secondary system as it has been used since its installation at the cso . once the user of the telescope has selected a chop throw amplitude ( in arcseconds ) and frequency ,",
    "a square wave is sent to the input of a typical proportional - integral - derivative ( pid ) electronic controller @xcite where it is compared to the position signal of the mirror ( obtained through a linear variable differential transformer or lvdt ) . the processed error signal is then sent to a power amplifier which feeds the motor and thus continuously re - positions the mirror while the pid controller acts to minimize the error signal .",
    "because of the relatively slow response of the chopper assembly , and the non - linearities inherent to the system ( see section [ sec : implementation ] ) , the parameters of the pid controller can not be held fixed at a given set of values but have to be adjusted by the user of the telescope for different chop throw amplitudes and frequencies .",
    "although this does not present a problem in principle it has been the experience that the tuning of the controller s parameters can sometimes be a time consuming effort that reduces the efficiency of the observatory .",
    "also , since , as will be shown later , the response time of the assembly is of the order of the chopping period ( or more ) it is often quite difficult to find the appropriate set of parameters that will give optimum results .",
    "too often , the outcome of such exercise is a reduction in the performance of the chopping assembly ; both in its settling time and positioning accuracy .    in the following sections of this paper we will demonstrate how a signal processing method based on the lucy deconvolution technique @xcite was implemented at the cso to solve this problem and provide a system that requires no intervention from the telescope user , while keeping hardware changes to a minimum .",
    "we will start in the next section with a brief exposition of the set of equations that govern the lucy deconvolution technique followed by a presentation of the new chopping secondary assembly ( section [ sec : new - assembly ] ) .",
    "we will finish by showing how the deconvolution technique was implemented , along with the needed modifications , and by presenting some results obtained so far .",
    "an iterative method for signal deconvolution based on the bayes rule for conditional probabilities was introduced by @xcite and has been successfully used in astronomy for the processing and extraction of precise photometric information from originally blurred images taken under average seeing conditions ( see for example @xcite ) .    limiting ourselves to a one - dimensional problem",
    ", the set of equations governing lucy s technique is relatively simple . denoting by @xmath0 and @xmath1 the input and output signals of a linear system , respectively , we know that they are related to each other through the transfer function @xmath2 of this same system by the following convolution integral    @xmath3    where the limits of integration in equation ( [ eq : conv ] ) , and in all of the integrals that will follow , are from @xmath4 to @xmath5 .",
    "the goal of a deconvolution technique is to invert equation ( [ eq : conv ] ) and express @xmath6 as a function of @xmath1 using a new function @xmath7 as follows    @xmath8    lucy s idea was to liken the ( reversed ) time shifted transfer function @xmath9 to a bayes density function of conditional probability . in doing so",
    ", the new function @xmath7 can be interpreted as a new density function and readily determined using the bayes rule by @xcite    @xmath10    or alternatively    @xmath11    evidently , it is impossible to directly determine @xmath7 with equation ( [ eq : g ] ) since it is expressed as a function of @xmath6 which is the unknown that we are trying to evaluate .",
    "but the form of equations ( [ eq : conv ] ) , ( [ eq : deconv ] ) and ( [ eq : g ] ) suggests a simple iterative method that can be used to solve the problem .",
    "if we supply an initial `` guess '' @xmath12 for @xmath6 and insert it in equation ( [ eq : conv ] ) , we find a first approximate solution @xmath13 to @xmath1 .",
    "we then in turn insert @xmath13 along with @xmath12 in equation ( [ eq : g ] ) to get an approximation @xmath14 for @xmath7 . finally , @xmath14 is used in equation ( [ eq : deconv ] ) to get a new function @xmath15 , and so on .",
    "this process can be repeated as often as desired or until convergence is attained .",
    "the final set of equations that define this iterative algorithm can then be written as follows    @xmath16    for @xmath17    finally , two comments to end this section :    * the applicability of the solution to the problem given by equations ( [ eq : s_i ] ) and ( [ eq : r_i+1 ] ) is based on the implied assumption that the transfer function of the system @xmath2 can be measured independently or is known _",
    "a priori_. this is true for the problem of the chopping secondary that will be addressed starting in the next section * it will be noted that the integral in equation ( [ eq : r_i+1 ] ) is actually a correlation .",
    "it follows that the algorithm dictated by the final set of equations can easily be programmed ( i.e. , computer coded ) using subroutines based on the so - called fast - fourier - transform ( fft ) methods for convolution and correlation integrals .",
    "this is what we have done in the implementation of our technique where we have used fortran routines presented by @xcite .",
    "in a simple implementation of equations ( [ eq : s_i ] ) and ( [ eq : r_i+1 ] ) one needs a way to generate an input signal to be applied to a given system , measure the output of the system when subjected to this input and finally evaluate the transfer function of the system .",
    "in order to accomplish this with our chopping secondary system we modified our assembly from that of figure [ cap : pid ] to that of figure [ cap : new_pid ] .",
    "we have replaced the square wave generator of our original system by a real time linux ( rt linux ) computer which is equipped with the necessary input / output devices ( i.e. , analog - to - digital and digital - to - analog converters ) to achieve these tasks .",
    "the rt linux computer also serves as host to the program that performs the necessary calculations and measurements that will allow for the determination of the optimum input to the chopper assembly .",
    "ideally the sequence of operations would go like this    1 .",
    "calibration of the system : signals of constant level are sent to the input of the assembly and the corresponding output levels are measured . in this manner ,",
    "the `` gain '' and `` offset '' of the system are determined and applied to all subsequent input / output operations .",
    "evaluation of the transfer function : this is done by sending a step input signal of a given amplitude to the chopper assembly and calculating the normalized time derivative of the corresponding output signal .",
    "this is a very simple way to evaluate a transfer function since the convolution of an arbitrary function with a unit step function is equivalent to the primitive of the original function .",
    "this is the technique we use although it should be noted that we also smooth the resulting time derivative with a savitzky - golay filter @xcite to reduce the impact of noise in the application of the lucy deconvolution technique .",
    "we will show some examples of measured transfer functions in the next section .",
    "determination of the desired or targeted output signal @xmath1 .",
    "determination of the optimum input signal : to do so one would _",
    "i ) _ choose an arbitrary waveform as a hypothetical input of the assembly ( @xmath12 in equations ( [ eq : s_i ] ) and ( [ eq : r_i+1 ] ) ) , _ ii ) _ calculate the corresponding output response @xmath13 of the system using equation ( [ eq : s_i ] ) and _ iii ) _ calculate a new input @xmath15 using equation ( [ eq : r_i+1 ] ) .",
    "repeat _ ii ) _ and _ iii ) _ ( using @xmath18 and @xmath19 , with @xmath20 , instead of @xmath12 and @xmath13 ) until convergence to the best input @xmath21 signal is attained .",
    "finally , @xmath21 is applied to the input of the assembly to produce the output @xmath22 that most resemble the desired output @xmath1 .",
    "we have tested this technique on simple linear systems ( e.g. , electrical rc filters ) with very good results . however ,",
    "when applied to our chopping secondary mirror assembly the technique did not work in general .",
    "it was determined that the non - linearities in the system s response were the cause of this failure and forced us to bring some changes to the algorithm discussed here .",
    "since we have a dc motor as one of the main components of the chopper assembly , it is not surprising that the system should include some non - linearities in its response .",
    "as one should expect , the magnetic core of the motor is inherently non - linear as it will experience different amounts of saturation depending on the amplitude of the excitation it is subjected to .",
    "that is to say that the transfer function of the system changes with the input signal and that the system reacts differently to different chop throw amplitudes .",
    "moreover , it is also the case that the sign of chop throw will affect the shape of the transfer function .",
    "simply stated , the system has hysteresis and , therefore , does not go `` up '' the same way it goes `` down '' .",
    "this will be made clear with the results presented in figure [ cap : tfunc ] . in this figure",
    "we can see the effect that the non - linearities have on the transfer function of the system .",
    "the transfer functions shown were measured using the method discussed earlier using rising ( `` up '' ) and falling ( `` down '' ) step functions ( 90 arcseconds in amplitude ) at two different rest positions ( 0 and 180 arcseconds for the top and bottom graphs , respectively ) .    from this it is clear why the algorithm defined by equations ( [ eq : s_i ] ) and ( [ eq : r_i+1 ] ) would be doomed to failure .",
    "the same two equations can , however , be easily adapted to the problem at hand and make it possible to use the lucy deconvolution method ( albeit somewhat modified ) for this kind of non - linear system .      as was mentioned in the last section ,",
    "the fact there does not exist a single transfer function that defines the system does not imply that we can not use the lucy deconvolution technique to achieve our goal , but we must acknowledge the existence of a family of transfer functions that are dependent on the input signal to the system .",
    "that is to say , we should replace @xmath2 by @xmath23 , the aforementioned dependence on the input signal @xmath0 now being made explicit . in practice",
    "this means that we now have to measure the transfer functions of the system along a sufficiently refined two - dimensional grid of different step amplitudes ( positive and negative ) and rest positions .",
    "four examples of such measurements were shown in figure [ cap : tfunc ] .",
    "for the results that will be presented later in this section , we have used a grid where the step amplitude ranges from @xmath24 to 240 arcseconds with a resolution of 30 arcseconds and the rest position spans a similar domain with half the resolution ( i.e. , 60 arcseconds ) .",
    "it should be noted that this measurement of the transfer functions requires a fair amount of time ( as much as 15 to 20 minutes for the grid defined above ) .",
    "but , on the other hand , it needs to be done only once and does not have to be repeated for different chop throw amplitudes and frequencies .",
    "another important thing to realize is that , contrary to instances where one uses the lucy technique to deconvolve astronomical images @xcite , we are here free to use the system to measure its response to any given input signal and not forced to calculate it through equation ( [ eq : s_i ] ) .",
    "this means that the original set of equations ( [ eq : s_i ] ) and ( [ eq : r_i+1 ] ) can be reduced to only one equation , namely    @xmath25    with these modifications , the sequence of operations defined in section [ sec : new - assembly ] now becomes    1 .",
    "calibration of the system : signals of constant level are sent to the input of the assembly and the corresponding output levels are measured . in this manner ,",
    "the `` gain '' and `` offset '' of the system are determined and applied to all subsequent input / output operations .",
    "evaluation of the transfer functions : a set of step input signals of differing amplitudes and rest positions are sequentially sent to the chopper assembly and the transfer functions are measured by calculating the normalized time derivative of the corresponding output signals .",
    "a savitzky - golay filter @xcite is applied to the functions to reduce the impact of noise on the deconvolution .",
    "3 .   determination of the desired or targeted output signal @xmath1 .",
    "determination of the optimum input signal : to do so one would _",
    "i ) _ send an arbitrary wave form @xmath12 to the input to the assembly , _",
    "ii ) _ measure the corresponding output response @xmath13 of the system and _ iii ) _ use equation ( [ eq : modlucy ] ) to determine a new input signal @xmath15 .",
    "i ) _ , _ ii ) _ and _ iii ) _ ( using @xmath18 and @xmath19 , with @xmath20 , instead of @xmath12 and @xmath13 ) until convergence to the best input @xmath21 signal is attained .",
    "finally , @xmath21 is applied to the input of the assembly to produce the output @xmath22 that most resemble the desired output @xmath1 .",
    "we have applied this technique to our chopping secondary mirror assembly at the cso with success .",
    "we show typical results in figures [ cap:60_1hz ] and [ cap:300_1hz ] for chop throws of 60 arcseconds and 300 arcseconds , respectively , at a frequency of 1 hertz . for this , we chose the initial input signal @xmath12 to be a square wave with corresponding amplitudes and frequency , the system s response to this input is labeled `` uncorrected output '' in the legends .",
    "the desired or `` targeted output '' signals corresponding to @xmath1 ( also shown on the graphs ) in equation ( [ eq : modlucy ] ) in both cases rise ( or fall ) at the same rate of 3 arcseconds per millisecond when not constant .",
    "a comparison of the `` uncorrected output '' ( @xmath13 ) with the `` corrected output '' ( @xmath22 ) shows the power of this deconvolution method when applied to this type of problems . in both cases",
    "the improvement is significant .",
    "furthermore , it would have been next to impossible to guess which form should the final input signal @xmath21 ( shown by the `` applied input '' curves in the graphs ) take to obtained the desired outcome .",
    "the residual error signal is also plotted in the bottom graph of each figure .",
    "as can be seen , the rms error calculated on flatter parts of the curves are in both cases small ( @xmath26 arcsecond ) .",
    "referring to figure [ cap : tfunc ] we see that the transfer function of the system settles down in about 0.5 seconds , which is exactly equal to half of the period of the signals displayed in figures [ cap:60_1hz ] and [ cap:300_1hz ] .",
    "this means that the assembly would have just enough time to settle into steady state during half of a cycle when subjected to a square wave of a frequency of 1 hertz .",
    "it would be interesting to see how our technique fares when the period of the input signal is reduced to a value that is significantly less than that the system s settling time . to test this",
    "we have subjected the chopper assembly to a signal of a frequency of 4 hz and tried to obtained an output of 60 arcseconds in amplitude .",
    "this is shown on figure [ cap:60_4hz ] where now the `` targeted output '' rises and falls at a rate of 6 arcseconds per millisecond when not constant .",
    "although as could be expected the overall shape of the resulting output signal is somewhat more `` rounded '' when compared to the results shown in figure [ cap:60_1hz ] , the improvement obtained in going from the `` uncorrected output '' to the final output signal ( i.e. , `` corrected output '' on the graph ) is rather significant . in fact , we can see from the bottom graph that for about 52% of a period the response is at most within a few arcseconds from the desired position ; the rms value of the error on that portion of the signal is 1.4 arcseconds .",
    "the caltech submillimeter observatory is funded by the nsf through contract ast 9980846 .",
    "the chopping secondary mirror assembly was designed and built by r. h. hildebrand s group at the university of chicago and was supported by nsf grant # ast 8917950 .    press , teukolsky , vetterling & flannery(1996 ) ogata , k. 1970 , modern control engineering ( new jersey : prentice - hall ) , ch .",
    "5 lucy , l. b. 1974 , , 79 , 745 houde , m. , racine , r. 1994 , , 107 , 466 haykin , s. 1978 , communication systems ( new york : john wiley & sons ) , ch . 5 press , w. h. , teukolsky , s. a. , vetterling , w. t. , flannery , b. p. 1996",
    ", numerical recipes in fortran 77 : the art of scientific computing ( cambridge : cambridge )",
    "figure 1 : the existing chopping secondary mirror assembly at the cso . a square wave signal is sent to the input of the pid controller and compared with the mirror output position signal ( from a lvdt ) .",
    "the resulting processed error signal is sent to a power amplifier which feeds the positioning motor .",
    "+ figure 2 : the new chopping secondary controller .",
    "the new mirror assembly is the same as that of figure [ cap : pid ] , but the input signal is now fed to the pid controller from a rt linux computer , which hosts the deconvolution program that determines the needed input signal .",
    "+ figure 3 : effects of the non - linearities as seen through transfer functions obtained with rising ( `` up '' ) and falling ( `` down '' ) step functions ( 90 arcseconds in amplitude ) at two different rest positions ( 0 and 180 arcseconds for the top and bottom graphs , respectively ) .",
    "+ figure 4 : results obtained with our deconvolution technique for a throw of 60 arcseconds at a frequency of 1 hz ( top ) .",
    "the residual error signal is plotted in the bottom graph and its rms value ( 0.6 arcsecond ) was calculated using data points located between the vertical lines ( on the flatter parts of the curve which represent about 84% of a period ) . + figure 5 : results obtained with our deconvolution technique for a throw of 300 arcseconds at a frequency of 1 hz ( top ) .",
    "the residual error signal is plotted in the bottom graph and its rms value ( 1.1 arcsecond ) was calculated using data points located between the vertical lines ( on the flatter parts of the curve which represent about 60% of a period ) .",
    "+ figure 6 : results obtained with our deconvolution technique for a throw of 60 arcseconds at a frequency of 4 hz ( top ) .",
    "the residual error signal is plotted in the bottom graph and its rms value ( 1.4 arcseconds ) was calculated using data points located between the vertical lines ( on the flatter parts of the curve which represent about 52% of a period ) ."
  ],
  "abstract_text": [
    "<S> we describe a technique for improving the response of a telescope chopping secondary mirror assembly by using a signal processing method based on the lucy deconvolution technique . </S>",
    "<S> this technique is general and could be used for any systems , linear or non - linear , where the transfer function(s ) can be measured with sufficient precision . </S>",
    "<S> we demonstrate how the method was implemented and show results obtained at the caltech submillimeter observatory using different chop throw amplitudes and frequencies . </S>",
    "<S> no intervention from the telescope user is needed besides the selection of the chop throw amplitude and frequency . </S>",
    "<S> all the calculations are done automatically once the appropriate command is issued from the user interface of the observatory s main computer . </S>"
  ]
}