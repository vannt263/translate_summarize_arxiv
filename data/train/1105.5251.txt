{
  "article_text": [
    "magnetism is one of the oldest phenomena known to mankind . in the forms of lodestone and magnetite",
    "it is first mentioned as early as 4000  bc in chinese writings.@xcite the name is often related to the greek province of magnesia where the mineral was first mined , or to the shepherd magnes , `` the nails of whose shoes and the tip of whose staff stuck fast in a magnetick field while he pastured his flocks.''@xcite however , it was not until the 19@xmath2 century that scientists such as oersted , ampre , gauss , faraday , and maxwell took much of the mysticism out of magnetism and put its theory on a stronger , classical scientific foundation .",
    "magnetism s quantum - mechanical origin was then developed during the first half of the 20@xmath2 century .",
    "today , many standard textbooks on the subject exist , courses in _ electricity and magnetism _ are required for many undergraduate and graduate students , and magnetism is omnipresent in today s life through a vast amount of technical applications and gadgets that rely on it . as such",
    ", it is rather surprising that , until just recently , _ no _ complete fundamental theory for magnetism in solids existed .",
    "nowadays , it is well understood that magnetism in atoms and molecules originates from two distinct sources related to quantum - mechanics : the _ spin magnetic moment _ and the _ orbital magnetic moment _ of the electrons .",
    "rigorous theories for both parts exist at several levels , and thus , the calculation of magnetic moments of atoms and molecules has become a standard procedure .",
    "the situation in solids is similar ; the quantity of interest here is the magnetization , i.e.  the magnetic moment per volume . in parallel to atoms and molecules , the magnetization in solids has two distinct contributions : the _ spin magnetization _ and the _",
    "orbital magnetization_. however , while the first can be computed easily , the latter has eluded exact calculation due to the lack of an appropriate theory .",
    "it was not until 2005 that the corresponding theory was developed .",
    "note that already for several decades the two contributions can be determined separately through a combination of magneto - mechanical measurements.@xcite in the present review article we focus on this relatively new _ modern theory of orbital magnetization in solids _ , collecting the fundamental derivations , its applications , and first results .    the focus of this review article is entirely on the orbital contribution to magnetism in solids  as the title emphasizes . for the purpose of this review article we may refer to solids also as infinite , periodic , or extended systems , or simply as crystals .",
    "the calculation of the orbital contributions in finite systems , i.e.  atoms and molecules , is well established and is not the subject of this review ; it can readily be found in standard textbooks .",
    "this review article is organized in the following way : in section  [ sec : importance ] , we explain the importance of the orbital magnetization and its relation to several other properties of current interest . section  [ sec : theory ] contains the theoretical framework for the theory of orbital magnetization .",
    "first , in section  [ sec : problem ] , we focus on the difference between finite systems and solids and explain the mathematical difficulties that arise in the context of periodic systems . then , we show several different derivations of the main theory , from a wannier function approach in sections  [ sec : wannier ] and [ sec : multi - band ] to a semi - classical ( section  [ sec : semi - classical ] ) and finite - temperature ( section  [ sec : finite - temperature ] ) formalism , which can be extended to interacting systems . practical aspects of calculating the orbital magnetization in solids are collected in section  [ sec : practical ] . in particular , we review options for taking the required @xmath0-space derivatives in section  [ sec : k - space_derivatives ] and how to perform calculations using pseudopotentials in section  [ sec : pseudopotentials ] . we further review a single @xmath0-point formula ( section  [ sec : k - point ] ) , a wannier interpolation scheme ( section  [ sec : wannier_interpolation ] ) , and dft specific aspects ( section  [ sec : dft ] ) . in section  [ sec : feconi ] we summarize first results for calculations of the orbital magnetization in fe , co , and ni .",
    "finally , we review several applications of the orbital magnetization in section  [ sec : applications ] .",
    "in particular , sections  [ sec : nmr ] and [ sec : epr ] focus on showing how theories of nuclear magnetic resonance ( nmr ) and electron paramagnetic resonance ( epr ) can elegantly be expressed as derivatives of the orbital magnetization .",
    "other important derivatives are reviewed in section  [ sec : other_derivatives ] .",
    "we conclude with an outlook in section  [ sec : conclusions ] .",
    "as pointed out in the introduction , magnetism in solids originates from two distinct sources , i.e.  spin magnetic moments and orbital magnetic moments . as such",
    ", the orbital magnetization is a crucial part of the overall magnetization .",
    "the reason why it has not attracted more attention in the past  and also the reason why the condensed - matter / materials - science community `` survived '' without a theory for it  is that in many common materials of everyday interest , the orbital contribution is small compared to the spin contribution . in fe , co , and ni for example , it is only of the order of a few percent of the total magnetization;@xcite not surprising , its effects have been neglected in the past . however ,",
    "that is not to say that the orbital magnetization is small in _ all _ materials and in other systems it can have a more important effect and even cancel the spin magnetization.@xcite overall , the orbital magnetization is important in - and - of - itself for a complete description of magnetism in solids .",
    "furthermore , a wealth of applications are directly related to the orbital magnetization .",
    "for example , a theory of solid - state nmr can conveniently be defined in terms of a derivative of the orbital magnetization,@xcite discussed in detail in section  [ sec : nmr ] , removing difficulties related to gauge - origin choices of previous methods . in a similar sense ,",
    "the epr @xmath1-tensor follows from a derivative of the orbital magnetization,@xcite as described in section  [ sec : epr ] .",
    "other derivatives relate to properties such as the magnetic susceptibility , the orbital magnetoelectric coupling and response,@xcite the spin hall conductivity,@xcite and the identification of non - abelian quantum hall states.@xcite    the _ modern theory of orbital magnetization _ is further important because of its close connection to the _ modern theory of electric polarization _ in solids.@xcite in fact , there is an underlying connection between these two theories through the physics of the berry phase,@xcite which has been discovered to thread through many different fields of physics .",
    "this connection between berry s phase , the electric polarization , and the orbital magnetization is thoroughly discussed in two other review articles.@xcite    orbital magnetization permeates all dimensions  it plays an important role in zero - dimensional,@xcite one - dimensional,@xcite two - dimensional,@xcite and obviously three - dimensional systems.@xcite the orbital magnetization is of interest in adatoms,@xcite clusters and quantum dots,@xcite and in metal- and nano - wires.@xcite it plays a role in graphene@xcite and the two - dimensional electron gas.@xcite it further is significant for certain ferromagnets@xcite and antiferromagnets@xcite ; in some ferromagnets it can even compensate the spin magnetization , resulting in zero net magnetization.@xcite the orbital magnetization is of importance in semiconductors,@xcite metallic magnets,@xcite itinerant magnets,@xcite and superconductors.@xcite the orbital magnetization can play an important part in certain half - metals,@xcite mott insulators,@xcite and ordered alloys.@xcite it influences the thermoelectric , anomalous , and topological transport,@xcite the magnetic susceptibility,@xcite as well as the anisotropic magnetoresistance.@xcite finally , it also shows interesting effects at interfaces,@xcite in the quantum hall fluid,@xcite in localized electrons,@xcite and in connection with the orbital polarization of itinerant magnets.@xcite",
    "the theory of orbital magnetization was developed by two research groups independently in 2005 .",
    "although their approaches are completely different , they complement each other and the final expressions derived within each approach  which we have indicated with boxes for easier reference  all come to agreement . in the following sections we review the theory presented in the corresponding original manuscripts . note that we are consistently using _ gaussian units _ throughout , which , at times , deviates from the original manuscripts .",
    "however , before showing details about the derivation of the theory of orbital magnetization in solids , it is instructive to take a moment and consider the original problem .      as pointed out in the introduction , the calculation of orbital contributions to magnetism in atoms and molecules is rather straightforward .",
    "but , what makes its calculation so difficult in solids ?    if we consider a finite system , the orbital contribution to the magnetic moment can be expressed in terms of basic quantities . in a simplified one - particle picture , defining the velocity operator @xmath3 as the commutator of the position operator @xmath4 with the system s hamiltonian @xmath5 , @xmath6\\;,\\ ] ] the total orbital moment in gaussian units becomes @xmath7 here , @xmath8 are the eigenstates of @xmath5 , @xmath9 is the occupation number , and @xmath10 and @xmath11 are the electronic charge and the speed of light , respectively .",
    "this is in parallel to the classically defined moment caused by a current density @xmath12 in gaussian units,@xcite @xmath13 where in the last step we have explicitly included the charge density @xmath14 .",
    "the magnetization @xmath15 can then be defined as the magnetic moment per unit volume @xmath16 as @xmath17 equations  ( [ equ : moment ] ) and ( [ equ : magnetization_finite ] ) are valid for all finite systems , even when very large .",
    "the essential difficulty for truly periodic systems becomes apparent when taking the thermodynamic limit of eq .",
    "( [ equ : magnetization_finite ] ) . in such systems ,",
    "the eigenstates @xmath8 become bloch states @xmath18 with bloch wave vector @xmath19 , in - between which the position operator is ill - defined since bloch states are extended .",
    "it is tempting to try to solve the problem by simply changing to a more localized basis , but this alone does not solve the problem , as we will show in section  [ sec : wannier ] .",
    "also , linear - response methods exist for periodic systems that circumvent the problem in other ways , but they only allow the calculation of magnetization _ changes _ , not of the magnetization itself.@xcite    one might also hope to solve the problem from the point of view of the local bulk current density @xmath12 and its relation to the magnetization . however , while the eigenstates @xmath18 can be used to calculate @xmath12 , it is often wrongly assumed that this uniquely defines the magnetization .",
    "as hirst has emphasized,@xcite the knowledge of @xmath12even in principle  is insufficient to calculate the macroscopic orbital magnetization @xmath15 .",
    "this can easily be seen from the following argument .",
    "consistent with maxwell s equations we can define the orbital magnetization density @xmath20 as@xcite @xmath21 however , @xmath20 can simply be replaced by another @xmath22 , i.e.@xmath23 which has in addition a constant shift @xmath24 and even the gradient of an arbitrary function @xmath25 , but nevertheless produces the same local bulk current density @xmath12.@xcite hence , the macroscopic orbital magnetization @xmath15 can not be uniquely defined as the cell average of @xmath20 . in this respect , the theory of orbital magnetization is similar to the theory of electric polarization , where knowledge of the density @xmath14even in principle  is insufficient to determine the electric polarization @xmath26.@xcite    since the calculation of the orbital magnetization in solids proves difficult , a simple approximation is often used , referred to as _ muffin - tin approximation_. non - overlapping muffin - tin spheres can be centered around the atoms in a solid . within these spheres , which are finite systems , the moment can then be calculated according to eq .",
    "( [ equ : moment ] ) . often , the orbital magnetization indeed originates from regions near the atom cores , making this approximation good when the magnetization is mostly confined to the muffin - tin spheres and the interstitial contribution can be neglected .",
    "this muffin - tin approximation has for example been used in refs .",
    "[ ] . now , having the full theory of orbital magnetization , we can assess the accuracy of this approximation quantitatively , as done for fe , co , and ni in section  [ sec : feconi ] .",
    "for this first derivation of the orbital magnetization we limit ourselves to insulating solids , described by a one - particle hamiltonian with broken time - reversal symmetry .",
    "we further restrict ourselves to spinless electrons , one ( completely occupied ) bulk band , and vanishing chern invariant.@xcite .",
    "these restrictions are non - essential and can easily be removed ; a corresponding multi - band case , metallic systems , and chern insulators are discussed in section  [ sec : multi - band ] . by assuming either a vanishing macroscopic field or an integral number of flux quanta per unit cell , the bloch wave vector @xmath19",
    "is guaranteed to be a good quantum number .",
    "breaking of time - reversal symmetry in such situations can occur through spin - orbit coupling to underlying ordered local moments.@xcite we only focus on the main concepts of the wannier function derivative here and refer the reader to the original manuscript in ref .  [ ] for further details .",
    "we start by considering a finite sample , which we then make larger and larger until it becomes a periodic solid .",
    "the orbital magnetization of the finite sample can be calculated using eq .",
    "( [ equ : magnetization_finite ] ) .",
    "however , as discussed in section  [ sec : problem ] , the thermodynamic limit of this expression is not well - defined . in parallel to the situation of the electric polarization , it is tempting to switch from the delocalized bloch - like eigenstates @xmath8 in eq .",
    "( [ equ : magnetization_finite ] ) , which cause the problem , to well - localized orthonormal orbitals @xmath27 , simply by using the invariance of the trace . in the thermodynamic limit , the @xmath27 deep inside the sample",
    "can then be associated with bulk wannier functions @xmath28 , where @xmath29 is a lattice vector .",
    "since wannier functions are exponentially localized in insulators,@xcite matrix elements of the position operator @xmath4 are now indeed well defined .",
    "it is at this point that this derivation relies on the restrictions described above , as wannier functions in metals or chern insulators are not exponentially localized.@xcite    surprisingly , simply evaluating eq .",
    "( [ equ : magnetization_finite ] ) for a solid in - between the bulk wannier function @xmath28 in the home unit cell , i.e.  @xmath30 , does not result in the total orbital magnetization.@xcite instead , this leads to a contribution that corresponds to the local- or self - circulation of a wannier function @xmath31 i.e.  the circulation resulting from a wannier function rotating around its center .",
    "the volume @xmath32 corresponds to the unit - cell volume .",
    "note that the sum symbol from eq .",
    "( [ equ : magnetization_finite ] ) disappears because we have limited ourselves to only one occupied bulk band , resulting in only one occupied wannier function .",
    "interestingly , the same approach in the case of the electric polarization @xmath26 , i.e.replacing @xmath8 in the analog of eq .",
    "( [ equ : magnetization_finite ] ) with bulk wannier functions @xmath33 , solved the problem completely.@xcite    the missing , second contribution to the magnetization arises from itinerant surface contributions @xmath34 , which  even in periodic systems  have a remnant , fully contained in the bulk band structure . to find this missing contribution , we need to find the surface current caused by the itinerant circulation of the wannier functions .",
    "note that bulk wannier functions of the sample , as they correspond to fully occupied bulk bands , can not carry any current and thus can not produce an itinerant contribution .",
    "surface wannier functions , on the other hand , behave differently ; they are not eigenstates of the hamiltonian and thus evolve over time .",
    "it is important to note that this surface contribution is different from the simple textbook picture where an array of current loops cancel inside a domain and only the surface current remains .",
    "this itinerant contribution originates from the fact that the surface wannier functions or current loops themselves move around the surface !    to show this fact , the authors of the original article in ref .",
    "[ ] used a simple , two - dimensional tight - binding model.@xcite a finite system consisting of 10@xmath3510 unit cells of this hexagonal system is shown in fig .  [",
    "fig : haldane]a .",
    "this figure also shows results for the calculation of the itinerant current @xmath36 ( indicated by arrows ) associated with each wannier function , plotted at the wannier centers @xmath37 .",
    "the current dies - off exponentially into the bulk , as bulk wannier functions do not carry any current .",
    "the surface current obviously gives an additional contribution to the magnetization according to @xmath38    * a ) * * a ) * 10@xmath3510 sample of the haldane model.@xcite the currents @xmath39 associated with each wannier function are plotted using arrows at the corresponding wannier centers @xmath37 .",
    "the itinerant current gives rise to an additional contribution @xmath40 to the orbital magnetization .",
    "* b ) *  horizontal slice of the same materials as in fig .",
    "[ fig : haldane]a , but infinitely long in the vertical y - direction .",
    "( reprinted with permission from ref .",
    "[ ] ;   2005 american physical society).,title=\"fig:\",width=192 ] * a ) * 10@xmath3510 sample of the haldane model.@xcite the currents @xmath39 associated with each wannier function are plotted using arrows at the corresponding wannier centers @xmath37 .",
    "the itinerant current gives rise to an additional contribution @xmath40 to the orbital magnetization .",
    "* b ) *  horizontal slice of the same materials as in fig .",
    "[ fig : haldane]a , but infinitely long in the vertical y - direction .",
    "( reprinted with permission from ref .",
    "[ ] ;   2005 american physical society).,title=\"fig:\",width=230 ]    below , we show how this itinerant surface contribution can be expressed as a bulk property . to this end , we focus on the right edge of the sample displayed in fig .  [",
    "fig : haldane]b .",
    "we use labels @xmath41 and @xmath42 to denote wannier functions to the left and right of the boundary at @xmath43 , respectively .",
    "the @xmath44-component of the current on the right edge of the sample then becomes @xmath45|\\phi_{s'}\\rangle } = -\\frac{e}{\\delta l}\\sum_s{\\sum_{s ' } } ' v_{\\langle s , s'\\rangle , y}\\;,\\ ] ] where we have used eq .",
    "( [ equ : vvec ] ) and inserted a complete set of wannier functions in - between @xmath4 and @xmath5 . in the last step we used the notation @xmath46 .",
    "note that only wannier functions that are within the vertical extension @xmath47 of the strip contribute to the primed sum . in principle",
    ", the first sum should run over all wannier functions @xmath48 , but the ones where @xmath48 is within the subset of @xmath42 do not contribute to the overall current . moving the boundary @xmath43 deep into the bulk and using translational symmetry , the current in eq .",
    "( [ equ : i_1 ] ) becomes @xmath49 where we have further used the fact that there are exactly @xmath50 terms in the sum with a given value of @xmath51 if @xmath52 and zero otherwise .",
    "we divide by 2 in order to extend the sum over all @xmath29 .",
    "the @xmath53-component of the corresponding magnetic moment then finally becomes @xmath54 or more generally @xmath55 clearly expressing also the itinerant contribution @xmath40 as a bulk property .",
    "the final step is to transform the expressions for @xmath56 and @xmath40 back to the bloch representation . with the definition of wannier functions in terms of the cell - periodic part of the bloch functions @xmath57 , i.e.@xmath58 the main result becomes , after some straightforward but tedious algebra , @xmath59 here , we have used the shortcuts @xmath60 and @xmath61 ; the @xmath62 denote the corresponding eigenvalues .",
    "this expression is reminiscent of a result found earlier for the special case of the hofstadter model.@xcite .",
    "equation  ( [ equ : m_orb_wannier_single ] ) is the main result of this section .",
    "it gives the orbital magnetization of a solid in terms of a brillouin - zone integral over well - understood quantities . even in the final expression ,",
    "the two contributions corresponding to the internal circulation of bulk wannier functions ( containing @xmath63 ) and the net currents carried by wannier functions near the surface ( containing @xmath62 ) , are clearly distinguishable .",
    "note that the surface contribution can be written as @xmath64 where @xmath65 is the berry curvature and @xmath66 the berry connection  revealing the underlying relationship with the theory of the berry phase.@xcite it is interesting to note that both contributions to the orbital magnetization in eq .",
    "( [ equ : m_orb_wannier_single ] ) are individually gauge invariant and thus are , in principle , separately observable.@xcite however , this is only true for the simplified case of a single occupied bulk band .    although maximally localized wannier functions were used to derive eq .",
    "( [ equ : m_orb_wannier_single ] ) , in the end the orbital magnetization can be written in terms of bloch states  already suggesting that this expression might also be true for systems where maximally localized wannier functions can not be constructed , such as metals and chern insulators.@xcite in fact , in the next sections we will see that this is indeed the case .",
    "the derivation of the orbital magnetization in the previous section was limited in that it only applied to insulators with vanishing chern invariant and one occupied bulk band .",
    "not long after the original theory appeared in ref .",
    "[ ] , these limitations were removed in ref .  [ ] .",
    "we review here the main results of ref .  [ ] and refer the reader to the original manuscript for further details .",
    "the derivative of a theory of orbital magnetization for multi - band systems follows , in spirit , the outline of the previous section .",
    "we now assume that there are several occupied bulk bands in the solid , indicated by the band index @xmath48 in @xmath67 , with occupation @xmath68 .",
    "this leads to the existence of several wannier functions in each unit cell labeled by @xmath69 .",
    "it is easy to see that , following the same arguments from section  [ sec : wannier ] , one arrives at the same equations , with the only difference being that the wannier functions get an index and sums over bands occur . in summary ,",
    "( [ equ : m_lc_wannier ] ) and ( [ equ : m_ic_wannier ] ) turn into @xmath70 which , after transformation back to bloch states , becomes @xmath71    the main difference between eq .",
    "( [ equ : m_orb_wannier_multi ] ) and eq .",
    "( [ equ : m_orb_wannier_single])besides the band indices and sum over bands  is the fact that in the single - band case both contributions @xmath72 and @xmath73 by themselves are gauge invariant , while in the multi - band case only their _ sum _ is .",
    "the corresponding proof goes beyond the scope of this review , but is given in much detail in ref .",
    "[ ] . in the same reference , it is also shown that terms in eq .",
    "( [ equ : m_orb_wannier_multi ] ) can be regrouped such that the overall magnetization is again written as a sum of two contributions , whereas each contribution itself is now gauge invariant .",
    "this relationship is further investigated in ref .",
    "[ ] , where it is shown  through an elegant relation to the @xmath74-sum rule  that the two contributions can be determined separately through a combination of gyromagnetic and magneto - optical experiments .",
    "similar to the single - band case below eq .",
    "( [ equ : m_ic_berry ] ) , one can define a multi - band berry curvature as @xmath75 which in turn allows for a simple definition of the chern invariant @xmath76 it can now easily be seen that eq .",
    "( [ equ : m_orb_wannier_multi ] ) is invariant with respect to shifts in the energy zero ( as it must ) , as long as the chern invariant vanishes , which we have assumed so far . from this , one can heuristically find an expression for the orbital magnetization , even for cases in which the chern invariant is not zero , by simply enforcing the constant energy shift invariance again .",
    "it follows that a suitable extension of eq .",
    "( [ equ : m_orb_wannier_multi ] ) is @xmath77 where @xmath78 is the chemical potential . the factor of 2 in front of @xmath78 is necessary to compensate the shift of the energy zero , which affects the hamiltonian as well as the eigenvalues .",
    "equation  ( [ equ : m_orb_wannier_all ] ) together with ( [ equ : chern ] ) lead to @xmath79 for any insulator and @xmath78 in the gap , suggesting that the magnetization changes linearly with @xmath78 if the chern invariant is non - zero .",
    "this peculiar result is a remnant of the surface states present in chern insulators@xcite and has been proven numerically.@xcite    without proof , but based on numerical simulations , it can also be shown that eq .",
    "( [ equ : m_orb_wannier_all ] ) holds for metallic systems,@xcite and is thus a generally valid expression for all solids .",
    "its correctness is further supported by alternative derivations , which are presented in the following sections .      both of the previous sections derived a fully quantum - mechanical theory of the orbital magnetization in solids based on a transformation to well - localized wannier functions to circumvent the problems of the position operator in extended systems . at the same time",
    "the wannier function approach was developed , a separate research group ",
    "completely independent  derived an identical expression of the orbital magnetization through very elegant arguments concerning the semi - classical equations of motion for bloch electrons , as described in detail in ref .  [ ] .",
    "its derivative , presented below , and the derivations from the previous sections nicely complement each other , each offering insight into certain aspects of the same physics that the other can not provide .",
    "the derivation starts from the semi - classical equations of motion in gaussian units for an electron wave packet in band @xmath48 , i.e.@xmath80 where @xmath81 and @xmath82 are the external electric and magnetic field , respectively . for simplicity ,",
    "in the following we will assume spatially constant external fields .",
    "it is interesting to note that the second term on the right hand side of eq .",
    "( [ equ : rdot ] ) is often overlooked in elementary textbooks .",
    "this `` anomalous velocity '' containing the berry curvature is important for properties such as the anomalous hall conductivity.@xcite    closely linked to these semi - classical equations of motion is the phase - space volume element @xmath83 , which liouville s theorem predicts to be conserved , as is schematically depicted in fig .",
    "[ fig : phase_space ] . if we consider the equation of motion for the volume element,@xcite @xmath84 , and insert eqs .",
    "( [ equ : rdot ] ) and ( [ equ : kdot ] ) we find for the time evolution of the volume element @xmath85 since @xmath86 depends on @xmath19 , it appears that the volume element changes during the time evolution of the state variables @xmath87 , violating liouville s theorem .",
    "the situation can be remedied by introducing a modified density of states @xmath88 such that the number of states in the volume element @xmath89 is constant again . then",
    ", the expectation value of a physical observable @xmath90 can be written as @xmath91 for systems with time - reversal and inversion symmetry in the spatial wave function the berry curvature is zero and eq .",
    "( [ equ : phase_space ] ) does not reveal any new physics .",
    "but , in systems where the berry curvature is non - zero such as crystals with broken time - reversal or inversion symmetry , eq .",
    "( [ equ : phase_space ] ) provides an elegant way to study berry - phase effects .",
    "schematic depiction of the volume element @xmath92 in phase space @xmath87 .",
    "the volume element might change its shape as a function of time , but the volume itself is conserved according to liouville s theorem .",
    "( figure modeled after ref .  [ ] ) .,title=\"fig:\",scaledwidth=35.0% ] +    in the original paper , ref .",
    "[ ] , the authors give several examples of how eq .",
    "( [ equ : phase_space ] ) can be used to derive , in a simple manner , expressions for the electron density or the anomalous hall conductivity . in particular",
    ", it can be used to derive an expression for the orbital magnetization .",
    "to that end , we describe an electron semi - classically through a wave packet in bloch band @xmath48 . such a wave packet is found to rotate about its center of mass,@xcite leading to a magnetic moment missing in the original equation published in ref .",
    "[ ] , as pointed out in ref .",
    "@xmath93 in a weak magnetic field @xmath94 , the band structure @xmath95 changes to @xmath96 . if we then express the total energy according to eq .",
    "( [ equ : phase_space ] ) as @xmath97 the orbital magnetization follows by the negative derivative of the energy with respect to @xmath94 in the zero field limit as @xmath98 in perfect agreement with eqs .",
    "( [ equ : m_orb_wannier_single ] ) and ( [ equ : m_orb_wannier_all ] ) .    since this semi - classical derivation does not rely on the localization properties of wannier functions , it is valid for all insulators and metals alike , further supporting the heuristic arguments from section  [ sec : multi - band ] .",
    "the derivatives of the orbital magnetization formula from the previous sections had limitations in that they were either only valid for insulators or they were based on semi - classical arguments . here , we review a completely general derivation of the same expression , which is free of these limitations and",
    "was first presented in ref .",
    "the starting point for this derivation is the thermodynamic definition of the orbital magnetization @xmath99 where @xmath100 is the grand canonical potential , @xmath94 is the magnetic field , and @xmath32 is the unit - cell volume .",
    "the derivative is to be taken at constant temperature @xmath101 and chemical potential @xmath78 .",
    "it is convenient to first focus on the related quantity @xmath102 with @xmath103 .",
    "the original orbital magnetization can then be recovered by integration of @xmath104 where @xmath105 .",
    "next , we apply an external , slowly varying field @xmath82 with vector potential @xmath106 and wave vector @xmath107 , pointing in the @xmath108-direction according to @xmath109 at the end of this derivation , we will take the limit @xmath110 .",
    "if we consider the original system to be described by the hamiltonian @xmath111 with bloch eigenfunctions @xmath112 and eigenvalues @xmath113 , we can treat the magnetic field as a perturbation , e.g.  @xmath114 , with @xmath115\\;.\\ ] ]    we can then define the grand - canonical ensemble energy density as @xmath116\\;,\\ ] ] where @xmath117 is now the operator @xmath118 and @xmath119 .",
    "perturbation theory yields in first order a change in @xmath117 according to @xmath120\\;.\\end{aligned}\\ ] ] however , in linear order in @xmath121 the change in @xmath117 can also be written as @xmath122 such that , through comparison of eqs .",
    "( [ equ : k_perturbation_1 ] ) and ( [ equ : k_perturbation_2 ] ) , one can find an explicit expression for @xmath123 .",
    "note that the first two terms of eq .",
    "( [ equ : k_perturbation_1 ] ) do not contribute to @xmath123.@xcite inserting the first order change of the wave function @xmath112 in eq .",
    "( [ equ : k_perturbation_1 ] ) and taking the limit @xmath110 , one finds after some straightforward but tedious algebra is missing in the original expression in eq .",
    "( 13 ) of ref .",
    "[ ] . ] @xmath124\\;.\\end{aligned}\\ ] ]    for @xmath125 , the derivative @xmath126 becomes a @xmath127-function of @xmath128 and the second term in eq .",
    "( [ equ : final_m_tilde ] ) vanishes , such that the remainder is in perfect agreement with eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , and ( [ equ : semi_classical ] ) from the previous sections .",
    "a finite temperature expression can be simply derived through integration of eq .",
    "( [ equ : integration ] ) and yields @xmath129\\big]\\ ; , $ } \\ ] ] where the berry curvature @xmath86 and @xmath130 are defined in eqs .",
    "( [ equ : multi_band_omega ] ) and ( [ equ : m_niu ] ) , respectively .    in ref .",
    "[ ] the authors go on to show that eq .",
    "( [ equ : m_orb_finite ] ) , besides being valid for insulators with or without chern invariants and metals at zero or finite temperatures , is also valid for weak and strong magnetic fields .",
    "it further is applicable to interacting systems , provided that the single particle energies and wave functions are computed using current and spin density functional theory ( csdft).@xcite as such , eq .  ( [ equ : m_orb_finite ] ) presents the most general derivation and concludes our review of derivations for the theory of orbital magnetization .",
    "the expressions for the orbital magnetization in eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , ( [ equ : semi_classical ] ) , and ( [ equ : m_orb_finite ] ) contain the @xmath0-space gradient of the cell - periodic part of the bloch function , i.e.  @xmath131 with @xmath60 , the evaluation of which is not necessarily trivial . in the following , we review three practical options to compute this derivative .",
    "the first option can be considered _",
    "analytical _ and is based on standard perturbation theory .",
    "the change of the states in first order to a @xmath132 perturbation can be expressed as a sum over states , i.e.@xmath133 where the velocity operator @xmath3 is defined in eq .",
    "( [ equ : vvec ] ) .",
    "the disadvantage of this expression is that _ all _ states have to be included , even unoccupied ones .",
    "however , often first - principles computer codes  to save compute time  do not calculate many unoccupied states .",
    "also , when plane waves are used , the sum converges very slowly and becomes unpractical .",
    "equation  ( [ equ : sum_over_states ] ) is , however , useful in the context of localized basis sets or tight - binding models , where the number of states is small . in particular , this method has been used to calculate the results presented in section  [ sec : k - point ] .",
    "the second option is _ numerical _ in nature , making use of the covariant derivative.@xcite the numerical derivative is not trivial , as can be seen from the following example : let @xmath134 be a vector that connects @xmath19 with a nearby point in direction @xmath135 . in principle , we would then like to approximate the desired derivative as the finite difference @xmath136 and the expression becomes exact in the limit of @xmath137 . however , numerically this is not a well - defined quantity .",
    "while the states @xmath138 and @xmath139 can easily be obtained through diagonalization of the hamiltonian at these points , they in general will have arbitrary and unrelated overall phase factors , depending on the diagonalization routine used .",
    "thus , simply numerically subtracting the states yields unpredictable results .",
    "the problem of the phase can be circumvented by replacing the normal derivative with the covariant derivative@xcite @xmath140 here , @xmath141 projects onto the empty states at point @xmath19 and is defined as the complement of @xmath142 , i.e.@xmath143 , which projects onto the occupied manifold @xmath144 .",
    "note that the definition of a derivative on such a manifold is not unique and the covariant derivative is a choice",
    "; other choices exist , which also have components in the occupied states . we can then define dual states @xmath145 as a linear combination of the occupied states @xmath146 at point @xmath147 as @xmath148 where @xmath149 is the overlap matrix @xmath150 for sufficiently small @xmath134 , @xmath149 becomes nearly diagonal , containing only the arbitrary overall phase factors of @xmath151 and @xmath138 in its diagonal elements .",
    "the covariant derivative can then simply be written as @xmath152 which is manifestly gauge independent in the sense that it does not depend on the choice of phases for the @xmath153 .",
    "it thus resolves the phase issue of eq .",
    "( [ equ : phase_issue ] ) and is numerically accessible .",
    "note that the covariant derivative @xmath154 still has the same overall phase factor as @xmath155 , which then cancels when evaluating matrix elements such as the orbital magnetization .",
    "the effect that the overlap matrix plays in canceling the arbitrary overall phase can be seen more clearly if only one band is considered , as is done explicitly in eq .",
    "( 26 ) of ref .",
    "the dual states enjoy the property of being orthogonal to the original states @xmath156 from which follows immediately that @xmath157 in other words , the covariant derivative is orthogonal to the occupied states , as evident by the projector @xmath141 in eq .",
    "( [ equ : covariant_derivative ] ) .",
    "the covariant derivative requires that the number of occupied states at @xmath19 and @xmath158 is the same , i.e.  the material has to be an insulator .",
    "this is a remnant of the fact that it was first developed in the context of the electric polarization,@xcite which is only defined in insulators .",
    "however , it is conceivable that the formalism of the covariant derivative can be extended to metallic systems .",
    "the third option for calculating @xmath0-space derivatives is based on linear - response theory . if we multiply eq .",
    "( [ equ : sum_over_states ] ) from the left with @xmath159 , we find @xmath160 where @xmath161 .",
    "this is a sternheimer equation , similar to eq .",
    "( 25 ) in ref .",
    "the advantage of this expression is that the expensive sum over all states vanishes and the right hand side can be evaluated with only knowledge of the occupied states .",
    "the equation then forms a linear system , which can easily be inverted to find @xmath131 by iterative algorithms , such as a conjugate - gradient approach .",
    "this linear - response approach can be used to calculate the orbital magnetization in real , metallic systems and , in particular , has been applied to calculate the orbital magnetization in fe , co , and ni , discussed in section  [ sec : feconi ] .",
    "many first - principles electronic - structure codes use plane waves as basis functions for their many conveniences .",
    "however , to allow for a reasonable basis - set size the true coulombic potential of the ions is usually replaced by an effective potential , i.e.  pseudopotential . since the expressions for the orbital magnetization in eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , ( [ equ : semi_classical ] ) , and ( [ equ : m_orb_finite ] ) are strictly speaking only valid in an all - electron picture , they have to be modified to be used within a pseudopotential framework .",
    "the corresponding theory has been recently developed for the special case of norm - conserving pseudopotentials in ref .",
    "[ ] , and we present here a summary thereof .    in the pseudopotential formalism ,",
    "the pseudo hamiltonians @xmath162 and @xmath163 act on the pseudo wave functions @xmath164 and @xmath165 with eigenvalues @xmath166 . as a first approximation , either of the expressions in eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , ( [ equ : semi_classical ] ) , or ( [ equ : m_orb_finite ] ) can simply be evaluated using the pseudo quantities @xmath163 , @xmath165 , and @xmath166 instead of the all - electron ones @xmath5 , @xmath155 , and @xmath113 .",
    "this results  as we shall see in section  [ sec : feconi]in only a small error in the orbital magnetization , on the order of a few percent .",
    "the true wave functions can be recovered from the pseudo ones by means of the projector augmented waves ( paw ) transformation @xmath167.@xcite in the presence of magnetic fields , the paw transformation has to be modified , resulting in a gauge including projector augmented waves ( gipaw)@xcite formalism with the corresponding transformation @xmath168.@xcite the pseudo hamiltonian then is given through @xmath169 . if we define the orbital magnetization as the derivative of the total energy , it follows that @xmath170 where we have used the hellmann - feynman theorem in the last step . explicitly calculating the pseudo hamiltonian through the gipaw transformation , taking the @xmath94 derivative , and finally taking the @xmath171 limit yields @xmath172 with missing in eqs .",
    "( 10)(13 ) in ref .",
    "@xmath173\\,|\\bar{u}_{n{{\\bf k}}}\\rangle}\\;,\\\\ \\delta{{\\bf m}}_{\\text{orb}}^{\\text{para } }     & = & \\frac{g'e}{16m_e^2c^3v_0}\\sum_{n{{\\bf r } } }         \\int \\frac{{d^3\\mspace{-2mu}k}}{(2\\pi)^3 } \\,f_{n{{\\bf k}}}\\ ,         { \\langle\\bar{u}_{n{{\\bf k}}}|({{\\bf r}}-{{\\bf r}})\\times i\\ ;         \\big[{{\\bf r}}-{{\\bf r}},f_{{\\bf r}}^{\\text{nl}}\\big]\\,|\\bar{u}_{n{{\\bf k}}}\\rangle}\\;,\\quad\\\\ \\label{equ : m_orb_pseudo_ddia } \\delta{{\\bf m}}_{\\text{orb}}^{\\text{dia } }     & = & -\\frac{g'\\hbar e}{16m_e^2c^3v_0}\\sum_{n{{\\bf r } } }         \\int \\frac{{d^3\\mspace{-2mu}k}}{(2\\pi)^3 } \\,f_{n{{\\bf k}}}\\ ,         { \\langle\\bar{u}_{n{{\\bf k}}}|{\\bf e}_{{\\bf r}}^{\\text{nl}}|\\bar{u}_{n{{\\bf k}}}\\rangle}\\;.\\end{aligned}\\ ] ] here , @xmath174,@xcite @xmath175 is the electron mass , @xmath176 is the non - local part of the pseudopotential in separable form , and @xmath177 and @xmath178 are the separable non - local gipaw projectors at atomic site @xmath29 . if we denote the gipaw projector as @xmath179 and the all - electron and pseudo partial waves as @xmath180 and @xmath181 , respectively , the latter terms can be written as @xmath182\\;{\\langle\\bar{p}_{m{{\\bf r}}}|}\\;,\\\\ { \\bf e}_{{\\bf r}}^{\\text{nl } }     & = & \\sum_{nm}{|\\bar{p}_{n{{\\bf r}}}\\rangle}\\ ;         \\big[{\\langle\\phi_{n{{\\bf r}}}|{{\\bf r}}\\times(\\boldsymbol{\\sigma }         \\times\\nabla v)|\\phi_{m{{\\bf r}}}\\rangle } -         { \\langle\\bar{\\phi}_{n{{\\bf r}}}|{{\\bf r}}\\times         ( \\boldsymbol{\\sigma}\\times\\nabla\\bar{v})|\\bar{\\phi}_{m{{\\bf r}}}\\rangle}\\big]\\;{\\langle\\bar{p}_{m{{\\bf r}}}|}\\;\\nonumber,\\end{aligned}\\ ] ] where @xmath183 are the pauli matrices and @xmath16 and @xmath184 are the screened atomic all - electron potential and the local pseudopotential , respectively .    the @xmath185 term on the right hand side of eq .",
    "( [ equ : m_orb_pseudo_tot ] ) is indeed the earlier derived expression for the orbital magnetization  eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , ( [ equ : semi_classical])simply evaluated for the pseudo hamiltonian @xmath163 and pseudo wave functions @xmath165 with eigenvalues @xmath166 .",
    "this `` bare '' term is the largest contribution to the orbital magnetization and the other terms in eqs .",
    "( [ equ : m_orb_pseudo_dbare])([equ : m_orb_pseudo_ddia ] ) can be considered corrections to the bare value . at first sight",
    "it might appear that these correction terms are plagued from the same ill - definedness of the position operator @xmath4 in periodic systems , as described in section  [ sec : problem ] .",
    "but , the calculation of these corrections is actually trivial  even in extended systems  since the action of the non - local operators @xmath176 , @xmath177 , and @xmath186 is non - zero only inside spherical regions around the atom at @xmath29 .",
    "first calculations of the orbital magnetization for fe , co , and ni have been carried out in ref .",
    "[ ] using this pseudopotential approach .",
    "we report results for these calculations in section  [ sec : feconi ] , where table  [ tab : feconiresults ] shows explicit results for all terms that contribute to the orbital magnetization in eq .",
    "( [ equ : m_orb_pseudo_tot ] ) .",
    "the expression for the orbital magnetization in eq .  ( [ equ : m_orb_wannier_all ] ) is a @xmath0-space integral over the brillouin zone .",
    "the size of the brillouin zone is inversely related to the size of the unit cell in real space . as such , it is interesting to study how large a supercell has to be such that the brillouin - zone integral is reasonably well approximated by a single @xmath0-point . assuming a large supercell , in ref .",
    "[ ] an effective single @xmath0-point expression is derived , which is particularly useful since most simulations for noncrystalline systems , including car - parrinello simulations,@xcite are routinely performed using a large supercell in combination with only one @xmath0-point .",
    "we present a simplified derivation here and refer the reader to the original manuscript in ref .",
    "[ ] for further details .",
    "the starting point is eq .",
    "( [ equ : m_orb_wannier_all ] ) , slightly rewritten to include the antisymmetric tensor @xmath187 and the shortcut @xmath188 , , has an erroneous minus sign , which propagates through the remainder of that reference .",
    "also , several sums over @xmath48 are missing in ref .",
    "] @xmath189 for a sufficiently large supercell of volume @xmath16 , this expression can be approximated by replacing the @xmath0-space integral by the single @xmath0-point @xmath190 , @xmath191 this approximation is possible because the integrand for the orbital magnetization itself is gauge invariant.@xcite note that the analog case of the electric polarization , where only the integral as a whole is gauge invariant , is more complicated.@xcite if we denote the shortest reciprocal lattice vectors of the supercell as @xmath192 and the derivative in the same directions as @xmath193 , eq .",
    "( [ equ : single_k_start ] ) can be written as @xmath194 where the @xmath0-space derivatives of @xmath195 can be understood as the finite difference @xmath196 such derivatives are numerically difficult due to gauge issues and special care has to be taken as described in section  [ sec : k - space_derivatives ] . approximating this expression with @xmath197 and using the dual states defined in eq .",
    "( [ equ : dual_states ] ) , the orbital magnetization becomes @xmath198 note that the matrix elements @xmath199 and @xmath200 , due to the orthogonality of the dual states in eq .",
    "( [ equ : ortho_dual ] ) , are purely real and vanish after taking the imaginary part .    since the periodicity in @xmath0-space",
    "is described by the vectors @xmath192 , the next nearest neighbor points necessary for these derivatives can all be related to the @xmath190 point via @xmath201 .",
    "the resulting expression for the orbital magnetization is thus indeed a single @xmath0-point formula in the sense that the hamiltonian has to be diagonalized only once at @xmath190 to obtain the eigenvalues @xmath202 and the states @xmath195 ; the orbital magnetization can then be computed only based on these quantities .",
    "the efficiency of this single @xmath0-point formula has been tested in the context of a simple two - dimensional tight - binding model developed by haldane.@xcite this model has no macroscopic magnetization and breaks time - reversal symmetry through a complex second - nearest neighbor hopping , resulting in staggered magnetic fluxes that cancel throughout the unit cell .",
    "the convergence of the orbital magnetization with respect to the size of the supercell can be seen in fig .",
    "[ fig : single_k_results ] .",
    "orbital magnetization of the haldane model@xcite in units of the bohr magneton @xmath203 as a function of the supercell size @xmath204 .",
    "the exact value is compared with the results obtained by evaluating the single @xmath0-point formula from eq .",
    "( [ equ : single_k_point_formula ] ) , using the _ numerical _ and _ analytical _ methods for the @xmath0-space derivatives outlined in section  [ sec : k - space_derivatives ] .",
    "( reprinted with permission from ref .",
    "[ ] ;   2007 american physical society).,title=\"fig:\",scaledwidth=45.0% ] +      an efficient , alternative numerical approach to evaluate the orbital magnetization that targets metallic materials specifically is currently being developed.@xcite the basic idea is to first perform an _ ab initio _ ground - state calculation on a relatively coarse @xmath0-mesh that yields ground - state wave functions and energies . from these ,",
    "partially occupied disentangled wannier functions are constructed,@xcite which then serve as a compact tight - binding - like parameterization of the _ ab initio _ results .",
    "the wannier representation can then be used to interpolate quantities of interest on ( almost ) arbitrarily fine @xmath0-meshes and evaluate the corresponding brillouin - zone integrals easily .",
    "this method of _ wannier interpolation _ has been developed in the context of the anomalous hall effect in ferromagnets , where @xmath0-meshes of up to @xmath205 grid points were necessary to converge the brillouin - zone integral for the anomalous hall conductivity@xcite  a quantity which has much in common with the orbital magnetization .",
    "although the brillouin - zone integrand of the orbital magnetization in eqs .",
    "( [ equ : m_orb_wannier_single ] ) , ( [ equ : m_orb_wannier_all ] ) , ( [ equ : semi_classical ] ) , and ( [ equ : m_orb_finite ] ) is not as spiky as the one for the anomalous hall conductivity , a wannier interpolation scheme still provides advantages . at the time of writing , the corresponding manuscript discussing the interpolation of the orbital magnetization in ref .  [ ]",
    "is under review , and we refer the reader to the published version  once available  for discussion , results , and further details .",
    "the formalisms collected in this review article describe the calculation of the orbital magnetization in periodic solids . as such",
    ", they can be used in conjunction with any first - principles method suitable for solids . while other successful approaches exist , density functional theory ( dft)@xcite has been the primary tool for modeling many molecules and solids  @xcite ; in fact , the vast majority of all electronic - structure calculations today are dft @xcite .",
    "it is thus appropriate to consider some aspects of the calculation of the orbital magnetization that are dft specific .",
    "one of the most important `` ingredients '' for dft calculations is the exchange - correlation functional used . as such",
    ", it is interesting to study which exchange - correlation functional gives results for the orbital magnetization in best agreement with experiment .",
    "however , since the theory of orbital magnetization in solids is rather young , a systematic study of the orbital magnetization s dependence on the functional has not been performed yet .",
    "the results for fe , co , and ni discussed in the next section suggest a slightly better performance of pbe@xcite compared to lda,@xcite but that might also be related to pbe s better overall performance in solids .",
    "however , even if we had access to the _ true _ exchange - correlation functional , dft is only guaranteed to produce the correct ground - state density ; a similar claim for the orbital currents can not be made .",
    "thus , in principle , the calculation of the orbital magnetization  which is defined in terms of orbital currents  within dft is not guaranteed to yield correct results .",
    "it seems that a formulation that also includes currents , such as current density functional theory ( cdft),@xcite should systematically improve results for the orbital magnetization .",
    "but , it remains to be seen if appropriate current functionals , in conjunction with cdft , do indeed yield improved results over standard dft . alternatively , time - dependent current density functional theory ( td - cdft)@xcite or the better developed time - dependent density functional theory ( td - dft)@xcite could in principle be employed . but again , at this point it is not clear that they provide any practical advantage for calculating the orbital magnetization over standard dft",
    ". a somewhat more detailed discussion of these aspects is given in ref .",
    "calculations of the orbital magnetization using the full theory have first been reported in ref .  [ ] . in that paper , the authors calculate the orbital magnetization of fe , co , and ni within dft by evaluating eq .",
    "( [ equ : m_orb_wannier_all ] ) in the pseudopotential context of section  [ sec : pseudopotentials ] , using the linear - response method for the @xmath0-space derivative described in section  [ sec : k - space_derivatives ] .",
    "this framework was implemented in the first - principles electronic - structure code pwscf , which is part of the quantum - espresso package.@xcite at the time of writing , this implementation is not yet publicly available .",
    "results for the orbital magnetization and its split - up into the bare and correction terms according to eqs .",
    "( [ equ : m_orb_pseudo_tot])([equ : m_orb_pseudo_ddia ] ) are collected in table  [ tab : feconiresults ] ; values for @xmath206 are taken from ref .  [ ] and values for the bare and correction terms are taken from the supplemental materials of the same reference . and its supplemental materials only contain pbe results .",
    "the values for lda results were obtained from the authors of ref .",
    "[ ] through personal communication . ]",
    "the results clearly show that , as pointed out in section  [ sec : importance ] , the orbital magnetization in fe , co , and ni is indeed a small effect of only a few percent compared to their spin magnetization of 2.083  @xmath203 ( fe ) , 1.523  @xmath203 ( co ) , and 0.518  @xmath203 ( ni).@xcite it is also interesting to see that the orbital magnetization is well described by the bare term @xmath207 alone and the pseudopotential corrections @xmath208 , @xmath209 , and @xmath210 are usually small .",
    "although only a small effect , it can also be seen from these results that pbe gives slightly better results than lda .",
    "however , that might also be related to the better performance of pbe in solids in general .    with the full theory of orbital magnetization available",
    ", we can now assess the accuracy of the often - used muffin - tin approximation , mentioned in section  [ sec : problem ] . in this approximation",
    ", the orbital contribution can be simply calculated using eq .",
    "( [ equ : magnetization_finite ] ) , integrating over non - overlapping spheres centered around the atoms .",
    "since the sphere volumes are finite systems , the problem of the ill - defined position operator is circumvented . in particular , one can calculate @xmath211\\;u_{n{{\\bf k}}}({{\\bf r}})\\;,\\nonumber\\end{aligned}\\ ] ] where we integrate inside all muffin - tin ( mt ) spheres in real space .",
    "this muffin - tin contribution was calculated in ref .",
    "[ ] for a sphere radius of 2 bohr .",
    "the interstitial contribution is then defined as the total orbital magnetization minus the muffin - tin contribution .",
    "results for fe , co , and ni are collected in table  [ tab : feconi_int_mt ] .",
    "surprisingly , the results show that up to 34% of the orbital magnetization in fe , up to 16% in co , and still up to 8% in ni originate from the interstitial .",
    "as such , it is not surprising that calculations of the orbital magnetization  using the muffin - tin approximation ",
    "strongly underestimate the effect.@xcite .",
    "these results , _ a posteriori _ , provide indeed a strong justification for developing the complete theory of orbital magnetization .    the overall results for the orbital magnetization in table  [ tab : feconi_int_mt ] have also been confirmed with an independent implementation of the wannier interpolation method presented in section  [ sec : wannier_interpolation ] and ref .",
    "on the other hand , preliminary calculations by another group , using an implementation in the wien2k code,@xcite disagree with the results in table  [ tab : feconi_int_mt ] ; however , those results were never published.@xcite",
    "while the orbital magnetization of materials itself is a useful concept , its _ change _ is of much practical interest , as it can be related to several experimental probes .",
    "the calculation of changes of the orbital magnetization has been possible for about 15 years now , using linear - response methods.@xcite but , now that the orbital magnetization itself can be calculated , numerous possibilities open up to develop new approaches  much simpler than linear - response methods  using finite differences .",
    "such approaches might prove particularly useful in situations where linear - response calculations are cumbersome or impossible , or in conjunction with more complex methods of treating exchange and correlation effects , such as hybrid functionals , dft+u , exact exchange , or beyond - dft approaches . in the following sections we focus on calculating the nuclear magnetic resonance shielding tensor and the electron paramagnetic resonance @xmath1-tensor as a finite difference of the orbital magnetization .",
    "nuclear magnetic resonance ( nmr ) is one of the most important experimental techniques used to determine the structure of molecules , liquids , and other disordered systems ; it has thus evolved into one of the most widely used methods in structural chemistry.@xcite similar to the orbital magnetization itself , methods to calculate the nmr response for molecules and clusters , i.e.  finite systems , were developed early on in the quantum - chemistry community,@xcite but calculations for periodic solids were impossible , as the inclusion of a constant magnetic field requires a vector potential that breaks translational symmetry .",
    "while linear - response frameworks to calculate the nmr shielding in solids have been available for a while,@xcite knowledge of the orbital magnetization itself provides a much simpler way to calculate the shielding , referred to as the _ converse _ nmr approach .",
    "the corresponding formalism is described in detail in ref .",
    "[ ] .    when a sample is put in an external magnetic field @xmath212 , a field @xmath213 is induced , resulting in a total magnetic field of @xmath214 at the site of atom @xmath215 .",
    "the nmr shielding tensor @xmath216 for atom @xmath215 is then defined as @xmath217 , or equivalently as @xmath218 we now consider an artificial magnetic dipole @xmath219 at site @xmath215 .",
    "such a dipole would have the energy @xmath220 , which leads to @xmath221 starting from eq .",
    "( [ equ : sigma_def ] ) , we can now use a thermodynamic relationship between mixed partial derivatives and insert eq .",
    "( [ equ : b_tot ] ) to find @xmath222 where @xmath32 is the unit - cell volume and we have written the macroscopic orbital magnetization as @xmath223 . by doing so , in the last step we have made the assumption that the external field can be replaced by the total field , which corresponds to a particular choice of geometry for the sample shape .",
    "however , the results for other sample shapes can easily be recovered through knowledge of the susceptibility.@xcite    equation  ( [ equ : sigma_m_orb ] ) expresses the shielding tensor in terms of changes in the orbital magnetization due to the presence of the artificial dipole @xmath219 , and finite differences can readily be calculated . to that end , the dipole @xmath219 needs to be included in the system s hamiltonian via its vector potential , for which a suitable form has been derived@xcite  a minimal change to existing codes , compared to a linear - response framework .",
    "note that this approach circumvents the difficulties related to including finite external magnetic fields and the choice of gauge origin . in order to evaluate eq .",
    "( [ equ : sigma_m_orb ] ) in a pseudopotential framework , a gipaw transformation similar to section  [ sec : pseudopotentials ] has to be performed , which includes the vector potential of the artificial dipole in the hamiltonian ; the corresponding framework has been derived in ref .",
    "the converse nmr approach has been implemented in the first - principles electronic - structure code pwscf , which is part of the quantum - espresso package.@xcite at the time of writing , this implementation is not yet publicly available .",
    "calculations have been performed within dft by evaluating eq .",
    "( [ equ : sigma_m_orb ] ) through finite differences in the gipaw pseudopotential context using the linear - response method for the @xmath0-space derivative described in section  [ sec : k - space_derivatives ] .",
    "this implementation has already been successfully applied to calculate h , c , f , o , p , and si nmr shifts in a variety of systems such as small molecules , polycyclic aromatic hydrocarbons , bulk water , and selected sio@xmath224 crystals.@xcite      electron paramagnetic resonance ( epr ) is in nature similar to nmr , except that the focus is on electronic spins instead of nucleic spins .",
    "most stable molecules have no unpaired electrons , such that epr is limited to paramagnetic materials and is thus less widely used .",
    "the property of interest is then the electron @xmath1-tensor . as in the case of nmr",
    ", a linear - response framework exists to calculate the @xmath1-tensor.@xcite however , knowledge of the orbital magnetization allows for a direct calculation.@xcite    the @xmath1-tensor deviation @xmath225 from the free - electron value of @xmath226 can be calculated through a change in the orbital magnetization as@xcite @xmath227 where @xmath149 is the total spin .",
    "this approach has been used to study the microscopic structure of radicals and paramagnetic defects in solids.@xcite . in particular ,",
    "calculations have been performed at the dft level by evaluating eq .",
    "( [ equ : epr ] ) through finite differences according to a spin flip in the gipaw pseudopotential context described in section  [ sec : pseudopotentials ] using the linear - response method for the @xmath0-space derivative described in section  [ sec : k - space_derivatives ] . it is interesting to note that , while for the orbital magnetization the pseudopotential correction terms in eqs .",
    "( [ equ : m_orb_pseudo_dbare])([equ : m_orb_pseudo_ddia ] ) play only a minor role ( see table  [ tab : feconiresults ] on page ) , the correction terms play a more significant role when calculating @xmath225 .",
    "derivatives of the orbital magnetization also play an important role in other areas of condensed matter physics .",
    "we conclude this section with a non - exhaustive list , mentioning several recent examples .",
    "the magnetic susceptibility of a material is defined as the derivative of the total magnetization with respect to an external magnetic field . as such",
    ", the derivative of the orbital magnetization contributes to the magnetic susceptibility in general.@xcite    furthermore , in ref .",
    "[ ] the author links the spin - hall conductivity in insulators through a steda - like formula to the magnetic susceptibility , and in particular , to the derivative of the orbital magnetization with respect to a magnetic field .",
    "finite differences calculations of the orbital magnetization were carried out for a simple two - band model of graphene evaluating eq .",
    "( [ equ : m_orb_wannier_all ] ) .    as pointed out in ref .",
    "[ ] , it might be possible to identify non - abelian quantum hall states by experimental measurements of the temperature dependence of the orbital magnetization .",
    "this is of particular interest in view of the recently developed analytical formula for the temperature dependent orbital magnetization in eq .",
    "( [ equ : m_orb_finite ] ) .    in insulators with",
    "broken time - reversal and inversion symmetry , in first order an electric field @xmath228 can induce a magnetization @xmath229 and a magnetic field @xmath94 can induce an electric polarization @xmath26 .",
    "the coupling is described by the linear magnetoelectric polarizability @xmath230,@xcite defined as @xmath231 orbital contributions to these derivatives are discussed in refs .  [ ] and [ ] .",
    "the theory of orbital magnetization in solids is still in its infancy , being developed only in 2005 .",
    "its `` older brother''the modern theory of electric polarization  has been around for over a decade longer.@xcite the modern theory of electric polarization was hugely successful , as the number of citations of its fundamental papers shows .",
    "the theory was a breakthrough because it allows calculations of the polarization as a bulk property , without the need for expensive calculations on slabs or clusters .",
    "it is difficult to predict whether the theory of orbital magnetization will enjoy the same level of success and widespread use ; in light of the fact that magnetism in many materials is well described with the spin contribution only , for which theories have existed for a long time , it seems unlikely that it will .",
    "however , the true success of the modern theory of electric polarization came about when its formalism was widely available in first - principles electronic - structure codes .",
    "in fact , today its formalism is present in almost all of the popular and widely used codes.@xcite currently , the situation is different for the theory of orbital magnetization . at the time of writing ,",
    "prototype implementations only exist for the pwscf part of the quantum - espresso package@xcite and wien2k@xcite , which are not even publicly available yet .",
    "implementations in vasp,@xcite abinit,@xcite and adf@xcite are in a development stage .",
    "once more implementations become widely available , the theory of orbital magnetization can be expected to play an important role in condensed matter physics and materials science .",
    "this review article was written while on sabbatical at the department of materials , university of oxford .",
    "i would like to thank wake forest university for providing this opportunity and _ prof .",
    "nicola marzari _ for being a wonderful host during that time .",
    "i am truly indebted to _ dr .  davide ceresoli _ for countless discussions concerning the orbital magnetization , for proofreading this manuscript , and for his everlasting patience with my questions .",
    "i am further grateful for enlightening discussions with profs . _",
    "david vanderbilt , raffaele resta _ , and _",
    "qian niu_. finally , i am also grateful to _ loah stevens _ , who helped with the literature search and organization of the references for this review article .",
    "999    daniel c. mattis , _ the theory of magnetism made simple : an introduction to physical concepts and to some useful mathematical methods _ , p.",
    "1 ( world scientific publishing , singapore , 2006 ) . the first chapter of this book gives a very nice introduction to the history of magnetism and is available free of charge through the wold scientific website at http://www.worldscibooks.com/etextbook/5372/5372_chap01.pdf .",
    "lucretius carus , _ de rerum natura _ ,",
    "1st century b.c .",
    "references are to vv .",
    ", in the translation by th .",
    "creech , london , 1714 .",
    "pliny , quoted in w. gilbert , _ de magnete _ , trans .",
    "( gilbert club , london , 1900 ) , rev . ed .",
    "( basic books , new york , 1958 ) .",
    "j. bartolom , m. garca , f. bartolom , f. luis , r. lpez - ruiz , f. petroff , c. deranlot , f. wilhelm , a. rogalev , p. bencok , n.b .",
    "brookes , l. ruiz , and j.m .",
    "gonzlez - calbet , phys .",
    "b * 77 * , 184420 ( 2008 ) .",
    "q. niu , _ berry phase and the anomalous hall effect _ , talk presented at the _ 17@xmath2 annual workshop on recent developments in electronic structure methods _ ( cornell university , june 24 , 2005 , ithaca , new york ) .",
    "available at http://es05.physics.cornell.edu/schedule.shtml .",
    "m. head - gordon , _ quantum chemistry : standard methods and new frontiers in wavefunction theory _ , talk presented at the kitp conference _ from basic concepts to real materials _ ( university of california ,",
    "november 5 , 2009 , santa barbara , california ) .",
    "available at http://online.kitp.ucsb.edu/online/excitcm_c09/headgordon .",
    "p. giannozzi , s. baroni , n. bonini , m. calandra , r. car , c. cavazzoni , d. ceresoli , g.l .",
    "chiarotti , m. cococcioni , i. dabo , a. dal corso , s. de gironcoli , s. fabris , g. fratesi , r. gebauer , u. gerstmann , c. gougoussis , a. kokalj , m. lazzeri , l. martin - samos , n. marzari , f. mauri , r. mazzarello , s. paolini , a. pasquarello , l. paulatto , c. sbraccia , s. scandolo , g. sclauzero , a.p .",
    "seitsonen , a. smogunov , p. umari , and r.m .",
    "wentzcovitch , j. phys . : condens .",
    "* 21 * , 395502 ( 2009 ) .",
    "available at http://www.quantum-espresso.org .",
    "d. bonnenberg , k.a .",
    "hempel , h.p.j .",
    "wijn , _ 1.2.1.2.4 atomic magnetic moment , magnetic moment density , g and g factor _ , in _ 1.2.1.2 magnetic properties _",
    "part of landolt - brnstein  _ group iii condensed matter , numerical data and functional relationships in science and technology _ , vol .",
    "3d , 4d and 5d elements , alloys and compounds_.      y. yao , _ first principles calculations of orbital magnetization  preliminary results _ , talk presented at the cecam conference _",
    "orbital magnetization in condensed matter _",
    "( epfl , june 15 , 2009 , lausanne , switzerland ) .",
    "abstract available at http://www.cecam.org/workshop-4-303.html?presentation_id=3575 .",
    "x. gonze , b. amadon , p .-",
    "anglade , j .-",
    "beuken , f. bottin , p. boulanger , f. bruneval , d. caliste , r. caracas , m. cote , t. deutsch , l. genovese , ph .",
    "ghosez , m. giantomassi , s. goedecker , d.r .",
    "hamann , p. hermet , f. jollet , g. jomard , s. leroux , m. mancini , s. mazevet , m.j.t .",
    "oliveira , g. onida , y. pouillon , t. rangel , g .-",
    "rignanese , d. sangalli , r. shaltaf , m. torrent , m.j .",
    "verstraete , g. zerah , and j.w .",
    "zwanziger , comp .",
    ". commun . * 180 * , 2582 ( 2009 ) .",
    "available at http://www.abinit.org ."
  ],
  "abstract_text": [
    "<S> in this review article , we survey the relatively new theory of orbital magnetization in solids  often referred to as the `` modern theory of orbital magnetization''and its applications . </S>",
    "<S> surprisingly , while the calculation of the orbital magnetization in finite systems such as atoms and molecules is straight forward , in extended systems or solids it has long eluded calculations owing to the fact that the position operator is ill - defined in such a context . </S>",
    "<S> approaches that overcome this problem were first developed in 2005 and in the first part of this review we present the main ideas reaching from a wannier function approach to semi - classical and finite - temperature formalisms . in the second part , </S>",
    "<S> we describe practical aspects of calculating the orbital magnetization , such as taking @xmath0-space derivatives , a formalism for pseudopotentials , a single @xmath0-point derivation , a wannier interpolation scheme , and dft specific aspects . </S>",
    "<S> we then show results of recent calculations on fe , co , and ni . in the last part of this review , we focus on direct applications of the orbital magnetization . </S>",
    "<S> in particular , we will review how properties such as the nuclear magnetic resonance shielding tensor and the electron paramagnetic resonance @xmath1-tensor can elegantly be calculated in terms of a derivative of the orbital magnetization . </S>"
  ]
}