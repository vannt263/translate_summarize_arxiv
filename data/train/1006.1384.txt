{
  "article_text": [
    "in recent years , a fruitful interaction between ( computational ) algebraic geometry and statistics has emerged , under the form of algebraic statistics .",
    "the main objects studied by this field are probability distributions that can be described by means of polynomial or even rational maps . among them , an important source of examples are the so called graphical models . in this paper , we focus our attention on a special model : the _ undirected @xmath1-binary factor analysis model _ @xmath2 .",
    "first , let us describe our main player .",
    "consider the complete undirected bipartite graph @xmath0 with four _ observed _ nodes @xmath3 and two _ hidden _ nodes @xmath4 ( cf .",
    "figure [ fig : k24 ] ) .",
    "each node represents a binary random variable and each edge represents a dependency between two random variables . in other words , if there is no edge between two random variables , then they are conditionally independent given the rest of the variables .",
    "we obtain a hidden model from this undirected graphical model by marginalizing over @xmath5 and @xmath6 .",
    "this model is the discrete undirected version of the factor analysis model discussed in ( * ? ? ?",
    "* section  4.2 ) .",
    "the model and its immediate generalization @xmath7 is closely related to the statistical model describing the behavior of restricted boltzmann machines  @xcite , which are widely discussed in the machine learning literature . here , @xmath7 is the binary undirected graphical model with @xmath8 hidden variables and @xmath9 observed variables encoded in the complete bipartite graph @xmath10 .",
    "the main invariant of interest in these models is the expected dimension , and , furthermore , lower bounds on @xmath8 such that the probability distributions are a dense subset of the probability simplex @xmath11 . by direct computation ,",
    "it is easy to show that @xmath12 and @xmath13 are dense subsets of the corresponding probability simplices , so @xmath2 is the first interesting example worth studying .",
    "understanding the model @xmath2 can pave the way for the study of restricted boltzmann machines in general  @xcite .    .",
    "each node represents a binary random variable . ]",
    "the set of all possible joint probability distributions @xmath14 that arise in this way forms a semialgebraic variety @xmath15 in the probability simplex @xmath16 . to simplify our construction",
    ", we disregard the inequalities defining the model and we extend our parameterization to the entire affine space @xmath17 . in other words , we consider the zariski closure of the joint probability distributions in @xmath17 . as a result of this , we obtain an algebraic subvariety of @xmath17 which carries the core information of our model . in turn , we projectivize the model by considering its associated projective variety . this variety is expected to have codimension one and be defined by a homogeneous polynomial in 16 variables .",
    "( an implicitization challenge , ( * ? ? ? * ch .",
    "vi , problem 7.7 ) ) find the degree and the defining polynomial of the model @xmath15 .",
    "our main results state that the variety @xmath15 is a hypersurface of degree 110 in @xmath18 ( theorem [ thm : main ] ) and explicitly enumerate all vertices and facets of the polytope ( theorem [ thm : polytope ] ) .",
    "our methods are based on tropical geometry . since the polynomial is multihomogeneous , we get its _ multidegree _ from just one vertex .",
    "interpolation techniques will allow us to compute the corresponding irreducible homogeneous polynomial in 16 variables , using the lattice points in the newton polytope .",
    "however , this polytope will turn out to be too big for interpolation to be practically feasible .",
    "the paper is organized as follows . in section  [ sec : themodel ] we describe the parametric form of our model and we express our variety as the hadamard square of the first secant of the segre embedding @xmath19 . in section  [ sec : tropicalland ] we present the tropical interpretation of our variety . by means of the nice interplay between the construction described in section  [ sec : themodel ] and its tropicalization , we compute this tropical variety as a collection of cones with multiplicities . we should remark that we do not obtain a fan structure , but , nonetheless , our characterization is sufficient to fulfill the goal of the paper .",
    "the key ingredient is the computation of multiplicities by the so called push - forward formula  ( * ? ? ?",
    "* theorem 3.12 ) which we generalize to match our setting ( theorem  [ thm : stgeneralized ] ) .",
    "we finish section  [ sec : tropicalland ] by describing the effective computation of the tropical variety and discussing some of the underlying combinatorics .    in section",
    "[ sec : computenp ] we compute the multidegree of our model with respect to a natural 5-dimensional grading , which comes from the tropical picture in section  [ sec : tropicalland ] .",
    "once this question is answered , we shift gears and move to the study of the newton polytope of our variety .",
    "we present two algorithms that compute vertices of this polytope by `` shooting rays '' ( algorithm  [ alg : ray ] ) and `` walking '' from vertex to vertex in the newton polytope ( algorithm  [ alg : walk ] ) . using these methods , and also taking advantage of the @xmath20 symmetry of the polynomial and the newton polytope , we compute all _ 17214912 _ vertices our polytope ( in _ p44938 _ orbits under @xmath20 ) , which shows the intrinsic difficulties of this `` challenging '' problem . along the way",
    ", we also compute the tangent cones at each symmetry class of vertices and certify the facet normal directions by looking at the local behavior of the tropical variety around these vectors ( after certifying they belong to the tropical variety ) . in particular , by computing dimensions of a certain linear space ( algorithm  [ alg : certifyfacets ] ) we can check if the vector is a ray of the tropical variety .",
    "in this way , we certify all 246 facets of the polytope modulo symmetry .",
    "we believe these methods will pave the way to attack combinatorial questions about high dimensional polytopes with symmetry as the one analyzed in this paper .",
    "we start this section by describing the parametric representation of the model we wish to study . recall that all our six random variables are binary , with four observed nodes and two hidden ones .",
    "since the model comes from an undirected graph ( see @xcite ) , we can parameterize it by a map @xmath21 , where @xmath22 notice that our coordinates are homogeneous of degree 1 in the subset of variables corresponding to each edge of the graph .",
    "therefore , there is a natural interpretation of this model in projective space . on the other hand , by the distributive law we can write down each coordinate as a product of two points in the model corresponding to the 4-claw tree , which is the first secant variety of the segre embedding @xmath23 ( @xcite ) , i.e. @xmath24 from this observation it is natural to consider the hadamard product of projective varieties :    [ def : star ] let @xmath25 be two projective varieties .",
    "the _ hadamard product _ of @xmath26 and @xmath27 is @xmath28 where @xmath29 .",
    "note that this structure is well - defined since each coordinate is bihomogeneous of degree ( 1,1 ) .",
    "the next proposition follows from the construction .",
    "[ pr : hadamardproduct ] the algebraic variety of the model is @xmath30 where @xmath26 is the first secant variety of the segre embedding @xmath31 .",
    "notice that the binary nature of our random variables enables us to define a natural @xmath32-action by permuting the values @xmath33 and @xmath34 on each index in our 4-tuples . combining this with the @xmath35-action on the 4-tuples of indices",
    ", we see that our model comes equipped with a natural @xmath36-action . in other words ,",
    "the 16 coordinates @xmath37 of @xmath18 , for @xmath38 , are in natural bijection with the vertices of a 4-dimensional cube . assuming @xmath15 is a hypersurface ( as we will prove in section  [ sec : tropicalland ] ) , its defining polynomial is invariant under the group @xmath20 of symmetries of the 4-cube , which has order 384 .",
    "this group action will be _ extremely _ helpful for our computations in the next two sections .",
    "we now describe the ideal associated to the secant variety @xmath39 .",
    "the segre embedding @xmath40 has a monomial parameterization @xmath41 for @xmath42 .",
    "its defining prime ideal is generated by the @xmath43-minors of all three @xmath44-flattenings , together with some @xmath43-minors of the @xmath45-flattenings ( * ? ? ?",
    "* section 3 ) : @xmath46{cccc }    \\!\\!p_{0000}\\ ! & \\!p_{0001}\\ ! & \\!p_{0010}\\ ! & \\ !",
    "p_{0011 } \\!\\ ! \\\\",
    "\\!\\!p_{0100}\\ ! & \\!p_{0101}\\ ! & \\!p_{0110}\\ ! & \\!p_{0111 } \\!\\ !",
    "\\\\    \\!\\!p_{1000}\\ ! & \\!p_{1001}\\ ! & \\!p_{1010 } \\ ! & \\!p_{0111 } \\!\\ !",
    "\\\\    \\!\\!p_{1100}\\ ! & \\!p_{1101}\\ ! & \\ !",
    "p_{1110 } \\ ! & \\!p_{1111}\\!\\ !",
    "\\end{array } \\right),~~ f_{(13|24)}\\!:=\\!\\ !",
    "\\left(\\begin{array}[c]{cccc } \\!\\ !",
    "p_{0000 } \\!&\\ !",
    "p_{0001}\\ ! & \\!p_{0100}\\ ! & \\ !",
    "p_{0101 } \\!\\ ! \\\\ \\!\\ !",
    "p_{0010}\\ ! & \\!p_{0011}\\ ! & \\!p_{0110}\\ ! & \\ !",
    "p_{0111 } \\!\\ ! \\\\ \\!\\ !",
    "p_{1000}\\ ! & \\!p_{1001}\\ ! & \\!p_{1100}\\ !",
    "p_{1101 } \\!\\ !   \\\\",
    "!    p_{1010}\\ ! & \\",
    "! p_{1011}\\ ! & \\ !",
    "p_{1110}\\ ! & \\ !",
    "p_{1111 } \\!\\ !",
    "\\end{array } \\right ) , \\ ] ] @xmath47{cccc } \\!\\ !",
    "p_{0000}\\ ! & \\!p_{0010}\\ ! & \\!p_{0100}\\ ! & \\ !",
    "p_{0110 } \\!\\ ! \\\\ \\!\\ !",
    "p_{0001}\\ ! & \\ !",
    "p_{0011}\\ ! & \\ !",
    "p_{0101}\\ ! & \\!p_{0111 } \\!\\ ! \\\\ \\!\\ !",
    "p_{1000}\\ ! & \\!p_{1010}\\ ! & \\!p_{1100}\\ ! &",
    "\\!p_{1110 } \\!\\ ! \\\\ \\!\\ !",
    "p_{1001}\\ ! & \\!p_{1011}\\ ! & \\!p_{1101}\\ ! & \\!p_{1111 } \\!\\ !",
    "\\end{array } \\right).\\ ] ] in turn , the defining ideal of the first secant variety of the segre embedding can be computed from the previous three @xmath44-flattening matrices .",
    "we state the result for the case of the variety we are studying , although the set - theoretic result is also true for an arbitrary number of observed nodes .",
    "[ @xcite ] the secant variety @xmath48 is the nine - dimensional _ irreducible _ subvariety consisting of all @xmath49-tensors of tensor rank at most 2 .",
    "the prime ideal of @xmath26 is generated by all the @xmath50-minors of the three flattenings .",
    "in this section we define tropicalizations of varieties in @xmath51 and compute the tropicalization of @xmath15 .",
    "see @xcite for more details about tropical varieties .    for an algebraic variety",
    "@xmath52 not contained in a coordinate hyperplane and with defining ideal @xmath53 $ ] , the _ tropicalization _ of @xmath26 or @xmath54 is defined as : @xmath55 where @xmath56 , and @xmath57 is the sum of all nonzero terms of @xmath58 such that @xmath59 is maximum .",
    "alternatively , when working with subvarieties of tori @xmath60 we consider the defining ideal @xmath54 over the ring of laurent polynomials and set @xmath61 both definitions agree if we consider @xmath26 to be the zariski closure of @xmath62 in @xmath51 .",
    "we would go back and forth between these two definitions .",
    "the tropical variety @xmath63 is a polyhedral subfan of the grbner fan of @xmath54 . if @xmath54 is a prime ideal containing no monomials , then @xmath63 is pure of the same dimension as @xmath26 and is connected in codimension one @xcite .",
    "the set @xmath64 is a linear space in @xmath65 and is called the _ lineality space _ of the fan @xmath63 or the _ homogeneity space _ of the ideal @xmath54 .",
    "this space can be spanned by integer vectors , which form a primitive lattice @xmath66 .",
    "this lattice encodes the action of a maximal torus on @xmath26 , given by a diagonal action .",
    "all cones in @xmath63 contain this linear space .",
    "in addition to their polyhedral structure , tropical varieties are equipped with integer positive weights on all of their maximal cones .",
    "we now explain how these numbers can be constructed .",
    "a point @xmath67 is called _ regular _ if @xmath63 is a linear space locally near @xmath68 .",
    "the _ multiplicity _",
    "@xmath69 of a regular point @xmath68 is the sum of multiplicities of all minimal associated primes of the initial ideal @xmath70 .",
    "see ( * ? ? ?",
    "* section 3.6 ) for definitions .",
    "the multiplicity of a maximal cone @xmath71 is defined to be equal to @xmath72 for any @xmath73 in its relative interior .",
    "it can be showed that this assignment does not depend on the choice of @xmath68 . with these multiplicities",
    ", the tropical variety satisfies the _ balancing condition _ @xcite .",
    "as we discussed in the previous section ( proposition  [ pr : hadamardproduct ] ) our variety is expressed as a hadamard power of a well - known variety .",
    "this hadamard square has a dense set which can be parameterized in terms of a monomial map ( the coordinatewise product of two points ) .",
    "the integer matrix of exponents corresponding to this monomial map is @xmath74 .",
    "although tropicalization is not functorial in general , it has nice properties if we restrict it to monomial maps between subvarieties of tori .",
    "we now describe the tropicalization of monomial maps .",
    "let @xmath75 be a @xmath76 integer matrix defining a monomial map @xmath77 and a linear map @xmath78 defined by left multiplication by this matrix .",
    "@xcite [ thm : st ] let @xmath79 be a subvariety .",
    "then @xmath80 moreover , if @xmath81 induces a generically finite morphism of degree @xmath82 on @xmath62 , then the multiplicity of @xmath83 at a regular point @xmath68 is @xmath84 where the sum is over all points @xmath85 with @xmath86 .",
    "we also assume that the number of such @xmath87 is finite , all of them are regular in @xmath88 , and @xmath89 are linear spans of neighborhoods of @xmath85 and @xmath90 respectively .    at first sight ,",
    "the hypothesis of this theorem is not satisfied by our variety because the map @xmath91 is not generically finite .",
    "however it is very close to having this finiteness behavior .",
    "namely , after taking the quotient @xmath92 of @xmath26 by a maximal torus action , and a choice of a suitable monomial map @xmath93 , the map @xmath94 becomes generically finite and we can apply theorem  [ thm : st ] .",
    "we now explain this reduction process .",
    "let @xmath95 a subvariety , @xmath96 a monomial map , and let @xmath97 .",
    "consider the lineality space @xmath98 , and let @xmath99 .",
    "we identify @xmath100 with a @xmath101-basis of @xmath102 .",
    "notice that @xmath103 need not be a primitive lattice in @xmath104 in general .",
    "call @xmath105 its saturation in @xmath104 , that is @xmath106 .",
    "we know by construction and theorem  [ thm : st ] that @xmath107 is contained in the lineality space of @xmath108 .",
    "therefore , we can consider the linear map between these tropical varieties after moding out by @xmath100 and @xmath107 respectively . as we mentioned earlier",
    ", the lineality space of each tropical variety determines the maximal torus action .",
    "for example , @xmath109 acts on @xmath62 by @xmath110 where @xmath111 lies in @xmath66 .",
    "the linear map @xmath75 sends @xmath66 onto @xmath103 , inside the lineality space of @xmath83 .",
    "in addition , the monomial map @xmath81 is compatible with the torus actions on @xmath62 and @xmath112 .",
    "in particular , the equality @xmath113 induces an action on @xmath114 by a subtorus ( the one corresponding to the primitive lattice @xmath105 ) .",
    "thus , we can take the quotient of @xmath62 and @xmath114 by the corresponding actions of tori @xmath115 and @xmath116 .",
    "we obtain the commutative diagram : @xmath117_{\\pi } \\ar@{->>}[r]^{\\alpha } & w\\ar@{->>}[d]^{\\pi}\\\\ v'=v / h \\ar@{->>}[r]^- { \\bar{\\alpha } } & w / h'=w ' . } } \\label{eq:1}\\ ] ] here , @xmath118 and @xmath119 .",
    "since @xmath66 is a primitive sublattice of @xmath120 , it admits a primitive complement in @xmath120 .",
    "fix one of them and call it @xmath121 .",
    "note that this complement need not be the usual orthogonal complement .",
    "assume for simplicity that @xmath103 is a _ primitive _ sublattice of @xmath104 .",
    "therefore , we can identify @xmath122 with the monomial map corresponding to the linear map : @xmath123 since @xmath66 is primitive , @xmath124 , and likewise for @xmath125 .    to simplify notation , call @xmath126 and @xmath127 . from the construction it is easy to see that @xmath128 and @xmath129 as sets .",
    "but in fact , they agree as weighted balanced polyhedral fans .",
    "more precisely ,    [ lm : multimodoutbylineality ] let @xmath130 and let @xmath131 be a subspace of the lineality space of the tropical variety @xmath132 generated by _",
    "integer _ vectors .",
    "then @xmath133 is a balanced weighted polyhedral fan where the multiplicities at regular points @xmath134 are defined as @xmath135 for any @xmath68 in the fiber of @xmath134 under the projection map . with these weights ,",
    "@xmath133 coincides with the tropical variety @xmath136 , where @xmath92 is the quotient of @xmath26 by the torus @xmath137 , which is a subtorus of the maximal torus acting on @xmath26 .    by definition , we know that @xmath138 for any @xmath139 .",
    "let @xmath140 .",
    "call @xmath141 the underlying lattice of @xmath131 .",
    "since @xmath66 is a primitive lattice , we can extend any @xmath101-basis of @xmath66 to a @xmath101-basis of @xmath120 .",
    "thus , after a linear change of coordinates ( i.e.  a monomial change of coordinates given by this new @xmath101-basis of @xmath120 ) we can assume @xmath142 . and in this case , we can pick the direct summand @xmath121 of @xmath66 to be @xmath143 .",
    "in particular , the projection map @xmath144 corresponds to the monomial map @xmath145 determined by the integer matrix @xmath146 , whose columns are a @xmath101-basis of @xmath121 .    by construction ,",
    "@xmath147 $ ] is homogeneous with respect to the grading @xmath148 for @xmath149 and @xmath150 for @xmath151 .",
    "since any homogeneous laurent polynomial is of the form @xmath152 , we see that @xmath54 is generated by laurent polynomials in the variables @xmath153 .",
    "call @xmath154 these generators .",
    "therefore @xmath155 $ ] and @xmath156 $ ] .    from theorem  [ thm : st ] we know",
    "that @xmath157 as sets . moreover , since the subspace @xmath131 lies in all cones of @xmath132 , then the set @xmath136 which is the quotient of @xmath132 by @xmath131 has a natural fan structure inherited from the one of @xmath158 . by definition ,",
    "if @xmath134 is a regular point in @xmath136 then any lifting point in @xmath159 would be a regular point in @xmath132 . moreover , @xmath160 $ ] .",
    "in particular , a primary decomposition @xmath161 determines a primary decomposition of @xmath70 by extending each ideal to the whole laurent polynomial ring in @xmath8 variables .",
    "therefore , to show @xmath162 it suffices to show that the multiplicity of any minimal prime @xmath163 $ ] of @xmath161 equals the multiplicity of @xmath164 $ ] in @xmath165 .",
    "this claim follows from the definition of multiplicity .",
    "more precisely : @xmath166 } \\frac{s_p[x_{1}^{\\pm 1}\\!\\!\\ ! , \\ldots , x_l^{\\pm        1}]}{s_p[x_{1}^{\\pm 1}\\!\\!\\ ! , \\ldots , x_l^{\\pm        1}]{\\textrm{in}}_{{w}'}(i')}\\\\   & =   \\dim_{\\frac{s[x_{1}^{\\pm 1}\\!\\!\\ ! , \\ldots , x_l^{\\pm          1}]_p}{ps[x_{1}^{\\pm 1}\\!\\!\\ ! , \\ldots , x_l^{\\pm 1}]_p } }    \\frac{s[x_{1}^{\\pm 1}\\!\\!\\ ! , \\ldots , x_l^{\\pm 1}]_p}{s[x_{1}^{\\pm 1}\\!\\!\\ ! ,      \\ldots , x_l^{\\pm 1}]_p{\\textrm{in}}_w(i)}=m(p,{\\textrm{in}}_w(i)),\\end{aligned}\\ ] ] where @xmath167 $ ] .    using the previous construction ,",
    "we extend theorem  [ thm : st ] to the case of monomial maps that are generically finite after taking quotients by appropriate tori .",
    "this extension fits perfectly into our setting .",
    "[ thm : stgeneralized ] let @xmath168 be a monomial map with associated integer matrix @xmath75 and let @xmath95 be a closed subvariety .",
    "then , @xmath80 suppose @xmath62 has a torus action given by a rank @xmath169 lattice @xmath170 .",
    "let @xmath171 be the quotient by this torus action .",
    "let @xmath172 be the induced monomial map , with associated integer matrix @xmath173 .",
    "+ suppose @xmath99 is a primitive sublattice of @xmath104 and that @xmath122 induces a generically finite morphism of degree @xmath82 on @xmath171 .",
    "then the multiplicity of @xmath83 at a regular point @xmath68 can be computed as : @xmath174 where the sum is over any set of representatives of points @xmath175 given @xmath176 .",
    "we also assume that the number of such @xmath177 is finite , all of them are regular in @xmath178 and @xmath179 are linear spans of neighborhoods of @xmath85 and @xmath180 respectively .    in case @xmath103",
    "is not a primitive lattice , the formula for @xmath72 will involve an extra factor , namely , the index of @xmath103 with respect to its saturation @xmath181 in @xmath104 . in this case , @xmath125 will correspond to any complement of the primitive lattice @xmath181 inside @xmath104 .",
    "the equality as sets follows from theorem  [ thm : st ] . to prove the formula for multiplicities",
    ", we first note that the sum in   is finite .",
    "this follows because @xmath122 induces a generically finite morphism if and only if @xmath182 if and only if @xmath183 .    from the diagram and the surjectivity of @xmath81 and @xmath122 , we know that the multiplicity formula holds for @xmath184 and the morphism @xmath122",
    ". pick @xmath185 a regular point of @xmath136 and pick any point @xmath68 in the fiber @xmath186 . by definition",
    ", @xmath68 is a regular point of @xmath132 and we have @xmath187 by lemma  [ lm : multimodoutbylineality ] .",
    "we assume all @xmath177 in the fiber of @xmath173 at @xmath185 are regular in @xmath178 and @xmath188 are linear spans of neighborhoods of @xmath189 and @xmath190 respectively .    by construction",
    ", the index set in the formula for @xmath191 agrees with the index set in formula   for @xmath72 .",
    "therefore , our goal would be to show that each summand indexed by @xmath192 in the formula for @xmath191 equals its corresponding summand in formula   for @xmath72 .",
    "we know that @xmath193 by lemma  [ lm : multimodoutbylineality ] .",
    "therefore , we only need to prove that the lattice indices on each summand are the same , i.e.    @xmath194    note that by construction , @xmath195 , @xmath196 , and likewise @xmath197 .",
    "hence , we can consider the quotient of @xmath198 and @xmath199 by @xmath103 .",
    "we obtain @xmath200 the equality in   follows by the identifications @xmath201 and @xmath202 , via projecting to @xmath125 .",
    "[ pr : cartesianprodandmult ] given @xmath203 two irreducible varieties , consider the associated variety @xmath204 .",
    "then @xmath205 as weighted polyhedral complexes , with @xmath206 for maximal cones @xmath207 and @xmath208 .",
    "the equality as polyhedral complexes is a direct consequence of the equality @xmath209 , which follows by buchberger s criterion and the fact that the generators of @xmath54 and @xmath210 involve disjoint sets of variables .",
    "if we pick @xmath211 , @xmath212 regular points , then @xmath213 is a regular point in @xmath214 .",
    "our goal is to prove the multiplicity formula",
    ".    given two primary decompositions @xmath215 $ ] , @xmath216 $ ] , we claim that @xmath217 $ ] is also a primary decomposition .",
    "the equality as sets follows immediately , so we only need to show that @xmath218 $ ] is a primary ideal .",
    "let @xmath219 $ ] and @xmath220 $ ] be associate prime ideals to @xmath221 and @xmath222 respectively . since @xmath223 is algebraically",
    "closed , and @xmath221 and @xmath222 involved disjoint sets of variables , it is immediate to check that @xmath224 $ ] is a prime ideal .",
    "namely , the quotient ring @xmath225/(p_i+q_j)$ ] equals @xmath226/p_i)[{\\underline{y}}]\\otimes_{{\\mathbb{c } } } ( { \\mathbb{c}}[{\\underline{y}}]/q_j)[{\\underline{x}}]$ ] , a tensor product of two domains over @xmath223 , hence also a domain .",
    "moreover , since both @xmath221 and @xmath222 involve disjoint sets of variables , we have @xmath227 + { \\mathbb{c}}[{\\underline{x}}]\\otimes_{{\\mathbb{c}}}{\\textrm{ann}}\\,n_j.\\ ] ] from this and the fact that @xmath228 and @xmath229 for suitable @xmath230 , we conclude @xmath231 thus proving by definition that @xmath232 is a @xmath233-primary ideal .    with similar arguments we conclude that all minimal primes of @xmath234 are sums of minimal primes of @xmath235 and @xmath236 .",
    "this follows because , given @xmath237 $ ] and @xmath238 $ ] prime ideals , it is straightforward to check that @xmath239 if and only if @xmath240 and @xmath241",
    ".    let @xmath242 be maximal cones on @xmath132 and @xmath243 , and let @xmath244 be regular points in @xmath245 and @xmath246 respectively . by definition of multiplicity of a maximal cone",
    ", we have @xmath247/{\\textrm{in}}_u i ) = \\!\\!\\!\\!\\!\\!\\!\\!\\!\\sum_{\\substack{p\\in { \\textrm{ass}}({\\textrm{in}}_u(i))\\\\ p \\textrm { minimal } } } \\!\\!\\!\\!\\!\\!\\!\\!\\!\\dim_{({\\mathbb{c}}[{\\underline{x}}]/p)_p}({\\mathbb{c}}[\\underline{x}]/{\\textrm{in}}_u i)_p\\;;\\ ] ] @xmath248}/{q})_q } ( { \\mathbb{c}}[\\underline{y}]/{\\textrm{in}}_v j)_q\\ ; ; \\ ; m_{\\sigma\\times \\tau } = \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! \\sum_{\\substack{p\\in { \\textrm{ass}}({\\textrm{in}}_u(i))\\\\      q\\in { \\textrm{ass}}({\\textrm{in}}_v(j))\\\\p , q \\textrm { minimal}}}\\!\\ ! \\!\\!\\!\\!\\!\\!\\!\\!\\ !",
    "\\dim_{(\\frac{{\\mathbb{c}}[{\\underline{x}},{\\underline{y}}]}{p+q})_{p+q}}\\!\\!\\big(\\frac{{\\mathbb{c}}[{\\underline{x}},{\\underline{y}}]}{{\\textrm{in}}_u    i + { \\textrm{in}}_v j}\\big)_{p+q}.\\ ] ] the statement @xmath249 follows from the distributive law and lemma  [ lm : prodlenght ] .    [ lm : prodlenght ] let @xmath250 $ ] , @xmath251 $ ] be ideals and let @xmath252 $ ] , @xmath253 $ ] be minimal primes containing @xmath54 and @xmath210 respectively .",
    "then @xmath254/{p+q})_{p+q}}\\left(\\frac{{\\mathbb{c}}[{\\underline{x}},{\\underline{y}}]}{i + j}\\right)_{p+q}= \\dim_{({\\mathbb{c}}[{\\underline{x}}]/{p})_{p}}({\\mathbb{c}}[{\\underline{x}}]/i)_p \\cdot\\dim_{({\\mathbb{c}}[{\\underline{y}}]/{q})_{q}}({\\mathbb{c}}[{\\underline{y}}]/j)_q.\\ ] ]    consider the residue fields @xmath255/p)_p$ ] , @xmath256/q)_q$ ] , and @xmath257/(p+q))_{p+q}$ ] . note that @xmath258 via the natural inclusion given by the multiplication map , since @xmath223 is algebraically closed .",
    "likewise , one can easily show that @xmath259/i\\otimes_{{\\mathbb{c } } }    { \\mathbb{c}}[{\\underline{y}}]/j\\cong { \\mathbb{c}}[{\\underline{x}},{\\underline{y}}]/(i+j)$ ] via the multiplication map .",
    "we wish to find a similar result for the localization of these quotients at the corresponding minimal primes .    for simplicity ,",
    "call @xmath260/i)_p\\cong f^s$ ] and @xmath261/j)_q\\cong g^r$ ] the corresponding finite dimensional vector spaces .",
    "our goal is to prove that @xmath262 is a free @xmath131-vector space of rank @xmath263 . from the canonical isomorphisms @xmath259_p\\otimes_{{\\mathbb{c}}[{\\underline{x } } ] } { \\mathbb{c}}[{\\underline{x}}]/i\\cong ( { \\mathbb{c}}[{\\underline{x}}]/i)_p$ ] , @xmath264_q\\otimes_{{\\mathbb{c}}[{\\underline{y } } ] } { \\mathbb{c}}[{\\underline{y}}]/j\\cong ( { \\mathbb{c}}[{\\underline{x}}]/j)_q$ ] , we see that @xmath265/i)_p\\otimes_{\\mathbb{c}}({\\mathbb{c}}[{\\underline{y}}]/j)_q \\cong    { \\mathbb{c}}[{\\underline{x}},{\\underline{y}}]/(i+j)[s^{-1}]$ ] , where @xmath266\\smallsetminus    p)({\\mathbb{c}}[{\\underline{y}}]\\smallsetminus q)$ ] is the multiplicatively closed set consisting of products of polynomials , each of which is pure in each set of variables , and which do not lie inside the prime ideals @xmath267 or @xmath268 . similarly , @xmath269/(p+q)[s^{-1}]$ ] .",
    "on the other hand , notice that @xmath270 comes with a natural @xmath271-module structure via `` coordinatewise action . ''",
    "hence , @xmath272/(i+j))_{(p+q ) } \\cong   l\\otimes_{(f\\otimes_{\\mathbb{c}}g ) } ( m\\otimes_{\\mathbb{c}}n).\\ ] ] from the last isomorphism we see that to prove our lemma it suffices to show that @xmath262 is a free @xmath271-module of rank @xmath263 .",
    "the original claim will follow after tensoring with @xmath131 .",
    "let @xmath273 , @xmath274 be bases of @xmath275 and @xmath276 respectively .",
    "we claim that @xmath277 is a basis of @xmath262 as an @xmath278-module .",
    "it suffices to check the linear independence .",
    "we proceed in an elementary way , by successively using the linear independence of the different bases of the free modules @xmath279 and @xmath280 .",
    "suppose @xmath281 , with @xmath282 .",
    "write @xmath283 where @xmath284 and @xmath285 are basis elements of the field extensions @xmath286 , @xmath287 respectively .",
    "thus , @xmath288 to prove @xmath289 it suffices to show @xmath290 for all @xmath291 . by a well - know result on tensor algebras ( cf .",
    "* lemma 6.4 ) ) , expression   implies the existence of elements @xmath292 , @xmath293 such that @xmath294 for all @xmath295 and @xmath296 for all @xmath297 . hence , rearranging the sum we conclude that @xmath298 in @xmath276 for all @xmath297 , which implies @xmath299 for all @xmath300 .",
    "this in turn implies @xmath301 for all @xmath302 .    using the condition @xmath303",
    ", we have @xmath304 for all @xmath305",
    ". therefore , @xmath290 for all @xmath291 , as we wanted to show .",
    "[ cor : key ] given @xmath306 two projective irreducible varieties none of which is contained in a proper coordinate hyperplane , we can consider the associated irreducible projective variety @xmath307 .",
    "then as _ sets _ : @xmath308 where the sum on the right - hand side denotes the minkowski sum in @xmath309 .",
    "as one can easily imagine , this set - theoretic result is motivated by ( and is a direct consequence of ) kapranov s theorem  ( * ? ? ?",
    "* theorem 2.2.5 ) ( i.e. , the fundamental theorem of tropical geometry ) and the fact that valuations turn products into sums ( see ( * ? ? ? * theorem 2.3 ) for the precise statement ) .",
    "the novelty of our approach is that under suitable finiteness condition of the monomial map defining hadamard products , we can effectively compute multiplicities of regular points in @xmath310 from multiplicities of @xmath132 and @xmath243 .",
    "it is important to mention that this finiteness condition holds for the example we are studying in this paper .",
    "moreover , we are * not * claiming that @xmath310 inherits a fan structure from @xmath132 and @xmath243 .",
    "in general , it might happen that maximal cones in the minkowski sum get subdivided to give maximal cones in @xmath310 or , moreover , the union of several cones in the minkowski sum gives a maximal cone in @xmath310 .",
    "it may seem surprising at first that the combinatorial structure ( e.g.  @xmath311-vector ) of the newton polytope does not follow easily from the description of the tropical hypersurface as a minkowski sum of two fans .",
    "moreover , the number of edges of the polytope ( and even the number of vertices ) may exceed the number of maximal cones of the tropical hypersurface _ given as a set_. to see this in a small example , consider the tropical curve in @xmath312 whose six rays are columns of the following matrix    @xmath313 and consider the minkowski sum of the fan with itself .",
    "this tropical hypersurface is described as a union of 15 cones ( or as a non - planar graph in @xmath314 with 6 nodes and 15 edges ) , but the dual newton polytope has 16 vertices , 25 edges , and 11 facets . if we intersect the tropical hypersurface with a sphere around the origin , we would see the planar graph in figure  [ fig : tropicalsurfacewithnofanstructure ]",
    ".     described as a collection of 2-dimensional cones in @xmath312 or as a non - planar graph in @xmath314 . ]",
    "the planer regions correspond to the 16 vertices .",
    "the black dots correspond to the columns in the above matrix and the arcs between them correspond to cones generated by them .",
    "the nodes in the graph correspond to the facets in the newton polytope .",
    "six of these facets correspond to the black dots in figure  [ fig : tropicalsurfacewithnofanstructure ] and are the 6 nodes in the non - planar graph description of the tropical hypersurface .",
    "the remaining five facets correspond to the missing intersection points between the edges of the non - planar graph in the picture . adding these 5 nodes to the graph",
    "will give us a planar graph with 11 nodes and 25 edges that encodes the fan structure of the tropical variety and the combinatorics of the newton polytope .",
    "if we had started instead with a tropical curve whose six rays are @xmath315 for @xmath316 , then the dual polytope would be a cube with @xmath311-vector @xmath317 .    due to the lack of a fan structure in our description of @xmath318 , corollary  [ cor : key ] gives no estimate for the number of maximal cones in the tropical variety @xmath319 , where the fan structure is inherited from the grbner fan structure of the defining ideal of @xmath319 .",
    "moreover , this fan structure is infeasible to obtain in general .",
    "hence , in the hypersurface case we have no estimate on the number of edges of the dual polytope to the tropical variety @xmath310 and , as a consequence , no estimate on the number of vertices of the polytope .",
    "as the previous example illustrates , the description of @xmath310 as a collection of weighted cones of maximal dimension contains less combinatorial information than the fan structure does and hence , the computation of the dual polytope becomes more challenging , as we show in section  [ sec : computenp ] .",
    "we now describe the computation of the tropical variety @xmath320 of our model @xmath15 . by our discussions in section  [ sec : themodel ] , we know that the defining ideal of @xmath321 is generated by the @xmath322 minors of the three flattenings of @xmath323 matrix of variables @xmath324 , for a total of 48 generators . since @xmath26 is irreducible , we can use ` gfan `  @xcite to compute the tropical variety @xmath132",
    ".    the ideal @xmath325 of @xmath326 $ ] is invariant under the action of @xmath20 , and ` gfan ` can exploit the symmetry of a variety determined by an action of a subgroup of the symmetric group @xmath327 . for this , we need to provide a set of generators as part of the input data .",
    "the output groups cones together according to their orbits .",
    "the tropical variety @xmath328 has a lineality space spanned by the rows of the following integer matrix : @xmath329 where the columns correspond to variables @xmath37 , for @xmath330 , ordered lexicographically .",
    "as we explained already in this section , we can identify this linear space with the maximal torus acting on the variety @xmath26 and hence on @xmath331 .",
    "a set of generators of the corresponding lattice giving this action can be read - off from the parameterization .",
    "more precisely , consider the morphism of tori @xmath332 sending @xmath333 , where each @xmath334 is of the form @xmath335 , where @xmath336 runs over all sixteen vertices of the 4-cube .",
    "then , one can check that the closure of the image of @xmath337 in @xmath17 is the affine cone over the segre embedding @xmath338 .",
    "more precisely , given a generic point in the image of @xmath337 , we have @xmath339 , where @xmath340 and @xmath341 .",
    "the gfan computation confirms that the tropical variety @xmath132 inside @xmath342 is a @xmath343-dimensional polyhedral fan with a @xmath344-dimensional lineality space .",
    "after moding out by the lineality space , the @xmath311-vector is : @xmath345 regarding the orbit structure , there are 13 rays and 49 maximal cones in @xmath132 up to symmetry and all maximal cones have multiplicity 1 .    according to corollary  [ cor : key ] ,",
    "the tropical variety of the model is ( as a set ) @xmath346 since we know that this will result in a pure polyhedral fan , we only need to compute all minkowski sums between pairs of cones of _ maximal _ dimension . for this step",
    "we use the @xmath20 group action .",
    "there is a natural ( coordinatewise ) action of @xmath347 on @xmath348 that translates to a @xmath20-action on @xmath349 .",
    "therefore , to compute the minkowski sum of maximal cones , we first consider @xmath3507680@xmath351 376320 pairs @xmath352 , where @xmath353 is taken from a set of representatives of the @xmath354 orbits of maximal cones , and @xmath355 is taken from the set of all maximal cones . we discard the pairs @xmath352 for which @xmath356 is not of maximal dimension 15 . after this reduction ,",
    "the total number of maximal cones computed is 92469 . by construction",
    ", this list of 92469 cones contains all representatives of the orbits of maximal cones in @xmath357 .",
    "but they do not form distinct orbits .",
    "some cones appear twice in the list as @xmath358 and @xmath359 , and this the only possibility except for 4512 cones which arise from two different pairs , plus their flips .",
    "that is , @xmath360 where both pairs differ only by an interchange of a _ single _ pair of extremal rays @xmath361 : i.e. @xmath362 and @xmath363 .",
    "some cones @xmath245 have non - trivial stabilizers in @xmath20 , so there are cones @xmath364 and @xmath365 in the same orbit .",
    "the dimension of the maximal cones in @xmath320 confirms that @xmath15 is a hypersurface .",
    "the total number of orbits of maximal cones is 18972 , and each orbit has size 96 , 192 , or 384 .",
    "we then let the group @xmath20 act on each orbit and obtain 6865824 cones of dimension 15 , the union of which is the tropical variety @xmath320 , as predicted by corollary  [ cor : key ] .",
    "we do not have a fan structure of @xmath320 .",
    "nonetheless , we can compute the multiplicity of @xmath320 at any regular point using theorem [ thm : stgeneralized ] because our matrix @xmath75 is of the form @xmath366 . after taking quotients by the respective maximal torus acting on each space , the map @xmath367",
    ", is generically finite of degree two . in practice ,",
    "the lattice indices in   are computed via greatest common divisors ( gcd ) of maximal minors of integer matrices whose rows span the cones in @xmath132 and @xmath368 .",
    "more precisely ,    [ lm : indexcalculation ] given a lattice @xmath369 , and an integer matrix @xmath370 with @xmath371 , the lattice index @xmath372 can be computed as follows .",
    "pick @xmath373 a minimal system of generators of @xmath374 over @xmath101 , and let @xmath375 .",
    "then , the index equals the quotient of the gcd of the maximal minors of the matrix @xmath376 by the gcd of the maximal minors of the matrix @xmath377 .",
    "since @xmath378 , the @xmath379 equals the product@xmath380 by construction @xmath381 is the gcd of the maximal minors of the matrix @xmath382 . to prove the result , it suffices to show that @xmath383 equals the gcd of the maximal minors of the matrix @xmath377 in the statement .    since @xmath371",
    ", this implies that @xmath384 . then : @xmath385 , which equals the gcd of the maximal minors of the matrix @xmath377 , as we wanted to show .    in our case ,",
    "@xmath377 is spanned by twenty integer vectors ( five from each cone @xmath386 plus the lattices @xmath387 coming from the lineality space .",
    "call @xmath388 and @xmath389 each list of five vectors of @xmath245 and @xmath246 . then",
    ", the matrix @xmath377 in the previous lemma equals the block diagonal matrix @xmath390diag@xmath391 , where @xmath392 , @xmath393 and @xmath394 .",
    "thus , the index equal the quotient of @xmath395-minors of @xmath396 by the product @xmath397-minors of @xmath398-minors of @xmath399 .",
    "each gcd calculation is done via the hermite ( alt .",
    "smith ) normal form of these matrices @xcite .",
    "after computing all multiplicities we obtain only values one or two .",
    "in this section , we focus our attention on the _ inverse problem_. that is , given the tropical fan of an irreducible hypersurface , we wish to computing the _ newton polytope _ of the defining equation @xmath400 of the hypersurface , i.e.  the convex hull of all vectors @xmath401 such that @xmath402 appears with a nonzero coefficient in @xmath311 .",
    "we will first present the results of our computation before discussing algorithms and implementation in the following subsections .",
    "here is the ultimate result :    [ thm : polytope ] the newton polytope of the defining equation of @xmath15 has 17214912 vertices in 44938 orbits and 70646 facets in 246 orbits under the symmetry group @xmath20 .    among the 44938 orbits of vertices , 215 have size 192 and 44723 has size 384 .",
    "the maximum coordinate of a vertex ranges between 14 and 20 , and the minimum coordinate is either 0 or 1 .",
    "all but 46 orbits have a zero - coordinate .",
    "a vertex can have up to seven zero - coordinates .",
    "each vertex is contained in 11 to 62 facets .",
    "there are 11800 symmetry classes of _ simple _ vertices , that is , those contained in exactly 11 facets .",
    "the following is a representative of the the unique symmetry class of vertices contained in 62 facets each , which has size 192 : @xmath403    we index the coordinates of @xmath404 by @xmath405 and order them lexicographically . since our polynomial is ( multi)-homogeneous , knowing even a single point in the newton polytope gives the multidegree .",
    "we now describe the multidegree of the hypersurface @xmath15 :    [ thm : main ] the hypersurface @xmath15 has multidegree @xmath406 with respect to the grading defined by the matrix in .",
    "now let us look at the 246 orbits of facets .",
    "the following table lists the orbit sizes :    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^ \" , ]     the coordinates @xmath407 are naturally indexed by bit strings @xmath408 .",
    "the two facet inequalities in the size-2 orbit say that the sum of @xmath409 such that @xmath410 is even ( or odd ) is at least 32 .",
    "each facet contains between 210 and 3907356 vertices . the unique symmetry class of facets containing the most vertices consist of coordinate hyperplanes .",
    "using algorithm  [ alg : certifyfacets ] , we certified that out of the 13 orbits of rays of the 9-dimensional tropical variety of the segre embedding @xmath411 , only the following eight are facet directions of @xmath320 :    .... ( 1 , 0 , 0 , 1 , 0 , 1 , 1 , 2 , 2 , 1 , 1 , 0 , 1 , 0 , 0 , 1 ) ( 1 , 3 , 3 , 1 , 3 , 1 , 1 , 3 , 1 , 3 , 3 , 1 , 3 , 1 , 1 , 3 ) ( 2 , 1 , 1 , 0 , 1 , 0 , 0 , 0 , 2 , 1 , 1 , 0 , 1 , 0 , 0 , 0 ) ( 2 , 1 , 1 , 2 , 1 , 2 , 2 , 1 , 1 , 2 , 2 , 1 , 2 , 1 , 1 , 2 ) ( 3 , 2 , 2 , 1 , 2 , 1 , 1 , 0 , 2 , 1 , 1 , 0 , 1 , 0 , 0 , 0 ) ( 3 , 3 , 3 , 3 , 3 , 3 , 3 , 3 , 1 , 3 , 3 , 1 , 3 , 1 , 1 , 3 ) ( -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ) ( -1 , -1 , -1 , -1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , -1 , -1 , -1 , -1 ) . ....    a complete list of vertices and facets , together with the scripts used for computation , are available at    http://people.math.gatech.edu/~jyu67/impchallenge/      we now discuss how we obtained the newton polytope .",
    "we will first explain the connection between @xmath412 and @xmath413 . from the tropicalization @xmath320 of the hypersurface @xmath414",
    "we want to compute the extreme monomials of @xmath311 . for a vector @xmath415 ,",
    "the initial form @xmath57 is a monomial if and only if @xmath68 is in the interior of a maximal cone ( chamber ) of the normal fan of @xmath413 .",
    "the tropical variety of the hypersurface @xmath15 is the union of codimension one cones of the normal fan of @xmath413 .",
    "the multiplicity of a maximal cone in @xmath320 is the lattice length of the edge of @xmath413 normal to that cone .",
    "a construction for the vertices of the newton polytope @xmath413 from its normal fan @xmath412 equipped with multiplicities was developed in @xcite ( see also @xcite for several numerical examples ) .",
    "the following is a special case of ( * ? ? ?",
    "* theorem 2.2 ) .",
    "since the operation @xmath416 interprets @xmath311 as a laurent polynomial , @xmath413 will be determined from @xmath412 up to translation .",
    "the algorithm described in theorem  [ thm : rayshoot ] computes a representative of @xmath413 which lies in the positive orthant and touches all coordinate hyperplanes , i.e.  @xmath311 is a polynomial not divisible by any non - constant monomial .",
    "we describe the pseudocode in algorithm  [ alg : ray ] .",
    "[ thm : rayshoot ] suppose @xmath417 is a generic vector so that the ray @xmath418 intersects @xmath412 only at regular points of @xmath412 , for all @xmath419 .",
    "let @xmath420 be the vertex of the polytope @xmath421 that attains the maximum of @xmath422 .",
    "then the @xmath423 coordinate of @xmath420 equals @xmath424 where the sum is taken over all points @xmath425 , @xmath426 is the multiplicity of @xmath87 in @xmath412 , and @xmath427 is the @xmath423 coordinate of the primitive integral normal vector @xmath428 to the maximal cone in @xmath412 containing @xmath87 .",
    "note that we do not need a fan structure on @xmath412 to use theorem  [ thm : rayshoot ] .",
    "a description of @xmath412 as a set , together with a way to compute the multiplicities at regular points , gives us enough information to compute vertices of @xmath413 in any generic direction .",
    "in section  [ sec : tropicalland ] we computed @xmath412 as a union of 6865824 cones . for each of those cones , we calculated the lattice index in theorem  [ thm : stgeneralized ] and the primitive vector which is the direction of the edge of @xmath413 normal to the cone .",
    "there are 15788 distinct edge directions in @xmath413 .",
    "we then pick a random vector @xmath415 and go through the list of 6865824 cones , recording the cones that meet any of the rays @xmath429 . for each @xmath419",
    ", we sum the numbers latexmath:[$m_v \\cdot    the @xmath423 coordinate of the vertex .",
    "the objective vector @xmath68 does not lie in any cone in @xmath431 , i.e.  the face @xmath432 is a vertex . for",
    "each @xmath433 the ray @xmath434 does not meet the boundary of any cone in @xmath431 .",
    "+ @xmath435 + @xmath432 .",
    "we shoot and walk from chamber to chamber . ]    to obtain the multidegree , we only need one vertex .",
    "we computed the first vertex using ` macaulay 2 ` @xcite in a few days .",
    "our ultimate goal was to compute the newton polytope @xmath413 , a much more difficult computational problem that took us many more months to complete .",
    "as a first attempt , we bound the number of lattice points in the polytope by the number of nonnegative lattice points of the given multidegree . using the software latte @xcite , we found that the number of monomials in 16 variables with multidegree @xmath406 is _",
    "5529528561944_.    by construction , it is clear that the bottleneck of algorithm  [ alg : ray ] is in going through the list @xmath431 of 6865824 cones .",
    "we can modify the algorithm to produce more than one vertex for each pass through the list .",
    "we do this in two ways .",
    "one is to process multiple objective vectors at once and save time by reducing the number of file readings and reusing the linear algebra computations for checking whether a cone meets a ray or not .",
    "another way to produce more vertices is to keep track of the cones that we meet while ray - shooting , and use them to walk from chamber to chamber in the normal fan of @xmath413 .",
    "this is described in algorithm  [ alg : walk ] .    .",
    "in dash lines , we plot the tropical variety .",
    "the picture represents the local structure around @xmath436 . ]    on the polytope @xmath437 , this means walking from vertex @xmath438 to @xmath439 for scalars @xmath440 corresponding to points between three consecutive intersection points , along an edge whose @xmath419-th coordinate is negative .",
    "if the vector @xmath68 is generic , then we can assume that @xmath441 and @xmath442 are parallel whenever they share an intersection point obtained by shooting from @xmath68 in a fixed coordinate direction .",
    "so we can use any of the cones in a parallel class to compute the edge direction of the wall we walk across . by adding up the multiplicities of the cones in each class",
    ", we get the lattice length of the edge of @xmath437 .",
    "this allows us to compute the coordinates of the vertices dual to the chambers we walk into .",
    "for each of these vertices found by walking from a known vertex , we also get an objective vector in the process .",
    "for example , any vector of the form @xmath443 , where @xmath444 , is an objective vector for the @xmath445-th vertex found in the walk in direction @xmath446 . we take @xmath447 as @xmath448 . for numerical stability",
    ", we use exact arithmetic over the rational numbers .",
    "in particular , we always choose the new objective vectors to be integral .    using a new vertex , with its associated objective vector ,",
    "we can repeat the ray - shooting ( algorithm [ alg : ray ] ) and walking ( algorithm [ alg : walk ] ) again .",
    "the picture one should have in mind is that walking from chamber to chamber in the tropical side corresponds to walks from vertex to vertex in @xmath413 along edges normal to the codimension one cones traversed in the tropical hypersurface .",
    "the combination of algorithms 1 and 2 is illustrated in figures  [ fig : walkandshoot ] and  [ fig : walknp ] .",
    "starting from chamber @xmath449 and an objective vector @xmath450 , we shoot rays in minus the coordinate axes directions .",
    "the intersection points are indicated by their defining parameters @xmath451 ( note that superscripts are omitted in the notation of algorithm[alg : walk ] ) . as we explain below , to speed up the computation of algorithm  [ alg : ray ] we first precompute the inverses of all suitable matrices of the form @xmath452 where @xmath453 are generators of the cone @xmath245 and @xmath454 span the lineality space in  . using this",
    ", the condition @xmath455 translates to the first eleven coordinates of the solution @xmath26 of @xmath456 being positive .",
    "thus , we can easily use the same systems to test @xmath457 , just changing the sign condition for the first coordinate of @xmath26 .",
    "this small modification allows us to walk in sixteen new directions ( the positive coordinate axes ) , and find new adjacent vertices to vertex @xmath436 starting form objective vector @xmath450 .",
    "the step updating @xmath87 in algorithm  [ alg : walk ] should be @xmath458 instead of @xmath459 .    in figure  [",
    "fig : walkandshoot ] , the parameters @xmath460 associated to the intersection points in these positive directions are denoted by @xmath461 .",
    "the dashed arrows indicate the shooting directions .",
    "the points in the cones correspond to intersection points , whereas the points inside chambers are the objective vectors obtained for each vertice as described in algorithm  [ alg : walk ] .",
    "the dual walk in the newton polytope is depicted in figure  [ fig : walknp ] .",
    "we start walking from vertex @xmath436 and via shooting we obtain the adjacent vertices @xmath462 and @xmath463 .",
    "notice that by this procedure we miss vertices @xmath464 and @xmath465 .",
    "however , we do get them if we start shooting from known adjacent chambers to @xmath449 .",
    "for example , @xmath466 can be computed if we shoot rays from chamber @xmath467 , followed by a shoot from chamber @xmath468 .",
    "observe that this depends heavily on the choice of the objective vector @xmath469 .",
    "a few notes about the implementation of our algorithms are in order . as we started working on the problem , we used ` macaulay 2 ` @xcite to do the ray - shooting ( algorithm [ alg : ray ] ) .",
    "this script was fine for our first experiments , but it took three days to generate a single vertex of the polytope .",
    "it soon became evident that something faster was needed if we wanted to compute the entire polytope .",
    "our first step was to translate the ` macaulay 2 ` script for algorithm  [ alg : ray ] into python  @xcite .",
    "we chose that language because of its fast speed of development and availability of arbitrary precision integers , which were needed by our program .",
    "we always scale our objects ( matrices and vectors ) by positive integers so that our objects have integer coefficients .",
    "this step is crucial for numerical stability .",
    "this new implementation brought the running time to about 10 hours .",
    "this was a remarkable improvement , but as the number of vertices of the polytope grew , we realized that something even faster was required .",
    "therefore , we decided to resort to caching : instead of computing every inverse for each vector , we precomputed all the inverses and stored them using a binary format suitable for fast reading in python ( pickles ) .",
    "this resulted in a file of a few tens of gigabytes , but dropped the time required for an individual ray - shooting procedure down to under three hours .",
    "once the python prototype was working at a reasonable speed , we translated it into c++  @xcite , which brought the time required to do ray - shooting for a single vertex to 47 minutes on modest hardware .",
    "moreover , ray - shooting for multiple objective vectors could be performed at the same time , thus amortizing the disk reads .",
    "since we still needed large integers , we decided to use gmp  @xcite and its c++ interface .",
    "the procedure for walking is a more or less straightforward translation of the pseudocode presented in algorithm  [ alg : walk ] .",
    "it is still implemented in python , because it takes a short amount of time to walk from a few hundred vertices at a time , and the simplicity of the script far outweights the time gains a c++ translation would provide .",
    "we now discuss how to certify certain inequalities as facets of a polytope @xmath437 given by the dual tropical hypersurface @xmath412 . by the duality between tropical hypersurfaces and newton polytopes",
    ", each facet direction must be a ray in the tropical variety , equipped with the fan structure dual to @xmath437 .",
    "lemma  [ lm : raytest ] provides a characterization for a vector in @xmath65 to be a ray of @xmath412 with the inherited fan structure .",
    "[ lm : raytest ] let @xmath417 and @xmath412 be a tropical hypersurface given by a collection of cones , but with no prescribed fan structure .",
    "let @xmath470 be the dimension of its lineality space .",
    "let @xmath471 be the list of cones containing @xmath68 .",
    "let @xmath472 be the normal vector to cone @xmath473 for @xmath474 .",
    "then , @xmath68 is a ray of @xmath412 if and only if @xmath475 generates a @xmath476-dimensional vector space if and only if @xmath68 is a facet direction of @xmath413 .",
    "the vectors @xmath477 are precisely the directions of edges in the face @xmath420 of @xmath478 .",
    "since the lineality space of @xmath412 has dimension @xmath470 , the polytope @xmath437 has dimension @xmath479 .",
    "the face @xmath420 is a facet of @xmath437 if and only if @xmath480 span a @xmath476-dimensional vector space .    for any objective vector @xmath417",
    ", we can compute a vertex in the face @xmath420 by applying ray - shooting ( algorithm [ alg : ray ] ) to a generic objective vector @xmath185 in a chamber of the normal fan of @xmath437 containing @xmath68 . if we know that @xmath68 is in fact a facet direction of @xmath437 , then any vertex in @xmath420 gives us the constant term @xmath481 in the facet inequality @xmath482 .",
    "this is used in algorithm  [ alg : certifyfacets ] for checking if a given inequality is a facet inequality of @xmath437 .",
    "this step will be essential to certify that our partial list of vertices is indeed the complete list of vertices of the polytope @xmath437 .",
    "we discuss this approach in section  [ sec : completing - polytope ] .",
    "@xmath483 +    we now explain how to obtain a vector in the interior of a chamber containing a facet direction @xmath68 .",
    "we start by applying a modified version of algorithm  [ alg : ray ] with input vector @xmath68 and when we choose to shoot rays only in direction @xmath484 .",
    "since @xmath68 is a ray of the tropical variety given by the collection @xmath485 , it belongs to some cones @xmath486 in @xmath485 .",
    "let @xmath487 be the cones we intersect along the @xmath484 direction ( we allow intersections at boundary points of each cone ) .",
    "note that we only pick those cones with @xmath488 .",
    "now , we use algorithm  [ alg : walk ] with input vector @xmath68 and the set @xmath489 corresponding to the cones @xmath490 and coordinate @xmath34 .",
    "we assume @xmath491 are ordered in increasing order , with all @xmath492 .",
    "we have two possible scenarios : either @xmath489 is a subset of @xmath493 ( that is , either the empty set or the set @xmath493 ) or it contains a positive real number . in the first case , we pick an objective vector @xmath494 for a positive number @xmath297 ( for numerical stability , we choose @xmath297 to be a big rational number ) . in the second case ,",
    "pick a number @xmath297 between zero and the first positive number @xmath495 from @xmath489 and let @xmath496 .",
    "third , we check if any cone in @xmath485 contains @xmath497 or not . if not",
    ", then we let @xmath498 .",
    "if yes , by the balancing condition , this means that there exists a maximal cone in the tropical variety containing both @xmath497 and @xmath68 . note that this cone may be obtained by gluing and/or subdividing some cones in @xmath485 . in this case",
    "then we proceed as above , replacing the original input vector @xmath68 by @xmath497 and shooting rays using coordinate @xmath499 instead of coordinate @xmath34 .",
    "we repeat this process with all coordinates if necessary .",
    "unless we have @xmath500 not contained in any cone of @xmath485 , at step @xmath419 we are guaranted to have a cone containing @xmath501 by construction . by dimensionality argument , at most in sixteen steps , we obtain a vector @xmath500 not contained in any cone of @xmath485 .",
    "this vector will be the objective vector @xmath185 from algorithm  [ alg : certifyfacets ] .",
    "once the ratio of new vertices computed with ray - shooting and walking decreases , the next natural question that arises is how to guarantee that we have found all vertices of our polytope . to answer this question , we construct the tangent cones at each vertex and try to certify their facets as facets of @xmath437 .",
    "let @xmath437 be a full - dimensional polytope in @xmath502 and @xmath87 a vertex of @xmath437 .",
    "we define the _ tangent cone of @xmath437 at @xmath87 _ to be the set : @xmath503    by construction , @xmath504 is a polyhedron with only one vertex and @xmath505 . in particular",
    ", an inequality defines a facet of @xmath437 if and only if it defines a facet of one of the tangent cones .",
    "let @xmath506 be the convex hull of the vertices of @xmath507 obtained via algorithms  [ alg : ray ] and  [ alg : walk ] .",
    "our goal is to certify that @xmath508 .",
    "we proceed as follows . for each vertex @xmath87 of @xmath509",
    "we wish to compare the tangent cones @xmath510 and @xmath511 .",
    "since @xmath509 has over seventeen million vertices and @xmath512 has no symmetry , straightforward convex hull computations are infeasible .",
    "if @xmath513 then the extreme rays of @xmath512 would be edge directions of @xmath437 , which we have already computed as the normal directions to the maximal cones of the tropical hypersurface , and which are 15788 in total .",
    "for a fixed vertex @xmath514 we compute all differences @xmath515 for all vertices @xmath68 of @xmath509 and test which of these vectors are parallel to edges of @xmath437 .",
    "the number of such edge directions in @xmath512 is expected to be very small ( usually under 30 in practice ) .",
    "let @xmath516 be the convex hull of @xmath87 and all rays along the edge directions of @xmath437 in @xmath517 .",
    "so we have @xmath518 and we can test if @xmath519 by computing facets of @xmath516 with ` polymake `  @xcite .",
    "if @xmath519 , we use algorithm [ alg : certifyfacets ] to check whether each facet of @xmath516 is also a facet of @xmath437 . in this way , we can certify that @xmath520 , hence @xmath521 .",
    "certifying this for a vertex @xmath87 of @xmath509 in each symmetry class will give us @xmath522 , hence @xmath523 .",
    "we conclude :    [ lm : certificatecompletepolytope ] let @xmath437 be a polytope and @xmath524 be the convex hull of a subset of the vertices in @xmath437 .",
    "if all facets of @xmath509 are facets of @xmath437 , then @xmath525 , so @xmath526 .",
    "if we find that a facet @xmath527 of @xmath516 is not a facet of @xmath437 from algorithm [ alg : certifyfacets ] , then we are missing vertices adjacent to @xmath87 in @xmath437 in this `` false facet direction '' @xmath68 , so we can perturb @xmath68 so that it lies in a chamber of the normal fan of @xmath437 and use ray - shooting ( algorithm [ alg : ray ] ) to find a new vertex in that direction . using this method , we obtained the entire polytope in finite number steps .",
    "we describe the process of approximating @xmath437 by a subpolytope @xmath509 in algorithm  [ alg : approximatep ] .",
    "a schematic of complete tangent cones and incomplete tangent cones is depicted in figure  [ fig : approximatepolytope ] .",
    "@xmath528 ; +     and we build a polytope @xmath529 .",
    "we certify if facets of @xmath506 are also facets of @xmath507 by algorithm  [ alg : certifyfacets ] . in the picture , we certify all facet directions in @xmath512 containing vertex @xmath87 but we can not certify the facet direction @xmath68 of the tangent cone @xmath530 .",
    "in addition , although we can certify the facet direction @xmath185 of @xmath506 as a true facet direction of @xmath507 , we will not be able to certify the constant corresponding to this facet direction of @xmath507 since we are missing all its supporting vertices .",
    "the true constant will be obtained using algorithm  [ alg : certifyfacets ] . ]    in the final stages of the computation , if we find that @xmath516 is a strict subcone of the tangent cone @xmath531 , we enumerated the rays @xmath515 ( with @xmath532 ) that lie in the difference @xmath533 . if the number of such rays is small ( no more than a few hundreds ) , we replace @xmath516 with the convex hull of @xmath516 and those rays ( computed using ` polymake ` ) and proceed as in algorithm  [ alg : approximatep ] . by executing algorithm  [ alg : approximatep ] in this way",
    ", we were able to compute and certify all vertices and facets of the polytope .",
    "we wish to acknowledge bernd sturmfels for suggesting this problem .",
    "we thank dustin cartwright , daniel erman and anders jensen for inspiring discussions and our two anonymous referees for helping us improve the exposition .",
    "we also thank the _ mathematical sciences research institute _ ( msri ) for providing a wonderful working environment for this project , and the computing staff at msri and georgia tech school of math for their fantastic support .",
    "finally we acknowledge the computers at msri , georgia tech , and the university of buenos aires for their hard work .",
    "mara  anglica cueto , jason morton , and bernd sturmfels .",
    "geometry of the restricted boltzmann machine . in m.",
    "viana and h.  wynn , editors , _ algebraic methods in statistics and probability _ , contemporary mathematics .",
    "american mathematical society , 2010 . to appear , e - print : arxiv:0908.4425 .",
    "nicholas eriksson , kristian ranestad , bernd sturmfels , and seth sullivant .",
    "phylogenetic algebraic geometry . in _ projective varieties with unexpected properties _ ,",
    "pages 237255 .",
    "walter de gruyter gmbh & co. kg , berlin , 2005 .",
    "ewgenij gawrilow and michael joswig .",
    "olymake : a framework for analyzing convex polytopes . in gil kalai and gnter  m. ziegler , editors , _ polytopes",
    " combinatorics and computation _ , pages 4374 .",
    "birkhuser , 2000 .",
    "jrgen richter - gebert , bernd sturmfels , and thorsten theobald .",
    "first steps in tropical geometry . in _",
    "idempotent mathematics and mathematical physics _ , volume 377 of _ contemp .",
    "_ , pages 289317 .",
    "soc . , providence , ri , 2005 .",
    "bernd sturmfels and josephine yu . tropical implicitization and mixed fiber polytopes . in _",
    "software for algebraic geometry _ ,",
    "volume 148 of _ i m a vol .",
    "_ , pages 111131 .",
    "springer , new york , 2008 ."
  ],
  "abstract_text": [
    "<S> we use tropical geometry to compute the multidegree and newton polytope of the hypersurface of a statistical model with two hidden and four observed binary random variables , solving an open question stated by drton , sturmfels and sullivant in ( * ? ? ? </S>",
    "<S> * problem 7.7 ) . </S>",
    "<S> the model is obtained from the undirected graphical model of the complete bipartite graph @xmath0 by marginalizing two of the six binary random variables . </S>",
    "<S> we present algorithms for computing the newton polytope of its defining equation by parallel walks along the polytope and its normal fan . in this way we compute vertices of the polytope . </S>",
    "<S> finally , we also compute and certify its facets by studying tangent cones of the polytope at the symmetry classes vertices . </S>",
    "<S> the newton polytope has _ </S>",
    "<S> 17214912 _ vertices in _ 44938 _ symmetry classes and _ 70646 _ facets in _ 246 _ symmetry classes . </S>"
  ]
}