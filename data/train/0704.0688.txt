{
  "article_text": [
    "rotor - router walk is a deterministic analogue of random walk , first studied by priezzhev et al .",
    "@xcite under the name `` eulerian walkers . '' at each site in the integer lattice @xmath9 is a _ rotor _ pointing north , south , east or west .",
    "a particle starts at the origin ; during each time step , the rotor at the particle s current location is rotated clockwise by @xmath10 degrees , and the particle takes a step in the direction of the newly rotated rotor . in rotor - router aggregation , introduced by jim propp , we start with @xmath11 particles at the origin ; each particle in turn performs rotor - router walk until it reaches a site not occupied by any other particles .",
    "let @xmath12 denote the resulting region of @xmath11 occupied sites .",
    "for example , if all rotors initially point north , the sequence will begin @xmath13 , @xmath14 , @xmath15 .",
    "the region @xmath16 is pictured in figure  1 . in higher dimensions ,",
    "the model can be defined analogously by repeatedly cycling the rotors through an ordering of the @xmath17 cardinal directions in @xmath18 .    .",
    "each site is colored according to the direction of its rotor . ]",
    "jim propp observed from simulations in two dimensions that the regions @xmath12 are extraordinarily close to circular , and asked why this was so @xcite . despite the impressive empirical evidence for circularity , the best result known until now",
    "@xcite says only that if @xmath12 is rescaled to have unit volume , the volume of the symmetric difference of @xmath12 with a ball of unit volume tends to zero as a power of @xmath11 , as @xmath19 .",
    "the main outline of the argument is summarized in @xcite .",
    "fey and redig @xcite also show that @xmath12 contains a diamond .",
    "in particular , these results do not rule out the possibility of `` holes '' in @xmath12 far from the boundary or of long tendrils extending far beyond the boundary of the ball , provided the volume of these features is negligible compared to @xmath11 .    our main result is the following , which rules out the possibility of holes far from the boundary or of long tendrils in the rotor - router shape",
    ". for @xmath20 let @xmath21    [ rotorcirc ] let @xmath12 be the region formed by rotor - router aggregation in @xmath18 starting from @xmath11 particles at the origin and any initial rotor state .",
    "there exist constants @xmath22 depending only on @xmath23 , such that @xmath24 where @xmath25 , and @xmath1 is the volume of the unit ball in @xmath2 .",
    "we remark that the same result holds when the rotors evolve according to stacks of bounded discrepancy ; see the remark following lemma  [ odomflow ] .    internal diffusion limited aggregation",
    "( `` internal dla '' ) is an analogous growth model defined using random walks instead of rotor - router walks .",
    "starting with @xmath11 particles at the origin , each particle in turn performs simple random walk until it reaches an unoccupied site .",
    "lawler , bramson and griffeath @xcite showed that for internal dla in @xmath18 , the occupied region @xmath12 , rescaled by a factor of @xmath26 , converges with probability one to a euclidean ball in @xmath2 as @xmath27 .",
    "lawler @xcite estimated the rate of convergence . by way of comparison with theorem  [ rotorcirc ] , if @xmath28 is the internal dla region formed from @xmath11 particles started at the origin , the best known bounds @xcite are ( up to logarithmic factors ) @xmath29 for all sufficiently large @xmath11 , with probability one .",
    "we also study another model which is slightly more difficult to define , but much easier to analyze . in the _",
    "divisible sandpile _ , each site @xmath30 starts with a quantity of `` mass '' @xmath31 . a site _",
    "topples _ by keeping up to mass  @xmath32 for itself , and distributing the excess ( if any ) equally among its neighbors .",
    "thus if @xmath33 has mass @xmath34 , then each of the @xmath17 neighboring sites gains mass @xmath35 when we topple @xmath33 , and @xmath33 is left with mass @xmath32 ; if @xmath36 , then no mass moves when we topple @xmath33 .",
    "note that individual topplings do not commute ; however , the divisible sandpile is `` abelian '' in the following sense .",
    "[ divsandpileabelianproperty ] let @xmath37 be a sequence with the property that for any @xmath30 there are infinitely many terms @xmath38 .",
    "let @xmath39 then @xmath40 and @xmath41 .",
    "moreover , the limits @xmath42 and @xmath43 are independent of the sequence @xmath44 .    .",
    "colors represent the number of grains at each site . ]",
    "the abelian property can be generalized as follows : after performing some topplings , we can add some additional mass and then continue toppling .",
    "the resulting limits @xmath42 and @xmath43 will be the same as in the case when all mass was initially present . for a further generalization , see @xcite .",
    "the limiting function @xmath42 in proposition  [ divsandpileabelianproperty ] is the _",
    "odometer function _ for the divisible sandpile .",
    "this function plays a central role in our analysis .",
    "the limit @xmath43 represents the final mass distribution .",
    "sites @xmath30 with @xmath45 are called _ fully occupied_. proposition  [ divsandpileabelianproperty ] is proved in section  3 , along with the following .    [ divsandcircintro ] for @xmath46 let @xmath47 be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass @xmath48 at the origin .",
    "there exist constants @xmath22 depending only on @xmath23 , such that @xmath49 where @xmath50 and @xmath1 is the volume of the unit ball in @xmath2 .",
    "the divisible sandpile is similar to the `` oil game '' studied by van den heuvel @xcite . in the terminology of @xcite",
    ", it also corresponds to the @xmath51 limit of the classical abelian sandpile ( defined below ) , that is , the abelian sandpile started from the initial condition in which every site has a very deep `` hole . ''    in the classical abelian sandpile model @xcite , each site in @xmath18 has an integer number of grains of sand ; if a site has at least @xmath17 grains , it _",
    "topples _ , sending one grain to each neighbor .",
    "if @xmath11 grains of sand are started at the origin in @xmath18 , write @xmath52 for the set of sites that are visited during the toppling process ; in particular , although a site may be empty in the final state , we include it in @xmath52 if it was occupied at any time during the evolution to the final state .    .",
    "the inner diamond and outer square are due to le borgne and rossin @xcite ; the inner and outer circles are those in theorem  [ sandpilecircintro ] . ]    until now the best known constraints on the shape of @xmath52 in two dimensions were due to le borgne and rossin @xcite , who proved that @xmath53 fey and redig  @xcite proved analogous bounds in higher dimensions , and extended these bounds to arbitrary values of the height parameter @xmath54 .",
    "this parameter is discussed in section  4 .",
    "the methods used to prove the near - perfect circularity of the divisible sandpile shape in theorem  [ divsandcircintro ] can be used to give constraints on the shape of the classical abelian sandpile , improving on the bounds of  @xcite and  @xcite .",
    "[ sandpilecircintro ] let @xmath52 be the set of sites that are visited by the classical abelian sandpile model in @xmath18 , starting from @xmath11 particles at the origin .",
    "write @xmath55 .",
    "then for any @xmath56 we have @xmath57 where @xmath58 the constant @xmath59 depends only on @xmath23 , while @xmath60 depends only on @xmath23 and @xmath61 .",
    "note that theorem  [ sandpilecircintro ] does not settle the question of the asymptotic shape of @xmath52 , and indeed it is not clear from simulations whether the asymptotic shape in two dimensions is a disc or perhaps a polygon ( figure  [ sandpile1 m ] ) . to our knowledge",
    "even the existence of an asymptotic shape is not known .",
    "the rest of the paper is organized as follows . in section  2",
    ", we derive the basic green s function estimates that are used in the proofs of theorems  [ rotorcirc ] , [ divsandcircintro ] and  [ sandpilecircintro ] . in section  3 we prove proposition  [ divsandpileabelianproperty ] and theorem  [ divsandcircintro ] for the divisible sandpile . in section  4",
    "we adapt the methods of the previous section to prove theorem  [ sandpilecircintro ] for the classical abelian sandpile model .",
    "section  5 is devoted to the proof of theorem  [ rotorcirc ] .",
    "write @xmath62 for simple random walk in @xmath18 , and for @xmath63 denote by @xmath64 the expected number of visits to @xmath33 by simple random walk started at the origin .",
    "this is the _ discrete harmonic green s function _ in @xmath18 ; it satisfies @xmath65 for @xmath66 , and @xmath67 , where @xmath68 is the discrete laplacian @xmath69 the sum is over the @xmath17 lattice neighbors @xmath70 of @xmath33 . in dimension @xmath71 , simple random walk is recurrent , so the expectation defining @xmath72 is infinite . here",
    "we define the _ potential kernel _",
    "@xmath73 where @xmath74 the limit defining @xmath72 in ( [ potentialkerneldef ] ) is finite @xcite , and @xmath72 has laplacian @xmath75 for @xmath66 , and @xmath67 .",
    "note that ( [ potentialkerneldef ] ) is the negative of the usual definition of the potential kernel ; we have chosen this sign convention so that @xmath76 has the same laplacian in dimension two as in higher dimensions .",
    "fix a real number @xmath77 and consider the function on @xmath18 @xmath78 let @xmath79 be such that @xmath80 , and let @xmath81 where @xmath82 is the first standard basis vector in @xmath18 .",
    "the function @xmath83 plays a central role in our analysis . to see where it comes from , recall the divisible sandpile _",
    "odometer function _ of proposition  [ divsandpileabelianproperty ] @xmath84 let @xmath47 be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass @xmath48 at the origin . for @xmath85",
    ", since each neighbor @xmath70 of @xmath33 emits an equal amount of mass to each of its @xmath17 neighbors , we have @xmath86 moreover , @xmath87 on @xmath88 . by construction",
    ", the function @xmath83 obeys the same laplacian condition : @xmath89 ; and as we will see shortly , @xmath90 on @xmath91 .",
    "since we expect the domain @xmath92 to be close to the ball @xmath93 , we should expect that @xmath94 .",
    "in fact , we will first show that @xmath42 is close to @xmath83 , and then use this to conclude that @xmath92 is close to @xmath93 .",
    "we will use the following estimates for the green s function @xcite ; see also ( * ? ? ?",
    "* theorems 1.5.4 and 1.6.2 ) . @xmath95 here",
    "@xmath96 , where @xmath1 is the volume of the unit ball in @xmath2 , and @xmath97 is a constant whose value we will not need to know .",
    "for @xmath30 we use @xmath98 to denote the euclidean norm of @xmath33 . here and throughout the paper , constants in error terms denoted @xmath99 depend only on @xmath23 .",
    "we will need an estimate for @xmath83 near the boundary of the ball @xmath93 .",
    "we first consider dimension @xmath71 . from ( [ standardgreensestimate ] ) we have @xmath100 where @xmath101 in the taylor expansion of @xmath102 about @xmath103 @xmath104 the linear term vanishes , leaving @xmath105 for some @xmath106 between @xmath98 and @xmath79 . in dimensions",
    "@xmath107 , from ( [ standardgreensestimate ] ) we have @xmath108 setting @xmath109 , the linear term in the taylor expansion ( [ secondordertaylor ] ) of @xmath102 about @xmath103 again vanishes , yielding @xmath110 for @xmath106 between @xmath98 and @xmath79 . together with ( [ taylordim2 ] ) , this yields the following estimates in all dimensions @xmath111 .",
    "[ gammalowerbound ] let @xmath83 be given by ( [ subtractoffconstant ] ) .",
    "for all @xmath30 we have @xmath112    [ gammaupperbound ] let @xmath83 be given by ( [ subtractoffconstant ] ) .",
    "then uniformly in @xmath79 , @xmath113    the following lemma is useful for @xmath33 near the origin , where the error term in ( [ quadraticgrowth ] ) blows up .",
    "[ gammanearorigin ] let @xmath83 be given by ( [ subtractoffconstant ] ) .",
    "then for sufficiently large @xmath79 , we have @xmath114    since @xmath115 is superharmonic , it attains its minimum in @xmath116 at a point @xmath117 on the boundary .",
    "thus for any @xmath118 @xmath119 hence by lemma  [ gammalowerbound ] @xmath120    lemmas  [ gammalowerbound ] and  [ gammanearorigin ] together imply the following .",
    "[ gammanonnegativeeverywhere ] let @xmath83 be given by ( [ subtractoffconstant ] ) .",
    "there is a constant @xmath121 depending only on @xmath23 , such that @xmath122 everywhere .",
    "let @xmath123 be a nonnegative function on @xmath18 with finite support .",
    "we start with mass @xmath124 at each site @xmath70 . the operation of _ toppling _ a vertex @xmath33 yields the mass distribution @xmath125 where @xmath126 and @xmath68 is the discrete laplacian on @xmath18 . thus if @xmath127 then @xmath128 and no mass topples ; if @xmath129 then the mass in excess of @xmath32 is distributed equally among the neighbors of @xmath33 .",
    "let @xmath37 be a sequence with the property that for any @xmath30 there are infinitely many terms @xmath38 .",
    "let @xmath130 be the amount of mass present at @xmath70 after toppling the sites @xmath131 in succession .",
    "the total mass emitted from @xmath70 during this process is @xmath132 where @xmath133 .",
    "[ existenceoflimits ] as @xmath134 the functions @xmath135 and @xmath136 tend to limits @xmath40 and @xmath137 .",
    "moreover , these limits satisfy @xmath138    write @xmath139 for the total starting mass , and let @xmath140 be a ball centered at the origin containing all points within @xmath141-distance @xmath142 of the support of @xmath123 .",
    "note that if @xmath143 and @xmath144 , then @xmath33 must have received its mass from a neighbor , so @xmath145 for some @xmath146 .",
    "since @xmath147 , it follows that @xmath136 is supported on @xmath148 .",
    "let @xmath149 be the radius of @xmath148 , and consider the _",
    "quadratic weight _",
    "@xmath150 since @xmath151 and for @xmath152 we have @xmath153 , we obtain @xmath154 summing over @xmath155 we obtain from ( [ finitetimeodom ] ) @xmath156 fixing @xmath33 , the sequence @xmath157 is thus increasing and bounded above , hence convergent .",
    "given neighboring vertices @xmath158 , since @xmath70 emits an equal amount of mass to each of its @xmath17 neighbors , it emits mass @xmath159 to @xmath33 up to time @xmath155 .",
    "thus @xmath33 receives a total mass of @xmath160 from its neighbors up to time @xmath155 . comparing the amount of mass present at @xmath33 before and after toppling , we obtain @xmath161 since @xmath40",
    "we infer that @xmath162 .",
    "note that if @xmath38 , then @xmath163 . since for each @xmath30 this holds for infinitely many values of @xmath155 , the limit satisfies @xmath164 .",
    "a function @xmath165 on @xmath18 is _ superharmonic _ if @xmath166 .",
    "given a function @xmath167 on @xmath18 the _ least superharmonic majorant _ of @xmath167 is the function @xmath168 the study of the least superharmonic majorant is a classical topic in analysis and pde ; see , for example , @xcite .",
    "note that if @xmath169 is superharmonic and @xmath170 then @xmath171 taking the infimum on the left side we obtain that @xmath165 is superharmonic .",
    "[ discretemajorant ] the limit @xmath42 in lemma  [ existenceoflimits ] is given by @xmath172 , where @xmath173 and @xmath165 is the least superharmonic majorant of @xmath174 .    by lemma  [ existenceoflimits ]",
    "we have @xmath175 since @xmath176 , the difference @xmath177 is superharmonic . as @xmath42 is nonnegative , it follows that @xmath178 .",
    "for the reverse inequality , note that @xmath179 is superharmonic on the domain @xmath180 of fully occupied sites and is nonnegative outside @xmath181 , hence nonnegative inside @xmath181 as well .    as a corollary of lemmas  [ existenceoflimits ] and  [ discretemajorant ]",
    ", we obtain the abelian property of the divisible sandpile , proposition  [ divsandpileabelianproperty ] , which was stated in the introduction .",
    "we now turn to the case of a point source mass @xmath48 started at the origin : @xmath182 .",
    "more general starting distributions are treated in @xcite , where we identify the scaling limit of the divisible sandpile model and show that it coincides with that of internal dla and of the rotor - router model . in the case of a point source of mass @xmath48 , the natural question is to identify the shape of the resulting domain @xmath92 of fully occupied sites , i.e.  sites @xmath33 for which @xmath183 . according to theorem  [ divsandcirc ] ,",
    "@xmath92 is extremely close to a ball of volume @xmath48 ; in fact , the error in the radius is a constant independent of @xmath48 . as before , for @xmath20 we write @xmath184 for the lattice ball of radius @xmath79 centered at the origin .",
    "[ divsandcirc ] for @xmath46 let @xmath47 be the domain of fully occupied sites for the divisible sandpile formed from a pile of size @xmath48 at the origin . there exist constants @xmath22 depending only on @xmath23 , such that @xmath49 where @xmath50 and @xmath1 is the volume of the unit ball in @xmath2 .",
    "the idea of the proof is to use lemma  [ discretemajorant ] along with the basic estimates on @xmath167 , lemmas  [ gammalowerbound ] and  [ gammaupperbound ] , to obtain estimates on the odometer function @xmath84 we will need the following simple observation .",
    "[ boundarypath ] for every point @xmath185 there is a path @xmath186 in @xmath92 with @xmath187 .    if @xmath188 , let @xmath189 be a neighbor of @xmath190 maximizing @xmath191 .",
    "then @xmath192 and @xmath193 where in the last step we have used the fact that @xmath194 .    we first treat the inner estimate .",
    "let @xmath83 be given by ( [ subtractoffconstant ] ) .",
    "by lemma  [ discretemajorant ] the function @xmath195 is superharmonic , so its minimum in the ball @xmath93 is attained on the boundary . since @xmath196",
    ", we have by lemma  [ gammaupperbound ] @xmath197 for a constant @xmath198 depending only on @xmath23 . hence by lemma  [ gammalowerbound ] , @xmath199 for a constant @xmath200 depending only on @xmath23 .",
    "it follows that there is a constant @xmath201 , depending only on @xmath23 , such that @xmath202 whenever @xmath203 .",
    "thus @xmath204 . for @xmath118 , by lemma  [ gammanearorigin ] we have @xmath205 , hence @xmath206 .    for the outer estimate , note that @xmath195 is harmonic on @xmath92 . by lemma  [ gammanonnegativeeverywhere ]",
    "we have @xmath122 everywhere , where @xmath121 depends only on @xmath23 .",
    "since @xmath42 vanishes on @xmath88 it follows that @xmath207 on @xmath92 .",
    "now for any @xmath85 with @xmath208 , we have by lemma  [ gammaupperbound ] @xmath209 for a constant @xmath210 depending only on @xmath23 .",
    "lemma  [ boundarypath ] now implies that @xmath211 .",
    "we consider a generalization of the classical abelian sandpile , proposed by fey and redig @xcite .",
    "each site in @xmath18 begins with a `` hole '' of depth @xmath212 .",
    "thus , each site absorbs the first @xmath212 grains it receives , and thereafter functions normally , toppling once for each additional @xmath17 grains it receives .",
    "if @xmath212 is negative , we can interpret this as saying that every site starts with @xmath213 grains of sand already present .",
    "aggregation is only well - defined in the regime @xmath214 , since for @xmath215 the addition of a single grain already causes every site in @xmath18 to topple infinitely often .",
    "let @xmath216 be the set of sites that are visited if @xmath11 particles start at the origin in @xmath18 .",
    "fey and redig ( * ? ? ?",
    "* theorem  4.7 ) prove that @xmath217 where @xmath55 , and @xmath218 denotes symmetric difference .",
    "the following theorem strengthens this result .",
    "[ sandpilecirc ] fix an integer @xmath219 . let @xmath220 be the set of sites that are visited by the classical abelian sandpile model in @xmath18 , starting from @xmath11 particles at the origin , if every lattice site begins with a hole of depth @xmath212 .",
    ". then @xmath221 where @xmath222 and @xmath59 is a constant depending only on @xmath23",
    ". moreover if @xmath223 , then for any @xmath56 we have @xmath224 where @xmath225 and @xmath60 is independent of @xmath11 but may depend on @xmath23 , @xmath212 and @xmath61 .",
    "note that the ratio @xmath226 as @xmath227",
    ". thus , the classical abelian sandpile run from an initial state in which each lattice site starts with a deep hole yields a shape very close to a ball .",
    "intuitively , one can think of the classical sandpile with deep holes as approximating the divisible sandpile , whose limiting shape is a ball by theorem  [ divsandcirc ] . following this intuition",
    ", we can adapt the proof of theorem  [ divsandcirc ] to prove theorem  [ sandpilecirc ] ; just one additional averaging trick is needed , which we explain below .",
    "consider the odometer function for the abelian sandpile @xmath228 let @xmath229 be the set of sites which topple at least once .",
    "then @xmath230 in the final state , each site which has toppled retains between @xmath231 and @xmath232 grains , in addition to the @xmath212 that it absorbed .",
    "hence @xmath233 we can improve the lower bound by averaging over a small box . for @xmath30 let @xmath234 be the box of side length @xmath235 centered at @xmath33 , and let @xmath236 write @xmath237 le borgne and rossin @xcite observe that if @xmath238 is a set of sites all of which topple , the number of grains remaining in @xmath238 is at least the number of edges internal to @xmath238 : indeed , for each internal edge , the endpoint that topples last sends the other a grain which never moves again . since the box @xmath239 has @xmath240 internal edges , we have @xmath241 the following lemma is analogous to lemma  [ boundarypath ] .",
    "[ boundarypathology ] for every point @xmath242 adjacent to @xmath243 there is a path @xmath244 in @xmath245 with @xmath187 .    by ( [ dumblaplbounds ] )",
    "we have @xmath246 since @xmath247 , some term @xmath248 in the sum above must exceed @xmath249 .",
    "let @xmath250 .",
    "let @xmath251 and let @xmath252 taking @xmath253 in lemma  [ gammaupperbound ] , we have @xmath254 for a constant @xmath198 depending only on @xmath23 . by ( [ dumblaplbounds ] ) , @xmath255 is superharmonic , so @xmath256 in all of @xmath257 .",
    "hence by lemma  [ gammalowerbound ] we have for @xmath258 @xmath259 where @xmath200 depends only on @xmath23 .",
    "it follows that @xmath42 is positive on @xmath260 for a suitable constant @xmath59 depending only on @xmath23 .",
    "for @xmath261 , by lemma  [ gammanearorigin ] we have @xmath262 .",
    "thus @xmath263 .    for the outer estimate ,",
    "let @xmath264 choose @xmath155 large enough so that @xmath265 , and define @xmath266 finally , let @xmath267 by ( [ averagedinabox ] ) , @xmath268 is subharmonic on @xmath269 . taking @xmath270 in lemma  [ gammanonnegativeeverywhere ]",
    ", there is a constant @xmath121 depending only on @xmath23 , such that @xmath271 everywhere . since @xmath272 on @xmath273 it follows that @xmath274 on @xmath269 .",
    "now for any @xmath275 with @xmath276 we have by lemma  [ gammaupperbound ] @xmath277 for a constant @xmath278 depending only on @xmath23 , @xmath212 and @xmath61",
    ". then @xmath279 .",
    "lemma  [ boundarypathology ] now implies that @xmath280 , and hence @xmath281    we remark that the crude bound of @xmath282 used in the proof of the outer estimate can be improved to a bound of order @xmath283 , and the final factor of @xmath284 can be replaced by a constant factor independent of @xmath155 and @xmath212 , using the fact that a nonnegative function on @xmath18 with bounded laplacian can not grow faster than quadratically ; see @xcite .",
    "given a function @xmath169 on @xmath18 , for a directed edge @xmath285 write @xmath286 given a function @xmath165 on directed edges in @xmath18 , write @xmath287 the discrete laplacian of @xmath169 is then given by @xmath288      fixing @xmath289 , consider the odometer function for rotor - router aggregation @xmath290 we learned the idea of using the odometer function to study the rotor - router shape from matt cook @xcite .",
    "[ odomflow ] for a directed edge @xmath285 in @xmath18 , denote by @xmath291 the net number of crossings from @xmath33 to @xmath70 performed by the first @xmath11 particles in rotor - router aggregation .",
    "then @xmath292 for some edge function @xmath149 which satisfies @xmath293 for all edges @xmath285 .    in the more general",
    "setting of rotor stacks of bounded discrepancy , the @xmath294 will be replaced by a different constant here .",
    "writing @xmath295 for the number of particles routed from @xmath33 to @xmath70 , we have @xmath296 hence @xmath297    in what follows , @xmath298 denote constants depending only on @xmath23 .",
    "[ diameterbound ] let @xmath299 with @xmath300",
    ". then @xmath301    for each positive integer @xmath155 , let @xmath302 then @xmath303 for a constant @xmath304 depending only on @xmath23 .",
    "since @xmath305 can intersect at most @xmath306 distinct sets @xmath307 , taking @xmath308 the proof is complete .    [",
    "letsgetthispartystarted ] let @xmath309 be the green s function for simple random walk in @xmath18 stopped on exiting @xmath93 .",
    "for any @xmath310 and @xmath311 , @xmath312    let @xmath313 denote simple random walk in @xmath18 , and let @xmath238 be the first exit time from @xmath93 . for fixed @xmath70 , the function",
    "@xmath314 has laplacian @xmath315 in @xmath93 and vanishes on @xmath91 , hence @xmath316 .",
    "let @xmath317 and @xmath318 . from ( [ standardgreensestimate ] )",
    "we have @xmath319 using the triangle inequality together with ( [ stoppedgreen ] ) , we obtain @xmath320 where @xmath321 .",
    ". then @xmath323 taking @xmath324 in lemma  [ diameterbound ] , the inner sum on the right is at most @xmath325diam@xmath326 , so the right side of ( [ twointegrals ] ) is bounded above by @xmath327 for a suitable @xmath328 .",
    "finally , the terms in which @xmath70 or @xmath117 coincides with @xmath33 make a negligible contribution to the sum in ( [ theparty ] ) , since for @xmath329 @xmath330    [ hitthehyperplanefigure ]    [ hitthehyperplane ] let @xmath331 be linear half - spaces in @xmath18 , not necessarily parallel to the coordinate axes .",
    "let @xmath332 be the first hitting time of @xmath333 .",
    "if @xmath334 , then @xmath335 where @xmath336 is the distance from @xmath33 to @xmath333 .    if one of @xmath331 contains the other , the result is vacuous .",
    "otherwise , let @xmath337 be the half - space shifted parallel to @xmath338 by distance @xmath339 in the direction of @xmath33 , and let @xmath340 be the first hitting time of @xmath341 .",
    "let @xmath313 denote simple random walk in @xmath18 , and write @xmath342 for the ( signed ) distance from @xmath343 to the hyperplane defining the boundary of @xmath344 , with @xmath345 .",
    "then @xmath342 is a martingale with bounded increments . since @xmath346",
    ", we obtain from optional stopping @xmath347 hence @xmath348 likewise , @xmath349 is a martingale with bounded increments , giving @xmath350    let @xmath351 . denoting by @xmath352 the distance from @xmath343 to the hyperplane defining the boundary of @xmath353 ,",
    "the quantity @xmath354 is a martingale .",
    "writing @xmath355 we have @xmath356 hence by ( [ timeupperbound ] ) @xmath357 finally by ( [ justgamblersruin ] ) @xmath358    [ geoshellsfig ]    [ geoshells ] let @xmath311 and let @xmath359 .",
    "let @xmath360 let @xmath361 be the first hitting time of @xmath362 , and @xmath238 the first exit time from @xmath93 .",
    "then @xmath363    let @xmath212 be the outer half - space tangent to @xmath93 at the point @xmath364 closest to @xmath33 .",
    "let @xmath365 be the cube of side length @xmath366 centered at @xmath33 .",
    "then @xmath365 is disjoint from @xmath362 , hence @xmath367 where @xmath368 and @xmath369 are the first hitting times of @xmath370 and @xmath212 .",
    "let @xmath371 be the outer half - spaces defining the faces of @xmath365 , so that @xmath372 .",
    "by lemma  [ hitthehyperplane ] we have @xmath373 since dist@xmath374 and dist@xmath375 , and @xmath376 , taking @xmath377 completes the proof .",
    "[ greengradbound ] let @xmath378 be the green s function for random walk stopped on exiting @xmath93 .",
    "let @xmath311 and let @xmath359 .",
    "then @xmath379    let @xmath362 be given by ( [ shells ] ) , and let @xmath380 be the portion of the boundary of the enlarged spherical shell @xmath381 lying closer to @xmath33 .",
    "let @xmath382 be the first hitting time of @xmath383 , and @xmath238 the first exit time from @xmath93 .",
    "for @xmath384 let @xmath385 for any @xmath386 and @xmath387 , simple random walk started at @xmath33 must hit @xmath383 before hitting either @xmath70 or @xmath117 , hence @xmath388 for any @xmath386 and any @xmath389 we have @xmath390 lemma  [ letsgetthispartystarted ] yields @xmath391 by lemma  [ geoshells ] we have @xmath392 , so the above sum is at most @xmath393 .",
    "since the union of shells @xmath394 covers all of @xmath93 except for those points @xmath70 within distance @xmath395 of @xmath33 , and @xmath396 by lemma  [ letsgetthispartystarted ] , the result follows .",
    "let @xmath97 and @xmath149 be defined as in lemma [ odomflow ] . since the net number of particles to enter a site @xmath66 is at most one , we have @xmath397 .",
    "likewise @xmath398 . taking the divergence in ( [ gradodom ] ) , we obtain @xmath399 let @xmath238 be the first exit time from @xmath93 , and define @xmath400 then @xmath401 for @xmath402 and @xmath403",
    ". moreover @xmath404 on @xmath91 .",
    "it follows from lemma  [ gammaupperbound ] with @xmath405 that @xmath406 on @xmath93 for a suitable constant @xmath407 .",
    "we have @xmath408 each summand on the right side is zero on the event @xmath409 , hence @xmath410 taking expectations and using ( [ laplodom ] ) and ( [ laplodomat0 ] ) , we obtain @xmath411 \\\\      & \\hspace{-0.25 in } = n\\ee_x \\ # \\{k < t | x_k = o \\ } - \\ee_x t -   \\sum_{k\\geq 0 } \\ee_x \\big [ 1_{\\{t > k\\ } }   \\div r(x_k ) \\big ] ,      \\end{aligned}\\ ] ] hence @xmath412.\\ ] ] since random walk exits @xmath93 with probability at least @xmath413 every time it reaches a site adjacent to the boundary @xmath91 , the expected time spent adjacent to the boundary before time @xmath238 is at most @xmath17 . since @xmath414 , the terms in ( [ sumofrs ] ) with @xmath415 contribute at most @xmath416 to the sum .",
    "thus @xmath417 - 8d^2.\\ ] ] for @xmath418 we have @xmath419 , hence @xmath420 write @xmath421 .",
    "note that since @xmath422 and @xmath97 are antisymmetric ,  @xmath149 is antisymmetric .",
    "thus @xmath423 summing over @xmath155 and using the fact that @xmath414 , we conclude from ( [ triplesum ] ) that @xmath424 where @xmath378 is the green s function for simple random walk stopped on exiting @xmath93 . by lemma  [ greengradbound ]",
    "we obtain @xmath425 using the fact that @xmath406 , we obtain from lemma  [ gammalowerbound ] @xmath426 the right side is positive provided @xmath427 . for @xmath428 , by lemma  [ gammanearorigin ] we have @xmath429 , hence @xmath430 .",
    "the following result is due to holroyd and propp ( unpublished ) ; we include a proof for the sake of completeness .",
    "notice that the bound in ( [ hpbound ] ) does not depend on the number of particles .",
    "[ hp ] let @xmath431 be a finite connected graph , and let @xmath432 be subsets of the vertex set of @xmath431 .",
    "let @xmath165 be a nonnegative integer - valued function on the vertices of @xmath431 .",
    "let @xmath433 be the expected number of particles stopping in @xmath434 if @xmath435 particles start at each vertex @xmath33 and perform independent simple random walks stopped on first hitting @xmath436 .",
    "let @xmath437 be the number of particles stopping in @xmath434 if @xmath435 particles start at each vertex @xmath33 and perform rotor - router walks stopped on first hitting @xmath436 .",
    "let @xmath438 .",
    "then @xmath439 independent of @xmath165 and the initial positions of the rotors .    for each vertex @xmath440",
    ", arbitrarily choose a neighbor @xmath441 .",
    "order the neighbors @xmath442 of  @xmath42 so that the rotor at  @xmath42 points to  @xmath443 immediately after pointing to @xmath444 ( indices mod @xmath23 ) .",
    "we assign _ weight _ @xmath445 to a rotor pointing from @xmath42 to @xmath441 , and weight @xmath446 to a rotor pointing from @xmath42 to @xmath444 .",
    "these assignments are consistent since @xmath212 is a harmonic function : @xmath447 .",
    "we also assign weight @xmath448 to a particle located at @xmath42 .",
    "the sum of rotor and particle weights in any configuration is invariant under the operation of routing a particle and rotating the corresponding rotor .",
    "initially , the sum of all particle weights is @xmath433 .",
    "after all particles have stopped , the sum of the particle weights is @xmath437 .",
    "their difference is thus at most the change in rotor weights , which is bounded above by the sum in ( [ hpbound ] )",
    ".    for @xmath449 let @xmath450 then @xmath451 note that for simple random walk started in @xmath452 , the first exit time of @xmath452 and first hitting time of @xmath453 coincide .",
    "our next result is a modification of lemma  5(b ) of @xcite .",
    "[ inthezonefigure ]    [ inthezone ] fix @xmath376 and @xmath454 . for @xmath455",
    "let @xmath456 , where @xmath238 is the first hitting time of @xmath453 .",
    "then @xmath457 for a constant j depending only on @xmath23 .",
    "we induct on the distance @xmath458 , assuming the result holds for all @xmath459 with @xmath460 ; the base case can be made trivial by choosing @xmath461 sufficiently large . by lemma  5(b ) of @xcite , we can choose @xmath461 large enough so that the result holds provided @xmath462 .",
    "otherwise , let @xmath344 be the outer half - space tangent to @xmath463 at the point of @xmath463 closest to @xmath33 , and let @xmath353 be the inner half - space tangent to the ball @xmath464 of radius @xmath465 about @xmath70 , at the point of @xmath464 closest to @xmath33",
    ". by lemma  [ hitthehyperplane ] applied to these half - spaces , the probability that random walk started at @xmath33 reaches @xmath464 before hitting @xmath453 is at most @xmath466 .",
    "writing @xmath467 for the first hitting time of @xmath468 , we have @xmath469 where we have used the inductive hypothesis to bound @xmath470 .",
    "the _ lazy _ random walk in @xmath18 stays in place with probability @xmath471 , and moves to each of the @xmath17 neighbors with probability @xmath472 .",
    "we will need the following standard result , which can be derived e.g.  from the estimates in @xcite , section ii.12 ; we include a proof for the sake of completeness .",
    "[ lazycoupling ] given @xmath473 , lazy random walks started at @xmath42 and @xmath474 can be coupled with probability @xmath475 before either reaches distance @xmath149 from @xmath42 , where @xmath198 depends only on @xmath23 .",
    "let @xmath476 be the coordinate such that @xmath477 . to define a step of the coupling , choose one of the @xmath23 coordinates uniformly at random .",
    "if the chosen coordinate is different from @xmath476 , let the two walks take the same lazy step so that they still agree in this coordinate .",
    "if the chosen coordinate is @xmath476 , let one walk take a step while the other stays in place . with probability @xmath471 the walks",
    "will then be coupled .",
    "otherwise , they are located at points @xmath478 with @xmath479 . moreover , @xmath480 for a constant @xmath200 depending only on @xmath23 . from now on , whenever coordinate @xmath476 is chosen , let the two walks take lazy steps in opposite directions .",
    "let @xmath481 be the hyperplane bisecting the segment @xmath482 $ ] . since the steps of one walk are reflections in @xmath344 of the steps of the other , the walks couple when they hit @xmath344 .",
    "let @xmath365 be the cube of side length @xmath483 centered at @xmath42 , and let @xmath353 be a hyperplane defining one of the faces of @xmath365 . by lemma  [ hitthehyperplane ] with @xmath484 and @xmath485 , the probability that one of the walks exits @xmath365 before the walks couple is at most @xmath486 .",
    "[ harmonicmeasuregrad ] with @xmath212 defined as in lemma  _ [ inthezone ] _ , we have @xmath487 for a constant @xmath488 depending only on @xmath23 .",
    "given @xmath489 and @xmath490 , by lemma  [ lazycoupling ] , lazy random walks started at @xmath42 and @xmath474 can be coupled with probability @xmath491 before either reaches distance @xmath492 from @xmath42 .",
    "if the walks reach this distance without coupling , by lemma  [ inthezone ] each has still has probability at most @xmath493 of exiting @xmath452 at @xmath70 . by the strong markov property it follows that @xmath494 summing in spherical shells about @xmath70",
    ", we obtain @xmath495    we remark that lemma  [ harmonicmeasuregrad ] could also be inferred from lemma  [ inthezone ] using ( * ? ? ?",
    "1.7.1 ) in a ball of radius @xmath492 about @xmath42 .    to prove the outer estimate of theorem  [ rotorcirc ] , we will make use of the _",
    "abelian property _ of rotor - router aggregation .",
    "fix a finite set @xmath496 containing the origin . starting with @xmath11 particles at the origin , at each time step ,",
    "choose a site @xmath497 with more than one particle , rotate the rotor at @xmath33 , and move one particle from @xmath33 to the neighbor the rotor points to .",
    "after a finite number of such choices , each site in @xmath431 will have at most one particle , and all particles that exited @xmath431 will be on the boundary @xmath498 .",
    "the abelian property says that _ the final configuration of particles and the final configuration of rotors do not depend on the choices_. for a proof , see ( * ? ? ?",
    "4.1 ) .    in our application",
    ", we will fix @xmath499 and stop each particle in rotor - router aggregation either when it reaches an unoccupied site or when it reaches the spherical shell @xmath453 .",
    "let @xmath500 be the number of particles that reach @xmath453 during this process .",
    "note that at some sites in @xmath453 , more than one particle may have stopped .",
    "if we let each of these extra particles in turn continue performing rotor - router walk , stopping either when it reaches an unoccupied site or when it hits the larger shell @xmath501 , then by the abelian property , the number of particles that reach @xmath501 will be @xmath502 .",
    "we will show that when @xmath54 is order @xmath503 , a constant fraction of the particles that reach @xmath453 find unoccupied sites before reaching @xmath501 .",
    "fix integers @xmath499 and @xmath504 . in the setting of proposition  [ hp ] ,",
    "let @xmath431 be the lattice ball @xmath505 , and let @xmath506 .",
    "fix @xmath507 and let @xmath508 . for @xmath509 ,",
    "let @xmath435 be the number of particles stopped at @xmath33 if each particle in rotor - router aggregation is stopped either when it reaches an unoccupied site or when it reaches @xmath453 .",
    "write @xmath510 where @xmath238 is the first hitting time of @xmath501 . by lemma  [ inthezone ]",
    "we have @xmath511 where @xmath512 is the number of particles that ever visit the shell @xmath453 .    by lemma  [ harmonicmeasuregrad ]",
    "the sum in ( [ hpbound ] ) is at most @xmath513 , hence from propositon  [ hp ] and ( [ h_wbound ] ) we have @xmath514 let @xmath515 , and define @xmath516 inductively by @xmath517 fixing @xmath518 , we have @xmath519 so ( [ tinyrrs ] ) with @xmath520 simplifies to @xmath521 where @xmath522 .",
    "since all particles that visit @xmath523 during rotor - router aggregation must pass through @xmath524 , we have by the abelian property @xmath525 let @xmath526 .",
    "there are at most @xmath527 nonzero terms in the sum on the right side of ( [ alltermsaresmall ] ) , and each term is bounded above by ( [ eventinierrrs ] ) , hence @xmath528 where the second inequality follows from @xmath529 . summing over @xmath54 , we obtain @xmath530 the left side is at most @xmath531 , hence @xmath532 provided @xmath533 .",
    "thus the minimum in ( [ doublemin ] ) is not attained by its first argument .",
    "it follows that @xmath534 , hence @xmath535 for a sufficiently large constant @xmath121 .    by the inner estimate , since the ball @xmath536 is entirely occupied , we have @xmath537 write @xmath538 ; by ( [ lotsavolume ] ) we have @xmath539 by jensen s inequality , subject to this constraint , @xmath540 is maximized when all @xmath190 are equal , in which case @xmath541 and @xmath542 since @xmath543 we have @xmath544 ; that is , no particles reach the shell @xmath545 . taking @xmath546 , we obtain from ( [ outershellbound ] ) @xmath547",
    "[ invertedrotor ] .",
    "the colors represent the rotor directions .",
    "the white disc in the center is the image of the complement of the occupied region.,title=\"fig : \" ]    a number of intriguing questions remain unanswered .",
    "although we have shown that the asymptotic shape of the rotor - router model is a ball , the near perfect circularity found in figure  [ rotor1 m ] remains a mystery .",
    "in particular , we do not know whether an analogue of theorem  [ divsandcircintro ] holds for the rotor - router model , with constant error in the radius as the number of particles grows .",
    "equally mysterious are the patterns in the rotor directions evident in figure  [ rotor1 m ] .",
    "the rotor directions can be viewed as values of the odometer function mod @xmath17 , but our control of the odometer is not fine enough to provide useful information about the patterns .",
    "if the rescaled occupied region @xmath548 is viewed as a subset of the complex plane , it appears that the monochromatic regions visible in figure  [ rotor1 m ] , in which all rotors point in the same direction , occur near points of the form @xmath549 , where @xmath550 is a gaussian integer ( i.e.  @xmath551 ) .",
    "we do not even have a heuristic explanation for this phenomenon .",
    "figure  7 shows the image of @xmath16 under the map @xmath552 ; the monochromatic patches in the transformed region occur at lattice points .",
    "lszl lovsz ( personal communication ) has asked whether the occupied region @xmath12 is simply connected , i.e.  whether its complement is connected . while theorem  [ rotorcirc ] shows that @xmath12 can not have any holes far from the boundary , we can not answer his question at present .",
    "a final question is whether our methods could be adapted to internal dla to show that if @xmath0 , then with high probability @xmath553 , where @xmath28 is the internal dla cluster of @xmath11 particles .",
    "the current best bound is due to lawler @xcite , who proves that with high probability @xmath554 .",
    "the authors thank jim propp for bringing the rotor - router model to our attention and for many fruitful discussions .",
    "we also had useful discussions with oded schramm , scott sheffield and misha sodin .",
    "we thank wilfried huss for pointing out an error in an earlier draft .",
    "yelena shvets helped draw some of the figures .",
    "p. koosis , la plus petite majorante surharmonique et son rapport avec lexistence des fonctions entires de type exponentiel jouant le rle de multiplicateurs , _ ann .",
    "fourier ( grenoble ) _ * 33 * ( 1983 ) , fasc .  1 , 67107 ."
  ],
  "abstract_text": [
    "<S> the rotor - router model is a deterministic analogue of random walk . </S>",
    "<S> it can be used to define a deterministic growth model analogous to internal dla . </S>",
    "<S> we prove that the asymptotic shape of this model is a euclidean ball , in a sense which is stronger than our earlier work @xcite . for the shape consisting of @xmath0 sites , where @xmath1 is the volume of the unit ball in @xmath2 </S>",
    "<S> , we show that the inradius of the set of occupied sites is at least @xmath3 , while the outradius is at most @xmath4 for any @xmath5 . for a related model , the _ divisible sandpile _ , we show that the domain of occupied sites is a euclidean ball with error in the radius a constant independent of the total mass . for the classical abelian sandpile model in two dimensions , with @xmath6 particles , </S>",
    "<S> we show that the inradius is at least @xmath7 , and the outradius is at most @xmath8 . </S>",
    "<S> this improves on bounds of le borgne and rossin . </S>",
    "<S> similar bounds apply in higher dimensions , improving on bounds of fey and redig . </S>"
  ]
}