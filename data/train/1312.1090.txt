{
  "article_text": [
    "for a simple stellar population ( ssp ) , the mass return rate from the aging stars to the ambient medium depends on the relation between the initial mass and the remnant mass of each star , and the initial mass function ( hereafter imf ; e.g. tinsley 1980 , matteucci & greggio 1986 , tosi 1988 , ciotti et al .",
    "1991 , maraston 1998 ) . in general , the mass return of a ssp represents a non - negligible fraction of its initial mass , ranging from 20% to 30% for standard choices of the imf ( such as a scalo 1986 , chabrier 2003 , kroupa et al .",
    "1993 ; e.g. pellegrini 2012 ) .",
    "in stellar systems this source of fresh gas is present independently of random phenomena such as galaxy merging ; therefore , the mass return of stellar populations plays a major role in determining the chemical composition and the baryonic mass budget of the host systems .",
    "for example , the gas recycled by the aging stellar population is the main mass source for gas flows in early - type galaxies such as cooling flows and galactic winds ( for general reviews see , e.g. , mathews & brighenti 2003 , pellegrini 2012 ) , for accretion of super - massive black holes ( smbhs ) at the center of spheroids ( e.g. norman & scoville 1988 , padovani & matteucci 1993 , tabor & binney 1993 , ciotti & ostriker 1997 , shcherbakov et al .",
    "2013 , see also ciotti & ostriker 2012 and references therein ) , and the consequent _ negative and positive feedback _",
    "( e.g. , ciotti & ostriker 2007 , ishibashi & fabian 2012 , zubovas et al .",
    "another case where the mass returned from the evolving stars seems to play a fundamental role is the origin of multiple stellar populations in globular clusters ( see , e.g. , piotto et al .",
    "2007 , renzini 2008 , dercole et al . 2012 ) .    of course",
    ", real stellar systems are made by multiple stellar populations , i.e. by a collection of ssps assembled at different epochs and with different metallicities , so that the mass return rate is a function of their star formation history ( sfh ) . in this case ,",
    "an accurate calculation of the mass loss rate requires keeping track of the age and metallicity of each ssp and , depending on the desired time resolution , its computation can be expensive in terms of computer time .",
    "in fact , the function describing the mass return of a stellar population is in general linked to its sfh through a convolution integral over time .",
    "therefore , not only the numerical evaluations needed for its computation increase quadratically with the number of time - steps , but also the whole sfh must be stored in the computer memory .",
    "the situation becomes extremely time- and memory - consuming in the case of hydrodynamical simulations , where each cell of the numerical grid in principle hosts a different sfh , and where the number of time steps can be of the order of millions or more for simulations spanning a hubble time , due to heating , cooling and courant times that can be orders of magnitude shorter than the characteristic stellar lifetimes .",
    "similar ( but less severe ) problems affect also semi - analytic models ( sams ) of galaxy formation ( e.g. , baugh 2006 ) . in such models ,",
    "the evolution of the baryonic matter is driven by the evolution of the dark matter halos , and the most massive galaxies form by the progressive coalescence of a large number of progenitors .",
    "thanks to the simplified treatment of the various physical processes involved , sams allow to explore the parameter space at a reasonable computational cost . however , in order to compute accurately the mass return rate with an acceptable time resolution ( @xmath0 myr or less ) over a hubble time , the most massive galaxies require to store the sfhs of several thousands progenitors ( and this for an array of @xmath1 elements if one is interested in chemical evolution ) . to reduce the computational cost ,",
    "sometimes the mass return rate is computed by means of the _ instantaneous recycling approximation _ ( ira ) , i.e. assuming that massive stars contribute instantaneously to the mass return and to the chemical enrichment of the interstellar medium ( ism ) , whereas the contribution of low and intermediate mass stars is neglected at any epoch ( e.g. , starkenburg et al .",
    "this approach has considerable limitations , since at short times after a burst of star formation it can lead to a severe overestimation of the instantaneous mass return rate of the stellar populations ( e.g. matteucci 2001 ) .",
    "note that the ira is used also in hydrodynamical simulations , for instance when studying the evolution of star - forming molecular clouds ( where the required time resolution is set by the cooling time , of the order of @xmath2 yr , e.g. krumholz 2011 ) .    in order to overcome these problems and to compute accurately the mass reprocessing from evolving stellar populations , in this paper we present a fast and very accurate method which takes into account the stellar lifetimes , at significantly reduced computational cost with respect to the direct integration of the convolution integral .",
    "the method bypasses the need of storing the sfh , as it uses information relative to the previous time - step only , thus reducing the number of evaluations of the convolution integral from quadratic to linear .",
    "the new scheme can be easily implemented in sams and in hydrodynamical codes , with significant gain in accuracy and speed over standard methods .",
    "the basic idea extends a scheme already adopted in numerical simulations to describe the delayed accretion of gas from the accretion disk to the smbh at the center of stellar spheroids , where the mass flow on the accretion disk is determined by the solution of the hydrodynamical equations for the ism ( e.g. , ciotti & ostriker 2007 ) . a simplified version of this method has been implemented in lusso & ciotti ( 2011 ) to describe the time evolution of the snia rate in galaxy formation models with agn feedback .",
    "in fact , the new method here presented can be applied not only to the computation of the mass return rate from stellar populations , but also to other astrophysical studies where time - dependent convolution integrals with known kernels must be computed ( as in the case mentioned above of snia , e.g. , greggio 2005 for a full discussion ) .",
    "the paper is organized as follows . in section 2",
    "we introduce the basic equations for the mass return rate and the formalism underlying the new method . in section 3 illustrative results are presented , and finally in section 4 we draw our conclusions .",
    "mathematical detailes behind the method are given in the appendix .",
    "we start by considering a ssp of total mass @xmath3 and imf described by the function @xmath4 ; from now on all stellar masses are in solar mass units , @xmath5 .",
    "the _ normalized _",
    "imf @xmath6 is defined so that @xmath7 where @xmath8 and @xmath9 are the minimum and the maximum stellar mass in the population , respectively .    as well known ( e.g. , ciotti et al .",
    "1991 , pellegrini 2012 ) , for a ssp assembled at @xmath10 , the normalized mass return rate @xmath11 can be written as @xmath12\\times { m_{\\rm ej}}[{m_{\\rm to}}(t)]\\times |{\\dot{m}_{\\rm to}}(t)| , \\label{eqr}\\ ] ] where @xmath13 is the mass of the stars entering the turn - off phase at time @xmath14 , and @xmath15 is the total mass ejected by a star of initial mass @xmath16 in the post main sequence evolutionary phases . by construction",
    ", the mass return rate of the considered ssp is given by @xmath17 .",
    "for a sfh characterized by a star formation rate @xmath18 , and a time and metallicity independent imf , the mass return rate at the time @xmath14 is given by @xmath19 note that the lower limit of integration is arbitrary , being related to the beginning of star formation : for example , in this case we assume without loss of generality that @xmath20=0 for @xmath21 .",
    "on the contrary , the upper limit of integration is physically required by the obvious fact that mass return from a stellar population can not take place before its formation .    as pointed out in the introduction , the integral above , when evaluated by direct sum ,",
    "scales quadratically with the number of time - steps adopted to discretize the time @xmath14 , so its computation can be extremely time - consuming .",
    "we will now show how to evaluate eq .",
    "( 3 ) as a _ linear _ function of the number of time - steps , and without the need of storing the whole evolution of @xmath22 .",
    "we will refer to the rate as obtained by integrating eq .",
    "( 3 ) with standard methods as the _ exact rate _ , while the alternative scheme here presented will be called the _ new method_.    in the formalism of eq . ( 3 ) , the mass return rate in the ira is written as @xmath23 in practice , the ira mass return rate is just given by the instantaneous star formation rate times the total mass fraction released by the ssp .",
    "of course , the ira overcomes all the problems of computational times and memory storage posed by the standard evaluation of eq .",
    "( 3 ) , but it can be properly used only when _ all _ the timescales of the problem under consideration are much longer than the lifetimes of the typical stars producing the bulk of the mass return in the ssp .",
    "the idea behind the new method is to substitute the exact kernel @xmath11 in eq .",
    "( 3 ) with a sum of functions with special mathematical properties .",
    "we begin by illustrating the method for the case of a sum of pure exponentials .",
    "suppose that for a given ssp formed at @xmath10 the associated @xmath24 can be represented with high accuracy as @xmath25 where the parameters @xmath26 and @xmath27 are obtained by fitting the exact function given in eq .",
    "( 2 ) ; note that @xmath26 and @xmath27 are in units of inverse of time ( e.g. , gyr@xmath28 ) .",
    "it follows that eq .",
    "( 3 ) can be written as @xmath29 where @xmath30 the meaning of the superscript `` ( 0 ) '' will become clear in the following . for simplicity",
    "we drop the subscript index @xmath31 , as we now derive the generic expression for the family @xmath32 , and the restoration of subscript @xmath31 in the resulting formulae is immediate .",
    "it is straightforward to show that for a generic time interval @xmath33 ( not necessarily small ) , the function @xmath32 can be written rigorously as @xmath34 where @xmath35 in practice , at time @xmath36 , each term of the sum in eq .",
    "( 6 ) can be calculated iteratively from the values at time @xmath14 , plus a contribution @xmath37 due to the star formation over the last time interval only .",
    "for example , if we adopt a standard trapezoidal rule , @xmath38,\\ ] ] and the final recursive formula for @xmath39 is obtained by summation of the @xmath40 components by using eq .",
    "remarkably , for reasons that will be explained below , the method can be extended by using in eq . ( 5 ) `` base '' functions more general than pure exponentials , namely @xmath41 , where @xmath42 is an integer ( and , as discussed in the appendix , not necessarily the same in all the @xmath40 components ) . in principle , this property allows to reproduce quite complicated time dependencies of @xmath24 , in particular the initial rise due to the short but finite lifetimes of the most massive stars in the imf .",
    "for example , in the illustrative case presented in sect .",
    "3 we found it optimal to use @xmath43 in all the components .",
    "accordingly , we now consider @xmath44 ( where of course @xmath26 and @xmath27 are different from those appearing in eq .",
    "( 5 ) , and the @xmath26 are now in units of gyr@xmath45 ) .",
    "it follows that @xmath46 with @xmath47 simple algebra shows that for a generic time interval @xmath33 , @xmath48+{j^{(1)}}(t,\\delta t),\\ ] ] where @xmath49 is still given by eqs .",
    "( 7)-(8 ) with the new @xmath26 and @xmath27 , and @xmath50 the integral @xmath51 over the last time - step can be evaluated with a simple trapezoidal rule , obtaining in this case @xmath52    as anticipated above , the extension of the scheme of eqs .",
    "( 8) and ( 14 ) to functions @xmath41 with integer @xmath53 is straightforward by using the binomial theorem , and the resulting recursive formula for the functions @xmath54 involves the evaluation and the storing of the functions @xmath55 for @xmath56 .",
    "one may ask why the method works , i.e. , why it is possible for this set of functions to evaluate a convolution integral over the whole sfh just by keeping track ( for each of them ) of @xmath57 values relative to the previous time . the reason is easily explained following the general argument in the appendix : here we just stress that if the kernel @xmath11 obeys a linear ordinary differential equation ( ode ) with constant coefficients , _ then also @xmath58 obeys a linear ode with constant coefficients of the same degree _ , so that integration of eq . ( 3 ) is equivalent to the integration of the associated ode , and the number of needed initial data is given by the order of the equation . for example , in the case of a single function @xmath41 the order of the ode is @xmath57 , the number of quantities needed to be stored to evaluate @xmath59 .",
    "when @xmath11 is given by a sum of functions the argument is technically more complicated , but conceptually identical , and following the appendix one can show that the specific case of eq .",
    "( 11 ) requires the storing of @xmath60 values at the previous time . for the more mathematically inclined readers , in the appendix we derive the ode for @xmath61 in the case of the most general combination of functions @xmath41 with arbitrary @xmath42 , and we also briefly comment on the relation of the present method with the theory of green functions .",
    "in the example considered here for illustrative purposes of the method , we evaluate @xmath11 from eq .",
    "( 2 ) by using @xmath15 as given by van den hoeck & groenewegen ( 1997 ) for low and intermediate mass stars ( @xmath62 ) , and by woosley & weaver ( 1995 ) for massive stars ( @xmath63 ) . in particular",
    ", the adopted @xmath64 holds for a stellar metallicity @xmath65 , very close to the concordance solar value of 0.015 ( e.g , lodders 2003 ) . for the imf",
    "we adopt a kroupa et al .",
    "( 1993 ) @xmath6 with @xmath66 and @xmath67 , while the stellar lifetimes are taken from padovani & matteucci ( 1993 ) .",
    "of course , the general scheme of the method is independent of the specific choices made , and different prescriptions for the properties of the ssp can be considered as well ( e.g. , ciotti et al .",
    "1991 , pellegrini 2012 ) .      for the ssp described above fig .",
    "1 ( top panel , solid line ) shows the exact normalized mass return rate @xmath11 calculated according to eq .",
    "( 2 ) ( top panel , solid line ) , and the corresponding returned cumulative mass fraction as a function of cosmic time ( bottom panel , solid line ) @xmath68 the bottom panel also includes the quantity @xmath69 , i.e. the fraction of mass locked up in living stars and remnants ( portinari et al .",
    "2004 ) . in this example , @xmath70% and @xmath71% . for comparison",
    ", the dotted line represents the cumulative returned mass fraction calculated assuming the ira , and it is apparent how this assumption leads to overestimate the mass return of a ssp , in particular at early times .    in fig .  1 ( top panel , short dashed lines ) we also show the separate contribution of the six fit components in eq .",
    "( 11 ) , whose parameters @xmath26 and @xmath27 are reported in tab .",
    "1 , together with their sum ( long dashed line ) . as can be seen from tab .",
    "1 , the best fit parameters obey @xmath72 i.e. the fit in eq . ( 11 ) conserves the total mass almost perfectly .",
    "the plot in terms of the logarithm of time allows to appreciate how well the fit reproduces the exact @xmath11 , with the exception of the few myrs after the ssp formation .",
    "this is due to the fact that the exact @xmath11 presents a discontinuity at the time corresponding to the lifetime of the highest mass stars ( 4 myr for a @xmath73 star ) : in any case , the functions @xmath74 allow to reproduce the initial rise better than pure exponentials , and even better results would be obtained by using functions @xmath41 with larger values of @xmath42 . here , for presentation purposes , we restrict to @xmath43 as a compromise between accuracy and algebraic simplicity .    the overall impact of the initial discontinuity on the resulting mass return rate is negligible , as can be seen from fig .",
    "2 . in the left - hand panels",
    "we show again the exact rate @xmath11 obtained by evaluation of eq .",
    "( 2 ) ( top panel , dotted line ) compared to the rate obtained by summing the six fit components ( red solid line ) , and the relative error between the fit function and the exact rate @xmath11 as a function of time ( bottom panel ) . in the right - hand panels we show the cumulative returned mass @xmath75 and the associated relative error for the exact @xmath11 ( dotted line ) , for the new method ( red solid line ) , and in the case of ira ( blu dashed line ) , respectively .",
    "note how the relative error of the new method is significantly smaller than the one obtained with the ira , especially at early times .",
    ".parameters of the six functions @xmath76 used for the fit of the @xmath11 considered in section 3.1 . [ cols= \"",
    "< , < \" , ]     [ tab_exp ]      we now move to consider the case of the mass return rate of a multiple stellar population originated by a complex sfh .    in order to test the performance ( in terms of computational speed and accuracy ) of the new method , we consider an artificial case , characterized by a large number of star - formation bursts of random amplitude .",
    "this case is relevant since it mimics the sfhs commonly encountered in sams , and which are typical of systems undergoing a large number of mergers and interactions , such as the ones resulting from the intricate merging trees of giant galaxies ( somerville & kolatt 1999 ; lanzoni et al .",
    "2000 ; calura & menci 2009 ; yates et al .",
    "2013 ) , or star formation induced by agn activity in the inner regions of the host systems ( ciotti & ostriker 2007 ) . in practice",
    ", we adopt a sfh @xmath18 in which , at each time - step , @xmath77 is extracted randomly from a normal distribution with standard deviation @xmath78 . in the following experiment ,",
    "the time - step is kept constant , @xmath79 myr , suited to resolve the time contribution to the mass return rate of the most massive stars at early times ( in hydrodynamical simulations considerably shorter time - steps are common , down to @xmath80 yr or less ) .",
    "the behaviour of @xmath22 is visualized by the blue dashed line in fig .  3 ( top - left panel ) ,",
    "representing the mass return rate in the ira ( which is proportional to @xmath20 , see eq .",
    "the resulting mass return rate is also shown for the the standard method ( black solid line ) and with the new method ( red line ) : the relative errors with respect to the exact values of the mass return rate are shown in the bottom - left panel . the most striking feature is the large scatter in @xmath81 ( more than two orders of magnitude ) compared to the exact rate , which instead is almost perfectly matched by the rate obtained with the new method .",
    "the relative errors represented in the bottom - left panel quantify the performance of ira and of the new method : in general , the peaks in the relative errors of the ira are related with peaks in the instantaneous sfh @xmath18 .",
    "such peaks are also present in the mass return computed with the new method , as a consequence of the initial discontinuity following each burst , as described above .",
    "however , the amplitude of these error is significantly smaller than in the ira case , as apparent .    the cumulative mass return for the multi - burst sfh",
    "is shown in the right panels of fig .  3 , where the quantity @xmath75 is normalized to the stellar mass formed over the entire simulation .",
    "the top - right panel shows this quantity for the exact case , for the ira case , and for the new method , while the bottom - right panel shows the relative error between the ira and the exact case , and between the new method and the exact case .",
    "note the remarkable accuracy of the new method in the multiple population case , actually even better than in the case of a ssp .",
    "this is not surprising , as for a multiple stellar population the ira is , in practice , always in the most critical regime ( just after a burst ) , and its error is of a magnitude similar to that presented at early times in fig .",
    "2 ( bottom right panel ) .",
    "as already discussed , the ira presents considerable advantages in terms of computational time and does not require any storage regarding ages and metallicities of composite stellar populations .",
    "essentially , at any time , the mass return rate is calculated directly from the physical properties of the system at that particular time , i.e. directly from the instantaneous value of the star formation rate ( see eq .",
    "the major problem with the ira is that it breaks down at short times after a starburst event , when the very short characteristic heating and cooling times would lead to large overestimates of the mass return rate , that in turn can seriously affect the numerical computations by altering the available mass budget .",
    "the method presented in this paper offers the possibility to compute the mass return rate for arbitrarily complicated sfhs , at a computational cost considerably lower than that required when the exact method is used , yet maintaining the full accuracy .",
    "the computational gain of the new method with respect to the standard method can be estimated by considering the number of needed operations .",
    "the computational time of the exact calculation scales with the total number of time - steps @xmath82 as @xmath83 , since @xmath84 operations are needed to compute the mass return rate at the @xmath84-th time - step . with the new method , @xmath85 , because at each time the @xmath57 integrals over the last time step @xmath86 must be computed for each of the @xmath40 functions used in the fit .",
    "therefore , @xmath87 : when the other parameters are fixed , the computational gain of the new method over the standard method increases linearly with @xmath82 , i.e. it increases for decreasing @xmath33 ( at fixed total time span ) .",
    "note that the cpu time of the new method scales with @xmath82 as in the ira .",
    "the actual computational gain of the new method obtained in numerical experiments similar to that described in sect .",
    "3.2 , where different @xmath33 are adopted , is shown in fig .  4 , plotting the cpu time ( in arbitrary units ) required to evaluate the mass return for the exact method ( dotted line ) , the new method ( red line ) , and the ira ( dashed line ) , as a function of the total number of time - steps @xmath82 .",
    "for our reference case with @xmath88 myr , we have @xmath89 , @xmath90 , @xmath43 , so we expect @xmath91 .",
    "in fact , the experiment shows that the cpu time for the new method is a factor @xmath92 shorter than for the standard method , in agreement with the analytic estimate . from fig .",
    "4 it is also apparent that the actual scaling with @xmath82 nicely follows the expected scaling ( @xmath93 , @xmath94 ) .",
    "we remark again that in hydrodynamical simulations the actual @xmath33 can easily be one or two orders of magnitude shorter than 1 myr , so that the gain of the new method will increase accordingly ; moreover , this further gain will also be multiplied by the number of grid points .",
    "the mass returned to the ambient medium by evolving stellar populations represents a significant fraction of their initial mass ( 20% to 30% for realistic imfs ) , and thus being a non negligible contribution to the evolution of stellar systems .",
    "for example , in elliptical galaxies the total mass of the returned gas is almost two orders of magnitude larger than the observed masses of central smbhs , requiring important agn feedback effects to prevent accretion in absence of other mechanisms able to eject the metal rich gas from the galaxies ( e.g. , ciotti & ostriker 2001 ) .    in numerical problems dealing with the evolution of stellar populations and their mass return , when the characteristic times are longer than the stellar evolutionary times ,",
    "the ira is a useful approximation of the convolution integral describing mass return , allowing for fast and accurate computations .",
    "however , in hydrodynamical studies of star formation , of the interplay between central starbursts and agn feedback in the coevolution of galaxies and their central smbhs , and of the origin of multiple stellar populations in globular clusters , the dominance of short characteristic times ( @xmath95 yr of even less ) , coupled with thousands ( or more ) spatial grid points , requires the detailed evaluation of the convolution integral .",
    "this makes the simulations excessively demanding in terms of computer memory and computational time , due to the need of storing the whole sfh at each grid point and to the number of evaluations to be performed increasing quadratically with the number of time steps .    in order to overcome these problems we developed a fast and accurate method to evaluate the mass return rate from stellar populations with arbitrarily complicated sfhs",
    "the method presents great computational advantages over the direct evaluation of the convolution integral ( the computation time scales linearly with the number of time steps ) , yet its accuracy is much better than that achievable with the ira , especially in the case of multiple populations , when the clock of the mass return rate is reset at each star formation event . the new method can be easily implemented in semi - analytical models and in grid - based hydrodynamical simulations , and it requires to fit the mass return rate from the adopted ssp by means of simple functions , solutions of linear odes with constant coefficients .",
    "we have shown how these functions allow to evaluate , at any time - step , the mass return rate directly from its value at the previous time step , plus a contribution depending only on the star formation over the last time step .",
    "the general mathematical framework is presented in the appendix . in this paper , as a specific application , we have shown that the use of a linear combination of the functions @xmath96 is enough to achieve very accurate results : with arbitrarily complicated sfhs , the computed mass return rate from the resulting multiple stellar population deviates by amounts of a few percent from the exact value , and this avoiding the storage of the sfh itself .",
    "we conclude by noticing that the presented method , applying in general to the treatment of time convolution integrals , can be also used in problems different from that discussed in this paper , for example to study the return of single chemical elements from multiple stellar populations ( as in starbursts ) , or to describe the time evolution of the snia rate in star forming events .",
    "we are grateful to laura greggio , francesca matteucci , alvio renzini and monica tosi for useful comments . financial support from prin",
    "miur 2010 - 2011 , project `` the chemical and dynamical evolution of the milky way and local group galaxies '' , prot .",
    "2010ly5n2 t is acknowledged .",
    "99 baugh c. m. , 2006 , rep .",
    "phys . , 69 , 3101 bender , c.m . , & orszag , s.a . , 1978 , `` advanced mathematical methods for scientists and engineers '' , mcgraw - hill ( new york ) calura f. , menci n. , 2009 , mnras , 400 , 1347 chabrier , g. , 2003 , pasp , 115 , 763 ciotti , l. , dercole , a. , pellegrini , s. , renzini , a. , 1991 , apj , 376 , 380 ciotti , l. , & ostriker , j.p . , 1997 , apjl , 487 , 105 ciotti l. , ostriker j.p . , 2001 , apj , 551 , 131 ciotti , l. , ostriker , j.p . , 2007 , apj , 665 , 1038 ciotti , l. , & ostriker , j.p . , 2012 , in `` hot interstellar matter in elliptical galaxies '' , d.w .",
    "kim and s. pellegrini eds .",
    ", astrophys . and",
    "space sci .",
    "library , vol .",
    "378 , p.83 ( springer ) dercole , a. , dantona , f. , carini , r. , vesperini , e. , & ventura p. , 2012 ,",
    "mnras , 423 , 1521 greggio , l. , 2005 , a&a , 441 , 1055 ince , e.l . , 1956 `` ordinary differential equations '' , dover ishibashi , w. , & fabian , a.c . , 2012 , mnras , 427 , 2998 kroupa p. ,",
    "tout c. a. , gilmore g. , 1993 , mnras , 262 , 545 krumholz , m. r. 2011 , in aip conf .",
    "ser . , 1386 , eds .",
    "e. telles , r. dupke , & d. lazzaro , 9 lanzoni b. , mamon g. a. , guiderdoni b. , 2000 , mnras , 312 , 781 lodders k. 2003 , apj , 591 , 1220 lusso e. , ciotti l. , 2011 , a&a , 525 , 115 maraston c. , 1998 , mnras , 300 , 872 mathews , w.g . ,",
    "& brighenti , f. , 2003 , araa , 41 , 191 matteucci f. , 2001 , astrophys .",
    "space sci .",
    "library vol .",
    "253 , the chemical evolution of the galaxy .",
    "kluwer , dordrecht , p. 293 matteucci f. , & greggio l. , 1986 , a&a , 154 , 279 norman , c. , & scoville , 1988 , apj , 332 , 163 padovani p. , & matteucci f. , 1993 , apj , 416 , 26 pellegrini s , 2012 , in `` hot interstellar matter in elliptical galaxies '' , d.w .",
    "kim and s. pellegrini eds .",
    ", astrophys . and",
    "space sci .",
    "library , vol .",
    "378 , p.21 ( springer ) piotto , g. et al . , 2007 , apjl , 661 , 53 portinari l. , moretti a. , chiosi c. , sommer - larsen j. , 2004 , apj , 604 , 579 renzini , a. , 2008 , mnras , 391 , 354 scalo j. m. , 1986 , fundam . cosmic phys . , 11 , 1 shcherbakov , r.v . , wong , k .- w . , irwin , j.a . , & reynolds , c.s . ,",
    "preprint ( arxiv1308.4133 ) somerville r. s. , kolatt t. s. , 1999mnras.305 , .1s starkenburg e. , helmi , a. ,",
    "de lucia , g. , li , y .- s . ,",
    "navarro , j. f. , font , a. s. , frenk , c. s. , springel , v. , vera - ciro , c. a. , white , s. d. m. , 2013 , mnras , 429 , 725 tabor g , & binney , j. , 1993 , mnras , 263 , 323 tinsley b. m. , 1980 , fund . cosmic phys . , 5 , 287 tosi m. 1988 , a&a , 197 , 33 van den hoeck l. b. , groenwegen m. a. t. , 1997 , a&as , 123 , 305 woosley s. e. , weaver t. a. 1995 , apjs , 101 , 181 yates r. m. , henriques b. , thomas p. a. , kauffmann g. , johansson j. , white s. d. m. , 2013 , mnras , 435 , 3500 zubovas , k. , nayakshin , s. , king , a. , & wilkinson , m. , 2013 , mnras , 433 , 3079",
    "for ease of notation we rewrite eq .",
    "( 3 ) as @xmath97 where the meaning of @xmath98 and @xmath99 is obvious , and the lower limit of integration allows full generality in the treatment .",
    "let assume that @xmath99 is a solution of a homogeneous , constant - coefficients linear ode of order @xmath42 , i.e. , @xmath100 where @xmath101 are constants , @xmath102 , and @xmath103 .",
    "taking for granted that all the technical requirements of convergence and regularity are satisfied , mathematical induction proves that the time derivatives of the function @xmath98 can be written as @xmath104 for @xmath105 .",
    "after multiplication of eq .",
    "( a3 ) by @xmath101 and summation over @xmath31 , from eq .",
    "( a2 ) it follows that @xmath98 also obeys the generally non - homogeneous constant - coefficients linear ode of order @xmath42 @xmath106 note that the assumption of constant coefficients is important here , because the vanishing of the resulting linear combination of integrals at the r.h.s .",
    "( a3 ) rests on two facts : 1 ) the @xmath101 can be carried under sign of integration ( this would be true also for time - dependent coefficients @xmath101 ) , and 2 ) if @xmath107 is a solution of eq .",
    "( a2 ) , then also @xmath108 is a solution ( this in general would not be true for time - dependent @xmath101 ) . therefore , if the kernel @xmath11 is solution of a constant - coefficients linear ode of order @xmath42 , also the mass return rate @xmath58 can be represented as a solution of constant - coefficients linear ode of order @xmath42 , and so @xmath42 integration constants are required for its complete determination .",
    "suppose now to consider the following generalization of eqs .",
    "( 5 ) and ( 11 ) @xmath109 where @xmath110 for @xmath111 , @xmath112 for @xmath113 , and for @xmath114 the coefficients @xmath115 may be zero or not ; without loss of generality we assume that all the @xmath27 are different .",
    "note that in eq .",
    "( a5 ) we consider the possibility that more than one power term @xmath116 is associated with a given @xmath27 , and that the maximum values @xmath117 differ for different @xmath27 . in this formalism eq .",
    "( 5 ) is obtained for @xmath118 and @xmath119 ( @xmath120 ) , while eq . ( 11 ) for @xmath121 , @xmath122 , and @xmath123 ( @xmath124 ) .",
    "we now construct the ode for @xmath99 in eq .",
    "( a5 ) , so that also the ode for the mass return rate @xmath61 can be explicitly obtained in this general case accordingly to eq .",
    "( a4 ) . from the theory of odes ( e.g. , ince 1956 )",
    "it is known that the function @xmath41 is solution of a constant - coefficients linear ode , where the root @xmath125 of the associated characteristic polynomial has ( at least ) algebraic multiplicity @xmath57 .",
    "therefore , the minimum characteristic polynomial of the ode admitting eq .",
    "( a5 ) as solution is @xmath126 and the corresponding ode of order @xmath127 is obtained by the substitution @xmath128 .",
    "a final comment is in order . due to the formal similarity of eq .",
    "( a1 ) with the convolution integral appearing in the theory of green functions , one may ask whether @xmath129 ( where @xmath130 is the heaviside step function ) is the green function , vanishing for @xmath21 , of the ode ( a2 ) . the answer is negative , as @xmath107 in general lacks the needed regularity at @xmath10 ( e.g. , bender & orszag 1978 ) .",
    "in fact , from the request of vanishing for @xmath21 , it follows that the function @xmath131 is a genuine green function if and only if the time derivative of order @xmath132 of @xmath107 evaluated at @xmath10 presents a finite jump , while all the remaining derivatives of @xmath107 up to the order @xmath133 evaluated at @xmath10 vanish .",
    "these requests impose constraints on the values @xmath115 . however , in our method the @xmath115 are given as best - fit parameters of the kernel function ( in practice , by the request of reproducing @xmath11 ) , so that @xmath107 in general does not satisfy the regularity conditions at @xmath10",
    ". however , it is easy to show that in the case of a single - component fit ( @xmath134 ) , the function @xmath135 with @xmath53 _ is _ the green function for the corresponding linear ode of order @xmath57 ."
  ],
  "abstract_text": [
    "<S> the mass returned to the ambient medium by aging stellar populations over cosmological times sums up to a significant fraction ( 20% - 30% or more ) of their initial mass . </S>",
    "<S> this continuous mass injection plays a fundamental role in phenomena such as galaxy formation and evolution , fueling of supermassive black holes in galaxies and the consequent ( negative and positive ) feedback phenomena , and the origin of multiple stellar populations in globular clusters . in numerical simulations </S>",
    "<S> the calculation of the mass return can be time consuming , since it requires at each time step the evaluation of a convolution integral over the whole star formation history , so the computational time increases quadratically with the number of time - steps . </S>",
    "<S> the situation can be especially critical in hydrodynamical simulations , where different grid points are characterized by different star formation histories , and the gas cooling and heating times are shorter by orders of magnitude than the characteristic stellar lifetimes . in this paper </S>",
    "<S> we present a fast and accurate method to compute the mass return from stellar populations undergoing arbitrarily complicated star formation histories . at each time </S>",
    "<S> - step the mass return is calculated from its value at the previous time , and the star formation rate over the last time - step only . </S>",
    "<S> therefore in the new scheme there is no need to store the whole star formation history , and the computational time increases linearly with the number of time - steps .    </S>",
    "<S> [ firstpage ]    galaxies : stellar content ; galaxies : abundances ; galaxies : ism ; methods : numerical </S>"
  ]
}