{
  "article_text": [
    "mechanical ventilation is the most frequently used life - sustaining intervention in the intensive care unit ( icu ) , where approximately 50% of patients receive ventilatory support @xcite . at some point in their management , many patients on mechanical ventilation ( mv ) are described as  fighting their ventilator \" .",
    "this jargonistic expression is used to indicate a mismatch between patient respiratory efforts and ventilator  breaths \" .",
    "this form of disharmony between patient and ventilator results in an increased work of breathing and is a major source of discomfort for the patient with some deleterious effects such as dyspnea and anxiety .",
    "dyspnea and anxiety are major drivers of post - traumatic stress disorders frequently observed in patients who survive the icu @xcite .",
    "therefore , it is crucial to detect patient - ventilator disharmony as early as possible .",
    "currently , this relies on monitoring of physiological signals generated indirectly ( pressure , air flow ) or directly ( electromyography ) by the respiratory muscles in response to the descending neural drive to breathe .",
    "it is generally assumed that ventilatory support should be adapted to the neural drive to breathe  @xcite .",
    "some approaches address this issue by using the diaphragmatic emg ( e.g. the neurally adjusted ventilatory assist or nava  @xcite ) .",
    "nevertheless , these techniques fail to take into account the fact that , under certain circumstances , the automatic respiratory activity of the brain stem is supplemented by respiratory - related cortical circuits .",
    "indeed , inspiratory loading in awake humans elicits a cortical response that can be observed in eeg signals  @xcite .",
    "such responses have been found to correlate with respiratory discomfort in healthy subjects fighting a ventilator  @xcite .",
    "these observations give rise to the prospect of an effective brain - ventilator interface ( bvi ) that would target the neural correlates of respiratory discomfort rather than the automatic drive to breathe  @xcite .",
    "current neuroscience research attempts to understand how brain functions result from dynamic interactions in large - scale cortical networks , and to further identify how cognitive tasks or brain diseases contribute to reshape this organization  @xcite .",
    "covariance analyses of brain data are widely used to elucidate the functional interactions between brain regions during different brain states .",
    "the relevance of covariance matrices as a feature for bci has been already assessed  @xcite and they constitute a very appropriate choice given their ability to reflect spatio - temporal dynamics in eeg . in this paper , we use elements of differential geometry to evaluate the ability of eeg covariance matrices to characterize changes in respiratory states in healthy subjects .      the use of brain computer interfaces ( bci ) is increasingly common in clinical environments as a technology to improve patient communication and rehabilitation using brain signals @xcite . however , the application of bci in the respiratory context has not yet been explored .    in this work ,",
    "we propose a framework which provides the basis of a brain - ventilator interface ( see figure [ fig : plan_bvi ] ) .",
    "a first possible implementation consists of an open loop configuration that generates an output signal to trigger an alarm in the case of breathing disharmony .",
    "the second implementation is a more advanced version that could generate a continuous output signal in a closed loop to directly adapt ventilator parameters to the patient s needs .",
    "the different blocks in the proposed bvi are as follows :    1 .",
    "acquisition : set of electrodes , amplifiers and a / d converter providing digitized eeg signals .",
    "pre - processing : improves signal - to - noise ratios in eeg signals by applying artifact correction / rejection and/or filters .",
    "feature extraction : sample covariance matrices ( cms ) are obtained from segmented , pre - processed signals .",
    "4 .   classification : cms are labelled according to two possible classes : normal and altered breathing .",
    "detection of anomalous respiratory states is achieved by one - class learning , measurement of the distance between a number of reference matrices learned during reference condition and the cm corresponding to a particular signal epoch .",
    "since cms do not lie in vector space , appropriate distance metrics must consider their natural geometry .",
    "translation : external application that converts the binary signal from the classifier to an alarm or ventilator command .",
    "the present paper focuses on the signal processing aspects of the bvi pre - processing , feature extraction and classification blocks as a detector of respiratory - related activities compatible with breathing discomfort .",
    "the framework is validated with eeg from healthy subjects under two breathing constraints to emulate patient - ventilator disharmony .",
    "the reliability and performances of our method are also compared with those obtained by a common spatial patterns ( csp ) method in combination with linear discriminant analysis ( lda ) .    the experimental protocol and data",
    "are detailed in section [ database ] .",
    "section [ meth ] describes the different signal processing blocks of the bvi , including our riemann geometry based classifier and other standard classification methods that use eeg and breathing signals .",
    "section [ setup ] studies bvi settings for optimal detection of breathing discomfort and section [ res ] provides the experimental results and evaluation of the bvi .",
    "finally , we conclude the paper with a discussion in section [ concl ] .",
    "the database is composed of nine healthy subjects ( 21 - 29 years ; 5 women ) with no prior experience with respiratory or neurophysiology experiments ( for more details see @xcite ) . according to the declaration of helsinki , written informed consent",
    "was obtained from each subject after explanation of the study , which was approved by the local institutional ethics committee ( comit de protection des personnes ile - de - france vi , groupe hospitalire piti - salptrire , paris , france ) .",
    "subjects were sitting in a comfortable chair and breathed continuously through a mouthpiece .",
    "they were asked to avoid body and head movements .",
    "they were distracted from the experimental context by watching a movie during the entire experiment , on a screen placed in front of them . to minimize emotional interference ,",
    "the movie was a neutral animal documentary .",
    "it is worthy to note that , even though many icu patients are supine , clinical practice guidelines recommend that mechanically ventilated patients in the icu should be semi - supine , or semi - seated , to decrease the risk of respiratory infections and increase patient comfort  @xcite .",
    "electroencephalographic activity was recorded via surface electrodes ( acticap , brainproducts gmbh , germany ) using 32 electrodes according to the standard 10 - 20 montage and sampled at 2500 hz .",
    "impedance between electrodes and skin were set below 5 k@xmath0 .",
    "the mouthpiece was connected to a pneumotachograph ( hans ruldoph inc .",
    ", mo , usa ) and a two - way valve to measure air flow and attached , when required , an inspiratory load ( range 18 - 25 cmh20 ) .    the experiment was designed to activate cortical regions by altered breathing and consisted of three parts :    1 .",
    "normal , spontaneous ventilation ( sv condition ) .",
    "breathing is controlled automatically by the autonomous nervous system without cortical contribution .",
    "2 .   voluntary brisk inhalations or sniffs ( sn condition ) .",
    "breathing movements are planned before execution , thus motor and pre - motor cortical regions are solicited .",
    "3 .   inspiratory loaded breathing ( ld condition ) .",
    "ventilatory muscles perform a supplementary effort to overcome an inspiratory threshold load to maintain adequate air flow , a condition known to engage cortical networks  @xcite .",
    "in contrast to the sv condition , where breathing is comfortable , ld is associated with respiratory discomfort . in a clinical context",
    ", sv would correspond to patient - ventilator harmony , whereas ld condition would correspond to patient - ventilator disharmony .",
    "sn can be considered as a positive control condition where cortical control is expected .",
    "for all subjects , 10 minutes of eeg was recorded for each condition , i.e. 10 min of sv , 10 min of sn and 10 min of ln .",
    "the experiments were well tolerated by all subjects and no intervention was necessary to modify the amount of load or sniff pattern during the recordings . hence , during 10-minute recordings for each condition , no relevant changes occurred within each of these 10-min blocks regarding experimental conditions or subject behavior .",
    "the purpose of this block is to enhance motor cortical activity , whose main rhythms are within @xmath1 and @xmath2 bands @xcite .",
    "therefore , signals were band - pass filtered by a linear phase fir filter ( see section [ ch_freq ] for more details regarding frequency selection ) .",
    "data segments with artifacts due to repetitive eye blinks and ocular movements were visually detected and removed from the original eeg dataset .",
    "then , signals were down - sampled to 250 hz and segmented in 5 second sliding , 50% overlapped windows to reduce computational cost in subsequent blocks .",
    "this time interval is in concordance with the slow breathing dynamics ( a breath every 2.5 to 5 seconds ) .      as mentioned above ,",
    "the basis to classify the breathing state in the bvi are sample covariance matrices .",
    "the feature extraction block processed eeg data in epochs of @xmath3 samples and @xmath4 channels , as a matrix @xmath5 , and then transformed to a sample covariance matrix @xmath6 .",
    "the latter was computed by the unbiased estimator : @xmath7 where the superscript @xmath8 denotes the matrix transpose .    by construction , @xmath9",
    "are symmetric and positive - definite matrices ( spd ) that do not lie in a vector space but on a riemannian manifold @xcite .",
    "therefore , previous methods defined on a euclidean structure are not longer adequate .",
    "the correct manipulation of these spd matrices requires the application of riemannian geometry concepts , described in section [ riemann ] .",
    "thanks to the ability of covariance matrices to capture eeg spatial dynamics , a one - class approach can be chosen to solve the classification problem in a bvi .    in one - class algorithms ,",
    "the availability of the labels from only one class is enough to classify instances from a second class , as the latter can be mapped in a different ( distant ) region of the space representation . in our framework ,",
    "motor cortex activation provoked during uncomfortable breathing should be different to that underlying normal , comfortable breathing ( absence of motor cortical activity ) .",
    "the objective of the classifier is to learn from @xmath10 data samples of the reference class sv ( @xmath11 ) in order to label new trials @xmath12 in two classes , @xmath13 , which correspond to breathing comfort ( sv condition ) and discomfort ( sn or ld conditions ) , respectively .    during the learning process ,",
    "the algorithm first finds @xmath14 matrices , subsequently called prototypes , serving as reference to perform classification .",
    "those prototypes constitute @xmath14 centers from the ensemble of covariance matrices @xmath15 and they are estimated by means of a general @xmath14-means clustering algorithm :    1 .",
    "initialize the prototypes @xmath16 , @xmath17 by random selection of @xmath14 matrices from @xmath15 , 2 .   for each sample covariance matrix ,",
    "compute its distance @xmath18 to all the prototypes and assign it to the closest one in order to form the cluster @xmath19 : @xmath20 3 .   update each prototype by averaging points in @xmath19 as @xmath21 for points lying in a vector space",
    ", @xmath16 corresponds to the arithmetic mean of points in @xmath19 4 .",
    "go to step ( 2 ) until convergence ( e.g. the assignments no longer change ) is achieved .",
    "the resulting prototypes @xmath16 represent the class @xmath22 , and are then used to classify the new unlabelled data @xmath23 ( sub - index @xmath24 denotes the number of the @xmath3-sample window ) according to : @xmath25 where @xmath26 is the distance to the closest reference prototype , @xmath27 ; and @xmath28 is a scalar that can be adjusted to a performance criterion , like a statistical significance or a desired specificity / sensitivity value , for instance .",
    "classification performance was measured by the area under the curve ( auc ) of the receiver operating characteristic ( roc ) .",
    "auc values range from 0.5 ( a random classification ) to 1 ( perfect classification ) .",
    "all auc values were computed by applying 10-fold cross validation , excluding the learning period in the classification .      within an euclidean framework ,",
    "the @xmath14-means algorithm divides the dataset into groups and attempts to minimize the euclidean distance between samples labeled to be in a cluster and a point designated as the arithmetic mean of that cluster .",
    "nevertheless , the spd manifold is not a linear space with the conventional matrix addition operation .",
    "a natural way to measure closeness on a manifold is by considering the geodesic distance between two points on the manifold  @xcite .",
    "such distance is defined as the length of the shortest curve connecting the two points . as an example , consider the earth s surface as a manifold : the riemannian distance between the two poles is given by a meridian , while the euclidean distance corresponds to the straight line going through the earth s core from pole to pole .    in the space of sdp matrices ,",
    "the clustering algorithm must minimize the geodesic distances between each point of the manifold ( the covariance matrices @xmath29 ) and the reference matrix @xmath16 .",
    "each cluster center can be then obtained by an averaging process that employs the intrinsic geometrical structure of the underlying set .    derived from different geometrical , statistical or information - theoretic considerations , various distance measures",
    "have been proposed for the analysis of spd matrices  @xcite .",
    "although many of these distances try to capture the non - linearity of spd matrices , not all of them are geodesic distances .",
    "the space of spd matrices , @xmath30 , constitutes a differentiable riemannian manifold @xmath31 of dimension @xmath32 . at any point @xmath33",
    "there is a tangent euclidean space , @xmath34 .",
    "let two points @xmath35 and @xmath36 be two points on the tangent space ( e.g. the projection of two spd matrices ) , the scalar product in the tangent space at @xmath37 is defined by @xmath38 that depends on point @xmath37 .",
    "the logarithmic map that locally projects a covariance matrix @xmath9 onto the tangent plane is given by : @xmath39 where @xmath40 is the matrix logarithm operator .",
    "projecting sdp matrices onto @xmath34 is advantageous because this tangent space is euclidean and distance computations in the manifold can be well approximated by euclidean distances in @xmath34 .",
    "the inverse operation that projects a point @xmath41 of the tangent space back to the manifold @xmath31 is given by the exponential mapping : @xmath42    in this paper , we have employed the two most widely used distance measures in the context of riemannian manifolds : the affine - invariant distance  @xcite and the log - frobenius distance , also referred to as log - euclidean distance  @xcite . for comparative purposes ,",
    "we have also used an euclidean metric .      on the space of real square matrices",
    ", we have the frobenius inner product @xmath43 and the associated metric : @xmath44 given a set of @xmath45 real square matrices @xmath46 , their arithmetic mean is given by : @xmath47      using  ( [ e1 ] ) , the riemannian distance between two spd matrices can be computed as : @xmath48 this metric has several useful theoretical properties : it is symmetric and satisfies the triangle inequality . furthermore , it is scale , rotation and inversion invariant  @xcite .    to find the mean of a set of @xmath45 covariance matrices @xmath46 ,",
    "the distance @xmath49 needs to be applied in the following expression @xcite : @xmath50 although no closed - form expression exists , this ( geometric ) mean can be computed efficiently using an iterative algorithm .",
    "the geometric mean in @xmath30 converges into a unique solution @xcite and can be computed efficiently by the algorithm described in  @xcite .",
    "the log - euclidean distance between two spd matrices is given by  @xcite : @xmath51 this metric maps spd matrices to a flat riemannian space ( of zero curvature ) so that classical euclidean computations can be applied  @xcite . under this metric",
    ", the geodesic distance on the manifold corresponds to a euclidean distance in the tangent space at the identity matrix .",
    "this metric is easy to compute and preserves some important theoretical properties , such as scale , rotation and inversion invariance  @xcite .    given a set of @xmath45 covariance matrices @xmath46 , their log - euclidean mean exists and is uniquely determined by  @xcite : @xmath52      in this paper , we have also evaluated the detection of altered respiratory states using eeg and air flow - based features as inputs for one - class support vector machine ( ocsvm ) classifiers .",
    "although one - class classification , or novelty detection , is more appropriate for the clinical monitoring of physiological condition in ventilated patients ( i.e. altered breathing epochs may be detected as departures from `` normal '' breathing state ) , we have compared our results with those obtained from a common spatial pattern ( csp ) method in combination with linear discriminant analysis ( lda ) to detect altered breathing from eeg .",
    "csp is a two - class oriented approach that needs a - priori labelled data from two classes previously defined ( the normal and the altered breathing conditions ) to train the classifier , while our one - class approach learns from a single training set containing only normal respiratory epochs .",
    "however , we have included these methods in the comparative study as they constitute a standard in brain computer interfacing @xcite .",
    "one - class support vector machines is a very popular machine learning technique used as outlier or novelty detector for a variety of applications  @xcite . in ocsvm ,",
    "the support vector model is trained on data that has only one class , which represents the _ normal _ class .",
    "this model attempts to learn a decision boundary that achieves the maximum separation between the points and the origin .",
    "a ocsvm firstly uses a transformation function defined by a kernel function to project the data into a higher dimensional space .",
    "the algorithm then learns a decision boundary that encloses the majority of the projected data , and that can be applied to the outliers detection problem .",
    "more details on the algorithmic aspects of one - class svms can be found in  @xcite . to guarantee the existence of a decision boundary we have used here a gaussian kernel : @xmath53 where @xmath54 and @xmath55 denote two feature vectors and the parameter @xmath56 is set to be the median pairwise distances among training points  @xcite .      for this classifier",
    ", feature vectors @xmath57 were extracted by computation of covariance matrices @xmath58 in epoched data @xmath23 followed by determination of the vector form of the upper triangular part of @xmath58 .",
    "air flow features were computed , as for eeg classifiers , in 50% overlapped @xmath3-sample windows . in this case ,",
    "feature vectors @xmath57 are composed of six air flow descriptors computed in each window @xcite : peak value ( l / s ) , average flow ( l / s ) , total volume ( l ) , flow variance , skewness and kurtosis .",
    "after an exhaustive feature selection procedure ( testing the classifier with all @xmath59 possible combinations ) using 10-fold cross validation , the greatest averaged aucs was provided by the combination of 3 features : air flow peak value , variance and skewness .",
    "csp is a widely used spatial filtering technique in bcis to find linear combinations of electrodes such that filtered eeg maximizes the variance difference between two classes @xcite .",
    "the computation of csp yields a projection matrix @xmath60 whose column vectors @xmath61 ( @xmath62 ) , called spatial filters , can be considered as an operator that transforms eeg to `` source '' components .",
    "the matrix @xmath63 contains the so - called spatial patterns @xmath64 in its columns which can be considered as eeg source distribution vectors . a standard procedure to extract features in eeg epoched data ( @xmath23 ) by csp consists of computation of the log - variances of projected @xmath23 on the spatial filters  @xcite .",
    "following the recommendations in  @xcite , we used the 4 most relevant spatial filters to obtain the feature vectors @xmath57 , which were then used as inputs in a lda classifier .",
    "following bci designs , the bvi should exploit the oscillatory modulations on @xmath1 and @xmath2 bands ( 8 - 30 hz ) following motor and somato - sensorial cortical activations @xcite .",
    "very low frequency potentials associated with voluntary movements @xcite may also be present during respiratory tasks as evidenced by previous work @xcite .",
    "to study the impact of specific frequency bands on the efficacy of the bvi to detect altered breathing , we compared several frequency ranges ( from 0 to 30 hz ) and bandwidths ( 4 to 22 hz ) to tune the bandpass filter used in the preprocessing block ( see section [ res : freq ] ) .      in bci ,",
    "the choice of the adequate number of sensors and their location is fundamental . reducing the number of irrelevant electrodes avoids over - fitting and optimizes computational costs , but also improves patient comfort and reduces installation time .",
    "several channel selection methods can be employed to simplify the implementation of bcis , being the most popular those based on common spatial pattern ( csp )  @xcite and svms  @xcite .",
    "in addition to csp based channel selection , we propose an iterative procedure to rank electrodes according to their discriminating power , the common highest order ranking ( chorra ) .",
    "results obtained by both methods are compared in section [ elect_rankings ] ) .",
    "chorra is performed in two steps .",
    "firstly , an electrode ranking for each subject ( intra - subject rankings ) is found .",
    "then , a general ranking of the most significant electrodes is computed over all subjects ( inter - subject rankings ) .    to compute intra - subject ranks ,",
    "a recursive backward elimination of electrodes was applied until the remaining number was 2 , the minimal dimension to compute a covariance matrix ( see algorithm 1 ) .",
    "initialise the subset @xmath65 with the initial @xmath66 electrodes @xmath67 = classification performance without @xmath68 @xmath69 = @xmath68 that provides the minimal @xmath70 remove the electrode @xmath68 from the list @xmath65 * return * @xmath71    at the end of this procedure , the list @xmath71 contains the indices to the @xmath66 electrodes sorted from more to less relevant in terms of classification performances for a particular subject . combining ranking lists from all subjects , a general configuration for a ready - to - use bvi device can be chosen .",
    "we have tested two possible rank combinations :    1 .",
    "* ranking aggregation * : this method determines electrode position in the ranked list , compared to a null model where all the lists are randomly shuffled  @xcite . based on order statistics",
    ", this algorithm assigns a @xmath72-value to each electrode in the aggregated list describing the rank improvement compared to expected ( a score of @xmath73 is assigned to channels that are preferentially ranked at the top of all lists ) .",
    "the procedure only takes into account the best rank , thus providing a robust re - ordering of elements  @xcite .",
    "* averaged ranking * : this is a classical positional method where the total score of an electrode is simply given by the arithmetic mean of the positions in which the channel appears in each ranking list .    to increase rank robustness ,",
    "several learning periods were used .",
    "hence , after obtaining a set of @xmath74 lists ( @xmath74-fold cross validation ) per subject , the intra - subject ranking was computed according to one of the above rank combination applied to the @xmath74 lists of electrode rankings .      as the electrode positions leading to the maximal auc in a particular subject is nt necessarily the same for another , we studied a common electrode configuration that could be shared by any user .",
    "this general electrode set - up is more pertinent in a clinical context as an eeg headset could be interfaced promptly .",
    "therefore , we applied the above rank combination methods to all intra - subject rankings to obtain common and unique electrode lists .",
    "since csp patterns @xmath64 ( @xmath62 ) can be considered as eeg source distribution vectors , their associated weights can be used to find the most relevant electrodes with regard to the discrimination of the two classes  @xcite .    to compute intra - subject csp - based ranks , we retained the first pattern ( @xmath75 ) as it explains the largest variance for class 0 ( and the lowest for class 1 ) and the last pattern ( @xmath76 ) , that explains the largest variance for class 1 ( and the lowest for class 0 ) . within each pattern , the largest weights ( absolute values )",
    "are associated with the most relevant electrodes .",
    "hence , the list of electrode ranks was generated by selecting , alternately , in decreasing order , the first weight in @xmath75 , then the first weight in @xmath76 , the second weight in @xmath75 and so on as proposed by wang et al @xcite .",
    "the final list of inter - subject csp ranks were obtained by normalizing ( by their maximal value ) @xmath75 and @xmath76 in each subject , then finding the average of these patterns across subjects as in  @xcite , and finally by selecting the weights as done above for intra - subject ranks .    for consistency with chorra ranks ,",
    "a similar @xmath74-fold procedure was applied : csp was computed using @xmath74 different mean covariance matrices in class 0 .",
    "the average of the resultant @xmath74 projection matrices yielded the final @xmath77 .",
    "as mentioned above , the prototypes are local centers that represent the space defined by @xmath15 . to this end",
    ", we adopted the @xmath14 prototypes provided by the general @xmath14-means algorithm as the centers @xmath16 introduced in section [ classif ] .",
    "the structure of the manifold defined by @xmath15 is unknown .",
    "covariance matrices may be organized in a compact , uniform manner so a few centers are enough to correctly represent class 0 . on the contrary",
    ", @xmath15 may have a complex distribution and need more centers to be correctly represented .",
    "therefore , in order to achieve good classification , there may be an optimal number of prototypes .    to satisfactorily exploit the bvi ,",
    "previous knowledge about the learning time needed to train the classifier is necessary .",
    "limited learning time may result in a small number of covariance matrices @xmath10 and hence , in a poor representation of the space defined by normal breathing .",
    "moreover , the clustering algorithm would provide a less accurate center when few cms are available . on the other hand ,",
    "the learning time should meet clinical requirements , as long set - up times in these environments are impractical .",
    "since the number of covariance matrices needed to represent class 0 may impact on the optimal number of prototypes , the classification performance has to be computed by modifying @xmath10 and @xmath14 . in next section ,",
    "these parameters are tested experimentally to find the optimal values .",
    "this section shows and discusses the results of applying the bvi to detect altered respiratory condition ( ld or sn ) after learning a reference period of normal breathing ( sv ) . to find the best settings in the classification block",
    ", several methods estimated the distances ( @xmath26 ) to the reference condition sv .",
    "distances were then employed to estimate the areas under roc curves ( auc ) as a measure of the classifier s performance .",
    "plots in figure  [ fig : alpha_delta ] illustrate the feature distances and corresponding aucs for detection of ld condition in one single subject .    for the eeg - based classifier , the optimal frequency band for preprocessing signals was first selected .",
    "then , euclidean , riemannian and log - euclidean distances were compared to select the best metric used for evaluating the optimal electrode configuration .",
    "finally , the impact of learning time and the number of prototypes were also assessed .",
    "as seen in figure [ fig : auc_freq ] , the frequency bands that provided the highest discriminant rates in terms of auc were 8 - 24 hz and 8 - 30 hz . since the latter is more susceptible any muscular artifacts  @xcite , we preferred to set the bandpass cut - off frequencies between 8 - 24 hz .",
    "low frequencies ( @xmath784 hz ) were discarded not only for their moderate discrimination power , but also because in a real implementation of the bvi this spectral range would be corrupted by electromagnetic interferences inherent in clinical environments .",
    "other frequency combinations were not superior to 8 - 24 hz classification rates .",
    "the first test used the 14 most central electrodes , thus covariance matrices were obtained from eeg signals @xmath79 .",
    "the classifier settings were @xmath80 and @xmath81 .",
    "figure [ fig : auc_ini ] shows that the best performing metric is the log - euclidean , which provided slightly better auc values than riemannian distances in ld condition ( @xmath82 versus @xmath83 ) and almost equal auc values ( @xmath84 ) for the sn condition .",
    "the classification performances for sn had the largest variability probably due to the discontinuous occurrence of sniffs ( one every two breaths ) .",
    "although the performances of log - euclidean are similar to those obtained by the affine invariant riemannian metric , the former is advantageous from the computational point of view due to its reduced algorithmic complexity ( cpu times were , on average , 3 time faster ) .",
    "euclidean distances provided the lowest average classification rates and the most unstable auc values , demonstrating the limitation of linear matrix operators ( i.e. the arithmetic mean ) for eeg covariance matrix classification .",
    "the analysis of @xmath85 values also proves that riemannian geometry is a better framework to classify eeg covariance matrices , than the outlier detector based on one - class svms .",
    "we notice , however , that the latter provided better results than the classifier with euclidean structure ( mean values are @xmath86 versus @xmath87 ) .    in ld condition , classification performances obtained with air flow ( @xmath88 ) remained below than those obtained using log - euclidean and affine invariant distances , and almost equal to the one - class svms eeg - based detector ( @xmath89 ) .",
    "because of the characteristic large pattern of air flow during sniffs , air flow signals provided better classification in sn than svm eeg - based detector ( @xmath90 and @xmath88 , respectively ) and similar performances to our approach .",
    "finally , if we considered the bvi as a two - class detector ( unsuitable for on - line detection as discomfort classes are not known a priori ) , the classification by csp and lda yielded @xmath91 for ld and @xmath88 for sn , values clearly below our riemannian geometry based approach .",
    "we assessed the most relevant electrodes in the proposed bvi , starting from a set of 14 central electrodes from the original 32-electrode montage .",
    "retained electrodes included positions on primary sensorimotor cortices ( c3 , c4 ) , higher - level secondary and association cortices ( fz and cz ) , pre - parietal ( cp1 and cp2 ) and pre - frontal cortices ( f3 , f4 ) , pre - motor and supplementary motor areas ( fc1 , fc2 ) , central ( fc5 and fc6 ) and parieto - occipital areas ( cp5 and cp6 ) .",
    "the choice of these areas follows results of earlier experiments describing the cortical networks elicited during respiratory load compensation  @xcite .    according to the chorra procedure to find the best channels from the initial set - up ( c.f algorithm 1 in section [ ch_selelct ] ) , we first found intra - subject rankings and then applied a global rank aggregation .",
    "as described above , we employed auc as the measure of classification performance and performed the rankings from @xmath74=10 lists ( i.e. 10 different learning periods ) of each subject .",
    "the classification results are shown in figure  [ fig : auc_elect]-(a ) for intra - subject auc optimized ranks and figure  [ fig : auc_elect]-(b ) for intra - subject csp electrode ranks , where auc values are expressed as a function of the number of removed electrodes . in both cases ,",
    "the evolution of the curves during the optimization process display a slight increasing tendency of auc for the log - euclidean metric when electrodes contributing negatively to classifications are removed .",
    "classification performances decrease with configurations smaller than six electrodes .",
    "results show that customized individual selection of electrodes can provide an optimal auc within a single subject . using an intra - subject auc based optimization ,",
    "classification rates can be improved up to 0.95 using the six most significant electrodes . on the other hand ,",
    "selecting the electrodes according to csp patterns provides lower aucs , with the best 6-electrode reaching an average auc value of 0.85 in ld .    as shown in different plots of figure  [ fig : auc_elect ] , for a configuration with more than three electrodes , the log - euclidean metric performs better than the euclidean distance at every optimization step .",
    "these results support the idea that large spatio - temporal information of the eeg ( as reflected by the sample covariance matrices ) is optimally captured when the intrinsic geometry structure of the underlying data is taken into account .",
    "we applied the two rank combinations proposed by chorra to the lists of sorted electrodes of all subjects to find a general ranking of electrodes for each method .",
    "following the rank of the final lists , we computed the auc values by reducing the initial 14-electrode set to two sensors ( see figure [ fig : auc_elect]-(c - d ) ) .",
    "classifications provided by inter - subject csp ranks are depicted in figure [ fig : auc_elect]-(e ) .",
    "results from both chorra procedures indicate that a good compromise between a reduced number of electrodes and reasonable classifications can be reached by selecting the best 6 electrodes obtained by the averaged ranks ( @xmath92 for both ld and sn conditions ) . in line with intra - subject ranks ,",
    "the general electrode list obtained by csp patterns resulted in poorer classification rates , providing @xmath93 for a set of 6 electrodes .",
    "results indicate that , for general configurations with more than three electrodes , log - euclidean metric still performs better than the euclidean distance .",
    "the aggregated chorra scores displayed in figure  [ fig : heads ] indicate scalp zones with more influence for the classification of both sn and ld conditions .",
    "although both optimization procedures ( robust rank aggregation and rank averaging ) provide similar classification performance , the spatial concentration for discrimination of scalp regions obtained by the robust aggregation method is larger than those obtained by a classical averaging rank procedure .",
    "the spatial distribution of scores and the rankings ( see figure [ fig : heads ] ) indicates that discrimination of ld condition is better if the electrode configuration contains the pre - motor and supplementary motor area ( fc1 ) , the fronto - central region ( fc6 ) and the supramarginal gyrus ( the part covered by cp6 electrode ) .",
    "this agrees with previous findings suggesting that during ld , the supplementary motor area ( sma ) is recruited  @xcite , most likely within the frame of a cortico - subcortical cooperation allowing compensation of the inspiratory load  @xcite .    during sn ,",
    "the conscious preparation of a breath activates pre - motor areas and the execution of the breath activates motor areas  @xcite .",
    "indeed , our results show that sn condition is better discriminated if electrodes include the supplementary motor area ( fc1 ) , the central motor area cz and part of the somatosensory association cortex ( covered by the electrode cp1 ) .",
    "figure [ fig : heads ] also shows the relative weights of electrode positions related to the most relevant csp patterns . in both ln and sn conditions ,",
    "topographic plots reveal that highly ranked positions reside in similar scalp regions . for loaded breathing ,",
    "csp weights suggest a bilateral activation of the cortex that includes fronto - central , central ( motor cortex ) and some centro - parietal positions ( somato - sensory cortex ) .",
    "on the other hand , during voluntary sniffs , highly scored electrodes match fronto - central positions on the left hemisphere ( motor and pre - motor areas ) .",
    "electrode selection based on csp coefficients converges to a great extent with chorra selection .",
    "nevertheless , for a given number of electrodes our proposed approach provides better classification performances than the counterpart selection in csp ranks ( see figure [ fig : auc_elect ] ) .    to confirm that changes in brain activity during ld and sn epochs detected by the eeg - based classifier are related to breathing , correlations between eeg and air flow were also computed after correcting by autocorrelations and time trends present in time series  @xcite .",
    "results show that mean correlations in central areas ( including c3 , c4 , fz and fc1 electrodes ) increase about @xmath94 .",
    "the increase of correlation values between eeg and air flow signals confirms that changes in brain state detected by our classifier are related to respiration .",
    "our results suggest that , in general , eeg signals might provide better discriminant features than air flow to detect breathing discomfort .",
    "once the effect of different metrics and channels configurations were assessed , we tested the influence of the learning parameters , i.e. the number of covariance matrices used as a reference ( @xmath10 ) and the number of prototypes ( @xmath14 ) used to characterize the reference class .    for this , we assessed classification performance for different values of @xmath14 , ranging from 1 to 7 and and for different number of learning matrices , @xmath10 , from 20 to 40 in steps of 5 .",
    "this procedure was also repeated with 10-fold cross validation for ld and sn conditions .",
    "three different electrode configurations were tested : 1 ) the initial 14-electrode configuration , 2 ) a selection of 6 electrodes optimized for every subject and 3 ) a general configuration with the best 6 electrodes after applying the global channel selection procedure .",
    "results are depicted in the color maps of figure [ fig : auc_kl ] , where average auc values are expressed as a function of @xmath14 and @xmath10 .",
    "importantly , this figure shows a small effect of both parameters on overall classification rates , regardless of the electrode configuration . in view of these findings",
    ", the choice of a small number of prototypes ( @xmath95 ) and a short learning time ( @xmath96 cms ) is an advantageous trade - off between computational complexity and classification performances , even for a common electrode configuration setting .",
    "compared to classification based on air flow , our findings demonstrate a better discriminatory power of the covariance patterns of eeg signals to detect a patient - ventilator disharmony ( @xmath97 versus @xmath98 , in average , for the loaded breathing condition ) .",
    "the analysis of auc values suggests that riemannian geometry is a better framework to manipulate covariance matrices , even with a few number of channels , than classical matrix operators with an euclidean structure .",
    "we notice that one - class svms detector also provides better results than a classifier employing euclidean metrics .",
    "in contrast with other classical methods used in bci , ( as csp which assumes a - priori labelled data from two classes ) , the results support the better discriminant capacity of our approach to identify anomalous respiratory periods , by learning from a single training set containing only normal respiratory epochs .",
    "the proposed recursive channel selection procedure may provide a subject - customized bvi setting with a reduced number of six channels and maintained performance ( @xmath99 ) .",
    "if the channel configuration includes the most significant electrodes across subjects , classification rates are reduced compared to customized optimization .",
    "nevertheless , this general setting provides a good compromise between a reduced number of electrodes ( 6 channels ) and reasonable classification performances ( @xmath100 ) , which is advantageous in general clinical practice where ready - to - use devices are necessary .",
    "interestingly , overall classification performance do not significantly depend on the other parameters of the classifier ( learning time and number of prototypes ) .",
    "similar to our approach , there have been previous attempts to use divergences from information theory ( e.g. kl divergence , jensen - shannon divergences or bregman matrix divergence ) for developing distances on covariance matrices @xcite .",
    "the use of such dissimilarity measures could improve the performance of our algorithm .",
    "an optimization of control parameters for other svms models might also increase classification performances but this subject is beyond the scope of our paper .    one major limitation of our approach results from the difficulty to properly estimate the covariance matrices .",
    "poor estimates do not accurately reflect the underlying neural process and thus will directly affect the classifier s performances .",
    "the estimation of a covariance matrix in an eeg segment assumes a multivariate , stationary stochastic process so it can be strongly affected by artifacts such as eye blinks , muscle activity or swallowing .",
    "changes over longer time scales such as changes in electrode impedance , lose of electrodes or sudden electrode shifts , would also deteriorate classification performances .",
    "the use of regularization or adaptive learning approaches ( see @xcite and references therein ) could improve the robustness of the algorithm .",
    "this work provides the first extensive evaluation of what could be a brain - ventilator interface ( bvi ) designed to detect altered respiratory conditions in patients on mechanical ventilation .",
    "the novelty of our proposal is a riemannian geometry approach to identify a cortical signature of breathing discomfort from spatio - temporal eeg patterns .    in general , characterization of brain networks",
    "provides meaningful insights into the functional organization of cortical activities underlying breathing control and respiratory diseases .",
    "our study supports the hypothesis of a strong correlation between voluntary and compensatory respiratory efforts and the activation of cortical circuits  @xcite .",
    "correlation increase between eeg and air flow during breathing discomfort epochs also corroborates that changes in brain state detected by our classifier are related to respiration .",
    "a hybrid bci combining eeg and airflow signals could be explored in future studies .",
    "the introduction of a bvi is a first step toward a critical class of interfaces for respiratory control applications in a variety of clinical conditions where the use of mechanical ventilation is required to decrease the work of breathing in the patients .",
    "for instance , in patients suffering amyotrophic lateral sclerosis , we have recently reported a respiratory - related cortical activity  @xcite .",
    "effective translation of our approach to a suitable device for long - term monitoring of these patients faces difficult challenges that arise from the nature of the heterogeneous population ( e.g. different respiratory problems ) and the numerous sources of artifacts in clinical units . nevertheless , due to its technical simplicity ( portable , non - invasive , with few electrodes and fast computation ) the proposed bvi can be highly operable in clinical environments as well as in custom - designed systems .",
    "indeed , our algorithm  @xcite is currently assessed by a large clinical study undertaken at the icu of our group . beyond short - term applications where the bvi would prompt clinicians to run a dyspnea check - list , future work",
    "should also integrate the bvi in a feedback scheme to automatically set ventilator parameters with minimal physician intervention .",
    "this work was supported by the program investissement davenir anr-11-emma-0030 and anr-10-aihu 06 of the french government and by the grant legs poix from the chancellerie de luniversit de paris , france .",
    "x. navarro - sune is financially supported by air liquide medical systems s.a .",
    "hudson was supported by an nhmrc ( australia ) early career fellowship .",
    "10 a.  carlucci et al .",
    "srlf collaborative group on mechanical ventilation , `` noninvasive versus conventional mechanical ventilation .",
    "an epidemiologic survey , '' _ american journal of respiratory and critical care medicine _ , vol .",
    "163 , no .  4 , pp .",
    "874880 , 2001 .",
    "p.  leung et al .",
    "`` comparison of assisted ventilator modes on triggering , patient effort , and dyspnea , '' _ american journal of respiratory and critical care medicine _ , vol .  155 , no .  6 , pp .",
    "19401948 , 1997 .",
    "m.  raux et al .",
    "`` cerebral cortex activation during experimentally induced ventilator fighting in normal humans receiving noninvasive mechanical ventilation , '' _ the journal of the american society of anesthesiologists _ , vol .",
    "107 , no .  5 , pp .",
    "746755 , 2007 .",
    "a.  l. hudson et al . , `` electroencephalographic detection of respiratory - related cortical activity in humans : from event - related approaches to continuous connectivity evaluation , '' _ journal of neurophysiology _ , vol .  115 , pp .  22142223 , 2016 .",
    "a.  cherian et al .",
    ", `` jensen - bregman logdet divergence with application to efficient similarity search for covariance matrices , '' _ ieee transactions on pattern analysis and machine intelligence _ , vol .",
    "35 , no .  9 , pp .",
    "21612174 , 2013 .",
    "p.  t. fletcher and s.  joshi , `` principal geodesic analysis on symmetric spaces : statistics of diffusion tensors , '' in _ computer vision and mathematical methods in medical and biomedical image analysis _",
    "3117 , pp .  8798 , 2004 .",
    "m.  h. quang et al . , `` a unifying framework for vector - valued manifold regularization and multi - view learning , '' in _ proceedings of the 30th international conference on machine learning ( icml-13 ) _ , pp .  100108 , 2013 .",
    "j.  farquhar et al . , `` regularised csp for sensor selection in bci , '' in _ proceedings of the 3rd international brain - computer interface . workshop and training course 2006 .",
    "graz university of technology , austria _ , pp .",
    "1415 , 2006 .",
    "g.  macefield and s.  c. gandevia , `` the cortical drive to human respiratory muscles in the awake state assessed by premotor cerebral potentials , '' _ the journal of physiology _ , vol .",
    "439 , pp .  545558 , 1991 .",
    "m.  raux et  al .",
    ", `` functional magnetic resonance imaging suggests automatization of the cortical response to inspiratory threshold loading in humans , '' _ respiratory physiology & neurobiology _ , vol .  189 , no .  3 , pp .",
    "571580 , 2013 .",
    "t.  similowski et al.,``method for characterising the physiological state of a patient from the analysis of the cerebral electrical activity of said patient , and monitoring device applying said method , '' 2013 . wo patent wo2013164462 ( a1 ) ."
  ],
  "abstract_text": [
    "<S> * abstract *  during mechanical ventilation , patient - ventilator disharmony is frequently observed and may result in increased breathing effort , compromising the patient s comfort and recovery . </S>",
    "<S> this circumstance requires clinical intervention and becomes challenging when verbal communication is difficult . in this work </S>",
    "<S> , we propose a brain computer interface ( bci ) to automatically and non - invasively detect patient - ventilator disharmony from electroencephalographic ( eeg ) signals : a brain - ventilator interface ( bvi ) . </S>",
    "<S> our framework exploits the cortical activation provoked by the inspiratory compensation when the subject and the ventilator are desynchronized . </S>",
    "<S> use of a one - class approach and riemannian geometry of eeg covariance matrices allows effective classification of respiratory states . </S>",
    "<S> the bvi is validated on nine healthy subjects that performed different respiratory tasks that mimic a patient - ventilator disharmony . </S>",
    "<S> classification performances , in terms of areas under roc curves , are significantly improved using eeg signals compared to detection based on air flow . </S>",
    "<S> reduction in the number of electrodes that can achieve discrimination can often be desirable ( e.g. for portable bci systems ) . by using an iterative channel selection technique , the common highest order ranking ( chorra ) , we find that a reduced set of electrodes ( n=6 ) can slightly improve for an intra - subject configuration , and it still provides fairly good performances for a general inter - subject setting . </S>",
    "<S> results support the discriminant capacity of our approach to identify anomalous respiratory states , by learning from a training set containing only normal respiratory epochs . </S>",
    "<S> the proposed framework opens the door to brain - ventilator interfaces for monitoring patient s breathing comfort and adapting ventilator parameters to patient respiratory needs .    </S>",
    "<S> * keywords : * biomedical signal processing , brain - computer interfaces ( bci ) , biomedical monitoring , medical signal detection , electroencephalography ( eeg )    at ( current page.south ) ; </S>"
  ]
}