{
  "article_text": [
    "this paper is concerned with the growth rate of some indicators of arithmetical complexity the global and local ( or @xmath0-adic ) heights of the points of the orbits of affine and piecewise affine planar maps .",
    "we present a combination of rigorous results and numerical experiments connecting growth of heights to the dynamics on a divided phase space , where regular and irregular motions co - exist ( see figure 1 ) .",
    "this programme aims to develop a local analogue of the so - called integrability criteria , which are detectors of global regularity of motions .",
    "these criteria have been the object of extended investigations ; in particular , the notion of diophantine integrability has been recently suggested , which is based on the slow growth of global heights see @xcite and references therein .",
    "we are interested in monitoring the arithmetical complexity of the points of an orbit of a piecewise affine map @xmath1 .",
    "the simplest measure of the complexity of a rational number @xmath2 is its _ height _ @xmath3 , defined as @xcite @xmath4 the notions of size and height are extended to two dimensions as follows @xmath5 the height will typically grow exponentially along orbits , so we define an allied quantity , the _ logarithmic height _ : @xmath6 if the limit exists .",
    "we have @xmath7 , so the logarithmic height is a property of an orbit . if @xmath8 is a ( pre)-periodic point , then @xmath9 is bounded , so that @xmath10 ( as long as the orbit of @xmath8 does nt go through the origin ) .",
    "further indicators of complexity are defined by means of the @xmath0-adic absolute value @xmath11 , where @xmath0 is a prime number .",
    "( for background reference on @xmath0-adic numbers , see @xcite . )",
    "let the _ order _ @xmath12 of an integer @xmath13 be the largest non - negative integer @xmath14 such that @xmath15 divides @xmath13 , with @xmath16 .",
    "this definition is extended to the rational numbers @xmath17 by letting @xmath18 ( the value of this expression does nt depend on @xmath13 and @xmath19 being co - prime ) . finally , we define @xmath20 the function @xmath21 has the properties of the ordinary absolute value , with the triangular inequality replaced by the stronger ultrametric inequality @xmath22 where equality holds if @xmath23 ( or @xmath24 ) .",
    "we shall be using the estimate @xmath25    the following identity connects the various absolute values over @xmath26 : @xmath27 where the product is taken over all primes . only finitely",
    "many terms of this product are different from 1 ; they correspond to the prime divisors of the numerator and the denominator of @xmath28 .    in two dimensions",
    "we use the quantities @xmath29 the norm @xmath30 and valuation @xmath31 can be shown to satisfy the ultrametric inequalities analogous to ( [ eq : ultrametric ] ) , respectively , with equality holding if the two terms have distinct size .",
    "next we define the analogue of ( [ eq : logheight ] ) , namely the _ @xmath0-adic _ ( or _ local _ ) _ height _ @xmath32 of the initial point @xmath8 of an orbit : @xmath33 comparing ( [ eq : localheight ] ) with ( [ eq : logheight ] ) , we note that the function @xmath31 is already logarithmic , and that there is no need of considering separately numerator and denominator , since the prime @xmath0 will appear only in one of them .",
    "the functions @xmath34 and @xmath35 are variants of the so - called _ canonical height _ defined for rational functions of degree greater than one @xcite . in this case , in place of ( [ eq : height ] ) one defines @xmath36 and then one lets @xmath37 where @xmath38 is the degree of @xmath39 .",
    "the height @xmath40 behaves nicely under iteration : @xmath41 .",
    "it measures the average rate of growth of the degree of @xmath39 , collecting contributions from all absolute values .    in the case of ( piecewise )",
    "affine mappings , the increase in complexity does not derive from degree growth , but rather from the growth of coefficients , hence the definition of @xmath34 and @xmath35 .",
    "furthermore , we have kept the contributions from the various primes separate ( as in the so - called _ local canonical heights _ ) because they contain valuable information about the dynamics .",
    "the height may be used to characterize generic properties of rational points . to this end",
    ", we consider the set @xmath42 of points in @xmath43 whose height is at most @xmath44 : @xmath45 this set is finite . indeed",
    "if @xmath46 , then @xmath47 , and we deduce that @xmath48 where @xmath49 is euler s function @xcite and where we have used the estimate @xmath50 ( see ( * ? ? ? * theorem 330 ) and also ( * ? ? ?",
    "* p 135 ) ) .",
    "half of the elements of @xmath51 lie within the square @xmath52 , where they approach a uniform distribution ( because the farey sequence has that property @xcite ) ; the other half lie outside the square , and they are obtained from the points inside the square by an inversion .",
    "thus the limiting distribution of points of bounded height approaches a smooth limit on sufficiently regular bounded sets .",
    "let us now consider a set @xmath53 such that @xmath54 , where @xmath55 is some ambient set ( possibly the whole of @xmath56 ) .",
    "the density @xmath57 of @xmath53 ( in @xmath55 ) with respect to @xmath42 is given by @xmath58 if the limit exists has zero measure ( jordan measurability ) ] .",
    "if @xmath59 , then we say that @xmath53 is ` generic ' , or that the defining property of @xmath53 holds ` almost everywhere ' ( in @xmath55 ) .",
    "for example , the rational points on a smooth curve on the plane have zero density and hence are non - generic .    for the numerical experiments reported in section [ section : numericalexperiments ] we have chosen maps @xmath39 of the form @xmath60 where @xmath61 is a piecewise - affine real function and",
    "@xmath62 is a real number ( the jacobian determinant of @xmath39 ) .",
    "more precisely , we have a set @xmath63 of indices ( possibly infinite ) , a partition @xmath64 of the real line into intervals , and a collection @xmath65 of real affine functions @xmath66 such that @xmath67 if @xmath68 , then for any choice of @xmath61 the map @xmath39 is area - preserving ( see section [ section : piecewiseaffinemaps ] ) . the literature devoted to maps of this type",
    "is substantial @xcite .",
    "let now @xmath69 .",
    "then the set @xmath43 is invariant under @xmath39 , and it makes sense to restrict the dynamics to rational points .",
    "( in fact one can restrict the space further see the appendix . )    the @xmath70-adic height for some orbits of the map @xmath39 given by @xmath71 with @xmath68 is shown in figure [ fig : height ] .",
    "the initial conditions are evenly spaced rational points on the positive @xmath28-axis .",
    "the alternation of constancy and fluctuations is a distinctive feature of height functions along smooth curves in phase space , which is connected to the co - existence of regular and irregular motions .",
    "( to wit , compare figures [ fig : phaseportrait ] and [ fig : height ] . )",
    "the plan of this paper is the following . in section",
    "[ section : localheights ] we compute the local height in affine maps , and show that , generically , all rational points have the same height ( theorem [ thm : localheight ] ) .",
    "we identify the conditions under which convergence of the heights is non - uniform , but also show that the set of points having slow convergence have an exponentially large global height .",
    "we then obtain explicit formulae for the valuation function @xmath31 along orbits in terms of lucas polynomials ; this gives us an alternative proof of theorem [ thm : localheight ] . in section [ section : globalheight ]",
    "we determine the global height of an affine map , and show that , generically , all rational points have the same height ( theorem [ thm : logh ] ) .",
    "in section [ section : piecewiseaffinemaps ] we consider piecewise - affine maps @xmath39 of @xmath43 ( which include maps of the type ( [ eq : f ] ) ) , and their islands , which are bounded invariant domains where the motion is locally linear . in the islands",
    "the results of the previous sections apply and all heights are constants , which explains the plateaus in figure [ fig : height ] ( theorem [ theorem : constantheight ] ) .    in section",
    "[ section : numericalexperiments ] we explore numerically the convergence of height functions in the chaotic regions , and also consider briefly heights of quasi - periodic points . in the appendix",
    "we construct a set @xmath72 , where @xmath73 is a module over a certain sub - ring of @xmath74 depending on the map s parameters , which serves as a natural minimal phase space of a piecewise affine map .",
    "this is the set relevant to our numerical experiments .",
    "acknowledgements : jagr and fv would like to thank , respectively , the school of mathematical sciences at queen mary , university of london , and the school of mathematics and statistics at the university of new south wales , sydney , for their hospitality .",
    "this work was supported by the australian research council .",
    "we consider the behaviour of local heights ( [ eq : localheight ] ) of the rational points for the affine map : @xmath75 where @xmath76 is a non - singular matrix with rational entries , and @xmath77 .",
    "( for notational ease , we do not use transpose symbols where it is clear by context , e.g. , for @xmath8 and @xmath78 above . )    the map @xmath39 has a single rational fixed point @xmath79 and if @xmath80 , then @xmath81 we define @xmath82 and we let @xmath83 be the characteristic polynomial of @xmath84 , with roots @xmath85 and @xmath86 .    the computation of @xmath0-adic heights is an eigenvalue problem analogous to the computation of the lyapunov exponent .",
    "further insight is obtained by studying the detailed behaviour of the sequence @xmath87 ( see figure [ fig : nu ] ) , which will be considered in section [ section : explicitformulae ] .",
    "[ thm : localheight ] let @xmath39 be the affine map ( [ eq : faffine ] ) with @xmath88 as above . if @xmath89 , then for almost all @xmath90 we have :    1 .",
    "if @xmath91 then @xmath92 ; 2 .   if @xmath93 then @xmath94 .    if @xmath95 then the above expressions for @xmath35 must be replaced by @xmath96 and @xmath97 , respectively .    proof .",
    "let @xmath98 be the completion of @xmath26 with respect to the absolute value @xmath99 .",
    "the eigenvalues @xmath100 of @xmath84 lie in a field @xmath101 which is either @xmath98 or a quadratic extension of @xmath98 . in @xmath101",
    "there is a prime element @xmath102 ( either @xmath0 or @xmath103 ) and a valuation @xmath104 , which is either @xmath31 or is an extension of @xmath31 which agrees with @xmath31 on @xmath26 .",
    "let @xmath85 be a largest eigenvalue , that is , @xmath105 .",
    "let @xmath106 and let @xmath107 be the newton polygon of @xmath108 , namely the convex hull of the points @xmath109 , @xmath110 , @xmath111 , @xmath112 , @xmath113 . if @xmath114 then @xmath107 has two finite sides with distinct slopes @xmath115 and @xmath116 , of which the latter is the largest .",
    "hence by ( * ? ? ?",
    "* theorem 6.4.7 ) we have @xmath117 and @xmath118 . likewise , if @xmath119 then @xmath107 has one finite side of slope @xmath120 .",
    "hence @xmath121 .",
    "first we consider the parameter @xmath89 .",
    "we begin with the case @xmath122 , which is case @xmath123 .",
    "we have @xmath124 ( see section [ section : eigenspaces ] ) , and we write @xmath125 where the @xmath126 are linearly independent eigenvectors of @xmath84 in @xmath127 and the coefficients @xmath128 are in @xmath98 . for generic initial conditions @xmath129 ( i.e. , @xmath130 does not lie in the eigenspace generated by @xmath131 ) , the @xmath0-adic height in a linear system is determined by the eigenvalue with largest @xmath0-adic absolute value , which is @xmath85 .",
    "specifically , for all large enough @xmath132 , the two terms in ( [ eq : linearsolution ] ) have distinct size , and hence from ( [ eq : p - normheight ] ) and following comments we see that @xmath133 from which @xmath134 and the result follows .    let us now deal with case @xmath135 .",
    "if @xmath136 , but @xmath137 , we rewrite ( [ eq : linearsolution ] ) as @xmath138 noting that @xmath85 is non - zero .",
    "then @xmath139 is a @xmath0-adic unit , and hence there exits a smallest positive integer @xmath19 such that @xmath140 with @xmath141 . if @xmath142 , that is , @xmath143 is a root of unity , then @xmath144 is periodic , and hence @xmath145 , as desired .    if @xmath146 , then the sequence @xmath147 is dense in a disc ( see @xcite and @xcite ) , and hence @xmath148 is dense in the union of @xmath19 discs",
    "thus each component of @xmath149 is also dense in a finite union of discs .",
    "if none of these discs contains the origin , then @xmath150 assumes finitely many values , and the result follows .",
    "otherwise @xmath150 is bounded above but not bounded away from zero , and the rate at which @xmath151 approaches zero is the same as the rate at which @xmath152 approaches 1 . from the binomial theorem we obtain @xmath153 and hence the quantity @xmath154 grows logarithmically , from ( [ eq : valuationestimate ] ) .",
    "it follows that @xmath155 , as desired .",
    "finally , if the jordan form of @xmath156 is not diagonal , then the sequence @xmath157 contains a term affine in @xmath132 .",
    "the contribution of this term is logarithmic , again due to ( [ eq : valuationestimate ] ) .",
    "hence , in all cases , @xmath158 .",
    "if @xmath95 then from ( [ eq : p - normheight ] ) and ( [ eq : iterate ] ) we find @xmath159 . in case @xmath123 , if @xmath160 , then , for all sufficiently large @xmath132 the first term is the largest , that is , @xmath161 , and the previous analysis applies . likewise ,",
    "if @xmath162 , then eventually the second term becomes the largest , and since this term is constant , we get @xmath163 .",
    "if @xmath164 , then the inequality remains such , but the first term grows at most logarithmically , and so @xmath163 .",
    "case @xmath135 is treated similarly .",
    "@xmath165      we look more closely at the @xmath0-adic dynamics of a linear map with eigenvalues @xmath100 of distinct magnitude , which is case @xmath166 ) of theorem [ thm : localheight ] . using the notation ( [ eq : uv ] )",
    ", we see that if @xmath114 , then , necessarily , @xmath167 ( @xmath168 ) . letting @xmath169 we have @xmath170 .",
    "let now @xmath171 , where @xmath172 is a root of the polynomial @xmath173 we have the factorisation : @xmath174 then @xmath175 has two distinct roots modulo @xmath0 , congruent to @xmath176 and @xmath177 , respectively , and at these roots @xmath175 is equal to @xmath178 from ( [ eq : charpoly ] )",
    ". from hensel s lemma @xcite , we have that @xmath175 has two distinct roots in @xmath179 , which we denote by @xmath180 , of which the largest , @xmath181 , is a unit .",
    "hence @xmath182 , in agreement with theorem [ thm : localheight ]    now , the polynomial @xmath175 is irreducible over @xmath74 if and only if @xmath108 is irreducible , since their roots differ by a rational factor .",
    "if @xmath108 is reducible , then these eigenspaces have infinitely many rational points ; if @xmath108 is irreducible , then these eigenspaces have no rational points , apart from the origin .    in the first case",
    "there will be a non - generic ( zero - density ) set of rational points with height @xmath183 , lying on the eigenspace corresponding to the smallest eigenvalue .",
    "thus a sufficient condition for all non - zero rational points to have the same @xmath0-adic height is @xmath184 , for in this case @xmath108 is irreducible by eisenstein s criterion ( * ? ? ?",
    "* proposition 5.3.11 ) .    in the second case",
    "all points have the same height @xmath185 , apart from the origin .",
    "rational approximants for the roots of @xmath108 may be constructed by iterating newton s map for @xmath108 sufficiently many times , with an appropriate initial condition @xcite .",
    "the components of an eigenvector of @xmath84 may be chosen to be linear expression in such eigenvalues , with rational coefficients .",
    "we are interested in motion in the @xmath0-adic vicinity of the eigenspace @xmath186 corresponding to the smaller eigenvalue .",
    "we begin with a general lemma .",
    "[ lemma : simultaneousapproximation ] let @xmath0 be a prime number . for any @xmath90 , any @xmath187 , and any @xmath188 , there is @xmath189 such that @xmath190 with the norms ( [ eq : normheight ] ) and ( [ eq : p - normheight ] ) , respectively .",
    "the rational sequence @xmath191 has the property that , as @xmath192 , @xmath193 in @xmath74 , while @xmath194 in @xmath195 .",
    "let now @xmath196 and @xmath188 be given .",
    "for any @xmath197 , the sequence @xmath198 converges to @xmath8 in @xmath199 .",
    "we choose @xmath200 such that , for all @xmath201 , we have @xmath202 .",
    "let @xmath203 .",
    "we will show that @xmath204 in ( [ eq : zk ] ) may be chosen so that @xmath205 .",
    "we find @xmath206 since @xmath74 is dense in @xmath195 , we can find @xmath207 such that @xmath208 .",
    "let @xmath209 .",
    "then there is @xmath210 such that for all @xmath211 we have @xmath212 .",
    "similarly , let @xmath213 .",
    "then there is @xmath214 such that for all @xmath215 we have @xmath216 .",
    "let now @xmath217",
    ". for all @xmath218 , the ultrametric inequality ( [ eq : ultrametric ] ) gives @xmath219 similarly , @xmath220 .",
    "in the same @xmath14-range , we obtain @xmath221    we have shown that for all @xmath218 , the point @xmath222 lies within an @xmath223-neighbourhood of @xmath8 in the ordinary norm , and within an @xmath223-neighbourhood of @xmath224 in the @xmath0-adic norm . the lemma follows .",
    "now choose @xmath225 .",
    "the lemma states that arbitrarily close to any rational point we can find another rational point as close as we please to an eigenvector @xmath224 of @xmath84 .",
    "thus , irrespective of the rationality of the eigenvalues , there always will be a dense set of initial conditions that are to close to the eigenspace @xmath186 to cause the second term in ( [ eq : linearsolution ] ) to dominate for small values of @xmath132 . for these orbits",
    "the convergence of @xmath35 will be slow .",
    "the sequence @xmath87 will feature two distinct affine regimes , with slopes @xmath183 and @xmath226 , respectively .",
    "if the slopes have different sign and @xmath227 , then these regimes may be separated by a third regime , determined by a constant lower bound see figure [ fig : nu ] .",
    "we want to justify the statement that the height of a ` typical ' rational point converges rapidly to its asymptotic value @xmath226 , in apparent defiance of the pathologies exposed by lemma [ lemma : simultaneousapproximation ] above .",
    "we will show that points for which the non - archimedean height has anomalous time - dependence must also have a large archimedean height . for brevity , we consider only the linear case .",
    "let @xmath228 .",
    "then , in the regime in which equation ( [ eq : normofz_t ] ) holds , we have that @xmath229 .",
    "now we define the _ lag time _",
    "@xmath230 to be the time at which this asymptotic regime sets in , namely , @xmath231 because the eigenspace @xmath186 of @xmath86 has been excluded , the function @xmath232 is well - defined . the larger the value of @xmath230 , the slower the convergence of the @xmath0-adic height @xmath32 .    from equations ( [ eq : linearsolution ] ) and ( [ eq : tau ] ) and the ultrametric inequality , we find that @xmath233 where the quantity @xmath234 $ ] ensures that @xmath232 is an integer . hence , as @xmath235",
    "we must have @xmath236 .",
    "now , for any non - zero rational number @xmath237 and any prime @xmath0 , we have the estimate @xmath238 .",
    "hence for large enough @xmath232 there is a constant @xmath239 independent of @xmath8 such that @xmath240 where @xmath241 and @xmath242 are any rational approximants of @xmath243 and @xmath244 such that @xmath245 .",
    "thus the height of the ratio of the coefficients of @xmath246 in the representation ( [ eq : linearsolution ] ) grows at least exponentially in the lag time @xmath232 .      in this section",
    "we derive explicit formulae for @xmath246 and @xmath247 , which will give us an alternative , more direct proof of theorem [ thm : localheight ] , with the exclusion of some special cases .    from",
    ", we need the powers of the rational matrix @xmath84 . using the cayley - hamilton theorem ,",
    "one proves by induction ( e.g. , ( * ? ? ?",
    "* lemma 1 ) ) that for @xmath248 , the following relation holds @xmath249 where the sequence of rational numbers @xmath250 obeys the recursion @xmath251 if @xmath252 and @xmath253 are integers , then @xmath254 is an integer sequence , known as the _ lucas sequence of the first kind_. in a slight abuse of notation , we will use the same symbol @xmath254 for our case of a rational sequence generated by because many of the properties of lucas sequences are independent of whether @xmath252 and @xmath253 are integers .",
    "it follows by iteration of that @xmath255 is a polynomial in @xmath256 and @xmath257 with integer coefficients .",
    "its general form @xcite is @xmath258 where @xmath259 we note that @xmath260 from ( [ eq : u ] ) , we have that , for all @xmath261 :    1 .",
    "the polynomial @xmath262 is homogeneous of degree @xmath263 .",
    "the leading term of @xmath254 is @xmath264 ( i.e. , @xmath254 is monic ) while the term of lowest total degree is @xmath265 if @xmath132 is odd and @xmath266 if @xmath132 is even .    from with",
    ", we see that @xmath267 where @xmath268    let us now consider the first component of @xmath246 in . using we",
    "rewrite it as follows : @xmath269 where @xmath270 the greatest value of the summation indices is given by : @xmath271 from ( [ eq : xt ] ) and the ultrametric inequality ( [ eq : ultrametric ] ) it follows that @xmath272 for the order of the first term , using gives @xmath273 we have three cases :    1 .",
    "@xmath91 . using ( [ eq : binomialestimate ] ) , we see that the unique minimum is achieved at @xmath274 with @xmath275 , giving @xmath276 2 .   @xmath277 . the unique minimum is achieved at @xmath278 , where @xmath279is equal to @xmath280 when @xmath132 is odd and to @xmath281 when @xmath132 is even .",
    "thus @xmath282 3 .",
    "a minimum is achieved at @xmath274 , with @xmath275 , giving @xmath284    a very similar analysis for the order @xmath285 in gives    1 .",
    "@xmath286 2 .",
    "@xmath287 3 .",
    "@xmath288    the analysis for the second component @xmath289 in ( [ eq : formzt ] ) is identical .    from the above and ( [ eq : orderxt ] ) , we have :    @xmath123 @xmath91 : @xmath290 if @xmath291 , then the linear terms are increasing , and we have two possibilities .",
    "if @xmath292 , then eventually we have @xmath293 .",
    "if , @xmath294 , then eventually , under the non - degeneracy condition @xmath295 a unique minimum emerges in ( [ eq : inequalityi ] ) , and @xmath296 becomes affine . in the degenerate case ,",
    "the inequality ( [ eq : inequalityi ] ) remains such .",
    "if @xmath297 , then @xmath296 is initially bounded below by a constant .",
    "if ( [ eq : nondegeneracy ] ) holds , then the minimum is achieved by a single affine term , and ( [ eq : inequalityi ] ) becomes an equality .",
    "given a similar analysis for @xmath298 , we have thus proved part @xmath123 of theorem [ thm : localheight ] , under the restriction ( [ eq : nondegeneracy ] ) or the corresponding restriction for @xmath299 ( a single restriction will suffice ) .",
    "such a restriction avoids the pathologies described in section [ section : eigenspaces ] .",
    "@xmath135 @xmath277 : @xmath300 if @xmath301 , then the linear terms are increasing , and we have two possibilities .",
    "if @xmath292 , then eventually we have @xmath293 .",
    "if @xmath294 , then ( [ eq : inequalityii ] ) becomes an equality provided that ( here for odd @xmath132 ) @xmath302 and similarly for even @xmath132 .",
    "the right - hand side of ( [ eq : nondegeneracyii ] ) is non - negative and grows without bounds but at most logarithmically , due to ( [ eq : valuationestimate ] ) . if @xmath303 , then the left - hand side of ( [ eq : nondegeneracyii ] ) is negative , so this condition always holds and we have @xmath304 if @xmath305",
    ", then the left - hand side of ( [ eq : nondegeneracyii ] ) can be made negative by multiplying the initial conditions by a suitable power of @xmath0 .",
    "thus there is a rescaled sequence for which the above limit holds .",
    "the linearity of the system ensures that the same limit holds for the original sequence .    if @xmath306 , then the linear terms decrease , and hence become dominant .",
    "there is a condition analogous to ( [ eq : nondegeneracyii ] ) , and we reach an analogous result .",
    "this establishes the strict inequality in part @xmath135 of theorem [ thm : localheight ] .",
    "@xmath307 @xmath308 : @xmath309 in this case we only obtain a lower bound for @xmath296 , and analogously for @xmath298 , leading to an upper bound for @xmath35 .",
    "one verifies that the latter agrees with the value of @xmath35 given in theorem [ thm : localheight ] for this case .",
    "in this section we determine the global height ( [ eq : logheight ] ) for the rational points of the affine map @xmath39 given in ( [ eq : faffine ] ) .",
    "the dynamics of @xmath39 on @xmath310 is standard @xcite .",
    "let @xmath311 and @xmath108 be as in section [ section : localheights ] .",
    "for a rational number @xmath28 we shall adopt the notation @xmath312 as before , the eigenvalues of @xmath84 are @xmath85 and @xmath86 with @xmath313 .",
    "we consider the prime divisors of the denominators of @xmath252 and/or @xmath253 , and split them into two disjoint families : @xmath314 then we define @xmath315 where the sum is zero if the corresponding set of primes is empty .",
    "[ thm : logh ] let @xmath39 and @xmath84 be as in ( [ eq : faffine ] )",
    ". then for almost all rational initial conditions @xmath8 , the logarithmic height @xmath316 defined in ( [ eq : logheight ] ) is given by @xmath317 where @xmath85 is a largest eigenvalue of @xmath84 and @xmath318 is as in .",
    "we determine the height of each component @xmath319 and @xmath289 of @xmath246 . in each case",
    ", this means considering their numerator and denominator _ after _ cancelling common factors between them , so a given prime appears in only one of @xmath320 , @xmath321 if it appears at all . from",
    ", we can write : @xmath322 where the nontrivial terms in the product correspond to the prime divisors of @xmath321 .",
    "we begin with the parameter value @xmath89 . from theorem [ thm : localheight ]",
    "we have @xmath323 the only primes which will contribute to the logarithmic height of @xmath321 are the divisors of @xmath324 or @xmath325 .",
    "the contribution of the primes which divide the denominator of the initial conditions is asymptotically zero . as a result , we have @xmath326 the analogous calculation for @xmath327 means we have established @xmath328    now we consider the logarithmic height of . as @xmath329 , we can write @xmath330 provided the separate limits exist . to learn about the nature of @xmath319 in the argument of the first logarithm on the right , we need to inject information on the archimedean dynamics of @xmath84 on @xmath56 .",
    "we begin by assuming that @xmath84 has diagonal jordan form . if @xmath331 , then all orbits are bounded , i.e. , @xmath332 for some real number @xmath333 independent of @xmath132 .",
    "we have @xmath334 so that @xmath335 and similarly for @xmath336 and since @xmath337 , we recover via .",
    "if @xmath338 , then ( almost ) all orbits in forward time escape to infinity at the rate @xmath339 because @xmath340 it follows that @xmath341 we have @xmath342 from and the known limits , we learn @xmath343 as desired .",
    "if the jordan form of @xmath84 is not diagonal , then @xmath344 contains an affine term which grows sub - exponentially , and the exponential terms dominate . if @xmath345 , then @xmath10 . in this case",
    "@xmath346 ( both @xmath347 and @xmath348 are empty ) and @xmath349 , as desired .",
    "it remains to consider the case @xmath95 , corresponding to a non - zero fixed point @xmath350 .",
    "if @xmath351 , then all orbits are asymptotic to the fixed point @xmath350 , so @xmath352 and the first term on the rhs of vanishes , while the case @xmath353 is dealt with by the previous analysis .",
    "thus , asymptotically , the logarithmic height of @xmath320 and @xmath321 is the same , similarly for @xmath354 and @xmath355 . from",
    "we see that has the value @xmath318 .",
    "the previous theorem shows that the logarithmic height depends only on @xmath252 and @xmath253 for the matrix @xmath84 as these determine the eigenvalues .",
    "thus this height is preserved by conjugacy in @xmath356 .",
    "related to @xmath84 is its associated companion matrix @xmath333 , also with rational entries : @xmath357 it is well - known that provided @xmath84 is not a rational multiple of the identity matrix , then @xmath84 is conjugate to @xmath333 over @xmath74 .",
    "we consider now two - dimensional piecewise - affine maps over the rationals , defined as follows . given a finite or countable set @xmath63 of indices , we choose a partition of @xmath43 into domains @xmath358 , with @xmath359 .",
    "typically , each @xmath358 will be a convex ( finite or infinite ) polygon .",
    "for each @xmath359 , we choose @xmath360 and @xmath361 , to obtain the map @xmath362 given by @xmath363 .",
    "the mapping @xmath39 is then defined by the rule @xmath364 we shall assume that the partition @xmath365 is irreducible , namely that @xmath39 is not differentiable on the boundaries of the domains @xmath358 .",
    "to every orbit @xmath157 of @xmath39 we associate a doubly - infinite sequence @xmath366 via the rule @xmath367 the maps ( [ eq : f ] ) are of the type ( [ eq : fgeneral ] ) , with @xmath368 .",
    "their symbolic dynamics ( [ eq : code ] ) is determed by the simpler condition @xmath369    the function @xmath370 is not injective , and we are interested in the structure of the sets of points which share the same code .",
    "the map @xmath39 fails to be differentiable on the set of lines and segments @xmath371 , where @xmath372 is the union of the boundaries of the domains @xmath358 . by forming all pre - images of these lines",
    "we obtain the discontinuity set @xmath55 of the map : @xmath373 the set @xmath55 is a union of segments , lines , and rays .",
    "now consider the complement of the closure of @xmath55 in @xmath310 .",
    "this is an open set , which decomposes as the union of connected components . by construction ,",
    "all points of each connected component have the same code .",
    "the bounded connected components with a periodic code are called _ islands _ , denoted by @xmath374 .",
    "( this terminology is normally reserved for the area - preserving case , for which @xmath374 is also periodic . ) if @xmath19 is the period of the code , then @xmath375 is affine and the results of the previous section apply .",
    "the jacobian @xmath376 of @xmath375 is the same at every point of the island , since it depends only on the code .",
    "since @xmath374 is bounded , the eigenvalues of @xmath376 are necessarily in the closed unit disc in @xmath377 .",
    "let @xmath378 be the set of prime divisors of the denominator of the trace or the determinant of the matrices @xmath379 .",
    "this is the set of primes of interest to us ( see also the appendix ) .",
    "now fix @xmath380 and embed the rational points of an island @xmath374 in the space @xmath381 .",
    "the following result justifies the presence of plateaus in the graph of @xmath35 displayed in figure [ fig : height ] .",
    "[ theorem : constantheight ] almost all points of a rational island have the same heights @xmath34 and @xmath35 for all primes @xmath0 .",
    "the latter are rational numbers .",
    "let @xmath19 be the period of the island .",
    "if the restriction of @xmath375 to @xmath374 has finite order , then all points in @xmath374 are periodic , and their height is zero .",
    "let us thus assume that @xmath375 has infinite order and let @xmath376 be the jacobian of @xmath375 on @xmath374 .",
    "the result follows by applying theorems [ thm : localheight ] and [ thm : logh ] , respectively , to the affine map @xmath375 , noting that @xmath252 and @xmath253 of now refer to the trace and determinant of @xmath376 , plus the respective results @xmath35 and @xmath318 of these theorems should be divided by @xmath19 to account for the different time scale of the return map to the island .",
    "so the @xmath0-adic heights are rationals , in general .",
    "let us now consider the behaviour of @xmath247 for points in an island ( figure [ fig : nu ] ) .",
    "this is the case @xmath123 of theorem [ thm : localheight ] , where @xmath382 is the jacobian of the return map to the island .",
    "the conditions of lemma [ lemma : simultaneousapproximation ] are satisfied by @xmath376 .",
    "hence , by choosing @xmath383 , we can find near every point of the island initial conditions for orbits which perform rotations in @xmath43 , while they simultaneously approach the unstable fixed point @xmath350 in @xmath381 as close as we please .",
    "in this section we explore the convergence of heights for rational orbits in chaotic regions and their boundaries .",
    "two such regions are displayed in figure [ fig : chaoticregions ] , where in each case we have plotted a large number of points of a single rational orbit .",
    "these plots suggest that the closure of these orbits is a bounded subset of the plane , with positive lebesgue measure .    at present , statements on this kind",
    "can only be established in very special cases .",
    "for piecewise affine symplectic maps , our knowledge of the boundary of chaotic regions is inadequate , and proofs of global stability have relied on the presence of piecewise - smooth bounding invariant curves , which is a non - generic situation @xcite . in the present examples there are no such curves , and we can only establish boundedness inside island chains .",
    "thus any consideration on convergence of the height along other types of non - periodic orbits will necessarily be speculative .",
    "we begin to examine the behaviour of @xmath296 along an individual orbit of the area - preserving map ( [ eq : f ] ) , with @xmath61 given by ( [ eq : myf ] ) .",
    "there is only one prime in @xmath378 , namely @xmath384 ( the set @xmath378 was defined in section [ section : piecewiseaffinemaps ] ) .",
    "we choose the initial condition @xmath130 near the boundary of the square stable region containing the origin in figure [ fig : chaoticregions ] , left .",
    "the time - dependence of @xmath385 , shown in figure [ fig : valuationvstime ] , features a concatenation of distinct regimes , in which the rate of change of @xmath385 remains approximately constant .",
    "each regime has a dynamical signature . in figure",
    "[ fig : chaoticorbit ] we plot the orbit that generated the data of figure [ fig : valuationvstime ] .",
    "the initial plateau corresponds to the neighbourhood of the square island mentioned above . after a transitional phase",
    ", the orbit migrates to a neighbourhood of the large island chain visible in the middle of the chaotic sea , where the local value of the height ( the slope of the curve ) remains approximately constant .",
    "then the orbit leaves this region , and the height decreases .    to shed light on the global picture ,",
    "we have computed the approximate value of the height for some 300 distinct orbits .",
    "the initial conditions are points equally spaced on a segment connecting two islands , but otherwise lying in the chaotic sea .",
    "these segments are placed along the @xmath28-axis , and are visualized as grey strips in figure [ fig : chaoticregions ] .",
    "a numerical approximation for the height , given by @xmath386 is computed for each orbit at several values of @xmath252 : @xmath387 .",
    "( the value @xmath388 yields rational numbers with over 5000 decimal digits at numerator and denominator . )",
    "the data for @xmath389 and @xmath388 are displayed in figure [ fig : heightchaoticregion ] .",
    "the fluctuations appear to decrease , albeit slowly , with @xmath252 . to quantify this phenomenon",
    "we have computed the normalised total variation @xmath390 of the height @xmath391 where @xmath44 is the number of orbits , and @xmath392 is the initial condition of the @xmath166th orbit .",
    "the behaviour of @xmath393 for both cases is shown in figure [ fig : variationheightchaoticregion ] in doubly logarithmic scale .",
    "the data suggest a regular decrease of the total variation of the numerical height with the time @xmath252 , and are consistent with a slow convergence to a value which is constant almost everywhere in a chaotic region .",
    "clearly there will be exceptional orbits where the height assumes a different value , such as unstable periodic orbits .",
    "the scenario for dissipative maps is simpler ; the orbits , after a transient , relax to a small number of point attractors ( figure [ fig : phaseportraitdiss ] , left ) . in figure",
    "[ fig : phaseportraitdiss ] , right , we plot the approximate height @xmath394 for initial conditions of the type @xmath395 with @xmath28 in an interval which crosses an island . outside the islands",
    "the height jumps wildly between few values , presumably due to the very complicated boundaries of the basins of the various attractors .",
    "we synthesise our findings with two conjectures .",
    "* conjecture 1*. _ let @xmath61 be a piecewise affine map of @xmath56 and let @xmath396 be a bounded orbit of @xmath61 .",
    "then , for each prime @xmath0 , the functions @xmath34 and @xmath35 are almost everywhere constant on @xmath397 , where @xmath398 is the closure of @xmath396 in @xmath310 . _    here the term ` almost everywhere ' refers to full density in expression ( [ eq : density ] ) .    * conjecture 2*. _ let @xmath61 and @xmath396 be as above , and let @xmath396 have zero lyapunov exponent .",
    "then , for any @xmath380 , the height @xmath399 has a ( non - strict ) local maximum at @xmath396 . _    in the present context , we have identified regular orbits with linear bounded orbits within islands , which either foliate the island into invariant ellipses or spiral towards the fixed point in the centre .",
    "no analysis of planar maps would be complete without some reference to more general types of regular orbits , namely quasi - periodic orbits on invariant curves ( not necessarily smooth ) which are topologically conjugate to irrational rotations .",
    "it has long been known that non - smooth symplectic maps may support isolated invariant curves @xcite , and even foliations of non - smooth curves , see figure [ fig : lagarias ] . unfortunately the existence of such curves isolated or not for non - smooth maps can not be established in general , and this limitation applies to piecewise affine maps with rational parameters considered here .",
    "there are however important results for specific models .",
    "these include a specific two - parameter family of piecewise - linear mappings of the type ( [ eq : f ] ) , where a foliation of the plane into invariant curves has been proved ( or can reasonably be conjectured ) to exist @xcite .",
    "these are maps or type ( [ eq : f ] ) , with the piecewise linear functions @xmath400 due to local linearity , these maps transform the lines through the origin into themselves while preserving their order , thereby inducing a circle map with a well - defined rotation number .",
    "the existence of piecewise - smooth invariant curves has been established for some parameter values given by algebraic numbers of degree 2 ( * ? ? ?",
    "* theorem 2.2 ) .",
    "the situation for rational parameters less clear .",
    "if the rotation number is irrational with bounded partial quotients , then an early result by m.  herman ( * ? ?",
    "* theorem viii.5.1 ) implies that ( [ eq : lagarias ] ) is topologically conjugate to a planar rotation . to the authors knowledge",
    ", the required diophantine condition have not been established in the case of rational parameter @xmath401 and @xmath402 in ( [ eq : lagarias ] ) .",
    "numerical experiment suggest that for rational parameters @xmath403 , if the orbits of the map @xmath61 are bounded , then the plane foliates into invariant curves which typically are non - smooth . under such circumstance",
    ", we found that all height functions are constant over the entire plane .",
    "this suggests that conjectures 1 and 2 hold for orbits on invariant curves as well .",
    "we define a module @xmath73 with the property that @xmath72 serves as a minimal phase space for piecewise - affine maps @xmath39 of the form ( [ eq : fgeneral ] ) with @xmath404 .",
    "let @xmath405 and let @xmath378 be the ( possibly empty , or infinite ) set of primes which divide the denominator of @xmath406 for some @xmath407 . if @xmath378 is empty , then we let @xmath408 ; otherwise we let @xmath409\\ ] ] where the product denotes the algebraic ( minkowski ) product of sets .",
    "the set @xmath410 is the sub - ring of @xmath74 consisting of all the rationals whose denominator is divisible only by primes in @xmath378 .",
    "the module @xmath73 of the map @xmath39 is defined as @xmath411 where @xmath412 and the sum denotes algebraic sum of sets .",
    "the set @xmath73 is a @xmath410-module ( a group under addition , with a multiplication by elements of @xmath410 ) .",
    "if @xmath63 is finite , then there is an integer @xmath44 such that @xmath413 to compute @xmath44 , we let @xmath414 be the least common multiple of the denominators of @xmath415 and @xmath416 and let @xmath417 ( this product is finite . ) thus @xmath418 is the largest divisor of @xmath414 which is co - prime to all primes in @xmath378 . then @xmath44 is the least common multiple of the @xmath418s , for @xmath359 .",
    "the set @xmath73 may be embedded in @xmath195 for any prime @xmath0 ( the field @xmath195 is the completion of @xmath74 with respect to the absolute value @xmath99 ) .",
    "if @xmath380 , then @xmath73 is an unbounded dense subset , and so even if the @xmath43 motion is bounded , the @xmath0-adic dynamics may be unbounded .",
    "if @xmath421 and the set @xmath63 of indices is finite , then @xmath73 is bounded in @xmath195 , and if @xmath0 does not divide any of the @xmath418 ( see ( [ eq : dprime ] ) ) , then @xmath73 lies within the unit disc in @xmath195 .",
    "if @xmath63 is infinite , then @xmath73 may still be unbounded even if @xmath421 , that is , the @xmath0-adic height may grow entirely due to the additive action of @xmath39 ( the translations @xmath422 ) ."
  ],
  "abstract_text": [
    "<S> we consider the growth of heights of the points of the orbits of ( piecewise ) affine maps of the plane , with rational parameters . </S>",
    "<S> we analyse the asymptotic growth rate of both global and local ( @xmath0-adic ) heights , for the primes @xmath0 that divide the parameters . </S>",
    "<S> we show that almost all the points in a domain of linearity ( such as an elliptic island in an area - preserving map ) have the same exponential growth rate . </S>",
    "<S> we also show that the convergence of the @xmath0-adic height may be non - uniform , with arbitrarily large fluctuations occurring arbitrarily close to any point . </S>",
    "<S> we explore numerically the behaviour of heights in the chaotic regions , in both area - preserving and dissipative systems . </S>"
  ]
}