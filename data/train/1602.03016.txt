{
  "article_text": [
    "in recent years several advances in microelectronics have permitted the utilization of new devices for carrying out parallel numerical simulations in order to speed up the computational times involved . among the most used hardware devices we can mention multi - core processors @xcite , gpu cards @xcite and fpga boards @xcite . as it is usually the case",
    ", there is no one system better than other for all situations , as the answer is very much dependent on the problem under analysis together with the circumstances of the developers in relationship to budget , programming expertise , development time , etc .",
    "@xcite in this work a fpga based implementation of the two - dimensional ferromagnetic ising model is carried out using monte carlo simulations .",
    "field programmable gate arrays ( fpga ) are reconfigurable hardware devices that can be reprogrammed to implement different combinational and sequential logic created with the aim of prototyping digital circuits as they offer flexibility and speed . in recent years advances in technology have permitted to construct fpgas with considerable large amounts of processing power and memory storage , and as a consequence they have been applied in an ever increasing range of domain , like telecommunications , robotics , pattern recognition tasks , and infrastructure monitoring , among others @xcite , @xcite , @xcite .",
    "the ising model is a paradigm of the statistical physics approach to the study of finite temperature equilibrium properties of many body systems , by reducing complex interactions to their minimal expression ( for a short review see ref.@xcite and references therein ) .",
    "the model assigns a set of binary variables , called spins , to every site of a regular grid or lattice .",
    "every spin represents the component of the local magnetic moment in a crystalline solid , respect to the direction of an external magnetic field . the model is completed by defining an energy function that depends on the values of all spins in the lattice .",
    "statistical mechanics provides then a recipe to derive from the energy function the equilibrium probability distribution of the microscopic configurations of the system ( i.e. , any combination of spin values ) , from which macroscopic properties  like , the total magnetization or mean energy  are obtained by averaging the appropriate variables .    despite its relative simplicity , ising - type models and their generalizations ( e.g. , potts model ,",
    "see @xcite and references therein ) are extensively used to analyze properties of a large variety of systems exhibiting cooperative phenomena , ranging from simple ferromagnetism to complex disordered materials ( e.g. , spin glasses ) @xcite .",
    "moreover , being originally restricted to the realm of solid state physics , they have been shown to be extremely useful in other disciplines , such as soft condensed matter ( e.g. soap bubbles and foam @xcite ) , biology ( e.g. , biological cells @xcite ) and neural networks @xcite .",
    "the cooperative phenomena those models intend to describe are a synergistic result of the interaction among a very large ( macroscopic ) number of relatively simple units .",
    "statistical mechanics theory seeks then to describe the asymptotic behavior of averaged macroscopic quantities  like energy or magnetization  in the limit of an infinite number of units ( the so called thermodynamic limit ) .",
    "however , in most cases it is extremely difficult to obtain such limiting behavior analytically .",
    "thus , the usual approach is to perform numerical simulations for an increasing number of units and then extrapolate the results to the limit of infinite number of units .",
    "this raises the question about the minimum number of units needed to obtain an accurate extrapolation to the thermodynamic limit . while for the estimation of some quantities up to @xmath1 units may be enough ( and attainable in a cpu code in a few hours ) , others may require at least @xmath2 or more units to get reliable results ( see @xcite and references therein ) .",
    "such calculations are only achievable in reasonable time scales with the use of parallel computing .",
    "therefore , it is of critical importance to develop and assess massively parallel implementations of statistical physics models . in that respect ,",
    "the ising model has become one of the most common benchmarks for testing novel statistical mechanics simulation algorithms and parallel computing implementations . the most simple version ( namely , that in which only nearest neighbors spins interact ferromagnetically ) constitutes one of the few examples of an interacting many body system for which non trivial equilibrium properties are known exactly in two spatial dimensions @xcite .",
    "this is not true in general for systems with more complicated interactions .",
    "hence , theoretical analysis is usually limited to approximated methods whose ultimate validity strongly relies on monte carlo numerical simulations .",
    "one of the most common ways to simulate the behavior of ising - type models is the metropolis - hastings algorithm @xcite , which works by generating a sequence of sample configurations of the system that converges to the equilibrium finite temperature distribution .",
    "the metropolis - hastings algorithm requires the use of random numbers and as such is considered a monte carlo type simulation @xcite .",
    "monte carlo simulations depend strongly on the generation of pseudo random numbers and for this reason an efficient simulation normally adapts the algorithms used to the hardware utilized .",
    "in particular , in fpga boards the standard random number generators are based on linear feedback shift registers ( lfsr ) schemes @xcite .",
    "fpga boards can be used as hardware accelerators systems in several domains of applications .",
    "for example in life sciences , several recent works have benefitted from the use of fpga boards for speeding up monte carlo simulations .",
    "the use of fpga boards to study ising type systems is relatively recent and thus just very few works have been published so far . among these , the approach taken by the janus consortium is worth mentioning as they are using a cluster of fpga boards @xcite .",
    "et al_. have studied the two - dimensional ising model @xcite , and more recently gilman have analyzed the 3-d ising model @xcite . in this work ,",
    "further optimization of the parallel updating of spin blocks is achieved by combining a global 32 bit lfsr with a smaller 12-bit local lfsr to get random numbers for the individual spin updates .",
    "based on that strategy , we developed a highly efficient fpga implementation of the metropolis - hastings algorithm for ising type models , which was checked against the exact results for the two dimensional ferromagnetic nearest - neighbor models .",
    "the present implementation shows a considerable performance improvement with respect to previous ones .",
    "the ising model was originally devised to represent a ferromagnetic solid .",
    "it assigns a binary variable @xmath3 , called spin , to each site of a regular lattice in @xmath4 dimensions , where @xmath5 labels the site .",
    "@xmath6 represents the component of the magnetic moment at site @xmath5 respect to the direction of an external magnetic field of intensity @xmath7 . in this work",
    "we have analyzed the 2-dimensional ising model with interactions between nearest neighboring spins , in a square lattice with @xmath8 sites , for this case , the energy of the system ( hamiltonian ) is defined as :    @xmath9    where @xmath10 denotes a sum over all pairs of nearest neighbor sites of the lattice and @xmath11 is the ferromagnetic interaction constant or also called exchange constant . in the absence of a magnetic field @xmath12 , the energy is minimized in the ferromagnetic state , i.e. , when all spins take the same value . in this work we considered @xmath13 and @xmath12 , and used periodic boundary conditions .",
    "the spin dynamics is governed by the metropolis - hastings algorithm , which essentially consists in the update of the present state of a given spin according to the change in the energy @xmath14 produced by the flipping of the spin .",
    "the spin value is changed if its flip reduces the energy , i.e. if @xmath15 .",
    "if @xmath16 the spin flip can be accepted , provided that a generated random number @xmath17 is smaller than the boltzmann factor    @xmath18    where @xmath19 , @xmath20 being the temperature and @xmath21 is the boltzmann constant ( in this work we use @xmath22 ) . in a sequential implementation the algorithm proceeds by picking spins one by one according to some protocol ( usually randomly ) until all spins ( on the average in the case of random picking ) have been updated ( an update means a single trial ; the spin can remain in its previous value after the update ) . once all spins have been updated ,",
    "this is called a monte carlo step ( mcs ) and constitutes the basic iteration time unit .",
    "parallel implementations of the metropolis algorithm in the square lattice make use of the nearest - neighbor interactions as follows .",
    "let @xmath23 the spin to be updated .",
    "then it is easy to see that the change in energy ( [ ecuhamilton ] ) ( with @xmath12 ) produced by a single spin flip @xmath24 is given by @xmath25 , where    @xmath26    and @xmath27 denote the four nearest neighbors spins of @xmath23 .",
    "the square lattice can be divided into two square sublattices with a checkerboard structure , in such a way that the nearest neighbors of any spin in a given sublattice belongs to the other ( see section [ implementation ] for details ) . hence ,",
    "all spins in a sublattice can be updated simultaneously without risk of concurrency issues .",
    "a mcs is then completed by one updating of the two sublattices .    in a typical simulation a sequence of random spins configurations",
    "is generated from some initial one , by successive application of the above algorithm .",
    "for a long enough sequence ( measured in mcs ) it can be shown that the probability distribution for spins configurations becomes stationary @xcite .",
    "further application of the algorithm provides a sample set of configurations over which averages of quantities of interest can be calculated .",
    "a typical quantity is the average magnetization per spin :    @xmath28    where @xmath29 and @xmath30 stands for an average over a single equilibrated mc sequence of spins configurations .",
    "another quantity of interest is the zero field magnetic susceptibility , which characterizes the linear response of the system to an externally applied magnetic field .",
    "the magnetic susceptibility can be computed form the fluctuations in the magnetization as follows :    @xmath31    in the thermodynamic limit ( infinite lattice size ) when @xmath12 and @xmath32 , this model undergoes a second order phase transition at a very well defined critical temperature @xmath33 , namely , the magnetization becomes zero for @xmath34 and different from zero for @xmath35 .",
    "also the susceptibility diverges at @xmath36 as @xmath37 , where @xmath38 is a critical exponent that depends only on the dimensionality @xmath4 @xcite .",
    "fpgas @xcite are reprogrammable silicon chips , using pre - built logic blocks and programmable routing resources .",
    "they can be configured to implement custom hardware functionality , and in this sense , fpgas are completely reconfigurable and can almost instantly change its behavior by recompiling a new circuitry configuration .",
    "the board used for the current implementation is the virtex-5 opensparc evaluation platform ( ml509 ) .",
    "this device includes a xilinx virtex-5 xc5vlx110 t fpga that provides different connector devices : 2 usbports , 2 ps/2 ports , rj-45 and rs-232 connectors , 2 audio inputs , 2 audio outputs , video input , video output , single - ended and differential i / o expansion . table [ tabledeviced ] shows some characteristics of the virtex-5 xc5vlx110 t fpga , indicating its main logic resources .",
    "all computations have been performed using fixed point arithmetic , which is the standard way to work with fpga boards .",
    "even if floating point operations can be codified efficiently in fpga boards without significant additional resources @xcite , they tend to be less efficient than fixed point arithmetic , as it is also the case for most digital circuits .",
    "the fpga implementation parallelizes the spin updates in order to compute faster the system evolution .",
    "the actual value of the spins @xmath39 are stored as boolean values using memory blocks while the spin dynamics is implemented using groups of luts . for larger lattice sizes ,",
    "the number of luts available is not enough to simulate the dynamics of the whole lattice so the process is carried out in a number of steps in which a group of spin rows is updated .",
    "figure [ figising ] shows the hardware implementation of a spin . on the left side of the figure ,",
    "six different inputs and two clock signals are shown . from top to bottom , we see the first input ( `` spin '' ) that gets the spin value from the register .",
    "the following four inputs correspond to the adjacent nearest - neighbor spins of the one under consideration , and they are indicated by ` l ' ( left ) , ` t ' ( top ) , ` r ' ( right ) and ` b ' ( bottom ) . the current spin value is taken from the grey block of registers , while the four adjacent spin values are taken from the white one ( see fig .",
    "[ figsys1 ] ) .",
    "the input indicated by lfsr32 is a generic ( pseudo ) random signal that will be combined with a local lfsr through a xor gate for obtaining a local random value ( see details of this process in section [ seclfsr ] ) .",
    "two clock signals are used , one corresponding to the system clock signal ( clk_a ) , and another with double frequency ( clk_b ) obtained using a pll in order to read the values of the lookup table .",
    "the frequency of clk_b is twice that of clk_a to allow the whole updating process to be completed in one system clock cycle .",
    "the spin updating process starts by computing the summation of the values of the four adjacent spins ( this process is indicated in the left top corner of the fig .",
    "[ figising ] ) , noting that first the representation of these four spins is changed from the boolean one used in the register @xmath40 to a binary one ( @xmath39 ) used in the dynamics of the system ( the representation modification is indicated within a dotted circle at the top left of the figure ) .",
    "the process continues with the calculation of the local function @xmath41 ( see eq .",
    "[ ecuenergy ] ) , that is computed multiplexing the sum value of the four adjacent spins the current spin value .",
    "the following step consists in the computation of the exponential of @xmath42 , which is done using a lookup table that stores every possible values of the function @xmath43 .",
    "thus , the number of entries of the look - up table is five as these are the number of possible different values of @xmath44 .",
    "the values of @xmath43 were represented using a word length of 12 .",
    "the lookup table was implemented using configurable logic blocks ( clbs ) , in order to save ram resources for storing spin configurations , as only 5 luts are needed .",
    "the new value of the spin can be the same as the current one or its opposite ( according to the dynamics of the model ) .",
    "this last case can be due to a decrease on the energy associated with the spin ( @xmath45 ) or in case that there is an energy increase , if the value of @xmath43 is larger than a random number ( indicated as @xmath17 in fig .",
    "[ figising ] ) .",
    "these two cases are implemented through an or gate that receives signals from two comparison gates that evaluates the procedure previously described .",
    "the output signal of the or gate ( indicated by s_change ) is then xor with the spin value in order to obtain the updated one .",
    "finally , the new updated value is registered in order to synchronize the procedure .",
    ".[tablesummary]logic utilization for the hardware implementation of a single spin [ cols=\"<,^\",options=\"header \" , ]",
    "the implementation described in the sections above can be extended with relatively modest modifications to systems of current research interest . here",
    "we will describe three basic extensions that will illustrate the required changes in the implementation .",
    "perhaps the simplest extension involves the inclusion of next - nearest - neighbor interactions .",
    "the next - nearest neighbors of the spin at position @xmath46 are defined as the four spins at positions @xmath47 , that is along the diagonals of the spin at @xmath46 .",
    "of particular interest is the case in which the interaction with first neighbors is ferromagnetic and anti - ferromagnetic with next - nearest neighbors .",
    "this can be modelled by introducing a negative exchange constant that mediates the interaction of each spin with the second neighbors , as represented in the following hamiltonian :    @xmath48    where @xmath49 , @xmath50 , and @xmath51 denotes that the sum runs over all next - nearest neighbor pairs .",
    "this model represents a binary spin version of the @xmath52 model @xcite .",
    "the implementation of the binary @xmath52 model requires a small number of changes in the logic of the fpga circuit shown in fig .",
    "[ figising ] .",
    "the main differences are the following :    a.   the values of the four next - nearest neighbor of the spin to be updated ( l,t,r , and b ) need to be considered in the circuit .",
    "b.   instead of the checkboard division into two sublattices the system can be divided into four sublattices in such a way that spins belonging to the same sublattice are neither nearest neighbors nor next - nearest neighbors  hence , requiring four memory modules to store the spin values of each sublattice . c.   the change in energy associated with a single spin flip is equal to @xmath53 , where @xmath54 is given by the following expression , @xmath55 d.   the look - up table for the energy values needs to be expanded since now",
    "the change in energy can take a wider range of values . in practical implementation",
    "it is usual to take @xmath56 or @xmath57 equal to 1 and then allow the other exchange constant to adjust the relative strength of the ferromagnetic / anti - ferromagnetic interactions .",
    "a second example of possible extensions is the implementation of the potts model @xcite .",
    "the potts model is a generalization of the ising model in which each individual spin can take an integer value @xmath58 .",
    "its hamiltonian is given by the following : @xmath59 where @xmath60 is the kronecker delta , whose value is 1 if @xmath61 and zero otherwise .",
    "the implementation of the potts model implies some more significant changes to the logic in fig .",
    "[ figising ] .",
    "the main ones are the following :    a.   instead of using boolean variables as in the case of the ising model , the potts model requires that each spin can take one of @xmath62 different states b.   for the update of spin @xmath6 into the new state @xmath63 the monte carlo algorithm proceeds by choosing at random one of the @xmath64 states for which @xmath65 , then computing the corresponding energy difference @xmath14 that the change implies , and finally the decision to accept it or not follows the same logic as the one for the ising model .",
    "one final example is the 3-d ising model .",
    "its implementation requires a small modification of the spin block in comparison with the 2-d ising , as 6 neighboring spins should be considered instead of 4 .",
    "this change will affect the size of the lookup table because the energy range will be larger .",
    "memory management for this model will be also more complex and as in principle memory resources may not be enough to handle the whole system divided in two sub - lattices , but a layered scheme should be used where the whole system is analyzed as composed of m 2-d ising models .",
    "the results of this work confirm the potential of fpga boards for the simulation of statistical mechanics models , demonstrating a significant improvement in terms of the numbers of spins updated per second was obtained in comparison to previous work ( table [ tableres ] ) .",
    "the improvements in performance are a consequence of efficient spin implementation and resource utilization .",
    "the spin representation was clearly described and analyzed in terms of the logic resources involved ( cf . figs [ figising ] and [ figmemoria ] , and table [ tablesummary ] ) , and the use of a combined global - local random number lfsr generator proved to be a significant factor in increased performance . the procedure based on the combination of two lfsr ( one local and one global with the respect to the implementation of a block of spins ) was used , rigorously tested in terms of the quality of the random numbers produced using a standard suite of statistical tests @xcite . in relation to the previous work by lin et al .",
    "@xcite , it is worth noting that their analysis showed that using a true rng does not improved much the quality of the random numbers obtained . on the other hand ,",
    "our approach used a local lfsr instead of a ca , and this fact permitted us to utilize efficiently the board resources to get faster spin updates .",
    "these improvements summed to the parallelism provided by the fpga implementation offer a significant potential for extensions to other models of magnetic systems .",
    "the 2-d ising model requires a minimal number of modifications to be extended to more complicated models like the binary spin version of the @xmath52 model , the potts model , or the 3-d ising model .",
    "further work is required to exploit the massive parallelism of fpgas in systems with more complex ( long - range ) interactions like the ising dipolar model @xcite , which would require a complete redesign of the logic involved .",
    "the authors gratefully acknowledge the constructive comments made by the anonymous reviewers . the authors acknowledge support from junta de andalucia through grants p10-tic-5770 , from miciin(spain ) through grants tin2010 - 16556 and tin2014 - 58516-c2 - 1-r ( all including feder funds ) , and from conicet ( argentina ) through grant pip11220110100213 .",
    "m.  a. suchard , q.  wang , c.  chan , j.  frelinger , a.  cron , and m.  west , `` understanding gpu programming for statistical computation : studies in massively parallel massive mixtures , '' _ journal of computational and graphical statistics _ ,",
    "19 , no .  2 ,",
    "pp . 419438 , 2010 .",
    "k.  sano , y.  hatsuda , and s.  yamamoto , `` multi - fpga accelerator for scalable stencil computation with constant memory bandwidth , '' _ parallel and distributed systems , ieee transactions on _ , vol .  25 , no .  3 , pp .",
    "695705 , march 2014 .",
    "r.  weber , a.  gothandaraman , r.  hinde , and g.  peterson , `` comparing hardware accelerators in scientific applications : a case study , '' _ parallel and distributed systems , ieee transactions on _ , vol .",
    "22 , no .  1 ,",
    "5868 , jan 2011 .",
    "s.  sun and j.  zambreno , `` design and analysis of a reconfigurable platform for frequent pattern mining , '' _ parallel and distributed systems , ieee transactions on _ , vol .",
    "22 , no .  9 , pp . 14971505 , sept 2011 .",
    "t.  ganegedara , w.  jiang , and v.  prasanna , `` a scalable and modular architecture for high - performance packet classification , '' _ parallel and distributed systems , ieee transactions on _ , vol .  25 , no .  5 , pp . 11351144 , may 2014 .",
    "e.  e. ferrero , j.  p. de francesco , n.  wolovick , and s.  a. cannas , `` q - state potts model metastability study using optimized gpu - based monte carlo algorithms , '' _ computer physics communications _",
    "183 , p. 1578",
    ", 2012 .",
    "j.  cassidy , l.  lilge , and v.  betz , `` fast , power - efficient biophotonic simulations for cancer treatment using fpgas , '' in _ field - programmable custom computing machines ( fccm ) , 2014 ieee 22nd annual international symposium on _ , may 2014 , pp .",
    "133140 .",
    "m.  saito and m.  matsumoto , `` simd - oriented fast mersenne twister : a 128-bit pseudorandom number generator , '' in _ monte carlo and quasi - monte carlo methods 2006 _ , a.  keller , s.  heinrich , and h.  niederreiter , eds.1em plus 0.5em minus 0.4emberlin , heidelberg : springer berlin heidelberg , 2008 , ch .",
    "36 , pp . 607622 .",
    "a.  rukhin , j.  soto , j.  nechvatal , e.  barker , s.  leigh , m.  levenson , d.  banks , a.  heckert , j.  dray , s.  vo , a.  rukhin , j.  soto , m.  smid , s.  leigh , m.  vangel , a.  heckert , j.  dray , and l.  e.  b. iii , `` a statistical test suite for random and pseudorandom number generators for cryptographic applications , '' 2010 .",
    "d.  jones , a.  powell , c.  bouganis , and p.  cheung , `` gpu versus fpga for high productivity computing , '' in _ field programmable logic and applications ( fpl ) , 2010 international conference on _ , aug 2010 , pp . 119124 .            f.  ortega - zamorano , m.  a. montemurro , s.  cannas , j.  jerez , and l.  franco , `` fpga hardware acceleration of monte carlo simulations for the ising model , '' _ ieee transactions on parallel & distributed systems _",
    ", no .  1 , pp . 11 .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1109/tpds.2015.2505725"
  ],
  "abstract_text": [
    "<S> a two - dimensional ising model with nearest - neighbors ferromagnetic interactions is implemented in a field programmable gate array ( fpga ) board . </S>",
    "<S> extensive monte carlo simulations were carried out using an efficient hardware representation of individual spins and a combined global - local lfsr random number generator . </S>",
    "<S> consistent results regarding the descriptive properties of magnetic systems , like energy , magnetization and susceptibility are obtained while a speed - up factor of approximately 6 times is achieved in comparison to previous fpga - based published works and almost @xmath0 times in comparison to a standard cpu simulation . </S>",
    "<S> a detailed description of the logic design used is given together with a careful analysis of the quality of the random number generator used . </S>",
    "<S> the obtained results confirm the potential of fpgas for analyzing the statistical mechanics of magnetic systems .    _ </S>",
    "<S> * keywords : * _ hardware implementation , lfsr random number generator , monte carlo simulations , ising model . </S>"
  ]
}