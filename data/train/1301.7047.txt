{
  "article_text": [
    "a variety of data in many different fields can be described by networks .",
    "examples include friendship and social networks , food webs , protein - protein interaction and gene regulatory networks , the world wide web , and many others .",
    "one of the fundamental problems in network science is link prediction , where the goal is to predict the existence of a link between two nodes based on observed links between other nodes as well as additional information about the nodes ( node covariates ) when available ( see , @xcite and @xcite for recent reviews ) .",
    "link prediction has wide applications .",
    "for example , recommendation of new friends or connections for members is an important service in online social networks such as facebook . in biological networks , such as protein - protein interaction and gene regulatory networks ,",
    "it is usually time - consuming and expensive to test existence of links by comprehensive experiments ; link prediction in these biological networks can provide specific targets for future experiments .",
    "there are two different settings under which the link prediction problem is commonly studied . in the first",
    "setting , a snapshot of the network at time @xmath0 , or a sequence of snapshots at times @xmath1 , is used to predict new links that are likely to appear in the near future ( at time @xmath2 ) . in the second",
    "setting , the network is treated as static but not fully observed , and the task is to fill in the missing links in such a partially observed network .",
    "these two tasks are related in practice , since a network evolving over time can also be partially observed and a missing link is more likely to emerge in the future . from the analysis point of view , however , these settings are quite different ; in this paper , we focus on the partially observed setting and do not consider networks evolving over time .",
    "there are several types of methods for the link prediction problem in the literature .",
    "the first class of methods consists of unsupervised approaches based on various types of node similarities .",
    "these methods assign a similarity score @xmath3 to each pair of nodes @xmath4 and @xmath5 , and higher similarity scores are assumed to imply higher probabilities of a link .",
    "similarities can be based either on node attributes or solely on the network structure , such as the number of common neighbors ; the latter are known as structural similarities .",
    "typical choices of structural similarity measures include local indices based on common neighbors , such as the jaccard index @xcite or the adamic - adar index @xcite , and global indices based on the ensemble of all paths , such as the katz index @xcite and the leicht - holme - newman index @xcite .",
    "comprehensive reviews of such similarity measures can be found in @xcite and .",
    "another class of approaches to link prediction includes supervised learning methods that use both network structures and node attributes .",
    "these methods treat link prediction as a binary classification problem , where the responses are @xmath6 indicating whether there exists a link for a pair , and the predictors are covariates for each pair , which are constructed from node attributes .",
    "a number of popular supervised learning methods have been applied to the link prediction problem .",
    "for example , @xcite and @xcite use the support vector machine with pairwise kernels , and @xcite compares the performance of several supervised learning methods .",
    "other supervised methods use probabilistic models for incomplete networks to do link prediction , for example , the hierarchical structure models @xcite , latent space models @xcite , latent variable models @xcite , and stochastic relational models @xcite .",
    "our approach falls in the supervised learning category , in the sense that we make use of both the node similarities and observed links . however , one difficulty in treating link prediction as a straightforward classification problem is the lack of certainty about the negative and positive examples",
    "this is particularly true for negative examples ( absent edges ) . in biological networks",
    "in particular , there may be no certain negative examples at all @xcite .",
    "for instance , in a protein - protein interaction network , an absent edge may not mean that there is no interaction between the two proteins ",
    "instead , it may indicate that the experiment to test that interaction has not been done , or that it did not have enough sensitivity to detect the interaction .",
    "positive examples could sometimes also be spurious  for example , high - throughput experiments can yield a large number of false positive protein - protein interactions @xcite . here",
    "we propose a new link prediction method that allows for the presence of both false positive and false negative examples .",
    "more formally , we assume that the network we observe is the true network with independent observation errors , i.e. , with some true edges missing and other edges recorded erroneously .",
    "the error rates for both kinds of errors are assumed unknown , and in fact can not be estimated under this framework .",
    "however , we can provide rankings of potential links in order of their estimated probabilities , for node pairs with observed links as well as for node pairs with no observed links .",
    "these relative rankings rather than absolute probabilities of edges are sufficient in many applications .",
    "for example , pairs of proteins without observed interactions that rank highly could be given priority in subsequent experiments .",
    "to obtain these rankings , we utilize node covariates when available , and/or network topology based on observed links .",
    "the rest of the paper is organized as follows . in section [ sec :",
    "model ] , we specify our ( rather minimal ) model assumptions for the network and the edge errors .",
    "we propose link ranking criteria for both directed and undirected networks in section [ sec : meth ] .",
    "the algorithms used to optimize these criteria are discussed in section [ sec : alg ] . in section [ sec : sim ] we compare performance of proposed criteria to other link prediction methods on simulated networks . in section [ sec",
    ": data ] , we apply our methods to link prediction in a protein - protein interaction network and a school friendship network .",
    "section [ sec : summary ] concludes with a summary and discussion of future directions .",
    "a network with @xmath7 nodes ( vertices ) can be represented by an @xmath8 adjacency matrix @xmath9 $ ] , where @xmath10 we will consider the link prediction problem for both undirected and directed networks",
    ". therefore @xmath11 can be either symmetric ( for undirected networks ) or asymmetric ( for directed networks ) .    in our framework , we distinguish between the adjacency matrix of the true underlying network @xmath12 , and its observed version @xmath11 .",
    "we assume that each @xmath13 follows a bernoulli distribution with @xmath14 .",
    "given the true network , we assume that the observed network is generated by @xmath15 where @xmath16 and @xmath17 are the probabilities of correctly recording a true edge and an absent edge , respectively . note that we assume that this probability is constant and does not depend on @xmath4 , @xmath5 , or @xmath18 .",
    "then we have @xmath19 if the values of @xmath16 , @xmath17 and @xmath18 were known , then the probabilities of true edges conditional on the observed adjacency matrix could have been estimated as @xmath20 it is easy to check that both and are monotone increasing functions of @xmath18 .",
    "taking into account implies that they are also increasing functions of @xmath21 as long as @xmath22 .",
    "this gives us a crucial observation : if the goal is to obtain relative rankings of potential links , it is sufficient to estimate @xmath21 , and it is not necessary to know @xmath16 , @xmath17 and @xmath18 .    an important special case in this setting is @xmath23",
    ". then all the observed links are true positives , and we only need to provide a ranking for node pairs without observed links .",
    "this can be applied in recommender systems , for example , for recommending possible new friends in a social network .",
    "another special case is when @xmath24 , which corresponds to all absent edges being true negatives .",
    "this setting can be used to frame the problem of investigating reliability of observed links , for example , in a gene regulatory network inferred from high - throughput gene expression data .",
    "an estimate of @xmath25 $ ] provides rankings for both these special cases and the general problem , and thus we focus on estimating @xmath21 for the rest of the paper .",
    "in this section , we propose criteria for estimating the probabilities of edges in the observed network , @xmath26 , for both directed and undirected networks .",
    "the criteria rely on a symmetric matrix @xmath27 $ ] with @xmath28 , which describes the similarity between nodes @xmath4 and @xmath29 .",
    "the similarity matrix @xmath30 can be obtained from different sources , including node information , network topology , or a combination of the two .",
    "we will discuss choices of @xmath30 later in this section .",
    "first we consider directed networks .",
    "the key assumption we make is that if two pairs of nodes are similar to each other , the probability of links within these two pairs are also similar .",
    "specifically , in figure [ fig : directed - intuition ] , @xmath18 and @xmath31 are assumed close in value if node @xmath4 is similar to node @xmath29 and node @xmath5 is similar to node @xmath32 . for directed networks , we measure similarity of node pairs @xmath33 and @xmath34 by the product @xmath35 ( see figure [ fig : directed - intuition ] ) , which implies two pairs are similar only if both pairs of endpoints are similar . this assumption should not to be confused with a different assumption made by many unsupervised link prediction methods , which assume that a link is more likely to exist between similar nodes , applicable to networks with assortative mixing .",
    "assortative networks are common  a typical example is a social network , where people commonly tend to be friends with those of similar age , income level , race , etc .",
    "however , there are also networks with disassortative mixing , in which the assumption that similar pairs are more likely to be connected is no longer valid  for example , predators do not typically feed on each other in a food web .",
    "our assumption , in contrast , is equally plausible for both assortative and disassortative networks , as well as more general settings , as it does not assume anything about the relationship between @xmath18 and @xmath36 .    motivated by this assumption of similar probabilities of links for similar node pairs , we propose to estimate @xmath37 by @xmath38 where @xmath39 is a real - valued @xmath40 matrix , and @xmath41 is a tuning parameter .",
    "the first term is the usual squared error loss connecting the parameters with the observed network .",
    "the minimizer of its population version , i.e. , @xmath42 is @xmath21 .",
    "the second term enforces our key assumption , penalizing the difference between @xmath43 and @xmath44 more if two node pairs @xmath33 and @xmath34 are similar .",
    "the choice of the squared error loss is not crucial , and other commonly used loss functions could be considered instead , for example , the hinge loss or the negative log - likelihood .",
    "the main reason for choosing the squared error loss is computational efficiency , since it makes a quadratic problem ; see more on this details in section [ sec : alg ] .    in some applications , we may have additional information about true positive and negative examples , i.e. , some @xmath45 s may be known to be true 1 s and true 0 s , while others may be uncertain .",
    "this could happen , for example , when validation experiments have been conducted on a subset of a gene or protein network inferred from expression data .",
    "if such information is available , it makes sense to use it , and we can then modify criterion as follows : @xmath46 where @xmath47 if it is known that @xmath48 , and 0 otherwise .",
    "this is similar to a semi - supervised criterion proposed in @xcite .",
    "however , @xcite did not consider the uncertainty in positive and negative examples , nor did they consider the undirected case which we discuss next . since only involves a partial sum of the loss function terms , we will refer to as the partial - sum criterion and as the full - sum criterion for the rest of the paper .      for undirected networks , our key assumption that @xmath18 and @xmath31 are close if two pairs @xmath33 and @xmath34 are similar needs to take into account that the direction no longer matters ; thus the pairs are similar if either @xmath4 is similar to @xmath29 and @xmath5 is similar to @xmath32 , or if @xmath4 is similar to @xmath32 and @xmath5 is similar to @xmath29 ( see figure [ fig : undirected - intuition ] .",
    "thus we need a new pair similarity measure that combines @xmath35 and @xmath49 .",
    "there are multiple options ; for example , two natural combinations are @xmath50 empirically , we found that @xmath51 performs better than @xmath52 for a range of real and simulated networks .",
    "the reason for this can be easily illustrated on the stochastic block model .",
    "the stochastic block model is a commonly used model for networks with communities , where the probability of a link only depends on the community labels of its two endpoints .",
    "specifically , given community labels @xmath53 , @xmath13 s are independent bernoulli random variables with @xmath54 where @xmath55 $ ] is a @xmath56 symmetric matrix , and @xmath57 is the number of communities in the network .",
    "suppose we have the best similarity measure we can possibly hope to have based on the truth , @xmath58 , where @xmath59 is the indicator function .",
    "in that case , implies @xmath60 if @xmath61 , whereas the sum of the weights would be misleading .    using @xmath51 as the measure of pair similarity , we propose estimating @xmath26 for undirected networks by @xmath62 similarly to the directed case ,",
    "if we have information about true positive and negative examples , we can use a partial - sum criterion @xmath63 where @xmath47 if it is known that @xmath48 , otherwise @xmath64 .",
    "the last component we need to specify is the node similarity matrix @xmath30 .",
    "one typical situation is when we have reasons to believe that the external node covariates are related to the structure of the network , in which case it is natural to use covariate information to construct @xmath65 .",
    "though more complicated formats do exist , node covariates are typically represented by an @xmath66 matrix @xmath67 where @xmath68 is the value of variable @xmath69 on node @xmath4 .",
    "then @xmath65 can be taken to be some similarity measure between the @xmath4-th and @xmath29-th rows of @xmath67 .",
    "for example , if @xmath67 contains only numerical variables and has been standardized , we can use the exponential decay kernel , @xmath70 where @xmath71 is the euclidean vector norm .",
    "when node covariates are not available , node similarity @xmath65 is usually obtained from the topology of the observed network @xmath11 , i.e. , @xmath65 is large if @xmath4 and @xmath29 have a similar pattern of connections with other nodes . for undirected networks ,",
    "a simple choice of @xmath65 could be @xmath72 where @xmath73 denotes cardinality of a set .",
    "this particular measure turns out to be not very useful : since most real networks are sparse , most entries of any @xmath69-th column will be 0 , and thus most of @xmath65 s would be large .",
    "a more informative measure is the jaccard index @xcite , @xmath74 where @xmath75 is the set of neighbors of node @xmath4 .",
    "the directed networks case is similar , except we need to count the in and the out links separately .",
    "the formulas corresponding to and become @xmath76 where @xmath77 and @xmath78 .",
    "the proposed link prediction criteria are convex and quadratic in parameters , and thus optimization is fairly straightforward .",
    "the obvious approach is to treat the matrix @xmath39 as a long vector with @xmath79 elements ( or @xmath80 in the undirected case ) , and solve the linear system obtained by taking the first derivative of any criterion above with respect to this vector .",
    "however , solving a system of linear equations could be challenging for large - scale problems @xcite ; the number of parameters here is @xmath81 , and so the linear system requires @xmath82 memory .",
    "however , if @xmath30 is sparse , or sparsified by applying thresholding or some other similar method , then solving the linear system is the efficient choice .",
    "if the @xmath30 matrix is not sparse , an iterative algorithm with sequential updates that only requires @xmath81 memory would be a better choice than solving the linear system .",
    "we propose an iterative algorithm following the idea of block coordinate descent @xcite . a block coordinate descent algorithm partitions the coordinates into blocks and iteratively optimizes the criterion with respect to each block while holding the other blocks fixed .",
    "first , we derive the update equations for directed networks .",
    "note and can be written in the general form @xmath83 where @xmath84 for and @xmath85 for . for any matrix @xmath86 ,",
    "let @xmath87 be the @xmath4th row of @xmath86 .",
    "we treat @xmath88 as a block , and update @xmath89 iteratively . define @xmath90",
    ". then @xmath91 let @xmath92 be an @xmath40 diagonal matrix with @xmath93 . then @xmath94 plugging and into , and taking the first derivative of @xmath95 with respect to @xmath89 , we obtain @xmath96 .",
    "\\nonumber\\end{aligned}\\ ] ] solving @xmath97 with respect to @xmath89 , we obtain the updating formula @xmath98 where @xmath99 is the value of @xmath100 at iteration @xmath0 .    this update is fast to compute but its derivation relies on the product form of @xmath65 and @xmath101 , and thus is not directly applicable in the undirected case , where @xmath51 is used as the similarity measure .",
    "however , we can still approximate @xmath51 with a product , using the fact that for @xmath102 , @xmath103 { x^q+y^q}= \\max(x , y)$ ] .",
    "thus , for sufficiently large @xmath104 , we have @xmath105^q \\approx ( w_{ii'}w_{jj'})^q + ( w_{ij'}w_{ji'})^q . \\label{appx}\\end{aligned}\\ ] ] further , @xmath106 is a monotone transformation of @xmath30 and can also serve as a similarity measure .",
    "based on , we propose to substitute the following approximate criterion for undirected networks , @xmath107 where @xmath108 for the full sum criterion and @xmath85 for the partial sum criterion . by symmetry , @xmath109 this is now in the same form as , with each term in the sum containing a product of @xmath65 and @xmath101 , and therefore can be solved by block coordinate descent with an analogous updating equation as that in the directed network case .    in practice",
    ", we found that when @xmath30 is sparse or truncated to be sparse , solving the linear system can be much faster than the block coordinate descent method ; however , when @xmath30 is dense and the number of nodes is reasonably large , the block coordinate descent method dominates directly solving linear equations .",
    "in this section , we test performance of our link prediction methods on simulated networks . in all cases ,",
    "each network consists of @xmath110 nodes , and node @xmath4 s covariates @xmath111 are independently generated from a multivariate normal distribution @xmath112 with @xmath113 .",
    "each @xmath114 is generated independently , with @xmath115 .",
    "we consider the following functions @xmath116 : @xmath117 the right hand column gives sparser versions of functions in the left hand column ( subtracting a constant within the logit link functions lowers the overall degree ) , which we use to compare dense and sparse networks ( the average degrees of all these networks are reported in figures [ fig : sim1 ] and [ fig : sim2 ] ) .",
    "functions ( a ) and ( b ) are asymmetric in @xmath111 and @xmath118 , giving directed networks , while ( c ) and ( d ) are symmetric functions corresponding to undirected networks .",
    "further , @xmath119 and @xmath120 are linear functions ; @xmath121 is the projection model proposed in @xcite , under which the link probability is determined by the projection of @xmath111 onto the direction of @xmath118 , and @xmath122 is an undirected version of the projection model .",
    "we also generate indicators @xmath123 s as independent bernoulli variables taking values 1 and 0 with equal probability , and set @xmath124 .",
    "this setup corresponds to the `` partially observed '' network of the title , where all the observed edges are true but the missing edges may or may not be true 0s .",
    "since we have node covariates affecting the probabilities of links in this case , we define the similarity matrix @xmath30 by @xmath70 where we choose @xmath125 .",
    "after truncating @xmath30 at 0.1 , we optimize all criteria by solving linear equations , with @xmath41 chosen by 5-fold cross validation .    the performance of link prediction is evaluated on the `` test '' set @xmath126 .",
    "we report roc curves , which only depend on the rankings of the estimates @xmath127 rather than their numerical values .",
    "specifically , let @xmath128 be the ranking of @xmath127 on the test set in descending order .",
    "for any integer @xmath69 , we define false positives as pairs @xmath129 ranked within top @xmath69 but without links in the true network ( @xmath130 ) , and true positives as pairs ranked within top @xmath69 with @xmath131",
    ". then the true positive rate ( tpr ) and the false positive rate ( fpr ) are defined by @xmath132 the roc curves showing the false positive rate vs.  the true positive rate over a range of @xmath69 values are shown in figures [ fig : sim1 ] ( directed networks ) and [ fig : sim2 ] ( undirected networks ) .",
    "each curve is the average of 20 replicates .",
    "we also show the roc curve constructed from true @xmath18 s as a benchmark ..    overall , both the full sum and the partial sum criteria perform well .",
    "there is little difference between directed network models and their undirected versions .",
    "as expected , the partial sum criterion always gives better results since it has more information and only uses the true positive and negative examples for training .",
    "but its performance is quite comparable to the completely unsupervised full sum criterion , except perhaps for model @xmath120 .",
    "the gaps between the unsupervised full sum criterion and semi - supervised partial sum criterion become smaller for sparse networks , as the false negatives in the full sum are only a small proportion of the large number of true negatives in a sparse network .",
    "the roc curve obtained from the true model in sparse networks is better than in the corresponding dense networks ; this seemingly counter - intuitive finding is also explained by the large number of 0s in sparse networks .",
    "however , gaps between both our link prediction methods and the true model are larger in all the sparse networks than in their dense counterparts .",
    "this confirms the observation that a small number of positive examples in sparse networks makes the link prediction problem challenging .",
    "our first application is to an undirected network containing yeast protein - protein interactions from @xcite .",
    "this network was edited to contain only highly reliable interactions supported by multiple experiments @xcite , resulting in 984 protein nodes and 2438 edges , with the average node degree about 5 .",
    "we take this verified network to be the true underlying network @xmath12 .",
    "@xcite also constructed a matrix measuring similarities between proteins based on gene expression , protein localization , phylogenetic profiles and yeast two - hybrid data , which we use as the node similarity matrix @xmath30 for link prediction .    here , we compare the full sum criterion , the partial sum criterion , and the latent variable model proposed by @xcite . to test prediction , we generate indicators @xmath123 s as independent bernoulli variables taking value 1 with probability @xmath16 , and set @xmath133 .",
    "we consider three different values of @xmath16 , @xmath134 , corresponding to different amounts of available information .",
    "we use the block coordinate descent algorithm proposed in section [ sec : alg ] to approximately optimize and , with @xmath135 and @xmath41 chosen by cross - validation .",
    "the latent variable model depends on a tuning parameter @xmath57 , the dimension of the latent space .",
    "we fix @xmath136 since larger values of @xmath57 do not significantly change the performance in this example .",
    "we again use roc curves to evaluate the link prediction performance on the set @xmath126 .",
    "each roc curve in figure [ fig : ppi ] is the average of 10 random realizations of @xmath123 s .",
    "the semi - supervised criterion always performs better than the unsupervised criterion , as it should .",
    "further , the semi - supervised criterion almost always outperforms the latent variable model , except for very small values of the false positive rate , and the fully unsupervised criterion also starts to outperform the latent variable model as the false positive rate increases .",
    "the latent variable model is also more sensitive to the sampling rate @xmath16 , with performance deteriorating for @xmath137 .",
    "this is because the model relies heavily on the structure of the network , and a low sampling rate may substantially distort the overall network topology .",
    "on the other hand , we use the node similarity matrix @xmath30 which depends only on the features of the proteins , and is thus unaffected by the sampling rate .",
    "this dataset is a school friendship network from the national longitudinal study of adolescent health ( see @xcite for detailed information ) .",
    "this network contains 1011 high school students and 5459 directed links connecting students to their friends , as reported by the students themselves .",
    "the average degree of this network is also around @xmath138 .",
    "here we test our two link prediction criteria , with the same settings for @xmath123 as in the protein example .",
    "since the latent variable model of @xcite is not applicable to directed networks , we omit it here . due to lack of node covariates",
    ", we construct a network - based similarity @xmath30 by using the jaccard index defined in .",
    "we again apply block coordinate descent to minimize the criteria with @xmath41 chosen by cross - validation , and report the average roc curves over 10 realizations of @xmath123 s . as shown in figure [ fig : school ] , both criteria perform fairly well for @xmath139 and @xmath140 , but fail for @xmath141 , as the sampling rate is too small for @xmath30 to capture the overall network topology .",
    "this does not happen in the protein - protein interactions network , since @xmath30 is constructed from covariates on proteins and is unaffected by sub - sampling .",
    "in this article , we have proposed a new framework for link prediction that allows uncertainty in observed links and non - links of a given network .",
    "our method can provide relative rankings of potential links for pairs with and without observed links .",
    "the proposed link prediction criteria are fully non - parametric and essentially model - free , relying only on the assumption that similar node pairs have similar link probabilities , which is valid for a wide range of network models .",
    "one direction we would like to explore in the future is to combine more specific parametric network models with our non - parametric approach , with the goal of achieving both robustness and efficiency .",
    "we are also investigating consistency properties of our method , which is challenging because it requires developing a novel theoretical framework for evaluating consistency of rankings .",
    "we are also developing extensions that would allow the probabilities of errors , @xmath16 and @xmath17 , to depend on the underlying probabilities of links .",
    "this would allow , for example , making highly probable links more likely to be observed correctly .",
    "ultimately , we would also like to incorporate the general framework of link uncertainty into other network problems , for example , community detection .",
    "h.  kashima , t.  kato , y.  yamanishi , m.  sugiyama , and k.  tsuda .",
    "link propagation : a fast semi - supervised learning algorithm for link prediction . in _ proceedings of the 2009 siam international conference on data mining _ , 2009 .",
    "k.  miller , t.  griffiths , and m.i .",
    "nonparametric latent feature models for link prediction . in y.",
    "bengio , d.  schuurmans , j.  lafferty , and c.  williams , editors , _ advances in neural information processing systems ( nips ) _ , volume  22 , 2010 .",
    "k.  yu , w.  chu , s.  yu , v.  tresp , and z.  xu . stochastic relational models for discriminative link prediction . in _ proceedings of neural information precessing systems _",
    ", pages 15531560 . mit press , cambridge ma , 2007 ."
  ],
  "abstract_text": [
    "<S> link prediction is one of the fundamental problems in network analysis . in many applications , notably in genetics </S>",
    "<S> , a partially observed network may not contain any negative examples of absent edges , which creates a difficulty for many existing supervised learning approaches . </S>",
    "<S> we develop a new method which treats the observed network as a sample of the true network with different sampling rates for positive and negative examples . </S>",
    "<S> we obtain a relative ranking of potential links by their probabilities , utilizing information on node covariates as well as on network topology . </S>",
    "<S> empirically , the method performs well under many settings , including when the observed network is sparse . </S>",
    "<S> we apply the method to a protein - protein interaction network and a school friendship network . </S>"
  ]
}