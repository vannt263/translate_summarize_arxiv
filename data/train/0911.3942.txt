{
  "article_text": [
    "we begin with the basic background on the ionospheric operator , followed by that of the ionospheric correction operator .",
    "these sections expand upon the mathematical framework created and briefly outlined in morales , et .",
    "al . , @xcite .",
    "the ionospheric operator * a*(@xmath2 ) is the operator which takes an unperturbed map of the sky @xmath3 and maps it to a perturbed map @xmath4 which has been distorted by the ionosphere , @xmath5 put simply , * a*(@xmath6 ) is a generalized coordinate change from @xmath7 to @xmath8 .",
    "( the order of the arguments of * a*(@xmath6 ) here , and with other operators later , is indicative of the direction of change . )    in the regime of mwa , it is a very good approximation that the mapping of angles is approximately linear with only a small deviation @xmath9 , @xmath10 the perturbed intensity @xmath4 at @xmath8 is the summed contribution from the intensities @xmath11 at all @xmath12 where this relation holds ; ie , @xmath13 where @xmath14 represents the dirac delta function .",
    "for example , if ( only ) @xmath15 and @xmath16 are mapped to @xmath17 according to equation [ delthetadef ] , then @xmath18 . in the limit",
    "that @xmath7 is a continuous variable , this discrete sum for @xmath4 is altered to an integral , @xmath19 where @xmath20 ( notice that we ve used that the magnitude of the delta - function s argument s gradient is approximately 1 here ) . from this equation",
    "it is evident that in the limit of continuous @xmath7 , the ionospheric operator equation becomes @xmath21    so far our calculations have been confined to real space , using the variables \\ { @xmath2 } .",
    "however , as is common for antenna arrays in radio astronomy , the output of the correlator for mwa will actually be the fourier transform of the real space sky intensity , @xmath22 .",
    "in addition , the final power spectrum of the sky will also be measured in this fourier transfrom space ( also known as _ visibility space _ , or _ @xmath0-space _ ) .",
    "therefore , correcting for the ionosphere in real space requires inverse fourier transforming to real space , making the correction , and then fourier transforming back to visibility space .",
    "the problem with this is that fourier transforming is computationally expensive , especially for a system operating in real time , such as the mwa s _ real time system _ @xcite . as such , correcting for the ionosphere in the @xmath0-plane would greatly reduce computation .",
    "we now study the nature of this @xmath0-plane correction .",
    "let @xmath22 represent the fourier transform of @xmath3 .",
    "define this fourier transform by @xmath23 and the corresponding inverse fourier transform by @xmath24 now define * a*@xmath25 to be the ionospheric operator in the @xmath26plane ; that is , the operator that maps the unperturbed map @xmath22 to the perturbed map @xmath27 , @xmath28    one way to obtain @xmath27 from @xmath22 is to inverse fourier transform @xmath22 to @xmath3 using * f*@xmath29 , apply the ionospheric operator * a*@xmath30 in real space to obtain @xmath4 , and then fourier transform @xmath4 to @xmath27 using * f*@xmath31 . in all , @xmath32 comparison of this to the definition of * a*@xmath25 shows that @xmath33 this expression may be thought of as simply a basis change of * a * from \\{@xmath34 } to \\{@xmath35}. the three operators on the right here have all been previously given .",
    "plugging in these predetermined expressions ( equations [ aop ] , [ fourierdef ] , and [ inversefourierdef ] ) and simplifying as much as possible , we obtain @xmath36 notice that the integral over @xmath8 has been evaluated by using the delta function from the expression for @xmath37 ( see equations [ a2 ] and [ aop ] ; here again we use that the magnitude of the delta - function s argument s gradient is approximately 1 ) . one interesting characteristic of this expression is the non - local nature , by which finding the value of the perturbed intensity @xmath27 at one particular @xmath38 requires knowing the value of the pure intensity @xmath22 at other @xmath39 .",
    "this property will also appear in the ionospheric correction operator , found below .",
    "the previous section corresponds to the operator which distorts the pure data into the perturbed data , but the reverse process is what actually interests us  we want to correct for the effect of the ionosphere to obtain the pure data from the perturbed data .",
    "define * a@xmath40*@xmath41 to be this ionospheric correction operator which corrects for the influence of the ionosphere by mapping the perturbed map of the sky @xmath4 back to the unperturbed map @xmath3 ,",
    "@xmath42 the mwa will not run during periods of scintillation ( at which times multiple values of @xmath7 are perturbed to the same @xmath8 ) , but will instead run during times when it is a very good approximation that the mapping from @xmath8 to @xmath7 is one - to - one and approximately linear with only a small correction , @xmath43 the derivation of an expression for the ionospheric correction operator in the @xmath0-plane @xmath44 follows analogously to the derivation of @xmath45 , so i ll merely quote the result : @xmath46 this is the most general expression for obtaining @xmath22 from @xmath27 ; proceeding further requires knowledge of the ionospheric perturbation @xmath47 . numerically solving for @xmath22 using this equation",
    "is an incredibly daunting task for an arbitrary choice of @xmath47 , as it involves a double integral over all space for every value of @xmath1 . therefore , unless we find a choice of @xmath47 which offers an analytic solution for @xmath22 , the correction for the ionosphere in the @xmath0-plane will actually be more computationally expensive than the two fourier transforms necessary to correct for the ionosphere in real space .",
    "unfortunately , choices of @xmath47 which lend themselves to analytic solutions are hard to come by .",
    "there are a couple , however , and they will be discussed in the following sections .",
    "the above equation for @xmath22 contains an exponential with @xmath48 in the exponent . by expanding this exponential",
    ", we obtain a form for @xmath22 which may be solved analytically for a couple of choices of @xmath48 .",
    "to be explicit , expanding the exponential in @xmath48 , @xmath49 leads to @xmath50 ( interchanging an infinite sum and an integral requires that the sum be uniformly convergent , which will be true for all choices of @xmath48 that we choose . )    with the above expansion , @xmath22 may be solved analytically if we choose @xmath51 here , the @xmath52 are chosen to be purely real , but the @xmath53 are allowed to assume complex values .",
    "physically , this choice of @xmath48 corresponds to modeling the integral along the line of sight of the ionosphere s electron density @xmath54 ( @xmath55 is the distance along the line of sight ) as a sum over sinusoidal modes , @xmath56 the reflection by the ionosphere is then related to this by @xmath57 where @xmath58 represents the two - dimensional gradient with respect to @xmath59 .",
    "( the actual shift , of course , is a hermitian observable , so only the real part of this is included in @xmath48 . ) notice that this choice ultimately stems from our decision to model density fluctuations from the ionosphere as sinusoidal modes .",
    "actually , any orthonormal basis would have sufficed here . once again",
    ", this particular choice was made because it allows an analytic solution for the unperturbed intensity @xmath22 .",
    "( an alternate choice which likewise offers an analytic solution will be briefly discussed later on in section [ choice2 ] . )    with this choice of @xmath48 , the intensity @xmath22 becomes @xmath60   \\tilde{i}(\\vec{u ' } ) .\\end{aligned}\\ ] ] the math leading to a solution for @xmath22 may be found in the appendix , section [ math1 ] .",
    "very briefly , the integral is solved by conveniently redefining the ionospheric modes @xmath61 ( as given below ) , performing a multinomial expansion on the term raised to the power @xmath62 , recognizing that the final product of this expansion leaves the @xmath8 integral in the form a delta function , and then using that delta function to evaluate the integral over @xmath38 .",
    "the final solution is @xmath63 where @xmath64 @xmath65 and the summation over all @xmath66 ( with @xmath67 ) is a restricted sum such that @xmath68 and @xmath69 .",
    "this equation might look a little daunting , but it may be thought of simply as the addition of many delta functions of varying amplitudes , with those further from the point @xmath1 in question tending to contribute less to the sum .",
    "( this is , in fact , similar to what one sees with intermodulation distortion ) .",
    "notice that although there are @xmath70 modes distorting the sky , the sums and products above involve @xmath67 .",
    "thus , there appear to be @xmath71 _ effective modes _ distorting the sky .",
    "this factor of 2 comes from the constraint that @xmath48 be real , as may be more easily seen by following the math provided in the appendix , section [ math1 ] .",
    "another important feature of this solution is that it is inherently non - local , with the corrected intensity @xmath22 at a given @xmath1 depending on the values of the perturbed intensity @xmath27 at the appropriate neighboring points @xmath72 .",
    "this non - locality , which is also evident in the most general form for @xmath22 ( equation [ iupure ] ) , will create edge effects because the @xmath0-plane is finite in all practical applications , as will be more easily seen and understood later in section [ trunc10 ] .",
    "it should also be pointed out that this equation for @xmath22 is the result of a double expansion : the taylor - series expansion of the exponential containing @xmath47 ( see equation [ n1 ] ) , which is now evident in the summation over @xmath62 , and the expansion of the ionospheric perturbation @xmath47 itself into sinusoidal modes ( see equation [ dtsine ] ) , which is now evident in the restricted sum over @xmath66 . throughout this paper",
    "we will assume that this second expansion is  perfect \" ; that is , we will assume that we are able to perfectly model the ionosphere with the @xmath70 modes that we assume are provided for us .",
    "we will instead study the errors created by truncating the first expansion .",
    "as previously stated , the main goal of the @xmath0-plane correction is to correct for the ionosphere in a less computationally intensive manner than that required for the real space correction . our final expression for @xmath22 , however , contains an infinite sum over @xmath62 .",
    "clearly , making the @xmath0-plane correction computationally feasible will require truncating this sum after a finite number of terms .",
    "the next section will explore the effect of such a truncation .    but even truncating this sum over @xmath62 can not guarantee the computational feasibility of the @xmath0-plane correction because of the second expansion over sinusodial modes and its resulting restricted summation . more specifically , the number of terms in the restricted sum over all possible combinations of @xmath66 such that @xmath68 may be calculated through the following trick : if @xmath71 represents the total number of effective modes , then consider the problem of arranging @xmath62 balls and @xmath73 partitions in a straight line . here",
    "the @xmath74-th partition marks the stopping point where @xmath75 ends and @xmath76 begins .",
    "for example , if for a particular arrangement 7 balls lie between the 4th and 5th partitions , then @xmath77 = 7 for that arrangement .",
    "the total number of ways to arrange these @xmath78 objects is @xmath79 . of course ,",
    "exchanging the position of any two of the same object ( ball or partition ) does not lead to a different arrangement , so the total number of terms in the restricted sum such that @xmath80 is given by @xmath81 as an example , suppose that we wish to calculate this sum for 10 modes ( @xmath82 effective modes ) to the 40th order in @xmath62 . using the above formula , we calculate that such a sum has approximately 70 trillion terms . from this",
    "we see that the @xmath0-plane correction is only computationally feasible if the number of modes necessary to model the sky @xmath70 _ and _ the number of orders necessary in the expansion of the exponential @xmath62 are relatively small .",
    "as stated in the previous section , the @xmath0-plane correction is only computationally feasible if we truncate the infinite sum over @xmath62 . at this point",
    "we pause to study the results of truncating this sum after a finite order of correction , @xmath83 .      in order to study the qualitative effects of truncating the sum over @xmath62",
    ", we created a simple sky and perturbed it with a simple mode , and then used numerical code to correct for this ( known ) perturbation in the @xmath0-plane by using the mathematical formula found above in equation [ finaliu ] .",
    "the initial , unperturbed sky is shown in the top panel of figure [ pureandbad ] .",
    "we will refer to this sky throughout this paper as the _ simple sky_. it contains a @xmath84 pixel array with a spacing of 4 arcmin between pixels , which is the approximate resolution we expect for the final mwa array ( the axes in this and all the following real space figures are labeled in radians ) .",
    "this pure sky is a single source sky : the value of the intensity at all pixels is set to 0.0 except at one pixel where the value 1.0 .",
    "( the important qualitative results found below would not be altered by including side lobes , so we will leave them out to keep things simpler . )    figure [ uv ] shows the real part of the intensity in the @xmath0-plane for this pure sky plotted in the third direction ( which is determined by the color scale ) and demonstrates that the uncorrupted , @xmath0-sky is a simple sinusoid ( as one would expect for the fourier - transform of a delta function ) .",
    "in contrast to this plot , the color scale for all the following @xmath0-space plots is representative of the magnitude of the intensity @xmath22 in the @xmath0-plane ( although @xmath22 is complex , the important @xmath0-plane results found below do not require phase information to understand graphically ) .",
    "the important feature to take away from this plot is that the absolute magnitude of the intensity is constant and of the order @xmath85 at all points in the @xmath0-plane ( although we ve only plotted the real part here ) .",
    "we then perturb this simple sky with a rather strong mode , as shown in the bottom panel of figure [ pureandbad ] .",
    "this distorting mode has @xmath86 radians squared and @xmath52 with a magnitude of 378.0 inverse radians and oriented in the @xmath87 direction as measured from the @xmath88 axis .",
    "( these values were chosen for the sole reason that they produce a strong shift of a few pixels ( tens of arcminutes ) , and thus accentuate the qualitative features of the ionospheric correction as seen below .",
    "a more realistic distortion will be discussed later in section [ realistic ] . )",
    "notice that the intensity is still 1.0 at exactly one pixel and 0.0 at every other pixel , but now the location of this pixel has slightly shifted in the @xmath87 direction .",
    "( it should be noted that this ionospheric shift was applied to the continuous sky with a delta function at one point , and not to its pixelized represention shown in the top panel of figure [ pureandbad ] ) .",
    "although we have not included the plot , the magnitude of the intensity in the perturbed @xmath0-plane remains of the order of @xmath85 , its value in the pure visibility sky .",
    "we now begin correcting for this simple one - mode distortion using various values of @xmath89 .",
    "we ( quite naturally ) begin with the first order correction , @xmath90 ( @xmath91 leads to no correction , see equation [ finaliu ] ) . after correcting to first order in the @xmath0-plane , we inverse fourier transform back to the real space sky shown in the top panel of figure [ order1 ] in order to determine the effect that this first order correction has had on the real sky ( in particular",
    ", we would like to know whether it has successfully shifted the single source back to its unperturbed location ) . as it turns out",
    ", the correction to one order has not shifted the star from its perturbed location .",
    "the cross - like pattern of the star is somewhat interesting , but what is most important about this figure is that the maximum in the intensity has now doubled from 1.0 to 2.0 .",
    "a potential clue to this behavior is found by studying the visibility space sky corrected to first order , as shown in the bottom panel of figure [ order1 ] . from this figure",
    "we see that the first order correction in the @xmath0-plane has created an increase of an order of magnitude in the absolute value of the intensity at those points in the @xmath0-plane furthest from the origin .",
    "another important feature of this figure ( although , as it turns out , it is not the cause of the increase in the real space intensity ) is the ring around the outside edge of the figure .",
    "this ring is caused by the previously mentioned fact that the correction in the @xmath0-plane is non - local ( see equation [ finaliu ] ) , combined with the finite nature of our numerical @xmath0-plane .",
    "more specifically , points near the edge of our @xmath0-plane may not obtain the full correction in visibility space , because doing so requires pulling values of the intensity that are off the edge of the grid .",
    "therefore , values near the edge are never fully corrected .",
    "we will later see that the result of this is a small spreading of the initial source ( ie , a loss of precision ) , in real space .",
    "we now continue on to the second order correction ( @xmath92 ) .",
    "after inverse fourier transforming , we obtain the real space sky shown in figure [ order2 ] ( top panel ) . from this figure",
    "we see that the maximum in the intensity has increased even more , and is now 12 times its unperturbed and uncorrected value .",
    "the visibility sky after two orders of correction , as shown in the bottom panel of figure [ order2 ] , has a maximum in the intensity that is now 100 times the value of the pure @xmath0-sky .    correcting to higher orders",
    ", we see that the problem with intensities that are too high not only persists , but continues to get worse .",
    "after 5 orders , the intensity in the real space sky ( figure [ order5 ] , top panel ) is 120 times too large , and that in the visibility space sky ( figure [ order5 ] , bottom panel ) is @xmath93 times too large ; after 10 orders , the intensity in the real space sky ( figure [ order10 ] , top panel ) is 600 times too large , and that in the visibility space sky ( figure [ order10 ] , bottom panel ) is @xmath94 times too large .",
    "in addition to the increase in the maximum in real space intensity , the source is also beginning to spread out and look less like a single point source .      before continuing ,",
    "let s pause to develop an intuition of what is happening here .",
    "consider a simple exponential , @xmath95 suppose that we want to approximate this exponential using a taylor expansion , @xmath96 it makes sense that a decent approximation to the original exponential should be possible by truncating this sum after a finite number of terms .",
    "but how many terms are necessary ?",
    "let s first consider the zeroth order approximation , in which only the @xmath97 term is kept , @xmath98 notice that the zeroth order approximation gives us the right magnitude of 1 , but all information about the phase has been lost .",
    "if we instead correct to first order , we obtain @xmath99 this is not even close to the correct answer  not only does this not contain the correct phase , but the magnitude is now not even close to being correct . correcting to second order gets us even further from the correct answer , @xmath100    this pattern continues for higher orders as well .",
    "in fact , the approximation wo nt begin to look decent until @xmath101 .",
    "even more relevant to our observations in the previous section , notice that adding subsequent terms to the approximation does not necessarily make the approximation better until @xmath101 . before then",
    ", adding subsequent terms actually makes the approximation worse . drawing from these observations",
    ", we expect that the trend we ve seen so far is the result of under correcting in the @xmath0-plane , and that by going to more and more orders we will eventually obtain a decent correction .",
    "we now verify that this intuition is correct by studying higher order corrections .",
    "if correct , we expect to see the results gradually get better .",
    "we now consider the fifteenth order correction , @xmath89 = 15 , as shown in figure [ order15 ] .",
    "the real space sky after 15 orders ( top panel ) is now only 500 times too intense ( versus 600 for 10 orders ) , while the visibility space sky ( bottom panel ) is still approximately @xmath94 times too intense . from this",
    "it is unclear that things are getting better , but in the very least the intensities are not getting worse .",
    "the shape of the source , however , continues to grow further from a point source .",
    "moving on to @xmath102 ( figure [ order20 ] ) is a bit more reassuring .",
    "the maximum in the real space sky intensity is now approximately only 50 times its actual value ( top panel ) , although the maximum in the visibility space intensity is still four orders too high ( bottom panel ) .",
    "the gradual improvement continues when we skip ahead to 25 orders ( figure [ order25 ] ) .",
    "the real space intensity is now only 4 or 5 times too large ( top panel ) , while the visibility space intensity has now dropped to 1000 times too large ( bottom panel ) .",
    "the shape of the source , however , continues to grow worse .",
    "skipping ahead next to 30 orders of correction shows a dramatic improvement .",
    "the top panel of figure [ order30 ] shows that the single source now appears to be a single source of the right order of magnitude in intensity . and",
    "in addition , the most intense pixel is now located exactly where it was for the pure sky , so the @xmath0-plane correction has ( at least in terms of location of the max ) successfully corrected for the shift by the ionosphere .",
    "the bottom panel of figure [ order30 ] shows that the maximum in the visibility space sky intensity ( which , as always , occurs near the edge of the grid ) is now only an order of magnitude too big .",
    "it appears as if we ve gone over the hump , and are now on our way to decent results .",
    "the correction to 35 orders shows minor improvement in real space ( figure [ order35 ] , top panel ) . in the visibility space sky",
    "( figure [ order35 ] , bottom panel ) , however , the entire grid now has the correct order of magnitude of @xmath85 , including the most extreme pixels .",
    "we therefore now see some of the finer patterns caused by the non - locality of the correction and finite nature of the @xmath0 grid ( as mentioned previously in section [ trunc10 ] ) , which had previously been hidden by the extreme intensities at the corners .",
    "it should be noted that the most intense pixel in this fully corrected real space sky in the top panel of figure [ order35 ] still lies at the location of the single source in the original , pure sky . in other words ,",
    "the @xmath0-plane correction has successfully shifted the reflected source back to its initial position , at the cost of minor spreading over a few neighboring pixels .",
    "this spreading , which can not be eliminated by correcting to still higher orders , is caused by the finite nature of the @xmath0-plane and thus can not be avoided .",
    "it turns out that corrections to higher orders show negligible improvement over the correction to 35 orders , so the resulting skies , identical to those of figure [ order35 ] , are not shown .",
    "so far we have only used a particularly simple sky with one star .",
    "figure [ 10stars ] shows ( the absolute value of ) the residual between a more complicated pure sky with 10 stars , and the real space sky obtained after perturbing this pure sky and then correcting in the @xmath0-plane to 40 orders . for comparison s sake the perturbation used here was the same ionospheric mode used above to perturb the simple sky of figure [ pureandbad ] ( ie , that used throughout this section ) .",
    "this figure shows the kinds of errors we may expect from the @xmath0-plane correction .",
    "the residual from the star on the top right shows a light cross pattern , indicative of a spreading of the source caused by the process of perturbing the star and then applying the @xmath0-plane correction .",
    "places in the plot with two consecutive pixels of high intensity represent stars which were not shifted back to exactly the same pixel that they started at , but rather to a neighboring pixel .",
    "recall that the stars are typically initially shifted 3 or 4 pixels by the ionosphere , so the @xmath0-plane correction is still providing some improvement with these stars .",
    "there are two main points to be taken from our analysis so far .",
    "first , from section [ numterms ] we learned that either needing too many modes to model the ionospheric correction or too many orders of correction leads to an unreasonable number of numerical calculations .",
    "second , from section [ nmax ] we learned that under correcting in the @xmath0-plane is a huge mistake and a lot worse than not correcting at all .",
    "hence the dilemma : choosing @xmath89 too small leads to the destruction of the data , while choosing @xmath89 too large leads to a computationally infeasible problem .",
    "it is therefore advantageous to develop a theoretical prediction of how many orders of correction are necessary .",
    "as it turns out , the result will lead to a few tricks which make the problem more reasonable .",
    "if we correct to only @xmath89 orders , then the magnitude error @xmath104 in our result must be the absolute value of the sum of all the terms we left out ; more specifically , @xmath105 the steps leading to an upper bound @xmath103 on this error may be found in the appendix , section [ math2 ] .",
    "the result is @xmath106 where @xmath107 @xmath108 and @xmath70 is the number of modes , as always .",
    "[ see equations [ c_qdef ] and [ d_qdef ] for reminders on how effective modes @xmath109 are related to actual modes @xmath110 .",
    "this is our final result for a strict upper bound on the error .",
    "unfortunately , this formula is not too enlightening . in order to obtain a theoretical estimate for @xmath89",
    ", we must make a few further approximations .    as one would expect , the optimal value of @xmath89 , which represents the number of orders necessary to obtain some level of accuracy in the @xmath0-plane , is dependent upon the level of accuracy desired .",
    "to quantify this , define @xmath111 to be the value of the intensity in the @xmath0-plane after correcting up through @xmath112 , and @xmath113 to be the value of the intensity in the @xmath0-plane that one would obtain by employing the full correction and not truncating the sum ( ie , @xmath114 ) .",
    "( it should be noted that @xmath113 here also assumes a @xmath0-plane infinite in extent .",
    "this will have effects seen later . ) the fractional error @xmath115 in the @xmath0-plane correction caused by truncating the sum is then @xmath116 in the appendix ( section [ math3 ] ) you will find the steps leading up to a theoretical prediction of the value of @xmath89 at a given @xmath1 in the @xmath0-plane necessary to obtain a fractional error less than or equal to @xmath117 if given the ionospheric effective modes distorting the sky , @xmath109 .",
    "the result is that the optimal value of @xmath89 is estimated by @xmath118 where @xmath70 is the number of modes and @xmath119 is defined as it was above in equation [ vu ] .",
    "this formula is a little hard to digest , so some values for @xmath89 given @xmath120 and @xmath117 are provided in table [ nmaxtab ] . for the example sky and perturbation used in section [ nmax ] , the theoretical predictions for the number of orders necessary is shown graphically in the top panel of figure [ nmaxtheory ] .",
    "this figure has @xmath121 , although @xmath89 does not change too significantly when varying @xmath117 , as is seen in table [ nmaxtab ] .",
    "recall that the single distorting mode @xmath122 is in the @xmath87 direction , which defines the favored direction seen in this figure .    as a check of these theoretical predictions , we used matlab to numerically compute the number of orders necessary to obtain the desired fractional error of @xmath123 .",
    "the bottom panel of figure [ nmaxtheory ] shows the difference between these computational results and the theoretical predictions shown in the top panel of figure [ nmaxtheory ] .",
    "more specifically , it represents the number of orders of correction theoretically predicted minus the number found computationally .",
    "this figure suggests that for a bulk of the @xmath0-plane , the theoretical prediction is quite accurate , predicting the number of orders to within 5 . near the extremes",
    ", however , the finite nature of the @xmath0-plane causes problems ( remember that the theoretical estimate assumed an infinite @xmath0-plane ) .",
    "in fact , the cool - colored pixels near the corners are pixels which never obtained a fractional error of @xmath124 ( the numerical code cutoff after 50 orders ; all points with fractional errors too high at that point were assigned a value of 50 orders ) .",
    "the theory predicts that about 35 orders are required to correct at the most extreme points in the @xmath0-plane , which is what our previous numerical computations found",
    ". an important feature of the theoretical predictions shown in figure [ nmaxtheory ] that is characteristic of all skies is that the necessary number of orders of correction varies with @xmath1 , and in particular it increases as @xmath1 increases along the direction of the mode .",
    "therefore , points closer to the origin are corrected in less orders than those further away .",
    "[ nmaxtab ]      the accuracy of the theoretical prediction here is in no small part due to the existence of only one ionospheric mode in our simple sky model .",
    "this reason for this is that the above theoretical estimate ( equation [ finalnmax ] ) was derived from an expression for the upperbound on the error ( equation [ upper ] ) which assumes that all the ionospheric modes in the sky are as strong as the strongest mode at @xmath1 and add constructively ( which may be seen in the appendix , section [ math2 ] , near equation [ uu ] ) . as such , the result is not a bad prediction for only one distorting mode , but tends to ( perhaps significantly ) overestimate the necessary number of orders for multiple distorting modes . in short ,",
    "the above mentioned theoretical estimate may perhaps be more accurately called a theoretical _ _ over__estimate . given the results seen in section [ nmax ] ( more specifically , the terrible consequences of undercorrecting in the @xmath0-plane ) , this was done intentionally to ensure that our @xmath0-plane was adequately corrected .",
    "still , it may be useful to obtain a more accurate estimate of the number of orders necessary .",
    "one such estimate would be a _",
    "strongest mode approximation _ , in which we assume that at any given @xmath1 , the only significant contribution comes from the strongest mode at that point .",
    "the contributions from the other modes are assumed to be weak and negligible .",
    "this approximation ultimately boils down to setting @xmath125 in the final equation determining @xmath89 from the previous section ( equation [ finalnmax ] ) .",
    "this approximation may provide a more accurate estimate of @xmath89 , but it also runs a high risk of underestimating the correct number of orders , which should be avoided if possible",
    ". an alternate approximation would be a _",
    "significant modes approximation _ , in which only modes at a given @xmath1 with strengths within a certain critical fraction of the strongest mode s are included in the value for @xmath70 used in equation [ finalnmax ] . with a closer study of perturbations from more realistic ionospheric modes , it may be possible to set this critical fraction in such a way as to fairly accurately predict the number of orders necessary .",
    "the above analysis suggests two methods for making the @xmath0-plane correction less time intensive : 1 ) the points furthest out in the @xmath0-plane take the most time to correct .",
    "eliminating them decreases computation time , but at the cost of resolution in the real space sky .",
    "2 ) different points in the @xmath0-plane require different numbers of orders of correction , so write a code that corrects to different numbers of orders depending on the point in the @xmath0-plane .",
    "( in other words , do nt waste time correcting to 35 orders near the origin when 2 is enough . )      for this method , we eliminate the problems caused by under correcting at the extremes in the @xmath0-plane by setting the values at those extremes to 0 .",
    "take , as a visual example , figure [ uvshave ] , in which we have set the values of the pixels in the 25 diagonal rows from the corner to zero ( we _ shaved _ 25 pixels from the corner ) . as a reminder of the real space sky after 25 orders without edge shaving , consider the top panel of figure [ corner25 ] ( a reproduction of figure [ order25 ] , top panel ) .",
    "notice that the intensity is approximately 4 or 5 times too high at the brightest points and , even worse , our single point source has turned into some sort of supernova explosion . compare this to the edge - shaved version of the real space sky ( figure [ corner25 ] , bottom panel ) , in which we see a sky that looks almost identical to our fully corrected sky after 35 orders ( top panel , figure [ order35 ] ) . to see this more clearly , consider figure [ residshave ] , which represents ( the absolute value of ) the residual between the real space sky corrected to 40 orders with no edge shaving and the real space sky corrected to 25 orders with edge shaving . from this figure",
    "we see that the result of the edge shaving was to create a small spread around the star , but of an intensity about an order of magnitude lower than the maximum intensity of the star .",
    "the relative success of this scheme leads to the question of how low we may push the number of correction orders when edge shaving is introduced .",
    "figure [ realshave15 ] shows the result of only correcting to 15 orders , but shaving 75 rows of pixels from the corners in the @xmath0-plane . without edge shaving ,",
    "the real space sky corrected to 15 orders had a maximum intensity of about 500 ( figure [ order15 ] , top panel ) .",
    "now , the total intensity is approximately 1 as it should be , but it is spread over a number of pixels .",
    "so while the results are a dramatic improvement over what they had been , for the sake of precision it might be a good idea to correct to higher orders and shave less .",
    "the moral : the process works , but be careful about trying to shave too much .      for this method , we correct to different numbers of orders at different @xmath1 . to test this method ,",
    "we re - wrote our matlab code so that the number of orders of correction at a given @xmath1 was determined by the theoretical estimate from section [ theorynmax ] ( more specifically , equation [ finalnmax ] ) .",
    "we then corrected the distortion for the same simple sky used in section [ nmax ] .",
    "figure [ residmeth2 ] shows the residual between the real space sky corrected to 40 orders at all points in the @xmath0-plane and the real space sky corrected to different orders in the @xmath0-plane .",
    "not surprisingly , the residual is incredibly small 5 or 6 orders of magnitude less than the maximum in the intensity of the source .",
    "( this is , of course , another sign that the theoretical prediction of the number of orders of correction is pretty good ) .",
    "however , this new matlab code presented a small problem : matlab is so much better at manipulating matrices than running for - loops that this second code , which theoretically requires less computation , takes approximately 15 times as long to run .",
    "of course , if the @xmath0-plane correction is eventually used in mwa , a programming language more adept at loops will undoubtfully be used , and this method will potentially save time .",
    "previously , we have assumed that @xmath126 took the form    @xmath127    given the relative complexity of the results above , it pays to investigate an alternate choice of @xmath126 .",
    "the main reason that this was chosen was because it allowed for an analytic solution for @xmath22 , where @xmath128 as shown previously in equation [ iupure ] . without an analytic solution to these integrals for @xmath22 ,",
    "the @xmath0-plane correction becomes more computationally intensive than inverse fourier transforming to real space , correcting for the ionosphere there , and then fourier transforming back to visibility space .",
    "therefore , an analytic solution is required for any choice suitable choice of @xmath126 .",
    "unfortunately , choices for @xmath126 which allow such analytic solutions are hard to find",
    ". there is , however , at least one other such distortion : a polynomial expansion , given by @xmath129 where @xmath130 and @xmath70 are the number of terms in the @xmath88 and @xmath131 directions , respectively , necessary to accurately model the distortion by the ionosphere .",
    "the @xmath132 and @xmath133 shown here are real .",
    "the analytic derivation of @xmath22 is given in the appendix , section [ math4 ] .",
    "the result is @xmath134 where @xmath135 @xmath136 and the sums over @xmath137 and @xmath138 are restricted so that @xmath139 and @xmath140 .",
    "while we ve confined the analytic solution of this to the appendix , it should be mentioned that en route to this solution the exponential in @xmath126 from equation [ second ] was taylor - expanded ( which , you may recall , was also the case for the other choice of @xmath126 as a sum over sinusoidal modes , and is explicitly shown in equations [ n1 ] and [ n2 ] ) . in other words ,",
    "this solution is likewise characterized by the double expansion mentioned previously at the end of section [ sinmodes ] : one expansion over @xmath141 from expanding the exponential in @xmath126 , and one expansion in @xmath142 resulting from our model for the ionosphere . as such",
    ", this solution shows many of the unfortunate characteristics of the sinusoidal choice . in particular , there are still restricted sums which contain a number of terms comparable to that calculated in section [ numterms ] , so this choice has the same problem of making the @xmath0-plane correction unreasonable if too many orders of correction or ionospheric modes are needed .",
    "in addition , the correction is still not strictly local : numerical computation of derivatives requires neighboring pixels , with higher orders requiring more neighbors .",
    "moreover , numerical computation of derivatives for a finite data set introduces its own set of additional errors , and thus makes this choice much less appealing than the previous one with sinusoidal modes .",
    "the ugliness of both of these choices ultimately stems from the inability to solve for @xmath22 analytically without expanding the exponential containing @xmath126 . unless a choice is found which may be solved analytically without this first expansion , it is doubtful that a better choice than the sinusoidal modes will be found .",
    "the ionospheric distortion presented throughout this paper was chosen because its particularly strong nature accentuated the subtleties of the @xmath0-plane correction .",
    "the strength of this mode made the @xmath0-plane correction appear computationally infeasible : any ionosphere which required even 10 of these modes to accurately model would require too much computation ( see section [ numterms ] ) .",
    "however , an ionospheric mode which shifts sources on the sky by tens of arcmin is somewhat unrealistic .",
    "we conclude by considering a more realistic distortion .",
    "the computational feasibility of the @xmath0-plane correction is determined by the largest value of @xmath89 ( given by equation [ finalnmax ] ) required for any @xmath1 . to calculate this for a realistic sky",
    ", we need to know the largest possible value of @xmath119 .",
    "it is possible to cast the largest value of @xmath119 , which we label @xmath143 , in a form which better elucidates its physical significance .",
    "more specifically , notice that @xmath144 where @xmath145 is the angle between @xmath1 and @xmath122 . for an arbitrary choice of @xmath1",
    ", this cosine term may be significant .",
    "however , if we wish to calculate @xmath143 , we may set @xmath146 and @xmath147 = @xmath148 , where @xmath148 is the greatest distance from the origin in the @xmath0-plane that our antenna s @xmath0-coverage allows .",
    "this is valid for mwa because the @xmath0-coverage is approximately circular , so that the strongest ionospheric distorting mode is guaranteed to lie along a direction which possesses this maximum displacement in the @xmath0-plane . with these changes , and based upon our previous definitions of the effective modes @xmath149 in terms of the actual modes @xmath150 ( see equations [ c_qdef ] and [ d_qdef ] ) , we may write @xmath143 as @xmath151 but , @xmath152 let s define @xmath153 in words , @xmath154 is the maximum deflection caused by a single mode that we might observe .",
    "in addition , let @xmath155 denote the length of our antenna array s longest baseline .",
    "the maximum @xmath0-plane displacement @xmath148 is then this length measured in units of the wavelength @xmath156 that our antenna is detecting , @xmath157 [ the extra factor of @xmath158 is the result of our convention for fourier transforms ( see equation [ fourierdef ] ) , which differs from that conventionally used in radio astronomy ] . with these substitutions , @xmath159",
    "therefore , in terms of these parameters , the number of orders of correction necessary is ( adapted from equation [ finalnmax ] ) @xmath160 where @xmath117 is ( as before ) the fractional error desired for the correction .",
    "it should be noted that this form is only valid for determining the largest @xmath89 among all @xmath1 . for calculating @xmath89 for a particular @xmath1 , equation [ finalnmax ] must be used .    for mwa",
    ", a typical frequency detected will be about 140 mhz , corresponding to @xmath161 meters ( this represents the 21 cm emission for a red shift of @xmath162 . ) we expect the ionosphere to deflect such a wave approximately 0.6 arcmin = @xmath163 radians ( @xcite , value is for the night ) .",
    "if we consider baselines of approximately 400 meters , then @xmath164 if given the number of modes necessary to accuately model the ionosphere @xmath70 ( which is as of yet undetermined ) , then @xmath89 for the full array may be determined from table [ nmaxtab ] by substituting @xmath165 for @xmath166 .",
    "as an example , if a fractional error of @xmath121 is desired and @xmath167 , then @xmath168 and table [ nmaxtab ] shows that 12 orders of correction are necessary .",
    "whether such a result is computationally feasible is dependent upon how much time is alloted for the ionospheric correction and the quality of the computers used . as such , it may not be determined here .",
    "what is clear , however , is that such a correction is not obviously ruled out on computational grounds ( especially if a technique such as edge shaving is used to reduce @xmath89 ) .",
    "[ quick aside : edge shaving alters the above results by substituting the largest @xmath147 left unshaved in place of @xmath148 in the above calculations . ]",
    "it should be noted that the values that went into calculating @xmath165 above were estimates , and certainly not set in stone . in particular",
    ", we once again emphasise that throughout this paper we have remained ignorant of the details involved in the expansion of the ionosphere , and have no knowledge of how many modes @xmath70 are necessary to sufficiently model the effect of the ionosphere . in addition , the ionospheric deflection @xmath169 is proportional to @xmath170 , with longer wavelengths experiencing greater shifts @xcite . therefore , we expect longer wavelengths than the above to require more orders of correction and shorter wavelengths , fewer .",
    "if @xmath165 is in fact lower by a factor of 5 , for example , then @xmath171 and the @xmath0-plane correction is certainly a viable candidate for correcting the ionosphere .",
    "in particular , if the strongest mode approximation discussed in section [ strongest ] turns out to be a good approximation , then even with baselines of 1.5 km we may expect a good correction after only 4 orders for the wavelength given above . on the other hand , if @xmath165 is raised by a factor of 5 , then @xmath172 and the @xmath0-plane correction is clearly computationally infeasible for any reasonable value of @xmath70 .",
    "as stated previously , correcting for the ionosphere in the @xmath0-plane entails multiplying the perturbed data @xmath173 by the ionospheric correction operator * a@xmath40*@xmath174 , @xmath175 where we have now made the time dependence of these quantities explicit .",
    "the above may be thought of as a matrix equation , where @xmath176 and @xmath177 represent our uncorrected and corrected ( respectively ) data arrays , and @xmath178 represents a correction matrix .",
    "the entries of this correction matrix are calculated by the appropriate binning of the coefficients in our correction equation ( reproduced from [ finaliu ] ) , @xmath179 where the  coefficients \" are the quantities preceeding @xmath180 on the right hand side of the equation . if the timescale within which one wishes to recalculate the effect of the ionosphere is small compared to the timescale",
    "within which the ionosphere significantly changes , then it is possible that the correction matrix * a@xmath40*@xmath181 has changed very little from that previously calculated .",
    "more specifically , if one wishes to calculate the correction matrix at a time @xmath182 shortly after having calculated it at time @xmath183 ( ie , if @xmath184 where @xmath185 is the time scale of significant change in the ionosphere ) , then @xmath186 where @xmath187 represents a small correction matrix . in this regime , it is computationally much easier to calculate the small correction @xmath187 and add it to the previously calculated @xmath188 then to calculate @xmath189 from scratch",
    ". therefore , in such a scenario the process of updating the correction matrix is computationally favorable .",
    "the first order correction @xmath187 may be analytically calculated as follows : let s assume that we model the ionosphere using the effective modes @xmath190 that we have been throughout this paper ( see equations [ c_qdef ] and [ d_qdef ] ) , and that the @xmath122 represent part of a fixed fourier basis while the @xmath191 are our fitting parameters .",
    "( in other words , the @xmath122 are fixed and time independent , while the @xmath191 fluctuate with time ) .",
    "let s assume that we ve calculated the correction at a time @xmath183 .",
    "more specifically , assume that for all @xmath1 we ve calculated and stored all the relevent terms in the correction equation for @xmath192 , @xmath193 where the time dependence of @xmath194 , @xmath195 , and @xmath191 is now explicit .",
    "now we want to correct for the ionosphere at a later time @xmath182 . to compose the correction matrix at time @xmath182 , we could start with the full correction formula , @xmath196 and then construct the new matrix @xmath189 . instead , however , let s assume that we re in the regime of small ionospheric changes , so that to first order @xmath197 where @xmath198 is small . substituting this into the full correction and only keeping terms to first order we",
    "obtain @xmath199 in this final equation , the coefficients in this first group of terms exactly replicate those coefficients from time @xmath183 ( see equation [ t_0 ] ) . in other words , these terms represent the previously determined correction matrix @xmath188 .",
    "the second group represents the small adjustment @xmath187 to the correction matrix at @xmath183 .",
    "notice that these terms have been there own maximum cutoff for @xmath62 , labeled as @xmath200 in the above equation .",
    "if the quantity @xmath201 is small , as assumed , then the individual terms in this second sum are also small , and thus a smaller value of @xmath200 is necessary to obtain a desired fractional error for the intensity . in this case , it is computationally favorable to update the correction matrix rather than derive it from scratch .",
    "it should also be noted that if @xmath202 , then the nonzero entries of the matrix @xmath187 form a subset of the nonzero entries of the matrix @xmath188 , and thus their sum ( which represents @xmath189 ) is equally as sparse as @xmath188 . in other words , the matrix @xmath203 does not become less sparse through this process of correction ( a fact which is important for large numerical matrix manipulations ) .",
    "it is worth mentioning that whether updating the correction matrix is a viable method depends on the time scales of the changing ionosphere .",
    "more specifically , the above was calculated keeping only terms to first order in @xmath201 .",
    "it is possible that for the time scales considered higher terms are also necessary , or that @xmath198 is not small compared to @xmath204 ; the former situation complicates the math but does not necessarily outrule this method , while the latter pretty much requires that the correction matrix be built from scratch every time .",
    "the @xmath0-plane correction only makes computational sense if the model for the ionospheric perturbation allows for an analytic solution to @xmath22 ( equation [ iupure ] ) .",
    "one such model is a sum over sinusoidal modes ( equation [ dtsine ] ) . by running numerical codes with this choice , the most important result discovered was that under correcting in the @xmath0-plane is worse than not correcting at all ( section [ nmax ] ) .",
    "but in addition to this , correcting to too many orders or requiring too many modes to model the effect of the ionosphere may lead to a computationally unreasonable problem ( section [ numterms ] ) . to help avoid this issue , a theoretical estimate of the number of orders of correction necessary ( which agrees well with the sample sky provided in this paper ) may be used ( section [ theorynmax ] ) .",
    "this estimate reveals that the number of orders of correction necessary varies in the @xmath0-plane .",
    "this , however , suggests two methods for alleviating the problem : eliminating those points in the @xmath0-plane which are particularly troublesome at the cost of precision for the real space sky ( section [ meth1 ] ) and correcting to different orders at different points in the @xmath0-plane ( section [ meth2 ] ) .",
    "both techniques prove successful and make the problem of correcting in the @xmath0-plane more feasible .",
    "in addition , depending on how often the ionosphere s effect is updated compared to the timescales of change in the ionosphere , it may be compuationally favorable to update the previously determined effect of the ionosphere rather than rederive its full effect from scratch each time .",
    "the authors would like to thank matias zaldarriaga for helpful conversations .",
    "the purpose of this appendix is to rigorously derive some of the mathematical formulas merely stated within the main text .",
    "it is included for completeness and for the curious reader ; no new results are derived .",
    "in this section , we solve for the unperturbed intensity @xmath22 , @xmath205 using a sum over sinusoidal modes for our ionospheric deflection @xmath48 , @xmath206 with a bit of algebra ( and keeping in mind that @xmath52 and @xmath8 are real but @xmath53 is complex ) , @xmath48 may be written as @xmath207 where @xmath208 is the complex conjugate of @xmath53 . with this choice of @xmath48 ,",
    "the expression for @xmath22 becomes @xmath209    before proceeding , it is convenient to convert the summation over @xmath210 as follows : @xmath211 where @xmath212 and @xmath213 with this form , we see that although there are @xmath70 modes distorting the sky , there are @xmath71 terms in the sum .",
    "this extra factor of 2 comes from the above constraint that @xmath48 be real .",
    "we will refer to these modes labeled by ( @xmath214 ) as _ effective modes_. writing the intensity @xmath22 in terms of effective modes gives @xmath215 the individual terms inside the summation over @xmath62 may be manipulated using the multinomial expansion to give @xmath216 where @xmath217 denotes a restricted sum such that @xmath68 and @xmath69 .",
    "the expression for @xmath22 now becomes @xmath218 because of the above performed multinomial expansion , the integral over @xmath8 ( once brought inside the summation ) now takes on the familiar form of a delta - function , and is easily performed to yield @xmath219 the integral over @xmath38 is now a simple delta - function integral , and its integration gives @xmath220",
    "in this section , we estimate the error in the @xmath0-plane accumulated by truncating the infinite sum over @xmath62 after the term @xmath221 . recall that the total correction term is @xmath222",
    "when correcting through @xmath83 , the magnitude error @xmath104 in the correction is equal to the absolute value of the sum over all terms left out .",
    "more specifically , @xmath223 we now attempt to determine an upper bound @xmath103 on this error .",
    "to begin , we bring the absolute value inside the sum , so that all terms now add constructively , @xmath224 we expect the magnitude of @xmath22 will be approximately the same at all points in the @xmath0-plane . denoting the maximum value of @xmath225 for the uncorrected sky as @xmath226 , we find @xmath227 next , consider the terms in the sum of the form @xmath228 .",
    "define @xmath119 to be the maximum value of @xmath229 for a given value of @xmath1 and the effective modes in question .",
    "then , @xmath230 where the equality in the equation above occurs because the restricted sum over @xmath66 requires that @xmath231 . with this substitution ,",
    "the upper bound on our error function becomes @xmath232 now concentrate on the inner summation .",
    "define @xmath233 according to @xmath234 i assert that @xmath235 [ aside : before providing the proof of this , we should point out that the fraction @xmath236 is not guaranteed to be an integer , and therefore this factorial and the ones given hereafter should be taken to be given by the gamma - function @xmath237 , @xmath238\\ ] ] the proof is quite short :    \\i ) start with the given form of @xmath233 , corresponding to @xmath239 , for any @xmath240 .",
    "\\ii ) any value of @xmath241 which corresponds to an alternative choice for the @xmath66 under the constraint that @xmath231 may be obtained by multiplying this value for @xmath233 by a finite number of factors whose magnitudes are all less than 1 .",
    "therefore , @xmath233 is the maximum .",
    "an example may be quite useful here : consider the scenario with @xmath242 and @xmath243 . in this case , we assert that @xmath244 which corresponds to the choice @xmath245 for all four @xmath66 .",
    "now , let s pick an alternative choice for the @xmath66 ; let s say @xmath246 . for this choice we obtain , @xmath247 but this may be re - written as @xmath248 where the first factor transforms @xmath249 from ( 3,3 ) to ( 2,4 ) and the second transforms @xmath250 from ( 3,3 ) to ( 5,1 ) . therefore @xmath251 .",
    "our new knowledge of @xmath233 , when combined with our previous determination of the number of terms in the restricted sum over @xmath66 ( see section [ numterms ] ) , leads us to conclude that @xmath252 therefore , our new upper bound @xmath103 on the error @xmath104 becomes @xmath253 this is our final result for a strict upper bound on the total error .",
    "notice that this final step is equivalent to assuming that the contributions from all modes are as strong as the strongest , and add constructively . as such",
    ", @xmath103 is clearly an upperbound on the error . for one mode , this last step does not lead to that great of an overestimate . with the addition of more modes",
    ", however , this step overemphasises the contribution from weaker modes , and leads to a ( potentially much ) larger overestimate of the error .",
    "the goal of this section is to determine the value of @xmath89 necessary to obtain a precision in the @xmath0-plane equal to @xmath117 if given @xmath1 and the ionospheric modes distorting the sky . based upon the terrible consequences which result from undercorrecting in the @xmath0-plane ( see section [ nmax ] ) ,",
    "we begin with the expression just derived for the upperbound on the error in hopes of avoiding this pitfall .    in order to make sense of our expression for an upper bound @xmath103 ( equation [ uu ] ) and derive from it the optimal choice of @xmath89",
    ", we must make a few further approximations .",
    "some of these approximations will actually slightly decrease the expression for the error relative to @xmath103 , but are necessary in order to make sense of this ugly expression .",
    "to begin , we define @xmath254 so that @xmath255 next , we calculate the ratio @xmath256 and find that @xmath257 where we have employed stirling s approximation , @xmath258 stirling s approximation is best suited for large @xmath62 , but is actually quite accurate for small @xmath62 as well .",
    "it gives an answer within 8% of the actual value for @xmath259 , and within 1% for @xmath260 .",
    "in other words , by using this approximation we greatly simplify our expression and sacrifice only a little in terms of accuracy .",
    "using the fact that @xmath261 we see that for large @xmath62 this ratio reduces to @xmath262 this expression shows that at a critical value of @xmath62 , namely , @xmath263 this ratio is approximately equal to 1 , and @xmath264 . for @xmath265 , @xmath266 ; and for @xmath267 , @xmath268 .",
    "in other words , @xmath269 is an increasing function of @xmath62 until @xmath270 , and then decreases from then on .",
    "strictly speaking , these results are only valid for large @xmath271 . however , in order to get an approximate expression for @xmath89 , we now extend these results to all @xmath62 .",
    "the hope is that the approximate value of @xmath89 is varied only slightly by this extension to small @xmath62 .",
    "but even if this approximation causes large enough error to raise doubts about our quantitative results for @xmath89 , it should still be good enough to learn something about the qualitative behavior of @xmath89 . recall that setting @xmath91 is the same thing as not correcting in the @xmath0-plane ( see equation [ finaliu ] )",
    "; @xmath272 put differently , the @xmath273 term in the sum is of the order of the uncorrected @xmath0-plane , @xmath274 . according to the above , successive corrections @xmath269 differ in magnitude from the previous term by a factor of @xmath275 .",
    "therefore , the approximate magnitude of the term @xmath269 is @xmath276    we expect the distortions created by the sky to alter the magnitude of the intensity only very slightly , so that @xmath277 .",
    "furthermore , for @xmath278 ( which is the case for @xmath89 ) we approximate that the ratio @xmath256 falls quick enough that we may approximate the total remaining error as being enirely due to @xmath269 , @xmath279 , where @xmath280 is the intensity in the @xmath0-plane after being corrected to @xmath62 orders .",
    "therefore , in order to obtain an fractional error @xmath115 less than @xmath117 for our @xmath0-plane correction , we must correct to enough orders @xmath62 so that @xmath281 therefore the optimal value of @xmath89 is given by @xmath282 some values for @xmath89 given @xmath283 and @xmath117 are given in the table embedded within the main text , table [ nmaxtab ] .",
    "a bulk of this paper has assumed that @xmath126 takes the form          where @xmath130 and @xmath70 are the number of terms in the @xmath88 and @xmath131 directions , respectively , necessary to accurately model the distortion by the ionosphere .",
    "the @xmath132 and @xmath133 here are real . similar to last time ,",
    "this choice is chosen because it allows an analytic solution to @xmath22 . with this choice , our earlier equation for @xmath22 ,",
    "@xmath284 becomes @xmath285 where @xmath286 first , we focus on evaluating @xmath287 . to do this",
    ", we first taylor - expand the second exponential , @xmath288 where the sum over @xmath137 is a restricted sum such that @xmath289 .",
    "plugging this into our expression for @xmath287 gives @xmath290 where we have assumed that the summations and the integrals may be freely interchanged . to solve this integral",
    ", we first introduce an additional parameter @xmath156 ( which we will eventually set to 1 ) and notice that @xmath291 therefore , if we define @xmath292 , then @xmath293 but , @xmath294 thus , @xmath295 plugging this into our earlier expression for @xmath22 , we obtain @xmath296 where @xmath297 but @xmath298 here is of the same form as @xmath287 earlier , and therefore @xmath299 where @xmath135 @xmath136 and the sums over @xmath137 and @xmath138 are restricted so that @xmath139 and @xmath140 .",
    "mitchell , d.a . ; greenhill , l.j . ; wayth , r.b .",
    "; sault , r.j . ; lonsdale , c.j . ; cappallo , r.j . ; morales , m.f . ; ord , s.m .",
    ", `` real - time calibration of the murchison widefield array , '' selected topics in signal processing , ieee journal of , vol.2 , no.5 , pp.707 - 717 , oct .",
    "2008 url : http://ieeexplore.ieee.org / stamp / stamp.jsp?arnumber= \\linebreak 4703504&isnumber=4703300[http://ieeexplore.ieee.org / stamp / stamp.jsp?arnumber= \\linebreak 4703504&isnumber=4703300 ]"
  ],
  "abstract_text": [
    "<S> as is common for antenna arrays in radio astronomy , the output of the mwa s correlator is the intensity measured in visibility space . </S>",
    "<S> in addition , the final power spectrum will be created in visibility space . as such , </S>",
    "<S> correcting for the ionosphere in visibility space instead of real space saves the computation required to inverse fourier transform to real space and then fourier transform back ( a significant decrease in computation for systems operating in real time such as the mwa . ) in this paper , we explore this problem of correcting for ionospheric distortions in the @xmath0-plane . </S>",
    "<S> the mathematical formula for obtaining the unperturbed data from that reflected by the ionosphere is non - local , which in any practical application creates edge effects because of the finite nature of the @xmath0-plane ( section [ ic ] ) . </S>",
    "<S> in addition , obtaining an analytic solution for the unperturbed intensity is quite difficult , and can only be done using very specific expansions of ionospheric perturbations . </S>",
    "<S> we choose one of these models ( with perturbations as sinusoidal modes , section [ sinmodes ] ) and run numerical codes to further study the correction . numerically implementing this correction to too few orders </S>",
    "<S> distorts the data in such a way as to be worse than not correcting at all ( section [ nmax ] ) . </S>",
    "<S> it is therefore critical to correct to the correct number of orders , and we present an analytic estimate for the optimal order ( section [ theorynmax ] ) . this analytic estimate shows that the optimal number of orders varies with @xmath1 , and in particular increases as @xmath1 increases along the direction of an ionospheric distorting mode </S>",
    "<S> . based on this observation , we then investigate a couple of methods which save computation ( section [ feasible ] ) . </S>",
    "<S> these methods are ( a ) eliminating the intensity at values of @xmath1 which require too many orders , and ( b ) correcting to different orders at different @xmath1 . </S>",
    "<S> both methods prove successful , although the first creates a loss of some precision in the real space sky . </S>",
    "<S> we conclude by considering an alternate form with which to model ionospheric perturbations ( section [ choice2 ] ) . </S>",
    "<S> this alternate form was once again chosen because it lends itself to an analytic solution , but contains as many ( if not more ) downfalls than the original choice . </S>"
  ]
}