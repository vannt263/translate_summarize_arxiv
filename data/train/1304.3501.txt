{
  "article_text": [
    "recent years witnessed large developments in the kinetic theory methods applied to mathematical physics and more recently also to mathematical biology . among important branches of the kinetic theory",
    "are optimal transportation problems and related to them wasserstein metrics , and monge - kantorovich metrics @xcite .",
    "partial differential equations in metric spaces are being applied to transportation problems @xcite , gradient flows @xcite and structured population models @xcite .",
    "output of mathematical modeling can often be described as radon measures .",
    "comparing the results of the models requires then a definition of distance in the space of measures .",
    "the desired properties of such metrics depend on the structure of the considered problem . in most of the cases ,",
    "the topology of total variation is too strong for applications , and weaker metrics had to be introduced , see @xcite for details . well known @xmath2-wasserstein metric , on the other hand , is only applicable to processes with mass conservation . to cope with growth in the process ,",
    "various modifications have been proposed , including flat metric and centralized wasserstein metric . in the present paper",
    ", we additionally introduce a normalized wasserstein distance . for comparison of different metrics ,",
    "their interpretation and examples see table [ table ] . even though , all those distances can be computed using linear programming ( lp ) , its computational complexity becomes often larger than the complexity of solving the original problem .",
    "for example , the equations for which the stability of numerical algorithm is proven in @xmath3 require an efficient algorithm for the flat metric to find the residual error .",
    "algorithms proposed in this paper are designed to compute efficiently wasserstein - type distance between two radon measures in the form of @xmath4 , where @xmath5 is the dirac delta .",
    "the algorithms can be also applied for the case of an arbitrary pair of measures , by approximating those measures by the sum of dirac deltas . in the process of finding numerical solutions to partial differential equations",
    ", the distance between a discrete and absolutely continuous measures is needed to evaluate the quality of the initial condition approximation , while the distance between two discrete measure is needed to find the residual error .",
    "the paper is organized as follows . in section [ metrics ]",
    "we introduce and compare four wasserstein - type metrics .",
    "additionally , we introduce a two - argument function , based on the wasserstein distance , which is not a metric , however , provides a good tool to estimate the flat metric from above .",
    "section [ algorithms ] is devoted to numerical algorithms proposed to calculate distances between two measures in respect to the considered metrics .",
    "we justify the algorithms and provide respective pseudocodes .",
    "the novelty of this paper is the algorithm for flat metric , which has been recently proven to be adequate for the escalator boxcar train ( ebt ) method for solving transport equations @xcite .",
    "we propose an efficient algorithm which computation cost is @xmath6 and optimize it further to @xmath1 .",
    "to judge the efficiency of the algorithms , we compare the times needed to compute the flat distance between two sums of a large number of dirac deltas randomly distributed over [ -1,1 ] .",
    "the framework of wasserstein metric in the spaces of probability measures has proven to be very useful for the analysis of equations given in a conservative form , such as , for example , transport equation @xcite , fokker - planck @xcite or nonlinear diffusion equation @xcite .",
    "it was originally defined using the notion of optimal transportation , but we focus on its dual representation",
    ".    @xmath2-wasserstein distance between two measures @xmath7 and @xmath8 is given by    @xmath9    observe that the integral @xmath10 is invariant with respect to adding a constant to function @xmath11 .",
    "consequently , for any @xmath12 holds    @xmath13    furthermore , the following two properties hold :    * @xmath2-wasserstein distance is scale - invariant @xmath14 * @xmath2-wasserstein distance is translation - invariant @xmath15      if @xmath16 , then @xmath17 by the dual representation definition .",
    "it makes this metric useless for processes not preserving the conservation of mass .    in this section",
    "we introduce a simple normalization that leads to a definition of translation - invariant metric suitable for non - local models    we define normalized @xmath2-wasserstein distance between two measures @xmath7 and @xmath8 as    @xmath18    where @xmath19 denotes the total variation of the measure @xmath7 .",
    "the distance defined by is a metric .",
    "let @xmath7 , @xmath8 and @xmath20 be radon measures .",
    "then , it holds    * @xmath21 if and only if @xmath22 .",
    "+ indeed , either @xmath23 or @xmath24 imply that @xmath22 .",
    "* @xmath25 , * since @xmath26 to show the triangle inequality , we consider four possibilities @xmath27    this metric can be easily computed numerically using the algorithm for @xmath2-wasserstein distance .",
    "however , it lacks the scaling property , which holds for the wasserstein distance , and which is useful for applications . nonetheless , the following weaker property holds .",
    "let @xmath28 and @xmath29 be two sequences of radon measures and @xmath30 , @xmath31 then @xmath32      in this section we present a different modification of the @xmath2-wasserstein distance , which is scale - invariant .",
    "we define centralized @xmath2-wasserstein distance between two measures @xmath7 and @xmath8 as @xmath33\\right\\}.\\ ] ]    the metric was introduced in @xcite for analysis of the structured population models in the spaces of non - negative radon measures , @xmath34 , on @xmath35 with integrable first moment , i.e. , @xmath36    this metric satisfies the scaling property , but on the contrary to wasserstein metric , it is not invariant with respect to translations .",
    "it is therefore only useful for modeling specific phenomena , for example structured population dynamics where mass generation can only occur in one specific point of space .",
    "another solution of the problem of comparing two measures of different masses is the flat metric which is defined as follows    flat distance between two measures @xmath7 and @xmath8 is given by @xmath37    the flat metric , known also as a bounded lipschitz distance @xcite , corresponds to the dual norm of @xmath38 , since the test functions used in the above definition are dense in @xmath39 .",
    "this metric satisfies the scaling property and it is translation invariant .",
    "it has proven to be useful in analysis of structured population models and in particularly , lipschitz dependence of solutions on the model parameters and initial data @xcite .",
    "the flat metric has been recently used for the proof of convergence and stability of ebt , which is a numerical algorithm based on particle method , for the transport equation with growth terms @xcite .",
    "consequently , an implementation of the ebt method requires an algorithm to compute the flat distance between two measures .",
    "computing of flat metric exactly is more costly than computing of @xmath2-wasserstein metric ( @xmath1 vs @xmath40 , see section [ sectionflatalg ] ) .",
    "moreover , often in applications it is sufficient to calculate upper bound of the distance , for example when computing residual error .",
    "we propose the following function , which requires only linear computing time .",
    "@xmath41    let @xmath7 , @xmath8 be radon measures on @xmath0 .",
    "then , the following estimate holds @xmath42    assume that @xmath43 .",
    "then , using the estimate of the flat metric by @xmath2-wasserstein distance for the measures with equal masses provides @xmath44 the last equality results from the representation of radon distance and positivity of measure @xmath8 .",
    "the upper bound function is more useful if it can be estimated from above by @xmath45 for some constant @xmath46 . in a general case , however , such constant",
    "does not exist , since by taking @xmath47 , @xmath48 and passing @xmath49 we obtain @xmath50 nevertheless , the desired estimate can be shown on a bounded set .",
    "let @xmath7 , @xmath8 be non - negative radon measures on a compact set @xmath51 , then the following estimate holds @xmath52    let @xmath53 and @xmath54 be such point that @xmath55 for any @xmath56 .",
    "then , assuming @xmath43 , we obtain    @xmath57      in the following table we compare the introduced metrics and provide examples and interpretations in terms of optimal transport .",
    "@xmath58 & scale - invariance & translation - invariance & intuition of @xmath59 & compute complexity +   wasserstein & @xmath60 & yes & yes & the cost of optimal transportation of distribution @xmath7 to a state given by @xmath8 , assuming that moving mass @xmath61 by @xmath62 requires @xmath63 energy .",
    "& @xmath40 +   wasserstein normalized & @xmath64 @xmath65 & & & minimum of the cost of annihilating @xmath7 and generating @xmath8 ; and of the cost of generating the difference in mass between @xmath7 and @xmath8 and transporting @xmath66 to @xmath67 , assuming that generating / annihilating mass at any position requires the cost equal to the mass . & @xmath40 +   wasserstein centralized & @xmath68 & yes & no & the cost of generating the difference in mass in point @xmath69 in space added to the cost of transporting @xmath70 to @xmath8 . & @xmath40 +   flat & @xmath71 & yes & yes & the cost of optimal transporting and/or generating and/or annihilating mass to form @xmath8 from @xmath7 . & @xmath1 +   radon & @xmath72 & yes & yes & the cost of generating and/or annihilating mass to form @xmath8 from @xmath7 & @xmath40 +",
    "in the remainder of this paper , we present algorithms for computing and approximating of the introduced metrics .",
    "we start with introducing the algorithm for computation of @xmath2-wasserstein distance .",
    "the algorithm is well - known and straightforward .",
    "nevertheless , we present it here , since the specific approach used in this section will be also applied later in the proof of correctness of more involved algorithms for other distances .",
    "define @xmath77}{n}}}&=&\\sum_{i=1}^{n}\\delta_{i / n}\\mu\\left[\\frac{i-1}{n},\\frac{i}{n}\\right).\\\\\\end{aligned}\\ ] ] then , we estimate @xmath78}{n } } ) \\leq \\sum_{i=1}^{n}\\frac{1}{n } \\mu\\left[\\frac{i-1}{n},\\frac{i}{n}\\right ) \\leq \\frac{1}{n } \\mu[0,1],\\ ] ] and the right - hand side tends to @xmath69 with @xmath79 .",
    "consequently , @xmath2-wasserstein distance between an arbitrary pair of finite radon measures can be estimated by the distances between their discrete approximations . from this point on",
    ", we assume that @xmath80              define @xmath85 then , obviously @xmath86 .",
    "denote @xmath87 , and observe that @xmath88 @xmath89}w_{1}^{1}(x)=a_{2}x+a_{1}x+a_{1}\\cdot sgn(a_{1})d_{1}=\\\\   & = & \\left(a_{1}+a_{2}\\right)x+|a_{1}|d_{1}.\\end{aligned}\\ ] ] it can be shown by induction that @xmath90 notice that the value @xmath91 is not used in this formula .",
    "it is , however , involved indirectly , as @xmath92 .",
    "we assume @xmath108 define @xmath109 as already proven @xmath110 from lp representation of the metric @xmath111 it can be deduced that @xmath112}\\left(\\underline{w}_{1}^{m+1}(x)+\\overline{w}_{1}^{m+1}(x)-a_{m+1}x\\right),\\ ] ] so the distance is given by the formula @xmath113                                        each iteration of each loop takes a constant time .",
    "the total number of iterations in all three loops is equal to @xmath131 .",
    "computational complexity of this algorithm is therefore @xmath102 , while the memory complexity is @xmath103 .",
    "the algorithm for flat distance requires storing the shape of functions analogous to @xmath132 as they get more complicated when @xmath61 increases . in section [ flat_alg ]",
    "we provide a recursive formula for the sequence of these functions .",
    "the pseudocode in section [ flat_pseudo ] implements the algorithm using an abstract data structure to store previously defined functions .",
    "the computational complexity depends on the choice of this structure . in further sections we provide two solutions that require @xmath6 and @xmath1 operations .",
    "define @xmath138 obviously , it holds by definition @xmath139}f^{n}(x).\\ ] ] observe that @xmath140\\cap[-1,1]}f^{1}(x ) = a_{2}x+\\min(|a_{1}|,a_{1}x+|a_{1}|d_{1}),\\\\\\\\\\\\ f^{m}(x ) & = & a_{m}x+\\sup_{f_{m-1}\\in[x - d_{m-1},x+d_{m-1}]\\cap[-1,1]}f^{m-1}(x).\\end{aligned}\\ ] ] computing of @xmath141 based on @xmath142 is more complex than in previous cases , as @xmath142 is not necessarily monotonic .",
    "@xmath146\\cap[-1,1]}f^{n}(x).\\ ] ] choose @xmath147 $ ]",
    ". then , there exist @xmath148,\\ , y'\\in b(y , d)\\cap[-1,1]$ ] such that @xmath149 because @xmath143 is concave , it holds @xmath150 the last inequality follows from @xmath151 .",
    "it is now proven that @xmath152 is convex , as it is a sum of a linear function and a convex function @xmath153 .    for each @xmath61",
    "the function @xmath143 is piecewise linear on @xmath61 intervals and it holds for some point @xmath154",
    "@xmath155}}\\\\ f^{m-1}(x_m ) & \\mbox{on \\ensuremath{[x_m - d_{m-1},x_m+d_{m-1}]}}\\\\ f^{m-1}(x - d_{m-1 } ) & \\mbox{on \\ensuremath{[x_m+d_{m-1},1 ] } } \\end{cases}\\ ] ]    @xmath156 is a linear function , so it can be described by its values in @xmath157 .",
    "assume that @xmath143 can be described by at most @xmath158 points and is linear between those points .",
    "as @xmath143 is concave , there exists a point @xmath159 $ ] such that @xmath160 for every @xmath62 . the maximum of @xmath143 on an interval whose both ends are smaller than @xmath161 is taken on its right end .",
    "similarly , if both ends of the intervals are larger than @xmath161 , the maximum is taken on its left end .",
    "finally , if the interval contains @xmath161 , the maximum is in @xmath161 .",
    "these considerations prove the formula for @xmath162 .",
    "it follows that @xmath163 is piecewise linear and it can be described by as many points as @xmath164}$ ] plus @xmath2 .",
    "the simplest implementation of @xmath186 uses an array of pairs @xmath187 sorted by @xmath169 in ascending order and by @xmath188 in the reverse order in the same time .",
    "this is possible based on lemma [ concave ] .",
    "the first block of instructions can be performed in @xmath189 by simply shifting all elements such that @xmath190 to the right , and modifying @xmath169 by iterating over all elements of @xmath186 .",
    "the next block ( computing of @xmath191 ) can be computed with the same complexity , as @xmath192 is simply the next element after @xmath169 in the ordered array .",
    "finally , every instruction in the last block can be performed in @xmath189 by iterating over all its elements .          in this implementation @xmath186",
    "is represented by global variables @xmath193 and a bst of values @xmath194 where @xmath188 is the key .",
    "an entry @xmath187 in this structure is represented as @xmath195 so obtaining an element of @xmath186 may take linear time .",
    "the advantages of this structure can be easily seen when analyzing the first block of the code .",
    "the division of @xmath186 by the value of @xmath188 ( at first @xmath69 ) can be achieved in @xmath196 .",
    "shifting all elements of those subsets can then be done in a constant time by modifying first elements of those sets . adding the extra node also requires @xmath196 operations .",
    "removing nodes with the first coordinate @xmath197 is obviously done in @xmath40 in total . identifying nodes with the first coordinate @xmath198 might seem problematic .",
    "it is , however , known that for the least @xmath188 the value of @xmath169 is equal to @xmath199 .",
    "relevant nodes can be , therefore , removed from the back in @xmath40 .",
    "adding @xmath91 to the second coordinate of each node is done by adding it to global variable @xmath193 .",
    "performance of the algorithm depends on the choice of @xmath186 data structure .",
    "theoretic bounds for computational complexity are , however , not sufficient to argue about performance of these two options .",
    "the first reason is that the each operation in @xmath185 algorithm is much faster than in @xmath1 in terms of number of instructions .",
    "secondly , hardware architectures provide solutions in which iterating over large tables is accelerated .",
    "finally , the algorithm does reach its theoretical bound only if many points concentrate on a small interval .",
    "a gap of size @xmath201 between two points completely cleans @xmath186 data structure .",
    "all that is shown in numerical tests . to measure performance",
    "we have used a single core of amd athlon ii x4 605e processor clocked at 2.3ghz with 8 gb of memory .",
    "the results are presented in figs.[fig1]-[fig2 ] .",
    "dirac deltas randomly distributed over @xmath202 $ ] .",
    "the plot shows how the time of computation depends on @xmath203 .",
    "for each input size 100 independent tests were executed to demonstrate how sensitive the algorithms are to input data distribution .",
    "results of @xmath204 algorithm are depicted as red dots , and results of @xmath6 algorithm as blue dots.,width=547 ]     dirac deltas with a distributed over a large domain , i.e. distance between each two masses is larger than @xmath201 . in this case",
    "both algorithms are in fact linear , as the funcdescription structure has at most two elements .",
    "the plot demonstrates the overhead of using bst structures .",
    "results of @xmath204 algorithm are depicted as red dots , and results of @xmath6 algorithm as blue dots.,width=547 ]    * acknowledgments * + jj was supported by the international ph.d .",
    "projects program of foundation for polish science operated within the innovative economy operational program 2009 - 2015 funded by european regional development fund ( ph.d . program : mathematical methods in natural sciences ) .",
    "am - c was supported by the erc starting grant `` biostruct '' no .",
    "210680 and the emmy noether program of the german research council ( dfg ) .",
    "l.  ambrosio and g.  crippa .",
    "_ existence , uniqueness , stability and differentiability properties of the flow associated to weakly differentiable vector fields _ in transport equations and multi - d hyperbolic conservation laws , lect .",
    "notes unione mat .",
    "springer 5 : 357 , 2008 .                  , _ an introduction to the nonlinear boltzmann - vlasov equation _ , in kinetic theories and the boltzmann equation , springer , berlin , lecture notes in math . 1048 : 60110 , 1981 . , , 5 : 873900 , 2012 . .",
    "variational particle schemes for the porous medium equation and for the system of isentropic euler equations _ math .",
    "44 : 133166 , 2010 . , springer - verlag , berlin , 2009"
  ],
  "abstract_text": [
    "<S> in this paper numerical methods of computing distances between two radon measures on @xmath0 are discussed . </S>",
    "<S> efficient algorithms for wasserstein - type metrics are provided . in particular , we propose a novel algorithm to compute the flat metric ( bounded lipschitz distance ) with a computational cost @xmath1 . the flat distance has recently proven to be adequate for the escalator boxcar train ( ebt ) method for solving transport equations with growth terms . therefore , </S>",
    "<S> finding efficient numerical algorithms to compute the flat distance between two measures is important for finding the residual error and validating empirical convergence of different methods .    </S>",
    "<S> * keywords : * metric spaces , flat metric , wasserstein distance , radon measures , optimal transport , linear programming , minimum - cost flow </S>"
  ]
}