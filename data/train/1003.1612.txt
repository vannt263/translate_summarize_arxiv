{
  "article_text": [
    "density functional theory ( dft ) is a powerful method for computing ground state electronic energies and densities in quantum chemistry , materials science , molecular biology and nanosciences .",
    "the models originating from dft can be classified into two categories : the orbital - free models and the kohn - sham models .",
    "the thomas - fermi - von weizscker ( tfw ) model falls into the first category .",
    "it is not very much used in practice , but is interesting from a mathematical viewpoint  @xcite .",
    "it indeed serves as a toy model for the analysis of the more complex electronic structure models routinely used by physicists and chemists . at the other extremity of the spectrum ,",
    "the kohn - sham models @xcite are among the most widely used models in physics and chemistry , but are much more difficult to deal with .",
    "we focus here on the numerical analysis of the tfw model on the one hand , and of the kohn - sham model , within the local density approximation ( lda ) , on the other hand .",
    "more precisely , we are interested in the spectral and pseudospectral fourier , more commonly called planewave , discretizations of the periodic versions of these two models . in this context , the simulation domain , sometimes referred to as the supercell , is the unit cell of some periodic lattice of @xmath0 . in the tfw model ,",
    "periodic boundary conditions ( pbc ) are imposed to the density ; in the kohn - sham framework , they are imposed to the kohn - sham orbitals ( born - von karman pbc ) .",
    "imposing pbc at the boundary of the simulation cell is a standard method to compute condensed phase properties with a limited number of atoms in the simulation cell , hence at a moderate computational cost .",
    "this article is organized as follows . in section  [ sec : fourier ] , we briefly introduce the functional setting used in the formulation and the analysis of the planewave discretization of orbital - free and kohn - sham models . in section  [ sec : tfw ] , we provide _ a priori _ error estimates for the planewave discretization of the tfw model , including numerical integration . in section  [ sec : ks ] , we deal with the kohn - sham lda model .",
    "throughout this article , we denote by @xmath1 the simulation cell , by @xmath2 the periodic lattice , and by @xmath3 the dual lattice . for simplicity , we assume that @xmath4 ( @xmath5 ) , in which case @xmath2 is the cubic lattice @xmath6 , and @xmath7 . our arguments can be easily extended to the general case . for @xmath8 , we denote by @xmath9 the planewave with wavevector @xmath10 .",
    "the family @xmath11 forms an orthonormal basis of @xmath12 and for all @xmath13 , @xmath14 in our analysis , we will mainly consider real valued functions . we therefore introduce the sobolev spaces of real valued @xmath2-periodic functions @xmath15 @xmath16 ( here and in the sequel @xmath17 denotes the complex conjugate of the complex number @xmath18 ) , endowed with the inner products @xmath19 for @xmath20 , we denote by @xmath21 (",
    "the constraints @xmath22 imply that the functions of @xmath23 are real valued ) . for all @xmath16 , and each @xmath24 , the best approximation of @xmath25 in @xmath23 for _ any _",
    "@xmath26-norm , @xmath27 , is @xmath28 the more regular @xmath25 ( the regularity being measured in terms of the sobolev norms @xmath29 ) , the faster the convergence of this truncated series to @xmath25 : for all real numbers @xmath30 and @xmath31 with @xmath27 , we have for each @xmath32 , @xmath33 for @xmath34 , we denote by @xmath35 the discrete fourier transform on the carterisan grid @xmath36 of the function @xmath37 , where @xmath38 recall that if @xmath39 , the discrete fourier transform of @xmath40 is the @xmath41-periodic sequence @xmath42 where @xmath43 we now introduce the subspaces @xmath44 ( @xmath45 and @xmath46 ) , and @xmath47 .",
    "note that @xmath48 is a subspace of @xmath49 of dimension @xmath50 , for all @xmath16 , and that if @xmath51 is odd , @xmath52 it is then possible to define the interpolation projector @xmath53 from @xmath54 onto @xmath48 by @xmath55(x ) = \\phi(x)$ ] for all @xmath56 .",
    "it holds @xmath57 the coefficients of the expansion of @xmath58 in the canonical basis of @xmath48 is given by the discrete fourier transform of @xmath40 .",
    "in particular , when @xmath51 is odd , we have the simple relation @xmath59 it is easy to check that if @xmath40 is real - valued , then so is @xmath58",
    ".    we will assume in the sequel that @xmath60 .",
    "we will then have for all @xmath61 , @xmath62    the following lemma gathers some technical results which will be useful for the numerical analysis of the planewave discretization of orbital - free and kohn - sham models .",
    "[ lem : technical ] let @xmath63 and @xmath64 such that @xmath60 .    1 .",
    "let @xmath65 be a function of @xmath54 and @xmath66 and @xmath67 be two functions of @xmath23 .",
    "then @xmath68 2 .",
    "let @xmath69 , @xmath70 , and @xmath65 a function of @xmath71 .",
    "then , @xmath72 for constants @xmath73 independent of @xmath65 . besides if there exists @xmath74 and @xmath75 such that @xmath76 , then there exists a constant @xmath77 independent of @xmath78 and @xmath51 such that @xmath79 3 .",
    "let @xmath40 be a borel function from @xmath80 to @xmath81 such that there exists @xmath82 for which @xmath83 for all @xmath84 .",
    "then , for all @xmath85 , @xmath86    for @xmath87 , it holds @xmath88 since @xmath89 is exactly integrated .",
    "the function @xmath90 being in @xmath91 , ( [ eq : ineg_ing_2 ] ) is proved . moreover , as @xmath92 , it follows from ( [ eq : exact_integration ] ) that @xmath93 hence ( [ eq : bound_ing1 ] ) .",
    "the estimate ( [ eq : ineg_ing_0 ] ) is proved in @xcite . to prove ( [ eq : ineg_ing_4 ] )",
    ", we notice that @xmath94 the bound ( [ eq : ineg_ing_5 ] ) is a straightforward consequence of ( [ eq : ineg_ing_0 ] ) : @xmath95 now , we notice that @xmath96 from ( [ eq : pi2ning ] ) , we obtain @xmath97 on the one hand , @xmath98 and on the other hand , we have for each @xmath99 such that @xmath100 , @xmath101 where @xmath102 the estimate ( [ eq : ineg_ing_6 ] ) then easily follows .",
    "let us finally prove ( [ eq : bound_ing2 ] ) . using ( [ eq : integration_formula_ing ] ) and ( [ eq : exact_integration ] )",
    ", we have @xmath103 this completes the proof of lemma  [ lem : technical ] .",
    "in the tfw model , as well as in any orbital - free model , the ground state electronic density of the system is obtained by minimizing an explicit functional of the density . denoting by @xmath104 the number of electrons in the simulation cell and by @xmath105 the set of admissible densities",
    ", the tfw problem reads @xmath106 where @xmath107    @xmath108 is a positive real number ( @xmath109 , @xmath110 or @xmath111 depending on the context @xcite ) , and @xmath112 is the thomas - fermi constant : @xmath113 . the last term of the tfw energy models the periodic coulomb energy : for @xmath114 and @xmath115 in @xmath116 , @xmath117 we finally make the assumption that @xmath118 is a @xmath2-periodic potential such that latexmath:[\\[\\label{eq : hypothesis } \\exists m > 3 , \\ ; c \\ge 0 \\mbox { s.t . }",
    "\\forall k \\in { \\mathcal r}^\\ast , \\ ;    @xmath118 is in @xmath120 for all @xmath121 , hence in @xmath122 since @xmath123 for @xmath124 small enough .",
    "it is convenient to reformulate the tfw model in terms of @xmath125 .",
    "it can be easily seen that @xmath126 where @xmath127    let @xmath128 and @xmath129 .",
    "the function @xmath130 is in @xmath131 , is strictly convex on @xmath132 , and for all @xmath133 , @xmath134    the first and second derivatives of @xmath135 are respectively given by @xmath136 where we have denoted by @xmath137 the tfw hamiltonian associated with the density @xmath114 @xmath138 where @xmath139 is the @xmath2-periodic coulomb potential generated by the @xmath2-periodic charge distribution  @xmath114 .",
    "recall that @xmath140 can also be defined as the unique solution in @xmath141 to @xmath142    let us recall ( see @xcite and the proof of lemma  2 in @xcite ) that    * ( [ eq : mintfwrho ] ) has a unique minimizer @xmath143 , and that the minimizers of ( [ eq : mintfwu ] ) are @xmath144 and @xmath145 , where @xmath146 ; * @xmath144 is in @xmath147 for each @xmath148 ( hence in @xmath149 since @xmath150 for @xmath124 small enough ) ;",
    "* @xmath151 on @xmath0 ; * @xmath144 satisfies the euler equation @xmath152 for some @xmath153 , ( the ground state eigenvalue of @xmath154 , that is non - degenerate ) .",
    "the planewave discretization of the tfw model is obtained by choosing    1 .   an energy cut - off @xmath155 or , equivalently , a finite dimensional fourier space @xmath23 , the integer @xmath78 being related to @xmath156 through the relation @xmath157 $ ] ; 2 .   a cartesian grid @xmath158 with step size @xmath159 where @xmath64 is such that @xmath60 ,    and by considering the finite dimensional minimization problem @xmath160 where @xmath161 @xmath53 denoting the interpolation operator introduced in the previous section . the euler equation associated with ( [ eq : mintfwun ] )",
    "can be written as a nonlinear eigenvalue problem @xmath162 where we have denoted by @xmath163 the pseudospectral tfw hamiltonian associated with the density @xmath114 , and by @xmath164 the lagrange multiplier of the constraint @xmath165 .",
    "we therefore have @xmath166   = \\lambda_{n_c , n_g } u_{n_c , n_g}.\\ ] ] under the condition that @xmath60 , we have for all @xmath167 , @xmath168 so that , @xmath169 is defined on @xmath23 by the fourier matrix @xmath170_{kl } & = & \\frac{c_{\\rm w}}2 |k|^2 \\delta_{kl } +   \\frac 53 c_{\\rm tf } \\widehat{(|u_{n_c , n_g}|^{4/3})}_{k - l}^{{\\rm fft},n_g } + \\widehat{(v^{\\rm ion})}_{k - l}^{{\\rm fft},n_g } \\\\ & &    + 4\\pi \\frac{\\widehat{(|u_{n_c , n_g}|^2)}_{k - l}^{{\\rm fft},n_g}}{|k - l|^2 } \\left ( 1 - \\delta_{kl } \\right),\\end{aligned}\\ ] ] where , by convention , the last term of the right hand side is equal to zero for @xmath171 .",
    "we also introduce the variational approximation of ( [ eq : mintfwu ] ) @xmath172 any minimizer @xmath173 to ( [ eq : mintfwuv ] ) satisfies the elliptic equation @xmath174 = \\lambda_{n_c}u_{n_c},\\ ] ] for some @xmath175 .    the main result of this section is an extension of results previously obtained by a. zhou  @xcite .",
    "[ th : tfw ] for each @xmath20 , we denote by @xmath173 a minimizer to ( [ eq : mintfwuv ] ) such that @xmath176 and , for each @xmath177 and @xmath60 , we denote by @xmath178 a minimizer to ( [ eq : mintfwun ] ) such that @xmath179 . then for @xmath78 large enough , @xmath173 and @xmath178 are unique , and the following estimates hold true @xmath180 for all @xmath181 and @xmath121 , and for some constants @xmath182 , @xmath183 , @xmath184 , @xmath185 and @xmath186 independent of @xmath78 and @xmath51 .    [",
    "th : of ] more complex orbital - free models have been proposed in the recent years @xcite , which are used to perform multimillion atom dft calculations .",
    "some of these models however are not well posed ( the energy functional is not bounded from below @xcite ) , and the others are not well understood from a mathematical point of view . for these reasons , we will not deal with those models in this article .      in this section ,",
    "we prove the first part of theorem  [ th : tfw ] , related to the variational approximation ( [ eq : mintfwuv ] ) .",
    "the estimates ( [ eq : estim_nc_u ] ) , ( [ eq : estim_nc_lambda ] ) and ( [ eq : estim_nc_i ] ) originate from arguments already introduced in @xcite",
    ". for brevity , we only recall the main steps of the proof and leave the details to the reader .",
    "the difference between ( [ eq : mintfwu ] ) and the problem dealt with in @xcite is the presence of the coulomb term @xmath187 , for which the following estimates are available : @xmath188 here and in the sequel , @xmath189 denotes a non - negative constant which may depend on @xmath1 , @xmath118 and @xmath104 , but not on the discretization parameters .    using ( [ eq : estim_d1 ] ) , ( [ eq : estim_d2 ] ) and the fact that @xmath190 on @xmath191 , we can then show ( see the proof of lemma  1 in @xcite ) that there exist @xmath192 , @xmath182 and @xmath193 such that for all @xmath194 , @xmath195 and for all @xmath194 such that @xmath196 and @xmath197 , @xmath198 remarking that @xmath199 and using ( [ eq : borne_1 ] ) , the positivity of the bilinear form @xmath200 , and the convexity of the function @xmath130 , we obtain that @xmath201 for each @xmath20 , @xmath202 satisfies @xmath203 and @xmath204 , and the sequence @xmath205 converges to @xmath144 in @xmath147 for each @xmath121 .",
    "as the functional @xmath135 is continuous on @xmath141 , we have @xmath206 hence , @xmath207 converges to @xmath144 in @xmath141 , and we also have @xmath208 \\\\ & { \\displaystyle } \\mathop{\\longrightarrow}_{n_c \\to \\infty } & { \\mathcal n}^{-1 } \\bigg [   \\frac { c_{\\rm w}}2 \\int_{\\gamma } |\\nabla u|^2 + \\int_\\gamma f(|u|^2 ) |u|^2   + \\int_\\gamma v^{\\rm ion } |u|^2 + d_\\gamma(|u|^2,|u|^2 ) \\bigg ] \\\\ & = & \\lambda.\\end{aligned}\\ ] ] as @xmath209 is bounded in @xmath210 , uniformly in @xmath78 , we deduce from ( [ eq : euler_vnc ] ) that the sequence @xmath207 is bounded in @xmath211 , hence in @xmath212 .",
    "now @xmath213.\\end{aligned}\\ ] ] observing that the right - hand side goes to zero in @xmath210 when @xmath78 goes to infinity , we obtain that @xmath207 converges to @xmath144 in @xmath211 , and therefore in @xmath214 .",
    "in addition , we know from harnack inequality  @xcite that @xmath151 in @xmath0 .",
    "consequently , for @xmath78 large enough , the function @xmath173 ( which is continuous and @xmath2-periodic ) is bounded away from @xmath215 , uniformly in @xmath78 . as @xmath216",
    ", one can see by a simple bootstrap argument that the convergence of @xmath207 to @xmath144 also holds in @xmath147 for each @xmath121 .",
    "the upper bound in  ( [ eq : estim_nc_i ] ) is obtained from ( [ eq : erreur_tfw_nc ] ) , remarking that @xmath217 and that @xmath218    the uniqueness of @xmath173 for @xmath78 large enough can then be checked as follows .",
    "first , @xmath219 satisfies the variational equation @xmath220 therefore @xmath221 is the variational approximation in @xmath23 of some eigenvalue of @xmath222 . as @xmath223 converges to @xmath144 in @xmath212 , @xmath224 converges to  @xmath215 in operator norm .",
    "consequently , the @xmath225 eigenvalue of @xmath222 converges to the @xmath225 eigenvalue of @xmath154 when @xmath78 goes to infinity , the convergence being uniform in @xmath226 .",
    "together with the fact that the sequence @xmath227 converges to @xmath228 , the non - degenerate ground state eigenvalue of @xmath154 , this implies that for @xmath78 large enough , @xmath221 is the ground state eigenvalue of @xmath222 in @xmath23 and for all @xmath229 such that @xmath230 and @xmath231 , @xmath232 it easily follows that for @xmath78 large enough , ( [ eq : mintfwuv ] ) has a unique minimizer @xmath173 such that @xmath176 .",
    "let us now establish the rates of convergence of @xmath233 and @xmath234 .",
    "first , @xmath235\\end{aligned}\\ ] ] with @xmath236 as @xmath173 is bounded away from @xmath215 and @xmath237 , the function @xmath67 is uniformly bounded in @xmath238 ( at least for @xmath78 large enough ) .",
    "we therefore obtain that for all @xmath239 , there exists a constant @xmath240 such that for all @xmath78 large enough , @xmath241 in order to evaluate the @xmath242-norm of the error @xmath243 , we first notice that @xmath244 and that @xmath245 for all @xmath246 , @xmath247 z_{n_c } \\nonumber \\\\ & & - 2d_\\gamma((u_{n_c}-u)(u_{n_c}+u),(u_{n_c}-u)z_{n_c } ) - 2d_\\gamma((u_{n_c}-u)^2,uz_{n_c } ) \\nonumber \\\\ & & + 2 ( \\lambda_{n_c}-\\lambda ) \\int_\\gamma u_{n_c}z_{n_c}. \\label{eq : new36}\\end{aligned}\\ ] ] on the other hand , we have for all @xmath229 such that @xmath230 , @xmath248 using ( [ eq : fff ] ) , ( [ eq : estim_d3 ] ) , ( [ eq : pre_estim_lambda ] ) with @xmath249 and the above equality , we therefore obtain for all @xmath229 such that @xmath230 , @xmath250 therefore , for @xmath78 large enough , we have for all @xmath229 such that @xmath230 , @xmath251 together with ( [ eq:4:1:h1 ] ) , this shows that there exists @xmath252 and @xmath75 such that for all @xmath253 , @xmath254 by a classical argument ( see e.g. the proof of theorem  1 in @xcite ) , we deduce from  ( [ eq : app - fourier ] ) and the above inequality that @xmath255 for some constant @xmath256 independent of @xmath78 .",
    "this completes the proof of the estimate in the @xmath242norm .",
    "we proceed with the analysis of the @xmath257norm .    for @xmath258 , we denote by @xmath259 the unique solution to the adjoint problem @xmath260 where @xmath261 the function @xmath259 is solution to the elliptic equation @xmath262 from which we deduce that if @xmath263 for some @xmath264 , then @xmath265 and @xmath266 for some constant @xmath267 independent of @xmath268 .",
    "let @xmath269 be the orthogonal projection , for the @xmath257 inner product , of @xmath173 on the affine space @xmath270 .",
    "one has @xmath271 from which we infer that @xmath272 .\\end{aligned}\\ ] ] for all @xmath273 , it therefore holds @xmath274 .",
    "\\label{eq : eeeee}\\end{aligned}\\ ] ] using ( [ eq : fff ] ) , ( [ eq : estim_d3 ] ) , ( [ eq : pre_estim_lambda ] ) with @xmath249 and ( [ eq : new36 ] ) , we obtain that for all @xmath275 , @xmath276 let us denote by @xmath277 the orthogonal projector on @xmath278 for the @xmath242 inner product and by @xmath279 . noticing that @xmath280 we obtain from ( [ eq : nrjsecondcontinue ] ) , ( [ eq : eeeee ] ) and ( [ eq : new37 ] ) that there exists @xmath252 and @xmath281 such that for all @xmath253 , @xmath282",
    "lastly , for all @xmath283 and all @xmath63 @xmath284 so that , in view of ( [ eq : app - fourier ] ) and ( [ eq : borne_psiw ] ) @xmath285 therefore , @xmath286 by means of the inverse inequality @xmath287 which holds true for all @xmath288 and all @xmath289 , we obtain that @xmath290 to complete the first part of the proof of theorem  [ th : tfw ] , we still have to compute the @xmath291-norm of the error @xmath243 for @xmath292 .",
    "let @xmath293 .",
    "proceeding as above we obtain @xmath294   \\nonumber\\\\&&\\qquad- \\frac 1{2{\\mathcal",
    "n } } \\|u_{n_c}-u \\|_{l^2_\\#}^2 \\int_\\gamma uw .",
    "\\label{eq : intom } \\end{aligned}\\ ] ] combining ( [ eq : nrjsecondcontinue ] ) , ( [ eq : borne_psiw ] ) , ( [ eq : new37 ] ) , ( [ eq : minuperp ] ) , ( [ eq : error_h1_f ] ) and ( [ eq : intom ] ) , we obtain that there exists a constant @xmath75 such that for all @xmath295 large enough and all @xmath296 , @xmath297    therefore @xmath298 for some constant @xmath299 independent of @xmath295 . using ( [ eq : pre_estim_lambda ] ) , ( [ eq : estim_h1 ] ) and ( [ eq : hm1boundfourier ] )",
    ", we end up with @xmath300      let us now turn to the pseudospectral approximation ( [ eq : mintfwun ] ) of ( [ eq : mintfwu ] ) .",
    "first , we notice that @xmath301 from which we infer that @xmath302 is uniformly bounded in @xmath141 .",
    "we then see that @xmath303.\\end{aligned}\\ ] ] using ( [ eq : bound_ing1 ] ) , ( [ eq : bound_ing2 ] ) and ( [ eq : estim_d1 ] ) , we obtain that @xmath164 also is uniformly bounded .",
    "now , @xmath304 and we deduce from ( [ eq : exact_integration ] ) , ( [ eq : bound_ing1 ] ) and ( [ eq : ineg_ing_4 ] ) that @xmath305 and that @xmath306 besides , using ( [ eq : estim_d4 ] ) , @xmath307 as @xmath178 is uniformly bounded in @xmath141 , and therefore in @xmath308 , we get @xmath309 therefore @xmath178 is uniformly bounded in @xmath211 , hence in @xmath310 .    returning to ( [ eq : edp_uncng ] ) and using ( [ eq : ineg_ing_5 ] ) , ( [ eq : hypothesis ] ) , and a bootstrap argument , we conclude that @xmath178 is in fact uniformly bounded in @xmath311 .",
    "next , using ( [ eq : pre_uniqueness ] ) , @xmath312 let @xmath313 .",
    "for @xmath78 large enough , @xmath173 is uniformly bounded away from zero ; besides , both @xmath173 and @xmath178 are uniformly bounded in @xmath311 .",
    "therefore , @xmath314 is uniformly bounded in @xmath311 .",
    "this implies that the fourier coefficients of @xmath314 go to zero faster that @xmath315 , which in turn implies , using ( [ eq : ineg_ing_2 ] ) and ( [ eq : ineg_ing_6 ] ) , that @xmath316 on the other hand , @xmath317 therefore , @xmath318 we then deduce from ( [ eq : bound_cc2 ] ) and the inverse inequality ( [ eq : inv_ineq ] ) that @xmath319 converges to @xmath144 in @xmath211 , and therefore in @xmath310 .",
    "it follows that for @xmath78 large enough , @xmath178 is bounded away from zero , which , together with ( [ eq : edp_uncng ] ) , implies that @xmath320 is bounded in @xmath147 .",
    "the estimates ( [ eq : bound_cc1 ] ) and ( [ eq : bound_cc2 ] ) can therefore be improved , yielding @xmath321 and @xmath322 we deduce ( [ eq : estim_ncng_u ] ) from the inverse inequality ( [ eq : inv_ineq ] ) .",
    "for @xmath78 large enough , @xmath178 is bounded away from zero , so that @xmath323 is uniformly bounded in @xmath147 . therefore , the @xmath324 fourier coefficient of @xmath325 is bounded by @xmath326 where the constant @xmath189 does not depend on @xmath78 and @xmath51 . using the equality @xmath327,\\end{aligned}\\ ] ] ( [ eq : estim_ncng_u ] ) and ( [ eq : estim_d3 ] ) ,",
    "we obtain ( [ eq : estim_ncng_lambda ] ) .",
    "a similar calculation leads to ( [ eq : estim_ncng_i ] ) .",
    "lastly , we have for all @xmath229 , @xmath328 as @xmath178 converges to @xmath144 in @xmath211 , the operator @xmath329 converges to zero in operator norm .",
    "reasoning as in the proof of the uniqueness of @xmath173 , we obtain that for @xmath78 large enough and @xmath60 , we have for all @xmath229 such that @xmath230 and @xmath231 , @xmath330 thus the uniqueness of @xmath178 for @xmath78 large enough .",
    "the periodic kohn - sham lda model with norm - conserving pseudopotentials  @xcite leads to the constrained optimization problem @xmath331 where @xmath332 @xmath104 being the number of valence electron pairs in the simulation cell , and where @xmath333 the density @xmath334 associated with @xmath335 , the coulomb energy @xmath336 and the lda exchange - correlation energy @xmath337 are respectively defined as @xmath338 where @xmath339 is the nonlinear core correction and where @xmath340 is an approximation of the exchange - correlation energy per unit volume in a uniform electron gas with charge density @xmath114 @xcite .",
    "the local and nonlocal contributions to the pseudopotential model the interactions between valence electrons on the one hand , and nuclei and core electrons on the other hand .",
    "troullier - martins pseudopotentials @xcite constitute a popular class of pseudopotentials for which the fourier coefficients @xmath341 decay as @xmath342 with @xmath343 .",
    "the nonlocal contribution is defined by @xmath344 where the functions @xmath345 are regular enough functions of @xmath210 . in all what follows",
    ", we will assume that @xmath346 the function @xmath347 does not have a simple analytical expression .",
    "although this function is of class @xmath348 on the open set @xmath191 , dft simulation softwares make use of approximate functions which are @xmath348 on @xmath349 but only @xmath350 in the neighborhood of the density @xmath351 ( atomic units ) @xcite . in order not to deteriorate the convergence rate of the pseudospectral approximation ,",
    "it is better to ressort to more regular approximations of the function @xmath352 ( see  @xcite ) .",
    "we will assume here that @xmath353}((0,+\\infty))$},\\label{eq : hyp_epsilon_xc } \\\\ & & e_{\\rm xc}^{\\rm lda}(0 ) = 0 , \\quad \\frac{de_{\\rm xc}^{\\rm lda}}{d\\rho}(0 ) = 0 , \\label{eq : hyp_epsilon_xc02}\\end{aligned}\\ ] ] ( where @xmath354 $ ] denotes the integer part of @xmath354 $ ] ) and that there exists @xmath355 and @xmath356 such that @xmath357 note that the x@xmath358 exchange - correlation functional ( @xmath359 , where @xmath360 is a given constant ) satisfies the assumptions ( [ eq : hyp_epsilon_xc])-([eq : hyp_epsilon_xc_2 ] ) with @xmath361 .",
    "let us also remark that ( [ eq : hyp_epsilon_xc ] ) and ( [ eq : hyp_epsilon_xc_2 ] ) imply that @xmath362 ) \\quad",
    "\\mbox{for each } l > 0,\\ ] ] a property we will make use of below .",
    "lastly , we assume for simplicity that @xmath363    it is easy to prove that under assumptions ( [ eq : decay_v_local])-([eq : rhoc ] ) , ( [ eq : min_ks ] ) has a minimizer @xmath364 with density @xmath365 .",
    "the regularity assumptions on @xmath366 , on @xmath367 and on the functions @xmath345 allow to state that the minimizer @xmath368 is in @xmath369^{\\mathcal n}$ ] , and even in @xmath370^{\\mathcal n}$ ] for any @xmath121 , if at least one of the following conditions is satisfied : @xmath371}([0,+\\infty))$ ] or @xmath372 in @xmath0 .",
    "the former condition is not satisfied for usual lda exchange - correlation functionals . on the other hand",
    ", it is satisfied for the hartree ( also called reduced hartree - fock ) model , for which @xmath373 .",
    "the latter condition seems to be satisfied in practice , but we were not able to establish it rigourously .",
    "let us introduce the kohn - sham hamiltonian    @xmath374    where @xmath375 and @xmath376    we notice that @xmath377 in @xmath378 and thus the euler equations associated with the minimization problem ( [ eq : min_ks ] ) read @xmath379 where the @xmath380 matrix @xmath381 , which is the lagrange multiplier of the matrix constraint @xmath382 , is symmetric .    in fact , ( [ eq : min_ks ] ) has an infinity of minimizers since any unitary transform of the kohn - sham orbitals @xmath368 is also a minimizer of the kohn - sham energy .",
    "this is a consequence of the following invariance property : @xmath383 where @xmath384 is the group of the real unitary matrices : @xmath385 @xmath386 denoting the identity matrix of rank @xmath104 .",
    "this invariance can be exploited to diagonalize the matrix of the lagrange multipliers of the orthonormality constraints ( see e.g. @xcite ) , yielding the existence of a minimizer ( still denoted by  @xmath368 ) with same density @xmath143 , such that @xmath387 for some @xmath388 .",
    "the kohn - sham hamiltonian @xmath389 is an unbounded self - adjoint operator on @xmath210 , bounded below , with compact resolvent .",
    "its spectrum therefore is purely discrete .",
    "more precisely , it is composed of a increasing sequence of eigenvalues going to infinity , each of these eigenvalues being of finite multiplicity .",
    "it is not known whether @xmath390 , ... , @xmath391 are the lowest eigenvalues ( counted with their multiplicities ) of @xmath389 ( _ aufbau _ principle ) .",
    "however , it seems to be most often ( though not always ) the case in practice . on the other hand ,",
    "the _ aufbau _ principle is always satisfied for the _ extended _ kohn - sham model , for which the first order optimality conditions read @xmath392 where @xmath393 is the fermi level ( see  @xcite for details ) . in this article , we focus on the standard kohn - sham model with integer occupation numbers .",
    "we do not need to assume that the aufbau principle is satisfied , but our analysis requires some coercivity assumption on the second order condition at @xmath368 ( see ( [ eq : coerc ] ) ) .",
    "for each @xmath394 , we denote by @xmath395 the tangent space to @xmath396 at @xmath335 , and by @xmath397 let us recall ( see e.g. lemma 4 in @xcite ) that @xmath398 where @xmath399 is the space of the @xmath380 antisymmetric real matrices .",
    "since the problem we are considering is a minimization problem , the second order condition further states @xmath400 where @xmath401    it follows from the invariance property ( [ eq : invariance_property ] ) that @xmath402 this leads us , as in @xcite , to make the assumption that @xmath403 is positive definite on @xmath404 , so that , as in proposition  1 in @xcite , @xmath403 is coercive on @xmath404 ( for the @xmath242 norm ) .",
    "thus , in all what follows , we assume that there exists a positive constant @xmath405 such that @xmath406 in the linear framework ( @xmath407 and @xmath408 in ( [ eq : energy_ks ] ) ) , this condition amounts to assuming that there is a gap between the lowest @xmath409 and @xmath410 eigenvalues of the linear self - adjoint operator @xmath411 .",
    "the planewave approximation of ( [ eq : min_ks ] ) reads @xmath412 where @xmath413 here @xmath78 is a given positive integer , equal to @xmath414 $ ] , @xmath415 denoting the so - called cut - off energy , and @xmath60 is the number of integration points per direction used to evaluate the exchange - correlation contribution . the energy @xmath416 is defined for each @xmath417 . for @xmath418 , @xmath419 , so that on this set , @xmath420 differs from @xmath421 only by the presence of the fourier interpolation operator @xmath53 in the exchange - correlation functional .",
    "let us mention that in practice , the terms involving the local and nonlocal components of the pseudopotential are also computed by some interpolation procedure .",
    "however , these terms are calculated using spherical harmonics and a very fine one dimensional radial grid , so that the resulting integration error is usually much smaller than the interpolation error on the exchange - correlation term .",
    "note that , in addition , the pseudopotential gives rise to linear contributions that can be computed very accurately once and for all ( and not at each iteration of the self - consistent algorithm ) .",
    "we postpone the analysis of ( [ eq : min_ks_pw ] ) to a forthcoming article  @xcite , and focus here on the variational approximation @xmath422 of ( [ eq : min_ks ] ) .",
    "the unitary invariance of the kohn - sham model must be taken into account in the derivation of optimal _ a priori _ error estimates .",
    "one way to take this invariance into account is to work with density matrices ( see e.g. @xcite ) .",
    "an alternative is to define for each @xmath417 the set @xmath423 and to use the fact that all the local minimizers of ( [ eq : min_ks_nc ] ) are obtained by unitary transforms from the local minimizers of @xmath424    the main result of this section is the following .",
    "[ th : ks - lda ] assume that ( [ eq : decay_v_local])-([eq : rhoc ] ) hold . let @xmath368 be a local minimizer of ( [ eq : min_ks ] ) satisfying ( [ eq : coerc ] )",
    ". then there exists @xmath425 and @xmath426 such that for @xmath427 , ( [ eq : min_ks_nc_u ] ) has a unique local minimizer @xmath428 in the set @xmath429 if we assume either that @xmath371}([0,+\\infty))$ ] or that @xmath372 on @xmath1 , then we have the following estimates : @xmath430 for all @xmath431 and @xmath121 , and for some constants @xmath182 , @xmath183 , @xmath184 and @xmath432 , where the @xmath433 s are the eigenvalues of the symmetric matrix @xmath434 , the lagrange multiplier of the matrix constraint @xmath435 .      for @xmath436 and @xmath437 ,",
    "we denote by @xmath438 the @xmath380 matrix with entries @xmath439_{ij } = \\int_\\gamma \\psi_i\\phi_j.\\ ] ] the following lemma is useful for the analysis of ( [ eq : min_ks_nc_u ] ) .",
    "we recall that if @xmath440 and @xmath441 are symmetric @xmath442 real matrices , the notation @xmath443 means that @xmath444 for all @xmath445 .",
    "[ lem : unitary_invariance ] @xmath446    1 .",
    "let @xmath417 and @xmath447 .",
    "if @xmath448 is invertible , then @xmath449 is the unique minimizer to the problem @xmath450 . .",
    "2 .   let @xmath417 .",
    "then @xmath451 where @xmath386 denotes the identity matrix of rank @xmath104 .",
    "3 .   let @xmath394 . if @xmath452 is such that @xmath453 then the unique minimizer of the problem @xmath454 is @xmath455 in addition , @xmath456 , @xmath457 and for all @xmath78 large enough , @xmath458 4 .",
    "let @xmath78 such that @xmath459 and @xmath460 . then @xmath461    in order to simplify the notation , we set @xmath462 . for each @xmath463 ,",
    "@xmath464 any critical point @xmath465 of the problem @xmath466 satisfies an euler equation of the form @xmath467 for some symmetric matrix  @xmath468 . besides , @xmath469 and @xmath470 .",
    "any maximizer @xmath465 of ( [ eq : minuuu ] ) therefore satisfies @xmath471 .",
    "consequently , if @xmath472 is invertible , the maximizer of ( [ eq : minuuu ] ) is unique and reads @xmath473 .",
    "it also follows from the definition of the matrix @xmath472 that @xmath474 with @xmath475 .",
    "thus , @xmath476 with @xmath477 .",
    "let us now prove the second statement .",
    "each @xmath478 can be written as @xmath474 for some matrix @xmath479 and some @xmath480 .",
    "a simple calculation leads to @xmath481_{ij } + [ m_{w , w}]_{ij}.\\ ] ] hence @xmath482 if and only if @xmath483 .",
    "in addition , @xmath484 if and only if @xmath485 and @xmath486 , that is to say if and only if @xmath472 is symmetric , @xmath487 and @xmath488 .",
    "let @xmath489 be an orthonormal basis of @xmath23 ( for the @xmath257 inner product ) and let @xmath490 be the matrix with entries @xmath491 note that @xmath492 for all @xmath493 , each @xmath494 can be expanded as @xmath495 where the matrix @xmath496   \\in \\r^{{\\rm dim}(v_{n_c } ) }     \\times { \\mathcal n}$ ] satisfies the constraint @xmath497 .",
    "the expansions ( [ eq : dec_phi ] ) and ( [ eq : dec_phi_2 ] ) can be recast into the more compact forms @xmath498 where we have denoted by @xmath499 .",
    "a simple calculation then leads to @xmath500 reasoning as above , we obtain that the unique solution to the problem @xmath501 is @xmath502 .",
    "note that the rank of the matrix @xmath503 is @xmath104 provided that @xmath504 is large enough so that the matrix @xmath505 is invertible provided that @xmath506 is large enough . as a consequence , the unique solution to the problem @xmath507 is @xmath508 .",
    "it is then easy to check that @xmath509 .",
    "hence ( [ eq:2k1100 ] ) .",
    "then , for all @xmath510 such that @xmath511 , @xmath512 and the same argument as above leads to the result that this quantity is minimized for @xmath513",
    ". therefore , @xmath514 .",
    "we also infer from ( [ eq:2k10 ] ) that @xmath515 besides , an easy calculation leads to @xmath516 using the fact that @xmath517 we obtain @xmath518 hence ( [ eq:2k11 ] ) .",
    "we also have @xmath519 where @xmath520 denotes the frobenius norm .",
    "we then notice that @xmath521 consequently , for @xmath78 large enough , @xmath522 therefore ( [ eq:2k1101 ] ) is proved .",
    "lastly , the fourth assertion easily follows from the second one .",
    "[ lem : properties_of_s ] let @xmath523 and @xmath524 ( the space of the symmetric @xmath380 real matrices ) defined by @xmath525 the function @xmath526 is continuous on @xmath527 and differentiable on the interior @xmath528 of @xmath527 .",
    "in addition , @xmath529 and for all @xmath530 such that @xmath531 and @xmath532 , @xmath533    diagonalizing @xmath534 and using the properties of the function @xmath535 , we see that @xmath526 is continuous on @xmath527 and differentiable on @xmath536 , and that @xmath537 hence ( [ eq : bound_sww ] ) . as @xmath538",
    "we have for all @xmath539 , @xmath540 \\\\ \\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! & & \\qquad =   -\\frac 12 \\left [ m_{w , z}+m_{z , w } \\right ] .",
    "\\end{aligned}\\ ] ] denoting by @xmath541 , we deduce from the above equality that @xmath542 as @xmath543 , we finally obtain the inequality @xmath544 which straightforwardly leads to ( [ eq : lip_s ] ) under the conditions @xmath545 and @xmath546 .",
    "lastly , @xmath547 \\\\ \\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! & & \\qquad + \\frac 12 \\left [ ( { \\mathcal s}'(w_1)\\cdot z ) ( { \\mathcal s}(w_2)-{\\mathcal s}(w_1 ) ) +    ( { \\mathcal s}(w_2)-{\\mathcal s}(w_1 ) ) ( { \\mathcal s}'(w_1)\\cdot z ) \\right ] =   -\\frac 12 \\left [ m_{w_2-w_1,z}+m_{z , w_2-w_1 } \\right ] , \\end{aligned}\\ ] ] so that still under the conditions @xmath545 and @xmath546 , @xmath548 hence ( [ eq : deriv_s ] ) .",
    "lastly , taking @xmath549 in ( [ eq : deriv_s ] ) and letting @xmath550 go to zero , we obtain ( [ eq : deriv2_s ] ) .    [ lem : coercdisc ] let @xmath368 be a local minimizer of ( [ eq : min_ks ] ) satisfying ( [ eq : coerc ] )",
    ". then @xmath403 defines a continuous bilinear form on @xmath551 , and there exists @xmath552 such that for all @xmath553 , @xmath554 @xmath555 @xmath556^{\\perp\\!\\!\\!\\perp } ,   \\quad a_{\\phi^0}(w , w ) \\ge \\frac{c_{\\phi^0}}{2 } \\|w\\|^2_{h^1_\\#}.\\ ] ]    in the sequel , we denote by @xmath557 the continuity constant of @xmath403 , i.e. @xmath558    estimate ( [ eq : pprojec ] ) immediately results from the closeness of @xmath559 to @xmath368 . using the fact that @xmath560 ( see lemma [ lem : unitary_invariance ] , point 3 ) , we get @xmath561 with @xmath562^{\\perp\\!\\!\\!\\perp}$ ] , from which we derive , using ( [ eq : bound_sww ] ) , that @xmath563 as by ( [ eq:2k11 ] ) , @xmath564 goes to zero when @xmath78 goes to infinity , so does @xmath565 . using again ( [ eq : bound_sww ] ) , we deduce from ( [ eq : decomp000 ] ) that @xmath566 .",
    "hence ( [ eq : elip ] ) .    finally , for each @xmath567^{\\perp\\!\\!\\!\\perp}$ ] , @xmath568 belongs to @xmath569^{\\perp\\!\\!\\!\\perp}$ ] . remarking that @xmath570",
    ", we derive @xmath571 where @xmath572 when @xmath78 goes to infinity .",
    "therefore , @xmath573 as @xmath574 we obtain @xmath575 hence ( [ eq : coercdisc3 ] ) for @xmath78 large enough .",
    "[ lem : estimr ] there exists @xmath432 such that    1 .   for all @xmath576 ,",
    "@xmath577 2 .",
    "for all @xmath578 and @xmath579 , @xmath580    let us denote by @xmath581 splitting @xmath582 in its coulomb and exchange - correlation contributions , we obtain @xmath583 with @xmath584 and @xmath585 where @xmath586.\\end{aligned}\\ ] ] using ( [ eq : estim_d3 ] ) , we obtain that there exists a constant @xmath587 , such that for all @xmath576 , @xmath588    using ( [ eq : hyp_epsilon_xc_2 ] ) , we get @xmath589,\\end{aligned}\\ ] ] from which we infer @xmath590 introducing the function @xmath591 we can rewrite @xmath592 as @xmath593 \\\\ & = &   16 \\int_\\gamma \\int_0 ^ 1   \\bigg [   \\frac{d^2e_{\\rm xc}^{\\rm lda}}{d\\rho^2 } ( \\rho_{\\rm c}+ \\rho_{\\phi(t ) } ) \\left ( \\sum_{i=1}^{\\mathcal n}\\phi_{i}(t ) \\upsilon_{2,i } \\right )   \\left ( \\sum_{i=1}^{\\mathcal n}\\upsilon_{1,i } \\upsilon_{3,i } \\right ) \\\\ & & \\qquad \\qquad + \\frac{d^2e_{\\rm xc}^{\\rm lda}}{d\\rho^2 } ( \\rho_{\\rm c}+ \\rho_{\\phi(t ) } )   \\left ( \\sum_{i=1}^{\\mathcal n}\\upsilon_{1,i } \\upsilon_{2,i } \\right ) \\left ( \\sum_{i=1}^{\\mathcal n}\\phi_{i}(t ) \\upsilon_{3,i } \\right )   \\\\ & & \\qquad \\qquad   + 2 \\frac{d^3e_{\\rm xc}^{\\rm lda}}{d\\rho^3 } ( \\rho_{\\rm c}+ \\rho_{\\phi(t)})\\left ( \\sum_{i=1}^{\\mathcal n}\\phi_i(t ) \\upsilon_{1,i } \\right )    \\left ( \\sum_{i=1}^{\\mathcal n}\\phi_i(t ) \\upsilon_{2,i } \\right )   \\left ( \\sum_{i=1}^{\\mathcal n}\\phi_i(t ) \\upsilon_{3,i } \\right )   \\bigg ] \\ , dt.\\end{aligned}\\ ] ] thus , using again ( [ eq : hyp_epsilon_xc_2 ] ) , we obtain @xmath594 now , @xmath595 therefore , @xmath596 gathering ( [ eq : estim_rc ] ) , ( [ eq : estim_rxc1 ] ) and ( [ eq : estim_rxc2 ] ) , we obtain the desired estimates .    [",
    "lem : estim_2 ] let @xmath368 be a local minimizer of ( [ eq : min_ks ] ) satisfying ( [ eq : coerc ] )",
    ". then there exists @xmath432 such that for all @xmath597 , @xmath598 with @xmath599    using the fact that the first order optimality condition ( [ supeq64 ] ) also reads @xmath600_i = 4{\\cal h}^{\\rm ks}_{\\rho^0}\\phi_i^0 = 4\\epsilon_i^0\\phi_i^0 $ ] in @xmath116 , we have for all @xmath601 , @xmath602 where @xmath603 the estimate ( [ eq : coercdisc_2 ] ) then straightforwardly follows from lemma  [ lem : estimr ] .      in this subsection , we derive , for @xmath78 large enough , the existence of a unique local minimum of the discretized problem ( [ eq : min_ks_nc_u ] ) in the neighborhood of @xmath604 .    let @xmath605^{\\perp\\!\\!\\!\\perp } \\ ; | \\ ; 0 \\le m_{w^{n_c},w^{n_c } } \\le 1 \\right\\},\\ ] ] and @xmath606 be the energy functional defined on @xmath607 by @xmath608 according to the fourth assertion of lemma  [ lem : unitary_invariance ] , the application @xmath609 defines a global map of @xmath610 such that @xmath611 .",
    "therefore the minimizers of @xmath612 are in one - to - one correspondence with those of the minimization problem @xmath613 in a first stage , we prove that for @xmath78 large enough , ( [ eq : min_ce ] ) has a unique solution in some neighborhood of @xmath215 . as a consequence ( [ eq : min_ks_pi ] ) has a unique solution in the vicinity of @xmath614 ( for @xmath78 large enough ) . in a second stage , we make use of the unitary invariance ( [ eq : invariance_property ] ) to prove that for @xmath78 large enough , ( [ eq : min_ks_nc_u ] ) has a unique solution in the vicinity of @xmath368 .",
    "[ lem : eu_ce ] there exists @xmath615 and @xmath426 such that for all @xmath427 , the functional @xmath606 has a unique critical point @xmath616 in the ball @xmath617^{\\perp\\!\\!\\!\\perp } \\ ; | \\ ; \\|w^{n_c}\\|_{h^1_\\ # } \\le r \\right\\}.\\ ] ] besides , @xmath616 is a local minimizer of ( [ eq : min_ce ] ) and we have the estimate @xmath618    we infer from lemma  [ lem : estim_2 ] that @xmath619 where @xmath620 thus , @xmath621 it follows from lemma  [ lem : estim_2 ] , ( [ eq : bound_sww ] ) and the continuity of @xmath403 on @xmath622 that @xmath623 for a constant @xmath624 independent of @xmath78 .",
    "let us introduce for @xmath625 and @xmath615 the ball @xmath626^{\\perp\\!\\!\\!\\perp } \\ ; | \\ ;   a_{\\phi^0}(w^{n_c},w^{n_c } ) <   r^2    a_{\\phi^0 } ( \\pi^{\\cal m}_{n_c}\\phi^0- \\phi^0 , \\pi^{\\cal m}_{n_c}\\phi^0-   \\phi^0 ) \\right\\}.\\ ] ] we deduce from lemma  [ lem : coercdisc ] , that for all @xmath615 and all @xmath627 , we have @xmath628 let @xmath629 . for all @xmath630 ,",
    "there exists @xmath631 such that @xmath632 therefore , for all @xmath630 and all @xmath633 we have @xmath634 and @xmath635 as @xmath636 goes to zero when @xmath78 goes to infinity , we finally obtain that for all @xmath630 , there exists some @xmath637 such that for all @xmath638 , @xmath639 this proves that for each @xmath640 , @xmath606 has a minimizer @xmath616 in the ball @xmath641 . in particular",
    ", @xmath642 let @xmath643 be a critical point of @xmath606 such that @xmath644 .",
    "we denote by @xmath645 , @xmath646 as both @xmath616 and @xmath643 are critical points of @xmath606 , we have @xmath647 so that @xmath648 using the expression ( [ eq : a3 ] ) for @xmath606 , we can rewrite this equality as @xmath649 where @xmath650 and @xmath651 . \\end{aligned}\\ ] ] using lemma  [ lem : properties_of_s ] and ( [ eq : majorationw0 ] ) , we obtain that there exists @xmath652 ( depending only on @xmath368 ) and @xmath653 such that for all @xmath654 , @xmath655 on the other hand , remarking that for all @xmath447 and all @xmath656 , @xmath657 and introducing the path @xmath658}$ ] , drawn on the manifold @xmath396 and connecting @xmath659 and @xmath660 , defined as @xmath661 we obtain @xmath662   \\\\ & & - a_{\\phi^0}(\\psi(0)-\\phi^0,\\psi'(0 ) ) + a_{\\phi^0}(\\psi(1)-\\phi^0,\\psi'(1 ) ) \\\\   & = & - \\int_0 ^ 1 \\bigg [ \\frac 14   { e^{\\rm ks}}''(\\psi(t))(\\psi'(t),\\psi'(t ) )   + \\frac 14 { e^{\\rm ks}}'(\\psi(t ) ) \\cdot \\psi''(t )   \\\\ & & \\qquad\\quad - a_{\\phi^0}(\\psi'(t),\\psi'(t))- a_{\\phi^0}(\\psi(t)-\\phi^0,\\psi''(t ) ) \\bigg ] \\ ; dt .",
    "\\end{aligned}\\ ] ] as @xmath663 for all @xmath664 $ ] , we have for all @xmath665 and all @xmath664 $ ] , @xmath666 so that @xmath667 consequently , @xmath668 \\ ; dt.\\end{aligned}\\ ] ] using lemma  [ lem : estimr ] , we obtain @xmath669 \\ ; dt.\\end{aligned}\\ ] ] as @xmath670 we obtain that there exists some constant @xmath75 such that for @xmath78 large enough , @xmath671 thus , @xmath672 this proves that there exists a constant @xmath615 such that for all @xmath78 large enough , @xmath673 implies @xmath674 . hence the result .",
    "as the mapping @xmath675 defines a local map of @xmath610 in the neighborhood of @xmath614 , we obtain that @xmath676 is the unique local minimizer of @xmath677 in the vicinity of @xmath614 . besides , @xmath678 for a constant @xmath189 independent of @xmath78 .",
    "we then have @xmath679 let @xmath680 , where @xmath681 .",
    "then for each @xmath640 , @xmath428 is the unique local minimizer of  ( [ eq : min_ks_nc_u ] ) in the set @xmath682 for some constant @xmath425 independent of @xmath78 , and it satisfies @xmath683 for some @xmath75 independent of @xmath78 .",
    "as @xmath684 , we can decompose @xmath428 as @xmath685 where @xmath686 and @xmath687 ( note that @xmath688 in general ) . as @xmath689 and @xmath690 goes to zero when @xmath78 goes to infinity , we have , for @xmath78 large enough ,",
    "@xmath691 the discrete solution @xmath428 satisfies the euler equations @xmath692_{ij } ( \\phi_{j , n_c}^0,\\psi_j)_{l^2_\\#},\\ ] ] where @xmath693 and where the @xmath380 matrix @xmath434 is symmetric ( but generally not diagonal ) .",
    "of course , it follows from the invariance property ( [ eq : invariance_property ] ) that ( [ eq : min_ks_nc_u ] ) has a local minimizer of the form @xmath694 with @xmath695 for which the lagrange multiplier of the orthonormality constraints is a diagonal matrix .",
    "we are now in position to derive _ a priori _ estimates for @xmath696 and @xmath697 , where we recall that @xmath698 .    using ( [ eq : app - fourier ] ) , ( [ eq : presetimh1 ] ) and the inverse inequality ( [ eq : inv_ineq ] ) , we obtain for each @xmath699 such that @xmath700 and each @xmath701 , @xmath702 in particular , for @xmath703 and @xmath704 , we obtain that @xmath705 converges to @xmath368 in @xmath706 , hence in @xmath707 .",
    "we then proceed as in ( [ eq : val_ppe ] ) and remark that @xmath708 as , from ( [ eq : decompdisc ] ) , @xmath709_{ij},\\ ] ] we easily obtain , using the convergence of @xmath705 to @xmath368 in @xmath710 , @xmath711 for @xmath712 , we introduce the adjoint problem @xmath713 the solution of whom exists and is unique by the coercivity assumption ( [ eq : coerc ] ) .",
    "clearly , @xmath714 in addition , it follows from standard elliptic regularity arguments that @xmath715 yielding @xmath716 denoting by @xmath717 and using ( [ eq : decompdisc ] ) , we get @xmath718 from the definition ( [ eq : defaks ] ) , the last term in the above expression reads @xmath719 so that from the definition of the continuous and discrete eigenvalue problems @xmath720 the definition of @xmath721 and the fact that @xmath722 yields @xmath723 which finally provides the estimate @xmath724 using lemma  [ lem : estimr ] , ( [ eq : presetimh1 ] ) , ( [ eq : estims0nc ] ) and ( [ eq : estim_psi_delta ] ) , we infer @xmath725 we thus obtain , using ( [ eq:1estimlambda ] ) and the above estimate , that asymptotically , when @xmath726 goes to infinity , @xmath727 reasoning as in ( [ eq:1estimks ] ) , we obtain that for each @xmath699 such that @xmath700 and each @xmath70 , there exists a constant @xmath189 such that @xmath728 to proceed further , we need to make an assumption on the regularity of the exchange - correlation potential . in the sequel",
    ", we assume that    * either the function @xmath729 is in @xmath730}([0,+\\infty))$ ] ; * or the function @xmath731 is positive everywhere .",
    "as it is continuous on @xmath0 , this is equivalent to assuming that there exists a constant @xmath732 such that for all @xmath733 , @xmath734 .",
    "it follows by standard elliptic regularity arguments that @xmath368 then is in @xmath735 for any @xmath121 , and we deduce from ( [ eq : estimhpos ] ) that ( [ kshs ] ) holds true for all @xmath736 .",
    "then , following the same lines as in the proof of  ( [ eq : pre_estim_lambda ] ) , we obtain the estimates @xmath737 and @xmath738 valid for all @xmath739 . using these estimates in ( [ 2k10 ] ) , we are lead to @xmath740 now , @xmath741 noticing that @xmath742 we deduce @xmath743 since @xmath705 converges , therefore is uniformly bounded in @xmath744 .",
    "thus @xmath745 the derivation of estimates for @xmath746 follows exactly the same lines as the derivation of the @xmath747 estimate : starting from the definition @xmath748 and remarking that the solution @xmath749 to the adjoint problem ( [ eq : adjoint_ks ] ) satisfies @xmath750 we proceed as in ( [ 3k11 ] ) to get @xmath751 that yields @xmath752 the proof of ( [ kshs ] ) follows and then we get easily from ( [ eq : estim_lambda ] ) that @xmath753 hence ( [ kshs ] ) . finally , ( [ kshs  ] ) is a straightforward consequence of lemma  [ lem : estim_2 ] , ( [ eq : coerc ] ) , ( [ eq : continuity_aphi0 ] ) , and ( [ eq : presetimh1 ] ) .      in order to evaluate the quality of the error bounds obtained in theorem  [ th : ks - lda ] ,",
    "we have performed numerical tests using the abinit software  @xcite ( freely available online , cf .",
    "http://www.abinit.org ) , whose main program allows one to find the total energy , charge density and electronic structure of systems ( molecules and periodic solids ) within density functional theory ( dft ) , using pseudopotentials and a planewave basis .",
    "+ we have run simulation tests with the hartree functional ( i.e. with @xmath754 ) , for which there is no numerical integration error . in this particular case ,",
    "the problems ( [ eq : min_ks_pw ] ) ( solved by abinit ) and ( [ eq : min_ks_nc ] ) ( analyzed in theorem  [ th : ks - lda ] ) are identical .    for troullier - martins pseudopotentials ,",
    "the parameter @xmath755 in theorem  [ th : ks - lda ] is equal to @xmath756 .",
    "therefore , we expect the following error bounds ( as functions of the cut - off energy @xmath757 ) @xmath758    the first tests were performed with the hydrogen molecule ( h@xmath759 ) .",
    "the nuclei were clamped at the points with cartesian coordinates @xmath760 and @xmath761 ( in bohrs ) .",
    "the simulation cell was a cube of side length @xmath762  bohrs .",
    "the so - obtained numerical errors are plotted in log - scales in figures [ figh2a ] and [ figh2b ] .",
    "the second series of tests were performed with the nitrogen molecule ( n@xmath759 ) .",
    "the nuclei were clamped at positions @xmath763 and @xmath764 ( in angstroms ) , and the simulation cell was a cube of side length @xmath765  angstroms .",
    "the numerical errors for n@xmath759 are plotted in figures  [ fign2a ] , [ fign2b ] and  [ fign2 ] .",
    "the reference values for @xmath368 , @xmath766 and @xmath767 for both h@xmath759 and n@xmath759 are those obtained for a cut - off energy equal to @xmath768  hartrees .    [ cols=\"^,^ \" , ]     these results are in good agreement with the _ a priori _ error estimates ( [ estimationresnum1])-([estimationresnum2 ] ) for both the h@xmath759 and n@xmath759 molecules",
    "this work was done while e.c .",
    "was visiting the division of applied mathematics of brown university , whose support is gratefully acknowledged .",
    "this work was also partially supported by the anr grant ln3 m .",
    "we are also grateful to v.  ehrlacher for her useful comments on a preliminary draft of this article .",
    "wang and e.a .",
    "carter , _ orbital - free kinetic energy density functional theory _ , in : _",
    "theoretical methods in condensed phase chemistry _ , volume  5 of _ progress in theoretical chemistry and physics _ , pp .",
    "117 - 184 , kluwer , 2000 ."
  ],
  "abstract_text": [
    "<S> we provide _ a priori _ error estimates for the spectral and pseudospectral fourier ( also called planewave ) discretizations of the periodic thomas - fermi - von weizscker ( tfw ) model and for the spectral discretization of the kohn - sham model , within the local density approximation ( lda ) . </S>",
    "<S> these models allow to compute approximations of the ground state energy and density of molecular systems in the condensed phase . </S>",
    "<S> the tfw model is stricly convex with respect to the electronic density , and allows for a comprehensive analysis . </S>",
    "<S> this is not the case for the kohn - sham lda model , for which the uniqueness of the ground state electronic density is not guaranteed . under a coercivity assumption on the second order optimality condition </S>",
    "<S> , we prove that for large enough energy cut - offs , the discretized kohn - sham lda problem has a minimizer in the vicinity of any kohn - sham ground state , and that this minimizer is unique up to unitary transform . </S>",
    "<S> we then derive optimal _ a priori _ error estimates for the spectral discretization method . </S>"
  ]
}