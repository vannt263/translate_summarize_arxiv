{
  "article_text": [
    "the exact helmholtz free energy @xmath0 of a system of interacting electrons in an external potential @xmath1 at a finite temperature @xmath2 satisfies the hohenberg - kohn - mermin variational theorem@xcite @xmath3 + \\int d{\\mathbf{r } } v({\\mathbf{r } } ) n({\\mathbf{r } } ) \\right ) , \\label{eqn : dft - hkm}\\ ] ] where @xmath4 is a universal functional that depends only on the electron density @xmath5 ( and temperature ) , and not on the external potential .",
    "however , constructing approximations for this unknown universal functional that accurately capture the energies and geometries of chemical bonds in terms of the density alone is extremely challenging , partly because the quantum mechanics of the electrons is completely implicit in @xmath6 $ ] ( dropping the @xmath2 labels here onward for notational simplicity ; all the functionals below depend on temperature ) .",
    "most practical approximations in electronic density - functional theory follow the kohn - sham approach@xcite that includes the exact free energy of a non - interacting system of electrons with the same density @xmath5 .",
    "the universal functional is typically split as @xmath7 = a{\\ensuremath{_{\\textrm{ni}}}}[n ]      + \\underbrace{\\int d{\\mathbf{r } } \\int d{\\mathbf{r } } ' \\frac{n({\\mathbf{r } } ) n({\\mathbf{r}}')}{2|{\\mathbf{r}}-{\\mathbf{r}}'|}}_{e_h[n ] }      + e{\\ensuremath{_{\\textrm{xc}}}}[n ] , \\label{eqn : dft - ks}\\ ] ] where @xmath8 $ ] is the non - interacting free energy ( which we describe in detail below ) , the second ` hartree ' term @xmath9 $ ] is the mean - field coulomb interaction between electrons ( using atomic units @xmath10 throughout ) , and the final ` exchange - correlation ' term @xmath11 $ ] captures the remainder which is not known and must hence be approximated .",
    "the exact free energy of non - interacting electrons is @xmath12 = \\min _ {      \\mbox{\\scriptsize$\\begin{array}{c }      \\{\\psi_i({\\mathbf{r}}),f_i\\}\\\\      \\rightarrow n({\\mathbf{r } } )      \\end{array}$ } } \\sum_i \\bigg (      \\underbrace{\\frac{f_i}{2 } \\int d{\\mathbf{r } } |\\nabla\\psi_i({\\mathbf{r}})|^2}{\\ensuremath{_{\\textrm{kinetic}}}}\\\\      - t\\underbrace{s(f_i)}{\\ensuremath{_{\\textrm{entropy } } } } \\bigg ) , \\label{eqn : dft - ni}\\ ] ] which includes the kinetic energy and entropy contributions of a set of orthonormal single - particle orbitals @xmath13 with occupation factors @xmath14 $ ] . above",
    ", the single - particle entropy function is @xmath15 .",
    "note that we let the orbital index @xmath16 include spin degrees of freedom as well , and therefore do not introduce factors of 2 for spin degeneracy .",
    "for notational convenience , we also let @xmath16 include bloch wave - vectors in the brillouin zone ( in addition to spin and band indices ) for periodic systems .",
    "the minimization in ( [ eqn : dft - ni ] ) is constrained such that the density of the non - interacting system @xmath17 the density of the real interacting system . performing this minimization with lagrange multipliers @xmath18 ( the kohn - sham potential ) to enforce the density constraint and @xmath19 ( kohn - sham eigenvalues ) to enforce orbital normalization constraints , results in a set of single - particle schrdinger - like equations @xmath20 for stationarity with respect to @xmath13 , and the fermi occupation condition @xmath21 for stationarity with respect to @xmath22 . here",
    ", the electron chemical potential @xmath23 appears as a lagrange multiplier to enforce the electron number constraint , and is chosen so that @xmath24 , the number of electrons in the system .",
    "optimizing the total free energy functional ( [ eqn : dft - hkm ] ) with @xmath6 $ ] implemented by ( [ eqn : dft - ks],[eqn : dft - ni ] ) then yields the stationarity condition with respect to electron density , @xmath25({\\mathbf{r } } ) = v({\\mathbf{r } } ) + \\frac{\\delta}{\\delta n({\\mathbf{r } } ) }      \\left ( e_h[n ] + e{\\ensuremath{_{\\textrm{xc}}}}[n ] \\right ) .",
    "\\label{eqn : v_ks}\\ ] ] conventional density - functional theory calculations then amount to self - consistently solving the kohn - sham equations ( [ eqn : schrodingerks ] ) along with ( [ eqn : v_ks ] ) , coupled via the electron density constraint ( [ eqn : densityconstraint ] ) .",
    "the kohn - sham potential is arbitrary up to an overall additive constant : changing this constant introduces a rigid shift in the eigenvalues @xmath26 and the electron chemical potential @xmath23 , but does not affect the occupations @xmath22 , electron density or free energy . for finite systems ( of any charge ) and for neutral systems that are infinitely periodic in one or two directions ,",
    "this arbitrariness can be eliminated by requiring that the potential vanishes infinitely far away from the system , giving meaning to the absolute values of @xmath23 and @xmath26 as being referenced to ` zero at infinity ' . however , for materials that are infinite in all three dimensions , such as periodic crystalline solids , there is no analogous natural choice for the zero of potential , making the absolute reference for @xmath23 and @xmath26 meaningless .    more importantly , for systems that are periodic in one , two or all three directions ,",
    "the net charge per unit cell must be zero , otherwise the energy per unit cell becomes infinite . in terms of a finite system size @xmath27 and then taking the limit @xmath28 , the energy per unit cell of a system with net charge per unit cell diverges @xmath29 for one periodic direction , @xmath30 for two periodic directions and @xmath31 for three periodic directions .",
    "therefore , the number of electrons per unit cell is physically constrained to keep the unit cell neutral in systems with _ any _ periodicity , and only finite systems ( like molecules and ions ) have number of electrons as a degree of freedom .",
    "for describing electrochemical systems and electrocatalytic mechanisms , we are typically interested in adsorbed species in a solid - electrolyte interface which exchange electrons with the solid ( electrode ) . in these systems , the solid surface , which we would describe in a density - functional calculation as a slab periodic in two directions ,",
    "does have a net charge per unit cell that depends on the electrode potential .",
    "in contrast to the discussion at the end of the previous section , this is physically possible ( i.e. has a finite energy ) because the electrolyte contains mobile ions that respond by locally increasing the concentration of ions of opposite charge near the surface , thereby neutralizing the unit cell .",
    "( the charge per unit areas of the electrode and electrolyte are equal and opposite . )",
    "next to an electrolyte , the charge of a partially - periodic system ( one - dimensional ` wires ' or two - dimensional ` slabs ' ) is no longer constrained , allowing the number of electrons to vary .",
    "now , the absolute reference for the electron chemical potential @xmath23 does become physically meaningful , and @xmath23 now corresponds to the electrode potential that controls the number of electrons in the electrode .",
    "however , treating electrochemical systems using electronic density - functional theory alone is extremely challenging for a variety of reasons .",
    "first , treating liquids requires a statistical average over a large number of atomic configurations to integrate over thermodynamic phase space . for this , techniques such as molecular dynamics typically require calculations of at least @xmath32 atomic configurations ( instead of just one for a solid ) .",
    "second , such calculations require a large number of liquid molecules to minimize finite size errors in the molecular dynamics . for example , for electrolytes with a realistic ionic concentration of 0.1  m , there is _ on average _ one ion for a few hundred solvent molecules . making statistical errors in the ion number manageable in such calculations",
    "therefore requires @xmath33 solvent molecules with @xmath34 electrons , contrasted with a typical @xmath35 atoms with @xmath36 electrons in the electrode slab + adsorbate of interest .",
    "combined , these factors make density - functional molecular dynamics simulations of electrochemical systems prohibitively expensive computationally , in additional to being difficult to set up and analyze .    a viable alternative to the above direct approach is to employ joint density - functional theory@xcite ( jdft ) , a variational theorem akin to the hohenberg - kohn theorem that makes it possible to describe the free energy of a solvated system in terms of the electron density @xmath5 for the solute and in terms of a set of nuclear densities @xmath37 ( where @xmath38 indexes nuclear species ) of the solvent ( or electrolyte ) .",
    "specifically , the equilibrium free energy of the combined solute and solvent systems minimizes @xmath39 \\\\      + \\int d{\\mathbf{r } } v({\\mathbf{r } } ) n({\\mathbf{r } } )      + \\sum_\\alpha \\int d{\\mathbf{r } } v_\\alpha({\\mathbf{r } } ) n_\\alpha({\\mathbf{r } } ) \\bigg ) , \\label{eqn : jdft - theorem}\\end{gathered}\\ ] ] where @xmath1 is the external electron potential , @xmath40 is the external potential on the liquid nuclei and @xmath41 is a universal functional independent of these external potentials .",
    "separating out the hohenberg - kohn electronic density functional @xmath42 $ ] for the solute , the total free energy is @xmath43   = \\underbrace{a{\\ensuremath{_{\\textrm{hkm}}}}[n]}{\\ensuremath{_{\\textrm{electronic } } } }   + \\underbrace{\\tilde{a}{\\ensuremath{_{\\textrm{diel}}}}[n,\\{n_\\alpha\\}]}{\\ensuremath{_{\\textrm{solvation}}}}. \\label{eqn : jdft}\\ ] ] in practice , the functional @xmath44 , much like @xmath45 , is unknown and needs to be approximated .",
    "importantly , the liquid is now described directly in terms of its average density rather than individual configurations , and the expensive quantum - mechanical theory of the electrons is restricted to the solute alone , thereby addressing both the sampling and system - size problems that make density - functional molecular dynamics prohibitively expensive .",
    "typically , we are interested in a situation where the external potentials on the liquid are zero , and the liquid only interacts with itself , and with the electrons and nuclei of the solute . in this situation , we can perform the optimization over liquid densities and define the implicit functional @xmath46 = a{\\ensuremath{_{\\textrm{hkm}}}}[n ] + a{\\ensuremath{_{\\textrm{diel}}}}[n]$ ] where we define @xmath47\\equiv \\min_{\\{n_\\alpha({\\mathbf{r}})\\ } } \\tilde{a}_x[n({\\mathbf{r } } ) , \\{n_\\alpha({\\mathbf{r}})\\}]$ ] for @xmath48 = jdft and @xmath48 = diel .",
    "we will work with these reduced functionals below for simplicity .",
    "the framework of joint density - functional theory encompasses an entire hierarchy of solvation theories .",
    "further separating the solvation term @xmath44 into a classical density functional for the liquid@xcite and an electron - liquid interaction functional , unlocks the full potential of jdft to describe atomic - scale structure in the liquid without statistical sampling . starting from ` full - jdft ' and performing perturbation theory for linear - response of the liquid results in the non - empirical salsa solvation model@xcite which continues to capture the atomic - scale nonlocality in the liquid response and introduces no fit parameters for the electric response of the solvent .    at the simplest end of the jdft hierarchy , are continuum solvation models that neglect the nonlocality of the liquid response and replace it by that of an empirically - determined dielectric cavity ( optionally with debye screening due to electrolytes ) .",
    "this includes our recent candle solvation model@xcite that builds on the stability of salsa for highly polar systems , and earlier solvation models suitable for molecules and less - polar systems such as our glssa13 model@xcite ( or its equivalent , vaspsol@xcite ) and the comparable self - consistent continuum solvation ( sccs ) model.@xcite even the traditional quantum - chemistry finite - system solvation models such as the pcm series@xcite and the smx series@xcite can be mapped on to this class of solvation models .    for simplicity",
    ", we will work here with this simplest class of continuum solvation models .",
    "the theoretical considerations and algorithms in this work focus primarily the electronic density - functional theory component , are largely agnostic to the internals of the solvation model and therefore straightforwardly generalize up the jdft hierarchy to the more detailed and complex solvation theories .",
    "essentially , all the simple electron - density - based continuum solvation models@xcite can be summarized abstractly as@xcite @xmath49 = \\int d{\\mathbf{r } } \\rho{\\ensuremath{_{\\textrm{el}}}}({\\mathbf{r } } ) \\frac{(\\hat{k}^{-1}-\\hat{\\chi})^{-1}-\\hat{k}}{2 } \\rho{\\ensuremath{_{\\textrm{el}}}}({\\mathbf{r } } ) + a{\\ensuremath{_{\\textrm{cav}}}}[s ] .",
    "\\label{eqn : adielpcm}\\ ] ] here , the first term is the electrostatic solute - solvent interaction energy given by the difference between the solvent - screened coulomb interaction and the bare coulomb interaction @xmath50 of the total solute charge density , @xmath51 , where @xmath52 is the solvent nuclear charge density . the screened coulomb interaction term above is expressed in terms of the bare coulomb interaction @xmath50 and the solvent susceptibility operator @xmath53 , defined for the local - response models by @xmath54 here , @xmath55 is the bulk dielectric constant of the solvent and @xmath56 is the inverse debye screening length in vacuum of a set of ionic species of charge @xmath57 with concentrations @xmath58 ( the net inverse debye screening length in the presence of the background dielectric is @xmath59 ) .",
    "the cavity shape function @xmath60 modulates the dielectric and ion response , and varies from zero in the solute region ( no solvent present ) to unity in the solvent at full bulk density .",
    "finally , the second term of ( [ eqn : adielpcm ] ) , @xmath61 , empirically captures effects beyond mean - field electrostatics , such as the free energy of cavity formation in the liquid and dispersion interactions between the solute and solvent.@xcite different solvation models at this level of the hierarchy only differ in the details of how @xmath60 is determined from the electron density ( or even from atomic positions and fit radii for the pcm@xcite and smx@xcite solvation models ) , and in the details of @xmath61 .    in practice , evaluating the first term of ( [ eqn : adielpcm ] ) requires the calculation of @xmath62 , which is the net electrostatic potential including screening by the solvent ( and electrolyte ) . the second part of the first term in ( [ eqn : adielpcm ] ) represents the electrostatic interactions between electrons and the nuclei in vacuum which cancels corresponding terms in the vacuum dft functional ( specifically the hartree , ewald and long - range part of the local pseudopotential terms ) , so that all long - range terms that contribute to the net free energy are present in the first term of ( [ eqn : adielpcm ] ) . finally , substituting ( [ eqn : pcmchi ] ) and @xmath63 into the definition of @xmath64 results in the linearized poisson - boltzmann ( modified helmholtz ) equation @xmath65    without ionic screening ( second term of ( [ eqn : linearpbe ] ) above )",
    ", the absolute reference for @xmath64 is undetermined and does not contribute to the bound charge charge induced in the liquid , @xmath66 ( given by the first term of ( [ eqn : pcmchi ] ) alone ) , because @xmath67 .",
    "however , with ionic screening , a constant shift of @xmath64 does affect the second terms of ( [ eqn : pcmchi ] ) and ( [ eqn : linearpbe ] ) , producing a charge response in the liquid and making the absolute reference of the electrostatic potential @xmath64 meaningful .",
    "in particular , integrating ( [ eqn : linearpbe ] ) over space yields @xmath68 from ( [ eqn : pcmchi ] ) , the left hand side is the negative of the total bound charge in the liquid , while the right hand side is the total charge of the solute system .",
    "therefore , the continuum electrolyte automatically compensates for any net charge in the solute and makes the complete system neutral . as a side effect ,",
    "the absolute reference of the electrostatic potential is meaningful and automatically corresponds to ` zero at infinity ' .",
    "this happens because the greens function of ( [ eqn : linearpbe ] ) is @xmath69 in the bulk liquid with finite @xmath70 ( instead of @xmath71 ) , causing @xmath64 to exponentially decay to zero outside the solute region ( where @xmath72 ) .",
    "ref .   gives a detailed version of the above discussion including rigorous proofs of the absoluteness of the reference for @xmath64 , and numerical details and algorithms for efficiently solving ( [ eqn : linearpbe ] ) with periodic boundary conditions in plane - wave basis dft calculations .",
    "the result that the electrolyte neutralizes charges in the solute is true more generally , even for solvation models with nonlinear@xcite and/or nonlocal response.@xcite however , as ref .",
    "describes in detail , for the general nonlinear case , unit cell neutralization is not automatic and must be imposed using a lagrange multiplier constraint ; this lagrange multiplier then fixes the absolute value of @xmath64 such that it is zero at infinity .",
    "the key conclusion of this discussion is that continuum electrolytes present two advantages .",
    "first , automatic charge neutralization implies we can perform well - defined calculations with net charge per unit cell in the solute .",
    "second , meaningful absolute reference values for potentials implies that the electron chemical potential @xmath23 ( which determines the electron occupations in ( [ eqn : fermioccupations ] ) ) is also referenced to zero at infinity .",
    "consequently , @xmath23 is related directly to the potential @xmath73 of the electrode providing the electron reservoir in experiments .",
    "this potential is typically referenced to the standard hydrogen electrode ( she ) , so that @xmath74 where @xmath75 is the absolute position of the standard hydrogen electrode relative to the vacuum level ( i.e. the zero at infinity reference ) .",
    "calculations can employ either the experimental estimate @xmath76  ev to relate the absolute and relative potential scales,@xcite or a theoretical calibration based on the calculated and measured potentials of zero charge of solvated metal surfaces.@xcite the latter approach has the advantage of minimizing systematic errors in the solvation model since they cancel between the calculations used for calibration and prediction .",
    "for example , with the candle solvation model we use below , the calibrated @xmath77  ev.@xcite      using joint density - functional theory of continuum solvation models to treat electrolytes as described above , we can calculate the helmholtz free energy and electrochemical potential ( @xmath23 , and hence @xmath73 ) of specific microscopic configurations of adsorbates on electrode surfaces at a fixed number of electrons @xmath78 in the solute subsystem ( electrode + adsorbates ) .",
    "however , in electrochemical systems , @xmath78 is an artificial constraint because electrons can freely exchange between the electrode and an external circuit .",
    "instead , experiments set the electrode potential @xmath73 , and hence the electron chemical potential @xmath23 , and @xmath78 adjusts accordingly as a dependent variable .",
    "thermodynamically , this corresponds to switching the electrons from the finite - temperature , fixed - number canonical ensemble to the finite - temperature , fixed - potential grand - canonical ensemble .",
    "correspondingly , the relevant free energy minimized at equilibrium is the grand free energy @xmath79 , instead of the helmholtz free energy @xmath0 .",
    "the most straightforward approach to fixed - potential dft for electrochemistry is to repeat conventional fixed - charge dft calculations at various electron numbers @xmath78 to reach a target chemical potential @xmath23 . using a steepest descent / secant method to optimize @xmath78 results in convergence of @xmath23",
    "typically within 10 iterations.@xcite however this approach is inefficient since it requires multiple dft calculations to calculate the grand free energy and charge of a single configuration , typically taking 3x the time of a single fixed - charge calculation ( not 10x because subsequent calculations have a better starting point and converge quicker).@xcite    a more efficient approach would be to directly optimize the kohn - sham functional in the grand - canonical ensemble . for a solvated system",
    ", this corresponds to a small modification of the minimization problem ( [ eqn : jdft - theorem ] ) with @xmath41 given by ( [ eqn : jdft ] ) and with @xmath45 evaluated using the kohn - sham approach ( [ eqn : dft - ks],[eqn : dft - ni ] ) .",
    "the only differences are that the lagrange multiplier term @xmath80 that enforced the electron number constraint is replaced by @xmath81 which implements the legendre transform of the helmholtz free energy to the grand free energy , and that the fixed-@xmath78 constraint is removed .",
    "the electron occupation factors are still fermi functions ( [ eqn : fermioccupations ] ) , but @xmath23 is specified as an input ( instead of being adjusted to match a specified @xmath78 ) .",
    "operationally , this amounts again to solving the kohn - sham eigenvalue problem ( [ eqn : schrodingerks ] ) self - consistently with @xmath25({\\mathbf{r } } ) = v({\\mathbf{r } } ) + \\frac{\\delta}{\\delta n({\\mathbf{r } } ) }      \\left ( e_h[n ] + e{\\ensuremath{_{\\textrm{xc}}}}[n ] + a{\\ensuremath{_{\\textrm{diel}}}}[n]\\right ) , \\label{eqn : v_ks_sol}\\ ] ] where there is now a single extra contribution to the potential due to the solvent ( electrolyte ) , and with the aforementioned changes to the lagrange multipliers and constraints .",
    "this conceptually simple modification , however , presents numerical challenges to the algorithms commonly used for solving the kohn - sham problem , such as the self - consistent field ( scf ) method , which solves the kohn - sham eigenvalue problem from an input density ( or kohn - sham potential ) , adjusting this density ( or potential ) iteratively until self - consistency is achieved .",
    "a common instability for metallic systems in the scf method is ` charge sloshing ' : the electron density oscillates spatially between iterations instead of converging .",
    "switching to the grand - canonical ensemble can significantly exacerbate this problem : electrons can now additionally slosh between the system and the electron reservoir . here , we present modifications to the scf method and an alternate algorithm that allow reliable and efficient convergence for _ grand - canonical _ kohn - sham dft .",
    "given electron density @xmath82 , the kohn - sham equations ( [ eqn : schrodingerks ] ) with potential @xmath83 given by ( [ eqn : v_ks_sol ] ) define orbitals @xmath84 and eigenvalues @xmath85 .",
    "at a given electron chemical potential @xmath23 , these in turn define the occupations @xmath86 given by ( [ eqn : fermioccupations ] ) and a new electron density @xmath87 given by ( [ eqn : densityconstraint ] ) .",
    "the self - consistent field ( scf ) method attempts to find @xmath88 such that @xmath89 .",
    "there are two algorithmic ingredients to this method : solution of the kohn - sham eigenvalue equations and optimization of the electron density .",
    "the eigenvalue equations remain unchanged between conventional and fixed - potential calculations .",
    "to solve , these we use the standard davidson algorithm.@xcite the difficulty in fixed - potential calculations arise in the electron density optimization , which we discuss below .    a robust and frequently - used algorithm for charge - density optimization is pulay mixing@xcite with kerker preconditioning.@xcite briefly , pulay mixing assumes that the residual @xmath90 \\equiv n{\\ensuremath{_{\\textrm{out}}}}({\\mathbf{r } } ) - n{\\ensuremath{_{\\textrm{in}}}}({\\mathbf{r}})$ ] is approximately linear in the input electron density @xmath91 , and calculates the optimum input electron density as a linear combination of previous iterations , @xmath92 minimization of the norm of the corresponding residual @xmath93 \\hat{m } r[n^{(j)}{\\ensuremath{_{\\textrm{in}}}}({\\mathbf{r}})]\\ ] ] with the constraint @xmath94 yields a set of linear equations determining the coefficients @xmath95 , where @xmath96 is the metric for defining the norm of the residual .",
    "finally , the next input density is obtained by mixing the optimum input density with its corresponding output density @xmath97,\\ ] ] where @xmath50 is the kerker preconditioning operator .",
    "the metric @xmath96 and preconditioner @xmath50 serve to balance the influence of different components of the electron density to the optimization procedure .",
    "these are usually defined in reciprocal space , expanding @xmath98 , where @xmath99 are reciprocal lattice vectors .",
    "in reciprocal space , the hartree potential in ( [ eqn : v_ks_sol ] ) takes the form @xmath100 , causing small @xmath101 ( long - wavelength ) variations of the electron density to produce larger changes in the kohn - sham potential than large @xmath101 ones .",
    "uncompensated , this makes the electron density optimization unstable against long - wavelength perturbations ( the charge - sloshing instability ) .",
    "the kerker preconditioner @xmath102 mitigates this problem by suppressing the contribution of the problematic small @xmath101 components in determining the next input density .",
    "the metric @xmath103 enhances the contribution of small @xmath101 components in the residual norm , thereby prioritizing the optimization of these components when determining @xmath104 .",
    "the wavevectors @xmath105 and @xmath106 , which control the balance between short and long - wavelength components , and the prefactor @xmath0 , which sets the maximum fraction of @xmath107 that contributes to the next @xmath108 , can be adjusted to optimize the convergence of the scf method .",
    "see ref .   for a detailed discussion of the pulay - kerker scf approach and its performance for conventional fixed electron number ( canonical ) dft calculations .    the @xmath109 component of the electron density , which equals @xmath110 , where @xmath111 is the unit cell volume , remains fixed in canonical dft calculations and is therefore excluded from the metric and the preconditioner .",
    "this is no longer true in fixed - potential dft , where the number of electrons changes . with the above prescriptions , the kerker preconditioner ( [ eqn : kerker ] ) @xmath112 as @xmath113 which will prevent the electron number from changing between scf iterations .",
    "likewise , the @xmath113 divergence of the pulay metric ( [ eqn : metric ] ) cause the residual norm to become undefined when the electron number changes between iterations .    in order to generalize the pulay - kerker scf approach for fixed - potential dft",
    ", we therefore need to fix the @xmath113 behavior of both the preconditioner and the metric .",
    "the need for the preconditioner and the metric arose from the reciprocal space coulomb operator @xmath114 in the hartree potential . in a uniform electrolyte with debye screening , the reciprocal space coulomb operator instead takes the form @xmath115 ( from ( [ eqn : linearpbe ] ) in reciprocal space with @xmath116 ) . since the electrolyte is responsible for fixing the indeterminacy of the @xmath109 component of the potential , a reasonable _ ansatz _ for extending pulay - kerker to fixed potential calculations is replacing @xmath117 with @xmath118 , where @xmath119 in section  [ sec : resultsscf ] below , we show that setting @xmath120 and @xmath121 indeed makes the grand canonical self - consistent field ( gc - scf ) method function efficiently , with optimum convergence for @xmath122 given by ( [ eqn : qkappaopt ] ) .",
    "an alternate approach to solving the kohn - sham equations is to directly minimize the total ( free-)energy functional ( [ eqn : dft - hkm ] ) , with @xmath45 given by ( [ eqn : dft - ks],[eqn : dft - ni ] ) , in terms of the kohn - sham orbitals as independent variables .",
    "for joint density - functional theory , this amounts to @xmath123 + e{\\ensuremath{_{\\textrm{xc}}}}[n ] + a{\\ensuremath{_{\\textrm{diel}}}}[n ]      + \\int d{\\mathbf{r } } v({\\mathbf{r } } ) n({\\mathbf{r } } ) \\right ] , \\label{eqn : jdft - direct}\\end{gathered}\\ ] ] where @xmath5 is now derived from @xmath124 and @xmath125 as given by ( [ eqn : densityconstraint ] ) . in the above minimization",
    ", the orbitals @xmath124 must be orthonormal , the occupation factors must satisfy @xmath126 , and optionally , @xmath127 for the canonical fixed electron number case .    for insulators at @xmath128 , the occupations @xmath22 are known in advance .",
    "the constrained optimization over orthonormal @xmath124 is most efficiently carried out using a preconditioned conjugate - gradients ( cg ) algorithm on unconstrained orbitals using the analytically - continued energy functional approach.@xcite briefly , this approach evaluates the energy functional ( [ eqn : jdft - direct ] ) on a set of orthonormal orbitals , which are a functional of the unconstrained orbitals used for minimization .",
    "( see ref .   for further details . )",
    "the general case of metallic systems and/or finite @xmath2 additionally requires the optimization of @xmath125 , which is challenging for non - linear optimization algorithms because of the inequality constraints @xmath126 .",
    "one possibility is to update the fillings from the kohn - sham eigenvalues using ( [ eqn : fermioccupations ] ) after every few steps of the cg algorithm,@xcite but this hinders the convergence of cg because the functional effectively changes each time the fillings are altered .",
    "the ` ensemble dft ' approach@xcite rectifies this convergence issue by optimizing the occupation factors at fixed orbitals in an inner loop , and performing the optimization of orbitals in an outer loop using the cg method , but this increases the computational cost compared to the case of the insulators .",
    "the scf approach is typically much more computational efficient than these variants of the direct variational minimization algorithm with variable occupations.@xcite    an alternate strategy for direct variational minimization with variable occupations is to introduce an auxiliary subspace hamiltonian matrix @xmath129 as an independent variable,@xcite and setting the occupations @xmath130 in terms of the eigenvalues @xmath131 of @xmath129 instead of the kohn - sham eigenvalues @xmath132 .",
    "( here , @xmath133 is the fermi function given by ( [ eqn : fermioccupations ] ) , and the electron chemical potential @xmath23 is chosen so as to satisfy the electron number constraint @xmath134 . )",
    "this eliminates the problematic inequality constraints on the occupations , and upon minimization , the auxiliary subspace hamiltonian @xmath135 approaches the true subspace hamiltonian , @xmath136 , where @xmath137 is the kohn - sham hamiltonian . by choosing the undetermined unitary rotations of the orbitals @xmath124 to diagonalize @xmath129 , ref .",
    "further shows that the gradient of the free energy with respect to the independent variables simplifies to @xmath138 and @xmath139 these gradients are used to perform line minimization along a search direction in the space of independent variables . with every update of the independent variables ,",
    "the orbitals are re - orthonormalized and the unitary rotations of the orbitals are updated to keep the auxiliary hamiltonian diagonal .    in the preconditioned cg algorithm ,",
    "the next search direction is obtained as a linear combination of the current search direction and the preconditioned gradients given by @xmath140 and @xmath141 where @xmath142 and @xmath143 are preconditioners .",
    "the role of preconditioning is to balance the weight of different directions in the minimization space in the explored search directions , and ideally the preconditioner equals the inverse of the hessian ( which is difficult to compute exactly ) . for the orbital directions ,",
    "the standard preconditioner @xmath142 resembles the inverse of the dominant kinetic energy operator in the kohn - sham hamiltonian.@xcite for the auxiliary hamiltonian direction , the preconditioner removes the fermi function derivatives and finite difference factors from ( [ eqn : hauxgradient ] ) in order to more equitably weight all components of @xmath129 .",
    "the preconditioning factor @xmath143 controls the overall contribution of the @xmath129 components relative to that of the orbital components , and is adjusted to achieve optimum convergence .    in this auxiliary hamiltonian ( auxh )",
    "approach , the orbitals and occupations are continuously and simultaneously optimized to minimize the total free energy , resulting in better convergence and computational efficiency comparable to the fixed - occupations insulator case , and competitive with the scf method even for metallic systems .",
    "see ref .   for further details on the algorithms and performance comparisons for conventional fixed electron number calculations .",
    "now , for fixed potential calculations , we set the occupations to fermi functions of the auxiliary hamiltonian eigenvalues at a specified @xmath23 , instead of selecting @xmath23 based on the electron number constraint .",
    "correspondingly , the second term of the auxiliary hamiltonian gradient ( [ eqn : hauxgradient ] ) , which arises from this constraint , drops out , and the algorithm requires no further modification .    the convergence rate of this algorithm , however , is sensitive to the preconditioning factor @xmath143 and we propose a modified heuristic to update @xmath143 automatically and continuously . at the end of each line minimization , the derivative of the optimized free energy @xmath144 with respect to @xmath143 can be evaluated from the overlap between the auxiliary hamiltonian gradient and search direction.@xcite the line - minimized energy is optimum for @xmath145 .",
    "therefore , if variation of @xmath144 with respect to @xmath143 is convex , we should increase @xmath143 if we find @xmath146 and vice versa .",
    "however convexity is often lost if @xmath143 is initialized at too high a value .",
    "therefore , our heuristic tries to zero @xmath147 while limiting the contribution of the auxiliary hamiltonian gradient .",
    "in particular , we update @xmath148 \\label{eqn : kadjust}\\ ] ] at the end of each line minimization , where @xmath149 to saturate the factor by which @xmath143 can change in one iteration , @xmath150 is the overlap of the @xmath129 components of the gradient and preconditioned gradient , and @xmath151 is the total overlap of the gradient and preconditioned gradients ( orbital + @xmath129 ) . finally , we reset the conjugate - gradient algorithm ( i.e. set the search direction to the negative of the preconditioned gradient direction ) after @xmath143 has increased or decreased by a factor greater than @xmath152 . we do this because dynamically changing the preconditioner technically invalidates the strict orthogonality of the cg search direction with previous directions .",
    "section  [ sec : resultsaux ] below shows that this heuristic exceeds the convergence obtained with fixed @xmath143 , while section  [ sec : algocompare ] shows that the grand - canonical auxiliary hamiltonian ( gc - auxh ) algorithm consistently outperforms gc - scf for fixed - potential calculations .",
    "we implement all algorithms and perform all calculations using the open - source plane - wave density - functional theory software , jdftx.@xcite all calculations in this work employ the pbe@xcite exchange - correlation functional with gbrv ultrasoft pseudopotentials@xcite at a kinetic energy cutoff of 20  hartrees for kohn - sham orbitals and 100  hartrees for the charge density .",
    "the metal surface calculations use inversion - symmetric slabs of at least five layers , with at least 15  @xmath153  vacuum separation and truncated coulomb potentials@xcite to minimize interactions with periodic images . for brillouin zone integration",
    ", we use a fermi smearing of @xmath154  hartrees and a monkhorst - pack @xmath155-point mesh along the periodic directions with the number of @xmath155-points chosen such that the effective supercell is larger than 30     in each direction .",
    "we use the candle solvation model to describe the effect of liquid water and debye screening due to 1 m electrolyte , which we showed recently to most accurately capture the solvation of highly - charged negative and positive solutes.@xcite we emphasize that the methods and algorithms described above do not rely on specific choices for the pseudopotential , exchange - correlation functional , @xmath155-mesh or solvation model ; we keep these computational parameters constant here for consistency .      .",
    "upper panel shows the convergence of grand free energy @xmath156 on a logarithmic scale , and lower panel shows that of electron number @xmath78 .",
    "best convergence is obtained with @xmath157 , the inverse debye - screening length , which we use as the default value henceforth .",
    "results shown here are for a five - layer ( 5ml ) cu(111 ) slab solvated in 1 m candle aqueous electrolyte , with potential fixed to 1v she ( @xmath158 ) , starting from a converged neutral calculation of the same slab in vacuum .",
    "[ fig : scf - qkappa ] ]    the self - consistent field ( gc - scf ) algorithm summarized in section  [ sec : algoscf ] depends on several parameters that control its iterative convergence .",
    "all these parameters are common to the conventional fixed - charge version ( scf ) and the fixed - potential variant ( gc - scf ) introduced here , except for the low - frequency cutoff wavevector @xmath122 that is necessary to allow the net electron number to change in the fixed - potential case .",
    "figure  [ fig : scf - qkappa ] compares the dependence of gc - scf convergence on @xmath122 for a prototypical calculation of an electrochemical system : a cu(111 ) surface treated using a five - layer inversion - symmetric slab surrounded by 1 m aqueous non - adsorbing electrolyte treated using the candle solvation model,@xcite at a fixed potential of @xmath158 ( 1v  she ) .",
    "( the remaining gc - scf parameters are set to their default values which we discuss below . )",
    "the best convergence is obtained with @xmath159 which corresponds to the debye screening length of the electrolyte ( [ eqn : qkappaopt ] ) . for small @xmath122 , including the conventional case of @xmath160 , the number of electrons does not respond sufficiently quickly , stalling at about 0.1  electrons from the converged value , correspondingly with the free energy stalling at about 0.1  @xmath161 ( @xmath162  ev ) away from the converged value .",
    "larger @xmath122 causes the electron number to change too rapidly , hindering convergence and eventually leading to a divergence as seen for the case of @xmath163 .",
    "an issue remains in the convergence independent of @xmath122 : after initial convergence , the free energy oscillates at the @xmath164 level , while the electron number oscillates at the @xmath165 level .    .",
    "good convergence is observed near the typical recommended value @xmath166 ( @xmath167  @xmath168 ) .",
    "convergence is relatively insensitive to @xmath105 near this value , but becomes unstable for small @xmath105 approaching the low - frequency cutoff @xmath122 .",
    "system and remaining details are identical to figure  [ fig : scf - qkappa ] .",
    "[ fig : scf - qkerker ] ]    keeping @xmath122 at this optimum value given by ( [ eqn : qkappaopt ] ) , we next examine the dependence of gc - scf convergence on the remaining algorithm parameters for the same example system .",
    "figure  [ fig : scf - qkerker ] shows the dependence on the kerker mixing wavevector @xmath105 , which helps stabilize the gc - scf algorithm against long - wavelength charge oscillations .",
    "optimal convergence is obtained for the typical recommended value@xcite of @xmath169 ( @xmath167  @xmath168 ) .",
    "as expected , convergence is relatively insensitive to the exact choice of @xmath105 , as long as @xmath105 does not become so small that convergence is ruined by charge sloshing .",
    "notice that the final convergence beyond the @xmath164 and @xmath165 electron level remains an issue that is not resolved for any choice of @xmath105 .    .",
    "convergence is relatively insensitive to @xmath106 , and we set @xmath170 henceforth . system and remaining details are identical to figure  [ fig : scf - qkappa ] . [",
    "fig : scf - qmetric ] ]    next , figure  [ fig : scf - qmetric ] shows the variation of gc - scf convergence with the wavevector @xmath106 controlling the reciprocal - space metric used by the pulay algorithm .",
    "the convergence is entirely insensitive to this choice , and we henceforth set @xmath170 ( the recommended value@xcite ) .",
    "again , the final convergence issue remains unaffected by the choice of @xmath106 .    .",
    "convergence is relatively insensitive to @xmath0 , except that it slows down for small @xmath0 we henceforth set @xmath171 which nominally exhibits the best convergence .",
    "system and remaining details are identical to figure  [ fig : scf - qkappa ] .",
    "[ fig : scf - mixfraction ] ]    finally , figure  [ fig : scf - mixfraction ] compares the dependence of gc - scf convergence on the maximum kerker mixing fraction @xmath0 , which effectively controls what fraction of the new electron density is mixed into the current value .",
    "we find nominally best convergence for @xmath171 , but the performance of other values is not much worse .",
    "smaller values of @xmath0 lead to greater stability initially , but marginally slower convergence later on , while larger values of @xmath0 lead to greater oscillations initially , but faster convergence later on .",
    "regardless , as before , good convergence is obtained until the free energy reaches the @xmath164 level , but continues to oscillate at that level beyond that point .",
    ", and with vacuum spacing ranging from 15  @xmath172 to 35  @xmath172 with the 5ml slab .",
    "convergence slows only marginally with increasing system size , with either vacuum spacing or layer count .",
    "each calculations is for solvated cu(111 ) charged to 1v  she in candle electrolyte , starting from the state of the corresponding converged neutral vacuum calculation .",
    "[ fig : scf - size ] ]    this final convergence issue may not affect practical calculations where relevant energy differences are at the @xmath173 level or higher .",
    "however , smooth exponential convergence to the final answer is desirable as this makes it easier to determine when the target accuracy has been reached . unfortunately , no combination of gc - scf parameters achieves uniformly smooth convergence for the fixed - potential case . on the other hand , with our @xmath122 modification",
    ", the gc - scf algorithm at least converges to the @xmath164 level independent of system size ( figure  [ fig : scf - size ] ) , with the number of cycles required for convergence remaining mostly unchanged with increasing number of cu(111 ) layers , and with increasing thickness of the solvent region .      , the preconditioning scale factor for subspace rotations generated by the auxiliary hamiltonian .",
    "near - optimal convergence is obtained when @xmath143 is automatically adjusted using the heuristic given by ( [ eqn : kadjust ] ) , which we use by default henceforth .",
    "calculations are for solvated 5ml cu(111 ) at 1v  she , starting from the corresponding neutral vacuum calculation , exactly as in figures  [ fig : scf - qkappa]-[fig : scf - mixfraction ] .",
    "note the smooth exponential convergence ( without oscillations in electron number and free energy ) here , in contrast to the gc - scf case .",
    "[ fig : aux - k ] ]    the grand - canonical auxiliary hamiltonian ( gc - auxh ) approach discussed in section  [ sec : algoaux ] , directly minimizes the total free energy of the system without assuming any models for physical properties of the system ( such as dielectric response models that are built into the scf mixing schemes ) .",
    "this algorithm contains a single parameter @xmath143 , which weights the relative contributions of the kohn - sham orbital and subspace hamiltonian degrees of freedom in the conjugate - gradients search direction for free energy minimization .",
    "figure  [ fig : aux - k ] shows the dependence of iterative convergence of the gc - auxh algorithm on this preconditioning parameter @xmath143 for the same cu(111 ) test problem considered above . if the preconditioning factor @xmath143 is held fixed , the rate of convergence is sensitive to the choice of @xmath143 , with the optimum choice being @xmath174 for this system . with the preconditioner",
    "auto - adjusted using the heuristic given by ( [ eqn : kadjust ] ) , we find that indeed the convergence picks up from that of the sub - optimal @xmath175 towards that of the optimal value .",
    "more importantly , we observe smooth exponential convergence of both the free energy and the electron number , in contrast to our experiences with the gc - scf method .     for the gc - scf method ) .",
    "convergence is invariant with vacuum spacing , and slows down only marginally with number of layers .",
    "[ fig : aux - size ] ]    figure  [ fig : aux - size ] further shows that this smooth convergence sustains with changing system size . in particular ,",
    "the convergence is virtually unchanged with the thickness of the solvent regions , but slows down slightly with increasing number of copper layers in the surface slabs .      having analyzed and optimized the convergence of the gc - scf and gc - auxh methods , we now compare the performance of these algorithms for a few different cases . in this comparison , we also include the present state of the art : the ` loop ' method which uses a secant method to adjust the number of electrons in an outer loop to match the specified electron chemical potential.@xcite for a fair comparison , we use the fixed - charge scf method in the inner loops , because it achieves the fastest convergence ; this algorithm works equally well with the auxh method in the inner loop , but is then marginally slower .",
    "also , we now compare the wall time between algorithms , because there is no straightforward correspondence between gc - scf cycles and conjugate - gradient iterations of the gc - auxh method .",
    "free energy accuracy in half the wall time of the loop method , but the gc - auxh method is the clear winner with smooth exponential convergence .",
    "calculations here are for the 5ml cu(111 ) slab at 1v  she , as before .",
    "timings are measured on a single 32-core nersc cori node in all cases .",
    "[ fig : compare - cu5 ] ]    first , figure  [ fig : compare - cu5 ] compares the performance of the algorithms for the 5-layer cu(111 ) slab used in all the tests so far .",
    "the spikes in the free energy seen in the loop method are the points where the electron number changes in the outer loop and a new scf convergence at fixed charge begins .",
    "both the gc - scf and gc - auxh methods are quite competitive , cutting the time to convergence within @xmath164 in half compared to the loop method . given the smooth convergence beyond @xmath164 however , the gc - auxh method is preferable over gc - scf for fixed potential calculations .    , but for a 5ml pt(111 ) slab at 0v  she ( @xmath176 ) .",
    "platinum is neutral at @xmath177v  she , so this corresponds to negatively charging the slab , which activates candle s asymmetry correction .",
    "additionally , platinum has @xmath178 bands crossing the fermi level in contrast to copper which has occupied @xmath178 bands .",
    "this calculation therefore explores a more complicated charge vs. potential landscape , causing deviations from exponential convergence , but the relative performance of the algorithms remains similar .",
    "[ fig : compare - pt5 ] ]    next , we compare these algorithms for more complex text cases . figure  [ fig : compare - pt5 ] compares the convergence for a five - layer pt(111 ) slab fixed to a potential of @xmath176 ( 0v   she ) . at this potential ,",
    "the surface of pt(111 ) charges negatively , and the candle solvation model brings the cavity closer to the electrons to capture the more effective solvation of negative charges by liquid water .",
    "additionally , the dielectric response of platinum is more complex than copper due to the partially filled @xmath178 shell .",
    "both of these factors make this system harder to converge than the previous test case , and therefore the convergence of the gc - auxh method is no longer clearly a single exponential . despite this , both the direct grand - canonical methods converge faster than the loop method , with the gc - auxh method eking out an advantage in final convergence as before .     and [ fig : compare - pt5 ] , but for a 5ml pt(111 ) slab decorated with a @xmath179 partial monolayer of adsorbed chloride anions ( 1/3 coverage ) at 0v  she .",
    "the increased complexity slows down the convergence of the gc - scf method , which also slows down the loop over fixed - charge scf calculations , while the gc - auxh method continues to exhibit rapid near - exponential convergence with no charge oscillations , beating the loop method by a factor of 4 in time .",
    "all subsequent calculations of complex metal surfaces with adsorbates therefore use the gc - auxh method .",
    "[ fig : compare - pt5_cl ] ]    finally , figure  [ fig : compare - pt5_cl ] compares the convergence for chloride anions adsorbed at one - third monolayer coverage , in a @xmath179 supercell of a five - layer pt(111 ) slab . despite the increased complexity",
    ", the direct grand - canonical methods exhibit the best convergence , edging out the loop method by a factor of four in wall time now , again with smoothest convergence for the gc - auxh method . due to the systematic convergence advantage of the gc - auxh method , we use it for all remaining calculations in this work and recommend it as the default general purpose algorithm for converging electrochemical calculations .    in the theory section and",
    "all calculations so far , we used fermi smearing where the electron occupations are given by the fermi function ( [ eqn : fermioccupations ] ) .",
    "practical @xmath155-point meshes typically require the use of a temperature @xmath2 substantially higher than room temperature ( we used 0.01  @xmath161 which is approximately ten times higher ) , which could result in inaccurate free energies .",
    "such errors can be reduced substantially by changing the functional form of the occupations and the electronic entropy , with the caveat that the smearing width @xmath2 no longer corresponds to an electron temperature .",
    "common modifications include gaussian smearing , where the fermi functions are replaced with error functions , and cold smearing,@xcite where the functional form is chosen to cancel the lowest order variation of the free energy with @xmath2 .",
    "( see ref .   for details .",
    ")    , the gc - auxh method with cold smearing converges marginally slower than gaussian or fermi smearing , but still faster than when using any of the smearing methods with the smaller width of 0.001  @xmath161 .",
    "[ fig : smearing ] ]    figure  [ fig : smearing ] compares the performance of the preferred gc - auxh method for various smearing methods .",
    "the insets show the variation of the converged free energy and electron number with smearing width @xmath2 .",
    "gaussian smearing reduces the coefficient of the quadratic @xmath2 dependence compared to fermi smearing , while cold smearing cancels the quadratic dependence altogether , by design .",
    "the variation of electron number with smearing width is also reduced by cold smearing , but to a lesser extent .",
    "notice that the use of cold smearing marginally slows down the iterative convergence of the gc - auxh method .",
    "however , using cold smearing at a high width of 0.01  @xmath161 is still faster than using any smearing method with the lower width 0.001  @xmath161 that is close to room temperature ( because of the far denser brillouin zone sampling required for smaller widths ) .",
    "therefore , it is still advantageous to use cold smearing at elevated smearing widths , and so we use cold smearing with a width of 0.01  @xmath161 for the final demonstration below .",
    "the application of sufficiently negative ( reductive ) potentials on an electrode immersed in a solution containing metal ions , reduces those ions and results in bulk electro - deposition of metal on the surface . additionally , for many pairs of metals , a single monolayer of one metal deposits on a surface of the other at an under potential , that is , at a potential less favorable than for bulk deposition .",
    "this phenomenon of under - potential deposition ( upd ) has several technological applications since it enables precise synthesis of heterogeneous metal interfaces .",
    "it also serves as an archetype for fundamental studies of electrochemical processes ( see ref .   for an extensive review ) , which makes it a perfect example for demonstrating our grand - canonical density - functional theory method .",
    "the basic reason for underpotential deposition is that the heterogeneous binding between the two metals is stronger than the homogeneous binding of the depositing metal to itself .",
    "indeed , metal pairs that exhibit underpotential deposition also display analogous phenomena in vapor adsorption.@xcite .",
    "however , the process in solution is far more complicated and highly sensitive to the composition of the solution because of competing adsorbates,@xcite as well as to the structure of the electrode surface.@xcite    the upd of copper on pt(111 ) in the presence of chloride anions is particularly interesting and the subject of considerable debate in the literature .",
    "voltammetry for this system@xcite exhibits two well - separated under - potential peaks , as shown in the background of figure  [ fig : upd ] . certain leed and in situ x - ray scattering studies of this system@xcite find evidence of a @xmath180 bilayer of copper and chloride ions co - adsorbed on the surface at potentials between the two peaks , suggesting that one peak corresponds to a formation of a partial layer , and the second peak , to the formation of the full monolayer .",
    "in contrast , other studies@xcite do not find this signature and propose that the additional peak arises from adsorption and desorption of chloride ions alone .    to address this debate",
    ", we perform grand - canonical density functional theory calculations of various configurations of copper and chlorine adsorbed on a 5-layer pt(111 ) slab in @xmath179 and @xmath180 supercells .",
    "we determine the most stable configurations at each potential(@xmath23 ) and the potentials at which transitions between configurations occur by comparing their grand free energies .",
    "the relevant grand free energy of a configuration @xmath38 containing @xmath181 platinum atoms in the slab with @xmath182 copper and @xmath183 chlorine atoms adsorbed at the surface within the calculation cell is @xmath184 normalized by the number of surface platinum atoms @xmath185 in order to correctly compare energies of calculations in different supercells .",
    "( @xmath186 for the unit cell , 6 for the @xmath179 supercell and 8 for the @xmath180 supercell , accounting for the top and bottom surfaces in the inversion - symmetric setup . )",
    "since no light atoms are present , we safely neglect changes in vibrational contributions to the free energy between adsorbate configurations .",
    "above , @xmath187 is the free energy of adsorbate configuration @xmath38 calculated by fixed - potential dft , which is grand canonical with respect to the electrons at chemical potential @xmath23 ( related to the electrode potential by ( [ eqn : mucalibration ] ) as discussed at the end of section  [ sec : theoryjdft ] ) .",
    "then , ( [ eqn : freeenergyupd ] ) above calculates the free energy @xmath188 which is additionally grand canonical with respect to all relevant atoms with chemical potentials @xmath189 , @xmath190 and @xmath191 .",
    "several conventions are possible in defining the electron - grand - canonical free energy @xmath156 , depending on what electron number we subtract : change from neutral value , total electron number , or number of valence electrons in pseudopotential dft calculations .",
    "the atom chemical potentials would then respectively correspond to neutral atoms , bare nuclei or pseudo - nuclei ( nuclei + core electrons in pseudopotential ) .",
    "the full grand canonical free energy @xmath192 does not depend on this choice . in our jdftx implementation ,",
    "we choose the last option above ( number of valence electrons and correspondingly atom chemical potentials of the pseudo - nuclei ) .",
    "the bulk of the platinum electrode sets the pt chemical potential , @xmath193 , where @xmath194 is the dft energy of a bulk fcc pt calculation with a single atom in the unit cell , and @xmath195 is the number of valence electrons in that calculation .",
    "the second term here implements the electron counting convention discussed above .",
    "next , copper ions in solution set @xmath190 , but directly calculating the free energy of such ions using solvation models is error - prone.@xcite so , instead , we use the dft calculated energy , @xmath196 , of a bulk fcc cu calculation ( containing @xmath197 valence electrons ) , and relate it to the free energy of the ion via the experimentally - determined standard reduction potential @xmath198  v she.@xcite this yields @xmath199,\\end{gathered}\\ ] ] where the second term accounts for the change from cu(s ) to @xmath200 ions , and the final term accounts for change in ionic concentration from the standard value of 1  mol / liter to the current value of [ cu@xmath201 ( in mol / liter ) . similarly , chlorine ions in solution set @xmath191 , but to minimize dft errors , we connect to the dft calculated energy , @xmath202 , of an isolated chlorine atom ( containing @xmath203 valence electrons ) , via the experimentally - determined atomization energy @xmath204  kj / mol,@xcite gas - phase entropy @xmath205  j / mol - k,@xcite and reduction potential @xmath206  v she.@xcite specifically , @xmath207,\\end{gathered}\\ ] ] where the second term accounts for the change from atomic to gas - phase chlorine , the third term for the change to chloride ions , and the final term for the change in chloride ion concentration to [ cl@xmath208 ( in mol / liter ) .",
    "mol / liter cu@xmath209 ions and 10@xmath210  mol / liter cl@xmath211 ions .",
    "calculated free energies for various adsorbate configurations as a function of electrode potential are shown as calculated by explicit fixed - potential solvated calculations in ( a ) , and from vacuum calculations in ( b ) , with the experimental voltammogram@xcite shown for comparison .",
    "solid red lines indicate no copper , purple dotted lines indicate @xmath180 partial copper monolayer and blue dot - dash lines indicate full copper monolayer .",
    "thickness of the lines indicate cl coverage , ranging from no cl ( thinnest ) , @xmath180 ( 1/4 ) coverage ( intermediate ) to @xmath179 ( 1/3 ) coverage ( thickest ) .",
    "prominent configurations are sketched in ( c - f ) .",
    "vacuum calculations in ( b ) predict only a single voltammetric peak in disagreement with experiment .",
    "explicit potential - dependent solvated calculations in ( a ) predict two peaks in qualitative agreement with experiment ( @xmath212  v accuracy ) , with the second peak due to chloride desorption.@xcite the partial cu monolayer ( d ) proposed by some@xcite is not predicted to be the most stable configuration at any relevant potential .",
    "[ fig : upd ] ]    figure  [ fig : upd](a ) shows the calculated grand free energies as a function of electrode potential for a number of cu and cl adsorbate configurations on the surface of pt(111 ) . at high potentials , the most stable ( lowest free energy ) configuration is 1/4 cl coverage ( figure  [ fig : upd](f ) ) , which transitions to a clean pt surface ( figure  [ fig : upd](e ) ) at a potential of 0.55  v she . upon further lowering the potential , the stable configuration transitions to a full monolayer of copper with 1/3 cl coverage ( figure  [ fig : upd](c ) ) at a potential of 0.46  v",
    "experimentally , the two voltammogram peaks are at approximately @xmath213 and @xmath214  v she , averaging over the forward and reverse direction sweeps .",
    "therefore chlorine desorption and full - copper - monolayer formation are plausible explanations@xcite of the two peaks , with our first - principles predictions reproducing well the peak spacing ( 0.09 ev versus 0.12 ev in experiment ) , and placing the absolute locations of the peaks to within 0.07 ev .",
    "the partial 2x2 monolayer of copper ( figure  [ fig : upd](d ) ) proposed by others@xcite as the reason for the second peak is not the most stable configuration in our calculations at any potential , lying a singinificant 0.3  ev above the other phases at relevant potentials .",
    "for comparison , figure  [ fig : upd](b ) shows the analogous results that would be obtained using only conventional vacuum calculations . in the above formalism",
    ", this corresponds to assuming @xmath215 , where @xmath216 is the helmholtz energy from a neutral vacuum dft calculation of configuration @xmath38 containing @xmath217 valence electrons .",
    "this approximation results in a single transition directly from the cl - covered pt surface to the one with a copper monolayer , predicting a single voltammogram peak in disagreement with experiment .",
    "accurate predictions for electrochemical systems therefore require treating charged configurations stabilized by the electrolyte at relevant electron potentials , now easily accomplished with the methods and algorithms introduced in this work .",
    "this work introduces algorithms for directly converging dft calculations in the grand - canonical ensemble of electrons , where the number of electrons adjusts to maintain the system at constant electron chemical potential , while ionic response in a continuum solvation model of electrolyte keeps the system neutral .",
    "we show that , with appropriate modifications , grand canonical versions of both the self - consistent field ( gc - scf ) method as well as direct free - energy minimization with auxiliary hamiltonians ( gc - auxh ) method are able to rapidly converge the grand free energy of electrons .",
    "this substantially improves upon the current state of the art of running an outer loop over conventional fixed - charge dft calculations . with detailed tests of the convergence of all these algorithms ,",
    "we show that the gc - auxh method is the most suitable default choice exhibiting smooth exponential convergence to the minimum .",
    "grand - canonical dft directly mimics the experimental condition in electrochemical systems , where electrode potential sets the chemical potential of electrons , and the number of electrons at the electrode surface ( including adsorbates in the electrochemical interface ) changes continuously in response . describing this change in charge at the surface plays an important role in accurately modeling several electrochemical phenomena.@xcite here , we showcase the new algorithms by analyzing the under - potential deposition ( upd ) of copper on platinum in an electrolyte containing chloride ions . we resolve an old debate about the identity of a second under - potential peak , showing that partial copper monolayers are not plausible and that the second peak is due to desorption of chloride ions .",
    "we expect the new methods presented here to substantially advance the realistic treatment of electrochemical phenomena in first principles calculations .",
    "rs and wag acknowledge support from the joint center for artificial photosynthesis ( jcap ) , a doe energy innovation hub , supported through the office of science of the u.s .",
    "department of energy under award number de - sc0004993 .",
    "rs and taa acknowledge support from the energy materials center at cornell ( emc@xmath218 ) , an energy frontier research center funded by the u.s .",
    "department of energy , office of science , office of basic energy sciences under award number de - sc0001086 .",
    "calculations in this work used the national energy research scientific computing center ( nersc ) , a doe office of science user facility supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "we thank kendra letchworth - weaver , kathleen schwarz , yuan ping , hai xiao , tao cheng , robert smith nielsen and jason goodpaster for insightful discussions .",
    "49ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo",
    "secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )",
    "@noop `` , ''   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) ,  ed .",
    ", @noop _ _  ( ,  ) @noop _ _ ,"
  ],
  "abstract_text": [
    "<S> first - principles calculations combining density - functional theory and continuum solvation models enable realistic theoretical modeling and design of electrochemical systems . </S>",
    "<S> when a reaction proceeds in such systems , the number of electrons in the portion of the system treated quantum mechanically changes continuously , with a balancing charge appearing in the continuum electrolyte . </S>",
    "<S> a grand - canonical ensemble of electrons at a chemical potential set by the electrode potential is therefore the ideal description of such systems that directly mimics the experimental condition . </S>",
    "<S> we present two distinct algorithms , a self - consistent field method ( gc - scf ) and a direct variational free energy minimization method using auxiliary hamiltonians ( gc - auxh ) , to solve the kohn - sham equations of electronic density - functional theory directly in the grand canonical ensemble at fixed potential . </S>",
    "<S> both methods substantially improve performance compared to a sequence of conventional fixed - number calculations targeting the desired potential , with the gc - auxh method additionally exhibiting reliable and smooth exponential convergence of the grand free energy . </S>",
    "<S> finally , we apply grand - canonical dft to the under - potential deposition of copper on platinum from chloride - containing electrolytes and show that chloride desorption , not partial copper monolayer formation , is responsible for the second voltammetric peak .    density - functional theory ( dft ) </S>",
    "<S> enables theoretical elucidation of reaction mechanisms at complex catalyst surfaces , making it now possible to design efficient heterogeneous catalysts for various industrial applications from first principles , for example for high - temperature gas - phase transformation of hydrocarbons to a variety of valuable chemical products.@xcite the extension of this predictive power to electrocatalysis would be highly valuable for an even broader class of technological problems , including a cornerstone of future technology for renewable energy : converting solar energy to chemical fuels by electrochemical water splitting and carbon dioxide reduction.@xcite accurately describing electrochemical phenomena , however , presents two additional challenges .    </S>",
    "<S> first , the electrolyte , typically consisting of ions in a liquid solvent , strongly affects the energetics of structures and reactions at the interface . </S>",
    "<S> treating liquids directly in dft requires expensive molecular dynamics to sample the thermodynamic phase space of atomic configurations . </S>",
    "<S> historically , a number of continuum solvation models that empirically capture liquid effects have enabled theoretical design of liquid - phase catalysts.@xcite more recently , empirical solvation models suitable for solid - liquid interfaces,@xcite joint density - functional theory ( jdft ) for efficiently treating liquids with atomic - scale structure,@xcite and minimally - empirical solvation models derived from jdft,@xcite have made great strides towards reliable yet efficient treatment of electrochemical systems .    </S>",
    "<S> second , electrons can flow in and out of the electrode as electrochemical reactions proceed . </S>",
    "<S> changes in electronic charge of electrode surfaces and adsorbates can be especially important because the electrolyte stabilizes charged configurations with a counter charge from the ionic response . </S>",
    "<S> for example , reduction of formic acid on platinum at experimentally relevant potentials is dominated by formate ions rather than neutral molecules at the surface.@xcite proton adsorption on stepped and polycrystalline surfaces involves displacing oxidatively - adsorbed water at relevant potentials , resulting in non - integer charge transfers and an anomalous ph dependence deviating from the nernst equation.@xcite    accounting for the electrolyte response using our solvation models,@xcite and adjusting the electron number to match experimentally relevant electrode potentials , realistic predictions of electrochemical reaction mechanisms have now become possible.@xcite in particular , application of this methodology to the reduction of co on cu(111 ) predicts onset potentials for methane and ethene formation with 0.05  v accuracy in comparison to experiment , for a wide range of ph varying from 1 to 12.@xcite however , conventional dft software and algorithms are optimized for solving the quantum - mechanical problem at fixed electron number , requiring extra work ( both manual and computational ) to calculate properties for a specified electrode potential .    </S>",
    "<S> this paper introduces algorithms for grand canonical dft , where electron number adjusts automatically to target a specified electron chemical potential ( related to electrode potential ) , thereby enabling efficient and intuitive first - principles treatment of electrochemical phenomena . </S>",
    "<S> section  [ sec : theory ] summarizes the theoretical background of first - principles electrochemistry using jdft and continuum solvation models , and sets up the fundamental basis of grand - canonical dft . </S>",
    "<S> then , section  [ sec : algorithms ] introduces the modifications necessary to make two distinct classes of dft algorithms , the self - consistent field ( gc - scf ) method and the variational free energy minimization using auxiliary hamiltonians ( gc - auxh ) , directly converge the grand free energy of electrons at fixed potential . </S>",
    "<S> sections  [ sec : resultsscf ] and [ sec : resultsaux ] establish the algorithm parameter(s ) that optimize the iterative convergence of the gc - scf and gc - auxh methods respectively , while section  [ sec : algocompare ] compares the performance of these algorithms for a number of prototypical electrochemical systems . </S>",
    "<S> finally , section  [ sec : upd ] demonstrates the utility of grand canonical dft by solving an electrochemical mystery : the identity of the second voltammetric peak in the under - potential deposition ( upd ) of copper on platinum in chloride - containing electrolytes . </S>"
  ]
}