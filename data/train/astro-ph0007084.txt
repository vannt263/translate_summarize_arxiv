{
  "article_text": [
    "direct @xmath0-body simulation of star clusters or other stellar systems has proven itself an extremely powerful tool to study the structure and evolution of stellar systems , since the pioneering work by von hrner ( @xcite ) .",
    "the only known way to do experiments on stellar systems is to construct their models in computers , because we can not do laboratory experiments on stellar systems ,    of course , @xmath0-body simulation is not the only way to construct computer models of star clusters .",
    "one could use monte - carlo ( henon @xcite , for recent development see giersz @xcite ) or direct integration of fokker - planck ( fp ) equations ( cohn @xcite , takahashi @xcite , drukier _ et al . _",
    "in particular , recent advance in the treatment of the two - dimensional [ @xmath1 fp equation made it possible to use fp code to the study of the evaporation of clusters in the tidal field of the parent galaxy .",
    "the main advantage of these methods over direct @xmath0-body simulation is the calculation cost . while it is still out of reach to perform the direct simulation of , say",
    ", a typical globular cluster with @xmath2 , the fp equation is valid in the limit of @xmath3 .",
    "therefore , when the assumption of large-@xmath0 limit is good , methods based on the fp approximation can deliver reliable results for the calculation cost orders of magnitudes smaller than that of direct @xmath0-body calculation . in principle",
    ", one can do the @xmath0-body simulation with small @xmath0 and then try to extrapolate that result to larger @xmath0 .",
    "however , this problem , which is sometimes called `` the scaling problem '' has proven itself a complex and difficult problem(heggie _ et al .",
    "_ @xcite ) .",
    "the main reason of the difficulty is that there are many physical processes of which timescales depend on the number of particles in different ways , and that there is no way to adjust all relevant timescales consistently .    on the other hand , methods based on fp approximation",
    "do have their own limitations .",
    "for example , it s pretty difficult to extend the formulation beyond the spherical symmetry .",
    "moreover , they also suffer the problem of the time scaling , only difference is that they are affected from the opposite direction .",
    "for example , when we want to include the dynamical effect of the slowly varying potential , fp approximation goes into trouble .",
    "consider the tidal stripping of globular clusters with non - circular orbit .",
    "the orbital timescale is of the order of @xmath4 years .",
    "the orbital timescale of the stars around the tidal boundary of the cluster is also @xmath4 years . on the other hand ,",
    "the half - mass relaxation time is of the order of @xmath5 years .",
    "therefore , the timestep to integrate the fp equation is at the largest @xmath4 years , and in practice much smaller than that .",
    "clearly , the assumption that the dynamical timescale is smaller than the fokker - plank timestep is broken , and fp calculations tends to grossly overestimate the escaper rate .    as beautifully demonstrated by takahashi and portegies zwart ( @xcite )",
    ", one can incorporate the escaping timescale into fp calculation .",
    "however , in order to do so the model parameter must be adjusted so that the agreement with reference @xmath0-body calculations is achieved . moreover ,",
    "this agreement has been so far achieved only with @xmath0-body simulations with simple static `` tidal cutoff '' , where _ no _ tidal field is imposed and stars outside the tidal radius are just removed . whether or not fp calculations can reproduce the result of @xmath0-body calculations with tidal fields is an open question .",
    "the ultimate solution for the scaling problem is to perform @xmath0-body simulations with sufficiently large number of particles . in the first half of this paper",
    ", we describe our effort in that direction , the grape project to develop and use special - purpose computers for @xmath0-body simulations . in the last half of this paper",
    ", we d like to discuss briefly our recent work on @xmath0-body simulations of galactic centers with massive black holes , where again the scaling problem shows up .",
    "in principle , the direct @xmath0-body simulation of stellar systems is very simple and straightforward .",
    "the only thing one has to do is to numerically integrate the following system of equations of motion : @xmath6 where @xmath7 and @xmath8 are the position and mass of the particle with index @xmath9 and @xmath10 is the gravitational constant .",
    "the summation is taken over all stars in the system .    in practice , we need complex methods and tricks to integrate the above equation .",
    "since we can not cover all important issues here , we recommend the reviews by spurzem ( @xcite ) and aarseth ( @xcite ) . here",
    ", we briefly discuss issues directly related to the use of special - purpose hardwares for @xmath0-body problem .",
    "as we wrote above , in principle an @xmath0-body simulation is simple and straightforward . at each timestep",
    ", we calculate the forces on all particles in the system , and integrate their orbits using some appropriate integration method .",
    "in fact , in molecular dynamics simulation , where one solves the @xmath0-body problem of atoms interacting through coulomb and van der waals forces , one can rely on this approach . in astrophysics ,",
    "however , the nature of the gravitational interaction makes such approach impractical .",
    "the problem is that the gravitational force is an attractive force with no characteristic scale length .",
    "this fact leads to three complications .",
    "the first one is that the inhomogeneity develops as the system evolves . in the case of star clusters ,",
    "this is known as core collapse or gravitational catastrophe .",
    "the central core of the cluster evolves to higher and higher density , while its mass decreases .",
    "the timestep has to be small enough to integrate accurately the orbits of particles in the core .",
    "therefore , the timestep decreases as the cluster evolves .",
    "the second one is that even when the core density is not very high , random close encounters of two particles can lead to arbitrary short timesteps .",
    "the third one is that stable binaries and more complex hierarchical systems are formed through three - body encounters and encounters of larger number of particles ( such as binary - binary interactions ) .",
    "these systems have very small orbital timescales . for a quantitative analysis of these issues , see makino and hut ( @xcite ) .",
    "fortunately , we can handle these complications by a combination of techniques .",
    "the first two are solved by assigning each particle its own time and timestep .",
    "this scheme , the individual timestep scheme , was first introduced by aarseth ( @xcite ) , and has been used for four decades .    in the individual timestep scheme",
    ", each particle has its own timestep @xmath11 and maintains its own time @xmath12 . to integrate the system ,",
    "one first selects the particle for which the next time ( @xmath13 ) is the minimum .",
    "then , one predicts its position at this new time .",
    "positions of all other particles at this time must be predicted also .",
    "then the force on that particle from other particles is calculated .",
    "the position and velocity of the particle is then corrected .",
    "the new timestep is also calculated .",
    "the integration scheme is a variation of krogh s scheme ( krogh @xcite ) modified for second - order equations .    a modification of this individual timestep algorithm is now used to achieve higher efficiency on vector machines ( mcmillan @xcite ) and special - purpose computers ( makino @xcite ) .",
    "this scheme is called the blockstep scheme . in this scheme ,",
    "the timesteps of particles are forced to integer powers of two . in addition , the new timestep of a particle is chosen so that the time of the particle is an integer multiple of the new timestep .",
    "these two criteria make it possible to force multiple particles to share exactly the same time . as a result ,",
    "the efficiency of vector / parallel hardware is improved significantly .",
    "however , it should be noted that the average number of particles which share the same time is not very large , in particular when the central core is small and dense .",
    "therefore , it is necessary that the force calculation procedure can achieve reasonable performance when the number of particles to be integrated in parallel is small . since the number of particles in the core can be as small as 100 or less , it is necessary that the force calculation procedure can achieve a reasonable speed for that number .",
    "the third problem , the stable binaries and other hierarchical systems , is solved essentially by integrating them as small-@xmath0 subsystem embedded in the cluster .",
    "the motion of the center of mass of the subsystem and internal motion of its members are separated , and integrated independently with different timesteps .",
    "if the perturbations from the rest of the system is small , we can ignore it . in the case of a binary , this means we can completely skip the numerical integration of the internal motion , since we know the analytic solution . if the perturbation is not negligible but is small , we can apply various techniques such as `` slow ks '' ( mikkola and aarseth @xcite ) . here",
    ", the hardest problem is not really the calculation cost .",
    "the challenge is how we can recognize these subsystems and their internal structures , and how we can decide what method is appropriate for that particular structure .",
    "we have developed a series of special - purpose computers for @xmath0-body simulations , which we call grape ( gravity pipe ) .",
    "figure [ fig : basic - grape ] gives the basic idea .",
    "the host computer , which is usually a general - purpose workstation running unix , send the positions and masses of particles to the grape hardware .",
    "then grape hardware calculates the interaction between particles .",
    "what grape hardware calculates is the right hand side of equation ( [ eq : basic - equation ] ) .",
    "when we use the hermite scheme ( makino @xcite ) , the first time derivative of the force must also be calculated . in this case , velocities of particles are needed .",
    "figure [ fig : harppipe ] shows the block diagram of the pipeline unit to calculate the force and its time derivative .",
    "= 9 cm    = 10 cm    in order to combine the individual timestep scheme with grape hardware , one modification of the basic architecture is necessary .",
    "figure [ fig : grape - individual ] shows the change . as described in the previous section , we have to predict the position ( and velocity in the case of the hermite scheme ) of all particles to calculate the forces on the particles in the current blockstep .",
    "this prediction must also be done on the grape hardware , since otherwize the amount of the calculation the host computer has to do becomes too large .    in the modified architecture shown in figure [ fig : grape - individual ]",
    ", the particle memory keeps all data necessary for prediction , for all particles in the system . at each blockstep ,",
    "the host computer writes the position and velocity of particles to be updated , and grape calculates the forces on them and sends the results back to the host . if the number of pipelines is smaller than the number of particles in the block , this step is repeated until the forces on all particles in the block are obtained .",
    "then the host performs the orbit integration using these calculated forces , and updates the data of the integrated particles in the particle memory of the grape hardware .",
    "= 9 cm    grape-4 ( makino _ et al . _",
    "@xcite ) is the first grape hardware to implement this modified architecture . in grape-4 ,",
    "one processor board houses one predictor units and 96 ( virtual ) force calculation pipelines .",
    "the total system in the maximum configuration consisted of 36 boards organized into four clusters , and different boards calculated the forces on the same set of 96 particles . in this way , we met the requirement that the number of forces calculated in parallel is small , even though the number of pipelines is large .",
    "summation of 9 forces from processor boards in the same cluster is taken care by the communication hardware , and final summation of the forces from four clusters is handled by the host .",
    "grape-4 was completed in 1995 , and has been used by many researchers for the study of dense stellar systems .",
    "in 1997 , we started the grape-6 project .",
    "it s a five - year project funded by jsps ( japan society for the promotion of science ) , and the planned total budget is about 500 m jye .",
    "the grape-6 is essentially a scaled - up version of grape-4(makino _ et al . _",
    "@xcite ) , with the peak speed exceeding 100 tflops . it will consist of around 3000 pipeline chips , each with the peak speed of 40 gflops . in comparison , grape-4 consists of 1700 pipeline chips , each with 600 mflops .",
    "the increase of a factor of 100 in speed is achieved by integrating six pipelines into one chip ( grape-4 chip has one pipeline which needs three cycles to calculate the force from one particle ) and using 34 times higher clock frequency .",
    "the advance of the device technology ( from @xmath14 to @xmath15 ) made these improvements possible .",
    "figure [ fig : grape6chip ] shows the first sample of the processor chip delivered in early 1999 .",
    "the six pipeline units are visible .",
    "5.5 cm    figures [ fig : grape6board ] and [ fig : grape6box ] shows the processor board with 16 processor chips and the prototype four - board system .",
    "this four - board system has the theoretical peak speed of 2.1 tflops , and has achieved the sustained speed of 1.1 tflops for the simulation of 1 million - body system .",
    "9.5 cm    9 cm    grape-6 will be completed by the year 2001 .",
    "we plan to make small version of grape-6 ( peak speed of around one teraflops ) commercially available by that time .",
    "we ve found that the commercial availability of small machines is essential to maximize the scientific outcome from grape hardwares .    compared to grape-4",
    ", grape-6 will give us 100 times more computer power .",
    "for simulation of star clusters for the relaxation timescale , this means a factor of five increase in the number of particles we can handle . for short simulations ,",
    "the increase would be a factor of 10 . in the case where we can use tree algorithms , in principle a factor of 100 increase",
    "is possible if the host computer has a sufficiently large memory .",
    "table 1 gives a rough idea of what is currently possible with grape-4 and what will be possible soon with grape-6 .",
    "lcc problem aria & grape-4 & grape-6 + planet formation & @xmath16 & @xmath17 + star cluster & 5@xmath18 & 3@xmath19 + black hole binary in galactic nucleus & 10@xmath20 & @xmath21 + galaxy evolution & interactions & 2@xmath22 & 10@xmath23 + large scale structures & 3@xmath24 & 3@xmath25 +",
    "in this section , we briefly describe our resent work on the massive central black holes in the centers of galaxies ( makino and ebisuzaki @xcite , makino @xcite , nakano and makino @xcite ) .",
    "the problem is what happens when two galaxies , each with a central black hole , merge .",
    "the merging of two galaxies is a rather common event . according to the standard scenario of the structure formation in the universe ( hierarchical gravitational clustering )",
    ", galaxies are constructed `` bottom up '' from smaller objects through merging . on the other hand ,",
    "almost all galaxies except for some dwarfs seem to have central black holes .",
    "thus , if two such galaxies merge , the merger remnant would have two black holes .",
    "these black holes would settle in the center of the merger remnant , and would eventually form a binary .",
    "two questions arise : ( a ) what is the structure of the central region of the merger galaxy with two black holes ? and",
    "( b ) what will happen to the binary itself ? will two black holes eventually merge ?",
    "makino and ebisuzaki ( @xcite ) studied the first problem , assuming that black holes would eventually merge .",
    "they performed the simulation of hierarchical ( repeated ) merging similar to those by farouki _",
    "( @xcite ) , but with central black holes .",
    "what farouki _ et al .",
    "_ found is that the core radius remains almost unchanged after merging , even though the half - mass radius almost doubles after each merging event .",
    "this result is consistent with the theoretical prediction based on the conservation of the central phase space density , but in complete contradiction with the observations of luminous elliptical galaxies .",
    "ground - based observations in 1980s demonstrated that there is strong correlation between the effective radius and the `` core '' radius of luminous ellipticals ( lauer @xcite ) .",
    "hst observations ( gebhaldt _ et al . _",
    "@xcite ) have shown that the `` cores '' are actually all cusps with the profile @xmath26 , where @xmath27 is the volume luminosity density .",
    "figure [ fig : makinoebisu ] show the result of simulations with grape-4 .",
    "the central region of the merger with central black hole looks like the shallow cusps observers found in luminous ellipticals , and the radius of this cusp region is a constant fraction of the half - mass radius .",
    "thus , numerical simulations of merging of galaxies with black holes reproduced the observed characteristic of the central regions of luminous ellipticals rather well .",
    "= 6.3 cm = 6.3 cm    nakano and makino ( @xcite ) investigated why the cusp is formed .",
    "first , they tried to understand the formation mechanism better by means of simplified experiments , in which just one black hole was let to sink to the center of a galaxy . except for the case",
    "that the black hole is originally in the center , the cusp with @xmath28 is universally formed , and the mass within the cusp region is comparable to that of the mass of the central bh .    in the second paper ( nakano and makino 1999b ) , they came up with a simple explanation for the formation mechanism .",
    "the black hole sink to the center through the dynamical friction , in the dynamical timescale .",
    "when the black hole settled at the center of the galaxies , almost no star was strongly bound to the black hole .",
    "this is because the black hole sinks to the center relatively slowly .",
    "the sinking timescale is not so slow that the adiabatic approximation can be applied to the binding energy of the stars , but sufficiently slow that the binding energy of most of the stars does not change very much .",
    "thus , the distribution function @xmath29 has a sharp cutoff at the energy close to the central potential depth of the initial galaxy model .",
    "if there is a central massive object and @xmath29 has a sharp cutoff , we can show that the central region is a cusp with the slope @xmath30 as follows .",
    "the density is obtained by integrating the distribution function in the velocity space as follows : @xmath31 where @xmath32 is the potential at distance @xmath33 from the center , where the black hole lies . note that we assumed that the velocity distribution is isotropic .",
    "we assume that @xmath34 if @xmath35 . for any @xmath33 with @xmath36 , equation ( [ eq : density ] )",
    "can be rewritten as @xmath37 which can be expanded as @xmath38}^{2 } \\right )   \\right ] d { e},\\ ] ] therefore , we have @xmath39    for the fate of the black hole binary , we performed simulations with very wide range of the number of particles ( 2,048 to 262,144 ) to investigate the dependence of the growth timescale of the binding energy of the binary on the number of particles in the galaxy .",
    "what we found was intriguing .",
    "the timescale seemed to be proportional to @xmath40 , while , theoretically , the timescale must be proportional to @xmath0 , since the timescale should be limited by the timescale of filling the loss cone through two - body relaxation .",
    "we have not yet understood why our numerical experiments did not agree with the theoretical prediction .",
    "simulations with larger @xmath0 , which will be possible with grape-6 , will give us important clues for the understanding of this problem .",
    "in this paper , we briefly overviewed the computational issues of direct @xmath0-body simulations and the use of special - purpose computers , and we reviewed the plan and development status of grape-6 .",
    "we believe grape-6 will give us many new important scientific results , much in the same way as grape-4 have done so in the five years since its completion",
    ".    since grape-6 is now close to its completion , it might be worthwhile to speculate on what will come next .",
    "the silicon device technology has been advancing as usual , and will do so at least for one more decade or two . if we will start the development of the new system just after the completion of grape-6 , we will use the technology safely available by 2002 , which is either 0.13 or @xmath41 technology .",
    "this will give us around a factor of six increase in the transistor count .",
    "for the clock speed , we expect that the improvement by a factor of three will not be too hard , mainly because the current clock of grape-6 chip is not very high .",
    "thus , we can achieve about a factor of 20 improvement in the speed over that of grape-6 chip , reaching around 0.7 tflops per chip . with three thousand chips ,",
    "the peak speed would reach two petaflops .",
    "the target number of particles for such system would be around 1 million , for star cluster simulations .",
    "for that number , however , one might ask whether or not the direct force calculation is really a good approach , even though it guarantees very good cost - performance ratio .    there are two widely used algorithms to reduce the calculation cost .",
    "one is the neighbor scheme ( ahmad and cohen @xcite ) , and the other is the treecode ( barnes and hut @xcite ) . for general - purpose computers ,",
    "both algorithms give pretty large improvement in the overall calculation speed .",
    "the theoretical gain of the neighbor scheme is @xmath42 ( makino and hut @xcite ) , and the break - even point is as small as @xmath43 . for the treecode ,",
    "the gain is @xmath44 .",
    "the break - even point depends on the required accuracy , but @xmath2 is certainly large enough to guarantee a pretty large gain .",
    "however , we ( or anybody else ) have not yet conceived a feasible way to combine the neighbor scheme and grape , or treecode with individual timestep and grape . in both cases , the problem is that forces on different particles are calculated differently . as a result ,",
    "@xmath45 pipelines which calculate the forces on @xmath45 different particles need @xmath45 different data from the particle memory , while in the case of the simple direct summation all pipelines can use the same data . in principle , if each pipeline has its own memory , we can reconcile massively parallel grape and these algorithms . with the next - generation system",
    ", it will be necessary to integrate the memory and the pipeline processor anyway , since otherwize we can not achieve required memory bandwidth even for the case of the simple grape architecture . this integrated memory and pipeline might give us the opportunity to implement more efficient force calculation algorithms .",
    "we would like to thank daiichiro sugimoto , toshikazu ebisuzaki , makoto taiji , tomoyoshi ito , toshiyuki fukushige and many others who were involved in the development of the six generations of grape hardwares , and yoko funato , simon portegies zwart , steve mcmillan , piet hut and again many others for discussions and collaborations in software development and scientific works on grape hardwares .",
    "this work is supported by the research for the future program of japan society for the promotion of science ( jsps - rftp97p01102 ) ."
  ],
  "abstract_text": [
    "<S> in this paper we describe the current status of the grape-6 project to develop a special - purpose computer with a peak speed exceeding 100 tflops for the simulation of astrophysical @xmath0-body problems . </S>",
    "<S> one of the main targets of the grape-6 project is the simulation of dense stellar systems . in this paper , therefore , we overview the basic algorithms we use for the simulation of dense stellar systems and their characteristics . </S>",
    "<S> we then describe how we designed grape hardwares to meet the requirements of these algorithms . </S>",
    "<S> grape-6 will be completed by the year 2001 . as an example of what science </S>",
    "<S> can be done on grape-6 , we describe our work on the galactic center with massive black holes performed on grape-4 , the predecessor of grape-6 .    </S>",
    "<S> # 1_#1 _ # 1_#1 _ =    # 1 1.25 in .125 in .25 in </S>"
  ]
}