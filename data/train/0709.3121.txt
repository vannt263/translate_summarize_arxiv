{
  "article_text": [
    "at a microscopic level , a large number of internal variables associated with various physical and physiological phenomena contribute to dynamic changes in functional magnetic resonance imaging ( fmri ) datasets .",
    "fmri provides a large scale ( as compared to the scale of neurons ) measurement of neuronal activity , and we expect that many of these variables will be coupled resulting in a low dimensional set for all possible configurations of the activated fmri signal .",
    "we assume therefore that activated fmri time series can be parametrized by a small number of variables .",
    "this assumption is consistent with the usage of low dimensional parametric models for detecting activated voxels @xcite .",
    "this assumption is also consistent with the empirical findings obtained with principal components analysis ( pca ) and independent components analysis ( ica ) @xcite , where a small number of components are sufficient to describe the variations of most activated temporal patterns .",
    "both pca and ica make very strong assumptions about the components : orthogonality and statistical independence , respectively .",
    "such constraints are convenient mathematically but have no physiological justification , and complicate unnecessarily the interpretation of the components @xcite .",
    "a second limitation of pca and ica is that both methods only provide a linear decomposition of the data @xcite .",
    "there is no physiological reason why the fmri signal should be a linear combination of eigen - images or eigen - time series . in practice , the first components identified by pca are often related to physiological artifacts ( e.g. breathing ) , or coherent spontaneous fluctuations @xcite .",
    "these artifacts can be responsible for most of the variability in the dataset .",
    "stimulus triggered changes , which are much more subtle , rarely appear among the first components .",
    "the contribution of this paper is a novel exploratory method to construct an optimal coordinate system that reduces the dimensionality of the dataset while preserving the functional connectivity between voxels @xcite .",
    "first , we define a distance between time series that quantifies the functional coupling @xcite , or connectivity between the corresponding voxels .",
    "we then construct an embedding that preserves this functional connectivity across the entire brain .",
    "after embedding the dataset in a lower dimensional space , time series are clustered into coherent groups .",
    "this new parametrization results in a clear separation of the time series into : ( 1 ) response to a stimulus , ( 2 ) coherent physiological signals , ( 3 ) artifacts , and ( 4 ) background activity .",
    "we performed an extensive evaluation of our method comparing it to linear and nonlinear techniques using synthetic datasets and _ in vivo _ datasets .",
    "our goal is to find a new parametrization of an fmri dataset , effectively replacing the time series by a small set of features , or coordinates , that facilitate the identification of task - related hemodynamic responses to the stimulus .",
    "the new coordinates will also be able to reveal the presence of physical or physiological processes that have an intrinsic low dimension .",
    "such processes can be described with a small number of parameters ( dimensions ) in an appropriate representation ( set of basis functions ) .",
    "these time series should be contrasted with noise time series that have a very diffuse representation in any basis .",
    "example of such low - dimensional processes include task - related hemodynamic responses , non - task - related physiological rhythms ( breathing and heart beating motion ) .",
    "we expect that only a small fraction of all time series will have a low - dimensional representation .",
    "the remaining time series will be engaged in a spontaneous intrinsic activity @xcite .",
    "we call these time series _ background time series_. as shown in our experiments , background time series are more complex , and can not be well approximated with a small number of parameters .",
    "we now introduce some notations that will be used throughout the paper .",
    "let @xmath0 denote an fmri dataset composed of @xmath1 scans , each comprised of @xmath2 voxels , which is represented as a @xmath3 matrix , @xmath4 row @xmath5 of @xmath0 is the time series @xmath6 $ ] generated from voxel @xmath5 .",
    "column @xmath7 is the @xmath8 scan unrolled as a @xmath9 vector . in this work ,",
    "we regard @xmath10 as a point in @xmath11 , with @xmath1 coordinates .",
    "we seek a new parametrization of the dataset that optimally preserves the local functional coupling between time series .",
    "most methods of reduction of dimensionality used for fmri are linear : each @xmath10 is projected onto a set of components @xmath12 .",
    "the resulting coefficients @xmath13 serve as the new coordinates in the low dimensional representation",
    ". however , in the presence of nonlinearity in the organization of the @xmath10 in @xmath11 , a linear mapping may distort local functional correlations .",
    "this distortion will make the clustering of the dataset more difficult .",
    "our experiments with _ in vivo _ data confirm that the subsets formed by the low - dimensional time series have a nonlinear geometry and can not be mapped onto a linear subspace without significant distortion .",
    "we propose therefore to use a nonlinear map @xmath14 to represent the dataset @xmath0 in low dimensions . because the map @xmath14 is able to preserve the local functional coupling between voxels , low dimensional coherent structures can easily be detected with a clustering algorithm . finally , the temporal and the spatial patterns associated with each cluster are examined and the cluster that corresponds to the task - related response is identified . in summary ,",
    "our approach includes the following three steps :    1 .",
    "low dimensional embedding of the dataset ; 2 .",
    "clustering of the dataset using the new parameterization ; 3 .",
    "identification of the set of activated time series .    ]      in order to construct the nonlinear map @xmath14 we need to estimate the functional correlation between voxels .",
    "we characterize the functional correlation between voxels with a network .",
    "similar networks have been constructed to study functional connectivity in @xcite .",
    "we represent the network by a graph @xmath15 that is constructed as follows .",
    "the time series @xmath10 originating from voxel @xmath5 becomes the node ( or vertex ) @xmath10 of the graph is a time series , as well as a node on the graph . ] .",
    "edges between vertices quantify the functional connectivity .",
    "each node @xmath10 is connected to its @xmath16 nearest neighbors according to the euclidean distance between the time series , @xmath17 ( fig .",
    "[ network ] ) .",
    "the weight @xmath18 on the edge @xmath19 quantifies the functional proximity between voxels @xmath5 and @xmath7 and is defined by @xmath20 the scaling factor @xmath21 modulates the definition of proximity measured by the weight ( [ weight ] ) .",
    "if @xmath21 is very large , then for all the nearest neighbors @xmath22 of @xmath10 , we have @xmath23 ( see ( [ weight ] ) ) , and the transition probability is the same for all the neighbors , @xmath24 .",
    "this choice of @xmath21 promotes a very fast diffusion of the random walk through the dataset , and blurs the distinction between activated and background time series . on the other hand , if @xmath21 is extremely small , then @xmath25 for all the neighbors such that @xmath26 .",
    "only if the distance between @xmath10 and @xmath22 is zero ( or very small ) the transition probability is non zero .",
    "this choice of @xmath21 accentuates the difference between the time series , but is more sensitive to noise . in practice",
    ", we found that the universal choice @xmath27 where @xmath28 $ ] ( we used @xmath29 for all experiments ) is usually optimal .",
    "the weighted graph @xmath30 is fully characterized by the @xmath31 weight matrix @xmath32 with entries @xmath18 .",
    "let @xmath33 be the diagonal degree matrix with entries @xmath34 .",
    "the spatial coordinates of the voxels @xmath5 and @xmath7 are currently not used in the computation of @xmath18 . we know that spatial information can be useful : truly activated voxels tend to be spatially clustered . however , spatial proximity should be measured along the cortical ribbon , and not in the 3-d volume .",
    "once the network of functionally connected voxels is created , we need to define a distance between any two vertices @xmath10 and @xmath22 in the network .",
    "this distance should reflect the topology of the graph , but should also be able to distinguish between strongly connected vertices ( when the voxels @xmath5 and @xmath7 belong to the same functional region ) and weakly connected vertices ( when @xmath5 and @xmath7 have similar time series @xmath10 and @xmath22 , but belong to different functional regions ) .",
    "the euclidean distance that is used to construct the graph is only useful locally : we can use it to compare voxels that are functionally similar , but we should use a different distance to compare voxels that may not be functionally similar . as shown in the experiments ,",
    "the shortest distance @xmath35 between two nodes @xmath10 and @xmath22 measured along the edges of the graph is very sensitive to short - circuits created by the noise in the data .",
    "a standard alternative to the geodesic distance is the commute time , @xmath36 , that quantifies the expected path length between @xmath10 and @xmath22 for a random walk started at @xmath10 @xcite .",
    "we review here the concept of commute time in the context of a random walk on a graph .",
    "we show how the commute time can be computed easily from the eigenvectors of @xmath37 .",
    "let us consider a random walk @xmath38 on the connectivity graph .",
    "the walk starts at @xmath10 , and evolves on the graph with the transition probability @xmath39 , @xmath40 if the walk is at @xmath10 , it jumps to one of the nearest neighbors , @xmath22 , with probability @xmath41 .",
    "the walk first visits all voxels in the same functional area before jumping to a different functional area . indeed ,",
    "if voxel @xmath5 and @xmath7 are in the same functional area , and voxel @xmath42 is in a different functional area , then we expect that @xmath43 , and therefore @xmath44 .",
    "this observation can be quantified by computing the average hitting time that measures the number of steps that it takes for the random walk started at @xmath10 to hit @xmath22 for the first time @xcite , @xmath45 \\quad \\text{with } \\quad t_j=\\min \\{n\\ge 0 ; z_n = j\\}.\\ ] ] the hitting time is not symmetric , and can not be a distance on the graph .",
    "a proper distance is provided by a symmetric version of @xmath46 , called the commute time , @xcite , @xmath47 + e_j[t_i].\\ ] ] as one would expect , @xmath36 increases with the geodesic distance @xmath35 . unlike the geodesic distance , @xmath36 decreases when the number of paths between the nodes increases .    _",
    "commute time and clustering coefficient _ + the commute time is greatly influenced by the richness of the connections between any two nodes of the network .",
    "this concept can be quantified by the clustering coefficient .",
    "let @xmath10 be a node with @xmath16 neighbors .",
    "the neighbors of @xmath10 may , or may not , be neighbors of one another . to asses the transitivity of the connections",
    ", we can compute the total number of edges , @xmath48 , that exist between all the neighbors of @xmath10 .",
    "the clustering coefficient @xcite is @xmath49 $ ] .",
    "the maximum value of @xmath50 is @xmath51 and is achieved when each neighbor of @xmath10 is connected to all the other neighbors of @xmath10 ( they form a clique ) . if the average clustering coefficient , computed over all nodes of the network , is close to 1 , then there will always be multiple routes between any two nodes @xmath10 and @xmath22 , and the commute time will     as a function defined on the nodes of the graph .",
    "[ eigenfunction ] ]    remain small .",
    "@xcite measured clustering coefficients in networks of functionally connected voxels in fmri that were indicative of scale - free small - world networks .",
    "@xcite identified networks of richly connected hubs in the cortex , and have also shown that the functional network ( as measured by fmri ) exhibits the `` small world '' property . the commute time provides a distance on the graph that takes into account the abundance of connections that may exist between two nodes of the graph .    _ a spectral decomposition of commute time _ +",
    "as explained in the appendix , the commute time can be conveniently computed from the eigenvector @xmath52 of the symmetric matrix @xmath53 .",
    "the corresponding eigenvalues are between @xmath54 and @xmath51 , and can be labeled such that @xmath55 .",
    "each eigenvector @xmath12 is a vector with @xmath2 coordinates , one for each node of the graph @xmath15 .",
    "we therefore write @xmath56^t\\ ] ] to emphasize the fact that we consider @xmath12 to be a function defined on the nodes of the graph ( fig .",
    "[ eigenfunction ] ) . according to ( [ isometry0 ] )",
    ", the commute time can be expressed as @xmath57 where @xmath58 is the stationary distribution associated with @xmath59 , @xmath60 .",
    "the right hand side of ( [ isometry ] ) is the sum of @xmath61 squared contributions of the form @xmath62 .",
    "each contribution is the difference between two terms : @xmath63 and @xmath64 , which are associated with nodes @xmath10 and @xmath22 , respectively .    ' '' ''    * * * input : * * @xmath65 , @xmath66 , * * @xmath21 ; @xmath16 ; @xmath67 : dimension of the embedding , * * * algorithm : 1 .",
    "construct the graph defined by the @xmath16 nearest neighbors of each @xmath10 2 .",
    "compute @xmath32 and @xmath33 .",
    "find the first @xmath67 eigenvectors , @xmath12 , of @xmath68 * * * output : @xmath67 coordinates of each @xmath10 , @xmath69    ' '' ''      we define a mapping from @xmath10 to a vector of size @xmath61 , @xmath70^t .",
    "\\label{embed0}\\ ] ] the idea was first proposed in @xcite to embed manifolds .",
    "recently , the same idea has been revisited in the machine learning literature @xcite . according to ( [ isometry ] ) ,",
    "the commute time is simply the euclidean distance measured between the new coordinates . in practice , we need not use all the eigenvectors in ( [ embed0 ] ) . indeed , because @xmath71 we have @xmath72 .",
    "we can therefore neglect @xmath73 in ( [ embed0 ] ) for large @xmath42 , and reduce the dimensionality of the embedding by using only the first @xmath67 coordinates .",
    "finally , we define the map @xmath14 from @xmath11 to @xmath74 , @xmath75^t",
    ". \\label{embed}\\ ] ] the low dimensional parametrization ( [ embed ] ) provides a good approximation when the spectral gap @xmath76 , is large .",
    "the construction of the embedding is summarized in fig .",
    "[ algo1 ] .",
    "unlike pca which gives a set of vectors on which to project the dataset , the embedding ( [ embed ] ) directly yields the new coordinates for each time series @xmath10 .",
    "the new coordinates of @xmath10 are given by concatenating the @xmath77 coordinates of @xmath12 , @xmath78 .",
    "the first eigenvector @xmath79 is constant and is not used .",
    "_ what is the connection to pca ? _ + because each @xmath12 is also an eigenvector of the graph laplacian , @xmath80 , it minimizes the `` distortion '' induced by @xmath81 and measured by the rayleigh ratio @xcite , @xmath82 where @xmath12 is orthogonal to the previous eigenvector @xmath83 .",
    "the gradient of @xmath81 at the vertex @xmath10 on the graph can be computed as a linear combination of terms of the form @xmath84 , where @xmath7 and @xmath5 are connected .",
    "therefore the numerator of the rayleigh ratio ( [ rayleigh ] ) is a weighted sum of the gradients of @xmath81 at all nodes of the graph , and quantifies the average local distortion created by the map @xmath81 .",
    "a function that minimizes ( [ rayleigh ] ) , will still introduce some global distortions .",
    "only an isometry will preserve all distances between the time series , and the isometry which is optimal for dimension reduction is given by pca",
    ". however , as shown in the experiments , the first pca components are usually not able to capture the nonlinear structure formed by the set of time series . as a result , pca fails to reveal the organization of the dataset in terms of low dimensional activated time series and background time series . @xcite",
    "have used kernel pca to analyze the distributions of the coefficients of a model fitted to fmri time series . a block design fmri dataset from a macaque monkey",
    "is studied . by visual inspection ,",
    "the authors show that their method can organize the coefficients according to the relative strength of the activation .",
    "the eigenvectors of the laplacian have also been used to construct maps of spectral coherence of fmri data in @xcite .    _",
    "how many new coordinates do we need ? _",
    "+ we can estimate @xmath67 , the number of coordinates in the embedding ( [ embed ] ) , by calculating the number of @xmath12 needed to reconstruct the low dimensional structures present in the dataset .",
    "as opposed to pca , the embedding defined by ( [ embed ] ) is not designed to minimize the reconstruction error , it only minimizes the average local distortion ( [ rayleigh ] ) .",
    "nevertheless , we can take advantage of the fact that the eigenvectors @xmath85 constitute an orthonormal basis for the set of functions defined on the vertices of the graph @xcite .",
    "in particular , we make the trivial observation that the scan at time @xmath86 , @xmath87^t$ ] , is a function defined on the nodes of the graph : @xmath88 at node @xmath10 is the value of the fmri signal at voxel @xmath5 , @xmath89 .",
    "we can therefore expand @xmath88 using the @xmath12 , @xmath90 where @xmath91 is the approximation to the @xmath92 scan using the first @xmath67 eigenvectors , and @xmath93 is the residual error .",
    "we can compute a similar approximation for all the scans ( @xmath94 ) , and compute the temporal average of the relative approximation error at a given voxel @xmath5 , @xmath95 finally , one can compute the average of @xmath96 over all a group of voxels in the same functional area @xmath97 , @xmath98 .",
    "we expect @xmath99 to decay fast with @xmath67 if the time series within @xmath97 are well approximated by @xmath100 . in practice , for each region @xmath97 we find @xmath101 after which @xmath102 stops having a fast decay .",
    "we then choose @xmath67 the number of coordinates to be the largest @xmath101 among all regions @xmath97 .",
    "examples are shown in fig .",
    "[ checker_embedding]-right , where @xmath67 is chosen at the `` knee '' of the curves @xmath99 .",
    "the map @xmath14 defined by ( [ embed ] ) provides a set of new coordinates , @xmath103 , for each @xmath10 .",
    "we cluster the set @xmath104 into a small number of coherent structures and a large background component .",
    "we use a variation of the @xmath42-means clustering algorithm for this task .",
    "the low dimensional parameterization of the dataset usually has a `` star '' shape ( fig .",
    "[ clusterover]-left ) , where the out - stretching `` arms '' of the star are related to activated time series or strong physiological artifacts , and the center blob corresponds to background activity .",
    "our goal is to segment each of the `` arms '' from the center blob .",
    "we project all the @xmath103 on a unit sphere centered around the origin ( fig .",
    "[ clusterover]-right ) .",
    "we then cluster the projections on the sphere : the distance between two points on the sphere is measured by their angle . the center component ( shown in black in fig .",
    "[ clusterover]-left ) is usually spread all over the sphere , and is mixed with the branches ( fig .",
    "[ clusterover]-right ) .",
    "the time series from the background component can be separated from the other time series by measuring the distance of @xmath103 to the origin ( fig .",
    "[ clusterover]-left ) . the number of clusters    . each dot @xmath5 is @xmath103 , the image of the time series @xmath10 through the mapping @xmath14 .",
    "right : the @xmath103 are projected on the sphere , and the projections are clustered on the sphere .",
    "[ clusterover ] ]    .",
    "each dot @xmath5 is @xmath103 , the image of the time series @xmath10 through the mapping @xmath14 .",
    "right : the @xmath103 are projected on the sphere , and the projections are clustered on the sphere .",
    "[ clusterover ] ]    can be chosen to be equal to @xmath105 .",
    "this choice is based on experience that each eigenvector ( each dimension ) will contribute to an independent arm , and the background time series will contribute to the last cluster .",
    "this choice may over - segment the dataset .",
    "this is usually obvious from the visual inspection scatter plot , and the corresponding spatial maps .",
    "we iteratively refine the estimate of the number of clusters , by merging small clusters at each iteration .",
    "in this section we describe the results of experiments conducted on synthetic and _ in - vivo _ datasets .",
    "we construct the embedding according to the algorithm described in fig  [ algo1 ] , and the clustering algorithm , described in section [ cluster ] , divides the embedded dataset into coherent groups .",
    "we interpret the coherent structures in terms of a task - related hemodynamic response , and physiological artifacts .",
    "voxels that correspond to task - related activation are identified and activation maps are generated accordingly .",
    "we evaluate our approach using two different criteria .",
    "first , we compare the parameterization created by our approach with the parametrization produced by pca .",
    "the comparison is based on    , title=\"fig : \" ] , title=\"fig : \" ]    our ability to identify and extract well defined structures from the new parameterization .",
    "our second criterion is the comparison of the activation maps obtained with our approach with the ones generated by the general linear model ( glm ) .",
    "five datasets are selected for the analysis : a synthetic dataset , a block design dataset , an event - related dataset , and two datasets from the ebc competition @xcite .",
    "the synthetic datasets were designed by blending activation into background , non activated , time - series that were extracted from a real _ in vivo _ dataset ( described in section [ blockdesign ] ) .",
    "we discarded time series exhibiting large variance .",
    "activated time - series were constructed by adding an activation pattern @xmath106 to the background time series .",
    "the activation pattern @xmath106 was obtained by convolving the canonical hemodynamic filter @xmath107 used in spm @xcite @xmath108 with the stimulus time - series @xmath109 ( fig .",
    "[ ground_truth]-left ) .",
    "the two parameters @xmath110 and @xmath111 were randomly distributed according to two uniform distributions , on @xmath112 $ ] and on @xmath113 $ ] respectively .",
    "the other parameters were fixed and chosen as follows , @xmath114 and @xmath115 . by varying @xmath111 and @xmath110 independently",
    ", we generated a family of hemodynamic responses with different peak dispersions and scales .",
    "we generated @xmath116 independent realizations according to this design .",
    "each dataset consisted of a white disk of activated voxels inside a circular gray brain of background voxels ( fig .",
    "[ ground_truth]-left ) .",
    "black voxels were in the air .",
    "there were altogether @xmath117 voxels inside the circular brain , with @xmath118 activated     ( right ) .",
    "[ syn_embedding],title=\"fig : \" ]   ( right ) .",
    "[ syn_embedding],title=\"fig : \" ]     into @xmath119 clusters : activated ( red ) and background ( black ) .",
    "right : activated ( white ) and background ( gray ) pixels .",
    "[ syn_kmean_2clusters],title=\"fig : \" ]   into @xmath119 clusters : activated ( red ) and background ( black ) .",
    "right : activated ( white ) and background ( gray ) pixels .",
    "[ syn_kmean_2clusters],title=\"fig : \" ]    voxels , ( @xmath120 activation ) .",
    "[ syn_embedding]-left shows the projections on the first two principal axes of the @xmath117 time series of one realization .",
    "the projections are color - coded according to their status : activated ( red diamond ) and background ( black circle ) .",
    "the parameterization given by our approach is shown in [ syn_embedding]-right .",
    "we used only @xmath121 coordinates in ( [ embed ] ) for @xmath14 .",
    "activated time series are distributed along a thin strip that extends outward from the main cluster .",
    "this low dimensional structure is compact and easy to identify . in comparison , the two dimensional representation given by pca ( fig .",
    "[ syn_embedding]-left ) is less conspicuous : activated time series ( red ) overlap with background time series ( black ) .",
    "after embedding the dataset into two dimensions , the dataset is partitioned into two clusters .",
    "[ syn_kmean_2clusters]-left shows the result of clustering : the labels ( red for activated , black for background ) are based on the clustering only . the corresponding activation map is shown in fig .",
    "[ syn_kmean_2clusters]-right .",
    "we compared our algorithm with a linear model equipped with the perfect knowledge of the hemodynamic response @xmath107 ( with @xmath122 and @xmath123 ) .",
    "a student @xmath86-test was applied to the regression coefficient to test its significance , and voxels with a @xmath124-value smaller than a threshold were considered activated .",
    "[ roccurves ] provides a quantitative comparison    ]    of our approach with the linear model using a receiver operator characteristic ( roc ) curve . the true activation rate ( one minus the type ii error ) is plotted against the type i error ( false alarm rate ) .",
    "the roc curve was computed over 20 trials .",
    "each trial included different activation strengths @xmath110 . in this experiment , the linear model has access to an oracle , in the form of the perfect knowledge of the hemodynamic response @xmath107 , and should therefore perform very well . in fact , if the noise added to @xmath106 were to be white , we know from the matched filter theorem that the linear model would provide the optimal detector . here",
    ", the noise is extracted from the data , and is probably not white @xcite . as shown in fig .",
    "[ roccurves ] , our approach performs as well as the glm for a type i error in the range [ 0.003,0.009 ] . at low type i error",
    ", our approach misses activations .",
    "we apply our technique to a block design dataset that demonstrates activation of the visual cortex @xcite .",
    "a flashing checkerboard image was presented to a subject for 30 seconds , and a blank image was presented for the next 30 seconds .",
    "this alternating cycle was repeated four times .",
    "images were acquired with a @xmath125 t siemens magnetom vision equipped with a standard quadrature head coil and an echoplanar subsystem ( tr = @xmath126s , xy dimension : @xmath127 , voxel size = @xmath128 mm , 12 contiguous slices ) .",
    "eighty images were obtained .",
    "we analyze a volume that contains the calcicarin cortex ( brodman areas 17 ) ( fig .",
    "[ checker_map ] ) .",
    "there are altogether @xmath129 intracranial time series in the volume .",
    "the linear trend of each time series is removed .",
    "[ checker_embedding]-left displays the image of the time series by the    : cluster  i ( red ) , cluster  ii ( blue ) , cluster  iii ( green ) , and background ( black ) .",
    "time series marked by a circle are shown in fig .",
    "[ checker_kmeans_ts ] .",
    "right : residual error @xmath130 as a function of the number of coordinates @xmath67 .",
    "[ checker_embedding],title=\"fig : \" ] : cluster  i ( red ) , cluster  ii ( blue ) , cluster  iii ( green ) , and background ( black ) .",
    "time series marked by a circle are shown in fig .",
    "[ checker_kmeans_ts ] .",
    "right : residual error @xmath130 as a function of the number of coordinates @xmath67 .",
    "[ checker_embedding],title=\"fig : \" ]    , title=\"fig : \" ] , title=\"fig : \" ]     , title=\"fig : \" ]   , title=\"fig : \" ]     ]    embedding , @xmath131 .",
    "the time series are color - coded according to the result of the clustering .",
    "the dataset is partitioned into four clusters .",
    "for comparison purposes , we show the embedding generated by isomap @xcite ( fig .",
    "[ checker_pca]-left ) , and the embedding obtained by projecting the time series on the first three pca axes ( fig .",
    "[ checker_pca]-right ) .",
    "isomap makes it possible to reconstruct a low dimensional nonlinear structure embedded in high dimension .",
    "the algorithm computes the    @xmath132 @xmath133    pairwise geodesic distance between any two points in the dataset , and uses multidimensional scaling to embed the dataset in low dimension . as explained in section [ commute ] , the geodesic distance is not appropriate for fmri data that are very noisy . for this reason an embedding based on commute time is more robust .",
    "the representation given by pca and isomap , shown in fig .",
    "[ checker_pca ] left and right , are less conspicuous than the representation obtained by our approach .",
    "no low dimensional structures are apparent in these two plots .",
    "the plot of the residual error ( fig . [ checker_embedding]-right ) indicates that eigenvectors @xmath132 and @xmath133 create the largest drop in the residual energy , and should be the most useful .",
    "we use @xmath134 coordinates : @xmath135 and @xmath136 to embed the dataset . in order to interpret the role of the clusters ,",
    "we select several time series from each cluster ( identified by circle in the scatter plot in fig . [ checker_embedding ] ) and",
    "plot them in fig .",
    "[ checker_kmeans_ts ] . the time series from the red cluster ( fig .",
    "[ checker_kmeans_ts]-**a ) are typical hemodynamic responses to a periodic stimulus .",
    "the time series at the tip of the red cluster , marked by a red circle , is the red curve in fig .",
    "[ checker_kmeans_ts]-**a .",
    "it is the strongest activation pattern .",
    "times series in the middle of the red cluster ( blue and black circles ) exhibit weaker activation ( blue and black curves ) .",
    "we interpret cluster  i as voxels activated by the stimulus .",
    "the embedding has organized the time series according to the strength of the activation : strong activation at the tip and weak activation at the base            ) .",
    "[ checker_map],title=\"fig : \" ] ) .",
    "[ checker_map],title=\"fig : \" ]    ) .",
    "[ checker_map],title=\"fig : \" ] ) .",
    "[ checker_map],title=\"fig : \" ]    of the branch ( close to the background activity ) .",
    "the time series from the blue cluster have a high frequency ( fig . [ checker_kmeans_ts]-**b ) , and are grouped together inside the brain ( fig . [ checker_map ] ) .",
    "these time series could be related to non - task related physiological responses , such as a pulsating vein .",
    "finally , the time series from the green cluster are less structured ( fig .",
    "[ checker_kmeans_ts ] ) , and are scattered across the region of analysis ( fig .",
    "[ checker_map ] ) .",
    "we were not able to interpret the physiological role of these time series .",
    "+ _ so what do the eigenvectors look like ? _ + as explained in section [ commute ] , we consider the eigenvectors @xmath12 to be functions of the nodes @xmath5 of the graph .",
    "we can therefore represent @xmath12 as an   is color - coded according to the value of @xmath137 .",
    "the majority of the values of @xmath132 are positive ( deep red , in fig .",
    "[ checker_eigen]-left ) .",
    "a few voxels take negative values ( yellow and cyan in fig . [",
    "checker_eigen]-left ) .",
    "the nodal lines ( where @xmath132 changes sign ) are localized around the area of activation in the visual cortex .",
    "we can check in fig . [ checker_embedding ] that the activated time series ( red cluster ) have a negative @xmath132 coordinate .",
    "in fact , @xmath132 is known as the fiedler vector @xcite and is used to optimally split a dataset into two parts .",
    "[ checker_eigen ] ) .",
    "we computed the activation map obtained using a glm .",
    "the regressor is computed by convolving the haemodynamic response defined by ( [ hrf ] ) with the experimental paradigm . the activation map ( thresholded at @xmath138 ) is shown in fig .",
    "[ checker_map ] , and is consistent with the activation maps obtained by our approach .",
    "we apply our method to an event - related dataset .",
    "@xcite used fmri to study age - related changes in functional anatomy .",
    "the subjects were instructed to press a key with their right index finger upon the visual stimulus onset .",
    "the stimulus lasted for @xmath125s .",
    "functional images were collected using a siemens @xmath125-t vision system with an asymmetric spin - echo sequence sensitive to bold contrast ( volume tr = @xmath139s , xy dimension : @xmath140 , voxel size : @xmath141 mm , 16 contiguous axial slices ) .",
    "each run consists of @xmath142 trs . for every @xmath143 images ,",
    "the subjects were presented with one of the two conditions : ( i ) the _ one - trial _ condition where a single stimulus was presented to the subject , and ( ii ) the _ two - trial _ condition where two consecutive stimuli were presented .",
    "the inter - stimulus interval of @xmath144 was sufficiently large to guarantee that the overall response would be about twice as large as the response to the _ one - trial _ condition .",
    "we analyzed one run .",
    "after discarding the first and last four scans , the run included @xmath145 trials ( @xmath143 _ one - trial _ and @xmath146 _ two trial _ conditions ) of @xmath143 temporal samples .",
    "time series from the _ one - trial _ and _ two - trial _ conditions were averaged separately .",
    "therefore , each voxel gave rise to two average time series of 8 samples .",
    "the linear trend was removed    . [ dem_embedding ] ]    . [ dem_embedding ] ]    ]    ]    from all average time series .",
    "the results published in @xcite show activation in the visual cortex , motor cortex , and cerebellum .",
    "we focus our analysis on four contiguous axial slices ( 7 , 8 , 9 and 10 ) that extend from the superior caudate nucleus to the midlevel diencephalon .",
    "we extract a region ( @xmath147 intracranial voxels ) that extends from the occipital posterior horn of the lateral ventricles until the end of the occipital lobe .",
    "the total number of time series included in our analysis is @xmath148 : two time series ( _ one - trial _ and _ two - trial _ conditions ) of @xmath149 samples for each voxel .",
    "_ embedding the dataset in 3 dimensions _",
    "+ we display in fig .",
    "[ dem_embedding]-left the 2050 time series after embedding the dataset in three dimension .",
    "the _ one - trial _",
    "condition time series ( blue ) form a blob at the center .",
    "the _ two - trial _ ( red ) conditions time series form a `` v '' ( fig .",
    "[ dem_embedding]-right ) .",
    "both branches of the `` v '' are nearly one dimensional and are aligned with @xmath132 and @xmath136 . the branch aligned with @xmath132 also includes _",
    "one - trial _",
    "condition time series at the base of the branch .",
    "the branch aligned with @xmath136 contains only _ two - trial _ condition time series .",
    "the dataset was partitioned into three clusters ( fig .",
    "[ dem_embedding]-right ) .",
    "we compare our embedding to the embedding generated by isomap ( fig .",
    "[ dem_pca]-left ) and pca ( fig .",
    "[ dem_pca]-right ) .",
    "no low - dimensional structures emerge from the representations given by pca or isomap , and _ two - trial _ and _ one - trial _",
    "time series are mixed together .",
    "the eigenvectors @xmath132 and @xmath136 create the largest drop in the residual energy , and are the most useful coordinates .",
    "we use @xmath134 coordinates : @xmath150 and @xmath136 to embed the dataset . to determine the role of the clusters , we select three groups of four time series ( identified by circles in fig . [ dem_embedding]-right ) and we plot them in fig .",
    "[ dementia_kmean_ts ] .",
    "time series from cluster  i all have an abrupt dip at @xmath151 .",
    "the corresponding voxels are located along the border of the brain ( fig .",
    "[ dementia_map ] ) .",
    "the original time series ( before averaging ) suffer from a sudden drop at time 95 , which could be caused by a motion artifact , that affects the average time series .",
    "there are two groups of time series selected from cluster  ii : two _ two - trial _",
    "condition time series located at the tip of the branch , and two _ one - trial _ condition time series located at the border with the background cluster .",
    "time series from cluster  ii have a shape similar to an hemodynamic response ( fig . [ dementia_kmean_ts]-b and c ) , and the corresponding voxels are located in the visual cortex ( fig .",
    "[ dementia_map ] ) . therefore ,",
    "we hypothesize that cluster  ii contains times series recruited by the stimulus .",
    "interestingly , the embedding has organized the time series along the branch     , title=\"fig : \" ]   , title=\"fig : \" ]     ]    of cluster  ii according to the strength of the activation : from _ two - trial _ condition ( strong response ) at the tip , to _ one - trial _",
    "condition ( weak response ) at the stem ( close to the background time series ) .",
    "this is a remarkable result since no information about the stimulus , or the type of trial was provided to the algorithm .",
    "[ dementia_map ] shows the location of the voxels corresponding to the time series of cluster  i ( blue ) and ii ( red ) . for comparison purposes we computed the activation map obtained using the glm .",
    "the averaged time series from the _ two - trial _",
    "condition are used for the regression analysis .",
    "we use the hemodynamic response function defined by @xcite , @xmath152 , where @xmath153 , @xmath154 .",
    "the regressor was given by @xmath155 , where @xmath156 is the stimulus time series .",
    "we thresholded the @xmath124-value at @xmath157 , and the activation maps are shown in fig.[dementia_map ] .",
    "the activation maps constructed by our approach are consistent with the maps obtained with a glm .",
    "we demonstrate here that our method can be used to analyze fmri datasets collected in natural environments where the subjects are bombarded with a multitude of uncontrolled stimuli that can not be quantified @xcite . during such experiments , the subjects are submitted to an abundance of concurrent sensory stimuli , which makes the analysis with inferential methods impossible .",
    "exploratory techniques can help unravel the different neural processes involved during the experiments @xcite .",
    "unlike ica , our approach does not posit the existence of a mixture model .",
    "our approach merely explores the connectivity in the dataset , and proposes a new parameterization that preserves connectivity .    the experience based cognition competition ( ebc ) @xcite offers an opportunity to study complex responses to natural environments .",
    "the ebc datasets comprise three 20-minute runs ( 704 trs in each run ) of subjects interacting in an urban virtual reality environment .",
    "subjects were audibly instructed to complete three search tasks in the environment : looking for weapons ( but not tools ) taking pictures of people with piercing ( but not others ) , or picking up fruits ( but not vegetables ) .",
    "the data was collected with a 3 t epi scanner ( tr = @xmath158s , xy dimension : @xmath159 , voxel size = @xmath160 mm , 34 slices with a thickness of @xmath161 mm ) .",
    "we analyze the second runs of subjects 14 and 13 . for each subject",
    ", the matrix @xmath0 is composed of @xmath162 intra - cranial voxels at @xmath163 trs .",
    "we first remove the non regionally specific variance captured by the first eigenmodes of a singular value decomposition of the dataset .",
    "we then compute @xmath164 using @xmath165 and @xmath166 .",
    "after embedding the dataset into four dimensions , we cluster the voxels . figs .",
    "[ sub14_proj ] and [ sub13_proj ] display the datasets after embedding . because we can not display four dimensions",
    ", we show the projections of the dataset on three consecutive coordinates .",
    "all the coordinates contribute to the spread the dataset along elongated arms , which facilitates the clustering .",
    "voxels that do not correspond to the background activity ( the maroon cluster in figs .",
    "[ sub14_proj ] and [ sub13_proj ] ) are superimposed on anatomically registered structural images and colored according to their cluster label ( see figs .",
    "[ sub14_map ] and [ sub13_map ] ) .",
    "for both subjects , the clusters are connected regions ( see figs .",
    "[ sub14_map ] and [ sub13_map ] ) , compactly organized around functional areas related to the processing of visual , and auditory stimuli ( music , cellphone ringing , dog roaring ) in the virtual environment .",
    "it is important to emphasize that our method never enforces any form of spatial proximity , and is purely based on functional connectivity .    for subject 14 ( fig . [ sub14_map ] ) , the orange cluster corresponds to activation in the calcarine cortex associated with v1/v2 representations of the lower visual fields , while the light blue cluster corresponds to representations of the upper visual fields .",
    "activation in lateral areas ( visual motion areas , mt / v5 ) is also present , as well as activity in the posterior convexial cortex ( area vp ) .",
    "the activation is predominantly in the right hemisphere .",
    "interestingly , the two clusters located in the visual cortex ( light blue and orange ) have very similar @xmath133 and @xmath136 coordinates ( see fig . [ sub14_proj]-left ) .",
    "the cyan cluster corresponds to activation in the right frontal gyrus ( broca area ) associated with language comprehension .",
    "the yellow clusters are located in the right and left superior temporal gyri and medial temporal gyri ( wernicke area ) .",
    "these regions correlate with activation     ( left ) , @xmath167 ( center ) , and @xmath168 ( right ) .",
    "the labels are obtained after clustering the datasets into six clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub14_proj ] ]     ( left ) , @xmath167 ( center ) , and @xmath168 ( right ) . the labels are obtained after clustering the datasets into six clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub14_proj ] ]     ( left ) , @xmath167 ( center ) , and @xmath168 ( right ) . the labels are obtained after clustering the datasets into six clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub14_proj ] ]    in the auditory cortex and language areas .",
    "finally , the dark blue cluster corresponds to activation in the prefrontal cortex . a very similar pattern of activity ( fig . [ sub13_map ] )",
    "was obtained for subject 13 .",
    "the blue and orange clusters , located in the calcarine cortex , correspond to v1 and v2 areas .",
    "again , these two clusters , both located in the visual cortex , have similar @xmath132 and @xmath169 coordinates .",
    "the green cluster is located in the medial temporal gyrus ( wernicke area ) and is associated with language processing .",
    "we replaced the embedding constructed by our method with the parametrization produced by pca , using the same pre - processing steps .",
    "pca was    ]    ]    unable to produce any meaningful activation maps ( results not shown ) .",
    "in fact , the clustering would usually not converge .",
    "interestingly , the activation maps obtained with these natural stimuli are very similar to the extrinsic network , found by @xcite , that is composed of areas dedicated to the processing of sensory information : auditory , visual , somatosensory and language .",
    "we proposed a new method to compute a low dimensional embedding of an fmri dataset .",
    "the embedding preserves the local functional connectivity between voxels , and can be used to cluster the time series into coherent groups .",
    "our approach , based on     ( left ) , @xmath170 ( center ) , and @xmath171 ( right ) .",
    "the labels are obtained after clustering the datasets into five clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub13_proj ] ]     ( left ) , @xmath170 ( center ) , and @xmath171 ( right ) . the labels are obtained after clustering the datasets into five clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub13_proj ] ]     ( left ) , @xmath170 ( center ) , and @xmath171 ( right ) . the labels are obtained after clustering the datasets into five clusters .",
    "the background activity ( maroon cluster ) is centered around 0 .",
    "[ sub13_proj ] ]    a spectral decomposition of commute time , appears to be more robust than a method based on the computation of the geodesic distance between time series @xcite .",
    "our approach is able to detect independently visual areas ( v1/v2 , v5/mt ) , auditory and language areas that are recruited when subjects interacted in an urban virtual reality environment .",
    "we believe that this approach offers a new approach for the analysis of natural stimuli .",
    "the method still requires the visual inspection of the spatial patterns of activations .",
    "this is a standard limitation of exploratory methods .",
    "we are currently exploring methods to combine our approach with standard functional atlases .    ]    ]    _ choice of the parameters _",
    "+ there are only two parameters that determine the embedding : @xmath16 the number of nearest neighbors and the scaling factor @xmath21 .",
    "we described in section [ connectgraph ] a universal choice for @xmath21 .",
    "the number of nearest neighbors can also be chosen according to a universal strategy , @xmath16 can be assigned to the largest power of ten smaller than the number of time samples ( trs ) in the time series .",
    "for instance , for the datasets for the event - related and block design paradigm respectively we used @xmath172 and @xmath173 . the analysis of the ebc datasets that contain @xmath174 trs each required a much larger number of nearest neighbors : @xmath165 .",
    "_ computational complexity _ + the complexity of our method is determined by the combined complexity of the nearest neighbor search and the eigenvalue problem .",
    "we use a brute force approach to search for nearest neighbors .",
    "we use the restarted arnoldi method for sparse matrices implemented by the matlab function eigs to solve the eigenvalue problem .",
    "the algorithm requires @xmath175 storage , and @xmath176 computations .",
    "our matlab code will be made available shortly from our webpage .",
    "the authors are very grateful to the reviewers for their comments and suggestions .",
    "this work was initiated at the institute for pure and applied mathematics , ucla which provided partial support for the authors .",
    "the authors are very grateful to raphy coifman , stphane lafon , and mauro maggioni for introducing them to diffusion maps , and to ivo dinov for making the event - related fmri dataset available for this study .",
    "fgm was on sabbatical at the center for the study of brain , mind and behavior , princeton university , when he performed the analysis of the ebc datasets , and he is very grateful to all the members of the center for their support and insightful discussions .",
    "the hitting time satisfies the following one - step equation , @xmath177 = 1 + \\sum_{k;k\\neq j } p_{i , k}e_i[t_k ] .",
    "\\label{onestep}\\ ] ] iterating this equation yields an expression of @xmath178 $ ] in terms of powers of @xmath59 .",
    "let us define the fundamental matrix @xcite , @xmath179 then we have , @xmath177 = ( z_{j , j } - z_{i , j})/\\pi_j .",
    "\\label{green}\\ ] ] the proof is a straightforward consequence of ( [ onestep ] ) , and can be found in @xcite .",
    "note that @xmath180 is also the green function of the laplacian , which explains the connection with the graph laplacian .",
    "we can consider the eigenvectors @xmath181 of the symmetric matrix @xmath182 and write @xmath59 in ( [ green ] ) in terms of the eigenvectors .",
    "we obtain @xmath183 finally , we note that @xmath184 .",
    "achard , s. , salvador , r. , whitcher , b. , suckling , j. , bullmore , e. , 2006 . a resilient , low - frequency , small - world human brain functional network with highly connected association cortical hubs .",
    "the journal of neuroscience 26(1 ) , 6372 .",
    "bullmore , e. , long , c. , suckling , j. , fadili , j. , calvert , g. , f. zelaya _ et al .",
    "_ , 2001 . colored noise and computational inference in neurophysiological ( ) time series analysis  : resampling methods in time and wavelet domain .",
    "human brain mapping 78 , 6178 .",
    "fox , m. , snyder , a. , vincent , j. , corbetta , m. , , d. , raichle , m. , 2005 .",
    "the human brain is intrinsically organized into dynamic , anticorrelated functional networks .",
    "proc . of the national academy of sciences 102(27 ) , 967378 .",
    "golland , y. , bentin , s. , gelbard , h. , benjamini , y. , heller , r. , nir , y. , hasson , u. , malach , r. , 2007 .",
    "extrinsic and intrinsic systems in the posterior cortex of the human brain revealed during natural sensory stimulation .",
    "cerebral cortex 17 , 766777 ."
  ],
  "abstract_text": [
    "<S> we propose a novel method to embed a functional magnetic resonance imaging ( fmri ) dataset in a low - dimensional space . </S>",
    "<S> the embedding optimally preserves the local functional coupling between fmri time series and provides a low - dimensional coordinate system for detecting activated voxels . to compute the embedding </S>",
    "<S> , we build a graph of functionally connected voxels . </S>",
    "<S> we use the commute time , instead of the geodesic distance , to measure functional distances on the graph . </S>",
    "<S> because the commute time can be computed directly from the eigenvectors of ( a symmetric version ) the graph probability transition matrix , we use these eigenvectors to embed the dataset in low dimensions . after clustering the datasets in low dimensions , </S>",
    "<S> coherent structures emerge that can be easily interpreted . </S>",
    "<S> we performed an extensive evaluation of our method comparing it to linear and nonlinear techniques using synthetic datasets and _ in vivo _ datasets . </S>",
    "<S> we analyzed datasets from the ebc competition obtained with subjects interacting in an urban virtual reality environment . </S>",
    "<S> our exploratory approach is able to detect independently visual areas ( v1/v2 , v5/mt ) , auditory areas , and language areas . </S>",
    "<S> our method can be used to analyze fmri collected during `` natural stimuli '' .    </S>",
    "<S> fmri , laplacian eigenmaps , embedding , natural stimuli . </S>"
  ]
}