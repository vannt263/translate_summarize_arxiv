{
  "article_text": [
    "recently , methods from optimal transport ( ot ) have gained a lot of interest in image processing . in one of the first applications , the wasserstein distance ( earth mover distance ) has been successfully used for image retrieval  @xcite and since then it has been applied to many other tasks as color transfer  @xcite , ( co)segmentation  @xcite , the synthesis and mixing of stationary gaussian textures  @xcite and the computation of barycenters  @xcite .",
    "the basic problem , going back to monge ( 1746 - 1818 ) , can be formulated as follows : given two probability spaces @xmath0 and @xmath1 and a nonnegative cost function @xmath2 on @xmath3 , find a transport map @xmath4 that transports the mass of @xmath5 to the mass of @xmath6 at minimal cost , i.e. , @xmath7 minimizes @xmath8 one of the major limitations in applications using ot is the fact that it is in general not known whether a solution of problem   exists and even in this case the computation of the optimal map @xmath7 is usually a demanding task ( except very few cases , e.g.  ot on @xmath9 with convex costs ) .",
    "we focus in the following on a specific instance of problem  , namely if @xmath10 , @xmath11 and @xmath5 and @xmath6 are absolutely continuous w.r.t .",
    "the lebesgue measure , that means there exist probability density functions @xmath12 and @xmath13 with @xmath14 in this case there exists a unique optimal transport map @xmath7 that transports @xmath12 to @xmath13 , see , e.g. , @xcite . instead of considering a time independent , `` static '' mass transportation problem one may alternatively consider the geodesic path between the two measures w.r.t .   to the wasserstein metric ( the so called displacement interpolation  @xcite ) . while the static problem can be seen as a distance problem ( find the minimal distance between the probability measures @xmath5 and @xmath6 ) , the dynamic problem can be interpreted as a geodesic problem ( find an optimal path between @xmath5 and @xmath6 ) . for the @xmath15 ground cost this geodesic",
    "is obtained by linear interpolation between the identity and the optimal transport map @xmath7 , i.e. , @xmath16 , where @xmath17 .",
    "benamou and brenier @xcite gave the following equivalent formulation of the dynamic ot problem in terms of fluid mechanics : minimize @xmath18 } \\int_{{\\ensuremath{\\mathbb{r}}}^d }   \\frac{1}{2 } f(x , t){\\ensuremath{\\left\\vertv(x , t)\\right\\vert}}^2 \\ , \\text{d}x \\ \\text{d}t,\\label{monge_dynamic}\\ ] ] subject to @xmath19 } \\operatorname{supp}{f(\\cdot , t)}$ ] bounded , @xmath20 and @xmath21 , @xmath22 sufficiently smooth . substituting @xmath23 , this problem becomes convex and can be treated by respective algorithms .",
    "in addition to the dirichlet boundary condition for the time interval , problem   needs to be equipped with spatial boundary conditions in practical applications ( appearing in the momentum variable @xmath24 ) . a natural choice which was also used in @xcite for gray - value images",
    "are neumann boundary conditions . in this paper",
    "we want to deal with color rgb ( red , green , blue ) images .",
    "more precisely , we consider a @xmath25 rgb image as a 3d object of size @xmath26 with the color values in the third dimension , i.e. , we interpret these images as ( realization of ) a 3d density function .",
    "to use neumann boundary conditions for the color dimension is certainly not a good idea since the solution can depend on the ordering of the color channels .",
    "therefore , we suggest to establish periodic boundary conditions in the third dimension . note that we have dirichlet boundary conditions in time , and neumann plus periodic spatial boundary conditions .",
    "[ fig : boundary ] illustrates the effect of the different boundary conditions .",
    "+                     in section  [ sec : model ] we explain the discretization of problem   emphasizing the mixed boundary conditions . in particular we deal with the existence and uniqueness of minimizers .",
    "similarly as suggested in @xcite we apply a primal dual algorithm to find a minimizer in section [ sec : alg ] .",
    "in contrast to @xcite each iteration step of this algorithm requires the solution of a 4d poisson problem with mixed neumann and periodic boundary conditions which can be efficiently computed by applying ffts and fast cosine transforms . in section  [ sec : rgb ] we apply our findings to the dynamic ot of rgb images which was the initial motivation of this work .",
    "another application is given in section [ sec : hue ] . here",
    ", the ( cyclic ) ot is applied to hsv ( hue , saturation , value ) images , where only the cyclic hue component is transported .",
    "for further details we refer to @xcite .",
    "rewriting   for @xmath23 , we see that the geodesic path between measures with probability densities @xmath27 and @xmath28 has density @xmath29 fulfilling @xmath30}\\int_{[0,1]^d } j(m , f ) \\ , \\text{d}x",
    "\\ \\text{d}t,\\ ] ] where @xmath31 @xmath32 with appropriate boundary conditions . in the following ,",
    "we describe the discretization of problem for one spatial dimension with cyclic spatial boundary conditions .",
    "the discretization of the continuity equation demands the evaluation of discrete partial derivatives in time as well as in space . in order to avoid solutions suffering from the well - known checkerboard - effect",
    "( see for instance  @xcite ) we adopt the idea of a staggered grid as in @xcite .",
    "* discretization ( spatial 1d ) : * we consider the values of @xmath33 at spatial cell midpoints @xmath34 , @xmath35 and time @xmath36 , @xmath37 , and denote the corresponding array by @xmath38 .",
    "the boundary values are assumed to be fixed in @xmath39 and @xmath40 , where @xmath41 , @xmath42 and @xmath43 .",
    "we can skip the normalization @xmath44 here .",
    "the values of @xmath24 are taken at the cell faces @xmath45 , @xmath46 and time @xmath47 , @xmath48 and we consider the array @xmath49 , where @xmath50 for neumann boundary conditions and @xmath51 for periodic boundary conditions , see fig .",
    "[ fig : grid ] .",
    "to give a sound matrix - vector notation of the discrete minimization problem we reorder @xmath24 and @xmath33 columnwise into vectors @xmath52 , @xmath53 . since it becomes clear from the context if we deal with arrays or vectors we use the same notation .",
    "the derivatives in @xmath54 are approximated by forward differences and the integral in by a midpoint rule , where the midpoints @xmath55 and @xmath56 are computed by averaging the neighboring two values .",
    "discretization grid for the dynamic ot problem for 1d signals @xmath33 : horizontal direction for time ; vertical direction for space ; @xmath57 given boundary sampling nodes @xmath12 and @xmath13 , @xmath58 sampling nodes for @xmath59 , @xmath60 , @xmath37 , @xmath61 sampling nodes for @xmath24 , + quadrature nodes .",
    ", scaledwidth=25.0% ]    this results in the following discrete model : @xmath62 we denote @xmath63 the involved vectors are defined as @xmath64 and the matrices using the kronecker product @xmath65 as    @xmath66    @xmath67    and @xmath68 @xmath69 @xmath70 @xmath71 since we have to be slightly careful concerning the uniqueness of the solution in the periodic setting we provide the following proposition .",
    "[ existence ] the discrete dynamic transport model has a solution .",
    "for periodic boundary conditions and even @xmath72 , we have @xmath73 with @xmath74 , and @xmath75 otherwise .",
    "the constraints in @xmath76 can be rewritten as @xmath77 with the moore - penrose inverse @xmath78 .",
    "then we obtain @xmath79 with @xmath80 , @xmath81 .",
    "let @xmath82 and assume that @xmath83 is bounded .",
    "then each of the quotients is bounded , i.e. , there exists @xmath84 such that @xmath85 and therefore @xmath86 .",
    "thus , in the case @xmath75 , we get @xmath87 which is not possible as @xmath82 . in the case",
    "@xmath73 we use the orthogonal splitting @xmath88 , where @xmath89 .",
    "straightforward computation shows that @xmath90 with some @xmath91 . since @xmath92",
    ", we conclude @xmath93 if @xmath94 remains finite , then @xmath95 remains finite as well .",
    "since the kernel of @xmath96 consists of constant vectors , this is only possible if @xmath97 is a multiple of @xmath98 .",
    "but in this case @xmath99 has a finite value which is reached .",
    "it remains to consider the case @xmath100 .",
    "then we obtain similarly as in that @xmath101 by we see that this is not possible as @xmath102 . in summary , we have that @xmath83 is coercive and since it is also proper and lower semi - continuous , it has a minimizer .",
    "unfortunately , @xmath103 is not strongly convex on its domain .",
    "as it can be seen in the following lemma it is even not strictly convex .",
    "[ perspective ] for any two minimizers @xmath104 , @xmath105 the relation @xmath106 holds true .    the function @xmath107 is the perspective function of the strictly convex function @xmath108 , i.e. , @xmath109 , see , e.g. , @xcite . for @xmath110 and @xmath111 with @xmath112 , @xmath105",
    ", we have ( componentwise ) @xmath113 and if @xmath114 by the strict convexity of @xmath115 , @xmath116 which proves the assertion .    [ unique ] for periodic boundary conditions ,",
    "even @xmath72 and @xmath117 , @xmath118 the minimizer of is not unique which can be seen as follows : obviously , we would have a minimizer @xmath119 if @xmath120 for some @xmath121 and there exits @xmath122 which fulfills the constraints . setting @xmath123 , @xmath124",
    ", these constraints read @xmath125 .",
    "thus , any @xmath121 such that @xmath126 are nonnegative vectors provides a minimizer of .",
    "we conjecture that the solution is unique in all other cases , but have no proof so far .",
    "we apply the primal - dual algorithm of chambolle and pock @xcite in the form of algorithm 8 in @xcite .",
    "+ @xmath127    [ alg1 ] * step 1 * requires the projection of @xmath128 onto @xmath76 which is given by @xmath129 where @xmath130 has the spectral decomposition @xmath131 and @xmath132 if @xmath133 and zero otherwise . for @xmath134 in the application of @xmath135 requires the solution of a 2d poisson equation . in case of periodic boundary conditions",
    "we get @xmath136 where @xmath137 since @xmath138 with the fourier matrix @xmath139 and @xmath140 with the dct - ii matrix @xmath141 we obtain @xmath142 so that its pseudo - inverse can be computed by the fft and the fast cosine transform .    [ poisson_4d ] for the transport of general 2d rgb images we have analogously to solve a 4d poisson equation with neumann boundary conditions and a periodic boundary condition for the color channels .",
    "* step 2 * of the algorithm can be computed componentwise as proposed in @xcite .",
    "setting @xmath143 , @xmath144 we have to find componentwise @xmath145 setting the gradient to zero yields @xmath146 thus , @xmath147 and @xmath148 is the solution of the third order equation @xmath149 this can be solved by few newton steps which can be computed simultaneously for all components .",
    "alternatively , one may use cardan s formula .",
    "+                  +                  +",
    "in our first experiment we consider the periodic color ot between two rgb images @xmath150 and @xmath151 that are used as densities @xmath12 and @xmath13 respectively . at this point",
    "it is important to choose image pairs which have approximately the same mass ( i.e.  the overall sum of all pixels and color channels ) as one needs to rescale the images such that @xmath152 .",
    "the results of four different examples are shown in fig .",
    "[ fig : rgb_transport ] .",
    "the first row shows an artificial example of the transport between one red gaussian into a blue and a green gaussian with smaller variance . in the second row ,",
    "two polar lights of different color and shape are transported into each other .",
    "the third row illustrates how a topographic map of europe is transported into a satellite image of europe at night .",
    "finally , the last row displays the transport between two cranes in hamburg .",
    "all images are of size @xmath153 and in each case , we used @xmath154 time steps and @xmath155 iterations in our algorithm . note that",
    ", however , already after @xmath156 iterations there are no visible changes any longer .",
    "the images are depicted at intermediate times @xmath157 . in all cases",
    "one nicely sees a continuous change of color and shape during the transport .",
    "in this section we perform color ot in the hsv space .",
    "we assume the final and target image have the same saturation and value such that only the cyclic hue component has to be transported : assume we are given two images @xmath158 , @xmath42 which differ only in the hue component represented by their normalized histograms @xmath159 as empirical densities @xmath160 , @xmath42 .",
    "as the hue component is periodic , this fits into our setting .",
    "the intermediate histograms @xmath161 , @xmath162 are then used to obtain the hue images via histogram specification . together with the original saturation and intensity they yield the images @xmath163 , @xmath162 . for the histogram specification of periodic data we have applied the analysis in  @xcite and the exact histogram specification method for real - valued data proposed , e.g. , in  @xcite .",
    "[ fig : hue_transport ] shows an example , where the histogram of the hue component of a yellow flower is transported into the one of a red flower . the color changes gradually and in a realistic way which would not be the case if the periodicity of the hue histogram is not taken into account .",
    "+   * acknowledgement : * funding by the dfg within the research training group 1932 is gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> recently , papadakis et al .  </S>",
    "<S> @xcite proposed an efficient primal - dual algorithm for solving the dynamic optimal transport problem with quadratic ground cost and measures having densities with respect to the lebesgue measure . </S>",
    "<S> it is based on the fluid mechanics formulation by benamou and brenier  @xcite and proximal splitting schemes . in this paper </S>",
    "<S> we extend the framework to color image processing . </S>",
    "<S> we show how the transportation problem for rgb color images can be tackled by prescribing periodic boundary conditions in the color dimension . </S>",
    "<S> this requires the solution of a 4d poisson equation with mixed neumann and periodic boundary conditions in each iteration step of the algorithm . </S>",
    "<S> this 4d poisson equation can be efficiently handled by fast fourier and cosine transforms . </S>",
    "<S> furthermore , we sketch how the same idea can be used in a modified way to transport periodic 1d data such as the histogram of cyclic hue components of images . </S>",
    "<S> we discuss the existence and uniqueness of a minimizer of the associated energy functional . </S>",
    "<S> numerical examples illustrate the meaningfulness of our approach . </S>"
  ]
}