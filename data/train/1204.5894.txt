{
  "article_text": [
    "constructing a confidence interval for a proportion @xmath0 based on a binomial sample is a basic but important problem in statistics . due to the discreteness of the binomial distribution ,",
    "it is not possible to construct confidence intervals with exact coverage .",
    "thus an interval based on normal approximation , known as the wald interval , is taught in virtually every introductory statistics course .",
    "the interval is @xmath1 , where @xmath2 is the sample proportion , @xmath3 and @xmath4 is the @xmath5th percentile of the standard normal distribution .",
    "numerous authors have remarked on the surprisingly poor performance of the wald interval .",
    "errors in the approximation due to discreteness and skewness ( for small @xmath0 ) can have significant impact on the coverage of the interval even for large @xmath6 . in recent years",
    ", its weaknesses have been thoroughly investigated in comparisons of confidence intervals for @xmath0 .",
    "@xcite gave examples of the erradic behaviour of the wald interval , compared several intervals in terms of coverage and expected length and obtained general asymptotic results using edgeworth expansions .",
    "@xcite compared twenty methods using different criteria . for recent developments and discussions ,",
    "see for instance @xcite .",
    "a natural alternative to the wald interval is the clopper - pearson interval @xcite .",
    "it is based on the inversion of the equal - tailed binomial test and hence the interval contains all values of @xmath0 that are nt rejected by the test at confidence level @xmath7 .",
    "the lower limit is thus given by the value of @xmath8 such that @xmath9 and the upper limit is given by the @xmath10 such that @xmath11 the computation of @xmath8 and @xmath10 is simplified by the following equality from @xcite : @xmath12 where @xmath13 is the density function of a @xmath14 random variable .",
    "consequently , the endpoints of the clopper - pearson interval @xmath15 are beta quantiles : @xmath16 @xmath17 is exact in the sense that the minimum coverage over all @xmath0 is at least @xmath18 . for most values of @xmath0 however , especially values close to 0 or 1 , it is far too conservative , giving a coverage that is much larger than the nominal coverage .",
    "as several authors have pointed out @xcite it is often more natural to study the _",
    "mean _ coverage rather than the minimum coverage . in this paper",
    "we construct coverage - adjusted clopper - pearson intervals with the mean coverage in mind , combining bayesian and frequentist reasoning .",
    "the intervals are adjusted to have mean coverage @xmath18 with respect to either a prior or a posterior distribution of @xmath0 .",
    "the corrected intervals are seen to have several desirable properties in the frequentist setting .",
    "a class of coverage - adjusted clopper - pearson intervals is introduced in section [ coverage ] . in section [ comparisons ] these intervals are compared to other popular intervals and new heatmap - style plots for comparing confidence intervals are introduced .",
    "the text concludes with a discussion in section [ discussion ] and an appendix with proofs , tables and several figures .",
    "as has already been mentioned , @xmath17 is often unnecessarily conservative .",
    "this is illustrated in figure [ cpcov ] .",
    "it is clear from the figure that if we are willing to accept an interval which has a coverage less than @xmath18 for _ some _ values of @xmath0 , the performance of @xmath17 can be improved by choosing a larger @xmath7 , in which case the actual coverage would be closer to the desired coverage for _ most _ values of @xmath0 .",
    "the question , then , is how to choose the new @xmath7 .",
    "we propose that @xmath19 should be chosen to satisfy a mean coverage criterion .",
    "let @xmath20 be a density function on @xmath21 .",
    "a mean coverage corrected @xmath18 clopper - pearson interval @xmath22 is given by the unique solution to @xmath23 where @xmath19 satisifies @xmath24",
    "i.e. @xmath19 is such that the mean coverage of @xmath25 with respect to @xmath26 is @xmath18 .",
    "note that this simply is the ordinary @xmath27 clopper - pearson interval , with @xmath19 chosen so that the mean coverage is @xmath18 .",
    "what differs is that @xmath19 needs to be determined before the endpoints are computed .",
    "it should be pointed out that the adjusted intervals inherit important properties from @xmath17 .",
    "they are fully boundary - respecting , so that @xmath28 , and equivariant in the sense of @xcite , meaning that the corresponding interval for @xmath29 is @xmath30 .",
    "furthermore , they have very favourable location properties in terms of the box - cox index of symmetry and balance of mesial and distal non - coverage , as described by @xcite .",
    "finally , the minimum coverage over all @xmath0 is guaranteed to be at least @xmath27 .",
    "the choice of @xmath26 affects the performance of @xmath25 greatly .",
    "@xmath26 can be thought of as a weight function on @xmath21 , used to put more weight on the performance for certain parts of the parameter space . in the following",
    ", we will refer to @xmath26 as being either a prior or posterior density , to show the connection between this weight function and bayesian ideas .",
    "the use of a prior distribution @xmath26 for coverage - adjustments can be motivated by the fact that in virtually all investigations , the experimenters will have some prior idea about how large @xmath0 is .",
    "in particular , it is often clear beforehand if @xmath0 is close to or far away from @xmath31 .",
    "@xmath17 is symmetric in @xmath0 in the sense that the interval has the same properties for @xmath0 and @xmath29 .",
    "for this reason , it is reasonable to use a symmetric prior for @xmath0 .",
    "@xmath32 priors , being conjugate priors of the binomial distribution , are a natural choice here .",
    "we divide the parameter space into three cases :    _ @xmath0 close to 0 or 1 .",
    "_ when @xmath0 is small , a prior with @xmath33 should be used , as such priors put more weight on the tails of the distribution .",
    "we will use the @xmath34 prior in the following , but smaller @xmath35 can certainly be used .",
    "the coverage - adjustments will generally be larger for small @xmath0 , as the overcoverage of @xmath17 is largest in this part of the parameter space .    _",
    "@xmath0 close to 1/4 or 3/4 .",
    "_ for medium - sized @xmath0 , we wish to put approximately the same weight on the tails and the centre of the distribution .",
    "the uniform @xmath36 prior is ideal for this .",
    "the resulting interval will however give a slight undercoverage for @xmath0 closer to 1/2 , so if there is some worry that that @xmath0 may be above 0.40 , say , a prior with @xmath35 slightly greater than 1 could be used . the interval constructed using the uniform prior seems to coincide with a corrected interval that was described informally by @xcite .    _",
    "@xmath0 close to 1/2 .",
    "_ if @xmath0 is believed to be closer to @xmath31 , a prior with @xmath37 is recommendable .",
    "we will use the @xmath38 prior .",
    "the coverage - adjustments will be smaller in this part of the parameter space , as @xmath17 comes closest to attaining its nominal coverage around @xmath39 .    .",
    "]      having used priors for coverage correction , it seems natural to consider using a posterior distribution of @xmath0 for coverage - adjustments , in order to get closer to the nominal coverage in areas of the parameters space that given the data are more likely to contain @xmath0 .    with a @xmath14",
    "prior for @xmath0 , the posterior distribution is @xmath40 with density function @xmath41 where @xmath42 is the beta function .",
    "thus the posterior coverage corrected clopper - pearson interval @xmath25 is , given @xmath43 , determined by the condition ( [ condition ] ) with the function @xmath44 in the comparison later in the text , we will use the @xmath34 , @xmath36 and @xmath38 priors , with the same reasoning as in the previous section .",
    "conditioning the coverage - adjustments on the data may seem hazardous in a frequentist setting , but as we will demonstrate in section [ comparisons ] , this approach leads to short confidence intervals with good coverage properties .      while @xmath19 can be approximated by using an asymptotic expansion for the coverage to solve the equation ( [ condition ] ) approximately , it is more convenient to use a numerical method with exact coverages .",
    "the following lemma ensures that @xmath45 is continuous and decreasing in @xmath19 .",
    "this guarantees that @xmath19 easily can be found numerically by using for instance bisection to solve the equation @xmath46 .",
    "the proof of the lemma is given in the appendix , along with a table of @xmath19 for different choices of @xmath7 and @xmath6 for @xmath47 .",
    "[ app1 ] let @xmath48 be the @xmath18 clopper - pearson interval and let @xmath49 , @xmath50 , be the density of the @xmath14 distribution .",
    "the mean coverage of @xmath51 with respect to the density @xmath52 , @xmath53 is continuous and strictly decreasing in @xmath7 .",
    "the algorithm for finding @xmath19 using bisection is as follows .",
    "given a tolerance @xmath54 , @xmath7 , @xmath6 and a density @xmath26 :    1 .",
    "start with an initial lower bound @xmath55 and an upper bound @xmath56 .",
    "the initial guess is @xmath57 .",
    "2 .   set @xmath58 .",
    "3 .   while @xmath59 : * if @xmath60 then @xmath61 , @xmath62 and @xmath63 .",
    "* else @xmath64 , @xmath65 and @xmath63 . * @xmath66 .",
    "4 .   @xmath67 .",
    "for the algorithm to converge , two conditions must be satisfied .",
    "first , @xmath68 , i.e. @xmath19 must not exceed the upper bound .",
    "second , @xmath69 must be computed with sufficient precision ( @xmath54 determines what is sufficient ) .",
    "implementations of the above algorithm in r and ms excel are available from the author .",
    "we illustrate the use of the coverage - adjustments with clinical data from an influenza vaccine study performed by @xcite .",
    "@xmath70 fully vaccinated children younger than 2 years were included in the study .",
    "@xmath71 of these contracted influenza during the 2007 - 08 influenza season .",
    "the @xmath72 clopper - pearson interval for the proportion of vaccinated children younger than 2 years that will contract influenza is @xmath73 . using a prior @xmath36 correction",
    ", we get @xmath74 . letting @xmath75",
    "be the quantile function of the @xmath14 distribution , the coverage - adjusted confidence interval is @xmath76 using a posterior @xmath34 correction , @xmath77 and the interval is @xmath78 .",
    "following the comparison performed by @xcite , two confidence intervals for @xmath0 have emerged as being the intervals to which all other intervals should be compared .",
    "these are the wilson and jeffreys prior intervals , presented next .    _ the wilson interval .",
    "_ like the wald interval , the @xcite score interval is based on an inversion of the large sample normal test @xmath79 where @xmath80 is the standard error of @xmath81 . unlike the wald interval , however , the inversion is obtained using the null standard error @xmath82 instead of the sample standard error @xmath83 .",
    "the solution of the resulting quadratic equation leads to the confidence interval @xmath84 @xmath85 typically has coverage close to the nominal coverage and comparatively short expected length .",
    "indeed , it can be shown @xcite that @xmath85 has some near - optimal length properties among intervals with nominal coverage @xmath18 .",
    "@xmath85 is therefore the natural benchmark for new confidence intervals .",
    "the main drawback of @xmath85 is that its coverages oscillates too much for fixed @xmath6 and @xmath0 close to 0 or 1 .",
    "recently , @xcite proposed a small modification of the interval that solves this problem .",
    "the improved coverage comes at the cost of a slightly wider interval .",
    "as the results of our comparison would not change qualitatively if the guan interval were to be used instead of @xmath85 , we stick to the more familiar unmodified version .    _",
    "the jeffreys prior interval .",
    "_ let @xmath86 and let @xmath0 have prior distribution @xmath14 .",
    "then the posterior distribution is @xmath40 and letting @xmath87 denote the @xmath7-quantile of the @xmath14 distribution , a @xmath88 bayesian interval is @xmath89",
    "@xcite used the uniform prior @xmath90 in their comparison , whereas @xcite used the jeffreys prior @xmath91 .",
    "the difference between the two intervals is small .",
    "we use the latter and denote it @xmath92 .",
    "@xmath92 has performance close to that of the @xmath85 , and is often prefered when @xmath0 is believed to be close to 0 or 1 .      in figure [ figcov1 ]",
    "the actual coverages of some confidence intervals with nominal coverage @xmath72 are shown for @xmath93 when @xmath94 .",
    "all intervals are equivariant in the sense that the coverage is the same for @xmath0 and @xmath29 .",
    "note that the coverages have been computed exactly ( up to machine epsilon ) and thus havent been obtained by simulation .",
    "the wilson interval has fairly good coverage properties when @xmath0 is nt close to 0 , in which case it oscillates wildly .",
    "the jeffreys prior interval has similar coverage , except for one big dip for a moderately sized @xmath0 .",
    "the coverage - adjusted intervals tend to have good coverage properties in the areas dictated by the prior distribution used for the adjustment .",
    "some of the prior corrected intervals suffer from either undercoverage or overcoverage for the parts of the parameter space that @xmath26 put low weight on .",
    "the expected length of the intervals are shown in figure [ figlen1 ] . in many cases ,",
    "the corrected intervals have shorter expected length than the wilson and jeffreys prior intervals . for some intervals , this is due to undercoverage caused by @xmath26 putting more weight on a different part of the parameter space , but in some cases it is a consequence of a succesful correction .    in order to compare intervals over the entire parameter space for different values of @xmath6 , we use heatmap - type plots in figures [ figexp1]-[figexp6 ] . studying the plots for coverage and",
    "expected length at the same time gives us a good way of comparing the intervals .",
    "the heatmap - type plots , combined with more traditional plots such as those in figures [ figcov1]-[figlen1 ] , give a more complete comparison of different intervals than what has previously been possible .",
    "the wilson interval is compared to the prior corrected clopper - pearson @xmath36 interval in figures [ figexp1]-[figexp2 ] and to the posterior corrected clopper - pearson @xmath95 interval in figures [ figexp3]-[figexp4 ] .",
    "the corrected intervals simultaneously offer greater coverage and shorter expected length for small @xmath0 .",
    "the difference is larger for small @xmath6 and is particularly noticeable at the 99 % confidence level .    in the comparison between the jeffreys prior interval and",
    "the posterior corrected clopper - pearson @xmath95 interval in figures [ figexp5]-[figexp6 ] , the corrected interval is found to offer at least as short intervals with the same actual coverage as the jeffreys prior interval .",
    "we introduced coverage - adjusted clopper - pearson intervals , where the intervals are adjusted to give mean coverage @xmath18 with respect to either a prior or posterior distribution of @xmath0 .",
    "we investigated the properties of several such intervals .",
    "the numerical results were presented graphically , partially with new heatmap - type plots .    in the comparison with the benchmark wilson and jeffreys prior intervals , we found the coverage - adjusted clopper - pearson intervals to be preferable if @xmath0 is believed to be close to 0 or 1 , as these intervals have both better coverage and shorter expected length in this setting .",
    "we have thus seen that it is possible to improve upon the wilson and jeffreys prior intervals for @xmath0 close to 0 or 1 , if we are willing to accept that we use intervals that may have bad coverage properties in regions of the parameter space that are far from where our prior information indicates that @xmath0 is .    in conclusion ,",
    "the coverage - adjusted clopper - pearson intervals seem to be strong competitors against other methods for constructing confidence intervals for small binomial proportions . for @xmath0",
    "closer to 0.5 , the wilson interval seems to be preferable .",
    "the extension of the ideas presented here to one - sided intervals and to other distributions , such as the poisson and negative binomial distributions is straightforward .",
    "likewise , it should be possible to apply such corrections to tests about the difference of two binomial proportions .",
    "it remains to be seen whether the corrections yield intervals with interesting properties in these cases as well .    apart from mean coverage , several other conditions can be used to ensure that the coverage is close to @xmath18 on average .",
    "examples include median coverage conditions , minimum mean squared coverage error conditions and minimum absolute coverage error conditions .",
    "the author wishes to thank an anonymous reviewer and silvelyn zwanzig for several helpful comments and sven erick alm , who proposed the idea of a posterior correction .",
    "all figures were produced using r.",
    "changing the order of summation of integration , the mean coverage can be rewritten as @xmath96 since sums of continuous functions are continuous , it suffices to show that @xmath97 is continuous for fixed @xmath43 , @xmath6 , @xmath35 and @xmath98 . seeing as @xmath99 ,",
    "this definite integral is a polynomial in @xmath100 and @xmath101 .",
    "since the quantile functions of the beta distributions , and thus the limits of integration , are continuous in @xmath7 , the continuity of @xmath102 in @xmath7 follows .",
    "similarly , as @xmath100 is strictly increasing in @xmath7 and @xmath101 is strictly decreasing in @xmath7 , and since @xmath103 for all @xmath0 , the definite integral ( [ cont1 ] ) is strictly decreasing in @xmath7 .",
    "@xmath102 is the sum of @xmath104 strictly decreasing functions and thus also strictly decreasing .      for a given prior distribution , @xmath19 is easily computed numerically given @xmath6 , @xmath7 and , in the case of a posterior correction , @xmath43 .",
    "we give a table of @xmath19 for the prior corrected clopper - pearson @xmath36 interval as an example .",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the prior corrected interval has greater coverage , in the white points the wilson interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the prior corrected interval has greater coverage , in the white points the wilson interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the posterior corrected interval has greater coverage , in the white points the wilson interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the posterior corrected interval has greater coverage , in the white points the wilson interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the posterior corrected interval has greater coverage , in the white points the bayesian jeffreys prior interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "intervals for different @xmath6 and @xmath0 . in the black points",
    "the posterior corrected interval has greater coverage , in the white points the bayesian jeffreys prior interval has greater coverage and in the grey points the intervals have equal coverage ( when rounded to 3 decimal places ) . ]",
    "heinonen , s. , silvennoinen , h. , lehtinen , p , et al .",
    "( 2011 ) , effectiveness of inactivated influenza vaccine in children aged 9 months to 3 years : an observational cohort study , _ the lancet infectious diseases _ , vol .",
    "23 - 29        krishnamoorthy , k. , peng , j. ( 2007 ) , some properties of the exact and score methods for binomial proportion and sample size calculation , _ communications in statistics - simulation and computation _ , vol .",
    "1171 - 1186"
  ],
  "abstract_text": [
    "<S> we consider the classic problem of interval estimation of a proportion @xmath0 based on binomial sampling . </S>",
    "<S> the  exact  </S>",
    "<S> clopper - pearson confidence interval for @xmath0 is known to be unnecessarily conservative . </S>",
    "<S> we propose coverage - adjustments of the clopper - pearson interval using prior and posterior distributions of @xmath0 . </S>",
    "<S> the adjusted intervals have improved coverage and are often shorter than competing intervals found in the literature . using new heatmap - type plots for comparing confidence intervals , we find that the coverage - adjusted intervals are particularly suitable for @xmath0 close to 0 or 1 </S>",
    "<S> . + * keywords : * binomial distribution ; confidence interval ; proportion . </S>"
  ]
}