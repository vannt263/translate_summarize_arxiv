{
  "article_text": [
    "a fundamental result of extremal graph theory is the hajnal - szemerdi theorem , which states that if @xmath1 divides @xmath2 then any graph @xmath3 on  @xmath2 vertices with minimum degree @xmath4 contains a perfect @xmath0-packing , i.e.  a spanning collection of vertex - disjoint @xmath1-cliques .",
    "this paper considers a conjecture of fischer  @xcite on a multipartite analogue of this theorem .",
    "suppose @xmath5 are disjoint sets of @xmath2 vertices each , and @xmath3 is a @xmath1-partite graph on vertex classes @xmath5 ( that is , @xmath3 is a graph on the vertex set @xmath6 such that no edge of @xmath3 has both endvertices in the same @xmath7 ) .",
    "we define the _ partite minimum degree _ of @xmath3 , denoted @xmath8 , to be the largest @xmath9 such that every vertex has at least @xmath9 neighbours in each part other than its own , i.e.@xmath10 } \\min_{v \\in v_i } \\min_{j \\in [ k]{\\setminus}\\{i\\ } } |n(v ) \\cap v_j|,\\ ] ] where @xmath11 denotes the neighbourhood of @xmath12 .",
    "fischer conjectured that if @xmath13 then @xmath3 has a perfect @xmath0-packing .",
    "this conjecture is straightforward for @xmath14 , as it is not hard to see that any maximal matching must be perfect .",
    "however , magyar and martin  @xcite constructed a counterexample for @xmath15 , and furthermore showed that their construction gives the only counterexample for large @xmath2 .",
    "more precisely , they showed that if @xmath2 is sufficiently large , @xmath3 is a @xmath16-partite graph with vertex classes each of size  @xmath2 and @xmath17 , then either  @xmath3 contains a perfect @xmath18-packing , or @xmath2 is odd and divisible by @xmath16 , and @xmath3 is isomorphic to the graph @xmath19 defined in construction  [ fischereg ] .",
    "the implicit conjecture behind this result ( stated explicitly by khn and osthus  @xcite ) is that the only counterexamples to fischer s original conjecture are the constructions given by the graphs @xmath20 defined in construction  [ fischereg ] when @xmath2 is odd and divisible by @xmath1 .",
    "we refer to this as the modified fischer conjecture . if @xmath1 is even then @xmath2 can not be both odd and divisible by  @xmath1 , so the modified fischer conjecture is the same as the original conjecture in this case .",
    "martin and szemerdi  @xcite proved that ( the modified ) fischer s conjecture holds for @xmath21 .",
    "another partial result was obtained by csaba and mydlarz  @xcite , who gave a function @xmath22 with @xmath23 as @xmath24 such that the conjecture holds for large @xmath2 if one strengthens the degree assumption to @xmath25 .",
    "recently , an approximate version of the conjecture assuming the degree condition @xmath26 was proved independently and simultaneously by keevash and mycroft  @xcite , and by lo and markstrm  @xcite . the proof in @xcite was a quick application of the geometric theory of hypergraph matchings developed in the same paper ; this will be formally introduced in the next section . by a careful analysis of the extremal cases of this result ,",
    "we will obtain the following theorem , the case @xmath27 of which shows that ( the modified ) fischer s conjecture holds for any sufficiently large graph .",
    "note that the graph @xmath28 in the statement is defined in construction  [ fischereg ] .",
    "[ partitehajnalszem ] for any @xmath29 there exists @xmath30 such that for any @xmath31 with @xmath32 the following statement holds .",
    "let @xmath3 be a @xmath33-partite graph whose vertex classes each have size  @xmath2 such that @xmath34 .",
    "then @xmath3 contains a perfect @xmath0-packing , unless @xmath35 is odd , @xmath36 , and @xmath37 .",
    "we now give the generalised version of the construction of magyar and martin  @xcite showing fischer s original conjecture to be false .",
    "[ fischereg ] suppose @xmath35 is odd and @xmath1 divides @xmath2 .",
    "let @xmath38 be a vertex set partitioned into parts @xmath39 of size @xmath2 .",
    "partition each @xmath40 , @xmath41 $ ] into subparts @xmath42 , @xmath43 $ ] of size @xmath44 .",
    "define a graph @xmath28 , where for each @xmath45 $ ] with @xmath46 and @xmath43 $ ] , if @xmath47 then any vertex in @xmath42 is adjacent to all vertices in @xmath48 with @xmath49 { \\setminus}\\{j\\}$ ] , and if @xmath50 or @xmath51 then any vertex in @xmath42 is adjacent to all vertices in @xmath48 with @xmath49 { \\setminus}\\{3-j\\}$ ] .     for the case @xmath52.,width=226 ]    figure  [ fig : construct ] shows construction  [ fischereg ] for the case @xmath52 . to avoid complicating the diagram ,",
    "edges between @xmath53 and @xmath54 are not shown : these are analogous to those between @xmath53 and @xmath55 and between @xmath55 and @xmath54 . for @xmath56",
    "this is the exact graph of the construction ; for larger @xmath2 we ` blow up ' the graph above , replacing each vertex by a set of size @xmath44 , and each edge by a complete bipartite graph between the corresponding sets . in general",
    ", it is helpful to picture the construction as an @xmath33 by @xmath1 grid , with columns corresponding to parts @xmath40 , @xmath41 $ ] and rows @xmath57 } v^j_i$ ] , @xmath43 $ ] corresponding to subparts of the same superscript .",
    "vertices have neighbours in other rows and columns to their own , except in rows @xmath58 and @xmath59 , where vertices have neighbours in other columns in their own row and other rows besides rows @xmath58 and @xmath59 .",
    "thus @xmath60 .",
    "we claim that there is no perfect @xmath0-packing . for any @xmath0",
    "has at most one vertex in any @xmath61 with @xmath47 , so at most @xmath62 vertices in @xmath63 .",
    "also @xmath64 , and there are @xmath35 copies of @xmath0 in a perfect packing .",
    "thus each @xmath0 must have @xmath62 vertices in @xmath63 , and so @xmath65 vertices in @xmath66 , which must either both lie in @xmath58 or both lie in @xmath59 .",
    "however , @xmath67 is odd , so @xmath58 can not be perfectly covered by pairs .",
    "thus @xmath3 contains no perfect @xmath0-packing .",
    "this paper is organised as follows . in the next section",
    "we introduce ideas and results from  @xcite on perfect matchings in @xmath1-graphs .",
    "section  [ sec : outline ] gives an outline of the proof of theorem  [ partitehajnalszem ] . in sections  [ sec : blocks ] to  [ sec : proof2 ] we prove several preliminary lemmas , before combining these lemmas in section  [ proof ] to prove theorem  [ partitehajnalszem ]",
    ".    * notation . *",
    "the following notation is used throughout the paper : @xmath68=\\{1 , \\dots , k\\}$ ] ; if @xmath69 is a set then @xmath70 is the set of subsets of @xmath69 of size @xmath1 ; @xmath71 means that for every @xmath72 there exists some @xmath73 such that the subsequent statement holds for any @xmath74 ( such statements with more variables are defined similarly ) .",
    "if @xmath75 is a vertex in a graph then @xmath76 is the neighbourhood of @xmath75 .",
    "in this section we describe the parts of the geometric theory of perfect matchings in hypergraphs from  @xcite that we will use in the proof of theorem  [ partitehajnalszem ] .",
    "we start with some definitions .",
    "a _ hypergraph _",
    "@xmath3 consists of a vertex set @xmath38 and an edge set @xmath77 , where each edge @xmath78 is a subset of @xmath38 .",
    "we say that @xmath3 is a _",
    "@xmath1-graph _ if every edge has size @xmath1 .",
    "a _ matching _",
    "@xmath79 in @xmath3 is a set of vertex - disjoint edges in @xmath3 .",
    "we call @xmath79 _ perfect _ if it covers all of @xmath38 .",
    "we identify a hypergraph @xmath80 with its edge set , writing @xmath81 for @xmath82 , and @xmath83 for @xmath84 .",
    "@xmath1-system _ is a hypergraph @xmath85 in which every edge of @xmath85 has size at most @xmath1 and @xmath86 .",
    "we refer to the edges of size @xmath33 in @xmath85 as _ @xmath33-edges of  @xmath85 _ , and write @xmath87 to denote the @xmath33-graph on @xmath88 formed by these edges .",
    "a _ @xmath1-complex _",
    "@xmath85 is a @xmath1-system whose edge set is closed under inclusion , i.e.  if @xmath89 and @xmath90 then @xmath91 . for any non - empty @xmath1-graph @xmath3 , we may generate a @xmath1-complex @xmath92 whose edges are any @xmath93 such that @xmath94 for some edge @xmath95 .",
    "let @xmath38 be a set of vertices , and let @xmath96 partition @xmath38 into parts @xmath97 of size @xmath2 .",
    "then we say that a hypergraph @xmath3 with vertex set @xmath38 is @xmath96-partite if @xmath98 for every @xmath41 $ ] and @xmath99 .",
    "we say that @xmath3 is @xmath33-partite if it is @xmath96-partite for some partition @xmath96 of @xmath38 into @xmath33 parts .",
    "let @xmath85 be a @xmath96-partite @xmath1-system on @xmath38 .",
    "for each @xmath100 we define the _ partite minimum @xmath101-degree _ @xmath102 as the largest @xmath9 such that any @xmath101-edge @xmath103 has at least @xmath9 extensions to a @xmath104-edge in any part not intersected by @xmath103 , i.e.@xmath105 the _ partite degree sequence _ is @xmath106 .",
    "note that we suppress the dependence on @xmath96 in our notation : this will be clear from the context .",
    "note also that this is _ not _ the standard notion of degree used in @xmath1-graphs , in which the degree of a set is the number of edges containing it .",
    "our minimum degree assumptions will always be of the form @xmath107 pointwise for some vector @xmath108 , i.e.  @xmath109 for @xmath110 .",
    "it is helpful to interpret this ` dynamically ' as follows : when constructing an edge of @xmath111 by greedily choosing one vertex at a time , there are at least @xmath112 choices for the @xmath113st vertex ( this is the reason for the requirement that @xmath114 , which we need for the first choice in the process ) .",
    "the following key definition relates our theorems on hypergraphs to graphs .",
    "fix @xmath29 and a partition @xmath96 of a vertex set @xmath38 into @xmath33 parts @xmath97 of size @xmath2 .",
    "let @xmath3 be an @xmath96-partite graph on @xmath38 .",
    "then the _ clique @xmath1-complex _ @xmath115 of @xmath3 is the @xmath1-complex whose edges of size @xmath116 are precisely the copies of @xmath117 in @xmath3 for @xmath118 .",
    "note that @xmath115 must be @xmath96-partite .",
    "furthermore , if @xmath119 and @xmath120 , then the vertices of any copy of @xmath117 in @xmath3 have at least @xmath121 common neighbours in each @xmath7 which they do not intersect . that is , if @xmath3 satisfies @xmath119 , then the clique @xmath1-complex @xmath115 satisfies @xmath122 note also that any perfect matching in the @xmath1-graph @xmath123 corresponds to a perfect @xmath0-packing in @xmath3 .",
    "so if we could prove that any @xmath96-partite @xmath1-complex @xmath85 on @xmath38 which satisfies  @xmath124 must have a perfect matching in the @xmath1-graph @xmath111 , then we would have already proved theorem  [ partitehajnalszem ] ! along these lines ,",
    "theorem  2.4 in  @xcite shows that any such @xmath85 must have a matching in @xmath111 which covers all but a small proportion of the vertices of @xmath85 .",
    "( here we assume @xmath125 ) .",
    "however , two different families of constructions show that this condition does not guarantee a perfect matching in @xmath111 ; we refer to these as _ space barriers _ and _ divisibility barriers_. we will describe these families in some detail , since the results of  @xcite show that these are essentially the only @xmath1-complexes @xmath85 on @xmath38 which satisfy ( [ eq : mindeg ] ) but do not have a perfect matching in @xmath111 .",
    "firstly , space barriers are characterised by a bound on the size of the intersection of every edge with some fixed set @xmath126 .",
    "if @xmath127 is too large , then @xmath111 can not contain a perfect matching .",
    "the following construction gives the precise formulation .",
    "[ spacebarpartite ] ( space barriers ) suppose @xmath96 partitions a set @xmath38 into @xmath33 parts @xmath39 of size @xmath2 .",
    "fix @xmath128 $ ] and a set @xmath129 containing @xmath130 vertices in each part  @xmath7 .",
    "then we denote by @xmath131 the @xmath1-complex in which @xmath132 ( for @xmath133 ) consists of all @xmath96-partite sets @xmath134 of size @xmath116 that contain at most @xmath101 vertices of @xmath127 .",
    "observe that @xmath135 for @xmath136 and @xmath137 for @xmath138 , so ( [ eq : mindeg ] ) is satisfied .",
    "however , any matching in @xmath111 has size at most @xmath139 and so leaves at least @xmath140 vertices uncovered .    having described the general form of space barriers , we now turn our attention to divisibility barriers .",
    "these are characterised by every edge satisfying an arithmetic condition with respect to some partition @xmath141 of @xmath38 . to be more precise , we need the following definition .",
    "fix any partition @xmath141 of a vertex set @xmath38 into @xmath142 parts @xmath143 . for any @xmath141-partite set @xmath144 ( that is , @xmath127 has at most one vertex in each part of @xmath141 ) , the _ index set of @xmath127 with respect to @xmath141 _ is @xmath145 : |s \\cap v_i| = 1\\}$ ] . for general sets @xmath144 , we have the similar notion of the _ index vector of @xmath127 with respect to @xmath141 _ ; this is the vector @xmath146 in @xmath147 .",
    "so @xmath148 records how many vertices of @xmath127 are in each part of @xmath141 . observe that if @xmath127 is @xmath141-partite then @xmath149 is the characteristic vector of the index set @xmath150 .",
    "when @xmath141 is clear from the context , we write simply @xmath150 and @xmath149 for @xmath151 and @xmath148 respectively , and refer to @xmath150 simply as the _ index _ of @xmath127 .",
    "we will consider the partition @xmath141 to define the order of its parts so that @xmath148 is well - defined .",
    "[ divbar ] ( divisibility barriers ) suppose @xmath141 partitions a set @xmath38 into @xmath142 parts , and @xmath152 is a lattice in @xmath147 ( i.e.  an additive subgroup ) with @xmath153 .",
    "fix any @xmath154 , and let @xmath3 be the @xmath1-graph on @xmath38 whose edges are all @xmath1-tuples @xmath103 with @xmath155 . for any matching @xmath79 in @xmath3 with vertex set @xmath156",
    "we have @xmath157 . since we assumed that @xmath153 it follows that @xmath3 does not have a perfect matching .",
    "for the simplest example of a divisibility barrier take @xmath158 and @xmath159 .",
    "so @xmath160 precisely when @xmath75 is even .",
    "then the construction described has @xmath161 odd , and the edges of @xmath3 are all @xmath1-tuples @xmath162 such that @xmath163 is even . if @xmath164 and @xmath165 , then any set of @xmath166 vertices of @xmath3 is contained in around @xmath167 edges of @xmath3 , but @xmath3 contains no perfect matching .",
    "we now consider the multipartite setting .",
    "let @xmath96 partition a vertex set @xmath38 into parts @xmath97 of size @xmath2 , and let @xmath141 be a partition of @xmath38 into @xmath142 parts @xmath168 which refines @xmath96 .",
    "then we say that a lattice @xmath169 is _ complete with respect to @xmath96 _ if @xmath152 contains every difference of basis vectors @xmath170 for which @xmath171 and @xmath172 are contained in the same part @xmath173 of @xmath96 , otherwise we say that @xmath152 is _ incomplete with respect to @xmath96_. the idea behind this definition is that if @xmath152 is incomplete with respect to @xmath96 , then it is possible that @xmath174 , in which case we would have a divisibility barrier to a perfect matching , whilst if @xmath152 is complete with respect to @xmath96 then this is not possible .",
    "there is a natural notion of minimality for an incomplete lattice @xmath152 with respect to @xmath96 : we say that @xmath141 is _ minimal _ if @xmath152 does not contain any difference of basis vectors @xmath175 for which @xmath176 are contained in the same part @xmath173 of @xmath96 .",
    "for suppose @xmath152 does contains some such difference @xmath175 and form a partition @xmath177 from @xmath141 by merging parts @xmath171 and @xmath172 of @xmath141 .",
    "let @xmath178 be the lattice formed by this merging ( that is , by replacing the @xmath116th and @xmath101th coordinates with a single coordinate equal to their sum ) .",
    "then @xmath179 is also incomplete with respect to @xmath96 , so we have a smaller divisibility barrier .",
    "let @xmath85 be an @xmath33-partite @xmath1-complex whose vertex classes @xmath97 each have size @xmath2 .",
    "the next theorem , theorem  2.9 from  @xcite , states that if @xmath85 satisfies ( [ eq : mindeg ] ) and @xmath111 is not ` close ' to either a space barrier or a divisibility barrier , then @xmath111 contains a perfect matching .",
    "moreover , we can find a perfect matching in @xmath111 which has roughly the same number of edges of each index .",
    "more precisely , for a perfect matching @xmath79 in @xmath111 and a set @xmath180}{k}$ ] let @xmath181 be the number of edges @xmath182 with index @xmath183 .",
    "we say that @xmath79 is _ balanced _ if @xmath181 is constant over all @xmath180}{k}$ ] , that is , if there are equally many edges of each index .",
    "similarly , we say that @xmath79 is _ @xmath184-balanced _ if @xmath185 for any @xmath186}{k}$ ] . finally , we formalise the notion of closeness to a space or divisibility barrier as follows .",
    "let @xmath3 and @xmath80 be @xmath1-graphs on a common vertex set @xmath38 of size  @xmath2 .",
    "we say @xmath3 is _ @xmath187-contained _ in @xmath80 if all but at most @xmath188 edges of @xmath3 are edges of @xmath80 .",
    "also , given a partition @xmath96 of @xmath38 into @xmath142 parts , we define the _ @xmath189-robust edge lattice _",
    "@xmath190 to be the lattice generated by all vectors @xmath191 such that there are at least @xmath192 edges @xmath99 with @xmath193 .    [ partitematching ] suppose that @xmath194 , @xmath29 and @xmath32 .",
    "let  @xmath195 partition a set @xmath38 into parts @xmath97 each of size  @xmath2 .",
    "suppose that @xmath85 is a @xmath195-partite @xmath1-complex with @xmath196 then @xmath85 has at least one of the following properties .    1 ( matching ) : :    @xmath111 contains a @xmath184-balanced perfect    matching .",
    "2 ( space barrier ) : :    @xmath111 is @xmath187-contained in    @xmath197 for some @xmath128 $ ] and    @xmath129 with    @xmath198 vertices in each    @xmath40 , @xmath41 $ ] .",
    "3 ( divisibility barrier ) : :    there is some partition @xmath96 of    @xmath88 into @xmath199 parts of size at least    @xmath200 such that    @xmath96 refines @xmath195 and    @xmath201 is incomplete with respect to    @xmath195 .",
    "note that the fact that the perfect matching in @xmath111 is @xmath184-balanced in the first property is not stated in the statement of the theorem in  @xcite .",
    "however , examining the short derivation of this theorem from theorem  7.11 in  @xcite shows this to be the case .",
    "-partite graph @xmath3 into @xmath65 rows.,width=377 ]    in this section we outline the proof of theorem  [ partitehajnalszem ] . for ease of explanation",
    "we restrict to the case when @xmath3 is an @xmath33-partite graph whose vertex classes each have size @xmath202 and @xmath203 .",
    "our strategy consists of the following three steps :    a.   impose a row structure on @xmath3 .",
    "b.   find balanced perfect clique - packings in each row . c.   glue together the row clique - packings to form a @xmath0-packing of @xmath3 .",
    "for step ( i ) we partition @xmath204 into _ blocks _ @xmath205 , so that each vertex class @xmath7 is partitioned into @xmath206 blocks @xmath207 .",
    "this partition is best thought of as a @xmath208 grid , with rows @xmath209 } x^i_j$ ] and columns the vertex classes @xmath210 } x^i_j$ ] .",
    "we insist that all the blocks in a given row @xmath211 have equal size @xmath212 , where @xmath213 } p_i = k$ ] .",
    "we call a partition of @xmath204 which satisfies these conditions an _ @xmath206-row - decomposition _ of @xmath3 .",
    "we also require that @xmath3 has density close to @xmath214 between any two blocks which do not lie in the same row or column ( we refer to the smallest such density as the _ minimum diagonal density _ ) .",
    "figure  [ fig : decomp ] illustrates this structure .",
    "we begin with the trivial 1-row - decomposition of @xmath3 with a single row ( so the blocks are the vertex classes @xmath7 ) .",
    "if it is possible to split this row into two rows to obtain a row - decomposition with minimum diagonal density at least @xmath215 ( where @xmath142 will be small ) , then we say that @xmath3 is _",
    "@xmath142-splittable_. if so , we partition @xmath3 in this manner , and then examine in turn whether either of the two rows obtained is splittable ( for some larger value of @xmath142 ) . by repeating this process , we obtain a row - decomposition of @xmath3 with high minimum diagonal density in which no row is splittable ; this argument is formalised in lemma  [ iterate ] .    for step ( ii )",
    "we require a balanced perfect @xmath216-packing in each row @xmath211 .",
    "we first use the results of section  [ sec : theory ] to obtain a near - balanced perfect @xmath216-packing in @xmath217 $ ] . fix @xmath116 and",
    "take @xmath85 to be the clique @xmath218-complex of @xmath217 $ ] .",
    "so we regard the row @xmath211 as an @xmath33-partite vertex set whose parts are the blocks @xmath219 , and the edges of @xmath220 are the @xmath101-cliques in @xmath217 $ ] for @xmath221 .",
    "the assumption @xmath203 implies that @xmath222 then theorem  [ partitematching ] ( with @xmath218 playing the role of @xmath1 ) implies that @xmath223 contains a near - balanced perfect matching , unless @xmath223 is close to a space or divisibility barrier . in section  [ sec : blocks ] we consider a space barrier , showing in lemma  [ splittable ] that since @xmath217 $ ] is not @xmath142-splittable , @xmath223 can not be close to a space barrier .",
    "we then consider a divisibility barrier in section  [ sec : div ] . for @xmath224 , lemma  [ split ]",
    "shows that since @xmath217 $ ] is not @xmath142-splittable , @xmath223 also can not be close to a divisibility barrier .",
    "however , the analogous statement for @xmath225 is false , for the following reason .",
    "we say that @xmath217 $ ] is ` pair - complete ' if it has a structure close to that which appears in rows @xmath58 and @xmath59 of construction [ fischereg ] .",
    "that is , there is a partition of @xmath211 into ` halves ' @xmath127 and @xmath226 , such that each vertex class @xmath7 is partitioned into two equal parts , and both @xmath227 $ ] and @xmath228 $ ] are almost complete @xmath33-partite graphs .",
    "such a row is not @xmath142-splittable if @xmath33 is odd , but @xmath229 is close to a divisibility barrier .",
    "however , lemma  [ 2splitorpc ] shows that this is essentially the only such example , that is , that if @xmath225 and @xmath217 $ ] is neither @xmath142-splittable nor pair - complete then @xmath230 is not close to a divisibility barrier .",
    "so unless @xmath225 and @xmath217 $ ] is pair - complete , theorem  [ partitematching ] implies that @xmath223 contains a near - balanced perfect @xmath216-packing .",
    "in section  [ sec : packing ] we then show that we can actually obtain a balanced perfect matching in @xmath223 .",
    "indeed , in lemma  [ theoremmatching ] we first delete some ` configurations ' from @xmath217 $ ] ; these are subgraphs of @xmath217 $ ] that can be expressed as two disjoint copies of @xmath216 in @xmath217 $ ] in two different ways ( with different index sets ) .",
    "after these deletions we proceed as just described to find a near - balanced perfect @xmath216-packing in @xmath217 $ ] . then by carefully choosing which pair of disjoint edges to add to the matching from each ` configuration ' , we obtain a balanced perfect @xmath216-packing in @xmath217 $ ] , as required .",
    "this leaves only the case where @xmath225 and @xmath217 $ ] is pair - complete ; in this case lemma  [ paircompletematching ] gives a balanced perfect @xmath231-packing in @xmath217 $ ] , provided that each half has even size .    for step ( iii )",
    ", we construct auxiliary hypergraphs , perfect matchings in which describe how to glue together the perfect @xmath216-packings in the rows into a perfect @xmath0-packing of @xmath3 .",
    "recall that the row - decomposition of @xmath3 was chosen to have large minimum diagonal density , so almost every vertex of any block @xmath205 has few non - neighbours in any block @xmath232 in a different row and column .",
    "assume for now that this row - decomposition of @xmath3 has the stronger condition of large _ minimum diagonal degree _",
    ", i.e.  that we can delete ` almost ' from the previous statement . for each row @xmath116 , we partition its perfect @xmath216-packing into sets @xmath233 , one for each injective function @xmath234 \\to [ r]$ ] .",
    "for each @xmath235 we then form an auxiliary @xmath206-partite @xmath206-graph @xmath236 , where for each @xmath237 $ ] the @xmath116-th vertex class of @xmath236 is the set @xmath233 ( so a copy of @xmath216 in @xmath217 $ ] is a vertex of @xmath236 ) .",
    "edges in @xmath236 are those @xmath206-tuples of vertices for which the corresponding copies of @xmath216 together form a copy of @xmath0 in @xmath3 .",
    "we defer the details of the partition to the final section of this paper ; the crucial point is that the large minimum diagonal degree of @xmath3 ensures that each @xmath236 has sufficiently large vertex degree to guarantee a perfect matching .",
    "taking the copies of @xmath0 in @xmath3 corresponding to the union of these matchings gives a perfect @xmath0-packing in @xmath3 , completing the proof .",
    "the above sketch glosses over the use of the precise minimum degree condition in theorem  [ partitehajnalszem ] . indeed , to replace our minimum diagonal density condition with a minimum diagonal degree condition",
    ", we must remove all ` bad ' vertices , namely those which have many non - neighbours in some block in a different row and column . to achieve this , before step ( ii )",
    "we delete some vertex - disjoint copies of @xmath0 from @xmath3 which cover all bad vertices .",
    "we must ensure that the number of vertices deleted from row @xmath211 is a constant multiple of @xmath218 for each @xmath116 , so that we will be able to join together the @xmath216-packings of the undeleted vertices of each @xmath211 to form a @xmath0-packing of @xmath3 .",
    "we also need to ensure that each half has even size in pair - complete rows .",
    "this is accomplished in section  [ sec : proof2 ] , which is the most lengthy and technical part of the paper .",
    "after this , it is fairly quick to complete the proof as outlined above in section  [ proof ] .",
    "in this section we formalise our description of row - decompositions and the iterative process of splitting rows described in section  [ sec : outline ] .",
    "we then show that the clique @xmath238-complex of any row obtained at the end of this process is not close to a space barrier .",
    "fix @xmath239 , and let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 each of size @xmath202 .",
    "suppose @xmath240 $ ] and @xmath218 , @xmath237 $ ] are positive integers with @xmath213 } p_i = k$ ] . write @xmath241)$ ] . an _ @xmath206-row - decomposition _",
    "@xmath242 , j \\in [ r]}$ ] of @xmath3 ( of _ type _ @xmath238 ) , consists of subsets @xmath243 with @xmath244 for each @xmath237 $ ] and @xmath245 $ ] such that each @xmath7 is partitioned by the sets @xmath205 with @xmath237 $ ] .",
    "we refer to the sets @xmath205 as the _ blocks _ , and the sets @xmath246 for @xmath237 $ ] as the _ rows_. we call the parts @xmath247 for @xmath245 $ ] the _ columns _ , so @xmath3 has @xmath206 rows and @xmath33 columns .",
    "given subsets @xmath248 of different vertex classes of @xmath3 , let @xmath249 $ ] denote the bipartite subgraph of @xmath3 induced by @xmath250 .",
    "we write @xmath251|$ ] and define the _ density _ of @xmath3 between @xmath252 and @xmath253 as @xmath254 .",
    "we usually write @xmath255 and @xmath256 , as @xmath3 is clear from the context .",
    "the _ minimum diagonal density _ of @xmath3 is defined to be the minimum of @xmath257 over all @xmath258 and @xmath259 .",
    "if @xmath3 has only one row then for convenience we define the minimum diagonal density of @xmath3 to be @xmath214 .",
    "note that all this terminology depends on the choice of row - decomposition of @xmath3 , but this will be clear from the context .    for any @xmath237 $ ] with @xmath260 we may obtain an @xmath261-row - decomposition of @xmath3 by partitioning the row @xmath211 of @xmath3 .",
    "indeed , choose positive integers @xmath262 and @xmath263 with @xmath264 .",
    "for each @xmath245 $ ] partition @xmath205 into sets @xmath265 and @xmath266 with @xmath267 and @xmath268 .",
    "take @xmath269 , @xmath270 and @xmath271 for each @xmath272 { \\setminus}\\{i\\}$ ] , and for each @xmath245 $ ] let @xmath273 , @xmath274 and @xmath275 for each @xmath272 { \\setminus}\\{i\\}$ ] .",
    "then the blocks @xmath276 form an @xmath261-row - decomposition of @xmath3 of type @xmath277)$ ] .",
    "bearing in mind the proof strategy sketched above , we are happy to split rows provided that we keep the minimum diagonal density close to @xmath214 . thus we make the following definition .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 each of size @xmath278 .",
    "we say @xmath3 is _",
    "@xmath142-splittable _ if for some @xmath279 $ ] we may choose sets @xmath280 , @xmath41 $ ] with @xmath281 , such that for any @xmath282 $ ] with @xmath258 we have @xmath283 .",
    "it is helpful to think of @xmath3 as being a row - decomposition with just one row ; then @xmath3 is @xmath142-splittable if it is possible to partition this row into two rows as described above so that the minimum diagonal density is at least @xmath215 .",
    "note that this definition depends on @xmath238 , however this will always be clear from the context .",
    "note also that @xmath3 can never be @xmath142-splittable if @xmath284 .",
    "the next proposition shows that we can iteratively split @xmath3 until we reach a row - decomposition which has high minimum diagonal density and does not have any splittable row .",
    "[ iterate ] suppose that @xmath285 and @xmath239 .",
    "let @xmath3 be a @xmath33-partite graph on vertex classes @xmath97 each of size @xmath202 .",
    "then for some @xmath240 $ ] there exists an @xmath206-row - decomposition @xmath69 of @xmath3 with minimum diagonal density at least @xmath286 such that each row @xmath217 $ ] of @xmath3 is not @xmath287-splittable .",
    "initially we take the trivial @xmath214-row - decomposition of @xmath3 with one row whose blocks are the vertex classes @xmath97 of @xmath3 .",
    "we now repeat the following step . given an @xmath206-row - decomposition of @xmath3 , if every row @xmath217 $ ] is not @xmath287-splittable , then terminate .",
    "alternatively , if @xmath217 $ ] is @xmath287-splittable for some @xmath237 $ ] , according to some sets @xmath288 , @xmath245 $ ] , then partition each block @xmath205 into two blocks @xmath289 and @xmath290 to obtain an @xmath261-row - decomposition of @xmath3 .    since @xmath217 $ ]",
    "can only be @xmath287-splittable if @xmath260 , this process must terminate with @xmath291 .",
    "then we have an @xmath206-row - decomposition of @xmath3 all of whose rows are not @xmath287-splittable , so it remains only to show that @xmath3 has minimum diagonal density at least @xmath292 .",
    "if @xmath293 then this is true by definition , so we may assume @xmath294 .",
    "consider any rows @xmath258 and columns @xmath259 .",
    "since @xmath205 and @xmath232 do not lie in the same row of @xmath3 , at some point in the process we must have partitioned blocks @xmath295 and @xmath296 into @xmath289 , @xmath297 and @xmath298 , @xmath299 with @xmath300 and @xmath301 respectively . since @xmath302 $ ] was @xmath303-splittable for some @xmath304 , we have @xmath305 .",
    "then , since @xmath306 and @xmath307 , we have @xmath308 , as required .",
    "let @xmath3 be an @xmath33-partite graph whose vertex classes have size @xmath278 with @xmath309 , and let @xmath310 be the clique @xmath238-complex of @xmath3 . in this section we show that if @xmath3 is not @xmath142-splittable then there is no space barrier to a perfect matching in @xmath311 .",
    "we shall use this result in combination with the results of the next section to find a perfect clique packing in each row .",
    "we also prove that if @xmath312 then @xmath3 contains many copies of @xmath313 ; this result will play an important role in the proof of lemma  [ diagonalmindeg ] .",
    "[ splittable ] suppose that @xmath314 and @xmath315 .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 each of size @xmath278 with @xmath309 .",
    "suppose that @xmath3 is not @xmath142-splittable .",
    "then    a.   for any @xmath279 $ ] and sets @xmath280 , @xmath41 $ ] of size @xmath316 there are at least @xmath317 copies of @xmath318 in @xmath3 with more than @xmath319 vertices in @xmath227 $ ] , where @xmath320 } s_i$ ] , and b.   if @xmath321 then there are at least @xmath322 copies of @xmath313 in @xmath3 .    for ( i ) , since @xmath3 is not @xmath142-splittable , we may suppose that @xmath323 .",
    "let @xmath252 be the set of vertices in @xmath324 with fewer than @xmath325 neighbours in @xmath326 .",
    ". then @xmath328 , so @xmath329 .",
    "we now greedily form a copy of @xmath330 in @xmath227 $ ] by choosing a vertex @xmath331 for each @xmath332 $ ] in turn ( in increasing order ) .",
    "we do this so that @xmath333 and @xmath334 for any @xmath335 .",
    "there are @xmath336 suitable choices for  @xmath337 . for each @xmath338",
    "we have chosen @xmath339 vertices prior to choosing @xmath340 , so there are at least @xmath341 suitable choices for @xmath340 . finally , since @xmath333 has at least @xmath342 non - neighbours in @xmath326 , and at most @xmath343 non - neighbours in @xmath344 in total , it has fewer than @xmath345 non - neighbours in @xmath346 .",
    "this means that there are at least @xmath347 suitable choices for @xmath348 .",
    "together we conclude that there are at least @xmath349 copies of @xmath330 in @xmath227 $ ] .",
    "each such copy can be extended to a copy of @xmath350 in @xmath3 with more than @xmath319 vertices in @xmath127 by choosing @xmath351 for each @xmath352 in turn , so that each @xmath340 chosen is a neighbour of every @xmath353 with @xmath354 . for each @xmath352",
    "there are at least @xmath355 suitable choices for @xmath340 , so we obtain at least @xmath356 such copies of @xmath350",
    ".    for ( ii ) , introduce new constants with @xmath357 , and suppose for a contradiction that there are fewer than @xmath322 copies of @xmath313 in @xmath3 .",
    "say that a vertex @xmath358 is _ bad _ if it lies in at least @xmath359 copies of @xmath313 in @xmath3 , and let @xmath69 be the set of all bad vertices .",
    "then @xmath360 , so @xmath361 .",
    "we now show that for any @xmath41 $ ] , any vertex @xmath362 has at most @xmath363 neighbours in @xmath364 for any @xmath365 .",
    "without loss of generality we consider the case @xmath366 , i.e.  @xmath367 .",
    "suppose for a contradiction that @xmath368 for some @xmath101 , say @xmath369 .",
    "then we may greedily form a copy of @xmath313 in @xmath3 containing @xmath12 by choosing @xmath370 with @xmath371 for each @xmath116 so that each @xmath372 is a neighbour of @xmath373 .",
    "we have at least @xmath374 choices for each @xmath372 with @xmath375 , and at least @xmath376 choices for @xmath377 .",
    "thus there are at least @xmath378 copies of @xmath313 in @xmath3 containing @xmath12 , a contradiction to @xmath379 .",
    "now we fix some @xmath367 and use the neighbourhood of @xmath12 to impose structure on the rest of the graph .",
    "we choose a set @xmath380 of size @xmath381 which contains or is contained in @xmath382 for each @xmath383 .",
    "if @xmath384 for some @xmath385 with @xmath386 , then as in part ( i ) we can find at least @xmath387 copies of @xmath350 in @xmath388 .",
    "at least @xmath389 of these are contained in @xmath11 , and so form copies of @xmath313 with @xmath12 , another contradiction .",
    "so we may suppose that @xmath390 for any @xmath391 with @xmath386 .",
    "we now partition @xmath53 into sets @xmath392 as follows .",
    "let @xmath252 consist of all vertices @xmath393 with @xmath394 for every @xmath395 .",
    "let @xmath253 consist of all vertices @xmath393 with @xmath396 for every @xmath395 .",
    "let @xmath397 consist of all remaining vertices of @xmath53 .",
    "next we bound the sizes of each of these sets . by definition of @xmath252",
    "we have @xmath398 , so some vertex in @xmath399 has at most @xmath400 neighbours in @xmath252 .",
    "so @xmath401 , from which we obtain @xmath402 .",
    "next note that by definition of  @xmath253 we have @xmath403 .",
    "so at least @xmath167 vertices of @xmath399 have at least @xmath404 neighbours in @xmath253 .",
    "at least one of these vertices is not bad , so by our earlier observation has at most @xmath363 neighbours in @xmath53 .",
    "then @xmath405 , so @xmath406 .",
    "to bound @xmath407 we show that @xmath408 .",
    "consider any vertex @xmath409 . without loss of generality @xmath410 and @xmath411 .",
    "choose greedily a vertex @xmath412 for each @xmath413 so that @xmath414 is a neighbour of @xmath415 and satisfies @xmath416 . to see that this is possible for each @xmath413 ,",
    "note that since @xmath417 , at most @xmath418 vertices @xmath412 fail the latter condition .",
    "note also that at most @xmath419 vertices @xmath412 fail the neighbourhood condition . for @xmath420",
    "this gives at least @xmath167 suitable choices for @xmath414 . on the other hand , for @xmath421 we have @xmath411 , which implies that @xmath422 , so we have at least @xmath423 suitable choices for @xmath414 .",
    "so we may form at least @xmath424 copies of @xmath350 containing @xmath425 in this manner . by construction",
    ", each @xmath414 in any such copy has at most @xmath426 non - neighbours in @xmath427 .",
    "since @xmath425 has at least @xmath428 neighbours in @xmath427 , we find a total of at least @xmath429 copies of @xmath313 in @xmath3 containing @xmath425 , so @xmath430 .",
    "we deduce that @xmath431 , so @xmath432 .",
    "we therefore have @xmath433 , so @xmath434 .",
    "let @xmath324 be a set of size @xmath435 which either contains or is contained in @xmath253 .",
    "then for any @xmath395 we have @xmath436 , so @xmath437 . also , at most @xmath438 vertices of @xmath439 lie in @xmath440 , so for any @xmath395 we have @xmath441 .",
    "but @xmath442 , so we obtain @xmath443 , and so @xmath444 .",
    "recall also that @xmath390 for any @xmath391 with @xmath386 . since @xmath445",
    "we conclude that @xmath3 is @xmath142-splittable with respect to the sets @xmath289 for @xmath245 $ ] .",
    "this is a contradiction , so ( ii ) holds .",
    "let @xmath3 be an @xmath33-partite graph with vertex classes of size @xmath278 such that @xmath309 , and let @xmath446 be the clique @xmath238-complex of @xmath3 . in the previous section we saw that if @xmath3 is not @xmath142-splittable ( for small @xmath142 ) , then there is no space barrier to a perfect matching in @xmath311 .",
    "in this section we instead consider divisibility barriers . indeed",
    ", we shall see in the second subsection that if @xmath447 and @xmath3 is not @xmath142-splittable , then @xmath311 can not be close to a divisibility barrier .",
    "however , for @xmath448 there is another possibility , namely that @xmath3 has the structure of @xmath66 in construction [ fischereg ] .",
    "there we described both @xmath58 and @xmath59 as rows , but with the terminology of the previous section they should be considered as a single row .",
    "we consider this case in the first subsection .",
    "note that here we have @xmath449 .",
    "let @xmath3 be an @xmath33-partite graph with vertex classes @xmath39 each of size @xmath450 .",
    "we say that @xmath3 is _ @xmath142-pair - complete _ ( with respect to @xmath451 } s_j$ ] ) if there exist sets @xmath452 , @xmath245 $ ] each of size @xmath2 such that @xmath453 , @xmath454 and @xmath455 for any @xmath456 $ ] with @xmath386 .",
    "that is , @xmath3 consists of two _ halves _ @xmath127 and @xmath457 , where each half is an almost - complete @xmath33-partite graph , and there are few edges between halves .",
    "we will show that if @xmath3 is close to a divisibility barrier , then @xmath3 is either @xmath142-splittable or @xmath142-pair - complete . for this",
    "we need the following proposition .",
    "[ auxgraph ] let @xmath239 and @xmath80 be an @xmath33-partite graph whose parts @xmath39 each have size @xmath65 .",
    "suppose that @xmath458 , and for any @xmath459 such that @xmath460 for every @xmath245 $ ] there is    * an edge @xmath461 with @xmath462 or @xmath463 , and * an edge @xmath461 with @xmath464 and @xmath465 .",
    "then for some @xmath466 we have @xmath467 .",
    "it is sufficient to find a path of even length between the two vertices of some vertex class @xmath7 . for suppose",
    "@xmath468 are the edges of such a path , starting at @xmath75 and ending at @xmath262 , for some @xmath466 .",
    "then @xmath469 } ( \\chi(e_{2j-1 } ) - \\chi(e_{2j}))$ ] , as required .",
    "suppose for a contradiction that there is no such path .",
    "then for any @xmath470 $ ] with @xmath386 , any vertex @xmath471 must have precisely one neighbour in @xmath7 .",
    "indeed , @xmath12 must have at least one neighbour in @xmath7 since @xmath458 , but can not have two since then we obtain a path of length two between these two neighbours in @xmath7 .",
    "so for any @xmath386 the graph @xmath472 $ ] consists of two disjoint edges .",
    "write @xmath473 , and for each @xmath474 let @xmath371 be adjacent to @xmath475 and @xmath476 be adjacent to @xmath477 .",
    "there are then two possibilities for @xmath478 $ ] .",
    "the first case is that @xmath479 is adjacent to @xmath480 and @xmath481 to @xmath482 . by property ( ii ) of @xmath483 , there must be some edge @xmath484 .",
    "fix such an @xmath116 and @xmath101 , and consider the paths @xmath485 and @xmath486 between @xmath480 and @xmath482 .",
    "they have lengths @xmath487 and @xmath488 , which must both be odd , so @xmath489 and @xmath33 are both even .",
    "this argument shows that @xmath490 must be even for any edge @xmath491 .",
    "so by property ( i ) of @xmath492 there must be an edge @xmath493 or @xmath494 such that @xmath490 is even . without loss of generality we may assume the former , and that @xmath495 . if @xmath496 then @xmath497 is a path whose length is congruent to @xmath498 modulo @xmath65 , giving a contradiction .",
    "on the other hand , if @xmath499 then let @xmath500 be a path from @xmath501 to @xmath502 not containing @xmath503 ( this must exist since @xmath504 and @xmath501 all lie on the cycle @xmath505 ) . then @xmath506 is a path whose length is congruent to @xmath507 modulo @xmath65 , again giving a contradiction .",
    "the second case is that @xmath479 is adjacent to @xmath482 and @xmath481 to @xmath480 .",
    "then @xmath508 must have odd length , so @xmath33 is odd . by property ( i ) of @xmath509 we must have either an edge @xmath484 with @xmath489 odd , or an edge @xmath510 with @xmath489 even , or an edge @xmath511 with @xmath489 even .",
    "in the first case @xmath485 is a path of even length @xmath487 . on the other hand , for the second case we may assume that @xmath512 , whereupon @xmath513 is a path of even length @xmath514 , and the third case is similar .",
    "thus we have a contradiction in all cases , so the required path exists .",
    "now we can deduce the required structure for divisibility barriers in @xmath3 when @xmath448 .",
    "[ 2splitorpc ] suppose that @xmath515 and @xmath239 .",
    "let @xmath195 partition a set @xmath38 into parts @xmath97 each of size @xmath450 .",
    "suppose @xmath3 is a @xmath195-partite graph with @xmath516 , and that there exists a partition @xmath96 refining @xmath195 into parts each of size at least @xmath517 such that @xmath518 is incomplete with respect to @xmath195 .",
    "then @xmath3 is @xmath142-splittable or @xmath142-pair - complete .",
    "we can assume that @xmath518 is minimal .",
    "recall that this means that @xmath518 does not contain any difference of basis vectors @xmath175 , for some @xmath386 that index subparts of the same part of @xmath195 .",
    "thus for any @xmath456 $ ] with @xmath519 , distinct parts @xmath252 , @xmath253 of @xmath96 contained in @xmath40 , and part @xmath520 of @xmath96 contained in @xmath7 , we can not have both @xmath521 and @xmath522 .",
    "since all parts of @xmath96 have size at least @xmath517 , each part of @xmath195 is partitioned into at most two parts of @xmath96 .",
    "we can assume that @xmath96 is a strict refinement of @xmath195 , so without loss of generality @xmath96 partitions @xmath53 into two parts @xmath523 and @xmath524 .",
    "next we note that there can not be any part @xmath7 that is not partitioned into two parts by @xmath96 . for otherwise ,",
    "letting @xmath525 , @xmath526 and @xmath527 , we have @xmath528 and @xmath529 , which contradicts minimality , as described above .",
    "thus each @xmath7 is partitioned into two parts @xmath530 and @xmath531 by @xmath96 .",
    "form an auxiliary graph @xmath80 on @xmath532 vertices , where for each @xmath533 and @xmath245 $ ] we have a vertex @xmath534 of @xmath80 corresponding to the part @xmath535 of @xmath96 , and we have an edge @xmath536 if and only if @xmath537 .",
    "since @xmath516 and each part of @xmath96 has size at least @xmath517 , we have @xmath458 .",
    "also , minimality of @xmath518 means that @xmath538 for all @xmath245 $ ] .",
    "applying proposition  [ auxgraph ] , there exists some @xmath539 with @xmath540 for each @xmath245 $ ] such that either    * @xmath80 contains no edges @xmath461 with @xmath462 or @xmath463 , or * @xmath80 contains no edges @xmath461 with @xmath464 and @xmath465 .    for each @xmath245 $ ] let @xmath541 if @xmath542 , and @xmath531 otherwise . for @xmath245",
    "$ ] , let @xmath452 be a set of size @xmath2 that contains or is contained by @xmath543 . note that for any @xmath259 , we have @xmath544 , and similarly @xmath545 . in case ( i ) , for any @xmath259 we have @xmath546 .",
    "this implies @xmath547 , and so @xmath548 $ ] has density at least @xmath215 . since @xmath101 and @xmath549 were arbitrary , we may conclude that @xmath3 is @xmath142-splittable .",
    "on the other hand , in case ( ii ) , for any @xmath259 we have @xmath550 .",
    "this implies @xmath551 , and so @xmath552 $ ] has density at least @xmath215 .",
    "similarly , @xmath553 $ ] has density at least @xmath215 , and @xmath548 $ ] has density at most @xmath142 for any @xmath259 , so @xmath3 is @xmath142-pair - complete .",
    "we next show that for @xmath554 , if @xmath3 is not @xmath142-splittable then @xmath311 is not close to a divisibility barrier .",
    "[ split ] suppose that @xmath515 and @xmath555 .",
    "let @xmath195 partition a set @xmath38 into vertex classes @xmath97 each of size @xmath278 .",
    "suppose @xmath3 is a @xmath195-partite graph with @xmath309 and let @xmath556 be the clique @xmath238-complex of @xmath3 .",
    "suppose @xmath96 is a partition refining @xmath195 into parts each of size at least @xmath517 such that @xmath557 is incomplete with respect to @xmath195 .",
    "then @xmath3 is @xmath142-splittable .",
    "we introduce new constants with @xmath558 .",
    "we can assume that @xmath96 is a strict refinement of @xmath195 , so without loss of generality @xmath96 partitions @xmath53 into parts @xmath559 , @xmath560 $ ] with @xmath561 .",
    "as in the proof of lemma [ 2splitorpc ] , we can also assume that @xmath557 is minimal , in that it does not contain any difference of basis vectors @xmath175 , for some @xmath386 that index subparts of the same part of @xmath195 .",
    "thus for any @xmath238 vertex classes @xmath562 , distinct parts @xmath563 , @xmath564 of @xmath96 contained in @xmath565 , and parts @xmath566 for @xmath567 , it can not be that @xmath568 and @xmath569 both have at least @xmath570 edges of @xmath311 ( i.e.  copies of @xmath350 ) .",
    "we use this to deduce the following properties , which control the typical behaviour of neighbourhoods and certain pairwise intersections of neighbourhoods .",
    "note that the bound in ( c ) is close to the lower bound on @xmath8 , so it says that @xmath3 is mostly approximately regular from the point of view of @xmath53 .",
    "[ splitc1 ]    * there are at most @xmath571 pairs @xmath572 such that @xmath573 , @xmath574 and @xmath575 for some @xmath560 $ ] and @xmath245 $ ] .",
    "* there are at most @xmath576 triples @xmath577 with @xmath573 , @xmath574 and @xmath578 for some @xmath560 $ ] and @xmath245 $ ] such that @xmath579 and @xmath580 .",
    "* for any @xmath395 there are at most @xmath581 vertices @xmath582 such that @xmath583 .    for ( a )",
    ", suppose for a contradiction that there are more than @xmath571 such pairs .",
    "without loss of generality there are at least @xmath584 pairs @xmath572 with @xmath585 and @xmath586 such that @xmath587 . for each such pair",
    ", we consider greedily choosing @xmath588 , @xmath567 such that @xmath589 and @xmath590 are copies of @xmath350 .",
    "the number of choices for @xmath591 is @xmath592 . for @xmath593",
    ", we have @xmath594 .",
    "also , @xmath595 . considering all such pairs @xmath572",
    ", we obtain at least @xmath596 such @xmath597-tuples @xmath598 .",
    "there are at most @xmath599 possible indices for such a @xmath597-tuple , so we may choose @xmath600 such @xmath597-tuples which all have the same index ; let @xmath598 be a representative of this collection . then there must be at least @xmath601 edges of @xmath311 with index @xmath602 , and at least @xmath601 edges of @xmath311 with index @xmath603 . but this contradicts minimality of @xmath557",
    ". a very similar argument applies for ( b ) . indeed , suppose for a contradiction that there are more than @xmath576 such triples .",
    "say there are at least @xmath604 triples @xmath577 with @xmath585 , @xmath586 , @xmath605 such that @xmath579 and @xmath606 . for each such triple",
    "we consider greedily choosing @xmath588 , @xmath607 such that @xmath608 and @xmath609 are copies of @xmath350 .",
    "the number of choices for @xmath591 is @xmath610 .",
    "thus the same calculation as in ( a ) gives a contradiction . for ( c ) , suppose for a contradiction that there are at least @xmath581 such vertices @xmath75 .",
    "for each such @xmath75 , and each choice of @xmath611 in a different part of @xmath96 to @xmath75 , we have @xmath612 .",
    "there are at least @xmath517 choices of @xmath262 for each @xmath75 , so this contradicts ( a ) .",
    "thus we have proved claim [ splitc1 ] .",
    "now for each @xmath560 $ ] and @xmath395 let @xmath613 consist of all vertices of @xmath7 which have at most @xmath614 neighbours in @xmath615 .",
    "bearing in mind the row structure we are aiming for , the intuition is that @xmath613 should approximate the @xmath101th part of the @xmath116th row .",
    "we show the following properties that agree with this intuition : the size of @xmath205 is roughly correct , and the intended diagonal densities are close to @xmath214 .",
    "[ splitc2 ]    * for any @xmath560 $ ] and @xmath395 we have @xmath616 .",
    "* for any @xmath617 $ ] with @xmath258 and any @xmath395 we have @xmath618 .",
    "* for any @xmath395 at most @xmath619 vertices",
    "@xmath620 lie in more than one of the sets  @xmath205 .",
    "thus @xmath621 for any @xmath560 $ ] , and all but @xmath622 vertices of @xmath7 lie in @xmath623 } x^i_j$ ] .",
    "* for any @xmath617 $ ] with @xmath258 and any @xmath624 we have @xmath625 .    for ( d ) , note that @xmath626 by ( c ) .",
    "also , @xmath627 therefore @xmath628 , which gives ( d ) .",
    "next suppose for a contradiction that ( e ) is false , say that @xmath629 .",
    "let @xmath252 be the set of vertices in @xmath630 with fewer than @xmath631 neighbours in @xmath523 .",
    "write @xmath632 . then @xmath633 , so @xmath634 . thus @xmath635 by ( d ) .",
    "each vertex in @xmath252 has fewer than @xmath636 neighbours in @xmath523 , and also fewer than @xmath637 neighbours in @xmath524 by definition of @xmath630 .",
    "this gives at least @xmath638 triples @xmath577 with @xmath585 , @xmath586 , and @xmath639 such that @xmath640 .",
    "at least @xmath571 pairs @xmath572 therefore lie in at least @xmath641 such triples . for each of these pairs",
    "we have @xmath642",
    ". however , this contradicts ( a ) , so ( e ) holds . for ( f ) , suppose for a contradiction that @xmath643 has size at least @xmath644 , for some @xmath617 $ ] with @xmath258 . by definition ,",
    "each vertex of @xmath252 has at most @xmath614 neighbours in @xmath645 , so @xmath646 .",
    "but then @xmath647 , contradicting ( e ) .",
    "so @xmath648 , and summing over all possible values of @xmath116 and @xmath649 we obtain the first statement of ( f ) .",
    "this implies that @xmath650 } |x^i_j| \\le pn + m\\gamma n$ ] , so @xmath650 } ( |x^i_j| - |v_1^i| ) \\le",
    "m\\gamma n$ ] . in combination with ( d )",
    "this implies @xmath621 for any @xmath560 $ ] .",
    "also , ( d ) gives @xmath651 } x^i_j \\right| } \\ge \\sum_{i \\in [ m ] } ( |v_1^i| - \\gamma ' n ) - m\\gamma n \\ge pn - 2p\\gamma ' n$ ] , so ( f ) holds .",
    "finally , suppose for a contradiction that ( g ) is false , say @xmath652 . without loss of generality we have @xmath653 .",
    "let @xmath252 be the set of vertices in @xmath654 with fewer than @xmath655 neighbours in @xmath656 .",
    "( we re - use @xmath252 to avoid excessive notation . )",
    "write @xmath657 . then @xmath658 , so @xmath659 . thus @xmath660 by ( d ) .",
    "each vertex in @xmath252 has fewer than @xmath661 neighbours in @xmath656 , and also fewer than @xmath637 neighbours in @xmath524 by definition of @xmath654 .",
    "this gives a set @xmath662 of at least @xmath663 triples @xmath664 with @xmath665 , @xmath666 and @xmath667 such that @xmath668 .",
    "furthermore , since by ( e ) we have @xmath669 , all but at most @xmath670 triples in @xmath662 have the additional property that @xmath671 .",
    "let @xmath500 be the set of pairs @xmath672 with @xmath671 , @xmath665 , @xmath666 that lie in at least @xmath641 triples of @xmath662 .",
    "then @xmath673 , so @xmath674 , say .",
    "since @xmath653 and @xmath447 , for each @xmath675 there are more than @xmath676 vertices @xmath262 such that @xmath677 and @xmath678 .",
    "note that this is a key use of the assumption @xmath679 , so we had to deal with the case @xmath448 separately in the previous subsection .",
    "there are therefore more than @xmath576 triples @xmath577 with @xmath665 , @xmath677 and @xmath666 such that @xmath579 and @xmath675 . however , for any @xmath675 we have @xmath680 , which contradicts ( b ) . thus ( g ) holds , proving claim [ splitc2 ] .    to complete the proof",
    ", we also need to show that the size of each part of @xmath53 is close to an integer multiple of @xmath2 .",
    "since each part of @xmath53 has size at least @xmath517 , this will be true if @xmath53 has a part of size close to @xmath381 .",
    "so for the final claim we assume that @xmath53 does not have such a large part ; in this case we extend ( c ) by showing that the bipartite graph induced by any pair of vertex classes is mostly approximately regular .",
    "we then show that most vertices in @xmath53 have sparse non - neighbourhoods , before finally deducing the required statement on the sizes of the parts of  @xmath53 .",
    "[ splitc3 ] suppose @xmath53 does not have a part of size at least @xmath681 .",
    "then    * for any @xmath682 $ ] there are at most @xmath683 vertices @xmath684 such that @xmath685 . * for a set @xmath686 of all but at most @xmath619 vertices @xmath582 we have @xmath687 and @xmath688 for any @xmath689 with @xmath259 .",
    "* for each @xmath116 there is an integer @xmath218 such that @xmath690 .    for ( h ) , note that by our assumption on the part sizes of @xmath53 , any such @xmath263 lies in at least @xmath691 triples @xmath577 such that @xmath579 and @xmath75 and @xmath262 lie in different parts of @xmath53 .",
    "any such triple is counted by ( b ) , as @xmath692 , so there can be at most @xmath683 such vertices @xmath263 , as claimed . for ( j ) we introduce the following notation : @xmath693 is the set of neighbours of @xmath75 in @xmath7 , and @xmath694 is the set of non - neighbours of @xmath75 in @xmath7 .",
    "fix some @xmath101 and @xmath549 , and suppose @xmath582 is such that @xmath695 and @xmath696 .",
    "we can estimate @xmath697 as follows .",
    "write @xmath698 .",
    "then by ( h ) we have @xmath699 . also , @xmath700 by choice of @xmath75 .",
    "this gives @xmath701 since @xmath702 , and @xmath703 by choice of @xmath75 , we deduce that @xmath704 .",
    "let @xmath252 be the set of vertices in @xmath705 with fewer than @xmath706 neighbours in @xmath707 .",
    "write @xmath708 . then @xmath709 , so @xmath710 , and @xmath711 .",
    "for any @xmath712 we have @xmath713 , so @xmath714 furthermore , since @xmath53 does not have a part of size at least @xmath681 , there must be at least @xmath715 neighbours @xmath262 of @xmath263 which lie in a different part of @xmath53 to @xmath75 .",
    "there are at least @xmath716 choices for @xmath712 , so @xmath75 lies in at least @xmath717 triples @xmath577 counted in ( b ) .",
    "thus there at most @xmath718 such vertices @xmath582 with @xmath719 and @xmath696 . since by ( c ) at most @xmath720 vertices",
    "do not satisfy the latter condition , summing over all @xmath721 $ ] gives ( j ) .",
    "( every vertex @xmath582 satisfies @xmath722 . )    for ( k ) , consider any @xmath723 as defined in ( j ) , and let @xmath724 for @xmath725 .",
    "we will show that either @xmath726 or @xmath727 . for suppose that @xmath728 .",
    "let @xmath729 .",
    "by definition of @xmath686 we have @xmath730 , so there is a vertex @xmath731 with @xmath732",
    ". then @xmath733 .",
    "this gives @xmath734 , so @xmath735 .",
    "now the same argument interchanging @xmath736 and @xmath737 shows that @xmath727 , as required .",
    "next we define a relation @xmath738 on @xmath686 by @xmath739 if @xmath727 .",
    "this is an equivalence relation , since if @xmath727 and @xmath740 , then @xmath741 , so @xmath727 as just shown .",
    "let @xmath742 be the equivalence classes of @xmath738 , and arbitrarily choose a representative @xmath372 of each equivalence class @xmath743 .",
    "since each @xmath372 lies in @xmath744 , the sets @xmath745 each have size @xmath746 by ( j ) . furthermore , any two such sets intersect in at most @xmath747 vertices , since the representatives @xmath372 each lie in different equivalence classes .",
    "we can not have @xmath748 , as then @xmath749 is a contradiction , so we must have @xmath750 .",
    "next , observe that any vertex in @xmath751 has at most @xmath752 neighbours in @xmath745 .",
    "so @xmath753 . by averaging",
    ", some vertex @xmath754 therefore has at most @xmath755 neighbours in  @xmath751 .",
    "so @xmath756 , which implies @xmath757 .",
    "since the @xmath750 equivalence classes @xmath751 partition @xmath744 , we deduce that @xmath758 and @xmath759 for any @xmath760 $ ] .",
    "now we show that any equivalence class @xmath761 must be essentially contained in some part @xmath559 of @xmath53 ; by symmetry it suffices to show that this is true of @xmath762 .",
    "so observe that since @xmath763 , by ( f ) we must have @xmath764 for some @xmath560 $ ] .",
    "fix such an @xmath116 , and suppose for a contradiction that @xmath765 for some @xmath499 .",
    "we observed above that any @xmath766 has at most @xmath767 neighbours in @xmath768 , so there are at least @xmath769 vertices of @xmath770 which are not neighbours of @xmath12 .",
    "then @xmath771 , contradicting ( e ) .",
    "we conclude that all but at most @xmath772 vertices of @xmath762 lie in @xmath615 , and thus that all but at most @xmath772 vertices of any equivalence class lie in the same part of @xmath53 .",
    "so for any @xmath773 we have either @xmath774 or @xmath775 ; ( k ) follows immediately since the classes @xmath776 partition @xmath744 and @xmath777 by ( j ) .",
    "this completes the proof of claim  [ splitc3 ] .    to complete the proof of lemma  [ split ] , note that there exist integers @xmath778 such that @xmath690 for each @xmath560 $ ]",
    "indeed , if @xmath53 has a part of size at least @xmath681 , then since each part of @xmath96 has size at least @xmath517 , we may assume that @xmath53 has two parts @xmath523 and @xmath524 with respective sizes @xmath779 and @xmath780 .",
    "on the other hand , if @xmath53 has no such part then the required integers @xmath218 exist by ( k ) .",
    "we partition @xmath53 into sets @xmath781 with @xmath782 for @xmath560 $ ] such that each @xmath781 either contains or is contained in some @xmath559 .",
    "then @xmath783 contains at least @xmath784 vertices of @xmath615 for any @xmath560 $ ] .",
    "furthermore , by ( d ) and ( f ) , for each @xmath395 we may partition @xmath7 into sets @xmath785 with @xmath786 for @xmath560 $ ] such that each @xmath785 contains at least @xmath787 vertices from @xmath205 . by ( e ) and ( g )",
    "we deduce that @xmath788 whenever @xmath46 and @xmath789 .",
    "in particular , @xmath790 for any @xmath789 , so @xmath3 is @xmath142-splittable .    combining lemmas [ 2splitorpc ] and [ split ] ,",
    "if @xmath3 is neither @xmath142-splittable nor @xmath142-pair - complete ( if @xmath448 ) then there is no divisibility barrier to a perfect matching in @xmath311 .",
    "we saw in lemma [ splittable ] that there is also no space barrier to a perfect matching in @xmath311 .",
    "so theorem  [ partitematching ] implies that @xmath3 contains a near - balanced perfect matching .",
    "the following corollary formalises this argument .",
    "[ findmatching ] suppose that @xmath791 and @xmath792 .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 each of size @xmath278 with @xmath309 .",
    "suppose also that @xmath3 is neither @xmath142-splittable nor @xmath142-pair - complete .",
    "let @xmath446 be the clique @xmath238-complex of @xmath3 .",
    "then @xmath311 contains a @xmath184-balanced perfect matching .",
    "introduce new constants with @xmath793 . as described in section  [ sec : theory ] , the condition @xmath309 implies @xmath794 suppose that @xmath311 has no @xmath184-balanced perfect matching .",
    "then by theorem  [ partitematching ] ( with @xmath278 in place of @xmath2 and @xmath238 in place of @xmath1 ) we deduce that there is either a space barrier or divisibility barrier .",
    "consider first a space barrier .",
    "this means that there exist @xmath279 $ ] and @xmath129 with @xmath795 for each @xmath41 $ ] so that @xmath311 is @xmath187-contained in @xmath796 , that is , all but at most @xmath797 edges of @xmath311 have at most @xmath319 vertices in @xmath127 .",
    "however , since @xmath3 is @xmath142-splittable , lemma  [ splittable](i ) ( with @xmath798 in place of @xmath187 ) implies that more than @xmath799 copies of @xmath318 in  @xmath3 have more than @xmath319 vertices in @xmath227 $ ] .",
    "since each copy of @xmath350 in @xmath3 is an edge of @xmath311 , there can not be a space barrier .",
    "now suppose that there is a divisibility barrier .",
    "this means that there is some partition @xmath96 of @xmath88 into parts of size at least @xmath800 such that @xmath96 refines the partition @xmath195 of @xmath204 into @xmath97 and @xmath557 is incomplete with respect to @xmath195 .",
    "but if @xmath447 then lemma  [ split ] ( with @xmath801 in place of @xmath189 ) implies that @xmath3 is @xmath142-splittable , contradicting our assumption .",
    "similarly , if @xmath448 then lemma  [ 2splitorpc ] ( with @xmath802 in place of @xmath189 ) implies that @xmath3 is @xmath142-splittable or @xmath142-pair - complete , again contradicting our assumption .",
    "we conclude that @xmath311 must contain a @xmath184-balanced perfect matching .",
    "recall from the proof outline given in section  [ sec : outline ] that step ( ii ) in proving theorem  [ partitehajnalszem ] is to find a balanced perfect @xmath216-packing in each row @xmath217 $ ] . in this section",
    "we demonstrate how this may be achieved .",
    "we need to consider two cases .",
    "the first case is where @xmath217 $ ] is neither @xmath142-splittable nor @xmath142-pair - complete",
    ". then corollary  [ findmatching ] gives a @xmath184-balanced perfect @xmath216-packing in @xmath217 $ ] .",
    "in lemma  [ theoremmatching ] we show how such a matching can be ` corrected ' to a balanced perfect @xmath216-packing in this case if @xmath224 , and also if @xmath803 provided that @xmath217 $ ] contains many @xmath804-cycles of a given type .",
    "if @xmath803 and @xmath217 $ ] does not contain such @xmath804-cycles then it may not be possible to find a balanced perfect matching in @xmath217 $ ] .",
    "proposition  [ onepcrow ] will allow us to handle this case by deleting further copies of @xmath0 from @xmath3 so that the remainder of row @xmath116 does contain a balanced perfect matching .",
    "the second case is where @xmath217 $ ] is @xmath142-pair - complete",
    ". then we prove lemma  [ paircompletematching ] , which shows that @xmath217 $ ] contains a perfect matching provided a parity condition is satisfied . both here and",
    "later we use the fact that , if we add or remove a small number of vertices to or from each block @xmath205 of a row @xmath211 of @xmath3 which is neither @xmath142-splittable nor @xmath142-pair - complete , then the new row obtained is neither @xmath805-splittable nor @xmath805-pair - complete for @xmath806 .",
    "this is established by the following proposition .",
    "[ robustness ] suppose that @xmath807 and @xmath808 .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 , and for each @xmath245 $ ] let @xmath809 be such that @xmath810 , @xmath811 and @xmath812 .",
    "let @xmath813 } x_j$ ] and @xmath814 } x'_j$ ] ; then the following statements hold .    a.   if @xmath815 $ ] is not @xmath142-splittable then @xmath816 $ ] is not @xmath805-splittable",
    ". b.   if @xmath448 and @xmath815 $ ] is not @xmath142-pair - complete then @xmath816 $ ] is not @xmath805-pair - complete .",
    "note that @xmath817 . for ( i ) , suppose for a contradiction that @xmath816 $ ] is @xmath805-splittable .",
    "then by definition we may choose @xmath279 $ ] and subsets @xmath818 with @xmath819 for @xmath245 $ ] such that @xmath820 for any @xmath821 .",
    "for each @xmath245 $ ] we choose @xmath822 such that @xmath823 and @xmath289 either contains or is contained in @xmath824 .",
    "note that @xmath825 and @xmath826 . we deduce that for any @xmath821 we have @xmath827",
    "then @xmath815 $ ] is @xmath142-splittable with respect to the sets @xmath289 , a contradiction , so this proves ( i ) . for ( ii ) , suppose for a contradiction that @xmath816 $ ] is @xmath805-pair - complete .",
    "then by definition we may choose subsets @xmath818 with @xmath828 for @xmath245 $ ] such that @xmath829 , @xmath830 and @xmath831 for any @xmath821 .",
    "we take @xmath832 and choose @xmath289 for @xmath245 $ ] as in ( i ) .",
    "similar calculations as in ( i ) show that @xmath833 and @xmath834 for any @xmath821 .",
    "we deduce that @xmath835 then @xmath815 $ ] is @xmath142-pair - complete with respect to the sets  @xmath289 , another contradiction , so this proves ( ii ) .",
    "we can now prove the main lemma of this section , which allows us to find balanced perfect clique packings in graphs which are not @xmath142-splittable or @xmath142-pair - complete .",
    "[ theoremmatching ] suppose that @xmath836 , @xmath837 and @xmath838 .",
    "let @xmath3 be a @xmath33-partite graph on vertex classes @xmath97 each of size @xmath278 , and let @xmath85 be the clique @xmath238-complex of @xmath3 .",
    "suppose that @xmath3 contains a spanning subgraph @xmath839 such that @xmath839 is not @xmath142-splittable and @xmath840 .",
    "if @xmath447 , then @xmath311 contains a balanced perfect matching .",
    "if instead @xmath448 then @xmath311 contains a balanced perfect matching if    a.   @xmath839 is not @xmath142-pair - complete , and b.   either @xmath841 or for any distinct @xmath842 in @xmath843 { \\setminus}\\{1\\}$ ] there are at least @xmath844 @xmath804-cycles @xmath845 in @xmath3 with @xmath846 and @xmath847 for @xmath848 $ ] .",
    "introduce new constants @xmath849 and @xmath805 with @xmath850 .",
    "let @xmath851}{p}$ ] , so @xmath852 is the family of possible indices of edges of @xmath311 . for any perfect matching @xmath79 in @xmath311 and any index @xmath853 , let @xmath854 be the number of edges in @xmath79 with index @xmath252 .",
    "since any vertex of @xmath85 lies in precisely one edge of @xmath79 , for any @xmath41 $ ] we must have @xmath855 let @xmath856 , and observe that @xmath857 is an integer .",
    "our goal is to find a perfect matching @xmath79 in @xmath311 with @xmath858 for every @xmath853 . to do this",
    ", we will apply theorem  [ partitematching ] to find a perfect matching which is near - balanced , but first we need to put aside some configurations that can be used to correct the small differences in the number of edges of each index",
    ". this will be unnecessary if @xmath859 or @xmath860 , as then any perfect matching in @xmath311 must be balanced .",
    "indeed , for @xmath859 this is trivial , whilst for @xmath861 we note that by  ( [ eq : indices ] ) , for any @xmath41 $ ] , the number of edges of any perfect matching which do not contain a vertex of @xmath40 is @xmath862 .",
    "so for the purpose of finding configurations we may suppose that @xmath863 ( this is why we only require ( ii ) for @xmath864 ) .",
    "fix a set @xmath865 $ ] with @xmath866 and an ordered quadruple @xmath867 of distinct members of @xmath843 { \\setminus}s$ ] .",
    "an _ @xmath868-configuration _",
    "consists of two vertex - disjoint copies @xmath869 and @xmath870 of @xmath871 , where @xmath869 has index @xmath872 and @xmath870 has index @xmath873 , and vertices @xmath874 and @xmath875 such that @xmath12 and @xmath876 are both adjacent to every vertex of @xmath877 .",
    "given such an @xmath868-configuration , we can select two vertex - disjoint copies of @xmath350 in @xmath3 ( that is , two disjoint edges of @xmath311 ) in two different ways .",
    "one way is to take @xmath878 of index @xmath879 and @xmath880 of index @xmath881 ; we call this the _ unflipped _ state .",
    "the other way is to take @xmath882 of index @xmath883 and @xmath884 of index @xmath885 ; we call this the _ flipped _ state .",
    "let @xmath886 be the set of all pairs @xmath868 as above .",
    "the first step in our proof is to find a collection @xmath887 of pairwise vertex - disjoint configurations in @xmath3 which contains @xmath772 @xmath888-configurations in @xmath3 for each @xmath889 .",
    "suppose first that @xmath447 .",
    "to choose an @xmath868-configuration in this case we first fix @xmath890 and find vertices @xmath874 and @xmath875 with @xmath891 . to see that this is possible , let @xmath892 be the set of ordered triples @xmath893 with @xmath874 , @xmath875 , @xmath894 and @xmath895 .",
    "for each @xmath425 there are at least @xmath896 choices for each of @xmath12 and @xmath876 , so @xmath897 .",
    "let @xmath500 be the set of ordered pairs @xmath898 that belong to at least @xmath899 triples of @xmath892 , i.e.  have @xmath891 .",
    "then @xmath900 , so @xmath901 .",
    "given such a pair @xmath898 , we choose the remaining vertices of the configuration greedily , ending with the two vertices in @xmath902 . for each vertex not in @xmath902 ,",
    "the number of choices is at least @xmath903 .",
    "for the two vertices in @xmath902 , the number of choices for each is at least @xmath904 .",
    "now we choose the collection @xmath887 greedily . at each step , the configurations chosen so far cover at most @xmath905 vertices .",
    "since there are at least @xmath906 choices for the pair @xmath898 and at least @xmath907 choices for any other vertex we are always able to choose an @xmath888-configuration which is vertex - disjoint from any configuration chosen so far , as required .    now consider instead the case @xmath448 , for which @xmath908 .",
    "recall that we can assume @xmath909 .",
    "now an @xmath868-configuration consists of a @xmath804-cycle @xmath910 with @xmath911 and @xmath912 , where @xmath913 ( we have @xmath914 ) .",
    "note that the unflipped state of such a configuration has edges @xmath915 and @xmath916 , and the flipped state has edges @xmath917 and @xmath918 . if @xmath919 then by assumption there are least @xmath844 such @xmath804-cycles in @xmath3 . for @xmath920 we instead choose _ fake configurations _",
    "; for @xmath921 and @xmath913 a fake @xmath868-configuration consists simply of vertices @xmath910 with @xmath911 and @xmath912 such that @xmath915 and @xmath916 are edges .",
    "a fake configuration should be thought of as a configuration which can not be flipped .",
    "there are at least @xmath922 fake configurations for each @xmath662 , so similarly to before we may choose @xmath887 greedily to consist of genuine @xmath868-configurations if @xmath923 , and fake @xmath868-configurations otherwise .",
    "indeed , at any step the configurations chosen so far cover at most @xmath924 vertices , so for any @xmath889 at most @xmath925 @xmath888-configurations share a vertex with a previously - chosen configuration .",
    "let @xmath926 } v'_i$ ] be the set of all vertices not covered by configurations in @xmath887 .",
    "we now find a matching in @xmath311 covering @xmath927 .",
    "note that the configurations in @xmath887 cover @xmath928 vertices in total , equally many of which lie in each vertex class , so for any @xmath41 $ ] we have @xmath929 , where @xmath930 .",
    "let @xmath931 $ ] and let @xmath932 be the clique @xmath238-complex of @xmath933 . then @xmath934 .",
    "furthermore , by lemma  [ robustness ] @xmath933 is not @xmath805-splittable , and if @xmath935 then @xmath933 is not @xmath805-pair - complete .",
    "so by corollary  [ findmatching ] @xmath936 must contain an @xmath937-balanced perfect matching .",
    "extend this matching to a perfect matching @xmath938 in @xmath311 by adding the configurations in @xmath887 , all in their unflipped state .",
    "this adds equally many edges of each index , so @xmath938 is @xmath937-balanced , and so @xmath939 for any index @xmath853 .",
    "it remains only to flip some configurations to correct these small imbalances in the number of edges of each index . to accomplish this",
    ", we shall proceed through the index sets @xmath853 in order . for each @xmath252 we will flip some configurations to obtain a perfect matching with precisely @xmath857 edges of each index set @xmath940 considered in this order up to and including @xmath252 . at the end of this process we will obtain a perfect matching with precisely @xmath857 edges of every index set .",
    "let @xmath941 consist of all members of  @xmath852 of the form @xmath942",
    "\\cup \\{i\\}$ ] for some @xmath943 , and @xmath944 consist of all members of @xmath852 of the form @xmath945 { \\setminus}\\{i\\}$ ] for some @xmath946 $ ] .",
    "let @xmath947 and @xmath948 , so @xmath949 . note that if @xmath935 then @xmath950 contains all pairs @xmath951 with @xmath395 .",
    "choose any linear ordering @xmath952 of the elements of @xmath852 such that    a.   for any @xmath853 , @xmath953 and @xmath954 with @xmath955 we have @xmath956 , and b.   @xmath950 is a terminal segment of @xmath852 .",
    "this is possible since for any @xmath957 , @xmath953 and @xmath954 with @xmath955 we have @xmath958 .",
    "note that for any @xmath959 there exist @xmath960 and @xmath961 such that @xmath962 and @xmath963 .",
    "crucially , the sets @xmath964 , @xmath965 and @xmath966 each appear after @xmath252 , by choice of the ordering .",
    "we now proceed through the sets @xmath967 , @xmath968 $ ] in turn ( these are precisely the sets @xmath967 with @xmath969 ) . at each step",
    "@xmath116 we will flip at most @xmath970 configurations to obtain a perfect matching @xmath971 such that @xmath972 for any @xmath354 and @xmath973 for any @xmath974 .",
    "the matching @xmath938 satisfies these requirements for @xmath975 , so suppose that we have achieved this for @xmath976 , and that we wish to obtain @xmath971 from @xmath977 .",
    "if @xmath978 then we may simply take @xmath979 , so we may assume @xmath980 .",
    "first suppose that @xmath981 .",
    "since @xmath969 we may choose @xmath982 and @xmath983 such that @xmath962 and @xmath984 .",
    "furthermore , if @xmath448 then we may also require that @xmath985 .",
    "we let @xmath986 , @xmath987 , and choose a set of @xmath988 unflipped @xmath888-configurations in @xmath887 ( we shall see later that this is possible ) .",
    "we flip all of these configurations ( this is possible if @xmath448 since @xmath985 , so these configurations are not fake - configurations ) . in doing so ,",
    "we replace @xmath988 edges of @xmath977 of index @xmath989 and @xmath988 edges of @xmath977 of index @xmath990 with @xmath988 edges of @xmath977 of index @xmath991 and @xmath988 edges of @xmath977 of index @xmath992 .",
    "the number of edges of each other index remains the same ; note that this includes any index @xmath993 with @xmath335 .",
    "let @xmath971 be formed from @xmath977 by these flips ; then @xmath972 for any @xmath354 by construction . also , for any @xmath974 we have @xmath994 as required . on the other hand , for @xmath995",
    "we obtain @xmath971 similarly by the same argument with @xmath996 . to see that it is always possible to choose a set of @xmath988",
    "unflipped @xmath888-configurations from @xmath887 , note that there are @xmath997 steps of the process , and that at step  @xmath116 exactly @xmath998 members of @xmath887 are flipped .",
    "so in total at most @xmath999 members of @xmath887 are flipped .",
    "since @xmath887 was chosen to contain at least this many pairwise vertex - disjoint @xmath888-configurations for any @xmath889 , it will always be possible to make these choices .    at the end of this process",
    ", we obtain a perfect matching @xmath1000 in @xmath311 such that @xmath1001 for every @xmath1002 .",
    "it remains only to show that we also have @xmath1001 for any @xmath957 .",
    "we first consider @xmath1003 , so @xmath1004 \\cup \\{i\\}$ ] for some @xmath1005 , and @xmath252 is the only index in @xmath950 which contains @xmath116 .",
    "each of the @xmath1006 other sets @xmath940 containing @xmath116 has @xmath1007 , so by ( [ eq : indices ] ) we also have @xmath1008 .",
    "thus @xmath858 for any @xmath1003 .",
    "now consider @xmath1009 , so @xmath1010 { \\setminus}\\{i\\}$ ] for some @xmath946 $ ] .",
    "note that @xmath252 is the only member of @xmath1011 which does not contain @xmath116 . since @xmath1012 for any @xmath1013 , by ( [ eq : indices ] ) we have @xmath1014 .",
    "this holds for all @xmath1009 , so @xmath858 for all @xmath1009 .",
    "thus @xmath79 is a balanced perfect matching in @xmath311 , as required .",
    "we also need to be able to find balanced perfect matchings in pair - complete rows .",
    "recall that an @xmath33-partite graph @xmath3 with vertex classes @xmath39 of size @xmath450 is _ @xmath142-pair - complete _ if there exist sets @xmath452 , @xmath245 $ ] each of size @xmath2 such that @xmath453 , @xmath454 and @xmath455 for any @xmath456 $ ] with @xmath386 .",
    "this implies that almost all vertices in @xmath1015 have few non - neighbours in @xmath289 and almost all vertices in @xmath1016 have few non - neighbours in @xmath1017 .",
    "lemma [ paircompletematching ] will show that @xmath3 contains a balanced perfect matching under a similar condition , namely that there are sets @xmath1018 , @xmath245 $ ] each of size approximately @xmath2 such that all vertices in @xmath1019 have few non - neighbours in @xmath1020 and all vertices in @xmath1021 have few non - neighbours in @xmath1022 for any @xmath386 , provided that @xmath1023 } x_i$ ] has even size .",
    "note that we can not omit the parity requirement on @xmath1024 , as there may be no edges between @xmath69 and @xmath1025 .",
    "the proof uses the following characterisation of multigraphic degree sequences by hakimi @xcite .",
    "a sequence @xmath1026 with @xmath1027 is _ multigraphic _ if there is a loopless multigraph on @xmath2 vertices with degree sequence @xmath142 .",
    "[ hakimi ] ( @xcite ) a sequence @xmath1026 with @xmath1027 is multigraphic if and only if @xmath1028 is even and @xmath1029 .",
    "[ paircompletematching ] suppose that @xmath1030 and @xmath1031 .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath97 each of size @xmath450 .",
    "for each @xmath41 $ ] let sets @xmath1019 and @xmath1032 partition @xmath40 and be such that    a.   @xmath1033 for any @xmath245 $ ] , b.   for any @xmath386 , any @xmath1034 has at most @xmath1035 non - neighbours in @xmath1020 and any @xmath1036 has at most @xmath1035 non - neighbours in @xmath1037 , and c.   @xmath1038 } x_i$ ] has even size .",
    "then @xmath3 contains a balanced perfect matching .",
    "choose an integer @xmath1039 so that @xmath1040 and @xmath1041 .",
    "for each @xmath245 $ ] let @xmath1042 .",
    "so @xmath1043 for each @xmath101 , and @xmath1044 } a_j = |x| - rn'$ ] is even by ( iii ) and since @xmath1045 is divisible by @xmath1046 , which is even . by proposition [ hakimi ] , we can choose pairs @xmath1047 with @xmath1048 for @xmath1049 $ ] so that each @xmath245 $ ] appears in precisely @xmath1050 pairs . for each @xmath1049 $ ] choose a matching @xmath1051 in @xmath3 which contains an edge of @xmath815 $ ] of index @xmath1052 , and an edge of @xmath1053 $ ] of each index @xmath180}{2 } { \\setminus}\\{i , j\\}$ ] .",
    "we also require that these matchings are pairwise vertex - disjoint .",
    "such matchings may be chosen greedily using ( ii ) , since together they will cover a total of @xmath1054 vertices .",
    "let @xmath1055 } m_\\ell$ ] .",
    "note that @xmath79 has @xmath1056 edges of each index , and so covers @xmath1057 vertices from each @xmath7 .",
    "for each @xmath245 $ ] let @xmath1058 and @xmath1059 , and let @xmath1060 and @xmath1061 .",
    "then @xmath1062 and @xmath1063 for any @xmath245 $ ] .",
    "since @xmath1064 divides @xmath1039 and @xmath450 , we conclude that @xmath1064 divides @xmath1065 and @xmath1066 for any @xmath245 $ ] .",
    "so we may partition @xmath1067 and @xmath1068 into sets @xmath1069 and @xmath1070 for each @xmath180}{2}$ ] , where for each @xmath1071 , @xmath1069 consists of @xmath1072 vertices from each of @xmath1073 and @xmath1074 , and @xmath1070 consists of @xmath1075 vertices from each of @xmath1076 and @xmath1077 . now for any @xmath180}{2}$ ] , the induced bipartite graph @xmath1078 $ ] has minimum degree at least @xmath1079 by ( ii ) , and so contains a perfect matching @xmath1080 of size @xmath1081 ; by the same argument @xmath1082 $ ] contains a perfect matching @xmath1083 of size @xmath1084 .",
    "finally , @xmath1085 is a perfect matching in @xmath3 with @xmath1086 edges of each index , as required .    however , there are some @xmath33-partite graphs @xmath3 on vertex classes @xmath97 of size @xmath450 which satisfy @xmath516 and are neither @xmath142-splittable nor @xmath142-pair - complete but do not contain a balanced perfect matching . for example , let @xmath80 be a graph with vertex set @xmath1087\\}$ ] , where @xmath510 and @xmath511 are edges for any @xmath386 except when @xmath1088 , and @xmath1089 and @xmath1090 are edges .",
    "form @xmath3 by ` blowing up ' @xmath80 , that is , replace each @xmath372 and @xmath1091 by a set of @xmath2 vertices , where @xmath1031 , and each edge by a complete bipartite graph between the corresponding sets",
    ". then @xmath3 contains @xmath1092 vertices , and so any balanced perfect matching @xmath79 in @xmath3 contains @xmath1093 edges of each index .",
    "let @xmath69 be the vertices of @xmath3 which correspond to some vertex @xmath372 of @xmath80 .",
    "then @xmath1094 and any edge of @xmath79 covering a vertex of @xmath69 either covers two vertices of @xmath69 or has index @xmath1095 .",
    "there are exactly @xmath1093 edges in @xmath79 of the latter form , so we must have @xmath1096 modulo @xmath65 . we conclude that @xmath3 contains no balanced perfect matching if this congruence fails ( e.g.  if @xmath1097 and @xmath2 is even but not divisible by @xmath804 )",
    ". however , @xmath1098 , and it is easily checked that @xmath3 is neither @xmath142-splittable nor @xmath142-pair - complete if @xmath1099 .",
    "other examples can be obtained similarly .",
    "note that @xmath3 does contain a perfect matching by corollary  [ findmatching ] , but this can not be balanced .",
    "in later arguments , such graphs will only cause difficulties when the row - decomposition has one row of this form ( with @xmath225 ) , and every other row has @xmath1100 .",
    "in such cases the following proposition will enable us to delete further copies of @xmath0 so that the subgraph remaining has a balanced perfect @xmath216-packing in every row @xmath116 .",
    "[ onepcrow ] suppose that @xmath1101 , @xmath1102 divides @xmath2 and @xmath1103 .",
    "let @xmath3 be an @xmath33-partite graph on vertex classes @xmath1104 of size @xmath202 which admits an @xmath1105-row - decomposition into pairwise - disjoint blocks @xmath205 with @xmath244 for @xmath237 $ ] and @xmath245 $ ] , where @xmath1106 and @xmath1107 .",
    "suppose that @xmath1108 $ ] contains a @xmath184-balanced perfect matching @xmath1109 , and that for any @xmath258 and @xmath259 any vertex @xmath1110 has at most @xmath1111 non - neighbours in @xmath232 .",
    "then there exists an integer @xmath1112 and a @xmath0-packing @xmath79 in @xmath3 such that @xmath1102 divides @xmath1113 , @xmath79 covers @xmath1114 vertices in @xmath205 for any @xmath237 $ ] and @xmath245 $ ] , and @xmath1115 $ ] contains a balanced perfect matching .",
    "we may write @xmath1116 , where  @xmath1117 is a balanced matching in @xmath1108 $ ] , @xmath1118 divides @xmath1119 , and @xmath1120 .",
    "note that @xmath1117 covers @xmath1121 vertices in each @xmath1122 , @xmath245 $ ] , so @xmath1123 covers the remaining @xmath1124 vertices in each @xmath1122 , where @xmath1125 .",
    "note also that @xmath1126 , @xmath1112 , and @xmath1102 divides @xmath1127 .",
    "we will construct a sequence @xmath1128 , where @xmath1129 is a @xmath1130-packing in @xmath1131 } x^{i'}]$ ] that covers @xmath1124 vertices in @xmath1122 and @xmath1132 vertices in @xmath1133 for each @xmath1134 and @xmath245 $ ] .",
    "each @xmath1129 will have size @xmath1135 , and will be formed by adding a vertex of @xmath211 to each copy of @xmath117 in @xmath1136 .",
    "suppose that we have formed @xmath1129 in this manner for some @xmath1137 , and now we wish to form  @xmath1138 .",
    "let @xmath1139 be the set of ordered pairs @xmath1140 with @xmath245 $ ] and @xmath1141 $ ] .",
    "we form a bipartite graph @xmath253 whose vertex classes are @xmath1129 and @xmath1139 , where a copy @xmath870 of @xmath1130 in @xmath1129 and a pair @xmath1140 are connected if @xmath1142 , that is , if @xmath870 contains no vertex from @xmath1020 .",
    "note that any @xmath870 in @xmath1129 has degree @xmath1143 in @xmath253 , as there are @xmath1144 choices for @xmath245 { \\setminus}i(k')$ ] and @xmath1132 choices for @xmath1141 $ ] .",
    "the same is true of any pair @xmath1140 in @xmath1139 , as @xmath1135 , and @xmath1145 cliques in @xmath1129 intersect @xmath1020 .",
    "so @xmath253 is a regular bipartite graph , and therefore contains a perfect matching .",
    "let @xmath1146 be such that @xmath1147 is a perfect matching in @xmath253 .",
    "for each @xmath1148 we extend @xmath870 to a copy of @xmath1149 in @xmath3 by adding a vertex from @xmath1150 , where @xmath1151 for some @xmath1141 $ ] .",
    "such extensions may be chosen distinctly , since any @xmath1148 has at least @xmath1152 possible extensions to @xmath1150 for any @xmath1142 .",
    "since every pair in @xmath1139 was matched to some @xmath1148 , the @xmath1149-packing @xmath1138 covers precisely @xmath1132 vertices from @xmath1150 for each @xmath245 $ ] .    at the end of this process",
    "we obtain a @xmath0-packing @xmath1153 in @xmath3 which covers @xmath1124 vertices from @xmath1122 and @xmath1132 vertices from @xmath205 for @xmath1154 and @xmath245 $ ] . by construction @xmath1117",
    "is a balanced perfect @xmath216-packing in @xmath1115 $ ] and @xmath1102 divides @xmath1155 , as required .",
    "the final ingredient of the proof is a method to cover ` bad ' vertices .",
    "the row - decomposition of @xmath3 will have high minimum diagonal density , which implies that most vertices have high minimum diagonal degree .",
    "however , we need to remove those ` bad ' vertices which do not have high minimum diagonal degree , so that we can accomplish step ( iii ) of the proof outline in section  [ sec : outline ] , which is to glue together the perfect clique packings in each row to form a perfect @xmath0-packing in @xmath3 . lemma  [ diagonalmindeg ] will show that we can cover the bad vertices of @xmath3 by vertex - disjoint copies of @xmath0 , whilst keeping the block sizes balanced and fixing the parity of any pair - complete row , so that each row contains a clique packing covering all of the undeleted vertices .",
    "first we need some standard definitions .",
    "an @xmath208 _ rectangle _ @xmath1156 is a table of @xmath1157 cells arranged in @xmath206 rows and @xmath33 columns .",
    "we always assume that @xmath1158 .",
    "a _ transversal _",
    "@xmath662 in @xmath1156 is a collection of @xmath206 cells of the grid so that no two cells of @xmath662 lie in the same row or column .",
    "we need the following simple proposition .",
    "[ transversal ] suppose that @xmath1156 is an @xmath208 rectangle , where @xmath1159 and @xmath1160 .",
    "suppose that at most @xmath33 cells of @xmath1156 are coloured , such that at most one cell is coloured in each column , and at most @xmath1064 cells are coloured in each row .",
    "then @xmath1156 contains a transversal of non - coloured cells .",
    "we proceed by induction on @xmath206 .",
    "note that the proposition is trivial for the cases @xmath1161 and @xmath1162 .",
    "now assume that @xmath1163 and @xmath294 .",
    "choose a row with the most coloured cells , and select a non - coloured cell in this row ( this is possible since at most @xmath1064 of the @xmath33 cells in this row are coloured ) .",
    "let @xmath1164 be the @xmath1165 subrectangle obtained by removing the row and column containing this cell .",
    "then it suffices to find a transversal of non - coloured cells in @xmath1164 .",
    "note that @xmath1164 has at most @xmath1064 coloured cells , as if @xmath1156 had any coloured cells , then we deleted at least one coloured cell .",
    "also , since @xmath1156 had at most @xmath1166 coloured cells , @xmath1164 must have at most @xmath1167 cells coloured in any row , since we removed the row containing the most coloured cells .",
    "since @xmath1164 contains at most one coloured cell in any column , the required transversal in @xmath1164 exists by the induction hypothesis .",
    "the remainder of this section is occupied by the proof of lemma  [ diagonalmindeg ] .",
    "this is long and technical , so to assist the reader we first give an overview .",
    "we start by imposing structure on the graph @xmath3 , fixing a row - decomposition with high minimum diagonal density .",
    "let @xmath205 , @xmath237 $ ] , @xmath245 $ ] be the blocks of this row - decomposition .",
    "then we identify vertices that are ` bad ' for one of two reasons : ( i ) not having high minimum diagonal degree , or ( ii ) belonging to a pair - complete row and not having high minimum degree within its own half .",
    "we assign each bad vertex @xmath12 to a row in which it has as many blocks as possible that are ` bad ' for @xmath12 , in that they have many non - neighbours of @xmath12 , so that there are as few bad blocks for @xmath12 as possible in the other rows .",
    "we also refer to the resulting sets @xmath1168 , @xmath237 $ ] , @xmath245 $ ] as blocks , as although they may not form a row - decomposition , since few vertices are moved they retain many characteristics of a row - decomposition .",
    "if the row - decomposition has type @xmath1169)$ ] then @xmath1170 is approximately proportional to @xmath218 for @xmath237 $ ] .",
    "we establish some properties of the @xmath1168 s in claim [ partprops ] .",
    "next , we show how to find various types of @xmath0 in @xmath3 that will form the building blocks for the deletions .",
    "these will be ` properly distributed ' , in that they have @xmath218 vertices ( the ` correct number ' ) in row @xmath116 for @xmath237 $ ] , or ` @xmath1171-distributed ' for some @xmath1172 , in that they have ` one too many ' vertices in row @xmath116 and ` one two few ' vertices in row @xmath101 .",
    "they will also have an even number of vertices in each half of pair - complete rows so as to preserve parity conditions , except that sometimes we require a clique that is ` properly - distributed outside of row @xmath1173 ' to fix the parity of a pair - complete row @xmath1173 .",
    "claim  [ generalexpansion ] analyses a general greedy algorithm for finding copies of @xmath0 , and then claim  [ choosekk ] deduces five specific corollaries on finding building blocks of the above types . in claim  [ balancingrows ]",
    "we use @xmath1171-distributed cliques to balance the row sizes , so that the remainder of row @xmath1173 has size proportional to @xmath1174 for @xmath272 $ ] .",
    "there are two cases according to whether @xmath3 has the same row structure as the extremal example ; if it does we also ensure in this step that the remainder of each half in pair - complete rows has even size .",
    "next , in claim  [ preparing ] we put aside an extra @xmath0-packing that is needed to provide flexibility later in the case when there are at least two rows with @xmath1175 .",
    "then in claim  [ coverdiv ] we cover all remaining bad vertices and ensure that the number of remaining vertices is divisible by @xmath1176 .",
    "next , in claim  [ balancingcolumns ] we choose a @xmath0-packing so that equally many vertices are covered in each part @xmath7 .",
    "then in claim  [ balancingblocks ] we choose a final @xmath0-packing so that the remaining blocks all have size proportional to their row size . after deleting all these @xmath0-packings",
    "we obtain @xmath933 with an @xmath206-row - decomposition @xmath1067 that satisfies conclusion ( i ) of lemma [ diagonalmindeg ] . to complete the proof , we need to satisfy conclusion ( ii ) , by finding a balanced perfect @xmath216-packing in row @xmath116 for each @xmath237 $ ] .",
    "we need to consider two cases according to whether or not there are multiple rows with @xmath1175 ; if there are , then we may need to make some alterations to the @xmath0-packing from claim  [ preparing ] .",
    "finally , we apply the results of the previous section to find the required balanced perfect clique packings .",
    "[ diagonalmindeg ] suppose that @xmath1177 , @xmath1178 and @xmath1179 .",
    "let @xmath195 partition a set @xmath38 into @xmath33 parts @xmath97 each of size @xmath1180 , where @xmath1181 is an integer .",
    "suppose that @xmath3 is a @xmath195-partite graph on @xmath38 with @xmath1182 .",
    "suppose also that if @xmath1181 is odd and @xmath1 divides @xmath1180 then @xmath3 is not isomorphic to the graph @xmath1183 of construction  [ fischereg ] .",
    "we delete the vertices of a collection of pairwise vertex - disjoint copies of @xmath0 from @xmath3 to obtain @xmath1184 , @xmath1185 } v'_j$ ] and @xmath1186 $ ] , such that @xmath1187 for @xmath245 $ ] , where @xmath1188 and @xmath1189 .",
    "we can perform this deletion so that @xmath933 has an @xmath206-row - decomposition @xmath1067 , with blocks @xmath1190 for @xmath237 $ ] , @xmath245 $ ] of size @xmath1191 , where @xmath1192 $ ] with @xmath213 } p_i = k$ ] , with the following properties :    a.   for each @xmath1193 $ ] with @xmath258 and @xmath682 $ ] with @xmath259 , any vertex @xmath1194 has at least @xmath1195 neighbours in  @xmath1196 , b.   for every @xmath237 $ ] the row @xmath1197 $ ] contains a balanced perfect @xmath216-packing .",
    "introduce new constants with @xmath1198 .",
    "let @xmath2 be the integer such that @xmath1199 .",
    "note that @xmath1200 , so any vertex has at most @xmath2 non - neighbours in any other part . &",
    "( )    let @xmath69 be formed from @xmath38 by arbitrarily deleting @xmath1201 vertices in each part .",
    "we fix an @xmath206-row - decomposition of @xmath1202 $ ] . recall that this consists of pairwise disjoint blocks @xmath243 with @xmath244 for each @xmath237 $ ] , @xmath245 $ ] , for some @xmath240 $ ] and positive integers @xmath218 , @xmath237 $ ] with @xmath213 } p_i = k$ ] . by proposition  [ iterate",
    "] we may fix this row - decomposition to have minimum diagonal density at least @xmath286 , and such that each row @xmath1203 $ ] is not @xmath287-splittable .",
    "having fixed @xmath206 and the row - decomposition of @xmath1204 , introduce new constants with @xmath1205 .",
    "for each @xmath237 $ ] with @xmath225 , let @xmath1206 denote the infimum of all @xmath142 such that @xmath1203 $ ] is @xmath142-pair - complete .",
    "this gives us at most @xmath206 values of @xmath1206 , so we may choose @xmath1207 $ ] such that there is no @xmath237 $ ] with @xmath1208 .",
    "we let @xmath1209 , @xmath1210 , and introduce further new constants @xmath1211 and  @xmath1212 such that @xmath1213 these are the only constants which we shall use from this point onwards .",
    "the purpose of these manipulations is that our fixed row - decomposition has three important properties .",
    "firstly , it has minimum diagonal density at least @xmath215 , since @xmath1214 .",
    "secondly , any row @xmath1203 $ ] is not @xmath805-splittable , since @xmath1215 .",
    "thirdly , any row @xmath1203 $ ] which is @xmath805-pair - complete is @xmath142-pair - complete , since @xmath1216 by definition of @xmath1206 , and so @xmath1217 by choice of @xmath1218 .",
    "suppose first that @xmath1219 , so @xmath1204 has only one row @xmath1220 , and @xmath1221 .",
    "fix @xmath1222 such that @xmath1188 , and let @xmath1223 .",
    "then @xmath1224 . also , since @xmath1181 and @xmath1225 are integers , @xmath1226 is also an integer .",
    "we choose @xmath1226 pairwise - disjoint copies of @xmath0 in @xmath3 which together cover @xmath520 vertices in each @xmath7 . to see that this is possible note that , by @xmath1227 , for any @xmath180}{k}$ ] we may greedily choose the vertices of a copy of @xmath0 in @xmath3 of index @xmath252 ; this gives at least @xmath2 choices for each vertex , of which at most @xmath167 ( say ) have been previously used , so some choice remains .",
    "note that our use of @xmath1227 here is not tight , in the sense that the argument would still be valid if @xmath2 was replaced by @xmath1228 in the statement of @xmath1227 .",
    "this will be true of all our applications of @xmath1227 except for that in claim  [ balancingrows ] .",
    "we delete all of these copies of @xmath0 from @xmath3 , and let @xmath933 be the resulting graph .",
    "we let @xmath1229 consist of the @xmath1230 undeleted vertices of @xmath7 for each @xmath245 $ ] .",
    "then the sets @xmath1229 for @xmath245 $ ] form a @xmath214-row - decomposition of @xmath933 , which is not @xmath1231-splittable by lemma  [ robustness ] . since @xmath1232 ,",
    "@xmath1233 $ ] contains a balanced perfect @xmath0-packing by lemma  [ theoremmatching ] .",
    "we may therefore assume that @xmath294 .",
    "from each block @xmath205 we shall obtain a set @xmath1168 by moving a small number of ` bad ' vertices between blocks , and reinstating the vertices deleted in forming @xmath69 . as a consequence the sets @xmath1168 will not form a proper row - decomposition ( for example , blocks in the same row may have different sizes ) .",
    "however , since only a small number of vertices will be moved or reinstated , the partition of @xmath204 into sets @xmath1168 will retain many of the characteristics of the @xmath206-row - decomposition of @xmath1204 into blocks @xmath205 .",
    "we therefore keep the terminology , referring to the sets @xmath1168 as ` blocks ' , and the @xmath1234 and @xmath1235 as ` rows ' and ` columns ' respectively .",
    "perhaps it is helpful to think of the sets @xmath1168 as being containers which correspond to the blocks @xmath205 , between which vertices may be transferred .",
    "it is important to note , however , that the blocks @xmath205 will remain unchanged throughout the proof .",
    "furthermore , we shall sometimes refer to the row @xmath1236 $ ] simply as row  @xmath116 , but we say that a row @xmath116 is _ pair - complete _ if @xmath1203 $ ] is @xmath142-pair - complete .",
    "this means that the truth of the statement ` row @xmath116 is pair - complete ' depends only on our fixed row - decomposition of @xmath1204 , and not on the ` blocks ' @xmath1168 or their subsets defined later .",
    "note that if @xmath803 and row @xmath116 is not pair - complete then @xmath217 $ ] is not @xmath805-pair - complete .",
    "we start by identifying the _ bad _ vertices , which may be moved to a different block .",
    "for each @xmath237 $ ] and @xmath245 $ ] let @xmath1237 consist of all vertices @xmath1110 for which there exist @xmath499 and @xmath821 such that @xmath1238 .",
    "we must have @xmath1239 , otherwise for some @xmath499 and @xmath821 there are more than @xmath1240 vertices in @xmath205 with at most @xmath1241 neighbours in @xmath232 . then @xmath1242 contradicts the minimum diagonal density of @xmath1204",
    ".    next , for each @xmath237 $ ] for which row @xmath116 is pair - complete , by definition there are sets @xmath1243 of size @xmath2 for each @xmath245 $ ] such that @xmath1244 and @xmath1245 for any @xmath259 . for each @xmath245 $ ]",
    ", we let @xmath1246 consist of all vertices @xmath1247 for which there exists @xmath821 such that @xmath1248 , and also all vertices @xmath1249 for which there exists @xmath821 such that @xmath1250 .",
    "we must have @xmath1251 , otherwise ( without loss of generality ) there exists some @xmath821 for which more than @xmath1252 vertices in @xmath1253 have at most @xmath1254 neighbours in @xmath1255 .",
    "then @xmath1256 contradicts the choice of the sets @xmath1257 .",
    "thus we have bad sets @xmath1237 and @xmath1246 for @xmath237 $ ] , @xmath245 $ ] .",
    "we also consider the @xmath1201 deleted vertices in each part to be bad .",
    "let @xmath253 be the set of all bad vertices .",
    "the remaining vertices @xmath1258 are _ good _ ; let @xmath1259 , @xmath1260 } y^i_j$ ] and @xmath1261 } y^i_j$ ] for each @xmath116 and @xmath101 , so @xmath1262 } y^i$ ] .",
    "let @xmath12 be any vertex of @xmath3 .",
    "we say that a block @xmath205 is _ bad with respect to @xmath12 _ if @xmath1263 , that is , if @xmath12 has more than @xmath167 non - neighbours in @xmath205 .",
    "so if @xmath12 is a good vertex , then the set of blocks which are bad with respect to @xmath12 is a subset of the set of blocks in the same row and column as @xmath12 . also , by @xmath1227 for any @xmath1264 at most one block in each other column can be bad with respect to @xmath12 .",
    "similarly as with the notion of pair - completeness , this definition fixes permanently which blocks are bad with respect to a vertex @xmath12 .",
    "we shall later sometimes refer to a ` block ' @xmath1168 being bad with respect to @xmath12 ; this should always be taken to mean that @xmath205 is bad which respect to @xmath12 .",
    "we say that a block is _ good with respect to @xmath12 _ if it is not bad with respect to @xmath12 .",
    "we now define the sets @xmath1168 for each @xmath237 $ ] and @xmath245 $ ] as follows .",
    "any vertex in @xmath265 is assigned to @xmath1168 .",
    "it remains only to assign the bad vertices ; each bad vertex @xmath620 is assigned to @xmath1168 , where @xmath116 is a row containing the most blocks @xmath205 which are bad with respect to @xmath12 ( if more than one row has the most bad blocks then choose one of these rows arbitrarily ) . for each pair - complete row @xmath116 , we also modify the sets @xmath1253 to form sets @xmath1265 .",
    "indeed , @xmath1265 is defined to consist of all vertices of @xmath1266 , plus any vertex in @xmath1267 which has at least @xmath167 neighbours in @xmath1268 for some @xmath821 .",
    "we let @xmath1269 } s^i_j$ ] for any such @xmath116 .",
    "this completes the phase of the proof in which we impose structure on @xmath3 .",
    "the next claim establishes some properties of the decomposition into ` blocks ' @xmath1168 .",
    "[ partprops ] * ( structural properties ) *    1 .   at most @xmath1270 vertices of @xmath3",
    "we have @xmath1271 and @xmath1272 for any @xmath237 $ ] and @xmath245 $ ] . furthermore ,",
    "if row @xmath116 is pair - complete then @xmath1273 for any @xmath245 $ ] .",
    "3 .   let @xmath1274 .",
    "then @xmath12 has at most @xmath1275 non - neighbours in @xmath1276 for any @xmath499 and @xmath821 .",
    "furthermore , if row @xmath116 is pair - complete and @xmath821 then @xmath12 has at most @xmath1275 non - neighbours in @xmath1277 if @xmath1278 , and at most @xmath1275 non - neighbours in @xmath1279 if @xmath1280 .",
    "4 .   let @xmath1281 .",
    "then @xmath12 has at most @xmath1282 non - neighbours in any block @xmath1276 which is good with respect to @xmath12 .",
    "furthermore , if row @xmath116 is pair - complete then there is some @xmath821 such that @xmath12 has at most @xmath1282 non - neighbours in @xmath1277 if @xmath1278 , and at most @xmath1282 non - neighbours in @xmath1279 if @xmath1280 .",
    "5 .   for any @xmath116 with @xmath260 , there are at least @xmath1283 copies of @xmath1284 in @xmath1285 $ ] . furthermore",
    ", if row @xmath116 is pair - complete then there are at least @xmath1286 copies of @xmath18 in @xmath1287 $ ] and at least @xmath1286 copies of @xmath18 in @xmath1288 $ ] .    for ( a1 ) , note that since there were at most @xmath1289 bad vertices in each @xmath205 , the total number of bad vertices is at most @xmath1290 . for ( a2 ) , note that @xmath1291 , and any vertex of @xmath1292 or @xmath1293 is bad .",
    "since @xmath1294 , and there are at most @xmath1270 bad vertices by ( a1 ) , we conclude that ( a2 ) holds . for ( a3 ) , note that since  @xmath12 is good we have @xmath1295 for any @xmath499 and @xmath821 .",
    "since @xmath1296 by ( a1 ) , we conclude that @xmath1297 , as required . similarly , if row @xmath116 is pair - complete and @xmath1278 , then @xmath1247 , so @xmath12 being good implies that @xmath1298 for any @xmath821 . on the other hand , if @xmath1299 , then @xmath1249 , so @xmath12 being good implies that @xmath1300 for any @xmath821 .",
    "any non - neighbour of @xmath12 in @xmath1301 or @xmath1302 must be a bad vertex ; by ( a1 ) this completes the proof of ( a3 ) .",
    "next , for ( a4 ) suppose that @xmath1276 is good with respect to @xmath12 .",
    "recall that this means @xmath1303 . since any vertex in @xmath1304 is bad ,",
    "we find that @xmath1305 by ( a1 ) .",
    "so suppose now that row  @xmath116 is pair - complete .",
    "if @xmath12 is good , then the ` furthermore ' statement holds by ( a3 ) , so we may suppose that @xmath1306 . if @xmath1278 then by definition @xmath1307 for some @xmath821 , so @xmath1308 ; then @xmath1309 by ( a1 ) , since any vertex in @xmath1310 is bad .",
    "on the other hand , if @xmath1280 then by definition @xmath1311 , so @xmath1312 , for any @xmath821 . by @xmath1227",
    "this implies @xmath1313 , and so @xmath1314 by ( a1 ) .",
    "finally , for ( a5 ) suppose first that row @xmath116 is pair - complete , so @xmath225 .",
    "then by ( a2 ) we have @xmath1315 .",
    "furthermore , by ( a3 ) any vertex in one of these three sets has at most @xmath1275 non - neighbours in each of the other two sets .",
    "so we may choose vertices @xmath1316 , @xmath1317 and @xmath1318 in turn with at least @xmath1319 choices for each vertex .",
    "we conclude that there are at least @xmath1320 copies of @xmath18 in @xmath1287 $ ] .",
    "the same argument applied to the sets @xmath1321 shows that there are at least @xmath1320 copies of @xmath18 in @xmath1288 $ ] . on the other hand ,",
    "if row @xmath116 is not pair - complete , then we simply wish to find at least @xmath1283 copies of @xmath1284 in @xmath1285 $ ] .",
    "since @xmath1203 $ ] is not @xmath805-splittable , by lemma  [ splittable](ii ) ( with @xmath1322 in place of @xmath187 ) there are at least @xmath1323 copies of @xmath1284 in @xmath1203 $ ] . by ( a1 ) at most @xmath1324 such copies contain a bad vertex ; this leaves at least @xmath1325 copies of @xmath1326 in @xmath1285 $ ] .    in the next claim",
    "we analyse a general greedy algorithm that takes some fixed clique @xmath1327 in which all but at most one vertex is good , and extends it to a copy of @xmath0 with prescribed intersections with the blocks , described by the sets @xmath1328 .",
    "[ generalexpansion ] * ( extending cliques ) * let @xmath1327 be a clique in @xmath3 on vertices @xmath1329 , where @xmath1330 are good .",
    "suppose that @xmath1331 $ ] are pairwise - disjoint sets such that for each @xmath1332 $ ] there is some @xmath237 $ ] and @xmath1333 such that @xmath1334 .",
    "suppose also that for each @xmath237 $ ] one of the following five conditions holds :    a.   for every @xmath1333 , @xmath1168 contains some @xmath1335 with @xmath1332 $ ] , b.   @xmath1336 and @xmath1337 , c.   @xmath1336 and there is some block @xmath1168 with @xmath1333 which is good with respect to @xmath337 and does not contain a vertex of @xmath1327 , d.   @xmath1336 and @xmath1338 , e.   @xmath1339 .",
    "let @xmath1340 } |a_i|$ ] .",
    "then for any @xmath1341 there are at least @xmath1342 copies @xmath870 of @xmath1343 in @xmath1344 $ ] which extend @xmath1327 and satisfy the following properties .",
    "a.   @xmath870 intersects precisely those @xmath1168 with @xmath237 $ ] and @xmath1333 . b.   for any pair - complete row @xmath116 such that @xmath1345 and @xmath1346 we have that @xmath1347 is even .",
    "c.   consider any pair - complete row @xmath116 such that @xmath1348 and write @xmath1349 . if @xmath1168 is good with respect to @xmath337 and does not contain a vertex of @xmath1327 then @xmath1350 .",
    "if @xmath1351 , then by relabeling the columns @xmath1352 if necessary , we may assume that for any @xmath237 $ ] for which ( c ) holds , the block @xmath1353 is good with respect to @xmath337 and does not contain a vertex of @xmath1327 .",
    "we also note for future reference that the only properties of good vertices used in the proof of this claim will be those in ( a3 ) .",
    "first we define the greedy algorithm for extending @xmath1327 to @xmath870 , and then we will show that we have many choices for the vertex at each step of the algorithm .",
    "we proceed through each column @xmath7 , @xmath245 $ ] in turn .",
    "if @xmath101 is not in @xmath967 for any @xmath237 $ ] , then we take no action , since @xmath870 will not have a vertex in this column . similarly ,",
    "if @xmath1354 for some @xmath1332 $ ] , then we again take no action , since we already have a vertex of @xmath870 in this column , namely @xmath1335 ; note that @xmath1334 for the unique @xmath116 such that @xmath1333 , since the sets @xmath1355 are pairwise - disjoint . now",
    "suppose that @xmath1333 for some @xmath237 $ ] , and @xmath1356 .",
    "let @xmath1357 be the vertices previously chosen by the algorithm ( so not including @xmath1329 ) .",
    "we choose a vertex @xmath1358 } n(v_\\ell ) \\cap \\bigcap_{\\ell \\in [ t-1 ] } n(v'_\\ell)$ ] , so @xmath1359 induces a clique in @xmath3 .",
    "if row @xmath116 is pair - complete , @xmath1345 , @xmath1346 and we have previously selected a vertex @xmath1360 in @xmath1361 , then we also add the requirement that @xmath1362 if and only if @xmath1363 . if instead row @xmath116 is pair - complete and meets the conditions of ( iii ) then we instead add the requirement that @xmath1362 if and only if @xmath1364 . after proceeding through every @xmath245 $ ] we have a vertex of @xmath1168 for every @xmath237 $ ] and @xmath1333 ( some of which are the vertices of @xmath1327 ) .",
    "we let @xmath870 be the subgraph of @xmath3 induced by these vertices .",
    "then @xmath870 is a clique of size @xmath1365 in @xmath3 which extends @xmath1327 and satisfies  ( i ) .",
    "the additional requirements on the choice of vertices from any pair - complete row @xmath116 imply that @xmath870 must satisfy ( ii ) and ( iii ) also .",
    "having defined the greedy algorithm , we will now show that there are at least @xmath1366 choices at each step .",
    "first we consider the number of choices for some @xmath1367 in @xmath265 , where row @xmath116 is not a pair - complete row satisfying the conditions in ( ii ) or ( iii ) .",
    "note that since we are making this choice , @xmath1352 does not contain a vertex of @xmath1327 , so ( a ) does not apply to row @xmath116 . let @xmath1368 then @xmath1369 .",
    "we need to estimate @xmath1370 .",
    "note that each @xmath1371 has @xmath1372 by @xmath1227 . if @xmath1351 , then write @xmath1373 , so @xmath1374 also ; if @xmath1375 we let @xmath1376 .",
    "observe that any vertex of @xmath1377 is good , either by assumption ( for @xmath1378 ) or by selection ( since the greedy algorithm only selects vertices from some @xmath1379 ) .",
    "then any vertex of @xmath1380 lies in @xmath1381 for some @xmath1382 , and therefore has at most @xmath1275 non - neighbours in @xmath265 by ( a3 ) .",
    "so @xmath1370 is at least latexmath:[\\[\\label{eq : vertexchoices }    whilst this crude bound does not imply that we have even one possible choice for @xmath1367 , we will now show that any of the assumptions ( b)(e ) improves some part of the bound by at least @xmath1384 , which implies that there are at least @xmath1385 choices for @xmath1367 . if ( b ) pertains to row @xmath116 ( so @xmath1375 ) , then we have @xmath1386 instead of @xmath1374 .",
    "if ( d ) or ( e ) pertains to row @xmath116 , then we have the bound @xmath1387 in place of @xmath1388 .",
    "the same is true if ( c ) pertains to row @xmath116 , unless we are choosing the final vertex in @xmath1361 , that is @xmath1389 .",
    "then our initial relabeling implies that @xmath1168 is good with respect to @xmath337 , so ( a4 ) gives the bound @xmath1390 in place of @xmath1374 . in all cases the improvement of at least @xmath1384 to ( [ eq : vertexchoices ] ) yields at least @xmath1391 choices for @xmath1367 .",
    "it remains to consider the number of choices for some @xmath1367 in @xmath265 , where row @xmath116 is a pair - complete row satisfying the conditions in ( ii ) or ( iii ) .",
    "suppose first that row @xmath116 has the conditions of ( ii ) , namely @xmath1392 and @xmath1393 .",
    "suppose also that we have previously selected a vertex @xmath1394",
    ". then we must ensure that @xmath1395 if and only if @xmath1363 .",
    "note that these conditions imply that either ( b ) or ( c ) pertains to row @xmath116 .",
    "we will show that @xmath1396 in either case . in case of ( b )",
    "this holds because @xmath1397 is empty . in case of ( c ) ,",
    "@xmath1367 is the final vertex to be selected in row @xmath116 , and so our initial relabeling implies that @xmath1168 is good with respect to  @xmath337 ; then @xmath1396 by definition . since @xmath1360 is a good vertex ( by choice ) ,",
    "if @xmath1363 then by ( a3 ) we have @xmath1398 , or if @xmath1399 then by ( a3 ) we have @xmath1400 . in the former case we have @xmath1401 similarly , in the latter case we obtain @xmath1402 .",
    "so in either case there are at least @xmath1366 possible choices for @xmath1367 .",
    "finally , suppose that row @xmath116 has the conditions of ( iii ) , namely @xmath1348 and @xmath1168 is good with respect to  @xmath337 ( and @xmath1168 does not contain a vertex of @xmath1327 since we are choosing @xmath1367 )",
    ". then @xmath1403 by ( a4 ) , so @xmath1404 and @xmath1402 , giving us at least @xmath1366 choices for @xmath1367 , regardless of the value of @xmath1405 .    in conclusion , there are at least @xmath1366 suitable choices for each of the @xmath1406 vertices chosen by the greedy algorithm in extending @xmath1327 to @xmath870 , giving at least @xmath1342 choices for @xmath870 , as required .",
    "now we describe the various types of @xmath0 that will form the building blocks for the deletions .",
    "recall that the number of vertices in each row @xmath1361 is approximately proportional to @xmath218 .",
    "we say that a copy @xmath870 of @xmath0 in @xmath3 is _ properly - distributed _ if    a.   @xmath1407 for each @xmath237 $ ] , and b.   @xmath1347 is even for any pair - complete row @xmath237 $ ] .    also , for any @xmath1408 $ ] with @xmath386 we say that a copy @xmath870 of @xmath0 in @xmath3 is @xmath1171-_distributed _ if    a.   @xmath1409 , @xmath1410 , and @xmath1411 for each @xmath272 { \\setminus}\\{i , j\\}$ ] , and b.   @xmath1412 is even for any pair - complete row @xmath1413 .",
    "note that an @xmath1171-distributed clique @xmath870 has ` one too many ' vertices in row @xmath116 , and ` one too few ' in row @xmath101 . by deleting such cliques",
    "we can arrange that the size of each row @xmath1361 is _ exactly _ proportional to @xmath218 .",
    "thereafter we will only delete properly - distributed copies of @xmath0 , so that this property is preserved .",
    "also , condition ( ii ) in both definitions ensures that we preserve the correct parity of the halves in pair - complete rows .",
    "finally , we say that a copy @xmath870 of @xmath0 in @xmath3 is _ properly - distributed outside row @xmath1173 _",
    "if    a.   @xmath1407 for each @xmath237 $ ] , and b.   @xmath1347 is even for any pair - complete row @xmath1414 .    thus @xmath870 almost satisfies the definition of ` properly - distributed ' , except that if row @xmath1173 is pair - complete it may fail the parity condition for the halves . in the next claim",
    "we apply claim  [ generalexpansion ] to finding the building blocks just described .",
    "[ choosekk ] * ( building blocks ) * we can find copies of @xmath0 in @xmath3 as follows .",
    "a.   let @xmath1415 $ ] be pairwise - disjoint with @xmath1416 for each @xmath237 $ ] .",
    "then there are at least @xmath1417 properly - distributed copies @xmath870 of @xmath0 in @xmath3 such that for any @xmath237 $ ] , @xmath870 intersects @xmath1361 in precisely those @xmath1168 with @xmath1333 .",
    "b.   any vertex @xmath1264 lies in at least @xmath1418 properly - distributed copies of @xmath0 in @xmath3 . c.",
    "let @xmath1408 $ ] be such that @xmath260 and @xmath386 .",
    "then there are at least @xmath1419 @xmath1171-distributed copies @xmath870 of @xmath0 in @xmath1053 $ ] .",
    "furthermore , if row @xmath116 is pair - complete then for any @xmath1420 there are at least @xmath1419 such copies @xmath870 of @xmath0 with @xmath1421 .",
    "d.   let @xmath1408 $ ] be such that @xmath1422 and @xmath386 .",
    "suppose @xmath1423 is an edge in @xmath1236 $ ] such that @xmath1424 is a good vertex .",
    "then there are at least @xmath1425 @xmath1171-distributed copies @xmath870 of @xmath0 in @xmath3 that contain @xmath1424 and @xmath12 .",
    "furthermore , if row @xmath101 is pair - complete then for any @xmath1426 there are at least @xmath1425 such copies @xmath870 of @xmath0 with @xmath1427",
    ". e.   let @xmath237 $ ] be such that row @xmath116 is pair - complete , and @xmath1423 be an edge in @xmath1236 $ ] such that @xmath1424 is good .",
    "then there are at least @xmath1425 copies of @xmath0 in @xmath3 which contain both @xmath1424 and @xmath12 and are properly - distributed outside row @xmath116 .    for ( i ) we apply claim  [ generalexpansion ] to @xmath1428 with @xmath1337 , so condition ( b ) pertains to all rows .",
    "this gives at least @xmath1417 copies @xmath870 of @xmath0 in @xmath3 such that @xmath870 intersects precisely those @xmath1168 with @xmath237 $ ] and @xmath1333 , and @xmath1347 is even for any pair - complete row @xmath116 . since @xmath1416 for each @xmath237 $ ] , each such @xmath870 is properly - distributed .",
    "next we consider ( iii ) , as this is also a simple application of claim  [ generalexpansion ] ; we will come back to ( ii ) .",
    "we begin by choosing a copy @xmath1327 of @xmath1284 in @xmath1285 $ ] . by ( a5 ) , there are at least @xmath1283 such copies , and if row @xmath116 is pair - complete , there are at least @xmath1283 such copies with precisely @xmath1405 vertices in @xmath1429 .",
    "fix any such @xmath1327 and let @xmath967 be the set of @xmath1430 $ ] such that @xmath1327 has a vertex in column @xmath1431 , so @xmath1432 .",
    "now choose pairwise - disjoint subsets @xmath1433 { \\setminus}a_i$ ] with @xmath1434 and @xmath1435 for every @xmath272 { \\setminus}\\{i , j\\}$ ] .",
    "we may apply claim  [ generalexpansion ] with @xmath1327 and the sets @xmath1355 for @xmath272 $ ] , as condition ( a ) of the claim applies to row @xmath116 , condition ( e ) applies to row @xmath101 , and condition ( c ) applies to all other rows ( since every vertex of @xmath1327 is good ) .",
    "we deduce that there are at least @xmath1436 copies @xmath870 of @xmath0 which extend @xmath1327 such that @xmath1437 for any @xmath272 $ ] and @xmath1412 is even for any pair - complete row @xmath1438 .",
    "each such @xmath870 is @xmath1171-distributed , so in total we have at least @xmath1439 copies @xmath870 of @xmath0 with the required properties .",
    "for ( ii ) , ( iv ) and ( v ) we proceed similarly , but in each of these cases we have the possibility that the vertex @xmath12 might be bad , so satisfying requirement ( c ) in claim  [ generalexpansion ] is no longer trivial .",
    "we consider the blocks as an @xmath208 rectangle @xmath1156 , and colour those blocks which are bad with respect to @xmath12 .",
    "our strategy will be to delete some appropriate rows and columns from @xmath1156 , apply lemma  [ transversal ] to find a transversal @xmath662 of non - coloured blocks in the remaining subrectangle @xmath1164 , and then use @xmath662 to choose sets @xmath967 for @xmath237 $ ] which meet the conditions of claim  [ generalexpansion ] .",
    "we note the following properties of @xmath1156 :    1 .",
    "any column not containing  @xmath12 has at most one coloured block , 2 .   at most @xmath1167 coloured blocks",
    "lie outside the row containing @xmath12 , 3 .",
    "any row not containing @xmath12 has most @xmath1440 coloured blocks .    to see this ,",
    "recall that we observed ( r1 ) earlier , and ( r2 ) follows because @xmath12 lies in a row in which it has the most bad blocks .",
    "this also implies ( r3 ) , as any row not containing @xmath12 has most @xmath1441 coloured blocks , using the assumption that @xmath1179 .    for ( ii ) ,",
    "we let @xmath1173 and @xmath1442 be such that @xmath1443 , and suppose first that row @xmath1173 is not pair - complete ( we postpone the case where @xmath1173 is pair - complete to the end of the proof ) .",
    "we remove the row and column containing @xmath12 to obtain an @xmath1165 subrectangle @xmath1164 .",
    "since @xmath1164 contains at most @xmath1167 coloured blocks , with at most one in each column , it contains a transversal @xmath662 of non - coloured blocks by lemma  [ transversal ] . for each @xmath237 { \\setminus}\\{\\ell\\}$ ] let @xmath1444 be such",
    "that @xmath662 includes @xmath1445 .",
    "choose any pairwise - disjoint subsets @xmath1446 $ ] with @xmath1447 and @xmath1416 for each @xmath237 $ ] .",
    "we may apply claim  [ generalexpansion ] to @xmath967 , @xmath237 $ ] with @xmath1448 , since condition  ( d ) pertains to row @xmath1173 , and condition  ( c ) pertains to all other rows .",
    "this yields at least @xmath1449 copies @xmath870 of @xmath0 which extend @xmath1327 such that @xmath1347 is even for any pair - complete row @xmath116 and @xmath1450 for any @xmath237 $ ] .",
    "each such @xmath870 is a properly - distributed copy of @xmath0 in @xmath3 containing @xmath12",
    ".    for ( iv ) , let @xmath1451 and @xmath1452 be the columns with @xmath1453 and @xmath1454 , and let @xmath1455 .",
    "so @xmath1456 .",
    "suppose first that @xmath1457 .",
    "in this case we delete rows @xmath116 and @xmath101 and columns @xmath1451 and @xmath1452 from @xmath1156 , leaving an @xmath1458 subrectangle @xmath1164 .",
    "then @xmath1164 has at most one coloured block in each column , at most @xmath1440 coloured blocks in each row , and at most @xmath1167 coloured blocks in total , so contains a transversal @xmath662 of non - coloured blocks by lemma  [ transversal ] . for each @xmath272 { \\setminus}\\{i , j\\}$ ] let @xmath1459 be the column such that @xmath662 includes @xmath1460 , and choose pairwise - disjoint subsets @xmath1433 { \\setminus}a_i$ ] for @xmath272 { \\setminus}\\{i\\}$ ] such that @xmath1461 and @xmath1435 for each @xmath272 { \\setminus}\\{i , j\\}$ ] , and @xmath1462 .",
    "now suppose instead that @xmath1463 . in this case",
    "we delete row @xmath116 and columns @xmath1451 and @xmath1452 from @xmath1156 , leaving an @xmath1464 subrectangle @xmath1164 .",
    "then @xmath1164 has at most one coloured block in each column , at most @xmath1440 coloured blocks in each row , and at most @xmath1167 coloured blocks in total .",
    "since @xmath1463 we have @xmath1465 , so we may again apply lemma  [ transversal ] to find a transversal @xmath662 of non - coloured blocks in @xmath1164 . as before , for each @xmath272 { \\setminus}\\{i , j\\}$ ] let @xmath1459 be the column such that @xmath662 includes @xmath1460 , and choose pairwise - disjoint subsets @xmath1433 { \\setminus}a_i$ ] for @xmath272 { \\setminus}\\{i\\}$ ] such that @xmath1461 for any @xmath272 { \\setminus}\\{i\\}$ ] , @xmath1435 for each @xmath272 { \\setminus}\\{i , j\\}$ ] , and @xmath1466 . in either case we may apply claim  [ generalexpansion ] with @xmath1467 , since conditions ( a ) , ( e ) and ( c ) of claim  [ generalexpansion ] pertain to rows @xmath116 , @xmath101 and all other rows respectively .",
    "we deduce that there are at least @xmath1425 copies @xmath870 of @xmath0 in @xmath3 which extend @xmath1327 such that @xmath1437 for any @xmath272 $ ] and @xmath1412 is even for any pair - complete row @xmath1438 .",
    "each such @xmath870 is @xmath1171-distributed . furthermore",
    ", if row @xmath101 is pair - complete , then @xmath1468 , so @xmath1469 is in @xmath662 , so is good with respect to @xmath12 .",
    "so by claim  [ generalexpansion](iii ) there are at least @xmath1425 such copies @xmath870 with @xmath1427 , as required .    for ( v )",
    ", we again let @xmath1451 and @xmath1452 be the columns with @xmath1453 and @xmath1454 and @xmath1455 .",
    "so @xmath1392 . we delete row @xmath116 and columns @xmath1451 and @xmath1452 from @xmath1156 , leaving an @xmath1464 subrectangle @xmath1164 .",
    "then @xmath1164 has at most one coloured block in each column , at most @xmath1440 coloured blocks in each row , and at most @xmath1167 coloured blocks in total .",
    "since @xmath803 we have @xmath1465 , so as before lemma  [ transversal ] yields a transversal @xmath662 of non - coloured blocks in @xmath1164 .",
    "we let @xmath1460 , @xmath272 { \\setminus}\\{i\\}$ ] be the blocks of @xmath662 , and choose pairwise - disjoint subsets @xmath1433 { \\setminus}a_i$ ] such that @xmath1461 and @xmath1435 for any @xmath272 { \\setminus}\\{i\\}$ ] .",
    "we may apply claim  [ generalexpansion ] with @xmath1467 , since conditions ( a ) and ( c ) of claim  [ generalexpansion ] pertain to row @xmath116 and all other rows respectively .",
    "so there are at least @xmath1425 copies @xmath870 of @xmath0 in @xmath3 which extend @xmath1327 such that @xmath1470 for any @xmath272 $ ] and @xmath1412 is even for any pair - complete row @xmath1471 .",
    "each such @xmath0 is properly - distributed outside row @xmath116 .",
    "finally we consider the case of ( ii ) where row  @xmath1173 ( containing @xmath12 ) is pair - complete . by ( a4 ) and ( a2 ) there are at least @xmath1366 vertices @xmath1472 such that @xmath1473 is even . for any such @xmath1424 , by ( v )",
    "there are at least @xmath1425 copies @xmath870 of @xmath0 which extend @xmath1423 and are properly - distributed outside row @xmath1173 . each such @xmath870 is properly - distributed since @xmath1474 , so @xmath12 lies in at least @xmath1418 properly - distributed copies of @xmath0 .",
    "we now use claim  [ choosekk ] to select several @xmath0-packings in @xmath3 whose deletion leaves a subgraph @xmath933 which satisfies the conclusions of the lemma .",
    "the choice of these packings will vary somewhat according to the row structure of @xmath3 .",
    "we say that @xmath3 has the _ extremal row structure _ if it has the same row structure as the graphs @xmath28 of construction  [ fischereg ] , that is , if there is some row @xmath237 $ ] with @xmath260 which is pair - complete , and @xmath1475 for any @xmath499 ; this case requires special attention .",
    "the first step is the following claim , which balances the row sizes , so that the remainder of row @xmath116 has size proportional to @xmath218 for @xmath237 $ ] .",
    "this is the only step of the proof that requires the exact minimum degree condition ( whether or not @xmath3 has the extremal row structure ) .    [ balancingrows ] * ( balancing rows ) * there is a @xmath0-packing @xmath1123 in @xmath3 such that @xmath1476 and @xmath1477 is constant over all @xmath237 $ ] . if @xmath3 has the extremal row structure we can also require that @xmath1478 is even for the unique @xmath237 $ ] with  @xmath225 .",
    "we write @xmath1479 for each @xmath237 $ ] , where we recall that @xmath1181 is an integer , so @xmath112 is an integer .",
    "then @xmath213 } a_i = |v(g^+)| - rn^+ = 0 $ ] .",
    "let @xmath1480 , @xmath1481 and @xmath1482 . recall that @xmath1199 and @xmath1483 } |w^i_j| \\geq ( 1-\\beta/2)p_i rn$ ] for each @xmath116 by ( a2 ) .",
    "this gives @xmath1484 for each @xmath116 and @xmath1485 .",
    "we choose sequences @xmath1486)$ ] and @xmath1487)$ ] so that each @xmath1488 occurs @xmath112 times as some @xmath1489 , and each @xmath1490 occurs @xmath1491 times as some @xmath1492 .",
    "we divide the remainder of the proof into two cases according to whether or not @xmath3 has the extremal row structure .    * case 1 : @xmath3 does not have the extremal row structure . *",
    "we start by showing that for any @xmath1488 with @xmath1422 there is a matching @xmath1493 in @xmath1236 $ ] of size @xmath112 , each of whose edges contains a good vertex .",
    "we let @xmath1494 for each @xmath245 $ ] , so @xmath1495 for each @xmath101 by ( a2 ) ; note that the @xmath1496 are not necessarily integers . then @xmath1497 .",
    "by @xmath1227 , any @xmath1498 for any @xmath821 has at least @xmath1496 neighbours in @xmath1168 .",
    "we fix a matching @xmath79 in the bipartite graph @xmath1499 $ ] which is maximal with the property that every edge contains a good vertex .",
    "we will show that @xmath1500 . for suppose otherwise .",
    "then we may fix @xmath1501 and @xmath1502 which are not covered by @xmath79 . as noted above , @xmath1424 has at least @xmath1503 neighbours in @xmath1504 , and @xmath12 has at least @xmath1505 neighbours in @xmath1506 .",
    "since @xmath1424 and @xmath12 are good vertices , each of these neighbours must be covered by @xmath79 , by maximality of @xmath79 .",
    "thus there must be an edge @xmath1507 in @xmath79 with @xmath1508 and @xmath1509 . now removing @xmath1507 from @xmath79 and adding the edges @xmath1510 and @xmath1511 contradicts the maximality of @xmath79 .",
    "we conclude that @xmath1512 .",
    "now we greedily extend @xmath79 to a maximal matching @xmath1493 in @xmath1236 $ ] for which every edge of @xmath1513 contains a vertex of @xmath1514 .",
    "then @xmath1493 covers at least @xmath1496 vertices in @xmath1168 for each @xmath47 , and so has total size at least @xmath1515 } a_{ij } = a_i$ ] , as required .",
    "we now proceed through each @xmath1516 $ ] in turn . for each @xmath1173 , if @xmath1517 then we choose an edge @xmath1518 which has not been used for any @xmath1519 ( this is possible as @xmath1489 occurs @xmath1520 times as some @xmath1521 ) .",
    "we extend @xmath103 to an @xmath1522-distributed copy @xmath1523 of @xmath0 in @xmath3 , so that @xmath1523 is vertex - disjoint from any @xmath1524 previously selected for @xmath1519 and from any of the edges of @xmath1525 other than @xmath103 itself",
    ". then the extension of @xmath103 to @xmath1523 must avoid a set of at most @xmath1526 ` forbidden vertices ' . by claim  [ choosekk](iv ) , there are at least @xmath1527 extensions of @xmath103 to an @xmath1522-distributed copy of @xmath0 , so we may choose @xmath870 as desired . similarly ,",
    "if @xmath1528 then we choose an @xmath1522-distributed copy @xmath1523 of @xmath0 in @xmath3 which is vertex - disjoint from any previously chosen copy of @xmath0 and from the matchings @xmath1493 . as",
    "before this means we must avoid at most @xmath1529 forbidden vertices . by claim  [ choosekk](iii ) , there are at least @xmath1530 @xmath1522-distributed copies of @xmath0 in @xmath3 , so we can choose @xmath1523 as desired . at the end of this process",
    "we have a @xmath0-packing @xmath1531\\}$ ] with @xmath1532 .",
    "now consider any @xmath237 $ ] .",
    "if @xmath1488 ( so @xmath1533 ) then each copy of @xmath0 in @xmath1123 had @xmath218 vertices in @xmath1361 , except for @xmath112 copies which had @xmath1534 vertices in @xmath1361 ( these are the @xmath1523 with @xmath1535 ) . on the other hand ,",
    "if @xmath1536 ( so @xmath1537 ) then each copy of @xmath0 in @xmath1123 had @xmath218 vertices in @xmath1361 , except for @xmath1491 copies which had @xmath1538 vertices in @xmath1361 ( these are the @xmath1523 with @xmath1539 ) . in any case",
    "then @xmath1541 is a constant multiple of @xmath218 for each @xmath237 $ ] , so the proof of case 1 is complete .    * case 2 : @xmath3 has the extremal row structure .",
    "* let @xmath1542 be the unique row such that @xmath1543 , so row  @xmath1542 is pair - complete and @xmath1544 for any @xmath1545 . recall that in this case we must satisfy the additional condition that @xmath1546 is even .",
    "we divide the proof into two further cases according to whether or not @xmath1547 .    * case 2.1 : @xmath1548 .",
    "* we start by choosing copies @xmath1523 of @xmath0 for @xmath1549 exactly as in case 1 . for @xmath1550",
    "we consider three further cases , according to the value of @xmath1542 .    *",
    "case 2.1.1 : @xmath1551 . * as in case 1 , we use claim  [ choosekk](iii ) to choose @xmath1552 to be an @xmath1553-distributed copy of @xmath0 in @xmath3 that does not include a forbidden vertex .",
    "however , we also choose @xmath1552 so that @xmath1554 } v(k^{\\ell})|$ ] is even .",
    "this is possible as by claim  [ choosekk](iii ) there are at least @xmath1419 @xmath1553-distributed copies @xmath870 of @xmath0 in @xmath3 for each choice of parity of @xmath1555 .    *",
    "case 2.1.2 : @xmath1556 . * as in case 1 , we use claim  [ choosekk](iv ) to extend an edge @xmath1557 to an @xmath1553-distributed copy @xmath1552 of @xmath0 in @xmath3 avoiding all forbidden vertices . here",
    "we again impose the additional requirement that @xmath1554 } v(k^{\\ell})|$ ] is even .",
    "this is possible as by claim  [ choosekk](iv ) there are at least @xmath1425 extensions of @xmath103 to an @xmath1553-distributed copy @xmath870 of @xmath0 in @xmath3 for each choice of parity of @xmath1558 .    *",
    "case 2.1.3 : @xmath1559 . * in this case , instead of choosing the extension @xmath1552 of @xmath1557 to be @xmath1553-distributed , we extend @xmath103 to an @xmath1560-distributed copy @xmath1552 of @xmath0 in @xmath3 which avoids any forbidden vertices ( using claim  [ choosekk](iv ) as before ) .",
    "the @xmath0-packing @xmath1123 then covers ` one too many ' vertices in @xmath1561 and ` one too few ' in @xmath1562 . to correct this imbalance",
    ", we apply claim  [ choosekk](iii ) to choose an @xmath1563-distributed copy @xmath870 of @xmath0 in @xmath3 such that @xmath870 is vertex - disjoint from @xmath1123 and @xmath1564 is even .",
    "we add @xmath870 to @xmath1123 .    in each of the cases 2.1.1 , 2.1.2 , 2.1.3 we have @xmath1541 for each @xmath237 $ ] as in case 1 .",
    "we also have @xmath1546 even by construction , and @xmath1565 , noting in case 2.1.3 that we could have improved the bound on @xmath1365 to @xmath1566 .",
    "this completes the proof in case 2.1 .",
    "* case 2.2 : @xmath1567 . *",
    "note that @xmath1568 for each @xmath237 $ ] , so @xmath1569 is constant initially .",
    "if @xmath1570 is even then @xmath1571 has the required properties , so we may assume @xmath1570 is odd .",
    "now suppose that for some @xmath1545 there is an edge @xmath1423 in @xmath1236 $ ] such that @xmath1424 is good . by claim  [ choosekk](iv )",
    "we may extend @xmath1423 to an @xmath1572-distributed copy @xmath1573 of @xmath0 in @xmath3 .",
    "now apply claim  [ choosekk](iii ) to choose an @xmath1574-distributed copy @xmath1575 of @xmath0 in @xmath3 which does not intersect @xmath1573 so that @xmath1576 is even .",
    "we then have @xmath1577 with the required properties .",
    "so we may assume that no such edge exists .",
    "now suppose instead that @xmath1578 $ ] contains an edge @xmath1423 such that @xmath1424 is good and @xmath1579 . by claim  [ choosekk](v )",
    "we may extend @xmath1423 to a copy @xmath870 of @xmath0 which is properly - distributed outside row @xmath1542 .",
    "we may take @xmath1580 , as then @xmath1581 for any @xmath237 $ ] and @xmath1582 is even .",
    "so we may assume that no such edge exists .",
    "it follows that @xmath1583 for any @xmath1545 and @xmath245 $ ] .",
    "indeed , if @xmath1584 then choose @xmath821 and a good vertex @xmath1585 . then @xmath1424 has a neighbour @xmath1281 , since @xmath1424 has at most @xmath2 non - neighbours in any part , but we assumed no such edge @xmath1423 exists .",
    "likewise , it follows that @xmath1586 for any @xmath245 $ ] . for if ( say ) @xmath1587 , then choose @xmath821 and @xmath1588 ; then @xmath1424 has a neighbour @xmath1589 , giving an edge @xmath1423 that we assumed did not exist .",
    "now for any @xmath245 $ ] we have @xmath1590 , @xmath1591 , @xmath1592 , and @xmath1583 for any @xmath1545 . since @xmath1593 , we have @xmath1594 , and equality holds in each of these inequalities",
    ". then @xmath1 divides  @xmath1180 and @xmath1595 is odd .",
    "now , any good vertex @xmath1596 for @xmath237 $ ] and @xmath245 $ ] has @xmath203 neighbours in @xmath1597 for any @xmath821 . if @xmath1545 then none of these can lie in @xmath1598 , so we conclude that @xmath1599 .",
    "similarly , we deduce that any @xmath1600 has @xmath1601 and any @xmath1602 has @xmath1603 for any @xmath821 .",
    "it follows that for any @xmath258 and @xmath259 any vertex @xmath1281 has @xmath1604 .",
    "furthermore , any vertex @xmath1589 has @xmath1605 , and any vertex @xmath1606 has @xmath1607 .",
    "so every vertex of @xmath3 satisfies property ( a3 ) , which was shown to hold for all good vertices of @xmath3 in claim  [ partprops ] .",
    "this was the only property of good vertices used in the proof of claim  [ generalexpansion ] .",
    "so we may consider every vertex of @xmath3 to be good when applying claim  [ generalexpansion ] , and therefore also when applying claim  [ choosekk ] .",
    "the argument above then shows that we may choose @xmath1123 as desired if there exists any edge @xmath1423 in @xmath1361 for any @xmath1545 , or any edge @xmath1423 in @xmath1562 such that @xmath1579 .",
    "since @xmath3 is not isomorphic to @xmath1183 , there must be some such edge .",
    "this completes the proof of case 2.2 , and so of the claim .    in the next claim we put aside an extra @xmath0-packing @xmath1608 that is needed to provide flexibility later in the case when there are at least two rows with",
    "if instead @xmath3 has at most one row @xmath116 with @xmath260 then we take @xmath1609 .",
    "the proof of the claim is immediate from claim  [ choosekk](iii ) so we omit it .    [ preparing ] * ( preparing multiple rows with @xmath260 ) * suppose that at least two rows of @xmath3 have @xmath260 .",
    "then there is a @xmath0-packing @xmath1608 vertex - disjoint from @xmath1123 such that    a.   every vertex covered by @xmath1608 is good , and b.   @xmath1608 consists of @xmath1610 @xmath1171-distributed copies of @xmath0 in @xmath1053 $ ] for each ordered pair @xmath1611 with @xmath1408 $ ] , @xmath386 and @xmath1612 .",
    "note that ( ii ) implies that @xmath1613 and @xmath1614 is constant for @xmath237 $ ] by choice of @xmath1123 .",
    "the latter property will be preserved when we remove all subsequent packings , as they will only consist of properly - distributed cliques .",
    "next we cover all remaining bad vertices and ensure that the number of remaining vertices is divisible by @xmath1176 .",
    "[ coverdiv ] * ( covering bad vertices and ensuring divisibility ) * there is a @xmath0-packing @xmath1615 vertex - disjoint from @xmath1616 , consisting of at most @xmath1275 properly - distributed copies of @xmath0 , such that    a.   @xmath1617 } m_i$ ] covers every vertex of @xmath1618 , and b.   the number of vertices not covered by @xmath1617 } m_i$ ] is divisible by @xmath1176 .",
    "let @xmath1618 be the set of all bad vertices in @xmath3 which are not covered by @xmath1616 . then by ( a1 ) we have @xmath1619 .",
    "we fix @xmath1620 so that @xmath1621 modulo @xmath1118 ( recall that @xmath1181 is an integer ) .",
    "we will greedily choose @xmath1615 to consist of @xmath520 copies of @xmath0 .",
    "as long as some vertex @xmath1622 remains uncovered , we choose some such @xmath12 and select a properly - distributed copy of @xmath0 containing @xmath12 . once",
    "every vertex in @xmath1618 is covered we repeatedly choose a properly - distributed copy of @xmath0 until we have  @xmath520 copies of @xmath0 in total . at any step there are at most @xmath1623 forbidden vertices covered by @xmath1616 or a previously - chosen member of @xmath1615 , so there will always be a suitable choice available for the next member of @xmath79 by claim  [ choosekk](i ) or  ( ii ) .",
    "fix such an  @xmath1615 .",
    "then @xmath1624 }",
    "v(m_i)|/k = rn^+/k - |m_1 \\cup m_2| - c \\equiv 0 $ ] modulo @xmath1118 , so @xmath1624 } v(m_i)|$ ] is divisible by @xmath1625 .",
    "the penultimate @xmath0-packing is chosen so that equally many vertices are covered in each part @xmath7 .",
    "[ balancingcolumns ] * ( balancing columns ) * there is a @xmath0-packing @xmath1626 vertex - disjoint from @xmath1617 } m_i$ ] , consisting of properly - distributed cliques , such that    a.   @xmath1627 } v(m_i)| = k|\\bigcup_{i \\in [ 4 ] } m_i|/r$ ] for any @xmath245 $ ] , b.   @xmath1628 } v(m_i)| \\leq \\beta ' n/2 $ ] , and c.   @xmath1176 divides @xmath1629 .",
    "we let @xmath1630 } v(m_i ) \\cap v_j| - k|\\bigcup_{i \\in [ 3 ] } m_i|/r$ ] for each @xmath245 $ ] .",
    "so @xmath1515 } |v(m_i)| = 0 $ ] , and @xmath1631 } v(m_i)| \\leq 2 \\beta rk^3n$ ] for each @xmath245 $ ] .",
    "note also that each @xmath1632 must be an integer since @xmath33 divides both @xmath1624 } v(m_i)|$ ] ( by choice of @xmath1615 ) and @xmath1633 ( by assumption ) .",
    "similarly to the proof of claim [ balancingrows ] , we let @xmath1634 : a'_j > 0\\}$ ] , @xmath1635 : a'_j < 0 \\}$ ] , and @xmath1636 .",
    "we form sequences @xmath1637 and @xmath1638 such that each @xmath1639 occurs @xmath1640 times as some @xmath1641 , and each @xmath1642 occurs @xmath1643 times as some @xmath1644 .",
    "now , for each @xmath1645 $ ] choose sets @xmath1646}{k}$ ] such that @xmath1647 and @xmath1648 .",
    "for each @xmath180}{k}$ ] let @xmath1649 and @xmath1650 be the number of times that @xmath252 appears as some @xmath1651 or @xmath1652 respectively .",
    "note that @xmath1653 , so @xmath1654 for any @xmath180}{k}$ ] .",
    "fix an integer @xmath1655 such that @xmath1625 divides @xmath1655 and @xmath1656 .",
    "we choose @xmath1626 to consist of @xmath1657 properly - distributed copies of @xmath0 in @xmath3 with index @xmath252 for each @xmath180}{k}$ ] .",
    "since @xmath1658}{k } } ( n'_a - n_a ) = 0 $ ] , this will give us @xmath1659 ; note that @xmath1176 then divides @xmath1629 .",
    "we also require that these copies are pairwise vertex - disjoint , and vertex - disjoint from @xmath1617 } m_i$ ] .",
    "we may choose @xmath1626 greedily , since by claim  [ choosekk](i ) , for any @xmath180}{k}$ ] there are @xmath1417 copies of @xmath0 in @xmath3 with index @xmath252 , and when choosing each copy we only need to avoid the at most @xmath1660 vertices covered by @xmath1617 } m_i$ ] or previously chosen members of @xmath1626 .",
    "now , since for any @xmath1645 $ ] we have @xmath1661 and @xmath1662 , for any @xmath245 $ ] we have @xmath1663}{k } : j \\in a } ( c ' + n'_a - n_a ) = c ' \\binom{r-1}{k-1 } - a'_j = \\frac{k|m_4|}{r } - a'_j.\\ ] ] then @xmath1627 } v(m_i)| = k|m_4|/r - a'_j + |\\bigcup_{i \\in [ 3 ] } v(m_i ) \\cap v_j| = k|\\bigcup_{i \\in [ 4 ] } m_i|/r$ ] for any @xmath245 $ ] . finally , @xmath1628 } v(m_i)| \\leq c ' \\binom{[r]}{k } + 2\\beta rk^3 n \\leq \\beta ' n/2 $ ] .",
    "the final @xmath0-packing is chosen so that the remaining blocks all have size proportional to their row size .",
    "[ balancingblocks ] * ( balancing blocks ) * there is a @xmath0-packing @xmath1664 vertex - disjoint from @xmath1665 } m_i$ ] , consisting of properly - distributed cliques , such that defining @xmath1666 } m_i$ ] , @xmath1667 , @xmath1668 } x'{}^i_j$ ] and @xmath1669 } x'{}^i = v(g ) { \\setminus}v(m)$ ] , we have @xmath1670 for any @xmath237 $ ] and @xmath245 $ ] , where @xmath1671 is an integer divisible by @xmath1102 with @xmath1672 . thus @xmath1190 forms a row - decomposition of @xmath1673 $ ] of type @xmath238 .",
    "furthermore , any vertex @xmath1194 has at most @xmath1674 non - neighbours in any @xmath1196 with @xmath499 .    for each @xmath237 $ ] and @xmath245 $ ] we let @xmath1675 } m_i)$ ] , @xmath1676 } w'{}^i_j$ ] , @xmath1677 } w'^i_j$ ] , and @xmath1678 } w'_j$ ] .",
    "we may fix an integer @xmath1132 so that @xmath1679 for any @xmath237 $ ] , since @xmath1614 is constant for @xmath237 $ ] and each clique in @xmath1680 is properly - distributed .",
    "recall also that @xmath1681 is constant for each @xmath245 $ ] by choice of @xmath1626 .",
    "let @xmath1682 be the @xmath206 by @xmath33 integer matrix whose @xmath1683 entry is @xmath1684 .",
    "then each row of @xmath1685 sums to zero .",
    "furthermore , since @xmath1681 is constant for each @xmath245 $ ] we have @xmath1686 } q_{ij } = \\sum_{i \\in [ s ] } ( |w'{}^i_j| - p_id / r ) = |w'_j| - |w'|/r = 0,\\ ] ] i.e.  each column of @xmath1685 also sums to zero .",
    "we also have @xmath1687 using ( a2 ) and claim [ balancingcolumns](ii ) .",
    "we write @xmath1688 , where @xmath1689 is a multiset of matrices .",
    "each matrix in @xmath1689 is of the form @xmath1690 , for some @xmath1691 $ ] and @xmath1692 $ ] , defined to have @xmath1683 entry equal to @xmath214 if @xmath1693 or @xmath1694 , equal to @xmath1695 if @xmath1696 or @xmath1697 , and equal to zero otherwise . to see that such a representation is possible",
    ", we repeat the following step .",
    "suppose @xmath1698 for some @xmath1699 .",
    "since each row and column of @xmath1685 sum to zero , we may choose @xmath1700 such that @xmath1701 and @xmath1702 .",
    "then @xmath1703 is an @xmath206 by @xmath1 integer matrix in which the entries of each row and column sum to zero .",
    "also , writing @xmath1704 , we have @xmath1705 .",
    "by iterating this process at most @xmath1706 times we obtain the all - zero matrix , whereupon we have expressed @xmath1685 in the required form with @xmath1707 , counting with multiplicity .",
    "let @xmath1708 denote the set of all families @xmath950 of pairwise vertex - disjoint subsets @xmath1446 $ ] with @xmath1416 for @xmath237 $ ] . to implement a matrix @xmath1709 we fix any two families",
    "@xmath1710 such that @xmath1711 and @xmath1712 , and @xmath1713 is formed from @xmath950 by swapping @xmath1405 and @xmath142 .",
    "that is , @xmath1714 if @xmath237 { \\setminus}\\{a , c\\}$ ] , @xmath1715 and @xmath1716 . for each @xmath1717 let @xmath1718 be the number of times it is chosen as @xmath950 for some @xmath1690 , and @xmath1719 the number of times it is chosen as @xmath1713 for some @xmath1690 .",
    "fix an integer @xmath1720 such that @xmath1625 divides @xmath1720 and @xmath1721 . for each @xmath1717 let @xmath1722 , so @xmath1723 .",
    "now we greedily choose @xmath1664 to consist of @xmath1724 copies of @xmath870 for each @xmath1717 , each of which will intersect each @xmath1361 in precisely those @xmath1168 such that @xmath1333 .",
    "then we will have @xmath1725 .",
    "when choosing any copy of @xmath0 we must avoid the vertices of copies of @xmath0 which were previously chosen for @xmath1664 , or which lie in @xmath1665 } m_i$ ] ; there are at most @xmath1726 such vertices . by claim  [ choosekk](i ) , for any @xmath1717 there are at least @xmath1417 properly - distributed copies of @xmath0 in @xmath3 which intersect each @xmath1361 in precisely those @xmath1168 such that @xmath1333 , so we can indeed choose @xmath1664 greedily .",
    "this defines @xmath79 , @xmath1190 , @xmath1727 , @xmath1074 , @xmath1067 , @xmath1039 , @xmath933 as in the statement of the claim .",
    "note that @xmath1728 , and @xmath1625 divides @xmath1729 by claims [ coverdiv](ii ) and [ balancingcolumns](iii ) and the choice of @xmath1720 .    finally , consider the number of vertices used in @xmath1730 , where @xmath1731 $ ] , @xmath1732 $ ] .",
    "if @xmath1717 is chosen uniformly at random , then @xmath1733 is a uniformly random subset of size @xmath1734 , so contains @xmath1405 with probability @xmath1735 .",
    "so if we chose @xmath1720 copies of each @xmath1717 we would choose @xmath1736 vertices in @xmath1730 , where @xmath1737 .",
    "however , since we choose @xmath1724 copies of each @xmath1717 , we need to adjust by @xmath1738 .",
    "these are chosen so that for each matrix @xmath1709 we choose one more vertex in each of @xmath1730 and @xmath1739 , and one fewer vertex in each of @xmath1740 and @xmath1741 . since @xmath1688 we thus use @xmath1742 vertices in @xmath1730 .",
    "this gives @xmath1743 .",
    "writing @xmath1744 , we have @xmath1671 , so @xmath1039 is an integer divisible by @xmath1102 .",
    "note also that @xmath1745 .",
    "lastly , by choice of @xmath1615 every bad vertex is covered by @xmath79 , so any vertex @xmath1194 has at most @xmath1674 non - neighbours in any @xmath1196 with @xmath499 and @xmath821 by ( a3 ) .    after deleting @xmath79 as in claim [ balancingblocks ]",
    ", we obtain @xmath933 with an @xmath206-row - decomposition @xmath1067 that satisfies conclusion ( i ) of lemma [ diagonalmindeg ] . to complete the proof , we need to satisfy conclusion ( ii ) , by finding a balanced perfect @xmath216-packing in row @xmath116 for each @xmath237 $ ] .",
    "we consider two cases according to whether or not there are multiple rows with @xmath1175 .    * case 1 : there is at most one row @xmath116 with @xmath1175 .",
    "*    * case 1.1 : @xmath1422 for any @xmath237 $ ] . * for each @xmath237 $ ]",
    "there is a trivial balanced perfect @xmath1746-packing in @xmath1197 $ ] , namely @xmath1747 .",
    "this satisfies condition ( ii ) , so the proof is complete in this case .",
    "* case 1.2 : @xmath3 has the extremal row structure .",
    "* this means that @xmath3 has one pair - complete row @xmath1542 , and @xmath1422 for any @xmath1545 .",
    "there is a trivial balanced perfect @xmath1746-packing in @xmath1197 $ ] for any @xmath1545 , so it remains only to find a balanced perfect matching in @xmath1748 $ ] . since row @xmath1542 is pair - complete , we chose sets @xmath1749 for @xmath245 $ ] when forming the sets @xmath1168 .",
    "let @xmath1750 for each @xmath245 $ ] .",
    "then @xmath1751 and so @xmath1752 for each @xmath245 $ ] . recall also that in this case we required that @xmath1546 was even when choosing @xmath1123 , and @xmath1608 was empty .",
    "furthermore , any copy @xmath870 of @xmath0 in @xmath1753 was chosen to be properly - distributed , so in particular @xmath1754 is even .",
    "we conclude that @xmath1755 is even .",
    "since every bad vertex of @xmath3 was covered by @xmath1756 , by ( a3 ) for any @xmath821 any vertex in @xmath1757 has at most @xmath1758 non - neighbours in @xmath1759 , and any vertex in @xmath1760 has at most @xmath1758 non - neighbours in @xmath1761 by ( a3 ) . by lemma  [ paircompletematching ]",
    "( with @xmath1762 in place of @xmath1763 ) we conclude that @xmath1748 $ ] contains a balanced perfect matching , completing the proof in this case .    * case 1.3 : @xmath1764 for some @xmath1173 , @xmath1765 for any @xmath1766 , but row @xmath1173 is not pair - complete . *",
    "recall that this means that @xmath1767 $ ] was not @xmath805-pair - complete .",
    "recall also that @xmath1767 $ ] was not @xmath805-splittable ( this is true of any row of @xmath1204 ) .",
    "since by ( a2 ) we have @xmath1768 for any @xmath245 $ ] , proposition  [ robustness ] implies that @xmath1769 $ ] is neither @xmath1231-splittable nor @xmath1231-pair - complete .",
    "so @xmath1769 $ ] contains a @xmath1770-balanced perfect matching by corollary  [ findmatching ]",
    ". then proposition  [ onepcrow ] implies that there exists an integer @xmath1771 and a @xmath0-packing @xmath1772 in @xmath3 such that @xmath1102 divides @xmath1773 , @xmath1772 covers @xmath1114 vertices in @xmath1190 for any @xmath237 $ ] and @xmath245 $ ] , and @xmath1774 $ ] contains a balanced perfect matching . note that since @xmath1775 we have @xmath1776 .",
    "we add the copies of @xmath0 in @xmath1772 to @xmath79 , and let @xmath1777 , @xmath1778 , @xmath1779 , @xmath1780 be obtained from @xmath1190 , @xmath1727 , @xmath1067 , @xmath933 by deleting the vertices covered by @xmath1772 .",
    "this leaves an @xmath206-row - decomposition of @xmath1780 into blocks @xmath1777 of size @xmath1781 , in which @xmath1782 $ ] contains a balanced perfect matching . as before @xmath1783 $ ] contains a trivial balanced @xmath1746-packing for every @xmath1414 .",
    "finally , any vertex @xmath1194 has lost at most @xmath1784 neighbours in @xmath1196 for any @xmath258 and @xmath259 , so still has at least @xmath1785 .",
    "so the enlarged matching @xmath79 , restricted blocks @xmath1777 and @xmath1780 satisfy ( i ) and ( ii ) with @xmath1786 in place of @xmath1039 , which completes the proof of this case , and so of case 1 .    * case 2 : there are at least two rows @xmath116 with @xmath1175 . * in this case we modify the cliques in @xmath1608 and the blocks @xmath1190 so that after these modifications @xmath1787 $ ] contains a balanced perfect @xmath216-packing for each @xmath237 $ ] . we proceed through",
    "each @xmath237 $ ] in turn .",
    "when considering any @xmath237 $ ] we leave all blocks @xmath1788 with @xmath499 unaltered . if @xmath1422 , then we have already seen that @xmath1787 $ ] contains a trivial balanced @xmath1746-packing .",
    "suppose next that @xmath224 , and recall that @xmath1789 $ ] was not @xmath805-splittable .",
    "as in case 1.3 , proposition  [ robustness ] implies that @xmath1197 $ ] is not @xmath1231-splittable .",
    "so @xmath1197 $ ] contains a balanced perfect @xmath216-packing by lemma  [ theoremmatching ] .",
    "this leaves only those rows @xmath237 $ ] with @xmath225 to consider .",
    "suppose first that row @xmath116 is pair - complete . as in case 1.2 we let @xmath1790 for each @xmath245 $ ] , which gives @xmath1791 for each @xmath245 $ ] , and for any @xmath821 , any vertex in @xmath1792 has at most @xmath1793 non - neighbours in @xmath1794 , and any vertex in @xmath1795 has at most @xmath1793 non - neighbours in @xmath1796 .",
    "if @xmath1797 is even then @xmath1787 $ ] contains a balanced perfect matching by lemma  [ paircompletematching ] .",
    "so we may suppose that @xmath1797 is odd .",
    "fix any @xmath649 with @xmath1382 and @xmath1798 .",
    "we choose any @xmath1799-distributed copy @xmath870 of @xmath0 in @xmath1608 , let @xmath75 be the vertex of @xmath870 in @xmath1727 , and let @xmath101 be such that @xmath1800 . by claim  [ preparing](i ) , every vertex in @xmath870 is good , so at least @xmath1801 vertices @xmath1802 are adjacent to every member of @xmath1803 .",
    "so we may choose a vertex @xmath1804 such that @xmath1805 is odd .",
    "we replace @xmath870 in @xmath79 by the copy of @xmath0 in @xmath3 induced by @xmath1806 , and replace @xmath262 by @xmath75 in @xmath1190 and @xmath933 .",
    "we also delete @xmath262 from @xmath1792 if @xmath1807 , and add @xmath75 to @xmath1792 if @xmath1808 .",
    "so @xmath1809 is now even .",
    "since @xmath75 is good , we may now apply lemma  [ paircompletematching ] as in case 1.2 to find a balanced perfect matching in @xmath1197 $ ] .",
    "finally suppose that @xmath225 and row @xmath116 is not pair - complete , that is @xmath1203 $ ] was not @xmath805-pair - complete . since @xmath1203 $ ] was also",
    "not @xmath805-splittable , as before proposition  [ robustness ] implies that @xmath1197 $ ] is neither @xmath1231-splittable nor @xmath1231-pair - complete .",
    "fix any @xmath649 with @xmath1382 and @xmath1798 . recall that @xmath1608 contains @xmath1610 copies @xmath870 of @xmath0 in",
    "@xmath1053 $ ] which are @xmath1799-distributed .",
    "we can fix @xmath1430 $ ] so that at least @xmath1810 such @xmath870 have exactly one vertex in @xmath1811 .",
    "we assign arbitrarily @xmath1810 such @xmath870 to each ordered triple @xmath1812 of distinct elements of @xmath843 { \\setminus}\\{q\\}$ ] , so that at least @xmath1813 of the @xmath870 are assigned to each triple .",
    "now , fix any triple @xmath1814 and any @xmath870 which was assigned to it .",
    "let @xmath75 be the vertex of @xmath870 in @xmath1811 , and consider paths @xmath1815 of length @xmath804 in @xmath3 with @xmath1816 for @xmath1817 $ ] and @xmath1818 . since every vertex of @xmath1819 is good and does not lie in @xmath1361 , at most @xmath1820 vertices @xmath1821 fail to be adjacent to all of @xmath1803 . choosing @xmath1822 and @xmath262 in turn , recalling @xmath1227 and @xmath1672 ,",
    "there are at least @xmath1823 choices for each @xmath1824 , and at least @xmath1825 choices for @xmath262 .",
    "we obtain at least @xmath1826 such paths , and so we may fix some @xmath1827 which lies in at least @xmath1828 such paths . for each of these @xmath1828 paths @xmath1815",
    "we add a ` fake ' edge between @xmath262 and @xmath480 . then allowing the use of fake edges",
    ", @xmath262 lies in at least @xmath1828 @xmath804-cycles @xmath1829 of length @xmath804 in @xmath3 with @xmath1816 for @xmath1817 $ ] .",
    "we introduce fake edges in this manner for every @xmath870 in @xmath1608 which was assigned to the triple @xmath1814 , for every ordered triple @xmath1814 of distinct elements of @xmath843 { \\setminus}\\{q\\}$ ] .",
    "let @xmath839 be the graph formed from @xmath1830 $ ] by the addition of fake edges .",
    "then by construction , for any triple @xmath1814 there are at least @xmath1831 @xmath804-cycles @xmath1832 in @xmath839 with @xmath1821 and @xmath1816 for @xmath1817 $ ] .",
    "furthermore , @xmath839 contains a spanning subgraph @xmath1830 $ ] which is neither @xmath1231-splittable nor @xmath1231-pair - complete , and has @xmath1833 ) \\geq 2n ' - n \\geq n ' - \\zeta n$ ] .",
    "then @xmath839 contains a balanced perfect matching @xmath1772 by lemma  [ theoremmatching ] ( with @xmath1834 in place of @xmath214 ) .",
    "of course , @xmath1772 may contain fake edges .",
    "however , any fake edge in @xmath1772 is of the form @xmath1835 , where @xmath480 is a neighbour of @xmath75 , and @xmath75 lies in some @xmath870 in @xmath1608 . since @xmath1836 is uniquely determined by @xmath75 and @xmath1772 is a matching , at most one edge in @xmath1772 has the form @xmath1835 for each @xmath75 .",
    "furthermore , by choice of @xmath1827 , @xmath1806 induces a copy @xmath1837 of @xmath0 in @xmath3 , and @xmath1838 is an edge .",
    "so we may replace @xmath870 in @xmath1608 by @xmath1837 , replace @xmath262 in @xmath1839 by @xmath75 ( note that @xmath75 is good ) , and the fake edge @xmath1840 in @xmath1772 by the edge @xmath1838 of @xmath3 .",
    "we carry out these substitutions for every fake edge in @xmath1772 , at the end of which @xmath1772 is a perfect matching in @xmath1197 $ ] , which is balanced since each edge was replaced with another of the same index .    when considering row @xmath116 we only replace cliques of @xmath1608 that are @xmath1799-distributed for some @xmath499 .",
    "these cliques uniquely determine @xmath116 , so do not affect the replacements for other rows .",
    "we may therefore proceed through every @xmath237 $ ] in this manner . after doing so , the modified blocks @xmath1190 are such that @xmath1197 $ ] contains a balanced perfect @xmath216-packing for any @xmath237 $ ] , i.e.  this row - decomposition of the modified @xmath933 satisfies condition ( ii ) of the lemma .",
    "note that we still have @xmath1841 for any @xmath237 $ ] . since we only replaced good vertices with good vertices ,",
    "every vertex in any modified block @xmath1190 is good , and so condition ( i ) of the lemma holds as in claim [ balancingblocks ] .",
    "this completes the proof of lemma [ diagonalmindeg ] .",
    "in this final section we combine the results of previous sections to prove theorem  [ partitehajnalszem ] .",
    "we also need the following lemma from  @xcite , which gives a minimum degree condition for finding a perfect matching in a @xmath1-partite @xmath1-graph whose vertex classes each have size @xmath2 .",
    "[ partitevertexdegree ] suppose @xmath1842 and @xmath3 is a @xmath1-partite @xmath1-graph on vertex classes @xmath5 of size @xmath2 .",
    "if every vertex of @xmath3 lies in at least @xmath1843 edges of @xmath3 then @xmath3 contains a perfect matching .",
    "we can now give the proof of theorem  [ partitehajnalszem ] , as outlined in section  [ sec : outline ] , which we first restate .    * theorem  [ partitehajnalszem ] .",
    "* _ for any @xmath29 there exists @xmath30 such that for any @xmath31 with @xmath32 the following statement holds .",
    "let @xmath3 be a @xmath33-partite graph whose vertex classes each have size  @xmath2 such that @xmath34 .",
    "then @xmath3 contains a perfect @xmath0-packing , unless @xmath35 is odd , @xmath36 , and @xmath37 .",
    "_    first suppose that @xmath14 , so a perfect @xmath0-packing is a perfect matching .",
    "if @xmath1844 then @xmath3 is a bipartite graph with minimum degree at least @xmath167 , so has a perfect matching . for @xmath1163",
    "the result follows from tutte s theorem , which states that a graph @xmath3 on the vertex set @xmath38 contains a perfect matching if and only if for any @xmath1845 the number of odd components ( i.e.  connected components of odd size ) in @xmath1846 $ ] is at most @xmath1847 . to see that this implies the theorem for @xmath14 , suppose for a contradiction that there is some @xmath1845 for which @xmath1846 $ ] has more than @xmath1847 odd components .",
    "clearly @xmath1848 .",
    "so by averaging @xmath1849 has fewer than @xmath167 vertices in some @xmath7 . since @xmath1850",
    ", every @xmath1851 has a neighbour in @xmath1852 , so @xmath1846 $ ] has at most @xmath1853 components .",
    "so we must have @xmath1854 .",
    "but then @xmath1849 must have fewer than @xmath1855 vertices in some @xmath7 , so any @xmath1851 has more than @xmath1856 neighbours in @xmath7 .",
    "it follows that @xmath1846 $ ] has at most @xmath1857 components , so @xmath1858 .",
    "so any @xmath1851 actually has more than @xmath1859 neighbours in @xmath7 , so @xmath1846 $ ] has at most @xmath65 components .",
    "so @xmath1860 . if @xmath1861 then @xmath1862 is odd , so @xmath1846 $ ] can not have @xmath65 odd components .",
    "the only remaining possibility is that @xmath1863 and @xmath3 has @xmath65 odd components .",
    "let @xmath1864 and @xmath1865 be these components , and for each @xmath1866 $ ] and @xmath245 $ ] let @xmath535 be the vertices of @xmath7 covered by @xmath1867 .",
    "then @xmath1868 , so we deduce that @xmath1869 and @xmath1870 $ ] is a complete bipartite graph for any @xmath1866 $ ] and @xmath259 .",
    "so @xmath1871 is odd , @xmath65 divides @xmath2 and @xmath3 is isomorphic to @xmath1872 , contradicting our assumption .",
    "we may therefore assume that @xmath1873 .",
    "if @xmath1874 then theorem  [ partitehajnalszem ] holds by the result of @xcite .",
    "so we may assume that @xmath1179 .",
    "we introduce new constants @xmath142 and @xmath805 with @xmath1875",
    ". since @xmath1179 and @xmath1178 we may apply lemma  [ diagonalmindeg ] ( with @xmath2 and @xmath142 in place of @xmath1180 and @xmath1876 ) to delete the vertices of a collection of pairwise vertex - disjoint copies of @xmath0 from @xmath3 .",
    "letting @xmath927 be the set of undeleted vertices , we obtain @xmath1186 $ ] and an @xmath206-row - decomposition of @xmath933 into blocks @xmath1190 of size @xmath1191 for @xmath237 $ ] and @xmath245 $ ] , for some @xmath240 $ ] and @xmath1192 $ ] with @xmath213 } p_i = k$ ] , such that @xmath1188 , @xmath1877 and    a.   for each @xmath1193 $ ] with @xmath258 and @xmath682 $ ] with @xmath259 , any vertex @xmath1194 has at least @xmath1878 neighbours in  @xmath1196 , and b.   for every @xmath237 $ ] the row @xmath1197 $ ] contains a balanced perfect @xmath216-packing @xmath971 .    note that we must have @xmath1879 for any @xmath237 $ ] .",
    "now we implement step ( iii ) of the proof outline , by constructing auxiliary hypergraphs , perfect matchings of which describe how to glue together the perfect @xmath216-packings in the rows into a perfect @xmath0-packing of @xmath3 .",
    "we partition @xmath68 $ ] arbitrarily into sets @xmath967 with @xmath1416 for @xmath237 $ ] .",
    "let @xmath1880 denote the set of all injective functions @xmath234 \\to [ r]$ ] .",
    "for each @xmath237 $ ] we partition @xmath971 into sets @xmath1881 of size @xmath1882 for @xmath1883 , so that each member of @xmath1881 has index @xmath1884 . to see that this is possible , fix any @xmath1885}{p_i}$ ] .",
    "since @xmath971 is balanced , @xmath1886 members of @xmath971 have index @xmath253 .",
    "note that there are @xmath1887 members of @xmath1880 with @xmath1888 . since @xmath1889 we may choose the sets @xmath1881 as required .",
    "for every @xmath1883 , we form an auxiliary @xmath206-partite @xmath206-graph @xmath236 with vertex classes @xmath1881 for @xmath237 $ ] , where a set @xmath1890 with @xmath1891 for each @xmath237 $ ] is an edge of @xmath236 if and only if @xmath1892 for any @xmath386 , @xmath1893 and @xmath1894 .",
    "thus @xmath236 has @xmath857 vertices in each vertex class , and @xmath1895 is an edge of @xmath236 if and only if @xmath1896 } v(e_j)$ ] induces a copy of @xmath0 in @xmath3 .",
    "next we show that each @xmath236 has high minimum degree .",
    "fix @xmath1883 and @xmath237 $ ] .",
    "then for any @xmath1891 , @xmath1897 is a copy of @xmath216 in @xmath1197 $ ] with index @xmath1884 , and so by ( i ) each vertex @xmath1898 has at most @xmath1899 non - neighbours in each @xmath1900 with @xmath1471 and @xmath1901 .",
    "so at most @xmath1902 vertices of @xmath1903 are not neighbours of some vertex of  @xmath1897 .",
    "now we can estimate the number of @xmath1904-tuples @xmath1905 { \\setminus}\\{i\\})$ ] so that @xmath1906 is not an edge of @xmath236 .",
    "there are fewer than @xmath1 choices for @xmath1907 { \\setminus}\\{i\\}$ ] , at most @xmath1908 elements @xmath1909 that contain a non - neighbour of some vertex of  @xmath1897 , and at most @xmath1910 choices for @xmath1911 , @xmath1912 { \\setminus}\\{i , j\\}$ ] .",
    "so the number of edges of @xmath236 containing @xmath1897 is at least @xmath1913 .",
    "since @xmath1897 was arbitrary , lemma  [ partitevertexdegree ] gives a perfect matching in each @xmath236 .",
    "this corresponds to a perfect @xmath0-packing in @xmath3 covering the vertices of @xmath1914 } v(e_\\sigma^i)$ ] , where @xmath1915 denotes the vertices covered by members of @xmath1881 . combining these perfect @xmath0-packings , and adding the pairwise vertex - disjoint copies of @xmath0 deleted in forming @xmath933",
    ", we obtain a perfect @xmath0-packing in @xmath3 .",
    "by examining the proof , one can obtain a partial stability result , i.e.  some approximate structure for any @xmath33-partite graph @xmath3 with vertex classes each of size  @xmath2 , where @xmath32 , such that @xmath1916 , but @xmath3 does not contain a perfect @xmath0-packing . to do this , note that under this weaker minimum degree assumption , the @xmath2 in @xmath1227 must replaced by @xmath1228 .",
    "we now say that a block @xmath205 is bad with respect to @xmath12 if @xmath12 has more than @xmath1917 non - neighbours in @xmath205 , so it is still true that at most one block in each column is bad with respect to a given vertex . then each of our applications of @xmath1227 proceeds as before , except for in claim  [ balancingrows ] , where we used the exact statement of @xmath1227 ( i.e. the exact minimum degree hypothesis ) .",
    "this was needed to choose a matching @xmath1493 in @xmath1236 $ ] of size @xmath112 , each of whose edges contains a good vertex , for each @xmath1488 with @xmath1422 .",
    "if we can choose such matchings @xmath1493 then the rest of the proof to give a perfect @xmath0-packing still works under the assumption @xmath1916 .",
    "so we can assume that there is some @xmath1488 with @xmath1422 for which no such matching exists .",
    "since the number of bad vertices and @xmath112 are @xmath1918 , it follows that @xmath1361 is a subset of size @xmath1919 with @xmath1920 edges , i.e.  we have a sparse set of about @xmath1921-proportion of the vertices . on the other hand , this is essentially all that can be said about the structure of @xmath3 , as any such @xmath3 with an independent set of size @xmath1922 can not have a perfect @xmath0-packing ."
  ],
  "abstract_text": [
    "<S> the celebrated hajnal - szemerdi theorem gives the precise minimum degree threshold that forces a graph to contain a perfect @xmath0-packing . </S>",
    "<S> fischer s conjecture states that the analogous result holds for all multipartite graphs except for those formed by a single construction . </S>",
    "<S> recently , we deduced an approximate version of this conjecture from new results on perfect matchings in hypergraphs . in this paper , we apply a stability analysis to the extremal cases of this argument , thus showing that the exact conjecture holds for any sufficiently large graph . </S>"
  ]
}