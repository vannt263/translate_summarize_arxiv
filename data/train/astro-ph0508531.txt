{
  "article_text": [
    "it is likely that structures in the universe grow from small initially gaussian density perturbations that progressively detach from the general expansion , reach a maximum radius and then collapse to form bound objects .",
    "larger haloes are formed hierarchically by mergers between smaller ones . + two different kinds of methods are widely used for the study of the structure formation .",
    "the first one is n - body simulations that are able to follow the evolution of a large number of particles under the influence of the mutual gravity from initial conditions to the present epoch .",
    "the second one is semi - analytical methods . among these ,",
    "press - schechter ( ps ) approach and its extensions ( eps ) are of great interest , since they allow us to compute mass functions ( press & schechter 1974 ; bond et al 1991 ) , to approximate merging histories ( lacey & cole 1993 , lc93 hereafter , bower 1991 , sheth & lemson 1999b ) and to estimate the spatial clustering of dark matter haloes ( mo & white 1996 ; catelan et al 1998 , sheth & lemson 1999a ) .",
    "+ in this paper , we present merger - trees based on monte carlo realizations .",
    "this approach can give significant information regarding the process of the formation of haloes .",
    "we focus on the mass growth histories of haloes and we compare these with the predictions of n - body simulations . + this paper is organized as follows : in sect.2 basic equations are summarized . in sect.3 the algorithm for the construction of merger - trees as well as tests regarding the reliability of this algorithm are presented .",
    "mass - growth histories are presented in sect.4 , while the results are summarized and discussed in sect.5 .",
    "in an expanding universe , a region collapses at time @xmath0 , if its overdensity at that time exceeds some threshold . the linear extrapolation of this threshold up to the present time is called a barrier , b. a likely form of this barrier is as follows : @xmath1\\ ] ] in eq.(1 ) @xmath2 , @xmath3 and @xmath4 are constants , @xmath5 , where @xmath6 is the linear extrapolation up to the present day of the initial overdensity of a spherically symmetric region , that collapsed at time @xmath0 .",
    "additionally , @xmath7 , where @xmath8 is the present day mass dispersion on comoving scale containing mass @xmath9 .",
    "@xmath10 depends on the assumed power spectrum .",
    "the spherical collapse model ( sc ) has a barrier that does not depend on the mass ( eg .",
    "lc93 ) . for this model",
    "the values of the parameters are @xmath11 and @xmath12 .",
    "the ellipsoidal collapse model ( ec ) ( sheth & tormen 1999 , st99 hereafter ) has a barrier that depends on the mass ( moving barrier ) .",
    "the values of the parameters are @xmath13 ,  @xmath14 ,   @xmath15 and are adopted either from the dynamics of ellipsoidal collapse or from fits to the results of n - body simulations .",
    "additionally , the non - radial ( nr ) model of del popolo & gambera ( 1998 ) -that takes into account the tidal interaction with neighbors- corresponds to @xmath13 ,  @xmath16 and @xmath17 .",
    "+ sheth & tormen ( 2002 ) connected the form of the barrier with the form of the multiplicity function .",
    "they show that given a mass element -that is a part of a halo of mass @xmath18 at time @xmath19- the probability that at earlier time @xmath0 this mass element was a part of a smaller halo with mass @xmath9 is given by the equation : @xmath20\\mathrm{d}s\\ ] ] where @xmath21 and @xmath22 with @xmath23 .",
    "+ the function @xmath24 is given by : @xmath25^n}{n ! }    \\frac{\\mathrm{\\partial ^n}}{\\partial s^n}b(s , t).\\ ] ] setting @xmath26 , and @xmath27 in eq . 3",
    ", we can predict the unconditional mass probability @xmath28 , that is the probability that a mass element is a part of a halo of mass @xmath9 , at time @xmath0 . the quantity",
    "@xmath29 is a function of the variable @xmath30 alone , where @xmath31 .",
    "since @xmath32 and @xmath33 evolve with time in the same way , the quantity @xmath29 is independent of time . setting @xmath34 ,",
    "one obtains the so - called multiplicity function @xmath35 .",
    "the multiplicity function is the distribution of first crossings of a barrier @xmath36 by independent uncorrelated brownian random walks ( bond et al .",
    "that is why the shape of the barrier influences the form of the multiplicity function .",
    "the multiplicity function is related to the comoving number density of haloes of mass @xmath9 at time @xmath0 -@xmath37- by the relation , @xmath38 that results from the excursion set approach ( bond et al .",
    "1991 ) . in eq.4",
    ", @xmath39 is the density of the model of the universe at time @xmath0 .",
    "+ using a barrier of the form of eq.1 in the unconditional mass probability , the following expression for @xmath35 is found : @xmath40\\exp\\left(-0.5a\\nu^2[1+\\beta(\\alpha \\nu^2)^{-\\gamma}]^2\\right)\\ ] ] where @xmath41        in fig.1 we plot @xmath42 versus @xmath30 .",
    "the solid line results from eq . 5 for the values of the parameters that correspond to the sc model .",
    "the dotted line is derived from the values of ec model while the dashed line corresponds to the nr model . for matter of completeness",
    ", we draw two more lines . the first line , the one with thick dashes- corresponds to the function of jenkins et al .",
    "( 2001 , j01 hereafter ) .",
    "this satisfies the following equation : @xmath43\\mid^{3.8})\\ ] ] in order to express the above relation as a function of @xmath30 , we substitute @xmath44 and we assume a constant value of @xmath32 , that of the einstein - de sitter universe , namely @xmath45 .",
    "the above formula is valid for @xmath46 .",
    "the second additional line , dot - dashed one , is the function proposed by st99 and is : @xmath47 where @xmath48 and the values of the constants are : @xmath49 , @xmath50 and @xmath51 .",
    "+ we have noted that the comparison of the above curves with the results of n - body simulations is in a very good agreement , except for the sc model . such a comparison is presented by yahagi et al .",
    "according to their results , the numerical multiplicity functions reside between the st99 and j01 multiplicity functions at @xmath52 and are below the st99 function at @xmath53 .",
    "additionally , the numerical multiplicity functions have an apparent peak at @xmath54 -as those given by eq .",
    "5- instead of the plateau that is seen in the j01 function .",
    "let there be a number of haloes with the same present day mass @xmath18 .",
    "the purpose of merger - trees realizations is to study the past of these haloes .",
    "this is done by finding the distribution of their progenitors ( haloes that merged and formed the present day haloes ) at previous times . a way to do",
    "this is by using eq.2 .",
    "first of all , one has to use a model for the universe and a power spectrum .",
    "in what follows we have assumed a flat model for the universe with present day density parameters @xmath55 and @xmath56 where @xmath57 is the cosmological constant and @xmath58 is the present day value of hubble s constant .",
    "we used the value @xmath59 with @xmath60 and a system of units with @xmath61 , @xmath62 and a gravitational constant @xmath63 . at this system of units",
    "@xmath64 + regarding the power spectrum- that defines the relation between @xmath10 and @xmath9 in eq.2- we employed the @xmath65 formula proposed by smith et al .",
    "the power spectrum is smoothed using the top - hat window function and is normalized for @xmath66 . + for each one of the sc , ec and nr models , we studied four different cases .",
    "these four cases differ to the present day mass of the haloes under study and are denoted as sc1 , sc2 , sc3 , sc4 for the sc model , ec1 , ec2 , ec3 and ec4 for the ec model and nr1 , nr2 , nr3 and nr4 for the nr model .",
    "the first case of each model ( sc1 , ec1 and nr1 ) corresponds to haloes with mass 0.1 -measured in our system of units- while the second case ( sc2 , ec2 and nr2 ) corresponds to mass 1 .",
    "sc3 , ec3 , nr3 correspond to haloes with mass 10 and sc4 , ec4 , nr4 correspond to masses 100 .",
    "+ pioneered works for the construction of merger - trees are those of lc93 , somerville & kollat ( 1999 ) , st99 and van de bosch ( 2002 , vdb02 ) .",
    "many of their ideas are used for the construction of our algorithm , that is described below .",
    "+ first , let us define as @xmath67 , the number of realizations used .",
    "this number is the total number of present day haloes of given mass @xmath18 .",
    "a mass cutoff @xmath68 is used , that is a lower limit for the mass of progenitors .",
    "no progenitors with mass less than @xmath68 exist in the merger history of a halo .",
    "@xmath68 is set to a fixed fraction of @xmath18 . in what follows , @xmath69",
    "( see also vdb02 ) . also , @xmath70 is the minimum value of the scale factor .",
    "we set @xmath71 .",
    "merging histories do not extend to values of @xmath72 .",
    "a discussion about the choice of @xmath70 is given in section 4 . + useful matrices which have been used are the following : @xmath73 ( the masses of the parent haloes ) ,  @xmath74 ( the masses that are left to be resolved ) and @xmath75 ( the masses of the progenitors ) .",
    "the argument @xmath76 takes the values from @xmath77 to @xmath78 , where @xmath78 is the number of haloes that are going to be resolved .",
    "initially , @xmath79 .",
    "the values of @xmath80 are used as input .",
    "we discuss the choice of the value of @xmath81 in section 4 .",
    "the scale factor @xmath82 is set to its initial value , ( that is the present day one ) , @xmath83 .",
    "then , the matrices @xmath73 and @xmath74 take their values : @xmath84 ,   @xmath85 for @xmath86 .",
    "it is convenient to set a counter for the number of time steps , so we set @xmath87 .",
    "the rest of the procedure consists of the following steps : + * 1st step * : @xmath88 .",
    "+ the equation @xmath89 is solved for @xmath90 , that is the new , ( current ) value of the scale factor . +",
    "* 2nd step * : for @xmath91 + * 3rd step * a value of @xmath92 is chosen from the desired distribution . + * 4th step * : the mass @xmath93 of the progenitor is found , solving for @xmath93 the equation : @xmath94 .",
    "if @xmath95 then , we return to the 3rd step . else , the halo with mass @xmath93 is a progenitor of the parent halo @xmath76 .",
    "the mass to be resolved is now given by : @xmath96 .",
    "if @xmath97 then @xmath93 is too small and is not considered as a real progenitor , therefore we return to the 3rd step .",
    "else , + * 5th step * : the number of progenitors is increased by one , ( @xmath98 ) , and the new progenitor is stored to the list @xmath99 . +",
    "* 6th step * : if the mass left to be resolved exceeds the minimum mass , ( @xmath100 ) , we go back to the 3rd step .",
    "else , we return to the 2nd step , where the next value of @xmath76 is treated . + * 7th step * : we set the new number of haloes @xmath78 to be the number of progenitors , @xmath101 .",
    "we store the progenitors , @xmath102 .",
    "the masses of new parents are defined as the masses of progenitors by @xmath103 .",
    "the value of the scale factor is updated @xmath104 , as well as the mass left to be resolved , @xmath105 . if @xmath106 we stop .",
    "else , we return to the first step",
    ". + output is the list of progenitors after a desired number of time steps . regarding the third step",
    ", we have the following remarks . for the sc case",
    ", the change of variables @xmath107 leads to a gaussian distribution with zero mean value and unit variance for the new variable @xmath108 .",
    "so , we pick values @xmath108 from the above gaussian ( that is the well - known and very fast procedure press et al .",
    "the values of @xmath109 are distributed according to the distribution described in eq .",
    "2 . the distributions in the ec and nr cases",
    "can not be expressed using a gaussian , so a more general method is used .",
    "this method , described in press et al .",
    "( 1990 ) is as follows : + let s suppose that we would like to pick numbers from a distribution function @xmath110 , where the variable @xmath108 takes positive values in the interval @xmath111 $ ] .",
    "first , we calculate the integral @xmath112 .",
    "we note that @xmath113 is not necessarily equal to unity .",
    "then , a number , let say @xmath114 , between zero and @xmath113 is picked from a uniform distribution . the integral equation : @xmath115 is solved for @xmath108 .",
    "the resulting points @xmath116 are then uniformly distributed in the area between the graph of @xmath117 , the x - axis and the lines @xmath118 and @xmath119 .",
    "the values of @xmath108 have the desired distribution .",
    "we have to note that this procedure is -as it is expected- more time demanding than the sc .",
    "this is mainly due to the numerical solution of the integral equation .",
    "however , it has the advantage of being general .",
    "+ in eq.2 , @xmath120 becomes an one variable function for given values of @xmath121 and @xmath0 .",
    "then , the above described general procedure is used in order to pick values of @xmath10 . for numerical reasons , it is convenient to use a new variable @xmath122 .",
    "+ the distribution of the masses of progenitors is found using the following procedure : let @xmath123 be the number of progenitors of @xmath67 parent haloes at time @xmath0 and let @xmath124 be the minimum and the maximum mass of these progenitors , respectively .",
    "we divide the interval @xmath125 $ ] to a set of @xmath126 intervals of length @xmath127 .",
    "then , the number of progenitors , @xmath128 , in the interval @xmath129 $ ] for @xmath130 is found .",
    "the distribution of progenitors masses is then given by @xmath131 .",
    "this distribution has to be compared with the distribution that results from the analytical relations .",
    "thus , multiplying eq.2 by @xmath132 , one finds the expected number of progenitors at @xmath0 that lie in the range of masses @xmath133 .",
    "this number obeys the equation : @xmath134 which is known as the number - weighted probability for @xmath9 .",
    "( redshift @xmath135 ) .",
    "all curves correspond to a halo with present day mass @xmath136 . the smooth dotted and the crooked dotted lines give @xmath137 and @xmath138 versus @xmath139 for the sc1 model , respectively .",
    "smooth solid and crooked solid lines give @xmath137 and @xmath138 for the nr1 model , respectively . in a similar way , the line with short thick dashes correspond to ec1 model.,width=529 ]    in figs 2 and 3 , the distributions of progenitors are plotted for all models studied , for two different values of the scale factor .",
    "the results of fig.2 correspond to scale factor @xmath140 and those of fig.3 to @xmath141 .",
    "details are given in the captions of the figs .",
    "large differences between the predictions of spherical and non - spherical models are shown .",
    "these differences are very clear and they can be seen even if a relatively small sample of haloes is used ( we used @xmath142 ) .",
    "on the other hand , the predictions for the two non - spherical models nr and ec are very close . +     ( redshift @xmath143 ) .",
    "all curves correspond to a halo with present day mass @xmath144 . the smooth dotted and the crooked dotted lines give @xmath137 and @xmath138 versus @xmath139 for the sc3 model , respectively .",
    "smooth solid and crooked solid lines give @xmath137 and @xmath138 for the nr3 model , respectively .",
    "lines with short thick dashes correspond to the results of ec3 model .",
    "the smooth line gives @xmath137 while the crooked one gives @xmath138.,width=529 ]    the time evolution of halo s mass is known as its mass growth history . however , a clear definition of the halo s mass at time @xmath0 is needed .",
    "one can define as halo s mass at a step , the mass of its most massive progenitor at that step .",
    "we call this procedure the _ most massive _ progenitor approximation .",
    "a different approximation is the one followed by vdb02 .",
    "we call this approximation the _ main _ progenitor approximation and it is as follows : at the first step , the most massive progenitor @xmath145 of a halo is found .",
    "this is the halo s mass at that time . at the next step ,",
    "the most massive progenitor of the halo with mass @xmath145 is found and is considered as the new halo s mass .",
    "the procedure is repeated for the next steps .",
    "according to the definition of lc93 , the scale factor at which the mass of the _ main _ progenitor equals half the present day mass of the halo is called the _ formation _ scale factor .",
    "we denote it by @xmath146 .",
    "a detailed description of the procedure follows : + * 1st step * : @xmath88 .",
    "+ the equation @xmath89 is solved for @xmath90 that is the new ( current ) value of the scale factor . + * 2nd step*:for @xmath147 + the mass of the most massive progenitor of parent @xmath76 is set equal to zero ( @xmath148 ) . + * 3rd*. a value of @xmath92 from the desired distribution is chosen . + * 4th step * : a mass @xmath93 is found , solving for @xmath93 the equation : @xmath94 . if @xmath95 then , we go back to the 3rd step .",
    "else , the halo with mass @xmath93 is a progenitor .",
    "we set @xmath96 . if @xmath97 then @xmath93 is too small and is not considered as a real progenitor and so we return to the 3rd step .",
    "else , + * 5th step * : the most massive progenitor at this time step is found .",
    "+ @xmath149 . + * 6th step * : if the mass left to be resolved exceeds the minimum mass , ( @xmath100 ) , we go back to the third step .",
    "else , we check if the mass of the most massive progenitor is for the first time smaller than half the initial mass of the halo . if this is correct , then the formation scale factor of this halo is defined by linear interpolation : @xmath150 otherwise , we proceed with the next @xmath76 . + * 7th step * : the list of the most massive progenitors is used , in order to find the mean mass at this time step .",
    "the time of the scale factor is updated @xmath104 , as well as the mass left to be resolved , @xmath151 .",
    "if @xmath152 we stop , else we go to the first step .",
    "+ we have to note that the halo s mass at a step -derived by the above procedure- does not give the mass of its most massive progenitor at that step . for example , let a halo of mass @xmath18 that has at the first step two progenitors with masses @xmath153 and @xmath154 with @xmath155 .",
    "then , the mass of the halo at the second step is defined as the mass of the most massive progenitor ( @xmath153 ) .",
    "this progenitor is not necessarily the most massive of all progenitors at that step , since it could be less massive than one of the progenitors of @xmath154 .",
    "the procedure of _ main _ progenitor described above has the advantage of being economic .",
    "it does not require the construction of a complete set of progenitors in order to find the most massive one at a step .",
    "+ we tested both the _ most massive _ and the _ main _ progenitor approximations and we found small differences only for massive haloes . in order to be able to compare our results with those of other authors",
    ", we used the _",
    "progenitor approximation . + a test for the reliability of merger - trees is the comparison of the distribution of formation scale factors with the one given by the analytical relations that follow .",
    "the probability that the mass of the progenitor , at time @xmath0 , is larger than @xmath156 is given by : @xmath157        the formation time is defined ( lc93 ) as the epoch when the mass of the halo , as it grows by mergers with other haloes , crosses the half of its present day value .",
    "then , @xmath158 is the probability the halo with present day mass @xmath18 had a progenitor heavier than @xmath156 at @xmath0 , which is equivalent to the probability that the halo is formed earlier than @xmath0 , @xmath159 .",
    "thus , @xmath160 .",
    "differentiating with respect to @xmath0 , we obtain : @xmath161\\mathrm{d}m\\ ] ] which gives the distribution of formation times .",
    "+ the distribution of formation scale factors as it results from eq.13 is plotted in fig .",
    "4 . the left hand side snapshot corresponds to haloes with present day mass 0.1 , while the right hand side one to haloes with present day mass 100 . in every snapshot",
    "dotted , solid and dashed lines correspond to sc , nr and ec models , respectively . notice that the distributions that correspond to nr and ec models are shifted to the left relative to the sc model .",
    "this means that structures formed earlier in the nr and ec models . as it can be seen in fig .",
    "4 , the differences between spherical and non - spherical models are smaller for larger haloes .",
    "as it is known in the literature(e.g yahagi et al , 2004 and references therein ) , the results of non - spherical models are in good agreement with the results of n - body simulations .",
    "consequently , for massive haloes , the results of n - body simulations are close to the predictions of the spherical models , as well .",
    "this disagrees with the results of vdb02 which predicts that the disagreement between spherical model and n - body simulations is larger for massive haloes .",
    "+        fig.5 consists of four snapshots .",
    "bars show the distributions of formation scale factor as they result from eq.11 .",
    "wide bars are the predictions of sc model , while narrow filled bars are the results of ec or nr models .",
    "solid lines are the predictions of eq . 13 for the sc model , while dashed lines are the predictions of the same eq .",
    "for ec or nr models .",
    "the two snapshots of the first row show the results of sc1 and ec1 ( left snapshot ) and sc1 and nr1 ( right snapshot ) while the two snapshots of the second row show the results of sc4 and ec4 ( left snapshots ) and sc4 and nr4 ( right snapshot ) .",
    "it is shown that the predictions of eq .",
    "13 are in very good agreement with the numerical distributions .",
    "additionally , it is clear that the differences between the distributions of various models , resulting from eq .",
    "13 , are successfully reproduced by numerical distributions .",
    "it is also shown that differences between spherical and non - spherical models are more significant for haloes of small mass .",
    "we define as mass - growth history , mgh , of a halo with present - day mass @xmath18 , the curve that shows the evolution of @xmath162 where @xmath163 is the mean mass at scale factor @xmath82 of haloes with present day mass @xmath18 .",
    "two input parameters are used in the method of construction merger - trees in the procedure described in the previous section .",
    "the first one is the time - step @xmath81 . for values of @xmath164 ,",
    "it is shown ( vdb02 ) that mghs are not time - step dependent . according to that , we used a value @xmath165 .",
    "the second parameter is @xmath70 .",
    "our results are derived for @xmath71 . in order to justify this choice ,",
    "let us discuss the following points regarding the definition of the mean mass .",
    "let @xmath166 be the number of haloes at scale factor @xmath82 that have masses greater than @xmath68 . obviously , @xmath167 .",
    "let also @xmath168 be the mass of the @xmath169 halo at scale factor @xmath82 .",
    "we define by @xmath170 the sum @xmath171 , where for @xmath172 the sum is extended to all haloes that satisfy @xmath173 . for @xmath174 the sum",
    "is extended to all haloes ( obviously in that case , the masses of a number of haloes are equal to zero since , by the construction of merger - trees , their mass histories are not followed beyond @xmath175 . finally , for @xmath176 the sum is over those haloes that satisfy @xmath177 .",
    "then , we can define the mean mass at @xmath82 in three different ways : first @xmath178 , second @xmath179 and third @xmath180 . + as @xmath82 evolves from its present day value to smaller values , the number @xmath166 becomes smaller and the three mean values defined above become different .",
    "it is clear that @xmath181 overestimates the mean value , while @xmath182 underestimates it . on the other hand",
    ", @xmath183 requires a large number of @xmath67 so that the remaining sample of haloes @xmath184 to be large enough .",
    "the choice of the value @xmath71 is justified by the fact that for @xmath185 the differences in the above three definitions are negligible .",
    "+ the following results have been derived using a number of 10000 haloes .",
    "we found that a number of haloes greater than 1000 is sufficient for producing smooth mghs that are in exact agreement with the ones of our results .",
    "+ fig.6 consists of three snapshots .",
    "the first snapshot shows the results of the sc model .",
    "the other two snapshots correspond to the ec and to the nr model , respectively .",
    "every snapshot contains four lines . from top",
    "to bottom these lines correspond to the cases 1 , 2 , 3 and 4 , respectively .",
    "it is clear that -at present time- the slopes that correspond to smaller masses are smaller .",
    "this sequence of slopes is a sequence of formation times .",
    "large haloes continue to increase their masses with a significant rate , even at the present epoch , while the mass growth of small haloes is negligible .",
    "thus , small haloes have been formed earlier .",
    "however , a _ formation _ scale factor can be defined by the condition that the growth rate of mass falls below some value .",
    "bullock et al . ( 2001 , b01 ) used as a characteristic scale factor , the one satisfying the relation @xmath186 , where @xmath187 is a specific value , typically equal to 2 .",
    "we used the value @xmath188 and we denote the solution of the equation @xmath189 .",
    "additionally , we denote @xmath146 the solution of the eq . @xmath190 and we plot the results in fig.7 .",
    "this figure consists of two snapshots .         and @xmath9 .",
    "from top to bottom , the solid lines are the plots of @xmath191 versus @xmath192 for the sc , nr and ec models , respectively . the dotted , short - dashed and long - dashed lines are the linear fits of the above lines , respectively . from top to bottom in the right snapshot ,",
    "the solid lines are the plots of @xmath193 versus @xmath192 for the sc , nr and ec models , respectively .",
    "the dotted line is the linear fit of the sc model , while the dashed line is a prediction of @xmath194 given by the toy - model of w02 ( see text for more details),width=529 ]    left snapshot shows @xmath195 versus @xmath192 for the three models studied . from top to bottom ,",
    "solid lines show the predictions of sc , nr and ec models , respectively .",
    "these lines are well fitted by linear approximations that are shown by dotted , dashed and long - dashed lines , respectively .",
    "thus @xmath146 and @xmath9 are related by a power law @xmath196 .",
    "the values of @xmath197 are @xmath198 , @xmath199 and @xmath200 for sc , nr and ec models , respectively .",
    "the solid lines in the right snapshot show @xmath201 versus @xmath192 .",
    "the dotted line is the linear approximation of the results of sc model .",
    "it can be seen that this approximation is very satisfactory .",
    "linear approximations are not satisfactory for non - spherical models .",
    "the dashed line in this snapshot shows the predictions of the toy - model of bullock et al .",
    "( 2001 , b01 hereafter ) that calculates @xmath189 from the power spectrum using following procedure : let a halo with mass @xmath9 .",
    "the scale factor at the epoch of its collapse @xmath189 , is found by the solution of equation .",
    ": @xmath202=\\sigma(fm)\\ ] ] where , @xmath203 is the typical collapsing mass satisfying : @xmath204=1.686d(1)/d(a)$ ] , and @xmath205 is a constant .",
    "@xmath206 is the growth factor predicted by linear theory ( peebles , 1980 ) .",
    "the dashed line presented in the right snapshot of fig.7 is the prediction of the above procedure for @xmath207 and it is a good approximation of our results . + a less accurate but very practical approximation of @xmath189",
    "is given ( see also suto 2003 ) by @xmath208 where , @xmath9 is expressed in our system of units .",
    "a value of about @xmath209 for the exponent of the above relation is confirmed by our results too , since the best linear fits of the solid lines in the right snapshot of the fig.7 , are of the form @xmath210 with @xmath211 , @xmath212 and @xmath213 for the sc , nr and ec models , respectively .",
    "+ in a complementary paper of that of b01 , wechsler et al .",
    "( 2002 , w02 hereafter ) , based on the results of their n - body simulations , proposed for the growth of mass of dark matter haloes the exponential model : @xmath214\\ ] ] in fig.8 , we compare our mghs with the predictions of the model of w02 .",
    "this figure consists of twelve snapshots .",
    "every row has four snapshots that correspond to the four cases of masses ( 0.1 , 1 , 10 and 100 ) studied for every model .",
    "the predictions of sc model are presented in the first row .",
    "the second row shows the predictions of nr and the third one the predictions of ec model .",
    "the solid lines show our mghs while the dashed lines are the predictions of the model of w02 given by eq.16 .",
    "the values of @xmath189 used are those shown by the solid lines of fig.7 that are predicted by the numerical solution of the equation @xmath215 thus , no other information ( such as the cosmology , power spectrum etc ) is used but only the mghs of haloes .",
    "all snapshots refer to @xmath216 .",
    "+ the conclusion from fig.8 is clear .",
    "the predictions of eq.16 are very good approximations to the mghs predicted by merger - trees realizations .",
    "versus @xmath217 for all the models studied .",
    "the solid lines are the predictions of merger - trees realizations while the dashed ones are their fits by the model given in eq.16 ( see text for more details),width=529 ]    the quality of fit depends on the mass of the halo and not on the model used . for example , the left column of fig .",
    "8 shows a very good fit for all haloes with mass @xmath218 . a more careful look at this figure shows that the fit becomes less satisfactory for the earlier stages of the evolution of large haloes .",
    "in fact , the predictions of merger - trees are steeper curves than those of the model of w02 .",
    "this can be seen clearly at the 3thd and 4th column that show the predictions for haloes with masses @xmath219 and @xmath220 .",
    "we note that the mass growth rate can be connected - under some assumptions- with the density profile of the halo ( e.g. nusser & sheth 1999 , manrique et al .",
    "2002 , hiotelis 2003 ) .",
    "according to the stable - clustering model used by the above authors , haloes grow inside - out .",
    "this means that the accreted mass is deposited at an outer spherical shell without changing the inner density profile .",
    "we recall that the radial extent of a halo is defined by its virial radius @xmath221 , that is the radius that contains a mass with mean density @xmath222 times the mean density of the universe @xmath223 .",
    "@xmath222 is , in general , a function of the scale factor @xmath82 but in many applications it is set equal to a constant value of @xmath224 ( that is a value for @xmath222 for an einstein de sitter universe ) .",
    "the mass @xmath225 contained inside @xmath221 at scale factor @xmath82 satisfies the two following equations :    @xmath226    @xmath227    if the mass history of the halo is known , ( that is the evolution of its mass as a function of the scale factor ) , then the density profile can be calculated by differentiating eq .",
    "17 with respect to @xmath82 , which gives : @xmath228 where @xmath229 is calculated by differentiating eq.18 .",
    "finally eqs .",
    "19 and 18 give , in a parametric form , the density profile .",
    "it is clear that the density profile calculated from the above approximation depends crucially on the mass growth rate .",
    "hiotelis ( 2003 ) used a model based on the above assumptions for haloes that grow by accretion of matter .",
    "this means that the infalling matter is in a form of small haloes ( relative to the mass of the growing halo ) and the procedure can be approximated by a continuous infall . in that case",
    ", it was shown that large growth rate of mass ( observed in heavy haloes ) leads to inner density profiles that are steeper than those of less massive haloes ( where the growth rate of mass is smaller ) .",
    "+ we recall that the density profile of dark matter haloes is a very difficult problem contaminated by debates between the results of observations , the results of numerical simulations and the ones of analytical methods ( e.g. sand et .",
    "al 2004 and references therein ) .",
    "especially the inner density profile seems to follow a law of the form @xmath230 but the value of @xmath4 is not still known .",
    "observations estimate a value of @xmath4 about @xmath231 ( sand et .",
    "al 2004 ) , while the results of n - body simulations report different values as @xmath77 ( navarro et al .",
    "1997 ) , or between @xmath232 and @xmath233 ( moore et al .",
    "additional results from n - body simulations , as well as from analytical studies , connect the value of @xmath4 with the total mass of the halo ( ricotti 2002 , reed et al .",
    "2005 , hiotelis 2003 ) . in any case , it is difficult to explain the differences appearing in the results of different approximations .",
    "for example , regarding n - body simulations , some of the results are effects of force resolution . in a typical n - body code , such as treecode ( hernquist 1987 ) the force acting on a particle is given by the sum of two components : the short - range force that is due to the nearest neighbours and the long - range forces calculated by an expansion of the gravitational potential of the entire system .",
    "as it can be shown , the value of the average stochastic force in the simulation is an order of magnitude greater than that obtained by the theory of stochastic forces .",
    "consequently , small fluctuations induced by the small - scale substructure are not seen. this is the case of cold dark matter models in which the stochastic force generators are substructures at least three orders of magnitude smaller in size than the protoclusters in which they are embedded ( e.g. clusters of galaxies ) . on the other hand , regarding the differences between the results of various approximations , we notice that some of these differences could be due to the presence of the baryonic matter . especially in regions , as the central regions of haloes , the large density of baryonic matter may affect the distribution of dark matter .",
    "+ since in this paper we describe in detail technical problems related to the construction of reliable merger - trees , we have to note that the inside - out model for the formation of haloes described above , requires calculations for very small values of @xmath82 , because the central regions are formed earlier .",
    "therefore , in order to explore the center of the halo we have to go deep in the past of its history .",
    "consequently , the problems relative to the calculation of mean mass that analyzed at the beginning of this section , become more difficult .",
    "the density profiles predicted by the above described approximation are under study .",
    "analytical models based on the extended ps formalism provide a very useful tool for studying the merging histories of dark matter haloes .",
    "comparisons with the results of high resolution numerical simulations or observations show that the predictions of eps models are satisfactory ( e.g. lin et al .",
    "2003 , yahagi et al .",
    "2004 , cimatti et al .",
    "2002 , fontana et .",
    "al 2004 ) , although differences between various approximations always exist .",
    "these differences show the need for further improvement of various methods .",
    "+ in this paper we described in detail the numerical algorithm for the construction of merger - trees .",
    "the construction is based on the mass - weighted probability relation that is connected to the model barrier .",
    "the choice of the barrier is crucial for a good agreement between the results obtained by merger - trees and those of n - body simulations . as it is shown in yahagi et al .",
    "( 2004 ) mass functions resulting from the sc model are far from the results of n - body simulations while those predicted by non - spherical models are in good agreement .",
    "our results show that the distributions of formation times predicted by the non - spherical models are shifted to smaller values .",
    "thus , the resulting formation times are closer to the results of n - body simulations than the formation times predicted by the sc model .",
    "it should be noted that n - body simulations give , in general , smaller formation times than that of eps models ( e.g. lin et al .",
    "it should also be noted that observations indicate a build - up of massive early - type galaxies in the early universe even faster than that expected from simulations ( cimatti , 2004 ) .",
    "+ we have shown that a small sample of haloes ( @xmath234 ) is sufficient for the prediction of smooth mass growth histories .",
    "these curves have a functional form that is in agreement with those proposed by the n - body results of other authors .",
    "in particular the set of relations : @xmath235 and @xmath236\\ ] ] describes very satisfactorily the results of non - spherical models ( nr and ec ) .",
    "these relations give the mass @xmath9 of dark matter haloes at scale factor @xmath82 for the range of mass described in the text and for the particular cosmology used .",
    "@xmath18 is the present day mass of the halo in units of @xmath237 .",
    "+ finally , it should be noted that a large number of questions regarding the formation and evolution of galaxies remains open .",
    "for example , a first step should be the improvement of the model barrier so that the results of merger - trees fit better both the mass function ( yahagi et al .",
    "2004 ) and the collapse scale factor ( lin et al . 2003 ) .",
    "it should be noted also that structures appear to form earlier in n - body simulations and even earlier in real universe .",
    "additionally , predictions relative to the density profile are of interest .",
    "some of these issues are currently under study .",
    "we are grateful to the anonymous referee for helpful and constructive comments and suggestions .",
    "n. hiotelis acknowledges the _ empirikion foundation _ for its financial support and dr m. vlachogiannis for assistance in manuscript preparation .",
    "fontana , a. , pozzetti , l. , donnarumma , i. , renzini , a . ,",
    "cimatti , a. , zamorani , g. , menci , n . ,",
    "daddi , e. , giallongo , e. , mignoli , m . , perna , c. , salimbeni , s. , saracco , p . ,",
    "broadhurst , t . ,",
    "cristiani , s .",
    ", dodorico , s . ,",
    "gilmozzi , r . , 2004 , a&a , 424 , 23                                                suto , y. , 2003 , density profiles and clustering of dark halos and clusters of galaxies , in `` matter and energy in clusters of galaxies '' , asp conference series , vol.301 , 379 , 2003 , eds . : s. bowyer and c .- y.hwang"
  ],
  "abstract_text": [
    "<S> we have used merger trees realizations to study the formation of dark matter haloes . </S>",
    "<S> the construction of merger - trees is based on three different pictures about the formation of structures in the universe . </S>",
    "<S> these pictures include : the spherical collapse ( sc ) , the ellipsoidal collapse ( ec ) and the non - radial collapse ( nr ) . </S>",
    "<S> the reliability of merger - trees has been examined comparing their predictions related to the distribution of the number of progenitors , as well as the distribution of formation times , with the predictions of analytical relations . </S>",
    "<S> the comparison yields a very satisfactory agreement . </S>",
    "<S> subsequently , the mass growth histories ( mgh ) of haloes have been studied and their formation scale factors have been derived . </S>",
    "<S> this derivation has been based on two different definitions that are : ( a ) the scale factor when the halo reaches half its present day mass and ( b ) the scale factor when the mass growth rate falls below some specific value . </S>",
    "<S> formation scale factors follow approximately power laws of mass . </S>",
    "<S> it has also been shown that mghs are in good agreement with models proposed in the literature that are based on the results of n - body simulations . </S>",
    "<S> the agreement is found to be excellent for small haloes but , at the early epochs of the formation of large haloes , mghs seem to be steeper than those predicted by the models based on n - body simulations . </S>",
    "<S> this rapid growth of mass of heavy haloes is likely to be related to a steeper central density profile indicated by the results of some n - body simulations .    and    galaxies : halos  formation structure , methods : numerical  analytical , cosmology : dark matter 98.62.gq , 98.62.a , 95.35.+d </S>"
  ]
}