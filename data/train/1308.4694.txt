{
  "article_text": [
    "in this section , we survey classical appearances of quasi - polynomials ( though section [ subsec : pa ] might be new even to readers already familiar with ehrhart theory ) . in section [ sec2 ] , we survey some recent results where the appearance of quasi - polynomials is more surprising . in section [ sec3 ] ,",
    "we make several conjectures generalizing these `` unreasonable '' results .",
    "we state theorems relating these conjectures and state theorems proving certain cases .",
    "in particular , we conjecture that any family of sets @xmath14  defined with quantifiers ( @xmath9 , @xmath10 ) , boolean operations ( and , or , not ) , and statements of the form @xmath15 ( where @xmath16^d , b(t)\\in { \\mathbb{z}}[t]$ ] , and @xmath17 is the standard dot product )  exhibits eventual quasi - polynomial behavior , as well as rational generating function behavior . of course",
    ", reasonable people may disagree on what is unreasonable ; the title is a play on eugene wigner s `` the unreasonable effectiveness of mathematics in the natural sciences '' @xcite .",
    "all proofs are contained in section [ sec4 ] .",
    "we use bold letters such as @xmath18 to indicate multi - dimensional vectors .",
    "a function @xmath19 is a _ quasi - polynomial _ if there exists a period @xmath1 and polynomials @xmath20 $ ] such that @xmath21    [ ex : floor ] @xmath22 is a quasi - polynomial with period 2 .",
    "this example makes it clear that the ubiquitousness of quasi - polynomials should nt be too surprising : anywhere there are floor functions , quasi - polynomials are likely to appear .",
    "floor functions can also create multivariate quasi - polynomials :    [ ex : mfloor ] let @xmath23 .",
    "the behavior of @xmath0 depends on the parity of @xmath24 .",
    "let @xmath25 be the lattice @xmath26 , the set of @xmath27 for which @xmath24 is odd .",
    "then the lattice coset @xmath28 is the set for which @xmath24 is even , and @xmath29    this motivates the definition of a multivariate quasi - polynomial ; `` residues modulo a period '' are replaced by `` cosets of a lattice '' :    @xmath30 is a ( multivariate ) _ quasi - polynomial _ if there exists an @xmath31-dimensional lattice @xmath32 , a set @xmath33 of coset representatives of @xmath34 , and polynomials @xmath35 $ ] such that @xmath36    we will generally be concerned with _",
    "integer - valued _ quasi - polynomials , those quasi - polynomials whose range lies in @xmath37 .",
    "note that examples [ ex : floor ] and [ ex : mfloor ] demonstrate that such quasi - polynomials may still require rational coefficients .",
    "perhaps the most well - studied quasi - polynomials are the _ ehrhart quasi - polynomials _ :    [ thm : ehr ] suppose @xmath38 is a polytope ( bounded polyhedron ) whose vertices have rational coordinates .",
    "let @xmath39 be the number of integer points in @xmath40 , the dilation of @xmath38 by a factor of @xmath5 .",
    "then @xmath39 is a quasi - polynomial , with period the smallest @xmath1 such that @xmath41 has integer coordinates .",
    "[ ex : square ] let @xmath38 be the triangle with vertices @xmath42 , @xmath43 , and @xmath44 .",
    "then @xmath45 is a quasi - polynomial with period 2 .",
    "writing @xmath40 from this example as @xmath46 suggests a way to generalize this result : for @xmath47 , let @xmath48 be the set of integer points , @xmath49 , in a polyhedron defined with linear inequalities of the form @xmath50 , where @xmath51 and @xmath52 $ ] is linear .",
    "[ ex : sven ] let @xmath53    for a fixed @xmath54 , @xmath55 is the set of integer points in a polyhedron in @xmath56 .",
    "as @xmath54 varies , the `` constant '' term of these inequalities change , but the coefficients of @xmath57 and @xmath58 do not ; in other words , the normal vectors to the facets of the polyhedron do not change , but the facets move `` in and out '' .",
    "in fact , they can move in and out so much that the combinatorial structure of the polyhedron changes .",
    "figure [ fig : sven ] shows the combinatorial structure for different @xmath59 . using various methods , @xcite and @xcite compute that    [ cols=\"^,^,^ \" , ]     @xmath60    in this example , the function @xmath61 is a quasi - polynomial , at least on pieces of parameter - space for which the combinatorial type is constant .",
    "a function @xmath62 is a _ piecewise quasi - polynomial _ if there exists a finite partition @xmath63 of @xmath64 with @xmath65 polyhedra ( which may not all be full - dimensional ) and there exist quasi - polynomials @xmath66 such that @xmath67    @xcite effectively proved the following generalization of ehrhart theory :    [ thm : par_polyhedra ] let @xmath48 be the set of integer points , @xmath49 , in a polyhedron defined with linear inequalities of the form @xmath50 , where @xmath51 and @xmath68 $ ] is linear . then @xmath69 is a piecewise quasi - polynomial .",
    "sections [ sec2 ] and further will predominantly be concerned with _ univariate _",
    "being a univariate piecewise quasi - polynomial @xmath19 is equivalent to _ eventually _ being a quasi - polynomial ; that is , there exists a @xmath70 such that for all @xmath71 , @xmath39 agrees with a quasi - polynomial .",
    "many classical proofs of ehrhart s theorem ( theorem [ thm : ehr ] ) use generating functions . to prove that a function @xmath39 is a quasi - polynomial of period @xmath1",
    ", it suffices ( see section 4.4 of @xcite ) to prove that the hilbert series @xmath72 can be written as a rational function of the form @xmath73 where @xmath74 is a polynomial of degree less than @xmath75 . for @xmath76 with @xmath38",
    "the triangle in example [ ex : square ] , we can see that @xmath77 indeed , these proofs of ehrhart s theorem start by considering the generating function @xmath78 ( where @xmath79 ) and substituting in @xmath80 to get the hilbert series .",
    "for @xmath38 in example [ ex : square ] , @xmath81 as can be checked by expanding as a product of infinite geometric series .",
    "substituting @xmath82 yields the hilbert series in ( [ eq : hs ] ) .",
    "we call any generating function or hilbert series a _ rational generating function _ if it can be written in the form @xmath83 where @xmath84 is a laurent polynomial over @xmath85 and @xmath86 are lexicographically positive ( first nonzero entry is positive ) .",
    "while we will generally be assuming that the generating functions are for subsets of @xmath87 , we need @xmath88 to be lexicographically positive rather than simply in @xmath89 for examples like the following :    [ ex : negs ] let @xmath90 .",
    "while @xmath91 is a legitimate rational generating function , it makes more sense to write it as @xmath92    [ rmk : lexpos2 ] having @xmath93 lexicographically positive guarantees that @xmath94 is the laurent series convergent on a neighborhood of @xmath95 , for sufficiently small @xmath96 , as follows : let @xmath97 be the first nonzero coordinate of @xmath93 .",
    "then @xmath98 for sufficiently small @xmath96 , the @xmath99 term dominates , and @xmath100 .",
    "this implies that @xmath101 , and indeed @xmath102 does converge on a neighborhood of @xmath103 .",
    "[ rmk : lexpos ] if @xmath93 is lexicographically negative , then we may instead write @xmath104 with @xmath105 lexicographically positive .",
    "several classic results start with a simple generating function , and use it to find quasi - polynomial behavior .",
    "[ def : vpf ] given @xmath106 , the _ vector partition function _",
    "@xmath107 is defined by @xmath108 that is , the number of ways to partition the vector @xmath109 into parts taken from @xmath110 .    the generating function @xmath111 can be written as @xmath112 obtained by rewriting the rational function as a product of infinite geometric series",
    ". the following is proved by @xcite :    [ thm : vpf ] any vector partition function is a piecewise quasi - polynomial .",
    "see @xcite for a self - contained explanation utilizing the partial fraction expansion of the rational function .",
    "for example , if @xmath113 and @xmath114 , then the vector partition function is encoded by the generating function @xmath115 we saw previously that this generating function corresponds to the quasi - polynomial in example [ ex : square ] . in section [ sec3 ] , we will use a different generating function : for _ fixed _",
    "@xmath5 , examine the generating function @xmath116 .    in the triangle from example [ ex : square ] , this gives us @xmath117 we can write this more compactly as @xmath118 which we can verify directly by expanding the fractions as products of geometric series .",
    "given this generating function , we can count the number of integer points in @xmath40 by substituting in @xmath80 . substituting @xmath82 into ( [ eq : gf ] ) ,",
    "we see that @xmath119 is a pole of these fractions . fortunately , getting a common denominator and applying lhpital s rule to find the limit as @xmath120 and @xmath121 approach 1 will work , and it is evident that the differentiation involved in lhpital s rule will yield a quasi - polynomial in @xmath5 as the result ; careful calculation will show that it matches ( [ eq : eh ] ) .",
    "in general , proposition 2.11 of @xcite or theorem 4.4 of @xcite both give an algorithmic version of the following theorem :    [ thm : vw ] for @xmath122 , let @xmath48 be the set of integer points , @xmath49 , in a polyhedron defined with linear inequalities of the form @xmath50 , where @xmath51 and @xmath68 $ ] is linear . then there is a finite decomposition of @xmath123 into pieces of the form @xmath124 ( with @xmath38 a polyhedron ) such that , considering the @xmath109 in each piece separately , @xmath125 where @xmath126 , the coordinates of @xmath127 are linear quasi - polynomials in @xmath109 , and @xmath128 .",
    "substituting @xmath129 , using lhpital s rule as necessary , recovers theorem [ thm : par_polyhedra ] .    a key step in proving theorem [ thm : vw ] is brion s theorem @xcite ( see chapter 9 of @xcite for a proof and discussion ) , which reduces computing generating functions for polyhedra to computing generating functions for cones :    [ thm : brion ] let @xmath38 be a polyhedron in the nonnegative orthant @xmath130 . for each vertex @xmath131 of @xmath38 , define its _ vertex cone _",
    "@xmath132 to be the set of points in @xmath133 satisfied by those inequalities defining @xmath38 that are _ equalities _ at @xmath131 .",
    "then @xmath134    note that , for different vertices @xmath131 , the @xmath135 may converge on different neighborhoods .",
    "if they are written as rational functions , remarks [ rmk : lexpos2 ] and [ rmk : lexpos ] fix this problem .    for @xmath90 from example [",
    "ex : negs ] , the two vertex cones are @xmath136 and so @xmath137 as seen in example [ ex : negs ] .",
    "the triangle from example [ ex : square ] has three vertex cones .",
    "brion s theorem applied to @xmath138 is illustrated in ( [ eq : gf ] ) , with remark [ rmk : lexpos ] already applied .",
    "[ rmk : lines ] note that brion s theorem is often stated for polyhedra in @xmath133 ( unrestricted to the nonnegative orthant ) .",
    "if the polyhedron contains straight lines , one must be more careful when talking about generating functions .",
    "for example , the set @xmath37 has generating function @xmath139 see , for example , @xcite for more details . in this paper , we will constrain the sets that we are interested in to be nonnegative , to avoid issues like this .      so far , our examples have been integer points in polyhedra . a key property of such sets",
    "is that they can be defined without quantifiers .",
    "however , even for sets defined with quantifiers , we end up with reasonable appearances of quasi - polynomials .",
    "a _ presburger formula _ is a boolean formula with variables in @xmath140 that can be written using quantifiers ( @xmath141 ) , boolean operations ( and , or , not ) , and linear ( in)equalities in the variables .",
    "we write a presburger formula as @xmath142 to indicate the free variables @xmath143 ( those not associated with a quantifier ) .",
    "@xcite ( see @xcite for a translation ) examined this first order theory and proved it is decidable .",
    "[ ex : pa ] given @xmath144 , let @xmath145 we can compute that @xmath146    this set has several properties , _ cf . _ section [ sec3 ] :    1 .",
    "the set of @xmath5 such that @xmath14 is nonempty is @xmath147 .",
    "this set is eventually periodic .",
    "the cardinality of @xmath14 is @xmath148 which is eventually a quasi - polynomial of period 4 .",
    "3 .   when @xmath14 is nonempty",
    ", we can obtain an element of @xmath14 with the function @xmath149 , and @xmath150 is eventually a quasi - polynomial .",
    "4 .   more strongly , when @xmath14 is nonempty ,",
    "we can obtain the maximum element of @xmath14 with the function @xmath151 , and @xmath150 is eventually a quasi - polynomial .",
    "we can compute the generating function @xmath152 we see that , for fixed @xmath5 , this generating function is a rational function . considering each residue class of @xmath153 separately",
    ", the exponents in the rational function can eventually be written as polynomials in @xmath5 .",
    "versions of these properties always hold for sets defined in presburger arithmetic .",
    "for example , @xcite gave several properties of presburger formulas that hold even for sets defined with multivariate parameters , @xmath47 :    [ thm : pa ] suppose @xmath154 is a presburger formula , with @xmath155 and @xmath109 collections of free variables .",
    "then    * @xmath156 is a piecewise quasi - polynomial , * @xmath157 is a rational generating function , and * @xmath158 is a rational generating function .",
    "property 4 from example [ ex : pa ] can be proved in general by using theorem [ thm : pa ] to write @xmath157 as a rational generating function and applying theorem [ thm : diff_gfs ] .",
    "the proof of theorem [ thm : implications ] then shows that all of the other properties follow .",
    "we now turn to the inspiration for this paper .",
    "three recent results exhibit quasi - polynomial behavior , in situations that seem `` unreasonable '' .",
    "in particular , all three involve sets @xmath14 defined by inequalities of the form @xmath15 , where @xmath159 is a polynomial in @xmath5 ; that is , the normal vectors to the facets change as @xmath5 changes .",
    "first we give an example showing that , unlike in section [ sec1 ] , it is now important that we restrict to only one parameter , @xmath5 .",
    "define @xmath160 .",
    "then @xmath55 is an interval in @xmath161 with endpoints @xmath162 and @xmath163 , and @xmath164    there is no hope for simple quasi - polynomial behavior here , as the cardinality depends on the arithmetic relationship of @xmath165 and @xmath5 .",
    "this first result most directly generalizes ehrhart theory .",
    "@xcite prove that , if @xmath14 is the set of integer points in a polytope defined by inequalities of the form @xmath15 , then @xmath166 is eventually a quasi - polynomial .",
    "[ thm : cls ] let @xmath167 be an @xmath168 matrix and @xmath169 be a column vector of length @xmath170 , all of whose entries are in @xmath171 $ ] .",
    "assume @xmath172 is eventually a bounded set ( a polytope ) .",
    "then @xmath173 is eventually a quasi - polynomial .",
    "[ ex : twist ] let @xmath174 be the `` twisting square '' in figure [ fig : twist ] , defined by @xmath175 then @xmath176 is given by the quasi - polynomial @xmath177    .4 .,title=\"fig : \" ]    .4 .,title=\"fig : \" ]    note that theorem [ thm : cls ] can be equivalently phrased ( theorem 1.1 of @xcite ) using equalities @xmath178 , where @xmath179 is constrained to be nonnegative , or it can be phrased ( theorem 1.4 of @xcite ) by listing the vertices of @xmath174 as rational functions of @xmath5 .",
    "@xcite were similarly concerned with the integer points in polyhedra defined by @xmath180 . rather than counting @xmath173",
    ", they wanted to find the vertices of the integer hull of @xmath174 , that is , the set of vertices of the convex hull of @xmath181 .",
    "[ thm : cw ] let @xmath182 be vectors in @xmath183 whose coordinates are rational functions of size o@xmath184 , and let @xmath174 be the convex hull of the @xmath182 .",
    "then there exists a modulus @xmath1 and functions @xmath185 with polynomial coordinates such that , for @xmath186 and for sufficiently large @xmath187 , the set of vertices of the integer hull of @xmath174 is @xmath188 .",
    "consider the twisting square , @xmath174 , from example [ ex : twist ] .",
    "when @xmath5 is even , the vertices of @xmath174 are integers , so the vertices of the integer hull are simply the vertices of @xmath174 : @xmath189 when @xmath5 is odd , the integer hull of @xmath174 is an octagon ( pictured in figure [ fig : twist2 ] for @xmath190 ) with vertices @xmath191    theorem [ thm : cw ] could be similarly phrased using facet definitions of the polyhedra , rather than vertex definitions . that the vertices are o@xmath184 ( grow no faster that @xmath192 for some constant @xmath193 ) is important for the proof , though calegari and walker conjecture that the theorem still holds without this restriction .    a third recent result concerns the frobenius number .    given @xmath194 , let @xmath195 be the semigroup generated by the @xmath7 , that is , @xmath196 if the @xmath7 are relatively prime , then @xmath195 contains all sufficiently large integers , and the _ frobenius number _ is defined to be the largest integer not in @xmath195 .",
    "now we let @xmath197 vary with @xmath5 .",
    "@xcite prove that , if the @xmath12 are linear functions of @xmath5 , then the frobenius number is eventually a quasi - polynomial , and they conjecture that this is true if the @xmath12 are any polynomial functions of @xmath5 :    [ thm : parfrob ] let @xmath198 $ ] be linear and eventually positive .",
    "then the set of @xmath5 such that the @xmath12 are relatively prime is eventually periodic , and , for such @xmath5 , the frobenius number is eventually given by a quasi - polynomial .",
    "consider @xmath199 , @xmath200 .",
    "these are relatively prime exactly when @xmath201 .",
    "since there are only two generators , a well - known formula ( seemingly due to @xcite ) gives that the frobenius number is @xmath202    note that theorem [ thm : parfrob ] utilizes sets defined with quantifiers ; presburger arithmetic seems a good place to look for generalizations encompassing these three results .",
    "each of these three results has their own method for proving quasi - polynomial behavior , but there are several common tools needed .",
    "@xcite and @xcite independently prove theorems [ thm : da ] through [ thm : dom ] , @xcite prove theorem [ thm : stable ] , and @xcite prove theorem [ thm : round ] .",
    "[ thm : da]given @xmath203 integer - valued polynomials ,    1 .   if @xmath204 , there exist integer - valued quasi - polynomials @xmath205 and @xmath206 such that @xmath207 , with @xmath208 , and 2 .   if @xmath209 , there exist integer - valued quasi - polynomials @xmath210 and @xmath211 such that @xmath212 , with eventually @xmath213",
    ".    these are both useful results , and only slightly different .",
    "for example , suppose @xmath214 and @xmath215 .",
    "then statement 1 is a traditional polynomial division algorithm : @xmath216 .",
    "statement 2 , however , is a numerical division algorithm : @xmath217 , and the remainder @xmath218 is between 0 and @xmath0 as long as @xmath219 . in other words , if we have found @xmath220 and @xmath221 , but we eventually have @xmath222 , then we should use quotient @xmath223 and remainder @xmath224 instead , as eventually @xmath225 .",
    "the main subtlety in proving statement 1 of this theorem is the following : suppose @xmath226 and @xmath227 .",
    "then the leading coefficient of @xmath0 does not divide the leading coefficient of @xmath228 , and the traditional polynomial division algorithm would produce quotients that are not integer - valued . instead , we look at @xmath5 modulo the leading coefficient of @xmath0 ; for example , if @xmath5 is odd , so @xmath229 for some @xmath230 , substituting gives @xmath231 and @xmath232 , and now the leading term does divide evenly .    the division algorithm in hand",
    ", one can prove some stronger results :    let @xmath228 and @xmath0 be integer - valued quasi - polynomials .",
    "then there exists integer - valued quasi - polynomials @xmath233 , @xmath234 , and @xmath235 such that @xmath236 and @xmath237 .",
    "this is obtained by repeated applications of the division algorithm .",
    "@xmath238    similarly , repeated application of the euclidean algorithm can produce the hermite or smith normal forms of matrices .",
    "we wo nt define those here , but they are important , for example , in producing a basis for lower - dimensional sublattices of @xmath239 ( see @xcite ) .    given a matrix @xmath167 with integer - valued quasi - polynomial entries , the hermite and the smith normal forms , as well as their associated change - of - basis matrices , also have quasi - polynomial entries .",
    "the following theorem is obvious , but is repeatedly used .",
    "[ thm : dom ] suppose @xmath240 $ ] with @xmath241 . then either eventually @xmath242 or eventually @xmath243 .",
    "repeated use of this property , for example , shows that the combinatorial structure of a polyhedron @xmath174 eventually stabilizes , when @xmath174 is defined by @xmath180 :    [ thm : stable ]",
    "let @xmath167 be an @xmath168 matrix and @xmath13 be a column vector of length @xmath170 , all of whose entries are in @xmath171 $ ] , and let @xmath172 . for sufficiently large @xmath5 ,",
    "the set of vertices of @xmath174 are given by rational functions @xmath182 , and the combinatorial type of @xmath174 ( the subsets of vertices lying on common faces ) is constant .",
    "note that the vertices in this result are _ rational functions _ of @xmath5 : a vertex will be a point where several of the inequalities are equalities , i.e. , the solution to some @xmath244 , where @xmath245 is a full - rank @xmath246 matrix of polynomials in @xmath5 . solving for @xmath179 using the adjunct matrix of @xmath247 will result in @xmath248 given as a rational function of @xmath5 .    for large @xmath5 ,",
    "the behavior of a rational function is predictable :    [ thm : round ] let @xmath249 $ ]",
    ". then @xmath250 converges to a polynomial , and @xmath251 is eventually a quasi - polynomial .",
    "let @xmath14 , for @xmath144 , be a family of subsets of @xmath87 .",
    "we now discuss some properties that it would be nice ( though unreasonable ! ) for such sets to have , _ cf .",
    "_ example [ ex : pa ] .",
    "property : : :    the set of @xmath5 such that @xmath14 is nonempty is    eventually periodic .",
    "this is the weakest of the properties we will discuss , but an important one , as it is related to the decision problem  `` is there a solution ? ''",
    "property : : :    there exists a function    @xmath252 such that , if    @xmath14 has finite cardinality , then    @xmath253 , and @xmath39 is    eventually a quasi - polynomial .",
    "the set of @xmath5 such that    @xmath14 has finite cardinality is eventually periodic .",
    "this is the property found in theorem [ thm : cls ] , where @xmath14 is the set of integer points in a polytope defined by inequalities of the form @xmath15 .",
    "theorems [ thm : cw ] and [ thm : parfrob ] , on the other hand , are not about counting points but about finding points :    property : : :    there exists a function    @xmath254 such that ,    if @xmath14 is nonempty , then    @xmath255 , and the coordinate functions of    @xmath179 are eventually quasi - polynomials . the set    of @xmath5 such that @xmath14 is nonempty is    eventually periodic .    this function",
    "@xmath248 acts as a certificate that the set is nonempty .",
    "but we may want to go further and pick out particular elements of @xmath14 :    property : : :    given @xmath256 , there    exists a function    @xmath254 such that ,    if @xmath257    exists , then it is attained at @xmath255 ,    and the coordinate functions of @xmath179 are    eventually quasi - polynomials .",
    "the set of @xmath5 such that the    maximum exists is eventually periodic .",
    "this corresponds to theorem [ thm : parfrob ] , where we want to find the frobenius number , the maximum element of the complement of the semigroup . on the other hand ,",
    "we may want to list _ multiple _ elements of the set :    property : : :    fix @xmath258 .",
    "there exist functions    @xmath259    such that , if @xmath260 , then    @xmath261 are distinct    elements of @xmath14 , and the coordinate functions of    @xmath262 are eventually quasi - polynomials .",
    "the set    of @xmath5 such that @xmath260 is    eventually periodic .",
    "if there is a uniform bound on @xmath166 , then this property can be used to enumerate all elements of @xmath14 , for all @xmath5 .",
    "this is the content of theorem [ thm : cw ] .",
    "property 2 is about counting all solutions and properties 3/3a/3b are about obtaining specific solutions , and so they seem somewhat orthogonal to each other .",
    "the following property , we shall see , unifies them :    property : : :    there exists a period @xmath1 such that , for    @xmath4 ,    @xmath263    where @xmath264 , and the coordinate    functions of    @xmath265    are polynomials with the @xmath266    lexicographically positive .    for what sets @xmath14 can we hope for these properties to hold ? here is a candidate :    a family of sets @xmath14 is a _",
    "parametric presburger family _ if they can be defined over the natural numbers using quantifiers , boolean operations , and inequalities of the form @xmath15 , where @xmath267 $ ] and @xmath268^d$ ] .",
    "we conjecture that these properties do , in fact , hold for any parametric presburger family :    let @xmath14 be a parametric presburger family .",
    "then properties 1 , 2 , 3 , 3a , 3b , and 4 all hold .",
    "note that one can define a family @xmath14 of subsets of @xmath239 rather than of @xmath87 , but care must be taken with generating functions ; see remark [ rmk : lines ] .    as evidence that property 4 is interesting , we will show that it generalizes both 2 and 3/3a/3b :    [ thm : implications ] let @xmath14 be any family of subsets of @xmath87 .",
    "we have the following implications among possible properties of @xmath14 . @xmath269   & & & \\\\ \\text{4 } \\ar@{=>}@/_/[drr ] \\ar@{=>}[rr ] \\ar@{=>}@/^/[urrr ] & & \\text{3a } \\ar@{=>}[rr ] &   & \\text{3 } \\ar@{=>}[rr ]   & & \\text{1}\\\\ & & \\text{3b } \\ar@{=>}@/_/[urr ] &   & & } \\ ] ]    as a final relationship between these properties , we note that , for the class of parametric presburger families , 3 , 3a , and 3b are equivalent :    [ thm : equiv ] suppose all parametric presburger families have property 3",
    ". then all parametric presburger families have properties 3a and 3b .",
    "theorem [ thm : equiv ] is a weaker implication than theorem [ thm : implications ] , which holds for a single family @xmath14 in isolation . to prove that 3 `` implies '' 3a and 3b , on the other hand , we will need to create new families",
    "@xmath270 using additional quantifiers or boolean operators , and we need to know that these new families still have property 3 .    finally , we give evidence that these properties might actually hold",
    ". we can show that they all hold for two broad classes of parametric presburger families :    [ thm : cases ] suppose @xmath14 is a parametric presburger family such that either    1 .",
    "@xmath14 is defined without using any quantifiers , _ or _ 2 .",
    "the only inequalities used to define @xmath14 are of the form @xmath271 , where @xmath13 is a polynomial ( that is , the normal vectors to the hyperplanes must be fixed ) .",
    "then properties 1 , 2 , 3 , 3a , 3b , and 4 all hold .",
    "we isolate a piece of the proof of part ( b ) , in order to point out that property 4 is a weaker property than we might hope for , but seems to be as strong a property as we can get .",
    "indeed , we might hope that @xmath272 is a rational generating function .",
    "theorem [ thm : pa ] shows that this is true for sets defined in the normal presburger arithmetic , and the following theorem shows that this implies property 4 .",
    "[ thm : diff_gfs ] suppose @xmath273 , for @xmath274 , is a family of subsets of @xmath87 .",
    "if @xmath275 is a rational generating function , then there is a finite decomposition of @xmath64 into pieces of the form @xmath124 ( with @xmath38 a polyhedron ) such that , considering the @xmath276 in each piece separately , @xmath277 where @xmath126 , @xmath278 are lexicographically positive , and the coordinate functions of @xmath279 are linear quasi - polynomials in @xmath276 .    in general",
    ", however , @xmath272 will not be a rational generating function :    let @xmath14 be the set @xmath280 . then @xmath281 is a rational generating function with exponents depending on @xmath5 , so property 4 is satisfied .",
    "nevertheless , @xmath282 can not be written as a rational function . to prove that it can not be so written , note that the set @xmath283 can not be written as a finite union of sets of the form @xmath284 , where @xmath38 is a polyhedron , @xmath285 and @xmath286 is a lattice ; theorem 1 of @xcite then implies that @xmath287 is not a rational generating function .",
    "because of dependencies among these proofs , we present them out of numerical order .",
    "we first prove theorem [ thm : diff_gfs ] .",
    "then we prove that property 4 holds for the sets given in theorem [ thm : cases ] .",
    "next we prove theorem [ thm : implications ] .",
    "the rest of the properties in theorem [ thm : cases ] are an immediate corollary . finally , we prove theorem [ thm : equiv ] .",
    "we want to compute the coefficient of @xmath288 as a rational generating function in @xmath179 .",
    "we can reduce to computing the coefficient of @xmath288 for a single term of the form @xmath289 where @xmath290 , @xmath291 , and @xmath292 are nonzero : indeed , by the assumption that @xmath275 is a rational generating function , it can be written as a linear combination of such terms as ( [ eqn : gf_allp ] ) , so we could examine each such term separately and then apply the linear combination .",
    "let @xmath274 be fixed .",
    "expanding ( [ eqn : gf_allp ] ) as a product of geometric series , we see that we get a term @xmath293 exactly when there exist @xmath294 such that @xmath295 define the parametric polyhedron @xmath296 then ( [ eqn:1term ] ) tells us that , for every @xmath297 , we will get a monomial @xmath298 in the expansion of ( [ eqn : gf_allp ] ) , and therefore @xmath299 theorem [ thm : vw ] implies that there is a finite decomposition of @xmath123 into pieces of the form @xmath124 ( with @xmath38 a polyhedron ) such that , considering the @xmath276 in each piece separately , @xmath300 where @xmath126 , the coordinates of @xmath127 are linear quasi - polynomials in @xmath276 , and @xmath278 are lexicographically positive . substituting @xmath301 and multiplying by @xmath302 yields",
    "@xmath303 this is the desired generating function , @xmath304 , in the form required by the theorem .      *",
    "part ( a ) : * we want to apply a key idea of ( * ? ? ?",
    "* lemma 3.2 ) , but first we need to simplify by reducing our problem ( that of showing property 4 holds for any quantifier - free presburger formula ) to simpler ones .",
    "let the set of inequalities used in the quantifier - free presburger formula be given by @xmath305 , @xmath306 .",
    "our domain @xmath87 is partitioned into ( at most ) @xmath307 pieces , as follows : to create a piece , for each @xmath308 , choose either @xmath309 , @xmath310 , or @xmath311 , and let a piece of the partition be the set of @xmath179 satisfying the conjunction of these ( in)equalities . within each piece ,",
    "either all points will satisfy the presburger formula or all will fail to satisfy the presburger formula .",
    "it suffices to prove property 4 for one of these pieces that satisfy the presburger formula , because the final generating function is simply a sum of the generating functions of these pieces .",
    "these pieces are polyhedra ( since we are looking at integer points , we may replace the open @xmath309 with the closed @xmath312 ) , so it suffices to prove property 4 for polyhedra , @xmath174 , defined with equations of the form @xmath15 .",
    "we still ca nt apply @xcite , because that will only apply to bounded polyhedra . for sufficiently large @xmath5 , theorem [ thm : stable ]",
    "shows that the combinatorics of the vertex cones of @xmath174 stabilize . since theorem [ thm : brion ] ( brion s theorem )",
    "gives that the generating function for @xmath174 is the sum of the generating functions for these vertex cones , it suffices to prove property 4 for such cones @xmath313 where the coordinates of @xmath131 are rational functions and the coordinates of @xmath127 are polynomials .",
    "now take @xmath314 to be the fundamental parallelepiped of @xmath315 , that is , @xmath316 and note that @xmath317 it therefore suffices to prove property 4 for @xmath314 , which is a _ bounded _ polyhedron , so @xcite finally applies , as follows . given @xmath318 ,",
    "define the map @xmath319 , taking @xmath320 to @xmath321 , given by @xmath322 then lemma 3.2 of @xcite states that , for some @xmath318 and some @xmath323 , @xmath324 is a bijection , and furthermore that @xmath325 can be defined as the disjoint union of the integer points in polyhedra which satisfy particular linear inequalities of the form @xmath326 where @xmath327 , @xmath13 is _ linear _ , and @xmath328 no longer depends on @xmath5",
    ". then theorem [ thm : vw ] shows that ( for sufficiently large @xmath5 so that the combinatorial structure of this set stabilizes ) @xmath329 where @xmath330 , the coordinates of @xmath127 are linear quasi - polynomials in @xmath5 , and @xmath331 are nonzero .",
    "substituting @xmath332 into a monomial @xmath333 gives @xmath334 therefore substituting @xmath332 into ( [ eqn : cls ] ) shows that @xmath335 has property 4 , as desired .",
    "* part ( b ) : * let the set of inequalities used in the presburger formula be given by @xmath336 , @xmath306 .",
    "for the moment , replace each @xmath337 with a single variable @xmath338 , so that we have a presburger formula @xmath339 , defined using inequalities @xmath340 .",
    "let @xmath341 so that @xmath342 .",
    "theorem [ thm : pa ] implies that @xmath343 is a rational generating function .",
    "theorem [ thm : diff_gfs ] then implies that there is a finite decomposition of @xmath64 into pieces of the form @xmath124 ( with @xmath38 a polyhedron ) , such that , considering the @xmath276 in each piece separately , @xmath344 where @xmath126 , @xmath345 are lexicographically positive , and the coordinate functions of @xmath346 are linear quasi - polynomials in @xmath276 . for sufficiently large @xmath5 , the vector @xmath347 eventually stays in one of these pieces of the decomposition .",
    "therefore , we may substitute @xmath348 into the appropriate generating function .",
    "this proves property for @xmath14 .      *",
    "@xmath349 * : suppose @xmath253 is eventually a quasi - polynomial .",
    "let @xmath1 be a period and @xmath350 be polynomials such that , eventually , @xmath3 for @xmath187 .",
    "let @xmath351 be the indices @xmath308 such that @xmath338 is not identically 0 . for @xmath352",
    ", we have @xmath353 for sufficiently large @xmath5 , so , eventually , @xmath14 is nonempty if and only if @xmath354 is in @xmath351 .      * @xmath349 * : take @xmath355",
    ". then @xmath8 is nonempty if and only if @xmath356 has a maximum on @xmath14 . by property 3a ,",
    "the set of such @xmath5 is eventually periodic , and when nonempty , 3a gives an element @xmath255 .",
    "* @xmath349 * : let @xmath358 .",
    "let us examine a particular residue class , so that , for sufficiently large @xmath4 , we have @xmath359 where @xmath360 , and the coordinate functions of @xmath361 are polynomials .",
    "when @xmath228 is defined at @xmath362 , @xmath363 , and when @xmath228 has a pole at @xmath362 , @xmath14 has infinite cardinality .",
    "so we attempt to compute @xmath364 , letting @xmath365 one variable at a time , repeatedly using lhpital s rule .",
    "we will repeatedly take partial derivatives of the numerator ( and denominator ) and set some of the @xmath366 to 1 . at each point",
    ", we will see that the numerator ( and denominator ) will look like @xmath367 where @xmath368 and the coordinate functions of @xmath369 are polynomials , and @xmath370 is a subset of the variables of @xmath179 .",
    "our base case , @xmath228 , certainly has numerator and denominator of this form .",
    "note that , at each step , we may simplify ( [ eqn : plugging_in ] ) so that the @xmath369 are distinct polynomials and the @xmath368 are not identically zero .",
    "then for sufficiently large @xmath5 , @xmath371 are distinct monomials and @xmath372 are nonzero .",
    "therefore @xmath373 is either a nonzero polynomial in @xmath370 for all sufficiently large @xmath5 or identically zero for all sufficiently large @xmath5 .",
    "starting with @xmath120 , we substitute @xmath374 into the numerator and denominator of @xmath228 .",
    "if both are eventually nonzero , we continue to @xmath121 .",
    "if the numerator is eventually nonzero but the denominator is eventually zero , then @xmath362 is eventually a pole of @xmath375 , meaning that for sufficiently large @xmath4 , @xmath166 is infinite .",
    "if the numerator is eventually zero but the denominator is eventually nonzero , then @xmath376 . if both the numerator and denominator are eventually 0 , then we apply lhpital s rule , taking the derivatives of the numerator and denominator with respect to @xmath120 .",
    "our new numerator and denominator will continue having the form ( [ eqn : plugging_in ] ) .",
    "we continue with @xmath120 in this way , and then continue with @xmath121 , etc . ,",
    "until we have either established that @xmath166 is infinite for all @xmath4 , zero for all @xmath4 , or we have eliminated all of the variables among @xmath179 . in this last case ,",
    "the numerator and the denominator of the result are still in the form ( [ eqn : plugging_in ] ) , so we must have @xmath377 , where @xmath378 $ ] . to conclude , we need to show that @xmath379 must actually be a polynomial .",
    "indeed , this follows from the fact that @xmath379 must always be an integer , @xmath166 : apply the standard polynomial division algorithm in @xmath380 $ ] so that @xmath381 with @xmath382 .",
    "let @xmath31 be a common multiple of the denominators of the coefficients of @xmath234 , so that @xmath383 is always an integer . since @xmath384 is always an integer , @xmath385 must also always be an integer . since @xmath382 ,",
    "eventually @xmath386 , so the only possibility is that @xmath387 .",
    "then @xmath388 is a polynomial ( for @xmath4 ) , and we have proven property .      without loss of generality ,",
    "assume @xmath389 ( otherwise , reorder the variables ) .",
    "define the map @xmath390 by @xmath391 since @xmath389 , this map is injective , and therefore the map is bijective from @xmath14 onto its image @xmath392 .",
    "assume that @xmath393 has a maximum on @xmath14 .",
    "then @xmath392 has a unique lexicographically minimal element ; this is the element we will give a function for . given @xmath394 as in property 4 , substitute in @xmath395 and @xmath396 for @xmath397 ; note that @xmath398 and so the generating function becomes @xmath399 restricting our attention to sufficiently large @xmath5 and a particular residue class of @xmath400 , we have @xmath401 and the coordinate functions of @xmath402 , are polynomials .",
    "we may assume that @xmath403 are lexicographically positive , by taking sufficiently large @xmath5 so that the signs of the coordinate functions do not change , and then using remark [ rmk : lexpos ] .",
    "since we are assuming that @xmath404 has a maximum , @xmath405 , on @xmath14 , we see that all @xmath406 have @xmath407 coordinatewise .",
    "therefore @xmath408 is a laurent power series convergent on a neighborhood of @xmath409 , for any @xmath410 .",
    "expanding the right - hand side of ( [ eqn : lexmin ] ) as a product of geometric series also gives a laurent power series convergent on a neighborhood of @xmath409 , for sufficiently small @xmath96 ( since the @xmath411 are lexicographically positive ; see remark [ rmk : lexpos2 ] ) .",
    "therefore they must be identical as laurent power series expansions .",
    "but the lexicographically minimal term of the expanded right - hand side is clear : for sufficiently large @xmath5 , it is the unique lexicographical minimum among the @xmath412 , @xmath413 . inverting @xmath414 yields an element of @xmath14 maximizing @xmath415",
    "finally , we will show that , @xmath415 either eventually always achieves a maximum or eventually always does nt ( at least for this residue class of @xmath400 ; this implies that the set of _ all _",
    "@xmath5 for which it achieves a maximum is eventually periodic ) .",
    "if the maximum exists , we have found it above ; call it @xmath416 , which is a polynomial .",
    "define the set @xmath417 .",
    "then @xmath393 attains a maximum on @xmath14 if and only if @xmath418 is empty",
    ".    given two laurent power series @xmath419 and @xmath420 ( @xmath421 ) convergent on a neighborhood of some @xmath422 , define their hadamard product , @xmath423 , to be @xmath424 .",
    "we are given that @xmath425 has property 4 . by theorem [ thm : vw ]",
    ", @xmath426 also has property 4 .",
    "in particular , their numerator and denominator have the form @xmath427 where @xmath368 and the coordinate functions of @xmath369 are polynomials .",
    "note that @xmath428 ; we want to decide whether this is identically zero .",
    "we will show that @xmath423 also has numerator and denominator in the form ( [ eqn : plugging_in2 ] ) , in which case ( for sufficiently large @xmath5 ) it is identically zero if and only if its numerator is identically zero .",
    "since the hadamard product is a bilinear operator , it suffices to show that @xmath429 has numerator and denominator of the form ( [ eqn : plugging_in2 ] ) .",
    "what is the coefficient of @xmath430 in this hadamard product ?",
    "expanding the first rational function as a product of geometric series , the coefficient of @xmath431 in it is @xmath432 and similarly the coefficient of @xmath431 in the second is @xmath433 .",
    "therefore the coefficient of @xmath431 in the hadamard product is the product of these , that is , @xmath434    there are no quantifiers in this expression ( [ eqn : had ] ) , so it is of the form in part ( a ) of theorem [ thm : cases ] , meaning we proved in section [ pf3.54 ] that the generating function @xmath435 satisfies property 4 .",
    "substituting @xmath436 gives the hadamard product ; following the proof of @xmath437 ( which may involve lhpital s rule and therefore differentiation of the numerator and denominator ) , we see that the hadamard product indeed has numerator and denominator in the form ( [ eqn : plugging_in2 ] ) .",
    "therefore @xmath423 is either identically zero ( and hence @xmath438 is always maximized on @xmath14 ) or eventually never zero ( and hence @xmath438 does not achieve a maximum ) .",
    "this is true for every residue class of @xmath5 , so , all together , the set of @xmath5 for which a maximum is achieved will eventually be periodic .    * @xmath349 * : since we have proven that @xmath439 @xmath439 , we can get a single element @xmath440 , when @xmath14 is nonempty .",
    "now we can continue inductively : @xmath441 can be written as a rational function of the appropriate form , so @xmath442 has property 4 .",
    "thus we can use property 3 to get another element @xmath443 and also conclude that the set of @xmath5 for which @xmath444 ( which is the set of @xmath5 for which @xmath445 is nonempty ) is eventually periodic .",
    "continue inductively .            to prove that 3a holds , let @xmath448 be given .",
    "define a new set @xmath270 to be the solutions @xmath449 to @xmath450 these are exactly the set of elements @xmath179 maximizing @xmath451 in @xmath14 ( and it is empty if there is no such @xmath179 ) . by property 3 , the set of @xmath5 such that @xmath270 is nonempty is eventually periodic , and there exists an eventually quasi - polynomial @xmath248 such that @xmath452 when it is nonempty .",
    "this is the desired @xmath248 .    to prove that 3b holds",
    ", we induct on @xmath318 .",
    "the base case @xmath357 is property 3 and so is true .",
    "inductively applying property 3 to the sentence @xmath453 yields new elements , and this formula has solutions exactly when @xmath260 , so the set of such @xmath5 is eventually periodic , by property 3 .",
    "alexander barvinok and james pommersheim .",
    "an algorithmic theory of lattice points in polyhedra . in _",
    "new perspectives in algebraic combinatorics ( berkeley , ca , 199697 ) _ , volume  38 of _ math .",
    "_ , pages 91147 .",
    "cambridge univ . press ,",
    "cambridge , 1999 .",
    "matthias beck .",
    "the partial - fractions method for counting solutions to integral linear systems . _ discrete and computational geometry _ , 32(4 ) : 437446 , 2004 .",
    "http://dx.doi.org/10.1007/s00454-004-1131-5[`doi:10.1007/s00454-004-1131-5 ` ] .",
    "danny calegari and alden walker .",
    "integer hulls of linear polyhedra and scl in families .",
    "http://dx.doi.org/10.1090/s0002-9947-2013-05775-3[`doi:10.1090/s0002-9947-2013-05775-3 ` ] .",
    "sheng chen , nan li , and steven  v. sam .",
    "generalized ehrhart polynomials . _ trans .",
    "_ , 3640 ( 1):0 551569 , 2012 .",
    "http://dx.doi.org/10.1090/s0002-9947-2011-05494-2[`doi:10.1090/s0002-9947-2011-05494-2 ` ] .",
    "mojesz presburger .",
    "ber die vollstndigkeit eines gewissen systems der arithmetik ganzer zahlen in welchen die addition als einzige operation hervortritt . in _ comptes - rendus du premier congrs des mathmaticiens des pays slaves _ , 1929 .",
    "mojesz presburger . on the completeness of a certain system of arithmetic of whole numbers in",
    "which addition occurs as the only operation .",
    "_ hist . philos . logic _ , 120 ( 2):0 225233 , 1991 .",
    "http://dx.doi.org/10.1080/014453409108837187[`doi:10.1080/014453409108837187 ` ] .",
    "translated from the german and with commentaries by dale jacquette .",
    "richard  p. stanley .",
    "_ enumerative combinatorics .",
    "volume 1 _ , volume  49 of _ cambridge studies in advanced mathematics_. cambridge university press , cambridge , second edition , 2012 .",
    "http://dx.doi.org/10.1017/cbo9781139058520[`doi:10.1017/cbo9781139058520 ` ] .",
    "sven verdoolaege and kevin woods .",
    "counting with rational generating functions .",
    "_ j. symbolic comput .",
    "_ , 430 ( 2):0 7591 , 2008 .",
    "http://dx.doi.org/10.1016/j.jsc.2007.07.007[`doi:10.1016/j.jsc.2007.07.007 ` ] .",
    "eugene  p wigner . the unreasonable effectiveness of mathematics in the natural sciences",
    ". _ communications on pure and applied mathematics _ , 130 ( 1):0 114 , 1960 .",
    "http://dx.doi.org/10.1002/cpa.3160130102[`doi:10.1002/cpa.3160130102 ` ] .",
    "kevin woods .",
    "presburger arithmetic , rational generating functions , and quasi - polynomials . in _ proceedings of icalp ,",
    "the international colloquium on automata , languages and programming _ , volume 7966 of _ lecture notes in computer science _ , pages 410421 .",
    "springer , 2013 .",
    "http://dx.doi.org/10.1007/978-3-642-39212-2_37[`doi:10.1007/978-3-642-39212-2_37 ` ] ."
  ],
  "abstract_text": [
    "<S> a function @xmath0 , with domain the natural numbers , is a quasi - polynomial if there exists a period @xmath1 and polynomials @xmath2 such that @xmath3 for @xmath4 . </S>",
    "<S> quasi - polynomials classically  and `` reasonably ''  appear in ehrhart theory and in other contexts where one examines a family of polyhedra , parametrized by a variable @xmath5 , and defined by linear inequalities of the form @xmath6 .    </S>",
    "<S> recent results of chen , li , sam ; calegari , walker ; and roune , woods show a quasi - polynomial structure in several problems where the @xmath7 are also allowed to vary with @xmath5 . </S>",
    "<S> we discuss these `` unreasonable '' results and conjecture a general class of sets that exhibit various ( eventual ) quasi - polynomial behaviors : sets @xmath8 that are defined with quantifiers ( @xmath9 , @xmath10 ) , boolean operations ( and , or , not ) , and statements of the form @xmath11 , where @xmath12 and @xmath13 are polynomials in @xmath5 . </S>",
    "<S> these sets are a generalization of sets defined in the presburger arithmetic . </S>",
    "<S> we prove several relationships between our conjectures , and we prove several special cases of the conjectures . the title is a play on eugene wigner s `` the unreasonable effectiveness of mathematics in the natural sciences '' .    * keywords : * ehrhart polynomials , generating functions , presburger arithmetic , quasi - polynomials , rational generating functions </S>"
  ]
}