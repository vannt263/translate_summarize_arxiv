{
  "article_text": [
    "for complex dynamical systems consisting of many interacting subsystems it is a general challenge to reduce the high dimensionality to a few dominating variables that characterize the system .",
    "cluster analysis is a method to group elements according to their similarity .",
    "however , there is an ambiguity as different algorithms may lead to different clusters @xcite .",
    "the dynamical behavior of complex systems may reduce their complexity by self - organization . here",
    "the high - dimensional dynamics generates a few order parameters evolving slowly on a strongly fluctuating background @xcite . with the help of stochastic methods it is possible to show such simplified dynamics and to estimate a langevin equation directly from the data , _",
    "i.e. _ the data are analyzed as a stochastic process with drift and diffusion term @xcite .",
    "we show that cluster analysis and stochastic methods can be combined in a fruitful way .",
    "cluster analysis does not aim at grasping dynamical effects . by combining it with stochastic methods",
    "we show that an improved dynamical cluster classification can be obtained .",
    "furthermore we extract dynamical cluster features of a complex system as emerging and disappearing clusters .",
    "related ideas were put forward by hutt _",
    "@xcite for detecting fixed points in spatiotemporal signals . here , we focus on financial data , for which quasi - stationary market states were identified in the correlation structure using cluster analysis @xcite .",
    "we briefly sketch these findings before developing our combined analysis .",
    "we study the daily closing prices @xmath0 of the s&p 500 stocks for the period 1992  2012 @xcite , which aggregate to 5189 trading days .",
    "only the 306 stocks that were continuously traded during the whole period are considered .",
    "we calculate the relative price changes , _",
    "i.e. _ the returns    @xmath1    for each stock @xmath2 for a time horizon @xmath3 of one trading day ( td ) . to avoid an estimation bias due to time - varying trends and fluctuations ,",
    "we perform a local normalization @xcite of the returns before estimating their correlations .",
    "we denote the locally normalized returns by @xmath4 .",
    "we then calculate the pearson correlation coefficients    @xmath5    here @xmath6 denotes the average over 42 trading days .",
    "we obtain a correlation matrix @xmath7 for each time @xmath8 by moving the calculation window in steps of one trading day through the time series .",
    "all of the considered companies are classified by ten industry sectors according to the global industry classification standard ( gics ) @xcite . to reduce the estimation noise",
    ", we average the correlation coefficients within each sector and between different sectors , leading to @xmath9 matrices . while this sector - averaged matrix is symmetric , its diagonal is not trivial .",
    "thus , it contains @xmath10 independent entries .",
    "the crucial idea is to identify each averaged correlation matrix with an element in the real @xmath11-dimensional euclidian space @xmath12 , so that a similarity , _ i.e. _ a distance , between any two correlation matrices can be calculated . throughout this paper all distances",
    "are measured in the euclidean norm which we denote by @xmath13 .    as the next step we use the bisecting _",
    "k_-means clustering algorithm @xcite . at the beginning of the clustering procedure",
    "all of the correlation matrices are considered as one cluster , which is then divided into two sub clusters using the _ k_-means algorithm with @xmath14 .",
    "this separation procedure is repeated until the size of each cluster  in terms of the mean distance of the cluster members to the cluster center  is smaller than a given threshold .",
    "we choose the mean distance to be smaller than @xmath15 to achieve 8 clusters as in ref .",
    "the market is said to be in a market state @xmath16 at time @xmath8 , if the corresponding correlation matrix is in the @xmath16th cluster . in figure  [ f.dendo+states ]  ( a )",
    "the corresponding clustering tree is shown .",
    "figure  [ f.dendo+states ]  ( b ) depicts the temporal evolution of the financial market .",
    "new clusters form and existing clusters vanish in the course of time . and while the first 1000 trading days are dominated by state 1 and only occasional jumps to state 3 , we observe more frequent jumps and less stable behavior in more recent times .",
    "+     to quantify the market situation at time @xmath8 , the distance    @xmath17    of the correlation matrix @xmath7 to the eight cluster centers @xmath18 ( @xmath19 ) is calculated .",
    "two of the eight resulting time series are shown in fig .",
    "[ f.states ] .",
    "these time series depict the temporal evolution of the system seen from the respective cluster centers .",
    "figure  [ f.states ] shows that the market is in the beginning close to cluster center 1 and far away from cluster center 6 .",
    "this changes over time in accordance with fig .",
    "[ f.dendo+states ]  ( b ) : cluster 6 occurs later while cluster 1 is present during the first half of the time period .    ) of the system to cluster center 1 ( dashed , red ) and cluster center 6 ( black ) . ]",
    "a wide class of dynamical systems from different fields are modeled as stochastic processes and thus described by a stochastic differential equation , the langevin equation @xcite    @xmath20    which describes the time evolution of the system variable @xmath21 as a sum of a deterministic function @xmath22 and a stochastic term @xmath23 .",
    "the stochastic force @xmath24 is gaussian distributed with @xmath25 and @xmath26 . for stationary continuous markov processes",
    "_ @xcite and friedrich _ et al . _",
    "@xcite showed that it is possible to extract drift and diffusion functions directly from measured time series using the kramers - moyal coefficients @xmath27 , which are defined as conditional moments    @xmath28    here @xmath29 denotes the value of the stochastic variable @xmath30 at which the drift function ( @xmath31 ) and the diffusion function ( @xmath32 ) are evaluated .",
    "the average in eq .",
    "( [ eq.condmom ] ) is performed over all realizations of @xmath30 for which the condition @xmath33 holds .",
    "equation ( [ eq.condmom ] ) expresses therefore ( modulo the exponent @xmath34 ) the mean increment of the variable @xmath30 after time step @xmath35 if starting at the given value @xmath29 at time @xmath8 .",
    "the derivative of this mean increment with respect to @xmath35 at @xmath36 is equal to the value of the drift function for @xmath31 and the diffusion function for @xmath32 at @xmath29 , as defined in eq .",
    "( [ eq.kramers ] ) .",
    "we refer to ref .",
    "@xcite for further details .    in the present work we estimate the drift functions on time windows of 1000 trading days , on which the estimated quantities are treated as time independent",
    ". the time dependency is obtained by comparing the estimated drift functions on a sliding time window . especially for small data",
    "sets the estimation of the conditional moments ( [ eq.condmom ] ) might be tedious . additionally to the original estimation procedure proposed by siegert _",
    "_ @xcite and friedrich _ et al . _",
    "@xcite we use here a kernel based regression as proposed in ref .",
    "@xcite .    instead of analyzing the drift function itself ,",
    "it is more convenient to consider the potential function defined as the negative primitive integral    @xmath37    of the drift function .",
    "the minus sign is a convention .",
    "the dynamics of the system is encoded in the shape of @xmath38 : the local minima of the potential function correspond to quasi - stable equilibria , or quasi - stable fixed points , around which the system oscillates .",
    "in contrast , local maxima correspond to unstable fixed points .",
    "we note that , due to definition , potential functions are defined up to an additive constant which is here set to zero .",
    "we further note that both the drift function and the potential function have the dimension of inverse time .",
    "one drawback of clustering is that the number of clusters is in general not known _ a priori_.",
    "therefore a threshold criterion is used .",
    "furthermore , clustering is based only on geometrical properties like positions and distances between elements , _",
    "i.e. _ their similarity .",
    "the dynamics of the system is not involved . as a new approach",
    "we combine the clustering analysis with the stochastic analysis .",
    "the aim is to extract dynamical attributes from time series and derive stability features and quasi - stable fixed points .",
    "from the eight time series as defined in eq .",
    "( [ eq.timeseries ] ) we calculate the deterministic potentials @xmath39 ( @xmath19 ) as defined in eq .",
    "( [ eq.phi ] ) . to grasp the time evolution of the clusters , _",
    "i.e. _ market states , we calculate @xmath40 on a window of 1000 data points ( @xmath41 four trading years ) which we shift by 21 data points ( @xmath41 one trading month ) , resulting in 199 deterministic potentials @xmath40 for each cluster @xmath16 .",
    "figure  [ f.hit_centers ] shows a sample of these potentials for different time windows .",
    "the dotted vertical lines denote the distance to the cluster centers which are labeled at the abscissa .",
    "each potential in the five figures shows a clear minimum .",
    "hence , the market dynamics expressed by the correlation matrices performs a noisy dynamics around the attractive fixed point , which is defined by the minimum .",
    "most interestingly the position of the minima of these potentials coincide quite well with the distances to the cluster centers obtained from the cluster analysis . additionally to the positions of the fixed points of the system , the potentials provide information about the stability of the market in the analyzed time window .",
    "potential functions with more than only one clear local minimum , e.g. fig .  [ f.hit_centers ]",
    "( a )  and  ( b ) , reflect an unstable dynamics .",
    "in contrast an isolated and deep minimum as in fig .  [ f.hit_centers ]  ( e ) , corresponds to a stable dynamics .    in fig .",
    "[ f.hit_centers ]  ( c )  -  ( e ) a transition from state 4 and 5 , which are very close , to state 2 is shown .",
    "the quasi - stable fixed point of the potential function changes its position in time and moves closer to the center of the first cluster .",
    "we note that in the intermediate state , as shown in fig .",
    "[ f.hit_centers ]  ( d ) , the width of the potential function is increased . instead of a clear local minimum it has a rather flat plateau .",
    "the time evolution of the market reflected in the position change of the local minimum of the potential function is thus taken as a state transition .",
    "the ability of our approach to describe multi - stable and transitional behavior has also been shown by mcke _",
    "@xcite in the context of wind energy . stability of market states as well as state transitions are studied in detail in stepanov _",
    "besides the cases where the positions of the minima of the potentials coincide clearly with the distances to cluster centers , there are also less clear situations as shown in fig .  [ f.merge ] . in the considered time window @xmath42",
    "$ ] ( expressed in td ) the market is switching between the states 2 , 3 , 4 , 5 and 6 . the clustering procedure as described above",
    "does nt take the dynamics of the market into account .",
    "all of the correlation matrices are clustered at the same time without any information about how the market is jumping between the correlation matrices .",
    "the elements of a cluster are chosen in such a way that the sum of the distances to its cluster center is minimized .",
    "the stochastic analysis of the market dynamics seen from cluster center 1 as well as from cluster center 3 , shows that the potential function exhibits a pronounced minimum between the distances to the cluster centers 5 , 4 and 6 as shown in fig .",
    "[ f.merge ] .",
    "this fact is now taken as a criterion to change the cluster analysis in a way that the clusters 4 , 5 and 6 will be combined to a new cluster 5*. that this merging of clusters is natural is indicated by the clustering tree of figure  [ f.dendo+states ]  ( a ) , as the three merged clusters arise from the split of the same ancestor cluster .",
    "if the threshold is chosen small enough , this cluster would not have been split .    for reference",
    "we show in fig .",
    "[ f.evo_states_6 ] the temporal evolution of the states after merging clusters 4 , 5 and 6 to cluster 5*. the distance to the center of the merged cluster as seen from clusters 1 and 3 , respectively , coincides remarkably with the position of the local minimum of the potential as marked by the broken line ( dash point ) in fig .",
    "[ f.merge ] .",
    "we thus conclude that while for the chosen threshold the clusters , _",
    "i.e. _ market states 4 , 5 and 6 are geometrically distinct , together these states form a single quasi - stationary state .",
    "while being in this state , the system fluctuates around the center of the cluster 5 * , which is a fixed point of the system .",
    "we note that the mean correlation matrix    @xmath43    of the analyzed time period @xmath44 differs clearly from the center of the merged cluster @xmath45 with @xmath46 . here",
    "@xmath47 denotes the length of @xmath44 .",
    "furthermore the distances to the cluster center 1 @xmath48 and the cluster center 3 @xmath49 do nt match the positions of the minimum of the potential as shown in fig .",
    "[ f.merge ] .         as defined in eq .",
    "( [ eq.d ] ) .",
    "the time points in which the market occupies the merged state 5 * are marked by the vertical grey lines . ]     as defined in eq .",
    "( [ eq.d ] ) .",
    "the time points in which the market occupies the merged state 5 * are marked by the vertical grey lines . ]",
    "in the previous section we used clustering and stochastic analysis of the one - dimensional time series to obtain fixed points of the system . we identified the positions of the local minima of the potential functions with the distances to the quasi - stationary fixed points . in this section",
    "we propose a method to identify quasi - stationary fixed points by an optimization problem .",
    "we recall that the mean correlation matrix ( [ eq.meancorr ] ) minimizes the sum of distances    @xmath50    of @xmath7 in @xmath44 to a fixed correlation matrix @xmath51 . for",
    "high - dimensional empirical data , distinct subspaces ( principal components ) may exist along which data points are preferably distributed @xcite .",
    "therefore we require the fixed points of the system to be elements of these subspaces . as the sum of two elements of a given principal component",
    "is not necessarily an element of this component anymore , the calculation of the average ( [ eq.meancorr ] ) does not neccessarily yield the fixed point of the system .",
    "we gave an example of this in the previous section .",
    "the calculated average @xmath52 does not match the position of the fixed point found by stochastic analysis .",
    "here we propose to identify system fixed points as the elements of the preferred subspaces which are the most similar to all @xmath7 in a given time interval @xmath44 , i.e. they minimize the sum of distances ( [ eq.sumdist ] ) . in absence of any preferable subspaces",
    "we recover the mean correlation matrix @xmath52 .",
    "this idea is similar to the definition of the geodetic curves on an arbitrary manifold which minimize the distance between any two points and are not necessarily straight lines any more .    as an application we consider the data sample from the previous section . as shown in fig .",
    "[ f.merge ] the stochastic analysis in the time interval @xmath42 $ ] ( expressed in trading days ) shows a deep minimum at @xmath53 as seen from the center of the first market state @xmath54 .",
    "the data points are therefore distributed approximately around @xmath54 .",
    "the set of all possible fixed points is restricted to the points on the @xmath55-dimensional hypersphere of radius @xmath56 around @xmath54 . to find the empirical fixed point for this setting we minimize ( [ eq.sumdist ] ) under the condition    @xmath57    which we solve by the method of lagrange multipliers .",
    "we note that for the euclidian norm the problem always has a unique minimum and maximum , unless the distance ( [ eq.timeseries ] ) is constant .",
    "the empirical solution of the problem , denoted by @xmath58 , differs slightly from the center of the merged cluster defined in the previous section , @xmath59 .",
    "this is because the market does not exclusively stay in the merged state 5 * during the analyzed time period @xmath44 , as observed in fig .",
    "[ f.evo_states_6 ]  ( a ) .",
    "we now quantify the deviation of the obtained fixed point @xmath58 from the averaged correlation matrix @xmath52 by looking at the difference    @xmath60    of the distances from @xmath7 to @xmath58 and @xmath52 , respectively . the market is closer to @xmath58 than to @xmath52 whenever @xmath61 holds .    the time series @xmath62 is shown in fig .  [ f.evo_states_6 ]  ( b ) .",
    "it is switching between positive and negative values .",
    "the grey background highlights the time points @xmath8 at which the market occupies the merged state 5 * , which remarkably coincidences with the negative values of @xmath62 .",
    "we almost exactly quantify the merged market states during which @xmath62 falls rapidly down from positive values . not only is the market state identified but also the dynamics of the market within the state . as seen from fig .",
    "[ f.evo_states_6 ]  ( b ) , the values of @xmath62 continuously decrease and then increase again while the market occupies the merged state . in contrast",
    "@xmath62 is fluctuating around a positive value while the market is not in the merged state .    as a consistency check",
    ", we applied the same algorithm with the center of the third cluster @xmath63 , as well the overall mean correlation matrix as reference points . in all cases",
    "we obtained the same fixed point @xmath58 .",
    "the combination of the cluster analysis and the stochastic process analysis allows to characterize the dynamics of a dynamical system as a noise process between different quasi - stationary states . for financial markets",
    "these market states are defined in terms of correlation matrices which reflect the dependence structure of the stock market .",
    "especially , while being in a given market state , the market is fluctuating around the center of the corresponding cluster .",
    "a threshold criterion can produce geometrically distinct states , which are a single quasi - stationary state of the system .",
    "the deviation of the market situation at time @xmath8 from individual market states is reflected in the distance between the correlation matrix @xmath7 and the respective cluster centers .",
    "this distance is taken as the new low - dimensional order parameter of the complex system .",
    "the stochastic analysis provides evidence of how the market dynamics is guided by a changing potential landscape with temporally changing stability of the market states . emerging new quasi - stable states",
    "are found . in this way we present a method with which the dynamics of a high - dimensional complex system is projected to low - dimensional collective dynamics .",
    "furthermore we address the high dimensionality of the data set by an optimization problem .",
    "this problem is well defined and is robust against the choice of reference points .",
    "we obtain high - dimensional quasi - stable fixed points of financial markets explicitly and see good chances to apply this method also to other complex states ."
  ],
  "abstract_text": [
    "<S> we propose a combination of cluster analysis and stochastic process analysis to characterize high - dimensional complex dynamical systems by few dominating variables . as an example </S>",
    "<S> , stock market data are analyzed for which the dynamical stability as well as transitions between different stable states are found . </S>",
    "<S> this combined method also allows to set up new criteria for merging clusters to simplify the complexity of the system . </S>",
    "<S> the low - dimensional approach allows to recover the high - dimensional fixed points of the system by means of an optimization procedure . </S>"
  ]
}