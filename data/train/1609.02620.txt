{
  "article_text": [
    "gait optimization algorithms for locomoting systems must contend with a number of nonlinear effects , including : shape - dependent system dynamics ( and thus a control structure that depends on the state of the controller and not just the plant ) ; and history - dependent input - output mappings ( e.g. if one part of the gait rotates the system , future translational sections will propel the system in a new direction ) .",
    "the geometric mechanics community has long recognized that lie brackets of the system dynamics can be used to provide an understanding of these nonlinearities , and thereby to identify shape oscillations that produce useful net displacements through the world  @xcite . for kinematic locomoting systems with two shape variables ( a class which includes a number of informative systems in viscous , granular , inertial , and fluid environments  @xcite )",
    ", the lie bracket can be visualized as a set of `` height functions '' over the shape space , whose topographies identify good placements for gait trajectories . for example , gaits that move a system forward encircle positive peaks ( or negative valleys ) in the @xmath0 component of the lie bracket , whereas gaits that turn the system with minimal translation enclose sign - definite regions in the @xmath1 component and balanced positive and negative regions in the @xmath0 and @xmath2 components .",
    "an enduring goal  @xcite of this community has been to go beyond simply identifying the direction in which small shape oscillations will propel the system , and to use the lie bracket principle to identify optimal gaits that generate the most displacement , either per gait cycle or per energy expended . for example , a gait that completely encircles a sign - definite region of a height function ( by tracing out its zero - contour ) would maximize displacement in the corresponding direction ; similarly , a contraction of the zero contour that balances the enclosed area against the perimeter length ( effort ) required to capture it would maximize the efficiency with which this displacement is achieved  @xcite .    a key obstacle to reaching this goal was the noncommutativity in the equations of motion for most interesting locomoting systems .",
    "because translations and rotations do not commute with each other , summing up lie brackets over a finite region provides only an approximation of the displacement induced by a gait , and the error in this approximation increases with the amplitude of the oscillation .",
    "historically ( e.g. ,  @xcite ) , this error was regarded as growing too quickly to provide any meaningful information about the optimal gait cycles . in  @xcite , however , we introduced a choice of coordinates that converts much of the system s noncommutativity into nonconservativity , which _ is _ amenable to finite - scale integration . by working in these new coordinates ,",
    "we have gained insight into the optimal gaits of swimmers and crawlers in low- and high - viscosity fluids  @xcite , and in granular media  @xcite .",
    "further , we have used this insight to easily `` hand - draw '' optimized gaits that would otherwise only have been found by a long numerical search of a high - dimensional space of trajectory parameters  @xcite .    in this paper , we build on our previous work by encoding the geometric insight described above into a variational gait optimizer .",
    "the chief elements of this optimizer are :    a gradient ascent / descent component that pushes the cycle to enclose a large sign - definite region of the lie bracket to maximize the net displacement it generates ; a cost component based on a riemannian distance metric that limits the growth of the gait cycle ; anda perimeter - balancing component that evenly - spaces the waypoints in the trajectory , stabilizing the solution and providing an efficiency - optimal parameterization of the resulting motion .    as illustrated in fig .",
    "[ fig : overview ] , these components together form a dynamical system analogous to a soap bubble , whose boundary ( here , the gait curve ) is pushed outward by internal pressure ( here , the lie bracket ) and constrained by surface tension ( here , the metric - weighted pathlength ) .",
    "the perimeter - balancing term corresponds to the concentration gradient that evenly distributes soap across the surface of the bubble .    as a demonstration of this approach ,",
    "we use it to identify optimal gaits for a set of example systems .",
    "these systems include purcell s three - link swimmer  @xcite ( a standard benchmark for locomotion analysis ) and a continuous - curvature extension of purcell s swimmer  @xcite ( to emphasize that `` two shape variables '' does not restrict the applicability of this work to systems with `` two joints '' ) .",
    "we identify optimal gaits for these systems in both the forward and turning directions , which match those found previously in works such as  @xcite .",
    "when analyzing a locomoting system , it is convenient to separate its configuration space @xmath3 ( i.e.  the space of its generalized coordinates @xmath4 ) into a position space @xmath5 and a shape space @xmath6 , such that the position @xmath7 locates the system in the world , and the shape @xmath8 gives the relative arrangement of the particles that compose it",
    ". the structure of a ( trivial , principal ) _ fiber bundle _ , with @xmath5 the _ fiber space _ and @xmath6 the _ base space_. ] for example , the positions of both the three - link system and the serpenoid swimmer in fig .  [ fig:3link ] are the locations and orientations of their centroids and mean orientation lines , @xmath9 .",
    "the shape of the three - link system is parameterized by the two joint angles , @xmath10 , and the serpenoid s shape is described by a pair of modal amplitudes multiplied by the curvature modes @xmath11 and @xmath12  @xcite that together specify the amplitude and phase of its body wave .    a useful model for locomotion in",
    "_ kinematic _ regimes where no gliding can occur , and which we employ in this paper , is that at each shape , there exists a linear relationship between changes in the system s shape and changes in its position , = - ( ) , [ eq : kinrecon ]    ( a ) and that for the serpenoid swimmer are shown in fig .",
    "[ fig : connection3link](b).note that scale in vector fields has been chosen to emphasize structure , and that scales in different components or systems are not comparable . also note qualitative similarity ( modulo rotation ) across systems ]    in which @xmath13 is the body velocity of the system ( i.e. , @xmath14 expressed in the system s local coordinates ) , and the _ local connection _",
    "@xmath15 acts like the jacobian of a robotic manipulator , mapping from joint velocities to the corresponding body velocity .",
    "each row of @xmath16 can be regarded as a body - coordinates gradient of one position component with respect to the system shape , as illustrated for the three - link and serpenoid swimmers in fig .",
    "[ fig : connection3link ] . in a drag - dominated environment",
    ", the effort required to change shape can be modeled as the pathlength @xmath17 of the trajectory through the shape space , weighted by a riemannian metric @xmath18 as @xmath19 as discussed in  @xcite , the metric tensor @xmath18 is the same as the map from shape velocity to power dissipated into the surrounding medium , p = , and so can be readily calculated from the first - principles physics of the system      in this paper , we generate the dynamics for our example systems from a resistive force model , in which each element of the body is subject to normal and tangential drag forces proportional to their velocities in those ( local ) directions . the normal drag coefficient is larger than the tangential component ( here , by a factor of @xmath20 ) , corresponding to the general principle that it is harder to move an object in a fluid or on a surface crosswise than it is to move it along its length .",
    "we then impose a quasi - static equilibrium condition that the net drag force and moment on the system is zero at all times ( treating the system as heavily overdamped , with acceleration forces much smaller than drag forces ) ; because the drag forces are not isometric , the system can use the angle - of - attack of its body surfaces to generate net motion .",
    "together , these conditions impose a _ _ pfaffian constraint__. ] on the system s generalized velocity ,    f^b_x + f^b_y + f^b _    =    0 + 0 + 0    = ( )     +    , [ eq : forcepfaffian ] in which the matrix @xmath21 that maps the velocities to the net forces on the body frame is an expression of the system s internal kinematics and depends only on the shape @xmath22 . by separating @xmath21 into two sub - blocks , @xmath23 $ ] ,",
    "it is straightforward to rearrange into = -(_^-1_),[eq : invomega ] revealing the local connection as @xmath24 . for a more detailed treatment this process , we refer the reader to  @xcite .",
    "once @xmath15 has been found , it can be used to calculate the riemannian metric @xmath18 as p = f^b = = _ .",
    "we apply this physics models to two example geometries : purcell s three - link swimmer  @xcite , and a _ serpenoid swimmer",
    "_  @xcite .",
    "the three - link swimmer is a useful and widely - adopted  @xcite minimal example for locomotion , because the two degrees of freedom can be easily visualized .",
    "the serpenoid swimmer , whose shape is defined by the amplitude of sine and cosine curvature modes  @xcite , provides an example of a two - dof system that has been shown to closely model how snakes and other animals use undulatory locomotion to move through the world  @xcite .",
    "optimal gait design has a long history of research in the physics , mathematics , and engineering communities , as part of the broader field of optimal control  @xcite .",
    "for systems of the classes we consider here , notable contributions include those of purcell , who introduced the three - link swimmer as a minimal template for understanding locomotion , a series of works  @xcite aimed at numerically optimizing the stroke pattern , and the observation in  @xcite that the optimal pacing for the gait keeps the power dissipation constant over the cycle .    ) for the three link swimmer are shown in fig.[fig : heightfun](a ) and that for the serpenoid swimmer are shown in fig.[fig : heightfun](b ) .",
    "note the qualitative similarity ( modulo a rotation ) between the two sets of height functions . ]",
    "several efforts in the geometric mechanics community ( including our own ) , have aimed to use the structure of the systems _ lie brackets _ ( a measure of how  non - canceling \" the system dynamics are over infinitesimal cyclic inputs ) to understand the structure of the optimal solutions to the system equations of motion  @xcite .",
    "the core principle in these works is that because the net displacement @xmath25 over a gait cycle  @xmath26 is the line integral of   along @xmath26 , the displacement can be approximated by an area integral of the curvature @xmath27 of the local connection ( its total lie bracket  @xcite ) over a surface @xmath28 bounded by the cycle : @xmath29}}_{\\text{$-d\\mixedconn$ ( total lie bracket ) } } , \\label{eq : lie}\\end{aligned}\\ ] ] in which @xmath30 is the exterior derivative of the local connection ( its generalized row - wise curl ) and the local lie bracket term evaluates ( on @xmath31 ) as _",
    "1,_2 =    ^y_1^_2- ^y_2^_1 + ^x_2^_1- ^x_1^_2 + 0    .    plotting these curvature terms as height functions ( as in fig .",
    "[ fig : heightfun ] ) reveals the attractors that influence the optimal gait cycles : gaits that produce net displacement in a given @xmath32 direction are located in strongly sign - definite regions of the corresponding @xmath27 height function . for example , @xmath0-translation gaits encircle the center of the shape space for both the three - link and serpenoid systems , whereas @xmath2-translations or @xmath1-rotations are produced by cycles in the corners or edges of the shape space .    in  @xcite , we identified coordinate choices that make the approximation in   accurate for large - amplitude gaits , which allowed us to make two extensions to the area principles : first , that maximum - displacement gaits ( the `` longest strides '' that the systems can take ) follow the zero - contours of the height functions , completely enclosing a sign definite region .",
    "second , that the most efficient gaits ( the systems `` comfortable strides '' ) are contractions / straightenings of these zero - contours ; by giving up the low - yield regions at the edges of the sign - definite regions ( or crossing slightly into opposite - sign regions ) the system travels a shorter distance in each cycle , but the consequently shorter perimeter length means the system can repeat the cycles more quickly at a given level of power consumption .",
    "our aim with this paper is to encode the geometric principles described in   [ sec : gaitoptimization ] into a gait optimization algorithm .",
    "we start from the basic variational principle that functions reach their extrema when their derivatives go to zero . given a gait parameterization @xmath33",
    ", maximum - displacement cycles therefore satisfy the condition that the gradient of net displacement with respect to the parameters is zero , [ eq : maxdispcond ] _ = and maximum - efficiency cycles ( normalizing displacement by the pathlength - effort required to generate it ) likewise satisfy the condition that the gradient of this efficiency ratio is zero , [ eq : maxeffcond ] _",
    "= _ -_= . for suitable seed values @xmath34 ,",
    "solutions to   and   can therefore be reached by finding the respective equilibria of the dynamical systems [ eq : gaitequilibria ] = _    = _ .    as discussed in the following subsections",
    ", we then incorporate the geometric principles in   and   to evaluate the @xmath35 and @xmath36 terms in   as functions of the system s lie bracket @xmath27 and riemannian metric @xmath18 .",
    "we also use the metric @xmath18 to introduce a third term ,  @xmath37 , to  .",
    "this term acts orthogonally to the optimization process , but serves to enforce an even sampling of points around the perimeter of the gait .",
    "this even distribution promotes stability of the optimizer and additionally corresponds to optimal pacing ( internal timing ) of the gait , as discussed in  @xcite .",
    "collecting all three terms and factoring out a coefficient of  @xmath38 from  , our algorithm thus finds the maximum - efficiency gait as the equilibrium of [ eq : fullequation ] = _ -_+ _ . as illustrated in fig .",
    "[ fig : overview ] , this differential equation is directly analogous to the equations governing the shape of a soap bubble : @xmath35 takes the lie bracket as an `` internal pressure '' seeking to expand the gait cycle , @xmath36 is the `` surface tension '' that constrains the growth of the bubble , and @xmath37 is the `` concentration gradient '' that spreads the soap over the bubble s surface .    in the following subsections ,",
    "we explore each of the terms in  , discussing both their fundamental geometric definitions and how they can be implemented in a direct - transcription solver that parameterizes the gait as a sequence of waypoints .",
    "the first term in  ,  @xmath35 , guides the gait towards maximum - displacement cycles . by sustituting the approximation from   into this expression as _ _ _ _ a(-d ) , and noting that variations in @xmath33 affect @xmath26 but not @xmath27 , we can convert  @xmath35 into gradient of an area integral with respect to variations in its boundary .",
    "we can then invoke a powerful geometric principle , which states    _ the gradient of an integral with respect to variations of its boundary is equal to the gradient of the boundary with respect to these variations , multiplied by the integrand evaluated along the boundary . _    formally , this multiplication is the _ _ interior product _ _ of the boundary gradient with the integrand , [ eq : interiorproduct ] _ _ _ a(-d ) = _ ( _ ) ( -d ) , which contracts @xmath27 ( a _ differential two - form _",
    "@xcite ) along @xmath39 to produce a differential one - form that can be integrated over @xmath26 .",
    "this formalism will become important in future work when we explore these principles on systems with more than two shape variables ; for the two - dimensional shape spaces we consider in this paper , the interior product reduces to a simple multiplication between the outward component of @xmath39 and the scalar magnitude of the lie bracket , [ eq : boundarygradientsimple ] _ _ _ a(-d ) = _ ( _ _ ) ( -d ) .    _",
    "implementation of the internal pressure : _ each waypoint @xmath40 forms a triangle with its neighboring points , whose base defines a local tangent direction @xmath41 as _ i+1 - _",
    "i-1 = _ and a local normal direction @xmath42 orthogonal to @xmath41 . as illustrated in fig .",
    "[ fig : derivation ] , the gradient of the enclosed area with respect to variations in the position of @xmath40 in the  @xmath41 and  @xmath42 directions is the change in triangle s area as @xmath40 moves . because the triangle s area is always one half base times height ( regardless of its pitch or the ratio of its sidelengths )",
    ", this gradient evaluates to _ _",
    "i_a =    _ & _    0 + /2    .",
    "note that this term matches the right - hand side of  , with only normal motions of the boundary affecting the enclosed area .          the second term in   takes @xmath36 as a measure of how variations in the gait affect the cost of executing it , and scales this by a factor of @xmath43 to compare how the return on this investment compares to the efficiency of the gait in its present state .",
    "the gradient component of this term can be related to the system s riemannian metric by first incorporating the arclength calculation from  , _ = _ _ ( ^d^2)^ and then applying standard calculus operations to consolidate terms . ] to arrive at [ eq : surfacetensionfull ] _ = _ ( 2  d+ ( _ )  d ) , in which the two parts of the integrand respectively measure how changes in the relative positions of the boundary elements and changes in the metric at the underlying points affect the pathlength , and hence the cost of motion .",
    "the @xmath43 factor ( which normalizes the scales of @xmath35 and @xmath36 ) can be calculated directly from   and the integral of  .",
    "although the calculation of @xmath25 could in theory make use of the area approximation in  , this would be inefficient and impractical : integration of surfaces with arbitrarily complex boundaries requires significantly more computational resources than are needed for line integration around the boundary . using the true line integral",
    "also improves the accuracy of the solution ; by continuously recalibrating to the true net displacement , the algorithm avoids compounding any errors introduced by the approximation in  .    _",
    "implementation of the surface tension : _ each waypoint @xmath44 is at the head of a vector extending from @xmath45 , such that the @xmath46 vector and its gradient in   can be taken as d= _ i - _ i-1   _ _ id=    1 + 1    . for computational simplicity , we evaluate the metric at the center of each segment .",
    "this point moves at the mean speed of the segment endpoints , and its gradient with respect to changes in @xmath40 is thus one half of its gradient over the underlying space , _",
    "these gradient relationships are illustrated in fig .",
    "[ fig : derivation](b ) , with the metric represented by its tissot indicatrix ellipse  @xcite .      the third term in  , @xmath37 , is included to ensure an even sampling of points around the gait during numerical optimization .",
    "this term does not appear in   or   because it is orthogonal to those optimization criteria : varying a continuous curve along itself does not change its length or the region it encloses . when the curve is represented with a discrete basis , however , that basis induces a length coordinate  @xmath47 along the gait that is not necessarily compatible with the natural coordinate @xmath48 .",
    "this coordinate may lead to undersampling of some portions of the curve or pathological behavior , such as crossovers in which the gait spontaneously forms internal loops that do not correspond to features in @xmath27 .    to reduce the chance of such instabilities occurring ,",
    "we first identify an internal strain energy  @xmath49 that measures how much an even spacing according to  @xmath47 differs from even spacing according to  @xmath48 .",
    "this strain energy , [ eq : intstress ] = _ ( - _ ) ^2 , compares the average and local relative rates at which the two coordinates are changing around the curve ; if these rates are not matched , then the two measures of length are imbalanced . including the gradient term of this energy with respect to variations in the parameters , @xmath37 , then directs the optimizer to use its degrees of freedom that are ( instantaneously ) in the kernel of the primary optimization criteria to reduce the imbalance .",
    "the expansion of this term depends on the choice of parameters for the gait ( because they affect the construction of  @xmath47 ) , so we do not provide a general formula for it . in the case of direct transcription , however , it works out to be very straightforward .    _",
    "implementation of the concentration gradient : _ in a direct - transcription parameterization , the strain energy at a given waypoint corresponds to the difference in the tangential distance from that waypoint to each of its neighbors , _",
    "i = ( ( _ i+1-_i ) _ - ( _ i-_i-1)_)^2 , whose gradient with respect to the position of @xmath40 is proportional to the sum of the tangential displacements of the neighboring points relative to @xmath40 , _ _",
    "i    _ & _    ( _ i+1 ) _ + ( _ i-1 ) _ + 0    .",
    "we implemented the optimizer described in the previous section in matlab , both directly solving the differential equation in   using ` ode45 ` and by providing   as the gradient for the standard ` fmincon ` optimizer using the interior - point algorithm . as expected , both implementations converged on the same solutions , with the ` fmincon ` implementation completing more quickly ( on the order of minutes on a modern desktop computer for a gait with @xmath50 waypoints ) due to its ability to take larger steps through the parameter space .",
    "we ran the optimizer on the three link system twice , first to find the gait that maximizes the displacement in the @xmath0-direction over a single cycle and then to find the maximum - efficiency cycle .",
    "the dashed line in fig .",
    "[ fig : optimized gait](a ) shows the gait that optimizes the maximum displacement over the cycle for the three - link swimmer . as expected",
    ", this gait follows the zero - contour of the height function .",
    "the solid line fig .",
    "[ fig : optimized gait](a ) shows the maximum efficiency gait for this system .",
    "because the maximum - efficiency optimizer places a cost on pathlength , this curve gives up the low - yield regions at the ends of the cycle and crosses slightly outside the zero contour .",
    "[ fig : optimized gait](b ) illustrates essentially - similar behavior for the serpenoid : the dashed maximum - displacement gait traces the zero contour , and the solid maximum - efficiency gait captures a more compact area within the sign - definite region .",
    "[ fig : optimized gait](c ) shows the gait that produces the most cost - effective rotational motion of the three - link swimmer ( the most sign - definite area it could capture on the @xmath1 height function without over - stretching itself ) .",
    "the results the optimizer yields for the three link swimmer match those obtained for maximum efficiency in  @xcite and , along the @xmath0 direction , those in  @xcite .",
    "in this paper , we have incorporated recent geometric insights about optimal gaits for kinematic systems into a variational trajectory optimizer .",
    "the dynamics of this optimizer are analogous to those of a soap bubble , with the lie bracket providing an `` inflating pressure '' to the trajectory and the riemannian metric on the shape space contributing `` surface tension '' that halts growth of the cycle in the face of diminishing returns .",
    "together , these elements drive the gait cycle to a `` comfortable stride '' that converts shape change effort into net displacement with optimal efficiency .",
    "we demonstrated this optimizer in operation on a number of test cases , including purcell s three - link swimmer ( a standard minimal template for locomotion modeling ) and a serpenoid swimmer ( a model widely used in studies of animals and snake robots ) .",
    "the optimizer correctly found the maximum - displacement and maximum efficiency cycles for these systems , as corroborated by previous exhaustive optimizations of the gait cycles such as  @xcite .",
    "a line of future work that we are pursuing is to extend this optimizer to systems whose dynamics are dominated by inertial effects , including those subject to conservation of momentum whose momentum is directed by nonholonomic constraints .",
    "the cost of a gait for these types of systems depends on the acceleration through the configuration shape during the gait rather than on the energy dissipated into the environment .",
    "therefore we expect that a cost associated with the gait s curvature through the shape space ( as well as its length ) will play an important role in finding the optimal gait for these systems .",
    "k.  a. morgansen , b.  i. triplett , and d.  j. klein , `` geometric methods for modeling and control of free - swimming fin - actuated underwater vehicles , '' _ ieee transactions on robotics _ , vol .",
    "23 , no .  6 , pp .",
    "11841199 , jan 2007 .",
    "[ online ] .",
    "available : http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=4399955        e.  a. shammas , h.  choset , and a.  a. rizzi , `` geometric motion planning analysis for two classes of underactuated mechanical systems , '' _ int .",
    "j. of robotics research _ , vol .",
    "26 , no .",
    "10 , pp . 10431073 , 2007 .",
    "j.  b. melli , c.  w. rowley , and d.  s. rufat , `` motion planning for an articulated body in a perfect planar fluid , '' _ siam journal of applied dynamical systems _ ,",
    "vol .  5 , no .  4 , pp . 650669 , november 2006 .",
    "j.  e. radford and j.  w. burdick , `` local motion planning for nonholonomic control systems evolving on principal bundles , '' in _ proceedings of the international symposium on mathematical theory of networks and systems _ ,",
    "padova , italy , 1998 .",
    " , `` geometric motion planning : the local connection , stokes theorem , and the importance of coordinate choice , '' _ international journal of robotics research _ , vol .  30 , no .  8 , pp .",
    "9881014 , july 2011 .",
    "r.  l. hatton , l.  j. burton , a.  e. hosoi , and h.  choset , `` geometric maneuverability , with applications to low reynolds number swimming , '' in _ proceedings of the ieee / rsj international conference on intelligent robots and systems _ , san francisco , ca usa , september 2011 .",
    "r.  l. hatton and h.  choset , `` connection vector fields and optimized coordinates for swimming systems at low and high reynolds numbers , '' in _ proceedings of the asme dynamic systems and controls conference ( dscc ) _ , cambridge , massachusetts , usa , sep 2010 .",
    "p.  bettiol , b.  bonnard , l.  giraldi , p.  martinon , and j.  rouot , `` the purcell three - link swimmer : some geometric and numerical aspects related to periodic optimal controls , '' oct .",
    "2015 , working paper or preprint .",
    "[ online ] .",
    "available : https://hal.inria.fr/hal-01143763    l.  giraldi , p.  martinon , and m.  zoppello , `` controllability and optimal strokes for n - link microswimmer , '' in _ decision and control ( cdc ) , 2013 ieee 52nd annual conference on _ , dec 2013 , pp . 38703875 .",
    "a.  e. bryson and y .- c",
    ". ho , _ applied optimal control , optimization , estimation , and control_.1em plus 0.5em minus 0.4emnew york - london - sydney - toronto : john wiley & sons , 1975 .",
    "[ online ] .",
    "available : http://dx.doi.org/10.1002/zamm.19790590826"
  ],
  "abstract_text": [
    "<S> in this paper , we present a geometric variational algorithm for optimizing the gaits of kinematic locomoting systems . </S>",
    "<S> the dynamics of this algorithm are analogous to the physics of a soap bubble , with the system s lie bracket supplying an `` inflation pressure '' that is balanced by a `` surface tension '' term derived from a riemannian metric on the system s shape space . </S>",
    "<S> we demonstrate this optimizer on a variety of system geometries ( including purcell s swimmer ) and for optimization criteria that include maximizing displacement and efficiency of motion for both translation and turning motions . </S>"
  ]
}