{
  "article_text": [
    "although probabilistic ideas are at the heart of genetics , and have been used since the earliest days of the subject , it was in the study of genetic drift in the 1920s and 1930s that the notion of stochastic processes first played a major part in the theory of genetics . in the simplest case , a diploid population of a fixed size , @xmath0 , was considered , and attention was focused on two alleles at a particular locus . if selective differences between the two alleles , as well as the chances of mutation , are ignored , then the changes in the allele frequencies are purely due to genetic drift . assuming discrete non - overlapping generations",
    ", one can ask : what is the probability that @xmath1 of the @xmath2 genes in the population alive at time @xmath3 are of a given type ?",
    "this formulation of genetic drift is usually referred to as the fisher - wright model , being used implicitly by fisher  @xcite , and explicitly by wright  @xcite .",
    "although fisher and wright did not use this terminology , the stochastic process they defined through this model is a markov chain , since the probabilities of genetic change from one generation to the next do not depend on the changes made in previous generations .",
    "however the use of markov chains becomes cumbersome when the effects of mutation and selection are introduced , and for this reason there was a move away from the description of the process in terms of a discrete number of alleles @xmath4 , and discrete generations , to a process of diffusion where the fraction of alleles of one type is a real random variable @xmath5 in the interval @xmath6 $ ] and time is continuous .",
    "this type of model actually predates the markov chain description  @xcite , and was further studied by wright  @xcite and kimura  @xcite .",
    "it is this formulation that will concern us here , specifically we will be interested in neutral evolution ",
    "that is , the dynamics of a randomly mating population which may , or may not , be subject to genetic mutation .",
    "our motivation for the work presented here lies in the study of an evolutionary model of language change  @xcite . as a first step in the mathematical formulation of this model",
    ", we developed a `` drift model '' of language change @xcite , which turns out to be identical to the diffusion models of population genetics discussed above .",
    "particularly relevant in this application to language change is the situation where the number of variants ( the linguistic counterpart to alleles ) may be large .",
    "a survey of the population genetics literature revealed a considerable amount of work on the diffusion equation for two alleles  @xcite , some on three alleles  @xcite and very little on the general case of an arbitrary number of alleles  @xcite .",
    "much of the work originated with kimura in the 1950s , and developments since then appear scattered throughout the literature .    in this work",
    "we fill a considerable gap in the literature by giving for the first time an analytic solution of the diffusion equation , with and without mutation , in the general case of @xmath7 alleles .",
    "given the rather scattered nature and  occasionally  the apparent obscurity of other results relating to genetic diffusion at a single locus , we take the opportunity here to present them in a systematic fashion . in writing this paper",
    "we also have a third aim , namely to present this information in such a way that is accessible to geneticists who may not wish to work through a great deal of mathematical analysis .",
    "we will shortly describe the plan of the paper which we hope will allow us to accomplish this .",
    "after kimura s pioneering work in the 1950s , there was further work by him @xcite and others @xcite on single - locus models , but interest naturally moved to models which involved multiple loci and the interactions between them @xcite . despite the continuing development of population genetics , very little has been achieved by way of exact solutions for single - locus models since kimura @xcite and littler @xcite .",
    "occasional work has appeared , both of an analytic nature @xcite and involving numerical simulations @xcite , although single locus diffusion models continue to receive proportionately less attention .",
    "a number of other factors have been responsible for the relative neglect of this particular area of population genetics .",
    "one of the main ones is that the focus has shifted to experimental investigations and there has been the consequential realisation that reality is very much more complex than what simple models allow . however , it is also the case that the theory is perceived as mathematically difficult .",
    "even kimura  @xcite states when studying the extension to three alleles that for the partial differential equation describing diffusion `` the general case of an arbitrary number of alleles can be solved [ by separation of variables ] .",
    "however , additional techniques will be needed to make the mathematical manipulations manageable '' .",
    "we will show here that this is not the case : in fact it is no harder to solve the case of the diffusion of a general number of alleles than the three - allele case .",
    "we believe that , while our motivation for this work originates with models of language change , geneticists will also find the results we obtain useful .",
    "the diffusion theory is described in several standard texts on population genetics  @xcite and general consequences of the results previously found in the form of simple rules are widely known and utilised .",
    "the problem , as we have already indicated , is the mathematical nature of the theory .",
    "the diffusion approximation in the case without mutation results in a partial differential equation which is of the type which is used to describe the diffusion of heat in a metal or dye in a fluid  @xcite .",
    "the inclusion of mutation corresponds in these physical problems to a deterministic force which biases the diffusion in one direction rather than another .",
    "for example , if the particles diffusing were charged , then this deterministic force could arise from an electric field being imposed on the system .",
    "not surprisingly , diffusion equations of this kind have been extensively studied by physicists who call them fokker - planck equations  @xcite . here",
    "we will use the nomenclature used in the genetics literature where they are called kolmogorov equations .",
    "there are other confusing changes in nomenclature across disciplines : for example , the term representing the deterministic motion discussed above in the kolmogorov equation is called the drift in the physics literature , but in the genetics literature it is the diffusive term which is called the drift . in order to avoid confusion we shall now drop the further use of the term `` drift '' in this work .    the outline of the paper is as follows . in section [ overview ]",
    "we will give on overview of our results which is devoid of proofs and too much mathematical detail , so that it may be read by those who simply wish to have a reasonably non - technical summary of the results of the paper .",
    "it will also serve as a general introduction to those who wish to go on and absorb the more technical sections of the paper .",
    "these technical sections start with section [ soln ] , where the general solution of the kolmogorov equation for an arbitrary number of alleles , with and without mutations , is derived . in section",
    "[ other ] we give details of the calculation of various quantities of interest that are given briefly at the end of section [ overview ] .",
    "we end in section [ discuss ] with an overview of the paper s main results and point out some remaining unsolved cases .",
    "further technical material has been relegated to three appendices so as not to interrupt the flow of the arguments in the main text .",
    "in this section we will describe the problems we investigate , explaining our methods of analysing them and give the results we have obtained without proof .",
    "the simplest , and most widely studied , version of the problems we will be investigating in this paper , is where two alleles , @xmath8 and @xmath9 , are segregating in a randomly - mating population of @xmath0 monoecious individuals .",
    "we begin with the purely random case in which the only way that allele frequencies may change is through the random sampling of gametes in the reproductive process .",
    "if @xmath10 is the frequency of allele @xmath8 and @xmath11 the frequency of allele @xmath9 , we would expect that the value of @xmath10 would change through time until eventually one or other of the alleles would become fixed , _",
    "i.e. _ @xmath10 would take on the value 0 or 1 . the mathematical quantity which describes the process is the conditional probability distribution function ( pdf ) @xmath12the probability that the frequency of the @xmath8 allele at time @xmath3 is @xmath10 , given the frequency of this allele at @xmath13 was @xmath14 .",
    "it satisfies the kolmogorov equation  @xcite @xmath15 \\ , , \\ \\ \\",
    "d(x ) = \\frac{1}{2 } x(1-x)\\ , , \\label{kol_2}\\ ] ] in the interval @xmath16 .",
    "this is a diffusion equation for the frequency of the @xmath8 allele , but with a diffusion coefficient , @xmath17 , which depends on the frequency .",
    "the form of the diffusion coefficient is such that it gets much weaker as @xmath10 approaches the boundaries at @xmath18 and @xmath19 .",
    "however  as we show using a simple argument in appendix  a  it is still sufficiently strong that fixation can occur , but once this has happened there is no possibility of re - entering the region @xmath16 .",
    "( in feller s classification @xcite , these are exit boundaries ) .",
    "as we shall see , it will be necessary to consider the boundaries separately from the interior region when calculating probabilities .",
    "it should also be noted that in the derivation of eq .",
    "( [ kol_2 ] ) ( see section [ soln ] ) , one unit of time is taken to be @xmath2 generations , so that the time between generations is @xmath20 .",
    "although this choice is useful in derivations involving the diffusion approximation , it is frequently more useful to work with @xmath21 , so that the unit of time is that between generations",
    ". then eq .",
    "( [ kol_2 ] ) takes the form @xmath22 \\ , , \\label{tau_form}\\ ] ] which is the one that generally appears in textbooks @xcite .",
    "when @xmath7 alleles @xmath23 are present , these ideas can be generalised .",
    "if @xmath24 are the frequencies of the alleles , then there are only @xmath25 independent variables  the frequency @xmath26 may be replaced by @xmath27 .",
    "the kolmogorov equation is now an @xmath28-dimensional diffusion equation  @xcite @xmath29 \\ , , \\label{kol_m}\\ ] ] where the diffusion coefficient is now a matrix : @xmath30    if mutations occurring at constant rates are allowed for , these kolmogorov equations acquire an extra term , which involves only first order derivatives . in the case of two alleles ,",
    "if @xmath9 mutates to @xmath8 at a constant rate given by @xmath31 and @xmath8 mutates to @xmath9 at a constant rate given by @xmath32 , then in the absence of the random process described above , we would expect the frequency of the @xmath8 allele to change according to the _ deterministic _ differential equation @xmath33 , where @xmath34 .",
    "if we include both this deterministic process and the random diffusion process , the kolmogorov equation takes the form  @xcite : @xmath35 + \\frac{\\partial^{2 } } { \\partial x^{2 } } \\left [ d(x ) p \\right]\\ , , \\label{kol_2_mut}\\ ] ] where @xmath36    finally , if @xmath7 alleles are present with mutation , we shall in common with other authors @xcite , only study the situation in which the rate of mutation of the alleles @xmath37 to @xmath38 occurs at a constant rate @xmath39 , independent of @xmath40 .",
    "then the deterministic equation would be @xmath41 the fact that @xmath42 depends only on @xmath43 is a consequence of mutation rates depending only on the end product of the mutation .",
    "it is this feature that allows solution by separation of variables of the resulting kolmogorov equation which reads @xmath44 + \\sum^{m-1}_{i=1 } \\sum^{m-1}_{j=1 } \\frac{\\partial^{2 } } { \\partial x_{i } \\partial x_{j } }   \\left [ d_{ij}({\\underline}{x } ) p \\right ] \\",
    ", , \\label{kol_m_mut}\\ ] ] where @xmath45 and @xmath46 are given by eqs .",
    "( [ a_m ] ) and ( [ diff_m ] ) respectively .",
    "it is sometimes useful to use the backward form of the kolmogorov equation , in which the derivatives are with respect to the initial values @xmath14 and @xmath47 : @xmath48 since for the processes we will be interested in here , @xmath49 will be a function only of @xmath50 , the left - hand side may also be written as @xmath51 , and @xmath47 chosen to be equal to zero . a detailed derivation and explanation of the relationship between the forward and backward forms can be found in @xcite .",
    "note that immigration is commonly introduced @xcite by the use of @xmath52 where @xmath53 represents the mean of the population where the immigrants come from .",
    "this situation can be represented by eq .",
    "( [ kol_2_mut ] ) simply by setting @xmath54 and @xmath55 .",
    "when one or more of the mutation parameters is zero , we have irreversible mutation , when the final result is fixation to those alleles which have @xmath39 not equal to zero .",
    "we will not consider this special case here , but see for example @xcite .    in purely mathematical terms",
    ", the purpose of this paper is to obtain the conditional pdf @xmath56 obtained by solving eqs .",
    "( [ kol_m ] ) and ( [ kol_m_mut ] ) , subject to the initial conditions that @xmath57 at @xmath13 and the appropriate boundary conditions .",
    "as far as we are aware , only the cases @xmath58 without mutation and @xmath59 with mutation have been solved to date  @xcite .",
    "the key to making progress is to find a change of variable which makes these equations separable and also to note that the solution with @xmath1 alleles is nested within the solution with @xmath60 alleles , so many properties follow by induction on @xmath1 .      while the @xmath59 kolmogorov equations ( [ kol_2 ] ) and ( [ kol_2_mut ] ) can be solved by separation of variables  writing @xmath61their counterparts for general @xmath7 , eqs .",
    "( [ kol_m ] ) and ( [ kol_m_mut ] ) can not .",
    "the standard way to proceed in such a situation is to look for a transformation to a coordinate system in which these partial differential equations are separable .",
    "kimura  @xcite gave such a transformation for values of @xmath7 up to 4 without mutation , but not in general .",
    "there is no systematic way to discover such transformations , but we have found one which works for all @xmath7 , namely : @xmath62 with the inverse transformation @xmath63 as discussed in section [ soln ] , this change of variables means that the most general form of the kolmogorov equation we consider , eq .",
    "( [ kol_m_mut ] ) , may be written in diagonal form : @xmath64 + \\sum^{m-1}_{i=1}\\frac{\\partial^{2 } } { \\partial u_{i}^{2 } }   \\left [ \\mathcal{d}_{i}({\\underline}{u } ) \\mathcal{p } \\right ] \\",
    ", , \\label{kol_m_u}\\ ] ] that is , there are no mixed second - order derivatives . for completeness",
    "we give the expressions for the functions @xmath65 and @xmath66 : @xmath67 note that this equation has been derived using the new variables  just changing variables using ( [ cofv ] ) in the original kolmogorov equation ( [ kol_m_mut ] ) will not give ( [ kol_m_u ] ) , but will instead simply give an equation for @xmath56 with @xmath43 replaced by @xmath68 .",
    "the new conditional pdf in ( [ kol_m_u ] ) , denoted by @xmath69 , is related to @xmath56 through the jacobian of the transformation to the new variables : @xmath70 the jacobian is calculated in appendix b. when @xmath71 it is simply @xmath72 , so that @xmath73 and in the general case one finds that @xmath74    we may summarise this subsection in the following way . we have given a change of variables which allows the kolmogorov equation to be written in a form which is separable .",
    "it is easier to work with the conditional pdf appropriate to these variables , and then to transform back to the original variables of the problem and the original conditional pdf using eqs .",
    "( [ cofv ] ) and ( [ trans_prob_m ] ) respectively .",
    "the details of the solution of the kolmogorov equation ( [ kol_m_u ] ) are given in section 3 and appendix c. here we will present only the final expressions .",
    "for orientation , let us first give the expression in the case @xmath59 and where no mutation is present .",
    "this is well known and appears in the standard texts  @xcite . in this case",
    "no change of variable is required : @xmath75 .",
    "then @xmath76 the constant @xmath77 is given by @xmath78/(l+1)$ ] and the @xmath79 are polynomials , described below .",
    "the function ( [ soln_2 ] ) satisfies both the initial and boundary conditions and holds for all @xmath10 in the interval @xmath80 , that is , excluding the boundaries at @xmath18 and @xmath19 . for not too small values of @xmath3 ,",
    "the solution is well approximated by keeping only the first few terms in @xmath81 . in these cases",
    "the polynomials have a simple form , since @xmath82 is a polynomial in @xmath83 of order @xmath81 .",
    "for instance , @xmath84 the natural variable for these polynomials is @xmath85 , so that they are defined on the interval @xmath86 . for general @xmath81",
    "they are the jacobi polynomials @xmath87  @xcite .",
    "we plot the time development of the solution ( [ soln_2 ] ) in fig .",
    "[ neut_2a ] . beginning from a delta function at the initial point ,",
    "the distribution initially spreads out until the boundaries are reached .",
    "the distribution is soon nearly flat , and subsides slowly as probability escapes to the boundaries .",
    "note that the probability deposited on the boundaries is not shown here ( but will be discussed later ) .",
    "time evolution of the pdf for a biallelic system as determined from the analytic solution with no mutation and initial condition @xmath88 . ]    for general @xmath7 , the solution may be written in the form @xmath89 as discussed in section [ soln ] . the solution is written in terms of the @xmath90 variables since the problem is separable and so the eigenfunctions are separable . the function @xmath91 is given by @xmath92 and @xmath93 depends on a set of @xmath25 non - negative integers @xmath94 according to @xmath95 this means that the sum over @xmath93 in eq .",
    "( [ soln_m_first ] ) is in fact an @xmath96dimensional sum .",
    "the property , which we have already remarked upon , that the system with @xmath25 alleles is nested in that with @xmath7 , manifests itself here in the fact that the functions @xmath97 are very closely related to the functions which already appear in the two allele solution ( [ soln_2 ] ) .",
    "first of all , since the problem is separable in this coordinate system , they may be written as @xmath98 each of the factors @xmath99 in this product separately satisfies the same differential equation .",
    "we shall derive this equation in section  [ soln ] , from which we will learn that @xmath99 depends only on @xmath100 and on the integers @xmath101 and @xmath102 .",
    "specifically , @xmath103^{1/2 }   \\left ( 1 - u_{i } \\right)^{l_{i-1 } } p^{(1,2l_{i-1}+1)}_{l_i } ( 1 - 2u_i)\\ , .",
    "\\label{soln_m_third}\\ ] ] here the @xmath104 are the analogue of the @xmath77 that appeared in eq .",
    "( [ soln_2 ] ) , but in this case we have included them in the function @xmath97 , so that it satisfies the simple orthogonality relation @xmath105 the explicit form of these constants is @xmath106 the @xmath107 , now with @xmath108 , are again jacobi polynomials  @xcite .",
    "the general solution for @xmath109 has previously only been found for the case @xmath71 .",
    "we have checked that our solution agrees with the published result  @xcite in this case , although the labels on the alleles are permuted between kimura s solution and ours ( @xmath110 ) due to a different change of variable being made .",
    "we plot this solution for a triallelic system in fig .",
    "[ neut_3a ] at several different times . just as in the two allele system ,",
    "the distribution initially spreads out and forms a bell shape , which quickly collapses , and becomes nearly flat , then subsides slowly as probability escapes to the boundaries .",
    "note that the probability deposited on the boundaries is not shown here .",
    "notice also the triangular shape of the region over which the distribution is supported .",
    "time evolution of the pdf for a triallelic system as determined from the analytic solution with no mutation and initial condition @xmath111 . ]    when mutation is present , the solution is again well known  @xcite for the @xmath59 case .",
    "again , no change of variable is required : @xmath75 . then @xmath112 the constant @xmath77 is given by @xmath113 while @xmath114 , @xmath115 and the parameter @xmath116 .",
    "the @xmath117 are jacobi polynomials  @xcite .",
    "unlike the case without mutations , @xmath118 , and they can not be written in terms of simpler polynomials as in case ( i ) .",
    "the function ( [ soln_2_m ] ) satisfies both the initial and boundary conditions and holds for all @xmath10 in the interval @xmath6 $ ] , that is , now including the boundaries at @xmath18 and @xmath19 .",
    "this difference is due to the nature of the boundary conditions in the mutation case , which will be described in detail in section 3 .    for not too small values of @xmath3 ,",
    "the solution is well approximated by keeping only the first few terms in @xmath81 . in these cases",
    "the polynomials do have a relatively simple form , since @xmath119 is a polynomial in @xmath83 of order @xmath81 . for instance , @xmath120\\ , , \\ldots \\ , .",
    "\\label{low_order_2_m}\\ ] ] also note that once again the natural variable for these polynomials is @xmath85 , so that they are defined on the interval @xmath121 . in terms of the allele @xmath8 frequency @xmath10 and",
    "the mutation rates @xmath31 and @xmath32 , these polynomials take the form @xmath122\\ , , \\ldots \\ , .",
    "\\label{low_order_2_mx}\\ ] ]    for concreteness , we plot in figs .  [ mut_2a ] and [ mut_2b ] the time evolution pdfs for biallelic ( @xmath59 ) systems from a fixed initial condition of @xmath88 , i.e. , that 70% of the population have one particular allele type . in the former case ,",
    "the mutation rates are low ( @xmath123 ) and one finds a high probability of one allele dominating the population .",
    "conversely , in fig .  [ mut_2b ] which has higher mutation rates @xmath124 ,",
    "the most probable outcome is for both alleles to coexist in the population , as indicated by the peak of the distribution occurring for some value of @xmath10 far from either boundary . in each of the figures , we compare the distribution obtained from a monte carlo simulation of the population dynamics against the analytic result ( [ soln_2_m ] ) with good agreement .",
    "time evolution of the pdf for a biallelic system as determined from the analytic solution ( left ) and monte carlo simulation ( right ) with mutation parameters @xmath123 and initial condition @xmath88.,title=\"fig : \" ]   time evolution of the pdf for a biallelic system as determined from the analytic solution ( left ) and monte carlo simulation ( right ) with mutation parameters @xmath123 and initial condition @xmath88.,title=\"fig : \" ]     time evolution of the pdf for a biallelic systems as determined from the analytic solution ( left ) and monte carlo simulation ( right ) with mutation parameters @xmath124 and initial condition @xmath88.,title=\"fig : \" ]   time evolution of the pdf for a biallelic systems as determined from the analytic solution ( left ) and monte carlo simulation ( right ) with mutation parameters @xmath124 and initial condition @xmath88.,title=\"fig : \" ]    for general @xmath7 , the solution may be written in the form @xmath125 as discussed in section [ soln ] . here",
    "@xmath126 is the left - eigenfunction of the kolmogorov equation ( @xmath127 being the right - eigenfunction , as usual ) .",
    "again , @xmath93 depends on a set of @xmath25 non - negative integers @xmath94 , with @xmath128 the left - eigenfunction @xmath129 is equal to @xmath130  @xcite , where @xmath131 is the stationary pdf .",
    "this is equivalent to the form ( [ soln_m_first ] ) , appropriate when there are no mutations , since @xmath132 is what is there called the weight function ( up to normalisation ) . since the problem is separable in this coordinate system , @xmath133",
    "may again be written as @xmath134 once again each of the factors @xmath99 is separately a solution of a single differential equation , and depends on @xmath100 , the integers @xmath135 and @xmath136 and the mutation rates @xmath39 .",
    "specifically , @xmath137 where @xmath138    in a similar way , @xmath139 may be written as @xmath140 each @xmath141 depends on @xmath100 and on the integer @xmath136 and the mutation constants @xmath142 and @xmath39 . specifically , @xmath143 where @xmath144 the general solution has previously only been found for the case @xmath59 .",
    "our solution agrees with the published result  @xcite in this case .      we can calculate the time evolution of various statistics of the population . as previously , we present here a summary of the results for ease of reference , deferring detailed calculations to section  [ other ] .      in the absence of mutation",
    ", alleles can become extinct since , once they have vanished from the population , there is no mechanism by which they can be replaced .",
    "as we have already mentioned , the solution we have derived ( [ soln_m_first ] ) gives the pdf for all states in the interior .",
    "the pdf on a boundary is also given by this equation , so long as this boundary is not the point of fixation of the final allele , since it corresponds to the solution with @xmath7 reduced by 1 .",
    "so , for example , one can read off the pdf in , say , the two - dimensional subspace where alleles @xmath8 and @xmath9 coexist and all others present in the initial population have become extinct since it is just the @xmath59 solution .",
    "kimura @xcite finds the large - time form for this quantity given an initial condition comprising @xmath71 alleles using an approach involving moments of the distribution which , as we shall show below , can be found directly from the kolmogorov equation without recourse to the full solution we have obtained here .",
    "it remains then to determine the fixation probabilities that are excluded from the pdf we have derived . using a simple argument ( outlined below )",
    "one can find the probability that a particular allele has fixed by time @xmath3 by reduction to an equivalent two - allele description , the properties of which are well - known @xcite .",
    "using the backward kolmogorov equation ( [ bke ] ) , one can find further quantities relating to extinction events .",
    "although some of the formul  we quote have appeared in the literature before @xcite they seem not to be widely known and some were stated without proof .",
    "we therefore feel there is some value in reviving them here and giving what is hopefully a clear derivation in this section or in section [ other ] .",
    "define @xmath145 as the probability that allele @xmath8 , which had initial frequency @xmath14 in a two allele system , has become fixed by time @xmath3 .",
    "this is given by @xcite @xmath146 e^{- ( l+1)(l+2 ) t /2 } \\,.\\ ] ] here @xmath147 is a legendre polynomial which is a particular case of the jacobi polynomials : @xmath148 .",
    "conversely , the probability that @xmath8 has become extinct by time @xmath3 is equal to that of @xmath9 become fixed , viz , @xmath149 e^{-(l+1)(l+2)t/2 } \\;.\\ ] ]    now , consider an initial condition with @xmath109 alleles , divided into two groups @xmath150 and @xmath151 .",
    "let now @xmath10 be the sum of the frequencies of @xmath150 alleles .",
    "we may think of the set of alleles @xmath150 as a single allele in a two allele system ( for instance , @xmath8 in the above discussion ) and the set @xmath151 as the other allele .",
    "then the probability that _ all _ of the @xmath151 alleles ( and possibly some of the @xmath150 alleles ) have become extinct by time @xmath3 is simply @xmath145 where @xmath14 is the initial combined frequency of @xmath150 alleles .",
    "similarly , the probability that all of the @xmath150 alleles are extinct at time @xmath3 , leaving some combination of @xmath151 alleles is @xmath152 .",
    "arguments of this kind , where a set of alleles is identified with a single allele in the @xmath59 problem , can be frequently employed to obtain results for the general case of @xmath7 alleles in terms of those already explicitly calculated for @xmath59 .    by combining the above reduction to an equivalent two - allele problem with combinatorial arguments , the probability that exactly",
    "@xmath153 alleles coexist at time @xmath3 can be calculated @xcite .",
    "the result is @xmath154 where @xmath153 can take any value from @xmath155 up to @xmath7 , and the second summation is over all subsets of size @xmath156 drawn from the @xmath7 alleles .",
    "it is a simple matter to use this formula to calculate the mean number of coexisting alleles at time @xmath3 .    in fig .",
    "[ r_alleles ] , we compare the time - dependent probabilities for @xmath157 alleles to be present in a system initially comprising @xmath158 alleles given by the exact formula ( [ prob_exactly_r ] ) and as obtained from a monte - carlo simulation with the allele frequencies initially equal .",
    "we also show the evolution of the mean number of coexisting alleles from starts with @xmath71 and @xmath158 alleles . in both cases ,",
    "the exact formul  correspond extremely well with the simulations , illustrating the utility of the diffusion approximation to the discrete population dynamics .",
    "alleles are present as a function of time for @xmath159 in a system with 4 alleles initially . expected number of alleles present as a function of time for systems with 3 and 4 alleles initially present ( right ) .",
    "symbols are monte carlo simulation data , solid curves are analytic calculations.,title=\"fig : \" ]   alleles are present as a function of time for @xmath159 in a system with 4 alleles initially .",
    "expected number of alleles present as a function of time for systems with 3 and 4 alleles initially present ( right ) .",
    "symbols are monte carlo simulation data , solid curves are analytic calculations.,title=\"fig : \" ]    [ num_alleles ]    by solving the appropriate backward kolmogorov equation , one can straightforwardly find the mean time to the first ( and only ) extinction event among two alleles to be @xmath160\\,.\\ ] ] a combinatorial analysis , performed in @xcite and which we will summarise in section  [ other2 ] , reveals the mean time to the @xmath161 extinction can be calculated from an @xmath59 result .",
    "one finds @xmath162 \\;,\\ ] ] where @xmath163 is the initial fraction of allele @xmath164 present in the system .",
    "the second sum is over all possible @xmath156-subsets @xmath165 of the @xmath7 alleles initially present in the population .",
    "not all extinction probabilities can be calculated by reduction to an equivalent a two - allele problem .",
    "a notable example is the probability that allele @xmath166 goes extinct first , followed by @xmath167 leaving only @xmath168 in the final population , since in this case we ask for _ all _ , rather than just _ some _ of a subset to be present in the population at a given time .",
    "this probability is given by @xmath169 in which @xmath170 is the initial frequency of allele @xmath171 in the population .",
    "this result appears in @xcite , albeit without an explicit derivation .",
    "we shall provide one in section  [ other2 ] .",
    "an immediate consequence of the previous result is the probability that a particular allele , @xmath171 is the _ first _ to become extinct , that is , at a time when all other alleles have a nonzero frequency .",
    "this is obtained by summing ( [ qp ] ) over all possible sequences of extinctions in which @xmath171 goes extinct first .",
    "for example , when the initial number of alleles @xmath71 , the probability that @xmath8 goes extinct first can be found by summing over the cases @xmath172 in ( [ qp ] ) .",
    "one finds @xmath173 where @xmath174 .",
    "this agrees with the result in @xcite . by a similar method",
    ", one could determine the probability for allele @xmath171 to be the _",
    "second _ to go extinct or any other quantity of this type .",
    "when mutations are absent , we see from ( [ f_1 ] ) that allele @xmath171 fixes with a probability equal to its initial frequency in the population . hence in this case",
    ", the stationary distribution @xmath175 is zero everywhere except at those points that correspond to fixation of a single allele .    on the other hand ,",
    "when all the mutation rates @xmath39 at which all alleles @xmath176 mutate to @xmath171 are nonzero , the stationary distribution is nonzero everywhere .",
    "furthermore , this distribution is reached from any initial condition and takes the well - known form @xcite @xmath177 where in keeping with the 2 allele case @xmath178 .",
    "recall that the frequency @xmath26 is implied through the normalisation @xmath179 .",
    "one way to calculate moments of the distribution is to integrate the exact solution we have obtained above .",
    "however , it is also possible to derive differential equations for the moments in terms of lower - order moments from the kolmogorov equation , a procedure that leads more quickly to simple , exact expressions for low - order moments .",
    "we quote some examples for general @xmath7 here , noting that previously results for @xmath59 and @xmath180 without mutations have previously appeared in @xcite and for @xmath59 with mutations in @xcite .",
    "it is also worth remarking that by calculating moments , kimura reconstructed the solution for the pdf for the case @xmath71 and no mutations @xcite .",
    "when mutations are absent , the mean of @xmath43 is conserved by the dynamics , i.e. , @xmath181 meanwhile , the variance changes with time as @xmath182 this result is clear , at least in the case @xmath59 .",
    "the delta - function initial condition has zero variance , and the stationary distribution comprises delta - functions at @xmath18 and @xmath19 with weights @xmath183 and @xmath14 respectively . for the latter one",
    "then has @xmath184 and so @xmath185 .",
    "the covariance , which does not appear in the two allele system is : @xmath186    crow and kimura @xcite give moments only for the biallelic case , and then in terms of hypergeometric functions .",
    "we provide simpler results in explicit form here , again for any @xmath7 .",
    "the mean frequency of any allele behaves as @xmath187 where @xmath188 the mean ( [ meanx_m ] ) exponentially approaches the fixed point of the deterministic motion . recalling that @xmath189",
    ", we see in eq .",
    "( [ kol_2_mut ] ) the function @xmath190 vanishes at the point @xmath191 .",
    "the variance is more complicated : @xmath192 as @xmath193 , this converges to the limit @xmath194     solid lines : time evolution of the mean ( left ) and variance ( right ) for a biallelic system for three different mutation parameter combinations , and with @xmath195 .",
    "dashed lines : evolution of mean and variance when mutation is absent .",
    ", title=\"fig : \" ]   solid lines : time evolution of the mean ( left ) and variance ( right ) for a biallelic system for three different mutation parameter combinations , and with @xmath195 . dashed lines : evolution of mean and variance when mutation is absent .",
    ", title=\"fig : \" ]    in fig .",
    "[ mean_var ] we show the mean and variance as a function of time in the biallelic case , for three different pairs of mutation parameters .",
    "the mean approaches the stationary distribution value exponentially , at a faster rate the larger the values of the mutation parameters .",
    "when @xmath196 , the variance rises asymptotically to the stationary limit , again faster when the mutation parameters are larger .",
    "notice that for small values of @xmath31 and @xmath32 , the final variance is close to that when no mutations occur , while the larger the mutation parameters become , the narrower the final distribution .",
    "when the parameters are unequal , the variance can reach a maximum value before descending slowly to the final limit .",
    "the time development of the heterozygosity with two alleles , for the case with no mutations ( dashed curve ) and for three different cases of mutation ( solid curves ) , @xmath195 in each case . ]",
    "the covariance ( with @xmath197 ) is @xmath198    as asserted by kimura @xcite , in the absence of mutation the heterozygosity decays as @xmath199 regardless of the initial number of alleles .",
    "the heterozygosity is the probability that two alleles chosen at random from the population will be different .",
    "when there are multiple alleles , this probability can be calculated from the first and second moments using @xmath200\\;.\\ ] ] when expressions for the various moments are substituted into this expression , it is found that , in the absence of mutations , the constant terms cancel , leaving only terms decaying as @xmath199 . therefore we have @xmath201 where we find @xmath202 .",
    "kimura derived this result from the expected change in @xmath203 with each generation .",
    "the calculation with mutation present , however , does not give such a simple result .",
    "the heterozygosity can also be found for any number of alleles when mutation is present . however , the form becomes increasingly complicated as @xmath7 increases .",
    "therefore we give as an example only the two allele result here : @xmath204 e^{-(2r+1)t } \\ , .",
    "\\label{h_mut}\\end{aligned}\\ ] ] this is plotted in fig .",
    "we see that the presence of mutation between the two alleles maintains the heterozygosity at a finite level .",
    "in this section we will derive the solution of the kolmogorov equation ( [ kol_m_u ] ) , which was given in section [ cond_pdf ] .",
    "in particular we will derive the differential equation that is satisfied by every single one of the factors @xmath205 that appear in the eigenfunction @xmath206 in eq .",
    "( [ soln_m_second ] ) which applies when no mutations occur .",
    "we shall also present the more general differential equation that must be solved to determine the corresponding factors in ( [ soln_m_second_m ] ) that give the eigenfunctions when mutations are present .",
    "the more technical points of the discussion are relegated to appendices b and c , in order to avoid interrupting the flow of the arguments .",
    "it is worthwhile to recall briefly the derivation of the kolmogorov equation itself , since it will turn out that the most efficient way of changing from the @xmath207 variables to the @xmath90 variables is go back to an early stage of this derivation .",
    "the starting point for the derivation is the chapman - kolmogorov equation which is one of the defining equations for markov processes : @xmath208 if we take @xmath209 and expand @xmath210 in powers of @xmath211 , we find  in the limit @xmath212the kramers - moyal expansion for @xmath56  @xcite : @xmath213 here the @xmath214 are the jump moments defined through the relation @xmath215 the angle brackets are averages over realisations of the process @xmath216 ; @xmath216 is a stochastic process , whereas @xmath217 and @xmath207 are simply the initial and final states .",
    "so far very little has been assumed other than the markov property of the stochastic process .",
    "the markov nature of the process follows from the fact that the sampling of gametes from the gamete pool depends only on its current state , and not on its past history .",
    "if we assume that no deterministic forces are present , only the random mating process , then @xmath218 . if deterministic forces are present , then there will be an @xmath219 contribution to @xmath220 which is equal to @xmath221 . here",
    "@xmath222 is the rate of change of @xmath223 in the deterministic ( @xmath224 ) limit .",
    "the higher jump moments reflect the statistics of the sampling process . in the case of two alleles",
    "this is binomial and so the second jump moment is proportional to @xmath225 , which is the variance of this distribution . within the diffusion approximation , a unit of time",
    "is taken to be @xmath2 generations , so that the time between generations is @xmath226 .",
    "this implies that all jump moments higher than the second are higher order in @xmath227 .",
    "this gives the results ( [ kol_2_mut ] ) and ( [ aandd_2 ] ) .",
    "for the case of general @xmath7 , the multinomial distribution applies , which again means that the @xmath214 for @xmath228 vanish , and the second order jump moment is given by ( [ diff_m ] ) , up to a factor of @xmath229 .",
    "this is the briefest summary of the derivation of eq .",
    "( [ kol_m_mut ] ) .",
    "we refer the reader to @xcite for a fuller account . however , the above discussion is sufficient for our purposes , which is to note that the derivation involving eqs .",
    "( [ c - k_eqn])-([jm_defn ] ) may be carried out for any coordinate system , and specifically in the coordinate system @xmath230 for which the kolmogorov equation is separable . in this case the kramers - moyal expansion for @xmath69 is @xmath231 where @xmath232 are the jump moments in the new coordinate system : @xmath233 the most straightforward way of deriving the kolmogorov equation in the @xmath90 variables is to start from eq .",
    "( [ km_expansion_new ] ) and determine the @xmath232 by relating them to the known @xmath214 .",
    "this is carried out in appendix b and the result is the equations ( [ kol_m_u ] ) and ( [ cala_cald ] ) .",
    "the next step in the solution of the kolmogorov equation is to separate out the time and @xmath100 coordinates .",
    "that is , we write the general solution as a linear combination of such solutions : @xmath234 where the function @xmath127 satisfies @xmath235 \\right\\ }   \\phi_{\\lambda } ( { \\underline}{u } ) = - \\lambda \\phi_{\\lambda } ( { \\underline}{u } ) \\label{eigen_eqn}\\ ] ] and @xmath236",
    ". we may apply initial conditions directly on ( [ lin_comb ] ) : @xmath237 by assuming the orthogonality relation @xmath238 where @xmath91 is an appropriate weight function , we then have that @xmath239 and so @xmath240    to determine @xmath127 we have in principle to solve the partial differential equation ( [ eigen_eqn ] ) in @xmath241 variables .",
    "we will now prove that this equation is separable in the @xmath90 variables .",
    "for clarity we will start where mutation does not take place ( that is , omit the factor @xmath242 in ( [ eigen_eqn]))the argument goes through in an identical fashion when this term is present , as we will discuss later .",
    "when @xmath243 @xmath127 satisfies the equation @xmath244 = - \\lambda^{(1 ) }   \\phi_{\\lambda^{(1 ) } } ( u_1)\\ , , \\label{neutral_1}\\ ] ] where we have introduced the superscript @xmath245 on to the eigenvalue @xmath93 to identify it as belonging to the @xmath246 problem .",
    "this ordinary differential equation may be solved in a straightforward fashion as we discuss in the next subsection below .    when @xmath247 @xmath127 satisfies the equation @xmath248 & + & \\nonumber \\\\ \\frac{1}{2}\\,\\frac{1}{1-u_1}\\,\\frac{\\partial } { \\partial u^2_2 }   \\left [ u_{2}(1-u_2 ) \\phi_{\\lambda^{(2 ) } } ( u_1 , u_2 ) \\right ] & = &    - \\lambda^{(2 ) } \\phi_{\\lambda^{(2 ) } }",
    "( u_1 , u_2)\\ , .",
    "\\label{neutral_2}\\end{aligned}\\ ] ] we look for a separable solution of the form @xmath249 where @xmath250 = - \\lambda^{(1 ) }   \\phi_{\\lambda^{(1 ) } } ( u_2)\\,,\\ ] ] that is , @xmath251 satisfies the equation corresponding to the @xmath246 problem .",
    "it is straightforward to show that a separable solution exists if @xmath252 satisfies the equation @xmath253 = \\left\\ { - \\lambda^{(2 ) }   + \\frac{\\lambda^{(1)}}{(1-u_1 ) } \\right\\ } \\psi_{\\lambda^{(2)};\\lambda^{(1 ) } }   ( u_1)\\ , . \\label{psi_eqn_1}\\ ] ] we have introduced the subscript @xmath254 on @xmath252 to show that it depends on both the eigenvalues of the @xmath255 and the @xmath246 problems . as we will see , it is a remarkable fact that the solution of the problem with @xmath256 alleles only involves the function @xmath257 appearing in eq .  ( [ psi_eqn_1 ] ) .",
    "since @xmath258 may also be written as @xmath259 we may write the separable form of the solution in the @xmath255 case as @xmath260 we can now prove that the general case of @xmath256 alleles is separable as follows .",
    "we look for a solution of ( [ eigen_eqn ] ) of the form @xmath261 where @xmath262 is the solution of ( [ eigen_eqn ] ) with @xmath263 alleles , but with the replacements @xmath264 . by explicit substitution into ( [ eigen_eqn ] ) it is not difficult to demonstrate this , and to find that @xmath252 satisfies eq .",
    "( [ psi_eqn_1 ] ) , where now @xmath265 and @xmath266 are replaced by @xmath267 and @xmath268 respectively .",
    "therefore we have shown that @xmath269 this shows that if the @xmath263 allele problem is separable , then the @xmath1 allele problem is separable .",
    "but eq .  ( [ sep_soln_2 ] ) shows that the @xmath255 problem is separable , and so by induction the problem for general @xmath1 is separable .",
    "the explicit solution is @xmath270 where @xmath271 and where @xmath272 satisfies the equation @xmath273 = \\left\\ { - \\lambda   + \\frac{\\lambda'}{(1-u ) } \\right\\ } \\psi_{\\lambda;\\lambda ' } ( u)\\ , .",
    "\\label{psi_eqn}\\ ] ] thus we have finally shown that in order to obtain the eigenfunction @xmath274 it is necessary only to solve this _ single _ ordinary differential equation for general @xmath93 and @xmath275 .",
    "the full eigenfunction is then just a product of solutions of this equation .",
    "a similar equation arises from an analogous argument when mutation is included , that is , the factor @xmath242 is restored into eq .",
    "( [ eigen_eqn ] ) : all that is required is to make the substitution @xmath276   \\longrightarrow \\frac{1}{2 } \\frac{\\partial } { \\partial u_i }   \\left [ u_{i}(1-u_i ) \\right ] + \\left ( r_{i } u_{i } - m_{i } \\right)\\ ] ] in the above argument .",
    "the only difference is that now the function @xmath257 explicitly depends on @xmath277 because of the existence of the terms @xmath142 and @xmath39 .",
    "thus the results corresponding to eqs .",
    "( [ sep_soln_n ] ) and ( [ psi_eqn ] ) are : @xmath278 where @xmath279 satisfies the equation @xmath280 & + &   \\frac{1}{2 } \\frac{{{\\rm d}}^2}{{{\\rm d}}u^2_i } \\left [ u_i(1-u_i )   \\psi^{(i)}_{\\lambda;\\lambda ' } ( u_i ) \\right ] \\nonumber \\\\ & = & \\left\\ { - \\lambda + \\frac{\\lambda'}{(1-u_i ) } \\right\\ }   \\psi^{(i)}_{\\lambda;\\lambda ' } ( u_i)\\ , .",
    "\\label{psi_eqn_mut}\\end{aligned}\\ ] ] the rest of this section will be devoted to solving the ordinary differential equations ( [ psi_eqn ] ) and ( [ psi_eqn_mut ] ) subject to the boundary conditions of the problem .        to solve the ordinary differential equation ( [ psi_eqn_mut ] ) ( which includes the less general eq .",
    "( [ psi_eqn ] ) as a special case ) it is useful to cast it in a standard form . to this end",
    ", we introduce the function @xmath281 by writing @xmath282 where @xmath283 is a constant which is to be appropriately chosen shortly . substituting eq .",
    "( [ f_defn ] ) into eq .",
    "( [ psi_eqn_mut ] ) one finds ( dropping the subscripts and superscripts on @xmath284 ) @xmath285 f ' \\\\ + \\left [ 2\\lambda - ( \\gamma_{i}+1)(\\gamma_{i}+2 ) +   2r_{i}(\\gamma_{i}+1 ) \\right ] f   \\\\ = \\frac{\\left[2\\lambda ' - \\gamma_{i}(\\gamma_{i } + 1 ) -   2\\gamma_{i}(m_{i}-r_{i})\\right]}{1-u_{i}}\\,f\\ , .",
    "\\label{f_eqn}\\end{gathered}\\ ] ] we will choose @xmath283 so that the term involving @xmath286 in the denominator vanishes , that is , we ask that @xmath287 this is a quadratic equation for @xmath283 , but it is simple to see that if @xmath283 is one solution , the second one is simply @xmath288 .",
    "it will turn out that either choice leads to the same form for @xmath279 .    if we choose @xmath283 to satisfy eq .",
    "( [ gammai_choice ] ) , then eq .  ( [ f_eqn ] ) has the form @xmath289 f ' - ab f = 0\\ , , \\label{hypergeo}\\ ] ] where @xmath290 the solution of the equation has now been reduced to a standard form , since eq .",
    "( [ hypergeo ] ) is the hypergeometric equation  @xcite , whose solutions are hypergeometric functions @xmath291 .",
    "the details of the analysis of this equation are given in appendix c ; here we only describe the general features and specific form of the solution , without going into their derivation .",
    "that is , we find the constants @xmath283 and @xmath93 . in the following discussion it is convenient to treat the cases where mutations do and do not occur separately .",
    "we begin with the situation where mutations are absent , and so the pdf is found by solving eq .",
    "( [ hypergeo ] ) , but where now @xmath292 the @xmath283 are chosen so that @xmath293 .",
    "we begin the discussion , for orientation , by assuming that only two alleles are present .",
    "this amounts to solving eq .",
    "( [ neutral_1 ] ) or eq .",
    "( [ psi_eqn ] ) with @xmath294 , and the solution is therefore the function @xmath295 .",
    "this function also appears in the solution for arbitrary @xmath7 , given by eq .",
    "( [ sep_soln_n ] ) , and so this result is also required in the general case .    since in this simple case of two alleles @xmath296 , it follows that @xmath297 or @xmath298 . as discussed in appendix c ,",
    "either choice gives the same solution , and we therefore take @xmath297 . we have now only to solve the second order ordinary differential equation ( [ hypergeo ] ) subject to boundary conditions at @xmath299 and @xmath300 . as is familiar in such problems @xcite , the general solution is first expressed as a linear combination of two independent solutions .",
    "one of these is ruled out by one of the boundary conditions ( e.g. the one at @xmath299 ) and the application of the other boundary condition constrains a function of @xmath93 to be an integer ; in our case one finds @xmath301 .",
    "details are in appendix c , but we do wish to mention the nature of the boundary conditions here .",
    "technically @xcite these are _ exit _ boundary conditions which means that all the probability which diffuses to the boundary is `` extracted '' from the interval @xmath80 .",
    "navely , one might imagine that it is appropriate to impose absorbing boundary conditions , i.e. , that the pdf vanishes at @xmath302 and @xmath303 .",
    "however , since the diffusion coefficient , defined in eq .",
    "( [ kol_2 ] ) , vanishes on the boundaries the diffusion equation itself imposes some sort of absorption .",
    "a more careful mathematical analysis , such as the informal argument presented in appendix a , reveals that the appropriate constraint on the eigenfunctions is that they should diverge less rapidly than a square - root at both boundaries .",
    "the result @xmath304 imposed by the boundary conditions together with the definitions ( [ abc_defn_neut ] ) imply that @xmath305 and so @xmath306 the solutions of the differential equation will be labelled by the integer @xmath81 and consist of polynomials of order @xmath81 .",
    "these have already been mentioned in section [ overview ] ( eq .",
    "( [ soln_2 ] ) ) , whilst more technical information can be found in appendix  c.    now we can move on to the solution for general @xmath7 . as explained above it",
    "is sufficient to solve eq .",
    "( [ psi_eqn ] ) where @xmath307 is given by the @xmath93 found in the solution of the @xmath25 allele problem .",
    "we have seen that for @xmath59 , this is given by ( [ lambda_1_quant ] ) , and so this will be the @xmath307 for the @xmath71 problem .",
    "we will see that this will have the general structure @xmath308 , where @xmath309 is an integer , and therefore we take this form for @xmath307 . from the way that the @xmath25 problem is embedded in the @xmath7 allele problem , we always have only to solve the @xmath310 equation and so we need to determine @xmath311 .",
    "this is determined by the equation @xmath312 from which we see that @xmath313 or @xmath314 .",
    "again , both give the same result and so we take the former . applying the boundary conditions again gives @xmath304 , with @xmath315see appendix  c for the details .",
    "using eq .",
    "( [ abc_defn_neut ] ) one sees that @xmath316 and so @xmath317 where @xmath318 .",
    "this justifies the choice for @xmath307 .    in summary",
    ", we have found that @xmath319 , @xmath320 . if we define @xmath321 then @xmath322 , and we have recovered ( [ lambda_and_l ] ) .",
    "the general solution is given by eqs .",
    "( [ soln_m_first])-([soln_m_fourth ] ) and discussed further in appendix c.      when mutations are present we have to solve eq .",
    "( [ hypergeo ] ) subject to the general set of parameter values given by eq .",
    "( [ abc_defn ] ) . while it is true that this slightly complicates the analysis as compared with that of the mutation - free case , the most significant change is the nature of the boundary conditions .",
    "the introduction of mutations in the way we have done here renders the boundaries reflecting , which are defined as having no probability current through them .",
    "the current @xmath323 satisfies the continuity equation  @xcite @xmath324 where ( compare with eqs .",
    "( [ kol_m_u ] ) and ( [ cala_cald ] ) ) , @xmath325 - \\frac{\\partial } { \\partial u_{i } }   \\left [ \\mathcal{d}_{i}({\\underline}{u } ) \\mathcal{p } ( { \\underline}{u},t ) \\right ] \\nonumber \\\\ & = & \\frac{1 } { \\prod_{j < i}(1-u_j ) } \\left\\ { \\left ( m_{i } - r_{i } u_{i } \\right ) \\mathcal{p } - \\frac{1}{2 } \\frac{\\partial } { \\partial u_i } \\left [ u_i(1-u_i )   \\mathcal{p } \\right ] \\right\\}\\ , .",
    "\\label{current_defn}\\end{aligned}\\ ] ] using the separable form of the solution ( [ sep_soln_n_mut ] ) , and asking that the current is zero on the boundaries lead to the conditions @xmath326 \\right\\}_{u_{i}=0,1 }   = 0\\ , , \\label{reflectbc_psi}\\ ] ] or in terms of the solutions of the hypergeometric equation @xmath327 \\left ( 1 - u_{i } \\right)^{\\gamma_i }     f^{(i)}_{\\lambda_{i};\\lambda_{i-1 } } ( u_i ) \\right . &",
    "+ & \\nonumber \\\\",
    "u_i \\left ( 1-u_i \\right)^{\\gamma_{i}+1 }   \\frac{{{\\rm d}}}{{{\\rm d}}u_i }   f^{(i)}_{\\lambda_{i};\\lambda_{i-1}}\\right\\}_{u_{i}=0,1 } & = & 0\\ , . \\label{reflectbc_f}\\end{aligned}\\ ] ] as before , we will discuss the general aspect of the solution here , deferring technical details to appendix  c. we begin with the case of two alleles .",
    "the solution to the kolmogorov equation when only two alleles are present has been given by crow and kimura  @xcite and in our case corresponds to the solution of eq .",
    "( [ psi_eqn_mut ] ) with @xmath328 .",
    "it then follows from eq .",
    "( [ gammai_choice ] ) that we may take @xmath297 ( note that @xmath277 takes on the value @xmath155 in this case , since there is only one variable in the problem : @xmath329 ) .",
    "it therefore follows from eq .",
    "( [ abc_defn ] ) that @xmath330 and @xmath331 .",
    "we begin by examining the nature of the solutions of eq .",
    "( [ hypergeo ] ) in the vicinity of @xmath299 .",
    "three separate cases have to be examined : ( i ) @xmath332 not an integer , ( ii ) @xmath333 , and ( iii ) @xmath334 .",
    "when the boundary condition ( [ reflectbc_f ] ) is applied , one of the two independent solutions is ruled out .",
    "the application of the other boundary condition again imposes a condition on @xmath335 . in appendix  c , we show that @xmath336 where @xmath81 is a non - negative integer and , as @xmath59 , @xmath337 .",
    "the solutions of the differential equations are again labelled by an integer @xmath81 , and once again turn out to be jacobi polynomials which have been given in section [ overview ] .    when determining the solution for general @xmath7 , the eigenvalue @xmath307 in eq .",
    "( [ psi_eqn_mut ] ) is given by the eigenvalue @xmath93 found in the @xmath25 allele problem , as occurred in the special case of no mutations .",
    "however , more care is required here , since the iterative nature of the problem manifests itself in such a way that the solution with @xmath7 alleles is determined in terms of a function @xmath252 and the solution with @xmath25 alleles but with @xmath338 and @xmath339 , where @xmath340 . therefore although @xmath266 is given by eq .",
    "( [ lambda_1_quant_mut ] ) , the @xmath307 we use for the @xmath341 problem is actually @xmath342 . for the general case we will see the @xmath307 will have the general structure @xmath343 where @xmath309 is an integer .",
    "so having obtained the solution for @xmath344 from the @xmath25 solution , we need to solve the @xmath345 equation ( [ psi_eqn_mut ] ) where @xmath346 is a solution of eq .",
    "( [ gammai_choice ] ) , that is , @xmath347 this equation has two solutions : @xmath348 and @xmath349 , and since both give the same result we take the former .",
    "the implementation of the boundary conditions is carried out in the same way as in the two allele case .",
    "this is discussed in appendix c where it is shown that this implies that @xmath350 where @xmath351 here the @xmath352 are non - negative integers .",
    "the solutions are given explicitly by equations ( [ soln_m_first_m])-([soln_m_sixth_m ] ) .",
    "in the study of most stochastic systems , the quantities which are of interest and which are most easily calculated are the mean and variance of the distribution and also the stationary pdf which the pdf tends to at large times .",
    "this is still true in the problems we are considering in this paper , where these quantities can , in general , be rather easily obtained .",
    "many are already known and have been given in section [ calculations ] and their derivation will be briefly discussed in this section .    we draw particular attention to the added subtleties that exist when no mutation is allowed . in this case",
    "the exact solutions obtained so far only hold in the _ open _ interval @xmath353 and do not include the boundaries @xmath354 or @xmath355 .",
    "it is clear that with increasing time various alleles will become extinct and the stationary pdf will be concentrated entirely on the boundaries where it will accumulate .",
    "this is somewhat different to the usual picture of absorbing states where the probability is removed entirely from the system . in order to calculate moments of allele frequencies , for example",
    ", one must take care to add in the contributions from the boundaries to those obtained by averaging the frequencies over the pdfs we have so far determined .",
    "this procedure will be demonstrated later in this section .",
    "first , however , we calculate a few quantities of interest when the absence of a mutation process admits the fixation and extinction of alleles .",
    "the probability that one allele has fixed by a time @xmath3 was first obtained by kimura @xcite by way of a moment formula for the distribution . here",
    "we derive this quantity directly from the explicit solution when there are only two alleles .",
    "we have described in section  [ fixation ] how this can be extended to any number of alleles .",
    "the definition of the current ( [ current_defn ] ) can be written as @xmath356   = - \\frac{1}{2 } ( 1 - 2x ) p(x , t ) - \\frac{1}{2 } x(1-x )   \\frac{\\partial p}{\\partial x}\\ ] ] in which the function @xmath357 is the probability distribution _ excluding _ any boundary contributions .",
    "we find then at the boundary points @xmath18 and @xmath19 , @xmath358 we then find the probability for allele @xmath8 to have fixed by time @xmath3 is the sum of the current at the boundary : @xmath359 which can be evaluated by inserting the explicit expression ( [ soln_2 ] ) .",
    "this procedure yields @xmath360    using the identities ( [ ident1 ] ) and ( [ ident2 ] ) given in appendix c this can be written @xmath361 e^{-(l+1)(l+2)t/2}\\ , \\label{pi_xequals1_2_alt3}\\ ] ] where @xmath147 is a legendre polynomial , in accordance with the result of @xcite .",
    "the probability that @xmath8 has been eliminated by time @xmath3 is the same as the probability that @xmath9 ( with initial proportion @xmath362 ) has become fixed . in other words , @xmath363 e^{- ( l+1)(l+2 ) t/2}\\ , , \\label{pi_xequals0_2_alt1}\\end{aligned}\\ ] ]",
    "where we have used the fact that @xmath364 .    as noted in section  [ calculations ] ,",
    "combinatorial arguments can be used to calculate the probability that exactly @xmath153 alleles coexist at time @xmath3 from the fixation probability just derived . to do this ,",
    "divide the complete set of @xmath7 alleles into two groups @xmath150 and @xmath151 , the first containing a particular subset of @xmath153 alleles . as argued in section  [ calculations",
    "] , the probability that all of the @xmath365 alleles in @xmath151 have become extinct by time @xmath3 , leaving _ some _ of those in @xmath150 remaining is just @xmath366 , where @xmath14 is the total initial frequency of all alleles in @xmath150 .    to find the probability that _ all _ the alleles in @xmath150 continue to coexist at time @xmath3 , we must subtract from @xmath366 the probability that one or more of them has been eliminated .",
    "for example the probability that only the pair of alleles @xmath171 and @xmath367 coexist at time @xmath3 is @xmath368 as shown by kimura @xcite .",
    "one then finds the probability that exactly two alleles remain at time @xmath3 to be the sum of the previous expression over all distinct pairs of indices @xmath369 .",
    "this gives @xmath370 similarly , the probability that only the triple of alleles @xmath166 , @xmath371 and @xmath372 all coexist at time @xmath3 is the probability @xmath373 that some subset of these alleles remains at time @xmath3 , minus the probability that only any particular pair or single allele from @xmath374 and @xmath372 coexist , that is , @xmath375 \\\\",
    "-[f_1(x_{i_2,0}+x_{i_3,0},t)-f_1(x_{i_2,0},t)-f_1(x_{i_3,0},t ) ] \\\\ -[f_1(x_{i_1,0}+x_{i_3,0},t)-f_1(x_{i_1,0},t)-f_1(x_{i_3,0},t ) ] \\\\",
    "-f_1(x_{i_1,0},t)-f_1(x_{i_2,0},t)-f_1(x_{i_3,0},t)\\ , .",
    "\\label{3fs}\\end{gathered}\\ ] ] simplifying , we find that @xmath376 where @xmath377 is a subset of @xmath378 with @xmath156 elements and @xmath379 are the elements of that subset .",
    "proceeding in this way , one finds that the probability that the @xmath153 alleles @xmath380 all coexist at time @xmath3 is given by @xmath381 where now the second summation is over a subset of @xmath382 with @xmath156 elements . the result ( [ specific_comb_r ] )",
    "can be proved by induction , by beginning with the expression for @xmath383 ( compare with eq .",
    "( [ 3fs ] ) which is the case @xmath384 ) : @xmath385 if we now assume the result ( [ specific_comb_r ] ) up to and including @xmath153 alleles , then by substituting these expressions for @xmath386 into the right - hand side of eq .",
    "( [ chi_r+1 ] ) , we obtain the expression ( [ specific_comb_r ] ) , but with @xmath153 replaced by @xmath387 .",
    "since we have explicitly verified the result for low values of @xmath153 , the result is proved . during the course of the proof",
    "the double summation is rearranged using @xmath388 and the fact that a particular set @xmath389 appears @xmath390 times in the sum is used .    the analogue of eq .",
    "( [ any_2 ] ) in this case , namely the probability that exactly @xmath153 alleles remain at time @xmath3 is the sum of eq .",
    "( [ specific_comb_r ] ) over all distinct @xmath153-tuplets of indices @xmath391 : @xmath392 substituting the result ( [ specific_comb_r ] ) into this equation , and using exactly the same manipulations that were required in the inductive proof of ( [ specific_comb_r ] ) , gives the general result for @xmath153 alleles stated earlier : eq .",
    "( [ prob_exactly_r ] ) ; see also @xcite .",
    "as is well - known ( see , e.g. , @xcite ) the mean time @xmath393 to reach any boundary from an initial position @xmath394 @xmath395 where @xmath396 is the backward kolmogorov operator appearing in ( [ bke ] ) .",
    "the boundary conditions on @xmath393 are that it vanish for any @xmath394 corresponding to a boundary point . for the case @xmath59 and no mutations ,",
    "we seek the solution of @xmath397 that has @xmath398 .",
    "two successive integration steps yield the required answer ( [ tau_1 ] ) .",
    "a related quantity , which is obtained in a similar fashion , is the mean time to fixation of allele @xmath8 , _ given _ that it does become fixed .",
    "this is given by @xmath399 since @xmath145 is the probability that allele @xmath8 has become fixed by time @xmath3 .",
    "since @xmath400 as @xmath401 , the denominator equals @xmath14 . to find the numerator , we multiply the backward kolmogorov equation by @xmath3 and integrate over all @xmath3 .",
    "use of eqs .",
    "( [ flux_2 ] ) and ( [ f_and_p ] ) then shows that the numerator obeys the equation @xmath402 this yields the result @xmath403    to find the mean time to the @xmath153th extinction event from an initial condition with @xmath7 alleles , note that the probability @xmath404 that @xmath405 or fewer alleles coexist at a time @xmath3 can be found by summing ( [ prob_exactly_r ] ) appropriately .",
    "one finds @xmath406 where we have rearranged the double summation using @xmath407 and also used the identity @xmath408 .",
    "differentiating @xmath404 with respect to time gives the probability that a state comprising @xmath405 alleles is entered during the time interval @xmath409 $ ] .",
    "this corresponds to the @xmath153th extinction event , where @xmath410 .",
    "hence the mean time to this extinction , the first moment of the distribution , is given by @xmath411 the denominator being unity , since @xmath412 . however , from eqs .",
    "( [ fixtime ] ) and ( [ fixtime_result ] ) , @xmath413 this gives an expression for the function which we wish to evaluate in eq .",
    "( [ tau_r(m ) ] ) . changing the summation variable from @xmath156 to @xmath414 , and so identifying @xmath415 with @xmath416 gives @xmath417 \\ln \\left [ x_{i_1,0 } + \\cdots + x_{i_s,0 } \\right]\\,.\\ ] ]    let @xmath418 be the probability that in the evolution allele @xmath7 becomes extinct first , followed by allele @xmath25 , @xmath419 and so on , ending with fixation of allele @xmath155 .",
    "littler @xcite found the result given in eq .",
    "( [ qp ] ) , but we give a derivation here .",
    "we define @xmath420 as the probability that this sequence of extinctions has occurred by time @xmath3 .",
    "so for example , in the biallelic system ( @xmath59 ) , @xmath421 .",
    "just as one can show that @xmath422 obeys the @xmath59 backward kolmogorov equation ( by setting @xmath10 equal to its value on the boundary @xmath19 and relating @xmath422 to @xmath423 ) , then in general one can show that @xmath424 satisfies the backward kolmogorov equation ( [ bke ] ) @xmath425    the function @xmath418 is the stationary ( i.e. , @xmath401 ) solution of this equation that satisfies the following boundary conditions .",
    "first , @xmath426 for any @xmath394 that corresponds to any allele other than @xmath7 already being extinct .",
    "that is , for any @xmath394 that has @xmath427 for any @xmath428 . on the hyperplane @xmath429",
    ", we must have that @xmath430 equal to the probability of the subsequent extinctions taking place in the desired order by time @xmath3 . taking the limit @xmath193 , this boundary condition implies @xmath431 we have chosen this particular order of extinctions to demonstrate the result as it corresponds to the ordering implied in our definition of @xmath90 . in the @xmath90 variables ,",
    "the backward kolmogorov operator reads @xmath432 we conjecture a solution @xmath433 clearly , @xmath396 annihilates this product , so it is a stationary solution of ( [ qfp ] ) .",
    "the boundary condition that @xmath434 for @xmath435 , @xmath436 is also obviously satisfied .",
    "furthermore , if @xmath437 , @xmath438 hence the recursion ( [ recur ] ) is satisfied . it is easily established that @xmath439 by finding the stationary solution of the backward fokker - planck equation ( [ qfp ] ) with @xmath59 and imposing the boundary conditions @xmath440 and @xmath441 .",
    "therefore by induction , ( [ qm_u ] ) is the solution required .",
    "rewriting in terms of the @xmath10 variables , @xmath442    the probability for an arbitrary sequence of extinctions : allele @xmath443 to go extinct first , followed by @xmath444 leaving only allele @xmath445 can be determined by permuting the indices in ( [ qm ] ) .",
    "this then gives us ( [ qp ] ) .",
    "we earlier obtained the time - dependent pdf valid when mutation rates are nonzero by imposing reflecting boundary conditions .",
    "these have the effect of preventing currents at the boundaries , which in turn ensure that the limiting @xmath193 solution is nontrivial and hence the complete stationary distribution .",
    "one can check that this is the case from ( [ soln_m_first_m])([soln_m_sixth_m ] ) .",
    "when all the integers @xmath101 are zero , the eigenvalue in ( [ lambda_and_l_m ] ) is also zero , indicating a stationary solution .",
    "the remaining eigenvalues are all positive , which relate to exponentially decaying contributions to the pdf .",
    "retaining then only the term with @xmath446 in ( [ soln_m_first_m ] ) we find immediately that @xmath447 it is easy to check that this distribution is properly normalised over the hypercube @xmath448 , @xmath449 . to change variable back to the allele frequencies @xmath43 we use the transformation ( [ trans_prob_m ] ) , and using the fact that @xmath450 , @xmath451 and @xmath452 , we arrive at the result quoted earlier , ( [ pstarmut ] ) .    when the mutation process is suppressed , one finds from ( [ lambda_and_l ] ) that all the eigenvalues are nonzero , indicating that the distribution we have derived is zero everywhere in the limit @xmath401 .",
    "this means that the stationary solution comprises the accumulation of probability at boundary points , as stated in section  [ calculations ] .",
    "one way to obtain the moments is to perform averages over the distribution .",
    "the mean and variance when mutation is present can easily be calculated in this way from ( [ soln_2_m ] ) .",
    "calculating the mean directly from the explicit formula for the probability distribution ( [ soln_2 ] ) when fixation can occur is tricky because one must include the full , time - dependent formula for the fixation probability at the right boundary and the integrals one has to evaluate are not particularly convenient .",
    "alternatively , we can exploit the kolmogorov equation written in the form of a continuity equation ( [ continuity ] ) .",
    "this leads to a differential equation for each moment which depends on lower moments .",
    "the first few moments can then be found iteratively in a relatively straightforward way .",
    "we demonstrate the method by giving the derivation of the moments of the distribution when two alleles are initially present .",
    "we then show that this method extends in a straightforward way to the case when @xmath7 alleles are present .",
    "specifically for @xmath59 we have @xmath453 where the current @xmath454 and where @xmath116 .",
    "when mutations in either direction are present ( i.e. , both @xmath455 and @xmath456 ) the mean of @xmath457 is given by the expression @xmath458 and so @xmath459_{x=0}^{1}\\end{aligned}\\ ] ] where we have used the continuity equation ( [ continuity_m2 ] ) and integrated by parts .",
    "we have already stated that there is no current of probability through the boundaries .",
    "in other words , here @xmath460 and so the last term in ( [ meanxbyparts ] ) is zero .",
    "when fixation is a possibility , one _ does _ have a current at the boundaries and , the probability that allele @xmath8 is fixed at time @xmath3 being @xmath461 . since the function @xmath462 excludes contributions from the boundary in this case , we must add these explicitly into the mean of @xmath457 .",
    "that is , @xmath463 taking the derivative of this expression and carrying out the integration by parts as in ( [ meanxbyparts ] ) , we obtain @xmath464_{x=0}^{1 }   + \\frac{\\partial f_1(x_0 , t)}{\\partial t } \\;.\\ ] ] these last two terms cancel , and so in either case we are left with @xmath465    inserting the expression ( [ current_m2 ] ) for the current we find @xmath466 \\;.\\ ] ] this reveals that moments of the distribution can be calculated iteratively .",
    "this equation is valid whether or not the @xmath39 are non - zero .",
    "the equation for the mean ( @xmath467 ) can be solved directly , and the results used to find @xmath468 ( @xmath469 ) and so on .    when there are more than 2 alleles , a similar derivation gives the equation for the general moment @xmath470 : @xmath471\\langle x_i^{k_i-1 } \\prod_{j\\neq i}x_j^{k_j}\\rangle - \\right.\\\\ \\left .",
    "[ \\frac{1}{2}(\\sum_lk_l-1)+r]\\langle \\prod_i x_i^{k_i}\\rangle \\right\\}\\,.\\end{gathered}\\ ] ] thus , again we can calculate any moment by iteration .",
    "for example @xmath472 , with @xmath473 , obeys the equation @xmath474 and using ( [ meanx_m ] ) we find the result given in ( [ covarx_m ] ) .",
    "in the last decade or two the ideas and concepts of population genetics have been carried over to a number of different fields : optimisation @xcite , economics @xcite , language change @xcite , among others . while the essentials of the subject such as the existence of alleles , and their mutation , selection and drift are usually present in these novel applications , other aspects may not have analogues in population genetics .",
    "furthermore , phenomena such as epistasis , linkage disequilibrium , the relationship between phenotypes and genotypes , which form a large part of the subject of population genetics , may be unimportant or irrelevant in these applications .",
    "our motivation for the work presented here has its roots in the mathematical modelling of a model of language change where it is quite plausible that the number of variants ( alleles ) is much larger than two .",
    "it was this which led us to systematically analyse the diffusion approximation applied to multi - allelic processes , having noted that many of the treatments in the context of biological evolution tend to be couched in terms of a pair of alleles , the `` wild type '' and the `` mutant '' .    in this paper we have shown how the kolmogorov equation describing the stochastic process of genetic drift or the dynamics of mutation at a single locus may be solved exactly by separation of variables in which the number of alleles is arbitrary .",
    "the key to finding separable solutions is , of course , to find a transformation to a coordinate system where the equation is separable .",
    "the change of variable ( [ cofv ] ) we used is similar , but slightly different to one suggested by kimura @xcite which he showed achieved separability up to and including @xmath475 alleles .",
    "kimura was of the opinion that novel mathematical techniques would be needed to proceed to the general case of @xmath7 alleles .",
    "what we have shown here is that with our change of variables this generalisation is possible without the need to invoke any more mathematical machinery than was required in the standard textbook case of @xmath229 alleles .",
    "a large part of the reason for this is the way that the problem with @xmath476 alleles can be constructed in a straightforward way from the problem with @xmath7 alleles and that with @xmath229 alleles .",
    "this simple `` nesting '' of the @xmath7-allele problem in the @xmath476-allele one is responsible for many of the simplifications in the analysis and is at the heart of why the solution in the general case can be relatively simply presented .",
    "an illustration of the simple structure of this nesting is the fact that the general solutions , valid for an arbitrary number of alleles , with or without mutation , is made up of products of polynomials  more specifically jacobi polynomials . although the higher order versions of these polynomials can be quite complex , even after relatively short times only those characterised by small integers are important .",
    "as mentioned in section [ u_variables ] , we have given the solutions in terms of the transformed variables , but their form in terms of the original variables of the problem can be found using eqs .",
    "( [ cofv ] ) and ( [ trans_prob_m ] ) .",
    "we have also presented the derivations of many other quantities of interest . in the interests of conciseness",
    "we have given only a flavour of some of these : some are new , some have already been derived by other means and yet others are simple generalisations of the two - allele results . yet",
    "other results are more naturally studied in the context of the backward kolmogorov equation , and we also took the opportunity to gather together the most significant , but nevertheless little - known , ones here .",
    "we have thus provided a rather complete description of genetic drift and mutation at a single locus .",
    "nevertheless , there are some outstanding questions . for example , as discussed in appendix b , the transformation ( [ cofv ] ) does not render the kolmogorov equation separable for an arbitrary mutation matrix @xmath477 , only one where that rate of mutation of the @xmath478 alleles to @xmath479 alleles ( @xmath480 ) occurs at a rate independent of @xmath40 .",
    "this is the reason for this simplified choice for the mutation matrix  a choice also made in all other research we are aware of .",
    "it might seem possible in principle to find another transformation which would allow a different form of @xmath477 to be studied , but this seems difficult for a number of reasons .",
    "for instance , the transformation must still ensure that the diffusion part of the kolmogorov equation is separable .",
    "furthermore , the matrix has @xmath481 entries , and the transformation only @xmath28 degrees of freedom so for only certain , restricted , forms of @xmath477 will a transformation to a separable equation be possible .",
    "other questions involve the study of selection mechanisms or interactions between loci using the results here as a basis on which to build .",
    "we are currently investigating these questions in the context of language models , but we hope that the work reported in this paper will encourage further investigations along these lines among population geneticists .",
    "gb acknowledges the support of the new zealand tertiary education commission .",
    "rab acknowledges support from the epsrc ( grant gr / r44768 ) under which this work was started , and a royal society of edinburgh personal research fellowship under which it has been continued .",
    "as we have mentioned several times in the main text , although it might be thought that adding the possibility that mutations occur would complicate the problem , in many ways it is the situation of pure random mating that is the richer mathematically .",
    "so , for example , the case with mutations has a conventional stationary pdf given by eq .",
    "( [ pstarmut ] ) , whereas without mutations the stationary pdf is a singular function which exists only on some of the boundaries .",
    "of course , it is clear from the nature of the system being modelled that this has to be the case , but what interests us in this appendix is the nature of the boundary conditions which have to be imposed on the eigenfunctions of the kolmogorov equation ( [ kol_m ] ) to obtain the correct mathematical description .",
    "the nature of the boundary conditions required when fixation can occur are discussed in the literature both from the standpoint of the kolmogorov equation in general @xcite and in the specific context of genetic drift @xcite . here",
    "we will describe a more direct approach , which while not so general as many of these discussions , is easily understood and illustrates the essential points in an explicit way .",
    "it is sufficient to discuss the one - dimensional ( two allele ) case , since all the points we wish to make can be made with reference to this problem .",
    "the question then , can be simply put : what boundary conditions should be imposed on eq .",
    "( [ kol_2 ] ) ? on the one hand",
    "one might feel that that these should be absorbing boundary conditions @xcite , because once a boundary is reached there should be no chance of re - entering the region @xmath482 . on the other hand",
    ", however , the diffusion coefficient `` naturally '' vanishes on the boundaries which automatically guarantees absorption , so there would seem to be no need to further impose a vanishing pdf ( as an absorbing boundary condition would require ) . in that case , what boundary conditions should be imposed ? also is it even clear , given the fact that the diffusion coefficient @xmath483 becomes vanishingly small as the boundaries are approached , that the boundaries can be reached in finite time ?    to address these questions let us begin with the kolmogorov equation ( [ kol_2_mut ] ) which includes a deterministic component @xmath484 as well as a random component represented by the diffusion coefficient @xmath17 .",
    "although we are interested in the case when @xmath484 is not present , it will help in the interpretation of the results if we initially include it .",
    "we also make two notational changes  we put a subscript @xmath485 on @xmath484 which will be explained below and we will write @xmath486 .",
    "the function @xmath487 is real , since @xmath488 .",
    "therefore our starting equation is @xmath489 + \\frac{1}{2 } \\frac{\\partial^{2}}{\\partial x^2 }   \\left [ g^{2 } ( x ) p \\right]\\ , .",
    "\\label{ito}\\ ] ] it turns out that it will more useful for our purposes to write this in the form @xmath490 + \\frac{1}{2 } \\frac{\\partial } { \\partial x }   \\left [ g(x ) \\frac{\\partial } { \\partial x } \\left ( g ( x ) p \\right ) \\right ] \\nonumber \\\\ \\nonumber \\\\ & = & -\\frac{\\partial } { \\partial x } \\left [ a_{s}(x ) p \\right ] +   \\frac{1}{2 } \\frac{\\partial } { \\partial x }   \\left [ g(x ) \\frac{\\partial } { \\partial x } \\left ( g ( x ) p \\right ) \\right]\\ , .",
    "\\label{strat}\\end{aligned}\\ ] ] where @xmath491 equations ( [ ito ] ) and ( [ strat ] ) are known as the ito and stratonovich forms of the kolmogorov equation respectively @xcite .",
    "there is no need for us to explore the differences between these two formulations ; the only relevant point here is that the stratonovich form is more convenient for our purposes .",
    "we now transform eq .",
    "( [ strat ] ) by introducing the pdf @xmath492 which is a function of the new variable @xmath493 defined by @xmath494 the transformed equation reads @xmath495 +   \\frac{1}{2 } \\frac{\\partial^{2}q}{\\partial y^2}\\ , ,   \\label{pdf_y}\\ ] ] where @xmath496 the system with an @xmath10-dependent diffusion coefficient has now been transformed to one with a state - independent diffusion coefficient , at the cost of adding an additional factor to the deterministic term .",
    "the problem of interest to us has @xmath497 and @xmath498 . from eq .",
    "( [ x_to_y ] ) we find the required transformation to be @xmath499 or @xmath500 with @xmath501 , and from eq .",
    "( [ trans_a_defn ] ) we find that @xmath502 .",
    "one way to understand this process intuitively is through a mechanical analogy : if we set @xmath503 , then the kolmogorov equation can be thought of as describing the motion of an overdamped particle in the one - dimensional potential @xmath504 , subject to white noise with zero mean and unit strength .",
    "an examination of fig .",
    "[ potentials ] shows that the boundaries are reached in a finite time .",
    "more importantly , from the relation @xmath505 we see that imposing the absorbing boundary conditions @xmath506 only implies that the pdf @xmath507 must diverge with a power smaller than @xmath508 at the boundaries @xmath18 and @xmath19 .",
    "these results should be contrasted with the hypothetical situation where @xmath509 , but @xmath510 . in this situation",
    "we have that @xmath511^{-1}$ ] or @xmath512 with @xmath513 , and from eq .",
    "( [ trans_a_defn ] ) we find that @xmath514 .",
    "this corresponds to a process in which an overdamped particle is moving in the potential @xmath515 and subject to white noise . for large @xmath516 , @xmath517 , which indicates that it will take an infinite time to reach the boundaries",
    "this potential is shown on the right - hand side of fig .",
    "[ potentials ] .",
    "considerations such as these complement more mathematically rigorous studies by giving insights into the nature of the processes involved when the diffusion coefficient is dependent on the state of the system .     in the actual genetic drift system .",
    "right : potential @xmath518 in the hypothetical system described in the text.,title=\"fig : \" ]   in the actual genetic drift system .",
    "right : potential @xmath518 in the hypothetical system described in the text.,title=\"fig : \" ]",
    "the transformation from the coordinate system defined in terms of the set of allele frequencies , @xmath43 , to that denoted by @xmath100 , for which the kolmogorov equation is separable , is given by eq .",
    "( [ cofv ] ) , with the inverse transformation given by eq .",
    "( [ cofv_inverse ] ) . in this appendix",
    "we explore the nature of this transformation , determine the jacobian of the transformation and calculate how the jump moments in the new coordinate system are related to those in the old one .",
    "this enables us to derive the kolmogorov equation in the new variables  given by eqs .",
    "( [ kol_m_u ] ) and ( [ cala_cald ] ) in the main text .",
    "we begin by looking at the nature of the transformation for low values of @xmath7 .",
    "@xmath519 : @xmath520 .",
    "@xmath521 .",
    "@xmath522 : @xmath523 . since @xmath524 also satisfies this condition , then @xmath525 .",
    "@xmath526 therefore , @xmath527 , with the three lines @xmath528 and @xmath529 go over to the three lines @xmath530 and @xmath531 respectively .",
    "the point @xmath532 goes over to the line @xmath533 .",
    "this is illustrated in fig .",
    "[ cov_3 ]    @xmath534 : @xmath535 with the additional condition @xmath536 .",
    "@xmath537 therefore , @xmath538 .",
    "the planes @xmath539 get mapped on to the planes @xmath354 ( @xmath540 ) , the plane @xmath541 gets mapped on to the plane @xmath542 , the line @xmath543 gets mapped to the plane @xmath544 and the point @xmath545 gets mapped to the plane @xmath546 .",
    "this is illustrated in fig .",
    "[ cov_4 ] .",
    ": @xmath547 with the additional condition @xmath548 .    from eqs .",
    "( [ cofv ] ) and ( [ cofv_inverse ] ) we see that @xmath549 .",
    "the pattern from the @xmath71 and @xmath158 cases should now be clear : the hyperplanes @xmath539 get mapped on to the hyperplanes @xmath354 ( @xmath550 ) , the hyperplane @xmath551 , gets mapped on to the hyperplane @xmath552 , the point @xmath553 gets mapped to the hyperplane @xmath554 .",
    "so , in summary , the region @xmath555 lying between the origin and the hyperplane @xmath556 , gets mapped into the unit hypercube @xmath557 .",
    "however , parts of the hyperplane @xmath556 of dimensions @xmath558 get mapped on to the hyperplanes @xmath559 .",
    "the jacobian of the transformation from @xmath90 to @xmath207 is easily found if we note from ( [ cofv_inverse ] ) that @xmath560 if @xmath561 .",
    "this implies that the jacobian has zeros if the column label is greater than the row label , and so the determinant is just the product of the diagonal elements .",
    "since the @xmath277th diagonal element is simply @xmath562 , we have that @xmath563 as explained in section [ u_variables ] , the pdfs in the @xmath90 variables , denoted by @xmath564 , are related to those in the @xmath207 variables , denoted by @xmath507 , by a multiplicative factor which is simply the jacobian : @xmath565 from which ( [ trans_prob ] ) follows .    the final point which we wish to discuss in this appendix",
    "is the form of the kolmogorov equation in the new @xmath90 variables .",
    "as discussed in section [ soln ] , the easiest way to determine this is to relate the jump moments in the old coordinate system , defined through eq .",
    "( [ jm_defn ] ) , and those in the new coordinate system , defined through eq .",
    "( [ jm_defn_new ] ) . to do this ,",
    "let us begin with the first jump moment : @xmath566 where we have used ( [ trans_prob ] ) and where @xmath567 is the transformation ( [ cofv ] ) .",
    "use of taylor s theorem then gives @xmath568 since jump moments higher than the second vanish in the limit @xmath212 , we find from eq .",
    "( [ trans_jm_1 ] ) that @xmath569 similarly , @xmath570 the results ( [ trans_jm_1.1 ] ) and ( [ trans_jm_2 ] ) tell us how the jump moments transform from one coordinate system to another . in our case , we have from eq .",
    "( [ cofv ] ) @xmath571 and @xmath572 the key feature of the two results ( [ du_by_dx ] ) and ( [ d2u_by_dxdx ] ) is that they only depend on @xmath277 , and not on @xmath573 or @xmath81 .",
    "this simplifies the summations which appear in ( [ trans_jm_1.1 ] ) and ( [ trans_jm_2 ] ) .",
    "a still fairly tedious calculation shows that the second term on the right - hand side of ( [ trans_jm_1.1 ] ) is zero and that the terms with @xmath197 in ( [ trans_jm_2 ] ) are also zero .",
    "specifically , @xmath574    in this paper the only deterministic mechanism which we will consider will be mutation , described by the differential equation @xmath575 where @xmath477 is the rate of mutation of allele @xmath40 into allele @xmath277 . from eqs .",
    "( [ du_by_dx ] ) and ( [ jm_1 ] ) @xmath576 we will denote the term in the brackets in eq .",
    "( [ explicit_firstjm ] ) by @xmath577 , so that @xmath578 using eqs .",
    "( [ km_expansion_new ] ) and ( [ jm_2 ] ) , we find the kolmogorov equation in the new coordinate system to be @xmath579 + \\frac{1}{2 } \\frac{\\partial^{2 } } { \\partial u_i^2 } \\left [ u_{i}(1-u_i)\\,\\mathcal{p } \\right ] \\right\\}\\ , .",
    "\\label{kol_new_gen}\\ ] ] in section [ soln ] we prove that the kolmogorov equation is separable in the @xmath90 coordinate system if @xmath577 depends on @xmath580 only , and not on the @xmath581 .",
    "since @xmath582 involves a sum over the expression ( [ general_mut ] ) , which has itself to be written in terms of the @xmath90 using eq .",
    "( [ cofv_inverse ] ) , it is clear that this will not be the case for general @xmath477 .",
    "however , if it is assumed that the rate of mutation of the alleles @xmath583 to @xmath479 occurs at a constant rate @xmath39 , independent of @xmath40 , then @xmath584 for all @xmath585 and ( [ general_mut ] ) becomes @xmath586 in this case @xmath587 where @xmath588 and where we have used eq .",
    "( [ cofv_inverse ] ) .",
    "we see that @xmath577 only depends on @xmath100 and that @xmath589 where @xmath590 .",
    "this leads to the kolmogorov equation @xmath591 + \\frac{1}{2 } \\frac{\\partial^{2 } } { \\partial u_i^2 } \\left [ u_{i}(1-u_i)\\;\\mathcal{p } \\right ] \\right\\}\\ , .",
    "\\label{kol_new_spec}\\ ] ] this is the content of eqs .",
    "( [ kol_m_u ] ) and ( [ cala_cald ] ) in the main text .",
    "in this appendix we will provide further details relating to the solution of the equations ( [ psi_eqn_1 ] ) and ( [ psi_eqn ] ) subject to the appropriate boundary conditions .",
    "some of the details have already been given in section [ soln ] , in particular how the substitution ( [ f_defn ] ) leads to the hypergeometric equation ( [ hypergeo ] ) .",
    "consequently , much of this appendix will be concerned with the hypergeometric functions @xmath592 which are the solutions of this equation .",
    "we will refer to chapter 15 of the standard handbook by abramowitz and stegun  @xcite for the formul   that we use , but several appear sufficiently often that it is worth stating them explicitly here :    * if @xmath593 and @xmath594 , then @xmath595 * @xmath596 where @xmath597 and @xmath598 .",
    "note that @xmath599 . *",
    "if @xmath335 or @xmath600 is a non - positive integer then the power series for @xmath592 terminates : @xmath601 where @xmath602 is a jacobi polynomial of order @xmath1 .",
    "as we will see , the solution of the hypergeometric differential equation typically proceeds as follows .",
    "the general solution to the equation ( [ hypergeo ] ) is written out as @xmath603 , where @xmath604 and @xmath605 are two independent solutions of the equation , and @xmath606 and @xmath607 are two arbitrary constants .",
    "examining the general solution in the vicinity of the boundary at @xmath608 rules out one of the solutions , so that , for instance one must take @xmath609 in order to satisfy the boundary condition there .",
    "the remaining solution is now examined in the vicinity of the other boundary at @xmath610 .",
    "if the solution has the form @xmath611 with @xmath612 then we may use result 1 above .",
    "if @xmath613 , then we may use result 2 followed by result 1 .",
    "if it is found that either @xmath614 or @xmath615 is a non - positive integer , then result 3 may be invoked .",
    "the values of the parameters are given in section [ soln_neutral ] , where it is seen from eq .",
    "( [ abc_defn_neut ] ) that @xmath616 .",
    "one of the solutions of the hypergeometric equation when @xmath616 ( suppose it is @xmath617 ) has the following behaviour for small @xmath618  @xcite : @xmath619 and so this solution would not lead to a finite pdf as @xmath620recall from appendix  a that only divergences less strong than @xmath621 will be tolerated .",
    "therefore @xmath609 .",
    "the remaining solution is @xmath622 . from eq .",
    "( [ abc_defn_neut ] ) , @xmath623 , so if we choose @xmath624 , as described in section [ soln_neutral ] , we may use result 2 above to show that @xmath625 now @xmath626 and so we may use result 1 to show that @xmath627 we may once again use the result of appendix a to deduce that this term can not be present since it is diverging too fast as @xmath628 ( the analysis of appendix a can be straightforwardly generalised to cover the equations that are found from separation of the @xmath7 allele kolmogorov equation ) .",
    "we therefore require that either @xmath335 or @xmath600 equals @xmath629 , where @xmath81 is a non - negative integer .",
    "since the hypergeometric function is symmetric in @xmath335 and @xmath600 it does not matter which we choose : let @xmath304 . from result 3",
    "this means that the hypergeometric function is terminating , and more specifically , @xmath630 as shown in section [ soln_neutral ] , @xmath631 , if we take @xmath624 , and so up to a constant @xmath632 we discuss some properties of jacobi polynomials below .",
    "note that if we had made the choice @xmath633 in section [ soln_neutral ] ( _ i.e. _ @xmath634 ) , then the argument given above would still rule out solution @xmath605 using eq .",
    "( [ neut_utozero ] ) , but we would have found the remaining solution to be @xmath635 where @xmath636 and @xmath637 are the parameter solutions relevant for the choice @xmath638 and are related to those for the former @xmath624 choice by @xmath639 and @xmath640 . this can be easily seen from eq .",
    "( [ abc_defn_neut ] ) : if @xmath641 is one solution of @xmath642 , then a second one is @xmath643 .",
    "but then eq .  ( [ abc_defn_neut ] ) is unchanged if @xmath644 and @xmath600 are replaced by @xmath645 and @xmath646 .",
    "so for the choice @xmath647 we have shown that @xmath648 where the @xmath644 and @xmath600 are those for the @xmath624 choice .",
    "this is exactly eq .",
    "( [ neut_utoone ] ) and so we again deduce that @xmath304 , where @xmath81 is a non - negative integer . using result 2",
    "we then have that @xmath649 which is eq .",
    "( [ nuet_finalpsi ] ) .",
    "the final step in calculating the solutions is to apply the initial conditions to find the appropriate coefficients .",
    "we use the appropriate orthogonality relationship ( which we shall give below ) and use the method described in ( [ initial_conds])-([post_initial_conds ] ) , and find @xmath650 and @xmath651 as stated in ( [ soln_m_first ] ) and ( [ soln_m_third ] ) .",
    "the values of the parameters are given in section [ soln ] , where it is seen from eq .",
    "( [ abc_defn ] ) that @xmath652 .",
    "the nature of the solutions of eq .",
    "( [ hypergeo ] ) depends on whether @xmath332 is an integer , and if it is , what its value is  @xcite .",
    "the simplest case is if @xmath332 is not an integer , then the general solution has the form @xmath653 both of these hypergeometric functions are of the form @xmath654 with @xmath655 and so have power - series expansions near @xmath608  @xcite . substituting the expression ( [ c_noninteger ] ) into the boundary condition ( [ reflectbc_f ] ) gives @xmath656 . the analysis when @xmath333 and @xmath334 has to be done separately .",
    "one of the solutions has a factor of @xmath657 in these cases , but it turns out that , while these solutions have a current which does not diverge at @xmath608 , the current is non - zero , which is forbidden by the reflecting boundary conditions . therefore this solution must be absent .",
    "it is found that in all cases the implementation of the boundary condition at @xmath608 shows that the required solution is @xmath658 .",
    "we now note that the conditions which determine the parameters @xmath335 and @xmath600 from eq .",
    "( [ abc_defn ] ) can be simplified if we introduce a new parameter @xmath659 through @xmath660 .",
    "then @xmath661 , where @xmath662 .",
    "so choosing @xmath663 , this being one of the solutions of eq .",
    "( [ gamma_eqm_mut ] ) , we have that @xmath664 and @xmath665 and therefore @xmath666 . using result 2",
    "we may write this in an alternative form : @xmath667 we may now apply the boundary condition that the current vanishes when @xmath610 , which leads to eq .",
    "( [ reflectbc_f ] ) . after some algebra we find that this condition implies @xmath668 we may now use result 1 to show that for @xmath669 the term in the second set of curly brackets has a finite limit as @xmath628 , specifically this term tends to @xmath670 thus either @xmath671 or @xmath672 must be a non - positive integer if we are to obtain a finite current ( let alone a zero - current ) as @xmath628 .",
    "the case @xmath673 may be treated separately , since the first term in the bracket , to which result 1 does not immediately apply is absent .",
    "the same result is found . to show that these conditions also imply a zero current",
    ", we may substitute @xmath674 or @xmath675 into eq .",
    "( [ alt_form ] ) and find , when @xmath676 for instance that @xmath677 since by result 3 the two hypergeometric functions are polynomials of order @xmath81 , the right - hand side is indeed zero if @xmath669 , and also when @xmath673 , since the first term in the second curly bracket of eq .",
    "( [ bc_uequals1 ] ) is absent .",
    "note that if we had made the choice @xmath675 then the hypergeometric functions which would have appeared would have been of the form @xmath678 , which again are polynomials by result 3 .    therefore , returning to eq .",
    "( [ alt_form ] ) , we have found that @xmath679 using result 3 this is , up to a constant , @xmath680 where @xmath681 and @xmath682 .",
    "writing it in terms of the function @xmath257 we have that @xmath683 it is also straightforward to check that if we made the choice @xmath684 , rather than @xmath663 , then the analysis near @xmath608 would be as before , but then use of result 2 would then show that the result we obtain was exactly as before ( but with @xmath335 and @xmath600 interchanged ) .    in summary",
    ", we have shown that @xmath674 , where @xmath81 is a non - negative integer .",
    "thus for @xmath59 , when @xmath685 , and so from @xmath686 , we obtain eq .",
    "( [ lambda_1_quant_mut ] ) . for @xmath71 , we use eq .",
    "( [ lambda_prime_mut ] ) , with @xmath687 and so obtain @xmath265 given by @xmath688 where @xmath689 , and @xmath81 is a non - negative integer and where @xmath690 .",
    "continuing in this way we find the result given by eq .",
    "( [ lambda_n_mut ] ) .",
    "all the solutions for the pdfs considered in this paper consist of jacobi polynomial @xmath691 .",
    "all properties of these functions that we require are given in chapter 22 of abramowitz and stegun  @xcite , but here we will list the key results that we use .",
    "the first point to note is that the natural variable for these functions is @xmath692 .",
    "thus while @xmath693,\\ z \\in [ -1,1]$ ] .",
    "they satisfy the following orthogonality relation in the @xmath618 variable : @xmath694 where @xmath695 . in the eigenfunctions",
    "calculated when mutations are present , the functions @xmath99 which make up the right eigenfunction @xmath97 as defined in eq .",
    "( [ soln_m_second_m ] ) , contain the factor @xmath696 which appears in eq .",
    "( [ orthog ] ) , as can be seen in eq .",
    "( [ soln_m_third_m ] ) . on the other hand",
    "the functions @xmath141 which make up the left eigenfunction @xmath139 as defined in eq .",
    "( [ soln_m_fifth_m ] ) , do not contain this factor , as can be seen in eq .",
    "( [ soln_m_sixth_m ] ) .",
    "the result is that the right and left eigenfunctions satisfy the simple orthogonality relation @xmath697 .      in the derivation of the fixation probability in section  [ fixation ] we make use of the following relationship between jacobi and legendre polynomials which can be found in ref .",
    "@xcite : @xmath700\\,,\\ ] ] as well as this identity for legendre polynomials , which can be found in ref .",
    "@xcite : @xmath701\\;.\\ ] ]                                                        g.  b. golding , c.  strobeck , 2-locus , 4th - order gene - frequency moments - implications for the variance of squared linkage disequilibrium and the variance of homozygosity , theoretical population biology 24 ( 1983 ) 173191 .",
    "r.  k.  p. zia , r.  j. astalos , statistics of an aged stuructured population with two competing species : analytic and monte carlo studies , in : d.  p. landau , s.  p. lewis , h .- b .",
    "schuttler ( eds . ) , computer simulation studies in condensed matter physics xiv , springer - verlag , berlin , 2002 , pp .",
    "235254 .",
    "m.  kimura , diffusion models in population genetics with special reference to fixation time of molecular mutants under mutational pressure , in : t.  ohta , k.  aoki ( eds . ) , population genetics and molecular evolution , japan sci .",
    "soc . press / springer - verlag , 1985 , pp .",
    "1939 .",
    "j.  crow , m.  kimura , some genetic problems in natural populations , in : j.  neyman ( ed . ) , proceedings of the third berkeley symposium on mathematical statistics and probability , volume 4 , university of california press , berkeley , 1956 , pp . 122 ."
  ],
  "abstract_text": [
    "<S> we give an exact solution to the kolmogorov equation describing genetic drift for an arbitrary number of alleles at a given locus . </S>",
    "<S> this is achieved by finding a change of variable which makes the equation separable , and therefore reduces the problem with an arbitrary number of alleles to the solution of a set of equations that are essentially no more complicated than that found in the two - allele case . </S>",
    "<S> the same change of variable also renders the kolmogorov equation with the effect of mutations added separable , as long as the mutation matrix has equal entries in each row . </S>",
    "<S> thus this case can also be solved exactly for an arbitrary number of alleles . </S>",
    "<S> the general solution , which is in the form of a probability distribution , is in agreement with the previously known results  which were for the cases of two and three alleles only . </S>",
    "<S> results are also given for a wide range of other quantities of interest , such as the probabilities of extinction of various numbers of alleles , mean times to these extinctions , and the means and variances of the allele frequencies . </S>",
    "<S> to aid dissemination , these results are presented in two stages : first of all they are given without derivations and too much mathematical detail , and then subsequently derivations and a more technical discussion are provided .    ,    ,    population genetics , diffusion , kolmogorov equation , genetic drift , single - locus . </S>"
  ]
}