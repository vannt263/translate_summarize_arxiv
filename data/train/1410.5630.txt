{
  "article_text": [
    "the @xmath0 physics engine  @xcite is a software framework for simulating large - scale multi - body systems in soft and hard contact .",
    "the simulated bodies have spatial extension and their core shapes are assumed to be rigid .",
    "the software supports various numerical methods to resolve the multi - contact problems such as discrete element methods ( dem )  @xcite for soft contacts and the fast frictional dynamics ( ffd )  @xcite and non - smooth contact dynamics ( nscd )  @xcite methods for hard contacts .",
    "the physics engine was successfully used to simulate large - scale granular flows  @xcite on its own but also coupled to the walberla lattice boltzmann framework  @xcite for the simulation of particulate flows  @xcite and self propelled swimmers  @xcite .",
    "the software framework was designed from the ground up targeting distributed - memory architectures and has been shown to scale well up to the full size of today s largest supercomputers  @xcite .",
    "in particular , the ffd method qualifies well for the parallelization since the contact problems are treated in a localized manner keeping the communication amount to a minimum .",
    "the ffd method is originally based on moreau s midpoint rule , an established time - stepping scheme for simulating mechanical systems in frictional contact  @xcite .",
    "it uses a time - integrator equivalent to a leapfrog verlet integration if no contacts are present .",
    "the friction model is derived from the principle of maximal dissipation and captures essential frictional properties  @xcite .",
    "however , the contact problem simplification stemming from the localization and the special type of friction model require a thorough validation of the numerical method",
    ". this paper performs such a validation on the basis of a hard - spherocylinder system as a model for liquid crystals , where the implementation of the ffd method within the @xmath0 framework replaces conventional molecular dynamics techniques .",
    "studies of hard - spherocylinder systems date back to the 70s and the work of few and rigby  @xcite and vieillard - baron  @xcite .",
    "spherocylinders consist of a cylinder of length @xmath1 and diameter @xmath2 with hemispherical end caps . for @xmath3",
    "this model system corresponds to the hard - sphere model whereas for @xmath4 the system consists of infinitely thin needles .",
    "systems of rigid straight rods have also been realized experimentally for example in the form of tobacco mosaic viruses  @xcite and colloidal silica rods  @xcite .",
    "all phase transitions of such a system are purely driven by entropy as the hard particles interact exclusively via excluded volume .",
    "therefore , the temperature @xmath5 acts only as an energy scale .",
    "two types of entropy compete here : the orientational entropy drives the system towards an isotropic phase where both center of masses and orientations are uniformly distributed ( see fig .",
    "[ fig : snapshots]a , b ) .",
    "the second type of entropy , translational entropy , favors a uniform orientation of the particles which minimizes the excluded volume .",
    "an example of such an ordered phase is the nematic phase which is characterized by alignment of the particles with respect to each other , giving rise to an anisotropic angular distribution profile while keeping a homogeneous distribution of the center of masses ( see fig .",
    "[ fig : snapshots]c , d ) .",
    "this combination of liquid - like translational and crystal - like orientational properties which extends to many observable physical properties is also the origin of the name liquid crystal .",
    "hard - spherocylinder system in ( a ) an isotropic ( @xmath6 ) and ( c ) a nematic ( @xmath7 ) state with the corresponding angular distribution profiles ( ( b ) isotropic , ( d ) nematic ) normalized to the ideal isotropic distribution profile .",
    "( for definition of dimensionless density @xmath8 see section  [ sec : setup ] . ) the increased noise around @xmath9 and @xmath10 in ( b ) is due to the reduced statistics in this regime as the size of the solid angle bins behaves like @xmath11.,width=334 ]    for @xmath4 in the onsager limit  @xcite the hard - spherocylinder system exhibits a phase transition from isotropic to nematic at vanishing volume packing fraction ( order @xmath12 ) . for systems with a finite aspect ratio @xmath13 and full translational and rotational freedom",
    "frenkel and co - workers were the first to report such a phase transition with molecular dynamics  ( md ) and monte carlo  ( mc ) simulations  @xcite .",
    "they also discovered a crystalline solid phase and a smectic a phase where the system exhibits layering of the particles , thus having a one - dimensional positional ordering in addition to the orientational ordering . in their later work  @xcite they demonstrated that the hard - spherocylinder system indeed exhibits a rich phase diagram which depends on the aspect ratio of the particles as well as on the packing fraction , as confirmed by the studies of mcgrother et al .  .",
    "this well understood system provides an ideal test case for our simulation framework , the @xmath0 physics engine , in the context of micro - scale multi - particle systems .",
    "the massive parallelism of the @xmath0 software framework enables us to study far larger systems than those considered in the publications mentioned above . those were restricted to a few hundred particles with only a couple of exceptions which included up to a few thousand particles .",
    "we can easily simulate systems of roughly @xmath14 times that number of particles without straining the limits of computational power .",
    "this gives us the possibility to improve the confidence level of the results for the observables studied in such a hard - spherocylinder system .",
    "we focus on the the @xmath15 system at a single packing fraction in the nematic phase where the particles are rather densely packed . as it is known that equilibration and numerical treatment become difficult in this regime , these are ideal conditions for testing the power of our framework .",
    "the paper is structured as follows : section  [ sec : numerical ] describes the @xmath0 rigid body physics engine in detail and depicts both , the simulation setup , and the specifics of the model system we employ . in section  [ sec : theory ] , we elaborate on the variables we evaluate in this work , which are the order parameter , the pressure , and the frank elastic constants . we further give a short overview over their theoretical description .",
    "the results of this work are presented in section  [ sec : results ] and some conclusions are drawn in section  [ sec : conc ] .",
    "the @xmath0 physics engine is a powerful tool for large - scale rigid body dynamics simulations  @xcite .",
    "the algorithm we chose to employ in this work is based on the ffd solver first proposed by kaufman et al .",
    "@xcite , where we set all friction coefficients to zero to make our results comparable to previous studies .",
    "it is parallelized with mpi  @xcite following a domain decomposition approach : each process is responsible for the time - integration of the bodies whose center of mass is located in its associated computational subdomain . in addition to these local bodies processes obtain shadow copies of bodies intersecting their subdomain .",
    "algorithm [ algo : pe ] lists pseudo - code for the time step procedure .",
    "the time step starts by sending all forces and torques applied to shadow copies to the respective owner process of the body .",
    "the owner process can then reduce them and proceed by performing the time - integration up to the midpoint of the time step neglecting contact constraints on purpose .",
    "subsequently , the shadow copies need to be updated to the new positions and velocities and migrations of bodies to neighboring processes have to be treated in a second message exchange communication step .",
    "next , collisions are detected and filtered .",
    "some of the collisions can only be detected by processes holding shadow copies .",
    "these contact constraints are gathered in the third message exchange step at the processes responsible for the time - integration of the bodies enabling them to compute the post - collision velocities prescribed by the ffd s contact model @xcite and performing the second half of the time - integration .",
    "finally , the positions and velocities have to be synchronized again in the fourth and last message exchange communication step .",
    "particle overlaps are inherent in this algorithm and indeed collisions are only recognized if the particles intersect . splitting",
    "the time step into two half steps , one before and one after the collision resolution , ensures that after the full time step the detected overlaps have been eliminated .",
    "still , the size of the time steps has to be chosen carefully ( see sec .  [",
    "sec : setup ] ) to avoid a strong deviation from the expected hard - particle behavior due to the seemingly reduced volume packing fraction .",
    "the advantage of a fixed time step lies in the fact that time integration can be driven forward efficiently despite high collision frequencies in contrast to event - driven methods  @xcite .",
    "furthermore the code can be very efficiently parallelized as collisions are always treated locally .",
    "the model system used in this work consists of @xmath16 hard spherocylinders of unity mass with an aspect ratio @xmath15 .",
    "the unit of energy was set to @xmath17 and the unit of length to @xmath2 .",
    "the particles were enclosed in a cubical box of side length @xmath18 with periodic boundary conditions .",
    "this results in a dimensionless density of @xmath7 where the system is expected to be in the nematic phase   with @xmath19 , @xmath20 being the density in the close packing limit @xmath21 .    in the initial configuration",
    "the spherocylinders were arranged on a @xmath22 ( tetragonal ) lattice and had a uniform orientation along the x - axis .",
    "their initial velocity and angular velocity distributions were chosen randomly from gaussian distributions such that the condition @xmath23 held in our units .",
    "for reason of symmetry no angular momentum was applied around the symmetry axis of the particles , so the angular velocity is always perpendicular to this axis .",
    "the time step was set to @xmath24 where the unit of time follows directly from our choice of unit energy , unit length and unit mass : @xmath25 , with @xmath26 the mass of a spherocylinder .    to provide an upper bound on the amount of overlap between particles in a collision",
    ", we consider the worst - case scenario in which two particles already touch in a point @xmath27 at the beginning of the time step and define overlap as the surface to surface distance measured along the surface normal at @xmath27 after the first half step .",
    "if we consider only translational motion , this overlap is less than @xmath28 for all but a tiny fraction ( @xmath29 ) of all collisions at this step size .",
    "the contribution due to rotation has the same order of magnitude .",
    "this clearly justifies the assumption of a hard - particle system , considering that this scenario poses the extreme case of collision .",
    "a simple thermostat was used to correct for accumulation of numerical errors in the resolution of collisions .",
    "the total kinetic energy was rescaled to its initial value every 200 time steps by rescaling angular velocity and velocity of each particle by the same fraction .",
    "this rate of rescaling events suffices to suppress fluctuations of the kinetic energy and thereby keeping the temperature constant ( the potential energy being always zero in the hard - particle system ) .    to obtain uncorrelated results we performed six simulations with",
    "independently generated initial velocity configurations .",
    "the systems were allowed to relax for about @xmath30 time steps after which the nematic order parameter ( see sec .  [ subsec : orderparameter ] ) indicated the systems to be in equilibrium .",
    "a typical equilibration curve is shown in fig .  [ fig : equilib ] , a snapshot of the system in the nematic phase is presented in fig .",
    "[ fig : snapshots]c ) .",
    "subsequently , production runs of about @xmath31 time steps were performed the results of which are presented in sec .",
    "[ sec : results ] .    ) .",
    "after @xmath30 time steps the system is assumed to have reached equilibrium .",
    "( for definition of the order parameter  @xmath32 see eq .",
    "[ eqn : orderparam1].),width=284 ]",
    "the first parameter we use to characterize the system is the order parameter @xmath32 .",
    "it is a measure for the degree of nematic ordering in the system , i.e. , the alignment of the particles along a common direction , the nematic director @xmath33 .",
    "microscopically it is defined by the average of the second legendre polynomial of the cosine of the angle @xmath34 between the director @xmath33 and the symmetry axis of the individual spherocylinders @xmath35 : @xmath36 with the equilibrium orientational distribution function @xmath37 .",
    "@xmath38 indicates both the equilibrium ensemble average and the average over all particles in the system .    in the simulation",
    "however , the nematic director is not known a priori , thus the angular distribution with respect to this vector ca nt be measured directly . instead of @xmath37",
    "we consider therefore the order tensor @xmath39 : @xmath40 the sum goes over all particles in the system , @xmath41 being their total number , with @xmath42 the kronecker delta .",
    "this tensor can be calculated directly from the single particle orientations @xmath35 and it can be shown that its largest eigenvalue corresponds to the order parameter @xmath32 as defined above  @xcite . furthermore the associated eigenvector yields the nematic director @xmath33 .",
    "the order parameter can take values between @xmath43 and @xmath44 , a value of @xmath45 indicating an isotropic distribution of particle orientations whereas @xmath46 is reached only in the case of perfect alignment of all particles towards each other and thus towards the director .",
    "a second property of the system we evaluate is the pressure . according to the virial equation",
    "it can be calculated as @xmath47 with the usual definition @xmath48 , @xmath41 the total number of particles , @xmath49 the considered volume and @xmath50 the force exerted by particle @xmath51 on particle @xmath52 , @xmath38 indicating the equilibrium ensemble average  @xcite .",
    "the vector @xmath53 connects the center of mass positions of the two particles , i.e. , @xmath54 ( see fig .  [",
    "fig : particlepos ] ) .        for hard bodies the forces @xmath50 are not continuous as the inter - particle potential is either @xmath43 in case of no overlap or @xmath55 if the particles intersect . here",
    "the forces are substituted by the transferred momentum per unit time  @xcite : @xmath56 the sum is taken over all collisions @xmath57 within the observation time @xmath58 and @xmath59 is calculated from the difference between the velocity of particle @xmath52 before and after resolution of the contact with particle @xmath51 .",
    "the frank elastic constants @xmath60 ( @xmath61 ) describe the free energy penalty for elastic deformation",
    ". there are three types of deformation to be considered , namely , splay , twist and bend . for small deformations",
    "this additional free energy can be expressed in terms of the derivatives of the director field @xmath62 which represents the local orientation of the nematic director  @xcite : @xmath63=\\\\ \\frac{1}{2}\\int \\mathrm{d}\\vec{r}\\left(k_1(\\nabla \\cdot \\vec{n})^2+k_2(\\vec{n}\\cdot(\\nabla \\times \\vec{n}))^2+k_3(\\vec{n}\\times(\\nabla\\times\\vec{n}))^2\\right)\\end{gathered}\\ ] ] the frank constants are the proportionality constants for the contribution of the different types of deformation .",
    "@xmath64 is attributed to splay , @xmath65 to twist and @xmath66 to bend .",
    "we employ a well established method to obtain the frank constants from simulation which utilizes the fourier transform of the order tensor @xmath39 defined in section  [ subsec : orderparameter ]  @xcite .",
    "those fourier components @xmath67 @xmath68 are measured in a basis in which the 3-direction is given by the nematic director and @xmath69 lies in the 1 - 3-plane . in this coordinate system ,",
    "the components of the fourier transformed order tensor are at low @xmath70 related to the frank elastic constants via @xmath71 with @xmath72 , @xmath38 again indicating the equilibrium ensemble average  @xcite .",
    "the order parameter values were obtained every @xmath73 time steps by calculating the order tensor @xmath39 ( see eq .",
    "[ eqn : orderparam ] ) and obtaining its highest eigenvalue @xmath32 .",
    "the corresponding eigenvector , the nematic director @xmath33 , was also evaluated as it is required for the calculation of the frank elastic constants ( see section  [ subsec : resfrank ] ) . a higher sampling frequency would not have contributed further information as subsequent values in a molecular dynamics simulation are highly correlated .",
    "the nematic order parameter was obtained independently for the different initial configurations by averaging over about @xmath74 values each .",
    "averaging again over these uncorrelated values results in an average order parameter of @xmath75 .",
    "this is in very good agreement with results from earlier md and mc simulations   as well as from density functional theory studies ( dft )  @xcite ( see tab .  [ tab : frank ] ) .      in this section",
    "we present our results on the pressure in terms of the rescaled pressure @xmath76 , where @xmath77 is the molecular volume of a spherocylinder . for each of our individual initial setups we calculated the pressure by evaluating @xmath78 over the collisions within a single time step @xmath79 every @xmath80 time steps .",
    "these results were then added up , making the observation time @xmath58 equal to @xmath79 times the number of data points taken .",
    "for each of the initial configurations the pressure was calculated separately according to eq .",
    "[ eqn : pressure ] .",
    "we then took the average over the pressure values from the independent simulations , obtaining an average rescaled pressure of @xmath81 which agrees very well with the values from   ( see tab .",
    "[ tab : frank ] ) .      for the calculation of the frank elastic constants we have to take into account the fact that our system is enclosed in a box of side length @xmath82 .",
    "this allows us to consider only @xmath69 which have components that are an integer multiple of the minimal value commensurate with the box in the fixed @xmath83-system , i.e. , @xmath84 , @xmath85 . as relation [ eqn : emu ] only holds for @xmath86 , it is vital to simulate a box of large enough dimension @xmath82 to get access to @xmath70 values small enough to enter the regime where @xmath87 and @xmath88 behave linearly ; the box size chosen in this simulation proved to be sufficiently large ( see fig .  [",
    "fig : ecuts ] ) .",
    "the fourier transformed order tensor @xmath89 ( eq .  [ eqn : fourierordertens ] ) was evaluated in the @xmath83-system every @xmath73 time steps for all @xmath69 with @xmath90 .",
    "this provides access to a range of @xmath91 large enough to successfully fit the @xmath92 data .",
    "the tensor @xmath89 was subsequently transformed to the @xmath93-system given by the nematic director , calculated as described in section  [ subsec : resorderparam ] , and the currently evaluated @xmath69 .",
    "the values for @xmath94 and @xmath95 were then averaged over bins of equal size in @xmath96 and @xmath97 .",
    "the results for @xmath92 were obtained separately for the different initial configurations from @xmath98 following eq .",
    "[ eqn : emu ] .",
    "the averaged result of the different runs is shown in fig .",
    "[ fig : emu3 ] .",
    "( left ) and @xmath99 ( right ) at the lowest perpendicular @xmath91-values accounted for in the simulation , i.e. , left : @xmath100 and right : @xmath101 .",
    "solid lines indicate the polynomial fit , dashed lines originate from the planar fit , their slopes corresponding to the respective @xmath60 values .",
    "dotted lines show the slopes derived by allen and frenkel  @xcite for comparison.,width=329 ]    to get a first evaluation of the elastic constants , i.e. , the slope of the functions @xmath92 at @xmath102 , the plane @xmath103 was fitted to the respective @xmath92 data in the range of @xmath104 .",
    "cuts through the data and the corresponding fits are presented in fig .",
    "[ fig : ecuts ] .",
    "( a ) and @xmath105 ( b ) as functions of @xmath106 and @xmath99 ( black squares ) .",
    "the respective error bars in @xmath107 are smaller than the symbol size .",
    "the surfaces represent the polynomial fitting functions.,width=302 ]    to gain a more accurate estimate of the frank elastic constants , we subsequently fitted the data with bivariate polynomials in @xmath106 and @xmath99 of the form @xmath108 and evaluated their leading coefficients . the @xmath66 value gained that way is larger than the one found in the linear fit ( see tab .",
    "[ tab : frank ] ) .",
    "this indicates that the assumption of a purely linear behavior is not justified even in the range of @xmath109 .",
    "as the functions are concave in the low @xmath70 regime , a linear fit will underestimate the derivative at @xmath102 . from fig .",
    "[ fig : ecuts ] it is clear that the curvature along the @xmath99-axis sets in at far lower @xmath91 values than along the @xmath106-axis .",
    "this explains why the values we found for @xmath64 and @xmath65 agree with those derived from the linear fit within the error bars while @xmath66 exceeds the one from the linear fit by nearly @xmath110 .",
    "lcccccc & @xmath8&@xmath111&s&@xmath112&@xmath113&@xmath114 +   + & & & & & + @xmath115 planar fit for @xmath116 & & & & @xmath117&@xmath118&@xmath119 + @xmath115 polynomial fit for @xmath116 & & & & @xmath120&@xmath121 & @xmath122 +   + frenkel  @xcite & @xmath123&@xmath124 & & & & + bolhuis  @xcite & @xmath123&@xmath125 & & & & + & @xmath126&@xmath127&@xmath128 & & & + mcgrother   & @xmath129&@xmath130&@xmath131 & & & + & @xmath132&@xmath133&@xmath134 & & & + allen  @xcite & @xmath123&&@xmath135&@xmath136&@xmath137&@xmath138 + poniewierski  @xcite & @xmath123&&@xmath139&@xmath126&@xmath140&@xmath141 + somoza  @xcite & @xmath123&&@xmath142&@xmath143&@xmath144&@xmath145 + lee  @xcite & @xmath146&&@xmath147&@xmath148&@xmath149&@xmath150 +    data for @xmath111 estimated from fig.4 ref .",
    "@xcite .    all values and",
    "errors of @xmath116 have been multiplied by @xmath151 after ref .",
    "@xcite .     + the values found in literature for the frank elastic constants of this system are few and differ considerably .",
    "a summary of both md  @xcite and dft  @xcite results as well as a comparison to our findings is given in tab .",
    "[ tab : frank ] . as we have chosen the temperature and the length scale of the simulation accordingly , the rescaled results for the frank elastic constants @xmath152 correspond directly to the ones measured in the simulation .",
    "it is clear that our results are well within the range spanned by the data from previous works , showing the expected relation @xmath153 found in experiments  @xcite and predicted theoretically  @xcite .",
    "we reason the difference between our results and the simulations by allen and frenkel  @xcite to be mainly due to their smaller system size .",
    "the minimum @xmath154 they could evaluate were considerably larger than those we had access to . also they could only take the two smallest of their @xmath97 values into account during the fitting procedure as for higher values a peak in the structure factor developed .",
    "therefore they used a fitting function that was a product of a second - order polynomial in @xmath96 and a linear function in @xmath97 .",
    "if we try to fit this function to our larger data set , we find that the fit converges very poorly , no matter the @xmath69 range we restrict it to . an additional factor that might contribute to the discrepancy between the results",
    "is the fact that allen and frenkel did not correct for fluctuations of the director , although they judged those to be negligible .",
    "we have shown that the @xmath0 physics engine is able to accurately treat the liquid crystal model system comprised of hard spherocylinders with aspect ration @xmath15 .",
    "our results verify the value for the nematic order parameter at a density of @xmath155 found in earlier simulations as well as in a number of density functional theory calculations .",
    "in addition we have calculated the pressure in the system which confirms the values published for other simulation techniques .",
    "this clearly indicates that already systems with a small number of particles compared to the one studied in this work have negligible finite size effects on these two parameters .",
    "finally we have derived the frank elastic constants at our chosen system parameters . here",
    "the comparison to existing work is more difficult since there is only one set of simulation results available and the density functional theory values scatter in a broad range .",
    "however , our values certainly provide a better estimate for the elastic constants than the listed simulation data by allen and frenkel as their comparatively limited system size restricted their access to the low @xmath70-value regime considerably .",
    "the work has been partially funded by the deutsche forschungsgemeinschaft ( dfg ) through the cluster of excellence engineering of advanced materials in erlangen .",
    "41 natexlab#1#1[1]`#1 ` [ 2]#2 [ 1]#1 [ 1]http://dx.doi.org/#1 [ ] [ 1]pmid:#1 [ ] [ 2]#2 , , , ( ) . , , ph.d . thesis , technische fakultt der universitt erlangen - nrnberg , .",
    ", , , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , , , , ( ) . , , , , , in : , , pp . . .",
    ", , , , , , , , ( ) . , , ph.d .",
    "thesis , technische fakultt der universitt erlangen - nrnberg , .",
    ", , , volume , , .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , , , , , ( ) . , , ( ) .",
    ", , , , ( ) .",
    ", , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , , in : , siggraph 05 , , , , pp . .",
    "http://doi.acm.org/10.1145/1186822.1073295 . .",
    ", , , , , , .",
    ", , , ( ) . , , , .",
    ", , , ( ) . , , , , .",
    ", , , ( ) .",
    ", , ( ) . , , , ( ) . , , , ( ) .",
    ", , , , , ( ) .",
    ", , , , , , ( ) . , , , , , , ( ) . , , , .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , ( ) ."
  ],
  "abstract_text": [
    "<S> the @xmath0 physics engine is validated through the simulation of a liquid crystal model system consisting of hard spherocylinders . for this purpose </S>",
    "<S> we evaluate several characteristic parameters of this system , namely the nematic order parameter , the pressure , and the frank elastic constants . </S>",
    "<S> we compare these to the values reported in literature and find a very good agreement , which demonstrates that the @xmath0 physics engine can accurately treat such densely packed particle systems . </S>",
    "<S> simultaneously we are able to examine the influence of finite size effects , especially on the evaluation of the frank elastic constants , as we are far less restricted in system size than earlier simulations .    </S>",
    "<S> parallel framework , rigid body dynamics , hard rod , liquid crystal , frank elastic constants 07.05.tp , 61.30.-v    notice : this is the author s version of a work that was accepted for publication in computer physics communications . changes resulting from the publishing process , such as peer review , editing , corrections , structural formatting , and other quality control mechanisms may not be reflected in this document . </S>",
    "<S> changes may have been made to this work since it was submitted for publication . </S>",
    "<S> a definitive version was subsequently published in computer physics communications , [ vol 185 , issue 12 , ( 2014 ) ] doi 10.1016/j.cpc.2014.08.014 </S>"
  ]
}