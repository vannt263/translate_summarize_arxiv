{
  "article_text": [
    "radial velocities are , along with position and brightness , among the fundamental measured values of astronomy .",
    "recent technical advances are substantially increasing our ability to aquire radial velocity data ; in the decade of the 1990 s the rate at which radial velocity measurements are taken will increase by two or three orders of magnitude .",
    "substantial effort is required for these data to be reduced and analyzed in an accurate and timely fashion ; here we describe the current reduction methods which we have developed for use by the center for astrophysics radial velocity and redshift programs , as well as by others .",
    "doppler ( 1841 ) understood that radial velocities would affect the color of stars ( by analogy with the pitch of sound ) ; fizeau ( 1848 , 1870 ) first recognized that this would mean a shift in the position of the fraunhofer lines .",
    "huggins ( 1868 ) made the first ( visual ) attempt ( in 1862 ) to observe the shifts .",
    "vogel ( 1892 ) made the first accurate photographic measurements , and established most of the procedures necessary to calibrate and reduce the measurements of line positions to radial velocities .",
    "correlation methods for obtaining radial velocities were first suggested by fellgett ( 1953 ) , who was influenced by radar studies during world war ii .",
    "griffin ( 1967 ) was the first to implement these techniques .",
    "note that griffin credits evershed ( 1913 ) with inventing the basic technique ; griffin further notes that babcock ( 1955 ) had already built a similar instrument .",
    "griffin s instrument performed analog correlations by physically shifting a template spectrum in the focal plane of the spectrograph , a technique which is still in heavy use today ( e.g. baranne , et al , 1979 ) .",
    "digital power spectrum techniques for the estimation of lag have long been known ( e.g. blackman and tukey , 1958 , and references therein ) .",
    "their use first became practical with the advent of digital detectors , fast digital computers , and the fft algorithm ( cooley and tukey , 1965 ) .",
    "simkin ( 1974 ) first showed how fourier techniques could be used to obtain radial velocities and velocity dispersions from digital spectra .",
    "several groups used power spectrum techniques to obtain velocity dispersions ( see sargent , et al 1977 , and references therein ) and obtained velocities as a byproduct of their analysis , but apparently the first use of digital cross - correlation specifically to obtain radial velocities was by lacy ( 1977 ) who did not use fourier techniques , but used direct convolution with a digital mask , emulating griffin s ( 1967 ) analog technique .",
    "tonry and davis ( 1979 ; hereafter td79 ) studied the use of power spectrum techniques to obtain redshifts from digital spectra , and demonstrated the effectiveness of the method .",
    "td79 invented the @xmath2 statistic , which can be calibrated to give both the confidence and error of a measurement .",
    "the techniques and software described here are directly descended from the td79 system ; in september 1990 radial velocity reductions at the cfa were moved from the old data general nova computer where the td79 system resided onto a unix workstation and the iraf ( tody , 1986 , 1993 ) environment .",
    "we began with the iraf task xcor by g. kriss and routines from td79 , translated into fortran by j. tonry ( @xcite ) ; these were extensively modified , and resulted in * xcsao * version 1.0 ( kurtz , et al , 1992 ; paper 1 ) .",
    "additionally we used algorithms from the reduce / interact system ( @xcite ) , as modified by j. thorstensen .",
    "the emission line finding programs had a somewhat different history .",
    "when the radial velocity reductions were moved from the novas onto unix the emission line programs were implemented as stand - alone c programs translated from the forth of td79 by w. wyatt ; work began in 1991 on a new iraf task , resulting in * emsao * ( mink and wyatt , 1995 ) .",
    "the software described here has been used extensively ; examples include the redshift surveys of huchra , et al ( 1995 ) ; da costa , et al ( 1994 ) , shectman , et al ( lcrs:1996 ) , vettolani , et al ( 1997 ) , and geller , et al ( 1997 ) .",
    "stellar use revolves around the cfa digital speedometry program ( latham , 1985 ) and its many projects and collaborations .",
    "latham ( 1992 ) lists several of these projects .",
    "nordstrm , et al ( 1994 ) have described the techniques used by the cfa stellar group in detail ; we will concentrate on issues related to galaxy redshifts , although some stellar data will be used in section [ error ] on error .",
    "we will conform to the convention that _ user settable parameters _ will be in _ italics _ , parameters in the spectrum header will be in capitals , and iraf * tasknames * will be in * lowercase bold*. extensive on - line documentation , help files , and examples , as well as the source code and executables can be found at http://tdc - www.harvard.edu/.",
    "* xcsao * is the heart of the rvsao system . in this section",
    "we give an overview of the correlation system .",
    "we point out critical features which investigators need to consider when setting up the reductions for a new project , to maximize the efficiency of measurement , and minimize systematic errors .",
    "the rvsao system consists of several iraf tasks , including * xcsao * , the algorithmic details of each of them are described in appendix [ appendix ] .",
    "tokarz and roll ( 1997 ) discuss the steps we take to obtain 1-d wavelength calibrated spectra suitable for redshift measurements .",
    "once the 1-d spectra are in hand it is necessary to tell * xcsao * the wavelength range over which the data are good , using the parameters _",
    "st_lambda _ and _ end_lambda_. depending on the details of the instrumental set up substantial additional error can occur if these parameters are not set , or are set incorrectly .",
    "for example , if a substantial portion of the spectrum is from a region of the detector with little or no sensitivity , or is from a region of the spectrum with poor sky subtraction and strong night sky lines , the final redshift will be compromised .      for all spectra",
    "the continuum must be removed ; * contpars * ( see section [ contpars ] ) performs these tasks here , and was only slightly modified from the iraf onedspec * continuum * package , as implemented in the rv package ( @xcite ) .    the continuum can be subtracted or divided out .",
    "subtraction preserves the correct relative amplitudes for the lines in the data , and thus the correct signal to noise behavior in the cross - correlation .",
    "division preserves the correct equivalent widths of the lines , and thus the correct parameterization of the spectrum . for spectral classification studies division",
    "is preferred ( kurtz , 1982 ) ; for radial velocity measurements subtraction is superior .",
    "division by the continuum results in amplified noise in the blue part ( the low s / n part ) of the spectrum . for moderate s / n spectra , typical of fast , the difference between the two techniques is small , but subtraction shows smaller redshift residuals by about 25%  ; while for very high s / n spectra on fast , typical of our calibration spectra , the division method gives slightly smaller residuals .    in normal use of * xcsao",
    "* only continuum subtraction is allowed , but if the parameter divcont is set true ( t ) in the template spectrum header the continua of both the object and template spectra will be divided out .",
    "many galaxy spectra show both emission and absorption lines ; in general the redshifts derived from the emission lines will be different from the absorption line velocities . to obtain a correlation velocity from an absorption line template for a spectrum with strong emission lines",
    "it is necessary to suppress the emission lines ; figure [ emcut ] shows a typical spectrum and its correlation function with one of our standard absorption templates suppressing the emission lines and without suppressing them , the bottom panel shows the spectrum , smoothed and with the lines marked .",
    "the reduction with emission line suppression produces a believable redshift , with an @xmath2 ( td79 ) value of 4.50 , the reduction without it , where the @xmath2 value is 1.88 , does not .    removing emission lines before correlating with an absorption line template",
    "was a routine feature of the td79 software ; in * xcsao * we have extended and generalized the procedure .",
    "both emission and absorption lines may now be removed , and the process may be controlled by keywords in the template header . because we now obtain emission line velocities using correlation methods ( section [ emt ] ) , the same emission line suppression can not be used for every template .    for routine redshift reductions at the cfa we use a subset of the * xcsao * capabilities , with emission lines replaced by the continuum when we correlate against an absorption line template , and the absorption lines replaced by the continuum when we correlate against an emission line template .",
    "the exact parameters used are stored in each template , normally two sigma variations above(below ) the continuum are sufficient to remove emission(absorption ) lines , with the number of iterations and growing parameter as set in * contpars*(section [ contpars ] ) .",
    "the emission(absorption ) line suppression is controlled by the parameters _ s_emchop _ ( _ t_emchop _ ) for the object ( template ) spectra .",
    "other parameters are used as well , and when control is given to the template or object spectrum header the interactions can be complex .",
    "they are more fully described in section [ xc ] .",
    "in addition * xcsao * permits the user to replace specific regions of the spectrum with a simple linear approximation to the continuum .",
    "this feature is typically used to prevent poor subtraction of the bright night sky lines from compromising the results .      once the continuum has been removed the spectra are apodized , zero padded , and bandpass filtered .",
    "each of these operations has a substantial effect on the final results .",
    "apodization is the simplest ; essentially the goal is to remove any ringing in the fourier transform , by forcing the ends of the spectrum smoothly to zero , while suppressing as little of the actual data as possible .",
    "our apodization is performed by a cosine taper function , which begins a symmetric set percentage of the spectrum from the ends . for both fast spectra and the earlier z - machine ( latham , 1982 ) spectra 0.05",
    "is a reasonable value , i.e. the taper begins 5%  from the ends ( section [ xc ] ) .",
    "zero padding the spectrum is intended to remove any artifacts caused by computation of the correlations in fourier space , thus using a circular convolution . the primary artifact which the zero padding removes is the confusion of @xmath3 with @xmath4 due to the wrap around of the convolution .",
    "the zero padding has two side effects which must be considered .",
    "first , the relation of the td79 @xmath2 statistic with error is changed , although the actual calculated error remains correct ( section [ error ] ) .",
    "second , the envelope of noise fluctuations of the correlation function , which is flat in the non - zero padded case , is , in the zero padded case , a symmetric linear function of the number of overlapping non - zero pixels , and is maximum at the redshift of the template spectrum .",
    "for the case of low s / n spectra where the redshift is substantially different from the template s redshift this structure in the noise can result in the wrong correlation peak being chosen .",
    "zero padding can be controlled via the parameter file , or the template header .",
    "we only zero pad spectra when correlating against the emission line template .",
    "the design of the fourier bandpass filter is critical to the optimal measurement of redshifts . as with the apodization",
    "we use a cosine taper to suppress the ends of the ( in this case ) fourier spectrum .",
    "several other filter techniques were tried ( e.g. oppenheim and schafer , 1975 ) but no difference was seen for any reasonable choice of taper function ( a sharp cutoff is not reasonable because of gibbs ringing ) .",
    "in addition we tested a spectral weighting function shown by hassab and boucher ( 1979 ) to produce the maximum likelihood estimator for the lag ( radial velocity ) in the limit of infinitely wide spectra ; this weighting function had no positive effect on our results , and we have not implemented it .    removing high spatial frequency information , via a high - stop fourier filter ,",
    "is intended to increase the s / n by removing information which contains more noise than signal .",
    "the design question is where to set the high frequency turnoff ; the method we use is to examine sets of high s / n calibration spectra , e.g. our nightly exposures of ngc4486b .",
    "we correlate each of these against the best match template ( in this case ngc7331 ) , using a high pass fourier filter which filters out all the low frequency information , leaving only the high frequency noise .",
    "if the turn - on frequency is set too high , the correlations all give an incorrect redshift ; if the turn - on frequency is set too low , all correlations give the correct redshift .",
    "we choose the turn - on frequency where half the redshifts are correct and half incorrect , and set this turn - on - frequency to the turn - off frequency for our high - stop filter .",
    "this procedure gives a turn - off frequency approximately equal to that obtained by the `` optimal filter '' method of brault and white ( 1971 ) which chooses that point where the power of the signal is twice that of the photon noise .",
    "this frequency is less than half that which corresponds to the projected slit width of the fast .",
    "the high - stop filter is only used for absorption line spectra . for emission line",
    "spectra the redshifts are seriously degraded if the high spatial frequencies are removed from the data .",
    "the key word fi - flag in the template header controls the implementation of the high - stop filter .",
    "in addition , as it is possible to pre - filter the templates , to save unnecessary computing , this flag also controls whether and how to filter the templates .",
    "figure [ header ] shows all the possibilities .    removing low spatial frequency information , via a low - stop fourier filter ,",
    "is intended to remove any residual large - scale systematics which remain following the continuum suppression .",
    "essentially this can be viewed as a second continuum removal , equivalent to the continuum removal technique of lasala and kurtz ( 1985 ) , thus giving what kurtz and lasala ( 1991 ) call a `` reflattened '' spectrum .",
    "the design question is where to put the low frequency turn - on point .",
    "the difficulty with making this decision is that there is no point where excluding all information with higher spatial frequencies does not result in a redshift ( i.e. even the lowest spatial frequencies still contain accurate redshift information ) , and there is no reasonable point where suppressing more low frequency information does not result in lower residuals for high s / n sets of spectra , such as our set of ngc4486b spectra .",
    "we therefore set the low frequency turn - on point by a simple heuristic .",
    "we estimate the scale in wavelength of the broadest spectral feature useful in estimating a redshift , in the case of fast galaxy spectra this is the change in the slope of the continuum around the caii h+k lines , and we suppress those spatial frequencies which correspond to twice this scale , or greater .",
    "the remaining design decision for the fourier filter is the width of the turn - on and turn - off ramps .",
    "it may be expected that this is only important at the low frequency turn - on point , as the power there is typically two orders of magnitude above the high frequency turn - off point .",
    "the problem is that if the turn - on is too sharp , gibbs ringing will be introduced into the data . a full turn - on width of 1.5%  of the width of the power spectrum is sufficient to ameliorate this effect .",
    "the exact filter implemented , especially the exact implementation of the low - stop filter , affects the resulting redshifts , their errors , and the relation of the td79 @xmath2 statistic with their errors .",
    "for example , for the set of ngc4486b spectra , the mean redshift obtained using only the lowest spatial frequencies which we include in our standard filter differs from the mean redshift obtained by only using the highest included spatial frequencies by @xmath5 , and different reasonable choices for the fourier filter can give redshifts which differ in the mean by @xmath6 . these differences may be compared with a typical variation about the mean of @xmath7 .",
    "the sign and amplitude of this effect changes with each object - template pair , ngc4486b vs. ngc7331 is a typical result .",
    "in addition the relation of the td79 @xmath2 statistic with error depends on the filter ( section [ error ] ) .",
    "the cross correlation is the normal product of the fourier transform of the object spectrum with the conjugate of the transform of the template spectrum , as described in td79 .    the object spectrum and the template spectra need to be pairwise rebinned to have a common dispersion .",
    "the number of bins _ nbins _ is set by the user and must be a power of two ; we recommend that _",
    "nbins _ always be larger than the number of observed pixels .",
    "the spectral region rebinned is set to obtain the maximum overlap between the template spectrum and the portion of the object spectrum between _",
    "st_lambda _ and _ end_lambda _ in the rest frame . on the first",
    "pass the rest frame is determined by a user guess to the redshift ( _ czguess _ ) , or from a previous reduction ( section [ xc ] ) . on subsequent passes",
    "( if _ nzpass_@xmath80 ) the rest frame is determined from the redshift obtained in the previous pass .",
    "we recommend that _ czguess _ be set to the approximate redshift expected ( normally a better guess than zero ) , and _ nzpass_@xmath92 .",
    "next the correlation peak is determined and fit ( section [ xc ] ) .",
    "the type of fit ( _ pkmode _ ) has little effect on the result , but the amount of the peak which is fit , _ pkfrac _ , is critical .",
    "the fit is performed from the top of the peak down to where the peak is _ pkfrac _ of the maximum , thus more of the peak is fit if _",
    "pkfrac_@xmath90.5 than if _ pkfrac_@xmath90.7 .",
    "because of side - lobes in the correlation function due to the proximity of nii to h@xmath10 , emission line correlation peaks can not be fit as far down the peak as absorption line correlations .",
    "the template header parameter peakfrac overrides _",
    "pkfrac _ on a template by template basis ; we use this to set the fit parameters for the emission line templates .",
    "there are three main questions concerning the output of xcsao : are the results reliable , can the process be automated ? what is the size and nature ( random or systematic ) of the error ? and",
    ", does what is measured correspond to the physical property the investigator wants to measure ?      to answer the first two of these questions we use a dataset designed for this purpose ; it contains 626 pairs of spectra observed with the fast spectrograph between 1994 and 1996 .",
    "each pair consists of two independent observations of the same object ; about half of these were observed to calibrate the velocity errors for the 15r survey ( geller , et al .",
    "1998 ) , and about half are spectra which were below the quality standard , and required a second integration ( these would be summed in our normal reductions , but not here ) .",
    "all these spectra have been subjected to our normal processing ( tokarz and roll , 1996 ) , and thus have had most of the cosmic rays removed by a labor intensive process .",
    "as discussed by td79 , the @xmath2 statistic can be calibrated as a confidence measure .",
    "we prefer to calibrate it empirically , rather than use the prescription in td79 .",
    "figure [ blunders ] shows the results of correlating each of the 1252 spectra against each of two templates . plotted",
    "are the absolute value of the velocity difference between the two observations versus the minimum @xmath2 value for each pair .",
    "each pair appears on the graph twice .",
    "the open circles are measurements using the ngc7331 template , and the filled triangles use an emission line template , emtemp .",
    "figure [ blunders ] shows two groupings , those with the absolute velocity difference @xmath11 ; which we will assume are reliable observations ( differences @xmath12 are consistent with the expected random errors ) , and those where the velocity difference is greater , which we will assume unreliable . for the moment we will adopt an @xmath2 value of 3.0 ( @xmath13 ) , above which we expect the velocity determination to be reliable",
    "this is lower than is typically used for fast reductions .",
    "we would then expect no points in the upper right quadrant of the plot , where @xmath14 , and the @xmath15 300 @xmath16 ; however there are , 15 points in what we will call the `` blunder '' region",
    ".    we will examine each point to determine which rules would catch the blunders in a fully automated reduction .",
    "the two nearly co - incident circles ( circles are reductions with the ngc7331 template ) at @xmath17 and velocity difference about @xmath18 are both objects with strong emission lines .",
    "it is known that the ngc7331 template systematically returns velocities of @xmath19 for some emission line objects , so along with the high @xmath2 value emission line velocity these measures could be discarded automatically .",
    "the circle at @xmath20 is also an object with strong emission lines .",
    "a simple rule which requires that spectra with discordant , but otherwise valid velocities be checked manually would catch this , but the reduction could not be fully automatic .    the four triangles ( triangles are the emission line template ) between @xmath21 and @xmath22 having a @xmath23 all have good absorption line velocities , and would be caught by the rule of discordance .",
    "they would be caught by another rule , however , one which does not require that the absorption line velocity be `` good ; '' they are all spectra where nii 6583  is stronger than @xmath3 , and the difference with the absorption line templates is about @xmath24 .",
    "we adopt the rule that all emission line velocities which differ from an absorption line velocity ( even if one with a low @xmath2 value ) by about @xmath24 must be checked manually .",
    "the circle near @xmath25 and @xmath26 is probably not a real blunder .",
    "examination of the poss prints shows that the object has two nucleii with @xmath27 separation .",
    "we assume that the velocity difference is real , and that the two observations of this object each correspond to a different nucleus .",
    "all of the seven remaining objects in the `` blunder '' region of the plot are emission line velocities .",
    "one has the night sky line at 5577  mistaken for oii 5007 ; we can eliminate this error by either turning the badlines removal feature on to replace the region around 5577  with the continuum , or by adopting the rule that all emission line redshifts near @xmath28 be examined manually .",
    "the remaining six are all spectra contaminated by cosmic rays .",
    "five of these would be tagged by the rule of discordance , and the sixth has an absorption line @xmath2 value of 2.77 , so it would be tagged by only a slightly more stringent rule of discordance ; it can not be assumed , however , that the cosmic ray problem can be solved by looking for absorption lines .",
    "we therefore require that emission line redshifts must all be checked using * emsao * ( section [ emsao ] ) , and that at least four lines must be found which correspond to the correlation velocity , and at least two must be fit ; `` blunders '' are made when only three lines are found , or only one line is fit . using that criterion all six spectra",
    "would be tagged for visual inspection as well as 30 of the 178 emission line velocities ( @xmath29 ) which do not have a confirming absorption line velocity with @xmath29 .",
    "for the 610 objects ( of 626 total objects observed ) where at least one of the two different template reductions gave a result with @xmath29 , xcsao yielded the correct result with no further problem for 595 .",
    "of the remaining 15 spectra 12 are easily discovered because two valid redshift measures disagree ; one is probably caused by source confusion on the sky , and two are found by * emsao*.    looking at figure [ blunders ] , it is clear that many spectra where @xmath30 do indeed give the correct redshift . of the 16 objects which have neither emission nor absorption reduction with @xmath29 four have both emission and absorption redshifts equal ( within normal errors ) and could be accepted ( we do not currently do this ) . also 66 spectra where the emission line @xmath2 value is @xmath31 have confirming absorption line velocities with @xmath30 ; if these are assumed correct ( which we also do not currently do ) , then the number of emission line spectra which must be visually inspected after * emsao * would drop from 30 to 19 .",
    "this would bring the total number which require visual inspection to 31 , or 5%  .    with the aid of * emsao * for quality control , and partial manual reduction of 31 spectra , * xcsao * obtained the correct redshift for all 614 objects which yielded redshifts , save for the one object which was probably an observational error .",
    "a second experiment was made using 8606 emission line spectra from the z - machine archive , which had @xmath2 values with the emission line template above 3 .",
    "the results of the correlation with the emission line template were compared with the stored redshift in the archive , which was obtained by manually fitting the emission lines with a precursor program to * emsao*. after sifting the results using rules like those described above fifteen spectra ( 0.2%  ) had the wrong redshift ; essentially all these spectra were the victims of very poor sky subtraction .",
    "this may be compared with the twenty - four spectra where the redshifts were incorrectly listed in the archive .",
    "the z - machine spectra were substantially noisier than the fast spectra ; nearly 15%  failed the sifting and would have had to be manually reduced .",
    "used carefully the rvsao suite provides redshifts with a very low blunder rate .",
    "the automation rate obtainable with rvsao is strongly affected by the s / n of the observations .",
    "absorption line objects must be observed long enough to have a fully reliable absorption correlation velocity ( we currently use @xmath32 , which is conservative ) or a confirming weak emission velocity .",
    "emission line spectra must have a confirming weak absorption redshift , or be based on at least four lines , and at least two of the four must be fit by * emsao * ( section [ emt ] ) .",
    "besides estimating the redshift of a spectrum * xcsao * also estimates the error in the redshift .",
    "the error estimator can be derived analytically following the discussion in section iii.c.i of td79 with the additional assumption of sinusoidal noise , with the halfwidth of the sinusoid equal to the halfwidth of the correlation peak .",
    "the derived error estimator is :    @xmath33    where @xmath34 is the error in a single velocity measurement by * xcsao * , @xmath35 is the fwhm of the correlation peak , and @xmath2 is as defined in td79 .    while the assumption of sinusoidal noise with halfwidth equal to the correlation peak s halfwidth is reasonable",
    ", there is no compelling argument for this assumption .",
    "therefore it is necessary to demonstrate the effectiveness of the approximation by experiment .",
    "we will use four datasets to examine the behavior of the error estimator : the 610 duplicates described above ; the 8606 z - machine emission line spectra described above ; 7810 synthetic spectra , each identically poisson sampled from a 45  section of a model atmosphere for a 5500k dwarf star ( kurucz , 1992 ) , taken from the set of synthetic stellar templates used by the cfa digital speedometry program ( morse , et al 1991 ; nordstrm , et al 1994 ) ; 50000 synthetic spectra , using the same 5500k dwarf star template , each with a different number of simulated photons ( we confine ourselves to using the 49880 spectra which , when correlated against the synthetic template , achieved @xmath29 )",
    ".    first we will look at the set of duplicate spectra .",
    "we will limit ourselves to cases where both reductions have @xmath2 values @xmath36 .",
    "this is @xmath37 spectra for the two absorption line combinations , and 297 for the emission line comparison .",
    "figure [ fvelhisto ] shows a typical result .",
    "the solid line shows a histogram of the absolute values of the differences between two observations of the same object , both reduced in the same way using the ngc7331 template , and divided by the sum in quadrature of the errors calculated by * xcsao * for the reductions . the dotted histogram is the expected gaussian distribution",
    "; it is clearly broader than the data .",
    "* xcsao * overestimated the error by @xmath38 .",
    "figure [ zvelhisto ] is similar to figure [ fvelhisto ] .",
    "here the ztemp template was used on the fast data ; ztemp is a combination of bright galaxy spectra taken with the z - machine , and in use at the cfa since the days of td79 .",
    "ztemp has a restricted wavelength coverage ( @xmath39 45006200  ) compared with the fast spectra , has a different resolution , and has different residual systematics . in figure [ zvelhisto ] the ( dotted )",
    "gaussian is narrower than the ( solid ) data .",
    "* xcsao * underestimated the error by @xmath38 .",
    "figure [ evelhisto ] shows a similar set of histograms for the emission line template , emtemp .",
    "emtemp is a synthetic spectrum made before the creation of the * linespec * task ( section [ linespec ] ) to match fast emission line galaxy spectra . here",
    "the solid line which represents the data can not be transformed to match the dotted line expected histogram by any multiplicative process ( 1.2 would be the best multiplicative factor ) ; it would still have more power in the tail . adding 15 @xmath16 in quadrature helps remove power from the tail .",
    "td79 , while giving a procedure to calculate the error , suggest that in practice the error be calculated by calibrating @xmath40 in the equation @xmath41 using external comparisons .",
    "paper 1 reiterates this suggestion , noting that the measurement of @xmath35 has error , but when all reduction parameters remain fixed , @xmath35 is essentially constant",
    ". figure ii of paper 1 shows the effect of changing one of the reduction parameters ( the low frequency roll off of the fourier filter ) , which substantially changes the relation of @xmath42 to error , while @xmath35 scales correctly so that @xmath43 still tracks the error .    given a set of duplicate observations",
    "the constant @xmath40 can be determined by _ internal _ comparisons .",
    "the procedure is simply to vary @xmath40 until the expected differences histogram matches the measured one . for the present case",
    "we obtain @xmath44 , @xmath45 , and @xmath46 .",
    "figures [ fkvelhisto ] , [ zkvelhisto ] , and [ ekvelhisto ] show the distributions compared with the expected gaussians ; as expected , in all cases the fit is better than with the unmodified * xcsao * errors . for large observing programs with stable reduction procedures , we recommend using calibrated @xmath47 relations to estimate the error",
    ".    the duplicate spectra , as is typical of redshift survey data , do not show a very large range of s / n , or @xmath2 value .",
    "this is due to the fact that one normally observes long enough to get a desired s / n , and no longer .",
    "if we continue to restrict the duplicate pairs to those where both spectra achieved @xmath48 ( still lower than is normally required for a fast redshift ) then it is not possible here to use the goodness of fit to a gaussian to prove that the error calculated by using @xmath49 is any better than a constant error , for each template .",
    "if the error were dominated by systematics one would expect the error to be approximately constant .",
    "we define a measure of error @xmath50 .",
    "we then vary the values of @xmath51 and @xmath52 and calculate the residuals of the fits to a gaussian .",
    "note that @xmath51 is @xmath53 times the error in a single measurement .",
    "figure [ emcontour ] shows the results for the duplicate pairs reduced with emtemp .",
    "the contours represent lines of equal residuals in the fit to a gaussian , in the @xmath54 space .",
    "the outer contour is 20%  larger than the inner contour . clearly either a fully systematic or a fully statistical error is consistent with the data .",
    "figure [ n7contour ] shows the same diagram for the n7331 template .",
    "the inner contour level here represents an absolute error half that of emtemp , and the outer level is 33%  larger than the inner level . also here",
    "one can not rule out either a fully systematic or a fully statistical error .",
    "in many cases it is not possible to reduce hundreds of duplicate measurements using exactly the same reduction procedures to obtain an improved error estimator ; in these cases the * xcsao * error estimator is a reasonable choice .",
    "the 20%  systematic deviations for the two absorption line galaxy templates are the largest we have seen , although quintana , et al .",
    "( 1996 ) suggest that for their data the error is underestimated by @xmath55 , by comparison with external measurements . while the * xcsao * error estimator differs systematically from the true error for a particular combination of instrumental set - up , reduction procedure , and template we have not seen any trend for this to be a systematic over or under estimate .",
    "while the 8606 z - machine emission line spectra can not be used to calibrate the error estimator , as to first order we are just comparing the differences in two different methods of fitting h@xmath10 in the same spectrum , we can use them to look at any differences in zero point , as a function of the fitting method . the mean difference between the correlation velocity and the velocity obtained by the semi - automated linefits",
    "is @xmath56 .",
    "the 7810 synthetic spectra are each correlated against the template from which they were identically randomly poisson sampled ; thus there is no spectral type difference adding to the errors .",
    "figure [ g5 ] shows the template , a typical sampled spectrum , and a smoothed version of the typical spectrum . by calculating the rms velocity about the expected velocity ( @xmath57 ) we have a very accurate measure of the error in a single measurement ;",
    "the mean error calculated by * xcsao * is 3%  greater than this .",
    "the distribution of velocities is essentially gaussian , and the deviation of the mean velocity is within @xmath58 of zero .    using the 7810 spectra we can ask the question : `` how many independent measurements of a spectrum are required to obtain a better measure of the error in a single measurement than * xcsao * provides ? '' nordstrm , et al ( 1994 ) , on the basis of a study of echelle spectra of rotating f stars give this answer as @xmath59 . here",
    "we take as many independent sets of n spectra as exist in 7810 spectra , for each n we calculate the sample standard deviation about the sample mean , and we compare it with the known error gotten by using all 7810 velocities .",
    "the rms of this difference is plotted as a function of n in figure [ error_est ] . also plotted ( as a straight line )",
    "is the rms of the * xcsao * error estimate about the true error . in this ideal case",
    "more than 30 independent measures are required before a better error estimate is reached than the * xcsao * error .",
    "the 50,000 synthetic spectra , with 1 to 50,000 counts , give similar results .",
    "the mean error is underestimated here by 8%  , and the mean velocity is 1.1 @xmath60 different from zero , using the 49880 spectra where @xmath29 .",
    "the efficiency of @xmath42 in estimating signal to noise is demonstrated in figure [ rootn ] ; here we show the ratio of the square root of the number of counts to the best fit linear relation with @xmath42 .",
    "the @xmath58 scatter is @xmath61 , independent of n ; this puts a limit on the inherent ability to estimate errors using @xmath42 .",
    "there are many factors which can cause the redshifts and radial velocitys measured by * xcsao * to be other than those desired . here",
    "we list several .",
    "errors in the wavelength calibration . for absorption line",
    "spectra , where the signal is averaged over all the lines in a complex spectrum , this effect should be tiny . for emission line spectra , where the signal comes from a couple of lines this effect could be as large as the error in the pixel to wavelength calibration function . for typical fast galaxy spectra",
    "this error is @xmath62 averaged over the entire wavelength range , it could be larger in small regions ( section [ zero ] ) .    \\2 .",
    "offsets in the calibration lamp illumination .",
    "the light from the calibration lamps does not follow the same exact optical path as the light from the sky . this can cause systematic errors in the wavelength scale ( section [ sky ] ) .",
    "variations with the fourier filter .",
    "as noted above ( section [ filt ] ) different reasonable choices of the fourier filter can change the measured velocity of a typical fast galaxy spectrum by @xmath63 , comparable to the error in our highest s / n observations .",
    "unreasonable choices for the filter parameters can make more of a difference .",
    "spectral type mismatch .",
    "it has long been known that there are systematic velocity effects when the template spectrum does not match the observed spectrum .",
    "nordstrm , et al .",
    "( 1994 ) , for example , show the effect of rotational velocity mismatch for their echelle spectra . for typical fast galaxy spectra this effect is @xmath64 , and is discussed in section [ zero ] .",
    "hii regions in spiral galaxies .",
    "the rotation velocities of disks and the finite number of hii regions on the slit can combine to yield an @xmath65 velocity which is different from the mean velocity of the stars in the bulge ; this is especially true for galaxies which are distorted .",
    "thus , while the measurement error in an emission line velocity for a particular galaxy may be substantially smaller than for the absorption line velocity , the systematic deviation from the desired quantity , the cosmological redshift , may be substantially larger .",
    "two - lined systems .",
    "* xcsao * assumes that the template spectrum is a reasonable spectral match to the observed spectrum .",
    "for the case of two ( or more ) lined spectroscopic binaries this condition is clearly violated . as demonstrated by latham , et al .",
    "( 1996 ) substantially improved results may be obtained by using methods which explicitly model the two lined case , such as todcor ( zucker and mazeh , 1994 ) .",
    "* xcsao * may be used to obtain the input data for todcor .",
    "accurate redshifts require the existence of very high signal - to - noise templates , which have well determined velocities , and are good matches to the scientific program objects being measured . here",
    "we describe methods of creating and maintaining systems of templates .",
    "templates must be very high signal to noise spectra ; there are two basic ways to create them : 1 ) sum a number of observations ; 2 ) build a computer model of a spectrum .",
    "the cfa digital speedometry group has , over the past decade , switched entirely from using observed spectra to models ( see latham , et al , 1996 and references therein for details ) . for galaxy redshift studies we use both techniques .",
    "the vast majority of nearby galaxies can be well matched by a typical absorption line spectrum ( like ngc7331 ) , by a typical emission line spectrum , or both .",
    "unusual spectra , as one obtains for qsos , h@xmath66 strong galaxies , galaxies with extremely high or low internal velocity dispersions , etc .",
    "require special templates ; although in most cases special templates only lower the error in the redshift ; the correct redshift is normally obtained using standard templates .",
    "creating templates is an iterative process : good templates are required as a prerequisite for making better templates .",
    "new templates were made for fast when it saw first light , and again when it received a new thinned ccd in september 1994 . in 1997 ,",
    "sufficient new observations having been made , we were able to make a set of substantially improved templates .",
    "until 1995 , redshifts for emission line galaxies were obtained with * emsao * and its precursor programs .",
    "then a template was made by placing gaussians with approximately correct line widths and line ratios at the emission line rest wavelengths .",
    "this template , emtemp , was tested against existing fast observations , and against the z - machine archive .",
    "typical results are for the z - machine comparison with 8606 emission line spectra reduced by hand : the @xmath67 difference is @xmath68 , about half of the calculated error for a typical z - machine emission line velocity . as noted above the zero point offset is @xmath69 , about a two hundredth of a pixel .",
    "the median difference of 3929 fast spectra with @xmath70 and the @xmath71 velocity obtained by * emsao * is @xmath72 .    essentially for all spectra",
    "where * emsao * can obtain a redshift * xcsao * obtains a redshift using emtemp . for low s",
    "/ n spectra * xcsao * plus emtemp is much more sensitive than * emsao*. for a sample of 2088 emission line galaxy spectra taken with fast only 42%of spectra where * xcsao * plus emtemp obtained a redshift with @xmath73 could be reduced automatically using * emsao * , 64%  for @xmath74 , and 93%  for @xmath75 . as noted above the systematic effect of cosmic rays places severe constraints on the unsupervised use of * xcsao * with an emission line template .    to make a better emission line template we have taken 6498 fast spectra where @xmath75 , put them through * emsao * , and obtained 434 spectra where * emsao * found 9 or more lines . for these we measured the ratio of line heights with the sii 6731line , and the line widths for each line .",
    "then for each line we took the median of these quantities , and , along with the laboratory rest wavelengths for the lines put the data into the program * linespec * to produce a synthetic template which we call femtemp97 ( figure [ femtemp97 ] ) .",
    "femtemp97 is indeed a better template than emtemp . using the set of 626 duplicate spectra described in section [ rel ]",
    ", we can compare the velocity differences between pairs directly ; the median difference using femtemp97 is @xmath76 smaller than in the reduction using emtemp .",
    "the errors for femtemp97 are more gaussian than for emtemp ; figure [ femcontour ] shows the fit to the two parameter error model ( section [ est ] ) , and may be compared with figure [ emcontour ] .",
    "the interior contour level here is half that in figure [ emcontour ] .",
    "also note that the y intercept is about @xmath77 , substantially less than the @xmath78 in figure [ emcontour ] , implying a greater reduction in error than the direct comparison of velocity differences would indicate .",
    "the median ratio @xmath79 ; femtemp97 yields good velocities for a substantial number of spectra where emtemp fails .",
    "a comparison of @xmath80 with the @xmath81 error estimator shows that @xmath82 underestimates the error by 9%  .",
    "the first absorption line templates used on the fast data were the td79 vintage ztemp , and the ngc4486b template from the mmt spectrograph , as well as some secondary mmt templates . over the next year a program of template observations provided several high s / n observations of candidate templates .",
    "these were summed on an object by object basis , to form extremely high s / n templates .",
    "the best of these is the ngc7331 template ( fn7331temp ) ( section [ rel ] ) .",
    "we are now in a position to create a better template . using fn7331temp and femtemp97",
    ", we selected galaxy spectra where the @xmath2 value for the reduction with fn7331temp was greater than eight , and the @xmath2 value for the reduction with femtemp97 was less than 3 .",
    "these are 1959 moderate to high s / n absorption line spectra .",
    "this set of spectra still contains spectra of objects with substantial emission .",
    "ngc7331 shows clear emission in the nii 6583  line , for example .",
    "we examined the differences between the velocities derived using fn7331temp and femtemp97 , where ( 1 ) the difference was near zero , meaning that there was enough emission present to get a correct redshift ( about 100 spectra ) and where ( 2 ) the difference was near @xmath83 , meaning that nii 6583  was confused with @xmath84 ( about 300 spectra ) ; we removed those spectra from the sample .",
    "the remaining 1489 spectra were shifted to a common rest velocity , using the fn7331temp velocity ; they were normalized to the same number of counts ; their continua were subtracted , using a moderate order spline ; and finally they were summed .",
    "the * sumspec * task ( section [ sumspec ] ) performed these tasks .",
    "the resulting spectrum had its residual continuum subtracted using a high order spline , and was normalized to represent the average spectrum .",
    "this is the final new absorption line fast template , fabtemp97 , shown in figure [ fabtemp97 ] .",
    "fabtemp97 is a better template than fn7331temp .",
    "the median difference between pairs of spectra from the 628 duplicates of section [ rel ] is actually @xmath85 larger ( insignificant ) using fabtemp97 , because fn7331temp is better able to match emission line objects ( it has nii visibly in emission , and other lines buried in the noise ) ; if one restricts the comparison to pairs of spectra where @xmath86 for each spectrum , fabtemp97 shows a median difference @xmath87 smaller than fn7331temp . as with the comparison of femtemp97 and emtemp , the differences between the new and the old templates are not large .",
    "figure [ fabcontour ] shows the fit to the two parameter error model in section [ est ] ( compare with figure [ n7contour ] for fn7331temp ) .",
    "the contours in figure [ fabcontour ] are the same as in figure [ n7contour ] ; note that even the outer contour does not reach the y axis .",
    "this suggests that the error for these spectra can not be modeled by a single number , @xmath51 , independent of @xmath2 ; this is not true for fn7331temp , or for the emission line templates .",
    "a comparison of @xmath88 with the @xmath89 error estimator shows that @xmath89 overestimates the error by 4%  .",
    "the analyses of the four templates , shown in figures [ emcontour ] , [ n7contour ] , [ femcontour ] , and [ fabcontour ] all are consistent with a model where @xmath90 constant systematic error is combined with a statistical error determined by the value of the @xmath2 statistic .",
    "we also attempted to make a template for narrow lined absorption line objects .",
    "we built a template by summing , after shifting to a common rest frame , several high s / n spectra from a set of m31 globular clusters ; we call this template fglotemp .",
    "next we extracted from the fast database all spectra where @xmath91 and @xmath92 and @xmath93 .",
    "more than 90%  of these spectra were calibration stars ; we excluded them , and the globular clusters themselves , and were left with @xmath94 galaxy spectra . these we shifted and summed with * sumspec * in the same manner as for fabtemp97 , giving us a new narrowlined template .",
    "this template and fabtemp97 were correlated against the 300 spectra .",
    "there was no significant difference in the results .",
    "from this we conclude that for typical redshift survey spectra , from a spectrograph with resolution @xmath95 there is no need to have a narrow lined template .",
    "we have developed a new methodology for defining the velocity zero point .",
    "previous methods have depended on external calibrators , such as 21 cm measurements ; our new methods are fully internal , and should minimize velocity offsets due to spectral type differences .",
    "figure [ spdiff ] illustrates the problem with spectral type difference . with the fast spectrograph we observed m31 on 116 occasions , and ngc 4486b on 75 occasions .",
    "each of these spectra was reduced using ztemp and fn7331temp .",
    "the resulting velocities were shifted so that , for each galaxy , the median redshift obtained by using the ztemp template was zero .",
    "the bottom panel of figure [ spdiff ] shows the results for m31 ; the solid histogram shows the result of correlating the 116 spectra with fn7331temp , the dotted histogram shows the result of correlating these spectra with ztemp .",
    "similarly , the top panel of figure [ spdiff ] shows the results for ngc 4486b , with the solid histogram representing 75 fn7331temp correlations , and the dotted histogram 75 ztemp correlations .",
    "no change in the zero point of either template can make both sets of histograms agree ; any setting of the zero point by matching velocities for one object would make the systematic difference between different template reductions for the other object worse .",
    "we choose to define the zero point of our velocity system to minimize the systematic difference between the two main types of galaxy spectra : emission line spectra and absorption line spectra .",
    "to insure that our internal procedure matches the `` true '' system we need only make the reasonable assumption that we accurately know the rest velocities of the main spectral lines in galaxies , such as @xmath3 and [ o iii ]",
    ". we must also be certain that the internal wavelength system of the spectrograph matches the external wavelength system of the sky ( section [ sky ] ) .",
    "our basic procedure is to force the median difference between the emission line velocity and the absorption line velocity , for those galaxies which strongly show both sets of features , to zero .",
    "because the absorption line velocity comes from the k giant stars in the bulge , primarily , while the emission line velocity comes mainly from hii regions in the disk , which are moving at @xmath96 with respect to the central bulge , there is no reason to expect that the absorption line velocity and the emission line velocity should be the same for any particular object .",
    "these differences should be randomly distributed about zero , however .",
    "we began by setting the velocity for the fn7331temp template so that the median velocity difference between the fn7331temp velocity and the femtemp97 velocity , for spectra where @xmath97 and @xmath98 was identically zero .",
    "this yields a velocity of @xmath99 for ngc 7331 , which may be compared with @xmath100 from the 21 cm observations ( @xcite ) .",
    "as described in section [ abt ] , fabtemp97 was created by shifting 1489 spectra to the rest frame defined by their individual correlations with fn7331temp , then summing them .",
    "a comparison of fabtemp97 velocities with emission line velocities should give an indication of the stability of the zero point technique .",
    "figure [ fabvfem ] shows the difference in velocities between fabtemp97 and femtemp97 as a function of observation date , for 1787 fast spectra where @xmath97 and @xmath101 .",
    "the median difference is @xmath102 , with an interquartile range of @xmath103 . selecting subsets of the spectra with higher s",
    "/ n ratios has no significant effect on this result .",
    "this difference is @xmath104 pixel , and is probably due to systematic , non - linear errors in our wavelength scale .",
    "figure [ fabha ] shows the difference between the fabtemp97 velocity and the velocity found by fitting @xmath3 in emsao for a representative subset of the data .",
    "the median difference is @xmath105 , consistent with zero .",
    "figure [ femha ] shows the difference between the femtemp97 velocity and the @xmath3 velocity , @xmath106 , and figure [ femo3 ] shows the difference between the femtemp97 velocity and the [ oiii ] 5007velocity , @xmath107 .",
    "these differences are very similar to the median differences between individual lines measured in the same spectrum with emsao , figure [ fhao3 ] shows the difference between fits to h@xmath10 and fits to o[iii ] , the median difference is @xmath108 .    we conclude that our construction of fabtemp97 gives a velocity zero point equal to the velocity zero point of the emission line system ; this equivalence is as accurate as our ability to define the wavelength system using standard lamps and polynomial fits .",
    "before 1995 , we measured redshifts for emission line spectra using * emsao*. now we cross - correlate against an emission line template with * xcsao * ( section [ emt ] ) .",
    "* emsao * is used to check for errors in emission - line correlations , to interactively reduce emission - line spectra , to automatically measure equivalent widths , line heights , and line widths for sets of emission line spectra , and to do various custom projects using alternate line lists ( e.g. to study qsos ) .",
    "we used * emsao * to calibrate the z - machine and fast spectrographs for stability and zero point by measuring the apparent velocity of the night sky lines .",
    "these are from forbidden oxygen airglow lines from the upper atmosphere and mercury and sodium emission from artificial sources such as street lights .",
    "sodium is a blended doublet and we do not know the effective wavelength _ a priori _ ; so we can not use it to establish a zero point . using the zero point defined by o[i ]",
    "5577  we measure an effective wavelength of 5891.2  using fast , with the z - machine data in agreement .",
    "we also obtain a systematic difference between the oxygen airglow lines and the mercury streetlamp lines of about @xmath109 with both spectrographs .",
    "we assume that this effect is due to differences between the effective wavelengths of hg in streetlamps and calibration lamps .",
    "we therefore choose to calibrate our zero points with the oxygen airglow lines .",
    "figure [ zsky ] shows the results for the z - machine .",
    "the top panel is a typical sky spectrum , the middle panel shows the apparent velocity of the o[i ] 5577  line , and the bottom panel shows the apparent velocity of o[i ] 6300  .",
    "the velocities are shown as a function of observation date , over 15 years .",
    "each point is the median of a single nights observations ; nights with fewer than 10 observations were excluded .",
    "the night sky emission lines were routinely used to supplement the henear calibration lamp lines in the z - machine reductions , and a seventh order polynomial was used to fit the lines .",
    "the o[i ] 5577line does not show the same general pattern as the o[i ] 6300  line .",
    "all the other lines ( hg 5461 , nad , o[i ] 6363 ) do show the same behavior as the o[i ] 6300 line .",
    "o[i ] 5577  is in a portion of the spectrum with no strong henear calibration lines , which , along with the high order polynomial , locally matches the calibration to the position of o[i ] , instead of the system defined by the calibration lamp .    while the o[i ]",
    "line at 6300  was also used in the wavelength calibration , it is in a region with many strong ne lines , and should have negligible effect on that calibration .",
    "the apparent velocity of this line should be a good measure of the difference between the instrumental zero point and the true sky . the scatter and long - term changes in this line measure the stability of the instrument and data reduction procedures .",
    "many of the large jumps in apparent velocity can be attributed to known hardware changes ; the largest feature in figure [ zsky ] , the 5.5 year slow increase in velocity of o[i ] 6300  from @xmath110 to @xmath111 is of unknown origin .",
    "figure [ fsky ] shows the results for fast .",
    "again the top is a typical sky spectrum , the middle shows the apparent velocity of the o[i ] 5577  line , and the bottom the apparent velocity of the o[i ] 6300  line .",
    "the abscissa covers four years , and the scale of the ordinate is half that of figure [ zsky ] .    the night",
    "sky lines are not used in the wavelength calibration of fast , and the henearfe calibration lamp lines are fit with a third order polynomial . both o[i ] 5577  and o[i ] 6300  should be good measures of the instrumental zero point and the stability of the instrument and reduction techniques .",
    "both lines show essentially the same behavior , especially since the ccd was changed in september 1994 .",
    "the scatter in these line positions is less than 20%  of the scatter for the same lines in the z - machine . over the four years of fast operation an additive",
    "offset of @xmath112 brings the instrumental system into agreement with the true system of the sky .",
    "fast is a remarkably stable instrument .",
    "the scatter in the o[i ] 5577  line can provide a good measure of the errors due to a combination of instrumental instability , wavelength calibration , and line fitting . we measure the error in fitting a single line by dividing the scatter in the apparent velocity difference between o[i ] 6300  and o[i ] 6363  by @xmath53 . subtracting it in quadrature from the scatter in o[i ] 5577  , yields the error due to the interaction of instrumental instability with the wavelength calibration .",
    "for the entire four year period this is @xmath113 , where most of the error comes from systematic changes associated with changing the ccd , changing the linelist for the henearfe calibration , and changing the dewer .",
    "for the most recent 18 months , since the dewer change , the error from instrumental unstability is unmeasurably small , is consistent with zero , and has a @xmath114 upper limit , by bootstrap resampling , of @xmath115 .",
    "press ( 1995 ) has suggested a new methodology for determining redshifts .",
    "one first reduces a set of galaxy spectra ( shifted to a common rest frame ) to a set of orthogonal basis vectors , using singular value decomposition , svd .",
    "next , using the fast numerical methods of rybicki and press ( 1995 ) the most significant of these vectors are repeatedly fit to a spectrum with unknown redshift , with each fit being at a different redshift . for each fit @xmath1",
    "is calculated ; the redshift corresponding to a minimum @xmath1 is the redshift of the galaxy .",
    "recently glazebrook , et al ( 1998 ) have developed a nearly identical scheme ; the difference is that rather than calculate @xmath1 exactly , they use the simplifying assumption that the correlation function may substitute for @xmath1 .",
    "thus they can treat the ( svd derived ) eigenvectors as templates in a cross correlation program ( such as * xcsao * ) , and obtain a final redshift by summing the correlation functions in quadrature , weighted by the eigenvalues of each eigenvector - template .",
    "both press ( 1995 ) and glazebrook , et al ( 1998 ) have suggested that the coefficients of the fits can be used to classify the spectra , and that the position of a spectrum in coefficient space may be used to develop confidence measures in the derived redshift . recently",
    "bromley , et al ( 1997 ) used this technique to classify spectra from the lcrs ( shectman , et al , 1996 ) .",
    "we have not adopted the svd method for creating templates , nor the @xmath1 minimization technique for determining redshifts .",
    "we have , following press s ( 1995 ) suggestion , developed methods to use best fit parameters for rough classification and blunder discovery .",
    "we do not implement the glazebrook , et al ( 1998 ) method for a number of reasons .",
    "their approximation assumes the variance in a spectrum is not a function of wavelength .",
    "this assumption is clearly incorrect , and is one of the reasons why continuum subtraction is superior to continuum division in the low s / n regime ( section [ sup ] ) .",
    "the use of the eigenvalue as a weight in the combination of correlation functions overweights emission line correlations when reducing absorption line spectra , thus making them even more susceptible to shot noise . but finally , as the exact methods are available ( press , 1995 ) , we see no advantage in the approximation .    press s ( 1995 ) @xmath1 minimization technique , enabled by the rybicki and press ( 1995 ) algorithm , shows substantial promise . especially for the case where the rest frame of the template is much different from that of the unknown galaxy",
    "we expect that a rigorous accounting of observational errors as a function of wavelength will be important ; the new , deep redshift surveys of the next decade , e.g. with hectospec ( fabricant , et al , 1994 ) , will test whether the @xmath1 techniques will obtain better results for high redshift objects .",
    "we do not now implement the @xmath1 minimization because we believe that current redshift survey data , with @xmath116 would not benefit ; some confirmation of this view comes from the preliminary results of press ( 1995 , 1997 ) , who finds no improved ability to obtain redshifts from low s / n spectra in the lcrs ( shectman , et al 1996 ) compared with the original reduction , done by h. lin using rvsao 1.0 .",
    "we believe our template creation techniques are superior to a svd decomposition of a group of spectra for underlying physical reasons . emission line spectra and absorption line spectra arise from independent physical causes in different physical locations within a galaxy ; basis vectors which are admixtures of absorption and emission line spectra make no physical sense .",
    "additionally emission line velocities and absorption line velocities are not identical for any particular galaxy , as a perusal of optical rotation curves ( e.g. barton , et al , 1998 ) clearly shows .",
    "the simultaneous use of more than two templates or basis vectors to obtain redshifts is unnecessary .",
    "we performed a svd decomposition on the 1489 pure absorption line spectra used to create fabtemp97 ; the first eigenvector was essentially identical to fabtemp97 , the next three represented small differences in the continuum subtractions , the fifth eigenvector shows the h+k lines , which are systematically weaker in the early data , before a blue sensitive chip was installed , the next couple of eigenvectors also represent continuum differences .",
    "the systematic residuals from the reduction dominate the higher dimensions of the svd decomposition .    as a practical matter",
    "the limiting factor in obtaining redshifts for faint objects is the ability to get redshifts for weak lined absorption line systems .",
    "essentially , if one observes long enough with a fiber instrument to get redshifts for the absorption line spectra , the spectra with emission lines will all yield redshifts with almost any technique .",
    "we therefore will use fabtemp97 and femtemp97 as our fitting functions , we fit each spectrum as a linear combination of these two templates .",
    "we take as a representative sample the last 2000 spectra observed as part of the 15r survey ( geller , et al , 1998 ) .",
    "figure [ fabfem ] shows the absorption line vs. emission line fit coefficients .",
    "the solid dots are for @xmath117 and the open circles are for @xmath118 .",
    "there is a clear locus , outliers could be easily discovered and removed from any fully automatic data reduction process .",
    "combined with more traditional measures , e.g. equivalent widths and line ratios , figure [ fabfem ] can form the basis for a spectroscopic classification .",
    "the x and y axes roughly measure absorption line strength ( metallicity perhaps ) and emission line strength .",
    "figure [ absred ] shows the relation between the fit residuals and the inverse of the @xmath119 statistic for the fabtemp97 reduction .",
    "the symbols have the same meaning as in figure [ fabfem ] .",
    "there is a very good correlation of fit residuals with @xmath120 for spectra where @xmath117 ; for objects with emission lines the correlation is much weaker .",
    "figure [ emred ] shows the relation between the fit residuals and the inverse of the @xmath121 statistic for the femtemp97 reduction , the symbols here are dots if @xmath122 and open circles if @xmath123 . the correlation of fit residuals with @xmath120 for spectra where @xmath123 is weak , and for objects with absorption line velocities nonexistent .",
    "these two plots , along with the figures [ femcontour ] and [ fabcontour ] in section [ temp ] , which show the statistical and systematic error models , demonstrate that for typical redshift survey spectra , residuals for absorption line objects are mainly determined by signal to noise ; for emission line objects , the residuals are mainly systematic .",
    "we have demonstrated the techniques which we have developed in the rvsao suite to create a system for the accurate , automated reduction of spectra for galaxy redshifts and stellar radial velocities .",
    "more than half of all published redshifts have been measured using these techniques , as well as a large number of stellar radial velocities .",
    "the correlation method for obtaining redshifts can be successfully extended from absorption line spectra to emission line spectra , with a substantial improvement in effectiveness over the previous method for obtaining emission line redshifts , automated line fitting .",
    "the reduction of emission - line spectra requires different reduction steps than absorption line correlations .",
    "emission line correlation redshifts are susceptible to blunders due to the presence of cosmic rays . however , using automated line fitting ( * emsao * ) and absorption line correlation velocities the blunder rate can be kept near zero , with the degree of automation kept high .",
    "we have developed new techniques for calibrating and characterizing the blunder rate and the individual errors in redshift measurements .",
    "the blunder rate for rvsao reductions can be kept near zero by the use of some simple heuristics to identify possible mistakes . for typical redshift survey data from the fast spectrograph",
    "the automation rate is 95% .",
    "our self calibrating internal error estimator is accurate to @xmath0 20% .",
    "large , stable surveys enable development of more accurate and stable error estimators",
    ".    we have developed new methods for creating , calibrating , and using galaxy redshift templates .",
    "we have created an emission line template , femtemp97 , having the median properties of a large set of strong emission line spectra .",
    "we have created an absorption line template , fabtemp97 , having the mean properties of a large set of absorption line spectra showing no sign of emission .",
    "these spectra arise from physically distinct processes , and can be used to form a pair of basis vectors to perform a 2-d spectral classification .",
    "we have developed a new method for establishing the zero point for redshift observations , a method which minimizes the systematic differences between emission and absorption line redshifts .",
    "this zero point is determined as accurately as we can establish the wavelength calibration using standard henearfe lamps .",
    "we have shown a technique for measuring and eliminating differences between the instrumental zero point and the true zero point .",
    "we have shown improved techniques for a number of the substeps necessary to obtain accurate redshifts , including : removal of emission(absorption ) lines when correlating against an absorption(emission ) line template ; suppression of the night sky lines ; supression of the continuum ; design of the fourier filter ; and zero padding of spectra .",
    "the rapid development of large aperture telescopes with multi - object spectrographs presents substantial challenges for redshift and radial velocity reductions .",
    "reducing one or two orders of magnitude more spectra of objects one or two orders of magnitude fainter while maintaining high quality control standards and minimal personnel costs is clearly a difficult problem .",
    "rvsao provides a solid methodological and software basis to meet these new challenges .",
    "a large number of astronomers have sent us suggestions , complaints , bug reports , and kudos over the years .",
    "we should like to thank all of them , and ask that this continue .",
    "we thank w. press and b. bromley for permitting us to quote from their work in advance of publication .",
    "we have benefited greatly from a number of detailed scientific and technical discussions with d. fabricant , j. huchra , d. latham , and g. torres .",
    "e. falco carefully read the manuscript , and made several suggestions to improve the clarity of the text .",
    "susan tokarz has reduced tens of thousands of spectra using rvsao ; her experience , patience , and friendly collaboration have been crucial to this project .",
    "margaret geller s support has enabled rvsao to achieve its high degree of robust effectiveness .",
    "the rvsao package consists of six iraf tasks * xcsao * , * emsao * , * linespec * , * sumspec * , * contpars * , and * bcvcorr*. each of these tasks is controlled by a set of user settable parameters . in this appendix",
    "we list and describe all the relevant parameters for these tasks , and demonstrate their use in a series of examples .",
    "digital cross - correlations in the rvsao system are performed by * xcsao * , basically following the prescription of td79 , with a large number of refinements and additions .",
    "* xcsao * is capable of reducing a wide variety of input spectra , but must have its many parameters properly set .",
    "parameters for * xcsao * are set in its parameter list ( figures [ xcsao0a ] and [ xcsao0b ] ) , in the * contpars * program s parameter list ( figure [ contpars1 ] ) , and by special instructions to the program in the headers of the template spectra ( figure [ header ] ) . in this section",
    "we examine in detail the elements of * xcsao * , and we describe how the parameters are used in the code , along with the algorithmic details of their use .",
    "we follow the cross - correlation of a single spectrum against two very different templates , one showing primarily absorption features and one showing only emission features , to demonstrate the ways in which processing varies in response to the template spectra being used .    for each object spectrum file from the input list _ spectra _ , and/or each aperture specified in the aperture list _ specnum _ , the fitting subroutine is called .",
    "spectrum files are all read from the directory specified by _ specdir _ , but full or relative pathnames may be used in _ spectra _ , and _ specdir _ may be null .",
    "spectra which are in flux units instead of counts should be renormalized by setting _",
    "renormalize _ to yes . if _",
    "obj_plot _ is yes , the object spectrum is plotted as in figure [ xcsao1 ] , and the plot is kept on the screen available for zooming and editing until a  q \" is typed . if _ fixbad _ is `` yes , '' regions specified in the file named by _",
    "badlines _ are replaced by straight lines connecting the adjacent pixels , and the image is plotted again if _ obj_plot _ is `` yes . ''    band _ tempband _ of each template spectrum in the list _ templates _ and list of multispec apertures , _ tempnum _ , is loaded .",
    "template files are all read from the directory specified by _ tempdir _ , but full or relative pathnames may be used in _ templates _ , and _ tempdir _ may be null . if _",
    "echelle _ is yes , t_empnum _ is ignored , and the multispec lines used for templates track those used for object spectra . if _",
    "temp_plot _ is yes , the template spectrum is plotted .",
    "a zero - point redshift is computed by adding the solar system barycentric velocity correction , from a source specified by _",
    "svel_corr _ , the redshift of the template from the velocity parameter in the template header , an optional template - dependent velocity shift from the tshift parameter in the header , and an optional constant velocity shift from the _ tshift _ parameter .",
    "the template spectrum s barycentric velocity correction , from a source specified by _ tvel_corr _ , is subtracted because the template spectrum s observed velocity , not its corrected one , gives that spectrum the redshift which we are comparing .",
    "an initial redshift source may be specified by _ vel_init _ ; if  guess \" , this is from _ czguess _ ; if `` zero '' the initial velocity is 0 ; otherwise it can be read from an object spectrum header parameter velocity (  combination \" ) , czxc (  correlation \" ) , or czem (  emission \" ) . if such an initial redshift has been called for , or if this is the second pass or greater ( _ nzpass _ @xmath8 1 ) , the template log - wavelength limits are shifted by that initial redshift ( on the first pass ) or the current correlation redshift .",
    "the wavelength region over which the template and object spectra overlap is computed .",
    "if the wavelength in angstroms specified by _ st_lambda _ , is greater than the blue limit of the overlap region , it becomes the new limit .",
    "if the wavelength in angstroms specified by _ end_lambda _ , is less than the red limit of the overlap region , it becomes the new limit .",
    "the two spectra are rebinned into log - wavelength with a number of pixels , set by _",
    "ncols _ using an interpolation mode specified by _",
    "interp_mode_.    first , the continuum , and , optionally , emission and/or emission lines , are removed from the rebinned object and template spectra .",
    "parameters for fitting the continuum are in the iraf pset task named * contpars * ( see section [ contpars ] ) . emission and/or absorption lines may be removed from either or both of each object - template pair .",
    "_ s_emchop _ controls whether lines will be removed from the object spectrum .",
    "if the template spectrum header parameter subcont is present , its value overrides that of _ s_emchop_. _ s_absrej _ and _ s_emrej _ set the lower and upper acceptable limits for object spectrum pixels to be used in the continuum fit .",
    "if lines are rejected , as they are when the object spectrum we are following is to be correlated against an absorption line template , the rejected data points are plotted as in figure [ xcsao3 ] if _",
    "contsub_plot _ is yes .",
    "a graph of the continuum - removed data , as shown in figure [ xcsao4 ] , is displayed if the _ contsub_plot _ parameter is yes .",
    "template pixels with values outside of the lower _",
    "t_absrej _ and upper _ t_emrej",
    "_ acceptable limits , in standard deviations from the continuum fit , are replaced by continuum values in the template spectrum if _",
    "is set to yes .",
    "the continuum is then subtracted from the template spectra .",
    "template and object spectra are then apodized , tapered at each end for the fraction _",
    "bell_window _ of the entire spectrum .",
    "zeropad _ is yes , both spectra are padded with an equal length of null ( zero ) spectrum .",
    "a graph of the continuum - removed , apodized object spectrum is displayed , as shown in figure [ xcsao5 ] , if the _ apodize_plot _ parameter is yes .",
    "the transformed spectra are then filtered with a cosine - bell filter .",
    "the low frequencies are filtered from _",
    "low_bin _ to _ top_low _ and the high frequencies are filtered from _",
    "top_nrun _ to _ nrun_. the template header parameter fi - flag controls whether the template transform is filtered and whether the high - frequency filter is turned off for both template and object transforms to leave in emission lines . if _",
    "tfft_plot _ is set to yes , the filtered fourier power spectra of the object and template spectra are displayed as in figures [ xcsao8 ] and [ xcsao9 ] .",
    "the filtered transforms are then cross - correlated and normalized . if _",
    "uxcor_plot _ is yes , the unfiltered correlation is displayed . if _",
    "xcor_plot _ is yes , this result is displayed as in figure [ xcsao10 ] , and a specific peak may be selected using the cursor if _ curmode _ is yes . in that case , the maximum value within _ pksrch _ pixels of the cursor position is used .",
    "otherwise , the highest correlation peak between the velocities _ minvel _ and _ maxvel _ is used .",
    "the redshift is calculated by fitting a parabola or similar function specified by _",
    "pkmode _ to the portion of the peak above _ pkfrac _ of the maximum value of that peak",
    ". the r - value and error are computed , and control returns to xcfit to set up the template for the next pass .",
    "after all of the template spectra have been correlated against an object spectrum , the template with the highest r - value is selected .",
    "the results are displayed as text to the devices specified by _",
    "logfiles _ in the format specified by _",
    "report_mode_. figure [ xcsao11 ] shows the default report .",
    "if _ displot _ is yes , the object spectrum and , optionally , the selected correlation peak , are plotted to device in the format specified by _",
    "dispmode_. figure [ xcsao12 ] shows the summary graph if _",
    "dispmode _ is 1 .",
    "figure [ xcsao13 ] shows the _ dispmode _ 2 summary graph , with emission and absorption lines labeled . if _",
    "hardcopy _ is yes , the same graph is sent a printer .    if _ nsmooth _",
    "@xmath124 , the object spectrum is smoothed by a 1 - 2 - 1 sliding filter _ nsmooth _",
    "times for display purposes only .",
    "this smoothing may be changed interactively using the g command in cursor mode .",
    "the filtered cross - correlation with the best r - value is displayed centered on the redshift _ cvel _ ( in km / sec ) with a width in km / sec of _",
    "dvel_. if _ cvel _ is indef , the fit redshift is used ; if _ dvel _ is indef , the width is set to 20 times the peak width . if the correlation is not displayed , absorption lines ( _ ablines_@xmath9yes ) and/or emission lines ( _ emlines_@xmath9yes ) may be labeled from line lists in the directory _ linedir _ , as shown in figure [ xcsao13 ] .",
    "if _ curmode _ is yes , the user can interact with the display using the terminal cursor to zoom in on portions of the spectrum , rerun the cross - correlation , change the display format , edit the spectrum , or several other functions .",
    "for example , figure [ xcsao14 ] shows the correlation result for the second best template , selected using the t cursor command .    if _",
    "save_vel _ is yes , cross - correlation redshift results are written into the object spectrum image header in a form appropriate to the spectrum format : two entries plus one per template if multispec ; otherwise one value per keyword , as in figure [ xcsao15 ] .",
    "while * xcsao * can now use emission line templates , it is still useful to measure redshifts of emission line spectra directly . for large surveys , the interactive determination of line centers and calculation of redshifts by a program like iraf s * splot * , is simply too slow .",
    "* emsao * , a companion to the cross - correlation task * xcsao * , was written to find emission lines automatically , compute redshifts for each identified line , and combine them into a single radial velocity .",
    "the results may be graphically displayed or printed , saved to a file , and/or stored in the spectrum file header .",
    "* emsao * is designed to run with minimal human intervention , but options may be set to allow manual improvement of the line identifications and resulting redshift .",
    "the graphic cursor may be used to change fit and display parameters .",
    "figure [ emsao0 ] shows the full parameter list for * emsao*.    for each object spectrum file from the input list of spectra , and/or each aperture specified in the aperture list , the fitting subroutine , emfit , is called for the specified spectrum image band .",
    "spectrum files are all read from the specified directory unless a full pathname is given in the spectrum list .",
    "relative pathnames may be used for spectra .",
    "if a directory is not set , the spectra are expected to reside in the current working directory .    after the spectrum is loaded , it is renormalized , if the _ renormalize _",
    "flag is yes .",
    "this should usually be done if the spectrum is in flux units . if the _ fixbad _",
    "flag is yes , regions specified in the file named by _",
    "badlines _ are replaced by straight lines .",
    "the spectrum is then smoothed _",
    "times . if _",
    "obj_plot _ is yes , the spectrum is plotted and the plot , as shown in figure [ emsao1 ] is kept on the screen available for zooming and editing until a `` q '' is typed .    to use a sky spectrum to compute noise statistics and to improve the error computations , an aperture or band must be specified . if _",
    "skynum _ is not zero , a sky spectrum is read from that multispec aperture in the same file as _",
    "specnum_. if _ skyband _ is not zero , a sky spectrum is read from that multispec band in the same file . the sky spectrum , used to get the noise for error computations , is plotted if _",
    "obj_plot _ is yes .",
    "previous results which have been saved in the spectrum image header may be used by setting _",
    "linefit _ to no ; in that case , all of the fitting below is skipped and the results are displayed .",
    "the continuum , computed by the iraf curve fitting subroutine which is driven by the parameters set in the * contpars * pset task , is subtracted from the spectrum . if _",
    "contsub_plot _ is yes , the spectrum is plotted with the continuum removed as in figure [ emsao3 ] .",
    "the source of the initial redshift is specified by _",
    "vel_init_. if it is  guess \" , the starting redshift is read from the parameter _",
    "czguess_. if it is  search \" , one line in the spectrum is identified by the program using the table specified by the _ emsearch _",
    "parameter , as shown in figure [ emsao4 ] . this table lists line centers in angstroms and the wavelength range over which each one should be the strongest line . it can be modified by the user to match the data . the brightest line in each region is assumed to be the one in the table , and its observed wavelength is saved . the redshift of the brightest of those lines is returned as an initial value to be refined by looking at more lines .    if _ vel_init _ is  combination \" , the initial redshift velocity is read from the spectrum header parameter velocity ; if  correlation \" , it is read from the spectrum header parameter czxc ; and if  emission \" , from czem .",
    "search regions are read for each line in the file specified by the _ emlines _ parameter .",
    "figure [ emsao5 ] shows the contents of such a file .",
    "each region is then shifted by the guessed redshift and expanded in each direction by _ wspan _ angstroms .",
    "all emission lines within each specified wavelength region are found .",
    "a spectrum pixel is assumed to be a line center if the pixel value is the max of the _ npfit _ neighbors on either side , and greater than _ linesig _ times the square root of the average counts in those pixels .",
    "a second order fit is then made to the ( 2*_npfit_)+1 points centered on the peak to refine the center and peak height .",
    "the brightest line in each region is kept unless it has already been identified .",
    "order matters  the brightest line in a region should be listed first , so that if it is the only one present in overlapping regions , it is correctly named .    before line profiles are fit ,",
    "a copy of the spectrum is smoothed _",
    "esmooth _ times using the same smoothing algorithm as is used before the line search is conducted .",
    "the parameter _ esmooth _ should be left at zero unless the data are especially noisy .",
    "it is best never to go above 2 .",
    "because local continuum values are important to the line fit , the continuum is removed from this copy of the spectrum using the same parameters as were used before conducting the line search . if _",
    "contsub_plot _ is yes , the spectrum with the continuum removed is plotted as shown in figure [ emsao7 ] .",
    "each identified line is checked to see if it is part of one of the groups of close emission lines listed in the file specified by _",
    ", such as that shown in figure [ emsao8 ] . if it is , all lines in the combination will be simultaneously fit .",
    "those members of a line combination which are not found are initialized at the redshift of the most recently found line of the group .",
    "the missing line heights are assumed proportional to that line according to the relative heights in the _ emcombine _ file .",
    "the lines are fit by one to three gaussians , along with an optional local continuum level using 03 additional coefficients as set by _",
    "nlcont_. redshift ( computed from the wavelength of the center pixel coordinate ) , width , height , and errors are returned for each line .",
    "each emission line is checked to see whether : 1 ) it has a fit center greater than zero , 2 ) it is wider than lwmin times the mean width of all of the identified lines which are found and 3 ) narrower than _ lwmax _ times that mean width , 4 ) it has an equivalent width more than _ lsmin _ times the error in the equivalent width , 5 ) it is too close to the blue edge of the spectrum , 6 ) it is too close to the red edge of the spectrum , or 7 ) the error in the center of the gaussian is zero . if _",
    "dispmode _ is 1 or _",
    "report_mode _ is 1 , wavelengths and redshifts are printed for each line , with an x followed by the code for the test which failed at the end of entries which were omitted from the fit . if a line has been successfully fit , the rejection can be overridden interactively ( if _ curmode _ is yes ) using the + and - commands in cursor mode from the final display .",
    "if a line has been added or subtracted in cursor mode , a + or - at the end of the entry indicates that fact .",
    "a mean velocity is computed , weighted by the square of the error in the line centers and returned .",
    "if only a single line is found , the error is set to _",
    "sigline _ , which should be set to the uncertainty in the dispersion function in angstroms .",
    "this is usually significantly greater that the error in the fit to the center of the gaussian .",
    "after all of the lines have been fit and a combined velocity has been computed , a zero - point redshift is computed by adding the solar system barycentric velocity correction , from a source specified by _",
    "the results are displayed as text to the devices specified by _",
    "logfiles _ in the format specified by _",
    "report_mode_. options include 1 ) one line per found emission line under a self - documenting summary , 2 ) a single line report listing the names of the lines which are found , and 3 ) a single line report listing a velocity for each searched - for line .",
    "figure [ emsao9 ] shows the mode 1 report for the spectrum we are following .",
    "if _ displot _ is yes , the spectrum is plotted to device in the format specified by _",
    "dispmode_. figure [ emsao10 ] shows the mode 1 report ; figure [ emsao11 ] shows the mode 2 report . if _",
    "hardcopy _ is yes , the same graph is automatically sent to a printer as well .",
    "if _ nsmooth _ is greater than zero , the displayed spectrum is smoothed by a 1 - 2 - 1 sliding filter that many times .",
    "absorption lines listed in the file _ ablines _ are labeled if _",
    "dispabs _ is yes , and emission lines listed in the file _ emlines _ are labeled if _",
    "dispem _ is yes .",
    "both files are found in the directory _",
    "linedir_.    if _ curmode _ is yes , the user can interact with the display using the terminal cursor to zoom in on portions of the spectrum , identify lines and refit the emission lines , change the display format , edit the spectrum , or several other functions .    if _",
    "save_vel _ is yes , emission line redshift results are written into the spectrum image header in a form appropriate to the spectrum format : two entries plus one per line if multispec ; otherwise one , value per keyword , as shown in figure [ emsao12 ] .",
    "* linespec * is an iraf task for making a spectrum from a list of emission and/or absorption lines which is driven by the parameters shown in figure [ linespec0 ] .",
    "it was written to create templates for use by * xcsao*. an example of such a line list , with center wavelengths , widths , and heights for each line which may appear in the spectrum , is shown in figure [ linespec1 ] . the same line - defining parameters are used as are output of * emsao * , so low - noise templates can be easily made .",
    "the line list is read from the file specified by the _",
    "parameter in the directory designated by the parameter , _",
    "linedir_. if _ linedir _ is null , the file is assumed to be in the current working directory .    a blank ( all zero ) spectrum , with the object name _ specobj _ and file name _ specfile _ in the directory _ specdir _ is created .",
    "it is linear in wavelength , with a resolution in angstroms given by _",
    "pix_lambda _ , and a range from _",
    "st_lambda _ to _",
    "end_lambda_. spectral world coordinate system information is written to the header , with the standard fits parameters crpix1 , crval1 , and cdelt1 .",
    "verbose _ is yes , files specified by _",
    "logfiles _ are opened and a header is written .",
    "the center of each line in the table is redshifted according to the parameters _ zspec _ and _ velspec_. _ velspec _ ( cz@xmath9apparent doppler shifting velocity ) is used unless _ zspec _",
    "@xmath125 is not zero , in which case _ zspec _ is used for the redshift .",
    "the _ linewidth _",
    ", if it is tabulated in kilometers per second , is converted to angstroms at the shifted line center .",
    "the line width is also broadened appropriately if the line is redshifted .",
    "the redshift velocity is put in the spectrum header using the velocity keyword . if _",
    "maxwidth _ is yes , the _ linewidth _ parameter is used as the width of the line if it is greater than the tabulated width . if _",
    "maxwidth _ is no , the width from the table is used , and the _ linewidth _ smoothing is done later . for each line",
    ", a gaussian at the shifted center wavelength , half - width , and tabulated height is added to the spectrum . as each line",
    "is added to the spectrum , the line definition is written to the spectrum s header , producing a table such as that shown in figure [ linespec2 ] .",
    "after all of the lines are computed , a continuum level specified by the parameter _",
    "continuum _ is added to the spectrum .",
    "the spectrum is plotted to a graphics device , as shown in figure [ linespec3 ] , if _ spec_plot _ is yes . after the graph is displayed to the terminal , if _",
    "spec_int _ is yes , the user must interact with it using single character cursor commands , such as the  z \" for zoom command , the result of which is shown in figure [ linespec4 ] . if the  @ \" command is given in this mode , the graph is immediately sent to the device specified by _",
    "plotter_. the  q \" command must be typed to leave the graph and proceed .",
    "if _ maxwidth _ is no , the resolution of the spectrograph is simulated by convolving the entire spectrum with a gaussian of height 1.0 and sigma ( half width at half of maximum ) of _ linewidth_. if _",
    "spec_plot _ is yes , the spectrum is displayed again .",
    "* sumspec * is an iraf task for making a composite spectrum which is adjusted for velocity .",
    "it rebins input spectra to a common wavelength or log - wavelength range and resolution , with optional continuum removal and normalization .",
    "while it was originally intended for making templates to be used by the * xcsao * cross - correlation task , it has turned out to be very useful for rebinning individual spectra as well as combining multiple spectra .",
    "the parameter list for * sumspec * is shown in figure [ sumspec0 ] .",
    "the spectra to be added are specified by the list of files in the parameter _",
    "spectra _ and/or the list of spectrum numbers in _",
    "specnum_. unless a pathname is specified as part of the filename in _ spectra _",
    ", each spectrum is expected to be found in the directory _",
    "specdir_. all spectra are taken from the band , _ specband _ , in multispec spectra .",
    "files specified by _",
    "logfiles _ are opened to receive logging information . if _",
    "debug _ is yes , additional information about the input files and the progress of the program is written to stderr .    if either _",
    "st_lambda _ or _",
    "end_lambda _ is set to indef , all of the spectrum headers are read to find the limits of the overlap of their wavelength coverage , and the missing limit(s ) of the output spectrum are set accordingly .    before the first spectrum in the list is added , a blank ( all zero ) spectrum , with the object name _",
    "compobj _ and file name _ compfile _ in the directory _ compdir _ is created . if _",
    "complog _ is yes , it is linear in log - wavelength ; otherwise , it is linear in wavelength .",
    "either way , the output spectrum contains _ npts _ data points between _ st_lambda _ , or its log , and _ end_lambda _ , or its log .",
    "world coordinate system information is then written to the header .",
    "spectra are read from the input list one at a time and renormalized if _",
    "renormalize _ is set to yes .",
    "this should be done if the spectra are fluxed or whenever pixel values are much bigger or smaller than their variation .",
    "spec_plot _ is yes , each spectrum is plotted to the device specified by the parameter _ device _",
    ", as in figure [ sumspec1 ] . if _",
    "spec_int _ is yes , the user can interact with that graph using single character cursor commands and must type a  q \" to proceed with the task . if the  @",
    "\" command is given in this mode , the graph is sent to the device specified by _",
    "plotter_.    each spectrum is rebinned using an interpolation mode specified by _",
    "interp_mode _ into a _",
    "npts_-pixel wavelength - linear spectrum covering the range computed above .",
    "complog _ is yes , the rebinned spectrum is linear in log - wavelength ; if _ complog _ is no , the rebinned spectrum is linear in wavelength . if specplot is yes , the rebinned spectrum also is plotted .    if _",
    "s_contin _ is set to subtract or divide instead of no , the iraf curve fitting subroutines , are used to fit a continuum to each input spectrum .",
    "the contsum task , described in the following section , sets all of the appropriate parameters .",
    "as it is rebinned , each input spectrum is redshifted according to the parameters _ ztemp _ ( @xmath126 , if it is not zero , or _",
    "veltemp _ ( cz = apparent doppler shifting velocity ) .",
    "a velocity correction to the solar system barycenter is removed according to the _ svel_corr _",
    "parameter . set it to none if the input spectra have not been shifted .",
    "if  file \" , bcv is used if present in the file header , or else hcv . if  hfile \" , the header parameter hcv is always used .",
    "if neither is found , no correction is made . if  heliocentric \" or  barycentric",
    "\" corrections are chosen , position and time parameters are read from the spectrum data file header , and the correction is computed as described in section [ bcv ] below .    emission and/or absorption lines may be removed from each input spectrum if _ reject _ is yes . if the spectrum header parameter subcont is present , its value overrides that of _ reject_. the parameters _ absrej _ and _ emrej _ set the lower and upper acceptable limits for input spectrum pixels in standard deviations of the continuum fit to the spectrum .",
    "the composite spectrum is plotted to the device specified by the parameter _",
    ", as in figure [ sumspec5 ] , if _",
    "comp_plot _ is yes .",
    "comp_int _ is yes , the display is held to allow the user to interact with it using single character cursor commands . if the  @ \" command is given in this mode , the graph is sent to the device specified by plotter .",
    "a  q \" command allows the task to proceed .    after each spectrum",
    "is added , the * sumspec * version and the current date are written to the output spectrum image header and that spectrum image file is written .",
    "after the last spectrum is added the file is closed .",
    "figure [ sumspec6 ] shows the parameters added to the spectrum header .",
    "exptime is the total exposure time from all of the input images .",
    "a one - dimensional image is produced , so dispaxis is always 1 .",
    "dc - flag is 1 if the output spectrum is log - wavelength , in which case the log - wavelength of the first pixel is given in both crval1 and w0 , and the log - wavelength per pixel is given in cdelt1 and wpc .",
    "the velocity is set by the _",
    "velcomp _ or _ zcomp",
    "_ parameter .",
    "if no velocity is specified , it is left at 0 . if _ savenames _ is yes , the instrument , filename , input redshift velocity and barycentric velocity correction are written to the header .",
    "[ [ contparsremoving - a - spectrums - continuum - using - contpars - or - contsum ] ] [ contpars]removing a spectrum s continuum using * contpars * or contsum ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    * contpars * and contsum are iraf parameter files which are used by a single subroutine to fit and remove a continuum from object or template spectra .",
    "the subroutine uses the iraf interactive curve fitting subroutine package and is based on the technique used in the iraf rv package ( fitzpatrick 1993 ) .",
    "the parameters which are set are shown in figure [ contpars1 ] . the same subroutine is called prior to cross - correlation by * xcsao * , an emission line search by * emsao * , and before or after summation of spectra by * sumspec*. if the subcont header keyword in a template spectrum is set to f , no continuum is fit or removed from that template spectrum . if the keyword is t or not present , the continuum is fit and removed .    for a spectrum , such as that in figure [ contpars2 ]",
    ", the continuum is fit using the iraf curve fitting subroutine .",
    "it may be used interactively by setting the _ c_interactive _ parameter to yes . in that case",
    ", a graph of the fit and the spectrum is displayed as shown in figures [ contpars3 ] and [ contpars4 ] .",
    "the result may be examined or refit after individual pixels are removed .",
    "a `` q '' command is needed to exit from the interactive graph .",
    "the _ c_function _ parameter specifies the function to be used to fit the continuum .",
    "if the continuum is irregular , it is best to use the spline3 , but spline1 , legendre , or chebyshev polynomials may be used as well .",
    "the parameter _ order _ sets the order of the fit .",
    "the portion of the the spectrum to be fit is specified , in image section format , by the parameter _ sample _ , before the fit , the spectrum is averaged in groups of _ naverage _ pixels .",
    "pixels with values outside of the limits _",
    "s_low_reject _ and _ s_high_reject _ , for spectra , and _",
    "t_low_reject _ and _ t_high_reject _ , for templates are rejected .",
    "separate limits are used because composite template spectra will have much higher signal - to - noise levels than object spectra and limits may need to be set differently to fit a good continuum .",
    "these limits are specified in standard deviations of the fit . to make sure that the wings of lines are thoroughly eliminated , this rejection process is repeated _ niterate _ times .",
    "each time , a number of pixels , specified by the _ grow _ parameter , are rejected on each side of the rejected pixel .",
    "normally , the continuum which is fit is subtracted from the spectrum , preserving the signal - to - noise of a spectrum when it is dominated by photon noise . to remove the continuum of both template and object spectra by division , the template spectrum header keyword divcont is set to t. in that case , noise in portions of the spectrum with low signal - to - noise levels will be amplified .",
    "emsao.contsub_plot_ , _",
    "xcsao.contsub_plot_ , or _",
    "sumspec.cont_plot _ is yes , the spectrum is plotted with the continuum removed , as shown in figure [ contpars5 ] .      to compare redshift velocities observed",
    "when the earth is at different positions in its orbit , the velocity of the sun relative to the earth is added to the redshift velocity .",
    "this heliocentric velocity correction is more accurately done to the true stationary point of the solar system barycenter , its center of mass .",
    "this barycentric velocity correction is shown in figure [ bcvcorr0 ] . a second",
    ", smaller correction is added for the motion of the observer relative to the center of the earth as it rotates .",
    "this vector velocity is projected in the direction of the observed object , and that component is saved .",
    "the * xcsao * , * emsao * , and * sumspec * tasks of the rvsao package compute this correction using subroutines which read the time of observation , object position , and observatory position from the spectrum image header . several common alternative keywords are built into those subroutines .",
    "ra , dec , and epoch give the right ascension , declination , and equinox of the observed object .",
    "sitelong , sitelat , and siteelev for longitude , latitude , and altitude , respectively give the observer s location on the earth .",
    "obs - date yields the observation date and utmid , the midtime of the observation .",
    "if utmid is not found in the header , ut , assumed to be the end time of the observation , or utopen , the start time of the observation are used in combination with exposure or exptime , which give the duration of the observation in seconds to compute a midtime .",
    "the requested heliocentric or barycentric correction is then calculated at that midtime .",
    "since there is really no standard for the meaning of these keywords , a separate task , * bcvcorr * , has been added to rvsao to allow several alternate ways of specifying these three major pieces of information .",
    "* bcvcorr * can write its result to the header of the image which it is processing ; the other rvsao tasks will use this value when their _",
    "parameter is set to  file \" .",
    "first , the sky direction of the object is set .",
    "the right ascension , declination , and equinox of the object s sky position are read from the keywords specified by the _ keyra _ , _ keydec _ , and _ keyeqnx _ parameters . if those are not all found , the position is read directly from the parameters _ ra _ , _ dec _ , and _",
    "equinox_.    the time for the velocity correction is read from a julian date keyword specified by _",
    "keyjd_. if none is found , the date is taken from the header keyword specified by _",
    "the ut midtime is taken from the keyword in _",
    "keymid_. if that is not found , the observation midtime is computed by finding the exposure duration from the _ keyexp _ keyword value and adding half of it to the start time from the _ keystart _ keyword value or subtracting half of it from the end time in the _ keyend _ keyword value .",
    "if no time can be found in the header , the julian date is read directly from the _ gjd _ parameter , if it is greater than zero , or the midtime is taken from the _ year _ , _ month _ , _ day _ , and _ ut _ parameters .    the heliocentric julian date ( hjd ) is the time at which the light from the object for this observation reachs the sun .",
    "it is needed if multiple radial velocity observations of an object are to be compared accurately .",
    "the hjd is not used in computation of the velocity correction , which is dependent on the time of the observation at the earth .",
    "it may be read from the header keyword _",
    "keyhjd _ or set by the parameter _ hjd _",
    "( only if @xmath8 0 ) .",
    "if none is set , the hjd is computed from the observation time .    if the _ obsname _ parameter is  file \" ,",
    "the observatory name and position is read from the image header using the keywords in _ keyobs _",
    ", for the name , _ keylat _ , for the latitude , _ keylong _ , for the longitude , and _ keyalt _ , for the altitude",
    "otherwise , the value of _ obsname _ is used to get a position from iraf s observatory database .",
    "if the string is not found there , the longitude , latitude , and altitude are given by the parameters _ obslong _ , _ obslat _ , and _",
    "obsalt_.    if _ verbose _ is yes , the information in figure [ bcvcorr1 ] is printed to standard output . if _",
    "savebcv _ is yes , several spectrum image header keywords are set .",
    "bcv is the barycentric velocity correction in km / sec .",
    "the midtime of the observation is stored three ways : utmid , the universal time , gjdn , the geocentric julian date , and hjdn , the heliocentric julian date .",
    "these times are displayed by * xcsao * and * emsao * as the time of observation .",
    "kurtz , m.j . ,",
    "mink , d.j . ,",
    "wyatt , w , f . ,",
    "fabricant , d.g . ,",
    "torres , g. , kriss , g.a . , and tonry , j.l . , 1992 , in astronomical data analysis software and systems i , asp conference series vol .",
    "worrall , c. biemesderfer , and j. barnes , eds .",
    ", p. 432 .",
    "vettolani , g. , zucca , e. , zamorani , g. , cappi , a. , merighi , r. , mignoli , m. , stirpe , g.m . , macgillivray , h. , collins , c. , balkowski , c. , cayette , v. , maurogordato , s. , proust , d. , chincarini , g. , guzzo , l. , maccagni , d. , scaramella , r. , blanchard , a. , and ramella , m. , 1997 , , 325 , 954 ."
  ],
  "abstract_text": [
    "<S> rvsao is a set of programs to obtain redshifts and radial velocities from digital spectra . </S>",
    "<S> rvsao operates in the iraf(tody 1986 , 1993 ) environment . </S>",
    "<S> the heart of the system is * xcsao * , which implements the cross - correlation method , and is a direct descendant of the system built by tonry and davis ( 1979 ) . </S>",
    "<S> * emsao * uses intelligent heuristics to search for emission lines in spectra , then fits them to obtain a redshift . * </S>",
    "<S> sumspec * shifts and sums spectra to build templates for cross - correlation . * </S>",
    "<S> linespec * builds synthetic spectra given a list of spectral lines . * </S>",
    "<S> bcvcorr * corrects velocities for the motion of the earth . </S>",
    "<S> we discuss in detail the parameters necessary to run * xcsao * and * emsao * properly .    </S>",
    "<S> we discuss the reliability and error associated with * xcsao * derived redshifts . </S>",
    "<S> we develop an internal error estimator , and we show how large , stable surveys can be used to develop more accurate error estimators .    </S>",
    "<S> we develop a new methodology for building spectral templates for galaxy redshifts , using the new templates for the fast spectrograph ( fabricant , et al , 1998 ) as an example . </S>",
    "<S> we show how to obtain correlation velocities using emission line templates . </S>",
    "<S> emission line correlations are substantially more efficient than the previous standard technique , automated emission line fitting .    </S>",
    "<S> using this machinery the blunder rate for redshift measurements can be kept near zero ; the automation rate for fast spectra is @xmath095% .    </S>",
    "<S> we use * emsao * to measure the instrumental zero point offset and instrumental stability of the z - machine and fast spectrographs .    </S>",
    "<S> we compare the use of rvsao with new methods , which use singular value decomposition and @xmath1 fitting techniques , and conclude that the methods we use are either equal or superior . </S>",
    "<S> we show that a two - dimensional spectral classification of galaxy spectra can be developed using our emission and absorption line templates as physically orthogonal basis vectors . </S>"
  ]
}