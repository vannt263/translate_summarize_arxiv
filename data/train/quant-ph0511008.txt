{
  "article_text": [
    "reversible and quantum logic synthesis have attracted recent attention as a result of advances in quantum and nano technologies .",
    "many of the proposed synthesis methods , especially in the area of reversible logic synthesis , assume large gate libraries where implementation costs of the gates may vary significantly .",
    "however , these methods most often target minimization of the gate count .",
    "use of such a circuit cost metric is likely to result in seemingly small circuits , which are in fact expensive to construct .",
    "the synthesis of circuits composed of not , cnot and toffoli ( nct ) gates @xcite and multiple control toffoli gates @xcite has recently been extensively studied . converting an nct or a multiple control toffoli gate circuit into one composed of not , cnot , controlled-@xmath0 and controlled-@xmath1 ( ncv ) gates",
    "has also been considered @xcite .",
    "further simplification of ncv circuits has also been well studied @xcite .",
    "it is an important question how close the circuits found by the above approaches are to optimal .",
    "the direct synthesis of ncv circuits is also of considerable interest since intuitively one would expect that to produce better results than the indirect route via nct circuits .",
    "finally , we note that observing optimal circuits for small cases often will shed light on good ( if not optimal ) synthesis approaches .    for these reasons , we here present an approach to finding optimal 3-line ncv circuits using various cost metrics .",
    "we compare these results to those found through mapping optimal nct circuits . the advantage of direct ncv synthesis will be clear even for the 3-line case .",
    "also , the results clearly demonstrate the difference between using simple gate count and technology motivated cost metrics .",
    "the necessary background is reviewed in section [ sec : b ] .",
    "a breadth - first search procedure to find optimal 3-line ncv circuits is given in section [ sec : sp ] and properties identified in those circuits are discussed in section [ sec : o ] .",
    "section [ sec : cc ] presents comparative results to circuits derived from nct circuits and for various cost metrics .",
    "the paper concludes with remarks and suggestions for ongoing research in section [ sec : c ] .",
    "we here provide a brief review of the basic concepts required for this paper . for a more detailed and formal introduction",
    "we refer the reader to @xcite .",
    "a single quantum bit ( qubit ) has two values , 0 or 1 , traditionally depicted as @xmath2 and @xmath3 respectively .",
    "the state of a single qubit is a linear combination @xmath4 ( also written as a vector @xmath5 ) in the basis @xmath6 , where @xmath7 and @xmath8 are complex numbers called the amplitudes , and @xmath9 .",
    "real numbers @xmath10 and @xmath11 represent the probabilities ( @xmath12 and @xmath13 ) of reading the values @xmath2 and @xmath3 upon physical measurement of the qubit .",
    "the state of a quantum system with @xmath14 qubits is described as an element of the tensor product of the single state spaces yielding a normalized vector of length @xmath15 called the state vector .",
    "quantum system evolution results in changes of the state vector expressible as products of @xmath16 unitary matrices .",
    "this formulation characterizes a transformation but provides no indication of its implementation cost .    in one common approach ,",
    "small gates are used as elementary building blocks with unit cost @xcite . among them",
    "are not ( @xmath17 ) and cnot ( @xmath18 ) gates , the 2-bit controlled - v gate which changes the target line according to the transformation given by matrix @xmath19 if , and only if , the control line is 1 .",
    "controlled-@xmath20 analogously applies the transformation @xmath21 .",
    "consult @xcite for the case where the control line assumes a quantum ( non - boolean ) value .",
    "gates controlled-@xmath0 and controlled-@xmath1 are also referred to as controlled - sqrt - of - not gates since @xmath22 . in order to implement a boolean specification , and assuming an auxiliary line is available in addition to the minimal set of lines needed for reversibility @xcite , the set of gates not , cnot , controlled-@xmath0 and controlled-@xmath1 is complete .",
    "we call this set the * ncv * gates",
    ".    the * ncv-111 cost * of a circuit composed of ncv gates is the number of gates in the circuit .    in an alternative approach @xcite",
    ", it is observed that any circuit can be composed with single qubit and cnot gates and the circuit cost is calculated based on the number of cnot gates required . with regards to the ncv library",
    ", we next define ncv-012 cost and motivate our definition by the fact that controlled-@xmath0 and controlled-@xmath1 gates require at most 2 cnot gates when decomposed into a circuit with single qubit and cnot gates ( @xcite , page 181 ) .",
    "the * ncv-012 cost * of an ncv circuit is linear with weights 0 , 1 , 2 , and 2 associated with the gates not , cnot , controlled-@xmath0 and controlled-@xmath1 , respectively .",
    "the last cost metric that we consider in this paper is motivated by a recent investigation of the technological ( liquid nmr ) costs of quantum and reversible primitives @xcite .",
    "the * ncv-155 cost * of an ncv circuit is linear with weights 1 , 5 , 5 , and 5 associated with the gates not , cnot , controlled-@xmath0 and controlled-@xmath1 , respectively .",
    "finally , we define the multiple control toffoli gate @xcite .    for the set of boolean variables",
    "@xmath23 @xmath24 the * toffoli gate * has the form @xmath25 , where @xmath26 and @xmath27 .",
    "it maps the boolean pattern @xmath28 to @xmath29 @xmath30 .",
    "@xmath31 will be called the * control * set and @xmath32 will be called the * target*.    the toffoli gate and its generalizations with more than two controls form a good basis for synthesis purposes and have been used by many authors @xcite . however , toffoli gates are not simple transformations .",
    "rather they are composite gates themselves and toffoli gates with a large set of controls can be quite expensive @xcite . as a result",
    ", the ncv-111 cost of a 100-gate toffoli circuit with 10 input / output lines can be as low as 100 , or may be as high as 15,200 .",
    "these are , of course , extreme numbers , however , in section [ sec : cc ] we show a better analysis of how the costs may differ .",
    "our main tool for the investigation of relations amongst optimal ncv-111 , ncv-012 and ncv-155 implementations and their relation to the most commonly used reversible circuit cost metric , multiple control toffoli gate count , is a search procedure for the optimal synthesis of ncv circuits for all 40,320 size 3 reversible boolean functions . for this problem",
    ", we use a prioritized , pruned breadth - first search .",
    "this is because the search tree for simple full breadth - first search grows too fast for a search to be accomplished in feasible time and space .",
    "this is in contrast to using a full breadth - first search for nct optimal synthesis @xcite , which is tractable for 3-line circuits with no search optimizations .    to see the size of the problem , note that the number of base transformations for ncv gates is 21 : 3 transformations involve a not gate , and the use of the gates cnot , controlled-@xmath0 and controlled-@xmath1 each result in 6 transformations .",
    "the results in table [ tab : ncv-012 ] show that the length of the optimal implementations can be up to 16 .",
    "thus , the number of nodes at one level of the search tree can be as high as @xmath33 .",
    "breadth first search was previously applied to the synthesis of optimal circuits for the size 3 reversible functions using not , cnot , and toffoli gate library @xcite .",
    "the size of the bottom level of their search tree ( branching factor to the power of tree depth ) is @xmath34 showing that such a search is significantly simpler than the one we are pursuing and requires no techniques to reduce the search space or make the search efficient .",
    "in addition , toffoli gates are not simple transformations , while synthesis of optimal circuits makes more sense in terms of simple transformations .",
    "our search procedure can find optimal circuits in any weighted gate count metric , not just in the simple gate count metric used in @xcite .",
    "an earlier attempt to synthesize optimal ncv circuits @xcite was capable of synthesizing optimal implementations of the maximal cost 7 in one specific cost metric ( ncv-011 ? ) .",
    "the maximal number of synthesized functions is 10136 @xcite , which is about a quarter of the pool size .",
    "our program synthesizes optimal implementations for _ all _ 40,320 size 3 reversible functions , and is not tied to a specific costing metric .",
    "further , our search procedure is _ significantly _ faster : it completes the entire search in the lesser time than the search of all optimal 5-gate implementations in @xcite .    in our work",
    ", we do not allow a quantum gate ( controlled-@xmath0 and controlled-@xmath1 ) to have a control line that may at that point in the circuit take a quantum ( non - boolean ) value .",
    "we do not have a mathematical proof that deleting this _ restriction _ will not result in construction of smaller circuits .",
    "however , numerous experiments indicate that use of a quantum gate with a quantum control line does not lead to a more efficient circuit than the one we construct .",
    "the above restriction allows us to work with quaternary logic instead of a continuous values .",
    "the techniques used to reduce the size of the search include :    * based on the observation above , we can view a quantum function as a base reversible boolean function with a quantum factor added .",
    "in other words , each of the values that may occur in the truth table is stored as a 2-bit number .",
    "values 0 , 1 , @xmath0 and @xmath1 are represented by 00 , 10 , 01 and 11 , respectively . * while our final goal is to synthesize all size three reversible functions , and none of the quantum ( non - boolean ) functions , the latter still have to be stored and referred to during the search process .",
    "each such function is stored in a queue associated with its base reversible boolean function that can be uniquely identified from the first digit in the above 2-bit encoding .",
    "the quantum function itself is then identified by a 24-bit number composed of the second bits , that we call the quantum signature .",
    "a quantum function is uniquely defined by the base boolean function and its quantum signature .",
    "* when we assign a new gate to the existing optimal cascade we never choose a gate with the same set of controls and targets as the immediately previous one in the circuit .",
    "this is because such a sequence can always be reduced by template application @xcite , and thus will not be part of an optimal circuit .",
    "this cuts down the number of gates that one must consider at each step .",
    "* we note that in an ncv implementation of a reversible function one can interchange controlled-@xmath0 with controlled-@xmath1 gates without changing the function realized , provided all such gates are interchanged . in our search procedure , this is accounted for by never using a controlled-@xmath1 gate as the first quantum gate during construction of an ncv circuit . in this context , the _ first quantum gate _",
    "is the one that transforms a boolean line to one that can take on quantum values .",
    "* once an optimal implementation of a function is found , we have also found an optimal implementation for all functions that differ from this one only by their input - output labeling .",
    "potentially , this accounts for at most 6 different functions .",
    "* once @xmath35 is a circuit for a reversible function @xmath36 , @xmath37 is a valid circuit for @xmath38 @xcite .",
    "it can be shown that for each metric considered in this paper , as well as in any weighted linear type metric if @xmath35 is optimal for @xmath36 , then @xmath37 will be an optimal implementation for @xmath38 . from the point of view of the search for optimal circuits",
    ", this means that once an optimal circuit for @xmath36 is found , so is an optimal circuit for @xmath38 . this observation would further help to cut down the search space , however , we have not yet implemented it since our program is fast enough at present .",
    "it takes approximately 1 minute to synthesize optimal 3-line ncv circuits in each metric on a single 750 mhz processor sun blade 1000 .",
    "due to the potentially differing costs of the basis gates , our procedure maintains several queues of functions , each corresponding to the cost associated with the circuits in it . during the search , new gates are assigned to the circuits with smallest cost not yet considered thereby yielding new circuits to be considered .",
    "cheaper gates are applied first . however , due to varying gate costs , the first circuit found realizing a boolean function may not be optimal . to see this ,",
    "consider the example illustrated in figure [ 2circ ] .",
    "our program finds the non - optimal circuit with ncv-155 cost 7 before the optimal implementation with ncv-155 cost 6 .",
    "this is because the procedure generates a circuit with two not gates before a circuit with a single cnot gate , and consequently finds the three gate circuit in advance of the cheaper two gate alternative .",
    "note that for gate count these two circuits are generated in the opposite order .",
    "using the above search procedure we found several interesting properties of the optimal 3-line ncv circuits :    * optimal implementations found with cost metrics ncv-111 and ncv-155 are interchangeable , and optimal ncv-111 implementations have optimal costs in ncv-012 cost metric .",
    "diagram in figure [ fig : interchange ] shows which optimal implementations can be substituted without loosing the property of optimality in the corresponding metric .",
    "practically , this means that the set of optimal ncv-111 circuits contains circuits optimal in other ( ncv-012 and ncv-155 ) metrics . in section [ sec : cc ] we make some observations with regard to the ncv-111 metric optimal circuits .",
    "the same comparisons apply for optimal ncv-012 and optimal ncv-155 implementations .",
    "further , our experiments with different metrics suggest that the set of optimal ncv-111 circuits will contain optimal implementations in ncv-@xmath39 cost metric as long as non - negative integer numbers @xmath40 , @xmath41 , and @xmath42 which represent costs of the gates not , cnot , and controlled-@xmath0 ( and assuming the cost of the controlled-@xmath43 equals the cost of the controlled-@xmath0 ) satisfy inequality @xmath44 . +    * in every circuit cost metric that we have considered ( ncv-111 , ncv-155 , and ncv-012 ) , the total number of controlled-@xmath0 and controlled-@xmath1 gates in any single circuit is divisible by 3 and is never more than 9 .",
    "we conjecture that the overall number of controlled-@xmath0 and controlled-@xmath1 gates in any ncv implementation of any reversible function is divisible by three . *",
    "a 3-bit toffoli gate and a 3-bit toffoli gate with one negative control have the same cost in each of the metrics ncv-111 , ncv-155 , and ncv-012 .",
    "some optimal circuits are illustrated in figure [ toffolis ] .",
    "an optimal implementation of a 3-bit toffoli gate with two negative controls has 6 gates .",
    "+    + this observation allows us to generalize the famous result by barenco _",
    "_ @xcite and improve @xcite on the implementation costs of the generalized multiple controlled toffoli gates by suggesting that large toffoli gates with some , but not all , negative controls can be simulated with the same cost as the same size toffoli gate with all positive controls . illustrated in figure [ lt ] is a toffoli gate with 5 controls , and a circuit simulating it , analogous to the one from @xcite .",
    "since the cost of a size 3 toffoli gate with one negative control equals to the cost of size 3 toffoli gate with both positive controls , large toffoli gate illustrated in figure [ lt ] will have a cost equal to the cost of the same size toffoli gate but having only positive controls .",
    "application of the local optimization techniques like @xcite may choose different scenarios for simplification of the circuits for large toffoli gates with all positive and some but not all negative controls .",
    "however , results of such optimization are out of the scope of the present paper .",
    "+    * observing all optimal implementations in the ncv-111 metric we came to the conclusion that every boolean function @xmath45 of two variables can be computed by a quantum circuit with no more than 5 gates .",
    "if this function is from boolean class @xmath46 ( when @xmath47 ) , only 4 quantum gates are required .",
    "in this section , we compare the ncv-111 ( ncv-012 and ncv-155 ) costs for the optimal synthesis of size 3 reversible functions using toffoli gates up to size 3 ( nct library , @xcite ) with the costs of optimal ncv circuits .",
    "we note that our implementation of the breadth first search for the size 3 reversible nct circuits may differ from the original as discussed in @xcite . due to the large number of optimal nct circuits for some functions ,",
    "the results shown below may vary slightly depending on the actual program implementation . further",
    ", the comparison is done through substitution of every toffoli gate in an optimal nct circuit with a 5-gate ncv circuit ( @xcite , page 182 ) , and thus assigning a cost of 5 in the ncv-111 metric .",
    "gates not and cnot are present in both libraries , nct and ncv , and thus require no specific attention .",
    ".optimal nct and optimal ncv-111 ncv circuits .",
    "[ cols=\"^,^,^,^ \" , ]         a comparison of the ncv-012 costs of optimal ncv-012 ncv circuits and nct circuits is made in table [ tab : ncv-012 ] ( this table is organized similarly to the previous table ) and figure [ ncv-012chart ] . in this metric",
    ", the maximum ratio of nct optimal circuit ncv-012 cost over ncv-012 optimal circuit ncv-012 cost equals 8 ( @xmath48 ) .",
    "the optimal nct and optimal ncv-012 circuits for one such function are illustrated in figure [ max012circ ] ) .",
    "on average , however , this ratio is 1.2728 .",
    "correlation between the vectors of costs is 0.8999 , which is almost identical to the correlation between optimal nct and optimal ncv-111 circuits in the ncv-111 cost metric .",
    "the number of functions where the ncv-012 cost of an optimal nct circuit equals the ncv-012 cost of an optimal ncv-012 circuit equals 1,774 .",
    "$ ] .,height=68 ]",
    "in the discussion above we assumed that a direct interaction between any two qubit can be established ( _ e.g. _ a 2-qubit gate may be built on any two qubits ) . however , due to the specifics of a particular physical realization , this may not always be the case",
    ". some of the qubit - to - qubit interactions may only be available indirectly . on the other hand , in every @xmath49-bit quantum computation it must always be possible to construct a connected graph with vertices representing qubits and edges representing possibility of the direct interaction between qubits . in the case",
    "@xmath50 , there are only two non - isomorphic connected graphs .",
    "one is the complete graph , and the remaining is a star ( all vertices are connected to one ) . in this section",
    "we report results for the optimal synthesis assuming direct interactions are allowed between qubits @xmath51 and @xmath52 , and @xmath52 and @xmath53 .",
    "we assume ncv-111 costing metric , however , the results can be calculated for other metrics as well .",
    "assuming the implementation costs ( numbers of gates ) are @xmath54 , the numbers of functions requiring this many gates are 1 , 7 , 29 , 82 , 181 , 334 , 374 , 334 , 337 , 753 , 1652 , 2654 , 2482 , 1674 , 1350 , 3236 , 6304 , 6028 , 1508 , 1302 , 2566 , 4314 , 2804 , and 14 .",
    "there are no functions requiring more than 23 gates .",
    ", ( b ) @xmath55 , and ( c ) @xmath56.,height=102 ]    we found it interesting to notice that in the case of non - restricted qubit interactions one of the cheapest non - linear ( with respect to exor ) reversible gates is the peres gate @xcite defined by the transformation @xmath57 . it can be composed with 4 quantum ncv gates only . an analogy ( smallest non - linear reversible gate with a similar transformation ) of this gate in the case of restricted qubit interactions is the gate defined by the transformation @xmath58 .",
    "it requires 6 quantum ncv gates as illustrated in figure [ cntcirc](a ) .",
    "toffoli gates @xmath55 and @xmath59 require 9 elementary quantum gates each and can be thought of as a swap gate ( 3 cnots ) followed by the @xmath58 transformation .",
    "an optimal implementation of @xmath55 is illustrated in figure [ cntcirc](b ) .",
    "toffoli gate @xmath56 is somewhat more expensive .",
    "it requires 13 elementary operations in its optimal implementation ( see figure [ cntcirc](c ) ) .",
    "the results in section [ sec : cc ] lead us to the following conclusion .",
    "minimization of toffoli gate count as a criterion for a reversible synthesis method is not optimal and even for small parameters may result in a seemingly small circuit which may be as far off a technologically favorable implementation as a factor of 8 .",
    "it is natural to expect that for circuits with more lines the difference will grow .",
    "we suggest that the commonly used gate count metric should be replaced with a metric that accounts for the different costs of large building block ( i.e. , toffoli gates ) , such as the weighted gate cost presented here .",
    "using such a metric would lead to the technologically favorable circuit ( b ) in figure [ max012circ ] .",
    "finally , we observe that for some small parameters minimizing the cost in any of the technology oriented metrics that we considered in this paper ( ncv-111 , ncv-155 or ncv-012 ) should result in a reasonably small if not optimal solution if another metric is applied to the cascade of gates .",
    "thus , at the present time it is sufficient to use any of the suggested technology oriented cost metrics . ncv-111 and ncv-155 are preferred over the ncv-012 metric , since all such realizations ( assuming reversible functions with no more than 3 variables ) have optimal ncv-012 cost .",
    "g.  yang , w.  n.  n. hung , x.  song , and m. a. perkowski exact synthesis of 3-qubit quantum circuits from non - binary quantum gates using multiple - valued logic and group theory . in _",
    "pages 434435 , 2005 ."
  ],
  "abstract_text": [
    "<S> a breadth - first search method for determining optimal 3-line circuits composed of quantum not , cnot , controlled-@xmath0 and controlled-@xmath1 ( ncv ) gates is introduced . </S>",
    "<S> results are presented for simple gate count and for technology motivated cost metrics . </S>",
    "<S> the optimal ncv circuits are also compared to ncv circuits derived from optimal not , cnot and toffoli ( nct ) gate circuits . </S>",
    "<S> the work presented here provides basic results and motivation for continued study of the direct synthesis of ncv circuits , and establishes relations between function realizations in different circuit cost metrics . </S>"
  ]
}