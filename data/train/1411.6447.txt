{
  "article_text": [
    "fine - grained classification is to recognize subordinate - level categories under some basic - level category , e.g. , classifying different bird types  @xcite , dog breeds  @xcite , flower species  @xcite , aircraft models  @xcite etc .",
    "this is an important problem with wide applications . even in the ilsvrc2012",
    "1k categories , there are 118 and 59 categories under the dog and bird class , respectively .",
    "counter intuitively , intra - class variance can be larger than inter - class , as shown in figure  [ fig : problem ] . consequently , fine - grained classification are technically challenging .",
    "specifically , the difficulty of fine - grained classification comes from the fact that discriminative features are localized not just on foreground object , but more importantly on object parts  @xcite ( e.g. the head of a bird ) .",
    "therefore , most fine - grained classification systems follow the pipeline : finding foreground object or object parts ( _ where _ ) to extract discriminative features ( _ what _ ) .",
    "for this to work , a bottom - up process is necessary to propose image regions ( or patches ) that have high _ objectness _ , meaning they contain parts of certain objects .",
    "selective search  @xcite is an unsupervised process that can propose such regions at the order of thousands .",
    "this starting point is used extensively in recent studies  @xcite , which we adopt as well .",
    "the bottom - up process has high recall but very low precision .",
    "if the object is relatively small , most patches are background and do not help classifying the object at all .",
    "this poses problems to the _ where _ part of the pipeline , leading to the need of top - down attention models to filter out noisy patches and select the relevant ones . in the context of fine - grained classification , finding foreground object and object parts can be regarded as a two - level attention processes , one at object - level and another at part - level .",
    "most existing methods rely on strong supervision to deal with the attention problem .",
    "they heavily rely on human labels , using bounding box for object - level and part landmarks for part - level . the strongest supervision settings leverage both in training as well as testing phase , whereas the weakest setting uses neither .",
    "most works are in between ( see section  [ sec : related ] for an in - depth treatment ) .",
    "since labeling is expensive and non - scalable , the focus of this study is to use the weakest possible supervision . recognizing the granularity differences , we employ two separate pipelines to implement object - level and part - level attention , but pragmatically leverage shared components .",
    "here is a high level summary of our approach :    * we turn a convolutional neural net ( cnn ) pre - trained on ilsvrc2012 1k category into a _",
    "filternet_. _ filternet _ selects patches relevant to the basic - level category , thus processes the object - level attention .",
    "the selected patches drive the training of another cnn into a domain classifier , called _ domainnet_. * empirically , we observe clustering pattern in the internal hidden representations inside the _ domainnet_. groups of neurons exhibit high sensitivity to discriminating parts .",
    "thus , we choose the corresponding filters as _ part - detector _ to implement part - level attention .    in both steps , we require only image - level labeling .",
    "the next key step is to extract discriminative features from the regions / patches selected by these two attentions .",
    "recently , there have been convincing evidence that features derived by cnn can deliver superior performance over hand - crafted ones  @xcite .",
    "following the two attention pipelines outlined above , we adopt the same general strategies . at the object - level , the domainnet directly output multi - view predictions driven by multiple relevant patches of an image . at the part - level",
    ", activations in the cnn hidden layers driven by detected parts yield another prediction through a _",
    "part - based classifier_. the final classification merges results from both pipelines to utilize the advantage of the two level attentions .",
    "our preliminary results demonstrate the effectiveness of this design . with the weakest supervision ,",
    "we improve the fine - grained classification in the dog and bird class of the ilsvrc2012 dataset from 40.1% and 21.1% to 28.1% and 11.0% , respectively . on the cub200 - 2011  @xcite dataset",
    ", we reach 69.7% , competitive to other methods that use stronger supervisions .",
    "our technique improves naturally with better networks , for example the accuracy reaches nearly to 78% using vggnet  @xcite .",
    "the rest of the paper is organized as follows .",
    "we first describe the pipeline utilizing object - level and part - level attentions for fine - grained classification in section [ sec : methods ] . detailed performance study and analysis",
    "are covered in section [ sec : experiment ] .",
    "related works are covered in section [ sec : related ] .",
    "finally , we discuss what we learned , future work and conclusion in section [ sec : conclusion ] .",
    "our design is based on a very simple intuition : performing fine - grained classification requires first to `` see '' the object and then the most discriminative parts of it . finding a chihuahua in an image entails the process of first seeing a dog , and then focusing on its important features that tell it apart from other breeds of dog .    for this to work our classifier",
    "should _ not _ work on the raw image but rather its constitute patches .",
    "such patches should also retain the most objectness that are relevant to the recognition steps . in the example above , the objectness of the first step is at the level of dog class , and that of the second step is at the parts that would differentiate chihuahua from other breeds ( e.g. ear , head , tail ) .",
    "crucially , recognizing the fact that detailed labeling are expensive to get and difficult to scale , we opt to use the weakest possible labels .",
    "our pipeline uses only the image - level labels .",
    "the raw candidate patches are generated in a bottom - up process , grouping pixels into regions that highlight the likelihood of parts of some objects . in this process",
    ", we adopt the same approaches as  @xcite and uses selective search  @xcite to extract patches ( or regions ) from input images",
    ". this step will provide multi - scale and multi - view of the original image .",
    "however , the bottom - up method will provide patches of high recall and low precision .",
    "top - down attention need to be applied to select the relative patches useful for classification .      [ [ patch - selection - using - object - level - attention ] ] patch selection using object - level attention + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this step filters the bottom - up raw patches via a top - down , object - level attention .",
    "the goal is to remove noisy patches that are not relevant to the object .",
    "we do this by converting a cnn trained on the 1k - class ilsvr2012 dataset into a object - level _",
    "filternet_. we summarize the activations of all the softmax neurons belonging to the parent class of a fine - grained category ( e.g. for chihuahua",
    "the parent class is the dog ) as the selection confidence score , and then set a threshold on the score to decide whether a given patch should be selected .",
    "this is shown in figure  [ fig : objectatt ] . through this way",
    ", the advantage of multi - scale and multi - view has been retained and also the noise has been filtered out .    [",
    "[ training - a - domainnet ] ] training a _ domainnet _ + + + + + + + + + + + + + + + + + + + + + +    the patches selected by the filternet are used to train a new cnn from scratch after proper warping .",
    "we call this second cnn the _ domainnet _ because it extracts features relevant to the categories belonging to a specific domain ( e.g. , dog , cat , bird ) .",
    "we note that from a single image many such patches are made available , and the net effect is a boost of data augmentation .",
    "unlike other data augmentation such as random cropping , we have a higher confidence that the patches are relevant .",
    "the amount of data also drives training of a bigger network , allowing it to build more features .",
    "this has two benefits .",
    "first , the domainnet is a good fine - grained classifier itself .",
    "second , its internal features now allow us to build part detectors , as we will explain next .",
    "[ [ classification - using - object - level - attention ] ] classification using object - level attention + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the patch selection using object - level attention can be naturally applied to the testing phase . to get the predicted label of an image",
    ", we provide the domainnet with the patches selected by the filternet to feed forward . then compute the average classification distribution of the softmax output for all the patches .",
    "finally we can get the prediction on the averaged softmax distribution .",
    "[ [ building - the - part - detector ] ] building the part detector + + + + + + + + + + + + + + + + + + + + + + + + + +    the work of dpd  @xcite and part - rcnn  @xcite strongly suggest that certain discriminative local features ( e.g. head and body ) are critical to fine - grained classification . instead of using the strong labels on parts and key points ,",
    "as is done in many related works  @xcite , we are inspired by the fact that hidden layers of the domainnet have shown clustering patterns .",
    "for example , there are groups of neurons respond to bird head , and others to bird body , despite the fact they may correspond to different poses . in hindsight , this is not at all surprising , given that these features indeed `` stand out '' and `` speak for '' a category .",
    "figure  [ fig : partatt ] shows conceptually what this step performs . essentially , we perform spectral clustering on the similarity matrix @xmath0 to partition the filters in a middle layer into @xmath1 groups , where @xmath2 denotes the cosine similarity of the weights of two mid - layer filters @xmath3 and @xmath4 in the domainnet . in our experiments , our network is essentially the same as the alexnet  @xcite , and we pick neurons from the 4th convolution layer with @xmath1 set to 3 .",
    "each cluster acts as a part detector .",
    "raw patches extracted from the image ( using selective search ) are warped to fit the receptive size of these neurons , and the clusters now vote and generate a final detection score .",
    "some detection results of the dog and bird class are shown on figure  [ fig : detectres ] .",
    "it s clear that one group of filters in bird domainnet pay specially attention to bird head , and the other group to bird body .",
    "similarly , for the dog domainnet , one group of filters pay attention to dog head , and one to dog legs . according to our practicing experience ,",
    "filters detect background noise will be clustered into one group .",
    "we can use the filter visualization technique or use a validation set at testing time to find it out to prevent the noise disturbing performance .",
    "[ [ building - the - part - based - classifier ] ] building the part - based classifier + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the patches that selected by the part detector generate activations inside the domainnet .",
    "we concatenate these activations and train a svm as the part - based classifier .          the domainnet classifier and the part - based classifier are both fine - grained classifiers .",
    "however , their functionality and strength differ , primarily because they admit patches of different nature . the bottom - up process using selective search",
    "are raw patches . from them ,",
    "the filternet selects multiple views that ( hopefully ) focus on the object as a whole ; these patches drive the domainnet . on the other hand ,",
    "the part - based classifier selects and works exclusively on patches containing discriminate and local features .",
    "finally , we merge the prediction results of the two level attention methods to utilize the advantage of the two .",
    "even though some patches are admitted by both classifiers , their features have different representation in each and can potentially enrich each other .",
    "figure  [ fig : whole_pipeline ] shows the complete pipeline and when we merge the results of the two level attention classifiers .",
    "this section presents performance evaluations and analysis of our proposed method on three fine - grained classification tasks :    * classification of two subsets in ilsvrc2012 , the dog dataset ( ilsvrc2012_dog ) and the bird dataset ( ilsvrc2012_bird ) .",
    "the firs contains 153,773 images of 118 breeds of dog , and the second contains 79,491 images of 59 types of bird .",
    "the train / test split follows standard protocol of ilsvrc2012 .",
    "both datasets are weakly annotated , where only class labels are available . * the widely - used fine - grained classification benchmark caltech - ucsd birds dataset  @xcite ( cub200 - 2011 ) , with 11,788 images of 200 types of birds . each image in cub200 - 2011 has detailed annotations , including image level label , bounding box and part landmarks .",
    "our cnn architecture is the popular alex net _",
    "et al . _",
    "@xcite , with 5 convolutional layers and 3 fully connected layers .",
    "it is used in all experiments , except the number of neurons of the output layer is set as number of categories when required .",
    "for a fair comparison , we try to reproduce results of other approaches on the same network architecture .",
    "when using cnn as feature extractor , the activations of the first fully - connected layer are outputted as features . finally , to demonstrate that our method is agnostic to network architecture and can improve with it , we also try to use the more recent vggnet  @xcite in the feature extraction phase . due to time limit",
    ", we have not replicated all results using the vggnet .      in this task ,",
    "only image - level class labels are available",
    ". therefore , fine - grained methods requiring detailed annotations are not applicable . for brevity",
    ", we will only report results on dog ; results of bird are qualitatively similar .",
    "the baselines are performance of cnn but trained with two different strategies , including :    * cnn_domain : the network is trained only on images from dog categories . in the training phase , randomly cropped @xmath5 patches from the whole image are used to avoid overfitting . in testing phase , softmax outputs of 10 fixed views ( the center patch , the four corner patches , and their horizonal reflections ) are averaged as the final prediction . in this method , no specific attention is used and patches are equally selected . * cnn_1k : the network is trained on all images of ilsvrc2012 1k categories , then the softmax neurons not belong to dog are removed .",
    "other settings are the same as above .",
    "this is a multi - task learning method that simultaneously learns all models , including dog and bird .",
    "this strategy utilizes more data to train a single cnn , and resist overfitting better , but has the tradeoff of wasting capacity on unwanted categories .",
    "these baseline numbers are compared with three strategies of our approach : using object - level and part - level attention only , and the combination of both .",
    "selective search proposes several hundred number of patches , and we let filternet to select roughly 40 of them , using a confidence score of 0.9 .    table  [ tab : imagenet ] summarizes the top-1 error rates of all five strategies .",
    "it turns out the two baselines perform about the same .",
    "however , our attention based methods achieves much lower error rates . using object - level attention only drops the error rate by 9.3% , comparing against cnn trained with randomly cropped patches .",
    "this clearly demonstrates the effectiveness of object - level attention : the domainnet now focuses on learning domain specific features from foreground objects . combining part - level attention , the error rate drops to 28.1% , which is significantly better than the baselines .",
    "the result of using part - level attention alone is not as good as object - level attention , as there are still more ambiguities in part level .",
    "however , it achieves pose normalization to resist large pose variations , and is complementary to the object - level attention .    [ cols=\"<,^,^\",options=\"header \" , ]     [ tab : optestcub ]    our results",
    "can be improved by using more powerful feature extractors .",
    "if we use the vggnet  @xcite to extract feature , the baseline method without attention by only using original image can be improved to 72.1% .",
    "adding object - level attention , part - level attention , and the combined attentions boost the performance to 76.9% , 76.4% and 77.9% , respectively .",
    "fine - grained classification has been extensively studied recently  @xcite .",
    "previous works have aimed at boosting the recognition accuracy from three main aspects : 1 . object and part localization , which can also be treated as object / part level attention ; 2 . feature representation for detected objects or parts ; 3 .",
    "human in the loop  @xcite . since",
    "our goal is automatic fine - grained classification , we focus on the related work of the first two .      in fine - grained classification tasks , discriminative features are mainly localized on foreground object and even on object parts , which makes object and part level attention be the first important step . as fine - grained classification datasets are often using detailed annotations of bounding box and part landmarks , most methods rely on some of these annotations to achieve object or part level attention .",
    "the strongest supervised setting is using bounding box and part landmarks in both training and testing phase , which is often used to test performance upbound  @xcite . to verify cnn features on fine - grained task ,",
    "bounding boxes are assumed given in both training and testing phase  @xcite .",
    "using provided bounding box , several methods proposed to learn part detectors in unsupervised or latent manner  @xcite . to further improve the performance , part level annotation",
    "is also used in training phase to learn strongly - supervised deformable part - based model  @xcite or directly used to finetune pre - trained cnn  @xcite .",
    "our work is also closely related to recently proposed object detection method ( r - cnn ) based on cnn feature  @xcite .",
    "r - cnn works by first proposing thousands candidate bounding boxes for each image via some bottom - up attention model  @xcite , then selecting the bounding boxes with high classification scores as detection results . based on r - cnn , zhang _ et al . _ has proposed part - based r - cnn  @xcite to utilize deep convolutional network for part detection .",
    "the other aspect to directly boost up the accuracy is to introduce more discriminative feature to represent image regions .",
    "et al . _ has proposed kernel descriptors  @xcite and were widely used in fine - grained classification pipelines  @xcite .",
    "some recent works try to learn feature descriptions from the data , berg _ et al .",
    "_ has proposed the part - based one - vs - all features library poof  @xcite as the mid - level features .",
    "cnn feature extractors pre - trained from imagenet data also showed significant performance improvement on fine - grained datasets  @xcite .",
    "further improved the performance of cnn feature extractor by fine - tuning on fine - grained dataset  @xcite .",
    "our approach adopts the same general principle .",
    "we also share the same strategy of taking region proposals in a bottom - up process to drive the classification pipeline , as is done in r - cnn and part r - cnn .",
    "one difference is that we enrich the object - level pipeline with relevant patches that offer multiple views and scales .",
    "more importantly , we opt for the weakest supervision throughout the model , relying solely on cnn features to implement attention , detect parts and extract features .",
    "in this paper , we propose a fine - grained classification pipeline combining bottom - up and two top - down attentions .",
    "the object - level attention feeds the network with patches relevant to the task domain with different views and scales .",
    "this leads to better cnn feature for fine - grained classification , as the network are driven by domain - relevant patches that are also rich with shift / scale variances .",
    "the part - level attention focuses on local discriminate patterns and also achieves pose normalization .",
    "both levels of attention can bring significant gains , and they compensate each other nicely with late fusion . one important advantage of our method is that , the attention is derived from the cnn trained with classification task , thus it can be conducted under the weakest supervision setting where only class label is provided .",
    "this is in sharp contrast with other state - of - the - art methods that require object bounding box or part landmark to train or test . to the best of our knowledge ,",
    "we get the best accuracy on cub200 - 2011 dataset under the weakest supervision setting .      * dealing with ambiguities in part level attention .",
    "our current method does not fully utilize what has been learned in cnn .",
    "filters of different layers should be considered as a whole to facilitate robust part detection , since part feature may appear in different layers due to the scale issue . * a closer integration of the object - level and part - level attention .",
    "one advantage of object - level attention is that it can provide large amount of relevant patches to help resist variance to some extend .",
    "however , this is not leveraged by the current part - level attention pipeline .",
    "we may borrow the idea of multi - patch testing to part - level attention method to derive more effective pose normalization ."
  ],
  "abstract_text": [
    "<S> fine - grained classification is challenging because categories can only be discriminated by subtle and local differences . </S>",
    "<S> variances in the pose , scale or rotation usually make the problem more difficult . </S>",
    "<S> most fine - grained classification systems follow the pipeline of finding foreground object or object parts ( _ where _ ) to extract discriminative features ( _ what _ ) .    in this paper , we propose to apply visual attention to fine - grained classification task using deep neural network . </S>",
    "<S> our pipeline integrates three types of attention : the bottom - up attention that propose candidate patches , the object - level top - down attention that selects relevant patches to a certain object , and the part - level top - down attention that localizes discriminative parts . </S>",
    "<S> we combine these attentions to train domain - specific deep nets , then use it to improve both the _ what _ and _ where _ aspects . </S>",
    "<S> importantly , we avoid using expensive annotations like bounding box or part information from end - to - end . </S>",
    "<S> the weak supervision constraint makes our work easier to generalize .    </S>",
    "<S> we have verified the effectiveness of the method on the subsets of ilsvrc2012 dataset and cub200_2011 dataset . </S>",
    "<S> our pipeline delivered significant improvements and achieved the best accuracy under the weakest supervision condition . </S>",
    "<S> the performance is competitive against other methods that rely on additional annotations . </S>"
  ]
}