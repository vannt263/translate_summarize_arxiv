{
  "article_text": [
    "one of the designed functions of the space telescope imaging spectrograph ( stis ) aboard the hubble space telescope ( hst ) is to obtain two - dimensional stellar spectroscopy similar to objective prism spectroscopy from the ground .",
    "however , the high angular resolution capabilities of the hst and stis are far better than can be obtained by comparable instrumentation from ground - based observatories .",
    "theoretically , spectra of stars with separations of less than 0.1@xmath1 can be disentangled and reliably studied .",
    "the stis has another advantage in that it can perform ultraviolet through optical ( 1150 - 10,000   ) spectroscopy of individual stars in star - forming regions anywhere in the local group . despite these instrumental capabilities ,",
    "no significant two - dimensional studies have been made of crowded stellar fields using the stis .",
    "this has been in part because of the lack of any data reduction and analysis software capable of extricating the overlapping spectra of stars in a densely populated field - of - view of a stis spectral image .    in this paper",
    ", we describe our data reduction software developed for processing stis spectral images of crowded stellar fields acquired with the g140l grating and the large 2@xmath1 wide aperture .",
    "specifically , we present a description of the software and techniques used in reducing and analyzing a stis ultraviolet spectral image of the ob association , ngc  604 .",
    "we observed with stis the uv - bright concentration of o and b stars in ngc  604 , the luminous star - forming region located in the spiral arms of the nearby galaxy m33 .",
    "ngc  604 is one of the brightest h ii regions in the local universe .",
    "furthermore , its close proximity ( d= 840 kpc ) makes it an excellent target to probe the details of enhanced star formation activity . our objective was to observe and resolve the young , embedded stars in the luminous h ii region and obtain ultraviolet spectra of large numbers of o and b stars from a single image . a full discussion of the subsequent analysis of these data are presented in the companion paper , bruhweiler , miskey , & smith neubig ( 2003 ; hereafter paper 2 ) .",
    "when obtaining an image with multiple objects in a single exposure , the overlapping spectra provide particular data reduction challenges .",
    "this is certainly the case for our stis data of ngc  604 . in what follows ,",
    "we describe aspects of data acquisition that affect the data reduction and discuss the basic technique used to produce accurate flux and wavelength calibrated spectra .",
    "we further present examples that give an assessment of the data quality of the extracted spectra .",
    "we obtained a two - dimensional , ultraviolet , spectral image ( dataset i d : o4xl01040 ) of the brightest concentration of stars in ngc  604 utilizing the stis aboard hst on 1998 august 27 .",
    "a 1720 second exposure was acquired with the fuv - mama detector , g140l grating , and 52@xmath0 aperture ( that effectively samples a 25@xmath0 field - of - view ( fov ) for the mama detector ) . the aperture was aligned with the position angle of the image y - axis at p.a .",
    "= -165.009 degrees east of north to maximize the number of bright stars in the slit , based on previous pre - costar hst wide field planetary camera ( wfpc ) imagery , as presented in @xcite , and wide field planetary camera 2 ( wfpc2 ) imagery ( see table 1 ) . see figure [ fig1 ] for an overlay of our stis aperture on an archival wfpc2 image taken with the f336w filter .",
    "( also , see paper 2 . ) for stars positioned along the long axis of the aperture , the low resolution ( @xmath2 2 - 3   ) g140l grating provides an effective wavelength range from 1150 to 1736   .",
    "the plate scale of the 1024 @xmath3 1024 pixel image is 0.0244 arcsec / pixel for the fuv - mama .",
    "although spectral images can be obtained of a larger number of stars using the slitless mode , the geocoronal emission would contaminate the entire fov , greatly increasing the background and lowering the signal - to - noise .",
    "the 2@xmath1 wide aperture is wide enough to include a large fraction of the o and b stars in ngc  604 , but still restrict the region of the spectrum affected by the high ly@xmath4 background .",
    "see section 3.4 for more discussion of the astronomical background .",
    "our data show at least 60 uv spectra of o and b stars ( see figure [ fig2 ] ) .",
    "geocoronal h  i - ly@xmath4 emission outlines the full 25@xmath1 length of the mama fov of the 2@xmath1 wide stis aperture .",
    "each spectrum clearly shows sharp interstellar absorption produced by gas in both the milky way and m33 galaxies .",
    "these components are unresolved spectroscopically , since the radial velocities of m33 and ngc  604 are v@xmath5179  km  s@xmath6 and @xmath7226  km  s@xmath6 , respectively @xcite , and appear as a merged single velocity component at the g140l resolution .",
    "these sharp interstellar lines include si  ii  @xmath81190,1193 , n  i  @xmath81198,1199,1200 , si  iii  @xmath91206 , si  ii  @xmath91260 , o  i  @xmath91302 , si  ii  @xmath91304 , c  ii  @xmath81334,1335 , si  iv  @xmath81393,1402 , si  ii  @xmath91526 , c  iv  @xmath81548,1550 , fe  ii  @xmath91608 , and al  ii  @xmath91670 .",
    "the interstellar si  iv and c  iv features are superposed upon broad stellar p  cygni mass loss features .",
    "other prominent broad features include interstellar h  i - ly@xmath4 , as well as stellar p  cygni n  v  @xmath81238,1240 and he  ii  @xmath91640 emission .",
    "the actual x - positions on the mama detector of the spectral lines are shifted , corresponding to the x - positions of the stellar sources in the 2@xmath1 wide aperture .",
    "besides the hst imagery of ngc  604 , we incorporated stis spectral images of other individual stars to both design and test our data reduction software .",
    "see table 1 for a list of the relevant datasets .",
    "in this section , we describe the process for modeling the cross dispersion profile ( cdp ) of a stis spectrum . to facilitate our discussion , in figure [ fig3 ]",
    "we present a flowchart summarizing the steps . because of the many subroutines and data products used in our data reduction , we also provide appendix a , which contains a glossary of our terms .",
    "the reader should feel free to refer to appendix a as necessary .",
    "we give a more detailed discussion of how and why we perform the cdp modeling below .",
    "to separate closely spaced spectra on the mama detector face of the stis , it is first necessary to accurately model an isolated spectrum produced by the mama / g140l configuration .",
    "this will generate key parameters defining the shape and variation across the detector of the cross dispersion profile of the spectrum .",
    "we have selected a 1024 pixel @xmath3 1024 pixel stis / g140l spectral image of the bright , nearby , hot , white dwarf , gd153 ( i d : o4a502060 ; see table 1 ) .",
    "we choose the uv spectrum of this star to model because gd153 represents a stis calibration target and is a continuum source with few photospheric or interstellar lines .",
    "all stis / g140l datasets used in this study undergo preliminary processing in advance to produce a flat - fielded image .",
    "this processing includes statistical error initialization , conversion to count rates , subtraction of a dark rate image , division by a flat - field , and bad / hot pixel processing .",
    "seven vertical crosscuts , @xmath10 , are taken of the white dwarf spectrum in the flat - fielded , background - subtracted stis image .",
    "the subscript @xmath11 denotes the index ( 1 - 7 ) corresponding to a specific x - value , and the @xmath12 represents a 1024 element array perpendicular to the dispersion .",
    "these seven crosscuts are each the sum of seven pixel wide slices centered at x@xmath13=[69 , 290 , 511 , 732 , 953 , 995 , 1017 ] .",
    "these x - positions correspond to default , unshifted wavelengths of @xmath14=[1164   , 1293   , 1422   , 1551   , 1680   , 1705   , 1718   ] .",
    "the spacing between these vertical slices at longer wavelengths is smaller because the response curve of the mama detector changes more rapidly at higher x - values ( longer wavelengths ) .",
    "( see figure [ fig4 ] . )",
    "each of these slices is fit very accurately with a function represented by the sum of three gaussians , @xmath15 , each centered on the peak of the spectrum .",
    "see figure [ fig5 ] for three of the cdp crosscuts ( @xmath16 ) overplotted with heavy dotted curves denoting our triple - gaussian fits ( @xmath17 ) .",
    "each @xmath15 is then normalized by dividing by the total integrated area of its triple - gaussian profile .",
    "these seven normalized fits , @xmath18 , determine the shape of the stellar spectrum perpendicular to the dispersion ( cdp ) as a function of x ( wavelength ) .",
    "these normalized triple - gaussian profiles represent our new weighted extraction slit and replace the box - car slit used in standard stis data processing .      in this section ,",
    "we describe the development of our data reduction procedure , stisfit , written by c. l. miskey in the interactive data language ( idl ) .",
    "we utilize this set of programs for the subsequent spectral extractions .",
    "the simple flowchart in figure [ fig6 ] outlines the development process for which we provide a more detailed discussion below .",
    "we use our software first to perform the background subtraction for the region in the stis image surrounding the stellar spectrum of gd153 , which is trivial for data with a single star in the aperture .",
    "two background slices ( one above and one below ) , each 5 pixels wide by 1024 pixels long , are taken from areas immediately adjacent to the spectrum , but far enough removed not to be contaminated by stellar flux .",
    "this background array is averaged and then subtracted from the data .",
    "second , a generic template of a stis spectral image is constructed using the @xmath18 arrays .",
    "a two - dimensional template array is built , @xmath19 , 1024 pixel columns by 1024 pixel rows .",
    "each @xmath11 of the @xmath18 is associated with a proper wavelength .",
    "since gd153 is centered in the aperture , we use the default , unshifted , heliocentric wavelength scale , @xmath20 , spanning 1150 - 1736   .",
    "each x ( or wavelength ) column of the template is individually created by linearly interpolating between corresponding values in the two bracketing vertical fits , @xmath21 and @xmath18 . for values of x@xmath2269 ( @xmath11=1 ) , @xmath23 is used .",
    "likewise , @xmath24 .",
    "the previous step addresses variations in the cdp across the array in x. however , we must also consider corrections in the y - direction .",
    "a stis stellar spectrum is not straight , but has a curvature that varies along the dispersion .",
    "this curvature is not fixed , but also varies relative to y - position on the detector .",
    "this spatial distortion has been accurately delineated by don lindler , who has compiled a reference file , _ exttab _",
    ", for the g140l grating containing distortion curves for 27 different positions along the y - axis @xcite",
    ". similar _ exttab _",
    "files assembled by lindler exist for all of the other stis gratings .",
    "the curvatures for y - positions intermediate to those positions in the table are calculated through linear interpolation .",
    "we define the y - position of a spectrum , represented by the variable @xmath25 in our software , as the y - location of the center of the spectrum at x=512 in the 1024 @xmath3 1024 pixel stis spectral image .",
    "this definition is used throughout the paper . using the g140l _ exttab _ file and the y - location of gd153 on the detector , the template array , @xmath19 ,",
    "can easily be corrected for spatial distortion .",
    "the location of the spectral peak in @xmath19 is mapped to the calculated distortion for each column of the array .",
    "the spatial distortion across the stis detector for three different y - positions is plotted in figure [ fig7 ] .",
    "a horizontal , dotted line runs through the star s central location at x=512 . note that the deviations in y of the spectrum are most pronounced at extreme low and high values of x.    finally , this corrected data template is applied to the stis image for gd153 .",
    "each of the 1024 columns of the @xmath19 array is fit to each of the 1024 columns of the flat - fielded , background - subtracted data , @xmath26 , using a linearization of the fitting function , to produce an array containing the model spectrum , @xmath27 .",
    "the routine generating @xmath27 uses the same technique as bevington s curfit @xcite . using the notation of bevington , for a function y ( the column of @xmath19 being fit ) of parameters a(i ) ,",
    "the routine uses a linear expansion of y as a function of a(i ) . the array",
    "a has @xmath28 values ( where @xmath28 equals the number of stellar sources ; here @xmath28=1 ) denoting the amplitude(s ) of the triple - gaussian function(s ) .",
    "the y is evaluated for a set of parameters a and the array of independent variables x. the procedure uses generalized least - squares to find the parameter increments which minimize @xmath29 .",
    "the program automatically iterates through parameter step sizes , which are controlled by input parameters .",
    "standard deviation errors are approximated by the inverse of the curvature matrix , ( 1/@xmath30 ) .",
    "the resulting fits show extremely good correlation .",
    "we calculate the least squares fit between the actual , background - subtracted image and our stisfit model image .",
    "+   + @xmath31 ^ 2}}}{\\sum_{x=1}^{1024}{\\sum_{y=-50}^{50}{[image(x , cent+y)]^2 } } } \\times 100\\%}$ ] . +   + for gd153 , a result of 0.39% is obtained .    the stisfit net spectrum , @xmath32 ,",
    "is then created by summing an eleven pixel wide horizontal slice of the @xmath27 , centered on the stellar y - location .",
    "this extraction is not a straight horizontal cut , but follows the curvature on the detector characterized by the _",
    "exttab _ file , as described above .",
    "@xmath32 is in units of counts  second@xmath6  pixel@xmath6 .",
    "we derive a new sensitivity curve , @xmath33 , by requiring that our spectral extraction yield the same measured fluxes versus wavelength for gd153 as the calstis extraction .",
    "calstis is the standard stis processing routine used in the laboratory for astronomy and solar physics at nasa / goddard space flight center @xcite .",
    "also , a very similar version of calstis is used in the stsci pipeline processing @xcite .",
    "our stisfit sensitivity curve , @xmath33 , is determined by dividing the gd153 , flux - calibrated spectrum generated by calstis by our net stisfit spectrum , @xmath32 .",
    "this curve is dependent on wavelength .    with x corresponding to the unshifted wavelength array , @xmath20 ,",
    "the stisfit sensitivity curve is multiplied by the stisfit generated net spectrum to yield the final , flux - calibrated , stellar spectrum ; @xmath34 .",
    "the flux spectrum is in units of ergs  sec@xmath6  @xmath35  @xmath6 .    upon inspection of figure [ fig8 ]",
    ", one sees that our final flux spectrum of gd153 differs slightly from the calstis spectrum at low wavelengths .",
    "this is because the mama detector has low sensitivity in this region , which leads to low signal - to - noise for the data and to a correspondingly less accurate sensitivity curve in the region shortward of 1200   .",
    "therefore , we have chosen to smooth the derived @xmath33 through this region to reduce the effects of noise and produce a more reliable sensitivity curve at these wavelengths .      to test",
    "how closely our stisfit procedure reproduces calstis spectra , we calculate the percentage difference and average deviation between the extracted flux spectra generated by these two methods . here , the percentage difference and average deviation are given by : +   + @xmath36}}{\\sum_{x=1}^{1024}{calstis(x ) } } \\times 100\\%}$ ] + and + @xmath37 ^ 2}}}{\\sum_{x=1}^{1024}{calstis(x ) } } \\times 100\\%}$ ] . +   + we use the stis / g140l datasets of three stellar objects , gd153 , ngc  346 - 368 , and sand  3 .",
    "all are stellar point sources , but each has a different type of spectrum .",
    "as previously stated , gd153 is a hot , white dwarf , continuum source with few photospheric or interstellar lines .",
    "the object ngc  346 - 368 is a luminous o star in the small magellanic cloud with a rich photospheric absorption spectrum , while sand  3 is a hot , pre - white dwarf with a wolf - rayet emission line spectrum .",
    "( see figure [ fig8 ] . ) for the percentage differences , we obtain -0.06% , 2.34% , and 1.20% , respectively .",
    "the percentage difference indicates how closely the total flux is reproduced between the calstis and stisfit spectra .",
    "the small values indicate that the total flux is conserved to within 2.5% in our worst case .",
    "these differences are in accord with the variations in sensitivity of the mama / g140l @xcite .",
    "we expect a very small value for gd153 , since it is the spectrum used to construct the stisfit procedure , and one of our requirements of @xmath33 is that stisfit yield the same flux values as calstis .",
    "the insignificant difference is due to smoothing of the stisfit sensitivity curve at lower wavelengths ( @xmath38 1200   ) .",
    "the largest variation is for an object with a rich line spectrum . for the average deviation ,",
    "we calculate 0.64% , 3.77% , and 2.82% , respectively .",
    "these results give us sufficient confidence in our procedures to apply them to our ngc  604 dataset .",
    "we apply the newly developed routines , stisfit , to our stis / g140l spectral image of ngc  604 .",
    "this set of programs has the capability to produce extracted , flux and wavelength calibrated , spectra for clusters of stars as well as isolated stars .",
    "the final calibrated spectra are produced in a two step process .",
    "we include a simple flowchart in figure [ fig9 ] , which outlines the reduction procedure described in detail below .",
    "the first step is to use stisfit to create an extracted , uncalibrated spectrum for each star .",
    "we start by removing the background from the flat - fielded stis image .",
    "the sky background has several major contributions .",
    "the geocoronal emission is comprised of the diffuse h  i - ly@xmath4 at 1216    and the much weaker o  i  @xmath91304 .",
    "these geocoronal emission lines fill the entire 2@xmath1 wide slit in the spatial dimension and yield two vertical bands , one bright and the other much fainter , in the spectral image .",
    "the h  i - ly@xmath4 band is quite distinct in the spectral image displayed in figure [ fig2 ] .",
    "the weak o  i emission is at most 10% of the h  i - ly@xmath4 in brightness , depending on the time of the observation and the position of the target relative to the earth . in our observation ,",
    "o  i is negligible .    because the scattered light from dust is essentially scattered uv stellar flux , its spectral characteristics mimic the spectra of the adjacent stars .",
    "consequently , care must be taken in applying any background subtraction .",
    "this is especially the case for stars with low uv flux , where the accuracy of the background subtraction has a larger effect on the net spectrum . in the uv wavelength range sampled by the g140l",
    ", nebular emission lines appear to be a negligible contribution to the background .",
    "the most variable procedure in our data reduction scheme is the background subtraction .",
    "ideally , one wants to determine the background as close to the stellar source as possible .",
    "depending upon the degree of crowding in the fov , different techniques may need to be applied .",
    "as long as there is a reasonable amount of area free of stellar flux in the image , the standard background subtraction , averaging two bordering background strips , can be performed .",
    "however , for a spectral image that contains very little area uncontaminated by stellar flux , a background image must be tailor - made .",
    "our ngc  604 image presents such a severe case .    in our ngc  604 spectral image",
    ", the densely populated stellar field makes it impossible to obtain direct background measurements adjacent to most of the individual spectra and subtract the background in the usual manner .",
    "hence , we create a 1024 @xmath3 1024 pixel array of the underlying background to be subtracted . to map the background relative to wavelength , two horizontal strips of the stis image ( one in the lower portion and one in the upper portion of the dataset ) , 1024 pixels long by 10 pixels wide , are extracted and averaged from regions of the image containing no detectable uv stellar sources .",
    "the section containing the geocoronal h  i - ly@xmath4 emission is assigned zero weight , and a 6th order polynomial is fit along x to the averaged background strip .",
    "the h  i - ly@xmath4 band is then modeled with 2nd order polynomials for the regions corresponding to the edges of the 2@xmath1 wide aperture and a mean constant value denoting a flat plateau for the top .",
    "these curves are combined to form the model , continuous , functional fit of the background in the x - direction , @xmath39 .",
    "several vertical crosscuts of the image are then taken , and the minimum background values in the y - direction are measured to create an array of background levels perpendicular to the dispersion , @xmath40 .",
    "the two arrays @xmath39 and @xmath40 are combined , yielding a complete two - dimensional model , @xmath41 , for the background of the stis spectral image of ngc  604 .",
    "we find this method of background determination quite reliable .",
    "after the background model is subtracted from the image , stisfit begins the spectral extractions .",
    "it is very important to accurately determine the location of the center of each stellar spectrum , @xmath42 , preferably on the sub - pixel level .",
    "this is necessary to properly apply our triple - gaussian spectral extraction algorithm .",
    "isolated spectra are extracted individually for faster processing . for regions where",
    "a group of stellar spectra overlap or contaminate the local background , these spectra are all modeled together .",
    "the variable @xmath28 equals the number of stars in each extraction set . for each grouping",
    ", a @xmath43 array is assembled with @xmath28 triple - gaussian functions representing each of the point sources , corrected for stellar locations in the aperture and spatial distortions on the detector face .",
    "next , the template @xmath43 is fit to the flat - fielded , background - subtracted @xmath26 . a model for each spectrum , @xmath44 ,",
    "is then extracted from the grouped @xmath45 .",
    "the second step is to calculate the wavelength offset of each star and create the final , extracted , wavelength and flux calibrated , spectra .",
    "first , strong interstellar lines are identified from the uncalibrated spectra .",
    "these sharp , identified , spectral features serve as fiducial reference wavelengths .",
    "they are used to calculate @xmath46 , the x - position ( wavelength ) offset relative to the default , where the star is centered in the aperture .",
    "our corrected , heliocentric , wavelength array , @xmath47 , is determined by using @xmath46 to shift the initial wavelength array , @xmath20 , for each spectrum accordingly .",
    "the @xmath33 array is mapped onto the new wavelength scales , producing the corrected sensitivity curves , @xmath48 .",
    "the @xmath9 subscript denotes that the x array correlates to a shifted wavelength scale .",
    "the @xmath46 array is then used in a second run of our fitting routine , stisfit , to properly align the @xmath18 arrays with their corresponding shifted wavelengths when the initial @xmath43 template is built .",
    "the shifted @xmath43 is fit to @xmath26 , yielding @xmath45 .",
    "the new @xmath44 is extracted .",
    "the shifted sensitivity curves , @xmath48 , are multiplied by the results from the second pass of stisfit , @xmath44 , yielding the final , wavelength (  ) and flux ( ergs  sec@xmath6  @xmath35  @xmath6 ) calibrated , stellar spectra , @xmath49 .",
    "upon close examination of figure [ fig8 ] , one finds that our stisfit extraction , utilizing the triple - gaussian fit to the cross dispersion profile as represented in figure [ fig5 ] , produces deeper , sharper , absorption features than the calstis extraction .",
    "these differences are most apparent in the comparison of the processing of the g140l data for the bright o star , ngc346 - 368 , in the h ii region , ngc  346 , of the smc .",
    "this is displayed in the middle panel of figure [ fig8 ] .",
    "likewise , narrower , sharper n  v  @xmath91240 , si  iv  @xmath91400 , c  iv  @xmath91550 , and he  ii  @xmath91640 profiles are also seen in the stisfit spectrum in the comparison for the strong emission line object , sand  3 , in the bottom panel of figure [ fig8 ] .",
    "the slightly sharper features in our stisfit extractions imply that stisfit yields improved spectral resolution over the calstis processing .",
    "this might be expected , since our triple - gaussian function gives higher weight to data near the center of the spectrum , whereas the box - car extraction used in calstis gives equal weight to all datapoints .",
    "the cdp can be thought of as the total contribution of the individual point spread functions ( psfs ) produced at every wavelength along the spectrum .",
    "when using a narrow slit , the psf contribution is limited to the truncated portion that passes through the slit and is imaged on the detector .",
    "this restricts the effects of the psfs at greater distances in the dispersion direction .",
    "the contribution from non - local psfs at any point on the cdp away from the spectral peak , perpendicular to the dispersion , drops off dramatically due to truncation from the narrow slit .",
    "however , the spectral images discussed here were obtained with the 2@xmath1 wide slit .",
    "the psfs are not truncated , unlike the case for the narrow slit .",
    "thus , at any specific wavelength , @xmath50 , as one moves away from the center of the spectrum , perpendicular to the dispersion , there are higher fractional contributions to the flux from wavelengths farther from @xmath50 . since our triple - gaussian extraction slit gives higher weight to points near the center of the spectrum , the derived stisfit fluxes at @xmath50 are determined by points much more local to @xmath51 than for the box - car extraction fluxes .",
    "other similar diffraction effects are discussed in chapter 13 of the stis instrument handbook @xcite and in @xcite .    to quantitatively determine if stisfit produces higher resolution data , one can compare both low resolution g140l stisfit and calstis extractions with a higher resolution e140 m calstis extraction for the same object .",
    "the stis / e140 m echelle grating ( r @xmath2 10,000 ) spans the same wavelength range as the g140l .",
    "the better g140l extraction should yield spectral line measurements more consistent with those obtained from the e140 m spectrum . for our comparison ,",
    "we select the star ngc  346 - 368 , since it has been observed with both gratings .",
    "we compare the three extractions , and , as expected , the e140 m data clearly show much sharper spectral features than those of both g140l extractions .",
    "we measure the equivalent widths of the strong interstellar lines in all three extracted spectra . for the g140l data , the stisfit spectrum yields larger equivalent widths than the calstis spectrum .",
    "the stisfit equivalent widths agree better with those measured in the e140 m dataset , but are still systematically smaller .",
    "this comparison indicates that the stisfit extracted spectra provide better quantitative measurements for critical spectral parameters such as equivalent width .",
    "we also estimate the actual spectral resolution for the two g140l extractions .",
    "we do this by convolving ( smoothing ) the e140 m data with a single gaussian profile and correlating the result to the stisfit and calstis datasets .",
    "the full width half maximum ( fwhm ) of the gaussian smoothing is varied to obtain a least - square minimum ( minimizing @xmath52 ) .",
    "the best matches to the stisfit and the calstis spectra are achieved if the e140 m spectrum is convolved with gaussians with fwhms equal to 2.2    ( r @xmath2 640 ) and 3.0    ( r @xmath2 470 ) , respectively .",
    "( see figure [ fig10 ] . )",
    "since the unsmoothed , intrinsic resolution for the e140 m grating is a factor of 15 to 21 times higher , these two deduced values are good estimates of the spectral resolution near 1380   .",
    "once again , our analysis suggests a higher resolution for the stisfit extraction .",
    "all resolution tests were performed on datasets obtained with the 2@xmath1 wide aperture .",
    "we have not used our developed software to reduce any narrow slit stis data .",
    "hence , we do not know if , given the effects of psf truncation , our stisfit technique would still yield a higher resolution in such cases .",
    "perhaps the most important feature of our stisfit process is its ability to extract several closely spaced spectra concurrently . by modeling each stellar spectrum with its own triple - gaussian fit , we are able to successfully separate out each star s flux contribution and minimize cross - contamination between neighboring spectra .",
    "the standard stis processing method can only extract one spectrum at a time with an eleven pixel wide box - car extraction slit .",
    "hence , it has no means of dealing with multiple overlapping spectra .    one excellent example in our ngc  604 dataset is the stellar complex near y=578 , composed of three overlapping stars , 578a , 578b , and 578c .",
    "( see figure [ fig2 ] . ) their spectral centers , @xmath42 , are located at y=[578.700 , 580.945 , 583.626 ] in the image , corresponding to separations of 2.245 and 2.681 pixels , or 0.055@xmath1 and 0.065@xmath1 , in the y - direction .",
    "the stisfit procedure produces three clean , low - noise spectra with very little cross - talk .",
    "( see figure [ fig11 ] . )",
    "moreover , the spectral features and shape are consistent with what is expected for o9 stars .",
    "this is even the case in the region beyond 1600   , where the sensitivity of the mama falls off sharply .",
    "we have presented the basic techniques that compose our stisfit extraction procedure for stis spectral images of crowded stellar fields .",
    "the foundation of our process is a triple - gaussian extraction slit that gives higher weighting to flux values near the center of the spectrum .",
    "as illustrated in figure [ fig5 ] , the triple - gaussian profile very closely fits the cdp , which enables us to determine the amount of flux corresponding to each stellar source for a group of overlapping spectra . we have made use of the g140l spatial distortion reference file such that our extraction procedure can accurately track a spectrum at any position in the two - dimensional stis spectral image . the resulting stisfit spectra yield deeper stellar absorption features .",
    "our tests indicate that the spectral resolution for stisfit spectra are slightly better than that of the standard calstis or stsci pipeline processing .",
    "furthermore , the strengths of the stisfit extraction technique have allowed us to produce reliable , flux and wavelength calibrated , g140l spectra for stars separated by as little as 0.055@xmath1 in the direction perpendicular to dispersion .",
    "this is at or near the spatial resolution limit of stis .",
    "additional examples of our extracted spectra can be found in paper 2 .",
    "we have recently expanded the stisfit software to include the other low resolution grating configurations of stis .",
    "our software routines are now applicable to spectral images obtained by both mama and ccd detectors , several different gratings , and the 52@xmath1 @xmath3 2@xmath1 and slitless aperture modes .",
    "these improvements allow us to now obtain continuous spectral coverage , from ultraviolet through optical wavelengths , of individual stars in crowded fields",
    ". we will present observational results and assessments of these techniques in following papers .",
    "we wish to acknowledge the assistance and invaluable advice provided by don lindler , nicholas collins , eliot malamuth , and charles bowers ; all are members of the stis instrument development or support groups at nasa / goddard space flight center .",
    "we also acknowledge support through nasa grant nag5 - 3378 .",
    "the ngc  604 stis spectral image was obtained under guaranteed observing time awarded to dr .",
    "albert boggess .",
    "two - dimensional model array of the background for our stis spectral image .",
    "bevington , p. r. 1969 , data reduction and error analysis for the physical sciences ( new york : mcgraw - hill , inc . ) bowers , c. & baum , s. 1998 , stis instrument science report 98 - 24 brown , t. , et al .",
    "2002 , hst stis data handbook , version 4.0 , ( baltimore : stsci ) bruhweiler , f. c. , miskey , c. l. , & smith neubig , m. 2003 , aj , submitted ( paper 2 ) drissen , l. , moffat , a. f. j. , & shara , m. m. 1993 , aj , 105 , 1400    helou , g. , madore , b. f. , schmitz , m. , wu , x. , corwin , h. g. , jr . ,",
    "lague , c. , bennett , j. , & sun , h. 1995 , the nasa / ipac extragalactic database , information & on - line data in astronomy , ed .",
    "d. egret & m. a. albrecht .",
    "ap&ss , 203 , 95 leitherer , c. , et al .",
    "2001 , stis instrument handbook , version 5.1 , ( baltimore : stsci ) lindler , d. 1999 , calstis reference guide , version 6.4 , ( greenbelt , md : gsfc ) stys , d. j. , & walborn , n. r. 2001 , stis instrument science report 2001 - 01r    ccccc gd153 & stis & g140l & 1425 & o4a502060 + ngc  346 & stis & g140l & 1425 & o46j01010 + & stis & e140 m & 1425 & o4wr01030 + ngc  604 & stis & g140l & 1425 & o4x101040 + & wfpc2 & f336w & 3344 & u2ab0207 t + & wfpc2 & f336w & 3344 & u2ab0208 t + & wfpc & f439w & 4353 & w0nn0101 t + & wfpc & f439w & 4353 & w0nn0102 t + & wfpc & f439w & 4353 & w0nn0103 t + sand  3 & stis & g140l & 1425 & o4x101030 +"
  ],
  "abstract_text": [
    "<S> we have developed a data reduction procedure to extract multiple spectra from a single two - dimensional space telescope imaging spectrograph ( stis ) image of a crowded stellar field . </S>",
    "<S> this paper provides a description of our new technique , utilizing a stis ultraviolet spectral image , acquired with the g140l grating and the 52@xmath0 aperture , sampling a concentration of o and b stars in the central region of the ngc  604 starburst in m33 . </S>",
    "<S> the software routines can disentangle and produce reliable ultraviolet spectra of stars with angular separations as small as 0.055@xmath1 . </S>",
    "<S> use of the extraction slit , based upon our model of the spectral cross dispersion profile , generates spectra with slightly higher resolution than the stsci standard processing . </S>",
    "<S> our results clearly show that the spectral imaging capability of stis represents a powerful tool for studying luminous stars in the star - forming regions of the local group . </S>"
  ]
}