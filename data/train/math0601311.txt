{
  "article_text": [
    "a finitely generated group is _ word hyperbolic _",
    "@xcite if it acts properly and cocompactly on a metric space ( e.g. , its cayley graph ) satisfying a certain coarse geometric property called gromov hyperbolicity ( definition [ d : hyperbolic ] below ) .",
    "two spaces acted on properly and cocompactly by the same group will have the same coarse geometry , so word hyperbolicity depends only on the group in question . for example , the fundamental group of a compact hyperbolic @xmath2-manifold acts properly and cocompactly on the hyperbolic space @xmath3 , and so is word hyperbolic .",
    "if @xmath0 is the fundamental group of a non - compact but finite volume hyperbolic @xmath2-manifold , then @xmath0 also has an apparently natural action on @xmath3 .",
    "we wish to say that groups with such actions on gromov hyperbolic spaces are _ relatively hyperbolic_. considering the case of fundamental groups of finite area hyperbolic surfaces , we see that it is necessary first to specify a collection of `` peripheral '' subgroups to determine an action up to some kind of coarse equivalence .",
    "thus it makes no real sense to ask whether a group is _ relatively hyperbolic _ , but only to ask whether a group is hyperbolic _ relative _ to a collection of subgroups .",
    "there are several competing ways to say what it means for a group to be ( strongly ) hyperbolic relative to a collection of subgroups @xcite .",
    "these definitions are now all known to be equivalent .. ) to the infinitely generated setting , and proved its equivalence to osin s definition . ]",
    "( see section [ ss : relhyp ] for precise definitions and more examples of relatively hyperbolic groups . )",
    "this paper has three main purposes .",
    "first , we introduce a new space ( the `` cusped space '' ) for studying relatively hyperbolic groups ( section [ section : cusped ] ) .",
    "second , we construct a pair of useful bicombings on this space ( sections [ section : pp ] and [ section : bicombing ] ) .",
    "third , we extend thurston s hyperbolic dehn surgery theorem to the context of ( torsion - free ) relatively hyperbolic groups ( part 2 ) .",
    "we discuss these now in turn .      roughly speaking , a group @xmath0 is hyperbolic relative to a collection @xmath4 of subgroups if the geometry of @xmath0 is @xmath5-hyperbolic , except for that part corresponding to the subgroups in @xmath4 . in subsection [ ss : combhoro ]",
    "we define _ combinatorial horoballs _ which are a way of embedding any graph into a @xmath5-hyperbolic graph .",
    "we build the cusped space by gluing onto the cayley graph of @xmath0 a collection of combinatorial horoballs , one for each coset of each subgroup in @xmath4 .",
    "the resulting space is gromov hyperbolic if and only if @xmath0 is hyperbolic relative to @xmath4 . in case",
    "the space is gromov hyperbolic , the action of @xmath0 on the space satisfies the conditions given in gromov s original definition of relative hyperbolicity ( definition [ d : gromovrh ] ) .",
    "the cusped space thus combines the most useful combinatorial and coarse geometric aspects of relatively hyperbolic groups . a closely related construction appears in work of cannon and cooper @xcite ( see also @xcite for another related construction ) . as in @xcite , if @xmath0 is the fundamental group of a finite volume hyperbolic @xmath2-manifold , and @xmath4 consists of the fundamental groups of the cusps , the space we build is quasi - isometric to @xmath6 , though we do not provide a proof of this here .",
    "part of the novelty of the cusped space compared to the one in @xcite is that it is a graph ( metrized so the length of each edge is @xmath7 ) , so that the metric and combinatorial aspects harmonize with each other more easily .",
    "this allows us to more easily adapt a number of constructions and results in word hyperbolic groups to the relative setting .",
    "in particular , we consider combinatorial isoperimetric inequalities ( subsection [ s : combii ] ) , homological isoperimetric inequalities ( subsection [ s : hom ] ) , and a construction of mineyev from @xcite . considering the different types of isoperimetric inequalities and spaces , we get a number of new characterizations of relatively hyperbolic groups .",
    "let @xmath0 be a finitely generated group which is finitely presented relative to a collection @xmath8 of finitely generated subgroups ( see subsection [ s : relpres ] ) .",
    "let @xmath9 be the coned - off cayley graph for @xmath0 with respect to @xmath4 ( see definition [ d : conedgraph ] ) , @xmath10 the coned - off cayley complex ( see definition [ d : conedcomplex ] ) , and let @xmath11 be the cusped space associated to @xmath0 and @xmath4 ( defined in section [ section : cusped ] ) .",
    "then we have    * theorem [ t : tfae ] *    _ the following are equivalent : _    1 .",
    "@xmath0 is hyperbolic relative to @xmath4 in the sense of gromov ; 2 .",
    "@xmath0 is hyperbolic relative to @xmath4 ( i.e. @xmath9 is gromov hyperbolic and fine ) ; 3 .",
    "@xmath10 satisfies a linear combinatorial isoperimetric inequality ; 4 .",
    "@xmath10 satisfies a linear homological isoperimetric inequality ; 5 .",
    "@xmath12 is gromov hyperbolic ; 6 .",
    "@xmath11 satisfies a linear combinatorial isoperimetric inequality ; 7 .",
    "@xmath11 satisfies a linear homological isoperimetric inequality .",
    "see subsection [ s : combii ] and definition [ d : hlii ] for definitions of linear isoperimetric inequalities ( both combinatorial and homological ) .",
    "the equivalence of and is by now well known ( see , for example , ( * ? ? ?",
    "* appendix ) ) .",
    "as far as we are aware , the equivalence of and has not appeared elsewhere , though it is implicit in @xcite .",
    "what is really novel about theorem [ t : tfae ] is the space @xmath11 and the use of homological isoperimetric inequalities .",
    "the second main purpose of this paper is the construction in sections [ s : horoballs][section : bicombing ] of a pair of useful bicombings on the cusped space . in section [ s :",
    "horoballs ] we prove a general result about convex sets and between - ness in a gromov hyperbolic space @xmath13 .",
    "given a family @xmath14 of ` sufficiently separated ' convex sets we construct , for any pair of points @xmath15 , a canonical collection of sets in @xmath14 which are ` between ' @xmath16 and @xmath17 .",
    "these collections satisfy a number of axioms , and allow a great deal of combinatorial control over triangles in @xmath13 built from quasi - geodesics using our construction .",
    "this analysis is undertaken in section [ section : pp ] , where we define _ preferred paths _ for our space @xmath11 .",
    "these give a @xmath0-equivariant bicombing of @xmath11 by uniform quasi - geodesics , whose intersection with horoballs is very controlled ( this is where the results from section [ s : horoballs ] are used ) . in particular ( possibly partially ideal ) triangles",
    "whose sides are preferred paths have very well controlled combinatorial structure ( see subsection [ s : preftri ] for details on this ) .",
    "we expect that the construction in section [ s : horoballs ] and that of preferred paths in section [ section : pp ] will have many applications .",
    "the first is the bicombing @xmath18 which is defined in section [ section : bicombing ] .",
    "this gives a relatively hyperbolic version of a construction of mineyev from @xcite .",
    "applications of mineyev s construction are myriad ( see , for example , @xcite ) .",
    "it can reasonably be expected that many of these results can be extended to the relatively hyperbolic setting using the bicombing from section [ section : bicombing ] of this paper , or variations on it . in particular , in @xcite",
    ", we define a homological bicombing on the coned - off cayley graph of a relatively hyperbolic group ( using the bicombing from this paper in an essential way ) in order to investigate relative bounded cohomology and relatively hyperbolic groups , in analogy with @xcite and @xcite .",
    "also , in @xcite , the first author proves that if the parabolic subgroups of @xmath0 act ` nicely ' on a strongly bolic metric space ( as defined by lafforgue @xcite ) then so does @xmath0 . using the work of lafforgue @xcite and druu and sapir @xcite ,",
    "this has implications for the baum - connes conjecture for certain relatively hyperbolic groups .",
    "it is also worth noting that in part 2 of this paper , the major tool is preferred paths .",
    "the only time when we need the homological bicombing ( which is the analogue of mineyev s construction ) is in the proof of theorem [ t : zhlii ] . otherwise , we use only the results from section [ section : pp ] , which have no relation to mineyev s construction .",
    "part 2 of this paper is devoted to another application of the constructions of part 1 .",
    "we investigate a group theoretic analog of dehn filling , which is the third and final purpose of this paper .",
    "we first briefly remind the reader what is meant by `` dehn filling '' in the context of @xmath19-manifolds .",
    "suppose that @xmath20 is a compact @xmath19-manifold , with some component @xmath21 of @xmath22 homeomorphic to a torus .",
    "let @xmath23 be an essential simple closed curve in @xmath21 .",
    "let @xmath24 be a solid torus , and @xmath25 a meridian for @xmath24 ( a curve which bounds an embedded disk in @xmath24 ) , and let @xmath26 be a homeomorphism of pairs .",
    "the @xmath19-manifold @xmath27 obtained by gluing using @xmath28 is called the _ dehn filling of @xmath20 along @xmath23 _ , and depends up to homeomorphism only on the homotopy class of @xmath23 in @xmath21 .",
    "thurston s hyperbolic dehn surgery theorem @xcite says that if the interior of @xmath20 admits a hyperbolic metric , then so does the interior of @xmath29 , for all but finitely many choices of @xmath23 .",
    "the number of curves to be excluded and the relationship between the geometry of @xmath20 and that of @xmath29 can be made quite precise ( see for example @xcite ) .    on the level of fundamental groups , @xmath30 , where @xmath16 is an element of @xmath31 whose conjugacy class is represented by @xmath23 .",
    "one of the group theoretic statements implied the hyperbolic dehn surgery theorem is    [ hdst ] @xcite let @xmath32 where @xmath20 is a hyperbolic @xmath19-manifold with a single torus cusp @xmath33 , and let @xmath34 be the cusp subgroup .",
    "then for all but finitely many @xmath35 , @xmath36 is infinite , non - elementary , and word hyperbolic .",
    "this group theoretic statement finds its strongest quantitative formulation in the `` @xmath37 theorem '' independently due to lackenby and agol @xcite .",
    "theorem [ hdst ] puts the conclusion of the hyperbolic dehn surgery theorem in an algebraic context .",
    "koji fujiwara asked whether there was an algebraic analogue of this theorem which also puts the hypotheses into an algebraic context .",
    "we learned of this question from danny calegari .",
    "as an answer to this question , we provide the following result ( where @xmath38 denotes the minimal length of a nontrivial element of @xmath39 using the word metric on @xmath40 with respect to the generating set @xmath41 ; see definition [ d : slopelength ] ) :    * theorem [ t : rhds ] *    _ let @xmath0 be a torsion - free group , which is hyperbolic relative to a collection @xmath42 of finitely generated subgroups .",
    "suppose that @xmath43 is a generating set for @xmath0 so that for each @xmath44 we have @xmath45 .",
    "_    there exists a constant @xmath46 depending only on @xmath47 so that for any collection @xmath48 of subgroups satisfying    * @xmath49 ; and * @xmath50 ,    then the following hold , where @xmath51 is the normal closure in @xmath0 of @xmath52 .    1 .",
    "the map @xmath53 given by @xmath54 is injective for each @xmath55 .",
    "@xmath56 is hyperbolic relative to the collection @xmath57 .",
    "it is well known ( see , for example , ( * ? ? ?",
    "* theorem 3.8 ) ) that a group which is hyperbolic relative to a collection of word hyperbolic subgroups is word hyperbolic .",
    "thus , an immediate corollary of theorem [ t : rhds ] is the following :    [ c : hypcase ] under the hypotheses of theorem [ t : rhds ] , if each of the @xmath58 are themselves word hyperbolic , then @xmath56 is word hyperbolic .",
    "together with theorem [ t : nonelementary ] ( non - elementariness ) , corollary [ c : hypcase ] unifies a number of known results :    1 .",
    "we have already remarked that theorem [ t : rhds ] generalizes theorem [ hdst ] . however , since we make no assumptions about the subgroups @xmath40 , theorem [ t : rhds ] also generalizes the results of lackenby from @xcite about filling @xmath19-manifolds some of whose boundary components are higher genus surfaces ( although we do not obtain such nice quantitative bounds as lackenby ) .",
    "2 .   corollary [ c : hypcase ] also generalizes some known results about hyperbolic groups .",
    "for example , modulo the extra torsion - free hypothesis , theorem [ t : rhds ] is a generalization of statements ( 1)(3 ) of ( * ? ? ? * theorem 5.5.d , p.149 ) .",
    "of interest in this context is that we make no use whatsoever of small cancellation techniques .",
    "much of the group - theoretic content of many `` cat@xmath59 '' or `` cat@xmath60 with isolated flats '' filling constructions on hyperbolic manifolds with torus cusps is also contained in theorem [ t : rhds ] . examples of this are in @xcite .",
    "( see also remark [ r : catminusone ] . )",
    "we now make a few more remarks about theorem [ t : rhds ] .",
    "the `` short '' fillings really must be excluded in theorem [ t : rhds ] , as can be seen , for instance , from the many examples of exceptional fillings of hyperbolic @xmath19-manifolds . by considering fillings of the hopf link , we can see that it is also important that _ each _ of the lengths @xmath38 is large .",
    "an even simpler example is given by @xmath0 equal to the free group @xmath61 , and @xmath62 .",
    "choosing @xmath63 , @xmath64 , and @xmath65 , the quotient @xmath56 will be infinite and word hyperbolic if and only if @xmath66 .",
    "this occurs if all three of @xmath67 , @xmath18 , and @xmath68 are at least @xmath69 , but of course if @xmath70 , then @xmath68 can be arbitrarily large while @xmath56 remains finite .",
    "since we are , from the very beginning , working in the coarse world of @xmath5-hyperbolic spaces , we have no hope of obtaining the fine control over constants , as obtained in @xcite .",
    "therefore , we have made very little attempt throughout this paper to make our constants optimal .",
    "however , it is worth remarking that there are some delicate interdependencies between some of the constants we use .",
    "[ r : osin ] denis osin has independently proved theorem [ t : rhds ] ; see @xcite .",
    "in fact , osin works in a somewhat more general setting , in two respects .",
    "first , osin has a more general notion of relative hyperbolicity , which allows infinitely many ( possibly infinitely generated ) parabolics .",
    "it can be shown ( and this is really implicit in osin s proof ) that the appropriate statement for infinitely many infinitely generated parabolics _ follows _ from the statement for finitely many finitely generated parabolics .",
    "second , and more seriously , osin makes no assumption of torsion - freeness in @xcite .",
    "we believe that our methods apply ( with appropriate modification ) to the non - torsion - free case , at least to prove the analog of theorem [ t : rhds ] , but at such a cost in clarity and brevity that we have elected to deal only with the torsion - free case . we have tried to make explicit our use of torsion - freeness and how one might go about avoiding it ( see remarks [ r : tf1 ] , [ r : tf2 ] , [ r : tf3 ] , [ r : tf4 ] , [ r : tf5 ] , [ tr : bonus],[r : tf6 ] and [ r : tf7 ] ; on first reading , we recommend ignoring all of these comments ; to facilitate this , they are all labelled as ` remark ( about torsion ) ' ) .",
    "certain of our results , which are not used in the proof of theorem [ t : rhds ] , must be considerably rephrased in the presence of torsion ( see especially theorem [ t : dontintersect ] ) .",
    "note also that osin s main theorem ( * ? ? ?",
    "* theorem 1.1 ) states that given a finite set @xmath71 , there is a @xmath46 so that under the conditions of theorem [ t : rhds ] the map @xmath72 is injective on @xmath73 .",
    "this is corollary [ c : injectonfinite ] below .",
    "[ r : catminusone ] it is worth noting that , even when starting with a rank one locally symmetric space , our group - theoretic version of filling produces hyperbolic groups in many situations where the existence a locally cat@xmath59 filling is not at all clear ; see the non - existence results of @xcite .",
    "the advantage of a cat@xmath59 filling is that information about the fundamental group can be obtained from local information about the locally cat@xmath59 model . for more on this ,",
    "see @xcite , which is in preparation .",
    "all metric spaces will be assumed to be complete geodesic metric spaces , and the distance between two points @xmath74 and @xmath75 will usually be denoted @xmath76 .",
    "if @xmath11 is a metric space , @xmath77 and @xmath78 , then let @xmath79 be the @xmath80-neighborhood of @xmath81 in @xmath11 .    if @xmath11 and @xmath82 are metric spaces , @xmath83 and @xmath84 , a _",
    "@xmath85-quasi - isometric embedding _ of @xmath11 into @xmath82 is a function @xmath86 so that for all @xmath87 , @xmath88 @xmath89    if in addition the map @xmath18 is _",
    "@xmath33-coarsely onto _  _ i.e. _ , @xmath90 ",
    "@xmath18 is called a _",
    "@xmath85-quasi - isometry_. the two metric spaces @xmath11 and @xmath82 are then said to be _ quasi - isometric _ to one another .",
    "this is a symmetric condition .",
    "a _ @xmath85-quasi - geodesic _ in @xmath11 is a @xmath85-quasi - isometric embedding @xmath91 .",
    "we will occasionally abuse notation by referring to the image of @xmath92 as a quasi - geodesic .",
    "a _ @xmath85-quasi - geodesic ray _ is a @xmath85-quasi - isometric embedding @xmath93 .",
    "given a geodesic triangle @xmath94 in any geodesic metric space , there is a unique _ comparison tripod _ , @xmath95 , a metric tree so that the distances between the three extremal points of the tree , @xmath96 , @xmath97 and @xmath98 , are the same as the distances between @xmath74 , @xmath75 and @xmath99 ( see figure [ fig : tripdef ] . ) .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 4530,1665)(436,-1930 ) ( 451,-736)(0,0)[lb ] ( 1351,-586)(0,0)[lb ] ( 2251,-1861)(0,0)[lb ] ( 3376,-736)(0,0)[lb ] ( 4051,-436)(0,0)[lb ] ( 4951,-1786)(0,0)[lb ] ( 2476,-1036)(0,0)[lb ] ( 901,-1486)(0,0)[lb ] ( 3901,-1486)(0,0)[lb ]    there is a unique map @xmath100 which takes @xmath74 to @xmath96 , @xmath75 to @xmath97 and @xmath99 to @xmath98 , and which restricts to an isometric embedding on each side of @xmath94 .",
    "let @xmath101 .",
    "the triangle @xmath94 is _ @xmath5-thin _ if the diameter of @xmath102 is at most @xmath5 for every point @xmath103 .",
    "any triangle which is @xmath5-thin is also _",
    "_ : i.e. , any side of the triangle is contained in the @xmath5-neighborhood of the union of the other sides . more generally , a geodesic @xmath2-gon is @xmath104-slim .",
    "it is also true that for every @xmath5 there is a @xmath105 so that @xmath5-slim triangles are @xmath105-thin ( see ( * ? ? ? * proposition iii.h.1.17 , p. 408 ) ) .",
    "[ d : hyperbolic ] a geodesic metric space @xmath11 is _",
    "@xmath5-hyperbolic _ if every geodesic triangle in @xmath11 is @xmath5-thin .",
    "if @xmath5 is unimportant we may simply say that @xmath11 is _",
    "gromov hyperbolic_.    see ( * ? ?",
    "* chapter iii.h ) for the background and many basic results about gromov hyperbolic spaces .",
    "let @xmath74 , @xmath75 , @xmath106 .",
    "the _ gromov product _ of @xmath74 and @xmath75 with respect to @xmath99 is @xmath107 .",
    "equivalently , @xmath108 is the distance from @xmath98 to the central vertex of the comparison tripod @xmath95 for any geodesic triangle @xmath94 .",
    "fix some @xmath106 , where @xmath11 is some gromov hyperbolic metric space .",
    "we say that a sequence @xmath109 _ tends to infinity _ if @xmath110 .",
    "on the set of such sequences we may define an equivalence relation : @xmath111 if @xmath112 .",
    "the _ gromov boundary _ of @xmath11 , also written @xmath113 , is the set of equivalence classes of sequences tending to infinity .",
    "the gromov boundary does not depend on the choice of @xmath99 ( see ( * ? ? ?",
    "* proposition iii.h.3.7 ) ) .",
    "we may topologize @xmath114 so that if @xmath109 tends to infinity , then @xmath115 $ ] . furthermore",
    ", if @xmath116 is a quasi - geodesic ray , then for any sequence @xmath117 with @xmath118 , the sequence @xmath119 tends to infinity .",
    "the point @xmath120 does not depend on the choice of @xmath117 .",
    "an isometric action on @xmath11 extends to a topological action on the boundary .",
    "[ r : deltaprops ] we will implicitly assume , whenever we say that a space is @xmath5-hyperbolic , that triangles are @xmath5-thin and @xmath5-slim",
    ".    this can be achieved by replacing @xmath5 by some larger constant .",
    "we will also assume that @xmath5 is an integer .",
    "one can also consider geodesic `` triangles '' in a gromov hyperbolic space @xmath11 whose vertices are _ ideal _ , i.e. , points in @xmath113 .",
    "the following is a simple exercise in @xmath5-slim triangles .",
    "[ l : idealthin ] a geodesic triangle in a @xmath5-hyperbolic space with some or all vertices ideal is @xmath121-slim .",
    "although there is little difference between various definitions of the cayley graph , it is convenient to fix one here . by `` @xmath0 is generated by @xmath43 '' , we mean that there is a surjection @xmath122 where @xmath123 is the free group on the set @xmath43 .",
    "if @xmath124 , then we implicitly assume @xmath125 is the homomorphism induced by inclusion .",
    "the _ cayley graph of @xmath0 with respect to @xmath43 _ , written @xmath126 , is the graph with vertex set @xmath0 , and edge set @xmath127 .",
    "the edge @xmath128 connects the vertices @xmath129 and @xmath130 .",
    "we recall the following definitions of osin .",
    "( we change the notation slightly . )",
    "[ d : relgen ] ( * ? ? ?",
    "* definition 2.1 ) let @xmath0 be a group , @xmath131 a collection of subgroups of @xmath0 , and @xmath81 a subset of @xmath0 .",
    "we say that @xmath81 is _ a relative generating set for @xmath0 with respect to @xmath131 _ if @xmath0 is generated by @xmath132    we will be concerned with situations where the index set @xmath133 is finite .",
    "[ d : relpres ] [ osin ] suppose that @xmath0 is generated by @xmath134 with respect to @xmath131 .",
    "then @xmath0 is a quotient of @xmath135 where @xmath136 is the free group on the alphabet @xmath134 .",
    "suppose that @xmath137 is the kernel of the canonical quotient map from @xmath138 to @xmath0 .",
    "if @xmath137 is the normal closure of the set @xmath139 then we say that @xmath140 is a _ relative presentation _ for @xmath0 with respect to @xmath131 .",
    "we say that @xmath0 is _ finitely presented relative to @xmath131 _ if we can choose @xmath139 to be finite .",
    "the following lemma is essentially contained in theorem 2.44 of @xcite .",
    "[ l : hfg ] if @xmath0 is a finitely generated group , finitely presented relative to a collection of nontrivial subgroups @xmath141 , then @xmath133 is finite and each @xmath142 is finitely generated .    by theorem 2.44 of @xcite",
    ", there is a finite subset @xmath143 so that @xmath144 where @xmath145 is generated by @xmath146 and the finite relative generating set for @xmath0 .    by grushko s theorem , and the fact that @xmath0 is finitely generated , @xmath147 is also finite .",
    "moreover , each @xmath142 for @xmath148 is finitely generated , as is @xmath145 .",
    "osin s theorem further asserts that @xmath145 has the structure of a tree of groups , where each edge group is finitely generated .",
    "the collection of vertex groups is @xmath149 where @xmath150 is some finitely generated group .",
    "since @xmath145 is finitely generated , an elementary application of bass - serre theory shows that each @xmath142 is finitely generated .",
    "[ d : compatible ] suppose that @xmath0 is finitely generated , and also finitely presented relative to @xmath151 .",
    "by lemma [ l : hfg ] , each of the @xmath152 is finitely generated .",
    "in this situation , we usually fix a finite generating set @xmath43 for @xmath0 so that for each @xmath153 we have @xmath154 .",
    "we call such a set @xmath43 a _ compatible _ generating set for @xmath0 .",
    "[ d : relcayleycomplex ] [ relative cayley complex ] suppose that @xmath0 is finitely presented relative to the finitely generated subgroups @xmath155 , and that @xmath43 is a finite compatible generating set for @xmath0 .",
    "let @xmath156 be a finite relative presentation for @xmath0 , where @xmath157 is a set of relative generators for @xmath0 .",
    "let @xmath158 be the cayley graph of @xmath0 with respect to @xmath43 .",
    "the elements of @xmath139 correspond to loops in @xmath159 .",
    "we glue a @xmath160-cell to each such loop , in a manner equivariant under the @xmath0-action on @xmath159 .",
    "the resulting @xmath160-complex is called the _ relative cayley complex _ of @xmath0 with respect to @xmath161 , and is denoted @xmath162 .    in general",
    ", the relative cayley complex of @xmath0 will not be simply - connected .",
    "this will only be the case if @xmath163 is already a presentation for @xmath0 .    in subsection [ ss : relhyp ]",
    "below , we define a simply - connected @xmath160-complex @xmath10 associated to a finite relative presentation of relatively hyperbolic group , starting with the relative cayley complex .    also , in section [ section : cusped ] , we construct another another simply - connected @xmath160-complex @xmath11 , again starting with a finite relative presentation of a relatively hyperbolic group .    the spaces @xmath11 and @xmath10 both contain copies of the relative cayley complex .",
    "let @xmath82 be a cell complex , and let @xmath164 be a real cellular @xmath2-chain .",
    "the _ @xmath7-norm _ of @xmath165 is @xmath166    suppose that @xmath82 is a @xmath160-complex and that @xmath167 is a combinatorial path , in the sense that there is a cell structure on @xmath168 so that @xmath67 sends each edge either to an edge or a vertex of @xmath82 .",
    "the _ length _ , or _",
    "@xmath7-norm _ of @xmath67 is then the number of @xmath7-cells in @xmath168 which are mapped onto edges of @xmath82 .",
    "we denote the @xmath7-norm of @xmath67 by @xmath169 .",
    "the map @xmath67 induces an obvious cellular @xmath7-chain @xmath170 on @xmath82 ( using the orientation on @xmath168 ) .",
    "suppose that @xmath82 is a @xmath160-complex and @xmath171 an oriented , cellulated surface .",
    "a _ combinatorial map _ is a map @xmath172 which sends each vertex of @xmath171 to a vertex of @xmath82 , each edge of @xmath171 to an edge or a vertex of @xmath82 and each @xmath160-cell to a @xmath160-cell , an edge , or a vertex of @xmath82 .",
    "furthermore , if @xmath173 is a cell in @xmath171 which is sent to a cell of the same dimension then the interior of @xmath173 is mapped homeomorphically by @xmath174 onto its image .",
    "the _ area _ of a combinatorial map @xmath172 is the number of @xmath160-cells in @xmath171 which are mapped onto @xmath160-cells .",
    "when we refer to the ` @xmath7-norm ' of a map between @xmath160-complexes , we mean the area .    as in the @xmath7-dimensional setting , a combinatorial map @xmath172 induces an integral , cellular @xmath160-chain @xmath175 on @xmath82 .",
    "if @xmath174 is a combinatorial map of an interval or a surface into a @xmath160-complex @xmath82 then @xmath176 .    throughout this paper",
    "we are somewhat cavalier about the difference between paths as maps , paths as subsets , and @xmath7-chains .",
    "this should not cause any confusion .",
    "any gromov hyperbolic space satisfies a linear coarse isoperimetric inequality ( see ( * ? ? ?",
    "* proposition iii.h.2.7 ) ) .",
    "however , when we work with homological isoperimetric inequalities below , we need to use simply connected spaces .",
    "thus we pause in this paragraph to consider combinatorial isoperimetric inequalities .",
    "there is little novel here , but it is worth noting that our spaces are not always locally finite , are not uniformly locally finite even when they are locally finite , and there will rarely be a proper and cocompact action on the gromov hyperbolic spaces in this paper .",
    "thus we need to be slightly careful about the hypotheses in the results below .",
    "[ p : hyptocomb ] let @xmath11 be a simply - connected @xmath160-complex and suppose that @xmath12 is @xmath5-hyperbolic .",
    "suppose further that for some @xmath177 , any combinatorial loop of length at most @xmath178 can be filled with a combinatorial disk of area at most @xmath51 .",
    "then any combinatorial loop @xmath179 in @xmath11 can be filled with a combinatorial disk whose area is at most @xmath180 .",
    "this is essentially dehn s algorithm .",
    "see the proof of ( * ? ? ?",
    "* proposition iii.h.2.7 ) .",
    "[ p : combtohyp ] suppose that @xmath11 is a simply connected @xmath160-complex and that there is a constant @xmath181 so that the length of the attaching map of any @xmath160-cell is at most @xmath20 .",
    "if @xmath11 satisfies a linear combinatorial isoperimetric inequality then @xmath12 is @xmath5-hyperbolic for some @xmath5 .",
    "furthermore , @xmath5 can be calculated in terms of @xmath20 and the isoperimetric constant of @xmath11 .",
    "follows from the proof of ( * ? ? ?",
    "* theorem iii.h.2.9 ) , or from a combinatorial version of the proof of theorem [ t : homtohyp ] below .      in @xcite",
    ", gersten proves that a group is hyperbolic if and only if it has a linear _ homological _ filling function . in this section",
    "we recall those notions and extend them slightly in order to account for the fact that the actions on gromov hyperbolic spaces in this paper are rarely proper _ and _ cocompact ( though they are usually one or the other ) . in this section",
    "we prefer to work with rational coefficients . however , real or complex coefficients would also work .",
    "we recall some standard definitions :    let @xmath82 be a cell complex , @xmath81 a normed abelian group ( with norm @xmath182 ) , and let @xmath183 be the set of @xmath2-cells of @xmath82 . a _",
    "locally finite @xmath2-chain in @xmath82 with coefficients in @xmath81 _",
    "@xmath165 is a formal sum @xmath184 where each @xmath185 . the chain @xmath165 is said to be _",
    "if @xmath186 the quantity @xmath187 is the _ norm of @xmath165_. the _ support _ of @xmath165 is the union in @xmath82 of the @xmath2-cells @xmath179 for which @xmath188 is nonzero .",
    "the chains of compact support form the standard cellular chain group @xmath189 .",
    "we first recall a result from @xcite about expressing @xmath7-chains as sums of paths .",
    "note that this result is a generalization of ( * ? ? ?",
    "* theorem 3.3 ) .",
    "suppose that @xmath159 is a graph and @xmath21 is a collection of vertices .",
    "@xmath21-path _ is a directed path in @xmath159 whose initial and terminal vertices are in @xmath21 ( or are equal ) .",
    "a path is _ simple _ if it has no repeated vertices .",
    "let @xmath174 be a summable @xmath7-chain in a graph @xmath159 .",
    "let @xmath190 denote the directed graph which is @xmath159 with an orientation chosen so that @xmath191 for each edge @xmath192 .",
    "let @xmath193 be the minimal subgraph of @xmath190 containing all the edges @xmath192 with @xmath194 .",
    "[ t : coherent ] [ mineyev , theorem 6 , @xcite ] let @xmath159 be a graph , @xmath21 a set of vertices in @xmath159 and @xmath174 a summable @xmath7-chain on @xmath159 with coefficients in @xmath195 and @xmath196 .    1 .",
    "there is a countable family @xmath197 of simple @xmath21-paths in @xmath193 and a sequence @xmath198 in @xmath199 so that ( i ) @xmath200 ; and ( ii ) @xmath201 .",
    "if @xmath174 has finite support then @xmath202 can be chosen to be finite .",
    "suppose that @xmath203 expresses the @xmath7-chain @xmath174 as a sum of @xmath7-chains @xmath204 , where @xmath205 .",
    "this sum is called _ coherent _ if @xmath201 .",
    "[ d : hlii ] suppose that @xmath206 is a simply - connected @xmath160-complex .",
    "we say that @xmath206 satisfies a _ linear homological isoperimetric inequality _",
    "if there is a constant @xmath177 so that for any combinatorial loop @xmath179 in @xmath206 there is some @xmath207 with @xmath208 , satisfying @xmath209    see ( * ? ? ?",
    "* theorem 7 ) for ( many ) other notions of what it might mean for a space to have a ` linear isoperimetric inequality ' . in this paper , we exclusively use the notion from definition [ d : hlii ] above .    the next result follows immediately from the definitions .",
    "[ l : combtohom ] if a simply - connected @xmath160-complex @xmath206 satisfies a linear combinatorial isoperimetric inequality then it satisfies a linear homological isoperimetric inequality .    in @xcite",
    ", gersten proves that the cayley complex of a finitely presented group @xmath0 satisfies a linear homological isoperimetric inequality if and only if @xmath0 is hyperbolic .",
    "this is essentially a converse to lemma [ l : combtohom ] above . in this section",
    "we slightly generalize gersten s result .",
    "however , most of our work is in noting that the proof of gersten s result from @xcite works in our setting .",
    "[ t : homtohyp ] suppose that @xmath206 is a simply - connected @xmath160-complex and that there is a constant @xmath20 so that the attaching map for each @xmath160-cell in @xmath206 has length at most @xmath20 .",
    "suppose further that @xmath206 satisfies a linear homological isoperimetric inequality .",
    "then @xmath210 , the @xmath7-skeleton of @xmath206 , is @xmath5-hyperbolic for some @xmath5 .",
    "the proof consists of noting that a number of other proofs do not rely essentially on finite valence .",
    "the first step is to prove that if @xmath206 is not gromov hyperbolic then for any @xmath211 , there are @xmath212-thick geodesic bigons in @xmath206 .",
    "this is essentially ( * ? ? ?",
    "* theorem 1.4 ) , modified in the obvious way .",
    "namely , for each @xmath20 , define let @xmath213 where the infimum is taken over all positive integers @xmath80 and all @xmath92 , @xmath214 , geodesics such that @xmath215 and @xmath216 .",
    "this is not quite the function that papasoglu uses , but it suffices for the proof .",
    "the remainder of the proof of this first step is identical to that in @xcite .",
    "now follow the proof of ( * ? ? ?",
    "* proposition 8) to prove that if there are @xmath212-thick bigons in @xmath206 for all @xmath211 then @xmath206 does not have a linear homological isoperimetric inequality .",
    "mineyev s argument only relies on a bound on the length of attaching maps for @xmath160-cells ( and not , for instance , on vertex transitivity or local finiteness ) .",
    "it is certainly worth remarking that mineyev relies on a result of gersten from @xcite , which similarly only needs a bound on the attaching maps of @xmath160-cells .",
    "there are various notions of `` bicombing '' for graphs .",
    "in particular , one can define combings made up of paths or of @xmath7-chains .",
    "[ d : geodesicbicombing ] let @xmath159 be a graph , and let @xmath217 be the set of ( oriented ) geodesics in @xmath159 .",
    "that is , each element of @xmath217 is a path @xmath218 , where @xmath219 and @xmath173 is parametrized by arc length .",
    "geodesic bicombing on @xmath159 _ is a function @xmath220 so that @xmath221 is a geodesic which begins at @xmath74 and ends at @xmath75 .",
    "[ d : geodesicextension ] let @xmath159 and @xmath217 be as in definition [ d : geodesicbicombing ] .",
    "let @xmath222 be some compactification ( or bordification ) of @xmath223 , and let @xmath224 .",
    "geodesic bicombing on @xmath133 _ is a function @xmath225 where @xmath226 and    1 .",
    "if @xmath227 , then @xmath221 starts at @xmath74 ; otherwise , @xmath228 .",
    "if @xmath229 , then @xmath221 ends at @xmath75 ; otherwise @xmath230 .",
    "[ d : homologicalbicombing ] @xcite suppose that @xmath159 is a graph , and @xmath231 is a ring .",
    "let @xmath232 be the group of finite formal sums of @xmath7-cells in @xmath159 with coefficients in @xmath231 .",
    "homological bicombing on @xmath159 _ is a function @xmath233 so that @xmath234 .",
    "[ r : geodtohom ] it is clear that a geodesic bicombing as in definition [ d : geodesicbicombing ] gives rise to a homological bicombing as in definition [ d : homologicalbicombing ] .",
    "it is slightly less obvious ( but also true ) that we can use a bicombing as in definition [ d : geodesicextension ] to produce something homological .",
    "[ d : homologicalextension ] let @xmath159 be a graph and @xmath231 a ring , and let @xmath235 be the group of ( locally finite ) formal sums of @xmath7-cells in @xmath159 .",
    "let @xmath222 be some compactification ( or bordification ) of @xmath223 , and let @xmath224 .",
    "let @xmath18 be a function @xmath236 which is zero precisely on @xmath226 .",
    "given @xmath237 , @xmath238 , and @xmath239 , let @xmath240 be the @xmath7-chain which is equal to @xmath241 on the ball of radius @xmath80 about @xmath99 , and zero outside it .",
    "the function @xmath18 is a _ homological bicombing on @xmath133 _ if it satisfies the following condition : for every @xmath238 , and @xmath239 , there is an @xmath242 so that for every integer @xmath243 , there exist @xmath244-chains @xmath245 and @xmath246 , each with coefficients summing to @xmath7 so that :    1 .",
    "@xmath247 for all @xmath243 , 2 .",
    "any sequence @xmath248 with @xmath249 satisfies @xmath250 , and any sequence @xmath248 with @xmath251 satisfies @xmath252 .",
    "[ d : quasigeodesic ] let @xmath159 be a graph with a compactification @xmath253 of @xmath223 , and let @xmath254 .",
    "let @xmath255 .",
    "a homological bicombing @xmath256 is _ @xmath212-quasi - geodesic _ if both    1 .",
    "@xmath257 has support in the @xmath212-neighborhood of some geodesic between @xmath16 and @xmath17 , and 2 .",
    "if @xmath16 , @xmath258 , then @xmath259 .",
    "[ r : wrongdef ] in general , one may also want to place constraints on the @xmath7-norms of finite  subsegments \" of @xmath257 , where @xmath16 and @xmath17 are ideal points .",
    "however , we do not need this refinement in this paper .",
    "relatively hyperbolic groups were first defined by gromov in @xcite .",
    "alternative definitions were given by farb @xcite and bowditch @xcite .",
    "these definitions are all now known to be equivalent .",
    "see ( * ? ? ? *",
    "appendix ) .",
    "further characterizations of relatively hyperbolic groups are given by osin @xcite , in terms of relative dehn functions , and yaman @xcite , in terms of convergence group actions .",
    "recently there has been a large amount of interest in relatively hyperbolic groups .",
    "( see @xcite , @xcite , @xcite , @xcite , @xcite , among many others ) .",
    "here is the original definition of gromov s ( * ? ?",
    "* section 8.6 ) :    [ d : gromovrh ] suppose that @xmath0 acts isometrically and properly on a proper , geodesic , gromov hyperbolic metric space @xmath11 , so that the quotient is quasi - isometric to a wedge of @xmath2 rays .",
    "let @xmath260 be unit - speed geodesic rays in @xmath261 tending to distinct points in the gromov boundary of @xmath261 , and choose lifts @xmath262 to @xmath11 . for each @xmath55 ,",
    "let @xmath263 be the point in @xmath113 to which @xmath264 limits , and let @xmath40 be the stabilizer in @xmath0 of @xmath263 .",
    "for each @xmath55 define a _",
    "_ @xmath265 by @xmath266 the _ @xmath80-horoballs _ of @xmath11 are the sub - level sets @xmath267 and their @xmath0-translates .",
    "assume that there exists a constant @xmath80 so that for any @xmath268 and any @xmath269 , either @xmath270 is empty or @xmath271 and @xmath272 .",
    "finally , suppose that @xmath0 acts cocompactly on the complement of the union of the horoballs .",
    "then we say that @xmath0 is _ hyperbolic relative to @xmath273 in the sense of gromov_.    [ d : non - elem ] suppose that @xmath0 is a relatively hyperbolic group acting on the @xmath5-hyperbolic space @xmath11 as in definition [ d : gromovrh ] .",
    "an element @xmath274 is called _ hyperbolic _ if it does not have a bounded orbit in @xmath11 , and it fixes exactly two points in @xmath113 .",
    "we say that @xmath0 is _ non - elementary relatively hyperbolic _ if there are hyperbolic elements @xmath275 in @xmath0 so that @xmath276 .    by the usual ping - pong argument , if @xmath275 are as in definition [ d : non - elem ] above ,",
    "then there is some @xmath277 so that @xmath278 and @xmath279 generate a free group .",
    "we now give another definition of relatively hyperbolic groups , which is a hybrid of farb s @xcite and one of bowditch s @xcite .    [",
    "d : conedgraph ] suppose that @xmath0 is a finitely generated group , with finite generating set @xmath43 .",
    "let @xmath126 be the cayley graph of @xmath0 with respect to @xmath43 .",
    "suppose that @xmath280 is a finite collection of finitely generated subgroups of @xmath0 .",
    "we form a new graph containing @xmath126 , called the _ coned - off cayley graph _ and denoted @xmath281 as follows :    for each @xmath282 and each coset @xmath283 we add a new vertex , @xmath284 to @xmath126 .",
    "we also add a vertex from each element of @xmath285 to @xmath284 .",
    "[ fine graphs ; see @xcite ] a ( not necessarily locally finite ) graph @xmath286 is _ fine _ if for every edge @xmath192 in @xmath286 and each integer @xmath287 , the number of simple simplicial loops of length at most @xmath288 which contain @xmath192 is finite .",
    "[ d : rh ] suppose that @xmath0 is a finitely generated group and that @xmath289 is a collection of finitely generated subgroups .",
    "we say that @xmath0 is _ hyperbolic relative to @xmath290 _ if the coned - off cayley graph @xmath281 is fine and @xmath5-hyperbolic for some @xmath291 .",
    "[ r : bcp ] by now the class of groups which we call ` relatively hyperbolic ' is standard .",
    "however , we should point out that , in the terminology of @xcite , @xmath0 is hyperbolic relative to @xmath4 if and only if the coned - off cayley graph is @xmath5-hyperbolic .",
    "farb s hypothesis of bounded coset penetration is equivalent to fineness of @xmath292 ( see for instance ( * ? ? ?",
    "* appendix ) ) .",
    "it is shown in @xcite and ( * ? ? ? * appendix ) that definitions [ d : gromovrh ] and [ d : rh ] are equivalent .",
    "whenever @xmath0 is hyperbolic relative to @xmath4 , we will always assume that our ( finite ) generating set for @xmath0 is compatible , in the sense of definition [ d : compatible ] .",
    "we briefly list some examples of relatively hyperbolic groups ( and the subgroups they are hyperbolic relative to ) :    1 .",
    "hyperbolic groups are hyperbolic relative to the empty collection of subgroups ; 2 .",
    "fundamental groups of geometrically finite hyperbolic manifolds are hyperbolic relative to the cusp subgroups ; 3 .",
    "free products are hyperbolic relative to the free factors ; 4 .",
    "a group which acts properly and cocompactly on a cat@xmath60 space with isolated flats is hyperbolic relative to the stabilizers of maximal flats ( see @xcite ; and @xcite ) ; 5 .",
    "limit groups are hyperbolic relative to maximal noncyclic abelian subgroups ( see @xcite and @xcite ) .    in section [ section : cusped ]",
    "below , we will introduce a ` cusped ' space , @xmath293 , associated to a group @xmath0 and finite collection @xmath290 of finitely generated subgroups .",
    "we will prove that @xmath0 is hyperbolic relative to @xmath290 if and only if @xmath293 is @xmath5-hyperbolic for some @xmath5 .",
    "one of the important features of the space @xmath11 defined in section [ section : cusped ] below is that if @xmath0 is hyperbolic relative to @xmath4 , then the action of @xmath0 on @xmath293 satisfies the requirements of definition [ d : gromovrh ] ( see theorem [ t : tfae ] below ) .",
    "there are a number of previous constructions of cusped spaces ( for example : cannon and cooper @xcite , bowditch @xcite and rebbechi @xcite .",
    "the novelty in our space @xmath11 is that it is a graph metrized so that edge lengths are @xmath7 .",
    "thus we can apply many combinatorial constructions directly , such as isoperimetric inequalities ( combinatorial and homological ) .",
    "importantly , in section [ section : bicombing ] below , we can also apply a construction of mineyev from @xcite .",
    "another important feature of the space @xmath11 is that there is a bound on the lengths of the attaching maps of @xmath160-cells .",
    "by osin ( * ? ? ?",
    "* theorem 1.5 ) , relatively hyperbolic groups are always finitely presented relative to their parabolics .",
    "( this also follows from the construction of the _ relative rips complex _ in @xcite . )",
    "[ t : rhrelfinpres ] ( * ? ? ?",
    "* theorem 1.5 ) let @xmath0 be a finitely generated group , @xmath294 a collection of subgroups of @xmath0 .",
    "the following are equivalent :    1 .",
    "@xmath0 is finitely presented with respect to @xmath151 and the corresponding relative dehn function is linear ; 2 .",
    "@xmath0 is hyperbolic relative to @xmath151 .",
    "recall by lemma [ l : hfg ] that if @xmath0 is finitely generated , and finitely presented relative to @xmath151 , then each of the @xmath152 is finitely generated .    in this paper , we have no need for the ` relative ' dehn functions of @xcite .",
    "rather , we construct simply - connected @xmath160-complexes with linear combinatorial isoperimetric inequalities .",
    "( they also have linear homological isoperimetric inequalities ; see theorem [ t : tfae ] below . )",
    "[ coned - off cayley complex ] [ d : conedcomplex ] suppose that @xmath0 is a finitely generated group , with a collection @xmath290 of finitely generated subgroups , and that @xmath295 is a finite relative presentation for @xmath0 .",
    "let @xmath43 be a ( finite ) compatible generating set for @xmath0 containing @xmath134 .",
    "form a @xmath160-complex @xmath296 , called the _ coned - off cayley complex _ as follows :    let @xmath297 be the coned - off cayley graph ( which contains a copy of the cayley graph @xmath126 . attach @xmath160-cells to @xmath33 in a @xmath0-equivariant way , corresponding to the relations @xmath139 . also , add a @xmath160-cell to each loop of length three in @xmath33 which contains an infinite valence vertex .",
    "the coned - off cayley complex is simply - connected .",
    "[ p : conelii ] suppose that @xmath0 is hyperbolic relative to @xmath290 , and let @xmath43 be a finite generating set for @xmath0 containing generating sets for each subgroup in @xmath290 .",
    "also , let @xmath298 be a finite relative presentation for @xmath0 .",
    "form the coned - off cayley complex @xmath296 .",
    "then @xmath296 has a linear combinatorial isoperimetric inequality .",
    "since @xmath0 is hyperbolic relative to @xmath290 , the coned - off cayley graph is @xmath5-hyperbolic and fine .",
    "therefore there are only finitely many orbits of simple loops of length at most @xmath178 .",
    "since @xmath296 is simply - connected , this implies that there exists a @xmath51 so that every combinatorial loop of length at most @xmath178 can be filled with a combinatorial disk in @xmath296 of area at most @xmath51 .",
    "the result now follows immediately from proposition [ p : hyptocomb ] .",
    "we now prove the converse to proposition [ p : conelii ] .",
    "[ p : coneliitorh ] suppose that @xmath0 is finite presented relative to @xmath299 and that @xmath298 is a finite relative presentation for @xmath0 .",
    "if the coned - off cayley complex @xmath300 satisfies a linear combinatorial isoperimetric inequality then the coned - off cayley graph @xmath301 is gromov hyperbolic and fine .    that @xmath9 is @xmath5-hyperbolic for some @xmath5 follows from proposition [ p : combtohyp ] ,",
    "since there is certainly a bound on the length of the attaching maps of @xmath160-cells in @xmath10 .",
    "it remains to prove that @xmath9 is fine .",
    "take an edge @xmath192 and a simple simplicial loop @xmath179 containing @xmath192 of length @xmath288 .",
    "now , there are only finitely many @xmath160-cells adjacent to each edge in @xmath10",
    ". a simple loop may be filled by a topological disk , and the isoperimetric function gives a bound on the area of such a disk in terms of the length . in particular , suppose a simple loop of length at most @xmath288 can be filled by a topological disk of area at most @xmath302 .",
    "there are only finitely many topological disks of area at most @xmath302 containing @xmath192 on the boundary , so there are only finitely many simple loops of length at most @xmath288 containing @xmath192 .",
    "therefore @xmath9 is fine .",
    "it is a consequence of theorem [ t : tfae ] that the hypothesis in proposition [ p : coneliitorh ] can be weakened to that of having a _ homological _ linear isoperimetric inequality , but we do not know a direct proof .",
    "this raises a natural question ( if the answer is positive , then it can be used to give such a direct proof ) :    let @xmath11 be a simply connected @xmath160-complex with a homological ( linear ? ) isoperimetric inequality and a bound on the length of attaching maps of @xmath160-cells and finitely many @xmath160-cells adjacent to any edge .",
    "must @xmath11 be fine ?",
    "the purpose of this section is to construct a space @xmath11 from a finitely generated group @xmath0 , and a finite collection @xmath4 of finitely generated subgroups .",
    "the utility of @xmath11 is that it is gromov hyperbolic if and only if @xmath0 is hyperbolic relative to @xmath4 ( see theorem [ t : tfae ] ) .",
    "let @xmath159 be any @xmath7-complex .",
    "the _ combinatorial horoball based on @xmath159 _ , denoted @xmath303 , is the @xmath160-complex formed as follows :    * @xmath304 * @xmath305 contains the following three types of edges .",
    "the first two types are called _ horizontal _ , and the last type is called _",
    "vertical_. 1 .",
    "if @xmath192 is an edge of @xmath159 joining @xmath306 to @xmath307 then there is a corresponding edge @xmath308 connecting @xmath309 to @xmath310 .",
    "2 .   if @xmath311 and @xmath312 , then there is a single edge connecting @xmath313 to @xmath314 .",
    "if @xmath315 and @xmath316 , there is an edge joining @xmath313 to @xmath317 .",
    "* @xmath318 contains three kinds of @xmath160-cells : 1 .",
    "if @xmath319 is a circuit composed of three horizontal edges , then there is a @xmath160-cell ( a _ horizontal triangle _ ) attached along @xmath92 .",
    "if @xmath319 is a circuit composed of two horizontal edges and two vertical edges , then there is a @xmath160-cell ( a _ vertical square _ ) attached along @xmath92 .",
    "if @xmath319 is a circuit composed of three horizontal edges and two vertical ones , then there is a @xmath160-cell ( a _ vertical pentagon _ ) attached along @xmath92 , unless @xmath92 is the boundary of the union of a vertical square and a horizontal triangle .",
    "[ r : subset ] as the full subgraph of @xmath303 containing the vertices @xmath320 is isomorphic to @xmath159 , we may think of @xmath159 as a subset of @xmath303 .",
    "whenever @xmath303 is to be thought of as a metric space , we will always implicitly ignore the @xmath160-cells , and regard @xmath321 as a metric graph with all edges of length one .",
    "[ d : depth1 ] let @xmath159 be a graph and @xmath303 the associated combinatorial horoball .",
    "function @xmath322 which satisfies :    1 .",
    "@xmath323 if @xmath324 , 2 .",
    "@xmath325 if @xmath74 is a vertex @xmath313 , and 3 .",
    "@xmath326 restricts to an affine function on each @xmath7-cell and on each @xmath160-cell .",
    "[ d : toppart ] let @xmath159 be a graph and @xmath327 the associated combinatorial horoball .",
    "for @xmath328 , let @xmath329 be the full sub - graph with vertex set @xmath330 .",
    "the following observation will be important in section [ surgered ] .",
    "[ o:2step ] let @xmath159 be a graph , @xmath331 as in definition [ d : toppart ] above , and @xmath332 be the full sub - graph with vertex set @xmath333 .",
    "let @xmath334 .",
    "identify the copies of @xmath332 in @xmath331 and @xmath335 .",
    "the resulting complex is isomorphic to @xmath336 .",
    "[ p : combhorolii ] let @xmath159 be a connected @xmath7-complex so that no edge joins a vertex to itself . then @xmath303 is simply - connected and satisfies a linear combinatorial isoperimetric inequality with constant at most @xmath19 .",
    "let @xmath179 be a combinatorial loop in @xmath303 . to prove the proposition it suffices to show that @xmath179 can be filled by a disk of area at most @xmath337 .",
    "let @xmath338 be minimal so that there is some vertex @xmath339 in @xmath179 .",
    "since we may clearly suppose @xmath179 has no backtracking , there is at least one horizontal edge at depth @xmath338 in @xmath179 . by gluing pentagons to edges in @xmath179 at depth @xmath338 , and squares when pentagons are not possible , we can reduce the length of @xmath179 , and increase the minimal depth . repeating this procedure",
    ", we eventually end with a path of length @xmath19 , or @xmath69 , which is entirely horizontal .",
    "a path of length @xmath19 can be filled be a horizontal triangle , whilst a path of length @xmath69 can be filled by two pentagons beneath it .",
    "being slightly careful about counting shows that the isoperimetric constant is at most @xmath19 , as required .",
    "[ t : combhorohyp ] let @xmath159 be any @xmath7-complex .",
    "then @xmath321 is @xmath5-hyperbolic , where @xmath5 is independent of @xmath159 .",
    "this follows from proposition [ p : combhorolii ] and proposition [ p : combtohyp ] .    by studying the geometry of geodesics in combinatorial horoballs as in the results below",
    ", it is possible to directly prove that any combinatorial horoball is @xmath340-hyperbolic ( and @xmath340 is not optimal ) .",
    "geodesics in combinatorial horoballs are particularly easy to understand .",
    "[ l : gamma ] let @xmath303 be a combinatorial horoball .",
    "suppose that @xmath341 are distinct vertices .",
    "then there is a geodesic @xmath342 between @xmath74 and @xmath75 which consists of at most two vertical segments and a single horizontal segment of length at most @xmath19 .",
    "moreover , any other geodesic between @xmath74 and @xmath75 is hausdorff distance at most @xmath69 from this geodesic .",
    "let @xmath214 be any geodesic joining @xmath74 to @xmath75 .",
    "we observe that if @xmath343 $ ] is a maximal horizontal segment of length greater than @xmath7 , then @xmath344 and @xmath345 are both smaller than @xmath346 ( see figure [ f : shortcut2 ] ) .",
    "( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 2744,1079)(2229,-1118 )    it is easy to see that no geodesic in @xmath81 can contain a horizontal segment of length longer than @xmath347 ( figure [ f : shortcut6 ] ) .",
    "( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 2744,2429)(2229,-2288 )    indeed , the geodesic @xmath214 can contain at most @xmath347 horizontal edges in total .",
    "we next observe that there can be at most two horizontal segments in @xmath214 other than the one at maximal depth , at most one on each side of the deepest one .",
    "in fact , there can be at most _ one _ horizontal segment other than the one at maximal depth .",
    "figure [ f : threehoriz ]    ( 0,0 )    # 1#2#3#4#5 @font    ( 3194,2294)(2229,-2153 )    shows representative paths with three horizontal segments together with ways to shorten them ( there are other possibilities , which are easy to deal with ) .",
    "let @xmath348 be the maximum depth achieved by @xmath214 .",
    "there is a geodesic @xmath349 obtained from @xmath214 by pushing all horizontal segments of @xmath214 down to @xmath350 .",
    "the hausdorff distance between @xmath214 and @xmath349 is at most @xmath351 .",
    "the geodesic @xmath349 consists of at most two vertical segments and one horizontal segment of length at most @xmath347 .",
    "if the horizontal segment @xmath352 has length @xmath69 ( respectively @xmath347 ) then there is another path with the same endpoints as @xmath353 , and the same length , consisting of two vertical edges and a horizontal path of length @xmath160 ( respectively @xmath19 ) . replacing @xmath353 with this new path if necessary",
    ", we obtain a geodesic of the form required by the lemma .",
    "now let @xmath92 be _ any _ geodesic satisfying the conclusion of the lemma .",
    "we argue that the hausdorff distance between @xmath92 and @xmath349 is at most @xmath354 which , combined with the earlier estimate on the hausdorff distance between @xmath214 and @xmath349 , completes the proof .",
    "let @xmath20 be the maximum depth of @xmath92 .",
    "the reader may readily verify that @xmath355 . if @xmath356 , then @xmath349 lies within hausdorff distance at most @xmath351 of @xmath92 . if @xmath357 , then the hausdorff distance between @xmath358 and @xmath349 is at most @xmath354 .",
    "if @xmath81 is a combinatorial horoball , then the gromov boundary consists of a single point , denoted @xmath359 .",
    "moreover , for any @xmath360 , there is a geodesic ray from @xmath74 to @xmath359 consisting entirely of vertical edges .",
    "any geodesic ray from @xmath74 to @xmath359 is hausdorff distance at most @xmath351 from the vertical ray .",
    "a geodesic ray has at most one horizontal edge .",
    "given this observation , the proof is similar to that of lemma [ l : gamma ] .",
    "let @xmath0 be a finitely generated group , with a finite collection @xmath4 of subgroups .",
    "let @xmath43 be a compatible generating set for @xmath0 .",
    "we define an augmentation of the relative cayley graph complex of @xmath0 by combinatorial horoballs",
    ". this augmentation will be hyperbolic exactly when @xmath0 is hyperbolic relative to @xmath4 ( see theorem [ t : tfae ] below ) .",
    "[ d : x1 ] let @xmath0 be a finitely generated group , let @xmath361 be a ( finite ) family of finitely generated subgroups of @xmath0 , and let @xmath43 be a generating set for @xmath0 so that @xmath362 generates @xmath40 for each @xmath363 . for each @xmath363 ,",
    "let @xmath364 be a left transversal for @xmath40 ( i.e. a collection of representatives for left cosets of @xmath40 in @xmath0 which contains exactly one element of each left coset ) .    for each @xmath55",
    ", and each @xmath365 , let @xmath366 be the full subgraph of the cayley graph @xmath126 which contains @xmath367 .",
    "each @xmath366 is isomorphic to the cayley graph of @xmath40 with respect to the generators @xmath362 .",
    "then we define @xmath368 where the graphs @xmath369 and @xmath370 are identified as suggested in remark [ r : subset ] .",
    "the vertex set of @xmath11 can naturally be identified with the set of @xmath69-tuples @xmath371 , where @xmath372 , @xmath365 , @xmath373 , and @xmath374 .",
    "we will use this identification without comment in the sequel .",
    "the group @xmath0 acts isometrically and properly on the graph @xmath375 .",
    "a path in @xmath11 starting at @xmath7 determines an element of @xmath0 in the following manner : each horizontal edge is naturally labelled by a group element .",
    "take the product of the labels of the horizontal edges in the path ( and ignore the vertical edges ) with the order coming from the path .",
    "paths in quotients @xmath376 , where @xmath377 , and also paths which start at a point @xmath378 which lies directly ` beneath ' @xmath7 also naturally determine elements of @xmath0 .",
    "supposing further that @xmath0 is finitely presented relative to @xmath4 , there is a natural locally finite simply connected @xmath160-complex with skeleton @xmath375 :    [ d : x2 ] let @xmath0 be a finitely generated group , let @xmath361 be a ( finite ) family of finitely generated subgroups of @xmath0 , and let @xmath43 be a generating set for @xmath0 so that @xmath362 generates @xmath40 for each @xmath363 .",
    "let @xmath379 , and suppose that @xmath380 is a finite _ relative _ presentation of @xmath0 , in the sense of definition [ d : relpres ] above ( where @xmath157 ) .",
    "then we may form a locally finite @xmath160-complex @xmath381 , whose one - skeleton is the space @xmath375 from definition [ d : x1 ] , and which contains the following @xmath160-cells :    * @xmath160-cells from @xmath139 : each relator in @xmath139 determines a loop @xmath92 in @xmath126 beginning at @xmath7 . for each @xmath268",
    ", there is a @xmath160-cell attached along @xmath382 .",
    "* @xmath160-cells from combinatorial horoballs : for each @xmath55 and each @xmath365 we have an embedding of @xmath383 into @xmath375 .",
    "if @xmath384 bounds a @xmath160-cell , then there is a @xmath160-cell attached along its image in @xmath381 .",
    "[ r : alt ] the @xmath160-complex @xmath11 can also be obtained from the relative cayley complex @xmath162 as in definition [ d : relcayleycomplex ] by attaching combinatorial horoballs to the cosets @xmath285 ( including the @xmath160-cells in the horoballs ) . in particular , and this will be important a number of times throughout this paper , the relative cayley complex is canonically embedded in @xmath11 .    as in definition [ d : depth1 ] , we define a depth function for the space @xmath381 :    define a _ depth _",
    "function @xmath385 which satisfies :    1 .",
    "@xmath323 if @xmath386 , 2 .",
    "@xmath387 if @xmath74 is a vertex @xmath388 , 3 .",
    "@xmath326 is equivariant , and 4 .",
    "@xmath326 restricts to an affine function on each @xmath7-cell and on each @xmath160-cell .",
    "because @xmath326 is @xmath0-equivariant , it induces a depth function on the quotient space @xmath376 , for any subgroup @xmath389 of @xmath0 .",
    "we refer to the depth function on the quotient by @xmath326 also .",
    "we observe that @xmath390 , the relative cayley complex of @xmath0 .    in section [ section : bicombing ]",
    "below , we need to choose @xmath139 carefully .",
    "we will need all sufficiently short loops in @xmath391 to be able to be filled in @xmath391 .",
    "this can be ensured by including all of the short relations in @xmath0 in @xmath139 .",
    "we remark that @xmath392 naturally breaks up into @xmath391 and an equivariant family of combinatorial horoballs .",
    "[ d : horoball ] let @xmath393 .",
    "@xmath288-horoball _ is a component of @xmath394 .",
    "@xmath244-horoball _ is the maximal subcomplex of @xmath381 with vertices @xmath395 for some @xmath372 and some @xmath365 .    the space @xmath11 is given the path metric , where each edge has length @xmath7 .",
    "we havent specified what kind of metric to put on the @xmath160-cells .",
    "thus , whenever we are discussing the metric of @xmath11 , we will simply pretend that @xmath11 is a @xmath7-complex .",
    "in particular , a _",
    "geodesic _ in @xmath11 will always refer to a geodesic path in the @xmath7-skeleton .",
    "the purpose of the @xmath160-cells is that we want a simply - connected space for which we will prove a linear isoperimetric inequality .",
    "this will imply that @xmath392 is a @xmath5-hyperbolic space for some @xmath5 , in case @xmath0 is hyperbolic relative to @xmath290 .",
    "see theorem [ t : tfae ] below .",
    "the main result of this subsection is theorem [ t : tfae ] , which gives a collection of statements which are equivalent to relative hyperbolicity . in particular , @xmath0 is hyperbolic relative to @xmath290 if and only if @xmath293 is gromov hyperbolic for any appropriate choice of @xmath43 as in definition [ d : x1 ] above .",
    "the next result will allow us to translate the hyperbolicity of the coned - off cayley complex into hyperbolicity of the space @xmath11 . in order to make the proof of theorem [ t : tfae ] easier , we choose to phrase it in terms of linear homological isoperimetric inequalities , though there is of course an analogous version with combinatorial isoperimetric inequalities ( and",
    "the proof of this analogue is somewhat easier ) .",
    "[ t : xlii ] suppose that @xmath0 is finitely presented relative to @xmath290 , that @xmath43 is a finite generating set for @xmath0 so that @xmath396 for each @xmath397 , and suppose that @xmath398 is a finite relative presentation for @xmath0 .",
    "if the coned - off cayley complex @xmath296 satisfies a linear homological isoperimetric inequality then @xmath399 satisfies a linear homological isoperimetric inequality .",
    "let @xmath158 be the cayley graph of @xmath0 with respect to @xmath43 .",
    "let @xmath400 be the coned - off cayley graph and @xmath401 the coned - off cayley complex .    by assumption",
    ", @xmath10 satisfies a linear homological isoperimetric inequality .",
    "let @xmath51 be the isoperimetric constant for @xmath10 .",
    "take a @xmath7-cycle @xmath179 in @xmath402 . by theorem [ t :",
    "coherent ] , we may assume without loss of generality that @xmath179 is a simple loop . if the support of @xmath179 lies entirely within a single horoball , then @xmath179 may be filled with a combinatorial disk of area at most @xmath337 , by proposition [ p : combhorolii ] .",
    "therefore , we may suppose that the support of @xmath179 does not lie entirely in a horoball .",
    "decompose @xmath179 into pieces which lie in @xmath159 , and pieces which lie entirely in a single horoball .    for each maximal sub - path of @xmath179 which lies in a horoball",
    ", there is a path of length @xmath160 in @xmath403 with the same endpoints .",
    "this gives a loop @xmath404 in @xmath403 .",
    "clearly @xmath405 .",
    "there is a rational @xmath160-chain @xmath165 in @xmath10 with boundary @xmath406 so that @xmath407    consider an infinite - valence vertex @xmath408 , and the @xmath160-cells in @xmath409 which intersect @xmath306 .",
    "each such @xmath160-cell is a triangle , and has a single edge in @xmath159 .",
    "thus to each infinite valence vertex @xmath306 in @xmath406 is associated ( via the @xmath160-chain @xmath165 ) a @xmath7-chain @xmath410 whose support is contained in the link of @xmath306 and whose @xmath7-norm is exactly the @xmath7-norm of @xmath165 restricted to the star of @xmath306 .",
    "the @xmath7-chains @xmath410 ( of which there are finitely many for the given path @xmath406 ) have total length bounded by @xmath187 , and give a method of ` surgering ' @xmath179 .",
    "we have the decomposition of @xmath179 into paths @xmath411 in the cayley graph and paths @xmath412 , where @xmath412 is a path through a horoball corresponding to the infinite valence vertex @xmath306 .",
    "this induces a decomposition of @xmath179 as @xmath413 where the paths are oriented so that @xmath414 is a @xmath7-cycle , and so is @xmath415 .",
    "now , @xmath416 ( the second inequality holds because @xmath417 , and because @xmath418 . )    the @xmath7-cycles @xmath419 lie entirely in a horoball , and can be filled efficiently , as described above ( this follows from theorem [ t : coherent ] and proposition [ p : combhorolii ] ) .    therefore , it suffices to fill the @xmath7-cycle @xmath420 efficiently .",
    "the @xmath7-cycle @xmath421 has support entirely in the cayley graph @xmath159 .",
    "therefore , @xmath421 can be interpreted as a @xmath7-cycle in @xmath9 .",
    "hence there is a @xmath160-chain @xmath422 in @xmath9 so that @xmath423 and @xmath424 .",
    "let @xmath425 be the @xmath160-chain which is equal to @xmath422 on the cayley complex , and equal to zero on @xmath160-cells adjacent to infinite valence vertices .",
    "then @xmath426 decomposes into a sum of @xmath179 , and a collection of @xmath7-cycles @xmath427 each of which lies entirely on the link of an infinite valence vertex .",
    "also , @xmath428 , so @xmath429 , where @xmath20 is the maximum length of an attaching map of a @xmath160-cell in @xmath9 .",
    "since the support of @xmath425 is entirely contained in the cayley complex , it can be considered as a @xmath160-chain in @xmath11 , whose boundary is the sum of @xmath421 and a collection of @xmath7-cycles , @xmath427 each of which lives entirely in a single parabolic coset . each @xmath427 can be filled by a @xmath160-chain @xmath430 whose support is entirely contained in the appropriate combinatorial horoball , so that @xmath431 .",
    "we also have that @xmath432 , by choosing the @xmath427 to have distinct supports ( choose one @xmath427 for each parabolic coset ) .",
    "now , by choosing appropriate orientations , we have @xmath433 .",
    "we also have @xmath434 this finishes the proof that @xmath11 satisfies a linear homological isoperimetric inequality .",
    "we state the combinatorial version of theorem [ t : xlii ] below for completeness .",
    "the proof is entirely analogous to that of theorem [ t : xlii ] with loops playing the part of @xmath7-cycles and disks the part of filling @xmath160-chains .",
    "let @xmath435 and @xmath139 be as in the statement of theorem [ t : xlii ] above .",
    "if @xmath296 satisfies a linear combinatorial isoperimetric inequality with constant @xmath51 then @xmath399 satisfies a linear combinatorial isoperimetric inequality , and we can take the constant to be @xmath436 .    the following is the main result of this section , and gathers together a few notions of relative hyperbolicity , including some that are new in this paper .",
    "[ t : tfae ] suppose that @xmath0 is a finitely generated group , that @xmath437 is a finite collection of finitely generated subgroups of @xmath0 , that @xmath438 is a finite relative presentation for @xmath0 , and @xmath43 is a compatible generating set containing @xmath134 .",
    "let @xmath403 be the coned - off cayley graph for @xmath159 with respect to @xmath43 and @xmath290 , and let @xmath10 be the coned - off cayley complex .",
    "let @xmath399 be as defined in definition [ d : x2 ] above .",
    "the following are equivalent :    1 .",
    "[ tfae1 ] @xmath0 is hyperbolic relative to @xmath290 in the sense of gromov ; 2 .",
    "[ tfae2 ] @xmath0 is hyperbolic relative to @xmath290 ( i.e. @xmath9 is gromov hyperbolic and fine ) ; 3 .   [ tfae3]@xmath10 satisfies a linear combinatorial isoperimetric inequality ; 4 .",
    "[ tfae4 ] @xmath10 satisfies a linear homological isoperimetric inequality ; 5 .",
    "[ tfae5 ] @xmath12 is gromov hyperbolic ; 6 .",
    "[ tfae6 ] @xmath11 satisfies a linear combinatorial isoperimetric inequality ; 7 .",
    "[ tfae7 ] @xmath11 satisfies a linear homological isoperimetric inequality .",
    "@xmath439\\ar @{=>}[dl ] & \\eqref{tfae1}\\ar @{= > } [ r ] & \\eqref{tfae2}\\ar @{=>}[d]\\\\ \\eqref{tfae6 } \\ar @{=>}[r ]   & \\eqref{tfae7}\\ar @{=>}[u ] & \\eqref{tfae4 } \\ar @{=>}[l ] & \\eqref{tfae3 } \\ar @{=>}[l]}}\\ ] ] the main result of @xcite is that implies ( cf .",
    "remark [ r : bcp ] ) . by proposition [ p : conelii ] , implies .    by lemma [ l : combtohom ] , implies and implies .    by theorem [ t : xlii ] , implies .",
    "now , implies , by theorem [ t : homtohyp ] .    proposition [ p : hyptocomb ]",
    "gives that implies , provided we can find a bound on the area of fillings of short loops in @xmath11 ( where `` short '' means at most @xmath178 ) .",
    "any combinatorial loop in @xmath11 of length at most @xmath178 which lies in a horoball can be filled by a combinatorial disk of length @xmath440 , by proposition [ p : combhorolii ] . up to the @xmath0-action , there are only finitely many loops of length less than @xmath178 which do not lie in a horoball",
    ". since @xmath11 is simply connected , these can all be filled , and so there is some universal constant @xmath441 so that any loop in @xmath11 of length less than @xmath178 can be filled by a disk of area at most @xmath441 .",
    "it remains to observe that the space @xmath11 satisfies the conditions of definition [ d : gromovrh ] , and so implies .",
    "gathering together these implications , the theorem is proved .",
    "we now suppose that @xmath0 is hyperbolic relative to @xmath290 , and that @xmath442 as in definition [ d : x1 ] ( for the moment we are only concerned with the metric properties of @xmath11 , and we restrict our attention to the @xmath7-complex version of @xmath11 ) .    by theorem [ t : tfae ] ,",
    "the graph @xmath11 is @xmath5-hyperbolic for some @xmath5 .",
    "we assume that this @xmath5 satisfies the conditions of remark [ r : deltaprops ]    [ lemma : convex ] if @xmath443 , the @xmath288-horoballs are convex in @xmath392 .",
    "let @xmath444 be a @xmath7-horoball , and let @xmath445 be the @xmath288-horoball contained in @xmath444 .",
    "we observe that @xmath446 is convex in @xmath444 ( where @xmath444 is endowed with its path metric ) .",
    "thus if @xmath446 fails to be convex in @xmath392 , then two points in @xmath445 are connected by a geodesic which passes through @xmath447 .",
    "let @xmath67 and @xmath18 be two such points in @xmath446 , chosen to have minimal distance from one another in the path metric on @xmath444 .",
    "( note that this distance must be at least @xmath448 so that the geodesic between them actually leaves @xmath444 .",
    "they must also satisfy @xmath449 . )",
    "choose another point @xmath450 so that @xmath451 and @xmath452 .",
    "there are then @xmath11-geodesics @xmath453 $ ] and @xmath454 $ ] which lie entirely in @xmath446 , whereas @xmath67 and @xmath18 are joined by a geodesic which includes points in @xmath447 , i.e. , points which are of distance at least @xmath288 from @xmath446 .",
    "since the triangle formed by these geodesics is @xmath5-slim , this implies that @xmath455 , a contradiction .",
    "we extend the choice of geodesics in lemma [ l : gamma ] to a choice of geodesics between any two points in @xmath11 :    [ l : geodesicbicombing ] if @xmath0 is torsion - free then there is an antisymmetric , @xmath0-equivariant geodesic bicombing @xmath456 on @xmath11 , so that if @xmath74 and @xmath75 lie in the same @xmath288-horoball for @xmath457 , then @xmath358 is as described in lemma [ l : gamma ]",
    ".    choose a complete set @xmath458 of representatives for the orbits of vertices of @xmath11 under the @xmath0-action .",
    "for each @xmath459 and each @xmath460 , choose a geodesic @xmath461 as in lemma [ l : gamma ] . extend equivariantly and antisymmetrically . because @xmath0 is torsion free",
    ", there is no element of @xmath0 which exchanges two points of @xmath11 .",
    "thus equivariance and antisymmetry may happily coexist .",
    "we say the bicombing in [ l : geodesicbicombing ] is ` antisymmetric ' because we consider paths to be maps .",
    "if paths are considered as subsets , it would be symmetric .",
    "we will sometimes blur this distinction , but it will not introduce any confusion . for more about the parametrizations of the bicombing , see paragraph [ ss : param ] .    when we define the homological bicombing in section [ section : bicombing ] , it will be _ antisymmetric _ , of course .",
    "[ r : tf1 ] if @xmath0 is not torsion - free , then there may be no bicombing as in lemma [ l : geodesicbicombing ] , because of the possible presence of @xmath160-torsion .",
    "the way to proceed in the presence of torsion is to let @xmath221 be the collection of all of the geodesics between @xmath74 and @xmath75 .",
    "this makes a number of the arguments later in this paper more awkward . at times",
    "it is also useful to consider the  average \" of all of the geodesics between @xmath74 and @xmath75 .",
    "the following is a slight generalization of the usual notion of cone types .",
    "[ d : conetype ] [ cone types ] suppose that @xmath0 is a group , that @xmath462 is a graph equipped with a free @xmath0-action and that @xmath463 is a vertex .    for a combinatorial path @xmath464 , let @xmath465 $ ] denote the @xmath0-orbit of @xmath92 .",
    "if @xmath306 is a vertex in @xmath462 , the _ cone type of @xmath306 viewed from @xmath74 _ is the collection of classes @xmath465 $ ] of paths for which    1 .",
    "there exists @xmath274 so that @xmath466 ; and 2 .",
    "@xmath467 .",
    "note that if @xmath468 and @xmath469 have the same cone type then , in particular , @xmath468 and @xmath469 lie in the same @xmath0-orbit .    in case @xmath462",
    "is the cayley graph of a finitely generated group @xmath0 , and @xmath470 , the above definition is equivalent to the usual notion of cone types ( see ( * ? ? ? *",
    "iii.@xmath159.2.16 ) , for example ) .    the following result follows directly from the proof of ( * ? ? ?",
    "* theorem iii.@xmath159.2.18 ) .",
    "[ l : finmanycones ] let @xmath0 be a finitely generated group acting freely on the locally compact @xmath5-hyperbolic graph @xmath462 , and suppose that @xmath463 is a vertex .",
    "each orbit of vertices in @xmath462 contains only finitely many cone types viewed from @xmath74 .",
    "[ l : thicklocal ] suppose that @xmath0 is hyperbolic relative to @xmath42 , where no @xmath40 is equal to @xmath0 .",
    "suppose further that @xmath43 is a compatible generating set for @xmath0 with respect to @xmath4 , and that @xmath471 is @xmath5-hyperbolic .",
    "finally , suppose that @xmath472 for each @xmath55",
    ".    for each @xmath287 there exists a @xmath473-local geodesic @xmath474 of length at least @xmath288 so that @xmath92 does not intersect any @xmath475-horoball in @xmath11 .",
    "proceed as follows .",
    "let @xmath444 and @xmath476 be distinct @xmath473-horoballs in @xmath11 .",
    "let @xmath477 be a shortest path between @xmath444 and @xmath476 .",
    "note that the length of @xmath477 is at least @xmath478 .",
    "let @xmath479 .",
    "for some @xmath55 , some @xmath480 and some @xmath481 , we have @xmath482 . by hypothesis",
    ", there exists @xmath483 so that the distance in @xmath484 between @xmath67 and @xmath18 is exactly @xmath485 .",
    "this implies that the geodesic @xmath358 between @xmath74 and @xmath486 intersects @xmath487 but not @xmath488 .",
    "this geodesic consists of two vertical segments , and a single horizontal segment of length @xmath160 .",
    "let @xmath489 .",
    "our @xmath473-local geodesic segment is then constructed as follows : start with @xmath477 , followed by @xmath358 .",
    "then take @xmath490 to the @xmath473-horoball @xmath491 . from the endpoint @xmath492 of @xmath490 in @xmath493 ,",
    "construct a a path @xmath494 exactly as above ( see figure [ f : localgeodesic ] ) .",
    "( 0,0)-local geodesic which stays in the `` thick '' part of @xmath11.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4066,2245)(1613,-3288 ) ( 3236,-3212)(0,0)[lb ] ( 4010,-2530)(0,0)[lb ] ( 4511,-1483)(0,0)[lb ] ( 5421,-2643)(0,0)[lb ] ( 1917,-1529)(0,0)[lb ] ( 2701,-2491)(0,0)[lb ] ( 4141,-1906)(0,0)[lb ] ( 4996,-1906)(0,0)[lb ]    continue in this manner .",
    "this construction can be iterated as many times as necessary to ensure the path has at least length @xmath288 , and it is not difficult to see that the ensuing path is a @xmath473-local geodesic ( note that the path @xmath477 , and its translates , must begin and end with a vertical path of length @xmath473 , since it is a shortest path between horoballs ) .",
    "[ t : onethickz ] suppose that @xmath0 is hyperbolic relative to @xmath42 , where no @xmath40 is equal to @xmath0 .",
    "suppose further that @xmath43 is a compatible generating set for @xmath0 with respect to @xmath4 , and that @xmath471 is @xmath5-hyperbolic .",
    "finally , suppose that @xmath472 for each @xmath55 .",
    "then there exists a hyperbolic element @xmath274 which has an axis @xmath495 so that @xmath496 $ ] .",
    "let @xmath497 be the total number of cone types of all points in @xmath498 $ ] as viewed from @xmath499 .",
    "let @xmath173 be a @xmath473-local geodesic of length longer than @xmath500 as in lemma [ l : thicklocal ] .",
    "in particular , @xmath173 does not penetrate any @xmath475-horoball . by translating @xmath173 by an element of @xmath0",
    ", we suppose that @xmath173 begins at @xmath499 .    by (",
    "* theorem iii.h.1.13(1 ) ) , any @xmath473-local geodesic is contained in the @xmath501-neighborhood of any geodesic joining the endpoints .",
    "a simple argument then shows that in fact the geodesic is contained in the @xmath502-neighborhood of the @xmath503-local geodesic .",
    "also , any @xmath473-local geodesic is a @xmath504-quasi - geodesic ( by ( * ? ? ?",
    "* theorem iii.h.1.13(3 ) ) ) .",
    "let @xmath505 be a geodesic segment joining the endpoints of @xmath173 .",
    "we have ensured that the length of @xmath505 is greater than @xmath497 , that @xmath505 does not intersect any @xmath506-horoball , and that @xmath505 starts at @xmath7 .. 2.22 ) . ]    therefore , there exist vertices @xmath507 which have the same cone type as viewed from @xmath7 .",
    "suppose that @xmath468 occurs before @xmath469 on @xmath505 .",
    "let @xmath508 be the subpath of @xmath505 from the @xmath7 to @xmath468 , let @xmath509 be that part between @xmath468 and @xmath469 , and let @xmath510 be the remainder of @xmath505 .",
    "since @xmath468 and @xmath469 have the same cone type , they are in the same @xmath0-orbit .",
    "let @xmath274 be so that @xmath511 .",
    "since @xmath512 is a geodesic , and @xmath468 and @xmath469 have the same cone type as viewed from @xmath7 , the path @xmath513 is also a geodesic .    in turn",
    ", this implies that @xmath514 is a geodesic .",
    "iterating this argument , we see that the path @xmath515 is a geodesic ray , starting at @xmath468 .",
    "denote this ray by @xmath68 .",
    "note that @xmath516 .",
    "let @xmath92 be the union of the paths @xmath517 as @xmath518 , parametrized in the obvious way .",
    "this is a bi - infinite geodesic line , contained in @xmath498 $ ] , upon which @xmath129 acts by translation .",
    "[ t : independentz ] suppose that @xmath0 is hyperbolic relative to @xmath42 , that @xmath519 for each @xmath55 and that @xmath520 is infinite .",
    "then @xmath0 is non - elementary relatively hyperbolic .",
    "suppose first that some parabolics are finite .",
    "let @xmath521 be the space obtained from definition [ d : x1 ] using _ all _ of the parabolics , and @xmath11 the space obtained using only the infinite parabolics .",
    "up to quasi - isometry , @xmath521 is @xmath11 with a locally finite collection of rays attached to the cosets of the finite parabolics . in particular , @xmath11 is gromov hyperbolic if and only if @xmath521 is . moreover , an element @xmath274 acts hyperbolically on @xmath521 if and only if it acts hyperbolically on @xmath11 .    therefore , we are free to assume that all of the parabolic subgroups of @xmath0 are infinite .",
    "let @xmath92 be the geodesic from theorem [ t : onethickz ] , which is an axis of a hyperbolic element @xmath274 .",
    "let @xmath522 and @xmath523 be the points in @xmath113 at either end of @xmath92 .",
    "let @xmath389 be a @xmath524-horoball in @xmath11 , and let @xmath525 be the point in @xmath113 coming from @xmath389 .",
    "consider an ideal geodesic triangle , @xmath21 , with vertices @xmath526 and @xmath525 , and edge @xmath92 between @xmath523 and @xmath522 .",
    "suppose furthermore , that the geodesics with endpoint @xmath525 are vertical after depth @xmath501 .",
    "by lemma [ l : idealthin ] , this triangle is @xmath121-slim .    the triangle @xmath21 intersects @xmath527 in a pair of points @xmath528 which are at most @xmath121 apart .",
    "since the parabolic @xmath202 which stabilizes @xmath389 is infinite , there exists @xmath529 so that @xmath530 .",
    "now , @xmath531 is another ideal triangle , with one vertex @xmath525 and the opposite side an axis for @xmath532 .",
    "we claim that @xmath533 .",
    "an easy argument shows that the hausdorff distance between two geodesics with the same endpoints at infinity is at most @xmath501 .",
    "suppose , for instance that @xmath534 .",
    "then the fact that the geodesics from @xmath535 to @xmath525 and from @xmath523 to @xmath525 are vertical below the @xmath501 level of @xmath389 , easily implies that @xmath536 , in contradiction to the choice of @xmath67 .",
    "thus , the elements @xmath129 and @xmath532 are hyperbolic elements with disjoint fixed sets in @xmath113 , and @xmath0 is non - elementary relatively hyperbolic , as required .      by virtue of theorem [ t : tfae ] , we may assume that @xmath375 is @xmath5-hyperbolic for some @xmath5 ; we are free to assume that @xmath5 is an integer and that @xmath537 .",
    "it is useful to have a few different scales to work at , and so we choose the following constants .",
    "the choices made will be justified by the results of the subsequent sections .",
    "[ d : constants ] we set @xmath538 , @xmath539 , and @xmath540 .",
    "we have made no attempt to make this choice of constants optimal .",
    "in this section we prove a theorem about collections of convex sets in an arbitrary proper gromov hyperbolic space .",
    "the construction in this section is crucial to the construction of _ preferred paths _ in the next section . in turn , preferred paths are the key to our construction of the bicombing in section [ section : bicombing ] .    [",
    "d : globule ] let @xmath13 be a geodesic metric space .",
    "a collection @xmath14 of convex sets is",
    "_ @xmath137-separated _ if for all @xmath541 the distance between @xmath81 and @xmath46 is at least @xmath137 .",
    "the elements of @xmath14 will be called _",
    "globules_.    let @xmath542 be the collection of all isometries @xmath129 of @xmath13 so that for all @xmath543 we have @xmath544 .    throughout the remainder of this section",
    ", we will suppose that @xmath14 is a @xmath545-separated collection of convex subsets of a @xmath5-hyperbolic space @xmath13 .    in subsequent sections of this paper",
    ", we will apply the results of this section in case @xmath546 and @xmath14 is the collection of all @xmath547-horoballs in @xmath11 .",
    "another interesting example is @xmath548 with some collection of ( sufficiently separated ) horoballs .",
    "it is worth remarking that the existence of a function @xmath549 satisfying the properties ( a1)(a7 ) below is not obvious even in the case of horoballs in @xmath3 .",
    "the main purpose of this section is to define , for any pair of points @xmath15 , a family of globules @xmath550 , which will be the collection of globules which are ` between ' @xmath16 and @xmath17 ( in case @xmath16 is contained in a globule @xmath81 we will have @xmath551 for all @xmath17 ) .",
    "we want our collections @xmath550 to satisfy various conditions , listed as axioms ( a1)-(a7 ) below .",
    "most of these are quite straightforward to ensure but axioms ( a5)(a7 ) , the most important for the applications , are much more difficult to guarantee .",
    "the construction performed in this section can be done if the globules are only quasi - convex .",
    "how far the globules must be separated depends on the constants of quasi - convexity .",
    "the following two lemmas will be useful :    if @xmath33 is a convex subset of @xmath13 then for any @xmath552 , the set @xmath553 is @xmath5-quasi - convex .",
    "[ l : tube ] let @xmath81 , @xmath46 be disjoint closed @xmath5-quasi - convex sets in the proper @xmath5-hyperbolic space @xmath13 .",
    "let @xmath16 , @xmath554 , and @xmath17 , @xmath555 .",
    "if @xmath18 is a geodesic between @xmath16 and @xmath17 , and @xmath556 a geodesic between @xmath557 and @xmath558 , then @xmath556 lies in the @xmath121-neighborhood of @xmath559 .",
    "moreover , for any @xmath560 , the hausdorff distance between the ( nonempty ) sets @xmath561 and @xmath562 is at most @xmath563 .",
    "let @xmath564 $ ] be any geodesic between @xmath16 and @xmath557 , and let @xmath565 $ ] be any geodesic between @xmath17 and @xmath558 ; since @xmath81 and @xmath46 are @xmath5-quasi - convex , @xmath564\\subset n_\\delta(a)$ ] and @xmath565\\subset n_\\delta(b)$ ] . consider the quadrilateral @xmath564\\cup q\\cup[b , b']\\cup[b , a']$ ] , pictured in figure [ f :",
    "tubelemma ] .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 4776,1598)(2284,-3898 ) ( 3260,-2869)(0,0)[lb ] ( 6005,-2869)(0,0)[lb ] ( 3120,-3479)(0,0)[lb ] ( 6094,-3441)(0,0)[lb ] ( 2624,-3136)(0,0)[lb ] ( 6450,-3085)(0,0)[lb ] ( 4588,-3009)(0,0)[lb ] ( 4556,-3504)(0,0)[lb ]    since @xmath13 is @xmath5-hyperbolic , this quadrilateral is @xmath501-slim . in particular , if @xmath74 is any point on @xmath556 , then @xmath566\\cup q\\cup[b , b ' ] \\right ) \\subset   n_{3\\delta } \\left ( a \\cup q\\cup b \\right).\\ ] ]    for the second assertion of the lemma , let @xmath80 be as in the statement ; since @xmath567 , the set @xmath568 is non - empty .",
    "let @xmath569 .",
    "we must show that @xmath570    as above , there is a point @xmath571\\cup q'\\cup[b , b']$ ] so that @xmath572 .",
    "since @xmath573 , and @xmath74 is at least @xmath80 from @xmath574 , the point @xmath492 must be on @xmath556 .",
    "if @xmath492 is outside the @xmath80-neighborhood of @xmath574 , then we are done , so suppose without loss of generality that @xmath492 lies in @xmath79 .",
    "let @xmath75 be the point on @xmath556 which is distance exactly @xmath80 from @xmath81 .",
    "let @xmath575 be a point in @xmath81 with @xmath576 . consider the geodesic triangle pictured in figure [ f : tubelemma2 ]",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 3638,2828)(2390,-4885 ) ( 5458,-4037)(0,0)[lb ] ( 5401,-2996)(0,0)[lb ] ( 2592,-4787)(0,0)[lb ] ( 3317,-3401)(0,0)[lb ] ( 3139,-4062)(0,0)[lb ] ( 4270,-3007)(0,0)[lb ] ( 4435,-3618)(0,0)[lb ] ( 3914,-4266)(0,0)[lb ]    with vertices @xmath577 , @xmath575 , and @xmath75 .",
    "this triangle is @xmath5-thin and the geodesic between @xmath577 and @xmath575 is contained in @xmath578 . since @xmath579",
    ", we have @xmath580 , so @xmath492 can not be as close as @xmath5 to the geodesic between @xmath577 and @xmath575 ; thus there is a point @xmath99 on the geodesic between @xmath75 and @xmath575 so that @xmath581 and @xmath582 .",
    "we have @xmath583 and so @xmath584 ; this implies @xmath585 .",
    "finally , @xmath586 , and the lemma is proved .",
    "the assumptions of lemma [ l : tube ] can be weakened .",
    "at the cost of a slightly more complicated proof , the assumptions of ` closed ' and proper can be removed .",
    "however we will only ever use lemma [ l : tube ] exactly as it is stated .",
    "[ d : geods ] for @xmath15 , let @xmath587 be the set of all geodesics between @xmath16 and @xmath17 .",
    "suppose that @xmath588 .",
    "let @xmath589 denote the set of globules which intersect some element of @xmath587 nontrivially .",
    "for any @xmath80 let @xmath590 denote the set of globules @xmath202 so that for every @xmath591 @xmath592    since bigons are @xmath5-thin , @xmath593 for all @xmath594 .",
    "( recall @xmath538 . )",
    "[ r : orientation ] for a geodesic @xmath92 in @xmath13 , the set of globules @xmath595 so that @xmath596 inherits a natural order by projection to the geodesic .",
    "this is because globules lie at least @xmath597 apart from each other .",
    "this induces an order on @xmath598 for each @xmath15 and each @xmath599 ; this order is independent of @xmath92 .",
    "note that if @xmath598 intersects @xmath600 nontrivially , then the order on the intersection inherited from @xmath600 will either coincide with the order inherited from @xmath598 or with its reverse .    for any @xmath15",
    ", there are only finitely many elements of @xmath601 : the size is bounded by @xmath602 .",
    "let @xmath603 be the set of totally ordered finite subsets of @xmath14    thus we have functions @xmath604 and @xmath605 note that the action of @xmath542 on @xmath14 induces an action on @xmath603 and that @xmath606 and @xmath607 are equivariant with respect to this action .",
    "( note also that the same subset appears many times in @xmath603 , once for each possible total order on the subset .",
    "thanks to remark [ r : orientation ] , only two of these orders actually appear in the image of @xmath606 or @xmath607 . )    for a function @xmath608 we will denote @xmath609 by @xmath610 . in the properties ( a1)(a6 ) defined below , the symbol `` @xmath611 '' is used to denote `` ordered subset '' , not just `` subset '' .",
    "we will use the following notation for subintervals : let @xmath612 .",
    "if @xmath81 and @xmath46 are contained in @xmath610 then @xmath613 & = & \\ {   y \\in \\ghh_{a , b } \\mid a\\le y \\le b \\},\\\\ \\ghh_{a , b}(a , a ] & = &      \\ { y \\in \\ghh_{a , b } \\mid y \\le a \\},\\mbox { and } \\\\",
    "\\ghh_{a , b}[a , b ) & = & \\ { y \\in \\ghh_{a , b } \\mid a \\le y \\}.\\end{aligned}\\ ] ]    here are some useful conditions @xmath614 might satisfy :    1 .   for all @xmath15 , @xmath615 ; 2 .   for all @xmath15 , @xmath616 ; 3 .   for all",
    "@xmath15 , @xmath617 ; 4 .",
    "@xmath614 is @xmath542-equivariant .",
    "5 .   if @xmath618 for some @xmath619 and @xmath620 then @xmath621 = { \\mathcal{{c}}}_{c , d}[a , b]$ ] ; 6 .",
    "if @xmath622 for some @xmath623 and @xmath624 then @xmath625 = { \\mathcal{{c}}}_{a , c}(a , a]$ ] . 7 .   if @xmath626 for some @xmath627 and @xmath624 then @xmath628 .",
    "note that axiom ( a7 ) follows from ( a6 ) and ( a3 ) .",
    "the purpose of this section is to find a function @xmath549 which satisfies all seven of the axioms ( a1)(a7 ) . for the application in the next section , ( a5)(a7 )",
    "are the most important .",
    "they are also the most difficult to ensure , although our definition of @xmath549 in definition [ d : filtration ] below is designed to make ( a5)(a7 ) as apparent as possible .",
    "the approach to constructing @xmath549 is as follows .",
    "we start with @xmath606 with the order as in remark [ r : orientation ] and observe :    the function @xmath606 satisfies ( a1 )  ( a4 )    for a pair @xmath15 , the final @xmath550 will come from the preliminary @xmath629 by adding new elements in order to make ( a5)(a7 ) hold .",
    "it is not at all obvious that enforcing ( a5)(a7 ) whilst retaining ( a1)(a4 ) is possible .",
    "this is the content of the proof of theorem [ t : ppw ] below .    by ( a2 ) , all of the elements of @xmath550 must lie in @xmath630 .",
    "below we define a filtration of @xmath549 , which will be the minimal ( in an obvious sense of the word minimal ) possible function satisfying ( a1)(a7 ) . before giving the definition , consider the possible ways that ( a5)(a7 ) might fail to hold for some @xmath610 .",
    "either ( a5 ) fails ( in the `` middle '' of @xmath610 ; see figure [ f : typem ] ) , ( a6 ) fails ( on the `` left '' ; see figure [ f : typel ] ) or ( a7 ) fails .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 5018,1366)(1741,-1493 ) ( 3826,-1141)(0,0)[lb ] ( 2926,-781)(0,0)[lb ] ( 4726,-781)(0,0)[lb ] ( 6481,-1321)(0,0)[lb ] ( 1846,-1141)(0,0)[lb ] ( 6661,-376)(0,0)[lb ] ( 1756,-286)(0,0)[lb ]    ( 0,0 )    # 1#2#3#4#5 @font    ( 4981,1559)(1718,-1493 ) ( 1756,-556)(0,0)[lb ] ( 3016,-1141)(0,0)[lb ] ( 4276,-826)(0,0)[lb ] ( 6616,-241)(0,0)[lb ] ( 6616,-1321)(0,0)[lb ]    definition [ d : filtration ] below can be thought of in the following way : start with @xmath606 , and `` fix '' every failure of axiom ( a5)(a7 ) ; after doing these repairs you will have obtained @xmath631 , which still does nt satisfy ( a5)(a7 ) . repairing @xmath631 yields",
    "@xmath632 , and so on .",
    "[ d : filtration ] for any pair @xmath15 , we make the following definitions : let @xmath633 , and define inductively , for @xmath634 : @xmath635",
    "\\right ) ,    \\\\ { \\mathcal{{l}}}^i_{a , b } & = &   \\bigcup_{d \\in \\upsilon } \\left ( \\bigcup_{a \\in { \\mathcal{{d}}}^i_{a , b } \\cap { \\mathcal{{d}}}^i_{a , d } } { \\mathcal{{d}}}^i_{a , d}(a , a ] \\right),\\\\ { \\mathcal{{r}}}^i_{a , b } & = &   \\bigcup_{c\\in \\upsilon } \\left ( \\bigcup_{a\\in { \\mathcal{{d}}}^i_{c , b}\\cap { \\mathcal{{d}}}^i_{a , b } } { \\mathcal{{d}}}^i_{c , b}[a , b ) \\right ) , \\mbox { and } \\\\ { \\mathcal{{d}}}^{i+1}_{a ,",
    "b }   & = & { \\mathcal{{d}}}^i_{a , b } \\cup { \\mathcal{{m}}}^i_{a , b } \\cup   { \\mathcal{{l}}}^i_{a , b } \\cup { \\mathcal{{r}}}^i_{a , b}.\\end{aligned}\\ ] ] finally , we define @xmath636    notice that the set @xmath637 fixes the failure of ( a5 ) for @xmath638 , and so on .",
    "the following is the main result of this section , which will allow us to define preferred paths in the next section .",
    "[ t : ppw ] suppose that @xmath14 is a @xmath545-separated collection of convex subsets of a @xmath5-hyperbolic space @xmath13",
    ". then the function @xmath549 as defined in definition [ d : filtration ] satisfies the axioms ( a1)(a7 ) .    definition [ d : filtration ] is tailored so as to make ( a5)(a7 ) as apparent as possible ( once it is known that @xmath549 satisfies ( a2 ) , ( a5)(a7 ) are immediate ) . as explained below , the hard part of proving theorem [ t : ppw ] is axiom ( a2 ) .",
    "we will proceed by induction . on their own ,",
    "axioms ( a1)(a4 ) for @xmath639 do not seem strong enough to imply axioms ( a1)(a4 ) for @xmath640 . in order for the inductive proof to work , we need to impose further conditions , which are encapsulated in the following definitions .",
    "[ d : guards ] let @xmath15 and @xmath641 with @xmath642 .",
    "pair of @xmath643-guards _ of @xmath33 is a pair @xmath644 ( each of which may be either a point or a globule ) so that there exists @xmath645 for which :    1 .",
    "@xmath646 ; 2 .   either @xmath647 or @xmath648 and @xmath649 ; and 3 .   either @xmath650 or @xmath651 and @xmath652",
    "we inductively define _",
    "@xmath643-sentinels _ of @xmath33 by saying that @xmath643-guards of @xmath33 are @xmath643-sentinels of @xmath33 and that if @xmath326 is an @xmath643-sentinel of @xmath33 then any @xmath643-guards of @xmath326 are @xmath643-sentinels of @xmath33 .    for any @xmath653 and @xmath33 as in definition",
    "[ d : guards ] , @xmath643-guards of @xmath33 come in pairs ( one to the left of @xmath33 and one to the right ) . a single @xmath643-guard may occur in many pairs .",
    "we also remark that for any @xmath654 , any @xmath594 and any @xmath655 , a pair of @xmath643-guards of @xmath33 is also a pair of @xmath656-guards of @xmath33 .",
    "we now introduce the property which will form the inductive hypothesis in the proof of theorem [ t : ppw ] .",
    "[ d : prop ] given an integer @xmath657 , a pair @xmath594 and a globule @xmath655 we let @xmath658 be the conjunction of the following three statements :    1 .",
    "@xmath659 ; 2 .",
    "@xmath660 ; and 3 .",
    "either ( i ) @xmath33 has a pair of @xmath643-guards ; ( ii ) @xmath661 ; or ( iii ) @xmath662 .",
    "[ l : ifitheni+1 ] for any @xmath663 , any @xmath15 and any @xmath655 , if @xmath658 holds then @xmath664 also holds .",
    "[ d : sp ] let @xmath15 and @xmath665 .",
    "suppose that @xmath599 and that @xmath92 intersects both @xmath666 and @xmath667 nontrivially for some @xmath668 .",
    "suppose also that @xmath669 in the order on @xmath670 as in remark [ r : orientation ] .",
    "let @xmath75 be the last point on @xmath92 in @xmath666 and @xmath99 the first point on @xmath92 in @xmath667 .",
    "define @xmath671 to be the subsegment of @xmath92 between @xmath75 and @xmath99 .",
    "axiom ( a4 ) is obvious .",
    "the ( unordered ) set theoretic parts of ( a1 ) and ( a3 ) are also obvious .",
    "the set theoretic part of ( a2 ) is the key : by remark [ r : orientation ] , this gives sense to ( and implies ) all the statements about ordered sets .",
    "axioms ( a5)(a7 ) will then follow from the construction .",
    "axiom ( a2 ) follows from the following inductive statement :    [ c : induction ] for @xmath634 , all @xmath594 and all @xmath655 the following are equivalent :    1 .",
    "[ c : di ] @xmath672 ; 2 .",
    "[ c : pi ] @xmath673 holds , and @xmath674 holds whenever @xmath326 is an @xmath675-sentinel of @xmath33 .    note that for any @xmath634 , any @xmath15 and any @xmath655 , the statement `` ( [ c : pi ] ) implies ( [ c : di ] ) '' holds tautologically ( by statement [ d : prop].(1 ) ) .",
    "we will prove claim [ c : induction ] by induction on @xmath55 .",
    "* base case : * [ l : basecase ] for any @xmath15 and @xmath655 , if @xmath676 then @xmath677",
    ". moreover , whenever @xmath326 is an @xmath678-sentinel of @xmath33 , @xmath679 holds .",
    "suppose @xmath676 . if @xmath661 or @xmath680 then the result is immediate .",
    "thus we may suppose that @xmath681 .",
    "statement [ d : prop].(1 ) holds by assumption .",
    "statement [ d : prop].(2 ) holds because @xmath682 .",
    "statement [ d : prop].(3 ) holds because @xmath683 form a pair of @xmath678-guards of @xmath33 .",
    "now suppose that @xmath326 is a @xmath678-sentinel of @xmath33 .",
    "this implies that @xmath684 and the same argument applies .    *",
    "inductive hypothesis : * fix @xmath685 . for any @xmath686 , any @xmath594 and any @xmath655",
    "if @xmath672 then @xmath673 is true and @xmath674 holds for any @xmath675-sentinel @xmath326 of @xmath33 .    *",
    "inductive step : * consider @xmath594 and @xmath655 and suppose that @xmath659 .",
    "we wish to prove that @xmath658 holds and that @xmath687 holds for any @xmath643-sentinel @xmath326 of @xmath33 .",
    "observe that if @xmath326 is an @xmath643-sentinel of @xmath33 then it is in particular in @xmath688 .",
    "therefore since @xmath689 was arbitrary , it suffices to prove that @xmath658 holds .    by definition",
    "[ d : filtration ] , one of four situations must occur :    1 .",
    "[ case1 ] @xmath690 ; 2 .",
    "[ case2 ] @xmath691 ; 3 .",
    "[ case3 ] @xmath692 ; or 4 .",
    "[ case4 ] @xmath693 .",
    "we deal with each of these situations in turn .",
    "* case [ case1 ] : * in this case @xmath694 holds by induction , and by lemma [ l : ifitheni+1 ] @xmath658 also holds .    *",
    "case [ case2 ] : * suppose that @xmath695 but that @xmath691",
    ".    therefore , there are @xmath696 and @xmath620 so that    1 .",
    "@xmath697 , and 2 .",
    "@xmath698 $ ] .",
    "we wish to show that @xmath658 holds .",
    "statement [ d : prop].(1 ) is clear .    we now prove statement [ d : prop].(2 ) of @xmath658 .",
    "since @xmath699 , the statement @xmath700 holds by the inductive hypothesis , as does @xmath701 for any @xmath702-sentinel @xmath326 of @xmath33 . note that @xmath703 , so @xmath704 and @xmath33 has a pair of @xmath702 guards @xmath206 and @xmath24 , by property @xmath705 .",
    "suppose that @xmath706 are the points associated to @xmath707 and @xmath24 from definition [ d : guards ] .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 5018,2144)(1741,-2303 ) ( 3196,-1546)(0,0)[lb ] ( 5266,-1636)(0,0)[lb ] ( 2656,-1051)(0,0)[lb ] ( 4636,-1141)(0,0)[lb ] ( 3961,-1636)(0,0)[lb ] ( 1756,-2086)(0,0)[lb ] ( 1801,-1141)(0,0)[lb ] ( 1756,-466)(0,0)[lb ] ( 6661,-691)(0,0)[lb ] ( 6661,-1231)(0,0)[lb ] ( 6661,-2131)(0,0)[lb ]    we now define globules @xmath202 and @xmath150 . in case @xmath708 , let @xmath709 .",
    "otherwise , @xmath206 and @xmath81 are both globules in @xmath710 and we let @xmath711 with respect to the order on @xmath710 .",
    "similarly , if @xmath712 then @xmath713 and otherwise @xmath714 . see figure [ f : xyzw ] for an illustrative picture . in the figure , @xmath715 and @xmath716 , and they are all globules .    *",
    "claim 1 : * @xmath717 .",
    "we only consider @xmath202 , as the argument for @xmath150 is identical .",
    "if @xmath718 then @xmath719 .",
    "thus suppose that @xmath709 and that @xmath720 .",
    "there are now two cases , depending on whether @xmath721 or not .",
    "if @xmath722 , let @xmath723 denote that portion of @xmath724 between the last point in @xmath725 and the first point in @xmath726 , and define @xmath723 similarly . note that if @xmath727 and @xmath728 are not disjoint , then @xmath729 is certainly contained in @xmath730 . otherwise , since the singleton @xmath731 is convex , lemma [ l : tube ] implies that the hausdorff distance between @xmath723 and @xmath723 is at most @xmath563 .",
    "but @xmath732 , so by the inductive hypothesis @xmath733 .",
    "therefore @xmath724 passes within @xmath734 of @xmath735 , as required",
    ". see figure [ f : claim1point ] .",
    "dotted lines indicate @xmath736 and @xmath737.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4589,1423)(1364,-3448 ) ( 2881,-2266)(0,0)[lb ] ( 1486,-2401)(0,0)[lb ] ( 3691,-2851)(0,0)[lb ] ( 4951,-3031)(0,0)[lb ] ( 4906,-2401)(0,0)[lb ]    suppose then that @xmath738 or @xmath739 .",
    "then @xmath206 is a globule and is separated from @xmath81 by at least @xmath547 . by lemma [ l : tube ] again , the hausdorff distance between @xmath740 and @xmath741 is at most @xmath563 .",
    "once again we know by induction that @xmath742 , which proves that @xmath724 passes within @xmath743 of @xmath81",
    ". see figure [ f : claim1 ] .",
    "this proves claim 1 .",
    "( 0,0 ) is not @xmath74 and @xmath179 .",
    "dotted lines indicate @xmath736 and @xmath737.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4389,1754)(1744,-3779 ) ( 2656,-2851)(0,0)[lb ] ( 3556,-2266)(0,0)[lb ] ( 4546,-2851)(0,0)[lb ] ( 2206,-3706)(0,0)[lb ] ( 5401,-2401)(0,0)[lb ]    * claim 2 : * @xmath744 .    once again",
    ", we only consider @xmath202 , as the argument for @xmath150 is identical .    if @xmath709 then @xmath745 so by induction we have @xmath746 and @xmath747 .",
    "suppose then that @xmath715 and that @xmath748 ( this is depicted in figure [ f : xyzw ] ) .",
    "certainly we also have @xmath749 .    we know",
    "that @xmath750 so by the inductive hypothesis @xmath751 .",
    "let @xmath752 and @xmath753 be arbitrary . then @xmath754 and @xmath755",
    "pass within @xmath51 of both @xmath81 and @xmath46 .",
    "since @xmath718 is an @xmath702-guard of @xmath33 , and @xmath756 we know @xmath757 and so by another application of the inductive hypothesis @xmath758 .",
    "therefore @xmath755 passes within @xmath51 of @xmath202 .    by lemma [ l : tube ] ,",
    "the hausdorff distance between @xmath759 and @xmath760 is at most @xmath563 .",
    "thus , @xmath754 passes within @xmath743 of @xmath202 , proving claim 2 ( see figure [ f : claim2 ] ) .",
    "dotted lines indicate @xmath761 and @xmath762.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4929,1341)(1744,-2830 ) ( 3736,-1951)(0,0)[lb ] ( 6211,-2536)(0,0)[lb ] ( 2566,-2311)(0,0)[lb ] ( 5536,-2266)(0,0)[lb ] ( 3556,-2761)(0,0)[lb ]    note that whatever @xmath202 and @xmath150 are , we always have @xmath763 .",
    "since @xmath764 , lemma [ l : tube ] implies that the hausdorff distance between @xmath765 and @xmath766 is at most @xmath563 . since @xmath766 intersects @xmath33 , the geodesic @xmath754 passes within @xmath563 of @xmath33 ( figure [ f : pq ] ) .",
    "this proves statement [ d : prop].(2 ) of @xmath658 .",
    "( 0,0).(2 ) .",
    "dotted lines indicate @xmath767 and @xmath768.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4299,2044)(1789,-3824 ) ( 5086,-1951)(0,0)[lb ] ( 2656,-2851)(0,0)[lb ] ( 3601,-3031)(0,0)[lb ] ( 4906,-3751)(0,0)[lb ] ( 4546,-2851)(0,0)[lb ]    we now prove statement [ d : prop].(3 ) of @xmath658 . we claim that @xmath202 and @xmath150 form a pair of @xmath643-guards of @xmath33",
    "it is certainly true that @xmath769 , and that keeping the same @xmath74 and @xmath75 we still have @xmath770 .",
    "note that @xmath202 and @xmath150 are globules .",
    "thus we have to prove    1 .",
    "[ subcase(i ) ] @xmath771 ; and 2 .",
    "[ subcase(ii ) ] @xmath772 .    once again , we prove these statements for @xmath202 , the arguments for @xmath150 being analogous .",
    "suppose that @xmath773 .",
    ". otherwise , @xmath718 and @xmath775 .",
    "therefore @xmath776 $ ] , which implies , by the definition of @xmath777 , that @xmath778 .",
    "this proves statement [ subcase(i ) ] above .",
    "we now prove statement [ subcase(ii ) ] . if @xmath718 then @xmath779 , so we are done .",
    "thus suppose that @xmath773 , and @xmath780 .",
    "we know that @xmath781 .",
    "certainly , @xmath782 so @xmath783",
    ". suppose that @xmath784 .",
    "this forces @xmath708 , by definition [ d : guards ] , so @xmath360 and @xmath785 .",
    "suppose now that @xmath786 .",
    "then the inductive hypothesis and property @xmath787 imply that @xmath81 has a pair of @xmath702-guards , which we denote @xmath788 and @xmath789 , and an associated pair of points @xmath790 , as in definition [ d : guards ] .",
    "we know that @xmath791 and that    1 .",
    "either @xmath792 or @xmath793 ; and 2 .   either @xmath794 or @xmath795 .",
    "in case @xmath788 is a globule , we have @xmath796 , and in case @xmath789 is a globule we have @xmath797 .",
    "( see figure [ f : c3c3s2 ] ) .",
    "( 0,0).(3 ) ( one of many possible arrangements).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4569,2245)(1564,-3734 ) ( 3556,-2266)(0,0)[lb ] ( 5401,-2401)(0,0)[lb ] ( 2656,-2851)(0,0)[lb ] ( 5041,-2851)(0,0)[lb ] ( 4321,-2311)(0,0)[lb ] ( 2206,-2311)(0,0)[lb ] ( 1936,-1681)(0,0)[lb ] ( 2206,-3661)(0,0)[lb ]    we now define @xmath798 , which may be either a point or a globule . in case @xmath708 , define @xmath799 ( which may be either a point or a globule ) . in case @xmath206 is a globule , we consider whether @xmath788 is a point or a globule .",
    "if @xmath788 is a point then @xmath800 . otherwise @xmath801 .",
    "note that if @xmath206 is a globule , so is @xmath798 .",
    "we also define a globule @xmath802 . if @xmath803 then @xmath804 . if @xmath789 is a globule then @xmath805 .    * claim 3 : * if @xmath798 is a globule then @xmath806 .",
    "in any case @xmath807 .",
    "the proof of this is similar to those of claims 1 and 2 .",
    "let @xmath808 be any geodesic between @xmath809 and @xmath810 . in case @xmath798",
    "is a globule , claim 3 and lemma [ l : tube ] imply that the hausdorff distance between @xmath811 and @xmath812 is at most @xmath563 . since @xmath813 and @xmath808 intersects @xmath81 , the path @xmath724 passes within @xmath563 of @xmath81 .",
    "thus in this case @xmath814,as required .",
    "suppose that @xmath798 is a point ( see figure [ f : c3c3s2corner ] ) . in this case ,",
    "@xmath708 and @xmath815 , so @xmath816 . in case @xmath817 and",
    "@xmath81 are not disjoint , @xmath74 lies within @xmath563 of @xmath81 , and certainly @xmath818 . otherwise , the singleton @xmath819 is convex so lemma [ l : tube ] implies that the hausdorff distance between those parts of @xmath724 and @xmath808 between @xmath728 and @xmath726 are at hausdorff distance at most @xmath563 from each other . since @xmath791 this implies once again that @xmath820 as required .",
    "( 0,0).(3 ) ( another of many possible arrangements).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4797,1954)(1336,-3329 ) ( 3556,-2266)(0,0)[lb ] ( 5401,-2401)(0,0)[lb ] ( 5041,-2851)(0,0)[lb ] ( 4321,-2311)(0,0)[lb ] ( 4096,-3256)(0,0)[lb ] ( 1351,-1906)(0,0)[lb ] ( 4726,-1546)(0,0)[lb ]    this finally proves that @xmath202 and @xmath150 form a pair of @xmath643-guards of @xmath33 , and finishes the proof of case ( 2 ) .    *",
    "case 3 : * suppose that @xmath821 , but that @xmath822 .    therefore , there is @xmath823 and @xmath824 so that @xmath825 $ ] .",
    "we are required to show that @xmath658 holds . as usual , statement [ d : prop].(1 ) is immediate .",
    "the inductive hypothesis implies that @xmath826 holds .    since @xmath695 and @xmath827 are globules , they are different and @xmath828",
    ". therefore , @xmath829 , and so either @xmath661 or @xmath33 has a pair of @xmath830-guards .",
    "if @xmath661 then statements [ d : prop].(2 ) and [ d : prop].(3 ) are clear .",
    "therefore we suppose that @xmath831 .",
    "we now prove [ d : prop].(2 ) .",
    "let @xmath206 and @xmath24 be a pair of @xmath830-guards for @xmath33 , with associated points @xmath832 .",
    "note that either @xmath833 or @xmath834 . also , either @xmath712 or @xmath835 .",
    "let @xmath715 and @xmath836 .",
    "note that @xmath202 may be a point or a globule whereas @xmath150 is definitely a globule .",
    "then following is entirely analogous to claims 1 , 2 and 3 :    * claim 4 : * if @xmath202 is a globule then @xmath837 . in any case @xmath838 .",
    "an identical argument to that which followed claim 3 implies that @xmath839 , which proves [ d : prop].(2 ) .",
    "we now prove [ d : prop].(3 ) .",
    "note that @xmath840 and we are assuming that @xmath841 .",
    "therefore we are required to show that @xmath33 has a pair of @xmath842)-guards .",
    "we will show that @xmath202 and @xmath150 form such a pair ( with associated points @xmath74 and @xmath75 ) .    if @xmath843 then @xmath844 also , so [ d : guards].(2 ) holds in this case .",
    "otherwise , @xmath715 is a globule and @xmath845 ( see figure [ f : l1 ] ) . since @xmath846 , and",
    "@xmath827 this implies that @xmath847 .",
    "thus we have proved [ d : guards].(2 ) .",
    "( 0,0 ) , in case @xmath33 has @xmath830-guards.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4569,1521)(1564,-3718 ) ( 2926,-3121)(0,0)[lb ] ( 4006,-2761)(0,0)[lb ] ( 1621,-2356)(0,0)[lb ] ( 5401,-2401)(0,0)[lb ] ( 2161,-2896)(0,0)[lb ] ( 3601,-3166)(0,0)[lb ] ( 5311,-2941)(0,0)[lb ] ( 4771,-3526)(0,0)[lb ]    we now show [ d : guards].(3 ) .",
    "note that @xmath150 is a globule and that @xmath848 . if @xmath849 then @xmath24 is a globule and @xmath850 . in this case",
    "also @xmath851\\subseteq { \\mathcal{{l}}}^{n-1}_{a , b }   \\subseteq { \\mathcal{{d}}}^n_{a , b}$ ] .",
    "this proves [ d : guards].(3 ) in this case .",
    "suppose then that @xmath852 .",
    "then @xmath853 and we need only prove that @xmath854 .    by the inductive hypothesis , since @xmath81 is an @xmath830-sentinel of @xmath33 and @xmath855 , property @xmath856 holds .",
    "certainly @xmath857 , and both are globules , so @xmath858 . if @xmath859 then since @xmath860 and @xmath861 , it can not be that @xmath24 is a globule . therefore in this case @xmath862 , so @xmath863 and @xmath864 .",
    "suppose then that @xmath865 .",
    "in this case , [ d : prop].(3 ) implies that @xmath81 has a pair of @xmath830-guards , which we denote by @xmath788 and @xmath789 , with associated points @xmath866 ( see figure [ f : l2 ] ) . as before ,",
    "we define @xmath867 and @xmath868 .",
    "note that @xmath798 is always a globule but @xmath802 might be a point .",
    "( 0,0 ) and @xmath150 form a pair of @xmath643-guards for @xmath33 ( when @xmath860).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4884,2449)(1474,-4049 ) ( 2926,-3121)(0,0)[lb ] ( 4006,-2761)(0,0)[lb ] ( 4366,-3346)(0,0)[lb ] ( 1621,-2356)(0,0)[lb ] ( 2161,-2896)(0,0)[lb ] ( 4546,-3976)(0,0)[lb ] ( 2656,-2446)(0,0)[lb ] ( 4951,-2806)(0,0)[lb ] ( 5761,-2986)(0,0)[lb ] ( 5716,-1771)(0,0)[lb ]    we now make the customary    * claim 5 : * if @xmath802 is a globule then @xmath869 . in any case @xmath870 .",
    "since @xmath791 , the argument following claim 3 now implies that @xmath871 as required .",
    "this establishes [ d : guards].(3 ) .",
    "this proves that property @xmath658 , which finally completes the proof of case 3 .",
    "* case 4 : * finally , suppose that @xmath695 but @xmath693 .",
    "the proof that @xmath658 holds is identical ( with a left - right reflection ) to that of case 3 .",
    "this completes the proof of claim [ c : induction ] , which as we noted above implies that axiom ( a2 ) holds for the collections @xmath872 . in turn , by remark [ r : orientation ] , this gives a coherent order on each of the sets .",
    "the function @xmath549 was designed to make axioms ( a5)(a7 ) immediately apparent , once axiom ( a2 ) holds , and axioms ( a1 ) , ( a3 ) and ( a4 ) are now clear also .",
    "this completes the proof of theorem [ t : ppw ] .",
    "suppose that @xmath620 , and that @xmath873 and @xmath874",
    ". then @xmath875 .    also ,",
    "if @xmath876 then @xmath877 .",
    "axiom ( a1 ) implies that @xmath878 .",
    "an application of ( a5 ) implies that @xmath879 , and , symmetrically , @xmath880 ( note that we are implicitly using the order and separation properties of globules ) .",
    "the proof of the second assertion is similar ( using axiom ( a7 ) instead ) .",
    "[ n : horofamilies ] suppose that @xmath881 .",
    "then we denote the set @xmath550 for @xmath882 and @xmath883 by @xmath872 .",
    "this is well - defined by the above corollary .",
    "similarly , if @xmath884 and @xmath624 , then the sets @xmath885 and @xmath886 are well - defined .",
    "throughout this section , and the remainder of the paper , @xmath0 will denote a torsion - free group which is hyperbolic relative to a ( finite ) collection of ( finitely generated ) subgroups @xmath202 .",
    "we suppose that @xmath43 is a finite compatible generating set for @xmath0 , and that @xmath5 is the constant of hyperbolicity for @xmath887 .    in this section",
    "we define _",
    "preferred paths_. preferred paths give an equivariant , symmetric quasi - geodesic bicombing of the space @xmath888 , and will be a key to our construction of the bicombing in section [ section : bicombing ] below . having defined preferred paths , we then use them to understand the combinatorial types of triangles whose sides are preferred paths .",
    "we fix some notation and terminology : recall that @xmath5 gives rise to the constants @xmath889 , @xmath890 , and @xmath891 . denote by @xmath336 the collection of @xmath547-horoballs in @xmath11 ( definition [ d : horoball ] ) . in this section",
    ", the word ` horoball ' ( without a prefix ) will refer to an element of @xmath336 .",
    "suppose that @xmath202 is a horoball and @xmath892 .",
    "there is a unique @xmath137-horoball which intersects @xmath202 nontrivially .",
    "we denote this @xmath137-horoball by @xmath893 .",
    "any horoball @xmath202 has a single accumulation point in @xmath113 , which we denote @xmath894 .",
    "denote by @xmath895 the collection of such accumulation points .",
    "[ d : geodab ] recall that in lemma [ l : geodesicbicombing ] we chose a @xmath0-equivariant antisymmetric geodesic bicombing @xmath92 .",
    "let @xmath896 denote the set of unit - speed geodesic paths in @xmath11 , up to orientation preserving reparametrization .",
    "we will extend @xmath92 to an antisymmetric map from most of @xmath897 to @xmath896 .",
    "( if @xmath81 is a horoball , we leave @xmath898 , @xmath899 , @xmath900 and @xmath901 undefined . )    first , for each pair of horoballs @xmath902 , we choose ( in an antisymmetric and @xmath0-equivariant way ) , a geodesic @xmath903 , which realizes the distance between @xmath81 and @xmath46 .",
    "second , for each point @xmath904 and each horoball @xmath905 , we ( equivariantly ) choose a geodesic path @xmath906 which realizes the distance from @xmath16 to @xmath81 . the path @xmath907 is the time - reverse of @xmath906 .",
    "third , we extend @xmath92 to points in @xmath895 .",
    "if @xmath460 and @xmath908 then we define @xmath909 to be the concatenation of @xmath910 with the vertical geodesic ray in @xmath81 from the endpoint of @xmath910 to @xmath911 .    finally ,",
    "if @xmath912 correspond to distinct horoballs @xmath81 and @xmath46 in @xmath336 then we define @xmath913 to be the path @xmath903 , together with vertical paths on either end .",
    "note that @xmath914 is always a geodesic line .",
    "[ r : tf2 ] as noted in remark [ r : tf1 ] , @xmath160-torsion may prevent a choice of paths as in definition [ d : geodab ] above .    also , if there is torsion , then parabolic subgroups of @xmath0 could intersect nontrivially , which makes the @xmath0-equivariance problematic .    for this section , these problems can be solved by considering the union of all shortest paths between @xmath81 and @xmath46 ( of which there are only finitely many , for a given @xmath81 and @xmath46 ) . in future sections , this is a more subtle problem : in fact we should also use the  average \" as well as the union .",
    "similarly , we should take the union ( or average ) of all geodesics from a point @xmath16 to a horoball @xmath81 which realize the distance from @xmath16 to @xmath81 .",
    "in this subsection we apply the construction of section [ s : horoballs ] .",
    "the family @xmath336 satisfies the hypotheses of theorem [ t : ppw ] , therefore there is a function @xmath915 satisfying axioms ( a1)(a7 ) .",
    "suppose that @xmath916 .",
    "we now associate a collection of horoballs @xmath917 to the pair @xmath918 . if @xmath919 then @xmath920 . if @xmath921 and @xmath922 then @xmath923 as defined in notation [ n : horofamilies ] .",
    "similarly , if @xmath924 and @xmath925 then @xmath926 and if @xmath927 then @xmath928 .    for any @xmath916 , the set @xmath917 is a linearly ordered collection of horoballs , and this order is compatible with the order obtained from projection to @xmath929 .",
    "[ d : sigma ] for each @xmath930 , and each pair @xmath931 , we define @xmath932 in the following manner : if @xmath933 , then @xmath934 is the vertical ray from @xmath75 to @xmath911 .",
    "thus suppose that @xmath935 .",
    "then for some @xmath936 we have @xmath937 and @xmath938 . in case @xmath939 , then @xmath934 is the vertical geodesic between @xmath74 and @xmath75 .",
    "otherwise , suppose that @xmath940 satisfies @xmath941 for @xmath942 , where @xmath940 is the distance between @xmath943 and @xmath944 in @xmath202 , with respect to the generating set @xmath945 .",
    "then define @xmath946 and @xmath947 , unless @xmath948 in which case @xmath949 . then define @xmath950 to be the path which consists of vertical paths from @xmath74 and @xmath75 to depth @xmath80 , and then joins the endpoints of these vertical paths with the ( unique ) edge of length @xmath7 at depth @xmath80 .",
    "let @xmath951 be the midpoint of the unique horizontal edge of @xmath950 .",
    "the point @xmath951 cuts @xmath950 into two geodesic segments .",
    "the path @xmath950 is not usually itself a geodesic , but is very close to one .",
    "we insist that the paths @xmath950 do not have a horizontal edge at depth @xmath952 in order to simplify some future arguments .",
    "in particular , this means that our preferred paths are ` transverse ' to @xmath953 .",
    "[ l : sigma ] let @xmath74 and @xmath75 lie in the same horoball @xmath81 .",
    "the path @xmath950 is hausdorff distance at most @xmath347 from @xmath954 .",
    "the geodesic @xmath358 coincides with @xmath950 to depth @xmath43 , where @xmath43 is the maximum depth of @xmath358 .",
    "moreover , the sub - path @xmath955 has length at most @xmath956 , while the ( horizontal ) sub - path @xmath957 has length at most @xmath19 ( see lemma [ l : gamma ] ) .",
    "thus @xmath950 and @xmath358 are hausdorff distance at most @xmath347 from one another .",
    "we now want to use the collections of horoballs @xmath958 to define _ preferred paths _ between any two points in @xmath959 .",
    "let @xmath960 , and let @xmath961 .",
    "note that @xmath962 is a finite linearly ordered set .",
    "[ d : preferredpaths ] _ preferred paths . _",
    "if @xmath962 is empty , then we define @xmath963 if @xmath962 contains a single horoball @xmath81 , then we set @xmath964 where @xmath965 is the terminal point of @xmath966 , and @xmath967 is the terminal point of @xmath968 .",
    "otherwise , we define the preferred path @xmath969 to be @xmath970 where the @xmath971 are paths @xmath972 , where @xmath973 is the terminal point of @xmath974 and otherwise @xmath975 is the terminal point of @xmath976 ; the point @xmath977 is the terminal point of @xmath978 and otherwise @xmath979 is the initial point of @xmath980 .",
    "this describes @xmath969 as a set , but we will often consider it as a map , and parametrize by arc length .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 5723,1639)(1426,-4274 ) ( 3646,-2806)(0,0)[lb ] ( 1441,-2806)(0,0)[lb ] ( 6976,-2806)(0,0)[lb ] ( 4231,-4201)(0,0)[lb ] ( 5356,-4201)(0,0)[lb ] ( 6391,-3706)(0,0)[lb ] ( 1936,-3886)(0,0)[lb ] ( 2971,-3661)(0,0)[lb ]    [ r : tf3 ] we have indicated in remarks [ r : tf1 ] and [ r : tf2 ] how the paths @xmath358 and @xmath903 might be defined using averages in order to ensure antisymmetry and @xmath0-equivariance .    in this framework",
    ", preferred paths will consist of all of the  possible \" preferred paths , superimposed like the states of a quantum system .",
    "these more complicated preferred paths will continue to have many of the properties that honest preferred paths do , though these properties become a deal more cumbersome to state , let alone prove .",
    "we now make a generalization of definition [ d : sp ] .",
    "suppose that the path @xmath981 passes within @xmath982 of the ( distinct ) horoballs @xmath81 and @xmath46 .",
    "define @xmath983 to be that portion of @xmath981 which connects the @xmath984-neighborhoods of @xmath81 and @xmath46 , where the symbol ` @xmath985 ' is used to mean a point or a horoball .",
    "let @xmath986 be the path obtained from @xmath987 by replacing each subsegment of the form @xmath972 by the corresponding geodesic @xmath988 .",
    "[ l : localgeodesic ] if @xmath989 , then either @xmath990 is geodesic for any @xmath991 , or @xmath992 , where @xmath975 and @xmath979 are the first and last points on @xmath993 .",
    "let @xmath994 and let @xmath995 .",
    "this consists of two vertical segments , and a single horizontal segment of length at most @xmath19 .    if @xmath92 intersects @xmath996 nontrivially , then the vertical segments in @xmath92 and the vertical segments in @xmath997 coincide , and the horizontal segments have the same length",
    "therefore , in this case , @xmath998 is a geodesic .",
    "otherwise let @xmath421 and @xmath999 be the deepest points of the vertical subsegments of @xmath92 , with @xmath421 lying directly above @xmath975 and @xmath999 directly above @xmath979 .",
    "then the distance between @xmath421 and @xmath999 is at most @xmath19 , which implies that the distance between @xmath975 and @xmath979 is less than @xmath19 .",
    "we pause briefly to discuss the parametrizations of the paths @xmath358 , @xmath987 and @xmath986 .",
    "these parametrizations are always by arc length .",
    "for each @xmath1000 choose @xmath1001 , @xmath1002 and @xmath1003 as follows : if @xmath1004 then @xmath1005 $ ] , and similarly @xmath1006 $ ] and @xmath1007 $ ] .",
    "if @xmath460 and @xmath1008 , then all of the intervals are @xmath1009 .    if @xmath1010 , then each of the paths @xmath358 , @xmath987 and @xmath986 begin with an infinite vertical ray .",
    "if @xmath75 is contained in the same @xmath547-horoball as @xmath74 then the three paths coincide and we define @xmath1011 $ ] .",
    "suppose then that @xmath1010 and that @xmath75 is not contained in the same @xmath547-horoball as @xmath74 .",
    "let @xmath492 be the first point on @xmath987 contained in @xmath996 .",
    "then the interval @xmath1012 is already defined , and we define @xmath1013 \\cup { \\mathcal{{i}}}_{x',y}$ ] , and suppose that @xmath1014 .",
    "we make similar definitions for @xmath1002 and @xmath1003 .",
    "[ p : async ] for any two points @xmath74 and @xmath75 in @xmath959 , there are nondecreasing functions @xmath1015 and @xmath1016 satisfying :    1 .   for all but finitely",
    "many points @xmath1017 and @xmath1018 , @xmath1019 and @xmath1020 exist and are either @xmath244 or @xmath7 .",
    "[ displace ] for any @xmath1017 , and @xmath1018 we have @xmath1021 @xmath1022 3 .   if @xmath1023 is outside of @xmath1024 for every @xmath1025 , then @xmath1026 .",
    "+ similarly , if @xmath1027 is outside of @xmath1024 for every @xmath1025 , then @xmath1028 .",
    "[ waitjump ] let @xmath1025 and @xmath1029 .",
    "let @xmath1030=\\pp_{x , y}^{-1 } ( \\hat{a})$ ] , and @xmath1031=\\geod(x , y)^{-1}(\\hat{a})$ ] . the total waiting times in @xmath81 , i.e. the maximum of the measures of @xmath1032 is at most @xmath1033 .",
    "moreover , the total jumping times in @xmath81 , i.e. the maximum of the measures of @xmath1034 is at most @xmath1035 .",
    "we suppose for the moment that @xmath1036 $ ] .",
    "we will deal with the other cases at the end of the proof .",
    "in fact , we only deal with the cases that @xmath1036 \\cup \\hbound$ ] .",
    "the other cases are similar , but are not required for later applications .",
    "we use the same symbol for a path and its image throughout . note that a map from the domain of one path to the domain of another induces a map from the image of one path to the image of the second .",
    "conversely , if both paths are embeddings , then a map between their images induces a map between their domains .",
    "recall that the path @xmath987 is defined to be a concatenation of geodesic segments outside of horoballs , and paths of the form @xmath1037 through horoballs .",
    "consider the difference between the paths @xmath1037 and @xmath1038 .",
    "this consists of a path of length at most @xmath1039 in @xmath1037 and a path of length at most @xmath347 in @xmath1038 .",
    "define functions @xmath1040 so that the induced maps on the intersection of the images are the identity , and the induced maps on the differences send a component to its initial point .",
    "the functions @xmath1041 and @xmath1042 have derivatives at all but finitely many points , the derivatives are always @xmath244 or @xmath7 , and the waiting times and jumping distances are at most @xmath1039 per horoball in @xmath1043 .",
    "it is not difficult to see that it suffices now to define appropriate functions @xmath1044    there are three cases , depending on whether @xmath1045 is empty , contains a single horoball , or contains at least two horoballs .    * case 1 : * if @xmath1045 is empty , then @xmath1046 , and we can set both @xmath174 and @xmath129 equal to the identity map .",
    "* case 2 : * suppose @xmath1045 is a single horoball . this case is strictly easier than case 3 , and we leave it as an exercise .    * case 3 : * there is more than one horoball in @xmath1045 . by axiom ( a2 ) , the intersection @xmath1047 is non - empty for each @xmath44 .",
    "let @xmath1048 be the first point on @xmath358 which intersects @xmath1049 , and let @xmath306 be the first point on @xmath1050 which intersects @xmath1049 .",
    "we define @xmath1051 and @xmath1052 to be the identity on @xmath1053 $ ] .",
    "note that the segments @xmath1054 $ ] and @xmath1055 $ ] have the same length and are identified under the map to the comparison tripod @xmath1056 .",
    "thus , for example , the distance between @xmath1057 and @xmath1058 is at most @xmath5 for all @xmath1059 $ ] .",
    "there is clearly no waiting or jumping in this interval .",
    "similarly , let @xmath307 be the last point on @xmath358 intersecting @xmath1060 , and let @xmath99 be the last point on @xmath1050 intersecting @xmath1060 .",
    "we can define the map @xmath1061",
    "\\to \\big [ d(x , y ) - ( w , z)_y , d(x , y ) \\big ]     , \\ ] ] to be the unique ( orientation preserving ) isometry , and @xmath1062 on this interval . once again , the images of these intervals are identified under the map to the comparison tripod @xmath1063 .",
    "we also define @xmath1064 and @xmath1065 .",
    "we now define the maps @xmath1051 and @xmath1052 on the region between adjacent horoballs @xmath1066 and @xmath1067 .",
    "let @xmath1068 .",
    "let @xmath16 be the last point on @xmath1069 , and let @xmath17 be the first point on @xmath1070 .",
    "similarly , let @xmath179 be the last point on @xmath1071 and let @xmath1072 be the first point on @xmath1073 .",
    "suppose that @xmath1074 , and define times @xmath1075 and @xmath1076 analogously . by drawing two comparison tripods ( one for the triangle @xmath1077 and one for @xmath1078 )",
    "we see that @xmath1079 , \\mbox { and } \\ ] ] @xmath1080   , \\ ] ] have the same length ( note that between @xmath1081 and @xmath1082 , both @xmath1050 and @xmath358 are geodesics parametrized by arc length ) .",
    "define @xmath1083 and @xmath1084 to be orientation preserving isometries .",
    "note that the comparison tripods imply that for @xmath1085 , @xmath1086 and for @xmath1087 , @xmath1088    we claim now that those parts of @xmath1002 on which @xmath1051 is not yet defined are segments @xmath1089 so that @xmath1090 , and similarly that those parts of @xmath1003 on which @xmath1052 is not yet defined are segments @xmath1091 so that @xmath1092 . to see this consider , for example , the points @xmath1093 and @xmath1094 , for the points @xmath1095 and @xmath1072 as above .",
    "these are typical endpoints of the intervals on which @xmath1051 and @xmath1052 are not yet defined .",
    "any geodesic between @xmath16 and @xmath179 lies entirely within the convex set @xmath1081 .",
    "therefore , the point @xmath1096 lies within @xmath5 of @xmath1081 , because it is in the preimage of the central point of the comparison tripod @xmath1097 .",
    "now , @xmath1098 lies within @xmath5 of the point on the geodesic @xmath1099 $ ] in the preimage of the central point of @xmath1097 , and in particular , @xmath1100 lies within @xmath501 of @xmath1081 .",
    "similar arguments for all other points prove the claim .",
    "we now define @xmath1051 and @xmath1052 on the remaining subsegments , @xmath1101 and @xmath1102 .",
    "we fix @xmath1103 .",
    "let @xmath87 and @xmath1104 be the images of the endpoints of @xmath1102 under @xmath358 , and let @xmath1105 and @xmath1106 be the images of the endpoints of @xmath1101 under @xmath1050 .",
    "the path @xmath1107 is a concatenation of three geodesics , one traveling towards @xmath1108 as quickly as possible , one through @xmath1108 and one traveling away from @xmath1108 as quickly as possible .",
    "let @xmath1109 be the first point on @xmath1110 and let @xmath1111 be the last point on @xmath1112 .",
    "( see figure [ f : waitjump1 ] . )",
    "it is clear from the previous arguments that @xmath1113 .",
    "also , @xmath1105 is within @xmath1114 of @xmath1108 .",
    "however , between @xmath1105 and @xmath1109 , the path @xmath1050 is traveling as quickly as possible towards @xmath1108 , so @xmath1115 .",
    "similarly , @xmath1116 .",
    "suppose that @xmath1117 and @xmath1118 .    for @xmath1119 $ ] ,",
    "define @xmath1120 , and for @xmath1121 $ ] define @xmath1122 .",
    "drawing comparison tripods as in figure [ f : waitjump2 ] allows us to see that @xmath1123 , \\mbox { and } \\ ] ] @xmath1124\\ ] ] have the same length .",
    "assume first that @xmath1125 and @xmath1126 are nonempty , and define @xmath1127 and @xmath1128 to be orientation preserving isometries .",
    "( 0,0 ) and @xmath1050 near @xmath1129.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4233,2404)(1858,-5444 ) ( 3466,-4651)(0,0)[lb ] ( 3466,-5371)(0,0)[lb ] ( 6031,-3751)(0,0)[lb ] ( 6076,-3301)(0,0)[lb ] ( 2161,-3256)(0,0)[lb ] ( 5311,-3211)(0,0)[lb ] ( 2611,-4246)(0,0)[lb ] ( 1936,-4021)(0,0)[lb ] ( 4726,-4246)(0,0)[lb ] ( 5491,-4111)(0,0)[lb ]    ( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 3585,1279)(1921,-4319 ) ( 2161,-3256)(0,0)[lb ] ( 5311,-3211)(0,0)[lb ] ( 5491,-4111)(0,0)[lb ] ( 4726,-4246)(0,0)[lb ] ( 2611,-4246)(0,0)[lb ] ( 1936,-4021)(0,0)[lb ]    it remains to define @xmath1051 on the intervals @xmath1130 $ ] and @xmath1131 $ ] , and @xmath1052 on the intervals @xmath1132 $ ] and @xmath1133 $ ] .",
    "since @xmath1134 and @xmath1115 , we have @xmath1135 .",
    "this implies that the lengths of @xmath1136 and @xmath1137 are at most @xmath1138 .",
    "the same is true of the lengths of @xmath1139 and @xmath1140 .    if @xmath1141 then define @xmath1142 . if @xmath1143 then define @xmath1144 . if @xmath1145 then define @xmath1146 .",
    "if @xmath1147 then define @xmath1148 .    if @xmath1125 and @xmath1126 are empty , we must define @xmath1051 and @xmath1052 slightly differently : @xmath1149 ) & = s_1\\\\ f_2(\\big[t_2+(y_1,y_3)_{x_3},t_4\\big ] ) & = s_2\\\\   g_2(\\big[s_1,s_1+(y_1,x_3)_{x_1}\\big ] ) & = t_2\\\\ g_2(\\big[s_1+(y_1,x_3)_{x_1},s_2\\big ] ) & = t_3 \\end{split}\\ ] ] in this case , the intersections of @xmath221 and @xmath1050 with @xmath1081 are quite small .",
    "we have now defined @xmath1051 and @xmath1052 in the case that @xmath1150 $ ] .",
    "it is not difficult to see that the functions @xmath1151 and @xmath1152 satisfy the requirements of the proposition .",
    "in fact ( and this is used below ) , we have shown that they satisfy the requirements of the proposition with the constants reduced by @xmath1153 .",
    "finally , we now turn to the case that one or both of @xmath1154 lie in @xmath895 .",
    "suppose @xmath1010 and @xmath1155 $ ] . as in the discussion above the proposition ,",
    "let @xmath492 be the first point on @xmath987 so that @xmath1156 .",
    "let @xmath1157 be the first point on @xmath1158 so that @xmath1159",
    ". then @xmath1160 \\cup { \\mathcal{{i}}}_{x',y}$ ] and @xmath1161 \\cup { \\mathcal{{j}}}_{x'',y}$ ] . note also that @xmath1162 , by the definition of preferred paths .",
    "we define @xmath1163 to be the identity on @xmath1164 $ ] . if we can prove that @xmath1165 , then there are obvious maps @xmath1166 and @xmath1167 which identify the long side of the comparison tripod @xmath1168 , and collapse the short sides to the center of the tripod .",
    "if we have such functions @xmath28 and @xmath1169 , then we define @xmath1170 and @xmath1171 these will satisfy the requirements of the proposition so long as @xmath1165 .    to see this , we argue as follows : let @xmath173 be that part of @xmath987 from @xmath74 until the second horoball in @xmath1043 ( or to be all of @xmath987 if @xmath1043 is a singleton ) .",
    "it is not difficult to see that @xmath173 must be a geodesic , because that part after @xmath492 travels away from the horoball as quickly as possible ( by the definition of preferred paths ) .",
    "let @xmath99 be the endpoint of @xmath173 which is not @xmath492 . by axiom ( a2 ) of section [ s : horoballs ] , and lemma [ l : tube ]",
    ", there is a point @xmath1172 which lies within @xmath51 of the horoball , @xmath81 , which contain @xmath99 .",
    "the geodesic between @xmath99 and @xmath1173 lies entirely within the convex set @xmath1174 . the ( partially ideal ) triangle with vertices @xmath1175 is @xmath121-slim , which proves that @xmath1165 ( because both @xmath987 and @xmath358 are vertical on the interval @xmath1176 .    we now suppose that @xmath1177 . then there are points @xmath1178 and @xmath1179 so that @xmath1180 \\cup { \\mathcal{{i}}}_{x',y ' } \\cup [ |\\pp_{x',y'}|,\\infty),\\ ] ] and @xmath1181 \\cup { \\mathcal{{j}}}_{x'',y '' } \\cup [ d(x'',y''),\\infty ) .\\ ] ] as before , @xmath1182",
    ". thus there are obvious functions @xmath1183 and @xmath1184 and we make the following definitions : @xmath1185 and @xmath1186    we now state a couple of corollaries of proposition [ p : async ]    [ c : ppneargeodesic ] for any @xmath16 , @xmath1187 , the hausdorff distance between @xmath1188 and @xmath929 is at most @xmath1189 .",
    "the hausdorff distance between @xmath1190 $ ] and @xmath1191 $ ] is at most @xmath1192 .",
    "the first assertion is obvious from proposition [ p : async ] .. suppose that @xmath1193 $ ] . since the function @xmath174 from proposition [ p : async ] is monotone , there is some @xmath1194 $ ] so that @xmath1195 . by proposition [ p : async ] .",
    ", @xmath1196 .",
    "conversely , suppose that @xmath1194 $ ] .",
    "it follows from monotonicity and proposition [ p : async ] . that there is a point @xmath1197 $ ] with @xmath1198 .",
    "it follows that @xmath1199 is no further than @xmath1200 from @xmath1190 $ ] .",
    "[ c : quasigeodesic ] the path @xmath987 is a @xmath1201-quasi - geodesic , for @xmath1202 @xmath1203    let @xmath1204 and @xmath1205 be points in @xmath1206 $ ] , and let @xmath1207 and @xmath1208 . since @xmath987 is parametrized by arc length , @xmath1209 is automatic .",
    "let @xmath1210 , for @xmath1211 and @xmath174 as described in proposition [ p : async ]",
    ". then @xmath1212 .",
    "the arc length @xmath1213 is at most @xmath1214 plus the amount of time in @xmath1030 $ ] that @xmath1215 .",
    "the number of horoballs in @xmath1045 that @xmath987 passes within @xmath1216 of between time @xmath1204 and @xmath1205 is at most @xmath1217 ; the amount of time @xmath1215 when @xmath1218 is near a horoball is at most @xmath1219 , by part ( 4 ) of proposition [ p : async ] .",
    "thus @xmath1220 which implies @xmath1221 and so @xmath1222    we now make some some other useful observations about preferred paths .",
    "preferred paths are @xmath0-equivariant .",
    "it follows from corollary [ c : quasigeodesic ] that sub - paths of preferred paths are quasi - geodesic , and hence form @xmath1223-slim triangles for _ some _ @xmath1223 . however , the @xmath1223 coming from @xmath1201-quasi - geodesicity is _ much _ worse than the @xmath105 below , and our previous choice of @xmath547 secretly takes into account the particular bound given in the next proposition .    [",
    "p : deltaprime ] there exists a constant @xmath1224 so that any triangle or bigon whose sides are sub - paths of preferred paths is @xmath105-slim .",
    "this includes triangles any or all of whose vertices are in @xmath895 .",
    "let @xmath202 , @xmath150 , and @xmath80 be three points in @xmath1225 , joined by parts of preferred paths @xmath1226 , @xmath1227 and @xmath1228 . specifically ,",
    "suppose that @xmath1229 $ ] joins @xmath202 to @xmath150 , @xmath1230 $ ] joins @xmath150 to @xmath80 , and @xmath1231 $ ] passes from @xmath80 to @xmath202 , where @xmath1232 for @xmath55 odd and @xmath1233 $ ] for @xmath55 even .    by corollary",
    "[ c : ppneargeodesic ] , the side @xmath1229 $ ] is hausdorff distance at most @xmath1192 from the geodesic segment @xmath1191 $ ] , where @xmath1234 is the function from proposition [ p : async ] .",
    "furthermore , the endpoints @xmath1235 and @xmath1236 of this segment are ( if not ideal ) at most @xmath1189 from @xmath202 and @xmath150 respectively , by proposition [ p : async ] .. similar statements can be made about the other two sides .",
    "if none of the endpoints of the geodesic segments are ideal , they may be joined together by segments of length at most @xmath1237 , to form a geodesic hexagon , which must be @xmath502-slim .",
    "otherwise , they may be partially joined up to form a pentagon with one ideal vertex , a quadrilateral with two ideal vertices , or simply an ideal triangle .",
    "call the ( possibly partially ideal ) polygon so obtained @xmath389 . subdividing and using lemma [ l : idealthin ] ,",
    "it is easy to see that @xmath389 is @xmath1153-slim .",
    "suppose that @xmath1238 $ ] .",
    "there is some point @xmath492 on @xmath1191 $ ] at most @xmath1192 away from @xmath74 .",
    "( see figure [ f : deltaprime ] . )",
    "( 0,0 ) to lie on one of the dashed segments , in which case it is even closer to the other two sides.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 2474,1981)(564,-3235 ) ( 1711,-2491)(0,0)[lb ] ( 1711,-3166)(0,0)[lb ] ( 991,-1861)(0,0)[lb ] ( 1441,-2266)(0,0)[lb ]    since @xmath389 is @xmath1153-slim , there is some point @xmath1173 on another side of @xmath389 so that @xmath1239 .",
    "if @xmath1173 is on @xmath1240 $ ] or @xmath1241 $ ] , then there is a point @xmath99 on @xmath1230 $ ] or @xmath1231 $ ] with @xmath1242 . otherwise , @xmath1173 is at most @xmath1243 from one of the vertices of our original triangle . in",
    "either case @xmath74 is within @xmath1244 of one of the other two sides of the triangle .",
    "[ tr : bonus ] any of the ` possible ' preferred paths referred to in remark [ r : tf3 ] will satisfy all of the above properties , and an identical proof suffices to establish this .",
    "[ d : preftri ] let @xmath1245 be a @xmath160-simplex .",
    "preferred triangle _ is a continuous map @xmath1246 so that if @xmath192 is one of the three sides of @xmath1245 , then @xmath1247 is an embedding , whose image is a preferred path .",
    "if @xmath1248 is a preferred triangle , then @xmath1249 is injective .    for ease of exposition",
    ", we will always assume that if @xmath1250 is a preferred triangle , then @xmath1169 does not send the vertices of @xmath1245 to @xmath953 . in our applications , this will always be the case .",
    "the following definitions can be extended to the case that vertices are sent by @xmath1169 to @xmath953 , but at the expense of making the statements a bit more cumbersome .",
    "for the rest of this section , we fix a preferred triangle @xmath1246 so that @xmath1251 for @xmath1252 .",
    "we refer to the elements of @xmath1253 as _",
    "we next define a _ skeletal filling _ of a preferred triangle .",
    "this filling will take the form of a @xmath7-complex ( with @xmath19 different kinds of edges ) inscribed on the @xmath160-simplex @xmath1245 .",
    "the points in @xmath1254 will be referred to as _",
    "@xmath952-vertices_.    we now describe the different types of preimages of @xmath952-horoballs which can occur in a preferred triangle .",
    "[ d : nibblesetc ] suppose that @xmath1255 is such that @xmath1256 .",
    "recall that the unique point in @xmath113 which is a limit of points in @xmath202 is called @xmath894 .    1 .",
    "if @xmath1257 contains a single corner of @xmath1258 , then we say that @xmath1257 is a _ _ .",
    "if @xmath1257 intersects exactly one side of the triangle @xmath1259 , then @xmath1257 is a _ nibble_. 3 .",
    "if @xmath1257 intersects exactly two sides of the triangle @xmath1259 and is not a , then @xmath1257 is a _ _ .",
    "4 .   if @xmath1257 intersects all three sides of the triangle @xmath1259 , then it is a _ _ .",
    "see figure [ f : bitenibbledipplunge ] .",
    "( 0,0)-horoball are shown in bold . for any letter @xmath74 , the vertices @xmath74 and @xmath492 form a _ pair _ ( definition [ d : pairs]).,title=\"fig : \" ]",
    "# 1#2#3#4#5 @font    ( 4489,1288)(384,-899 ) ( 676,-466)(0,0)[lb ] ( 541,119)(0,0)[lb ] ( 1981,-466)(0,0)[lb ] ( 586,-826)(0,0)[lb ] ( 1711,-826)(0,0)[lb ] ( 3061,-826)(0,0)[lb ] ( 4096,-826)(0,0)[lb ] ( 2881,254)(0,0)[lb ] ( 2656,-16)(0,0)[lb ] ( 4051,254)(0,0)[lb ] ( 4726,-16)(0,0)[lb ] ( 3151,-466)(0,0)[lb ] ( 4546,-466)(0,0)[lb ] ( 3781,-16)(0,0)[lb ] ( 2836,-466)(0,0)[lb ] ( 1756,-466)(0,0)[lb ] ( 4501,254)(0,0)[lb ] ( 4051,-466)(0,0)[lb ]    any @xmath952-vertex is in the boundary of a unique , , , or .",
    "[ l : pairs ] there is a partition of the @xmath952-vertices into sets , @xmath1260 , of cardinality @xmath160 , so that if @xmath1261 , then @xmath1262 .",
    "suppose that @xmath74 is an @xmath952-vertex .",
    "then @xmath74 is in the boundary of a unique , , , or .",
    "we consider each of there in turn , in order to define the set @xmath1263 of which @xmath74 is a member .",
    "let @xmath1264 be the @xmath952-horoball containing @xmath1265 .",
    "we delay the proof that if @xmath1266 then @xmath1267 until later in the proof .",
    "suppose that @xmath74 is contained in the boundary of a .",
    "then there is a unique @xmath952-vertex @xmath1268 in @xmath1258 so that @xmath1269 .",
    "define @xmath1266 in this case .",
    "suppose that @xmath74 is contained in the boundary of a .",
    "then the set of @xmath952-vertices on the boundary of this  has cardinality @xmath69 .",
    "we partition this into two sets by pairing the @xmath952-vertices on different sides which are closest to the common vertex of @xmath1259 .",
    "suppose that @xmath74 is contained in a .",
    "then the boundary of the  has cardinality @xmath160 , and we define the set containing @xmath74 to be this boundary .",
    "finally , suppose that @xmath74 is contained in a .",
    "the boundary of the plunge has cardinality at most @xmath37 ; we partition the boundary into sets of size @xmath160 by pairing @xmath952-vertices which are closest to a given vertex of @xmath1259 .",
    "the procedure described above ( and also in figure [ f : bitenibbledipplunge ] ) defines a partition of the @xmath952-vertices into sets @xmath1270 of cardinality @xmath160 .",
    "it remains to investigate the distance between @xmath1271 and @xmath1272 where @xmath1273 .",
    "we consider first the case that @xmath1266 , and that @xmath74 and @xmath75 lie in different sides of @xmath1259 .",
    "this covers the cases when @xmath74 and @xmath75 are contained in the boundary of a , a , or a .",
    "now , @xmath1274 , say . suppose that @xmath1275 ( we can arrange both of these by relabeling @xmath1276 and @xmath179 if necessary ) . preferred paths are chosen to be vertical from depth @xmath547 to at least @xmath1277 ( see definition [ d : sigma ] ) .",
    "in fact , because preferred paths travel as quickly as possible towards @xmath547-horoballs , they must be vertical from depth @xmath501 to at least @xmath1277 .",
    "let @xmath1278 be the point on @xmath1188 which is at depth @xmath547 and lies closest to @xmath1271 , and let @xmath1279 be defined similarly in relation to @xmath1272 .",
    "preferred paths are @xmath1280-slim by proposition [ p : deltaprime ] .",
    "thus , there is a point @xmath1281 which is within @xmath1280 of @xmath1278 .",
    "suppose first that @xmath1282 .",
    "then because preferred paths are vertical between depths @xmath501 and @xmath1277 , it is not difficult to see that @xmath1283 . because of the geometry of combinatorial horoballs , distance between points on vertical paths strictly decreases with increasing depth .",
    "thus , by depth @xmath1284 in @xmath202 , the paths @xmath1188 and @xmath1285 must be within @xmath7 of each other .",
    "it is now easy to see that @xmath1286 .",
    "suppose then that @xmath1287 .",
    "then , arguing as above , there is a point @xmath1288 so that @xmath1289 .    similarly , there is a point @xmath1290 within @xmath1280 of @xmath1279 . if @xmath1291 then we see that @xmath1267 , just as above . therefore , suppose that @xmath1292 , in which case we have some @xmath1293 so that @xmath1294 .",
    "note that the part of @xmath1295 between @xmath1296 and @xmath1297 is @xmath1298 .",
    "we consider the maximum depth @xmath1298 .",
    "first note that because of the choice of @xmath74 and @xmath75 , it is must be that @xmath1299",
    ". therefore , the maximum depth of @xmath1298 is less than @xmath952 . if this depth is at most @xmath1300 , then at depth @xmath1300 the preferred paths @xmath1188 and @xmath1285 are at most @xmath19 apart , which implies that at depth @xmath952 they are at most @xmath7 apart , as required .",
    "therefore , we are left with the case that the maximum depth of @xmath1298 is exactly @xmath1301 . in this case , at depth @xmath1302 , the preferred paths @xmath1188 and @xmath1295 are distance at most @xmath7 apart , as are the preferred paths @xmath1285 and @xmath1295 . because @xmath1298 has maximum depth @xmath1303 , at depth @xmath1302 the two vertices in @xmath1295 are distance at most @xmath160 apart .",
    "this implies that the distance ( at depth @xmath1302 ) between the vertices in @xmath1188 and @xmath1285 at depth @xmath1302 is at most @xmath69 .",
    "this implies that @xmath1267 .",
    "we are now left with the case that @xmath74 and @xmath75 are contained in the same side of @xmath1258 , so in the boundary of a .",
    "suppose that @xmath1304 .",
    "define the points @xmath1305 .",
    "there are points @xmath1306 so that @xmath1307 .",
    "here there are two cases to consider , depending on whether @xmath1296 and @xmath1297 are contained in the same preferred path , or not . in any case , the preferred paths @xmath1285 and @xmath1295 do not intersect @xmath1264 ( because we are considering a ) . however , by proposition [ p : deltaprime ] , one of @xmath1285 or @xmath1295 must intersect @xmath1308 nontrivially .",
    "there are a number of cases to consider , depending on the maximum depth in @xmath202 of @xmath1285 and @xmath1295 .",
    "we consider the most complicated , and leave the remainder as exercises for the reader .",
    "suppose that @xmath1309 , @xmath1310 and that both @xmath1285 and @xmath1295 intersect @xmath1311 nontrivially .",
    "consider the points in @xmath1312 .",
    "there are two of these points , @xmath1296 , and @xmath1313 , say .",
    "similarly , let @xmath1314 .",
    "it is not difficult to see ( using @xmath1280-slim triangles and the properties of the paths @xmath1315 ) that @xmath1316 .",
    "therefore , at depth @xmath1317 , we have points @xmath1318 , @xmath1319 and @xmath1320 so that a primed point is directly beneath its unprimed counterpart .",
    "now , @xmath1321 . also , the @xmath1322-distance between @xmath1323 and @xmath1324 is at most @xmath69 ( because the maximum depth of @xmath1285 in @xmath202 is @xmath1325 ) .",
    "similarly , the @xmath1317 distance between @xmath1326 and @xmath1327 is at most @xmath69 .",
    "this shows that the @xmath1317 distance between @xmath1328 and @xmath1329 is at most @xmath956 .",
    "this implies ( because @xmath1330 ) that @xmath1267 , as required .",
    "this completes the proof of lemma [ l : pairs ] .",
    "[ d : pairs ] an element of the partition in lemma [ l : pairs ] will be called a _",
    "pair_.    [ d : skel ] we define a @xmath7-complex @xmath1331 which we call the _ skeletal filling _ of @xmath1169 .",
    "the vertex set of @xmath1331 is equal to @xmath1332 .",
    "there are three kinds of edges :    1 .",
    "the first kind come from the subdivision of @xmath1259 by the vertex set .",
    "if @xmath1333 are a pair of @xmath952-vertices , in the sense of definition [ d : pairs ] , and @xmath1334 , then we connect @xmath74 and @xmath75 by an edge which we call a _ ligament_. 3 .   if @xmath1333 are a pair of @xmath952-vertices so that @xmath1335 , then we connect @xmath74 and @xmath75 by an edge which we call a _",
    "rib_.    [ l : inscribe ] the identity map on @xmath1259 extends to an embedding of @xmath1331 into @xmath1245 .",
    "[ r : extend ] by lemma [ l : pairs ] , the map @xmath1169 also extends to a map @xmath1336 which sends each ligament to a point and each rib to a single horizontal edge .",
    "suppose there are ( possibly degenerate ) subintervals @xmath1337 and @xmath1338 of sides of @xmath1259 so that @xmath1339 , and suppose that these are chosen to be maximal such intervals with endpoints in the vertex set of @xmath1331 .",
    "then the minimal subcomplex of @xmath1331 containing all edges with both endpoints in @xmath1340 is called a _",
    "leg_. a leg contains one or two _ distinguished _ ligaments , joining the endpoints of @xmath1337 to the endpoints of @xmath1338 .",
    "we note that @xmath1169 collapses each leg to a subsegment of a preferred path .",
    "[ l : threelegs ] each leg of @xmath1331 contains exactly on corner of @xmath1245 .",
    "in particular , @xmath1331 has at most @xmath19 legs .",
    "consider a corner @xmath306 of @xmath1258 , and the two sides @xmath1341 and @xmath1342 containing @xmath306 .",
    "let @xmath1343 and @xmath1344 be the endpoints of the ligament joining @xmath1341 and @xmath1342 which is furthest from @xmath306 .",
    "let @xmath1345 and @xmath1346 , so @xmath1347 .",
    "suppose that @xmath1348",
    ". then @xmath1349 . by axiom ( a6 ) and the definition of preferred paths",
    "those parts of @xmath1188 and @xmath1285 between @xmath16 and @xmath1350 are identical .",
    "this implies that the segments between @xmath306 and @xmath87 and @xmath306 and @xmath1105 , and the ligaments joining them , form a leg .",
    "if there is no ligament joining the edges @xmath1341 and @xmath1342 then there is no leg intersecting both of these sides .",
    "let @xmath159 be a graph and let @xmath192 be an edge of @xmath159 which separates @xmath159 into two components .",
    "we say @xmath1351 and @xmath1352 are obtained from @xmath159 by _ surgery along @xmath192 _ if there are edges @xmath1341 in @xmath1351 and @xmath1342 in @xmath1352 which can be identified to give a graph isomorphic to @xmath159 .",
    "successive surgery along the distinguished ligaments of @xmath1331 yields a collection of at most @xmath69 graphs , at most three of which come from legs , and exactly one of which contains pieces of all three edges of @xmath1259 .",
    "we call the graph which contains pieces of all three edges of @xmath1258 the _ middle _ of @xmath1331",
    ". does away with the need for feet . ]",
    "( see figure [ f : triskelion ] . )",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 2030,2119)(1267,-3913 )    [ l : intwohsys ] let @xmath1353 be a preferred triangle , with edges @xmath1354 , and suppose that @xmath1345 , @xmath1355 and @xmath1356 .",
    "suppose further that @xmath202 is a horoball which is such that @xmath1357 .",
    "then @xmath1358 and either @xmath1359 or @xmath1360 .    follows from the fact that the image @xmath1361 is a quasi - geodesic triangle which is @xmath1362-slim and that @xmath1363 .",
    "[ d : assoc ] suppose that @xmath1364 is a preferred triangle , with corners @xmath1365 so that @xmath1366 and @xmath1367 .",
    "let @xmath1341 be the edge of @xmath1258 joining @xmath468 to @xmath469 .",
    "if @xmath1368 and @xmath1349 then we say that @xmath202 is _ associated to @xmath468_. we define horoballs associated to @xmath469 and @xmath1369 analogously .",
    "if @xmath202 is a horoball so that @xmath1370 is nonempty and contained in a leg , @xmath1371 , then we say that @xmath202 is _ associated to @xmath1371_.    by lemma [ l : intwohsys ] , if @xmath1372 , then @xmath202 is contained in two of @xmath1373 and @xmath1374 .",
    "therefore , for any horoball @xmath202 , if @xmath1370 is nonempty then @xmath202 is associated to some corner of @xmath1245 .",
    "it could be that a horoball @xmath202 as in definition [ d : assoc ] is contained in all three of @xmath1373 and @xmath1374 , in which case @xmath202 is associated to all three corners of @xmath1259 .",
    "however    [ l : oneplunge ] there is at most one horoball associated to all three corners of @xmath1258 .",
    "[ p : sixhoroballs ] let @xmath1364 be a preferred triangle and let @xmath306 be a vertex of @xmath1258 .",
    "there is at most one horoball which is associated to @xmath306 and is not also associated to a leg in @xmath1331 .",
    "suppose that the horoballs @xmath81 and @xmath46 are associated to @xmath306 .",
    "let @xmath1095 be the images of the vertices of @xmath1258 , with @xmath1375 . then @xmath1376 and suppose that @xmath1377 in the order coming from @xmath1378.we will prove that @xmath81 is associated to a leg in @xmath1258 .",
    "the preferred paths @xmath1188 and @xmath1285 coincide at least until they reach the horoball @xmath46 and in particular , the intersections of these paths with @xmath81 is identical . since one of @xmath1379 and @xmath1380",
    "is nonempty ( since @xmath81 is associated to @xmath306 ) , both of these sets are non - empty .",
    "it is not difficult to see that @xmath1381 is contained in a leg .",
    "[ c : ribsbound ] let @xmath1364 be a preferred triangle .",
    "the total number of ribs and ligaments in the feet and middle of @xmath1331 is at most @xmath37 . in particular ,",
    "the number of ribs in @xmath1331 is at most @xmath37 .",
    "each @xmath952-vertex in @xmath1331 maps to a horoball associated to some corner of @xmath1258 .",
    "if @xmath1048 is an @xmath952-vertex in a foot or middle of @xmath1331 and @xmath202 is the horoball containing @xmath1382 then @xmath202 is not associated to a leg .    for each horoball , @xmath81 , the set of @xmath952-vertices in @xmath1331 which map to @xmath1383 has cardinality at most @xmath37 , and at most @xmath69 unless @xmath1384 is a plunge .",
    "thus there are @xmath19 ribs or ligaments for a plunge , and at most @xmath160 for other horoballs .",
    "lemma [ l : oneplunge ] implies that there is at most one plunge and proposition [ p : sixhoroballs ] implies that there are at most @xmath19 horoballs not associated to legs .",
    "the result now follows easily .",
    "[ c : skelbound ] let @xmath1364 be a preferred triangle and let @xmath20 be the union of the feet and middles of @xmath1331 .",
    "then @xmath1385    there are @xmath19 vertices for the corners of @xmath1259 .",
    "also , there are at most @xmath37 ribs or ligaments in the feet and middle of @xmath1331 , and each of these contributes two vertices .",
    "we now proceed to decompose preferred triangles .",
    "a key feature of preferred triangles is proposition [ p : geodsinthick ] below .",
    "[ sub - pictures ] suppose that @xmath1353 is a preferred triangle .",
    "successive surgery along all of the ribs and ligaments of @xmath1331 yields a collection of graphs .",
    "we call these graphs _ sub - pictures_.    the following result follows immediately from the fact that the depth function @xmath326 is continuous .",
    "suppose that @xmath1386 is a sub - picture of @xmath1331 .",
    "then either @xmath1387)$ ] or @xmath1388 .",
    "[ d : thick ] [ thick - thin decomposition of preferred triangles ] suppose that @xmath1389 is a preferred triangle , and that @xmath1386 is a sub - picture of @xmath1331 .    if @xmath1387)$ ] then we call @xmath1386 a _ thick sub - picture_. if @xmath1390 then we call @xmath1386 a _ thin sub - picture_.    [ p : geodsinthick ] if @xmath1364 is a preferred triangle , and @xmath1048 and @xmath306 are vertices in the same thick sub - picture of @xmath1331 then any geodesic @xmath1391 joining @xmath1382 to @xmath1392 does not penetrate any @xmath1393-horoball .",
    "let @xmath1386 be a thick sub - picture of @xmath1331 .",
    "then @xmath1387)$ ] .",
    "furthermore , the image of @xmath1386 under @xmath1169 consists of subsegments of preferred paths @xmath1394 and @xmath1295 , say , together with single edges from @xmath953 , corresponding to the images of ribs in @xmath1386 .",
    "if @xmath1188 and @xmath1188 both intersect @xmath1395 nontrivially , then they either intersect in @xmath1395 ( in case their preimages are joined by a ligament ) or else are joined by an edge of length @xmath7 in @xmath953 ( in case their preimages are joined by a rib ) .",
    "thus , any point in @xmath1395 lies within distance at most @xmath1396 from @xmath1397 .",
    "suppose @xmath1398 .",
    "let @xmath1399 be the point in @xmath1400 closest to @xmath16 , and let @xmath1401 be the point closest to @xmath17 .",
    "define points @xmath1402 and @xmath1403 analogously .",
    "not all of these points need be defined , if the intersection of some preferred path with @xmath1395 is empty .",
    "also , it is certainly possible for some of these points to be the same , if they lie in the image of a ligament , or if they are the image of a corner of @xmath1258 .",
    "suppose that @xmath1404 .",
    "let @xmath1405 , where @xmath174 is the function from proposition [ p : async ] .",
    "use the function @xmath174 to define points @xmath1406 , @xmath1407 , etc .",
    "note that @xmath1408 , and similarly for the other points and their hatted counterparts .",
    "the points @xmath1409 are partitioned into some of the pairs defined earlier in this section , and in particular each pair consists of one or two points which are distance at most @xmath7 apart .",
    "thus , the geodesics between the points @xmath1410 , consisting of the subsegments of @xmath1411 , and paths joining the points whose un - hatted counterparts correspond to a ` pair ' .    therefore , depending on whether there are two or three preferred paths which intersect @xmath1386 nontrivially , the points @xmath1412 , @xmath1406 , etc .",
    "form either a hexagon or a quadrilateral .",
    "if it is a hexagon , then three of the sides have length at most @xmath1413 , and if it is a quadrilateral two of the sides of length at most @xmath1414 .",
    "call the sides @xmath1415 $ ] etc . , the ` long ' sides of this polygon .",
    "any point on a long side of this polygon is distance at most @xmath1416 from one of the other long sides .",
    "now consider any vertices @xmath1417 .",
    "as already noted , there are points @xmath1418 so that @xmath1419 and @xmath1420 are contained in preferred paths and @xmath1421 .    by proposition [ p : deltaprime ]",
    "there are points @xmath1422 on different preferred paths to @xmath1419 and @xmath1420 , respectively so that @xmath1423 .",
    "since there are only three preferred paths , at least two of @xmath1424 must lie on the same preferred path .",
    "since @xmath1419 and @xmath1425 lie on different preferred paths , as do @xmath1420 and @xmath468 , one of the two points lies within @xmath105 of @xmath1419 and one within @xmath105 of @xmath1420 .",
    "let this pair of points on the same preferred path be @xmath1426 and @xmath1427 , so that @xmath1428 .",
    "that part of the preferred path which lies between @xmath1426 and @xmath1427 lies in a thick sub - picture , and so does not penetrate any @xmath1429-horoball .",
    "let @xmath25 be this part of the preferred path .    by proposition [ p : async ]",
    ", there are points @xmath1430 on a long side of the polygon described above , so that @xmath1431 .",
    "the geodesic between @xmath1432 and @xmath1433 ( which lies on a long side of the polygon ) lies at hausdorff distance at most @xmath1192 from @xmath25 , and therefore does not penetrate any @xmath1434-horoball .",
    "now , consider the geodesic quadrilateral formed by @xmath1435 .",
    "we have @xmath1436 and , similarly , @xmath1437",
    ".    therefore , any point on the geodesic between @xmath1048 and @xmath306 lies at most @xmath1438 of some point on the geodesic between @xmath1432 and @xmath1433 .",
    "this implies that the geodesic between @xmath1048 and @xmath306 does not penetrate any @xmath1439-horoball . since @xmath1440",
    ", the proof is finished .",
    "[ r : tf4 ] in the context of the  quantum \" preferred paths , when @xmath0 is not torsion - free , not all choices of triples of preferred paths will have the controlled properties of preferred triangles in this section . in applications ,",
    "it is possible to make consistent choices .",
    "we will say more about this in part 2 .",
    "in this section we describe how the results from previous sections in this paper may be combined with results of mineyev from @xcite to construct a quasi - geodesic homological bicombing of @xmath959 ( in the sense of definitions [ d : homologicalextension ] and [ d : quasigeodesic ] ) .      in this subsection",
    ", we briefly recall a construction of mineyev from @xcite .",
    "we need a slightly more general statement than appears in @xcite , and we explain how mineyev s proof implies theorem [ t : mineyev ] below .",
    "suppose that @xmath159 is a locally finite graph which is @xmath5-hyperbolic for some integer @xmath1441 .    in his construction",
    ", mineyev further assumes that @xmath159 has bounded valence .",
    "this is important for the area bounds , but not for making the definitions .",
    "suppose that the group @xmath0 acts freely on @xmath159 .",
    "let @xmath456 be a @xmath0-equivariant geodesic bicombing on @xmath159 ( see definition [ d : geodesicbicombing ] ) .",
    "let @xmath202 be the homological bicombing induced by @xmath456 ( see remark [ r : geodtohom ] ) .    for each vertex @xmath16 in @xmath159",
    ", define @xmath1442 as follows :    * @xmath1443 ; and * if @xmath1444 then @xmath1445 , where @xmath68 is the largest ( integral ) multiple of @xmath473 which is strictly less than @xmath1446 .    for vertices",
    "@xmath1276 in @xmath159 , the _ flower at @xmath17 with respect to @xmath16 _ is the set @xmath1447    now , for each pair of vertices @xmath1448 define a @xmath244-chain @xmath1449 in @xmath159 inductively on the distance @xmath1446 as follows :    * if @xmath1450 then @xmath1451 ; * if @xmath1452 and @xmath1446 is not an integral multiple of @xmath473 then @xmath1453 ; and * if @xmath1452 and @xmath1446 is an integral multiple of @xmath473 then @xmath1454    for each vertex @xmath1455 , define a @xmath244-chain , @xmath1456 by @xmath1457 by linearity , @xmath1456 is defined for any @xmath244-chain @xmath16 .",
    "now define , for @xmath1458 , @xmath1459    we now define a homological bicombing @xmath1460 on @xmath159 .",
    "first note that , by linearity , @xmath1461 makes sense when @xmath16 is any @xmath244-chain .",
    "the @xmath7-chain @xmath1462 is defined inductively on @xmath1446 , as follows : if @xmath1450 then @xmath1463 .",
    "suppose now that @xmath1452 . by ( * ? ? ?",
    "* proposition 7(2 ) ) @xmath1464 note that mineyev s proof of this does not use the bounded valence assumption .",
    "therefore , for each @xmath1465 we have @xmath1466 , so @xmath1467 is defined by induction .",
    "define @xmath1468 by linearity over the second variable and define @xmath1469 finally , we define @xmath1470 so that @xmath150 is anti - symmetric .",
    "mineyev proves that when @xmath159 has bounded valence , the bicombing @xmath150 has _ bounded area _ , in the sense of theorem [ t : mineyev ] below .",
    "when @xmath159 does not have bounded valence , these area bounds break down completely .",
    "however , we are only going to use the bicombing from @xcite on a subset of @xmath11 of uniformly bounded depth , and on such a subspace the valence _ is _ uniformly bounded , and mineyev s techniques apply .",
    "the proof of the area bound for a given triangle occurs entirely in the @xmath1471-neighborhood of the union of the three geodesic sides .",
    "moreover , if we have a bound on the valence in some part of a graph , then we can calculate a bound on the number of vertices in any given ball which lies entirely within the chosen part .",
    "the proof from @xcite now applies directly to prove the following theorem .",
    "( mineyev ) [ t : mineyev ] there is a function @xmath1472 so that : for any finite valence @xmath5-hyperbolic graph @xmath159 , and group @xmath0 acting freely on @xmath159 , there is a ( @xmath1473)-quasi - geodesic @xmath0-equivariant antisymmetric homological bicombing @xmath150 so that @xmath1474 whenever @xmath16 , @xmath17 , @xmath179 are vertices of @xmath159 spanning a geodesic triangle @xmath1475 so that every vertex in the @xmath1471-neighborhood of @xmath1475 has valence less than @xmath306 .",
    "theorem [ t : mineyev ] is a key ingredient in the construction in this section .",
    "the other key ingredients are the construction of preferred paths and the analysis of preferred triangles from section [ section : pp ]      in the remainder of this section we define our homological bicombing @xmath18 of @xmath1476 , which uses preferred paths and mineyev s bicombing @xmath150 from theorem [ t : mineyev ] .",
    "( see definition [ d : homologicalextension ] for the definition of homological bicombing which allows some points to be ideal . )",
    "suppose that @xmath916 .",
    "let @xmath1188 be the preferred path between @xmath16 and @xmath17 .",
    "decompose @xmath1188 into subintervals , oriented consistently with @xmath1188 , which lie either entirely within @xmath1477)$ ] or entirely within @xmath1478 , and so that the endpoints of these subintervals lie in @xmath1479 .    by the way that preferred paths were defined",
    ", there is a unique way of performing this decomposition .",
    "suppose that @xmath25 is a subinterval in the decomposition of @xmath1188 so that @xmath25 lies in @xmath1477)$ ] , and let @xmath74 and @xmath75 be the endpoints of @xmath25 .",
    "[ l : nottoodeep1 ] the geodesic between @xmath74 and @xmath75 does not intersect any @xmath1480-horoball .    by proposition",
    "[ p : async ] , there exist @xmath1481 so that @xmath1482 , and so that the hausdorff distance between @xmath1483 $ ] and @xmath1484 $ ] is at most @xmath1192 . thus , @xmath1484 $ ] does not penetrate any @xmath1485-horoball .",
    "the geodesic quadrilateral with vertices @xmath1486 has two sides of length at most @xmath1192 .",
    "therefore , the geodesic between @xmath74 and @xmath75 lies in a @xmath1487 neighborhood of @xmath1484 $ ] , and hence does not penetrate any @xmath1480-horoball , as required .",
    "[ d : q1]_(definition of @xmath18 ) _ suppose that @xmath916 are distinct .",
    "let @xmath1188 be the preferred path between @xmath16 and @xmath17 , and let @xmath1488 be the induced @xmath7-chain .",
    "the decomposition of @xmath1188 described above induces a decomposition of @xmath1488 .",
    "let @xmath25 be an element of the decomposition of @xmath1488 for which @xmath1489 $ ] .",
    "let @xmath1490 .",
    "taking the sum over all such @xmath25 we define @xmath1491    because @xmath1492 , we have @xmath1493 . we claim that @xmath18 is a homological bicombing on @xmath959 in the sense of definition [ d : homologicalextension ] and that furthermore it is @xmath1494-quasi - geodesic in the sense of definition [ d : quasigeodesic ] .",
    "it also has nice properties analogous to those in theorem [ t : mineyev ] above .",
    "see theorem [ t : xfillings ] below for the precise statements about the bicombing @xmath18 .",
    "[ p : qneargeod ] for any @xmath1495 , @xmath1496 lies in a @xmath1497-neighborhood of any geodesic between @xmath16 and @xmath17 .    by corollary",
    "[ c : ppneargeodesic ] , @xmath1188 lies in a @xmath1498-neighborhood of @xmath929 .    by construction and theorem [ t : mineyev ] , @xmath1496 lies in an @xmath1473-neighborhood of @xmath1188 .    since @xmath1499 , proposition [ p : qneargeod ] proves the first of the two required statements for @xmath18 to be @xmath1494-quasi - geodesic .",
    "we now prove the remaining requirement .",
    "[ p : qisqg ] @xmath18 is a @xmath1494-quasi - geodesic homological bicombing on @xmath959 .    by proposition [ p : qneargeod ] , it remains to prove statement ( 2 ) of definition [ d : quasigeodesic ] .",
    "let @xmath1500 be distinct . by theorem [ t : mineyev ] and the definition of @xmath18",
    ", we have @xmath1501 by corollary [ c : quasigeodesic ] , the length of @xmath1188 is at most @xmath1502 .",
    "it is also possible to prove a suitable refinement of statement ( 2 ) as alluded to in remark [ r : wrongdef ] .",
    "the main result of section [ section : bicombing ] is theorem [ t : xfillings ] below .",
    "[ d : c_abc ] suppose @xmath1503 .",
    "we define a @xmath7-cycle @xmath1504 as follows :    let @xmath1505 be the preferred triangle associated to the triple @xmath1506",
    ". associated to @xmath28 is the graph @xmath1507 ( see definition [ d : skel ] ) , which has associated thick sub - pictures ( see definition [ d : thick ] ) .",
    "let @xmath1508 be a thick sub - picture of @xmath1507 .",
    "the vertices of @xmath1508 inherit a circular order @xmath1509 from the order @xmath1506 .",
    "define@xmath1510 finally , define @xmath1511 where the sum is over all thick sub - pictures of @xmath1507 .    if @xmath1508 is a thick sub - picture lying in a leg of @xmath1507 then @xmath1512 .",
    "the following is a key theorem for our proof of theorem [ t : zhlii ] , one of the major steps in proving theorem [ t : rhds ] :    [ t : xfillings ] there exists a constant @xmath1513 , depending only on @xmath11 , so that for all @xmath1514 there is a @xmath7-cycle @xmath1504 , as described in definition [ d : c_abc ] above then @xmath1515 also , @xmath1516    we have already noted that the thick sub - pictures which lie inside a leg do not contribute anything to @xmath1504 .",
    "thus we may concentrate on thick sub - pictures lying in the feet or middle of @xmath1507 . by corollary [ c : skelbound ] ,",
    "there are at most @xmath1517 vertices in total in all such sub - pictures .",
    "therefore , we can triangulate all of these sub - pictures with at most @xmath1518 triangles , whose vertices all appear as a vertex in one of the thick sub - pictures .",
    "let @xmath1048 and @xmath306 be such vertices . by proposition [ p : geodsinthick ] , the geodesic between @xmath1048 and @xmath306 does not intersect any @xmath1393-horoball .",
    "let @xmath306 be the maximum valence of any vertex in @xmath1519 $ ] , and let @xmath1520 be as in theorem [ t : mineyev ] .",
    "define @xmath1521 .",
    "we can express @xmath1504 as the sum of at most @xmath1518 @xmath7-chains of the form @xmath1522 , where @xmath1523 and @xmath1524 are the images under @xmath1525 of vertices in thick sub - pictures of @xmath1507 which lie in the feet or middle .",
    "the result now follows from theorem [ t : mineyev ] .",
    "the following is immediate from theorem [ t : xfillings ] and theorem [ t : tfae ] .",
    "[ c : xfillings ] for all @xmath1514 there exists a @xmath160-chain @xmath1526 so that    1 .",
    "@xmath1527 ; and 2 .",
    "@xmath1528 ,    where @xmath1529 is the constant for the linear homological isoperimetric function for @xmath11 .",
    "[ r : tf5 ] in the presence of torsion , the bicombing @xmath18 , and the @xmath160-chains @xmath1526 , can be defined without much difficulty using  averaged \" preferred paths , and the ideas already contained in this section .",
    "in part 2 of this paper , we provide an application of the constructions from part 1 .    [",
    "d : slopelength ] let @xmath0 be a group , and @xmath202 a subgroup .",
    "suppose that @xmath0 is generated by @xmath43 and @xmath202 is generated by @xmath1530 .",
    "if @xmath1531 is a normal subgroup of @xmath202 then we define @xmath1532 where @xmath1533 is the distance from @xmath503 to the identity in the cayley graph @xmath1534 . by convention @xmath1535 .    in the special case that @xmath202 is free abelian and @xmath51 the cyclic group generated by @xmath1536",
    ", @xmath1537 is just the length of @xmath1538 in @xmath202 .",
    "the main result of part 2 is the following theorem .",
    "[ t : rhds ] let @xmath0 be a torsion - free group , which is hyperbolic relative to a collection @xmath42 of finitely generated subgroups .",
    "suppose that @xmath43 is a generating set for @xmath0 so that for each @xmath44 we have @xmath45 .",
    "there exists a constant @xmath46 depending only on @xmath47 so that for any collection @xmath48 of subgroups satisfying    * @xmath49 ; and * @xmath50 ,    then the following hold , where @xmath51 is the normal closure in @xmath0 of @xmath52 .    1",
    ".   the map @xmath53 given by @xmath54 is injective for each @xmath55 .",
    "@xmath56 is hyperbolic relative to the collection @xmath57 .",
    "in fact , much more than this is true .",
    "for example , for @xmath1539 we have @xmath1540 ( see corollary [ c : ijdisjoint ] ) and each @xmath1541 is malnormal in @xmath56 ( see corollary [ c : conjugatesdisjoint ] ) . also , if @xmath0 is non - elementarily hyperbolic relative to @xmath1542 , then @xmath56 is non - elementarily hyperbolic relative to @xmath1543 ( see theorem [ t : nonelementary ] ) .",
    "the remainder of the paper is devoted to the proof of theorem [ t : rhds ] , and the subsidiary assertions mentioned above .",
    "theorem [ t : rhds ] clearly holds if @xmath1544 and @xmath1545 , so we henceforth assume ( without mention ) that this is not the case .",
    "in this section we suppose that @xmath0 is hyperbolic relative to @xmath273 , and that @xmath1546 is the cusped space associated to some compatible set of generators @xmath43 , and some collection of relators @xmath139 , as described in section [ section : cusped ] .",
    "finally @xmath1547 is an arbitrary normal subgroup of @xmath0 .    in order to use the geometry of @xmath11 to study the quotients of @xmath0 , we will need to turn equations in @xmath1548 or ( represented as maps of compact planar surfaces into @xmath376 ) into `` pleated surfaces '' in @xmath376 .",
    "exactly what this means depends on the context , and will become clear as we proceed .",
    "let @xmath1549 .",
    "notice that @xmath1550 is a cayley graph for @xmath1548 .",
    "we first show how to extend maps of compact surfaces with boundary components in @xmath1550 to proper maps of non - compact surfaces .",
    "we then say what we mean by `` lifting and straightening '' such proper maps .",
    "let @xmath171 be a compact planar surface , and let @xmath1551 be a cellular map so that @xmath1552 .    [",
    "d : parabolicboundary ] if @xmath1553 , let @xmath1554 be the union of those boundary components @xmath179 so that @xmath1555 lifts to an arc in @xmath11 which lies in a single left coset of @xmath202 .",
    "let @xmath1556 be the union of those boundary components of @xmath171 , each of which is sent into the image of a single @xmath244-horoball of @xmath11 ( see definition [ d : horoball ] ) .",
    "we refer to @xmath1557 as the _ parabolic boundary _ of @xmath171 .",
    "[ d : extend ] let @xmath1558 be the surface obtained from @xmath171 by attaching a half - open annulus to each component of @xmath1559 .",
    "we extend @xmath28 to a proper map @xmath1560 as follows : let @xmath1561 be a component of @xmath1559 .",
    "the map @xmath28 sends @xmath1562 to a loop @xmath1563 which is contained in @xmath1564 for some @xmath1553 .",
    "this loop lifts to some path @xmath1565 in @xmath11 , each edge of which is the top edge of some vertical square .",
    "let @xmath1566 be the loop which is the projection of the path obtained by traversing the bottom edges of those squares , and define @xmath1567}$ ] to be a homotopy across the images of those squares in @xmath261 so that @xmath1568 .",
    "similarly define @xmath1569}$ ] for each @xmath1570 so that @xmath1571 for each @xmath1572 .",
    "a _ peripheral path _ in @xmath376 is a path in the @xmath7-skeleton which lies in the image of the cayley graph of some @xmath1573 .",
    "[ d : reduce ] let @xmath171 be a compact planar surface , and let @xmath1574 be as above .",
    "a _ reducing arc _ for @xmath28 is an essential , properly embedded interval @xmath1575 so that @xmath1576 for some @xmath1553 and @xmath1577 is homotopic rel endpoints to a peripheral path .",
    "analogously we may define reducing arcs for proper maps into @xmath261 : suppose that @xmath462 is obtained from a compact planar surface by removing finitely many points .",
    "let @xmath1578 be a proper map , and suppose @xmath1579 is an essential proper arc .",
    "we say that @xmath173 is a reducing arc if @xmath1580 is properly homotopic into @xmath394 for some ( and hence for any ) @xmath393 .",
    "the map @xmath1581 has a reducing arc if and only if @xmath1582 has a reducing arc .",
    "[ l : straighten ] let @xmath462 be a surface of finite type ( possibly with boundary ) , and let @xmath1583 be a triangulation of @xmath462 ( partially ideal if appropriate ) .",
    "let @xmath1584 be a proper map satisfying : ( i ) @xmath1169 has no reducing arcs ; and ( ii ) if @xmath192 is an edge of @xmath1583 which limits on a puncture @xmath67 of @xmath462 then there is a neighborhood @xmath1585 of @xmath67 so that @xmath1586 is vertical .",
    "then there is a proper homotopy from @xmath1169 to a map @xmath1587 so that if @xmath192 is any edge of @xmath1583 , then @xmath1588 lifts to a preferred path in @xmath11 .",
    "let @xmath192 be an edge of @xmath1583 .",
    "it suffices to show that @xmath1247 is homotopic to a preferred path , and that this homotopy is level - preserving near the ends of @xmath192 .",
    "choose a lift @xmath1589 of @xmath1590 to @xmath11 .",
    "the map @xmath1589 extends to a map from @xmath168 to @xmath959 .",
    "let @xmath16 be the image of @xmath244 and @xmath17 the image of @xmath7 . since @xmath192 is not a reducing arc , @xmath1591 and",
    "there is a preferred path @xmath1188 between these points .",
    "consider @xmath1188 as a map from @xmath192 to @xmath11 .",
    "suppose that @xmath16 is ideal .",
    "then both @xmath1589 and @xmath1188 are vertical on some initial segment , so we may reparametrize so that @xmath1592 and @xmath1593 agree on this initial segment .",
    "therefore , there is an obvious horizontal homotopy from @xmath1589 to @xmath1188 on this initial segment .",
    "we consider the projection of this homotopy to @xmath376 .    in case @xmath17",
    "is ideal , we may similarly perform a homotopy on a terminal subsegment of @xmath192 .",
    "we are now left to deal with a compact loop , formed by the paths @xmath1589 and @xmath1188 ( or the sub - paths with which we have not yet dealt ) .",
    "the space @xmath11 is simply - connected .",
    "suppose that @xmath1581 is as at the beginning of this subsection .",
    "the surface @xmath1594 and the map @xmath1582 satisfy condition ( ii ) of the hypothesis of lemma [ l : straighten ] .",
    "[ r : tf6 ] in the presence of torsion it is not , in general , possible to find a map @xmath1595 as in lemma [ l : straighten ] so that each triangle is mapped to something which is combinatorially controlled the way that preferred triangles are . having no reducing arcs is not sufficient : an additional hypothesis is required .      in this subsection",
    ", we define the _ skeleton _ of the map of a surface into @xmath376 , assuming the surface has been triangulated by edges which are sent to preferred paths .",
    "[ d : skeleton ] suppose that @xmath462 is a surface with a ( possibly partially ideal ) triangulation @xmath1583 , and that @xmath1596 sends each edge of @xmath1583 to a non - degenerate path which lifts to a preferred path between points in @xmath1597 .",
    "further assume that @xmath1598 sends no vertex of @xmath1583 to a point in an @xmath952-horoball .",
    "let @xmath1599 be the compact surface obtained from @xmath462 by filling in the punctures ; @xmath1583 induces a triangulation @xmath1600 of @xmath1601 .",
    "then @xmath1598 extends to a map @xmath1602 if @xmath1245 is a triangle of @xmath1600 , then @xmath1603 lifts to a preferred triangle in @xmath11 ( definition [ d : preftri ] ) .",
    "the skeletal filling @xmath1604 can then be inscribed on @xmath1601 ( lemma [ l : inscribe ] ) .",
    "the _ skeleton of @xmath1598 _ ,",
    "@xmath1605 , is the @xmath7-complex in @xmath1601 which is the union of the @xmath1604 for @xmath1606 .",
    "a typical application of the above definition and the lemmas below is the situation where @xmath1581 is as at the beginning of the section ( with no reducing arcs ) . in this situation",
    ", we will take @xmath462 to be @xmath1594 and @xmath1598 to be @xmath1607 .",
    "[ r : maponskel ] let @xmath1596 and @xmath1583 be as described in definition [ d : skeleton ] , and write @xmath1608 for the union of the edges of @xmath1583 . by remark [ r : extend ] , we can extend @xmath1609 to a map @xmath1610 which collapses each ligament to a point , and sends each rib to a horizontal edge .",
    "observe that @xmath1611 for any vertex @xmath306 of @xmath1605 not coming from a vertex of @xmath1600 .",
    "[ d : link ] let @xmath1596 and @xmath1583 be as described in definition [ d : skeleton ] , and let @xmath1612 be as in remark [ r : maponskel ] .",
    "let @xmath1613 $ ] be as follows : @xmath1614 let @xmath306 be a vertex of @xmath1605 coming from a puncture of @xmath462 .",
    "let @xmath1615 be the smallest closed disk containing the component of @xmath1616 $ ] which also contains @xmath306 .",
    "the _ link of @xmath306 _ , @xmath1617 , is the boundary of @xmath1618 .",
    "note that @xmath1617 is contained in the skeleton of @xmath1598 .",
    "if @xmath462 is a punctured sphere , then @xmath1617 is a circle made up entirely of ribs and ligaments ; otherwise it may contain parts of edges of @xmath1583 .",
    "also notice that @xmath1618 contains no vertex of @xmath1600 other than @xmath306 . in figure",
    "[ fig : lollipop ] , one can see an example showing both kinds of links .",
    "the next two lemmas follow easily from the fact that @xmath1598 restricted to a triangle of @xmath1600 lifts to a preferred triangle in @xmath11 , and that both @xmath11 and @xmath952-horoballs in @xmath11 are simply connected .",
    "[ l : skelstraighten ] let @xmath1596 and @xmath1583 be as described in definition [ d : skeleton ] , and let @xmath1612 be as in remark [ r : maponskel ] .",
    "let @xmath1619 be an inclusion which is the identity on edges in @xmath1600 .",
    "the map @xmath1598 is properly homotopic to a map @xmath1620 so that @xmath1621 .",
    "[ l : link ] let @xmath1596 and @xmath1583 be as described in definition [ d : skeleton ] , and let @xmath1612 be as in remark [ r : maponskel ] .",
    "let @xmath1622 be a loop surrounding a puncture @xmath74 , so that @xmath1623 lies entirely in the component of @xmath1624 surrounding @xmath74 .",
    "let @xmath1625 be a homeomorphism .",
    "then @xmath1626 is homotopic to @xmath1627 inside @xmath1628 .",
    "in this section we investigate relations in @xmath56 amongst the images of the parabolic elements of @xmath0 . in particular , we prove assertion ( 1 ) of theorem [ t : rhds ] .",
    "we also prove theorem [ t : dontintersect ] .    for this section",
    ", we make the following standing assumptions :    1 .",
    "@xmath0 is a finitely generated , torsion - free group , which is hyperbolic relative to a collection @xmath42 of finitely generated subgroups ; 2 .",
    "@xmath43 is a finite compatible generating set for @xmath0 with respect to @xmath4 ( in the sense of definition [ d : compatible ] ) ; 3 .",
    "@xmath375 is @xmath5-hyperbolic .      in this paragraph , we explain how any equation amongst parabolic words ( and their conjugates ) may be turned into a map of a compact planar surface with boundary into @xmath261 ; we can then extend this to a proper map of a punctured sphere into @xmath261 using definition [ d : extend ] .",
    "suppose that in @xmath0 there is an equality of the form : @xmath1629 where , for each @xmath55 , @xmath1630 and @xmath1631 .",
    "choosing words for each @xmath1632 and words in @xmath1633 for each @xmath1634 , we find a map @xmath1635 of a disk , sending the boundary to a loop representing the equation .",
    "projection gives a map @xmath1636 .",
    "let @xmath171 be the surface obtained from the disk @xmath1637 by identifying those parts of the boundary corresponding to the @xmath1638 in pairs ( figure [ f : realize ] ) .",
    "( 0,0 ) labelled by the conjugating elements yields a compact planar surface which maps into @xmath261.,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4942,1689)(2461,-1548 ) ( 2476,-627)(0,0)[lb ] ( 3566 , 14)(0,0)[lb ] ( 3534,-1492)(0,0)[lb ]    the map @xmath1639 factors through the quotient map from @xmath1637 to @xmath171 .",
    "let @xmath1640 be the resulting map .",
    "the @xmath951 boundary components of @xmath171 are sent by @xmath28 to peripheral loops in @xmath261 whose labels are the words chosen for the @xmath1634 above .",
    "conversely , given a compact planar surface with all but ( possibly ) one boundary component labelled by elements of the @xmath39 , we can reconstruct an equality like for the word representing the other boundary component , by choosing the @xmath1638 via some paths through the surface .",
    "[ t : injects ] there is a constant @xmath1641 so that the following holds : if @xmath1642 are so that @xmath1643 and @xmath1644 then the natural map @xmath1645 is an injection , where @xmath51 is the normal closure in @xmath0 of @xmath1646 .",
    "* proof of theorem 3.1 ) )    we will show that if , for some @xmath55 , the map @xmath1647 is not injective , then @xmath1648 must be small for some @xmath1371 .",
    "let @xmath1649 be an element of @xmath51 .",
    "thus there is some equation @xmath1650 for some finite sequence of @xmath1651 and @xmath1652 .",
    "we say that such an equation _ represents the death of @xmath23 in @xmath56_. we may suppose that the product in is minimal in the following sense : if @xmath1653 is _ any _ element of @xmath1654 , and @xmath1655 for some collection of @xmath1656 and @xmath1657 , then @xmath1658 .",
    "( in other words , the expression in is minimal in length not only for @xmath23 , but over all such equations with the left hand side an element of @xmath1654 . )",
    "the equality is realized by a map @xmath1659 , as in subsection [ s : equations ] .",
    "[ claim1 ] the map @xmath28 has no reducing arcs .",
    "let @xmath173 be a reducing arc .",
    "each of the boundary components of @xmath171 has a corresponding word , and thus a corresponding base point ( the starting point of this word ) .",
    "we may assume that @xmath173 starts and finishes at one of these base points .",
    "the path @xmath173 determines some element @xmath67 of @xmath0 . because @xmath173 is homotopic to a peripheral path , @xmath67",
    "is contained in some @xmath1660 .",
    "we suppose @xmath28 has been homotoped so that @xmath1661 is a peripheral path .",
    "there are five cases to consider , depending on the endpoints of @xmath173 .",
    "[ ktok ] suppose that the endpoints of @xmath173 are on different boundary components , neither of which corresponds to @xmath23 .",
    "cutting along @xmath173 yields a new surface @xmath1662 with fewer boundary components than @xmath171 ( see figure [ f : ktok ] ) ;    ( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 3016,1894)(1143,-3698 )    two have been removed , and the new one is sent to a word representing @xmath1663 for some @xmath269 .",
    "this contradicts the minimality assumption .",
    "[ alphatok ] suppose next that the initial point of @xmath173 lies on the boundary component corresponding to @xmath23 , and that the terminal point lies on the boundary component corresponding to @xmath1664 for some @xmath55 .",
    "cutting along @xmath173 again yields a surface @xmath1662 with one fewer boundary component than @xmath171 .",
    "the boundary components corresponding to @xmath23 and @xmath1664 have been removed .",
    "the new boundary component has label @xmath1665 . since @xmath49 , and @xmath1666",
    ", we also have @xmath1667 .",
    "this again contradicts the minimality of equation .",
    "[ alphatoalpha ] suppose that both endpoints of @xmath173 lie on the boundary component corresponding to @xmath23 . cutting @xmath171 along @xmath173 yields two compact planar surfaces , each with fewer boundary components than @xmath171 . one of them represents the death of @xmath67 in @xmath56 , whilst the other represents the death of @xmath1668 .    in case @xmath1669 ,",
    "the equation for @xmath67 contradicts minimality .",
    "thus we may suppose that @xmath1670 , in which case @xmath1671 , and again we get a contradiction to minimality .",
    "[ ktosamek ] finally , suppose that @xmath173 is a loop whose endpoints are on the boundary component corresponding to @xmath1664 ( as in figure [ f : ktosamek ] ) .",
    "( 0,0 ) of claim [ claim1].,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 3016,1894)(1143,-3698 ) ( 2648,-2164)(0,0)[lb ]    cutting along @xmath173 yields a pair of surfaces , both of which have fewer boundary components than @xmath171 . if @xmath1672 then the surface @xmath1662 not containing @xmath23 corresponds to an equation representing the death of @xmath67 or @xmath1673 ( depending on whether @xmath1664 is contained in @xmath1662 ) . on the other hand , if @xmath1674 then we can replace the surface not containing @xmath23 by a single puncture , to yield a surface @xmath1675 with fewer punctures than @xmath171 , representing the death of @xmath23 .    in either case , this contradicts the minimality of @xmath951 .",
    "this proves claim [ claim1 ]    as in section [ s : extensions ] , let @xmath1676 , and let @xmath1677 be the extension from definition [ d : extend ] .",
    "we now choose an ideal triangulation @xmath1583 of the punctured sphere @xmath1594 .",
    "as @xmath1594 is an @xmath1678-times punctured sphere , @xmath1583 contains @xmath1679 triangles .",
    "let @xmath1680 be the map from lemma [ l : straighten ] , which sends each edge of @xmath1583 to a preferred path , and let @xmath1681 be as in remark [ r : maponskel ] .    if @xmath1682 , then @xmath1683 lifts to a preferred triangle @xmath1684 .",
    "let @xmath1685 be the number of ribs in @xmath1686 , and note that this number does not depend on the lift chosen .",
    "corollary [ c : ribsbound ] implies that @xmath1687 .",
    "let @xmath1688 corollary [ c : ribsbound ] immediately implies @xmath1689    let @xmath74 be one of the punctures of @xmath1594 not corresponding to @xmath23 .",
    "by lemma [ l : link ] , @xmath1690 is a loop at the @xmath952-level which , considering the @xmath952-level to be the image of a cayley graph for @xmath40 , represents an element @xmath503 of @xmath39 .",
    "it follows that @xmath1691 must contain at least @xmath1692 ribs .",
    "thus @xmath1693    therefore , by ,",
    "@xmath1694      the theme in this subsection is that , by choosing large enough algebraic slope lengths , we can preserve much of the structure of @xmath0 in its quotients .",
    "see @xcite for more results along these lines .",
    "[ t : dontintersect ] suppose @xmath0 is torsion - free and that @xmath1695 for each @xmath55 .",
    "let @xmath202 and @xmath1696 be conjugate into @xmath4 and suppose that whenever @xmath1697 then @xmath1698 .",
    "then the images of @xmath202 and @xmath1696 in @xmath56 intersect trivially .",
    "suppose that @xmath202 is conjugate to @xmath1699 , and let @xmath1700 be the conjugate of @xmath1701 in @xmath202 .",
    "define @xmath1702 similarly .",
    "if the theorem is false , then there is an equation in @xmath0 of the form @xmath1703 where @xmath1704 and @xmath1705 .",
    "suppose we have chosen such an equation with @xmath951 minimal over all such equations ( over all choices of @xmath202 and @xmath1696 ) .",
    "this gives rise to a map @xmath28 of a compact planar surface with @xmath1706 boundary components into @xmath261 .",
    "once again , we claim that this map has no reducing arcs .",
    "( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 5667,2408)(1651,-6698 ) ( 5885,-5607)(0,0)[lb ] ( 2746,-5607)(0,0)[lb ] ( 2712,-4932)(0,0)[lb ] ( 3421,-4696)(0,0)[lb ] ( 4670,-5540)(0,0)[lb ] ( 1666,-5506)(0,0)[lb ] ( 5581,-5540)(0,0)[lb ] ( 6391,-4764)(0,0)[lb ]    let @xmath173 be a reducing arc which is a peripheral arc , and let @xmath67 be the corresponding element of @xmath0 , contained in @xmath39 , say .",
    "most of the cases are entirely analogous to those in the proof of theorem [ t : injects ] ; they all lead to a contradiction to minimality , or to injectivity .",
    "we deal with the most interesting case , when @xmath173 is a loop whose endpoints lie on a puncture corresponding to some @xmath1664 , and so that cutting along @xmath173 separates the puncture corresponding to @xmath18 from the puncture corresponding to @xmath556",
    ". see figure [ f : annulusreduce ]",
    ".    by theorem [ t : injects ] , @xmath18 and @xmath556 are nontrivial in @xmath56 .",
    "therefore , @xmath1669 .",
    "now , the hypothesis of the theorem implies that it can not be that there are @xmath1707 so that @xmath1708 and @xmath1709 . therefore , one of the two diagrams obtained by cutting along @xmath173 yields a contradiction to the minimality of @xmath951 .",
    "this , and the omitted cases , shows that there are no reducing arcs .",
    "we now proceed as in the proof of theorem [ t : injects ] .",
    "the only difference is that we now have @xmath1710 triangles , rather than @xmath1679 .",
    "however , it is still the case that @xmath1711 has at most @xmath1712 ribs , and therefore @xmath1713 as required .",
    "[ c : ijdisjoint ] under the hypotheses of theorem [ t : dontintersect ] , if @xmath1539 then @xmath1714    [ c : conjugatesdisjoint ] under the hypotheses of theorem [ t : dontintersect ] , @xmath1541 is malnormal in @xmath56 , for each @xmath55 .",
    "[ p : thickdontdie ] suppose that @xmath0 is torsion - free and that @xmath1715 for each @xmath55 .",
    "suppose that @xmath1716 is such that there exists @xmath460 so that the preferred path @xmath1717 lies entirely within @xmath1718)$ ] .",
    "then @xmath1698 .    as usual",
    ", we suppose that the theorem is false , build a surface in @xmath1719 , and use its geometry to derive a contradiction .",
    "if @xmath1720 then there is an equality in @xmath0 of the form @xmath1721 where @xmath1722 and @xmath1631 .",
    "we choose such an expression for @xmath129 which minimizes @xmath951 .",
    "since @xmath1723 in @xmath0 , we have @xmath1724 .",
    "choosing words for each @xmath1632 , each @xmath1664 and @xmath129 , the expression for @xmath129 in gives a loop in @xmath11 , beginning at @xmath7 . in turn , this induces a map @xmath1725 of a disk , as described in subsection [ s : equations ] . also as in subsection [ s : equations ] , we may glue @xmath1726 along parts of the boundary corresponding to the @xmath1632 , to obtain a compact planar surface , @xmath171 , together with a map @xmath1727 . the surface @xmath171 has one distinguished boundary component which is labelled by a word representing @xmath129 , and we call this component the _ @xmath129-boundary _ of @xmath171 .",
    "we claim that there are no reducing arcs for @xmath28 whose endpoints do not lie on the @xmath129-boundary .",
    "this follows as before : any such reducing arc either contradicts theorem [ t : injects ] or else the minimality of @xmath951 .",
    "let @xmath1728 be a simple path in @xmath11 from @xmath7 to @xmath74 , and consider the loop in @xmath11 which is the concatenation @xmath1729 , where @xmath25 is the path @xmath1730 traversed backwards , and @xmath1731 is a lift to @xmath11 of the image under @xmath1732 of the @xmath129-boundary of @xmath171 .",
    "this loop may be filled with a disk in @xmath11 , which projects to an annulus in @xmath1719 , which has one boundary component the image of the @xmath129-boundary of @xmath171 .",
    "homotoping @xmath1732 over the annulus gives a new map @xmath1733 which maps the @xmath129-boundary to the image of the preferred path @xmath1717 in @xmath1719 .",
    "see figure [ f : glove ] .",
    "( 0,0).,title=\"fig : \" ]    # 1#2#3#4#5 @font    ( 4947,2251)(2456,-1534 ) ( 2746,-106)(0,0)[lb ] ( 3511,-106)(0,0)[lb ] ( 2746,524)(0,0)[lb ] ( 3466,524)(0,0)[lb ]    we now define a surface @xmath1594 almost as in definition [ d : extend ] by attaching a half - open annulus to each component of @xmath1734 _ except _ for the @xmath129-boundary .",
    "this gives a map @xmath1735 the @xmath129-boundary of @xmath1594 is defined in the obvious way .",
    "choose a ( partially ideal ) triangulation @xmath1583 of @xmath1594 which has one vertex which is the preimage of @xmath74 , and all other vertices ideal , and one edge the @xmath129-boundary of @xmath1594 .",
    "homotope @xmath1736 to @xmath1737 as in lemma [",
    "l : straighten ] .    because no edge in @xmath1583 is a reducing arc for @xmath1607 , the image of each triangle @xmath1738 lifts to a preferred triangle @xmath1739 in @xmath11 .",
    "therefore , we can define the map @xmath1681 as in remark [ r : maponskel ] .",
    "we now proceed as in the proof of theorem [ t : injects ] . by euler characteristic , there are @xmath1740 triangles .",
    "therefore , @xmath1711 has less than @xmath1712 ribs .    because @xmath1717 lies entirely within @xmath1718)$ ] , none of the ribs intersect the @xmath129-boundary of @xmath1711 ( where the @xmath129-boundary of @xmath1711 is defined in the obvious way ) . by lemma [ l : link ]",
    "there must be at least @xmath1741 ribs in @xmath1711 .",
    "thus we have @xmath1742 which is the required contradiction .",
    "this proposition has the following corollary :    [ c : injectonfinite ] let @xmath1743 be a finite set .",
    "then there is a constant @xmath1744 so that if each @xmath1745 , then the quotient map @xmath1746 is injective on @xmath138 .",
    "we prove the equivalent statement that there exists some @xmath1747 so that @xmath1746 sends no element of @xmath1748 to @xmath7 .",
    "( to see the equivalence notice that @xmath1749 . )    without loss of generality , we may assume that any element of @xmath138 which is conjugate into some @xmath40 actually lies in @xmath40 .",
    "write @xmath1750 , where @xmath1751 is the set of parabolic elements of @xmath138 , and @xmath1752 is the set of non - parabolic elements of @xmath138 .",
    "let @xmath1753 .",
    "note that since @xmath43 is a compatible generating set , so is @xmath1754 .",
    "we may thus form the space @xmath1755 . by theorem [ t : tfae ] , @xmath521 is @xmath105-hyperbolic for some @xmath1756 .    since @xmath1757 , the meaning of @xmath38 does not change in moving from @xmath11 to @xmath521",
    ". we may thus apply proposition [ p : thickdontdie ] in the context of @xmath521 rather than @xmath11 .",
    "the preferred path joining @xmath7 to @xmath174 in @xmath521 is a single edge for any @xmath1758 .",
    "let @xmath1759 . proposition [ p : thickdontdie ] implies that if @xmath1760 for each @xmath55 , then no element of @xmath1761 is sent to @xmath1762 .",
    "each @xmath1763 is contained in some @xmath1764 .",
    "let @xmath1765 and let @xmath1766 .",
    "using exactly analogous arguments to those in proposition [ p : thickdontdie ] we can obtain the following result .",
    "[ p : thicknotparabolic ] suppose that @xmath0 is torsion - free , and that @xmath1767 for each @xmath55 .",
    "suppose that @xmath268 is not conjugate into any @xmath1768 , and that there is some @xmath1769 with @xmath1770 $ ] .",
    "then there is no @xmath1771 , @xmath1772 so that @xmath1773 .    the constant for @xmath38 changes because we consider a disk with several punctures .",
    "however , we have no control of the length of one of the punctures ( that corresponding to @xmath67 ) .    therefore , if there are @xmath951 punctures corresponding to elements of the @xmath39 , then there are @xmath1774 triangles .    otherwise , the proof is just as before .",
    "once we have proved that @xmath56 is hyperbolic relative to the images of the @xmath40 in @xmath4 , this will imply that @xmath129 does not project to a parabolic element of @xmath56 .",
    "[ r : tf7 ] in the presence of torsion , many of the arguments in this section ( and later sections ) become more difficult to implement . in particular , the notion of minimality for surfaces needs to be refined .",
    "also , some of the results in this section need to be reformulated in the presence of torsion .",
    "the main issue here is that parabolics in @xmath0 may already intersect nontrivially , and this causes a number of problems .",
    "in this section we make the following assumptions : @xmath0 is a torsion - free group which is hyperbolic relative to a collection @xmath1775 of finitely generated subgroups .",
    "the finite set @xmath43 is a compatible generating set for @xmath0 with respect to @xmath4 .",
    "finally , @xmath1776 is a finite relative presentation for @xmath0 .",
    "recall from theorem [ t : tfae ] , that under these assumptions , the space @xmath375 is @xmath5-hyperbolic for some @xmath5 .",
    "moreover , given the finite relative presentation @xmath1776 , we may adjoin @xmath160-cells to @xmath375 to form a two - complex @xmath1546 which satisfies a linear combinatorial isoperimetric inequality .",
    "we further suppose that , for @xmath44 , we have @xmath49 .",
    "let @xmath1777 be the normal closure of the union of the @xmath39 .",
    "in order to construct a nice model space for @xmath1778 it is essential that the @xmath58 inject into @xmath1778 .",
    "we thus make the standing assumption that :    [ k ] for each @xmath1779 , @xmath1780 .",
    "the space @xmath11 contains a copy of the cayley graph @xmath1781 of @xmath0 , and has an associated depth function @xmath1782 so that @xmath1783 .",
    "we now describe a `` neutered '' version of @xmath11 , and how to modify it to get a model for @xmath1778 .",
    "[ d : y ] let @xmath1784)$ ] .",
    "the _ boundary of @xmath82 _ is @xmath1785 . if @xmath1786 then the boundary of @xmath1787 is the image of @xmath1788 in @xmath1787 .",
    "if the parabolics are not finitely presented , then @xmath82 will not be simply connected .",
    "its fundamental group is generated by those loops in @xmath953 which can not be filled in @xmath953 .",
    "the boundary of @xmath1789 has @xmath2 connected components which correspond to the subgroups @xmath1790 , as described in the next few paragraphs .",
    "let @xmath1791 be the image of the vertices of @xmath1781 in @xmath261 .",
    "for each @xmath44 there is a unique @xmath952-horoball in @xmath11 stabilized by @xmath40 , which we denote @xmath152 .",
    "there is a unique vertical path @xmath1792 joining @xmath7 to @xmath1793 .",
    "let @xmath1794 be the image of @xmath1792 in @xmath1795 , and let @xmath1796 be @xmath1794 in the opposite direction .",
    "let @xmath1797 be the component of @xmath1798 containing the image @xmath1799 of @xmath1800 .",
    "the vertical path @xmath1794 induces an inclusion of @xmath1801 into @xmath1802 .",
    "any loop in @xmath1795 based at @xmath1803 lifts to a unique path in @xmath11 starting at @xmath7 and ending at some group element .",
    "this gives a well - defined homomorphism from @xmath1802 onto @xmath0 , which maps @xmath1804 onto @xmath40 .",
    "the next two lemmas follow from assumption [ k ] , together with theorem [ t : injects ] .",
    "[ l : noshortloops ] if @xmath179 is any loop in a boundary component of @xmath1805 of length less than @xmath1806 , then @xmath179 lifts to a loop in @xmath1807 .    in particular",
    ", there is no loop in @xmath1808 consisting of a single edge .",
    "[ d : surgered ] let @xmath1809 be the @xmath160-complex obtained from @xmath1805 by gluing a combinatorial horoball onto each component of the boundary of @xmath1805 .",
    "the depth function on @xmath1805 naturally extends to a depth function @xmath326 on @xmath206 .    if each @xmath1810 , the complex @xmath206 is simply connected .",
    "the fundamental group of @xmath82 is generated by peripheral loops .",
    "note that we have an exact sequence : @xmath1811 thus , the fundamental group of @xmath1805 is generated by the fundamental group of @xmath82 together with peripheral loops in @xmath1805 which represent elements of @xmath1812 which map to normal generators of @xmath51 .",
    "any peripheral loop eventually dies in a horoball , by lemma [ l : noshortloops ] and proposition [ p : combhorolii ] .",
    "@xmath56 acts freely and properly on @xmath206 .",
    "we thus have the following diagram of spaces : @xmath1813 & y\\ar[l]\\ar[d]\\\\ x / k\\ar[d ] & y / k\\ar[r]\\ar[l]\\ar[d ] & z\\ar[d ] \\\\                         x / g   & y / g \\ar[r]\\ar[l ] & z/(g / k)}}\\ ] ] each horizontal arrow in is an inclusion , and each vertical arrow is a covering map",
    ".    we will show in section [ section : lollipop ] that @xmath206 satisfies a linear isoperimetric inequality if the @xmath38 are sufficiently large . together with proposition [ zisanx ] below , this will imply that @xmath1778 is hyperbolic relative to @xmath1814 , and hence complete the proof of theorem [ t : rhds ] .",
    "[ zintoxmodk ] there is a @xmath1778-equivariant embedding @xmath1815 .",
    "the spaces @xmath206 and @xmath1719 are identical at depths less than or equal to @xmath952 .",
    "thus there is an obvious map at these depths .",
    "it is also obvious that vertical edges in @xmath206 can be uniquely associated to vertical edges in @xmath1719 .",
    "a horizontal edge @xmath192 in @xmath206 at depth @xmath1816 corresponds to a path @xmath67 at depth @xmath952 in @xmath206 of length at most @xmath1817 .",
    "this path has already been mapped to a path @xmath1818 in @xmath1719 at depth @xmath952 ( still of length at most @xmath1817 ) .",
    "the path @xmath1818 lifts to a path @xmath1819 in @xmath11 ( which is still of length at most @xmath1817 ) .",
    "the path @xmath1819 lies above an edge @xmath1820 in @xmath11 at depth @xmath1821 , which projects to an edge @xmath1822 in @xmath1719 .",
    "this is @xmath1823 .",
    "let @xmath1824 .",
    "[ o : ccomp ] @xmath1825 is a relative cayley complex for @xmath56 with respect to the finite relative presentation @xmath1826 .",
    "recall the notation @xmath331 from definition [ d : toppart ] , where @xmath336 is a combinatorial horoball .",
    "[ l : shell ] let @xmath1827 be a @xmath244-horoball in @xmath11 , and @xmath81 its projection in @xmath1719",
    ". then the intersection @xmath1828 is isomorphic to @xmath1829 , where @xmath1830 .",
    "we define maps @xmath1831 and @xmath1832 .",
    "there are obvious bijections on the @xmath244-skeleta , which extend to isomorphisms at the @xmath244level , and the vertical edges .",
    "the first thing to note is that horizontal edges in @xmath1828 are not loops , by assumption [ k ] and theorem [ t : injects ] .",
    "it is also true that horizontal edges in @xmath1829 are not loops .",
    "consider a horizontal edge @xmath1833 , at depth @xmath288 .",
    "this lifts to a horizontal edge @xmath1834 in @xmath11 at depth @xmath288 .",
    "this can be pushed up to a path @xmath1835 of length at most @xmath1817 in @xmath1836 , which project to a path @xmath67 in @xmath1837 above @xmath192 .",
    "we have already defined @xmath1838 , and this path lies above an edge in @xmath1829 at depth @xmath288 .",
    "this edge is @xmath1839 .",
    "thus we have defined @xmath1840 on the @xmath7-skeleton of @xmath1828 .",
    "we now define @xmath1841 on the @xmath7-skeleton of @xmath1829 .",
    "let @xmath1822 be an edge at depth @xmath288 in @xmath1829 .",
    "there is a path @xmath1818 above @xmath1822 at the @xmath244-level of @xmath1829 .",
    "the path @xmath1842 is already defined .",
    "the path @xmath1842 lifts to a path in @xmath1836 , and lies above an edge @xmath1834 in @xmath1843 , which in turn projects to an edge @xmath192 in @xmath1828",
    ". set @xmath1844 .",
    "we have now defined @xmath1840 and @xmath1841 on the @xmath7-skeleta , and we leave it as an exercise to prove that they are mutually inverse .",
    "the map @xmath1840 obviously extends over the @xmath160-skeleta . consider then a @xmath160-cell @xmath179 in @xmath1829 .",
    "then @xmath1845 is a loop in @xmath1828 of length at most @xmath347 .",
    "suppose @xmath1845 lifts to a path @xmath173 which is not a loop .",
    "let @xmath1846 be the element which sends one endpoint of @xmath173 to the other .",
    "then @xmath1847 , a contradiction .",
    "therefore , @xmath1845 _ does _ lift to a loop in @xmath82 , so there is a @xmath160-cell filling @xmath1845 .",
    "this @xmath160-cell is @xmath1848 .",
    "the following proposition follows easily from observations [ o:2step ] and [ o : ccomp ] and lemma [ l : shell ] .",
    "[ zisanx ] if @xmath1849 for all @xmath363 , then @xmath206 is equivariantly isomorphic to @xmath1850 .",
    "we have reduced the proof of theorem [ t : rhds ] to proving that the space @xmath206 satisfies a homological isoperimetric inequality .",
    "this is proved in theorem [ t : zhlii ] below .",
    "the proof of this result breaks neatly into two pieces : a combinatorial piece ( proposition [ prop : keypoint ] ) , and a homological piece ( which becomes theorem [ t : zhlii ] below ) .",
    "we continue to assume that @xmath0 is a group which is hyperbolic relative to @xmath273 , and that @xmath1851 for each @xmath55 .",
    "we let @xmath1546 , @xmath82 , and @xmath206 be as described in section [ surgered ] . in order to slightly simplify the proof of proposition [ prop : keypoint ] , we replace assumption [ k ] with the slightly stricter :      we show ( theorem [ t : zhlii ] ) that under these conditions , the surgered space @xmath206 described in section [ surgered ] satisfies a linear homological isoperimetric inequality .",
    "it follows via theorem [ t : tfae ] and proposition [ zisanx ] that @xmath56 is hyperbolic relative to the images of the subgroups in @xmath4 .",
    "if @xmath1854 does not surround a @xmath160-cell then it does not lift to a loop in @xmath11 .",
    "thus , since the length of @xmath1854 is at most @xmath347 , it lifts to a path in @xmath11 of length @xmath347 , whose endpoints are in the same orbit under the action of @xmath51 .",
    "theorem [ t : injects ] and assumption [ k ] now imply that these points must lie in the same orbit under the action of the stabilizer of the horoball in which they lie . thus there is some @xmath1846 so that @xmath1856 sends one endpoint to the other for some @xmath129 .",
    "let @xmath288 be the minimal depth of @xmath1854 .",
    "there is a lift of @xmath1854 starting and ending at depth @xmath288 in @xmath11 , and the endpoints of this lift are joined by a horizontal path of length at most @xmath69 ( as the diligent reader may readily verify ) .",
    "therefore , the points at depth @xmath244 above these endpoints may be joined by a horizontal path of length at most @xmath1857 .",
    "the length of such a path is an upper bound for @xmath1858 , so by assumption [ k ] we have @xmath1859 . in particular , @xmath1860 as required .",
    "[ d : pmp ] suppose that @xmath1861 is a cellulated disk , and that @xmath1862 is a combinatorial map .",
    "a _ partly missing piece _ of @xmath28 is a component @xmath33 of @xmath1863 so that @xmath1864 contains some missing @xmath160-cell .",
    "let @xmath1865 be the complement of the partly missing pieces of @xmath1861 .",
    "let @xmath1866 be a closed regular neighborhood of @xmath1867 whose image under @xmath28 contains no missing @xmath160-cells ( we may need to adjust @xmath28 by a small homotopy rel @xmath1868 ( and re - cellulate ) to ensure that @xmath1866 exists ) .",
    "a _ reducing arc _ for @xmath28 is an map @xmath1869\\to e$ ] satisfying the following :    1 .",
    "@xmath173 is an essential arc in @xmath1866 .",
    "the endpoints of @xmath173 lie in partly missing pieces of @xmath1861 .",
    "@xmath173 is homotopic rel endpoints into @xmath1870 , and this homotopy does not pass over any missing @xmath160-cell .",
    "this is slightly different from the way reducing arcs were defined in section [ s : dyingwords ] for a couple of reasons .",
    "first , we need to deal with the possibility that , for instance , two components of @xmath1871 have intersecting closures .",
    "second , we do not want to reduce along arcs with an endpoint in @xmath1868 , because this would change the loop being filled .",
    "[ l : simpconn ] let @xmath1861 be a disk .",
    "suppose that @xmath92 is a combinatorial loop in @xmath206 , and @xmath1872 is a filling of @xmath92 .",
    "then there is some @xmath1873 so that each partly missing piece of @xmath1732 is simply connected , and the number of partly missing pieces of @xmath1732 is no more than the number of partly missing pieces of @xmath28 .",
    "fix a partly missing piece @xmath33 , and let @xmath1728 be the component of the boundary of @xmath1866 which lies in @xmath33 and contains all other components of @xmath1874 . the loop",
    "@xmath1875 lies entirely in @xmath1876 , and can thus be filled there .",
    "we set @xmath1877 outside of @xmath1728 , and set @xmath1732 equal to this new filling inside @xmath1728 .",
    "[ l : pmpmin ] let @xmath1861 be a disk .",
    "suppose that @xmath92 is a combinatorial loop in @xmath206 , and @xmath1872 is a filling of @xmath92 chosen so that the number of partly missing pieces of @xmath1861 is minimized",
    ". then there are no reducing arcs for @xmath28 .",
    "suppose first that the arc joins distinct partly missing pieces .",
    "then we may cut open @xmath1861 along the arc and add in two copies of the homotopy into @xmath1628 , thus combining the two partly missing pieces into one .",
    "since the homotopy passes over no missing @xmath160-cells , we have decreased the number of partly missing pieces .",
    "next suppose that the arc @xmath173 joins some partly missing piece @xmath33 to itself .",
    "again we can cut open along @xmath173 and insert the homotopy , thus creating a non - simply connected partly missing pieces . by lemma [ l :",
    "simpconn ] , this non - simply connected component can be replaced with a simply connected one . since @xmath173 was essential , it enclosed at least one partly missing piece other than @xmath33 , and so the modified map has fewer partly missing pieces than it did before .    [",
    "d : diskextend ] if @xmath28 is a map of a disk @xmath1861 into @xmath206 , then @xmath1878 can be extended to a proper map of a punctured disk @xmath1879 the surface @xmath1880 can be obtained from @xmath1861 by removing a point from the interior of each partly missing piece .",
    "the map @xmath1736 is then defined to be equal to @xmath1881 on @xmath1882 .",
    "the complement of @xmath1882 in @xmath1880 is a union of annuli ; the map @xmath1736 is defined so that the image of these annuli consists entirely of vertical squares , just as in definition [ d : extend ] .",
    "[ l : diskstraighten ] let @xmath1861 be a disk , and let @xmath1862 be a map with no reducing arcs , so that @xmath28 has at least one partly missing piece and @xmath1883 is nonempty . let @xmath1583 be a partially ideal triangulation of @xmath1880 with a single vertex @xmath1884 satisfying @xmath1885 . then @xmath1736 is properly homotopic to a map @xmath1886 which sends each edge of @xmath1583 to the image in @xmath1719 of a preferred path in @xmath11 .",
    "[ prop : keypoint ] there is a constant @xmath1887 so that the following holds : let @xmath1888 be a combinatorial loop , and suppose that @xmath1889 is a filling of this loop by a disk @xmath1861 , and that this filling has no reducing arcs . if @xmath28 has @xmath1890 partly missing pieces , then @xmath1891 .",
    "we will show that @xmath33 can be chosen equal to @xmath1892 , where @xmath1893 and @xmath212 are the constants of quasi - geodesicity from corollary [ c : quasigeodesic ] .",
    "if @xmath307 does not intersect @xmath1894 , then @xmath307 can be filled with a disk containing at most one partly missing piece .",
    "we may therefore assume that @xmath1895 .",
    "let @xmath92 be a loop homotopic ( rel @xmath7 ) to the loop @xmath1896 in @xmath1897 , so that @xmath92 lifts to a preferred path @xmath1898 in @xmath11 .",
    "let @xmath268 be the unique group element which sends the initial point of @xmath1898 to the terminal point .    by corollary [ c : quasigeodesic ] , @xmath1899 , where @xmath1900 is the distance from @xmath7 to @xmath129 in @xmath11 .",
    "as @xmath1901 is bounded below by @xmath1900 , we have @xmath1902 it thus suffices to bound @xmath1903 below linearly in terms of @xmath951 .",
    "we remark that @xmath1904 .    by assumption",
    ", we have a map @xmath1905 of a disk into @xmath206 with no reducing arcs .",
    "let @xmath1906 be the proper map from definition [ d : diskextend ] of an @xmath951-times punctured disk into @xmath1719 .",
    "note that @xmath1907 .",
    "let @xmath1583 be a ( partially ideal ) triangulation of @xmath1880 with one vertex the preimage of @xmath1908 and all other vertices ideal , and one edge on the boundary .",
    "this induces an obvious triangulation @xmath1909 of the disk @xmath1861 .",
    "let @xmath67 be a puncture on @xmath1880 .",
    "the link @xmath1913 in @xmath1711 is a loop and we have @xmath1914 this loop represents a conjugacy class in @xmath40 for some @xmath55 , and this class is contained in @xmath39 , by lemma [ l : link ] .",
    "a puncture @xmath67 is called _ interior _ if @xmath1913 is composed entirely of ribs and ligaments , and _ exterior _ otherwise .",
    "the puncture @xmath67 corresponds to a vertex of the triangulation @xmath1909 of @xmath1861 , which we also describe as _ interior _ or _",
    "exterior_.            let @xmath1916 be the number of interior vertices of @xmath1909 , and let @xmath1917 be the number of exterior vertices .",
    "it is clear from the definitions that the cardinality of @xmath1915 is at least @xmath1918 .",
    "the set @xmath953 partitions @xmath1898 into subsegments , which alternate between lying in @xmath1919 $ ] and lying in @xmath1628 . as the initial and terminal points of @xmath1898 lie in @xmath447 , those subsegments of @xmath1898 with image in @xmath1919 $ ] must have length at least @xmath952 ( in fact all but the initial and terminal subsegments must have length at least @xmath1920 , as they must pass between distinct @xmath952-horoballs . ) .",
    "there are at least @xmath1921 such subsegments , and so latexmath:[\\[\\label{e : sizeofgamma }                the idea behind the proof is as follows : take a loop in @xmath206 , which is filled by _ some _ disk .",
    "attempt to move this disk to @xmath1719 , fail , and find a punctured disk mapping into @xmath1719 .",
    "triangulate , lift and straighten the triangles , project back to @xmath1719 , attempt to transfer back to @xmath206 , fail and fill the failures .",
    "let @xmath179 be a simple ( combinatorial ) loop in @xmath206 .",
    "if @xmath179 lies entirely inside a single horoball , we may fill with a disk of area at most @xmath1931 . thus @xmath1932 lifts to a path @xmath1933 in @xmath11 between two ( not necessarily distinct )",
    "vertices @xmath129 and @xmath353 of the cayley graph @xmath1934 .",
    "consider the @xmath7-chain @xmath1935 corresponding to the path @xmath1933 . then @xmath1936 is a @xmath7-cycle . by proposition [ p : qisqg ] ,",
    "@xmath1937 . hence ,",
    "if @xmath1529 is the homological isoperimetric constant for @xmath11 , there is a @xmath160-chain @xmath1938 so that @xmath1939 , and @xmath1940 .",
    "as @xmath206 is simply connected , there is a combinatorial map of a cellulated disk @xmath1861 @xmath1941 so that @xmath1942 is @xmath179 .",
    "we may suppose that the map @xmath28 has the minimal possible number of partly missing pieces in the sense of definition [ d : pmp ] .",
    "by lemma [ l : pmpmin ] , @xmath28 has no reducing arcs . by proposition [ prop : keypoint ] ,",
    "the number of partly missing pieces is at most @xmath1943 , for a @xmath1944 which depends only on @xmath5 .",
    "thus we can triangulate the punctured surface @xmath1880 defined in definition [ d : diskextend ] with a triangulation @xmath1583 consisting of fewer than @xmath1945 triangles .",
    "let @xmath1946 be the map from lemma [ l : diskstraighten ] .",
    "this induces , for each triangle @xmath1738 , a preferred triangle @xmath1947 .",
    "suppose that @xmath1948 , and that the image of the vertices of @xmath21 are @xmath16 , @xmath17 , and @xmath179 ( with order coming from the orientation of @xmath21 ) .",
    "let @xmath1949 , the @xmath7-chain defined in definition [ d : c_abc ] , and let @xmath1950 be the @xmath160-chain as in corollary [ c : xfillings ] .",
    "let @xmath1951 .",
    "each @xmath1952 satisfies @xmath1953 by corollary [ c : xfillings ] .",
    "now let @xmath1954 , and let @xmath1955 be the @xmath160-chain which comes from including only those @xmath160-cells which lie entirely in @xmath1956 $ ] .",
    "note that @xmath1957 |c|_1\\end{aligned}\\ ] ] let @xmath1958 .      1 .",
    "the support of @xmath1961 lies entirely in @xmath1962 , and 2 .",
    "@xmath1963 , where @xmath20 is the maximum length of the boundary of a @xmath160-cell in @xmath206 ( which is the same as that maximum length in @xmath11 ) .                by theorem [ t : onethickz ]",
    ", there is a hyperbolic element @xmath274 with an axis which is entirely contained in @xmath498 $ ] .",
    "if @xmath460 is contained in this axis , then for all @xmath338 , the preferred path @xmath1971 is the geodesic between these points ( since @xmath1972 ) .",
    "therefore , by proposition [ p : thickdontdie ] , none of these elements die in @xmath56 .",
    "therefore , @xmath56 is infinite .",
    "furthermore , by proposition [ p : thicknotparabolic ] , @xmath129 does not project to a parabolic element of @xmath56 .",
    "thus @xmath56 is not equal to any of the @xmath1541 . by theorem [ t : dontintersect ]",
    ", the intersection of two distinct parabolic subgroups of @xmath56 is trivial .",
    "suppose @xmath56 is virtually cyclic .",
    "then @xmath56 has a finite normal subgroup @xmath137 with quotient either infinite cyclic or infinite dihedral .",
    "in fact , @xmath137 must be contained in every parabolic ; and so it is trivial",
    ". however , the parabolic subgroups of @xmath56 have size ( much ) greater than @xmath160 .",
    "we may now suppose that some @xmath1541 is infinite .",
    "we have already seen that @xmath56 does not equal @xmath1541 for any @xmath55 , so theorem [ t : independentz ] implies that @xmath56 is non - elementary relatively hyperbolic ."
  ],
  "abstract_text": [
    "<S> we introduce a number of new tools for the study of relatively hyperbolic groups . </S>",
    "<S> first , given a relatively hyperbolic group @xmath0 , we construct a nice combinatorial gromov hyperbolic model space acted on properly by @xmath0 , which reflects the relative hyperbolicity of @xmath0 in many natural ways . </S>",
    "<S> second , we construct two useful bicombings on this space . </S>",
    "<S> the first of these , _ preferred paths _ </S>",
    "<S> , is combinatorial in nature and allows us to define the second , a relatively hyperbolic version of a construction of mineyev .    as an application </S>",
    "<S> , we prove a group - theoretic analog of the gromov - thurston @xmath1 theorem in the context of relatively hyperbolic groups . </S>"
  ]
}