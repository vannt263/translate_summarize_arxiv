{
  "article_text": [
    "precise timing of astrophysical events is one of the fundamental tools of astronomy , and is an important component of essentially every area of study .",
    "there are two basic sources of uncertainty in timing : the astrophysical data characterizing the event , and the time stamp with which the event is referenced .",
    "unfortunately , since the accuracy of the time stamp is something that is often taken for granted , the improvements in data are sometimes not accompanied ( or are not uniformly accompanied ) by the requisite improvements in accuracy of the time stamp used .",
    "this situation can lead to confusion , or even spurious inferences .",
    "timing plays a particularly important role in the study of exoplanets .",
    "indeed , many of the ways in which exoplanets are discovered involve the detection of transient or time - variable phenomena , including the radial velocity , transit , microlensing , and astrometry techniques .",
    "furthermore , in some cases much can be learned about planetary systems from the precise timing of these phenomena . as examples ,",
    "the measurement of terrestrial parallax in microlensing allows one to infer the mass of the primary lens and so the planetary companion ( e.g. , * ? ? ?",
    "* ) , and one can constrain the eccentricity of transiting planets by comparing the times of primary transits and secondary eclipses ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "possibly the most promising application of timing in exoplanets , however , comes from transit timing variations ( ttvs ) . with an exquisitely periodic phenomena like transiting planets",
    ", we will be able to measure many effects using the departures from strict periodicity , such as the gravitational perturbations from additional planets @xcite , trojans @xcite , and moons @xcite , stellar quadrupoles @xcite , tidal deformations , general relativistic precession @xcite , orbital decay ( e.g. , * ? ? ?",
    "* ) , and proper motion @xcite .",
    "because of their great potential , ttvs have become the focus of many groups .",
    "the typical data - limited transit timing precisions of most observations are around 1 minute , with the best transit time precision yet achieved of a few seconds @xcite . however , as discussed above , accuracies of transit times are limited not only by the data themselves , but also by the time stamp used . in order to make these difficult measurements useful , it is critical that a time stamp be used that is considerably more accurate than the uncertainty due to the data themselves . furthermore , since thorough characterization of ttvs will require the use of all available data spanning many years from several groups , this time stamp must be stable in the long term , and all groups must clearly convey how it was calculated .",
    "unfortunately , we have discovered that , in the exoplanet community , the julian date ( jd ) and its geocentric ( gjd ) , heliocentric ( hjd ) , and barycentric ( bjd ) counterparts are currently being quoted in several different , and often unspecified , time standards . in addition , the site arrival time and its time standard is not quoted .",
    "this general lack of homogeneity and specificity leaves quoted time stamps ambiguous at the 1 minute level .",
    "more alarmingly , the most commonly - used time standard , the coordinated universal time ( utc ) , is discontinuous and drifts with the addition of each leap second roughly each year .",
    "the pulsar community has solved the problem of precise timing well beyond the level that is currently necessary for exoplanet studies , and we can benefit from the techniques they have developed over the past 40 years .",
    "in particular , their current state of the art program ( tempo2 ) models pulsar arrival times to 1 ns precision @xcite . this program is highly specialized and generally can not be applied outside of pulsar timing observations , but many of the effects they consider are relevant to optical observers in the exoplanet community .    in this article , we summarize the effects one must consider in order to achieve timing accuracy of 1 @xmath1s  well beyond the accuracy that will likely be required by the exoplanet community for the foreseeable future .",
    "section [ theory ] provides the background required to understand each of the effects that could change the arrival time of a photon .",
    "they are listed in order of decreasing magnitude , so latter subsections can be ignored for low - precision measurements .",
    "section [ practice ] discusses the practical limitations to achieving high - precision timing .",
    "we begin with the effects which may cause errors that are comparable to or exceed the bjd correction .",
    "these should be read and understood by everyone .",
    "we continue with remaining effects , in order of decreasing magnitude , which can be ignored for low - precision ( @xmath2 ms ) measurements .",
    "we conclude   3 by listing additional effects , the errors due to which are negligible ( @xmath3s ) .",
    "we begin   [ sec : calculating ] by detailing the procedure one must follow in order to calculate the bjd@xmath0 , which is designed to be a useful reference for those already familiar with the concepts of precision timing . in the latter part of this section , we describe our particular idl and web - based implementation of this procedure .",
    "lastly , in the appendix , we discuss some of our specific findings about the time stamps currently in use and how these are calculated throughout the exoplanet community .",
    "while we focus on the effects of timing on the optical / infrared exoplanet community , timing precision of order 1 minute is necessary for many other areas , such as the study of rapidly rotating white dwarfs @xcite .",
    "this article should be equally applicable in such cases .",
    "the biggest source of confusion comes from the fact that time standards and reference frames are independent from one another , even though there are many overlapping concepts between the two .",
    "we will use the following terminology : `` reference frame '' will refer to the geometric location from which one could measure time ",
    "different reference frames differ by the light - travel time between them ; `` time standard '' will refer to the way a particular clock ticks and its arbitrary zero point , as defined by international standards ; and `` time stamp '' is the combination of the two , and determines the timing accuracy of the event .",
    "the bjd@xmath0 , the time stamp we advocate , can be calculated using the equation :    @xmath4    where jd@xmath5  is the julian date in coordinated universal time ; @xmath6 is the rmer delay , discussed in  [ sec : roemer ] ; @xmath7 is the clock correction discussed in   [ sec : clock ] ; @xmath8 is the shapiro delay discussed in   [ sec : shapiro ] ; and @xmath9 is the einstein delay , discussed in   [ sec : einstein ] .",
    "the order of these terms is such that they are of decreasing magnitude , so one need only keep the terms up to the precision required .",
    "the timing precision required by current exoplanet studies ( @xmath10 1 s ) requires only the terms up to and including @xmath7 .    because future solar system ephemerides may enable more precise calculations of the arrival time at the barycenter , or in order to allow others to check that the original conversion was done accurately enough for their purpose , the site arrival time ( e.g. , the jd@xmath5 ) should always be quoted in addition to the bjd@xmath0 .      due to the finite speed of light ,",
    "as the earth travels in its orbit , light from an astrophysical object may arrive early or be delayed by as much as 8.3 minutes from the intrinsic time of the extraterrestrial event .",
    "this is called the rmer delay , @xmath11 , in honor of ole rmer s demonstration that the speed of light is finite .",
    "since most observers can not observe during daylight , a bias is introduced and in practice the delay ( as distinct from the early arrival time ) is only as much as 7 minutes , for a peak - to - peak variation of 15 minutes .",
    "figure [ fig : bjdvjd ] shows an example of this effect for a maximally affected object on the ecliptic . in order to show the observational bias , our example assumes the object is at 0@xmath12 right ascension and 0@xmath13 declination .",
    "this curve shifts in phase with ecliptic longitude and in amplitude with ecliptic latitude .",
    "we also place our observer at the earth s equator , but note that the asymmetry will be larger at different latitudes .    and the uncorrected jd@xmath14 ( see text for definitions ) over the course of a year .",
    "we plot the correction for a maximally - affected object on the ecliptic for an observer at latitude of zero degrees .",
    "we exclude all points where the object has an airmass greater than three and the sun is higher than -12@xmath13 in order to highlight observing biases.,width=312 ]    the solution to this problem is to calculate the time when a photon would have arrived at an inertial reference frame .",
    "this time delay is the dot product of the unit vector from the observer to the object , @xmath15 , and the vector from the origin of the new reference frame to the observer , @xmath16    @xmath17    where @xmath18 is the speed of light and @xmath15 can be written in terms of its right ascension ( @xmath19 ) and declination ( @xmath20 ) ,    @xmath21",
    "this equation is general as long as @xmath19 , @xmath20 , and @xmath16 are in the same coordinate system ( e.g. , earth mean equator j2000 ) and the object located at ( @xmath19 , @xmath20 ) is infinitely far away . other forms of this equation in the literature assume that we have the angular coordinates of the new origin or that the earth and the new origin are in the same plane ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but we explain in   [ sec : calculating ] why this form is most practical for calculating the delay .",
    "the hjd , which uses the sun as the origin of the new reference frame , is only accurate to 8 s because of the acceleration of the sun due primarily to jupiter and saturn ( fig .",
    "[ fig : bjdvhjd ] ) .",
    "it was popular when people first began considering this effect because it is relatively simple to calculate from tables without a computer @xcite , and remains popular because self - contained algorithms exist to approximate it without any external tables ( e.g. , * ? ? ? * ) .",
    "however , because the hjd is not useful when accuracies of better than 8 s are needed , most of the algorithms in use today use approximations that are only precise at the 1 s level , and it becomes impossible to back out the original jd from the hjd unless we know the exact algorithm used .    and the hjd@xmath0  for a maximally - affected object on the ecliptic .",
    "the primary periodicity is due to jupiter and the secondary periodicity is due to saturn.,width=312 ]    because of these problems , the hjd was formally deprecated by international astronomical union ( iau ) resolution a4 in 1991 , in favor of the bjd , a time referenced to the solar system barycenter ( ssb ) .    the analogous correction to the rmer delay in our solar system",
    "can also be significant in the target system .",
    "we refer to this as @xmath11 . for example",
    ", for transiting planets with @xmath22 au , @xmath11 can be as large as 30 s. in general , the position of the planet during primary transit has become the unspoken standard reference frame for transiting planets , while the host star s photosphere is the unspoken standard for radial velocity ( rv ) planets .    in theory , the timing would be much more stable in the target s barycentric reference frame , but the accuracy with which we can convert to this frame depends on the measurements of the system . since different observers may use different values as measurements improve , quoting the jd in the frame of the target s barycenter may obfuscate the long term reliability of timing .",
    "therefore , we argue it is better to quote julian date in the ssb reference frame , and correct for @xmath11 only when comparing observations at different phases in the planet s orbit .",
    "this @xmath11 correction is not necessary for ttvs of the primary transit , since the planet is always in the same phase .",
    "nevertheless , we should explicitly state the object s reference frame to avoid any potential ambiguity , particularly when comparing any combination of primary transits , secondary transits , rvs , and another primary transit of a different planet in the same system , when it may not be obvious which origin is being used .    for rv measurements , which are taken at many different phases ,",
    "the effect is much smaller and can generally be ignored because the star s orbit around the barycenter is small . for a typical hot jupiter , ( i.e. , a jupiter mass planet in a 3 day orbit around a solar mass star ) ,",
    "the maximum time difference in the rv signal ( for an edge - on orbit ) is 20 ms , which would change the measured rv by @xmath23 m s@xmath24 .",
    "while planets farther out will cause a larger timing offset , the difference in the measured rv is even smaller .      to be clear",
    ", the jd can be specified in many time standards @xcite , and while the iau has made no explicit statement regarding the allowed time standards of the gjd , hjd , or bjd , their meaning in any given time standard is unambiguous .",
    "unfortunately , they have been specified in many standards , usually implicitly",
    ".    however , the particular time standard used affects how useful the time stamp is as an absolute reference . we must be careful not to directly compare bjds or hjds in different time standards , as each has different offsets , periodic terms , and/or rates , which can introduce systematic errors of over 1 minute .",
    "for this reason , it is critical that any stated bjd or hjd also specify the time standard used when one - minute accuracies are important , and the uncertainty of a time that is quoted without a standard should be assumed to be at least 1 minute .",
    "first , it may be useful to summarize the relevant standards of time :    universal time , ut1 : :     defined by the mean solar day , and so drifts forward and backward    with the speeding and slowing of the earth s rotation .",
    "generally , it    slows due to the tidal braking of the moon , though changes in the    earth s moment of inertia and complex tidal interactions make its    exact behavior unpredictable .",
    "it is rarely used directly in astronomy    as a time reference , but we mention it for context .",
    "international atomic time , tai : :     based on an average of atomic clocks all corrected to run at the    rate at the geoid at 0 k , with 1 s equal to `` 9,192,631,770 periods of    the radiation corresponding to the transition between the two    hyperfine levels of the ground state of the caesium 133 atom , '' as    defined by resolution 1 of the thirteenth meeting of the confrence    gnrale des poids et mesures ( cgpm ) in 1967 .",
    "this definition is based    on the duration of the ephemeris time second , which was previously    defined as 1/31,556,925.9747 of the tropical year for 1900 january 0    at 12 hours ephemeris time by resolution 9 of the eleventh cgpm in    1960 .",
    "tai is the fundamental basis for many other time standards , and    is the default time standard of the sloan digital sky survey .",
    "coordinated universal time , utc : :     runs at the same rate as tai , except that it is not allowed to    differ from ut1 by more than 0.9 s. every 6 months , at the end of 31    december and 30 june , the international earth rotation and reference    systems service ( iers ) may elect to    add ( or subtract ) a leap second to utc in order to keep it within 0.9    s of ut1 .",
    "utc is therefore discontinuous and drifts relative to tai    with the addition of each leap second , which occur roughly once per    year . as of january 2009 , the current number of leap seconds ,    @xmath25 , is 34 .",
    "the full table of leap seconds is available    online and is typically updated several months in advance of when an    additional leap second is to be added .",
    "utc is the current    international standard for broadcasting time . as a result ,",
    "when a    modern , network - connected computer s clock is synchronized to a    network time protocol ( ntp ) server , it will be in utc .",
    "thus , this is    the system of time most familiar to astronomers and non - astronomers    alike ( modulo time zones and daylight savings time ) .",
    "universal time , ut : :     an imprecise term , and could mean ut1 , utc , or any of several other    variations .",
    "in general , such imprecise language should be avoided , as    the potential ambiguity is up to 1 s. in the context of a time stamp ,    it is likely utc , but some people may intentionally use ut to imply 1    s accuracy . while explicitness is preferred ( i.e. , utc    @xmath26 1 s ) , any time stamp quoted in ut should be assumed    to be uncertain at the 1 s level unless the time standard has been    independently verified .",
    "terrestrial time , tt(tai ) : :     a simple offset from tai of 32.184 s released in real time from    atomic clocks and never altered .",
    "this offset is to maintain continuity    between it and its predecessor , the ephemeris time ( et ) .",
    "terrestrial time , tt(bipm ) : :     a more precise version of tt(tai ) . the international bureau of    weights and measures ( bipm )",
    "reanalyzes tt(tai ) and computes a more    precise scale to be used for the most demanding timing applications .",
    "the current difference between tt(tai ) and tt(bipm ) is    @xmath27s , and must be interpolated from a table    maintained by the bipm and published online with a 1 month    delay .",
    "terrestrial time , tt : :     sometimes called terrestrial dynamical time ( tdt ) , can refer to    either tt(tai ) or tt(bipm ) . from this point on , we will not make the    distinction , but when accuracies of better than 30 @xmath1s    are required , tt(bipm ) must be used .",
    "barycentric dynamical time , tdb : :     corrects tt for the einstein delay to the geocenter ,    @xmath9 , which is the delay due to time dilation    and gravitational redshift from the motions of the sun and other    bodies in the solar system .",
    "the conversion from tt to tdb can not be    written analytically , but is usually expressed as a high - order series    approximation @xcite . the difference is a predominantly a periodic    correction with a peak - to - peak amplitude of 3.4 ms and a period of 1    yr .",
    "tdb was slightly modified by iau resolution b3 in 2006 , converging    on the same definition as the jpl ephemeris time ,    t@xmath28 , also called coordinate time ( ct ) in    the jpl ephemerides of solar system objects .",
    "barycentric coordinate time , tcb : :     physically and mathematically equivalent to the tdb as defined in    2006 @xcite , and differs only by an offset and rate of about 0.5 s    yr@xmath24 due primarily to time dilation in the sun s    gravitational potential .",
    "tdb and tcb were roughly equal at 1977 jan    1.0 tai , and now differ by about 16 s.    caution must be always be exercised , however , as these definitions are subject to change at any point , though usually with a few year s notice .    assuming the time is measured according to current definition of utc , then the clock correction , from utc to tdb , can be written as the sum of the corrections from utc to tai , tai to tt , and tt to tdb :    @xmath29    of course , if one wishes to express the bjd in another time standard ( or start with something other than utc ) , the clock correction would change accordingly . however , not every time standard is well - suited to precise , astrophysical time stamps , and the use of any time standard other than tdb should be viewed simply as an adequate approximation to tdb .",
    "most readily available programs that calculate the time stamp assume that the user has already applied the utc - to - tt part of this clock correction , which is often not true .",
    "we feel this assumption has contributed the widespread confusion regarding time stamps .",
    "as this last point is our primary motivation for writing this article , we elaborate here on the effects of time standards on the reliability of time stamps . for the sake of simplicity",
    ", we only discuss the effects of time standards on the bjd .",
    "each of these effects also applies to the hjd , though the improvement in accuracy of the time stamp is negligible compared to the accuracy of the hjd reference frame for all but the utc time standard .",
    "the least preferred , though most commonly used , time standard for the bjd is utc ( bjd@xmath5 ) , and is equivalent to ignoring @xmath7 altogether . because utc is discontinuous and drifts with the addition of each leap second ,",
    "comparing two bjd@xmath5  time stamps could result in spurious differences if any leap seconds have been introduced between observations .",
    "therefore , 1 s timing accuracies can not be achieved using the bjd@xmath5  over a span that straddles the addition of one or more leap seconds ( roughly 1 yr ) .",
    "figure [ fig : tdbvutc ] shows the difference between the bjd@xmath5  time stamp with the uniform bjd@xmath0  time stamp ( described below ) from 1961 jan 1 , when utc was defined ( though its definition has evolved over the years ) , to 2010 december 31 , the furthest future date for which the value of utc can be accurately predicted at this writing .    and the bjd@xmath5 .",
    "it shows the discontinuities and slow drift in bjd@xmath5 due to the addition of leap seconds . without correcting for these , relative timing between two reported values of bjd@xmath5",
    "can only be trusted over short time scales.,width=312 ]    bjd in tt ( bjd@xmath14 ) , which is equivalent to ignoring the ( tdb - tt ) term in equation ( [ eq : utc2tdb ] ) , corrects for the discontinuity and drift introduced by leap seconds and is appropriate for timing accurate to 3.4 ms .",
    "bjd in tdb ( bjd@xmath0 ) is usually the best time stamp to use in practice , as it further corrects the bjd@xmath14  for all known effects on the motions , and therefore rates , of our atomic clocks . while bjd@xmath0  is not perfect , any more accurate time stamp is unique for each target .",
    "bjd in tcb ( bjd@xmath30 ) corrects for the gravitational potential , primarily from the sun , which causes the clock to run slower than it otherwise would .",
    "however , if one is concerned about effects of this magnitude , the analogous correction of putting it in the gravitational potential of each observed object is also required .",
    "since these two rates are small ( @xmath31 ) , and opposite in sign , we believe it is best to ignore bjd@xmath30  except perhaps as an intermediate step in calculating the target - specific frame . technically , the use of tcb was recommended by iau resolution b1.3 in 2000 .",
    "however , because of the greater practicality of using tdb ( see   [ sec : calculating ] ) , and the drifting difference between tcb and tdb and tt , we believe its use will only lead to confusion without any foreseeable benefit to the exoplanet community .",
    "the shapiro delay , @xmath32 @xcite , is a general relativistic effect in which light passing near a massive object is delayed . for an object at an angle @xmath33 from the center of the sun ,",
    "the shapiro delay is    @xmath34    this can be as large as 0.1 ms for observations at the limb of the sun , but for objects more than 30@xmath13 from the sun , the correction is less than 20 @xmath1s .",
    "there is also the analogous correction , @xmath32 , for the target system .",
    "similar to @xmath11 , @xmath32 depends on the measurements of the target , which may be refined over time .",
    "therefore , the time should generally be quoted without @xmath32 , but include it when comparing times where this could be significant .      as we discussed in   [ sec : clock ] , relativity dictates that the motion of the observer influences the rate at which the observed clock ticks .",
    "the use of tdb corrects for an observer moving with the geocenter , but in reality we observe from the surface of the earth or from a satellite , for which there is an additional term to @xmath9 :    @xmath35    here , @xmath36 is the location of the observer with respect to the geocenter , and @xmath37 is the velocity of the geocenter .",
    "again , there is an analogous correction , @xmath38 , for the target system , which should be ignored when quoting the time but included when comparing times if necessary .",
    "of course , the accuracy of the output time stamp is only as good as our assumptions and the inputs needed to specify the time standard and reference frame .",
    "here we discuss their effects on the accuracy of the time stamps .",
    "the first four subsections , through  [ sec : planewave ] , have no reasonable upper bound . in each case , the accuracy of the inputs must be evaluated depending on the accuracy of time stamp required .",
    "the later three subsections through  [ sec : double ] are organized in decreasing magnitude , all of which can be ignored for accuracies no better than 21.3 ms . finally , ",
    "[ sec : negligible ] discusses effects of less than 1 @xmath1s that we have ignored .",
    "an error of 1 in the position of the target amounts to a timing error of as much as 0.28 s in the bjd ( fig .",
    "[ fig : bjdra ] ) .",
    "such error would be common if the coordinates of the field center are used instead of the specific object s coordinates . in particular , if doing a survey , one may wish to assign the same bjd to all objects in a given frame .",
    "however , with a 10@xmath13 offset , which is possible with some wide - field transit surveys , the error can be as large as 200 s for objects at the edge of the field .",
    "an error of 0.25  will yield 1 ms timing offsets , and 0.25 mas accuracy is necessary for 1 @xmath1s timing .",
    "calculated for an object at r.a .",
    "= 0@xmath39 and an object at r.a .",
    "= 0@xmath39 0@xmath40 4@xmath41 observed at the same time .",
    "this difference is as large as 200 s for a 10@xmath13 offset.,width=312 ]      the accuracy of a typical computer clock depends on its intrinsic stability , the computer workload , its operating system , and the reliability of the network connection .",
    "older computers with a parallel port ccd interface may produce unreliable timing because the clock may slow or stop completely during ccd readout .",
    "without any special effort , a modern windows machine with a network connection is accurate to @xmath42 seconds , and with third - party software like dimension 4 , we have found it to be stable to 0.1 s. an ntp - synchronized linux machine is typically accurate to @xmath43 ms .    of course , the stability of the clock only sets a lower limit on the absolute accuracy of the time recorded in the fits image header .",
    "ntp synchronization attempts to measure and compensate for network latency , but the accuracy of time stamps also depends on the particular software package taking the image and the hardware it uses , which is difficult to calibrate . unless independently verified , the time recorded in image headers should not be trusted to better than 0.25 s. however , various solutions exist for higher precision timing , such as gps - triggered shutters .    in particular , it is worth emphasizing the 1 s error in the _ hubble space telescope _ ( hst ) clock and potential 6.5 s error in the kepler clock , described in more detail in the appendix , both of which have already achieved data - limited transit timing precisions of that order ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "when calculating the time of exposure of an image , we typically use the time at midexposure . however , the precise time of exposure that should be used is the flux - weighted mean time of exposure .",
    "the magnitude of this error depends on the intrinsic stability of source , the stability of the atmosphere , and the exposure time . in the diabolical case of a cloud completely covering the object during one half of the exposure",
    ", the error could be as large as half the exposure time . for a typical hot jupiter that dims by 1% over the course of a 15 minute ingress ,",
    "the error introduced into the time stamp during ingress or egress by using the mid exposure time is 0.25% of the exposure time ",
    "150 ms for a 1 minute exposure .",
    "near the peak of some high - magnification microlensing events ( i.e. , * ? ? ?",
    "* ) , the flux may double in as little as 6 minutes . during such instances , using the mid exposure time will result in a time stamp error of as much as 1/4 of the exposure time ",
    "15 s for a 1 minute exposure .",
    "equation ( [ eq : roemer ] ) assumes the object is infinitely far away , and therefore the incoming wavefronts are plane waves .",
    "in reality , the wavefronts are spherical , which introduces a distance - dependent , systematic error .",
    "the maximum error introduced by the plane - wave approximation is 1000 s for the moon , 100 s for the main asteroid belt , 5 s for the kuiper belt , 1 ms at the distance of proxima centauri , and 150 ns at the distance to the galactic center .    the fully precise equation , assuming spherical wavefronts , is    @xmath44    where @xmath45 is the distance from the observer to the target . in such instances ,",
    "the distances must be derived from precise ephemerides for both the target and observer .",
    "although this form is generally applicable , it is not generally practical because at large distances , double precision floating point arithmetic can not reliably recover the small difference between @xmath46 ( the distance from the barycenter to the target ) and @xmath45 .    to solve this problem , the pulsar community ( e.g. , * ? ? ?",
    "* ) uses the two - term taylor expansion of equation ( [ eq : exactroemer ] ) about @xmath47 :    @xmath48    one may recognize the first term as plane wave approximation ( eq . [ [ eq : roemer ] ] ) . in practice , the accuracy of this two - term approximation exceeds the accuracy of the `` exact '' calculation using double precision at a distance of 10,000 au ( 0.05 pc ) . at the distance of proxima centauri ,",
    "the accuracy of this approximation is at worst 1 ns .",
    "however , this taylor expansion is divergent when @xmath49 .",
    "it should never be used for objects inside 1 au and may still be inadequate for other objects inside the solar system .",
    "it has a maximum error of 1 day for the moon , 20 s for the main asteroid belt , and 40 ms for the kuiper belt . in these cases , using the exact formula ( eq . [ [ eq : exactroemer ] ] ) may be easiest .",
    "therefore , we recommend that for precise calculations of any solar system body , equation ( [ eq : exactroemer ] ) should be used . for better than 1 ms timing of any object outside the solar system , equation ( [ eq : roemercorr ] ) should be used .",
    "most readily available time stamp calculators use the position of the geocenter , rather than the location of the observer on the surface of the earth . neglecting the light - travel time from the surface of the earth to the center introduces a 21.3 ms amplitude variation with a period of 1 sidereal day . in practice",
    ", most observers can only observe their targets at night , creating a systematic bias of between 8 ms and 21.3 ms ( fig .",
    "[ fig : geocenter ] ) .",
    "calculated at the geocenter and at the precise location of the observer on the surface of the earth . while geometrically , this effect will oscillate between @xmath50 ms with a period of 1 sidereal day , we exclude points when the sun is above -12@xmath13 and object is at @xmath51 , which introduces a large observational bias.,width=312 ]      usually , when people calculate the bjd@xmath5 , they neglect @xmath7 , and input jd@xmath5  for algorithms designed to take jd@xmath14 .",
    "this effectively uses the positions of the earth , sun , and planets offset in time by 32.184 +",
    "n s to calculate the correction . when the bjd@xmath5  is calculated in this manner , we denote it as bjd@xmath52 . the correct way to calculate the",
    "bjd@xmath5  would be to first calculate the bjd@xmath0 , then subtract the @xmath7 correction  is a poor approximation to bjd@xmath0  and should not be used . ] .",
    "figure [ fig : utcvutc ] shows , for a maximally affected object on the ecliptic , an example of the difference between the bjd@xmath52  and the fully correct bjd@xmath5 .",
    "fortunately , this amounts to at most a 13.4 ms difference ( though growing with the utc - tt difference ) , which is below the precision of most clocks and the geocentric correction that is usually ignored .",
    "therefore , to an accuracy of @xmath43 ms , one can safely say bjd@xmath0@xmath53",
    "bjd@xmath14@xmath53 bjd@xmath52@xmath54 , making it easy to convert currently published values of bjd@xmath52  to the superior bjd@xmath0 .    and the commonly calculated bjd@xmath52  using the positions of the earth , planets , and sun delayed by 32.184 + n",
    "s. it shows that the difference can safely be ignored for @xmath55 ms precision , and therefore the approximate bjd@xmath14  or bjd@xmath0  can be recovered from currently published bjd@xmath5  simply by adding 32.184 + n s.,width=312 ]      representing jd as a double precision floating - point number limits the accuracy to about 1 ms , and any operation done on the full jds will be even less accurate .",
    "many programs require the use of a reduced or modified julian date , and/or can return the jd to bjd offset in seconds , but care must be taken at every step of the way never to store the full jd as a double precision number if 1 ms precision is required .",
    "the shapiro delay occurs for other bodies as well , but observations at the limb of jupiter only delay light by 200 ns .",
    "typical modern , commercial gps units use the world geodetic system ( wgs84 ) , which is referenced to the international terrestrial reference system ( itrs ) with an error of about 15 m , which amounts to a 50 ns error in the time stamp .",
    "the index of refraction of the atmosphere is not exactly 1 and changes with its composition , temperature , and pressure , which changes the speed of light .",
    "however , the largest reasonable deviation due to this effect is only tens of ns .",
    "the pulsar community must specify a frequency - dependent dispersion measure delay . at radio wavelengths ( 21 cm )",
    ", the delay can be as much as 1 s , but the dispersion delay contributes at less than 1 @xmath1s shortward of @xmath57 m .",
    "the most practical way to precisely calculate the bjd@xmath0  time stamp is using jpl s de405 ephemeris .",
    "it contains the position of thousands of bodies in the solar system , including the sun , planets , spacecraft , moons , asteroids , and comets .",
    "it is oriented to the international celestial reference frame ( icrf ) , which is consistent with the fk5 system at j2000.0 within the 50 mas error of fk5 , and has its origin at the ssb with its axes fixed with respect to extragalactic objects @xcite .",
    "therefore , it is recommended to use the 3-space cartesian coordinates retrieved from the jpl de405 ephemeris directly with the j2000 object coordinates in equation ( [ eq : roemer ] ) .",
    "the following is an outline of the steps required to properly calculate the bjd@xmath0 .    1 .",
    "calculate the midexposure time in jd@xmath5 .",
    "most fits image headers give date - obs in utc at the beginning of exposure .",
    "if high precision is required ( @xmath58 s ) , read the caveats about clock precision in   [ sec : clockacc ] carefully ; depending on the sky conditions or variability of the object , one may need to account for the flux - weighted mean time of exposure .",
    "2 .   convert the midexposure time to jd@xmath0  by applying @xmath7 ( eq . [ [ eq : utc2tdb ] ] ) . for times accurate to 3.4 ms , one can use the simpler jd@xmath14  and calculate bjd@xmath59  ( using the positions of planets delayed by the tt - tdb offset ) . the difference between bjd@xmath59  and bjd@xmath14",
    "is no more than @xmath10 200 ns , which is well below the precision of the bjd@xmath14 .",
    "if better than 30 @xmath1s precision is required , the tt(bipm ) - tt(tai ) offset must be applied .",
    "3 .   retrieve the jpl ephemeris of the observing station for the times spanning the observing window .",
    "jpl s horizons system is designed for this . to return inputs for use with equation ( [ eq : roemer ] ) and j2000 target",
    "coordinates : select `` vector table '' , the ssb as the coordinate origin , and `` earth mean equator and equinox of reference epoch '' for the reference plane .",
    "this will return the cartesian coordinates of the observing station with respect to the ssb in the j2000 earth mean equator reference frame at steps as small as 1 minute in ct , which is the same as tdb .",
    "if the observing station is on earth and better than 20 ms timing is required , another ephemeris must be generated ( from horizons ) for the observer s position with respect to the non - rotating geocenter , and added to the geocentric positions .",
    "we note that the precise conversion from latitude , longitude , and elevation to the cartesian coordinates with respect to the non - rotating geocenter is not trivial , and requires tables of measured precession and nutation of the earth .",
    "interpolate the positions of the observing station to each midexposure time jd@xmath0 .",
    "input the interpolated x , y , and z positions of the observing station , and the target s j2000 earth mean equator coordinates into equation ( [ eq : roemer ] ) . depending on the distance to the target and the precision required , equation ( [ eq : exactroemer ] ) ( and the target s ephemeris ) or equation ( [ eq : roemercorr ] ) may be required",
    ". one must be careful to use sufficiently accurate target coordinates . 7 .",
    "if greater than 0.1 ms precision is required , apply the shapiro correction ( equation [ [ eq : shapiro ] ] ) .",
    "an ephemeris of the sun is required , which can be generated from horizons .",
    "if greater than 1 @xmath1s precision is required , apply the additional einstein correction for the observing station s position with respect to the geocenter .",
    "the geocentric velocity is required , which can also be given by horizons .",
    "our idl code implementing this procedure is available online .",
    "it requires the jd@xmath5  at midexposure and target coordinates ( @xmath19 , @xmath20 ) in j2000 as inputs .",
    "we outline its procedure here .",
    "more explicit details , as well as the calling procedure and dependencies , are commented inside the code .",
    "we compute @xmath7 using craig markwardt s tai_utc program to read the leap second table , and his tdb2tdt program to compute the tt - tdb correction , which uses a 791-term fairhead and bretagnon analytical approximation to the full numerical integration , with an error of 23 ns @xcite .",
    "our code will automatically update its leap second table the first time it runs after every january 1 or july 1 , but this requires a periodic internet connection and the use of the wget program .",
    "it will terminate on failure to update , but this protection can be bypassed for those that elect to ( or have to ) update their table by hand .    by default , we ignore the @xmath27s tt(bipm ) - tt(tai ) correction , which would require a constant internet connection , would not apply to data acquired in the previous month , and is likely negligible for most applications .",
    "however , our code can optionally correct for it if an up - to - date file is supplied .    to read and interpolate the ephemeris from jpl , we use craig markwardt s routines jplephread and jplephinterp for the earth , sun , and other planets .",
    "if the observing station is space - borne , the smaller ephemeris used with those programs does not include satellites , so we use an expect script to automate a telnet session to the horizons system and automatically retrieve the ephemeris , which we quadratically interpolate to the desired times using idl s interpol .",
    "the accuracy of this interpolation depends on how quickly the object s position is changing and the step size of the ephemeris .",
    "horizons can only return @xmath60 data points per query , so the smallest step size ( 1 minute ) limits the calculation to a range of 60 days . for the geocenter ,",
    "a 100 minute step size is sufficient for 60 ns accuracy , but , for example , a 2 minute step size is required for 1 @xmath1s accuracy for the _ hst _ ( though it is still limited by its clock accuracy ) .",
    "we have found that a 10 minute step size is adequate for 1 ms timing for most objects and allows a range of nearly 2 yr .",
    "if the observer is on the earth , and the coordinates ( latitude , longitude , and elevation ) are given , we correct for the additional delay . if no observer - specific information is given , we assume the observer is at the geocenter , and the result will be biased by @xmath61 ms ( fig . [",
    "fig : geocenter ] ) .    if the target s ephemeris can be returned by horizons and its unique name",
    "is given , we use our expect script to generate its ephemeris too , and calculate the exact @xmath6 ( eq .",
    "[ [ eq : exactroemer ] ] ) .",
    "if not , and instead the distance is given , we use the two - term approximation to the spherical wave solution ( eq . [ [ eq : roemercorr ] ] ) .",
    "otherwise , we use the plane wave approximation ( eq . [ [ eq : roemer ] ] ) .",
    "lastly , we include the shapiro correction and the additional einstein correction due to the position of the observer with respect to the geocenter , either from the surface of the earth ( if given the coordinates ) , or the spacecraft .    in the geocentric case , our code agrees with barycen to 200 ns ( peak to peak ) and the authors of barycen report that their code agrees with fxbary to 1 @xmath1s .",
    "the ephemeris we generate for a location on the surface of the earth agrees with horizons to 20 nano - lt - s , and the geocentric bjds we calculate from horizons ephemeris agree with the bjds we calculate using craig markwardt s routines within 10 ns .",
    "the near - exact agreements between these methods is not surprising , and do not necessarily indicate that they are accurate to better than 1 @xmath1s .",
    "our code was inspired by barycen and both rely on craig markwardt s routines ( the difference comes from the fact that we index the jpl ephemeris with jd@xmath0  instead of jd@xmath14 ) , and all methods use jpl s de405 ephemeris .",
    "the primary advantage of our code is that it includes the jd@xmath5  to jd@xmath14  correction ( but can optionally ignore it ) .",
    "the choice of starting with jd@xmath5  is a departure from what is typically done with such time stamp calculators , but we feel this is a far more robust starting point . the current confusion has shown that many assume jd@xmath5  as the starting point , which is likely due to a lack of explicitness in the programs and/or unfamiliarity with various time standards .",
    "our hope is that people are unlikely to make the opposite mistake ( assume the input should be jd@xmath14  instead of jd@xmath5 ) since our code is very explicit and calculating the jd@xmath5  is almost always a trivial calculation from the date - obs fits header keyword .",
    "additionally , our code can easily correct for the observer s position on the earth or from a spacecraft , and can include the spherical wave correction .    in order to schedule observations ,",
    "even @xmath26 10 minute precision is generally good enough , and one can approximate bjd@xmath0  @xmath53 jd@xmath5 ; for more demanding observing schedules , we provide software to iteratively calculate the reverse correction .    along with the idl source code",
    ", we provide a web - based interface to our codes , though not every feature is enabled .",
    "specifically , it is limited to 1 ms precision , can only do one target at a time , only does the plane wave approximation , and is limited to 10,000 jds at a time .",
    "those with applications for which these features are too limited should download our source code and run it locally .",
    "timing of transient events is a powerful tool for characterizing many astronomical phenomena . in the field of exoplanets in particular ,",
    "the search for variations in the times of primary transits and secondary eclipses , or transit timing variations , is one of the most promising new techniques for studying planetary systems .    the accuracy with which transit times , and indeed any transient phenomenon , can be measured is limited not only by the data themselves , but by the time stamp to which the transit time is referenced .",
    "as the quality of transit timing data crosses the threshold of 1 minute precision , the precise time standard and reference frame in which event times are quoted becomes important .",
    "achieving uniform and accurate time stamps with accuracies of better than 1 minute that can reliably be compared to one another requires extraordinary care in both our techniques and our terminology .",
    "we have found that the time standards adopted by various groups that measure transit times can differ by as much as a minute , and are typically left unspecified . as these ambiguities can be significant compared to the timing precisions that are quoted",
    ", they may therefore lead to spurious detections of transit timing variations or biased eccentricity measurements .",
    "here we have summarized the effects one must consider in order to achieve timing precision of 1 @xmath1s .",
    "we argue that the bjd@xmath0  is nearly the ideal time stamp , being as reliable as any time stamp can be without being unique to each target system . on the other hand , bjd@xmath5  and the hjd in any form should be avoided whenever possible .",
    "most importantly , we emphasize that the time standard should always be explicitly stated .",
    "any time stamp that is quoted without a time standard should be assumed to be uncertain to at least 1 minute . unless the time standards used in programs or algorithms have been independently confirmed",
    ", one should avoid using ones that do not precisely specify the input and output time standard .",
    "in addition , the arrival time at the observing site along with its time standard ( e.g. , jd@xmath5 ) should also be specified .",
    "this will remove any ambiguity in the time stamp , allow others to apply improved corrections should more precise ephemerides become available in the future , and allow others to check that original conversion was done accurately enough for their purpose .",
    "finally , we have written an idl program for general use that facilitates the use of bjd@xmath0  to an accuracy of 1 @xmath1s , provided that the inputs are sufficiently precise , and we provide a web - based interface to its most useful features .",
    "we would like to thank craig markwardt for his fundamental routines that make ours possible , the help desks at the various space telescopes and at iers for answering our questions , the anonymous referee , steve allen , richard pogge , joseph harrington , roberto assef , andrew becker , mercedes lopez - morales , christopher campo , drake deming , ryan hardy , heather knutson , eric agol , and joshua winn for useful discussions , and wayne landsman and jrn wilms for managing the idl astronomy libraries .",
    "we looked in detail at several readily available tools for the bjd / hjd calculation , and have been in contact with many people in the exoplanet community and the help desks for several major space telescopes .",
    "we summarize our findings here to demonstrate how easily errors of up to 1 minute can be introduced and to stress the importance of specifying the time precisely .",
    "we caution the reader not to trust our general findings for specific cases , but always to confirm what has been done in each case where 1 minute timing accuracy is required but the time standard has not been specified explicitly .",
    "ground - based observers have typically used one of the following methods to calculate the bjd",
    ". however , most fits image headers give the date - obs and time - obs keywords in utc .",
    "we have found that most people , when starting with jd@xmath5  end up quoting hjd@xmath52  or bjd@xmath52 .",
    "jpl s horizons ephemeris calculator , which is used by many to calculate the bjds from space telescopes , and can be used to calculate ground - based bjds , returns the time in jd@xmath62= t@xmath28= jd@xmath0when the ephemeris type is `` vector table '' .",
    "any conversion that uses a horizons ephemeris in jd@xmath0  but indexes it with jd@xmath5 , as had been done by several people we spoke with , will calculate bjd@xmath52 , which can be offset from the true bjd@xmath5  by up to 13.4 ms ( as shown in fig .",
    "[ fig : utcvutc ] ) , and offset from the uniform bjd@xmath0  by more than 1 minute ( as shown in fig .",
    "[ fig : tdbvutc ] ) .",
    "iraf s setjd calculates the hjd , but calls for ut , which is likely to be interpreted as jd@xmath5 . in this case",
    ", it would calculate the drifting quantity hjd@xmath52 .",
    "if tt were used instead , it would calculate the hjd@xmath14 , accurate to @xmath108 s.      the idl routines helio_jd ( for hjd ) , from the idl astronomy library curated by wayne landsman , and barycen ( for bjd ) , from the institut fr astronomie und astrophysik idl library , maintained by jrn wilms , both call for the gjd , which , we remind the reader , can be specified in any time standard .",
    "often , this is interpreted as jd@xmath5 , in which case they would calculate hjd@xmath52  or bjd@xmath52 , respectively . if tt were used , they would calculate the hjd@xmath14 , accurate to @xmath108 s , or bjd@xmath0 , accurate to the geocentric correction ( 21.3 ms ) .",
    "nasa s high energy astrophysics science archive research center ( heasarc ) created the tools fxbary and later the improved version faxbary , both of which call axbary to calculate the bjd .",
    "their documentation is precise and correct , but quite long and may be difficult for the uninitiated to follow .",
    "therefore , it would not be surprising for users of axbary to input either utc or tt , in which case they could generate either the bjd@xmath52  to the accuracy of the leap seconds or the bjd@xmath0  to the accuracy of the geocentric correction ( 21.3 ms ) .      currently , common google results turn up various applets , spreadsheets , programs , or algorithms to calculate the hjd that explicitly call for jd@xmath5  or jd@xmath63  as an input . unless explicitly mentioned otherwise , it is usually safe to assume the time standard used as input will be the time standard used throughout their calculation .",
    "thus , these algorithms and applets will very likely calculate hjd@xmath52 .",
    "however , they are perfectly capable of calculating hjd@xmath14  if given jd@xmath14  as an input .",
    "epoxi has the mid - exposure time bjd@xmath0  in the header for the intended pointing under the fits header keyword kpkssbjt .",
    "this can be used directly , as long as one is careful about the intended target , so it would be very surprising if a bjd from epoxi was not bjd@xmath0 .",
    "we recalculated the bjd@xmath0  using the horizons ephemeris as described in ",
    "[ sec : calculating ] and an example fits header given to us by the epoxi help desk .",
    "in their example fits header , they pointed at the moon , which is not infinitely far away , so we must use equation [ eq : exactroemer ] for @xmath6 . with this method , we agree with the kpkssbjt header value to @xmath64 ms , the limit of the precision of the keyword .",
    "we also redid the bjd@xmath0  calculation of hat - p-4b as described in the _ report on the calibration of epoxi spacecraft timing and reduction to barycentric julian date _ of august 2009 by hewagama et al .. we find agreement with the quoted kpkssbjt fits header keyword to 47 ms . while this is much better than the 0.41 s difference calculated by hewagama et al .",
    "( a difference they attribute to `` cumulative rounding limits '' in their method ) , we believe our method to be far more precise .",
    "however , we could not obtain access to the original headers and were unable to determine the source of the discrepancy .",
    "given the very good agreement with the calculation of the moon above , our best guess is that the target coordinates used by the epoxi pipeline differed from the published values for hat - p-4b .",
    "the 47 ms difference could be explained by a @xmath65 discrepancy in r.a .",
    ", a @xmath66 discrepancy in declination , or some combination thereof .",
    "chandra stores their date - obs keyword in tt .",
    "their more precise tstart and tstop keywords are expressed in seconds after 1998 jan 1 , 00:00:00 tt .",
    "this departs from what is typically done , which may lead to confusion , but it makes the conversion to a uniform time stamp much more straightforward and less likely to drift by the leap seconds .",
    "they provide extensive directions online to calculate the bjd@xmath0  using axbary , so it is likely that anyone using chandra who quotes a bjd is using bjd@xmath0 .",
    "the fits headers of _ hst _ state that their date - obs and time - obs keywords are ut . we contacted the _ hst _",
    "help desk for clarification , since ut is ambiguous .",
    "help desk response stated that their clock reports utc accurate to @xmath1010 ms , but `` due to variabilities and quantization in the particular science instruments operations , the actual time light begins falling on the detector is not known to better than about @xmath101 second , @xmath26 50% ( rough estimate ) . ''",
    "it is possible for the hst engineering team to calibrate these variations , but they have limited resources and have no plans to do so .",
    "it is thought that this error is some combination of random and systematic errors , but the precise breakdown is unknown .",
    "this potential @xmath101 s systematic error may have important implications for the reliability of the transit times quoted with hst observations , most importantly , the 3 s error of the transit time of hd189733b @xcite .",
    "hst does not calculate the hjd or bjd at any point , leaving the calculation up to each individual observer .",
    "our experience with ground based observers suggests that most people will end up quoting an hjd@xmath52  or bjd@xmath52 .",
    "the kepler data release notes 2 describe how to calculate the bjd from utc , but do not include the correction to tdb .",
    "they mention the horizons ephemeris , but neglect to mention that its output time is in ct , not utc ; thus it appears they calculate bjd@xmath52 , though we were unable to confirm this .",
    "in addition , the time stamp uncertainty may be much larger than typical , so it is worth quoting from the kepler data release notes 5 ( released 2010 june 4 ) : the advice of the dawg [ data analysis working group ] is not to consider as scientifically significant relative timing variations less than the read time ( 0.5 s ) or absolute timing accuracy better than one frame time ( 6.5 s ) until such time as the stability and accuracy of time stamps can be documented to near the theoretical limit .",
    "the _ spitzer _ pipeline calculates the hjd@xmath5  for the intended pointing ( presumably the target ) at the end of the exposure , subtracts the full exposure time , and records the result in the header as hjd .",
    "depending on the exposure time , this will produce roughly a 10 ms effect similar to that shown in figure [ fig : utcvutc ] , and depending on how close the intended pointing was to the object of interest , may produce a @xmath67 s effect similar to figure [ fig : bjdra ] . however , this effect is negligible compared to both the @xmath108 s accuracy of the hjd ( fig .",
    "[ fig : bjdvhjd ] ) and the number of leap seconds that may have elapsed between observations ( fig .",
    "[ fig : tdbvutc ] ) .",
    "one typically quotes the hjd at the midexposure time . since _",
    "spitzer _ quotes the hjd@xmath5  at the beginning of the exposure , using the unmodified _ spitzer _ hjds would produce a systematic offset of half the exposure time , though experienced observers correct for this .    also contributing to this confusion",
    ", the fits header keyword utcs_obs is incorrectly documented . while the documentation states that it is seconds after j2000 et , it is actually seconds after january 1st , 2000 12:00 utc + @xmath25 - 32 .",
    "therefore , trusting the documentation as is will unwittingly lead to a difference of @xmath68 s."
  ],
  "abstract_text": [
    "<S> as the quality and quantity of astrophysical data continue to improve , the precision with which certain astrophysical events can be timed becomes limited not by the data themselves , but by the manner , standard , and uniformity with which time itself is referenced . while some areas of astronomy ( most notably pulsar studies ) have required absolute time stamps with precisions of considerably better than 1 minute for many decades , recently new areas have crossed into this regime . in particular , in the exoplanet community , we have found that the ( typically unspecified ) time standards adopted by various groups can differ by as much as a minute . </S>",
    "<S> left uncorrected , this ambiguity may be mistaken for transit timing variations and bias eccentricity measurements . </S>",
    "<S> we argue that , since the commonly - used julian date , as well as its heliocentric and barycentric counterparts , can be specified in several time standards , it is imperative that their time standards always be reported when accuracies of 1 minute are required . </S>",
    "<S> we summarize the rationale behind our recommendation to quote the site arrival time , in addition to using bjd@xmath0 , the barycentric julian date in the barycentric dynamical time standard for any astrophysical event . </S>",
    "<S> the bjd@xmath0is the most practical absolute time stamp for extra - terrestrial phenomena , and is ultimately limited by the properties of the target system . we compile a general summary of factors that must be considered in order to achieve timing precisions ranging from 15 minutes to 1 @xmath1s . </S>",
    "<S> finally , we provide software tools that , in principal , allow one to calculate bjd@xmath0  to a precision of 1 @xmath1s for any target from anywhere on earth or from any spacecraft . </S>"
  ]
}