{
  "article_text": [
    "the choice of a coordinate system is mandatory when finding solutions of einstein s field equations . in the 3 + 1 approach  @xcite",
    ", this choice can be made in two steps :    * the choice of a time coordinate . in geometrical terms , this amounts to select a specific foliation of spacetime by a family of spacelike hypersurfaces ( the constant time slices ) . *",
    "the choice of the space coordinates . in geometrical terms , this amounts to select a specific congruence of lines threading every slice of the time foliation ( the time lines ) .",
    "most of the theoretical developments in the 3 + 1 approach are space - invariant , that is independent of the choice of the space coordinates . in this case",
    ", one can safely select as time lines precisely the normal lines to the time slices ( normal coordinates ) , as we will do in what follows . in local adapted coordinates , we will write then the line element as @xmath0    the choice of a time coordinate , however , is not so simple . in numerical simulations one must care about physical singularities that could arise dynamically in gravitational collapse scenarios .",
    "care must be taken to avoid the time slices to hit the singularity in a finite amount of coordinate time : otherwise the numerical code will crash due to the singular terms .",
    "this is why singularity avoidant slicing conditions are widely used in numerical relativity .",
    "a first example is provided by the maximal slicing condition , @xmath1 where @xmath2 is the extrinsic curvature tensor of the time slices .",
    "maximal slicing has been successfully used in black hole simulations since the early times  @xcite .",
    "the behavior of maximal slicing in simple cases has been studied for more than thirty years  @xcite and is still being studied today  @xcite .",
    "the problem with maximal slicing is that it leads to a second order elliptic equation for the lapse function @xmath3 .",
    "this can be a complication in the current 3d simulations , where the need of accuracy is consuming all the available computational resources .",
    "but this is also a complication from the theoretical point of view , because the resulting evolution system ( field equations plus coordinate conditions ) is then of a mixed elliptic - hyperbolic type .",
    "a simpler alternative is provided by the generalized harmonic condition  @xcite @xmath4 where @xmath5 can be an arbitrary function of @xmath3 ( @xmath6 in the original harmonic slicing  @xcite ) .",
    "it provides a first order evolution equation for the lapse function which , when combined with the field equations , leads to a hyperbolic evolution system ( weakly hyperbolic or strongly hyperbolic , depending on the formulation ) for non - negative choices of @xmath5 .",
    "the problem with condition ( [ harmgen ] ) is that it can lead to gauge - related pathologies . in ref .",
    "@xcite , this has been seen to occur in black hole simulations for some particular cases . in ref .",
    "@xcite , the generic case is considered ; starting from an analysis of the characteristic speeds , the conclusion is that there can be two classes of shocks :    * one which affects just the gauge degrees of freedom .",
    "a cure is suggested , consisting in the choice @xmath7 ( @xmath8 being just an integration constant ) . *",
    "another one which affects even the metric degrees of freedom ( with @xmath9 as characteristic speed ) , for which there is no cure .",
    "the claim concerning the existence of gauge shocks has been recently strengthened  @xcite by providing a purely kinematical derivation of the condition ( [ falcub ] ) , independently of the field equations .",
    "these are by no means rhetorical questions .",
    "we are aware that einstein s equations can be used for describing the propagation of discontinuities arising either from the initial or the boundary data .",
    "we are talking here about something stronger : shocks that could arise dynamically even from smooth initial and boundary data .",
    "this is a well known phenomenon in the fluid dynamics domain : the non - linearity of the equations leads in some circumstances to the crossing of the characteristic lines so that a genuine shock ( not just a contact discontinuity ) appears .",
    "can this really happen in general relativity ? . or",
    ", at least , can this happen when using ( [ harmgen ] ) as slicing condition ? .",
    "we think that this is a good opportunity to address these questions and provide , as far as possible , definite answers .",
    "no , there are not metric shocks . to see why ,",
    "let us start with the space - invariant expression of the corresponding characteristic speed ( light speed ) @xmath10 ( length variation per unit coordinate time ) .",
    "we can always consider a geodesic slicing , so that @xmath11 and coordinate time coincides with proper time . in this case , as depicted in fig .",
    "[ slicing ] , the characteristic lines ( light rays ) along any given space direction can not even approach one another .",
    "the question is whether these light rays can cross each other in some alternative slicing . as shown in fig .",
    "[ slicing ] , this can never happen as long as the time slices are spacelike hypersurfaces . without characteristic",
    "crossing , there are not genuine shocks ( although contact discontinuities can appear from initial or boundary data , as discussed in the introduction ) .",
    "einstein s field equations can then be said to be , in the applied mathematics jargon , linearly degenerate .",
    "the case of the gauge degrees of freedom , which are not prescribed by the field equations , will be discussed in the following sections .    but let us look back before at ref .",
    "@xcite , where a coordinate - dependent expression for light speed was used as the starting point .",
    "if we repeat the arguments of ref .",
    "@xcite , but using instead the space - invariant expression ( [ light_speed ] ) as the starting point , we see that the prediction of metric shocks disappears .",
    "the prediction of gauge shocks remains , but condition ( [ falcub ] ) for the proposed cure is to be replaced by @xmath12 which no longer contains the original harmonic slicing ( @xmath6 ) as a particular case .",
    "no , there is no kinematical reason for gauge shocks .",
    "the argument in ref .",
    "@xcite starts from the time - slicing equation @xmath13~\\nabla_\\mu d_\\nu \\phi = 0\\,,\\ ] ] which reduces to the generalized harmonic slicing condition ( [ harmgen ] ) in local adapted coordinates , where @xmath14 the argument proceeds then by transforming the quasilinear second - order equation ( [ time_eq ] ) into a first order system and studying the characteristic speeds , without recourse to the field equations  @xcite .",
    "we will take here a more direct approach , looking for the characteristic hypersurfaces of the original equation ( [ time_eq ] ) . to simplify the analysis",
    ", we will adapt the general coordinates in ( [ time_eq ] ) to the ( generic ) initial data .",
    "starting from a given spacelike slice @xmath15 , we will choose then as initial conditions @xmath16 notice that this is by no means a restriction on the initial data : it is rather the result of adapting the arbitrary spacetime coordinates to any specific choice of initial data .",
    "moreover , this kind of adapted coordinates is precisely the one that is currently used in numerical simulations , where the equation ( [ time_eq ] ) is always used in the form ( [ harmgen ] ) .",
    "it is trivial now to look for the characteristic hypersurfaces .",
    "all second partial derivatives on @xmath15 can be obtained from ( [ initial_phi ] ) with the only exception of the second time derivative , which can be obtained from ( [ time_eq ] ) unless @xmath17 which would then imply that @xmath15 is a characteristic hypersurface .",
    "for any finite choice of @xmath5 , condition ( [ charact ] ) , which can be written in an invariant way as @xmath18 amounts to the statement that @xmath15 is a null hypersurface .",
    "this means that the characteristic speed coincides again with light speed .",
    "it follows that the discussion of the preceding section applies here again to show that there can not be any crossing of characteristics and hence no genuine shocks can develop .    to put it in a different way : equation ( [ time_eq ] ) can always be used for constructing a new foliation in a given ( regular ) spacetime provided that the resulting slices remain spacelike .",
    "then , the time slicing itself will be well defined , although the behavior of the gauge - related dynamical fields may depend on the field equations , as we will see below .",
    "there are certainly gauge pathologies of a dynamical origin , but not genuine shocks . in order to analyze this point",
    ", it is convenient to consider the time derivative of the generalized harmonic slicing condition ( [ harmgen ] ) .",
    "this requires using the field equations to provide the time evolution of @xmath19 ( the arguments in this section will be then of a dynamical nature ) .",
    "we will choose for simplicity the bssn formulation  @xcite , although all the current formalisms share the same physical solutions .",
    "in the vacuum case , we get after some algebra @xmath20\\ , , \\label{alpha_master}\\ ] ] where we have noted for short @xmath21    equation ( [ alpha_master ] ) can be interpreted as a generalized wave equation for the lapse function .",
    "the left - hand - side terms correspond to the principal part , and it is clear that the characteristic speed is given by @xmath22 ( gauge speed ) .",
    "we derived condition ( [ fz ] ) by using precisely ( [ gauge_speed ] ) as the starting point for the argument presented in ref .",
    "@xcite : it amounts to the requirement of a constant gauge speed , that is @xmath23    the right - hand - side terms in ( [ alpha_master ] ) can be interpreted as non - linear source terms for the evolution of the lapse function . allowing for ( [ harmgen ] ) ,",
    "@xmath19 is proportional to the time derivative of @xmath3 , so that there is a non - linear coupling that can lead to runaway ( growing without bound , at an increasing rate ) solutions .",
    "an extreme example of this gauge pathology , in which transport plays not role at all , is provided by space - homogeneous and isotropic solutions , like the ones used in cosmology , where all space derivatives vanish and the extrinsic curvature is proportional to the metric .",
    "one has then @xmath24 so that @xmath3 can grow without bound , with a driving force proportional to the square of the growing rate , unless @xmath25    coming back to the general case , it is clear that condition ( [ vg_constant ] ) could be interpreted in two alternative ways    * ensuring a constant gauge speed , so that no characteristic crossing can occur .",
    "* ensuring the negative sign of the source terms in ( [ alpha_master ] ) , so that no runaway solutions can occur .",
    "this ambiguity follows from the very nature of the argument proposed in ref .",
    "@xcite , where the main idea is to include the source terms in the discussion about the behavior of characteristic fields .",
    "the @xmath26-dependent term in the right - hand - side of ( [ alpha_master ] ) would then be considered as a non - linear contribution to the transport ( left - hand - side ) terms .",
    "but we do not see much difference between this particular quadratic term and the other ones in the right - hand - side of ( [ alpha_master ] ) , independently of their origin .",
    "the example we presented before shows instead how these other source terms actually contribute to the regularity condition ( [ fzz ] ) by providing an upper bound which was missing in ( [ vg_constant ] ) .",
    "our conclusion is that any pathological behavior of the gauge - dependent degrees of freedom , which manifests itself as an unbounded growth of either the lapse function or its first derivatives , can be interpreted consistently as the effect of the non - linear source terms in the evolution equations .",
    "we will test this conclusion against simple numerical black - hole simulations in what follows .",
    "we will focus here on three - dimensional numerical simulations of a spherically symmetric black hole . as far as we are interested in the strong field region ,",
    "the black hole interior is not excised from the numerical grid .",
    "regular initial data are obtained by using a novel free black hole approach , which relies on the well known no hair theorems ( see appendix i for details ) .",
    "this new approach is also being applied independently in the context of the bssn formalism  @xcite .",
    "we will use in our simulations the first order version of the z4 evolution formalism  @xcite in normal coordinates ( zero shift ) . apart from standard centered finite - difference algorithms",
    ", we will use at some point the mmc method .",
    "this is a high - resolution shock - capturing ( hrsc ) method which combines the monotonic - centered ( mc ) flux limiter  @xcite with marquina s flux formula  @xcite ( see appendix ii for details ) .",
    "the use of these advanced hrsc methods is also new in 3d black hole simulations , although it is crucial for our arguments about shocks .",
    "[ b ]    = 8.5 cm    [ gibbs ]    the first stages of the simulation show a collapse of the space volume element which , allowing for the singularity avoidance properties of the gauge conditions ( [ harmgen ] ) , translates itself into a collapse of the lapse function @xmath3 .",
    "this lapse collapse can be slower or faster , depending on our choice of @xmath5 .",
    "we will present here our results for the 1+log case @xmath27 although no qualitative difference is detected for similar choices , like @xmath28 for instance .",
    "[ t ]    [ b ]    = 8.5 cm    let us see what happens after some time .",
    "we see in fig .",
    "[ gibbs ] how high - frequency oscillations start appearing in the regions where the lapse slope is changing more abruptly .",
    "this is a numerical effect : it is the analogous of the well - known gibbs phenomenon , which appears when the tool one is using ( the standard finite difference method in our case ) is unable to resolve the higher frequency modes of some dynamical field .    in order to see where those annoying high - frequency modes came from ,",
    "let us take a look at behavior of the extrinsic curvature , as displayed in fig .",
    "[ stretching ] .",
    "what we see there is the well known slice stretching phenomenon : the black hole is sucking both the numerical grid  @xcite and the space slice  @xcite , producing as a result steep profiles along the radial direction .",
    "high - frequency modes are the expected to appear in the regions with abrupt slope changes in some dynamical field .",
    "the same kind of spurious oscillations currently appears in computational fluid dynamics simulations , in regions where genuine shocks are developing .",
    "the cure is to use advanced hrsc numerical methods that can deal with shocks without altering the monotonicity of the dynamical fields .",
    "we will use in what follows the mmc numerical algorithm , as described in appendix ii , which is one of such hrsc methods .",
    "we are aware that we are not dealing here with real shocks ( the @xmath19 profile in fig .  [ stretching ]",
    "is clearly smooth ) .",
    "we are instead dealing with , let us say , numerical shocks as far as our numerical grid is just unable to resolve the higher frequency modes associated with slice stretching .",
    "the effect of switching to the mmc numerical method is definitive , as it can be seen on fig .",
    "[ smoothed ] .",
    "no trace of the spurious oscillations remains .",
    "there is nothing either in the lapse or in the @xmath19 profiles that could be interpreted as a shock .",
    "the conclusion is obvious : slice stretching does not produce any real shock , it may produce just numerical shocks that disappear when improving the discretization algorithm .",
    "let us see now what happens when allowing our simulations to proceed for a longer time ( about @xmath29 in our case , but the value will depend on the specific gauge choice ) .",
    "we see in fig .  [ rebounding ] that the spurious oscillations do not show up anymore .",
    "what we see instead is a sort of rebound of the lapse , which is the prelude of a blow up that will crash the numerical simulation .",
    "we have stopped the simulation in fig .  [ rebounding ] before the crash occurs , so that two different interpretations can be tentatively considered    * a gauge shock is forming and starts propagating backwards in the region near to @xmath30 . * the growing of the lapse is triggering a runaway solution that will result in a lapse blow up .",
    "[ t ]    = 8.5 cm    in order to discriminate between these two alternatives , let us take a look to fig .",
    "[ rebound ] , where we have plotted the same extrinsic curvature components as in fig .",
    "[ stretching ] . as a word of caution ,",
    "let us remember that the lapse in the innermost region is yet collapsed , so that the dynamics is frozen there .",
    "this means that the features we see in the innermost region in fig .",
    "[ rebound ] correspond to an earlier stage ( measured in proper time ) than what we see around @xmath30 , which is the region we are going to analyze now .",
    "[ t ]    = 8.5 cm    what we see there is just the opposite that what we saw in fig .",
    "[ stretching ] : @xmath19 is now negative , so that we have an overall expansion pattern .",
    "but the radial component ( @xmath31 along the @xmath32 direction ) is collapsing .",
    "this explains why the whole picture in fig .",
    "[ rebounding ] looks like moving backwards in time in the rebounding region .",
    "notice that the @xmath19 profile in fig .",
    "[ rebound ] is clearly smooth and well - resolved in the region around @xmath30 , so that the shock interpretation can be excluded .",
    "moreover , as far as we are using a hrsc numerical method , no blow up would be expected from the presence of shocks . in computational fluid dynamics these methods",
    "are currently used for dealing with genuine shocks without crashing because of that .",
    "the blow up must be actually caused by something much stronger than a mere shock : a runaway solution that is triggered by the negative values of @xmath19 , which correspond to an overall expansion behavior .",
    "the appearance of runaway solutions is to be expected when selecting the 1+log ( [ 1+log ] ) or any similar choice among the singularity - avoidant family of slicing conditions ( [ harmgen ] ) .",
    "if we decompose the extrinsic curvature tensor @xmath33 into its irreducible components @xmath34 ( shear tensor and expansion factor , respectively ) , we see that the source terms in the lapse equation ( [ alpha_master ] ) can be expressed as @xmath35 which can easily get a positive sign in collapsing scenarios ( @xmath3 small ) unless the expansion factor @xmath36 is kept to low values when compared with the shear tensor .",
    "we conclude that runaway solutions , not gauge shocks , can be a real problem in simulations that , like in the black hole cases , make use of the singularity - avoidant slicing conditions ( [ harmgen ] ) . to find a convenient cure for this gauge pathology (",
    "excising the interior region , using a dynamical shift , selecting other values of @xmath5 , and so on ) goes beyond the purpose of this paper .",
    "based in the idea that the interior region of a black hole has no causal physical influence on the exterior one ( no - hair theorems ) , we can devise a simple way of obtaining regular initial data for black hole spacetimes :    * solve the energy and momentum constraints for the initial data .",
    "this currently leads to a singular space metric . *",
    "replace the metric in the interior regions by any smooth extension of the exterior geometry .",
    "energy and momentum constraints will be no longer fulfilled inside the horizons ( free black hole data ) .    in the simplest case",
    ", we can consider time - symmetric vacuum initial data with a conformally flat space metric , that is @xmath37 so that the momentum constraint is trivially satisfied and the energy constraint amounts to require that @xmath38 be an harmonic function of the euclidean metric .    free initial data can be obtained then for a spherically symmetric black hole with mass @xmath39 by starting from the singular conformal factor @xmath40 and replacing its value inside the horizon ( dotted line in fig .  [ matching ] ) by any smooth function ( continuous line in fig .  [ matching ] ) .",
    "[ t ]    in the z4 formalism , energy and momentum constraint violations will cause the growing of the supplementary fields @xmath41 and @xmath42 , which non - zero values correspond to a departure of true einstein s solutions .",
    "but these fields , which are the 3 + 1 components of the four - vector @xmath43 are known to verify  @xcite @xmath44 so that the spurious non - zero values propagate with light speed . the exterior geometry ,",
    "then , can not be affected by constraint violations inside the horizon ( at least not at the continuum level ) .",
    "high - resolution shock - capturing ( hrsc ) numerical methods can be applied to strongly - hyperbolic first - order systems of balance laws .",
    "the balance - law structure means that the evolution equations for the array @xmath45 of dynamical fields can be written as @xmath46 where both the flux @xmath47 and the source @xmath48 terms depend algebraically on the fields , but not on their derivatives : @xmath49 the system ( [ balance_law ] ) will be strongly hyperbolic if and only if for every space direction @xmath50 , the corresponding characteristic matrix @xmath51 has real eigenvalues @xmath52 ( characteristic speeds ) and a complete set @xmath53 of eigenvectors  @xcite .        the balance law form ( [ balance_law ] ) is specially suited for the method - of - lines ( mol ) discretization  @xcite . in this method ,",
    "there is a clear - cut separation between space and time discretization . as a consequence ,",
    "the source terms contribute in a trivial way to the space discretization .",
    "the non - trivial contribution comes instead from the space derivatives of the flux terms , which are usually discretized as follows @xmath54      + \\frac{1}{\\delta y}~[\\textbf{f}^y_{j+1/2}-\\textbf{f}^y_{j-1/2}]\\\\      & + & \\frac{1}{\\delta z}~ [ \\textbf{f}^z_{k+1/2}-\\textbf{f}^z_{k-1/2 } ]      \\,.\\end{aligned}\\ ] ] the half - integer indices correspond to the grid interfaces , which are supposed to be placed halfway between neighboring grid nodes .",
    "every different way of computing the interface fluxes in terms of the values of the fields at the grid nodes will lead to a specific numerical algorithm .",
    "a common feature of all these algorithms is that the information of every grid node is used for providing one - sided predictions at the neighbor interfaces in a consistent way .",
    "for instance , one can define @xmath55 any numerical algorithm must then provide two basic elements :    * a prescription for computing the slopes @xmath56 which must be used in the reconstruction process ( [ frl ] ) . * a flux formula that provides a unique value of the interface flux @xmath57 from the one - sided predictions @xmath58 .",
    "we can see in fig .  [",
    "reconstruction ] an example of the reconstruction process for the centered choice @xmath59 the outcome consists in two sequences of one - sided predictions at every interface ( dots and arrows ) .",
    "notice that the monotonicity of the original flux sequence is not preserved by the one - sided predictions in the regions with abrupt slope changes .",
    "this can lead to spurious oscillations in the numerical solution , even for smooth dynamical fields , like the one displayed in fig .",
    "[ reconstruction ] .",
    "these spurious oscillations are visible in the black hole simulation shown in fig .",
    "[ gibbs ] .",
    "the mmc method uses instead a monotonicity - preserving prescription , which can be obtained by using the monotonic centered ( mc ) slope  @xcite @xmath60 instead of ( [ slopec ] ) .",
    "the @xmath61 function is defined as usual :        the second ingredient in the mmc method is the use of marquina s flux formula  @xcite .",
    "the prescription to calculate the interface values @xmath62 can be stated as follows ( we have simplified the original formula by adapting it to the quasilinear evolution systems one gets from einstein s field equations ) :    * decompose both one - sided predictions @xmath63 as linear combinations of the set of characteristic fields @xmath53 . note that the coefficients in these combinations are not necessarily constant : we must use in general a different set of values on each side of the interface .",
    "* project the forward prediction @xmath64 , by suppressing any components @xmath53 corresponding to negative characteristic speeds ( forward projection @xmath65 ) .",
    "* project the backward prediction @xmath66 , by suppressing any components @xmath53 corresponding to positive characteristic speeds ( backward projection @xmath67 ) . * add these upwind - projected values at the given interface , that is @xmath68    one is taking in this way the positive speed components from the previous cell and the negative speed components from the next one . notice that we must assume for consistency a definite sign for the characteristic speed ( just the sign , not even the value ) .",
    "if the sign changes between both sides of the given interface ( when using a super - luminal shift , for instance ) , then another combination must be taken instead of the simple upwind projections presented here ( see ref .",
    "@xcite for the details ) .",
    "_ acknowledgements : this work has been supported by the eu programme improving the human research potential and the socio - economic knowledge base ( research training network contract hprn - ct-2000 - 00137 ) , by the spanish ministerio de ciencia y tecnologia through the research grant number bfm2001 - 0988 and by a grant from the conselleria dinnovacio i energia of the govern de les illes balears . _"
  ],
  "abstract_text": [
    "<S> the family of generalized - harmonic gauge conditions , which is currently used in numerical relativity for its singularity - avoidant behavior , is analyzed by looking for pathologies of the corresponding spacetime foliation . </S>",
    "<S> the appearance of genuine shocks , arising from the crossing of characteristic lines , is completely discarded . </S>",
    "<S> runaway solutions , meaning that the lapse function can grow without bound at an accelerated rate , are instead predicted . </S>",
    "<S> black hole simulations are presented , showing spurious oscillations due to the well known slice stretching phenomenon . </S>",
    "<S> these oscillations are made to disappear by switching the numerical algorithm to a high - resolution shock - capturing one , of the kind currently used in computational fluid dynamics . even with these shock - capturing algorithms , </S>",
    "<S> runaway solutions are seen to appear and the resulting lapse blow - up is causing the simulations to crash . as a side result , a new method is proposed for obtaining regular initial data for black hole spacetimes , even inside the horizons . </S>"
  ]
}