{
  "article_text": [
    "recently , with the growth of the computational power , large - scale pic simulations have been performed for many purposes .",
    "these simulations , for example , provide a direct method to investigate the particle acceleration processes in collisionless shocks @xcite .",
    "the acceleration processes found in such simulations ( mainly for electrons ) work in relatively short timescales . on the other hand",
    ", the acceleration processes that work more slowly and need longer timescales , for instance , the first - order fermi acceleration in collisionless shocks , may be affected by the energy loss effect of the high energy particles .",
    "in fact , as shown in this paper , the high energy particles can be suffered from significant energy loss if the number of particles used in simulation is too small . in such cases ,",
    "the acceleration process can become inefficient or cease completely .",
    "the cause of the energy loss of high energy or fast particles in pic simulations is physical , not numerical .",
    "it is essentially the same as that of the stopping power in a plasma @xcite .",
    "however , since the effects of binary collisions , ionization of atoms , charge exchange , electron spin , and other quantum effects , etc . , are usually not incorporated in the model of pic simulations , the energy loss of fast particles is mainly brought by the classical plasma response through the longitudinal electrostatic fields , or the polarization drag force , which is described by the dielectric response function of the plasma @xcite .",
    "the energy loss rate in pic simulations can also depend on the dimensionality of simulation . in the following , we deal with those in one and two dimensions as well as in three dimensions . by one dimension ,",
    "we mean here that the configuration space is one - dimensional while the velocity space is three - dimensional ; this situation is often called as ` 1d3v ' .",
    "similarly , by two dimensions we mean ` 2d3v ' .",
    "while these plasmas are different from the _ true _ one- or two - dimensional ( i.e. , 1d1v or 2d2v ) plasmas , e.g. @xcite , they are widely used in pic simulations because they can be regarded as three dimensional models with some restrictions or translational symmetries in relevant directions and they may include more physics of real three - dimensional plasmas than the true one- or two - dimensional models .    in this paper , we first derive theoretical expressions for the energy loss rate of fast particles in pic simulations in one , two , and three dimensions in section 2 . then",
    ", in section 3 , several comparisons are made between the theoretical results and numerical experiments . finally , concluding remarks are presented in section 4 .",
    "in this section , we first briefly introduce the dielectric response function which describes the energy loss rate of fast particles in a plasma due to the electrostatic response of the plasma based on @xcite .",
    "then , we derive the energy loss rates first for three dimensions and then for one and two dimensions .    consider a fast particle with mass @xmath0 and charge @xmath1 moving through a uniform plasma at velocity @xmath2 .",
    "its charge density is given by @xmath3 since the electrostatic potential induced by the fast particle in the plasma is not symmetric , the fast particle is subjected to a force due to the induced field and decelerated .",
    "the energy loss rate is given by @xcite @xmath4^{-1 } ,      \\label{eq : loss_rate}\\ ] ] where @xmath5 and @xmath6 is the dielectric response function of the plasma .",
    "the dielectric response function is independent of the spatial dimensionality for homogeneous plasmas , and hence it is common to 1d3v , 2d3v and three - dimensional simulations .",
    "the summation for @xmath7 in the equation , however , depends on the dimensionality of simulation and it should be regarded as @xmath8 where @xmath9 is the dimensionality considered ( @xmath10 ) .    for a maxwellian electron plasma with charge neutralizing background ,",
    "the dielectric response function is given by @xmath11 where @xmath12 is the thermal velocity of the electrons in the plasma and @xmath13 is the electron debye wavenumber .",
    "here , @xmath14 is the electron temperature , @xmath15 is the electron plasma frequency , @xmath16 is the electron mass , @xmath17 is the electron charge , and @xmath18 is the mean number density of the plasma electrons .",
    "the w function , @xmath19 , is given in @xcite and can be expressed in terms of the plasma dispersion function @xmath20 as @xmath21 when the argument @xmath22 is real , the imaginary part of the w function is given by @xmath23 = \\left(\\frac{\\pi}{2}\\right)^{1/2 } z \\exp\\left(-\\frac{z^2}{2}\\right ) .",
    "\\label{eq : w_imag}\\ ] ] when @xmath22 is real and @xmath24 , where @xmath25 and @xmath26 , the real part can be approximated as @xmath27 \\sim -\\frac{1}{z^2 }      \\label{eq : w_approx}\\ ] ] and with this approximation we have @xmath28^{-1 } \\sim - \\frac{k^2 \\varepsilon}{[k^2-({\\omega_{\\mathrm{p}e}}/v_0\\mu)^2]^2 + \\varepsilon^2 } ,      \\label{eq : inv_epsilon_approx}\\ ] ] where @xmath29 .",
    "note that for sufficiently small @xmath30 this function ( [ eq : inv_epsilon_approx ] ) takes effectively zero anywhere except around @xmath31 and using the relation for the delta function @xmath32 it is approximated further as @xmath28^{-1 }      \\sim       -\\frac{\\pi { \\omega_{\\mathrm{p}e}}}{2 k v_0 } { \\mathrm{sgn}}(\\mu ) \\left [   \\delta(\\mu - { \\omega_{\\mathrm{p}e}}/kv_0 ) + \\delta(\\mu+{\\omega_{\\mathrm{p}e}}/kv_0)\\right ] .",
    "\\label{eq : inv_epsilon_approx2}\\ ] ] this can be used as a good approximation below because we consider only sufficiently fast particles ( @xmath33 ) in this paper .      in three dimensions ,",
    "the equation ( [ eq : loss_rate ] ) becomes @xmath34^{-1}.      \\label{eq : loss_rate_3d}\\ ] ] for pic simulations , the lower and upper limits of the @xmath35 integration may be given by @xmath36 where @xmath37 and @xmath38 are the system length and the grid size of the simulation , respectively .",
    "using the approximation ( [ eq : inv_epsilon_approx2 ] ) and assuming @xmath39 , which is usually satisfied in pic simulations , we finally obtain @xmath40 which is equivalent to the expression of the well - known stopping power in a plasma . introducing the number of electrons contained in the volume of the cubic electron skin depth , @xmath41 , where @xmath42 is the electron skin depth , the equation ( [ eq : loss_rate_3d_c ] )",
    "can be rewritten as @xmath43      the one - dimensional ( 1d3v ) cases can be regarded as three - dimensional ones but with a restriction or a symmetry ; letting the variable direction be the @xmath44 direction , the translational symmetry in @xmath45 and @xmath46 directions is required",
    ". therefore , even if we want to deal with only one fast particle , we inevitably must consider identical fast particles ( with the same @xmath44 coordinate ) uniformly distributed on the @xmath45-@xmath46 plane like a charged ` sheet ' .",
    "thus , instead of ( [ eq : charge_density_3d ] ) , the charge density of the fast particles is given as that made by the sheet : @xmath47 where @xmath48 is the two - dimensional number density of the fast particles embedded on the sheet .",
    "taking into account of this condition , the energy loss rate _ per particle _",
    "( [ eq : loss_rate ] ) for 1d3v cases becomes @xmath49^{-1 } dk\\ ] ] with @xmath50 the ranges of the integration are given by @xmath51 $ ] and @xmath52 $ ] .",
    "this can be integrated without any approximations to obtain @xmath53 ,      \\label{eq : loss_rate_1d_0}\\ ] ] where @xmath54      \\quad \\textrm{and } \\quad      w_i \\equiv \\mathrm{im}\\left [ w\\left(\\frac{|v_{0x}|}{{v_{\\mathrm{th},e}}}\\right ) \\right ] .",
    "\\label{eq : w_re_im}\\ ] ] since the argument of the w function , @xmath55 , is real , @xmath56 is given by the equation ( [ eq : w_imag ] ) .",
    "for fast particles with @xmath57 ( i.e. , @xmath58 ) , from equations ( [ eq : w_imag ] ) and ( [ eq : w_approx ] ) , we see that @xmath59 .",
    "in addition , in pic simulations the conditions @xmath60 are usually satisfied for fast particles . with these conditions",
    ", we finally obtain @xmath61    in pic simulations , the two - dimensional number density of the fast particle sheet introduced above , @xmath48 , is usually taken to be equal to that of the plasma electron sheets ; in other words , all particles in simulation have the same weight . in this case , we have @xmath62 where @xmath63 is the mean one - dimensional ( in @xmath44 direction ) number density of the plasma electron sheets and then eq .",
    "( [ eq : loss_rate_1d ] ) is rewritten as @xmath64 where @xmath65 is the number of the plasma electron sheets contained in the electron skin depth @xmath66 .",
    "note that for nonrelativistic fast particles the equation ( [ eq : loss_rate_1d_b ] ) can be rewritten in terms of the velocity of the fast particle as @xmath67 which is exactly equivalent to the expression for the polarization velocity drag for nonrelativistic fast electrons obtained by @xcite ( see also @xcite ) if we set @xmath68 and @xmath69 .",
    "as in the one - dimensional case , the charge density of the fast particle in two dimensions ( 2d3v ) must be regarded as that made by a ` rod ' of the fast particles in three dimensions .",
    "taking the simulation plane on the @xmath44-@xmath45 plane , the identical fast particles are uniformly distributed in the @xmath46 direction with the same @xmath44 and @xmath45 coordinates and the charge density is given by @xmath70 where @xmath71 is the one - dimensional number density of the fast particles embedded in the rod .",
    "thus , the equation ( [ eq : loss_rate ] ) becomes @xmath72^{-1},\\ ] ] where @xmath73 . using the approximation ( [ eq : inv_epsilon_approx2 ] ) and assuming @xmath39 , we have @xmath74 then ,",
    "assuming @xmath75 , we finally obtain @xmath76 this is independent of the velocity even for the nonrelativistic particles unlike the one dimensional case ( [ eq : loss_rate_1d ] ) .    when the fast particle has the same weight as the plasma electrons , we have @xmath77 where @xmath78 is the mean two - dimensional number density of the plasma electron rods and then we obtain @xmath79 where @xmath80 is the number of the plasma electron rods contained in the area of the electron skin depth squared , @xmath81 . for nonrelativistic fast particles , as eq",
    "( [ eq : velocity_drag ] ) in the one - dimensional case , this equation can be rewritten as the velocity drag form as @xmath82      in pic simulations , particles are not point charges , but have a shape with finite extension comparable to the grid size @xmath83 .",
    "the shape of the particles is expressed by the shape factor @xmath84 @xcite .",
    "for example , in one dimension , the shape factor of the cloud - in - cell ( cic ) model is given by @xmath85 the charge density may also be smoothed out by using a spatial filter with a kernel @xmath86 .",
    "furthermore , pic simulations generally deal with multi - component plasmas , not single - component plasmas .",
    "therefore , the dielectric response function is altered accordingly . within the grid less model ,",
    "the dielectric response function for a multi - component plasma , where the mass and the temperature of the species @xmath87 are given by @xmath88 and @xmath89 respectively , with the effects of the shape factor and the spatial filter may be given by @xcite @xmath90 where @xmath91 , @xmath92 and @xmath93 are the thermal velocity , the debye wavenumber and the plasma frequency of the @xmath87 species , respectively .",
    "@xmath94 is the fourier transforms of the shape factor and @xmath95 is that of the spatial filter .",
    "however , these effects are usually negligible as shown below .    for ions with @xmath96 and the same temperature @xmath97 , the argument of the w function for the s species , @xmath98 , is much larger than that for the electrons .",
    "therefore , noting eqs .",
    "( [ eq : w_imag ] ) and ( [ eq : w_approx ] ) , we see that the effect of the ions in ( [ eq : drf_multi ] ) is usually negligible .",
    "the only exception is the electron - positron plasma ; in this case the energy loss rate is obtained by simply replacing @xmath99 with @xmath100 in the expressions for the electron plasma because of the symmetry of the two species .",
    "( however , note that the energy loss rates derived here is valid for the nonrelativistic plasmas because we have assumed the nonrelativistic maxwellian distribution in eqs .",
    "( [ eq : drf ] ) and ( [ eq : drf_multi ] ) . )    in addition , as shown in eq .",
    "( [ eq : inv_epsilon_approx ] ) or eq .",
    "( [ eq : inv_epsilon_approx2 ] ) , the function @xmath101^{-1}$ ] takes non - zero values only around @xmath102 for sufficiently fast particles .",
    "therefore , the values of @xmath94 and @xmath95 only at that wavenumber are relevant to the energy loss rate . however , they are approximately unity at that wavenumber , @xmath103 , because both @xmath84 and @xmath86 have the spatial sizes of the order of the grid size @xmath83 and usually the condition @xmath104 is satisfied .",
    "therefore , these effects are also negligible for ordinary cases .",
    "thus , even for multi - component plasmas with the shape factor and/or the spatial filter , the energy loss rates can be approximated by that derived for the electron plasma very well for ordinary situations .      rewriting the equations ( [ eq : loss_rate_1d_b ] ) , ( [ eq : loss_rate_2d_b ] ) and ( [ eq : loss_rate_3d_d ] ) in terms of the normalized quantities , @xmath105 , @xmath106 , @xmath107 , @xmath108 and @xmath109",
    ", we obtain @xmath110 we see that the fundamental parameter for the energy loss rate of fast particles is the number of electrons contained in the corresponding electron skin depth volume ; @xmath111 , @xmath112 , or @xmath113 for respective dimensionality . for relativistic fast particles ( @xmath114 ) , the order of the energy loss rate in this unit is simply given by @xmath115 for all cases . for nonrelativistic fast particles ( @xmath116 ) , there are different dependences on the velocity for different dimensionality .    summarizing the above argument , we note that for the same numbers of electrons in the skin depth volume , @xmath117 , the energy loss rate of the relativistic fast particles is effectively independent of the mass and the energy of the fast particles , the temperature of the plasma , and the number of electrons in the volume defined by the debye length .",
    "it is also almost independent of the composition of the plasma , the shape factors and the spatial filters used in the pic simulation for ordinary cases as shown in the previous subsection .",
    "to confirm the theoretical results derived in the previous section , we show here the results of some numerical experiments mainly with one dimensional ( 1d3v ) simulations .    in the following , we consider the energy loss of a fast electron with @xmath69 and @xmath68 moving through a uniform plasma in the @xmath44-direction .",
    "basic parameters and settings of the simulations are as follows : the initial four - velocity of the fast electron @xmath118 which corresponds to the three - velocity of @xmath119 and the kinetic energy of @xmath120 , the ion - to - electron mass ratio of the plasma @xmath121 , the temperature of the plasma @xmath122kev ( @xmath123 ) , the grid size @xmath124 , the time step @xmath125 , and the length of simulation system @xmath126 .",
    "the cloud - in - cell ( or the first - order ) shape factor is used and no spatial filters are adopted .",
    "several of these parameters are altered in the following experiments in order to investigate the dependences on them .",
    "the 1d3v simulation code used is a second - order finite - difference code with a staggered grid and semi - implicit scheme for the electromagnetic field developed based on @xcite .",
    "initially , the plasma is uniform and isothermal , and the periodic boundary conditions are imposed at the ends of the simulation box .",
    "first , we observe the energy loss process of a relativistic fast electron with the 1d3v simulations . since the energy loss process is a stochastic one , a number of energy histories of the fast particle are calculated by independent simulations with the identical parameters and different random seeds and then the average history is calculated from them . the results from the total of one hundred runs are summarized in fig .",
    "[ fig : fig1 ] ( a ) .",
    "the twenty of the individual energy histories are shown by the light gray curves and the average of the all histories is shown by the black solid curve .",
    "although the individual histories are generally highly fluctuating , their average obeys almost a linear evolution ( i.e. , @xmath127 ) as expected from eq .",
    "( [ eq : energy_loss_rate ] ) .",
    "figure [ fig : fig1 ] ( b ) shows the average energy histories calculated for various numbers of the plasma electrons contained in the electron skin depth , @xmath111 .",
    "the dependence of the average energy loss rates on @xmath111 is evident .",
    "figure [ fig:1d_ux10_t16000 ] shows the dependence of the average energy loss rate on @xmath111 and on the grid size @xmath83 .",
    "the average energy loss rates are calculated from the simulation results by averaging a number of individual energy histories as in fig .",
    "[ fig : fig1 ] ( a ) and then fitting the straight portion of the average histories .",
    "we also calculated the 1-@xmath48 confidence interval of each average value , which depends on the number of simulations carried out to obtain the average .",
    "however , we omit them in the figure because the error bars are smaller than the size of the symbols .",
    "we see that the simulation results almost perfectly fit the theoretical curve given by eq.([eq : energy_loss_rate ] ) .",
    "this figure also demonstrates that the energy loss rate does not depend on the grid size @xmath83 , or equivalently on the number of particles per cell @xmath128 , when @xmath111 is fixed .",
    "figure [ fig:1d_ux10_temp ] shows the dependence of the energy loss rate on the number of plasma electrons contained in the debye length , @xmath129 , or equivalently on the temperature of the plasma , for fixed @xmath130 .",
    "the other parameters are the same as in fig .",
    "[ fig:1d_ux10_t16000 ] .",
    "we see that the energy loss rate does not depend on @xmath129 when @xmath111 is fixed .",
    "this fact is interesting because the collision frequency of thermal energy particles in pic simulations is basically determined by @xmath129 @xcite , not by @xmath111 .",
    "figure [ fig:1d_ux_dependence ] shows the dependence of the energy loss rate on the velocity of the fast particle .",
    "the solid curve shows the theoretical result given in ( [ eq : energy_loss_rate ] ) .",
    "the dashed curve shows another theoretical curve using a better approximation for small @xmath131 obtained from eqs .",
    "( [ eq : loss_rate_1d_0 ] ) and ( [ eq : w_approx ] ) .",
    "the dependence on the velocity is evident for the nonreletivistic regime .",
    "the simulation results are in agreement with the theoretical curve of the latter one well except for small values of @xmath132 ; for @xmath122kev ( @xmath123 ) and @xmath133 ( @xmath134 ) , the argument of the w function becomes @xmath135 and the large @xmath22 approximation gets worse for that case . figure [ fig:1d_ux10_shape_filter ] shows the dependence on the shape factors and the spatial filters . here ,",
    "a simple three - point filter is used ( see appendix c in @xcite for details ) .",
    "it is evident that the energy loss rate is independent of them as mentioned in sec.2.4 .",
    "figure [ fig:2d ] shows the average energy loss rate in two - dimensional ( 2d3v ) simulations as a function of @xmath112 .",
    "the simulation code uses the spectral method and the third - order shape factor .",
    "( however , the energy loss rate should be independent of the details of the simulations if the argument presented in the previous section is true . )",
    "we confirm that the simulation results are in agreement with the theoretical curve ( [ eq : energy_loss_rate ] ) very well .",
    "in this paper , we have shown fast particles in pic simulations are suffered from the energy loss due to the stopping power of a plasma and the energy loss rate of relativistic fast particles is given by @xmath136 in the normalized unit . however , since the number @xmath117 in pic simulations is usually much smaller than that in real plasmas , the energy loss can be exaggerated significantly and can affect the simulation results . therefore , especially for the simulations that investigate the particle acceleration processes that work in relatively long timescales , the number @xmath117 should be chosen large enough to avoid this artificial energy loss .",
    "for example , for the first - order fermi acceleration in collisionless shocks @xcite , the mean energy gain rate is roughly given by @xmath137 in the normalized unit , where @xmath138 is the electron cyclotron frequency , @xmath139 is the shock velocity and @xmath140 is the parameter in the bohm diffusion model in which the mean free path of the particles being accelerated is given by @xmath141 where @xmath142 is the gyroradius of particle @xcite .",
    "although the value of @xmath140 is unknown a priori and should be determined by the condition of the magnetic irregularity in the system , the values of @xmath143 are often assumed for efficient acceleration . in eq.([eq : fermi_energy_gain ] ) , the shock compression ratio of 4 is also assumed . to investigate the acceleration process with pic simulations , the condition @xmath144 must be satisfied , where @xmath145 is the energy loss rate given in ( [ eq : energy_loss_rate ] ) . thus ,",
    "for instance , for one - dimensional simulations , the number of the plasma electrons contained in the electron skin depth length , @xmath111 , must satisfy @xmath146 otherwise , the exaggerated energy loss may make the acceleration process inefficient .",
    "y. matsumoto , t. amano , m. hoshino , electron accelerations at high mach number shocks : two - dimensional particle - in - cell simulations in various parameter regimes , the astrophysical journal 755 ( 2012 ) 109 .                         obtained from 1d3v simulations . ( a ) energy histories of the fast particle for a fixed number of plasma electrons in the electron skin depth @xmath147 . those obtained from twenty independent runs are shown with the light gray curves .",
    "the average energy history calculated from one hundred runs is also shown by the black solid curve .",
    "the upper and lower dashed curves denote the 1-@xmath48 confidence interval of the average value .",
    "( b ) the average energy histories for various @xmath111 of ( from top to bottom ) @xmath148 and @xmath149 are shown .",
    ", title=\"fig:\",width=415 ] +   obtained from 1d3v simulations .",
    "( a ) energy histories of the fast particle for a fixed number of plasma electrons in the electron skin depth @xmath147 .",
    "those obtained from twenty independent runs are shown with the light gray curves .",
    "the average energy history calculated from one hundred runs is also shown by the black solid curve .",
    "the upper and lower dashed curves denote the 1-@xmath48 confidence interval of the average value .",
    "( b ) the average energy histories for various @xmath111 of ( from top to bottom ) @xmath148 and @xmath149 are shown .",
    ", title=\"fig:\",width=415 ]    , and on the grid size @xmath83 .",
    "the simulation parameters other than @xmath111 are the same as those in fig.[fig : fig1 ] . the simulation results and",
    "the theoretical result ( [ eq : energy_loss_rate ] ) are shown by the symbols and by the solid curve , respectively .",
    ", width=415 ]    , for fixed @xmath130 .",
    "symbols denote the simulation results with error bars for the 1-@xmath48 confidence intervals .",
    "corresponding temperatures of the plasmas are , from left to right , 1 , 2 , 4 , 8 , 16 and 32 in kev , respectively .",
    "the theoretical prediction is shown by the solid curve .",
    ", width=415 ]    .",
    "the symbols denote the simulation results and the solid curve shows the theoretical curve given in ( [ eq : energy_loss_rate ] ) .",
    "the dashed curve shows another theoretical curve using a better approximation ( see text ) .",
    ", width=415 ]    .",
    "the energy loss rates obtained from the simulations are shown by the symbols for the shape factors of , from left to right , zeroth- , first- , second- and third - order .",
    "the circles and the triangles respectively denote those without and with the spatial filters . , width=415 ]    .",
    "the symbols denote the results from simulations while the solid curve shows the theoretical result given in ( [ eq : energy_loss_rate ] ) .",
    "the error bars show the 1-@xmath48 confidence intervals of the average values .",
    ", width=415 ]"
  ],
  "abstract_text": [
    "<S> when a charged particle moves through a plasma at a speed much higher than the thermal velocity of the plasma , it is subjected to the force of the electrostatic field induced in the plasma by itself and loses its energy . </S>",
    "<S> this process is well - known as the stopping power of a plasma . in this paper </S>",
    "<S> we show that the same process works in particle - in - cell ( pic ) simulations as well and the energy loss rate of fast particles due to this process is mainly determined by the number of plasma electrons contained in the electron skin depth volume . </S>",
    "<S> however , since there are generally very few particles in that volume in pic simulations compared with real plasmas , the energy loss effect can be exaggerated significantly and can affect the results . </S>",
    "<S> therefore , especially for the simulations that investigate the particle acceleration processes , the number of particles used in the simulations should be chosen large enough to avoid this artificial energy loss .    </S>",
    "<S> plasma , particle - in - cell , energy loss , stopping power </S>"
  ]
}