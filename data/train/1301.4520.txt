{
  "article_text": [
    "star formation is a collective process : many stars are born in multiple systems ( e.g. * ? ? ?",
    "* ) , and most are born in clusters ( e.g. * ? ? ?",
    "consequently , a realistic simulation that captures the important interactions between neighbouring protostars , as they form , is only feasible if some of the detailed internal physics of individual protostars is sacrificed .",
    "otherwise all the available computational resource is commandeered by the first protostar to form , and events in the rest of the computational domain grind to a halt .",
    "it is for this reason that lagrangian sink particles were first developed by @xcite .",
    "subsequently they have also been used to model single accreting objects , for example black holes in galactic nuclei , where the focus is not on the detailed hydrodynamics in the immediate vicinity of the black hole , but on feedback from the black hole on much larger scales ( e.g. * ? ? ?",
    "* ) .    in the most basic implementation",
    ", a sink is created when and where some lump in the computational domain looks like it will inevitably condense out gravitationally ( into a single star , or a tight multiple system , or a black hole ) .",
    "sinks can also be introduced into the initial conditions for a simulation , to represent pre - existing condensations ( stars or black holes ) .",
    "a basic sink is a point mass , and therefore it interacts with the surrounding matter gravitationally",
    ". once created , a sink can grow by accreting nearby matter that looks like it would inevitably become part of the same condensation . even at this most basic level , there are issues with how to identify lumps that should be converted into sinks , and how to determine which matter they should subsequently accrete .    at a higher level of sophistication ,",
    "sink properties ( masses , positions , velocities , accretion rates ) are used to infer stellar mass functions , binary statistics , cluster kinematics and the star formation rate in turbulent molecular clouds ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "they can also be used to model radiative and mechanical feedback from protostars , using simple models or phenomenological prescriptions for the physics inside the sink ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    in cosmological simulations ,",
    "sink particles are used to model the formation and growth of black holes , and hence agn feedback @xcite .",
    "for example , in @xcite the efficiency of agn feedback is estimated using the bondi - hoyle - littleton theory @xcite acting on scales of a few tens of parsecs , whereas the actual schwarzschild radius of a typical supermassive black hole is of order a few solar radii .",
    "two main algorithms are currently used to model star formation , smoothed particle hydrodynamics ( sph ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and adaptive mesh refinement ( amr ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this paper is concerned with sinks in sph .    in sph simulations of star formation ,",
    "two requirements are critical .",
    "first , the mass of a single sph particle , @xmath0 , should be chosen ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , or adjusted ( e.g. * ? ? ?",
    "* ) , so that the jeans mass is always resolved .",
    "second , sink creation should be considered only if the density exceeds a user - defined threshold , @xmath1 , and @xmath1 should in turn exceed the density at which the minimum jeans mass obtains , so that the code can capture properly the full range of fragmentation , and the formation of first cores .",
    "thus our main concern here is with sinks created from gas that is already being heated by adiabatic compression ; for a discussion of how to treat sinks created at lower densities from approximately isothermal gas the reader is refered to @xcite . for contemporary local star formation ,",
    "involving molecular gas at @xmath2 , these requirements reduce to @xmath3 and @xmath4 .",
    "once the density exceeds @xmath1 , the criteria that are applied to determine ( i ) whether a sink actually is created , ( ii ) what matter it immediately assimilates , and ( iii ) what matter it subsequently accretes , must be formulated so as to obtain close correspondence between the properties of the sinks that do form , and the stars that should have formed , under the given physical circumstances .    in amr simulations of star formation",
    ", the computational domain is divided adaptively into finer meshes  and as appropriate these meshes are subsequently de - constructed  so as to deliver high resolution only when and where it is needed .",
    "there is a minimum mesh spacing , @xmath5 , below which refinement is prohibited . in the original implementation of sink particles in amr @xcite",
    ", a sink is introduced wherever the local jeans length falls below @xmath6 and is therefore no longer adequately resolved .",
    "there are then rules to determine the rate at which mass is accreted onto the sink from the surrounding cells , and to identify the circumstances under which neighbouring sinks are merged .",
    "the angular momentum of the accreted mass is left behind in the cell from which it is accreted . @xcite",
    "have shown that this implementation is quite robust , in the sense that there is good correspondence between the properties of sinks formed in simulations having the same initial conditions but different @xmath5 .",
    "to capture the full range of fragmentation , and the formation of first cores , requires @xmath7 , for contemporary local star formation .",
    "we note that in some amr sink implementations ( e.g. * ? ? ?",
    "* ) the angular momentum of matter accreted by the sink is not left behind , but is assimilated by the sink .",
    "recently , @xcite have simulated the formation of a star cluster with sph and amr , using comparable resolution , and have developed a set of sink - creation criteria which ensure that the two methods give very similar results , in terms of the masses , locations and accretion histories of the sinks formed . however , although these simulations investigate the consequences of different sink creation criteria , they do not explore in detail the dependence of the sink properties on the resolution , or on the user - defined parameters of sink creation .",
    "the present paper addresses these issues .    in section [ sec : newsinks ]",
    "we describe in detail a new algorithm for the creation and evolution of sinks , explaining the motivation for each of its features ; we call these newsinks . in sections",
    "[ sec : oldsinks ] and [ sec : ursinks ] , we describe the sink algorithms that have been used previously in sph simulations of star formation  hereafter _ standard sinks _  focussing on the particular implementations that we use for comparison tests . since all but one of the new features in newsinks relate to their evolution , rather than their creation , section [ sec : oldsinks ] defines oldsinks , which are created in the same way as newsinks , but evolved in the manner of standard sinks , thereby allowing us to isolate those aspects of newsinks that have to do purely with sink evolution . on the other hand , since most extant sph simulations of star formation that invoke sinks actually use a less robust algorithm to create sinks than that used by newsinks and oldsinks , section [ sec : ursinks ] defines ursinks , which are created _ and _ evolved in the manner of standard sinks .",
    "the basic properties of the different types of sink are summarised in table [ tab : sinktypes ] .",
    "section [ sec : tests ] presents the results of tests performed with the different types of sink to demonstrate that when newsinks are used the results obtained are only weakly dependent on the resolution and the user - defined parameters of sink - creation , whereas when oldsinks are used the results are strongly dependent and not converged , and when ursinks are used the results are divergent .",
    "general aspects of the different types of sink are discussed in section [ sec : disc ] .",
    "our main conclusions are summarised in section [ sec : conc ] .    [",
    "cols=\"<,<,>,^,^,^,^\",options=\"header \" , ]      in order to establish how well newsinks perform under more realistic conditions , we simulate the collapse of a turbulent prestellar core , using initial conditions from ( * ? ? ?",
    "* specifically core  a - mm8  with seed 200 ) .",
    "the core has mass @xmath8 , initial radius @xmath9 , and the density prodile of a critical bonnor - ebert sphere ( i.e. one with dimensionless boundary radius @xmath10 ) .",
    "the initial turbulent velocity field subscribes to a power spectrum of the form @xmath11 ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ) , with @xmath12 ( where @xmath13 corresponds to the core radius ) .",
    "the gas is initially isothermal at @xmath14 , and the equation of state is evolved with the algorithm of @xcite , which captures the transport of cooling radiation and the dependence of the opacity on density and temperature .",
    "the mach number of the turbulence is 1.5 , and the ratios of thermal and turbulent energy to gravitational energy are @xmath15 and @xmath16 .",
    "the initial conditions are set up by cutting a sphere of 157,000 sph particles from a relaxed periodic cube , and scaling the mass and radius so that the inner 128,000 sph particles have total mass @xmath17 and outer radius @xmath18 ; thus all sph particles have mass @xmath19 .",
    "next the inner 128,000 sph particles are stretched to fit the density profile of a critical bonnor - ebert sphere ( as in the rotating bonnor - ebert sphere test of section [ sec : bonnoreb ] ) , and allocated a temperature @xmath20 . at the same time , the outer 29,000 sph particles are stretched so that they have uniform number - density ten times smaller than the number - density of the sph particles just inside @xmath21 , and allocated a temperature @xmath22 .",
    "finally , the turbulent velocity field is evaluated on a cartesian grid , and the velocities of individual sph particles are obtained by interpolation on this grid .",
    "the evolution of the core is simulated using newsinks , oldsinks and ursinks , with three different values of @xmath23 , @xmath24 and @xmath25 ; with these high values of @xmath1 the gas is well into the adiabatic heating regime by the time sinks are created . in all cases we set @xmath26 , and all nine simulations",
    "are terminated at @xmath27 .",
    "[ fig : turbcore ] shows the density field on the @xmath28 plane at @xmath29 , and the projected positions of the sinks .",
    "table [ tab : turbcore ] gives the times at which the sinks form and their masses at @xmath29 , plus the total mass and number of sinks at @xmath29 .",
    "the simulations performed with newsinks appear to be well converged .",
    "( i ) for all three values of @xmath1 , three sinks are formed .",
    "( ii ) all three sinks are formed at the same time , apart from a small systematic shift that is attributable to the fact that as @xmath1 increases , it takes a little longer for the protostar to contract to @xmath1 .",
    "( iii ) all three sinks are formed in the same place .",
    "( iv ) the masses of all three sinks at @xmath29 are the same , apart from a small systematic shift which is attributable to the fact that as @xmath1 increases the size of the sink decreases , and therefore more of the mass destined for the protostar is still in the form of active sph particles .",
    "the positions of the sinks and the distribution of the residual gas are also essentially the same , again , modulo the fact that there is more residual gas that has not yet been accreted , when @xmath30 , than when @xmath31 .",
    "the simulations performed with oldsinks are not converged .",
    "only the times of formation of the first two sinks are more - or - less independent of @xmath1 . for @xmath32",
    "the third sink does not form at all ( at least , not by @xmath33 ) , and in all cases the masses at @xmath33 do not vary with @xmath1 in a systematic way .    with ursinks , the situation is chaotic , in the sense that ",
    "apart from the time of formation of the first sink , which is independent of the sink type  there is no pattern to the changes in creation time and final mass produced by changing @xmath1 .",
    "the only systematic trend is that the total number of sinks formed increases with decreasing @xmath1 .",
    "the positions of the sinks , and the distribution of the residual gas are also very different for different values of @xmath1 . in short , the simulations with ursinks",
    "are divergent .",
    "all three types of sink use the density threshold and overlap criteria ( eqns . [ eqn : rhocrit ] & [ eqn : vrlpcrit ] ) for sink creation .",
    "newsinks and oldsinks additionally use the potential minimum and hill sphere criteria ( eqns .",
    "[ eqn : potmincrit ] & [ eqn : hillcrit ] ) , whereas ursinks use the acceleration divergence , velocity divergence , and non - thermal energy criteria ( eqns .",
    "[ eqn : divacccrit ] , [ eqn : divvelcrit ] & [ eqn : energycrit ] ) . as a consequence ,",
    "ursinks are prone to artificial sink creation .",
    "a newsink comprises a point - mass and a concentric spherical interaction - zone populated by sph particles ; these sph particles are accreted by the point mass on an extended timescale ( regulated accretion ) and the angular momentum that they add to the point - mass is returned to the sph particles remaining in the interaction zone , again on an extended timescale .",
    "in contrast , an oldsink or ursink comprises a point - mass and a concentric spherical exclusion - zone that usually is almost devoid of sph particles .",
    "most sph particles entering the exclusion - zone are immediately assimilated by the point - mass ( instantaneous accretion ) , taking their angular momentum with them , and this results in artificially steep gradients in the vicinity of the exclusion - zone boundary , _ and _ artificial removal of angular momentum .",
    "the potential minimum criterion was introduced by @xcite , and is effective because the gravitational potential derives from all the matter in the computational domain , and therefore is not strongly influenced by particle noise . in combination with the hill sphere criterion , it stops density peaks that are destined to be sheared apart by some external gravitational field from forming sinks .",
    "regulated accretion is designed to cure the problems that arise from the lack of sph particles in the exclusion zone of a standard sink ( oldsink or ursink ) and the non - physical flow of angular momentum into a standard sink .",
    "the tests we have implemented here are not intended to be exhaustive , but to give an indication of the improvement in performance that newsinks deliver .",
    "first , newsinks ensure relatively well - behaved hydrodynamics at the sink boundary .",
    "second , they do not act as sinks of angular momentum .",
    "third , as a consequence of these first two features , they predict approximately converged results ( i.e. creation times , masses , accretion rates , etc . ) that are more - or - less independent of the user - defined sink parameters .",
    "we stress that convergence can only be tested using structures that develop from prescribed perturbations , i.e. perturbations that can be accurately reproduced in the initial conditions of simulations having different resolutions and/or different sink parameters .",
    "thus , for example , in the boss - bodenheimer test , when the two original protostars and their accretion discs interact violently at periastron ( @xmath34 ) several new sinks may form . however , these have their origin in fluctuations due to particle noise , and therefore their genesis is a chaotic process that can not be used as the basis of a convergence test .",
    "it is for this reason that we chose to measure the mass of the first protostar to form , and to make this measurement at @xmath35 .",
    "newsinks incur a significant computational overhead , but , given the non - convergence and non - physicality inherent in the use of standard sinks , this overhead is a price that has to be paid . for example , in the turbulent core collapse test of section [ sec : turbcore ] , switching from oldsinks to newsinks increases the number of cpu - hours from 68 to 253 when @xmath36 , and from 313 to 766 when @xmath32 .",
    "the increase in cpu time derives mainly from the fact that the sph particles inside the interaction - zone are  of necessity  evolved with very short timesteps .",
    "a further advantage of newsinks is that , since they produce converged  and therefore hopefully accurate ",
    "accretion rates , one can have more confidence in using these to generate accretion luminosities ( radiative feedback ) and outflows ( mechanical feedback ) from protostars or black holes . sub - grid physics can easily be added to a newsink , for example a model of stellar evolution with accretion ( cf . * ? ? ? * ) , a model for episodic accretion ( cf . * ? ? ? * ) , or a model with mechanical feedback ( cf .",
    "* ; * ? ? ?",
    "the newsink algorithm has some similarities to the scheme used by @xcite to model accretion onto black holes in galactic nuclei .",
    "this scheme estimates an accretion rate using the bondi - hoyle - littleton theory @xcite and the local density , sound speed and velocity dispersion ; the sph particles to be accreted are chosen stochastically , but with a weighting that preferentially selects those nearest the bh ; and the dynamical mass of the bh is increased smoothly so that the accretion of small numbers of massive sph particles does not cause large feedback fluctuations .",
    "we have also experimented with using an average of the bondi accretion rates for the sph particles in the interaction - zone to determine the time - scale for radial accretion , but we find that eqn .",
    "( [ eqn : trad ] ) is better behaved .",
    "moreover , it may sometimes be more realistic to treat accretion onto a bh in a galactic nucleus using the disc - accretion limit ( as would happen automatically with a newsink ) .",
    "additionally , in the @xcite scheme the bh assimilates all the angular momentum of an accreted sph particle , which may lead to unrealistic effects .",
    "we stress that the issues of robust sink creation that we have addressed here are quite distinct from those of resolution , which we have not addressed . for example , if , as in our code , inter - particle gravity is kernel - softened , the minimum jeans mass is only adequately resolved if it contains very many more particles than the mean number of neighbours ( i.e. a large multiple of @xmath37 ) , so that gravitational interactions between the majority of particles are not softenned ; that is a resolution issue .",
    "however , if sinks are not created and evolved in such a way as to avoid spurious creation , unphysical boundary gradients , and unphysical assimilation of angular momentum , then , even if the self - gravitating gas dynamics that leads to sink creation and subsequently feeds sinks is faithfully simulated , with high resolution , the properties of the sinks formed are not converged , and can not be trusted ; these are the issues that newsinks deal with .",
    "we have developed a new algorithm for the creation and evolution of sink particles in sph , which has four user - defined free parameters , @xmath38 ) , with default values ( @xmath39 ) .",
    "this algorithm has several advantages over the standard algorithms used heretofore in sph simulations of star formation .",
    "( i ) sph particles flow into the volume of a newsink ( its interaction - zone ) , and are only accreted by the point - mass later , piecemeal , and usually over many timesteps .",
    "consequently the hydrodynamics in the vicinity of the boundary of a newsink is not so severely corrupted by poorly evaluated gradients .",
    "( ii ) the angular momentum of sph particles assimilated by the point - mass is transferred back to the sph particles in the interaction - zone , so that the point - mass does not act as a sink for angular momentum ; this angular momentum is in any case much reduced by the fact that the accreted sph particles have normally had to lose angular momentum to other sph particles before they become the closest sph particle to the point - mass ( and therefore next in line to be accreted ) .",
    "these factors mean that the rate of accretion onto a newsink is both better informed by physics than that onto a standard sink , _ and _ relatively independent of the user - defined parameters of sink creation .",
    "provided the simulation has sufficient resolution , well converged results are obtained up to density @xmath1 .",
    "we have measured the new algorithm against four tests : bondi accretion , the collapse of a uniformly rotating bonnor - ebert sphere , the boss - bodenheimer test , and the collapse of a turbulent prestellar core . in all cases",
    "the newsinks appear to produce quite reliable results ( i.e. accurate where there is a known solution , and otherwise approximately converged ) , whereas the standard algorithms do not .",
    "if @xmath1 is fixed , then a simulation with newsinks requires a factor between two and four times more computing resource than one with standard sinks , .",
    "however , this expense must be set against the fact that results obtained with newsinks are more credible .",
    "furthermore , since the results obtained with newsinks are converged at lower values of @xmath1 , one can safely reduce the computing time  by a comparable factor  by decreasing @xmath1 .",
    "dah is funded by a leverhulme trust research project grant ( f/00 118/bj ) and an stfc post - doc .",
    "sw gratefully acknowledges the support of the dfg priority programme no .",
    "apw gratefully acknowledges the support of the stfc rolling grant pp / e000967/1 .",
    "apw and sw acknowledge the support of the marie curie constellation research training network .",
    "most of the simulations were performed on the cardiff university arcca cluster .",
    "we thank the referee , daniel price , and also christoph federrath , for constructive comments that helped to improve an earlier version of this paper .",
    "we thank matthew bate for helpfully clarifying some details of the original sink particle implementation .",
    "we again thank daniel price for supplying the splash code @xcite , which was used to prepare figs . [",
    "fig : bossbod:1 ] and [ fig : turbcore ]                                                                                                                          j. , reid m. , qamar f. , sills a. , petitclerc n. , 2011 , in alves j. , elmegreen b.  g. , girart j.  m. , trimble v. , eds , computational star formation vol .",
    "270 of iau symposium , analogues of cores and stars in simulated molecular clouds"
  ],
  "abstract_text": [
    "<S> numerical simulations of star formation frequently rely on the implementation of sink particles , ( a ) to avoid expending computational resource on the detailed internal physics of individual collapsing protostars , ( b ) to derive mass functions , binary statistics and clustering kinematics ( and hence to make comparisons with observation ) , and ( c ) to model radiative and mechanical feedback ; sink particles are also used in other contexts , for example to represent accreting black holes in galactic nuclei . </S>",
    "<S> we present a new algorithm for creating and evolving sink particles in sph simulations , which appears to represent a significant improvement over existing algorithms  particularly in situations where sinks are introduced after the gas has become optically thick to its own cooling radiation and started to heat up by adiabatic compression . </S>",
    "<S> ( i ) it avoids spurious creation of sinks . </S>",
    "<S> ( ii ) it regulates the accretion of matter onto a sink so as to mitigate non - physical perturbations in the vicinity of the sink . </S>",
    "<S> ( iii ) sinks accrete matter , but the associated angular momentum is transferred back to the surrounding medium . with the new algorithm  and modulo the need to invoke sufficient resolution to capture the physics preceding sink formation  the properties of sinks formed in simulations are essentially independent of the user - defined parameters of sink creation , or the number of sph particles used .    </S>",
    "<S> [ firstpage ]    stars : formation  galaxies : nuclei  methods : numerical  hydrodynamics  </S>"
  ]
}