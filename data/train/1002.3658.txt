{
  "article_text": [
    "in this article , we relate two problems , one from classical number theory , and one from lattice point enumeration in convex bodies . motivated by a conjecture of ehrhart @xcite and a result of xu @xcite , we study linear systems of diophantine equations with a single parameter . to be more precise ,",
    "we suppose that the coefficients of our system are given by polynomial functions in a variable @xmath2 , and also that the number of solutions @xmath4 in nonnegative integers for any given value of @xmath2 is finite .",
    "we are interested in the behavior of the function @xmath4 , and in particular , we prove that @xmath4 is * eventually a quasi polynomial * , i.e. , there exists some period @xmath5 and polynomials @xmath6 for @xmath7 such that for @xmath8 , the number of solutions for @xmath9 is given by @xmath10 .",
    "the other side of our problem can be stated in a similar fashion : suppose that @xmath3 is a convex polytope whose vertices are given by rational functions in @xmath2 .",
    "then the number of integer points inside of @xmath3 , as a function of @xmath2 , enjoys the same properties as that of @xmath11 as above .",
    "we now describe in more detail some examples and the statements of our results .      as a warmup to our result ,",
    "we begin with two examples .",
    "the first is a result of popoviciu .",
    "let @xmath12 and @xmath13 be relatively prime positive integers .",
    "we wish to find a formula for the number of nonnegative integer solutions @xmath14 to the equation @xmath15 . for a real number @xmath16 , let @xmath17 denote the greatest integer less than or equal to @xmath16 , and define @xmath18 to be the fractional part of @xmath16",
    ". then the number of such solutions is given by the formula @xmath19 where @xmath20 and @xmath21 satisfy @xmath22 and @xmath23 .",
    "see ( * ? ? ?",
    "* chapter 1 ) for a proof .",
    "in particular , this function is a quasi - polynomial in @xmath2 .    for the second example which is a generalization of the first example , consider the number of solutions @xmath24 to the matrix equation @xmath25 where the @xmath26 and @xmath27 are fixed positive integers and @xmath28 for @xmath29 .",
    "write @xmath30 .",
    "we assume that @xmath31 , so that there exist integers ( not unique ) @xmath32 such that @xmath33 now define two regions @xmath34 for @xmath29 .",
    "then if @xmath35 is in the positive span of the columns of the matrix in , there exist popoviciu - like formulas for the number of solutions of which depend only on whether @xmath36 or @xmath37 , and the numbers @xmath38 .",
    "see section  [ section : example1 ] for the precise statement .    in particular , one can replace the @xmath26 , @xmath27 , and @xmath39 by polynomials in @xmath2 in such a way that for all values of @xmath2 , the condition @xmath31 holds .",
    "for a concrete example , consider the system @xmath40 then for @xmath41 , we have that @xmath42 so that for these values of @xmath2 , there exists a quasi - polynomial that counts the number of solutions @xmath43 .",
    "given these examples , we are ready to state our general theorem .",
    "we denote by @xmath44 the set of functions @xmath45 which are eventually quasi - polynomial .",
    "[ ehrhartconj ] let @xmath46 be an @xmath47 matrix , and @xmath48 be a column vector of length @xmath49 , such that their entries are integer coefficient polynomials in @xmath2 . if @xmath4 denotes the number of nonnegative integer vectors @xmath16 satisfying @xmath50 ( assuming that these values are finite ) , then @xmath51 .",
    "this theorem generalizes the conjecture ( * ? ? ?",
    "* exercise 4.12 ) .",
    "see @xcite for some verified cases of a conjectural multivariable analogue , which we state here .",
    "let @xmath52 be some subset .",
    "we say that a function @xmath53 is a * multivariate quasi - polynomial * if there exists a finite index sublattice @xmath54 such that @xmath11 is a polynomial function on each coset of @xmath55 intersected with @xmath56 .",
    "let @xmath57 be an @xmath58 matrix and @xmath59 be a column vector of length @xmath49 , such that all entries are linear functions in @xmath60 with integer coefficients such that for all @xmath60 , the number of nonnegative integer solutions @xmath16 to @xmath61 is finite .",
    "then there exist finitely many polyhedral regions @xmath62 covering @xmath63 such that @xmath11 is a multivariate quasi - polynomial when restricted to each @xmath64 .",
    "we first recall a classical theorem due to pick .",
    "let @xmath65 be a convex polygon with integral vertices .",
    "if @xmath66 , @xmath67 , and @xmath68 denote the area of @xmath0 , the number of integer points in the interior of @xmath0 , and the number of integer points on the boundary of @xmath0 , respectively , then one has the equation @xmath69 now let us examine what happens with dilates of @xmath0 : define @xmath70 .",
    "then of course @xmath71 and @xmath72 whenever @xmath2 is a positive integer , so we can write @xmath73 or equivalently , @xmath74 which is a polynomial in @xmath2 .",
    "the following theorem of ehrhart says that this is always the case independent of the dimension , and we can even relax the integral vertex condition to rational vertices :    [ ehrharttheorem ] let @xmath75 be a polytope with rational vertices . then the function @xmath76 is a quasi - polynomial of degree @xmath77 .",
    "furthermore , if @xmath78 is an integer such that @xmath79 has integral vertices , then @xmath78 is a period of @xmath80 . in particular , if @xmath0 has integral vertices , then @xmath80 is a polynomial",
    ".    see ( * ? ? ?",
    "* theorem 4.6.25 ) or ( * ? ? ?",
    "* theorem 3.23 ) .",
    "the function @xmath81 is called the * ehrhart quasi - polynomial * of @xmath0 .",
    "one can see this as saying that if the vertices of @xmath0 are @xmath82 , then the vertices of @xmath83 are given by the linear functions @xmath84 .",
    "we generalize this as    [ polytope ] given polynomials @xmath85 $ ] for @xmath86 and @xmath87 , let @xmath2 be a positive integer such that @xmath88 for all @xmath89 .",
    "this is satisfied by @xmath2 sufficiently large , so we can define a rational polytope @xmath90 , where @xmath91",
    ". then @xmath92 .",
    "we call the function @xmath93 a * generalized ehrhart polynomial*.    in section  [ equi ] , we explain the equivalence of the two problems just mentioned , then prove our main result theorem  [ ehrhartconj ] in section  [ section : mainproof ] .",
    "the proof gives us an algorithm to compute these generalized ehrhart polynomials , but it could be very complicated in practice . for computational reasons ,",
    "we introduce the notions of generalized division and generalized gcd for the ring @xmath94 $ ] in section  [ generalizeddivision ] . in a sense ,",
    "these generalize the usual notions of division and gcd for the ring of integers @xmath95 .",
    "the methods and algorithms are quite similar , but are more involved due to technical complications .",
    "the proofs for the correctness of the algorithms are given in this section .",
    "as an application of these tools , in section  [ section : application ] , we will describe explicit computations of some special generalized ehrhart polynomials .",
    "we thank richard stanley for useful discussions and for reading previous drafts of this article .",
    "we also thank an anonymous referee for helping to improve the quality and readability of the paper .",
    "sheng chen was sponsored by project 11001064 supported by national natural science foundation of china .",
    "steven sam was supported by an nsf graduate fellowship and an ndseg fellowship .",
    "as we shall see , the two problems of the diophantine equations and lattice point enumeration are closely intertwined . in this section ,",
    "we want to show that theorem [ ehrhartconj ] is equivalent to theorem [ polytope ] . before this , let us see the equivalence of theorem [ polytope ] with the following result . for notation , if @xmath16 and @xmath96 are vectors , then @xmath97 if @xmath98 for all @xmath99 .",
    "[ ineq ] for @xmath100 , define a rational polytope @xmath101 , where @xmath102 is an @xmath103 matrix , and @xmath104 is an @xmath105 column vector , both of whose entries are integer coefficient polynomials",
    ". then @xmath92 .",
    "notice that the difference of theorem [ polytope ] and theorem [ ineq ] is that one defines a polytope by its vertices and the other by hyperplanes .",
    "so we will show their equivalence by presenting a generalized version of the algorithm connecting `` vertex description '' and `` hyperplane description '' of a polytope .",
    "the connection is based on the fact that we can compare two rational functions @xmath4 and @xmath106 when @xmath2 is sufficiently large .",
    "for example , if @xmath107 and @xmath108 , then @xmath109 for all @xmath110 , we denote this by @xmath111 ( `` even '' being shorthand for `` eventually '' ) . therefore , given a point and a hyperplane , we can test their relative position . to be precise ,",
    "let @xmath112 be a point where the @xmath113 are rational functions and let @xmath114 be a hyperplane where all the @xmath115 are polynomials of @xmath2",
    ". then exactly one of the following will be true : @xmath116 given this , we can make the following definition .",
    "we say that two points @xmath117 and @xmath118 * lie * ( resp .",
    ", * weakly lie * ) * on the same side of @xmath119 * if @xmath120 ( resp . , @xmath121 ) .",
    "going from the `` vertex description '' to the `` hyperplane description '' :    given all vertices of a polytope @xmath3 , whose coordinates are all rational functions of @xmath2 , we want to get its `` hyperplane description '' for @xmath100 .",
    "let @xmath122 be a hyperplane defined by a subset of vertices .",
    "if all vertices lie weakly on one side of @xmath122 , we will keep it together with @xmath123 , or @xmath124 or @xmath125 indicating the relative position of this hyperplane and the polytope .",
    "we can get all the hyperplanes defining the polytope by this procedure .",
    "going from the `` hyperplane description '' to the `` vertex description '' :    let @xmath126 be a polytope , where @xmath102 is an @xmath103 matrix , and @xmath104 is an @xmath105 column vector , both of whose entries are integer coefficient polynomials .",
    "we want to find its vertex description .",
    "let @xmath127 be the linear functionals defined by the rows of @xmath128 .",
    "so we can rewrite @xmath3 as @xmath129 the vertices of @xmath3 can be obtained as follows . for every @xmath130-subset @xmath131 , if the equations @xmath132 are linearly independent for @xmath100 , and their intersection is nonempty , then it consists of a single point , which we denote by @xmath133 . if @xmath134 for all @xmath135 , then @xmath136 is a vertex of @xmath3 , and all vertices",
    "are obtained in this way .",
    "we claim that the subsets @xmath137 for which @xmath133 is a vertex remains constant if we take @xmath2 sufficiently large .",
    "first , the notion of being linearly independent equations can be tested by showing that at least one of the @xmath138 minors of the rows of @xmath128 indexed by @xmath137 does not vanish .",
    "since these minors are all polynomial functions , they can only have finitely many roots unless they are identically zero . hence taking @xmath41",
    ", we can assume that @xmath139 is either always linearly dependent or always linearly independent .",
    "similarly , the sign of @xmath140 is determined by the sign of a polynomial , and hence is constant for @xmath41 .",
    "we can easily transform an inequality to an equality by introducing some slack variables and we can also represent an equality @xmath141 by two inequalities @xmath142 and @xmath143 .",
    "so the main difference between the two theorems is that theorem  [ ehrhartconj ] is counting nonnegative solutions while theorem  [ ineq ] is counting all integral solutions .",
    "but we can deal with this by adding constraints on each variable .",
    "a more interesting connection between theorem  [ ehrhartconj ] and theorem  [ ineq ] is worth mentioning here .",
    "first consider any fixed integer @xmath2 .",
    "then the entries of @xmath46 and @xmath48 in the linear diophantine equations @xmath50 of theorem  [ ehrhartconj ] all become integers . for an integer matrix",
    ", we can calculate its smith normal form .",
    "similarly , we can use a generalized smith normal form for matrices over @xmath44 to get a transformation from theorem  [ ehrhartconj ] to theorem  [ ineq ] .    then given @xmath46 and @xmath48 , by theorem  [ smith ]",
    ", we can put @xmath46 into generalized smith normal form : @xmath144 for some matrix @xmath145 with nonzero entries only on its main diagonal , and unimodular matrices @xmath146 and @xmath128 .",
    "then the equation @xmath50 can be rewritten as @xmath147 . set @xmath148 and @xmath149 . by the form of @xmath150",
    ", we have a solution @xmath96 if and only if @xmath151 divides @xmath152 for @xmath153 , and for any given solution , the values @xmath154 can be arbitrary .",
    "however , since @xmath155 , we need to require that @xmath156 , and any such @xmath96 gives a nonnegative solution @xmath16 to the original problem . simplifying @xmath157 , where @xmath158 , we get @xmath159 , where @xmath160 , @xmath161 and @xmath162 .",
    "although @xmath163 and @xmath164 has entries in @xmath44 , we can assume that they are polynomials by dealing with each constituent of the quasi - polynomials separately .",
    "so we reduce theorem  [ ehrhartconj ] to theorem  [ ineq ] .",
    "consider the nonnegative integer solutions to @xmath165 write @xmath166 .",
    "when @xmath167 , the smith normal form of @xmath168 is @xmath169    so the equation becomes @xmath170 set @xmath171 , so that we have @xmath172 and thus @xmath173 . by the condition @xmath174",
    ", we require @xmath175 which gives us @xmath176 a one dimensional polytope .",
    "so the number of solutions for @xmath167 is @xmath177    we can do the case @xmath178 similarly .",
    "the smith normal form of @xmath179 is @xmath180 and @xmath181 , thus @xmath182 .",
    "the proof of theorem  [ smith ] is based on a theory of generalized division and gcd over the ring @xmath94 $ ] , which mainly says that for @xmath183 $ ] , the functions @xmath184 , @xmath185 , and @xmath186 lie in the ring @xmath44 . one interesting consequence of these results is that every finitely generated ideal in @xmath44 is principal , despite the fact that @xmath44 is not noetherian .",
    "we developed this theory in order to appoach theorem  [ ehrhartconj ] at first , but subsequently have found a proof that circumvents its use .",
    "further details can be found in section  [ generalizeddivision ] .",
    "to prove theorem [ ehrhartconj ] , we will use a `` writing in base @xmath2 '' trick , to reduce equations with polynomial coefficients to linear functions . briefly , the idea of the following `` writing in base @xmath2 '' trick is as follows : given a linear diophantine equation @xmath187 with polynomial coefficients @xmath115 and @xmath188 , fix an integer @xmath2 , then the coefficients all become integers . now consider a solution @xmath189 with @xmath190 .",
    "put the values of @xmath189 into the equation , then both sides become an integer .",
    "then we use the fact that any integer has a unique representation in base @xmath2 ( @xmath2 is a fixed number ) , and compare the coefficient of each power of @xmath2 in both sides of the equation .    finally , letting @xmath2 change",
    ", we happen to have a uniform expression for both sides in base @xmath2 when @xmath2 is sufficiently large",
    ". moreover , the coefficient of each power of @xmath2 in both sides of the equation are all linear functions of @xmath2 ( lemma [ repr ] and lemma [ reduce ] ) . then by lemma [ linear ] , we can reduce these equations with linear function coefficients to the case when we can apply ehrhart s theorem ( theorem [ ehrharttheorem ] ) to show that the number of solutions are quasi - polynomials of @xmath2 .",
    "this completes the proof of theorem [ ehrhartconj ] .",
    "[ repr ] given @xmath191 $ ] with @xmath192 for @xmath100 ( i.e. , @xmath193 has positive leading coefficient ) , there is a unique representation of @xmath117 in base @xmath2 : @xmath194 where @xmath195 is a linear function of @xmath2 such that for @xmath41 , @xmath196 for @xmath197 and @xmath198 .",
    "we denote @xmath199 .",
    "note that @xmath200 may not be equal to @xmath201 .",
    "for example , @xmath202 is represented as @xmath203 with @xmath204 , @xmath205 , and @xmath206 .",
    "let @xmath207 with integral coefficients and @xmath208 .",
    "if the @xmath209 are all nonnegative , the proposition holds for @xmath210 , otherwise we can prove it by induction on @xmath211 , where @xmath99 is the smallest index such that @xmath212 .",
    "suppose @xmath213 is the minimal number such that @xmath214 , then in the representation of @xmath117 , put @xmath215 for @xmath216 , @xmath217 . by induction , we have a representation for @xmath218 so we can add it to @xmath219 to get the desired representation for @xmath117 .",
    "since for @xmath100 we have @xmath220 , by induction , we can make sure @xmath221 for @xmath100 . for a lower bound",
    ", @xmath222 is sufficient , i.e. , for all @xmath223 , the desired unique representation is guaranteed to exist .",
    "note that @xmath224 , since @xmath225 .",
    "so this process will stop in finitely many steps .",
    "uniqueness of this representation is clear .",
    "[ reduce ] fix an integer @xmath226 and @xmath41 .",
    "consider the set @xmath227 where @xmath228 ( as a usual polynomial ) and @xmath229 ( represented in base @xmath2 as in lemma [ repr ] ) , with @xmath230 and @xmath231 .",
    "then @xmath232 is in bijection with a finite union of sets of the form @xmath233 where @xmath234 and @xmath235 is a linear form of @xmath16 with constant coefficients .",
    "fix a sufficiently large positive integer @xmath2 . by our assumptions , for any point @xmath236 , we can write @xmath237 with @xmath238 .",
    "the rest of the lemma is a direct `` base @xmath2 '' comparison starting from the lowest power to the highest power in the equation @xmath239 . to get a feel for the proof , we recommend that the reader look at example  [ oneeq ] first .",
    "we will use this as a running example to explain the steps of the proof .",
    "first write @xmath240 in base @xmath2 , so that each @xmath241 is a linear function in @xmath2 . then we know that @xmath242 since we have fixed @xmath2 sufficiently large . going back to example  [ oneeq ]",
    ", we have @xmath243",
    "so that @xmath244 , @xmath245 and @xmath246 , so that here `` sufficiently large '' means @xmath247 . now expand out the equation @xmath248 to get @xmath249 the constant term in base @xmath2 of gives us the equation @xmath250 since we have the bound @xmath251 for all @xmath99 , we can in fact say that the lhs is equal to @xmath252 where @xmath253 is an integer such that @xmath253 is strictly greater than the sum of the negative @xmath254 and strictly less than the sum of the positive @xmath254 ( and @xmath253 can also be 0 ) .",
    "but note that @xmath253 only depends on the @xmath254 , so if our @xmath2 is sufficiently large , we may assume that @xmath255 .",
    "going back to example  [ oneeq ] , we have the equation @xmath256 so that @xmath257 .",
    "so now we have finitely many cases for the value of @xmath253 to deal with .",
    "going back to the equation , we can substitute our value of @xmath253 and compare linear coefficients to get @xmath258 again , since we know that @xmath251 and @xmath259 for all @xmath99 , we can say that the lhs is equal to @xmath260 where @xmath261 is an integer such that @xmath261 is greater than the sum of the negative @xmath254 and @xmath262 and less than the sum of the positive @xmath254 and @xmath262 ( and this is independent of @xmath253 because @xmath255 ) . going back to example  [ oneeq ] ,",
    "we get the equation @xmath263 so @xmath264 .",
    "now we have finitely many cases of @xmath261 , and again we fix one .",
    "we continue on in this way to get @xmath265 . at each point , we only had finitely many choices for the next @xmath266 , so at the end , we only have finitely many sequences @xmath267 . for a given @xmath268",
    ", we see that the @xmath269 must satisfy finitely many equalities of the form @xmath270 where @xmath11 is a linear form in @xmath16 with constant coefficients and @xmath271 .",
    "in example  [ oneeq ] , for @xmath272 , we would have the equations @xmath273 along with the inequalities @xmath274 , and we have underlined the places where @xmath261 appears .",
    "each such @xmath268 gives us a set of the form @xmath275 , and to finish we take the union of these sets over all sequences @xmath268 .",
    "we will need one more prepatory lemma before doing the proof of theorem  [ ehrhartconj ] .",
    "[ linear]if @xmath3 is a polytope defined by inequalities of the form @xmath276 , where @xmath234 and @xmath235 is a linear form of @xmath16 with constant coefficients , then @xmath277 .",
    "we first use the fact that the combinatorics of @xmath3 stabilizes for sufficiently large @xmath2 ( see section  [ equi ] ) , say that the polytope has @xmath5 vertices @xmath278 .",
    "also , note that the coefficients of the vertices of the polytope are linear functions in @xmath2 with rational coefficients .",
    "let @xmath78 be the least common multiple of the denominators that appear in all of the coordinates .",
    "then by ( * ? ? ?",
    "* theorem 18.4 ) , the function sending @xmath279 to the number of integer points in @xmath3 is a polynomial if we restrict to a specific congruence class of @xmath2 modulo @xmath78 .",
    "we can compose each of these functions with the polynomial @xmath280 to conclude that @xmath277",
    ".    we can also give a self - contained proof of lemma  [ linear ] that only uses ehrhart s theorem ( theorem  [ ehrharttheorem ] ) .",
    "we will do induction on dimension first , the case of dimension 0 being trivial . an inequality of the form @xmath281 with @xmath282 will be called an inequality with constant term . secondly , we will do induction on the number of inequalities with constant term .",
    "theorem  [ ehrharttheorem ] gives the desired result when there are no inequalities with constant term .",
    "in general , let @xmath3 be a polytope defined by @xmath281 plus other relations of the same form , which we will call @xmath283 .",
    "let @xmath284 be the polytope with relations @xmath285 and @xmath283 .",
    "if @xmath286 , then for @xmath287 , let @xmath288 be the polytope with relations @xmath289 and @xmath283 .",
    "then @xmath290 so to show @xmath291 , it suffices to show that @xmath292 and @xmath293 for @xmath294 .",
    "since @xmath284 has one less inequality with constant term , we know that @xmath292 by induction . as for @xmath288 , write @xmath295 and choose @xmath135 such that @xmath296 .",
    "then the equation @xmath297 can be rewritten as @xmath298 making substitutions into the relations @xmath299 , each relation still has the form @xmath300 ( clear denominators if necessary to make sure all of the coefficients are integral ) , and we have eliminated the variable @xmath301 .    if @xmath302 , then for @xmath303 , let @xmath288 be the polytope with relations @xmath304 and @xmath283",
    ". then @xmath305 and we proceed as before .",
    "hence @xmath293 by induction on dimension .",
    "consider a system of linear diophantine equations @xmath306 with finitely many nonnegative integer solutions for each @xmath100 , as in theorem [ ehrhartconj ] .",
    "let @xmath187 be any equation from the system .",
    "the equations @xmath306 define a bounded polytope whose vertices are given by rational functions of @xmath2 as discussed in section  [ equi ] , where the degrees of the rational functions ( difference between the degree of the numerator and the denominator ) are independent of @xmath2 .",
    "we can express each point in this polytope as a convex combination of the vertices .",
    "therefore , writing each variable @xmath307 in base @xmath2 , we can find some positive integer @xmath226 , which does not depend on @xmath2 , such that the coordinates of each point in the polytope are less than @xmath308 .",
    "using lemma  [ reduce ] , we can reduce each equation from @xmath306 into a new system like @xmath309 , with more variables than @xmath310 but all restrictions are of the form @xmath311 . applying lemma  [ linear ]",
    "finishes the proof .",
    "we give an example for lemma  [ linear ] . for @xmath2 a positive integer , let @xmath3 be the polygon defined by the inequalities @xmath312 , @xmath313 and @xmath314 .",
    "then @xmath284 is defined by the inequalities @xmath312 , @xmath313 , and @xmath315 , and @xmath316 is defined by the inequalities @xmath312 , @xmath317 , and @xmath318 .",
    "we can rewrite the equality as @xmath319 , and then the other inequalities become @xmath312 and @xmath320 .",
    "we see that @xmath284 is the convex hull of the points @xmath321 , while @xmath316 is the interval @xmath322 $ ] .",
    "the total number of integer points in @xmath284 and @xmath316 is given by the quasipolynomial @xmath323 its rational generating function is @xmath324    [ oneeq ] we give an example of lemma  [ reduce ] .",
    "consider nonnegative integer solutions for @xmath325 for any @xmath326 , @xmath327 is the expression in base @xmath2 .",
    "now consider the left hand side .",
    "writing @xmath328 in base @xmath2 , let @xmath329 , @xmath330 and @xmath331 with @xmath332 . in this case , @xmath333 , but we have further restrictions on the degrees of @xmath334 and @xmath335 in base @xmath2 coming from the coefficients @xmath336 .",
    "then we have @xmath337 now we can write the left hand side in base @xmath2 with extra constraints on @xmath338 s .",
    "we start with comparing the coefficient of @xmath339 in both sides .",
    "we have the following three cases : @xmath340 @xmath341 and @xmath342 so in the language of proof of lemma  [ reduce ] , we have @xmath257 .",
    "we next consider @xmath343 term .",
    "if @xmath16 satisfies @xmath344 for @xmath339 , @xmath345 , then the equation is reduced to @xmath346 now compare the @xmath343 terms .",
    "we have five cases for each @xmath345 : @xmath347 where @xmath348 .",
    "last , we compare the @xmath349 terms . note that since we assume @xmath100 , the @xmath339 term wo nt carry over to @xmath349 term , so the computation of @xmath349 term only depends on the term @xmath343 . if @xmath16 satisfies the @xmath261th condition for @xmath343 , the equation then becomes @xmath350 so for each @xmath351 , we have @xmath352 overall , we have the set @xmath353 is in bijection with the set @xmath354 such that @xmath16 satisfies the equations in the sets @xmath355 here we borrow the notation of matrix multiplication @xmath356 to represent intersection of sets @xmath357 and matrix summation @xmath358 to represent set union @xmath359 .",
    "note that here all constrains @xmath360 on @xmath361 are in the form of @xmath362 , where @xmath234 and @xmath235 is a linear form of @xmath16 with constant coefficients .",
    "an * integer - valued polynomial * , or a * numerical polynomial * is a function @xmath45 with a polynomial @xmath363 $ ] satisfying @xmath364 for all @xmath365 . for any numerical polynomial @xmath11 and a constant @xmath366 ,",
    "it is not hard to see that @xmath367 .",
    "we want to generalize this to @xmath368 for two numerical polynomials @xmath11 and @xmath369 . based on classical division ,",
    "we have for all @xmath370 that @xmath371 , with @xmath372 , we define two integer - valued functions @xmath373 , called the * quotient * of @xmath4 and @xmath106 and @xmath374 , called the * remainder * of @xmath4 and @xmath106 .",
    "we will show that @xmath375 by the generalized division algorithm .",
    "this generalized division algorithm is based on the division for @xmath376 $ ] , except for two modifications .",
    "first , in order to have @xmath377 for @xmath100 , we need to change the remainder condition of division in @xmath378 $ ] , as in [ algorithm [ divisionalg ] , lines [ rem1][rem2 ] ] .",
    "for example , for @xmath379 and @xmath380 , then we should have @xmath381 , @xmath382 , but these do not satisfy @xmath383 nor @xmath384 for division in @xmath378 $ ] . secondly , in order to keep @xmath385 $ ] , we break @xmath16 into finitely many `` branches '' whenever we have noninteger coefficients , as in [ algorithm [ divisionalg ] , lines [ break1][break2 ] ] . for example , take @xmath386 and @xmath387 .",
    "trying to do division in @xmath378 $ ] , leading coefficient of @xmath388 will not be an integer , so we break @xmath16 into 2 `` branches '' , since 2 is the leading coefficient of @xmath389 .",
    "now we do division to @xmath390 and @xmath391 , when @xmath392 ; and @xmath393 and @xmath394 , when @xmath395 . for @xmath392 , we have @xmath396 and @xmath397 and for @xmath395 we have @xmath398 and @xmath399 .",
    "we will show ( see theorem  [ al1 ] ) that breaking @xmath16 into @xmath400 ( using notation in algorithm [ divisionalg ] ) `` branches '' is sufficient to conclude that @xmath401 $ ] , for @xmath402 .",
    "@xmath403 $ ] .",
    "@xmath404 @xmath405 and @xmath406 , @xmath407 $ ] , for @xmath408 such that @xmath409 output @xmath410 @xmath381 ; @xmath411 .",
    "@xmath412 ; @xmath413 .",
    "@xmath414 ; @xmath415 .",
    "output @xmath416.[break1 ]    set @xmath417 ; @xmath418 ; @xmath419 ; @xmath420.[start ]    @xmath421 ; @xmath422;[degr-1 ] @xmath423 ; [ pi1 ] @xmath424 ; @xmath425 [ break2 ]    @xmath426 ; @xmath427 ; [ pi2 ] @xmath428[ri2 ] @xmath425 @xmath424    [ rem1 ] output @xmath429 , @xmath406 ; @xmath430 ; @xmath431 [ rem2 ]    note that in algorithm  [ divisionalg ] , we define @xmath432 to be the leading coefficient of @xmath433 .",
    "[ al1 ] algorithm  [ divisionalg ] is correct .    the algorithm will stop after finitely many steps ( @xmath434 is reduced by 1 each step in [ line [ degr-1 ] ] ) . for @xmath408 , and for @xmath435 , we claim the following two properties :    1 .   [",
    "1]@xmath436 $ ] .",
    "[ 2]@xmath437 and @xmath438 , for @xmath100 and @xmath439 .",
    "these two properties imply the correctness of the algorithm . by the algorithm ,",
    "[ 2 ] is obvious , so we only need to show [ 1 ] .",
    "note that in each step , we add to @xmath406 some @xmath421 or an integer @xmath104 ( see [ lines [ pi1 ] and [ pi2 ] ] ) , and subtract @xmath440 or @xmath441 from @xmath429 ( see [ lines [ degr-1 ] and [ ri2 ] ] ) , so it suffices to show @xmath442 $ ] . for every @xmath429 with degree @xmath443 in [ lines [ break1 ] - [ break2 ] ] , denote it by @xmath444 and its leading coefficient by @xmath445 .",
    "so we need to prove that @xmath446 for all @xmath447 . to show this",
    ", we use induction on @xmath448 to prove a stronger statement that @xmath449 for every monomial @xmath450 in @xmath444 . if @xmath451 , as in [ line [ start ] ] , @xmath452 and the claim holds by binomial expansion .",
    "assume it still holds for some @xmath5 such that @xmath453 .",
    "then for @xmath454 , we have @xmath455 . in [ line [ degr-1 ] ] , @xmath456 so we only need to show that @xmath457 also has the property that @xmath458 , for every monomial in @xmath440 .",
    "this is true because @xmath449 in @xmath459 , and in @xmath460 we have @xmath461 by hypothesis and @xmath462 for @xmath463 , and thus @xmath464 .",
    "we want to generalize algorithm  [ divisionalg ] to @xmath44 .",
    "first we need another expression for numerical polynomials .",
    "[ numericalpoly ] let @xmath11 be a numerical polynomial , i.e. , @xmath45 with a polynomial @xmath363 $ ] satisfying @xmath364 for all @xmath365 .",
    "then there exists @xmath405 , and @xmath465 $ ] for @xmath402 such that @xmath466 for all @xmath439 .",
    "suppose @xmath467 $ ] for some integer @xmath405 . for @xmath402",
    ", define @xmath468 . by the binomial expansion of @xmath469 , it is easy to see that this is a polynomial with integer coefficients .",
    "similarly , for an element @xmath470 , there exists @xmath471 and @xmath472 $ ] ( @xmath473 ) , satisfying @xmath474 for @xmath100 and @xmath475 .",
    "we call @xmath476 a * representation * of @xmath477 .",
    "another simple property is that for @xmath478 and @xmath479 , we can extend to a common period @xmath480 and @xmath481 and @xmath482 .",
    "@xmath483 @xmath405 and @xmath406 , @xmath484 $ ] , for @xmath408 such that @xmath485 find a common period @xmath486 for @xmath487 , such that @xmath488 and @xmath489 .",
    "apply algorithm 1 to @xmath490 and @xmath491 , get @xmath492 , @xmath493 $ ] , @xmath494 . set @xmath495 , and get @xmath406 , @xmath407 $ ] , for @xmath408 from @xmath496 .",
    "[ gcd ] let @xmath487 be numerical polynomials , or more generally @xmath497 . define @xmath498 .",
    "then by the generalized division over @xmath44 ( algorithm [ qpdivision ] ) , we have @xmath499 .",
    "we call @xmath130 the * generalized gcd * of @xmath11 and @xmath369 , and denote it by @xmath500",
    ".    apply algorithm [ qpdivision ] successively .",
    "define @xmath501 to be some constituent polynomial of @xmath11 and @xmath502 to be some constituent polynomial of @xmath369 ( a * constituent polynomial * of a quasi - polynomial is a polynomial on a congruence class modulo its period ) .",
    "in general , if @xmath503 , define @xmath504 to be some constituent polynomial of @xmath505 . we will prove that @xmath506 for some @xmath99 by induction on @xmath434 and @xmath432 ( recall that @xmath432 means the leading coefficient of @xmath433 . ) .",
    "hence , since our choice of constituent polynomial was arbitrary , we will eventually have a remainder of 0 after finitely many steps .",
    "hence the algorithm terminates after finitely many steps , or else there exists an infinite path in decision tree .",
    "if @xmath507 and @xmath508 , the algorithm works the same as the classical euclidean algorithm for integers . if @xmath509 , then since @xmath510 for @xmath41 , we have three cases for the next step :    1 .",
    "@xmath511 2 .",
    "@xmath512 and @xmath513 .",
    "after finitely many iterations , one will either have @xmath514 , or @xmath511 .",
    "3 .   @xmath512 and @xmath515 . in the next step , @xmath516 .",
    "so the algorithm terminates after finitely many steps .    tracing through a natural generalization of the euclidean algorithm",
    ", we can get @xmath517 such that @xmath518 .",
    "more generally for @xmath519 we have    [ ggcd ] let @xmath519 , @xmath520 .",
    "then @xmath521 and there exists @xmath522 with @xmath523 such that @xmath524    this implies , in particular , that every finitely generated ideal of @xmath44 is principal .",
    "it is peculiar that in fact @xmath44 is not a noetherian ring .",
    "for example , take @xmath525 to be the function such that @xmath526 if @xmath527 , and 0 otherwise",
    ". then @xmath528 is not a finitely generated ideal .",
    "recall that for any @xmath529 , there exist unimodular matrices @xmath530 , i.e. , determinant @xmath531 , such that @xmath532 with @xmath533 and @xmath78 is called the smith normal form of @xmath534 . by generalized division over @xmath44 ( algorithm  [ qpdivision ] ) and corollary  [ ggcd ]",
    ", we can generalize the classical smith normal form theorem as follows .",
    "[ smith ] for any @xmath535 , define a matrix function @xmath536 such that @xmath150 is the smith normal form of @xmath537 .",
    "then we have @xmath538 and there exists @xmath539 , @xmath540 such that @xmath541 are unimodular for @xmath100 and @xmath542 .",
    "we call this matrix function @xmath78 the * generalized smith normal form * of @xmath534 .    before the proof ,",
    "let us see a simple example for generalized gcd and generalized smith normal form .",
    "let @xmath543 , @xmath544 .",
    "denote @xmath545 , namely @xmath546 .",
    "+ put @xmath547 and @xmath548 , @xmath549 , @xmath550 , @xmath551 , @xmath552 , @xmath553 , we have @xmath554 for @xmath555 , let @xmath556 $ ] , where @xmath557 and @xmath558 $ ] , where @xmath559 and @xmath560 $ ] , where @xmath561 we have @xmath562 is the smith normal form for @xmath46 for @xmath563 where @xmath564 and @xmath565 .    the following proof is based on the proof for classical smith normal form in @xcite .",
    "[ row]let @xmath566 with @xmath567 .",
    "then there is a matrix @xmath568 with first row @xmath569 $ ] and determinant @xmath570 .    by induction on @xmath571 .",
    "for @xmath572 , trivial .",
    "now suppose the lemma is true for @xmath573 , where @xmath574 , and let @xmath575 be a matrix with first row @xmath576 $ ] and determinant @xmath577 .",
    "since @xmath578 by corollary  [ ggcd ] , there exist @xmath579 such that @xmath580 .",
    "put @xmath581 then we have @xmath568 with first row @xmath582 $ ] and @xmath583 .",
    "write @xmath584 .",
    "if @xmath585 , then switch rows and columns so that this is true . without loss of generality , we may assume that @xmath586 divides all elements in the column .",
    "if not , let @xmath587 .",
    "by corollary @xmath588 , there exist @xmath589 with @xmath523 such that @xmath590 . by lemma @xmath591",
    ", there exists a matrix @xmath592 with first row @xmath593 $ ] and determinant @xmath594 .",
    "so we have @xmath595 such that @xmath596 divides all elements in the column .",
    "suppose @xmath586 divides all elements @xmath597 .",
    "first , by the same process as above , we can assume that @xmath586 divides all elements in the first row and column . by elementary row and column operations ,",
    "all the elements in the first row and column , other than the @xmath598 position , can be made zero .",
    "if there is some element @xmath597 , @xmath599 is not divisibleby @xmath586 , add column @xmath135 to column @xmath594 and repeat the previous step to replace @xmath586 with one of its divisor which divides @xmath597 .",
    "thus we must finally reach the stage where the element in the @xmath598 position divides every element of the matrix and all the other elements of the first row and column are zero . repeat the entire process with the submatrix obtained by deleting the first row and column .",
    "we can see that the algorithm we give in the proof of theorem  [ ehrhartconj ] is not very efficient . in this section , by the theory of generalized division developed in the previous section , we are able to compute some special cases more efficiently .",
    "first recall the classical popoviciu formula .",
    "let @xmath12 and @xmath13 be relatively prime positive integers .",
    "then the number of nonnegative integer solutions @xmath14 to the equation @xmath15 is given by the formula .",
    "now consider the equation @xmath600 where @xmath601 are integeral polynomials of @xmath2 . by the theory of generalized division , the above formula for the number of nonnegative integer solutions @xmath602 can be easily generalized to the following        then as mentioned in the introduction",
    ", we can consider the number of solutions @xmath24 to the matrix equation where the @xmath26 and @xmath27 are fixed positive integers and @xmath608 for @xmath29 .",
    "write @xmath609 .",
    "we assume that @xmath31 , so that there exist integers ( not unique ) @xmath32 such that @xmath33 now define two regions @xmath34 for @xmath29 .",
    "then if @xmath35 is in the positive span of the columns of the matrix in , there exist the following popoviciu - like formulas ( * ? ? ?",
    "* theorem 4.3 ) for @xmath610 , the number of solutions of .",
    "notice that in the above formula , everything can be directly generalized to the ring @xmath94 $ ] using generalized division and generalized gcd .",
    "in other words , we can replace the @xmath26 , @xmath27 , and @xmath39 by polynomials in @xmath2 in such a way that for all values of @xmath2 , the condition @xmath31 always holds .",
    "for example , consider the system @xmath40 then for @xmath41 , we have that @xmath42 so the number of solutions @xmath43 is counted by the formula of @xmath610 for @xmath619 and it is easy to see that @xmath620 .      for polytopes in dimension two , there is an efficient algorithm for computing the number of lattice points using continued fractions .",
    "see ( * ? ? ?",
    "* chapter 15 ) for the algorithm in the case of non - parametrized two dimensional polytopes .    by the generalized division theory",
    ", we can generalize this algorithm to the case of a polytope whose vertices are given by polynomials .",
    "notice that the only difference is the generalization of continued fractions : for any @xmath621 $ ] , we expand @xmath622 as a continued fraction .",
    "then by theorem  [ gcd ] , for @xmath100 , the terms in the expansion are quasi - polynomials and the number of terms does not depend on @xmath2 .      for @xmath625",
    ", we have @xmath626 & n=2m\\\\    [ m-1;\\,3,\\,1,\\,m-1 ] & n=2m-1    \\end{cases}.\\]]and for the cone generated by @xmath627 and @xmath628 , we have the following efficient algorithm of decomposition into prime cones .",
    "matthias beck and sinai robins , _ computing the continuous discretely : integer - point enumeration in polyhedra _ , undergraduate texts in mathematics , springer , new york , 2007 , available for download from http://math.sfsu.edu/beck/ccd.html .",
    "zhiqiang xu , an explicit formulation for two dimensional vector partition functions , _ integer points in polyhedra  geometry , number theory , representation theory , algebra , optimization , statistics _ ,",
    "contemporary mathematics * 452 * ( 2008 ) , 163178 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a polytope with rational vertices . </S>",
    "<S> a classical theorem of ehrhart states that the number of lattice points in the dilations @xmath1 is a quasi - polynomial in @xmath2 . </S>",
    "<S> we generalize this theorem by allowing the vertices of @xmath3 to be arbitrary rational functions in @xmath2 . in this case </S>",
    "<S> we prove that the number of lattice points in @xmath3 is a quasi - polynomial for @xmath2 sufficiently large . </S>",
    "<S> our work was motivated by a conjecture of ehrhart on the number of solutions to parametrized linear diophantine equations whose coefficients are polynomials in @xmath2 , and we explain how these two problems are related . </S>"
  ]
}