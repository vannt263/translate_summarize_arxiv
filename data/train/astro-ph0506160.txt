{
  "article_text": [
    "thermal instability ( ti ) is one of key physical processes in astrophysical environments where optically thin gas cools radiatively and condenses @xcite .",
    "it has been applied to explain , for instance , the multiple phases of interstellar gas @xcite , the formation of globular clusters @xcite , cooling flows in clusters of galaxies @xcite , and the generation of turbulent flows in the interstellar medium ( ism ) @xcite . cold dense clumps or clouds that are confined by the background pressure can form in a hot , radiatively cooling medium via ti (  see * ? ? ? * ) . in the simplistic picture of ti ,",
    "those overdense regions undergo a quasi - static compression in near pressure equilibrium @xcite .",
    "however , this _ isobaric _ condensation occurs only when the clouds are small enough to adjust to pressure changes faster than the gas cools . according to numerical simulations of the collapse of thermally unstable clouds @xcite",
    ", the clouds may undergo a _ supersonic _",
    "compression when the cloud size is comparable to the cooling scale , @xmath6 ( the distance over which a sound wave travels in a cooling time ) , while the clouds much larger than this scale cool _",
    "isochorically_.    it has been suggested that the ti could be responsible for the formation of protoglobular cluster clouds ( pgccs ) in protogalactic halos , which can explain the origin of old halo globular clusters @xcite . among many models of globular cluster formation",
    "(  see * ? ? ?",
    "* ; * ? ? ?",
    "* ) , this model based on ti is classified as a secondary model in which the two - phase of cold dense clouds in hot background gas was developed through ti in protogalactic halos and the condensed clouds further collapsed to become globular clusters .",
    "we previously studied the development of ti in detail using one and two - dimensional numerical simulations with spherically symmetric and axisymmetric _ isolated _ gas clouds in static environments of uniform density @xcite .",
    "however , according to the current paradigm of cold dark matter models of structure formation , large protogalaxies comparable to the milky way formed via hierarchical clustering of smaller systems .",
    "hence , inevitably density perturbations should exist on a wide range of length scales inside the protogalactic halos , and _ an ensemble of _ clumps emerge .",
    "in addition , although the thermal process initiates the formation of the clumps , eventually the self - gravity should become important , since the gravitational time scale is just a few times longer than the cooling time scale . as a result the initial clumps grow by both thermal and gravitational processes to become bound clouds .",
    "hence , the thermal - gravitational instability should be considered (  see * ? ? ?",
    "in this paper we study the thermal - gravitational instability in a hot background whose physical parameters are relevant for protogalactic halo gas .",
    "three - dimensional simulations were made .",
    "the simulations started with random gaussian density perturbations of various power spectra .",
    "the evolution of gas under the influence of thermal - gravitational instability was followed up to the formation of gravitationally bound clouds .",
    "the physical properties of the clouds are examined in detail .",
    "our goal is to study how self - gravity and gravitational interactions affect the physical and dynamical properties of clouds that condense initially via ti .",
    "although our models would be yet too simple to be directly applied to the real situation , we try to extract the implications of our results on the formation of pgccs in protogalactic halos . in  2",
    "our models and numerical details are described .",
    "simulation results are presented in  3 , followed by summary and discussion in  4 .",
    "a gas of @xmath7k in a cubic , periodic simulation box was considered .",
    "this temperature corresponds to that of an isothermal sphere with circular velocity @xmath8 , representing the halo of disk galaxies like the milky way .",
    "the fiducial value of the mean background density of hydrogen nuclei was chosen to be @xmath9 . a case with higher density @xmath10",
    "was also considered to explore the effects of background density ( model d , see table 1 below ) . for the primordial gas with an assumed ratio of he / h number densities of 1/10 ,",
    "the gas mass density is given by @xmath11 . with @xmath7k and @xmath9 ,",
    "the initial cooling time scale is @xmath12 yrs . on the other hand , the free - fall time scale , or the gravitational time scale , is @xmath13 yrs , which is about seven times longer than the cooling time scale .",
    "note that @xmath14 , while @xmath15 .",
    "so cooling , compared to gravitational processes , becomes relatively more important at higher densities .",
    "the cooling length scale is given as @xmath16 kpc , where @xmath17 is the sound speed .",
    "the simulation box was set to have the size @xmath18 .",
    "it was chosen to be large enough to accommodate a fair number of thermally unstable clouds of cooling length size , and so to get fair statistics of cloud properties .    to mimic density perturbations existed on a wide range of length scales inside the protogalactic halo ,",
    "the initial density field was drawn from random gaussian fluctuations with predefined density power spectrum .",
    "the density power spectrum was assumed to have the following power law @xmath19 where @xmath20 is the three - dimensional wavenumber , @xmath21 . in order to explore how the initial density perturbations affect the formation and evolution of clouds , three types of density power spectrum",
    "were considered : white noise with @xmath22 as the representative case , as well as random fluctuation with @xmath23 ( model r ) and kolmogorov spectrum with @xmath24 ( model k ) . only the powers with @xmath20 s corresponding to wavelengths @xmath25 were included .",
    "the amplitude of density power spectrum was fixed by the condition @xmath26 .",
    "the initial temperature was set to be uniform , assuming _ isothermal _ density perturbations .",
    "the initial velocity was set to be zero everywhere in the simulation box .",
    "the gas - dynamical equations in the cartesian coordinate system including self - gravity , radiative cooling and heating are written as @xmath27 @xmath28 @xmath29 =   -\\rho \\mathbf v \\cdot \\nabla \\phi + \\gamma - \\lambda,\\ ] ] @xmath30 where @xmath31 , @xmath32 and @xmath33 are the cooling and heating rates per unit volume , and the rest of the variables have their usual meanings .",
    "for the adiabatic index , @xmath34 was assumed .",
    "the hydrodynamic part was solved using an eulerian hydrodynamics code based on the total variation diminishing ( tvd ) scheme @xcite .",
    "the version parallelized with the message - passing interface ( mpi ) library was used .",
    "the self - gravity , cooling and heating were treated after the hydrodynamic step . for the self - gravity ,",
    "the gravitational potential was calculated by the usual fast fourier transform ( fft ) technique .",
    "then , the gravitational force was implemented in a way to ensure second - order accuracy as @xmath35 where @xmath36 is the velocity updated in the hydrodynamic step and @xmath37 is the potential calculated with @xmath38 .    for the radiative cooling , the collisional ionization equilibrium ( cie ) cooling rate for a zero - metalicity ( primordial ) , optically thin gas in the temperature range of @xmath39k @xmath40 @xmath41k",
    "was adopted @xcite .",
    "the cooling function , @xmath42 , is plotted in figure 1 as the solid line . with @xmath43 for @xmath44k , it was assumed that the extra - galactic / stellar uv radiation photo - dissociates molecules in the protogalactic halo and so prohibits the gas from cooling below @xmath39 k. accordingly , the minimum temperature was set to be @xmath45k . note that the cie cooling rate is higher than the cooling rate based on the non - equilibrium ionization ( neq ) , which had been adopted in our previous two - dimensional simulations , especially near the h and he @xmath46 line emission peaks ( see figure 1 of * ? ? ? * ) .",
    "the higher cooling rate was chosen to accentuate the effects of cooling over those of gravitational processes .",
    "if molecules have formed efficiently via gas phase reactions enough to be self - shielded from the photo - dissociating uv radiation , or if the halo gas had been enriched by metals from first - generation supernovae , however , the gas would have cooled well below @xmath39 k. in order to explore how the additional cooling below @xmath39k affects the formation and evolution of clouds , in a comparison model ( model c ) , the following _ mock _ cooling function in the range of @xmath47k @xmath48 @xmath39k was adopted @xmath49 although this mock cooling rate was designed to represent typical ro - vibrational line emissions for the gas with abundance of @xmath50 @xcite , the exact amplitude and form of @xmath51 are not important in our discussion .",
    "figure 1 shows @xmath51 as the dashed line .",
    "the minimum temperature was set to be @xmath52k in the c model .",
    "it was assumed that the background gas was initially under thermal balance and there existed a constant background heating equal to the cooling of the initial background gas , that is , @xmath53 to prevent any spurious heating the highest temperature was set to be @xmath54 .",
    "this ad - hoc heating was applied in order to maintain the temperature of the background gas with initial mean density at @xmath55 .",
    "this can be provided by several physical processes such as turbulence , shocks , stellar winds and supernova explosions in protogalaxies . without this",
    "heating the background gas would have cooled down in a few @xmath56 .",
    "it has been pointed out that the thermal conduction can affect profoundly ti in the ism @xcite . with the spitzer value of thermal conductivity for ionized gas , @xmath57 @xcite ,",
    "the thermal conduction time scale is @xmath58 it shows that @xmath59 is much longer than @xmath60 across the cooling length ( @xmath61 kpc ) , so the thermal conduction is expected to be negligible .",
    "but the clouds finally emerged in our simulations have radius of @xmath62 pc ( see  3.3 ) . even in such scale @xmath59",
    "is still a few times longer than , or at most comparable to , @xmath60 .",
    "also those clouds are gravitationally bound , so the thermal evaporation should not be important .",
    "in addition , weak magnetic field , if it exists , may reduce significantly the value of thermal conductivity from the spitzer value @xcite , although we do not explicitly include magnetic field in this work .",
    "all together , it is expected that the thermal conduction does not play a major role in the regime we are interested in , and hence we ignored it in our simulations .",
    "simulations were made with @xmath63 , @xmath64 and @xmath65 grid zones , allowing a uniform spatial resolution of @xmath66 pc .",
    "simulations started at @xmath67 and lasted up to @xmath68 .",
    "this terminal time corresponds to @xmath69 , so gravitational bound clouds should have emerged by then .",
    "total seven simulations are presented in this paper , which differ in numerical resolution , the power spectrum of initial density perturbations , cooling , and mean background density .",
    "model parameters are summarized in table 1 .",
    "we start to describe the results by looking at the global evolution of gas and its morphological distribution .",
    "figure 2 shows the density power spectrum at different times in the s1024 model where @xmath70 initially . in the figure",
    "the dimensionless wavenumber is given as @xmath71 , which counts the number of waves with wavelength @xmath72 inside the size @xmath73 of simulation box .",
    "the power spectrum is presented in a way that @xmath74    with @xmath75 , initially ti should work .",
    "the noticeable features in the early evolution of power spectrum are the followings : during @xmath76 the powers with @xmath77 ( or @xmath78 ) are reduced significantly , and then the powers on those small scales grow back by @xmath79 .",
    "the initial decrease of small scale powers is a consequence of initial _ isothermal _ density perturbations .",
    "the accompanying pressure fluctuations have generated sound waves , and those sound waves have ironed out the perturbations of small scales .",
    "the follow - up , fast growth of small scale powers is due to _ nonlinear _ behavior of ti .",
    "although the _ linear _ growth rate is independent of scale ( for @xmath80 ) , the growth can be limited once the density increases and the cooling length becomes smaller than the perturbation scale . with the perturbation",
    "scale smaller than the cooling length , the further condensation progresses _ isochorically _ and the growth slows down . as a result , small scale clumps appear first .",
    "this point has been made previously , for example , by @xcite .",
    "in addition , when perturbations get compressed by the background pressure , the density in the central region increases first and clouds form inside out .",
    "this contributes the fast growth of small scale powers too .",
    "by the end of this early ti stage , @xmath79 , the power spectrum peaks at @xmath81 .",
    "after @xmath79 , the self - gravity starts to play a role .",
    "clouds grow through gravitational infall as well as compression by the background pressure . eventually , massive clouds form through cloud - cloud collision , or merging among clouds ( see below ) . during these stages , the powers grow over all scale . at the same time the peak shifts to smaller wavenumbers , reflecting the appearance of larger , massive clouds    we note that with periodic boundary , once the power of the scale corresponding to the box size reaches nonlinear , the large scale clustering becomes saturated .",
    "the power spectrum in figure 2 shows that in the s1024 model the scale which has gone nonlinear by the end is @xmath82 , indicating that the assumption of periodic boundary should not have affected our results significantly . in any case",
    "our major focus lies on the properties of individual clouds rather than their clustering .    in order to show how clouds form and grow as well as how their distribution evolves , three - dimensional iso - density surfaces at four different times in the s1024 model",
    "are presented in figure 3 . as noted above , at the end of the early ti stage ( @xmath83 )",
    "mostly small clouds appear . by the end of the follow - up stage of ti and gravitational growth , @xmath84 ,",
    "the clouds become larger . during late stage ,",
    "the clouds become even larger but their number reduces , as a result of cloud - cloud mergers , which can be seen in the bottom two images .      in order to study the properties of formed clouds",
    "they were identified using the algorithm clumpfind described by @xcite .",
    "the algorithm basically tags cells around a density peak as the `` cloud cells '' , if they satisfy the prescribed criteria of density and temperature .",
    "we chose the following criteria : @xmath85 and @xmath86k . here",
    "@xmath87 is the _ initial _ mean density .",
    "there is an arbitrariness in these threshold values . but",
    "the identification of clouds does not depend sensitively on the choices of threshold values , since clouds are well delineated by rather sharp jumps in density and temperature .",
    "in addition , we qualified only those with at least @xmath88 cells or more as clouds .",
    "once clouds were identified , their various quantities were calculated .",
    "the first row of figure 4 shows the number of clouds , @xmath89 , as a function of the cloud mass , @xmath90 , at the times same as those in figure 3 in the s1024 model . by @xmath91 a significant number of clouds , @xmath92 , form through the growth of initial high density peaks by ti .",
    "the mass function at @xmath91 is roughly _",
    "gaussian _ , since the initial density perturbations were drown from a random gaussian distribution . during the follow - up stage of ti and gravitational growth ,",
    "more peaks develop into clouds and at the same time they become massive .",
    "the mass function evolves roughly into the _ log - normal _ distribution , shown at @xmath93 .",
    "the log - normal distribution is a signature of nonlinear structure formation , as reported in various simulations ( see , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . during late stage",
    ", more massive clouds develop through gravitational merging as pointed with figure 3 , and so the mass function extends to higher mass .",
    "the high mass tail of the mass function beyond the peak follows approximately a _ power - law _ distribution .",
    "when the mass function is fitted to @xmath94 for @xmath95 , the value of @xmath5 decreases from @xmath96 at @xmath97 to @xmath98 at @xmath99 .      with the mass , @xmath90 , and volume , @xmath100 , of identified clouds",
    ", the effective radius was taken as @xmath101 and the mean density was calculated as @xmath102 .",
    "the second and third rows of figure 4 show @xmath103 and @xmath104 in the s1024 model . for energetics the kinetic energy relative to the cloud s center of mass , @xmath105 ,",
    "the thermal energy , @xmath106 , and the gravitational energy , @xmath107 , were calculated for identified clouds .",
    "the procedure by which the gravitational energy was calculated is presented in appendix a along with a note of caution .",
    "the fourth row of figure 4 shows the ratio of positive to negative energies , or the _ virial _",
    "parameter @xmath108 the parameter @xmath109 tells whether clouds are primarily pressure - bound ( @xmath110 ) or gravitationally bound ( @xmath111 ) . among the gravitationally bound clouds",
    ", the condition @xmath112 indicates that they are approximately in virial equilibrium , although , strictly speaking , the condition applies only for a stable system where the external pressure is negligible and the moment of inertia does not change with time .    during the early stage of ti ( @xmath113 ) ,",
    "as small clumps grow isobarically , their density increases gradually , but @xmath114 has not yet reached the isobaric factor of @xmath115 .",
    "the self - gravity is negligible with @xmath116 during this stage . in the follow - up stage of ti and gravitational growth ( @xmath117 ) ,",
    "pressure - bound clouds develop fully .",
    "those clouds have roughly @xmath118 , the maximum isobaric increase from the initial density , and the mean density is a bit higher in clouds with larger mass .",
    "their radius scales roughly as @xmath119 , which can be seen in the second row of figure 4 .",
    "the virial parameter has @xmath120 for all clouds , confirming that they are still gravitationally unbound .",
    "the pressure - bound clouds follow @xmath121 , which can be understood as follows . in those clouds ,",
    "the thermal energy is dominant over the kinetic energy , @xmath122 . with @xmath123 in those clouds , the thermal energy scales as @xmath124 . on the other hand ,",
    "the gravitational energy scales approximately as @xmath125 , since larger clouds have slightly more concentrated mass distribution .",
    "as clouds grow further primarily through merging in late stage , some of them become massive enough to be gravitationally bound .",
    "after that point clouds can be divided into two populations of distinct properties ( see the last two times of figure 4 ) : pressure - bound clouds with smaller mass and gravitationally bound clouds with larger mass .",
    "the pressure - bound clouds have the properties similar to those found in the earlier stage .",
    "they have mean density @xmath126 , where @xmath127 is the mean background density .",
    "note that the background density continues to decrease as more mass goes to clouds . by the end of the s1024 simulation , @xmath99 ,",
    "only @xmath128 of gas mass remains in the background .",
    "so the mean density of the pressure - bound clouds decreases with time .",
    "those pressure - bound clouds have @xmath120 and follow @xmath121 .",
    "the gravitationally bound clouds appear first at @xmath129 or @xmath130 in the s1024 model . in those clouds",
    "the self - gravity enhances the density and the mean density of the clouds reaches up to @xmath131 or even higher by @xmath99 .",
    "the fourth raw of figure 4 shows that the gravitationally bound clouds are approximately in virial equilibrium with @xmath112 .",
    "in addition , we found that in those clouds the kinetic energy is not smaller but sometimes larger than the thermal energy as expected in a virialized system , and both the gravitational energy , @xmath107 , and the positive energy , @xmath132 , scale as @xmath133 .",
    "two points are noted on the gravitationally bound clouds .",
    "1 ) although these clouds have @xmath112 , they are not in steady - state .",
    "the clouds lose the positive energy rather quickly through cooling and contract further .",
    "but at the same time the cloud mass continues to grow through merging .",
    "2 ) the gravitational energy of these gravitationally bound clouds scales as @xmath125 , because their radius is in a relatively narrow range of @xmath134 pc regardless of their mass , as shown in the second row of figure 4 .",
    "since there is no physically obvious reason why the clouds with different mass should have similar radii , it should be understood as the result of dynamical evolution .",
    "however , their radius is somewhat larger at @xmath99 than at @xmath97 .",
    "this is related to the increase of angular momentum in the clouds with time ( see the next subsection ) .",
    "the distinction between the pressure - bound and gravitationally bound clouds in late stage can be understood with the _ critical _ mass @xmath135 which is the maximum stable mass for an isothermal sphere confined by the background pressure @xmath136 ( see _ e.g. , _ * ? ? ?",
    "* ; * ? ? ?",
    "* ) . for @xmath137 k and the background pressure four times smaller than the initial pressure ( due to decrease in the background density ) , the critical mass is @xmath138 , which coincides well with the transition mass scale in the last two times of figure 4",
    "incidentally , this mass is similar to the jeans mass of clouds , which is given as @xmath139 where @xmath140 is the jeans length ( see _ e.g. , _ * ? ? ?",
    "although the simulated model would be too simple to represent a real protogalactic halo , it is tempting to regard the gravitationally bound clouds as possible candidates for pgccs .",
    "that is , some of them may further cool down below @xmath141 either by uv self - shielding of h@xmath142 molecules or by self - enrichment of metals due to first generation type ii supernovae , possibly leading to star formation .",
    "if about ten of them turn into globular clusters , their number density would be @xmath143 0.01 clusters / kpc@xmath144 .",
    "however , the typical size of globular clusters @xmath145 pc or so .",
    "so the clouds should contract further by more than a factor of 10 .",
    "but the further collapse is controlled by the rotation of clouds ( see  3.4 below ) . in addition",
    ", the typical mass of globular clusters is @xmath146 or so .",
    "so if these gravitationally bound clouds were to become globular clusters , the star formation efficiency should be @xmath147 or so with @xmath148 of their mass dispersed back to protogalactic halo .",
    "it was pointed out by @xcite that `` artificial fragmentation '' due to errors arising from discretization occurs in numerical simulations with self - gravity .",
    "they argued that the artificial fragmentation can be suppressed if resolution is maintained high enough that , for instance , the `` jeans number '' @xmath149 or so for isothermal collapses . here",
    "@xmath140 is the local jeans length .",
    "we found that although the constraint was not complied in a few high density zones , @xmath150 was kept to be always smaller than 0.4 in the s1024 simulation . in any case",
    ", we followed only up to the formation of bound clouds , not the subsequent evolution leading to fragmentation of those clouds . so no obvious fragmentation was observed .",
    "an important property of clouds that controls the dynamical state and affects the eventual fate is their rotation . to quantify it , the angular momentum of clouds relative to their center of mass , @xmath151 , was calculated .",
    "the bottom row of figure 4 shows the specific angular momentum of clouds , @xmath152 , in the s1024 model .    in pressure - bound clouds , rotation plays a minor role in their dynamical evolution , since the rotational energy is smaller by an order of magnitude than the thermal energy .",
    "but we found that rotation can be dynamically important in gravitationally bound clouds .",
    "the specific angular momentum of those gravitationally bound clouds is larger than that of pressure - bound clouds , which can be seen clearly at @xmath99 .",
    "in fact the gravitationally bound clouds with a same @xmath90 have higher angular momentum at later time . for example",
    ", the clouds with @xmath153 have a few times larger @xmath154 at @xmath99 than at @xmath97 .",
    "this is because the clouds have grown mostly through merging in late stage and they have gained angular momentum through merging as well as tidal torque .",
    "its direct consequence is that the clouds at later stage have larger radius , as noted in the previous subsection .",
    "we note that the clouds in our simulations are ever evolving .",
    "so it is not meaningful to define the canonical properties of clouds such as @xmath103 and @xmath154 as a function of @xmath90 .",
    "the rotation of gravitationally bound objects is often characterized by the dimensionless _",
    "parameter @xcite @xmath155 it measures the degree of rational support of the systems with @xmath156 in the context of cosmological @xmath157-body simulations , it has been shown that the typical value of @xmath158 for gravitationally bound objects which acquired angular momentum through gravitational torque is @xmath159 (  see * ? ? ?",
    "* ) . in figure 5",
    "red squares represent the spin parameter for the gravitationally bound clouds with @xmath160 at @xmath99 in the s1024 model .",
    "it is clear that @xmath158 of our gravitationally bound clouds is significantly larger than 0.05 .",
    "all except one have @xmath161 and the mean value is @xmath4 .",
    "it is because the clouds have gained angular momentum through merging as well as torque .    with such large values of @xmath158 , the degree of rotational support of the gravitationally bound clouds",
    "should be already substantial .",
    "hence , rotation should be the key parameter that determines whether some of those clouds could become pgccs and collapse further to globular clusters .",
    "for instance , in a dissipative collapse that conserves angular momentum , the clouds with @xmath162 can contract only by a factor of a few , before they become completely rotationally supported and disk - shaped .",
    "however , yet it is not clear whether we should conclude that those clouds with @xmath162 can not evolve into globular clusters .",
    "it is because we can not rule out the possibility that the clouds may be able to lose most , say @xmath163 , of their angular momentum , while they collapse and lose @xmath164 of their mass .",
    "for instance , in the so - called _ self - enrichment model _ of globular cluster formation , first generation type ii supernovae govern star formation and the removal of residual gas (  see * ? ? ? * ; * ? ? ? * ) . in this model",
    "the star formation may have occurred preferentially at the core , and most gas in the outskirt with large angular momentum may have been blown out .",
    "in addition , as noted above , the gravitationally bound clouds found at an earlier time have smaller angular momentum .",
    "so if the clouds were detached from background and started to collapse earlier , the angular momentum restriction would be somewhat less severe .",
    "also the clouds emerged from different environments could have smaller angular momentum ( for instance , see  3.8 ) . in any case , subsequent evolution of the gravitationally bound clouds is beyond the scope of this paper , so the possible connection between these clouds and pgccs should be left as a future study .",
    "shape is another property of clouds that reflects their dynamical state . in order to quantify it , we examined the _ shape _ parameters defined as @xmath165 with each cloud fitted to triaxial ellipsoid with axes of @xmath166 .",
    "the shape parameters have been commonly used to study clumps in numerical simulations @xcite . in order to find them , first the moment of inertia tensor ,",
    "@xmath167 was constructed for each cloud . here",
    "@xmath168 is the displacement relative to the cloud s center of mass and the integral is taken over the cloud volume .",
    "then , from the three eigenvalues of the tensor , @xmath169 , the shape parameters were calculated as @xmath170 the clouds with @xmath171 are of prolate shape and the clouds with @xmath172 and @xmath173 are of oblate shape , while triaxial clouds have @xmath174 .",
    "spherical clouds have @xmath175 .    in the previous study of isolated , thermally unstable clouds using two - dimensional simulations in cylindrical geometry",
    ", we showed that the cloud shape changes in the course of the evolution @xcite .",
    "the degree of oblateness or prolateness is enhanced during the initial cooling phase , as expected .",
    "but it can be reversed later due to the supersonic infall along the direction perpendicular to the initial flatness or elongation .    in figure",
    "6 dots represent clouds in the @xmath176 plane at four times in the s1024 model .",
    "lines divide the domain into three regions of roughly prolate ( left ) , triaxial ( middle ) and oblate ( right ) shapes .",
    "the panel for @xmath91 indicates that most clouds formed as a result of ti at early stage are preferentially of prolate shape .",
    "this is can be understood from the fact that filaments are the morphology dominant next to knots of clouds .",
    "by @xmath93 some of prolate clouds have been transformed to be oblate , as the result of the shape reversal , which was observed in the two - dimensional study .",
    "however , the figure shows that in late stage clouds tend to shift back to be prolate again .",
    "this is because gravitational merging results preferentially in clouds of elongated prolate shape .",
    "the gravitationally bound clouds with @xmath160 , shown in figure 5 , are marked with red circles in the panel for @xmath99 .",
    "it is interesting to note that unlike most clouds , those massive clouds are preferentially of oblate shape .",
    "it is because those clouds have large angular momentum and a substantial degree of rational support .",
    "convergence is an important issue in any numerical simulations .",
    "we tested it by comparing the results of simulations with different resolution , s1024 , s0512 and s0256 models ( see table 1 ) .",
    "figure 7 shows the density power spectrum of the s0512 and s0256 models , which can compared with that of the s1024 model in figure 2 .",
    "note that in our simulations the amplitude of the initial power spectrum was set by the condition @xmath177 with @xmath178 for all resolutions .",
    "simulations with different resolution covers different range of wavenumbers .",
    "so the simulations of lower resolution started with larger amplitude , as shown in the figure .",
    "otherwise , the evolution of the power spectrum looks similar in all three models .",
    "for instance , the two most noticeable features in figure 2 , the initial decrease and follow - up fast growth of small scale powers , are also present in figure 7 .",
    "but an interesting point is that the scale that suffered the initial decrease is insensitive to resolution , because it was caused by smoothing due traveling sound waves . on the other hand ,",
    "the scale of the peak in the power spectrum after the follow - up fast growth does depend on resolution . as a matter of fact , the peak at @xmath179 in the s0256 model occurs at the scale almost four times larger than in the s1024 model .",
    "this indicates that the small scale growth in our simulations was limited by resolution , as expected .",
    "figure 8 shows the mass function , virial parameter and specific angular momentum of clouds in the three models .",
    "the left panels show the results at early ti stage , while the right panels show the results at late merging stage . for early stage a different time was chosen for each model so that the density power spectrum has a similar amplitude . in late stage , however , the differences caused by the initial amplitude of power spectrum become insignificant , so @xmath180 is chosen for all three models .",
    "we see that the mass function have been converged for massive clouds , those with @xmath181 at the early stage and those with @xmath182 at @xmath180",
    ". however , the number of smaller mass clouds depends on numerical resolution , as expected . with the minimum number of @xmath183 zones for identified clouds , the minimum mass scales @xmath184 . on the contrary , at the early stage the virial parameter is larger in lower resolutions for clouds of all mass .",
    "it is because the clouds are less compact in lower resolution , and so their gravitational energy is smaller .",
    "but as the clouds grow more massive and larger in late stage , the difference in the virial parameter becomes smaller .",
    "the angular momentum of clouds is somewhat smaller in lower resolution at the early stage .",
    "it is partly because the time of the plot is different in different models .",
    "however , in late stage the angular momentum becomes comparable in all three models .",
    "overall , the formation of small mass clouds , initially through ti and subsequently by compression and infall , was affected by resolution in our simulations .",
    "however , we found that the massive , gravitationally bound clouds , which have formed mostly through gravitational merging , have the properties which are almost converged .",
    "the effects of different initial perturbations on the formation and evolution of clouds were examined by comparing the results of simulations with different initial density power spectrum , the k0512 and r0512 models , to those of the s0512 model ( see table 1 ) .",
    "the k0512 model started with more power on larger scales , while the r0512 model started with more power on smaller scales .",
    "figure 9 shows the density power spectrum of the k0512 and r0512 models . in both models",
    ", small scale powers suffered the initial decrease , as in the s0512 model .",
    "especially most of the powers in @xmath77 were erased substantially in the r0512 model .",
    "hence , the overall growth was delayed in the r0512 model . on the other hand ,",
    "the growth proceeded faster in the k0512 model , with more powers on large scales in the beginning .",
    "figure 10 shows the total number of clouds as a function of time in the three models with different initial density power spectrum .",
    "the overall evolution is similar ; the number of clouds increases during the ti and follow - up growth stages , but eventually decreases as gravitational merging progresses .",
    "but as noted above , the k0512 model evolves first and the s0512 and r0512 models follow .",
    "so clouds form from @xmath185 in k0512 , from @xmath186 in s0512 and from @xmath187 in r0512 . however , an interesting point is that the maximum number of clouds is about the same with @xmath188 in all three models .    in figure 11",
    "three - dimensional iso - density surfaces are plotted at two sets of times in the three models .",
    "different times were chosen in different models , since the formation and evolution of clouds proceeds differently .",
    "the upper panels show the surfaces when the number of clouds is highest , at @xmath189 for k0512 , @xmath190 for s0512 and @xmath191 for r0512 .",
    "the lower panels show the surfaces after the number of clouds have decreased a little bit due to merging , at @xmath179 for k0512 , at @xmath192 for s0512 and at @xmath193 for r0512 .",
    "the most noticeable feature is that the distribution is more `` filamentary '' in the k0512 model , but less `` filamentary '' in the r0512 model , than in the s0512 model .",
    "it is because that the initial large scale powers , which were largest in the k0512 model but almost absent in the r0512 model , have been developed into significant coherent structures in the cloud distribution .",
    "figure 12 shows the mass function , virial parameter and specific angular momentum of clouds in the three models .",
    "the same two sets of times as those in figure 11 were chosen .",
    "clouds in the k0512 ( r0512 ) model are slightly more ( less ) massive in the left panels and slightly less ( more ) massive in the right panels . however , considering the difference in the plotted time , the cloud mass function should be regarded as reasonably similar in the three models . on the other hand",
    ", the virial parameter of pressure - bound clouds follows the same diagonal strip in all three models .",
    "there is a spread in the distribution of angular momentum , again partly because the plotted time is different in different models .",
    "but the angular momentum of the clouds in high mass tail is similar .",
    "so we conclude that the properties of individual clouds , especially for massive clouds , are not sensitive to the initial perturbations , while the spatial distribution of clouds reflects the slope of initial density power spectrum .",
    "the effects of gas density on the formation and evolution of clouds were examined with the d0512 model , which has the background density 3 times larger than that of the s0512 mode . otherwise the two models are identical ( see table 1 ) . with @xmath194 ,",
    "the gravity is relatively less important in the d0512 model .",
    "figure 13 compares the mass function , virial parameter and specific angular momentum of clouds in the d0512 model ( red lines and dotes ) with those in the s0512 model at an early stage of ti ( @xmath195 ) and at a late stage of merging ( @xmath196 ) , respectively . in the d0512 model",
    "there are more clouds with larger mass , reflecting the higher background density .",
    "yet , the virial parameter is almost identical in the two models , indicating that the background density is not important in determining the energetics of individual clouds . as a matter of fact",
    ", we found that the properties of clouds , except the angular momentum , are not sensitive to the background density .",
    "the angular momentum of the clouds identified in the early stage of ti is similar in the two models .",
    "but in late stage the angular momentum is noticeably smaller in the higher background density model .",
    "the same trend is also obvious in the spin parameter of gravitationally bound clouds , which is shown for @xmath160 in figure 5 .",
    "while the spin parameter for the s0512 model ( blue triangles ) does not differ much from that for the higher resolution s1024 model ( red squares ) , the spin parameter for the d0512 model ( green circles ) is substantially smaller with the median value of @xmath197 .",
    "this is because the clouds formed in higher background density have experienced relatively less tidal torque and gravitational merging , through which they have acquired angular momentum .",
    "the effects of possible cooling further below @xmath141 were examined with the c0512 model , which includes a _ mock _ cooling given in equation ( 7 ) .",
    "otherwise it is same as the s0512 model ( see table 1 ) .",
    "figure 13 compares the mass function , virial parameter and specific angular momentum of clouds in the c0512 model ( black lines and dotes ) with those in the s0512 model .",
    "the cloud properties are similar overall , except the smaller thermal energy in the c0512 model , which is expected from the additional cooling . because the thermal energy counts for most of the positive energy , especially in pressure - bound clouds , the virial parameter is smaller in the c0512 model .",
    "but in massive , gravitational bound clouds , the kinetic energy is comparable to or sometimes larger than the thermal energy , as noted in  3.3 .",
    "so the effects of the additional cooling is less important in those clouds .    to quantify how much the additional cooling changes the thermal state of gas , we compare the mass distribution , @xmath198 , for the s0512 and c0512 models in figure 14 . the gas with @xmath199 in s0512 spreads below @xmath141 in c0512 , as expected .",
    "in addition some of the gas with @xmath200 has cooled below @xmath141 .",
    "but the additional cooling does not affect much the gas of higher temperature . even with this additional cooling the mass fraction peaks still at @xmath201 and most of the `` cloud gas '' has @xmath202 , not only because the assumed mock cooling is inefficient , but also because some of the gas has been reheated by shocks and compression .    here",
    "we should note that with lower temperature , the clouds in the c0512 model have smaller jeans mass and could go through further fragmentation . but with a fixed grid resolution , the simulation could not follow it .",
    "in fact , in the c0512 model , the jeans number , @xmath203 , reached up to @xmath204 in the center of some gravitationally bound clouds .",
    "however , as noted above , we did not intend to follow such fragmentation in this study .",
    "we study the role of self - gravity and gravitational interactions in the formation of clouds via thermal instability ( ti ) through three - dimensional hydrodynamic simulations .",
    "we considered the gas in protogalactic halo environment with @xmath205k and @xmath206 in a periodic box of 10 kpc and followed its evolution for up to 20 cooling time .",
    "we adopted idealized models in which a static , non - magnetized gas cools radiatively with initial isothermal density perturbations .",
    "a radiative cooling rate in ionization equilibrium for an optically thin gas with the primordial composition was used .",
    "in addition , an ad hot heating was included , which emulates feedbacks from stellar winds , supernovae , turbulence and shocks in order to maintain the thermal balance of background gas .",
    "the main results can be summarized as follows : 1 ) clouds form first on scales much smaller than the cooling length as a result of non - linear behavior of ti .",
    "2 ) those small clouds grow through compression by background pressure as well as gravitational infall , but eventually they merge by gravity to become gravitationally bound objects .",
    "3 ) the gravitationally bound clouds have acquired angular momentum through merging as well as tidal torque .",
    "so they have high angular momentum with the spin parameter of @xmath4 or so .",
    "4 ) the spatial distribution of clouds depends on initial perturbations , for instance , the slope of initial density power spectrum , but the properties of individual clouds are not sensitive to that .",
    "we note that the realistic picture of thermal - gravitational instability that in protogalactic halos should be more complex than in the numerical models considered here . some of key aspects include :",
    "1 ) the gas in real protogalactic halos is likely in a chaotic state induced during the formation of halos themselves .",
    "the chaotic flow motions would have suppressed the early formation of clouds via ti , but increased collisions of clouds once formed .",
    "2 ) protogalactic halos have their own structures , but the effects of those structures were ignored .",
    "for instance , the tidal torque exerted by the halo and/or the rotation in disk would have suppressed the formation of clouds .",
    "3 ) there are emerging evidences that magnetic field existed even in the early galaxies where the oldest stars formed ( see , * ? ? ? * ) .",
    "then , undoubtedly the magnetic field should have affected the formation and properties of clouds profoundly .",
    "4 ) it is well known that when a hot gas cools from @xmath207 k , it recombines out of ionization equilibrium because the cooling time scale is shorter than the recombination time scale @xcite . however , details of the cooling such as non - equilibrium ionization and and metal cooling below @xmath39k could have only minor effects on our main conclusions .",
    "although the numerical models are rather idealized to facilitate simulations , our results should provide crude insights on the formation of pgccs in protogalactic halos .",
    "the gravitationally bound clouds in our simulations have mass @xmath182 and radius @xmath3 pc .",
    "if some of them evolved into pgccs and became globular clusters , they should have lost @xmath148 of their mass with @xmath208 of star formation efficiency , and at the same time they should have collapsed by a factor 10 or so .",
    "but the further collapse would not have been straightforward because of large angular momentum , unless their angular momentum was removed very efficiently along with mass during the star formation phase .",
    "such removal of angular momentum may not be impossible , but following it is beyond the scope of this numerical study .",
    "it should be studied with simulations that have resolution high enough to follow the fragmentation of clouds and the subsequent formation of stars inside pgccs .",
    "however , we make the following note of caution . the clouds in our simulations continue to grow mostly through merging in late stage , and thus their mass and angular momentum increase in time .",
    "so any simulations of _ isolated _ clouds to study the ensuing evolution of pgccs could be misleading .",
    "we should point that there is a caveat in our argument for the large angular momentum of gravitationally bound clouds .",
    "the angular momentum was acquired mostly through gravitational processes , tidal torque and merging .",
    "so if the clouds formed in an environment where the gravitational processes are less important , they would have acquired less angular momentum . for instance , we showed that the clouds formed in a denser background have smaller angular momentum .",
    "hence , if protogalactic halos consisted of smaller halo - lets and clouds formed in shocked regions after collisions of halo - lets , as suggested by   @xcite , they could have smaller angular momentum .",
    "in our simulations , the gravitational potential for the gas - dynamical equation in  2.2 was calculated by using the fft method , @xmath209 .",
    "then the gravitational force could be correctly calculated by differentiating this potential on the grid .",
    "however the use of @xmath209 in calculating the gravitational energy of clouds , @xmath107 , in  3.3 ends up a large error , because @xmath209 is undetermined by an _",
    "integral constant_. in principle , the gravitational potential of isolated clouds can be precisely calculated by the direct double integration over cloud volume . however , the computational cost of this method is prohibitively expensive , especially for gravitationally bound clouds in the @xmath63 simulation , since they occupy typically @xmath210 or so grid zones .",
    "one the other hand , the direct integration does not take account of contributions from the rest of mass in the simulation box as well as the periodic mass distribution .",
    "but we found that those contributions are small , especially for massive , gravitationally bound clouds .    as an effort to estimate the gravitational energy of clouds more accurately , we devised a method which calculates and uses the corrected potential as follows : + 1 ) the position , @xmath211 , where @xmath209 has the minimum value , is found for each cloud , and then the potential at the position",
    "is calculated by the direct integration , @xmath212 2 ) the difference between @xmath213 and @xmath214 at @xmath211 is calculated for each cloud , @xmath215 3 ) then the corrected potential for each cloud is calculated by @xmath216 4 ) finally the gravitation energy of each cloud is calculated as @xmath217    figure 15 demonstrates the motivation of our effort . here @xmath218 is the gravitational energy of clouds calculated by the direct double integration , while @xmath219 and @xmath220 were calculated using @xmath214 and @xmath221 , respectively .",
    "the errors for the s0256 model are shown , where the double integration could be done with a reasonable computation time .",
    "@xmath220 tends to agree with @xmath218 better than @xmath219 . with @xmath220",
    "the error is within @xmath222 or so for a substantial fraction of clouds .",
    "however , the estimation of gravitational energy could be easily off by a factor two or even larger with @xmath219 .",
    "we used @xmath220 for the gravitational energy in  3.3 .",
    "ccccccc s1024 & @xmath63 & 16 & 2.29 & @xmath39 & const & 0.1 + s0512 & @xmath64 & 20 & 2.86 & @xmath39 & const & 0.1 + s0256 & @xmath65 & 20 & 2.86 & @xmath39 & const & 0.1 + k0512 & @xmath64 & 20 & 2.86 & @xmath39 & @xmath223 & 0.1 + r0512 & @xmath64 & 20 & 2.86 & @xmath39 & @xmath224 & 0.1 + c0512 & @xmath64 & 20 & 2.86 & @xmath47 & const & 0.1 + d0512 & @xmath64 & 20 & 1.65 & @xmath39 & const & 0.3 +"
  ],
  "abstract_text": [
    "<S> we study thermal - gravitational instability in simplified models for protogalactic halos using three - dimensional hydrodynamic simulations . </S>",
    "<S> the simulations started with isothermal density perturbations of various power spectra , and followed the evolution of gas with radiative cooling down to @xmath0 k , background heating , and self - gravity for up to @xmath1 cooling times . then cooled and condensed clouds were identified and their physical properties were examined in detail . in our models , the cooling time scale is several times shorter than the gravitational time scale . </S>",
    "<S> hence , during early stage clouds start to form around initial density peaks by thermal instability . </S>",
    "<S> small clouds appear first and they are pressure - bound . </S>",
    "<S> subsequently , the clouds grow through compression by the background pressure as well as gravitational infall . during late stage cloud - cloud collisions become important , and clouds grow mostly through gravitational merging . gravitationally bound clouds with mass @xmath2 </S>",
    "<S> are found in the late stage . </S>",
    "<S> they are approximately in virial equilibrium and have radius @xmath3 pc . </S>",
    "<S> those clouds have gained angular momentum through tidal torque as well as merging , so they have large angular momentum with the spin parameter @xmath4 . </S>",
    "<S> the clouds formed in a denser background tend to have smaller spin parameters , since the self - gravity , compared to the radiative cooling , is relatively less important at higher density . </S>",
    "<S> the cooling below @xmath0 k does not drastically change the evolution and properties of clouds , since it is much less efficient than the h ly@xmath5 cooling . </S>",
    "<S> the slope of initial density power spectrum affects the morphology of cloud distribution , but the properties of individual clouds do not sensitively depend on it . </S>",
    "<S> we point limitations of our study and mention briefly the implications of our results on the formation of protoglobular cluster clouds in protogalactic halos . </S>"
  ]
}