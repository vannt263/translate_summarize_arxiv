{
  "article_text": [
    "since its publication by metropolis , rosenbluth , teller and their wives in 1953 , the algorithm designed for  equation of state calculations by fast computing machines \" @xcite has been used to obtain an approximation of the equilibrium properties of a wide range of classical systems . of course , in fifty years",
    ", fast computing machines has become faster and faster , and this decreed the success of the algorithm .",
    "the metropolis algorithm performs a sample of the configuration space of a system starting from a random conformation and repeating a large number of steps .",
    "each step consists of attempting a transition to a new conformation @xmath1 choosing among a set of allowed moves , and accepting the attempt with probability @xmath2 $ ] where @xmath3 is the potential energy and t the absolute temperature in units of boltzmann s constant .",
    "this is equivalent to solve numerically the master equation @xmath4 . \\label{masterequation}\\ ] ] where the transition rates are @xmath5 , \\label{metropolis}\\ ] ] where @xmath6 sets the time scale of the transitions and @xmath7 is the _ a priori _ probability of choosing the move which goes from the state @xmath1 to the state @xmath8 .",
    "if the _ a priori _ probability satisfies @xmath9 and allows the system to visit the whole phase space , the algorithm provides a probability which converges to the boltzmann distribution .    among the many fields of application",
    ", the metropolis algorithm has been widely used to investigate the equilibrium properties of polymeric chains , in particular of protein models .",
    "important results were obtained by simulations of lattice model proteins concerning their free energy landscape @xcite . in the following",
    "we shall focus our attention on chain models to describe proteins , although our results can be applied to other fields .",
    "equation ( [ masterequation ] ) describes a tailor  made dynamics which , in principle , has nothing to do with the actual dynamics of a polymer .",
    "the actual dynamics of the polymer is described ( if one wants to describe implicitly the solvent ) by langevin s equation @xcite @xmath10 where @xmath11 is the momentum of a given particle , @xmath12 is the force acting on it , @xmath13 is the friction coefficient , @xmath14 the mass and @xmath15 a stochastic variable describing the interaction with the solvent .",
    "this variable satisfies @xmath16 and @xmath17 , where the brackets indicate the average over the realizations of @xmath15 and @xmath18 is the diffusion coefficient . on the other hand ,",
    "in implementing the metropolis algorithm , one is free to choose any kind of fancy move , with the only goal of speeding up the sampling of conformational space .",
    "if the chosen move allows enormous jumps across the conformational space , it is clear that the resulting dynamics has nothing to do with the actual dynamics of the polymer .",
    "however , the set of moves chosen for protein models is usually quite realistic , involving mainly local moves of the atoms ( e.g. , flips , crankschafts , etc .",
    "thus , one can ask whether the trajectories obtained with the metropolis algorithm and small moves have some degree of realism , in the sense that they provide an approximation to the solution of langevin s equation .    both langevin s equation and the metropolis algorithm are stochastic , containing some randomness .",
    "consequently , what makes physical sense is not a single trajectory but trajectories averaged over the randomness .",
    "thus , in the following we will compare solutions of the langevin s equation averaged over the force @xmath15 exerted by the solvent with the trajectories generated by the metropolis algorithm , averaged over independent runs .",
    "the relation between number of monte carlo steps and time was investigated in the case of spinoidal decomposition in two dimensions by meakin and coworkers @xcite and for lattice gauge theory by baillie and johston @xcite . for the simple case of a lattice model of a @xmath19helical hairpin , rey and skolnick showed @xcite that the metropolis simulations are independent on the set of moves chosen in the metropolis algorithm and are consistent with langevin dynamics simulations . in the present work ,",
    "we want to investigate further on the conditions under which the average solution of langevin s equation is well approximated by metropolis algorithm for protein  like chains .",
    "following ref .",
    "@xcite , one can show that , under the assumption that @xmath20 allows only small transitions @xmath21 , the master equation ( [ masterequation ] ) solved by the metropolis algorithm approximates a diffusive fokker  plank equation , which is equivalent to langevin s equation .",
    "in fact , writing @xmath22 , one can approximate @xmath23 so that the master equation ( [ masterequation ] ) becomes @xmath24d(\\delta x)+\\nonumber\\\\ & + & \\frac{1}{2}\\int ( \\delta x)^2\\frac{\\partial^2}{\\partial x^2}[w(x,\\delta x)p(x , t)]d(\\delta x)-\\int w(x,\\delta x)p(x , t)d(\\delta x).\\nonumber\\end{aligned}\\ ] ] and , since the first and last terms cancel each other , we get @xmath25 where @xmath26 and @xmath27 . note that @xmath28 and @xmath29 are nothing else but the average displacement and the average square displacement of the coordinate @xmath8 ( in other words , @xmath30 and @xmath31 , respectively ) .",
    "it is then enough to show that , among all possible fokker  plank equations , the one which rules the monte carlo sampling is that associated with diffusion in a potential @xmath3 .",
    "this is true if @xmath32 and @xmath33 . using the jumping rate of the metropolis algorithm ( [ metropolis ] ) it is possible to calculate the values of @xmath28 and @xmath29 , using the scheme developed in ref .",
    "@xcite . to achieve this result ,",
    "use is made of the hypothesis that @xmath34 allows only small jumps .",
    "we define the small number @xmath35 as the maximum displacement allowed to the coordinate @xmath8 in a single move , and we assume that @xmath35 is independent on @xmath8 ( in order to obtain , at the end , a homogeneous diffusion coefficient ) . for sake of simplicity , we can chose @xmath36 equal to @xmath37 if @xmath38 and zero otherwise . moreover , again due to the small jumps hypothesis , we can expand the jumping rate in @xmath39\\approx w_0 p_{ap}(\\delta x)\\min \\left [ 1,1-\\frac{u'(x)\\delta x}{t}\\right]\\ ] ] in general , at @xmath40 the sign of @xmath41 changes , and the minimum function switches from the value @xmath42 to the exponential . we can thus break the integral of the definition of @xmath28 at @xmath40 @xmath43 the first two integrals cancel each other because they can be merged into the integral of an odd function on an even interval .",
    "consequently , @xmath44 in the same way one can calculate @xmath45 since @xmath35 is small , the second term of the latter expression is negligible with respect to the former , so that @xmath46 which is a constant .",
    "this corresponds to langevin dynamics with @xmath47 and @xmath48 ( these expressions will be commented in sect .",
    "[ sect_temp ] ) .",
    "the above derivation show that the metropolis algorithm can be used to solve langevin s equation , provided that the allowed moves are small . on the other hand ,",
    "it gives no indication about how small the move must be .",
    "to investigate this point , we have compared the average trajectories generated by the metropolis algorithm with numerical solutions of langevin s equation .",
    "the protein model used in the following is a simplified g model @xcite .",
    "g models , at different degrees of geometric resolution , have been widely used in the literature to investigate thermodynamical and kinetic properties of proteins . in their c@xmath49-version",
    "they allow to perform massive simulations with small to medium  sized proteins @xcite .",
    "another choice is to account also for the side ",
    "chain , as a single bead @xcite , in order to give a more realistic description of the protein without increasing much the computational cost . in fact , with this model it was possible not only to simulate the folding , but also the aggregation of a number of identical proteins @xcite .",
    "another possible choice is to give a full description of the atomic structure of amino acids , where the basic interacting unit is the atom @xcite ( for a careful review see ref .",
    "@xcite ) . in order to perform the simulations we have employed a c@xmath49 g  model , where each amino acid is described as a spherical bead .",
    "two amino acids which are in contact ( whose @xmath50 distance is @xmath51 in the experimental native conformation and which are not consecutive along the chain ) interact through a 612 lennard  jones potential , whose bottom lies at @xmath52 , and energy @xmath53 kcal / mol and whose cutoff is at 20@xmath54 .",
    "the other pairs of amino acids repell each other with a @xmath55 potential .    in the implementation of the metropolis algorithm , at each step",
    "an amino acid is chosen at random with flat probability .",
    "the chosen amino acid is rotated of an angle @xmath56 around the axis defined by the previous and the following one , where @xmath56 is a random number generated from a flat distribution and constrained in the interval @xmath57 .",
    "this set of moves varies the dihedrals and the angles associated with the amino acids , while the bonds between consecutive amino acids are inextensible and display length @xmath58 .",
    "the first and last amino acid of the chain diplay a further degree of freedom , that is the bond angle with the previous amino acid , which can be also moved at random .",
    "the langevin equations of motion are integrated with the b.b.k .",
    "algorithm @xcite using a time step @xmath59 .",
    "each amino acid is linked to the consecutive ones through a harmonic potential with spring constant @xmath60 .",
    "this is the only difference between the model used for the molecular dynamics and that used for the metropolis simulations .",
    "due to the stiffness of the spring , we do not expect that this produces relevant effects .    in order to compare langevin and metropolis dynamics ,",
    "we have performed a number of simulations at temperature @xmath61 , lower than the folding temperature ( @xmath62 ) , with both methods on a short protein ( 60 residues ) , the sh3 domain of src , starting from random generated conformations . in order to evaluate the dependence of the results on the length of the protein , we will also study betanova , a synthetic peptide built out of 18 residues and the monomer of hiv  pr , a protein of 99 residues .",
    "the solid curve in fig . [ fig1 ] is the energy of sh3 as a function of time calculated with the langevin dynamics , averaged over 50 independent runs .",
    "metropolis simulations have been performed at the same temperature , using different values of the threshold @xmath63 of the angular move . for each of them",
    ", we have calculated the average energy as a function of the number of monte carlo steps . to transform the number of monte carlo steps ( mcs ) into time",
    ", we have calculated the time content @xmath64 of a single monte carlo step ( @xmath65 ) , optimizing its value by means of a least ",
    "square minimization of the curve obtained from the monte carlo simulation versus that obtained from the langevin dynamics .",
    "three examples of the resulting curves are also displayed in fig .",
    "[ fig1 ] with dotted ( @xmath66 ) , dashed ( @xmath67 ) and dotted  dashed ( @xmath68 ) lines .",
    "the values of @xmath64 and of the square  root of the average of residuals @xmath69 obtained from the optimization are displayed in fig .",
    "these plots show that in order to have in the out  of  equilibrium regime an error in the determination of the energy smaller than few kcal / mol ( i.e. , a typical single non  bonded interaction in biological molecules ) one needs to set @xmath70 .",
    "larger values of @xmath63 lead to errors of the order of 4 - 5 kcal / mol in the whole out  of  equilibrium phase ( cf .",
    "[ fig2 ] ) , which can reach 10 kcal / mol in the first nanoseconds ( cf .",
    "[ fig1 ] ) .",
    "of course , in the long  time limit the curves overlap , by virtue of the ergodic theorem .    in fig .",
    "[ fig3 ] is displayed the time dependence of the mean drmsd and @xmath71 , two order parameters which indicate to which extent a conformation of the protein chain is similar to the native conformation .",
    "the drmsd is defined as @xmath72^{1/2}$ ] , where @xmath73 is the number of amino acids of the chain , @xmath74 is the distance between two of them in the current conformation and @xmath75 is the same quantity calculated in the native conformation .",
    "the parameter @xmath71 is the fraction of contacts that a given conformation shares with the native conformation , having defined two amino acids to be in contact if they are closer than 6.5@xmath54 .",
    "these curves show the same behaviour of the energy , a good description being only provided for @xmath70 .",
    "the time content of a monte carlo step in the most reliable case @xmath68 is 1mcs = 0.1 fs , and it increases almost linearly up to 1mcs = 15 fs at @xmath76 , where it reaches a plateau ( see fig . [ fig2 ] ) .",
    "a time step of 0.1 fs is quite small , smaller than that usually employed in molecular dynamics simulations .",
    "however , this limit is compensated by the fact that metropolis algorithm are often computationally much faster than molecular dynamics algorithm . moreover ,",
    "if one requires a less stringent description of the initial stages of the dynamics , it is possible to use a larger threshold @xmath63 . to be noted that the above relationship holds for a potential shaped with a lennard  jones function of the kind used in these calculations , and thus will be more favourable for smoother ( although , possibly , less realistic ) potentials .",
    "we have also compared the energy fluctuations @xmath77 obtained by the monte carlo and langevin simulations .",
    "the results obtained for @xmath78 are reported in fig .",
    "[ fluct](a ) .",
    "although the overall behaviour is quite similar , the monte carlo simulations understimates the fluctuations in the first nanoseconds of up to 3 kcal / mol ( i.e. , @xmath79 ) . as the system approaches equilibrium ( cf .",
    "the last tens of nanoseconds ) , the two curves overlap better , as expected by virtue of the ergodic theorem . in order to obtain a better overlap ,",
    "it is necessary to further reduce the value of @xmath63 . in fig . [",
    "fluct](c ) are displayed the same quantities as above , but obtained using @xmath80 .",
    "note that we could simulate only the first 1.5 ns , due to the much larger computational cost of choosing such a small elementary move .",
    "however , in this case the match between the fluctuations obtained with the monte carlo algorithm and the langevin dynamics is much better ( root mean square residual is 1.1 kcal / mol ) than in the case where we used @xmath78 on the same time interval ( root mean square residual is 3.1 kcal / mol , cf . fig . [ fluct](b ) ) .",
    "summing up , one can conclude that the metropolis dynamics is a fast algorithm to describe the dynamics of mean quantities , but is not useful if one requires high precision ( @xmath81 ) in the higher moments .",
    "the link between metropolis and langevin dynamics , provided by eqs . [ eq_a ] and [ eq_b ] , displays the unrealistic feature that the effective friction coefficient @xmath13 results linearly dependent on the temperature of the system ( @xmath47 ) , while the diffusion coefficient @xmath18 results independent on @xmath82 ( @xmath48 ) .",
    "nonetheless , these two quantities satisfy einstein s relation @xmath83 .",
    "the independence of @xmath13 and the linear dependence of @xmath18 on the temperature can be reached if one assumes that the value of @xmath6 associated with the metropolis step varies linearly with the temperature , i.e. @xmath84 , where the constant @xmath85 is independent on @xmath82 .",
    "this provides the correct @xmath86 and @xmath87 .    to check numerically this result",
    ", we have performed both metropolis ( using @xmath88 ) and langevin simulations at various temperatures ranging from @xmath89k to @xmath90k .",
    "the values of @xmath6 obtained from the simulations of sh3 ( following the same procedure described in the previous section ) are displayed with filled squares in fig .",
    "[ fig_t ] as a function of temperature . the correlation coefficient of the linear fit",
    "@xmath84 is @xmath91 , indicating a good linear behaviour ( see also table [ table_t ] ) . note that the low value of @xmath85 suggests that for proteins of the size of sh3 and for temperature variations within the range of biological relevance , the error done assuming a @xmath6 independent of the temperature is small .",
    "in addition , we have also studied the displacement of the centre of mass of the protein , calculating the diffusion coefficient both in the case of langevin and metropolis simulations .",
    "the value of @xmath6 obtained from the comparison of the diffusion coefficients is also displayed in fig .",
    "[ fig_t ] ( empty squares ) and the linear coefficient @xmath92 of the fitting line is listed in table [ table_t ] .",
    "one would have expected @xmath92 to be identical to @xmath85 .",
    "their difference suggests that the small approximation done in each metropolis step with respect to the langevin dynamics sums up to displace the centre of mass of the protein , giving rise to a less precise approximation .",
    "the results discussed above are obtained with a protein composed of 60 amino acids . in order to elucidate to",
    "which extent these results depend on the length @xmath73 of the protein , we have repeated the same kind of molecular dynamics and monte carlo simulations for other two proteins , that is betanova ( @xmath93 ) and the monomer of hiv1 protease ( @xmath94 ) .    the mean square energy deviation between the two kind of simulations as a function of @xmath63 are plotted in fig .",
    "[ fig_n ] with a solid curve for hiv1 protease and with a dashed curve for betanova . while hiv1 protease behaves similarly to sh3 ( cf .",
    "[ fig2 ] ) , betanova displays low deviations even for large angles @xmath63 . in any case , at low values of @xmath63 , all of them display small values of @xmath69 .",
    "for example , at @xmath95 the values of @xmath69 are @xmath96 for hiv1 protease ( i.e. , @xmath94 ) , @xmath97 for sh3 ( @xmath98 ) and 0.62 for betanova ( @xmath93 ) .",
    "consequently , a threshold of @xmath95 is a safe choice for most cases of interest .",
    "the variation of @xmath64 ( @xmath99 ) with respect to @xmath73 is displayed in the inset to fig .",
    "[ fig_n ] .",
    "again , the shortest protein displays a behaviour which is quite different from the other two , having a @xmath64 which is an order of magnitude larger . on the other hand , the two larger proteins display values of @xmath64 of @xmath100 and @xmath101fs , respectively , that is of the same order of magnitude .",
    "the dependence of @xmath6 on the temperature for the different protein sizes is displayed in fig .",
    "[ fig_t ] and the coefficients @xmath92 of the linear fit summarizd in table [ table_t ] .",
    "these results show that @xmath92 increases quite rapidly as the length of the protein increases .",
    "thus one can conclude that in metropolis simulations of proteins larger than sh3 it becomes necessary to account explicitely for the dependence of @xmath6 on the temperature .",
    "we have shown that metropolis algorithm can be used to simulate the dynamics of a simplified protein model , provided that the residue are moved of small dihedrals and that the probability of chosing a move is independent of the conformation of the chain .",
    "if one is investigating mean quantities , a constrain of @xmath102 on the dihedral move is enough .",
    "this approach can be useful not only because it gives a physical meaning to the trajectories obtained by monte carlo thermodynamical samplings , but also because for simple protein models the metropolis algorithm can be faster than langevin s dynamics .",
    "for example , a 1ns simulation of the model chain at @xmath103 and with @xmath95 took , with our codes and on the same pc , 8.5 s when performed with metropolis algorithm and 16.0 s when performed with langevin s algorithm . of course , the possibility to use metropolis simulations to study the dynamics of a protein implies the knowledge of the conversion factor @xmath64 .",
    "if one is interested in the precise value of @xmath64 , some molecular dynamics runs are necessary in order to estimate it , and consequently the computational advantage of using metropolis simulations is lost . if , on the other hand , one needs only the order of magnitudes of the folding time , one can use the conversion factors obtained above ( i.e. , @xmath64 of the order of @xmath104 fs at room temperature ) .",
    "99 n. metropolis , a. w. rosenbluth , m. n. rosenbluth , a. h. teller and e. teller , j. chem .",
    "phys . , 21 ( 1953 ) 1987 n. g. van kampen , _",
    "stochastic processes in physics and chemistry _ , north - holland ( 1992 ) k. f. lau and k. dill , macromolecules , 22 ( 1989 ) 3986 e. i. shakhnovich , phys .",
    "lett . , 72 ( 1994 ) 3907 a. irback , f. sjunnesson and s. wallin , proc .",
    "usa 97 , ( 2000 ) 13614 p. meakin , h. metiu , g. petschek and d. j. scalapino , j. chem .",
    "79 ( 1983 ) 1948 c. f. baillie and d. a. johnston , phys . rev .",
    "d 39 ( 1989 ) 1246 a. rey and j. skolnick , chem .",
    "phys . , 158 ( 1991 ) 199 k. kikuchi , m. yoshida , t. maekawa and h. watanabe , chem . phys",
    ", 185 ( 1991 ) 335 n. go , int .",
    "j. peptide protein res . , 7 ( 1975 )",
    "313 n. v. dokholyan , s. buldyrev , h. e. stanley and e. i. shakhnovich , fold . des . *",
    "3 * , 577 y. levy , a. caflisch , j. n.onuchic , p. g. wolynes , j. mol .",
    "biol . , 340 ( 2004 ) 67 n. d. dokholyan , s. v. buldyrev , h. e. stanley , e. i. shakhnovich , j. mol .",
    "296 ( 2000 ) 1183 l. mirny and e. i. shakhnovich , ann .",
    "struct . 30",
    "( 2001 ) 361 f. ding , n. v. dokholyan , s. v. buldyrev , h. e. stanley and e. i. shakhnovich , biophys . j. * 83 * ( 2002 ) 3525 f. ding , j. m. borreguero , s. v. buldyrev , h. e. stanley and n. v. dokholyan , proteins * 53 * ( 2003 ) 220 f. ding , n. v. dokholyan , s. v. buldyrev , h. e. stanley , e. i. shakhnovich , j. mol . biol .",
    "* 324 * ( 2002 ) 851 j. shimada , e. kussel and e. i. shakhnovich , j. mol .",
    "* 308 * ( 2001 ) 79 j. shimada and e. i. shakhnovich , proc .",
    "usa , * 17 * ( 2002 ) 11175 f. ding and n. v. dokholyan , trends biotech . *",
    "23 * ( 2005 ) 450 brunger , a. , brooks , c.l . , and karplus , m. , chem . phys . lett . 105 ( 1994 ) 495    .the linear coefficient @xmath85 ( in @xmath105 ) which controls the dependence of @xmath6 on the temperature for the three proteins , characterized by different lengths ( third column ) and the associated correlation coefficient @xmath106 ( fourth column ) .",
    "the value of @xmath92 obtained comparing the displacement of the centre of mass is also listed in the fifth and sixth column . [ cols=\"<,<,<,<,<,<\",options=\"header \" , ]       ( @xmath99 ) calculated by means of a least ",
    "square minimization of the curve of the energy ( black dots ) , of the drmsd ( blue cross ) and of the parameter q ( red squares ) .",
    "( b ) the value of the square  root of the average of residuals @xmath69 as a function of the maximum allowed dihedral angle move used in monte carlo simulation.,width=453 ]         obtained from the fit of the energy as a function of temperature for hiv  pr ( filled triangles ) , sh3 ( filled squares ) and betanova ( filled circles ) .",
    "the open symbols indicate the values of @xmath6 obtained by the fit of the displacement of the centre of mass .",
    "the straight lines indicate the linear fit.,width=453 ]     as a function of the maximum allowed dihedral angle move used in monte carlo simulation for the hiv1 protease ( solid curve ) and betanova ( dashed curve ) . in the inset , the value of @xmath64 at @xmath110 for the three proteins , as a function of their length @xmath73.,width=453 ]"
  ],
  "abstract_text": [
    "<S> the metropolis implementation of the monte carlo algorithm has been developed to study the equilibrium thermodynamics of many  body systems . </S>",
    "<S> choosing small trial moves , the trajectories obtained applying this algorithm agree with those obtained by langevin s dynamics . applying this procedure to a simplified protein model , it is possible to show that setting a threshold of 1@xmath0 on the movement of the dihedrals of the protein backbone in a single monte carlo step , the mean quantities associated with the off  equilibrium dynamics ( e.g. , energy , rmsd , etc . ) are well reproduced , while the good description of higher moments requires smaller moves . </S>",
    "<S> an important result is that the time duration of a monte carlo step depends linearly on the temperature , something which should be accounted for when doing simulations at different temperatures . </S>"
  ]
}