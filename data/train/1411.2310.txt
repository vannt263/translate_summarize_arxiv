{
  "article_text": [
    "quantum key distribution ( qkd ) is widely perceived to have provided provably secure key generation with a close to perfect key [ 1 ] .",
    "the foundational criterion problems that invalidate such conclusion have been described [ 2,3,4,5 ] .",
    "the security problems associated with error correction and privacy amplification in qkd are briefly discussed in [ 4,6 ] . in this paper",
    "we focus on these latter two issues .",
    "we will show how intractable the error correction problem is for rigorous analysis , and how that affects the privacy amplification result .",
    "we also show the scope and limit of privacy amplification , in particular on why no nearly perfect net key can yet be generated from any known qkd protocol . with the necessary tradeoff between key rate and security from privacy amplification ,",
    "this points to the need of developing further cryptographic techniques for getting reasonable key rates and security .",
    "in this section we summarize the schematic steps in the most complete security analysis available on concrete qkd protocols of the information - disturbance tradeoff variety , emphasizing the error correction and privacy amplification steps .",
    "such analysis is given for single - photon bb84 including some but not all nonideal effects [ 7 ] , in particular for no loss and noise in the system .",
    "we would describe only the main features of the analysis for the purpose of this paper , and would take as valid the steps in [ 7 ] not discussed here .",
    "the key @xmath0 is generated in a qkd round through the transmission of random data @xmath1- carrying optical signals from alice to bob , each bit @xmath2 modulating a separate quantum signal . in bb84 type information - disturbance tradeoff protocols , the main focus of this paper , small signals are employed to sense the disturbance from an attacker eve who taps into the transmission to gain information .",
    "the users would use open ( public ) exchanges to detect eve s presence .",
    "when the quantum bit error rate ( qber ) disturbance on a random portion of the signals is above a designed threshold level , the protocol would be aborted .",
    "if the qber is below the threshold , the users through their protocol analysis would estimate that a net key can be generated and proceed as depicted in fig 1 . before the qber check ,",
    "open basis matching in each quantum signal is carried out between alice and bob who measures randomly on one of the bases used in each bit signal .",
    "the unchecked portion of @xmath3 constitutes the sifted key @xmath4 , on whose carrying quantum signals eve has already set her probe attack during transmission .",
    "these are all standard bb84 steps .",
    "fig . 1 : schematic representation of a qkd system incorporating error correction and privacy amplification with generated key @xmath0 .",
    "the sifted key @xmath4 is to be corrected for error , from system imperfection even if eve is absent .",
    "such system error is sizable for small signals , and very sizable in lossy systems because the received signal rate is greatly reduced in large loss as compared to the noise rate. we mainly consider the use of error correcting code ( ecc) for such purpose , which in practice is ( nearly ) universally employed , the ecc output @xmath5 is presumably free of error , and is compressed to a shorter key @xmath0 for increased security by a privacy amplification code ( pac ) , which in practice is always a matrix compressing the @xmath6-bit @xmath7 to an @xmath8-bit @xmath0 , @xmath9 .",
    "the final key @xmath0 is practically now available for use , the key bit cost during protocol execution is subtracted to give the net key bits @xmath10 generated .",
    "the open exchanges between the users need to be authenticated with a shared secret key to protect at least against man - in - the - middle attack , which constitutes the minimum key cost. eve makes measurement on her probe only after she learns about the open information on ecc and pac .",
    "how does the security analysis go ?",
    "first , one needs to pick a useful and workable security criterion .",
    "the best criterion to date is the trace distance @xmath11 [ 1,8 ] , and we do not need to be concerned with its detailed meaning or adequacy [ 4,5 ] in this paper on ecc and pac.  we would just note the following.    from her probe measurement result together with whatever side information she has such as the specific ecc or pac employed , eve derives a whole probability distribution @xmath12 on the possible values of @xmath0 that is objectively correct given the security model is correct. let @xmath13 and @xmath14 .",
    "thus , @xmath15 is eve s maximum probability of estimating the whole @xmath0 correctly during key generation before @xmath0 is used in an application .",
    "it is clear @xmath15 _ must be _ sufficient small for any security claim .",
    "the criterion @xmath11 is associated with the @xmath0 generated in one qkd round .",
    "it bounds @xmath15 as [ 4,9,10 ] @xmath16 equality in ( 1 ) can be achieved for a given d. we compare ( 1 ) to @xmath17 , the @xmath15 level of a perfect key @xmath18 ( the uniform random variable on @xmath19 possibilities) , through the probability exponents. let @xmath20 be the @xmath15 exponent and @xmath21 the @xmath11 exponent, i.e., @xmath22 and @xmath23 .",
    "it is clear from ( 1 ) that the maximum number of uniform bits that can be extracted from compression on @xmath0 with a given @xmath11-level is upper bounded by @xmath21 , and with a given @xmath24 it is upper bounded by @xmath20 .",
    "how is the @xmath11 level of the pac output @xmath0 guaranteed ?",
    "it comes from the leftover hash lemma , the quantum version of which for @xmath11 [ 11 ] takes the same form as the classical version on  statistical distance [ 12 ] .",
    "let @xmath25 be the @xmath15 of the pac input @xmath5 with exponent @xmath26 , @xmath27 .",
    "such @xmath15 exponent is called the minimum entropy @xmath28 of the distribution @xmath29 in the qkd literature .",
    "since @xmath15 has direct operational interpretation , we will typically not use entropy terminology as the operational meaning of entropic quantities need to be separately developed in general.    the leftover hash lemma for  universal hashing \" , which covers all pac in use , gives the tradeoff between the @xmath11-level @xmath30 of @xmath0 and its length @xmath31 by the formula ( log to base 2 ) @xmath32 since it is not known whether @xmath31 bigger than the minimum @xmath33 on the right side of ( 2 ) would obtain , the guaranteed key rate is given by the quantity @xmath33 .",
    "note that @xmath34 and thus from ( 2 ) , @xmath35 .",
    "furthermore , the _ minimum _ @xmath30 one can get is , from @xmath36 , @xmath37    actually what are obtained in qkd security proofs are various average results , say an average @xmath11-level on @xmath0 over the universal hashing matrices and average @xmath15 over eve s measurement results , etc . in this paper",
    "we would _ not _ go into the very significant decrease in quantitative guaranteed level from converting average guarantee to the necessary individual probability guarantee [ 4,5,13 ] , and would regard all results as if they are individual .",
    "thus from ( 2 ) the users want as big an exponent @xmath26 , or @xmath38 with entropy terminology , as possible . in qkd security proofs",
    ", this @xmath26 is taken to be the _ same _ as that of the shift key @xmath5 , @xmath39 to account for the ecc  information leak \" to eve , the following number of bits @xmath40 is subtracted from @xmath31 to give the net key generated , @xmath41 in ( 5 ) , @xmath42 is the binary entropy function and @xmath43 is ad hoc factor usually taken to be @xmath44 .",
    "it is not spelled out exactly why and how (5) is the information gain by eve so that it can be claimed that the number of net key bits generated is ( before accounting for message authentication bits), @xmath45 the ecc security problems would be discussed in the next section iii. we would not discuss in this paper the problems associated with bounding @xmath46 under general attacks .",
    "some remarks can be found in [ 4 , 6,14 ] .",
    "so the chain of security analysis for bb84 type information - disturbance tradeoff protocols may be summarized as follows . for a given qber threshold , a lower bound on the @xmath47 exponent @xmath48 , or in entropy notation @xmath46 , of the sifted key @xmath4",
    "is obtained by some method valid for general attack . the ecc input @xmath4 and output @xmath5",
    "are taken to have identical @xmath15 exponents , i.e. , equ ( 4 ) is assumed to hold .",
    "then equ ( 2 ) is used to quantify the tradeoff between the pac output @xmath0 security level @xmath30 and its bit length @xmath31 .",
    "the pac side information to eve is accounted for in the leftover hash lemma ( 2 ) , and the ecc side information to eve is accounted for by ( 5)-(6 ) .",
    "there is an @xmath49-smooth generalization that improves the tradeoff of ( 2 ) which we will discuss in section iv . these steps have been carried out for single - photon bb84 in some detail in [ 7 ] , but without any specific choice of ecc or pac .",
    "we will go into the ecc and pac steps separately in the following two sections.    before proceeding , it may be mentioned that the information leaks to eve from error correction and privacy amplification were not accounted for in major previous security analyses such as [ 15,16 ] . despite some recent analyses [ 17,18 ] the only available specific evaluation of a concrete protocol is from [ 7 ] , although it still does not give specific error correction and message authentication procedures .",
    "we just see above that error correction and privacy amplification can not be decoupled in the security analysis in that the output of error correction @xmath5 is the input to privacy amplification , and thus @xmath25 and not @xmath47 determines the privacy amplification performance .",
    "similarly , the information leak of @xmath0 to eve from message authentication depends on exactly how message authentication is to be carried out within the qkd protocol with a previously generated imperfect qkd key , which has not been described and quantified .",
    "thus , we would just concentrate in this paper on the specific problems in the approach of [ 7 ] , apart from these incompleteness and other issues .",
    "a major problem of qkd protocols to date is that it is very difficult to quantify general security associated with error correction . in the earlier days of qkd , two - way open ",
    "reconciliation \" is used to correct errors , specifically through the cascade protocol [ 19 ] .",
    "cascade is highly nonlinearly random with respect to the various probabilities that occur during its execution . both the amount of open exchange needed and the leaks to eve in its various stages are randomly fluctuating .",
    "it resists rigorous quantitative analysis similar to most nonlinear random problems , and various errors of reasoning in its incomplete analysis were pointed out in [ 20 ] . any two - way interactive protocol would have this kind of problem .",
    "thus , we would just consider the use of ecc for error correction , which is currently used in concrete protocols .    how is ( 5 ) to be justified to be the leak of information to eve from an ecc ?",
    "the case of @xmath50 is supposed to the large @xmath8 asymptotic limit leak , and @xmath44 a finite @xmath8 correction factor .",
    "such choice of @xmath43 is entirely ad hoc and _ out of place _ in a rigorous analysis .",
    "leaving @xmath43 unspecified would make ( 5 ) tautologically correct , because any @xmath40 can be given by adjusting @xmath43 .",
    "but how does one know a net key can be generated , that ( 6 ) is positive for the true @xmath43 ? why is @xmath43 upper bounded by 2",
    "? why could an imperfect key @xmath0 at whatever its quantified security level be used for @xmath40 subtraction in ( 5)-(6 ) ?",
    "such hand - waiving in a claimed rigorous security proof is astounding .",
    "in fact , it is shown in [ 13 ] that a huge leak from an openly known ecc similar to quantum information locking is possible . in any case ,",
    "given the size of the ecc required for typical @xmath8 in the range of @xmath51 and @xmath52 , it appears impossible to quantify any information leak to eve for an openly known ecc , and no attempt has been reported .",
    "thus , we consider the case of ecc that is covered up by a shared secret key between the users .",
    "consider a linear @xmath53 ecc with @xmath54k information digits and @xmath6 code digits , so that the number of parity check digits is @xmath55 [ 22 ] .",
    "if the parity check digits of such a linear ecc is covered by shared random bits , the bit cost would be @xmath56k. if one assumes the qkd system is a binary symmetric channel [ 10 ] on the data bits with crossover probability given by qber , then for @xmath57 given by the channel bit capacity @xmath58 $ ] there exists a ( linear ) code that would correct the errors from the @xmath8 received bits by shannon s channel coding theorem , and hence the number of parity check bits that are to be covered is given by @xmath59 = n\\cdot h(\\rm{qber})\\ ] ] this appears to be the argument given in [ 23 ] for the @xmath50 case of ( 5 ) .",
    "it seems also to be the argument implicit in [ 7 ] where ( 5 ) is justified by quoting the whole book [ 10] , but the book does not deal with  reconciliation \" or information leak problems in cryptography .",
    "there is a minor numerical problem associated with ( 7 ) , that either @xmath60 or ( 7 ) is not exactly correct .",
    "if the users employ error free transmission of additional covered parity check bits , @xmath61 and",
    "@xmath6 becomes @xmath62 in the @xmath63 code",
    ". thus instead of ( 5 ) one would have @xmath64\\ ] ] for the asymptotic case. generally , there is an additional problem of whether all errors in @xmath4 are corrected in @xmath5 with a high enough probability . in this paper",
    "we assume that is the case and also ignore the difference between ( 5 ) and ( 8) .",
    "     in [ 7 ] the @xmath43 of ( 5 ) is picked to be 1.1 , an ad hoc choice that greatly affects the number of final net key bits generated given by ( 6 ) , which is also very sensitive to qber .",
    "the hand - waiving nature of such an estimate is reinforced by several considerations .",
    "_ first _ , there is no reason to expect the qkd system is a memoryless channel under joint attack , especially one with entangled probes by eve .",
    "in fact , a general active attack from eve would invalidate the constant channel assumption from which the results in [ 10 ] are derived and [ 7 ] refers to. _ second _ , the ecc structural information is not yet accounted for even if the ecc parity digits are covered by perfect key bits .",
    "this is because only a finite amount of such bits can be used as constrained by ( 6 ) being positive , and thus the structure of the code has to be openly specified which is also needed for actual implementation .",
    "mathematically , the form of the density operator @xmath65 is changed by such covering from the no - ecc @xmath65 or @xmath66 to , for @xmath67th ecc probability @xmath68 that leads to @xmath69 for eve , @xmath70 now the ecc output key @xmath5 is in state @xmath71 to eve and no longer the same as the sifted key state @xmath66 before ecc . _",
    "third _ , what is the leak when the ecc is covered by a previously generated imperfect key , especially one with low numerical security levels that can be obtained just theoretically [ 4,24]? note that  universal composition \" does not provide such guarantee [ 5 ] .",
    "furthermore, from fig .",
    "1 one needs a correct bound on @xmath25 of the ecc output @xmath72 , which is the pac input , to guarantee the security level of the final @xmath0 from ( 2 ) . if the ecc is open , evidently eve s @xmath25 in increased from her @xmath47 because the ecc information would help eve to correct her key estimate also. if ecc is covered , @xmath4 is corrected to @xmath5 and @xmath25 may still increase from the known ecc structural information .",
    "thus , the equality in ( 4 ) is generally changed to become an inequality with ",
    "= \" replaced by ",
    "@xmath73\" , which is less favorable to the users .",
    "certainly the openly known deterministic pac could only increase @xmath74 to @xmath24 , and in fact very likely does due to the many - to - one transformation of the pac. thus we have the chain , @xmath75 equ ( 10 ) immediately shows that the all important @xmath15 security level , and in particular the number of possible ( near ) uniform bits that can be extracted , gets lower as one performs ecc and pac . while that is intuitively obvious for ecc , is nt pac supposed to increase security ?",
    "yes that is where the key rate and security tradeoff comes in , as we analyze further in the next section .",
    "the idea of privacy amplification has been well known in random number generation .",
    "its gist is as follows .",
    "consider @xmath6 independent bits of equal a priori probability 1/2 for the bit values each of which is known to eve with error probability @xmath76 .",
    "the mod 2 sum of these @xmath6 bits is readily shown to be known to eve with error probability @xmath77 , which goes to 1/2 for large @xmath6 .",
    "this @xmath6 to 1 compression for increasing randomness is inefficient in the sense the random bit generation rate is just @xmath78 .",
    "efficiency can be increased if @xmath57 different linear combinations of the @xmath6 bits are used to generate @xmath57 random bits instead .",
    "such matrix compression , or general linear hashing , covers all the practical pac in current use .",
    "there is a security cost to the increased efficiency of @xmath63 compression compared to @xmath79 compression .",
    "linear hashing introduces correlation among the @xmath57 output bits even when the @xmath6 input bits are independent .",
    "in fact , it may produce strong correlations among the output bits for _ any _ @xmath6 input bits , which happens when the compression matrix is degenerate , i.e. , having a smaller rank than @xmath57 .",
    "the performance of pac can only be quantified as average over classes of hashing matrices , which always include degenerate matrices [ 25,26 ] .",
    "if one tests the matrix for degeneracy first before using it as pac , it is _ not _ known what the resulting pac performance would become .",
    "so the existence of insecure pac among a chosen class is a fact , not a mere possibility .",
    "it has to be ruled out probabilistically via markov s inequality [ 4 ] .",
    "what is the security guarantee for the output @xmath0 of a pac with an input @xmath5 that has some prescribed characteristics ?",
    "the _ first _ main point is that the bits in @xmath5 are correlated although the data @xmath1 are not .",
    "this comes about from at least two sources , the ecc itself and joint attack from eve .",
    "we already just observed above that the bits in @xmath0 are correlated from the pac itself .",
    "there would be additional correlation that arise from the bit correlation in @xmath5 .",
    "a lot of untutored intuition on assessing the security of @xmath0 implicitly assumes the bits in @xmath0 are independent , which is _ certainly _ not the case .",
    "the _ second _ main point is the inequality ( 10 ) , which says the @xmath15 level can only worsen as the sifted key @xmath4 is transformed to the ecc output @xmath5 and then the pac output @xmath0 .",
    "why is then security increased at @xmath0 compared to @xmath5 or @xmath4 ?",
    "it is because the security of any given @xmath80 level of a random variable @xmath3 is relative to the number of bits in @xmath3 .",
    "let an @xmath8-bit @xmath0 has eve s @xmath24 of the form @xmath81 the minimum @xmath24 , the best case from the user s view when @xmath82 , occurs when @xmath83 and @xmath84 , i.e. , when @xmath85 which happens if and only if @xmath0 is perfect .",
    "it is clear from ( 11 ) that a value of @xmath24 , say @xmath86 , is perfect for a 100 bits @xmath0 but not very good for a @xmath52 bits @xmath0 .",
    "that is how privacy amplification may give better security , by sacrificing key generation rate .",
    "the impression was widely held from the earlier qkd security proofs that qkd security can be made arbitrarily close to perfect under a fixed key rate below a threshold value determined from the security analysis , often 10% or more of @xmath87 .",
    "it is supposed to be achievable asymptotically for large @xmath88 , similar to the original statement of the shannon channel coding theorem for a memoryless channel [ 10 ] .",
    "the criterion used is eve s mutual ( accessible ) information iac .",
    "it was pointed out since long ago [ 2,4,27,28 ] that such conclusion is incorrect . under an iac constraint ,",
    "@xmath89 it is possible that @xmath24 is as big as [ 2 ] @xmath90 while ( 13 ) goes to 0 exponentially in @xmath8 , its exponent @xmath91 shows it is far from perfect however large @xmath8 is .",
    "it is the _ rate _ that @xmath24 goes to zero that limits the key rate , not just that it goes to zero .",
    "the situation is identical under the @xmath11 criterion , because under @xmath92 it is possible that [ 2,3,4 ] the bound ( 1 ) is achieved with equality .",
    "thus , it is the @xmath11-exponent @xmath21 which becomes the effective limiting @xmath93 , the exponent of the corresponding @xmath24 . as we discuss in connection with ( 1)-(2 ) , it is the exponent of @xmath25 or of @xmath30 that determines any tradeoff between security and key rate .",
    "the underlying reason for such necessary tradeoff is not that one is dealing with finite and non - asymptotic @xmath8 .",
    "it is rather than it is the @xmath15 exponent that determines essential security whatever the number of bits it applies to .    in this connection",
    "it is important to recall that the number of bits @xmath8 in @xmath0 has to be specified in association with any specific criterion value , be it iac , @xmath11 , or @xmath15 .",
    "failure to do so may engender seriously incorrect conclusion [ 5 ] .",
    "the _ third _ main point concerns the limit on the achievable @xmath11 or @xmath24 that can be obtained for any pac on given input @xmath5 of prescribed security level .",
    "it is clear that one can not always extract all bits given by the exponent @xmath26 by a fixed known pac , since the resulting @xmath24 or @xmath30 level would depend on exactly what eve s distribution @xmath94 ) is .",
    "the leftover hash lemma ( 2 ) guarantees the output @xmath30 level only from a single constraint on @xmath95 , in this case @xmath25 .",
    "it would thus be expected there is a cost for such generality , which is reflected in the tradeoff ( 2 ) . similarly , that there is a limit on how small @xmath30 may be obtained , which we give in ( 3 ) above .",
    "it should be mentioned that there is an ",
    "@xmath49-smooth \" generalization [ 12 ] of the tradeoff ( 2 ) which may improve the tradeoff quantitatively .",
    "such generalization has not given good numerical values in [ 7 ] .",
    "in particular , bounds on the numerical values of the @xmath25 exponent can be inferred from the reported values in [ 7 ] by assuming the less favorable ( 2 ) is used instead .",
    "thus , for one bit generated at @xmath96 one can infer the @xmath25 exponent is @xmath97 .",
    "this corresponds to just 48 uniform key bits , which may not be enough to cover the number of message authentication bits necessary to run the protocol .",
    "note that this result is obtained not on individual probabilistic guarantee but with at least two averages [ 4,5 ] we have mentioned . after the conversion there would just be 16 bits left .",
    "thus , after accounting for message authentication cost there is not net near uniform key bits generated .    generally , @xmath49-smooth generalization is useful for the tradeoff when the @xmath24 level associated with the @xmath30 level , or equivalently their exponents , is relatively large and one can tradeoff security for key rate increase .",
    "the problem of the current situation is , as we see from the above example , that the security level @xmath30 is _ not _ adequate even for @xmath98 and so we would want to decrease the @xmath49 in the @xmath49-smooth entropy . for small @xmath49 there is increasingly less distinction between the original entropy and the @xmath49-smooth entropy , which become identical at @xmath98 .",
    "furthermore , since the input @xmath99 is unknown as it is much harder to bound than @xmath47 , for the relatively large @xmath49 used in the @xmath49-smooth entropy of [ 7 ] it is not clear the pac has improved any security while it surely decreases the key rate .",
    "the @xmath49-smooth entropy generalization is interesting theoretically .",
    "its practical importance is yet to be demonstrated .",
    "the pac security analysis is valid and gives correct conclusion on the output @xmath30 if the input @xmath25 is correctly bounded .",
    "as we observe in section iii , there is no such correct bound under the arbitrary procedure ( 4)-(6 ) , and @xmath25 is bigger than @xmath47 by an unknown amount .",
    "so the final security level @xmath30 has _ not _ been validly established although the pac analysis is unproblematic .",
    "the main points or problems about current ecc and pac treatments of error correction and privacy amplification are as follows.      a.   the security treatment of eec via ( 4)-(6 ) is unacceptable as rigorous security analysis .",
    "b.   security of ecc appears impossible to quantify .",
    "it does not follow from  universal composition \" , whether the specific code is covered by a previously generated qkd key or by true uniform bits . c.   the ecc output @xmath25 or minimum entropy @xmath38 can not be rigorously estimated .",
    "a.   there is an inevitable tradeoff between security level and key rate for asymptotic key length @xmath31 going to infinity also , not just for finite @xmath31 .",
    "b.   there is a fundamental limit on how small the trace distance criterion may become by privacy amplification . c.   the trace",
    "distance security level of the generated key @xmath0 is not validly derived because the input condition on @xmath25 or @xmath38 is not validly derived.    as a consequence , there is no valid security proof in qkd just from point ( c ) or point ( iii ) above .",
    "the crux of the difficulty lies in a rigorous security treatment of error correction .",
    "note that the approach to qkd security outlined in [ 29 ] is fine , except it is mere schematic with no concrete realization .",
    "it appears that new techniques would need to be introduced to give correct security proofs for any given mathematical representation .",
    "note that this issue is totally separate from the question of whether the mathematical representation is complete or realistic .",
    "the ecc and pac information leaks are also not taken into account in [ 30 ] . since the security claim of the measurement - device - independent approach [ 31 ] to qkd is based on [ 30 ] or [ 15 ] ,",
    "the security of that approach is not yet established just for these problems alone .",
    "k. yamazaki , r. nair , and h.p .",
    "yuen , in proc .",
    "8th international conference on quantum communication , measurement , and computing , ed .",
    "o. hirota , j.h .",
    "shapiro , and m. sasaki , nict press , pp .",
    "201 - 204 ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> privacy amplification is a necessary step in all quantum key distribution protocols , and error correction is needed in each except when signals of many photons are used in the key communication in quantum noise approach . </S>",
    "<S> no security analysis of error correcting code information leak to the attacker has ever been provided , while an ad hoc formula is currently employed to account for such leak in the key generation rate . </S>",
    "<S> it is also commonly believed that privacy amplification allows the users to at least establish a short key of arbitrarily close to perfect security . in this paper </S>",
    "<S> we show how the lack of rigorous error correction analysis makes the otherwise valid privacy amplification results invalid , and that there exists a limit on how close to perfect a generated key can be obtained from privacy amplification . </S>",
    "<S> in addition , there is a necessary tradeoff between key rate and security , and the best theoretical values from current theories would not generate enough near - uniform key bits to cover the message authentication key cost in disturbance - information tradeoff protocols of the bb84 variety. </S>"
  ]
}