{
  "article_text": [
    "the reduction of degrees of freedom is arguably the most crucial step in computational sciences .",
    "numerical models can be formulated at several levels of detail : from _ ab initio _ including the electronic degrees of freedom , to classical force fields , to effective coarse - grained models , up to continuum models on the macroscopic scale .",
    "limited computational capacities then imply that these levels correspond to increasing length and time scales that can be accessed at the expense of decreasing molecular detail .",
    "indeed , for many applications details of the molecular interactions are irrelevant and models can be devised based on symmetry considerations and conservation laws alone , with the navier - stokes equations being a prominent example for a continuum model of fluid dynamics .    on intermediate levels ,",
    "systematic approaches to structural coarse - graining have been developed  @xcite such as iterative boltzmann inversion , which determines pair potentials for a reduced set of degrees of freedom from ( partial ) radial distribution functions obtained either from experiments or atomistic simulations .",
    "these relevant degrees of freedom have to be provided by the user and are typically informed by physical or chemical insights .",
    "one side effect of such a procedure is the loss of dynamical information , which is understood qualitatively ( removed degrees of freedom act as a `` bath '' leading to stochastic dynamics  @xcite ) but still hard to control .",
    "quite a different approach is followed through the construction of markov state models  @xcite , which aim to bridge the long time scales involved in , _",
    "e.g. _ , the folding of proteins from an initially disordered coil to the native state .",
    "these models are built by clustering microstates into a few mesoscopic states that are kinetically distinct , _",
    "i.e. _ , they correspond to basins that are separated by free energy barriers with a time - scale separation between fast intra - basin transitions and slow inter - basin transitions . in the case of a complete separation",
    "this can be exploited to endow the mesoscopic states with a markovian dynamics for the slow transitions assuming quasi - equilibrium for the fast transitions .",
    "one should note that a rigorous approach to dynamically consistent coarse - graining has been around for quite some time using projection techniques  @xcite . by projecting the dynamics onto the subspace spanned by the reduced variables , a non - markovian generalized langevin equation for the time evolution in this subspace",
    "is obtained , which is formally exact but now takes on the form of an integro - differential equation .",
    "the complexity of the original problem is , therefore , preserved as ones trades the reduction of the degrees of freedom for a memory kernel .",
    "further approximations are needed to obtain a numerically tractable problem . in the case of a clear separation of time",
    "scales one can employ the markovian approximation  @xcite .",
    "but even then the resulting equations are highly non - trivial both from a physical and mathematical point of view . within this framework attempts",
    "have been made to derive dynamical density functional theory  @xcite and its extension to non - equilibrium situations  @xcite .",
    "indeed , another layer of complexity is added when going away from thermal equilibrium to driven systems . _",
    "stochastic thermodynamics _ has emerged as a comprehensive theoretical framework in particular for driven systems that are still in contact with a heat reservoir that itself remains in equilibrium  @xcite . here",
    "two classes of non - equilibrium situations can be distinguished : time - dependent processes with dynamics that still obey detailed balance and non - equilibrium steady states with dynamics that explicitly break detailed balance through non - conservative forces and/or flows  @xcite .",
    "fluctuating path functionals like work , heat , and entropy production obey certain symmetries called fluctuation theorems  @xcite , which have been studied for ( chemical ) networks of discrete states  @xcite .",
    "hidden ( unobservable ) degrees of freedom modify the fluctuation theorems in various ways  @xcite , and the consequences of coarse - graining have been discussed for removing fast states  @xcite , `` bridge '' states  @xcite , and the clustering of microstates  @xcite .",
    "so far , only relatively simple models have been studied appealing to stochastic thermodynamics including a network model of kinesin with six states  @xcite and a model for motor proteins  @xcite .",
    "building on these works , the purpose of the present paper is to extend the markov state model approach to driven many - body systems and to construct coarse - grained models that are consistent with stochastic thermodynamics .",
    "the paper is organized as follows : in section  [ sec : back ] we briefly revisit the prerequisites , in particular how to obtain a network of discrete states from atomistic simulation data and introduce the relevant notions from stochastic thermodynamics . in particular _ cycles _ and the decomposition of networks into cycles  @xcite will play a crucial role .",
    "the actual algorithm consists of two parts : the identification and clustering of cycles discussed in section  [ sec : cc ] followed by the actual coarse - graining _ in cycle space _ described in section  [ sec : cg ] .",
    "finally , we provide some critical remarks before concluding .",
    "in order to maintain a non - equilibrium steady state , work has to be supplied constantly , which is dissipated as heat @xmath0 into the environment .",
    "this non - vanishing entropy production allows for the _ transport _ of some quantity @xmath1 , which might be the distance travelled by a particle , the number of molecules produced in a chemical reaction , etc .",
    "although the mapping to markovian dynamics proposed in this paper is not rigorous , there is evidence that the preservation of entropy production also implies the preservation of the major dynamical properties as well as macroscopic transport .",
    "indeed , very recently barato and seifert have conjectured that the dissipation of a process leading to a squared relative uncertainty @xmath2 is at least @xmath3 where @xmath4 is the duration of the process  @xcite .",
    "we employ dimensionless quantities throughout .",
    "in particular , entropies are measured in units of boltzmann s constant @xmath5 and energies in units of @xmath6 , where @xmath7 is the temperature of the surrounding heat bath .",
    "the first step is to construct a discrete markov state model and to determine the transition rates from particle - resolved simulation data .",
    "although already this step is non - trivial it is not the focus of the present manuscript , in which we study a sufficiently simple model to employ a straightforward construction . for our purposes it is important to include many discrete states to approximate the entropy production of the particle - resolved model as closely as possible .",
    "entropy production is related to cycles in the network of these discrete states .",
    "it seems quite clear that removing states will lead to `` cutting open '' some of these cycles and thus to a reduced entropy production  @xcite .",
    "our approach to this challenge is an additional step before the actual coarse - graining , which consists of identifying communities of cycles with similiar properties .",
    "the crucial step is then to identify a representative for each community , which will receive the entire entropy production of its community .",
    "all other cycles are then removed , and with them all states that are not visited by one of the representatives .",
    "this procedure preserves the entropy production rate , and eq .",
    "( [ eq : diss : bound ] ) therefore implies that fluctuations of ( measurable ) transported quantities obey the same lower bound in the original and the coarse - grained system .",
    "we will illustrate our approach to coarse - graining with a specific example : a brownian particle in a two - dimensional symmetric potential driven by a non - conservative force @xmath8 .",
    "working in two dimensions allows to directly visualize the configurations space as well as cycles , although the discussed algorithm is more generally applicable to many - body systems .",
    "the equation of motion follows as @xmath9 where @xmath10 is a random force with correlations @xmath11 and @xmath12 is the potential energy . as non - conservative force",
    "we choose @xmath13 , where @xmath14 denotes the driving strength .",
    "figure  [ fig : traj ] shows the contour lines of the potential and an exemplary trajectory .",
    "due to @xmath8 , the particle trajectory does not obey the symmetry of the conservative potential anymore .    ) and exemplary trajectory in the presence of the non - conservative force ( the arrows indicate the direction of the driving ) .",
    "the system is still invariant under inversion with the loci of highest probability being shifted from the minima of the potential.[fig : traj ] ]      we start by giving a short overview of how to create a markov state model from , in general , molecular dynamics simulations , while here we employ brownian dynamics ( bd ) propagating eq .",
    "( [ eq : bd ] ) . a detailed review can be found in  @xcite .",
    "the first step in building a markov state model is to approximate the continuous state space ( only the positions are taken into account ) by a set of discrete states that we will refer to as the microstates .",
    "the spatial discretization is typically obtained by cluster analyses , e.g. via the @xmath15-means algorithm . after a proper spatial discretization",
    "is found , the continuous @xmath16-dimensional state space is discretized into @xmath15 partitions .",
    "each of the @xmath15 partitions is represented by its center , called _ centroid _ , allowing the original data points to be mapped onto the centroids by minimizing their euclidean distance .",
    "once the full state space is discretized , the bd trajectory can be projected onto its centroids , storing its dynamical information as a simple sequence of centroid indices .",
    "the dynamical information can be extracted from this sequence of centroids by counting the number of transitions @xmath17 .",
    "whenever centroid @xmath18 is followed by @xmath19 we increase @xmath17 by one .",
    "finally , the transition matrix @xmath7 is approximated by @xmath20 which is also the maximum probability estimator for the true transition operator  @xcite .",
    "if @xmath21 is chosen small enough , we can further expand @xmath22 with _ rate matrix _ @xmath23 .",
    "it is important to note that for driven systems neither @xmath23 nor @xmath7 are symmetric in general .",
    "hence , their eigenvalues are complex , making the identification of metastable sets difficult .",
    "the reason is that the real part of the spectrum does not necessarily offer a gap , an illustrative example for which can be found in ref .  .",
    "the discrete states and their corresponding transition rates can be represented by a graph @xmath24 , where vertices @xmath25 represent the states and edges @xmath26 the transitions connecting the states .",
    "the number of vertices in @xmath27 is denoted by @xmath28 , while the number of edges is @xmath29 .",
    "if all transition rates @xmath30 are known is the value of @xmath1 taken in the transition @xmath31 . ] , the time evolution of the state probabilities is given by the master equation @xmath32 with normalization @xmath33 here @xmath34 are the directional probability fluxes indicating the amount of probability flowing from state @xmath18 to state @xmath19 per unit time .",
    "the subsequent description requires that the graph spanned by the markov model is ( i )  ergodic , _",
    "i.e. _ , every state can be reached by every other state in finite time , and ( ii )  the transition rates are reversible , _",
    "i.e. _ , if @xmath35 then also @xmath36 .",
    "hence , there is one edge for the forward and one edge for the backward transition between any two states that are connected through non - zero transition rates .    if the system is in a steady state the probability distribution , and hence probability fluxes , are time independent and we can drop the time argument , @xmath37 .",
    "the left hand side of equation  ( [ eq : master : i ] ) becomes zero , @xmath38 in the following we assume that the system resides in a ( non - equilibrium ) steady state .",
    "a special steady state is identified as thermodynamic equilibrium . here each summand of the right hand side of eq .",
    "( [ eq : master : ii ] ) vanishes individually , i.e. @xmath39 , while the condition @xmath40 is called detailed - balance stating that the amount of transported probability per unit time in the transition @xmath41 equals the amount of the reverse transition @xmath42 . if detailed - balance is broken a net probability current flows from @xmath41 and eq .",
    "( [ eq : master : ii ] ) can be identified as kirchhoff s current law stating that the same amount of probability flowing into state @xmath18 is also flowing out .      following refs .",
    ", the total average entropy production rate @xmath43 reads @xmath44 the first term is identified as the time derivative of the gibbs - entropy @xmath45 and thus describes the entropy change of the system itself .",
    "the second term represents the coupling of the system with its environment ( medium ) in such a way that the system can not reach equilibrium .",
    "the coupling can be , for example , caused by a heat or particle flux flowing from the medium into the system .",
    "only the sum of both entropy production rates is larger than zero in accordance with the second law .",
    "if the system is in a non - equilibrium steady state ( ness ) , the first term vanishes and consequently @xmath46 balance each other .    a second important quantity related to entropy production",
    "are _ affinities _ , or generalized thermodynamic forces  @xcite .",
    "the edge affinity between two states is defined as @xmath47 which can , again , be split into two parts .",
    "the first part @xmath48 is identified as the entropy produced in the medium  @xcite for every transition @xmath31 .",
    "interestingly , neither the affinities nor the dissipated heat depend on the time scales governing the dynamics of the system as in both expressions only the ratio of rates are taken into account .",
    "finally , the central concept in our approach to coarse - graining is _",
    "a cycle is an ordered set of states ( vertices ) , at the end of which the starting state is reached again .",
    "cycles that differ only in their cyclic permutation of vertices are considered identical .",
    "for example , @xmath49 all denote the same cycle but @xmath50 is a different cycle .",
    "we further distinguish between _ trivial cycles _",
    "( cycles with only two different states , _",
    "i.e. _ , @xmath51 ) , and _ non - trivial cycles _ that contain at least three different states .    two types of observables can be distinguished for each cycle :    * current - like observables that are summed along the edges corresponding to each cycle .",
    "consider an observable defined on the edges of a graph , that is given by a matrix @xmath52 .",
    "the cycle observable is computed as @xmath53 the notation @xmath54 denotes the summation over all directed edges @xmath41 that are part of cycle @xmath55 . * state - like observables that are summed over the states forming a cycle . here",
    "the observables are defined on the graph vertices given by a vector @xmath56 , and thus @xmath57    an example for the latter is given by the average cycle period @xmath58 ( the average time that is spend in cycle @xmath55 ) with @xmath59 being the average time spend in state @xmath18 .",
    "the most prominent example for a current - like observable is the _ cycle affinity _ @xmath60 it has two important properties :    * the cycle affinity of trivial cycles is always zero since affinities are anti - symmetric , @xmath61 , and thus @xmath62 . *",
    "all cycle affinities are independent of the state probabilities and thus can be expressed by @xmath48 s only .    to prove ( ii ) , @xmath63 since the @xmath64 s are state functions , going along a cycle they cancel pairwise .",
    "a remarkable property of a ness is thus that the average entropy production can be calculated either by using the @xmath65 s or @xmath48 s , which correspond to @xmath66 and @xmath67 , respectively .",
    "for convenience , we define the indicator @xmath68 and passage function @xmath69 depending on whether a vertex @xmath18 or directed edge @xmath31 is part of a cycle @xmath55 , respectively . following the ideas of refs .",
    ", the cycle - flux decomposition expresses the flux field @xmath70 through a linear combination of cycles , @xmath71 the _ cycle weight _",
    "@xmath72 quantifies how much probability flows through cycle @xmath55 per unit time . as shown in refs .  , @xmath73 is non - negative and the decomposition eq .",
    "( [ eq : decomp ] ) always exists if @xmath70 satisfies the steady state condition ( kirchhoff s current law ) .",
    "however , this decomposition is not unique as discussed in the next section  [ sec : algo ] .",
    "using the cycle observables eq .",
    "( [ eq : def_c_av_x ] ) and inserting the cycle decomposition eq .",
    "( [ eq : decomp ] ) , the average of a current - like observable @xmath74 can be expressed as a cycle average with weights @xmath75  @xcite . in particular",
    ", the cycle average of affinities @xmath76 equals the total average entropy production with the definition of edge affinities eq .",
    "( [ eq : edge_affinity ] ) .",
    "furthermore , we define the conditional average entropy production of a single cycle @xmath77 so that the total average entropy production becomes the sum @xmath78 .      several types of algorithms have been proposed in the literature to accomplish the decomposition eq .",
    "( [ eq : decomp ] )  @xcite .",
    "for example the `` method of derived chain '' introduced in ref .  , which is stochastic in nature and has the advantage that the cycle weights @xmath75 in eq .",
    "( [ eq : decomp ] ) are unique and that they correspond to the mean number of passages through cycle @xmath79 .",
    "however , negative cycle entropies ( @xmath80 ) may occur , which greatly complicates the identification of communities ( as will become clear shortly ) .",
    "moreover , the number of cycles used in the decomposition can be orders of magnitude larger than for the other approaches discussed below .",
    "another important type of cycle decompositions , first mentioned by schnakenberg  @xcite , considers fundamental cycles that span a basis of the cycle space .",
    "although the number of contributing cycles is as small as for the described algorithm below , the fundamental cycles are not unique and can have negative cycle entropies as well .",
    "we employ a variant of the `` cycle - flux '' decomposition introduced by macqueen  @xcite .",
    "this is a deterministic algorithm that has a polynomial complexity in the number of vertices @xmath28 , making it computationally affordable even for large graphs .",
    "again , the decomposition ( and thus the cycle weights @xmath75 ) is not unique but rather depends on the initial cycle sequencing , where already a minor variation in the sequencing can lead to different cycle weights . in particular ,",
    "some cycle weights become zero while others become non - zero .",
    "an example illustrating this arbitrariness is given in ref .  , where the cycle - flux decomposition is applied to the totally asymmetric simple exclusion process ( tasep ) model .",
    "let @xmath81 denote the set of _ all _ possible cycles . only the subset @xmath82 of cycles with non - vanishing cycle weights contribute to averages ,",
    "an upper bound @xmath83 of which is given by the betti number @xmath84  @xcite .",
    "the problem is that one can not know beforehand what the contributing cycles are , meaning that theoretically all possible cycles are needed to ensure a complete decomposition , although most of them will have zero weights especially for graphs with many vertices .",
    "already the number of possible cycles of an undirected graph is bounded by @xmath85  @xcite .",
    "we now describe the algorithm in more detail . to this end , we sort cycles , @xmath86 where first come the trivial cycles followed by the non - trivial cycles containing three or more states . the number of trivial cycles is given by half the number of edges , @xmath87 .",
    "initialize @xmath88 and take the first cycle @xmath79 from @xmath89 :    1 .",
    "take all fluxes @xmath90 along cycle @xmath79 and find the smallest value , which becomes the cycle weight @xmath75 , @xmath91 2 .",
    "subtract @xmath75 from all fluxes along @xmath79 , @xmath92 .",
    "the new flux field has at least one edge less .",
    "advance to the next cycle @xmath79 in @xmath89 and repeat .",
    "the algorithm stops when the residuum @xmath93 has become smaller than some threshold .",
    "after the first @xmath87 iterations , all trivial cycles are subtracted and hence the flux field @xmath90 at this stage contains only irreversible edges , _",
    "i.e. _ , if @xmath94 then @xmath95 .",
    "hence , the fluxes have become the ( positive ) currents of the original graph , @xmath96 , where @xmath94 since the algorithm subtracts the smaller value .",
    "the original affinities @xmath65 along the remaining edges are thus positive , cf .",
    "( [ eq : edge_affinity ] ) , and hence all cycle affinities for the remaining non - trivial cycles are positive . an illustrative example for a concrete graph",
    "is presented in appendix  [ sec : cycle : decomp ] .",
    "note that this implies @xmath97 for all non - trivial cycles .    in appendix",
    "[ sec : cycle : det ] an algorithm is outlined how to obtain all contributing cycles @xmath89 . removing the trivial cycles",
    ", we can thus further reduce the set of cycles @xmath98 to be considered in the following with @xmath99 .        ) of cycle",
    "entropy production of our model system .",
    "the first red line marks the number of cycles to recover 95% and the second to recover 99% of the total entropy production.[fig : cumsum ] ]    markov state models that are constructed from molecular dynamics simulations contain thousands , or even millions , of cycles .",
    "this is in stark contrast to the semi - empirical models discussed so far containing a handful of  already coarse - grained  states  @xcite . at this stage",
    "it is important to realize that there are _ no dominant cycles _ in terms of the entropy production .",
    "this is illustrated in figure  [ fig : cumsum ] for our specific model system .",
    "we have chosen @xmath100 ( this is an input to the @xmath15-means clustering algorithm ) and found @xmath101 edges implying @xmath102 with non - trivial cycles @xmath103 .",
    "shown is the normalized cumulative sum @xmath104 of the first @xmath105 cycles for sorted cycle entropies @xmath106 already for our simple model system a large number of cycles contribute and no dominant cycles appear . to recover 95% of the total entropy production , almost 2000 cycles have to be included , although many of the non - trivial cycles do not contribute substantially to the overall entropy production .",
    "our approach in the following is based on the idea that many cycles are similar in their length , traversed states ( region in state phase ) , and cycle affinities .",
    "we will propose how to quantify this `` similarity '' of cycles and how to group these cycles together , forming _",
    "cycle communities_.    the cycles in @xmath107 can again be interpreted as vertices of a graph @xmath108 .",
    "it is important to realize that we have a considerable freedom in defining edge weights ( analogous to the original transition rates @xmath109 ) .",
    "here we opt to link cycles @xmath79 and @xmath110 using @xmath111 which is symmetric as emphasized by the subscripts .",
    "two cycles are linked only if they share at least one vertex on the original graph , while the connectivity strength @xmath112 depends on the cumulated probability of the shared states .",
    "other proposals for linking cycles can be found in refs .  .",
    "in practice , we found that the resulting graph is connected too strongly and that better results are achieved if @xmath113 is modified using additional information .",
    "we thus cut a link if ( i )  two cycles have dissimilar cycle affinities and ( ii )  if their spatial extensions differ too much .",
    "for the later , the spatial extension of a cycle is defined as the maximal euclidian distance of centroid positions @xmath114 where @xmath115 is the state - space vector representing centroid @xmath18 .",
    "hence , @xmath116 with @xmath117 .",
    "specifically , for our model system we have set @xmath118 .",
    "the resulting cycle graph is shown in figure  [ fig : cycle_space ] .    ]      having defined @xmath113 to be symmetric and thus undirected , we can make use of well - developed community finding algorithms for undirected graphs .",
    "formally , the communities are disjoint sets @xmath119 of the non - trivial cycles , @xmath120 a community is a group of vertices that share similar properties and are consequently stronger connected ( higher link density ) to vertices inside their community than with vertices from other communities .",
    "the number of communities is inherent to its graph and not preassigned .",
    "a review of the most important algorithms can be found in ref .  .",
    "in general , a measure of how good community finding algorithms perform is the modularity function @xmath121 , which measures the link density inside communities as compared to other communities by assigning it a value between -1 and 1  @xcite .",
    "it is defined as @xmath122 with @xmath123 and @xmath124 .",
    "specifically , we use a community finding algorithm  @xcite that has been shown to be fast and achieves good results also for a large number of cycles ( vertices in the cycle space ) . here",
    "we are interested in finding communities among all non - trivial cycles that were found by applying the cycle - flux decomposition algorithm described in the previous section  [ sec : algo ] .",
    "the communities found for our model system are displayed in figure  [ fig : cycle_space ] in cycle space and in figure  [ fig : cycle_communities ] for the original state space .",
    "three communities have been detected : the red and green colored communities are in agreement with the loci of highest probability , cf .",
    "figure  [ fig : traj ] , while the blue community contains cycles connecting these two loci .",
    "this result agrees well with the intuitive picture of entropy production due to the interplay between conservative and non - conservative forces for the particle trapped in a basin , with rare transitions between both basins .    .",
    "three communities with red , green , and blue have been identified by the community finding algorithm.[fig : cycle_communities ] ]",
    "we have now identified communities of cycles with similiar properties determined through the link strength @xmath125 . however , it is not possible to compute something like an average cycle because the cycle space does not have any physical metric .",
    "furthermore , we are restricted to the original states and transition rates ( or rather @xmath48 s ) as they have a physical meaning , _",
    "i.e. _ , position in state space and medium entropy production per transition , respectively . to overcome this problem ,",
    "we determine one cycle out of each cycle community , which we will refer to as the ( community ) _",
    "representative_. this cycle is then rescaled in order to preserve the entropy production of the whole community , and the other cycles are discarded .    to this end , we rewrite the modularity function eq .",
    "( [ eq : modularity_function ] ) as the sum over all community modularities @xmath126 where @xmath127 denotes the @xmath127-th community .",
    "our task is to find the cycle @xmath128 for each cycle community @xmath127 that maximizes @xmath129 , with @xmath130 being the modularity of the @xmath127-th community _ without _ cycle @xmath128 . in other words ,",
    "we want to identify the cycle @xmath128 for each community that has the biggest impact on the community modularity .",
    "in particular , @xmath130 increases if cycle @xmath128 matches poorly and decreases when it provides many links to other cycles inside its community .",
    "after some algebra , the difference is given by @xmath131 for our model system , the three representatives found from maximizing the modularity difference are illustrated in figure  [ fig : cycle_representative ] .      after determining the representatives ,",
    "the original fluxes @xmath132 and transition rates @xmath109 have to be rescaled .",
    "the physical constraints are :    1 .",
    "the total entropy production @xmath133 is preserved .",
    "the @xmath48 s of all non - vanishing edges are preserved .",
    "3 .   the cycle affinities @xmath134 of all contributing cycles are preserved .",
    "it is easy to check that ( iii ) is valid if ( ii ) is fulfilled , cf .",
    "( [ eq : cycle_affinity ] ) . for every cycle community",
    ", we define a _ community _",
    "entropy production @xmath135 because all non - trivial , and thus possibly entropy producing , cycles are partitioned into communities , the total entropy production of the original graph is the sum of all community entropy productions . in what follows ,",
    "all rescaled quantities are labeled by hats , _",
    "e.g. _ , @xmath136 .",
    "moreover , the subscript @xmath127 to cycle quantities denotes the cycle representative of the @xmath127-th community , _",
    "e.g. _ , @xmath137 is the cycle entropy production .",
    ", whereas the cyan states highlight the crossings of representatives .",
    "the gray points indicate the centroids not belonging to a representative , which are thus absent in the coarse - grained model.[fig : cycle_representative ] ]    we now identify the _ new _ entropy production of each representative cycle @xmath138 with the entropy production of its community @xmath139 . by making use of ( iii ) , we compute the new cycle weight @xmath140 as @xmath141 the crucial coarse - graining step consists of removing all other non - trivial cycles by setting their weights @xmath142 to zero . because the entropy production of trivial cycles is always zero , @xmath143 is preserved and ( i ) fulfilled .",
    "all states that are not part of a community representative are thus removed with the remaining states @xmath144 constituting the coarse - grained markov state model , see figure  [ fig : cycle_representative ] .",
    "all cycles in the coarse - grained model are either a representative or trivial .",
    "we now show that the weights of the remaining trivial cycles are always positive and the coarse - grained model thus still constitutes a valid cycle - flux decomposition @xmath145 for the rescaled fluxes @xmath146 , cf .",
    "( [ eq : decomp ] ) . this can be achieved by demanding that all non - vanishing edge affinities @xmath65 are preserved . by virtue of eq .",
    "( [ eq : decomp ] ) , the new cycle weights @xmath142 can then be computed from @xmath147 which can be rearranged to @xmath148 we now pick one edge @xmath31 for which the edge affinity @xmath149 is positive .",
    "we then split the sum over all cycles into a sum over trivial and non - trivial cycles , @xmath150 for every edge there is exactly one trivial cycle , here denoted @xmath110 , for which @xmath151 . as explained in section  [ sec : algo ] , for positive affinity all non - trivial cycles are oriented to follow the net flow , which implies @xmath152 .",
    "the remaining sum over all non - trivial cycles participating in edge @xmath31 reduces to the weight of the representative cycles since we have set the weight of all other non - trivial cycles to zero .",
    "we have thus determined the remaining weights @xmath153 of the trivial cycles , which clearly are positive .",
    "the final step is to obtain new probabilities @xmath154 for the remaining states .",
    "we simply scale out the probability of the removed states implying @xmath155 with normalization @xmath156 .",
    "moreover , this is sufficient to preserve the ratio of transition rates @xmath157 fulfilling condition ( ii ) . together with the rescaled fluxes we thus obtain transition rates @xmath158 , which completes the formulation of the coarse - grained markov state model .      to test the accuracy of the coarse - grained model , we compute the forward and backward rate of traversing between both basins for the continuous bd trajectory and our reduced markov state model .",
    "the mesoscopic rates for the reduced markov state model have been calculated using a kinetic monte - carlo scheme .",
    "figure  [ fig : histo_rates ] shows the normalized histograms and the exponential fit ( dotted blue line ) obtained for the coarse - grained model as well as the exponential fit obtained from the original bd simulations ( red line ) . due to the symmetry of the forces",
    ", these rates should be equal , which is recovered by the coarse - grained model .",
    "moreover , the numerical values of both rates are in excellent agreement with the bd results ( see table  [ tab : rates ] ) , illustrating that our coarse - graining method indeed preserves the mesoscopic time scales of the bd simulation .    ]",
    ".mesoscopic transition rates for the model system for the original brownian dynamics ( bd ) and the coarse - grained ( cg ) model .",
    "[ cols=\"<,^,^\",options=\"header \" , ]      in this appendix , we explain how to effectively obtain the cycles that are used for the cycle - flux decomposition without first finding all possible cycles .",
    "we make use of a widely - used method in graph theory  @xcite . for every connected graph @xmath24",
    "a spanning tree @xmath159 can be constructed , which is the set @xmath25 of all vertices connected by @xmath160 edges .",
    "we further demand that the edge directions in @xmath159 are the same as in @xmath27 .",
    "the @xmath161 edges of @xmath27 that are not part of @xmath159 are called chords , with @xmath162 .",
    "again , it is important to preserve the original direction of each chord .    after subtracting all trivial cycles , the new flux field @xmath90 is obtained , which contains only irreversible edges .",
    "for this graph the spanning tree @xmath163 is constructed .",
    "adding one chord completes one non - trivial cycle .",
    "we determine all non - trivial cycles corresponding to the chords and again apply the cycle - flux decomposition as outlined in section  [ sec : algo ] , leading to a new flux field @xmath90 .",
    "if fluxes remain , we repeat this procedure by which iteratively new cycles are added .",
    "the complete algorithm reads as follows :",
    "1 .   apply cycle - flux decomposition for all trivial cycles .",
    "2 .   create oriented spanning tree @xmath163 .",
    "3 .   identify directed chords and find corresponding cycles .",
    "4 .   apply cycle - flux decomposition to the newly identified cycles .",
    "5 .   check if remaining flux field @xmath164 , otherwise repeat with step ( ii ) .",
    "10 url # 1#1urlprefix[2][]#2 mller - plathe f 2002 coarse - graining in polymer simulation : from the atomistic to the mesoscopic scale and back _ chemphyschem _ * 3 * 754769        chodera j  d , singhal n , pande v  s , dill k  a and swope w  c 2007 automatic discovery of metastable states for the construction of markov models of macromolecular conformational dynamics _ j. chem",
    ". phys . _ * 126 * 155101                                          altaner b , grosskinsky s , herminghaus s , katthn l , timme m and vollmer j 2012 network representations of nonequilibrium steady states : cycle decompositions , symmetries , and dominant paths _ phys .",
    "e _ * 85 * 041133"
  ],
  "abstract_text": [
    "<S> a major current challenge poses the systematic construction of coarse - grained models that are dynamically consistent , and , moreover , might be used for systems driven out of thermal equilibrium . here </S>",
    "<S> we present a novel prescription that extends the markov state modelling approach to driven systems . </S>",
    "<S> the first step is to construct a complex network of microstates from detailed atomistic simulations with transition rates that break detailed balance . </S>",
    "<S> the coarse - graining is then carried out in the cycle space of this network . to this end </S>",
    "<S> we introduce the concept of representatives , which stand for many cycles with similar properties . </S>",
    "<S> we show how to find these cycle communities using well - developed standard algorithms . </S>",
    "<S> removing all cycles except for the representatives defines the coarse - grained model , which is mapped back onto a network with far fewer states and renormalized transition rates that , however , preserve the entropy production of the original network . </S>",
    "<S> our approach is illustrated and validated for a single driven particle . </S>"
  ]
}