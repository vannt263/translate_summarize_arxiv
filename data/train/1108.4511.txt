{
  "article_text": [
    "let @xmath0 be a surface of genus @xmath1 with one boundary component , with basepoint @xmath2 .",
    "the _ mapping class group _",
    "@xmath3 is the group of self - homeomorphisms of @xmath4 fixing @xmath5 , up to isotopy fixing @xmath5 .",
    "the mapping class group is filtered by the _",
    "johnson filtration _ @xmath6 , consisting of those mapping classes that act trivially on the universal @xmath7-step nilpotent quotient of @xmath8 . of particular interest are the _ torelli group _ @xmath9 and the _ johnson kernel _ @xmath10 .",
    "johnson  @xcite proved that @xmath10 is equal to the subgroup @xmath11 of @xmath3 generated by dehn twists about separating curves .",
    "the mapping class group @xmath3 acts on the set of all simple closed curves on @xmath4 ( more precisely , their isotopy classes ) , and we say that two curves are _ equivalent _ under a subgroup @xmath12 if they lie in the same @xmath13orbit under this action .",
    "two curves @xmath14 and @xmath15 are equivalent under @xmath3 if and only if the complements @xmath16 and @xmath17 are homeomorphic .",
    "one of the main goals of this paper is to describe precisely two simple closed curves are equivalent under @xmath11 ; in other words , we determine when one simple closed curve can be taken to another by applying a sequence of separating dehn twists .",
    "* orbits of nonseparating curves . *",
    "our first theorem describes when two _ nonseparating _ curves are equivalent under @xmath11 .",
    "any two nonseparating curves are equivalent under @xmath3 , even when considered as oriented curves .",
    "johnson  @xcite proved the deeper result that two oriented nonseparating curves are equivalent under @xmath18 if and only if they are homologous .",
    "it is easy to show that if @xmath14 and @xmath15 lie in the same @xmath11-orbit , then the mapping class @xmath19 lies in @xmath11 .",
    "our first main result shows that this condition is also sufficient .",
    "we also obtain an alternate condition in terms of based loops @xmath20 representing the curves @xmath14 and @xmath15 . in the following theorem",
    ", @xmath21 denotes the @xmath22-th term of the lower central series of @xmath8 , indexed so that @xmath23 and @xmath24 is its commutator subgroup .",
    "we use the well - known isomorphism @xmath25 defined by @xmath26\\mapsto [ \\xi]\\wedge [ \\xi']$ ] , and given @xmath27 we denote by @xmath28 the subspace spanned by elements of the form @xmath29 .",
    "[ thm : intrononsep ] let @xmath14 and @xmath15 be oriented nonseparating curves homologous to @xmath27 .",
    "the following are equivalent :    1 .   the nonseparating curves @xmath14 and @xmath15 are equivalent under @xmath11 .",
    "2 .   @xmath30 .",
    "3 .   for *",
    "some * representatives @xmath31 of the curves @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_2(s)/\\gamma_3(s){\\cong}{\\textstyle{\\bigwedge}}^2 h_1(s)$ ] lies in the subspace @xmath28 .",
    "4 .   for *",
    "any * representatives @xmath33 of @xmath14 and @xmath15 , @xmath32\\in \\gamma_2(s)/\\gamma_3(s){\\cong}{\\textstyle{\\bigwedge}}^2 h_1(s)$ ] lies in @xmath28 .",
    "let us apply the theorem to the case when the nonseparating curves @xmath14 and @xmath15 are disjoint and homologous , forming a so - called `` bounding pair '' .",
    "in this case johnson proved in ( * ? ? ?",
    "* lemma  4b ) that @xmath34 , so condition 2 implies that @xmath14 and @xmath15 are not equivalent under @xmath11 ; this was previously proved by farb  leininger ",
    "margalit  ( * ? ? ?",
    "* proposition  3.2 ) .    as an illustration",
    ", we show how condition 4 would be applied in this case .",
    "the union @xmath35 necessarily separates @xmath4 into two components , say @xmath36 and @xmath37 , and there exists a standard basis @xmath38 for @xmath8 so that @xmath39\\cdots[\\alpha_k,\\beta_k]\\alpha_{k+1}$ ] and @xmath40 represent the curves @xmath14 and @xmath15 . if @xmath41 is the induced symplectic basis for @xmath42 we have @xmath32=a_1\\wedge b_1+\\cdots+a_k\\wedge b_k\\in \\gamma_2(s)/\\gamma_3(s){\\cong}{\\textstyle{\\bigwedge}}^2 h_1(s)$ ] . since this element certainly does not lie in the subspace @xmath43 , condition 4 of theorem  [ thm : intrononsep ]",
    "is verified , giving another proof that disjoint nonseparating curves @xmath14 and @xmath15 never lie in the same @xmath11orbit .    conditions 3 and 4 are most useful in practice , since to check whether @xmath30 requires either computing @xmath44 by factoring @xmath19 as a product of bounding pair maps , or calculating its action on an entire basis for @xmath45 .    * orbits of separating curves . *",
    "our next theorem describes when two _ separating _ curves @xmath14 and @xmath15 are equivalent under @xmath11 .",
    "a separating curve @xmath14 separates @xmath16 into two components homeomorphic to @xmath46 and @xmath47 for some @xmath48 , and the @xmath3orbit of @xmath14 is determined by the genus @xmath22 .",
    "johnson  ( * ? ? ?",
    "* theorem 1a ) proved that the @xmath18orbit of @xmath14 is determined by the rank-@xmath49 symplectic subspace of @xmath42 spanned by homology classes supported on the subsurface @xmath46 .",
    "given such a symplectic subspace @xmath50 , we denote by @xmath51 the restriction of the symplectic form @xmath52 to @xmath53 .",
    "there is a natural surjection @xmath54 defined by @xmath55 $ ] , where @xmath56 are any representatives of @xmath57 .",
    "we denote by @xmath58 the subspace of @xmath59 spanned by the images of elements @xmath60 .",
    "[ thm : introseparating ] let @xmath14 and @xmath15 be separating curves cutting off the same symplectic subspace @xmath61 .",
    "the following are equivalent :    1 .   the separating curves @xmath14 and @xmath15 are equivalent under @xmath11 .",
    "2 .   the separating twists @xmath62 and @xmath63 are conjugate in @xmath11 .",
    "3 .   for *",
    "some * representatives @xmath31 of the curves @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_3(s)/\\gamma_4(s)$ ] lies in the subspace @xmath58 .",
    "4 .   for *",
    "any * representatives @xmath33 of @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_3(s)/\\gamma_4(s)$ ] lies in @xmath58 .    * defining the johnson filtration for subsurfaces . *",
    "a standard inductive technique in studying the mapping class group is to reduce to the stabilizers of curves , which amounts to studying the mapping class group @xmath64 of subsurfaces @xmath65 .",
    "however , this approach has not been available for the johnson filtration : the problem is that the restriction of @xmath6 to a subsurface @xmath66 is not intrinsic to @xmath66 as an abstract surface , but gives different subgroups of @xmath64 depending on how @xmath66 is embedded into @xmath4 .    in his thesis @xcite ,",
    "putman took the first step toward resolving this problem .",
    "he showed that the restriction of the torelli group to a subsurface @xmath65 becomes intrinsic after adding only a small amount of homological data . a _ partitioned surface _",
    "@xmath67 is a surface with nonempty boundary , equipped with a partition of its boundary components .",
    "any subsurface @xmath65 determines a partitioned surface @xmath67 , where the partition records which of the boundary components of @xmath66 become homologous in the larger surface @xmath4 .",
    "putman defined the torelli group @xmath68 of a partitioned surface as the restriction of @xmath69 , proved this is well - defined regardless of the embedding @xmath70 , and used this to give natural inductive proofs for many key theorems on the torelli group",
    ". an alternate approach , which we take in this paper , is to first define @xmath71 , a modified version of @xmath72 which serves as the `` first homology group of the partitioned surface @xmath67 '' .",
    "it can be thought of as the first homology of the smallest closed surface into which @xmath67 embeds ; see section  [ sec : torelli ] for details .",
    "the mapping class group @xmath64 then acts on @xmath73 , and we define the torelli group @xmath68 as the subgroup acting trivially on @xmath73 .",
    "based on this evidence , one might expect that to describe how the johnson filtration @xmath6 restricts to a subsurface @xmath66 , it would be necessary to record more and more nilpotent data describing the restriction of the lower central series @xmath21 to the subsurface @xmath66 . in section  [ sec : johnsonfiltration ]",
    "we prove the surprising result that _ no additional data is necessary _ to define the johnson filtration on subsurfaces .",
    "given only the data of a partitioned surface @xmath67 , we define in definition  [ def : johnsonfiltration ] the _ partitioned johnson filtration _ @xmath74 .",
    "the key property , proved in theorem  [ thm : preserved ] , is that @xmath74 is _ natural _ under inclusions : if @xmath67 is a subsurface of a larger surface @xmath4 , then @xmath74 is precisely the subgroup of @xmath75 that lies in @xmath6 .",
    "this makes it possible to apply inductive arguments to any term of the johnson filtration .",
    "as one example , we prove in theorem  [ thm : bbm ] a coherence result for @xmath11stabilizers of subsurfaces ; this result has already been used in bestvina  bux  margalit  @xcite to compute the cohomological dimension of @xmath76 .    * defining and computing the johnson homomorphism for subsurfaces . *   to prove theorems  [ thm : intrononsep ] and [ thm : introseparating ] , it is not enough to understand the johnson kernel @xmath76 for subsurfaces",
    "; we also need to understand how the johnson homomorphism behaves when restricted to subsurfaces .",
    "the _ johnson homomorphism _ @xmath77 defined by johnson in @xcite , is constructed from the action on the universal 2-step nilpotent quotient @xmath78 . in particular , the kernel of @xmath79 is the johnson kernel @xmath11 by definition .",
    "johnson proved that the image of @xmath79 is the subspace @xmath80 , giving a short exact sequence @xmath81    the key advance that lets us prove theorems  [ thm : intrononsep ] and [ thm : introseparating ] is an _ intrinsic _ definition of the johnson homomorphism for a partitioned surface , without necessarily embedding it into a larger surface . for any partitioned surface @xmath67 , we define in definition  [ def : taus ] the _ partitioned johnson homomorphism _ @xmath82 as in johnson s original paper , @xmath83 is defined from the action of @xmath68 on a 2-step nilpotent quotient of @xmath84 , but we replace the lower central series of @xmath8 by a variant depending on the partitioned surface @xmath67 . in particular , the abelian group @xmath85 is a modification of @xmath86 , just as @xmath71 is a modification of @xmath87 .",
    "we prove in corollary  [ cor : sameasks ] that just as in the classical case , the kernel @xmath88 is the third term @xmath89 of the partitioned johnson filtration .",
    "one of our main results on @xmath83 is the exact computation of its   that @xmath90 for a certain explicitly defined subspace @xmath91 .",
    "if the components of @xmath92 are partitioned into @xmath93 blocks , the image @xmath94 can be identified ( see ) with @xmath95 , where @xmath96 is the image of @xmath97 in @xmath73 .",
    "this gives a short exact sequence @xmath98    in theorem  [ thm : commutes ] we prove that this partitioned johnson homomorphism is natural under inclusions of subsurfaces , so for any mapping class supported on a subsurface , we can compute the johnson homomorphism locally .",
    "this reduces all of johnson s classical computations to trivial or nearly - trivial computations .",
    "for example , any separating twist @xmath62 is supported on an annulus @xmath67 .",
    "but if @xmath67 is an annulus then @xmath99 by definition , so @xmath100 , and naturality then implies that @xmath101 for any separating curve on any surface .",
    "similarly , any bounding pair @xmath19 is supported on a pair of pants @xmath67 , so the computation of @xmath44 reduces to the computation for a pair of pants , for which @xmath94 is just @xmath102 .",
    "the characterization of @xmath11orbits in theorems  [ thm : intrononsep ] and [ thm : introseparating ] depends on computing the image under @xmath79 of @xmath103 , which is closely related to computing @xmath104 for the complementary components of @xmath16 . from the arguments in section",
    "[ sec : ksorbits ] it will be clear how to compute this image , and thus the space of @xmath11orbits , for other configurations , such as arbitrary collections of separating curves or nonseparating collections of nonseparating curves . however , there is no guarantee that the resulting classification can still be formulated in terms of @xmath105 in these cases ; that this is possible for a single separating curve seems to be a happy coincidence .",
    "* first betti number of @xmath68 and comparison with putman . *   by combining the results of this paper with one of the main theorems of putman  @xcite , we prove the following theorem .",
    "[ thm : betti ] let @xmath67 be a surface of genus @xmath106 whose @xmath107 boundary components are partitioned into @xmath93 blocks , and let @xmath108 . then the first betti number @xmath109 is @xmath110 moreover , any finite - index subgroup of @xmath68 that contains @xmath111 also has @xmath112 .",
    "we deduce theorem  [ thm : betti ] from ( * ? ? ?",
    "* theorem  1.2 ) , which states that whenever @xmath67 has genus at least 3 , the rational abelianization @xmath113 is isomorphic to @xmath114 , and moreover that this holds for any finite - index subgroup of @xmath68 containing @xmath111 .",
    "this means that the calculation of @xmath104 in theorem  [ thm : ws ] is also a calculation of the first betti number @xmath115 of the torelli group .    in @xcite",
    ", putman has independently addressed questions closely related to the focus of this paper , centered around the question of defining the johnson kernel @xmath111 for a subsurface @xmath67 of an ambient closed surface @xmath4 . however , one key difference is that putman does not prove that @xmath111 is well - defined , which forces him to always work relative to a fixed embedding into a closed surface .",
    "fortunately , theorem  [ thm : preserved ] guarantees that our definition of @xmath111 agrees with putman s definition , so corollary  [ cor : sameasks ] tells us that @xmath111 is indeed well - defined . in particular , ( * ? ? ?",
    "* theorem  1.1 ) states that whenever @xmath67 has genus at least 2 , @xmath111 is generated by separating twists ( when @xmath116 , this gives a new proof of the main theorem in johnson  @xcite ) .",
    "* orbits of curves under the johnson filtration . *   we conclude this introduction with a question that was posed to us by dan margalit , inspired by theorem  [ thm : intrononsep ] .",
    "[ q : margalit ] let @xmath14 and @xmath15 be nonseparating curves on @xmath4 .",
    "is it true that @xmath117    for @xmath118 this is trivial , for @xmath119 this was proved by johnson , and for @xmath120 this is proved in theorem  [ thm : intrononsep ] as the equivalence of conditions 1 and 2 . for @xmath121 , although the methods of this paper do not suffice to answer question  [ q : margalit ] , they do allow us to reduce it to the following question .",
    "let @xmath122 denote the @xmath22th higher johnson homomorphism , and note that @xmath123 acts on the target of @xmath124 ( see e.g.  ( * ? ? ?",
    "* section 2 ) for details ; these maps will not be used elsewhere in the paper ) .",
    "[ q : tom ] let @xmath14 be a nonseparating curve with homology class @xmath125 , and let @xmath126 be the symplectic transvection @xmath127 .",
    "is it the case that @xmath128    question  [ q : tom ] is equivalent to question  [ q : margalit ] , as can be shown along the same lines as the proof of theorem  [ thm : intrononsep ] in section  [ sec : kononsep ] .",
    "note that the image @xmath129 is always contained in @xmath130 , since any element stabilizing @xmath14 commutes with @xmath62 .",
    "therefore the question is whether the right side of the equation is contained in the left side .",
    "the difficulty in answering question  [ q : tom ] in general is that for @xmath121 , although many partial results have been obtained , we still do not know the image @xmath131 .",
    "* acknowledgements . *",
    "this paper is based on the author s 2011 ph.d .",
    "thesis at the university of chicago .",
    "i am deeply grateful to my advisor benson farb for his constant encouragement , his guidance , and his unwavering support .",
    "i thank vladimir drinfeld , aaron marcus , and andy putman for many helpful conversations , and i thank benson farb and andy putman for suggesting this problem .",
    "i thank dan margalit for pointing out that condition 2 of theorem  [ thm : intrononsep ] could be added , and for conversations regarding question  [ q : margalit ] .",
    "i am extremely grateful to the anonymous referee for their careful reading and helpful suggestions , which greatly improved the organization and exposition of the paper .",
    "let @xmath4 be a compact connected surface with nonempty boundary , with a partition @xmath132 of its set of boundary components @xmath133 , and a basepoint @xmath2 ; we call @xmath134 a _ partitioned surface_. this notion was first used by putman in @xcite .",
    "we refer to the elements @xmath135 as _ blocks _ of the partition @xmath132 ; each block is a subset of @xmath133 .",
    "we distinguish the block @xmath136 which contains the component containing @xmath137 .",
    "* basic terminology . *",
    "the metaphor underlying all our terminology regarding partitioned surfaces is that @xmath4 is thought of as being embedded into a larger surface @xmath66 , and the partition @xmath132 records which components of @xmath5 can be connected by a path in the complement @xmath138 .",
    "( here and throughout the paper , by @xmath138 we mean the complement in @xmath66 of the interior of the subsurface @xmath4 , so that @xmath138 is itself a compact surface with boundary . )",
    "the data of @xmath67 allows us to work intrinsically on @xmath4 , without needing to embed it in a larger surface , or to choose between different embeddings .",
    "we say that two boundary components are _ connected outside @xmath67 _ if they lie in the same block @xmath139 .",
    "a separating curve @xmath140 on @xmath4 is called _ @xmath132separating _ ( or just _ separating _ if the partition is clear from context ) if each block @xmath135 of boundary components lies entirely on one side or the other of @xmath140 .",
    "we say that a boundary component @xmath141 is _ separating _ if @xmath142 , and that the partition @xmath132 is _ totally separated _ if each boundary component is separating . if @xmath132 consists of a single block ( and @xmath143 ) , we say that @xmath67 is _ nonseparating _ , since in this case no curve on @xmath4 which separates any boundary components can be @xmath132separating .",
    "* inclusions of partitioned surfaces . *",
    "if @xmath4 is a subsurface of a surface @xmath66 , we say that a path lies _",
    "outside @xmath4 _ if it is contained in the complement @xmath144 .",
    "if @xmath66 is a closed surface , @xmath4 inherits a partition of its boundary components from @xmath66 by defining two components of @xmath5 to be connected outside @xmath67 if they can be connected by a path outside @xmath4 .",
    "more generally , if @xmath4 is a subsurface of a partitioned surface @xmath145 , the subsurface @xmath4 inherits the structure of a partitioned surface @xmath134 as follows .",
    "the partition @xmath132 is defined by saying that two components @xmath146 are connnected outside @xmath67 ( lie in the same block @xmath135 ) if either there is a path outside @xmath4 from @xmath147 to @xmath148 , or there exist components @xmath149 with paths outside @xmath4 from @xmath150 to @xmath151 and such that @xmath152 and @xmath153 are connected outside @xmath154 ( they lie in the same block @xmath155 ) . for the basepoint @xmath137 we choose any point in @xmath5 that can be connected to @xmath156 by a path outside @xmath4 .",
    "although the basepoint is not uniquely defined , the block @xmath136 containing it is , and for most purposes this is all that is relevant .      in this section ,",
    "we define the homology of a partitioned surface @xmath67 , which we denote by @xmath73 ; this originally appeared in putman @xcite using a different but equivalent definition .    * the totally separated surface @xmath157 .",
    "*   given a partitioned surface @xmath67 , we construct a totally separated surface @xmath158 with a canonical embedding @xmath159 .",
    "for each block @xmath135 with @xmath160 , we take a surface @xmath161 of genus 0 with @xmath162 boundary components , and glue all but one of these to the @xmath163 boundary components in @xmath164 .",
    "( notice that when @xmath165 this operation is effectively trivial . )",
    "the resulting surface @xmath166 has @xmath167 ; we take the partition @xmath168 to be the totally separated partition consisting of singleton blocks . for the basepoint @xmath169",
    "we choose any point so that @xmath137 and @xmath170 lie in the same component of @xmath171 .",
    "the role of the surface @xmath157 is captured by the property that those components of @xmath4 that are connected outside @xmath67 are exactly those that are connected outside @xmath4 in @xmath166 .",
    "an important consequence is that a curve @xmath140 in @xmath4 is @xmath132separating if and only if @xmath140 is a separating curve in @xmath166 .",
    "the embedding @xmath172 is universal , in that any embedding @xmath173 with @xmath154 totally separated factors through @xmath172 . as a consequence of this universal property , we see that this construction is idempotent : @xmath174 .",
    "* the homology @xmath73 of a partitioned surface . *   the inclusion of @xmath175 into @xmath166 gives a map from @xmath176 to @xmath177 .",
    "( all homology groups in this paper are taken with integral coefficients , except in remark  [ rem : rationalhomology ] where we explicitly specify otherwise . )",
    "we define @xmath73 to be the cokernel of this map : @xmath178 a separating curve in @xmath166 is homologous to a collection of boundary components , and thus vanishes in @xmath73 .",
    "applying our characterization of @xmath132separating curves above , we conclude that a curve @xmath140 in @xmath4 is @xmath132separating if and only if @xmath179=0\\in { h({\\sigma})}$ ] .",
    "the observation above that @xmath174 implies tautologically that @xmath180 .    * the torelli group @xmath68 . *",
    "the mapping class group @xmath3 of @xmath4 is the group of self - homeomorphisms of @xmath4 fixing @xmath5 pointwise , up to isotopy fixing @xmath5 pointwise .",
    "( we remark that throughout this paper , dehn twists are twists to the _",
    "right_. ) given any inclusion @xmath181 of surfaces , a homeomorphism @xmath182 can be extended by the identity on the complement @xmath138 to obtain @xmath183 .",
    "in particular , for any partitioned surface @xmath134 , the natural inclusion @xmath159 induces an embedding @xmath184 .",
    "since @xmath185 naturally acts on @xmath73 , composing with this embedding we obtain an action of @xmath3 on @xmath73 .",
    "we define the _ torelli group _ of @xmath67 as @xmath186 we obtain an exact sequence @xmath187 but the latter map is not in general surjective .",
    "( it is possible to show that the image is precisely the symplectic automorphisms preserving the homology classes of all boundary components of @xmath5 , but we will not need this here . for details , see the earlier version of this paper posted at arxiv:1108.4511v1 . )    * an alternate definition of @xmath73 . *   for future reference",
    ", we give another definition of @xmath73 .",
    "given a partitioned surface @xmath67 , we define @xmath188 to be the a surface with one boundary component obtained by gluing a disk to each boundary component of @xmath157 except the component containing the basepoint .",
    "( equivalently , @xmath188 is obtained from @xmath4 by gluing an @xmath189 to the boundary components in the block @xmath190 and an @xmath191 to each other block @xmath135 in @xmath5 . ) the mayer ",
    "vietoris sequence implies that @xmath192 , so the action of @xmath3 on @xmath73 factors through the action of @xmath193 on @xmath194 .",
    "since @xmath188 has only one boundary component , the intersection form on @xmath194 is a @xmath193invariant symplectic form . in particular",
    ", this implies that @xmath73 is self - dual as a @xmath3module .",
    "putman defines a category whose objects are partitioned surfaces and whose morphisms are inclusions of subsurfaces respecting the partitions . for our purposes , we will need the following refinement of this category .    given two partitioned surfaces @xmath195 and @xmath196 and an inclusion @xmath197 of their underlying surfaces , we say that :    * @xmath198 _ respects the partitions _ if @xmath199separating and @xmath199nonseparating curves are taken to @xmath200separating and @xmath200nonseparating curves respectively ; and * @xmath198 _ preserves basepoints _ if @xmath201 and @xmath202 lie in the same component of @xmath203 .    as we described in section  [ section : partitionedsurfaces ] , for any inclusion @xmath197 the subsurface @xmath204 inherits the structure of a partitioned surface from @xmath205 .",
    "an inclusion satisfies these two properties  that is , it both respects the partitions and preserves basepoints  exactly when the inherited structure on @xmath204 is @xmath206 .    * the torelli category . *   the category @xmath207 is defined as follows .",
    "its objects are partitioned surfaces @xmath134 . a morphism @xmath208 from @xmath195 to @xmath196",
    "is an inclusion @xmath197 of the underlying surfaces that respects the partitions and preserves basepoints , together with an inclusion @xmath209 extending @xmath198 .",
    "( if we liked , we could identify morphisms in @xmath207 when the underlying inclusions are isotopic ; for simplicity we elect not to do this , but everything in this paper would descend nicely to this quotient category . )",
    "the canonical inclusion @xmath210 induces a morphism @xmath211 for any @xmath67 .",
    "for any morphism @xmath212 , the inclusion @xmath213 induces a map @xmath214 .",
    "the fact that @xmath215 respects the partitions implies that this descends to a map @xmath216 .",
    "if @xmath205 is a partitioned surface , any inclusion @xmath217 gives the subsurface the structure of a partitioned surface @xmath206 .",
    "this inclusion always extends to a morphism @xmath218 , but not canonically ; the ambiguity is in the choice of the map @xmath219 , or equivalently in the choice of the inclusion @xmath220 .    given a morphism @xmath212 , extension by the identity induces a map @xmath221 , which restricts to a map @xmath222 .",
    "putman showed in @xcite that the torelli group can be regarded as a functor @xmath223 from @xmath207 to the category of groups and homomorphisms .",
    "our category @xmath207 is actually a refinement of the category considered by putman ; one key benefit of this refinement is that the assignment @xmath224 becomes functorial .",
    "moreover , this lets us interpret the johnson homomorphism as a natural transformation , as we will show in theorem  [ thm : naturaltransformation ] .",
    "* non - collapsing inclusions and simple cappings . *   when dealing with an inclusion of partitioned surfaces , it is especially convenient if the inclusion does not `` close off '' any block @xmath135 .",
    "formally , we make the following definition .",
    "a morphism @xmath212 is _ non - collapsing _",
    "if for each component @xmath225 of @xmath226 we have @xmath227 .",
    "in other words , every boundary component in @xmath228 can be connected to @xmath229 by an arc lying outside @xmath204 .",
    "one convenient property of such inclusions is that if @xmath215 is non - collapsing , the map @xmath230 is injective ( see section  [ section : johnsonfiltpreserved ] ) .",
    "of course , not every morphism of partitioned surfaces is non - collapsing ; the most basic examples of this are a class of morphisms that we will call `` simple cappings '' .    a morphism @xmath212 is a _ simple capping _ if @xmath231 is a single disk .",
    "any inclusion can be factored as the composition of a single non - collapsing inclusion with a sequence of simple cappings , so we can often reduce to considering these special cases separately . note that since a simple capping respects the partitions , the boundary component which is capped off must be separating .",
    "when a subsurface @xmath4 is embedded in a surface @xmath232 with one boundary component , restricting the lower central series of @xmath233 to @xmath45 yields a central filtration of @xmath45 . in this section we show that this filtration of @xmath45 depends only on which boundary components of @xmath4 become homologous in @xmath232 ; that is , it can be intrinsically defined in terms of the partitioned surface @xmath234 .",
    "one key consequence is that we can define the johnson filtration for a partitioned surface , which we will show in section  [ sec : johnsonfiltration ] using the results of this section .",
    "the main technical idea of this section is that if the associated graded lie algebra of a central filtration on a group happens to be a free lie algebra , then to describe the filtration it suffices to find a free basis .",
    "moreover , if a purported basis is known to generate the lie algebra , we can verify that it is a free basis by mapping to a lie algebra already known to be free .",
    "* the lower central series .",
    "*   given any group @xmath13 , its lower central series is defined by @xmath235 and @xmath236 $ ] .",
    "if we define @xmath237 , the fact that @xmath238\\subset \\gamma_{i+j}$ ] implies that the commutator bracket on @xmath239 descends to a bilinear map @xmath240 .",
    "this makes the associated graded algebra @xmath241 into a graded lie algebra .",
    "( all lie algebras are over @xmath242 unless otherwise specified . by a graded lie algebra ,",
    "we simply mean a lie algebra endowed with a grading respected by the bracket ; that is , we do not introduce any signs coming from the grading . )",
    "it is well - known that if @xmath13 is a free group with basis @xmath243 , then @xmath244 is the free lie algebra on the same generating set ( witt  @xcite ) .",
    "* the central series @xmath245 . *   given a partitioned surface @xmath134 , let @xmath246 .",
    "we define the normal subgroup @xmath247 to be the kernel of the composition @xmath248 .",
    "we define the central series @xmath249 by @xmath250,[\\gamma_2^t,\\gamma_{j-2}^t]\\rangle\\text {    for } j\\geq 3.\\ ] ] this is the minimal filtration satisfying @xmath251 and @xmath252\\subset \\gamma_{i+j}^t$ ] .    * explicit generators for @xmath247 .",
    "*   it will be very useful to have explicit generators for @xmath253 ) .",
    "let @xmath254 .",
    "for each block @xmath255 , choose a @xmath132separating curve @xmath256 in @xmath4 so that the boundary components lying on one side of @xmath256 are exactly those lying in the block @xmath257 , and choose @xmath258 representing @xmath256 .",
    "there are of course many such curves @xmath256 , and many representatives @xmath259 , but the following lemma tells us that any choice of such elements @xmath259 provides generators for @xmath247 .",
    "[ lem : tsgen ] the normal subgroup @xmath247 is generated by @xmath260 $ ] together with the elements @xmath261 .    by definition , @xmath73 is the quotient of @xmath177 by @xmath262 .",
    "each component of @xmath166 is a genus 0 homology between the @xmath198th component of @xmath263 and the @xmath264 components of @xmath5 lying in the block @xmath255 .",
    "let @xmath265 , and let @xmath266 be the homology classes in @xmath42 of the boundary components in @xmath257 ( for @xmath267 ) .",
    "the mayer ",
    "vietoris sequence implies that the image of @xmath42 in @xmath73 is the quotient of @xmath42 by the elements @xmath268 for each @xmath198 .",
    "but our assumption on @xmath256 guarantees that @xmath269=a_i^0+a_i^1+\\cdots+a_i^{m_i}\\in h_1(s)$ ] .",
    "it follows that the kernel of the map @xmath270 is generated by the homology classes @xmath269 $ ] for @xmath271 .",
    "moreover , the fundamental class of the surface @xmath4 itself gives the relation @xmath272 , which can be rewritten as @xmath273+[\\gamma_1]+\\cdots+[\\gamma_k]=0 $ ] .",
    "thus @xmath274 is in fact generated by @xmath269 $ ] for @xmath275 .",
    "it follows that the kernel of the composition @xmath276 is generated by @xmath260 $ ] together with elements @xmath259 representing @xmath256 for @xmath275 .",
    "[ rem : tsoneboundary ] note that if @xmath4 is a surface with one boundary component , with @xmath277 the associated ( trivial ) partitioned surface , we have @xmath278 and so @xmath279 .",
    "it follows that the kernel @xmath247 of the map @xmath280 is just the commutator subgroup @xmath260 $ ] , and so in this case the central series @xmath281 is simply the lower central series @xmath282 of the free group @xmath45 .",
    "* the graded lie algebra @xmath283 . *   we set @xmath284 , and denote by @xmath285 the associated graded lie algebra .",
    "the fact that @xmath286,[\\gamma_2^t,\\gamma_{j-2}^t]\\rangle$ ] for @xmath287 implies that @xmath283 is generated by @xmath288 and @xmath289.we begin by constructing a generating set @xmath290 for @xmath283 ; we will eventually prove that @xmath290 is a free basis for @xmath283 .    * the generating set @xmath291 . *",
    "we first construct a `` standard '' generating set for @xmath292 . for @xmath271 , choose a curve @xmath256 cutting off @xmath257 as above , with the additional assumption that the subsurfaces cut off have genus 0 , and that the curves @xmath256 are mututally disjoint .",
    "let @xmath293 be a simple loop representing @xmath256 , oriented so that the genus 0 subsurface @xmath294 cut off by @xmath259 lies on the left side of @xmath259 .",
    "choose simple loops @xmath295 , disjoint from @xmath259 and from each other , so that @xmath296 represents the @xmath297th boundary component in @xmath257 .",
    "the elements @xmath298 form a free basis for @xmath299 , and we may ( uniquely ) reorder these elements so that in @xmath300 we have the relation @xmath301 let @xmath302 denote the remaining component of @xmath303 ; it has the same genus @xmath1 as the original surface @xmath4 .",
    "choose simple loops @xmath304 so that @xmath305 form a free basis for @xmath306 , and so that in @xmath300 we have the relation @xmath307\\cdots[\\xi_{2g-1},\\xi_{2g}]\\zeta_1\\cdots\\zeta_k\\zeta_0=1.\\ ] ] applying van kampen s theorem , we conclude that a basis for the free group @xmath292 is given by the set @xmath308 , excluding only the element @xmath309 .",
    "let @xmath310 and @xmath266 be the images of @xmath311 and @xmath296 in @xmath312 , and let @xmath150 be the image of @xmath259 in @xmath313 .",
    "[ prop : cs ] @xmath283 is generated by @xmath314    since @xmath300 is generated by @xmath315 , the quotient @xmath312 is spanned by @xmath316 together with @xmath317 . from we obtain the relation @xmath318 which lets us eliminate the generator @xmath319 .",
    "lemma  [ lem : tsgen ] shows that @xmath247 is generated by @xmath260 $ ] together with @xmath261 , so @xmath313 is spanned by @xmath320 $ ] together with @xmath321 .",
    "since we observed above that @xmath283 is generated by @xmath288 and @xmath289 , this demonstrates that @xmath283 is generated by @xmath291 .",
    "* inclusions of partitioned surfaces and @xmath283 . *",
    "let @xmath145 be another partitioned surface , and let @xmath322 .",
    "given a morphism @xmath323 , the inclusion @xmath181 induces a map @xmath324 . by concatenating with an arc @xmath325 in @xmath144 connecting @xmath137 to @xmath156",
    ", we obtain a homomorphism @xmath326 .",
    "[ lem : ltcont ] any morphism @xmath323 induces a map @xmath327 of graded lie algebras .    note that if we had chosen a different arc @xmath325 from @xmath137 to @xmath156 , the resulting map @xmath328 would differ from @xmath329 by conjugation in @xmath330 . since @xmath331 is a central filtration , this shows that the map @xmath332 does not depend on the arc @xmath325 .    as we noted in section",
    "[ sec : torellicategory ] , any morphism @xmath323 induces a diagram : @xmath333\\ar_{i_*}[d ] & h_1(s)\\ar[r]\\ar_{i_*}[d ] & h_1({\\widehat{s}})\\ar[r]\\ar^{{\\widehat{i}}_*}[d]&{h({\\sigma})}\\ar^{\\iota_*}[d]\\\\   \\pi_1(s',\\ast')\\ar[r ] & h_1(s')\\ar[r ] & h_1({\\widehat{s}}')\\ar[r ] & h({\\sigma } ' )   } \\ ] ] by induction , it follows that @xmath334 for all @xmath335 , so @xmath329 induces a map @xmath336 of graded lie algebras .",
    "* injectivity of @xmath336 . *",
    "the map @xmath327 is not always injective ; for example , if @xmath215 is a simple capping , @xmath337 is nullhomotopic , so we will have @xmath338 .",
    "however , this is essentially the only way that injectivity can fail .",
    "[ thm : ltfree ] @xmath283 is the free lie algebra on the generating set @xmath290 defined in proposition  [ prop : cs ] .",
    "furthermore any morphism @xmath173 such that no component of @xmath339 is a disk induces an injection @xmath340 .",
    "we will show that @xmath283 is free on the claimed basis in the course of proving that @xmath336 .",
    "so consider a morphism @xmath173 such that no component of @xmath138 is a disk .",
    "we begin by reducing to the case when @xmath66 has only one boundary component .",
    "given such a morphism @xmath173 , let @xmath341 be obtained from @xmath342 by attaching a surface @xmath343 to each component of @xmath342 except the one containing the basepoint .",
    "this certainly has only one boundary component , so it remains to check that no component of @xmath344 is a disk .",
    "each component of @xmath345 has genus 1 , so any such disk must be contained in @xmath342 .",
    "each component of @xmath346 has at least two boundary components by definition , so any disk must be contained in @xmath66 .",
    "this shows that as long as no component of @xmath138 was a disk , no component of @xmath344 is a disk .",
    "and of course , if we can prove that the composition @xmath347 is injective , then the first map @xmath336 is necessarily injective as well .",
    "+ assume that @xmath66 is a surface with one boundary component , which we may consider as a ( trivial ) partitioned surface @xmath348 .",
    "as we noted in remark  [ rem : tsoneboundary ] , @xmath349 is the free lie algebra @xmath350 . recall that a subset @xmath351 of a lie algebra is called _ independent _ if the subalgebra generated by @xmath351 is free with basis @xmath351 .",
    "given a morphism @xmath323 so that no component of @xmath138 is a disk , we will prove that @xmath352 takes the generating set @xmath291 to an independent subset of @xmath350 . by the universal property",
    ", this implies that @xmath353 is an isomorphism of @xmath283 onto its image @xmath354 .",
    "this will simultaneously show that @xmath353 is injective , and that @xmath291 is a free basis for @xmath283 . + as in the definition of @xmath291 , for @xmath271 we set @xmath265 .",
    "let @xmath308 ( excluding @xmath355 ) be the basis for @xmath300 constructed there .",
    "as before , choose disjoint simple closed curves @xmath356 cobounding a genus 0 surface with the boundary components lying in @xmath257 .",
    "let @xmath357 be a simple closed curve in the complement @xmath138 that similarly cobounds a genus 0 surface with the components lying in @xmath257 .",
    "together , @xmath256 and @xmath357 cobound a surface of genus @xmath358 ; let @xmath359 be the genus of the subsurface on the other side of @xmath357 .",
    "extend the generators @xmath360 to a basis for @xmath361 of the form @xmath362 by choosing this basis appropriately , we can ensure that @xmath363\\cdots[\\psi_i^{2g_i-1},\\psi_i^{2g_i}]\\ ] ] represents @xmath357 , and that we have the relation @xmath364 where @xmath365 denotes the inverse @xmath366 .",
    "let @xmath310 , @xmath266 , @xmath367 , and @xmath368 denote the image in @xmath369 of @xmath311 , @xmath296 , @xmath370 , and @xmath371 respectively ; @xmath369 is the free lie algebra on the generating set @xmath372 . for any @xmath310 , and for any @xmath266 with @xmath373",
    ", we have @xmath374 and @xmath375 , but for @xmath150 the formula is not so simple . however , comparing the expression for @xmath259 with the expression for @xmath376 , we see that @xmath377 can be expressed as @xmath378=[a_i^1,b_i^1]+[a_i^2,b_i^1+b_i^2]+\\cdots+    [ a_i^{m_i},b_i^1+\\cdots+b_i^{m_i}].\\ ] ] combining this with , we obtain @xmath379+[a_i^2,b_i^1+b_i^2]+\\cdots+    [ a_i^{m_i},b_i^1+\\cdots+b_i^{m_i}]\\ \\ + \\ \\ [ y_i^1,y_i^2]+\\cdots+[y_i^{2g_i-1},y_i^{2g_i}].\\ ] ]    let @xmath380 denote the subset @xmath381 of @xmath350 .",
    "we seek to show that @xmath380 is independent , meaning that @xmath380 is a free basis for the lie subalgebra it generates ( namely @xmath382 itself ) .",
    "note that by shirshov  @xcite and witt  @xcite , any subalgebra of the free lie algebra @xmath350 is itself free on _ some _ basis ( at least after tensoring with @xmath383 ) .",
    "let @xmath384 , and identify each @xmath385 with its image in @xmath386 ; since @xmath350 is torsion free ( witt  ( * ? ? ?",
    "* theorem 4 ) ) , the map @xmath387 is an injection .",
    "the following theorem is proved by shirshov in the course of proving ( * ? ? ?",
    "* theorem 2 ) : if for each @xmath385 we have that the leading term of @xmath388 is not in the subalgebra of @xmath386 generated by the leading terms of @xmath389 , then @xmath380 is independent as a subset of @xmath386 .",
    "( the leading term of @xmath390 is the highest degree homogeneous component of @xmath390 . for an exposition in english of a closely related theorem ,",
    "see bryant ",
    "sthr  @xcite . )",
    "since all our elements @xmath385 are homogeneous , we must show that @xmath390 is not in the subalgebra of @xmath386 generated by @xmath391 .    for @xmath392 and @xmath393 ,",
    "this is easy .",
    "given any subset @xmath394 of the generating set @xmath395 , the elimination theorem for free lie algebras implies that as a vector space , @xmath386 splits as the direct sum of the algebra generated by @xmath396 with the ideal generated by @xmath397 ( see e.g.  bourbaki ( * ? ? ?",
    "* chapter ii , section 2.9 , proposition 10 ) ) .",
    "since no other element of @xmath380 involves the degree 1 generators @xmath310 or @xmath266 , this implies that in this case @xmath390 is not even contained in the _ ideal _ generated by @xmath391 .    for @xmath398",
    ", we argue as follows .",
    "it can not be that both @xmath399 and @xmath400 : if @xmath399 we have @xmath401 , in which case the genus @xmath359 must be at least 1 ( otherwise the corresponding component of @xmath138 would be a disk ) .",
    "thus at least one of the generators @xmath402 or @xmath403 appears in the expansion of @xmath377 .",
    "since these generators appear in no other elements of @xmath380 , the elimination theorem again implies that @xmath398 is not contained in the subalgebra of @xmath386 generated by @xmath389 .",
    "shirshov s result thus shows that @xmath380 is independent in @xmath386 ; since @xmath350 is torsion - free , it follows that @xmath380 is independent in @xmath350 .",
    "this completes the proof that @xmath352 is injective , and that @xmath283 is a free lie algebra with basis @xmath291 .",
    "[ rem : biggerindep ] for future reference , we note that the independent set @xmath404 from theorem  [ thm : ltfree ] can be extended slightly , by the same proof as above .",
    "these observations will be used in the proof of theorem  [ thm : preserved ] .",
    "first , if @xmath405 , then @xmath406 is independent . since @xmath407 has degree 1 , it is certainly not contained in @xmath404 .",
    "the only generator in @xmath404 involving @xmath407 is @xmath408 , so there is nothing additional to verify except for this generator .",
    "but since @xmath408 remains the only generator involving @xmath409 , we see that @xmath408 is still not contained in the subalgebra generated by @xmath410 . by shirshov s theorem",
    "this implies that @xmath406 is independent .",
    "second , if @xmath411 , or if @xmath412 and @xmath413 , then @xmath414 is independent .",
    "again , the only generator involving @xmath415 is @xmath408 .",
    "if @xmath411 , then @xmath408 is the only generator involving @xmath416 ; if @xmath413 , then @xmath408 is the only generator involving @xmath407 . in either case , @xmath408",
    "is not contained in the subalgebra generated by @xmath417 , and thus @xmath414 is independent .    *",
    "the filtrations @xmath418 are preserved by inclusions .",
    "*   given any morphism @xmath173 , we can restrict the filtration @xmath419 from @xmath361 to @xmath45 .",
    "the content of theorem  [ thm : ltfree ] is that as long as no component of @xmath138 is a disk , the induced filtration is precisely @xmath331 itself .",
    "[ cor : tpreimage ] for any morphism @xmath420 so that no component of @xmath138 is a disk , @xmath421 ; in other words , @xmath422 .",
    "lemma  [ lem : ltcont ] states that @xmath423 for all @xmath297 . by theorem  [ thm : ltfree ]",
    ", @xmath353 is injective on each @xmath424 , which implies that @xmath425 for all @xmath297 .",
    "in particular , this corollary implies that we could have defined @xmath331 by embedding @xmath67 into an arbitrary surface @xmath66 with one boundary component , and restricting the lower central series @xmath426 to @xmath45 .",
    "however , without theorem  [ thm : ltfree ] there would be no reason to think that this definition would be well - defined ( independent of the choice of embedding @xmath427 ) .",
    "* totally separated partitioned surfaces . *   when @xmath67 is a totally separated partitioned surface , the generating set @xmath291 consists just of @xmath428 in degree 1 and @xmath429 in degree 2 .",
    "we will need the following proposition in section  [ sec : restrict ] when we bound the image of the johnson homomorphism .",
    "note that for a totally separated surface , @xmath288 coincides with @xmath73 ; anticipating the notation of section  [ sec : generaldef ] , we write @xmath430 for @xmath313 .    [ prop : tbracket ] if @xmath67 is totally separated , the commutator bracket @xmath431 induces the short exact sequence @xmath432    the kernel is simply the jacobi identity between elements of @xmath433 .",
    "formally , the embedding @xmath434 is defined by sending @xmath435 to @xmath436+y\\otimes [ z , x]+z\\otimes [ x , y]\\in { \\mathcal{l}}_1^t({\\sigma})\\otimes { \\mathcal{l}}_2^t({\\sigma})$ ] ; the jacobi identity asserts precisely that elements of this form are annihilated by the lie bracket .",
    "proposition  [ prop : tbracket ] is not just a corollary of theorem  [ thm : ltfree ] , but actually a special case of the theorem : the proposition states that there are no nontrivial relations among the basis elements @xmath437 in degree 3 , while theorem  [ thm : ltfree ] states that there are no nontrivial relations among them at all .",
    "* @xmath68 acts trivially on @xmath283 . *   theorem  [ thm : ltfree ] has another important consequence , which we will use in sections  [ sec : johnsonfiltration ] and [ sec : generaldef ] .",
    "[ cor : torlttrivial ] for any partitioned surface @xmath67 , the mapping class group @xmath3 preserves the filtration @xmath245 on @xmath8 .",
    "moreover , the action of @xmath3 on @xmath283 factors through its action on @xmath73 ; in particular , @xmath68 acts trivially on @xmath283 .    as in the proof of theorem  [ thm : ltfree ] , given any partitioned surface @xmath67 we may construct an inclusion @xmath173 so that @xmath154 has a single boundary component and every component of @xmath438 has genus at least 1 .",
    "for such an inclusion the map @xmath439 is injective ( see paris ",
    "rolfsen  ( * ? ? ?",
    "* corollary 4.2(iii ) ) ) .",
    "the lower central series of @xmath361 is preserved by @xmath64 , and the subgroup @xmath45 is preserved by the subgroup @xmath3 .",
    "we conclude that the intersection @xmath440 is preserved by @xmath3 .    for the second claim ,",
    "first assume that @xmath67 is totally separated , so that @xmath259 represents a boundary component of @xmath4 . since @xmath3 fixes the boundary components of @xmath4 , it fixes @xmath259 up to conjugacy , and thus acts trivially on @xmath441 .",
    "proposition  [ prop : cs ] shows that @xmath288 and @xmath321 generate @xmath283 , and so we conclude that the action of @xmath3 on @xmath283 factors through its action on @xmath442 . in particular",
    ", since @xmath68 acts trivially on @xmath433 by definition , we see that @xmath68 acts trivially on all of @xmath283 .",
    "if @xmath67 is not totally separated , theorem  [ thm : ltfree ] gives us a @xmath3equivariant embedding of @xmath283 into @xmath443 .",
    "thus the action of @xmath3 on @xmath283 factors through its action on @xmath180 , as desired .",
    "let @xmath67 be a partitioned surface , and let @xmath292 as before . by corollary  [ cor : torlttrivial ]",
    ", the action of @xmath3 on @xmath300 preserves the central series @xmath444 defined in section  [ sec : chart ] .",
    "we will use the action of @xmath3 on this central series to define the _ partitioned johnson filtration _",
    "@xmath445 the classical johnson filtration for a surface with one boundary component consists of those homeomorphisms acting trivially modulo @xmath21 , but for partitioned surfaces we need to impose another condition .      * action on arcs . *",
    "if @xmath325 is an arc in @xmath4 from the basepoint @xmath446 to another point @xmath447 lying in @xmath5 , and @xmath448 is an element of @xmath3 , we define the element @xmath449 as follows .",
    "we denote by @xmath450 the same arc parametrized in reverse , from @xmath447 to @xmath137 . for any @xmath451 ,",
    "the image @xmath452 is another arc with the same endpoints as @xmath325 , so we can consider @xmath453 as a loop based at @xmath137 .",
    "we define @xmath454 to be the resulting element of the fundamental group .    for the following definition",
    ", we enumerate the boundary components of @xmath4 , and choose arcs @xmath455 beginning at @xmath137 and ending on the @xmath198th component of @xmath5 .",
    "[ def : johnsonfiltration ] for @xmath456 , let @xmath74 be the subgroup of @xmath3 consisting of those @xmath182 satisfying the three following conditions :    a.   @xmath448 acts trivially on @xmath8 modulo @xmath457 . b.   for each arc @xmath455 , the element @xmath458 is contained in @xmath459 .",
    "c.   if @xmath455 and @xmath460 end at two components lying in the same block @xmath135 , + then @xmath461 modulo @xmath462 .    conditions ( ii ) and ( iii ) do not appear in the definition of the classical johnson filtration @xmath463 ( consisting of elements @xmath464 acting trivially on @xmath465 , and the reader might wonder if they can be removed .",
    "however , if we hope to restrict the johnson filtration to subsurfaces @xmath4 with multiple boundary components , such a condition on arcs is unavoidable .",
    "we can see this just from considering dehn twists , as follows .",
    "consider a subsurface @xmath466 with multiple boundary components , let @xmath140 be a boundary component in @xmath5 _ not _ containing the basepoint @xmath137 , and consider the dehn twist @xmath467 .",
    "we know that no dehn twist around any curve ever lies in @xmath468 .",
    "but @xmath467 acts trivially on @xmath8 , so we can not exclude it based solely on its action on @xmath8 . condition ( ii ) is what guarantees that dehn twists behave as we expect : for nonseparating curves we will have @xmath469 , and for separating curves we will have @xmath470 but @xmath471 .    before moving on ,",
    "let us establish that definition  [ def : johnsonfiltration ] is well - defined , meaning that it does not depend on the choice of the arcs @xmath455 .",
    "so let @xmath325 and @xmath472 be two arcs with the same endpoints in @xmath5 , and assume that @xmath448 acts trivially on @xmath300 modulo @xmath462 and that @xmath473 .",
    "we can compute @xmath474 as @xmath475={\\varphi}(x)x^{-1}[x , d_a({\\varphi})]\\ ] ] where @xmath476 . since @xmath448 acts trivially",
    "modulo @xmath457 , the first term @xmath477 lies in @xmath457 . by assumption @xmath478 , so @xmath479\\in \\gamma_k^t({\\sigma})$ ]",
    "this shows that @xmath480 and @xmath481 agree modulo @xmath482 ; in particular , if one lies within @xmath459 , the other does .",
    "similarly , if @xmath483 modulo @xmath457 , then @xmath484 modulo @xmath457 as well .",
    "* fundamental computation . *   one motivation for defining @xmath480 is the following fundamental computation , which we will use repeatedly throughout the paper .",
    "let @xmath485 , where @xmath486 is some loop fixed by @xmath448 .",
    "( for example , if @xmath4 is contained in a larger surface @xmath66 , we might choose @xmath486 contained in @xmath138 . )",
    "then we have @xmath487.\\ ] ]    [ rem : classicalagrees ] if @xmath488 is an arc from @xmath137 to itself that is nullhomotopic , the same is true of @xmath489 , so @xmath490 is trivial for any @xmath182",
    ". thus condition ( iii ) implies that for any arc @xmath325 from @xmath137 to a point in @xmath190 ( the block containing the basepoint ) , @xmath491 .",
    "furthermore , when @xmath4 has only a single boundary component , the only arc is @xmath488 , so conditions ( ii ) and ( iii ) are vacuous . by remark  [ rem : tsoneboundary ] , in this case @xmath245 is just the lower central series @xmath492 .",
    "thus for surfaces with one boundary component , the partitioned johnson filtration @xmath74 coincides with the classical johnson filtration @xmath6 .",
    "* refining the partition . *",
    "if @xmath134 and @xmath493 are two partitioned surfaces coming from two different partitions on the same surface , we can compare the resulting filtrations @xmath494 and @xmath495 on the mapping class group @xmath3 .",
    "we have the following comparison result .",
    "say that @xmath496 is _ finer than _",
    "@xmath132 if every block @xmath155 is contained in a single block @xmath135 ( but a single block of @xmath132 may split into multiple blocks of @xmath496 ) .",
    "this encodes the notion that the partition @xmath496 is `` more separated '' than @xmath132 ; for example , the totally separated partition is finer than any other partition .    [",
    "prop : refinement ] given @xmath134 and @xmath493 , if @xmath496 is finer than @xmath132 , then for any @xmath456 we have @xmath497 .",
    "given a boundary component @xmath498 , let @xmath499 be the associated element of @xmath42 .",
    "we noted in the proof of lemma  [ lem : tsgen ] that the kernel of the map @xmath500 is spanned by the elements @xmath501 for each block @xmath135 . since @xmath496 is finer than @xmath132 , each block @xmath135 is the disjoint union @xmath502 of blocks @xmath503 .",
    "thus we can regroup this sum as @xmath504 .",
    "each of the latter terms vanishes in @xmath505 , so we conclude that @xmath506 is contained in @xmath507 .",
    "it follows that @xmath508 is contained in @xmath509 , and thus by induction that @xmath510 for all @xmath335 .",
    "now if @xmath477 ( or @xmath480 , or @xmath511 , respectively ) lies in @xmath457 , it also lies in @xmath512 .",
    "it follows that @xmath513 , as desired .",
    "* the first terms of the johnson filtration . *   by definition , @xmath514 , and @xmath515 is the torelli group @xmath68 defined in section  [ sec : torelli ] .",
    "( this follows from theorem  [ thm : preserved ] , but it is not difficult to verify directly . ) we denote the next term @xmath89 by @xmath111 and call it the _ johnson kernel of @xmath67_. in section  [ sec : jh ] we will define the _ partitioned johnson homomorphism _ @xmath83 , and prove in theorem  [ thm : deltas ] that @xmath516 .",
    "in particular , we will see that when @xmath67 is totally separated , @xmath111 is exactly the subgroup of @xmath3 acting trivially on @xmath45 modulo @xmath517 ; conditions ( ii ) and ( iii ) in definition  [ def : johnsonfiltration ] are not necessary in this case .    * changing the basepoint .",
    "*   the filtration @xmath74 is defined in terms of the partitioned surface @xmath134 , and it is easy to see that this filtration does depend on the partition @xmath132 ( we will see many examples in section  [ sec : jh ] ) .",
    "however , we have the convenient property that the filtration @xmath74 does _ not _ depend on the basepoint @xmath137 .",
    "[ thm : basepointirrelevant ] the johnson filtration does not depend on the basepoint ; that is , if @xmath67 and @xmath154 differ only in the location of the basepoint , then @xmath518 .    if @xmath134 , let @xmath519 .",
    "an isomorphism from @xmath292 to @xmath520 is given by @xmath521 , where @xmath325 is an arc from @xmath137 to @xmath156 .",
    "we saw in lemma  [ lem : ltcont ] that this isomorphism takes the central series @xmath457 of @xmath300 to the central series @xmath522 of @xmath330 . in this proof only , let @xmath523 denote @xmath524 .",
    "we compute @xmath525    & = [ { \\varphi}(a^{-1})a , a^{-1}{\\varphi}(x)a]a^{-1}{\\varphi}(x)x^{-1}a\\\\[4pt ] & = [ \\overline{d_a({\\varphi})^{-1}},\\overline{{\\varphi}(x)}]\\overline{{\\varphi}(x)x^{-1}}=\\overline{[d_a({\\varphi})^{-1},{\\varphi}(x)]{\\varphi}(x)x^{-1 } } \\end{array}\\ ] ] if @xmath526 we know that @xmath527 , and that @xmath478 , so @xmath528\\in \\gamma_k^t({\\sigma})$ ] as well .",
    "this shows that @xmath448 acts trivially on @xmath330 modulo @xmath522 , verifying condition ( i ) of definition  [ def : johnsonfiltration ] . for conditions ( ii ) and ( iii ) , note that for the arc @xmath529 from @xmath156 to the @xmath297th boundary component we may take @xmath530 .",
    "we compute @xmath531 as : @xmath532 since @xmath480 and @xmath533 lie in @xmath459 , we conclude that @xmath534 lies in @xmath535 , verifying condition ( ii ) .",
    "finally , if @xmath455 and @xmath460 end in the same block @xmath536 , we have @xmath537 modulo @xmath462 . from the computation above",
    ", this implies that @xmath538 modulo @xmath539 .      in this section",
    "we prove the fundamental result that the johnson filtration is sharply preserved by inclusions , meaning that ( with a small list of exceptions ) any inclusion @xmath323 satisfies @xmath540 this implies that the restriction of the johnson filtration to a subsurface @xmath4 depends _ only _ on which boundary components of @xmath4 become homologous in the larger surface .",
    "of course , the property can never hold if the map @xmath439 is not injective .",
    "fortunately this happens only rarely : by paris ",
    "rolfsen  ( * ? ? ?",
    "* corollary 4.2(iii ) ) , the map @xmath439 induced by an inclusion @xmath541 is an injection if and only if no component of @xmath138 is a disk or annulus with boundary contained in @xmath5 .",
    "[ thm : preserved ] for any inclusion @xmath323 we have @xmath542 for all @xmath456 .",
    "moreover as long as no component of @xmath138 is a disk or annulus with boundary contained in @xmath5 , we have @xmath543 ; in other words , @xmath544 .    given @xmath182 ,",
    "let @xmath545 denote its image in @xmath64 .",
    "we first assume that @xmath546 and seek to show that @xmath547 .",
    "we begin with conditions ( ii ) and ( iii ) .",
    "let @xmath14 be a fixed arc in @xmath138 from @xmath156 to @xmath137 .",
    "for this proof only , given @xmath548 or @xmath549 , let @xmath550 denote @xmath551 .",
    "we verified in lemma  [ lem : ltcont ] that the map @xmath552 defined by @xmath553 takes the filtration @xmath331 faithfully to the filtration @xmath554 .",
    "we can always choose an arc @xmath555 from @xmath156 to the @xmath198th component of @xmath556 with initial segment @xmath14 , so that @xmath557 where @xmath460 is an arc in @xmath4 and @xmath15 is contained in @xmath138 .",
    "we then have @xmath558 .",
    "thus @xmath559 if and only if @xmath491 , verifying the claim for condition ( ii ) .",
    "now let @xmath557 and @xmath560 be two such arcs ending at components lying in the same block @xmath155 ; we have @xmath561 .",
    "since the inclusion @xmath173 respects the partitions , @xmath325 and @xmath562 necessarily end at components lying in the same block @xmath135 .",
    "condition ( iii ) for @xmath448 guarantees that @xmath563 , so the above formula shows that @xmath564 , as desired .",
    "we now handle condition ( i ) . putting a generic element of @xmath322 in general position with respect",
    "to @xmath4 shows that @xmath330 is generated by loops of the following four forms :    * first , loops @xmath140 contained entirely in @xmath138 ; * second , loops @xmath565 for @xmath548 ; * third , loops @xmath566 for @xmath325 an arc contained in @xmath4 and @xmath486 a loop contained in @xmath138 ; * fourth , loops @xmath567 for @xmath568 arcs contained in @xmath4 and @xmath472 an arc contained in @xmath138 .    our goal is to show that @xmath569 for any such @xmath140 . in the first case",
    "this is trivial , since @xmath570 .",
    "in the second case we have @xmath571 ; since @xmath572 by assumption , this implies @xmath569 . in the third case , just as in we compute : @xmath573}= [ \\overline{d_a({\\varphi})},\\gamma].\\ ] ] by condition ( ii ) we know",
    "@xmath574 , so @xmath575\\in\\gamma^t_k({\\sigma}')$ ] , as desired .",
    "finally , in the fourth case , we compute : @xmath576\\cdot \\gamma \\overline{d_a({\\varphi})d_{a'}({\\varphi})^{-1}}\\gamma^{-1}\\end{aligned}\\ ] ] as before , by condition ( ii ) we know @xmath577 , so the first term lies in @xmath539 .",
    "since @xmath325 and @xmath562 are connected by the arc @xmath472 lying outside @xmath4 , they must end in the same block .",
    "thus by condition ( iii ) we have @xmath578 , so the second term lies in @xmath539 as well , showing that @xmath579 .",
    "this concludes the proof that @xmath547 .",
    "+ now assume that no component of @xmath138 is a disk or annulus .",
    "we assume that @xmath547 and seek to show that @xmath546 . condition ( i ) is easy to check : for any @xmath548 , we seek to show that @xmath580 lies in @xmath457 . by lemma  [ lem : ltcont ] , this is equivalent to showing that @xmath581 .",
    "but as we saw above , @xmath582 , and the assumption that @xmath583 says precisely that @xmath584 lies in @xmath512 .    conditions ( ii ) and ( iii ) require more work .",
    "the difficulty in running the above arguments in reverse is that although will show that @xmath585\\in \\gamma_k^t({\\sigma})$ ] , this does _ not _ imply that @xmath478 . for example we could have @xmath586 , in which case @xmath585=[\\gamma,\\gamma]=1 $ ] .",
    "we will need to show that we can choose loops @xmath587 that are sufficiently `` independent '' from @xmath457 .",
    "consider an arc @xmath325 from @xmath137 to a boundary component of @xmath4 , and let @xmath225 be the component of @xmath138 containing the endpoint of @xmath325 .",
    "we first handle the straightforward case when @xmath588 is not contained in @xmath5 .",
    "let @xmath562 be another arc in @xmath4 beginning at @xmath137 and ending in the same block @xmath139 as @xmath325 , and let @xmath589 be the component of @xmath138 containing the endpoint of @xmath562 .",
    "we may choose an arc @xmath557 from @xmath156 to the boundary @xmath556 as before .",
    "we previously calculated that @xmath590 , so since @xmath559 by assumption , we conclude that @xmath591 , verifying condition ( ii ) .",
    "since the inclusion @xmath173 respects the partitions , we must also have @xmath592 .",
    "thus we may choose an arc @xmath560 from @xmath156 to @xmath556 so that @xmath472 and @xmath593 end in the same block @xmath155 . by assumption @xmath561",
    "lies in @xmath512 .",
    "thus @xmath594 , verifying condition ( iii ) .",
    "next we consider the case when @xmath588 has a single component , which necessarily meets in @xmath5 in a singleton block of @xmath132 .",
    "thus condition ( iii ) is vacuous for this block .",
    "since @xmath225 is not a disk , the genus of @xmath225 must be positive , so we may choose @xmath566 where @xmath486 is a free generator for @xmath595 descending to a generator of @xmath596 . in the notation of remark  [ rem : biggerindep ] , we may take @xmath140 to represent the generator @xmath407 of @xmath349 . as in",
    "we computed above that @xmath575 $ ] , so by assumption we know that @xmath597\\in \\gamma_k^t({\\sigma}')$ ] .",
    "using the fact that @xmath598 , our goal is to show that this implies @xmath577 .",
    "remark  [ rem : biggerindep ] shows that the subalgebra @xmath599 of @xmath349 generated by @xmath354 and @xmath407 is free with basis @xmath406 . by the elimination theorem for free lie algebras (",
    "2.9 , corollary ) , the ideal of @xmath599 generated by @xmath404 is a free lie algebra on the basis of iterated brackets @xmath600]\\big| x\\in \\iota_*({\\mathcal{s}}({\\sigma}))\\big\\}$ ] .",
    "furthermore @xmath599 is the direct sum of this ideal with @xmath601 . in particular",
    ", this implies that @xmath602\\neq 0 $ ] for any @xmath603 satisfying @xmath604 .",
    "let @xmath605 be the largest integer such that @xmath606 , and let @xmath607 denote the image of @xmath608 in @xmath609 ; by definition , @xmath610 .",
    "thus the above remark implies that @xmath611\\neq 0\\in { \\mathcal{l}}^t_{\\ell+1}({\\sigma}')$ ] .",
    "however we know that @xmath597\\in \\gamma^t_k({\\sigma}')$ ] represents @xmath611 $ ] .",
    "we conclude that @xmath612 , and thus that @xmath478 , as desired .",
    "finally , we consider the remaining case : when @xmath588 has multiple components , all contained in @xmath5 .",
    "since @xmath225 is neither a disk nor an annulus , it either has positive genus or at least three boundary components .",
    "choose an arc @xmath562 from @xmath137 to one of the other components of @xmath588 , and let @xmath613 for @xmath472 an arc in @xmath225 . in the notation of remark  [ rem : biggerindep ] , we may assume that @xmath140 represents the generator @xmath415 of @xmath349 .",
    "we computed above that @xmath575\\cdot \\gamma \\overline{d_a({\\varphi})d_{a'}({\\varphi})^{-1}}\\gamma^{-1}$ ] .",
    "choose @xmath605 as before and let @xmath607 denote the image of @xmath608 in @xmath614 ; similarly , let @xmath297 be the largest integer such that @xmath615 modulo @xmath245 , and let @xmath616 denote the image of @xmath617 in @xmath618 .",
    "let @xmath599 be the subalgebra of @xmath349 generated by @xmath354 and @xmath415 , and consider the element @xmath619+s\\in \\mathcal{a}$ ] .",
    "our assumption on @xmath620 implies that either @xmath413 or @xmath411 , so remark  [ rem : biggerindep ] shows that @xmath599 is free with basis @xmath414 .",
    "let @xmath621 denote the ideal of @xmath599 generated by @xmath415 .",
    "the elimination theorem states that @xmath599 is the direct sum of @xmath404 and @xmath621 , and that a basis for @xmath621 as a free lie algebra is in bijection with a basis for the universal enveloping algebra of @xmath283 ( * ? ? ?",
    "2.9 , corollary ) . in particular",
    ", the adjoint action of @xmath354 on @xmath621 factors through its action on its universal enveloping algebra , and thus is faithful . since @xmath622",
    ", this implies that @xmath619\\neq 0\\in i_{\\ell+1}\\subset { \\mathcal{l}}^t_{\\ell+1}({\\sigma}')$ ] .",
    "however , we know that @xmath597\\cdot \\gamma \\overline{d_a({\\varphi})d_{a'}({\\varphi})^{-1}}\\gamma^{-1}\\in \\gamma^t_k({\\sigma}')$ ] , and so we conclude that @xmath619+s\\in { \\mathcal{l}}^t_k({\\sigma}')$ ] . by the splitting of @xmath599 as a direct sum",
    ", this implies that @xmath623 and @xmath619\\in i_k\\subset { \\mathcal{l}}^t_k({\\sigma}')$ ] .",
    "this shows that @xmath612 and @xmath624 , which is to say that @xmath478 and that @xmath594 .",
    "this verifies both conditions ( ii ) and ( iii ) in this final case .      in this section",
    "we give a specific application of the partitioned johnson filtration to stabilizers of multicurves .",
    "theorem  [ thm : bbm ] below was used by bestvina  bux ",
    "margalit in their calculation of the cohomological dimension of @xmath625 , where it was stated as ( * ? ? ?",
    "* lemma  6.16 ) .",
    "let @xmath626 be a surface with one boundary component , and let @xmath627 be the inclusion of a subsurface so that no component of @xmath628 is a disk . fix a single boundary component @xmath15 of @xmath4 , and let @xmath629 be the surface obtained from @xmath4 by capping off all boundary components except for @xmath15 .",
    "let @xmath630 be the natural inclusion of surfaces , and @xmath631 the surjection obtained by extension by the identity .",
    "given an element @xmath632 which stabilizes @xmath4 , we may restrict it to an element @xmath633 , and consider its image @xmath634 .    if any component of @xmath628 is an annulus not containing @xmath635 , the map @xmath636 will not be injective , so @xmath637 is not uniquely defined .",
    "however ( * ? ? ?",
    "* theorem 4.1(iii ) ) states that the kernel of @xmath636 is generated by certain products of dehn twists ( so - called bounding pairs ) around the corresponding boundary components of @xmath4 .",
    "all but one of these boundary components becomes nullhomotopic in @xmath629 , so the corresponding dehn twist vanishes in @xmath638 .",
    "we conclude that the element @xmath639 is well - defined up to a twist @xmath63 around the boundary component @xmath15 .",
    "[ thm : bbm]for any @xmath640 stabilizing @xmath4 , we have @xmath641 .    note that the twist @xmath63 around the boundary component @xmath15 lies in @xmath642 ( see e.g.  proposition  [ prop : st ] ) , so the desired conclusion is well - defined .",
    "( since @xmath643 , it would not be well - defined to ask whether @xmath644 implies @xmath645 when @xmath646 . )",
    "let @xmath156 be a point in @xmath635 , and let @xmath134 be the induced partitioned surface on @xmath4 .",
    "let @xmath647 denote the same surface but with the totally separated partition @xmath199 .",
    "finally , choose a point @xmath648 , and let @xmath649 denote the same partitioned surface but with basepoint @xmath650 .",
    "note that the inclusion @xmath630 defines a morphism @xmath651 of partitioned surfaces .",
    "if no component of @xmath628 is an annulus , the theorem follows from theorem  [ thm : preserved ] as follows .",
    "since @xmath652 lies in @xmath653 , the second part of theorem  [ thm : preserved ] states that @xmath654 .",
    "since the partition @xmath199 is finer than @xmath132 , proposition  [ prop : refinement ] states that @xmath655 for all @xmath22 ; in particular , @xmath656 . by theorem  [ thm : basepointirrelevant ] , @xmath657 for all @xmath22 , so @xmath658",
    ". finally , @xmath651 is a morphism of partitioned surfaces , so the first part of theorem  [ thm : preserved ] implies that @xmath659 . by remark  [ rem :",
    "classicalagrees ] , on a surface with one boundary component such as @xmath629 , the partitioned johnson filtration agrees with the classical johnson filtration , and so @xmath660 is just the classical johnson kernel @xmath642 .",
    "the proof in general follows the same structure , but we can not apply the second part of theorem  [ thm : preserved ] if some component of @xmath628 is an annulus . rather than dealing with @xmath661 itself , we will check by hand that any lift @xmath637 lies in the larger group @xmath662 .",
    "let @xmath14 be a fixed arc in @xmath628 from @xmath156 to @xmath137 , and let @xmath523 denote @xmath663 .",
    "the proof that @xmath637 acts trivially on @xmath8 modulo @xmath517 still works without change , as follows . for any @xmath664 , we know",
    "that @xmath665 lies in @xmath666 , since @xmath667 .",
    "but by corollary  [ cor : tpreimage ] , this implies @xmath668 .",
    "we showed in proposition  [ prop : refinement ] that @xmath669 , so this verifies condition ( i ) in showing that @xmath656 .",
    "since @xmath206 is totally separated , condition ( iii ) is vacuous , so we need only check that @xmath637 satisfies condition ( ii ) .",
    "moreover , for any arc not ending at an annular component of @xmath628 , the proof of theorem  [ thm : preserved ] shows that @xmath670 , and thus that @xmath671 .",
    "choose an annular component of @xmath628 , and let @xmath15 be one of its two components .",
    "let @xmath325 be an arc in @xmath4 from @xmath137 to @xmath15 , and let @xmath672 where @xmath486 is a parametrization of the boundary component @xmath15 . in the notation of theorem  [ thm : ltfree",
    "] , we may assume that @xmath673 represents @xmath674 .",
    "as in we compute @xmath675}$ ] . by assumption @xmath676 , so @xmath677\\in \\gamma_3^t({\\sigma})$ ] . we will show that this implies that @xmath480 is congruent to @xmath678 modulo @xmath679 for some @xmath680 . since @xmath673 lies in @xmath681",
    ", this will show that @xmath671 , as desired .    by theorem  [ thm : ltfree ] , the element @xmath682 is part of a free basis for @xmath283 . thus just as in the proof of theorem",
    "[ thm : preserved ] , applying the elimination theorem to the ideal generated by the other basis elements shows that the kernel of @xmath683\\colon { \\mathcal{l}}^t({\\sigma})\\to { \\mathcal{l}}^t({\\sigma})$ ] is just @xmath684 .",
    "( in fact , for a degree 1 element the full strength of the elimination theorem is not necessary , since the bracket yields an isomorphism @xmath685 . ) if we let @xmath686 denote the image of @xmath480 in @xmath687 , the fact that @xmath677\\in \\gamma_3^t({\\sigma})$ ] implies that @xmath688=0\\in { \\mathcal{l}}^t_2({\\sigma})$ ] . by the elimination theorem",
    ", this implies @xmath689 for some @xmath680 , as desired .",
    "this shows that any lift @xmath637 of @xmath448 satisfies @xmath656 . by theorem  [ thm : basepointirrelevant ]",
    "this is equivalent to @xmath658 , and by theorem  [ thm : preserved ] this implies @xmath690 , as we claimed .",
    "in this section and the next , we compute the quotient @xmath691 . more specifically , we construct the _ partitioned johnson homomorphism _ @xmath692 , and show that its kernel is exactly @xmath111 .",
    "we also prove that the image of @xmath83 is a certain explicitly defined subgroup @xmath94 of @xmath693 , so that we have a short exact sequence @xmath694      we briefly review johnson s original construction of the johnson homomorphism for a surface @xmath4 with one boundary component , using the action of @xmath3 on the universal two - step nilpotent quotient of the free group @xmath246 , where @xmath695 .",
    "let @xmath492 denote the lower central series of the free group @xmath300 .",
    "we have the short exact sequence @xmath696 centralizing the first term , we get the short exact sequence @xmath697 of johnson  @xcite , where @xmath698 , @xmath699 , and @xmath700 .    considering",
    "the exact sequence as a presentation for @xmath701 , hopf s formula says that @xmath702}=\\frac{\\gamma_2(\\pi)}{\\gamma_3(\\pi)}=n.\\ ] ] since @xmath701 is free abelian , @xmath703 can be identified with @xmath704 .",
    "this gives an isomorphism @xmath705 , which can be described explicitly as follows : @xmath706 is sent to @xmath707\\in n$ ] , where @xmath708 are lifts of @xmath709 and @xmath686 .",
    "all these identifications are @xmath3equivariant ; in particular , @xmath69 acts trivially on @xmath710 .",
    "[ def : classicaljh ] the johnson homomorphism @xmath711 is defined by assigning to @xmath712 the homomorphism @xmath713 given by @xmath714 $ ] , where @xmath715 is any lift of @xmath716 .",
    "the fact that @xmath710 is central in @xmath717 implies that @xmath718 is a homomorphism , and the fact that @xmath68 acts trivially on @xmath701 and on @xmath710 implies that @xmath79 is a homomorphism .    identifying @xmath710 with @xmath704 and @xmath719 with @xmath720 ,",
    "johnson proved in @xcite that the image of this map is exactly @xmath721 ; compare with theorem  [ thm : ws ] below .",
    "the map @xmath79 is @xmath3equivariant with respect to the conjugation actions on @xmath69 and on @xmath722 .",
    "the kernel @xmath723 is exactly the subgroup @xmath10 acting trivially on @xmath724 .",
    "johnson proved in @xcite that for a surface @xmath0 with only one boundary component , @xmath725 is the group @xmath76 generated by separating twists .",
    "our construction of the johnson homomorphism for a general partitioned surface follows johnson s approach closely . for technical reasons ,",
    "our definition of the partitioned johnson homomorphism only makes reference to @xmath157 , not @xmath67 itself . as a result , in remainder of section  [ sec : jh ]",
    "the reader may assume that the partition on @xmath67 is totally separated , so that @xmath726 , without contradiction .",
    "( this definition does not require theorem  [ thm : preserved ] , since the inclusion @xmath159 is canonically defined ; however , to say that @xmath727 coincides with @xmath111 , as we prove in corollary  [ cor : sameasks ] , does depend on theorem  [ thm : preserved ] . )",
    "let @xmath728 .",
    "for a totally separated surface such as @xmath157 , we noted in section  [ sec : chart ] that @xmath729 is isomorphic to @xmath73 , yielding an exact sequence @xmath730 centralizing the first term , we get the exact sequence @xmath731\\to { \\widehat{\\pi}}/[t({\\widehat{{\\sigma}}}),{\\widehat{\\pi}}]\\to { h({\\sigma})}\\to 1.\\ ] ] we define @xmath732 and @xmath733 , so we may rewrite this exact sequence as @xmath734    [ def : taus ] the torelli group @xmath68 acts trivially on @xmath430 by corollary  [ cor : torlttrivial ] , and on @xmath73 by definition .",
    "thus by the construction described in definition  [ def : classicaljh ] , the action of @xmath68 on @xmath735={\\widehat{\\pi}}/\\gamma_3^t({\\widehat{{\\sigma}}})$ ] yields a homomorphism @xmath736 which we call the ( _ partitioned _ ) _ johnson homomorphism_. it is given explicitly by @xmath737\\ ] ] where @xmath738 is a lift of @xmath739 .",
    "note that @xmath740 if and only if @xmath448 acts trivially on @xmath741 .",
    "this implies that @xmath742 is contained in @xmath727 ; we will show in corollary  [ cor : sameasks ] that in fact @xmath88 .",
    "* @xmath3equivariance of @xmath83 . *",
    "the map @xmath83 is @xmath3equivariant , in the following sense .",
    "the mapping class group @xmath3 acts on @xmath68 by conjugation .",
    "the action of @xmath3 on @xmath73 and @xmath430 induces an action on @xmath693 ; to be precise , if @xmath743 and @xmath451 , the map @xmath744 is defined by @xmath745 .",
    "the following lemma is a formal consequence of the definition of @xmath83 .",
    "[ lem : equivariance ] let @xmath451 and @xmath746 . then @xmath747 .    from the definitions , we have @xmath748\\\\ & = { \\varphi}\\big[\\psi{\\varphi}^{-1}(\\tilde{x})\\cdot { \\varphi}^{-1}(\\tilde{x})^{-1}\\big]\\\\ & = { \\varphi}\\big(\\tau_{\\sigma}(\\psi)({\\varphi}^{-1}(x))\\big)\\\\ & = { \\varphi}_*\\tau_{\\sigma}(\\psi)(x)\\end{aligned}\\ ] ] for any @xmath739 .",
    "if @xmath749 is a @xmath132separating curve in @xmath67 , then @xmath749 is a separating curve in @xmath750 ; it follows that @xmath749 is trivial in @xmath751 .",
    "thus for any loop @xmath752 representing @xmath749 , we have @xmath753 .",
    "moreover , any other such loop @xmath754 is conjugate to @xmath140 ; since @xmath331 is a central filtration , they have the same image @xmath179=[\\gamma']\\in \\gamma_2^t({\\sigma})/\\gamma_3^t({\\sigma})={\\mathcal{l}}^t_2({\\sigma})$ ] .",
    "thus any @xmath132separating curve @xmath749 represents a well - defined class @xmath755\\in { n({\\sigma})}$ ] .      in this section",
    "we use the action of @xmath68 on arcs connecting different boundary components to construct a family of abelian quotients @xmath756 of @xmath68 .",
    "* the abelian quotients @xmath756 .",
    "*   recall from section  [ sec : johnsonfiltproper ] that for any arc @xmath325 from the basepoint @xmath137 to a boundary component of @xmath166 , and any @xmath757 , we denote by @xmath480 the element @xmath758 .",
    "moreover , if @xmath562 is another arc ending at the same boundary component , @xmath759 differs from @xmath480 by @xmath760 $ ] , where @xmath761 .",
    "note that @xmath479 $ ] always lies in @xmath762 while @xmath763 if @xmath712 .",
    "thus for @xmath712 , the class of @xmath480 in @xmath764 does not depend on the arc @xmath325 , only on the boundary component .    for a surface",
    "@xmath134 with @xmath765 , for each @xmath275 we let @xmath150 denote the boundary component of @xmath166 corresponding to the block @xmath255 .",
    "this boundary component is separating , and its class in @xmath430 is precisely the generator @xmath150 from proposition  [ prop : cs ] ( justifying the slight abuse of notation ) .",
    "we define the homomorphism @xmath766 by @xmath767\\in h({\\sigma}),\\ ] ] where @xmath455 is an arc from the basepoint @xmath137 to the boundary component @xmath150 .",
    "one important difference between @xmath68 and later terms in the johnson filtration is that these maps @xmath756 factor through the johnson homomorphism @xmath83 .",
    "this property is stated below as theorem  [ thm : deltas ] , and will be proved in section  [ sec : restrict ] .    * the homomorphisms @xmath357 . *   for each @xmath275 we have a map @xmath768 , obtained by counting intersections with the arc @xmath455 ( with multiplicity ) .",
    "specifically , if @xmath769 is represented by @xmath770 , let @xmath771 denote the algebraic intersection number of @xmath772 with the arc @xmath455 .",
    "this does not depend on the choice of arc @xmath455 , since two such arcs from @xmath137 to @xmath150 differ by a cycle plus a multiple of @xmath150 .",
    "any cycle has trivial intersection with any commutator or any boundary component @xmath773 , as does the boundary component @xmath773 . by lemma  [ lem : tsgen ] , @xmath430 is generated by @xmath774 $ ] and the elements @xmath773 , so this suffices .",
    "[ def : tildedelta ] for each @xmath275 , the homomorphism @xmath775 is defined by the adjunction @xmath776    the following proposition will be proved in section  [ sec : restrict ] .",
    "[ thm : deltas ] the maps @xmath766 factor through @xmath83 ; more specifically , we have @xmath777 .",
    "[ cor : sameasks ] the kernel @xmath727 of the partitioned johnson homomorphism @xmath83 is precisely the subgroup @xmath778 .",
    "by theorem  [ thm : preserved ] we have @xmath779 , so it suffices to prove the corollary for @xmath157 ; in other words , we may assume that @xmath67 is totally separated . by definition ,",
    "@xmath780 consists of those @xmath182 acting trivially modulo @xmath517 .",
    "when @xmath67 is totally separated , condition ( iii ) of definition  [ def : johnsonfiltration ] is vacuous .",
    "thus @xmath89 consists of those @xmath182 satisfying conditions ( i ) and ( ii ) ; i.e.  those @xmath781 that additionally satisfy @xmath782 for each @xmath275 .",
    "since @xmath783 is the class of @xmath784 in @xmath785 , condition ( ii ) asks that @xmath786 for all @xmath275 .",
    "but theorem  [ thm : deltas ] states that @xmath787 .",
    "we conclude that any @xmath781 lies in @xmath778 , as desired .",
    "the definition of @xmath788 , of @xmath789 , and of @xmath83 do not really depend on the partitioned surface @xmath67 itself , only on @xmath157 .",
    "however the image of @xmath83 certainly depends on @xmath67 . in this section",
    "we describe certain conditions on the image of @xmath83 , which together cut out a subspace @xmath94 of @xmath693 .",
    "we will eventually prove in section  [ sec : compute ] that @xmath790 .",
    "* understanding @xmath693 .",
    "*   there is a natural quotient @xmath791 defined by sending @xmath792 for all @xmath275 , induced for example by the inclusion @xmath793 of section  [ sec : torelli ] .",
    "in fact , it follows from theorem  [ thm : ltfree ] that @xmath794 where @xmath795 is the image of @xmath774 $ ] and the @xmath796 factor is spanned by @xmath429 .",
    "note that the intersection @xmath797 vanishes on @xmath795 and satisfies @xmath798 .    the projection @xmath791 induces a projection : @xmath799 note that @xmath800 embeds into @xmath801 as the `` jacobi identity '' : @xmath802    * the subspaces @xmath803 .",
    "*   we denote by @xmath804 be the isotropic subspace spanned by the homology classes @xmath499 of all the boundary components @xmath498 .",
    "similarly , for the single block @xmath255 , we denote by @xmath805 the subspace spanned by those components @xmath499 for @xmath806 .",
    "note that @xmath807 is exactly the subspace of @xmath73 spanned by @xmath42 .",
    "[ def : ws ] the subspace @xmath808 consists of those elements@xmath809 satisfying the following conditions :    a.   the image in @xmath801 of @xmath810 under the projection is contained in the subspace @xmath811 .",
    "b.   for @xmath275 we have @xmath812 and furthermore for any @xmath813 , @xmath814 . c.   for any @xmath815 , @xmath816 .",
    "the following characterization of the image of @xmath83 is one of the main theorems of the paper .",
    "[ thm : ws ] @xmath790 .",
    "we prove that @xmath104 is contained in @xmath94 in the next section ( theorem  [ thm : wscontained ] ) .",
    "we defer the remaining direction of theorem  [ thm : ws ] until section  [ sec : compute ] , where we first compute the value of @xmath83 on various fundamental elements of @xmath68 , then use these computations to prove that @xmath83 surjects to @xmath94 . before moving on , we deduce theorem  [ thm : betti ] from theorem  [ thm : ws ] .",
    "let @xmath13 be an arbitrary finite - index subgroup of @xmath68 satisfying @xmath817 .",
    "since @xmath693 is torsion - free the image @xmath818 coincides with the image @xmath819 .",
    "let @xmath820 be the standard inclusion into the surface @xmath629 , which has one boundary component .",
    "putman  ( * ? ? ?",
    "* theorem  1.2 ) states that as long as @xmath67 has genus at least 3 , for any such @xmath13 we have @xmath821 the naturality of @xmath83 , proved in theorem  [ thm : commutes ] below , means that @xmath822 is isomorphic to @xmath823 , and theorem  [ thm : ws ] states that @xmath823 is precisely the subspace @xmath91 .",
    "thus putman s theorem implies that the first betti number @xmath824 is the dimension @xmath825 .",
    "consider the projection @xmath826 defined by @xmath827 .",
    "condition ( ii ) of definition  [ def : ws ] states that when restricted to @xmath94 , this projection has image @xmath828 .",
    "it is easy to construct elements of @xmath94 surjecting to @xmath828 , and indeed we will do this by hand in proving theorem  [ thm : ws ] .",
    "the kernel of this surjection @xmath829 consists of those @xmath830 satisfying @xmath831 for all @xmath198 .",
    "this implies that @xmath810 lies in the subspace @xmath832 of @xmath693 , so by condition ( i ) we have @xmath833",
    ". conditions ( ii ) and ( iii ) imply that @xmath810 satisfies @xmath816 whenever @xmath834 .",
    "as an element of @xmath835 , this means that @xmath810 is contained in @xmath836 since any @xmath837 clearly satisfies conditions ( ii ) and ( iii ) , we conclude that @xmath94 fits into a short exact sequence @xmath838 let @xmath839 be the number of boundary components of @xmath4 , partitioned into @xmath840 blocks , and let @xmath841 . as abelian groups , we have @xmath842 , @xmath843 , and @xmath844 . since @xmath807 is torsion - free , splits , so @xmath845 , as desired .",
    "[ thm : wscontained ] the map @xmath83 has image contained in @xmath94 .    consider @xmath846 and let @xmath847 .",
    "we first show that @xmath810 satisfies condition ( i ) of definition  [ def : ws ] , and at the same time verify theorem  [ thm : deltas ] .",
    "we will make use of the following identities ( where @xmath848 denotes conjugation ) : @xmath849={}^a[w , b]\\cdot[a , b ] , \\qquad\\qquad[a , bw]=[a , b]\\cdot{}^b[a , w].\\ ] ] if @xmath850 , both @xmath851 $ ] and @xmath852 $ ] are in @xmath853 , so we have @xmath849\\equiv[a , b][w , b]\\bmod{\\gamma^t_4({\\widehat{{\\sigma } } } ) } ,    \\qquad[a , bw]\\equiv[a , b][a , w]\\bmod{\\gamma^t_4({\\widehat{{\\sigma}}})}.\\ ] ]    let @xmath854 represent the boundary component @xmath855 of @xmath166 that contains the basepoint .",
    "the key to our proof is to consider the action of @xmath448 on @xmath856even though @xmath856 is contained in the boundary @xmath263 and so the action of @xmath448 on @xmath856 is trivial .",
    "choose a basis @xmath857 of @xmath858 as in proposition  [ prop : cs ] , so that @xmath859 descends to the symplectic basis @xmath41 of @xmath73 , each @xmath259 represents @xmath860 , and @xmath861\\cdots[\\alpha_g,\\beta_g]\\zeta_1\\cdots\\zeta_k$ ] .    in this proof ,",
    "let @xmath862 . by definition , @xmath712 if and only if @xmath863 for all @xmath864 .",
    "our fundamental computation gives @xmath865\\zeta_j$ ] .",
    "recalling that @xmath866 for all @xmath297 , we calculate : @xmath867\\prod_{j=1}^k\\zeta_j\\right)\\\\    & = \\prod_{i=1}^g[{\\varphi}(\\alpha_i),{\\varphi}(\\beta_i)]\\prod_{j=1}^k{\\varphi}(\\zeta_j)\\\\    & = \\prod_{i=1}^g[\\alpha_i\\eta_{\\varphi}(\\alpha_i),\\beta_i\\eta_{\\varphi}(\\beta_i ) ]         \\prod_{j=1}^k[d_j,\\zeta_j]\\zeta_j\\\\    & \\equiv \\prod_{i=1}^g[\\alpha_i,\\beta_i ] [ \\alpha_i,\\eta_{\\varphi}(\\beta_i ) ]      [ \\eta_{\\varphi}(\\alpha_i),\\beta_i ] \\prod_{j=1}^k[d_j,\\zeta_j]\\zeta_j \\bmod{\\gamma^t_4({\\widehat{{\\sigma}}})}\\\\    & \\equiv    \\left(\\prod_{i=1}^g[\\alpha_i,\\eta_{\\varphi}(\\beta_i ) ]     [ \\eta_{\\varphi}(\\alpha_i),\\beta_i ] \\prod_{j=1}^k[d_j,\\zeta_j]\\right)\\cdot\\zeta_0\\bmod{\\gamma^t_4({\\widehat{{\\sigma}}})}\\end{aligned}\\ ] ] define @xmath868     [ \\eta_{\\varphi}(\\alpha_i),\\beta_i ] \\prod_{j=1}^k[d_j,\\zeta_j]\\in \\gamma^t_3({\\widehat{{\\sigma}}})\\ ] ] and consider the class @xmath869\\in{\\mathcal{l}}^t_3({\\widehat{{\\sigma}}})=\\gamma^t_3({\\widehat{{\\sigma}}})/\\gamma^t_4({\\widehat{{\\sigma}}})$ ] .",
    "note that @xmath870 and @xmath871 in @xmath872 represent @xmath873 and @xmath874 in @xmath430 .",
    "thus the following element @xmath875 descends to @xmath869\\in { \\mathcal{l}}^t_3({\\widehat{{\\sigma}}})$ ] under the commutator bracket : @xmath876 note that the first summation is exactly the expansion of @xmath877 in @xmath878 .",
    "indeed , since @xmath41 form a basis of @xmath73 , we can write @xmath879 and under the isomorphism @xmath880 we have @xmath881 and @xmath882 ( since @xmath883 and @xmath884 . in particular , it follows from the discussion following that the coefficient of @xmath773 in the first summation is @xmath885 .",
    "we calculated above that @xmath886 .",
    "however , since @xmath856 is contained in the boundary of @xmath166 , we have @xmath887 .",
    "thus @xmath888 is trivial , so @xmath396 must lie in @xmath889 . in other words ,",
    "@xmath869=0\\in { \\mathcal{l}}^t_3({\\widehat{{\\sigma}}})$ ] ; this implies that @xmath875 is contained in the kernel of the map @xmath890 .",
    "we now recall proposition  [ prop : tbracket ] , which states that the bracket @xmath891 induces the short exact sequence @xmath892 this has the following implications .",
    "first , we saw above that the coefficient of @xmath773 in @xmath351 is @xmath893 but the factor @xmath894 intersects @xmath835 trivially , so for @xmath351 to be contained in @xmath835 we must have @xmath895 .",
    "this completes the proof of theorem  [ thm : deltas ] .",
    "furthermore , this implies that @xmath875 is the difference of @xmath896 and its projection to the @xmath796 factor spanned by the @xmath773 ; in other words , @xmath897 is the projection of @xmath896 to @xmath898 under the map .",
    "now proposition  [ prop : tbracket ] states that this is contained in @xmath835 , verifying condition ( i ) of definition  [ def : ws ] .",
    "+ now we can use theorem  [ thm : deltas ] to verify conditions ( ii ) and ( iii ) .",
    "we have just proved that @xmath899 .",
    "but from the definition of @xmath756 we can see that @xmath783 is contained in @xmath807 .",
    "indeed , we have @xmath900 $ ] .",
    "since @xmath448 is the identity outside @xmath4 , we have @xmath901 outside @xmath4 , and thus @xmath902 $ ] may be represented by a cycle lying inside @xmath4 .",
    "we observed in section  [ sec : image ] that the span of @xmath42 in @xmath73 is exactly @xmath807 , and so we conclude that @xmath903 for all @xmath198 .    to verify the remainder of condition ( ii ) we must show that @xmath904 for @xmath905 .",
    "it suffices to check this when @xmath906 is the class of a single boundary component in @xmath257 . by our fundamental computation",
    "we have @xmath907 $ ] , where @xmath908 represents @xmath905 , so @xmath904 as desired .",
    "a similar argument verifies condition ( iii ) .",
    "if @xmath906 is the class of a single boundary component contained in @xmath190 , then it is connected outside @xmath4 to the basepoint ; in particular , @xmath906 can be represented by a loop disjoint from @xmath909 .",
    "thus @xmath448 fixes this loop pointwise , and so @xmath910 .",
    "this completes the proof of theorem  [ thm : wscontained ] .    for any term in the johnson filtration",
    ", we could define homomorphisms @xmath756 from @xmath74 to @xmath911 by @xmath912\\in { \\mathcal{l}}^t_{k-1}({\\widehat{{\\sigma}}})$ ] . an argument similar to the above would show that these maps @xmath756 are controlled to some degree by the action of @xmath74 on @xmath913 .",
    "however , to show that the @xmath756 actually factor through this action when @xmath119 we needed proposition  [ prop : tbracket ] , which states that the various maps @xmath914 defined by @xmath915 $ ] have independent images .",
    "the corresponding statement for maps @xmath916 is definitely false for @xmath917 : for example , we have relations such as @xmath918+[z_j , z_i]=0 $ ] or @xmath919,z_k]+[[z_j , z_k],z_i]+[[z_k , z_i],z_j]=0 $ ] .      in this section",
    "we show that the partitioned johnson homomorphism @xmath83 is natural .",
    "this means that for any morphism @xmath323 , we must define a map @xmath920 so that @xmath921 for all @xmath712 ; in other words , the following diagram commutes : @xmath922\\ar_{\\qquad\\iota_*}[d ]      & & w_{{\\sigma}}\\ar^{\\iota_*}[d]\\\\      { \\mathcal{i}}({\\sigma}')\\ar_{\\qquad\\tau_{{\\sigma}'}\\qquad}[rr]&&w_{{\\sigma}'}}\\quad\\ \\ ] ] to define the map @xmath923 , we consider separately the cases when @xmath215 is non - collapsing and when @xmath215 is a simple capping ; since every morphism is a composition of such inclusions , this suffices .",
    "[ def : alternate ] the map @xmath924 is somewhat unwieldy when expressed in terms of the usual notation for @xmath91 .",
    "however there is an equivalent way to describe a basis of @xmath94 , and with respect to this basis the definition of the map @xmath353 is very simple . recall from definition  [ def : ws ] that @xmath94 can be thought of as a subspace of @xmath925 . for the @xmath835 component",
    ", we have the standard @xmath926 notation . for the @xmath927 factor",
    "we write @xmath928 as a formal expression for the element @xmath929 .",
    "we remark that in this notation , the homomorphism @xmath930 has the form @xmath931 so we will often write @xmath932 for the components of this second factor @xmath927 .",
    "[ def : wsiota ] for a simple capping @xmath323 , if @xmath154 is obtained from @xmath67 by attaching a disk to the separating component @xmath150 , we define @xmath353 as follows .",
    "@xmath933    for a non - collapsing morphism @xmath323 , decompose @xmath934 into subsurfaces @xmath935 , so that @xmath935 meets @xmath157 in the component @xmath150 corresponding to the block @xmath257 .",
    "we can consider @xmath936 as a subspace of @xmath505 .",
    "let @xmath937 represent the intersection form on @xmath936 , and let @xmath938 be the boundary components of @xmath935 that are disjoint from @xmath157 .",
    "we define @xmath353 as follows .",
    "@xmath939 note that in @xmath940 we have @xmath941 , since @xmath150 is the boundary component that would be @xmath942 , but traversed in the opposite direction .",
    "[ thm : commutes ] for any inclusion @xmath943 , the map @xmath924 defined in definition  [ def : wsiota ] satisfies @xmath944 for all @xmath712 .",
    "the argument is similar to the proof of theorem  [ thm : preserved ] .",
    "in the course of the proof , we will extend @xmath923 to a map @xmath945 .",
    "we then verify naturality for @xmath946 directly from the definition of @xmath83 , and it remains only to check that @xmath946 does in fact restrict to @xmath353 on @xmath94 .",
    "first , consider the case when @xmath215 is a simple capping , so that @xmath154 is obtained from @xmath67 by attaching a disk to the separating component @xmath773 . since @xmath773 was separating and thus represented by @xmath947 , we have @xmath948 , and the natural map @xmath949 is surjective with kernel generated by @xmath773 .",
    "thus the exact sequences defining @xmath950 and @xmath951 are related by the following diagram :    @xmath952&1\\ar[d]&&\\\\      & { \\mathbb{z}}\\ar[d]&{\\mathbb{z}}\\ar[d]&&\\\\      1\\ar[r]&n({\\sigma})\\ar[r]\\ar[d]&e({\\sigma})\\ar[r]\\ar[d ]      & h({\\sigma})\\ar[r]\\ar@{=}[d]&1\\\\      1\\ar[r]&n({\\sigma}')\\ar[d]\\ar[r]&e({\\sigma}')\\ar[d]\\ar[r]&h({\\sigma}')\\ar[r]&1\\\\      & 1&1 & &    } \\end{split}\\ ] ]    it follows that @xmath953 for @xmath954 , where @xmath946 is the map @xmath955 sending @xmath956 to the composition @xmath957 the restriction of @xmath946 to @xmath958 has kernel @xmath959 and thus coincides with @xmath353 as defined in definition  [ def : wsiota ] , verifying the theorem in this case .",
    "+ now , consider the case when @xmath215 is non - collapsing . in this case",
    "the induced map @xmath960 is an injection by theorem  [ thm : ltfree ] .",
    "recall that the @xmath935 are the components of @xmath961 , appropriately labeled so that @xmath935 intersects @xmath157 in the boundary component @xmath150 .",
    "each @xmath935 inherits the structure of a partitioned surface from @xmath962 , and since the resulting partition is totally separated , the inclusion morphism @xmath963 is uniquely determined . identifying @xmath71 with its image in @xmath505 , we have an orthogonal splitting @xmath964 .",
    "we use this to define @xmath946 as follows . given a homomorphism @xmath965 ,",
    "let @xmath966 be the homomorphism defined by : @xmath967 the term @xmath968 here is taken in @xmath969 .    to verify that @xmath970 , we consider two cases separately . if @xmath739",
    ", we can represent it by an element @xmath971 , where @xmath14 is an arc from @xmath156 to @xmath137 in @xmath972 , and @xmath973 is an element of @xmath974 representing @xmath975 .",
    "as in the proof of theorem  [ thm : preserved ] we compute @xmath976 .",
    "it follows that @xmath977 , as claimed .",
    "if @xmath978 , we can represent it by an element @xmath672 , where @xmath486 is a loop in @xmath979 and @xmath325 is an arc in @xmath166 from @xmath137 to the boundary component @xmath150 .",
    "our fundamental computation shows as before that @xmath980 $ ] .",
    "thus @xmath981 , and by theorem  [ thm : deltas ] this is @xmath982 .",
    "thus for any @xmath983 we have @xmath984 .",
    "it remains only to check that @xmath946 agrees on @xmath94 with the map @xmath353 in definition  [ def : wsiota ] .",
    "for @xmath739 we have @xmath985 , while for @xmath978 we have @xmath986 . considering @xmath987 as a subspace of @xmath988 ,",
    "if @xmath989 form a symplectic basis for @xmath936 , the restriction of @xmath990 to @xmath936 is @xmath991 . thus if @xmath992 , we have @xmath993 we noted above that @xmath994 in @xmath995 , so the parenthesized term can be written as : @xmath996 which is precisely @xmath997 .",
    "thus the restriction of @xmath946 to @xmath94 is the map induced by @xmath998 and @xmath999 , namely @xmath353 .    *",
    "moving the basepoint .",
    "*   we saw in theorem  [ thm : basepointirrelevant ] that the johnson filtration of a partitioned surface @xmath134 does not depend on the location of the basepoint @xmath137 , only on the partition @xmath132 . the johnson homomorphism @xmath1000 does in fact depend on the basepoint , but in a controlled way .",
    "let @xmath519 be the same partitioned surface , except that the basepoint @xmath156 lies in @xmath1001 instead of @xmath190 , and let @xmath1002 represent the symplectic form .",
    "[ lem : bpchange ] if @xmath67 and @xmath154 coincide as partitioned surfaces except that @xmath1003 , then @xmath1004    as in the proof of theorem  [ thm : basepointirrelevant ] , let @xmath550 denote @xmath1005 , where @xmath455 is an arc from @xmath137 to @xmath156 .",
    "the assignment @xmath553 defines an isomorphism @xmath1006 , and thus induces isomorphisms @xmath1007 and @xmath1008 .",
    "we saw in that @xmath1009{\\varphi}(\\xi)\\xi^{-1}}$ ] , which shows that @xmath1010 the homomorphism @xmath1011 in @xmath898 is represented by @xmath1012 , so @xmath1013 , as desired .",
    "* viewing @xmath83 as a natural transformation . *",
    "one way to phrase the naturality of @xmath83 proved in theorem  [ thm : commutes ] is to say that @xmath83 is a natural transformation .",
    "we have already noted in section  [ sec : torellicategory ] that @xmath223 can be considered as a functor from @xmath207 to @xmath1014 ( the category of groups and homomorphisms ) , defined on objects by @xmath1015 and on morphisms by @xmath1016 .",
    "let @xmath1017 be the functor from @xmath207 to @xmath1014 defined on objects by @xmath1018 and on morphisms by @xmath1019 as in definition  [ def : wsiota ] .",
    "then we can rephrase theorem  [ thm : commutes ] as follows :    [ thm : naturaltransformation ] there is a natural transformation @xmath79 from the torelli functor @xmath223 to the functor @xmath1017 which assigns to each surface @xmath67 the surjective homomorphism @xmath1000 .",
    "in this section we calculate @xmath83 on many simple but fundamental elements of @xmath68 , including the natural `` point - pushing '' subgroups . using this , we prove in section  [ sec : surjectivity ] that @xmath94 is exactly the image of @xmath83 .",
    "these results are also used in section  [ sec : ksorbits ] .",
    "let @xmath67 be the surface @xmath1020 with the totally separated partition .",
    "the homology group @xmath73 is trivial .",
    "it follows that @xmath99 , so by theorem  [ thm : wscontained ] we have @xmath740 for any @xmath712 .",
    "any dehn twist @xmath467 is supported on the annulus which is the regular neighborhood of @xmath140 , and the induced partition on this annulus @xmath1021 is totally separated exactly when @xmath140 is @xmath132separating . applying the naturality of @xmath83 , we obtain the following corollary .    [ prop : st ] if @xmath67 is a partitioned surface and @xmath140 is a @xmath132separating curve , then @xmath1022 .",
    "more generally , we have the following .    if @xmath712 is supported on a totally separated genus 0 subsurface , then @xmath740 .",
    "let @xmath67 be a surface @xmath1023 of genus 0 with 3 boundary components @xmath855 , @xmath1024 , and @xmath1025 , endowed with the partition @xmath1026 and basepoint @xmath1027 .",
    "let @xmath1028 .",
    "this is a bounding pair , and @xmath67 is the minimal connected surface on which @xmath448 is supported .",
    "the surface @xmath157 has genus 1 with 2 boundary components , @xmath855 and @xmath147 .",
    "its fundamental group has rank 3 , and we may choose a basis @xmath1029 for @xmath974 so that the first two terms descend to a basis @xmath1030 for @xmath73 , the generator @xmath1031 can be represented by a loop in @xmath4 , and @xmath1032 descends to @xmath1033 in @xmath430 . for an appropriate choice of generators we have @xmath1034 and @xmath1035 , so @xmath1036 is defined by @xmath1037 and @xmath1038 . in the alternate notation of definition  [ def : alternate ] for elements of @xmath94 , we have @xmath1039 .",
    "the same argument applies when the basepoint lies in @xmath147 . since every bounding pair in a partitioned surface @xmath67 sits inside at least one such @xmath1023 ( for example , the regular neighborhood of the curves together with an arc connecting them ) , we can apply the naturality of @xmath83 to obtain the following corollary .    [",
    "prop : bp ] given a bounding pair @xmath1040 defined by nonseparating curves @xmath140 and @xmath486 , let @xmath1032 be a separating curve that cobounds a pair of pants with @xmath1041 .",
    "orient these curves so that the pair of pants lies on the left side of @xmath1032 and the right side of @xmath140 and @xmath486 ( or vice versa ) .",
    "let @xmath906 be the homology class of @xmath140 , and let @xmath141 be the class of @xmath1032 in @xmath430 .",
    "then we have @xmath1042 in @xmath94 .    theorem  [ thm : commutes ] guarantees that this recipe is well - defined , even though this is not obvious .",
    "we can check for example that changing the orientation of all three curves would negate both @xmath906 and @xmath141 , and thus would preserve @xmath1043 .",
    "similarly , there is a curve @xmath1044 on the other side of @xmath1041 whose class @xmath1045 differs from @xmath141 by a term of the form @xmath1046 , in which case @xmath1047 .",
    "but there are many different curves @xmath1032 bounding pairs of pairs with @xmath140 and @xmath486 ;",
    "a key strength of the naturality of @xmath83 is that it lets us choose any pair of pants that we like .",
    "we say that @xmath1031 and @xmath1048 span a _ lantern core",
    "_ if their geometric intersection number is 2 and their algebraic intersection number is 0",
    ". a _ lantern core _",
    "map is the commutator @xmath1049 $ ] of dehn twists around two such curves .",
    "since @xmath1031 and @xmath1048 have algebraic intersection 0 , @xmath1050 and @xmath1051 act on @xmath73 by commuting transvections .",
    "it follows that @xmath1049\\in { \\mathcal{i}({\\sigma})}$ ] .",
    "such maps were first used by johnson in @xcite ; they are called simply intersecting pair maps in putman @xcite .",
    "[ fig : arcs ]     and @xmath1048 , and the arcs @xmath1052.,title=\"fig:\",width=396 ] +    the regular neighborhood of two such curves is always a lantern , so it suffices to compute @xmath83 for partitioned surfaces @xmath1053 . to begin",
    ", we say that @xmath1031 and @xmath1048 span a _ nonseparating lantern core _ if @xmath1054 is @xmath132nonseparating ; that is , the induced partition on the regular neighborhood @xmath1055 of @xmath1056 is the nonseparating partition @xmath1057 .",
    "let @xmath1031 and @xmath1048 be as in figure  1 , and let @xmath1058 be the homology classes in @xmath73 of the three boundary components in the center .",
    "[ prop : lanterncore ] if @xmath1031 and @xmath1048 span a nonseparating lantern core , then @xmath1059)=-a_1\\wedge a_2\\wedge a_3 $ ] .    if @xmath1060 , the surface @xmath166 has genus 3 and 1 boundary component",
    ". a basis for @xmath974 is given by curves @xmath1061 traveling clockwise around the three central boundary components , together with curves @xmath1062 whose intersection with @xmath67 are the arcs @xmath1052 respectively , oriented bottom - to - top .",
    "these descend to a basis @xmath1063 for @xmath73 .",
    "let @xmath1064 $ ] .",
    "since @xmath1024 , @xmath1025 , and @xmath1065 are contained in @xmath1066 , from condition ( iii ) of definition  [ def : ws ] we know that @xmath1067 the action of @xmath448 on the arcs @xmath555 is displayed in figure  2 .    [",
    "fig : arcsmoved ]     and @xmath1068.,width=612 ]    thus we have : @xmath1069b_1\\\\    b_2&\\mapsto [ \\alpha_3^{-1},\\alpha_1^{-1}]b_2\\\\    b_3&\\mapsto    [ \\alpha_3^{-1}\\alpha_1^{-1}\\alpha_3,\\alpha_1\\alpha_2^{-1}\\alpha_1^{-1}]b_3 \\end{array}\\ ] ] it follows that : @xmath1070 as an element of @xmath1071 , this is the element @xmath1072 .",
    "the naturality of @xmath83 implies that the same formula holds for a nonseparating lantern core in any surface @xmath67 , as claimed .    from the same computations we can deduce that any other lantern core map is contained in the johnson kernel @xmath111 . indeed for any other surface @xmath1053 for which @xmath132 is not the nonseparating partition , the rank of @xmath807 is at most 2 .",
    "thus @xmath1073 , so the exact sequence implies that @xmath1074 is determined by the @xmath1075 .",
    "but our computations of @xmath1076 in show that @xmath1077 $ ] for each @xmath198 , and so @xmath1078 for all @xmath198 .",
    "[ prop : separatinglanterncore ] if @xmath1031 and @xmath1048 span a lantern core which is not nonseparating , then @xmath1059)=0 $ ] .      in this section",
    "we determine the restriction of @xmath83 to certain `` disk - pushing '' subgroups of @xmath1079 .",
    "let @xmath173 be a simple capping obtained by attaching a disk to a separating boundary component @xmath1080 .",
    "in particular , we assume that @xmath67 has at least two boundary components , and that @xmath137 is not contained in @xmath141 .",
    "such a capping induces a surjection @xmath439 , whose kernel is isomorphic to @xmath1081 , where @xmath1082 is a unit vector at the center of the disk glued to @xmath141 ( johnson  @xcite ) .",
    "the conventions for composition in @xmath3 and in @xmath1081 unfortunately disagree ; in the former we take composition of functions and in the latter we take concatenation of paths . as a result",
    ", the isomorphism of @xmath1083 with @xmath1081 is defined as follows .",
    "given @xmath1084 , extend @xmath448 by the identity to @xmath66 ; by definition , there is an isotopy @xmath1085 of @xmath66 from @xmath1086 to @xmath1087 .",
    "since @xmath448 fixes @xmath1082 , the image of @xmath1082 under this isotopy is a loop of tangent vectors from @xmath1088 to @xmath1082 .",
    "we associate to @xmath448 the corresponding element @xmath1089 .",
    "note that given another map @xmath1090 fixing @xmath1082 , @xmath1091 satisfies @xmath1092 .",
    "thus an isotopy from @xmath1093 to @xmath1094 can be obtained by concatenating the isotopy @xmath1091 from @xmath1095 to @xmath1090 with the isotopy @xmath1096 from @xmath1090 to @xmath1094 ; the path this determines is the concatenation @xmath1097 .",
    "this verifies that @xmath1098 .",
    "we remark that this isomorphism is the opposite of the identification naively suggested by the `` disk - pushing '' label .",
    "[ prop : seppushtor ] for a separating component , the entire disk - pushing subgroup @xmath1081 is contained in @xmath68 .",
    "note that we have @xmath1099 , since @xmath141 is separating and thus vanishes in homology . for any curve @xmath140 in @xmath4 and any @xmath1100 ,",
    "the curve @xmath1101 is homotopic to @xmath140 in @xmath66 , which implies that @xmath1102 $ ] is homologous to @xmath179 $ ] in @xmath71 .",
    "this shows that @xmath846 as desired .",
    "[ prop : seppush ] the restriction @xmath1103 of the johnson homomorphism to the disk - pushing subgroup determined by @xmath150 is the composition @xmath1104 where the last map is the embedding @xmath1105 defined by @xmath1106 .",
    "let @xmath1107 be the projection of @xmath1108 , and for @xmath1109 , let @xmath1110 denote its projection to @xmath1111 .",
    "for any @xmath1112 , the naturality of @xmath83 implies that @xmath1113 . for a simple capping @xmath173 , by definition  [ def : wsiota ]",
    "the map @xmath1114 is induced by the quotient @xmath1115 .",
    "we thus know _ a priori _ that @xmath1116 must be contained in the subspace @xmath1117 . by theorem  [ thm : deltas ]",
    "we thus have @xmath1118 thus it suffices to prove that if @xmath1119 corresponds to @xmath1120 , we have @xmath1121.\\ ] ]    recall that @xmath783 is the homology class of @xmath453 where @xmath1122 is an arc from the basepoint to @xmath150 .",
    "since @xmath1007 , we may consider @xmath325 as an arc in @xmath66 from the basepoint to @xmath1123 .",
    "if @xmath1124 is simple and disjoint from @xmath325 as a based loop , then @xmath452 will be homotopic in @xmath66 to the concatenation @xmath1125 . note that if @xmath1124 is simple , we can always choose @xmath325 disjoint from it . for such elements , we have @xmath1126 .",
    "this is homologous in @xmath66 to @xmath1127=-[\\overline{\\gamma_{\\varphi}}]$ ] , and since @xmath1128 this implies that @xmath1129=-[\\overline{\\gamma_{\\varphi}}]\\in { h({\\sigma})}$ ] .",
    "thus for such elements holds and @xmath1130\\wedge z$ ] .",
    "the kernel @xmath1131 is generated by a twist around the boundary component @xmath150 . by proposition",
    "[ prop : st ] @xmath83 vanishes for any separating twist , so holds for this element as well .",
    "the group @xmath1111 is normally generated by ( in fact , generated by ) elements represented by simple loops .",
    "it follows that @xmath1081 is normally generated by @xmath140 for which @xmath1110 is either simple or trivial .",
    "since holds for generators of either form , it holds for all elements of @xmath1132 .",
    "this completes the proof of the proposition .",
    "[ rem : rationalhomology ] note that for many surfaces @xmath67 , the subgroup @xmath1081 is generated by bounding pairs , so we could obtain another proof of the proposition by applying proposition  [ prop : bp ] .",
    "this was the approach used by johnson to prove the proposition in the classical case when @xmath4 has a single boundary component .",
    "in fact the proposition is almost automatic in this case : the restriction of @xmath1133 to the point - pushing subgroup @xmath1081 is a map to the torsion - free abelian group @xmath1134 , so it factors through the surjection @xmath1135 , and moreover extends to a @xmath3equivariant map @xmath1136 .",
    "since @xmath1137 is an irreducible @xmath1138module and @xmath1139 contains a unique submodule isomorphic to @xmath1137 ( embedded by @xmath1140 ) , schur s lemma implies that the proposition holds up to a multiplicative constant .",
    "this constant can be detected by computing @xmath1133 for a single element .",
    "we proved in theorem  [ thm : wscontained ] that @xmath104 is contained in @xmath94 . to complete the proof of theorem  [ thm : ws ] , it remains to show that @xmath68 surjects to @xmath94 under @xmath83 .",
    "the surjection @xmath1141 defined by @xmath1142 has kernel equal to @xmath1143 , as we saw in the exact sequence : @xmath1144 fix a symplectic basis @xmath1145 for @xmath73 so that @xmath1146 provides a basis for @xmath1147 , each @xmath1148 is represented by a boundary component , and @xmath1149 provides a basis for @xmath807 .    * the image @xmath104 surjects to @xmath1150 .",
    "*   fix @xmath1151 and let @xmath1152 be the @xmath132separating curve cutting off a subsurface of genus 0 bounded by @xmath1152 together with all the boundary components lying in @xmath1153",
    ". we will show for any @xmath1154 that we can find @xmath712 with @xmath1155 $ ] .",
    "note that @xmath1156+\\cdots+[a^{m_j}_j , b^{m_j}_j]+z_j$ ] in @xmath430 , so @xmath1157 $ ] satisfies @xmath1158 and @xmath1159 for @xmath1160 .",
    "since these @xmath709 form a basis for @xmath807 , this will verify that @xmath104 surjects to @xmath1150 .",
    "first , consider the case when @xmath1161 for some @xmath198 .",
    "let @xmath140 be a curve homotopic to @xmath1162 , and let @xmath486 be the band sum of @xmath140 with @xmath1152 .",
    "( the band sum of two simple closed curves is their connected sum along some simple arc connecting the two curves . )",
    "the homologous curves @xmath140 and @xmath486 determine a bounding pair @xmath1163 that cobounds a pair of pants with @xmath1152 , so proposition  [ prop : bp ] states that @xmath1164 $ ] .    for the remaining cases ,",
    "let @xmath1165 be the component of @xmath1166 containing the basepoint , and consider the disk - pushing subgroup of @xmath1167 determined by @xmath1152 . by proposition",
    "[ prop : seppush ] , we can find @xmath1168 with @xmath1169 $ ] for any @xmath1170 in the image of @xmath1171 .",
    "but the image of @xmath1172 in @xmath73 is spanned by @xmath1173 . applying theorem  [ thm : commutes ] to the non - collapsing inclusion of @xmath1174 into @xmath67",
    ", we obtain a disk - pushing map @xmath846 with @xmath1155 $ ] for the remaining basis elements @xmath709 , as desired .    * the image @xmath104 contains @xmath1175 .",
    "*   consider the natural basis of @xmath1143 induced by the basis @xmath1149 of @xmath807 .",
    "first , consider the basis elements of the form @xmath1176 for some @xmath621 and some other basis element @xmath709 .",
    "realize @xmath1177 and @xmath1178 by simple closed curves intersecting once , and let @xmath1179 be the regular neighborhood of their union .",
    "let @xmath1180 be the component of @xmath1181 containing the basepoint , and consider the disk - pushing subgroup of @xmath1182 determined by @xmath1179 .",
    "any @xmath709 in our basis distinct from @xmath1177 and @xmath1178 can be realized by a loop in @xmath1180 , so by proposition  [ prop : seppush ] we can find a disk - pushing map @xmath1183 with @xmath1184 $ ] . since @xmath1185=a_i\\wedge b_i$ ] in @xmath430 , applying theorem  [ thm : commutes ] to the non - collapsing inclusion of @xmath1186 into @xmath67 implies that @xmath1187 .",
    "any other basis element is of the form @xmath1188 where @xmath1189 .",
    "we may thus realize these homology classes by disjoint curves @xmath1190 .",
    "let @xmath486 be the band sum of all three curves ( to be precise we should specify orientations , but this will only change the answer by a sign ) .",
    "we obtain a lantern @xmath1055 bounded by @xmath1031 , @xmath1048 , @xmath140 , and @xmath486 . if @xmath448 is a lantern core map supported on this lantern , then by proposition  [ prop : lanterncore ] , @xmath1191 .",
    "this verifies that a basis for @xmath1143 is contained in @xmath104 .",
    "together with theorem  [ thm : wscontained ] , this completes the proof of theorem  [ thm : ws ] and shows that the image of @xmath83 is exactly @xmath94 .",
    "in this section , we combine the characterization of @xmath104 from section  [ sec : jh ] with the computations from section  [ sec : compute ] to describe the orbits of simple closed curves under the johnson kernel @xmath76 .",
    "let @xmath0 and @xmath277 , so that @xmath1192 .",
    "in this section we consider nonseparating curves in @xmath4 ; we always consider curves to be oriented .",
    "it was known to johnson  @xcite that two nonseparating curves are in the same @xmath69orbit if and only if they are homologous .",
    "we thus consider two homologous nonseparating curves @xmath14 and @xmath15 with homology class @xmath1193 , and ask when they are in the same @xmath76orbit .",
    "we first recall the theorem .      1 .   the nonseparating curves @xmath14 and @xmath15 are equivalent under @xmath11 .",
    "2 .   @xmath1194 .",
    "3 .   for some representatives @xmath31 of the curves @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_2(s)/\\gamma_3(s){\\cong}{\\textstyle{\\bigwedge}}^2 h_1(s)$ ] lies in the subspace @xmath28 .",
    "4 .   for any representatives",
    "@xmath33 of @xmath14 and @xmath15 , @xmath32\\in \\gamma_2(s)/\\gamma_3(s){\\cong}{\\textstyle{\\bigwedge}}^2 h_1(s)$ ] lies in @xmath28 .",
    "the hardest step will be to prove that ( 3 @xmath1195 1 ) , and this is where the results of this paper are required . to simplify the proof , we introduce two equivalent restatements of condition 2 . fix @xmath1196 satisfying @xmath1197 .",
    "this induces a direct splitting @xmath1198 , which induces the decomposition ( the second summand is embedded by @xmath1199):@xmath1200 then the four conditions above are also equivalent to the following two conditions .        the dehn twist @xmath62 acts on @xmath1206 by the transvection @xmath1207 defined by @xmath1208 .",
    "since @xmath63 also acts on @xmath1206 by @xmath1209 , we always have @xmath1210 .",
    "it was known to johnson  @xcite that for any homologous nonseparating curves @xmath14 and @xmath15 there exists @xmath1201 satisfying @xmath1202 .",
    "given such a @xmath1201 , we can write @xmath1211 .",
    "since @xmath79 is @xmath3equivariant ( lemma  [ lem : equivariance ] ) , we have @xmath1212 and thus @xmath1213      * ( 2 @xmath1216 5 ) .",
    "*   given @xmath712 so that @xmath1202 , implies that @xmath1217 so we must identify @xmath1218 .",
    "the transvection @xmath1209 acts as the identity on @xmath1219 , so @xmath1220 acts by 0 on the first summand @xmath1221 of . on the second summand , since @xmath1222 we have @xmath1223 . since @xmath1206 is torsion - free , the kernel of the map @xmath1224 given by @xmath1225 is precisely @xmath1226 .",
    "we conclude that @xmath1227 , as desired . *",
    "( 5 @xmath1216 6 ) . *   under the isomorphism @xmath1228 , the projection of @xmath1229 onto the summand @xmath1230 of the latter group is precisely @xmath1231 .",
    "moreover , this projection vanishes on the summand @xmath1221 of , and restricts to an isomorphism from the summand @xmath1232 of to @xmath1233 .",
    "it follows that any @xmath1234 satisfies @xmath1235 , and moreover that @xmath810 lies in @xmath1236 if and only if @xmath1237 .    * ( 4 @xmath1195 6 @xmath1195 3 ) .",
    "*   choose a representative @xmath1238 of @xmath14 .",
    "given @xmath1201 satisfying @xmath1202 , let @xmath1239 be the resulting representative of @xmath15 .",
    "since @xmath140 represents @xmath1193 we may compute @xmath1240 by @xmath1241=[\\delta\\gamma^{-1}]=-[\\gamma\\delta^{-1}]\\in n(s){\\cong}{\\textstyle{\\bigwedge}}^2 h(s).\\ ] ] condition 6 states that @xmath1205 , so we have @xmath32\\in a\\wedge a^\\perp \\subset a\\wedge h(s)$ ] , verifying condition 3 .",
    "conversely , condition 4 states that any representatives @xmath1242 satisfy @xmath32\\in a \\wedge h(s)$ ] , so @xmath1243 .",
    "we noted in the previous paragraph that @xmath1240 always lies in @xmath1244 , so we conclude that @xmath1205 , verifying condition 6 .    *",
    "( 3 @xmath1195 4 ) . *   fix representatives @xmath140 and @xmath486 of the curves @xmath14 and @xmath15 .",
    "any other representative @xmath1245 of the same curve @xmath15 satisfies @xmath1246 for some @xmath1247 .",
    "the difference between @xmath105 and @xmath1248 is thus equal modulo @xmath1249 to @xmath1250 $ ] , which corresponds to @xmath1251 $ ] under the identification @xmath1252 .",
    "the same argument applies to @xmath140 , and so we conclude that the class @xmath32 $ ] is well - defined modulo @xmath28 . in particular , if @xmath32\\in a\\wedge h_1(s)$ ] , then any other representatives @xmath754 and @xmath1245 satisfy @xmath1253\\in a\\wedge h_1(s)$ ] as well .    *",
    "( 5 @xmath1195 1 ) .",
    "*   given two homologous nonseparating curves @xmath14 and @xmath15 , choose @xmath1201 satisfying @xmath1202 .",
    "condition 4 tells us that @xmath718 lies in @xmath1254 .",
    "our goal will be to show that there exists @xmath1255 satisfying @xmath1256 , since then @xmath1257 satisfies @xmath1258 and @xmath1259 , and this demonstrates that @xmath14 and @xmath15 are equivalent under @xmath76 .",
    "we thus need to show that @xmath1260 is all of @xmath1261 .",
    "we do this by considering @xmath16 as a partitioned subsurface of @xmath4 .",
    "formally , let @xmath1262 where @xmath1263 is of the form @xmath1264 and @xmath1027 .",
    "there is a natural inclusion @xmath1265 as the complement of a regular neighborhood of @xmath14 . any mapping class stabilizing @xmath14 lifts ( non - uniquely ) to @xmath1266 .",
    "conversely , extension by the identity gives a surjection @xmath1267 . by paris ",
    "rolfsen  ( * ? ? ?",
    "* theorem 4.1(iii ) ) , the kernel of this surjection is cyclic , generated by @xmath1268 . note that @xmath1269 , so @xmath1270 surjects to @xmath1271 .",
    "let @xmath147 be the boundary component of @xmath1272 corresponding to @xmath1273 .",
    "by theorem  [ thm : ws ] , noting that @xmath1274 , the short exact sequence becomes : @xmath1275    by the naturality proved in theorem  [ thm : commutes ] , @xmath1276 is the image of the map @xmath1277 that sends @xmath1278 and is the identity on other factors .",
    "but the kernel of this map restricted to @xmath1279 is quite small , since condition ( ii ) of definition  [ def : ws ] implies @xmath1280 .",
    "in particular , this means @xmath1281 can not be 0 unless @xmath1282 for some @xmath1283 . and",
    "indeed @xmath1284 by proposition  [ prop : bp ] , and this element certainly lies in the kernel of @xmath353 , so the kernel of @xmath353 is the cyclic subgroup spanned by @xmath1285 . under this projection",
    "the first factor @xmath1286 of is mapped isomorphically to @xmath1287 of .",
    "the other factor @xmath1219 of is represented by @xmath1288 , and by theorem  [ thm : commutes ] this factor is mapped by @xmath1289 , and this is a surjection onto @xmath1290 inside the factor @xmath1291 of .      as before we take @xmath0 and @xmath277 , and now consider separating curves in @xmath4 .",
    "a separating curve @xmath14 has a canonical orientation , by taking the boundary @xmath5 to be on the right side of @xmath14 .",
    "the curve @xmath14 separates @xmath4 into two components @xmath204 and @xmath1292 , where @xmath1292 contains @xmath5 , and we define @xmath1293 to be the subspace of @xmath1206 spanned by @xmath1294 ; this induces an orthogonal splitting @xmath1295 .",
    "johnson  ( * ? ? ?",
    "* theorem 1a ) proved that two separating curves @xmath14 and @xmath15 are in the same @xmath69orbit if and only if the subspaces @xmath1296 and @xmath1297 coincide .",
    "we thus consider two separating curves @xmath14 and @xmath15 with @xmath1298 , and ask when they are in the same @xmath76orbit .",
    "recall from proposition  [ prop : tbracket ] that the map @xmath1299 induced by the commutator bracket has kernel @xmath1300 .",
    "let @xmath58 denote the subspace of @xmath1301 which is the image under @xmath1048 of the subspace @xmath1302 ( we will see below that @xmath1048 is injective on this subspace ) . here",
    "@xmath1303 represents the restriction of the symplectic form @xmath52 to the symplectic subspace @xmath53 .      1 .   the separating curves @xmath14 and @xmath15 are equivalent under @xmath11 .",
    "2 .   the separating twists @xmath62 and @xmath63 are conjugate in @xmath11 .",
    "3 .   for some representatives @xmath31 of the curves @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_3(s)/\\gamma_4(s)$ ] lies in the subspace @xmath58 .",
    "4 .   for any representatives",
    "@xmath33 of @xmath14 and @xmath15 , the class @xmath32\\in \\gamma_3(s)/\\gamma_4(s)$ ] lies in @xmath58 .    as before",
    ", it will be useful to establish an additional equivalent condition .",
    "the splitting @xmath1304 induces a decomposition @xmath1305 let @xmath1306 denote the subspace of @xmath1307 spanned by @xmath1308 for @xmath1309 . in the decomposition , @xmath1306 is contained in the third factor .",
    "in contrast with the nonseparating case , any representative @xmath140 of @xmath14 is trivial in homology , so there is no reason _ a priori _ that @xmath1312 should be related to @xmath718 .",
    "the following lemma , which is fundamental to the proof of theorem  [ thm : introseparating ] , shows that in fact @xmath1312 captures a significant portion of @xmath718 .",
    "since @xmath14 is separating , any representative @xmath140 lies in @xmath24 , and corollary  [ cor : torlttrivial ] implies that @xmath1102=[\\gamma]\\in { \\mathcal{l}}_2(s)$ ] for any @xmath1201 .",
    "thus @xmath1313 and we may consider its class @xmath1314\\in { \\mathcal{l}}_3(s)$ ] .",
    "[ lem : composition ] the homomorphism @xmath1315 defined by @xmath1316\\in { \\mathcal{l}}_3(s)$ ] is equal to the composition @xmath1317 here @xmath1318 simply restricts the homomorphism @xmath810 to the subspace @xmath1319 , and as before @xmath1320 is the lie bracket .    choose a basis @xmath38 for @xmath1321 with homology classes @xmath41 so that the subset @xmath1322 forms a symplectic basis for @xmath53 and @xmath1323\\cdots[\\alpha_k,\\beta_k]$ ] .",
    "( for future reference , this implies that @xmath179=\\omega_v\\in { \\mathcal{l}}_2(s){\\cong}{\\textstyle{\\bigwedge}}^2 h(s)$ ] . )",
    "we compute @xmath1324 $ ] just as in the proof of theorem  [ thm : wscontained ] . set @xmath1325 and note that @xmath1326 for all @xmath1327",
    "we compute : @xmath1328\\right )    & = \\prod_{i=1}^k[{\\varphi}(\\alpha_i),{\\varphi}(\\beta_i)]\\\\    & = \\prod_{i=1}^k[\\alpha_i\\eta_{\\varphi}(\\alpha_i),\\beta_i\\eta_{\\varphi}(\\beta_i)]\\\\    & \\equiv \\prod_{i=1}^k[\\alpha_i,\\beta_i ] [ \\alpha_i,\\eta_{\\varphi}(\\beta_i ) ]      [ \\eta_{\\varphi}(\\alpha_i),\\beta_i ] \\bmod{\\gamma_4(s)}\\\\    & \\equiv    \\left(\\prod_{i=1}^k[\\alpha_i,\\eta_{\\varphi}(\\beta_i ) ]     [ \\eta_{\\varphi}(\\alpha_i),\\beta_i]\\right)\\cdot\\gamma\\bmod{\\gamma_4(s)}\\end{aligned}\\ ] ] thus @xmath1324\\in \\gamma_3(s)/\\gamma_4(s)$ ] is represented by @xmath1329[\\eta_{\\varphi}(\\alpha_i),\\beta_i]$ ] . since @xmath870 and @xmath1330 represent @xmath873 and @xmath1331 , we see that@xmath1332 the element @xmath1333 represents the homomorphism @xmath1334 defined by @xmath1335 and this is precisely the restriction of @xmath718 to @xmath53 .",
    "this shows that that @xmath1314\\in { \\mathcal{l}}_3(s)$ ] agrees with the composition @xmath1336 of , and completes the proof of the lemma .    *",
    "( 1 @xmath1216 2 ) .",
    "*   since @xmath14 and @xmath15 are separating , we have @xmath1337 and @xmath1338 by proposition  [ prop : st ] . for any @xmath182 satisfying @xmath1202",
    "we have @xmath1339 .",
    "thus there exists @xmath1340 satisfying @xmath1202 if and only if @xmath62 and @xmath63 are conjugate in @xmath11 .    *",
    "( 1 @xmath1195 3 ) . *",
    "if condition 1 holds , there exists @xmath1214 satisfying @xmath1202 .",
    "choose a representative @xmath140 of @xmath14 , and let @xmath1239 be the resulting representative of @xmath15 .",
    "lemma  [ lem : composition ] shows that @xmath32\\in { \\mathcal{l}}_3(s)$ ] can be computed as @xmath1336 . since @xmath1341 factors through the johnson homomorphism @xmath79 and @xmath1342",
    ", we conclude that @xmath32=0\\in { \\mathcal{l}}_3(s)$ ] .",
    "this shows that @xmath32\\in h_1(s)\\otimes \\omega_v$ ] for this choice of representatives @xmath140 and @xmath486 , verifying condition 3 .    *",
    "( 3 @xmath1195 4 ) . *   fix representatives @xmath140 and @xmath486 of the curves @xmath14 and @xmath15 .",
    "we saw in the proof of lemma  [ lem : composition ] that @xmath179=[\\delta]=\\omega_v\\in { \\mathcal{l}}_2(s){\\cong}{\\textstyle{\\bigwedge}}^2 h(s)$ ] .",
    "any other representative @xmath1245 satisfies @xmath1246 for some @xmath1247 .",
    "the difference between @xmath105 and @xmath1248 is thus equal modulo @xmath1343 to @xmath1250 $ ] , which represents @xmath1344\\otimes \\omega_v)$ ] in @xmath1301 .",
    "the same argument applies to @xmath140 , and so we conclude that the class @xmath32 $ ] is well - defined modulo @xmath58",
    ". thus if @xmath32\\in h_1(s)\\otimes \\omega_v$ ] , then any other representatives @xmath754 and @xmath1245 satisfy @xmath1253\\in h_1(s)\\otimes \\omega_v$ ] as well .    *",
    "( 4 @xmath1195 5 ) .",
    "*   let @xmath1345 be the composition @xmath1346 where @xmath1347 is the orthogonal projection @xmath1348 .",
    "the dualization @xmath1349 of @xmath1347 simply restricts a functional on @xmath1206 to the subspace @xmath53 : @xmath1350 it follows that @xmath1351 .    for any @xmath1201 with @xmath1202 , choose a representative @xmath140 of @xmath14 .",
    "lemma  [ lem : composition ] gives that @xmath1324 $ ] , but condition 2 states that @xmath1314\\in h_1(s)\\otimes \\omega_v$ ] , so we must have @xmath1352 . to prove that condition 2 implies condition 3 , it therefore suffices to show that when restricted to @xmath1353 , the preimage @xmath1354 under @xmath1345 of the subspace @xmath1355 is precisely @xmath1356 .",
    "we consider each factor of the decomposition in term .",
    "the embedding of @xmath1300 into @xmath1357 sends @xmath1188 to @xmath1358 .",
    "in particular , if @xmath1359 lie in @xmath1360 and thus vanish under @xmath1347 , the element @xmath1361 is annihilated by @xmath1362 .",
    "this shows that @xmath1363 .",
    "conversely , any @xmath1364 has @xmath1365 , so if @xmath1366 we have @xmath1367 .",
    "however , by proposition  [ prop : tbracket ] we have @xmath1368 .",
    "thus @xmath1369 , showing that @xmath1370 as well .",
    "if @xmath1364 while @xmath1371 , two terms of @xmath1372 are annihilated by @xmath1362 , leaving @xmath1373 .",
    "thus @xmath1374 . similarly ,",
    "if @xmath1309 and @xmath1375 , we have @xmath1376 .",
    "we therefore have @xmath1377+[v',[w , v]]$ ] . by the jacobi identity , this is equal to @xmath1378=-\\beta(w\\otimes v\\wedge v')$ ] .",
    "these two factors are thus embedded by applying @xmath1048 to @xmath1379 and @xmath1380 . since @xmath1368 is disjoint from these subspaces ,",
    "we conclude that @xmath1354 intersects these factor only in @xmath1306 .    *",
    "( 5 @xmath1195 1 ) . *   as before",
    ", our goal is to prove that @xmath1260 is equal to the subspace @xmath1381 of condition 3 . given this , we can choose any @xmath1201 with @xmath1202 .",
    "condition 3 states that @xmath1382 , so we can find @xmath1383 such that @xmath1384 . then @xmath1257 lies in @xmath76 and satisfies @xmath1258 , demonstrating that @xmath14 and @xmath15 are equivalent under @xmath76 .",
    "let @xmath206 and @xmath205 be the components of @xmath16 , where @xmath205 contains the basepoint .",
    "the partitioned surface @xmath206 has underlying surface @xmath46 , while the partitioned surface @xmath205 has underlying surface @xmath47 and the totally separated partition .",
    "the natural inclusions @xmath1385 and @xmath1386 induce natural identifications @xmath1387 and @xmath1388 .",
    "the stabilizer @xmath1389 decomposes as @xmath1390 the action of @xmath1391 on @xmath1206 is the identity on @xmath1360 , and that of @xmath1392 is the identity on @xmath53 .",
    "since @xmath1393 , we obtain a decomposition @xmath1394 since @xmath14 is separating , we have @xmath101 , so @xmath1260 is generated by @xmath1395 and @xmath1396 .",
    "theorem  [ thm : ws ] implies that that @xmath1397 , and definition  [ def : wsiota ] states that @xmath1398 is just the inclusion of @xmath1399 into @xmath1300 .",
    "since @xmath205 has the totally separating partition , theorem  [ thm : ws ] states that @xmath1400 , where the second factor is spanned by @xmath1401 .",
    "since @xmath1402 is homotopic to @xmath14 , and @xmath1403=\\omega_v\\in n(s)$ ] , definition  [ def : wsiota ] tells us that @xmath1404 embeds the first factor by the inclusion @xmath1405 , and the second factor by @xmath1406 .",
    "applying theorem  [ thm : commutes ] , we conclude that @xmath1260 is the subspace spanned by @xmath1407 and @xmath1408 , as desired .",
    "more care must be taken when considering orbits of separating curves and multicurves when the partition on @xmath67 is not totally separated .",
    "consider the lantern @xmath1409 depicted in figure  1 , but with partition given by @xmath1410 . here",
    "@xmath1411 are the three boundary components in the center and @xmath488 is the outer boundary component .",
    "the two curves @xmath1412 and @xmath1413 depicted in figure  1  are both @xmath132separating . the complementary components @xmath1414 and",
    "@xmath1415 of @xmath16 span the subspaces @xmath1416 and @xmath1417 respectively of @xmath1418 , and the complementary components @xmath1419 and @xmath1420 of @xmath17 determine the same subspaces .    nevertheless @xmath14 and @xmath15 do not lie in the same @xmath68orbit , as can be seen by considering the larger surface @xmath157 .",
    "the complementary components of @xmath1421 determine the subspaces @xmath1422 and @xmath1423 of @xmath71 , while the complementary components of @xmath1424 determine the subspaces @xmath1425 and @xmath1426 .",
    "this shows there is no element of @xmath1427 , and thus certainly no element of @xmath68 , taking @xmath14 to @xmath15 ."
  ],
  "abstract_text": [
    "<S> this paper has two main goals . </S>",
    "<S> first , we give a complete , explicit , and computable solution to the problem of when two simple closed curves on a surface are equivalent under the johnson kernel . </S>",
    "<S> second , we show that the johnson filtration and the johnson homomorphism can be defined intrinsically on subsurfaces and prove that both are functorial under inclusions of subsurfaces . </S>",
    "<S> the key point is that the latter reduces the former to a finite computation , which can be carried out by hand . in particular </S>",
    "<S> this solves the conjugacy problem in the johnson kernel for separating twists . using a theorem of putman , </S>",
    "<S> we compute the first betti number of the torelli group of a subsurface . </S>"
  ]
}