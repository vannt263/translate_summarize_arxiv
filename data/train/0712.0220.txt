{
  "article_text": [
    "the birthday paradox states that if @xmath4 items are sampled uniformly at random with replacement from a set of @xmath5 items , then , for large  @xmath6 with high probability , some items will be chosen twice .",
    "this can be interpreted as a statement that with high probability , a markov chain on the complete graph @xmath7 with transitions @xmath8 will intersect its past in @xmath4 steps ; we refer to such a self - intersection as a _ collision _ and say the `` _ _ collision time _ _ '' is @xmath9 .",
    "miller and venkatesan generalized this in @xcite by showing that for a general markov chain , the collision time is bounded by @xmath10 where @xmath11 measures the time required for the @xmath12-step distribution to assign every state a suitable multiple of its stationary probability .",
    "kim , montenegro and tetali @xcite further improved the bound on collision time to @xmath13 .",
    "in contrast , while this shows the average path to be quickly self - intersecting , pak @xcite has shown that undirected regular graphs of large degree have a nonintersecting path of length @xmath14 .",
    "the motivation of @xcite was to study the collision time for a markov chain involved in pollard s rho algorithm for finding the discrete logarithm on a cyclic group @xmath0 of prime order @xmath15 . for this",
    "walk , @xmath16 , and so the results of @xcite are insufficient to show the widely believed @xmath17 collision time for this walk . in this paper",
    "we improve upon these bounds and show that if a finite ergodic markov chain has uniform stationary distribution over @xmath5 states , then @xmath9 steps suffice for a collision to occur as long as the relative - pointwise distance ( @xmath18 of the densities of the current and the stationary distribution ) drops steadily _ early _ in the random walk ; it turns out that the precise mixing time is largely , although not entirely , unimportant",
    ". see theorem [ theorem : birthday ] for a precise statement .",
    "this is then applied to the rho walk to give the first proof of collision in @xmath17 steps , matching shoup s lower bound @xcite on time required for any probabilistic generic algorithm to solve this problem , and to van oorschot and wiener s @xcite parallel version of the algorithm on @xmath2 processors to prove collision in @xmath19 steps .",
    "we note here that it is also well known ( see , e.g. , @xcite , section 4.1 ) that a random walk of length @xmath20 contains roughly @xmath21 samples from the stationary measure ( of the markov chain ) where @xmath22 is the spectral gap of the chain .",
    "this yields another estimate on collision time for a markov chain which is also of a multiplicative nature ( namely , @xmath23 _ times _ a function of the mixing time ) as in @xcite .",
    "a main point of the present work is to establish sufficient criteria under which the collision time has an _ additive _ bound : @xmath4 plus an estimate on the mixing time .",
    "while the rho algorithm provided the main motivation for the present work , we find the more general birthday paradox result to be of independent interest , and , as such , expect to have other applications in the future .",
    "a bit of detail about the pollard rho algorithm is in order .",
    "the classical discrete logarithm problem on a cyclic group deals with computing the exponents , given the generator of the group ; more precisely , given a generator @xmath24 of a cyclic group @xmath0 and an element @xmath25 , one would like to compute @xmath26 efficiently . due to its presumed computational difficulty , the problem figures prominently in various cryptosystems , including the diffie  hellman key exchange , el gamal system and elliptic curve cryptosystems .",
    "about 30 years ago , j. m. pollard suggested algorithms to help solve both factoring large integers @xcite and the discrete logarithm problem @xcite .",
    "while the algorithms are of much interest in computational number theory and cryptography , there has been little work on rigorous analysis .",
    "we refer the reader to @xcite and other existing literature ( e.g. , @xcite ) for further cryptographic and number - theoretical motivation for the discrete logarithm problem .",
    "a standard variant of the classical pollard rho algorithm for finding discrete logarithms can be described using a markov chain on a cyclic group @xmath0 .",
    "while there has been no rigorous proof of rapid mixing of this markov chain of order @xmath27 until recently , miller and venkatesan @xcite gave a proof of mixing of order @xmath28 steps and collision time of @xmath29 , and kim , montenegro and tetali @xcite showed mixing of order @xmath30 and collision time of @xmath31 .",
    "in this paper we give the first proof of the correct @xmath1 collision time . by recent results of miller and venkatesan",
    "@xcite this collision will be nondegenerate and will solve the discrete logarithm problem with probability @xmath32 for almost every prime order @xmath33 , if the start point of the algorithm is chosen at random or if there is no collision in the first @xmath30 steps .",
    "the paper proceeds as follows .",
    "section [ sec : prelim ] contains some preliminaries , primarily an introduction to the pollard rho algorithm and a simple multiplicative bound on the collision time in terms of the mixing time . the more general birthday paradox for markov chains with uniform stationary distribution",
    "is shown in section [ sec : collision ] . in section [ sec : mixing ] we bound the appropriate constants for the rho walk and show the optimal collision time .",
    "we finish in section [ sec : parallel ] by proving similar results for the distinguished points method of parallelizing the algorithm .",
    "our intent in generalizing the birthday paradox was to bound the collision time of the pollard rho algorithm for discrete logarithm .",
    "as such , we briefly introduce the algorithm here . throughout the analysis in the following sections , we assume that the size @xmath34 of the cyclic group on which the random walk is performed is odd .",
    "indeed there is a standard reduction ( see @xcite for a very readable account and @xcite for a classical reference ) justifying the fact that it suffices to study the discrete logarithm problem on cyclic groups of _ prime _ order .",
    "suppose @xmath24 is a generator of @xmath0 , that is , @xmath35 .",
    "given @xmath36 , the discrete logarithm problem asks us to find @xmath26 such that @xmath37 .",
    "pollard suggested an algorithm on @xmath38 based on a random walk and the birthday paradox .",
    "a common extension of his idea to groups of prime order is to start with a partition of @xmath0 into sets @xmath39 , @xmath40 , @xmath41 of roughly equal sizes , and define an iterating function @xmath42 by @xmath43 if @xmath44 , @xmath45 if @xmath46 and @xmath47 if @xmath48 .",
    "then consider the walk @xmath49 .",
    "if this walk passes through the same state twice , say @xmath50 , then @xmath51 , and so @xmath52 and @xmath53 which determines @xmath26 as long as @xmath54 ( the nondegenerate case ) . hence , if we define a _ collision _ to be the event that the walk passes over the same group element twice , then the first time there is a collision it might be possible to determine the discrete logarithm .    to estimate the running time until a collision , one heuristic is to treat @xmath55 as if it outputs uniformly random group elements . by the birthday paradox ,",
    "if @xmath56 group elements are chosen uniformly at random , then there is a high probability that two of these are the same .",
    "teske @xcite has given experimental evidence that the time until a collision is slower than what would be expected by an independent uniform random process .",
    "we analyze instead the actual markov chain in which it is assumed only that each @xmath57 is assigned independently and at random to a partition @xmath39 , @xmath40 or @xmath41 . in this case , although the iterating function @xmath55 described earlier is deterministic , because the partition of @xmath0 was randomly chosen , then the walk is equivalent to a markov chain ( i.e. , a random walk ) , at least until the walk visits a previously visited state and a collision occurs .",
    "the problem is then one of considering a walk on the exponent of @xmath24 , that is , a walk @xmath58 on the cycle @xmath59 with transitions @xmath60 .    by assuming each @xmath57",
    "is assigned independently and at random to a partition , we have eliminated one of the key features of the pollard rho algorithm , space efficiency . however , if the partitions are given by a hash function , @xmath61 , which is sufficiently pseudo - random , then we might expect behavior similar to the model with random partitions .    while we are studying the time until a collision occurs",
    ", there is no guarantee that the first collision will be nondegenerate . if the first collision is degenerate then so will be all collisions as the algorithm becomes deterministic after the first collision .",
    "as mentioned in the introduction , we first recall a simple multiplicative bound on collision time from @xcite .",
    "the following proposition relates @xmath62 to the time until a collision occurs for any markov chain @xmath58 with uniform distribution on @xmath0 as the stationary distribution .",
    "[ prop : oldresult ] with the above definitions , a collision occurs after @xmath63 steps with probability at least @xmath64 , for any @xmath65 .",
    "let @xmath66 denote the first @xmath67 states visited by the walk . if two of these states are the same then a collision has occurred , so assume all states are distinct . even if we only check for collisions every @xmath62 steps ,",
    "the chance that no collision occurs in the next @xmath68 steps ( so consider @xmath69 semi - random states ) is then at most @xmath70 when @xmath71 , this is at most @xmath72 , as desired , and so at most @xmath73 steps are required for a collision to occur with probability at least @xmath64 .",
    "obtaining a more refined additive bound on collision time will be the focus of the next section . while the proof can be seen as another application of the well - known second moment method , it turns out that bounding the second moment of the number of collisions _ before _ the mixing time is somewhat subtle . to handle this",
    ", we use an idea from @xcite , who in turn credit their approach to @xcite .",
    "consider a finite ergodic markov chain @xmath58 with uniform stationary distribution @xmath74 ( i.e. , doubly stochastic ) , state space @xmath75 of cardinality @xmath76 , and let @xmath77 denote a particular instance of the walk . in this section",
    "we determine the number of steps of the walk required to have a high probability that a `` collision '' has occurred , that is , a self - intersection @xmath78 for some @xmath79 .",
    "a key notion when studying markov chains is the mixing time , or the time required until the probability of being at each state is suitably close to its stationary probability .",
    "the _ mixing time _ @xmath80 of a markov chain @xmath58 with stationary distribution @xmath74 is given by @xmath81    now some notation .",
    "fix some @xmath82 and integer @xmath83 .",
    "let the indicator function @xmath84 equal one if @xmath78 , and zero otherwise .",
    "define @xmath85 to be the number of times the walk intersects itself in @xmath86 steps where @xmath87 and @xmath88 are at least @xmath89 steps apart .",
    "also , for @xmath90 , let @xmath91 be the expected number of times a walk beginning at @xmath92 hits state @xmath93 in @xmath94 steps .",
    "finally , let @xmath95    to see the connection between these and the collision time , observe that @xmath96 where @xmath97 are i.i.d",
    ". copies of the chain , both having started at @xmath92 at time 0 , and @xmath98 denotes expectation . hence @xmath99 is the maximal expected number of collisions of two @xmath94-step i.i.d .",
    "walks of @xmath58 starting at the same state @xmath92 .",
    "likewise , @xmath100 is the same for the reversal @xmath101 where @xmath102 ( recall that the stationary distribution was assumed to be uniform ) .    the main result of this section is the following .    [ theorem : birthday ] consider a finite ergodic markov chain with uniform stationary distribution on a state space of size  @xmath5 .",
    "let @xmath94 be such that @xmath103 for some @xmath104 and every pair of states @xmath105 .",
    "after @xmath106 steps a collision occurs with a probability of at least @xmath64 , for any @xmath107 .    at the end of this section",
    "a slight strengthening of theorem [ theorem : birthday ] is shown at the cost of a somewhat less intuitive bound .",
    "in example [ ex : pre - mixing ] , near the end of this section , we present an example to illustrate the need for the pre - mixing term @xmath99 in theorem [ theorem : birthday ] .",
    "in contrast , very recently nazarov and peres @xcite proved a general bound for the birthday problem on any _ reversible _ markov chain on @xmath5 states : suppose that the ratio of the stationary measures of any two states is at most @xmath108 .",
    "then they show that for any starting state , the expected time until the chain visits a previously visited state is at most @xmath109 for some universal constant @xmath6 .",
    "in particular , this implies an expected collision time of @xmath9 for the simple random walk on an undirected graph on @xmath5 vertices , and so the pre - mixing term is not necessary when considering reversible walks .",
    "observe that if @xmath110 and @xmath111 , then the collision time is @xmath9 as in the standard birthday paradox . by lemma [ lem : quick - convergence ] , for this to occur it suffices that @xmath112 be sufficiently close to uniform after @xmath113 steps and that @xmath114 for all @xmath105 , for @xmath115 and some @xmath116 .",
    "more generally , to upper bound @xmath99 and @xmath117 it suffices to show that the maximum probability of being at a vertex decreases quickly .",
    "[ lem : quick - convergence ] if a finite ergodic markov chain has uniform stationary distribution , then @xmath118    if @xmath92 is such that equality occurs in the definition of @xmath99 , then @xmath119    the quantity @xmath117 plays the role of @xmath99 for the reversed chain , and so the same bound holds for @xmath117 but with @xmath120 .",
    "in particular , suppose @xmath121 for every @xmath122 and some @xmath123 .",
    "the sum @xmath124 and so if @xmath125 for every @xmath126 , then @xmath127 .",
    "the proof of theorem [ theorem : birthday ] relies largely on the following inequality which shows that the expected number of self - intersections is large with low variance :    [ lem : expectations ] under the conditions of theorem [ theorem : birthday ] , @xmath128 & \\geq & \\frac{m}{n } \\pmatrix{\\beta\\sqrt{n}+2\\cr 2 } , \\\\",
    "e[s^2 ] & \\leq & \\frac{m^2}{n^2}\\pmatrix{\\beta\\sqrt{n}+2\\cr 2}^2 \\biggl(1+\\frac{8\\max\\{a_t , a_t^*\\}}{m\\beta^2}\\biggr).\\end{aligned}\\ ] ]    proof of theorem [ theorem : birthday ] recall the standard second moment bound : using cauchy ",
    "schwarz , we have that @xmath129 = e\\bigl [ s \\mathbf{1}_{\\{s>0\\}}\\bigr ] \\leq e[s^2 ] ^{1/2 } e\\bigl [ \\mathbf{1}_{\\{s>0\\}}\\bigr]^{1/2},\\ ] ] and hence @xmath130 \\geq e [ s]^2/e [ s^2 ] .",
    "$ ] if @xmath131 , then by lemma [ lem : expectations ] , @xmath132 \\geq\\frac{m^2/m^2}{1+{(8\\max\\{a_t , a_t^*\\ } ) /(m\\beta^2 ) } } \\geq\\frac{m^2}{2m^2}\\ ] ] independent of the starting point .",
    "if no collision occurs in @xmath133 steps then @xmath134 as well , and so @xmath135\\leq \\mathsf{pr}[s=0]\\leq1-m^2/2m^2 $ ] .",
    "hence , in @xmath136 steps , @xmath137\\leq(1-m^2/2m^2)^k\\leq e^{-km^2/2m^2}.\\ ] ] taking @xmath138 completes the proof .",
    "proof of lemma [ lem : expectations ] we will repeatedly use the relation that there are @xmath139 choices for @xmath140 appearing in the summation for @xmath66 , that is , @xmath141 and @xmath142 .    now to the proof . the expectation @xmath143 $ ] satisfies @xmath144 & = & e \\sum_{i=0}^{\\beta\\sqrt{n } } \\sum_{j = i+2t}^{\\beta\\sqrt{n}+2 t } \\mathbf{1}_{\\{x_i = x_j\\ } } \\nonumber \\\\[-8pt]\\\\[-8pt ] & = & \\sum_{i=0}^{\\beta\\sqrt{n } } \\sum_{j = i+2t}^{\\beta\\sqrt{n}+2 t } e\\bigl [ \\mathbf{1}_{\\{x_i = x_j\\ } } \\bigr ] \\geq\\pmatrix{\\beta\\sqrt{n}+2\\cr 2 }   \\frac{m}{n}\\nonumber\\end{aligned}\\ ] ] because if @xmath145 , then @xmath146 similarly , @xmath147 when @xmath145 .    now for @xmath148 $ ] .",
    "note that @xmath149 & = & e\\biggl(\\sum_{i=0}^{\\beta\\sqrt{n } } \\sum_{j = i+2t}^{\\beta \\sqrt{n}+2 t } \\mathbf{1}_{\\{x_i = x_j\\}}\\biggr ) \\biggl ( \\sum_{k=0}^{\\beta\\sqrt{n } } \\sum_{l = k+2t}^{\\beta\\sqrt { n}+2 t } \\mathbf{1}_{\\{x_k = x_l\\}}\\biggr ) \\\\ & = & \\sum_{i=0}^{\\beta\\sqrt{n } } \\sum_{k=0}^{\\beta\\sqrt{n } } \\sum_{j = i+2t}^{\\beta\\sqrt{n}+2 t } \\sum_{l = k+2t}^{\\beta\\sqrt{n}+2 t } \\operatorname{prob}(x_i = x_j , x_k = x_l )   .\\end{aligned}\\ ] ] to evaluate this quadruple sum we break it into @xmath150 cases .",
    "[ ca1 ] suppose @xmath151",
    ". without loss , assume @xmath152 so that , in particular , @xmath153",
    ". then @xmath154\\\\[-8pt ] & & \\qquad \\leq \\operatorname{prob}(x_i = x_j ) \\max_{u , v } \\operatorname{prob}\\bigl(x_l = v \\mid x_{\\max\\{i , j , k\\ } } = u\\bigr ) \\nonumber \\\\ & & \\qquad\\leq \\operatorname{prob}(x_i = x_j ) \\frac{m}{n } \\leq\\biggl(\\frac{m}{n}\\biggr)^2.\\nonumber\\end{aligned}\\ ] ] the first inequality holds because @xmath155 is a markov chain and so given @xmath156 the walk at any time @xmath157 depends only on the state @xmath158 .",
    "[ ca2 ] suppose @xmath159 and @xmath160 . without loss , assume @xmath161 . if @xmath162 , then @xmath163 because @xmath164 , @xmath165 and @xmath166 for any @xmath69 because @xmath58 and hence also @xmath167 are stochastic matrices .",
    "if , instead , @xmath168 then essentially the same argument works , but with @xmath169 because @xmath58 and hence also @xmath167 are doubly - stochastic .",
    "[ ca3 ] finally , consider those terms with @xmath160 and @xmath170 . without loss ,",
    "assume @xmath161 . if @xmath171 , then @xmath172    the sum over elements with @xmath173 and @xmath174 is upper bounded as follows : @xmath175    the case when @xmath176 gives the same bound but with the observation that @xmath165 and with @xmath99 instead of @xmath177 .",
    "putting together these various cases we get that @xmath149 & \\leq & \\pmatrix{\\beta\\sqrt{n}+2\\cr 2}^2 \\biggl(\\frac { m}{n}\\biggr)^2 + 2 \\pmatrix{\\beta\\sqrt{n}+2\\cr 2 } \\frac{m}{n } a_t \\\\ & & { } + 2 \\pmatrix{\\beta\\sqrt{n}+2\\cr 2 } \\frac{m}{n } \\sqrt{a_t a_t^ * } .\\end{aligned}\\ ] ] the @xmath178 term is the total number of values of @xmath179 appearing in the sum for @xmath148 $ ] , and hence also an upper bound on the number of values in cases  [ ca1 ] and  [ ca2 ] . along with the relation @xmath180",
    "this simplifies to complete the proof .",
    "as promised earlier , we now present an example that illustrates the need for the pre - mixing term @xmath99 in theorem [ theorem : birthday ] .",
    "[ ex : pre - mixing ] consider the random walk on @xmath59 which transitions from @xmath181 with probability @xmath182 , and with probability @xmath183 transitions @xmath184 for a uniformly random choice of @xmath93 .",
    "heuristically the walk proceeds as @xmath181 for @xmath185 steps , then randomizes , and then proceeds as @xmath181 for another @xmath23 steps .",
    "this effectively splits the state space into @xmath186 blocks of size about @xmath23 each , so by the standard birthday paradox it should require about @xmath187 of these randomizations before a collision will occur , in short , about @xmath188 steps in total .    to see the need for the pre - mixing term , observe that @xmath189 while",
    "if @xmath190 , then we may take @xmath191 and @xmath192 in theorem [ theorem : birthday ] .",
    "so , whether @xmath193 or @xmath194 are considered , it will be insufficient to take @xmath195 steps .",
    "however , the number @xmath99 of collisions between two independent copies of this walk is about @xmath23 since once a randomization step occurs then the two independent walks are unlikely to collide anytime soon .",
    "our collision time bound says that @xmath196 steps will suffice which is the correct bound .",
    "a proper analysis shows that @xmath197 steps are necessary to have a collision with a probability of @xmath198 .",
    "conversely , when @xmath199 then @xmath200 , @xmath201 and @xmath202 , so by equation ( [ eqn : positive_prob ] ) , @xmath203 steps are sufficient to have a collision with a probability of at least @xmath198 .",
    "our upper bound is thus off by at most a factor of @xmath204 .",
    "we finish the section with a slight sharpening of theorem [ theorem : birthday ] .",
    "this will be used to improve the lead constant in our upcoming bound on collision time for the pollard rho walk .",
    "[ theorem : birthday2 ] consider a finite ergodic markov chain with uniform stationary distribution on a state space of size @xmath5 .",
    "let @xmath94 be such that @xmath103 for some @xmath104 and every pair of states @xmath105 .",
    "after @xmath205 steps a collision occurs with a probability of at least @xmath206 , independent of the starting state .",
    "we give only the steps that differ from before .",
    "first , in equation ( [ eqn : simplify - later ] ) , note that the triple sum after @xmath207 can be re - written as @xmath208 the original quadruple sum then reduces to @xmath209    for the case when @xmath210 and @xmath211 proceed similarly , then reduce , as in lemma  [ lem : quick - convergence ] , to obtain the upper bound , @xmath212 adding these two expressions gives an expression of at most @xmath213    the remaining two cases will add to the same bound , so effectively this substitutes the expression @xmath214 in place of a @xmath215 in the original theorem .    to simplify ,",
    "note that if @xmath216 for @xmath217 , then @xmath218\\\\[-9pt ] & \\leq & \\bigl(1+o(1)\\bigr)6ct^2 + \\frac{3d}{(1-d)^2 }   .\\nonumber\\end{aligned}\\ ] ]",
    "let us now turn our attention to the pollard rho walk for discrete logarithm . to apply the collision time result",
    "we will first show that @xmath219 decreases quickly in @xmath220 so that lemma [ lem : quick - convergence ] may be used .",
    "we then find @xmath94 such that @xmath221 for every @xmath222 .",
    "however , instead of studying the rho walk directly , most of the work will instead involve a `` block walk '' in which only a certain subset of the states visited by the rho walk are considered .",
    "let us refer to the three types of moves that the pollard rho random walk makes , namely @xmath223 and @xmath224 as moves of type  1 , type 2 and type 3 , respectively .",
    "in general , let the random walk be denoted by @xmath225 with @xmath226 indicating the position of the walk ( modulo @xmath5 ) at time @xmath227 .",
    "let @xmath228 be the first time that the walk makes a move of type 3 .",
    "let @xmath229 ( i.e. , the ground covered , modulo @xmath5 , only using consecutive moves of types 1 and 2 ) .",
    "more generally , let @xmath230 be the first time , since @xmath231 , that a move of type 3 happens , and set @xmath232 .",
    "then the _ block walk _",
    "@xmath233 is the walk @xmath234 .    by combining our birthday paradox for markov chains with several lemmas to be shown in this section ,",
    "we obtain the main result of the paper :    [ theorem : rho - collision ] for every choice of starting state , the expected number of steps required for the pollard rho algorithm for discrete logarithm on a group @xmath0 to have a collision is at most @xmath235    in order to prove this it is necessary to show that @xmath236 decreases quickly for the block walk .",
    "[ lem : rho - quick ] if @xmath237 , then for every @xmath222 the block walk satisfies @xmath238 if @xmath239 then @xmath240 .",
    "a bound on the asymptotic rate of convergence is also required :    [ theorem : asymptotics ] if @xmath241 where @xmath242 , then for every @xmath243 the block walk satisfies @xmath244    this is all that is needed to prove the main result :    proof of theorem [ theorem : rho - collision ] the proof will use theorem [ theorem : birthday2 ] because this gives a somewhat sharper bound .",
    "alternatively , theorem [ theorem : birthday ] and lemma [ lem : quick - convergence ] can be applied nearly identically to get the slightly weaker @xmath245 .",
    "first consider steps of the block walk .",
    "lemma [ lem : rho - quick ] implies that @xmath246 , for @xmath247 and for all @xmath105 .",
    "hence , by equation ( [ eqn : simplify - birthday2 ] ) , if @xmath248{n})$ ] , then @xmath249 . by theorem [ theorem :",
    "asymptotics ] , @xmath250 and @xmath251 after @xmath252 steps .",
    "hence , if @xmath253 , then @xmath254{n})$ ] , and @xmath255 , and @xmath256 . plugging this into theorem [ theorem : birthday2 ] , a collision fails to occur in @xmath257 steps with a probability of , at most , @xmath258 where @xmath259 .",
    "now return to the rho walk .",
    "recall that @xmath230 denotes the number of rho steps required for @xmath87 block steps .",
    "the difference @xmath260 is an i.i.d .",
    "random variable with the same distribution as @xmath261 .",
    "hence , if @xmath262 , then @xmath263 = ( i - j ) e[t_1-t_0]=3(i - j)$ ] .",
    "in particular , if we let @xmath264 , let @xmath265 denote the number of rho steps before a collision , and let @xmath266 denote the number of block steps before a collision , then @xmath267 & \\leq & \\sum_{k=0}^{\\infty } \\operatorname{pr}[b > kr ] e\\bigl[t_{(k+1)r}-t_{kr } \\mid b > kr\\bigr ] \\\\[-3pt ] & = & \\sum_{k=0}^{\\infty } \\operatorname{pr}[b > kr ] e\\bigl[t_{(k+1)r}-t_{kr}\\bigr ] \\\\[-3pt ] & \\leq & \\sum_{k=0}^{\\infty } \\biggl(\\frac{1+o(1)}{2}\\biggr)^k 3r = \\bigl(1+o(1)\\bigr ) 12\\sqrt{19 } \\sqrt{n } .\\vspace*{-8pt}\\end{aligned}\\ ] ]    proof of lemma [ lem : rho - quick ] we start with a weaker , but somewhat more intuitive , proof of a bound on @xmath236 and then improve it to obtain the result of the lemma",
    ". the key idea here will be to separate out a portion of the markov chain which is tree - like with some large depth @xmath20 , namely the moves induced solely by @xmath268 and @xmath269 moves . because of the high depth of the tree , the walk spreads out for the first @xmath20 steps , and hence the probability of being at a vertex also decreases quickly .",
    "let @xmath270 \\dvtx b_i\\in\\{0,1\\}\\}$ ] and @xmath271 be random variables whose values are determined by the first @xmath193 steps of the random walk . then @xmath272 .",
    "hence , choosing @xmath273 , @xmath274 , we may write @xmath275 and so for a fixed choice of @xmath66 , we can ignore what happens on @xmath276 .",
    "each @xmath277 $ ] has a unique binary expansion , and so if @xmath237 , then modulo @xmath5 each @xmath278 can still be written in , at most , one way as an @xmath220 bit string .",
    "for the block walk , @xmath279 and @xmath280 , and so @xmath281 .",
    "it follows that @xmath282 using independence of the @xmath283s .",
    "hence , @xmath284 the second inequality was because @xmath285 is decreasing in @xmath286 and so underestimating @xmath286 by assuming @xmath287 will only increase the upper bound on @xmath236 .    in order to improve on this",
    ", we will shortly redefine @xmath66 ( namely , events @xmath288 ) and auxiliary variables @xmath289 , using the steps of the rho walk .",
    "also note that the block walk is induced by a rho walk , so we may assume that the @xmath283 were constructed by a series of steps of the rho walk .",
    "with probability @xmath290 set @xmath291 and @xmath292 , otherwise if the first step is of type 1 , then set @xmath293 and @xmath294 while if the first step is of type 3 then put @xmath295 and @xmath292 , and finally if the first step is of type  2 , then again repeat the above decision making process , using the subsequent steps of the walk .",
    "note that the above construction can be summarized as consisting of one of four equally likely outcomes ( at each time ) where the last three outcomes depend on the type of the step that the rho walk takes ; indeed , each of these three outcomes happens with probability @xmath296 ; finally , a type 2 step forces us to reiterate the four - way decision - making process .    in summary , @xmath297 . also observe that @xmath298 and that @xmath299 .",
    "hence the steps done earlier ( leading to the weaker bound ) carry through with @xmath300 and with @xmath301 replaced by @xmath302 . in ( [ eqn : maxprob ] ) replace @xmath285 by @xmath303 , and in showing the final upper bound on @xmath236 , replace @xmath304 by @xmath305 .",
    "this leads to the bound @xmath306 .    finally , when @xmath239 , simply apply the preceding argument to @xmath307 $ ] .",
    "alternately , note that when @xmath308 , then @xmath309 for every doubly - stochastic markov chain @xmath310 .    in @xcite",
    "sufficiently strong bounds on the asymptotics of @xmath311 are shown in several ways , including the use of characters and quadratic forms , canonical paths and fourier analysis .",
    "we give here the fourier approach , as it establishes the sharpest mixing bounds . to bound mixing time of the block walk",
    ", it suffices to show that for large enough @xmath220 , the distribution @xmath312 of @xmath313 is close to the uniform distribution @xmath314 because then the distribution of @xmath315 will be close to uniform as well .",
    "more precisely , convergence in chi - square distance will be shown that    [ lem : fourier ] if @xmath316 $ ] , @xmath317 , and @xmath318 satisfies @xmath319 , then @xmath320    proof of theorem [ theorem : asymptotics ] by cauchy ",
    "schwarz , @xmath321\\\\[-8pt ] & & \\qquad = \\biggl| \\sum_w u(w ) \\biggl(\\frac{\\mathsf { b}^s(u , w)}{u(w)}-1 \\biggr)\\biggl(\\frac{\\mathsf{b}^{*s}(v , w)}{u(w)}-1\\biggr)\\biggr|^2\\nonumber \\\\ & & \\qquad \\leq \\sum_w u(w ) \\biggl|\\frac{\\mathsf{b}^s(u , w)}{u(w)}-1 \\biggr|^2 \\sum _ x u(x)\\biggl|\\frac{\\mathsf{b}^{*s}(v , x)}{u(x)}-1\\biggr|^2.\\nonumber\\end{aligned}\\ ] ] lemma [ lem : fourier ] bounds the first sum of ( [ eqn : cauchy - schwartz ] ) .",
    "the second sum is the same quantity but for the time - reversed walk @xmath322 . to examine the reversed walk let @xmath323 denote the sum of steps taken by @xmath324 between the @xmath325st and @xmath87th time that a @xmath326 transition is chosen ( i.e. , consider block steps for the reversed walk ) , and let @xmath327 .",
    "if we define @xmath328 , then the @xmath283 are independent random variables from the same distribution as the blocks of @xmath310 , and so @xmath329 & = & \\mathsf{pr}[b_1 + 2b_2+\\cdots + 2^{s-1}b_s = j ] \\\\ & = & \\mathsf{pr}[z_s = j ] .\\end{aligned}\\ ] ] lemma [ lem : fourier ] thus bounds the second sum of ( [ eqn : cauchy - schwartz ] ) as well , and the theoremfollows .    before proving lemma [",
    "lem : fourier ] let us review the standard fourier transform and the plancherel identity . for any complex - valued function @xmath330 on @xmath59 and @xmath331 , recall that the fourier transform @xmath332 is given by @xmath333 , and the plancherel identity asserts that @xmath334    for the distribution @xmath335 of a @xmath59-valued random variable @xmath336 , its fourier transform is @xmath337.\\ ] ] thus , given distributions @xmath338 of two independent random variables @xmath339 , the distribution @xmath340 of @xmath341 has the fourier transform @xmath342 , since    @xmath343 = e\\bigl [ \\omega^{\\ell(y_1+y_2)}\\bigr ] \\nonumber \\\\[-8pt]\\\\[-8pt ] & = & e [ \\omega^{\\ell y_1}]e [ \\omega^{\\ell y_2 } ] = \\hat{\\mu}_{_1 } ( \\ell)\\hat{\\mu}_{_2}(\\ell).\\nonumber\\end{aligned}\\ ] ]    generally , the distribution @xmath340 of @xmath344 with independent @xmath345s has the fourier transform @xmath346 .",
    "moreover , for the uniform distribution @xmath74 , it is easy to check that @xmath347 as the random variables @xmath348s are independent , @xmath349 where @xmath350 are the distributions of @xmath348 .",
    "the linearity of the fourier transform and @xmath351=1 $ ] yield @xmath352    proof of lemma [ lem : fourier ] by plancherel s identity , it is enough to show that @xmath353    let @xmath354 be the event that @xmath355 .",
    "then , @xmath356 \\\\ & = & \\mathsf{pr } [ b_{s - r}=0 ] + \\mathsf{pr}[b_{s - r}=1 ] \\omega^{\\ell 2^{r } } \\\\ & & { } + \\mathsf{pr } [ \\bar{a}_r ] e [ \\omega^{\\ell2^{r } b_{s - r}}| \\bar{a}_r],\\end{aligned}\\ ] ] and , for @xmath357 $ ] and @xmath358 $ ] , @xmath359| \\\\ & \\leq & | x + y \\omega^{\\ell2^{r } } | + 1-x - y .\\end{aligned}\\ ] ] notice that @xmath360 if @xmath361 , then @xmath362 since @xmath363 \\geq1/3 $ ] , and @xmath364\\geq1/9 $ ] , it is easy to see that @xmath365 has its minimum when @xmath366 and @xmath367 .",
    "( for both partial derivatives are positive . )",
    "hence , @xmath368 if @xmath369 , we use the trivial bound @xmath370 \\leq1 $ ] .    for @xmath371 ,",
    "let @xmath372 be the number of @xmath373 such that @xmath361 .",
    "then @xmath374 to estimate @xmath375 , we consider the binary expansion of @xmath376 @xmath377 with @xmath378 infinitely often .",
    "hence , @xmath379 .",
    "the fractional part of @xmath380 may be written as @xmath381 notice that @xmath382 if the fractional part of @xmath380 is ( inclusively ) between @xmath290 and @xmath383 which follows if @xmath384 . thus @xmath372 is at least as large as the number of alterations in the sequence @xmath385 .",
    "we now take @xmath318 such that @xmath319 .",
    "observe that , for @xmath386 , the subsequences @xmath387 of length @xmath318 are pairwise distinct : if @xmath388 for some @xmath389 then @xmath390 is less than @xmath391 which is impossible as @xmath392 . similarly , for fixed @xmath393 and @xmath394 , all subsequences @xmath395 are pairwise distinct . in particular , for fixed @xmath393 with @xmath396 , all subsequences @xmath397 , @xmath394 ,",
    "are pairwise distinct .",
    "since the fractional part @xmath398 must be the same as @xmath399 for some @xmath400 in the range @xmath401 , there is a unique permutation @xmath402 of @xmath403 such that @xmath404 .",
    "writing @xmath405 for the number of alternations in @xmath406 , we have @xmath407 where @xmath408 is the identity .",
    "therefore , ( [ phibd ] ) gives @xmath409    using @xmath410 inductively , the above upper bound may be maximized when all @xmath402s are the identity , that is , @xmath411 note that @xmath412 implies that @xmath413 is neither @xmath414 nor @xmath415 ( both are of length @xmath318 ) .",
    "this means that all @xmath413 have at least one alternation . since @xmath413s are pairwise distinct , @xmath416 where the sum is taken over all sequences @xmath417 with @xmath418 .",
    "let @xmath419 be the number of @xmath420s with exactly @xmath421 alterations .",
    "then @xmath422 and hence @xmath423    for the reader interested in applying these methods to show a birthday - type result for other problems , it is worth noting that a fourier approach can also be used to show that @xmath236 decreases quickly , and so @xmath424 .    for the distribution @xmath425 of @xmath426",
    "the plancherel identity gives @xmath427 & = & \\max_v \\nu_s ( v)^2 \\leq\\sum_{w=0}^{n-1 } \\nu_s ( w)^2 \\\\ & = & \\frac{1}{n}\\sum_{\\ell=0}^{n-1 } |\\hat{\\nu}_{s } ( \\ell)|^2 = \\frac{1}{n}\\sum_{\\ell=0}^{n-1 } \\biggl|\\prod_{r=0}^{s-1 } \\hat{\\mu}_r ( \\ell ) \\biggr|^2 .\\end{aligned}\\ ] ]    for @xmath428 , let @xmath429 be the number of @xmath373 such that @xmath430 .",
    "then @xmath431 take @xmath318 such that @xmath319 . then , for @xmath432 and any ( fixed ) binary sequence @xmath433 ( that is , @xmath434 ) , there are at most @xmath435 @xmath436s such that the binary expansion of @xmath437 up to @xmath220 digits is @xmath438 .",
    "since there are at most @xmath439 binary sequences with fewer than @xmath440 alterations , @xmath441 except for at most @xmath442 values of @xmath436 .",
    "using a trivial bound @xmath443 for such @xmath436 s , we have @xmath444 = 2e^{-\\omega(s ) } + 2e^{-\\omega(s ) } = 2e^{-\\omega(s)}.\\ ] ] if @xmath445 , then @xmath446 implies that @xmath444 = 2e^{-\\omega(m-1)}= o\\bigl(n^{-\\omega(1)}\\bigr).\\ ] ]    one might expect that the correct order of the mixing time of the block walk @xmath426 is indeed @xmath447 .",
    "this is in fact the case , at least for certain values of @xmath448 and @xmath26 .",
    "[ theorem : lower - bound ] if @xmath449 and @xmath450 , then the block walk has mixing time @xmath451 .",
    "the upper bound on mixing time , @xmath452 , was shown in theorem [ theorem : asymptotics ] via a fourier argument .",
    "the proof of a lower bound of @xmath453 is modeled after an arguments of hildebrand @xcite which in turn closely follows a proof of chung , diaconis and graham @xcite .",
    "the basic idea is by now fairly standard : choose a function and show that its expectation under the stationary distribution and under the @xmath12-step distribution @xmath454 are far apart with sufficiently small variance to conclude that the two distributions ( @xmath454 and @xmath455 ) must differ significantly .",
    "theorem [ theorem : lower - bound ] is not used in main results of this paper , and the proof is fairly long , and so it is left for the .",
    "the rho algorithm can be parallelized to  @xmath2 processors via the distinguished points method of van oorschot and wiener @xcite . to do this ,",
    "start with a global choice of ( random ) partition @xmath456 ( i.e. , a  common iterating function @xmath55 ) , and choose @xmath2 initial values @xmath457 from @xmath59 , one per processor . then run the rho walk on processor @xmath88 starting from initial state @xmath458 , until a collision occurs between either two walks or a walk and itself . to detect a collision",
    "let @xmath459 be an easily computed hash function with support @xmath460 to be called the _",
    "distinguished points_. each time a distinguished point is reached by a processor , it is sent to a central repository and compared against previously received states . once a distinguished point is reached twice then",
    "a collision has occurred , and the discrete logarithm can likely be found while , conversely , once a collision occurs , the collision will be detected the next time a distinguished point is reached .",
    "the proofs in previous sections immediately imply a factor of @xmath2 speed up when parallelizing . to see this ,",
    "suppose the initial values @xmath457 are chosen uniformly at random .",
    "run a rho walk for some @xmath461 steps per processor , and then define @xmath462 by starting with the rho walk of processor @xmath463 , then appending that from processor @xmath464 , etc .",
    "; that is , if @xmath465 denotes the @xmath87th state of copy @xmath88 of the walk , for @xmath466 and @xmath467 , then @xmath468 for @xmath469 .",
    "this is a time - dependent random walk which follows the rho walk , except at multiples of time @xmath470 where it instead jumps to a uniformly random state .",
    "since our proofs involve pessimistic estimates on the distance of a distribution from uniform , and these jumps result in uniform samples , then they can only improve the result .",
    "hence this effectively leads to a rho walk with @xmath471 steps , and a factor  @xmath2 speed - up per processor is achieved .",
    "if the initial values were not uniform then discard the first @xmath472 steps per processor and treat the next state as the initial value which by theorem [ theorem : asymptotics ] will give a nearly uniform start state .",
    "proof of theorem [ theorem : lower - bound ] our approach follows that taken in section 4 of hildebrand @xcite , `` a  proof of case 2 . ''",
    "recall that we will show that @xmath473 and @xmath474 are far apart for some function @xmath330 with sufficiently small variance to conclude that the two distributions ( @xmath454 and the uniform distribution @xmath74 on @xmath475 ) must differ significantly .",
    "more precisely let @xmath476 be the distribution of the block walk on @xmath475 starting at state @xmath477 and proceeding for @xmath12 steps .",
    "for some @xmath478 , let @xmath479 by chebyshev s inequality , @xmath480 .",
    "also , for some @xmath83 let @xmath481 by chebyshev s inequality , @xmath482 . if @xmath483 , then @xmath484 , and so @xmath485 if @xmath486 for a sequence @xmath487 , then as @xmath488 it is possible to choose @xmath489 such that @xmath490 .",
    "the theorem then follows as @xmath491 .",
    "the `` separating '' function @xmath492 to be used here is @xmath493    then @xmath494 since @xmath495 is a primitive root of unity when @xmath448 is prime and @xmath496 .",
    "likewise , @xmath497 by the orthogonality relationship of roots of unity .",
    "it follows that @xmath498 .",
    "the block walk on @xmath499 with @xmath500 steps will be considered where @xmath501 will be chosen later .",
    "let @xmath502 denote the distribution of @xmath503 induced by @xmath12 steps of the block walk starting at state @xmath477 .",
    "a generic increment will be denoted by @xmath504 , since the @xmath283 are independent random variables from the same distribution",
    ".    it will be useful to introduce a bit of notation .",
    "if @xmath505 and @xmath506 , then define @xmath507=\\mathsf { \\operatorname{pr}}[b = y2^{-\\alpha } ] .\\ ] ]    recall the fourier transform of a distribution @xmath340 on @xmath508 is given by @xmath509 .",
    "properties of certain fourier transforms are required in our work .",
    "first , since @xmath510 then @xmath511 for @xmath512 , and so @xmath513 . by this and ( [ eqn : convolution ] ) , if @xmath506 , then @xmath514 also , @xmath515 , and so @xmath516 finally , for @xmath517 , define @xmath518 note that @xmath519 because @xmath520 when the step sizes are @xmath521 . also , @xmath522 because , modulo @xmath448 , @xmath523 , and so @xmath524 .    now turn to mean and variance : @xmath525 likewise , @xmath526    it follows that @xmath527    to apply these relations in chebyshev s inequality the quantities @xmath528 need to be examined further .",
    "let @xmath504 denote the increment taken but with arithmetic not done modulo @xmath448 , so that @xmath529 is possible , that is , repeatedly decide with probability @xmath530 whether to terminate and if not then flip a coin and decide whether to add @xmath531 or @xmath532 .",
    "let @xmath533 $ ] , and note that also @xmath534 $ ] since the nondoubling steps are symmetric , that is , @xmath181 and @xmath535 .",
    "then @xmath536 satisfies the recurrence relation @xmath537 which has solution @xmath538 . for @xmath539 ,",
    "let @xmath540 since @xmath541=\\mathsf{\\operatorname{pr}}[b2^{\\alpha } \\equiv k \\operatorname{mod } p]=\\sum_{\\{b : b2^\\alpha\\equiv k \\operatorname{mod } p\\ } } a_b,\\ ] ] then @xmath542    we can now show the necessary bounds . recall that @xmath500 for some sequence @xmath543 to be defined .",
    "let @xmath544 be a sequence such that @xmath545 , @xmath546 , and @xmath547 is an integer .",
    "such a sequence will exist if @xmath548 is bounded away from @xmath549 .",
    "[ c1 ] @xmath548 is bounded away from @xmath549 and @xmath550 as @xmath551 .",
    "first , a few preliminary calculations are necessary . if @xmath552 $ ] , then @xmath553 also , since @xmath539 , then @xmath554 with equality at @xmath555 . and , since the first derivative satisfies the relation @xmath556 , then @xmath557 for @xmath558 .",
    "to show that @xmath559 is bounded away from @xmath550 observe that @xmath560    to bound @xmath559 away from @xmath549 note that since @xmath561 is decreasing for @xmath552 $ ] , then @xmath562 the final inequality used the relation is @xmath563 .",
    "@xmath564 .",
    "since @xmath548 is bounded away from @xmath549 and @xmath550 , then @xmath565 the claim follows as @xmath566 and @xmath567 .",
    "@xmath568 .",
    "assume @xmath569 then the claim follows from @xmath570    hildebrand @xcite requires @xmath571 pages ( pages 351354 ) to prove the assumption , albeit for a different function @xmath561 .",
    "fortunately we do not need to rework his proof as it does not make explicit use of @xmath561 but instead depends on only a few properties of it .",
    "there are two facts required in his proof .",
    "first , he shows the following :    there is some @xmath572 such that if @xmath573 , then @xmath574 for all @xmath575 .",
    "hildebrand s proof of this utilizes the following properties : @xmath576 , @xmath561 is decreasing when @xmath577 $ ] , and @xmath578 is decreasing in [ this corrects an error where he should have claimed @xmath579 instead of @xmath580 .",
    "these conditions apply to our choice of @xmath561 as is shown in the proof of our claim [ c1 ] .",
    "the second necessary tool is the following :    there exists constants @xmath581 such that for @xmath582 and @xmath583 , then @xmath584    hildebrand s proof utilizes the following properties : @xmath585 , @xmath586 , and @xmath587 for all @xmath588 and some @xmath589 .",
    "all three conditions were shown in the proof of our claim [ c1 ] , and so his argument will carry through .",
    "the two facts can now be combined to finish the proof .",
    "let @xmath69 be sufficiently large that @xmath590 which is possible as @xmath591 .",
    "recalling that @xmath522 , then @xmath592 since @xmath593 , then @xmath594    in the other direction , since @xmath595 , then @xmath596 .",
    "the authors thank s.  kijima , s.  miller , i.  mironov , r.  venkatesan and d.  wilson for several helpful discussions .",
    "( ) . _ reversible markov chains and random walks on graphs_. available at http://www.stat.berkeley.edu/users/aldous/rwg/book.html[http://www.stat.berkeley.edu/users/aldous/rwg/book . ] http://www.stat.berkeley.edu/users/aldous/rwg/book.html[html ] ."
  ],
  "abstract_text": [
    "<S> we show a birthday paradox for self - intersections of markov chains with uniform stationary distribution . as an application , we analyze pollard s rho algorithm for finding the discrete logarithm in a cyclic group @xmath0 and find that if the partition in the algorithm is given by a random oracle , then with high probability a collision occurs in @xmath1 steps . </S>",
    "<S> moreover , for the parallelized distinguished points algorithm on @xmath2 processors we find that @xmath3 steps suffices . </S>",
    "<S> these are the first proofs of the correct order bounds which do not assume that every step of the algorithm produces an i.i.d . </S>",
    "<S> sample from @xmath0 .    ,    , +    .    . </S>"
  ]
}