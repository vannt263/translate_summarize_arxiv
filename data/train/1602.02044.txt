{
  "article_text": [
    "radial velocity and transit surveys have transformed our understanding of the universe by detecting thousands of planets outside our solar system .",
    "dozens of these known exoplanets are close enough to image directly , which would allow us to obtain their spectra and fully determine their orbital parameters .",
    "direct imaging requires high contrast in the image , factors of @xmath0 or more for earth - size planets or @xmath1 for neptune and jupiter analogs .",
    "atmospheric turbulence precludes obtaining such high contrast from the ground , so a space - based observatory is necessary .",
    "the proposed coronagraph instrument ( cgi ) on the wide - field infrared survey telescope - astrophysics focused telescope asset ( wfirst - afta ) is expected to image about 16 known cool gas - giant exoplanets and spectrally characterize about 6 of them.@xcite a coronagraph uses a series of apodizers , masks , and stops in the optical train to modify or remove the point spread function ( psf ) of the telescope and create image plane regions of high contrast where an exoplanet can be seen .",
    "the optics for a coronagraph can not be manufactured to the smoothness and reflectivity requirements to obtain @xmath2 or better planet - to - star contrast passively.@xcite a set of deformable mirrors ( dms ) is necessary to mitigate these aberrations and recover a high - contrast region called a dark hole .",
    "the cgi on wfirst - afta will be equipped with two coronagraph types and two dms , making it the first high - contrast coronagraphic mission in space with high - actuator - count wavefront control .",
    "wavefront correction for high - contrast coronagraphy differs from the method regularly used in astronomy . in traditional adaptive optics ,",
    "the wavefront phase is measured at a pupil and conjugated by a dm .",
    "that approach is inadequate for generating high contrast ; a non - flat pupil phase is acceptable as long as the starlight destructively interferes in the image .",
    "in addition , uncontrollable , high - spatial frequencies in the pupil phase can mix and move light into the dark hole even if all correctable spatial frequencies are eliminated by the dms . finally ,",
    "amplitude aberrations degrade contrast and can not be mitigated with just phase conjugation . as a result ,",
    "the wavefront control approach being planned for extreme high contrast in space relies on correction in the focal plane .",
    "this requires forming an estimate of the focal plane electric field and then finding a dm command to improve the contrast .",
    "the main challenge of focal plane wavefront correction with a high - contrast coronagraph is to sense the wavefront quickly .",
    "the most efficient correction routines need an estimate of the stellar electric field .",
    "a wavefront sensor can not be used ( alone ) because it estimates only the phase and introduces non - common - path aberrations .",
    "the science camera is the only common - path sensor available , but exposure times can become very long as the contrast gets higher and the signal becomes fainter .",
    "several techniques , all of which require one or more extra images for the estimator , exist for creating focal plane intensity diversity to calculate the electric field . the self - coherent camera ( scc)@xcite is an estimation technique for coronagraphs with focal plane phase masks .",
    "pinholes outside the nominal beam radius at the lyot stop produce an interference pattern in the image that is used to calculate the electric field .",
    "another technique is coronagraphic focal - plane wave - front estimation for exoplanet detection ( coffee),@xcite which utilizes a maximum a posteriori approach to estimate pupil plane aberrations and the bias signal .",
    "coffee introduces large phase aberrations at the dm to create diversity in the image plane . in this paper",
    ", we use the most tested and widely applicable estimation technique in which small , pair - wise probes are actuated on the dm to create image plane diversity.@xcite    high - contrast wavefront correction is an iterative process . with each electric field estimate",
    ", the controller suppresses as much starlight as possible in the dark hole .",
    "the contrast is then re - measured and more correction iterations are used until sufficiently high contrast is reached .",
    "our prior work utilized a kalman filter ( kf ) to estimate the stellar electric field recursively during wavefront correction . in this paper , we explore the use of a nonlinear filter , the extended kalman filter ( ekf ) , to estimate recursively both the stellar electric field and the intensity bias during wavefront correction .",
    "science targets such as exoplanets and disks will be incoherent with a star , so they will appear in the bias estimate .",
    "therefore , nonlinear , recursive wavefront correction lets us build the best possible real - time estimate of our potential science targets while recovering high contrast .",
    "the kf and ekf formalisms used in this paper are equally applicable to the scc , and coffee could be easily modified to allow recursive estimation .",
    "the recursive estimation techniques in this paper are discussed in the context of space - based observatories but may also apply to some ground telescopes , in particular those with extreme adaptive optics .",
    "if an observatory and the wavefront are stable enough for focal plane wavefront correction to function , then kalman filtering should still be able to improve wavefront estimation by accounting for the model uncertainty of the system .",
    "nonlinear estimation of the wavefront and bias is less robust to large uncertainties , however , and is most likely better suited for ultra - stable space telescopes .",
    "in this section we describe the current progress in focal plane wavefront estimation and control .",
    "a longer discussion can be found in the paper by groff et al .",
    "@xcite in this issue .",
    "we re - derive important results to pose the problem and to establish the mathematical framework for the ekf derivation in section [ sec : recursive ] .",
    "the first successful controller for focal plane wavefront correction was speckle nulling.@xcite in this estimation - free scheme , sinusoids with different phases are applied to the dm to suppress stellar speckles at the targeted spatial frequency .",
    "speckle nulling requires many hundreds or thousands of correction iterations , too many for use in a space mission .",
    "model - based estimation and control enables faster correction .",
    "the first model - based controller was electric field conjugation ( efc).@xcite efc minimizes energy in the dark hole and uses tikhonov regularization to prevent too large of a command from being sent to the dms .",
    "because the electric field varies with wavelength , field estimates at several wavelengths within a larger bandpass are required to achieve broadband correction .",
    "an alternative model - based controller , stroke minimization,@xcite minimizes dm actuation subject to a constraint on contrast .",
    "stroke minimization has the same mathematical formula as efc but provides a logical means of choosing the actuator regularization value at each correction iteration.@xcite    here we derive the linearized electric field at the dm for use with the controller and estimator .",
    "let @xmath3 be the initial complex electric field at the dm including the incident field and the nominal complex aberrations on the dm , where @xmath4 are coordinates in the plane of the dm .",
    "let @xmath5 be the total phase contribution of the dm at correction iteration @xmath6 , and let @xmath7 be the perturbation of the dm phase at correction iteration @xmath8 such that @xmath9 the phase at the dm is twice the surface height of the dm and scales inversely with wavelength @xmath10 ( in meters ) .",
    "since for small deformations we can approximate the dm surface as the sum of the normalized actuator influence function @xmath11 times the displacement command @xmath12 ( in meters ) at each actuator @xmath13 s center location @xmath14 , the perturbation phase at the dm is given by @xmath15 where @xmath16 is the number of dm actuators .",
    "assuming small perturbation commands to the dm , we can approximate the electric field leaving the dm , @xmath17 , with a first order taylor series expansion about the most recent dm perturbation , @xmath18 nearly all coronagraphs can be modeled as a series of linear operators such as fourier transforms , fresnel propagations , and mask multiplications . since the control and estimation methods presented here are general to all coronagraphs , we represent the propagation from the dm to the science camera by the linear operator @xmath19 to obtain the focal plane electric field @xmath20 , @xmath21 where @xmath22 are coordinates in the image . the aberrated focal plane electric field before the new command at correction iteration @xmath8 is @xmath23 and the jacobian of each actuator at the image is given by the function @xmath24    detectors measure the intensity in finite - sized pixels , so the focal plane field is converted from the continuous coordinates @xmath22 to the discrete indices @xmath25 .",
    "the detector integrates the intensity over the whole pixel whereas the model just samples discretely at each pixel . with greater than nyquist discretization ( @xmath26 2 pixels per @xmath10/d ) of the psf already required for wavefront correction , the effect of sampling the psf at each pixel instead of integrating over that area is small .",
    "the discretized focal plane electric field is thus @xmath27 where we have implicitly defined the region as being only within the dark hole . to perform matrix operations on the discretized field , it is convenient to reshape the field into a vector of length @xmath28 , the number of dark hole pixels , such that @xmath29 both @xmath30 and @xmath31 have dimensions @xmath32 , the control jacobian @xmath33 has dimension @xmath34 , and the vector of control commands @xmath35 has dimension @xmath36 .",
    "setting eq .",
    "[ eq : efocdmvector ] equal to zero and solving for @xmath35 , we obtain the command to minimize the dark hole electric field , @xmath37 where the superscript @xmath38 gives the left pseudoinverse and @xmath39 returns the real part . in both efc and stroke minimization the actuator command",
    "is damped to avoid singularities and becomes @xmath40 where @xmath41 gives the conjugate transpose , @xmath42 is the damping ( i.e. , regularization ) value , and @xmath43 is the identity matrix . the control jacobian @xmath33 is usually not updated ( @xmath44 is used instead ) to save computation time at the expense of somewhat slower correction . from here on we will use the notation @xmath45 instead of @xmath44 and @xmath46 instead of @xmath47 for convenience .",
    "the errors in the estimate and model , ignored nonlinearities of the dm phase contribution , and the use of regularization cause the new , corrected field to have only a slight improvement in contrast after each control step .",
    "the correction is thus iterative , with a new dm command calculated and applied after each new estimate of the electric field .",
    "the model - based control techniques in the previous section require knowledge of the electric field in the dark hole .",
    "an estimation approach is thus needed to determine the field from intensity measurements in the science camera .",
    "currently the baseline estimation method for a coronagraphic space mission is pair - wise difference imaging as developed by giveon @xcite , which probes the image via small dm perturbations .",
    "it is the only model - based estimation scheme that has attained better than @xmath48 contrast in laboratory experiments,@xcite all of which have been in the high contrast imaging testbed ( hcit ) at the jet propulsion laboratory ( jpl ) .",
    "pair - wise estimation is characterized by two notable features : it can be used with any coronagraph and it is fairly robust to model uncertainty .",
    "this method is described in detail in several papers,@xcite but we revisit the derivation to provide the mathematical foundation for our new work .",
    "in this paper , we focus on monochromatic wavefront estimation . at both princeton s hcil and jpl s hcit ,",
    "broadband wavefront correction is accomplished by taking images at several smaller bandpasses within the whole bandpass , creating separate electric field estimates for each one , and then weighting the bandpasses equally within the controller . in pair - wise estimation",
    ", shapes are actuated on the dm to probe the electric field in the dark hole .",
    "giveon et al .",
    "@xcite explain one such method for choosing probe sets to modulate sufficiently the real and imaginary parts of the field .",
    "a separate image is taken for the positive and negative of each probe shape applied on the dm .",
    "let @xmath49 be the differential control signal for the @xmath50-th positive probe shape .",
    "then , the change in the focal plane electric field from a positive or negative probe is defined as @xmath51 . for convenience we will not explicitly write the dark hole pixel index for the probe field @xmath52 , the electric field @xmath53 , and the intensity @xmath54 .",
    "the focal plane intensity at each dark hole for a given positive or negative probe shape is then @xmath55 where @xmath56 is the zero - mean , gaussian measurement noise .",
    "the difference of the positive and negative probed images is equal to twice the cross term , @xmath57 where @xmath58 is the total noise having twice the variance of a single probed image . for a set of measurements from @xmath59 probe pairs ,",
    "the measurement equation is @xmath60 where @xmath61 takes the imaginary part of the complex value .",
    "we re - write eq .",
    "[ eq : measeqbatch ] as @xmath62 where the set of measurements is @xmath63 the linear observation matrix is @xmath64 the state vector is @xmath65 and the measurement noise vector is @xmath66    the best estimate @xmath67 of the field s real and imaginary parts is found by taking the left pseudo - inverse of @xmath68 , @xmath69 which requires two probe pairs to be invertible and at least three probe pairs for a least - squares estimate to reduce error from measurement noise .",
    "in addition to the pairs of probed images , we always take an unprobed image @xmath70 to measure the current contrast level .",
    "the more critical role of the unprobed image is in the empirically - based estimate of the probe amplitude , @xmath71 as described by giveon et al.,@xcite this technique mitigates several types of model error to enable faster , deeper correction .",
    "even with a good model of the laboratory , the measured and modeled probe amplitudes can have different morphologies and differ by several times in magnitude .",
    "the phase of the probe is still calculated using the model .    in this batch process estimation , there is an implicit assumption that the wavefront is static .",
    "the estimator and controller can still create a dark hole as long as the electric field is static at the level of the contrast target over the course of a few correction iterations .",
    "groff and kasdin@xcite incorporated pair - wise estimation into a kalman filter for better accuracy and robustness .",
    "the kf optimally utilizes the previous estimate , the expected model uncertainty , the control signal , and new measurements in the estimate calculation .",
    "since the kf knows the previous estimate , it does not require a full , invertible set of new measurements .",
    "therefore , the wavefront estimate can be updated with just three new images : one unprobed image and one pair of probed images .",
    "if the estimate can be as accurate with fewer images of the same exposure time , this technique can further increase the speed of wavefront correction.@xcite the kf formulation also permits a dynamic state , so the kf can correct a dynamic wavefront faster and more robustly than a batch process estimator .      both formulations of pair - wise estimation ( batch and recursive ) can yield a batch estimate of the incoherent light intensity at each correction iteration @xmath8 .",
    "the incoherent intensity estimate @xmath72 at each pixel is @xmath73 where @xmath74 is the estimated stellar electric field .",
    "we will not derive the variance for the starlight intensity here , but from eq .",
    "[ eq : batchiinco ] we can see that the incoherent intensity batch estimate has a higher variance than a single image . both terms in eq .",
    "[ eq : batchiinco ] are susceptible to noise sources ( shot , readout , and dark current noise ) , and the estimated starlight intensity is susceptible to model errors . to mitigate both model errors and measurement noise , it would be better to estimate the incoherent light recursively with a filter that can use previous data and appropriate weights on the error sources .",
    "the batch and recursive pair - wise estimators in sections [ sec : batch ] and [ sec : kf ] have been tested and proven to work at high contrast for suppressing coherent , on - axis light in jpl s hcit.@xcite the ultimate goal of wavefront correction , however , is to image faint sources that are incoherent with a star such as exoplanets and disks . during wavefront correction",
    "the starlight speckles change as they are suppressed while the exoplanets and disks remain unchanged , so a recursive filter can form a better estimate of the incoherent light with each new set of images . by implementing bayesian techniques to locate any exoplanets or disks in the incoherent image,@xcite we can better detect and characterize our science targets with just the correction images .",
    "one possible approach to recursive incoherent estimation is to use another kf on the batch incoherent estimates from eq .",
    "[ eq : batchiinco ] .",
    "while this method would let us use two linear estimators , it is inefficient because the estimates of the incoherent light and starlight are interdependent . to produce the best estimate of the incoherent light with all available data , we need to estimate the stellar electric field and incoherent intensity simultaneously in a nonlinear estimator .    with a nonlinear filter",
    ", one could attempt to utilize the true nonlinear phase dependence of the electric field on the dm surface , @xmath75 in the modeled propagation of the electric field , but we do not .",
    "because opaque coronagraphic masks and field stops between the dm and camera block light , we can not directly back - propagate our electric field estimate from the focal plane to the dm - plane .",
    "maximum a posteriori methods such as coffee exist to solve this problem , but they are currently too slow computationally to implement in real time . the other reason for not utilizing the full nonlinear model and for not including more terms in the taylor expansion in eq .",
    "[ eq : epupdmtaylor ] is that the errors in our knowledge of @xmath19 , @xmath3 , @xmath5 , and @xmath76 might outweigh the better accuracy from a higher - order model . as a first step into nonlinear focal plane wavefront estimators , we derive an extended kalman filter ( ekf ) as first shown by riggs et al.@xcite in this paper ,",
    "the ekf utilizes the same probing strategy as the kf does for easier performance comparison .",
    "the ekf has the advantage that it can utilize the unprobed image recursively as well .",
    "we augment the original state vector in eq .",
    "[ eq : xbatch ] to include the incoherent intensity at each pixel , @xmath77 , @xmath78    the most general ekf measurement vector is the actual set of images taken .",
    "this formulation allows the use of unpaired probes or multi - dm probes , which we leave for future work .",
    "here we use the same set of images as in pair - wise estimation such that @xmath79 at each dark hole pixel consists of the unprobed image @xmath70 and the @xmath80 probe images , @xmath81 where @xmath82 is the nonlinear measurement function and @xmath83 is the model error from ignored higher - order terms of the dm - phase taylor series .",
    "the additive measurement noise vector @xmath84 consists of readout noise , photon shot noise , and dark current . by not performing pair - wise differencing of the probed images , the terms of order @xmath85 ignored in eq .",
    "[ eq : epupdmtaylor ] no longer cancel and appear in the measurement .",
    "the quadratic , approximate measurement function is @xmath86)^2 + ( x_{k}[2])^2 + x_{k}[3 ]   \\\\                  ( x_{k}[1 ] + \\mathcal{r } \\lbrace g \\rbrace u_1)^2 + ( x_{k}[2]+ \\mathcal{i } \\lbrace g \\rbrace u_{1})^2 + x_{k}[3 ] \\\\              ( x_{k}[1 ] - \\mathcal{r}\\lbrace g \\rbrace u_1)^2 + ( x_{k}[2]- \\mathcal{i}\\lbrace g \\rbrace u_1)^2 + x_{k}[3 ] \\\\              \\vdots \\\\                  ( x_{k}[1 ] + \\mathcal{r } \\lbrace g \\rbrace u_{n_{pp}})^2 + ( x_{k}[2]+ \\mathcal{i } \\lbrace g \\rbrace u_{n_{pp}})^2 + x_{k}[3 ] \\\\              ( x_{k}[1 ] - \\mathcal{r}\\lbrace g \\rbrace u_{n_{pp}})^2 + ( x_{k}[2]- \\mathcal{i}\\lbrace g \\rbrace u_{n_{pp}})^2 + x_{k}[3 ]                         \\end{bmatrix } , \\label{eq : ndekfhofx}\\end{aligned}\\ ] ] where @xmath87 $ ] represents the @xmath88-th element of vector @xmath89 , and @xmath49 is the additive dm control signal for the positive probe shape @xmath50 .    to derive the ekf ,",
    "we first re - define the true dynamic state equation at each image plane pixel as @xmath90 where @xmath91 is the state transition matrix , @xmath92 is the real - valued control jacobian , and @xmath93 is the disturbance jacobian .",
    "the variable @xmath94 is random process noise ; it is included in the model to accommodate model errors and random , unknown disturbances .",
    "we treat our system as static , so @xmath91 is just the identity matrix .",
    "the only source of change is from the dms , which means the only source of model error is in our knowledge of the dm response .",
    "thus , @xmath95 and @xmath96 . from here on @xmath92 will mean @xmath97 .",
    "the third row of @xmath92 is zeroes because the incoherent light is not modulated by the dms .",
    "( only the psf core is observable for faint incoherent sources , and high - order wavefront correction primarily changes the wings of the psf . )",
    "the ekf minimizes both the error of the state estimate and the state covariance estimate .",
    "the state covariance @xmath98 is defined as the expectation value @xmath99 $ ] of the outer product of the error in the state estimate , @xmath100.\\end{aligned}\\ ] ]    in the first two equations of the ekf , the dynamics of the system are used to propagate the previous estimates of the state and state covariance to the current time step . following the derivation and notation by stengel,@xcite the state estimate time update is @xmath101 and the covariance estimate time update is @xmath102 where @xmath103 is the process noise matrix .",
    "the signifier @xmath104 means @xmath67 or @xmath105 is the model - based time update , and the signifier @xmath106 means it is the measurement - updated estimate for that correction iteration .",
    "we assume that the unknown disturbance @xmath107 is gaussian and zero mean so it should not change the expected value @xmath67 .",
    "the process noise covariance matrix is given by @xmath108 \\lambda ^t .",
    "\\label{qdef}\\end{aligned}\\ ] ]    the last stage of the ekf is to improve the estimates with new data in the measurement update equations , @xmath109 \\label{xupdate } \\\\",
    "p_k(+ ) & = [ i - k_k h_k]p_k(- ) , \\label{pupdate}\\end{aligned}\\ ] ] where the kalman gain @xmath110 optimally balances the weighting of the model error and old data versus the new measurements .",
    "the kalman gain is defined as @xmath111^{-1 } \\label { kekf},\\end{aligned}\\ ] ] where @xmath112 is the measurement noise covariance matrix , which we discuss in more detail in section [ qandr ] .",
    "@xmath68 is the observation matrix linearized about the state time update , @xmath113 & 2x[2 ] & 1 \\\\        2(x_{}[1 ] + \\mathcal{r } \\lbrace g \\rbrace u_1 ) & 2(x_{}[2 ] + \\mathcal{i } \\lbrace g \\rbrace u_1 ) & 1 \\\\        \\vdots & \\vdots & \\vdots \\\\       2(x_{}[1 ] - \\mathcal{r } \\lbrace g \\rbrace u_{n_{pp } } ) & 2(x_{}[2 ] - \\mathcal{i } \\lbrace g \\rbrace u_{n_{pp } } ) & 1 \\end{bmatrix } \\biggl\\lvert_{x=\\hat{x}_k(-)}. \\label{eq : ndobsv1pair}\\end{aligned}\\ ] ]    in summary , the five ekf equations for our formulation are @xmath114^{-1 } \\\\",
    "\\hat{x}_k(+ ) & = \\hat{x}_k(- ) + k_k[z_k - h(\\hat{x}_k(- ) ) ] \\\\",
    "p_k(+ ) & = [ \\mathbb{i}-k_k h_k]p_k(- ) . \\label{pupdate2}\\end{aligned}\\ ] ] we summarize the variables used in these equations in table [ ekf1pairvardim ] , and we list the matrices and their definitions in table [ ekf1pairmatrixdim ] .",
    "the estimate is performed separately at each dark hole pixel to avoid the use of extremely large matrices .",
    "state estimate & @xmath115 & @xmath116 + intensity measurements & @xmath117 & @xmath118 + sensor noise & @xmath84 & @xmath118 + dm commands & @xmath46 & @xmath119 + process noise & @xmath120 & @xmath119 +     linearized state response & @xmath121 & @xmath122 + nonlinear observation & @xmath123 & @xmath118 + linearized observation & @xmath124 & @xmath125 + linearized complex response of probing dm & @xmath45 & @xmath126 + linearized response of probing dm & @xmath127 \\rbrace \\dotsb re\\lbrace g[n_{act } ] \\rbrace   \\\\      im\\lbrace g[1 ] \\rbrace \\dotsb im\\lbrace g[n_{act } ] \\rbrace \\\\      0 \\dotsb 0   \\end{bmatrix}$ ] & @xmath128 + disturbance response & @xmath129 & @xmath128 + state covariance ( time update ) & @xmath130 $ ] & @xmath131 + state covariance ( measurement update ) & @xmath132 $ ] & @xmath131 + process noise & @xmath133 \\lambda ^t$ ] & @xmath122 + sensor noise & @xmath134 $ ] & @xmath135 + kalman gain & @xmath136 is computed & @xmath137 +      in any kalman filter , @xmath112 and @xmath103 are the tuning parameters .",
    "the sensor noise matrix is defined as the expectation value of the outer product of the measurement noise vector , @xmath138.\\end{aligned}\\ ] ] we can calculate the value of @xmath112 based on camera measurements , so only @xmath139 needs to be tuned .",
    "the main sources of measurement noise are dark current , readout noise , and photon shot noise .",
    "the total variance in analog - digital units ( adu , or counts ) expected at each pixel is @xmath140 where @xmath141 is the gain of the detector in photoelectrons / adu , @xmath142 is the average measured contrast in the dark hole , @xmath143 is the peak flux of the starlight in photoelectrons / second , @xmath144 is the exposure time per frame , @xmath145 is the variance of the readout noise in photoelectrons , @xmath146 is the dark current rate in photoelectrons / second , and @xmath147 is the number of exposures averaged to make an image .",
    "the contrast across the dark hole in either the probed or unprobed images are relatively uniform , so we use the same matrix @xmath112 at each pixel .",
    "we still use separate values for probed or unprobed images since the probed images have more light .",
    "the noise from image to image is uncorrelated , so @xmath112 is a diagonal matrix .",
    "this means that each diagonal entry @xmath148 in @xmath112 is simply the variance in units of contrast , @xmath149 the sensor noise matrix is then @xmath150 where @xmath151 is for the unprobed image and @xmath152 is for the probed images .",
    "we must include a nonzero process noise @xmath103 in the covariance estimate extrapolation because of the uncertainty in the control step .",
    "although we assume that the dm does not modulate the incoherent light , we must still include process noise to prevent the filter from converging quickly to an incorrect value .",
    "we scale the process noise for the third state with the average incoherent intensity estimate . without location - specific information of the process noise",
    ", we assign the same @xmath103 matrix to each image plane pixel .",
    "similarly , we have no way of distinguishing if the real or imaginary parts of the starlight should have more or less model error , so we set those covariance values as equal . for each pixel at correction iteration @xmath8 , we thus use the process noise matrix @xmath153 where @xmath154 and @xmath155 are constants used to tune the relative values .",
    "there should also be off - diagonal elements in @xmath139 since the model errors of the states are cross - correlated and there is unmodeled inter - actuator coupling , but we nevertheless keep @xmath103 diagonal to avoid dropping rank before the inversion in the kalman gain calculation . with good tuning ,",
    "the values of @xmath156 tend to show no cross - correlation ( zero values ) among the electric field and incoherent states but a slight cross - correlation ( about 10% of the diagonal values ) between the real and imaginary parts of the field . including this nonzero off - diagonal term in @xmath103 did not change performance of the ekf , and was therefore not included for all the tests reported in section [ sec : results ] .      when using pair - wise differencing for the starlight measurements , the linear observation matrix @xmath68 is correct to third order in the dm - phase taylor series expansion .",
    "in our ekf formulation without differencing , the quadratic terms no longer cancel .",
    "the linearization of the observation @xmath123 in eq .",
    "[ eq : ndobsv1pair ] thus depends on the current state , so it is necessary to use the initial , inaccurate time update @xmath157 as the linearization point .",
    "a large body of research already exists to address nonlinear errors when implementing an ekf . here",
    "we try the simplest improvement , which is to iterate the ekf ( known as an iekf ) to mitigate nonlinearities .",
    "the main error in @xmath68 ( and subsequently in @xmath110 , @xmath158 , and @xmath156 ) comes from the linearization about the model - based time update @xmath157 , but after running the ekf ( eqs .",
    "[ xextrap2]-[pupdate2 ] ) we have a more accurate estimate of the state available .",
    "using @xmath158 as the new linearization point for an updated @xmath68 , the iekf recomputes @xmath110 , @xmath158 , and @xmath156 .",
    "there is now an even better estimate of the state , and this process of iterating the ekf can be repeated until the state estimate converges on a solution . defining the subscripts for the ekf iterations as @xmath159",
    ", we follow the notation of gelb@xcite and simon@xcite and write the iekf equations as @xmath160^{-1 } \\\\      \\hat{x } _ { k , j+1}(+ ) & = \\hat{x}_k(- ) + k_{k , j}\\bigl(z_k - h(\\hat{x}_{k , j}(+ ) ) -h_{k , j}[\\hat{x } _",
    "{ k}(-)-\\hat{x } _ { k , j}(+ ) ] \\bigr ) \\label{eq : iekfxmeasupdate}\\\\      p_{k , j+1}(+ ) & = [ \\mathbb{i}-k_{k , j } h_{k , j}]p_k(- ) .",
    "\\label{pupdateiekf}\\end{aligned}\\ ] ] we initialize the iekf with @xmath161 and then iterate the filter by updating eqs .  [ hupdateiekf]-[pupdateiekf ] to converge on a better state estimate at the @xmath8^th^ control step .",
    "if @xmath162 , the iekf simplifies back to the ekf . in section",
    "[ sec : accuracy ] we test several values of @xmath163 and determine the minimum value to converge on an estimate .",
    "space - based observatories have limited computing power , so it is important to compare the computational complexity of the estimators proposed . in pair - wise estimation",
    "the state can be estimated separately at each image - plane pixel , which means that only small matrices are required but the calculations must be repeated thousands of times . here",
    "we derive estimates of the complexity for each estimator based on the number of matrix multiplications ( and divisions ) required per pixel . because there are many possible methodological ( such as taking another image during calculations ) or algorithmic ( such as using alternate forms of equations ) approaches to reduce the effective complexity of the estimators , we perform just a simple analysis as a starting point for comparison .",
    "we leave out the re - calculation of the observation matrix , @xmath68 , for each estimator because calculating the new values of @xmath164 and @xmath165 is common to all the estimators and requires the square root calculation in eq .",
    "[ eq : probeamp ] .",
    "it should also be noted that the recursive estimators require more memory , but that is a separate issue from the processing speed considered here .",
    "table [ tab : complexity ] shows the relative complexity of each estimator in terms of floating point multiplications required per pixel .",
    "the batch process calculation is based on eq .",
    "[ eq : batchest ] assuming that the minimum of two probe pairs is used .",
    "the total number of multiplications is 26 .",
    ".number of scalar multiplications ( and divisions ) required per image - plane pixel for each estimator .",
    "the number of probe pairs used are shown in parentheses .",
    "bp stands for batch process , and @xmath163 is the number of ekf iterations . [ cols=\"^,^\",options=\"header \" , ]     the kf equations have the same form as eqs .",
    "[ xextrap2]-[pupdate2 ] except the state estimate update has a linear observation , @xmath166 . \\label{xupdatekf } \\end{aligned}\\ ] ] the kf has only two states , so the dimensions of the kf matrices are the same as for the ekf in table [ ekf1pairmatrixdim ] except each 3 should be a 2 .",
    "the most computationally expensive calculation in the kf is the multiplication of @xmath167 in the time update of the state estimate , which requires @xmath168 multiplications . for wfirst - afta , this would be about three thousand",
    ". the controller should already have performed this calculation to choose the optimal dm command , so we assume that it adds no complexity to the estimator .",
    "we find that the 1-pair kf requires 19 multiplications , so it is slightly less computationally expensive than the batch process .",
    "the 2-pair kf , requiring 46 multiplications , needs fewer than twice the number of computations in the 2-pair batch process .",
    "the ekf as listed in eqs .",
    "[ xextrap2]-[pupdate2 ] requires many more calculations than the kf because of the longer state and measurement vectors .",
    "we find that the 1-pair ekf requires 150 multiplications and the 2-pair ekf requires 360 .",
    "these numbers could be reduced by exploiting the sparsity of the matrices and not performing a brute force matrix inversion in the kalman gain calculation . iterating",
    "the filter requires several more calculations per ekf iteration because of the extra multiplication in eq .",
    "[ eq : iekfxmeasupdate ] .",
    "the iekf requires on the order of a thousand multiplications at each of the few thousand pixels . since the inversion in eq .",
    "[ eq : u_opt_efc ] of the controller can be precomputed , the iekf and controller would each require on the order of a million calculations per correction iteration .",
    "we conclude that the iekf should still be feasible for the limited computing power available on a space observatory .",
    "in this section , we present experimental validation of our ekf and iekf formulations in the high contrast imaging laboratory ( hcil ) at princeton .",
    "we use the stroke minimization controller with fixed settings , so that any variation in performance should arise from estimator .",
    "we compare the ekf and iekf results to those for the batch process estimator and kf with and without incoherent sources present .",
    "finally , we identify the limitations in our lab to be addressed in future work .      in the hcil , we utilize shaped pupil ( sp ) coronagraphs to generate high contrast .",
    "our layout , as shown in fig .",
    "[ hcillayout ] , uses as few optics as possible to enable easier alignment and introduce fewer optical aberrations .",
    "we inject monochromatic , 635-nm laser light directly from a fiber ( launch 1 ) as the simulated stellar point source in the nominal experimental configuration .",
    "the 60-inch focal length of the off - axis parabola ( oap ) allows us to approximate the central part of the beam as uniform .",
    "the collimated beam reflects off two boston micromachines kilo - dms and a fold mirror in series before reaching a transmissive , 10-mm diameter sp . the sp used in this paper is the freestanding ripple3 design described by belikov et al.@xcite and kasdin et al.@xcite and shown in fig .  [",
    "fig : spandpsf](a ) .",
    "the apodized psf has a theoretical contrast of @xmath169 from @xmath170 over symmetric @xmath171 sectors as shown in fig .",
    "[ fig : spandpsf](b ) , and the empirical , uncorrected psf in the hcil is shown in fig .",
    "[ fig : spandpsf](c ) .",
    "the second and final oap focuses the beam onto a focal plane mask ( fpm ) , which is used only as a field stop for better dynamic range on the detector .",
    "two achromatic lenses then re - image the stopped - down psf onto a ccd camera .    to test our estimators in the presence of incoherent sources ,",
    "we inject additional laser light at either of two locations on our bench as shown in the dashed boxes in fig .",
    "[ hcillayout ] . to create an exoplanet",
    ", we insert a beamsplitter in front of the original fiber source and place fiber launch 2 to reflect into the same beam path . to eliminate any dispersion or path difference errors for the star ,",
    "launch 1 becomes the planet and launch 2 becomes the star .",
    "this is the simplest configuration to add an off - axis source , but the beamsplitter creates additional aberrations and strong polarization dependence .",
    "we adjust the planet intensity by using a separate laser source , and we can re - position the planet and star by translating the fiber heads . to approximate a flat zodiacal signal , we place another fiber tip ( launch 3 ) approximately half a meter from the camera .",
    "the core of the expanding gaussian beam is approximately uniform over the detector from this distance .",
    "we block most of the stellar psf with a field stop and perform wavefront correction in a subset of the transmitted region .",
    "the fpm passes light in symmetric areas from a radius of @xmath172 over @xmath171 sectors as shown in fig .",
    "[ fig : typicalrun](a ) .",
    "the nominal aberrations set an average starting contrast of @xmath173 as shown in fig .",
    "[ fig : typicalrun](b ) , in which correction quickly gets the contrast below @xmath174 and then slowly approaches the final achievable contrast of about @xmath175 . in these experiments , we corrected only small , rectangular dark holes in the image plane with @xmath176 \\",
    "\\lambda / d$ ] and @xmath177 \\ \\lambda / d$ ] as shown in the corrected psf of fig .",
    "[ fig : typicalrun](c ) .",
    "when we correct a larger region , we can not reach as high of a contrast value .    to compare the relative performance of different estimators , we need to distinguish testbed fluctuations from algorithmic performance .",
    "if we perform separate correction runs in our testbed on the same day , we can safely compare them .",
    "otherwise , the optics can drift out of alignment and degrade the correction performance .",
    "because each correction run takes approximately half an hour , we have time for only one or two trials with each estimator when performing comparisons .",
    "groff et al .",
    "@xcite derive the dependence of the electric field estimate variance on the different sources of noise , and we summarize that result here . if the pair - wise probe amplitudes , @xmath178 , are much greater than the nominal field amplitude , then the photon shot noise from the starlight can be eliminated .",
    "large probe amplitudes also reduce , but do not eliminate , the variance in the e - field estimate from readout noise and incoherent - light shot noise .",
    "if the probe amplitudes are too large , estimate error is introduced from ignored nonlinearities and model error .",
    "we manually tuned the probe amplitudes to be as large as possible without slowing correction or limiting the achievable contrast , which gave a probe intensity of about @xmath174 for measured contrast values around @xmath175 .",
    "we sought to determine the accuracy of the ekf and iekf estimates in several scenarios . because the true stellar electric field is unobtainable in experiment , we compared the different estimators with contrast correction speed , defined as measured starlight contrast versus total exposure time .",
    "we assumed that a better estimate enables a larger correction step .",
    "since the incoherent signal is directly measurable , we quantified the accuracy of the incoherent estimate with the psf correlation and estimated contrast of an injected exoplanet .",
    "our goals were thus to :    1 .",
    "compare contrast correction speed and achievable contrast for the iekf , ekf , kf , and batch process estimator .",
    "2 .   determine the minimum number of ekf iterations needed to get the iekf state estimate to converge .",
    "3 .   compare the estimators performance in the presence of zodi - like , incoherent light .",
    "4 .   determine the accuracy of the incoherent estimate by retrieving an injected planet signal .        in this experiment , we compared the contrast correction curves for the various estimators as shown in fig .",
    "[ estcompall ] .",
    "the 2-pair estimators used five images per correction iteration ( 1 unprobed and 2 pairs of probed images ) and the 1-pair estimators used three images per correction iteration ( 1 unprobed and 1 pair of probed images ) . the same probe shapes were applied every correction iteration for the 2-pair estimators ; for the 1-pair estimators the probes alternated after every correction iteration to modulate the field sufficiently .",
    "the iekf performed five ekf iterations .",
    "we measured correction speed as the total number of images since all exposures had equal length .",
    "the exposure time was the longest possible without saturating any pixels on the detector and gave a contrast resolution of @xmath179 per count .",
    "the batch estimator provided the slowest overall correction .",
    "it achieved the worst final contrast and took more correction iterations to reach it .",
    "the 1-pair kf was second slowest but did eventually reach as high a contrast as the other recursive estimators .",
    "the 2-pair kf and ekf performed equally well , and the 2-pair iekf performed slightly better than those two after 100 total images .",
    "the 1-pair ekf and iekf started off slightly faster than the others and reached their best achievable contrast in less than 80% the number of images required for the 2-pair recursive estimators , thereby showing some benefit from fewer probes per correction iteration . without repeated trials to average out variability , it is important not to draw too many conclusions from these results . in another run (",
    "not shown ) , for example , the 2-pair iekf performed the same as the 2-pair kf and ekf .",
    "nevertheless , we have observed that the batch process and 1-pair kf are always slower than the other methods and that the 1-pair ekf and iekf are always slightly faster than all the 2-pair versions",
    ". the higher computational complexity of the recursive estimators is partially offset since they require fewer correction iterations to reach a given contrast level . we have also demonstrated the viability of ekf and iekf formulations that do not require image differencing .    after reaching the best achievable contrast , each correction curve started to worsen slightly ( but did stay at or below about @xmath180 contrast ) .",
    "this might have been from the controller being too aggressive or from the modeled control jacobian not matching the true system well . in a space mission ,",
    "the system would be better characterized and the controller could be made less aggressive near the ultimate contrast value to prevent divergence .",
    "although the 1-pair ekf and iekf slightly outperformed the 2-pair recursive estimators , in later tests we used the 2-pair versions of the estimators .",
    "we found in various trials ( not shown ) that the 2-pair estimates were slightly less sensitive to optical misalignments than the 1-pair estimates .",
    "a space - based coronagraph would not suffer from the same problem because of sturdier mounts , better initial alignment , and greater stability .",
    "here we compare the average contrast of the estimated starlight or incoherent light for each estimator .",
    "this approach can reveal a net bias but averages out the gaussian noise of individual pixels . to eliminate variations in images between different correction runs , we ran the estimators on a set of saved images from a 2-pair iekf correction run .",
    "there was no intentionally injected incoherent source .",
    "the only difference from using stored data instead of real - time data to feed the estimator is that the control signal was pre - determined , but this did not change the accuracy of the estimator . by using the same images for all estimators , we decoupled correction speed from estimator accuracy . while we can not know the true state values , we infer that if most of the estimators are close to a value , then it is most likely the true value .",
    "all the estimators except the ekf gave almost exactly the same average starlight contrast values in fig .",
    "[ starandincoestcompall](a ) .",
    "the ekf exhibited a large bias and mistook much of the starlight for incoherent light , as shown in fig .",
    "[ starandincoestcompall](b ) .",
    "the iekf eliminated the starlight estimate bias with just one ekf iteration .",
    "the batch estimate started to exhibit more fluctuations than the other estimates during the last half of the correction , probably because the batch estimator did not utilize previous estimates to average out read noise .",
    "the ekf estimates in fig .",
    "[ starandincoestcompall ] were significantly biased , and yet the contrast correction speed in fig .",
    "[ estcompall ] clearly shows that the ekf was no slower or less robust at wavefront correction than the iekf or kf .",
    "somehow a net bias of the estimate at all the pixels did not degrade performance , whereas random errors from noise on batch estimates do slow the correction .",
    "this result contradicts our premise that a more accurate estimate yields faster wavefront correction .",
    "the starlight intensity estimate in fig .  [ starandincoestcompall](a ) was approximately @xmath181 below the measured contrast , and the incoherent estimate converged to this level in fig .",
    "[ starandincoestcompall](b ) .",
    "the incoherent estimate s structure in fig .",
    "[ fig : boxesofestimates](b ) matched neither that of the coherent estimate in fig .",
    "[ fig : boxesofestimates](a ) nor that of the nearly flat probe signal , so it was not an artifact of pair - wise estimation .",
    "the incoherent signal was also not random , meaning it was not attributable to read noise .",
    "we conclude that the incoherent estimate was a true signal composed of stray light .    for the incoherent estimates shown in fig .",
    "[ starandincoestcompall](b ) , the batch process and kf initially gave more accurate values when the measured contrast was still several times above the true value .",
    "in later correction iterations as the contrast curve started to level off , the recursive estimate of the iekf was much less variable and ended up lower than for the batch process and kf .",
    "this suggests that the iekf adequately filters out read noise .",
    "we see in fig .",
    "[ starandincoestcompall](b ) that the first ekf iteration helped the most in improving the iekf incoherent estimate , a second ekf iteration helped a little more in the early iterations , and more than two ekf iterations produced no discernible change .",
    "it appears that two ekf iterations are sufficient for convergence of the iekf estimates . from here",
    "on , we stop testing the un - iterated ekf in comparisons because of its heavily biased estimates .      in this experiment , we compared the 2-pair batch process , kf , and iekf estimators in the presence of a bright , zodi - like background as shown in fig .",
    "[ fig_ifinalzodionoff_9april2015](a ) .",
    "we chose a bright incoherent background at @xmath182 contrast to give a noise floor worse than the previously achievable contrast floor .",
    "the average standard deviation at each pixel was @xmath183 contrast from readout noise and incoherent - light shot noise , with readout noise alone giving a standard deviation of @xmath184 . to verify the estimated starlight intensity , we acquired another image with the incoherent source turned off after each correction iteration , as in fig .",
    "[ fig_ifinalzodionoff_9april2015](b ) .",
    "we compared the contrast correction speed for the batch process , kf , and iekf in the presence of the flat background .",
    "the nominal incoherent signal at about @xmath181 was still present with the zodi turned off , so the estimated starlight intensity should have been below the measured , background - off intensity by that amount .",
    "we define the nominal incoherent signal as the stray light when only the starlight laser is on .",
    "the kf and iekf starlight estimates in figs .  [ zodiccurves](b ) and [ zodiccurves](c ) , respectively , were indeed about @xmath181 below the measured , zodi - less intensities , while the batch starlight intensity estimate in fig .",
    "[ zodiccurves](a ) was too bright by about @xmath181 . directly comparing the measured , zodi - less contrast curves in fig .",
    "[ zodiccurves](d ) , we did not observe any definitive differences in correction speed or achievable contrast because of the large fluctuations between iterations .",
    "compared to the contrast correction curves without zodi in fig .",
    "[ estcompall ] , the curves with bright background in fig .",
    "[ zodiccurves ] were much more erratic in their convergence .",
    "one possible explanation is that the much larger standard deviation in each measurement was corrupting the estimate quality .",
    "another possibility is that the drifting laser power of the bright background was invalidating the assumption of a static state .",
    "over the course of a correction run , we observed the laser power drift by 1.5% , corresponding to about @xmath185 in contrast .",
    "such a large drift in the allocation of intensity could explain the non - smooth correction curves and the reduced achievable contrast for the bright background case .      in this set of experiments",
    ", we injected a faint , off - axis point source to mimic an exoplanet , and then we attempted to recover its signal .",
    "we inserted the star - planet simulator ( the beamsplitter and fiber launch 2 ) into the testbed and used the 2-pair iekf for each correction run .",
    "we first ran wavefront correction without injecting a planet to determine the differences in nominal performance .",
    "the initial psf is shown in fig .",
    "[ fig : noplanetrun](a ) , and the final , corrected psf is shown in fig .  [",
    "fig : noplanetrun](c ) .",
    "the estimated starlight correction curve in fig .",
    "[ fig : noplanetrun](b ) was approximately as fast as the case without the star - planet simulator in fig .",
    "[ fig : typicalrun](b ) , and the final starlight estimate in fig .",
    "[ fig : noplanetrun](d ) was comparable to the one in fig .",
    "[ fig : boxesofestimates](a ) .",
    "the beamsplitter introduced a much larger nominal incoherent signal at @xmath186 average contrast as shown in fig .",
    "[ fig : noplanetrun](e ) .",
    "next we performed wavefront correction trials with an injected planet at four contrast levels , starting below the average incoherent background level and ending slightly above it .",
    "the injected planet used a separate laser channel and was centered at approximately @xmath187 .",
    "we used the iekf during real - time correction , saved those images , and re - used them for the kf trials for a more direct estimator comparison .",
    "this strategy eliminated variations between trials from noise , hardware , or the controller .",
    "we compared three different techniques to recover the planet signal from the images .",
    "the first was simple psf subtraction ( ps ) .",
    "after a correction run , we took one image with the planet laser on and another with it off . subtracting these two images yielded the ps estimate .",
    "the second technique defined the planet signal as the batch process incoherent estimate ( bpie ) from eq .",
    "[ eq : batchiinco ] , where the kf supplied the estimated starlight intensity , @xmath188 .",
    "we included the bpie because it utilized the concept of coherence diversity ( i.e. , modulating the stellar electric field to distinguish the incoherent signal ) without requiring the iekf developed in this paper .",
    "the final method used the recursive incoherent estimate ( rie ) from the iekf as the planet signal . to isolate the planet signal for this analysis",
    ", we subtracted the iekf s best estimate of the nominal incoherent signal , as shown in fig .",
    "[ fig : noplanetrun](e ) , from the bpies and ries .",
    "because the incoherent background is unlikely to be fully subtractable in this manner during a space mission , the analysis in this section represents only a best - case scenario .",
    "any non - uniformities or asymmetries in the zodiacal or exozodiacal light would make the background more difficult to subtract .",
    "we quantified the quality of the planet signal with two metrics : the accuracy of the planet s contrast estimate and the 2-d correlation of the planet signal to the expected psf .",
    "the contrast estimate was calculated by translating the normalized , on - axis psf from fig .",
    "[ fig : spandpsf](c ) to the planet s location , as shown in fig .",
    "[ fig : templatepsf ] ,    and then scaling the template psf s contrast to fit the planet signal .",
    "the 2-d correlation , @xmath189 , which quantitatively compares the morphology of the signals , was calculated by correlating the template psf , @xmath190 , to the extracted planet signal , @xmath191 , @xmath192 to avoid fitting to noise for both of these metrics , we used only the @xmath193 pixels located within the full width at half maximum ( fwhm ) of the template psf .",
    "figure [ fig : gridofplanets ] shows the planet signal from each routine at each contrast level .",
    "the first row displays the planet - only images , which are the averages of ten exposures with the star laser off .",
    "the contrast values reported above this row yielded the least - squares fit of the normalized template psf to the given signal .",
    "the average readout noise per pixel in these averaged images was @xmath194 contrast , so the contrast values of @xmath195 , @xmath196 , @xmath197 , and @xmath198 had signal - to - noise ratios ( snrs ) of approximately 2.9 , 7.3 , 13.9 , and 24.1 , respectively . the second , third , and fourth rows show the planet signals obtained from the ps , bpie , and rie methods , respectively . upon visual inspection ,",
    "the rie produced the least noisy planet signals and the best chance of a detection for the faintest planet setting .",
    "for the planet signals in fig .",
    "[ fig : gridofplanets ] , we show the corresponding planet contrast estimates in fig .",
    "[ fig : endmetrics](a ) and correlation values in fig .",
    "[ fig : endmetrics](b ) .",
    "there were not enough data points to determine if ps or the bpie was more accurate than the other for either metric .",
    "the rie was the only method to be within 5% of the measured contrast for each planet brightness ; higher noise in the other methods yielded much higher error .",
    "the correlation of the rie was always higher than for the other methods at a given planet contrast .",
    "the rie performed well at isolating the incoherent signal , averaging out noise over many iterations , and producing an un - biased contrast estimate .",
    "the previous analysis used only the final estimates and images from the correction runs .",
    "that is the optimal strategy for psf subtraction , which needs a dimmer dark hole to reduce stellar shot noise in the planet signal , but it might be unnecessary for the bpie and rie .",
    "therefore , we calculated the bpie and rie after each correction iteration to determine how early they could estimate the planet accurately .",
    "we did not take an extra image with the planet laser turned off after each correction iteration , so ps was not included in this comparison .",
    "figures [ fig : realtimecorr](a ) and [ fig : realtimecorr](b ) show the bpie and rie correlation values , respectively .",
    "both methods reached their final values by about the fifth correction iteration , which corresponded to the dark hole reaching approximately @xmath199 contrast .",
    "the exception was for the faintest planet intensity , for which the correlation values showed much higher variability .",
    "for each of the four planet settings , the average rie correlation was significantly higher and had less variability over time .",
    "the faintest two planets merited the most attention as the most difficult ones to detect in a space mission . for the @xmath196 contrast planet in correction iterations 5 - 50 , the mean correlation was 77% for the bpie and 92% for the rie .",
    "similarly for the faintest planet , the mean correlation was 37% for the bpie and 70% for the rie .",
    "the rie was thus a much better tool for detecting faint planets than the bpie .",
    "figures [ fig : realtimecontrastest](a ) and [ fig : realtimecontrastest](b ) show the bpie and rie planet contrast values , respectively .",
    "the measured contrast levels are shown as dotted lines to reveal biases in the estimates .",
    "the values settled in about five correction iterations , and the rie contrast values showed much less variability among correction iterations compared to the bpie values . at each planet brightness , the bpie contrast values started near the measured value but settled with a slightly negative bias .",
    "the rie contrast values started positively biased then settled at the measured contrast .",
    "the initial positive bias in the rie estimates likely arose from starting the iekf at poor contrast levels , where nonlinearities in the model and observation are large .",
    "we previously observed this early - iteration estimate error in fig .",
    "[ starandincoestcompall](b ) .",
    "it may therefore be beneficial to start running the iekf at moderate contrast levels to avoid the large initial bias in the incoherent estimate .",
    "we have demonstrated that the incoherent light estimate can be utilized for planet detection during wavefront correction . because the rie utilizes the whole history of images to average out noise",
    ", it gives the best planet contrast estimate and best psf correlation compared to ps and the bpie .",
    "these results hold when the other background light can be fully subtracted or is nonexistent , neither of which is safe to assume for a space mission .",
    "non - uniform background light makes planet detection harder for all three of these methods , but these results indicate that the rie is best at separating starlight from incoherent light .",
    "ps may still be the best option if the dark hole speckles are stable long enough to image two different stars .",
    "however , if the dark hole does change significantly from slewing the telescope , then coherence diversity via the rie should be the best option for detecting a companion and estimating its contrast .",
    "while we have demonstrated the use of an iekf for generating a dark hole and simultaneously detecting a planet , there are several error sources limiting our attainable contrast and dark hole size .",
    "scattered light , particularly from the dm mounts , is contributing to a larger than desired background floor .",
    "our final achievable contrast and the speed at which we reach it are also heavily dependent on our model accuracy .",
    "this is currently limited by our knowledge of the unactuated dm surface , the influence function shapes , and the nominal dm gains .",
    "current work is directed at improving the lab characterization .",
    "finally , the ultimate contrast we can measure is determined by the read noise in the camera , which is high at 4.9 adu rms for a 40,000 adu linear range .",
    "future experiments will be performed with a near photon - counting detector . with these changes",
    "we expect to reach contrasts close to @xmath48 , significantly improving our ability to characterize these algorithms for space missions .",
    "as we demonstrated by augmenting the state with the incoherent signal , the iekf also allows the estimation of other system parameters by adding them to the state vector .",
    "this is known as parameter adaptive filtering , and it could improve the performance of both the estimator and the controller since both rely on the model . because the iekf is sub - optimal from using a linearization of the nonlinear observation",
    ", we would like to implement other nonlinear filters such as the unscented kalman filter to obtain less biased estimates .    in our hcil wavefront correction trials",
    ", we showed that the recursive incoherent estimate provides a higher detection probability and better planet contrast estimate than psf subtraction .",
    "we plan to investigate scenarios that are more representative of a space mission and to quantify the conditions for which either psf subtraction or the recursive incoherent estimate is better suited .",
    "in particular , we would like to simulate trials at higher contrast , with expected levels of speckle dynamics , and at different snrs .",
    "comparisons assuming a dynamic optical system should also include advanced psf subtraction techniques such as the locally optimized combination of images ( loci)@xcite and karhuenen - love image projection ( klip)@xcite ; ygouf et al .",
    "@xcite have already begun this analysis of reference differential imaging for wfirst - afta .",
    "up to this point we have used the same set of one unprobed image and @xmath59 probed image pairs per correction iteration because it provides sufficient diversity for wavefront correction .",
    "the original purpose of using pairs of probed images was to yield a linear relationship between the electric field and the field change from the probes , but we have just shown that the nonlinear measurement in eq .",
    "[ eq : ndekfhofx ] along with the iekf works at least as well if not better .",
    "we can therefore modify our measurement equation @xmath200 from eq .",
    "[ eq : ndekfz ] to a more general one comprised of any set of images .",
    "for example , this formulation allows the use of any unpaired probes or even probes on more than a single dm simultaneously .",
    "we plan to test other probe combinations in our recursive , nonlinear estimation scheme to further reduce the number of exposures .",
    "with the prospect of the wfirst - afta cgi flying in less than a decade , progress in efficient wavefront correction and exoplanet detection algorithms is critical for maximizing the science output of the mission . in our experiments in princeton s hcil",
    ", we demonstrated the effectiveness of the extended kalman filter for coronagraphic focal plane wavefront and bias estimation .",
    "we found that the ekf and iekf provide faster wavefront correction by requiring fewer images , and that the iekf provides a better estimate of the incoherent signal by estimating it recursively along with the starlight .",
    "this provides an alternative methodology for separating exoplanet light from the stellar speckles and enables faster , more accurate planet detection . as the simplest nonlinear filters , the ekf and iekf should be manageable for the computational limits of a space telescope s computer . by proving the viability of using a nonlinear , recursive estimator for focal plane wavefront sensing , we have enabled several possible paths for improvement such as different probe choices and parameter estimation .",
    "we found that the iekf eliminates most of the bias error of the ekf , and we plan to implement more advanced filters for further improvement .",
    "a j eldorado riggs is funded for this work by the nasa space technology research fellowship ( nnx14am06h ) .",
    "n.  jeremy kasdin is supported by jpl subaward 1499194 under contract from nasa .",
    "tyler d.  groff is funded by the nasa nancy grace roman technology fellowship ( nnx15af28 g ) .",
    "w.  a. traub , j.  breckinridge , t.  greene , o.  guyon , n.  j. kasdin , and b.  macintosh , `` science yield estimate with the wfirst - afta coronagraph , '' _ journal of astronomical telescopes , instruments , and systems _ * submitted * ( 2015 ) .",
    "s.  b. shaklan and j.  j. green , `` reflectivity and optical surface height requirements in a broadband coronagraph . 1 .",
    "contrast floor due to controllable spatial frequencies , '' _ applied optics _ * 45 * , 51435153 ( 2006 ) .",
    "b.  paul , j .- f .",
    "sauvage , l.  m. mugnier , k.  dohlen , t.  fusco , and m.  ferrari , `` simultaneous phase and amplitude retrieval with coffee : from theory to laboratory results , '' in _ proceedings of spie _ ,",
    "s.  ramsay , i.  mclean , and h.  takami , eds . , * 9147 * , 91479o ( 2014 ) .",
    "t.  d. groff , a.  j. eldorado  riggs , b.  kern , and n.  jeremy  kasdin , `` methods and limitations of focal plane sensing , estimation , and control in high - contrast imaging , '' _ journal of astronomical telescopes , instruments , and systems _ * 2*(1 ) , 011009 ( 2015 ) .",
    "l.  pueyo , j.  kay , n.  kasdin , t.  groff , m.  mcelwain , a.  giveon , and r.  belikov , `` optimal dark hole generation via two deformable mirrors with stroke minimization , '' _ applied optics _ * 48*(32 ) , 62966312 ( 2009 ) .",
    "r.  belikov , a.  giveon , b.  kern , e.  cady , m.  carr , s.  shaklan , k.  balasubramanian , v.  white , p.  echternach , m.  dickie , j.  trauger , a.  kuhnert , and n.  j. kasdin , `` demonstration of high contrast in 10% broadband light with the shaped pupil coronagraph , '' in _ proceedings of spie _ , * 6693 * , pp . 66930y1  66930y11 ( 2007 ) .",
    "d.  moody , b.  gordon , and j.  trauger , `` design and demonstration of hybrid lyot coronagraph masks for improved spectral bandwidth and throughput , '' in _ proceedings of spie _ , * 7010 * , 70103p , spie ( 2008 ) .",
    "b.  kern , o.  guyon , a.  kuhnert , a.  niessner , f.  martinache , and k.  balasubramanian , `` laboratory demonstration of phase induced amplitude apodization ( piaa ) coronagraph with better than @xmath2 contrast , '' in _ proceedings of spie _ , * 8864 * , 88640r , spie ( 2013 ) .",
    "a.  riggs , t.  groff , a.  carlotti , n.  kasdin , e.  cady , b.  kern , and a.  kuhnert , `` demonstration of symmetric dark holes using two deformable mirrors at the high - contrast imaging testbed , '' in _ proceedings of spie _ , * 8864 * , 88640 t ( 2013 ) .",
    "a.  giveon , b.  kern , and s.  shaklan , `` pair - wise , deformable mirror , image plane - based diversity electric field estimation for high contrast coronagraphy , '' in _ proceedings of spie _ , * 8151 * , 815110 ( 2011 ) .",
    "d.  lafrenire , c.  marois , r.  doyon , d.  nadeau , and  .",
    "artigau , `` a new algorithm for point - spread function subtraction in high - contrast imaging : a demonstration with angular differential imaging , '' _ the astrophysical journal _ * 660*(1 ) , 770 ( 2007 ) .",
    "r.  soummer , l.  pueyo , and j.  larkin , `` detection and characterization of exoplanets and disks using projections on karhunen - love eigenimages , '' _ the astrophysical journal letters _ * 755*(2 ) , l28 ( 2012 ) .",
    "m.  ygouf , l.  pueyo , r.  soummer , m.  d. perrin , r.  van  der marel , and b.  macintosh , `` data processing and algorithm development for the wfirst - afta coronagraph : reduction of noise free simulated images , analysis and spectrum extraction with reference star differential imaging , '' in _ proceedings of spie _ , * 9605 * , 96050s96050s9 ( 2015 ) .    *",
    "a j eldorado riggs * is a ph.d .",
    "candidate in the department of mechanical and aerospace engineering at princeton university .",
    "he received his bs in physics and mechanical engineering from yale university in 2011 .",
    "his research interests include wavefront estimation and control , deformable mirrors , and coronagraph design for exoplanet imaging .",
    "he is a member of the american astronomical society and spie .    *",
    "n. jeremy kasdin * is a professor of mechanical and aerospace engineering and vice dean of the school of engineering and applied science at princeton university .",
    "he is the principal investigator of princeton s high contrast imaging laboratory .",
    "he received his ph.d . from stanford university in 1991 .",
    "professor kasdin s research interests include space systems design , space optics and exoplanet imaging , orbital mechanics , guidance and control of space vehicles , optimal estimation , and stochastic process modeling .",
    "he is an associate fellow of the american institute of aeronautics and astronautics and member of the american astronomical society and the spie .    *",
    "tyler d. groff * is an associate research scholar at princeton university .",
    "he received his bs in mechanical engineering and astrophysics from tufts university in 2007 , and his ph.d . from princeton university in 2012 .",
    "his current research interests include exoplanet imaging , optomechanics , optical design , wavefront estimation and control , infrared specroscopy , integral field spectrographs , deformable mirrors , and ferrofluidics .",
    "he is a member of the american astronomical society and spie ."
  ],
  "abstract_text": [
    "<S> for imaging faint exoplanets and disks , a coronagraph - equipped observatory needs focal plane wavefront correction to recover high contrast . </S>",
    "<S> the most efficient correction methods iteratively estimate the stellar electric field and suppress it with active optics . </S>",
    "<S> the estimation requires several images from the science camera per iteration . to maximize the science yield , it is desirable both to have fast wavefront correction and to utilize all the correction images for science target detection . </S>",
    "<S> exoplanets and disks are incoherent with their stars , so a nonlinear estimator is required to estimate both the incoherent intensity and the stellar electric field . </S>",
    "<S> such techniques assume a high level of stability found only on space - based observatories and possibly ground - based telescopes with extreme adaptive optics . in this paper </S>",
    "<S> , we implement a nonlinear estimator , the iterated extended kalman filter ( iekf ) , to enable fast wavefront correction and a recursive , nearly - optimal estimate of the incoherent light . in princeton s high contrast imaging laboratory we demonstrate that the iekf allows wavefront correction at least as fast as with a kalman filter and provides the most accurate detection of a faint companion . </S>",
    "<S> the nonlinear iekf formalism allows us to pursue other strategies such as parameter estimation to improve wavefront correction .    : </S>",
    "<S> a j eldorado riggs ; e - mail : . published by jatis with free access at doi:10.1117/1.jatis.2.1.011017    1 </S>"
  ]
}