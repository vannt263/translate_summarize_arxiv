{
  "article_text": [
    "a common problem in biomedical imaging research is to mathematically model anatomical structures and to summarize them in an appropriate space . in this manuscript",
    "we focus on modeling tube - like anatomical structures , such as the colon or white matter fiber bundles in the brain . in our setting the objects of measurement",
    "are measured by biological signals represented in a two- or three - dimensional array obtained via imaging or some other indirect measurement of anatomy or function .",
    "finding the best mathematical representation of the tube to quantify the anatomical or functional image remains a difficult  and neglected  problem in statistics . in this manuscript",
    "we develop an algorithm for fitting tubes to collections of points and apply this algorithm to data from two motivating examples based on different medical imaging modalities .",
    "our first application is to single - photon - emission computed tomography ( spect ) images from an experiment to evaluate the distributional penetrance of anti - human immunodeficiency virus ( hiv ) microbicidal lubricants in the colon .",
    "spect images are produced by applying computed - tomography techniques to projections of photons emitted by a radioactive tracer . in this experiment",
    "a radiolabeled over - the - counter lubricant was distributed in a subject s colon .",
    "knowledge of the distributional penetrance of the tracer , along with knowledge of the distribution of hiv - infected semen after intercourse with an infected partner , would give crucial information regarding efficacy of the treatment for preventing transmission .",
    "this experiment is one of the first to experimentally investigate the distributional properties of microbicidal lubricants .",
    "thus , this manuscript represents early work on this topic .",
    "here , we study only the distributional penetrance of the lubricant via spect imaging .",
    "our goals are to obtain an accurate tube through the tracer to outline the colon , along with a metric to measure the tube s extent at various orthogonal cross - sections .",
    "our second application is to diffusion tensor imaging ( dti ) tractography .",
    "dti is a magnetic resonance imaging ( mri ) technique used to identify white - matter tracts by measuring the diffusivity of water in the brain along several gradients .",
    "white - matter tracts are made up of myelinated axons .",
    "axons are the long projections of nerve cells that carry electrical signals , and are sheathed in a fatty substance called myelin which insulates and speeds the transmission of signals . measuring the diffusion of water is useful as water diffuses preferentially , or anisotropically , along white - matter tracts , unlike the isotropic diffusion that takes place in gray matter .",
    "hence , dti gives more detailed images of white - matter anatomy compared to standard mri techniques .",
    "in fact , anisotropic diffusion can be used to reconstruct bundles of white - matter tracts , a process called tractography [ @xcite ; @xcite ; @xcite ; @xcite ] . while several tractography methods are available , we note that our tube - fitting algorithm does not depend on which of these methods is used .",
    "moreover , it applies to nontractography - based tract segmentations as well .",
    "dti - based tract segmentation holds great promise as a quantitative measure of white - matter health , though tractography methods are still in development .",
    "an example of potential application of tractography is to the study of multiple sclerosis ( ms ) , which causes demyelination .",
    "individuals with ms can suffer profound disability , such as loss of vision and motor function .",
    "the ability to quantify tissue damage using dti tractography has important clinical and research implications .",
    "several parameters of the tracts , including shape , volume and anisotropy , may be useful for monitoring the progression of ms .    in both of these applications",
    "we seek a method of mathematically modeling the tracer or anatomical structure with an envelope or tube that `` represents '' the object in imaging space . here , what is meant by `` represents '' is context- and modality - specific , as different imaging techniques and settings can result in vastly different goals for estimating the tube . a strength of our proposed method is its ability to accommodate a large variety of settings .",
    "we distinguish the tube - fitting problem from the volume of excellent work on simultaneous confidence bounds around estimated functions . in our case ,",
    "the tube is not a measure of uncertainty , but is instead is the estimand of interest .",
    "the steps of the tube - fitting algorithm are illustrated in figure [ roadmap ] using data from our first application .",
    "each of these steps will be examined in detail in section [ sec : tube ] , but we provide an overview here .",
    "panel 1 shows the data taken from a spect image and panel  2 adds a curve fitted through the center of the data . in panel",
    "3 we select a point @xmath0 on the curve and identify nearby image points ; panel  4 is a detail of panel  3 .",
    "panels 5 and 6 show the local linearization method used to project the nearby image points into the plane orthogonal to the fitted curve at @xmath0 , while panel  7 shows an ellipse used as an estimate of the tube s extent .",
    "panel 8 shows this ellipse in the context of the image points and centerline .",
    "finally , panel  9 shows the result of many iterations of the steps of the tube - fitting algorithm .",
    "we will refer to this figure often in our exposition of the tube - fitting algorithm .",
    "the curve fitted through the center of the data represents the `` spine '' of the tube .",
    "it is also useful in our applications to represent the metric by which measures of extent of the tube are taken .",
    "this component relies on existing methodology ; the remaining steps of the tube - fitting algorithm and the application to two imaging modalities represent the methodological advances of this manuscript .",
    "we apply the tube - fitting algorithm to an example of each type of image .",
    "the results indicate that the procedure could be used in the spect application as a replacement for the invasive sigmoidoscope procedure , which is currently used instead of image processing . in the second application ,",
    "our algorithm is used to extract mri quantities at many points along a white - matter tract .",
    "this is an improvement over the current approach , which examines tracts by looking at a sequence of axial slices along the image and which does not produce satisfactory results when the long axis of the tube is not normal to the axial plane ( see section  [ sec : app ] ) .",
    "the manuscript is structured as follows .",
    "section [ sec : data ] describes the data sets in detail .",
    "section [ sec : curve ] outlines the modified - principal - curve algorithm that serves as the basis of the tube - fitting procedure .",
    "section [ sec : tube ] gives the detailed tube - fitting algorithm .",
    "section [ sec : validate ] provides a validation study of the algorithm .",
    "section [ sec : app ] presents the application to spect and dt images .",
    "section [ sec : disc ] is a discussion .",
    "our spect colon data arise from an experiment designed to study the viability of microbicide lubricant for hiv transmission during anal intercourse [ @xcite ; @xcite ] .",
    "spect imaging uses a radioactive isotope as the source signal .",
    "projections of emitted photons are collected via gamma cameras mounted on a gantry that are rotated around the subject .",
    "computed tomography algorithms are used to convert the projection images into a three - dimensional image .",
    "the principal benefit of spect imaging is the ability to image changes in tracer position and distribution within an anatomical structure over time , rather than simply imaging anatomy .",
    "the experiment was designed to simultaneously image the distribution of surrogates for the microbicide lubricant and the viral - mixed semen to assess if the coverage of the lubricant is sufficient .",
    "the experiment used an over - the - counter lubricant as a surrogate for the microbicide , which was mixed with a radioactive tracer ( tc - sulfur colloid ) . a radiolabeled surrogate for the viral - mixed semen",
    "is being used for extensions of the experiment , though the data considered here contains only the lubricant .",
    "ten milliliters of the radiolabeled lubricant was injected into the subject s colon , who subsequently simulated receptive anal intercourse using an artificial phallus .",
    "the subject was then imaged using a dual - head vg spect imaging system ( ge medical systems , waukesha , wi ) equipped with a low - end x - ray computed tomography system ( hawkeye ) .",
    "the image was reconstructed using an ordered subsets em algorithm and filtered as provided with the scanner software ( ge entegra workstation , version 1.04 ) .",
    "we present analysis of the reconstructed spect image of the distributed lubricant .",
    "as mentioned above , dti [ @xcite ] has two major values as an imaging modality : its sensitivity to tissue microstructure [ @xcite ] and its ability to guide tractography of the major white matter tracts [ @xcite ] .",
    "this is due to dti s sensitivity to diffusion anisotropy [ @xcite]the tendency of water to diffuse in a particular direction , which , in the brain and spinal cord , is often along the course of an axonal tract . by combining analysis of tissue microstructure with tractography",
    ", we can limit our focus to one or several tracts with specific functional correlates , for example , motion , vision and language . within these tracts",
    ", we can analyze not only quantities derived from dti including anisotropy , absolute and directional diffusivity of water , and tract volume , but also quantities derived from other mri sequences that have been coregistered to the dti [ @xcite ] .",
    "this offers the possibility of a comprehensive , multimodal approach to analyzing the structure - dysfunction relationship in the central nervous system .    to compare tract - specific imaging results across individuals ,",
    "a normalization procedure is required .",
    "there are two general approaches : whole - brain normalization , which involves warping brains to match one another or some canonical atlas , and tract - specific normalization , which focuses specifically on the tract of interest .",
    "the former approach is computationally intensive and may require sacrificing optimal registration of the tract of interest to achieve acceptable registration of the whole brain .",
    "we have introduced an approximate tract - specific normalization approach that samples tracts in a slice - by - slice manner [ @xcite ] ; this approach has yielded promising correlations between tract - specific mri quantities and clinical disability scores [ @xcite ( @xcite ) ] . however , because white matter tracts in the brain do not typically run perpendicular to the cardinal imaging planes ( axial , coronal and sagittal ) , a parametric approach that accounts for each tract s specific shape and anatomical course would reduce noise and might increase sensitivity for detection of relevant abnormalities .",
    "the parameterization would be different for each tract but would ideally be generated by an algorithm that could be applied automatically to any tract .",
    "in particular , we hope that the tube - fitting algorithm will allow us to estimate quantities derived from dti at many points along a tract , regardless of the anatomical course of that tract .",
    "details of our mri acquisition protocol have been described [ @xcite ] . on a 3-tesla philips intera scanner",
    ", we obtained whole - brain dti images in the axial plane ( 2.2@xmath12.2@xmath12.2 mm voxels interpolated on the scanner to 0.8@xmath10.8@xmath12.2 mm ; parallel imaging with a sensitivity - encoding reduction factor of 2 ; 2 averages ; 32 noncoplanar gradient directions with a nominal @xmath2-value of 700 s@xmath3mm@xmath4 ; and a scanner average of 5 minimally diffusion - weighted scans with @xmath5 s@xmath3mm@xmath4 ) .",
    "we coregistered all images to the first minimally diffusion - weighted scan using the automatic image registration ( air ) algorithm [ @xcite ] with a 6-parameter rigid - body transformation , and we corrected the gradient directions for the rotational component of the transformation .",
    "we then estimated the diffusion tensor in the standard fashion [ @xcite ] , diagonalized the tensor to obtain its eigenvalues and eigenvectors , and calculated maps of anisotropy and diffusivity .",
    "these analyses were performed in dtistudio [ @xcite ] , as well as with custom software purpose - written in matlab ( the mathworks , natick , ma ) .",
    "we used the dti data sets to obtain 3d reconstructions of the corticospinal tracts using the fiber association by continuous tractography method [ @xcite ( @xcite ) ; @xcite ] .",
    "we reconstructed the tracts using fractional anisotropy and the principal eigenvector of the diffusion tensor .",
    "we used every voxel in the brain with fractional anisotropy @xmath6 as a potential starting point for tractography and halted individual tracts once a voxel with fractional anisotropy @xmath7 was encountered or when the reconstructed tract turned at an angle steeper than 40 degrees from one voxel to the next .",
    "we chose multiple restrictive regions of interest to limit the reconstructed corticospinal tracts to their known anatomical course ; these regions of interest have been described previously [ @xcite ] and were drawn in the rostral medulla , rostral pons and subcortical white matter .",
    "we manually excluded the rare spurious fibers that were included in this reconstruction but that clearly fell outside the major portion of the corticospinal tract .",
    "to construct our tube , we first need a fitted curve that acts as a centerline for our data . statistical analysis for three - dimensional curve - fitting and centerline calculation has received little attention in the statistical community .",
    "( we emphasize the difference between fitting nonparametric functions , a process well studied in the smoothing literature , and nonparametric curve - fitting . )",
    "however , curve fitting has received a great deal of attention in the computer - vision and medical - image - processing literature .",
    "relevant literature exists in the field of virtual colonoscopy and localization of polyps [ see , for example , @xcite ; @xcite ( @xcite ) ; @xcite ; @xcite ; @xcite ] .",
    "these approaches generally require connected curves , and are not directly applicable to the range of problems that we consider , which may have interrupted structures or may be a voxel - wise reduction of connected - curve data . also relevant from the image processing literature",
    "is the tremendous volume of work on bezier curves and b - splines [ see the review in @xcite ] .",
    "though we have explored bezier approaches , we do not utilize them because of the large amount of user input required to appropriately place knots .",
    "another popular collection of techniques treats the points of the image as a networked graph and uses combinatorial algorithms to find globally optimal paths [ @xcite ( @xcite ) ; @xcite ; @xcite ; @xcite ( @xcite ) ] .",
    "dijkstra s algorithm is often used to find solutions [ @xcite ] .",
    "perhaps the most statistical approach that we have encountered relies on the use of principal curves [ @xcite ; @xcite ; @xcite ] .",
    "these generalizations of principal components find a curve achieving a local minimum for the sum of the orthogonal distances of the points onto the curve .",
    "this approach is useful in statistical methods of image analysis [ @xcite ; @xcite ] .",
    "numerous modifications of the principal - curve idea have been published [ see the discussion in @xcite ] .",
    "in addition , there are related stochastic search algorithms for finding centerlines , as considered in @xcite .",
    "our approach in this manuscript utilizes the modified - principal - curve algorithm presented in @xcite .",
    "this procedure can accommodate interrupted curves , constrained points and can fit low variation curves that the original algorithm could not .",
    "we briefly describe the procedure below .    to start ,",
    "we need a method for representing a curve .",
    "the study of differential geometry has revealed several equivalent methods for representing real - valued curves [ @xcite ; @xcite ; @xcite ] , including implicit representations , the set of points @xmath8 , for surfaces @xmath9 and @xmath10 and parametric representations .",
    "we focus entirely on parametric representations , of which implicit representations are a special case [ @xcite ] . an allowable parametric representation sets @xmath11 \\rightarrow\\mathbb{r}^3 , $ ] where @xmath12 $ ] is an interval in @xmath13 and at least one of @xmath14 , @xmath15 or @xmath16 is nonzero .",
    "we assume the constraint @xmath17 $ ] for identifiability .",
    "however , this assumption alone does not uniquely specify a curve .",
    "indeed , if the curve is considered to be the location of a particle at time @xmath18 , then the same curve can arise from particles following the same path at different rates .",
    "given this parametric curve representation , we view the process of fitting a curve through three - dimensional coordinates as inherently a missing - data problem .",
    "let @xmath19 be a collection of realized values for the coordinate functions .",
    "the process of finding a curve through them largely amounts to finding a reasonable estimates for the missing data @xmath20 .",
    "however , estimating the missing time data , @xmath20 , is a difficult process .    here",
    "@xmath21 are lattice values of points in the image surviving a thresholding procedure for noise reduction .",
    "in addition , to improve computing times , we often work with a subset of the points , sampled uniformly , as the curve is often well defined with much fewer points .",
    "this is not necessary for the dti tractography example , but it speeds up computing substantially at no loss of quality - of - fit for the spect colon data .",
    "the basic principal curve algorithm is a blocked - maximization algorithm that iterates between two steps : calculating the time points and fitting curves to the coordinate data : @xmath22 , @xmath23 , @xmath24 .",
    "suppose that an initial estimate of @xmath25 , say , @xmath26 , is given .",
    "then , the @xmath27 are calculated as @xmath28 } \\vert\\tilde{f}(t ) - ( x_i , y_i , z_i ) \\vert.\\ ] ] the estimate @xmath26 is then updated by fitting a smoother between the @xmath29 and the @xmath30 , the @xmath31 and the @xmath30 , and the @xmath32 and the @xmath30 , separately .",
    "we use cubic regression splines for this portion of the algorithm , though other smoothers could be used .",
    "however , regression splines allow for easily calculated derivatives on the coordinate function .",
    "the steps of updating the @xmath30 and @xmath26 are iterated until the change in @xmath33 between successive steps is sufficiently small .",
    "several modifications to the principal curve algorithm outlined above are proposed by @xcite .",
    "first , the modified - principal - curve approach allows for user - specified end points .",
    "second , it molds the curve by gradually increasing the degrees of freedom in the regression splines , so that gross features of the curve are captured before fitting finer details .",
    "this provides for better fits to complex curves .",
    "third , the modified approach incorporates image intensities to adjust the emphasis placed on high- and low - intensity points in the curve - fitting .",
    "fourth , a  grid search is used to perform the minimization in the second step of the algorithm to speed up convergence . finally , the stopping criterion is based on relative change in mean square error .",
    "as described originally , the modified - principal - curve - fitting algorithm also allows for user - specified interior points , though constrained interior points did not lead to better fits in our applications .",
    "the modified principal curve algorithm is semiautomated , requiring user defined endpoints and , in some cases , adjustment of the final number of degrees of freedom used in the regression splines .",
    "this algorithm provides a differentiable curve that acts as a centerline through the data .",
    "we emphasize , however , that the algorithm used to construct the centerline curve functions independently of the algorithm used to fit the tube .",
    "so , for example , other less automated procedures , such as using b - splines with user - selected knot points , could be used for this step .",
    "in the previous section we outlined the curve - fitting algorithm , which provides the centerline for our tube - fitting algorithm . before we begin the exposition of the tube - fitting algorithm , we pause briefly to reiterate our goal and outline our general approach .    in this section",
    "our aim is to provide an estimate of the boundary of a tube - shaped structure based on a collection of observed data points from the interior of this structure . to accomplish this",
    ", we estimate the centerline of the structure and , at many points along this centerline , estimate the cross - sectional extent of the tube .",
    "the tube - fitting algorithm consists of a collection of steps that can proceed from any point on the centerline and progresses to an estimate of cross - sectional boundary of the tube .",
    "while the basic outline of the procedure is simple and intuitive , many of the steps require special care .",
    "the steps in the tube - fitting algorithm are as follows : ( i ) select a starting point @xmath0 on the centerline ; ( ii ) identify nearby image points ; ( iii ) project nearby image points onto the plane orthogonal to the centerline at @xmath0 ; ( iv ) fit a bivariate normal distribution to the ( now two - dimensional ) points in the orthogonal plane ; ( v ) use a level set of the bivariate normal to define the tube at the chosen starting point on the fitted curve .",
    "each of these steps will be examined in greater detail in the following subsections .",
    "further , we encourage the reader to refer often to figure [ roadmap ] , which shows graphically the steps in the tube - fitting algorithm .",
    "we pause to discuss the choice of an ellipse ( the level set of a bivariate normal ) as the shape of the cross - sectional boundary of the tube .",
    "our first inclination was to use the convex hull  the smallest closed set containing the points  because it is flexible and comparatively unrestrictive .",
    "for a one - dimensional cross section , this approach is analogous to using the minimum and maximum .",
    "however , such estimates do not account for any noise in the measurements inherent in some imaging techniques and would only be acceptable for very high resolution images without noise .",
    "moreover , similar to elliptical cross sections , convex hulls can not estimate nonconvex cross - sectional shapes . a circle centered at the origin ,",
    "that is , the level set of a bivariate normal distribution with no correlation , was too restrictive for the shapes seen in practice .",
    "therefore , as a compromise between these extremes , we use an ellipse to define the boundary of the tube .",
    "this choice coincides with observed points projected into the orthogonal plane as well as our scientific collaborators knowledge of the anatomical structures in our motivating data sets ; for other applications , a different choice for the shape of the boundary may be needed .",
    "we emphasize that our algorithm is easily adapted to these other applications , in that only the final step is changed .",
    "last , in section [ subsec : ellipse ] we explore our algorithm s performance in a case in which the cross section is not elliptical .",
    "the elements of the tube - fitting algorithm discussed in this subsection are illustrated in panels 3 and 4 of figure [ roadmap ] .",
    "as noted , the tube - fitting algorithm consists of several steps that are repeated along the length of the centerline .",
    "we prefer to take 50 equally spaced points on the centerline as the individual starting points at which we estimate cross sections of the tube .",
    "the steps in the algorithm are the same , regardless of the position of the starting point .",
    "to aid in the clarity of our figures , we display a starting point in the middle of the curve .",
    "we emphasize that the starting points , and hence the locations where the cross section of the tube is estimated , do not have to be the projection of an observed point onto the curve , nor does it have to lie on the lattice defined by the imaging coordinates .",
    "notationally , we will call the starting point on the centerline @xmath0 . also , we recall the latent variable @xmath18 that was used in section [ sec : curve ] to parameterize the centerline @xmath34 .",
    "let @xmath35 be the value of that variable such that @xmath36 .",
    "the variable @xmath18 will prove to be a useful tool in the following steps , as it orders the image points according to their orthogonal projection onto the centerline  @xmath34 .",
    "the elements of the tube - fitting algorithm discussed in this subsection are illustrated in panels 3 and 4 of figure [ roadmap ] .",
    "again , in the steps of our algorithm we are trying to estimate the cross - sectional extent of the tube - shaped structure at @xmath0 .",
    "we base our estimate of the boundary on image points that are local to @xmath0 . in this subsection",
    "we discuss what is meant by `` local '' in this context .",
    "let the set @xmath37 be the points from the image used in the curve - fitting procedure , so that @xmath38 . recall that in section [ sec : curve ] we assigned to each @xmath39 a value of the latent variable @xmath27 such that the distance between @xmath39 and the centerline @xmath34 is minimized .",
    "our goal in this subsection is to select points in @xmath40 that are near @xmath0 .",
    "we use the collection @xmath41 to do this . as we argue below ,",
    "this is preferable to the seemingly more intuitive approach of using euclidean distance .",
    "the neighborhood of points to be used in estimating the cross - sectional extent of the tube is @xmath42 where @xmath43 is the range of the time window .",
    "intuitively , measuring proximity in terms of the latent variable @xmath18 allows us to select the nearest neighbors of @xmath0 , defining `` local '' in terms of distance on the curve @xmath34 .",
    "this strategy for defining a neighborhood of observed points around @xmath0 has major benefits over competing methods , such as using a neighborhood based on the euclidean distance between the observed points and @xmath0 .",
    "specifically , for @xmath0 near high curvature in the fitted curve , observed points can then overly contribute to the fitted tube at multiple locations .",
    "see figure [ neighborhood ] for a two - dimensional illustration .    .",
    "in the left , the neighborhood is defined as though points with a euclidean distance from @xmath0 less than 2 ; in the right , we use a @xmath18-window with @xmath44 . in both ,",
    "the point @xmath0 is shown in green , and the points in the set @xmath45 are shown in blue . ]",
    "the blue points in the left panel are in the euclidean neighborhood structure of @xmath46 , and include points that lack face validity for contributing to the estimate of the extent of the tube .",
    "in contrast , the right panel shows that the neighborhood defined as ( [ eq : nbhd ] ) has much better behavior .",
    "we note that in areas of low curvature , our method for choosing @xmath45 coincides with the method using euclidean distance .    for our applications",
    ", we have found that choosing @xmath47 , depending on the total number of image points , includes enough points to estimate the tube s shape without using locations that are very distant .",
    "( recall that our curve - fitting algorithm specifies @xmath48 . )",
    "however , we emphasize that truncating points in this way is done primarily for computational purposes . in estimating the extend of the tube , we weight points ( see below ) by their distance in @xmath18 , so that further away points contribute less to the estimate .      the elements of the tube - fitting algorithm discussed in this subsection are illustrated in panels 5 and 6 of figure [ roadmap ] .",
    "thus far , we have selected a starting point @xmath0 and found the collection of nearby points @xmath45 .",
    "next , we will project the points @xmath45 onto the orthogonal cross section ; once the points are projected into a single two - dimensional plane , we will estimate the tube s extent .",
    "the projection of the set @xmath45 onto the orthogonal plane is a step that may strike a reader as unexpectedly complex . a simple",
    ", intuitive and standard approach is to take as the projection of @xmath39 the point in the orthogonal plane with minimum euclidean distance from @xmath39 .",
    "however , in the context of our tube - fitting algorithm , this standard projection fails in the following way . in areas of modest or high curvature ,",
    "such projections skew toward the interior of the curve , rather than remaining centered around the centerline .",
    "estimates of the extent of the tube are therefore similarly skewed .",
    "figure  [ proj ] illustrates this point using a two - dimensional analog , showing standard projections and projections using our novel projection approach which we explain next .",
    "a three - dimensional illustration appears in section  [ sec : validate ] .",
    "is highlighted in green and the @xmath45 are shown in blue . ]    instead of the standard projection , we use a method that maintains a point s distance and direction from the centerline in its projected position on the orthogonal plane . conceptually , our method stretches the space containing the centerline @xmath34 and the points @xmath39 around it so that @xmath34 is linear .",
    "our conceptual framework then considers the plane containing the image point @xmath49 and the point on the centerline @xmath50 as a transparent sheet [ note this plane is orthogonal to the centerline at @xmath50 from our construction of @xmath51 .",
    "the projection of @xmath45 onto the cross - sectional plane is found by stacking one such transparent sheet for each point in @xmath45 , overlaying them so that the points @xmath52 coincide .",
    "more technically , our projection method is carried out in the following steps .",
    "consider the plane orthogonal to @xmath53 . by the construction of @xmath34 , both @xmath39 and @xmath53",
    "lie in this plane .",
    "we rotate and translate this plane so that : ( i ) the plane is parallel to the axial plane of the image ( i.e. , is horizontal ) , ( ii ) the height of the plane is @xmath54 , and ( iii ) the point @xmath53 is at the origin .",
    "to accomplish this , we let @xmath55 and , hence , the plane orthogonal to @xmath34 at @xmath53 is the collection of points @xmath56 .",
    "let @xmath57 be the rotation matrix so that @xmath58 is horizontal ( parallel to the @xmath59 plane ) .",
    "finally , let @xmath60 .",
    "notice that @xmath61 has @xmath62 coordinate @xmath63 and its distance from the origin is equal to the distance between @xmath39 and its projection onto the fitted curve , @xmath53 .",
    "we perform this process for all points in the neighborhood of @xmath46 , @xmath45 , to obtain a set of rotated and translated points , @xmath64 .",
    "these points in two - dimensional space have distance and direction from the origin that is the same as their distance and direction from the fitted centerline . in effect",
    ", we have locally linearized our fitted curve and collapsed the locations in the current @xmath18-window into a single plane .      in sections  [ subsec :",
    "step1 ] and  [ subsec : step2 ] we selected a starting point and found image points that were near our starting point . in the previous section we projected points local to @xmath0 onto the cross - sectional plane .",
    "next , we fit a bivariate normal distribution to the projected points in the cross - sectional plane .",
    "our task here is subtly affected by our overarching goal to provide an estimate of the boundary of the tube - shaped structure at our current starting point @xmath0 .",
    "while we have selected points local to @xmath0 to construct this estimate , we further use weights so that more distant points have a smaller impact on the estimation than nearer points .",
    "again , we use the latent variable @xmath18 as a tool for constructing these weights , precisely because @xmath18 is a measure of distance along the centerline rather than a measure of euclidean distance .",
    "specifically , we use a cosine - transformed distance as the weight : @xmath65 + 1}{\\sum_{j=1}^{j}\\cos [ { ( t_{i_j}-t_0)\\pi}/ { r } ] + 1}\\ ] ] with @xmath66 the half width of the @xmath18-window .",
    "this weighting scheme has the desired effect of emphasizing nearby points while smoothly decreasing to zero for more distant points .",
    "we note that other weighting schemes that decrease to zero at the tails , specifically kernel weighting schemes , give very similar results .",
    "schemes that do not decrease to zero , like one that gives uniform weight to all points in the @xmath18 window , are less desirable because the resulting tube is not necessarily smooth .",
    "let @xmath67 be the collection of normalized weights .",
    "then the estimated bivariate normal has mean and variance @xmath68 where @xmath69 indexes @xmath70 and @xmath64 is the projection of the local points into the cross - sectional plane .",
    "the elements of the tube - fitting algorithm discussed in this subsection are illustrated in panels 7 and 8 of figure [ roadmap ] .    in the final step of our algorithm , we select a level set of the bivariate normal fit in the previous step as our estimate of the cross - sectional boundary of the tube . in the two - dimensional cross - sectional plane ,",
    "the tube is estimated by the level set @xmath71 where @xmath72 is the elliptical estimate of the boundary and @xmath73 is chosen so that @xmath74 typically the choice of @xmath75 will be context - specific , depending on the shape of the true boundary @xmath76 and the measurement error variance ( if any exists ) . in section",
    "[ subsec : alpha_sim ] we explore the effect of @xmath75 on the resulting estimate @xmath72 .",
    "last , we recall that our projection method took each point into the @xmath59-plane through a series of rotations and translations .",
    "we apply these steps in reverse to take the fitted ellipse into our original space .",
    "as previously mentioned , the underlying modality and noise characteristics of the image impacts how one selects the cross - sectional ellipse covering the structure ; in other words , how one selects @xmath75 in the level set of the bivariate normal .",
    "our two examples highlight the difficulty in obtaining a universal rule .",
    "the spect image is clearly very noisy , as is required by the underlying poisson decay of the tracer and the other sources of noise imposed during image acquisition and reconstruction . the dti tract , on the other hand , _ appears _ nearly noise free .",
    "however , there is noise in the underlying dti image and potential noise and bias from the tractography algorithm .",
    "however , without repeat scans , it is impossible to characterize this variability in the dti image .",
    "therefore , we seek the most accurate representation of the tract image , acknowledging that there are sources of noise and bias that are not represented or quantified . thus , the choice of @xmath75 differs greatly in these two applications .",
    "to elaborate on this choice , we have two competing goals : ( i ) to maximize the coverage of the true cross section by our estimated ellipse ; and ( ii ) to avoid choosing the ellipse excessively large through the inclusion of points not in the cross section .",
    "to characterize these goals , we examine the quantities @xmath77 where @xmath78 gives the area of the designated shape , and again @xmath76 is the true cross - sectional boundary of the tube and @xmath79 is the elliptical estimate of the boundary .",
    "these quantities , @xmath80 and @xmath81 , can be thought of respectively as the true and false positive rates normalized to the area of @xmath76 , so that @xmath82 and @xmath83 .",
    "these quantities are analogs of the true and false positive rates from the analysis of classification data .    as discussed above ,",
    "because it depends highly on the distribution of measurement errors and other factors , the choice of @xmath75 will be context - specific .",
    "we therefore advise a validation study tailored to the application at hand , if such a study is possible .",
    "indeed , in section [ sec : validate ] we present validation data both to confirm the tube - fitting algorithm and to aid in selecting @xmath75 for our spect imaging application .",
    "however , a study of this kind is not always possible , so here we present a brief simulation designed to provide a basis for evaluating the interplay between the choice of @xmath75 and noise levels in the image .",
    "we posit an underlying collection of true points from an ellipse and add spherical noise .",
    "the goal is to estimate the ellipse .",
    "thus , two sources of variation are considered , the sampling of underlying true points and noise .",
    "the simulation consisted of the following steps :    1 .",
    "points are sampled uniformly from the interior of the underlying ellipse  @xmath10 .",
    "normal errors with variance matrix @xmath84 are added to the sampled points to give observed points .",
    "3 .   from the observed points ,",
    "a bivariate normal is estimated and used to construct @xmath85 for a range of @xmath86 values .",
    "4 .   @xmath80 and @xmath81 are calculated for each of the @xmath75 values .",
    "these steps are iterated @xmath87 times each for a variety of ellipse shapes and measurement error variances .",
    "figure [ fig : alphasim ] shows some of the ellipses @xmath10 used in our simulation , as well as a representative collection of sample points and observed points .",
    "we found that two main factors should contribute to the choice of @xmath75 : the measurement error variance and the eccentricity of the ellipse .",
    "the eccentricity of an ellipse with semi - major and -minor axes @xmath88 and @xmath89 , respectively , is defined as @xmath90",
    ". for low measurement error variance , say , @xmath91 , the eccentricity of the ellipse is irrelevant : taking @xmath92 gives @xmath93 and @xmath94 . for large measurement error variance",
    ", the eccentricity of the ellipse is quite important . indeed , for an ellipse with @xmath95 and @xmath96 , @xmath97 yields @xmath93 and @xmath98 , while for an ellipse with @xmath99 and @xmath96 , the same choice of @xmath75 gives @xmath100 and @xmath101 .",
    "figure [ fig : alphares ] shows the results of our simulation study .",
    "we present these results in two ways .",
    "first , keeping the eccentricity of the ellipse constant , we examine the effect of varying @xmath102 on @xmath80 and @xmath81 .    .",
    "for all panels , the solid line represents @xmath80 and the dashed line @xmath81 . in the top row ,",
    "each panel fixes the shape of @xmath10 and varies @xmath102 , while in the bottom row @xmath102 is fixed for each panel and the shape of the ellipse changes . ]",
    "second , we keep @xmath102 constant and allow the shape of the ellipse to vary .",
    "finally , we note that the results presented here hold for ellipses in other scales ; that is , @xmath80 and @xmath81 as a function of @xmath75 are the same for @xmath103 and @xmath104 and for @xmath105 and @xmath106 .      finally , we used a simulation study to examine the effect of choosing an ellipse as the shape for the tube s cross section when the true cross section is nonelliptical .",
    "we used a variety of cross - sectional shapes : a square , a `` u '' and , for reference , a circle . for each cross section",
    ", we created a three - dimensional structure by stacking fifty copies of the shape , one on top of the next .",
    "we applied the tube - fitting algorithm as presented ( that is , using an ellipse as the cross section ) with @xmath92 to each of these structures .    in figure",
    "[ fig : ellsim ] , we show each of the cross sections , as well as a typical estimated ellipse . for the square , our ellipse misses the corners and mistakenly includes extra points on the sides .",
    "however , the true and false positive rates , 0.967 and 0.146 , respectively , indicate that miss - specifying the cross - sectional shape in this case still provides a reasonable estimate of the three - dimensional structure .",
    "we note that using a convex hull as to estimate the extent of this structure would be ideal , having a true positive rate equal to 1 and a false positive rate equal to zero . for the `` u '' shape ,",
    "the ellipse includes almost all of the true image points , but also includes a large number of nonimage points ; the true and false positive rates are 0.98 and 0.338 .",
    "this cross - sectional shape is particularly difficult ; a convex hull would include many nonimage points and have a high false positive rate . for the circle ,",
    "the ellipse performs well , as is expected ; the true and false positive rates are 1 and 0.089 .",
    "further , we note that taking @xmath107 , rather than @xmath92 , gives true and false positive rates equal to 1 and 0 , respectively .    from this simulation",
    ", we see that misspecification of the cross - sectional shape can result in a lower true positive rate and higher false positive rate , but that the performance of the fitted tube is generally still reasonable .",
    "moreover , in situations where the true cross section is approximately or exactly elliptical , as is true in our applications , the fitted tube performs quite well .",
    "last , we reiterate that the choice of the cross - sectional shape is the last step of the tube - fitting algorithm , and can be changed in a straightforward way in other applications without affecting the majority of the algorithm .",
    "before applying our tube - fitting algorithm to image data , we pursued a brief validation study using mathematical phantoms .",
    "a mathematical phantom is simply a shape , created digitally , which is then passed through a computational model of the imaging process .",
    "accurate computational models of diffusion imaging are not available due to the inherent complexity of nuclear spin systems and water diffusion . on the other hand , very accurate models for some transmission and emission imaging , such as x - rays , planar scintigraphy , spect , pet ( positron emission tomography ) and ct ( x - ray computed tomography ) are available . in these cases",
    "the imaging process is perhaps simpler to model than in mri and highly accurate models of the imaging physics have been created . to generate the spect images for validation , we used system models implemented in the division of medical imaging physics in the department of radiology at the johns hopkins university . in this method ,",
    "the projection data of the phantom were obtained using an analytical projector that models all of the important components of the images physics , including photon interactions inside both the phantom and the detector system .",
    "the 3d spect images were then reconstructed from the projection data using an iterative statistical algorithm .",
    "our phantom is a three - dimensional coil of fixed diameter ; we also investigated coils with monotonically increasing or decreasing diameters , with very similar results .",
    "the phantom was projected using the analytical projector described above with effects of attenuation and detector resolution blur .",
    "poisson noise with data - derived means was also added to the projection data .",
    "several noise levels were investigated to mimic images taken at baseline , three hours , 10 and 24 hours after introduction of the tracer .",
    "( later images are noisier than earlier images . )",
    "the spect images were reconstructed using the os - em algorithm [ @xcite ] .",
    "each image had an imaging space of over 20,000 nonbackground voxels .",
    "to speed up curve - fitting and tube - fitting algorithms , we randomly sampled 1000 locations among these , separately for each validation image .",
    "the algorithms were run on the sampled locations , and the resulting fitted tube was compared to the true underlying anatomical structure .",
    "additionally , we varied the level set of the bivariate normal used to define the tube at each point along the fitted curve , which is equivalent to varying the choice of @xmath75 .",
    "particularly , we were interested in the proportion of points included in the tube that were indeed in the anatomical structure ( true positives ) , the proportion of points included in the tube that are not in the structure ( false positives ) , and the effect of @xmath75the level of the bivariate normal used in constructing @xmath108on these rates .",
    "our goals are to maximize the true positive rate while minimizing the false positive rate ; that is , we want our tube to be large enough to capture the structure but not so large as to include extraneous points",
    ".    there are two important differences between our current validation study and the simulation study in section [ subsec : alpha_sim ] .",
    "the first is that our current study is tailored to the spect application , and is therefore preferable for selecting @xmath75 in this setting .",
    "second , the true and false positive rates discussed here are taken over the entire fitted tube , rather than at a single fitted ellipse as in our previous simulations .        it is worth noting that the fitted tube captured the shape of the anatomical structure quite well , even in noisier images .",
    "as seen in the left panel of figure [ falseposneg ] , the false positives and false negatives occurred primarily in a thin layer on the outer surface of the anatomical structure .",
    "these errors are at least in part due to variations in the fitted curve and tube induced by randomly sampling 1000 points from the more that 20,000 nonbackground voxels rather than to a general deficiency in the tube - fitting algorithm .",
    "all other errors occurred at the endpoints of the tube , due to the placement of the user specified endpoints in the the curve - fitting algorithm .",
    "we include in the right panel of figure [ falseposneg ] a similar image for a tube constructed using standard orthogonal projections . here , the false positives occur almost exclusively on the interior side of the structure and the false negatives occur almost exclusively on the exterior side ; this is consistent with our concerns above , namely , that orthogonal projections skew toward the interior of the fitted curve .",
    "these observations reinforce our projection method and give us confidence in the ability of the tube - fitting algorithm to accurately reproduce an imaged structure .",
    "figure [ rates ] shows the true and false positive rates as a function of @xmath109 . from these graphs we see that for a fixed @xmath75",
    ", noisier images contain greater rates of both true and false positives ; the noise in the image leads to a wider fitted tube .",
    "we also note that the @xmath75 level set used to construct the tube does not correspond to the true positive rate .",
    "hence , it must be viewed as a tuning parameter used to balance the true and false positive rates .",
    "based on these figures , we select @xmath110 , depending on the amount of noise in the image . for noiseless images ( shown in figure [ rates ] as `` truth '' ) , choosing @xmath111 gives a true positive rate @xmath1120.95 and a false positive rate @xmath1120.15 ; for our noisiest image ( 24 hours after baseline ) , choosing @xmath113 gives similar rates .",
    "we note that our selection is based on visual inspection rather than a well - defined optimizing procedure .",
    "we first consider the spect colon image , which was taken shortly after introduction of the tracer . we first filtered the image with a simple histogram filter to remove low intensity background noise and artifacts from the reconstruction process .",
    "next we sampled a subset of the remaining points to both fit the curve and the tube .",
    "we used the modified principal curve - fitting algorithm with @xmath114 final degrees of freedom to find the centerline .",
    "next , we employed the tube - fitting algorithm with a time window width @xmath115 and @xmath116 .",
    "other time windows produced generally similar results .",
    "however , shorter windows are more sensitive to local variations in the density of sampled points , whereas longer windows oversmooth and lose some gross anatomical features .",
    "figure [ colonimg ] shows the sampled colon data , the fitted curve and the fitted tube colored according to tracer concentration .",
    "as described above , the tracer concentration at each point along the curve was taken to be the summed concentration of those points used to define the tube at that point . though the fitted tube plausibly recreates colon anatomy in terms of shape and width , we are unable to make a comparison between the fitted tube and the subject s colon",
    ". spect - ct scanners typically produce poor ct scans ; therefore , we lack good anatomical images that could be used to make this comparison .",
    "however , a benefit of the tube - fitting method is that it allows us to recreate the colon without radiating participants unnecessarily or requiring additional expensive equipment .",
    "figure [ concenbydist ] shows the concentration - by - distance curve . to find distance along the curve",
    ", we initially employed the arc - length formula @xmath117 using the final fitted curve .",
    "though often the gradient of the fitted curve is easy to calculate , a closed - form solution for the integral is not available .",
    "we have found that simply calculating distance using the function value along the fine grid of values of @xmath18 used to create the tube is equally accurate .",
    "that is , we simply use linear approximation between equally spaced latent time points to measure distance along the curve .",
    "-window and voxel - neighborhood approaches .",
    "each curve is normalized to its maximum value . ]",
    "computing the concentration at each distance from the curve onset can be accomplished in a variety of ways . using the the neighborhood of @xmath35 described in section [ sec : tube ]",
    ", we can define for each ellipse the collection of intensities @xmath118 for those points @xmath45 that are used to estimate the tube @xmath76 .",
    "a straightforward approach defines a proxy for the concentration as @xmath119 .",
    "however , a more accurate measure of concentration is @xmath120 , where @xmath121 , which takes the cross - sectional area of the colon into account .",
    "we compare these methods for finding concentration to those using a voxel - wise squared neighborhood approach [ @xcite ] .",
    "this approach consists of finding all image points that fall within a cube of a given edge length and summing the concentrations of those points .",
    "three comparative drawbacks are apparent in this method : ( i ) as in the case of the projections above , points that are near in terms of euclidean distance but not @xmath18-distance may be included ; ( ii ) there is no way to account for the width of the colon at each point ; and ( iii ) the voxel - neighborhood approach is significantly more computationally intensive , especially for larger cube sizes .",
    "notice in figure  [ concenbydist ] that the voxel - neighborhood approach potentially underestimates concentration by averaging background voxels along with nonbackground .",
    "our second application is to a diffusion - tensor tractogram of the intracranial portion of the corticospinal tract ; this tract runs from the cerebral cortex of the posterior frontal lobe to the spinal cord and consists primarily of motor axons .    as with the colon application",
    ", we begin by implementing the curve - fitting algorithm to the image data to find a centerline . though the imaged tract has less apparent complexity than the colon , to achieve an optimal fit we use @xmath122 as the final degrees of freedom .",
    "it is also worth noting that the image contains only 231 locations , so no sampling is necessary .",
    "( the point density of dti - derived tractograms can be highly variable , and , as noted above in section [ subsec : dti ] , there is substantial undersampling bias for tractograms of the corticospinal tract . )",
    "next , we employ the tube - fitting algorithm with time - window width of @xmath123 and @xmath124 .",
    "the time - window width is much wider than in the case of the colon application due to the relative sparsity of points : a wider window is necessary to fit reasonable bivariate normals , though such a wide window may smooth some of the finer details of the tract .",
    "a lower @xmath75 is chosen because of the low noise level in the tract image .    in section [ subsec : dti ]",
    "we noted that one of the goals of dti is to compare tract - specific mri quantities across patients .",
    "for example , we would like to compare the fractional anisotropy ( fa ) at many points along the cortico - spinal tract across subjects .",
    "previously , tract profiles have been constructed slice - by - slice ; that is , by using the average fa in a spatial window for each axial slice .",
    "profiles constructed in this way have correlated promisingly with clinical disability scores ; however , this approach only works well when the tract is perpendicular to the axial plane , and , moreover , only uses information in one plane rather than borrowing information from neighboring planes .",
    "instead , we propose to use the fitted tube to construct the fa profile . here , the fitted tube is overlayed on the fa map and those points on the interior of the tube are used to estimate the profile . at each point along the tract , the fa value is taken to be the weighted average of those points falling in the @xmath18-window , just as we estimated the concentration in our spect example .",
    "this approach has the following benefits : ( i ) it follows the anatomical course of the tract ; ( ii ) it can be used when the tract is not orthogonal to any cardinal imaging plane ; and ( iii ) it smoothly estimates the tract s fa profile .",
    "figure [ fig : faprofile ] shows a single subject s left cortico - spinal tract with image points scaled by fa value , and the fa profile generated using both the tube - fitting algorithm and the slice - by - slice approach .",
    "note that the tube - fitting approach results in a smoother profile .",
    "more importantly , the tube - fitting method gives a profile that follows the course of the tract and accurately represents fa values at each position along the tract , whereas the slice - by - slice approach gives fa values in a given imaging plane .",
    "we have introduced a novel method for fitting three - dimensional tubes to imaging structures .",
    "notably , we demonstrated the utility of the method on two very distinct imaging applications under different imaging modalities . in the colon spect imaging application ,",
    "the tube - fitting method greatly improves upon previously used method of voxel - wise square neighborhoods .",
    "moreover , our method produces an accurate mathematical model of the structure .",
    "such characterization of the object of interest could be useful for subsequent shape analysis and for defining new measures of extent , volume and other features of anatomical structures .    with regard to future applications",
    ", we note that the ongoing spect study is now collecting dual - isotope images , with the goal of comparing the relative distribution of microbicidal lubricants and hiv - infected semen in the colon .",
    "surrogates for both , tagged with tracers emitting gamma photons with different wavelengths , are injected at the same time and are simultaneously imaged .",
    "such dual - isotope studies may lead to drastically improved fits  using image data from both tracers greatly increases the number of points available for our curve- and tube - fitting algorithms .",
    "however , these studies raise the problem of accurately distinguishing and characterizing two tracer distributions in the colon",
    ". moreover , the study now collects images serially at several time points , giving us the opportunity to study changes in the concentration - by - distance curves over time .",
    "we are currently investigating the use of the accompanying x - ray computed tomography image for registration across time .",
    "also , determining an anatomical landmark to compare curves across subjects remains difficult .",
    "we anticipate that bone landmarks from the ct image could be used to solve this problem , though we acknowledge that the colon can be fairly mobile across time and it s relation to bones may not be straightforward .    in the case of dti tractography , the application of the tube - fitting algorithm to longitudinal images of multiple sclerosis patients will provide measures of disease progression .",
    "ideally , one could use these measures to provide clinical evidence for the effectiveness of treatments . validating",
    "the prediction performance of such measures remains an important problem .",
    "moreover , the curve - fitting technique may not be applicable to all tracts ( see figure [ difficult ] ) , and without an accurate centerline or without additional assumptions such as spatial contiguity of all points within the tract ( so that the sampled tracts shown here can be considered nonrandom undersamplings ) , the tube - fitting algorithm will not work .",
    "a possible solution could be to adapt the curve - fitting technique found in @xcite that uses tractography path information for use in these more difficult tracts .",
    "also , we are currently only using tracts created after ample preprocessing .",
    "quantities derived from the original dti image , such as anisotropy or diffusivity measurements , may produce more informative summaries of the tube .",
    "it is also possible that tube - fitting for this problem is best integrated into the tractography algorithm , which we have currently treated as a completely separate preprocessing step .",
    "alternatively , the tensor itself could potentially be used to derive the individual tubes , obviating the need for tractography .",
    "however , we note that the fact that our algorithm only relies on existing tractography algorithms is also a strength , as it can be immediately applied",
    ".        we also note that one of the most important white matter tracts , the corpus callosum , which connects the left and right hemispheres of the brain , is not a tube - like structure .",
    "instead it is more of a surface , with no clear centerline .",
    "clearly , to analyze such structures a different approach is necessary .",
    "we are investigating the possibility of using principal surfaces for this task [ @xcite ; @xcite ] .",
    "a related problem germane to both application is the study of curves and tubes across individuals and across time .",
    "for example , the analysis of the volume / distance curves or the analysis of other features estimated by the tube remains an open question .",
    "the curve - fitting algorithm itself could be improved . as seen above ,",
    "it is not universally applicable .",
    "moreover , a more automated algorithm with less user input is desirable .",
    "we are currently experimenting with a new stochastic search algorithm for finding centerlines , such as the use of genetic algorithms and simulated annealing .",
    "a benefit of these approaches is the wide range of objective functions which can be constructed to force a desired curve fit .",
    "the tube - fitting algorithm presented here is a novel approach for the estimation of the the support of distributions in three dimensions .",
    "it is limited in that it requires the support to have a reasonable centerline and in that it uses ellipses to estimate the cross - sectional extent .",
    "however , it has proved a useful algorithm in two applications and holds a good deal of potential to be utilized in the field of medical imaging .",
    "the authors would like to acknowledge the national multiple sclerosis society for funding the acquisition of the dti data ."
  ],
  "abstract_text": [
    "<S> we are concerned with the estimation of the exterior surface and interior summaries of tube - shaped anatomical structures . </S>",
    "<S> this interest is motivated by two distinct scientific goals , one dealing with the distribution of hiv microbicide in the colon and the other with measuring degradation in white - matter tracts in the brain . </S>",
    "<S> our problem is posed as the estimation of the support of a distribution in three dimensions from a sample from that distribution , possibly measured with error . </S>",
    "<S> we propose a novel tube - fitting algorithm to construct such estimators . </S>",
    "<S> further , we conduct a simulation study to aid in the choice of a key parameter of the algorithm , and we test our algorithm with validation study tailored to the motivating data sets . </S>",
    "<S> finally , we apply the tube - fitting algorithm to a colon image produced by single photon emission computed tomography ( spect ) and to a white - matter tract image produced using diffusion tensor imaging ( dti ) .    ,    ,    ,    ,    . </S>"
  ]
}