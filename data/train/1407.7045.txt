{
  "article_text": [
    "a triangulation of a manifold can be given a geometric structure by assigning compatible geometric structures to its component simplices .",
    "one of the easiest ways of doing this is to assign constant curvature geometries to the simplices , as these simplices are uniquely determined by their edge lengths .",
    "such a structure gives a finitely parametrized set of geometric structures on a closed manifold .    in thurston s formulation of the discrete riemann mapping problem ( see @xcite ) as well as in applied methods such as discrete exterior calculus ( see , e.g. , @xcite , @xcite ) , it is important to not only have a piecewise constant curvature metric assigned to simplices , but also to give a structure to the poincar dual of the triangulation .",
    "such structures arise naturally as incircle duals in thurston s formulation of circle packings and as circumcentric duals in discrete exterior calculus . for piecewise euclidean surfaces and 3-manifolds , in @xcite and @xcite",
    "the first author gives an axiomatic treatment of geometric duality structures that have orthogonal intersections with the primal simplices , and also relates these to discrete conformal variations .",
    "the goal of the present work is to make precise the parametrization of duality structures by partial edge lengths ( giving a discrete analogue of a riemannian metric ) , define the general form of discrete conformal structures based on an axiomatic development related to conformal variation of angle , and derive a local classification of such structures .",
    "the relationship between duality structures and discrete metrics requires some understanding of possible geometric centers for triangles , leading to the definition of the span of a triangle as the space of possible geometric centers",
    ". the axiomatic development of conformal structure follows that in @xcite for piecewise euclidean surfaces , while the construction in piecewise hyperbolic and spherical surfaces is new .",
    "the general formulas for angle and curvature variation of piecewise hyperbolic and spherical surfaces is new ( however , see the parallel work in @xcite ) , generalizing circle packings and other discrete conformal structures previously studied by many authors ( see section [ sec : previous formulations ] for details ) .",
    "the local classification of discrete conformal structures , giving explicit formulas for the structures , is new for each geometry including euclidean .",
    "we will begin by making these geometric structures precise , and then give precise statements of the main results .      in this section ,",
    "we make precise some geometric structures .",
    "a triangulated manifold @xmath0 is a topological manifold @xmath1 together with a triangulation @xmath2 of @xmath1 .",
    "a ( triangulated ) _ piecewise constant curvature manifold _ @xmath3 _ with background geometry @xmath4 _ is a triangulated manifold @xmath0 together with a function @xmath5 on the edges of the triangulation such that each simplex can be embedded in @xmath4 , a space of constant curvature , as a ( nondegenerate ) simplex with edge lengths determined by @xmath5 .    when the background geometry is euclidean ( @xmath6 ) , hyperbolic ( @xmath7 ) , or spherical ( @xmath8 ) , we call such a manifold _ piecewise flat _ , _ piecewise hyperbolic _ , or _ piecewise spherical _ , respectively .",
    "when the background geometry is clear from context , we may omit it . note",
    "that part of the definition is that the simplices are nondegenerate ; this places inequality restrictions on the possible edge lengths .",
    "for instance , in euclidean background the restrictions can be derived from cayley - menger determinants .",
    "we will use @xmath9 to denote the vertices in triangulation @xmath2 and label them with numbers or letter such as @xmath10 .",
    "we will use @xmath11 to denote edges and label them as a set of vertices @xmath12 , although most of this work could allow multiple edges between the same vertices or edges between the same vertex .",
    "we will use @xmath13 to denote oriented edges and label them with ordered pairs @xmath14 .",
    "triangles will be denoted as a set of vertices , such as @xmath15 . in a piecewise constant curvature manifold , the angle at vertex @xmath16 in a triangle @xmath15",
    "will be denoted @xmath17 .",
    "the set of real valued functions on @xmath18 or @xmath19 will be denoted by @xmath20 and @xmath21 , respectively .",
    "we will use @xmath22 to mean that @xmath23 is a subsimplex of @xmath24 .",
    "the idea of a duality structure is that , in addition to the metric structure of a piecewise constant curvature manifold , we can put a geometric structure on the poincar dual cell complex by introducing geometric centers for pieces of the dual complex .",
    "motivated by the euclidean background case , we see that these geometric centers do not have to be constrained to the simplex , but its affine span . in the more general constant curvature case",
    ", we will need an analogue of the affine span that defines the space of possible simplex centers .",
    "since a piecewise constant curvature manifold is subdivided by simplices that can be embedded into the space @xmath4 , each simplex @xmath25 has a span defined as follows .",
    "first we need to define the underlying space of the span in each geometry .    given a constant curvature geometry @xmath4 , we define @xmath26 as follows :    * if @xmath27 then we take @xmath26 to be the underlying space @xmath28 . *",
    "if @xmath29 then we take @xmath26 to be the entire space of the klein model , also described as the extended hyperbolic plane in @xcite .",
    "note that in this case , @xmath30 .",
    "* if @xmath31 then we take @xmath26 to be the quotient @xmath32 of the sphere .",
    "we note the following easy facts about @xmath26 .    * in each case , the isometry group of @xmath4 acts on @xmath26 .",
    "* in each case , there is a notion of orthogonality between two vectors , induced from the euclidean dot product in the cases of euclidean space and the sphere , and the lorentzian bilinear product using the hyperboloid model of hyperbolic space and projecting to the klein model space . * in each case , any two points in @xmath26 can be connected by a line .    in",
    "what follows , we will assume that any simplex modeled on geometry @xmath4 can be isometrically embedded into @xmath26 , and that embedding is unique up to isometry of @xmath4 .",
    "note that , in the case of spherical geometry , the fact that a simplex embeds is a restriction on how big it can be .",
    "we are now ready to define the span .    given a simplex @xmath25 and an isometric embedding @xmath33 , the _ span of @xmath25 under @xmath34 _ , denoted @xmath35 , is the set @xmath36 where @xmath37 is the line through the points @xmath38 and @xmath39 .",
    "the _ span of @xmath25 _ , denoted @xmath40 , is the quotient space obtained from the disjoint union @xmath41 by identifying each pair of summands @xmath35 and @xmath42 by an isometry of @xmath4 that agrees with @xmath43 .",
    "we remark that our definition is analogous to the definition of affine span in polytope theory ( c.f . , @xcite ) .",
    "in both definitions , the span is viewed as a ( geodesic ) hyperplane tangent to the simplex / polytope - face as it sits in the ambient geometry .",
    "the span has the property that for any points @xmath44 and @xmath45 , there is a unique line between @xmath46 and @xmath47 in @xmath48 .",
    "the span also has the property that if @xmath49 then there is a natural way in which @xmath50 .",
    "suppose @xmath3 is a piecewise constant curvature manifold with background geometry @xmath4 .",
    "a _ duality structure _ for @xmath0 is a choice of one point @xmath51",
    "\\in s\\sigma$ ] from each simplex @xmath25 of @xmath2 , subject to :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if @xmath52 then for any simplex @xmath53 , c[\\sigma^{\\ell+1 } ] , \\ldots ,      c[\\sigma^k]\\}$ ] , we have that @xmath54 is orthogonal to @xmath55 intersecting only at @xmath56 $ ] .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we say a duality structure is _ proper _ if it has euclidean or spherical background or has hyperbolic background and the center of each edge is in @xmath57",
    ".    notice that in the case of spherical background , the centers lie in @xmath32 and so correspond to two points in @xmath58 .",
    "we will often consider the span as @xmath58 with pairs of points instead of @xmath32 .",
    "proper duality structures are ones such that edge centers are determined by signed distances from the vertices , as determined by the partial edge lengths in the next section .    in general",
    ", we will denote the center of edge @xmath59 by @xmath60 and the center of triangle @xmath15 by @xmath61 .",
    "these centers determine edge heights .    given a proper duality structure on a triangle @xmath15 , each edge @xmath59 has a corresponding edge height @xmath62 determined by one of the following :    * if the center @xmath61 is in the same half plane determined by the span @xmath63 as the simplex @xmath15 is , @xmath62 is the distance between @xmath60 and @xmath61 . * if the center @xmath61 is not in the same half plane determined by the span @xmath63 as the simplex @xmath15 is , @xmath62 is the negative of the distance between @xmath60 and @xmath61 . *",
    "if the center @xmath61 is in @xmath64 but not in @xmath57 , then the height is the distance from @xmath60 to @xmath65 ( see section [ section : hyperbolic basics ] ) with the same sign convention .      the definition of duality structure requires choosing centers . for a more explicit parametrization , we will try to adjust the metric structure @xmath5 in some way to ensure a duality structure .",
    "this is the role of metrics and pre - metrics .",
    "the notion of a pre - metric is to reassign parts of the length function to the vertices .",
    "this is motivated partly by the definition of riemannian metrics as tensor valued functions of the points of a manifold .",
    "[ def : pre - metric ]    let @xmath66 be a triangulated manifold .",
    "pre - metric _ is an element @xmath67 such that @xmath68 is a piecewise constant curvature manifold with background geometry @xmath4 for the assignment @xmath69 for every edge @xmath70    the @xmath71 are sometimes called partial edge lengths , since one considers the edge @xmath59 divided into two partial edges of length @xmath71 and @xmath72 .",
    "if the partial edge lengths are nonnegative , there is a point on the edge that is distance @xmath71 from vertex @xmath16 and distance @xmath72 from vertex @xmath73 , and this point is called the edge center .",
    "note that if one of the partial edge lengths is negative , there is an interpretation in terms of signed distance , and there is still a center , this time on the span of the edge .",
    "we would like to restrict pre - metrics to those that generate geometries on the poincar dual structure such that dual and primal cells intersect orthogonally .",
    "if one considers the point @xmath60 on the span of an edge @xmath59 that is distance @xmath71 from vertex @xmath16 and @xmath72 from vertex @xmath73 ( distance can be considered with sign so one partial edge length can be negative ) , a center is determined .",
    "one can consider the plane orthogonal to the span s@xmath59 through @xmath60 , and use the intersections of these planes to construct more centers ( e.g. , if the planes of the three edges of a triangle intersect at a point then we use that point as the center of the triangle ) .",
    "this construction is explained in detail for euclidean background in @xcite .",
    "we wish to characterize which conditions on the pre - metrics guarantee that these centers exist and give a duality structure .",
    "we call these metrics , and the actual motivations for the following definitions are characterization theorems given later . the main advantage of metrics over duality structures is that the metrics entirely parametrize the geometry , and so the space of metrics is relatively easy to describe .",
    "[ def : metric ] a _ discrete metric _ , or _",
    ", on @xmath74 with background geometry @xmath4 is a pre - metric @xmath75 such that for every triangle @xmath76 in @xmath2 , @xmath77 a _ piecewise constant curvature , metrized manifold _",
    "@xmath78 with background geometry @xmath4 is a triangulated manifold @xmath74 together with a metric @xmath75 .",
    "we denote the space of all metrics with background geometry @xmath4 on a given triangulated manifold @xmath66 by @xmath79 .",
    "note that the space of metrics @xmath79 on a finite triangulation is determined as a subset of @xmath80 by a number of equalities of the form above ( one for each triangle ) and a number of inequalities ( to ensure the simplices are nondegenerate ) .",
    "a discrete conformal structure is a particular way of determining the metric from information assigned to points ( vertices ) .",
    "it is partly motivated by this characterization of conformal change of a riemannian metric , and also by thurston s formulation of conformal circle packing structure .",
    "a general formulation for euclidean background is described in @xcite , and there are a number of formulations of specific cases of analogous structures in hyperbolic and spherical backgrounds ( see section [ sec : previous formulations ] ) .    based on propositions [ prop : euclidean compatibility ] ,",
    "[ prop : hyperbolic compatibility ] , and [ prop : spherical compatibility ] , if we suppose that the pre - metric is determined by weights on the vertex endpoints , there is a restriction that ensures that the resulting pre - metric is actually a discrete metric , i.e. , it determines a duality structure .",
    "in addition , we want conformal structures to have nice formulas for angle variations .",
    "this motivates the following definition .",
    "[ def : conformal structure ] a _ discrete conformal structure _ @xmath81 on a triangulated manifold @xmath74 with background geometry @xmath4 on an open set @xmath82 is a smooth map@xmath83 such that if @xmath84   $ ] then for each @xmath85 and @xmath86 , @xmath87 and @xmath88 if @xmath89 and @xmath90 .",
    "a _ conformal variation _ of a metric @xmath91 $ ] is the change of the metric in the conformal class as @xmath92 changes , and is determined by derivatives such as @xmath93 .",
    "we have chosen the parameter @xmath92 so that the variation formulas above are as simple as possible .",
    "however , we will sometimes choose to parametrize the structures differently ( see theorem [ thm : functional ] ) . also note that with conformal variations , the choice of the set @xmath94 is not particularly important ; we only need the existence of a neighborhood around any point in @xmath94 .      in this paper",
    ", we study the relationships between duality structures , discrete metrics , and conformal variations .",
    "the main new contributions are the following : ( 1 ) a characterization of duality structures in hyperbolic and spherical backgrounds , generalizing the notion of length structures arising from circles with given radii and inversive distances , ( 2 ) calculation of the conformal variation of angles in a triangle for hyperbolic and spherical backgrounds together with determining a functional making the curvature variational , and ( 3 ) a classification theorem for discrete conformal variations of euclidean , hyperbolic , and spherical triangles , including the formulation of the notion of discrete conformal variations from basic principles .",
    "the following theorem characterizes duality structures on surfaces in each of the constant curvature backgrounds .",
    "[ thm : duality equals metric ] let @xmath3 be a piecewise constant curvature 2-manifold .",
    "there is a one - to - one correspondence between proper duality structures on @xmath3 and discrete metric structures on @xmath3 .",
    "this theorem follows from propositions [ prop : euclidean compatibility ] , [ prop : hyperbolic compatibility ] , and [ prop : spherical compatibility ] .",
    "the following theorem gives the variation of angle formulas .",
    "the euclidean result is in @xcite , and the hyperbolic and spherical results are new ( compare @xcite ) .",
    "[ thm : angle variation ] for any conformal variation of a metric @xmath91 $ ] with background geometry @xmath4 of a surface @xmath95 , we have for any edge @xmath59 the following formulas .",
    "* in euclidean background , @xmath96 * in hyperbolic background , @xmath97 where @xmath98 is 1 if @xmath61 is timelike and -1 if @xmath61 is spacelike . *",
    "in spherical background , @xmath99    this theorem follows from theorems [ thm : euclidean variation angle ] , [ thm : hyperbolic angle variation ] , and [ thm : spherical angle variation ] together with propositions [ prop : hyperbolic area deriv ] and [ prop : sphere area var ] .",
    "it turns out that although the variables @xmath92 for the conformal variations are quite natural , a change of variables gives that the curvatures are the gradient of a functional , where the curvatures are defined as @xmath100 for each vertex @xmath16 , where the sum is over all triangles containing @xmath16 .",
    "[ thm : functional ] consider a piecewise constant curvature , metrized 2-manifold @xmath101 , where @xmath102 is determined by a conformal structure .",
    "there is a change of variables @xmath103 such that @xmath104 and hence if we fix a @xmath105 there is a functional @xmath106 with the property that @xmath107 furthermore , if all @xmath108 and @xmath109 and then this function is strictly convex if @xmath7 and weakly convex ( strictly convex except for scaling ) if @xmath6 .",
    "this theorem follows from theorems [ thm : euclidean functional ] , [ thm : hyp functional ] , and [ thm : sphere functional ] .",
    "the following theorems classify discrete conformal variations in each of the constant curvature backgrounds .",
    "the results are new for all background geometries .",
    "[ thm : conformal classification ] let @xmath110 be a discrete conformal class with background geometry @xmath4 on a surface @xmath1 .",
    "then there exist @xmath111 and @xmath112 such that the conformal structure can be written as @xmath113 with @xmath114 if @xmath6 , @xmath115    with @xmath116 if @xmath7 , or @xmath117 with @xmath118 if @xmath8 .",
    "this theorem is proven in each case in sections [ section : eucl conf classify ] , [ section : hyp conf classify ] , and [ sec : sphere ] .    in light of theorem",
    "[ thm : conformal classification ] , one can also calculate angle variations from theorem [ thm : angle variation ] based on the conformal structures determined by @xmath119 and @xmath120 .",
    "these conformal structures are sometimes referred to as @xmath121 ( see , e.g. , @xcite ) .      in this section",
    "we briefly compare our parametrizations with other parametrizations of certain discrete conformal structures .",
    "the formulation in this paper unifies the previous work into a single formula for each background geometry and generalizes some of these .",
    "independently , @xcite derived a formula for the variation of angle that is essentially the same as ours , though we express it and prove it in a different way .",
    "we note that the euclidean background case was treated in @xcite , which also describes the relationship of the general case to previous formulations .",
    "the first formulation of the circle packing conformal structure ( corresponding , in our notation , to @xmath122 and @xmath123 for all vertices and edges ) is in thurston s work @xcite .",
    "many of the relevant calculations are followed through in @xcite , and the first variational formulation is due to colin de verdire in @xcite . in each of these cases ,",
    "the euclidean and hyperbolic cases were treated , and the conformal structures were either circles with given intersection angles between @xmath124 and @xmath125 ( corresponding , in our notation , to @xmath122 and @xmath126 for all vertices and edges ) .",
    "additional work was done by chow - luo in @xcite .",
    "the case of circles with fixed inversive distances ( corresponding , in our notation , to @xmath122 and @xmath127 for all vertices and edges ) was introduced by bowers and stephenson @xcite and the variational perspective was pursued by guo in @xcite ( this was anticipated by springborn s work on volumes of hyperideal simplices in @xcite ) .",
    "the multiplicative conformal structure ( corresponding , in our notation , to @xmath128 for all vertices ) was apparently first suggested in @xcite , but most of the mathematical ideas arose in work of luo @xcite and springborn - schrader - pinkall @xcite in the euclidean case .",
    "generalizing to the hyperbolic case was not obvious , but work in this direction first appeared in work by bobenko - pinkall - springborn @xcite .",
    "it is notable that the proper parametrization variable is not clear in this case , and this issue is discussed in section [ subsect : variational hyp ] .",
    "the unified case for euclidean background is given in @xcite and the hyperbolic case was first described in this paper and independently in @xcite . for more on some of these discrete conformal structures , see the books @xcite , @xcite , and @xcite .",
    "explicit calculation of the variation of angle coefficients in the euclidean circle packing case is due to z. he @xcite , and followed by the first author in @xcite .",
    "the coefficients are closely related to the discrete laplacians found in @xcite , @xcite , @xcite , @xcite , @xcite @xcite , @xcite , @xcite , @xcite , @xcite , and many other places .",
    "there are close connections between these variational viewpoints and hyperbolic volumes , as evidenced by work of brgger @xcite , rivin @xcite , garret @xcite , leibon @xcite , bobenko - springborn @xcite , springborn @xcite , springborn - schrder - pinkall @xcite , and bobenko - pinkall - springborn @xcite , fillastre - izmestiev @xcite , and zhang et .",
    "al . @xcite .",
    "some of this work was generalized to discrete conformal structures in three dimensions by cooper - rivin in @xcite and the first author in @xcite and @xcite .",
    "while the functionals whose variations lead to curvatures in two dimensions are possibly related to the log determinant of the laplacian and surface entropy ( see @xcite ) , in three dimensions the functional is related to regge s formulation of the einstein - hilbert ( total scalar curvature ) functional .",
    "see , e.g. , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "clearly , the choice of a pre - metric with euclidean background determines the geometry of each triangle @xmath15 and for any isometric embedding , specifies the triangle s sides @xmath129 with lengths @xmath130 . through each finite edge @xmath131 of the triangle we have a unique line @xmath132 , considered in @xmath133 .",
    "suppose we identify @xmath132 with the real number line such that @xmath134 is at the origin and @xmath135 is on the positive @xmath46 axis .",
    "given these coordinates , we specify the edge centers @xmath136 to be the point @xmath71 on the line .",
    "note that @xmath72 denotes the distance between @xmath60 and @xmath135 , considered with a sign determined by which side of @xmath135 in @xmath132 contains @xmath60 .    for each edge @xmath59",
    ", there exists a unique line @xmath137 that passes through @xmath60 and is orthogonal to @xmath132 .    in @xcite ( proposition 4 ) , the first author presented a necessary and sufficient condition on the partial edges to guarantee the three lines @xmath138 meet at a single point :    [ prop : euclidean compatibility ] suppose @xmath139 is a euclidean pre - metric .",
    "then the perpendiculars @xmath138 meet at a single point if and only if @xmath140    this motivates the euclidean case of definition [ def : metric ] and proves the euclidean case of theorem [ thm : duality equals metric ] .",
    "the conformal structure is defined in such a way as to give the following variational formula .",
    "[ thm : euclidean variation angle ] given a conformal structure , we have @xmath141 if @xmath142 and @xmath143",
    "this theorem is proven in @xcite , generalizing the theorems in special cases given in @xcite and @xcite .",
    "it follows easily ( see , e.g. , @xcite ) that the curvature is variational with respect to a convex functional .",
    "[ thm : euclidean functional ] the partial derivatives of the angles in a triangle are symmetric , i.e. , @xmath144 and hence if we fix a @xmath145 there is a functional @xmath146 with the property that @xmath147 furthermore , if all @xmath108 and @xmath109 and then this function is weakly convex ( strictly convex except for scaling ) .      in this section",
    "we prove the characterization theorem .",
    "recall that the only assumptions are :    * the compatibility condition [ d - euclidean condition ] for the triangle with vertices @xmath134 , @xmath135 , and @xmath148 .",
    "* the assumption that @xmath71 depends only on @xmath149 and @xmath150 .",
    "we first note that @xmath151 and that @xmath152 since for any triangle with vertices @xmath153 we have @xmath154 we can compute that @xmath155 since @xmath156 it follows that @xmath157 and so it follows that @xmath158 and @xmath159 we can solve these equations , getting @xmath160 for constants @xmath161 and @xmath162 hence @xmath163 we can now use ( [ l deriv ] ) to find that for a constant @xmath164 @xmath165 from this , we compute that @xmath166 we note that in a triangle , since @xmath167 and the right side is independent of @xmath168 differentiating with respect to @xmath169 gives @xmath170 and hence @xmath171 and @xmath172 is independent of the edge , only depending on the vertex , hence we rename @xmath173    to see that the @xmath174 and @xmath164 must be consistent across triangles , consider equation [ eqn : l - eucl ] on both triangles and differentiate with respect to @xmath149 and @xmath150 to see that the @xmath164 agree and then @xmath149 to see that the @xmath174 agree .",
    "before we move to the hyperbolic versions of the previous work , we will review some techniques for computing in hyperbolic geometry .",
    "this section summarizes the elementary facts about the hyperbolic plane @xmath57 that we will use in later calculations .",
    "all of the propositions in this section are discussed in chapter 3 of @xcite .",
    "see also @xcite . for the reader",
    "s convenience , we have included some , but not all , proofs .",
    "we use the hyperboloid model of @xmath57 for the majority of our calculations . in this model ,",
    "the vector space @xmath175 is equipped with a lorentzian inner product @xmath176 given by @xmath177 where @xmath178 is the diagonal matrix with entries 1,1,-1 .",
    "we define a `` hyperbolic magnitude '' @xmath179 ; the only possible hyperbolic lengths are nonnegative scalar multiples of 1 and @xmath16 .",
    "@xmath57 corresponds to those vectors @xmath180 satisfying @xmath181 and @xmath182 .",
    "a vector @xmath183 is termed _ spacelike _ if @xmath184 , _ lightlike _ ( or `` on the light cone '' ) if @xmath185 , and _ timelike _ if @xmath186 .",
    "the vector space structure on @xmath187 gives us several ways to describe a geodesic in @xmath57 :    * as a nonempty intersection @xmath188 for linearly independent @xmath189 .",
    "* as a nonempty intersection @xmath190 , where @xmath38 is a spacelike vector and @xmath191 .",
    "* as a path , parametrized by arclength , given by @xmath192 . in this form , @xmath193 , @xmath194 with @xmath195",
    "note @xmath38 and @xmath196 encode the position and direction of @xmath197 at @xmath198 .",
    "the second characterization becomes particularly useful when combined with the lorentzian cross product , which is given by @xmath199 . clearly , the lorentzian cross product has two useful properties :    * @xmath200 if and only if @xmath38 and @xmath39 are linearly dependent .",
    "* @xmath201 is @xmath176-orthogonal to both @xmath38 and @xmath39 .",
    "a consequence of the second observation is that given distinct points @xmath202 , one simple way to describe the geodesic through @xmath38 and @xmath39 is @xmath203 .    in the sequel",
    ", we will use @xmath204 to denote the hyperbolic distance between two timelike points , and @xmath205 to denote the hyperbolic distance between a timelike point and a geodesic in hyperbolic space determined as the orthogonal complement of a spacelike point .",
    "when @xmath206 satisfy @xmath207 , we have the following interpretations of the quantity @xmath208 :    * if @xmath209 and @xmath196 are both timelike , then @xmath210 . *",
    "if @xmath209 is timelike and @xmath196 is spacelike , then @xmath211 and the sign depends upon which of the halfspaces bounded by @xmath212 contains @xmath209 . * if @xmath209 and @xmath196 are both spacelike and @xmath213 and @xmath212 intersect in angle @xmath119 within @xmath57 , @xmath214 .",
    "notice that the last item implies that for spacelike @xmath209 and @xmath196 , @xmath213 and @xmath212 meet at a right angle if and only if @xmath215 .",
    "the following identities simplify calculations that involve lorentzian cross products .",
    "suppose @xmath216 : @xmath217    we have already seen that several different kinds of data can be used to specify a geodesic on @xmath57 .",
    "this allows us to extend our understanding of where geodesics intersect .",
    "[ definition intersection ] given a geodesics @xmath197 on @xmath57 , we will identify @xmath197 with the unique 2-dimensional subspace @xmath218 of @xmath175 such that @xmath219 is the image of @xmath197 .    given geodesics @xmath220 on @xmath57",
    ", we define their _ intersection _ to be their intersection as subspaces of @xmath175 , namely @xmath221 .",
    "readers familiar with the klein model of @xmath57 ( the central projection of @xmath57 onto the plane @xmath222 ) should note that this definition is simply a linear - algebraic way of formulating the notion of intersecting 1-hyperplanes in the klein model .",
    "introducing a broader notion of intersection allows us to generalize familiar equations ( like the law of cosines ) and express them in terms of linear algebra . understanding how to interpret the lorentzian inner product is key to relating these different formulas .",
    "often , the linear algebraic interpretation allows us to efficiently treat several seemingly different cases at once .",
    "recall the definition of a triangle ( see section 3.5 in @xcite ) , which allows some of the vertices to be timelike , lightlike , or spacelike .",
    "we will concentrate on triangles with at least two timelike vertices .",
    "[ proposition ratcliffe triangles ] suppose @xmath223 and @xmath224 are either timelike or spacelike",
    ". then @xmath225 where @xmath119 is the angle at @xmath46 in the ( clockwise oriented ) triangle @xmath226 .",
    "[ proposition generalized law of cosines ] suppose @xmath227 , with @xmath228 and @xmath229 or @xmath16 , are the vertices of a triangle in @xmath57 , with angle @xmath119 at @xmath46 .",
    "then @xmath230    assume , without loss of generality , that @xmath231 label the vertices of the triangle in clockwise order .",
    "equation [ eqn : det formula ] implies @xmath232 now apply proposition [ proposition ratcliffe triangles ] to obtain the desired equality .    by setting @xmath233",
    ", we obtain a generalized version of the pythagorean theorem :    suppose @xmath231 are the vertices of a right triangle , with the right angle at @xmath46 .",
    "then : @xmath234    we will require formulas for performing trigonometry in a hyperbolic right triangle where one of the vertices ( not the one adjacent to the right angle ) may be spacelike or timelike .",
    "suppose we have a right triangle labeled like the one in figure [ fig : right triangle ] .",
    "[ prop : trig ] given a triangle labeled as in figure [ fig : right triangle ] , we have : @xmath235 if @xmath236 is timelike and @xmath237 if @xmath236 is spacelike .",
    "deriving these formulas is an easy application of the generalized pythagorean theorem and the generalized law of cosines .",
    "the next corollary generalizes the familiar formula for the cosine of an angle in a hyperbolic right triangle .",
    "[ corollary cosine right triangle ] suppose @xmath231 are the vertices of a right triangle ( with the right angle at @xmath238 ) satisfying the assumptions of proposition [ proposition generalized law of cosines ] .",
    "then @xmath239    the right angle at @xmath238 means that : @xmath240 and so @xmath241    substituting this into the equation we obtain from the law of cosines , we learn : @xmath242 using equation [ eqn : det formula ] , it is easy to check @xmath243 .",
    "hence : @xmath244    because the lorentzian inner product is nondegenerate , we have a well defined notion of @xmath176-orthogonality and may apply the gram - schmidt procedure to obtain a basis of mutually @xmath176-orthogonal vectors .",
    "this procedure can be used to parametrize a geodesic given in the form @xmath188 by arclength .",
    "[ proposition gram - schmidt ] suppose @xmath193 , and @xmath245",
    ". then the geodesic @xmath246 may be parametrized by arclength as : @xmath247    the geodesic in question can be parametrized by arclength as @xmath248 for some spacelike @xmath196 with @xmath249 ; we simply need to use the gram - schmidt procedure to guarantee that @xmath250 and @xmath194 .",
    "so consider the vector @xmath251 .",
    "notice @xmath252 is the @xmath176-projection of @xmath39 onto the subspace spanned by @xmath38 , and @xmath253 to find @xmath196 , we only need to rescale this projection .",
    "since @xmath254 the appropriate @xmath196 is @xmath255",
    "we interpret a piecewise hyperbolic pre - metric as subdividing each edge @xmath59 of length @xmath256 into two portions of length @xmath257 and @xmath258 , that are assigned to the vertices @xmath16 and @xmath73 respectively .",
    "[ def : edge centers ] given a pre - metric @xmath75 and an isometric embedding of a simplex @xmath59 into @xmath57 :    * the _ vertices _ @xmath259 of @xmath59 are the images of @xmath16 and @xmath73 under the embedding . *",
    "the _ edge center @xmath60 induced by @xmath75 _ is the unique point along the line @xmath132 through @xmath260 and @xmath261 such that @xmath60 is ( signed ) distance @xmath71 from @xmath260 and @xmath72 from @xmath261 . *",
    "the _ edge perpendicular @xmath137 _ is the line through @xmath60 that is orthogonal to @xmath132 .    unlike in the euclidean setting",
    ", it is possible that the geodesics @xmath137 and @xmath262 do not intersect within @xmath57 . however , these two 1-hyperplanes can be understood as intersecting in the more general sense of definition [ definition intersection ] , namely the two - dimensional subspaces of @xmath187 associated to @xmath137 and @xmath262 intersect in a one - dimensional subspace .",
    "one can then ask for necessary and sufficient conditions on the pre - metric that guarantee that for each simplex @xmath15 @xmath263 or , colloquially , the three perpendiculars of @xmath15 intersect in a single point ( this point is in the span of @xmath15 ) .",
    "this condition can also be interpreted in the klein model of hyperbolic space as the condition that the three lines representing the geodesics intersect at the same point in the plane of the klein model .    [",
    "prop : hyperbolic compatibility ] suppose @xmath75 is a piecewise hyperbolic pre - metric .",
    "equation [ eqn : duality intersections ] holds if and only if the following _ compatibility equation _",
    "@xmath264 is satisfied for every simplex @xmath15 .",
    "since the vectors @xmath260 and @xmath60 are timelike of length -1 , equation [ eqn : dijhyp - reln ] has the following equivalent formulation : @xmath265    to simplify our notation , we shall consider a single 2-simplex @xmath266 .",
    "the vertices of the embedded 2-simplex are linearly independent vectors @xmath267 .",
    "consider that if @xmath268 is a point on the perpendicular @xmath137 , then @xmath269 .",
    "likewise the span of edge @xmath131 is given by @xmath270 .",
    "since @xmath60 belongs to both @xmath137 and @xmath131 , the fact that @xmath137 and @xmath131 are perpendicular is equivalent to the equation : @xmath271 identities [ eqn : cross product ident1]-[eqn : det formula ] imply this is equivalent to the equation : @xmath272 hence , equation [ eqn : duality intersections ] holds for simplex @xmath266 if and only if there is a nontrivial solution @xmath268 to the system : @xmath273 this system can be reformulated as a matrix equation @xmath274 that has a nontrivial solution if and only if the determinant of the first matrix is zero .",
    "expanding that determinant and canceling the ( nonzero ) factors of @xmath275 that arise yields equation [ eqn : dijhyp - reln ] .",
    "the last statement follows easily .",
    "this proposition motivates the hyperbolic case of definition [ def : metric ] .",
    "one can gain insight into how the euclidean and hyperbolic compatibility conditions are related by comparing equation [ d - euclidean condition ] and equation [ d - hyperbolic condition ] for small @xmath71 in the same way one compares the euclidean pythagorean theorem with the hyperbolic version , @xmath276 .",
    "various formulations of conformal variations of hyperbolic triangulations of surfaces have been studied in @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite .",
    "we present a unified approach from the perspective of the metric triangulations as defined above .",
    "suppose we wanted to generate a metric from weights assigned to vertices , so that @xmath277 for some function @xmath92 on the vertices .",
    "if this our starting point for conformal structure , in order to compute conformal variations , we will consider what happens to the metric on a triangle @xmath266 when the conformal parameter @xmath278 changes but the other two do not , i.e. , @xmath279 .",
    "we will call this a @xmath278-conformal variation in this section .",
    "the next two propositions analyze the configuration shown in figure [ figure conformal variation ] .",
    "we assume throughout that @xmath280 are linearly independent in @xmath175 , with @xmath281 .",
    "[ prop : inner product identities ] under an @xmath278-conformal variation : @xmath282    bilinearity of the lorentzian inner product implies : @xmath283 however , since @xmath284 , we can also write : @xmath285 hence @xmath286 we get the formula for @xmath287 similarly .",
    "finally , since @xmath288 : @xmath289    the following proposition makes precise what we mean by the colloquial statement that conformal variations give good angle variations .",
    "[ prop : conformal line ] let @xmath290 denote the center of the triangle specified by the vertices @xmath134 and the ( compatible ) partial edge lengths @xmath71 .",
    "suppose further that the edge centers on edges @xmath291 and @xmath292 are timelike . then under a @xmath278-conformal variation ,",
    "the points @xmath293 and @xmath290 lie on a line in @xmath57 if and only if @xmath294 , for some function @xmath295 .    without loss of generality ,",
    "assume @xmath296 .",
    "consider the geodesic through @xmath297 and @xmath290 .",
    "as a set , this geodesic can be described by @xmath298 , a characterization we will use to parametrize the geodesic by arclength as @xmath299 for some @xmath300 . specifically , proposition [ proposition gram - schmidt ] implies : @xmath301    the points @xmath293 , and @xmath290 lie on a geodesic if and only if @xmath209 and @xmath302 are collinear .",
    "the three numbers @xmath303 completely characterize the vector @xmath304 . hence , @xmath209 and @xmath302 are collinear if and only if there exists @xmath305 such that @xmath306 for @xmath307 .",
    "we already know @xmath308 , so only @xmath309 and @xmath310 require consideration .",
    "consider our equation for @xmath209 .",
    "the scalar in the denominator will appear in both @xmath309 and @xmath310 . to simplify our notation ,",
    "we will write @xmath311 . now @xmath312 and we can apply the generalized law of cosines ( proposition [ proposition generalized law of cosines ] ) to the triangle @xmath313 in order to rewrite this equation as @xmath314 next consider the right triangle with vertices @xmath315 . by corollary [ corollary cosine right triangle ]",
    ", we have @xmath316 a final substitution into our equation for @xmath309 implies @xmath317 a similar argument for @xmath318 yields @xmath319 from proposition [ prop : inner product identities ] , we know that for @xmath320 @xmath321 comparing these two equations , we see that there exists @xmath322 so that @xmath323 if and only if there exists a smooth function @xmath324 for which @xmath325 .",
    "proposition [ prop : conformal line ] motivates the hyperbolic case of definition [ def : conformal structure ] , where we have chosen to simplify to parameters that make @xmath326 equal to the constant function @xmath327 .",
    "we will now study how the angles change under a conformal variation .",
    "first we see the following .",
    "[ thm : hyperbolic angle variation ] given a conformal structure , then for any simplex @xmath15 @xmath328 where @xmath98 is 1 if @xmath61 is timelike and -1 if @xmath61 is spacelike .    for simplicity , we shall consider the problem for a single simplex @xmath266 labeled as in figure [ figure conformal variation ] , with @xmath329 , @xmath330 . we will address the case where @xmath290 is timelike ; the case where @xmath290 is spacelike is similar .",
    "once [ eqn : angle variation ij thmcopy ] is proven , [ eqn : angle variation ii thmcopy ] follows immediately because of the area formula for a hyperbolic triangle : @xmath331    because the variation is conformal , @xmath332 . using the formula for a segment of a circle in the hyperbolic plane",
    ", we have @xmath333 .    by proposition [ prop : conformal line ] , under a conformal variation @xmath334 and @xmath290 are collinear .",
    "consequently , the angle adjacent to @xmath297 in the triangle with side lengths @xmath335 , @xmath336 and @xmath302 is @xmath337 .",
    "this , together with the formulas in proposition [ prop : trig ] , allows us to write : @xmath338    using the taylor series for @xmath339 and @xmath340 , we have : @xmath341 and hence , @xmath342    we can also compute the variation of area explicitly .",
    "[ prop : hyperbolic area deriv ] given a conformal structure , then for any simplex @xmath15 with area @xmath343 .",
    "@xmath344 in particular , if the derivatives @xmath345 are positive whenever @xmath346 , then the derivative of the area is positive .",
    "this follows from the formula for the area of a sector of circle as a function of the radius for a hyperbolic surface , since in figure [ figure conformal variation ] we find that the area of each of the small triangles is higher order , leaving only the areas of the skinny triangles in the picture .",
    "the proof of the hyperbolic case of theorem [ thm : conformal classification ] is similar to the proof of the euclidean case , though the calculation is a bit harder in hyperbolic background .",
    "we first note the following : @xmath347    a straightforward calculations gives that @xmath348 or if @xmath349 then @xmath350 since @xmath351 it follows that @xmath352 and @xmath353    one can then easily solve this ode to obtain that : @xmath354 for some constant @xmath161 and @xmath355 for some constant @xmath356 .",
    "it follows that @xmath357    we can now use equation [ eq : coshder ] to see that @xmath358 and so we find that @xmath359 and @xmath360 for some constant @xmath164 .",
    "the compatibility condition ( [ d - hyperbolic condition ] ) implies that @xmath361 is independent of @xmath149 and so we can use equation [ eqn : cosh dij by cosh dij ] to see that @xmath171 and so we can define @xmath362 .    it follows that @xmath363    finally , we can use equation [ eqn : cosh dij by cosh dij ] again to write @xmath364 in terms of the coefficients determined in the two triangles adjacent to edge @xmath59 and differentiate to see that the @xmath174 derived in each triangle must be equal .",
    "it then follows from equation [ eqn : hyp length ] that the @xmath164 derived in each triangle must be equal as well .",
    "while the formula ( [ eqn : angle variation ij ] ) is not symmetric in @xmath16 and @xmath73 , we can reparametrize to get a symmetric variation formula .",
    "notice that equation [ eqn : cosh dij by cosh dij ] ( recall that we proved @xmath359 ) implies that @xmath365 if we take new coordinates @xmath366 such that @xmath367 then we have the symmetry @xmath368    the function @xmath369 can be computed explicitly .",
    "it is not hard to see that if @xmath128 then @xmath370 and if not then @xmath371 if @xmath372 then this is @xmath373 and if @xmath374 then this is @xmath375 compare to the formulations in @xcite , @xcite , and @xcite .",
    "it then follows that for a triangle @xmath376 the following form is closed : @xmath377 we can now integrate to get a function on the whole triangulation , where we fix some @xmath105 : @xmath378    [ thm : hyp functional ] the function @xmath326 has the property that @xmath107 furthermore ,",
    "if all @xmath108 and @xmath109 then this function is strictly convex .",
    "the first statement follows from the definition .",
    "the second follows from the facts that in a triangle @xmath266 , @xmath379 for @xmath380 since @xmath381 by proposition [ prop : hyperbolic area deriv ] .",
    "it follows that the matrix of partial derivatives is diagonally dominant .",
    "the arguments presented in the case of hyperbolic background geometry can be adjusted for the case of spherical background geometry .",
    "essentially , this occurs because in the hyperbolic case we are studying properties of the lorentzian inner product @xmath176 , while in spherical geometry we study analogous properties of the euclidean inner product .",
    "because the definitions and arguments in the spherical case are so similar to those of previous sections , we will only state the main results in the spherical case .",
    "to work in the spherical case , we work with the usual dot product @xmath382 on @xmath175 .",
    "geodesics on the sphere correspond to planes in @xmath175 and so given a triangle @xmath15 in the sphere and a pre - metric , a given embedding induces planes @xmath137 , etc . through edge centers and",
    "the condition for inducing a duality structure is @xmath383      [ prop : spherical compatibility ] suppose @xmath75 is a piecewise spherical pre - metric . equation [ eqn : spherical duality intersections ] holds if and only if the following _ compatibility equation _ @xmath384 is satisfied for every simplex @xmath15",
    ". equation [ eqn : dij - reln spherical ] has the following equivalent formulation : @xmath385        note that although the heights @xmath62 require choosing one of the two possible centers , the term @xmath387 does not depend on this choice , since choosing the other center leads to heights @xmath388 and so @xmath389        using this theorem and the definition of a spherical conformal structure , one can derive the spherical case of theorem [ thm : conformal classification ] .",
    "as in the hyperbolic case , it is desirable to change from the variables @xmath149 to variables @xmath391 , so that one can recognize that @xmath392 .",
    "the variables @xmath393 are given by @xmath394                                      j. dai , x. gu , and f. luo .",
    "_ variational principles for discrete surfaces_. advanced lectures in mathematics ( alm ) , 4 . international press , somerville , ma ; higher education press , beijing , 2008 .",
    "iv+146 pp ."
  ],
  "abstract_text": [
    "<S> a piecewise constant curvature manifold is a triangulated manifold that is assigned a geometry by specifying lengths of edges and stipulating that for a chosen background geometry ( euclidean , hyperbolic , or spherical ) , each simplex has an isometric embedding into the background geometry with the chosen edge lengths . </S>",
    "<S> additional structure is defined either by giving a geometric structure to the poincar dual of the triangulation or by assigning a discrete metric , a way of assigning length to oriented edges . </S>",
    "<S> this notion leads to a notion of discrete conformal structure , generalizing the discrete conformal structures based on circle packings and their generalizations studied by thurston and others . </S>",
    "<S> we define and analyze conformal variations of piecewise constant curvature 2-manifolds , giving particular attention to the variation of angles . </S>",
    "<S> we give formulas for the derivatives of angles in each background geometry , which yield formulas for the derivatives of curvatures . </S>",
    "<S> our formulas allow us to identify particular curvature functionals associated with conformal variations . </S>",
    "<S> finally , we provide a complete classification of discrete conformal structures in each of the background geometries . </S>"
  ]
}