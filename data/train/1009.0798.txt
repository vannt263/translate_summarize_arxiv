{
  "article_text": [
    "the magnetic field plays an important role in star formation . taking the magnetic field into account ,",
    "simulations of protostellar collapse have been performed in numerous studies ( reviewed by @xcite ) .",
    "most of these studies assumed ideal magnetohydrodynamics ( mhd ) .",
    "interstellar gas is partially ionized , and there are several processes of magnetic diffusion , e.g. , the ohmic dissipation , the hall effect , and ambipolar diffusion .",
    "the ohmic dissipation is effective at high densities of @xmath0 , whereas the ambipolar diffusion is effective at low densities of @xmath1 ( e.g. , @xcite ) .",
    "the timescale of the magnetic diffusion is significantly longer than the freefall time at @xmath2 @xcite , and hence magnetic diffusion does not appear to change the behavior of the gravitational collapse qualitatively .",
    "the gravitational collapse ceases in the dense region of @xmath3 owing to the formation of an adiabatic core , i.e. , the first core @xcite .",
    "therefore , subsequently formed objects , e.g. , circumstellar disks , protostars , and outflows , likely suffer from magnetic diffusion .",
    "the recent numerical simulations for protostellar collapse begin to take into account the magnetic diffusion ( e.g. , @xcite ) . however , the governing equation of the magnetic diffusion is parabolic , and therefore the time step for the magnetic diffusion is very small compared with the hydrodynamic time step when a high - resolution explicit method is employed .",
    "high resolution is important in the simulation of protostellar collapse and is usually provided by means of adaptive mesh refinement ( amr ) .",
    "several strategies for solving the magnetic diffusion have been proposed .",
    "the super time - stepping method is a type of explicit method , in which a large time step can be used @xcite .",
    "however , for the diffusion dominated problem , the time step is still restricted to be shorter than that of the hydrodynamic time step .",
    "@xcite proposed a semi - implicit scheme for ambipolar diffusion using a two - fluid approximation , where the time step is restricted in inverse proportion to the drift velocity .",
    "the present author previously implemented the ohmic dissipation in a nested grid code by using a sub - cycle of the induction equation @xcite . by this method , the protostellar collapse from a molecular cloud core to protostar formation",
    "was successfully simulated .",
    "although each sub - cycle required a small computational cost , the number of sub - cycles becomes very large when solving the magnetically dissipative region , e.g. , the region proximal to and inside of a protostar .",
    "moreover , the resistivity was approximated as being locally constant .",
    "an implicit scheme for solving the ohmic dissipation has been developed and implemented in the sfumato mhd - amr code @xcite . in  2 , the details of the implicit scheme are presented . in  3 ,",
    "the results of several numerical tests are presented .",
    "finally , the paper is summarized in  4 .",
    "the induction equation with the ohmic dissipation is given by @xmath4 where @xmath5 , @xmath6 , and @xmath7 denote the magnetic field , velocity , and resistivity , respectively .",
    "equation  ( [ eq : induction ] ) is solved by an operator splitting approach .",
    "the contribution of the first term on the right - hand side of the equation is solved explicitly according to @xcite , and the contribution of the second term is then solved by the implicit scheme presented herein .",
    "we hereinafter restrict our focus to the solution of the ohmic dissipation .",
    "the governing equation of the ohmic dissipation is given by @xmath8 equation  ( [ eq : basic ] ) is written in conservation form as follows : @xmath9 where the numerical flux @xmath10 is given by @xmath11 @xmath12 @xmath13 equation  ( [ eq : conservation ] ) is discretized as follows : @xmath14 where , for convenience , the unknown variables are written in uppercase , and the known variables are written in lowercase : @xmath15 , @xmath16 , @xmath17 , and @xmath18 . the superscript @xmath19 denotes the time level , and @xmath20 .",
    "the subscripts @xmath21 are the indexes of a cell in the @xmath22 , @xmath23 , and @xmath24 directions , respectively , and are used to label cells .",
    "the parameter @xmath25 specifies the type of temporal difference .",
    "the backward difference is obtained when @xmath26 , and the central difference is obtained when @xmath27 .",
    "therefore , @xmath26 results in a temporal first - order accuracy , while @xmath27 results in a temporal second - order accuracy .",
    "the case of @xmath27 corresponds to the crank  nicolson scheme .",
    "spatial discretization is performed with the central difference , yielding spatial second - order accuracy .",
    "each component of the numerical flux is defined at the cell surface , and hence the divergence of the numerical flux is calculated as follows : @xmath28 and @xmath29 is calculated in the same manner .",
    "the differential terms in @xmath30 are given by @xmath31 @xmath32 the resistivity @xmath7 at the cell surface is given by arithmetic average , e.g. , @xmath33    equation  ( [ eq : difference ] ) is rewritten in the form of a difference equation as follows : @xmath34 where @xmath35 @xmath36 equation  ( [ eq : elliptical ] ) indicates that the unknown @xmath5 is solved by the linear operator @xmath37 and the source term @xmath38 , which is a function of the known @xmath39 .",
    "equation  ( [ eq : elliptical ] ) is solved by the multigrid method . here",
    ", the strategy of the multigrid method is the same as that of @xcite , who solved the scalar pde of the poisson equation , while the present method solves the vector pde of equation  ( [ eq : basic ] ) .",
    "therefore , all of the procedures of @xcite are extended to those for vectors , and full - weight prolongation and averaging restriction are performed for each vector component .",
    "since the smoothing procedure depends on the equation to be solved , it is newly developed as shown in ",
    "[ sec : smoothing ] .",
    "the multigrid method @xmath40 solves @xmath41 when the initial estimation @xmath42 and the source term @xmath38 are given as follows : @xmath43 since equation  ( [ eq : elliptical ] ) is linear , we use the multigrid method iteratively , as follows : @xmath44 @xmath45 @xmath46 this iterative utilization of the multigrid method reduces every component of a residual , @xmath47 .    [ cols=\"<,^,^,^\",options=\"header \" , ]     the multigrid method given by equation ( [ eq : multigrid ] ) consists of ( 1 ) the full multigrid ( fmg ) cycle on the amr hierarchical grids , ( 2 ) the multilevel adaptive technique ( mlat ) with the full approximation scheme ( fas ) on these grids , and ( 3 ) an fmg - cycle on the base grid @xcite .",
    "these schemes have parameters : the numbers of iterations for v - cycle , pre - smoothing , and post - smoothing procedures in each grid level .",
    "these parameters adopted through this paper are shown in table  [ table : mgparam ] .",
    "these parameters affect a convergence speed of the multigrid method ; small numbers of these iterations slow the convergence while the computational cost is reduced .    as shown in section  [ sec : numerical_test ] , several cycles of the multigrid method given by equations ( [ eq : mgiteration1])([eq : mgiteration3 ] ) reduce the residual by more than an order of magnitude . in the numerical tests",
    ", we performed 20 cycles of the multigrid method in order to estimate solutions converged enough .",
    "as a smoothing operator , the red - black gauss ",
    "seidel iteration is adopted .",
    "when equation  ( [ eq : elliptical ] ) is solved separately for @xmath48 in each vector component , and @xmath48 is replaced by @xmath49 , we obtain the following relationship : @xmath50 where @xmath51 @xmath52 @xmath53 @xmath54 equation  ( [ eq : gs ] ) gives the approximate solution of @xmath49 for a given initial guess of @xmath48 .",
    "we adopt equation  ( [ eq : gs ] ) as a smoothing operator .",
    "a red - black ordering is adopted for sweeping the grid .",
    "the amr code was equipped with two modes of time - marching : an adaptive and a synchronous time - step mode . in the former mode",
    ", a coarser grid has a longer time step than a finer grid , and this mode is appropriate for non - self - gravitational gases because the system equations are hyperbolic . in the latter mode , every grid - level has the same time step , and this mode is appropriate for self - gravitational gases because the poisson equation is elliptic . for a problem including the ohmic dissipation , the synchronous time - step is adopted because the equation  ( [ eq : basic ] ) is parabolic .",
    "we consider the problem in which the sinusoidal magnetic field diffuses with a constant resistivity .",
    "the initial magnetic field is given as follows : @xmath55 and @xmath56 , where the wave number is set at @xmath57 .",
    "this setting reduces the equation of the ohmic dissipation to the heat equation .",
    "the resistivity is set at @xmath58 .",
    "the computational domain is @xmath59\\times[0 , 1/2]\\times[0 , 1/4]$ ] .",
    "periodic boundary conditions are imposed .",
    "the computational domain is covered by @xmath60 base blocks , each of which has @xmath61 cubic cells .",
    "the cell width is therefore given by @xmath62 in the base grid .",
    "the domain of @xmath63 $ ] is refined by blocks that are twice as fine .",
    "figure  [ amraccuracywave2ndinit.eps ] shows the initial distribution of @xmath64 and the block distribution for @xmath65 .",
    "the cell width in the left - hand side is @xmath66 , and that in the right - hand side is @xmath67 .",
    "( 80mm,80mm)f1.eps    we performed the convergence test by changing the time step @xmath68 , in order to measure the temporal accuracy .",
    "the @xmath69 norm of the error is measured at @xmath70 through comparison with the exact solution of the following equation : @xmath71 the @xmath69 norm is estimated as follows : @xmath72 where @xmath73 denotes the volume of a cell located at @xmath74 , and @xmath75 denotes the volume of the entire computational domain . by the stage of @xmath70 , the amplitude of @xmath64 is reduced to 0.45 .",
    "( 80mm,80mm)f2.eps    figure  [ amraccuracywave.eps ] shows the @xmath69 norm as a function of the time step @xmath76 .",
    "we examined the cases of @xmath26 ( backward difference ) and @xmath27 ( crank  nicolson ) .",
    "the scheme with @xmath26 exhibits first - order accuracy , and that with @xmath27 exhibits second - order accuracy . for the scheme with @xmath27 , the decrease in the @xmath69 norm with decreasing @xmath68",
    "is saturated at @xmath77 , exhibiting the constant @xmath69 norm of @xmath78 .",
    "the saturation is primarily attributed to a discretization error .",
    "we confirmed that the value of the saturation decreases with decreasing cell width .",
    "( 80mm,80mm)f3.eps    figure  [ amraccuracywavefc.eps ] shows the @xmath69 norms estimated in the fine region of @xmath79 ( fine region ) and the coarse region of @xmath80 ( coarse region ) .",
    "for the first - order scheme ( @xmath26 ) , the error in the coarse grid is slightly larger than that in the fine grid .",
    "in contrast , the second - order scheme ( @xmath27 ) exhibits an error in the coarse grid that is approximately 6 times larger than that in the fine grid when @xmath77 .",
    "( 80mm,80mm)f4a.eps + ( 80mm,80mm)f4b.eps    figure  [ amr2derrorwave.eps ] shows the distributions of the errors at @xmath81 for the schemes with @xmath26 and 1/2 . for the first - order scheme ( @xmath26 ) , the error is distributed smoothly through the fine and coarse grids . for the second - order scheme ( @xmath27 )",
    ", the coarse grid shows a larger systematic error than the fine grid , causing the large @xmath69 norm in the coarse grid .",
    "moreover , the error is somewhat large in the coarse grid near the interface between the fine and coarse grids .",
    "( 80mm,80mm)f5.eps    we performed a convergence test with respect to the spatial resolution by changing the number of cells inside a block , @xmath82 .",
    "the time step is set to @xmath83 .",
    "figure  [ amraccuracywavespace.eps ] shows the @xmath69 norm as a function of the cell width @xmath84 for the schemes with @xmath26 and 1/2 . both schemes exhibit spatial second - order accuracy .",
    "( 80mm,80mm)f6.eps    figure  [ res_ite.eps ] shows the decrease in the maximum residual during the iteration of the multigrid method given by equations  ( [ eq : mgiteration1 ] ) through ( [ eq : mgiteration3 ] ) for various time steps @xmath76 and spatial resolutions @xmath85 .",
    "the residual is calculated according to equation  ( [ eq : residual ] ) , and @xmath86 is plotted . in all cases ,",
    "one iteration of the multigrid method reduces the residual to less than @xmath87 .",
    "comparison of the schemes with @xmath27 , and 1 reveals that the scheme with @xmath27 exhibits fast convergence .",
    "moreover , there is a tendency whereby cases with smaller @xmath88 exhibit faster convergence .",
    "the residuals with @xmath89 , and 0.410 in the fine grid correspond to the lines with filled diamonds , open diamonds , filled circles , and open circles , respectively .",
    "( 80mm,80mm)f7.eps    ( 80mm,80mm)f8.eps    we examine the diffusion of @xmath64 in the gaussian profile , the exact solution of which is given as follows : @xmath90\\ ] ] where @xmath91 and @xmath92 .",
    "the computational domain is @xmath93 $ ] , which is resolved by the base grid of @xmath94 cubic cells .",
    "the region around the @xmath24 axis ( @xmath95 ) is covered by the fine grids , as shown in figure  [ odgaussiant1_2nd.eps ] .",
    "the cell widths are @xmath96 1.0 , 0.5 , and 0.25 for the grids of levels 0 , 1 , and 2 , respectively .",
    "periodic boundary conditions are imposed .",
    "figure  [ odgaussiant1_2nd.eps ] shows the solutions of @xmath64 at @xmath97 with various time steps @xmath76 for the scheme of @xmath27 . as the time step @xmath76 increases , the solution deviates from the exact solution . the solution with @xmath98 shows significant undulation @xmath99 . for the solution with @xmath100 ,",
    "the undulation mashes up the solution in the finest grid ( red asterisks ) .",
    "note that the crank  nicolson method is unconditionally stable for the von neumann stability analysis , while a large @xmath101 produces such undulation due to violation of the maximum principle @xcite .",
    "we also found that the undulation occurred with smaller @xmath76 when the initial gaussian profile had a narrower width ( a smaller @xmath102 ) .    the scheme with @xmath26 yields smooth solutions even for large @xmath76 , as shown in figure  [ odgaussiant1_1st.eps ] .",
    "although monotonicity is maintained in the solutions , the solution in the finest grid deviated considerably from the exact solution when @xmath68 is large .",
    "( 80mm,80mm)f9.eps    figure  [ amraccuracyfc.eps ] shows the @xmath69 norm of the error as a function of time step @xmath76 for @xmath27 ( solid lines ) and 1 ( dotted lines ) .",
    "the norm is estimated separately on each grid level .",
    "the errors for @xmath27 and 1 exhibit second - order accuracy and first - order accuracy , respectively , on the grids of levels 1 and 2 . for the grid of level 0 ( the base grid ) , the dependence of the errors on @xmath76 is shallower because of the periodic boundary conditions . note that the scheme with @xmath27 maintains second - order accuracy on the grid of level 2 , even when considerable undulation occurs with a large time step .",
    "we compared the solutions obtained by implicit schemes with the solutions obtained by an explicit scheme .",
    "the resistivity is distributed as follows : @xmath103\\ ] ] and the initial magnetic field is given by @xmath104\\ ] ] and @xmath56 .",
    "the computational domain is @xmath105 $ ] , which is resolved by @xmath106 cells .",
    "periodic boundary conditions are imposed .",
    "we continue the dissipation process of @xmath5 until @xmath107 by using the implicit schemes with @xmath27 and 1 and an explicit scheme .",
    "the explicit scheme integrates time by means of the predictor - corrector method and a spatial central difference in order to achieve second - order accuracy in time and space .",
    "the time step is set at @xmath108 for the explicit scheme , and @xmath109 for the implicit schemes .",
    "( 40mm,40mm)f10a.eps ( 40mm,40mm)f10b.eps    figure  [ odtestsphere3d.eps ] shows the initial conditions and the solution at @xmath110 solved by the implicit scheme with @xmath27 .",
    "the right - hand figures show the magnetic fields bent due to the ohmic dissipation , indicating the reduction of @xmath64 and the generation of @xmath111 and @xmath112 .",
    "( 55mm,55mm)f11a.eps ( 55mm,55mm)f11b.eps ( 55mm,55mm)f11c.eps + ( 55mm,55mm)f11d.eps ( 55mm,55mm)f11e.eps ( 55mm,55mm)f11f.eps    figure  [ odtestsphere.eps ] compares magnetic fields obtained by the explicit scheme , the second - order implicit scheme ( @xmath27 ) , and the first - order implicit scheme ( @xmath26 ) .",
    "all of the solutions are consistent with one another . in particular , the solution obtained by the implicit scheme with @xmath27 exhibits excellent agreement with that obtained by the explicit scheme .",
    "this is attributed to the high accuracy of the implicit scheme with @xmath27 , which achieves second - order accuracy .",
    "we have presented an implicit scheme for solving the ohmic dissipation for the sfumato mhd - amr code .",
    "the induction equation of the ohmic dissipation is solved by this implicit scheme , which is based on the crank  nicolson method , which has an option for selecting first - order accuracy ( @xmath26 ) and second - order accuracy ( @xmath27 ) in time . for both cases ,",
    "the spatially central difference yields second order accuracy in space .",
    "the multigrid method is used for the convergence of a solution and exhibits fast convergence .",
    "although the convergence speed depends on @xmath113 , several cycles of the multigrid method reduce the residual by more than an order magnitude .",
    "the solution is obtained over the amr hierarchical grid , in which fine and coarse grids co - exist . moreover ,",
    "no spurious features appear at the interface between fine and coarse grids .",
    "note that in the convergence process of the multigrid method , the numerical fluxes given by equations ( [ eq : fx ] ) through ( [ eq : fz ] ) are conserved even at the interfaces between the fine and coarse grids , because of the refluxing procedure , where the fluxes of the coarse grid are obtained by summing those of the fine grids at the interface @xcite .",
    "this leads to conservation of magnetic flux .    since the second - order scheme of @xmath27",
    "is based on the crank  nicolson method , the scheme is unconditionally stable .",
    "however , the solution can contain spurious oscillations when @xmath101 is large , as shown in figure  [ odgaussiant1_2nd.eps ] .",
    "for example , for a one - dimensional heat equation , the analysis of the maximum principle leads a condition of @xmath114 to suppress the oscillation @xcite .",
    "this condition is slightly weaker than the cfl condition of an explicit scheme . in the astrophysical simulations ,",
    "the oscillation of the magnetic field may change the direction of the magnetic pressure gradient , which may change the phenomena of the simulations qualitatively .",
    "in contrast , the first - order scheme ( @xmath26 ) retains monotonicity , as shown in figure  [ odgaussiant1_1st.eps ] , but its error is larger than that of the second - order scheme .",
    "numerical computations were carried out on the cray xt4 at the center for computational astrophysics , cfca , of the national astronomical observatory of japan .",
    "the present research was supported in part by the hosei society of humanity and environment .",
    "the present research was supported in part by grants - in - aid for scientific research ( c ) 20540238 and ( b ) 22340040 from the ministry of education , culture , sports , science and technology , japan .",
    "choi , e. , kim , j. , & wiita , p.  j.  2009 , , 181 , 413 klein , r.  i. , inutsuka , s .-",
    "i . , padoan , p. , & tomisaka , k.  2007 , protostars and planets v , 99 kunz , m.  w. , & balbus , s.  a.  2004 , , 348 , 355 larson , r.  b.  1969 , , 145 , 271 machida , m.  n. , inutsuka , s .-",
    "matsumoto , t.  2006 , , 647 , l151 machida , m.  n. , inutsuka , s .-",
    "i . , & matsumoto , t.  2007 , , 670 , 1198 matsumoto , t.  2007 , , 59 , 905 morton k. w. & mayers d. f.  2005 , numerical solution of partial differential equations : an introduction ( cambridge university press ) page33 nakano , t. , nishi , r. , & umebayashi , t.  2002 , , 573 , 199 osullivan , s. , & downes , t.  p.  2006",
    ", , 366 , 1329 osullivan , s. , & downes , t.  p.  2007",
    ", , 376 , 1648 tilley , d.  a. , & balsara , d.  s.  2008 , , 389 , 1058"
  ],
  "abstract_text": [
    "<S> an implicit method for the ohmic dissipation is proposed . </S>",
    "<S> the proposed method is based on the crank  nicolson method and exhibits second - order accuracy in time and space . </S>",
    "<S> the proposed method has been implemented in the sfumato adaptive mesh refinement ( amr ) code . </S>",
    "<S> the multigrid method on the grids of the amr hierarchy converges the solution . </S>",
    "<S> the convergence is fast but depends on the time step , resolution , and resistivity . </S>",
    "<S> test problems demonstrated that decent solutions are obtained even at the interface between fine and coarse grids . </S>",
    "<S> moreover , the solution obtained by the proposed method shows good agreement with that obtained by the explicit method , which required many time steps . </S>",
    "<S> the present method reduces the number of time steps , and hence the computational costs , as compared with the explicit method . </S>"
  ]
}