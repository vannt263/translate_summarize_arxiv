{
  "article_text": [
    "the 2003 wmap discovery of large optical depths to electron scattering at z @xmath0 15 @xcite motivated several numerical and analytical studies of early reionization @xcite .",
    "the goal of these models was to extend the classical picture of reionization to account for the large electron fractions at high redshifts while still accommodating lower redshift observations .",
    "in particular , sokasian , _",
    "et  al .  _ and ciardi , _",
    "et  al .  _ employed large scale cosmological simulations combining gas and dark matter dynamics with radiative transfer to follow the growth of ionized regions in the early igm .",
    "global electron densities in these calculations were integrated over redshift to compute the thomson scattering optical depth @xmath1 for a variety of scenarios .",
    "all these simulations assume several free parameters : uv escape fractions , pop iii stellar masses , the positive and negative feedback of one generation of uv sources upon the next , and the pop iii / pop ii rollover in mass spectrum and uv production with redshift .",
    "furthermore , there was no hydrodynamic response to the energy deposited into the gas by the passage of fronts in these models , seriously altering the evolution of the fronts themselves .",
    "the studies cited above postprocessed successive hydrodynamic snapshots of the igm with radiative transfer without energy deposition into the gas to evolve primordial h ii regions ( see @xcite for a summary of the latest algorithms applied to cosmological rt ) .",
    "the challenge of the next generation of early reionization simulations is to capture the radiation hydrodynamics of ionization and feedback physics on small scales to determine the final sizes and distribution of i - fronts in the large simulation volumes necessary for statistically accurate structure formation @xcite .",
    "upcoming observations able to discriminate between early reionization scenarios underscore the need for ab initio simulation of the early igm , in which reionization properly unfolds over many redshifts and generations of luminous objects .",
    "21 cm line observations in both emission and absorption ( by the square kilometer array ) could yield cosmic electron fraction profiles as a function of redshift , beyond current wmap and upcoming planck measurements that are limited to electron column densities . if foreground contamination can be overcome , these observations might also unveil the size and morphologies of early h ii regions @xcite .",
    "signatures of pop iii stars manifest as excesses in the near - ir cosmic background may soon be measured by balloon and satellite missions @xcite .",
    "jwst will also open the first direct observational window on protogalaxies with a few thousand pop iii stars at 15 @xmath2 z @xmath2 20 .",
    "the escape of ionizing uv photons from primordial minihalos and protogalaxies is mediated by the hydrodynamical transitions of ionization fronts on sub - parsec scales @xcite , and failure to properly capture their breakout can alter the final extent of h ii regions on kiloparsec scales . in some cases static",
    "transfer completely fails to predict the exit of fronts from early galaxies by excluding the gas motions that can free them @xcite .",
    "radiation hydrodynamical simulations can predict escape fractions in the next generation of models by following i - fronts as they begin deep within primordial structures and blossom outward to ionize the igm , accurately resolving their true final sizes and morphologies .    coupled to reactive networks able to evolve primordial h@xmath3 chemistry , radiation hydrodynamics",
    "will also better model the radiative feedback mechanisms known to operate in the early universe , which remain to be incorporated in detail in large scale calculations .",
    "local entropy injection by uv sources @xcite , lyman - werner dissociation of h@xmath4 in minihalos and protogalaxies , and catalysis of molecular hydrogen by free electrons @xcite are key processes governing the rise of early star populations and the high - redshift ionizing background . on small scales",
    "radiation hydrodynamics will also resolve ionized gas outflows in h ii regions that facilitate the dispersal of metals from the first supernovae , exhibit dynamical instabilities potentially leading to clumping and further star formation , and limit the growth of black holes left in minihalos .",
    "resolving radiative feedback over a few generations of primordial stars will enable their inclusion in large simulations over many redshifts with confidence later on .    on large scales radiation hydrodynamics",
    "will be crucial to determine whether igm photoheating cascades from small to large scales through nonlinear dynamical evolution to affect structure formation at later redshifts .",
    "the expansion of cosmological ionization fronts through filaments and voids is also inherently hydrodynamical in nature , as is the photoevaporation of minihalos that can impede these fronts @xcite .",
    "static transfer can not reproduce the outflows confirmed by numerical simulations to enhance the photoionization of these structures and therefore understimates the advance of i - fronts into the early igm .",
    "to investigate the numerical issues confronting the incorporation of radiation hydrodynamics into future large scale structure evolution models we have developed an explicit multistep scheme for ionization front transport from a single point source in the zeus - mp hydrocode @xcite .",
    "the issues fall into two categories .",
    "the first is how to calculate photoionization rates everywhere on the numerical grid , whether by ray tracing , variable tensor eddington factors , flux limited diffusion , or monte carlo approaches for either single or multiple sources ( see @xcite for novel raytracing schemes for the enzo and flash adaptive mesh refinement ( amr ) codes ) . in section 2",
    "we examine the second issue : how to couple reaction networks and energy equations driven by ionization to the hydrodynamics , which has only recently begun to be examined by the cosmology community @xcite .",
    "our algorithm easily extends to multiple frequencies and can be readily interfaced with transfer techniques accommodating many point sources . in sections 4 and 5",
    "we present a comprehensive suite of static and hydrodynamic i - front test problems utilized to benchmark our code that can be applied to validate future methods . in particular , the hydrodynamic benchmarks are adopted from an analytical study of ionization fronts in power - law density profiles done by @xcite ( see @xcite for a thorough review of numerical and analytical studies of classical h ii regions ) .",
    "the tests encompass the range of i - front dynamics likely to occur in cosmological settings and will challenge the versatility and robustness of any code .",
    "they also expose many features of ionized flows that are exhibited by any density gradient .",
    "we examine in section 6 how individual zones approach ionization equilibrium as well as the timescales that govern each phase of i - front and ionized flow evolution in a variety of density regimes .",
    "we discuss how these timescales control the timestep advance of the numerical solution and explore avenues for future algorithm optimization .",
    "the impact of radiation pressure on i - fronts and flows is also reviewed in section 7 , and we provide an array of improved uv escape fraction calculations for pop iii stars in section 8 .",
    "our modified zeus - mp hydrocode solves explicit finite - difference approximations to euler s equations of fluid dynamics together with a 9-species primordial gas reaction network @xcite that utilizes photoionization rate coefficients computed by a ray - casting radiative transfer module .",
    "ionization fronts thus arise as an emergent feature of reactive flows and radiative transfer in our simulations and are not tracked by computing equilibria positions along lines of sight , as is done in many algorithms .",
    "the fluid dynamics equations are @xmath5 where @xmath6 , e , and the v@xmath7 are the mass density , internal energy density , and velocity of each zone and p (= ( @xmath8 - 1 ) e ) and * q * are the gas pressure and the von neumann - richtmeyer artificial viscosity tensor @xcite .",
    "@xmath9 represents radiative heating and cooling terms described below .",
    "the left - hand side of each equation is updated term by term in operator - split and directionally - split substeps , with a given substep incorporating the partial update from the previous substep .",
    "the gradient ( force ) terms are computed in the zeus - mp source routines and the divergence terms are calculated in the zeus - mp advection routines @xcite .",
    "the primordial species added to zeus - mp ( h , h@xmath10 , he , he@xmath10 , he@xmath11 , h@xmath12 , h@xmath13 , h@xmath4 , and e@xmath12 ) are assumed to share a common velocity field and are evolved by nine additional continuity equations and the nonequilibrium rate equations of @xcite @xmath14 where @xmath15 is the rate coefficient of the reaction between species j and k that creates ( + ) or removes ( - ) species i , and the @xmath16 are the ionization rates .",
    "the divergence term for each species is evaluated in the advection routines , while the other terms form a reaction network which is solved separately from the source and advection updates . to focus our discussion on the gas dynamics of i -",
    "fronts our present calculations take the primordial gas to be hydrogen only , which can be ionic or neutral but not molecular .",
    "the rate equations reduce to @xmath17 where k@xmath18 , k@xmath19 , and k@xmath20 , are the rate coefficients for recombination , photoionization and electron collisional ionization of hydrogen and the n@xmath7 are the number densities .",
    "when the full reaction network is activated we enforce charge and baryon conservation at the end of each hydrodynamic cycle with the following constraints @xmath21 where f@xmath22 is the primordial hydrogen fraction , m@xmath22 is the hydrogen mass , and @xmath23 is the baryon density evolved in the original zeus - mp hydrodynamics equations .",
    "any error between the species or charge sums and @xmath23 is assigned to the largest of the species to bring them into agreement with @xmath23 .",
    "microphysical cooling and heating processes are included by an isochoric operator - split update to the energy density computed each time the reaction network is solved : @xmath24 where k@xmath19 is the photoionization rate described above , @xmath25 is the fixed energy per ionization deposited into the gas ( set to 2.4 ev as explained in @xcite ) , and @xmath26 , @xmath27 , @xmath28 , and @xmath29 are the recombinational , compton , collisional ionization , and collisional excitation cooling rates taken from @xcite ) . these four processes",
    "act together with hydrodynamics ( such as adiabatic expansion or shock heating ) to set the temperature of the gas everywhere in the simulations .",
    "the radiative transfer module computes k@xmath19 by solving the static equation of transfer along radial rays outward from a single point source centered in a spherical - polar coordinate geometry .",
    "the fact that the medium usually responds to radiation over much longer times than the light - crossing times of the problem domain permits us to omit the time derivative in the equation of transfer that would otherwise restrict the code to unnecessarily short timesteps .",
    "this approximation is violated very close to the central star by rapid ionizations that can lead to superluminal i - front velocities .",
    "these nonphysical velocities are prevented by simply not evaluating fluxes further from the central star than light could have traveled by that time in the simulation @xcite .",
    "our experience has been that this static form of the equation of transfer typically becomes valid before the i - front reaches the stromgren radius , and the code computes very accurate stromgren radii and formation times .",
    "photoionizations in any given cell in principle are due to direct photons from the central source through the cell s lower face as well as to diffuse recombination photons through all its faces .",
    "recombinations within a zone occur to either the ground state or to any excited state .",
    "we adopt the on - the - spot ( ots ) approximation @xcite that a case ( a ) recombination photon emitted in a zone is reabsorbed before escaping the zone by decomposing both the photoionization and recombination terms in the reaction network @xmath30 and equating the first and fourth terms , which cancel . here",
    "k@xmath31 and k@xmath32 are the recombination rate coefficients to the ground state and to all excited states while k@xmath33 and k@xmath34 are the rate coefficients for cell ionizations by central stellar photons and diffuse photons .",
    "taking ground - state recombination photons to be reabsorbed before they can exit the cell guarantees that no photons enter the cell from other locations in the problem , relieving us of the costly radiative transfer from many lines of sight that otherwise would be needed to compute the diffuse radiation entering the zone .",
    "while the two terms are set equal in the equation above , it should be recognized that ionizations typically occur much more quickly than recombinations .",
    "no error is introduced in the network because the much faster photoionizations will simply cycle out any ground - state recombinations over the timestep the solution is advanced , regardless of the processes true timescales .",
    "the ots approximation is valid anywhere there is a sizeable uv photon mean free path across a zone , which is the case within the front itself but not usually in the hot ionized gas behind it .",
    "case ( a ) photons emitted from an ionized cell might reach the front itself before being absorbed because of the very low neutral fraction in their path .",
    "such photons do not advance the front , however , because the neutral atom they leave behind will remove another source or diffuse photon that would have reached the front . since case ( a ) recombinations",
    "_ globally _ balance diffuse ionizations they can still be thought to cancel in any _ single _ zone on average , even in those that are ionized .    however , there are important scenarios in which the ots approximation fails to reproduce the true ionization of a cosmological structure . for example",
    ", dense gas clumps in primordial minihalos cast shadows in the uv field from the central source .",
    "the ots paradigm would produce shadows that remain too sharp by not accounting for the recombination photons that would leak laterally into these shadows and soften them .",
    "failure to capture the correct shadowing may have important consequences on the growth of instabilities expected to develop in these ionization fronts @xcite .",
    "these instabilities are of interest for their potential to promote clumping that could later collapse into new stars , especially if mixed with metals from a previous generation .",
    "methods for accurate and efficient simulation of recombination radiation are being studied in connection with 3-d simulations of minihalo photoevaporation under development .",
    "only a single integration of the transfer equation along a radial ray from the source at the coordinate center is necessary to compute k@xmath33 in a cell .",
    "the static transfer equation is recast in flux form for simple solution in spherical coordinates : @xmath35 where @xmath36 is the inverse mean free path of a uv photon in the neutral gas @xmath37 simple integration yields the radial flux at the inner face of each zone on the grid : @xmath38 the ionization rate in a zone is calculated in a photon - conserving manner to be the number of photons entering the zone per second @xmath39 minus the number exiting the zone per second @xmath40 hence , the ionization rate in the cell is @xmath41 n@xmath42 must be converted into the rate coeficient required by the chemistry equations . in the ionization term of the reaction equation @xmath43 k@xmath19 is the ionization rate coefficient , @xmath44 is the number of ionizations per volume per second , and n@xmath42 is the number of ionizations per _ zone _ per second , with the three being related by @xmath45 n@xmath42 is therefore converted to k@xmath19 by @xmath46 he i and ii ionization coefficients as well as lyman - werner dissociation rates are also evaluated by this procedure .",
    "our prescription for generating k@xmath19 is photon - conserving in that the number of photons emitted along any line of sight will always equal the number of photoionizations in that direction over any time interval .",
    "this formulation enables the code to accurately advance i - fronts with significantly less sensitivity to resolution than methods which solve the transfer equation to compute a zone - centered flux or intensity to determine k@xmath19 : @xmath47 this non - conservative formalism does not guarantee n@xmath48 to equal n@xmath42 along a line of sight except in the limit of very high resolution .",
    "such methods can require hundreds or thousands of radial zones to converge to proper i - front evolution , making photon conservation a very desirable property @xcite .    however , photon - conserving methods are not necessarily resolution independent , as implied at times in the literature .",
    "for example , if a grid fails to resolve a density peak then even a photon - conserving algorithm will overestimate the advance of the front ( even in a static problem ) because of the strong n@xmath49 dependence of recombination rates on material densities .",
    "the resolution needed for correct i - front evolution in hydrodynamical simulations is governed by the resolution necessary for the gas dynamics to converge , since this determines the accuracy of the densities encountered by the front .",
    "nevertheless , photon - conservative schemes are still the method of choice in gas dynamical i - front simulations because the grid resolution non - conservative methods would require to follow the front can be much greater than the resolution needed just for hydrodynamic convergence .",
    "each equation in the reaction network can be rewritten as @xmath50 where c@xmath7 is the source term representing the formation of species i while d@xmath7 is the source term describing its removal .",
    "a fully - explicit finite - differenced solution would be @xmath51 with c@xmath7 and d@xmath7 ( and the n@xmath52 comprising them ) being evaluated at the current time .",
    "a fully- implict update @xmath53 would take the source terms to be at the advanced time , requiring iteration to convergence for the n@xmath7    the chemistry rate coefficients driving the reaction network exhibit a variety of different timescales that make the network numerically stiff .",
    "the shortest reaction times in the network would force a purely explicit solution into much smaller timesteps than accuracy requires , while a fully - implicit scheme best suited to the solution of stiff networks demands matrix iterations of excessive cost in a 3d simulation .",
    "the additional costs of matrix iteration in implicit schemes can be offset by the much longer timesteps they permit because the stability of the network is freed from its shortest timescale .",
    "however , a disadvantage of fully - implicit approaches is that they require simultaneous solution of the reaction network together with the radiative transfer equation ( needed for the ionization rates in the network ) and the isochoric energy equation ( which sets the temperatures utilized in the rate coefficients ) , all evaluated at the advanced time .",
    "while such methods evolve ionization fronts with very high accuracy in 1d @xcite , photon conservation is sacrificed in the process of achieving concurrency between the network , energy , and transfer equations at the future time .",
    "hence , these algorithms may only achieve their superior accuracy if high problem resolutions are employed ( 8000 radial zones in the @xcite theory validation runs ) .",
    "photon - conserving fully - implicit stencils which can operate accurately at much lower resolutions may be possible with further investigation .",
    "furthermore , while in principle a fully - implicit network can be evolved over an entire hydrodynamical time , this strategy would accrue significant errors in many density regimes .",
    "@xcite reported that in some test cases it was necessary to evolve their network by no more than a few photoionization timescales in order to compute energy deposition correctly .",
    "in such instances the additional costs of iteration in implicit schemes outweighs their advantage in accuracy over explicit methods because they must ultimately both perform a comparable number of cycles to complete a problem .",
    "it should also be noted that highly nonlinear and nonmonotonic primordial heating / cooling rates have been observed to retard or prevent newton - raphson convergence in implicit cosmological calculations @xcite .",
    "we instead adopt the intermediate strategy of sequentially computing each n@xmath7 , building the source and sink terms for the i@xmath54 species update from the i - 1 ( and earlier ) updated species while applying rate coefficients evaluated at the current problem time @xcite .",
    "the order of the updates is h , h@xmath10 , he , he@xmath10 , he@xmath11 , e@xmath12 , h@xmath12 , h@xmath13 , and h@xmath4 .",
    "this approach allows direct solution of the densities with sufficient accuracy to follow i - fronts in most density regimes with reasonable execution times , which are sometimes much shorter than for implicit schemes .",
    "et  al .  _ found a speedup of ten in sequential species updates over an implicit stiff solver package in cosmological test cases involving the steady buildup of igm uv fluxes from a metagalactic background .",
    "two timescales in general govern the evolution of h ii regions .",
    "the many reaction rate timescales can be consolidated into a single chemistry timestep defined by @xmath55 formulated to ensure that the fastest reaction operating at any place or time in the problem determines the maximum time by which the reaction network may be accurately advanced .",
    "the second timescale is the heating / cooling time t@xmath56 @xmath57 connected to the hydrodynamic response of the gas to the reactions .",
    "the ratio of the two times can depend on the evolutionary phase of the h ii region or even on the current ionization state in a single zone .",
    "in general , reaction times are shorter than heating times as the ionization front propagates outward from the central uv source but cooling times can become shorter than recombination times after shutdown of the central source .",
    "the latter circumstance can lead to nonequilibrium cooling in h ii recombination regions , which can remain much more ionized at low temperatures than would be expected for a gas in thermodynamic equilibrium , an effect which has been observed in cosmological h ii region simulations @xcite .",
    "many strategies have been devised to interleave reaction networks and radiative transfer with hydrodynamics .",
    "after computing the global minimum courant timestep for the problem domain , anninos _",
    "et  al .",
    "_ evolve the species in each cell by advancing the rate equations by a tenth of the lesser of the chemistry and heating / cooling timescales for that cell until a tenth of the cell s heating / cooling timescale is covered . at this point",
    "the cumulative energy gained or lost over the chemistry updates is added to the cell s gas energy in the microphysical heating / cooling substep described earlier , but neither velocities nor densities are updated .",
    "this cycle is then repeated over consecutive heating timesteps in the cell until the global minimum courant timestep is covered .",
    "cells with the fastest kinetics require the most chemistry subcycles over a heating time : more slowly reacting cells covering their heating time with fewer subcycles are quiescent during the subsequent cycles required by the faster cells .",
    "likewise , kinetics and energy updates in cells traversing the global hydrodynamical time in fewer heating cycles are halted over the additional subcycles the more quickly heating or cooling cells demand .",
    "every cell in the grid undergoes the same number of subcycles ( which continue until the last cell has covered the global courant timestep ) , but updates in a given cell are suspended after it has crossed this timestep .",
    "new photoionization rates are calculated every chemistry timestep by a call to a radiative transfer module but the other rate coefficients remain constant over a heating timestep because they depend only on temperature ; they are updated at the beginning of the next heating cycle with the new gas temperature . at the end of the hydrodynamical timestep full source and advective updates of velocities , energies , and conserved total baryonic densities are performed .    although sufficient for the slowly rising uv metagalactic backgrounds in the anninos _ et  al .",
    "_ calculations this subcycling approach does not accurately simulate the growth of ionization fronts .",
    "proper front capturing is sensitive to velocities that can build up over the heating timestep that are not correctly computed by the anninos _",
    "et  al .",
    "_ scheme because it does not update velocities until many such heating times have passed .",
    "the order of execution of our algorithm is as follows : first , the radiative transfer module is called to compute k@xmath19 via eq .",
    "( [ eqn : kphderiv ] ) to determine the smallest heating / cooling timestep on the grid .",
    "the grid minimum of the courant time is then calculated and the smaller of the two is adopted as t@xmath58 ; in a 1d calculation this is @xmath59 next , from this same set of k@xmath19 the shortest chemistry timestep of the grid is calculated .",
    "@xmath60 the species densities and gas energy in _ all _ cells are then advanced over this timestep , the transfer module is called again to compute a new chemistry timestep , and the network and energy updates are performed again .",
    "the n@xmath7 and energy are subcycled over successive chemistry timesteps until t@xmath58 has been covered , at which point full source and advective updates of velocities , energies , and total densities are performed .",
    "a new t@xmath58 is then determined and the cycle repeats .",
    "if the chemistry timestep is longer than the global hydrodynamical time the reaction network is only subcycled once .",
    "this more restrictive hierarchy of rate solves and hydrodynamical updates is necessary to compute the correct velocities in each zone with the passage of the front over the wide range of density regimes discussed in section 3 .",
    "note that cooling times which are shorter than recombination times in the problem are easily handled because the code will simply cycle the reactions in each cell once over the hydrodynamic timestep .",
    "considerable experimentation with alternative hierarchies of kinetic and hydrodynamical updates and choices of timestep control ( some involving photoionization times ) proved them to be less accurate or robust .",
    "@xcite performed analytical studies of 1-d ionization fronts from a monochromatic source of photons centered in a radial density profile with a flat central core followed by an r@xmath61 dropoff : @xmath62 they considered photon rates that would guarantee that the stromgren radius r@xmath63 of the front if the entire medium was of uniform density n@xmath64 is greater than r@xmath64 , noting that if r@xmath63 @xmath2 r@xmath64 that the front would evolve as if it were in a constant density .",
    "their analysis of i - front propagation down the radial density gradients revealed that there is a critical exponent @xmath65^{-1 } \\label{eqn : wcrit } \\vspace{0.1in}\\ ] ] below which the front executes the classic approach to a stromgren sphere of modified radius @xmath66^{1/(3 - 2\\omega)}\\left(\\frac{r_{s}}{r_{c}}\\right)^{2\\omega/(3 - 2\\omega)}\\vspace{0.20in}\\ ] ] at which point it reverts from r - type to d - type and continues along the gradient , building up a dense shocked shell before it . here",
    "r@xmath63 is the classical stromgren radius the ionization front would have in a uniform density medium @xmath67 if @xmath68 @xmath2 1.5 @xmath2 @xmath69 the front remains d - type throughout its lifetime and continues to accumulate mass in its shell , expanding as @xmath70^{4/(7 - 2\\omega ) } \\label{eqn : r_w1 } \\vspace{0.10in}\\ ] ] where c@xmath7 is the sound speed in the ionized gas . if @xmath68 = 1.5 the shock and front coincide without any formation of a thin neutral shell as in the @xmath68 @xmath2 1.5 profiles .",
    "when 1.5 @xmath2 @xmath68 @xmath2 @xmath69 the d - type front will revert back to r - type and quickly overrun the entire cloud .",
    "since i - fronts ultimately transform back to r - type in any cloud with density dropoffs steeper than 1.5 this power constitutes the critical point for eventual runaway ionization .",
    "as expected , if @xmath68 = 0 then r@xmath71 becomes r@xmath63 and r(t ) exhibits the t@xmath72 expansion of an ionization front in a uniform medium @xcite .",
    "fronts descending gradients steeper than r@xmath73 never slow to a stromgren radius or transform to d - type .",
    "remaining r - type , they quickly ionize the entire cloud , leaving behind an essentially undisturbed ionized density profile because they exit on timescales that are short in comparison to any hydrodynamical response of the gas .",
    "completely ionized and at much higher pressures , the entire cloud begins to inflate outward at the sound speed of the ionized material .",
    "however , the abrupt core density dropoff left undisturbed by the rapid exit of the front develops a large pressure gradient because of the equation of state in the nearly isothermal postfront gas .",
    "the sharpest pressure gradient is at the ionized core s edge at r @xmath0 r@xmath64 .",
    "this edge expands outward in a pressure wave which quickly steepens into a shock that overtakes the more slowly moving outer cloud regions .",
    "the velocity of this shock depends on the initial density dropoff : if @xmath74 3 then @xmath75c_{i}t \\label{eqn : om2 } \\vspace{0.1in}\\ ] ] if @xmath68 = 3 then @xmath76 and if @xmath77 3 @xmath78^{2/\\left(\\delta+2-\\omega\\right ) } \\label{eqn : om5 } \\vspace{0.1in}\\ ] ] where @xmath79 is the initial core radius and @xmath80 is an empirically fit function of @xmath68 : @xmath81 the shock has a constant velocity for @xmath82 @xmath2 @xmath68 @xmath83 3 , weakly accelerates for @xmath68 = 3 , and strongly accelerates if @xmath84 .",
    "this is in agreement with what would be expected for the mass of each cloud . for @xmath68 @xmath2 3",
    "the cloud mass is infinite so a central energy source could not produce gas velocities that increase with time .",
    "the cloud mass becomes finite just above @xmath68 = 3 , the threshold for the ionized flow to exhibit a positive acceleration .",
    "we present a series of static i - front tests of increasing complexity for initial code validation . in line with the non - hydrodynamical nature of these problems ,",
    "velocity updates were suspended but the heating and cooling updates in eq ( [ eqn : egas ] ) were performed .",
    "the energy updates were necessary to evolve the reaction rates according to temperature as well as to regulate the timesteps over which the reaction network was advanced .",
    "the initial gas temperature in all the static tests was set to 10 k.      [ fig : t2 ioniz ]    the simplest test is an r - type ionization front due to a monochromatic point source in a uniform infinite static medium in which no recombinations occur @xcite . the radius of the spherical front is easily computed by balancing the number of emitted photons with the number of atoms in the ionized volume : @xmath85 the front will expand forever in the absence of recombinations but will eventually slow to zero velocity as t @xmath86 .",
    "we compare this solution to our code results in fig [ fig : t1 radii / ioniz ] for n@xmath22 = 10@xmath87 @xmath88 , @xmath89 = 10@xmath90 s@xmath91 , and outer boundary of 64 kpc for grid resolutions of 64 , 128 , 256 , and 512 radial zones .",
    "the position of the front is defined to be at the outermost zone whose neutral fraction has decreased to 50% .",
    "the time evolution of the front is shown in fig [ fig : t1 radii / ioniz ] . for a given resolution",
    "the algorithm is within one zone of the exact solution after 2.0 @xmath92 10@xmath93 yr . as expected for a static homogeneous medium , the photon - conserving radiative transfer correctly propagates the r - type front independently of numerical resolution .",
    "the neutral fraction profiles are extremely sharp because there are no recombinations , and they drop essentially to zero behind the front .    including recombinations yields the well - known result for an i - front in a uniform infinite static medium : @xmath94^{1/3 } \\label{eqn : r2(t)}\\vspace{0.1in}\\ ] ] where r@xmath63 is the stromgren radius @xmath95 and @xmath96^{-1 } \\vspace{0.1in}\\ ] ] taking again n@xmath22 = 10@xmath87 @xmath88 and @xmath89 = 10@xmath90 s@xmath91 but with an outer radius of 10 kpc , we plot the results of our algorithm for 64 , 128 , 256 , and 512 radial zones along with the analytical solution in fig [ fig : t2 radii / temp ] .",
    "the computed curves exhibit excellent agreement with theory , with a maximum error of 7.5% between the 64-zone solution and eq .",
    "( [ eqn : r2(t ) ] ) . the code results are again clustered closely together because of photon conservation , and after several recombination times they converge to a stromgren radius of 7.72 kpc , within 0.3% of the r@xmath97 = 7.70 kpc predicted by eq .",
    "( [ eqn : r_s ] ) .",
    "the small departure from theory at intermediate times evident in fig [ fig : t2 radii / temp ] arises because eq .",
    "( [ eqn : r2(t ) ] ) assumes a constant @xmath98(t ) throughout the evolution of the front . in reality",
    ", the h ii region has a temperature structure that changes over time , as shown in fig [ fig : t2 radii / temp ] . at",
    "any given time the temperature decreases from its maximum near the point source to its minimum at the i - front , and this drop in temperature with radius can grow to more than 10000 k at later times .",
    "we adopt an average temperature of 20000 k for @xmath98 in eq ( [ eqn : r2(t ) ] ) .",
    "the postfront temperatures are greatest near the central star because the gas there has undergone more cycles of recombination and photoionization than the gas near the front .",
    "each cycle increments the gas temperature upward because lower energy electrons are preferentially recombined with a net deposition of energy into the gas .",
    "successive profiles steadily rise in temperature over time for the same reason .",
    "the temperature profiles continue to rise well after the stromgren radius is reached as seen in fig [ fig : t2 radii / temp ] because there are no gas motions in which pdv work can be performed and because collisional excitation and ionization processes are suppressed by the decline of postfront neutral fractions with time .",
    "neutral fractions fall as rising temperatures slow down recombinations .",
    "the rising gas temperatures in this static problem eventually stall when they sufficiently quench recombinations , well before other processes such as bremmstrahlung cooling arise .",
    "inclusion of recombinations leads to the ionization structure of this static h ii region in fig [ fig : t2 ioniz ] ( which in part is determined by the temperature profile ) , in contrast with the very simple neutral fraction profiles of the previous test .",
    "@xcite extend this classical h ii region problem to a ionizing point source in a uniform medium undergoing cosmological expansion in a friedmann - robertson - walker universe , but this test can not be performed by zeus - mp at present because scale factors are not implemented in the code .",
    "et  al .  _ studied the hydrodynamics of i - fronts in power - law gradients but not their time - dependent propagation in static profiles .",
    "solutions for r - type fronts exiting flat central cores into r@xmath61 gradients do exist for static media but in general are quite complicated .",
    "@xcite found that in @xmath68 = 1 franco _",
    "et  al .",
    "_ static density profiles the radius of the front advances according to @xmath99\\right\\ } \\label{eqn : r4(t ) } \\vspace{0.1in}\\ ] ] where r@xmath97=l / k is the stromgren radius and w@xmath100(x ) is the principal branch of the lambert w function @xcite .",
    "w(x ) is a solution of the algebraic equation @xmath101 and must be evaluated numerically . here , @xmath102 and @xmath103 , where @xmath104 is the recombination time in the core and c is the clumping factor .",
    "( [ eqn : r4(t ) ] ) describes the approach of the bounded front to its modified stromgren radius r@xmath97 with time .",
    "w(x ) in general is multivalued in the complex plane ; its principal branch w@xmath100(x ) is single - valued over the range [ -1/e,0 ] , monotonically increasing from -1 to 0 over this interval . as the time in eq .",
    "( [ eqn : r4(t ) ] ) evolves from zero to infinity the argument of w@xmath100(x ) advances from -1/e to 0 , guaranteeing that the i - front expands from zero to r@xmath97 in approximately twenty recombination times .",
    "several commercial algebraic software packages can compute w(x ) ; we instead utilized a recursive algorithm by halley @xcite : @xmath105 adopting the first two terms in the series expansion for w(x ) as an initial guess for each value of x @xmath106 this method typically converged to an error of less than 10@xmath107 in 2 - 4 iterations per point .",
    "we show in the left panel of fig [ fig : w1/w2 ] the radius of the ionization front on uniform grids of 25 , 50 , 100 , 200 , 500 , and 1000 zones with inner and outer boundaries of 1.047 @xmath92 10@xmath108 cm and 5.6 @xmath92 10@xmath109 cm , respectively .",
    "we set n@xmath64 = 10@xmath93 @xmath88 , r@xmath64 = 2.1 @xmath92 10@xmath109 cm , @xmath98 = 2.4773 @xmath92 10@xmath110 ( constant with temperature ) , and @xmath89 = 5.0 @xmath92 10@xmath111 s@xmath91 , which results in a core recombination time of 0.128 yr and a final stromgren radius of 5.03 @xmath92 10@xmath109 cm .",
    "zeus - mp converges to within 4% of eq .",
    "( [ eqn : r4(t ) ] ) by 500 radial zones at early times and to within 1% past 1.5 yr ( on the scale of the graph , the 500 zone curve is essentially identical to the 1000 zone plot ) .",
    "the disagreement between theory and simulation clearly illustrates that photon - conserving schemes can fail to properly evolve ionization fronts if important density features are not resolved , in this case the abrupt falloff in density at the edge of the central core .",
    "nevertheless , the code still exhibits good agreement ( @xmath112 10% ) with the analytical result with relatively few ( 50 ) zones .",
    "the evolution of an r - type front in a static @xmath68 = 2 franco density field in general involves complex lambert w functions with several branches but reduces to the relatively simple unbounded solution @xcite @xmath113^{1/2 } \\label{eqn : r3(t)}\\vspace{0.1in}\\ ] ] provided that @xmath114 we plot the position of the ionization front in the right panel of fig [ fig : w1/w2 ] on a uniform grid for the resolutions indicated , with outer radius 0.8 kpc , n@xmath64 = 3.2 @xmath88 , r@xmath64 = 91.5 pc , and a constant @xmath98 = 2.4773 @xmath92 10@xmath110 , which yields a recombination time in the core of 0.04 myr and @xmath89 = 9.55 @xmath92 10@xmath115 s@xmath91 .",
    "the @xcite solutions assume a specific temperature for the h ii region that does not evolve with time , so @xmath98 was set constant in our simulation .",
    "our zeus - mp results converge to within 10% of eq .",
    "( [ eqn : r3(t ) ] ) by 2000 radial zones ( and are within 2 - 3% over most of the time range ) with @xmath89 = 9.65 @xmath92 10@xmath115 s@xmath91 .",
    "an interesting aspect of the analytical solution is its sensitivity to the requirement that @xmath98 is constant , as seen in the @xmath98(t ) plot in the right panel of fig [ fig : w1/w2 ] .",
    "recombinations are supressed in a static h ii region whose temperature varies with radius and increases with time , freeing the front to advance more quickly than expected from eq .",
    "( [ eqn : r3(t ) ] ) .",
    "r(t ) is also strongly divergent from eq .",
    "( [ eqn : r3(t ) ] ) for photon rates above or below eq .",
    "( [ eqn : ndot ] ) , as seen in the left panel of fig [ fig : w2/w2long ] .",
    "we set n@xmath64 = 10@xmath93 @xmath88 , r@xmath64 = 2.1 @xmath92 10@xmath109 cm , and @xmath98 = 2.4773 @xmath92 10@xmath110 in a simulation with a 172-zone ratioed grid with an outer radius of 5.5 pc .",
    "these much higher and more compact central densities were chosen for their relevance to high - redshift cosmological minihalos and are more computationally demanding .",
    "the ratioed grid is defined by the requirements @xmath116 where n is the number of radial zones and r@xmath117 was chosen to be small in comparison to 5.5 pc but large enough to avoid coordinate singularities at the origin .",
    "we applied a grid ratio @xmath118 = 1.03 to concentrate zones at the origin in order to resolve the central core and density drop .",
    "our choice of parameters sets @xmath89 = 3.844 @xmath92 10@xmath111 s@xmath91 and t@xmath119 = 0.128 yr . as shown in fig [ fig : w2/w2long ] , the ionization front in our calculation stalls for this value of @xmath89 but agrees with eq .",
    "( [ eqn : r3(t ) ] ) to within 5% if we change @xmath89 to 4.314 @xmath92 10@xmath111 s@xmath91 , a difference of 12% .",
    "if the photon rate is increased another 2% the front exits the grid much faster than predicted by eq .",
    "( [ eqn : r3(t ) ] ) and if it is decreased by 2% the front is halted , implying that the rate set by eq .",
    "( [ eqn : ndot ] ) is the threshold for breakout from an r@xmath87 core envelope .",
    "this result is confirmed by substituting eq .",
    "( [ eqn : ndot ] ) into eq .",
    "( [ eqn : r_s ] ) to compute the r@xmath97 appearing in eq .",
    "( [ eqn : wcrit ] ) , which yields @xmath82 = 2 .",
    "this gradient is just steep enough for the central flux of eq .",
    "( [ eqn : ndot ] ) to be unbounded , with the position of the front evolving according to the power - law eq .",
    "( [ eqn : r3(t ) ] ) .",
    "we note that while the front escapes for @xmath68 @xmath112 @xmath82 , it will slow down for @xmath68 @xmath2 3 because the cloud mass is infinite but approach the speed of light for @xmath68 @xmath112 3 because of finite cloud mass .",
    "the eventual slowing of the front in an @xmath68 = 2 cloud for @xmath89 = 5.0 @xmath92 10@xmath111 @xmath112 @xmath120 is confirmed at large radii in the right panel of fig [ fig : w2/w2long ] by extending the profile used above to an outer boundary of 1500 pc in a 500 ratioed - zone simulation with @xmath118 = 1.01 .",
    "as in the @xcite 1-d numerical tests , a source of ionizing photons with @xmath89 = 5.0@xmath9210@xmath121 s@xmath91 was centered in a flat neutral hydrogen core with r@xmath64 = 2.1@xmath9210@xmath122 cm , n@xmath123 = 10@xmath124 @xmath88 , and an r@xmath61 dropoff beyond r@xmath64 .",
    "h@xmath125 was set to 17.0 ev and the grid was divided into 8077 uniform radial zones with inner and outer boundaries at 1.047@xmath9210@xmath126 cm and 5.50 pc , respectively . although not necessary to the benchmarks , for completeness we employed the same interstellar medium ( ism ) cooling curve of @xcite utilized by @xcite in place of the three last terms of eq . ( [ eqn : egas ] ) .",
    "the photon energy and cooling curve together set the postfront temperature and therefore sound speed c@xmath7 of the ionized gas .",
    "our choice of cooling curve and @xmath25 = 2.4 ev led to postfront temperatures of 17,745 k and sound speeds of 15.6 km s@xmath91 in all our runs , in contrast to the artificially set 10,000 k temperatures and 11.5 km s@xmath91 sound speeds of the @xcite runs .",
    "we applied c@xmath7 = 15.6 km s@xmath91 to the analytical expressions above for r(t ) and r@xmath64(t ) .",
    "the initial gas temperature in all the hydrodynamical tests was set to 100 k.    it should be noted that the times appearing in r(t ) and r@xmath64(t ) are not taken from when the central source switches on .",
    "r(t ) is the position of the ionization front after the initial stromgren sphere of radius r@xmath127 has formed while r@xmath64(t ) is the location of the ionized core shock after one sound crossing time across the core @xmath128 so these values must be subtracted from the total problem time when comparing the formulae to code results .",
    "stromgren sphere formation times t@xmath129 and radii emerging from the run outputs are compiled in table 1 . in all cases",
    "the code computed stromgren radii within a zone width of the predicted r@xmath127 .",
    "ccc 1.0 & 5.970e16 & 3.142e09 + 1.2 & 7.290e16 & 8.730e08 + 1.4 & 1.015e17 & 1.035e09 + 1.45 & 1.148e17 & 1.102e09 + 1.5 & 1.337e17 & 1.121e09 +    the derivation for r(t ) does not account for the hydrodynamical details of the breakout of the shock through the i - front so the formula is an approximation which improves as the front grows beyond r@xmath127 . similarly , r@xmath64(t ) is also an approximation which is increasingly accurate as the core shock expands beyond r@xmath64 .",
    "column 1 of fig [ fig : 123profiles ] shows the density , velocity , and temperature profiles of a classic d - type ionization front expanding in an @xmath68 = 1 power law density for the problem times listed .",
    "zeus - mp correctly predicts the formation of a d - type front in this gradient ; the confinement of the front behind the leading shock is apparent from the abrupt temperature drop from 17800 k in the front to 2000 k in the shock .",
    "the front decelerates as predicted by eq .",
    "( [ eqn : r_w1 ] ) , from 9 km s@xmath91 to 6.5 km s@xmath91 over the simulation time .",
    "the dense shell thickens as the shock accumulates neutral gas , and the rapid decline in postfront densities as the problem evolves ( especially in comparison to the initial profile ) reveals the efficiency with which the ionized flow evacuates the cloud core .",
    "the ionized density profile is flat because any density fluctuations initially present in the isothermal gas become acoustic waves that smooth the variations on timescales that are shorter than the expansion time of the front ( which is subsonic with respect to the 17800 k gas ) .",
    "the postfront gas remains isothermal even though central densities fall and the front performs pdv work on the shock .",
    "this behavior can be understood from the various timescales governing the evolution of the gas energy density in the ionized flow @xmath130 we plot photoionizational heating , pdv work , radiative cooling , and recombinational timescales defined by @xmath131 along with the hydrodynamical courant time in fig [ fig : tscl1 ] as a function of radius for the @xmath68 = 1 flow .",
    "the shortest timescales are associated with the most dominant terms on the right hand side of eq .",
    "( [ eqn : eneqn ] ) .",
    "the heating and cooling times are identical to within 0.1% behind the d - type front , with recombination times that are slightly shorter and pdv work times that are three orders of magnitude greater .",
    "equal heating and cooling times ensure that these processes balance in the energy updates and do not change the gas temperature , and the much longer pdv timescales demonstrate that the work done by the flow behind the front is small compared to the gas energy . even though the ionized densities fall over time they still cause enough recombinations for the central star to remain",
    "energetically coupled to the flow by new ionizations and maintain the gas temperatures against radiative cooling and shock expansion .",
    "the early evolution of the front in the r@xmath132 envelope is shown in the left panel of fig [ fig : w3front ] with inner and outer problem boundaries of 1.047@xmath9210@xmath126 cm and 0.3 pc at resolutions of 250 , 500 , 1000 , and 2000 uniform radial zones .",
    "the curves are ordered from lower right to upper left in increasing resolution .",
    "the front exits the core in @xmath0 0.05 yr through an essentially undisturbed medium since this is much shorter than the dynamical time of the gas .",
    "the plots converge as the core to envelope transition becomes better resolved on the grid .",
    "zeus - mp reproduces the expected slowdown of the r - type front in the central core and its rapid acceleration as it exits the density gradient , having never made a transition from r - type to d - type .",
    "notice that beyond 0.1 pc the slopes of all the curves are restricted to the speed of light because the static approximation of radiative transfer breaks down in the rarified dropoff . as explained in section 6 , the mean free path of ionizing photons abruptly becomes comparable to the size of the grid at that radius and an unrestricted static approximation would permit nonzero photoionization rates to suddenly appear all the way to the outer boundary .",
    "as previously noted , in such circumstances the code restricts the position of the front to be @xmath133 this requirement prevents superluminal i - fronts over total problem times but not necessarily over successive timesteps , as seen in fig [ fig : w3front ] .",
    "as the front crosses the core boundary r@xmath134(t ) briefly curves upward with a slope greater than the speed of light c before it is abruptly limited to the speed of light by eq .",
    "( [ eqn : rct ] ) . having been slowed to less than c in the core the front can cross the next few zones faster than the speed of light because because the total distance the front has traveled over the entire problem time will still be less than ct@xmath135 .",
    "this results in the slight unphysical displacement of the front upward by @xmath0 0.1 pc , which can be seen if one visualizes the true curve to continue up and to the right with slope c from the point where the computed slope becomes greater than c. this error is negligible in comparison to the kpc scales on which the front later expands , and the code produces the expected approach of the front velocity to the speed of light at later times given that the mass of the cloud is finite , as observed earlier .",
    "in reality no cosmological density field decreases indefinitely so the front would eventually slow to a new stromgren radius in the igm @xcite .",
    "columns 2 and 3 of fig [ fig : 123profiles ] depict the ionized flows developing in @xmath68 = 3 and @xmath68 = 5 density fields after the r - type ionization front has exited the cloud . in both cases",
    "the departure of the front from the grid is visible in the 10000 k gas that extends out to the problem boundary .",
    "both clouds are ionized on comparable timescales with initially flat profiles before much dynamic response has arisen in the gas .",
    "however , very distinct flows emerge in the two profiles .",
    "the @xmath68 = 3 field has a shallower drop with smaller pressure gradients that drive a shock that accelerates weakly but supersonically with respect to the outer cloud .",
    "a reverse shock develops that can be seen in the tapered peak of the velocity profile and in the density maximum that falls increasingly behind the leading shock as the flow progresses .",
    "the supersonic expansion of the core does not permit the central densities to relax to constant values as in the d - type front , but they are fairly flat out to the reverse shock because the shocked region is still dynamically coupled to the inner flow .",
    "at any given moment the postshock gas temperatures are uniform in radius up to the reverse shock , but they decrease over time as the flow is driven outward .",
    "the temperatures are almost flat because the gas heating and cooling rates are nearly constant in the fairly uniform central densities .",
    "the temperatures fall with time because the central gas densities are lower than in the @xmath68 = 1 flow above .",
    "there are fewer of the recombinations that enable the central star to sustain the postshock temperatures as in the d - type front , so the flow expands partly at the expense of its own internal energy .",
    "the timescales of eq .",
    "( [ eqn : eneqn ] ) governing the gas internal energy and the courant times are shown in fig [ fig : tscl2 ] .",
    "pdv work done by the gas clearly outpaces photoionizational heating out to the reverse shock with a net loss of internal energy in the ionized gas .",
    "the suppression of recombinations is evident in the recombination times , which are nearly ten times the photoheating times .",
    "we show the initial transit of the i - front through an r@xmath136 falloff in the right panel of fig [ fig : w3front ] for the same boundaries and grid resolutions as in the @xmath68 = 3 plots on the left ; the curves again progress from lower right to upper left as the resolution increases .",
    "zeus - mp again correctly predicts the initial slowing of the front in the core and its rapid acceleration down the gradient without ever becoming d - type .",
    "there are no qualitative differences between the fronts in the two gradients prior to their exit from the core because their initial conditions are identical : the @xmath68 = 5 front also crosses the core in @xmath0 0.05 yr .",
    "there is likewise little difference between the two fronts after their velocities have been limited to the speed of light by the code .",
    "the two prominent differences are the slower convergence of the curves beyond r@xmath123 in the @xmath68 = 5 gradient and their greater superluminal velocities before being set to c by the restriction algorithm .",
    "both trends are expected : the front will descend the steeper gradient more quickly before being limited to the speed of light and more grid cells are required to resolve the falloff . again , because the @xmath68 = 5 cloud has finite mass , the velocity of the front becomes c at later times .    in this profile",
    "a much more abrupt isothermal density dropoff remains in the wake of the r - type front .",
    "extreme pressure gradients launch the edge of the core outward in a strong shock that is essentially a free expansion , as seen in the velocity profiles in column 3 of fig [ fig : 123profiles ] .",
    "the density falls off so sharply that recombinations are quenched there and the shock expands adiabatically .",
    "the shock advances so quickly that it becomes dynamically decoupled from the flow behind it , so no reverse shock forms and all the flow variables remain stratified with radius .",
    "temperatures rise to 4 @xmath92 10@xmath93 k in the shock but drop to 500 k behind it from adiabatic expansion .",
    "the sequence of velocity profiles confirms that the core shock accelerates over the entire evolution time of the problem , as predicted by eq .",
    "( [ eqn : om5 ] ) .",
    "it becomes hypersonic with speeds in excess of 400 km s@xmath91 .",
    "the central star is least energetically coupled to this ionized flow , with much of it being driven by its own internal energy .",
    "temperatures in the central ionized gas fall with time for the same reasons as in the @xmath68 = 3 profiles .",
    "the energy and courant times for the @xmath68 = 5 flow appear in fig [ fig : tscl3 ] .",
    "the hierarchy of timescales is similar to that of the @xmath68 = 3 flow up to the position of the shock , at which point cooling , heating , and recombination times rise much more quickly than their @xmath68 = 3 counterparts .",
    "the steeper jump in timescales is due to the strong suppression of recombinations in the highly stratified densities .",
    "zeus - mp accurately reproduces the mildly - accelerating ionized core shock expected to form in r@xmath132 radial densities as well as the strong adiabatic shock predicted for r@xmath136 gradients , with hydrodynamical profiles that are in excellent agreement with earlier work performed by 1-d implicit lagrangian codes @xcite . in this section",
    "we summarize our code results for i - fronts and shocks in r@xmath137 and r@xmath138 core envelopes and present their density , velocity , and temperature profiles in fig [ fig : 215profiles ] .",
    "zeus - mp verifies the theoretical prediction that a constant - velocity ionized shock forms in the @xmath68 = 2 gradient after the rapid departure of the r - type front , as seen in the upper middle panel of fig [ fig : 215profiles ] .",
    "this ionized flow does not steepen into as strong a shock as in the @xmath68 = 3 case , which is evident from the lower gas velocities and smaller spike in the temperature distribution .",
    "timescale analysis indicates that heating and recombination times are nearly equal in the postshock gas but not to the same degree as in the d - type @xmath68 = 1 front , so expansion occurs partly at the expense of the internal energy of the gas .",
    "consequently , the level gas temperatures behind the shock decrease slightly over time but not to the extent in the @xmath68 = 3 shock .",
    "the evolution of the postshock gas is intermediate between that in the r@xmath91 and r@xmath132 cases .",
    "this flow regime is relevant to primordial minihalos : high resolution simulations of the formation of these objects yield spherically - averaged baryon density profiles with 2.0 @xmath2 @xmath68 @xmath2 2.5 @xcite .",
    "the correspondence is not exact because @xmath68 can vary in radius over this range , which is why both shock accelerations and decelerations are observed numerically in profiles derived from cosmological initial conditions @xcite .",
    "our code confirms that the @xmath68 = 1.5 front evolves essentially as d - type but with no shocked neutral shell : the front and the shock are coincident and advance at the same velocity . throughout",
    "the evolution of this flow the front is precariously balanced at the edge of breakout through the shock and down the gradient .",
    "this breakthrough is sensitive to small errors in shock position at early times ; as a result , zeus - mp finds that the i - front overruns the shock when @xmath68 = 1.45 instead of 1.5 ( the densities , velocities , and temperatures in the second row of fig [ fig : 215profiles ] are for an r@xmath139 distribution ) .",
    "however , this is a relatively small error , and our algorithm captures shock and front positions to within 10% of theory for @xmath68 = 1.4 and 1.6 .",
    "although this discrepancy is still under investigation , we believe it to be due to small errors in energy conservation in our eulerian code . in this respect",
    "lagrangian codes would likely enjoy an advantage in proper shock placement because of their conservative formalism .",
    "we demonstrate the convergence of our algorithm to eq .",
    "( [ eqn : r_w1 ] ) for the i - front position r@xmath140(t ) in an @xmath68 = 1 dropoff as well as to the ionized shock position eqs .",
    "( [ eqn : om2 ] ) , ( [ eqn : om3 ] ) , and ( [ eqn : om5 ] ) for @xmath68 = 2 , 3 and 5 gradients in the first two rows of fig [ fig : shkres ] . for each density regime",
    "we utilized grids with 100 , 250 , 500 , 1000 , 2000 , 4000 , and 8000 uniform radial zones .",
    "the dashed line in each panel of fig [ fig : shkres ] is the analytical solution . in fig",
    "[ fig : shkres]a the numerical predictions for the position of the @xmath68 = 1 d - type ionization front are ordered from lowest to highest resolution from the lower right corner upward to the left toward the expected solution .",
    "zeus - mp converges to within 10% of eq .",
    "( [ eqn : r_w1 ] ) by 2000 zones and to within 2 - 3% at 8000 zones ( the 4000 zone curve is indistinguishable from the 8000 zone solution at this scale ) . because eq . ( [ eqn : r_w1 ] ) does not account for the r- to d - type transition of the front , the agreement improves the further the front advances beyond the stromgren radius at any resolution .",
    "convergence was fastest in the case of the constant velocity ionized core shock in the @xmath68 = 2 gradient , as shown in fig [ fig : shkres]c .",
    "the order of solutions is again from lowest to highest resolution from the lower right upward to the left toward eq .",
    "( [ eqn : om2 ] ) .",
    "agreement to within 10% between 10@xmath141 yr and 10@xmath142 yr and 2 - 3% past 10@xmath142 yr was achieved with just 500 zones .",
    "the trend is somewhat different for the weakly accelerating ionized shock in the @xmath68 = 3 panel in fig [ fig : shkres]b .",
    "the numerical models are all somewhat above the analytical curve at later times but the 100 and 250 zone runs are below it at earlier times .",
    "the different grids are most easily distinguished by their overshoot at late times : with the exception of the 100 zone curve they converge downward toward eq .",
    "( [ eqn : om3 ] ) with increasing resolution , with the 8000 zone curve dipping slightly below it near the end of the evolution time . with 2000 zones the convergence is to within 10% of the expected values between 5000 yr and 10 kyr and to within 1.5% by 60 kyr .    in the highly supersonic @xmath68 = 5 core shock runs shown in fig [ fig : shkres]d , the progression of the numerical curves toward eq . (",
    "[ eqn : om5 ] ) is again from lower right to upper left as the resolution increases , but they converge to a solution that lies well above the analytical result .",
    "although the hydrodynamical profiles for the @xmath68 = 5 ionized flow in fig [ fig : 123profiles ] are in excellent qualitative agreement with earlier work @xcite , in this gradient the algorithm does not accurately compute the shock placement for reasons that are currently under investigation .",
    "this flow regime is rather extreme , with very high shock temperatures that challenge the energy conservation of our code .",
    "such flows are unlikely to develop in the 3-d photoevaporation of the high - redshift minihalos that we plan to study . in the 2 @xmath2 @xmath68 @xmath2 3 gradients of relevance to those primordial structures @xcite , zeus - mp",
    "is quite accurate .",
    "the convergence trends in the early i - front evolution studies in the past three sections suggest that a key factor in accurate front placement is proper resolution of the central core and its initial dropoff .",
    "ratioed grids with higher central and lower outer resolutions can capture proper shock placement and front positions with far fewer zones than uniform grids , as shown in the bottom row of fig [ fig : shkres ] . in fig",
    "[ fig : shkres]e we plot ionized core shock radii as a function of time in both @xmath68 = 1 and 3 density profiles for a 250 zone uniform grid and a 172 zone ratioed grid with @xmath118 = 1.03 as defined in section [ sect : rmw static ] ; the analytical prediction in both panels is again the dashed line .",
    "we show the corresponding simulations for an @xmath68 = 2 profile in fig [ fig : shkres]f but with a 100 zone uniform grid .",
    "we achieve the same accuracy with 172 ratioed zones as with 2000 uniform zones in the first two regimes and as with 500 zones in the @xmath68 = 2 gradient ( the most convergent of the four regimes tested ) .",
    "equal accuracy with large savings in computational resources motivated our use of ratioed grids in earlier work , with the only sacrifice being the loss of some detail in the hydrodynamical profiles ( e.g. compare fig 3 in @xcite to the @xmath68 = 2 profiles in fig [ fig : 215profiles ] ) .",
    "the physical timescales governing code timesteps as i - fronts and flows evolve on the grid yield insights about the processes that drive the fronts and are the key to future algorithm optimization . in general ,",
    "different timescales dominate the transit of the front than the rise of ionized flows behind it .",
    "we examine how these timescales control the advance of the solution in four density gradients : @xmath68 = 1.0 , 2.0 , 3.0 , and 5.0 . as a rule , the photoheating timescales in the cell being ionized",
    "while the front remains on the grid determine the global timestep over which the entire solution is updated .",
    "we first describe how cells approach ionization equilibrium at different radii in these gradients .",
    "the ionization fraction x@xmath143 of a zone as a function of time varies with distance from the central source , ambient density , and type of ionization front . in this section",
    "we first examine the equilibration of a zone in the flat central core ( the same in all four density gradients ) and then analyze three other zones at radii of 0.25 pc , 1.0 pc , and 4.5 pc , well into the density falloffs in which the distinct characters of the fronts emerge .",
    "we plot the ionization curves for the four radii in figs [ fig : ionprfl]a , c , e , and fig [ fig : tsclprfl]a for @xmath68 = 1 , 3 , 5 , and 2 gradients , respectively .",
    "we tally the corresponding consecutive heating timesteps t@xmath56 ( eq .",
    "( [ eqn : theat ] ) ) in the four cells as they come to equilibrium in figs [ fig : ionprfl]b , d , f , and fig [ fig : tsclprfl]b ( recall that t@xmath56 is the interval over which full hydrodynamical updates are performed ) .      the zone we consider in the central core is the fourth from the coordinate origin , but the ionization of the inner boundary also merits discussion .",
    "chemical subcycling over t@xmath56 is uniquely extreme in this zone because the uv radiation entering its lower face initially encounters no electron fraction whatsoever .",
    "since n@xmath143 is zero t@xmath144 is extremely small so far more chemical timesteps are invoked to cover t@xmath56 than are required by the network ( several thousand ) . in practice",
    "this only occurs on the inner boundary because over the 80 - 90 heating times required to ionize the inner zone the hydrodynamic updates advect a small electron fraction into the next zone , substantially reducing the number of initial chemical cycles there .",
    "the network subcycles @xmath0 100 times in the fourth zone in its first heating timestep but only two or three times by the fifth timestep .",
    "roughly 100 t@xmath56 are necessary to ionize this zone .    as shown in fig [ fig : ionprfl]d , heating times are at first @xmath0 1 s in the central zone but increase to 1 @xmath92 10@xmath145 s by the time it reaches x@xmath143 = 0.999 .",
    "the heating rate @xmath9 is greatest when the front enters the cell because k@xmath19n@xmath146@xmath25 is at its maximum but cooling rates are at their minimum because of the low initial temperature of the cell .",
    "this low temperature implies that e@xmath147 is also at its minimum , ensuring that the first t@xmath56 is the smallest .",
    "as the temperature and gas energy rise with x@xmath143 , cooling processes are activated and decrease @xmath9 , increasing t@xmath56 .",
    "when x@xmath143 exceeds 0.999 heating times can abruptly dwarf the light - crossing time t@xmath148 of the cell because cooling suddenly balances photoionizational heating , driving @xmath9 sharply downward .",
    "the code solution consequently takes too large a timestep forward , over which ionization that should have commenced in subsequent zones can not , unphysically stalling the young i - front .",
    "this only occurs in core zones close to the source because t@xmath42 @xmath149 t@xmath148 further from the center .",
    "ionization begins in the next zone before the previous zone can come to equilibrium , decreasing the code timestep dt and preventing anomalous jumps of the solution forward in time .",
    "the jumps in central zones are easily remedied by limiting t@xmath56 to be less than a tenth of the light - crossing time there . after a core zone is fully ionized the code solution advances by consecutive 0.1 t@xmath148 steps until eq .",
    "( [ eqn : rct ] ) permits ionizations in the next zone .",
    "hence , the uv flux in the core zones is a step function in time , immediately rising to full intensity because intervening zones are completely transparent .",
    "the heating time profiles for r - type fronts in @xmath68 = 3 and 5 gradients appear in figs [ fig : ionprfl]d and f. as noted earlier , these fronts rapidly accelerate and must be limited to the speed of light by the code .",
    "the uv flux in the outer zones is again a step function in time because , as observed above , the front arrives at the next zone before the current zone is completely ionized . in this instance",
    "the step in the radiation field is not quite to its full intensity because one or more of the intervening zones is not fully transparent . as in the core zone , we begin the tally of t@xmath56 in the outer three test zones when their photoionization rates switch on . the heating times",
    "are again comparatively small at first and grow by several orders of magnitude as the cells become ionized .",
    "the heating times as a rule increase with distance from the source because the smaller outer fluxes generate lower photoionization rates .",
    "the static approximation is clearly violated near the inner boundary because the 1 @xmath92 10@xmath145 s ionization timescale of the core zone is comparable to its 7 @xmath92 10@xmath145 s light - crossing time .",
    "the approximation also fails in the outer zones of these two gradients even though ionization times are much longer than light - crossing times there .",
    "the explanation lies in the photon mean free paths : as shown in table 2 , they exceed the length of the grid as the densities plummet with radius .",
    "if the widths of the fronts overrun the outer boundary the static approximation would allow nonzero ionization rates in zones that could not have been reached by light by that time in the simulation .",
    "we must again employ eq .",
    "( [ eqn : rct ] ) to prevent superluminal velocities in the outer regions .",
    "igm mean densities prevent runaway i - fronts in realistic cosmological conditions . in compiling heating time profiles of the outer zones we terminate the advance of the front beyond the zone in question to avoid the downshift in code timestep associated with ionizations in a new zone before the current cell has equilibrated .",
    "ccccc 0.25 & 6.35e-6 pc & 1.29e-4 pc & 4.79e-3 pc & 6.6 pc + 1.0 & 1.38e-5 pc & 2.03e-3 pc & 0.299 pc & 5600 pc + 4.5 & 6.21e-5 pc & 4.10e-2 pc & 27.14 pc & 1.18e07 pc +      in fig [ fig : tsclprfl]b the @xmath68 = 2 t@xmath56 profiles at 0.25 pc , 1.0 pc , and 4.5 pc have a more complicated structure because the uv radiation illuminating those zones is not a step function in time .",
    "as seen in table 2 the front is a fraction of a zone in width at first but quickly widens to encompass several zones . although r - type , the front has a velocity well below the speed of light so ionizations proceed several zones in advance of the center of the front .",
    "the radiation field at the leading zone is initially weak ( having been attenuated by the previous few partially - ionized zones ) but soon grows to its full intensity as the center of the front crosses the cell . as a result",
    "the energy deposition into the gas is first relatively small but increases as the radiation field intensifies .",
    "@xmath9 then dips back downward when cooling processes are switched on as the zone temperature increases .",
    "the heating times therefore curve downward but then recover upward as shown in fig [ fig : tsclprfl]b .",
    "the profiles again migrate upward with distance from the source .",
    "the static approximation is well - obeyed in this regime given that the ionization times are much longer than the zone - crossing times for light and that the speed of the front is much smaller than c. the width of the front also remains small in comparison to the grid .",
    "we begin the heating time tally in the three cells when x@xmath143 has risen to 1 @xmath92 10@xmath136 because there is no sudden activation of photoionization rates in them .      as we show in figs [ fig : ionprfl]a and b , test zones ionized by the d - type front in an @xmath68 = 1 gradient exhibit noticeably different ionization fractions and heating times because the shock reaches them before the front .",
    "the shock raises their temperatures to a few thousand k and induces collisional ionizations that leave a residual x@xmath150 0.01 - 02 .",
    "shock heating lengthens t@xmath56 when the front reaches the cell because e@xmath147 is 200 - 300 times greater than in the preshock gas and the initial chemistry subcycling is heavily reduced by the collisional electron fraction .",
    "the radiation profile in these cells is a smooth function of time because of the uv photons escaping ahead of the front into the slightly preionized zone ( the width of the front itself in these densities is less than a tenth of a zone ) .",
    "we initiate the tally of t@xmath56 in the cell when ionization rates surge with the arrival of the center of the front .",
    "the large fluctuations in heating times at 0.25 pc are due to postshock numerical oscillations of the hydrodynamical flow variables .",
    "these variations dampen at larger radii because the shocked neutral shell thickens with time ; the densities the front photoevaporates have more time to numerically relax to steadier values .",
    "postshock oscillation is also responsible for the early variations in the 0.25 pc x@xmath143 profile . as in the other gradients",
    ", t@xmath56 again increases with distance from the central source .",
    "the static approximation is most valid in this density regime , with material properties changing many orders of magnitude more slowly than light - crossing times .",
    "as the nascent i - front emerges from the central core the numerical solution evolves in a succession of heating timesteps that rise and then fall as one zone comes to equilibrium and ionization commences in the next . as discussed earlier",
    ", the heating timesteps in the zone being ionized rarely achieve their full values in figs [ fig : ionprfl ] and [ fig : tsclprfl ] because ionization in the next zone is activated before the current zone can come to full equilibrium . because the timesteps are determined by the sum of photoionizational heating and cooling in the zone being ionized , they are much smaller than courant times in the postfront gas ( @xmath0 10 yr ) while the front is on the grid .",
    "although restrictive , such timesteps are necessary in part because of the proximity of the ionized gas temperature to the sharp drop in the cooling curve near 10,000 k ; longer timesteps can cause sudden unphysical cooling in equilibrated zones that lose energy in a heating cycle . whenever ionization fronts approach the speed of light the solution is limited to relatively short steps until the front exits the grid ( although it should be remembered from figs [ fig : ionprfl ] and [ fig : tsclprfl ] that the timesteps grow as the radius of the front increases ) .",
    "the rise and sharp fall of timesteps continues until the i - front exits the outer boundary . in @xmath68",
    "= 3 and 5 gradients the code expends 85% of its cycles propagating the front across the grid ( @xmath0 19 yr ) and its last 15% advancing the core shock to the outer boundary ( @xmath0 1 @xmath92 10@xmath142 yr ) .",
    "the transport of r - type fronts in @xmath68 = 2 gradients is uniquely efficient because of the unusual t@xmath56 profile of the zones .",
    "when a cell begins to be ionized the heating times are initially fairly long and are again relatively long as the zone approaches equilibrium . on average ,",
    "this curve allows the solution to evolve much further in time each cycle .",
    "70% of the simulation timesteps are utilized for the transit of the front ( @xmath0 500 yr ) with the remainder being spent on the exit of the ionized shock ( @xmath0 1.5 @xmath92 10@xmath151 yr ) .",
    "this simulation requires only 20% of the cpu time of the @xmath68 = 3 and 5 runs , which require about the same time to execute .",
    "the much longer heating times in the @xmath68 = 1 gradient enable the code to advance the d - type front across the grid with only 30% of the cycles needed in the @xmath68 = 3 and 5 models . however , much longer simulation times ( @xmath0 6.0 @xmath92 10@xmath151 yr ) are necessary to advance the front to the outer boundary because of its relatively low velocity behind the shock , so this run executes with somewhat greater cpu times than the @xmath68 = 2 model .      in figs [ fig : tsclprfl]c , d , e , and f we plot global minima of the courant , pdv work , photoionizational heating , recombination , and cooling timescales along with the code timestep dt as a function of time after the fronts have exited the grid ( except for the @xmath68 = 1 case ) for @xmath68 = 1 , 2 , 3 , and 5 density profiles .",
    "after the outermost zone is completely ionized the minimum heating and cooling times by which the solution is governed settle to nearly constant values for the sound crossing time of the central core , approximately 500 yr . the 1 @xmath92 10@xmath152 - 10@xmath153 s code timesteps dt are similar to the heating times in core zones that have come to complete equilibrium ( see fig [ fig : ionprfl ] ) .",
    "500 yr marks the steepening of the pressure wave at the core s edge into the ionized shock that begins to evacuate the core .",
    "as central densities fall recombinations are supressed , slowing cooling rates and new ionizations .",
    "photoheating , recombination , and cooling timescales rise , surpassing courant times at t @xmath0 1000 yr , at which point the code adopts t@xmath154 as the new global timestep .",
    "the noise in the code timestep prior to crossover is due the nearly equal heating and cooling rates ; their difference is sensitive to minor variations in each rate and can modulate relatively large fluctuations in @xmath155 .",
    "this noise disappears after the algorithm turns to t@xmath154 to compute dt .",
    "the minimum t@xmath156,t@xmath157 , and t@xmath158 originate in the relatively flat densities behind the shock ( see fig [ fig : tscl2 ] ) and continue to rise with the expulsion of baryons from the center of the cloud .",
    "the three timescales branch away from each other at late times in the @xmath68 = 3 and 5 panels because the cooling rates are sensitive to the drop in postshock gas temperature ( from 18,000 k down to 2000 k in the @xmath68 = 3 gradient ) as the ionized flows expand in the course of the simulation .",
    "the rates do not diverge in @xmath68 = 1 and 2 postshock flow because the gas is either isothermal or nearly so .",
    "the courant time is approximately 15 yr in the newly ionized gas in all four cases but begins to fall after the core sound crossing time in the last three regimes as a result of the formation of the shock .",
    "the minimum courant time coincides with the temperature peak of the shock at all times thereafter in the @xmath68 = 2 , 3 , and 5 flows but resides within the i - front in the @xmath68 = 1 gradient because the much higher temperature of the ionized gas in comparison to the weakly shocked neutral gas .",
    "as shown in fig [ fig : tsclprfl]c , the courant profile is almost flat in this flow regime because the postfront gas is isothermal .",
    "the ionized core shock in the @xmath68 = 2 gradient has a nearly constant velocity after formation so its courant time remains flat after falling to 10 yr in fig [ fig : tsclprfl]d .",
    "the @xmath68 = 3 flow only weakly accelerates and therefore exhibits a similar profile in fig [ fig : tsclprfl]e with final courant times of 4.5 yr in the stronger shock .",
    "courant times in the hypersonic @xmath68 = 5 flow continue to fall in fig [ fig : tsclprfl]f because of its strong acceleration , eventually dropping to 0.6 yr by the end of the simulation .",
    "the first dip in the pdv timescale at t @xmath0 480 yr in the @xmath68 = 2 , 3 , and 5 plots results is due to outflow of heated gas from the inner boundary zone .",
    "the oscillations after the dip at t @xmath0 800 yr are associated with the launch of the core shock .",
    "the minimum work times later track the forward edge of the shock at all times thereafter in all four regimes .",
    "the behavior of the @xmath68 = 2 , 3 , and 5 pdv profiles after the rise of the shock mirrors that of the courant profiles .",
    "the constant speed @xmath68 = 2 shock uniformly accelerates parcels of upstream gas throughout its evolution so its pdv timescales remain fairly flat . in contrast , the strong @xmath68 = 5 shock accelerates upstream fluid elements to increasingly higher speeds as it advances so its work timescales continue to fall .",
    "the profile of the gently accelerating @xmath68 = 3 shock falls in between these two cases , sloping downward and then evening out at later times .",
    "pdv timescales in the d - type front actually rise over time because of the deceleration of the shock .",
    "the momentary spike in the profile at t @xmath0 2000 yr ( also manifest in the courant profile ) occurs at the inner boundary and is likely due to pressure fluctuations associated with acoustic waves there .",
    "several features in the @xmath68 = 1 plot deserve attention",
    ". the pdv timescale oscillations at t @xmath2 400 yr are from sound waves in the flat core .",
    "the postshock numerical oscillations of the flow variables responsible for the rapid fluctuations in the heating profiles continue to cause rapid variations in the heating , cooling , and work timescales throughout the simulation , dominating the code timestep until the average t@xmath56 rises above the courant time at t @xmath0 3 @xmath92 10@xmath151 yr .",
    "it is important to remember that the noise in t@xmath56 and t@xmath158 in this panel is not readily apparent in fig [ fig : tscl1 ] because the global minima in fig [ fig : tsclprfl ] occur at the rear edge of the shock .",
    "the two timescales quickly become equal behind the shock .",
    "direct radiation forces in astrophysical flows can strongly influence their evolution in scenarios like accretion onto compact objects or line - driven winds from massive stars . in order to assess the radiation pressures exerted by pop iii stars upon their parent halos we added an operator - split update term to the zeus - mp momentum equation : @xmath159 we utilized a flux corresponding to the blackbody spectrum of a 200 m@xmath160 star with t@xmath161 = 10@xmath162 k normalized to yield the emission rate of all photons above the hydrogen ionization threshold given in table 4 of @xcite and centered in the lcdm spherically - averaged halo discussed in section [ sect : uvesc ] .",
    "the neutral hydrogen component of the extinction coefficient exits the integral , which , along with the integral required to normalize the flux , only needs to be evaluated once .",
    "varies over ionization timescales because of its dependence on the neutral hydrogen fraction , so radiation momentum transfer into the gas must be accrued over consecutive chemical timesteps .",
    "this is done by multiplying the force integral above in every problem zone by the current chemical timestep and summing this product over subsequent chemical times until the hydro timestep has been crossed .",
    "the sum is then divided by the total density to obtain the update to the gas velocity in each zone .",
    "this method neglects spectral hardening across the front that could only be captured by a full multifrequency treatment of the radiation transfer , but these effects are likely to be unimportant in the high densities of the primordial halo .",
    "gas densities and uv fluxes are largest at the center of the halo so radiation forces exert their greatest influence in the earliest stages of primordial h ii region evolution .",
    "uv photons can accelerate both the small neutral fractions in the postfront gas as well as the thin semi - neutral discontinuity at the front .",
    "gravitational , thermal pressure gradient , and radiation forces in the early i - front are compared at 22 yr and 220 yr in fig [ fig : pressure ] .",
    "thermal pressure gradients cancel gravity forces upstream of the shock leading the front ( because of the hydrostatic initial conditions of the gas ) but dwarf them , as expected , within the h ii region itself .",
    "the radiation force is also much greater than gravity within the h ii region , an interesting result given that neutral fractions are less than 10@xmath136 there .",
    "thermal pressure dominates radiation in the gas on either side of the i - front except in the partially - neutral layer of the front where the radiation force spikes because the product of the flux and neutral fraction peaks there . in contrast , the radiation pressure is somewhat larger than thermal pressure in the postfront gas at 220 yr in this simulation , but their ratio in general is sensitive to changes in the very small neutral fraction in the ionized gas that can occur problem resolution or initial conditions .",
    "comparison of the direct uv forces upon the postfront gas at 22 yr and 220 yr clearly shows that they diminish with time . as the 10@xmath145 k gas expands",
    ", it is driven outward with an accompanying drop in central densities that suppresses recombination rates .",
    "central neutral fractions fall ( eventually to 10@xmath163 ) , with a corresponding loss of radiation pressure .",
    "our radiation force profiles are in general agreement with @xcite , who considered the same 200 m@xmath160 blackbody spectrum but applied a different initial density profile .",
    "our simulations reveal that the radiation forces in the ionized gas behind the front enhance its velocity by less than one percent , even though they are comparable to the thermal forces there .",
    "this is due to the fact that the thermal pressure gradients in the shocked gas and just behind the front are primarily responsible for the acceleration of the flow , and these gradient forces are large in comparison to the radiation forces except across the few photon mean free paths ( mfp ) of the front .",
    "direct calculation of the uv acceleration of fluid elements in the i - front layer itself is currently impractical for two reasons .",
    "the mfp of uv photons through the baryonic densities typical of 10@xmath93 m@xmath160 halos is approximately 10@xmath164 pc , well below the resolution limit of an eulerian calculation that must accommodate the much larger dynamical scales of the h ii region .",
    "failure to resolve the front can cause a code to interpret the very large radiation force peak to act upon the entire problem cell over the time required to ionize all of the cell , when in reality the force spike only operates on the fluid parcels in the extremely thin front for just the time required to ionize this layer ( such an error led to unphysically large gas velocities in early trials of our code ) .",
    "furthermore , the intense uv flux in such proximity to the central star can violate the static approximation to the transfer equation , necessitating the use of the fully time - dependent equation to ensure accurate transport of the i - front , even across an appropriately rezoned grid .",
    "[ fig : pressure ]    a simple estimate of the radiative acceleration of gas elements in the front is possible by recognizing that it acts on the layer for at most a few ionization timescales , between 10@xmath145 s and 10@xmath162 s at the times indicated in fig [ fig : pressure ] .",
    "the product of the radiation force peak in fig [ fig : pressure ] and these photoionization times yields an upper limit to the velocity imparted to the front , which we find from the data above to be less than 2 km s@xmath91 , too little to significantly alter the evolutionary outcome of the ionized flow .",
    "this estimate is an upper bound because the force actually decreases as the parcels are ionized , while this procedure takes it to be constant ( and at its maximum strength ) .",
    "when the thin layer is ionized , the large radiation force upon it evaporates and continues on to the next layer .",
    "the global radiation momentum transfer from the thin front into the gas accelerates it by at most 1 - 2 km s@xmath91 .",
    "the breakout of uv radiation from pop iii minihalos was explored in an earlier paper @xcite ( hereafter wan04 ) ; we now extend this study to lower stellar masses with improved problem setup .",
    "we adopted the spherically - averaged lcdm baryon field of a 5 @xmath92 10@xmath162 m@xmath165 dark matter minihalo formed at z = 18 for our initial number density profile @xcite in place of the cdm density profile of @xcite .",
    "also , in our earlier work , the inner boundary was set to 0.06 pc in the cdm protostellar density , regardless of the mass assumed for the central star later forming at its center .",
    "launching the i - front from this radius would neglect the 100 - 200 m@xmath165 gas mass interior to this radius not consolidated into the protostar in the lower stellar mass cases , as seen in fig [ fig : dens / mtot ] .",
    "the inner boundary was therefore set to be the radius enclosing a gas mass equal to the mass of the star whose uv escape fraction was being studied .",
    "although this inner few hundred m@xmath165 is small in comparison to the outer tens of thousands of solar masses later ionized in our previous studies , they were included because their significantly higher number densities and recombination rates might disproportionately retard the advance of the front .",
    "apart from these two modifications , the problem setup was the same as in the wan04 simulations .    an important consequence of shifting the inner problem boundary in accord with the protostellar mass is that the nascent i - front can now encounter much higher central densities , up to 10@xmath153 @xmath88 for the 25 m@xmath165 runs compared to the 10@xmath142 @xmath88 densities in wan04 .",
    "the accompanying rise in photoionization rates restricts the timestep control to much shorter advances , making 25 m@xmath165 the lower practical computational limit in these density profiles . despite gathering interest in the physical processes that cut off accretion onto pop",
    "iii protostars @xcite , they are not understood well enough to provide firm estimates on the final masses of these objects , only that they are likely 30 - 300 m@xmath165 @xcite .",
    "future models will also be needed to determine the central envelope densities and infall through which primordial i - fronts truly emerge ; the exit of ionization fronts through accretion infall will be studied in forthcoming 3-d simulations .",
    "ccccc 25 & 5.0e-3 &  &  & 0 + 40 & 8.8e-3 &  &  & 0 + 80 & 1978 & 3.3e05 & 7.9 & 89% + 120 & 2633 & 2.3e05 & 7.2 & 91% + 140 & 3186 & 1.7e05 & 4.9 & 93% + 200 & 3505 & 1.3e05 & 3.7 & 94% + 260 & 3856 & 9.0e04 & 2.8 & 96% + 300 & 4441 & 8.5e04 & 2.6 & 96% + 400 & 4665 & 5.9e04 & 2.3 & 97% + 500 & 5132 & 1.9e04 & 1.0 & 99% +    results for stellar masses ranging from 25 m@xmath165 to 500 m@xmath165 using the time - averaged photon rates from table 4 of @xcite appear in table 3 .",
    "since no uv photons exit the virial radius of the halo before the front transforms from d - type back to r - type , f@xmath166 is simply @xmath167 where t@xmath168 and t@xmath169 are the stellar main sequence lifetime and time to i - front breakout , respectively .",
    "comparison of these final i - front radii with those of wan04 for m @xmath112 100 m@xmath165 indicates that they differ by 20% at 120 m@xmath165 but only by 4% at 500 m@xmath165 in a trend toward greater agreement with mass .",
    "wan04 excluded the most intervening mass at 120 m@xmath165 and the least at 500 m@xmath165 , so it is not surprising the i - front is delayed the most in the first case",
    ". as expected , breakout radii and times decrease with increasing stellar mass    the i - front breakout from the 80 m@xmath165 case shows that lower - mass pop iii stars still effectively ionize their local environments and can establish ionized outflows capable of dispersing any elements ejected by pulsational instabilities before the star collapses directly into a black hole @xcite .",
    "in contrast , the primordial envelope traps the i - fronts of the 25 m@xmath165 and 40 m@xmath165 stars to form ultracompact h ii ( uc h ii ) regions with lifetimes of 6.5 myr and 3.9 myr , respectively .",
    "the higher central recombination rates overwhelm the lower ionizing photon rates of a lower mass star to stall the front at subparsec radii",
    ". a star in this mass range can not remain on the main sequence long enough for the ionized pressure bubble to expand and free the front .",
    "we have presented an explicit multi - step scheme for integrating the coupled equations of radiation transport , ionization kinetics , radiative heating and cooling , and hydrodynamics .",
    "we have validated our method against a large battery of analytic test problems for both static and moving media . while these are 1d tests , the method is easily extended to 3d .",
    "an important strength of our multistepping algorithm is its applicability to a variety of radiation transport schemes for computing photoionization rates on a grid .",
    "many problems can be addressed by this method in its current state as a single source code , with more soon being possible with the planned activation of the full 9-species network as well as multifrequency and multisource upgrades .",
    "full 3d radiation hydrodynamical trials of the code are currently underway to simulate the escape of uv radiation from high - redshift minihalos formed from realistic cosmological initial conditions .",
    "one important question to be answered is whether the uv escape fraction cutoff observed by kitayama , _ et  al .  _ with low stellar masses",
    "persists if three - dimensional instabilities arise at the ionization front .",
    "instabilities may open channels out of the halo and permit the exit of uv radiation that would not otherwise have escaped , enhancing uv escape fractions from low mass stars . on the other hand , recent high dynamical range amr simulations of primordial star formation @xcite",
    "have revealed the formation of disks around protostars .",
    "these disks may reduce escape fractions even from high mass stars by blocking uv photons along lines of sight in the plane of the disk with large optical depths .",
    "the radiation hydrodynamical evolution of these objects will enable the simulation of more realistic initial conditions for the explosion of supernovae and subsequent chemical enrichment of the early universe .",
    "such simulations would also set the stage for self - consistent modeling of the energetics of cosmological miniquasars and the propagation of their radiation into the early igm @xcite .",
    "while we have modified our algorithm to study the photoevaporation of minihalos in the vicinity of a massive population iii ( pop iii ) star in 1d at high redshifts @xcite , the ionization of these objects in 3d with primordial chemistry remains to be done .",
    "the catalysis of molecular hydrogen within these structures in the presence of suv and x - ray backgrounds as they are being ionized by external fronts is a key issue in radiative feedback processes in the early universe that is not well understood .",
    "another process within the realm of study of our single source algorithm is the potential cutoff of accretion onto pop iii protostars by nascent i - fronts as the star enters the main sequence .",
    "radiation hydrodynamical simulation of accretion cutoff processes with improved stellar evolution models at their foundation will provide firmer estimates of the true mass spectrum of pop iii stars , a key ingedient in large scale calculations of early reionization .",
    "studies of the escape of uv radiation from high redshift protogalaxies of @xmath0 1000 pop iii stars are currently being planned in connection with the addition of cartesian multisource vtef radiative transfer @xcite to zeus - mp .",
    "having exhaustively validated our coupling scheme for radiative transfer and hydrodynamics in 1d with the array of static and hydrodynamic tests presented in this paper , we can now apply the algorithm to these relevant and timely problems in three dimensions with confidence .",
    "we would like to thank the anonymous referee for suggestions which have significantly improved the quality of this paper .",
    "dw would like to thank mordecai mac - low , tetsu kitayama , and ilian iliev for useful discussions .",
    "this work was supported in part by nsf grants ast-0307690 and ast-9803137 .",
    "dw has also been funded in part by the u.s .",
    "dept .  of energy through its contract w-7405-eng-36 with los alamos national laboratory .",
    "the simulations were performed at sdsc and ncsa under nrac allocation mca98n020 .",
    "abel , t. , bryan , g.  l. , & norman , m.  l.  2002 , science , 295 , 93 abel , t. , norman , m.  l. , & madau , p.   1999",
    ", , 523 , 66 anninos , p. , zhang , y. , abel , t. , & norman , m.  l.  1997 , new astronomy , 2 , 209 barkana , r. , & loeb , a.  2004 , , 609 , 474 bromm , v. , coppi , p.  s. , & larson , r.  b.  1999 , , 527 , l5 cen , r.  2003 , , 591 , 12 ciardi , b. , ferrara , a. , marri , s. , & raimondo , g.  2001 , , 324 , 381 ciardi , b. , ferrara , a. , & white , s.  d.  m.  2003 , , 344 , l7 cooray , a. , bock , j.  j. , keating , b. , lange , a.  e. , & matsumoto , t.  2004 , , 606 , 611 cooray , a.  & yoshida , n.  2004 , , 351 , l71 corless , r.  m. , gonnet , g.  h. , hare , d.  e.  g. , jeffrey , d.  j. , & knuth , d.  e.   1996 , advances in computational mathematics , 5 , 329 .",
    "dalgarno , a. & mccray , r.  a.  1972 , , 10 , 375 franco , j. , tenorio - tagle , g. , & bodenheimer , p.  1990",
    ", , 349 , 126 furlanetto , s.  r. , & briggs , f.  h.  2004 , new astronomy review , 48 , 1039 garcia - segura , g. , & franco , j.  1996 , , 469 , 171 haiman , z.  & holder , g.  p.  2003",
    ", , 595 , 1 heger , a. , fryer , c.  l. , woosley , s.  e. , langer , n. , & hartmann , d.  h.  2003 , , 591 , 288 kogut , a.  _ et  al .  _",
    "2003 , , 148 , 161 kitayama , t. , yoshida , n. , susa , h. , & umemura , m.  2004 , , 613 , 631 kuhlen , m. , & madau , p. , astro - ph/0506712 .",
    "machacek , m.  e. , bryan , g.  l. , & abel , t.  2003 , , 338 , 273 maselli , a. , ferrara , a. , & ciardi , b.  2003 , , 345 , 379 mellema , g. , iliev , i. t. , alvarez , m. , & shapiro , p. r. , new astronomy , submitted .",
    "norman , m.  l.  2000 , revista mexicana de astronomia y astrofisica conference series , 9 , 66 oh , s.  p.  & haiman , z.   2003 , , 346 , 456 omukai , k.  & inutsuka , s.  2002 , , 332 , 59 omukai , k.  & palla , f.  2003 , , 589 , 677 oshea , b.  w. , abel , t. , whalen , d. , & norman , m.  l.  2005 , , 628 , l5 osterbrock , d. astrophysics of gaseous nebulae and active galactic nuclei , university science books 1989 .",
    "paschos , p.  & norman , m.  2005 , , in prep .",
    "razoumov , a. o.  & cardall , c. y. , astro - ph/0505172 .",
    "ricotti , m. , gnedin , n.  y. , & shull , j.  m.  2001 , , 560 , 580 rijkhorst , e. j. , plewa , t. , dubey , a.  & mellema , g. , astro - ph/0505213 .",
    "ripamonti , e.  & abel , t.  2004 , , 348 , 1019 santos , m.  r. , bromm , v. , & kamionkowski , m.  2002 , , 336 , 1082 schaerer , d.  2002 , , 382 , 28 shapiro , p.  r. , & giroux , m.  l.  1987 , , 321 , l107 shapiro , p.  r. , iliev , i.  t. , & raga , a.  c.  2004 , , 348 , 753 sokasian , a. , abel , t. , hernquist , l. , & springel , v.  2003 , , 344 , 607 sokasian , a. , yoshida , n. , abel , t. , hernquist , l. , & springel , v.  2004 , , 350 , 47 somerville , r.  s.  & livio , m.  2003 , , 593 , 611 spergel , d.  n.  _ et  al .  _   2003 , , 148 , 175 stone , j.  m.  & norman , m.  l.  1992 , , 80 , 753 tenorio - tagle , g. , bodenheimer , p. , lin , d.  n.  c. , & noriega - crespo , a.  1986 , , 221 , 635 wehrse , r. , wickramasinghe , d. & dave , r. , astro - ph/0507359 .",
    "whalen , d. , abel , t. , & norman , m.  l.  2004 , , 610 , 14 wood , k. , & loeb , a.  2000 , , 545 , 86 wyithe , j.  s.  b.  & loeb , a.  2003 , , 586 , 693 yorke , h.  w.  1986 , , 24 , 49"
  ],
  "abstract_text": [
    "<S> radiation hydrodynamical transport of ionization fronts in the next generation of cosmological reionization simulations holds the promise of predicting uv escape fractions from first principles as well as investigating the role of photoionization in feedback processes and structure formation . </S>",
    "<S> we present a multistep integration scheme for radiative transfer and hydrodynamics for accurate propagation of i - fronts and ionized flows from a point source in cosmological simulations . </S>",
    "<S> the algorithm is a photon - conserving method which correctly tracks the position of i - fronts at much lower resolutions than non - conservative techniques . </S>",
    "<S> the method applies direct hierarchical updates to the ionic species , bypassing the need for the costly matrix solutions required by implicit methods while retaining sufficient accuracy to capture the true evolution of the fronts . </S>",
    "<S> we review the physics of ionization fronts in power - law density gradients , whose analytical solutions provide excellent validation tests for radiation coupling schemes . the advantages and potential drawbacks of direct and implicit schemes are also considered , with particular focus on problem timestepping which if not properly implemented can lead to morphologically plausible i - front behavior that nonetheless departs from theory . </S>",
    "<S> we also examine the effect of radiation pressure from very luminous central sources on the evolution of i - fronts and flows . </S>"
  ]
}