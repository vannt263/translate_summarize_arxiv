{
  "article_text": [
    "a _ permutation _ of size @xmath7 is a bijection from the set @xmath8 to itself .",
    "we represent a permutation @xmath0 of size @xmath7 by the sequence @xmath9 .",
    "we let @xmath10 denote the set of permutations of size  @xmath7 . when writing out short permutations explicitly , we usually omit the punctuation and write , e.g. , @xmath11 instead of @xmath12 .",
    "we let @xmath13 $ ] denote the set @xmath8 .",
    "we say that a permutation @xmath14 _ contains _ a permutation @xmath15 , which we denote by @xmath16 , if @xmath1 has a subsequence @xmath17 whose elements have the same relative order as the elements of @xmath0 , that is , for any @xmath18 $ ] we have @xmath19 if and only if @xmath20 .",
    "we call such a subsequence @xmath21 an _ occurrence _ of @xmath0 in  @xmath1 .",
    "if @xmath1 does not contain @xmath0 , we say that @xmath1 _ avoids _",
    "@xmath0 or that @xmath1 is _",
    "@xmath0-avoiding_.    in this paper , we study the computational complexity of determining for a given pair of permutations @xmath0 and @xmath1 whether @xmath1 contains  @xmath0 . in the literature , this problem is known as permutation pattern matching , or ppm .    in the context of ppm , the permutation @xmath0",
    "is usually called the _ pattern _ , and @xmath1 is called the _",
    "text_. when dealing with instances of ppm , we always assume that the pattern is at most as long as the text , that is , @xmath22 .    observe that ppm can be solved by a simple brute - force algorithm in time @xmath23 .",
    "thus , if the pattern @xmath0 were fixed , rather than being part of the input , the problem would trivially be polynomial - time solvable .",
    "bose , buss and lubiw  @xcite have shown that ppm is np - complete .",
    "this general hardness result has motivated the study of parameterized and restricted variants of ppm .",
    "guillemot and marx  @xcite have shown that ppm can be solved in time @xmath24 ; in particular , ppm is fixed - parameter tractable with @xmath25 considered as parameter .",
    "the complexity of the guillemot ",
    "marx algorithm was later reduced to @xmath26 by fox  @xcite .",
    "a different parameterization was considered by bruner and lackner  @xcite , who proved that ppm can be solved in time @xmath27 , where @xmath28 is the number of increasing and decreasing runs in  @xmath1 ; here an _ increasing run _ in @xmath29 is a maximal consecutive increasing subsequence of length at least @xmath30 , and decreasing runs are defined analogously .",
    "the bruner ",
    "lackner algorithm shows that ppm is fixed - parameter tractable with respect to the parameter  @xmath28 .",
    "moreover , since @xmath31 for any permutation @xmath32 , the bruner ",
    "lackner algorithm solves ppm in time @xmath33 .",
    "it is the first algorithm to improve upon the bound of @xmath34 achieved by the straightforward brute - force approach .",
    "another algorithm for ppm was described by albert , aldred , atkinson and holton  @xcite , and later a similar approach was analyzed by ahal and rabinovich  @xcite .",
    "ahal and rabinovich have proved that ppm can be solved in time @xmath35 , where @xmath36 is a graph that can be associated to the pattern @xmath0 , and @xmath37 denotes the treewidth of  @xmath36 .",
    "we shall give the precise definitions and the necessary details of this approach in section  [ sec - poly ] .",
    "apart from the above - mentioned algorithms , which all solve general ppm instances , various researchers have obtained efficient solutions for instances of ppm where @xmath0 or @xmath1 satisfy some additional restrictions .",
    "the most natural way to formalize such restrictions is to use the concept of permutation class , which we now introduce .",
    "a _ permutation class _ is a set @xmath3 of permutations with the property that for every @xmath38 , all the permutations contained in @xmath2 belong to @xmath3 as well .",
    "it is often convenient to describe a permutation class @xmath3 by specifying the minimal permutations not belonging to  @xmath3 . for a set of permutations @xmath39 ,",
    "we let @xmath40 denote the class of permutations that avoid all the permutations in  @xmath39",
    ". note that for any permutation class @xmath3 there is a unique ( possibly infinite ) antichain of permutations @xmath39 such that @xmath41 .",
    "the set @xmath39 is the _ basis _ of  @xmath3 .",
    "a _ principal permutation class _ is a permutation class whose basis has a single element .",
    "a _ proper permutation class _ is a permutation class whose basis is nonempty , or in other words , a permutation class that does not contain all permutations .",
    "for a recent overview of the structural theory of permutation classes , we refer the interested reader to the survey by vatter  @xcite .",
    "when dealing with specific sets @xmath39 , we often omit nested braces and write , e.g. , @xmath42 or @xmath43 , instead of @xmath44 or @xmath45 , respectively .    in this paper",
    ", we focus on the complexity of ppm when one or both of the inputs are restricted to a particular proper permutation class . following the terminology of albert et al .",
    "@xcite , we consider , for a permutation class  @xmath3 , these two restricted versions of ppm :    clearly , any instance of @xmath3-ppm is also an instance of @xmath3-pattern ppm , and in particular , @xmath3-ppm is at most as hard as @xmath3-pattern ppm .",
    "bose , buss and lubiw  @xcite have shown that @xmath3-pattern ppm is polynomially tractable when @xmath3 is the class @xmath46 of the so - called _",
    "separable permutations_. other algorithms for @xmath46-pattern ppm were given by ibarra  @xcite , by albert et al .",
    "@xcite , and by yugandhar and saxena  @xcite .",
    "an even more restricted case of @xmath3-pattern ppm deals with monotone increasing patterns , that is , @xmath47 . in this case",
    ", @xmath3-pattern ppm reduces to finding the longest increasing subsequence in a given text .",
    "this is an old algorithmic problem  @xcite , and can be solved in time @xmath48",
    "@xcite .",
    "a natural generalization is to consider instances of ppm where patterns and texts can be partitioned into a bounded number of monotone sequences . for integers @xmath49",
    ", we say that a permutation @xmath0 is an _ @xmath50-permutation _ if @xmath0 can be partitioned into @xmath51 increasing and @xmath52 decreasing ( possibly empty ) subsequences .",
    "we let @xmath53 denote the class of all @xmath50-permutations .",
    "in particular , @xmath54 , and more generally , @xmath55 .",
    "the @xmath56-permutations are also known as _ skew - merged permutations _ , and it is not hard to see that @xmath57 ; see atkinson  @xcite .",
    "k ' ezdy , snevily and wang  @xcite have shown that for any @xmath58 , the basis of the class @xmath53 is finite ; however , they also pointed out that the basis of @xmath59 has more than 100 permutations .",
    "guillemot and vialette  @xcite have shown that @xmath60-ppm is polynomial - time solvable .",
    "a different , faster algorithm for @xmath60-ppm has been described by albert et al .",
    "@xcite . by a similar approach , albert et al .",
    "@xcite have also obtained a polynomial algorithm for @xmath61-ppm .",
    "it was an open problem to determine whether there is any proper permutation class @xmath3 for which @xmath3-pattern ppm ( or even @xmath3-ppm ) is np - complete  @xcite .",
    "our first main result solves this problem .",
    "[ thm - main ] it is np - complete to decide , for a pattern @xmath62 and a text @xmath63 , whether @xmath0 is contained in  @xmath1 .    consequently , @xmath60-pattern ppm as well as @xmath64-ppm are np - complete .",
    "these results are tight in the sense that both @xmath65-pattern ppm and @xmath60-ppm are polynomial - time solvable , as mentioned above .",
    "we obtain similar results when @xmath60 and @xmath64 are replaced with @xmath61 and @xmath59 , respectively .",
    "in fact , here we can be even more restrictive .",
    "let @xmath66 be the class @xmath67 .",
    "[ thm - skew ] it is np - complete to decide , for a pattern @xmath68 and a text @xmath69 , whether @xmath0 is contained in  @xmath1 .",
    "this result again implies that @xmath66-pattern ppm and @xmath59-ppm are np - complete , in contrast with the polynomiality of @xmath65-pattern ppm , @xmath61-ppm and @xmath60-ppm .",
    "combining theorems  [ thm - main ] and  [ thm - skew ] with previously known polynomial cases of @xmath3-pattern ppm , we obtain a complexity dichotomy of @xmath3-pattern ppm for principal classes  @xmath3 .",
    "[ thm - principal ] let @xmath70 be a permutation .",
    "the problem @xmath71-pattern ppm is polynomial - time solvable for @xmath72 and np - complete for any other  @xmath70 .",
    "we also obtain new tractability results , which show that the np - hardness results for @xmath60-pattern ppm and @xmath66-pattern ppm are tight in an even stronger sense than suggested above .",
    "[ veta_polynomialni ] if @xmath3 is a proper subclass of @xmath60 then @xmath3-pattern ppm can be solved in polynomial time",
    ".    [ veta_polynomialni_skew ] if @xmath3 is a proper subclass of @xmath66 then @xmath3-pattern ppm can be solved in polynomial time .    in section  [ sec-321 ] ,",
    "we give the proof of theorem  [ thm - main ] .",
    "then , in section  [ sec - poly ] , we prove theorem  [ veta_polynomialni ] . in the subsequent section ,",
    "we explain how these proofs can be adapted to patterns from the class @xmath66 ( and texts from  @xmath59 ) , and deduce theorems [ thm - skew ] , [ thm - principal ] and  [ veta_polynomialni_skew ] .",
    "our goal is to show that for a pattern @xmath73 and a text @xmath63 , it is np - complete to decide whether @xmath0 is contained in @xmath1 . since the problem is clearly in np , we focus on proving its np - hardness .",
    "we take inspiration from the np - hardness proof given by bose , buss and lubiw  @xcite for general permutations and adapt it to the proper classes @xmath60 and @xmath64 .",
    "we proceed by reduction from the classical np - complete problem 3-sat , whose input is a 3-cnf formula @xmath74 , and the goal is to determine whether @xmath74 is satisfiable .",
    "we first introduce several auxiliary notions .",
    "let @xmath75 be a permutation of length  @xmath7 .",
    "for a pair of elements @xmath76 , we say that @xmath77 is _ above _ @xmath78 ( and @xmath78 is _ below _",
    "@xmath77 ) , if @xmath79 .",
    "likewise , @xmath77 is _ left _ of @xmath78 ( and @xmath78 is _ right _ of @xmath77 ) if @xmath80 . for disjoint sets",
    "@xmath81 we say that @xmath82 is _ above _ @xmath83 if every element of @xmath82 is above all the elements of  @xmath83 , and similarly for the other directions .",
    "if @xmath84 is a pair of elements of @xmath70 and @xmath85 is another element , we say that _",
    "@xmath85 is sandwiched by @xmath86 from below _",
    "if @xmath87 and @xmath85 is above @xmath86 ; see figure  [ fig - sandwich ] , left .",
    "similarly , we say that _",
    "@xmath85 is sandwiched by @xmath86 from the left _",
    "if @xmath88 and @xmath85 is to the right of  @xmath86 ; see figure  [ fig - sandwich ] , right .",
    "analogously , we also define sandwiching from the right or from above . more generally , a set @xmath89 of elements of @xmath70 is _ sandwiched from below by @xmath86 _ if each element of @xmath89 is sandwiched from below by  @xmath86 , and similarly for the other directions .",
    "a pair of elements @xmath90 is an _ increase _ in @xmath70 if @xmath80 and @xmath91 ; in other words , an increase is an occurrence of the permutation 12 in  @xmath70 .     sandwiched from below by a pair of elements @xmath84 .",
    "right : @xmath85 sandwiched from the left by @xmath86 . ]",
    "a _ staircase of @xmath25 steps _ is a sequence @xmath92 of @xmath93 disjoint increases @xmath94 with the following properties ( see figure  [ fig - stair ] ) :    * for every @xmath95 $ ] , @xmath96 is sandwiched by @xmath97 from the left , and for @xmath98 , @xmath97 is sandwiched by @xmath99 from below . * for every @xmath100 $ ] , @xmath101 is to the right and above @xmath102 , and @xmath103 is to the right and above @xmath96 .",
    "in particular , the elements of @xmath104 , as well as the elements @xmath105 form an increasing sequence of length  @xmath93 .",
    "we call @xmath97 the _ @xmath106th outer bend _ of @xmath92 , and @xmath96 the _ @xmath106th inner bend_. additionally , we call @xmath107 the _ base _ of @xmath92 and @xmath108 the _ top _ of  @xmath92 .        a _ double staircase _ of @xmath25 steps is a pair @xmath109 of disjoint staircases of @xmath25 steps , with @xmath110 and @xmath111 , satisfying the following properties ( see figure  [ fig - stairs ] ) :    * for each @xmath112 , the increase @xmath113 is above and to the right of @xmath96 , and also below ( and necessarily to the right of ) @xmath101 . for @xmath114 ,",
    "@xmath113 is also below and to the left of @xmath103 . * similarly , for @xmath112 , @xmath115 is above and to the right of @xmath97 , and also to the left ( and necessarily above ) @xmath96 . for @xmath114 , @xmath115 is below and to the left of @xmath101 .",
    "an _ @xmath116-fold staircase _ of @xmath25 steps is an @xmath116-tuple @xmath117 of staircases such that for each @xmath118 $ ] with @xmath80 , the pair @xmath119 is a double staircase of @xmath25 steps .",
    "the _ @xmath106th inner bend of @xmath92 _ is the union of the @xmath106th inner bends of the staircases @xmath120 ; the outer bends , the base and the top of @xmath92 are defined analogously .",
    "-fold staircase of two steps . ]",
    "notice that an @xmath116-fold staircase avoids the pattern @xmath121 .",
    "moreover , the union of its outer bends , as well as the union of its inner bends each form an increasing subsequence .",
    "we now describe the reduction from 3-sat .",
    "let @xmath74 be a given 3-cnf formula .",
    "suppose that @xmath74 has @xmath122 variables @xmath123 and @xmath124 clauses @xmath125 .",
    "we will assume , without loss of generality , that each clause contains exactly three literals , and no variable appears in a single clause more than once .",
    "we will construct two permutations @xmath126 and @xmath127 , such that @xmath74 is satisfiable if and only if @xmath1 contains  @xmath0 .",
    "the overall structure of @xmath0 and @xmath1 is depicted in figure  [ fig - overview ] .",
    "( left ) and  @xmath1 ( right ) . ]",
    "the pattern @xmath0 is the disjoint union of a @xmath122-fold staircase @xmath128 of @xmath129 steps with an increasing sequence @xmath89 ( called the _ anchor _ of @xmath0 ) of length @xmath130 , where @xmath130 is a sufficiently large value to be specified later .",
    "moreover , the sequence @xmath89 is below @xmath82 , to the right of the base of @xmath82 , and to the left of the first inner bend of  @xmath82 .",
    "this determines @xmath0 uniquely up to the value of @xmath130 , and we may observe that @xmath0 avoids  @xmath121 .",
    "we will say that the staircase @xmath131 _ represents _ the variable @xmath132 of  @xmath74 .",
    "we now describe the text @xmath1 . as a starting point",
    ", we first build a permutation @xmath133 and then explain how to modify @xmath133 to obtain  @xmath1 .",
    "the permutation @xmath133 is the disjoint union of a @xmath134-fold staircase @xmath135 of @xmath129 steps , and an increasing sequence @xmath136 ( the _ anchor _ of @xmath133 ) of length  @xmath130 .",
    "the sequence @xmath136 is below the @xmath134-fold staircase , to the right of the base of @xmath83 , and to the left of the first outer bend of  @xmath83 .",
    "each of the @xmath134 staircases in @xmath83 will represent one of the @xmath134 possible literals , with @xmath137 representing the literal @xmath132 and @xmath138 representing @xmath139 .",
    "we now modify @xmath133 to obtain the actual text  @xmath1 .",
    "the modification proceeds in two steps .    in the first step ,",
    "we change the relative position of the bases of the individual staircases in  @xmath83 . for every @xmath140 ,",
    "let @xmath141 and @xmath142 be the respective bases of @xmath137 and @xmath138 . in @xmath133 ,",
    "the two bases together form an occurrence of @xmath143 .",
    "we modify their relative horizontal position by moving @xmath141 to the right of @xmath142 , so that in @xmath1 the two bases will form an occurrence of @xmath144 .",
    "the relative position of @xmath141 and @xmath142 to the remaining elements remains unchanged ; in other words , the four elements of @xmath145 occupy the same four rows and the same four columns as before .    before we describe the second step of the construction of @xmath1",
    ", we introduce the following notion : suppose @xmath146 is a staircase of @xmath25 steps , and let @xmath97 , @xmath96 and @xmath101 be three consecutive bends of @xmath92 , with @xmath98 . a _ bypass _ of @xmath147 in @xmath92",
    "is a sequence of three increases @xmath148 disjoint from @xmath92 and satisfying these properties :    * the sequence @xmath149 obtained from @xmath92 by replacing @xmath97 with @xmath115 , @xmath96 with @xmath113 and @xmath101 with @xmath150 is again a staircase with @xmath25 steps , and * @xmath97 is above and to the left of @xmath115 , @xmath96 is above and to the right of @xmath113 , and @xmath150 is sandwiched by @xmath101 from the right ( see figure  [ fig - bypass ] ) .",
    "note that these conditions determine the relative positions of the elements of @xmath151 uniquely .",
    "we call the pair @xmath152 the _ fork _ of the bypass , and the pair @xmath153 the _ merge _ of the bypass .",
    "[ lem - bypass ] let @xmath146 be a staircase of @xmath25 steps , let @xmath154 be arbitrary , and let @xmath149 be obtained from @xmath92 by replacing the three bends @xmath147 with a bypass @xmath148 .",
    "let @xmath155 be a staircase of @xmath25 steps such that @xmath156 , and moreover , each of the @xmath157 elements of @xmath158 also belongs to @xmath151 .",
    "then the sequence of bends @xmath159 is equal either to @xmath160 or to @xmath161 .    by assumption , @xmath162 .",
    "there are four elements of @xmath151 ( namely @xmath163 ) sandwiched from below by @xmath164 , and two of them must form @xmath165 . however , since @xmath97 and @xmath115 are the only two increases in @xmath163 , we have either @xmath166 or @xmath167 . in either case",
    ", there is a unique increase sandwiched by @xmath165 from the left , and this increase must therefore be @xmath168 , and by the same argument , both @xmath169 and @xmath170 are determined uniquely .",
    "the lemma follows .",
    "we continue by the second step of the construction of the text  @xmath1 .",
    "the general approach is to modify certain parts of the staircases by adding bypasses whose structure depends on the clauses of the formula  @xmath74 .",
    "recall that @xmath74 has @xmath124 clauses @xmath125 , and that the @xmath134-fold staircase @xmath83 has @xmath129 steps .",
    "let @xmath171 and @xmath172 denote the @xmath116th outer bend and the @xmath116th inner bend of  @xmath83 , respectively .",
    "for every @xmath173 $ ] , we will associate to the clause @xmath174 the sequence of three bends @xmath175 of  @xmath83 .",
    "let @xmath174 be a clause of @xmath74 of the form @xmath176 , with @xmath177 , @xmath178 , and @xmath179 , for some @xmath180 .",
    "let @xmath181 denote the staircase representing the literal @xmath182 , and let @xmath183 be the staircase representing the other literal containing  @xmath132 .",
    "we define @xmath184 , @xmath185 , @xmath186 and @xmath187 analogously .",
    "we will now add bypasses to ( some of ) the staircases @xmath188 into the three bends associated to @xmath174 , by inserting new bends into @xmath189 , @xmath190 and @xmath191 , and sometimes changing the relative position of existing bends .",
    "the choice of the relative positions of these bends is the key aspect of our reduction .    .",
    "each light square indicates the positions of two bends on the two staircases representing a variable other than @xmath132 , @xmath192 and @xmath193 .",
    "each dark square indicates the position of one bend on a staircase representing one of the literals @xmath194 . ]",
    "we first describe how to modify @xmath189",
    ". we will replace @xmath189 by a so called _ fork gadget _",
    "@xmath195 containing the @xmath196th outer bends of all the staircases @xmath138 and @xmath137 and also the corresponding bends of their bypasses , if any .",
    "the gadget @xmath195 is a union of three disjoint increasing sequences , which we call the _ top level _",
    ", the _ middle level _ and the _ bottom level _ ; see figure  [ fig - gadget ] . as the names suggest , the top level is above the middle one , and the middle one is above the bottom one .",
    "the top level contains , in left - to - right order , the bend of @xmath185 , the bends of @xmath197 , followed by the bend of @xmath186 , and finally the bends of @xmath198 .",
    "the middle level contains , left to right , the bends of @xmath199 , the bypasses of @xmath200 , and finally the bend of  @xmath187 .",
    "the bottom level contains the bends of @xmath201 , the bypasses of @xmath202 , and the bypass of  @xmath185 .",
    "note that @xmath195 does not contain the permutation @xmath121 : indeed , any occurrence of @xmath121 would have to intersect all three levels , since each level is an increasing sequence .",
    "however , the only elements of the top level that have any element of the bottom level to the right of them are the two elements of the bend of  @xmath185 , and neither of these two elements belongs to an occurrence of @xmath121 .    we then replace the inner bend @xmath190 by a single increasing sequence @xmath203 containing the first inner bend of all the staircases and bypasses emerging from @xmath195 . note that the vertical position of these staircases is already determined by  @xmath195 .",
    "finally , we replace @xmath191 by a _ merge gadget _ @xmath204 , in which all the bypasses that forked in @xmath195 will be merged .",
    "note that the horizontal relative position of the bends in @xmath204 is determined uniquely by @xmath203 , while their relative vertical position is fixed by  @xmath205 .",
    "essentially , @xmath204 is similar to a transpose of @xmath195 along the north - east diagonal , except that a fork of a bypass forms an occurrence of @xmath144 in @xmath195 , whereas the corresponding merge forms an occurrence of @xmath206 in  @xmath204 .",
    "in particular , we may again see that @xmath204 is @xmath121-free .    performing the above - described modifications for each @xmath207",
    ", we obtain the text  @xmath1 .",
    "we let @xmath208 denote the part of @xmath1 that was obtained by replacing the bends of @xmath83 by the corresponding gadgets ; in other words , @xmath208 contains all the elements of @xmath1 except the anchor .",
    "we let @xmath209 ( or @xmath210 ) denote the subpermutation obtained as the union of @xmath137 ( or @xmath138 ) and all the bypasses added to it .",
    "it remains to determine the value of @xmath130 , i.e. , the length of the anchors of @xmath0 and  @xmath1 .",
    "we choose @xmath130 to be equal to @xmath211 , that is , the elements of the anchor @xmath136 will outnumber the remainder of  @xmath1 .",
    "we now verify that the construction has the desired properties .",
    "[ pro - correct ] let the formula @xmath74 , pattern @xmath0 and text @xmath1 be as described in the previous subsection",
    ". then @xmath74 is satisfiable if and only if @xmath1 contains  @xmath0 .",
    "suppose that @xmath74 is satisfiable .",
    "fix any satisfying assignment , and represent it by a function @xmath212 , where @xmath213 if and only if the variable @xmath132 is true in the chosen satisfying assignment .",
    "we obtain a copy of @xmath0 in @xmath1 as follows .",
    "the elements of the anchor @xmath89 of @xmath0 will be mapped to the anchor @xmath136 of  @xmath1 .",
    "it remains to map the @xmath122-fold staircase @xmath214 to @xmath208 .",
    "we will show that it is possible to map each @xmath131 into @xmath215 .",
    "to obtain such a mapping , we need to decide , for every bypass appearing in @xmath215 , whether to map @xmath131 to the bends of the bypass or to the bends of @xmath216 .",
    "the decision can be made for each bypass independently , but we need to make sure that for each gadget @xmath217 in @xmath208 , the bends mapped into @xmath217 will form an increasing sequence .",
    "it can be verified by a routine case analysis that such a choice is always possible . to see this ,",
    "suppose that @xmath174 is a clause @xmath218 whose literals contain variables @xmath132 , @xmath192 and @xmath193 , respectively , with @xmath180 .",
    "assume for instance , that the assignment @xmath219 satisfies @xmath182 but not @xmath220 and @xmath221 .",
    "then the @xmath196th outer bends of @xmath131 , @xmath222 and @xmath223 must be mapped to the bends of @xmath224 , @xmath225 and @xmath226 in @xmath195 .",
    "the bends of @xmath224 and @xmath226 are unique , and to preserve monotonicity , we need to choose the bend of @xmath225 in the bottom level of @xmath195 , i.e. , the bypass of @xmath185 . then all the staircases @xmath227 may be mapped to bends in the bottom level of @xmath195 , while @xmath228 may be mapped to bends in the middle level , preserving monotonicity .",
    "notice that the position of the bends in @xmath204 is the transpose along the north - east diagonal of their position in @xmath195 , and in particular , the bends will form an increasing sequence in @xmath204 as well .",
    "we conclude that if @xmath219 is a satisfying assignment of @xmath74 , then @xmath0 occurs in  @xmath1 . for",
    "the converse , suppose that @xmath0 has an occurrence in  @xmath1 .",
    "since the anchor @xmath89 of @xmath0 is longer than @xmath208 , at least one element of @xmath89 must be mapped to an element of  @xmath136 . in particular , all the elements to the left and above @xmath89 are mapped to elements to the left and above  @xmath136 . in other words , the base of @xmath82",
    "gets mapped to a subset of the base of  @xmath208 .",
    "recall that the base of @xmath208 is an increasing sequence of @xmath122 blocks of size @xmath229 , where the @xmath106th block is the union of the base @xmath141 of @xmath209 with the base @xmath142 of @xmath210 .",
    "recall also , that each of these @xmath122 blocks is order isomorphic to @xmath144 , and in particular , the longest increasing subsequence of each block has size @xmath30 , and there are exactly two such subsequences , namely @xmath141 and  @xmath142 .",
    "this implies that any increasing subsequence of length @xmath134 of the base of @xmath208 contains exactly one of @xmath141 and  @xmath142 for each  @xmath106 . in particular , in an occurrence of @xmath0 in @xmath1 , the base of @xmath131",
    "is mapped either to @xmath141 or to @xmath142 .",
    "fix an occurrence of @xmath0 in @xmath1 and use it to define a truth assignment @xmath230\\to\\{\\text{t},\\text{f}\\}$ ] , so that the base of @xmath131 is mapped to  @xmath231 .",
    "we claim that the assignment @xmath219 satisfies  @xmath74 . to see this",
    ", we first argue that for every @xmath232 $ ] , the elements of @xmath131 are mapped to elements of @xmath215 , and more specifically , each ( inner or outer ) bend on @xmath131 is mapped either to the corresponding bend of @xmath216 or to the corresponding bend of a bypass of  @xmath216 .",
    "we have already seen that this is the case for the base of  @xmath131 . to show that it holds for the remaining bends also",
    ", we may proceed by induction and simply note that the only elements sandwiched from below by an inner bend in @xmath215 are the elements of the subsequent outer bend of @xmath215 , or perhaps a pair of outer bends forming the fork of a bypass .",
    "an analogous property holds for outer bends as well . using lemma  [ lem - bypass ]",
    ", we may then conclude that the bends of @xmath131 map to corresponding bends in  @xmath215 .    to see that @xmath219 is satisfying ,",
    "assume for contradiction that there is a clause @xmath174 whose literals involve the variables @xmath233 and @xmath193 , and neither of these literals is satisfied by  @xmath219 .",
    "it follows that inside the gadget @xmath195 , the bends of @xmath131 , @xmath222 and @xmath223 must map to the bends of @xmath234 , @xmath225 and @xmath226",
    ". however , no three such bends form an increasing sequence in @xmath195 , whereas the corresponding bends form an increasing sequence in  @xmath0 .",
    "this contradiction completes the proof of the proposition .    clearly , the problem is in the class np .",
    "it is easy to observe that in our reduction , @xmath0 belongs to @xmath60 . to see that @xmath1 belongs to @xmath64",
    ", it suffices to note that the gadgets @xmath217 used in the construction of @xmath1 all avoid @xmath121 , and that the base of @xmath208 avoids @xmath121 as well .",
    "note also that the base of @xmath208 is to the left and below all the gadgets  @xmath217 .",
    "clearly , @xmath0 and @xmath1 can be constructed from @xmath74 in polynomial time , and the correctness of the reduction follows from proposition  [ pro - correct ] .",
    "in this section we prove theorem  [ veta_polynomialni ] . we rely on a result by ahal and rabinovich  @xcite , who showed that for patterns with bounded `` treewidth '' ,",
    "the ppm problem can be solved in polynomial time .",
    "our main contribution is in showing that patterns in @xmath42 of large `` treewidth '' contain a large universal pattern , containing all patterns in @xmath42 of a given size . to show this",
    ", we use the grid minor theorem by robertson and seymour  @xcite .",
    "the following definition was introduced by ahal and rabinovich  ( * ? ? ?",
    "* definition 2.3 ) . for a @xmath25-permutation @xmath0 ,",
    "a graph @xmath235 is defined as follows ; see figure  [ obr_g_pi ] .",
    "the vertices of @xmath235 are the numbers @xmath236 , interpreted as the elements of @xmath237 .",
    "two vertices @xmath238 are connected by an edge if @xmath239 or @xmath240 .",
    "we say that an edge between @xmath241 and @xmath242 is _ red _ if @xmath240 , and it is _ blue _ if @xmath239 .",
    "note that an edge can be both red and blue . clearly , the edges of each color form a hamiltonian path in  @xmath235 .",
    "we note that in our definition , @xmath235 is a graph , whereas ahal and rabinovich  @xcite defined @xmath235 as a multigraph . also , we label the vertices of @xmath235 by their value rather than position in  @xmath0 .     and the graph @xmath235 . ]",
    "let @xmath243 be the treewidth of a graph @xmath244 .",
    "the main result of ahal and rabinovich  @xcite can be stated in the following form .",
    "[ veta_o_omezene_sirce ] for @xmath245 and @xmath32 , the problem whether @xmath0 is contained in @xmath1 can be solved in time @xmath246 .",
    "the _ @xmath247 grid _ is the graph with vertex set @xmath248\\times [ r]$ ] where vertices @xmath249 and @xmath250 are joined by an edge if and only if @xmath251 .",
    "see figure  [ obr_grid_wall ] , left .",
    "robertson and seymour  @xcite proved that for every @xmath51 , every graph of sufficiently large treewidth contains the @xmath247 grid as a minor .",
    "recently , chekuri and chuzhoy  @xcite showed that a treewidth polynomial in @xmath51 is sufficient .",
    "the upper bound has been further improved by chuzhoy  @xcite .",
    "[ veta_grid ] there is a function @xmath252 satisfying @xmath253 such that every graph of treewidth at least @xmath254 contains the @xmath247 grid as a minor .     grid .",
    "right : an elementary wall of height @xmath229 . ]    since grids have vertices of degree @xmath229 , it is more convenient to consider their subgraphs of maximum degree @xmath255 , called walls .",
    "let @xmath256 be even .",
    "an _ elementary wall of height @xmath51 _",
    "@xcite is obtained from the @xmath257 grid by removing two opposite corners @xmath258 and @xmath259 , edges @xmath260 for @xmath106 odd and @xmath261 , and edges @xmath262 for @xmath106 even and @xmath261 . that is , an elementary wall of height @xmath51 is a planar graph of maximum degree @xmath255 , which can be drawn as a `` wall '' with @xmath51 rows of @xmath51 `` bricks '' , where each `` brick '' is a face of size @xmath263 .",
    "see figure  [ obr_grid_wall ] , right .",
    "a subdivision of an elementary wall of height @xmath51 is called a _ wall of height @xmath51 _ or simply an _",
    "@xmath51-wall_. it is well known that if @xmath264 is a graph of maximum degree @xmath255 , then a graph @xmath244 contains @xmath264 as a minor if and only if @xmath244 contains a subdivision of @xmath264 as a subgraph .",
    "therefore , a graph containing the @xmath265 grid as a minor also contains an @xmath51-wall as a subgraph .",
    "let @xmath266 be a finite sequence of @xmath7 distinct positive integers .",
    "the _ reduction _ of @xmath266 is an @xmath7-permutation obtained from @xmath266 by replacing the @xmath106th smallest element by @xmath106 , for every @xmath267 $ ] .    for every @xmath268",
    ", we define the _ @xmath25-track _ as the @xmath269-permutation that is the reduction of the sequence @xmath270 if @xmath25 is even , and the reduction of @xmath271 if @xmath25 is odd .",
    "see figure  [ obr_k_track ] .",
    "the @xmath25-track clearly avoids @xmath121 since it is a union of two increasing sequences . in lemma  [ lemma_ktrack ]",
    "we will show that the @xmath25-track is a universal pattern for all 321-avoiding @xmath25-permutations .",
    "-track and its stair - decomposition . ]",
    "we use the stair - decomposition of @xmath121-avoiding permutations introduced by guillemot and vialette  @xcite and independently , in a slightly different way , by albert et al .",
    "let @xmath272 be a @xmath25-permutation .",
    "stair - decomposition _ of @xmath0 is a partition of @xmath273 $ ] , regarded as the set of elements of @xmath0 , into possibly empty subsets @xmath274 , for some @xmath116 , such that    * each @xmath275 forms an increasing subsequence in @xmath0 , * @xmath276 is above @xmath277 for each @xmath278 , * @xmath279 is to the right of @xmath276 for each @xmath280 , and * @xmath281 is above and to the right of @xmath275 for each @xmath282 .",
    "the subsets @xmath275 are called the _ blocks _ of the stair - decomposition .",
    "sometimes it will be convenient to refer to blocks @xmath283 or @xmath284 , which we define as empty sets .",
    "the @xmath25-track has a stair - decomposition into @xmath25 blocks @xmath285 , each containing exactly @xmath25 elements ; see figure  [ obr_k_track ] .",
    "moreover , for every @xmath286 , the subset @xmath287 forms a _ vertical alternation _ in the @xmath25-track , that is , @xmath288 is above @xmath289 and the elements from @xmath289 alternate from left to right with the elements from @xmath288 in the @xmath25-track .",
    "similarly , for every @xmath290 , the subset @xmath291 forms a _ horizontal alternation _ in the @xmath25-track , that is , @xmath292 is to the right of @xmath288 and the elements of @xmath288 alternate from bottom to top with the elements of @xmath292 in the @xmath25-track .",
    "guillemot and vialette  @xcite state the following lemma without proof .",
    "albert et al .  @xcite",
    "give an algorithm to compute the stair - decomposition but do not include verification of correctness .",
    "[ lemma_ex_stair_dec ] every @xmath121-avoiding @xmath25-permutation has a stair - decomposition with at most @xmath25 blocks .",
    "let @xmath272 be a @xmath25-permutation .",
    "we define a stair - decomposition of @xmath0 by a greedy algorithm .",
    "let @xmath293 be the longest interval @xmath294 $ ] whose elements form an increasing subsequence in @xmath0 .",
    "let @xmath295 be the subsequence of @xmath296 formed by the elements in @xmath273   \\setminus b_1 $ ] .",
    "now let @xmath297 be the subset of @xmath273 \\setminus b_1 $ ] whose elements form the maximal increasing prefix of @xmath295 .",
    "let @xmath298 be the subsequence of @xmath295 obtained by removing the elements of @xmath297 .",
    "we continue analogously .",
    "suppose that @xmath299 and @xmath300 have been defined .",
    "then let @xmath279 be the maximal down - set of @xmath273\\setminus   \\bigcup_{j=1}^{2i } b_j$ ] forming an increasing subsequence in @xmath299 , and let @xmath301 be the subsequence of @xmath299 obtained by removing the elements of @xmath279 .",
    "finally , let @xmath302 be the subset of @xmath273 \\setminus   \\bigcup_{j=1}^{2i+1 } b_j$ ] whose elements form the maximal increasing prefix of @xmath301 , and let @xmath303 be the subsequence of @xmath301 obtained by removing the elements of @xmath302 .",
    "we continue until @xmath299 or @xmath301 is empty and we denote by @xmath116 the largest index such that @xmath304 is nonempty .",
    "clearly @xmath305 .",
    "now we verify that @xmath306 is indeed a stair - decomposition of @xmath0 .",
    "the facts that @xmath276 and @xmath279 are above @xmath277 , and that @xmath302 and @xmath279 are to the right of @xmath276 for every @xmath106 follow directly from the construction .    for every @xmath106 , the block @xmath279 is to the right of @xmath277 since the set of elements above and to the left of @xmath307 forms an increasing subsequence in @xmath308 ; a decreasing pair would form a forbidden pattern 321 with @xmath307 . finally , for every @xmath106",
    ", the block @xmath302 is above @xmath276 since the set of elements below and to the right of @xmath309 forms an increasing subsequence in @xmath310 ; a decreasing pair would induce a forbidden pattern 321 with @xmath309 .",
    "albert et al .",
    "* proposition 6 ) proved that each 321-avoiding permutation of size @xmath25 is contained in an @xmath116-track for some @xmath311 .",
    "using similar ideas , we observe the following stronger fact .    [ lemma_ktrack ] let @xmath272 be a @xmath25-permutation , and let @xmath312 be its stair - decomposition .",
    "let @xmath313 .",
    "let @xmath314 be the @xmath315-track , and let @xmath316 be its stair - decomposition into blocks of size  @xmath315",
    ". then @xmath0 has an occurrence in @xmath314 in which the elements of @xmath275 are mapped into @xmath317 for every @xmath318 .    for @xmath319",
    "the claim is trivial , so we assume that @xmath320 .    for @xmath278 ,",
    "let @xmath321 be the left - to - right linear order of the elements from @xmath322 in @xmath0 .",
    "similarly , for @xmath280 , let @xmath323 be the bottom - to - top linear order of the elements from @xmath324 in @xmath0 ( that is , @xmath323 is the restriction of the standard linear order @xmath325 of the integers ) .",
    "we claim that there is a linear order @xmath326 on @xmath273 $ ] that simultaneously extends all the orders @xmath327 .",
    "we show this by induction on @xmath116 . for @xmath328 we can take @xmath326 as @xmath329 .",
    "now let @xmath330 and assume that there is a linear order @xmath331 extending the union @xmath332 .",
    "this implies that there is an injective function @xmath333\\setminus b_m \\rightarrow \\mathbb{r}$ ] satisfying @xmath334 . since @xmath335 and @xmath336 intersect at a linear order on @xmath337 , which is a restriction of both @xmath325 and @xmath331",
    ", we have @xmath338 for every @xmath339 .",
    "clearly , we can extend the function @xmath340 to the elements of @xmath304 so that @xmath341 for every @xmath342 .",
    "the order @xmath326 can now be defined as @xmath343 for all @xmath18 $ ] .    with the order @xmath326 at hand",
    ", we define an embedding of @xmath0 to the @xmath315-track as follows .",
    "let @xmath344 be the permutation of @xmath273 $ ] satisfying @xmath345 .",
    "similarly , for every @xmath346 $ ] , let @xmath347 be the permutation of @xmath317 satisfying @xmath348 . for every @xmath349 $ ] ,",
    "let @xmath350 be the index such that @xmath351 .",
    "then the map sending @xmath352 to @xmath353 , for each @xmath349 $ ] , is an embedding of @xmath0 to the @xmath315-track .      using the results from previous subsections ,",
    "theorem  [ veta_polynomialni ] will follow from the following theorem .",
    "[ theorem_hledani_ktracku ] there is a function @xmath354 satisfying @xmath355 with the following property . if @xmath272 is a permutation such that @xmath235 contains a @xmath356-wall , then @xmath0 contains the @xmath25-track .    we will need the following lemma providing an upper bound on the treewidth of @xmath357 for @xmath121-avoiding permutations @xmath5 .    [ lemma_tw_blocks ]",
    "if @xmath358 has a stair - decomposition with @xmath116 blocks , then the treewidth of @xmath357 is at most @xmath359 .",
    "we show that , in fact , the pathwidth of @xmath357 is at most @xmath359 .",
    "kinnersley  @xcite proved that the pathwidth of a graph @xmath244 is equal to the _ vertex separation number _ of @xmath244 , @xmath360 , defined as follows . if @xmath244 is a graph @xmath244 with @xmath7 vertices",
    ", @xmath361 is a linear ordering of the vertices and @xmath267 $ ] , let @xmath362 be the set of vertices @xmath363 such that @xmath364 and @xmath244 has an edge @xmath365 with @xmath366 .",
    "then let @xmath367    let @xmath358 be an @xmath7-permutation that has a stair - decomposition with blocks @xmath368 .",
    "let @xmath369 be the linear ordering of the elements of @xmath5 defined in the proof of lemma  [ lemma_ktrack ] .",
    "we claim that for each @xmath267 $ ] we have @xmath370 .",
    "the graph @xmath357 is a union of two hamiltonian paths , the _ blue _ path @xmath371 formed by the blue edges and the _ red _ path @xmath372 formed by the red edges .",
    "the blue path can be decomposed into @xmath373 @xmath369-increasing paths induced by the subsets @xmath374 and @xmath375 remaining blue edges .",
    "similarly , the red path can be decomposed into @xmath376 @xmath369-increasing paths induced by the subsets @xmath377 and @xmath378 remaining red edges .",
    "all together , @xmath357 has a decomposition into @xmath359 @xmath369-monotone paths , and each such path contributes at most one vertex to each @xmath379 .",
    "let @xmath272 be a permutation with a stair - decomposition @xmath380 .",
    "let @xmath381 be an edge of @xmath235 such that @xmath382 , @xmath383 and @xmath384 .",
    "we say that @xmath381 is _ good _ if at least one of the following conditions is satisfied :    * @xmath385 , * @xmath381 is blue , @xmath106 is odd and @xmath386 , or * @xmath381 is red , @xmath106 is even and @xmath386 .",
    "otherwise @xmath381 is _",
    "bad_.    we introduce the following notation : if @xmath387 is a sequence of sets and @xmath388 $ ] an integer , then @xmath389 denotes the set @xmath390 . the sets",
    "@xmath391 , @xmath392 and @xmath393 are defined analogously .",
    "[ lemma_bad_edges ] let @xmath272 be a permutation with a stair - decomposition @xmath306",
    ". then    1 .",
    "@xmath235 has at most @xmath394 bad edges , 2 .   for each @xmath395 $ ]",
    "there is at most one vertex @xmath382 incident to a bad edge @xmath381 with @xmath396 , and 3 .   for each @xmath395 $ ]",
    "there is at most one vertex @xmath382 incident to a bad edge @xmath397 with @xmath398 .",
    "if @xmath381 is a bad edge with @xmath382 and @xmath396 , then @xmath399 must be the topmost ( or equivalently rightmost ) vertex of  @xmath275 .",
    "this shows part 2 ) , and part 3 ) is analogous .    for part 1 ) , we observe that every bad blue edge starts at the rightmost vertex of some pair of blocks @xmath400 , and for each such pair with @xmath401 there is at most one such edge .",
    "similarly , every bad red edge starts at the topmost vertex of some pair of blocks @xmath402 , and for each such pair with @xmath403 there is at most one such edge .",
    "the following lemma is the first step towards the proof of theorem  [ theorem_hledani_ktracku ] .",
    "the goal is to find `` many '' vertex - disjoint paths in @xmath235 between two `` distant '' blocks of the stair - decomposition .",
    "[ lem - graf ] let @xmath25 be an integer .",
    "let @xmath244 be a graph whose vertex set is partitioned into a sequence of ( possibly empty ) sets @xmath404 , such that for every @xmath405 $ ] the subgraph of @xmath244 induced by the set @xmath406 has treewidth less than  @xmath407 . if @xmath244 contains an @xmath51-wall for some @xmath408 , then there is an integer @xmath409 such that @xmath244 contains @xmath407 vertex - disjoint paths connecting the set @xmath410 to the set @xmath411 .",
    "define @xmath412 and @xmath413 .",
    "we will show that @xmath244 contains @xmath414 vertex - disjoint paths satisfying the properties of the lemma .",
    "let @xmath415 be an @xmath51-wall in  @xmath244",
    ".    for each @xmath416 $ ] , define a @xmath315-wall @xmath417 as a subgraph of @xmath415 , so that the walls @xmath417 are arranged roughly in an @xmath418 lattice , every pair of these @xmath315-walls is separated by at least @xmath419 bricks of @xmath415 , and each @xmath417 is separated by at least @xmath420 bricks from the boundary of @xmath415 .",
    "this is possible as @xmath421 .",
    "let @xmath422 be the set of indices @xmath423 such that @xmath417 intersects  @xmath424 .",
    "since every @xmath315-wall contains the @xmath425 grid as a minor , its treewidth is at least @xmath412 . by the assumption , the @xmath315-wall is not contained in any union of @xmath25 consecutive blocks  @xmath424 , and in particular",
    ", the minimum and the maximum of @xmath422 differ by at least  @xmath25 .",
    "let @xmath426 be the median of @xmath422 .",
    "let @xmath130 be the median of the multiset @xmath427\\}$ ] .",
    "let @xmath428 and @xmath429 .",
    "the numbers @xmath430 are chosen so that every set @xmath422 with @xmath431 contains a number @xmath432 and every set @xmath422 with @xmath433 contains a number @xmath434 . let @xmath435 ^ 2 $ ] be sets of size @xmath436 forming a partition of @xmath437 ^ 2 $ ] such that @xmath431 if @xmath438 and @xmath433 if @xmath439 .",
    "from every @xmath315-wall @xmath417 such that @xmath438 , choose a vertex @xmath440 .",
    "similarly , from every @xmath315-wall @xmath417 such that @xmath439 , choose a vertex @xmath441 .",
    "let @xmath442 be a relabeling of the vertices @xmath443 corresponding to the lexicographic order of the pairs @xmath444 .",
    "we claim that there is a relabeling @xmath445 of the vertices @xmath446 and @xmath436 vertex - disjoint paths @xmath447 in @xmath415 where each @xmath448 starts at @xmath449 and ends at @xmath450 .",
    "we note that with a stronger assumption on the distances between the subwalls @xmath417 , a more general result by robertson and seymour  @xcite would imply the existence of such paths for any relabeling of the vertices @xmath446 .",
    "we choose the relabeling @xmath445 of the vertices @xmath446 so that it again corresponds to the lexicographic order of the pairs @xmath444 .",
    "we construct the paths as follows ; see figure  [ obr_wallpath ] .",
    "let @xmath451 $ ] and let @xmath452 $ ] be such that @xmath453 and @xmath454 .",
    "the path @xmath448 is composed from nine horizontal or nearly vertical subpaths @xmath455 . here by a _ nearly vertical _ path in @xmath415 going upwards ( downwards ) we mean a path consisting of subpaths between branching vertices of @xmath415 with internal vertices of degree @xmath30 , where the directions of the subpaths periodically alternate as up , right , up , left ( down , right , down , left , respectively ) .",
    "the path @xmath456 starts at @xmath449 and goes up or to the right to the closest branching vertex in @xmath415 .",
    "the path @xmath457 continues directly to the right to the @xmath458th branching vertex outside of @xmath417 .",
    "the path @xmath459 is nearly vertical continuing upwards to the @xmath196th row of @xmath415 , and it is followed by a horizontal path @xmath460 ending at the @xmath196th branching vertex from the right of @xmath415 . then @xmath461 is nearly vertical continuing downwards , to the @xmath196th row from the bottom of @xmath415 .     and @xmath462 for @xmath463 . ]",
    "the remaining subpaths of @xmath448 are defined symmetrically .",
    "starting at @xmath450 , the path @xmath464 goes down or to the left to the closest branching vertex , followed by @xmath465 that goes directly to the left to the @xmath466th branching vertex outside of @xmath467 .",
    "then @xmath468 is nearly vertical continuing downwards to the @xmath196th row of @xmath415 from the bottom , and @xmath469 continues directly to the right to the @xmath196th branching vertex from the right , which is also the endpoint of @xmath461 .",
    "since all the paths connect the set @xmath470 to the set @xmath471 with @xmath472 , the lemma follows .",
    "the next lemma shows how to find the @xmath25-track in @xmath36 , given many vertex disjoint paths between two distant blocks of the stair - decomposition .",
    "[ lem - good - paths ] let @xmath272 be a permutation with a stair - decomposition @xmath306 .",
    "suppose that there is an odd index @xmath473 $ ] such that the subgraph of @xmath36 induced by @xmath474 contains @xmath475 vertex - disjoint paths @xmath476 , each of them connecting a vertex in @xmath477 to a vertex in @xmath478 , and each of them containing only good edges .",
    "then @xmath0 contains the @xmath25-track @xmath479 , and moreover , it has an occurrence of @xmath479 in which the elements from the @xmath480th block of @xmath479 are mapped into @xmath481 .",
    "truncating the paths @xmath482 if necessary , we may assume that each of them has exactly one vertex in @xmath477 and exactly one vertex in @xmath478 .",
    "suppose without loss of generality that the paths are numbered in such a way that the endpoint of @xmath483 in @xmath477 is to the left of the endpoint of @xmath484 in @xmath477 for every  @xmath485 $ ] .",
    "for every @xmath486 $ ] , let @xmath487 be the last vertex on @xmath488 that lies in @xmath489 .",
    "let @xmath2 be the pattern formed by these @xmath269 elements @xmath487 in @xmath0 .",
    "we claim that @xmath2 is the @xmath25-track .",
    "clearly , the sets @xmath490 induce a stair decomposition of @xmath2 , with each block having exactly @xmath25 elements .",
    "it remains to verify that consecutive blocks induce vertical or horizontal alternations in  @xmath2 .",
    "more precisely , we want to show that for each @xmath491 $ ] , we have @xmath492 where @xmath493 is the horizontal left - to - right order on @xmath494 for @xmath480 odd and the vertical bottom - to - top order on @xmath494 for @xmath480 even .    we show only for @xmath495 since",
    "the other cases are analogous and follow by induction on @xmath480 , using the induction assumption that @xmath496 is an increasing subsequence in @xmath0 .    by symmetry ,",
    "it is sufficient to prove that @xmath497 ; in other words , that @xmath498 is to the left of @xmath499 in @xmath0 .",
    "this will follow from the fact that all vertices of @xmath500 in @xmath501 are to the left of all vertices of @xmath502 in @xmath501 . indeed , the neighbor @xmath503 of @xmath498 in @xmath500 is at a position adjacent to @xmath498 in @xmath0 , so every element in @xmath501 that is to the right of @xmath503 is also to the right of @xmath498 .",
    "let @xmath244 be the subgraph of @xmath235 consisting of the vertices @xmath504 and all the good edges among these vertices .",
    "clearly , @xmath244 contains all the paths @xmath476 .",
    "we observe that @xmath244 has the following planar drawing ; see figure  [ obr_planar ] . for each @xmath349 $ ] , draw the vertices of @xmath489 on the vertical line with @xmath399-coordinate @xmath480 , ordered from bottom to top according to the order @xmath505 . then draw all the edges as straight - line segments",
    ".     of @xmath235 consisting of good edges .",
    "right : a planar drawing of @xmath244 . ]",
    "let @xmath506 , which is a convex region containing all the vertices and edges of the drawing .",
    "all the vertices of @xmath507 and @xmath478 are on the boundary of @xmath508 .",
    "each of the paths @xmath483 connects a vertex in @xmath507 with a vertex in @xmath478 , and all the inner vertices of @xmath483 are in @xmath509 .",
    "therefore , each path @xmath483 divides @xmath508 into two regions : the region _ below _ @xmath483 and the region _ above",
    "_ @xmath483 .",
    "in particular , @xmath502 is contained in the region above @xmath500 .",
    "is below @xmath510 , then @xmath502 is forced to return to the left boundary of @xmath508 . ]    suppose for contradiction that there are vertices @xmath511 and @xmath512 such that @xmath513 is below @xmath510 on the line with @xmath399-coordinate @xmath30 ; see figure  [ obr_q1_q2 ] .",
    "let @xmath514 be the subpath of @xmath500 between @xmath498 and @xmath510 .",
    "since @xmath513 is in the region above @xmath500 , the vertex @xmath503 , which is the neighbor of @xmath498 on @xmath500 , is below @xmath513 .",
    "consequently , @xmath513 is inside the bounded region formed by @xmath514 and the segment @xmath515 .",
    "since @xmath500 and @xmath502 do not cross , it follows that @xmath502 crosses the segment @xmath515 twice . but",
    "this means that there are at least two vertices on @xmath502 in @xmath477 , which is a contradiction .",
    "we shall prove that the theorem holds for the function @xmath516 .",
    "suppose that @xmath272 is a permutation such that @xmath36 contains a @xmath356-wall .",
    "let @xmath380 be a stair - decomposition of  @xmath0 .",
    "by lemma  [ lemma_tw_blocks ] , the subgraph of @xmath36 induced by any @xmath25 consecutive blocks of the decomposition has treewidth at most  @xmath93 .",
    "we may therefore apply lemma  [ lem - graf ] to the graph @xmath36 and the sets @xmath306 , to conclude that there is an index @xmath517 $ ] and a set of vertex - disjoint paths @xmath518 , each connecting @xmath410 to @xmath411 .",
    "let @xmath519 be the smallest odd integer greater than or equal to  @xmath520 .",
    "note that @xmath36 has at most two edges connecting a vertex in @xmath521 to a vertex in @xmath522 , since @xmath522 is above and to the right of  @xmath521 . by the same argument",
    ", there are at most two edges between @xmath523 and @xmath524 .",
    "we remove from @xmath518 all the paths using any of these edges , and observe that each of the remaining paths contains a vertex from @xmath477 as well as from @xmath478 . truncating these paths if necessary",
    ", we may assume that all their vertices are in the set @xmath525 .",
    "by lemma  [ lemma_bad_edges ] , this set induces at most @xmath526 bad edges in @xmath36 . removing from our set of paths any path containing a bad edge ,",
    "we are left with at least @xmath527 paths from @xmath477 to @xmath478 which only contain good edges . by lemma  [ lem - good - paths ]",
    ", @xmath0 contains the @xmath25-track , as claimed .",
    "let @xmath3 be a proper subclass of @xmath60 .",
    "let @xmath52 be the smallest positive integer such that there is a @xmath121-avoiding @xmath52-permutation that is not contained in @xmath3 .",
    "by lemma  [ lemma_ktrack ] , the @xmath52-track is not contained in @xmath3 either . by theorem  [ theorem_hledani_ktracku ] , for some function @xmath528 , there is no permutation @xmath529 such that @xmath235 contains a @xmath530-wall .",
    "consequently , no such graph @xmath235 contains the @xmath531 grid as a minor . by theorem  [ veta_grid ] , for every permutation @xmath529",
    ", the treewidth of the graph @xmath235 is at most @xmath532 .",
    "finally , theorem  [ veta_o_omezene_sirce ] implies that for @xmath533 and @xmath32 , the problem whether @xmath0 is contained in @xmath1 can be solved in time @xmath534 .",
    "recall that @xmath66 is the class @xmath535 .",
    "our goal is to prove theorems  [ thm - skew ] and  [ veta_polynomialni_skew ] . to this end",
    ", we will first show that permutations from @xmath66 admit a decomposition which is analogous to the stair - decomposition for the class @xmath60 .",
    "this will allow us to show that the proofs of theorems  [ thm - main ] and  [ veta_polynomialni ] can be straightforwardly adapted into proofs of theorems  [ thm - skew ] and  [ veta_polynomialni_skew ] , respectively .",
    "[ def - spiral ] let @xmath245 be a permutation .",
    "a _ spiral decomposition _ of @xmath0 is a partition of @xmath0 into a sequence @xmath536 , where each @xmath275 is a possibly empty subset of elements of  @xmath0 , satisfying the following properties :    * if @xmath106 is odd then @xmath275 is a decreasing subsequence , and if @xmath106 is even then @xmath275 is an increasing subsequence of  @xmath0 . * for @xmath388 $ ] , let @xmath537 be the remainder of @xmath106 modulo  4 .",
    "see the right part of figure  [ fig - twirl ] . if @xmath538 then @xmath539 is above @xmath540 and @xmath392 is above and to the left of @xmath540 . if @xmath541 and @xmath98 then @xmath539 is to the left of @xmath540 and @xmath392 is below and to the left of  @xmath540 .",
    "if @xmath542 then @xmath539 is below @xmath540 and @xmath392 is below and to the right of  @xmath540 . if @xmath543 then @xmath539 is to the right of @xmath540 and @xmath392 is above and to the right of  @xmath540 .",
    "the subsequences @xmath387 are the _ blocks _ of the spiral decomposition .",
    "note that if a block @xmath275 is empty , then @xmath275 is simultaneously to the left , to the right , above and below the block @xmath540 .",
    "[ lem - spiral ] a permutation @xmath0 belongs to the class @xmath66 if and only if @xmath0 has a spiral decomposition .",
    "moreover , every permutation in @xmath66 has a spiral decomposition with no four consecutive empty blocks .",
    "suppose first that @xmath0 is in @xmath66 .",
    "in particular , @xmath0 is skew - merged , and therefore it can be partitioned into an increasing subsequence @xmath544 and a decreasing subsequence  @xmath545 .",
    "we now define an infinite sequence @xmath546 , where each @xmath275 is a possibly empty subset of  @xmath0 . the @xmath275 will be defined inductively . for an @xmath547 ,",
    "suppose that @xmath548 have already been defined .",
    "define @xmath549 as @xmath550 and @xmath551 as @xmath552 .",
    "let @xmath537 be the remainder of @xmath106 modulo 4 . to define @xmath275",
    ", we distinguish four cases :    * if @xmath538 , then @xmath553 . * if @xmath541 , then @xmath554 . * if @xmath542 , then @xmath555 . * if @xmath543 , then @xmath556 .",
    "let @xmath304 be the last nonempty block in the sequence @xmath546 defined above ( if all the blocks are empty , set @xmath557 ) .",
    "we now show that @xmath558 is a spiral decomposition of  @xmath0 . clearly , @xmath275 is a decreasing sequence for odd @xmath106 and an increasing sequence for even  @xmath106 .",
    "let @xmath559 be the set of elements of @xmath0 not belonging to @xmath275 for any integer  @xmath106 .",
    "let us verify that the blocks have the correct mutual position .",
    "let @xmath392 be the set of elements of @xmath0 not belonging to @xmath560 ; in particular , @xmath559 is a subset of @xmath392 .",
    "we claim that for any @xmath561 , the mutual positions of @xmath540 , @xmath275 and @xmath392 are the same as in part ( b ) of definition  [ def - spiral ] .",
    "suppose that @xmath538 , the other three cases being analogous .",
    "note that @xmath562 and @xmath563 .",
    "since @xmath540 is below @xmath564 by definition and @xmath275 is a subset of @xmath564 , we see that @xmath275 above @xmath540 .    to see that @xmath392 is to the left and above @xmath540 , notice that @xmath392 is the disjoint union of @xmath551 and @xmath565 .",
    "clearly @xmath551 is above and to the left of @xmath540 , and @xmath549 is above @xmath540 by definition of @xmath540 .",
    "moreover , every element of @xmath565 must be to the left of at least one element of @xmath551 by definition of @xmath275 , and therefore also to the left of  @xmath540 .",
    "this shows that @xmath392 is to the left and above  @xmath540 .    to prove that @xmath387 is a spiral decomposition",
    ", it remains to show that each element of @xmath0 is in @xmath566 .",
    "suppose for contradiction that this is not the case , that is , suppose that @xmath559 is not empty .",
    "let @xmath567 be the bottommost , leftmost , topmost and rightmost element of @xmath559 , respectively .",
    "let @xmath130 be the smallest multiple of @xmath229 larger than  @xmath116 .",
    "note that @xmath568 , since all the blocks following @xmath304 are empty .",
    "consider the four empty blocks @xmath569 , @xmath570 , @xmath571 , and @xmath572 .",
    "we may deduce that @xmath51 belongs to @xmath573 , for otherwise it would be to the right of @xmath573 and would belong to  @xmath569 . by the same argument , @xmath574 belongs to @xmath575 , @xmath423 belongs to @xmath573 , and @xmath520 belongs to  @xmath575 .",
    "it follows that @xmath576 form an occurrence of the pattern @xmath577 , contradicting the assumption that @xmath0 is in  @xmath66 .",
    "we have thus shown that each permutation in @xmath66 has a spiral decomposition .",
    "the argument actually shows that we may find a spiral decomposition with no four consecutive empty blocks .",
    "we now show that every permutation with a spiral decomposition is in  @xmath66 .",
    "let @xmath0 be a permutation with a spiral decomposition @xmath387 .",
    "it easily follows from definition  [ def - spiral ] that the union of the odd - numbered blocks is a decreasing sequence and the union of the even - numbered ones is an increasing sequence .",
    "in particular , @xmath0 is skew - merged .",
    "it remains to show that @xmath0 avoids @xmath577 .",
    "suppose for contradiction that @xmath0 has a subsequence @xmath578 forming an occurrence of @xmath577 . since there is only one way to partition @xmath577 into a decreasing and an increasing subsequence , we know that @xmath423 and @xmath51 belong to odd - numbered blocks , and @xmath574 and @xmath520 to even - numbered ones .",
    "let @xmath579 be the first block of the spiral decomposition containing at least one element of  @xmath92 .",
    "suppose that @xmath480 is even , the other case being analogous .",
    "then @xmath579 contains @xmath574 or  @xmath520 , and both @xmath423 and @xmath51 belong to  @xmath580 . from part ( b ) of definition  [ def - spiral ] we may deduce that either @xmath580 is to the left of @xmath579 ( if @xmath581 ) , or @xmath580 is to the right of @xmath579 ( if @xmath582 ) .",
    "this contradicts the fact that both @xmath423 and @xmath51 belong to  @xmath580 and at least one of @xmath574 and @xmath520 is in  @xmath579 .",
    "we now introduce an operation called the twirl , whose main purpose is to transform a permutation @xmath0 with a given stair - decomposition @xmath387 into a permutation @xmath583 with a spiral decomposition @xmath584 .",
    "intuitively , each block @xmath585 will be obtained by rotating or reflecting @xmath275 , and then rearranging the blocks into a spiral .     with a stair - decomposition into six blocks .",
    "the top - right corner of each block is highlighted .",
    "right : the result of twirling @xmath0a spiral decomposition whose blocks are rotated and reflected versions of the blocks of  @xmath0 , with the highlighted corners now pointing towards the center of the spiral . ]    formally , given a permutation @xmath0 with a stair - decomposition @xmath586 , the _ twirl _ of @xmath0 ( with respect to @xmath387 ) is a permutation @xmath583 with a spiral decomposition @xmath587 , determined by these rules :    * for each @xmath106 , the block @xmath588 is obtained by rotating or reflecting @xmath275 , in such a way that rows of @xmath275 get mapped to rows of @xmath588 and similarly for columns . moreover ,",
    "the top - right corner of @xmath275 will be mapped to the corner of @xmath585 that is nearest to the center of the spiral ; see figure  [ fig - twirl ] . * for every pair of consecutive blocks @xmath275 and @xmath589 , let @xmath382 and @xmath590 be a pair of elements , and let @xmath591 and @xmath592 be the corresponding elements of @xmath585 and @xmath593 , respectively .",
    "then the mutual position of @xmath591 and @xmath592 corresponds to the mutual position of @xmath399 and @xmath594 , in the following sense : * * if @xmath595 , then @xmath591 is above @xmath592 if and only if @xmath399 is below  @xmath594 , * * if @xmath596 , then @xmath591 is to the right of @xmath592 if and only if @xmath399 is to the right of  @xmath594 , * * if @xmath597 , then @xmath591 is above @xmath592 if and only if @xmath399 is above  @xmath594 , * * if @xmath598 , then @xmath591 is to the right of @xmath592 if and only if @xmath399 is left of  @xmath594 .",
    "note that the properties above , together with the fact that @xmath587 form a spiral decomposition , determine @xmath583 uniquely .",
    "we say that @xmath583 is the _ twirl _ of @xmath0 and @xmath0 is the _ untwirl _ of @xmath583 ( with respect to given decompositions @xmath387 and @xmath587 , respectively ) .    we will also need to apply this transform in situations when the blocks of the decomposition do not necessarily induce a monotone subsequence",
    "we therefore generalize the two notions of decomposition appropriately .",
    "we say that a partition of a permutation @xmath0 into a sequence of blocks @xmath599 forms a _ relaxed stair - decomposition _ if it satisfies all the properties of stair - decomposition except possibly for the property that each @xmath275 forms an increasing subsequence .",
    "similarly , a _ relaxed spiral decomposition _ satisfies all the properties of a spiral decomposition , except perhaps the property that each block is a monotone subsequence .",
    "the twirl transform can be applied to a permutation with a relaxed stair - decomposition to obtain a permutation with a relaxed spiral decomposition .",
    "we want to show that ppm is np - hard for instances where the pattern belongs to @xmath66 and the text to  @xmath59 .",
    "our idea is to use the pattern @xmath62 and the text @xmath63 constructed from a 3-sat formula @xmath74 in the proof of theorem  [ thm - main ] , and twirl them into a pattern @xmath600 and text @xmath601 .",
    "we will then show that @xmath74 is satisfiable if and only if @xmath602 contains  @xmath583 .    for the twirl to be well defined , we need to specify a stair - decomposition of @xmath0 and a relaxed stair - decomposition of  @xmath1 .",
    "recall that @xmath0 is a disjoint union of an increasing sequence @xmath89 ( the anchor ) and a @xmath122-fold staircase @xmath82 with @xmath129 steps .",
    "the staircase @xmath82 itself is a sequence of bends @xmath603 , with @xmath482 being the @xmath106th outer bend and @xmath604 the @xmath106th inner bend of  @xmath82 .",
    "the sequence @xmath605 is clearly a stair - decomposition of @xmath0 , and we obtain @xmath583 by twirling @xmath0 with respect to this decomposition .    for @xmath1 , we consider the relaxed stair - decomposition whose blocks are the anchor @xmath136 , followed by the modified bends @xmath606 of the modified staircase  @xmath208 .",
    "let @xmath602 be the permutation obtained by twirling  @xmath1 .",
    "note that the union of the odd - numbered blocks of @xmath602 is a decreasing sequence while the union of the even - numbered blocks can be decomposed into at most two increasing sequences .",
    "it follows that @xmath602 is in  @xmath59 .",
    "we easily check that @xmath602 contains @xmath583 if and only if @xmath74 is satisfiable , by following the same reasoning as in the proof of theorem  [ thm - main ] .",
    "this completes the proof of theorem  [ thm - skew ] .",
    "let @xmath39 denote the set of permutations @xmath607 .",
    "recall that theorem  [ thm - principal ] states that @xmath71-pattern ppm is polynomial for each @xmath70 in @xmath39 and np - complete for any other  @xmath70 .",
    "first of all , we note that for each @xmath608 , the class @xmath71 is a subclass of the class @xmath46 of separable permutations .",
    "since @xmath46-pattern ppm is polynomial by a result of bose , buss and lubiw  @xcite , @xmath71-pattern ppm is polynomial as well .    on the other hand ,",
    "if @xmath70 contains @xmath121 as a subpermutation , then @xmath71 contains @xmath42 as a subclass .",
    "since @xmath42-pattern ppm is np - hard by theorem  [ thm - main ] , @xmath71-pattern ppm is np - hard as well . by symmetry ,",
    "@xmath71-pattern ppm is also hard when @xmath70 contains  @xmath609 .",
    "there are only four permutations that do not belong to @xmath39 and do not contain a monotone subsequence of length @xmath255 , namely @xmath610 , @xmath144 , @xmath611 , and @xmath577 .",
    "theorem  [ thm - skew ] implies that @xmath71-pattern ppm is hard for any @xmath612 . by symmetry",
    ", the problem is hard for @xmath613 as well .",
    "this completes the proof of theorem  [ thm - principal ] .",
    "our goal is to show that for every proper subclass @xmath3 of @xmath66 , the @xmath3-pattern ppm problem is polynomial .",
    "we will again use the twirl to adapt the proof of theorem  [ veta_polynomialni ] that we gave in section  [ sec - poly ] .    as in the proof of theorem  [ veta_polynomialni ] , our goal is to show that for permutations @xmath0 taken from any proper subclass of @xmath66 , the graphs @xmath36 have bounded treewidth , or more precisely , that every permutation @xmath68 whose graph @xmath36 has sufficiently large treewidth contains a universal pattern .",
    "let @xmath0 be a permutation with a stair - decomposition @xmath387 , and let @xmath2 be a permutation with a stair - decomposition @xmath614 such that @xmath615 .",
    "we say that @xmath2 has a _ block - preserving occurrence _ in @xmath0 ( with respect to the decompositions @xmath387 and @xmath614 ) if it has an occurrence in @xmath0 with the property that for each @xmath616 the elements of @xmath617 are mapped to the elements of  @xmath275 .",
    "we also use the same terminology when dealing with spiral decompositions .",
    "notice that block - preserving occurrences are preserved by the twirl operation , as formalized by the next observation .",
    "[ obs - twirl ]",
    "let @xmath0 be a permutation with a stair - decomposition @xmath618 , and let @xmath2 be a permutation with a stair - decomposition @xmath619 . let @xmath583 with spiral decomposition @xmath587 and @xmath620 with spiral decomposition @xmath621 be obtained by twirling @xmath0 and @xmath2 , respectively",
    ". then @xmath2 has a block - preserving occurrence in @xmath0 if and only if @xmath620 has a block - preserving occurrence in  @xmath583 .",
    "let @xmath479 be the @xmath25-track permutation , and let @xmath622 be its stair - decomposition into blocks of size @xmath25 , introduced in section  [ sec - poly ] .",
    "@xmath25-spiral _ is the permutation @xmath623 obtained by twirling @xmath479 with respect to this stair - decomposition .",
    "when dealing with @xmath25-spirals , we always assume they have a spiral decomposition obtained by twirling the stair decomposition @xmath624 .",
    "[ lem - qspiral ] every @xmath25-permutation @xmath68 with a spiral decomposition into @xmath116 blocks has a block - preserving occurrence in the @xmath315-spiral , for @xmath313 .",
    "this follows directly from lemma  [ lemma_ktrack ] , via observation  [ obs - twirl ] .",
    "since each @xmath7-permutation in @xmath66 has a spiral decomposition with at most @xmath625 blocks , we conclude that each @xmath7-permutation in @xmath66 is contained in the @xmath625-spiral .    for a permutation @xmath9 ,",
    "the _ reverse - complement _ of @xmath0 is the permutation @xmath626 .",
    "intuitively , the diagram of the reverse - complement is obtained from the diagram of @xmath0 by a rotation of 180 degrees .",
    "notice that @xmath66 is closed under reverse - complements .",
    "consequently , each @xmath7-permutation in @xmath66 is contained in the reverse - complement of the @xmath625-spiral .",
    "the notion of good edges and bad edges in @xmath36 , which we introduced in section  [ sec - poly ] , can be extended to spiral decompositions .",
    "let @xmath68 be a permutation with a spiral decomposition @xmath387 .",
    "let @xmath381 be an edge of @xmath36 , such that @xmath382 and @xmath383 , with @xmath627 .",
    "then the edge @xmath381 is _ good _ if it satisfies at least one of the following properties :    * @xmath385 * @xmath381 is blue , @xmath106 is odd and @xmath386 , or * @xmath381 is red , @xmath106 is even and @xmath386 .",
    "otherwise @xmath381 is _",
    "bad_.    the twirl operation clearly preserves the good edges .",
    "[ obs - good ] let @xmath0 be a permutation with a stair - decomposition @xmath558 and let @xmath583 be the permutation with spiral decomposition @xmath628 obtained by twirling  @xmath0 .",
    "let @xmath399 and @xmath594 be two elements of @xmath0 and @xmath591 and @xmath592 the corresponding elements of  @xmath583 .",
    "then @xmath381 is a good edge of @xmath36 if and only if @xmath629 is a good edge of @xmath630 .",
    "[ lem - spiral - bad ] if a permutation @xmath68 has a spiral decomposition with @xmath116 blocks , then @xmath36 has at most @xmath631 bad edges .",
    "it is easy to see that if @xmath381 is a bad edge in @xmath36 , then both @xmath399 and @xmath594 are either leftmost or rightmost elements of their blocks in the spiral decomposition of  @xmath0 .",
    "since every vertex of @xmath36 has degree at most 4 and at most @xmath359 vertices are incident to bad edges , @xmath36 has at most @xmath631 bad edges .",
    "[ lem - spiral - tw ] if @xmath68 has a spiral decomposition with @xmath116 blocks , then the treewidth of @xmath36 is at most  @xmath632 .",
    "untwirl @xmath0 into a permutation @xmath633 . by lemma  [ lemma_tw_blocks ] ,",
    "the graph @xmath630 has treewidth at most  @xmath359 . by observation  [ obs - good ] , every good edge of @xmath36 is also an edge of @xmath630 .",
    "therefore , by lemma  [ lem - spiral - bad ] , @xmath36 can be obtained from @xmath630 by inserting at most @xmath631 new bad edges , and possibly also removing some bad edges of  @xmath630 . inserting an edge into a graph may increase its treewidth by at most @xmath634 , and removing an edge can not increase the treewidth . therefore , the treewidth of @xmath36 is at most @xmath632 , as claimed .    to prove theorem  [ veta_polynomialni_skew ] , we first prove the following claim , which is the @xmath66-analogue of theorem  [ theorem_hledani_ktracku ] , and is proved by a similar argument .",
    "[ thm - hledani - k - spiral ] let @xmath68 be a permutation such that @xmath36 contains a @xmath356-wall , where @xmath516 .",
    "then @xmath0 contains the @xmath25-spiral or the reverse - complement of the @xmath25-spiral .",
    "let @xmath68 have a spiral decomposition @xmath387 .",
    "by lemma  [ lem - spiral - tw ] , the subgraph of @xmath36 induced by @xmath25 consecutive blocks of the decomposition has treewidth at most  @xmath635 .",
    "we may invoke lemma  [ lem - graf ] , to obtain @xmath407 vertex - disjoint paths from @xmath410 to @xmath411 for some  @xmath520 . let @xmath519 be the smallest odd integer greater than or equal to  @xmath520 . by discarding at most four paths containing an edge from @xmath521 to @xmath522 or an edge from @xmath523 to @xmath524 , truncating the remaining paths to only contain vertices from @xmath525 , and discarding at most @xmath157 paths containing bad edges , we end up with at least @xmath636 paths from @xmath477 to @xmath478 which only contain good edges .",
    "untwirl @xmath0 into a permutation @xmath633 with a stair - decomposition @xmath584 .",
    "since the untwirl preserves good edges , we know by lemma  [ lem - good - paths ] that @xmath583 contains the @xmath25-track @xmath479 , and the occurrence of @xmath479 is block - preserving with respect to the stair - decomposition in which the first @xmath637 blocks of @xmath479 are empty and the remaining blocks have size  @xmath25 . by observation  [ obs - twirl ] , we conclude that @xmath0 contains the @xmath25-spiral ( if @xmath638 ) or the reverse - complement of the @xmath25-spiral ( if @xmath639 ) .    theorem  [ thm - hledani - k - spiral ] implies theorem  [ veta_polynomialni_skew ] in exactly the same way as theorem  [ theorem_hledani_ktracku ] implies theorem  [ veta_polynomialni ] .",
    "theorem  [ veta_polynomialni_skew ] is thus proved .",
    "we have shown that for every proper subclass @xmath3 of @xmath42 , the @xmath3-pattern ppm problem is polynomial - time solvable , and the same is true for proper subclasses of @xmath640 .",
    "the proofs are based on the fact that for permutations in such a class @xmath3 , the associated graph @xmath36 has bounded treewidth , which , by results of ahal and rabinovich  @xcite , implies that @xmath3-pattern ppm is polynomial .",
    "in fact , in all the cases when @xmath3-pattern ppm is known to be polynomial , the class @xmath3 has bounded treewidth of  @xmath36 .",
    "we may therefore ask whether in fact the boundedness of treewidth can precisely characterize the polynomial cases of @xmath3-pattern ppm .",
    "is the @xmath3-pattern ppm problem np - hard for every class @xmath3 for which the treewidth of  @xmath36 is unbounded ?    for the closely related decision problem @xmath3-ppm ,",
    "we have obtained np - hardness when @xmath3 is the class @xmath641 .",
    "this gives the first known example of a proper permutation class @xmath3 for which the problem is hard .",
    "we have subsequently shown that @xmath59-ppm is np - hard as well .",
    "it follows that @xmath4-ppm is np - hard for any permutation @xmath5 not belonging to the finite set @xmath642 , and in particular , @xmath4-ppm is hard for every @xmath5 of size at least  @xmath643 .",
    "however , a precise characterization of the polynomial cases of @xmath3-ppm is currently out of our reach , even for principal classes  @xmath3 .    for which permutations @xmath5 can @xmath4-ppm be solved in polynomial time ?",
    "the authors wish to thank ida kantor for many valuable discussions .",
    "m.  h. albert , r.  e.  l. aldred , m.  d. atkinson and d.  a. holton , algorithms for pattern involvement in permutations , _ algorithms and computation ( christchurch , 2001 ) _ , vol .",
    "2223 of _ lecture notes in comput .",
    "_ , springer , berlin ( 2001 ) 355367 ."
  ],
  "abstract_text": [
    "<S> permutation pattern matching ( or ppm ) is a decision problem whose input is a pair of permutations @xmath0 and @xmath1 , represented as sequences of integers , and the task is to determine whether @xmath1 contains a subsequence order - isomorphic to  @xmath0 . </S>",
    "<S> bose , buss and lubiw proved that ppm is np - complete on general inputs .    </S>",
    "<S> we show that ppm is np - complete even when @xmath0 has no decreasing subsequence of length  3 and @xmath1 has no decreasing subsequence of length  4 . </S>",
    "<S> this provides the first known example of ppm being hard when one or both of @xmath0 and @xmath2 are restricted to a proper hereditary class of permutations .    </S>",
    "<S> this hardness result is tight in the sense that ppm is known to be polynomial when both @xmath0 and @xmath1 avoid a decreasing subsequence of length  3 , as well as when @xmath0 avoids a decreasing subsequence of length  2 . </S>",
    "<S> the result is also tight in another sense : we will show that for any hereditary proper subclass @xmath3 of the class of permutations avoiding a decreasing sequence of length  3 , there is a polynomial algorithm solving ppm instances where @xmath0 is from @xmath3 and @xmath1 is arbitrary .    </S>",
    "<S> we also obtain analogous hardness and tractability results for the class of so - called skew - merged patterns .    from these results , </S>",
    "<S> we deduce a complexity dichotomy for the ppm problem restricted to @xmath0 belonging to @xmath4 , where @xmath4 denotes the class of permutations avoiding a permutation  @xmath5 . </S>",
    "<S> specifically , we show that the problem is polynomial when @xmath5 is in the set @xmath6 , and it is np - complete for any other  @xmath5 .     </S>",
    "<S> computer science institute + charles university , faculty of mathematics and physics , + malostransk nm .  </S>",
    "<S> 25 , 118 00   praha 1 , czech republic ; + ` jelinek@iuuk.mff.cuni.cz ` +   + department of applied mathematics and institute for theoretical computer science , + charles university , faculty of mathematics and physics , + malostransk nm .  25 , 118 00   praha 1 , czech republic ; + ` kyncl@kam.mff.cuni.cz ` </S>"
  ]
}