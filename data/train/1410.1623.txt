{
  "article_text": [
    "billiards were introduced by birkhoff  @xcite .",
    "let @xmath7 be a smooth strictly convex curve in the plane , oriented counterclockwise , and let @xmath8 be the billiard table enclosed by @xmath7 .",
    "billiard trajectories inside @xmath8 consist of polygonal lines inscribed in @xmath7 whose consecutive sides obey to the rule `` the angle of reflection is equal to the angle of incidence . ''",
    "see  @xcite for a general description .",
    "a @xmath0-periodic billiard trajectory forms a closed polygon with @xmath6 sides that makes @xmath9 turns inside @xmath7 .",
    "birkhoff  @xcite proved that there are at least two different birkhoff @xmath0-periodic billiard trajectories inside @xmath8 for any relatively prime integers @xmath9 and @xmath6 such that @xmath10 .",
    "let @xmath11 be the supremum of the absolute values of the differences of the lengths of all such trajectories .",
    "the quantities @xmath11 were already studied by marvizi and melrose  @xcite and colin de verdire  @xcite for smooth tables .",
    "the former authors produced an asymptotic expansion of the lengths for @xmath0-periodic billiard trajectories approaching @xmath7 when @xmath9 is fixed and @xmath12 .",
    "they saw that there exists a sequence @xmath13 , depending only on @xmath9 and @xmath7 , such that , if @xmath14 is the length of any @xmath0-periodic trajectory , then @xmath15 + \\sum_{k \\ge 1 } \\frac{l_k}{q^{2k } } , \\qquad q\\to\\infty,\\ ] ] where @xmath16 , and @xmath17 is the curvature of @xmath7 as a function of the arc - length parameter @xmath18 .",
    "the symbol @xmath19 means that the series in the right hand side is asymptotic to @xmath20 .",
    "the assymptotic coefficients @xmath21 can be explicitly written in terms of the curvature @xmath17 .",
    "for instance , the explicit formulas for @xmath22 , @xmath23 , @xmath24 , and @xmath25 can be found in  @xcite . since the expansion of the lengths in powers of @xmath26 coincides for all these @xmath0-periodic trajectories , @xmath27 for smooth strictly convex tables when @xmath9 is fixed and @xmath12 .",
    "colin de verdire studied the lengths of periodic trajectories close to an elliptic @xmath28-periodic trajectory on a smooth symmetric billiard table , and found that the quantities @xmath11 are again beyond all order with respect to @xmath6 .",
    "these works suggest that the supremum length differences @xmath11 are exponentially small in the period @xmath6 for analytic strictly convex tables .",
    "indeed , we have proved that if @xmath7 is analytic and @xmath9 is a fixed positive integer , then there exists @xmath29 such that @xmath30 for all integer @xmath31 relatively prime with @xmath9 .",
    "the exponent @xmath32 is related to the width of a complex strip where a certain @xmath33-periodic angular coordinate is analytic .",
    "a more precise statement is given in theorem  [ thm : classicalboundary ] .",
    "similar exponentially small upper bounds hold in other billiard problems .",
    "we mention two examples .",
    "first , for @xmath0-periodic billiard trajectories inside strictly convex analytic tables of constant width when @xmath34 .",
    "second , for @xmath0-periodic billiard trajectories inside strictly convex analytic tables in surfaces of constant curvature when @xmath35 .",
    "the billiard dynamics close to the boundary has also been studied from the point of view of kam theory .",
    "lazutkin  @xcite proved that there are infinitely many caustics inside any @xmath36 strictly convex table .",
    "these caustics accumulate at the boundary of the table , and have diophantine rotation numbers .",
    "douady  @xcite improved the result to @xmath37 billiard tables .",
    "a special remark on the relevance of these results is the following .",
    "kac  @xcite formulated the inverse spectral problem for planar domains .",
    "that is , to study how much geometric information about @xmath8 can be obtained from the laplacian spectrum with homogeneous dirichlet conditions on @xmath7 .",
    "andersson and melrose  @xcite gave an explicit relation between the length spectrum and the laplacian spectrum .",
    "the length spectrum of @xmath8 is the union of the lengths of all its @xmath0-periodic billiard trajectories and all the integer multiples of @xmath38 $ ] .",
    "see also  @xcite .",
    "our results also apply to the dual billiards introduced by day  @xcite and popularized by moser  @xcite as a crude model for planetary motion . some general references are  @xcite . let @xmath39 be unbounded component of @xmath40 .",
    "the dual billiard map @xmath41 is defined as follows : @xmath42 is the reflection of @xmath43 in the tangency point of the oriented tangent line to @xmath7 through @xmath43 .",
    "billiards and dual billiards are projective dual in the sphere  @xcite .",
    "a @xmath0-periodic dual billiard trajectory forms a closed circumscribed polygon with @xmath6 sides that makes @xmath9 turns outside @xmath7 .",
    "the area of a @xmath0-periodic trajectory is the area enclosed by the corresponding polygon , taking into account some multiplicities if @xmath44 .",
    "there are at least two different birkhoff @xmath0-periodic dual billiard trajectories outside @xmath7 for any relatively prime integers @xmath9 and @xmath6 such that @xmath45 and @xmath10 .",
    "tabachnikov  @xcite studied the supremum @xmath46 of the absolute value of the differences of the areas enclosed by all such @xmath5-periodic trajectories for smooth tables .",
    "he proved that there is a sequence @xmath47 , depending only on @xmath7 , such that , if @xmath48 is the area enclosed by any @xmath5-periodic dual billiard trajectory , then @xmath49 + \\sum_{k \\ge 1 } \\frac{a_k}{q^{2k } } , \\qquad q\\to\\infty,\\ ] ] where @xmath50 .",
    "hence , the expansion of the areas in powers of @xmath26 coincides for all these @xmath5-periodic trajectories , and so , @xmath51 for smooth strictly convex dual tables when @xmath12 .",
    "douady  @xcite found the existence of infinitely many invariant curves outside any @xmath37 strictly convex dual table .",
    "these invariant curves accumulate at the boundary of the dual table and have diophantine rotation numbers .    in a completely analogous way to ( classical ) billiards , we have proved that , once fixed any positive integer @xmath9 , if @xmath7 is analytic , then there exists @xmath29 such that @xmath52 for all integer @xmath31 relatively prime with @xmath9 . once more , the exponent @xmath32 is related to the width of a complex strip where a certain @xmath33-periodic angular coordinate is analytic . the precise statement is given in theorem  [ thm : dualboundary ] .    still in the context of dual billiards , the points at infinity can be seen as @xmath28-periodic points , hence they form a @xmath28-resonant ric .",
    "douady  @xcite found the existence of infinitely many invariant curves outside any @xmath53 strictly convex dual table .",
    "these invariant curves accumulate at infinity and have diophantine rotation numbers .",
    "we have proved that , once fixed any constant @xmath54 , if @xmath7 is analytic , then there exist @xmath29 such that @xmath55 for all relatively prime integers @xmath9 and @xmath6 such that @xmath56 and @xmath31 .",
    "see theorem  [ thm : dualinfinity ] .",
    "the three exponents @xmath32 that appear in the exponentially small upper bounds  ( [ eq : bounddifferencelengths ] ) , ( [ eq : bounddifferenceareas ] ) , and  ( [ eq : bounddifferenceareas_bis ] ) may be different , since each one is associated to a different analyticity strip width . besides , all of these upper bounds follow directly from a general upper bound about analytic area - preserving twist maps with analytic resonant rics .",
    "let us explain it .",
    "classical and dual billiard maps are exact twist maps defined on an open cylinder when written in suitable coordinates .",
    "exact twist maps have been vastly studied .",
    "they satisfy a lagrangian formulation and their orbits are stationary points of the action functional .",
    "see for instance  @xcite .",
    "birkhoff  @xcite showed that the minima and minimax points of the @xmath0-periodic action correspond to two different birkhoff @xmath0-periodic orbits of the twist map .",
    "a birkhoff @xmath0-periodic orbit is an orbit such that , after @xmath6 iterates , performs exactly @xmath9 revolutions around the cylinder and its points are ordered in the base @xmath57 as the ones following a rigid rotation of angle @xmath2 .",
    "since there exist at least two different birkhoff @xmath0-periodic orbits , we consider the supremum @xmath58 of the absolute value of the differences of the actions among all of them .",
    "the quantity @xmath58 coincides with @xmath11 and @xmath59 for classical and dual billiards , respectively .",
    "let @xmath60 be the difference of actions between the minimax and minima @xmath0-periodic orbits .",
    "note that @xmath58 is an upper bound of @xmath60 .",
    "mather  @xcite used @xmath60 as a criterion to prove the existence of rics of given irrational rotation numbers .",
    "more concretely , he proved that there exists a ric with irrational rotation number @xmath61 if and only if @xmath62 .",
    "another criterion related to the destruction of rics , in this case empirical , was proposed by greene .",
    "the destruction of a ric with diophantine rotation number @xmath61 under perturbation is related to a `` sudden change from stability to instability of the nearby periodic orbits ''  @xcite .",
    "the stability of a periodic orbit is measured by the residue .",
    "mackay  @xcite proved the criterion in some contexts .",
    "in particular , for an analytic area - preserving twist map , the residue of a sequence of periodic orbits with rotation numbers tending to @xmath61 decays exponentially in a positive power of the distance between rotation numbers , that is , @xmath63 for some  @xmath64 .",
    "the same proof leads to a similar exponentially small bound of mather s  @xmath60 as @xmath65 .",
    "delshams and de la llave  @xcite studied similar problems for analytic area - preserving nontwist maps .",
    "generically rics with a rational rotation number break under perturbation  @xcite . nevertheless , there are situations in which some distinguished resonant rics always exist .",
    "see sections  [ sec : lengthspectrum ] and  [ sec : areaspectrum ] for several examples related to billiard and dual billiard maps .",
    "let us assume that we have an analytic exact twist map with a @xmath1-resonant ric .",
    "that is , a ric whose points are @xmath1-periodic . then there exist some variables @xmath66 in which the resonant ric is located at @xmath67 and the @xmath4-th power of the exact twist map is a small perturbation of the integrable twist map @xmath68 . to be precise , it has the form @xmath69 since the @xmath4-th power map is real analytic , it can be extended to a complex domain of the form @xmath70 the quantity @xmath71 plays a more important role than @xmath72 . to be precise ,",
    "we have proved that , once fixed any @xmath73 and @xmath54 , there exist @xmath74 such that @xmath75 for any relatively prime integers @xmath9 and @xmath6 such that @xmath76 and @xmath77 .",
    "see theorem  [ thm : asymptotic ] for a more detailed statement .",
    "this upper bound is optimal because @xmath73 .",
    "that is , the exponent @xmath32 can be taken as close to the analyticity strip width @xmath71 as desired .",
    "the constant @xmath78 may explode when @xmath32 tends to @xmath71 , so , in general , we can not take @xmath79 .",
    "a similar optimal exponentially small upper bound was obtained in  @xcite in the setting of the splitting of separatrices of weakly hyperbolic fixed points of analytical area - preserving maps .",
    "the proof of this optimal bound adds some extra technicalities , but we feel that the effort is worth it .",
    "the proof is based on two facts .",
    "first , we write the @xmath4-th power of the exact twist map as the integrable twist map @xmath68 plus an exponentially small remainder on the distance to the ric . see theorem  [ thm : remainder ] .",
    "the size of the remainder is reduced by performing a finite sequence of changes of variables , but the number of such changes increases when we approach to the resonant ric .",
    "this is a classical neishtadt - like argument  @xcite .",
    "second , we apply the mackay - meiss - percival action principle  @xcite , in which the difference of actions of @xmath0-periodic actions is interpreted as an area on the phase space .",
    "the structure of the paper is the following .",
    "section  [ sec : maintheorems ] is devoted to state our results in the general context of analytic exact twist maps . in sections  [ sec :",
    "lengthspectrum ] and  [ sec : areaspectrum ] , we present the different billiard maps and show how the results in section  [ sec : maintheorems ] apply .",
    "sections  [ sec : proofremainder ] and  [ sec : proofthmasymptotic ] contain the technical proofs .",
    "let us introduce some notions about exact twist maps defined on open cylinders .",
    "for a general background on these maps , we refer to  @xcite and  @xcite .",
    "let @xmath80 and @xmath81 , for some @xmath82 .",
    "we will use the coordinates @xmath83 for both @xmath84 and its universal cover @xmath85 .",
    "we refer to @xmath18 as the angular coordinate .",
    "let @xmath86 be an _ exact symplectic form _ on the open cylinder @xmath84 such that @xmath87 and @xmath88 for some smooth function @xmath89 .",
    "in particular , @xmath90 . if @xmath91 is a real - valued smooth function , @xmath92 denotes the derivative with respect to the @xmath93-th variable .",
    "a smooth diffeomorphism @xmath94 is an _ exact twist map _ when it preserves the exact symplectic form @xmath86 , has zero flux , and satisfies the classical _ twist condition _",
    "@xmath95 , where @xmath96 is a lift of @xmath97 .",
    "henceforth , the exact symplectic form @xmath98 and the lift @xmath99 remain fixed .",
    "we will assume that @xmath100 is analytic when we deal with analytic maps . if @xmath97 preserves @xmath101 and @xmath102 , then @xmath103 , @xmath104 , and @xmath97 preserves the canonical area in the _ global darboux coordinates _",
    "it is worth to remark that certain billiard maps can be analytically extended to the boundaries of their phase spaces in @xmath83 variables , but not in global darboux coordinates . for this reason we consider the coordinates @xmath83 and the above exact symplectic forms .",
    "in fact , we could deal with any exact symplectic form , but we do not need it for the problems we have in mind .",
    "[ def : intersectionproperty ] let @xmath106 be a continuous map .",
    "the map @xmath97 has the _ intersection property _ on @xmath84 if the image of any closed homotopically non trivial loop of the cylinder @xmath84 intersects the loop .",
    "the intersection property is preserved under global changes of variables .",
    "a _ rotational invariant curve ( ric ) _ of @xmath97 is a closed loop @xmath107 homotopically non trivial such that @xmath108 .",
    "let @xmath109 be a ric of @xmath97 .",
    "let @xmath110 and @xmath4 be two relatively prime integers such that @xmath111 .",
    "we say that @xmath109 is @xmath1-_resonant _ when @xmath112 for all @xmath113 , and we say that @xmath109 is _ analytic _ when @xmath114 for some analytic function @xmath115 .",
    "if @xmath94 is a diffeomorphism preserving the exact symplectic form @xmath116 and has a ric , both the zero flux condition and the intersection property are automatically satisfied .",
    "let us study the dynamics of an analytic exact twist map in a neighbourhood of an analytic @xmath1-resonant ric .",
    "first , we note that all points on a @xmath1-resonant ric of @xmath97 remain fixed under the power map @xmath117 .",
    "second , we adapt a classical lemma that appears in several papers about billiards  @xcite to our setting .",
    "[ lem : order2 ] if @xmath106 is an analytic exact twist map with an analytic @xmath1-resonant ric @xmath107 , then there exist an analytic strip width @xmath118 , an analytic radius @xmath119 , and some analytic coordinates @xmath66 such that @xmath120 and the power map @xmath117 satisfies the following properties :    1 .",
    "it is real analytic on @xmath121 and can be analytically extended to the complex domain @xmath122 2 .",
    "it has the intersection property on the cylinder @xmath121 ; and 3 .",
    "it has the form @xmath123 , with @xmath124    if @xmath125 and @xmath126 , then @xmath127 and @xmath128 , with @xmath129 for some real analytic @xmath33-periodic functions @xmath130 and @xmath131 .",
    "the twist condition on the ric implies that @xmath130 is positive , since any power of a twist map is locally twist on its smooth rics  ( * ? ? ?",
    "* lemma 2.1 ) .",
    "the preservation of @xmath101 implies that @xmath132 , where @xmath133 .",
    "next , we consider the analytic coordinates @xmath66 defined by @xmath134 the constant @xmath135 has been determined in such a way that the new angular coordinate @xmath136 is defined modulus one : @xmath137 .",
    "clearly , @xmath120 .",
    "thus , the coordinates @xmath66 cover an open set containing @xmath138 , since they are defined in a neighbourhood of @xmath109 .",
    "in particular , @xmath139 can be analytically extended to the complex domain @xmath140 for some @xmath141 .",
    "besides , @xmath139 has the intersection property on @xmath121 because the integral of the area form @xmath101 over the region enclosed between the ric @xmath109 and any closed homotopically non trivial loop should be preserved .",
    "finally , a straightforward computation shows that @xmath139 has the form  ( [ eq : order2 ] ) in the coordinates @xmath66 .",
    "lemma  [ lem : order2 ] has , at a first glance , a narrow scope of application because resonant rics are destroyed under generic perturbations .",
    "however , the boundaries of the cylinder can be considered resonant rics of the extended twist map in many interesting examples .",
    "let us precise this idea .",
    "let @xmath94 be a continuous map .",
    "if @xmath142 is finite , we say that @xmath143 is a _",
    "rigid rotation boundary _ when @xmath97 can be continuously extended to @xmath144 and its extended lift satisfies that @xmath145 for some _ boundary rotation number _ @xmath146 , and we say that @xmath147 is a @xmath1-_resonant boundary _ when @xmath148 .",
    "let @xmath94 be a smooth diffeomorphism .",
    "we say that the _ twist condition holds on the boundary _",
    "@xmath147 when @xmath97 can be smoothly extended to @xmath144 and its extended lift satisfies that @xmath149 for all @xmath150 .",
    "analogous definitions can be written for the upper boundary @xmath151 when @xmath152 is finite .",
    "we recall that @xmath96 is a lift of @xmath97 .",
    "next , we present a version of lemma  [ lem : order2 ] for the boundaries of the cylinder .",
    "the only remarkable difference is that the exact symplectic form @xmath98 may vanish on the boundaries .",
    "[ lem : order2_boundaries ] if @xmath106 is an analytic exact twist map such that @xmath142 is finite , @xmath153 is a @xmath1-resonant boundary , @xmath97 can be analytically extended to @xmath144 , @xmath100 can be analytically extended to @xmath154 , and the twist condition holds on @xmath147 , then there exist an analytic strip width @xmath118 , an analytic radius @xmath119 , and some analytic coordinates @xmath66 such that @xmath155 and the power map @xmath117 satisfies the properties ( i)(iii ) given in lemma  [ lem : order2 ] .",
    "an analogous result holds for the upper boundary @xmath151 when @xmath152 is finite .    if @xmath156 , then @xmath157 and the extended power map @xmath128 has the form  ( [ eq : varphi_psi ] ) for some real analytic @xmath33-periodic functions @xmath130 and @xmath131 .",
    "the twist condition on @xmath147 implies that @xmath130 is positive .",
    "since @xmath100 is analytic in @xmath154 and @xmath158 is positive in @xmath159 , we deduce that @xmath160 for some @xmath161 and some integer @xmath162 .",
    "the preservation of @xmath101 implies that @xmath163 .",
    "next , we consider the analytic coordinates @xmath66 defined by @xmath164 where the constant @xmath135 is determined in such a way that the angular coordinate @xmath136 is defined modulus one .",
    "the rest of the proof follows the same lines as in lemma  [ lem : order2 ] .",
    "we just note that the intersection property on a ( real ) neighbourhood of the boundary @xmath147 follows by analytic extension , since @xmath139 preserves the exact symplectic form @xmath101 for negative values of @xmath165 too .",
    "we unify the resonant rics studied in lemma  [ lem : order2 ] and the resonant boundaries studied in lemma  [ lem : order2_boundaries ] as a single object for the sake of brevity .",
    "[ defi : c ] let @xmath94 be an analytic map .",
    "let @xmath110 and @xmath166 be two relatively prime integers .",
    "let @xmath167 and @xmath119 .",
    "we say that @xmath107 ( respectively , @xmath168 for a finite @xmath142 or @xmath169 for a finite @xmath152 ) is a _",
    "@xmath170-analytic @xmath1-resonant ric _ when @xmath109 is an analytic @xmath1-resonant ric ( respectively , @xmath1-resonant boundary ) and there exist some coordinates @xmath66 such that @xmath171 and the power map @xmath117 satisfies the properties ( i)(iii ) stated in lemma  [ lem : order2 ] .",
    "the map  ( [ eq : order2 ] ) can be viewed as a perturbation of the integrable twist map @xmath172 we want to reduce the size of the nonintegrable terms @xmath173 and @xmath174 as much as possible .",
    "we can reduce them through normal form steps up to any desired order ; see lemma  [ lem : beyondallorders ] .",
    "thus , the nonintegrable part of the dynamics is beyond all order in @xmath175 ; that is , in the distance to the resonant ric ( or resonant boundary ) .",
    "a general principle in conservative dynamical systems states that beyond all order phenomena are often exponentially small in the analytic category .",
    "our goal is to write the map as an exponentially small perturbation in @xmath175 of the integrable twist map  ( [ eq : integrablemap ] ) .",
    "the final result is stated in the following theorem .",
    "[ thm : remainder ] let @xmath176 be an analytic map with a @xmath170-analytic ric @xmath109 of fixed points such that @xmath107 , @xmath168 for a finite @xmath142 , or @xmath169 for a finite @xmath152 .",
    "let @xmath177 be an arbitrary order .",
    "let @xmath73 .",
    "there exist constants @xmath178 and @xmath179 such that , if @xmath180 , then there exists an analytic change of variables @xmath181 such that :    1 .",
    "it is uniformly ( with respect to @xmath182 ) close to the identity on @xmath183 .",
    "that is , @xmath184 = 1 + \\or(\\eta),\\ ] ] for all @xmath185 , where the @xmath186 and @xmath187 terms are uniform in @xmath182 ; and 2 .",
    "the transformed map @xmath188 is real analytic and has the intersection property on the cylinder @xmath183 . besides , it has the form @xmath189 where @xmath190 and @xmath191 for all @xmath192 .",
    "the proof can be found in section  [ sec : proofremainder ] .    consider a perturbed hamiltonian system which is close to an integrable system .",
    "it is known that , under the appropriate nondegeneracy conditions , the measure of the set of tori which decompose under the perturbation can be bounded from above by a quantity of order @xmath193 , @xmath194 being the perturbation parameter  @xcite .",
    "neishtadt  @xcite also considered a context where the perturbation becomes exponentially small in some parameter @xmath194 and hence the measure of the complementary set which is cut out from phase space by the invariant tori is of order @xmath195 , @xmath196 being a positive constant .",
    "this argument could be applied to our context .",
    "first , any neighbourhood of an analytic resonant ric ( or resonant boundary ) of an analytic exact twist map contains infinitely many rics .",
    "second , the area of the complementary of the rics in any of such neighbourhoods is exponentially small in the size of the neighbourhood .",
    "third , the gaps between the rics are exponentially small in their distance to the resonant ric .",
    "the first result follows from the classical moser twist theorem  @xcite .",
    "the others follow from the ideas explained above .",
    "let @xmath116 , with @xmath87 , be a fixed exact symplectic form on the open cylinder @xmath84 , with @xmath197 .",
    "let @xmath106 be an exact twist map that can be extended as rigid rotations of angles @xmath198 and @xmath199 to the boundaries @xmath153 and @xmath151 , respectively .",
    "we know that @xmath200 from the twist condition .",
    "let @xmath201 be a fixed lift of @xmath97 .",
    "let @xmath202 .",
    "then there exists a function @xmath203 , determined modulo an additive constant , such that @xmath204 the function @xmath91 is called the _",
    "lagrangian _ or _ generating function _ of @xmath97 .",
    "let @xmath9 and @xmath6 be two relatively prime integers such that @xmath205 and @xmath206 .",
    "a point @xmath207 is @xmath0__-periodic _ _ when @xmath208 .",
    "the corresponding point @xmath209 is a periodic point of period @xmath6 by @xmath97 that is translated @xmath9 units in the base by the lift .",
    "a @xmath0-periodic orbit is _ birkhoff _ when it is ordered around the cylinder in the same way that the orbits of the rigid rotation of angle @xmath2 .",
    "see  @xcite for details .",
    "the poincar - birkhoff theorem states that there exist at least two different birkhoff @xmath0-periodic orbits  @xcite .",
    "let @xmath210 be a @xmath0-periodic orbit .",
    "its @xmath0__-periodic action _ _ is @xmath211 = h(s_0,s_1 ) + h(s_1,s_2 ) + \\cdots + h(s_{q-1},s_0 + p).\\ ] ] our goal is to establish an exponentially small bound for the non - negative quantity @xmath212 - w^{(p , q)}[o ] \\right|,\\ ] ] where @xmath213 denotes the set of all birkhoff @xmath0-periodic orbits of the exact twist map @xmath97 .",
    "the difference of @xmath0-periodic actions can be interpreted as the @xmath101-area of certain domains .",
    "let us explain it .",
    "let @xmath214 and @xmath215 be two @xmath0-periodic orbits .",
    "we can assume , without loss of generality , that @xmath216 .",
    "let @xmath217 be a curve from @xmath218 to @xmath219 contained in @xmath85 .",
    "set @xmath220 .",
    "the curves @xmath217 and @xmath221 have the same endpoints in @xmath84 .",
    "let us assume that these two curves have no topological crossing on the cylinder @xmath84 and let @xmath222 be the domain enclosed between them .",
    "observe that @xmath223 .",
    "hence , @xmath224 , where the sign @xmath225 depends on the orientation of the closed path @xmath226 , but we do not need it , because we take absolute values in both sides of the previous relation : @xmath227 - w^{(p , q)}[o ] \\right| = \\int_b \\omega = : { \\mathop{\\rm area}\\nolimits}_\\omega [ b].\\ ] ]",
    "these arguments go back to the _ mackay - meiss - percival action principle _  @xcite . if the curves @xmath217 and @xmath228 have some topological crossing , then the domain @xmath229 has several connected components , in which case @xmath230 - w^{(p , q)}[o ] \\right| \\le \\int_b \\omega = : { \\mathop{\\rm area}\\nolimits}_\\omega [ b]$ ] , because the sign in front of the integral of the area form @xmath101 depends on the connected component .",
    "if the analytic exact twist map @xmath97 has a @xmath1-resonant ric , then @xmath231 indeed , we can take a segment of the ric as the curve @xmath217 used in the previous construction in such a way that @xmath232 and @xmath233 = 0 $ ] .",
    "it turns out that the differences of @xmath0-periodic actions of @xmath97 are exponentially small when @xmath2 is `` sufficiently close '' to @xmath3 .",
    "the meaning of `` sufficiently close '' is clarified in the following theorem .",
    "see also remark  [ rem : sufficientlyclose ] .",
    "[ thm : asymptotic ] let @xmath234 be an analytic exact twist map that can be extended as rigid rotations of angles @xmath198 and @xmath199 to the boundaries @xmath153 and @xmath151 , respectively .",
    "we also assume that @xmath97 has a @xmath170-analytic @xmath1-resonant ric @xmath107 , @xmath168 for a finite @xmath142 , or @xmath169 for a finite @xmath152 .",
    "let @xmath73 and @xmath54 .",
    "there exist @xmath235 such that @xmath236 for all relatively prime integers @xmath9 and @xmath6 with @xmath76 and @xmath31 .",
    "the proof has been placed at section  [ sec : proofthmasymptotic ] .",
    "[ rem : tendingtoboundaryrics ] if @xmath168 ( respectively , @xmath169 ) , the bound  ( [ eq : deltabound ] ) only makes sense as @xmath2 tends to the boundary rotation number @xmath148 ( respectively , @xmath237 ) from the right : @xmath238 ( respectively , from the left : @xmath239 ) .",
    "we will see several examples of this situation in sections  [ sec : lengthspectrum ] and  [ sec : areaspectrum ] .",
    "[ rem : infinitevalues ] infinite values of @xmath240 can also be dealt with .",
    "for instance , if @xmath241 , then we consider the coordinate @xmath242 and we assume that : 1 ) @xmath243 is a @xmath1-resonant boundary ; 2 ) @xmath97 can be analytically extended to @xmath244 ; 3 ) @xmath245 with @xmath246 for some real number @xmath247 and some integer @xmath248 ; 4 ) @xmath117 has the form  ( [ eq : varphi_psi ] ) for some real analytic @xmath33-periodic functions @xmath130 and @xmath131 ; and 5 ) @xmath130 is negative .",
    "then the change @xmath249 transforms the infinite setup into a finite one , so theorem  [ thm : asymptotic ] still holds .",
    "we just mention two subtle points .",
    "first , the change  ( [ eq : analyticcoordinates_xy ] ) is not well - defined when @xmath250 .",
    "thus , @xmath251 can have a pole at @xmath252 , provided it is not a double one .",
    "second , @xmath130 is negative because the change @xmath249 reverses the orientation , and so , it changes the sign of the twist .",
    "[ rem : sufficientlyclose ] condition @xmath253 implies that @xmath254 as @xmath12 .    in many applications , @xmath109 is a ric of fixed points ; that is , a @xmath255-resonant ric .",
    "then theorem  [ thm : asymptotic ] implies that @xmath58 is exponentially small in the period @xmath6 when @xmath9 remains uniformly bounded . to be precise , if @xmath73 and @xmath54 , there exist @xmath235 such that @xmath256 for all relatively prime integers @xmath9 and @xmath6 with @xmath77 and @xmath257 .",
    "we recall some well - known results about billiards that can be found in  @xcite .",
    "let @xmath7 be a closed strictly convex curve in the euclidean plane @xmath258 .",
    "we assume , without loss of generality , that @xmath7 has length one .",
    "let @xmath150 be an arc - length parameter on @xmath7 .",
    "set @xmath259 .",
    "let @xmath176 , @xmath260 , be the map that models the billiard dynamics inside @xmath7 using the _ birkhoff coordinates _",
    "@xmath83 , where @xmath150 determines the impact point on the curve , and @xmath261 denotes the angle of incidence .",
    "the map @xmath139 preserves the exact symplectic form @xmath262 and has the intersection property .",
    "indeed , @xmath263 is an exact twist map with boundary rotation numbers @xmath264 and @xmath265 . besides , its lagrangian is the distance between consecutive impact points .",
    "finally , @xmath139 is analytic when @xmath7 is analytic .",
    "any @xmath0-periodic orbit on the billiard map forms a a closed inscribed polygon with @xmath6 sides that makes @xmath9 turns inside @xmath7 .",
    "since the lagrangian of the billiard map is the distance between consecutive impact points , the periodic action of a periodic orbit is just the total length of the corresponding polygon .",
    "therefore , the supremum action difference among @xmath0-periodic billiard orbits is the supremum length difference among inscribed billiard @xmath0-polygons .",
    "let us check that the boundary @xmath266 satisfies the hypotheses stated in theorem  [ thm : asymptotic ] .",
    "[ pro : classicalextensiontoboundary ] if @xmath139 is the billiard map associated to an analytic strictly convex curve @xmath7 , the boundary @xmath147 is a @xmath170-analytic @xmath255-resonant ric of @xmath139 for some @xmath118 and @xmath119 .",
    "the lower boundary @xmath147 is a @xmath255-resonant because @xmath264 .",
    "clearly , @xmath267 is finite and the function @xmath268 can be analytically extended to @xmath269 .",
    "hence , in order to end the proof we only need to prove that the billiard map @xmath139 can be analytically extended to @xmath270 and the twist condition holds on @xmath147 ; see lemma  [ lem : order2_boundaries ] .",
    "let @xmath271 , @xmath272 , and @xmath273 be an arc - length parametrization , the curvature , and a unit normal vector of the analytic strictly convex curve linked by the relation @xmath274 .",
    "we write the angle of incidence as a function of consecutive impact points : @xmath275 . if @xmath276 , then @xmath277 is analytic , @xmath278 , and @xmath279 .",
    "the last property follows from the twist character of the billiard map .",
    "let us study what happens on @xmath147 ; or , equivalently , what happens in the limit @xmath280 .",
    "we note that @xmath281 is the angle between @xmath282 and @xmath283 .",
    "hence , @xmath284 this expression shows that @xmath277 is analytic when @xmath285 and @xmath286 . besides , @xmath287 for all @xmath150 , which implies that @xmath288 is an analytic diffeomorphism that maps a neighbourhood of the diagonal in @xmath289 to a neighborhood of the lower boundary @xmath266 .",
    "next , we write the billiard map @xmath260 as the composition of three maps : @xmath290 we have already seen that the first map is analytic in a neighborhood of @xmath147 . clearly , the second map is analytic .",
    "the third one is also analytic , because @xmath291 by definition of billiard map .",
    "thus , @xmath139 can be analytically extended to @xmath270 .",
    "the twist condition on @xmath147 follows from inequality  ( [ eq : twistboundarybilliard ] ) .",
    "we can compare the coordinates  ( [ eq : analyticcoordinates_xy ] ) with the coordinates defined by lazutkin in  @xcite .",
    "we note that @xmath292 , so @xmath293 in the change  ( [ eq : analyticcoordinates_xy ] ) .",
    "if @xmath294 is the radius of curvature of @xmath7 , then the taylor expansion around @xmath295 of the billiard map is @xmath296 from this taylor expansion , lazutkin deduced that the billiard map takes the form @xmath297 in the analytic _ lazutkin coordinates _",
    "@xmath66 defined by @xmath298 the constant @xmath135 has , once more , been determined in such a way that the new angular coordinate @xmath136 is defined modulus one .",
    "lazutkin s results are more refined , he wrote the billiard map as a smaller perturbation of the integrable twist map @xmath68 , but we do not need it .    by direct application of proposition  [ pro : classicalextensiontoboundary ] and theorem  [ thm : asymptotic ] , we get the following exponentially small upper bound of the quantities @xmath11 defined in the introduction .",
    "[ thm : classicalboundary ] let @xmath7 be an analytic strictly convex curve in the euclidean plane .",
    "let @xmath118 be the analyticity strip width of the lower boundary @xmath147 .",
    "let @xmath73 and @xmath54 .",
    "there exist a constant @xmath178 and a period @xmath299 such that @xmath300 for all relatively prime integers @xmath9 and @xmath6 with @xmath77 and @xmath301 .",
    "the same exponentially small upper bound holds for analytic geodesically strictly convex curves on surfaces of constant curvature , where the billiard trajectories are just broken geodesics .",
    "billiard maps on the klein model of the hyperbolic plane @xmath302 and on the positive hemisphere @xmath303 have been studied , for instance , in  @xcite , where it is shown that they are exact twist maps with the same boundary rotation numbers as in the euclidean case .",
    "therefore , by local isometry arguments , we can write a version of theorem  [ thm : classicalboundary ] on any surface of constant curvature .      a smooth closed convex curve is of _ constant width _ if and only if it has a chord in any direction perpendicular to the curve at both ends .",
    "billiards inside convex curves of constant width have a nice property  @xcite .",
    "let us explain it .",
    "the billiard map associated to a smooth convex curve of constant width has the horizontal line @xmath304 as a resonant @xmath28-ric .",
    "any trajectory belonging to that ric is orthogonal to the curve at its two endpoints . due to the variational formulation ,",
    "all the @xmath28-periodic orbits are extrema of the @xmath28-periodic action and , thus , all @xmath28-periodic trajectories have the same length , which is the reason we refer to them as constant width curves .",
    "another characterization of constant width curves is the following .",
    "we reparametrize the curve by using the angle @xmath305 between the tangent vector at a point in the curve and some fixed line .",
    "let @xmath306 be the radius of curvature at this point .",
    "the curve has constant width if and only if the fourier series of @xmath306 contains no other even coefficients than the constant term .",
    "thus , the space of analytic constant width curves has infinite dimension and codimension .",
    "theorem  [ thm : asymptotic ] can be directly applied in this context and we have the following result .",
    "let @xmath94 be the billiard map of an analytic strictly convex curve of constant width .",
    "let @xmath118 be the analyticity strip width of the @xmath28-resonant ric of @xmath97 .",
    "let @xmath73 and @xmath54 .",
    "there exist a constant @xmath307 and a period @xmath299 such that @xmath308 for all relatively prime integers @xmath9 and @xmath6 such that @xmath56 and @xmath31 .",
    "one could try to generalize constant width billiards , where @xmath309 is a @xmath28-resonant ric , to _ constant angle tables _",
    ", where @xmath310 is assumed to be a @xmath1-resonant ric . however , the only table such that @xmath310 is a @xmath1-resonant ric , with @xmath311 , is the circle .",
    "see  @xcite . by the way , theorem  [ thm : asymptotic ] applies to this case but , since the circular billiard is integrable , @xmath312 , for all @xmath1 .",
    "in fact , the circular billiard map is globally conjugated to the integrable twist map  ( [ eq : integrablemap ] ) .",
    "there are more billiard tables with resonant rics , but their rics are not horizontal . for instance , the elliptic table has all possible @xmath1-resonant rics , but the @xmath28-resonant one . hence , in this case , @xmath313 .",
    "baryshnikov and zharnitsky  @xcite proved that an ellipse can be infinitesimally perturbed so that any chosen resonant ric will persist .",
    "innami  @xcite found a condition on the billiard table that guarantees the existence of a @xmath314-resonant ric .",
    "however , theorem  [ thm : asymptotic ] can not be applied in such cases , because both the baryshnikov - zharnitsky and the innami constructions are done in the smooth category , where we can only claim that @xmath11 is beyond all order in the difference between rotation numbers .",
    "we recall some well - known facts about dual billiards that can be found in  @xcite .",
    "let @xmath7 be a strictly convex closed curve in the euclidean plane @xmath258 .",
    "let @xmath39 be the unbounded component of @xmath315 .",
    "the dual billiard map @xmath41 is defined as follows : @xmath42 is the reflection of @xmath43 in the tangency point of the oriented tangent line to @xmath7 through @xmath43 .",
    "this map is area - preserving .",
    "next , we introduce the _ envelope coordinates",
    "_ @xmath316 of a point @xmath317 . in this section , @xmath318 and @xmath319 .",
    "we recall that @xmath320 .",
    "given a point @xmath317 , let @xmath321 be the angle made by the positive tangent line to @xmath7 in the direction of @xmath43 with a fixed direction of the plane , and let @xmath261 be the distance along this line from @xmath7 to @xmath43 .",
    "see figure  [ fig : dualenvelopecoordinates ] .     and the dual billiard map @xmath322.,scaledwidth=80.0% ]    the dual billiard map preserves the exact symplectic form @xmath323 , and it has the intersection property .",
    "indeed , @xmath324 , @xmath325 , is an exact twist map with boundary rotation numbers @xmath264 and @xmath326 .",
    "its lagrangian is the area enclosed by @xmath7 and the tangent lines through the points on @xmath7 with coordinates @xmath32 and @xmath327 .    any @xmath0-periodic orbit on the dual billiard map forms a closed circumscribed polygon with @xmath6 sides that makes @xmath9 turns outside @xmath7 .",
    "since the lagrangian of the dual billiard map is the above - mentioned area , the periodic action of a periodic orbit is just the area enclosed between the corresponding polygon and @xmath7 , taking into account some multiplicities when @xmath44 .",
    "therefore , the supremum action difference among @xmath0-periodic dual billiard orbits is the supremum area difference among circumscribed dual billiard @xmath0-polygons .",
    "we note that @xmath328 when the point @xmath317 approaches to the curve @xmath7 .",
    "therefore , in order to study the dual billiard dynamics close to @xmath7 , we must study the dual billiard map @xmath139 in a neighbourhood of the lower boundary @xmath329 of @xmath330 .",
    "let us check that @xmath147 satisfies the hypotheses stated in theorem  [ thm : asymptotic ] .",
    "[ pro : dualextensiontoboundary ] if @xmath139 is the dual billiard map associated to an analytic strictly convex curve @xmath7 , the lower boundary @xmath147 is an @xmath170-analytic @xmath255-resonant ric of @xmath139 for some @xmath118 and @xmath119 .",
    "the lower boundary @xmath147 is a @xmath255-resonant because @xmath264 .",
    "clearly , @xmath267 is finite and the function @xmath331 can be analytically extended to @xmath332 .",
    "hence , in order to end the proof we only need to prove that the dual billiard map @xmath139 can be analytically extended to @xmath333 and the twist condition holds on @xmath147 ; see lemma  [ lem : order2_boundaries ] .",
    "we write the distance @xmath281 as a function of consecutive tangent points : @xmath334 .",
    "we know that @xmath335 is analytic , @xmath336 , and @xmath337 when @xmath338 . and @xmath339 are parallel , so @xmath340 . ]",
    "the last property follows from the twist character of the dual billiard map .",
    "let us study what happens on @xmath147 ; or , equivalently , what happens in the limit @xmath341 .",
    "let @xmath342 be the radius of curvature of @xmath7 in the angular coordinate @xmath32 .",
    "set @xmath343 . from boyland  @xcite",
    ", we know that @xmath344 this expression shows that @xmath335 is analytic when @xmath345 and @xmath346 . by derivating relation  ( [ eq : rfromalphas ] ) with respect to @xmath327 , we get that @xmath347 for all @xmath321 , which implies that @xmath348 is an analytic diffeomorphism that maps a neighbourhood of the diagonal in @xmath349 to a neighborhood of the lower boundary @xmath329 .",
    "next , we write the billiard map @xmath325 as the composition of three analytic maps : @xmath350 thus , @xmath139 can be analytically extended to @xmath333 .",
    "the twist condition on @xmath147 follows from inequality  ( [ eq : twistboundarydualbilliard ] ) .",
    "we can compare the coordinates  ( [ eq : analyticcoordinates_xy ] ) with the coordinates defined by tabachnikov in  @xcite .",
    "we note that @xmath351 , so @xmath293 in the change  ( [ eq : analyticcoordinates_xy ] ) .",
    "if @xmath352 is the curvature of @xmath7 , then the taylor expansion around @xmath295 of the dual billiard map is @xmath353 ( tabachnikov wrote this taylor expansion in coordinates @xmath83 , where @xmath18 is an arc - length parameter , but his result can be easily adapted . ) from this taylor expansion , one deduces that the dual billiard map takes the form  ( [ eq : order2 ] ) in the analytic _ tabachnikov coordinates _",
    "@xmath354 the constant @xmath135 has been determined in such a way that @xmath136 is defined modulus one : @xmath137 .",
    "we get the following exponentially small upper bound of the quantities @xmath59 defined in the introduction by direct application of proposition  [ pro : dualextensiontoboundary ] and theorem  [ thm : asymptotic ] .",
    "[ thm : dualboundary ] let @xmath7 be an analytic strictly convex curve in the euclidean plane . let @xmath118 be the analyticity strip width of the lower boundary @xmath147 .",
    "let @xmath73 and @xmath54 .",
    "there exist a constant @xmath178 and a period @xmath299 such that @xmath355 for all relatively prime integers @xmath9 and @xmath6 with @xmath77 and @xmath301 .",
    "tabachnikov  @xcite studied the dual billiard map in the hyperbolic plane @xmath302 , and extended the asymptotic expansion  ( [ eq : asymptoticarea ] ) to that new setting .",
    "he also claimed that there exists an analogous formula for dual billiards on the unit sphere @xmath356 .",
    "therefore , by local isometry arguments , we can write a version of theorem  [ thm : dualboundary ] on any surface of constant curvature .      we note that @xmath357 when the point @xmath317 moves away from the curve @xmath7 .",
    "we use the coordinates @xmath358 to work at infinity , where @xmath242 and @xmath316 are the coordinates introduced in subsection  [ ssec : dualbilliards ] .",
    "the exact symplectic form @xmath359 becomes @xmath360 in coordinates @xmath358 .",
    "tabachnikov  @xcite realized that the dual billiard map at infinity can be seen as a map defined in a neighbourhood of the @xmath28-resonant ric @xmath361 . to be precise",
    ", he saw that the dual billiard map can be analytically extended to @xmath244 , its square has the form @xmath362 for some real analytic @xmath33-periodic functions @xmath363 and @xmath364 , and @xmath363 is negative .",
    "hence , the following result is deduced from remark  [ rem : infinitevalues ] .",
    "[ thm : dualinfinity ] let @xmath7 be an analytic strictly convex curve in the euclidean plane .",
    "let @xmath118 be the analyticity strip width of the boundary @xmath365 .",
    "let @xmath73 and @xmath54 .",
    "there exist a constant @xmath178 and a period @xmath299 such that @xmath366 for all relatively prime integers @xmath9 and @xmath6 such that @xmath56 and @xmath31 .",
    "let @xmath367 , with @xmath368 and @xmath369 , be the space of all analytic functions @xmath97 defined on the open set @xmath370 where @xmath371 denotes the @xmath135-th fourier coefficient of the @xmath33-periodic function @xmath372 and @xmath373 denotes its sup - norm on the complex open ball @xmath374 .",
    "let @xmath375 be the sup - norm on @xmath376 .",
    "let @xmath377 be the space of all vectorial functions @xmath378 of the form @xmath379 such that @xmath380 .",
    "the space @xmath381 is a banach space with the fourier norm @xmath382 the sup - norm @xmath383 on @xmath381 is defined analogously .",
    "let @xmath384 be the average of @xmath385 .",
    "let @xmath386 be the direct decomposition where @xmath387 is the vectorial subspace of the elements of the form @xmath388 , whereas @xmath389 is the one of the elements with @xmath390 .",
    "let @xmath391 and @xmath392 be the associated projections .",
    "thus , any @xmath393 can be decomposed as @xmath394 , where @xmath395 obviously , @xmath396 and @xmath397    we will always denote the scalar functions in @xmath367 with lower - case letters , and the vectorial functions in @xmath377 with upper - case letters .",
    "asterisk and bullet superscripts in upper - case letters stand for the @xmath398-projections and @xmath399-projections of vectorial functions in @xmath377 , respectively .",
    "asterisk superscripts in lower - case letters denote averages of scalar functions in @xmath367 .",
    "we will always write the couple of scalar functions associated to any given vectorial function of @xmath377 with the corresponding lower - case letter and the subscripts @xmath400 .",
    "hat symbols denote fourier coefficients .",
    "henceforth , let @xmath401 be the integrable twist map introduced in  ( [ eq : integrablemap ] ) .",
    "let @xmath402 be a map satisfying the properties listed in lemma  [ lem : order2 ] , so @xmath403 for some @xmath404 , where @xmath405 is the analyticity strip width in the angular variable @xmath136 , and @xmath406 is the analyticity radius in @xmath175 .",
    "hence , @xmath407 is a perturbation of @xmath408 of order two .",
    "the following lemma allows us to increase that order as much as we want by simply losing as little analyticity strip width as we want .",
    "it is based on classical averaging methods . in particular",
    ", we see that @xmath409 is a perturbation beyond all order of @xmath408 .",
    "[ lem : beyondallorders ] let @xmath403 , with @xmath404 and @xmath410 and @xmath411 , be a real analytic map with the intersection property on the cylinder @xmath412 .",
    "let @xmath413 be an integer .",
    "let @xmath414 be any analyticity strip width such that @xmath415 .",
    "there exist an analyticity radius @xmath416 and a change of variables of the form @xmath417 for some @xmath418 such that the transformed map @xmath419 is real analytic , has the intersection property on the cylinder @xmath420 , and has the form @xmath421 for some @xmath422 .",
    "besides , the change of variables @xmath423 is close to the identity on @xmath420 .",
    "that is , @xmath424 = 1 + \\or(y),\\ ] ] uniformly for all @xmath425 .",
    "the change @xmath423 is the composition of @xmath426 changes of the form @xmath427 where @xmath428 , @xmath429 , @xmath430 is a positive decreasing sequence , and @xmath431 is constructed as follows to increase the order of the perturbation from @xmath432 to @xmath433 .    let us suppose that we have a real analytic map with the intersection property on @xmath434 of the form @xmath435 , for some @xmath436 with @xmath437 and @xmath438 .",
    "we begin with a formal computation .",
    "we write @xmath439 where the functions @xmath440 and @xmath441 are 1-periodic and analytic on the open complex strip @xmath442 .",
    "we will see , by using an _ a posteriori _ reasoning , that the intersection property implies that @xmath441 has zero average ; that is , @xmath443 .",
    "nevertheless , we can not prove it yet .",
    "thus , we will keep an eye on @xmath444 in what follows .    if we take the change of variables @xmath445 for some functions @xmath446 and @xmath447 , then , after a straightforward computation , the map @xmath448 has the form @xmath449 with @xmath450 and @xmath451 .",
    "therefore , we take @xmath452 so that @xmath453 and @xmath454 . these functions @xmath447 and @xmath446 are 1-periodic , because @xmath455 and @xmath456 have zero average . besides , @xmath446 and @xmath447 are analytic in the open complex strip @xmath457 . indeed ,",
    "@xmath458 with @xmath459 .    next , we control the domain of definition of the map @xmath460 .",
    "the inverse change is @xmath461 thus , the maps @xmath462 , @xmath463 , and @xmath464 have the form @xmath465 , since @xmath438 . consequently , if @xmath466 is small enough , then @xmath467 so @xmath468 is well - defined on @xmath469 .",
    "now , let us check that @xmath470 .",
    "at this moment , we only know that @xmath471 since the change of variables has not eliminated the average @xmath444 .",
    "the map @xmath460 has the intersection property on the cylinder @xmath472 , because the intersection property is preserved by changes of variables .",
    "this implies that @xmath470 . on the contrary ,",
    "the image of the loop @xmath473 does not intersect itself when @xmath474 .",
    "finally , properties  ( [ eq : changephi_m ] ) follow directly from the fact that we have performed a finite number of changes , all of them satisfying these same properties .",
    "next , the following theorem provides the exponentially small bound for the @xmath399-projection of the residue provided an initial order @xmath110 big enough .",
    "it is the main tool to prove theorem  [ thm : remainder ] .",
    "[ thm : technical ] let @xmath475 be an integer , @xmath476 , @xmath477 , and @xmath478 . there exist constants @xmath479 and @xmath480 , @xmath481 , such that , if @xmath482 and @xmath483 then there exists a change of variables @xmath484 satisfying the following properties :    1 .",
    "@xmath485 with @xmath486 ; and 2 .",
    "the transformed map @xmath487 is real analytic , has the intersection property on the cylinder @xmath488 , and has the form @xmath489 , @xmath490 , @xmath491    theorem  [ thm : technical ] is proved in subsection  [ sec : proofthmtechnical ] .    in order to present the main ideas of the proof ,",
    "let us try to completely get rid of the remainder of the map of the form @xmath492 , for some @xmath393 , with a change of variables of the form @xmath493 , for some @xmath494 . concretely",
    ", we look for @xmath495 such that @xmath496 , or , equivalently , we look for @xmath497 such that @xmath498 it is not possible to solve this equation in general . instead , we consider the linear equation @xmath499 this vectorial equation reads as @xmath500 therefore , we need to solve two linear equations of the form @xmath501 where @xmath502 is known . if the average of @xmath503 is different from zero : @xmath504 , then this equation can not be solved .",
    "besides , it is a straightforward computation to check that , if @xmath505 , the formal solution of this equation in the fourier basis is @xmath506 whereas the zero - th coefficient @xmath507 can be chosen arbitrarily . from  ( [ eq : fouriercoefficient ] ) , it is clear that  ( [ eq : linearsingle ] ) can not be solved unless @xmath97 has only a finite number of harmonics and zero average . for this reason , given a function @xmath503 with zero average , we define its @xmath78__-cut off _ _ as @xmath508 let @xmath78 be such that @xmath509 for all @xmath510 and @xmath511 . hence , we will take @xmath512 for some fixed @xmath513 , and we will actually solve truncated linear equations of the form @xmath514 the fourier norm is specially suited to analyse this kind of equations ; see lemma  [ lem : linearsingle ] .    summarizing these ideas ,",
    "we look for a change of variables of the form @xmath515 , where @xmath497 satisfies the truncated linear vectorial equation @xmath516 where @xmath517 denotes the @xmath78-cut off of @xmath518 .",
    "the average of the first component of @xmath517 may be non - zero .",
    "equation  ( [ eq : truncatedlineardouble ] ) is studied in lemma  [ lem : lineardouble ] .",
    "this close to the identity change of variables @xmath515 does not completely eliminate the remainder .",
    "however , if @xmath182 is small enough , it reduces the size of the @xmath399-projection of the remainder as the following lemma shows .",
    "[ lem : iterative ] let @xmath475 be an integer , @xmath476 , @xmath477 , @xmath519 , and @xmath520 . there exist a constant @xmath521 such that if @xmath522 with @xmath523 then there exists a change of variables @xmath524 satisfying the following properties :    1 .",
    "@xmath494 is a solution of the truncated linear equation  ( [ eq : truncatedlineardouble ] ) such that @xmath525 where @xmath526 is defined in lemma  [ lem : lineardouble ] ; and 2 .",
    "the transformed map @xmath527 is real analytic , has the intersection property on the cylinder @xmath528 , and has the form @xmath529 , @xmath530 , @xmath531 where @xmath532 and @xmath533 .    if @xmath532 , then @xmath534 .",
    "the proof of this lemma is found in subsection  [ ssec : proofofiterativelemma ] .",
    "some technicalities in the proof require the use of the sup - norm , which forces us to deal with both the fourier norm and the sup - norm .",
    "the relations between them are stated in lemma  [ lem : normbounds ] .",
    "finally , theorem  [ thm : technical ] is obtained by means of a finite sequence of changes of variables like the ones described in the iterative lemma .",
    "we want to perform as many of such changes as possible because each change reduces the size of the @xmath399-projection of the remainder by the factor @xmath535 .",
    "since the loss of analyticity in the angular variable is @xmath536 , then we can at most perform a number @xmath537 of such changes .",
    "this idea goes back to neishtadt  @xcite .",
    "the intersection property is used neither in the proof of the iterative lemma nor in the proof of theorem  [ thm : technical ] , but will be essential to control the size of the @xmath398-projections of the remainders in terms of the size of their @xmath399-projections later on .",
    "[ lem : normbounds ] let @xmath538 , @xmath539 , and @xmath502 .",
    "let @xmath540 , with @xmath541 the @xmath78-cut off of @xmath97 , defined in  ( [ eq : kcutoff ] ) . then :    1 .",
    "@xmath542 , 2 .",
    "@xmath543 , 3 .",
    "@xmath544 , and 4 .   @xmath545 .",
    "if @xmath546 , then these bounds also hold for any vectorial function @xmath393 .    first , the fourier norm of @xmath541 is a partial sum of the fourier norm of @xmath97 .",
    "second , @xmath547 .",
    "third , @xmath548 , for all @xmath549 .",
    "fourth , we recall that the fourier coefficients of the analytic function @xmath97 satisfy the inequality @xmath550 for all @xmath551 . hence , @xmath552 where we have used that @xmath553 for all @xmath554 .",
    "the last part follows from the definition of the norms @xmath555 and @xmath383 .",
    "[ lem : linearsingle ] if @xmath556 , @xmath557 , and @xmath502 is a function with zero average , then the truncated linear equation  ( [ eq : truncatedlinearsingle ] ) has a unique solution @xmath558 with zero average and @xmath559 , where @xmath560    the fourier coefficients of @xmath561 must satisfy  ( [ eq : fouriercoefficient ] ) .",
    "we note that @xmath562 for all @xmath556 , since the function @xmath563 is analytic on the open ball @xmath564 .",
    "moreover , @xmath565 for all @xmath566 . finally , we recall that @xmath567 . then we obtain that @xmath568 .",
    "we will denote by @xmath569 the linear operator that sends the independent term @xmath541 of the truncated linear equation  ( [ eq : truncatedlinearsingle ] ) to the solution @xmath561 with zero average .",
    "note that the solution @xmath561 has no harmonics of order @xmath570 .",
    "[ lem : lineardouble ] if @xmath571 , @xmath556 , @xmath557 , and @xmath572 , then the truncated linear equation  ( [ eq : truncatedlineardouble ] ) has a solution @xmath573 such that @xmath574 where @xmath575 , @xmath576 , and @xmath577 is defined in  ( [ eq : omega ] ) .",
    "let @xmath578 and @xmath579 .",
    "then the vectorial equation @xmath580 reads as @xmath581 let @xmath582 and @xmath583 .",
    "these operations are well - defined since both @xmath584 and @xmath585 have zero average . as for the bounds , @xmath586 where we have used lemma  [ lem : linearsingle ]",
    "[ lem : difference ] let @xmath587 , @xmath588 , @xmath589 , @xmath590 , and @xmath591 , such that @xmath592 let @xmath593 .",
    "let @xmath594 .",
    "let @xmath595 with @xmath596 .",
    "let @xmath597 with @xmath598 . then ,    1 .",
    "@xmath599 , 2 .",
    "@xmath600 , and 3 .",
    "@xmath601 .",
    ". then @xmath603 and @xmath604 let @xmath605 , with @xmath606 $ ] fixed .",
    "we deduce from conditions  ( [ eq : abcd ] ) that @xmath607 and @xmath608 belong to @xmath609 for all @xmath610",
    ". therefore , @xmath611 by convexity of the domain , and so , the composition @xmath612 is well - defined on the domain @xmath613 .",
    "a simple computation shows that the product @xmath614 is equal to @xmath615 let us bound the elements above . on the one hand , @xmath616 , @xmath617 , and @xmath618 for all @xmath610 . on the other hand ,",
    "@xmath619 and the cauchy estimates imply that @xmath620 for all @xmath621 $ ] , where @xmath622 . thus , @xmath623 this proves the first item .",
    "the other items follow from the bounds @xmath624 and @xmath625 , since @xmath626 .",
    "[ lem : inverse ] let @xmath627 , @xmath588 , @xmath589 , and @xmath628 such that conditions  ( [ eq : abcd ] ) hold with @xmath629 .",
    "let @xmath515 , with @xmath630 and @xmath631 .",
    "then @xmath632 for all @xmath633 and @xmath634 .",
    "let @xmath635 , where @xmath636 is defined in lemma  [ lem : difference ] .",
    "if @xmath637 , then @xmath495 is invertible and the inverse change @xmath638 satisfies the following properties :    1 .",
    "@xmath639 for some @xmath640 such that @xmath641 , 2 .",
    "@xmath642 for all @xmath643 and @xmath644 , and 3 .",
    "@xmath645 .    note that @xmath646 .",
    "conditions  ( [ eq : abcd ] ) imply that @xmath647 and @xmath648 .",
    "therefore , @xmath632 for all @xmath633 and @xmath634 .",
    "analogously , if @xmath649 and @xmath650 , then @xmath651 for all @xmath643 , @xmath644 .",
    "we denote by @xmath652 the closed ball in @xmath653 of radius @xmath9 in the sup - norm .",
    "let us prove that the functional @xmath654 , @xmath655 , is a well - defined contraction with lipschitz constant @xmath656 first , we observe that @xmath657 so @xmath658 .",
    "second , we bound @xmath659 as follows : @xmath660 the first inequality is direct , and the second comes from lemma  [ lem : difference ] with @xmath661 , @xmath662 , @xmath663 , @xmath664 , @xmath665 , and @xmath666 .",
    "this proves that @xmath667 is a contraction with lipschitz constant  ( [ eq : lipschitzconstant ] ) .",
    "thus , @xmath667 has a unique fixed point @xmath668 which satisfies that @xmath669 on @xmath670 .",
    "therefore , the inverse map @xmath638 exists and equals @xmath671 .",
    "furthermore , @xmath672 follows from  ( [ eq : pnorm ] ) . finally , @xmath673 we have used the second inequality of equation  ( [ eq : contraction ] ) with @xmath674 .",
    "we recall that @xmath492 with @xmath675 , @xmath676 , @xmath677 , @xmath678 , and @xmath475 .",
    "let @xmath679 .",
    "let @xmath680 be the constant introduced in lemma  [ lem : lineardouble ] and @xmath681 .",
    "let @xmath682 be the change of variables where @xmath683 is the solution given in lemma  [ lem : lineardouble ] of the truncated linear equation @xmath684 with @xmath685 , so that @xmath686 for all @xmath687 and @xmath688 .",
    "let @xmath689 be the inverse change studied in lemma  [ lem : inverse ] .",
    "let @xmath690 be the transformed map .",
    "let @xmath691 be the new remainder .",
    "henceforth , we will assume that @xmath32 , @xmath182 , and @xmath692 are some positive constants such that @xmath693    we split the proof in four steps .",
    "_ step 1 : control of the domains . _ note that @xmath694 for all @xmath695 and @xmath696 .",
    "indeed , @xmath697 the behaviours of the changes @xmath495 and @xmath638 follow directly from lemma  [ lem : inverse ] , which can be applied since conditions  ( [ eq : conditions ] ) are more restrictive than the ones required in lemma  [ lem : inverse ] when @xmath698 and @xmath699 .",
    "we also need that @xmath700 and @xmath701 in order to control the inverse @xmath638 , which explains the restrictions on @xmath702 and @xmath703 .",
    "the behaviour of the map @xmath704 follows from the bound @xmath705 and conditions @xmath706 and @xmath707 , which are also a consequence of ( [ eq : conditions ] )",
    ".    _ step 2 : decomposition of the new remainder . _",
    "it turns out that @xmath708 , where @xmath709 indeed , @xmath710 and @xmath711 , so @xmath712 finally , let @xmath713 and @xmath714 .",
    "_ step 3 : bounds of the projections of the new remainder .",
    "_ lemma  [ lem : normbounds ] and the bound  ( [ eq : psigbullet ] ) will be used several times in what follows .",
    "below , we apply lemma  [ lem : difference ] ( twice ) and lemma  [ lem : inverse ] ( once ) .",
    "the required hypotheses in each case are satisfied due to conditions  ( [ eq : conditions ] ) .    * if @xmath715 and @xmath716 , then @xmath717 * if @xmath718 and @xmath719 , then @xmath720 the first inequality follows from lemma  [ lem : difference ] with @xmath721 , @xmath722 , @xmath723 , @xmath724 , @xmath725 , and @xmath699 , so that @xmath726 . * if @xmath727 and @xmath728 , then @xmath729 .",
    "indeed , @xmath730 and @xmath731 we have used that @xmath732 to bound @xmath733 . *",
    "if @xmath718 and @xmath719 , then @xmath734 the first inequality follows from lemma  [ lem : difference ] with @xmath735 , @xmath736 , @xmath737 , @xmath738 , @xmath739 , and @xmath699 , so that @xmath740 . * if @xmath741 and @xmath742 , then @xmath743 the second inequality uses the inclusion @xmath744 .",
    "the fourth one follows from lemma  [ lem : inverse ] with @xmath745 .",
    "we need to verify the hypothesis @xmath746 in this last lemma .",
    "it turns out that @xmath747 , so it suffices to take @xmath748 , with @xmath749 small enough . * if @xmath741 and @xmath742 , then @xmath750 where @xmath751 and the constants @xmath752 , @xmath753 , have been defined previously .",
    "_ step 4 : choice of the loss of analyticity domain .",
    "_ we set @xmath754 and @xmath755 .",
    "if @xmath756 is small enough , then conditions  ( [ eq : conditions ] ) hold for all @xmath748 .",
    "in addition , @xmath757 where @xmath636 is the expression introduced in lemma  [ lem : difference ] .",
    "if we take @xmath758 and @xmath759 , then the bounds of the previous step imply that @xmath760 where @xmath761 .",
    "we recall that @xmath762 , @xmath763 , and @xmath685 . hence ,",
    "if @xmath764 and @xmath749 is small enough , then @xmath765 indeed , @xmath766 if we take a small enough value of @xmath749 .",
    "this ends the proof of the iterative lemma .",
    "set @xmath767 , @xmath768 , and @xmath526 , where the function @xmath769 is defined in lemma  [ lem : lineardouble ] .",
    "let @xmath749 be the positive constant associated to the integer @xmath475 in lemma  [ lem : iterative ] , the numbers @xmath770 , and the exponent @xmath771 .",
    "let @xmath772 , @xmath773 , and @xmath774 .",
    "let us check that @xmath749 , @xmath775 , @xmath776 , and @xmath777 satisfy the properties given in theorem  [ thm : technical ] .",
    "let @xmath778 , @xmath779 , @xmath780 , @xmath781 , @xmath782 be the map given in  ( [ eq : barfv ] ) , @xmath783 , and @xmath784 . by recursively applying lemma  [ lem : iterative ]",
    ", we obtain a sequence of changes of variables @xmath785 , with @xmath786 , and a sequence of maps @xmath787 , with @xmath788 , @xmath789 and @xmath790 , such that @xmath791 with @xmath792 , @xmath793 , @xmath794 , and @xmath795 .",
    "let @xmath796 be the biggest integer satisfying @xmath797 .",
    "the sequences @xmath798 , @xmath799 , and @xmath800 are decreasing .",
    "the sequence @xmath801 is increasing .",
    "indeed , @xmath802 and @xmath803 for all @xmath804",
    ".    we can apply @xmath796 times the iterative lemma .",
    "let @xmath805 be the map obtained after those @xmath796 steps .",
    "then @xmath806 finally , let @xmath807 be the change of variables such that @xmath487 .",
    "we want to check that @xmath484 for some @xmath485 such that @xmath486 .",
    "we note that @xmath808 where each term of the above summation is evaluated at a different argument . nevertheless , those arguments are not important when computing the sup - norm : @xmath809    this ends the proof of theorem  [ thm : technical ] .",
    "let us begin with a simple , but essential , chain of inequalities associated to certain analyticity strip widths that will appear along the proof .",
    "if @xmath73 , then there exists @xmath478 , @xmath521 , and some analyticity strip widths @xmath810 , @xmath811 , and @xmath812 , such that @xmath813 the first two reductions ( that is , from @xmath71 to @xmath810 and from @xmath810 to @xmath414 ) are as small as we want",
    ". the third reduction ( from @xmath811 to @xmath814 ) should be a little bigger than @xmath32 in order to get the desired exponentially small upper bound with the exponent @xmath32 .",
    "the fourth reduction ( that is , from @xmath812 to @xmath815 ) is also small , since @xmath749 can be taken as small as necessary .",
    "this decreasing positive sequence of analyticity strip widths is associated to a similar sequence of analyticity radii . to be precise",
    ", we will construct a sequence of the form @xmath816 the inequality  @xmath817 does not correspond to a true reduction , but to a restriction on the size of @xmath749 .",
    "note that we have consumed all the analyticity strip width after the last reduction , but we still keep a positive analyticity radius @xmath182 .",
    "we split the proof in the eight steps .",
    "_ step 1 : control of the fourier norm .",
    "_ if the analytic map @xmath139 satisfies the properties ( i)(iii ) listed in lemma  [ lem : order2 ] , then the map @xmath818 is real analytic and has the intersection property on the cylinder @xmath121 , can be extended to the complex domain @xmath140 , and has the form  ( [ eq : order2 ] ) .",
    "the fourier norm @xmath819 may be infinite , but @xmath820 for any @xmath821 and @xmath822 .",
    "_ step 2 : application of the averaging lemma .",
    "once fixed an integer @xmath475 and any @xmath415 , we know from lemma  [ lem : beyondallorders ] that there exist an analytical radius @xmath416 and a change of variables of the form @xmath417 for some @xmath418 such that the transformed map @xmath419 is real analytic , has the intersection property on the cylinder @xmath420 , and has the form @xmath421 for some @xmath422 .",
    "_ step 3 : application of theorem  [ thm : technical ] .",
    "_ let @xmath478 be the number that appears in  ( [ eq : achain ] ) .",
    "set @xmath823 , @xmath811 , and @xmath824 .",
    "let @xmath479 be the constant stated in theorem  [ thm : technical ] .",
    "we can assume that @xmath817 and the condition  ( [ eq : achain ] ) holds , by taking a smaller @xmath521 if necessary .",
    "let @xmath179 be defined by @xmath825 .",
    "fix any @xmath826 .",
    "set @xmath814 and @xmath827 .",
    "if @xmath828 and @xmath829 are the norms defined in  ( [ eq : barfv ] ) , then @xmath830 . hence , we can apply theorem  [ thm : technical ] to obtain a change of variables @xmath484 , with @xmath831 and @xmath832 , and a transformed map @xmath833 , with @xmath490 , @xmath834 , and @xmath835 .",
    "_ step 4 : uniform estimates on the change @xmath836_. by construction , @xmath484 , with @xmath485 and @xmath837 , where the constant @xmath838 does not depend on @xmath182 .",
    "thus , @xmath839 for some functions @xmath840 analytic on @xmath841 such that @xmath842 .",
    "the cauchy estimates imply that @xmath843 and , in particular , for all @xmath844 .",
    "hence , @xmath845 = 1 + \\or(y^{m-2}),\\ ] ] for all @xmath844 , where the @xmath846 , @xmath847 , and @xmath848 terms are uniform in @xmath182 .",
    "we recall that @xmath475 and the change @xmath423 satisfies properties  ( [ eq : changephi_m ] ) , so the complete change @xmath836 satisfies the properties stated in theorem  [ thm : remainder ] .",
    "_ step 5 : exponentially small bound on the remainder @xmath99 .",
    "_ after all these changes of variables , we have the map @xmath849 , with @xmath850 , @xmath851 and @xmath852 .",
    "we can bound @xmath853 by using the bound on @xmath518 and the intersection property of @xmath409 on the cylinder @xmath183 .",
    "we recall that if @xmath854 for some @xmath380 , then @xmath855 where @xmath856 is the average of @xmath857 and @xmath858 .",
    "fix any @xmath859 .",
    "we know that @xmath860 therefore , there exists  @xmath861 such that @xmath862 , and so @xmath863 this implies that @xmath864 for all @xmath185 .",
    "_ step 6 : exponentially small bounds on some derivatives of the remainder .",
    "_ we recall that @xmath865 for all @xmath866 .",
    "thus , we get from @xmath867 and the cauchy estimates that @xmath868 for all @xmath185 .    _ step 7 : a crude bound on the derivative of @xmath869 .",
    "_ we recall that @xmath870 , so @xmath871 therefore , the cauchy estimates imply that @xmath872 for all @xmath873 and , in particular , for all @xmath874 .",
    "_ step 8 : computation of the constant @xmath78 . _ by combining the inequalities obtained in steps  57 , we get that @xmath875 and @xmath191 for all @xmath183 , provided @xmath876    this ends the proof of theorem  [ thm : remainder ] .",
    "henceforth , let @xmath877 and @xmath878 with @xmath369 .",
    "let @xmath879 be any compact subset of @xmath880 .",
    "let @xmath881 .",
    "let @xmath882 be the set of all matrix functions @xmath883 of the form @xmath884 for some continuous functions @xmath885 .",
    "the set @xmath882 is a banach space with the norm @xmath886    [ lem : boundgammas ] let @xmath887 , @xmath888 , @xmath889 , and @xmath890 .",
    "let @xmath891 and @xmath892 .",
    "let @xmath893 be a map of the form  ( [ eq : neishtadtform ] ) with @xmath894 for all @xmath895 .",
    "then :    1 .",
    "@xmath896 and @xmath897 .",
    "2 .   @xmath898 and @xmath899 .",
    "3 .   @xmath900 and @xmath901 .",
    "4 .   @xmath902 and @xmath903 .",
    "it is a straightforward computation .",
    "let @xmath139 be an analytic map of the form  ( [ eq : neishtadtform ] ) .",
    "let @xmath9 and @xmath6 be two relatively prime integers . there exist two curves @xmath904 and @xmath905 and two rics @xmath906 with diophantine rotation numbers @xmath907 , all four contained in a small neighborhood of @xmath908 , such that @xmath909 projects @xmath910 onto @xmath911 along the vertical direction and @xmath910 and @xmath911 are contained in the strip of the cylinder enclosed by the rics @xmath912 .",
    "following birkhoff  ( * ? ? ?",
    "* section vi ) and arnold  ( * ? ? ?",
    "* section 20 ) , all @xmath0-periodic points of @xmath139 are contained in @xmath913 .",
    "besides , we will see later on that the ( geometric ) area enclosed between @xmath910 and @xmath911 is an upper bound of the quantities @xmath58 .",
    "these are the reasons for the study of @xmath910 and @xmath911 .",
    "let us prove that these four curves exist for big enough periods @xmath6 . in this case , `` big enough '' only depends on the size of the nonintegrable terms of  @xmath139 , the size of the neighborhood of @xmath908 , the exponent @xmath110 , and the winding number @xmath9 . on the contrary",
    ", it _ does not depend _ on the particular map at hand .",
    "therefore , every time that we ask @xmath6 to be `` big enough '' along the proof of the following lemma , it only depends on the quantities @xmath914 , @xmath915 , @xmath916 , @xmath917 , and @xmath918 fixed at the first line of the next statement .",
    "[ lem : preliminary ] let @xmath919 , @xmath915 , @xmath916 , and @xmath920 .",
    "let @xmath921 be an integer relatively prime with @xmath9 . set @xmath922 .",
    "let @xmath923 be an analytic map of the form  ( [ eq : neishtadtform ] ) such that @xmath924 and @xmath925 for all @xmath926 .",
    "let @xmath927 .",
    "let @xmath928 , @xmath929 , and @xmath930 .",
    "there exists @xmath931 such that , if @xmath932 , the following properties hold :    1 .",
    "the map @xmath139 has two rics @xmath933 whose internal dynamics is conjugated to a rigid rotation of angles @xmath934 , respectively ; 2 .   if @xmath879 is the compact subset of @xmath880 enclosed by @xmath935 and @xmath936 , then @xmath937 3 .",
    "[ item : zeta ] there exist two unique analytic functions @xmath938 and @xmath939 such that @xmath940 and all the @xmath0-periodic points of the restriction @xmath941 are contained in @xmath942 .",
    "the same statement holds if @xmath9 is a negative integer , @xmath943 , @xmath944 , @xmath945 , and @xmath946 .",
    "let us assume @xmath628 .",
    "the case @xmath947 is analogous .",
    "first , the existence of the rics @xmath935 and @xmath936 follows from some quantitative estimates in kam theory established by lazutkin  ( * ? ? ?",
    "* theorem 2 ) . to be precise",
    ", lazutkin proved that there exists @xmath948 such that if @xmath949 satisfies the diophantine condition @xmath950 for all integers @xmath951 and @xmath93 , then @xmath139 has a ric @xmath952 whose internal dynamics is @xmath953-conjugated to a rigid rotation of angle @xmath101 , for a suitable @xmath954 .",
    "the conjugation is @xmath955-close to the identity .",
    "( i ) follows directly from this estimate , because there exist some real numbers @xmath956 and @xmath957 satisfying the diophantine condition  ( [ eq : diophantine ] ) , provided @xmath6 is big enough .",
    "second , let us check that the power map @xmath909 satisfies  ( [ eq : twistcondition ] ) . the compact subset @xmath887 is invariant by @xmath139 , because it is delimited by rics .",
    "thus , all powers @xmath958 are well defined on @xmath879 .",
    "we write @xmath959 , where @xmath408 was introduced in lemma  [ lem : boundgammas ] .",
    "next , we compute the differential of the power map : @xmath960 where @xmath961 and @xmath962 is the sum of all the products of the form @xmath963 , with @xmath964 , @xmath965 , and @xmath966 .",
    "these products are elements of @xmath967 , because @xmath968 . indeed , if @xmath969 , then @xmath970 where we have used lemma  [ lem : boundgammas ] , inequality @xmath971 for @xmath972 , @xmath973 , @xmath974 , @xmath975 , @xmath922 , and @xmath916 .",
    "we have also defined @xmath976 .",
    "the matrix @xmath962 is the sum of the products with precisely @xmath432 factors @xmath977 .",
    "this shows that there are @xmath978 terms inside @xmath962 .",
    "therefore , @xmath979 and @xmath980 the element of the first row and second column of @xmath981 is equal to @xmath6 , so @xmath982 for all @xmath983 , which implies the twist condition  ( [ eq : twistcondition ] ) provided that @xmath6 is big enough . here , we have used relation  ( [ eq : dfq ] ) , bound  ( [ eq : bounddelta ] ) , @xmath922 , and @xmath984 .",
    "we have also used that @xmath985 and @xmath986 , provided @xmath6 is big enough .",
    "third , we establish the existence of the functions @xmath987 .",
    "we know from lazutkin  @xcite that @xmath906 for some differentiable functions @xmath988 .",
    "we work with the lifts @xmath409 , @xmath989 , and @xmath990 of the objects @xmath139 , @xmath991 , and @xmath992 .",
    "the rics are invariant , so @xmath993 for some differentiable functions @xmath994 .",
    "if we prove that there exist two unique analytic 1-periodic functions @xmath995 such that @xmath996 then item  ( iii ) follows .",
    "since the dynamics of @xmath997 on @xmath912 is @xmath953-conjugated to a rigid rotation of angle @xmath998 through a @xmath955-close to the identity conjugation , @xmath999 provided that @xmath6 is big enough .",
    "analogously , we obtain @xmath1000 .",
    "that is , @xmath1001 since @xmath1002 is analytic and strictly increasing for @xmath1003 , we deduce that there exists a unique function @xmath1004 such that @xmath1005 .",
    "the function @xmath1006 is analytic and @xmath1007 , so @xmath1008 is analytic by the implicit function theorem .",
    "the @xmath33-periodicity of @xmath1008 follows from the uniqueness and the property @xmath1009 .",
    "function @xmath1010 is defined by means of relation  ( [ eq : verticalcurveslift ] ) .",
    "finally , functions @xmath1011 are the projections of @xmath1012 .",
    "if @xmath1014 , by hypothesis , the map @xmath1015 , @xmath1016 , is an analytic exact twist map with a @xmath170-analytic @xmath255-resonant ric , such that @xmath1017 .",
    "the map @xmath1018 satisfies the properties  ( i)(iii ) listed in lemma  [ lem : order2 ] in some suitable coordinates @xmath66 .",
    "let @xmath1019 be the associated change of variables .",
    "let @xmath1020 be the new map defined in the domain  ( [ eq : dab ] ) .",
    "note that the @xmath170-analytic @xmath255-resonant ric is @xmath1021 in the @xmath66 coordinates .",
    "let @xmath9 be an integer such that @xmath1022 .",
    "let @xmath1023 such that @xmath1024 .",
    "we take @xmath1025 as the @xmath32 appearing in theorem  [ thm : remainder ] , @xmath1026 , and @xmath1027 , provided that  @xmath6 is relatively prime with @xmath9 and is large enough so that @xmath1028 .",
    "that is , @xmath1029 .    hence , there exist @xmath1030 , both independent of @xmath6 , and a change of coordinates @xmath1031 such that @xmath1032 is an analytic map of the form  ( [ eq : neishtadtform ] ) such that @xmath1033 , @xmath1034 , and @xmath1035 \\right| \\ } \\le   k_1 $ ] for all @xmath926 .",
    "the map @xmath1036 satisfies the hypotheses of lemma  [ lem : preliminary ] for any @xmath1037 .",
    "let @xmath1038 be the maximum value of @xmath1039 among the integers @xmath1040 .",
    "let @xmath912 be the rics with rotation numbers @xmath1041 given in lemma  [ lem : preliminary ] .",
    "let @xmath879 be the compact subset of @xmath880 enclosed by @xmath935 and @xmath936 .",
    "since @xmath139 is globally twist and @xmath1042 , all the birkhoff @xmath0-periodic orbits of @xmath139 are contained in @xmath879 . by lemma  [ lem : preliminary ] ,",
    "any @xmath0-periodic orbit in @xmath879 lies on @xmath904 .",
    "let @xmath1043 be the domain enclosed by the curves @xmath904 and @xmath905 .",
    "let @xmath1044 .",
    "let @xmath1045 be the supremum of @xmath1046|$ ] in the compact set @xmath1047 $ ] .",
    "let @xmath1048 .",
    "then , following the arguments contained in subsection  [ ssec : differenceofperiodicactions ] about the difference of periodic actions , we get that @xmath1049 \\le k_1 k_2 { \\mathop{\\rm area}\\nolimits}[\\omega ] = k_1 k_2 \\int_{\\mathbb{t}}\\left|\\hat{\\zeta}(\\xi ) - \\zeta(\\xi)\\right|\\rmd \\xi \\\\ \\label{eq : deltaboundproof } & \\le & k_1 k_2 q b^4 k_0 \\rme^{-2\\pi \\alpha   q /|p| } \\le k",
    "\\rme^{-2\\pi\\alpha q /|p|},\\end{aligned}\\ ] ] for all relatively prime integers @xmath9 and @xmath6 with @xmath1022 and @xmath77",
    ". we have used expression  ( [ eq : neishtadtform ] ) , @xmath1050 , @xmath1051 , the bounds on the nonintegrable terms @xmath1052 , and the bounds on the jacobians of the changes of variables @xmath495 and @xmath1053 .",
    "this ends the proof of theorem  [ thm : asymptotic ] when @xmath1014 .",
    "we reduce the general case to the previous one .",
    "we split the argument in four steps .",
    "_ step 1 : about the rational rotation numbers .",
    "_ if @xmath109 is a @xmath1-resonant ric and @xmath83 is a @xmath0-periodic point of @xmath97 , then @xmath109 is a @xmath1054-resonant ric and @xmath83 is a @xmath1055-periodic point of the power map @xmath117 , where @xmath1056 by taking the suitable lift @xmath409 of @xmath139 , we can assume that @xmath109 is a @xmath255-resonant ric and @xmath83 is a @xmath1057-periodic point of @xmath139 , with @xmath1058 .",
    "that is , @xmath1059 if @xmath9 and @xmath6 are relatively prime integers such that @xmath1060 and @xmath77 , @xmath1061 and @xmath1062 are relatively prime integers such that @xmath1063 and @xmath1064 .",
    "_ step 2 : about the lagrangians .",
    "_ let @xmath99 and @xmath1065 be the lifts of @xmath97 and @xmath1066 we are dealing with . if @xmath1067 , then @xmath1068 = \\sum_{j=0}^{n-1 } \\rmd ( h \\circ g^j ) = \\rmd \\left ( \\sum_{j=0}^{n-1 } h \\circ g^j \\right),\\ ] ] so @xmath1069 is a lagrangian of @xmath139 .",
    "this lagrangian is well defined in a neighboorhood of the resonant ric @xmath109 , because @xmath139 is twist on @xmath109 .",
    "_ step 3 : about the periodic actions .",
    "_ let @xmath1070 be the @xmath0-periodic orbit of @xmath97 through the point @xmath83 , being @xmath1071 $ ] its @xmath0-periodic action .",
    "let @xmath1072 be the @xmath1057-periodic orbit of @xmath139 through the same point , being @xmath1073 $ ] its @xmath1057-periodic action .",
    "we deduce from the previous steps and a straightforward computation that @xmath1074 = \\frac{n}{\\gcd(n , q ) } w^{(p , q)}[o].\\ ] ]    _ step 4 : final bound .",
    "_ the result follows directly from the bound  ( [ eq : deltaboundproof ] ) taking into account relations  ( [ eq : newrotationnumber ] ) and  ( [ eq : newperiodicaction ] ) . we just note that @xmath1075    this ends the proof of theorem  [ thm : asymptotic ] .    the authors were supported in part by cur - diue grant 2014sgr504 ( catalonia ) and mineco - feder grant mtm2012 - 31714 ( spain ) .",
    "some of the results of this paper were obtained while a t was in the university of warwick as a visiting researcher .",
    "thanks to vassily gelfreich , robert mackay , laurent niederman , snia pinto - de - carvalho , and tere seara for useful and stimulating conversations ."
  ],
  "abstract_text": [
    "<S> area - preserving twist maps have at least two different @xmath0-periodic orbits and every @xmath0-periodic orbit has its @xmath0-periodic action for suitable couples @xmath0 . </S>",
    "<S> we establish an exponentially small upper bound for the differences of @xmath0-periodic actions when the map is analytic on a @xmath1-resonant rotational invariant curve ( resonant ric ) and @xmath2 is `` sufficiently close '' to @xmath3 . </S>",
    "<S> the exponent in this upper bound is closely related to the analyticity strip width of a suitable angular variable . </S>",
    "<S> the result is obtained in two steps . </S>",
    "<S> first , we prove a neishtadt - like theorem , in which the @xmath4-th power of the twist map is written as an integrable twist map plus an exponentially small remainder on the distance to the ric . </S>",
    "<S> second , we apply the mackay - meiss - percival action principle .    </S>",
    "<S> we apply our exponentially small upper bound to several billiard problems . </S>",
    "<S> the resonant ric is a boundary of the phase space in almost all of them . </S>",
    "<S> for instance , we show that the lengths ( respectively , areas ) of all the @xmath5-periodic billiard ( respectively , dual billiard ) trajectories inside ( respectively , outside ) analytic strictly convex domains are exponentially close in the period @xmath6 . </S>",
    "<S> this improves some classical results of marvizi , melrose , colin de verdire , tabachnikov , and others about the smooth case .    </S>",
    "<S> _ keywords _ : twist maps , invariant curves , exponential smallness , billiards , dual billiards </S>"
  ]
}