{
  "article_text": [
    "coherent control utilizes the wave properties of matter to steer a quantum dynamical process to a desired outcome .",
    "the source of control is interference , constructive to achieve the goal and destructive to eliminate unwanted consequences @xcite .",
    "the agents of control are external fields , in particular electromagnetic fields .",
    "the experimental and theoretical challenge lies in identifying these control fields .",
    "the present study is aimed at finding control fields which are constrained to limit the damage which the control field may cause to the controlled system .",
    "theoretically , the control problem can be formulated as an inversion : finding the field subject to the quantum dynamics which leads to the desired outcome .",
    "optimal control theory ( oct ) has been developed as a tool to address this problem @xcite .",
    "it can be formulated starting from a variational ansatz @xcite or using krotov s method @xcite .",
    "recently the krotov s method has been extended to include a strict limitation on the spectrum of the optimized field @xcite .",
    "the most well studied task in oct has been the goal of a state - to - state transition . given an initial state @xmath1 and a closed quantum system , the field needs to be found which drives the system to a specific final state @xmath2 .",
    "this task has been shown to be completely controllable @xcite if the fields are not restricted .",
    "moreover the control landscape is favorable composed of flat ridges such that the climb in the gradient direction will lead to one of the many possible solutions @xcite .",
    "a more involved control task is to optimize the expectation value of an operator at a final time , @xmath3 .",
    "this task can be formulated in the framework of open quantum systems .",
    "the oct approach yields an iterative solution to the inversion problem which is based on propagating the system density operator @xmath4 forward in time and the target operator @xmath5 backward in time @xcite .",
    "the prospect of quantum computing has posed an even more complex control problem : imposing a unitary transformation @xmath6 on a subset of quantum states which act as the quantum register .",
    "the unitary transformation carries out a specific computational task .",
    "this control task is equivalent to @xmath7 simultaneous state - to - state transformations @xcite .",
    "the solution of the iterative set of equations has been shown to become exponentially more difficult with the size @xmath7 of the unitary transformation @xcite .",
    "these findings are in accordance with a very complex control landscape @xcite .",
    "a further step up in complexity is the task of imposing a unitary transformation under dissipative conditions .",
    "this task emerges in the quantum governor @xcite , in quantum information processing and it is a traditional task in nuclear magnetic resonance ( nmr ) spectroscopy @xcite .    in any practical implementation",
    "the positive task of obtaining the final goal has to be weighted by possible negative consequences .",
    "for example control fields of high intensity can damage the system by causing ionization or dissociation .",
    "a remedy for this problem consists in restricting the population in certain lossy excited state manifolds .",
    "this task has been the motivation for the development of local control theory ( lct ) @xcite .",
    "lct has been applied to lock unwanted electronic excitations @xcite and recently to the problem of quantum information processing where avoiding population loss becomes crucial @xcite .    however , oct is more powerful than lct and it is therefore desirable to incorporate constraints describing negative consequences of the control process into the algorithm .",
    "such constraints depend on the state of the system at intermediate times @xcite . for example",
    ", the system can simply be restricted to remain in an `` allowed '' or to avoid a `` forbidden '' subspace during its evolution .",
    "more elaborate examples include imposing a predefined path between an initial and a final state @xcite , and maximizing the expectation value of a time - dependent operator throughout the optimization time interval @xcite .",
    "previous oct studies which impose state - dependent constraints @xcite were performed for state - to - state optimization and are based on the variational approach . in the present work , an optimization algorithm including state - dependent constraints is obtained using the krotov method for the state - to - state case as well as for unitary transformations .",
    "the krotov method offers the advantage that the monotonic convergence of the algorithm can be ensured by the choice of the imposed constraints @xcite .",
    "a brief comparison with the algorithms using the variational ansatz @xcite will be given for the state - to - state optimization .",
    "the paper is organized as follows : the state - dependent constraints are formulated in sec .",
    "[ sec : formalism ] , and the resulting algorithm is presented for optimization of state - to - state transition and of a unitary transformation . a review of the krotov method together with an outline of the derivation of the equations presented in sec .",
    "[ sec : formalism ] is given in the appendix .",
    "[ sec : results ] introduces a model example and illustrates optimization under state - dependent constraints for a state - to - state transition and for a unitary transformation .",
    "our findings are compared to related approaches in sec .",
    "[ sec : disc ] .",
    "finally , sec .",
    "[ sec : concl ] concludes .",
    "represents the state of the system at time @xmath9 , and @xmath10\\,=\\,{\\boldsymbol{\\mathsf{\\hat{h}}}}_0\\,-\\,{\\boldsymbol{\\mathsf{\\hat{\\mu}}}}\\epsilon(t)\\,,\\ ] ] is the system+control hamiltonian .",
    "@xmath11 denotes the field - free hamiltonian , @xmath12 the semiclassical control field and @xmath13 is a system operator describing the coupling between system and field .",
    "the objective of the optimization is to find a field which drives the system from an initial state at @xmath14 , @xmath15 to a target subspace at time @xmath16 representing the final time objective , such that a minimum ( or maximum ) expectation value of the time - dependent operator @xmath17 is maintained throughout the complete time interval @xmath18 $ ] .",
    "the target subspace at time @xmath16 is described by the projector @xmath19 , e.g. , @xmath20 for a single target state .    in oct , these requirements are formulated as a functional which depends on the system state and the control , in such a way that an optimal field corresponds to an extremum of the functional .",
    "that functional can be expressed as a sum over terms related to the different conditions imposed on the system evolution .",
    "the complete functional is obtained as a sum over functionals corresponding to the final time objective , to the state - dependent intermediate - time objective ( or constraint ) , and to the constraint over the field .",
    "the term corresponding to the objective at the final time @xmath16 , the actual target , can be expressed as @xmath21\\,=\\,\\lambda_0\\ , \\langle\\varphi(t)|{\\boldsymbol{\\mathsf{\\hat{d}}}}|\\varphi(t)\\rangle\\,,\\ ] ] where @xmath22 is a real parameter , which can be negative or positive , depending on whether the functional is minimized or maximized during the optimization . @xmath23",
    "$ ] emphasizes the bilinearity of the functional with respect to the system state at time @xmath16 .",
    "other possibilities for expressing this term exist @xcite , but the resulting optimization algorithms are very similar .",
    "the state - dependent intermediate - time objective or constraint is represented by the functional , @xmath24=\\int_0^t\\,g_b[\\varphi,\\varphi^\\dagger]\\,dt\\,,\\ ] ] where @xmath25 is taken to be @xmath26=\\lambda_b\\langle\\varphi(t)|{\\boldsymbol{\\mathsf{\\hat{p}}}}(t)|\\varphi(t)\\rangle\\,.\\ ] ] @xmath27 is a real parameter which can be positive or negative , as discussed later .",
    "more complicated dependences of @xmath25 on the operator @xmath17 and on the state @xmath28 are conceivable .    to obtain a closed algorithm ,",
    "the complete functional has to include a term depending on the field @xcite , @xmath29=\\int_0^t\\,g_a[\\epsilon]\\,dt\\,.\\ ] ] generally , @xmath30 can be written as @xmath31=\\lambda_a(t)\\,[\\epsilon(t)-\\epsilon_r(t)]^2\\,,\\ ] ] where @xmath32 denotes a reference field and @xmath33 corresponds to the common choice of minimizing the field energy . @xmath34 $ ] represents an intermediate - time objective , but one which does not depend on the state of the system .",
    "the complete functional is given by @xmath35\\,=\\,j_0[\\varphi_t,\\varphi_t^\\dagger]\\,+\\,j_a[\\epsilon ] \\,+\\,j_b[\\varphi,\\varphi^\\dagger]\\,.\\ ] ] for simplicity , we omit the dependence of @xmath28 and @xmath36 on time , except for the final time @xmath16 .",
    "the optimization problem is now equivalent to the minimization or maximization of this functional . for that purpose ,",
    "the krotov method is employed .",
    "since the krotov method operates with real functions , a complete presentation of the equations for this problem is somewhat cumbersome @xcite .",
    "an outline of the derivation is given in the appendix and only the final result is presented below .      a guess field",
    "is denoted by @xmath37 and the corresponding state @xmath38 is given by the evolution eq .",
    "( [ eq : schrodinger ] ) with the initial condition @xmath39 . in the krotov method a new field @xmath40 which decreases ( or increases ) the functional value is obtained by the following equations : a new `` state '' @xmath41",
    "is determined using the inhomogeneous equation @xmath42\\ ,    with the `` initial '' condition @xmath43,[eq : chicondition ] ) of the appendix .",
    "it corresponds to the common oct result modified by the inhomogeneous term @xmath44 which arises from the state - dependent constraint .",
    "the state @xmath41 is used to determine the new control field , @xmath45 cf .",
    "( [ eq : newfield ] ) of the appendix , where @xmath46 was chosen .",
    "this is an implicit equation since the state @xmath47 which depends on @xmath48 appears in the right - hand side of eq .",
    "( [ eq : eps1 ] ) .",
    "the numerical discretization of this implicit equation has been widely discussed for the homogeneous case ( see for example ref .",
    "@xcite ) . the inhomogeneous term in eq . ( [ eq : chistate ] ) requires a modification of the time propagation method .",
    "a symmetrical propagation scheme is employed based on the diagonalization of the hamiltonian in the interleaved time grid points , @xmath49 .",
    "the inhomogeneous term is evaluated as @xmath50 the iterative algorithm is constructed with @xmath48 as input to the next step of the iteration and the process is repeated until the required convergence is achieved .      the monotonic convergence of the algorithm is analyzed defining @xmath51 as the difference between the functional values before and after one iteration , @xmath52\\,-\\ , j[\\varphi^{(1)},\\varphi^{\\dagger(1)},\\epsilon^{(1 ) } ] \\nonumber\\\\ & = & \\delta_1+\\int_0^t\\,\\left(\\delta_{2a}(t)+\\delta_{2b}(t)\\right)\\,dt\\,.\\end{aligned}\\ ] ] the terms @xmath53 are derived in the appendix and can be evaluated using eqs .",
    "( [ eq : j_0]-[eq : g_a ] ) .",
    "this yields @xmath54 cf .",
    "( [ eq : delta_1 ] ) , with the definition @xmath55 furthermore , @xmath56+g_a[\\epsilon^{(0)}]\\,+\\,\\nonumber \\\\ & & \\quad\\left[\\frac{\\partial g_a}{\\partial\\epsilon}\\right]_{(1)}\\ , \\left(\\epsilon^{(1)}-\\epsilon^{(0)}\\right)\\,,\\end{aligned}\\ ] ] cf .",
    "( [ eq : delta_2 ] ) , which yields for our choice @xmath57 @xmath58 and @xmath59 cf .",
    "( [ eq : delta_2 ] ) .",
    "the algorithm converges monotonically to a minimum ( maximum ) of the functional if @xmath60 ( @xmath61 ) in each iteration step .",
    "a sufficient but not necessary condition consists in all @xmath53 being larger ( smaller ) than zero .",
    "let the operators @xmath19 and @xmath17 be positive - semidefinite .",
    "sufficient conditions are then given by @xmath62 for minimization , and by @xmath63 for maximization .",
    "this result leads to some curious consequences .",
    "for example , let the system be described by a discrete number of levels and assume its hilbert space can be split into two subspaces , the `` allowed '' subspace , described by the projector @xmath64 , and the `` forbidden '' subspace , described by @xmath65 ( @xmath66 ) .",
    "the objective of the optimization consists in some transition inside the allowed subspace , avoiding any population transfer to the forbidden one . in the case of minimization of the functional @xmath67",
    ", the latter requirement can be expressed by one of the two following choices for @xmath68 , @xmath69 in the case of maximization , the possibilities are @xmath70 in both cases , @xmath71 and @xmath72 have the same physical meaning , remaining in the allowed subspace , or equivalently , avoiding the forbidden subspace .",
    "the choice @xmath72 is more appealing in principle , since the inhomogeneous term of eq .",
    "( [ eq : chistate ] ) would decrease and eventually become negligible when approaching an optimal solution .",
    "however , only @xmath71 fulfills the sufficient conditions for monotonic convergence .",
    "a note of caution must be made at this point .",
    "( [ eq : cmin ] ) and ( [ eq : cmax ] ) are sufficient but not necessary conditions .",
    "monotonic convergence can therefore be found for values of @xmath73 not fulfilling eqs .",
    "( [ eq : cmin ] ) and ( [ eq : cmax ] ) .",
    "this can happen if the values of @xmath53 compensate each other to give a convergent total @xmath51 .",
    "in addition , the analysis assumes an exact solution of the control equations .",
    "a limited accuracy of the numerical implementation of the algorithm and a poor accuracy of the propagation method can lead to the breakdown of the monotonic convergence @xcite .",
    "the objective consists in implementing a given unitary transformation @xmath74 , up to a global phase , in a given subspace @xmath75 of dimension @xmath76 described by the projector @xmath77 , @xmath78 to this end , the parameter @xmath79 is defined , @xmath80 where @xmath81 the modulus of @xmath79 is equal to @xmath76 when the target unitary transformation is implemented in the subspace @xmath75 by the field @xmath36 @xcite .",
    "the optimization problem is again formulated as a functional minimization ( maximization ) .",
    "the final time term is now defined by @xmath82 & = & \\lambda_0\\,|\\tau|^2 \\\\ & = & \\lambda_0 \\sum_{n=1}^{n_r}\\,\\langle\\varphi_{fn}|\\varphi_n(t)\\rangle \\sum_{n'=1}^{n_r}\\,\\langle\\varphi_{n'}(t)|\\varphi_{fn'}\\rangle\\,,\\nonumber\\end{aligned}\\ ] ] where @xmath83 denote the set of states @xmath84 ( @xmath85 ) .",
    "other choices of @xmath86 are possible @xcite .",
    "the intermediate - time state - dependent term takes the form , @xmath87&=&\\lambda_b\\,{\\rm tr } \\left\\{{\\boldsymbol{\\mathsf{\\hat{u}}}}(t,0;\\epsilon)^\\dagger{\\boldsymbol{\\mathsf{\\hat{p}}}}(t){\\boldsymbol{\\mathsf{\\hat{u}}}}(t,0;\\epsilon){\\boldsymbol{\\mathsf{\\hat{r } } } } \\right\\ } \\nonumber \\\\ & = &   \\lambda_b\\,\\sum_{n=1}^{n_r}\\,\\langle\\varphi_{n}(t)|{\\boldsymbol{\\mathsf{\\hat{p}}}}(t)|\\varphi_n(t)\\rangle\\,.\\end{aligned}\\ ] ] the constraint over the field is taken to be the same as in the state - to - state case , cf .",
    "( [ eq : g_a ] ) .",
    "the equations defining the algorithm are obtained using the krotov method as outlined in the appendix .",
    "they read as follows : @xmath76 `` states '' @xmath41 are given by the inhomogeneous evolution equation , @xmath88\\ ,    with the `` initial '' condition latexmath:[\\ ] ] if the objective is to minimize the functional @xmath67 ( @xmath216 ) , the sufficient but not necessary conditions for monotonic convergence are given by @xmath217 , ( @xmath218 ) .",
    "analogously , in order to maximize the functional it is sufficient that @xmath219 , ( @xmath218 ) .",
    "whether the @xmath53 are positive or negative is determined by the particular choice of @xmath86 , @xmath30 , and @xmath25 . in sec .",
    "[ sec : formalism ] the values of @xmath51 are analyzed for the cases under study .      the previous approach can easily be generalized to the case of unitary transformations .",
    "the functional @xmath67 depends then on @xmath220 real functions denoted by the set @xmath221 . as a consequence , the scalar functions @xmath165 , @xmath222 and @xmath104 will also depend on all of them .",
    "moreover , the new dependence must be taken into account in the derivatives of the previous equations by the substitution @xmath223 the remaining procedure is analogous to the state - to - state case , and the relations ( [ eq : correspondence ] ) can be used to obtain the equations for the optimization algorithm given in sec .",
    "[ subsec : form_utrafo ] ."
  ],
  "abstract_text": [
    "<S> optimal control theory is developed for the task of obtaining a primary objective in a subspace of the hilbert space while avoiding other subspaces of the hilbert space . </S>",
    "<S> the primary objective can be a state - to - state transition or a unitary transformation . </S>",
    "<S> a new optimization functional is introduced which leads to monotonic convergence of the algorithm . </S>",
    "<S> this approach becomes necessary for molecular systems subject to processes implying loss of coherence such as predissociation or ionization . in these subspaces controllability </S>",
    "<S> is hampered or even completely lost . avoiding the lossy channels is achieved via a functional constraint which depends on the state of the system at each instant in time . </S>",
    "<S> we outline the resulting new algorithm , discuss its convergence properties and demonstrate its functionality for the example of a state - to - state transition and of a unitary transformation for a model of cold rb@xmath0 . </S>"
  ]
}