{
  "article_text": [
    "one of the fundamental problems in computational biology is that of inferring evolutionary relationships between a set of observed amino acid sequences or taxa .",
    "these evolutionary relationships are commonly represented by a tree ( phylogeny ) describing the descent of all observed taxa from a common ancestor , a reasonable model provided we are working with sequences over small enough regions or distant enough relationships that we can neglect recombination or other sources of reticulation  @xcite .",
    "several criteria have been implemented in the literature for inferring phylogenies , of which one of the most popular is maximum parsimony ( mp ) .",
    "maximum parsimony defines the tree(s ) with the fewest mutations as the optimum , generally a reasonable assumption for short time - scales or conserved sequences .",
    "it is a simple , non - parametric criterion , as opposed to common maximum likelihood models or various popular distance - based methods @xcite .",
    "nonetheless , mp is known to be np - hard  @xcite and practical implementations of mp are therefore generally based on heuristics which do not guarantee optimal solutions .    for sequences where each site or character is expressed over a set of discrete states , mp is equivalent to finding a minimum steiner tree displaying the input taxa .",
    "for example , general dna sequences can be expressed as strings of four nucleotide states and proteins as strings of 20 amino acid states .",
    "recently , sridhar _ et al . _",
    "@xcite used integer linear programming to efficiently find global optima for the special case of sequences with binary characters , which are important when analyzing single nucleotide polymorphism ( snp ) data .",
    "the solution was made tractable in practice in large part by a pruning scheme proposed by buneman and extended by others  @xcite .",
    "the so - called buneman graph @xmath0 for a given set of observed strings is an induced sub - graph of the complete graph @xmath1 ( whose nodes represent all possible strings of mutations ) such that @xmath2 still contains all distinct minimum steiner trees for the observed data . by finding the buneman graph , one can often greatly restrict the space of possible solutions to the steiner tree problem .",
    "while there have been prior generalizations of the buneman graph to non - binary characters  @xcite , they do not provide any comparable guarantees usable for accelerating steiner tree inference .    in this paper",
    ", we provide a new generalization of the definition of buneman graph for any finite number of states that guarantees the resulting graph will contain all distinct minimum steiner trees of the multi - state input set .",
    "further , we allow transitions between different states to have independent weights .",
    "we then utilize the integer linear programming techniques developed in @xcite to find provably optimal solutions to the multi - state mp phylogeny problem .",
    "we validate our method on four specific data sets chosen to exhibit different levels of difficulty : a set of nucleotide sequences from _ oryza rufipogon _",
    "@xcite , a set of human mt - dna sequences representing prehistoric settlements in australia @xcite , a set of hiv-1 reverse transcriptase amino acid sequences and , finally , a 500 taxa human mitochondrial dna data set .",
    "we further compare the performance of our method , in terms of both accuracy and efficiency , with leading heuristics , paup *  @xcite and the pars program of phylip  @xcite , showing our method to yield comparable and often far superior run times on non - trivial data sets .",
    "let @xmath3 be an input matrix that specifies a set of @xmath4 taxa @xmath5 , over a set of @xmath6 characters @xmath7 such that @xmath8 represents the @xmath9 character of the @xmath10 taxon .",
    "the taxa of @xmath3 represent the terminal nodes of the steiner tree inference .",
    "further , let @xmath11 be the number of admissible states of the @xmath12 character @xmath13 .",
    "the set of all possible states is the space @xmath14 .",
    "we will represent the @xmath10 character of any element @xmath15 , by @xmath16 .",
    "the state space @xmath17 can be represented as a graph @xmath18 with the vertex set @xmath19 and edge set @xmath20=1\\}$ ] , where @xmath21 = 0 $ ] if @xmath22 and 1 otherwise .",
    "furthermore , let @xmath23 be a set of weights , such that @xmath24 $ ] represents an edge length for a transition between states @xmath25 for character @xmath26 .",
    "we will assume that these lengths are positive ( states that share zero edge length are indistinguishable ) , symmetric in @xmath27 and satisfy the triangle inequality .",
    "@xmath28 + \\alpha_{p}[j , k ] \\geq \\alpha_{p}[i , k ] \\quad \\forall \\quad   i , j , k\\in\\{0 , \\ldots n_p -1\\}\\ ] ] non - negativity and symmetry are basic properties for any reasonable definition of length .",
    "if a particular triplet of states ( say @xmath29 ) does not satisfy the triangle inequality in equation  [ eq : triangle ] , we can set @xmath30 = \\alpha_{p}[i , j ] + \\alpha_{p}[j , k]$ ] and still ensure that the shortest path connecting any set of states remains the same .",
    "we can now define a distance @xmath31 over @xmath1 , such that for any two elements @xmath32 @xmath33 \\equiv \\sum_{p\\in c}^{m } \\alpha_{p}[(u)_p,(v)_p]\\ ] ]    given any subgraph @xmath34 of @xmath1 , we can define the length of @xmath35 to be the sum of the lengths of all the edges @xmath36 $ ] .",
    "the maximum parsimony phylogeny problem for @xmath5 is equivalent to constructing the minimum steiner tree @xmath37 displaying the set of all specified taxa @xmath5 , i.e. , any tree @xmath38 such that @xmath39 and @xmath40 is minimum . note that @xmath37 need not be unique .",
    "before we construct the generalized buneman graph corresponding to an input , we perform a basic pre - processing of the data .",
    "the set of taxa in the input @xmath3 might not all be distinct over the length of sequence represented in @xmath3 .",
    "these correspond to identical rows in @xmath3 and are eliminated .",
    "similarly , characters that do not mutate for any taxa do not affect the true phylogeny and can be removed . furthermore ,",
    "if two characters are expressed identically in @xmath5 ( modulo a relabeling of the states ) , we will represent them by a single character with each edge length replaced by the sum of the edge lengths of the individual characters . in case",
    "there are @xmath41 such non - distinct characters , one of them is given edge lengths equal to the sum of the corresponding edges in each of the @xmath41 characters and the rest are discarded .",
    "these basic pre - processing steps are often useful in considerably reducing the size of input .      the buneman graph was introduced as a pruning of the complete graph for the special case of binary valued characters .",
    "for this special case it is useful to introduce the notion of binary splits @xmath42 for each character @xmath43 , which partition the set of taxa @xmath5 into two sets @xmath44 and @xmath45 corresponding to the value expressed by @xmath26 .",
    "each of these sets is called a block of @xmath26 .",
    "each vertex of the buneman graph @xmath0 can be represented by an @xmath6-tuple of blocks @xmath46 $ ] , where @xmath47 or 1 , for @xmath48 . to construct the buneman graph ,",
    "a rule is defined for discarding / retaining the subset of vertices contained in each pair of overlapping blocks @xmath49 $ ] for each pair of characters @xmath50 . all vertices which satisfy @xmath51 for any pair of characters",
    "@xmath52 can be eliminated , while those for which @xmath53 for all @xmath54 $ ] are retained .",
    "buneman previously established for the binary case that the retained vertex set will contain all terminal and steiner nodes of all distinct minimum length steiner trees .",
    "we extend this prior result to the weighted multi - state case by presenting an algorithm analogous to the binary case to construct a graph with these properties .",
    "briefly , the algorithm looks at the input matrix projected onto each distinct pair of characters @xmath55 and constructs a @xmath56 matrix @xmath57 , where the @xmath58 element @xmath59 is 1 only if there is at least one taxon @xmath60 such that @xmath61 and @xmath62 and zero otherwise .",
    "the algorithm then implements a rule for each such pair of characters @xmath55 that allows us to enumerate the possible states of those characters in any optimal steiner tree . for clarity",
    ", we will assume that each state for each character is expressed in at least one input taxon , since states that are not present in any taxa can not be present in a minimum length tree because of the triangle inequality .",
    "the rule is defined by a @xmath56 matrix @xmath63 determined by the following algorithm :    1 .",
    "@xmath64 for all @xmath65 and @xmath66 .",
    "if all non - zero entries in @xmath57 are contained in the set of elements @xmath67 for a unique pair @xmath65 and @xmath66 then @xmath68 for all @xmath69 such that either @xmath70 or @xmath71 ( see fig  [ pruning ] where this pair of states are denoted @xmath72 and @xmath73 . ) 3 .",
    "if the condition in step 2 is not satisfied then set @xmath74 for all @xmath27 .",
    "are present in the shaded region , vertices in all other blocks can be discarded . ]",
    "this set of rules @xmath75 then defines a subgraph @xmath76 for each pair of characters @xmath55 , such that any vertex @xmath77 if and only if @xmath78 . the intersection of these subgraphs @xmath79 then gives the generalized buneman graph for @xmath5 given any set of distance metrics @xmath80 .",
    "note that the buneman graph of any subset of @xmath5 is a subset of @xmath0 .",
    "it is easily verified that for binary characters , our algorithm yields the standard buneman graph .",
    "the remainder of this paper will make two contributions .",
    "first , it will show that the generalized buneman graph @xmath0 defined above contains all minimum steiner trees for the input taxa @xmath5 .",
    "this will in turn establish that restricting the search space for minimum steiner trees to @xmath0 will not affect the correctness of the search .",
    "the paper will then empirically demonstrate the value of these methods to efficiently finding minimum steiner trees in practice .",
    "before we prove that all steiner minimum trees connecting the taxa are displayed in @xmath0 , we need to introduce the notion of a _",
    "neighborhood decomposition_. suppose we are given any tree @xmath81 displaying the set of taxa @xmath5 .",
    "we will contract each degree - two steiner node ( i.e. , any node that is not present in @xmath5 ) and replace its two incident edges by a single weighted edge .",
    "such trees are called _ x - trees _  @xcite .",
    "each x - tree can be uniquely decomposed into its _ phylogenetic x - tree _",
    "components , which are maximal subtrees whose leaves are taxa .",
    "formally , each phylogenetic x - tree @xmath82 consists of a set of taxa @xmath83 and a tree displaying them , such that there is a bijection or labeling @xmath84 between elements of @xmath85 and the set of leaves @xmath86  @xcite ( fig [ skltn ] ) .",
    "all vertices in @xmath82 with degree 3 or higher will be called _",
    "branch points_. from now on we will assume that given any input tree , such a decomposition has already been performed ( fig [ skltn ] ) .",
    "two phylogenetic x - trees @xmath82 and @xmath87 are considered _ equivalent _ if they have identical length and the same tree topology . by identical tree topology ,",
    "we mean there is a bijection between the edge set of the two trees , such that removing any edge and its image partitions the leaves into identical bi - partitions .",
    "we define two trees to be _ neighborhood distinct _ if after neighborhood decomposition they differ in at least one phylogenetic x - tree component .",
    "we define a labeling of the phylogenetic x - tree as an injective map @xmath88 between the vertices of @xmath82 and those of the graph @xmath1 such that @xmath89 represents the character string for the image of vertex @xmath90 in @xmath1 . since leaf labels are fixed to be the character strings representing the corresponding taxa , @xmath91 for any leaf @xmath92 .",
    "identical phylogenetic x - trees can , however , differ in the labels @xmath89 of internal branch points @xmath93 .",
    "we will use a generalization of the fitch - hartigan algorithm to weighted parsimony proposed by erdos and szekely  @xcite .",
    "the algorithm uses a similar forward pass / backward pass technique to compute an optimal labeling for any phylogenetic x - tree @xmath94 .",
    "arbitrarily root the tree @xmath94 at some taxon @xmath95 and starting with the leaves compute the minimum length @xmath96 of any labeling of the subtree @xmath97 consisting of the vertex @xmath98 and its descendants , where the root @xmath98 is labeled @xmath99 as follows .    1 .   if @xmath100 labels a leaf @xmath101 , @xmath102 and @xmath103 otherwise .",
    "if @xmath98 has @xmath104 children @xmath105 , and @xmath106 is the subtree consisting of @xmath107 and its descendants , @xmath108 \\}\\ ] ] where the minimum is to be taken over all possible labels @xmath109 for each character and for each child @xmath110 .",
    "the optimal labeling of @xmath94 is one which minimizes the length at the root : @xmath111 .",
    "labels for each descendant are inferred in a backward pass from the root to the leaves and using equation  [ score ] .",
    "note that the minimum length of a tree is just the sum of minimum lengths for each character , i.e. , @xmath112 , where @xmath113 is the minimum cost of tree @xmath97 rooted at @xmath98 for character @xmath114 .",
    "briefly , our proof is structured as follows : given any phylogenetic x - tree @xmath94 labeling ( typically denoted @xmath115 below ) , we will show that the generalized buneman pruning algorithm for each pair of characters @xmath116 defines a subgraph @xmath117 which contains at least one possible labeling of no higher cost ( typically denoted @xmath118 below ) for @xmath94 .",
    "we will then show that the intersection of these subgraphs @xmath119 thus contains an optimal labeling for @xmath94 .",
    "if the pruning condition in step 2 of the algorithm that defines the buneman graph is not implemented for the pair of characters @xmath52 , then @xmath120 and all labels are necessarily inside @xmath117 .",
    "we prove the following lemma for the case when the pruning condition is satisfied , ie . , there exist unique states @xmath72 of @xmath26 and @xmath73 of @xmath121 , such that each element in the set of leaves @xmath122 either has @xmath123 or @xmath124 or both .",
    "each time we relabel vertices , we will keep all characters except @xmath26 and @xmath121 fixed . to economize our notation",
    ", we will represent the sum of costs in @xmath26 and @xmath121 of the tree @xmath125 labeled by @xmath115 , which has some branch point @xmath98 as the root , simply by writing @xmath126 .",
    "we use the notation @xmath127 $ ] to represent the label for a vertex @xmath128 and suppress the state of all other characters .",
    "star that can be attached to a parent vertex @xmath95 in the erdos - szekely algorithm .",
    "( b ) @xmath94 for the general case ( see lemma  [ bpqlem ] ) ]    [ bpqlem ] given any phylogenetic x - tree @xmath94 with @xmath129 , and a labeling @xmath115 , such that an internal branch point @xmath130 is labeled outside @xmath117 , i.e. , @xmath131 , there exists an alternate labeling @xmath118 of @xmath94 inside @xmath117 such that    1 .",
    "either @xmath132   $ ] , or  2 .",
    "@xmath133 for each of the following choices : @xmath134 $ ] or @xmath135 $ ] or @xmath136 $ ] , and @xmath137 for all @xmath138 .",
    "we will call a tree that satisfies this second condition a @xmath52-tree    we will use induction on the number of internal branch points outside @xmath117 to prove the claim . without loss of generality we can consider all branch points of @xmath94 to be labeled outside @xmath117 . if some branch points are labeled inside @xmath117 then they can be treated as leaves of smaller x - tree(s ) that have all branch points outside @xmath117 .",
    "this is similar to the neighborhood decomposition we performed earlier for those branch points that were present in the set of input taxa .",
    "the set of branch points is then the set @xmath139 .    for the base case assume all the leaves are joined at a single branch point @xmath98 to form a star of degree @xmath140 ( see fig .  [ bpqinduction](a ) without the root @xmath95 ) .",
    "we can group the leaves into three sets :    1 .",
    "@xmath141|y_u\\neq i_{qp } , \\eta_u\\in\\psi\\}$ ] 2 .",
    "@xmath142|x_v\\neq i_{pq } , \\eta_v\\in\\psi\\}$ ] 3 .   @xmath143| \\eta_w\\in\\psi\\}$ ]    the cost of the tree for @xmath26 and @xmath121 , with branch point @xmath144 $ ] , is @xmath145 + \\alpha_{q}[y , y_u ] ) + \\sum_{v\\in ii } ( \\alpha_{p}[x , x_v ] \\nonumber \\\\   & + & \\alpha_{q}[y , i_{qp } ] ) + \\sum_{w\\in iii } ( \\alpha_{p}[x , i_{pq } ] + \\alpha_{q}[y , i_{qp } ] )   \\end{aligned}\\ ] ] the only way for @xmath146 to be minimum with @xmath147 and @xmath148 , is if @xmath149 and @xmath150 . for contradiction ,",
    "suppose @xmath151 .",
    "we could then define a labeling @xmath118 identical to @xmath115 over all characters , except @xmath152 $ ] , such that @xmath153=\\alpha_p[\\gamma_b,\\phi_b]$ ] .",
    "we could then reduce the length , since @xmath154   + \\sum_{v\\in ii } \\alpha_{p}[x , x_v ]   + \\sum_{w\\in iii } \\alpha_{p}[x , i_{pq } ] \\nonumber \\\\   & \\geq &   \\alpha_{p}[x , i_{pq}]+\\sum_{v\\in ii } ( \\alpha_{p}[x , x_v ] +   \\alpha_{p}[x , i_{pq } ] )   \\nonumber \\\\   & \\geq & \\alpha_{p}[x , i_{pq } ] + \\sum_{v\\in ii } \\alpha_{p}[i_{pq},x_v ] = l(\\phi , t)^{(p ) } + d_{\\bm{\\alpha}}[\\gamma_b,\\phi_b]\\end{aligned}\\ ] ] where the last inequality follows from the triangle inequality . similarly ,",
    "if @xmath155 , we could define @xmath156 $ ] and arrive at @xmath157 $ ] .",
    "on the other hand if @xmath158 and @xmath149 setting @xmath152 $ ] or @xmath159 $ ] or @xmath134 $ ] all achieve a length no more than @xmath160 . therefore",
    ", this is a @xmath52-tree .",
    "this proves the base case for our proposition .",
    "we will now assume that the claim is true for all trees with @xmath41 branch points or less .",
    "suppose we have a labeled tree @xmath94 with @xmath161 branch points which are all outside @xmath117 .",
    "let @xmath162 be the children of a branch point @xmath98 in @xmath94 and @xmath163 be the subtrees of each @xmath110 and their descendants .",
    "note that some of these descendants may be leaves .",
    "since @xmath94 has at least two branch points , one of its descendants ( say @xmath164 ) must be a branch point ( fig  [ bpqinduction](b ) ) .",
    "let @xmath165 be the subtree consisting of @xmath98 and all its other descendants . for clarity we will use the notation @xmath166 $ ] and @xmath167 $ ] .",
    "this implies , @xmath168\\nonumber \\\\ & = & l(\\gamma , t_b ) + l(\\gamma , t_1 ) + \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\end{aligned}\\ ] ] there are four possibilities .    1 .",
    "both @xmath97 and @xmath169 are @xmath52-trees with @xmath41 or less branch points - in this case , by induction , both @xmath97 and @xmath170 can be relabeled with @xmath171 and @xmath172 of the form @xmath173 $ ] . since the cost in @xmath26 and @xmath121 of the edge @xmath174 is now zero , we have an optimal labeling of @xmath94 within @xmath117 and @xmath175 .",
    "note that each of the choices of the form @xmath176 $ ] or @xmath177 $ ] for relabeling of @xmath98 also satisfy property 2 of the claim .",
    "therefore , this is a @xmath52-tree .",
    "2 .   @xmath97 is a @xmath52-tree , but @xmath170 is not .",
    "therefore , there is a labeling @xmath118 of @xmath170 with either @xmath178 $ ] and/or @xmath179 $ ] such that @xmath180\\ ] ] let us assume for concreteness that @xmath178 $ ] .",
    "it will become clear that the argument works for the other possible choices .",
    "since , @xmath97 is a @xmath52-tree , by induction , we can choose a labeling of @xmath97 with @xmath181 $ ] , such that @xmath182 .",
    "this gives @xmath183 \\nonumber\\\\   & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_q[y_b , y_1 ]   \\end{aligned}\\ ] ] comparing the previous two equations with equation  [ eq : gamma ] , we get , @xmath184 + \\alpha_q[y_b , y_1 ] \\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{v_1},\\phi_{v_1 } ] + \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_p[x_1,i_{pq } ] + \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & \\geq &   l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_p[x_b , i_{pq } ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & = &   l(\\phi , t_b ) + l(\\phi , t_1 ) +   d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ] + d_{\\bm{\\alpha}}[\\phi_{b},\\phi_{v_1}]\\nonumber\\\\ & = & l(\\phi , t ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b}]\\end{aligned}\\ ] ] which satisfies the first possibility of the claim . it should be clear that if @xmath185 $ ] then the choice @xmath186 $ ] would give an identical bound .",
    "3 .   @xmath170 is a @xmath52-tree , but @xmath97 is not .",
    "this case is similar to the previous one .",
    "since @xmath97 has less than @xmath41 branch points , which are all outside @xmath117 , and it is not a @xmath52-tree , we have from induction a labeling @xmath118 of @xmath97 with either @xmath187 $ ] and/or @xmath188 $ ] such that @xmath189\\ ] ] as before , let us assume @xmath187 $ ] for concreteness .",
    "since @xmath170 is a @xmath52-tree , we can choose a labeling with @xmath178 $ ] such that @xmath190 .",
    "this gives , @xmath183 \\nonumber\\\\   & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_q[y_b , y_1 ]   \\end{aligned}\\ ] ] comparing the previous two equations with equation  [ eq : gamma ] , we get , @xmath184 + \\alpha_q[y_b , y_1 ] \\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ] + \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ]   +   d_{\\bm{\\alpha}}[\\phi_{b},\\phi_{v_1 } ] \\nonumber\\\\ & = & l(\\phi , t ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b}]\\end{aligned}\\ ] ] an identical argument carries through if @xmath191 $ ] .",
    "neither @xmath170 or @xmath97 are @xmath52-trees .",
    "it follows from induction that there is a labeling @xmath118 such that @xmath192   $ ] and @xmath193   $ ] .",
    "there are two possibilities in this case",
    "@xmath194 $ ] and @xmath178)$ ] or @xmath195 $ ] and @xmath185)$ ] . as before",
    ", we will prove the claim for the former possibility while the later case can be proved by an identical argument .",
    "@xmath183 \\nonumber\\\\   & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_q[y_b , y_1]\\end{aligned}\\ ] ] @xmath184 + \\alpha_q[y_b , y_1 ] \\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ] + d_{\\bm{\\alpha}}[\\gamma_{v_1},\\phi_{v_1 } ] \\nonumber\\\\ & + & \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ]   +   \\alpha_q[y_b , y_1 ] \\nonumber\\\\ & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ]   +   d_{\\bm{\\alpha}}[\\phi_{b},\\phi_{v_1 } ] \\nonumber\\\\ & = & l(\\phi , t ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b}]\\end{aligned}\\ ] ] this also satisfies the claim .",
    "the proof for @xmath191 $ ] and @xmath185 $ ] is identical .",
    "2 .   @xmath194 $ ] and @xmath185)$ ] or @xmath195 $ ] and @xmath178)$ ] .",
    "as before , we show the calculation for the former possibility . in this case @xmath183",
    "\\nonumber\\\\   & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_p[x_b , i_{pq}]+\\alpha_q[i_{qp},y_1]\\end{aligned}\\ ] ] combining this with equation  [ eq : gamma ] we get , @xmath184 + \\alpha_q[y_b , y_1 ] \\nonumber\\\\ & \\geq & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\gamma_{b},\\phi_{b } ] + d_{\\bm{\\alpha}}[\\gamma_{v_1},\\phi_{v_1 } ] \\nonumber\\\\ & + & \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_p[x_b , i_{pq } ] + \\alpha_q[i_{qp},y_1 ] \\nonumber\\\\ & + & \\alpha_p[x_b , x_1 ] + \\alpha_q[y_b , y_1]\\nonumber\\\\ & \\geq&l(\\phi , t_b ) + l(\\phi , t_1 ) + \\alpha_p[x_b , i_{pq } ] + \\alpha_q[i_{qp},y_1 ] \\nonumber\\\\ & = & l(\\phi , t_b ) + l(\\phi , t_1 ) + d_{\\bm{\\alpha}}[\\phi_{b},\\phi_{v_1 } ] =   l(\\phi_b , t )   \\end{aligned}\\ ] ] but if we now relabel @xmath98 and @xmath164 with @xmath196 $ ] and @xmath197 $ ] while @xmath198 for all other @xmath199 , we get @xmath200\\geq l({\\tilde{\\phi}}_{v_1},t_1 ) $ ] and @xmath201\\geq l({\\tilde{\\phi}},t_b ) $ ]",
    ". this immediately gives , @xmath202 \\nonumber\\\\   & \\geq&l(\\phi , t ) \\geq l(\\gamma , t )   \\end{aligned}\\ ] ] identical arguments work for the choices @xmath203 $ ] and @xmath204 $ ]",
    ".    this proves that if either of the two possibilities claimed are always true for an x - tree with @xmath41 branch points or less then they are also true for a tree with @xmath161 branch points .",
    "the proof for arbitrary @xmath41 follows from induction .",
    "given a minimum length phylogenetic x - tree @xmath94 there is an optimal labeling for each branch point within @xmath0 .",
    "lemma  [ bpqlem ] establishes that for any minimum steiner tree labeled by @xmath115 and any branch point @xmath205 such that @xmath131 , an alternative optimal labeling @xmath118 exists such that @xmath171 is inside the union of blocks @xmath206\\cup [ c_p(i_{pq})c_q((\\gamma_{b})_q)]\\cup [ c_p((\\gamma_b)_p)c_q(i_{qp})]\\ ] ] if we root the tree at @xmath98 , the new optimal labeling for all its descendants is inferred in a backward pass of the erdos - szekely algorithm .",
    "this ensures that each branch point in a minimum length phylogenetic x - tree is labeled inside @xmath117 .",
    "let @xmath207 , where the intersection is taken over all pair of characters for which the pruning condition is satisfied .",
    "it follows from lemma  [ bpqlem ] that @xmath208 also contains an alternate optimal labeling of @xmath94 .",
    "note that @xmath208 is a non - empty subset of @xmath0 .",
    "this must be true because given a character pair @xmath209 , each union of blocks contains at least one taxon and so the rule matrix @xmath63 that defines the buneman graph must have ones for each of these blocks .",
    "therefore each element in @xmath208 represents a distinct vertex of the buneman graph .",
    "as argued before , any minimum steiner tree can be decomposed uniquely into phylogenetic x - tree components and the previous corollary ensures that each phylogenetic x - tree can be labeled optimally inside the generalized buneman graph .",
    "it follows that all distinct minimum steiner trees are contained inside the generalized buneman graph .",
    "we briefly summarize the ilp flow construction used to find the optimal phylogeny .",
    "we convert the generalized buneman graph into a directed graph by replacing an edge between vertices @xmath90 and @xmath199 with two directed edges @xmath210 each with weight @xmath211 as determined by the distance metric .",
    "each directed edge has a corresponding binary variable @xmath212 in our ilp .",
    "we arbitrarily choose one of the taxa as the root @xmath213 , which acts as a source for the flow model .",
    "the remaining taxa @xmath214 correspond to sinks .",
    "next , we set up real - valued flow variables @xmath215 , representing the flow along the edge @xmath216 that is intended for terminal @xmath60 .",
    "the root @xmath213 outputs @xmath217 units of flow , one for each terminal .",
    "the steiner tree is the minimum - cost tree satisfying the flow constraints .",
    "this ilp was described in @xcite , and we refer the reader to that paper for further details .",
    "the ilp for this construction of the steiner tree problem is the following :    @xmath218",
    "[ datatable1 ]    we implemented our generalized buneman pruning and the ilp in c++ .",
    "the ilp was solved using the concert callable library of cplex 10.0 .",
    "we compared the performance of our method with two popular heuristic methods for maximum parsimony phylogeny inference  pars , which is part of the freely - available phylip package  @xcite , and paup *  @xcite , the leading commercial phylogenetics package .",
    "we attempted to use phylip s exact branch - and - bound method dna penny for nucleotide sequences , but discontinued the tests when it failed to solve any of the data sets in under 24 hours . in each case",
    ", pars and paup * were run with default parameters .",
    "we first report results from three moderate - sized data sets selected to provide varying degrees of difficulty : a set of 1,043 sites from a set of 41 sequences of _ o.  rufipogon _ ( red rice )  @xcite , 245 positions from a set of 80 human mt - dna sequences reported by  @xcite , and 176 positions from 50 hiv-1 reverse transcriptase amino acid sequences .",
    "the hiv sequences were retrieved by ncbi blastp  @xcite searching for the top 50 best aligned taxa for the query sequence gi 19571541 and default parameters .",
    "we then added additional tests on larger data sets all derived from human mitochondrial dna .",
    "the mtdna data was retrieved from ncbi blastn , searching for the 500 best aligned taxa for the query sequence gi 61287976 and default parameters .",
    "the complete set of 16,546 characters ( after removing indels ) was then broken in four windows of varying sizes and characteristics : the first 3,000 characters ( mt3000 ) , the first 5,000 characters ( mt5000a ) , the next 5,000 characters ( mt5000b ) , and the first 10,000 characters ( mt10000 ) .",
    "table  [ datatable1 ] summarizes the results .    for the set of 41 sequences of lhs-1 gene from _ o.  rufipogon _ ( red rice )  @xcite ,",
    "our method pruned the full graph of @xmath219 nodes ( after screening out redundant characters ) to 58 .",
    "fig [ phylogenies](a ) shows the resulting phylogeny .",
    "both paup * and pars yielded an optimal tree although more slowly than the ilp ( 2.09 seconds and 2.57 seconds respectively , as opposed to 0.29 seconds ) .    for the 245-base human mt - dna sequences ,",
    "the generalized buneman pruning was again highly efficient , reducing the state set from @xmath220 after removing redundant sequences to 64 .",
    "fig [ phylogenies](b ) shows the phylogeny returned .",
    "while paup * was able to find the optimal phylogeny ( although it was again slower at 5.69 seconds versus 0.48 seconds ) , pars yielded a slightly sub - optimal phylogeny ( length 45 instead of 44 ) in a comparable run time ( 0.56 seconds ) .    for hiv-1 sequences ,",
    "our method pruned the full graph of @xmath221 possible nodes to a generalized buneman graph of 297 nodes , allowing solution of the ilp in about two minutes .",
    "fig [ phylogenies](c ) shows an optimal phylogeny for the data .",
    "paup * was again able to find the optimal phylogeny and in this case was faster than the ilp ( 3.84 seconds as opposed to 127.5 seconds ) .",
    "pars required a shorter run time of 0.30 seconds , but yielded a sub - optimal tree of length of 42 , as opposed to the true minimum of 40 .",
    "for the four larger mitochondrial datasets , buneman pruning was again highly effective in reducing graph size relative to the complete graph , although the ilp approach eventually proves impractical when buneman graph sizes grows sufficiently large .",
    "two of the data sets yielded buneman graphs of size below 400 , resulting in ilp solutions orders of magnitude faster than the heuristics .",
    "mt5000a , however , yielded a buneman graph of over 1,000 nodes , resulting in an ilp that ran more slowly than the heuristics .",
    "mt10000 resulted in a buneman graph of over 6,000 nodes , leading to an ilp too large to solve .",
    "pars was faster than paup * in all cases , but paup * found optimal solutions for all three instances we can verify while pars found a sub - optimal solution in one instance .    we can thus conclude that the generalized buneman pruning approach developed here is very effective at reducing problem size , but solving provably to optimality does eventually become impractical for large data sets .",
    "heuristic approaches remain a practical necessity for such cases even though they can not guarantee , and do not always deliver , optimality .",
    "comparison of paup * to pars and the ilp suggests that more aggressive sampling over possible solutions by the heuristics can lead optimality even on very difficult instances but at the cost of generally greatly increased run time on the easy to moderate instances .",
    "we have presented a new method for finding provably optimal maximum parsimony phylogenies on multi - state characters with weighted state transitions , using integer linear programming .",
    "the method builds on a novel generalization of the buneman graph for characters with arbitrarily large but finite state sets and for arbitrary weight functions on character transitions .",
    "although the method has an exponential worst - case performance , empirical results show that it is fast in practice and is a feasible alternative for data sets as large as a few hundred taxa . while there are many efficient heuristics for recontructing maximum parsimony phylogenies ,",
    "our results cater to the need for provably exact methods that are fast enough to solve the problem for biologically relevant multi - state data sets .",
    "our work could potentially be extended to include more sophisticated integer programming techniques that have been successful in solving large instances of other hard optimization problems , for instance the recent solution of the 85,900-city traveling salesman problem pla85900  @xcite .",
    "the theoretical contributions of this paper may also prove useful to work on open problems in multi - state mp phylogenetics , to accelerating methods for related objectives , and to sampling among optimal or near - optimal solutions .",
    "nm would like to thank ming - chi tsai for several useful discussions .",
    "this work was supported in part by nsf grant # 0612099 .",
    "1 posada , d. , and crandall , k. intraspecific gene genealogies : trees grafting into networks .",
    "trends in ecology and evolution .",
    "16 , 3745 , ( 2001 ) felsenstein , j. inferring phylogenies .",
    "sinauer publications ( 2004 ) foulds , l. r. and graham , r. l. the steiner problem in phylogeny is np - complete advances in applied mathematics 3 , 4349 , ( 1982 ) sridhar , s. , lam , f. , blelloch , g. , ravi , r. , and schwartz , r. efficiently finding the most parsimonious phylogenetic tree .",
    "lecture notes in computer science , springer berlin/ heidelberg .",
    "4463 , 3748 , ( 2007 ) buneman , p. the recovery of trees from measures of dissimilarity .",
    "mathematics in the archeological and historical sciences , f. hodson et al .",
    ", eds . , 387395 , ( 1971 ) barth elemy , j. from copair hypergraphs to median graphs with latent vertices .",
    "discrete math 76 , 928 , ( 1989 ) bandelt , h. j. , forster , p. , sykes , b. c. , and richards , m. b. mitochondrial portraits of human populations using median networks .",
    "genetics 141 , 743753 , ( 1989 ) bandelt , h. j. , forster , p. , and rohl , a. median - joining networks for inferring intraspecific phylogenies . molecular biology and evolution 16 , 3748 , ( 1999 ) huber , k. t. , and moulton , v. the relation graph .",
    "discrete mathematics 244 ( 1 - 3 ) , 153166 , ( 2002 ) zhou , h. f. , zheng , x. m. , wei , r. x. , second , g. , vaughan , d. a. and ge , s. contrasting population genetic structure and gene flow between oryza rufipogon and oryza nivara .",
    "117 ( 7 ) , 11811189 , ( 2008 ) hudjashov , g. , kivisild , t. , underhill , p. a. , endicott , p. , sanchez , j. j. , lin , a. a. , shen , p. , oefner , p. , renfrew , c. , villems , r. , forster , p. revealing the prehistoric settlement of australia by y chromosome and mtdna analysis .",
    "104 ( 21 ) , 87268730 , ( 2007 ) swofford , d. paup * 4.0 .",
    "sinauer assoc .",
    "inc . : sunderland , ma , ( 2009 ) felsenstein , j. phylip ( phylogeny inference package ) version 3.6 distributed by author , department of genome sciences , university of washington , seattle , ( 2008 ) semple , c. , and steel , m. phylogenetics .",
    "oxford university press , ( 2003 ) erdos , p. l. and szekely , l. a. on weighted multiway cuts in trees .",
    "mathematical programming 65 , 93105 , ( 1994 ) wang , l. , jiang , t. , and lawler , l. approximation algorithms for tree alignment with a given phylogeny .",
    "algorithmica16 , 302315 , ( 1996 ) altschul , s. f. , madden , t. l. , schaffer , a. a. , zhang , j. , zhang , z. , miller , w. , and lipman , d. j. gapped blast and psi - blast : a new generation of protein database search programs , nucleic acids res .",
    "25 , 33893402 , ( 1997 ) applegate , d. l. , bixby , r. e. , chvatal , v. , cook , w. , espinoza , d. g. , goycoolea , m. and helsgaun , k. certification of an optimal tsp tour through 85,900 cities .",
    "operations research letters 37 ( 1 ) , 1115 , ( 2009 )"
  ],
  "abstract_text": [
    "<S> accurate reconstruction of phylogenies remains a key challenge in evolutionary biology . </S>",
    "<S> most biologically plausible formulations of the problem are formally np - hard , with no known efficient solution . </S>",
    "<S> the standard in practice are fast heuristic methods that are empirically known to work very well in general , but can yield results arbitrarily far from optimal . </S>",
    "<S> practical exact methods , which yield exponential worst - case running times but generally much better times in practice , provide an important alternative . </S>",
    "<S> we report progress in this direction by introducing a provably optimal method for the weighted multi - state maximum parsimony phylogeny problem . </S>",
    "<S> the method is based on generalizing the notion of the buneman graph , a construction key to efficient exact methods for binary sequences , so as to apply to sequences with arbitrary finite numbers of states with arbitrary state transition weights . </S>",
    "<S> we implement an integer linear programming ( ilp ) method for the multi - state problem using this generalized buneman graph and demonstrate that the resulting method is able to solve data sets that are intractable by prior exact methods in run times comparable with popular heuristics . </S>",
    "<S> our work provides the first method for provably optimal maximum parsimony phylogeny inference that is practical for multi - state data sets of more than a few characters . </S>"
  ]
}