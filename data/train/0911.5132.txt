{
  "article_text": [
    "the field of _ glycobiology _ has undergone rapid growth since its name was coined in 1988@xcite to refer to the study of the molecular structure and biology of saccharides ( or glycans ) as they happen in the cell .",
    "linear polysaccharides are ubiquitous in nature .",
    "glycoproteins , proteoglycans and glycolipids are the most common glycoconjugates in mammalian cells ( found mainly in the outer cell wall and fluids ) .",
    "in particular , glycosaminoglycans ( heparin , heparan sulfate , chondroitin , keratin , dermatan , and many others ) comprise a disaccharide unit formed by two aminosugars linked in an alternating fashion with uronic acids@xcite . in this work",
    "we consider l - iduronic acid ( idoa ) , which is the major uronic acid component of the glycosaminoglycans dermatan sulfate and heparin@xcite .",
    "we also consider its c5 epimer , d - glucuronic acid ( glca ) , that dominates in chondroitin and hyaluronan .",
    "the idoa is an uncommon molecule among the pyranoses ( carbohydrates whose chemical structure is based upon a six - membered ring of five carbon atoms and one oxygen ) because it adopts several conformations , and therefore it is believed to increase the flexibility and conformational freedom of the corresponding polysaccharide chains@xcite .",
    "computational studies of polysaccharides have evolved along several directions . in particular , considerable work has been devoted to quantum chemical studies of the energetics of relatively small compounds ( see , for example , ref . and references therein ) .",
    "while very accurate , such _ ab - initio _ calculations typically can not handle explicit solvent over the nanosecond time scale .",
    "yet , it is known that solvation plays a crucial role in the conformational preferences of carbohydrates@xcite . until recently ,",
    "only coarse - grained models were able to breach the long time scales involved in conformational sampling .",
    "however , methodological advances coupled to growing computational power have allowed the realization of all - atom , explicit solvent classical molecular dynamics over hundreds of nanoseconds@xcite .",
    "this of course requires the development and improvement of force - fields@xcite , which need to be validated by comparison with experiments .",
    "reliable validation necessitates an accurate determination of the properties of the compounds in explicit solvent@xcite , that can be computationally very demanding .    often , the dynamical aspect of the trajectory generated in the course of a molecular dynamics ( ` md ` ) simulation is not of interest _ per se _ , and the trajectory is used to study an ensemble statistics of some quantities .",
    "it was realized long time ago that ` md ` is quite limited when employed for sampling purposes because the trajectory gets trapped in the vicinity of the free energy minima and is very unlikely to cross barriers higher than a few @xmath2 .",
    "many approaches to enhance the sampling have been proposed , with different measures of success .",
    "it is beyond the scope of this paper to review the different methods ( the reader can find a review in ref . ) , but we will briefly go over the two methods employed in this work , namely the `` replica exchange '' method@xcite and the adaptively biased molecular dynamics method@xcite .    the idea behind the replica exchange method is to consider several ` md ` trajectories that are generated using different hamiltonians and exchange those hamiltonians ( or trajectories ) in a way that preserves detailed balance so that all the boltzmann distributions that correspond to the hamiltonians involved get sampled simultaneously in a mutually enhancing way .",
    "the overall performance of the method is determined by the `` right '' choice of the hamiltonians involved in the construction .",
    "for example , `` parallel tempering '' ( the most popular incarnation of the method ) builds the family of hamiltonians by re - scaling the original hamiltonian .",
    "this is identical to the situation where one hamiltonian is used at different temperatures  high - temperature replicas have higher barrier - crossing rates and continuously `` seed '' the low - temperature replicas with different configurations .",
    "the advantage of this method is that it is very general requiring little prior knowledge about the system .",
    "the disadvantage is that , as the number of degrees of freedom increases , more and more replicas are required to cover the desired range of temperatures while maintaining satisfactory exchange rates . in the pure parallel tempering case",
    ", the number of replicas has been shown to grow as the square root of the number of degrees of freedom@xcite .",
    "over the past few years , several methods targeting the computation of the free energy using non - equilibrium simulations have become popular .",
    "these methods all estimate the free energy as a function of `` collective variables '' from an `` evolving '' ensemble of realizations@xcite , and use that estimate to bias the system dynamics , so as to flatten the effective free energy surface .",
    "one of the first methods that used the idea of a dynamically evolving potential that forces the system to explore unexplored regions of the phase space was the local elevation method@xcite .",
    "more recent developments include the adaptive force bias method@xcite , the wang - landau approach@xcite , and the non - equilibrium metadynamics@xcite method .",
    "collectively , all these methods may be considered as umbrella sampling methods in which the biasing force compensates for the free energy gradient . in the long time",
    "limit , the biasing potential eventually reproduces the previously unknown free energy surface .",
    "the adaptively biased molecular dynamics ( ` abmd ` ) method@xcite grew out of our efforts to streamline the metadynamics method for classical biomolecular simulations@xcite .",
    "it shares all the important characteristics of the above methods while including enhancements in its own right such as a favorable @xmath3 scaling with time @xmath4 , and a fewer number of control parameters .",
    "adaptive bias methods have been recently used to enhance the conformational sampling of small sugars in explicit water .",
    "these efforts include the use of the local elevation method to calculate the relative free energies and interconversion barriers of the ring conformers of @xmath1-d - glucopyranose in water@xcite , and the use of metadynamics to recover the conformational free energy surface of @xmath0-n - acetylneuraminic acid@xcite and @xmath1-d - glucopyranose@xcite .",
    "the latter work is an important contribution to the force - field validation process .",
    "it is possible to harness the power of replica exchange with a suitable family of hamiltonians that are built by biasing the original hamiltonian along relevant slow modes .",
    "these biasing potentials can be readily computed using the adaptive bias methods . in this paper , we combine the ` abmd ` method with the replica exchange and the weighted histogram analysis ( ` wham`@xcite ) methods in order to achieve robust sampling of the conformational space of the pyranose ring in explicit solvent , and recover the potential of mean force ( free energy ) associated with two intra - ring dihedral angles describing the slow puckering modes .",
    "the free energy alone could be computed by  correcting \" the biasing potential obtained by ` abmd ` with an equilibrium run , as discussed at length in ref .. the approach explored in this paper replaces the  correction \" step with a replica - exchange simulation that both  corrects \" the approximate biasing potential _ and _ efficiently samples unbiased equilibrium configurations .",
    "our study has two main goals .",
    "first , we present a simulation protocol that allows for efficient sampling of the degrees of freedom of a solute in explicit solvent .",
    "second , we illustrate how this approach can be used to validate the new ` glycam  06 ` force field@xcite by means of applying it to the study of the puckering landscapes of the methyl glycosides of @xmath0-l - iduronic acid and its c5 epimer @xmath1-d - glucuronic acid ( see fig.[fig : epimers ] ) .",
    "the paper is organized as follows : the methodology is described in the next section which is followed by the presentation of the simulation protocol along with the results .",
    "the paper then ends with a short summary .",
    "let us consider a system of @xmath5 classical particles .",
    "the state of the system can be described by the positions of the particles @xmath6 and their momenta @xmath7 .",
    "let @xmath8 be the hamiltonian of the system . here , @xmath9 are the masses of the particles and @xmath10 is the potential energy . in the following ,",
    "we omit the atomic indices if this does not lead to confusion , that is , @xmath11 represents @xmath6 and @xmath12 represents @xmath7 .",
    "a routine task in molecular modeling involves sampling configurations according to the canonical distribution @xmath13 ( @xmath14 is the boltzmann constant and @xmath15 is the temperature ) .",
    "one way of carrying out such sampling is , for instance , to generate dynamics via the langevin equation such that its limiting probability distribution is the desired equilibrium distribution@xcite .",
    "unfortunately this basic strategy often fails because the system gets either trapped in the neighborhood of a potential energy minimum or locked in some region of phase space due to entropic bottlenecks .",
    "hence , other more elaborate approaches have been proposed throughout the years ( see , for example , a review in ref . ) . in this paper",
    "we describe how a combination of the replica exchange@xcite , ` abmd`@xcite and ` wham`@xcite methods can be used to enhance sampling , and illustrate the use of this protocol by applying it to the study of small solutes in explicit solvent . for clarity and completion , we briefly review these methods below .",
    "the replica exchange idea@xcite consists of considering several hamiltonians , @xmath16 , @xmath17 ( with the original @xmath18 being of one them ) , running the dynamics for each of them , and trying to `` cross - pollinate '' these dynamics by exchanging the trajectories between the different hamiltonians from time to time .",
    "more formally , the method can be implemented as follows : once in a while a random pair of replicas is chosen and an exchange is attempted with the acceptance probability carefully tuned to maintain detailed balance in the extended ensemble@xcite @xmath19 @xmath20\\\\           & + & \\frac{1}{k_bt_b}\\left[\\phi_b({\\mathbf{r}}^a ) - \\phi_b({\\mathbf{r}}^b)\\right],\\end{aligned}\\ ] ] where @xmath21 denote the temperatures of the replicas and only the potential energy is shown ( the momenta are integrated out ) . in practice , the momenta get simply rescaled upon a successful exchange . in this scheme , high , inaccessible barriers in one replica can be smaller in another replica and hence this random walk over the replicas facilitates barrier crossings .",
    "care must be taken with the choice of hamiltonians since it determines the performance of the method .",
    "there are many variations of replica exchange , with the most popular one being `` parallel tempering '' : the family of the hamiltonians is constructed from the rescaled copies of the original one ( this is equivalent to having the same hamiltonian with different temperatures ) .",
    "parallel tempering has the advantage of being quite general , but the applicability of the method can be limited by the fact that the number of replicas needed to cover a desired temperature range ( while maintaining an efficient random walk across those temperatures ) grows as the square root of the number of degrees of freedom@xcite .",
    "the ` abmd`@xcite method is an umbrella sampling method with a time - dependent biasing potential that can be used to compute the landau free energy of a collective variable @xmath22 , which is understood to be a smooth function of the atomic positions .",
    "the landau free energy is defined as@xcite : @xmath23\\big>,\\;\\ ] ] where the angular brackets denote an ensemble average .",
    "the free energy @xmath24 ( sometimes also referred to as the potential of mean force ) describes the relative stability of states corresponding to different values of @xmath25 , and can provide insight into the possible transitions between these states .",
    "in the ` abmd ` method an additional time - dependent biasing potential is added to the potential energy of the system @xmath26.\\ ] ] this biasing potential `` floods '' the true free energy landscape as it evolves in time according to : @xmath27.\\ ] ] in the last equation @xmath28 denotes the _ kernel _ , which is thought to be positive and symmetric ( in analogy to the _ kernel density estimator _ widely used in statistics@xcite ) . for large enough @xmath29 ( flooding timescale ) and small enough kernel width , the biasing potential @xmath30 converges towards @xmath31 as @xmath32@xcite .",
    "the implementation of the method is straightforward : we use cubic b - splines@xcite ( or products of thereof for multidimensional collective variables ) to discretize @xmath30 in `` space '' : @xmath33 @xmath34 we choose the biweight kernel@xcite for @xmath28 : @xmath35 and euler - like discretization scheme for the time evolution of the biasing potential : @xmath36,\\ ] ] where @xmath37 is at time @xmath4 .",
    "this discretization in time may readily be improved .",
    "however , this is not really important , since the goal is simply to flatten @xmath38 in the long time limit .      in this paper",
    "the ` abmd ` method is used to construct the hamiltonians for the replica exchange scheme .",
    "in particular , we are interested in the properties of a relatively small solute , with a few degrees of freedom , immersed in a much larger `` bath '' of solvent molecules .",
    "parallel tempering is impractical for such a system due to the large total number of degrees of freedom , requiring many replicas that spend most of the time equilibrating the solvent at different temperatures . on the other hand , especially for small solutes",
    ", one can readily identify the slowest modes that are difficult to sample in regular ` md ` on the grounds of physical and/or chemical intuition .",
    "quite often those modes can be described as a motion along a collective variable @xmath39 that does not depend on the solvent coordinates explicitly .",
    "it is therefore reasonable to consider two ( or more  see below ) replicas , both running at the same temperature , with the potential energies @xmath40,\\ ] ] where the last term in @xmath41 is the landau free energy associated with the collective variable @xmath42 computed for the original potential energy @xmath43 .",
    "this last term renders the states with the different values of the collective variable equally probably in the second replica , which thus plays the role of the high - temperature replicas in the parallel tempering scheme , `` speeding '' up the motions along the collective variable .",
    "the first replica uses the unmodified potential energy , thus producing unbiased samples of the configurations of the original system . since both replicas run at the same temperature , the exchange probability given in eq.([eq : exchange_probability ] ) does not depend explicitly on the potential energy difference between the replicas , but on the biasing potentials as a function of the _ solute _ degrees of freedom .",
    "therefore , the necessary number of replicas is expected to be much smaller than it would be for parallel tempering .",
    "the true free energy , @xmath24 , is typically unknown in advance .",
    "we therefore use the ` abmd ` method to compute a biasing potential @xmath44 that approximately compensates for the unknown free energy @xmath45 ( up to an additive constant ) .",
    "this biasing potential is then used to set up the replica exchange scheme that yields both an enhanced sampling of the solute states and a more accurate landau free energy @xmath24 associated with @xmath46 .",
    "the latter is reconstructed using the familiar ` wham ` approach@xcite briefly summarized in the next subsection .",
    "the overall success of the replica exchange scheme is determined by the efficiency of the random walk in the replica space .",
    "the latter can be quantified by the exchange rates between the pairs of replicas .",
    "let us consider two replicas running at the same temperature @xmath15 with the potential energies @xmath47,\\ ] ] given by the original potential energy @xmath43 biased by the potentials @xmath48 acting on the collective variable @xmath46 , which is the same in both replicas .",
    "the exchange probability eq.([eq : exchange_probability ] ) then becomes @xmath49 where @xmath50 is the heaviside step function , @xmath51,\\ ] ] and @xmath52 are the values of the collective variable @xmath46 in the corresponding replicas .",
    "the probability densities of the collective variables can be expressed through the associated landau free energy , @xmath24 , computed for the original potential @xmath43 : @xmath53\\big / k_bt},\\ ] ] and can readily be used in the expression for the rate of exchange between the two replicas @xmath54 the integrals in the above formula are low - dimensional and can easily be computed numerically .    from a practical point of view",
    ", the two replicas used in the preceding discussion often render the exchange rate unacceptably low .",
    "this can be solved by introducing more replicas , such that the range of biasing potentials goes from zero to the full ( approximate ) negative free energy through some intermediates . for the present study we chose to use three replicas biased as follows : @xmath55,\\\\    & \\phi_3({\\mathbf{r } } )",
    "=      \\phi({\\mathbf{r } } ) + \\;\\;u\\big[\\sigma({\\mathbf{r}}_1,\\dots,{\\mathbf{r}}_s)\\big],\\end{aligned}\\ ] ] where the parameter @xmath56 is found by imposing equality of exchange rates , @xmath57 .",
    "this equation is solved numerically .",
    "the resulting exchange rates turned out to be around 30% and were deemed satisfactory .",
    "otherwise , more intermediate replicas would have to be introduced following the same reasoning .",
    "here we review the ` wham`@xcite scheme , following the presentation given in refs .. the aim of the ` wham ` approach is to infer the _ unbiased _ free energy out of several _ biased _ simulations .",
    "more precisely , let us consider @xmath58 simulations biased by some potentials @xmath59 , @xmath60 that depend on atomic positions through a collective variable @xmath22 , that is , @xmath61.\\ ] ] let @xmath62 denote the number of values of the collective variable @xmath42 collected in the @xmath63 simulation : @xmath64 ( with @xmath60 ) . by the end of the simulations ,",
    "the whole sample @xmath65 contains @xmath66 values of the collective variable that are supposed to be statistically independent .",
    "the _ _ likelihood _ _ , is conditional probability of @xmath67 given @xmath68 . ]",
    "to observe a single value of the collective variable in the @xmath63 simulation is @xmath69e^{\\textstyle-\\beta\\phi_m},\\ ] ] where @xmath70 , @xmath71 and @xmath72 the likelihood ( [ eq : likelihood1 ] ) can be expressed through the landau free energy @xmath24 ( which is to be determined ) associated with the collective variable @xmath73      \\mathrm{e}^{\\textstyle-\\beta \\phi},\\ ] ] as @xmath74 where @xmath75 @xmath76 and @xmath77 the likelihood of the whole dataset @xmath65 is @xmath78 by introducing individual `` densities '' @xmath79 one can rewrite the likelihood ( [ eq : likelihoodd ] ) as follows @xmath80\\gamma_m(\\xi).\\end{aligned}\\ ] ] the maximum likelihood principle @xmath81 then leads to the celebrated ` wham ` equations@xcite @xmath82 where @xmath83 in practice@xcite , people typically use histograms to approximate the densities eq.([eq : distribution ] ) and then solve the ` wham ` equations eq.([eq : wham ] ) to find the weights @xmath84 iteratively .",
    "another possibility , which is exploited in this paper , is to maximize the likelihood with respect to the unknown free energy @xmath24 numerically .",
    "there are some issues with this approach too .",
    "first , the method of maximum likelihood is not very useful if applied directly to the likelihood given by eq.([eq : likelihood ] ) because the functional is maximized by a sum of delta function spikes at the observations@xcite .",
    "the likelihood should be maximized over a particular class of functions instead . technically this is typically implemented by adding a penalty term to the likelihood@xcite .",
    "while theoretically interesting , in this paper we overcome the problem in a similar way that ` wham ` does : by smoothening the `` densities '' ( [ eq : distribution ] ) . unlike the classical ` wham ` papers , where the densities are approximated by piece - wise constants ( histograms ) , we use the so - called _ kernel density estimator _ for the biased densities ( [ eq : distribution ] ) .",
    "that is , we replace @xmath85 by @xmath86 which is obtained from the former by using gaussian kernels @xmath87\\ ] ] in place of the @xmath88-functions .",
    "another issue with the functional ( [ eq : likelihood ] ) is that it is invariant with respect to the shifts of the free energy @xmath24 by a constant .",
    "while perfectly physical , this feature needs special attention in a numerical setting and hence it is desirable to get rid of it before hand . to this end , we consider the following functional@xcite in place of the original one : @xmath89 it is easy to see that the unconstrained minimum of the @xmath90 functional coincides with a constrained maximum of the original likelihood ( [ eq : likelihood ] ) .",
    "the functional ( [ eq : action ] ) is thus much more convenient for numerical treatment since the constrained optimization problem gets reduced to an unconstrained one .",
    "structure of the methyl glycosides of @xmath0-l - iduronic acid ( idoa , left ) and its c5 epimer @xmath1-d - glucuronic acid ( glca , right ) . ]    technically , we represent the unknown free energy @xmath24 in the cubic @xmath68-splines@xcite basis , just as we do with the biasing potential @xmath44 .",
    "the functional @xmath90 then becomes a function of the coefficients .",
    "finally , we minimize this function to find the unknown coefficients numerically using the ` l - bfgs ` algorithm@xcite .",
    "we consider methyl glycosides of the @xmath0-l - iduronic acid ( idoa ) , the major uronic acid component of the glycosaminoglycans dermatan sulfate and heparin@xcite , and its c5 epimer , @xmath1-d - glucuronic acid , predominant in heparan sulfate ( fig.[fig : epimers ] ) .",
    "the idoa residue is special among pyranoses because it can adopt several conformations , thus giving flexibility and conformational freedom to the corresponding polysaccharide chains@xcite .",
    "we concentrate on the conformational sampling of these molecules as parameterized by the ` glycam  06`@xcite force - field in explicit ` tip3p`@xcite water .",
    "there are fourteen `` canonical '' puckering states of the pyranose ring that minimize the angle strain : two chairs , six boats and six skew - boats ( see ref . for a more comprehensive presentation ) .",
    "the @xmath91 and @xmath92 chair conformations , the @xmath93 and @xmath94 skew - boats , and the nomenclature for the ring carbon atoms , are sketched in fig.[fig : conformations ] .",
    "the puckering states are named with a @xmath95 , @xmath68 or @xmath96 letter for chair , boat or skew - boat respectively .",
    "the letter is then superscripted / subscripted with the number(s ) of the atom(s ) above / below the reference plane ( the superscripts are placed in front of the letter while the subscripts go after it ) .",
    "the reference plane is chosen to contain four of the ring atoms and if ambiguity occurs ( in the chair and skew - boat conformers ) , the plane is chosen so that the lowest numbered carbon atom is out of this plane .    for the majority of pyranoses , the @xmath91 chair conformation is the only relevant one with the others being much higher in energy .",
    "the idoa is an exception for which both @xmath91 and @xmath92 chairs have been observed@xcite along with the @xmath93 skew - boat . given the special place of the iduronic acid among the rest of the pyranoses , it is important to be able to accurately reproduce its conformational equilibrium in molecular dynamics simulations .",
    "the barriers separating the two chair conformations are of order of at least @xmath97@xcite , and thus the corresponding transitions are rather unlikely on the 10 - 100 nanosecond timescale . in particular , in ref . , the authors conclude : `` the frequency of ring conformation interchange ... is too slow to allow the accurate prediction of the proportion of each form from molecular dynamics alone '' .",
    "the combination of the methods described in the preceding section allows us to overcome this difficulty .",
    "we use the intra - ring o5c1c2c3 and c3c4c5o5 torsion angles ( denoted @xmath98 and @xmath99 in the following ) to distinguish among the different conformations .",
    "our choice is not unique , but this is of minor importance since the dihedrals adopt distinctly different values for the conformations in question : the values of the angles are of different sign for the chairs ( with @xmath92 corresponding to @xmath100 , @xmath101 and @xmath91 having @xmath102 , @xmath103 ) and of the same sign for the boats and skew - boat conformations .",
    "our goal is to sample the equilibrium configurations of the rings in the ` ntv ` ensemble using explicit solvent .",
    "we proceed in stages as follows : ( 1 ) compute with ` abmd ` an approximate free energy for the dihedral angles using a relatively cheap and fast implicit solvent model ; ( 2 ) introduce explicit solvent and `` refine '' the potential of mean force ( ` pmf ` ) from the previous step ; ( 3 ) set up a replica exchange scheme that uses the approximate ` pmf ` to sample from an unbiased canonical distribution while collecting the biased samples as well .",
    "the trajectories from the last step are then used to study equilibrium properties of the rings and to recover the accurate free energies using the ` wham ` technique .",
    "the general philosophy behind the protocol is to start with coarser , considerably cheaper approximations that are successively refined with more accurate , expensive approaches such that the final results have the accuracy of the expensive approach at a fraction of the cost .",
    "thus we start with implicit solvent and then use these results as the starting point for explicit solvent .",
    "let us describe the simulation protocol step by step .",
    "the simulation technical details can be found in appendix  [ sec : numerics ] .",
    "we start sampling in implicit water .",
    "a short run at @xmath104 revealed that the angles fluctuate with an amplitude of @xmath105 degrees and a characteristic time ( taken to be the period of oscillations here ) of 0.5ps .",
    "we thus performed a flooding ` abmd ` run with @xmath106 ( for both torsional angles ) and @xmath107 .",
    "we monitored the trajectory and continued running until both angles visited all the values between @xmath108 and @xmath109 ( that is , until the minima corresponding to both the @xmath91 and @xmath110 chair conformations and skew - boat configurations were `` flooded '' ) .",
    "the coarse stage took 1ns .",
    "we then decreased the spatial resolution to @xmath111 and increased the timescale to @xmath112 and continued the flooding to refine the biasing potential obtained in the previous step .",
    "it took 3ns more of simulation time to cover the desired values of @xmath113 .",
    "the biasing potential at this stage is expected to provide a relatively good approximation of the corresponding free energy .",
    "( it is not necessary to compute the error at this stage since this potential is only an approximation to be used in the next step ) .",
    "regarding the choice of the `` spatial '' resolution @xmath114 , we have to balance two conflicting factors : a smaller resolution allows the identification of the finer details of the free energy ; yet for a smaller @xmath114 ( and fixed flooding rate @xmath29 ) , the accuracy of the free energy decreases because the system experiences stronger biasing forces pushing it out of the thermodynamic equilibrium .",
    "we thus choose the resolution to be sufficiently small to approximate the equilibrium minima well .",
    "it is reasonable to expect that the biasing potential obtained with implicit solvent provides a good approximation for the free energy in explicit solvent . to account for the differences between the two solvent descriptions",
    ", we carried out more flooding in explicit solvent with @xmath112 and @xmath115 ( i.e. , the `` fine '' values used for the implicit solvent simulation ) .",
    "after just 5ns , every value of the angles was visited and so we stopped the flooding .",
    "next , we performed a 5ns equilibrium ` md ` run biased by the biasing potential computed so far .",
    "the biased trajectory visited all the values in the interval @xmath116 .",
    "this means that the biasing potential approximates the true free energy surface to within a few @xmath2 ( otherwise the trajectory would get trapped somewhere ; the fact that @xmath113 sweep the whole region implies that the error is of order of a few @xmath2 at most ) .",
    "finally , we set up a replica exchange scheme that samples both biased and unbiased configurations .",
    "this allows for : ( a ) the computation of the accurate free energy associated with the ring puckering states , and ( b ) the computation of the unbiased equilibrium averages , such as @xmath117-couplings , which are of particular interest since they allow for a direct comparison with the ` nmr ` data .",
    "this last aspect is of paramount importance for the force - field development .",
    "as we described in the `` methods '' section , we put three replicas together : the first replica is not biased , the second one is biased by @xmath118 , and the third one is biased by the full @xmath44 .",
    "we determined the value of @xmath119 numerically solving the equation @xmath120 .",
    "after a short 1ns equilibration , we went into  production runs \" for 100ns trying to exchange a random pair of replicas every 1ps .",
    "the observed exchange rates of @xmath121 were in perfect agreement with the expected values ( computed assuming that @xmath122 ) for both idoa and glca cases .",
    "we emphasize that the simulations in explicit solvent involve jumps over barriers of order of 6.5kcal / mol ( @xmath97 ) . in order for conventional parallel tempering to be able to sample this system ,",
    "the highest temperature replica would have to run at @xmath123 .",
    "this is a prohibitively large number since several hundreds replicas running at intermediate temperatures would be needed to proxy between the highest and the lowest ( room ) temperatures .",
    "since the autocorrelation time for the angles in a fully biased ` md ` run is approximately 10ps , we regarded the samples taken 10ps apart during the equilibrium replica exchange as statistically `` independent '' .",
    "therefore we saved the coordinates from the unbiased replica every 10ps to compute various equilibrium properties of the idoa and glca , reported in the subsection below .",
    "we used the whole sample from all three replicas and the ` wham ` scheme to recover the accurate free energy , shown in fig.[fig : fe ] .",
    "a crucial part of this step is the selection of the kernel bandwidth @xmath124 in eq.([eq : kernel ] ) .",
    "assuming that the data is statistically independent , we computed optimal @xmath124 by minimizing the least - squares cross - validation score to get @xmath125 for all the runs ; we also computed the bandwidths by maximizing the likelihood cross - validation score getting @xmath126 for all the runs .",
    "the values selected by both methods were checked using the silverman s `` visual '' method and appeared to be too small ( a problem described , for example , in ref . ) . combining all the hints we chose @xmath127 for the unbiased , intermediate and fully biased replicas , respectively .",
    "we computed the cremer - pople puckering parameters@xcite regarding the o5 oxygen as the ring apex ( atom number one in the cremer - pople formulae ) and the carbon with the glycosidic linkage ( c1 ) as the atom number two .",
    "the mean value of the puckering amplitude @xmath128 turned out to be 0.53 and 0.55 ( for idoa and glca respectively ) with standard deviation @xmath129 for both compounds .",
    "both @xmath130 and @xmath131 pseudo - rotation angles display somewhat larger variations and hence are shown in fig.[fig : pucker ] using the hammer - aitoff@xcite equal - area projection : @xmath132 the @xmath133 values are consistent with the free energies associated with the @xmath113 ( see fig.[fig : fe ] ) : there are two well - pronounced clusters near the poles for idoa corresponding to the @xmath91 ( north pole , @xmath134 ) and @xmath92 ( south pole , @xmath135 ) chair conformations , and just one big cluster near the north pole ( @xmath91 chair ) for the glca .",
    "the boat and twisted boat conformations correspond to the equatorial area ( @xmath134 ) and are indeed considerably less frequent than the chairs .",
    "for idoa the majority of the `` equatorial '' samples is around @xmath136 ( @xmath93 skew - boat ) , yet several other twisted boat conformations are also present .",
    "this is in accord with ref . where it has been suggested that not only `` canonical '' boat and skew - boat conformations , but also various boat - like intermediates , contribute to the conformational equilibrium .",
    "the most frequent skew - boat conformation for glca observed to be @xmath94 ( @xmath131 around @xmath137 ) .    in order to identify the pyranose puckering states explored during the simulations",
    ", one has to choose a criterion for assigning a particular trajectory section to a canonical puckering state .",
    "when the temperature is zero , the potential energy minima typically define the conformations in a unique and natural way . at non - zero temperature , however , some ambiguity is always present due to the thermal fluctuations . in our simulations ,",
    "the @xmath91 and @xmath92 chair conformations are clearly discriminated by the signs of the @xmath113 angles and hence we assume that the equilibrium samples with @xmath138 are @xmath91 chairs while those with @xmath139 are @xmath92 chairs .",
    "the boat and skew - boat conformations , on the other hand , correspond to angles of the same sign , yet it is difficult to distinguish among the different boat and skew - boat types using the @xmath113 angles alone .",
    "the cremer - pople parameters could potentially discriminate among the boats , but the ambiguity still persists as one would have to set the boundaries between the conformations .",
    "thus , in the following we concentrate on the properties of the chair conformations , although our simulations show that different skew - boat conformations show up at the thermodynamic equilibrium . in the case of idoa",
    "the majority of those are @xmath93-like ( left panel in fig.[fig : pucker ] : dots in the equatorial area with @xmath131 around @xmath140 ) and @xmath141-like ( @xmath131 around @xmath142 ) .",
    "this is in agreement with the conclusions of mulloy and forster@xcite that the @xmath143 transformation of idoa proceeds through the @xmath93 and @xmath141 intermediates .",
    "we were able to compute the free energy differences between the @xmath91 and @xmath92 states by counting the number of configurations @xmath144 with the appropriate signs of the @xmath113 angles : @xmath145 where @xmath146 and @xmath147 denote the probabilities of the corresponding conformations .",
    "we obtained @xmath148 in other words , @xmath92 turns out to be marginally more stable than @xmath91 for idoa , while for glca , @xmath91 is considerably more stable than @xmath92 .",
    "the preference of @xmath92 over @xmath91 for idoa appears to be largely due to solvation effects  the vacuum energies optimized in the ` glycam  06 ` force - field differ merely by 0.2kcal / mol . on the other hand",
    ", the @xmath91 has much lower energy than @xmath92 for the glca in the gas phase and thus the @xmath91 stability in water is more due to the `` internal '' energetics than to solvent interactions or temperature .",
    ".[tbl : torsions ] mean value and standard deviation ( in parenthesis ) of the intra - ring bond and dihedral angles for idoa and glca methyl glycosides in @xmath91 and @xmath92 conformations ( degrees ) . [ cols=\"<,^,^,^ \" , ]     finally , in order to make connection with ` nmr ` spectral data@xcite , we computed the j - couplings for these molecules . also known as indirect dipole - dipole coupling , a j - coupling is the coupling between two nuclear spins caused by bonding electrons acting on the magnetic field through the two nuclei .",
    "j - couplings can be linked to the dihedral angles via the karplus equation@xcite : @xmath149 we used the values of the parameters reported in ref ..",
    "the @xmath150-coupling constants are presented in fig.[fig : jcouplings ] .",
    "we have carried out a considerably accurate sampling of phase space for these molecules , but naturally the validity of the final numbers depend on the validity of the force - field and is also limited by the accuracy of the karplus equation eq.([eq : karplus ] ) .",
    "the distribution of the @xmath150 values for idoa clearly reflects the contributions from the two chair conformations , yet the mean values do not match the ones reported in ref . exactly .",
    "specifically , the mean values of the @xmath150 for the methyl-@xmath0-l - iduronic acid reported in ref .",
    "( line 1 , table i in that reference ) are @xmath151 , @xmath152 , @xmath153 and @xmath154 hz implying that @xmath91 is favored over @xmath92 contrary to our results .",
    "we also note that , due to the bimodal nature of the idoa s @xmath150 distributions ( see fig.[fig : jcouplings ] ) , the discrepancies of the mean values can be deceptive . unfortunately , while there are ample experimental data on oligo- and polysaccharides , information about their monosaccharide units is sketchy and scattered across the scientific literature@xcite , which prevents more rigorous comparisons .",
    "distributions of the h - h coupling constants computed using the karplus equation for idoa ( left ) and glca ( right ) .",
    "mean value shown in the insets . ]",
    "in this work we carried out simulations of methyl-@xmath0-l - iduronic and methyl-@xmath1-d - glucuronic acids parametrized by the ` glycam  06 ` force field in explicit ` tip3p ` water . the importance of these small sugars is greatly due to the fact that idoa is the major uronic acid component of the glycosaminoglycans dermatan sulfate and heparin , while glca dominates in heparan sulfate .",
    "the main purpose of this work was to introduce a procedure that reliably recovers the free energy of the solvated molecules and samples the solute degrees of freedom in explicit solvent using very moderate computational resources .",
    "succinctly , the protocol involves the following steps : ( i ) use ` abmd ` to compute an approximate free energy for the intra - ring dihedral angles in a relatively cheap implicit solvent ; ( ii ) refine the free energy with ` abmd ` under explicit solvent ; ( iii ) use this last free energy to set up a hamiltonian replica exchange scheme that samples both from biased and unbiased distributions ; and ( iv ) recover the accurate free energies via the ` wham ` technique applied to all the replicas , and compute equilibrium properties of the rings from the unbiased trajectories .",
    "the protocol appears to be slightly more complex than the standard parallel tempering method . however , big savings in computational resources fully compensate for this extra  complication \" . the simulations in explicit solvent reported in this paper involve jumps over barriers of order of @xmath97 .",
    "an efficient parallel tempering setup in this case would have to run the highest temperature replica at @xmath155 .",
    "this rather high temperature would in turn require several hundred replicas to mediate between this highest and the room temperature . in our scheme",
    "all replicas run at the same temperature , and hence the exchange probability given in eq.([eq : exchange_probability ] ) does not depend explicitly on the potential energy difference between the replicas ; it depends , instead , on the differences of the biasing potentials , which are functions of the _ solute _ degrees of freedom only .",
    "therefore , the necessary number of replicas is considerably smaller ( three replicas were enough for the pyranose rings considered in this paper ) .",
    "once that accurate sampling is not an issue anymore , one can really concentrate on problems associated with the validity of the force - field representation .",
    "in particular , one can compare against experimentally measurable quantities , such as @xmath117-couplings , with the certitude that any deviations from experimental values are due to inaccuracies of the force - field ( of course , assuming that the experimental values are correct ) .",
    "naturally , one can extend this study to take into account the effects of different densities , salt concentrations , temperature , etc .",
    "this research was supported by nsf under grant frg-0804549 .",
    "we also thank the nc state hpc for computer time .",
    "the simulations presented in this paper were performed using the ` amber  10`@xcite simulation package . the ` leap ` program from that package was used to prepare the initial structures along with the topology / parameter files .",
    "the ` glycam  06`@xcite force field was used for the solutes .",
    "the implicit solvent simulations were carried out using the generalized born model@xcite , including surface area contribution computed using the ` lcpo ` model@xcite with the surface tension set to @xmath156 kcal / mol / @xmath157 .",
    "the ` gb / sa ` simulations were performed enforcing no cutoff on the non - bonded ( van der waals and electrostatics ) interactions .",
    "the ` tip3p ` water model@xcite was used for the explicit solvent simulations ( in each case 645 water molecules were added along with a @xmath158 ion to neutralize the system ) . for the explicit water simulations , we used periodic boundary conditions with fixed box size ( 27 in all three directions ) chosen to render the density equal to @xmath159 .",
    "the particle mesh ewald ( ` pme`)@xcite method was used with the direct space cutoff set to 9 and a @xmath160 grid for the smooth part of the ewald sum .",
    "the lengths of all bonds that contain hydrogen were fixed via the ` shake ` algorithm with the tolerance set to @xmath161 .",
    "langevin dynamics@xcite with collision frequency @xmath162 was used to keep the temperature at 300k .",
    "a different random number generator seed was set for every run ."
  ],
  "abstract_text": [
    "<S> we present a simulation protocol that allows for efficient sampling of the degrees of freedom of a solute in explicit solvent . </S>",
    "<S> the protocol involves using a non - equilibrium umbrella sampling method , in this case the recently developed adaptively biased molecular dynamics method , to compute an approximate free energy for the slow modes of the solute in explicit solvent . </S>",
    "<S> this approximate free energy is then used to set up a hamiltonian replica exchange scheme that samples both from biased and unbiased distributions . </S>",
    "<S> the final accurate free energy is recovered via the ` wham ` technique applied to all the replicas , and equilibrium properties of the solute are computed from the unbiased trajectory . </S>",
    "<S> we illustrate the approach by applying it to the study of the puckering landscapes of the methyl glycosides of @xmath0-l - iduronic acid and its c5 epimer @xmath1-d - glucuronic acid in water . </S>",
    "<S> big savings in computational resources are gained in comparison to the standard parallel tempering method . </S>"
  ]
}