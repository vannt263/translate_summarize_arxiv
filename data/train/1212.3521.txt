{
  "article_text": [
    "the method of least squares is a powerful technique for the approximate solution of overdetermined systems and is often used for data fitting and statistical inference in applied science and engineering . in this paper",
    ", we will primarily consider the linear least squares problem @xmath5 where @xmath6 is dense and full - rank with @xmath1 , @xmath7 , @xmath8 , and @xmath9 is the euclidean norm .",
    "formally , the solution is given by @xmath10 where @xmath11 is the moore - penrose pseudoinverse of @xmath12 , and can be computed directly via the qr decomposition at a cost of @xmath13 operations @xcite .",
    "this can be prohibitive when @xmath14 and @xmath15 are large .",
    "if @xmath12 is structured so as to support fast multiplication , then iterative methods such as lsqr @xcite or gmres @xcite present an attractive alternative . however , such solvers still have several key disadvantages when compared with their direct counterparts :    the convergence rate of an iterative solver can depend strongly on the conditioning of the system matrix , which , for least squares problems , can sometimes be very poor . in such cases ,",
    "the number of iterations required , and hence the computational cost , can be far greater than expected ( if the solver succeeds at all ) .",
    "direct methods , by contrast , are robust in that their performance does not degrade with conditioning .",
    "thus , they are often preferred in situations where reliability is critical",
    ".    standard iterative schemes are inefficient for multiple right - hand sides . with direct solvers , on the other hand , following an expensive initial factorization ,",
    "the subsequent cost for each solve is typically much lower ( e.g. , only @xmath16 work to apply the pseudoinverse given precomputed qr factors ) .",
    "this is especially important in the context of updating and downdating as the least squares problem is modified by adding or deleting data , which can be viewed as low - rank updates of the original system matrix .    in this paper",
    ", we present a fast semi - direct least squares solver for a class of structured dense matrices called hierarchically block separable ( hbs ) matrices .",
    "such matrices were introduced by gillman , young , and martinsson @xcite and possess a nested low - rank property that enables highly efficient data - sparse representations .",
    "the hbs matrix structure is closely related to that of @xmath17- and @xmath18-matrices @xcite and hierarchically semiseparable ( hss ) matrices @xcite , and can be considered a generalization of the matrix features utilized by multilevel summation algorithms like the fast multipole method ( fmm ) @xcite .",
    "many linear operators are of hbs form , notably integral transforms with asymptotically smooth radial kernels .",
    "this includes those based on the green s functions of non - oscillatory elliptic partial differential equations @xcite .",
    "some examples are shown in table [ tab : examples ] ; we highlight , in particular , the green s functions @xmath19 for the laplace and biharmonic equations , respectively , in 3d , and their regularizations , the inverse multiquadric and multiquadric kernels @xmath20 respectively ( for @xmath21 not too large ) .",
    ".examples of radial kernels @xmath22 admitting hbs representations : @xmath23 , zeroth order hankel function of the first kind ; @xmath24 , zeroth order modified bessel function of the second kind . [ cols=\"<,<,^,^,<\",options=\"header \" , ]     furthermore , as we have solved an approximate , compressed system , we can not in general fit the data exactly ( with respect to the true operator ) .",
    "indeed , we see relative residuals of order @xmath25 as predicted by the compression tolerance .",
    "thus , our algorithm is especially suitable in the event that observations need to be matched only to a specified precision .",
    "our semi - direct method vastly outperformed both lapack / atlas and fmm / gmres , which required from @xmath26 up to @xmath27 iterations using @xmath28 as a right preconditioner .",
    "deferred correction was successful in all cases within two steps .      in our final example",
    ", we demonstrate the efficiency of our updating and downdating methods in the typical setting of fitting additional observations to an already specified overdetermined system . for this",
    ", we employed the thin plate spline approximation problem of section [ sec : thin - plate - spline ] with @xmath29 and @xmath30 , followed by the addition of @xmath31 new random target points . from section [ sec : updating ]",
    ", the perturbed system can be written as ( [ eqn : equality - least - squares - augmented ] ) with ( [ eqn : row - addition ] ) , i.e. , @xmath32$}.\\ ] ]    we used gmres with the left preconditioner @xmath33 $ ] , which , since @xmath12 has full column rank , gives @xmath34 , hence the preconditioned system is @xmath35 \\mathbf{x } \\simeq \\mathbf{b } \\mathbf{f}.    \\label{eqn : update - setup}\\ ] ] note that only _",
    "one _ application of @xmath11 is necessary , independent of the number of iterations required .",
    "solving this in matlab  took @xmath36 iterations and a total of @xmath37 s , with @xmath38 s going towards setting up ( [ eqn : update - setup ] ) .",
    "the relative residual on the new data was @xmath39 .",
    "this should be compared with the roughly @xmath40 s required to solve the problem without updating , treating it instead as a new system via our compressed algorithm ( table [ tab : overdetermined ] ) .",
    "although this difference is perhaps not very dramatic , it is worth emphasizing that the complexity here scales as @xmath41 with updating versus @xmath42 without , as the former needs only to apply @xmath11 while the latter needs also to compress and factor @xmath43 .",
    "therefore , the asymptotics for updating are much improved .",
    "in this paper , we have presented a fast semi - direct algorithm for over- and underdetermined least squares problems involving hbs matrices , and exhibited its efficiency and practical performance in a variety of situations including rbf interpolation and dynamic updating . in 1d ( including boundary problems in 2d and problems with",
    "separated data in all dimensions ) , the solver achieves optimal @xmath2 complexity and is extremely fast , but it falters somewhat in higher dimensions , due primarily to the growing ranks of the compressed matrices as expressed by ( [ eqn : rank - growth ] ) .",
    "developments for addressing this growth are now underway for square linear systems @xcite , and we expect these ideas to carry over to the present setting .",
    "significantly , the term involving the larger matrix dimension is linear in all complexities ( i.e. , only @xmath44 instead of @xmath13 as for classical direct methods ) , which makes our algorithm ideally suited to large , rectangular systems where both @xmath14 and @xmath15 increase with refinement .    _",
    "remark_. if only _",
    "one _ dimension is large so that the matrix is strongly rectangular , then standard methods are usually sufficient ; see also @xcite .",
    "although we have not explicitly considered least squares problems with hbs equality constraints ( we have only done so implicitly through our treatment of underdetermined systems ) , it is evident that our methods generalize .",
    "however , our complexity estimates can depend on the structure of the system matrix .",
    "in particular , if it is sparse , e.g. , a diagonal weighting matrix , then our estimates are preserved .",
    "we can also , in principle , handle hbs least squares problems with hbs constraints simply by expanding out both matrices in sparse form .",
    "this flexibility is one of our method s main advantages , though it can also create some difficulties .",
    "in particular , the fundamental problem is no longer the unconstrained least squares system ( [ eqn : overdetermined ] ) but the more complicated equality - constrained system ( [ eqn : equality - least - squares ] ) .",
    "accordingly , more sophisticated iterative techniques @xcite are used , but these can fail if the problem is too ill - conditioned .",
    "this is perhaps the greatest drawback of the proposed scheme .",
    "still , our numerical results suggest that the algorithm remains effective for moderately ill - conditioned problems that are already quite challenging for standard iterative solvers . for severely ill - conditioned problems ,",
    "other methods may be preferred .",
    "finally , it is worth noting that fast direct solvers can be leveraged for other least squares techniques as well .",
    "this is straightforward for the normal equations , which are subject to well - known conditioning issues , and for the somewhat better behaved augmented system version @xcite : @xmath45 \\left [    \\begin{array}{c }     r\\\\     x    \\end{array } \\right ] = \\left [    \\begin{array}{c }     b\\\\     0    \\end{array } \\right].\\ ] ] this approach has the advantage of being immediately amenable to fast inversion techniques but at the cost of `` squaring '' and enlarging the system .",
    "thus , all complexity estimates involve @xmath46 instead of @xmath14 and @xmath15 separately . in particular , the current generation of fast direct solvers would require , e.g. , @xmath47 instead of @xmath48 work . with the development of a next generation of linear or nearly linear time solvers @xcite ,",
    "this distinction may become less critical .",
    "memory usage and high - performance computing hardware issues will also play important roles in determining which methods are most competitive .",
    "we expect these issues to become settled in the near future .",
    "we would like to thank the anonymous referees for their careful reading and insightful remarks , which have improved the paper tremendously .    00 , _",
    "lapack users guide _ , siam , philadelphia , pa , 3rd  ed . , 1999 .",
    ", _ on the augmented system approach to sparse least - squares problems _ ,",
    ", 55 ( 1989 ) , pp .",
    ", _ error analysis and implementation aspects of deferred correction for equality constrained least squares problems _ , siam j.  numer .",
    "anal . , 25 ( 1988 ) , pp .",
    "13401358 . , _ the direct solution of weighted and equality constrained least - squares problems _ , siam j.  sci",
    "comput . , 9 ( 1988 ) ,",
    "704716 . , _ a note on deferred correction for equality constrained least squares problems _ , siam j.  numer .",
    ", 29 ( 1992 ) , pp .",
    "249256 . , _ a well - behaved electrostatic potential based method using charge restraints for deriving atomic charges : the resp model _ , j.  phys .",
    ", 97 ( 1993 ) , pp .",
    "1026910280 . , _ on the qr decomposition of @xmath49-matrices _ , computing , 88 ( 2010 ) , pp .",
    "111129 . , _ numerical methods for least squares problems _ , siam , philadelphia , pa , 1996 . , _ data - sparse approximation of non - local operators by @xmath18-matrices _ , linear algebra appl",
    ". , 422 ( 2007 ) , pp .",
    "380403 . ,",
    "_ radial basis functions : theory and implementation _ , cambridge university press , cambridge , 2003 . , _",
    "generalized inverse formulas using the schur complement _ , siam j.  appl .",
    ", 26 ( 1974 ) , pp .",
    "254259 . , _",
    "generalized inverses of linear transformations _ , pitman , london , 1979 . , _ reconstruction and representation of 3d objects with radial basis functions _ , in proceedings of the 28th annual conference on computer graphics and interactive techniques , los angeles , ca , 2001 , pp .",
    "6776 . , _ some fast algorithms for sequentially semiseparable representations _ , siam j.  matrix anal .",
    "appl . , 27 ( 2005 ) , pp .  341364 . , _ a fast solver for hss representations via sparse matrices",
    "_ , siam j.  matrix anal .  appl . , 29 ( 2006 ) ,",
    "6781 . , _ a fast @xmath50 decomposition solver for hierarchically semiseparable representations _ , siam j.  matrix anal .",
    "appl . , 28 ( 2006 ) , pp .",
    "603622 . , _ on the compression of low rank matrices _ ,",
    "siam j.  sci .",
    "comput . , 26 ( 2005 ) , pp .",
    "13891404 . , _ an @xmath51 direct solver for integral equations on the plane _ ,",
    ", _ algorithm 832 : umfpack v4.3an unsymmetric - pattern multifrontal method _ ,",
    "acm trans .  math .",
    "softw . , 30 ( 2004 ) , pp .",
    "196199 . , _ algorithm 915 , suitesparseqr : multifrontal multithreaded rank - revealing sparse qr factorization _ , acm trans .",
    "softw . , 38 ( 2011 ) , pp .",
    "8:18:22 . , _",
    "a hierarchical semi - separable moore - penrose equation solver _ , in wavelets , multiscale systems and hypergeometric analysis , operator theory : advances and applications , 167 , d.  alpay , a.  luger , and h.  woracek , eds .",
    ", birkhuser , basel , 2006 , pp .",
    "_ splines minimizing rotation - invariant semi - norms in sobolev spaces _ , in constructive theory of functions of several variables , lecture notes in mathematics , 571 , w.  schempp and k.  zeller , eds . , springer - verlag , berlin , 1977 , pp .",
    ", _ charges fit to electrostatic potentials .",
    "ii . can atomic charges be unambiguously fit to electrostatic potentials ? _ , j.  comput .",
    ", 17 ( 1996 ) , pp .",
    "367383 . , _ a direct solver with @xmath51 complexity for integral equations on one - dimensional domains _ , front",
    "math .  china .",
    ", 7 ( 2012 ) , pp .",
    "217247 . , _ fmmlib : fast multipole methods for electrostatics , elastostatics , and low frequency acoustic modeling _",
    ", in preparation .",
    "software available from http://www.cims.nyu.edu/cmcl/software.html . , _ fast direct solvers for integral equations in complex three - dimensional domains _ , acta numer .",
    ", 18 ( 2009 ) , pp .",
    "243275 . , _ a fast algorithm for particle simulations _ , j.  comput .",
    ", 73 ( 1987 ) , pp .",
    "325348 . ,",
    "_ a new version of the fast multipole method for the laplace equation in three dimensions _ , acta numer . ,",
    "6 ( 1997 ) , pp .  229269 . , _ some applications of the pseudoinverse of a matrix _ , siam rev .",
    ", 2 ( 1960 ) , pp .",
    "1522 . , _ new fast algorithms for structured linear least squares problems _ , siam j.  matrix anal .",
    ", 20 ( 1998 ) , pp .  244269 . , _ partial differential equations of mathematical physics and integral equations _ , prentice - hall , englewood cliffs , nj , 1988 .",
    ", _ a sparse matrix arithmetic based on @xmath49-matrices .",
    "part i : introduction to @xmath49-matrices _ , computing , 62 ( 1999 ) , pp .",
    "89108 . , _ data - sparse approximation by adaptive @xmath18-matrices _ , computing , 69 ( 2002 ) , pp .  135 . , _ a sparse @xmath17-matrix arithmetic .",
    "part ii : application to multi - dimensional problems _ , computing , 64 ( 2000 ) , pp .",
    "2147 . , _ on @xmath52-matrices _ ,",
    "in lectures on applied mathematics , h .- j .",
    "bungartz , r.  w.  hoppe , and c.  zenger , eds . , springer - verlag , berlin , 2000 , pp .",
    "multiquadric equations of topography and other irregular surfaces _ , j.  geophys .",
    ", 76 ( 1971 ) , pp .",
    "19051915 . ,",
    "_ gmres methods for least squares problems _ , siam j.  matrix anal .",
    "appl . , 31 ( 2010 ) , pp .",
    "24002430 . ,",
    "_ accuracy and stability of numerical algorithms _",
    ", 2nd .  ed . ,",
    "siam , philadelphia , pa , 2002 .",
    ", _ a fast direct solver for structured linear systems by recursive skeletonization _ , siam j.  sci .",
    "34 ( 2012 ) , pp .",
    "a2507a2532 . , _ hierarchical interpolative factorization for elliptic operators : integral equations _ , arxiv:1307.2666 . , _ fast reliable algorithms for matrices with structure _ , siam , philadelphia , pa , 1999 . , _ solving least squares problems _",
    ", prentice - hall , englewood cliffs , nj , 1974 . , _",
    "randomized algorithms for the low - rank approximation of matrices _ , proc .",
    ", 104 ( 2007 ) , pp .",
    "2016720172 . , _ a fast direct solver for boundary integral equations in two dimensions _ , j.  comput .",
    "phys . , 205 ( 2005 ) , pp .  123",
    ", _ lsrn : a parallel iterative solver for strongly over- or underdetermined systems _ , siam j.  sci .",
    "comput . , 36 ( 2014 ) , pp .",
    "c95c118 . , _ lsqr : an algorithm for sparse linear equations and sparse least squares _ ,",
    "acm trans .  math .",
    "8 ( 1982 ) , pp .  4371 . ,",
    "_ radial basis functions for multivariable interpolation : a review _ , in algorithms for approximation , j.  c.  mason and m.  g.  cox , eds . , clarendon press , oxford , 1987 , pp .",
    "143167 . , _ a fast randomized algorithm for overdetermined linear least - squares regression _ , proc .",
    "natl .  acad .",
    ", 105 ( 2008 ) , pp .",
    "1321213217 . ,",
    "_ gmres : a generalized minimal residual algorithm for solving nonsymmetric linear systems _ , siam j.  sci .",
    "7 ( 1986 ) , pp .  856869 . , _ the quadtree and related hierarchical data structures _ , acm comput",
    ", 16 ( 1984 ) , pp .",
    "187260 . , _ a fast algorithm for computing minimal - norm solutions to underdetermined systems of linear equations _ , arxiv:0905.4745 . , _ a superfast method for solving toeplitz linear least squares problems _ , linear algebra appl . ,",
    "366 ( 2003 ) , pp .",
    ", _ on the method of weighting for equality - constrained least - squares problems _ ,",
    "siam j.  numer .",
    ", 22 ( 1985 ) , pp .",
    ", _ automated empirical optimization of software and the atlas project _ , parallel comput . , 27 ( 2001 ) , pp .  335 . , _ a fast randomized algorithm for the approximation of matrices",
    "_ , appl .",
    ", 25 ( 2008 ) , pp .",
    "335366 . ,",
    "_ fast algorithms for hierarchically semiseparable matrices _ , numer .",
    "linear algebra appl . , 17 ( 2010 ) , pp .",
    ", _ a superfast structured solver for toeplitz linear systems via randomized sampling _ , siam j.  matrix anal .",
    "appl . , 33 ( 2012 ) , pp .",
    "837858 . , _ a kernel - independent adaptive fast multipole algorithm in two and three dimensions _ , j.  comput .",
    ", 196 ( 2004 ) , pp ."
  ],
  "abstract_text": [
    "<S> we present a fast algorithm for linear least squares problems governed by hierarchically block separable ( hbs ) matrices . </S>",
    "<S> such matrices are generally dense but _ data - sparse _ and can describe many important operators including those derived from asymptotically smooth radial kernels that are not too oscillatory . </S>",
    "<S> the algorithm is based on a recursive skeletonization procedure that exposes this sparsity and solves the dense least squares problem as a larger , equality - constrained , sparse one . </S>",
    "<S> it relies on a sparse qr factorization coupled with iterative weighted least squares methods . </S>",
    "<S> in essence , our scheme consists of a direct component , comprised of matrix compression and factorization , followed by an iterative component to enforce certain equality constraints . at most two iterations </S>",
    "<S> are typically required for problems that are not too ill - conditioned . for an @xmath0 hbs matrix with </S>",
    "<S> @xmath1 having bounded off - diagonal block rank , the algorithm has optimal @xmath2 complexity . </S>",
    "<S> if the rank increases with the spatial dimension as is common for operators that are singular at the origin , then this becomes @xmath2 in 1d , @xmath3 in 2d , and @xmath4 in 3d . </S>",
    "<S> we illustrate the performance of the method on both over- and underdetermined systems in a variety of settings , with an emphasis on radial basis function approximation and efficient updating and downdating .    </S>",
    "<S> fast algorithms , matrix compression , recursive skeletonization , sparse qr decomposition , weighted least squares , deferred correction , radial basis functions , updating / downdating    65f05 , 65f20 , 65f50 , 65y15 </S>"
  ]
}