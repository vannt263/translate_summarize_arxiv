{
  "article_text": [
    "stochastic fluctuations are intrinsic to fluid dynamics because fluids are composed of molecules whose positions and velocities are random at thermodynamic scales . because they span the whole range of scales from the microscopic to the macroscopic @xcite",
    ", fluctuations need to be consistently included in all levels of description .",
    "stochastic effects are important for flows in new microfluidic , nanofluidic and microelectromechanical devices @xcite ; novel materials such as nanofluids @xcite ; biological systems such as lipid membranes @xcite , brownian molecular motors @xcite , nanopores @xcite ; as well as processes where the effect of fluctuations is amplified by strong non - equilibrium effects , such as ultra clean combustion , capillary dynamics @xcite , and hydrodynamic instabilities @xcite .",
    "one can capture thermal fluctuations using direct particle level calculations .",
    "but even coarse - grained particle methods @xcite are computationally expensive because the dynamics of individual particles has time scales significantly shorter than hydrodynamic time scales .",
    "alternatively , thermal fluctuations can be included in the navier - stokes equations through stochastic forcing terms , as proposed by landau and lifshitz @xcite and later extended to fluid mixtures @xcite .",
    "the basic idea of _ fluctuating hydrodynamics _ is to add a _",
    "stochastic flux _ corresponding to each dissipative ( irreversible , diffusive ) flux @xcite .",
    "this ensures that the microscopic conservation laws and thermodynamic principles are obeyed while also maintaining fluctuation - dissipation balance .",
    "specifically , the equilibrium thermal fluctuations have the gibbs - boltzmann distribution dictated by statistical mechanics .",
    "fluctuating hydrodynamics is a useful tool in understanding complex fluid flows far from equilibrium @xcite but theoretical calculations are often only feasible after ignoring nonlinearities , inhomogeneities in density , temperature , and transport properties , surface dynamics , gravity , unsteady flow patterns , and other important effects . in the past decade fluctuating hydrodynamics has been applied to study a number of nontrivial practical problems @xcite ; however , the numerical methods used are far from the comparable state - of - the - art for deterministic solvers .",
    "previous computational studies of the effect of thermal fluctuations in fluid mixtures @xcite have been based on the compressible fluid equations and thus require small time steps to resolve fast sound waves ( pressure fluctuations ) .",
    "recently , some of us developed finite - volume methods for the incompressible equations of fluctuating hydrodynamics @xcite , which eliminate the stiffness arising from the separation of scales between the acoustic and vortical modes @xcite .",
    "for inhomogeneous fluids with non - constant density , diffusive mass and heat fluxes create local expansion and contraction of the fluid and the incompressibility constraint should be replaced by a `` quasi - incompressibility '' constraint @xcite .",
    "the resulting _ low - mach number _ equations have been used for some time to model deterministic flows with thermo - chemical effects @xcite , and several conservative finite - volume techniques have been developed for solving equations of this type @xcite . to our knowledge",
    ", thermal fluctuations have not yet been incorporated in low mach number models .    in this work",
    "we extend the staggered - grid , finite - volume approach developed in ref .",
    "@xcite to isothermal mixtures of fluids with unequal densities .",
    "the imposition of the quasi - incompressibility constraint poses several nontrivial mathematical and computational challenges . at the mathematical level ,",
    "the traditional low mach number asymptotic expansions @xcite assume spatio - temporal smoothness of the flow and thus do not directly apply in the stochastic context . at the computational level",
    ", enforcing the quasi - incompressibility or equation of state ( eos ) constraint in a conservative and stable manner requires specialized spatio - temporal discretizations . by careful selection of the analytical form of the eos constraint and the spatial discretization of the advective fluxes we are able to maintain strict local conservation and enforce the eos to within numerical tolerances . in the present work ,",
    "we employ an explicit projection - based temporal discretizations because of the substantial complexity of designing and implementing semi - implicit discretizations of the momentum equation for spatially - inhomogeneous fluids @xcite .",
    "thermal fluctuations exhibit unusual features in systems out of thermodynamic equilibrium .",
    "notably , external gradients can lead to _ enhancement _ of thermal fluctuations and to _ long - range _ correlations between fluctuations @xcite .",
    "sharp concentration gradients present during diffusive mixing lead to the development of macroscopic or _ giant fluctuations _",
    "@xcite in concentration , which have been observed using light scattering and shadowgraphy techniques @xcite .",
    "these experimental studies have found good but imperfect agreement between the predictions of a simplified fluctuating hydrodynamic theory and experiments .",
    "computer simulations are , in principle , an ideal tool for studying such complex time - dependent processes in the presence of nontrivial boundary conditions without making the sort of approximations necessary for analytical calculations , such as assuming spatially - constant density and transport coefficients and spatially - uniform gradients . on the other hand , the multiscale ( more precisely , _ many - scale _ ) nature of the equations of fluctuating hydrodynamics",
    "poses many mathematical and computational challenges that are yet to be addressed .",
    "notably , it is necessary to develop temporal integrators that can accurately and robustly handle the large separation of time scales between different physical processes , such as mass and momentum diffusion .",
    "the computational techniques we develop here form the foundation for incorporating additional physics , such as heat transfer and internal energy fluctuations , phase separation and interfacial dynamics , and chemical reactions .",
    "we begin section [ sec : equations ] by formulating the fluctuating low mach number equations for an isothermal binary fluid mixture .",
    "we present both a traditional pressure ( constrained ) formulation and a gauge ( unconstrained ) formulation .",
    "we analyze the spatio - temporal spectrum of the thermal fluctuations in the linearized equations and demonstrate that the low mach equations eliminate the fast ( sonic ) pressure fluctuations but maintain the correct spectrum of the slow ( diffusive ) fluctuations . in section [ sec : temporalintegration ]",
    "we develop projected runge - kutta schemes for solving the spatially - discretized equations , including a midpoint and a trapezoidal second - order predictor - corrector scheme , and a third - order three - stage scheme . in section [ sec : spatialdiscretization ] we describe a spatial discretization of the equations that strictly maintains the equation of state constraint and also obeys a fluctuation - dissipation balance principle @xcite . in section [ sec : giantfluct ] we study the steady - state spectrum of giant concentration fluctuations in the presence of an applied concentration gradient in a mixture of two dissimilar fluids , and test the applicability of common approximations that neglect spatial inhomogeneities .",
    "in section [ sec : mixingmd ] we study the dynamical evolution of giant interface fluctuations during diffusive mixing of two dissimilar fluids , using both hard - disk molecular dynamics and low mach number fluctuating hydrodynamics .",
    "we find excellent agreement between the two , providing a strong support for the usefulness of the fluctuating low mach number equations as a coarse - grained model of complex fluid mixtures . in section",
    "[ sec : conclusions ] we offer some concluding remarks and point out several outstanding challenges for the future .",
    "several technical calculations and procedures are detailed in appendices .",
    "the compressible equations of fluctuating hydrodynamics were proposed some time ago @xcite and have since been studied and applied successfully to a variety of situations @xcite .",
    "the presence of rapid pressure fluctuations due to the propagation of sound waves leads to stiffness that makes it computationally expensive to solve the fully compressible equations numerically , especially for typical liquids .",
    "it is therefore important to develop fluctuating hydrodynamics equations that capture the essential physics in cases where acoustics can be neglected .",
    "it is important to note that the equations of fluctuating hydrodynamics are to be interpreted as a mesoscopic coarse - grained representation of the mass , momentum and energy transport which occurs at microscopic scales through molecular interactions ( collisions ) . as such",
    ", these equations implicitly contain a mesoscopic coarse - graining length and time scale that is larger than molecular scales @xcite .",
    "while a coarse - graining scale does not appear explicitly in the formal stochastic partial differential equations ( spdes ) written in this section ( but note that it can be if desired @xcite ) , it does explicitly enter in the spatio - temporal discretization described in section [ sec : spatialdiscretization ] through the grid spacing ( equivalently , the volume of the grid , or more precisely , the number of molecules per grid cell ) and time step size .",
    "this changes the appropriate interpretation of convergence of numerical methods to a continuum limit in the presence of fluctuations and nonlinearities @xcite . only for the linearized equations of fluctuating hydrodynamics @xcite",
    "can the formal spdes be given a precise continuum meaning @xcite .",
    "developing coarse - grained models that only resolve the relevant spatio - temporal scales is a well - studied but still _ ad hoc _ procedure that requires substantial _ a priori _ physical insight @xcite .",
    "more precise mathematical mode - elimination procedures @xcite are technically involved and often purely formal , especially in the context of spdes @xcite . here",
    "we follow a heuristic approach to constructing fluctuating low mach number equations , starting from the well - known deterministic low mach equations ( which can be obtained via asymptotic analysis @xcite ) and then adding fluctuations in a manner consistent with fluctuation - dissipation balance . alternatively ,",
    "our low mach number equations can be seen as a formal asymptotic limit in which the noise terms are formally treated as smooth forcing terms ; a more rigorous derivation is nontrivial and is deferred for future work .",
    "the starting point of our investigations is the system of isothermal compressible equations of fluctuating hydrodynamics for the density @xmath0 , velocity @xmath1 , and mass concentration @xmath2 for a mixture of two fluids in @xmath3 dimensions . in terms of mass and momentum densities",
    "the equations can be written as conservation laws @xcite , @xmath4+\\rho\\v g\\nonumber \\\\",
    "v\\right)= & \\grad\\cdot\\left[\\rho\\chi\\left(\\grad c+k_{p}\\grad p\\right)+\\m{\\psi}\\right],\\label{llns_primitive}\\end{aligned}\\ ] ] where @xmath5 is the density of the first component , @xmath6 is the density of the second component , @xmath7 is the equation of state for the pressure at the reference temperature @xmath8 , and @xmath9 is the gravitational acceleration .",
    "temperature fluctuations are neglected in this study but can be accounted for using a similar approach .",
    "the shear viscosity @xmath10 , bulk viscosity @xmath11 , mass diffusion coefficient @xmath12 , and baro - diffusion coefficient @xmath13 , in general , depend on the state .",
    "the baro - diffusion coefficient @xmath13 above [ denoted with @xmath14 in ref .",
    "@xcite , see eq .",
    "( a.17 ) in that paper ] is not a transport coefficient but rather determined from thermodynamics @xcite , @xmath15 where @xmath16 is the chemical potential of the mixture at the reference temperature , @xmath17 , and @xmath18 is the isothermal speed of sound .",
    "the capital greek letters denote stochastic momentum and mass fluxes that are formally modeled as @xcite @xmath19 where @xmath20 is boltzmann s constant , and @xmath21 and @xmath22 are standard zero mean , unit variance random gaussian tensor and vector fields with uncorrelated components , @xmath23 and similarly for @xmath24 .      at mesoscopic scales , in typical liquids ,",
    "sound waves are much faster than momentum diffusion and can usually be eliminated from the fluid dynamics description .",
    "formally , this corresponds to taking the zero mach number singular limit @xmath25 of the system ( [ llns_primitive ] ) by performing an asymptotic analysis as the mach number @xmath26 , where @xmath27 is a reference flow velocity .",
    "the limiting dynamics can be obtained by performing an asymptotic expansion in the mach number @xcite . in a deterministic setting",
    "this analysis shows that the pressure can be written in the form @xmath28 where @xmath29 .",
    "the low mach number equations can then be obtained by making the anzatz that the thermodynamic behavior of the system is captured by the reference pressure , @xmath30 , and @xmath31 captures the mechanical behavior while not affecting the thermodynamics .",
    "we note that when the system is sufficiently large or the gravitational forcing is sufficiently strong , assuming a spatial constant reference pressure is not valid . in those cases ,",
    "the reference pressure represents a global hydrostatic balance , @xmath32 ( see @xcite for details of the construction of these types of models ) . here , however , we will restrict consideration to cases where gravity causes negligible changes in the thermodynamic state across the domain .    in this case",
    ", the reference pressure constrains the system so that the evolution of @xmath33 and @xmath34 remains consistent with the thermodynamic equation of state @xmath35 this constraint means that any change in concentration ( equivalently , @xmath36 ) must be accompanied by a corresponding change in density , as would be observed in a system at thermodynamic equilibrium held at the fixed reference pressure and temperature .",
    "this implies that variations in density are coupled to variations in composition .",
    "note that we do not account for temperature variations in our isothermal model .",
    "the equation for @xmath36 can be written in primitive ( non - conservation ) form as the concentration equation @xmath37 where the non - advective ( diffusive and stochastic ) fluxes are denoted with @xmath38 note that there is no barodiffusion flux because barodiffusion is of thermodynamic origin ( as seen from ( [ eq : k_p ] ) @xcite ) and involves the gradient of the _ thermodynamic _ pressure @xmath39 . by differentiating the eos constraint along a lagrangian trajectory",
    "we obtain @xmath40 where the solutal expansion coefficient @xmath41 is determined by the specific form of the eos .",
    "equation ( [ eq : drho_dt ] ) shows that the eos constraint can be re - written as a constraint on the divergence of velocity , @xmath42 note that the usual incompressibility constraint is obtained when the density is not affected by changes in concentration , @xmath43 .",
    "when @xmath44 changes in composition ( concentration ) due to diffusion cause local expansion and contraction of the fluid and thus a nonzero @xmath45 .",
    "it is important at this point to consider the boundary conditions . for a closed system , such as a periodic domain or a system with rigid boundaries",
    ", we must ensure that the integral of @xmath45 over the domain is zero .",
    "this is consistent with ( [ eq : div_v ] ) if @xmath46 is constant , so that we can rewrite ( [ eq : div_v ] ) in the form @xmath47 . in this case",
    "@xmath30 does not vary in time .",
    "if @xmath46 is not constant , then for a closed system the reference pressure @xmath30 must vary in time to enforce that the total fluid volume remains constant . here",
    "we will assume that @xmath48 , and we will give a specific example of an eos that obeys this condition .    the asymptotic low mach analysis of ( [ llns_primitive ] ) is standard and follows the procedure outlined in ref .",
    "@xcite , formally treating the stochastic forcing as smooth .",
    "this analysis leads to the _ isothermal low mach number _ equations for a binary mixture of fluids in conservation form , @xmath49+\\rho\\v g\\equiv\\v f(\\rho,\\v v , c , t)\\label{eq : momentum_eq}\\\\ \\partial_{t}\\left(\\rho_{1}\\right)=-\\grad\\cdot\\left(\\rho_{1}\\v v\\right)+ & \\grad\\cdot\\v f\\equiv h(\\rho,\\v v , c , t)\\label{eq : rho1_eq}\\\\ \\partial_{t}\\left(\\rho_{2}\\right)=-\\grad\\cdot\\left(\\rho_{2}\\v v\\right ) & -\\grad\\cdot\\v f\\label{eq : rho2_eq}\\\\ \\mbox{such that } \\grad\\cdot\\v v= & -\\left(\\rho^{-1}\\beta\\right)\\,\\grad\\cdot\\v f\\equiv s(\\rho , c , t).\\label{eq : div_v_constraint}\\end{aligned}\\ ] ] the gradient of the non - thermodynamic component of the pressure @xmath31 ( lagrange multiplier ) appears in the momentum equation as a driving force that ensures the eos constraint ( [ eq : div_v_constraint ] ) is obeyed .",
    "we note that the bulk viscosity term gives a gradient term that can be absorbed in @xmath31 and therefore does not explicitly need to appear in the equations . by adding the two density equations ( [ eq : rho1_eq],[eq : rho2_eq ] ) we get the usual continuity equation for the total density , @xmath50 our conservative numerical scheme is based on eqs .",
    "( [ eq : momentum_eq],[eq : rho1_eq],[eq : div_v_constraint],[eq : rho_eq ] ) .    in appendix",
    "[ sec : linearizedanalysis ] , we apply the standard linearized fluctuating hydrodynamics analysis to the low mach number equations .",
    "this gives expressions for the equilibrium and nonequilibrium static and dynamic covariances ( spectra ) of the fluctuations in density and concentration as a function of wavenumber and wavefrequency .",
    "specifically , the dynamic structure factor in the low mach number approximation has the form @xmath51 the linearized analysis shows that the low mach number equations reproduce the slow fluctuations ( small @xmath52 ) in density and concentration ( central rayleigh peak in the dynamic structure factor @xcite ) as in the full compressible equations ( see section [ sub : compressiblespectra ] ) , while eliminating the fast isentropic pressure fluctuations ( side brillouin peaks ) from the dynamics .    the fluctuations in velocity , however , are different between the compressible and low mach number equations . in the compressible equations ,",
    "the dynamic structure factor for the longitudinal component of velocity decays to zero as @xmath53 because it has two sound ( brillouin ) peaks centered around @xmath54 , in addition to the central diffusive ( rayleigh ) peak .",
    "the low mach number equations reproduce the central peak ( slow fluctuations ) correctly , replacing the side peaks with a flat spectrum for large @xmath52 , which is unphysical as it formally makes the velocity white in time .",
    "the low mach equations should therefore be used only for time scales larger than the sound propagation time .",
    "the fact that the velocity fluctuations are white in space and in time poses a further challenge in interpreting the nonlinear low mach number equations , and in particular , numerical schemes may not converge to a sensible limit as the time step goes to zero . in practice , just as the spatial discretization of the equations imposes a spatial smoothing or regularization of the fluctuations , the temporal discretization of the equations imposes a temporal smoothing and filters the problematic large frequencies . in the types of problems we study in this work the problem concentration fluctuations can be neglected , @xmath55 , because the concentration fluctuations are dominated by nonequilibrium effects . if @xmath56 the problematic white - in - time longitudinal component of velocity disappears .      in general , the eos constraint ( [ eq : general_eos ] )",
    "is a non - linear constraint . in this work",
    "we consider a specific linear eos , @xmath57 where @xmath58 and @xmath59 are the densities of the pure component fluids ( @xmath60 and @xmath61 , respectively ) , giving @xmath62 it is important that for this specific form of the eos @xmath46 is a material constant independent of the concentration .",
    "the density dependence ( [ eq : beta_simple ] ) on concentration arises if one assumes that the two fluids do not change volume upon mixing .",
    "this is a reasonable assumption for liquids that are not too dissimilar at the molecular level .",
    "surprisingly the eos ( [ eq : eos_quasi_incomp ] ) is also valid for a mixture of ideal gases , since @xmath63 where @xmath64 is molecular mass and @xmath65 is the number density .",
    "this is exactly of the form ( [ eq : eos_quasi_incomp ] ) with @xmath66 and @xmath67 .",
    "even if the specific eos ( [ eq : eos_quasi_incomp ] ) is not a very good approximation over the entire range of concentration @xmath68 , ( [ eq : eos_quasi_incomp ] ) may be a very good approximation over the range of concentrations of interest if @xmath58 and @xmath59 are adjusted accordingly . in this case @xmath58 and @xmath59 are not the densities of the pure component fluids but rather fitting parameters that approximate the true eos in the range of concentrations of interest . for small variations in concentration around some reference concentration @xmath69 and density",
    "@xmath70 one can approximate @xmath71 by a constant and determine appropriate values of @xmath58 and @xmath59 from ( [ eq : beta_simple ] ) and the eos ( [ eq : eos_quasi_incomp ] ) evaluated at the reference state .",
    "our specific form choice of the eos will aid significantly in the construction of simple conservative spatial discretizations that strictly maintain the eos without requiring complicated nonlinear iterative corrections .",
    "several different types of boundary conditions can be imposed for the low mach number equations , just as for the more familiar incompressible equations .",
    "the simplest case is when periodic boundary conditions are used for all of the variables .",
    "we briefly describe the different types of conditions that can be imposed at a physical boundary with normal direction @xmath72 .    for the concentration ( equivalently , @xmath36 ) , either neumann ( zero mass flux ) or dirichlet ( fixed concentration ) boundary conditions can be imposed .",
    "physically , a neumann condition corresponds to a physical boundary that is impermeable to mass , while dirichlet conditions correspond to a permeable membrane that connects the system to a large reservoir held at a specified concentration . in the case of neumann conditions for concentration , both the normal component of the diffusive flux @xmath73 and the advective flux @xmath74 vanish at the boundary , implying that the normal component of velocity must vanish , @xmath75 . for dirichlet conditions on the concentration , however , there will , in general , be a nonzero normal diffusive flux @xmath76 through the boundary .",
    "this diffusive flux for concentration will induce a corresponding mass flux , as required to maintain the equation of state near the boundary . from the condition ( [ eq : div_v_constraint ] ) , we infer the proper boundary condition for the normal component of velocity to be @xmath77 this condition expresses the notion that there is no net volume change for the fluid in the domain . note that no additional boundary conditions can be specified for @xmath33 since its boundary conditions follow from those on @xmath34 via the eos constraint .    for the tangential component of velocity @xmath78",
    ", we either impose a no - slip condition @xmath79 , or a free slip boundary condition in which the tangential component of the normal viscous stress vanishes , @xmath80 in the case of zero normal mass flux , @xmath75 , the free slip condition simplifies to a neumann condition for the tangential velocity , @xmath81 .",
    "the low mach number system of equations ( [ eq : momentum_eq],[eq : rho1_eq],[eq : div_v_constraint],[eq : rho_eq ] ) is a _ constrained _ problem . for the purposes of analysis and in particular for constructing higher - order temporal integrators , it is useful to rewrite the constrained low mach number equations as an _ unconstrained _ initial value problem . in the incompressible case , @xmath82 , we can write the constrained navier - stokes equations as an unconstrained system by eliminating the pressure using a projection operator formalism . the constraint @xmath82 is a constant linear constraint and independent of the state and of time .",
    "however , in the low mach number equations the velocity - divergence constraint @xmath83 depends on concentration , and also on time when there are additional ( stochastic or deterministic ) forcing terms in the concentration equation . treating this type of system requires a more general vector field decomposition .",
    "this more general vector field decomposition provides the basis for a projection - based discretization of the constrained system .",
    "we also introduce a gauge formulation of the system @xcite that casts the evolution as a nonlocal unconstrained system that is analytically equivalent to the orignal constrained evolution .",
    "the gauge formulation allows us to develop higher - order method - of - lines temporal integration algorithms .",
    "the velocity in the low mach number equations can be split into two components , @xmath84 where @xmath85 is a divergence - free ( solenoidal or vortical ) component , and therefore @xmath86 this is a poisson problem for @xmath87 that is well - posed for appropriate boundary conditions on @xmath88 .",
    "specifically , periodic boundary conditions on @xmath88 imply periodic boundary conditions for @xmath89 and @xmath87 . at physical boundaries where a dirichlet condition ( [ eq : v_n_bc ] ) is specified for the normal component of the velocity , we set @xmath90 and use neumann conditions for the poisson solve , @xmath91",
    ".    we can now define a more general vector field decomposition that plays the role of the hodge decomposition in incompressible flow . given a vector field @xmath92 and a density @xmath33 we can decompose @xmath92 into three components",
    "@xmath93 this decomposition can be obtained by using the condition @xmath85 and @xmath94 , which allows us to define a density - weighted poisson equation for @xmath95 , @xmath96 let @xmath97 denote the solution operator to the density - dependent poisson problem , formally , @xmath98^{-1},\\ ] ] and also define a density - dependent projection operator @xmath99 defined through its action on a vector field @xmath100 , @xmath101.\\ ] ] this is a well - known variable density generalization @xcite of the constant - density projection operator @xmath102 $ ] .",
    "we can now write @xmath103-\\grad\\zeta.\\ ] ] this gives @xmath104 where we have introduced an affine transformation @xmath105 that depends on @xmath33 , @xmath34 and @xmath106 through @xmath107 , and is defined via its action on a vector field @xmath100 , @xmath108.\\label{p_tilde_v}\\ ] ] note that application of @xmath109 requires only one poisson solve and does not actually require computing @xmath87 .",
    "the low mach number system ( [ eq : momentum_eq],[eq : rho1_eq],[eq : rho_eq],[eq : div_v_constraint ] ) has the form @xmath110 where @xmath111 is the momentum density , and @xmath112 , @xmath113 and @xmath114 are as defined in ( [ eq : momentum_eq],[eq : rho1_eq],[eq : div_v_constraint ] ) . at present",
    ", we will assume that these functions are smooth functions of time , which is only justified in the presence of stochastic forcing terms in a linearized setting .",
    "we note that , for the constrained system , @xmath33 is not an independent variable because of the eos constraint ( [ eq : eos_quasi_incomp ] ) ; however , we will retain the evolution of @xmath33 with the implicit understanding that the evolution must be constrained so that @xmath33 and @xmath34 remain consistent with ( [ eq : eos_quasi_incomp ] ) .    to define the gauge formulation , we introduce a new variable @xmath115 where @xmath95 is a _ gauge _ variable .",
    "we note that @xmath95 is not uniquely determined ; however , the specific choice does not matter . if we choose the gauge so that @xmath116 then the momentum equation in ( [ eq : div_v_s ] ) is equivalent to @xmath117 the appropriate boundary conditions for @xmath95 are linked to the boundary conditions on @xmath88 ; we set @xmath95 to be periodic if @xmath88 is periodic , and employ a homogeneous neumann ( natural ) boundary condition @xmath118 if a dirichlet condition ( [ eq : v_n_bc ] ) is specified for the normal component of the velocity @xmath119 .",
    "note that in the spatially - discrete staggered formulation that we employ , the homogeneous neumann condition follows automatically from the boundary conditions on velocity used to define the appropriate divergence and gradient operators in the interior of the domain .",
    "if we know @xmath120 and @xmath33 , we can then define @xmath121 and compute @xmath122 , where @xmath109 is defined in ( [ p_tilde_v ] ) .",
    "thus by using the gauge formulation we can formally write the low mach number equations in the form of an unconstrained initial value problem @xmath123 the utility of the gauge formulation is that in fact , we do not need to know @xmath95 in order to determine @xmath88 .",
    "therefore , the time evolution equation for @xmath95 does not actually need to be solved , and in particular , @xmath31 does not need to be computed .",
    "futhermore , by adopting the gauge formulation , we can directly use a method of lines approach for spatially - discretizing the system ( [ eq : m_gauge],[eq : rho1_gauge ] ) , and then apply standard runge - kutta temporal integrators to the resulting system of ordinary ( stochastic ) differential equations .",
    "it is important to emphasize that the actual independent physical variables in the low mach formulation ( [ eq : m_gauge],[eq : rho1_gauge ] ) are the vortical ( solenoidal ) component of velocity @xmath89 and the concentration @xmath34 .",
    "the density @xmath124 and the velocity @xmath125 $ ] are determined from @xmath89 and @xmath34 and the constraints ; hence they can formally be eliminated from the system , as can be seen in the linearized analysis in appendix [ sec : linearizedanalysis ] , which shows that fluctuations in the vortical velocity modes are decoupled from the longitudinal fluctuations .",
    "our spatio - temporal discretization follows a `` method of lines '' approach in which we first discretize the equations ( [ eq : momentum_eq],[eq : rho1_eq],[eq : div_v_constraint],[eq : rho_eq ] ) in space and then integrate the resulting semi - continuum equations in time .",
    "our uniform staggered - grid spatial discretization of the low mach number equations is relatively standard and is described in section [ sec : spatialdiscretization ] .",
    "the main difficulty is the temporal integration of the resulting equations in the presence of the eos constraint .",
    "our temporal integrators are based on the gauge formulation ( [ eq : m_gauge],[eq : rho1_gauge ] ) of the low mach equations .",
    "the gauge formulation is unconstrained and enables us to use standard temporal integrators for initial - value problems . in the majority of this section ,",
    "we assume that all of the fields and differential operators have already been spatially discretized and focus on the temporal integration of the resulting initial - value problem .",
    "because in the present schemes we handle both diffusive and advective fluxes explicitly , the time step size @xmath126 is restricted by well - known cfl conditions . for fluctuating hydrodynamics applications the time step is typically limited by momentum diffusion , @xmath127 where @xmath3 is the number of spatial dimensions and @xmath128 is the grid spacing .",
    "the design and implementation of numerical methods that handle momentum diffusion semi - implicitly , as done in ref .",
    "@xcite for incompressible flow , is substantially more difficult for the low mach number equations because it requires a variable coefficient implicit fluid solver .",
    "we have recently developed an efficient stokes solver for solving variable - density and variable - viscosity time - dependent and steady stokes problems @xcite , and in future work we will employ this solver to construct a semi - implicit temporal integrator for the low mach number equations .    our temporal discretization will make use of the special form of the eos and the discretization of mass advection described in section [ sub : advection ] in order to strictly maintain the eos relation ( [ eq : eos_quasi_incomp ] ) between density and concentration in each cell at _ all _ intermediate values .",
    "therefore , no additional action is needed to enforce the eos constraint after an update of @xmath36 and @xmath33 .",
    "this is , however , only true to within the accuracy of the poisson solver and also roundoff , and it is possible for a slow drifting off the eos to occur over many time steps . in section [ sub : driftcorrection ] , we describe a correction that prevents such drifting and ensures that the eos is obeyed at all times to essentially roundoff tolerance . for simplicity , we will often omit the explicit update for the density @xmath33 and instead focus on updating @xmath36 and the momentum density @xmath111 , with the understanding that @xmath33 is updated whenever @xmath36 is .",
    "the foundation for our higher - order explicit temporal integrators is the first - order euler method applied to the gauge formulation ( [ eq : m_gauge],[eq : rho1_gauge ] ) .",
    "we use a superscript to denote the time step and the point in time where a given term is evaluated , e.g. , @xmath129 where @xmath130 denotes the spatial discretization of @xmath131 with analogous definitions for @xmath132 and @xmath133 .",
    "we also denote the time step size with @xmath134 .",
    "assume that at the beginning of timestep @xmath72 we know @xmath135 and we can then compute @xmath136 by enforcing the constraint ( [ eq : div_v_s ] ) .",
    "here @xmath137 denotes the affine transformation ( [ p_tilde_v ] ) with all terms evaluated at the beginning of the time step , so that @xmath138 . an euler step for the low mach equations",
    "then consists of the update @xmath139 together with an update of the density @xmath140 consistent with @xmath141 .    at the beginning of the next time step ,",
    "@xmath142 will be calculated from @xmath143 by applying @xmath144 , and it is only @xmath142 that will actually be used during time step @xmath145 .",
    "we therefore do not need to explicitly store @xmath143 and can instead replace it with @xmath146 without changing any of the observable results .",
    "this is related to the fact that the gauge is _ de facto _ arbitrary and , in the present setting , the gauge formulation is simply a formalism to put the equations in an unconstrained form suitable for method of lines discretization .",
    "the difference between @xmath120 and @xmath147 is a ( discrete ) gradient of a scalar .",
    "since our temporal integrators only use linear combinations of the intermediate values , the difference between the final result for @xmath143 and @xmath148 is also a gradient of a scalar and replacing @xmath143 with @xmath149 simply amounts to redefining the ( arbitrary ) gauge variable . for these reasons",
    ", the euler advance , @xmath150,\\label{eq : euler_step_complex}\\end{aligned}\\ ] ] is analytically equivalent to ( [ eq : euler_lagged ] ) .",
    "we will use this form as the foundation for our temporal integrators .",
    "the equivalence to the gauge form implies that the update specified by ( [ eq : euler_step_complex ] ) can be viewed as an explicit update in spite of the formal dependence of the update on the solution at both old and new time levels .",
    "thermal fluctuations can not be straightforwardly incorporated in ( [ eq : euler_step_complex ] ) because it is not clear how to define @xmath144 . in the deterministic setting ,",
    "@xmath114 is a function of concentration and density and can be evaluated pointwise at time level @xmath145 .",
    "when the white - in - time stochastic concentration flux @xmath151 is included , however , @xmath114 can not be evaluated at a particular point of time .",
    "instead , one must think of @xmath151 as representing the _ average _ stochastic flux over a given time interval @xmath152 , which can be expressed in terms of the increments @xmath153 of the underlying wiener processes , @xmath154 where @xmath155 is a collection of normal variates generated using a pseudo - random number generator , and @xmath156 is the volume of the hydrodynamic cells .",
    "similarly , the average stochastic momentum flux over a time step is modeled as @xmath157 where @xmath158 are normal random variates . as described in more detail in ref .",
    "@xcite , stochastic fluxes are spatially discretized by generating normal variates on the faces of the grid on which the corresponding variable is discretized , independently at each time step . as mentioned earlier , the volume of the grid cell appears here because it expresses the spatial coarse graining length scale ( i.e. , the degree of coarse - graining for which a fluid element with discrete molecules can be modeled by continuous density fields ) implicit in the equations of fluctuating hydrodynamics .",
    "similarly , the time interval @xmath159 expresses the typical time scale at which the mass and momentum transfer can be modeled with low mach number hydrodynamics .    with this in mind",
    ", we first evaluate the velocity divergence associated with the constraint using the particular sample of @xmath151 , @xmath160.\\ ] ] we then define a discrete affine operator @xmath161 in terms of its action on the momentum @xmath162",
    "@xmath163\\left(\\v m\\right)=\\rho\\m{\\mathcal{r}}_{s}\\left(\\rho^{-1}\\v m\\right).\\ ] ] using this shorthand notation , the momentum update in ( [ eq : euler_step_complex ] ) in the presence of thermal fluctuations can be written as @xmath164\\left(\\v m^{n}+\\d t\\,\\v f^{n}\\right).\\ ] ] observe that this is a conservative momentum update since the application of @xmath165 subtracts the ( discrete ) gradient of a scalar from the momentum . in actual implementation , it is preferable to apply @xmath166 at the beginning of the time step @xmath145 instead of at the end of time step @xmath72 , once the value @xmath167 is computed from the diffusive and stochastic fluxes for the concentration .      following the above discussion , we can write an euler - maruyama temporal integrator for the low mach number equations in the shorthand notation , @xmath168\\left(\\tilde{\\v m}^{n}\\right)\\nonumber \\\\ \\rho_{1}^{n+1 } & = & \\rho_{1}^{n}+\\d t\\,\\bar{h}^{n}+\\check{h}^{n}\\left(\\d t,\\,\\widetilde{\\v w}^{n}\\right)\\nonumber \\\\ \\tilde{\\v m}^{n+1 } & = & \\v m^{n}+\\d t\\,\\bar{\\v f}^{n}+\\check{\\v f}^{n}\\left(\\d t,\\,\\m w^{n}\\right),\\label{eq : euler_step}\\end{aligned}\\ ] ] where @xmath169 and @xmath170 are collections of standard normal variates generated using a pseudo - random number generator independently at each time step . here",
    "the deterministic increments are written using the shorthand notation , @xmath171+\\rho\\v g\\\\ \\bar{h } & = & \\grad\\cdot\\left(-\\rho_{1}\\v v+\\rho\\chi\\grad c\\right).\\end{aligned}\\ ] ] the stochastic increments are written in terms of @xmath172\\delta t=\\grad\\cdot\\left[\\sqrt{\\frac{\\eta\\left(k_{b}t\\right)\\d t}{\\d v}}\\,\\left(\\m w+\\m w^{t}\\right)\\right]\\\\ \\check{h}\\left(\\d t,\\,\\widetilde{\\v w}\\right ) & = & \\left[\\grad\\cdot\\m{\\psi}\\left(\\d t,\\,\\widetilde{\\v w}\\right)\\right]\\delta t=\\grad\\cdot\\left[\\sqrt{\\frac{2\\chi\\rho\\mu_{c}^{-1}\\left(k_{b}t\\right)\\d t}{\\d v}}\\,\\widetilde{\\v w}\\right],\\end{aligned}\\ ] ] where @xmath155 and @xmath158 are vectors of standard gaussian variables @xcite .",
    "a good strategy for composing higher - order temporal integrators for the low mach number equations is to use a linear combination of several projected euler steps of the form ( [ eq : euler_step ] ) . in this way",
    ", the higher - order integrators inherit the properties of the euler step . in our case",
    ", this will be very useful in constructing conservative discretizations that strictly maintain the eos constraint and only evaluate fluxes at states that strictly obey the eos constraint .",
    "the incorporation of stochastic forcing in the runge - kutta temporal integrators that we use is described in refs .",
    "@xcite ; here we only summarize the resulting schemes .",
    "we note that the stochastic terms should be considered additive noise , even though we evaluate them using an instantaneous state like multiplicative noise @xcite .",
    "a weakly second - order temporal integrator for ( [ eq : m_gauge],[eq : rho1_gauge ] ) is provided by the _ explicit trapezoidal rule _",
    ", in which we first take a predictor euler step @xmath168\\left(\\tilde{\\v m}^{n}\\right)\\nonumber \\\\",
    "\\rho_{1}^{\\star , n+1 } & = & \\rho_{1}^{n}+\\d t\\,\\bar{h}^{n}+\\check{h}^{n}\\left(\\d t,\\,\\widetilde{\\v w}^{n}\\right)\\\\ \\tilde{\\v m}^{\\star , n+1 } & = & \\v m^{n}+\\d t\\,\\bar{\\v f}^{n}+\\check{\\v f}^{n}\\left(\\d t,\\,\\m w^{n}\\right).\\label{eq : trapezoidal_predictor}\\end{aligned}\\ ] ] the corrector step is a linear combination of the predictor and another euler update , @xmath173\\left(\\tilde{\\v m}^{\\star , n+1}\\right)\\nonumber \\\\ \\rho_{1}^{n+1 } & = & \\frac{1}{2}\\rho_{1}^{n}+\\frac{1}{2}\\left[\\rho_{1}^{\\star , n+1}+\\d t\\,\\bar{h}^{\\star , n+1}+\\check{h}^{\\star , n+1}\\left(\\d t,\\,\\widetilde{\\v w}^{n}\\right)\\right]\\\\ \\tilde{\\v m}^{n+1 } & = & \\frac{1}{2}\\v m^{n}+\\frac{1}{2}\\left[\\m m^{\\star ,",
    "n+1}+\\d t\\,\\bar{\\v f}^{\\star , n+1}+\\check{\\v f}^{\\star , n+1}\\left(\\d t,\\,\\m w^{n}\\right)\\right],\\label{eq : trapezoidal_corrector}\\end{aligned}\\ ] ] and reuses the same random numbers @xmath169 and @xmath170 as the predictor step .    note that both the predicted and the corrected values for density and concentration obey the eos .",
    "we numerically observe that the trapezoidal rule does exhibit a slow but systematic numerical drift in the eos , and therefore it is necessary to use the correction procedure described in section [ sub : driftcorrection ] at the end of each time step .",
    "the analysis in ref .",
    "@xcite indicates that for the incompressible case the trapezoidal scheme exhibits second - order weak accuracy in the nonlinear and linearized settings .",
    "an alternative second - order scheme is the _ explicit midpoint rule _ , which can be summarized as follows .",
    "first we take a projected euler step to estimate midpoint values ( denoted here with superscript * @xmath174 * ) , @xmath175\\left(\\tilde{\\v m}^{n}\\right)\\nonumber \\\\ \\rho_{1}^{\\star , n+\\myhalf } & = & \\rho_{1}^{n}+\\frac{\\d t}{2}\\,\\bar{h}^{n}+\\check{h}^{n}\\left(\\frac{\\d t}{2},\\,\\widetilde{\\v w}_{1}^{n}\\right)\\nonumber \\\\",
    "\\tilde{\\m m}^{\\star , n+\\myhalf } & = & \\v m^{n}+\\frac{\\d t}{2}\\,\\bar{\\v f}^{n}+\\check{\\v f}^{n}\\left(\\frac{\\d t}{2},\\,\\m w_{1}^{n}\\right).\\label{eq : midpoint_predictor}\\end{aligned}\\ ] ] and then we complete the time step with another euler - like update @xmath176\\left(\\tilde{\\v m}^{\\star , n+\\myhalf}\\right)\\nonumber \\\\ \\rho_{1}^{n+1 } & = & \\rho_{1}^{n}+\\d t\\,\\bar{h}^{\\star , n+\\myhalf}+\\check{h}^{\\star , n+\\myhalf}\\left(\\d t,\\,\\widetilde{\\v w}^{n}\\right)\\nonumber \\\\",
    "\\tilde{\\v m}^{n+1 } & = & \\v m^{n}+\\d t\\,\\bar{\\v f}^{\\star , n+\\myhalf}+\\check{\\v f}^{\\star , n+\\myhalf}\\left(\\d t,\\,\\m w^{n}\\right),\\label{eq : midpoint_corrector}\\end{aligned}\\ ] ] where the standard gaussian variates @xmath177 and the vectors of standard normal variates @xmath178 and @xmath179 are independent , and similarly for @xmath180 and @xmath181 .",
    "note that @xmath178 and @xmath180 are used in _ both _ the predictor and the corrector stages , while @xmath179 and @xmath181 are used in the corrector only .",
    "physically , the random numbers @xmath182 ( and similarly for @xmath178 ) correspond to the increments of the underlying wiener processes @xmath183 over the first half of the time step , and the random numbers @xmath184 correspond to the wiener increments for the second half of the timestep @xcite .",
    "note that both the midpoint and the endpoint values for density and concentration obey the eos .",
    "we numerically observe that the midpoint rule does not exhibit a systematic numerical drift in the eos , and can therefore be used without the correction procedure described in section [ sub : driftcorrection ] . the analysis in ref .",
    "@xcite indicates that for the incompressible case the midpoint scheme exhibits second - order weak accuracy in the nonlinear setting .",
    "furthermore , in the linearized setting it reproduces the steady - state covariances of the fluctuating fields to third order in the time step size .",
    "we have also tested and implemented the three - stage runge kutta scheme that was used in refs .",
    "this scheme can be expressed as a linear combination of three euler steps .",
    "the first stage is a predictor euler step , @xmath168\\left(\\tilde{\\v m}^{n}\\right)\\nonumber \\\\",
    "\\rho_{1}^{\\star } & = & \\rho_{1}^{n}+\\d t\\,\\bar{h}^{n}+\\check{h}^{n}\\left(\\d t,\\,\\widetilde{\\v w}^{n}\\right)\\\\ \\tilde{\\v m}^{\\star } & = & \\v m^{n}+\\d t\\,\\bar{\\v f}^{n}+\\check{\\v f}^{n}\\left(\\d t,\\,\\m w^{n}\\right).\\label{eq : trapezoidal_predictor-1}\\end{aligned}\\ ] ] the second stage is a midpoint predictor @xmath185\\left(\\tilde{\\v m}^{\\star}\\right)\\nonumber \\\\",
    "\\rho_{1}^{\\star\\star } & = & \\frac{3}{4}\\rho_{1}^{n}+\\frac{1}{4}\\left[\\rho_{1}^{\\star}+\\d t\\,\\bar{h}^{\\star}+\\check{h}^{\\star}\\left(\\d t,\\,\\widetilde{\\v w}^{\\star , n}\\right)\\right]\\\\ \\tilde{\\v m}^{\\star\\star } & = & \\frac{3}{4}\\v m^{n}+\\frac{1}{4}\\left[\\m m^{\\star}+\\d t\\,\\bar{\\v f}^{\\star}+\\check{\\v f}^{\\star}\\left(\\d t,\\,\\m w^{\\star , n}\\right)\\right],\\label{eq : rk3_predictor}\\end{aligned}\\ ] ] and a final corrector stage completes the time step @xmath186\\left(\\tilde{\\v m}^{\\star\\star}\\right)\\nonumber \\\\ \\rho_{1}^{n+1 } & = & \\frac{1}{3}\\rho_{1}^{n}+\\frac{2}{3}\\left[\\rho_{1}^{\\star\\star}+\\d t\\,\\bar{h}^{\\star\\star}+\\check{h}^{\\star\\star}\\left(\\d t,\\,\\widetilde{\\v w}^{\\star\\star , n}\\right)\\right]\\\\ \\tilde{\\m m}^{n+1 } & = & \\frac{1}{3}\\v m^{n}+\\frac{2}{3}\\left[\\m m^{\\star\\star}+\\d t\\,\\bar{\\v f}^{\\star\\star}+\\check{\\v f}^{\\star\\star}\\left(\\d t,\\,\\m w^{\\star\\star , n}\\right)\\right].\\label{eq : rk3_corrector}\\end{aligned}\\ ] ] here the stochastic fluxes between different stages are related to each other via @xmath187 where @xmath188 and @xmath189 are independent and generated independently at each rk3 step , and similarly for @xmath155 .",
    "the weights of @xmath189 are chosen to maximize the weak order of accuracy of the scheme while still using only two random samples of the stochastic fluxes per time step @xcite .",
    "the rk3 method is third - order accurate deterministically , and stable even in the absence of diffusion / viscosity ( i.e. , for advection - dominated flows ) .",
    "note that the predicted , the midpoint and the endpoint values for density and concentration all obey the eos .",
    "we numerically observe that the rk3 scheme does exhibit a systematic numerical drift in the eos , and therefore it is necessary to use the correction procedure described in section [ sub : driftcorrection ] at the end of each time step .",
    "the analysis in ref .",
    "@xcite indicates that for the incompressible case the rk3 scheme exhibits second - order weak accuracy in the nonlinear setting . in the linearized",
    "setting it reproduces the steady - state covariances of the fluctuating fields to third order in the time step size .      while in principle our temporal integrators",
    "should strictly maintain the eos , roundoff errors and the finite tolerance employed in the iterative poisson solver lead to a small drift in the constraint that can , depending on the specific scheme , lead to an exponentially increasing violation of the eos over many time steps . in order to maintain the eos at all times to within roundoff tolerance",
    ", we periodically apply a globally - conservative @xmath190 projection of @xmath33 and @xmath36 onto the linear eos constraint .",
    "this projection step consists of correcting @xmath36 in cell @xmath191 using @xmath192+\\frac{1}{n}\\sum_{k^{\\prime}}\\left(\\rho_{1}\\right)_{k^{\\prime}},\\ ] ] where @xmath193 is the number of hydrodynamic cells in the system and @xmath194 note that the above update , while nonlocal in nature , conserves the total mass @xmath195 .",
    "a similar update applies to @xmath196 , or equivalently , @xmath197 .",
    "the spatial discretization we employ follows closely the spatial discretization of the constant - coefficient incompressible equations described in ref .",
    "therefore , we focus here on the differences , specifically , the use of conserved variables , the handling of the variable - density projection and variable - coefficient diffusion , and the imposition of the low mach number constraint . note that the handling of the stochastic momentum and mass fluxes is identical to that described in ref .",
    "@xcite .    for simplicity of notation , we focus on two dimensional problems , with straightforward generalization to three spatial dimensions .",
    "our spatial discretization follows the commonly - used mac approach @xcite , in which the scalar conserved quantities @xmath33 and @xmath36 are defined on a regular cartesian grid .",
    "the vector conserved variables @xmath111 are defined on a staggered grid , such that the @xmath198 component of momentum is defined on the faces of the scalar variable cartesian grid in the @xmath198 direction , see fig .",
    "[ fig : grid ] . for simplicity of notation",
    ", we often denote the different components of velocity as @xmath199 in two dimensions and @xmath200 in three dimensions .",
    "the terms `` cell - centered '' , `` edge - centered '' , and `` face - centered '' refer to spatial locations relative to the underlying scalar grid .",
    "our discretization is based on calculating fluxes on the faces of a finite - volume grid and is thus locally conservative .",
    "it is important to note , however , that for the mac grid different control volumes are used for the scalars and the components of the momentum , see fig .",
    "[ fig : grid ] .    staggered ( mac ) finite - volume discretization on a uniform cartesian two - dimensional grid .",
    "( _ left _ ) control volume and flux discretization for cell - centered scalar fields , such as densities @xmath33 and @xmath36 .",
    "( _ middle _ ) control volume for the @xmath201-component of face - centered vector fields , such as @xmath202 ( _ right _ ) control volume for the @xmath203-component of face - centered vector fields , such as @xmath204 .",
    ", width=576 ]    from the cell - centered @xmath33 and @xmath36 we can define other cell - centered scalar quantities , notably , the concentration @xmath205 and the transport quantities @xmath206 and @xmath207 , which typically depend on the local density @xmath208 and concentration @xmath209 ( and temperature for non - isothermal models ) , and can , in general , also depend on the spatial position of the cell @xmath210 . in order to define velocities",
    "we need to interpret the continuum relationship @xmath111 on the staggered grid .",
    "this is done by defining face - centered scalar quantities obtained as an arithmetic average of the corresponding cell - centered quantities in the two neighboring cells .",
    "specifically , we define @xmath211 except at physical boundaries , where the value is obtained from the imposed boundary conditions ( see section [ sub : boundaryconditions ] ) .",
    "arithmetic averaging is only one possible interpolation from cells to faces @xcite . in general , other forms of averaging such as a harmonic or geometric average or higher - order ,",
    "wider stencils @xcite can be used .",
    "most components of the spatial discretization can easily be generalized to other choices of interpolation . as we explain later",
    ", the use of linear averaging simplifies the construction of conservative advection .      in this section",
    "we describe the spatial discretization of the diffusive mass flux term @xmath212 in ( [ eq : rho1_eq ] ) .",
    "the discretization is based on conservative centered differencing @xcite ,    @xmath213+\\delta y^{-1}\\left[\\left(\\rho\\chi\\frac{\\partial c}{\\partial y}\\right)_{i , j+\\myhalf}-\\left(\\rho\\chi\\frac{\\partial c}{\\partial y}\\right)_{i , j-\\myhalf}\\right],\\label{eq : discrete_diffusion}\\ ] ]    where , for example , @xmath214 and @xmath215 is an interpolated face - centered diffusion coefficient , for example , as done for @xmath33 in eq .",
    "( [ eq : rho_face ] ) , @xmath216 except at physical boundaries , where the value is obtained from the imposed boundary conditions .",
    "regardless of the specific form of the interpolation operator , the same face - centered diffusion coefficient @xmath215 must be used when calculating the magnitude of the stochastic mass flux on face @xmath217 , @xmath218 this matches the covariance of the discrete stochastic mass increments @xmath219 with the discretization of the diffusive dissipation operator @xmath220 given in ( [ eq : discrete_diffusion],[eq : discrete_diff_flux ] ) .",
    "this matching ensures discrete fluctuation - dissipation balance in the linearized setting @xcite .",
    "specifically , at thermodynamic equilibrium the static covariance of the concentration is determined from the equilibrium value of @xmath221 ( thermodynamics ) independently of the particular values of the transport coefficients ( dynamics ) , as seen in ( [ eq : s_equilibrium ] ) and dictated by statistical mechanics principles .      in ref .",
    "@xcite a laplacian form of the viscous term @xmath222 is assumed , which is not applicable when viscosity is spatially varying and @xmath223 . in two dimensions ,",
    "the divergence of the viscous stress tensor in the momentum equation ( [ eq : momentum_eq ] ) , neglecting bulk viscosity effects , is @xmath224 & = & \\left[\\begin{array}{c } 2\\frac{\\partial}{\\partial x}\\left(\\eta\\frac{\\partial u}{\\partial x}\\right)+\\frac{\\partial}{\\partial y}\\left(\\eta\\frac{\\partial u}{\\partial y}+\\eta\\frac{\\partial v}{\\partial x}\\right)\\\\ 2\\frac{\\partial}{\\partial y}\\left(\\eta\\frac{\\partial v}{\\partial y}\\right)+\\frac{\\partial}{\\partial x}\\left(\\eta\\frac{\\partial v}{\\partial x}+\\eta\\frac{\\partial u}{\\partial y}\\right ) \\end{array}\\right].\\label{eq : div_viscous_stress}\\end{aligned}\\ ] ] the discretization of the viscous terms requires @xmath10 at cell - centers and edges ( note that in two dimensions the edges are the same as the nodes @xmath225 of the grid ) .",
    "the value of @xmath10 at a node is interpolated as the arithmetic average of the four neighboring cell - centers , @xmath226 except at physical boundaries , where the values are obtained from the prescribed boundary conditions .",
    "the different viscous friction terms are discretized by straightforward centered differences .",
    "explicitly , for the @xmath201-component of momentum @xmath227_{i+\\myhalf , j}=\\d x^{-1}\\left[\\left(\\eta\\frac{\\partial u}{\\partial x}\\right)_{i+1,j}-\\left(\\eta\\frac{\\partial u}{\\partial x}\\right)_{i , j}\\right]\\ ] ] with @xmath228 similarly , for the term involving a second derivative in @xmath203 , @xmath229_{i+\\myhalf , j}=\\d y^{-1}\\left[\\left(\\eta\\frac{\\partial u}{\\partial y}\\right)_{i+\\myhalf , j+\\myhalf}-\\left(\\eta\\frac{\\partial u}{\\partial y}\\right)_{i+\\myhalf , j-\\myhalf}\\right],\\ ] ] with @xmath230 a similar construction is used for the mixed - derivative term , @xmath231_{i+\\myhalf , j}=\\d y^{-1}\\left[\\left(\\eta\\frac{\\partial v}{\\partial x}\\right)_{i+\\myhalf , j+\\myhalf}-\\left(\\eta\\frac{\\partial v}{\\partial x}\\right)_{i+\\myhalf , j-\\myhalf}\\right],\\ ] ] with @xmath232    the stochastic stress tensor discretization is described in more detail in ref .",
    "@xcite and applies in the present context as well .",
    "for the low mach number equations , just as for the compressible equations , the symmetric form of the stochastic stress tensor must be used in order to ensure discrete fluctuation - dissipation balance between the viscous dissipation and stochastic forcing .",
    "additionally , when @xmath10 is not spatially uniform the same interpolated viscosity @xmath233 as used in the viscous terms must be used when calculating the amplitude in the stochastic forcing @xmath234 at the edges ( nodes ) of the grid .",
    "it is challenging to construct spatio - temporal discretizations that conserve the total mass while remaining consistent with the equation of state @xcite , as ensured in the continuum context by the constraint ( [ eq : div_v_constraint ] ) .",
    "we demonstrate here how the special linear form of the constraint ( [ eq : eos_quasi_incomp ] ) can be exploited in the discrete context . following ref .",
    "@xcite , we spatially discretize the advective terms in ( [ eq : rho1_eq ] ) using a centered ( skew - adjoint @xcite ) discretization , @xmath235_{i , j}=\\delta x^{-1}\\left[\\left(\\rho_{1}\\right)_{i+\\myhalf , j}u_{i+\\myhalf , j}-\\left(\\rho_{1}\\right)_{i-\\myhalf , j}u_{i-\\myhalf , j}\\right]+\\delta y^{-1}\\left[\\left(\\rho_{1}\\right)_{i , j+\\myhalf}v_{i , j+\\myhalf}-\\left(\\rho_{1}\\right)_{i , j-\\myhalf}v_{i , j-\\myhalf}\\right],\\label{eq : rho_adv}\\ ] ] and similarly for ( [ eq : rho_eq ] ) .",
    "we would like this discrete advection to maintain the equation of state ( [ eq : eos_quasi_incomp ] ) at the discrete level , that is , maintain the constraint relating @xmath236 and @xmath237 in every cell @xmath238 .    because the different dimensions are decoupled and the divergence is simply the sum of the one - dimensional difference operators , it is sufficient to consider ( [ eq : rho1_eq ] ) in one spatial dimension .",
    "the method of lines discretization is given by the system of odes , one differential equation per cell @xmath239 , @xmath240,\\ ] ] and similarly for @xmath241 .",
    "as a shorthand , denote the quantity that appears in ( [ eq : eos_quasi_incomp ] ) with @xmath242 if we use the linear interpolation ( [ eq : rho_face ] ) to calculate face - centered densities , then because of the linearity of the eos the face - centered densities obey the eos if the cell - centered ones do , since @xmath243 .",
    "the rate of change of @xmath244 in cell @xmath239 is @xmath245\\\\   & = & \\left(\\rho^{-1}\\beta\\right)\\left(f_{i+\\myhalf}-f_{i-\\myhalf}\\right)-\\left(u_{i+\\myhalf}-u_{i-\\myhalf}\\right)=0.\\end{aligned}\\ ] ]    this simple calculation shows that the eos constraint @xmath246 is obeyed discretely in each cell at all times if it is initially satisfied and the velocities used to advect mass obey the discrete version of the constraint ( [ eq : div_v_constraint ] ) , @xmath247,\\nonumber \\end{aligned}\\ ] ] in two dimensions .",
    "our algorithm ensures that advective terms are always evaluated using a discrete velocity field that obeys this constraint .",
    "this is accomplished by using a discrete projection operator , as we describe in the next section .",
    "the spatial discretization of the advection terms in the momentum equation ( [ eq : momentum_eq ] ) is constructed using centered differences on the corresponding shifted ( staggered ) grid , as described in ref .",
    "for example , for the @xmath201-component of momentum @xmath248 , @xmath249_{i+\\myhalf , j}=\\d x^{-1}\\left[(m_{x}u)_{i+1,j}-(m_{x}u)_{i , j}\\right]+\\d y^{-1}\\left[(m_{x}v)_{i+\\myhalf , j+\\myhalf}-(m_{x}v)_{i+\\myhalf , j-\\myhalf}\\right],\\label{eq : mom_adv}\\ ] ] where simple averaging is used to interpolate momenta to the cell centers and edges ( nodes ) of the grid , for example , @xmath250 because of the linearity of the interpolation procedure , the interpolated discrete velocity used to advect @xmath202 obeys the constraint ( [ eq : div_v_mac ] ) on the shifted grid , with a right - hand side @xmath251 interpolated using the same arithmetic average used to interpolate the velocities .",
    "in particular , in the incompressible case all variables , including momentum , are advected using a discretely divergence - free velocity , ensuring discrete fluctuation - dissipation balance @xcite .    it is well - known that the centered discretization of advection we employ here is not robust for advection - dominated flows , and higher - order limiters and upwinding schemes are generally preferred in the deterministic setting @xcite .",
    "however , these more robust advection schemes add artificial dissipation , which leads to a violation of discrete fluctuation - dissipation balance @xcite . in appendix [ appendixfiltering ]",
    "we describe an alternative filtering procedure that can be used to handle strong advection while continuing to use centered differencing .",
    "we now briefly discuss the spatial discretization of the affine operator @xmath109 defined by ( [ p_tilde_v ] ) , as used in our explicit temporal integrators .",
    "the discrete projection takes a face - centered ( staggered ) discrete velocity field @xmath252 and a velocity divergence @xmath114 and projects @xmath122 onto the constraint ( [ eq : div_v_mac ] ) in a conservative manner . specifically , the projection consists of finding a cell - centered discrete scalar field @xmath253 such that @xmath254 where the gradient is discretized using centered differences , e.g. , @xmath255 the pressure correction @xmath253 is the solution to the variable - coefficient discrete poisson equation , @xmath256\\nonumber \\\\",
    "+ \\frac{1}{\\delta y}\\left[\\left(\\frac{1}{\\rho_{i , j+\\myhalf}}\\right)\\left(\\frac{\\phi_{i , j+1}-\\phi_{i , j}}{\\delta y}\\right)-\\left(\\frac{1}{\\rho_{i , j-\\myhalf}}\\right)\\left(\\frac{\\phi_{i , j}-\\phi_{i , j-1}}{\\delta y}\\right)\\right]\\nonumber \\\\",
    "= s_{i , j}-\\left[\\left(\\frac{\\tilde{u}_{i+\\myhalf , j}-\\tilde{u}_{i-\\myhalf , j}}{\\delta x}\\right)+\\left(\\frac{\\tilde{v}_{i , j+\\myhalf}-\\tilde{v}_{i , j-\\myhalf}}{\\delta y}\\right)\\right],\\label{eq : discrete_poisson}\\end{aligned}\\ ] ] which can be solved efficiently using a standard multigrid approach @xcite .",
    "the handling of different types of boundary conditions is relatively straightforward when a staggered grid is used and the physical boundaries are aligned with the cell boundaries for the scalar grid .",
    "interpolation is not used to obtain values for faces , nodes or edges of the grid that lie on a physical boundary , since this would require `` ghost '' values at cell centers lying outside of the physical domain . instead ,",
    "whenever a value of a physical variable is required at a face , node , or edge lying on a physical boundary , the boundary condition is used to obtain that value .",
    "similarly , centered differences for the diffusive and viscous fluxes that require values outside of the physical domain are replaced by one - sided differences that only use values from the interior cell bordering the boundary and boundary values .",
    "for example , if the concentration is specified at the face @xmath257 , the diffusive flux discretization ( [ eq : discrete_diff_flux ] ) is replaced with @xmath258 where @xmath259 is the specified boundary value , the density @xmath260 is obtained from @xmath259 using the eos constraint , and the diffusion coefficient @xmath215 is calculated at the specified values of concentration and density .",
    "similar straightforward one - sided differencing is used for the viscous fluxes . as discussed in ref .",
    "@xcite , the use of second - order one - sided differencing is not required to achieve global second - order accuracy , and would make the handling of the stochastic fluxes more complicated because it leads to a non - symmetric discrete laplacian . note that for the nonlinear low mach number equations our approach is subtly different from linearly extrapolating the value in the ghost cell @xmath261 .",
    "namely , the extrapolated value might be unphysical , and it might not be possible to evaluate the eos or transport coefficients at the extrapolated concentration . for neumann - type or zero - flux boundary conditions ,",
    "the corresponding diffusive flux is set to zero for any faces of the corresponding control volume that lie on physical boundaries , and values in cells outside of the physical domain are never required .",
    "the corresponding handling of the stochastic fluxes is discussed in detail in ref .",
    "@xcite .",
    "the evaluation of advective fluxes for the scalars requires normal components of the velocity at the boundary . for faces of the grid that lie on a physical boundary ,",
    "the normal component of the velocity is determined from the value of the diffusive mass flux at that face using ( [ eq : v_n_bc ] ) .",
    "therefore , these velocities are not independent variables and are not solved for or modified by the projection @xmath109 . specifically , the discrete pressure @xmath253 is only defined at the cell centers in the interior of the grid , and the discrete poisson equation ( [ eq : discrete_poisson ] ) is only imposed on the interior faces of the grid .",
    "therefore , no explicit boundary conditions for @xmath253 are required when the staggered grid is used , and the natural homogeneous neumann conditions are implied .",
    "advective momentum fluxes are only evaluated on the interior faces and thus do not use any values outside of the physical domain .",
    "by combining the spatial discretization described above with one of the temporal integators described in section [ sec : temporalintegration ] , we can obtain a finite - volume solver for the fluctuating low mach equations .",
    "for the benefit of the reader , here we summarize our implementation of a single euler step ( [ eq : euler_step ] ) .",
    "this forms the core procedure that the higher - order runge - kutta schemes employ several times during one time step .    1 .",
    "generate the vectors of standard gaussian variates @xmath169 and @xmath170 .",
    "2 .   calculate diffusive and stochastic fluxes for @xmath36 using ( [ eq : discrete_diff_flux ] ) , @xmath262 3 .",
    "solve the poisson problem ( [ eq : discrete_poisson ] ) with @xmath263 to obtain the velocity @xmath264 from @xmath265 using ( [ eq : u_minus_gradp ] ) , enforcing @xmath138 .",
    "4 .   calculate viscous and stochastic momentum fluxes using ( [ eq : div_viscous_stress ] ) , @xmath266^{n}+\\grad\\cdot\\left[\\m{\\sigma}^{n}\\left(\\d t,\\,\\m w^{n}\\right)\\right].\\ ] ] 5 .",
    "calculate external forcing terms for the momentum equation , such as the contribution @xmath267 due to gravity .",
    "calculate advective fluxes for mass and momentum using ( [ eq : rho_adv ] ) and ( [ eq : mom_adv ] ) .",
    "update mass and momentum densities , including advective , diffusive , stochastic and external forcing terms , to obtain @xmath140 , @xmath141 and @xmath143 .",
    "note that this update preserves the eos constraint as explained in section [ sub : advection ] .",
    "we have tested and validated the accuracy of our methods and numerical implementation using a series of standard deterministic tests , as well as by examining the equilibrium spectrum of the concentration and velocity fluctuations @xcite .",
    "the next two sections present further verification and validation in the context of nonequilibrium systems .",
    "advection of concentration by thermal velocity fluctuations in the presence of large concentration gradients leads to the appearance of _ giant fluctuations _ of concentration , as has been studied theoretically and experimentally for more than a decade @xcite .",
    "these giant fluctuations were previously simulated in the absence of gravity in three dimensions by some of us in ref .",
    "@xcite , and good agreement was found with experimental results @xcite . in those previous studies",
    "the incompressible equations were used , that is , it was assumed that concentration was a passively - advected scalar . however , it is more physically realistic to account for the fact that the properties of the fluid , notably the density and the transport coefficients , depend on the concentration . in ref .",
    "@xcite a series of experiments were performed to study the temporal evolution of giant concentration fluctuations during the diffusive mixing of water and glycerol , starting with a glycerol mass fraction of @xmath268 in the bottom half of the experimental domain , and @xmath61 in the top half . because it is essentially impossible to analytically solve the full system of fluctuating equations in the presence of spatial inhomogeneity and nontrivial boundary conditions , the existing theoretical analysis of the diffusive mixing process @xcite makes a quasi - periodic constant - coefficient incompressible approximation .    for simplicity , in this section",
    "we focus on a time - independent problem and study the spectrum of steady - state concentration fluctuations in a mixture under gravity in the presence of a constant concentration gradient .",
    "this extends the study reported in ref .",
    "@xcite to account for the fact that the density , viscosity , and diffusion coefficient depend on the concentration . for simplicity",
    ", we do two - dimensional simulations , since there are no qualitative differences between the spectrum of concentration fluctuations in two and three dimensions @xcite ( note , however , that in real space , unlike in fourier space , the effect of the fluctuations on the transport is very different in two and three dimensions ) . furthermore , in these simulations we do not include a stochastic flux in the concentration equation , i.e. , we set @xmath269 , so that all fluctuations in the concentration arise from being out of thermodynamic equilibrium . with this approximation",
    "we do not need to model the chemical potential of the mixture and obtain @xmath270 .",
    "this formulation is justified by the fact that it is known experimentally that the nonequilibrium fluctuations are much larger than the equilibrium ones for the conditions we consider @xcite .    in the simple linearized theory presented in section [ sub : gianttheory ]",
    "several approximations are made .",
    "the first one is that a quasi - periodic approximation is used even though the actual system is not periodic in the @xmath203 direction .",
    "this source of error has already been studied numerically in ref .",
    "we also use a boussinesq approximation where it is assumed that @xmath271 and @xmath272 , where @xmath273 is a small density difference between the two fluids , @xmath274 , so that density is approximately constant and @xmath275 .",
    "more precisely , in the boussinesq model the gravity term in the velocity equation only enters through the product @xmath276 so the approximation consists of taking the limit @xmath277 and @xmath278 while keeping the product @xmath276 fixed .",
    "the final approximation made in the simple theory is that the transport coefficients , i.e. , the viscosity and diffusion coefficients , are assumed to be constant .",
    "here we evaluate the validity of the constant - coefficient constant - density approximation ( @xmath279 and @xmath12 constant , @xmath277 ) , as well as the constant - density ( boussinesq ) approximation alone ( @xmath33 constant , @xmath277 , but variable @xmath280 ) , by comparing with the solution to the complete low mach number equations ( @xmath281 and @xmath282 variable ) .",
    "we base our parameters on the experimental studies of diffusive mixing in a water - glycerol mixture , as reported in ref .",
    "the physical domain is @xmath283 discretized on a uniform @xmath284 two dimensional grid , with a thickness of @xmath285 along the @xmath286 direction .",
    "gravity is applied in the negative @xmath203 ( vertical ) direction .",
    "reservoir boundary conditions ( [ eq : v_n_bc ] ) are applied in the @xmath203-direction and periodic boundary conditions in the @xmath201-direction .",
    "we set the concentration to @xmath268 on the bottom boundary and @xmath61 on the top boundary , and apply no - slip boundary conditions for the velocity at both boundaries .",
    "the initial condition is @xmath287 , which is close to the deterministic steady - state profile .",
    "a very good fit to the experimental equation of state ( dependence of density on concentration at standard temperature and pressure ) over the whole range of concentrations of interest is provided by the eos ( [ eq : eos_quasi_incomp ] ) with the density of water set to @xmath288 and the density of glycerol set to @xmath289 . in these simulations",
    "the magnitude of the velocity fluctuations is very small and we did not use filtering ( see appendix [ appendixfiltering ] ) .    experimentally , the dependence of viscosity on glycerol mass fraction has been fit to an exponential function @xcite , which we approximate with a quadratic function over the range of concentrations of interest , @xmath290 where @xmath291 and experimental measurements estimate @xmath292 .",
    "the diffusion coefficient dependence on the concentration has been studied experimentally @xcite , but is in fact strongly affected by thermal fluctuations and spatial confinement @xcite .",
    "we approximate the dependence assuming a stokes - einstein relation @xcite , which is in reasonable agreement with the experimental results in ref .",
    "@xcite over the range of concentrations of interest here , @xmath293 where experimental estimates @xcite for water - glycerol mixtures give @xmath294 , with a schmidt number @xmath295 .",
    "this very large separation of scales between mass and momentum diffusion is not feasible to simulate with our explicit temporal integration methods . referring back to the simplified theory ( [ eq : s_c_c ] ) , which in this case can be simplified further to @xmath296 we see that for @xmath297 the shape of the spectrum of the steady - state concentration fluctuations , and in particular , the cutoff wavenumber due to gravity , is determined from the product @xmath298 and not @xmath12 and @xmath10 individually .",
    "therefore , as also done in ref .",
    "@xcite , we choose @xmath299 and @xmath300 so that @xmath301 is kept at the physical value of @xmath302 but the schmidt number is reduced by two orders of magnitude , @xmath303 , where @xmath304 is an estimate of the average concentration .",
    "the condition @xmath305 and @xmath306 gives our simulation parameters @xmath307 and @xmath308 .",
    "the physical value for gravity is @xmath309 and the solutal expansion coefficient @xmath310 follows from @xmath58 and @xmath59 . when employing the boussinesq approximation , in which gravity only enters through the product @xmath311 we set @xmath312 and @xmath313 so that @xmath314 and increase gravity by the corresponding factor to @xmath315 in order to keep @xmath276 fixed at the physical value .",
    "we also performed simulations with a weaker gravity , @xmath316 , which enhances the nonequilibrium fluctuations , as well as no gravity , which makes the fluctuations truly giant @xcite .",
    "we employ the explicit midpoint temporal integrator ( which we recall is third - order accurate for static covariances ) and set @xmath317 , which results in a diffusive courant number @xmath318 .",
    "we skip the first 50,000 time steps ( about 5 diffusion crossing times ) and then collect samples from the subsequent 50,000 time steps .",
    "we repeat this eight times to increase the statistical accuracy and estimate error bars . to compare to the theory ( [ eq : s_c_c ] ) , we set the concentration gradient to @xmath319 and evaluate @xmath320 at @xmath321 from the equation of state .",
    "when computing the theory , we account for errors in the discrete approximation to the continuum laplacian by using the effective wavenumber @xmath322 instead of the actual discrete wavenumber @xmath323 @xcite .",
    "comparison between the simple theory ( [ eq : s_c_c_simp ] ) ( lines ) and numerical results ( symbols ) .",
    "results are shown for standard gravity @xmath324 ( the cutoff wavenumber @xmath325 ) , for the complete variable - coefficient variable - density low mach model ( green upward triangles ) and the constant - coefficient constant - density approximation ( red squares ) .",
    "also shown are results for a weaker gravity , @xmath326 ( the cutoff wavenumber @xmath327 ) , for the complete low mach model ( magenta pluses ) and the constant - coefficient constant - density approximation ( cyan stars ) . for comparison ,",
    "results for @xmath326 with variable viscosity @xmath328 but constant diffusion coefficient @xmath329 are also shown , for variable density ( orange downward triangles ) and the constant - density ( boussinesq ) approximation ( indigo right - facing triangles ) . finally , results for no gravity are shown in the constant - coefficient approximation ( black circles).,scaledwidth=75.0% ]    the results for the static spectrum of concentration fluctuations @xmath330 as a function of the modified wavenumber @xmath323 ( [ eq : modified_kx ] ) are shown in fig .",
    "[ fig : constantgradient ] . when there is no gravity , we see the characteristic giant fluctuation power - law spectrum of the fluctuations , modulated at small wavenumbers due to the presence of the physical boundaries @xcite . when gravity is present , fluctuations at wavenumber below the cutoff @xmath331^{1/4}$ ] are suppressed .",
    "if we use a constant - coefficient approximation , in which we reduce @xmath314 so that @xmath332 and also fix the transport coefficients at @xmath333 and @xmath334 , we observe good agreement with the quasi - periodic theory ( [ eq : s_c_c_simp ] ) .",
    "when we make the transport coefficients dependent on the concentration as in ( [ eq : nu_c],[eq : chi_c ] ) , we observe a rather small change in the spectrum .",
    "this is perhaps not unexpected because the simplified theory ( [ eq : s_c_c_simp ] ) shows that only the product @xmath298 , and not @xmath12 and @xmath10 individually , matters . since we used the stokes - einstein relation @xmath335 to select the concentration dependence of the diffusion coefficient ,",
    "the value of @xmath298 is constant throughout the physical domain . for comparison , in fig .",
    "[ fig : constantgradient ] we show results from a simulation where we keep the concentration dependence of the viscosity ( [ eq : nu_c ] ) but set the diffusion coefficient to a constant value , @xmath329 , and we observe a more significant change in the spectrum .",
    "further employing the boussinesq approximation makes little difference showing that the primary effect here comes from the dependence of the transport coefficients on concentration .",
    "this shows that under the sort of parameters present in the experiments on diffusive mixing in water - glycerol mixture , it is reasonable to make the boussinesq incompressible approximation ; however , the spatial dependence of the viscosity and diffusion coefficient can not in general be ignored if quantitative agreement is desired . in particular , time - dependent quantities such as dynamic spectra @xcite depend on the individual values of @xmath12 and @xmath10 and not just their product , and are thus expected to be more sensitive to the details of their concentration dependence .",
    "even though the constant - coefficient approximation gives qualitatively the correct shape and a better choice of the constant transport coefficients may improve its accuracy , there is no obvious or simple procedure to _ a priori _ estimate what parameters should be used ( but see @xcite for a proposal to average the constant - coefficient theory over the domain ) .",
    "a direct comparison with experimental results is not possible until multiscale temporal integrators capable of handling the extreme separation of time scales between mass and momentum diffusion are developed . at present",
    "this has only been accomplished in the constant - coefficient incompressible limit ( @xmath43 ) @xcite , and it remains a significant challenge to accomplish the same for the complete low mach number system .",
    "in this section we study the appearance of giant fluctuations during _ time - dependent _ diffusive mixing . as a validation of the low mach number fluctuating equations and our algorithm , we perform simulations of diffusive mixing of two fluids of different densities in two dimensions .",
    "we find excellent agreement between the results of low mach number ( continuum ) simulations and hard - disk molecular dynamics ( particle ) simulations .",
    "this nontrivial test clearly demonstrates the usefulness of low mach number models as a coarse - grained mesoscopic model for problems where sound waves can be neglected .",
    "our simulation setup is illustrated in fig .",
    "[ fig : mixingillustrationmass4 ] .",
    "we consider a periodic square box of length @xmath336 along both the @xmath201 ( horizontal ) and @xmath203 ( vertical ) directions , and initially place all of the fluid of species one ( colored red ) in the middle third of the domain , i.e. , we set @xmath60 for @xmath337 , and @xmath61 otherwise , as shown in the top left panel of the figure . the two fluids mix diffusively and at the end of the simulation the concentration field shows a _ rough diffusive interface _ as confirmed by molecular dynamics simulations shown in the top right panel of the figure .",
    "the deterministic equations of diffusive mixing reduce to a one dimensional model due to the translational symmetry along the @xmath201 axes , and would yield a _",
    "flat _ diffusive interface as illustrated in the bottom left panel of the figure .",
    "however , fluctuating hydrodynamics correctly reproduces the interface roughness , as illustrated in the bottom right panel of the figure and demonstrated quantitatively below .",
    "diffusive mixing between two fluids of unequal densities , @xmath338=4 , with coloring based on concentration , red for the pure first component , @xmath60 , and blue for the pure second component , @xmath61 .",
    "a smoothed shading is used for the coloring to eliminate visual discretization artifacts .",
    "the simulation domain is periodic and contains @xmath339 hydrodynamic ( finite volume ) cells .",
    "the top left panel shows the initial configuration , which is the same for all simulations reported here .",
    "the top right panel shows the final configuration at time @xmath340 as obtained using molecular dynamics .",
    "the bottom left panel shows the final configuration obtained using deterministic hydrodynamics , while the right panel shows the final configuration obtained using fluctuating hydrodynamics.,title=\"fig:\",scaledwidth=40.0%]diffusive mixing between two fluids of unequal densities , @xmath338=4 , with coloring based on concentration , red for the pure first component , @xmath60 , and blue for the pure second component , @xmath61 .",
    "a smoothed shading is used for the coloring to eliminate visual discretization artifacts .",
    "the simulation domain is periodic and contains @xmath339 hydrodynamic ( finite volume ) cells .",
    "the top left panel shows the initial configuration , which is the same for all simulations reported here .",
    "the top right panel shows the final configuration at time @xmath340 as obtained using molecular dynamics .",
    "the bottom left panel shows the final configuration obtained using deterministic hydrodynamics , while the right panel shows the final configuration obtained using fluctuating hydrodynamics.,title=\"fig:\",scaledwidth=40.0% ]    diffusive mixing between two fluids of unequal densities , @xmath338=4 , with coloring based on concentration , red for the pure first component , @xmath60 , and blue for the pure second component , @xmath61 .",
    "a smoothed shading is used for the coloring to eliminate visual discretization artifacts .",
    "the simulation domain is periodic and contains @xmath339 hydrodynamic ( finite volume ) cells .",
    "the top left panel shows the initial configuration , which is the same for all simulations reported here .",
    "the top right panel shows the final configuration at time @xmath340 as obtained using molecular dynamics .",
    "the bottom left panel shows the final configuration obtained using deterministic hydrodynamics , while the right panel shows the final configuration obtained using fluctuating hydrodynamics.,title=\"fig:\",scaledwidth=40.0%]diffusive mixing between two fluids of unequal densities , @xmath338=4 , with coloring based on concentration , red for the pure first component , @xmath60 , and blue for the pure second component , @xmath61 .",
    "a smoothed shading is used for the coloring to eliminate visual discretization artifacts .",
    "the simulation domain is periodic and contains @xmath339 hydrodynamic ( finite volume ) cells .",
    "the top left panel shows the initial configuration , which is the same for all simulations reported here .",
    "the top right panel shows the final configuration at time @xmath340 as obtained using molecular dynamics .",
    "the bottom left panel shows the final configuration obtained using deterministic hydrodynamics , while the right panel shows the final configuration obtained using fluctuating hydrodynamics.,title=\"fig:\",scaledwidth=40.0% ]    we consider here a binary hard - disk mixture in two dimensions .",
    "we use arbitrary ( molecular ) units of length , time and mass for convenience .",
    "all hard disks had a diameter @xmath341 in arbitrary units , and we set the temperature at @xmath342 .",
    "the molecular mass for the first fluid component was fixed at @xmath343 , and for the second component at @xmath344 . for mass ratio @xmath345 , the two types of disks are mechanically - identical and",
    "therefore the species label is simply a red - blue coloring of the particles . in this case @xmath346 and the low mach number equations reduce to the incompressible equations of fluctuating hydrodynamics with a passively - advected concentration field . for the case of unequal particle masses ,",
    "mechanical equilibrium is obtained if the pressures in the two fluid components are the same .",
    "it is well - known from statistical mechanics that for hard disks or hard spheres the pressure is @xmath347 where @xmath348 is the number density , and @xmath349 is a prefactor that only depends on the packing fraction @xmath350 and not on the molecular mass .",
    "therefore , for a mixture of disks or spheres with equal diameters , at constant pressure , the number density and the packing fraction @xmath253 are constant independent of the composition .",
    "the equation of state at constant pressure and temperature is therefore @xmath351 which is exactly of the form ( [ eq : eos_quasi_incomp ] ) with @xmath352 and @xmath67 .",
    "the chemical potential of such a mixture has the same concentration dependence as a low - density gas mixture @xcite , @xmath353.\\ ] ]      in order to validate the predictions of our low mach number model , we performed hard disk molecular dynamics ( hdmd ) simulations of diffusive mixing using a modification of the public - domain code developed by the authors of ref .",
    "we used a packing fraction of @xmath354 for all simulations reported here .",
    "this packing fraction is close to the freezing transition point but is known to be safely in the ( dense ) gas phase ( there is no liquid phase for a hard - disk fluid ) .",
    "the initial particle positions were generated using a nonequilibrium molecular dynamics simulation as in the hard - particle packing algorithm described in ref .",
    "after the initial configuration was generated the disks were assigned a species according to their @xmath203 coordinate , and the mixing simulation performed using event - driven molecular dynamics .    in order to convert the particle data to hydrodynamic data comparable to that generated by the fluctuating hydrodynamics simulations",
    ", we employed a grid of @xmath355 hydrodynamic cells that were each a square of linear dimension @xmath356 . at the chosen packing fraction @xmath354 this corresponds to about @xmath357 disks per hydrodynamic cell , which is deemed a reasonable level of coarse - graining for the equations of fluctuating hydrodynamics to be a reasonably - accurate model , while still keeping the computational demands of the simulations manageable .",
    "we performed hdmd simulations for systems of size @xmath358 and @xmath359 cells , and simulated the mixing process to a final simulation time of @xmath340 units .",
    "the largest system simulated had about @xmath360 million disks ( each simulation took about 5 days of cpu time ) , which is well into the `` hydrodynamic '' rather than `` molecular '' scale .",
    "every @xmath361 units of time , particle data was converted to hydrodynamic data for the purposes of analysis and comparison to hydrodynamic calculations . there is not a unique way of coarse - graining particle data to hydrodynamic data @xcite ; however , we believe that the large - scale ( giant ) concentration fluctuations studied here are _ not _ affected by the particular choice .",
    "we therefore used a simple method consistent with the philosophy of finite - volume conservative discretizations .",
    "specifically , we coarse - grained the particle information by sorting the particles into hydrodynamic cells based on the position of their centroid , as if they were point particles .",
    "we then calculated @xmath36 and @xmath196 in each cell based on the total mass of each species contained inside the given cell .",
    "since all particles have equal diameter other definitions that take into account the particle shape and size give similar results .",
    "we now turn to hydrodynamic simulations of the diffusive mixing of hard disks .",
    "our hydrodynamic calculations use the same grid of cells used to convert particle to hydrodynamic data . the only input required for the hydrodynamic calculations , in addition to those provided by equilibrium statistical mechanics , are the transport coefficients of the fluid as a function of concentration , specifically , the shear viscosity @xmath10 and the diffusion coefficient @xmath12 .    the values for the transport coefficients used in the spatio - temporal discretization , as explained in refs .",
    "@xcite and detailed in appendix [ sec : transportmd ] , are not material constants independent of the discretization .",
    "rather , they are _ bare _ transport values @xmath362 and @xmath299 measured at the length scales of the grid size .",
    "we assumed that the bare transport coefficients obey the same scaling with the mass ratio @xmath363 as predicted by enskog kinetic theory ( [ eq : eta_r_scaling],[eq : chi_r_scaling ] ) .",
    "as explained in appendix [ sec : transportmd ] , theoretical arguments and molecular dynamics results suggest that renormalization effects for viscosity are small and can be safely neglected .",
    "we have therefore fixed the viscosity in the hydrodynamic calculations based on the molecular dynamics estimate @xmath364 for the pure fluid with molecular mass @xmath365 ( see section [ sub : viscosity ] ) . however , the bare diffusion coefficient is strongly dependent on the size of the hydrodynamic cells ( held fixed in our calculations at @xmath366 ) , and on whether filtering ( see appendix [ appendixfiltering ] ) is used",
    ". therefore , the value of @xmath299 needs to be adjusted based on the spatial discretization , in such a way as to match the behavior of the molecular dynamics simulations at length scales much larger than the grid spacing .",
    "we describe the exact procedure we used to accomplish this in section [ sub : diffusioncoeffient ] .",
    "the time step in our explicit algorithm is limited by the viscous cfl number @xmath367 . since",
    "the hydrodynamic calculations are much faster compared to the particle simulations , we used the more expensive rk3 temporal integrator with a relatively small time step @xmath368 , corresponding to @xmath369 for @xmath60 . for @xmath345 and @xmath358 we employed a larger time step , @xmath370 ( @xmath371 ) , with no measurable temporal discretization artifacts for the quantities studied here . we are therefore confident that the discretization errors in this study are dominated by spatial discretization artifacts . in future work",
    "we will explore semi - implicit discretizations and study the effect of taking larger time steps on temporal accuracy .",
    "note that at these parameters for @xmath60 the isothermal speed of sound is @xmath372 so that a compressible scheme would require a time step on the order of @xmath373 ( corresponding to advective cfl of about a half ) .",
    "by contrast , the explicit low mach number algorithm is stable for @xmath374 .",
    "this modest gain is due to the small hydrodynamic cell we use here in order to compare to molecular dynamics . for mesoscopic",
    "hydrodynamic cells the gain in time step size afforded by the low mach formulation will be several orders of magnitude larger .    for mass ratio @xmath345 and @xmath375 , the hydrodynamic calculations were initialized using statistically identical configurations as would be obtained by coarse - graining the initial particle configuration .",
    "this implies a sharp , step - like jump in concentration at @xmath376 and @xmath377 .",
    "since our spatio - temporal discretization is not strictly monotonicity - preserving , such sharp concentration gradients combined with a small diffusion coefficient @xmath299 lead to a large cell peclet number .",
    "this may in turn lead to large deviations of concentration outside of the allowed interval @xmath68 for larger mass ratios .",
    "therefore , for @xmath378 we smoothed the initial condition slightly so that the sharp jump in concentration is spread over a few cells , and also employed a @xmath379 point filter for the advection velocity ( @xmath380 , see appendix [ appendixfiltering ] ) .",
    "we verified that for @xmath375 using filtering only affects the large wavenumbers and does not appear to affect the small wavenumbers we study here , provided the bare diffusion coefficient @xmath299 is adjusted based on the specific filtering width @xmath381 .      in order to compare the molecular dynamics and the hydrodynamic simulations we calculated several statistical quantities :    1 .",
    "the averages of @xmath36 along the directions perpendicular to the concentration gradient , @xmath382 where the integral is discretized as a direct sum over the hydrodynamic cells .",
    "note that it is statistically better to use conserved quantities for such macroscopic averages than to use non - conserved variables such as concentration @xcite .",
    "the spectrum of the concentration averaged along the direction of the gradient by computing the average @xmath383 and then taking the discrete fourier transform .",
    "intuitively , @xmath384 is a measure of the thickness of the red strip in fig .",
    "[ fig : mixingillustrationmass4 ] , and corresponds closely to what is measured in light scattering and shadowgraphy experiments @xcite .",
    "the discrete fourier spectrum of the @xmath203-coordinate of the `` center - of - mass '' of concentration along the direction perpendicular to the gradient , @xmath385 intuitively , @xmath386 is a measure of the height of the centerline of the red strip in fig .",
    "[ fig : mixingillustrationmass4 ] .",
    "all quantities were sampled at certain pre - specified time points in a number of statistically - independent simulations @xmath387 and then means and standard deviations calculated from the @xmath387 data points . for system of size @xmath358 cells we used @xmath388 simulations , and for systems of size @xmath359 we used @xmath389 simulations . by far the majority of the computational cost was in performing the hdmd simulations .",
    "once @xmath299 and @xmath390 were estimated based on simulations of a constant - density ( @xmath345 ) fluid ( see section [ sub : diffusioncoeffient ] ) , kinetic theory ( [ eq : eta_r_scaling],[eq : chi_r_scaling ] ) can be used to estimate them for different density ratios . in fig .",
    "[ fig : spreading_64x64 ] we show @xmath391 for mass ratio @xmath375 , showing good agreement between hdmd and hydrodynamics , especially when fluctuations are accounted for . for @xmath378",
    "a direct comparison is difficult because the initial condition was slightly different in the hydrodynamic simulations due to the need to smooth the sharp concentration gradient for numerical reasons , as explained earlier .",
    "this difference strongly affects the shape of @xmath391 at early times , however , it does not significantly modify the roughness of the interface , which we study next .",
    "the most interesting contribution of fluctuations to the diffusive mixing process is the appearance of giant concentration fluctuations in the presence of large concentration gradients , as evidenced in the roughness of the interface between the two fluids during the early stages of the mixing in fig .",
    "[ fig : mixingillustrationmass4 ] . in order to quantify this interface roughness we used the one - dimensional power spectra @xmath392",
    "note that here we do not correct the discrete wavenumber for the spatial discretization artifacts and continue to use @xmath323 instead of @xmath393 .",
    "discrete spatial spectrum of the interface fluctuations for @xmath345 and @xmath359 ( averaged over 32 simulations ) at several points in time ( drawn with different colors , as indicated in the legend ) , for fluctuating hydrodynamics ( fh , squares with error bars ) and hdmd ( circles , error bars comparable to those for squares ) .",
    "note that the largest wavenumber supported by the grid is @xmath394 .",
    "the larger wavenumbers are however dominated by spatial truncation errors and the filter employed ( if any ) and we do not show them here .",
    "( left panel ) spectrum @xmath395 of the vertically - averaged concentration .",
    "( right panel ) spectrum @xmath396 of the position of the vertical `` center - of - mass '' of concentration.,title=\"fig:\",scaledwidth=49.0%]discrete spatial spectrum of the interface fluctuations for @xmath345 and @xmath359 ( averaged over 32 simulations ) at several points in time ( drawn with different colors , as indicated in the legend ) , for fluctuating hydrodynamics ( fh , squares with error bars ) and hdmd ( circles , error bars comparable to those for squares ) .",
    "note that the largest wavenumber supported by the grid is @xmath394 .",
    "the larger wavenumbers are however dominated by spatial truncation errors and the filter employed ( if any ) and we do not show them here .",
    "( left panel ) spectrum @xmath395 of the vertically - averaged concentration .",
    "( right panel ) spectrum @xmath396 of the position of the vertical `` center - of - mass '' of concentration.,title=\"fig:\",scaledwidth=49.0% ]    the temporal evolution of the spectra @xmath397 and @xmath398 is shown in fig .",
    "[ fig : s_k_mass_1 ] for mass ratio @xmath345 , and in fig .",
    "[ fig : s_k_mass_4 ] for mass ratio @xmath378 , for both hdmd and low mach number fluctuating hydrodynamics ( note that deterministic hydrodynamics would give identically zero for any spectral quantity ) .",
    "we observe an excellent agreement between the two , including the correct initial evolution of the interface fluctuations .",
    "same as fig .",
    "[ fig : s_k_mass_1 ] but for density ratio @xmath378.,title=\"fig:\",scaledwidth=49.0%]same as fig .",
    "[ fig : s_k_mass_1 ] but for density ratio @xmath378.,title=\"fig:\",scaledwidth=49.0% ]    note that for a finite system , eventually complete mixing will take place and the concentration fluctuations will have to revert to their equilibrium spectrum , which is flat in fourier space instead of the power - law behavior seen out of equilibrium . in fig .",
    "[ fig : s_k_mass_1_long ] we show results for mixing up to a time @xmath399 ( this is 128 times longer than those described above ) .",
    "these long simulations are only feasible for the fluctuating hydrodynamics code , and employ a somewhat larger time step @xmath370 .",
    "the results clearly show that at late times the spectrum of the fluctuations reverts to the equilibrium one ; however , this takes some time even after the mixing is essentially complete .",
    "linearized incompressible fluctuating hydrodynamics @xcite predicts that at steady state the spectrum of nonequilibrium concentration fluctuations is a power law with exponent @xmath400 , @xmath401 the dynamically - evolving spectra in the right panel of fig .",
    "[ fig : s_k_mass_1_long ] show approximately such power - law behavior for intermediate times and wavenumbers .    mixing to a time 128 times longer than previous results , with results reported at time intervals @xmath402 for @xmath403 .",
    "these long simulations are only feasible for the fluctuating hydrodynamics code , and employ a somewhat larger time step @xmath370 .",
    "( _ left _ ) horizontally - averaged @xmath36 , as shown for the shorter runs in the left panel of fig .",
    "[ fig : spreading_64x64 ] .",
    "( _ right _ ) the spectrum of interface fluctuations @xmath395 , as shown in the left panels of figs .",
    "[ fig : s_k_mass_1 ] and [ fig : s_k_mass_4 ] for the shorter runs .",
    "the theoretical estimates for the spectrum of equilibrium fluctuations , which is independent of wavenumber , is also shown .",
    "we also indicate the theoretical prediction for the power - law of the spectrum of steady - state nonequilibrium fluctuations under an applied concentration gradient , @xmath404,title=\"fig:\",scaledwidth=49.0%]mixing to a time 128 times longer than previous results , with results reported at time intervals @xmath402 for @xmath403 .",
    "these long simulations are only feasible for the fluctuating hydrodynamics code , and employ a somewhat larger time step @xmath370 .",
    "( _ left _ ) horizontally - averaged @xmath36 , as shown for the shorter runs in the left panel of fig .",
    "[ fig : spreading_64x64 ] .",
    "( _ right _ ) the spectrum of interface fluctuations @xmath395 , as shown in the left panels of figs .",
    "[ fig : s_k_mass_1 ] and [ fig : s_k_mass_4 ] for the shorter runs .",
    "the theoretical estimates for the spectrum of equilibrium fluctuations , which is independent of wavenumber , is also shown .",
    "we also indicate the theoretical prediction for the power - law of the spectrum of steady - state nonequilibrium fluctuations under an applied concentration gradient , @xmath404,title=\"fig:\",scaledwidth=49.0% ]      in order to illustrate the appearance of giant fluctuations in three dimensions we performed simulations of mixing in a mixture of hard spheres with equal diameters , @xmath341 , and mass ratio @xmath378 . the packing density was chosen to be @xmath405 , which corresponds to a very dense gas , but is still well below the freezing point @xmath406 . for the hydrodynamic simulations we used cubic cells of dimension @xmath407 , which corresponds to about @xmath408 particles per hydrodynamic cell on average . in fig .",
    "[ fig : s_k_mass_4_3d ] we show results from a single simulation with a grid of size @xmath409 cells , which would correspond to about @xmath410 particles .",
    "this makes molecular dynamics simulations infeasible , and makes hydrodynamic calculations an invaluable tool in studying the mixing process at these mesoscopic scales .    in the hydrodynamic simulations we used bare transport coefficient values based on enskog kinetic theory for the hard - sphere fluid @xcite . for the single - component fluid with molecular mass @xmath365",
    ", this theory gives @xmath411 and @xmath412 , which corresponds to a bare schmidt number @xmath413 .",
    "we employed the same model dependence of bare transport coefficients on concentration as for hard disks , see eqs .",
    "( [ eq : eta_r_scaling],[eq : chi_r_scaling ] ) .",
    "the time step was set at @xmath414 ( corresponding to viscous cfl number @xmath415 ) . in three dimensions ,",
    "the cell peclet number is reduced with decreasing @xmath128 and we did not find it necessary to employ any filtering .",
    "diffusive mixing in three dimensions similar to that illustrated in fig .",
    "[ fig : mixingillustrationmass4 ] for two dimensions .",
    "parameters are based on enskog kinetic theory for a hard - sphere fluid at packing fraction @xmath405 , and there is no gravity .",
    "the mixing starts with the top half being one species and the bottom half another species , with density ratio @xmath378 , and concentration is kept fixed at the top and bottom boundaries while the side boundaries are periodic . a snapshot taken at time @xmath416 is shown .",
    "( _ top panel _ )",
    "the side panes show two dimensional slices for the concentration @xmath34 . the approximated contour surface @xmath417 is shown with color based on surface height to illustrate the rough diffusive interface .",
    "( bottom left panel ) similar as top panel but bottom pane shows vertically - averaged concentration @xmath418 , illustrating the giant concentration fluctuations .",
    "( bottom right panel ) the fourier spectrum @xmath419 of @xmath384 .",
    "the color axes is logarithmic and clearly shows the appearance of large scale ( small wavenumber ) fluctuations , as also seen in fig .",
    "[ fig : s_k_mass_4 ] in two dimensions.,scaledwidth=75.0% ]    diffusive mixing in three dimensions similar to that illustrated in fig .",
    "[ fig : mixingillustrationmass4 ] for two dimensions .",
    "parameters are based on enskog kinetic theory for a hard - sphere fluid at packing fraction @xmath405 , and there is no gravity .",
    "the mixing starts with the top half being one species and the bottom half another species , with density ratio @xmath378 , and concentration is kept fixed at the top and bottom boundaries while the side boundaries are periodic . a snapshot taken at time",
    "@xmath416 is shown .",
    "( _ top panel _ )",
    "the side panes show two dimensional slices for the concentration @xmath34 . the approximated contour surface @xmath417 is shown with color based on surface height to illustrate the rough diffusive interface .",
    "( bottom left panel ) similar as top panel but bottom pane shows vertically - averaged concentration @xmath418 , illustrating the giant concentration fluctuations .",
    "( bottom right panel ) the fourier spectrum @xmath419 of @xmath384 .",
    "the color axes is logarithmic and clearly shows the appearance of large scale ( small wavenumber ) fluctuations , as also seen in fig .",
    "[ fig : s_k_mass_4 ] in two dimensions.,title=\"fig:\",scaledwidth=49.0%]diffusive mixing in three dimensions similar to that illustrated in fig .",
    "[ fig : mixingillustrationmass4 ] for two dimensions .",
    "parameters are based on enskog kinetic theory for a hard - sphere fluid at packing fraction @xmath405 , and there is no gravity .",
    "the mixing starts with the top half being one species and the bottom half another species , with density ratio @xmath378 , and concentration is kept fixed at the top and bottom boundaries while the side boundaries are periodic . a snapshot taken at time",
    "@xmath416 is shown .",
    "( _ top panel _ )",
    "the side panes show two dimensional slices for the concentration @xmath34 . the approximated contour surface @xmath417 is shown with color based on surface height to illustrate the rough diffusive interface .",
    "( bottom left panel ) similar as top panel but bottom pane shows vertically - averaged concentration @xmath418 , illustrating the giant concentration fluctuations .",
    "( bottom right panel ) the fourier spectrum @xmath419 of @xmath384 .",
    "the color axes is logarithmic and clearly shows the appearance of large scale ( small wavenumber ) fluctuations , as also seen in fig .",
    "[ fig : s_k_mass_4 ] in two dimensions.,title=\"fig:\",scaledwidth=49.0% ]    instead of the fully periodic domain used in the two dimensional hard - disk simulations , here we employ the fixed - concentration boundary conditions ( [ eq : v_n_bc ] ) and set @xmath420 at the bottom and @xmath421 at the top boundary .",
    "this emulates the sort of `` open '' or `` reservoir '' boundaries @xcite that mimic conditions in experimental studies of diffusive mixing @xcite .",
    "the initial condition is a fully phase - separated mixture with @xmath60 for @xmath422 , and @xmath61 otherwise . as the mixing process continues the diffusive interface roughens and giant concentrations",
    "appear , as illustrated in fig .",
    "[ fig : s_k_mass_4_3d ] and also observed experimentally in water - glycerol mixtures in ref .",
    "@xcite . in three dimensions , however , the diffusive interface roughness is much smaller than in two dimensions , being on the order of only 20 molecular diameters for the snapshot shown in the figure .",
    "this illustrates the importance of dimensionality when including thermal fluctuations .",
    "in particular , unlike in deterministic fluid dynamics , in fluctuating hydrodynamics one can not simply eliminate dimensions from consideration even in simple geometries .",
    "approximate theory based on the boussinesq approximation and linearization of the equations of fluctuating hydrodynamics has been developed in ref .",
    "@xcite and applied in the analysis of experimental results on mixing in a water - glycerol mixture in the presence of gravity @xcite .",
    "the simulations reported here do not make the sort of approximations necessary in analytical theories and can in principle be used to study the mixing process quantitatively .",
    "however , it is important to emphasize that in realistic liquids , such as a water - glycerol mixture , the schmidt number is on the order of a thousand .",
    "this makes explicit time stepping schemes that fully resolve the dynamics of the velocity fluctuations infeasible . in future work",
    "we will consider semi - implicit type stepping methods that relax the severe time stepping restrictions present in the explicit schemes considered here .",
    "the behavior of fluids is strongly affected by thermal fluctuations at scales from the microscopic to the macroscopic .",
    "fluctuating hydrodynamics is a powerful coarse - grained model for fluid dynamics at mesoscopic and macroscopic scales , at both a theoretical and a computational level .",
    "theoretical calculations are rather complicated in the presence of realistic spatial inhomogeneities and nontrivial boundary conditions . in numerical simulations , those effects can readily be handled , however , the large separation of time scales between different physical processes poses a fundamental difficulty .",
    "compressible fluctuating hydrodynamics bridges the gap between molecular and hydrodynamic scales . at spatial scales",
    "not much larger than molecular , sound and momentum and heat diffusion occur at comparable time scales in both gases and liquids . at mesoscopic and",
    "larger length scales , fast pressure fluctuations due to thermally - actuated sound waves are much faster than diffusive processes .",
    "it is therefore necessary to eliminate sound modes from the compressible equations . in the deterministic context",
    "this is accomplished using low mach number asymptotic expansion .    for homogeneous simple fluids or mixtures of dynamically - identical fluids the zeroth order low mach equations",
    "are the well - known incompressible navier - stokes equations , in which pressure is a lagrange multiplier enforcing a divergence - free velocity field . in mixtures of dissimilar fluids , local changes in composition and temperature cause local expansion and contraction of the fluid and thus a nonzero velocity divergence . in this paper",
    "we proposed low mach number fluctuating equations for isothermal binary mixtures of incompressible fluids with different density , or a mixture of low - density gases with different molecular masses .",
    "these equations are a straightforward generalization of the widely - used incompressible fluctuating navier - stokes equations . in the low mach number equations",
    "the incompressibility constraint @xmath423 is replaced by @xmath424 , which ensures that compositional changes are accompanied by density changes in agreement with the fluid equation of state ( eos ) at constant pressure and temperature .",
    "this seemingly simple generalization poses many non - trivial analytical and numerical challenges , some of which we addressed in this paper .    at the analytical level",
    "the low mach number fluctuating equations are different from the incompressible equations because the velocity divergence is directly coupled to the time derivative of the concentration fluctuations .",
    "this means that at thermodynamic equilibrium the velocity is not only white in space , a well - known difficulty with the standard equations of fluctuating hydrodynamics , but is also white in time , adding a novel type of difficulty that has not heretofore been recognized .",
    "the unphysically fast fluctuations in velocity are caused by the unphysical assumption of infinite separation of time scales between the sound and the diffusive modes .",
    "this unphysical assumption also underlies the incompressible fluctuating navier - stokes equations , however , in the incompressible limit @xmath277 the problem is not apparent because the component of velocity that is white in time disappears .",
    "here we analyzed the low mach equations at the linearized level , and showed that they reproduce the slow diffusive fluctuations in the full compressible equations , while eliminating the fast pressure fluctuations . at the formal level , we suggest that a generalized hodge decomposition can be used to separate the vortical ( solenoidal ) modes of velocity as the independently fluctuating variable , coupled with a gauge formulation used to treat the divergence constraint . such nonlinear analysis is deferred for future research , and here we relied on the fact that the temporal discretization regularizes the short - time dynamics at time scales faster than the time step size @xmath126 .    at the numerical level ,",
    "the low mach number equations pose several distinct challenges .",
    "the first challenge is to construct conservative spatial discretizations in which density is advected in a locally - conservative manner while still maintaining the equation of state constraint relating the local densities and composition .",
    "we accomplish this here by using a specially - chosen model eos that is linear yet still rather versatile in practice , and by advecting densities using a velocity that obeys a discrete divergence constraint .",
    "we note that for this simplified case , the system can be modeled using only the concentration to describe the thermodynamic state .",
    "however , for more general low mach number models maintaining a full thermodynamic representation of the state independent of the constraint leads to more robust numerics . as in incompressible hydrodynamics , enforcing this constraint requires a poisson pressure solver that dominates the computational cost of the algorithm .",
    "a second challenge is to construct temporal integrators that are at least second - order in time .",
    "we accomplish this here by formally introducing an unconstrained gauge formulation of the equations , while at the same time taking advantage of the gauge degree of freedom to avoid ever explicitly dealing with the gauge variable .",
    "the present temporal discretizations are purely explicit and are similar in spirit to an explicit projection method . a third and remaining challenge is to design efficient temporal integrators that handle momentum diffusion , the second - fastest physical process , semi - implicitly .",
    "this poses well - known challenges even in the incompressible setting .",
    "these challenges were bypassed in recently - developed temporal integrators for the incompressible fluctuating navier - stokes equations @xcite by avoiding the splitting inherent in projection methods .",
    "extending this type of stokes - system approach to the low mach equations will be the subject of future research .",
    "one of the principal motivations for developing the low mach number equations and our numerical implementation was to model recent experiments on the development of giant concentration fluctuations in the presence of sharp concentration gradients .",
    "we first studied giant fluctuations in a time - independent or static setting , as observed experimentally by inducing a constant concentration gradient via a constant applied temperature gradient .",
    "our simulations show that under conditions employed in experimental studies of the diffusive mixing of water and glycerol , it is reasonable to employ the boussinesq approximation . the results also indicate that the constant - transport - coefficient approximation that is commonly used in theoretical calculations is appropriate if the diffusion coefficient follows a stokes - einstein relation , but should be used with caution in general .",
    "we continued our study of giant concentration fluctuations by simulating the temporal evolution of a rough diffusive interface during the diffusive mixing of hard disk fluids .",
    "comparison between computationally - intensive event - driven molecular dynamics simulations and our hydrodynamic calculations demonstrated that the low mach number equations of fluctuating hydrodynamics provide an accurate coarse - grained model of fluid mixing .",
    "special care must be exercised , however , in choosing the bare transport coefficients , especially the concentration diffusion coefficient , as these are renormalized by the fluctuations and can be strongly grid - dependent @xcite .",
    "some questions remain about how to define and measure the bare transport coefficients from microscopic simulations , but we show that simply comparing particle and hydrodynamic calculations at large scales is a robust technique .",
    "the strong coupling between velocity fluctuations and diffusive transport means that deterministic models have limited utility at mesoscopic scales , and even macroscopic scales in two - dimensions .",
    "this implies that standard fluorescent techniques for measuring diffusion coefficients , such as fluorescence correlation spectroscopy ( fcs ) and fluorescence recovery after photobleaching ( frap ) @xcite , may not in fact be measuring material constants but rather geometry - dependent values @xcite .",
    "fluctuating hydrodynamic simulations of typical experimental simulations , however , are still out of reach due to the very large separation of time scales between mass and momentum diffusion . surpassing this limitation requires the development of a semi - implicit temporal discretization that is stable for large time steps .",
    "furthermore , it is also necessary to develop novel mathematical models and algorithms that are not only stable but also accurate in the presence of such large separation of scales .",
    "this is a nontrivial challenge if thermal fluctuations are to be included consistently , and will be the subject of future research",
    ".    we would like to thank boyce griffith and mingchao cai for helpful comments .",
    "j. bell , a. nonaka and a. garcia were supported by the doe applied mathematics program of the doe office of advanced scientific computing research under the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "a. donev was supported in part by the national science foundation under grant dms-1115341 and the office of science of the u.s .",
    "department of energy through early career award number de - sc0008271 .",
    "t. fai wishes to acknowledge the support of the doe computational science graduate fellowship , under grant number de - fg02 - 97er25308 . y.",
    "sun was supported by the national science foundation under award oci 1047734 .",
    "as discussed in more depth in ref .",
    "@xcite , there are fundamental mathematical difficulties with the interpretation of the nonlinear equations of fluctuating hydrodynamics due to the roughness of the fluctuating fields .",
    "it should be remembered , however , that these equations are coarse - grained models with the coarse - graining length scale set by the size of the hydrodynamic cells used in discretizing the equations @xcite .",
    "the spatial discretization removes the small length scales from the stochastic forcing and regularizes the equations .",
    "it is important to point out , however , that imposing such a small - scale regularization _ _ ( smoothing ) of the stochastic forcing also requires a suitable renormalization of the transport coefficients @xcite , as we discuss in more detail in section [ sec : mixingmd ] .",
    "as long as there are sufficiently many molecules per hydrodynamic cell the fluctuations in the spatially - discrete hydrodynamic variables will be small and the behavior of the nonlinear equations will closely follow that of the _ linearized _ equations of fluctuating hydrodynamics @xcite , which can be given a precise meaning @xcite .",
    "it is therefore crucial to understand the linearized equations from a theoretical perspective , and to analyze the behavior of the numerical schemes in the linearized setting @xcite .",
    "some of the most important quantities predicted by the fluctuating hydrodynamics equations are the equilibrium structure factors ( static covariances ) of the fluctuating fields .",
    "these can be obtained by linearizing the compressible equations ( [ llns_primitive ] ) around a uniform reference state , @xmath425 , @xmath426 , @xmath427 , @xmath428 where @xmath429,\\ ] ] and then applying a spatial fourier transform @xcite .",
    "owing to fluctuation - dissipation balance the static structure factors are independent of the wavevector @xmath430 at thermodynamic equilibrium , @xmath431 note that density fluctuations do not vanish even in the incompressible limit @xmath25 unless @xmath43 .",
    "while fluctuations in @xmath36 and @xmath196 are uncorrelated , the fluctuations in concentration and density are _ correlated _ even at equilibrium , @xmath432 we will see below that the low mach equations correctly reproduce the static covariances of density and concentration in the limit @xmath25 .    the dynamics of the equilibrium fluctuations can also be studied by applying a fourier - laplace transform in time in order to obtain the dynamic structure factors ( equilibrium correlation functions ) as a function of wavenumber @xmath430 and wavefrequency @xmath52 @xcite .",
    "it is well - known that the dynamic spectrum of density fluctuations @xmath433 exhibits three peaks for a given @xmath430 , one central rayleigh peak at small frequencies ( slow concentration fluctuations ) , and two symmetric brillouin peaks centered around @xmath54 .",
    "as the fluid becomes less compressible ( i.e. , the speed of sound increases ) , there is an increasing separation of time - scales between the side and central spectral peaks .",
    "as we will see below , the low mach equations reproduce the central peaks in the dynamic structure factors only , eliminating the side peaks and the associated stiff dynamics .",
    "we now examine the spatio - temporal correlations of the steady - state fluctuations in the low mach number equations ( [ eq : momentum_eq],[eq : rho1_eq],[eq : div_v_constraint],[eq : rho_eq ] ) . in order to model the nonequilibrium setting in which giant concentration fluctuations",
    "are observed , we include a constant background concentration gradient in the equations .",
    "note that a density gradient will accompany a concentration gradient , and this can introduce some additional terms in @xmath434 depending on how @xmath435 depends on concentration . for simplicity , we assume @xmath435 is a constant so that the diffusive term @xmath436 in ( [ eq : rho1_eq ] ) is simply @xmath437 .",
    "we also assume the viscosity @xmath10 is spatially constant , to get the simplified coupled velocity - concentration equations , @xmath438 where @xmath439 and @xmath124 is given by ( [ eq : eos_quasi_incomp ] ) .",
    "we linearize the equations ( [ eq : simpl_primitive_eqs ] ) around a steady state , @xmath440 , @xmath441 , and @xmath442 , where the reference state is in mechanical equilibrium , @xmath443 .",
    "we denote the background concentration gradient with @xmath444 .",
    "we additionally assume that the reference state varies very weakly on length scales of order of the wavelength , an in particular , that @xmath70 and @xmath69 are essentially constant .",
    "this allows us to drop the bars from the notation and employ a _ quasi - periodic _ or weak - gradient approximation @xcite . in the linear approximation",
    ", the eos constraint relates density and concentration fluctuations , @xmath445 .",
    "the term @xmath446 is second order in the fluctuations and drops out , but the advective term @xmath447 leads to a term @xmath448 in the concentration equation .",
    "the forcing term due to gravity becomes @xmath449 . after a spatial fourier transform ,",
    "the linearized form of ( [ eq : simpl_primitive_eqs ] ) becomes a collection of stochastic differential equations , one system of linear additive - noise equations per wavenumber , @xmath450.\\label{eq : div_v_linearized}\\end{aligned}\\ ] ] replacing the right hand side of ( [ eq : div_v_linearized ] ) with zero leads to the incompressible approximation used in ref .",
    "@xcite , corresponding to the boussinesq approximation of taking the limit @xmath277 while keeping the product @xmath276 constant .",
    "let us first compare the dynamics of the equilibrium fluctuations ( @xmath451 ) in the low mach equations with those in the complete compressible equations .",
    "for simplicity of notation we will continue to use the hat symbol to denote the space - time fourier transform .    in the wavenumber - frequency @xmath452 fourier domain , the concentration fluctuations in the absence of a gradient are obtained from ( [ eq : c_t_linearized ] ) , @xmath453 which is the same as the compressible equations .",
    "the density fluctuations follow the concentration fluctuations , @xmath454 , and the dynamic structure factor for density shows the same central rayleigh peak as obtained from the isothermal compressible equations @xcite , @xmath455 where we used eq .",
    "( [ stoch_flux_covariance ] ) for the covariance of @xmath456 .",
    "this shows that the low mach number equations correctly reproduce the slow fluctuations ( small @xmath52 ) in density and concentration , while eliminating the side brillouin peaks associated with the fast isentropic pressure fluctuations .    the fluctuations in velocity , however , are different between the compressible and low mach number equations .",
    "let us first examine the transverse ( solenoidal ) component of velocity @xmath457 , where @xmath458 is the constant - density orthogonal projection onto the space of divergence - free velocity fields ( @xmath459 in fourier space ) .",
    "applying the projection operator to the velocity equation ( [ eq : v_t_linearized ] ) shows that the fluctuations of the solenoidal modes are the same as in the incompressible approximation , @xmath460 the fluctuations of the compressive velocity component @xmath461 , on the other hand , are driven by the stochastic mass flux @xmath456 , as seen from eq .",
    "( [ eq : div_v_linearized ] ) at thermodynamic equilibrium , @xmath462 the dynamic structure factor ( space - time fourier spectrum ) of the longitudinal component @xmath463 does not decay to zero as @xmath53 .",
    "this indicates that the fluctuations of velocity are not only white in space but also white in time . in the incompressible approximation",
    "@xmath277 so that the longitudinal velocity fluctuations vanish and the static spectrum of the velocity fluctuations is equal to the projection operator , @xmath464 @xcite . in the compressible equations ,",
    "the dynamic structure factor for the longitudinal component of velocity decays to zero as @xmath53 because it has two sound ( brillouin ) peaks centered around @xmath465 , in addition to the central diffusive ( rayleigh ) peak .",
    "the low mach number equations reproduce the central peak ( slow fluctuations ) correctly , replacing the side peaks with a flat spectrum for large @xmath52 .",
    "the origin of this unphysical behavior is the unjustified assumption of infinite separation of time scales between the propagation of sound and the diffusion of mass , momentum and energy . in reality",
    ", the same molecular motion underlies all of these processes and the incompressible or the low mach number equations can not be expected to reproduce the correct physical behavior at very short time scales ( @xmath466 ) .",
    "if we neglect the term involving @xmath456 in ( [ eq : div_v_linearized ] ) and eliminate the lagrange multiplier ( non - thermodynamic pressure ) @xmath31 using ( [ eq : div_v_linearized ] ) , we obtain the linearized velocity equation in fourier space @xmath467\\v k+i\\beta\\chi\\left(\\nu-\\chi\\right)k^{2}\\left(\\widehat{\\delta c}\\right)\\v k.\\label{eq : vhat_t_proj}\\end{aligned}\\ ] ] it is straightforward to obtain the steady - state covariances ( static structure factors ) in the presence of a concentration gradient from the linearized system of velocity - concentration equations ( [ eq : c_t_linearized],[eq : vhat_t_proj ] ) @xcite",
    ". the procedure amounts to solving a linear system for three covariances ( velocity - velocity , concentration - concentration , and velocity - concentration ) .",
    "these types of calculations are particularly well - suited for modern computer algebra systems like maple and can be carried out for arbitrary wavenumber and background concentration gradient .",
    "we omit the full solution for brevity .",
    "experiments measure the steady - state spectrum of concentration fluctuations averaged along the gradient @xcite , and we will therefore focus on wavenumbers perpendicular to the gradient , @xmath468 .",
    "a straightforward calculation shows that the concentration fluctuations are enhanced as the square of the applied gradient , @xmath469}\\ , h_{\\parallel}^{2},\\label{eq : s_c_c}\\ ] ] where * @xmath470 * and @xmath471 denote the perpendicular and parallel component relative to gravity , respectively .",
    "the term in the denominator involving @xmath472 comes from the low mach number constraint ( [ eq : div_v_constraint ] ) and is usually negligible since the concentration gradient is parallel to gravity or @xmath473 . without this term",
    "the result ( [ eq : s_c_c ] ) is the same result as obtained in @xcite , and shows that fluctuations at wavenumbers below @xmath474 are suppressed by gravity , as we study numerically in section [ sec : giantfluct ] .",
    "in our spatial discretization , we use centered differencing for the advective terms because this leads to a skew - adjoint discretization of advection @xcite that maintains discrete fluctuation - dissipation balance in the spatially - discretized stochastic equations @xcite .",
    "it is well - known that centered discretizations of advection do not preserve monotonicity properties of the underlying pdes in the deterministic setting , unlike one - sided ( upwind ) discretizations .",
    "therefore , our spatio - temporal discretization can lead to unphysical oscillations of the concentration and density in cases where the cell peclet number @xmath475 is large .    in the deterministic setting ,",
    "@xmath476 can always be decreased by reducing @xmath128 and resolving the fine scale dissipative features of the flow . however , in the stochastic setting , the magnitude of the fluctuating velocities at equilibrium is @xmath477 where @xmath156 is the volume of the hydrodynamic cell .",
    "therefore , in two dimensions the characteristic advection velocity magnitude is @xmath478 .",
    "this means that in two dimensions @xmath476 is independent of the grid size and reducing @xmath128 can not fix problems that may arise due to a large cell peclet number . for some of the simulations reported in section [ sec : mixingmd ] ,",
    "we have found it necessary to implement a spatial filtering procedure to reduce the magnitude of the fluctuating velocities while preserving their spectrum as well as possible at small wavenumbers .",
    "the filtering procedure consists of applying a local averaging operation to the spatially - discretized random fields @xmath479 and @xmath24 independently along each cartesian direction .",
    "this local averaging smooths the random forcing and thus reduces the spectrum of the random forcing at larger wavenumbers .",
    "the specific filters we use are taken from ref .",
    "for stencil width @xmath480 , filtering a discrete field @xmath481 in one dimension takes the form @xmath482 in fourier space , for discrete wavenumber @xmath483 this local averaging multiplies the spectrum of @xmath481 by @xmath484 and therefore maintains the second - order accuracy of the spatial discretization . at the same time , the filtering reduces the variance of the fluctuating fields by about a factor of two in one dimension ( a larger factor in two dimensions ) .",
    "the spectrum of the fluctuations can be preserved even more accurately if a stencil of width @xmath380 is used for the local averaging , @xmath485 giving a sixth - order accurate filter @xmath486 and a reduction of the variance by about a third in one dimension . in two and three dimensions the filtering",
    "operators are simple tensor products of one - dimensional filtering operators .",
    "note that we only use these filters with periodic boundary conditions .",
    "one can , of course , also use fourier transform techniques to filter out high frequency components from the stochastic mass and momentum fluxes .",
    "the hydrodynamic simulations described in section [ sec : mixingmd ] require as input transport coefficients , notably , the shear viscosity @xmath10 and diffusion coefficient @xmath12 , which need to be extracted from the underlying microscopic ( molecular ) dynamics .",
    "this is a very delicate and important step that has not , to our knowledge , been carefully performed in previous studies . in this appendix",
    "we give details about the procedure we developed for this purpose .      as discussed in more detail in refs .",
    "@xcite , the transport coefficients in fluctuating hydrodynamics are not universal material constants but rather depend on the spatial scale ( degree of coarse - graining ) under question .",
    "we emphasize that this scale - dependent renormalization is not a molecular scale effect but rather an effect arising out of hydrodynamic fluctuations , and persists even at the hydrodynamic scales we are examining here .",
    "the best way to define and measure transport coefficients is by examining the dynamics of _ equilibrium _ fluctuations , specifically , by examining the _ dynamic structure factors _ of the hydrodynamic fields @xcite , i.e. , the equilibrium averages of the spatio - temporal fourier spectra of the fluctuating hydrodynamic fields . for a hydrodynamic variable @xmath488 that is transported by a purely diffusive process",
    ", the spectrum of the fluctuations at a given wavenumber @xmath191 and wavefrequency @xmath52 is expected to be a lorentzian peak of the form @xmath489^{-1},\\ ] ] where in general the diffusion constant @xmath490 depends on the the wavenumber @xmath191 ( wavelength @xmath491 ) .",
    "we can therefore estimate the diffusion coefficient @xmath12 by fitting a lorentzian peak to @xmath492 for different @xmath191 s ( i.e. , @xmath493 ) .",
    "similarly , we can estimate the kinematic viscosity @xmath439 by fitting a lorentzian curve to dynamic structure factors for the scaled vorticity , @xmath494 .",
    "we performed long equilibrium molecular dynamics simulations of systems corresponding to a grid of @xmath495 hydrodynamic cells , and then calculated the discrete spatio - temporal fourier spectrum of the hydrodynamic fields at a collection of discrete wavenumbers @xmath430 .",
    "since these simulations are at equilibrium , the systems are well - mixed , specifically , the initial configurations were generated by randomly assigning a species label to each particle .",
    "we then performed a nonlinear least squares lorentzian fit in @xmath52 for each @xmath430 and estimated the width of the lorentzian peak .",
    "the results for the dynamics of the equilibrium vorticity fluctuations are shown in fig .",
    "[ fig : s_kw_hdmd ] .",
    "we see that kinematic viscosity is relatively constant for a broad range of wavelengths , consistent with fluctuating hydrodynamics calculations @xcite and previous molecular dynamics simulations @xcite . for the pure component one fluid , @xmath60 , with density",
    "@xmath496 the figure shows @xmath497 .",
    "we therefore used @xmath498 in all of the hydrodynamic runs reported in section [ sec : mixingmd ] .",
    "this is about @xmath499 higher than the prediction of the simple enskog kinetic theory @xcite , @xmath500 , and is consistent with the estimates reported in ref .",
    "because of the diffusion coefficient is small at the densities we study , more specifically , because the schmidt number @xmath501 is larger than 10 , we were unable to obtain reliable estimates for @xmath502 from the dynamic structure factor for concentration .",
    "simple dimensional analysis or kinetic theory shows that @xmath503 .",
    "since the disks of the two species have equal diameters the viscosity of the pure second fluid component is @xmath504 there is no simple theory that accurately predicts the concentration dependence of the viscosity of a hard disk mixture at higher densities @xcite . to our knowledge",
    "there is no published enskog kinetic theory calculations for hard - disk mixtures in two dimensions , even for the simpler case of equal diameters . as an approximation to the true dependence , we employed a simple linear interpolation of the _ kinematic _ viscosity @xmath505 as a function of the mass concentration @xmath34 between the two known values @xmath506 and @xmath507 . the numerical results for mixtures with mass ratios @xmath375 and @xmath378 in fig .",
    "[ fig : s_kw_hdmd ] are consistent with this approximation to within the large error bars .",
    "for example , for @xmath508 and @xmath378 the interpolation gives @xmath509 which is in reasonable agreement with the numerical estimate .",
    "estimates of the momentum diffusion coefficient ( viscosity ) @xmath439 obtained from the width of the central peak in the dynamic structure factor of vorticity . a collection of @xmath510 distinct discrete wavenumbers @xmath430 were used and the width of the peaks estimated using a nonlinear least squares lorentzian fit.,scaledwidth=75.0% ]      for the inter - species diffusion coefficient @xmath12 , which we emphasize is distinct from the self - diffusion coefficients for particles of either species , enskog kinetic theory predicts no concentration dependence and a simple scaling with the mass ratio @xcite , @xmath511 this particular dependence on mass ratio @xmath363 comes from the fact that the average relative speed between particles of different species is @xmath512 , where @xmath513 is the reduced molecular mass .",
    "we have assumed in our hydrodynamic calculations that the diffusion coefficient is independent of concentration and follows ( [ eq : chi_r_scaling ] ) .",
    "the only input to the hydrodynamic calculation is the bare self - diffusion coefficient for the pure component fluid , @xmath514 .",
    "diffusion is strongly renormalized by thermal fluctuations , and fluctuating hydrodynamics theory and simulations predict a strong dependence of the diffusion coefficient @xmath12 on the wavelength @xcite , consistent with molecular dynamics results @xcite .    in order to estimate the appropriate value of the bare diffusion coefficient @xmath299 we numerically solved an inverse problem . using simple bisection",
    ", we looked for the value of @xmath299 that leads to best agreement for the average or `` macroscopic '' diffusion ( mixing ) between the particle and continuum simulations .",
    "specifically , we calculated the density of the first species @xmath391 along the @xmath203-direction by averaging @xmath36 in each horizontal row of hydrodynamic cells , see eq .",
    "( [ eq : rho_1_h ] ) .",
    "the results for @xmath515 for mass ratios @xmath345 and @xmath378 are shown in fig . [",
    "fig : spreading_64x64 ] at different points in time for systems of size @xmath358 cells .",
    "the figures show the expected sort of diffusive mixing profile , and is exactly what would be used in experiments to measure diffusion coefficients using fluorescent techniques such as fluorescence recovery after photo - bleaching ( frap ) @xcite .",
    "this macroscopic measurement smooths over the fluctuations ( roughness ) of the diffusive interface and only measures an effective diffusion coefficient at the scale of the domain length @xmath336 .",
    "if deterministic hydrodynamics is employed , @xmath391 is the solution of a one - dimensional system of equations obtained by simply deleting the stochastic forcing and the @xmath201-dependence in the low mach equations . instead of solving this system analytically , we employed our spatio - temporal discretization with fluctuations turned off , and with an effective diffusion coefficient @xmath516 that accounts for the renormalization of the diffusion coefficient by the thermal fluctuations .",
    "( left panel ) diffusive evolution of the horizontally - averaged density @xmath391 for a system of size @xmath358 hydrodynamic cells and density ratio @xmath345 , as obtained from hdmd simulations ( circles , averaged over 64 runs ) , deterministic hydrodynamics with @xmath517 ( dashed lines ) , and fluctuating hydrodynamics with @xmath518 ( squares , averaged over 64 runs ) .",
    "error bars are comparable to the symbol size and not shown for clarity .",
    "( right panel ) same as the left panel except the density ratio is @xmath375 and the transport coefficients are adjusted according to ( [ eq : eta_r_scaling],[eq : chi_r_scaling]).,title=\"fig:\",scaledwidth=49.0%](left panel ) diffusive evolution of the horizontally - averaged density @xmath391 for a system of size @xmath358 hydrodynamic cells and density ratio @xmath345 , as obtained from hdmd simulations ( circles , averaged over 64 runs ) , deterministic hydrodynamics with @xmath517 ( dashed lines ) , and fluctuating hydrodynamics with @xmath518 ( squares , averaged over 64 runs ) .",
    "error bars are comparable to the symbol size and not shown for clarity .",
    "( right panel ) same as the left panel except the density ratio is @xmath375 and the transport coefficients are adjusted according to ( [ eq : eta_r_scaling],[eq : chi_r_scaling]).,title=\"fig:\",scaledwidth=49.0% ]    by matching the profile @xmath391 between the hdmd and the fluctuating and deterministic hydrodynamic simulations at mass ratio @xmath345 and system size @xmath358 cells , we obtained estimates for the bare @xmath299 and the renormalized @xmath390 coefficient ( see fig .",
    "[ fig : spreading_64x64 ] ) .",
    "the best estimate for the bare diffusion coefficient based on this matching in the absence of filtering is @xmath519 .",
    "this compares reasonably - well to the prediction of enskog theory @xcite of @xmath520 , as well as to the measurement of the self - diffusion coefficient for a periodic system with 169 disks reported in ref .",
    "@xcite , @xmath521 ( recall that a single hydrodynamic cell in our case contains about 76 particles ) . when a 5-point filter is employed",
    "the estimate is @xmath522 and when a 9-point filter is employed @xmath523 .",
    "the estimated renormalized diffusion coefficient is much larger , @xmath524 , consistent with a rough estimate based on the simple theory presented in ref .",
    "@xcite , @xmath525 to within statistical accuracy we were not able to detect the increase in the estimated diffusion coefficients when using the larger systems of size @xmath359 cells , however , for @xmath495 it was clear that @xmath390 is reduced .",
    "it is important to emphasize that @xmath390 is not a material constant but rather depends on the details of the problem in question , in particular , the system geometry and size and boundary conditions @xcite .",
    "by contrast , @xmath299 is a constant for a given spatial discretization , and one can use the same number for different scenarios so long as the hydrodynamic cell size and the filter are kept fixed . unlike deterministic hydrodynamics , which presents an incomplete picture of diffusion , fluctuating hydrodynamics correctly accounts for the important contribution of the thermal velocity fluctuations and the roughness of the diffusive interface seen in fig . [",
    "fig : mixingillustrationmass4 ] .",
    "a.  naji , p.  j. atzberger , and frank l.  h. brown .",
    "hybrid elastic and discrete - particle approach to biomembrane dynamics with application to the mobility of curved integral membrane proteins .",
    ", 102(13):138102 , 2009 .",
    "y.  hennequin , d.  g. a.  l. aarts , j.  h. van  der wiel , g.  wegdam , j.  eggers , h.  n.  w. lekkerkerker , and d.  bonn .",
    "drop formation by thermal fluctuations at an ultralow surface tension .",
    ", 97(24):244502 , 2006 ."
  ],
  "abstract_text": [
    "<S> we formulate low mach number fluctuating hydrodynamic equations appropriate for modeling diffusive mixing in isothermal mixtures of fluids with different density and transport coefficients . </S>",
    "<S> these equations represent a coarse - graining of the microscopic dynamics of the fluid molecules in both space and time , and eliminate the fluctuations in pressure associated with the propagation of sound waves by replacing the equation of state with a local thermodynamic constraint . </S>",
    "<S> we demonstrate that the low mach number model preserves the spatio - temporal spectrum of the slower diffusive fluctuations . </S>",
    "<S> we develop a strictly conservative finite - volume spatial discretization of the low mach number fluctuating equations in both two and three dimensions and construct several explicit runge - kutta temporal integrators that strictly maintain the equation of state constraint . </S>",
    "<S> the resulting spatio - temporal discretization is second - order accurate deterministically and maintains fluctuation - dissipation balance in the linearized stochastic equations . </S>",
    "<S> we apply our algorithms to model the development of giant concentration fluctuations in the presence of concentration gradients , and investigate the validity of common simplifications such as neglecting the spatial non - homogeneity of density and transport properties . </S>",
    "<S> we perform simulations of diffusive mixing of two fluids of different densities in two dimensions and compare the results of low mach number continuum simulations to hard - disk molecular dynamics simulations . </S>",
    "<S> excellent agreement is observed between the particle and continuum simulations of giant fluctuations during time - dependent diffusive mixing .    </S>",
    "<S> # 1 # 1 # 1    # 1#1 # 1#1    # 1#1 # 1|#1|    # 1#1 # 1#1 </S>"
  ]
}