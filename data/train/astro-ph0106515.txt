{
  "article_text": [
    "a major near - term objective in the field of cosmology today is to gain a detailed measurement and statistical understanding of the anisotropies of the cosmic microwave background ( cmb ) .",
    "while the theory of primary cmb anisotropy is well - developed ( see @xcite for a review ) and we are facing a veritable flood of data from a new generation of instruments and missions , the single most limiting hurdle are the immense computational challenges one has to overcome to analyze these data@xcite .",
    "we will now outline the key problems involved .",
    "the goal is to derive two things : an optimal sky map estimate and a set of power spectrum estimates @xmath3 which , for a gaussian cmb sky are a sufficient statistic , highly informative about cosmological parameters . in this paper",
    "we will focus on the @xmath3 estimation problem , but the ideas we develop can be usefully employed for map - making as well @xcite .",
    "we assume we start from a best estimate of the sky map of the cosmic microwave background fluctuations , the monopole and dipole components have been removed , and that residual foregrounds are negligible after excision of foreground dominated regions .",
    "the analysis problem is then one of spatial covariance estimation and involves maximizing the likelihood given the data as a function of the @xmath3 . if the observed cmb anisotropy data is written as a vector @xmath4 the likelihood takes the form @xmath5}{\\sqrt{(2\\pi)^{n_{d } } \\vert ( { \\bf s}(c_\\ell)+{\\bf",
    "n } ) \\vert } } , \\label{likelihood}\\ ] ] where the signal covariance matrix @xmath6 is a function of the @xmath2 , @xmath7 is the noise covariance matrix and @xmath8 is the number of entries in the data vector @xmath4 .",
    "if @xmath9 is a general matrix , evaluating the inverse and determinant in this quantity takes @xmath10 operations .",
    "for currently available data sets @xmath11 , which is expected to grow to @xmath12 by the end of this decade .",
    "borrill @xcite presented a careful review of the computational tasks involved in solving this maximization problem in the general case , using state - of - the - art numerical methods .",
    "the conclusion is that in their present form these methods fail to be practical for forthcoming cmb data sets . given the major international effort currently underway to observe the cmb ( see , e.g.  @xcite ) , finding a solution to this problem is of paramount importance .",
    "the underlying reason for this failure is that the signal covariance matrix @xmath13 and noise covariance matrix @xmath7 are usually very differently structured .",
    "the data @xmath4 are usually represented by a vector containing the temperatures of pixels in a sky map and @xmath14 , the number of observed pixels .",
    "hence entries in @xmath6 and @xmath7 are the covariances between pairs of pixels on the celestial sphere . in pixel space",
    ", @xmath13 is full , while @xmath7 is ideally sparse ( for a well - controlled experiment ) . in spherical harmonic space we are in the opposite regime .",
    "if the cmb sky is isotropic @xmath13 would be diagonal for all - sky observations , while the form of @xmath7 depends on experimental details and observational strategy of the mission and in general could be any covariance matrix at all .",
    "therefore the quantity which enters in the likelihood @xmath15 is not sparse in any easily accessible basis .",
    "other basis sets have been suggested , such as cut sky harmonics @xcite and signal to noise eigenmodes @xcite , but changing into these more general bases takes @xmath16 operation .",
    "there have been several attempts to find approximate formulae for the likelihood .",
    "several methods are based on replacing the likelihood conditioned on the data vector with an approximate likelihood based on the pseudo-@xmath2 ( the power spectrum computed on the incomplete sky , possibly weighted by an apodizing window)@xcite .",
    "these methods are very fast , scaling as @xmath17 , unbiased , but sub - optimal to a degree which depends on the size of the survey area .",
    "a similar approach is to first compute an unbiased estimate of the correlation function in pixel space from the raw data and then transform to obtain the power spectrum in @xmath18 operations@xcite .",
    "a hierarchical approximation of the likelihood@xcite reduces the computational scaling to @xmath18 .",
    "other authors have found minimum variance quadratic estimators@xcite but the calculations still require @xmath16 operations .    there is only one known class of observational strategies in which the ( numerically ) exact maximum likelihood solution can be computed faster , namely in @xmath18 operations @xcite .",
    "this performance depends on a number of assumptions : azimuthally symmetric coverage of an azimuthally symmetric portion of the sky with an circularly symmetric beam and uncorrelated noise operations . ] . for ease of reference we will call this class _ azimuthal strategies_.    in this paper",
    "we discuss a second class of observational strategies , introduced in @xcite , for which the maximum likelihood problem can be solved exactly .",
    "this class is interesting in that it is the the first to admit fast maximum likelihood estimators which can analyze cmb data in the presence of correlated noise , non - uniform distribution of integration time , beam distortions , far side lobes , and particular types of partial sky coverage , all without needing to invoke approximations .",
    "every forthcoming cmb datasets will be affected by some subset of these issues .",
    "further interest for observational strategies in this class derives from the fact that they are natural choices from a practical point of view .",
    "evidence for this is that current and future balloon and space missions have chosen strategies which are based on scanning on interlocked rings : archeops scanned on rings , map s precessing scan generates a 3-torus , and the simplest of the proposed scanning strategies for planck generates a 2-torus .",
    "the key point is that for this class of observational strategies modeling observations in the time ordered domain simplifies the problem greatly . in section [ whytod ]",
    "we argue that several instrumental effects are modelled more easily in the time ordered data ( tod ) . to be able to formulate the likelihood problem in terms of the tod one needs to be able to compute the expected signal covariance between two samples in the tod .",
    "we achieve this using the wandelt - grski method for fast convolution on the sphere @xcite which we briefly review in section [ convolve ] .    using the results from these geometrical ideas we go on to formulate the likelihood problem for the @xmath2 on the ring torus in section [ ringtorus ] .",
    "we show that the correlation matrices have a special structure for a class of scanning strategies namely those where the tod can be thought of as being wrapped on an n - torus , the _ ring torus_. it turns out that both @xmath13 and @xmath7 are sparse .",
    "in fact , they are both block - diagonal with identical patterns of blocks ; hence @xmath19 is also block diagonal .",
    "the exact computational scaling of the evaluation of @xmath20 depends on the scanning strategy used , but if the ring torus is an 2-torus it takes only @xmath21 operations .",
    "we then present a numerical example where er apply this method to simulated data in section [ example ] .",
    "finally , we discuss the application of our ideas to real world missions and conclude with suggestions for future directions in section [ conclusions ] .",
    "in this section we will discuss features of realistic instruments and observational strategies and show that they are more easily modeled in the time ordered domain .",
    "current detectors have the feature that they add correlated noise to the signal .",
    "it appears to be a good approximation to assume that this noise is stationary and circulant .",
    "if this is the case then it has a very simple correlation structure in fourier space . but",
    "estimating the sky from the tod projects these simple correlations into very complicated noise correlations between separated pixels , which are visible as striping in the maps .",
    "for most missions , practical constraints on the scanning strategy force the available integration time to be allotted non - uniformly over the sky .",
    "this leads to coupling of the noise in spherical harmonic space , in addition to coupling due to partial sky coverage ( see paragraph d below ) .",
    "however , in the tod , integration time per sample is constant , by definition .",
    "microwaves are macroscopic , with wavelengths of order @xmath22  @xmath23 cm .",
    "hence they will diffract around macroscopic objects .",
    "this leads to distorted point spread functions and far side lobes .",
    "simulations have to convolve these asymmetric beams with an input sky with foreground signals varying over many orders of magnitude from place to place",
    ". motions of the instrument while a sample is taken leads to anisotropic smearing of the beam .",
    "analyses have to deconvolve the observations to make accurate inferences about the underlying sky .",
    "artifacts due to asymmetric beams and beam smearing affect the correlations of the signal in a raw , coadded sky map in a complicated way which depends on the scanning strategy of the instrument .",
    "if the beam is short in a particular direction , the data contains information on this short scale .",
    "deconvolution can in principle reveal additional structure .",
    "the cosmological information is most visible in spherical harmonic space . in a homogeneous and isotropic universe , where the perturbations are gaussian",
    ", the power spectrum @xmath2 completely encodes the statistical information which is present in a map of fluctuations .",
    "statistical isotropy of the fluctuations around us also implies that the spherical harmonics @xmath24 are the natural basis for representing the cmb sky .",
    "but due to astrophysical foregrounds that need to be excised from the map or partial sky coverage by the instrument this isotropy is broken in actual data sets .",
    "this introduces additional signal and noise correlations in @xmath24 space , because there is a geometrical coupling between @xmath24 of different @xmath25 and @xmath26 .      representing the data as a pixelised map on the sky is an invaluable and time - proven tool for visual analysis",
    "however , it is not without possible disadvantages either .",
    "binning samples into discrete sky pixels introduces an extra level of smoothing on the pixel scale and erases information , for example the exact distribution of sampling locations .",
    "too large pixels will degrade the signal and erase information about the beam shape ( _ cf _ issue c ) .",
    "if the distribution of samples on the sky is non - uniform choosing pixels too small will result in many missing pixels and hence irregularly shaped observation regions .",
    "there are currently no exact and fast methods that can deal with all of these issues .",
    "yet , every forthcoming cmb dataset will be affected by some subset of these issues .",
    "it is clear from a and b that the noise properties are much simpler in the tod than in a sky map .",
    "but what about the signal correlations ?",
    "what is the price of forfeiting the advantages of the sphere for representing statistically isotropic signals ? in the next section we will demonstrate that one can devise scanning strategies which break only part of the symmetries of the sphere and make the signal correlations in the tod as simple as the noise properties .",
    "recently , wandelt and grski @xcite have introduced new methods for greatly speeding up convolutions of arbitrary functions on the sphere .",
    "this reference contains a detailed description of methods which will enable future missions such as map and planck to take beam imperfections into account without resorting to approximations .",
    "the algorithm is completely general and can be applied to any kind of directional data , even tensor fields @xcite .",
    "we will now briefly review the ideas and quote the results .",
    "let us define more precisely what is meant by `` convolution on the sphere '' .",
    "mathematically , the convolution of two functions on the sphere is a function over the group of rotations so(3 ) , because one has to keep track of the full relative orientation of the beam to the sky , not just the direction it points in . for each possible relative orientation ( element of so(3 ) ) the convolution returns one value . to specify the relative orientation one can use the euler angles @xmath27 and @xmath28 , @xmath29 and @xmath30 axes by @xmath31 , @xmath32 and @xmath28 , respectively , according to the right handed screw rule . ] .",
    "the convolved signal for each beam orientation @xmath33 can then be written as @xmath34 here the integration is over all solid angles , @xmath35 is the operator of finite rotations such that @xmath36 is the rotated beam , and the asterisk denotes complex conjugation . at each point on the sphere , there is a ring of different convolution results corresponding to all relative orientations about this direction .",
    "this is a direct consequence of the fact that the beam is not assumed to be azimuthally symmetric .    if @xmath37 measures the larger of the inverse of the smallest length scale of the sky or beam , the numerical evaluation of the integral in eq .",
    "( [ eq : start ] ) takes @xmath38 operations for each tuple @xmath33 . to allow subsequent interpolation at arbitrary locations",
    "it is sufficient to discretize each euler angle into @xmath39 points and thus we have @xmath40 combinations of them . as a result , the total computational cost for evaluating the convolution using eq .",
    "( [ eq : start ] ) scales as @xmath41 .",
    "it turns out that by fourier transforming the above equation on the euler angles and judiciously factorising the rotation operator @xmath42 as described in @xcite we can reduce this scaling to @xmath43 in general .",
    "one can further reduce the scaling to @xmath40 if one is only interested in the convolution over a path which consists of a ring of rings at equal latitude around the sphere .",
    "we called such configurations _ basic scan paths _ in references @xcite .",
    "we quote here the formula for the fourier coefficients of the convolved signal on this ring torus using the notation of @xcite . in order to do",
    "so we need to make use of the angular momentum representation of the rotation operator @xmath35 .",
    "a simple explicit expression for the matrix elements @xmath44 can be given .",
    "one can define a real function @xmath45 such that @xmath46 thus the dependence of @xmath47 on the euler angles @xmath48 and @xmath49 is only in terms of complex exponentials .",
    "while explicit formulas for the @xmath50-functions exist @xcite , they are more conveniently computed numerically using their recursion properties @xcite .    if the convolved signal on the ring torus is @xmath51 with @xmath52 counting the ring number and @xmath53 the pixel number on the ring , then its fourier coefficients are @xmath54 here the @xmath55 are the spherical harmonic multipoles for the cmb sky and @xmath56 fixes the latitude of the spin axis on the sky .",
    "the quantity @xmath57 is just the rotation of the beam multipoles @xmath58 for an arbitrary beam by @xmath59 , the opening angle of the scan circle .",
    "@xmath60 can be precomputed .",
    "counting indices in eq .",
    "( [ eq : specialresult ] ) confirms that computing the convolution along a basic scan path takes only @xmath40 operations .",
    "using the results from the previous section we can now write down a statistical model in terms of the likelihood of the @xmath2 and experimental parameters given the time - ordered data .",
    "we will first derive the signal - correlation matrix as a function of the @xmath2 and then go on to derive the noise correlation as a function of instrumental parameters ( like the shape of the noise power spectrum in the tod ) and the scanning strategy ( in this case the dimensions and position of the basic scan path ) .      what we are interested in are the correlation properties of the signal on the ring torus , eq .",
    "( [ eq : specialresult ] ) .",
    "we can now easily compute the correlation matrix @xmath61 where @xmath62 denotes the kronecker delta , defined as @xmath63 the boxed kronecker delta shows that the correlation matrix in fourier space on the ring torus is _ block diagonal_.      we start by assuming that we can model the noise in the time ordered domain as a stationary gaussian process whose fourier components @xmath64 have the property @xmath65    in the following we will allow for the complication that the scanning strategy involves integrating repeatedly on a fixed ring then the signal remains the same for each scan of that ring .",
    "one can just co - add all scans over the same ring without losing information .    to be specific , if we define @xmath66 to be the number of pixels per ring , @xmath67 the number of times the satellite spins while observing a fixed ring , and @xmath68 to be the number of rings for a one - year mission , we can write @xmath69 for the number of samples in the tod . in the following",
    "we will choose @xmath70 for simplicity , though this is not required by the formalism and can be generalised trivially .    to model the noise on the coadded rings , we define @xmath71 to be the noise temperature in the @xmath53th pixel in the @xmath52th ring , such that @xmath72 here @xmath73 is the _ co - adding matrix _",
    ", defined in eq .",
    "( [ coadd ] ) .",
    "it encodes the scanning strategy by associating a given pixel in the ring set with indices @xmath52 and @xmath53 with a set of samples in the tod",
    ".    then we can show ( see appendix ) that the covariance matrix of the fourier components of the co - added noise on the rings is @xmath74 where @xmath75 is defined in eq .",
    "( [ first ] ) .",
    "the boxed kronecker-@xmath76 is telling us that the noise covariance is block diagonal in the ring fourier basis .",
    "we just showed that by choosing the scanning strategy such that the tod can be wrapped ( co - added ) onto a 2-torus one can find a basis in which both noise and signal are block diagonal and hence sparse .",
    "what is more , the data can be easily transformed into this basis just by computing the fast fourier transform ( fft ) of the co - added tod .    the results eq .",
    "( [ eq : scor ] ) and eq .",
    "( [ noisecovariance ] ) warrant some comments .",
    "we can understand them in terms of symmetries .",
    "the ring torus exhibits a spatio - temporal symmetry : time proceeds linearly around the torus , in the same direction as the azimuthal angle @xmath77 ( _ cf . _  fig .",
    "( [ fig : toruscoords ] ) ) .",
    "wrapping the tod on the torus breaks the translation invariance of the noise in the tod .",
    "similarly , projecting the signal from the sphere onto the torus breaks the isotropy of the signal on the sphere . but these original symmetries manifest themselves as ring ",
    "stationarity of the noise ( correlations between rings only depend on the distance between them ) and ring ",
    "stationarity/``partial isotropy '' of the signal ( only in the azimuthal @xmath77 direction on the torus ) .",
    "these in turn express themselves as a simplified correlation structure in fourier space .",
    "we can therefore see that the key feature which leads to the simplicity of the correlation matrices is the repetitive structure of the scanning in the @xmath77 direction .",
    "therefore it is plain that these methods can be generalised to ring tori of arbitrary cross section , for example where the scanning rings are ellipses , without losing the computational scaling performance , albeit with more cumbersome formulae which we will not produce here in detail .",
    "this would also enable us to remove regions where foregrounds dominate if that involved removing the same part of every ring in the torus , because this does not spoil the ring ",
    "stationarity .    from following the discussion in @xcite",
    "we can easily see how the results eq .",
    "( [ eq : scor ] ) and eq .",
    "( [ noisecovariance ] ) generalize to precessing scans . for example rewriting eq .",
    "( 8) in @xcite as @xmath78 and substituting for @xmath79 from eq .",
    "( [ eq : precompute ] ) we obtain the signal part of the tod for a precessing experiment where the spin axis moves around the sphere at co - latitude @xmath56 and precesses about it with amplitude @xmath80 .",
    "we see that this tod can be wrapped on a 3-torus .",
    "computing the signal correlation matrix in fourier space on this 3-torus @xmath81 we find that it is again block diagonal .",
    "however , the size of blocks has now increased .",
    "the computational performance in this case depends on the details of the scanning strategy , but in general will lead to a prefactor which increases with the precession angle @xmath80 .",
    "for completeness we mention that by introducing further factors of the rotation operator this formalism can be generalised to n - tori with @xmath82 , but this would appear to give rise to impractical scanning strategies .",
    "one can write down the likelihood eq .",
    "( [ likelihood ] ) on the ring torus by simply substituting @xmath83    due to the block diagonality , the inverse and determinant in the eq .",
    "( [ likelihood ] ) only take @xmath84 operations to evaluate .",
    "the gradient is similarly easy to evaluate @xmath85 which only takes @xmath86 operations to compute for each component .      to determine confidence regions for the estimates one could explore the likelihood surface around the maximum .",
    "if the number of estimated band powers is @xmath87 , using this recipe to evaluate the diagonal elements of the covariance matrix of the estimates would scale as @xmath88 , and the full covariance @xmath89 .",
    "this is more like @xmath90 or @xmath91 depending on the coarseness of the binning .",
    "but one can improve on this , because evaluating the gradient of the likelihood also takes just @xmath84 operations on the ring torus .",
    "so one can numerically differentiate the gradient with respect to the @xmath92-th band power estimate , to obtain the i - th row of the covariance matrix .",
    "the full covariance matrix can then be computed in @xmath88 operations .",
    "that s at most @xmath90 but given that the @xmath2 are smooth in most models @xmath93 may suffice , especially for less than full sky coverage , where adjacent @xmath2 estimates become strongly coupled .",
    "to test the method , we used a standard cdm power spectrum and simulated a realization of spherical harmonic multipoles @xmath94 up to @xmath95 .",
    "we used the wandelt - grski method for fast convolution to generate @xmath96 scanning rings with @xmath97 radius @xmath98 samples each .",
    "the spin axis was offset from the north pole by @xmath97 .",
    "this scanning pattern is shown in fig .",
    "( [ fig : toruscoords]a ) .",
    "the data covers a polar cap on the sphere of diameter 20 degrees . for simplicity",
    "we used a symmetric gaussian beam with full width at half maximum of @xmath99  however this simplification is not forced by the method which allows using any beam pattern .    for the noise power spectrum we use a simple model motivated by measurements from realistic receivers  but",
    "again any power spectrum could be used here .",
    "we adopot the functional form used by @xcite @xmath100,\\qquad0<\\alpha\\leq2 , \\label{pofk}\\ ] ] where the first term corresponds to white noise with variance per pixel of @xmath101 and the second to @xmath102type noise .",
    "we show this power spectrum in fig .",
    "( [ fig : noisepower ] ) . for our simulations",
    "we regularize this form at small frequency by introducing a small additive constant corresponding to a tenth of the smallest representable frequency in the denominator of the @xmath102 term .",
    "hence our noise simulation is not constrained to have zero mean but contains a random offset .",
    "we generated a realisation of noise with @xmath103 , @xmath104 and @xmath105 ( expressed in terms of the nyquist frequency @xmath106 ) and added it to the ring set .",
    "the value of @xmath107 was chosen to give @xmath108 at @xmath109 for our simulations .",
    "we have @xmath96 rings with @xmath98 pixels in each ring .",
    "for simplicity of implementation each ring was scanned a single time , @xmath110 , giving a total number of @xmath111 pixels , a similar number of pixels to the boomerang experiment .    in fig .",
    "( [ fig : ringsetnn ] ) we show the ringset with and in fig .",
    "( [ fig : ringsetn ] ) without noise using the representation shown in fig .",
    "( [ fig : toruscoords]c ) . on the plots , a line from the top to",
    "the bottom describes one ring , in this way the rings are put next to each other from left ro right . the line from left to right in the middle , with the same value , is the north pole where all rings meet .",
    "we see clearly the stripes from the correlated noise .    instead of estimating @xmath2 , we estimate @xmath112 given by , @xmath113 where @xmath114 is for a @xmath99 fwhm beam .",
    "we divide @xmath112 in @xmath115 flat bins @xmath116 with @xmath117 multipoles in each .",
    "the fourier transformed signal correlation matrix can be calculated in two ways .",
    "one might evaluate it directly in fourier space with equation ( [ eq : scor ] ) , or one could first evaluate it in pixel space and then fourier transform it using fft . in our test example",
    "we have chosen the latter .",
    "the formula for the correlation matrix in pixel space is in our case @xmath118 where @xmath119 is the angular distance between the two points @xmath120 and @xmath121 on the sphere and the sum over @xmath25 is taken over all @xmath25 values in the particular bin @xmath122 .",
    "all @xmath119 angles are precomputed .",
    "the derivative with respect to a certain bin is then simply , @xmath123    in figure ( [ fig : est ] ) we have plotted the result from likelihood estimation . to find this estimate we initialised the iterative conjugate gradient scheme @xcite with a flat power spectrum @xmath124constant . the minimum of the likelihood was found after about 30 function and derivative evaluation taking about 2 hours each on a single processor on a 500 mhz dec alpha work station .",
    "if we had started the likelihood minimisation with a better inital guess for the power spectrum ( which could be obtained using one of the @xmath125 methods @xcite ) the number of likelihood evaluations could be significantly reduced .",
    "the solid line shows the input average power spectrum used and the crosses are the estimates with error bars .",
    "the errorbars approximate a 95% confidence region determined by finding the interval of the estimate where the log - likelihood is reduced by less than 2 compared to its maximum value . we compared these confidence regions with the errors bars determined from the observed fisher matrix by finding the numerical second derivative of the loglikelihood",
    ". the square root of the diagonal components of its inverse yields errorbars which were consistent with the ones we obtained from the likelihood contours .",
    "note that we did not subtract lower order modes from the sky patch that we simulated ( though we assumed that the map was free of non - cosmological monopole and dipole modes ) .",
    "as we mentioned , the noise was also not constrained to average to zero .",
    "the presence of lower order modes was correctly modelled and handled by the algorithm .",
    "in this paper we described the properties of the class of observational stratgies where the instrument scans on rings which can be arranged into an n - torus . using these properties we constructed for the first time an exact formulation of the maximum likelihood problem of power spectrum analysis on the sphere which can deal with correlated noise , realistic beams , partial sky coverage , and non - uniform noise with a computational scaling of @xmath84 @xmath126 .",
    "this is a significant advance over other available exact methods with the same scaling , all of which assume white noise and azimuthally symmetric beams , amongst other assumptions .",
    "how realistically can we expect these methods to be useful for real cmb missions ?",
    "real observations obviously never coincide exactly with any simple mathematical model .",
    "this was also true for the previously known solvable class of strategies of azimuthal sky coverage , symmetric beams and uncorrelated noise .",
    "but the fact that the likelihood simplifies in this idealised situation , defined one of the design goals for the map satellite , namely to ensure that the noise be uncorrelated between samples .",
    "this allowed a fast maximum likelihood power spectrum estimation method to be developed for map @xcite which achieves success by employing iterative numerical schemes taking advantage of the fact that the data nearly satisfy the assumptions of the exactly solvable case and thus improve convergence .",
    "perturbation theory is powerful but only if exact solutions are known that are close to the real thing .    in our case , even though the methods we describe can deal with many features of actual cmb missions , there remain discrepancies .",
    "we have not shown ( except for our discussion in section [ gen ] ) how to deal with small areas where foregrounds dominate and defy removal , such as bright dust emission from the galactic plane , or certain point sources .",
    "also , irregularities in the scanning strategy will somewhat spoil the symmetry of spatial correlations in the signal and temporal correlations in the noise which the ring torus exploits .",
    "we therefore advocate a similar approach to the one which was used successfully in @xcite , namely to use exact inverses , computed using the methods we presented in this paper as preconditioners to speed up conjugate gradient methods for computing @xmath127 for more general cases , e.g. galactic cuts , point sources , imperfect scanning and non - stationarity of the noise .",
    "other nuisance factors , such as discrete events like cosmic ray hits and short telemetry losses can plausibly be dealt with in established ways , namely by filling in the data stream with a constrained realisation based on the properties of the observed data .    even neglecting the computational advantages of ring torus methods",
    "there are other advantages to analysing time ordered data directly .",
    "first , this approach does not rely on map - making on the sphere for the purposes of power spectrum estimation .",
    "not having to base @xmath2 estimation on maps helps to avoid systematic effects or signal degradation introduced by previous analysis steps , for example a heuristic de - striping tool . on the ring torus ,",
    "one fully models the striping due to correlated noise and hence does not rely on heuristic methods .",
    "while the sky map may not necessarily be the best starting point for the purposes of @xmath2 estimation , one should of course make the best map one possibly can .",
    "maps are indispensable for the visualization of the data and identifying systematic errors . also ,",
    "recently developed map based methods for estimating the noise properties of the observations from the data itself @xcite can be used to provide the necessary noise model input to our methods ( such as @xmath128 , eq .",
    "( [ pofk ] ) ) .",
    "in fact the geometrical ideas we discuss in this paper may well be useful for map making itself .",
    "reference @xcite shows how the ring torus speeds up iterative methods for deconvolving a map with asymmetric beams .",
    "the block diagonal noise correlations on the torus mean that one can use the same geometrical ideas for solving the map making equations in the presence of noise .",
    "in fact both signal and noise covariances are sparse in this basis , hence this method can be used to quickly wiener filter the data on the ring torus once the @xmath2 are known to optimally estimate the cmb fluctuations on the torus",
    ". these can then be visualized by projecting them onto a sky map .    under the stated assumptions we have shown that the power spectrum analysis problem simplifies greatly when it is considered in the domain of co - added time - ordered data which has the geometry of a torus .",
    "we indicate how to derive extensions of the formulae we presented here to more general scanning strategies ( e.g. a precessing scan , such as map s or another proposal for planck ) . in this case",
    "the efficiency depends on the size of the extra dimensions which the torus acquires .",
    "however , even as they stand , the methods and ideas we describe represent a new theoretical tool which allows evaluating the impact of cmb mission design choices in much more detail than previously feasible . in order to achieve the best possible estimates of the cmb power spectrum , or certain cosmological parameters",
    ", one can ask whether it is more important to reduce the amount of correlated noise from the receiver , to ensure accurate pointing , to increase sky coverage , change the survey geometry , or to control the beam shape and far side lobes ?",
    "we are investigating quantitative answers to these questions .",
    "we would like to thank a.  j.  banday , a.  challinor , k.  m.  grski , e.  hivon , d.  mortlock and members of the planck collaboration for discussions .",
    "we acknowledge the use of the healpix @xcite and cmbfast @xcite packages in preparing this publication .",
    "bdw is supported by the nasa map / midex program .",
    "fkh is supported by a grant from the norwegian research council .",
    "the co - adding matrix can be written as @xmath129 here @xmath130 is defined to be the largest integer smaller than @xmath131 .",
    "the previous equations simplify if we write @xmath132 as @xmath133 with @xmath134 $ ] , @xmath135 $ ] , @xmath136 $ ] . now using that @xmath137 we find that the noise covariance on the ring set is @xmath138 note that @xmath139 is periodic with period @xmath68 in its first entry ; letting @xmath140 we have @xmath141    finally we fourier transform to arrive at the covariance of the fourier components of the the co - added noise on the rings @xmath142 where we used ( [ circulant ] ) to simplify the sums over @xmath143 and to obtain the boxed kronecker-@xmath76 telling us that the noise covariance is block diagonal in the ring fourier basis .    for practical purposes one would first compute the fourier transfrom in ( [ first ] ) using an fft taking @xmath144 operations .",
    "then the resulting array can be interpolated at @xmath145 positions to obtain the independent components of @xmath139 .",
    "finally we have a three - dimensional fft left to evaluate ( [ noisecovariance ] ) , which requires @xmath146 operations .",
    "b. d. wandelt,_advanced methods for cosmic microwave background data analysis : the big @xmath147 and how to beat it _",
    ", astro - ph/0012416 , in proceedings of mpa / eso / mpe joint conference `` mining the sky '' , garching bei muenchen , a.j .",
    "_ ( eds ) .",
    "( 2000 )          d.  a.  varshalovich , a.  n.  moskalev , and v.  k.  khersonskii , _ quantum theory of angular momentum _ ( singapore : world scientific , 1988 ) ; d.  m.  brink and g.  r.  satchler , _ angular momentum _",
    "( clarendon press , oxford , 1975 ) ."
  ],
  "abstract_text": [
    "<S> we describe a class of observational strategies for probing the anisotropies in the cosmic microwave background ( cmb ) where the instrument scans on rings which can be combined into an n - torus , the _ ring torus_. this class has the remarkable property that it allows exact maximum likelihood power spectrum estimation in of order @xmath0 operations ( if the size of the data set is @xmath1 ) under circumstances which would previously have made this analysis intractable : correlated receiver noise , arbitrary asymmetric beam shapes and far side lobes , non - uniform distribution of integration time on the sky and partial sky coverage . </S>",
    "<S> this ease of computation gives us an important theoretical tool for understanding the impact of instrumental effects on cmb observables and hence for the design and analysis of the cmb observations of the future . </S>",
    "<S> there are members of this class which closely approximate the map and planck satellite missions . </S>",
    "<S> we present a numerical example where we apply our ring torus methods to a simulated data set from a cmb mission covering a 20 degree patch on the sky to compute the maximum likelihood estimate of the power spectrum @xmath2 with unprecedented efficiency . </S>"
  ]
}