{
  "article_text": [
    "ebex @xcite is a balloon - borne telescope designed to measure the polarization of the cosmic microwave background ( cmb ) .",
    "the 6,000 lb instrument collects data while suspended from a @xmath1 cubic meter stratospheric balloon at an altitude of @xmath0 35 km that circumnavigates antarctica .",
    "this paper describes the pointing system that was designed to meet the attitude requirements of the ebex telescope , both for in - flight and post - flight attitude determination .",
    "it focuses on the steps taken to meet the post - flight requirements given the timescales between star camera images .",
    "section [ section : the instrument ] describes the instrument and the attitude control system .",
    "section [ section : pointing reconstruction ] describes the software developed to reconstruct the attitude .",
    "section [ section : systematics ] details the systematic errors in the system and their effect on the pointing reconstruction .",
    "section [ section : simulation_pipeline ] describes the simulation pipeline developed to fine tune the pointing reconstruction software and to assess how well systematic errors needed to be constrained .",
    "section [ section : flight ] describes the 2012/2013 antarctic flight and section [ section : results ] evaluates the performance of the reconstruction software both for simulations and for flight data .",
    "the requirements on the accuracy of the attitude are different for in - flight real - time pointing , and for post - flight reconstructed pointing used to make cmb maps .",
    "the real - time pointing requirement is set by the need to ensure that detectors are scanning the desired part of the sky . for every detector sample , an accuracy of @xmath0 0.5is required , such that the error is small compared to the 6ebex focal plane .",
    "the requirement on the accuracy of post - flight reconstructed pointing is set by the ebex science goals .",
    "the requirement originally exists in the map domain : the average of all pointing errors inside a given pixel of size 2 should be less than approximatively 10 `` .",
    "therefore the requirement on the pointing in the time domain is dependent on the scan strategy and the number of repeated hits per pixel . to generalize our results",
    ", we use our known scan pattern to transform this requirement in terms of a requirement on the error over a 40 second azimuth throw .",
    "details of this transformation can be found in appendix [ appendix : transform requirements ] .",
    "we define the error on a throw as the rms of the difference between the true pointing and the reconstructed pointing for the set of points between two star camera images . for the ebex long duration ( ld )",
    "flight scan strategy , the rms on a 40 second throw needs to be smaller than 54 '' .",
    "it is also interesting to compare any result to the error coming from integrating pure gyroscope rate white noise on a 40 second throw , which is 11 \" ( see appendix [ appendix : white_noise_rms ] for details ) .      the ebex instrument , shown in figure [ fig : telescope ] , is a microwave telescope mounted in an aluminium structure called the gondola .",
    "the gondola hangs from an aluminium triangle spreader bar through four synthetic ropes .",
    "the triangle hangs from a rotator motor ( the pivot ) and a universal joint , which at float connect to the flight train and balloon .",
    "the azimuth motion is powered through the pivot motor .",
    "a motorized reaction wheel on the gondola provides fine control of the azimuth motion .",
    "the gondola consists of an inner frame and an outer frame connecting at the trunnion bearing assembly .",
    "the inner frame can move in the elevation direction through the elevation actuator .",
    "the attitude control system ( acs ) of the gondola was inherited from blast @xcite and adapted for ebex .",
    "it performs two tasks .",
    "pointing sensors mounted on the gondola collect attitude information which is transmitted to the flight control program ( fcp ) .",
    "fcp uses sensor information to estimate the gondola s attitude , which is then used by the acs electronics to send currents to the azimuth and elevation motors to orient the telescope according to a pre - designed scan strategy .",
    "the current sent to the motors is governed by pi loops based on position or velocity , and the p and i values need to be tuned in flight to ensure optimal motion of the telescope .",
    "the fcp control loop runs at 100.16 hz and sensor data is recorded on disk at the same frequency .",
    "ebex has two star cameras , mounted on either side of the inner frame and roughly aligned with the telescope beam , as shown in figure [ fig : telescope ] .",
    "they operate by taking pictures of the stars and comparing the images to known star catalogs .",
    "this process is referred to as finding a pointing solution .",
    "each star camera consists of a telephoto lens , a ccd and a computer mounted in a rigid assembly inside a pressure vessel , as shown in figure [ fig : other sensors ] .",
    "the computer runs the star tracking attitude reconstruction software ( stars ) @xcite , a platform - independent software developed for ebex in c++ that captures the images , finds the bright spots in the image , matches their pattern to a known catalog of stars and communicates with fcp .",
    "the precision of the star cameras is mainly determined by the ccd and the lens .",
    "each ebex star camera contains a 200 mm f/1.8 lens and a ccd with 1536x1024 9 @xmath2 pixels .",
    "the camera has a fwhm of roughly 9 `` , which is also the approximate size of a pixel .",
    "the atmospheric brightness at 35 km altitude requires the star cameras to take 300 ms exposures in order to see stars .",
    "given the necessary integration time , images must be taken at velocities under 2/s to avoid motion - blur .",
    "the pointing solutions have 1.5 '' accuracy in displacement angle on the sky , and 48 \" accuracy in rotation around the image center . a detailed review of the star cameras design and in - flight performance can be found in the chapman et al .",
    "companion paper @xcite .",
    "ebex has two redundant sets of three orthogonal fiber optic gyroscopes .",
    "each gyroscope measures the rate of angular rotation around its axis .",
    "each set of three gyroscopes is mounted inside an aluminium box such that they form a nearly orthogonal frame .",
    "box a is mounted near star camera 1 , as shown in figure [ fig : telescope ] .",
    "box b , not visible in the figure , is mounted near the secondary mirror on the inner frame .",
    "each gyroscope outputs a digital signal at 1000 hz which is read out by an on - board digital signal processing ( dsp ) unit .",
    "the data is de - spiked and passed through a stage 4 box - car iir filter , and written to disk at 100.16 hz .",
    "the filter introduces a measured 33 ms time lag that is accounted for in the pointing reconstruction . to reconstruct the gondola attitude , the gyroscopes angular rates are integrated in between star camera readings , taken approximatively every 40 seconds .",
    "balloon - borne instruments need reliable , redundant pointing systems both because minimal intervention is possible once the instrument is at float and also because the temperature , pressure and radiation environment at float is very different from that on the ground , making end - to - end testing conditions difficult to reproduce before the flight . for this reason ebex",
    "was equipped with redundant primary sensors ( two star cameras and two sets of orthogonal gyroscopes ) , but also with an array of less accurate but simpler , more reliable sensors : magnetometers , sun sensors , clinometers , two differential gps , and an elevation encoder .",
    "these sensors can not provide the accuracy required for post - flight pointing reconstruction , but can provide real - time attitude both to provide a pointing guess to the star camera and in the eventuality that the star cameras can not solve images in real - time .",
    "the real - time attitude of the gondola is computed in the following manner .",
    "fcp keeps a time stream of the attitude of each sensor . for each sensor the attitude in between new readings is estimated by integrating the gyroscope rates .",
    "when a new sensor reading is available , it is averaged with the integrated attitude time stream . then to compute the gondola s attitude , at every sample in time , a weighted average of functional sensors attitude is performed .",
    "the main source of error for in - flight pointing is the proper calibration of each sensor offset to the star cameras ( and through the star cameras to the microwave beam ) . to provide an estimate of these sensor offsets before flight , an outdoor calibration of all sensors to the star cameras",
    "was done in antarctica . during the test , the star cameras provided solutions using the few stars bright enough to be visible from the ground during the antarctic summer .",
    "all sensor offsets are re - computed in flight as soon as a star camera solution is available .",
    "figure [ fig : other sensors ] lists all sensors and plots their in - flight accuracy given the calibration performed _ pre - flight_. the pre - flight calibration is used to show what would be the performance of the sensors in providing the star camera with a pointing guess and in providing real - time pointing before the star cameras solved . during the ebex 2012/2013 ld flight , the star cameras provided pointing solutions in real - time and thus were used as our primary sensors both for real - time and post - flight pointing .",
    "the rest of our analysis will thus focus on star cameras and gyroscopes only .",
    "the pointing reconstruction software takes as inputs star camera solutions and gyroscope rates , and outputs the telescope attitude . the attitude between two star camera images",
    "is reconstructed by integrating the gyroscope angular velocities .",
    "the output pointing consists of a time stream where each sample provides the attitude information to orient the telescope in a given reference frame , chosen here to be the equatorial reference frame .",
    "quaternions , euler angles and rotation matrices provide equivalent frameworks to describe the orientation of the gondola at every time step . in this paper",
    "we will use euler angles , using conventions such that the first rotation corresponds to the equatorial right ascension ( ra ) angle , the second rotation corresponds to the equatorial declination ( dec ) angle , and the third rotation around the star camera beam corresponds to roll .",
    "the pointing reconstruction software thus outputs ra , dec and roll angles for every time step .",
    "we adapted an unscented kalman filter ( ukf ) @xcite to c++ to determine the pointing for ebex given the star camera and gyroscope measurements .",
    "kalman filters have been extensively described in the literature @xcite to estimate the state of linear systems given a set of noisy measurements .",
    "the algorithm works in a two step process . in the `` prediction '' step",
    ", the filter produces an estimate of the next attitude and its covariance given the current attitude and by integrating the gyroscopes , using equation [ eq : propagation ] :    @xmath3    where @xmath4 , @xmath5 and @xmath6 stand for cosine , sine and tangent , @xmath7 , @xmath8 , @xmath9 are the attitude euler angles for dec , roll and ra , and @xmath10 , @xmath11 , @xmath12 are the gyroscope rates .",
    "r and o , called the rotation and the orthogonalization matrix , represent the transformation necessary to rotate each gyroscope into one of the star camera frame axes .",
    "they are detailed in the next subsection .",
    "the variance of the error on the attitude grows as subsequent gyroscope samples are integrated between star camera measurements .",
    "the system of equations to integrate the euler angles given the gyroscope rates is highly non - linear , and it is thus necessary to use a generalization of the kalman filter in order to propagate the attitude and the covariance .",
    "the ukf provides a good balance between extended kalman filters , which linearize the system only to first order , and full monte carlo simulations , which take significantly longer to run . to propagate the attitude and the covariance , the ukf uses a deterministic sampling technique known as the unscented transform @xcite to pick a minimal set of sampling points around the current attitude .",
    "these points are propagated through the full non linear equations . the next attitude and covariance",
    "are computed using the mean and covariance of the propagated points .",
    "when a new star camera solution is available , the `` update '' step is performed .",
    "the estimated attitude is updated using a weighed average of the integrated attitude and the new star camera reading . when the star camera solutions are good , this weighted solution is dominated by the star camera measurement . the error on the attitude drops , and the process",
    "is repeated on the next throw .",
    "section [ section : systematics ] will show that a constant gyroscope rate offset must be fit in order for the rms of the reconstructed pointing to satisfy the requirements .",
    "finding this additional parameter is possible because every new star camera reading provides an accurate measurement of the current attitude .",
    "the attitude integrated from the previous star camera reading can be compared to the new reading , and information on the gyroscope rate offset can be deduced by comparing those two measurements , since the integrated angle is changed when the rate offset changes .",
    "the offset is fitted for every throw and every gyroscope in this manner .",
    "this is achieved by modifying the ukf state ( called up to now the attitude because it was holding only the euler angles ) to be a six parameter vector including three euler angles as well as three offset values , and updating the ukf equations accordingly .",
    "at every time step , the ukf provides an estimate of the six parameter state , as well as an estimate of the 6x6 covariance matrix of the state .",
    "the filter is run both forward and backwards in time .",
    "the forward and backward solutions are weighted together to form the average solution , for which the uncertainty is largest mid - throw ( between star camera readings ) . the weights used to do the average are the inverse of the forward and backward covariances output by the ukf .",
    "to propagate the star camera attitude using the gyroscope measurements , the transformation matrix between the frame defined by the three gyroscopes in the box and the star camera frame must be known .",
    "an uncertainty on the position of any gyroscope axis will translate into an uncertainty in the reconstructed pointing . by design ,",
    "the gyroscopes are mounted in a nearly orthogonal frame .",
    "the transformation matrix is broken up into an orthogonalization matrix o , which moves the gyroscopes true axes from the nearly orthogonal frame to a truly orthogonal frame , and a rotation matrix r , which rotates this orthogonal frame into the star camera frame .",
    "the orthogonalization matrix depends on three misalignment angles , and the rotation matrix on three rotation angles .",
    "details on conventions used can be found in appendix [ appendix : rot and misal ] .",
    "these parameters also need to be fitted by the reconstruction software . unlike the gyroscope offset ,",
    "these parameters are assumed to be fixed throughout the flight .",
    "the pointing reconstruction software can attempt to find those six parameters by minimizing the difference between the integrated attitude and the next star camera reading .",
    "this procedure has some degeneracy with finding the gyroscope bias offset which is broken by rotating around all three gyroscopes during the gyroscope 1/f noise stability timescale . because those parameters are fixed throughout the flight , a different method than described for the gyroscope offsets is used . instead",
    ", the ukf is modified to output the differences between the star camera readings and the integrated attitude during the flight .",
    "note that the difference used is the difference between the star camera reading and the forward integrated solution before the new star camera reading is incorporated in the solution , in order to provide a non - biased estimate .",
    "the differences computed with the backward integrated solutions are also used .",
    "this set of differences is used as a metric to find the correct misalignment and rotation angles . a non - linear least square optimizer ( levenberg - marquardt )",
    "is used on this metric output by the ukf for the whole dataset .",
    "the parameters varied in the optimizer are the six rotation and misalignment angles .",
    "the correct step size in the parameter space has to be tuned for the optimizer to converge .",
    "the ukf is run on data from the entire flight many times through the non - linear least square optimizer .",
    "the initial guess to the optimizer , the parameter space allowed , as well as the results of the reconstruction will be detailed in section [ section : results ] .",
    "the ebex scan strategy enables star camera readings only approximatively every 40 seconds .",
    "the designed scan strategy is to raster scan a patch of sky of 20x20 , performing back and forth azimuth throws at a constant elevation before stepping in elevation .",
    "the 20azimuth throws are scanned with a constant azimuth velocity of 0.5/s . as discussed previously ,",
    "star camera images must be taken at velocities smaller than 2/s , which only happens at scan turnarounds , every 40 seconds . between",
    "star camera readings any non - ideality in the star - camera - gyroscope system integrates into a growing pointing error .",
    "though this pointing system is common on pointed balloon - borne instruments , the amount of time between star camera images on ebex requires a refined assessment of the systematic errors such as gyroscope noise , gyroscope gain , or misalignment between the star camera and each gyroscope . in the following subsections",
    ", we list the major systematic errors for our system and we characterize the effect of each error on the pointing reconstruction error . if relevant , we detail the steps taken in the design of the system or the pointing reconstruction software to minimize the magnitude of the systematic error .",
    "the simulation pipeline detailed in section [ section : simulation_pipeline ] was written to simulate the relevant systematic effects and ensure that the reconstructed pointing satisfies the ebex requirement .      to assess the effect of gyroscope noise on the reconstructed pointing , we break up the noise into a white noise component and a slow varying drift or bias component .",
    "it is common to assess the noise on different timescales using the allan variance method @xcite , which determines the spread in the consecutive means of many chunks of data , as a function of the chunk length @xmath13 .",
    "the allan variance and the white noise specification for each ebex gyroscope are shown in figure [ fig : allan_variance ] .",
    "the uncertainty on the reconstructed attitude coming from integrating gyroscope white noise grows like @xmath14 , where n is the number of integrated samples .",
    "the rms on the reconstructed attitude of a 40 second throw coming from the ebex gyroscope rate white noise is @xmath0 11 `` , as is detailed in appendix [ appendix : white_noise_rms ] .",
    "this is well under our requirement of rms = 54 '' , which is why those gyroscopes were chosen .",
    "we then evaluate the effect of bias on the reconstructed attitude .",
    "figure [ fig : allan_variance ] shows that the bias is constant on timescales of @xmath15 200 seconds . thus between two star camera readings , the bias will appear as a constant systematic offset in the gyroscope rate reading .",
    "the gyroscope specifications state that the bias can have values up to 20``/s . between two star camera readings , a constant offset of 20''/s in the gyroscope rate will lead to an error in the reconstructed pointing that grows linearly with the number of integrated samples and produces an rms of 516 \" , which is well above the ebex requirement .",
    "the pointing reconstruction software therefore needs to fit the bias offset .",
    "details on how this is done were given in section [ section : pointing reconstruction ] .",
    ", the rms of the difference in the mean of consecutive chunks is plotted .",
    "the white noise level , measured by the offset of the -1/2 slope on short timescales , is given for each gyroscope and can be compared to the 40\" / s specification , plotted in black .",
    "the curves lowest point indicate the timescales on which the bias varies , roughly 200 seconds.,width=312 ]      six angles are required to rotate three gyroscopes into the star camera frame axis : three angles in the orthogonalization matrix o and three angles in the rotation matrix r. an uncertainty on one of the angles translates into an uncertainty on the reconstructed pointing .",
    "it is not trivial to map how an uncertainty on an angle translates into an error on the reconstructed pointing , because the mapping is dependant on the actual motion of the telescope .",
    "however we can and do simulate it . the error on a reconstructed pointing sample is proportional to the error in the angle orientation , and to the angular distance traveled while integrating the gyroscopes .",
    "a rough estimate is that an error of @xmath04.5 on the orientation of a gyroscope translates into an error of 54 \" in the reconstructed pointing for a 40 second throw . to constrain the misalignment angles ,",
    "a measurement was made by rotating the gyroscope box on a rotary table on each of the orthogonal box s side .",
    "the ratio between two velocities gives the alignment between two gyroscopes if the box is perfectly orthogonal .",
    "the alignment angles were measured to @xmath00.3 precision . to ensure the boxes",
    "are orthogonal , they are precision machined such that outside surfaces are mutually parallel and orthogonal with a surface precision of 5 mils , corresponding to a 4.9 angle uncertainty . the misalignment angles are constrained to @xmath05.2. this is larger than the limit allowed by our pointing requirement and so we need to adapt the reconstruction software to fit these angles .",
    "furthermore these measurements constrain the orthogonalization matrix o , but not the rotation matrix r which changes every time the star camera or the gyroscope box are mounted on the gondola .",
    "the rotation matrix r must be reconstructed using flight data .",
    "the procedure to find all six angles with the reconstruction software was detailed in section [ section : pointing reconstruction ] .",
    "the measurement of the misalignment angles is used in the least squared optimizer to reduce the parameter space of possible angles , ensuring that the optimizer converges .",
    "the simulations detailed in section [ section : simulation_pipeline ] show that the reconstruction software finds these angles to sufficient accuracy such that the reconstructed pointing satisfies the ebex requirement .",
    "another possible systematic effect is the rotation matrix r slightly changing with elevation . comparing the measured star camera elevation with the encoder situated on the trunnion bearing of the inner frame",
    ", it was shown that the two measurements spread about an arcminute when the gondola was moved in elevation over its entire 50elevation range . the gyroscope box",
    "a and the star camera 1 being next to each other on the inner frame should however be minimally affected by this effect .",
    "the manufacturer s specifications on the gyroscope scale factors are calculated for the entire + /-",
    "350/s rate range , and are not constraining enough for the regime in which we use the gyroscopes ( + /-",
    "therefore the scale factor of each gyroscope is re - measured by aligning it with the gondola s elevation axis and moving the gondola in elevation at various velocities .",
    "the scale factor is found by calculating the best fit line between the encoder and the gyroscope velocities .",
    "scale factors found range between gyroscopes from 1.001 to 1.005 with a measured uncertainty of 7e-5 .",
    "the measured value for each gyroscope is used in the pointing reconstruction .",
    "the uncertainties on the measurements of the scale factor are used in section [ section : simulation_pipeline ] to simulate the effect of errors of this magnitude in order to determine whether or not this characterization is sufficient for the pointing reconstruction requirements .",
    "the fiber optic gyroscopes are sensitive to ambient magnetic fields , which alter the rotation rate reading , so we shielded them by taping them in overlapping strips of metglas .",
    "the rate dependence on the magnetic field was then tested using a helmotz coil .",
    "the sensitivity to magnetic fields was reduced from 17.2``/s / g to 2.3''/s / g by the metglas . on the ld flight trajectory , the earth magnetic field",
    "s horizontal component is at the maximum 200 mg . for 20azimuthal throws",
    ", this translates to a maximum field change of 68 mg , or a change in the gyroscope bias of 0.16\" / s . as we will show in section [ section : results ] , this is smaller than the uncertainty to which the bias is fit for every throw and can be ignored .",
    "a simulation pipeline was developed both to fine - tune the reconstruction software , and to determine the precision with which non - idealities in gyroscope measurements and mount angles needed to be constrained for the pointing reconstruction to satisfy the ebex science requirement .",
    "the pipeline simulates attitude time streams , called hereafter the parent pointing . from these time streams , simulated star camera solutions and gyroscope readings",
    "are generated .",
    "systematic effects are also simulated , with orders of magnitude similar to those measured in section [ section : systematics ] .",
    "as described earlier , the reconstruction software then uses the simulated sensor readings to reconstruct attitude time streams . in this section",
    "we detail how sensor data and systematic errors are simulated .",
    "results on the pointing reconstruction for simulated data are available in section [ section : results ] .",
    "simulating the parent pointing is the first step to generating simulated sensor data .",
    "the parent pointing consists of a time stream where each sample provides information to orient the telescope in the equatorial reference frame : ra , dec , roll . before the ld flight ,",
    "the parent pointing was created by simulating raster scanning with a given scan speed , azimuth throw amplitude , and elevation step size .",
    "after the ld flight , a more realistic parent pointing was generated .",
    "we focus on post ld flight simulations in this paper .",
    "the parent pointing used is a smoothed , rough estimate of the 2012/2013 ebex flight pointing , first using real - time in - flight pointing and after a first iteration using the reconstructed pointing .",
    "the star camera and gyroscopes are simulated for the entire 11 day flight .",
    "the sensor data generated has the same format as real data from flight .",
    "this simulated sensor data is then used as input to the pointing reconstruction software .",
    "the attitude time streams output by the reconstruction software can then be compared to the input parent pointing to estimate the quality of the reconstruction .",
    "this is done in section [ section : results ] .        a star camera solution consists of three euler angles ( ra , dec and roll ) at a given time step corresponding to when the image was taken ( the trigger ) .",
    "the first step to simulate star camera solutions is to simulate the triggers .",
    "the star cameras only take pictures when conditions of slow velocity and acceleration are met .",
    "the same code used in fcp to determine when the star cameras should take images can be used to place the triggers in the simulated data .",
    "alternatively , the code can use actual triggers from flight .",
    "the results in this paper are based on the latter method . for a given trigger ,",
    "the star camera solution is generated by adding gaussian noise to the parent ra , dec and roll at that time step .",
    "the magnitude of the gaussian noise is given by the accuracy of the star camera solutions . before flight , the magnitude of the star camera errors was determined by simulating stars and sky brightness , and solving the simulated images .",
    "after flight , the magnitude of the star camera images was determined using the measured errors from flight , as shown in figure [ fig : star camera solutions ] .",
    "the gyroscope rates @xmath16 need to be computed from the parent time streams .",
    "the process for computing simulated gyroscope rates is equivalent to inverting equation [ eq : propagation ] : for every time step , the parent euler angles , parent euler angle rates , and the r and o matrices are used to compute the gyroscope rates .",
    "several systematic errors are then included when simulating the rates : additive noise , gains , misalignment and rotation angles .",
    "the aim is to simulate the systematic errors with a realistic magnitude , and verify that the reconstruction software is capable of reconstructing the pointing well enough to satisfy the ebex requirement .",
    "we now detail how each systematic error is simulated .",
    "the misalignment and rotation angles are the parameters on which the matrices o and r depend .",
    "the measurement of the misalignment angles described in section [ section : systematics ] showed that all misalignments are smaller than 0.5 .",
    "for each simulation , the misalignment angles are thus chosen from a gaussian distribution with mean 0and standard deviation 0.5 .",
    "the rotation angles are similarly chosen from a gaussian distribution with mean 0and standard deviation 10 , which is the measured uncertainty on the rotation between the gyroscope boxes and the star camera pressure vessels coming from their respective mounting hardware .",
    "the rates @xmath16 are then multiplied by a scale factor to simulate unknown gains .",
    "the scale factor is randomly chosen from a gaussian distribution with a mean of 1.0 and a standard deviation of 7e-5 , corresponding to the uncertainties on the measurements of the scale factors described in section [ section : systematics ] .",
    "note that unlike other effects simulated , the scale factors are not found by the reconstruction software .",
    "instead we used simulations to show that the uncertainties on the measured gains were small enough that the reconstructed pointing satisfies the ebex requirement without further processing necessary .",
    "finally we add the gyroscope noise .",
    "to simulate realistic noise , the power spectra of the ebex gyroscopes are computed using the same data taken for the allan variance measurements .",
    "each power spectrum p is fitted to the model :    @xmath17    where n is the white noise level and @xmath18 the critical frequency for drifts , seen to be roughly 5e-3 hz from figure [ fig : allan_variance ] .",
    "the @xmath19 values for ebex gyroscopes vary between 1 and 1.5 .",
    "the gyroscope noise is then created by generating a time stream of random gaussian noise with standard deviation n , taking the power spectrum of this white noise , scaling the lower frequencies according to @xmath20 , and taking the inverse power spectrum .",
    "the noise time stream is then added to the gyroscope rates .",
    "ebex launched from mcmurdo , antarctica on december 29th 2012 .",
    "it circumnavigated the continent taking data during the first 11 days , at an altitude of @xmath0 35 km .",
    "shortly after launch we discovered that the azimuth motor controller was overheating and causing a motor controller shutdown .",
    "the problem was traced to an error in the thermal design of the motor controller mounting . without active control ,",
    "the azimuth of the gondola was determined by the rotation of the balloon and the rotational spring constant of the flight train .",
    "the resulting motion was composed of slow full rotation ( approximately 20 min / rotation ) and a faster @xmath080 second period sinusoid motion in azimuth of 50- 100peak - to - peak . figure [ fig : az motion ] shows typical short and long timescale behavior of the azimuth in flight . with this type of azimuth motion",
    "we decided to maintain the gondola at constant elevation of 54 , chosen to maintain angular distance of @xmath015from the balloon above , and from the sun at its maximum elevation below .",
    "a map of the pointing of all detector samples ( for all frequency bands ) is shown in figure [ fig : hitmap ] .",
    "ebex scanned a strip of approximately constant dec between -67.9and -38.9 . counting all 6.9 pixels that have more than 10% of the maximum number of hits / pixel",
    "we find a total scanned area of 5735 square degrees . by a fortunate coincidence , the natural oscillating frequency of the gondola , 80 seconds , matched exactly the frequency of the design scan strategy :",
    "the gondola came to a stop every @xmath0 40 seconds , enabling the star cameras to take pictures . in this manner ,",
    "all the pre - flight work assessing the gyroscope noise and non - idealities was still relevant to the actual scan pattern of the ld flight .",
    "40 seconds when the gondola changes azimuth direction.,width=336 ]          the star cameras performed well during flight , consistently solving the images real - time with minimal intervention .",
    "the stars software overcame several unanticipated challenges , detailed in this paragraph .",
    "the loss of azimuth control prevented us from performing the autofocus algorithm which requires stationary pointing , and as a result both star cameras were slightly out of focus during the entire flight .",
    "however the stars software continued to consistently find the stars in the images because of its robust source detection algorithm . to solve images",
    ", the star cameras normally use a pointing guess from coarse sensors , in order to minimize the search radius when matching the stars in the image to the catalog of stars .",
    "the coarse sensors provide a guess in the horizontal reference frame , and this guess is translated in the equatorial reference frame using the gps latitude , longitude and the time .",
    "the gps failed for multiple sections of the flight , which prevented the pointing guess to be rotated in the equatorial frame in which the star cameras operate . in those sections",
    "the star cameras continued finding solutions in several seconds , switching to lost - in - space mode .",
    "this capacity to solve the images in several seconds without any guess was made possible in stars by optimizing the catalog of stars for the ebex star cameras @xcite .",
    "the stars software continued finding stars through different image non - idealities encountered in flight : increased atmospheric brightness from the high elevation , polar mesospheric clouds , vignetting and reflections from the ccd .",
    "a detailed review of the performance of the star cameras can be found in the chapman et al",
    ". companion paper @xcite .",
    "the two star cameras combined took 41,262 images , @xmath080% of which solved .",
    "most of the remaining images are either saturated or within 30of the sun .",
    "figure [ fig : star camera solutions ] shows a histogram of the solution errors for all star camera 0 flight images as reported by the pattern matching least squared algorithm .",
    "the gyroscopes also performed well , recording data continuously and exhibiting behavior in accordance with pre - flight measurements .",
    "this section provides details on running the pointing reconstruction software , describes the methods available to evaluate the reconstructed pointing and gives the results obtained both from simulations and from the ld flight data .",
    "the reconstruction software is composed of the ukf and the least squared optimizer .",
    "the ukf takes as input star camera solutions and associated uncertainties , gyroscope rates and estimated white noise , bias timescales , and misalignment and rotation angles .",
    "it outputs time streams of euler angles ( ra , dec and roll ) and gyroscope bias with their uncertainties .",
    "it also outputs the metric used by the optimizer . to run the reconstruction software ,",
    "the least square optimizer needs an initial guess for the parameters ( misalignment and rotation angles ) , as well as the size of the parameter space ( how big the angles can get ) .",
    "the initial guess for all rotation and misalignment angles is zero , and the parameter space allowed is 0.5for misalignment angles , and 10for rotation angles .",
    "the correct step size in the parameter space has to be tuned for the optimizer to converge and find the correct angles .",
    "this is done by trial and error using simulated data .",
    "after tuning the step size , it takes on average 90 iterations for the optimizer to converge , and each iteration ( reconstructing the pointing on the entire 11 day flight ) , takes approximatively 80 minutes on a single 2.1 ghz processor .",
    "the actual code was multi - processed .",
    "the ukf is then re - run one last time with the optimized rotation and misalignment angles .",
    "the output pointing time streams and pointing uncertainties are written to disk .",
    "the simulations show us that the rotation and misalignment angles are found to within @xmath0 0.001 radians on average , and are more accurately found if data with varied motion are input to the ukf .",
    "it is possible to run the optimizer with larger values allowed for the rotation angles ( up to tens of degrees ) . with the proper step size ,",
    "the optimizer will still converge , though it takes more iterations .",
    "there are three methods available to evaluate the quality of the reconstructed pointing : the ukf estimation method , the star camera difference method , and the parent difference method .",
    "the third method presented is only available for simulated data .",
    "the goal is to estimate the error of the reconstructed pointing over a 40 second throw .",
    "the error over the throw is the square root of the average of all variances across all samples between two star camera readings separated by 40 seconds ( rms ) .",
    "the estimated error on the throw can then be compared both to the pure white noise case ( rms = 11 `` ) and to the ebex requirement ( rms = 54 '' ) .      at every time step , the ukf outputs a covariance matrix along with an estimate of the state .",
    "this means that an estimated uncertainty for ra , dec and roll is available at every time step .",
    "the ukf estimates the covariance using several sources of information : the gyroscope white noise value ( input by the user ) , the bias stability timescale ( input by the user ) , the star camera uncertainty ( input by the user ) , and the measurements of the difference between the integrated pointing with the new star camera reading . to summarize , it propagates the uncertainty given the input noise , and updates the uncertainty when new measurements are available .",
    "the rms on a 40 second throw can be calculated by averaging all these ukf estimated variances for every sample in a 40 second throw :    @xmath21    where t=40 seconds is the throw size in time and @xmath22 is the uncertainty of the reconstructed pointing output by the ukf for sample t. included in the average are all uncertainties on the dec angle , and all uncertainties on the ra angle corrected by cos(dec ) to represent the angular distance on the sky .",
    "hereafter we call ra*cos(dec ) the cross - dec . to note",
    "is that the ukf estimate is heavily dependant on the values input by the user regarding gyroscope white noise , bias timescales and star camera noise .      at every star camera reading , we can compare the pointing integrated from the previous star camera reading to the new star camera solution .",
    "this can be used to measure the quality of the reconstruction . to provide a non biased estimate of the error ,",
    "the difference should be calculated before the new reading is incorporated in the integrated pointing .",
    "this can be done with the forward integrated pointing and with the backward integrated pointing ( but not with the averaged pointing ) .",
    "we need to link these star camera differences to the rms over a 40 second throw , which is the average variance of all samples in the throw .",
    "though the majority of star camera readings are separated by 40 seconds , there are many star camera readings separated by any time difference in the range 0 to 40 seconds . each time there is a star camera at time t away from the previous star camera reading , the difference between the forward and backward integrated solution with the star camera reading gives us and indication of the typical error at this time t. we can bin all throws in 2.5 second bins , and collect for the entire flight all the star camera differences that fall within each bin . for each bin corresponding to time t ,",
    "the variance of all the differences in that bin gives us an estimate of the variance @xmath23 or @xmath24 at time t. here f and b refer to the forward and backward variances .",
    "the average variance at time t can be obtained easily from them :    @xmath25    where t=40 second is the period of the throw . then the rms on the 40 second throw is simply the square root of the average of all @xmath26 , as laid out in equation [ eq : rms ] .",
    "this method to estimate the rms will be called the `` star camera difference method '' in the following subsections . in",
    "is interesting to note that the @xmath27 and @xmath28 will grow like @xmath29 if the data is dominated by gyroscope rate white noise .",
    "if the data is dominated by a bias offset systematic error , the uncertainties will grow like @xmath6 .",
    "finally if the data is dominated by a gyroscope angle systematic error , the error will grow like the distance traveled since the last star camera reading .",
    "this method is illustrated by plotting the @xmath27 in figures [ fig : simul error grow ] ( for simulated data ) and [ fig : flight_reconstruction ] ( for ld flight data ) .",
    "this method is only available for simulated data and is the best possible estimate for the rms . for simulated data ,",
    "the parent pointing is available for every sample . for every sample in a 40 second",
    "throw , the difference between the averaged reconstructed pointing and the parent pointing is calculated .",
    "the rms of all these differences is by definition the rms on the throw .",
    "the histogram of these differences is plotted in blue in figure [ fig : simul_histograms ] .",
    "this measurement is also used to validate the star camera difference method by showing that the two estimations give similar result for simulated data .",
    "figure [ fig : simul_timestreams ] shows time streams of the difference between parent and reconstructed dec angle , as well as parent and reconstructed gyroscope bias for one of the gyroscopes .",
    "the average pointing time stream is the weighted average of the forward and backward reconstructed time streams .",
    "the weights used are the inverse of the variances output by the reconstruction software for every sample .",
    "the ukf estimated error for the average solution is also plotted in dashed blue for every sample , and it is apparent that on average the error is largest mid - throw in between two star camera readings .",
    "the bias is reconstructed to within @xmath01 \" , which is sufficient to satisfy the ebex requirement .        to characterize the quality of the reconstruction on the simulated data , the `` parent difference '' method",
    "histograms of the difference between the simulated parent and the reconstructed dec and cross - dec are plotted in blue in figure [ fig : simul_histograms ] , for throws that are 40 + /-1 second long . both the pure white noise case and the full noise case are plotted .",
    "the simulation with pure gyroscope white noise has a measured rms of 11 `` , which is in accordance with the theoretical prediction ( calculation detailed in appendix [ appendix : white_noise_rms ] ) confirming that the reconstruction software behaves as expected .",
    "note that even for the pure gyroscope white noise case , these histograms are not expected to be gaussian , as the attitude along the throw is sampled from gaussian distributions with growing standard deviation , and therefore the final histogram is the sum of gaussian distributions with different standard deviations .",
    "for the full noise case , the rms of the entire flight simulation for all 40 second throws , 14.9 '' , is smaller than the required rms of 54 \" , ensuring our pointing reconstruction requirements are met in a simulation with realistic noise and systematic errors .",
    "this measurement validates that there is no need to measure the gains to better accuracy or to account for the leftover susceptibility to electromagnetic fields .",
    "it also confirms that the bias and gyroscope orientation are found to sufficient accuracy by the reconstruction software .",
    "the rms estimated by the ukf is shown in green .    .",
    "the rms estimated by the ukf is shown in green .",
    "* bottom * : full noise case .",
    "the simulated data includes gyroscope bias , misalignment and rotation angles , and non - unity gains .",
    "the reconstruction software fits the gyroscope bias , misalignment and rotation angles .",
    "the rms is smaller than the ebex requirement of 54 '' , though the rms is larger in the full noise simulation than in the white noise case , as expected.,width=336 ]    to validate the `` star camera difference '' method , the method is applied on simulated star camera solutions and reconstructed pointing from simulations .",
    "note that this method does not require knowledge of the parent pointing .",
    "figure [ fig : simul error grow ] shows the estimated @xmath27 error as a function of the distance @xmath6 to the star camera reading . for each simulated star camera image , the difference is computed between the star camera dec and cross - dec , and the forward and backward reconstructed dec and cross - dec .",
    "the differences are binned as a function of the distance to the previous star camera reading , in bins of 2.5 seconds . for each bin ,",
    "the standard deviation of the differences is plotted .",
    "the rms on the throw is obtained from those points using equations [ eq : xsc rms ] and [ eq : rms ] .",
    "this is done both for the white noise simulation and for the full noise simulation cases .",
    "the rms found in each case , 11.7 `` and 13.8 '' , are to be compared to the true rms obtained from the `` parent difference '' method illustrated in figure [ fig : simul_histograms ] : 11 `` and 14.9 '' .",
    "this confirms the validity of the `` star camera difference method '' to estimate the true rms over the throw .     and",
    "@xmath28 , the forward and backward errors as a function of the distance in time to the previous star camera reading .",
    "all throws are binned in 2.5 second bins .",
    "each dot is computed by collecting the differences between star camera solutions and forward and backward pointing for all star camera images that fall within than bin .",
    "the dot is then the standard deviation of all differences in that bin .",
    "the rms on the throw is estimated from those points using equations [ eq : xsc rms ] and [ eq : rms ] .",
    "this rms , which is computed here for simulated data without any reference to the parent pointing , can be compared to the true rms computed with the `` parent difference '' method in figure [ fig : simul_histograms ]",
    ". * top:*white noise only case . *",
    "bottom : * full noise simulation.,width=316 ]      for simplicity only results with gyroscope box a and star camera 0 are presented here .",
    "the gains measured pre - flight are used in the reconstruction software .",
    "the `` star camera difference '' method is applied to the 2012/2013 ld flight reconstructed pointing in figure [ fig : flight_reconstruction ] . in the figure ,",
    "the forward @xmath27 and backward @xmath28 estimated error are plotted as a function of the distance @xmath6 to the star camera reading .",
    "the plot is constructed identically to figure [ fig : simul error grow ] in the previous subsection , but using ld flight data instead of simulated data . using the points in figure [ fig : flight_reconstruction ] , we use equations [ eq : xsc rms ] and [ eq : rms ] to estimate the rms on a 40 second throw .",
    "the result is rms = 25 `` , a factor of two under the ebex pointing reconstruction requirement of 54 '' .",
    "it is interesting to note that the ukf reports an rms of only 11.7 `` .",
    "the fact that the estimated rms for real data is higher than for simulations and that the ukf finds an underestimate of the error suggests an un - modeled and previously unmeasured source of gyroscope noise ( the ukf estimate is highly dependant on the user input noise magnitude , and the ukf estimated error is smaller for smaller input noise values ) .",
    "finally , we transform this measured rms back to an error in the map domain and estimate this error to be 4.6 '' ( see appendix [ appendix : transform requirements ] ) .     and @xmath28 , the forward and backward errors as a function of the distance in time to the previous star camera reading .",
    "all throws are binned in 2.5 second bins .",
    "each dot is computed by collecting the differences between star camera solutions and forward and backward pointing for all star camera images that fall within than bin .",
    "the dot is then the standard deviation of all differences in that bin .",
    "the rms on the throw is estimated from those points using equations [ eq : xsc rms ] and [ eq : rms].,width=316 ]",
    "a pointing system for fast - scanning balloon platform was presented , which enables in - flight and post - flight pointing reconstruction . for a gyroscope and star camera system , periods of tens of seconds between star camera images",
    "require careful control of the systematic errors . for an average throw length of 40 seconds",
    ", an rms of 25 \" is achieved by designing a system minimizing possible non idealities , measuring all gyroscopes non - idealities pre - flight , and using a reconstruction software able to find gyroscope bias rates , as well as rotation and misalignment angles .",
    "the development of a realistic simulation pipeline was crucial in the development , understanding and fine - tuning of the reconstruction software .",
    "the growing availability of pre - orthogonalized , low noise gyroscope systems extends the methods described in the paper to longer throw lengths .",
    "ebex is a nasa supported mission through grant numbers nnx08ag40 g and nnx07ap36h .",
    "we thank columbia scientific balloon facility for their enthusiastic support of ebex , and the blast team for sharing their acs system and knowledge .",
    "we also acknowledge support from nsf , cnrs , minnesota super computing institute , minnesota and rhode island space grant consortia , the science and technology facilities council in the uk , sigma xi , private donations , and funding from collaborating institutions .",
    "this research used resources of the national energy research scientific computing center , which is supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "the mcgill authors acknowledge funding from the canadian space agency , natural sciences and engineering research council , canadian institute for advanced research , canadian foundation for innovation and canada research chairs program .",
    "some of the results in this paper have been derived using the healpix package .",
    "1 b. reichborn - kjennerud et al , `` ebex : a balloon - borne cmb polarization experiment '' , 2010 e. pascale et al , `` the balloon - borne large aperture submillimeter telescope : blast '' , apj , 2008 d. chapman et al , `` stars : a software application for the ebex autonomous daytime star cameras '' , proc . of spie conference ( 2014 )",
    "d. chapman et al , `` star camera system and new software for autonomous and robust operation in long duration flights '' , these proceedings ( 2015 ) ieee , specication format guide and test procedure for singe - axis interferometric fiber optic gyros , ieee std .",
    "952 - 1997 http://healpix.jpl.nasa.gov/ r.e kalman , `` a new approach to linear filtering and prediction problems '' , journal of basic engineering 82 , 1960 e. a. wan and r. van der merwe , `` the unscented kalman filter for nonlinear estimation '' , proc . of ieee symposium , 2000 s. julier and j.uhlmann , `` unscented filtering and nonlinear estimation '' , proc .",
    "of ieee , 2004",
    "to assess the quality of the pointing reconstruction , we use the rms error over a throw .",
    "it is interesting to estimate what is the expected rms on a throw given different scenarios : first , gyroscope rate white noise only , then adding systematic errors .",
    "let us first consider the one dimension case , where the gyroscope noise is white and the gyroscope is perfectly aligned with the direction of motion .",
    "the gyroscope measures a rate @xmath30 , and the equation of motion is :    @xmath31    the variance on the integrated angle from a single time step is :    @xmath32    the gyroscopes have a rate white noise of @xmath33 , and the time step is @xmath0 0.01 seconds , so the uncertainty on the angle from a single step of integration is @xmath34 .",
    "n time steps after a star camera , the integrated pointing in a given time direction has a variance :    @xmath35    where @xmath36 is the uncertainty on the star camera solution . at any point in the scan ,",
    "the reconstruction is the weighted average of the forward and backward solutions .",
    "if m is the total number of samples between two star camera readings , the variance of the pointing at time step n is :    @xmath37    the rms on the throw can be expressed as the average of all the variances across the throw :    @xmath38    where we neglected the star camera errors @xmath36 as they are small compared to gyroscope error . on a 40 second",
    "throw , m@xmath04000 , and thus rms@xmath011 \" .",
    "for the three dimension case , the equation of motion ( eq . [ eq : simple motion ] ) needs to be replaced with equations ( [ eq : propagation ] ) , and the uncertainty of each integrated euler angle after n steps now depends on the specific motion and values of all the angles across the throw .",
    "however with our typical velocities and uncertainties , the 1-d calculation is a good approximation .",
    "systematic errors , primarily incorrect bias offsets or incorrect misalignment and rotation angles found by the ukf can also contribute to the error on the reconstructed pointing .",
    "this class of systematic errors grows linearly with time .",
    "let us call this error @xmath39 .",
    "the error on the attitude n samples after a star camera reading is now :    @xmath40    integrating forward and backward similarly to equation [ eq : forward_backward ] , the weighted average at sample n has uncertainty :    @xmath41",
    "the requirements for the pointing reconstruction on ebex are set in the map domain .",
    "the average of all pointing errors within a pixel must be smaller than @xmath010 \" .",
    "we want to map this average error in a pixel to an error on the rms of a throw .",
    "if a pixel is visited p times from independent scans , the sum of all the pointing errors has a variance @xmath42 :    @xmath43    where we made the reasonable assumption that the errors in between scans are uncorrelated .",
    "each time the pixel is hit , it is from a random position in the throw , and so we can compare the previous equation to the rms equation :    @xmath44    to deduce that @xmath45 is in fact related to the rms by @xmath46 .",
    "finally we are interested in the variance of the average of all errors in the pixel ( not just their sum ) , which we call @xmath47 :    @xmath48    the next task is to estimate p , the number of hits per pixel coming from independent scans .",
    "the ld flight hit map is shown in figure [ fig : hitmap ] for pixels of size @xmath06.9 ( nside=516 in the healpix pixelization scheme ) . for pixels of size",
    "@xmath01.7 ( nside=2048 ) , we can extrapolate from this figure that most pixels have between 500 and 7000 hits , with 1600 hits on average .",
    "we do not want to count hits within a given throw because consecutive pointing errors are extremely correlated and do not average down . because of our scan patterns , we assume that a pixel is either hit consecutively within a single throw , or from different revisits from independent scans . let s estimate the number of consecutive hits of a pixel within a throw .",
    "the median velocity of the telescope is 0.1 /s , and so it takes @xmath00.28 seconds to traverse the 1.7 pixel .",
    "the detectors are sampled at 191 hz , and so they hit the pixel 53 times during the 0.28 seconds .",
    "so we estimate p by making the approximation that all pixels have the same number of hits ( 1600 ) and then calculate that the number of hits with uncorrelated pointing errors is p = 1600/53 @xmath030 . since for ebex",
    "the requirements are that @xmath4910 `` , the requirements on the rms over a throw are rms = @xmath5054 '' .",
    "the gyroscopes are mounted close to an orthogonal basis labelled @xmath51 , as shown in figure [ fig : gyro orthog ] .",
    "one of the gyroscopes can be aligned with an axis of the orthogonal basis without loss of generality ."
  ],
  "abstract_text": [
    "<S> the e and b experiment ( ebex ) is a balloon - borne telescope designed to measure the polarization of the cosmic microwave background with 8 resolution employing a gondola scanning with speeds of order degree per second . in january 2013 , ebex completed 11 days of observations in a flight over antarctica covering @xmath06000 square degrees of the sky . </S>",
    "<S> the payload is equipped with two redundant star cameras and two sets of three orthogonal gyroscopes to reconstruct the telescope attitude . </S>",
    "<S> the ebex science goals require the pointing to be reconstructed to approximately 10 `` in the map domain , and in - flight attitude control requires the real time pointing to be accurate to @xmath00.5 . </S>",
    "<S> the high velocity scan strategy of ebex coupled to its float altitude only permits the star cameras to take images at scan turnarounds , every @xmath040 seconds , and thus requires the development of a pointing system with low noise gyroscopes and carefully controlled systematic errors . here </S>",
    "<S> we report on the design of the pointing system and on a simulation pipeline developed to understand and minimize the effects of systematic errors . </S>",
    "<S> the performance of the system is evaluated using the 2012/2013 flight data , and we show that we achieve a pointing error with rms=25 '' on 40 seconds azimuth throws , corresponding to an error of @xmath04.6 \" in the map domain .    </S>",
    "<S> = 1 </S>"
  ]
}