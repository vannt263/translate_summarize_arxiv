{
  "article_text": [
    "experimental distributions in high - energy physics are altered by detector effects .",
    "this can be due to limited acceptance , finite resolution , or other systematic effects producing a transfer of events between different regions of the spectra .",
    "provided that they are well controlled experimentally , all these effects can be included in the monte carlo simulations ( mc ) of the detector response .",
    "one can then use these simulations to correct the data for the same effects .",
    "several deconvolution methods for data affected by detector effects were described in the past ( see for example @xcite ) .",
    "the aim of this paper is to illustrate a new unfolding method allowing one to obtain a data distribution as close as possible to the `` real '' one for rather difficult , yet realistic , examples .",
    "this method is based on the idea that if the mc simulation provides a relatively good description of the data and of the detector response , one can use the transfer matrix to compute a matrix of unfolding probabilities .",
    "if the first condition is not fulfilled one can iteratively improve the transfer matrix .",
    "our method is using a first step , providing a good result if the difference between data and normalized reconstructed mc is relatively small , on the entire spectrum .",
    "if this is not the case , one should proceed with a series of iterations .",
    "the author learned the existence of the iterative methods present in the above list , when this study was close to completion .",
    "two of them ( @xcite ) use a direct comparison of data and reconstructed mc events to compute normalization coefficients for the true mc events . however , it has been shown in @xcite that this approach has a rather slow convergence .",
    "further on , in @xcite one can find two methods based on the comparison of the true mc with the unfolding result at a given iteration .",
    "this comparison allows the computation of the probability matrix to be used at the next step .",
    "for the parts of our procedure which are similar to the ones in these last two papers , we will emphasize which are the differences that make our method more general and better behaved .    in section",
    "[ sec : importantconsiderations ] we present a series of considerations taken into account in the unfolding method developped in the present paper .",
    "we describe the ingredients of the method in sections [ sec : regf ] - [ sec : foldandunf ] . in section [ sec : iterunfstrategy ] , we assemble all these elements into an unfolding strategy .",
    "we provide two examples of applications of the method , with some possible tests , in sections [ sec : complexex ] and [ sec : simpleex ] .",
    "we introduce the notations systematically and we also recall them in appendix [ app : notation ] .",
    "in the unfolding procedure we will not concentrate on the correction of acceptance effects . it is straightforward to perform it on the distribution corrected for the effects resulting in a transfer of events between different bins of the spectrum .",
    "actually , these transfers have a physical meaning only for events which are in the acceptance of the detector and which passed all the cuts .",
    "the method described in @xcite computes at each iteration the spectrum corrected for the acceptance .",
    "this result is then used to improve the folding matrix ( i.e. the probabilities of the causes , as they are called in this reference ) .",
    "furthermore , the folding probabilities for each bin are normalized to the corresponding acceptance .",
    "it is straightforward to prove analytically that this method is completely equivalent to the one used in @xcite , where the acceptance is ignored in the unfolding and the corresponding correction is done at the end .",
    "a first , rather tricky point is the way how the unfolding deals with new structures , absent in the mc , but which can be present in the data .",
    "these structures are affected by the detector effects , and hence they need to be corrected .",
    "it seems that the singular values decomposition ( svd ) @xcite and the iterative @xcite methods provide a natural way of performing this correction .",
    "if the new structures in the data contain a relatively important number of events , they could also affect the normalization of mc spectra with respect to the data .",
    "the unfolding procedure described here makes use of a comparison method between data and mc spectra , which ignores significant shape differences when computing the relative normalization factor .",
    "this allows a coherent comparison of data and mc spectra and improves the convergence of the algorithm when the data contain structures which are not present in the mc simulation .",
    "it is also important to keep in mind that experimental spectra are generally obtained after background subtraction .",
    "this operation results in an increase of errors for the corresponding data points . due to bin - to - bin or correlated fluctuations of the subtracted background",
    ", these points can fluctuate within their errors , or they can hide systematic effects as large as the error components due to background subtraction . when computing the central values of the final distribution , the unfolding procedure has to take into account the size of the experimental errors , including the ones from background subtraction .",
    "not doing so could result in too large a transfer of events from / to different regions of the spectrum .",
    "this would affect the regions of important background subtraction , but could also bias the central values of more precise points in another region .",
    "such a systematic effect of the procedure is to be avoided . to our knowledge ,",
    "none of the previous methods aim at dealing with this second type of problem , and at distinguishing it from the first one .",
    "we are going to describe a method which is be able to deal with the potential problems described above .",
    "the fluctuations which can be generated when using this type of method are dynamically reduced , in the sense that the way in which bin - by - bin corrections are performed avoids this problem .",
    "therefore , no additional smoothing by a model - dependent fitting of the unfolding result at each iteration step ( as proposed in @xcite ) , is required .",
    "the transfer of events performed by the unfolding introduces bin - to - bin correlations for the final spectrum . for further use of the data , these correlations are to be reduced as much as possible , if this can be done without introducing significant systematic biases of the result .",
    "actually , the correction of systematic effects can generally be obtained without performing on data the maximal transfer of events ( predicted by the transfer matrix ) , but only part of it .",
    "the method described in this paper allows one to control the amount of these correlations and an optimization can be done with respect to the potential systematic bias of the final result .",
    "this method is to be applied on binned , one dimensional data and the label of the physical quantities will be provided by the bin numbers",
    ". it can be directly generalized to multidimensional problems . for the sake of simplicity",
    ", we will consider only examples where the number of bins of the data and reconstructed mc is the same as the one for the unfolded distribution and true mc .",
    "however , it is rather easy to generalize the method to include a binning change in the unfolding operation .",
    "all the formulae in the following will be given for this general case .",
    "we suppose the statistics of the data and of the simulation high enough to allow a `` reasonable '' separation into a series of bins . if this is not the case , the size of the bins must be adapted to the available statistics .",
    "in order to dynamically reduce fluctuations and not to unfold events which could be due to fluctuations , in particular from the subtracted background , one can use a regularization function @xmath0 .",
    "this function provides an information on the significance of the absolute deviation @xmath1 between data and simulation in a given bin , with respect to the corresponding error @xmath2 .",
    "it must be a smooth monotonous function going from 0 , when @xmath3 , to 1 , when @xmath4 .",
    "@xmath5 is a scaling factor , used as a regularization parameter .",
    "as we will see in the following , changing the regularization function that is used in our method will change the way we discriminate between real deviations and statistical fluctuations .",
    "it can be seen as the complementary of a generalized ( by the use of @xmath5 ) `` p - value '' of a given deviation between two variables affected by errors , if one considers the hypothesis that the mc describes well the data in the given bin .",
    "actually , for @xmath6 this function is the complementary of the p - value defined in @xcite , computed for a given pdf .",
    "if the correlations between the errors of the values entering the computation of @xmath1 are not negligible , only the uncorrelated part must be kept when computing @xmath2 .    for the unfolding procedure",
    ", we consider several types of functions of the relevant variable @xmath7 : @xmath8 their dependence on the relevant ratio is shown in fig .",
    "[ fig : functions ] .     with respect to @xmath7.,width=529 ]    in general , we will use different @xmath5 parameters for the regularization function for each step of the unfolding procedure .",
    "we will see however that some of these parameters can be unified or even dropped .",
    "in the unfolding procedure we will need to perform a comparison of data and reconstructed mc , as well as true mc and intermediate unfolded spectra .",
    "we must not forget that the data may contain structures , which were not ( well ) simulated in the mc .",
    "if the number of events corresponding to them is not negligible with respect to the total number of events in the data , the normalization of the mc spectra should be determined with care .",
    "one must actually ignore the `` unknown '' ( to the simulation ) events in these structures when computing the normalization factor .",
    "not doing so ( a standard normalization procedure would use the total number of events in the two spectra ) could result in generating fake differences between the two spectra , in regions where the data are well described by the simulation .    for a good normalization , one needs to get an estimation of the number of events in the data / intermediate unfolding spectrum which correspond to features that were simulated in the reconstructed / true mc ( @xmath9 ) .",
    "dividing @xmath9 by the number of events in the true and reconstructed mc spectra ( @xmath10 ) one gets the normalization factor to be used for the mc .",
    "this is done as follows : + 1 ) a first estimation of this number is provided by the total number of events in the data and in the intermediate unfolding distribution ( @xmath11 ) , minus those which are potentially due to background subtraction : @xmath12 . here @xmath13 is the number of bins in the data and in the reconstructed mc distribution , @xmath14 is the number of bins in the unfolding result and in the true mc distribution , @xmath15 stands for the number of reconstructed data events in the bin k ( after background subtraction ) and @xmath16 for the number of events in the bin k of the data distribution which are potentially due to a fluctuation in the subtracted background , @xmath17 stands for the number of unfolded events in the bin j and @xmath18 for the number of events in the bin j of the unfolded distribution which are potentially due to a fluctuation in the subtracted background . +",
    "one can then improve this estimation by an iterative procedure : + 2 ) a better estimation is provided by @xmath19 with @xmath20 where @xmath21 is the number of reconstructed mc events and @xmath22 the number of true mc events , and @xmath23 if the errors of @xmath15 or @xmath24 ( @xmath25 ) are not correlated with the errors of @xmath21 or respectively @xmath22 ( @xmath26 ) .",
    "this hypothesis is true for the first - step comparison of data and reconstructed mc .",
    "the situation is different at further iteration steps and for the comparison of true mc and intermediate unfolding spectra .",
    "there , only their uncorrelated parts must be added quadratically to get @xmath27 . in practice , however , as the mc errors are generally negligible , considering only the data / unfolding errors at this level may be sufficient . + using eq .",
    "( [ eq : neprdsmc ] ) , one adds to the previous estimate other events which have a low probability to belong to initially unknown structures . on the contrary , due to the factor in front of @xmath28 , there is only a relatively small contribution from events likely to belong to initially unknown structures .",
    "+ in the special cases when @xmath29 or @xmath30 , the content of the corresponding bins will be neglected when computing the number of events for the data and mc . this kind of situation will also receive a special treatment in the unfolding procedure , the estimation of the background fluctuations and the improvement of the transfer matrix .",
    "+ 3 ) replace @xmath9 by @xmath31 and iterate until the change in @xmath9 between two consecutive iterations gets very small .",
    "+ in the examples presented in this paper we stopped the normalization iterations when the relative improvement of two consecutive steps was less than @xmath32 .",
    "it should be emphasized that a better estimation of @xmath9 improves the separation between `` known '' and `` unknown '' structures , which then improves the next estimation . at the same time , the values of the parameter @xmath33 ( for normalization ) , providing a good convergence of the normalization procedure , need to be studied , as described in section [ sec : optparam ] .",
    "the convergence properties of the normalization procedure also depends on the amount of background fluctuations which are not yet identified when the normalization is performed . in the normalization procedure , these fluctuations , corresponding to data points with larger error bars , and would more likely not be identified as new structures . as the estimation of the remaining background fluctuations gets improved , the normalization follows .    at this level we made a distinction between @xmath16 and @xmath34 only to keep the method as general as possible . indeed , if the binning of the initial ( data ) and final ( unfolded ) distributions are not the same",
    ", one must build a prescription to convert one vector into another , by a rebinning ( in any case , no unfolding will be done for these events ) . using a rebinning transformation @xmath35 to pass from data to unfolding bins and the inverse rebinning transformation @xmath36 to pass from unfolding to data bins",
    ", one can convert one vector into the other , through : @xmath37 these two transformations , if valid for all the sets of possible spectra in the two binnings ( as defined before ) , must be non - linear .",
    "actually , if they were linear , as their two matrix would contain only positive elements , even if @xmath38 , their product could not be equal to the identity matrix . if the binning of the data and unfolding result are the same , the two vectors will always be identical ( i.e. @xmath39 ) .",
    "in the mc simulation of the detector one can directly determine the number of events which were generated in the bin @xmath40 and reconstructed in the bin @xmath41 ( @xmath42 ) .",
    "provided that the transfer matrix @xmath43 gives a good description of the detector effects , it is straightforward to compute the corresponding folding and unfolding matrix : @xmath44 the folding probability matrix , as estimated from the mc simulation , @xmath45 gives the probability for an event generated in the bin @xmath40 to be reconstructed in the bin @xmath41 .",
    "the unfolding probability matrix @xmath46 corresponds to the probability for the `` source '' of an event reconstructed in the bin @xmath41 to be situated in the bin @xmath40 .",
    "these matrix elements are well defined if the true mc bin j , and respectively the reconstructed mc bin i , are not empty .",
    "if that is not the case , one can set these values to zero and a special treatment must be provided for these bins in the unfolding algorithm .",
    "the folding matrix describes the detector effects , and one can only rely on the simulation in order to compute it .",
    "the quality of this simulation must be the subject of dedicated studies within the analysis . as a result of these studies ,",
    "the transfer matrix can be improved , a systematic error is to be associated to it and must be propagated to the unfolding result .",
    "the unfolding matrix depends not only on the description of detector effects but also on the quality of the model which was used for the true mc distribution .",
    "it is actually this model which can ( and will ) be iteratively improved , using the comparison of the true mc and unfolded distributions .",
    "it is easy to see that the reconstructed and true mc distributions are related through : @xmath47 provided that the detector effects are well simulated , the folding equation ( [ eq : rmc ] ) will also stand for data , no matter what the true spectrum is in the real world . the unfolding equation ( [ eq : tmc ] )",
    "can be written for data only in an approximate way , due to the differences between the model used for @xmath48 and the real physical signal which introduce an uncertainty on the initial unfolding matrix .",
    "however , @xmath48 and hence the unfolding matrix , can be iteratively improved and therefore it is an improved version of ( [ eq : tmc ] ) that will be used to compute the unfolding result from data .",
    "other effects will also be taken into account in the unfolding equation , as we shall see in the next subsection .",
    "equation ( [ eq : tmc ] ) can be seen as a `` basis for the unfolding '' , in the sense that it describes this operation performed on the mc .",
    "if the differences between data and reconstructed mc are relatively small , then those between the unfolding result and true mc will be small too .",
    "in any case , one can start with an unfolded distribution equal to the true mc , and add to it the unfolded data events which are not present in the reconstructed mc .",
    "for the initial true mc one can use either a previously measured spectrum ( if available ) or one inspired by the data and the transfer matrix .    in order to perform the unfolding , one must first use the iterative procedure described in section [ sec : mcnorm ] to determine the mc normalization coefficient ( @xmath49 ) . at this level , it is the comparison of the reconstructed mc with the data that is used in the normalization procedure .",
    "one can then proceed to the unfolding , where , in the case of identical initial and final binnings , the result for @xmath50 $ ] is given by : @xmath51 where the same notation as in ( [ eq : neprdsmc ] ) is used . in the case of different binnings for the data and the unfolding ,",
    "the kroneker symbol @xmath52 must be replaced by a rebinning transformation @xmath35 .",
    "the first two contributions to the unfolded spectrum are given by the normalized true mc and the events potentially due to a fluctuating background subtraction , which are not transferred from one bin to another .",
    "then one adds the events which are present in the data minus the potential effect from the background , and which are absent in the normalized reconstructed mc .",
    "a fraction @xmath53 of these events are unfolded using the estimate of the unfolding probability matrix @xmath54 , and for the rest , only a rebinning is done ( if necessary ) . with the description of the regularization functions given in section [ sec : regf ] ,",
    "it is clear that reducing @xmath5 would result in increasing the fraction of unfolded events , and reducing the fraction for which only a rebinning is done .",
    "this unfolding step benefits from two regularizations : one through the use of the previously described functions , and a second ( implicit ) one , through the mixing of events in different bins , by transfer of events .",
    "changing @xmath5 can reduce one regularization and enhance the other .",
    "choosing an appropriate value for this coefficient provides one with a dynamical attenuation of spurious fluctuations , without reducing the efficiency of the unfolding itself .",
    "this is possible due to the fact that the fraction of unfolded events is larger when the deviations between the spectra are larger with respect to the corresponding errors .",
    "some precautions need to be taken if @xmath55 or @xmath56 .",
    "the first situation can typically occur if the background subtraction that was made for data , in the given bin , is too large , or if the binning is not well adapted to the data statistics .",
    "the second one indicates that the given data bin size is too small even for the mc statistics and the corresponding unfolding elements can not be computed . in these two situations , the events which are present in the data minus the potential remaining background and minus the normalized reconstructed mc will be simply rebinned ( or kept in their original bin if the data and unfolding binnings are identical ) .",
    "after having performed one unfolding procedure yielding to a result @xmath57 , as described before , one can directly compare it with the true mc .",
    "doing this , one can compute an estimate of the fluctuations from subtracted background events . as these fluctuations must be identical in the reconstructed data and in the unfolding result ,",
    "it is important that the first unfolding does not affect them ( hence a constraint on the corresponding parameter @xmath58 ( for subtraction ) ) .    just as for the unfolding",
    ", one must first use the iterative procedure described in section [ sec : mcnorm ] to determine the mc normalization coefficient ( @xmath49 ) , looking this time for structures present in the unfolding result , but not simulated in the true mc .    then one can ( re-)estimate the background to be subtracted @xmath59 where @xmath60 .    here , increasing @xmath58 would increase the fraction of not - simulated events , which will be assigned to the estimate of the remaining background from fluctuations in the subtraction . in principle",
    "one could perform this estimation using @xmath61 , with the right side of ( [ eq : imprbu ] ) increased by the previous estimate ( @xmath18 ) , but here we rather use @xmath62 so that we avoid an artificial increase of @xmath63 in regions where the spectra differ only due to a normalization effect .",
    "this allows one to use sufficiently large values of @xmath58 , to efficiently subtract real remaining background fluctuations .",
    "the use of large values of @xmath58 will also prevent the propagation and potential amplification of the fluctuations in the unfolding result .",
    "once this estimate is obtained , one can use it to get a better normalization and then reestimate the background fluctuations .",
    "this new information is however exploited very fast and one or two iterations are largely enough at this level .",
    "one can perform the ( re-)estimation ( [ eq : imprbu ] ) only in the usual case , when @xmath64 and @xmath65 . otherwise , the estimation of the remaining background is trivially modified @xmath66 implying a fixation of the corresponding `` pathological '' events at the next unfolding step .",
    "this solution seems natural if the unfolding result minus the remaining background has a negative number of events in the given bin .",
    "such a situation can occur due to an overestimation of the background that was subtracted to get the data spectrum to be unfolded .",
    "if the origin of the problem is the low mc statistics in the neighbourhood of the given bin , a more suitable solution could be the choice of an adapted binning .",
    "we feel that this problem should be dealt with in unfolding methods .      as explained in the introduction ,",
    "if the initial true mc distribution does not contain or badly describes some structures which are present in the data , one can iteratively improve it , and hence the transfer matrix .",
    "this can be done by using a better ( weighted ) true mc distribution , with the same folding matrix describing the physics of the detector , which will yield to an improved unfolding matrix .",
    "just as in the previous section , one must determine the mc normalization coefficient , looking for structures present in the unfolding result , but not simulated in the true mc .",
    "as the description of the new structures by the mc will get improved , the task of the normalization procedure will be easier .",
    "then the improvement is performed for one bin @xmath40 at the time .",
    "if however @xmath67 or @xmath68 , one does not modify the transfer matrix in the corresponding true bin .",
    "generally , this is not the case , and one can get an improved determination of all the elements of the column @xmath40 of the transfer matrix @xmath69 here , @xmath70 ( for modification ) stands for the regularization parameter used when modifying the matrix .",
    "increasing @xmath70 would reduce the fraction of events in @xmath71 used to improve the transfer matrix .",
    "this method allows an efficient improvement of the folding matrix , without introducing spurious fluctuations .",
    "this is due to the fact that the larger the difference between the spectra , with respect to the corresponding errors , the larger the fraction of events used for the improvement of the matrix will be .",
    "the amplification of small fluctuations can be prevented at this step of the procedure too .",
    "in this section we describe a quite general unfolding strategy , based on the elements presented before .",
    "it works for situations presenting all the difficulties listed before , even in a simplified form , where some parameters are dropped and the corresponding steps get trivial .",
    "the strategy can be simplified even more , for less complex problems .",
    "one will start with a null estimate of the background . a first unfolding , as described in section [ sec : unfold ] ,",
    "is performed , with a relatively large value of @xmath72 .",
    "this step will not produce any important transfer of events from the regions with potential remaining background ( provided that @xmath73 is large enough ) .",
    "actually , it is the condition that this transfer must be very small that will impose a minimal value for @xmath73 . the first unfolding will perform the correction equal to the difference between the normalized true and reconstructed mc .",
    "this is generally the main correction that the unfolding has to provide .",
    "concerning the new structures in the data , depending on their relative size , on the size of the transfer corrections and on @xmath73 , the corresponding corrections at this level can be more or less important .",
    "one can even drop @xmath73 , by taking its value very large , which amounts to performing only the main correction discussed in the previous paragraph .",
    "this obviously guarantees the stability of the remaining background fluctuations for this step .    at this level",
    "one can start the iterations : + 1 ) estimation of the remaining background fluctuations + an estimate of the remaining background fluctuations can be obtained using the procedure described in section [ sec : estbkg ] .",
    "the parameter @xmath58 used here must be large enough , not to underestimate the remaining background . as explained before , this",
    "can also prevent unfolding fluctuations from propagating .",
    "@xmath58 can however not be arbitrary large , as this operation must not bias initially unknown structures , by not allowing their unfolding .",
    "the ability of the method to simultaneously satisfy to these conditions clearly depends on the properties of the function @xmath74 , as it defines the degree of significance of deviations between spectra .",
    "+ 2 ) improvement of the unfolding probability matrix + using the method described in section [ sec : impmatrix ] , one can improve the folding matrix @xmath43 and get a better estimate of the remaining background .",
    "a parameter @xmath70 , small enough for an efficient improvement of the matrix , yet large enough not to propagate spurious fluctuations ( if not eliminated at another step ) , must be used at this step .",
    "+ 3 ) an improved unfolding + a parameter @xmath75 will then be used to perform an unfolding following section [ sec : unfold ] , exploiting the improvements done at the previous step .",
    "it must be small enough to provide an efficient unfolding , but yet large enough to avoid spurious fluctuations ( if not eliminated elsewhere ) .",
    "+ these three steps will be repeated until one gets a good agreement between data and reconstructed mc plus the estimate of the background .",
    "another way of proceeding could consist in stopping the iterations when the improvement brought by the last one on the intermediate result is relatively small .",
    "if the parameters of the unfolding are well chosen , the two conditions yield similar results .",
    "provided that one has a good model of the true data , one can even use a toy simulation to estimate the needed number of steps .",
    "the values of the @xmath5 parameters are to be obtained from toy simulations , as will be shown in the following .",
    "as one does not have a prior lower limit for @xmath70 and @xmath76 , other than the one related to the regularization , one can discard them by taking their values to zero ( i.e. using all the data - reconstructed mc difference in the unfolding , and all the difference between the true mc and the intermediate unfolding , to improve the transfer matrix ) .",
    "this can be done if the higher limit on @xmath58 provides enough regularization at the level of the subtraction procedure .    in principle",
    ", one could also perform an estimation of the remaining background fluctuations , when comparing the data with the reconstructed mc .",
    "this could be done as a straightforward adaptation of the method explained in section [ sec : estbkg ] or computing this estimate as an improvement of the previous one , with @xmath77 replaced by @xmath78 .",
    "this second method could be reliable if the normalization effect is small enough .",
    "however , when doing the estimation of the background fluctuations at the data - reconstructed mc level , one would not benefit from the iterative improvement of the true mc . this can be useful in the method of section [ sec : estbkg ] , as it improves the separation between real new structures and fluctuations , especially when the resolution effects are important .",
    "in the following we describe a rather complicated , yet realistic test , proving the robustness of the method .",
    "it exhibits all the features discussed previously , which are simultaneously taken into account by the unfolding . for the clarity of the presentation ,",
    "the structures and dips of the spectrum are however separated .",
    "the true and reconstructed spectra for this test have 200 identical bins .",
    "the first step consists in building a model for the transfer matrix @xmath79 .",
    "the transfer matrix @xmath80 with @xmath81 , @xmath82 , @xmath83 and @xmath84 ; exhibits resolution effects and corresponds to a true spectrum which is mainly gaussian .",
    "in addition , this spectrum includes a gaussian resonance ( more narrow than resolution ) centred on the bin 130 and a dip around the bin 40 ( larger than resolution ) .",
    "one then includes a systematic transfer of events from high to lower bins , getting the final model matrix ( see fig .",
    "[ fig : ax4 ] ) : @xmath85 with @xmath86 and @xmath87 . in practice",
    ", one can find an example of this type of transfer of events , for measurements of the cross section @xmath88 with the radiative return method . indeed ,",
    "not detecting a final state photon will result in an underestimation of the mass of the given event .     of transfer matrix . here , for display reasons , the bins are four times larger than the real ones ( an average was computed inside squares of @xmath89 initial bins).,width=377 ]    it is a fluctuation of the model that will be used as mc transfer matrix @xmath43 for the unfolding .",
    "the model itself provides the `` real '' detector matrix which will be crucial for the building and folding of the true distribution .",
    "one must then fix a normalisation ratio between data and mc simulation ( of the order of 1/10 for usual experiments ) .",
    "the true data distribution will be given by the normalised true distribution corresponding to @xmath79 , completed with structures unknown by the mc ( a `` bias '' ) : @xmath90 , \\label{eq : bias1}\\ ] ] with @xmath91 and @xmath92 .",
    "the resonance centred on the bin 90 is more narrow than resolution and will therefore be hard to correct , whereas the one centred in 170 is larger .",
    "the folding probability matrix is to be computed from @xmath79 . at this point",
    ", one can compute the known data ( @xmath93 ) , by folding the true data without the new structures .",
    "the folding of the true data yields to the reconstructed spectrum ( after fluctuation within statistical errors ) .",
    "the final data spectrum ( filled circles in fig .",
    "[ fig : unf1 ] ) is obtained after adding a remaining background component , where it can typically appear in practice , i.e. in the dip of the spectrum , with the average per bin : @xmath94 with @xmath95 . for the background",
    ", we attribute an error bar equal to its average value in each bin .",
    "this background can come with or without statistical fluctuations corresponding to its error bars . in order to simulate this feature",
    ", we fluctuate the background within its errors for @xmath96 only , and we add it to the data fluctuated within their statistical errors .",
    "the final errors of the data , which will enter the unfolding algorithm , are given by the quadratic sum of the errors of the background plus the statistical ones from the data without background .",
    "the unfolding result is to be compared with the true data plus the remaining background .",
    "this represents a test over a very large dynamic scale .",
    "the results that will be presented for this test were obtained using the function ( [ f:1mexp ] ) , for @xmath97 , but similar results were obtained with the other functions .",
    "the parameters to be used in the unfolding were studied with an independent toy simulation , with various parameters for the fluctuations in background subtraction , and the bias . in practice , one would need approximate values of the parameters for the spectrum and the potentially dangerous background fluctuations , in order to perform the further study , to determine the parameters of the unfolding .",
    "one can get a very preliminary estimate for the parametrization of the spectrum from the difference between data and reconstructed mc , together with the transfer matrix , and from the procedure of background subtraction .",
    "once the unfolding performed , the determination of the spectrum parameters is also drastically improved . in principle , at that point , one could try to re - estimate the optimal parameters of the unfolding and try to improve them with more accurate toy simulations . in practice however , excepting very extreme situations , this new estimate will be consistent with the first one .    , without background or with the usual background value , obtained after , at most , from left to right , 30",
    ", 50 and respectively 200 steps.,title=\"fig:\",width=188 ] , without background or with the usual background value , obtained after , at most , from left to right , 30 , 50 and respectively 200 steps.,title=\"fig:\",width=188 ] , without background or with the usual background value , obtained after , at most , from left to right , 30 , 50 and respectively 200 steps.,title=\"fig:\",width=188 ]    , without background or with a background twice less ( left ) , twice larger ( middle ) and four times larger ( right ) than usual . in the right figure , only the upper limit of the normalization improvement with background is visible .",
    "these improvement values were obtained after , at most , 50 steps.,title=\"fig:\",width=188 ] , without background or with a background twice less ( left ) , twice larger ( middle ) and four times larger ( right ) than usual . in the right figure , only the upper limit of the normalization improvement with background is visible .",
    "these improvement values were obtained after , at most , 50 steps.,title=\"fig:\",width=188 ] , without background or with a background twice less ( left ) , twice larger ( middle ) and four times larger ( right ) than usual . in the right figure , only the upper limit of the normalization improvement with background is visible .",
    "these improvement values were obtained after , at most , 50 steps.,title=\"fig:\",width=188 ]    the optimization of the parameter @xmath33 used in the normalization procedure , was studied for the comparison between data and reconstructed mc , with a null estimate of the remaining background fluctuations .",
    "as explained before , at this level , one would not take advantage on the corrections of the resolution effects on new resonances .",
    "actually , these corrections make easier the separation of new structures and remaining background fluctuations . a procedure that works properly at the data",
    "/ reconstructed mc level , would work even better when comparing an intermediate unfolding result and the true mc .",
    "furthermore , the normalizations at these two levels are improved by a better knowledge of the remaining background fluctuations and by the improvement of the transfer matrix through the true mc .",
    "the first part of this study was performed with toys of data and reconstructed mc spectra , obtained as described in section [ subsec : building1 ] , with or without the remaining background given by eq .",
    "( [ eq : bkgd ] ) . in both cases , the first estimate of @xmath9",
    "is given by the number events in the data @xmath11 . for 100 toys , we plot the minimal and maximal improvement brought by the procedure ( @xmath98 ) , for a large interval of @xmath33 values ( see fig . [",
    "fig : optlnub ] ) .",
    "we stop iterating when the relative improvement of two consecutive steps gets less than @xmath32 , or after a fixed number of steps ( if the first condition was not fulfilled before ) .",
    "fast convergence and good stability ( with respect to the background problem ) are exhibited for large values of the parameter of normalization .",
    "the procedure is clearly sensitive to the presence of background fluctuations , which are treated more like real structures , for small values of @xmath33 .",
    "it is only in this region of values of @xmath33 that the limit on the number of steps plays a role .",
    "too small a value of @xmath33 could be identified , even when running on fluctuating data , by the presence of instabilities in the sign and size of the correction ( their size could not converge for a reasonable number of iterations ) .",
    "one can conclude from these plots that a value of @xmath99 would provide a relatively good normalization improvement at the first steps of the unfolding , as well as when one gets an estimate of the background fluctuations .",
    "other amplitudes of background fluctuations ( see fig . [",
    "fig : optlnob ] ) could yield to different conclusions .",
    "if these fluctuations are larger or not well known , one could prefer to use a large value of the parameter ( which could even come to perform just the standard normalization ) before the first background estimation , and a smaller one afterwards .",
    "it has been tested that a change of the centre of the background distribution ( eq .",
    "( [ eq : bkgd ] ) ) by @xmath100 does not change the conclusions related to the normalization parameter .    in practice",
    ", one can perform the previous study on a model similar to the data or directly using the data and reconstructed mc distribution . in this second case , only the black curve in fig .",
    "[ fig : optlnub ] would be available .",
    "the plots in the rest of this subsection were obtained for :    * an amplitude of the resonance initially centred on the bin @xmath101 ( moved to the bin @xmath102 , with a width @xmath103 for this scan ) , reduced by @xmath104 with respect to eq .",
    "( [ eq : bias1 ] ) ; * the amplitude of the resonance initially centred on the bin @xmath105 ( centred on the bin @xmath106 , with a width @xmath107 for this scan ) , increased by @xmath104 ; * the effect of the background subtraction reduced by @xmath104 with respect to the one in eq .",
    "( [ eq : bkgd ] ) , and centred on the bin @xmath108 , with @xmath109 .",
    "the resulting optimal parameters are stable with respect to various changes of this type .",
    "the choice of the value @xmath73 ( to be used for the first unfolding step ) is made such that , for different relative amplitudes of the subtraction effect , it is not unfolded , and hence does not bias other regions of the spectrum .",
    "we have observed that the value @xmath110 , would be large enough , not to unfold fluctuating background effects for different relative values of their amplitude . in order to show that this parameter can be dropped , and the procedure simplified",
    ", we have however choosen a very large value for it , such that the correction done by the first unfolding is given only by the difference between the true and reconstructed mc .",
    "the two other parameters to be used and the number of necessary iterations , are analysed using a scan of their values , for test spectra with different amplitudes of the initially unknown resonances . for every set @xmath111",
    ", we compute a distance of the @xmath112 type between the final reconstructed mc and the data minus the events to be subtracted , as well as between the unfolding result and the true spectrum plus background fluctuations , for a number of steps minimizing this last distance ( see fig .",
    "[ fig : optlulm ] ) .",
    "( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ] +   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ] +   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]   ( top line ) , @xmath113 ( middle line ) and @xmath114 ( bottom line).,title=\"fig:\",width=188 ]    these distances are computed using simply the statistical errors of the data , plus a small component for statistical fluctuations of the mc , for the first one . the anomalous values ( once divided by the number of degrees of freedom ) , obtained sometimes for the optimal parameters , can be explained by the fact that we ignore the change in the errors of the spectrum and they correlations due to the unfolding .",
    "however , as we are not interested in the absolute values of these distances , but only on the optimal parameters , this way to proceed is good enough .",
    "actually it is even to be preferred due to its inherent sensitivity to some potential instabilities of the iterations ( for inappropriate values of the parameters ) , generating large fluctuations .",
    "this sensitivity would be lost if one would compute the distances using for example the errors resulting from a toy simulation .    asking for small values of the two distances ( at the unfolded / true mc and respectively data / reconstructed mc level )",
    ", one can clearly discriminate the best region of values for @xmath70 and for @xmath76 .",
    "they are valid , not only for the parameters of the spectra used in this scan , but also for different ones used in the test of the method , as we ll see in the following .",
    "the corresponding plots indicate here small distance values for @xmath76 and @xmath70 close to zero ( or even null ) , indicating that the use of these parameters is not absolutely necessary .",
    "these plots also give even more information about potentially problematic parameterizations yielding for example badly unfolded ( not enough corrected ) new structures if @xmath70 is too large , or to fluctuations if one performs only small unfolding corrections in the iterations ( large @xmath76 ) and the other parameters preventing their propagation are not appropriate .",
    "this kind of study has some sensitivity to @xmath58 ( to be used in the subtraction procedure ) too , through the distance at the unfolded / true mc level .",
    "actually , if its value is too large , the subtraction is too strong preventing the good reconstruction of new structures . as we saw before",
    ", this distance is also enhanced if fluctuations propagate ( for example because of a too small @xmath58 ) .",
    "these distances provide however only global comparisons of the spectra . therefore , for complex situations like in this example",
    ", a more precise determination of the parameters is provided by local comparisons of the spectra within toy simulations ( i.e. local contributions to the previous distances ) .",
    "this kind of comparison performed for the spectra used in the previous scans , or other similar variations , indicates that a value @xmath115 allows one to fix background fluctuations and to prevent the ones of the procedure , without a bias of the reconstruction of new structures .",
    "as we will see , the choice of this value , as well as the other parameters , can be tested directly when unfolding the data .",
    "the plot of the optimal number of iterations provides a relatively good estimation of the number of steps which are needed in practice , when the corresponding unfolding parameters are used .",
    "the confidence one can make to this number depends however on the precision with which one knows the widths of the new resonances .",
    "one should keep in mind that this is just an estimation and , once the unfolding parameters are determined , a better suited strategy could be to stop the algorithm when the iterations start having a small impact on the result or yet when one gets a good agreement between data and reconstructed mc .      here",
    "we present the way the unfolding behaves for the distributions described in section [ subsec : building1 ] .",
    "this tests the reliability of the unfolding method as well as the one of the procedure used to optimize the parameters .    as explained in the previous subsection for the various test distributions , here also a parameter @xmath110",
    "would be large enough to leave the background contribution in its initial position .",
    "the first unfolding step was however performed with a very large value for this parameter ( see fig . [",
    "fig : unf1 ] and [ fig : test1 ] ) and it corrects all the elements of the spectrum which are known by the mc , for both kinds of transfer effects ( in spite of the fact that they are relatively important ) .",
    "this first step could also perform part of the needed corrections for the new structures , but we postpone these corrections to further unfolding steps , by taking a very large @xmath73 .",
    "a series of 65 iterations was then performed , with complete unfolding and matrix modification ( i.e. taking the parameters @xmath116 and @xmath117 ) .",
    "actually , in this case the regularization is provided by the use of @xmath113 , and the use of @xmath76 and @xmath70 can be dropped .",
    "a very good estimation of the remaining background fluctuations is obtained at the first iteration , and the further improvements are relatively small . however , for the sake of generality , it has been tested that good results can be obtained , with non - zero values of @xmath76 and @xmath70 .",
    "the main effect of these iterations is to correct the folding matrix , by introducing in the true mc distribution ( and implicitly in the reconstructed one ) , the structures which were unknown for the initial simulation ( see fig . [",
    "fig : amx4nsteps ] ) . a first reason for which such a high number of iterations was needed in this test",
    "are the large resolution effects which must be corrected for the initially unknown structures , even for the narrow one .",
    "it has been tested that between 15 and 20 iterations are generally enough to reconstruct well the new structure centred on the bin 170 , which is slightly larger than the detector resolution , being however strongly affected by its effects too .        the final estimation ( see fig . [",
    "fig : data1-reconsteps ] ) reproduces well the background fluctuations added in the region of the dip , for the bins where it was fluctuating as well as for the ones where it was stable .",
    "the need to distinguish between potentially remaining background fluctuations and new structures , especially when having an important transfer of events in the unfolding , imposes important constraints on the parameter values that can be employed .",
    "this can be a the second reason which can increase the number of needed iterations .",
    "the difference between the data and the improved reconstructed mc is basically equal to the background estimate , which is not used when modifying the transfer matrix .",
    "the final unfolding result reconstructs well all the structures in the true data , without introducing important systematic effects due to the remaining background ( see fig . [",
    "fig : toyunfoldingn1 ] and fig .",
    "[ fig : testnsteps ] ) .",
    "the error bars of the unfolding result(s ) were estimated using 100 mc toys , with fluctuated data and transfer matrix for the unfolding procedure .",
    "the corrected structures are affected by fluctuations coming from all the data bins contributing to them , which is particularly important for large folding / unfolding effects like the ones in this example .",
    "as expected , new structures are more affected than the ones initially known by the mc , because the corresponding data fluctuations can locally affect the improved mc transfer matrix .    at this point",
    "one could perform a test of the parameterization of the procedure , directly on the data .",
    "actually one could perform a series of toy simulations of the unfolding , and compare the average of the unfolding results with the result found previously . a significant difference between the two , in any region of the spectrum , would indicate a problem in the parameterization , which should be reconsidered .",
    "an increase of the fluctuation of the unfolding result in the toys with respect to the ones of the data , comparable or larger than the correction performed on new structures ( i.e. by iterations if the first step is trivialized as before ) , would indicate the same kind of troubles .",
    "no such problems were observed in the previous example .",
    "if the study described in the previous subsection , using global distances between the spectra , is not enough sensitive to the values of the unfolding parameters , one can always build toy models for the data ( following [ subsec : building1 ] ) and perform the unfolding as explained before , in order to tune the method .",
    "one can use in the folding the matrix given by the mc , while a statistically fluctuated one will be used in this unfolding .",
    "the bias , used to get the true data , and the remaining background fluctuations , will be choosen such that the folded toy data are qualitatively close to the real ones .",
    "the local comparison of the unfolding result with the toy true data provides an excellent sensitivity to the parameters of the method .",
    "once the method is tuned , the possible ( small ) remaining difference between the unfolding result and the true data can be used to estimate the systematic error of the method .",
    "this difference could even be used to compute a correction of the result , provided that it is stable with respect to statistical fluctuations , the uncertainty of the data true model is smaller than this difference , and if one can not further improve the parameters of the method .    among the functions listed in eq .",
    "( [ f : regfunctions ] ) , ( [ f:1mexp ] ) and ( [ f:1mfrac ] ) , the ones with a null derivative at the origin seem to provide a better separation of fluctuations and real deviations .",
    "the small differences between the results obtained with the several ( well suited ) functions , as well as the ones related to some reasonable changes in the regularization parameter(s ) , can be used to estimate the corresponding systematic errors of the procedure .",
    "there is however at least a partial overlap between this estimation of the systematic error and the one proposed in the previous paragraph .",
    "the systematic errors related to the unfolding are not only dues to the procedure , but also to the knowledge of the folding matrix . the difference between data and mc at this level",
    "can be estimated in practice by detailed studies of events affected by effects that the unfolding procedure must correct .",
    "if the amount of some of these events is different in data and in the simulation , one can even correct the last one .",
    "this could also reduce the correction the unfolding has to bring at the level of the spectra .",
    "one can estimate the uncertainty on the transfer matrix coming from this ( or yet another ) kind of effects / corrections .",
    "performing the unfolding with the transfer matrix modified within these uncertainties allows one to compute the systematic error associated to the final spectrum .",
    "there can indeed also be an overlap between this estimation of the systematic error due to the transfer matrix and the ones previously associated to the unfolding procedure .",
    "we have seen that this unfolding method allows one to unfold structures having a width smaller than the detector resolution . however , these reconstructed structures are for sure affected by the fluctuations of the data bins where their events were initially situated , and by the precision of the knowledge of the transfer matrix .",
    "these two effects put a limit on the quality of the reconstructed structures .",
    "the use of the regularization functions in this method imply non - linear effects in the passage from data to the unfolded spectrum .",
    "this is actually a general feature of the regularization methods used in the unfolding procedures .",
    "it can slightly affect the shape of the error distribution of the unfolded spectrum .",
    "in this example , this type of effect was observed mainly at the edges of the new structures introduced in data , where it is more difficult to distinguish between statistical fluctuations and real significant deviations .",
    "in this section we provide an example that could be closer to the usual applications of this method , namely when the effects of the folding and the data - mc differences are relatively small .",
    "we indicate how the method can be considerably simplified for this kind of application and how one can easily build a test ( or a procedure to set the remaining parameter(s ) ) of the method .",
    "to build this second example we use the same procedure as the one described in subsection [ subsec : building1 ] , but we bring important changes in the spectra and transfer matrix . in order to provide a rather low statistics test of the method , we reduce the global statistics of mc and data by a factor of about 20 ( their relative ratio is equal to 10 , like in the previous example ) .    concerning the transfer matrix , besides this change , we remove the dip around the bin @xmath118 in eq .",
    "( [ eq : tmatrix ] ) and we reduce resolution effects by taking @xmath119 . the effect of systematic transfers of events from high index bins to the lower ones is also reduced by putting @xmath120 and @xmath121 , in eq .",
    "( [ eq : amatrix ] ) .",
    "the `` bias '' of the true data with respect to the true mc is changed to a smaller and a smoother one : @xmath122 , \\label{eq : bias2}\\ ] ] and we do not introduce any remaining background fluctuations in this example .",
    "the errors associated to the data points are simply the statistical ones .",
    "given the fact that the complexity of this test is considerably reduced , with respect to the previous one , a simplified ( next to trivial ) version of the unfolding procedure allows one to perform the needed corrections .",
    "first of all , as in this example there are no significant new structures in the data , the normalization procedure looses its sensitivity and does not indicate any possible improvement at this level .",
    "indeed , one can see this by making a scan of the possible @xmath33 values with fluctuating data , as it was shown in the previous example . in the present case",
    ", the improvement limits interval contains the null value , for any value of the @xmath33 parameter .",
    "one can therefore drop this procedure here , for example by setting @xmath123 ( i.e. by using the standard normalization ) .",
    "the possibility of subtracting remaining background fluctuation is also dropped here . in practice",
    "one can take this decision by comparing the size of the data point errors with respect to the available statistics , or equivalently using the errors introduced by the background subtraction itself .",
    "the possible effect of this simplification in the unfolding strategy can also be tested directly on data , as explained in the previous example .",
    "we will finally use a simplified unfolding procedure using a first step with the initial transfer matrix and a parameter @xmath73 , and an iteration where the transfer matrix is improved and a new unfolding is performed . in this example , one iteration modifying the matrix is enough to correct the systematic data - reconstructed mc differences .        the figure [ fig : simpexunf_data - recomc ] indicates this difference before the unfolding , and after one iteration .",
    "for the example shown here we chosed @xmath124 .",
    "although this choice is not crucial for the effect shown in this figure , its motivation will become clear after the following studies . in order to measure the full potential systematic effect of this iteration",
    ", we set the corresponding parameters : @xmath125 and @xmath126 ( i.e. we perform the maximal change of the transfer matrix and the maximal unfolding correction afterwards ) .",
    "we propose a direct test of the unfolding procedure and its parameterization , searching for potential systematic biases that could be introduced at this level . for this test",
    "we build a toy true and reconstructed data , inspired directly by the original data spectrum and the mc simulation ( which could be directly used in practice ) .",
    "the toy reconstructed data are then unfolded with a transfer matrix ( @xmath127 ) obtained after a fluctuation of the initial one available in practice ( @xmath43 ) .",
    "therefore , the mc for this test is identical to the one in the `` real '' unfolding , up to statistical fluctuations .",
    "we compare the result to the toy true data .",
    "we define the true data known ( @xmath128 ) by the mc as the normalized initial true mc ( obtained from the matrix @xmath43 , without any additional statistical fluctuations ) .",
    "we introduce the data `` known '' by mc , which are the result of the folding of the @xmath128 , using the transfer matrix @xmath43 .",
    "they are identical to the reconstructed mc in the first unfolding step , up to statistical fluctuations between @xmath43 and @xmath127 . as usual",
    ", we add a bias to the true data known by the mc , in order to get the `` true data '' ( @xmath129 ) . in order to build a test as close as possible to the real situation",
    ", the bias is obtained from the difference between data and the normalized initial reconstructed mc , multiplied by a constant factor .",
    "the true data are then folded using the transfer matrix @xmath43 .",
    "we define the reconstructed data as the result of this folding , with or without final statistical fluctuations .",
    "it is interesting to consider here these two variations of the test .",
    "the first one , where the data are fluctuated statistically , is closer to the real unfolding operation and tests the existence of potentially spurious effects due to the limited statistics in the data ( and mc ) .",
    "the second test , allows an easier search for potential systematic effects of the method , which one can look for in the difference between the unfolding result and the true data .    if the multiplicative factor , used to obtain the bias , equals one , the data - `` known data '' difference in this test , is very close to the data - reconstructed mc difference in the real unfolding procedure ( up to final statistical fluctuations ( if any ) , transfer matrix fluctuations and smoothing folding effects ) ( see fig . [",
    "fig : simpextp_data - recomc ] ) .",
    "we consider this factor equal to one in the following test ( if not stated otherwise ) . just as in the `` real unfolding '' ( see fig .",
    "[ fig : simpexunf_data - recomc ] ) all the systematic effects in the data - reconstructed mc difference are corrected after the first iteration .",
    "a test as the one build here is well suited , provided the data - mc difference and the unfolding corrections are relatively small .",
    "we measure the bias of the unfolding result with respect to the true data , after the first step and after one iteration .",
    ".,width=604 ]    at this level one can not observe any systematic bias after the first unfolding step , and the impact of the iteration is very small .    this study was performed for several sets of independently generated data . in practice , one could build several models starting from statistically fluctuated data samples . in order to measure the potential bias , we compute it in larger bins ( each of which contains 40 initial bins ) .",
    "for @xmath73 values up to at least @xmath130 we find maximal relative biases in the interval @xmath131\\%$ ] .",
    "this interval becomes @xmath132\\%$ ] for @xmath133 , @xmath134\\%$ ] for @xmath135 and @xmath136\\%$ ] for very large @xmath73 values ( i.e. when no unfolding correction is done on the data - rmc difference ) .",
    "this study shows that from the point of view of the potential bias remaining after the first unfolding step , the @xmath73 values up to @xmath130 provide very comparable results .",
    "however , the larger the @xmath73 value , the less smoothing is done on the data , as the fraction of their fluctuations kept in their initial bin for the final spectrum is larger , and the bins of the final spectrum are less correlated .",
    "this type of test could also be used to identify situations where the detector transfer matrix is ( almost)singular . such a situation would be encountered for example in the rather pathological situation of a detector with very bad resolution , in which case the data would be compatible with the @xmath137 no matter what @xmath138 distribution was used .",
    "therefore , the unfolding result would also be compatible with any other @xmath138 that was used to build the transfer matrix .",
    "it is at this point that the test described in this subsection comes into play .",
    "using various true data distributions for this test , one would assign a very large systematic error to the unfolding result , making it compatible with any spectrum preserving the number of events .",
    "this would of course indicate that the solution of the unfolding is not well defined .      just as in the case of the previous test , for the `` real '' unfolding",
    ", the first step provides the main systematic correction , while the effect of the iteration is very small ( see fig .",
    "[ fig : simpexunf_impiter ] ) .",
    ".,width=604 ]    the impact of the first iteration on the unfolding result can be seen as another measurement of the systematic error of the method .",
    "just as in the case of the toy test , we measured this effect in larger bins ( each of which contains 40 initial bins ) .",
    "we perform this study for several sets of independently generated data and transfer matrix . for @xmath73 values up to at least @xmath130 we find an averaged maximal ( over 5 large bins ) improvement of the order of @xmath139 with however important relative fluctuations between different data sets .",
    "when increassing @xmath73 , the potential improvement gets larger and more significant with respect to fluctuations .",
    "its value is approximatively @xmath140 for @xmath133 , @xmath141 for @xmath135 , and @xmath142 for very large @xmath73 values .",
    "this confirms the previous conclusion concerning this test , namely that for @xmath143 the first unfolding step provides already a good result , while the iteration(s ) could be useful for larger @xmath73 values .",
    "as explained before , using a larger @xmath73 prevents the unfolding and smoothing of the data fluctuations , keeping the bins less correlated .",
    "this effect can be observed at the level of the diagonal errors of the unfolding result , after one step ( see fig .",
    "[ fig : simpexunf_errors ] ) .",
    "( dotted line ) , for @xmath144 ( solid line ) , and the data errors ( dashed line).,width=604 ]    indeed , the diagonal errors after the first unfolding step for @xmath124 are larger than the ones obtained for @xmath144 , the two being smaller than the ones of the data , due to correlations .",
    "if , after the unfolding , the bin - to - bin correlations enhanced by the transfers of events are too large for the further use of the spectrum , one could decide to compute this spectrum in less correlated , larger bins ( if this would not imply a too large lost of information on the shape of the spectrum ) .",
    "this could be achieved through the use of a different ( smaller ) number of bins for the @xmath138 distribution or by a rebinning operation after the unfolding .",
    "all the functions listed in eq .",
    "( [ f : regfunctions ] ) , ( [ f:1mexp ] ) and ( [ f:1mfrac ] ) yield very similar results for the unfolding in this example , although the suitable regularization parameters can be different for them .",
    "in this paper we introduced an unfolding procedure allowing one to deal with a series of problems that one can meet in practice , and which were not considered by the previous methods . using a regularization function",
    ", one can consistently compare mc with data spectra , even when the last one contain structures which were not initially simulated .",
    "it is the same regularization function that allows one to unfold spectra containing important fluctuations from the background subtraction , without generating biases by the transfer of these events in other regions of the spectrum .",
    "further more , one can dynamically avoid spurious fluctuations of the method when performing iterations to reconstruct structures that were not initially simulated .",
    "this method also allows the user to keep under control the bin - to - bin correlations of the final spectrum , while the needed systematic corrections are performed .",
    "we have described a general unfolding strategy that can be used for rather complicated situations , where all the problems discussed before are present . a simplified strategy has been studied and it can be applied for more common problems .",
    "we have described the way one can build reliable toy tests inspired by data , which can provide a good parameterization of the procedure .",
    "we also propose some tests for the intermediate or final results of the procedure , to be performed directly when unfolding the data .",
    "statistical errors can be directly propagated in this method .",
    "we have proposed several ways of estimating the systematic effects associated to the method , as well as the ones dues to the poor knowledge of transfer matrix .",
    "the c++ source code ( relying on root functionality ) for the unfolding procedure ( and the various described tests ) can be obtained upon request from the author .",
    "several variations of the unfolding strategy and/or intermediate steps , besides the ones mentioned in the text , are possible . in the general strategy",
    ", one could for example simultaneously compute the estimate of the remaining background fluctuations and improve the transfer matrix .",
    "this could be achieved by a straight - forward merging of the formulas [ eq : imprbu ] and [ eq : impra ] , with the use of the same @xmath145 parameter .",
    "one could even place the events from the estimate of the remaining background fluctuations on the diagonal of the transfer matrix . in this case , the corresponding events are not moved by the unfolding , just because they are `` predicted '' to be kept in place by the transfer matrix .",
    "further on , at the different steps of the general unfolding strategy described in this paper ( or of its possible variations ) , one could use different functions or parameters , which would yield an even more general method .",
    "the author would like to thank volker blobel , michel davier , sebastien descotes - genon and andreas hcker for very interesting and useful discussions on these topics , and for a careful reading of this manuscript .",
    "this work was supported in part by the eu contract no",
    ". mrtn - ct-2006 - 035482 , flavianet  .",
    "as the acceptance correction will be performed at the very end , only events passing all the physical cuts will be implicitly considered when computing the quantities in the following definitions :    * @xmath13 = number of bins in the data and in the reconstructed mc distribution * @xmath14 = number of bins in the unfolding result and in the true mc distribution * @xmath42 = the number of simulated events which were generated in the bin @xmath40 and reconstructed in the bin @xmath41 .",
    "* @xmath45 = the probability for an event generated in the bin j to be reconstructed in the bin i ( folding probability matrix , as estimated from the mc simulation ) * @xmath46 = the probability for the `` source '' of an event reconstructed in the bin i to be situated in the bin j ( unfolding probability matrix , as estimated from the mc simulation ) * @xmath35 = rebinning transformation , to pass from data to unfolding bins .",
    "this transformation can be non - linear .",
    "* @xmath36 = inverse rebinning transformation , to pass from unfolding to data bins .",
    "this transformation can be non - linear .",
    "* @xmath146 = number of reconstructed data events in the bin i ( after background subtraction ) * @xmath147 = number of events in the bin i of the data distribution which are potentially due to a fluctuation in the subtracted background * @xmath148 = number of reconstructed data events in the bin i , which do not correspond to structures which are not `` known '' by the mc .",
    "this number is exactly known in a simulation , but only an estimation of it can be computed when unfolding real data . *",
    "@xmath149 = number of true data events , `` known '' by the mc .",
    "this distribution can be computed for toy tests only . * @xmath150 = events corresponding to structures in the true data , which are not simulated in the mc . *",
    "@xmath151 = error of @xmath146 * @xmath17 = number of unfolded events in the bin j * @xmath18 = number of events in the bin j of the unfolded distribution which are potentially due to a fluctuation in the subtracted background * @xmath152 = error of @xmath17 * @xmath153 = number of reconstructed mc events in the bin i * @xmath154 = error of @xmath153 * @xmath155 = number of true mc events in the bin j * @xmath156 = error of @xmath155 * @xmath11 = number of events in the data and , by preservation , in the unfolding result * @xmath10 = number of events in the true and reconstructed mc spectra * @xmath9 = estimate of the number of events in the data , which were simulated in the mc * @xmath0 = regularization function , depending on @xmath1 , the absolute deviation between two values to be compared , @xmath2 , the estimate of the total error to be used for the comparison of the given bin of two spectra , and @xmath5 , a positive regularization parameter .",
    "a.  hocker and v.  kartvelishvili , nucl .",
    "instrum .",
    "a * 372 * , 469 ( 1996 ) [ arxiv : hep - ph/9509307 ] .",
    "v.  blobel , desy 84 - 118 , [ arxiv : hep - ex/0208022 ] .",
    "a.  kondor , jinr - e11 - 82 - 853 .",
    "l.  lindemann and g.  zech , nucl .",
    "instrum .",
    "meth .   a * 354 * , 516 ( 1995 ) . g.  dagostini , nucl .",
    "instrum .",
    "a * 362 * , 487 ( 1995 ) .",
    "d.  acton _ et al . _",
    "[ opal collaboration ] , z.  phys .",
    "c * 59 * , 1 ( 1993 ) .",
    "h.  n.  multhei and b.  schorr , math .",
    "methods appl .",
    "* 9 * , 137 ( 1987 ) .",
    "h.  n.  multhei and b.  schorr , nucl .",
    "instrum .",
    "a * 257 * , 371 ( 1987 ) . c.  amsler et al .",
    ", physics letters b667 , 1 ( 2008 ) available on the pdg www pages ( url : http://pdg.lbl.gov/ )"
  ],
  "abstract_text": [
    "<S> we propose a new iterative unfolding method for experimental data , making use of a regularization function . </S>",
    "<S> the use of this function allows one to build an improved normalization procedure for monte carlo spectra , unbiased by the presence of possible new structures in data . </S>",
    "<S> we are able to unfold , in a dynamically stable way , data spectra which can be strongly affected by fluctuations in the background subtraction and simultaneously reconstruct structures which were not initially simulated . </S>",
    "<S> this method also allows one to control the amount of correlations introduced between the bins of the unfolded spectrum , when the transfers of events correcting the systematic detector effects are performed .    </S>",
    "<S> unfolding , iterations    lal 09 - 107 + </S>"
  ]
}