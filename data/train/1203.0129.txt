{
  "article_text": [
    "in several modern engineering application areas , there are important physical phenomena whose dynamic model is induced or strictly related to the structure of a graph that models the interaction among components of the main system .",
    "for example , in multi - agent system control ( e.g. , distributed robotics , sensor networks or smart power grids ) a communication or interaction graph induces the structure of the feedback control input . in markov chains",
    "the evolution of the probabilities of a finite number of states can be modeled as a dynamical system structured according to the graph of one - step transition probabilities .",
    "similarly , in quantum computation the evolution of interacting particles obeying to quantum laws may be described by differential equations structured according to an interaction graph .",
    "another area in which a dynamic model is related to a graph structure is the one of discretized partial differential equations . in this case",
    "the graph determined by the discretization rule induces the structure of the approximating ordinary differential equations .    in this paper",
    "we will concentrate on linear time invariant dynamical systems whose state matrix is induced by the laplacian of a fixed undirected graph . in particular , we consider @xmath0-dimensional grid graphs , also know as _",
    "lattices_. this graph topology appears in many important application scenarios as we show in the next sections .",
    "we investigate the eigenstructure of the grid graph laplacian in terms of structural properties of the graph , and study how this structure affects the controllability and observability properties of the induced system .",
    "our main goal is to relate the controllability and observability properties to graph theoretic rules involving simple arithmetic operations on the graph labeling .",
    "controllability of complex network systems has received a widespread attention in the last years in several areas @xcite .",
    "we organize the relevant literature in three parts according to the three main motivating scenarios for our problem set - up .",
    "first , a system with laplacian state dynamics arises in network systems running an _ average consensus _ algorithm . a survey on these algorithms and their performance may be found in @xcite and references therein .",
    "the controllability problem for a leader - follower network was introduced in @xcite for a single control node .",
    "intensive simulations were provided showing that it is `` unlikely '' for a laplacian based consensus network to be completely controllable . in @xcite , see also @xcite , `` necessary and sufficient '' conditions are provided to characterize the controllability and observability of path and cycle graphs in terms of simple rules from number theory . in @xcite and @xcite , see also @xcite , necessary conditions for controllability , based on suitable properties of the graph , are provided .",
    "other contributions on the controllability of network systems can be found in @xcite .",
    "observability has been studied for the first time in @xcite , where necessary conditions for observability , as in the dual controllability setting investigated in @xcite and @xcite , are provided .",
    "a parallel research line investigates slightly different properties called _ structural controllability _ , @xcite , and _ structural observability _ , @xcite . here , the objective is to choose the nonzero entries of the consensus matrix ( i.e. the state matrix of the resulting network system ) in order to obtain observability from a given set of nodes .",
    "it is worth noting that controllability and observability of a network system are necessary structural properties in many interesting network problem as estimation , intrusion detection and formation control , e.g. , @xcite .",
    "second , continuous time quantum walks can be modeled as linear time invariant systems whose state matrix is the imaginary skew - hermitian matrix @xmath1 , where @xmath2 is called hamiltonian and can be either the adjacency matrix or the laplacian of the transition graph @xcite .",
    "the state transfer problem ( which is strictly related to the controllability problem ) for quantum systems is investigated in @xcite .",
    "the paper explores the eigenstructure of the hamiltonian ( which is taken as the adjacency matrix of the underline graph ) to characterize the state transfer .",
    "a key reference establishing a connection between our controllability analysis and the controllability of quantum walks is @xcite .",
    "here the controllability of continuous time quantum walks is investigated and related to the controllability of a linear time invariant system with the structure considered in our paper .",
    "the controllability of continuous time quantum walks on graphs is also studied in @xcite and @xcite .",
    "more specifically , @xmath0-dimensional grid or lattice graphs play an important role in quantum computation .",
    "the controllability problem on this specific graph structure has been investigated in @xcite and @xcite .",
    "third and final a system with the structure studied in the paper appears when discretizing partial differential equations ( pdes ) containing the laplace operator @xcite .",
    "such systems include several diffusion and wave propagation equations appearing in fluid - dynamics , mechanics , acoustics and electromagnetism . in @xcite discretization of pdes",
    "was indicated as a motivating example for the analysis of the laplacian eigenstructure .",
    "the controllability of a discretized version of the heat equation on a one dimensional grid domain is investigated in @xcite and extended to the case of constrained input in @xcite .",
    "finally , in @xcite and @xcite trajectory planning of multi - agent systems is performed by studying a partial differential equation describing a continuum of agents .",
    "that is , the multi - agent dynamics is obtained as a discretized version of a partial differential equation .",
    "controllability is guaranteed by the particular choice of the control nodes .",
    "a more general choice of the control nodes leads to our controllability problem .",
    "the contribution of the paper is threefold .",
    "first , we identify a mathematical framework , namely the controllability and observability of linear time invariant systems induced by the laplacian of a grid graph , that has numerous applications in several engineering areas .",
    "in particular , we highlight how this framework appears in distributed control , quantum computation and discretized partial differential equations .",
    "second , we characterize the structure of the laplacian eigenvectors of a grid .",
    "namely , we show that , on the basis of a prime number factorization of the grid dimensions , the eigenvector components present symmetries related to suitable partitions of the main grid into sub - grids that we call _ bricks_. given a partition of the grid graph into bricks , we show that the eigenvalues of the elementary brick are also eigenvalues of the main grid . also , the grid eigenvectors associated to the common eigenvalues are obtained by composing ( with suitable flip operations ) the corresponding eigenvectors of the basic brick .",
    "furthermore , we show that in each brick ( and thus also in the main grid ) the eigenvector components may show symmetries with respect to one or more of the grid axes .",
    "third and final , we provide necessary and sufficient conditions to completely characterize the controllability and observability of grid graphs .",
    "we start showing that loss of controllability and observability can be studied by identifying all the zero components of an eigenvector . based on the evaluation of suitable sets of polynomials , together with the eigenvector symmetries , we are able to determine all and only the eigenvector components that can be set to zero simultaneously .",
    "thus , on the basis of the node labels , the eigenvector symmetries and the polynomial evaluations , we provide easily implementable routines to : ( i ) identify all and only the controllable ( observable ) nodes of the graph , ( ii ) say if the graph is controllable ( observable ) from a given set of nodes and ( iii ) construct a set of control ( observation ) nodes from which the graph is controllable ( observable ) .",
    "the paper is organized as follows . in section  [ sec : prelims ] we introduce preliminary definitions and properties of undirected graphs , set up the controllability and observability problems and describe the motivating scenarios for our framework . in section  [ sec : simple_grids ] we characterize the controllability and observability for grid graphs with simple eigenvalues . in section  [ sec : general_grids ] we analyze the symmetries in the structure of the grid graph eigenvectors . on this basis , in section  [ sec : general_grids_observ ] we provide necessary and sufficient conditions for the controllability ( observability ) of general grid graphs . finally , in appendix we recall results from @xcite on the controllability ( observability ) of path graphs .    [ [ notation ] ] notation +",
    "+ + + + + + +    let @xmath3 denote the natural numbers , for @xmath4 we let @xmath5 be the @xmath6-th element of the canonical basis , e.g. @xmath7^t$ ] . for a vector @xmath8 we denote @xmath9 the @xmath6th component of @xmath10 so that @xmath11^t$ ] .",
    "we denote @xmath12 the permutation matrix reversing all the components of @xmath10 so that @xmath13^t$ ] ( the @xmath14-th column of @xmath15 is @xmath16_j= e_{n - j+1}$ ] ) . adopting the usual terminology of number theory",
    ", we say that @xmath17 is a _ factor _ of @xmath18 if there is an integer @xmath19 such that @xmath20 . given two integers @xmath21 and @xmath22 ,",
    "if an integer @xmath18 is a factor of @xmath23 , we write @xmath24 .",
    "we denote @xmath25 the _ greatest common divisor _ of two positive integers @xmath26 and @xmath21 .",
    "in this section we present some preliminary terminology on graph theory , introduce the network model , set up the controllability and observability problems and provide some standard results for linear systems that will be useful to prove the main results of the paper .",
    "let @xmath27 be a static undirected graph with set of nodes @xmath28 and set of edges @xmath29 .",
    "we denote @xmath30 the set of neighbors of agent @xmath6 , that is , @xmath31 , and @xmath32 the degree of node @xmath6 .",
    "the degree matrix @xmath33 of the graph @xmath34 is the diagonal matrix defined as @xmath35_{ii } = { \\textup{\\text{d}}}_i$ ] .",
    "the adjacency matrix @xmath36 associated to the graph @xmath34 is defined as @xmath37_{ij } = \\begin{cases }    1 & \\text{if}~ ( i ,",
    "j)\\in e\\\\    0 & \\text{otherwise}. \\end{cases}\\ ] ] the laplacian @xmath38 of @xmath34 is defined as @xmath39 .",
    "the laplacian is a symmetric positive semidefinite matrix with @xmath17 eigenvalues in @xmath40 , where @xmath17 is the number of connected components of @xmath34 .",
    "if the graph is connected the eigenvector associated to the eigenvalue @xmath40 is the vector @xmath41^t$ ] .",
    "next , we introduce the notion of cartesian product of graphs .",
    "let @xmath42 and @xmath43 be two undirected graphs .",
    "the cartesian product @xmath44 is a graph with vertex set @xmath45 ( i.e. the cartesian product of the two vertex sets ) and edge set defined as follows .",
    "nodes @xmath46\\in i\\times i'$ ] and @xmath47\\in i\\times i'$ ] are adjacent in @xmath48 if either @xmath49 and @xmath50 or @xmath51 and @xmath52 .",
    "the cartesian product is commutative and associative .",
    "thus , a @xmath53 dimensional product graph , @xmath54 , is constructed by combining the above definition with the associative property .",
    "we introduce the special graphs that will be of interest in the rest of the paper . a _ path graph _",
    "is a graph in which there are only nodes of degree two except for two nodes of degree one .",
    "the nodes of degree one are called external nodes , while the other are called internal nodes . from now on , without loss of generality , we will label the external nodes with @xmath55 and @xmath56 , and the internal nodes so that the edge set is @xmath57 .    a @xmath0-dimensional _ grid graph _ ( or _ lattice graph _ ) is the cartesian product of @xmath0 paths ( of possibly different length ) . in a grid",
    "graphs the nodes have degree from @xmath0 up to @xmath58 .",
    "we call the nodes with degree @xmath0 _ corner nodes_. corner nodes are obtained from the product of external nodes in the paths . given a @xmath0-dimensional grid graph @xmath59 , we denote @xmath60 $ ] a node of @xmath34 , where the component @xmath61 identifies the position of the node on the @xmath62th path . also , given a laplacian eigenvector of the @xmath34 , @xmath63 , we say `` the component @xmath64 $ ] of @xmath65 '' meaning `` the component @xmath66 of @xmath65 '' .",
    "next , we introduce the class of systems that we investigate in the paper . informally , we consider linear time invariant systems whose state matrix is the laplacian of a grid graph , the input matrix is obtained by directly controlling a subset of the node dynamics and the output matrix by observing a subset of the node states .",
    "formally , let @xmath67 be a grid graph , @xmath68 and @xmath69 , a first order dynamical system induced by @xmath34 , @xmath70 and @xmath71 is the system @xmath72 where @xmath73 is a scalar , @xmath38 is the laplacian of @xmath34 , @xmath74 and @xmath75 .",
    "it is a well known result in linear systems theory that the observability properties of the state - output pair @xmath76 correspond to the controllability properties of the state - input pair @xmath77 .",
    "thus , the controllability and observability analysis for the class of systems in can be performed by using the same tools .",
    "we start with some notation .",
    "the set of states that are controllable is the _",
    "controllable subspace _ and will be denoted @xmath78 . respectively ,",
    "the set of initial states that produce an identically zero output is the _ unobservable subspace _ and will be denoted @xmath79 .",
    "an important result on the controllability ( observability ) of time - invariant linear systems is the popov - belevitch - hautus ( pbh ) lemma , e.g. @xcite . combining the pbh lemma with the fact that the state matrix is symmetric ( therefore diagonalizable ) the following lemma follows .",
    "let @xmath80 , @xmath81 and @xmath82 , @xmath83 , be the state , input and output matrices of a linear time - invariant system , where @xmath84 is symmetric .",
    "then , the unobservable subspace @xmath79 associated to the pair @xmath85 ( respectively the orthogonal complement to the controllable subspace @xmath78 associated to the pair @xmath86 ) is spanned by vectors @xmath87 satisfying for some @xmath88 @xmath89 that is , the basis vectors of @xmath79 ( @xmath90 ) are the eigenvectors of @xmath84 with zero in the @xmath91-th , @xmath92 , @xmath93-th ( @xmath94-th , @xmath92 , @xmath95-th ) components . [ lmm : pbh_eigvec ]    in the rest of the paper we will denote the eigenvalues and eigenvectors for which holds _ uncontrollable _ ( respectively , _ unobservable _ ) _ eigenvalues and eigenvectors_.    the controllability ( observability ) analysis for @xmath17-th order integrators of the form @xmath96 is equivalent to the analysis of the first order system .",
    "the statement follows , for example , by writing the conditions in lemma  [ lmm : pbh_eigvec ] for the @xmath17-th order integrator system and exploiting its block structure .",
    "next , we show three main areas of application for our results .",
    "we consider a collection of agents labeled by a set of identifiers @xmath97 , where @xmath98 is the number of agents .",
    "we assume that the agents communicate according to a _ time - invariant undirected _ communication graph @xmath27 , where @xmath99 . the agents run a consensus algorithm based on a laplacian control law ( see e.g. @xcite for a survey ) .",
    "the dynamics of the agents evolve in continuous time ( @xmath100 ) and are given by @xmath101 for the controllability analysis , we consider a scenario in which some of the nodes have the possibility to apply an additional input that fully controls its dynamics .",
    "we call these nodes _ control nodes_. this turns to be the model of a leader - follower network . for the observability analysis",
    ", we imagine that an external processor ( _ not _ running the consensus algorithm ) collects information from some nodes in the network .",
    "we call these nodes _ observation nodes_. in particular , we assume that the external processor may read the state of each observation node .",
    "equivalently , we can think of one or more observation nodes , running the consensus algorithm , that have to reconstruct the state of the network by processing only their own state .",
    "these two scenarios are captured by the model in equation .",
    "straightforward results from linear system theory can be used to prove that the controllability problem studied in @xcite and @xcite and the dual observability problem studied in @xcite can be equivalently formulated in our set up .",
    "dynamic systems induced by the laplacian of a graph appear also in dealing with quantum and random walks @xcite .",
    "we concentrate on the quantum counterpart of random walks , which have recently received great attention in the area of ( quantum ) information theory .",
    "the general idea of quantum information and computation is to solve common problems in information theory by using axioms and rules derived from quantum theory .",
    "specifically , quantum walks are a computational variant of random walks in which the transition probability among the states follows quantum laws as opposed to standard stochastic laws .",
    "formally , for quantum mechanical systems which are closed ( i.e. , not interacting with the environment ) and finite dimensional , one considers the schrdinger equation @xmath102 where @xmath103 is the quantum state and the hamiltonian matrix @xmath104 is hermitian and depends on a control @xmath105 .",
    "continuous time quantum walks are quantum systems whose dynamics is defined on a graph @xmath34 .",
    "specifically , the hamiltonian has the form @xmath106 where @xmath107 is the adjacency matrix or the laplacian of a given graph @xmath34 .",
    "the connection with our results appears for quantum walks on a grid ( or lattice ) graph with @xmath107 being the grid laplacian .",
    "the resulting dynamics is @xmath108 in @xcite it is shown that the controllability of the above system , expressed by a lie algebra rank condition , is equivalent to the controllability of the linear system . our analysis is strictly related to the line pursued in @xcite of finding more easily verifiable graph theoretic tests .",
    "next , we show how the discretization of partial differential equations containing the laplace operator gives rise to an ordinary differential equation whose controllability and observability can be studied by using the tools developed in the paper .",
    "let @xmath109 be a twice differentiable real valued function , then the laplace operator of @xmath110 is @xmath111 .",
    "this operator has a key importance in several physical phenomena .",
    "in particular , it appears in the heat and fluid flow diffusion , in wave propagation and quantum mechanics .",
    "specifically , the density ( temperature ) fluctuations of diffusing material ( heat ) are described by the partial differential equation @xmath112 where @xmath113 is the density of the diffusing material ( respectively the temperature ) at location @xmath114 and time @xmath115 , @xmath33 is the diffusion coefficient ( respectively the thermal diffusivity ) and @xmath116 is a material ( heat ) source . the wave propagation , arising in acoustics , electromagnetism and fluid dynamics , is described by the partial differential equation @xmath117 with @xmath113 the wave amplitude at @xmath114 and time @xmath115 , @xmath22 a constant , and @xmath116 a forcing term .    if we consider a regular discretization of a @xmath118 dimensional hyper - rectangular domain , e.g. @xmath119\\times [ x_2^{min } , x_2^{max}]$ ] , for @xmath120 and @xmath121 , @xmath122 } = [ x_1^{min } + i h , x_2^{min } + j h]$ ] , where @xmath123 is the discretization step , then the discretization of the laplacian operator becomes @xmath124},t ) ) \\approx   [ - l \\",
    ", \\phi^d(t)]_{[i , j]},\\ ] ] where @xmath38 is the laplacian of an @xmath125 grid graph and the vector @xmath126 has components @xmath127}(t ) = \\phi(x_{[i , j]},t)$ ] .",
    "with this approximation in hands , the discretized versions of the partial differential equations above are ordinary differential equations with the same structure as in .",
    "in this section we characterize the controllability and observability properties of the simple eigenvalues of the grid , namely the eigenvalues of multiplicity one .",
    "an important property of graphs obtained as the cartesian product of other graphs is that the laplacian can be obtained from the laplacian of their constitutive graphs by using the kronecker product of two matrices , see @xcite . given two matrices @xmath128 and @xmath129 , with @xmath130_{ij}:= a_{ij}$ ] , their kronecker product @xmath131 is defined as @xmath132 and their kronecker sum as @xmath133 given the cartesian product of the graphs @xmath134 with laplacian matrices @xmath135 , the laplacian @xmath136 of @xmath137 is given by @xmath138 this structure on the laplacian induces a structure also on its eigenvalues and eigenvectors .",
    "we state it in the next lemma , see @xcite .",
    "[ lmm : eigstruc_cartesian_prod ] let @xmath134 be @xmath53 undirected graphs and @xmath139 their cartesian product .",
    "let @xmath140 be the laplacian eigenvalues of the graphs @xmath141 and @xmath142 the corresponding eigenvectors for @xmath143 .",
    "the laplacian eigenvalues and the corresponding eigenvectors of @xmath34 are @xmath144 for @xmath145 .",
    "we are now ready to define a simple cartesian product graph .",
    "let @xmath34 and @xmath146 be two undirected graphs and let @xmath147 and @xmath148 be the sets of distinct eigenvalues among all the laplacian eigenvalues of respectively @xmath34 and @xmath146 .",
    "we say that the graph @xmath149 is _ simple _ if the set @xmath150 contains only distinct eigenvalues .    using the associative property of the cartesian product the definition easily generalizes to the product of more than two graphs .",
    "we start with a lemma that relates the controllability ( observability ) of simple eigenvalues of a grid from a single node to the controllability ( observability ) of its constitutive paths .",
    "[ lmm : unobs_siso ] let @xmath151 , @xmath53 , be path graphs of length respectively @xmath152 and let @xmath153 .",
    "any simple eigenvalue @xmath154 of the grid graph @xmath34 is not controllable ( observable ) from a node @xmath64 $ ] , @xmath155 , @xmath92 , @xmath156 , if and only if there exists @xmath157 such that the eigenvalue @xmath158 of @xmath159 is not controllable ( observable ) from @xmath160 .    from lemma  [ lmm : pbh_eigvec ]",
    "the eigenvalue @xmath161 of the grid graph is not controllable ( observable ) from a node @xmath162 $ ] if and only if a laplacian eigenvector @xmath163 of @xmath161 has zero @xmath64 $ ] component .",
    "using lemma  [ lmm : eigstruc_cartesian_prod ] and the assumption that @xmath161 is a simple eigenvalue , any eigenvector @xmath65 of @xmath161 can be written as @xmath164 , where @xmath165 , @xmath166 , and @xmath167 are eigenvectors of the constitutive paths . using the structure of the kronecker product of @xmath0 vectors ,",
    "the @xmath168 $ ] component of @xmath65 is zero if and only if at least one @xmath169 , @xmath170 , has zero @xmath160 component . indeed , @xmath171 } = \\rho ( v_1)_{i_1}\\cdot \\ldots \\cdot     ( v_d)_{i_d}$ ] which is zero if and only if there exists @xmath170 such that @xmath172 . from lemma  [ lmm : pbh_eigvec ] @xmath172 if and only if the eigenvalue @xmath173 of @xmath159 is not controllable ( observable ) from @xmath160 , thus concluding the proof .    from the previous lemma and lemma  [ lmm : pbh_eigvec ]",
    "the next proposition follows straight .",
    "a simple grid @xmath174 is controllable ( observable ) from a node @xmath175 $ ] if and only if each path @xmath159 is controllable ( observable ) from node @xmath160 .",
    "using the property that any path graph is controllable ( observable ) from each external node , @xcite , the next corollary follows .",
    "any simple eigenvalue of a grid graph is controllable ( observable ) from any corner node .",
    "we are now ready to characterize the controllability ( observability ) of simple grid graphs .",
    "[ thm : main_thm_simple_grid ] let @xmath151 be @xmath0 path graphs of length respectively @xmath176 and let @xmath153 be a simple grid .",
    "the following statements hold .    1 .",
    "the grid graph @xmath34 is not controllable ( observable ) from a node @xmath177 $ ] , @xmath155 , @xmath92 , @xmath156 , if and only if there exists @xmath178 such that @xmath179 for some odd prime @xmath180 dividing @xmath181 ; 2 .   for any direction @xmath170 of @xmath34 the following holds . for each odd prime factor @xmath180 of @xmath181 ,",
    "the grid is not controllable ( observable ) from the set of nodes @xmath182\\in i \\;|\\ ;   ( i)_\\ell = j \\ ,    p-\\frac{p-1}{2 } , { j\\in{\\{1,\\dots,\\frac{n}{p}\\ } } } , \\;\\text{and}\\ ; ( i)_1 , \\ldots,(i)_{\\ell-1 } ,      ( i)_{\\ell+1 } , \\ldots , ( i)_d \\;\\text{arbitrary}\\}$ ] , with the following uncontrollable ( unobservable ) eigenvalues @xmath183 and uncontrollable ( unobservable ) eigenvectors @xmath184 with @xmath185 , and @xmath186 , respectively @xmath187 , @xmath188 , any arbitrary eigenvalue , respectively eigenvector , of @xmath189 ; 3 .",
    "if a node @xmath175 $ ] satisfies for @xmath190 distinct directions and , in each direction @xmath191 , for @xmath192 distinct prime factors , then the set of uncontrollable ( unobservable ) eigenvalues from node @xmath6 is the union of eigenvalues with the following structure @xmath193 where each @xmath194 is an uncontrollable ( unobservable ) eigenvalue of path @xmath159 from @xmath160 and has the structure given in theorem  [ thm : main_thm_path ] ( iv ) and remark  [ rmk : general_main_thm_path ] in appendix .",
    "the corresponding uncontrollable ( unobservable ) eigenvectors can be built according to equation .",
    "the proof of statement ( i ) follows straight by combining the result of lemma  [ lmm : unobs_siso ] with the result in ( i ) of theorem  [ thm : main_thm_path ] .    to prove statement ( ii ) , we start observing that , for each @xmath170 , the set of nodes @xmath195 is the set of all nodes satisfying condition in for a given @xmath180 in the path @xmath159 . using theorem  [ thm : main_thm_path ] , we have that the uncontrollable ( unobservable ) eigenvalues of @xmath159 from this set of nodes have the form in . now , according to lemma  [ lmm : eigstruc_cartesian_prod ] all the @xmath196 as in are eigenvalues of the grid . also , the corresponding eigenvectors are the ones given in . using the result in lemma  [ lmm : unobs_siso ] ,",
    "these eigenvectors have a zero in position @xmath197 $ ] with @xmath160 satisfying and @xmath198 arbitrary . to conclude the proof , we show that these are the only uncontrollable ( unobservable ) eigenvectors . to do that ,",
    "we show that there exist nodes in @xmath199 for which the only zero component is @xmath160 .",
    "for example , take any node with index @xmath200 $ ] with @xmath160 satisfying .",
    "since any path is controllable ( observable ) from the first node , the proof follows .    statement ( iii ) follows straight by combining the results in the previous two points with theorem  [ thm : main_thm_path ] .",
    "next , we show , on the basis of the results in theorem  [ thm : main_thm_simple_grid ] , how to check the controllability ( observability ) of a simple grid from a given set of nodes or , equivalently , how to construct a set of control ( observation ) nodes such that the grid is controllable ( observable ) . for the sake of clarity we present the procedure for a two dimensional grid ( @xmath118 ) ,",
    "however the procedure can be easily generalized to higher dimensions .",
    "first , we introduce some notation . given two sets @xmath201 $ ] and @xmath202 $ ] with @xmath203 \\in { { \\mathbb{r}}}\\times{{\\mathbb{r}}}$ ] and @xmath204 \\in { { \\mathbb{r}}}\\times{{\\mathbb{r}}}$ ] , we say that @xmath205 if there exists @xmath206\\in x$ ] and @xmath207\\in y$ ] such that @xmath206=[y_{1,\\bar{\\mu}},y_{2,\\bar{\\mu}}]$ ] , i.e. @xmath208 and @xmath209 .",
    "consider a two dimensional simple grid graph @xmath210 with @xmath211 and @xmath212 of dimension @xmath213 and @xmath214 respectively .",
    "let , for each @xmath215 , @xmath216 be a prime number factorization for some @xmath217 and odd prime numbers @xmath218 .",
    "let @xmath219 be a set of control ( observation ) nodes with @xmath220 $ ] , @xmath221 .",
    "now , we construct @xmath18 sets @xmath222 that will be used to define a simple rule for controllability ( observability ) . for the sake of clarity we provide the rule to construct a set @xmath223 for a specific case . the general case can be easily deduced from the example .",
    "suppose that @xmath224 satisfies condition for @xmath225 and @xmath226 along direction @xmath55 and for @xmath227 along direction @xmath228 .",
    "now , define the set @xmath223 as follows .",
    "@xmath229 { \\cup}\\ldots { \\cup}[p_{1,1 } , p_{2,k_2}]{\\cup}[p_{1,2 } , p_{2,1 } ] { \\cup}\\ldots { \\cup}[p_{1,2 } , p_{2,k_2 } ] { \\cup}[p_{1,1 } , p_{2,3 } ] { \\cup}\\ldots    { \\cup}[p_{1,k_1 } , p_{2,3 } ] .",
    "\\end{split}\\ ] ] we call @xmath222 a controllability ( observability ) partition of the set @xmath230 .",
    "the following proposition gives an easily implementable test for controllability ( observability ) .",
    "let @xmath231 be a simple grid graph and @xmath230 a set of control ( observation ) nodes with controllability ( observability ) partition @xmath222 .",
    "then @xmath34 is controllable ( observable ) from @xmath230 if and only if @xmath232 .",
    "the grid is controllable ( observable ) from the set @xmath230 if and only if the intersection of the sets of uncontrollable ( unobservable ) eigenvalues from each node is empty ( equivalently if the intersection of the uncontrollable ( unobservable ) subspaces is the zero vector ) . using statement ( iii ) of theorem  [ thm : main_thm_simple_grid ] the uncontrollable ( unobservable ) eigenvalues from each node are the ones in equation .",
    "let @xmath233 , with @xmath234 eigenvalue of @xmath211 and @xmath235 eigenvalue of @xmath212 , be a common eigenvalue to all the nodes in @xmath230 . using the property in ( iii )",
    ", a node @xmath236 \\in i_s$ ] can have that uncontrollable ( unobservable ) eigenvalue either because it is uncontrollable ( unobservable ) along one of the two paths or along both .",
    "equivalently either @xmath234 is an uncontrollable ( unobservable ) eigenvalue for @xmath211 from node @xmath237 and/or @xmath235 is an uncontrollable ( unobservable ) eigenvalue for @xmath212 from node @xmath238 .",
    "now , using the result in statement ( ii ) of theorem  [ thm : main_thm_path ] , all the nodes in a control ( observation ) set @xmath239 are uncontrollable ( unobservable ) if and only if all of them belong to a set @xmath240 for some factor @xmath180 of @xmath213 ( @xmath213 being the length of @xmath211 ) .",
    "the same argument holds for a control ( observation ) set @xmath241 on the path @xmath212 .",
    "this implies that the controllability ( observability ) on a path @xmath242 can be studied by checking if all the nodes in the control ( observation ) set @xmath243 share a common prime factor .",
    "now , each point in the set @xmath223 , @xmath221 , is of the form @xmath244 $ ] where @xmath245 and @xmath246 are prime factors of @xmath213 and @xmath214 ( the lengths of @xmath211 and @xmath212 ) respectively and at least one of the prime factors , say @xmath245 , is such that @xmath247 .",
    "thus , each element in the set @xmath223 correspond to set of eigenvalues @xmath248 ( with @xmath249 or / and @xmath250 ) .",
    "the proof follows by observing that the controllability ( observability ) condition is that the intersection of the sets @xmath251 be empty .",
    "the following examples can be easily explained by using the proposition above .",
    "if at least one of the control ( observation ) nodes , say @xmath94 , is controllable ( observable ) in any direction , then the grid is controllable ( observable ) .",
    "indeed , the set @xmath252 will be empty .",
    "if all @xmath181 , @xmath170 , are prime , then the grid is controllable ( observable ) if and only if one of the control ( observation ) nodes is controllable ( observable ) in any direction .",
    "indeed , any @xmath223 , @xmath221 , can be either @xmath253\\}$ ] or @xmath254 .",
    "next , we show a graphical interpretation of the controllability ( observability ) test based on the controllability ( observability ) partition . we present it through an example . in figure",
    "[ fig : grid_7x15 ] we show a two dimensional grid of length @xmath255 . it can be easily tested that this grid is simple . in each direction @xmath215 , for each prime factor of @xmath256 we associate a unique symbol to the rows ( columns ) of nodes that satisfy for that prime number ( in that direction ) .",
    "in particular , for the grid in figure  [ fig : grid_7x15 ] , we associate a cross to the columns satisfying for the prime factor @xmath257 of @xmath258 , a triangle to the columns satisfying for the prime factor @xmath259 of @xmath258 , and a pentagon to the unique row satisfying for the prime number @xmath260 .     grid graph . ]    clearly , all the nodes that are not crossed by any line are controllable ( observable ) .",
    "also , a subset of nodes from which the graph is controllable ( observable ) can be easily constructed by suitably combining the different symbols .",
    "equivalently , given a set of control ( observation ) nodes , testing the associated symbols easily gives the controllability ( observability ) property from the given set of nodes .",
    "for example , from the pair of nodes @xmath261 $ ] and @xmath262 $ ] the grid is not controllable ( observable ) .",
    "indeed , the partitions are @xmath263 $ ] and @xmath264 { \\cup}[5,7]$ ] whose intersection is @xmath265 $ ] .",
    "the uncontrollable ( unobservable ) eigenvalues are , according to theorem  [ thm : main_thm_simple_grid ] , @xmath266 , @xmath267 and @xmath268 .",
    "following the same logic the grid is controllable ( observable ) form the set @xmath269 $ ] and @xmath270 $ ] , but it is not controllable ( observable ) from @xmath269 $ ] , @xmath271 $ ] and @xmath272 $ ] ( and from any subset of them ) .",
    "we let the reader play with it and have fun .",
    "in order to characterize the controllability and observability of general grid graphs we need to exploit their eigenstructure . indeed , the main difference with respect to the simple case analysis relies in the structure of the uncontrollable ( unobservable ) eigenvectors . while for simple grids they can be always written as the kronecker product of two eigenvectors of the path ( because the eigenvalues are all simple )",
    ", this property does not hold for the eigenvectors of non - simple grids .",
    "thus , the controllability ( observability ) analysis can not be performed by simply looking at how the zeros of the path eigenvectors propagate into the grid .",
    "indeed , this analysis provides only necessary conditions for controllability ( observability ) .",
    "this section will be organized as follows .",
    "first , we characterize symmetries in the structure of the grid eigenvectors .",
    "this analysis allows us to recognize the components of the eigenvectors that have to be equal .",
    "second , we provide conditions to show what are all and only the components that are zero when a given component is forced to zero . thus , with this results in hand , we are able to provide _ necessary and sufficient _ conditions for controllability ( observability ) .",
    "we begin by characterizing symmetries of the path eigenvectors and then , using these results , we characterize symmetries of the grid eigenvectors by suitable grid partitions . for the sake of clarity we provide the analysis and results for two dimensional grids ( @xmath118 ) .",
    "the results for higher dimensions are based on the same arguments and will be discussed in a remark .",
    "we provide results on the structure and symmetries of the laplacian eigenvectors of a path graph .",
    "the next lemma characterizes the symmetry of the path laplacian eigenvectors .",
    "[ lem : sym_path_eigvec ] any eigenvector @xmath10 of the laplacian of a path graph satisfies either @xmath273 or @xmath274 , with @xmath15 the usual permutation matrix .",
    "let @xmath275 be the laplacian of the path .",
    "straightforward calculations show that @xmath38 satisfies @xmath276 .",
    "now , let @xmath10 be a laplacian eigenvector , then @xmath277 . multiplying both sides by @xmath15 ( and remembering that @xmath278 ) , we get @xmath279 , so that @xmath280 is also an eigenvector of @xmath38 associated to the eigenvalue @xmath161 .",
    "since any eigenvalue of @xmath38 has multiplicity one , it must hold @xmath281 , for some nonzero @xmath282 . using the fact that the linear map @xmath15 is an isometry ( i.e. it preserves the norm ) , @xmath283",
    ", it follows straight that either @xmath284 or @xmath285 , which concludes the proof .    in the rest of the paper we will denote @xmath286 ( respectively @xmath287 ) the set of vectors satisfying @xmath288 ( respectively @xmath289 ) .",
    "an important property of @xmath286 and @xmath287 is that one is the orthogonal complement of the other , i.e. @xmath290 .    the next lemma relates the eigenstructure of a given path @xmath291 to the eigenstructure of any path with length multiple of the length of @xmath291 .",
    "[ lmm : sym_path_eigvec_multiple ] let @xmath292 be the eigenvalues of the laplacian @xmath293 of a path @xmath294 of length @xmath56 and @xmath295 the corresponding eigenvectors .",
    "then any path @xmath296 of length @xmath297 , for some @xmath298 , with laplacian matrix @xmath299 satisfies :    1 .",
    "@xmath292 are eigenvalues of @xmath299 ; 2 .",
    "each eigenvector @xmath300 of @xmath299 associated to @xmath301 , @xmath302 , has the form @xmath303    for the sake of clarity we prove the statement for @xmath304 , but the proof for the general case is easily generalizable . the laplacian @xmath305 can be written in terms of @xmath293 , whose structure is given in appendix , as @xmath306      -e_1 e_n^t & l_n + e_1 e_1^t + e_n e_n^t & -e_n e_1^t\\\\[1.2ex ]      0 & -e_1 e_n^t & l_n + e_1 e_1^t    \\end{bmatrix}.\\ ] ] now , let us write the eigenvector @xmath307 associated to @xmath301 as @xmath308 , with @xmath309 , @xmath310 and @xmath311 in @xmath312 .",
    "thus @xmath307 satisfies @xmath313      l_n v_b + e_1 \\big ( ( v_b)_1 - ( v_a)_n \\big ) + e_n \\big ( ( v_b)_n - ( v_c)_1 \\big ) \\\\[1.2ex ]      l_n v_c + e_1 \\big ( ( v_c)_1 - ( v_b)_n \\big )    \\end{bmatrix}\\ ] ] now let us take @xmath314 , @xmath315 and @xmath316 , then @xmath317        e_1 \\big ( ( \\pi v_i)_1 - ( v_i)_n \\big ) + e_n \\big ( ( \\pi v_i)_n - ( v_i)_1 \\big ) \\\\[1.2ex ]        e_1 \\big ( ( v_i)_1 - ( \\pi v_i)_n \\big )      \\end{bmatrix }      = \\lambda_i w_i .    \\end{split}\\ ] ] last equality follows by the fact that @xmath318 and @xmath319 ( in general @xmath320 for any @xmath321 ) .    exploiting the result in the above lemma by using the result in lemma  [ lem : sym_path_eigvec ] , it follows easily that @xmath322 for @xmath323 ( and thus @xmath324 ) and @xmath325 for @xmath326 ( and thus @xmath327 ) .",
    "next , we provide tools to recognize symmetries in the grid eigenvectors , based on the graph structure , which will play a key role in the controllability ( observability ) analysis .    without loss of generality ,",
    "let @xmath328 be an eigenvalue of geometric multiplicity @xmath329 , with @xmath330 ( respectively @xmath331 ) eigenvalues of @xmath211 ( respectively @xmath212 ) and corresponding eigenvectors @xmath332 ( respectively @xmath333 ) .",
    "the corresponding eigenspace @xmath334 is given by @xmath335    as mentioned at the beginning of this section , it is worth noting that the eigenvectors in @xmath336 do not necessarily have the structure of a kronecker product of two eigenvectors ( the set of vectors expressed as kronecker product is not closed under linear combination ) .",
    "for this reason , in order identify all and only the zero components of these eigenvectors , we need to characterize their structure .    for each node",
    "@xmath337 $ ] such that the paths @xmath211 and @xmath212 are controllable ( observable ) from @xmath338 and @xmath191 respectively , all the basis eigenvectors of @xmath336 have nonzero @xmath337 $ ] component .",
    "before stating the main results of this section , we need to introduce some useful notation . given a path @xmath339 of length @xmath98 , for @xmath340 , @xmath341",
    ", we denote @xmath342 the sub - path of @xmath294 with node set @xmath343 ( e.g. , @xmath344 is the sub - path with node set \\{2,3,4 } ) .",
    "let @xmath345 with @xmath346 of dimension @xmath347 and @xmath348 of dimension @xmath349 .",
    "we call @xmath350 , for @xmath351 and @xmath352 , an @xmath353 sub - grid or a _ brick _ of @xmath34 , see figure  [ fig : subgrid_partition ] .",
    "( 220,130 )    ( 10,10)(1,0)250 ( 10,40)(1,0)250 ( 10,100)(1,0)250 ( 10,130)(1,0)250    ( 10,10)(0,1)120 ( 50,10)(0,1)120 ( 90,10)(0,1)120 ( 220,10)(0,1)120 ( 260,10)(0,1)120    ( 0,20 ) ( 0,70 ) ( 0,110 ) ( 22,110 ) ( 62,110 ) ( 232,110 )    ( 22,20 ) ( 62,20 ) ( 232,20 )    ( 25,135 ) ( 65,135 ) ( 125,135 ) ( 235,135 )    let @xmath354 be a vector of @xmath34 , we call the _ sub - vector of @xmath10 associated to @xmath355 _ the vector @xmath356 with components @xmath357}$ ] , @xmath358 and @xmath359 , given by @xmath360 } = ( v)_{[(i\\text{-}1 ) n_1\\text{+}\\nu , \\,(j\\text{-}1 )    n_2\\text{+}\\ell]}$ ] . informally , the sub - vector @xmath361 of @xmath10 is constructed by selecting the components of @xmath10 that fall into the brick @xmath355 .",
    "next , given a grid @xmath362 , with @xmath363 and @xmath364 paths of length @xmath213 and @xmath214 respectively , we introduce two useful operators that flip the components of a vector @xmath10 associated to a grid @xmath34 .",
    "formally , consider the matrices @xmath365    &    \\iddots & \\\\[1.2ex ]    i_{n_2 } & \\ldots & 0_{n_2\\times n_2}\\\\[1.2ex ] \\end{bmatrix } \\ ; \\text{and } \\;\\ ; ( i_{n_1}\\otimes \\pi_{n_2 } ) = \\begin{bmatrix }   \\pi_{n_2 } & \\ldots & 0_{n_2\\times n_2}\\\\[1.2ex ]    & \\ddots & \\\\[1.2ex ]    0_{n_2\\times n_2 } & \\ldots & \\pi_{n_2}\\\\[1.2ex ] \\end{bmatrix}. \\ ] ] these operators flip respectively the first and the second sets of components .",
    "formally , given a vector @xmath366 associated to the grid @xmath34 , with components @xmath367}$ ] , @xmath358 and @xmath359 , let @xmath368 and @xmath369 .",
    "the vectors @xmath370 and @xmath371 are related to @xmath10 by @xmath372 } = ( v)_{[n_1-\\nu+1 , \\,\\ell ] } , \\;\\ ; \\text{and } \\;\\ ; ( v_2)_{[\\nu , \\,\\ell ] } = ( v)_{[\\nu , \\,n_2-\\ell+1]},\\ ] ] for @xmath358 and @xmath359 .",
    "finally , the composition of the two operators satisfies @xmath373 .",
    "thus , when applied to a vector @xmath10 , the composed operator flips both sets of components . that is , denoting @xmath374 , we have @xmath375 } = ( v)_{[n_1-\\nu+1 , \\",
    ", n_2-\\ell+1]},\\ ] ] for @xmath358 and @xmath359 .",
    "let @xmath376 with @xmath363 and @xmath364 paths of length respectively @xmath213 and @xmath214 .",
    "any eigenvalue @xmath161 of the laplacian @xmath377 of @xmath378 is an eigenvalue of the laplacian @xmath38 of @xmath379 for any @xmath380 and @xmath381 .",
    "[ lmm : eigs_g0_g ]    from lemma  [ lmm : eigstruc_cartesian_prod ] , each eigenvalue @xmath382 of @xmath378 ( respectively @xmath161 of @xmath34 ) can be written as @xmath383 ( @xmath233 ) where @xmath384 ( @xmath234 ) is an eigenvalue of @xmath363 ( @xmath346 ) and @xmath385 ( @xmath235 ) of @xmath364 ( @xmath348 ) . from lemma  [ lmm : sym_path_eigvec_multiple ]",
    "all the eigenvalues of @xmath363 ( @xmath364 ) are eigenvalues of @xmath346 ( @xmath348 ) so that the proof follows .",
    "we are now ready to characterize the eigenvector symmetries by suitable brick partitions .",
    "[ thm : subgrid_partition ] let @xmath376 be a grid of dimension @xmath125 with @xmath363 and @xmath364 paths of dimension",
    "respectively @xmath213 and @xmath214 . take any grid @xmath345 of dimension @xmath386 and let @xmath355 , @xmath351 and @xmath352 , be a partition into bricks of dimension @xmath353 .",
    "then for each eigenvalue ( possibly non - simple ) @xmath161 of @xmath377 :    1 .",
    "@xmath161 is an eigenvalue of @xmath38 , and 2 .",
    "any eigenvector @xmath10 of @xmath38 associated to @xmath161 can be decomposed into sub - vectors @xmath361 relative to the bricks @xmath355 with @xmath387 for @xmath388 and @xmath389 , where @xmath390 is an eigenvector of @xmath377 associated to @xmath161 .",
    "statement  ( i ) follows straight by lemma  [ lmm : eigs_g0_g ] . to prove statement  ( ii ) , first",
    ", let us recall that the matrices @xmath391 and @xmath392 applied to the vectors @xmath390 respectively flip the first and second components .",
    "also , @xmath393 for @xmath6 odd ( respectively @xmath394 for @xmath14 odd ) .",
    "thus , we can just prove the result for @xmath395 and @xmath396 .",
    "let @xmath397 be the geometric multiplicity of the eigenvalue @xmath161 for the laplacian @xmath38 .",
    "then , by lemma  [ lmm : eigstruc_cartesian_prod ] , a basis of the associated eigenspace @xmath336 is given by @xmath397 vectors obtained as the kronecker product of eigenvectors of the constitutive path graphs .",
    "that is , @xmath398 where @xmath399 and @xmath307 , @xmath400 are eigenvectors of respectively @xmath363 and @xmath364 associated to eigenvalues @xmath401 and @xmath402 such that @xmath403 . exploiting the kronecker product and using the result in lemma  [ lmm : sym_path_eigvec_multiple ] , we have @xmath404^t .        \\end{split}\\ ] ] clearly , the brick @xmath405 coincides with the grid @xmath378 .",
    "thus , we can compare the bricks @xmath355 with the brick @xmath405 .",
    "the sub - eigenvector corresponding to the `` first row '' of the brick @xmath405 is given by @xmath406}:=    \\begin{bmatrix }      ( v_{11})_{[1,1]}\\\\      \\vdots\\\\      ( v_{11})_{[1,n_1]}\\\\    \\end{bmatrix }    = \\alpha_i ( v_i)_1 w_i\\ ] ] using the definition of brick components , the sub - eigenvectors corresponding to the `` first row '' of the grid @xmath407 is @xmath408}:=      \\begin{bmatrix }        ( v_{12})_{[1,1]}\\\\        \\vdots\\\\        ( v_{12})_{[1,n_1]}\\\\      \\end{bmatrix }      = \\alpha_i ( v_i)_1 \\pi w_i      =       \\alpha_i ( v_i)_1      \\begin{bmatrix }        ( w_i)_n\\\\        \\vdots\\\\        ( w_i)_1\\\\      \\end{bmatrix }      =      \\begin{bmatrix }        ( v_{11})_{[1,n_1]}\\\\        \\vdots\\\\        ( v_{11})_{[1,1]}\\\\      \\end{bmatrix}.    \\end{split}\\ ] ] the proof for the other components follows exactly the same arguments .",
    "the above theorem has a nice and intuitive graphical interpretation , as shown in figure  [ fig : grid_partition_s11 ] .    ]",
    "given a grid @xmath34 and an eigenvector @xmath10 associated to an eigenvalue @xmath161 , we can associate a symbol to each node depending on the value of the eigenvector component .",
    "then , we partition the grid @xmath34 into bricks of dimension @xmath353 . given the symbols in the brick @xmath405 , the symbols in a brick @xmath409 , for @xmath351 and @xmath410 , are obtained by a reflection of the brick @xmath411 with respect to the horizontal axis , while the symbols in a brick @xmath409 , for @xmath412 and @xmath352 , are obtained by a reflection of the brick @xmath413 with respect of the vertical axis .",
    "next , we analyze the eigenvector components of a brick whose dimensions are prime or , equivalently , the components of eigenvectors associated to eigenvalues that are not eigenvalues of smaller bricks . recalling that any path eigenvector @xmath10 satisfies either @xmath288 ( @xmath414 ) or @xmath274 ( @xmath415 ) ,",
    "we show how : ( i ) each basis eigenvector has a symmetry induced by the symmetry of the path eigenvectors , and ( ii ) the structure of a general grid eigenvector is influenced by the symmetry of the basis eigenvectors .",
    "[ prop : subgrid_sym ] let @xmath376 be a grid of dimension @xmath125 . for any eigenvalue @xmath161 ,",
    "let @xmath336 be the associated eigenspace , with structure as in equation .",
    "then , each basis eigenvector generating @xmath336 , @xmath416 , satisfies one of the four relations : @xmath417    using the result in lemma  [ lem : sym_path_eigvec ] , @xmath399 and @xmath307 belong either to @xmath286 or @xmath287 , that is , e.g. , either @xmath323 or @xmath418 .",
    "suppose that , for example , @xmath419 and @xmath420 . under this assumption @xmath421 and , using the distributive property of the kronecker product @xmath422 .",
    "also , @xmath423 .",
    "this gives the second of the four relations .",
    "the other three cases follow by the other three possible combinations of the symmetries of @xmath399 and @xmath307 , thus concluding the proof .    in the following",
    "we denote the set of vectors satisfying each one of the four relations in the proposition respectively as @xmath424 , @xmath425 , @xmath426 and @xmath427 .",
    "a graphical representation of the four sets is given in figure  [ fig : single_subgrid ] .",
    "+    we associate a symbol to each node depending on the value of the eigenvector component .",
    "also , we denote with the same symbol but different colors nodes that have components of opposite sign . the result in proposition  [ prop : subgrid_sym ]",
    "can be easily explained by using this graphical interpretation .",
    "namely , each of the four cases in the proposition correspond to a scheme in figure  [ fig : single_subgrid ] .",
    "the next remark gives an insight on the eigenvector components of the `` central '' nodes of a grid with odd dimensions .",
    "if the grid has odd dimensions , @xmath213 and @xmath214 , the above symmetries have interesting implications for the nodes with components respectively @xmath428 $ ] , @xmath429 , and @xmath430 $ ] , @xmath431 .",
    "indeed , the first set of components is zero for @xmath426 and @xmath427 , while the second one is zero for @xmath425 and @xmath427 .",
    "this proposition has an important impact on the symmetries of general eigenvectors belonging to the same eigenspace ( and in particular for each brick of a general grid ) .",
    "clearly , if an eigenvalue is simple , then any associated eigenvector has the structure of a kronecker product and thus one of the four symmetries . for a non - simple eigenvalue",
    ", any eigenvector of @xmath336 can be written as a linear combination of the basis vectors , and thus , using the proposition , by the sum of at most four vectors each one having one of the four symmetries .",
    "thus , in order to identify the symmetries of a general vector , we need to `` suitably combine '' nodes with the same symbol and color in different classes .",
    "three cases are possible : ( i ) if basis vectors of at least three different classes are present , by inspection in figure  [ fig : single_subgrid ] , no symmetries are present , ( ii ) if all basis vectors belong to the same class , then also the linear combination does , and ( iii ) if the basis vectors belong to two of the four classes , a general eigenvector @xmath10 ( obtained as their linear combination ) satisfies the following symmetries :    * @xmath432}=\\pm ( v)_{[n_1-\\nu+1 , \\ell]}$ ] if the two classes share the first symbol ( e.g. , @xmath424 and @xmath425 ) ; * @xmath432}=\\pm ( v)_{[\\nu , n_2-\\ell+1]}$ ] if the two classes share the second symbol ( e.g. , @xmath424 and @xmath426 ) ; * @xmath432}=\\pm ( v)_{[n_1-\\nu+1 , n_2-\\ell+1]}$ ] if the two classes share no symbol ( e.g. , @xmath424 and @xmath427 ) .",
    "a graphical representation of the above three symmetries is depicted in figure  [ fig : general_eigvecs_sym ] .",
    "we associate the same symbol to nodes having the same absolute value of the eigenvector component .",
    "it is worth noting that we are interested in the absolute values because we want to classify all the components that can be zeroed simultaneously .",
    "in this section we provide necessary and sufficient conditions to characterize all and only the nodes from which the network system is controllable ( observable ) .",
    "first , we need a well known result in linear systems theory , see , e.g. , @xcite . we state it for the controllability property .",
    "[ lmm : unobs_multi_eigs ] if a state matrix @xmath433 , @xmath98 , has an eigenvalue with geometric multiplicity @xmath434 , then for any @xmath435 with @xmath436 the pair @xmath86 is uncontrollable .",
    "the previous lemma applied to the grid laplacian says that , in case the grid is non simple with maximum eigenvalue multiplicity @xmath397 , then the grid is not controllable ( observable ) from a set of control ( observation ) nodes of cardinality less than @xmath397 .    using lemma  [ lmm : pbh_eigvec ]",
    ", it follows straight that we can study the controllability ( observability ) properties of the grid separately for each eigenvalue .",
    "namely , to guarantee controllability ( observability ) , we need to show that for each eigenvalue of the grid laplacian @xmath38 , there does not exist any eigenvector satisfying the condition in , i.e. having zero in some components .",
    "if @xmath161 is simple , the corresponding eigenspace @xmath336 in is given by @xmath437 thus , finding the zeros of any eigenvector in @xmath336 is equivalent to finding the zeros of the eigenvectors @xmath370 and @xmath438 and propagate them according to the kronecker product structure .",
    "clearly , with this observation in hand , the analysis of any simple eigenvalue can be performed by using the tools provided in section  [ sec : simple_grids ] .",
    "for eigenvalues with multiplicity greater than one , next two considerations are important .",
    "first , not all the eigenvectors of @xmath161 have the structure of a kronecker product .",
    "second , consistently with lemma  [ lmm : unobs_multi_eigs ] , it is always possible to find an eigenvector @xmath439 with an arbitrary component equal to zero , for a suitable choice of the coefficients @xmath440 in .",
    "thus , the controllability ( observability ) analysis does not depend only on the zero components of the path eigenvectors , but also on the symmetries in the grid eigenvector components .",
    "that is , for the eigenvalue under investigation , we want to answer to the following question .",
    "if we find an eigenvector with zero in an arbitrary component @xmath191 , what are all and only the other components that are zero in the chosen eigenvector ?",
    "we provide the analysis for non - simple eigenvalues of multiplicity two and discuss the generalization in a remark .    on the basis of the eigenvector symmetries identified in theorem  [ thm : subgrid_partition ]",
    ", we can study the controllability ( observability ) of a brick .",
    "next lemma provides useful properties of the eigenvector components in a brick .",
    "[ lmm : poly_components ] let @xmath376 be a grid of dimension @xmath125 .",
    "then , any laplacian eigenvector @xmath441 of the grid , with @xmath10 and @xmath65 respectively eigenvectors of @xmath363 and @xmath364 associated to eigenvalues @xmath442 and @xmath443 , has components @xmath444}$ ] , @xmath358 and @xmath359 satisfying    1 .",
    "@xmath444 } = p_\\nu(\\lambda_v ) \\cdot p_{\\ell}(\\lambda_w ) \\cdot ( v)_1      \\cdot ( w)_1 $ ] , where @xmath445 is the polynomial of degree @xmath446 defined as @xmath447 for @xmath448 and , denoting @xmath449 , by the recursion @xmath450 for @xmath451 ; 2 .   if @xmath213 and @xmath214 prime , then @xmath452 and @xmath453 for any @xmath454 and @xmath455 .",
    "first , notice that @xmath444 } = ( v)_\\nu \\cdot ( w)_\\ell$ ] . to prove statement  ( i ) , we need to prove that for a path of length @xmath213 , any eigenvector @xmath10 satisfies @xmath456 for @xmath457 .",
    "we prove the statement by induction .",
    "we exploit the eigenvector relation @xmath458 by using the structure of the path laplacian given in appendix . from the first row",
    ", it follows that @xmath459 , so that @xmath460 .",
    "then , from the @xmath461th row of the relation , we have @xmath462 and thus @xmath463 . plugging in the inductive assumption @xmath464 and @xmath465 , we have @xmath466 with @xmath467 which concludes the first part of the proof .",
    "statement  ( ii ) can be proven by showing that , for a path graph of length @xmath213 with @xmath213 prime , any eigenvector @xmath10 has non zero components @xmath468 , @xmath92 , @xmath469 .",
    "this result is proven in @xcite , thus concluding the proof .",
    "next theorem gives necessary and sufficient conditions for two eigenvector components to be both zero in a brick .",
    "[ thm : poly_ratios ] let @xmath376 be a grid of dimension @xmath125 .",
    "let @xmath470 be an eigenvalue of multiplicity two , with @xmath471 and @xmath472 ( @xmath473 and @xmath474 ) eigenvalues of @xmath363 ( @xmath364 ) .",
    "let @xmath334 be the associated eigenspace .",
    "then there exists an eigenvector @xmath475 with zero components @xmath476 $ ] and @xmath477 $ ] , @xmath478 and @xmath479 , if and only if @xmath480 where @xmath445 is the polynomial of degree @xmath481 defined by the recursion in equation .",
    "to prove the statement , we look for an eigenvector @xmath482 with @xmath483 and @xmath484 such that @xmath485 } = 0 $ ] and @xmath486 } = 0 $ ] .",
    "the condition @xmath485 } = 0 $ ] is equivalent to @xmath487 . from lemma  [ lmm : poly_components ] ( i )",
    "we have @xmath488 . using the same calculations for the condition @xmath486 } = 0 $ ] ,",
    "we can write the matrix equation @xmath489        p_{\\nu_2}(\\lambda_{1,1 } ) p_{\\ell_2}(\\lambda_{1,2 } ) ( v_1)_1 ( w_1)_1 \\ ; & \\ ;        p_{\\nu_2}(\\lambda_{2,1 } ) p_{\\ell_2}(\\lambda_{2,2 } ) ( v_2)_1 ( w_2)_1       \\end{bmatrix }        \\begin{bmatrix }         \\alpha_1\\\\         \\alpha_2       \\end{bmatrix }       = 0 .",
    "\\label{eq : poly_matrix}\\ ] ] since @xmath10 is an eigenvector , @xmath483 and @xmath484 can not be zero simultaneously .",
    "thus , the above equation is satisfied if and only if the matrix is singular . imposing the condition that the determinant be zero gives equation  .",
    "if the grid is of dimension @xmath490 the above theorem extends in a straightforward manner .",
    "indeed , the result in lemma  [ lmm : poly_components ] ( i ) can be easily generalized as @xmath491 } =    p_{i_1}(\\lambda_{i_1 } ) \\cdot \\ldots",
    "\\cdot p_{i_d}(\\lambda_{i_d } ) \\cdot ( v_1)_1    \\cdot \\ldots \\cdot ( v_d)_1 $ ] , with suitable adaptation of the notation , so that the condition in equation   follows straight",
    ".    if the grid has an eigenvalue of multiplicity @xmath492 , then the theorem generalizes by considering @xmath397 nodes .",
    "the condition in equation   follows by setting to zero the determinant of a @xmath493 version of the matrix in with elements @xmath494 given by @xmath495 .",
    "next , we show a graphical interpretation of the controllability ( observability ) results obtained by combining the results of theorem  [ thm : main_thm_simple_grid ] , theorem  [ thm : subgrid_partition ] , proposition  [ prop : subgrid_sym ] and theorem  [ thm : poly_ratios ]",
    ". we present it through an example . in figure  [ fig:4x6 ]",
    "we show a two dimensional grid of length @xmath496 . the analysis for the simple eigenvalues can be performed as explained in section  [ sec : simple_grids ] .",
    "this gives the cross symbol in the set of nodes @xmath497 $ ] and @xmath498 $ ] , @xmath499 in figure  [ fig:4x6 ]  ( b ) .",
    "then , we partition the grid into bricks of dimensions @xmath500 and @xmath501 .",
    "the eigenvalue @xmath502 ( respectively @xmath503 ) is an eigenvalue of multiplicity two in the brick @xmath500 ( @xmath501 ) .",
    "the eigenvectors generating @xmath504 ( @xmath505 ) belong to @xmath425 and @xmath426 ( @xmath424 and @xmath427 ) .",
    "this gives the symmetries in figure  [ fig:4x6 ]  ( a ) according to proposition  [ prop : subgrid_sym ] and the subsequent discussion .",
    "using theorem  [ thm : poly_ratios ] it is easy to verify that all different symbols in figure  [ fig:4x6 ]  ( a ) correspond , in fact , to distinct component values . replicating the brick symbols according to theorem  [ thm : subgrid_partition ] we get the structure in figure  [ fig:4x6 ]  ( b ) .",
    "notice that in this particular case we have used the same cross symbol both for the non - simple eigenvalue @xmath506 and for the simple eigenvalues .",
    "finally , it can be easily tested that @xmath502 and @xmath503 are the only two non - simple eigenvalues .",
    "given a set of control ( observation ) nodes , the grid is controllable ( observable ) if and only if the nodes do not have any symbol in common .",
    "if , for example , the control ( observation ) nodes share the top symbol , then the eigenvalue @xmath507 ( of the brick @xmath500 ) is uncontrollable ( unobservable ) . as for the simple case we let the reader play with the rule .    to conclude , we provide a discussion on the importance and the effectiveness of the proposed methodologies in studying the controllability and observability ( in general the dynamics ) of grid graph induced systems .",
    "first , we want to stress the fact that the proposed tools give strong insights on the structure and symmetries of the grid eigenvectors and of the controllable ( unobservable ) subspaces , as shown , e.g. , in the above example .",
    "furthermore , the proposed tools represent , clearly , an effective alternative to the standard tests in checking the controllability and observability properties . notice that , the pbh test in lemma  [ lmm : pbh_eigvec ] ( to be performed for each eigenvalue ) becomes prohibitive as the dimensions of the grid grow . similarly , inspecting the rank of the controllability",
    "( observability ) matrix is an operation that is ill - conditioned as the matrix dimension grows . as opposed to it ,",
    "our tools involve the following operations .",
    "the test on the simple eigenvalues can be done simultaneously by using the tools in section  [ sec : simple_grids ] and involves only arithmetic operations from number theory .",
    "the analysis for non - simple eigenvalues involves the following operations .",
    "first , using theorem  [ thm : subgrid_partition ] , the grid can be partitioned into bricks of prime dimensions .",
    "this operation is based on a straightforward prime number factorization .",
    "second , one has to compute the non simple eigenvalues for each brick .",
    "this can be done by using lemma  [ lmm : eigstruc_cartesian_prod ] and the closed form expression for the path eigenvalues given in appendix .",
    "third , for each multiple eigenvalue , one has to inspect the symmetries in each brick ( again with simple operations on the brick dimensions according to proposition  [ prop : subgrid_sym ] ) and the possible coincidence of symbols ( by means of polynomial evaluations from theorem  [ thm : poly_ratios ] ) .",
    "finally , one should verify if there are multiple eigenvalues of the main grid that are not eigenvalues of smaller bricks .",
    "however , so far we have never found such a case in simulations , so that we conjecture that this is unlike or even impossible to happen .",
    "in this paper we have characterized the controllability ( by duality the observability ) of linear time - invariant systems whose dynamics are induced by the laplacian of a grid ( or lattice ) graph .",
    "we have shown that these systems arise in several fields of application as , in particular , distributed control and estimation , quantum computation and approximate solution of partial differential equations .",
    "we have characterized the eigenstructure of the grid laplacian in terms of suitable graph decompositions and symmetries , and in terms of simple rules from number theory . based on this analysis ,",
    "we have shown what are all and only the uncontrollable ( unobservable ) set of nodes and provided simple routines to choose a set of control ( observation ) nodes that guarantee controllability ( observability ) .",
    "in this section we briefly recall the results in @xcite , see also @xcite , on the controllability ( observability ) of path graphs .",
    "the characterization of the controllability ( observability ) for grid graphs relies on these results .",
    "the controllability ( observability ) of the path can be analyzed by using the pbh lemma in the form expressed in lemma  [ lmm : pbh_eigvec ] .",
    "first , it is known , @xcite , that a path graph is always controllable ( observable ) from an external node ( @xmath55 or @xmath56 ) . next theorem , which is theorem  4.4 in @xcite , completely characterizes the controllability ( observability ) of a path by means of simple rules from number theory .      1 .",
    "the path is not completely controllable ( observable ) from a node @xmath513 if and only if @xmath514 for some odd prime @xmath180 dividing @xmath56 ; 2 .",
    "the path is not completely controllable ( observable ) from a set of nodes @xmath515 if and only if @xmath516 for some odd prime @xmath180 dividing @xmath56 ; 3 .",
    "[ pt : set_unobs_p ] for each odd prime factor @xmath517 of @xmath56 , the path is not controllable ( observable ) from each set of nodes @xmath518 with the following uncontrollable ( unobservable ) eigenvalues @xmath519 and uncontrollable ( unobservable ) eigenvectors @xmath520 where @xmath521 is the eigenvector of @xmath522 corresponding to the eigenvalue @xmath523 for @xmath524 ; and 4 .",
    "if node @xmath6 belongs to @xmath525 for @xmath526 distinct prime factors @xmath527 of @xmath56 , then the set of uncontrollable ( unobservable ) eigenvalues from node @xmath6 is given by @xmath528 also , the orthogonal complement to the controllable subspace , @xmath529 , ( respectively the unobservable subspace , @xmath79 ) is spanned by all the corresponding eigenvectors of the form @xmath530 where @xmath531 is the eigenvector of @xmath532 corresponding to the eigenvalue @xmath523 for @xmath533 .",
    "[ rmk : general_main_thm_path ] in the general case of a path graph of length @xmath534 , where @xmath535 are not all distinct , statement ( i ) and ( ii ) of theorem  [ thm : main_thm_path ] continue to hold in the same form . as regards statement ( iii ) , it still holds in the same form , but it can also be strengthen with a slight modification .",
    "that is , for each multiple factor @xmath536 with multiplicity @xmath537 , the statement continues to hold if @xmath536 is replaced by @xmath538 with @xmath539 .",
    "statement ( iv ) holds if for each prime factor @xmath536 with multiplicity @xmath537 we check if node @xmath6 belongs not only to @xmath540 , but also to each @xmath541 with @xmath539 .",
    "consistently the uncontrollable ( unobservable ) eigenvalues and eigenvectors considered in the statement must be constructed by using @xmath542 instead of @xmath536 , where @xmath543 .",
    "a.  rahmani , m.  ji , m.  mesbahi , and m.  egerstedt , `` controllability of multi - agent systems from a graph - theoretic perspective , '' _ siam journal on control and optimization _ ,",
    "48 , no .  1 ,",
    "162186 , feb 2009 .",
    "s.  martini , m.  egerstedt , and a.  bicchi , `` controllability analysis of networked systems using equitable partitions , '' _ int .",
    "journal of systems , control and communications _ , vol .  2 , no . 1 - 3 , pp .",
    "100121 , 2010 .",
    "b.  liu , t.  chu , l.  wang , and g.  xie , `` controllability of a leader - follower dynamic network with switching topology , '' _ ieee transactions on automatic control _",
    "53 , no .  4 , pp . 10091013 , may 2008 .",
    "z.  ji , z.  wang , h.  lin , and z.  wang , `` controllability of multi - agent systems with time - delay in state and switching topology , '' _ international journal of control _ , vol .",
    "83 , no .  2 ,",
    "371386 , feb 2010 .",
    "s.  sundaram and c.  n. hadjicostis , `` distributed function calculation and consensus using linear iterative strategies . '' _ ieee journal on selected areas in communications : issue on control and communications _ ,",
    "vol .  26 , no .  4 , pp .",
    "650660 , may 2008 .",
    "m.  ji , a.  muhammad , and m.  egerstedt , `` leader - based multi - agent coordination : controllability and optimal control , '' in _ ieee conf .  on decision and control _ , new orleans , la , dec .",
    "2007 , pp . 55945599 .",
    "j.  s. respondek , `` numerical analysis of controllability of diffusive - convective system with limited manipulating variables , '' _ international communications in heat and mass transfer _ ,",
    "934944 , 2007 .",
    "h.  gerhardt and j.  watrous , `` continuous - time quantum walks on the symmetric group , '' in _ approximation , randomization , and combinatorial optimization .",
    "algorithms and techniques _ , ser .",
    "lecture notes in computer science.1em plus 0.5em minus 0.4emspringer berlin / heidelberg , 2003 , vol . 2764 , pp .",
    "845859 .",
    "g.  parlangeli and g.  notarstefano , `` graph reduction based observability conditions for network systems running average consensus algorithms , '' in _",
    "mediterranean conf .  on control and automation _ ,",
    "marrakech , morocco , 2010 ."
  ],
  "abstract_text": [
    "<S> in this paper we investigate the controllability and observability properties of a family of linear dynamical systems , whose structure is induced by the laplacian of a grid graph . </S>",
    "<S> this analysis is motivated by several applications in network control and estimation , quantum computation and discretization of partial differential equations . </S>",
    "<S> specifically , we characterize the structure of the grid eigenvectors by means of suitable decompositions of the graph . for each eigenvalue , based on its multiplicity and on suitable symmetries of the corresponding eigenvectors , we provide necessary and sufficient conditions to characterize all and only the nodes from which the induced dynamical system is controllable ( observable ) . </S>",
    "<S> we discuss the proposed criteria and show , through suitable examples , how such criteria reduce the complexity of the controllability ( respectively observability ) analysis of the grid . </S>"
  ]
}