{
  "article_text": [
    "data are related to physical laws , expressed as equations , through _ models_. to determine the either fundamental , phenomenological , or ` materials ' constants that the model s equations include , the model must first be solved , and explicitly so , to allow the fitting of its constants , through ( bayesian ) regression , to the experimental data .",
    "the inaccurate solution of a model can sometimes contribute significantly to , if not wholly dominate , the fitted values uncertainties .",
    "improvements in the accuracies of solutions can alone motivate the ( re-)determinations of constants from extant ( _ i.e. _  ` old ' ) experimental data .",
    "indeed , the method of solution presented in this paper s section [ sec : method ] is subsequently exploited , in section [ sec : permdet ] , to determine the values of certain dielectric constants from the frequencies at which an electromagnetic resonator was found to resonate experimentally ; here , the ` _ _ modeling errors _ _ ' dominate over other uncertainties .",
    "once all relevant physical constants are known to sufficient accuracy , a model s solution can be exploited in the reverse sense to _ simulate _ as - yet unrealized experimental embodiments .",
    "simulation enables the properties of a proposed embodiment to be predicted and , thus , through modifications , for its performance ( with respect to a given application ) to be optimized _ without _ , or at least at reduced , experimental effort .",
    "sufficient accuracy in the model s solution itself is , again , vital .",
    "though analytical models can adequately treat certain highly symmetrical structures , the sufficiently accurate solution of less symmetrical ( though more practical ) structures typically requires automated numerical computation as implemented on a digital computer . here ,",
    "the model s structure must first be represented in some ` electronic ' format . then , the physical equations , often including sets of partial - differential ones , are encoded and solved for the boundary conditions and constitutive relations that the structure implies . though these two tasks can be implemented by hand - coding in low - level computer languages , highly developed commercial software packages now exists to facilitate both : ( i ) computer - aided - design ( cad ) tools and ( ii ) partial - differential - equation ( pde ) solvers , respectively .",
    "many , though by no means all @xcite , of the latter are based on the finite - element method ( fem ) @xcite , which can readily accept cad - defined structures .",
    "furthermore , various packages now integrate ( i ) and ( ii ) into complete computer - modeling environments , _ e.g. _",
    "` ecad ' for simulating electromagnetic systems .",
    "these environments sport various additional features for accelerating the definition of models and for facilitating the display and analysis ( ` post - processing ' ) of solutions ; they also impose standardized formats and provide ( ` house - keeping ' ) tools to assist in the maintenance , sharing and documentation of a model so that others can subsequently benefit from , and build upon , the original model - developer s effort .",
    "compared to the laborious coding up and piecing together of the equivalent software by hand ( _ e.g. _  as straight matlab or fortran code , making calls to optimized ` canned ' matrix eigensolvers ) , the use of such environments , despite their costs and limitations , is attractive .",
    "a problem associated with the inclusion of a complex model into the determination of a constant , where the model is solved via a piece of commercial ` black - box ' software , or through a proprietary ` in - house ' service , is that the determination may thus cease to be _",
    "traceable_. significant effects ( or ` undocumented features ' ) imparted by the modeling / simulation process may become difficult if not impossible to isolate , understand , or quantify . with regard to traceability , both the model s definition and its chosen method of solution must remain amenable to explicit representation , thus communication , thus external scrutiny .",
    "convenience and/or efficiency demand , furthermore , that this representation be as concise and elegant as possible with no ambiguities .",
    "electromagnetic structures that support whispering - gallery ( wg ) modes are technologically important because of the advantageous properties that these modes exhibit in terms of spatial compactness , frequency control ( either stability or agility ) and mode quality ( @xmath0 ) factor .",
    "explicit examples will be presented and/or referenced in due course .",
    "compared to the abrupt retro - reflection of an electromagnetic wave at the surface of a mirror , the continuous bending of the same by a whispering - gallery waveguide is an alternative , and at that a still relatively underdeveloped one , which is opening up new applications . here",
    ", one is often interested in a _ ` resonator ' _",
    "where the wave s trajectory closes back on ( and the wave thereby interferes with ) itself .",
    "though elliptical @xcite , helical , or even more complex bending trajectories @xcite can be ( and have been ) envisaged in association with the various morphologies of electromagnetic waveguide / resonator that support wg waves , the author restricts himself here to the study of the simplest , and to - date most popular , class of wg - mode resonator : that where the electromagnetic wave s trajectory is a plane circle ( thus constant radius of curvature ) and the electromagnetic structure supporting it is axisymmetric ( and coaxial with respect to the said circle / wg mode ) . within this class , a convex dielectric : vacuum boundary is often the curved interface of choice for guiding / confining the whispering gallery mode around in an circle . the method presented below can , however , also be employed to simulate wg - modes that are guided by a concave dielectric : metal boundaries . in general",
    "then , one considers an axisymmetric toroidal volume , whose cross - section in a ( it matters not which ) radial - axial plane comprises regions of dielectric ( voids correspond to the dielectric vacuum ) that are bounded ( either externally or from within ) by metal surfaces ; see fig .  1 .",
    "despite the breadth and technological allure of this class of wg - mode resonator , it is the author s understanding that most if not all commercial ( ecad ) packages available at the time of writing ( early to mid .",
    "2006 ) suffer from a rather unfortunate ` blind spot ' when it comes to calculating , efficiently ( hence accurately ) , the whispering - gallery modes ( with plane circular trajectories ) that such axisymmetric resonator s support .",
    "the popular mafia / cst package @xcite , with which the author is familiar , is a case in point : as has also been experienced by basu _",
    "et al _ @xcite , and no doubt others , one simply can not configure the software to take advantage of the wg modes _ apriori_-known azimuthal dependence , _ viz . _",
    "@xmath1 , where @xmath2 is a positive integer known as the mode s azimuthal mode order , and @xmath3 is the azimuthal coordinate .",
    "though frequencies and field - patterns can be obtained ( at least for wg modes of low azimuthal mode order ) , the computationally advantageous reduction of the problem from 3d to a 2d that the rotational symmetries of the resonator and its solutions allow is , consequentially , precluded ; and the ability to simulate high - order whispering - gallery modes with sufficient accuracy for metrological purposes is , exasperatingly , lost . about the best one can do is to simulate a ` wedge ' [ over an azimuthal domain @xmath4 wide ] between radial electric and magnetic walls @xcite .    _ from ecad to ` omni - cad ' : _ adding titillation to the exasperation , several commercial packages @xcite based on the fem method are now beginning to offer true ` multiphysics ' capabilities : not only can one separately model a resonator s electromagnetic response , its mechanical response , its thermal response , ... ,",
    "all based on a common , defined - once - and - for - all geometric structure , one can furthermore couple/`extrude'/integrate these responses to model non - linear and/or parametric effects .",
    "these effects include ( as illustrative examples ) : ( i ) the electromagnetic heating of a resonator s lossy dielectrics and/or it resistively conducting inner surfaces ( thus shifts in the frequencies of the resonator s electromagnetic modes ) , and even ( ii ) ` mechanical - kerr ' instabilities / oscillations associated with the mechanical deformation of the resonator s components due to radiation pressure @xcite , as exerted by a driven electromagnetic mode .",
    "this _ nirvana _ of predictive ( + deductive ) capability is , for wg - mode resonators , in view of the alluring applications associated with their nonlinear and/or parametric effects , a particularly tantalizing destination if only one could appropriately configure the ( in - the - first - place sufficiently configurable ) software to get there .",
    "this paper provides a single , though one might claim a quite fundamental , generic , and enabling , step on the long march there to .",
    "the analysis and modeling of the whispering - gallery modes of electromagnetic resonators , at both optical and microwave frequencies , continues to support and guide experimental endeavor @xcite .",
    "a brief and far - from - comprehensive survey of the different methods used to implement these simulations to date , with a strong selective bias towards those that have been applied to the study of microwave dielectric - ring resonators , is provided here .",
    "the author encourages the reader to consult the earlier works that are referenced within the papers cited below .",
    "based on ` separating the variables ' ( sv ) , textbooks @xcite provided expressions for the whispering - gallery modes that are supported by whole dielectric parallelopipeds , right - cylinders , and spheres , or dielectric layers and shells exhibiting the same symmetries thereof , where the dielectric volume is enclosed by electric and/or magnetic walls . illustrating the genre is wilson _ et al _ s handy study of the transverse electric ( te ) and transverse - magnetic ( tm ) modes of right - cylindrical metal cavities @xcite , which was in fact used by the author to validate the weak - form expressions described in sub - section [ subsec : weakforms ] below in the early stages of his work .    by ` mode - matching ' ( mm ) these sv - solutions across boundaries , wg - mode solutions for composite axisymmetric structures , such as a dielectric right cylinder , surrounded immediately by a void , enclosed within a ( coaxial ) right - cylindrical metallic jacket ( _ i.e. _ , a so - called ` can ' ) , can be derived @xcite . these solutions , with their associated discrete / integer indices ( related to symmetries ) ,",
    "provide a nomenclature @xcite for classifying wg modes .",
    "this nomenclature can be re - used to sort and label the lower - order wg modes of less symmetrical though structurally similar resonators , where these modes can only be calculated ` blindly ' through other , more numerical methods .",
    "mode - matching by taking linear combinations of several / many as opposed to just a few basis functions can increase the ` fit ' hence accuracy of the mm - sv method and/or allow it to be extended it to the treatment of deformed structures .",
    "in view of the limited computational effort that these semi - analytical sv - based methods demand , remarkable accuracies can be achieved , especially when the most ` sympathetic ' basis functions are deployed . for many resonators of interest , however , and the composite axisymmetric structures mentioned in the previous paragraph are a case in point , it is not possible , in the mm - sv method ( as based on a _ finite _ set of basis functions ) , to simultaneously match all components of the electric and magnetic fields across all boundaries @xcite to do so would , after all , amount to an exact solution ! with a small , finite basis set , the ` transverse ' ( or ` axial - polarization ' ) approximation , that tolerates a mis - match of ` minor ' field components , whilst consistently matching the major ones , is uncontrolled . though extensions to mode - matching that capture spatially non - uniform polarization can be constructed @xcite , the mm - sv method in general needs to be validated , for a given shape of resonator and mode , through comparison with ( more exact ) solutions supplied by other methods .    for a complete , accurate solution of maxwell s equations",
    ", one must generally resort to wholly numerical methods , of which there are several relevant classes and variants .",
    "apart from the finite - element method ( fem ) itself ( considered in more detail further on ) , the most developed and thus most immediately exploitable alternatives include ( given here for reference not considered in any greater detail ) : ( i ) the ritz - rayleigh variational or ` moment ' methods @xcite , ( ii ) the finite difference time domain method ( fdtd ) @xcite , and ( iii ) the boundary - integral @xcite or bounday - element methods ( bem , including fem - based hybridizations thereof @xcite ) .",
    "zienkiewicz and taylor @xcite , though nominally dedicated to fem , provide a taxonomy ( _ viz .",
    "_  table 3.2 _ loc .",
    "_ ) covering most of these methods , which reveals certain commonalities between them .",
    "it is remarked here , for example , that fdtd may be regarded as a variant of the fem employing local , discontinuous shape functions . in conjunction with these generalities , it is worth re - iterating here that the core formulation presented in this paper ( _ viz .",
    "_  equations [ eq : laplacianweakall ] through [ eq : magneticwallhcylcomp2 ] ) can exploit any pde - solver ( _ e.g. _  a moment - method - based one ) capable of accepting / intepreting weak - form statements . though a fem - based solver ( _ viz .",
    "_  comsol / femlab ) was indeed used to provide the examples presented in section [ sec : exampleapplications ] below , this article s formulation is not , _",
    "per se _ , wedded to fem .",
    "though the finite - element method can solve for all field components ( both major and minor ) , the explicit , direct statement of the required set of a coupled partial differential equations ( _ i.e. _  maxwell s equations for wg - mode electromagnetic resonators ) in component form , suitable for the insertion into a standard commercial fem / ecad software package , can be extremely onerous if not absolutely ruled out by the software s lack of configurability .",
    "this is why the majority of these packages already include pre - defined ` applications modes ' , ` macros ' or ` wizards ' for solving electromagnetic problems ( for particular geometries ) . to simplify the problem to that of a single ( scalar )",
    "pde , one can again [ cf .  the sv - mm method(s ) already discussed above ] invoke the so - called transverse ( axial - polarization ) approximation , where the resonator s either magnetic or electric field is forced to lie everywhere parallel to the resonator s axis of rotational symmetry ; figure b.1 of reference @xcite displays this approximation most pedagogically .",
    "investigations based on this ` transverse - fem ' approach have been reported in several recent works @xcite .",
    "though it can provide indicative trends and quantitative results , which might well be sufficiently accurate and/or robust for the calculation s intended purpose ( in view of even less well controlled experimental parameters ) , the uncontrolled nature of the approximation that transverse - fem incorporates is again far from ideal .",
    "the careful physicist , or metrologist , is ( again ) compelled to justify its validity , for a given resonator and mode , through comparison with either non - trivial analytical solutions , where they exist , or ` brute force ' ( 3d ) numerical computation @xcite .",
    "it is this paper s principal claim that , through only a modicum of extra effort , the transverse approximation , and its associated onerous validations [ or ( else ) lingering doubts ] , can be wholly obviated .",
    "the application of the finite - element method to the solving of maxwell s equations has a history @xcite , and is now very much an industry @xcite .",
    "zienkiewicz and taylor @xcite supply fem s theoretical underpinnings , in particular an erudite account of galerkin s method of so - called ` weighted residuals ' . a pervasive , and often quite debilitating problem that besets the direct/`nave ' applications of fem to the pdes that are maxwell s equations is the generation of ( a great many ) spurious solutions @xcite , associated with the local gauge invariance , or ` null space ' @xcite , which is a ( hidden ) feature of these pdes ( in particular its ` curl ' operators ) .",
    "at least two research groups have nevertheless successfully developed software tools for calculating the wg modes of axisymmetric dielectric resonators , where these tools ( i ) solve for all field components ( _ i.e. _  no transverse approximation is invoked ) , ( ii ) are 2d ( and thus numerically efficient ) and ( iii ) effectively suppress spurious solutions ( without any insidious , detrimental side - effects ) @xcite .",
    "the method reported below sports these same three attributes .",
    "with regard to ( iii ) , the approach adopted by auborg _",
    "et al _ was to use different finite elements ( _ viz .",
    "_ a mixture of ` nedelec ' and ` lagrange ' -both 2nd order ) for different components of the electric and magnetic fields ; osegueda _ et al _ @xcite , on the other hand , used a so - called ` penalty term ' to suppress ( spurious ) divergence of the magnetic field .",
    "stripping away all of its motivating remarks , applications and illustrations , the principal function of this paper is to convert ( one might say ` extract ' ) the method encoded by osegueda _",
    "et al _ s ` cyres ' 2d fem software package @xcite into explicit _ ` weak - form ' _ expressions , that can be directly and _ openly _ ported to _ any _ pde solver ( most notably comsol / femlab ) capable of accepting such .",
    "these weak - form expressions are wholly equivalent to the maxwellian pdes from which they are derived .",
    "but , being scalar ( tensorially - contracted ) , they are considerably less onerous to represent and communicate than the vectorial pdes themselves .",
    "the author hopes that , by stating / popularizing the problem so explicitly in this paper through the _ lingua franca _ of weak form , the means to model , both accurately and traceably , the whispering - gallery modes of axisymmetric resonators will thereby be made accessible to any competent engineer or physicist in need of such a means `off the shelf ' , as opposed to it remaining a strictly ` _ _",
    "in__-house ' ( and thus rather less open and traceable ) capability retained by specialists .",
    "_ scope : _ the types of ideal resonator that fall under the scope of the analysis presented immediately below are those that comprise volumes of lossless dielectric space bounded by a combination of perfect ( thus also loss - less ) electric or magnetic walls see fig .  [ fig : generic_resonator ] ( though note that the restriction to resonators of axisymmetric form needs only to be invoked at the start of subsection [ subsec : axisymmetric ] ) .     and e3 .",
    "the resonator s mirror symmetry through the horizontal ( equatorial ) plane , as indicated by the dashed line m1 , allows an additional either electric or magnetic wall to be placed on it and , thereupon , only one half of the resonator s domain ( either its upper or lower half ) need be simulated . ]    as discussed in subsections [ subsec : walllosses ] through [ subsec : radiationestimators ] below , a dissipative ( open ) resonator s finite fractional energy loss per cycle , hence its sub - infinite @xmath0-factor , can be estimated , and with often perfectly sufficient accuracy with regard to applications , from the solution of an equivalent loss - less ( closed ) resonator .",
    "the resonator s dielectric space will , in general , comprise both voids ( _ i.e. _  the free space of a vacuum ) and space filled by sufficiently ` good ' ( _ i.e. _  low - loss ) dielectric material(s )",
    ". a model s electric walls will translate , in embodiments , to metallic surfaces whose conductivities are sufficiently good to be treated as such ( section [ subsec : walllosses ] quantifies the loss caused by the metallic wall of a particular resonator s can ) .",
    "the ( relative ) permeability of real magnetic materials is seldom high enough for a wall made from such to be regarded , without deleterious approximation , as a ( perfect ) magnetic one .",
    "when modeling resonators whose forms exhibit reflection symmetries , such that the magnetic and electric fields of their solutions exhibit either symmetry or antisymmetry through mirror planes , perfect magnetic and electric walls can be advantageously imposed on the model s mirror plane to solve for particular ` sectors ' of solutions .",
    "the electromagnetic field within the dielectric volumes of the resonator obeys maxwell s equations @xcite , as they are applied to continuous , macroscopic media @xcite .",
    "thus , on the assumption that the resonator s constituent dielectric elements have negligible ( or at least the same ) magnetic susceptibility ( hence permeability ) , the magnetic field strength @xmath5 is continuous across all interfaces between them .",
    "( or @xmath6 ) across internal boundaries between regions of different permeability .",
    "] this property makes it advantageous to solve for @xmath5 ( or the magnetic flux density @xmath7 related to it by a constant global magnetic permeability @xmath8 ) , as opposed to the electric field strength @xmath9 ( or displacement @xmath10 ) . upon substituting one of maxwell s ` curl ' equations equations into the another , the problem reduces to that of solving the ( modified ) vector helmholtz equation @xmath11 subject to appropriate boundary conditions ( read on ) , where @xmath12 is the speed of light . here",
    ", @xmath13 denotes the inverse relative permittivity tensor ; one assumes that the resonator s dielectric elements are linear , such that it is a ( tensorial ) constant _i.e .",
    "_  independent of field strength .",
    "the middle ( penalty ) term on the left - hand side of equation [ eq : helmholtz ] is the same as that used by osegueda _",
    "et al _ @xcite ; it functions to suppress / reveal spurious modes in the finite - element simulation , gave wholly satisfactory results . ]",
    "; the constant @xmath14 controls this term s weight with respect to its maxwellian neigbours .",
    "the penalty term s insertion into the above helmholtz equation is wholly permissible since , for every true solution of maxwell s equation , it must exactly vanish ( everywhere ) : the magnetic flux density @xmath6 , hence ( for non- or isotropically - magnetic media ) @xmath15 , is required to be free of divergence assuming no magnetic monopoles lurk inside the resonator .",
    "reference  @xcite ( particular section 1.3 thereof ) supplies a primer on the electromagnetic boundary conditions discussed forthwith .",
    "assuming that the resonator s bounding electric walls are perfect in the sense of having ( effectively ) infinite surface conductivity , the magnetic flux density at any point on each such wall is required to satisfy @xmath16 , where @xmath17 denotes the wall s surface normal vector . providing the magnetic permeability / susceptibility of the dielectric medium bounded by the electric wall",
    "is not anisotropic , this condition is equivalent to @xmath18 the electric field strength at the electric wall is required to obey @xmath19 these two equations ensure that the magnetic ( electric ) field strength is oriented tangential ( normal ) to the electric wall . as is pointed out in reference  @xcite , equation",
    "[ eq : electricwalld ] is a so - called ` natural ' ( or , synonymously , a ` naturally satisfied ' ) boundary condition within the finite - element method see ref .",
    "@xcite .",
    "when the resonator s form ( hence those of its solutions ) exhibits one or more symmetries , it is often advantageous ( for reasons of computational efficiency ) to solve only for a symmetry - reduced portion or ` sector ' of the full resonator , where this sector is bounded by either ( real or virtual ) electric walls or ( virtual ) magnetic walls , or both .",
    "the boundary conditions corresponding to a perfect magnetic wall ( dual to the those for an electric wall ) are @xmath20 and @xmath21 these two equations ensure that the electric displacement ( magnetic field strength ) is oriented tangential ( normal ) to the magnetic wall . again , the latter equation is naturally satisfied .",
    "one now invokes galerkin s method of weighted residuals ; reference @xcite explains the fundamentals here ; reference @xcite provides an analogous treatment when solving for the electric field strength ( @xmath9 ) .",
    "both sides of equation [ eq : helmholtz ] are multiplied ( scalar - product contraction ) by the complex conjugate of a ` test ' magnetic field strength @xmath22 , then integrated over the dielectric resonator s interior volumes . upon expanding the permittivity - modified ` curl of a curl ' operator ( to extract a similarly modified laplacian operator ) , then integrating by parts ( spatially ) , then disposing of surface terms through the electric- or magnetic - wall boundary conditions stated above , one arrives ( equivalent to equation ( 2 ) of reference @xcite ) at @xmath23 \\",
    ", \\textrm{d } \\textrm{v } = 0,\\end{gathered}\\ ] ] where ` @xmath24 ' denotes the volume integral over the resonator s interior space ( or sector thereof ) and ` @xmath25 ' denotes a contraction weighted by inverse relative permittivities .",
    "the three terms appearing in the integrand correspond directly to the three weak - form terms required to define an appropriate finite - element model within the pde solver .",
    "assuming that the physical dimensions and electromagnetic properties of the resonator s components are temporally invariant ( or at least ` quasi - static ' ) , one seeks harmonic or ` modal ' solutions : @xmath26 , where @xmath27 is the vector of spatial position , @xmath28 the time , and @xmath29 the mode s resonance frequency .",
    "the last , ` temporal ' term in equation [ eq : weakhelm ] s integrand can thereupon be re - expressed as @xmath30 , where @xmath31 and @xmath12 is the speed of light .",
    "this re - expression(and , with respect to spillane _",
    "et al _ s work , using exactly the same fem software platform ) reveals the integrand s complete dual symmetry between @xmath22 and @xmath5 .",
    "one now restricts the scope of the analysis to resonators whose interiors and bounding surfaces are electromagnetically axisymmetric ( henceforth referred to simply as ` axisymmetric resonators ' ) where a system of cylindrical coordinates is aligned with respect to the resonator s axis of rotational symmetry .",
    "this system s three components are @xmath32 \\{`rad(ial ) ' , ` azi(muthal ) ' , ` axi(ial ) ' } ' and ` @xmath33 ' , instead of the more conventional ` @xmath34 ' and ` @xmath35 ' , are ( regrettably ) used to represent radial and axial coordinates / components , respectively , so as to comply with comsol / femlab s standard ( 2d ) naming conventions . ] .",
    "one wishes to calculate the resonance frequencies and field patterns of the resonator s ( standard ) whispering - gallery ( wg ) modes , whose phase varies as @xmath1 , where @xmath36 is the wg mode s azimuthal mode order .",
    "note that the method does not require @xmath2 to be large ( _ i.e. _ , it is not an ` asymptotic ' method ) ; even modal solutions that are themselves axisymmetric , corresponding to @xmath37 , such as the one shown in fig .  [",
    "fig : braggcavity](b ) , can be calculated .",
    "viewed as a three - component vector field over a ( for the moment ) three - dimensional space , the time - independent part of the magnetic field strength now takes the form @xmath38 where an ` @xmath39 ' ( @xmath40 ) has been inserted into the field s azimuthal component so as to allow , in subsequent solutions , all three component amplitudes @xmath41 to each be expressible as a real amplitude multiplied by a common complex phase factor .",
    "the relative permittivity tensor of an axisymmetric dielectric material is diagonal with entries ( running down the diagonal ) @xmath42 , where @xmath43 is the material s relative permittivity in the axial direction and @xmath44 its relative permittivity in the plane spanned by it radial and azimuthal directions .",
    "an axisymmetric boundary s unit normal in cylindrical components can be expressed as @xmath61 note vanishing azimuthal component .",
    "the full electric - wall boundary conditions , in cylindrical components , are as follows : @xmath62 gives @xmath63 and @xmath64 includes both @xmath65 and @xmath66 when the dielectric permittivity of the medium bounded by the electric wall is isotropic ( which is often the case in embodiments ) , the last condition reduces to @xmath67 the full magnetic - wall boundary conditions , in cylindrical components , are as follows : the condition @xmath68 gives @xmath69 and the condition @xmath70 includes both @xmath71 and @xmath72 one observes that the transformation @xmath73 , connects equations [ eq : electricwallhcylcomp ] and [ eq : magneticwallhcylcomp1 ] , and equations [ eq : electricwallecylcomp2isotrop ] with [ eq : magneticwalldcylcomp ] .",
    "explicit pde - solver - ready equivalents of [ eq : electricwallhcylcomp ] through [ eq : magneticwallhcylcomp2 ] are stated in this paper s auxiliary appendix @xcite .",
    "the above weak - form expressions and boundary conditions , _ viz . _  equations [ eq : laplacianweakall ] through [ eq : magneticwallhcylcomp2 ] are the key enabling results of this paper : once inserted into a pde - solver , the wg modes of axisymmetric dielectric resonators can readily be calculated , as is demonstrated for particular embodiments in section [ sec : exampleapplications ] below .",
    "having determined , for each mode , its frequency and all three components of its magnetic field strength @xmath5 as functions of position , other relevant fields and parameters can be derived from them .",
    "straightaway , the magnetic flux density @xmath74 ; here , as stated in subsection [ subsec : weakforms ] above but see also footnote 4 , the magnetic permeability @xmath8 is assumed to be a scalar constant , independent of position .",
    "[ and for each of the resonators considered in section [ sec : exampleapplications ] , @xmath75 everywhere to an adequate approximation . ] as no real ( ` _ _",
    "non__-displacement ' ) current flows within a dielectric , @xmath76 , thus @xmath77 . and , @xmath78 , where @xmath79 is the ( diagonal ) inverse permittivity tensor , as already discussed in connection with equation [ eq : weakhelm ] above .",
    "accepting various caveats ( most fundamentally , the problem of mode - volume divergence see footnote 7 ; and inconsistent definitions between different authors ... ) as addressed by kippenberg @xcite , the volume of a mode in a dielectric resonator is here defined as @xcite @xmath80},\\ ] ] where @xmath81 $ ] , denotes the maximum value of its functional argument , and @xmath82 denotes integration over and around the mode s ` bright spot ' where its electromagnetic field energy is concentrated .      the resonator s electric filling factor , for a given mode , a given dielectric piece / material , @xmath83 , and a given field direction , ( @xmath84 ) , is defined as @xmath85 where @xmath86 denotes integration only over those domains composed of the dielectric in question and @xmath87 = @xmath88 for @xmath89 = @xmath90 . the numerators and denominators of equations [ eq :",
    "mode_volume ] and [ eq : filling_factor ] can be readily evaluated using the pde - solver s post - processing features .",
    "so far , the model resonator as per fig .",
    "[ fig : generic_resonator ] has been treated as a wholly loss - less one : its modal solutions have infinite @xmath0s or , equivalently , the ( otherwise complex ) frequencies of these solutions are purely real or , equivalently , the solutions oscillatory electromagnetic fields persist indefinitely",
    ". no energy is dissipated by the dielectric material(s ) included within the resonator ( their dielectric loss tangents are presumed to be zero ) ; none is lost through radiation since the resonator s bounding perfect electric / magnetic walls allow none to escape ; and , being perfect , the current induced within the wall causes no resistive dissipation .",
    "_ real _ resonators , on the other hand , are subject to one or several dissipative processes , _ i.e. _  ` losses ' , that render the @xmath0s of resonances finite .",
    "this subsection provides an expression for the rate of a resonator s ` wall loss ' ; section [ sec : radloss ] goes on to provide bounds on the rate of an open resonator s ` radiation loss ' .",
    "such estimates are important since @xmath0 values are directly measurable in experiments and , furthermore , often determine viability and/or performance in applications .",
    "the approach taken here is to build upon ( via perturbation theory and/or ` induction ' ) the loss - less model , as it has already been formulated in section [ sec : method ] as opposed to constructing the additional machinery required to model resonators with lossy materials either placed within or clad about them .",
    "_ preliminaries : _ the space that a wg - mode occupies can be broadly divided into three regions : ( i ) the mode s ` near - field ' , which includes its bright spot(s ) where the modes e.m .",
    "energy density is greatest , ( ii ) an ` evanescent zone ' , lying around the near - field , where the mode s field amplitudes ( and energy density ) decay exponentially with distance @xmath34 away from its bright spot and ( iii ) a ( notionally infinite ) ` radiation zone ' , lying outside of the evanescent zone ( a ` cusp ' can separate the two ) , where the field - amplitudes decay as @xmath91 .",
    "if a compact , closed resonator of high-@xmath0 is sought , its electric ( _ i.e. _  metal ) wall should be placed sufficiently far from the wg - mode s bright spot in the exponentially decaying zone ( ii ) , but , for reasons of compactness , no further out than is necessary .    a brief word of warning :",
    "as the @xmath0 of an experimental wg - resonator can be exceedingly high ( @xmath92 ) , the amplitude of the electromagnetic field where dominant losses occur ( their rates will depend on the amplitude ) can be many orders of magnitude lower than the field s maximum ( or maxima ) at the wg - mode s bright spot(s ) .",
    "the hardware and software employed to generate wg - modal solutions must thus be able to cope with such a dynamic range , lest significant numerical errors creep into the predicted ( loss - rate - determining ) amplitudes where the wg - resonator s supported mode is faint . in practice , this means adequate - precision arithmetic , adequate mesh densities ( with fem ) , and , where confidence or experience is lacking , a thorough testing of the robustness of the solution against changes in the geometry or mesh density .",
    "now , the energy stored in the resonator s electromagnetic field is @xmath93 , where @xmath5 is the infinite-@xmath0 solution generated by the pde - solver , and @xmath8 is the common permeability for the resonator s interior . for resonators that are axisymmetric , the 3d volume integral @xmath94 over the resonator s interior reduces to the 2d integral @xmath95 over its medial cross - section .",
    "the surface current induced in the resonator s enclosing perfect - electric wall is given by ( see ref .",
    "@xcite , page 205 , for example ) @xmath96 , where @xmath97 is the tangential component of @xmath5 with respect to the resonator s electric - wall boundary .",
    "one now exploits ( first - order ) perturbation theory , and equates the current immediately stated above with that which would be induced into the electric walls of a resonator , identical to its loss - less antecedent , but for it having electric walls of _ finite _ conductivity .",
    "the equating of the two currents assumes that the lossy walls are nevertheless made out of ( or coated with ) a sufficiently ` good ' conductor , such that the change from loss - less to lossy does not significantly affect the shapes of the resonator s modes",
    ". this will typically be the case for a cavity resonator exciting low - order modes at microwave frequencies , provided its walls are made from any standard ( electrically good ) metal , such as copper ; again , see references @xcite and/or @xcite for further explanation / quantification .",
    "the time - averaged(-over - a - cycle ) power lost by the resonator through resistive heating in its imperfect electric walls is thereupon given by @xmath98 , where the 2d surface integral @xmath99 over the resonator s presumed axisymmetric enclosing boundary reduces to the 1d integral @xmath100 around the periphery of its medial ( x - y ) cross - section ; @xmath101 is the wall s surface resistivity , where @xmath102 is the wall s ( bulk ) electrically conductivity , and @xmath29 the mode s frequency .",
    "the quality factor , defined as @xmath103 , due to the wall s resistive losses can thus be expressed as : @xmath104 where @xmath105 , which has the dimensions of a length , is defined as @xmath106 \\ , x \\ ,",
    "\\textrm{d } x \\,\\textrm{d } y } { \\int x \\ , [ |h^\\phi|^2 + |h^y dn_x - h^x n_y|^2 ] \\rm{dl}}.\\end{gathered}\\ ] ] both integrals ( numerator and denominator ) , hence @xmath107 itself , can be readily evaluated using the pde - solver s post - processing features ; explicit pde - solver - ready forms of each integrand are provided in this paper s separate appendix @xcite . in the using of equation [ eq : q_wall_loss ] , it should be pointed out that , at liquid - helium temperatures , the bulk and surface resistances of metals can depend greatly on the levels of ( magnetic ) impurities within them @xcite , and the text - book @xmath108 dependence of surface resistance on frequency is often violated @xcite .",
    "many whispering - galley mode resonators ( both microwave @xcite and optical @xcite ) of interest experimentally are _ not _ shielded by an enclosing metal wall : they are _",
    "open_. in consequence , the otherwise highly localized wg mode supported by the resonator spreads throughout free - space s @xmath109 integral , as it covers the wg mode s bright spot , must be somehow limited , spatially , or otherwise ( asymptotically ) rolled off , lest the integral diverge as the so - called ` quantization volume ' associated with the radiation extends to infinity . ] , leading to the conveyance of energy away from the mode s bright spot ( where the electric- and magnetic - field amplitudes are greatest ) through _ radiation_. provided the equivalent closed resonator s enclosing electric ( _ i.e. _  metal ) wall is stationed sufficiently far out in the wg mode s evanescent zone , the wg mode s form in its near - field will be the same ( to the degree of equivalence required here ) in both the open - resonator and closed - resonator cases .",
    "one can thus calculate the mode s near - field form through the method developed in section [ sec : method ] , or by some other method , as applied to the closed resonator ; in particular , the electric and magnetic field strengths , @xmath9 and @xmath5 or , equivalently , the vector potential @xmath110 , just outside of the surface(s ) of the resonator s dielectric component(s ) can be determined .",
    "having done so , the wg mode s far - field form ( _ i.e. _  its ` radiation pattern ' ) in the case of the open resonator can be calculated by invoking the so - called _ field equivalence principle _ @xcite , where @xmath110 or ( the tangential components of ) @xmath9 and @xmath5 over the said surface(s ) are regarded , in huygen s picture , as ( secondary ) sources radiating into free - space .",
    "the calculation can be implemented through a standard retarded - potential ( green function ) approach @xcite , incorporating ( if necessary ) a multipole expansion .",
    "the mode s radiative loss , hence @xmath0 , can be subsequently calculated from the radiation pattern determined by integrating poynting s vector over all solid angles . with due care ,",
    "the resulting estimate of the mode @xmath0 will be highly accurate .",
    "but such a program of work for lack of novelty rather than utility shall _ not _ be undertaken here .      instead ,",
    "two different ( but related ) ` trick ' methods for _ estimating _ the radiative @xmath0 of an open ( dielectric ) resonator are described here . as the first method underestimates the @xmath0 , while the second overestimates it ,",
    "the two in conjunction can be used to bound the @xmath0 from below and above .",
    "moreover , both can be implemented as straightforward ` add - ons ' to the 2d pde - solver s computational environment , as already configured for solving closed loss - less resonators ( as per section [ sec : method ] ) .",
    "it should be added that these two methods are not restricted to axisymmetric resonators _ per se_.",
    "consider an otherwise loss - less open resonator , supporting a spatially concentrated mode , _",
    "i.e. _  one with a bright spot , that radiates into free - space .",
    "as stated above , the tangential electric and magnetic fields on any closed surface in the near - field surrounding this mode s bright spot can , by the field equivalence principle , be regarded as a ( secondary ) source of this radiation .",
    "now consider a closed , completely loss - less equivalent of the open resonator , formed by placing a cavity around it , whose enclosing perfect - electric wall lies in the said localized mode s radiation zone .",
    "it is noted here , for future reference , that this perfect electric wall will force the tangential component of the electric field strength to vanish everywhere on it , _",
    "@xmath111 , where @xmath17 is the wall s unit normal vector .",
    "the above - mentioned secondary source generates an outward - going traveling wave wave which , but for the cavity , would lead to radiation . instead , with the cavity in place , a standing ( as opposed to traveling ) wave arises .",
    "now , suppose that the shape of the cavity s electric wall , and its location with respect to the source , is chosen to predominantly reflect the source s outward - going wave back to the source such that the resultant inward - going wave interferes constructively with the outgoing wave over the whole of the source s surface .",
    "in other words ( 1d analogy ) , on regarding the cavity as a short - circuit - terminated transmission line , one attempts to adjust the length of the line such that its input ( analogous to the source s surface ) is located at an antinode of the line s standing wave . if such a retro - reflecting ( + phase - length adjusted ) cavity can be devised then , in particular , the measured / simulated tangential magnetic field , @xmath97 , just inside of the cavity s electric wall will be exactly _ twice _ that of the outward - going wave for the open resonator @xmath112 at the same location but without the cavity s electric wall in place . in practice , the source will not be located exactly at an antinode ( over the whole of its surface ) and thus @xmath113 .",
    "the radiative loss for the open resonator can be evaluated by integrating the cycle - averaged poynting s vector corresponding to the outward - going wave s inferred tangential magnetic field over the electric wall s surface ; _ i.e. _ @xmath114 , where @xmath115 is the impedance of free space .",
    "a bound on the open resonator s radiative @xmath0-factor can thus be expressed as @xmath116 where @xmath105 is exactly that given by equation [ eq : length ] but with the ( loss - less ) electric wall now in the radiation zone .",
    "provided the pde solver is able to accurately calculate the ( faint ) electromagnetic field on the rad .- zone cavity s enclosing boundary , it can again be readily determined .",
    "it is further remarked here that the above admittedly rather heuristic and one - dimensional argument , is strongly reminiscent of schelkunoff s induction theorem @xcite , which is itself a corollary of the ( already - mentioned ) field equivalence principle . through analogy to this theorem , the author conjectures that equation [ eq : q_rad_electric_wall ] holds equally well for fully vectorial waves ( as governed by maxwell s equations ) in 3d space as for scalar waves along 1d transmission lines as argued above .",
    "a complementary estimator to the one above can be constructed by replacing the above cavity s electric wall with an ` impedance - matched ' one , where the tangential magnetic and tangential electric fields at every point on the wall are constrained so as to correspond to those of an outward - going plane _ traveling _ wave , propagating in the direction of the wall s local normal and in an outward - going sense . in other words ( 1d analogy ) , one attempts to confront the secondary source s outward going wave with a matched surface that reflects nothing back . for plane - wave radiation",
    ", this constraint can be expressed as @xmath117 , where @xmath17 is the surface s inward - pointing normal .",
    "note that one does not constrain the direction ( polarization ) of @xmath9 or @xmath5 in the wall s local plane ; one only demands that the two fields be orthogonal and that their relative amplitudes be in the ratio of the impedance of free space @xmath115 .",
    "upon differentiation w.r.t .  time and using maxwell s displacement - current equation",
    ", this relation can be re - expressed as @xmath118 - ( 1/c ) \\textbf{n } \\pmb{\\times } \\frac{\\partial \\textbf{h}}{\\partial t}= 0.\\ ] ] for a given eigenmode , and generalizing somewhat , the constraint can be recast as @xmath119\\}\\\\ + \\sin(\\theta_{\\rm{mix } } ) \\ , \\textrm{i } \\",
    ", \\bar{c } f \\ , \\textbf{n } \\pmb{\\times } \\textbf{h } = 0,\\end{gathered}\\ ] ] where @xmath29 is the mode s frequency ( in hz ) , @xmath120 as before , and @xmath121 is a ` mixing angle ' . in the impedance - matched case ( outward going plane wave in free space ) , @xmath122 , and the above equation reduces to @xmath123 + \\textrm{i } \\",
    ", \\bar{c } f \\ , \\textbf{n } \\pmb{\\times } \\textbf{h } = 0 .\\ ] ] more generally , the first and second terms on the left - hand side of equation [ eq : rad_match_mix ] can be viewed as representing electric- ( cf .",
    "equation [ eq : electricwalld ] ) and magnetic - wall ( cf .",
    "equation [ eq : magneticwallh ] ) boundary conditions , respectively , where the latter corresponds to that used in subsubsection [ subsubsec : retro - refl ] above .",
    "the boundary condition can be continuous adjusted between these two extrema by varying the mixing angle @xmath121 ; for the sake of completeness , @xmath124 corresponds to an inward - going , as opposed to an outward - going , impedance match .",
    "note that , unless @xmath125 for integer @xmath126 , the square root of minus one in equation [ eq : rad_match_mix ] breaks the hermitian - ness of the matrix that the pde - solver is required to eigensolve , leading to solved modes with complex eigenfrequencies @xmath127 . as exploited by srinivasan _",
    "et al _ @xcite , the inferred quality factor for such a mode due to radiation through / into its bounding wall is given by @xmath128/2\\im[f_{\\rm{mode}}]$ ] , where @xmath129 $ ] and @xmath130 $ ] represent taking real and imaginary parts ( of the complex eigenfrequency ) , respectively .",
    "note that the accuracy of the method will depend on the degree to which the imposed surface impedance agrees with that of the true outward - going traveling wave , as generated by the open resonator s ( secondary ) source , over the chosen bounding surface .",
    "if the source were an infinitessimal(finite ) multi - pole , then a surface in the form of a finite(infinite ) sphere centered on the source , with the constraint [ eq : rad_impedance_match ] imposed on its surface , would perfectly match to the source s radiation ( _ i.e. _  no traveling wave would get reflected back from it ) .",
    "in general , however , for a finite radiator , the chosen surface ( necessarily of finite extent ) will not lie everywhere normal to the outward - going wave s poynting s vector and back reflections will result , leading to a smaller imaginary part in the simulated eigenmode s frequency , thus causing @xmath131 to overestimate the true radiative @xmath0 .",
    "thus , one may state @xmath132/2\\im[f_{\\rm{mode}}],\\ ] ] approaching equality on perfect matching . again",
    ", the author conjectures that , despite the rather heuristic and one - dimensional argument stated above , inequality [ eq : q_rad_match ] holds in general . used together , equations [ eq : q_rad_electric_wall ] and [ eq : q_rad_match ] provide a bounded estimator on the true radiative @xmath0 .",
    "_ comment : _ as alluded to at the beginning of this section , the author recognizes that alternative ( one might argue rather more ` empirical ' ) approaches , based on surrounding ( cladding ) the otherwise open resonator with sufficiently thick layers of impedance - matched absorber [ _ i.e. _ , with the absorber s dielectric constant set equal to that of free space except for a small imaginary part ( loss tangent ) causing the outward - going wave to be gently attenuated with little back reflection ] .",
    "the ` boundary - alteration ' method described above has the advantage of not extending the footprint of the pde - solver s modeled region ( thus _ not _ requiring the mesh of finite elements to be extended ) .",
    "the author has deployed the methodologies expounded in sections [ sec : method ] through [ sec : radloss ] above to model several different sorts of resonator . where possible , he chose resonators with shapes and properties that had already been published so as to afford comparisons .",
    "each of the characteristics considered in sections [ sec : postprocessing ] and [ sec : radloss ] was evaluated for at least one such model resonator .",
    "the comsol applications ( as ` .mph ' files ) that the author constructed to simulate these resonators can be obtained from him upon request .",
    "[ [ uwa - sloping - shoulders - cryogenic - sapphire - microwave - resonatorsubsecslopingshoulders ] ] uwa ` sloping - shoulders ' cryogenic sapphire microwave resonator[subsec : slopingshoulders ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    this resonator , as designed and assembled by workers at the university of western australia ( uwa ) @xcite , comprises a piece of monocrystalline sapphire mounted within a cylindrical metal can .",
    "the can s internal wall and the sapphire s outer surface exhibit rotational symmetry about a common axis .",
    "furthermore , the optical ( or ` c ' ) axis of the sapphire crystal is , to good approximation , oriented parallel to this geometric axis .",
    "the resonator can thus be taken ( and modeled ) as being electromagnetically axisymmetric .",
    "the sapphire piece s medial cross - section ( one half thereof ) is shown in fig .",
    "[ fig : uwares](a ) .",
    "what makes the resonator awkward to simulate accurately via the semi - analytic mm - sv method @xcite is its sloping shoulders ( s@xmath133 and s@xmath134 _ ibid . _ ) , whose surface normals are neither purely axial nor purely radial .",
    "the functionality of ` subdomain expressions ` is required for generating post - processed fields , like the electric field strength @xmath9 as per the 6th , 7th and 8th entries in table  [ tab : comsolscalarexpress ] .",
    "those constants associated with each such field s definitions , like ( in the case of @xmath9 ) the relative permittivities ` epara ` and ` eperp ` , _ vary _ from one subdomain within the medial half place to another .",
    "the variation of these subdomain - dependent ` constants ' is represented through ` options ` @xmath135 ` expressions ` @xmath135 ` subdomain expressions ` ; therein , the ` name ` of each such variable is the same in each and every ` subdomain ` ( as identified by an integer ) , but its ` expression ` reflects the variable value in the selected ` subdomain ` .",
    "thus , the ` expression ` for ` epara ` in a ` subdomain ` corresponding to ( cryogenic and axisymmetrically oriented ) sapphire would be ` epara1 ` , with ` epara1 ` defined ( globally ) as 11.3486 ( or whatever ) through table  [ tab : comsolconstants ] , whereas in a ` subdomain ` corresponding to free space , the ` expression ` for ` epara ` should be set to ` 1 ` .",
    "similarly ( and more simply ) , the single ` subdomain`-dependent variable ` erel ` can be used to represent the variation of relative permittivity within an axisymmetric resonator containing solely isotropic dielectrics ( incl .",
    "free space ) .",
    "the simulation s defining weak - form expressions are set up through the ` physics ` @xmath135 ` subdomain settings ... ` control panel .",
    "on the left of this panel , first select the ` groups ` tab .",
    "a ` new ` ` group ` must be named and defined for each dielectric within the resonator being simulated .",
    "the author chose to name these dielectric ` groups ` `` dielectric_0:vacuum ` ' , `` dielectric_1 ` ' , ... , `` dielectric_n ` ' , ... .",
    "for each dielectric ` group ` , ( in general ) ` dielectric_n ` say , corresponding weak - form expressions need to be entered into the ` weak terms ` ( _ i.e. _  three slots or text fields ) , for expressions involving spatial derivatives , and also into the ` dweak terms ` , for expressions involving temporal derivatives ; these slots are accessed through the ` weak ` and ` dweak ` tabs , respectively , located on the right of the ` subdomain settings ... ` control panel .",
    "these terms govern the electromagnetic field in regions filled with the @xmath136-th dielectric , as specified in the ` constants ... ` table introduced above .",
    "no other fields on the right of ` subdomain settings ... ` need(/should ) be touched ; in particularly , do nt monkey with the ` contr`-tabbed sub - panel .",
    "note that it is imperative that the ` name ` of each constant entered into ` options ` @xmath135 ` constants ... ` above match ( verbatim ) its appearances within the expressions ( below ) that are entered into the ` weak ` and ` dweak ` text fields here .",
    "for each dielectric ` group ` , two ` weak ` and one ` dweak ` terms are required : ( i ) a ` laplacian ' term ( corresponding to the left most term on the left - hand side of equation [ eq : helmholtz ] and ( ii ) a ` penalty ' term , included to suppress spurious modes , corresponding to the middle term of the same .      : the form of the laplacian weak term , @xmath137 , here given for the 1st axisymmetric dielectric , is @xmath138 where ` hazix ` denotes the partial derivative of ` hazix ` with respect to the coordinate ` x ` , ` hrady ` the partial derivative of ` hazi ` with respect to ` y ` , etc . ; ` test(hazi ) ` denotes the ` test function ' of ` hazi ` , _ etc . _",
    "its equivalent for the 2nd axisymetric dielectric is obtained by replacing ` eperp1 ` by ` eperp2 ` and ` epara1 ` by ` epara2 ` , and so forth for all other axisymetric dielectrics ( should more be required ) .",
    "the above expression can be significantly simplified for the ( subdomain ) ` groups ` corresponding to isotropic dielectrics or free space ( _ viz .",
    "_  ` dielectric_0 ` ) ; for computational efficiency , it is recommended that these simplifications be implemented wherever possible .",
    "the required form of the laplacian ` weak term ` , @xmath139 / { \\epsilon_1 } $ ] , for the 1st isotropic dielectric is given explicitly as @xmath140 where ` e1 ` is the material s dielectric constant ( as appearing in table  [ tab : comsolconstants ] ) .",
    "the laplacian ` weak term ` for the vacuum is the same with @xmath141 , and those for other isotropic dielectrics are similarly obtained by swopping @xmath142 with @xmath143 , @xmath144 , and so forth .      :",
    "the form of the penalty ` weak term ` , @xmath145 , the same for each subdomain ` group ` , is @xmath146 here , the coefficient ` alpha ` ( whose value is determined through comsol s equivalent of table  [ tab : comsolconstants ] ) controls the aggressiveness of the divergence suppression induced by this term",
    ". the remaining , 3rd slot , should be zero - filled .",
    "[ as a general rule , unused weak - form slots should always be filled with zeroes this applies to the the ` dweak term ` slots below . ]",
    "the form of the temporal - derivative / frequency ( so - called ` dweak ' ) term @xmath147 , common to all subdomain ` groups ` , is entered into the first slot within the ` dweak`-tabbed panel of ` physics ` @xmath135 ` subdomain settings ... ` , and is given as @xmath148 where ` haxitt ` denotes the double partial derivative of ` haxi ` with respect to time , _ etc . _",
    "the remaining 2nd and 3rd slots of the ` dweak`-tabbed panel should be zero - filled .      here",
    "the constraints stated in subsection [ subsec : axisymmetricbcs ] are expressed in comsol - ready forms .",
    "the model resonator s boundary conditions are defined through the ` physics ` @xmath135 ` boundary settings ... ` control panel .",
    "on the left of this panel , select the ` groups ` tab .",
    "each named boundary ` group ` here corresponds to a particular electromagnetic boundary condition , the most essential of which are described here .",
    "these different e.m .",
    "boundary conditions are specified by the expressions that populate the three slots within their respective ` contr`-tabbed sub - panels , located on the right - hand side of ` boundary settings ... ` ; `` contr ` ' here stands for ` constraint ' .",
    "[ the neighboring ` weak`-tabbed and ` dweak`-tabbed panels within the ` boundary settings ... ` need not be touched ( and left zero - filled ) . ]",
    "as has already been discussed in subsection  [ subsec : axisymmetricbcs ] , the constraints appropriate to implementing a radiation match , can be regarded ( complex ) linear combinations or ` mixings ' of pure electric- and magnetic- wall constraints .",
    "the first constraint mixes the magnetic - wall constraint  [ eq : magneticwallhcylcomp2 ] , _ i.e. _  [ eq : comsolexplwkfrmmws4 ] above , with the electric - wall constraint  [ eq : electricwallecylcomp2isotrop ] , _ i.e. _  [ eq : comsolexplwkfrmews3 ] above : @xmath155 note that `` i ` ' here is the square root of minus one . and",
    "the second constraint mixes the electric - wall constraint  [ eq : electricwallecylcomp1 ] , _ i.e. _  [ eq : comsolexplwkfrmews4 ] above , with the magnetic - wall constraint  [ eq : magneticwallhcylcomp1 ] , _ i.e. _  [ eq : comsolexplwkfrmmws1 ] above : @xmath156 here , the pair of constants \\{`cmw ` and ` cew ` } , are defined through table  [ tab : comsolconstants ] . when they are set to their standard ( default ) values of \\",
    "{ @xmath157 , @xmath157 } , equations [ eq : comsolexplwkfrmrms1 ] and [ eq : comsolexplwkfrmrms2 ] impose a radiation match on tangential field components at the impedance of plane e.m .",
    "waves in free - space . here also , ` cbar`@xmath158 ; and ` mf ` is the mode s ( center ) frequency ; both need to be defined within ` options ` @xmath135 ` constants ... ` .",
    "as per their corresponding rows in table  [ tab : comsolconstants ] ;    the final ( optional ) constraint mixes the electric wall constraint [ eq : electricwallhcylcomp ] , _ i.e. _  [ eq : comsolexplwkfrmmws1 ] with the magnetic wall constraint  [ eq : magneticwalldcylcomp ] , _ i.e. _  [ eq : comsolexplwkfrmmws3 ] : @xmath159 here ; the constants ` tngm ` and ` tnge ` , are also defined through table  [ tab : comsolconstants ] and thereupon ` options ` @xmath135 ` constants ... ` . setting \\{`tngm ` , ` tnge ` } = \\{1,0}(\\{1,0 } )",
    "constrains the magnetic ( electric ) field to be wholly tangential on the impedance - matching plane as is characteristic of electromagnetic traveling waves .",
    "the default setting for this third constraint was ( arbitrarily ) \\{`tngm ` , ` tnge ` } = \\{1,0 } ) .",
    "[ it is remarked here that the author sought to implement the radiation - matching constraints more directly and elegantly with time derivatives , _",
    "i.e. _ ,  replacing ` 2*pi*mf*hazi ` by ` hazit ` , and similarly for ` hrad ` and ` haxi ` .",
    "but comsol did not generate the intended frequency factor when interpreting them .",
    "he thus resorted to entering the expressions as stated in equations [ eq : comsolexplwkfrmrms1 ] through [ eq : comsolexplwkfrmrms3 ] , requiring ` mf ` to be set , by hand , for each mode . ]",
    "each resonator s geometry needs to be either constructed within or imported into comsol .",
    "comsol s manual provides instructions on how to implement both .",
    "though simple geometries ( _ e.g. _  a cylinder of solid dielectric material inside a cylindrical metal can ) can be quickly constructed by hand within comsol , the author found it advantageous to define the sets of quadrilateral subdomains into which many axisymmetric dielectric resonators can be readily decomposed using matlab scripts , where the script was run to generate the resonator s medial cross - section .",
    "the key lines in these scripts were those of the form      this particular line defines a quadrilateral , named ` q1 ` , whose vertices have the ` x - y ` coordinates : ` [ x1,y1 ] , ... ` ` [ x4,y4 ] ` .",
    "these quadrilaterals could then be imported into comsol by entering a list comprising their names into ` file ` @xmath135 ` import ` @xmath135 ` geometry objects ` . each complete matlab script ( also available from the author upon request ) included , where known / relevant , the cryogenic shrinkages of the resonator s constituent materials .",
    "if constructed out of quadrilaterals , the resonator s geometry can be meshed either into sub - quadrilaterals using ` mesh ` @xmath135 ` map mesh ` .",
    "else , the geometry can always be meshed into ( psuedo - random ) triangles using ` mesh ` @xmath135 ` initial mesh ` with ( recommended ) mesh refinement over selected areas ( covering the bright spots of wg modes ) .",
    "note that , for the geometry to be ` map mesh`-able , the vertices of its internal quadrilaterals should generally all meet at ` cross - roads ' , where , at each , four vertices belonging to four separate quadrilaterals all meet at a point , as opposed to ` t - junctions ' , where , at each , two vertices belonging to two separate quadrilaterals meet at a point along the boundary edge of a third quadrilateral .",
    "the reader is advised to consult the comsol manual ( chapter ` meshing ' , section ` generating meshes ' , subsection ` creating mapped meshes in 2d ' ) for a fuller ( though a still not wholly satisfactory ) explanation of this rather quirky requirement .",
    "the meshing density can be controlled by , for selected edges , activating and entering an appropriate integer in the `` contrained edge element distribution ` ' field within of the ` boundary ` tab of the ` map mesh ` control panel . with regard to both ` map mesh`-ability and control over meshing density",
    ", it can be advantageous ( or plain necessary ) to divide odd - shaped subdomains ( _ e.g. _  an ` l'-shaped region covered throughout by a single spatially uniform dielectric material ) into several , more simply shaped adjoining subdomains ( _ e.g. _ , in the case of dividing up the l - shaped subdomain , two or even three rectangular subdomains ) .",
    "note that the geometry will not mesh if the allocations of elements along too many edges are ( inconsistently ) specified ; in other words , the edge element distribution must not be over constrained .",
    "the ( either hand - made or imported ) quadrilaterals composing the resonator s cross - sectional geometry are assigned to one of the defined dielectric ` groups ` via the ` subdomain settings ... ` @xmath135 ` subdomains ` tab . activating ( _ i.e. _  ticking ) the ` select by group ` option here aids the verification of assignments .      the external edges of quadrilaterals should be set be obey one of the three above - described ` group ` boundary conditions via the ` physics ` @xmath135 ` subdomain settings ... ` @xmath135 ` subdomains ` tab .",
    "comsol appears to be smart enough to recognize those edges that are external on its own accord and automatically ` ghosts ' ( grays ) internal edges ; the latter should not be assigned to any boundary ` group ` condition .",
    "thus , with the ` select by group ` feature activated , all the appropriate edges can be assigned to the appropriate ( usually electric - wall ) boundary condition in a single selection of the ` groups ` drop - down menu .",
    "[ 1 ] the center frequencies of solved resonances can be viewed through the ` solution to use ` @xmath135 ` eigenvalue : ` drop - down menu in the ` general`-tabbed sub - panel of the ` plot parameters ` control panel .",
    "[ 2 ] to display the morphology and features of the solved eigenmodes , the ` expression : ` slot within the ` surface`-tabbed sub - panel of the same is filled with either ( i ) some function of the solved field variables \\{`hrad ` , ` hazi ` , ` haxi ` } or ( ii ) one of those expressions ( _ e.g. _  ` elecmagsqrd ` ) pre - defined in ` options ` @xmath135 ` expressions ` ` scalar expressions ` as comsol s equivalent of table  [ tab : comsolscalarexpress ] , or ( iii ) some function / combination thereof .",
    "for example , @xmath160 can be inserted to view the magnetic energy density on a logarithmic scale . to view ( as a diagnostic ) the divergence of the magnetic field strength , which should be zero , one inserts `",
    "divh ` @xmath161 ` ( hrad - hazi*m+(haxiy+hradx)*x)/x ` instead .",
    "[ 3 ] determinations of an electromagnetic mode s volume , filling factor(s ) , and length ( @xmath105 ) , as per equations [ eq : mode_volume ] , [ eq : filling_factor ] , and [ eq : length ] , respectively , all make use of the ` postprocessing ` @xmath135 ` domain integration ` panel . for example",
    ", the numerator @xmath162 on the right - hand - side of [ eq : mode_volume ] can be evaluated by inserting ` elecendens ` @xmath161 ` erad*drad+eazi*dazi+eaxi*daxi ` into this panel s ` expression : ` slot , with those entries selected in the ` subdomain selection ` list on the left - hand side of the same panel covering all significant parts of the mode s bright spot .    [ 4 ] with regards to determining filling factors , the numerator on the right - hand side of equation [ eq : filling_factor ] can be evaluated by selecting only those subdomains filled with the relevant dielectric ( as opposed to free - space ) .    [ 5 ] to determine the resistive - wall - loss integral @xmath163 ( forming the denominator of equation [ eq : length ] ) , one uses the ` postprocessing ` @xmath135 ` boundary integration ` panel with ` 2*pi*x*(abs(hazi)^2 ` ` + abs((haxi*nx ` ` -hrad*ny))^2 ) ` inserted into the ` expression : ` slot within the ` expression to integrate ` box therein , and where entries selected with ` boundary selection ` correspond to the resonator s enclosing ( metallic and lossy ) surfaces .    [ 6 ] the maximum / minimum of a field variable , as required to evaluate the denominator on the right - hand side of [ eq : mode_volume ] , can be determined through the ` postprocessing ` @xmath135 ` plot parameters ` @xmath135 ` max / min ` , wherein the ` expression : ` slot is filled with the field variable s expression ( _ viz .",
    "_  ` elecendens ` for evaluating said denominator ) ."
  ],
  "abstract_text": [
    "<S> it is described , explicitly , how a popular , commercially - available software package for solving partial - differential - equations ( pdes ) , as based on the finite - element method ( fem ) , can be configured to calculate the frequencies and fields of the whispering - gallery ( wg ) modes of axisymmetric dielectric resonators . </S>",
    "<S> the approach is traceable ; it exploits the pde - solver s ability to accept the definition of solutions to maxwell s equations in so - called ` _ _ weak form _ _ ' . </S>",
    "<S> associated expressions and methods for estimating a wg mode s volume , filling factor(s ) and , in the case of closed(open ) resonators , its wall(radiation ) loss , are provided . as no transverse approxi - mation </S>",
    "<S> is imposed , the approach remains accurate even for so - called _ quasi_-tm and -te modes of low , finite azimuthal mode order . </S>",
    "<S> the approach s generality and utility are demonstrated by modeling several non - trivial structures : ( i )  two different optical microcavities [ one toroidal made of silica , the other an algaas microdisk ] ; ( ii ) a 3rd - order microwave bragg cavity containing alumina layers ; ( iii ) two different cryogenic sapphire x - band microwave resonators . by fitting one of the latter to a set of measured resonance frequencies , the dielectric constants of sapphire at liquid - helium temperature have been estimated . </S>"
  ]
}