{
  "article_text": [
    "in the standard theory of cosmological structure formation , all large - scale structure in the universe forms via the gravitational collapse of small amplitude initial seed fluctuations .",
    "this process results in a non - linear network of haloes , filaments and voids that is comprised of dark matter and baryons .",
    "one of the goals of modern cosmology is to probe these density fluctuations in the late universe and to use them to constrain models of the cosmos . in the early universe , or at very large scales today , the density fluctuations are small in magnitude and can be analysed using linear perturbation theory , which can be calculated precisely as a function of cosmological parameters  including both baryonic and dark - matter components ( e.g.,@xcite ; @xcite ; @xcite ) . as structures evolve in the later universe they grow and become non - linear .",
    "various perturbative schemes have been developed in cosmology to analyse these fluctuations ( see reviews by @xcite ; @xcite ) , which give insight into the onset of non - linear structure formation .",
    "however , the most successful cosmological probes to date focus on the regime of linear perturbations , for example baryon acoustic oscillations ( bao ; e.g.,@xcite ) or the cosmic microwave background ( e.g.,@xcite ) . in future surveys",
    ", the universe will be mapped in finer detail and in principle it will be possible to extract a great deal of information from non - linear perturbations .    unfortunately , perturbative schemes fail as larger non - linearities develop , due to the inability of perturbation theory to model matter shell - crossing ( see @xcite for a 1d discussion ) . bound structures in the universe today consist of matter that has undergone many crossings and can represent large departures from the mean density .",
    "currently , these extreme non - linearities can only be accurately modelled by running large cosmological simulations , which commonly assume collisionless matter , so - called dark - matter - only simulations",
    ". however , even accurate pure dark - matter simulations are computationally expensive and prohibit the wide space of possible cosmological parameters to be explored quickly .",
    "furthermore , it can also be difficult to understand which physical processes are at work in yielding a given simulation output .",
    "thus , an analytic model for the evolution of structure can be invaluable , both in terms of speed and of insight . in this paper , we use the halo model ( @xcite ; @xcite ; @xcite ) .",
    "this has become established as an important tool for explanation , but it is known _ not _ to provide the accuracy required for the interpretation of current data .    a key measure of scale - dependent inhomogeneity , which can be calculated via perturbation theory or from the halo model , but also measured in simulations , is the power spectrum of the density field .",
    "based on analytical insights , calibrated with @xmath0-bodysimulations , various approximate formulae for the non - linear power spectrum have been generated .",
    "the most widely used of these to date has been the halofitmethod of @xcite , revised by @xcite , which uses ideas from the halo model .",
    "this fitting formula has been expanded by various authors ; to include massive neutrinos ( @xcite ) and @xmath7 modified gravity models ( @xcite ) .",
    "a different approach that is used to make predictions for the non - linear spectrum is that of the ` emulator ' code based on the ` coyote universe ' suite of simulations ( @xcite ; @xcite ; @xcite ; @xcite ) : the cosmic emu .",
    "sets of high resolution simulations are run at key points in cosmological parameter space ( so - called ` nodes ' ) so as to cover the space evenly .",
    "the emulator then interpolates between the measured power spectra as a function of cosmology , yielding predictions for any set of parameters within the space .",
    "@xcite show that their emulator produces the power spectrum to an accuracy of @xmath8 per cent for @xmath9 and @xmath10 per cent for @xmath11 and it covers a small , but interesting , range of cosmological parameter space for flat universes and dark energies with constant equation - of - state .",
    "however , cosmic emumakes no predictions for @xmath12 or @xmath13 and it would be useful to expand the range of cosmological parameters that it currently encompasses .",
    "even if one were in possession of a perfect model of non - linear gravitational clustering it is difficult to compare this theory directly with the total matter field in the universe .",
    "instead one typically views the matter field via its gravitational light - bending effect , specifically in how bundles of light from a distant galaxy are sheared as they pass density perturbations between the galaxy and a telescope .",
    "this gravitational shearing induces a correlation in apparent galaxy shapes on the sky , as light from galaxies that are close on the sky is distorted coherently .",
    "this ` weak ' gravitational lensing ( see the review by @xcite ) has been used to place constraints on cosmological models , for example cosmos ( @xcite ) or cfhtlens(@xcite ; @xcite ) and there are many forthcoming surveys designed to measure this effect in finer detail .",
    "weak lensing measures a projected version of the total matter distribution in the universe , in which the same shear correlations at a given angle can be caused by a smaller scale density fluctuation close to the observer , or a larger - scale fluctuation further away .",
    "this mixing of scales means that theoretical predictions for 2d weak - lensing observables require predictions for the clustering of the full 3d matter distribution over a wide range of scales and redshifts  although see the 3d lensing of @xcite and @xcite for ways to avoid this .",
    "current lensing analyses that work at the level of shear correlations either employ halofit(e.g.,@xcite ; @xcite ; @xcite ) , emulator - based strategies ( @xcite ; @xcite ) or the technique of simulation rescaling ( @xcite ; @xcite ) to provide predictions for the matter spectrum for the required scales ; these predictions are then converted to predictions for shear observables .    in this paper , we take a completely different approach to modelling the full non - linear spectrum ; we present an optimised variant of the halo model that is able to predict the matter power spectrum accurately to wave - numbers of interest for current and future lensing surveys ( @xmath14 ) .",
    "our first goal is to provide accurate halo - model fits to dark - matter only simulations across a range of cosmological parameters ; our approach is to identify parameters in the halo model that can be made to vary in a physically - motivated way and then to fit these to high - resolution simulated power spectra from the emulator presented in @xcite .",
    "this approach is distinct from that of halofit(@xcite ; @xcite ) , which is an empirical fitting formula motivated by the principles of the halo model , but one which does _ not _ use the halo model directly . although we focus on weak lensing observables we stress that our optimised version of the halo model is general , and useful for any cosmological analysis that currently uses halofit .",
    "our approach is also distinct from recent work aimed at improving the halo model by @xcite and @xcite .",
    "these authors do not use the full apparatus of the halo model in order to provide accurate matches to the power spectrum , instead opting to employ a combination of perturbation theory and a series expansion , aimed primarily at an accurate modelling of the quasi - linear regime .",
    "an additional source of uncertainty is the impact of baryonic feedback on the total matter distribution in the universe .",
    "most of non - linear evolution ignore any interactions other than gravitational , except in the initial conditions . and recent work using hydrodynamical simulations together with prescriptions for feedback ( e.g. , ; @xcite ; @xcite ;",
    ") have shown that the redistribution of matter caused by processes such as gas cooling , active - galaxy feedback and supernova explosions can have a large impact on the total mass distribution , but details regarding the magnitude of feedback are uncertain .",
    "we show that we are able to accurately capture the effects of a variety of feedback recipes using our optimised halo model by varying only two parameters that govern halo internal structure .",
    "we constrain these parameters and suggest limits for these that may form a prior . in forthcoming weak - lensing analyses these could either by constrained , to learn about feedback , or marginalized over to provide unbiased cosmological constraints .",
    "this paper is structured as follows : in section  [ sec : halomodel ] we first discuss our conventions for measures of inhomogeneity , then go on to discuss the halo model , including the specifics of the particular model that we employ .",
    "next , in section  [ sec : modifications ] we compare the original halo model to accurate @xmath0-bodysimulations to display its shortcomings and then discuss our modifications to the model . in section",
    "[ sec : results ] we present our main result ; the power spectra of the modified model which best fits the emulator of @xcite . we address baryonic feedback in section  [ sec : baryons ] and demonstrate that our approach can be easily adapted to account for feedback in a variety of models . finally in section  [ sec",
    ": lensing ] we show how our predictions for the matter spectrum translate into lensing observables and show differences between our approach , that of halofit , and simulations .",
    "our work is then summarized in section  [ sec : conclusion ] .",
    "appendix [ app : response ] is dedicated to showing the response of the halo - model power spectrum to variations in cosmological parameters while appendix [ app : calculation ] details the operation of our publicly available halo - model code .",
    "we will use the following notation : the matter density field , @xmath15 , is given in terms of comoving position , @xmath16 , and time , @xmath17 , by @xmath18\\ , \\ ] ] where @xmath19 is the mean matter density and @xmath20 is the density fluctuation about the mean .",
    "we will be interested in the fourier space overdensity @xmath21 , which is defined via the fourier convention of @xcite for a periodic volume @xmath22 : @xmath23 @xmath24 the power spectrum of statistically isotropic density fluctuations depends only on @xmath25 and is given by @xmath26 where the average is taken over modes with the same modulus but different orientations .",
    "we find it more convenient to use the dimensionless quantity @xmath27 : @xmath28 which gives the fractional contribution to the variance per logarithmic interval in @xmath6 .",
    "if the field is filtered on some comoving scale @xmath29 , the variance is @xmath30 where the window function is @xmath31 in the case of smoothing with a spherical top - hat .",
    "the halo model is an entirely analytic model for the non - linear matter distribution in the universe that takes inspiration from the results of @xmath0-bodysimulations .",
    "the basic idea here goes back to @xcite but has been given a modern guise ( @xcite ; @xcite ) , as reviewed in @xcite .",
    "the great power of the method is that it can encapsulate the clustering of galaxies by the choice of an appropriate halo - occupation number , specifying the number of galaxies as a function of halo mass .",
    "but the present application is simpler , since we are considering only the overall mass distribution .",
    "we now summarise the main features of the method , following most closely the presentation in @xcite : the density field is described as a superposition of spherically symmetric haloes , with mass function and internal density structure that are accurately known as functions of cosmology from simulations . in the simplest case of randomly distributed spherical haloes the power spectrum has the form of shot noise , moderated by the density profile of the haloes : @xmath32 here the power spectrum is calculated as an integral over all halo masses , of mass @xmath33 , where @xmath34 is the halo mass function ( comoving halo number density in @xmath35 ) and @xmath36 is the normalized fourier transform of the halo density profile : @xmath37 where @xmath38 is the halo virial radius . on large scales , haloes are not randomly distributed and displacements of haloes with respect to one another require us to consider a ` two - halo ' term to the power . for the matter distribution ,",
    "this is approximately the linear - theory power spectrum @xmath39 an expression for the full halo - model power spectrum is then given by a simple sum of the terms @xmath40      to implement this model , we need to know the halo mass function and density profiles in order to evaluate the one - halo integral in equation ( [ eq : halopower ] ) .",
    "the halo density profile is commonly described via the @xcite ( @xcite ; nfw ) profile : @xmath41 where @xmath42 is a scale radius that roughly separates the core of the halo from the outer portion and @xmath43 is a normalization ; in order to have a finite mass this profile must be truncated at the virial radius @xmath38 , within which the mean overdensity of the halo is @xmath44 .",
    "more recent work @xcite has shown that halo profiles can be better fitted with einasto profiles , which differ from nfw near the halo centre . however , the halo - model power calculation ( equation [ eq : halopower ] ) depends on a self - convolution of the profiles and this smears out details of the halo centre .",
    "thus we prefer to use the simpler nfw fit .",
    "simulated haloes need to be identified in a particle distribution and this is usually determined via a user - set overdensity threshold .",
    "typically , a value of @xmath45 is taken , which is loosely based on predictions from the spherical collapse model in an @xmath46 universe , although some authors use a value of @xmath44 that varies with cosmological parameters in accordance with spherical model predictions ( e.g.,@xcite ) .",
    "once the over density threshold has been set and the halo mass measured the virial radius is no longer an independent parameter , and in order to conserve mass @xmath47 note that this means that in general the @xmath38 given by equation  ( [ eq : virial_radius ] ) will be different from the halo radius one may independently measure from halo particles in a simulation .",
    "the normalization , @xmath43 , is set by the requirement that the spherical integral of equation  ( [ eq : nfw ] ) gives the halo mass .",
    "the only free parameter in a fit to simulations is then @xmath42 , or equivalently the halo concentration @xmath48 .",
    "an implication of this is that the value of @xmath49 measured for simulated haloes depends on the halo definition used  particularly the @xmath44 criterion , the algorithm used to identify haloes and the scheme used for breaking up spurious haloes or unbinding particles ( e.g.,@xcite ) .    since the genesis of the nfw profile , a large number of relations between the concentration and mass of haloes have been developed .",
    "the general trend is that haloes of higher mass are less concentrated than those of lower mass , attributed to the fact that larger haloes formed in the more recent past and that the central density of a halo retains a memory of the cosmological density at its formation time .",
    "the original @xmath50 relation proposed by @xcite was shown to produce an incorrect redshift evolution by @xcite , who provided an updated relation based around the concept of halo formation time .",
    "around the same time a similar model by @xcite was introduced , which was intended to predict the correct @xmath50 relation in the case of models with the same background cosmological parameters but different linear spectra , for example warm dark matter models compared to a cold dark matter ( cdm ) model .",
    "lately focus has shifted to produce extremely accurate concentration  mass relations for the standard @xmath1cdmcosmological model ( e.g.,@xcite ; @xcite ) but these relations do not allow for general variations in cosmology .",
    "more recently , @xcite and @xcite have suggested @xmath50 relations that are ` universal ' , in that they do not depend on cosmology other than via the function @xmath51 ( equation [ eq : variance ] ) .",
    "these relations predict that models with identical linear spectra should share a @xmath50 relation , at odds with results from the concentration emulator of @xcite , which produces a different relation for models with identical linear spectra but different growth histories ( e.g.,a @xmath1cdmmodel compared to a @xmath2cdm model at @xmath52 with identical @xmath53 ) .",
    "we choose to use the relations of @xcite because it was derived by fitting to a wide variety of cosmologies and also because their haloes were defined with a cosmology - dependent overdensity criterion , and therefore naturally adapt to the changes that we plan to make to the halo model in section  [ sec : modifications ] .",
    "the @xmath50 formula relates the concentration of a halo , identified at redshift @xmath54 , to a formation redshift , @xmath55 , via @xmath56 where the parameter @xmath57 is deduced by fitting to simulated haloes .",
    "the formation redshift is calculated by finding the redshift at which a fraction ( @xmath58 , also derived from simulated haloes ) of the eventual halo mass has collapsed into objects , using the @xcite theory : @xmath59 where @xmath60 is the linear ",
    "theory growth function normalized such that @xmath61 , @xmath62 is the variance of the linear density field filtered on the scale of a sphere containing a mass @xmath33 ( equation [ eq : variance ] ; @xmath33 is the mass enclosed in a sphere with radius @xmath29 in the homogeneous universe ) , and @xmath63 is the linear - theory collapse threshold .",
    "the value of @xmath63 is calculated from the spherical collapse model : @xmath64 for @xmath46 , with a _ very _ weak dependence on cosmology ( see @xcite for flat models with @xmath1 and @xcite for matter - dominated open models ) .",
    "in @xcite the parameters @xmath65 and @xmath66 were found from fitting the @xmath50 relation to halo profiles over a range of masses and cosmologies .    for very massive haloes , equation  ( [ eq : z_coll ] ) can assign a formation redshift that is less than the redshift under consideration , suggesting that the halo formed in the future . in our calculations we remedy this by setting @xmath67 if @xmath68 , although it makes very little practical difference to our power spectrum calculations .",
    "it was shown in @xcite and @xcite that the @xmath50 relations proposed in @xcite , @xcite or @xcite failed to reproduce the exact variations in concentration seen in models with identical linear - theory power spectra but different models of dark - energy .",
    "differences in concentration arise because haloes form at different times in these models , despite having matched linear theory at @xmath52 , and the exact form of this hysteresis was not being captured by existing relations ( although the general trend _ is _ captured by @xcite ) .",
    "@xcite proposed a simple correction scheme that augments the @xmath1cdmconcentration for a model by the ratio of asymptotic ( @xmath69 ) growth factors of the dark - energy cosmology to the standard @xmath1cdmone : @xmath70 and we implement this correction in our incarnation of the halo model .",
    "the effect of dark energy on halo concentrations can be seen at the level of the power spectrum in @xcite , in fig .",
    "10 of @xcite and also in our fig .",
    "[ fig : cosmology_variation_0.0 ] .",
    "it can be seen at the level of measured halo concentrations using the @xmath50 emulator or @xcite . because halo concentration affects small - scale power ( equation [ eq : halopower ] ) ,",
    "a corollary of this is that the full non - linear spectrum will be different at small scales in different dark - energy models , even if they share an identical linear spectrum .",
    "any scheme in which the calculation of the non - linear power depends solely on the linear power will thus fail to capture this detail .",
    "the mass function of haloes ( the fraction of haloes in the mass range @xmath33 to @xmath71 ) has been measured from simulations ( e.g.,@xcite ; @xcite ) and has been shown to have a near - universal form , almost independent of cosmology , when expressed in terms of the variable @xmath72 the mass function can be expressed as a universal function in @xmath73 , which is related to @xmath34 that appears in equation  ( [ eq : halopower ] ) via @xmath74 this universality was predicted in an approach pioneered by @xcite whereby the mass function was calculated explicitly by considering what fraction of the density field , when smoothed on a given mass scale , is above the critical threshold for collapse ( @xmath63 ) at any given time .",
    "the expression that they calculated for the mass function is the gaussian @xmath75 but this is not a good fit to the mass function as measured in simulations ; therefore we use the improved formula of @xcite , which was an empirical fit to simulations : @xmath76\\mathrm{e}^{-a\\nu^2/2}\\ , \\label{eq : stmassfunction}\\ ] ] where the parameters of the model are @xmath77 and @xmath78 .",
    "@xmath57 is constrained by the property that the integral of @xmath73 over all @xmath79 must equal one , therefore @xmath80 . in @xcite @xmath63",
    "was taken to be @xmath81 , independent of the cosmology .",
    ".cosmic emuranges for the six cosmological parameters that are allowed to vary .",
    "note that @xmath82 .",
    "@xmath83 and @xmath84 are the cosmological densities of baryons and _ all _ matter respectively , @xmath85 is spectral index of primordial perturbations , @xmath86 is the dimensionless hubble parameter , @xmath2 is the constant dark energy equation of state and @xmath53 is the standard deviation of perturbations measured in the linear field at @xmath52 when smoothed with a top - hat filter of radius @xmath87 .",
    "note that each model is kept flat , so that a change in @xmath88 at fixed @xmath86 entails a change in @xmath89 ( the cosmological density in dark energy with equation of state @xmath2 ) . the currently favoured",
    "_ planck_cosmology @xcite lies close to the values and the cosmic emuparameter space encompasses at least @xmath90 deviations about this .",
    "power spectra can be produced by the emulator between @xmath52 and @xmath91 and for scales from @xmath92 to @xmath93 . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     [ tab : baryon_params ]",
    "the origin of the late - time accelerated expansion of the cosmos is uncertain . to test different models",
    "it is necessary to measure the expansion rate together with the growth of perturbations around the present day .",
    "the weak gravitational lensing of galaxies has emerged as one of the premier tools to probe perturbations , which can discriminate between models with similar background expansion rates .",
    "however , the matter power spectrum is not a directly measurable quantity . with the notable exception of @xcite and the 3d lensing of @xcite , the majority of weak - lensing analyses have measured real space angular correlations of the shears of galaxy images .",
    "shear is typically expressed in terms of the spin-2 quantity @xmath94 , which can be split into tangential ( @xmath95 ) and cross ( @xmath96 ) components with respect to a pair separation vector .",
    "correlation functions @xmath97 are defined as combinations of two - point correlations of tangential- and cross - shear as a function of angular separation : @xmath98 these can be related to the harmonic coefficients , @xmath99 , of the spherical fourier transform of a weighted , projected matter field @xcite , @xmath100 with harmonic wavenumber @xmath101 . here",
    "@xmath102 is the zeroth ( @xmath103 ) and fourth ( @xmath104 ) bessel functions respectively . in the @xcite approximation",
    "the @xmath99 are then related to integrals over all scales of the matter power spectrum @xcite : @xmath105 where @xmath106 is the comoving distance to redshift @xmath54 , defined via the metric convention of @xcite and @xmath107 is the lensing efficiency function : @xmath108 here @xmath109 is the comoving angular - diameter distance , @xmath110 is the comoving distance to the horizon and @xmath111 is the normalized distribution of source galaxies .",
    "finally , @xmath112 is the power spectrum of matter fluctuations , defined in equation  ( [ eq : p(k ) ] ) , and is exactly what hmcodeprovides .",
    "thus , to make contact with lensing observables , it is necessary to investigate how the accuracy of the predictions of hmcodeat the level of the matter power spectrum translates into accuracy for @xmath97 .",
    "-cut imposed .",
    "@xmath103 ( red ) is shown in the upper panel and @xmath104 ( orange ) in the lower panel .",
    "source galaxies are all taken to be fixed at @xmath113 , the effective median lensing redshift of cfhtlens .",
    "we show the cases of taking the hmcodematter power spectrum to be sharply cut at @xmath114 and @xmath115 and correlation functions from halofit and cosmic emu ( ; where @xmath116 for @xmath12 ) . for the range of angular scales shown ,",
    "all models agree for @xmath103 at the @xmath117 per cent level , a @xmath6-cut at @xmath118 only starts to impact upon @xmath103 at the per cent level for @xmath119 and a cut at @xmath115 has almost no impact for angles shown ; the agreement between hmcodeand cosmic emuis @xmath120 per cent across the range of angles . for @xmath104 , hmcodeand cosmic emuagree to @xmath121 per cent until the @xmath6-cut becomes important , around @xmath122 .",
    "halofitis discrepant at the @xmath91 per cent level for @xmath123 . for @xmath104 , the impact of @xmath6-cuts",
    "is felt at larger angular scales than for @xmath103  a cut at @xmath115 makes its impact at the per cent level around @xmath124.,width=222 ]    several methods are commonly used to deal with the fact that 2d lensing correlation functions depend on integrals over all @xmath6 of the matter spectrum .",
    "either fitting formulae are extrapolated beyond the regime to which they were fitted , in the hope that they still provide the required accuracy , or @xmath112 is set to zero for regions where the power is unknown , a so - called @xmath6-cut .",
    "as previously stated , one of the benefits of our halo - model approach is that we have more reason to trust the predictions of the halo model at small scales , due to the large amount of theoretical input that goes into the model . in fig .",
    "[ fig : xi ] we show the lensing @xmath97 correlation functions as predicted by integrating over @xmath112 from hmcode , halofitand from cosmic emu(where we set @xmath125 for @xmath12 ) .",
    "these are computed by taking the source galaxies to all be fixed at @xmath113 , the effective median redshift for lensing of cfhtlens@xcite , and using the best - fitting cosmology from the @xcite .",
    "the three models for @xmath103 agree at the @xmath126 per cent level for at all angular scales shown with predictions from hmcodeand cosmic emuagreeing at the per cent level for all angles shown .",
    "we also show hmcode@xmath97 predictions for @xmath6-cuts at @xmath127 and @xmath115 .",
    "if the theory were perfect , a cut - off in @xmath27 at @xmath118 provides per cent level accuracy only for @xmath128 ; if the power spectrum is cut at @xmath115 , then the predicted @xmath103 does not deviate from per cent level agreement for all angles shown . for @xmath104 if no @xmath6-cut is imposed , the three models agree at the per cent level only for @xmath129 , after which predictions from @xcite deviate by as much as @xmath130 per cent at @xmath131 .",
    "the effect of the finite resolution of cosmic emubecomes important at the per cent level at @xmath122 and the same deviation can be seen in the hmcodeprediction when it is cut at @xmath118 . assuming perfect knowledge of the theory this accuracy extends to @xmath132 if the cut is taken at @xmath115 .",
    "we note that if we extend the matter spectrum from cosmic emuusing a power law for @xmath12 the predictions agree with those of hmcodeto @xmath133 per cent for both @xmath97 ; this is probably due to the fact that the halo - model prediction at @xmath12 involves an integral over many quantities that are accurately power laws , resulting in a close to power - law power spectrum .",
    "but for the @xmath99 coefficients .",
    "each model shown is divided by the hmcodeprediction with no @xmath6-cut imposed .",
    "we see that a cut in @xmath27 at @xmath118 induces per cent level deviations around @xmath134 and a cut at @xmath115 increases this to @xmath135 .",
    "hmcodeand cosmic emuagree at the per cent level until the finite @xmath6-range of cosmic emubecomes important .",
    "halofitdisagrees by as much as @xmath10 per cent around @xmath134 and this disagreement increases to @xmath136 per cent for higher harmonics.,width=132 ]    in fig .",
    "[ fig : cl ] we compare models at the level of their @xmath99 predictions .",
    "when the finite @xmath6-range of cosmic emuis unimportant , it agrees with the hmcodeprediction to one per cent .",
    "discrepancies with halofitat the @xmath10 per cent level arise from @xmath137 with maximum deviations of @xmath136 per cent for @xmath138 .",
    "a cut in power at @xmath118 impacts upon the @xmath99 at the per cent level around @xmath134 and a cut at @xmath115 at @xmath135 .",
    "( upper panel ) and @xmath104 ( lower panel ) correlation functions predicted using hmcode , with a width showing the spread that is obtained from different feedback models . in each case , source galaxies are taken to be fixed at @xmath113 , approximately the effective median redshift for lensing for cfhtlens , and we show the correlation functions predicted using the best fitting _ planck _ cosmology ( upper curve ) and the best fitting cfhtlens@xcite cosmology ( lower curve ) . for comparison , we also show the measured @xmath97 from the cfhtlenssurvey ; it can be seen that feedback fails to alleviate the tension between cfhtlensand _ planck _",
    "one can see that an ignorance of the details of feedback affects @xmath104 to much larger angular scales than @xmath103 , a consequence of it probing more non - linear regions of the matter distribution .",
    "baryonic feedback has an impact at the greater than per cent level for @xmath139 for @xmath103 and @xmath140 for @xmath104 . in all cases ,",
    "the effects of baryonic feedback are small relative to the errors in current data.,width=317 ]    in fig .",
    "[ fig : baryon_correlation ] we show the range of possible correlation function predictions given by our power spectrum fits to the baryonic feedback models , where the region enclosed by the curves is the region that our fits to the owls feedback models occupy ( the centres of the ellipses in fig .",
    "[ fig : contours ] ) .",
    "we generate these using hmcodepredictions with parameters @xmath57 and @xmath141 taken from the centres of the ellipses in fig .",
    "[ fig : contours ] .",
    "we also show data from the cfhtlensanalysis of @xcite so that ignorance of the details of feedback can be compared to the current errors in data . for current data we see that the effect of feedback is small compared to the errors , but data that will be available in the near future will increase in accuracy and feedback processes will have to be accounted for .",
    "[ fig : baryon_correlation ] also shows that baryonic feedback does little to alleviate the tension between the best - fitting cfhtlenscosmology and that of _",
    "planck_. for our case of sources fixed at @xmath113 baryonic feedback only has an effect at the greater than per cent level for @xmath139 for @xmath103 and @xmath142 for @xmath104 . in a forthcoming paper ( joudaki et al . in prep ) constraints on @xmath57 and @xmath141 , together with cosmological constraints when these parameters are marginalized over , will be presented using the cfhtlenstogether with that from rcslens .",
    "alternative approaches have been investigated to model the impact of feedback on weak - lensing observables , all of which use data from the owls hydrodynamic simulations : @xcite model the owls data by refitting the coefficients from their power - series expansion of the one - halo term and advocate marginalizing over these coefficients to immunize against biases due to feedback .",
    "@xcite construct polynomial fits to the ratio of power spectra from feedback models to the dmonlymodel ; again the coefficients of these polynomials could feasibly be constrained by data . however , to fit each model over the scale redshift range required 15 coefficients , compared to only 2 in our approach . with a fixed ( _ wmap_9 ) cosmology ,",
    "@xcite find a preference for feedback in the cfhtlensdata .",
    "@xcite reanalysed the cfhtlenssurvey but adding a single parameter that governs the amplitude of agn feedback , which was taken to be given by the ratio of power from the agnto dmonlysimulations .",
    "they find only a weak preference for feedback , but find that agn feedback is insufficient to resolve tension between the cfhtlensdata and that of the _ planck _ satellite .",
    "an identical conclusion is reached by @xcite using a similar method . @xcite",
    "propose using a principal component analysis method , by which components of the power spectrum that are most affected by feedback are removed .",
    "assuming that feedback is independent of cosmology , they show that the data could be fitted with as few as 4 components removed .",
    "our method may be preferable to this as it potentially allows one to capture the coupling between feedback and cosmological parameters , via their effects on the halo profiles .",
    "we have shown that the halo model can be optimized so that it accurately reproduces power spectra measured from dark - matter @xmath0-bodysimulations across a range of cosmological models for @xmath143 and @xmath144 , provided we are willing to introduce a number of empirical modifications to its ingredients .",
    "we achieved this by calibrating our model to the ` node ' simulations of cosmic emuof @xcite .",
    "our success reflects the fact that the halo model is built on well - posed theoretical ingredients , which naturally adapt to changes in cosmology in a sensible fashion .",
    "our fits are accurate at the @xmath10 per cent level , which represents an improvement over the currently used halofitmodel of @xcite .",
    "cosmic emuitself is quoted to be accurate to @xmath10 per cent at @xmath118 and so our fit is as good as possible at the current level of ignorance at this scale . even in the dark - matter - only case ,",
    "our accuracy statement comes with the caveat that we have only tested a limited range of plausibly interesting cosmologies .",
    "in particular , we have concentrated on the parameter cube of the cosmic emuof @xcite , which contains cosmological parameters within the @xmath90 region of the @xcite results for the standard cosmological model .",
    "the advantage of the halo - model approach is that it can be simply expanded beyond the parameter cube of cosmic emu .",
    "we demonstrated that our model is able to produce reasonable power for @xmath12 and it can also produce spectra for @xmath13 , greater than allowed by cosmic emu .",
    "given the large amount of tested theoretical input that goes into the halo - model calculation , we expect that our model should produce sensible spectra for higher redshifts and smaller scales . for small deviations from the standard cosmological paradigm , such as dark energy with time - varying equation of state , or for models with small amounts of curvature",
    ", we also expect our answers to be accurate .",
    "if one were interested in the power spectrum of radically different models , such as very curved models or those qualitatively different linear power - spectrum shapes , we would advise caution , as our model has not been tested to these extremes .",
    "our approach also contrasts with that employed by @xcite and @xcite who advocate replacing a theoretically motivated one - halo term with a power - series expansion and fitting this expansion term - by - term . combining this approach with",
    "perturbation theory produced excellent results in the quasi - linear ( @xmath145 ) regime .",
    "however , it is not obvious how to extend their predictions to smaller scales than the smallest constrained by these authors ( @xmath146 ) , as their empirical power series has no physical requirement for sensible behaviour at smaller scales . given the necessity of these smaller scales in producing usable weak - lensing predictions , we therefore prefer our approach",
    ". a future avenue of fruitful research may be to combine the power of our approach of a physically motivated fit to the one - halo term with the perturbation - theory - inspired two - halo term advocated in these works .",
    "particularly this may improve accuracy in the quasi - linear regime and would certainly help in modelling around the bao scale , where our @xmath10 per cent accuracy deviates from the per cent level accuracy of cosmic emu .",
    "baryonic feedback has a large impact on the power at small scales .",
    "we demonstrated that the halo model is able to capture the influence of baryonic physics via only two redshift - independent parameters that govern halo internal structure .",
    "we also showed that this can be reduced to one parameter , at the loss of a small amount of discriminating power . using these two parameters",
    ", we were able to fit feedback recipes considered in the owls simulations at the 5 per cent level for @xmath147 and @xmath143 .",
    "because these parameters are firmly rooted in the halo - model apparatus , their effects are restricted to scales at which haloes affect the power spectrum .",
    "this is not guaranteed by other approaches , such as polynomial fits , which may produce unphysical effects .",
    "we also suggested that our approach is more likely to reproduce the correct _ coupling _ between baryonic feedback and cosmology , because it is rooted in halo properties .",
    "it is not obvious how to account for the cosmology dependence of baryonic feedback using existing fitting formulae or cosmic emu .",
    "finally , we showed how the power - spectrum predictions of hmcodetranslate into the lensing @xmath99 and @xmath97 correlation functions that are measured in a standard lensing analysis .",
    "for the dark - matter - only case , we showed that hmcodeagrees with cosmic emuat the per cent level for @xmath103 and @xmath99 and @xmath133 per cent for @xmath104 for all scales where the finite @xmath6-range of cosmic emuis unimportant .",
    "we suggest that hmcodeprovides a reasonable way of extrapolating cosmic emuto the smaller scales that are necessary to produce weak - lensing predictions . considering baryonic feedback , we showed how our matter power spectra translate into lensing predictions and showed that ignorance of the details of feedback is smaller than uncertainty on current data . for a survey similar to cfhtlens , baryonic feedback impacts on @xmath103 at the per cent level for @xmath139 and on @xmath104 for @xmath140 . in future lensing analyses",
    "( e.g.,joudaki et al . , in preparation ) we advocate marginalising over the halo parameters that we used to fit to the owls feedback models in order to produce unbiased cosmological constraints ; our range of fitted values for these parameters may be used as a prior for this purpose .",
    "alternatively , one might accept a given cosmology and then use the best - fitting baryon parameters as a means of learning about baryonic feedback .    in summary , and given our accuracy , we suggest that cosmic emube used if one is interested in the non - linear , gravity - only induced power spectrum for @xmath143 , and the required model is within the cosmic emuparameter cube . however , if one is interested in departures from the cosmic emuparameter space , accounting for the effect of baryonic feedback physics , or producing accurate lensing observables via a reasonable extrapolation , we then advocate hmcode .",
    "although we focused on weak lensing in this paper , we stress that hmcodeis useful for any application that currently uses halofit .",
    "this last point emphasizes the potential of the approach described in this paper .",
    "the halo model can readily be extended to take account of new physical processes and changes in the cosmological paradigm .",
    "one example for further work would be an application of our method to cover modified gravity models ( e.g.,@xcite ; @xcite ; @xcite ) where revised growth rates , collapse thresholds and internal halo structures can be predicted in part on analytic grounds , and where there is a growing effort on detailed simulations .",
    "another such example would be to look at the impact of massive neutrinos ( e.g.,@xcite ) on the matter spectrum .",
    "in such cases , being able to produce _ accurate _ power spectra will be important in order to distinguish standard and non - standard cosmological models .",
    "moreover , exploration of a large parameter space of models will inevitably be necessary , and there will therefore be a strong motivation to explore rapid means of generating non - linear power spectra .",
    "the code developed as part of this paper is available at https://github.com/alexander-mead/hmcodeor at request from the author .",
    "ajm acknowledges the support of an stfc studentship and , together with ch , support from the european research council under the ec fp7 grant number 240185 .",
    "part of this work was carried out at the 2014 ` modern cosmology ' conference at the centro de ciencias in benasque , spain .",
    "[ lastpage ]",
    "in fig .  [ fig : cosmology_variation_0.0 ] we show the response of the matter power spectrum to changes in cosmological parameters for the linear spectrum , and the non - linear spectrum predicted by both hmcodeand cosmic emu .",
    "this is shown for the cosmological parameters that cosmic emuallows one to vary ( @xmath148 , @xmath149 , @xmath85 , @xmath2 , @xmath53 @xmath86 ) over the range that cosmic emuallows ( see table  [ tab : emu_parameters ] ) via the ratio of the power as the cosmological parameter is varied compared to the power for the .",
    "this quantity says nothing about the absolute accuracy of the hmcodepredictions , but allows us to assess if the response of the power induced by changes in cosmological parameters is accurate .",
    "therefore , we also compute the ratio of the response of the hmcodeand cosmic emupredictions ( right - hand column ) .",
    "we see that , in general , the matter power spectrum response predicted by hmcodeis in excellent agreement with the simulations of cosmic emu , which is due to the large amount of well - tested theory in the halo model .",
    "the most obvious small discrepancies arise around the ` bump ' at @xmath146 produced by variations in @xmath53 and the degree of enhanced power at @xmath150 when @xmath2 is increased . in each case , the general trend is reproduced well by the halo model but the exact magnitude of the response is not predicted quite correctly .",
    "the accuracy of the predicted halo - model power spectrum depends on the ingredients used .",
    "we used fig .",
    "[ fig : cosmology_variation_0.0 ] to inform the ingredients used for hmcodein order to produce the correct power - spectrum response , before we fitted halo parameters to make accurate @xmath151 predictions .",
    "this was particularly important in the case of the response to variations in @xmath2 , which enter our model partly through the concentration ",
    "mass relation of @xcite and partly via the @xcite correction to a @xmath50 relation .",
    "the vast majority of concentration  mass relations available in the literature produce either no , or too little , response in the matter spectrum to changes in @xmath2 when the linear theory @xmath151 is held constant .",
    "in this appendix we discuss some of the practicalities of our approach of calculating the halo - model power spectrum .",
    "this appendix serves as a manual to the specific form of the halo - model calculation that our public fortran 90 code performs .",
    "the halo - model code used in this work is available at https://github.com/alexander-mead/hmcode .",
    "hmcodeis written such that by default it uses the @xcite approximation to the linear spectrum , which can be used if accuracy at linear scales is not demanded , and then converts this to a non - linear spectrum . if necessary there is the option to read in a tabulated linear spectrum , @xmath6 versus @xmath112 , as input ( e.g.,from camb ) .",
    "additionally , the cosmological parameters need to be specified because they are used in the fitting functions and in calculations of the growth function . in all cases",
    "the input linear spectra are renormalized to give the desired @xmath53 .    for our calculation of the growth function",
    ", we explicitly integrate the approximate expression for the logarithmic growth _ rate _ given in @xcite and derived in @xcite , @xmath152 where @xmath153 is the growth factor normalized to be @xmath8 today , @xmath154 if @xmath155 and @xmath156 if @xmath157 and @xmath158 if @xmath159 .",
    "this fitting formula and subsequent integration to find the growth factor is valid at the sub - per cent level even if @xmath2 deviates significantly from @xmath160 .",
    "the two halo term we use is : @xmath161\\delta^2_\\mathrm{lin}(k)\\ , \\ ] ] with @xmath162 .",
    "the parameter @xmath163 is calculated via @xmath164 and we do this by transforming the @xmath165 $ ] interval in @xmath6 to @xmath166 $ ] using the transformation @xmath167 .",
    "the @xmath163 integral ( and that of @xmath168 in equation  [ eq : sig_appendix ] ) requires knowledge of @xmath27 at very small or very large values of @xmath6 .",
    "it is impractical to provide a tabulated linear spectrum over such a large range of scales and so we interpolate beyond the boundaries of the input linear spectrum using the scaling @xmath169 at small @xmath6 , and the approximate scaling @xmath170 at high @xmath6 .",
    "extremely accurate values of the power at each of these asymptotes are not necessary , because they contribute quite negligibly to the integral , but it is necessary for the linear power not to be badly wrong , or set to zero unphysically .",
    "the aim is to numerically evaluate the integral in equation  ( [ eq : halopower ] ) . to do this",
    "we find it convenient to convert from an integral over @xmath33 to one over @xmath171 : @xmath1724\\pi\\left(\\frac{k}{2\\pi}\\right)^3\\frac{1}{\\bar\\rho}\\cr&\\times\\int_0^\\infty m(\\nu ) w^2(\\nu^\\eta k , m ) f(\\nu)\\;\\mathrm{d}\\nu\\ . }",
    "\\label{eq : halopower_nu}\\ ] ] here @xmath173 and damps the one - halo term to prevent one - halo power from rising above linear at the largest scales .",
    "@xmath174 and bloats haloes while they maintain a constant virial radius .",
    "we integrate over a _",
    "finite _ range in @xmath79 that captures all haloes necessary to produce a convergent power spectrum at the scales we investigate . in testing",
    "we found that @xmath175 $ ] was sufficient to produce convergent results to @xmath176 and @xmath177 $ ] if one required power out to @xmath178 .",
    "convergence at higher wave numbers requires the minimum value of @xmath79 to be reduced , because low - mass haloes contribute to the power only at small scales .",
    "the halo - model integral in equation ( [ eq : halopower_nu ] ) requires knowledge of @xmath38 , @xmath33 , @xmath49 and @xmath179 , all as a function of halo mass . in practice",
    ", we tabulate these over the finite range in @xmath79 as an ` initialization ' step to the calculation .",
    "we optimized the number of points in @xmath79 in order to produce convergent results up to @xmath176 .",
    "@xmath168 is computed via @xmath180 where @xmath181 we convert the @xmath165 $ ] @xmath6 range of the integral in equation  ( [ eq : sig_appendix ] ) to a finite range in @xmath17 using @xmath167 with @xmath166 $ ] . since",
    "this integral is relatively expensive to compute , we generate a look - up table for @xmath168 with @xmath29 values logarithmically spaced between @xmath182 and @xmath183 .",
    "these radii correspond to all haloes of practical interest at low @xmath54 .",
    "if values of @xmath168 are required outside this range , then we interpolate beyond the table boundaries .",
    "this works extremely well because @xmath168 is a very smooth function in log space with the asymptotes approximating power laws to a very high degree of accuracy for standard cosmological spectra .",
    "the radial scale @xmath29 is related to the mass scale via @xmath184 .",
    "the halo window function in equation  ( [ eq : halopower_nu ] ) , @xmath36 , has an analytical form for an nfw profile @xcite : @xmath185\\cos(k_\\mathrm{s})\\cr & + [ { \\mathrm{si}}(k_\\mathrm{s}(1+c))-{\\mathrm{si}}(k_\\mathrm{s})]\\sin(k_\\mathrm{s})-\\frac{\\sin(ck_\\mathrm{s})}{k_\\mathrm{s}(1+c)}\\ , } \\ ] ] where @xmath186 , @xmath187 and @xmath188 are the sine and cosine integrals , @xmath189 , @xmath49 is the halo concentration and @xmath38 is the halo virial radius , related to the halo mass via @xmath190 and @xmath191 .",
    "the halo concentration is calculated using the prescription of @xcite , augmented by that of @xcite : @xmath192 where @xmath193 .",
    "the growth factor correction only applies if @xmath194 and is the asymptotic ratio of growth factors .",
    "the formation redshift is then calculated via @xmath195 where @xmath66 .",
    "we numerically invert equation  ( [ eq : zf ] ) to find @xmath55 for a fixed @xmath33 . if @xmath68 , then we set @xmath67 .",
    "the mass function we use in equation  ( [ eq : halopower_nu ] ) is that of @xcite : @xmath76\\mathrm{e}^{-a\\nu^2/2}\\ , \\label{eq : massfunction}\\ ] ] where @xmath77 , @xmath78 , @xmath196 and @xmath171 with @xmath197 ."
  ],
  "abstract_text": [
    "<S> we present an optimized variant of the halo model , designed to produce accurate matter power spectra well into the non - linear regime for a wide range of cosmological models . to do this , </S>",
    "<S> we introduce physically motivated free parameters into the halo - model formalism and fit these to data from high - resolution @xmath0-bodysimulations . for a variety of @xmath1cdmand @xmath2cdm models </S>",
    "<S> the halo - model power is accurate to @xmath3 per cent for @xmath4 and @xmath5 . </S>",
    "<S> an advantage of our new halo model is that it can be adapted to account for the effects of baryonic feedback on the power spectrum . </S>",
    "<S> we demonstrate this by fitting the halo model to power spectra from the owls hydrodynamical simulation suite via parameters that govern halo internal structure . </S>",
    "<S> we are able to fit all feedback models investigated at the 5 per cent level using only two free parameters , and we place limits on the range of these halo parameters for feedback models investigated by the owls simulations . </S>",
    "<S> accurate predictions to high-@xmath6 are vital for weak lensing surveys , and these halo parameters could be considered nuisance parameters to marginalize over in future analyses to mitigate uncertainty regarding the details of feedback . </S>",
    "<S> finally , we investigate how lensing observables predicted by our model compare to those from simulations and from halofitfor a range of @xmath6-cuts and feedback models and quantify the angular scales at which these effects become important . </S>",
    "<S> code to calculate power spectra from the model presented in this paper can be found at https://github.com/alexander-mead/hmcode .    </S>",
    "<S> [ firstpage ]    gravitational lensing : weak  cosmology : theory  dark energy  large - scale structure of universe . </S>"
  ]
}