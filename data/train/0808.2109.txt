{
  "article_text": [
    "in the last decades , due to the great improvement in the computer performance , computer simulations become a more and more powerful tool in exploring the nature of many physical phenomena@xcite . because the computer simulations can tune the microscopic details of the system",
    ", they provide a deep insight view of the physical system .",
    "however , because of the limitation of the cpu time and memory space , computer simulations can only investigate finite systems and thus all the simulation results carry certain finite - size effect . though the finite - size scaling@xcite analysis can be used to obtain the infinite - size results by extrapolating the finite - size results ,",
    "it is still rather appealing to investigate the system as large as possible , for the exact scaling function of physics system does nt know and the scaling function is invalid for small system size @xmath4 in many systems . thus an efficient parallel algorithm is of great importance and demanding .",
    "it is well - known that near the criticality , the so - called critical showing down effect will occur because of the divergence of auto - correlation time @xmath5 .",
    "this effect is rather harmful to simulations for one can not obtain independent configurations in the critical region . during the last two decades",
    ", much efforts have been taken to solve this problem@xcite.the swendsen - wang cluster(swc ) algorithm is one among the most successful algorithm which can largely reduce the dynamic exponent @xmath6@xcite .",
    "taking the ising model @xmath7 as an example , this non - rejecting , global flipping cluster algorithm consists following steps :    1 .",
    "traverse all the links connecting neighbor spins @xmath8 and @xmath9 .",
    "@xmath10 is the spin at site @xmath11 . if @xmath12 , connect these two spins with probability @xmath13 with @xmath14 being the temperature .",
    "connected links are also called bonds . 2 .",
    "construct the cluster , two spins belong to a cluster if and only if they are connected by a path of a connected links . 3 .",
    "assign a new random spin state to these clusters , all spins which belong to the same cluster have the same new spin state .",
    "goto the first step .",
    "this cluster algorithm has achieved great success after it was proposed .",
    "many extensions of this algorithm were proposed@xcite .",
    "one of them is the probability changing cluster(pcc ) algorithm@xcite . by introducing feedback mechanism into the swc algorithm",
    ", it can tune the critical temperature automatically .",
    "this powerful method shows its merit in many systems where the swc algorithm is applicable@xcite .",
    "however , unlike the molecular dynamics simulation which is inherent parallelism , the swc needs extra technics to parallelize it .",
    "there are many works on parallelizing the swc algorithm for specific machines@xcite and these methods have attained scalability with different degrees of success . there",
    "exist two commonly used parallel algorithm models for swc algorithm : mspm and dpm . taking the ising model as an example again , in the former model ,",
    "the lattice is decomposed into domains and then each domain is assigned to a processor called slave .",
    "all slave processors construct the cluster independently .",
    "when the slave processors finish constructing local clusters , another processor called master processor collects all the border clusters , connects them to form global clusters and broadcasts all the global clusters to all slave processors . in the latter model ,",
    "the lattice is again decomposed into domains and each domain is assigned to a processor .",
    "each processor connects spin simultaneously and sends its border cluster to neighbor processors .",
    "when neighbor processor receives the border cluster , synchronization is made to form global clusters .",
    "iterating the communications until all global clusters are constructed",
    ". the detailed parallel algorithm of both models will be described in the following section .    in this article",
    ", we improved the algorithm in ref . @xcite and present a new dpm parallel algorithm which is similar to ref .",
    "we analyze speedup of these algorithms with different temperature and different system size on the dawning 4000a and sgi onyx 3900 supercomputer . in the last section , we present two parallel pcc algorithms based on these two parallel algorithms .",
    "the remaining part of this article is organized as : in the sec .",
    "ii ( a ) and ( b ) , we describe both the mspm and dpm algorithms separately . in the sec .",
    "ii ( c ) , we compare the performance of these two algorithms . in the sec .",
    "iii , a parallel program for pcc is proposed .",
    "then comes the conclusion .",
    "in the mspm , the lattice is divided into domains and the domains are assigned to slave processors .",
    "the data decomposition technics is very important here since the bad data decomposition will cause the master processor overloaded@xcite .",
    "we will extend this point later .",
    "clusters are classified into two types : local clusters in which the whole cluster is in one domain , and global clusters in which the cluster spans more than one domain .",
    "each slave processor is responsible for constructing clusters inside the domain and assigning a new state to them .",
    "however , conflicts arise when global cluster emerges . in this parallel model , a master processor",
    "is introduced to solve the conflicts . for clusters who have border sites",
    "are the candidate of global clusters , the master processor gathers all the border sites , creates `` new lattice '' with these border sites , constructs clusters and assigns a new state to the `` new lattice '' .",
    "when the master processor finishes these steps , it scatters all the global clusters to the slave processors .",
    "the slave processors then flip the local clusters using the received information .",
    "this is illustrated in the fig .",
    "[ ms ] .    in this parallel model , the slave processors for one monte carlo sweep(mcs ) have the following steps :    1 .",
    "construct clusters using hoshen - kopelman cluster counting algorithm@xcite .",
    "each cluster has a unique identity through the domains .",
    "meanwhile , a cluster lookup table is built up which is intended to improve the efficiency of traversing all sites belonging to a cluster .",
    "as shown in fig . [ ms ] , the entry of this table is the identity of the cluster and the nodes are the pointers pointing to all sites belonging to this cluster .",
    "clusters in this table are marked with border flag if they have border sites .",
    "otherwise they are marked with interior flag .",
    "each site also has a pointer which points to the entry of the lookup table . with the help of these data structures ,",
    "it is very convenient to find all sites belonging to a cluster and to find the cluster to which this site belongs[hk ] .",
    "2 .   during this communication step",
    ", the slave processors send all the border sites to the master processor . for the illustration as described in fig .",
    "[ ms ] , we take the column border as an example .",
    "each slave processor sends its leftmost and rightmost columns to the master processor .",
    "the communication information contains the identity of the cluster to which the sites belong and state of the sites .",
    "3 .   traverse all the sites which belong to local clusters marked with interior flag and assign a random spin state to them . now",
    "the sites residing in the same cluster have the same random spin state .",
    "4 .   when the master processor finish constructing the global clusters , the slave processors receive the global cluster data structure from the master processor .",
    "it has the same data structure as the sending data .",
    "each slave processor visits all sites residing in the same cluster from the entry of the lookup table and assigns the received new state to these sites .",
    "the master processor for one mcs consists the following steps .    1 .",
    "construct the `` new lattice '' with the received sites . here",
    "we take the column sites as an example .",
    "the master processor aligns the received leftmost and rightmost columns from the left domain to the right domain .",
    "this step is shown in fig .",
    "2 .   construct the clusters using hoshen - kopelman cluster counting algorithm and assign a new state to this cluster .",
    "there is a little difference between the procedure done here and the procedure done in the slave processors . for the columns who are originally in the same slave processors , they have already connected to form clusters in the step [ hk ] , one need nt to activate these link again .",
    "one only needs to activate the link between neighbor domains .",
    "to make the situation clearly , we take fig .",
    "[ ms ] as an example .",
    "because the spins in the first column and second column have already be visited to form clusters , we only need to activate the link between the second column and the third column . after finishing this step ,",
    "each cluster now has a global cluster label .",
    "3 .   scatter all the cluster identity and its new state to all slave processors .",
    "the advantages of this algorithm are as follows .",
    "for ease of discussion , a two dimensional lattice is considered throughout this paper .",
    "firstly , in our implement of this algorithm , the slave processors are mapped into two dimensional square array to minimize the communication .",
    "let @xmath15 denote the number of slave processors and @xmath4 denote the linear size of the lattice . in this division scenario ,",
    "each slave processor has domain of lattice whose size is @xmath16 . on the other hand ,",
    "the size of border sites received from slave processors by the master processor is @xmath17 .",
    "since the inequality @xmath18 always holds in the simulation , this division method avoid overload in the master processor .",
    "to some extent , this division method can remove the bottleneck mentioned in ref .",
    "@xcite .    secondly , the algorithm in ref .",
    "@xcite used a global memory , thus the communication costs is negligible in that case .",
    "however , in modern supercomputers , the mpi is always used to exchange the message between different processors . in this paper , we intend to devise a new algorithm based on mpi . for the communication",
    "is more time - consuming than the computation , the performance of this algorithm critically relies on the performance of the communication",
    ". we will give experimental results about this point in the sec.ii ( c ) .",
    "the time cost of this algorithm can be counted as follows .",
    "let @xmath19 denote the total number of sites , @xmath15 is the number of slave processors , @xmath20 is the per - integer transfer time , @xmath21 is the per - site bond - activating time , and @xmath22 is the time cost in the @xmath11th step mentioned above . the domain size in each processor is @xmath16 .",
    "for simplicity , we assume the lattice is divided into square array of domains .",
    "let us define the time required by slave processors and mater processor for step @xmath11 by @xmath23 and @xmath24 respectively .",
    "the time cost in the first step of the slave processors is @xmath25 the second step of slave processors is that the master processor gathers all boundary sites from each domains .",
    "the time cost in the gathering process is @xmath26 where we have omitted the startup time @xmath27 for communication . since the third step of slave processors and the first and second steps of master processor are executed simultaneously , the time cost is the maximum time needed for these steps .",
    "we have used a linear algorithm to create `` new lattice '' , therefore the time cost of this step scales linearly with the size of the `` new lattice '' .",
    "we denote @xmath28 the time cost for one site .",
    "the total size of this `` new lattice '' is @xmath29 .",
    "thus we have @xmath30 the time cost in the second step of master processor is the same as the first step in slave processors except for the size of lattice .",
    "therefore we have @xmath31    the time cost in the third step of master processor depends on the number of global clusters , therefore it depends on the simulation temperature .",
    "let @xmath32 denote the total number of the global clusters .",
    "the time cost in this scattering process is @xmath33    with the help of the lookup table , the time cost in fourth step of the slave processors depends on the number of clusters received by each slave processors . for simplicity ,",
    "we use average size of cluster in each slave processor . @xmath34",
    "the total time cost of this algorithm in one mcs therefore is    @xmath35    equation ( [ mseq ] ) is a little complicate , however , as will be shown in the computer experiments , many terms are negligibly small and this equation will reduce to a single form .",
    "this will be shown later .      as mentioned in the sec .",
    "ii(a ) , conflicts arise when processor flips the spins which belong to a global cluster . in the mspm ,",
    "the conflicts are solved by introducing a master processor . however , in the dpm , the conflicts are solved by the communication between all processors . the lattice is again divided into domains and assigned to a processor in the dpm .    for the dpm , each processor for one mcs consists the following steps :    1 .   visit all sites inside the domain and active the link between two nearest - neighbor sites with probability @xmath13 if they have the same spin state .",
    "this procedure can be done using hoshen - kopelman cluster counting algorithm .",
    "each cluster must have a unique identity .",
    "as in the mspm , a lookup table is also built up and all sites have a pointer pointing to the cluster which they belong to . [ dpstep1 ] 2 .",
    "interchange the state of its boundary sites to the nearest - neighbor processors in each direction . a reference array",
    "is built up to mark whether the two aligned neighbor sites belong to the same cluster or not .",
    "this step is illustrated in fig .",
    "3 .   for each cluster",
    "residing in this domain , pick a random spin sate and assign it to this cluster while the state of the sites in this cluster is not changed . in this step ,",
    "the conflicts between different processors are disregarded .",
    "[ dpm3 ] for each processor , interchange the boundary labels and the new spin state of the boundary sites with the nearest - neighbor processors in each direction .",
    "[ scf ] if the received sites are in the same cluster with the aligned sites , the processor compares the local label with the received label .",
    "if the received label is less than the local one , assign the received label and the received new spin state to this cluster .",
    "goto step [ dpm3 ] until no change is found in the step [ scf ] . with the help of the lookup table ,",
    "assign the new spin state to all sites inside this clusters .",
    "now , all conflicts are solved and a mcs is finished .    at first sight , this parallel algorithm is very time - consuming for many communications are involved before all global clusters are constructed . however , unlike the mspm , the performance depends on the number of global clusters , i.e. the simulation temperature , the communication data is constant in the dpm .",
    "thus the performance of this parallel model is temperature - independent .    to count the time cost",
    ", we use the same notations introduced above . for simplicity",
    ", we also assume the lattice is divided into square array of domains .",
    "the time cost in the first step is @xmath36 in the step @xmath37 , the processor needs to interchange its boundary spin state with its nearest neighbor processors .",
    "thus the time cost at this step is @xmath38 the factor @xmath39 denotes four directions in the case of two dimensional system . in the communication step @xmath39",
    ", the processor needs to send its boundary label to the furthest processors in the worst situation when a global cluster spans the who lattice .",
    "this happens near the critical region where the cluster percolates . in this case",
    ", it needs @xmath40 iterations in the step @xmath39 .",
    "the time cost of this step is @xmath41 the factor @xmath39 also accounts for the four directions . because the time cost in step @xmath42 is less expensive and is proportional to @xmath43 , we write the total time costs in steps @xmath42 as @xmath44 thus the total time cost @xmath45 in one mcs is    @xmath46    in the implement of this algorithm , we found that @xmath47 , thus the speedup of the dpm scales linearly with the number of processors .",
    "we analyze the performance of these two algorithms on the onyx3900 supercomputer and dawning 4000a supercomputer .",
    "the results are compiled in fig .",
    "[ speedup ] and fig .",
    "[ dawning ] .",
    "the results in these figures give the speedup of the two algorithms with different lattice size and temperature . here",
    "are a few observations which can be made when analyzing these figures .    *",
    "a first observation is that both two algorithms are independent of the temperature , i.e. the number of total global clusters .",
    "it is reasonable in dpm for the scaling function eq .",
    "( [ dpeq ] ) is independent of the number of the global clusters .",
    "however , in the mspm , @xmath45 in eq .",
    "( [ mseq ] ) explicitly depends on the number of global clusters .",
    "we measured the time cost of different steps in eq .",
    "( [ mseq ] ) and found that this term is not dominant . * the mspm in this paper has a linear speedup . in ref .",
    "@xcite , the author found that their algorithm only has the maximum speedup of @xmath48 , as the number of processors increases .",
    "this is due to the overload of the master processor . in this paper , by appropriate decomposition and message passing , the master processor never gets overloaded in this case .",
    "thus , the mspm algorithm presented in this paper to some extent improved the algorithm in ref . @xcite .",
    "* as the @xmath4 increases , the speedup of the dpm will also increase . at first sight",
    "this is unreasonable since the increase in the lattice size will reduce the cache hit rate and therefore reduce the performance of this algorithm .",
    "nevertheless , the speedup of the dpm is @xmath49 .",
    "it is straightforward to see that as the @xmath4 increases , the speedup will also increases . *",
    "the speedup of the mspm exceeds the speedup of the dpm on the dawning 4000a supercomputer while on the sgi onyx3900 the situation reverses .",
    "this is due to the difference in the architecture of these two supercomputers .",
    "the communication between the different nodes on the dawning supercomputer uses the second level network connection which costs more time than that of the sgi onyx3900 supercomputer . because the dpm involves massive and many steps communication , the performance deteriorates on slow network . on the other hand , when the performance of the communication is largely enhanced , the speedup of the dpm will exceed that of the mspm as in the case of the sgi onyx3900 supercomputer for the mspm still carries many serial elements .",
    "the master / slave processor needs to wait before slave / master processor finishes .",
    "the basic notion in the pcc algorithm is the criteria of percolation . in finite - size systems , there are various criteria of percolation and each of them may lead to different results .",
    "however , in the thermodynamic limit , the results obtained by different criteria converge .",
    "two criteria are presented in ref .",
    "@xcite , one of which is the extension rule and the other is the topological rule .",
    "the former rule is that one cluster spans the whole simulation box at least one of the @xmath50 directions in d - dimensional systems .",
    "the latter rule is that one cluster winds around the simulation box at least one of the @xmath50 directions in d - dimensional systems .",
    "one can also devise other criteria if and only if they will converge in the thermodynamic limit .    in our study , we take extension rule as an example .",
    "it is very similar with different criteria in detailed algorithm .",
    "a naive implement of the extension rule is by enumerating pathes of all clusters and counting whether there exists a cluster spanning the whole lattice .",
    "however this simple method is inefficient , so we use another way . for the open boundary condition , it is straightforward to count the spanned cluster in that one only needs to count whether there is a cluster occupying both leftmost and topmost boundary or topmost and bottommost boundary . for the periodic boundary condition , because there is no topmost and bottommost boundary , the situation is a little complicate .",
    "one has to project all clusters onto x axis or y axis and calculate the length of these clusters , this is illustrated in fig .",
    "[ percolating ] .",
    "let @xmath51 is a range operator which calculate the range of cluster @xmath52 in _",
    "_ i__th dimension . before activating the links between domain 1 and domain 2 ,",
    "if we only consider @xmath53 , then , @xmath54\\bigcup [ 5,7]$ ] and @xmath55 $ ] .",
    "after activating , the cluster 1 in domain 1 and cluster 8 in domain2 are merged , the ranges of these clusters must be updated , i.e. @xmath54\\bigcup[5,15]$ ] . after all global clusters are constructed",
    ", it is easy to find out the spanned cluster . in fig . [ percolating ]",
    ", the system is not percolating for the range of the global cluster 1 does nt cover the whole range of the system .",
    "for the open boundary condition case , it is straightforward to count the spanned cluster , we only concentrate our attention on the periodic boundary condition which is widely used in computer simulations . in the step 1 of both the mspm and the dpm , range of projected cluster is calculated .",
    "the range of a cluster , together with its label is gathered by master processor in the mspm and is sent to its neighbor processors in the dpm . when clusters are merged into larger cluster",
    ", the range of merged clusters must be updated .",
    "when all global clusters are constructed , in the mspm , the master processor enumerates all global clusters to find out whether there is a cluster whose range is @xmath56 $ ] in one direction , while in the dpm , all processors traverse all clusters inside its domain to find out whether there exists a percolating cluster , because the range of the clusters inside each domains are the range of global cluster at this domain .    in these two parallel pcc algorithms , extra time",
    "is only needed at the first step and final step in both mspm and dpm .",
    "we have measured the speedup of these two parallel pcc algorithms and find the time cost is very similar to that of mspm and dpm .",
    "we present two parallel swendsen - wang cluster algorithms based on master - slave parallel model and data - parallel model using message - passing interface .",
    "the speedup of these two parallel algorithms is measured both on the sgi onyx3900 and dawning 4000a supercomputers .",
    "the scaling function of the time cost for both algorithms are derived . at last section , two parallel probability",
    "changing cluster algorithms are proposed .",
    "the authors would like to thank r. ziff for helpful discussion with the percolation criteria during the 2nd international workshop on computational physics , hangzhou .",
    "they are also indebt to prof .",
    "wang at national university of singapore for hospitality where partial of this work was done .",
    "the simulations are carried out at center for engineering and scientific computation , zhejiang university and shanghai supercomputer center ."
  ],
  "abstract_text": [
    "<S> in this article , we present two different parallel swendsen - wang cluster(swc ) algorithms using message - passing interface(mpi ) . </S>",
    "<S> one is based on master - slave parallel model(mspm ) and the other is based on data - parallel model(dpm ) . </S>",
    "<S> a speedup of @xmath0 with @xmath1 processors and @xmath2 with @xmath3 processors is achieved with the dpm and mspm respectively . </S>",
    "<S> the speedup of both algorithms at different temperature and system size is carefully examined both experimentally and theoretically , and a comparison of their efficiency is made . in the last section , based on these two parallel swc algorithms , two parallel probability changing cluster(pcc ) </S>",
    "<S> algorithms are proposed . </S>"
  ]
}