{
  "article_text": [
    "relative free energy computations have long been of interest , and biological applications promise to be of particular importance @xcite . as examples , it would be desirable to accurately and rapidly estimate free energy changes resulting from the opening of an ion channel , the binding of a ligand , and alchemical mutation among a series of protein ligands .",
    "ligands might include potential drug compounds or varying sequences of nucleic acids ( rna and dna ) .",
    "strategies for computing free energy differences date back to kirkwood @xcite and zwanzig @xcite who pioneered thermodynamic integration and free - energy perturbation strategies .",
    "many computational strategies have since been developed for molecular systems ( e.g. , @xcite ) .",
    "`` fast - growth '' methods @xcite are the focus of the present paper .",
    "the impetus for these approaches comes from the work of reinhardt , hunter , and coworkers @xcite who recognized that computations could readily employ a microscopic analog of the inequality between work and free energy .",
    "the principle is readily illustrated in an `` alchemical '' context where one wishes to compute the free energy difference between two systems described by different potential energy functions , @xmath2 and @xmath3 , and parameterized by the switching variable @xmath4 according to an extended potential function : @xmath5   \\ ; , \\hspace{1 cm } 0 \\leq \\lambda \\leq 1 \\ , , \\ ] ] where @xmath6 is a set of configurational coordinates .",
    "if one performs a series of rapid `` switches '' ( described below ) between the two systems using an amount of work @xmath7 in each switch , the free energy difference is bounded according to @xcite @xmath8 where the @xmath9 brackets indicate averages over many switches starting from equilibrium ensembles of either start ( @xmath10 ) or end ( @xmath11 ) systems .",
    "( the distinct `` systems '' could also describe different conformations of a single system constrained to distinct values of a reaction coordinate . )    the potentially rapid , non - equilibrium events used to compute @xmath12 in eq .",
    "( [ dfbounds ] ) thus provide a computational estimate of the equilibrium quantity @xmath0 .",
    "however , the bounds will not be tight unless the switches are sufficiently slow , offsetting some of the computational savings .",
    "subsequent work by jarzynski @xcite sidesteps , at least in principle , some of the limitations by permitting _",
    "direct _ computation of @xmath0 from a single set of rapid switches , via the simple , _ exact _ relation , @xmath13 however , estimates for @xmath0 generated using eq .",
    "( [ dfexp ] ) are highly sensitive to small values of @xmath7 and significant errors can arise when the width of the distribution of @xmath7 values exceeds @xmath14 @xcite .",
    "hummer s recent work with a small molecular system concluded that little , if any , advantage was gained from the fast - switching approach @xcite .    in the past improvements",
    "have been sought in the procedure for generating a set of work values @xmath15 to be analyzed according to eq .",
    "( [ dfbounds ] ) or ( [ dfexp ] ) .",
    "in particular , one can switch between @xmath10 and 1 along arbitrary paths , perhaps using more than one switching parameter as initially discussed by reinhardt and coworkers for the fast - switching approach by @xcite .",
    "subsequent exploration of optimal switching paths has been pursued by many workers @xcite .",
    "in fact , the exploration of different paths in alchemical free - energy computations pre - dates the fast - switching approach , and was pursued in free - energy - perturbation and thermodynamic integration efforts  e.g. , @xcite .    the present study , by contrast , attempts to optimize the use of the data @xmath15 which has already been generated , by using a combination of block - averaging and extrapolation .",
    "this additional statistical analysis is _ needed _ to bypass the systematic error inherent in finite data samples @xcite .",
    "[ fig : run - block ] illustrates the basic points . the running averages ( solid lines ) based on eq .",
    "( [ dfexp ] ) exhibit erratic behavior , and it is essentially impossible to judge from these whether the computation has converged to an answer .",
    "however , the same data considered in block - averages ( error bars ) is well - behaved and , as seen below , well - defined .",
    "only the block - averages could be considered for extrapolation to the `` infinite - data '' limit .",
    "cases of insufficient data requiring extrapolation are of great interest because the size of biomolecular systems often makes relative free energy estimates extremely costly .    following jorgensen and ravimohan @xcite and jarque and tidor @xcite",
    ", we examine alchemical mutations between methanol and ethane in explicit water solvent .",
    "the authors are unaware of any previous application of jarzynski s relation to _ alchemical _ transformations in a molecular system , although hummer performed a methodical study of the inter - methane distance dependence of the free energy @xcite .",
    "our results indicate that the combined use of block - averaging and extrapolation is very promising and warrants additional investigation .",
    "the approach produces successful and reasonably reliable relative - free - energy estimates even from _ very fast switches of only one or two steps _ , which generate extremely broad , highly - non - gaussian distributions of work values . in every case we examined ,",
    "extrapolation of the data yielded a better estimate than direct averaging alone .    in outline , this letter is organized as follows : sec .",
    "[ sec : genl - alchem ] briefly describes `` fast - growth '' computations and gives simulation details . in sec .",
    "[ sec : block ] we define the block averages , and the extrapolation procedure is discussed in sec .",
    "[ sec : extrap ] . in sec .",
    "[ sec : results ] we summarize our results and discuss future work , including potential applications of the approach to large biomolecular systems .",
    "we also discuss implications for other approaches to free energy calculations .",
    "this section fills in some details regarding the theory governing an `` alchemical '' free energy change and its implementation using a rapid - switching strategy .",
    "alchemical changes are transformations between hamiltonians which describe different molecules ; molecular isomerization is mathematically analogous but not considered here .",
    "the free energy difference between the two states is formally given by the ratio of the partition functions according to @xmath16 jarzynski s relation ( [ dfexp ] ) is derived from this definition .",
    "the so - called free - energy - perturbation ( fep ) procedure for computing relative free energies @xcite is a well - established method for molecular systems @xcite which we use as a benchmark for understanding systematic errors .",
    "fep computations entail a number of equilibrium simulations performed at a set of _ fixed _ values of @xmath4 ; for example , our fep result quoted in sec .",
    "[ sec : results ] uses simulations at @xmath17 .",
    "the total free energy change is estimated as the sum of the incremental changes , which are computed based on the analog of eq .",
    "( [ dfexp ] ) involving @xmath18 , where @xmath19 is the work or energy difference between configurations at different @xmath4 values .",
    "fast - growth algorithms have been discussed in detail elsewhere ( e.g. , @xcite ) , so we merely sketch the approach . the general procedure for computing a `` fast - growth '' free energy difference  via eq .",
    "( [ dfexp ] ) rather than ( [ dfratio ] )  begins with the generation of an equilibrium ensemble of starting ( @xmath10 ) configurations , perhaps by molecular dynamics simulation as is done here .",
    "one proceeds by ( i ) choosing a configuration from the equilibrium ensemble , ( ii ) incrementing the potential energy function ( [ ualchem ] ) to a new , greater value of @xmath4 ( keeping the configuration fixed ) and ( iii ) relaxing the system at the new @xmath4 value . steps ( ii ) and ( iii )",
    "are repeated until a value @xmath20 is reached . in our implementation , the @xmath4 increments in ( ii ) are uniform and the relaxation stage ( iii ) consists of a single molecular dynamics ( md ) `` relaxation '' step , following the `` fast - growth '' convention @xcite .",
    "a uniform increment of @xmath21 , for instance , corresponds to 20 `` @xmath4 steps '' and would require 19 md steps , as none is necessary at @xmath11 .",
    "the work for any such switch is computed based only on the potential energy increments and not the relaxation dynamics .",
    "thus , if @xmath22 denotes the final configuration of the system after it is relaxed at the @xmath23th value @xmath24 , the work calculated from @xmath25 \\;,\\ ] ] where _ the same configuration _ is evaluated at two different @xmath4 values . finally , to evaluate the averages in eqs .",
    "( [ dfbounds ] ) and ( [ dfexp ] ) , one uses additional members of the @xmath10 equilibrium ensemble to generate subsequent values of @xmath7  starting from step ( i ) , above .",
    "simulations of the methanol@xmath1ethane `` transmutation '' were performed within the charmm molecular dynamics package .",
    "both methanol and ethane were modeled in the united - atom picture : methanol was represented as a three - atom ( c , o , h ) molecule and ethane as a two - atom ( c , c ) molecule .",
    "the solvent used 125 tip3 water molecules ( for both @xmath10 and 1 ) in a periodically replicated box of ( 15.6 )@xmath26 . to facilitate comparison with earlier studies ,",
    "electrostatics and van der waals interactions were both shifted to zero at a cutoff of 8  .",
    "molecular dynamics steps ( performed at fixed @xmath4 values ) used the leapfrog verlet algorithm . the same simulation procedure and parameters were used for free energy perturbation calculations .",
    "while block - averaging is straightforward , its _ repeated application for growing block sizes to a non - linear transformation _",
    " such as taking the log of an average of exponentials in jarzynski s relation ( [ dfexp ] )  turns out to yield rich , well - behaved data : see fig .",
    "[ fig : run - block ] . the procedure and",
    "some implications are discussed now .",
    "we construct block averages @xcite from a set of , say , @xmath27 work values + @xmath28 by applying jarzynski s relation ( [ dfexp ] ) to a series of blocks , each containing @xmath29 values .",
    "more specifically , we define the @xmath30-block - averaged estimate for the free energy as @xmath31 where the individual block averages are defined by @xmath32 the ratio @xmath33 denotes the largest integer less than or equal to the literal fraction , and is never less than 30 in our analysis . because of potential correlations in the sequence @xmath28 we randomly re - sort the values prior to computing the block results presented here .",
    "we note that larger block sizes , @xmath30 , could be considered with a bootstrap @xcite or subsampling @xcite analysis .    the true free energy difference of eq .",
    "( [ dfexp ] ) is @xmath34 , and the other limit gives the average work , @xmath35 : see fig .",
    "[ fig : run - block ] . in general",
    ", a finite value of @xmath30 indicates that the average in eq .",
    "( [ wblock ] ) is performed from a poor sample of the @xmath7 distribution , with @xmath30 determining how much of the tails of the distribution are included in the average . however , the averaging of these poor samples in eq .",
    "( [ dfblock ] ) yields a well - defined descriptor of the finite-@xmath30 statistics . in the present case , the boltzmann - factor form ensures monotonic behavior , so that @xmath36 the essence of which was noted by jarzynski @xcite ; see also @xcite .",
    "the usual relation between the average work and free energy ( [ dfbounds ] ) is simply a weaker case of the more general inequality ( [ dfn_ineq ] ) .",
    "the uncertainty in the finite-@xmath30 free energy values , @xmath37 , is estimated by twice the standard error of the mean , @xmath38 which gives roughly a 90% confidence interval @xcite .",
    "this is the quantity used to compute error bars and uncertainties .",
    "while extrapolation and data - fitting are something of black arts , one can hope to derive meaningful information with a careful error analysis @xcite . here",
    "we discuss some simple , intuitively appealing schemes for extrapolating the block - averaged , finite - data free energies ( [ dfblock ] ) to the limit of infinite data .",
    "the motivation for our approach is the analysis of finite-_size _ effects in spin systems @xcite .",
    "inspection of the data on a linear scale , such as fig .",
    "[ fig : run - block ] , and in logarithmic plots suggests the simplest fit might be to a power law , @xmath39 a natural , related form considers a power series @xmath40 where the parameter @xmath41 can be chosen from a fit or some other way , such as by examining the leading @xmath42 behavior .",
    "our work with the form ( [ series - fit ] ) uses three parameters with @xmath43 , except where noted , and the fixed exponent @xmath44 chosen empirically , but based on some of the values fitted for @xmath45 in eq .",
    "( [ power - fit ] ) . naturally other exponents and polynomial degrees could be used .",
    "one drawback to these forms is clear : if the data do not include the leading @xmath42 behavior and the `` distance '' to extrapolate is great ( from @xmath46 to the first data point ; see fig .",
    "[ fig : extrap ] ) , the fits will not have good extrapolative power .",
    "we anticipate that an analytic understanding of the behavior of @xmath47 for model systems , to be pursued in future work , will shed light on extrapolation forms and methods .",
    "we now present estimates for the free energy difference of the methanol@xmath48ethane transformation , based on the block - averaging and extrapolation presented in the previous two sections .",
    "our focus is the methanol - to - ethane direction of the transformation because it is more challenging and so presumably a better model for larger systems .",
    "the basic results are surprising and exciting .",
    "first , successful extrapolation to reasonably accurate free energy values does appear to be possible in the methanol@xmath48ethane system .",
    "moreover , for fixed amounts of computer time , the extrapolated estimates appear to be considerably better than standard fast - growth values , and can avoid errors of several kcal / mole resulting from insufficient data . if borne out for other systems , the ability to make estimates from a relatively small number of very rapid switches would mean dramatic efficiency gains .",
    "[ fig : extrap ] shows a sample extrapolation , based on eq .",
    "( [ series - fit ] ) , for @xmath49 switches of 20 @xmath4 steps each .",
    "note that the _",
    "_ un-__extrapolated , `` direct '' free - energy estimate  based on application of eq .",
    "( [ dfexp ] ) to the same data  exceeds both the extrapolated value and the reliable fep estimate by 7 kcal / mole@xmath50 .",
    "thus , with a limited amount of data , extrapolation of the block - averaged values yields a much better estimate .",
    "lcccc method & @xmath51 & uncerty & @xmath4 steps & tot .",
    "steps + direct & 7.37 & [ 2.1 ] & 200 & @xmath52 + extrapolation & 5.68 & 1.66 & 200 & @xmath52 +   + direct & 11.2 & [ 5.9 ] & 200 & @xmath53 + direct & 8.50 & [ 3.2 ] & 20 & @xmath53 + extrapolation & 4.93 & 0.960 & 200 & @xmath53 + extrapolation & 6.41 & 1.21 & 20 & @xmath53 +   + direct & 12.7 & [ 7.4 ] & 20 & @xmath54 + direct & 8.68 & [ 3.4 ] & 2 & @xmath55 + extrapolation & 4.87 & 1.08 & 20 & @xmath54 + extrapolation & @xmath56 & @xmath57 & 2 & @xmath55 +    @xmath58 these values change to 5.03 and 1.85 for @xmath59 in eq .",
    "( [ series - fit ] ) with a substantially improved goodness - of - fit measure .",
    "table [ table ] presents quantitative results for the methanol - to - ethane transformation .",
    "the extrapolations are uniformly superior to the direct estimates for any fixed amount of computer time and consistently avoid errors on the order of several kcal / mole ( where 1 kcal / mole @xmath60 ) for smaller amounts of data .",
    "total computer times for the tabulated results range from 2 nsec .",
    "( @xmath61 switches of 200 steps ) down to just 10 psec ( @xmath61 2-step switches ) of non - equilibrium molecular dynamics simulation .",
    "the `` total steps '' column does not include the computer time expended on generating an equilibrium ensemble at @xmath10 because it is unlikely that one would investigate the transmutation of a system which has not already been subjected to an equilibrium study .",
    "we estimated upper and lower bounds simply by extrapolating , independently , from the sets of upper and lower limits of the confidence intervals ; recall eq .",
    "( [ conf ] ) .",
    "statistical uncertainties were not given for the direct estimates because the systematic error is clearly more significant than the statistical : the bracketed deviations in table [ table ] indicate the direct estimates differ dramatically from the free - energy perturbation ( fep ) result . recall that the fep approach was outlined in sec .",
    "[ sec : genl - alchem ] .",
    "the power of the extrapolative approach is underscored by the challenging character of the distributions of work values under consideration .",
    "the distributions are all quite broad and asymmetric : standard deviations range from 12 kcal / mole @xmath62 ( for the 200-step switches ) to 24 kcal / mole @xmath63 ( 2 steps ) , and third moments range from 72% of the standard deviation ( 200 steps ) to 100% ( 2 steps ) . thus , although all of the tabulated simulations involve very rapid switches  of less than 1 psec .  of molecular dynamics time per switch ",
    "the substantial differences in the distributions indicate that the data sets are quite distinct .",
    "we also noted a degree of robustness in trials with related but different forms and exponents @xmath41 ( results not shown ) which typically yielded consistent , if slightly inaccurate , results across data sets from widely disparate numbers of @xmath4 steps  and hence disparate computer times and work distributions .    despite the success of the fitting form used here ,",
    "superior extrapolations may be possible .",
    "the forms employed here ( see sec .",
    "[ sec : extrap ] ) are empirical , so a theoretical basis should provide additional insight . lacking",
    "that , a more systematic exploration of the implicit parameters  the exponent @xmath41 in ( [ series - fit ] ) , the minimum number of switches per block , and the degree of the fitting polynomial  would also be valuable .",
    "another interesting trend illustrated in the data of table [ table ] is that for a fixed amount of computer time , _ direct _ estimates using fewer @xmath4 steps appear to give better results .",
    "the statistical errors ( data not shown ) are also better for direct estimates using more rapid switches .",
    "we have performed and analyzed extrapolative free energy estimates based on `` fast - growth '' alchemical simulations of a fully solvated methane@xmath1ethanol transformation .",
    "the results of table [ table ] suggest that the combined use of block - averaging ( sec .  [",
    "sec : block ] ) and extrapolation ( sec .",
    "[ sec : extrap ] ) permits accurate estimates from a relatively small amount of data which  when analyzed using the standard `` direct '' method  leads to unacceptably large systematic errors of several kcal / mole",
    ". extrapolated results , for our system , were _ always _",
    "better than standard , direct estimates .",
    "the approach also appears to be fairly robust , in that good results are achieved over ranges both of overall computer time and of alchemical switching speeds .",
    "our work builds on that of wood _ et al .",
    "_ , who perceptively proposed a first - order estimate of the systematic errors due to finite samples of data @xcite . the present method , however , is not limited to narrow work ( energy - change ) distributions as noted in sec .",
    "[ sec : results ] .",
    "this letter describes an initial exploration of a potentially important approach , and a number of important issues and questions deserve further exploration . to name a few :",
    "( i ) undoubtedly , simultaneous fits of forward ( @xmath64 ) and reverse switching data will provide more reliable free energy estimates ; ( ii ) we have not performed a quantitative analysis of the efficiency , both by comparison to standard `` fast - growth '' approaches as well as to free - energy - perturbation estimates ; ( iii ) how does the extrapolation approach generalize to larger biomolecular systems ? ( iv ) how universal are the behaviors of the finite - data estimates , @xmath65 , considered in the extrapolation ? ( v ) can theoretical scrutiny of simple models and distributions clarify the extrapolative procedure ?",
    "the ideas discussed here may also apply , with suitable modifications , to perturbative calculations .",
    "we have discussed methods for analyzing data from fast - switching simulations , but have not broached the possibilities for improved _ sampling _ of data .",
    "there appear to be a number of promising , unexplored avenues . instead of using a uniform alchemical increment @xmath66 , for example",
    ", one could adjust increments to ensure relatively constant work increments , following the example of perturbative calculations @xcite ; this approach could also be adapted for higher - dimensional alchemical coordinates already considered by others @xcite .",
    "improved sampling efficiency may also result from biasing the `` relaxational , '' fixed-@xmath4 dynamics to favor states with smaller work increments .",
    "finally , we note that the relationship between the approach described here and established statistical methods needs to be elucidated .",
    "elements of our approach , particularly the construction of `` finite - data '' block averages , clearly have been considered in `` bootstrap '' @xcite and `` subsampling '' @xcite statistical approaches",
    ". nevertheless , the authors are not aware of a similar practical  if _ ad hoc _  technique for extrapolation to the infinite - data limit like that presented here .",
    "many people provided helpful comments and suggestions for the research reported here .",
    "the authors would like to thank lucy forrest , lancelot james , chris jarzynski , hirsh nanda , horia petrache , lawrence pratt , mark robbins , jonathan sachs , thomas simonson , scott zeger , and david zuckerman .",
    "funding for this work was provided by the nih ( grant gm54782 ) , the bard foundation , and the department of physiology .",
    "d.m.z . is the recipient of a national research service award ( gm20394 ) .",
    "j.  e. hunter , w.  p. reinhardt , and t.  f. davis .",
    "a finite - time variational method for determining optimal paths and obtaining bounds on free energy changes from computer simulations .",
    ", 99:68566864 , 1993 .",
    "m.  a. miller and w.  p. reinhardt .",
    "efficient free energy calculations by variationally optimized metric scaling : concepts and applications to the volume dependence of cluster free energies and to solid - solid phase transitions . , 113:70357046 , 2000 .",
    "r.  h. wood , w.  c.  f. mhlbauer , and p.  t. thompson .",
    "systematic errors in free energy perturbation calculations due to a finite sample of configuration space : sample - size hysteresis . , 95:66706675 , 1991 ."
  ],
  "abstract_text": [
    "<S> we perform an extrapolative analysis of `` fast - growth '' free - energy - difference ( @xmath0 ) estimates of a computer - modeled , fully - solvated ethane@xmath1methanol transformation . </S>",
    "<S> the results suggest that extrapolation can greatly reduce the systematic error in @xmath0 estimated from a small number of very fast switches . </S>",
    "<S> our extrapolation procedure uses block - averages of finite - data estimates , and appears to be particularly useful for broad , non - gaussian distributions of data which produce substantial systematic errors with insufficient data . in every tested case , </S>",
    "<S> the extrapolative results were better than direct estimates . </S>"
  ]
}