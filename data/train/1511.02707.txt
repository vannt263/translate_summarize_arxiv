{
  "article_text": [
    "the ability to image electronic dynamics in real space and real time is essential for a thorough investigation and control of various chemical and physical transformations of molecular structures and crystals .",
    "this task requires angstrom spatial resolution , which corresponds to interatomic distances in solids and molecules , and femto- and even sub - femtosecond temporal resolution , which is necessary to capture electron dynamics .",
    "x - ray free electron lasers , capable of producing pulses of hard x rays with angstrom wavelengths , are a promising tool to achieve these requirements @xcite .",
    "femtosecond time resolution is already achieved at free - electron laser facilities @xcite , and high - intensity attosecond pulses are realizable using the techniques described in refs .  .",
    "recently , we introduced a method that employs ultrafast hard - x - ray pulses for imaging dynamics of nonstationary electron systems in both real space and real time @xcite .",
    "this technique , combining elastic and inelastic ultrafast resonant x - ray scattering ( rxs ) , allows encoding the interatomic electron current in a single scattering pattern in addition to the usual structural information .",
    "this effect is due to inelastic processes that unavoidably contribute to a scattering pattern obtained by a broadband ultrafast probe pulse . in order to demonstrate the principle of our method",
    ", we provided an illustrative example of probing electron hole motion in a diatomic molecule @xcite .    in this paper , we describe how our technique can be applied to imaging electron dynamics in crystals .",
    "electron motion in crystals determines various fascinating ultrafast phenomena relevant for technological applications .",
    "especially , this applies to light - driven phenomena , where transformations of electronic , optical or magnetic properties of a crystal are triggered by the interaction of an ultrafast pump pulse with electrons .",
    "such light - induced phenomena include , for example , insulator - to - metal transition in charge - ordered systems @xcite , light - driven electron current in dielectrics @xcite , high - harmonic generation @xcite and extraordinary carrier multiplication in semiconductors @xcite , and many other intriguing phenomena . in order to control such phenomena ,",
    "the ability to characterize electron dynamics is necessary .    in this article , we demonstrate how ultrafast rxs can be applied to image coherent electron motion in crystals and discuss conditions that are necessary to extract instantaneous interatomic electron currents from a scattering pattern . launching and observing coherent electron dynamics in bulk crystals , which is a process of interest in view of fundamental physics as well as potential applications , has recently become possible @xcite .",
    "for instance , phase - stable high harmonic transients covering the terahertz - to - visible spectral domain can be induced and controlled in a bulk semiconductor by triggering dynamical bloch oscillations with thz pulses , which is an important step towards terahertz - rate electronics @xcite .",
    "it has also been suggested that dynamical bloch oscillations have an effect on optical - field - induced currents in a wide - gap dielectric @xcite .",
    "it has been shown that coherent electron oscillations accompany insulator - to - metal transitions in a charge ordered organic crystal induced by few - optical - cycle infrared pulses @xcite and insulator - metal dynamics of a magnetoresistive manganite induced by an ultrashort optical pulse @xcite .",
    "as examples of coherent electron dynamics in crystals , we consider coherent electronic wave packets in the valence bands of kbr and ge crystals triggered by a photoionizing pump pulse .",
    "creation of coherent electronic wave packets in valence orbitals of atoms and complex molecules by a photoionizing pump pulse has been demonstrated in attosecond science @xcite .",
    "ultrafast control over ionization dynamics in solids by attosecond light pulses is a rapidly emerging field in attosecond science in view of potential applications for ultrafast signal processing @xcite .",
    "although some theoretical @xcite and experimental @xcite progress has been made in understanding attosecond ionization of solids , no optimal procedure for launching coherent electronic wave packets in crystals by photoionization has yet been established . here",
    ", we do not aim at describing the formation of electronic wave packets in solids through photoionization , but we use them just as examples to analyze which dynamical information is encoded in time - resolved rxs patterns from electronically nonstationary periodic structures .    in section [ section_rxs ]",
    ", we discuss the formalism underlying ultrafast rxs from electronic wave packets and show the connection between the interatomic electron current and the fourier transform of a scattering pattern from @xmath2 space to real space @xcite .",
    "we discuss in detail ultrafast rxs patterns and demonstrate how the interatomic electron current can be extracted from a scattering pattern using the example of coherent electron hole motion in kbr crystal in sec .",
    "[ section_kbr ] .",
    "another example , which we provide in sec .",
    "[ section_ge ] , is coherent electron hole motion in the two outermost valence bands of ge crystal .",
    "we discuss the difference between the scattering patterns and the procedures to extract interatomic electron currents in kbr and ge crystals .",
    "we simulate the regions where a single electron hole is distributed in the crystals by ( kbr)@xmath0 and ge@xmath1 clusters .",
    "we consider the process of ultrafast rxs , where , first , a resonant x - ray probe pulse induces a transition of an electron from a core shell of a certain atomic species to a valence band , where electron dynamics is taking place .",
    "then , the created core vacancy is filled by some electron accompanied by the emission of a photon that contributes to the scattering pattern . for a stationary measurement ,",
    "the major contribution to the scattering pattern is due to elastic scattering events , since they sum up coherently . as a result ,",
    "a stationary scattering pattern depends on the static structure factor , which is determined by the electron density .",
    "however , the situation is different for time - resolved rxs from a nonstationary electron system , the necessary condition for which is that the probe pulse duration must be much shorter than the characteristic time scales of electron dynamics . as a result ,",
    "the bandwidth of the probe pulse is much larger than the maximum splitting of the energy levels involved in the dynamics , which leads to the indistinguishability of elastic and inelastic scattering processes . as a consequence , a scattering pattern obtained by an ultrashort resonant x - ray pulse",
    "does not encode a structure factor at the time of measurement and is not determined by the electron density at the time of measurement , in contrast to stationary rxs @xcite .    in ref .  , we investigated ultrafast rxs patterns obtained by a probe pulse from an electronic system excited by a pump pulse at time @xmath3 .",
    "let the many - body hamiltonian of the system in the absence of an x - ray field be @xmath4 with eigenstates @xmath5 and eigenenergies @xmath6 .",
    "thus , the electronic system at time @xmath7 is described by a density matrix @xmath8 where the elements @xmath9 are determined by the pump pulse .",
    "we demonstrated that the quantum electrodynamics treatment based on the density matrix formalism within second order time - dependent perturbation theory @xcite is necessary to correctly describe scattering patterns obtained by an ultrashort x - ray pulse from this nonstationary electron system .",
    "the resulting differential scattering probability ( dsp ) for a probe pulse with intensity @xmath10 , which arrives at time @xmath11 after the pump pulse , can be represented as @xcite @xmath12 , \\nonumber\\\\ & \\mathcal a_{qr}(t_p ) = h_{qr}\\sum_{i , k}\\mathcal i_{ik}(t_p)(\\mathbf d_{kj_{c_r}}\\cdot\\boldsymbol \\epsilon_{\\text{in}}^*)(\\mathbf d_{j_{c_q}i}\\cdot\\boldsymbol \\epsilon_{\\text{in}}),\\label{dsp_dipapp_extended}\\\\ & h_{qr } = \\sum_{f , s_{\\text{s}}}(\\mathbf d_{j_{c_r}f}\\cdot\\boldsymbol \\epsilon_{\\text{s}})(\\mathbf d_{fj_{c_q}}\\cdot\\boldsymbol \\epsilon_{\\text{s}}^*)\\nonumber\\\\ & \\qquad\\qquad\\times\\delta\\omega_{jf}^2\\int_0^{\\infty } \\frac{d\\omega_{{\\mathbf k}_{\\text{s}}}\\omega_{{\\mathbf k}_{\\text{s}}}w(\\omega_{{\\mathbf k}_{\\text{s}}})e^{-\\frac{\\omega_f^2\\tau_p^2}{4\\ln2 } } } { ( \\omega_{{\\mathbf k}_{\\text{s}}}-\\delta\\omega_{jf})^2+\\gamma_{j}^2/4},\\nonumber\\end{aligned}\\ ] ] where @xmath13 is the speed of light , the sum over @xmath14 and @xmath15 goes over all scattering atoms in the system situated at positions @xmath16 and @xmath17 , respectively ( atomic units are used for this and following expressions ) .",
    "@xmath18 are intermediate states with an electron hole in a core shell of atom @xmath19 , the energy splittings between which we assume to be much smaller than the bandwidth of the ultrashort probe pulse ( thus , @xmath20 ) , and @xmath21 are the core - hole linewidths .",
    "@xmath22 designates the dipole matrix element between electronic states @xmath23 and @xmath24 , where @xmath25 ( @xmath26 ) is the electron field annihilation ( creation ) operator .",
    "@xmath27 is the energy of a scattered photon with a wave vector @xmath28 , @xmath29 represents the spectral acceptance range of the photon detector , @xmath30 , where @xmath31 is the photon energy of the probe pulse and @xmath32 is the mean energy of the electronic system described by eq .",
    "( [ dsp_dipapp_extended ] ) .",
    "@xmath33 , where @xmath34 is the wave vector of the probe pulse .",
    "in contrast to the dsp from a stationary system , the dsp in eq .",
    "( [ dsp_dipapp_extended ] ) is not centrosymmetric and does not encode a structure factor at the time of measurement , _",
    "@xmath35 , where @xmath36 is the scattering amplitude of atom @xmath37 at the time of measurement @xmath11 .",
    "however , some useful information can indeed be extracted from ultrafast rxs patterns .",
    "namely , not only do they contain structural information , but they also can provide the electron current between scattering atoms at the time of measurement . in this paper , we provide examples of ultrafast rxs scattering patterns from crystals and discuss in detail what is actually needed to extract the interatomic electron current from a scattering pattern .      during the time evolution of the electronic wave packet , the electron charge is redistributed both between atoms in the system and within each individual atom , thus , giving rise to the interatomic and intraatomic contributions to the probability current density @xmath38 , which is given by the relation @xmath39\\hat\\psi-\\hat\\psi^\\dagger[\\boldsymbol\\nabla\\hat\\psi]{\\right } ) { \\right}\\ } \\label{probcurrden}.\\end{aligned}\\ ] ] the field annihilation ( creation ) operator can be expanded in terms of one - particle wave functions as @xmath40 [ @xmath41 , where @xmath42 annihilates ( creates ) a particle in one - particle state @xmath43 . representing the one - particle wave functions as linear combinations of functions",
    "@xmath44 centered at site @xmath45 , @xmath46 the interatomic current between atoms @xmath14 and @xmath15 is @xmath47 note that the current @xmath48 is opposite to @xmath49 , which is consistent with the fact that the current from atom @xmath14 to @xmath15 is opposite to the current from atom @xmath15 to @xmath14 . the interatomic electron current can be accessed via the imaginary part of the fourier transform of a scattering pattern from @xmath2 space to real space , @xmath50\\nonumber,\\end{aligned}\\ ] ] which is the sum of delta peaks weighted by functions @xmath51 and centered at positions corresponding to vectors connecting scattering atoms @xmath14 and @xmath15 @xcite . applying eq .",
    "( [ onepart ] ) to dipole matrix elements @xmath52 and @xmath53 , the functions @xmath54 can be represented as @xmath55 where @xmath56 here , the operator @xmath57 creates an electron _ hole _ in a core shell of atom @xmath58 .",
    "since the orbitals of electrons in core shells of heavy atoms are strongly localized , a single function @xmath59 with the corresponding coefficient @xmath60 in the sum in eq .",
    "( [ onepart ] ) describes the core - hole wave function .",
    "the operator @xmath61 annihilates an electron hole with a wave function @xmath62 in the valence band , where the dynamics is taking place .",
    "we took into account that an integral @xmath63 can be very well approximated by @xmath64 , since the function @xmath65 is strongly localized ( here , @xmath66 is the kronecker delta ) .",
    "therefore , the wave function of the valence electron hole contributes only functions @xmath67 to the integrals entering the dipole matrix element @xmath52 ( analogously for the operator @xmath68 and atom @xmath15 ) .",
    "the probe pulse is resonant with the transition of an electron from a core shell to the valence band , where the dynamics is taking place .",
    "therefore , the terms in the sum over @xmath69 in eq .",
    "( [ jqr_via_onepart ] ) are nonzero only if electron holes in the valence bands exist .",
    "also , there would be no electron dynamics and , consequently , no current in the valence bands , if they are filled .",
    "therefore , the terms in eqs .",
    "( [ intercurr ] ) and ( [ jqr_via_onepart ] ) are nonzero for the same @xmath70 and @xmath71 , and factors @xmath72 entering factors @xmath73 and interatomic electron _ hole _",
    "current @xmath49 are the same under the assumption stated .",
    "that means that @xmath74 is proportional at any @xmath11 to some projection of @xmath75 on the direction of the unit vector @xmath76 , as long as the ratio between @xmath77 and @xmath78 is equal for every @xmath79 and @xmath80 .",
    "as the first example we consider electron hole motion in kbr crystal .",
    "kbr is an ionic crystal with the rock - salt crystal structure , where the @xmath81 electrons of k atoms are transferred to br atoms @xcite .",
    "the @xmath82-character electrons centered on the br atoms form the outermost valence band of kbr .",
    "we assume that a pump pulse ionizes kbr by removing electrons from this band , _ i.  e. _ , by creating @xmath82-type electron holes centered on br atoms , and coherently triggered their dynamics ( see fig .  [ fig_denkbr ] ) .",
    "generally , each electron hole would be delocalized and distributed over many br atoms in some region .",
    "we assume that the concentration of the electron holes is sufficiently low to consider these regions isolated and the holes noninteracting .",
    "the second pulse , which comes after the pump at some time @xmath11 , probes the electron dynamics via the ultrafast rxs , which is a two - step process .",
    "first , it resonantly excites the transition of an electron from the @xmath83 shell of br to the valence band , where the dynamics is taking place .",
    "thereby , this absorption step directly depends on the electronic wave packet state at the time of measurement .",
    "then , the created electron hole in the @xmath83 shell of br would be filled by either a valence electron or by an inner - shell electron of br accompanied by the emission of a photon that reaches the detector .",
    "the second process does not directly depend on the wave packet state at time @xmath11 , since the wave packet has already been destroyed in the absorption step .",
    "however , since the scattering probability is determined by both processes , absorption and emission , the scattering pattern still contains information about the wave packet .     in a fragment of",
    "( kbr)@xmath0 cluster visualized using vesta @xcite .",
    "the orange arrows represent the electron hole currents @xmath75 between the br atoms , and their lengths are proportional to @xmath84 .",
    "the blue - framed arrow represents a current parallel to the pulse polarization.,scaledwidth=45.0% ]      we simulated the region of the ionized kbr crystal , where a single electron hole is present , by a cubic kbr cluster consisting of 216 atoms .",
    "we performed the calculation of the electronic structure of the neutral cluster within the hartree - fock approach using the ab initio quantum chemistry software package molcas @xcite with the sto-3 g basis set @xcite , which already gives satisfactory results for kbr .",
    "the calculation was performed without periodic boundary conditions and in the real space , which allowed extracting the spatial orbitals of the singly - ionized kbr cluster and their binding energies within koopmans theorem @xcite .",
    "there are 324 valence orbitals in the cluster , since there are six @xmath82-like valence electrons per br atom",
    ". therefore , there are 324 electronic states involved in the dynamics of the wave packet in our simulation .",
    "we assume that the pump and probe pulses do not overlap temporally .",
    "therefore , their actions can be described separately @xcite .",
    "we further assume that the pump pulse has created a perfectly coherent superposition of the electronic states , so that the elements @xmath9 in eq .",
    "( [ el_den ] ) can be represented as @xmath85 , where @xmath86 and @xmath87 are time - independent coefficients . in principle , these coefficients must be determined from the description of the specific process triggering the wave packet .",
    "but in this paper , our goal is to demonstrate how , using ultrafast rxs , one can extract information about nonstationary electron dynamics in a crystal independently from how this electron dynamics was excited .",
    "therefore , we do not concentrate on the pump process and choose coefficients @xmath88 randomly , since the conclusions presented below do not depend on the specific set of the elements @xmath9 and are expected to remain valid even if the state of the electronic system is a statistical mixture of states ( i.  e. , @xmath89 ) .",
    "the distribution of 324 energy levels reflects the main features of the density of states of the valence band of bulk kbr crystal @xcite . with increasing number of atoms in the cluster ,",
    "the intervals between the energy levels decrease and the distribution of the states tend to the density of states of the valence band .",
    "since the behavior of a wave packet is determined by the energy states involved in the dynamics , the description of the wave packet dynamics in the crystal would improve with increasing number of atoms in the cluster .",
    "our focus here is on analyzing time - resolved scattering patterns from a wave packet in a periodic structure .",
    "as will be discussed below , the conclusions about properties of such scattering patterns do not change with increasing cluster size .       from the ionized kbr cluster obtained by a @xmath90-polarized x - ray pulse .",
    "( a ) no polarization filter is applied in the measurement of a scattered photon .",
    "( b ) a polarization filter transmitting @xmath90-polarized scattered photons is applied and the pattern is divided by the function @xmath91 [ eq .",
    "( [ polarfilter ] ) ] . ]",
    "the duration of the probe pulse of 200 as is chosen such that it is sufficiently short to capture the electron dynamics of the wave packet , the characteristic time scale of which is determined by the bandwidth of the valence band of 2.5 ev @xcite .",
    "the photon energy of the probe pulse @xmath92 kev is tuned to the @xmath93 edge of br , providing a spatial resolution of 0.9 a. such sub - femtosecond hard x - ray pulses can be produced at free - electron lasers using the strategies described in refs .  .",
    "the probe pulse propagates along the @xmath94 direction and its polarization is along the @xmath90 axis , parallel to one of the vectors connecting two br atoms ( see fig .  [ fig_denkbr ] ) .",
    "it follows from eq .",
    "( [ dsp_dipapp_extended ] ) that photons emitted from localized electrons filling the @xmath83 core hole in br do not provide a structure - dependent contribution to the scattering pattern .",
    "namely , if an electron localized at some atom @xmath95 would take part in the emission step by filling the core hole , then the final state @xmath96 would be a state with an electron hole localized at @xmath95 . as a result ,",
    "all terms @xmath97 except for the term @xmath98 in the sum over scattering atoms @xmath14 and @xmath15 in eq .",
    "( [ dsp_dipapp_extended ] ) would be zero .",
    "thus , photons emitted by electrons from localized orbitals filling the core hole would provide a signal that is constant over @xmath2 space , thereby , contributing only to the background .",
    "these photons have energies lower than energies of transitions of electrons from the outermost valence band to the @xmath83 shell of br and can be suppressed by the spectral window function @xmath29 centered at @xmath31 .",
    "thus , we assume that the spectral window function @xmath29 is centered at @xmath31 and suppresses all photons emitted by electrons lying deeper than the outermost valence band . without this assumption , the signal in a scattering pattern would be larger , but its contrast would be lower .    figure  [ fig_kbrpatt]a shows the scattering pattern in the @xmath99 plane at @xmath100 from the singly ionized kbr cluster obtained by the probe pulse arriving at time @xmath11 .",
    "the sample must be rotated about the @xmath90 axis as described in appendix [ app_rotkin ] in order to acquire data in this plane .",
    "two conditions must be satisfied for @xmath101 points in the plane to be accessible .",
    "the first condition is that @xmath102 can not exceed @xmath103 , where @xmath104 is the maximum scattering angle , which we set to @xmath105 .",
    "the second condition is due to the inexistence of a configuration of vectors @xmath106 and @xmath107 for some @xmath101 points ( see appendix [ app_rotkin ] and refs .   for details ) .",
    "this condition limits the accessible area by two circles of radius @xmath108 centered at the points @xmath109 .    the @xmath2 dependence of the scattering pattern in fig .",
    "[ fig_kbrpatt]a is given not only by the trigonometric functions in eq .",
    "( [ dsp_dipapp_extended ] ) , but also by the function @xmath110 , which contains a sum over the two independent polarizations of the scattered photon .",
    "since the vector @xmath107 is different for every @xmath101 point , the terms @xmath111 in the function @xmath110 are also different and depend on @xmath2 .",
    "this additional @xmath2 dependence will manifest itself in the fourier transform of the scattering pattern to the real space , which would complicate its analysis . in order to eliminate this dependence",
    ", we apply a polarization filter that transmits scattered photons with polarization @xmath112 ( see appendix [ app_polarfilter ] ) .",
    "then , the term @xmath111 will be substituted by @xmath113 , where function the @xmath91 is given in eq .",
    "( [ polarfilter ] ) .",
    "thus , by applying a polarization filter , the dependence of the factor @xmath110 on @xmath2 can be factored out independently of which polarization @xmath114 the filter transmits .",
    "figure  [ fig_kbrpatt]b shows the scattering pattern at @xmath115 obtained with a filter transmitting only @xmath90-polarized photons and divided by the function @xmath91 .",
    "now , the pattern contains only the @xmath2 dependence determined by the trigonometric functions in eq .",
    "( [ dsp_dipapp_extended ] ) . in this way",
    "the periodicity of the pattern can be straightforwardly determined , and it can be extrapolated to a region with inaccessible @xmath2 in order to perform the fourier transform of the pattern to the real space .",
    "looking at the pattern carefully , one can notice that the point at @xmath116 is not a center of inversion symmetry , corroborating the discussion above that the pattern is not determined by the usual structure factor squared .",
    "the shape and positions of the peaks in the pattern change depending on the probe - pulse arrival time .",
    "the contrast and the mean signal of the pattern also slightly change in time .",
    "note that this scattering pattern is formed by a single hole distributed over br atoms in the cluster , and the diffraction peaks in the pattern are due to the interference of segments of the electron hole centered on different atoms ( see fig .",
    "[ fig_denkbr ] ) . with increasing cluster size , the contrast and the mean signal strength of a scattering pattern averaged over time will not change , since still only a single electron hole would contribute to the signal . a real scattering pattern from an ionized kbr crystal would be formed by the sum of signals from all electron holes in the crystal , which would enhance the number of photons that reach the detector by a corresponding factor . in appendix [ app_requiredphotons ] , we estimated that a kbr crystal with one electron hole per one thousand atoms has to be irradiated with @xmath117 photons in order to achieve a signal of one photon per pixel on average .",
    "additionally , the contrast would be enhanced due to bragg reflections from electron holes that move coherently . however",
    ", scattering patterns from kbr crystal and other alkali halides would always have a low contrast compared to other systems , since valence electrons in alkali halides are to a large degree localized @xcite .",
    "space to real space of the scattering pattern in fig .",
    "[ fig_kbrpatt]b .",
    "( b ) solid violet line : time evolution of the amplitude of the circled peak in panel ( a ) .",
    "orange dashed line : the sum of the currents between pairs of atoms connected by the vector @xmath118 . ]",
    "plane , illustrating how the kbr cluster is  seen \" by the resonant x - ray probe pulse propagating in the @xmath94 direction . also shown is the projection of the probability current density [ eq .  ( [ probcurrden ] ) ] on the @xmath119 plane , @xmath120 . ]",
    "figure  [ fig_currfurkbr]a shows the imaginary part of the fourier transform from @xmath2 space to real space of the pattern from fig .",
    "[ fig_kbrpatt]b .",
    "this and further plots of the imaginary part of the fourier transform we obtain with eq .",
    "( [ imfurtr ] ) , which provides the  ideal \" fourier transform of scattering patterns , as if they were extrapolated to the region of infinite @xmath121 and @xmath122 . the fourier transform consists of delta peaks at points corresponding to vectors connecting pairs of br atoms ( see fig .  [ fig_gradkbr ] ) .",
    "for instance , the peak outlined by the circle in fig .",
    "[ fig_currfurkbr]a corresponds to the vector @xmath118 that connects all nearest - neighbor br atoms lying in the @xmath90 direction , where @xmath123 a is the distance between the nearest - neighbor br atoms .",
    "amplitudes of peaks at points @xmath124 are opposite to amplitudes of peaks at @xmath125 .",
    "now let us consider the correspondence between the imaginary part of the fourier transform and the interatomic electron current , which we discussed in sec .",
    "[ sec_intercurr ] .",
    "the electron hole is created in the valence band of kbr that is formed by @xmath126-type orbitals centered on br atoms .",
    "therefore , the atomic functions @xmath127 , which we use to expand the wave function of the electron hole [ see eq .",
    "( [ onepart ] ) ] , are simply @xmath128- , @xmath129- and @xmath130-type orbitals centered on site @xmath37 , which we designate as @xmath131 , @xmath132 and @xmath133 , respectively . according to eq .",
    "( [ intercurr ] ) , the interatomic electron hole current is given by @xmath134 where @xmath135 and @xmath13 stand for @xmath94 , @xmath90 and @xmath136 and @xmath137 and @xmath138 are coefficients for which the matrix element @xmath139 in eq .",
    "( [ intercurr ] ) is nonzero .",
    "let atoms @xmath14 and @xmath15 be nearest - neighbor atoms aligned along the @xmath90 direction .",
    "then , the integral @xmath140 is much larger than the other integrals involving functions @xmath131 , @xmath132 , @xmath133 and operators @xmath141 , @xmath142 , @xmath143 , meaning that the @xmath90 component of the current @xmath49 would be the dominating one . since only one integral provides the dominating contribution to the amplitude of @xmath49 , and the @xmath129-type function is real , @xmath84 is simply given by @xmath144 we obtain the same result , that interatomic electron - hole currents between nearest - neighbor br atoms in kbr are aligned along vectors connecting the corresponding atoms ( see fig .",
    "[ fig_denkbr ] ) , by numerically calculating the currents . also , we find that the current between atoms not lying next to each other , is negligible .",
    "this is because the functions @xmath145 and @xmath146 centered on atoms @xmath15 and @xmath14 that are far apart , do not overlap with each other .",
    "now let us consider the factor @xmath73 , which , according to eq .",
    "( [ jqr_via_onepart ] ) , is @xmath147 where @xmath148 is the wave function of an electron hole in the @xmath83 shell of the br atom at site @xmath19 . here",
    ", we took into account that the integrals @xmath149 and @xmath150 are zero for a @xmath90-polarized probe pulse .",
    "comparing functions @xmath74 and @xmath84 , one can see that they are proportional at every @xmath11 with the coefficient of proportionality being given by @xmath151 .",
    "due to the symmetry of the kbr crystal , which has the rock - salt crystal structure , all pairs of br atoms connected by the same vector are equivalent to each other .",
    "thus , the sum @xmath152 and , consequently , the factor @xmath110 are equal for all pairs of br atoms connected by the same vector @xmath153 .",
    "the integral @xmath154 also does not change for the same @xmath155 .",
    "thus , the coefficient of proportionality is identical for all pairs of br atoms connected by equal vectors .",
    "the factor @xmath73 corresponding to the two atoms at sites @xmath14 and @xmath15 connected by the vector @xmath118 contributes to the amplitude of the peak outlined by the circle in fig .",
    "[ fig_currfurkbr]a .",
    "this peak is formed not only by the single factor @xmath73 , but by the sum of all factors @xmath156 , the corresponding pair of atoms @xmath157 and @xmath158 being connected by vectors with the projection on the @xmath119 plane equal to @xmath159 .",
    "this means that not only nearest - neighbor br - atom pairs lying in the @xmath90 direction , but also br - atom pairs separated by a vector @xmath160 , where @xmath161 is an integer , contribute to this peak .",
    "however , factors @xmath156 for atoms @xmath157 and @xmath158 not lying next to each each other , are negligible due to the term @xmath162 entering @xmath156 [ see eq .",
    "( [ dsp_dipapp_extended ] ) and ( [ jqr_via_onepart ] ) ] .",
    "the less spatial orbitals are distributed among both atoms @xmath157 and @xmath158 , the more this term decreases .",
    "thus , the peak at @xmath159 in fig .",
    "[ fig_currfurkbr]a is formed just by the sum of the factors @xmath156 corresponding to the pairs of atoms lying next to each other along the @xmath90 direction and is proportional to the sum of the interatomic electron hole currents between them .    in fig .",
    "[ fig_currfurkbr]b , we depict the amplitude of the encircled peak as a function of the time of the probe pulse arrival and the time evolution of the computed sum of the currents between all pairs of nearest - neighbor br atoms connected by the vector @xmath118 . in agreement with the previous discussion",
    ", we find that the time evolution of the amplitude of this peak precisely follows the time evolution of the sum of the currents .    to sum up , the interatomic electron currents in the outermost valence band of kbr are nonzero for nearest - neighbor br atoms and are aligned along directions connecting the pairs of atoms .",
    "the sum of the interatomic electron currents between atoms lying along a vector @xmath155 is encoded in the ultrafast rxs scattering pattern obtained by a probe pulse polarized along @xmath155 .",
    "the time evolution of the peak at the position @xmath155 in the imaginary part of the fourier transform of the scattering pattern follows the time evolution of the sum of interatomic currents .",
    "this concept works precisely for systems where the same single function @xmath163 per scattering atom contributes to both the interatomic electron currents in some direction @xmath155 and the signal due to the probe pulse polarized along some direction @xmath164 ( in general , not necessarily the same as @xmath155 ) .",
    "this conclusion is deduced for electronic wave packets in periodic structures , but also works for the finite kbr cluster as follows from fig .",
    "[ fig_currfurkbr]b .",
    "in a fragment of ge cluster visualized using vesta software @xcite .",
    "the orange arrows represent the electron hole currents @xmath75 between the ge atoms , and their lengths are proportional to @xmath84.,scaledwidth=40.0% ]    the second example that we consider is the coherent valence electron hole motion in germanium crystal launched by a photoionizing pump pulse ( see fig .",
    "[ fig_denge ] ) .",
    "we assume a probe pulse with a photon energy @xmath165 kev , which corresponds to a spatial resolution of 1.1 a , tuned to the transition of an electron from the @xmath83 shell of ge to the valence band . the probe pulse duration of 200 as is the same as in the previous example .",
    "we again assume that the electron holes in the crystal do not interact and simulate an isolated region of ge crystal , where a single electron hole is present , by a cluster of 83 ge atoms .",
    "the shape of the cluster is chosen such that there is a maximum number of nearest - neighbor atoms per atom .",
    "therefore , the boundary of this cluster tends to a sphere .",
    "our results do not depend on the choice of cluster shape , but do depend on the number of nearest - neighbor atoms , since they provide the largest contributions to a scattering pattern .",
    "we performed the calculation of the electronic structure of the neutral ge cluster within the hartree - fock approach using the ab initio quantum chemistry software package molcas @xcite with the correlation - consistent basis set , cc - pvdz @xcite without periodic boundary conditions .",
    "we obtained the spatial orbitals of the singly - ionized ge cluster and their binding energies within koopmans theorem @xcite .",
    "germanium has the diamond crystal structure , and , similarly to diamond , each ge atom forms covalent @xmath166 bonds to four neighboring ge atoms .",
    "since ge atoms on the surface of the cluster have less than four nearest neighbors , they have unsaturated bonds , which lead to a distortion of the electronic structure of the whole cluster .",
    "we solved this problem by saturating these bonds with hydrogen atoms .",
    "this does not influence the results , since only ge atoms scatter in our case .",
    "the @xmath166-hybridized electrons form two outermost valence bands of germanium with a maximum energy splitting of 4.5 ev @xcite .",
    "the wave functions @xmath167 of the hybrid orbitals are a linear combination of one @xmath168 and three @xmath82 orbitals of each ge atom , which we denote as @xmath169 , @xmath170 , @xmath171 and @xmath172 , respectively . the indices 1 and 2 in the function @xmath173",
    "stand for each of the two atoms in the primitive unit cell of ge and @xmath79 designates the index of the wave function : @xmath174,\\nonumber\\\\ & \\widetilde\\phi_{1(2)2 } = \\frac12{\\left } [ \\widetilde \\phi_s \\pm ( \\widetilde \\phi_{p_x } -\\widetilde \\phi_{p_y } -\\widetilde \\phi_{p_z } ) { \\right}],\\label{sp3functions}\\\\ & \\widetilde\\phi_{1(2)3 } = \\frac12{\\left } [ \\widetilde \\phi_s \\pm ( -\\widetilde \\phi_{p_x } + \\widetilde \\phi_{p_y } -\\widetilde \\phi_{p_z } ) { \\right}],\\nonumber\\\\ & \\widetilde\\phi_{1(2)4 } = \\frac12{\\left } [ \\widetilde \\phi_s \\pm ( -\\widetilde \\phi_{p_x } -\\widetilde \\phi_{p_y } + \\widetilde \\phi_{p_z } ) { \\right}],\\nonumber\\end{aligned}\\ ] ] where the @xmath175 functions have the plus sign in front of the round brackets , and the @xmath176 have the minus sign .",
    "the @xmath166 orbitals are extended in the directions of the nearest neighbors .",
    "for instance , let the atom situated at position @xmath177 have index 1 . then",
    ", @xmath175 functions are centered on this atom and its nearest neighbors are situated at positions @xmath178 , @xmath179 , @xmath180 and @xmath181 , where @xmath182 a is the lattice constant of ge .",
    "all these atoms have index 2 , since functions @xmath176 centered on them are extended in the opposite directions as compared to @xmath175 .",
    "therefore , nearest - neighbor atomic orbitals in ge always have different indices .     from the ionized ge cluster obtained by an x - ray pulse polarized along @xmath183 direction .",
    "@xmath101 along direction perpendicular to the illustrated plane is zero .",
    "( a ) no polarization filter is applied in the measurement of the scattered photon .",
    "( b ) polarization filter transmitting scattered photons polarized along @xmath184 direction is applied and the pattern is divided by the function @xmath91 [ eq .",
    "( [ polarfilter ] ) ] . ]",
    "now let us consider the electron hole currents between nearest - neighbor ge atoms .",
    "let the atomic orbitals at site @xmath185 have index 1 , and the atomic orbitals at site @xmath186 have index 2 , then @xmath187 where @xmath188 and @xmath189 are the coefficients for which the matrix element @xmath139 in eq .",
    "( [ intercurr ] ) is nonzero .",
    "this time , all integrals involving functions @xmath190 and operators @xmath191 are of the same order , and there is no preferred direction of the interatomic currents between nearest - neighbor atoms in ge ( see fig .",
    "[ fig_denge ] ) .",
    "the corresponding factor @xmath74 for a probe pulse polarized in some direction @xmath164 is @xmath192 where @xmath193 designates the wave function of an electron hole in the @xmath83 shell of the ge atom located at position @xmath194 . for the factor",
    "@xmath74 to follow the time evolution of some projection of @xmath75 onto a unit vector @xmath76 , the polarization of the probe pulse should be chosen such that @xmath195 has the same coefficient of proportionality with respect to @xmath196 for every @xmath79 and @xmath80 .",
    "we find that , for interatomic currents between atoms connected by the vector @xmath178 , a pair of @xmath76 and @xmath164 , for which the condition above is approximately satisfied , is @xmath197 and @xmath198 . in fig .",
    "[ fig_gepatt111 ] , we show the scattering patterns obtained with the probe pulse with polarization @xmath199 .",
    "we again apply a spectral window function @xmath29 that suppresses photons emitted by electrons lying in bands deeper that the two outermost ones .",
    "this condition is not necessary , but desirable to obtain a higher contrast in the scattering patterns .",
    "no polarization filter for scattered photons is applied in the case of fig .",
    "[ fig_gepatt111]a . the scattering pattern in fig .",
    "[ fig_gepatt111]b is obtained with a filter transmitting scattered photons polarized along @xmath184 and is divided by the function @xmath91 [ see eq .",
    "( [ polarfilter ] ) ] . here",
    ", the contrast of the scattering patterns is much higher than in the previous example ( see fiq .  [ fig_kbrpatt ] ) , since nearest - neighbor ge atoms in the crystal are closer to each other , at a distance of 2.45 a , which is about two times less than the distance between nearest - neighbor br atoms in kbr . as a consequence ,",
    "the spatial orbitals in ge are rather delocalized , leading to an increase of the factor @xmath200 , as we have discussed earlier .",
    "we also find that three times less photons , @xmath201 , than in the case of kbr are necessary to obtain a signal of one photon per pixel on average in ge crystal with one electron hole per one thousand atoms ( see appendix [ app_requiredphotons ] ) .",
    "space to real space of the scattering pattern in fig .",
    "[ fig_gepatt111]b .",
    "( b ) solid violet line : time evolution of the amplitude of the circled peak in panel ( a ) .",
    "orange dashed line : @xmath202 , where @xmath203 . ]",
    "figure [ fig_currfurge111]a shows the imaginary part of the fourier transform from @xmath2 space to real space of the scattering pattern in fig .",
    "[ fig_gepatt111]b .",
    "this fourier transform has much more pronounced peaks as compared to the case of kbr ( see fig .",
    "[ fig_currfurkbr]a ) , since not only nearest - neighbor atoms , but also next - nearest - neighbor atoms in ge ( distances 4 a ) provide noticeable factors @xmath73 .",
    "the peak corresponding to atoms connected by the vector @xmath178 is indicated by the circle .",
    "the plane of the scattering pattern was chosen such that this peak does not overlap with any other prominent peaks .",
    "thus , its amplitude is given by the sum of factors @xmath73 corresponding to atoms @xmath14 and @xmath15 connected by the vector @xmath178 .",
    "although each individual @xmath74 is approximately proportional to the projection of the corresponding interatomic current , @xmath204 , the coefficient of proportionality is different for different pairs .",
    "this is connected with the fact that a ge crystal has two scattering atoms in the primitive unit cell in contrast to the kbr crystal , which has only one br atom in the primitive unit cell .",
    "namely , let atoms @xmath14 and @xmath15 have indices 1 and 2 and atoms @xmath157 and @xmath158 have indices 2 and 1 , respectively . if both pairs of these atoms are nearest - neighbor atoms along the ( 1,1,1 ) direction , then @xmath205 .",
    "the integrals @xmath206 and @xmath207 in eq .",
    "( [ intercurrge ] ) then are opposite [ see eq .",
    "( [ sp3functions ] ) ] . at the same time , the factors @xmath208 and @xmath209 are equal for these pairs .",
    "therefore , the sum @xmath210 , which contributes to the amplitude of the peak at @xmath155 , is proportional to @xmath211 .    in agreement with the previous discussion",
    ", we find computationally that the amplitude of the encircled peak in fiq .",
    "[ fig_currfurge111]a follows the sum @xmath202 , where @xmath203 and @xmath14 and @xmath15 are atoms that have index 1 and 2 , @xmath157 and @xmath158 are atoms that have index 2 and 1 , respectively ( see fig .  [",
    "fig_currfurge111]b ) .",
    "the agreement between the time evolution of the amplitude of the peak and the sum of the currents is not as perfect as in the previous example , since they are both determined by several functions @xmath173 per atom .",
    "the electron hole dynamics is faster than in the previous example , since the two outermost valence bands of germanium have a larger maximum energy splitting than in the outermost valence band of kbr ( 4.5 ev against 2.5 ev ) ( see fig .",
    "[ fig_currfurkbr]b ) .",
    "the amplitude of the interatomic currents is larger than that in kbr , since spatial orbitals of ge are delocalized to a much higher degree .    to illustrate",
    "the kind of information one would obtain with this method for nearest - neighbor atoms in ge crystal , let some atom @xmath37 be situated at the center of our ge cluster .",
    "we would be able to obtain the sum of interatomic electron hole currents from atom @xmath37 to its nearest neighbors minus the sum of the interatomic currents from the nearest neighbors to the next - nearest ones plus the sum of the currents from the second - nearest neighbors to the third - nearest ones and so on .     from the ionized ge cluster obtained by the x - ray pulse polarized along @xmath212 .",
    "@xmath101 along direction perpendicular to the illustrated plane is zero .",
    "( a ) no polarization filter is applied .",
    "( b ) polarization filter transmitting scattered photons polarized along @xmath212 is applied and the pattern is divided by the function @xmath91 . ]     space to real space of the scattering pattern in fig .",
    "[ fig_gepatt110]b .",
    "( b ) solid violet line : time evolution of the amplitude of the circled peak on panel ( a ) .",
    "orange dashed line : @xmath213 , where @xmath214 , atoms @xmath14 and @xmath15 both having index 1 , and atoms @xmath157 and @xmath158 both having index 2 . ]",
    "the interatomic currents between second nearest - neighbor atoms in ge crystal , which are separated by about 4 a , are also prominent in contrast to the case of kbr .",
    "we found that these currents have the largest component along the direction connecting the atoms , and their amplitudes can be found by applying a probe pulse polarized along the same direction .",
    "figure [ fig_gepatt110 ] shows the scattering patterns with and without a filter for scattered photons obtained with a probe pulse with polarization @xmath215 . the imaginary part of the fourier transform of the pattern in fig .",
    "[ fig_gepatt110]b is shown in fig .",
    "[ fig_currfurge110]a .",
    "the encircled peak in fig .",
    "[ fig_currfurge110]a corresponds to atoms connected by the vector @xmath216 , which is parallel to @xmath164 .",
    "the plane of the scattering patterns depicted in fig .",
    "[ fig_gepatt110 ] was chosen such that this peak does not overlap with other prominent peaks .",
    "similar to the case of nearest - neighbor atoms , the coefficient of proportionality between a factor @xmath74 and @xmath84 depends on the index of atoms @xmath14 and @xmath15 , which now have the same indices in a pair .",
    "the time evolution of this peak approximately follows the time evolution of the sum @xmath213 , where @xmath214 , atoms @xmath14 and @xmath15 both having index 1 , and atoms @xmath157 and @xmath158 both having index 2 ( see fig .",
    "[ fig_currfurge110]b ) .",
    "note that although the projections of the currents between nearest - neighbor and next - nearest - neighbor atoms , depicted in figs .",
    "[ fig_currfurge111]b and [ fig_currfurge110]b , are of the same order , the amplitudes of the currents between nearest - neighbor atoms are approximately three times larger than the amplitudes of the currents between next - nearest - neighbor atoms .",
    "it is also possible to find other polarizations @xmath164 of the probe pulse that will provide other projections @xmath217 of interatomic currents either between atoms connected by the vector @xmath178 or by other vectors . in order to determine the polarization @xmath164 of a probe pulse that provides a peak with an amplitude following some projection of the interatomic currents between atoms connected by a vector @xmath155",
    ", we performed an analysis of the integrals @xmath195 and @xmath218 .",
    "it follows from eq .",
    "( [ dipintergrals ] ) that the integrals @xmath219 and @xmath220 do not depend on the sites on which the functions @xmath175 and @xmath221 are centered .",
    "the integral @xmath222 also does not depend on the particular sites @xmath14 and @xmath15 , but only on the vector @xmath155 between them .",
    "therefore , one can compose two @xmath223 matrices using the integrals @xmath219 , @xmath220 and @xmath224 independently from specific atomic sites .",
    "the first matrix is a function of @xmath225 , @xmath226 and @xmath227 , and its @xmath228-th element is @xmath195 .",
    "the second matrix is a function of @xmath229 , @xmath230 and @xmath231 , and its @xmath228-th element is @xmath222 at a given vector @xmath155 .",
    "then , one has to find pairs of @xmath164 and @xmath76 for which these two matrices are approximately proportional to each other . for analysis",
    ", we used the functions @xmath175 and @xmath221 from eq .",
    "( [ sp3functions ] ) to compose the matrices and determine the pairs of @xmath164 and @xmath76 .",
    "the resulting pairs of @xmath164 and @xmath76 were the input for the numerical calculations of scattering patterns and interatomic currents .",
    "since the matrix with the elements @xmath195 is not a linear function of @xmath164 , a superposition of such matrices at different polarizations can be a matrix that is not possible to obtain with a single @xmath164 .",
    "therefore , in principle , if it is necessary , one can measure several scattering patterns with different polarizations of the incoming beam and use a linear combination of their fourier transforms in order to follow a certain projection of interatomic currents .",
    "in this paper , we have discussed the information that one can obtain , using the ultrafast rxs , about coherent nonperiodic electron dynamics in crystals . as an example of such dynamics , we considered electron hole motion in the valence bands of ionized crystals .",
    "the band width of the ultrashort probe x - ray pulse has to be larger than the width of the electron band where the dynamics takes place , in order to capture the dynamics .",
    "since inelastic contributions unavoidably contribute to a scattering pattern obtained by such a pulse , ultrafast rxs from a nonstationary system provides in general information different from that of stationary rxs @xcite .",
    "namely , we have shown that ultrafast scattering patterns are not centro - symmetric and do not resolve the standard structure factor .",
    "they still resolve structural information and , additionaly , can resolve the interatomic electron current between the scattering atoms .",
    "we have described a procedure to extract the interatomic electron currents from a single 2d scattering pattern by performing a fourier transformation from @xmath2 space to real space .",
    "if a proper polarization of the incoming probe pulse has been chosen , the time evolution of the amplitude of a certain delta peak in the fourier transform follows the time evolution of the sum of the interatomic currents between atoms connected by the same vector .",
    "the required polarization of the probe pulse can be determined by an analysis of the electron structure of the crystal , an example of which for ge crystal is at the end of the last section . although our analysis was performed for periodic crystals , our simulations on clusters reproduce these findings .    in this paper ,",
    "we have considered just 2d scattering patterns .",
    "it should be possible to extract much richer information about the electron dynamics by measuring 3d scattering patterns of a sample .",
    "it seems likely that one could develop suitable phase - retrieval algorithms to obtain contributions by individual atomic pairs to a scattering pattern . in order to factor out the additional @xmath2 dependence in the scattering patterns due to different scattering angles at every @xmath101 point , we have applied a polarization filter for scattered photons ( see the discussion in sec .",
    "[ subsec_scatterinpatternkbr ] ) . in principle , it should be possible to find a less experimentally sophisticated way to eliminate this additional @xmath2 dependence in the scattering patterns .",
    "it follows from our estimate that both ge and kbr crystals with one electron hole per @xmath232 ge or br atoms have to be irradiated with @xmath233 photons in order to achieve a signal of one photon per pixel on average .",
    "subfemtosecond hard x - ray pulses that will be produced by free - electron lasers may contain @xmath234 photons @xcite .",
    "that means that the data can be accumulated using @xmath232 shots of such pulses , which can be produced in 20 minutes with a repetition rate of 100 hz . as shown in appendix [ app_requiredphotons ] , the number of required photons is determined by the penetration depth of the x - ray beam , but does not depend on the interaction area .",
    "therefore , the only restriction concerning the focal area of the probe x - ray beam is that it should be smaller than the pumped area of the sample and there is more freedom to lower the intensity of the beam in order not to damage a sample .    since the goal of this study is to describe what information one can extract about the electronic motion independently from how it was launched , we have considered random electronic wave packets .",
    "thus , it is demonstrated which information can be provided by ultrafast rxs in a general case of coherent electronic dynamics .",
    "when one studies scattering patterns in connection with some particular pump process , it should be possible to obtain even more comprehensive insight about the induced electronic motion .",
    "we believe that our technique to study coherent electron dynamics in solids and to extract interatomic electron currents has a high potential in view of recent advances in creating coherent wave packets in crystals @xcite and the growing role of ultrafast light - induced processes for high - speed electronics @xcite , electro - optics @xcite and optical phase manipulations @xcite .",
    "vector in the sample - fixed reference frame employed here .",
    "the sphere represents the ewald s sphere associated with the depicted @xmath34 vector .",
    "the plane represents the plane with @xmath101 points where the data is collected .",
    "]    all scattering patterns in the article are presented in a @xmath235 plane at zero @xmath236 , where @xmath237 is parallel to the polarization of the probe pulse , @xmath164 , @xmath238 is perpendicular to @xmath164 , and @xmath236 is perpendicular to both @xmath237 and @xmath239 .",
    "the sample is at rest in this reference frame , but it has to be rotated in order to obtain data points in this plane .",
    "it is important for our study that @xmath164 is always parallel to a certain interatomic vector . in order to understand how",
    "the sample should be rotated in this case , let @xmath237 and @xmath239 be aligned along the @xmath90 and @xmath136 directions , respectively . in the sample - fixed reference frame ,",
    "we rotate @xmath106 instead of the sample .",
    "we rotate @xmath106 around the @xmath90 axis such that @xmath164 is always along the @xmath90 direction .",
    "therefore , @xmath106 is rotated in such a way that it extends from the origin to a point that moves on the blue half circle as shown in fig .",
    "[ fig_rotkin ] . the sphere in fig .",
    "[ fig_rotkin ] is the ewald s sphere centered at the depicted @xmath34 vector .",
    "the green plane in fig .",
    "[ fig_rotkin ] is the @xmath240 plane , where we aim to collect the data .",
    "the vector @xmath33 lies in the @xmath99 plane if the vector @xmath107 points from some point on the plane to the center of the sphere .",
    "since we focus on @xmath107 with @xmath241 , @xmath107 must point from a point at the boundary of the sphere to its center .",
    "a vector @xmath107 satisfying both conditions is shown in fig .",
    "[ fig_rotkin ] .",
    "thus , @xmath34 provides @xmath101 points on the @xmath99 plane lying on the circle where this plane crosses the ewald s sphere associated with @xmath34 .",
    "the largest circle of @xmath101 points is obtained for @xmath34 parallel to the @xmath136 axis , and just the zero point in the @xmath99 plane is obtained for @xmath34 parallel to the @xmath94 axis .",
    "the direction of @xmath34 that provides a given @xmath101 point in the @xmath99 plane , can be determined using three conditions : @xmath242 , @xmath243 and @xmath244 .",
    "this gives us the following system of equations for @xmath245 , @xmath246 and @xmath247 : @xmath248 with two solutions @xmath249 the solution with the positive @xmath250 corresponds to vectors @xmath34 with the terminal point at the half circle in fig .",
    "[ fig_rotkin ] .",
    "the square root in the expression for @xmath250 limits the accessible q points by two circles of radius @xmath251 centered at points @xmath252 in the @xmath99 plane .",
    "in this section , we derive the expression for the dsp under the assumption that the detector measures @xmath253 , the intensity of light polarized along @xmath114 and scattered with a scattering vector @xmath33 . the derivation of the dsp in ref .",
    "must be modified for the observable intensity @xcite @xmath254 where the sum is over two possible polarization of @xmath28 and v is the quantization volume .",
    "then , @xmath255,\\end{aligned}\\ ] ] where @xmath256 is the total density matrix of the electron system and the electromagnetic field at time @xmath257 after the action of the probe pulse .",
    "the resulting intensity does not depend on position @xmath258 and time @xmath7 .",
    "the expression for the dsp is then derived from @xmath253 .    the new condition of measurement results in substitution of polarizations @xmath259 in the terms @xmath260 in the expression for the dsp in eq .",
    "( [ dsp_dipapp_extended ] ) for their projections on @xmath114 .",
    "the projections of @xmath259 are @xmath261 , where @xmath262 is the angle between @xmath259 and @xmath263 : @xmath264 .",
    "let @xmath265 be perpendicular to @xmath114 , then @xmath266/|{\\mathbf k}_{\\text{s}}|$ ] and @xmath267/|{\\mathbf k}_{\\text{s}}|^2 $ ] .",
    "thus , the term @xmath260 in the new expression for the dsp turns into @xmath268 , where the function @xmath269\\cdot \\boldsymbol\\epsilon_p)^2c^4/\\omega_{\\text{in}}^4 \\label{polarfilter}\\end{aligned}\\ ] ] depends on @xmath33 via eq .",
    "( [ rotatedkin ] ) .",
    "we took into account that @xmath270 .",
    "the number of photons @xmath271 that has to be sent on the sample in order to get a signal of one photon per pixel is given by @xmath272 , where @xmath273 is the average probability to scatter a photon into a pixel from a single scattering particle by a single incoming photon , and @xmath274 is the number of scattering particles , which are electron holes in our case .",
    "the number of the electron holes that interact with the probe pulse are given by @xmath275 , where @xmath276 is the interaction area , @xmath277 is the penetration depth of the x - ray beam and @xmath278 is the number of electron holes per unit volume .",
    "we assume that there is one electron hole per @xmath232 br or ge atoms in kbr or ge crystals , respectively .",
    "@xmath273 is given by @xmath279 , where @xmath280 is the pixel size and @xmath281 is the mean differential scattering cross section .",
    "@xmath281 can be derived from the mean dsp , which , as follows from figs .",
    "[ fig_kbrpatt ] , [ fig_gepatt111 ] and [ fig_gepatt110 ] , is approximately @xmath282 for a probe pulse with intensity @xmath283 , duration @xmath284 as and photon energy @xmath31 on the order of 10 kev for both kbr and ge crystals .",
    "thus , @xmath285 a@xmath286 and @xmath287 for both crystals .",
    "the pixel size @xmath280 is given by @xmath288{v_h})^2 $ ] , where @xmath289 is the wavelength and @xmath290 is the volume , where a single electron hole is distributed .",
    "we estimate the penetration depth in kbr and ge crystals as @xmath291 .",
    "@xmath292 is the lesser of the two mean free paths @xmath293 and @xmath294 , where @xmath295 is the total photoabsorption cross section of an ionized atomic bromine or germanium in the case of kbr or ge crystals at the energy @xmath296 resonant with the @xmath83 - @xmath126 transition of br or ge , respectively .",
    "@xmath297 is the sum of photoionization cross sections of neutral atomic bromine and potassium at the energy @xmath296 in the case of kbr crystal . since the densities of neutral br and k atoms , @xmath298 and @xmath299 , are equal in kbr , @xmath300 , where @xmath301 .",
    "@xmath302 is the photoionization cross section of germanium at the energy @xmath296 and @xmath303 is the atomic density of neutral ge atoms in the case of ge crystal .",
    "we calculate @xmath295 and @xmath302 with the xatom toolkit @xcite .",
    "there are four br atoms in the cubic unit cell of kbr with the lattice parameter 6.6 a. therefore , @xmath304 a@xmath305 and @xmath306 a@xmath305 .",
    "the wavelength of the incoming radiation @xmath307 a results in a pixel size of @xmath308 for kbr crystal .",
    "we obtain @xmath309 a@xmath286 , @xmath310 a@xmath286 and @xmath311 a@xmath286 from the calculation , which results in @xmath312 a. thus , we obtain from eq .",
    "( [ nphotons ] ) that @xmath313 photons are needed for kbr in order to obtain a signal of one photon per pixel .",
    "ge crystal has 8 atoms in its cubic unit cell with a lattice parameter of 5.7 a. therefore , @xmath314 a@xmath305 and @xmath315 a@xmath305 .",
    "the wavelength of the incoming radiation @xmath316 a results in a pixel size of @xmath317 for ge crystal .",
    "we obtain @xmath318 a@xmath286 and @xmath319 a@xmath286 from the calculation , which results in @xmath320 = @xmath321 a. thus , we find that @xmath322 photons are required for ge in order to obtain a signal of one photon per pixel .",
    "the number of required photons may deviate in a real experiment .",
    "first , the estimate strongly depends on the density of holes , @xmath323 .",
    "second , if all electron holes move coherently in a crystal , a signal would be coherently enhanced .",
    "that means that one would probably see a pronounced bragg pattern and fewer photons will be required to resolve a signal . however ,",
    "if all electron holes behave differently , then the object size that has to be resolved would be larger than the subvolume there a single electron hole is situated .",
    "that means that the pixel size that we assumed would be smaller , and the number of required photons would be larger [ see eq .",
    "( [ nphotons ] ) ] .",
    "however , one may use the larger pixel size and average over the different dynamics of the various subvolumes ."
  ],
  "abstract_text": [
    "<S> we demonstrate how the technique of ultrafast resonant x - ray scattering can be applied to imaging dynamics of electronic wave packets in crystals . </S>",
    "<S> we study scattering patterns from crystals with electron dynamics in valence bands taking into account that inelastic and elastic scattering events induced by a broad - band probe pulse can not be separated through the spectroscopy of the scattered photon . as a result , </S>",
    "<S> scattering patterns are not determined by the structure factor at the time of measurement , but can encode the instantaneous electron current between scattering atoms . </S>",
    "<S> we provide examples of how the interatomic electron current in a periodic structure can be extracted from a single scattering pattern by considering valence electron hole motion in ( kbr)@xmath0 and ge@xmath1 clusters . </S>"
  ]
}