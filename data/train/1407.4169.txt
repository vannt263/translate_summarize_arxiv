{
  "article_text": [
    "the dynamical evolution of dense star clusters is a problem of fundamental importance in theoretical astrophysics .",
    "star clusters like open and globular clusters are among the simplest stellar systems : they are spherical , they contain no dust to confuse the observations and they appear to have no dark matter .",
    "moreover , they are dynamically old : a typical star in a globular cluster has completed some @xmath0 orbits since the cluster was formed and processes like gravothermal collapse and two - body relaxation occur on timescales comparable with their ages .",
    "thus , they provide the best physical realization of the gravitational n - body problem i.e. to understand the evolution of a system of n point masses interacting only by gravitational forces . in spite of the many advances made in the recent past , many aspects of the problem have remained unresolved like the production of exotic objects ( ferraro et al .",
    "2012 ) , the importance of tidal - shocks in the long term evolution and survival of star clusters in the galaxy ( gnedin , lee & ostriker 1999 ) and the ability to retain dark remnants ( morscher et al . 2013 ; sippel & hurley 2013 ) .",
    "the most direct approach to the simulation of star clusters is through n - body simulations . in these kind of studies",
    "the gravitational forces of stars are directly computed and any additional ingredient like e.g. binaries , tidal field , stellar evolution , etc . can be easily incorporated .",
    "for this reason , in many cases n - body simulations represent the unique tool to face with complex topics within the gravitational n - body problem .",
    "however , several processes involved in the dynamical evolution of a star cluster occur on different timescales , so that a direct scaling of the result of an n - body simulation to larger number of particles is not possible ( baumgardt 2001 ) .",
    "although the grape series of special - purpose computers is steadily increasing in performance and the development of graphic processing units ( gpus ) computing , direct n - body simulation of the evolution of clusters with more than a few percent binaries and a moderate number of stars ( @xmath1 ) is still computationally expensive , with computational timescales of the order of months . until now only open clusters such as m67 and the arches cluster ( hurley et al .",
    "2005 ; harfst , portegies zwart & stolte 2010 ) and loosely bound globular cluster objects such as palomar 4 and palomar 14 ( zonoozi et al .",
    "2011 , 2014 ) have been modelled at the necessary level of sophistication .",
    "alternative numerical methods to simulate the evolution of star clusters have been developed in past years including fluid models ( larson 1970 ; angeletti & giannone 1977a , b ) , orbit - averaged fokker - planck methods ( cohn 1980 ; takahashi 1995 ) and monte carlo simulations ( hnon 1971 , hereafter h71 ; giersz 1998 ; joshi , rasio & portegies - zwart 2000 ) .",
    "monte carlo methods can be regarded as a hybrid between direct n - body integrations and numerical solutions of the fokker - planck equation . in this approach",
    "the system is modelled as a sample of `` superstars '' i.e. a subsample of stars sharing the same mass and integrals of motions . in spherical systems",
    "the motion of each superstar depends only on its energy and angular momentum and on the cluster potential , this last quantity being a unique function of positions and masses of the superstars . through an iterative algorithm",
    "it is therefore possible to follow the evolution of the system once suited perturbations to the integrals of motion of the superstars are applied to account for the effect of two - body interactions . within the family of monte carlo methods",
    "two approaches can be distinguished : _",
    "i ) _ the _ orbit - following _ method ( also known as the `` princeton method '' ; spitzer & hart 1971 ) where the orbits of the superstars are directly computed and _ ii ) _ the _ orbit - averaged _ method ( the `` cornell method '' ; h71 ) where only the energies and angular momenta of superstars are monitored . while orbit - following methods are more suited to follow all those processes occurring on the dynamical timescale ( such as the evaporation of stars from the cluster , the violent relaxation , the tidal shocks and the phase of post - core collapse ) , orbit - averaged methods are computationally less expensive since perturbations to the integrals of motions need to be computed at time - steps that are short compared to the relaxation time and the time consuming integration of the orbits is not required",
    "moreover , it is particularly easy to add more complexity and realism to the simulations one layer at a time and they are particularly easy to be parallelised . for these reasons ,",
    "orbit - averaged monte carlo simulations have been employed by a number of groups to study the dynamical evolution of globular clusters and the dense centers of galaxies . in recent years",
    "a particular effort have been made by these groups to include the effect of a mass spectrum ( giersz 2001 ) , stellar evolution ( joshi , nave & rasio 2001 ) , three- and four - body interactions ( giersz & spurzem 2003 ; fregeau & rasio 2003 ; fregeau et al .",
    "2007 ) and a simplified treatment of a tidal field ( giersz et al . 2013 ; takahashi & baumgardt 2012 ) .",
    "one of the most complex process to be modelled in monte carlo simulations is the escape from a cluster in an external tidal field .",
    "in fact , while stars can escape from an isolated cluster only when they have positive energies , when the cluster moves within a tidal field the effective potential felt by a cluster star is perturbed and has a maximum at a distance ( called `` tidal radius '' ) which depends on the shape of the external field and on the orbital parameters of the cluster .",
    "if the star moves beyond this radius the gravitational attraction of the cluster will not balance the combined effect of the external tidal field and the centrifugal force and the star will escape from the cluster .",
    "for this reason the presence of the external field accelerates the escape process and consequently the whole structural evolution of the system ( spitzer 1987 ) .",
    "since the first pioneering studies by h71 , the effect of a steady external field has been modelled by removing stars able to reach an apocenter larger that the tidal radius .",
    "this last quantity was estimated considering the distance of the lagrangian point in the simple case of an external potential produced by a point mass on a cluster moving on a circular orbit . even in this simple case",
    ", however , this criterion represents only a rough approximation .",
    "indeed , the presence of the external field breaks the spherical symmetry of the effective potential and the size of the tidal radius depends on the direction of the star motion . in practice",
    ", stars can escape from the cluster only close to the direction of the galactic center through the so - called `` 2nd and 3rd lagrangian points '' .",
    "moreover , in real clusters , once a star reach the energy required to escape , it needs several crossing times to reach the right direction ( the so - called `` potential escapers '' ) thus producing a delayed escape .",
    "fukushige & heggie ( 2000 ) derived a simple prescription to estimate the timescale of escape as a function of the excess of energy with respect to the lagrangian point energy level . on the basis of this last result , giersz et al .",
    "( 2013 ) adopted a delayed escape criterion which successfully account for this effect .",
    "the situation is more complex when eccentric orbits are considered : in this case , the hamiltonian is time - dependent and the tidal radius can be only instantaneously determined .",
    "in this situation , the aperture in the phase - space for a star to escape changes with time and stars can have only a limited amount of time to reach such an aperture .",
    "moreover , stars escaping from the cluster can be re - captured when the cluster expand during its motion away from the perigalacticon . to further complicate the picture ,",
    "it has been shown that stars with prograde and retrograde motion escape with different efficencies ( read et al .",
    "2006 ) and there are stars which permanently remain bound to the cluster outside the tidal radius ( `` non - escapers '' ; ross , mennim & heggie 1997 ) . finally , the potential of the milky way can not be realistically approximated as a point mass but consists of many non - spherical components . in a non -",
    "spherical potential orbits are in general non - planar and rapid changes of potential can produce compressive shocks which increase the kinetic energy budget of cluster stars ( gnedin & ostriker 1997 ) .",
    "in this paper we present a new orbit - averaged monte carlo code able to simulate the evolution of a star cluster moving on an eccentric orbit within a realistic external potential . in sect .",
    "2 we describe the code and the modification made to the original algorithm described by h71 . in sect .",
    "3 the recipies to account for the effect of the external field are outlined .",
    "sect . 4 in devoted to the description of the set of simulations and their comparison with n - body simulations .",
    "we summarize our results in sect .",
    "a detailed derivation of the tidal radius and effective potential in complex potentials is provided in the appendix .",
    "the code presented here is an updated version of the orbit - averaged monte carlo method extensively described in h71 ( see also stodolkiewicz 1982 , giersz 1998 and joshi et al .",
    "the basic idea of this approach is to consider the cluster as a sample of superstars characterized by mass ( @xmath2 ) , energy ( @xmath3 ) and angular momentum ( @xmath4 ) per unit mass generating a spherical symmetric potential ( @xmath5 ) .",
    "the evolution of the cluster is divided in time - steps ( @xmath6 ) of variable duration . at each time - step the following steps are performed    1 .",
    "the optimal time - step is determined ( see eq . 10 by joshi et al . 2000 ; see also sect .",
    "[ esc_sec ] ) ; 2 .",
    "a statistical realization of the cluster is performed by placing the superstars at random positions along their orbits .",
    "each star is placed at a given distance from the cluster center according to the inverse of the star velocity at that distance ( see below ; see also sect .",
    "7 of h71 ) ; 3 .",
    "the cluster potential profile is evaluated according to the masses and positions of the superstars ( see below ) ; 4 .",
    "the mechanical work made by the ( internal+external ) potential change on the suparstars is calculated and corrections to the stars energies are applied ( see sect . [ shocks_sec ] ; see also sect .",
    "4 of stodolkiewicz 1982 ) ; 5 .",
    "each superstar is assumed to interact with its nearest neighbor producing a perturbation on its energy and angular momentum ( see sect . 5 of h71 ) .",
    "stars satisfying the escape criterion ( see sect .",
    "[ esc_sec ] ) are removed from the simulation .",
    "the above steps are repeated until the end of the simulation .",
    "a detailed description of the algorithms adopted to perform the above steps is provided in h71 , giersz 1998 and joshi et al .",
    "( 2000 ) and will not be repeated here .",
    "below we describe only the modifications to their approaches regarding the way the cluster potential is determined while in sect .",
    "[ ext_sec ] we extensively describe the adopted escape criterion .",
    "the most time - consuming step of the procedure outlined above is the distribution of the superstars across the cluster .",
    "this is done by extracting a variable @xmath7 ( with @xmath8 ) from the distribution @xmath9 where @xmath10 and @xmath11 are the pericenter and apocenter of the star orbit within the cluster potential and @xmath12 is the radial component of the star velocity at @xmath13 the values of @xmath10 and @xmath11 are first determined from the star energy and angular momentum and the cluster potential at the two zeros of the function @xmath14 then @xmath7 is extracted from @xmath15 using the von neumann rejection technique .",
    "h71 demonstrated that the above algorithm ensures that the probability to extract a given position is proportional to the time spent by the star in that position . according to h71",
    ", the cluster potential at a given distance from the cluster center @xmath16 can be determined in a straightforward way from the positions and masses of the superstars using the poisson equation in its discrete integral form @xmath17 where @xmath18 and @xmath19 are the position and mass of the i - th superstar , @xmath20 is the total number of superstars and @xmath21 is the index such that @xmath22 .",
    "this approach is efficient and adaptive by definition i.e. in the densest regions of the cluster it provides a better sampling of the potential .",
    "however , from a computational point of view , the above procedure is quite expensive since it requires a cycle over the n superstars to find the index @xmath21 which must be repeated at least two times for each superstar to find @xmath10 , @xmath11 and @xmath12 .    for this purpose we decided to calculate the cluster potential at the beginning of each time",
    "- step on a grid of @xmath23 evenly spaced radial steps .",
    "the potential at the distance @xmath16 is then determined by linearly interpolating between the two contiguous knots @xmath21 and @xmath24 . in this case",
    "the index @xmath21 is immediately found as @xmath25 .",
    "this simple modification speed up the entire process by a factor of ten .",
    "we developed two independent methods to define the potential in the grid knots which are used in different conditions .",
    "the first method ( hereafter referred as the _ fast method _ ) is to use eq .",
    "[ pot1_eq ] defining at each time - step a step - size of the grid @xmath26 where @xmath27 is the cluster core radius ( casertano & hut 1985 ) and @xmath28 is the superstar number density at @xmath18 calculated using the 50 nearest neighbor superstars .",
    "this is the fastest method and provides a good accuracy for most of the cluster evolution when clusters with moderate concentrations and a large number of superstars are considered .",
    "unfortunately , something is lost in the above modification : in the advanced stages of core collapse a large fraction of stars is contained within the innermost radial bins .",
    "in this situation , the spatial resolution of the grid is not adequate to follow the fast evolution of the cluster core and produces an unrealistic delay of the core collapse .",
    "moreover , another drawback of this method ( which is in common with the canonical method adopted by h71 ) is that the potential depends on the position of the superstars .",
    "as positions are randomly extracted , it is possible that fluctuations in the potential are present when a small number of superstars are considered .",
    "this effect is particularly strong in the cluster core where the potential is determined by few stars and can produce a `` spurious relaxation '' .",
    "h71 have shown that such an effect is negligible when a large number ( @xmath29 ) of particles is used . however",
    ", a pernicious effect is produced by such fluctuations when the correction for the mechanical work made by the potential ( step ( iv ) of the above scheme ; see stodolkiewicz 1982 ) is considered .",
    "indeed , fluctuations are erroneously interpreted as real potential changes introducing spurious corrections in the stars energies . on the long term",
    ", this produces a drift in the total cluster energy accelerating the relaxation process even when a number of superstars as large as @xmath30 is considered .    for this reason we developed another method ( hereafter referred as the _ integral method _ ) to determine the cluster potential in the grid knots .",
    "consider a star with energy @xmath31 and angular momentum @xmath32 moving in the potential @xmath5 .",
    "when the star is in the j - th radial bin @xmath33 its radial component of the velocity will be given by eq .",
    "[ vr_eq ] and its radial component of the acceleration will be @xmath34 these quantities have been estimated using the potential and its derivative calculated in the previous time - step . in the approximation that the star moves with a uniformly accelerated motion ,",
    "the time spent to cross the interval ( @xmath35 , @xmath36 ) is @xmath37 the probability to find the star in that interval will be @xmath38 where @xmath39 is the orbital period of the superstar .",
    "the potential at each point of the grid can be then calculated through the relation @xmath40 where @xmath21 is the index such that @xmath41 .",
    "this method has the advantage to depend only on the energies and angular momenta of the stars and not on the randomly extracted positions of the superstars . in practice , it is equivalent to compute the potential from an infinite number of randomly extracted positions thus eliminating the problem of fluctuations .",
    "moreover , it allows to estimate the orbital period of each superstar ( eq .",
    "[ per_eq ] ) which will be used in the escape algorithm ( see sect .",
    "[ esc_sec ] ) .",
    "there are two main drawbacks of this methods : first , to determine @xmath42 and @xmath43 it is necessary to use the potential profile calculated in the previous time - step .",
    "for this reason , at odds with the _ fast method _ , the potential can be computed only on grid of positions which is fixed in time .",
    "therefore , a small step - size is required from the beginning of the simulation to adequately follow the cluster evolution also in the advanced stages of core collapse .",
    "we found that a good sampling of the potential profile during the entire cluster evolution is provided by the choice of @xmath44 where @xmath45 is the cluster core radius ( see eq .",
    "[ rc_eq ] ) at the beginning of the simulation .",
    "second , the above method is computationally expensive and almost all the improvement provided by the adoption of the evenly spaced grid is lost .    to optimize the speed of the simulation without losses of accuracy , during the simulation we adopt the _ fast method _ when @xmath46 , and switch to the _ integral method _ when the above condition is not satisfied .",
    "in this section we describe the treatment of the external tidal field in our monte carlo code . here",
    "we considered two kinds of external field potential : the first generated by a point mass galaxy with mass @xmath47 and the second by the analytical bulge+disk+halo potential defined in johnston , spergel & hernquist ( 1995 ; hereafter j95 ) .",
    "the orbit of the cluster within these potentials has been computed starting from its orbital energy and z - component of the angular momentum using a fourth - order runge - kutta algorithm providing an accuracy in terms of energy conservation better than @xmath48 during the entire evolution .",
    "the effect of dynamical friction has been neglected since it is expected to be negligible on the star cluster scale ( gnedin et al .",
    "1999 ) .",
    "the presence of an external field imply an increase of star losses because of two main processes : escape of stars through the cluster boundaries and tidal shocks ( this last process occurring only when the external potential has a bulge / disk component ) .",
    "we discuss the algorithms to include the above processes in the following sections .       and @xmath49 moving on a circular orbit at @xmath50 around a point - mass galaxy of @xmath51 .",
    "the dashed , solid and dotted lines ( red , black and blue in the online version of the paper ) indicate the effective potential along the x- , y- and z - axis , respectively.,width=328 ]    as already introduced in sect .",
    "[ intro_sec ] , the presence of an external tidal field imply the presence of a tidal cut in the cluster potential . stars with enough energy can cross the cluster tidal radius and evaporate from the cluster on a timescale comparable to the star orbital period .",
    "a star orbiting around a cluster immersed in an external field feels an effective potential given by the combination of the cluster potential ( @xmath52 ) , the external field potential ( @xmath53 ) and a term linked to the angular motion of the cluster . @xmath54 where * @xmath55 * is the angular speed of the cluster and * r * is the position vector of the star in a reference frame centered on the center of mass of the galaxy+cluster system rotating with angular speed @xmath56 .",
    "note that the jacobi integral associated to the above effective potential is conserved only in the particular case of a cluster moving on a circular orbit within a spherical potential .",
    "however , when other orbits / potentials are considered , the timescale on which such an integral changes is longer than the dynamical time of most cluster stars so that we can assume it instantaneously conserved .",
    "consider a cartesian reference system centered on the cluster with the x - axis pointed toward the galaxy center , the y - axis parallel to the galactic plane and directed toward the cluster rotation and the z - axis perpendicular to the previous axes .",
    "the acceleration felt by the a star approaching the tidal radius @xmath57 will be @xmath58 where @xmath59is the position vector of the star , @xmath60 is the cluster mass and @xmath61 is the acceleration due to the cluster angular motion .",
    "the tidal radius is defined as the distance where the projection of the above acceleration on * r * is zero which corresponds to the radius at which the effective potential has a local maximum .",
    "note that , according to the above definition , both the tidal radius and the effective potential depend on the direction of the escape . it can be shown ( see appendix ) that the shortest and less energetic tidal radius occurs in correspondence of the x - direction ( i.e. the 2nd and 3rd lagrangian points ) while in the z - direction",
    "the effective potential is a growing function of the radius and no maxima exist ( see fig .",
    "[ pot ] ) .",
    "for this reason stars escape preferentially from the lagrangian points .    to determine wether a star escapes from the cluster we defined three distinct criteria .",
    "the first criterion we adopted is that the star energy and angular momentum allow the motion across the tidal radius . for this purpose we extracted two random numbers ( @xmath62 and @xmath63 )",
    "uniformly distributed between 0 and 1 and defined the coefficients @xmath64 these coefficient univocally define a direction of escape such that @xmath65 .",
    "the tidal radius and effective potential in the defined direction are then calculated ( see appendix ) as well as the mechanical work made by the external potential on the superstar ( @xmath66 ; see below ) . the first criterion is satisfied if @xmath67    the second criterion is based on the fact that the escaping star needs a timescale comparable to its orbital period ( @xmath68 ) to reach the tidal radius .",
    "this produces a delay in the escape process .",
    "this can be crucial when eccentric orbits are considered : in this case , @xmath57 changes with time and the star satisfies eq .",
    "[ crit1_eq ] only in a limited time interval .",
    "if such time interval is short compared to its orbital period , there is only a small probability for the star to escape .",
    "we then extracted a random number @xmath69 uniformly distributed between 0 and 1 and calculated the orbital period of the star to reach the tidal radius using eq .",
    "[ per_eq ] .",
    "we assumed that the the star can escape during the time - step @xmath6 if @xmath70    once the first two cirteria are satisfied the star can escape from the cluster .",
    "after this phase the star moves in the galactic potential as an independent satellite following an epicyclic orbit along either the trailing or the leading arm of the cluster tidal tails . during this motion ,",
    "the distance of the star from the cluster center oscillates according to the orbital phase of the cluster . to definitively escape from the cluster attraction",
    "there is a typical timescale which depends on the star s energy and on the cluster orbital parameters .",
    "moreover , if the cluster follows an eccentric orbit its tidal radius grows when the cluster leaves the perigalacticon and it can possibly exceed the distance of the previously escaped star . in this case",
    "the star is re - captured . to account for this effect , when a star satisfies the two above mentioned criteria its position and velocity",
    "are calculated using eq .",
    "[ pos_eq ] ( @xmath71 ) and @xmath72 where @xmath73 and @xmath74 is a random number uniformly distributed between 0 and 1 .",
    "the above phase - space coordinates are transformed in the galactic reference system , added to the cluster systemic coordinates and the orbit of both the star and the cluster within the galactic potential are followed using a fourth - order hermite integrator with an adaptive timestep for an entire cluster orbital period . during its motion outside the cluster the distance of the star from the cluster and the tidal radius are calculated .",
    "the star is removed from the simulation if the conditions @xmath75 are satisfied during a cluster orbital period . in the above equations @xmath76 is the maximum tidal radius reached by the cluster during an orbital period , @xmath6 is the time - step , @xmath68 is the star orbital period within the cluster and @xmath69 is the random number extracted for the criterion in eq .",
    "[ crit2_eq ] .",
    "the last modification regards the time - step adopted in the simulation when the external field is present . in joshi et a. ( 2001 ) the time - step is defined to ensure small deflection angles when introducing the perturbations to the supertars energies and angular momenta .",
    "however , another requirement is that the jacobi integral should not significantly vary within the time - step .",
    "so , we adoted as time - step the minimum between the time - step defined by joshi et al .",
    "( 2001 ) and 0.01@xmath77 , where @xmath77 is the cluster orbital period .",
    "when a cluster passes through the galactic disk or close to the galactic bulge the gravitational field of these two components exerts a compressive force which is superposed on the cluster s own gravitational field .",
    "this process is known as `` disk / bulge shocking '' ( ostriker , spitzer & chevalier 1972 ; aguilar , hut & ostriker 1988 ) .",
    "the theory of tidal shocks has been studied in the past by many authors and applied to orbit - averaged fokker - planck codes by gnedin & ostriker ( 1997 , 1999 ) and allen , moreno & pichardo ( 2006 ) .",
    "this effect can be viewed as a consequence of the mechanical work made by the external potential during the orbit . indeed ,",
    "any variation of the potential shape during the cluster evolution produces a work on the stars which is equal to the instantaneous potential variation .",
    "the variation of the internal potential can be due to many processes ( secular dynamical evolution , evaporation of stars , stellar evolution , etc . ) and is taken into account using the prescriptions by stodolkiewicz ( 1982 ) . in time - dependent external potentials",
    "( e.g. when an eccentric orbit and/or non - spherical potentials are considered ) also the external potential makes a work on the stars .",
    "this is particularly important when fast changes in the external potential occurs , like in the case of the disk crossing and the perigalactic passages . in this case , the binding energy per unit mass of the superstars located in the outskirts of the cluster changes on a timescale comparable to the dynamical time .",
    "this effect facilitates the escape of stars and can accelerate the cluster dynamical evolution .",
    "in analogy with stodolkiewicz ( 1982 ) , at each time - step we estimated the work made by the external potential on each superstar as the average between the potential changes at the positions of the superstar in two subsequent time - steps @xmath78/2\\\\\\end{aligned}\\ ] ] such a correction is updated during the orbit and temporary added to the energy of the superstar only to verify the escape criteria defined above .",
    "this correction can not indeed be permanently added the superstars energies since these are distributed across the cluster adopting the internal potential only ( i.e. assuming the cluster as isolated ) while the external potential is taken into account only in a subsequent step when the escape criteria are verified .",
    "[ cols=\"<,^,^,^,^,^,^,^,^,^ , > \" , ]         = 0 , 0.14 , 0.33 and 0.6 are drawn with solid , dashed , dotted and dot - dashed lines , respectively.,width=328 ]         but for the set of simulations with 42000 particles.,width=328 ]        = 2 , 3 , and 4 kpc are drawn with solid , dashed , and dotted lines , respectively.,width=328 ]    we tested the prediction of our code with a set of collisional n - body simulations performed with nbody6 ( aarseth 1999 ) . all simulations ( both monte carlo and n - body ) were run with n=21000 and n=42000 single - mass particles as a compromise to ensure a large number statistics and to limit the computational cost of n - body simulations .",
    "the standard @xmath79 parameter has been used to control the time step and set an energy error tolerance of @xmath80 . with these choices we got a relative error in energy smaller than @xmath81 at the end of every simulation run . for each simulation",
    "the cluster mass contained within the apocentric tidal radius and the lagrangian radii have been calculated and compared .",
    "lagrangian radii have been calculated from the cumulative distribution of distances from the cluster center of the particles .",
    "here we considered the radii containing 1% , 2% , 5% , 10 - 90% of the cluster mass within one apocentric tidal radius .",
    "we considered three different cases : _",
    "i ) _ an isolated cluster with a plummer ( 1911 ) profile ; _ ii ) _ a cluster with a mass @xmath82 , a king ( 1966 ) profile with @xmath83 and @xmath49 orbiting in a galactic potential generated by a point - mass of @xmath84 with an apogalacticon at @xmath85 , and _",
    "iii ) _ the same cluster of ( ii ) orbiting in the bulge+disk+halo galactic potential defined by j95 . in cases _ ( ii ) _ and _ ( iii ) _ a set of simulations with different eccentricities and orbits have been considered .",
    "the whole set of simulations is summarized in table 1 .    in fig .",
    "[ plum ] the evolution of the lagrangian radii of the isolated plummer ( 1911 ) model as a function of the initial half - mass relaxation time is compared with that predicted by the n - body simulation with n=8192 particles by baumgardt , hut & heggie ( 2002 ) .",
    "the agreement is excellent with only a small discrepancy near the core collapse for the innermost radii .",
    "the core collapse occurs after @xmath86 when the cluster have lost @xmath873% of its stars .",
    "both quantities are in good agreement with the results of baumgardt et al .",
    "the excellent agreement with the n - body simulation indicates that the monte carlo code well reproduces the relaxation process until the core collapse .",
    "another set of simulations have been performed considering an external tidal field generated by a point - mass galaxy .",
    "in such a potential stars feel the tidal cut but are not subject to disk shocks .",
    "these simulations are therefore suited to test the escape from the cluster boundary both in case of circular and eccentric orbits .",
    "simulations have been run until core collapse .",
    "the subsequent evolution is largely influenced by the presence of binaries which form during the maximum density phase .",
    "as our monte carlo code does still not account for this process it can not reproduce properly such an evolutionary stage .",
    "the evolution of the cluster mass and of the lagrangian radii for this set of simulations are compared with the results of n - body simulations in fig .",
    "[ pm_mass ] and [ pm_lag ] , respectively .",
    "it is apparent that in all the simulations with eccentricity @xmath88 the monte carlo tends to systematically overpredict the mass - loss rate with respect to n - body simulations , although such a discrepancy is always within 5% .",
    "the evolution of the lagrangian radii is also well reproduced during the entire cluster evolution .",
    "a different situation is for the simulation of the most eccentric ( @xmath89 ) orbit . in this case , while the evolution of the bound mass is well reproduced by our monte carlo code , the lagrangian radii are strikingly different . in particular , while the n - body simulation predict an overall contraction of the cluster , the monte carlo code predicts a quick expansion followed by a quick collapse of the core .",
    "a possible reason for such a discrepancy is that in this last orbit the tidal radius penetrates into the cluster at pericenter leaving a significant fraction of cluster stars free to escape",
    ". when this occurs , the criteria defined in sect .",
    "[ esc_sec ] are not adequate anymore and an unrealistically large fraction of stars evaporate from the cluster in a short amount of time .",
    "the loss of potential energy is larger than that in kinetic energy and the cluster expands , furthermore increasing the escape efficiency .",
    "as the number of stars in the cluster becomes smaller the relaxation process speeds up and the core quickly collapse .",
    "summarizing , it appears that the treatment of the external tidal field described in sect .",
    "[ esc_sec ] is effective when the escape rate of stars during a cluster orbital period is smaller than a critical value . in fig .",
    "[ pm_mass42 ] and [ pm_lag42 ] the comparison between the bound mass and lagrangian radii for the same set of simulations with 42000 particles are shown , respectively . also in this case , the agreement is good in all the simulations with moderate eccentricity ( @xmath88 ) both in terms of the mass and of the lagrangian radii evolution .",
    "again , for the most eccentric simulation , while the bound mass evolution is fairly well reproduced , the lagrangian radii of the monte carlo simulation show the same unproper behaviour already noticed in the simulations with 21000 particles .",
    "to properly estimate the range of validity of our code , we performed another set of simulations where a cluster with 21000 particles and the same structural characteristics of the previous simulations has been launched on circular orbits at different distances from the point - mass galaxy ( @xmath902,3 and 4 kpc ) .",
    "the results of such an experiment are shown in fig.s [ pm_testmass ] and [ pm_testlag ] .",
    "as expected , monte carlo simulations related to clusters moving at large galactocentric distances show a good agreement with n - body ones . on the other hand ,",
    "as the tidal field becomes stronger the mass - loss rate predicted by the monte carlo code exceeds that that of the n - body simulations . as a consequence ,",
    "the cluster internal dynamical evolution accelerates and the core collapse is anticipated . according to the escape criteria defined in sect .",
    "[ esc_sec ] , the timescale at which a star escapes from the cluster is of the order of a few dynamical times . while this timescale depends on the energy and angular momentum of each star and on the cluster potential , it is expected to scale with the global quantity @xmath91 .",
    "it is therefore useful to introduce the mass - loss rate per half - mass dynamical time @xmath92 the above parameter has been calculated during the cluster evolution and averaged from the beginning of the simulation to the core collapse ( see table 1 ) . to define a criterion of validity of our simulations we correlated the values of @xmath93 with the discrepancy between bound mass fraction predicted by monte carlo and n - body simulations measured at core - collapse in this set of simulations .",
    "we obtain @xmath93=-0.00007 , -0.00013 and -0.00040 and @xmath94=1.2% , 3.0% and 15.9% for the simulations at 4 , 3 and 2 kpc , respectively . on the basis of the above comparison and defining a resonable agreement at @xmath955%",
    ", we adopt a value of @xmath96 - 0.0002 as a conservative limit of validity of our code .",
    "the last set of simulations considers a cluster immersed in the three - components bulge+disk+halo external potential defined by j95 .",
    "we considered a cluster lying at an initial distance of 10 kpc from the galactic center with two different eccentricities and two different heights above the galactic plane . in each case",
    "the intensities of the tidal shocks are different since the cluster cross the disk and approaches its pericenter at different distances from the galactic center with different velocities .",
    "the three considered orbits in the x - y , x - z and r - z planes are shown in fig .",
    "the mass evolution of the three simulations are compared with those predicted by the associated n - body simulations in fig.s [ compl_mass ] and [ compl_mass42 ] for the set with 21000 and 42000 particles , respectively .",
    "it can be noted that in all the simulations with 21000 particles the agreement is good ( within 5% ) during the entire evolution . on the other hand , in simulations with 42000 particles a tendency of the monte carlo code to underestimate",
    "the cluster mass - loss rate is noticeable .",
    "this is particularly apparent in the simulations with eccentric orbits where the difference with respect to the prediction of the n - body simulation reach @xmath8710% at the core - collapse .",
    "such a discrepancy is in the opposite sense of what observed in simulations run within a point - mass potential , where the mass - loss rates were slightly overpredicted .",
    "note that in the three simulations the average mass - loss rate is @xmath97 i.e. below the critical limit where significant differences have been noticed in the simulations within a point - mass external potential .",
    "it is also interesting to note that the mass evolution of the two simulations with different heights above the galactic plane ( k - j95-e033 and k - j95-e033z ) yield to a quite similar residual mass after 12 gyr .",
    "this is not surprising since at the moment of the disk crossing , although the disk shocks are more intense in simulation k - j95-e033z because of the largest velocity of the cluster , the disk density is in both cases relatively small . also , the pericentric distance of both orbits is 5 kpc , significantly larger with respect to the bulge half - mass radius ( @xmath871.69 kpc ) .",
    "so , in the above cases , both disk and bulge shocks have only a little impact on the cluster structural and dynamical evolution . in fig.s",
    "[ compl_lag ] and [ compl_lag42 ] the evolution of the lagrangian radii of the three simulations are compared with the predictions of the corresponding n - body simulations for the sets with 21000 and 42000 particles , respectively .",
    "again the agreement is good during the entire cluster evolution .",
    "in this paper we presented a new implementation of the monte carlo method to simulate the evolution of star clusters including for the first time the effect of a realistic tidal field and the possibility to consider eccentric orbits .",
    "the effect of the external field has been taken into account considering both the process of evaporation through the cluster boundaries and the effect of tidal shocks .",
    "the adopted algorithm is based on the theory of evaporation taking into account for the random direction of the escape , the time delay due to the star orbital period and the occurrence of the re - capture process .",
    "the comparison with direct n - body simulations indicates an excellent agreement in an isolated cluster and a good agreement ( within 5 - 10% ) in clusters within a tidal field of moderate intensity , in terms of the evolution of both the mass and the lagrangian radii .",
    "this indicates that both the process of two - body relaxation and the evaporation of stars are accurate enough . on the other hand ,",
    "a significant discrepancy is apparent when an extremely intense tidal stress is present ( @xmath98 ) .",
    "the reason of the disagreement relies on the failure of some ( maybe all ) of the criteria adopted to take into account the escape of stars when these apply to a significant fraction of cluster stars .",
    "it is worth noting that such an intense tidal field should be felt by only a small fraction of globular clusters ( only 2 out the 53 globular clusters considered by allen et al .",
    "2006 , 2008 ) .",
    "so this code can provide an efficient tool to study the evolution of present - day globular clusters . on the other hand ,",
    "the code developed here could fail to reproduce the initial stages of cluster evolution : in this case , the fast potential changes due to stellar evolution driven mass loss likely lead to a situation of roche - lobe overfilling where the critical mass loss rate is easily reached .",
    "consider that one of the basic assumptions of the monte carlo method is spherical symmetry which conflicts with the presence of the external field .",
    "in this situation star orbits are not expected to be planar and it is not guaranteed that two superstars with contiguous ranking in distance from the cluster center are neighbors .",
    "so , any treatment of the external field is expected to fail when somehow strong tides are considered .",
    "the performance of the code are also very good : the simulation k - pm - e0 - 21k presented here with 21000 particles takes @xmath8745 minutes ( `` clock on the wall '' time ) on a single five - years old asus machine equipped with a single intel core t5800@2ghz processor , while the corresponding n - body simulation takes @xmath8730 hours with a cluster node equipped with an intel xeon e5645 cpu ( 12 cores ) and a nvidia tesla m2090 ( 512 cuda cores ) . in spite of the relatively small considered number of particles , the above performance is good considering that the code include several cycles which can be in principle easily parallelized thus reducing the computational cost of simulations . assuming a scaling of the computation time with the number of particles as @xmath99 , it is possible to run simulations with @xmath100 with computation time of few days .",
    "the code already include other features to properly simulate the cluster evolution like the inclusion of a mass spectrum , the mass - loss driven by stellar evolution and the direct integration of three- and four - body interactions following the prescriptions by joshi et al .",
    "( 2001 ) and fregeau et al .",
    "however , the predictions of the code with these implemented features have not been tested and are not presented here .",
    "a forthcoming paper will introduce these features in the next future .",
    "as acknowledges the prin inaf 2011 `` multiple populations in globular clusters : their role in the galaxy assembly '' ( pi e. carretta ) .",
    "amb whish to thank the lady davis foundation .",
    "we thank the anonymous referee for his / her helpful comments and suggestions .",
    "we warmly thank holger baumgardt to have provided his n - body simulations and zeinab khorrami , carlo nipoti , luca ciotti and enrico vesperini for useful discussions .",
    "99    aarseth s.  j. , 1999 , pasp , 111 , 1333 aguilar l. , hut p. , ostriker j.  p. , 1988 ,",
    "apj , 335 , 720 allen c. , moreno e. , pichardo b. , 2006 , apj , 652 , 1150 allen c. , moreno e. , pichardo b. , 2008 , apj , 674 , 237 angeletti l. , giannone p. , 1977",
    ", ap&ss , 50 , 311 angeletti l. , giannone p. , 1977",
    ", a&a , 58 , 363 baumgardt h. , 2001 , mnras , 325 , 1323 baumgardt h. , hut p. , heggie d.  c. , 2002 , mnras , 336 , 1069 casertano s. , hut p. , 1985",
    ", apj , 298 , 80 cohn h. , 1980 , apj , 242 , 765 ferraro f.  r. , et al . , 2012 , natur , 492 , 393 fregeau j.  m. , rasio f.  a. , 2007 , apj , 658 , 1047 fregeau j.  m. , grkan m.  a. , joshi k.  j. , rasio f.  a. , 2003 , apj , 593 , 772 fukushige t. , heggie d.  c. , 2000 , mnras , 318 , 753 giersz m. , 1998 , mnras , 298 , 1239 giersz m. , 2001 , mnras , 324 , 218 giersz m. , spurzem r. , 2003 , mnras , 343 , 781 giersz m. , heggie d.  c. , hurley j.  r. , hypki a. , 2013 , mnras , 431 , 2184 gnedin o.  y. , ostriker j.  p. , 1997 ,",
    "apj , 474 , 223 gnedin o.  y. , ostriker j.  p. , 1999 ,",
    "apj , 513 , 626 gnedin o.  y. , lee h.  m. , ostriker j.  p. , 1999 ,",
    "apj , 522 , 935 harfst s. , portegies zwart s. , stolte a. , 2010 , mnras , 409 , 628 henon m. , 1969 , a&a , 1 , 223 hnon m.  h. , 1971 , ap&ss , 14 , 151 hernquist l. , 1990 , apj , 356 , 359 hurley j.  r. , pols o.  r. , aarseth s.  j. , tout c.  a. , 2005 , mnras , 363 , 293 johnston k.  v. , spergel d.  n. , hernquist l. , 1995 , apj , 451 , 598 joshi k.  j. , nave c.  p. , rasio f.  a. , 2001 , apj , 550 , 691 joshi k.  j. , rasio f.  a. , portegies zwart s. , 2000 , apj , 540 , 969 king i. , 1962 , aj , 67 , 471 king i.  r. , 1966 , aj , 71 , 64 larson r.  b. , 1970 , mnras , 147 , 323 miyamoto m. , nagai r. , 1975 , pasj , 27 , 533 morscher m. , umbreit s. , farr w.  m. , rasio f.  a. , 2013 , apj , 763 , l15 ostriker j.  p. , spitzer l. , jr . , chevalier r.  a. , 1972 , apj , 176 , l51 plummer h.  c. , 1911 , mnras , 71 , 460 read j.  i. , wilkinson m.  i. , evans n.  w. , gilmore g. , kleyna j.  t. , 2006 , mnras , 366 , 429 ross d.  j. , mennim a. , heggie d.  c. , 1997 , mnras , 284 , 811 sippel a.  c. , hurley j.  r. , 2013 , mnras , 430 , l30 spitzer l. , 1987 , princeton , nj , princeton university press spitzer l. , jr . , hart m.  h. , 1971 , apj , 164 , 399 takahashi k. , 1995 , pasj , 47 , 561 takahashi k. , baumgardt h. , 2012 , mnras , 420 , 1799 stodolkiewicz j.  s. , 1982 , aca , 32 , 63 zonoozi a.  h. , haghi h. , kpper a.  h.  w. , baumgardt h. , frank m.  j. , kroupa p. , 2014 ,",
    "mnras , 440 , 3172 zonoozi a.  h. , kpper a.  h.  w. , baumgardt h. , haghi h. , kroupa p. , hilker m. , 2011 , mnras , 411 , 1989",
    "as discussed in sect . [ esc_sec ] , when the cluster is immersed in an external tidal field its stars feel an effective potential due to the combination of the internal cluster potential ( @xmath52 ) , the external field potential ( @xmath53 ) and a term linked to the cluster angular motion .",
    "such an effective potential does not have a spherical symmetry so that the distances of its local maxima ( tidal radii ) are direction dependent . in the next sections the tidal radius and the effective potential as a function of the direction of escape",
    "are derived both for the case of an external field generated by a point - mass and for the complex bulge+disk+halo potential by j95 .",
    "the external potential generated by a point - mass galaxy is @xmath101 where @xmath102 is the mass of the galaxy and @xmath16 the distance of a test particle from the point - mass . consider a star at @xmath16 orbiting around a cluster located at @xmath103 . in the cartesian reference frame centered on the cluster with the x - axis pointed toward the point - mass galaxy , the y - axis in the direction of the rotation and the z - axis in the direction of the angular momentum ,",
    "be @xmath104 the position vector of the star .",
    "the distance of the star from the galaxy will be @xmath105    the tidal radius is defined as the point where the projection of the acceleration felt by the star ( eq .",
    "[ acc_eq ] ) on @xmath106 is zero .",
    "the acceleration is composed by three terms : one associated to the cluster potential , one associated to the external field and another associated to the cluster angular motion .",
    "the term associated to the external field is @xmath108\\nonumber\\\\   & = & \\frac{g m_{g}}{|{\\bf r'}| |{\\bf r}|^{5}}[x^{2}\\left(-2 r_{cl}^{2}+|{\\bf r'}|^{2}+4 x r_{cl}-3 x^{2}\\right)+y^{2}\\left(r_{cl}^{2}+|{\\bf r'}|^{2}-2 x r_{cl}-3 y^{2}\\right)+z^{2}\\left(r_{cl}^{2}+|{\\bf r'}|^{2}-2 x r_{cl}-3 z^{2}\\right)]\\nonumber\\end{aligned}\\ ] ] in the limit @xmath109 the above term can be approximated to @xmath110 .",
    "the acceleration due to the angular motion of the cluster is @xmath111 where @xmath55 is the angular speed of the cluster which , in an elliptic orbit with eccentricity @xmath112 and apogalactic distance @xmath113 is @xmath114 the third term of equation [ pmat_eq ] has null projection on @xmath59 since it is orthogonal to @xmath59 by definition . in the cluster reference system the remaining terms ( corresponding to the coriolis and the centrifugal+tidal acceleration ) have projection on @xmath59 @xmath115 .",
    "the total acceleration in the direction of @xmath59 at @xmath57 will be given by the sum of eq.s [ pmc_eq ] , [ pmf_eq ] and [ pma_eq ] @xmath116 where @xmath117 @xmath4 is the angular momentum of the superstar and @xmath74 is a random number uniformly distributed between 0 and 1 ( see eq .",
    "[ vel_eq ] ) .",
    "it is interesting to note that the coriolis acceleration is directed toward the direction of escape when the star is on a prograde orbit , while it is directed toward the cluster when retrograde orbits are considered .",
    "this is the reason why stars on prograde orbits escape more easily from the cluster ( see also hnon 1969 ; read et al .",
    "2006 ) .",
    "note that over a large number of random extractions of @xmath74 the term @xmath121 has null mean . in this case",
    "the tidal radius will simply be @xmath122 at pericenter and in correspondence to the lagrangian point @xmath123 will be @xmath124 , and the above equation reduces to that reported by king ( 1962 ) .",
    "we consider the three components galactic model by j95 which consists of the superposition of an hernquist ( 1990 ) bulge , a miyamoto & nagai ( 1975 ) disk and a logarithmic halo @xmath127 with @xmath128 , @xmath129 , @xmath130 , @xmath131 , @xmath132 , @xmath133 and @xmath134 . here",
    "we adopted a convenient cylindrical reference system @xmath135 , @xmath136 is the distance from the galactic center and @xmath137 is the angle between the z - axis and the position vector . in this reference system",
    "the cluster will be in @xmath138 .",
    "define an alternative cartesian rotating reference frame centered in the cluster center with the x - axis pointed toward the galactic center , the y - axis parallel to the galactic plane and pointed toward the direction of the cluster rotation and the z - axis perpendicular to the other axes .",
    "consider a star in @xmath139 moving around a cluster immersed in the above external potential .",
    "the coordinate transformation to the first reference system are @xmath140 and @xmath105 in analogy with what done in sect .",
    "[ pm_sec ] , we calculate the projection of the acceleration felt by the star ( eq .",
    "[ acc_eq ] ) on @xmath106 .",
    "the internal acceleration is always given by eq .",
    "[ pmc_eq ] .    the term associated to the external field can be calculated separately for the three galactic components @xmath141\\nonumber\\\\ \\frac{{\\bf r'}}{|{\\bf r'}| } \\cdot ( { \\bf r ' } \\cdot { \\bf \\nabla } ) \\nabla \\phi_{d}&=&g m_{d } |{\\bf r'}|\\left\\{\\frac{1+\\frac{a b^{2}}{(b^{2}+z_{cl}^{2})^{\\frac{3}{2}}}(\\tilde{x}^{2}cos^{2}\\theta+\\tilde{z}^{2}sin^{2}\\theta ) } { \\left[r_{cl}^{2}+\\left(a+\\sqrt{b^{2}+z_{cl}^{2}}\\right)^{2}\\right]^{\\frac{3}{2}}}- 3\\frac{\\left(r_{cl}^{2}+\\frac{2 a z_{cl}^{2}}{\\sqrt{b^{2}+z_{cl}^{2}}}\\right ) \\tilde{x}^{2}+\\frac{a^{2 } z_{cl}^{2}}{b^{2}+z_{cl}^{2}}(\\tilde{x}^{2}cos^{2}\\theta+\\tilde{z}^{2}sin^{2}\\theta ) } { \\left[r_{cl}^{2}+\\left(a+\\sqrt{b^{2}+z_{cl}^{2}}\\right)^{2}\\right]^{\\frac{5}{2}}}\\right\\}\\nonumber\\\\ \\frac{{\\bf r'}}{|{\\bf r'}| } \\cdot ( { \\bf r ' } \\cdot { \\bf \\nabla } ) \\nabla \\phi_{h}&=&\\frac{2 v_{0}^{2 } |{\\bf r'}|}{(d^{2}+r_{cl}^{2})^{2}}[(d^{2}+r_{cl}^{2})(\\tilde{y}^{2}+\\tilde{z}^{2})+(d^{2}-r_{cl}^{2})\\tilde{x}^{2 } ] .",
    "\\label{complf_eq}\\end{aligned}\\ ] ] where @xmath142 the acceleration due to the angular motion of the star is given by eq .",
    "[ pmat_eq ] , where @xmath143 and @xmath144 is the z - component of the cluster angular momentum . as in the case of the point - mass potential ,",
    "only the coriolis ( * @xmath145 * ) and the centrifugal+tidal ( * @xmath146 * ) terms of the acceleration have a projection on @xmath59 different from zero .",
    "so @xmath147- \\dot{\\theta}_{cl}^{2 } |{\\bf r'}|(\\tilde{x}^{2}+\\tilde{z}^{2})+ \\frac{2 l_{z } \\dot{\\theta}_{cl } |{\\bf r'}|}{r_{cl}^{2 } } \\tilde{y }   ( \\tilde{x}~cos\\theta_{cl}-\\tilde{z}~sin\\theta_{cl})\\nonumber\\\\ & & -2\\dot{\\theta}_{cl}(\\tilde{x}~v_{z}-\\tilde{z}~v_{x})-\\frac{2 l_{z}}{r_{cl}^{2}}[\\tilde{x}~v_{y}sin\\theta_{cl}-\\tilde{y } ( v_{x}sin\\theta_{cl}+v_{z}cos\\theta_{cl})+\\tilde{z}~v_{y}cos\\theta_{cl } ] .",
    "\\label{compla_eq}\\end{aligned}\\ ] ]    it is convenient to introduce the characteristic densities @xmath148\\right\\}. \\label{complb_eq}\\end{aligned}\\ ] ] where @xmath149 is either the acceleration due to the i - th galactic component ( @xmath150 ) or the centrifugal+tidal acceleration , @xmath4 is the angular momentum of the superstar and @xmath74 is a random number uniformly distributed between 0 and 1 ( see eq .",
    "[ vel_eq ] ) .",
    "it is therefore possible to combine eq.s [ pmc_eq ] , [ complf_eq ] , [ compla_eq ] and [ complb_eq ] to obtain the projection of the total acceleration felt by the star on @xmath59 latexmath:[\\[{\\bf \\nabla \\phi_{eff}}=\\frac{g m_{cl}}{|{\\bf r'}|^{2}}-g \\gamma      the tidal radius will therefore be @xmath119 with @xmath152 again , the coriolis term has null mean over a large number of random extractions of @xmath74 , so we can calculate @xmath57 assuming @xmath153 .",
    "@xmath154 note that at the lagrangian point @xmath123 the above formula is equivalent to the estimate provided by allen et al ."
  ],
  "abstract_text": [
    "<S> we present a new implementation of the monte carlo method to simulate the evolution of star clusters . </S>",
    "<S> the major improvement with respect to the previously developed codes is the treatment of the external tidal field taking into account for both the loss of stars from the cluster boundary and the disk / bulge shocks . </S>",
    "<S> we provide recipes to handle with eccentric orbits in complex galactic potentials . </S>",
    "<S> the first calculations for stellar systems containing 21000 and 42000 equal - mass particles show good agreement with direct n - body simulations in terms of the evolution of both the enclosed mass and the lagrangian radii provided that the mass - loss rate does not exceed a critical value .    </S>",
    "<S> [ firstpage ]    methods : numerical  methods : statistical  stars : kinematics and dynamics  globular clusters : general </S>"
  ]
}