{
  "article_text": [
    "an important problem in astrophysics is to model in a detailed way the collision of two black holes @xcite .",
    "this requires numerically integrating einstein s field equations and extracting from the simulations the relevant physical information .",
    "unfortunately , it is difficult to obtain numerical solutions of these equations in generic three - dimensional settings , especially for long term simulations .",
    "obstacles to this goal are encountered in both the analytical and numerical arenas . in the _ analytical _ one , the formulation of a well posed initial - boundary value problem is not completely understood .",
    "this includes the definition of proper initial and boundary conditions and the equations determining the future evolution of the fields . in the _ numerical arena _",
    "one seeks to define numerical techniques that allow for long term accurate evolutions .",
    "this requires the construction of appropriate discrete operators to implement the initial - boundary value problem .",
    "to date , despite considerable advances in both fronts , the challenge of simulating generic three - dimensional black hole systems remains unattained .",
    "this article intends to provide some initial steps for setting up numerical techniques suitable to address the numerical stability of equations like the ones in question , by extending and devising finite difference techniques to tackle first order symmetric hyperbolic problems in non - trivial domains , with numerical stability being guaranteed in the linear case .",
    "furthermore , via a local argument , one can assert that these methods should be useful in evolving smooth solutions of quasi - linear symmetric hyperbolic equations as well , as is the case of the full , non - linear einstein vacuum equations when appropriately written @xcite .",
    "although the main motivation of this work is to present techniques for the simulation of einstein s equations on domains with excised regions , the techniques here presented are readily applicable to any symmetric hyperbolic problem in such domains .",
    "applications of these techniques in a variety of scenarios will be presented elsewhere @xcite .",
    "this work is organized in the following way . in sections [ sect - numstab ] and [ sect - ob ]",
    "we review some of the issues involved in obtaining stable numerical schemes through the energy method , to set the stage for the specialized discussions that follow . in section",
    "[ sect - excision ] , the main new results of the article are presented : we derive three dimensional difference operators satisfying summation by parts for non - trivial domains which enable one to obtain energy estimates .",
    "we further introduce    dissipative operators which do not spoil these estimates . to complete a stability proof",
    ", one needs to impose boundary conditions without affecting the semi - discrete energy estimates obtained thanks to the use of the constructed dissipative and difference operators .",
    "one way of doing so is by imposing boundary conditions through an orthogonal projection , as done by olsson @xcite , a technique which can even be applied to non - smooth domains .",
    "conclusions are drawn in section [ sect - conclusions ] .",
    "the appendices include technicalities , discussions about courant limits and further details about the implementation of boundary conditions .",
    "in order to construct stable finite difference schemes for initial - boundary value problems ( ibvps ) associated with partial differential evolution equations we will use the method of lines @xcite .",
    "this means that we first discretize the spatial derivatives appearing in the partial differential equations so as to obtain a large system of ordinary differential equations for the grid functions .",
    "this system is usually called _ semi - discrete system_. in the following , we assume that the solutions of the partial differential equations satisfy an _ energy estimate _ which bounds some norm of the solution at some fixed time @xmath0 in terms of a constant @xmath1 which is independent of the the initial and boundary data times the same norm of the initial data and a bound on the boundary data . as we will discuss in more details below , one can derive a similar energy estimate for the semi - discrete system if the partial derivatives and the boundary conditions are discretized in an appropriate way .",
    "provided that the constant @xmath2 involved in this semi - discrete estimate can be chosen to be resolution - independent for small enough resolution , this immediately implies numerical stability for the semi - discrete problem .",
    "an important ingredient in the derivation of such estimates is the _ summation by parts _ ( sbp ) property which is the discrete analogue of _",
    "integration by parts_.    there are many possible discretizations of the partial derivatives and the boundary conditions which are consistent with the ibvp and which yield a stable semi - discrete scheme , and in general , the constant @xmath2 will be larger than the corresponding constant @xmath3 of the continuum problem . by carefully choosing the discretization one can achieve optimal semi - discrete energy bounds , in the sense that @xmath4 which means that the norm of the solution to the semi - discrete problem satisfies the same estimate as the norm of the solution to the analytic solution . alternatively or complementary , one might want to add artificial dissipation in order to control the high frequency modes of the solution which are always poorly represented with finite difference approximations",
    ".    finally , by discretizing the time derivatives one obtains the fully discrete system which is numerically implemented . if the semi - discrete system is stable one can show that the fully discrete system is stable as well , provided an appropriate time integrator is chosen .",
    "this will be briefly discussed later on .    to summarize , numerical stability in this approach reduces to    * formulate a well posed ibvp for the problem one wants to solve at the continuum . * construct difference operators for the domain of interest that satisfy the sbp property .",
    "* optionally or even complementary : * * construct dissipative operators that do not spoil the energy estimate .",
    "* * rearrange the semi - discrete equations to achieve optimal energy estimates .",
    "* impose boundary conditions without spoiling the semi - discrete stability . *",
    "achieve fully discrete stability by appropriately choosing the time integrator .",
    "the next subsections give an overview of these points .",
    "section [ sect - ob ] discusses some issues that appear in the ibvp case , while section [ sect - excision ] presents results for the case in which there are inner boundaries and excised regions in the computational domain .",
    "there are many definitions of well posedness though roughly , and without going into too many technical details , an ibvp is said to be well posed if    1 .   a local in time solution with certain smoothness exists , 2 .",
    "the solution is unique , and , 3 .",
    "the solution depends continuously on the initial and boundary data of the problem .",
    "there are different approaches to obtaining well posed formulations of a given problem .",
    "a common one is the so called energy method @xcite where one seeks an energy norm which has the form @xmath5 where @xmath6 , the solution of the ibvp at some given time @xmath0 , lies in some hilbert space with scalar product @xmath7 . in many physical situations ,",
    "this hilbert space can be motivated by the existence of a conserved energy .",
    "in general however , the expression @xmath8 does not need to coincide with any physical energy . for first order symmetric hyperbolic linear systems ,",
    "the hilbert space can be taken to be the space of square integrable functions over some domain @xmath9 with scalar product @xmath10 where the symmetrizer @xmath11 is a symmetric positive definite matrix - valued function on @xmath9 which is bounded from above and away from zero , and @xmath12 denotes the standard scalar product between the vector - valued functions @xmath13 and @xmath14 . in this case , and for suitable boundary conditions , one has an a priori estimate of the form @xmath15 where @xmath16 is independent of the initial and boundary data , and @xmath17 bounds the boundary data .",
    "this means that the solution at time @xmath0 can be bounded by the energy at @xmath18 and a bound on the energy pumped in through the boundary of the domain .",
    "in particular , for each fixed @xmath19 , small variations in the data result in small variations of the solution .    as an example , consider the initial - boundary value problem @xmath20 with smooth initial and boundary data , @xmath21 and @xmath22 , respectively , that satisfy appropriate compatibility conditions at @xmath23 .",
    "we also assume appropriate fall - off conditions at @xmath24 . taking a time derivative of the energy ( [ energynorm ] ) with @xmath25 and using the evolution equation ( [ eq : ev ] ) we obtain @xmath26 where we have used integration by parts in the last step .",
    "using the boundary condition ( [ eq : bc ] ) and integrating one obtains the energy estimate ( [ energygrow ] ) with @xmath27 and @xmath28 .",
    "the energy method is not only a valuable tool in studying the system at the analytical level , but it can also be used to produce stable numerical discretizations by considering a discrete analogue . essentially , this involves defining discrete operators with which one reproduces , at the discrete level , the steps taken at the continuum when obtaining the energy estimate . in what follows we briefly review the steps involved .    before we proceed , we mention that the existence of an a priori energy estimate , where the energy norm has the form of an integral over a local density expression , is a sufficient but not necessary condition for well posedness @xcite .",
    "a different approach for analyzing stability is the laplace method @xcite which gives necessary conditions for well posedness .",
    "however , the application of this method to obtain sufficient conditions is rather cumbersome and problem dependent . on the other hand ,",
    "the energy method is considerably simpler and so it is preferred when applicable .",
    "this is the approach we shall follow in this article .",
    "it can be applied to a very large set of physical problems .      as we have seen , a tool that is used in the derivation of energy estimates is integration by parts .",
    "in one dimension ( 1d ) it reads @xmath29 where @xmath30 .",
    "let @xmath31 be a positive integer , @xmath32 and consider the grid defined by @xmath33 , @xmath34 . the function @xmath35 is approximated by a grid function @xmath36 .",
    "one of the ingredients needed to obtain an energy estimate for the semi - discrete problem is to construct difference operators d ( approximating the first order partial differential operator @xmath37 ) which satisfy a sbp rule @xcite @xmath38 } + ( dv , u)_{\\sigma } ^{[0,n]}= \\left . v_j \\cdot u_j\\right|_{j=0}^n \\ ; ,   \\label{eq : sumbyparts}\\ ] ] with respect to some scalar product @xmath39 } = \\delta x\\sum_{i , j=0}^n \\tilde{\\sigma}_{ij } u_i \\cdot v_j \\ , .",
    "\\label{scalar_product2}\\ ] ] here , the weights @xmath40 must be chosen such that the norm @xmath41 , which can be seen as the discrete version of that defined in eq .",
    "( [ energynorm ] ) , is positive definite .",
    "achievement of sbp in general requires a careful choice of _ both _ the scalar product and difference operator ; for a given choice of scalar product there might not exist any difference operators satisfying the sbp property .",
    "in the following , we skip the label @xmath42 when it refers to the trivial scalar product @xmath43 .",
    "also , when there is no need to specify the domain , we skip the superscript @xmath44 $ ] .    having a 1d operator that satisfies sbp with respect to a _ diagonal scalar product _",
    "@xmath45 , one can construct a 3d operator by simply applying the 1d difference operator in each direction .",
    "the resulting 3d operator satisfies sbp with respect to the scalar product @xmath46 with coefficients ( making a slight abuse of notation ) @xmath47 @xcite .",
    "this is _ not _ necessarily true if @xmath48 is not diagonal .",
    "for this reason , we will only consider diagonal scalar products in this article . in the absence of boundaries",
    ", sbp reduces to @xmath49 provided suitable fall off conditions are imposed . in this case",
    "simple 1d operators that satisfy sbp with respect to the trivial scalar product are the standard centered difference operators @xmath50 ; for example , @xmath51 etc .",
    "defining a 3d difference operator by just applying this one - dimensional one in each direction will satisfy sbp with respect to the trivial 3d scalar product .    as a simple application , consider the initial value problem for the symmetric hyperbolic system , @xmath52 where @xmath53 is a vector valued function , the initial data @xmath21 vanishes for @xmath54 sufficiently large , and where the matrices @xmath55 are symmetric .",
    "assume for simplicity that the @xmath55 are constant and that @xmath56 .",
    "at the analytic level , the energy norm defined by eq .",
    "( [ energynorm ] ) with @xmath57 satisfies @xmath58 . if we replace @xmath59 by the centered differencing operator @xmath60 in the @xmath61th direction , the discrete energy @xmath62 with respect to the trivial discrete scalar product satisfies the same estimate : @xmath63 , and the scheme is stable by construction .",
    "even though one can achieve numerical stability through sbp , it is sometimes convenient to add artificial dissipation to the problem .",
    "one possible reason for doing so is the presence of high frequency modes which  even if they go away with increasing resolution ",
    "grow in time at fixed resolution .",
    "although this would not be the case in our present discussion , it is well known that the addition of dissipation can aid in stabilizing schemes that would otherwise be numerically unstable .",
    "an example of this would be the case of system that is stable at the semidiscrete level for example , a symmetric system with discretized with operators satisfying sbp but becomes unstable because the region of absolute stability of the time integrator does not contain a neighborhood of the origin along the imaginary axis .",
    "as an example , consider the initial value problem ( [ eq : hypeq],[eq : id ] ) .",
    "the standard way @xcite to introduce dissipation in the problem is to modify the right - hand side ( rhs ) of the equations @xmath64 where @xmath60 is a differential operator satisfying sbp and where @xmath65 is a differential operator that vanishes in the limit of infinite resolution , such that the consistency of the scheme is not altered , and such that @xmath66 with some inner product @xmath67 for which a discrete energy estimate holds ( for example , the one with respect to which sbp holds ) .",
    "the dissipative property ( [ dissipation ] ) ensures that the discrete energy estimate is not spoiled and might be useful to stabilize an otherwise unstable scheme .",
    "furthermore , @xmath65 can be chosen such that it controls spurious high frequency modes in the solution .    as mentioned above , in the absence of boundaries , standard centered derivatives satisfy sbp with respect to the trivial scalar product .",
    "similarly , the kreiss  oliger dissipation @xcite @xmath68 where @xmath69 denote the one - sided difference operators , satisfies the dissipative property ( dp ) with respect to that scalar product .",
    "furthermore , if the accuracy of the scheme without artificial dissipation is @xmath70 , choosing @xmath71 does not affect the accuracy of the scheme .",
    "notice also that with a slight abuse of notation we have used @xmath72 to denote the dissipative parameter ; this should not cause confusion with respect to @xmath73 used in the context of weights of scalar products , since the latter have subindices .",
    "so far , we have discussed how to obtain energy estimates for the semi - discrete problem by constructing finite difference operators that satisfy sbp .",
    "these estimates imply numerical stability , by providing a discrete analogue of eq .",
    "( [ energygrow ] ) .",
    "although the resulting scheme is stable the discrete estimate in principle might not agree with that found at the continuum ; that is , the constant @xmath74 appearing in the discrete analogue of eq .",
    "( [ energygrow ] ) might be larger than @xmath16 . if one can show that @xmath75 we say that the scheme is _",
    "strictly stable_. ] .",
    "the solution to non - strictly stable schemes can have unwanted features such as artificial growth in time of the errors . in the limit",
    "@xmath76 these features would disappear ; but one would like to avoid or minimize them even at fixed resolution .    for first order symmetric hyperbolic linear systems , like the one described by eqs .",
    "( [ eq : hypeq],[eq : id ] ) , one can achieve strict stability @xcite by rewriting the partial differential equation in skew - symmetric form : @xmath77 one can show that the resulting scheme is strictly stable with respect to the energy @xmath62 defined by the trivial discrete scalar product .",
    "in contrast to this , the simple discretization @xmath78 , while yielding a stable scheme , does not necessarily yield a _",
    "strictly _ stable scheme if the matrices @xmath55 are not constant .",
    "strict stability is particularly useful if the formulation at the continuum admits a sharp estimate . in this case",
    ", the construction of a strictly stable scheme can be exploited to rule out artificial growth of the solutions @xcite .",
    "consider , for example , a system with time - independent coefficients , @xmath79 let @xmath11 be a symmetrizer , i.e. a symmetric positive definite matrix - valued function @xmath80 which is bounded from above and away from zero and which is such that the matrices @xmath81 are symmetric . if @xmath11 can be chosen such that @xmath82 one can show that the energy given by eq .",
    "( [ energynorm ] ) is conserved , and that by rewriting the semi - discrete equations as @xmath83 the semi - discrete energy does not grow either . therefore the numerical solution will not have spurious growth even at a fixed resolution . in principle",
    ", there is no reason why such a symmetrizer should exist .",
    "however , on physical grounds , there should be one whenever there is a well defined local energy density .",
    "the usefulness of having a conserved energy at the semi - discrete level is discussed in detail in ref .",
    "@xcite .      proceeding through the steps above described ( [ wp]-[sbp ] ) , and optionally ( [ disip]-[stricstability ] )",
    ", one obtains an energy estimate for the _ semi - discrete problem _ which implies numerical stability for this semi - discrete system .    however , one is of course interested in the stability of the _ fully discrete problem_. one particular simple but powerful approach to achieve this goal is to follow the strategy based on the method of lines and employ a time - integrator guaranteed to give rise to a stable scheme .",
    "a useful feature of this approach is that one can derive conditions for the time integrator that are sufficient for fully discrete stability and independent of the details of the spatial discretization @xcite .",
    "two rather straightforward options are given by third and fourth order runge - kutta schemes @xcite . in appendix [ app - cfl ]",
    "we present an elementary discussion , for a wave equation in a domain without boundaries , that gives an idea of possible values of the courant factor . for more complicated equations and domains see ref .",
    "@xcite .",
    "so far our discussion has ignored the presence of boundaries .",
    "however these are unavoidable in most problems of interest . in the next sections we discuss how to modify the previously described techniques such that one recovers an energy estimate in the presence of boundaries . for the sake of clarity in the presentation ,",
    "we first concentrate on simple domains which do not posses inner boundaries and then consider the case of domains with holes .",
    "we here discuss appropriate finite - difference schemes for simple 3d domains .",
    "consider the following ibvp in the cubic domain @xmath84\\times [ 0,1]\\times [ 0,1]$ ] , with maximally dissipative boundary conditions ( @xmath85 denoting its ( non - smooth ) boundary ) , @xmath86 where the matrices @xmath55 are symmetric and @xmath87 represent the in- and outgoing characteristic variables with respect to the unit outward normal to the boundary .",
    "it is assumed that the coupling matrix @xmath88 does not depend on time and is small enough so as to imply an energy estimate @xcite .",
    "it is also assumed that the initial and boundary data are smooth enough and satisfy compatibility conditions at the intersection between the initial surface and boundaries .",
    "if one discretizes the rhs of equation ( [ eq : symhypsystem ] ) according to @xmath89 where the discrete derivative operator @xmath60 satisfies sbp , one will obtain an energy estimate , modulo boundary contributions that appear after sbp .",
    "as already mentioned , a simple strategy to construct 3d operators satisfying sbp is to use in each direction a 1d operator satisfying sbp with respect to a diagonal scalar product , and this is what we do in what follows .",
    "existence proofs of high order difference operators and scalar products satisfying sbp in 1d with boundaries can be found in @xcite .",
    "explicit expressions for these operators can be found in @xcite ( some of these operators have non - diagonal associated scalar products , and therefore their use beyond one dimensional cases does not guarantee numerical stability ) . in the interior",
    "the derivatives are approximated by one of the centered finite difference operators mentioned in the previous section , and the operator is modified near the boundary points .",
    "the simplest example is @xmath90 where the operators @xmath91 are defined in eqs .",
    "( [ eq : secondsd ] ) and ( [ eq : onesided ] ) .",
    "the operator ( [ eq : strand21 ] ) is second order accurate in the interior and first order at the boundaries .",
    "it satisfies sbp , eq .",
    "( [ eq : sumbyparts ] ) , with respect to the diagonal scalar product @xmath92 , @xmath93 for @xmath94 . for high order difference operators ,",
    "the operator and the weights in the scalar product may needed to be modified at points that are near the boundary points as well .",
    "if the boundary is not smooth and possesses corners and edges the prescription remains the same , provided the vertices and edges are _ convex_. since in the diagonal case the 3d scalar product is just the product of the 1d one , the weights @xmath95 are @xmath96 in the interior points , and in the outer boundary : @xmath97 at the boundary faces , @xmath98 at the edges and @xmath99 at the vertices .",
    "the presence of _ concave edges and vertices _ requires modifications , which need to be treated carefully .",
    "these will arise , for instance , when considering a computational domain with an interior excised region .",
    "we discuss this case in section iv .      having introduced the simple difference operator ( [ eq : strand21 ] ) that satisfies sbp in a cubic domain with respect to the 1d scalar product @xmath100 , we now construct some operators that satisfy the dissipative property with respect to the same scalar product .",
    "we start with the dissipation operator ( [ ko ] ) for @xmath101 but redefine @xmath72 and rewrite the operator as @xmath102 in the absence of boundaries , it satisfies the dp for all @xmath103 . notice that unless @xmath104 , the dissipation parameter @xmath72 is not dimensionless . as we will see later , this redefinition is convenient when boundaries are present .",
    "the goal is to define @xmath65 through eq .",
    "( [ dis2 ] ) for @xmath105 , and to extend its definition to @xmath106 such that the dp holds . through a straightforward expansion one",
    "gets @xmath107 } = \\frac{\\delta x}{2 } u_0 q_du_0 + \\sigma ( \\delta x)^s ( u , d_+d_-u)^{[1,n-1 ] } + \\frac{\\delta x}{2 } u_n q_du_n \\\\ & & = -\\sigma ( \\delta x)^s \\left ( \\| d_- u \\|^{[1,n ] } \\right)^2 + \\frac{\\delta x}{2}u_0\\left[q_du_0 - 2\\sigma ( \\delta x)^{s-1}d_+u_0\\right ] \\nonumber\\\\ & & + \\frac{\\delta x}{2}u_n\\left[q_du_n + 2\\sigma ( \\delta x)^{s-1}d_-u_n\\right ] \\ ; , \\end{aligned}\\ ] ] where the second equality comes from eq .",
    "( [ prop2 ] ) of appendix [ app - bp ] .",
    "certainly , there are many possible definitions of @xmath65 at the boundary points that imply the dp , eq .",
    "( [ dissipation ] ) .",
    "the simplest one is @xmath108 note that this dissipative term vanishes in the limit @xmath109 only if @xmath110 . on the other hand , in those cases , the amplification factor of the high frequency modes depends on the resolution already in the absence of boundaries .",
    "that is , consistency requires @xmath110 , and in those cases the amplification factor converges to the non - dissipative one as @xmath109 .",
    "this means that the dissipative operator just constructed can not be expected to cure difference schemes which are unstable .",
    "it can only be applied to systems where the amplification factor does not become greater than one in the limit of high resolution ; that is , to schemes which are already stable in the absence of dissipation .",
    "we now improve on this .    in the absence of boundaries ,",
    "the standard way of correcting this is by considering dissipative operators of the form ( [ ko ] ) with @xmath111 , which satisfy the dp and do not change the accuracy of a scheme which uses @xmath70th order accurate difference operators .",
    "therefore , we now look for corrections to the operator ( [ ko ] ) at and near the boundary points . for simplicity ,",
    "let us consider the case of a dissipative operator for an otherwise second order scheme ; that is , assume we are using difference operators of order two in the interior , and first order at boundary points .",
    "then , for @xmath112 we define @xmath65 through equation ( [ ko ] ) with @xmath113 , that is , we set @xmath114 where we have redefined @xmath72 , as before .",
    "the modification at and near the boundary points is motivated by a calculation that is similar to the one presented above : @xmath115 } & = & \\frac{1}{2}\\delta x u_0 q_du_0 +   \\delta x\\ ; u_1 q_d u_1 -   \\sigma ( \\delta x)^s \\left(u , d_+^2d_-^2u \\right)_{[2,n-2 ] }    \\nonumber\\\\ & & + \\ ; \\delta x u_{n-1 } q_du_{n-1 } + \\frac{1}{2 } \\delta x \\ ; u_n q_d u_n \\\\ & = & u_0\\left(\\frac{\\delta x}{2}q_du_0 + \\sigma ( \\delta x)^{s-1}d_+^2u_0 \\right )    \\nonumber\\\\ & & + \\ ; u_1\\left[\\delta xq_du_1 + \\sigma ( \\delta x)^{s-1 } \\left(d_+^2 \\ , \\ ,   - 2d_+d_-\\right)u_1\\right ] \\nonumber\\\\ & & - \\sigma ( \\delta x)^s\\left ( \\|d_+d_-u\\|^{[1,n-1 ] } \\right)^2 \\nonumber\\\\ & & + \\ ; u_{n-1}\\left [ \\delta xq_du_{n-1 } + \\sigma ( \\delta x)^{s-1 } \\left(d_-^2 \\ , \\ , -2d_+d_-\\right)u_{n-1 } \\right ]   \\nonumber \\\\ & & + \\ ; u_n\\left(\\frac{\\delta x}{2}q_du_n + \\sigma ( \\delta x)^{s-1}d_-^2 u_n \\right)\\ ; , \\end{aligned}\\ ] ] where in the last equality we have used properties listed in appendix [ app - bp ] .    as before , there is more than one way of satisfying the dp , the simplest one being : @xmath116 for @xmath117 the high frequency modes are now damped in a resolution independent way while the dissipative term vanishes in the limit @xmath109 . in this case , the dissipative operator constitutes a third order correction in the interior and a first order one at the boundary points and the two grid points next to it . adding this operator to the rhs of the equations",
    "does not affect the consistency of the scheme , but reduces in one the order of accuracy at the grid points @xmath118 and @xmath119 ( recall that the difference scheme was already first order at the boundary points , so the accuracy there is not changed ) .",
    "finally , the maximally dissipative boundary conditions ( [ eq : maxdiss ] ) are implemented by multiplying the rhs of ( [ eq : symhypsystem_discrete ] ) from left by an appropriate projection operator @xcite @xmath120 .",
    "for homogeneous boundary conditions , @xmath120 is the projection on the space of grid functions that satisfy the boundary conditions ( [ eq : maxdiss ] ) with @xmath121 which is orthogonal with respect to the scalar product for which sbp holds .",
    "the orthogonality of @xmath120 makes sure that the energy estimate is not spoiled , and hence numerical stability still follows .",
    "furthermore , if @xmath120 is time - independent , a solution to the resulting semi - discrete system automatically satisfies the boundary conditions .",
    "inhomogeneous boundary conditions are discussed in appendix [ app - bc ] .",
    "in the previous section we restricted our discussions to computational domains without inner boundaries . now we extend those results to non - trivial computational domains . to simplify the discussion",
    "we restrict ourselves to the case where a single cubic box is cut out of the computational domain . however , it is straightforward to see that the difference and dissipative operators constructed in this section can also be applied to a domain with multiple cubic boxes excised from the computational domain , such that sbp and the dissipative property ( dp ) are satisfied .",
    "we will only analyze the case in which the second order centered difference operator @xmath122 , defined in eq .",
    "( [ eq : secondsd ] ) , is used in the interior .",
    "the possibility of constructing higher order accurate operators is discussed in appendix [ app - fodiss ] .",
    "the modification of @xmath122 and its associated scalar product at the outer boundary points has already been discussed in the previous section .",
    "plane that passes through the interior of the excised cube ( left panel ) , or cuts the top or bottom of it ( right panel , also shown in fig.[fig : leftright ] ) .",
    "the weights @xmath95 that appear in the scalar product are 1 at interior grid points ( circles ) , @xmath123 at boundary faces ( squares ) , @xmath124 at convex edges ( hexagons ) , @xmath125 at convex vertices , @xmath126 at concave edges ( triangles ) and @xmath127 at concave vertices ( pentagons ) .",
    "[ fig : grid],title=\"fig:\",height=302 ]   plane that passes through the interior of the excised cube ( left panel ) , or cuts the top or bottom of it ( right panel , also shown in fig.[fig : leftright ] ) .",
    "the weights @xmath95 that appear in the scalar product are 1 at interior grid points ( circles ) , @xmath123 at boundary faces ( squares ) , @xmath124 at convex edges ( hexagons ) , @xmath125 at convex vertices , @xmath126 at concave edges ( triangles ) and @xmath127 at concave vertices ( pentagons ) .",
    "[ fig : grid],title=\"fig:\",height=302 ]    in order to define the scalar product and the difference operators at the excision boundary such that sbp holds , we restrict ourselves , without loss of generality , to an arbitrary line which is parallel to the @xmath128 axis . for points on such a line",
    "we assume that the difference operator in the @xmath128 direction depends only on neighboring points on this line ( as we will see next , this assumption suffices for our purposes ) . in order to label the grid points on such a line",
    "we only need the index @xmath61 and assume that there is an inner boundary at , say , @xmath129 .",
    "we will use centered differences at the neighbors @xmath130 and @xmath131 ( this will also turn out to be sufficient ) but leave the scalar product at these points undefined for the moment .",
    "that is , @xmath95 at points",
    "@xmath132 takes some values @xmath133 , @xmath134 , @xmath135 , respectively . note",
    "that since the difference operators at the outer boundaries have already been introduced in section [ sect - ob ] , for the sake of clarity and without loss of generality , we will now ignore this outer boundary and consider the case where only an inner boundary is present .",
    "therefore , in what follows , the subindices range from @xmath136 to @xmath137 .        by splitting the scalar product in the different sub - domains one",
    "gets ( omitting the sum over @xmath138 and @xmath139 ) @xmath140 } +     ( v , d_0u)^{(-\\infty,-1 ] } \\right ) + \\nonumber\\\\ & & \\beta\\delta x \\left ( u_0 dv_0 + v_0 du_0 \\right ) +   \\gamma \\left ( ( u , d_0v)^{[1,\\infty ) } +   ( v , d_0u)^{[1,\\infty ) }   \\right ) \\label{sbp } \\\\          & = & \\frac{\\alpha } { 2}(v_0 u_{-1 } + u_0v_{-1 } )   + \\beta \\delta x \\left(u_0 dv_{0 } + v_0 du_0\\right )   - \\frac{\\gamma } { 2 } ( u_0 v_1 + v_0u_1)\\;. \\nonumber\\end{aligned}\\ ] ] we now assume that the modified difference operator at @xmath129 has a stencil of width three ; that is , we assume that it has the form @xmath141 with @xmath70 , @xmath142 , @xmath143 to be determined later .",
    "taylor - expanding eq .",
    "( [ gen_der ] ) in @xmath144 one obtains that in order for @xmath145 to be consistent with @xmath146 the conditions @xmath147 must be satisfied . inserting eq .",
    "( [ gen_der ] ) and these conditions in eq .",
    "( [ sbp ] ) one sees that in order for sbp to hold , the mixed terms of the form @xmath148 must vanish .",
    "this yields @xmath149 equations ( [ consistency ] ) and ( [ mixed ] ) completely fix , at @xmath129 , the derivative operator ( i.e. the coefficients @xmath70 , @xmath142 , @xmath143 ) , and the scalar product ( i.e. , @xmath134 ) : @xmath150    notice that , unless @xmath151 ( which in our case would correspond to @xmath129 actually not being part of a boundary , as we will now see ) , the modified difference operator ( [ nder ] ) is only a first order accurate approximation of @xmath146 , as is the case at the outer boundary points .",
    "we now explicitly write down the scalar product and difference operator just constructed for the different possible inner boundary points :    * _ edges : _ + by definition of an edge , one neighbor lies in the interior ( and has scalar product weight equal to @xmath118 ) and the other lies at a face ( and has scalar product weight equal to @xmath123 ) .",
    "therefore , eq . ( [ beta ] ) implies that @xmath152 .",
    "thus , the expressions for the derivative operator ( depending on the face s side ) are , + [ cols=\"<,^,^\",options=\"header \" , ]      the dissipative operators computed in section [ artdiss ] need to be modified at the excision boundary .",
    "we again assume that the grid point under consideration at the inner boundary is at index @xmath153 with @xmath154 , and that at the neighbors , @xmath155 , @xmath156 .",
    "we expand the corresponding scalar product : @xmath157 } + ( u , q_du)_{\\sigma}^{(0,0 ) } + ( u , q_du)_{\\sigma } ^{[1,\\infty ) } \\nonumber\\\\ & = & \\alpha ( u , q_du)^{(-\\infty,-1 ] } + \\beta ( u , q_du)^{(0,0 ) } + \\gamma ( u , q_du)^{[1,\\infty ) } \\nonumber\\\\ & = & \\alpha \\sigma ( \\delta x)^s ( u , d_+d_-u)^{(-\\infty,-1 ] } \\nonumber\\\\ & & + \\ ; \\beta \\delta x\\ ; u_0 q_du_0   + \\gamma \\sigma ( \\delta x)^s ( u , d_+d_-u)^{[1,\\infty ) } \\nonumber\\\\ & = & -\\sigma ( \\delta x)^s\\left [ \\alpha \\left(\\|d_-u\\|^{(-\\infty,0 ] } \\right)^2   + \\gamma   \\left ( \\|d_-u\\|^{[1,\\infty ) } \\right)^2 \\right ] \\nonumber\\\\ & & + \\ ;",
    "u_0\\left [ \\beta q_d \\delta x + \\sigma ( \\delta x)^s\\left(\\alpha d_- -   \\gamma d_+ \\right ) \\right ] u_0 \\ ; , \\nonumber\\end{aligned}\\ ] ] where the last equality is due to eq .",
    "( [ prop2 ] ) .",
    "therefore one ( non - unique , but simple ) possibility is to choose : @xmath158 in which case @xmath159 } \\right)^2 + \\gamma    \\left ( \\|d_-u\\|^{[1,\\infty ) } \\right)^2 \\right ] \\;.\\ ] ] making the expressions for the dissipation explicit :    * _ edges : _",
    "+ @xmath160 * _ vertices :",
    "_ + @xmath161      the modification in this case follows along similar lines :    @xmath162 } +   ( u , q_du)_{\\sigma } ^{[-1,-1 ] } +   + ( u , q_du)_{\\sigma}^{[0,0]}\\nonumber\\\\ & & + \\ ;   ( u , q_du)_{\\sigma}^{[1,1 ] } +   ( u , q_du)_{\\sigma } ^{[1,\\infty ) } \\nonumber\\\\ & = & \\alpha ( u , q_du)^{(-\\infty,-2 ] }   +   \\alpha ( u , q_du)^{[-1,-1 ] }   +   \\beta ( u , q_du)^{[0,0 ] } \\nonumber\\\\ & + & \\gamma ( u , q_du)^{[1,1 ] } + \\gamma   ( u , q_du)^{[2,\\infty ) } \\nonumber\\\\ & = & -\\alpha \\sigma ( \\delta x)^s \\left ( u,(d_+d_-)^2u \\right)^{(\\infty,-2 ] } + \\alpha \\delta xu_{-1}q_du_{-1}\\nonumber\\\\ & & + \\ ; \\beta \\delta x\\ ; u_0 q_du_0 + \\gamma \\delta xu_1q_du_1 -     \\gamma \\sigma ( \\delta x)^s ( u , d_+^2d_-^2u)^{[2,\\infty ) } \\\\ & = & -\\sigma ( \\delta x)^s\\left[\\alpha \\left(\\|d_+d_-u\\|^{(-\\infty,-1 ] }   \\right)^2 + \\gamma    \\left ( \\|d_+d_-u\\|^{-\\infty,-1 ] } \\right)^2\\right ] \\nonumber\\\\ & & + \\ ; u_{-1}\\left[\\sigma ( \\delta x)^{s-1}\\alpha ( 2d_+d_--d_-^2)+\\alpha \\delta    x q_d \\right]u_{-1}\\nonumber\\\\ & & + \\ ;",
    "u_0\\left [ \\beta \\delta xq_d + \\sigma ( \\delta x)^{s-1}(\\alpha d_-^2+\\gamma d_+^2 ) \\right]u_0\\nonumber\\\\ & & + \\ ; u_1\\left[\\gamma \\delta x q_du_1 + \\sigma ( \\delta x)^{s-1}\\gamma    ( d_+^2 - 2d_+d_- ) \\right]\\ ; , \\nonumber\\end{aligned}\\ ] ]    where the last equality is due to eq . ( [ prop3 ] ) .",
    "therefore one possible choice is @xmath163 the case @xmath117 should be the preferred one , since then the amplification factor does not depend on resolution .    making the expressions for the dissipation explicit :    * _ edges : _",
    "+ @xmath164 * _ vertices : _ + @xmath165",
    "we have presented a set of 3d operators satisfying summation by parts which can be used in non - trivial domains .",
    "the use of these operators to numerically implement first order symmetric hyperbolic systems guarantee stability of the semi - discrete system . additionally , the use of appropriate time integrators and a consistent treatment of the boundary provide a systematic way to achieve a stable implementation .",
    "furthermore , in order to rule out artificial growth , we have defined dissipative operators which do not spoil the energy growth estimates .",
    "the usefulness of these techniques will be highlighted in their application to different problems elsewhere .",
    "in particular , these applications include the evolution of scalar and electromagnetic fields propagating in black hole backgrounds in @xmath166 @xcite ; scalar fields in @xmath167 with a moving black hole @xcite ; bubble spacetimes which require evolving the 5d einstein equations in the presence of symmetries @xcite , the construction of schemes capable to deal with the axis of symmetry in @xmath167 , axisymmetric scenarios @xcite and 3d numerical simulations of single black holes in full nonlinear gr @xcite .",
    "we would like to thank h.o .",
    "kreiss , d. neilsen , p. olsson , j. pullin , and e. tadmor for very useful discussions , comments and suggestions throughout this work .",
    "this work was supported in part by grants nsf - phy-9800973 , nsf - phy-0244335 , nsf - int-0204937 , phy99 - 07949 , nasa - nag5 - 13430 , by funds of the horace hearne jr .",
    "institute for theoretical physics , and by agencia crdoba ciencia , conicet , and secyt unc .",
    "ll has been partially supported by the sloan foundation .",
    "in this appendix the definition and some properties of the first order @xmath168 and second order accurate @xmath169 finite difference operators are given .",
    "the proofs of the following statements can be found in ref .",
    "@xcite , for instance .",
    "one can show that with respect to the scalar product and norm @xmath170 } \\equiv \\sum_{j = r}^s u_jv_j \\delta x ,   \\qquad \\left(\\|u\\|^{[r , s ] } \\right)^2 = ( u , u)^{[r , s]}\\;,\\ ] ] the following properties hold : @xmath171 } & = & - ( d_-u , v)^{[r+1,s+1 ] } + u_j v_j |_r^{s+1}\\\\\\ & = & -(d_+u , v)^{[r , s ] } - h(d_+u , d_+v)_{[r , s ] } + u_jv_j|_r^{s+1}\\ ; , \\\\ ( u , d_-v)^{[r , s ] } & = & - ( d_+u , v)_{[r-1,s-1 ] } + u_j v_j |_{r-1}^s \\\\ & = & -(d_-u , v)_{[r , s ] } + h(d_-u , d_-v)_{[r , s ] } + u_jv_j|_{r-1}^s\\ ; , \\\\ ( u , d_0v)^{[r , s ] } & = & -(d_0u , v)_{[r , s ] } + \\frac{1}{2}(u_jv_{j+1 } + u_{j+1}v_j)|_{r-1}^s\\;.\\end{aligned}\\ ] ] the following equalities are needed in the derivation of the modified derivative and dissipative operators near the boundary @xmath172 } & = & \\frac{1}{2}(u_ju_{j+1})|_{r-1}^s\\ ; , \\\\ ( u , d_+d_-u)^{[r , s ] } & = & -\\left ( \\|d_-u\\|^{[r , s+1 ] } \\right)^2 + u_{s+1}d_-u_{s+1 } -   u_{r-1}d_+ u_{r-1 } \\ ; , \\label{prop1}\\\\ ( u,(d_+d_-)^2u)^{[r , s ] }   & = & \\left ( \\|d_+d_-u\\|^{[r-1,s+1 ] } \\right)^2 + \\frac{u_{s+1}}{\\delta x}\\left(2d_+d_- - d_-^2\\right)u_{s+1 }   \\nonumber\\\\ & & - \\frac{u_{s+2}}{\\delta x}d_-^2 u_{s+2}+\\frac{u_{r-1}}{\\delta x}\\left(2d_+d_- -   d_+^2\\right)u_{r-1 } - \\frac{u_{r-2}}{\\delta x}d_+^2 u_{r-2 } \\ ; . \\label{prop3 } \\end{aligned}\\ ] ] a sketch of the calculation that leads to the last equality is : @xmath173 } & = & \\left ( \\|d_+d_-u\\|^{[r , s ] } \\right)^2 \\nonumber\\\\ & & + \\left .",
    "\\left ( u_j d_-d_+d_- u_j- d_-u_j d_+d_-u_j\\right)\\right|_r^{s+1 } \\label{prop2}\\\\ & = & ( \\|d_+d_-u\\|^{[r , s ] } ) ^2 + \\frac{1}{h}\\left .",
    "( u_{j-1}d_+^2u_{j-1 } - u_jd_-^2u_j)\\right|_r^{s+1 } \\nonumber\\\\ & = & \\left ( \\|d_+d_-u\\|^{[r-1,s+1 ] } \\right)^2 + \\frac{u_{s+1}}{\\delta x}\\left(2d_+d_- - d_-^2\\right)u_{s+1 } \\nonumber\\\\ & & - \\frac{u_{s+2}}{\\delta x}d_-^2 u_{s+2}+\\frac{u_{r-1}}{\\delta x}\\left(2d_+d_- -   d_+^2\\right)u_{r-1 } - \\frac{u_{r-2}}{\\delta x}d_+^2 u_{r-2}\\;. \\nonumber\\end{aligned}\\ ] ]",
    "here we analyze the question of whether one can construct high order difference operators satisfying sbp in a domain with excised cubic regions .",
    "more precisely , we seek difference operators that are fourth order in the interior and , as in the rest of the article , we assume that the 3d operator is inherited by a 1d one with diagonal scalar product , that the operator approximating , say , @xmath146 , depends only on points to the left or the right .",
    "unfortunately the calculation below shows that such an operator can not be constructed .",
    "however , a difference operator that satisfies sbp and is fourth order accurate almost everywhere in the interior could be obtained by means of a different approach where one decomposes the domain into cubes @xcite .",
    "the finite difference operator @xmath174 is a fourth order approximation of @xmath175 .",
    "strand @xcite showed that there exists a unique second order accurate modification of this operator near the boundaries , given by @xmath176 that satisfies sbp with respect to a diagonal scalar product , with @xmath177    next we discuss the question of whether one can modify this operator near inner boundaries , for the case of excised cubic regions , in a way such that sbp holds .",
    "let us assume that a 2d domain has a concave corner at the grid point @xmath178 , as is the case of an edge at the inner boundary of our domain .",
    "the scalar product near this point will have the following structure @xmath179 the weights @xmath180 for @xmath181 are unknown .",
    "we know that they must be positive and symmetric @xmath182 . we also need to compute a second order accurate difference operator .",
    "consider one of the rows with @xmath183 .",
    "their contribution to the scalar product @xmath184 must be zero , as there are no boundary terms at the continuum .",
    "we have @xmath185 } + \\delta x \\sum_{i=0}^3 \\sigma_{ij } u_i ( du)_i + ( u , d^{(4)}u)^{[4,+\\infty ) } \\ ; , \\label{rowj}\\ ] ] where @xmath186 is the fourth order accurate difference operator defined in eq .",
    "( [ d4 ] ) .",
    "the contribution from the first and last term of eq .",
    "( [ rowj ] ) can be calculated using the properties listed in appendix [ app - bp ] . in general , one has that @xmath187 } = \\frac{1}{12 } \\left.\\left ( 8 u_{j+1 } u_j - u_{j+2 } u_j - u_{j+1}u_{j-1}\\right)\\right|_{r-1}^s\\;.\\ ] ] we want to solve @xmath188 for the coefficients of the modified difference operator @xmath189 and the weights of the scalar product @xmath180 for @xmath190 .",
    "the operator @xmath189 can be at most a @xmath191 point stencil , i.e. @xmath192 a larger stencil would give rise to terms in ( [ rowj ] ) that would not cancel .",
    "by inspection of eq .",
    "( [ rowjbexp ] ) carefully , one sees that there are many coefficients of the modified difference operators that must vanish .",
    "this reduces the number of parameters from @xmath193 to @xmath194 .",
    "( [ rowjbexp ] ) becomes @xmath195\\\\ & & + \\sigma_{1j } u_1 \\left [ a_1 u_3 + \\left ( \\frac{1}{2 } - 2a_1\\right ) u_2 + \\left(-\\frac{1}{2}+2a_1\\right ) u_0 - a_1 u_{-1 } \\right]\\\\ & & + \\sigma_{2j } u_2 \\left [ a_2 u_4 + \\left ( \\frac{1}{2 } - 2a_2\\right ) u_3 + \\left(-\\frac{1}{2}+2a_2\\right ) u_1 - a_2 u_{0 } \\right]\\\\ & & + \\sigma_{3j } u_3 \\left [ a_3 u_5 + \\left(\\frac{1}{2 } -\\frac{15}{8 } a_3 + \\frac{1}{8 } b_3\\right ) u_4 + \\left ( -\\frac{1}{2 } + \\frac{5}{4 } a_3 - \\frac{3}{4 }",
    "b_3\\right ) \\right.\\nonumber\\\\ & & \\left.+ b_3 u_1 -\\frac{3}{8}(a_3 + b_3)u_0 \\right]\\\\ & & - \\frac{1}{12 } ( 8u_4u_3 - u_5u_3 -u_4u_2 ) \\;. \\end{aligned}\\ ] ]    unless @xmath93 there is no solution ; to see this it is sufficient to look at the coefficients of @xmath196 , @xmath197 , @xmath198 , @xmath199 , @xmath200 , @xmath201 and @xmath202 .    on the other hand",
    ", @xmath203 is in contradiction with the structure of the scalar product under consideration , see ( [ scheme ] ) .",
    "when discretizing a hyperbolic system of partial differential equations with an explicit scheme the courant - friedrich - lewy ( cfl ) condition has to be satisfied in order to have numerical stability .",
    "below we obtain necessary and sufficient conditions for the numerical stability of a 3d wave equation , using a standard von neumann analysis .",
    "in particular , we want to determine what is the maximum value of @xmath204 that one can use if artificial dissipation is added to the rhs .",
    "one can use this information as guide for choosing the courant factor in more general situations .",
    "we start by considering the scalar advective equation .",
    "consider the advective equation @xmath205 , with @xmath206 a real constant .",
    "if the spatial derivative is discretized using a second order centered differencing operator and the resulting semi - discrete system is integrated using a runge  kutta time integrator of order @xmath207 , the solution at a time step @xmath208 can be expressed in terms of the solution at the previous time step @xmath209 as @xmath210 this difference scheme ( [ eq : scheme_advective ] ) is stable if and only if it satisfies the von neumann condition .",
    "the courant limit is @xmath211 for the @xmath212 case ( third order runge - kutta ) and @xmath213 for the @xmath214 case ( fourth order runge - kutta ) .",
    "these limits change when artificial dissipation is added to the rhs .",
    "the fully discrete system becomes @xmath215 the amplification factor depends on the parameters @xmath216 and @xmath217 .",
    "if , for a given value of @xmath218 , we numerically compute the value of @xmath219 beyond which the amplification factor becomes in magnitude greater than one for some frequency , we obtain the plot in figure [ fig : courantlimits_1d ] .    .",
    "[ fig : courantlimits_1d],height=302 ]      consider now the 3d wave equation @xmath220 written in first order form .",
    "as before , we use the second order centered difference operator to approximate the spatial derivatives and @xmath207-th order runge - kutta .",
    "the finite difference scheme is @xmath221 where @xmath222 , @xmath223 we assume that @xmath224 and set @xmath225 . in fourier space the difference scheme becomes @xmath226 and the amplification matrix is given by @xmath227 where @xmath228 , @xmath229 , @xmath230 and @xmath231 .",
    "the maximum values for the courant factor are plotted in figure [ fig : courantlimits_3d ] .    .",
    "[ fig : courantlimits_3d],height=302 ]",
    "here we discuss how to discretize inhomogeneous boundary conditions of the type ( [ eq : maxdiss ] ) .",
    "let @xmath120 be the orthogonal projector onto the space of grid functions that satisfy the homogeneous version of the boundary conditions ( [ eq : maxdiss ] ) . by _",
    "we mean that @xmath120 is hermitian with respect to the scalar product for which sbp holds . eq .",
    "( [ eq : symhypsystem ] ) is discretized in the following way : @xmath232 where @xmath233 denotes the identity matrix on the space of grid functions .",
    "numerical stability for the resulting semi - discrete scheme can be shown under additional assumptions on the boundary data ( see @xcite ) .",
    "* discretize the partial derivatives using a difference operators that satisfies sbp .",
    "* at each @xmath234 * * calculate the outward pointing unit normal @xmath209 and let @xmath235 denote the boundary matrix .",
    "note that the normal at edges and vertices needs special consideration . in the next subsection",
    "it is discussed how this normal is to be defined in these cases . * * multiply the rhs by @xmath236 , where @xmath237 is the ( orthogonal ) matrix that diagonalizes @xmath238 , i.e.  @xmath239 , where @xmath240 is a diagonal positive ( negative ) definite matrix .",
    "let @xmath241 ; * * apply @xmath120 .",
    "since it is hermitian with respect to the scalar product for which sbp holds , this projector is non - trivial in the sense that , in general , it overwrites the ingoing _ and outgoing _ modes .",
    "consider , for simplicity , the case in which there is one ingoing and one outgoing mode ( or more generally , the case in which the coupling matrix between ingoing and outgoing modes is diagonal ) .",
    "then , we define @xmath242 where @xmath243 is the coupling that appears in the boundary condition @xmath244 .",
    "note that only when @xmath245 does the outgoing mode remain unchanged , otherwise it is overwritten . in the continuum limit",
    ", this overwriting is , of course , consistent with the partial differential equation . *",
    "go back to the primitive variables @xmath14 by multiplying by @xmath237 .",
    "it is useful to have stability results that allow for cubic domains , since they are used quite often .",
    "the corners in 2d or edges and vertices in 3d deserve special attention . in particular , the normal to the boundary",
    "is not defined there .",
    "the stability of the whole scheme is affected by the treatment of these points . in ref .",
    "@xcite it is discussed how to control ( i.e. how to achieve numerical stability ) the boundary terms that appear after sbp at non - smooth parts of the boundary . here",
    "we will summarize some aspects of this treatment .    for simplicity ,",
    "let us assume that the domain is a 2d square @xmath84\\times [ 0,1]$ ] and that the partial differential equation is a symmetric hyperbolic , constant - coefficients one with no principal terms , @xmath246 where @xmath247 and @xmath248 are constant symmetric matrices .",
    "if we define the energy norm to be @xmath249 , the time derivative of the energy norm will be given the boundary terms @xmath250 in particular , in these boundary terms , there is no contribution due to corners , since they constitute a set of measure zero .",
    "the semi - discrete energy estimate obtained by discretizing the rhs with a difference operator satisfying sbp is simply the discrete version of ( [ eq : contestimate ] ) : @xmath251 one needs to prescribe boundary conditions to the semi - discrete system at the corners .",
    "there , the unit vector @xmath209 is not defined . in @xcite",
    "it is shown how to define @xmath209 so that a bound to the semi - discrete energy estimate can be given .",
    "essentially , the idea is that by looking at the contribution coming from the corner @xmath252 in ( [ eq : semidiscrestimate ] ) , which is given by , @xmath253 ( note that the `` cross - terms '' @xmath254 and @xmath255 are _ not _ a typo but do result from a non - trivial contribution to the discrete energy ) , we see that we need to control the positive speed characteristic variables in the effective direction @xmath256 , where @xmath257 . for uniform grids with @xmath258 this effective unit vector at the corners of @xmath9",
    "is @xmath259 this is equivalent to providing boundary conditions as if the normal was at 45 degrees with respect to the faces of the cube .",
    "which data to give might be completely or partially determined by compatibility conditions . as discussed before , the way in which the boundary conditions are imposed in @xcite ,",
    "including at corners , is through a non - trivial orthogonal projector .",
    "one might wonder whether or not giving boundary conditions at corners along the normal to one of the two faces that define the corner yields an energy estimate .",
    "that is , if controlling characteristic fields in one of the directions ( say , the term @xmath260 ) implies that the other one is also under control because of some compatibility conditions .",
    "the general answer is _ no _ , but it might work in some particular cases .",
    "let us illustrate this with one example .",
    "consider the 2d symmetric hyperbolic system @xmath261 in the domain @xmath262 , @xmath263 .",
    "the characteristic fields in the @xmath128 direction are @xmath13 ( eigenvalue @xmath118 ) and @xmath14 ( eigenvalue @xmath264 ) . in the @xmath265 direction they are @xmath266 ( eigenvalue @xmath118 ) and @xmath267 ( eigenvalue @xmath264 ) . as boundary conditions in the @xmath268 and",
    "@xmath269 boundaries use @xmath270 and @xmath271 , respectively , with @xmath272 .    defining the energy",
    "@xmath273 taking a time derivative , using the evolution equations and integrating by parts gives ( note that in the discrete analogue this is where the `` cross terms '' comes from ) @xmath274 at the discrete level one is essentially left with the discrete version of this expression provided operators that satisfy sbp are used . in particular , the corner s contribution is @xmath275 where the dots represent the contributions from the boundary from points other than the corner .",
    "one has to control the complete corner term as it will not be canceled or changed by any contribution from other boundary points .",
    "suppose @xmath276 .",
    "the projector should set , for example , @xmath277 to zero .",
    "suppose one does not do this but , instead , controls only the ingoing mode in the @xmath128 direction ( that is , @xmath14 ) by setting it to zero .",
    "this does give an energy estimate , since @xmath278 which has the appropriate sign ( that is , the corner term can be bounded from above by zero ) .",
    "suppose on the other hand that one does not set it to zero but , instead , couples it to the outgoing mode , @xmath279 , with @xmath280 .",
    "then @xmath281 and the energy estimate follows or not , depending on the sign of @xmath143 .",
    "b. bruegmann , w. tichy , and n. jansen , phys .",
    "lett . * 92 * , 211101 ( 2004 ) .",
    "m. anderson and r. matzner , gr - qc/0307055 ; u. sperhake , k. smith , b. kelly , p. laguna and d. shoemaker , phys .",
    "d * 69 * , 024012 ( 2004 ) ; d.  shoemaker , k.  smith , u.  sperhake , p.  laguna , e.  schnetter and d.  fiske , class .",
    "quantum grav . * 20 * , 3729 ( 2003 ) ; l. lindblom and m. scheel , phys . rev . * d * 67 , 124005 ( 2003 ) ; t. baumgarte and s. shapiro , astrophys .",
    "j. * 585 * , 930 ( 2003 ) ; p. laguna and d. shoemaker , class .",
    "quantum grav .",
    "* 19 * , 3679 ( 2002 ) ; h.  j.  yo , t.  w.  baumgarte and s.  l.  shapiro , phys .",
    "d * 66 * , 084026 ( 2002 ) ; m. alcubierre , b. brugmann , d. pollney , e. seidel , and r. takahashi , phys . rev .",
    "d * 64 * , 061501 , ( 2001 ) ; m.  alcubierre and b.  brugmann , phys .  rev .",
    "d * 63 * , 104006 ( 2001 ) .",
    "h. yo , t. baumgarte and s. shapiro , phys .",
    "rev . d*64 * , 124011 ( 2001 ) ; m.  a.  scheel , l.  e.  kidder , l.  lindblom , h.  p.  pfeiffer and s.  a.  teukolsky , phys .",
    "d * 66 * , 124005 ( 2002 ) ; kidder , scheel , and teukolsky , phys rev .",
    "d * 64 * , 064017 ( 2001 ) .",
    "see , for instance , h. o. kreiss , j. lorenz , `` initial - boundary value problems and then navier - stokes equations '' , academic press , new york ( 1989 ) or ref .",
    "@xcite . + for applications in general relativity see : j. m. stewart , class",
    ". quantum grav . * 15 * , n9 , 1581 ( 1998 ) ; g. calabrese and o. sarbach , j. math .",
    "44 * , 3888 ( 2003 ) .",
    "e. tadmor , `` from semi - discrete to fully discrete : stability of the runge - kutta schemes by the energy method .",
    "ii '' , in `` collected lectures on the preservation of stability under discretization '' , lecture notes from colorado state university conference , fort collins , co , 2001 ( d. estep and s. tavener , eds . ) proceedings in applied mathematics 109 , siam 2002 , 25 - 49 .",
    "( downloadable from http://www.math.ucla.edu/  tadmor / pub / subj.html )"
  ],
  "abstract_text": [
    "<S> we discuss finite difference techniques for hyperbolic equations in non - trivial domains , as those that arise when simulating black hole spacetimes . </S>",
    "<S> in particular , we construct dissipative and difference operators that satisfy the _ summation by parts _ property in domains with excised multiple cubic regions . </S>",
    "<S> this property can be used to derive semi - discrete energy estimates for the associated initial - boundary value problem which in turn can be used to prove numerical stability . </S>"
  ]
}