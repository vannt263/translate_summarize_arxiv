{
  "article_text": [
    "networks that supply resources are essential to the maintenance and growth of many natural and engineered systems .",
    "these resource - distribution networks are pervasive throughout biology .",
    "examples include the tracheal system in insects , xylem networks in plants@xcite , foraging trails of ant colonies@xcite , and cardiovascular systems in animals@xcite .",
    "because the cardiovascular system delivers resources and energy to the body , its structure at least partly determines rates of growth and metabolism @xcite .",
    "moreover , the cardiovascular system plays a role in many diseases  such as heart disease , stroke , inflammation , and malignant tumor growth@xcite .",
    "the pervasiveness and importance of material transport in biology motivates the search for basic principles that help shape resource - distribution networks in general and the cardiovascular system in particular .",
    "the theory of the structure of vascular networks has roots in the early 20th century@xcite .",
    "more recent theories predict properties of the entire vascular network by assuming a hierarchical structure and include those of west , brown and enquist@xcite ( henceforth the wbe model ) , banavar et al.@xcite , dodds@xcite , huo and kassab@xcite , and others@xcite .",
    "these theories assume or predict how vascular structure , such as the radius of vessels , changes as the network branches from aorta to capillaries . while early theories focused on vessel radius , recent theories also incorporate how vessel length changes across the network@xcite .",
    "many also assume symmetric branching  child vessels have identical properties@xcite . in symmetric , hierarchical models , knowledge of both radius and length enables derivations of how metabolic rate varies with body size across species@xcite and how organismal and tumor growth rate change with body size@xcite .",
    "several theories predict vascular structures will be found to be self - similar  some aspect of the network can be viewed as a rescaled copy of the whole@xcite  across specific ranges of spatial scale@xcite .",
    "self similarity necessarily leads to relationships and distributions that are characterized by power laws , whose exponents we call the scaling exponents@xcite .",
    "self similarity can either be a strict or statistical property .",
    "each new chamber of the nautilus is a larger exact copy of the previous chamber , while along coastlines shorter segments exhibit rescaled statistical properties of the longer segments@xcite .",
    "self similarity in nature suggests scale - free principles that constrain structure . an organism may need to maintain a certain shape at all stages of growth , use a common developmental program at all scales , or cope with physical processes with no preferred scale",
    " such as energy minimization or turbulence in fluids .",
    "self similarity greatly simplifies many calculations , with applications from cardiac physiology@xcite to allometric scaling@xcite .",
    "real vasculature is known to deviate from hierarchical , symmetric models in many ways , leading to criticism and debate about leading models@xcite . without reliable data , it is impossible to determine whether these deviations can be ignored , so that existing theories can accurately predict newly observed features such as curvature in scaling relationships@xcite .",
    "price et al.@xcite recently decried the lack of data for individual vessel segments that are needed for tests of scaling theory .",
    "direct measurements and tests may reject existing principles while laying the groundwork for the discovery of new patterns and principles in vascular architecture .",
    "in addition , measurements can parameterize existing equations to obtain more exact predictions for metabolic rates and growth curves , and can be used to examine the natural variation in the parameters across species , tissues , and tumor types .",
    "vessel segment data preserves the asymmetry , reticulation , tortuosity , and other features of real vasculature , and quantitative data about these features may inform future models . furthermore , extreme values or distinct patterns of variation may be signatures of pathologies that could eventually be used as diagnostics .",
    "recent work involving direct measurements of plant architecture has begun to realize this potential@xcite .    comprehensively characterizing vascular structure and obtaining reliable estimates for vascular scaling exponents",
    "requires large numbers of measurements across orders - of - magnitude in spatial scale  ranging from 0.004 mm to 15 mm for vessel radii in humans .",
    "measurement is complicated because vascular systems are intertwined with tissues throughout the body at a wide range of spatial scales@xcite .",
    "even gross morphological measurements have historically taken impressive and time - consuming efforts and required invasive methods such as casting@xcite . zamir@xcite and kassab@xcite constructed explicit descriptions of small regions of vascular systems  such as the coronary artery  by perfusing fixed specimens with a silicone or acrylic polymer , dissolving tissue away and examining each vessel segment under a microscope .",
    "these approaches enabled the measurement of tens of thousands of vessels from fixed specimens that were then used to test and develop vascular system models@xcite .",
    "however , the process of casting may enlarge or damage vessels , and little of this raw data is publicly available for analysis .",
    "in addition , many more measurements across the range of scales are needed to identify the principles that shape vascular architecture .",
    "different physical principles may dominate at different scales , and mapping out different regimes will require large amounts of data at each scale . in the wbe model@xcite , the dominant mechanism of energy loss for blood flow in the arterioles ( radius @xmath0 1 mm ) is viscous dissipation , but near the heart ( vessel radius @xmath1 1 mm ) pulsatile flow and reflection of pressure waves along vessel walls dominates@xcite .",
    "the transitions between these regimes are neither well - understood theoretically nor described empirically@xcite .",
    "the pulsatile regime  the focus of our measurements  has greater variation in the number of branching orders and size of vessels across species and is thus the primary determinant of scaling of metabolic and other vital rates with body size@xcite .",
    "large amounts of vascular data across all relevant spatial scales are contained within existing angiographic images ( e.g. , mri and x - ray ) .",
    "these images are obtained non - invasively , thus avoiding problems of damage to vasculature and allowing for the possibility of longitudinal studies .",
    "the latent data within these images represents a tremendous opportunity .",
    "all that is needed is a reliable and automatic method for extracting vascular data from angiographic images .",
    "we have developed novel software that imports 3d images , creates a topologically and spatially explicit map of the blood vessel network , and measures the radius , length , and volume of all visible vessels .",
    "we have applied this software to 20 magnetic resonance angiograms of living humans to obtain 3015 data points that range in radius from 0.6 - 6.8 mm , representing an order of magnitude .",
    "this range corresponds to large vessels in the pulsatile flow regime relevant to allometric scaling@xcite .",
    "we then analyzed these data based on the four distinct methods ( eqs  [ eq : murray_gen]-[eq : regres ] ) for measuring vascular scaling exponents described below .",
    "vascular scaling exponents encapsulate how radius and length of vessels change across the network .",
    "virtually all scaling relationships for local or global properties can be expressed in terms of these vascular scaling exponents .",
    "consequently , we view these scaling exponents as forming the foundation of most modern biological scaling theory and make them the primary focus of our analysis . we here describe four distinct methods for calculating vascular scaling exponents .    because the radius of the vessel plays a primary role in determining both the flow rate and resistance to blood flow through the vessel , theories for the vascular scaling exponent for vessel radius often focus on the power to pump blood from the heart to the capillaries .",
    "it is argued@xcite that this power will have been minimized by natural selection to allow as much power as possible to be available for foraging , growth , and reproduction .",
    "one classical approach minimizes power loss of blood flow due to viscous dissipation and due to cost of blood volume in order to derive that flow rate , @xmath2 , depends on the cube of the vessel radius , @xmath3 . combining this result with conservation of fluid flow at a branching junction yields",
    "murray s law , @xmath4 , where @xmath5 is the radius of the parent vessel segment and @xmath6 is the radius of the @xmath7th child ( distal ) segment .",
    "another classical approach for the cardiovascular system is to minimize wave reflections in pulsatile flow , as womersley and west et al .",
    "have done@xcite .",
    "this approach leads to area - preserving branching ( or da vinci s rule ) , so that the sum of the cross - sectional areas ( @xmath8 ) of child vessels equals the cross - sectional area of a parent vessel at a branching junction . in the wbe model",
    ", reflections dominate for large vessels while dissipation dominates for small vessels ( @xmath0 1 mm ) .",
    "moreover , in the wbe model , a volume - servicing argument@xcite is used to derive an analogous relationship for vessel lengths , @xmath9 , while huo and kassab assume the same relationship but allow the exponent to vary from length - preserving ( exponent of 1 ) to volume - servicing ( exponent of 3 ) .",
    "optimization has been a common approach to developing vascular models throughout the past century , but it has been highly debated as to which properties are optimized and what are the tradeoffs among them@xcite .",
    "for instance , banavar et al.@xcite optimize for efficient transport within three - dimensional bodies and dodds@xcite minimizes network volume as required to continually supply metabolites within a body .",
    "indeed , different principles and assumptions lead to a variety of relationships between the flow rate and vessel radius .",
    "consequently , we express a generalized form of murray s law    @xmath10    in which we define the vascular scaling exponent , @xmath11 , for vessel radius to be consistent with the notation of price et al.@xcite .",
    "the analogous generalization for vessel length is @xmath12    where @xmath13 is the vascular scaling exponent for vessel length .    to ease computation",
    ", many models further assume that vascular networks are strictly self - similar and symmetrically branching  child vessels all have identical properties within a branching level .",
    "in this case , scale factors and associated scaling exponents can be defined for each branching level , @xmath14 , which represents the number of branching junctions from the heart to that vessel . following the notation of the wbe model ,",
    "the scale factors are @xmath15 and @xmath16 . for dichotomous branching",
    ", we can solve for @xmath17 and @xmath18 using eqs  [ eq : murray_gen ] and [ eq : volserv_gen ] , to find @xmath19    furthermore , for these idealized networks , the frequency distributions of radius and length follow power laws with scaling exponents @xmath20 and @xmath21 . because there are @xmath22 vessels of radius @xmath23 ,",
    "eqs  [ eq : bgqs ] give the two power - law relationships @xmath24 similarly , for any vessel , its radius and length are related to the number of downstream endpoints ( e.g. capillaries ) , @xmath25 , by @xmath26    eqs  [ eq : murray_gen]-[eq : regres ] constitute four methods of calculating vascular scaling exponents .",
    "each method relies on different types and levels of information .",
    "first , for each branching junction , the generalizations of murray s law ( eq  [ eq : murray_gen ] ) and volume servicing ( eq  [ eq : volserv_gen ] ) can be numerically solved for the exponents @xmath11 and @xmath13 by newton s method .",
    "the solution provides a direct local measurement of the scaling exponents at every junction that we call _ conservation - based _ scaling exponents .",
    "the value is undefined if a child vessel has radius or length greater than its parent .",
    "second , for each parent - child pair of vessel segments , the ratio of vessel radius and length can be calculated . by eq",
    "[ eq : bgqs ] , these scale factors can be used to compute a second local measure  our _ ratio - based _ scaling exponents .",
    "third , across all vessels and junctions , empirical distributions of radii and lengths can be fitted to power laws to produce what we term the _ distribution - based _ scaling exponents , as in eq  [ eq : powlaw ] .",
    "fourth , across all vessel segments , log - log regressions of radii and lengths versus the number of downstream endpoints can be performed to derive _ regression - based _ scaling exponents , following eq  [ eq : regres ] .",
    "these latter two methods each provide single values for the vascular scaling exponents , @xmath11 and @xmath13 , across the whole network , and they do not rely on information about the geometry of individual branching junctions .    in the literature ,",
    "these four methods for measuring scaling exponents are often used interchangeably@xcite . however ,",
    "these are only proven to be identical for symmetrically - branching , strictly self - similar networks .",
    "furthermore , it is unknown whether measurements of vascular scaling exponents using these four methods ( eqs  [ eq : murray_gen]-[eq : regres ] ) will produce values that are approximately similar or significantly different . if they differ , this raises questions about which of these four measures of vascular scaling exponents , if any , best corresponds to the scaling relationships predicted by ideal networks or observed empirically for metabolic and growth rates .",
    "to begin to answer these questions , we now report results obtained by applying our new software , angicart , to 20 contrast - enhanced 3d magnetic resonance image volumes for human head and torso .",
    "we collected 3015 segments across 1473 branching junctions .",
    "of the junctions , 1422 were recorded as dichotomous and 51 as trichotomous . the number of branches on all paths ( subjects pooled ) between the aorta and the smallest observable vessels was typically between 3 and 10 ( middle 68% ) .",
    "each 3d image volume , corresponding to 151 segments on average , took about 2.7 minutes of cpu time on a single 2.3ghz intel processor .",
    "as described in the methods , we used an automated circularity criterion as an indicator of possible errors in order to omit vessel identification errors .",
    "our results are based on radius , length , and volume measurements from only the 1240 segments for which we saw no indication of potential error .",
    "the complete , raw output of our software before any filtering or analysis is available as .",
    "the software source code and original imagery enabling the exact reproduction of this dataset are available online as a repository in the git revision control system at ` https://github.com/mnewberry/angicart ` .",
    "we attempt to solve eq  [ eq : murray_gen ] numerically at each branching junction .",
    "we label the parent at each branching junction by traversing the vascular network starting at the vessel segment of greatest radius , which we assume is a segment in the aorta .",
    "if all children are smaller than the parent , the equation is guaranteed to have exactly one solution , and numerical convergence to the solution is fast . otherwise , the equation may have zero , one , or two solutions",
    ". such cases may represent real anatomical variation , or misidentification of the parent vessel due to errors or ambiguous topology such as the circle of willis .",
    "we consider only the simplest case , in which children are smaller than their parent , because otherwise the solutions are difficult to interpret in the context of existing vascular network models .",
    "all child radii are smaller than the parent in 82% ( 222 ) of junctions , and all child lengths are smaller in only 35% ( 94 ) of junctions .",
    "we show distributions of these measures of the vascular scaling exponents , @xmath11 and @xmath13 , across branching junctions in fig  [ fig : qdist ] .",
    "the arithmetic mean and associated 95% confidence intervals for these conservation - based measurements of @xmath11 and @xmath13 are presented in table  [ tab : all ] .",
    "l c c c c c c * radius exponent measures * & @xmath27 & @xmath11 & 95% ci & @xmath28 & @xmath29 + conservation ( node ) & 222 & 0.49 & @xmath30 0.03 & 0.23 &",
    " + ratio ( node ) & 703 & 0.43 & @xmath30 0.03 & 0.39 &  + distribution ( network ) & 657 & 0.30 & @xmath30 0.04 &  & 0.90 + regression ( network ) & 1240 & 0.41 & @xmath30 0.02 &  & 0.66 + * theory * & & & & & + wbe small vessels &  & 0.33 &  & & + wbe large vessels &  & 0.50 &  & & + banavar et al.@xcite &  & 0.50 &  & & + huo and kassab@xcite &  & 0.330.50 &  & & + murray s law &  & 0.33 &  & & +   + * length exponent measures * & @xmath27 & @xmath13 & 95% ci & @xmath28 & @xmath29 + conservation ( node ) & 94 & 1.40 & @xmath30 0.20 & 0.98 &  + ratio ( node ) & 703 & 0.17 & @xmath30 0.12 & 1.57 &  + distribution ( network ) & 518 & 0.73 & @xmath30 0.10 &  & 0.68 + regression ( network ) & 1240 & 0.94 & @xmath30 0.05 &  & 0.19 + * theory * & & & & & + wbe all vessels & ",
    "& 0.33 &  & & + banavar et al.@xcite &  & 0.50 &  & & + huo and kassab@xcite &  & 0.331.00 &  & & +     for vessel radius from solutions to eq .",
    "( [ eq : murray_gen ] ) using empirical measurements of vessel radii extracted from magnetic resonance angiography using our software , and ( b ) the analogous frequency distribution of vascular scaling exponent @xmath13 for vessel segment length . ]",
    "topological information allows us to compute @xmath17 and @xmath18 directly for each parent - child pair of vessel segments .",
    "our dataset contains 703 pairs of parent and child segments with dichotomous branching",
    ". a small proportion of the @xmath17 and @xmath18 values may be over - estimated due to misidentification of the parent - child relationship ( see methods ) .",
    "this bias would produce underestimates in @xmath11 and @xmath13 , but because misidentification is very infrequent , the magnitude of this bias is expected to be within the measurement error . the distribution of @xmath17 and @xmath18 is displayed in fig  [ fig : betadist ] , and the arithmetic mean and associated 95% confidence intervals of the ratio - based vascular scaling exponents calculated using eq .",
    "( [ eq : bgqs ] ) are shown in table  [ tab : all ] .    , the ratio of child to parent radii , and ( b ) the analogous distribution of scale factor @xmath18 , the ratio of child to parent lengths . ]      for symmetrically branching , self - similar networks , the frequency of radius and length measurements follow power - law distributions .",
    "we did a linear fit to the log - log transformed histograms of radius and length measurements ( the log of eq .",
    "( [ eq : powlaw ] ) ) using sma regression .",
    "we derived empirical 95% confidence intervals by resampling with different bin sizes and cutoff values for the tail ( see ) .",
    "the fits are shown in fig  [ fig : rdist ] .",
    "the scaling exponents obtained from our fits are given in table  [ tab : all ] .    , and ( b ) the log of length , @xmath31 .",
    "fit lines and slope values are shown .",
    "the correlation coefficient @xmath32 for the log relative frequency versus the logs of radius and length respectively are 0.90 and 0.68 . ]      by taking the logarithm of eq .",
    "( [ eq : regres ] ) , we can estimate the vascular scaling exponents , @xmath11 and @xmath13 , by performing regressions of the logarithm of the number of downstream tips @xmath33 against the logarithm of radius , @xmath34 , and the logarithm of length , @xmath31 , respectively @xcite .",
    "regression lines are shown in fig  [ fig : betanreg ] . the measured slopes , which are the estimates of the vascular scaling exponents , and associated 95% ci are shown in table  [ tab : all ] .    , and ( b ) the log of length , @xmath31 , against the log of the number of downstream tips , @xmath33 .",
    "fit lines and slope values are shown .",
    "correlation coefficients @xmath32 are 0.66 and 0.19 , respectively ( @xmath35 for each ) . ]      as in all analyses based on experimental data , measurement errors affect uncertainties in quantities calculated from the raw data .",
    "consequently , we investigate the sensitivity of our calculated scaling exponents and entire analysis to the choice of threshold intensity in our algorithm as well as to gaussian noise in the image quality .",
    "an intensity threshold is used in our algorithm to select the voxels from the image that describe the shape of the vessel lumen .",
    "lower thresholds reveal more vessels , so for our analysis above , we used the minimum threshold that produced reliable segments , as described in and . because the threshold affects the boundaries of the vessel lumen , the vessel radius also depends on the threshold . for each image",
    "there is a minimum acceptable threshold that we used above , and for our sensitivity analysis , we also chose a maximum threshold to be the largest value for which at least 30 vessel segments are visible .",
    "for our plots in fig  [ fig : thresh_sens ] , we normalized the threshold to range from 0 and 1 .",
    "that is , 0 is the threshold used for the results above , and 1 is the maximum threshold for which at least 30 vessel segments are visible .",
    "for each normalized threshold increment of 0.05 between 0.00 and 1.00 , we ran our entire analysis and calculated the four scaling exponents for radius and length ( fig  [ fig : thresh_sens ] ) .",
    "the values of the scaling exponents at a normalized threshold of 0.00 recapitulate table  [ tab : all ] .",
    "our results remain qualitatively similar as we increase the threshold and include fewer segments",
    ". however , at higher normalized thresholds , we can no longer resolve differences between some exponents that are resolvable at normalized threshold 0.00 , as expected from the law of large numbers .",
    "column of table  [ tab : all ] .",
    "the top right panel shows the number of vessel segments used to calculate the four scaling exponents for vessel length versus the normalized threshold value , as in the @xmath27 column of table  [ tab : all ] . for both of these top two panels ,",
    "the number of data points decreases with threshold value as it must .",
    "the bottom left panel depicts how the four calculated scaling exponents for vessel radius vary with normalized threshold value .",
    "the bottom right panel depicts how the four calculated scaling exponents for vessel length vary with normalized threshold value .",
    "horizontal lines indicate points of comparison to theory as described in table  [ tab : all ] . ]",
    "noise in images may also cause errors in the identification of vessels or in estimates of the radius or length of vessels .",
    "we conducted a sensitivity analysis similar to the above by adding gaussian noise that varied in magnitude from 0.47 ( the measured baseline level of noise in the foreground of one image ) to 4.7% ( 10 times the baseline noise level ) of the maximum voxel intensity .",
    "results ( ) show no significant changes in our results with higher levels of noise .    as another measure of uncertainty , we located vessels with radius estimates that differed with threshold despite high reliability in vessel identification ( vessel endpoints were similar across at least 5 threshold values ) .",
    "we located 12 vessel segments from 9 different patients that matched this criterion . across these 12 vessels ,",
    "the mean radius estimate varied from 0.9 to 6.7 mm , but the coefficient of variation ( = standard deviation / mean across thresholds ) ranged only from 0.02 to 0.08 .",
    "moreover , the coefficient of variation was uncorrelated with radius ( pearson correlation = 0.07 ) , suggesting that individual vessel radius measurements are precise to roughly @xmath36 ( 2 times the coefficient of variation ) regardless of vessel size . for a specific threshold ,",
    "we calculate how the measured vessel radius differs from the mean of the vessel radius across all thresholds . at each threshold , this difference tended to be in the same direction ( mostly positive or mostly negative ) across the 12 vessels we measured .",
    "moreover , the magnitude of the difference was proportional to vessel radius ( most @xmath37 ) .",
    "consequently , the ratio of vessel radii at any specific threshold is roughly equal to the ratio of the means of the vessel radii across thresholds and also equal to the ratio of vessel radii at any other specific threshold .",
    "that is , within the plausible range of thresholds that we explore here , the calculated scaling ratios are largely independent of the choice of threshold value , implying that the choice of threshold does not create any bias in the calculated scaling exponents or ratios .    of course , our sensitivity analysis can not exclude all possible sources of error or bias . in the methods sections ,",
    "we discuss how our results might be affected by other possible sources of error , such as tree topology identification , the patient population , small vessel censoring , vessel lumen misidentification , skeleton line selection , centerline quantization , and vessel segment misattribution .",
    "the positional accuracy of mri is high , so errors arise due to classification or interpretation of voxels . because the threshold parameter and noise in the image primarily control how we classify voxels",
    " the first step of analysis  these are the major determinants of subsequent errors . in our analysis , as presented in figs  [ fig : thresh_sens ] and , no systematic biases are observable , so we conclude that our results are highly robust to the largest and most notable sources of uncertainty .",
    "the estimated values of vascular scaling exponents obtained using our four different methods are all presented in table  [ tab : all ] .",
    "all pairs of measures are statistically significantly different ( welch s t - test , @xmath35 ) except for the ratio - based and regression - based @xmath11 ( @xmath38 ) .",
    "values of @xmath11 based on conservation rules at branching junctions , scale factors for parent - child pairs , and regression of @xmath34 versus @xmath39 are all between @xmath40 ( the wbe prediction for large vessels ) and @xmath41 ( murray s law , the banavar et al .",
    "prediction@xcite , and the wbe prediction for small vessels ) , and the remaining distribution - based @xmath11 includes @xmath42 in its 95% ci .",
    "the conservation - based exponent @xmath11 is not statistically - significantly different from @xmath40 .",
    "different measures for @xmath13 range from @xmath43 to @xmath44 and all are statistically significantly different ( @xmath35 ) from each other and from the volume - servicing and area - servicing values of @xmath45 and @xmath46 respectively .",
    "it is notable , however , that the difference between regression - based and distribution - based measurements of @xmath13 is no longer resolvable at normalized thresholds higher than 0 .",
    "the distribution - based and regression - based exponents lie between area - servicing and length - preserving .",
    "these discrepancies between measures suggest that vessel segment lengths are poorly modeled by strictly self - similar and symmetrically branching networks .",
    "our software acquired direct measurements of a large number of connected vessel segments from _ in vivo _ angiography .",
    "we calculated vascular scaling exponents in these data using four methods to directly compare values from real vascular networks with each other and with theoretical values from the wbe model , murray s law , banavar et al.@xcite , and huo and kassab@xcite .",
    "intriguingly , our results lead to contrasting conclusions for the changes in vessel radius and length across scale .    for the vascular scaling exponent @xmath11 that quantifies changes in the radius ,",
    "the conservation - based and ratio - based estimates are closer to @xmath47 than @xmath42 .",
    "these estimates support work on large vessels by west et al . , zamir and banavar@xcite , in contrast to murray s law , which does not distinguish large and small vessels . west",
    "et al . derive that the dominant source of power loss for large vessels ( estimated to be @xmath48 1 mm ) is the reflection of pressure waves at branching junctions , while for small vessels , power loss is dominated by viscous dissipation between blood and the vessel walls . because of the resolution of our mri volumes , we are able to extract data mostly for vessels with a radius greater than 1 mm , corresponding to the large vessel regime in the wbe model .",
    "consequently , our results for the scaling of radii are supportive of the area - preserving branching of large vessels , corroborate recent findings for plants@xcite , and reject the possibility that murray s law might apply , either generally or on average , to junctions of large vessels .",
    "this result demonstrates that minimizing energy - dissipation due to blood flow does not capture the guiding principles that shape the vascular system across all scales .",
    "future studies using higher resolution angiography ( e.g. , micro - ct ) to obtain data for small vessels are needed to test murray s law and the wbe prediction for small vessels and to determine if minimizing energy dissipation is a relevant principle at any scale .    for the vascular scaling exponent , @xmath13 , for vessel lengths , the discrepancies between predicted and estimated values are more difficult to reconcile and interpret .",
    "none of the four measures of @xmath13 agree with each other or provide support for volume- or area - servicing branching , while only the regression - based method provides support for length preservation . within the wbe model , @xmath13 is predicted to be @xmath49 based on an argument that the vascular network must be volume - servicing for the entire body@xcite .",
    "this volume - servicing argument has been questioned on theoretical grounds@xcite , and here we provide empirical evidence that volume - servicing or any other conservation law for length does not hold locally at branching junctions . indeed , for the conservation - based exponents , 65% of branching junctions violate the model so severely that exponent values are undefined .",
    "the volume - servicing argument is supposed to apply across at least the vast majority of scales and is a key element of the wbe explanation for the @xmath50 allometric scaling relationship between metabolic rate and body size .",
    "the breakdown between this argument and the real vascular networks we measured may occur because , contrary to the wbe argument , the length of a vessel segment is not a reliable indicator of the volume it services .",
    "the correlations between length and number of downstream endpoints , a proxy for volume serviced , is very low compared to the same correlation for radius ( 0.2 versus 0.7 ) .",
    "considering only the largest vessels , this is not surprising .",
    "the ascending aorta is only a few centimeters in length and services most of the body , while the carotid artery is much longer ( at least 10 cm in length ) and services only half the head .",
    "our results imply that either modification of the volume - servicing argument is needed or some new principle yet to be discovered guides the distribution of vessel lengths as the vascular network branches throughout the body .",
    "these new developments could lead to corrections to the power - law predictions of the original wbe theory that may agree better with recent findings of `` curvature '' in the allometric relationship@xcite .    beyond the differences discussed thus far ,",
    "vessel lengths and radii also differ in their distributions for vascular scaling exponents and scale factors .",
    "measurements of @xmath11 and @xmath17 exhibit a strong central tendency ( figs  [ fig : qdist ] and [ fig : betadist ] ) , while the scale factor for length , @xmath18 , has a highly skewed distribution with typical values that are not well - described by the mean .",
    "thus , a derivation implicitly based on a mean - value approximation may be successful for predicting vessel radii but fail to predict scaling relationships involving vessel lengths .",
    "thus , while hierarchical symmetric models may fail outright to adequately describe vessel lengths , the discrepancies between vessel radii in real networks and idealized models , such as the wbe model , may only result in minor corrections to model predictions .",
    "this may help explain the success of the wbe model in predicting a wide range of phenomena .",
    "differences in results for vessel radius and length could be tied to different strengths of the constraints on vessel geometry .",
    "radii and length distributions have previously been observed to differ in the external branching of plants and leaves@xcite .",
    "one explanation for this is that viscous power loss depends much more sensitively on vessel radius ( as a @xmath51th power , @xmath52 ) than on vessel length ( linearly , @xmath53 ) .",
    "thus , the strength of selection for optimal vessel radius is much stronger than for optimal vessel length , implying evolution has more often sacrificed vessel length when negotiating tradeoffs in anatomy .",
    "another potential explanation is that vessel radii are self - similar due to a local constraint at each branching junction , whereas vessel lengths may be constrained only at larger scales  organs and organisms  that more accurately capture how the vascular network needs to span and feed a spatially inhomogeneous body .",
    "disagreement about the value of the length scaling exponent between our four methods indicates that assumptions of the simplest model must be violated so strongly as not to hold even approximately .",
    "that is , strict self similarity , symmetric branching or both must be strongly violated for the real vascular networks we measured .",
    "our data reveal pervasive asymmetry in both radius and length between child vessels .",
    "how far the results for symmetric networks generalize to asymmetric networks has been explored very little@xcite .",
    "the differences we observe between different measures of vascular scaling exponents could be explained by the inability of existing theories to account for the asymmetry of real vascular networks . developing a theory to account for asymmetric branching",
    "may be challenging .",
    "for instance , accounting for asymmetry would require at least two scale factors for radii ( e.g. , @xmath54 and @xmath55 ) and two for lengths ( e.g. , @xmath56 and @xmath57 ) .",
    "these additional scale factors and associated scaling exponents would necessarily change our analysis and our estimates for the ratio - based scaling exponent , and would potentially change our interpretation of the distributions of @xmath17 and @xmath18 .",
    "rather than thinking of distributions of @xmath17 and @xmath18 , we would think of joint distributions of @xmath54 and @xmath55 , for example . for similar reasons ,",
    "our interpretation and analysis of the frequency distribution of radius and length could be altered , thus affecting the estimates of the distribution - based exponents as well .",
    "angicart outputs @xmath17 and @xmath18 values for each vessel pair , and can provide the detailed information required for future studies of multiple scale factors for length or radius and asymmetric branching .",
    "all of the models discussed in this paper ignore any reticulation or loops in the vessel topology , in contrast to recent work on leaf venation networks@xcite .",
    "our analysis also follows this assumption .",
    "however , loops are known to occur anatomically in healthy ( circle of willis ) and diseased ( tumors , arteriovenous malformations ) tissue .",
    "extensions to our software and to theory could address this issue .",
    "such an extension could be used to investigate abnormal tumor vasculature@xcite , or allow new theory to be developed to explain the normal anatomical function of reticulation .",
    "there are also other spatial aspects that have received theoretical attention , such as branching angle , that our software is already capable of recording .",
    "many more tests could be performed with data on microvasculature .",
    "for instance , huo and kassab@xcite have published scaling relationships for how crown volume and length change with stem radius .",
    "testing these requires knowledge of the full crown , down to the microvasculature .",
    "similarly , dodds@xcite makes predictions for virtual vessels that coincide with real vessels only at the smallest scales .",
    "we developed new software and applied it to mri of human head and torso to obtain one of the most detailed datasets for examining branching architecture in vascular networks .",
    "in addition , we conducted a comprehensive data analysis that uses both local and global methods to measure scaling exponents .",
    "together , this new software , data , and analysis provides valuable information for answering fundamental questions about vascular system morphology .",
    "the public release of our imaging software , angicart , should enable researchers to ground future vascular network theories in empirical data .",
    "the software facilitates comparison across spatial scales and between studies by operating uniformly on all tomographic imaging methods .",
    "because imaging can be done non - invasively , our method affords the opportunity to record all spatial information of _ in vivo _ vasculature through time or across development .",
    "we explain four different methods to estimate vascular scaling exponents from spatially - explicit data .",
    "although researchers use and sometimes interchange these four methods , we found that all four methods can lead to different results , and that for scaling exponents for vessel lengths , these differences can be dramatic .",
    "this result is in stark contrast to theoretical calculations for idealized , symmetric networks that predict all methods will give identical values .",
    "we advise caution when interpreting different methods and estimates as the same scaling exponent because this could lead to misperceptions and disagreements among studies .",
    "for instance , regression - based estimates are the most common across levels of biological organization while distribution - based estimates are used for forests@xcite , so comparing these estimates to each other must be done with care .",
    "the differences we observe call for a new understanding of the relationships between the local geometry of vessels and the global properties of vascular systems .",
    "new theory should be developed to accommodate the anatomical variation and asymmetric branching we observe in real networks .",
    "after local institutional review board approval and written informed consent had been obtained , 20 consecutive adult patients with clinically suspected supraaortic arterial occlusive disease were prospectively enrolled to evaluate new mri methods for the study of carotid atherosclerosis@xcite .",
    "although other data was recorded in that study , we use only the images . in that study",
    "less than 0.5% of observed vessel segments had notable luminal narrowing , so we conclude patient selection and enrollment did not affect our results .",
    "we acquired contrast - enhanced magnetic resonance angiograms ( cemra ) of the upper torso , neck , and head in the 20 human subjects ( n=20 ) using a 3 tesla siemens trio scanner ( siemens medical solutions , erlangen , germany ) .",
    "the data acquisition details have been previously described@xcite . in brief , the cemra images were acquired after an antecubittal vein injection of gadolinium based contrast agent ( gd - dtpa , magnevist , bayer shering pharma ag , berlin , germany ) .",
    "the image volumes have dimensions that are typically close to @xmath58 voxels , with each voxel nearly isotropic and between @xmath59 m and @xmath60 m. the resolution and imaged volume are typical of high - quality 3 t mri . the point - spread - function for mri",
    "is known to be precise and equivalent to the programmed pixel size@xcite . in practice",
    ", the geometric accuracy is known to be sub - millimeter@xcite .",
    "the vessel networks in each image are clearly visible due to the sharp image contrast provided by the presence of the contrast agent , which makes the blood appear bright relative to dark non - blood tissues .",
    "we averaged each @xmath61-voxel cube of adjacent voxels into a single 1.4 - 1.8 mm voxel to remove noise , reduce processing time , and match conventionally - acquired resolutions .",
    "this reduced noise - induced errors without substantially changing the number of vessel segments represented . in two of our 20 image volumes ,",
    "segmentation failed because bright , non - blood tissues were present very close to the blood volume , so that no threshold value excluded all non - blood objects as described in .",
    "we did not record any vessel segments from these image volumes .",
    "we saw no relationship between failure of segmentation and vascular system geometry .",
    "we created a free , open source software package  angicart  to read tomographic images of vascular networks , to automatically decompose a vessel lumen into vessel segments , and to measure the geometry and topology of the segments ( fig  [ fig : overview ] ) .",
    "the software and data used in this study are available on the internet ( ` https://github.com/mnewberry/angicart/ ` ) under a gnu public license .",
    "our software starts by classifying voxels in a 3d image as part of the vessel lumen if they are within the largest connected group of voxels that exceed an intensity threshold@xcite , as with other level set or thresholding methods .",
    "we use a manual binary search to select the threshold value that best matched visual identification of vessels .",
    "the result is a 3d binary image , called the _",
    "network mask_. next , we use spatial criteria to find the endpoints of the vessel network , where the vessels become too small to detect . given these endpoints , we find the centerline and branch points of vessels by skeletonization@xcite ( see ) .",
    "we implement skeletonization using an erosion technique  successively removing voxels until no more are removable without disconnecting the endpoints in the mask@xcite .",
    "the voxels that remain after erosion lie within approximately 1 voxel - width of the true centerline .",
    "this information allows us to partition the network mask into segments by attributing each voxel to the segment whose centerline is closest to it .",
    "we record how vessels are connected and measure the length of each segment s centerline and the volume of each segment . following a geometric argument",
    "( see ) , quantization error leads us to overestimate length .",
    "we compute radius as @xmath62 .",
    "radii are therefore underestimated on average due to the quantization error in length measurements .",
    "this bias affects the accuracy of individual length and radius measurements , but does not bias estimates of scaling exponents ( relative measures ) as long as the percent error does not change systematically with vessel size , which it does not . as a final filter of possibly misclassified vessels , we omit vessels in which more than 20% of the voxels lie further than @xmath63 from the centerline , or whose total volume is less than 4 voxels .",
    "further details of each step are presented in the .",
    "we determined the conservation - based node scaling exponents by solving eq .",
    "( [ eq : murray_gen ] ) numerically using newton s method implemented in ocaml@xcite and iterated until the sum of powers was within 0.00001 of 1 .",
    "we estimated the regression - based scaling exponents using standard major axis ( sma ) regression of the natural log of radius ( length ) against the natural log of the number of downstream endpoints@xcite .",
    "we used sma regression because the variability and uncertainty in the y - axis ( vessel radius or length ) is as large as the variability and uncertainty in the x - axis ( number of downstream endpoints ) .",
    "furthermore , sma is appropriate because our goal is to obtain the best estimate of the scaling exponents ( slopes ) and not the best prediction of @xmath64 given @xmath65 .",
    "we estimated distribution - based scaling exponents by fitting the tail of the probability distribution of radius and length to a power law .",
    "that is , we binned log - transformed data and determined the slope of the log of probability density versus the log of radius and length using sma regression@xcite .",
    "we used 20 bins and discarded 5 and 7 initial bins of radius and length respectively .",
    "blood vessels near the resolution limit of mri may not be visible .",
    "although dimensions measured from observed small vessels are used in our other methods , counts of small vessels are unreliable due to censoring .",
    "thus , we discarded initial bins in order to exclude vessel sizes where non - uniform censoring of values might occur .",
    "we computed standard errors by varying bin size and the number of initial bins discarded ( up to @xmath66 each ) and using the middle 95th percentile of these values . by binning our data and fitting the power law using sma regression ,",
    "we avoid problems that can arise when using maximum - likelihood estimators to fit our power - law distributions .",
    "specifically , the maximum - likelihood estimators are derived with specific assumptions and support choices such as smooth and continuous or discrete and integer , as in clauset et al.@xcite .",
    "in contrast , our distributions may be somewhere in between : continuous with an increased likelihood to take values near certain points , such as powers of @xmath17 times the aorta radius .",
    "our sma regression on bins of simulated vessel data produced stable estimates with relatively little bias in comparison to fits based on published maximum - likelihood estimators .",
    "we thank j. paul finn and derek lohan for providing the mri image data used in this study . we thank elizabeth sweedyk , robert zinkov and thomas bushnell , bsg for helpful discussions of the algorithms , datastructures and programming of angicart .",
    "we thank joshua plotkin and david mccandlish for helpful conversations .",
    "we are grateful to cormac mccarthy for comments on the manuscript .    10    price ca , enquist bj , savage vm . a general model for allometric covariation in botanical form and function .",
    "proc natl acad sci u s a. 2007;104(32):13204 .",
    "latty t , ramsch k , ito k , nakagaki t , sumpter dj , middendorf m , et  al . structure and formation of ant transportation networks .",
    "journal of the royal society interface .",
    "2011;8(62):12981306 .",
    "jun j , pepper jw , savage vm , gillooly jf , brown jh .",
    "allometric scaling of ant foraging trail networks . evolutionary ecology research .",
    "2003;5(2):297303 .",
    "west gb , brown jh , enquist bj . .",
    "1997;276(5309):122 .    murray cd .",
    "proc natl acad sci u s a. 1926;12(3):207 .",
    "womersley jr .",
    "method for the calculation of velocity , rate of flow and viscous drag in arteries when the pressure gradient is known . the journal of physiology .",
    "1955;127(3):553563 .",
    "thompson daw . .",
    "cambridge press , cambridge ; 1917 .",
    "savage vm , deeds ej , fontana w. .",
    "plos comput biol .",
    "2008;4(9 ) .",
    "jain rk . .",
    "2005;307(5706):58 .",
    "herman ab , savage vm , west gb . a quantitative theory of solid tumor growth , metabolic rate and vascularization .",
    "plos one . 2011;6(9):e22973",
    ".    savage vm , herman ab , west gb , leu k. using fractal geometry and universal growth curves as diagnostics for comparing tumor vasculature and metabolic rate with healthy tissue and for predicting responses to drug therapies . discrete and continuous dynamical systems - series b. 2013;18(4):10771108 .",
    "womersley j. oscillatory flow in arteries : effect of radial variation in viscosity on rate of flow .",
    "the journal of physiology .",
    "1955;127(2):38 .",
    "banavar jr , maritan a , rinaldo a. .",
    "1999;399(6732):130131 .",
    "banavar jr , cooke tj , rinaldo a , maritan a. form , function , and evolution of living organisms .",
    "proc natl acad sci u s a. 2014;p .",
    "201401336 .",
    "optimal form of branching supply and collection networks .",
    "phys rev lett .",
    "2010 jan;104:048702 .",
    "huo y , kassab gs .",
    "intraspecific scaling laws of vascular trees .",
    "journal of the royal society interface .",
    "2012;9(66):190200 .",
    "savage v , bentley l , enquist b , sperry j , smith d , reich p , et  al . hydraulic trade - offs and",
    "space filling enable better predictions of vascular structure and function in plants .",
    "proc natl acad sci u s a.2010;107(52):2272222727 .",
    "brown jh , gillooly jf , allen ap , savage vm , west gb . toward a metabolic theory of ecology .",
    ". 2004;85(7):17711789 .",
    "kolokotrones t , savage vm , deeds ej , fontana w. .",
    "2010;464(7289):753756 .",
    "sperry js , smith dd , savage vm , enquist bj , mcculloh ka , reich pb , et  al . a species - level model for metabolic scaling in trees i. exploring boundaries",
    "to scaling space within and across species . functional ecology .",
    "2012;26(5):10541065 .",
    "allmen ei , sperry js , smith dd , savage vm , enquist bj , reich pb , et  al . a species - level model for metabolic scaling of trees ii .",
    "testing in a ring - and diffuse - porous species . functional ecology .",
    "2012;26(5):10661076 .    mandelbrot bb .",
    "fractals : form , chance , and dimension .",
    "wh freeman san francisco ; 1977 .",
    "zamir m. on fractal properties of arterial trees .",
    "journal of theoretical biology .",
    "1999;197(4):517526 .",
    "schroeder mr .",
    "fractals , chaos , power laws : minutes from an infinite paradise . courier dover publications ; 2012 .",
    "how long is the coast of britain ?",
    "statistical self - similarity and fractional dimension . science .",
    "1967;156(3775):636 .",
    "zamir m. the physics of coronary blood flow .",
    "springer verlag ; 2005 .",
    "dodds ps , rothman dh , weitz js .",
    "re - examination of the `` 3/4-law '' of metabolism .",
    "journal of theoretical biology .",
    "2001;209(1):927 .",
    "kozowski j , konarzewski m. is west , brown and enquist s model of allometric scaling mathematically correct and biologically relevant ? functional ecology .",
    "2004;18(2):283289 .",
    "price ca , weitz js , savage vm , stegen j , clarke a , coomes da , et  al .",
    "testing the metabolic theory of ecology .",
    "ecology letters .",
    "2012;15(12):14651474 .",
    "price ca , symonova o , mileyko y , hilley t , weitz js .",
    "leaf extraction and analysis framework graphical user interface : segmenting and analyzing the structure of leaf veins and areoles . plant physiology .",
    "2011;155(1):236 .",
    "mckown ad , cochard h , sack l. decoding leaf hydraulics with a spatially explicit model : principles of venation architecture and implications for its evolution . the american naturalist .",
    "2010;175(4):447460 .",
    "biomechanics : circulation .",
    "springer ; 1997 .",
    "huang w , yen r , mclaurine m , bledsoe g. . journal of applied physiology .",
    "1996;81(5):2123 .",
    "kaimovitz b , huo y , lanir y , kassab gs . .",
    "american journal of physiology - heart and circulatory physiology .",
    "2008;294(2):h714 .",
    "kassab gs , rider ca , tang nj , fung yc . .",
    "american journal of physiology - heart and circulatory physiology .",
    "1993;265(1):h350 .",
    "zamir m , wrigley s , langille b. the journal of general physiology .",
    "1983;81(3):325 .",
    "apol mef , etienne rs , olff h. revisiting the evolutionary origin of allometric metabolic scaling in biology .",
    "functional ecology .",
    "2008;22(6):10701080 .",
    "sperry js , smith dd , savage vm , enquist bj , mcculloh ka , reich pb , et  al . a species - level model for metabolic scaling in trees i. exploring boundaries to scaling space within and across species . functional ecology .",
    "2012;26(5):10541065 .",
    "savage vm , bentley lp , enquist bj , sperry js , smith dd , reich pb , et  al . hydraulic trade - offs and",
    "space filling enable better predictions of vascular structure and function in plants .",
    "proc natl acad sci u s a. 2010;107(52):2272222727 .",
    "banavar jr , moses me , brown jh , damuth j , rinaldo a , sibly rm , et  al . a general basis for quarter - power scaling in animals .",
    "proc natl acad sci u s a. 2010;107(36):1581615820 .",
    "bentley lp , stegen jc , savage vm , smith dd , allmen ei , sperry js , et  al .",
    "an empirical assessment of tree branching networks and implications for plant allometric scaling models .",
    "ecology letters .",
    "2013;16(8):10691078 .",
    "west gb , enquist bj , brown jh . a general quantitative theory of forest structure and dynamics .",
    "proc natl acad sci u s a. 2009;106(17):70407045 .    zamir m. . in : scaling in biology .",
    "oxford university press , usa ; 2000 .",
    "p. 129143 .",
    "price ca , wing s , weitz js . scaling and structure of dicotyledonous leaf venation networks .",
    "ecology letters .",
    "2012;15(2):8795 .",
    "turcotte d , pelletier j , newman w. networks with side branching in biology .",
    "journal of theoretical biology .",
    "1998;193(4):577592 .",
    "mileyko y , edelsbrunner h , price ca , weitz js .",
    "hierarchical ordering of reticular networks .",
    "2012;7(6):e36715 .",
    "blonder b , violle c , bentley lp , enquist bj .",
    "venation networks and the origin of the leaf economics spectrum . ecology letters . 2011;14(2):91100 .",
    "katifori e , szllsi gj , magnasco mo .",
    "damage and fluctuations induce loops in optimal transport networks . physical review letters .",
    "2010;104(4):048704 .",
    "corson f. fluctuations and redundancy in optimal transport networks . physical review letters",
    ". 2010;104(4):048703 .",
    "lohan dg , barkhordarian f , saleh r , krishnam m , salamon n , ruehm sg , et  al .",
    "mr angiography at 3 t for assessment of the external carotid artery system .",
    "american journal of roentgenology .",
    "2007;189(5):1088 .",
    "liang zp , lauterbur pc .",
    "principles of magnetic resonance imaging .",
    "spie optical engineering press ; 2000 .",
    "scheib s , gianolini s , lomax n , mack a. high precision radiosurgery and technical standards . in : wowra b , editor .",
    "gamma knife radiosurgery .",
    "springer ; 2004 .",
    "p. 923 .",
    "tsai ps , kaufhold jp , blinder p , friedman b , drew pj , karten hj , et  al .",
    "correlations of neuronal and microvascular densities in murine cortex revealed by direct counting and colocalization of nuclei and vessels . the journal of neuroscience",
    ". 2009;29(46):14553 .",
    "kirbas c , quek f. .",
    "acm computing surveys . 2004;36(2):81121 .",
    "zhou y , toga aw .",
    "efficient skeletonization of volumetric objects . visualization and computer graphics ,",
    "ieee transactions on",
    ". 1999;5(3):196209 .    fisher rb , dawson - howe k , fitzgibbon a , robertson c , trucco e. dictionary of computer vision and image processing .",
    "wiley chichester ; 2005 .",
    "leroy x , doligez d , frisch a , garrigue j , rmy d , vouillon j. the ocaml system release 4.00 .",
    "2012;.    warton di , wright ij , falster ds , westoby m. bivariate line - fitting methods for allometry .",
    "biological reviews .",
    "2006;81(2):259291 .",
    "clauset a , shalizi cr , newman m. power - law distributions in empirical data .",
    "siam review .",
    "2009;51(4):661703 .",
    "aylward sr , bullitt e. . medical imaging ,",
    "ieee transactions on",
    ". 2002;21(2):6175 .",
    "jiang y , zhuang z , sinusas aj , papademetris x. . in : computer vision and pattern recognition workshops ( cvprw ) , 2010 ieee computer society conference on .",
    "ieee ; 2010 .",
    "p. 178185 .",
    "sniedovich m. dijkstra s algorithm revisited : the dynamic programming connexion . control and",
    "2006;35(3):599 .",
    "antiga l , steinman da .",
    "robust and objective decomposition and mapping of bifurcating vessels . medical imaging ,",
    "ieee transactions on",
    ". 2004;23(6):704713 .",
    "kline tl , zamir m , ritman el . .",
    "annals of biomedical engineering . 2010;p .",
    "the first step in our process is to obtain a binary mask ( or set of voxels ) that describes the shape of the blood vessel network . separating a structure of interest from the background",
    "is known in the computer vision literature as segmentation@xcite .",
    "the literature on image segmentation is voluminous and includes studies specifically examining segmentation of tomographic images of blood vessels .",
    "there are many approaches to segmentation of blood vessels , including region - growing , ridge - tracing , watershed models , spectral approaches , and deformable contours@xcite .",
    "we chose a threshold - based approach for its conceptual simplicity , estimability of errors , and lack of implicit assumptions about blood vessel geometry .",
    "there are more sophisticated approaches , but they rely on circularity@xcite , volume - servicing@xcite , or other assumptions to improve their visual quality .",
    "we avoid these assumptions as they might bias the output in favor of models our measurements are designed to test . by using simple thresholds rather than bayesian classification ,",
    "we remain agnostic to the image capture method by ignoring the physics of the imaging system .    to select a mask representing the blood vessel network , we calculated the set of voxels that passed an image - specific intensity threshold , then chose the largest connected group of such voxels . to identify the largest connected group , and at many other steps of the analysis",
    ", we consider a set of voxels as an adjacency graph . in an adjacency graph ,",
    "the nodes are the voxels , and the edges are connections between neighboring nodes .",
    "we considered two voxels to be connected if they were adjacent in any sense , that is , the voxels touch at at least one corner .",
    "the distance along the edge is the distance between the center points of neighboring voxels . in the language of graph theory ,",
    "the largest connected group of voxels that pass a given threshold is the largest connected component of the adjacency graph .",
    "a typical network mask is shown in panel 2 of fig .",
    "( [ fig : overview ] ) .",
    "we use only the largest connected component because smaller groups of voxels are either noise , patient motion artifacts , fatty tissue , or isolated vessels whose relationship to the rest of the network can not be determined . finding the largest connected component is the rate - limiting process at this stage , but its time is still @xmath67 for an @xmath27-voxel image .",
    "the threshold parameter affects how much of the network is visible .",
    "the value affects the volume measurement of each vessel segment to some degree , but the magnitude is expected to be small@xcite . at lower ( more permissive ) thresholds , more of the network is visible , but dimmer objects that are not blood are more likely to be part of the largest connected component .",
    "fortunately , these misidentified objects are readily identifiable to a human observer , allowing us to easily choose a threshold at which no such objects appear .",
    "the optimal threshold is the lowest threshold that does not misidentify any objects .",
    "we chose an optimal threshold for each image using a manual binary search .",
    "the skeletonization process removes voxels from the network mask until only those required for maintaining a single connected component remain . without some initial",
    "set of non - removable nodes , this process would remove all nodes .",
    "therefore , it is important to reliably determine a set of non - removable nodes  network endpoints that represent the most distal visible part of each vessel branch . given the network endpoints , skeletonization will reduce the network mask to centerlines , but skeletonization itself can not identify the endpoints , because they may be removed without disconnecting the graph .",
    "failure to identify endpoints before skeletonization results in the loss of vessel segments from detection ( see methods ) .",
    "we identify endpoints as the local maxima of a distance transform starting from an interior voxel .",
    "distance transforms are discussed in the next section .",
    "this transform assigns higher values to voxels that are more distal in the network , measured along the contours of vessels .",
    "voxels at a local maximum of distance are the network endpoints .",
    "we consider a local maximum any voxel whose distance value is greater than all of its neighbors . since this sometimes leads to multiple endpoints in a single terminal vessel , we collapse endpoints that are within the largest vessel radius ( 7 mm ) of one another and joined by a straight line through the network mask .",
    "we use skeletonization to identify vessel centerlines and branch points .",
    "a skeleton is an irreducible set of voxels that connect a set of endpoints .",
    "that is , the removal of any non - endpoint voxel in the skeleton breaks its adjacency graph into at least two connected components .",
    "thus , we compute our skeleton by recursively removing ( eroding ) voxels from the network mask , provided that they do not break the new mask into two components .",
    "there typically does not exist a unique skeleton for a given network mask and set of endpoints .",
    "we chose a particular skeleton in which the remaining voxels conform to the blood vessel centerlines by preferentially removing nodes from the outside ( surface ) of the mask first .",
    "to remove outermost voxels first , we use a distance transform to rank the voxels according to a measure of how close they are to the outside of the mask .",
    "we chose a measure that is lower for voxels closer to the exterior of the mask , and lower when a voxel has more neighboring voxels outside the mask . by removing voxels with more outside neighbors first",
    ", we remove voxels at convex points on the surface , smoothing the surface during erosion . a distance",
    "transform @xmath68 of a voxel @xmath69 has the property that @xmath70 where @xmath71 is the set of @xmath69 s 26 neighbors and @xmath72 is the euclidean distance from @xmath69 to a neighbor @xmath73 , which depends on whether the neighbors share one , two , or four corners ( ie , a face ) .",
    "this property is valid except when @xmath69 is the origin , or part of an initial boundary condition .",
    "given a value @xmath68 at any set of voxels , this property ( [ eq : dt ] ) can be used to extrapolate the distance transform to any connected set of voxels using a greedy algorithm .",
    "we use an analog of dijkstra s algorithm@xcite .",
    "we supply the values @xmath68 at points on the surface  the boundary condition .",
    "we choose the boundary to be the set @xmath74 such that @xmath75 of voxels with any neighbors outside the network mask @xmath76 , and define @xmath68 on the boundary to be @xmath77 this inverse sum of inverses assigns lower scores to voxels with more neighbors outside the network mask .",
    "erosion requires checking each voxel for whether its removal disconnects the remaining voxels .",
    "calculating the number of connected components of the remaining voxels is computationally expensive ( @xmath78 ) , making the erosion process notoriously slow@xcite .",
    "however , we greatly speed our algorithm by exploiting the fact that removal of a voxel can not disconnect the whole graph unless it disconnects its neighbors . checking the last condition is fast ( @xmath79 )",
    "a few passes of removing such voxels eliminate most of the voxels in the network , creating a close approximation to the skeleton . to erode the last few removable voxels",
    ", we use the whole - network algorithm , calculating connected components for each remaining voxel .",
    "this novel algorithm produces a skeleton in a small fraction of the time .    because the skeleton is not unique",
    ", different erosion algorithms result in different skeletons . for our 20 images ,",
    "our erosion leads to adequate representations of vessel centerlines .",
    "we expect any erosion algorithm that preferentially removes voxels roughly according to the above criteria to well - represent the centerlines and give similar results .",
    "using the skeleton , we can detect which voxels correspond to the branch points of the blood vessel network .",
    "the skeleton itself is a set of voxels , and hence its adjacency graph is not a tree because small cycles occur near branch points .",
    "thus , we first compute a minimal spanning tree of the skeleton . in this tree ,",
    "nodes with more than two neighbors exactly correspond to branch points , and nodes with only one neighbor are vessel endpoints .",
    "branch points and endpoints demarcate vessel segments .",
    "we consider the length of a vessel segment to be the distance along the tree between the segment s ends .",
    "this distance is the sum of distances between the centers of adjacent voxels , which are either @xmath80 , @xmath81 or @xmath82 times the voxel width .",
    "this path length along the voxel grid is greater than or equal to the euclidean distance between two points , and thus quantization of the vessel centerline will cause lengths to be overestimated in comparison to other studies which do not require vessel contours to conform to the grid@xcite .",
    "much as with the manhattan metric ( discrete @xmath83 norm ) , the ratio between the grid distance and euclidean distance is independent of the scale of the grid .",
    "that is , at any given orientation relative to the grid , the bias is a fixed ratio independent of line length .",
    "this error is correctable with smoothing , but because our use of length measurements is to determine scaling exponents ( relative measures ) , our results are not affected by biases that increase length of vessels by a constant factor .",
    "consequently , we choose to ignore biases of this type .    given the centerlines of vessel segments , we can attribute each voxel in the network mask to the vessel segment whose centerline lies closest to it . to accomplish this",
    ", we use dijkstra s algorithm to generate a shortest path tree in which any path along the center lines is zero distance . removing all branch points",
    "then breaks the shortest path tree into one connected component per vessel segment .",
    "the connected component of each segment contains all information about the segment size , shape , and spatial position .",
    "the volume of a segment is the number of voxels multiplied by the volume of each voxel .",
    "we compute the radius of each segment from the length and volume as @xmath84 .",
    "this is effectively equivalent to averaging multiple measurements of radius along the vessel , resulting in a low error in radius .",
    "we also label vessel segments and record their topology to compute the number of downstream endpoints , scaling exponents @xmath11 and @xmath13 , and scaling ratios @xmath17 and @xmath18 .",
    "segment decomposition leads to erroneous vessel segments when : 1 . a closely - spaced bundle of vessels",
    "is identified as a single vessel ; 2 .",
    "endpoint identification misses an endpoint ; 3 .",
    "the network mask contains a loop ; or 4 .",
    "patient motion artifacts cause large volumes of blood to appear as patches which are skeletonized as individual blood vessel segments .",
    "case 1 introduces segments with erroneously large radii into the distributions , but it occurs rarely , and usually in conjunction with a loop .",
    "cases 2 and 3 cause one segment to be missed , and its voxels attributed to adjacent segments , but these malformed segments are detectable .",
    "most of the voxels of tubular vessel segments are within a distance from the centerline less than the average vessel radius .",
    "we eliminate any vessel in which more than 20% of the voxels are further than @xmath63 from the centerline , or whose total volume is less than 4 voxels .",
    "this criterion also eliminates most of the vessels erroneously introduced in case 4 .",
    "* sensitivity of the measured scaling exponents to added image noise ranging from 1 to 10 times the baseline rate ( 0.47% ) .",
    "* the top left panel shows the number of vessel segments used to calculate the four scaling exponents for vessel radius versus the magnitude of the added noise .",
    "the top right panel shows the number of vessel segments used to calculate the four scaling exponents for vessel length versus the magnitude of added noise .",
    "the bottom left panel depicts how the four calculated scaling exponents for vessel radius vary with the magnitude of added noise .",
    "the horizontal lines indicate the wbe predictions for large and small vessels .",
    "the bottom right panel depicts how the four calculated scaling exponents for vessel length vary with the magnitude of image noise .",
    "the horizontal line indicates the wbe prediction .",
    "* vessel segment dataset . * the complete , raw output of angicart on the 18 images used in the study , in tab - separated values ( tsv ) format is available at + ` https://github.com/mnewberry/angicart/raw/example/example.dicom_small.all.tsv `"
  ],
  "abstract_text": [
    "<S> scientists have long sought to understand how vascular networks supply blood and oxygen to cells throughout the body . </S>",
    "<S> recent work focuses on principles that constrain how vessel size changes through branching generations from the aorta to capillaries and uses scaling exponents to quantify these changes . </S>",
    "<S> prominent scaling theories predict that combinations of these exponents explain how metabolic , growth , and other biological rates vary with body size . </S>",
    "<S> nevertheless , direct measurements of individual vessel segments have been limited because existing techniques for measuring vasculature are invasive , time consuming , and technically difficult . </S>",
    "<S> we developed software that extracts the length , radius , and connectivity of _ in vivo _ vessels from contrast - enhanced 3d magnetic resonance angiography . </S>",
    "<S> using data from 20 human subjects , we calculated scaling exponents by four methods  two derived from local properties of branching junctions and two from whole - network properties . </S>",
    "<S> although these methods are often used interchangeably in the literature , we do not find general agreement between these methods , particularly for vessel lengths . </S>",
    "<S> measurements for length of vessels also diverge from theoretical values , but those for radius show stronger agreement . </S>",
    "<S> our results demonstrate that vascular network models can not ignore certain complexities of real vascular systems and indicate the need to discover new principles regarding vessel lengths .    </S>",
    "<S> department of biomathematics , david geffen school of medicine , university of california , los angeles , los angeles , ca , usa + * 2 * department of radiological sciences , biomedical physics , and bioengineering , university of california , los angeles , los angeles , ca , usa + * 3 * department of ecology and evolutionary biology , university of california , los angeles , los angeles , ca , usa + * 4 * santa fe institute , santa fe , nm , usa    current address : university of pennsylvania , department of biology , 433 s university ave , philadelphia , pa 19104 , usa + * vsavage@ucla.edu </S>"
  ]
}