{
  "article_text": [
    "designing high quality musical instruments has been the main concern of makers for centuries , accumulating know - how from their predecessors by some kind of trial - and - error process , involving musicians . on another hand , since bernouilli and lagrange in the xviii@xmath0 century and the important writings of helmholtz in the xix@xmath0 century a great deal of research has also been conducted in order to understand the principles underlying sound production in traditional or modern musical instruments  : see e.g.  @xcite for presentations of this vast subject .",
    "wind instruments such as brasses and woodwinds , making use of an air column , must be designed in such a way as to properly arrange the natural frequencies of this air column , in order that _ regimes of oscillation _ can take place in conjunction with the nonlinear flow - control device ( reed or player s lips )  @xcite . as a consequence ,",
    "harmonicity requirements for wind instruments between natural frequencies are desirable properties , due to the fact that intonation , responsiveness and tonal colour can be attributed to well established physical properties of the instrument  @xcite .",
    "it is generally accepted that these harmonicity requirements can lead to rather different shapes , which can be ( piecewise ) cones , cylinders or more complex , as can can be seen from the actual duct of real wind instruments .",
    "nevertheless , see  @xcite for interesting results about piecewise conic ducts , following an approach based on characteristic impedances and transfer matrices .",
    "thus there is room for developping new methods that could help for the design .",
    "the present work is dedicated to such a task , with main accent on the methodological aspects .",
    "+ in  @xcite , transmission line modelling of horns is used together with finite dimensional optimization techniques and a practical tool  @xcite was developed for instrument makers , in order to help improving existing instruments as well as to design new ones according to a given specification . desired properties , specified in musical terms like intonation ,",
    "response and pitch variability were compared with calculated values based on an instrument s actual geometry .",
    "similarly , in  @xcite , a method is presented for optimizing the shape of a brass instrument with respect to its intonation and impedance peak magnitudes .",
    "the instrument is modelled using a one - dimensional transmission line analogy with truncated cones . through the use of an appropriate choice of design variables",
    ", the finite dimensional optimization finds smooth horn profiles , that can also help in correcting existing instruments , the shape having been designed from an a priori choice of a succession of cones . in  @xcite , a frequency - domain method , using inverse quantum scattering for the one - dimensional klein - gordon equation , allows to recover the area function of a given acoustical duct in a noninvasive way , without measuring directly neither the input impedance nor the reflectance  : this last one is mathematically derived from the wave radiated in response to a high - impedance source . in  @xcite , parameter optimization techniques have been used to design shapes for brass - trapping helmholtz resonators that resonate at a design set of acoustic eigenvalues , taking into account physical and geometrical constraints . in  @xcite , a finite - element eigenanalysis model of bars",
    "is used to compute optimal shapes for mallet percussion instruments such as vibraphone or marimba - type bars .",
    "the objective function for the optimization procedure is a targeted set of modal frequencies . + as one can see",
    ", optimization is at the heart of research on the design question for musical instruments and the eigenstructure often plays a central role in the optimization criteria .",
    "the shape optimization of wind instruments , an inverse problem , appears to be a complex one , when compared to the analysis of what physically occurs inside a given instrument , a direct , somewhat easier albeit not at all obvious , problem , as can be seen from the great amount of research that it is the subject of .",
    "the purpose of the present work is a continuation of preliminary ones by the author  @xcite , where the design question for axisymmetric wind instruments was posed as an optimal control problem for the so - called _",
    "webster equation _ through a suitable reformulation as a dynamical equation in the spatial dimension , thereby using infinite dimensional optimization of optimal control theory for continuous systems .",
    "this is in sharp contrast with the above mentionned references which use finite - dimensional optimization schemes , i.e. with a finite number of parameters as unknowns in the theoretical formulation .",
    "for more details about the horn equation , see  @xcite or the more recent  @xcite for a more mathematical and updated exposition . here , besides the exposition of how optimal control theory fits the wind instruments design question , a special attention is given to the choice of one specific criterion , on the basis of physical considerations , whereas in  @xcite , only a fairly general class of criteria -affine in the control- were considered that led to a general result about the structure of the shape for the duct of a wind instrument .",
    "+ the chosen criterion is in no way unique  : many other choices could be made , depending on which characteristics ( physical , perceptive and so on ) are focused on .",
    "it appeared to be interesting to investigate from a musical acoustics point of view as it comes from one definition of an _ oscillation regime _ inside wind instruments , understood as the cooperation of several natural modes of vibration , the playing frequency being the one that maximizes the total generation of energy  @xcite . at this stage , it has some arbitrariness in it  : the physical relevance of this criterion is not taken here for granted , as no other published material has been found ( than that of a.h .",
    "benade ) using this notion of oscillation regime .",
    "the reason for the choice of this criterion is twofold : first , to illustrate the general methodology that uses optimal control theory ; second , to question the relevance of this criterion , that appeared to be appealing at first sight .",
    "the purpose then is to question how interesting it is for designing wind instruments more than to assert such a relevance a priori  : numerical results in section  [ numeric ] show some qualitative features linked to the chosen criterion .",
    "+ nevertheless , on the basis of this criterion , in the context of optimal control theory , necessary conditions coming from the strong pontryagin maximum principle  @xcite are derived and some numerical simulations are conducted , in order to illustrate the theoretical predictions . in the presented approach ,",
    "the webster horn equation is regarded as a controlled dynamical system in one spatial variable ( the axis of an axisymmetric instrument ) .",
    "the pressure ( or the velocity potential ) is regarded as the state and the control is made of two parts  : one is the variable diameter ( actually its derivative with respect to the axial space dimension ) of the duct .",
    "the second part of the control is made of the constant weights of a time - harmonic decomposition of the velocity potential , which are unknown , according to the chosen criterion , the energy inside the duct .",
    "then one looks for a control that maximizes the latter .",
    "this is another difference with the approach in  @xcite , where the measure is taken to be the deviation from a measured input impedance peaks location , making use of a model - fitting oriented approach .",
    "whereas these works can be described as inverse problems , the present one falls into the category of design problems . but this distinction is a matter of convenience as both problems only differ from each other by the chosen criterion , the unknown being the duct shape in each case .",
    "it is worth noting in that respect that a similar criterion as in  @xcite could be chosen here as well , while defining the corresponding output of the model , leading to the same problem of fitting a model to given data .",
    "this will be the subject of future research , with interesting comparisons to be made , the main point here being methodological .",
    "the approach followed hereafter shows that , with the chosen optimization criterion and the modelling approach , the obtained shape is piecewise continuous .",
    "moreover , when taking into account more and more time - harmonic components , is appears from the simulations that the the obtained duct shape is a cone  : such a result tends to confirm that this criterion is likely not to be sufficient to design high - quality instruments but the realistic mode shapes that are obtained are encouraging . it should be noted that , to the best knowledge of the author , this way of looking at the classical webster horn equation , as a controlled dynamical equation , appears to be new .",
    "one important point is that extensions of the optimal control methodology to other more realistic , nonlinear models of wind instruments and design criteria can be considered , although fourier analysis will generally be no more valid in such contexts  : the choice of an adequate criterion will remain crucial .",
    "numerical simulations show that the proposed approach is appealing for design purposes .",
    "nevertheless , the presented work has to be considered as a preliminary study that opens new perspectives for the design of wind instruments  : it is not to be understood as an achievement in itself and has surely to be investigated more deeply for real applications .",
    "in particular , several aspects are not touched here such as taking account of tone holes in woodwinds ( flutes , oboes , etc .. ) , incorporating the nonlinear excitation mechanism ( reed , lips for brasses ) or choosing other criteria , in order to include perceptive parameters ( such as given by a musician ) , etc ... much remains to be done .",
    "+ the paper is organized as follows  : section  [ preliminaries ] , in order to fix the notations , recalls the standard horn equation and the definition of an oscillation regime as used here .",
    "basic results from optimal control theory are briefly given and lead to the formulation of the horn equation as a controlled dynamical system .",
    "then a detailed exposition of how the oscillation regime is formulated is given in section  [ criterion ] .",
    "section  [ webster ] gives the mathematical formulation of the optimization problem to solve , through the necessary conditions coming from optimal control theory .",
    "numerical results are given in section  [ numeric ]  : they have to be considered as preliminary results as no thorough or exhaustive investigation have been conducted at this stage . eventually , some conclusions and perspectives are drawn in section  [ conclusion ] .",
    "an appendix provides a variational derivation of the horn wave equation and reminds basic results from sturm - liouville theory .",
    "[ [ hornoscillation ] ]    consider an axisymmetric horn with length @xmath1 and section diameter @xmath2 , a function of the independent variable , the space dimension @xmath3 , according to fig .",
    "1 . let @xmath4 be the medium mass density , @xmath5 the acoustic pressure in the medium , i.e. the deviation from the atmospheric pressure , and @xmath6 the particular velocity inside the horn at abcissa @xmath3 .",
    "let @xmath7 be the wave number , @xmath8 being the sound velocity and @xmath9 the angular frequency in case of a harmonic regime that is focused on here . for derivatives of any quantity",
    "the index notation will be used in this section  : for example the time ( resp .",
    "space ) first derivative of @xmath10 will be denoted   @xmath11 ( resp .",
    "@xmath12 ) .",
    "let us first recall some usual modelling hypothesis  : i ) the diameter @xmath2 is a slowly varying function of @xmath3  ; ii ) acoustical quantities are functions of @xmath3 and @xmath13 only  ; iii ) a velocity potential @xmath10 exists , which means that @xmath14  ; iv ) one focuses on standing wave , time - harmonic solutions that write  : @xmath15 but one will omit the @xmath16 part in the sequel as it is related to the time dependence that will not be involved in the optimization process below  ; v ) in this work there is no dissipation .",
    "it can be shown that , in this situation , the pressure at @xmath3 writes  : @xmath17 .",
    "it is worth noticing that the first hypothesis is necessary for the 1d plane wave , webster equation to be valid  @xcite or @xcite , chap .",
    "another limitation to this equation is to lower frequency modes . in  @xcite ,",
    "the following approximate condition on the radius derivative @xmath18 is given for the horn equation to be valid for plane waves  : @xmath19 this condition will be used to fix bounds on the control in the simulations presented in section  [ numeric ] . with these conventions ,",
    "the webster horn equation is easily obtained as the euler equation of a variational problem  : @xmath20 which reduces to  : @xmath21 in case of a harmonic regime of interest here ( see appendix a for details ) .",
    "boundary conditions are then given for this equation , depending on the physical situation under study , making it a sturm - liouville problem ( see appendix b for a brief reminder of two useful results ) .",
    "+ on another side , the notion of _ oscillation regime _ can be defined , following h. bouasse  @xcite and a.h .",
    "benade  @xcite .",
    "it is _ `` that state of the collective motion of an air column in which a nonlinear excitation mechanism collaborates with a set of air column modes to maintain a steady oscillation containing several harmonically related frequency components , each with its own definite amplitude .",
    "then , the playing frequency is the one that maximizes the total generation of energy '' _  @xcite .",
    "+ chosing such a definition as the basis of an optimization criterion relies upon physical / acoustical considerations of what happens inside the instrument . nevertheless , it has some arbitrariness when considering perceptual quality of sound , as discussed in the introduction . but further investigations looked desirable .",
    "other criteria will be considered in future work so the present choice is only a first step towards physical / perceptual accounting in wind instruments design .",
    "+ notice also that the complex question of the nonlinear excitation mechanism , as the reed of an oboe or the lips of a brass player e.g. , is discarded ( equation  ( [ eq.sturmliouville ] ) is homogeneous ) , although nonlinear effects can be important due to the nature of fluid dynamics , e.g. inside a reed or at the excitation localization in a flute .",
    "the hypothesis is made here that the nonlinear effects are , in a first approximation , encoded in the fourier coefficients of the potential ( see section  [ criterion ] ) , corresponding to an arbitrary and unknown excitation .",
    "this is surely not satisfactory from a physical point of view and will have to be modified carefully in the future .    in the present context , where losses are assumed to vanish or to be included into the boundary conditions , the energy inside the duct , noted @xmath22 , is a conserved quantity  : @xmath23 with @xmath24 and @xmath25 are computed in the appendix . following the above definition of an oscillation regime",
    ", the energy can be taken as a design criterion for the duct shape .",
    "as it is a function of the diameter , this one can be considered as an unknown function , provided convenient data are given for the design . in that respect , as musical instruments are designed to operate in harmonic regimes , the potential , being in that case periodic , is amenable to a fourier series analysis and can thus be written as a linear combination of time - harmonic elementary components , the coefficients of which will be other unknowns of the design problems , while the frequencies will be considered as the data .",
    "this will be made more precise in section  [ criterion ] .",
    "thanks to the computations in the appendix , the link is established between an oscillation regime in the sense of a.h .",
    "benade and the way the webster horn is derived , as both rely upon the same definite integral , namely the lagrangian action , through a legendre transformation . as optimal control theory",
    "is variational too , one has a coherent set of tools for the design methodology to be exposed .",
    "[ [ optimalcontrol ] ]    suppose a dynamical system is given as  : @xmath26 where @xmath27 is the state , @xmath28\\subset { \\mathbb r}$ ] the control and a prime still denotes the derivative with respect to the independent variable @xmath3 .",
    "the control @xmath29 is purposedly restricted to be a scalar as this suffices for the needs of the present work ( see  @xcite for a more general exposition ) .",
    "the purpose of optimal control theory is to find a control @xmath29 such that some functional ( a scalar function of the state and the control )  : @xmath30 is maximized or minimized , making it an optimization problem under dynamical constraints , named for this reason infinite - dimensional .",
    "this variational - type problem is solved the following way  : using a vector lagrange multiplier @xmath31 , with components @xmath32 , define the _ hamiltonian function _ of the problem , a scalar function , as  : @xmath33 one then obtain _ necessary _ conditions for an optimum as the differential - algebraic system of equations ( dae )  : @xmath34 together with suitable initial / boundary conditions .",
    "notice first that , as @xmath35 is a scalar , all of the three above equations are _ vector _ ones  : @xmath36 e.g. is the vector with components @xmath37 .",
    "one has then a set of @xmath38 equations , the first @xmath39 ones being differential equations , the last one being of order zero .",
    "notice also that these conditions  ( [ eq.necessaryg ] ) are only _ necessary _ so that more investigations are needed to get sufficient conditions , i.e. a complete and unique solution .",
    "also , the so - called pontryagin maximum principle  @xcite allows to have more precise results for the above when the control has e.g. bound constraints , as will be the case for the acoustic design problem here .",
    "+ now , in order to fit the acoustic design problem at hand to this control theoretic setting , it is useful to reformulate the second order equation  ( [ eq.sturmliouville ] ) as a two dimensional first order system , suitable for control purposes in view . to this end , define the following variables  : @xmath40 and @xmath41 the vector with components @xmath42 .",
    "also , as the section diameter @xmath43 of the horn is an unknown to be determined as a function of @xmath3 , it can be considered as a control variable to be designed .",
    "actually , one can control either @xmath43 itself or the way it varies along the @xmath3 axis , that is one can control its derivative @xmath44 with respect to @xmath3  : as the modelling hypothesis i ) above is that the section is a slowly varying function of @xmath3 , one natural choice for the control is the derivative @xmath44 and bounds will have to be imposed to it in order to satisfy the hypothesis given by inequality  ( [ eq.inequal ] ) . as a consequence , defining the control variable @xmath29 as @xmath44 , constraints on it will be bound constraints  : @xmath45 .",
    "together with those on the control , constraints can also be imposed to the state through design / building constraints on the diameter @xmath43 itself  : an obvious mandatory state constraint is e.g. @xmath46 . after having developped the second order derivatives , and with these notations , equation ( [ eq.sturmliouville ] ) rewrites as the first order differential system  : @xmath47 which is a dynamical control system , affine in the control @xmath29  : @xmath48 , with immediate definitions for @xmath49 and @xmath50 .",
    "one has even a linear drift  : @xmath51 , where matrix @xmath52 is clearly defined .",
    "the singularity in @xmath53 is not a real problem as it corresponds to a vanishing diameter , a highly uninteresting situation ( except possibly at one boundary , the apex of a complete cone e.g. ) .",
    "now , referring to theorem i , item 2 of the appendix , for each eigenvalue @xmath54 the eigenfunction @xmath55 satisfies the wave horn equation with the same boundary conditions .",
    "one can then rewrite for each eigenvalue @xmath56 , the corresponding first order differential system of equations  : @xmath57 with  : @xmath58 .",
    "this set of equations , @xmath59 together with the equation @xmath60 constitutes the controlled dynamical model that will enter the optimization process as constraints . remark that on a practical side , only a finite number of eigenvalues will be retained , as is detailed below in section  [ criterion ] .",
    "one should notice also that , whereas in most control theoretic situations one looks for a feedback control , the searched after control for the above horn equation is intrinsically open - loop , as the duct is designed once for all ( at least in the present state of technology ... ) so that optimal control theory and the pontryagin maximum principle  @xcite are well suited in the present context , although giving only necessary conditions , as already mentionned .",
    "besides the above simple , albeit new , problem rewriting , the crux in the followed approach of wind instrument design is in formulating the oscillation regime , as defined in section  [ hornoscillation ] .",
    "it must be done in a way suitable for conducting the optimization while having the controlled dynamical model of section  [ optimalcontrol ] above at hand . considering the above definition for an oscillation regime",
    ", the potential @xmath10 can be assumed to be a time - periodic function . for harmonicity requirements of the signals inside the duct , the wave numbers @xmath61s are fixed data given as multiples of a fundamental frequency  : @xmath62 , @xmath63 .",
    "to each of the @xmath61s corresponds a solution @xmath64 of the webster equation with @xmath61 as wave number .",
    "the set @xmath65 is a basis of the hilbert space of square - integrable functions on @xmath66 $ ] , thanks to theorem 1 , item 3 , appendix .",
    "thus , thanks to theorem 1 , item 4 , appendix , the overall potential @xmath10 can be written as  : @xmath67 which is seen to be the fourier series decomposition of @xmath68 with respect to the time variable .",
    "thus parseval theorem allows to write  : @xmath69 the energy @xmath22 can now be computed as a function of @xmath70 , simply substituting for @xmath10 from ( [ eq.potential ] ) into ( [ eq.energy ] ) , which gives , thanks to the relations  ( [ eq.squares ] )  : @xmath71 the last equality stemming from the definition of @xmath72 at the end of section  [ preliminaries ] .",
    "now assume that the energy is conserved inside the horn .",
    "at least , one can consider in a first approximation that the small part of energy which is radiated outside the duct or dissipated at the inside boundary is exactly compensated with the energy brought in by the excitation mechanism such as the reed of the instrument .",
    "such dissipation and other phenomena should surely be considered in future work , possibly through the boundary conditions .",
    "the definition of an oscillation regime leads then to maximize @xmath22 as defined in equation  ( [ eq.energy.1 ] ) .",
    "thus , with _ the @xmath73s known and fixed as given data _ , the optimization problem above has to _ find @xmath2 and the @xmath74s_. observe nevertheless that obtaining optimal @xmath74s does not give any indication on some perceptive quality factor which is indeed important for a high quality design .",
    "thus it is likely at this stage that optimizing the above - defined oscillation regime is unsufficient to that end .",
    "section  [ numeric ] will present simulations for the above defined problem , after the design problem itself has been mathematically posed in the following section .",
    "thanks to the results of section  [ preliminaries ] and  [ criterion ] , the design of axisymmetric wind instruments can be now formulated as an optimal control problem in the following way .",
    "consider an oscillation regime as defined and developped in sections  [ hornoscillation ] , [ criterion ] , each component being governed by the webster horn equation with its own wave number @xmath61 and keeping the approximation of the solution to a finite number , @xmath75 , of its first terms .",
    "the data are made of the set of fixed multiples of a fundamental frequency @xmath76 , leading to the set @xmath77 , with @xmath78 allowing to take into account that a complete series of harmonics of @xmath76 or only the odd part of this series can be present . as @xmath10 is unknown",
    ", the @xmath74s of its time - harmonic decomposition are unknown parameters and considered as constant controls . in the following",
    ", the @xmath74s will be gathered in a parameter vector noted @xmath79 .",
    "then the searched after shape of the duct and the @xmath74s are obtained as the solution of the following problem  :    ( @xmath80 ) * maximize * @xmath22 as given by equation  ( [ eq.energy.1 ] ) , with respect to @xmath43 and @xmath81    :    1 .",
    "the @xmath82-dimensional dynamical model @xmath83  : @xmath84 each @xmath85 pair of the last @xmath86 equations being a webster equation with wave number @xmath61 .",
    "2 .   bound constraints on the variable control  : @xmath87 .",
    "state constraint  : @xmath88 , @xmath89 a fixed real number .",
    "it is apparent that , whenever @xmath90 , the state constraint is satisfied . within this context ,",
    "the strong pontryagin maximum principle ( pmp )  @xcite is applicable .",
    "necessary conditions for an optimal control ( i.e. an optimal duct shape ) are obtained in the following way . along the general",
    "setting given by  ( [ eq.stateg ] ) , ( [ eq.criteriong ] ) , ( [ eq.hamiltoniang ] ) , ( [ eq.necessaryg ] ) , adjoin the dynamical constraints  ( [ eq.states ] ) to the criterion @xmath22 , ( [ eq.energy.1 ] ) , through lagrange multipliers @xmath91 , define the hamiltonian of problem ( @xmath80 ) as  : @xmath92 then , following  ( [ eq.necessaryg ] ) , @xmath31 is the solution of the adjoint differential system @xmath83  : @xmath93 thus the optimization problem will be complete when initial - boundary conditions are specified .",
    "notice that time - initial conditions are not relevant here as the time variable has been eliminated through the hypothesis of time - harmonic regime and of energy conservation  : the outputs of the optimization process are space - dependent , giving e.g. the mode shapes inside the duct . as a starting point and in order to simply illustrate the method , without going into deep physical considerations of a specific instrument , that are postponed to a forthcoming paper , the end at @xmath94 is assumed to be closed ( typically where the excitation would be placed ) so that the velocity and thus @xmath95 vanish there  : @xmath96 .",
    "also the other end is assumed to be open ( e.g. the other end of a brass instrument ) so that , at the first order approximation , the pressure and thus @xmath97 vanish  : @xmath98 .",
    "these conditions lead to a two - point boundary value problem ( tpbvp ) for the differential system  ( [ eq.states]),([eq.costate ] )  : one part of the state is fixed at one end and another part is fixed at the other end . when some state component @xmath99 is left unspecified at one end",
    ", the corresponding costate component @xmath100 must vanish there  @xcite .",
    "thus in the present situation  : @xmath101 .",
    "other conditions can be imposed with more realistic considerations . for computing the optimal control ,",
    "the pontryagin maximum principle implies that , for @xmath102 ( resp .",
    "@xmath103 ) a solution of the state ( resp .",
    "adjoint state ) equation , an optimal control @xmath104 and optimal parameter vector @xmath105 are such that  : @xmath106,c = cst\\}}h(\\hat{x},u , c,\\hat{\\mu } ) \\label{eq.hamiltonianopt}\\ ] ] but one can observe that @xmath35 is affine with respect to @xmath29 so that  : @xmath107 which is also named the _ switching function _ for this problem as its zeroes and its derivative can help determine the shape of the duct .",
    "as equation  ( [ eq.hu ] ) does not allow to compute the control @xmath29 explicitely , one is faced with a problem with _ singular extremal arcs _",
    "@xcite , chap .  8 . the standard method is to compute successive derivatives of @xmath108 with respect to @xmath3 until one is able to get an expression for @xmath29 . in the present case ,",
    "two such derivatives allow this , after tedious but straightforward computations . in case",
    "@xmath29 is bounded , as it is the case here , the minimum of the hamiltonian @xmath35 with respect to @xmath29 , where @xmath109 , can occur at the boundary of the domain ( see  @xcite ) .",
    "this fact can be observed in the simulations  : the control can be on its bound along several intervals of the integration interval ( figure  [ figure-2 - 3 ] ) or can go from one bound to the other ( figure  [ figure-10 - 3 ] ) , revealing a _ bang - bang _ type control  @xcite .",
    "the conclusion is that one generally obtains quasi - cones .",
    "cones could not be obtained for exactly harmonic frequencies  @xcite , chap .",
    "this is compatible with the results obtained in  @xcite .",
    "now , thanks to the developments of this section , one has sufficient material to illustrate the design method through a few simulations , on which some qualitative observations can be made and confirmation of the theoretical results is given .",
    "remember nevertheless that in the following , only candidates for optimal shapes are obtained at this stage ( necessary conditions ) because , due to theorem 2 , only @xmath110 can be uniquely determined from the given boundary spectral data .",
    "further data and theoretical investigations are necessary towards a really optimal shape .",
    "the numerical results presented here must be considered as qualitative illustrations of the above theoretical results .",
    "no interpretation in terms of musical quality will be attempted at this stage .",
    "such results will be pursued elsewhere more deeply in order to derive conclusions on realistic physical and perceptual basis . nevertheless , some features are worth noticing at this stage , when faced with some characteristics of real instruments .      in the following ,",
    "data are as follows  : the air mass density is taken to be @xmath111 , the sound velocity is that in free space at standard temperature  : @xmath112 and one focuses on a fundamental frequency for the note usually labelled @xmath113 , i.e. @xmath114 , leading to the wavelength @xmath115 .",
    "the chosen wave numbers are then indicated under each figure  : @xmath116 and @xmath117 an even or odd integer . at the narrow end , @xmath94 , one",
    "has @xmath118 fixed with different values for each simulation ( see below ) and @xmath119 . at @xmath120 , the condition @xmath121 is satisfied only approximately , by adjunction to the criterion through a simple penalty method .",
    "the duct diameter derivative is allowed to vary in the bounded interval @xmath122 $ ] , @xmath123 being indicated on each figure .",
    "they are chosen to satisfy inequality  ( [ eq.inequal ] ) with @xmath124 , for the maximum value @xmath125 of the @xmath61s , i.e. are within the validity domain of the wave horn equation , according to  ( [ eq.inequal ] ) .",
    "the interval of integration , i.e. the length of the duct , is taken to be @xmath126 but could be taken as an unknown as well , leading to an analogous of the so - called _ time - optimal _ control .",
    "last , all unspecified initial values for the state variables and all initial controls are taken to be random variables uniformly distributed on @xmath127 $ ] .      the numerical method used to solve the optimization problem exposed in section  [ webster ] is the following ( see e.g.  @xcite , chap .  7 for more details on several possible numerical methods used for optimal control problems )  : an initial guess is given for the control vector and , using this control , the state equation is numerically integrated from @xmath128 , considering too the unspecified initial conditions as constant controls , which are to be determined with the optimization process .",
    "the integration was performed thanks to a predictor - corrector scheme with an explicit euler method for the prediction step and a crank - nicholson scheme for the correction .",
    "then the costate equation is integrated backwards -notice that this equation is always linear in the costate- using the obtained terminal values for @xmath129 .",
    "this allows to compute the gradient of the objective function with respect to the control , thanks to @xmath108  @xcite .",
    "then a standard optimization routine is used , passing through the previous steps in a recursive way , in order to make this gradient decrease , until the specified terminal conditions at @xmath120 are -approximately here- achieved and the criterion evolves x no more , to a specified precision ( @xmath130 ) . for the time being , the criterion and the terminal constraints have been gathered in a single objective function through a simple penalty method but this could be improved .",
    "for the optimization , a quasi - newton method with projection has been used together with a bfgs method for an estimation of the hessian .",
    "such an approach is known to have , as usually newton - type methods , the drawback that it can give local minima and to be sensitive to the initial guess for the solution  @xcite .",
    "thus , other methods such as direct solution of the tpbvp by shooting or multiple shooting techniques should be interesting to investigate but this is deferred to future work because an extra work has to be done in order to have an explicit expression for the control , as a function of the state and costate ( see the discussion in section  [ webster ] above )",
    ". nevertheless several different initial conditions for the state @xmath131 were tested : the results , not exposed here , did not show to be that sensitive but this should be confirmed theoretically .",
    "the few simulations presented here have been done while fixing , respectively , two , five and ten components for the overall potential inside the duct , i.e. @xmath132 in equation  ( [ eq.states ] ) . in each case , the duct shape is shown first , followed by the corresponding modes shapes that have been normalized to their maximum value , at @xmath94 .",
    "in addition for the case of two components only , the diameter derivative has been shown to illustrate the fact that it can be only piecewise continuous and that the phenomenon , mentionned in section  [ webster ] , of singular extremal arcs joining regular arcs can appear ( see figure  [ figure-2 - 3 ] )  : the control @xmath133 is on its bound on some subintervals . for the five components cases , the shape is also quasi - conic but in a less obvious manner .",
    "but for the ten component case , one has an example of abrupt change in conicity and @xmath44 in figure  [ figure-10 - 3 ] illustrates the possibility of bang - bang type control mentionned in section  [ webster ] . on each figure the imposed lower ( @xmath134 ) and upper ( @xmath135 ) bounds are indicated .",
    "notice that the impedance , @xmath136 and the instantaneous power , @xmath137 ( @xmath138 , the pressure , @xmath139 the volume velocity ) , for all @xmath3 are easily obtained from the outputs , @xmath140 and @xmath2 @xmath141 $ ] , of the optimization process .",
    "the simulations are as follows  :    1 .   : [ fixtwo ] for this first simulation , the fundamental frequency is @xmath113 and the second component is the second harmonic ( double frequency ) .",
    "the diameter at the closed end is @xmath142 .",
    "the duct shape is shown in figure  [ figure-2 - 1 ] , the two modal shapes in figure  [ figure-2 - 2 ] .",
    "@xmath44 is shown in figure  [ figure-2 - 3 ] as it makes appear the phenomenon described in section  [ webster ] , where the control is at the bound on two subintervals , with the consequence that one obtains a quasi - cone for the duct , made of conic pieces joined by more complex but smooth parts . 2 .   : [ fixfive ] in this second simulation ( see figures  [ figure-5 - 1],[figure-5 - 2 ] ) , the data are the same as for two components , except for @xmath143 .",
    "the five components have frequencies @xmath144 .",
    "one has not shown @xmath44 here but the result is here again a quasi - cone , although this is not apparent again on figure  [ figure-5 - 1 ] , because @xmath44 varies much less but still varies along the duct .",
    "3 .   : [ fixten ] in this third simulation ( see figures  [ figure-10 - 1],[figure-10 - 2],[figure-10 - 3 ] ) , the data is the same as for five components , except for @xmath145 .",
    "the ten components have frequencies @xmath146 .",
    "the results are noticeable as here again , three conic pieces are found so that the derivative @xmath44 is shown in figure  [ figure-10 - 3 ] , making it here again a quasi - cone , with a bang - bang type behaviour for @xmath44 .",
    "the duct is made of conic pieces with different conicity joined together .",
    "only the five first modal shapes have been displayed , for better readability .",
    "the above simulations show only qualitative albeit important results at the present stage .",
    "the main one is that , as foreseen by the theoretical investigations , and for the specific chosen criterion , the duct shapes are piecewise continuous , this being particularly clear on the case of two and ten components ; observe too in both cases the fact that the control is at the bound on some subintervals , meaning that regular arcs and singular arcs can coexist .",
    "one can see also that quasi - cones are obtained , in an obvious way for the first and second simulations .",
    "recall nevertheless that , as mentionned , the numerical method can be sensitive to initial conditions in the optimization process , so that it is difficult to interpret these results in a precise manner at the present stage .",
    "the qualitative observation is that the shapes are quasi - cones . at the same time",
    ", the modal shapes ( i.e. the eigenfunctions of the sturm - liouville problem ) show a behaviour that is qualitatively in agreement with what is theoretically predicted for cones ( see  @xcite , chap .",
    "7 ) , i.e. one has modal shapes that decrease as @xmath3 increases to @xmath1 . on one hand , these results are coherent with what is known for such geometries  @xcite . on another hand ,",
    "the fact that one gets quasi - cones essentially would lend to conclude that the used notion of oscillation regime does not allow to capture all the important features that are sought after for musical quality , as flaring horns in brasses e.g. can not be achieved with it  : significant and important nonlinear phenomena  @xcite are not taken into account with the here retained model and design criterion .",
    "thus , using more realistic models and refined criteria should be used instead .",
    "+ the computed modes have an extremum at the closed end , coherent with the chosen boundary condition ( @xmath119 ) . at the other open end ,",
    "the modes does not vanish exactly  : one reason for this is linked to the way this end condition has been taken into account in the numerical method  : a simple penalty method makes a compromise between satisfying the criterion and the boundary conditions there .",
    "the above suggested method of directly solving the tpbvp through shooting techniques should give better results from this point of view .",
    "thanks to a reformulation within a control theory framework , the design of axisymmetric wind instruments has been revisited .",
    "it has been shown that in order for an oscillation regime in the sense of a.h .",
    "benade to take place inside the air column and with the considered linear model , the shape tends to be conic , as the number of time - harmonic components grows .",
    "this tends to show that such a criterion , as it has been mathematically described , is unsufficient to grasp the necessary conditions that lead to high - quality instruments .",
    "no other conclusion from this point of view is given at this stage .",
    "nevertheless , and this was one main purpose of this work , the approach makes it very flexible to deal with a great variety of design constraints , either on the control or on the shape itself . at the present time , only qualitative results have been given to illustrate the theoretical results and the field is wide open to numerical investigations as well as to experiments on more physical and musical premisses . in that respect ,",
    "some important issues can be straightforwardly put in perspective  : 1 ) a first possible development is to use the method in a model fitting way , using an experimentally measured input impedance from a real instrument and taking a distance measure with the corresponding model output as criterion , in a similar way as in  @xcite .",
    "more realistic duct shapes are to be expected and it will be interesting to compare results from different approaches .",
    "2 )  refine the question of physical / perceptual criteria and of the horn model  : this relies upon physical considerations as well as on experiments with real existing instruments played by expert musicians .",
    "this is surely a central point to get a practical tool useful for real design .",
    "one consequence of modifying the criterion is that the structure of the obtained shape will likely be different from that obtained in the present study .",
    "3 ) develop the method for woodwinds , thereby including toneholes in the design process .",
    "4 ) take into account some imposed - shaped parts such as pieces of cylinders or cones from built - in components , such as for brasses .",
    "this implies using _ path constraints _ in the optimal control framework .",
    "5 ) all the previous points depend on the modelling question of how to include the nonlinear excitation mechanism ( reed , lips ... ) in the model as well as other nonlinear phenomena , which were discarded in the present study .",
    "6 ) last , an interesting question is to try to retrieve , with the presented approach , the lattice of sound tubes results found in  @xcite .",
    "this will imply to modify the mathematical framework of the controlled dynamical system , i.e. the function spaces where the state and the control live , in order to be able to take into account discontinuous , and not only piecewise continuous , duct shapes .",
    "the mathematical theory of distributions could be an adequate framework for this .",
    "these items are but a small part of what should be addressed within the proposed framework to achieve a satisfying design methodology .",
    "the author is undebted to two anonymous reviewers an to the editor of the special issue , j. kergormard , for their numerous advices that helped greatly improve the paper .                                                            instead of the usual , newton - type modelling approach , making use of forces and moments balance equations ,",
    "a lagrangian one is followed here , as it fits better the variational context for the design methods that form the core of the present work . for standard derivation",
    "the reader is referred to  @xcite for physical considerations and to  @xcite for control theory formulation . + for a general pressure field , the lagrangian action density at each time instant inside the duct is the difference between a kinetic term and a potential term , that are computed in a standard way , as follows .",
    "assumption ii ) implies that the duct can be considered as a continuous stack of cross - sections @xmath147 , parametrized by the abcissa @xmath3 . for each section @xmath147 located at @xmath3 along the horn axis ,",
    "an action density is computed as the integral of densities of the particles over the section .",
    "this leads to an expression proportional to the cross - section area , i.e. to @xmath148 .",
    "firstly , the kinetic term writes  : @xmath149 similarly , the potential energy term is given as  : @xmath150 thus the lagrangian action density writes  : @xmath151 eventually , the lagrangian action inside the duct writes  : @xmath152 according to hamilton s stationary action principle , the dynamics inside the duct is obtained as the euler equation of the above action @xmath153  : @xmath154 but one can see that @xmath155 , thus  : @xmath156 and eventually , dividing by @xmath157  : @xmath158 which is recognized to be the wave horn equation or webster horn equation .",
    "the interest of the above variational derivation for this equation lies first in the fact that the optimal control approach to the design is variational in nature too .",
    "thus , due to the harmonic nature of waves inside musical instruments , the horn equation writes , for one fixed value @xmath9  : @xmath159 i.e. using primes from now on to denote the derivatives with respect to the spatial dimension @xmath3 along the axis , the only remaining independent variable  : @xmath160 this equation being adjuncted a set of suitable boundary conditions  : @xmath161 which represents a resonator without active components and for which losses can be taken into account in the boundary conditions that will be precised for the simulations in section  [ numeric ] .",
    "thus one is faced with a homogeneous sturm - liouville problem .",
    "two theorems from spectral theory of sturm - liouville problems are recalled here for self - containedness  : one  @xcite for the so - called `` direct problems '' and the second  @xcite for `` inverse problems '' .",
    "let @xmath162 $ ] and @xmath163 . then  : + * theorem 1 *  @xcite  : for every function @xmath164 continuous in @xmath165  :    1 .",
    "the sturm - liouville problem has an infinite strictly increasing sequence of eigenvalues @xmath166 such that @xmath167 and the series @xmath168 converges .",
    "2 .   for each eigenvalue @xmath56",
    ", the homogeneous sturm - liouville problem has a real - valued solution @xmath64 such that @xmath169 , which is unique up to a multiplicative real constant .",
    "the sequence @xmath170 is an orthonormal system in a convenient hilbert space of functions .",
    "let @xmath171 be complex - valued continuous function defined in @xmath165 , the primitive of a ruled function @xmath172 such that  : ( i ) @xmath172 is continuous in @xmath165 , except possibly at a finite number of interior points .",
    "( ii ) @xmath172 has a derivative @xmath173 continuous in every interval where @xmath172 is continuous .",
    "( iii ) @xmath171 satisfies the boundary conditions in  ( [ eq.bc ] ) .",
    "then , if @xmath174 , one has  : @xmath175 where the series converges uniformly and absolutely in @xmath165",
    ".    on another hand , the design question itself relies upon the following inverse boundary spectral theorem  : + * theorem 2 *  @xcite  : assume that @xmath176 are the boundary spectral data of the dirichlet - schrdinger operator , @xmath177 , corresponding to the above sturm - liouville problem , on an interval @xmath178 $ ] .",
    "then , these data determine @xmath1 and @xmath164 uniquely . + it is moreover worth noting that only @xmath179 can be determined uniquely from these data .",
    "this means here that only the ratio @xmath180 is so .",
    "thus to determine @xmath43 itself needs supplementary data ."
  ],
  "abstract_text": [
    "<S> it has been asserted previously by the author that optimal control theory can be a valuable framework for theoretical studies about the shape that a wind instrument should have in order to satisfy some optimization criterion , inside a fairly general class . </S>",
    "<S> the purpose of the present work is to develop this new approach with a look at a specific criterion to be optimized . in this setting </S>",
    "<S> , the webster horn equation is regarded as a controlled dynamical equation in the space variable . </S>",
    "<S> pressure is the state , the control being made of two parts  : one variable part , the inside diameter of the duct and one constant part , the weights of the elementary time - harmonic components of the velocity potential . </S>",
    "<S> then one looks for a control that optimizes a criterion related to the definition of an oscillation regime as the cooperation of several natural modes of vibration with the excitation , the playing frequency being the one that maximizes the total generation of energy , as exposed by a.h . </S>",
    "<S> benade , following h. bouasse . at the same time </S>",
    "<S> the relevance of this criterion is questionned with the simulation results . </S>"
  ]
}