{
  "article_text": [
    "the neighbor - net algorithm was introduced by bryant and moulton in @xcite .",
    "it is a method for constructing split networks @xcite from distance measurements , and has been used for evolutionary analyses in linguistics @xcite and phylogenetics @xcite .",
    "neighbor - net is gaining in popularity because it is as fast as distance based methods for tree construction , and the split networks output by the algorithm are informative for studying conflicting signals in data .",
    "the interpretations of split networks are based on @xmath2-theory @xcite , which is an active research area within mathematics .    despite the intuitive appeal of split networks for data analysis ,",
    "a criticism of their use in phylogenetics , and of the neighbor - net algorithm in particular , has been the lack of an obvious tree interpretation . moreover , although it was remarked in @xcite that `` neighbor - net is based on the neighbor - joining algorithm of saitou and nei @xcite '' , this was meant to indicate analogy at a high level : neighbor - net and neighbor - joining are both agglomerative algorithms , they have similar selection criteria , and they are both consistent .",
    "however despite the obvious similarities between neighbor - net and neighbor - joining , there has been no direct link established between the outputs of the algorithms .",
    "it is desirable to establish a mathematically precise connection because there have been a number of recent papers `` explaining '' neighbor - joining @xcite , both in terms of showing what it optimizes @xcite and why it works well in practice @xcite .",
    "the lack of informative theorems about neighbor - net coupled with the difficulties in mastering @xmath2-theory have contributed to a sense that interpretations of neighbor - net results `` remain messy and subject to a certain degree of subjectivity . ''",
    "we describe the precise connection between neighbor - net and neighbor - joining in section 2 , and in section 5 we show that our observation can be used to allay concerns that neighbor - net provides no direct phylogenetic",
    "our result also provides an interpretation of @xmath0 as the space of phylogenetic networks . in section 3",
    "we show that neighbor - net is a greedy algorithm for the traveling salesman problem that minimizes the balanced length of the split system at every step .",
    "this extends the notion of balanced length in @xcite and the results of @xcite where it was shown that neighbor - joining greedily optimizes the balanced length of a tree . in section 4",
    ", we prove that neighbor - net is optimal for kalmanson dissimilarity maps .",
    "this establishes new proofs for results of @xcite , and provides an analog of atteson s neighbor - joining robustness theorem @xcite for neighbor - net .",
    "the main objects of study in this paper are a class of discrete metric spaces called _ circular decomposable metrics _ that include tree metrics as a special case .",
    "we begin with an introduction to some fundamental results about these metric spaces .",
    "their study is part of @xmath2-theory , and we refer the reader to @xcite for a more thorough introduction and survey of the subject . throughout the paper , @xmath3 denotes the finite set on which metrics are defined .    a _ split _",
    "@xmath4 is a partition of @xmath5 into two non - empty blocks .",
    "a set of splits is called a _",
    "split system_. the split metric determined by @xmath6 is the pseudo - metric @xmath7    a split system @xmath8 is _ pairwise compatible _ if for every pair of distinct splits @xmath9 , @xmath10 in @xmath8 , at least one of the intersections @xmath11 is empty .",
    "a _ dissimilarity map _ on @xmath3 is a function @xmath12 that satisfies @xmath13 and @xmath14 . a dissimilarity map @xmath15 satisfies the _ four point condition _ if for every four elements @xmath16 , two of the three terms in the following list are equal and greater than the third : @xmath17    [ thm : fourpoint ] the following are equivalent statements about @xmath18 :    1 .",
    "there exists a split system @xmath8 such that every pair of distinct splits in @xmath8 is pairwise compatible , and @xmath19 where @xmath20 for all @xmath21 .",
    "2 .   @xmath15 is a metric and satisfies the four point condition .",
    "there is a canonical median graph associated with a split system called the _ buneman graph _ @xcite .",
    "the buneman graph of a pairwise compatible split system is a tree , and therefore , in light of theorem [ thm : fourpoint ] , metrics satisfying the four point condition are called _",
    "tree metrics_. they are precisely the metrics @xmath22 for which there is an edge weighted tree whose leaves are labeled by @xmath5 , and for which @xmath23 is the `` additive distance '' between @xmath24 and @xmath25 in the tree .",
    "theorem [ thm : fourpoint ] provides the necessary ingredients for describing the input and output of the neighbor - joining algorithm .",
    "specifically , neighbor - joining is an efficient algorithm for evaluating a certain function from the set of dissimilarity maps to pairwise compatible split systems .",
    "a key feature of the algorithm , is that the steps explicitly construct the buneman tree associated with the output .",
    "the neighbor - net algorithm is similarly explained in terms of certain split systems and metrics .",
    "the key concept is that of a circular ordering for a finite set @xmath5 .    a _ circular ordering _",
    "@xmath26 is a bijection between @xmath5 and the vertices of the @xmath27-cycle @xmath28 such that @xmath29 and @xmath30 are adjacent vertices of @xmath28 .",
    "we adopt the convention that @xmath31 .",
    "given a circular ordering @xmath32 , let @xmath33 .",
    "note that @xmath34 is a set consisting of pairs of sets constructed from quartets . in what follows we use the notation @xmath35 to denote the quartet @xmath36 .    a split system @xmath8 is _ circular _ with respect to a circular ordering @xmath37 if every split @xmath21 is of the form @xmath38    note that every pairwise compatible split system is circular .    a dissimilarity map @xmath15 satisfies the _ kalmanson conditions _",
    "@xcite with respect to a circular ordering @xmath32 if for every @xmath39 , @xmath40    given a dissimilarity map @xmath15 that satisfies the kalmanson conditions with respect to a circular ordering @xmath32 , we let @xmath41 .",
    "note that @xmath42 is a set of quartets given by the strict kalmanson inequalities .",
    "[ thm : circular ] the following are equivalent statements about @xmath18 :    1 .",
    "there exists a circular ordering @xmath32 and a split system @xmath8 so that @xmath43 where every split @xmath21 is circular with respect to @xmath32 and @xmath20 for all @xmath21 .",
    "@xmath15 is a metric and satisfies the kalmanson conditions with respect to @xmath32 .",
    "moreover , a quartet @xmath44 iff there exists a split @xmath6 with @xmath45 such that @xmath46 and @xmath47 are in different blocks of @xmath6 .",
    "metrics satisfying condition ( 1 ) of theorem [ thm : circular ] are called _ circular decomposable metrics _ , and it is possible to represent them using _",
    "split graphs_. these are described in detail in @xcite .",
    "here we merely illustrate the idea with an example ( figure 1(a , b ) ) .",
    "each class of parallel edges corresponds to one split @xmath21 and the length of the edges in a class are given by the @xmath48 .",
    "split graphs are not necessarily unique , but they provide a useful way to visualize a circular decomposable metric .",
    "the neighbor - net algorithm outputs a circular ordering for the purpose of visualizing a circular decomposable metric associated to it using split graphs .",
    "the algorithm is _ agglomerative _ , which means that the circular ordering is constructed iteratively .",
    "the boxed algorithm 1 describes the details of the algorithm .",
    "the terms used in its description are defined below :    [ neighbornet ] let @xmath49 be the disjoint union of @xmath27 vertices and @xmath50 the partial circular ordering with graph @xmath49 .",
    "let @xmath51 be the weighting for @xmath50 .",
    "+ output the circular ordering @xmath32 and the split system @xmath52 .",
    "let @xmath49 be a subgraph of the cycle @xmath28 with @xmath27 vertices and @xmath53 components .",
    "the graph @xmath49 is called the _ circular ordering graph_. a _ partial circular ordering _ @xmath50 consists of the graph @xmath49 together with a bijection between @xmath5 and the vertices of @xmath49 .",
    "equivalently , a partial circular ordering is a partition @xmath50 of @xmath5 into ordered sets @xmath54 where each @xmath55 and @xmath46 are adjacent elements in @xmath56 for some @xmath57 iff @xmath46 correspond to adjacent vertices in @xmath49 .",
    "we use the notation @xmath58 to denote the vertices of degree 0 or 1 in the subgraph corresponding to @xmath56 .",
    "let @xmath50 be a partial circular ordering with @xmath59 .",
    "weighting _ for @xmath50 consists of a function @xmath60 such that @xmath61 for all @xmath62 , and for each @xmath63 , @xmath64 and @xmath65 for all @xmath66 .",
    "we define @xmath67    note that if @xmath68 then there is only one weighting for @xmath50 , i.e. , @xmath69 for all @xmath24 .",
    "next , we introduce two types of weightings that lead to interesting neighbor - net algorithms in sections 3 and 5 .",
    "a weighting @xmath70 is a _ tsp weighting _ if , for all @xmath62 , @xmath71 for all @xmath72 .",
    "these weightings lead to aggressive greedy algorithms for the traveling salesman problem ( theorem [ thm : nn_greedy ] ) .",
    "[ def : tree_weighting ] let @xmath70 be a weighting for a partial circular ordering @xmath50 , and consider a new weighting @xmath73 for the adjustment step of neighbor - net .",
    "@xmath74 is a _ tree weighting _ if it satisfies @xmath75 where @xmath56 and @xmath76 are the two blocks being merged in the merging step and @xmath77 .",
    "tree weightings are so named because of the following proposition :    [ prop : tree_construct ] the split system @xmath8 output by neighbor - net on input @xmath15 is pairwise compatible , and in bijection with a binary tree @xmath2 .",
    "if @xmath78 is a tree weighting then the tree @xmath2 is the neighbor joining tree for @xmath15 , where the agglomeration parameter at every step is given by the tree weighting parameter @xmath79 .",
    "* proof * : note that the addition of an edge to the graph @xmath49 during a run of the algorithm results in a coarsening of the partition @xmath50 , where two blocks are merged into one .",
    "for this reason , if @xmath80 is a split added before @xmath81 to @xmath8 , then either @xmath82 or @xmath83 .",
    "to see that the tree determined by @xmath52 is the neighbor - joining tree , it suffices to note that selection step 1 , together with the adjustment step specified by a tree weighting , is identical to the agglomeration procedure of neighbor - joining . with a tree weighting ,",
    "selection step 2 and the fixed ordering within clusters has no effect on the adjustment or tree construction steps . if we simply omit the selection step 2 and the merge step , the neighbor - net algorithm reduces to neighbor - joining .",
    "proposition [ prop : tree_construct ] justifies the term _ tree construction step _ in the neighbor - net algorithm and shows that the output of neighbor - net is not only a circular ordering , but also a tree .",
    "the connection to the neighbor - joining tree is explored further in section 5 .",
    "the coarsenings of the partition @xmath50 in the merge step are also closely related to _",
    "graph tubings _",
    "@xcite :    let @xmath49 be a finite graph .",
    "a _ tube _ is a proper nonempty set of vertices whose induced graph is a proper , connected subgraph of @xmath49 .",
    "a pair of tubes @xmath84 are _ nested _ if @xmath85 or @xmath86 .",
    "they _ intersect _ if they are not nested and @xmath87 , and two tubes are _ adjacent _ if @xmath88 and @xmath89 is a tube .",
    "two tubes are _",
    "compatible _ if they do not intersect and are not adjacent .",
    "a _ tubing _ of @xmath49 is a set of tubes that are pairwise compatible .",
    "[ prop : tubing ] let @xmath90 be the path on @xmath91 vertices .",
    "a labeling of @xmath90 is a bijection from @xmath92 to @xmath90 .",
    "the output of neighbor - net is a labeling of @xmath90 together with a maximal tubing of its line graph @xmath93 .",
    "* proof * : each coarsening of @xmath50 corresponds to a tube in @xmath93 .",
    "[ fig : example1 ]    ( 500,500 ) ( 50,0 ) corresponds to a color class with the length of the edges in the class @xmath48 indicating the size of the split .",
    "( b ) the metric @xmath15 derived from the splits network .",
    "( c ) the output of neighbor - net on input @xmath15 .",
    "the tree is the neighbor - joining tree .",
    "note that its edges are highlighted in the splits network .",
    "( d ) the associahedron @xmath94 corresponding to the circular ordering @xmath95 and the vertex corresponding to the neighbor - joining tree . ( e )",
    "the space of phylogenetic networks @xmath0.,title=\"fig : \" ] ( 160,470)(a ) ( 300,340)@xmath96 ( 250,170)neighbor - net ( 130,340)@xmath0 ( 260,300)(b ) ( 100,340)(e ) ( 90,120)(d ) ( 270,120)(c )    for a graph @xmath49 with @xmath27 vertices , the graph - associahedron @xmath97 is the convex polytope of dimension @xmath91 whose face poset is isomorphic to the set of valid tubings of @xmath49 , with the poset order corresponding to nesting of tubes .",
    "the _ associahedron _ ( denoted by @xmath98 ) refers to the graph - associahedron of the path @xmath90 , and its vertices are in bijection with tubings of the path .    [",
    "prop : catalan ] the number of vertices of @xmath99 is given by the catalan number @xmath100 .",
    "the vertices are in bijection with tubings of the path @xmath101 , triangulations of the convex @xmath27-gon , and rooted binary trees with @xmath91 leaves .",
    "we have listed just a few of the objects in bijection with the vertices of @xmath98 .",
    "in fact , there are dozens of combinatorial objects enumerated by the catalan numbers ( see @xcite .",
    "in the context of the neighbor - joining algorithm , proposition [ prop : catalan ] appears as proposition 3.1(ii ) in @xcite .",
    "proposition [ prop : catalan ] allows us to enumerate the total number of possible outputs of the neighbor - net algorithm .",
    "[ prop : count ] the number of possible outputs of neighbor - net for n",
    "taxa is @xmath102    * proof * : the number of distinct circular orderings ( where two orderings are equivalent under the action of the dihedral group ) is @xmath103 so the total number of possible outputs is @xmath104    the first numbers are @xmath105",
    "these numbers also appear in another context in computational biology ; in genome assembly they are the number of ways that @xmath27 distinguishable equal - length clones can be interleaved to form one island @xcite .    propositions [ prop : tubing ] and [ prop : catalan ] together establish that the output of neighbor - net is a circular ordering together with the vertex of an associahedron .",
    "equivalently , it is a labeled convex @xmath27-gon together with a triangulation .",
    "thus , it is natural to consider @xmath106 associahedra corresponding to the distinct circular orderings .",
    "these associahedra can be glued together in a natural way so that faces are identified when the associated subdivisions of the @xmath27-gon differ by twists along the diagonal @xcite .",
    "this identification corresponds exactly to the tessellation of a certain space known as @xmath0 by associahedra .",
    "the space @xmath0 consists of the real points of the deligne - knudsen - mumford compactification of the moduli space @xmath107 of riemannian spheres with @xmath27 labeled punctures .",
    "its tessellation by associahedra is described in @xcite .",
    "figure 1(e ) shows the example for @xmath108 .",
    "one element from the dual tessellation by @xmath109-dimensional cubes is also shown .",
    "each cube is divided into @xmath110 octants , and these octants are in bijection with the possible outputs of neighbor - net ( by proposition [ prop : count ] there are 840 of them ) .",
    "this is summarized as follows :    neighbor - net is an efficient evaluation of a function from dissimilarity maps to octants in the dual tessellation by cubes of @xmath0 .",
    "the vertices of the cube ( or equivalently , each associahedron ) can be interpreted as providing the basis for circular decomposable metrics ( networks ) together with tubings of the path that are in bijection with trees ( phylogenies ) .",
    "we therefore refer to @xmath0 ( or its dual tiling ) as the _ space of phylogenetic networks_.    we note that the relevance of @xmath0 to phylogenetics was already mentioned in @xcite , however in that paper it was deemed unsuitable for describing the space of trees , and replaced with a quotient space equivalent to the tropical grassmanian @xcite .",
    "it is interesting that @xmath0 also appears in the study of genome rearrangements @xcite",
    ". it should be interesting to explore extensions of neighbor - net that produce , via agglomeration , tubings of line graphs other than @xmath90 , thus leading to more general phylogenetic networks connected to graph associahedra .",
    "we conclude this section by noting that our description of neighbor - net has been based on an interpretation of the algorithm as producing only combinatorial output , i.e. , a circular ordering @xmath32 together with a tree . in practice",
    ", it is possible to obtain weights @xmath48 for the splits in the circular split system @xmath8 compatible with @xmath32 in the course of the algorithm .",
    "this is done by setting @xmath111 for every split @xmath112 .",
    "the problem with such a procedure is that there is no guarantee that all the @xmath48 will be non - negative , and therefore the result may not be a circular decomposable metric .",
    "this may be circumvented by setting @xmath48 to zero if it is negative , but this solution may lead to inaccurate results . for these reasons ,",
    "a preferable procedure is to use the circular ordering @xmath32 to subsequently estimate the split weights using a non - negative least squares optimization method .",
    "this was done in the original neighbor - net implementation @xcite .",
    "in the previous section we have explained the input and output of the neighbor - net algorithm . in this section ,",
    "we show that neighbor - net is a greedy algorithm for minimizing the ( suitably defined ) length of a dissimilarity map with respect to a circular ordering .",
    "we begin by extending the formulation of balanced length in @xcite from trees to circular decomposable metrics .",
    "we say that a circular ordering @xmath37 is _ consistent with @xmath50 _ , if for every pair of adjacent elements @xmath46 in some @xmath113 there exists a @xmath114 such that @xmath115 and @xmath116 .",
    "we denote the circular orderings consistent with @xmath50 by @xmath117 .",
    "[ def : length_pco ] the _ balanced length of a dissimilarity map _ @xmath15 with respect to a partial circular ordering @xmath50 is defined to be @xmath118.\\\\   & &   = \\frac{1}{2|o({\\mathcal{c}})|}\\sum_{(i , j ) \\in x } \\eta_{{\\mathcal{c}}}(i , j)\\delta(i , j).\\end{aligned}\\ ] ] here @xmath119 is the number of circular orderings consistent with @xmath50 where @xmath24 is adjacent @xmath25 .",
    "[ rem : tsp ] the partial circular ordering @xmath120 is just the shortest traveling salesman tour for the dissimilarity map @xmath15 .",
    "we extend the notion of a balanced agglomeration scheme from neighbor joining to neighbor - net :    a _ balanced tsp weighting _ is a tsp weighting where @xmath121    [ thm : nn_greedy ] let @xmath50 be a partial circular ordering ( @xmath59 ) with a balanced tsp weighting and @xmath15 a dissimilarity map .",
    "a circular ordering @xmath122 of size @xmath123 that extends @xmath50 and minimizes @xmath124 is obtained by finding a pair @xmath125 that minimize @xmath126 and then adding an edge between the pair of vertices corresponding to @xmath127 in the circular ordering graph that minimize @xmath128    * proof * : let @xmath54 be a partial circular ordering .",
    "a neighbor - net step consists of adding an edge to @xmath50 .",
    "this constitutes selecting two paths to join ( step 1 ) , and then deciding which of the ends of the paths to join ( step 2 ) .",
    "the number of circular orderings consistent with @xmath50 is @xmath129    ( 500,500 ) ( 20,-20 ) from figure 1(b ) .",
    "( a ) a partial circular ordering @xmath130 and the 12 circular orderings consistent with it . note that at this stage @xmath131 ( b ) selection step part 1 showing @xmath132 where @xmath133 and @xmath134 . now @xmath135 and",
    "this is a neighbor - joining agglomeration .",
    "( c ) selection step part 2 results in a new partial circular ordering @xmath136 with 6 adjacent to 1 and @xmath137 .",
    "this last step is what distinguishes neighbor - net from neighbor - joining.,title=\"fig : \" ] ( 40,465)(a ) ( 40,300)(b ) ( 40,130)(c )    let @xmath138 denote all of the partial circular orderings where there is an edge between endpoints of @xmath56 and @xmath76 in the circular ordering graph .",
    "we say that a circular ordering is consistent with @xmath138 if it is consistent with one of the partial circular orderings in @xmath138 .",
    "similarly , we define @xmath139 to constitute all circular orderings consistent with some partial circular ordering in @xmath138 . in the following lemma",
    "we use the notation @xmath140 to denote that @xmath24 and @xmath25 are in the same block in @xmath141 , and @xmath24 is adjacent to @xmath25 .",
    "the number of circular orderings consistent with @xmath138 is @xmath142 and @xmath143    the proof of the lemma is elementary .",
    "we note that it also makes sense for weightings that are not balanced tsp weightings , except that the effect of the weightings @xmath78 is to alter the @xmath144 so that they count the number of circular orderings consistent with split systems larger than @xmath138 .",
    "for example , if @xmath78 is a tree weighting , then @xmath144 counts the number of circular orderings consistent with the partially resolved tree @xmath52 . for more on this see definition [ def : length_splits ] and theorem [ thm : variance ] .",
    "we can now conclude the proof of theorem [ thm : nn_greedy ] : @xmath145    thus , @xmath146 where @xmath2 does not depend on @xmath57 or @xmath147 .",
    "in other words , at each step neighbor - net is selecting a pair @xmath148 to join that will minimize the balanced length . the actual minimum balanced length is attained for one of the @xmath149 possibilities for adding an edge between @xmath150 and @xmath151 in @xmath50 . using the same argument as above , it is easy to see that the minimum balanced length is attained when @xmath152 is subsequently minimized .",
    "[ rem : zq ] let @xmath153 then @xmath154 implies that @xmath155    the quantity @xmath156 features prominently in @xcite and is based on the `` neighborliness measurement '' of @xcite : @xmath157 @xmath158    it is interesting to note that the results in @xcite are motivated by this alternative formulation of the neighbor - joining criterion .",
    "remark [ rem : zq ] provides further evidence that the `` @xmath159-criterion '' is a natural formulation for the neighbor - joining criterion , and at the same time explains the meaning of @xmath156 in terms of the balanced length .",
    "returning to remark [ rem : tsp ] , we have the following interpretation of theorem [ thm : nn_greedy ] :    [ rem : greedy ] neighbor - net with a balanced tsp weighting is a greedy algorithm for the traveling salesman problem .",
    "in fact , neighbor - net provides the optimal solution for the tsp when @xmath15 satisfies the kalmanson conditions ( see theorem [ thm : consistent ] in section 4 ) .",
    "it is well known that the tsp can be solved in polynomial time @xmath160 for kalmanson matrices @xcite ; neighbor - net provides an alternative @xmath161 polynomial algorithm . the @xmath161 running time",
    "is based on the observation that the tsp and tree weighting schemes can be implemented so that the selection steps are @xmath162 where @xmath114 is the number of blocks in the partial circular ordering at each step .",
    "it should be possible to obtain further improvements in speed by using the ideas developed for fast neighbor - joining @xcite .",
    "theorem [ thm : nn_greedy ] is restricted to the balanced tsp weighting .",
    "we note , however , that there is no practical limitation to using different weightings for the first and second selection steps .",
    "we may consider a hybrid algorithm that applies a tree weighting to the first selection step and a balanced tsp weighting to the second . in that case ,",
    "proposition [ prop : tree_construct ] together with theorem [ thm : nn_greedy ] show that    neighbor - net with a hybrid weighting scheme is a greedy algorithm for finding , simultaneously , the tree of minimum balanced length and the circular ordering of minimum length consistent with it .",
    "we begin in this section by showing that neighbor - net is a robust algorithm . by this",
    "we mean that if the input to neighbor - net is a dissimilarity map @xmath15 that is a perturbation of a circular decomposable metric with respect to a circular ordering @xmath32 , neighbor - net outputs the circular ordering @xmath32 .",
    "we note that in the case of a circular decomposable metric where some of the splits have zero weight , there will be more than one circular ordering consistent with @xmath15 . in that case",
    "neighbor - net will output one of those circular orderings .",
    "a corollary to this is that if @xmath15 is a circular decomposable metric , and equation ( [ eq : distance_estimates ] ) is used to estimate the distances , then the output is exactly @xmath15 , i.e. , neighbor - net is a consistent estimator of the parameters of a circular decomposable metric .",
    "implicit in the neighbor - net estimator are assumptions about the variances of the measured distances .",
    "these can be interpreted in terms of the weighting scheme used in neighbor - net , and we return to this at the end of the section .",
    "[ thm : consistent ] suppose that @xmath163 is a dissimilarity map that satisfies the kalmanson conditions for some circular ordering @xmath32 .",
    "then neighbor - net applied to @xmath15 outputs a circular ordering @xmath164 such that @xmath165 .",
    "* proof * : it suffices to show that at any step of the algorithm , every circular ordering consistent with the partial circular ordering contains all the quartets in @xmath166 .",
    "let @xmath54 be a partial circular ordering consistent with @xmath32 so that if @xmath167 and @xmath168 and @xmath169 then @xmath170 .",
    "[ lem : kalman ] for every @xmath171 , @xmath172    * proof * : this follows directly from the kalmanson conditions and the requirement that @xmath173 for every @xmath57 .",
    "moreover , if for some @xmath174 with @xmath175 we have @xmath176 , then @xmath177 .",
    "next we introduce some notation to simplify the necessary calculations .",
    "we set @xmath178 .",
    "this is an analog of the _ farris transform _",
    "@xcite for blocks in the partial circular ordering @xmath50 .",
    "note that @xmath179 in order to simplify the presentation , we replace every @xmath180 with @xmath24 in the formulas below .",
    "this is mathematically justified by lemma [ lem : kalman ] since blocks in a partial circular ordering behave exactly like elements of the underlying set @xmath5 with respect to the kalmanson conditions .",
    "for example , by @xmath181 in the lemma below , we mean @xmath182 and a proof that @xmath183 is equivalent to the proof that @xmath184 by lemma [ lem : kalman ] .",
    "[ lem : one_middle ] @xmath185    * proof * : let @xmath186 . @xmath187 and @xmath188 for each @xmath189 by lemma [ lem : kalman ] .",
    "[ lem : two_middle ] @xmath190    * proof * : let @xmath191 .",
    "applying lemma [ lem : kalman ] twice : @xmath192    . ]",
    "[ lem:3times ] let @xmath193 .",
    "then @xmath194    * proof * : note that each of the following inequalities follows directly from lemma [ lem : kalman ] : @xmath195 summing both sides we obtain the required inequality .    [ prop : consistent ] suppose that @xmath196 .",
    "then there exists @xmath114 such that @xmath197    * proof * : recall that @xmath198 .",
    "suppose without loss of generality that @xmath199 and @xmath200 .",
    "we will find @xmath201 satisfying ( [ eq : noncon ] ) , where the proof is non - constructive and mimics the arguments in theorem 25 of @xcite .",
    "in particular , we show that @xmath202 so that there exists @xmath203 with @xmath204 .",
    "we first note that @xmath205 we then break this sum into three sections : those that fall between @xmath206 and @xmath25 , a matching set of the same size @xmath207 that lie beyond @xmath25 , and lastly , all remaining terms . in this way ,",
    "equation ( [ eq : main_nonconstr ] ) equals @xmath208    by lemma [ lem : two_middle ] , the last summation is greater than or equal to zero , and so :    @xmath209    the final inequality follows from lemma [ lem:3times ] .",
    "the claim ( [ eq : noncon ] ) now follows by noting that repeated application of the argument leads to one of three cases : either we find a pair of neighbors @xmath210 such that @xmath211 , or else we find a pair that are separated by one node ( in which case we apply lemma [ lem : one_middle ] ) or a pair that are separated by two nodes ( in which case we apply lemma [ lem : two_middle ] ) .    returning to the proof of the theorem , it is clear that if we have a strict kalmanson inequality on any quartet that separates @xmath24 and @xmath25 , then the inequalities in lemmas [ lem : one_middle ] , [ lem : two_middle ] and proposition [ prop : consistent ] are strict inequalities .",
    "consequently we never join a pair of blocks that violate a quartet in @xmath166 .",
    "if the blocks are of size 1 we are done .",
    "otherwise , it only remains to show that two neighboring elements @xmath212 and @xmath213 will be selected to be joined in the minimization of @xmath214 .",
    "this follows directly from the same arguments used in lemmas [ lem : one_middle ] and [ lem : two_middle ] .",
    "the consistency of neighbor - net now follows easily by observing that for a circular decomposable metric , the distances will be correctly inferred using ( [ eq : distance_estimates ] ) .",
    "neighbor - net is statistically consistent .",
    "moreover , theorem [ thm : consistent ] can be used to obtain a neighbor - net analog of atteson s theorem @xcite on the optimal radius of neighbor - joining :    [ cor : optimal_radius ] let @xmath8 be a circular split system with respect to a circular ordering @xmath37 , @xmath215 for every @xmath21 , and @xmath216 a circular decomposable metric . if @xmath217 and @xmath15 is any dissimilarity map with @xmath218 then neighbor - net will output a circular ordering whose split system contains @xmath8 .    *",
    "proof * : it suffices to show that if @xmath219 then @xmath15 satisfies the kalmanson conditions with respect to @xmath32 .",
    "let @xmath39 .",
    "@xmath220 therefore , @xmath221 a similar argument shows that @xmath222 .    note that in corollary [ cor : optimal_radius ] the dissimilarity map @xmath15 satisfying @xmath223 may not be a metric .",
    "kalmanson matrices ( as opposed to metrics ) are characterized in @xcite .",
    "we have already hinted at connections between neighbor - net and the traveling salesman problem in section 3 .",
    "our next theorem demonstrates the consistency of the tsp estimate of the circular ordering and is analogous to theorem 2 of @xcite .",
    "let @xmath15 be a generic circular decomposable metric with respect to a circular ordering @xmath37 .",
    "then @xmath224 for any circular permutation @xmath225 different from @xmath32 .",
    "* proof * : since @xmath15 is a circular decomposable metric it must satisfy the kalmanson conditions .",
    "therefore there must exist @xmath226 such that @xmath227 .",
    "consider the circular ordering    @xmath228 then @xmath229 and therefore @xmath230 .",
    "this result explains why it makes sense to use tsp solutions directly for finding circular orderings @xcite .",
    "we now turn to the statistical meaning of the weighting @xmath78 in the neighbor - net algorithm , and discuss how it should be chosen in practice .",
    "we first consider the case of tree weightings . in this case",
    "neighbor - net outputs a circular ordering consistent with the neighbor - joining tree ( proposition [ prop : tree_construct ] ) .",
    "the theory of @xcite together with our results provides a direct interpretation of the agglomeration parameters that can be summarized as follows :    [ def : length_splits ] let @xmath8 be a split system that is circular with respect to some circular ordering and let @xmath231 be the number of circular orderings consistent with @xmath8 where where @xmath189 is adjacent to @xmath232 .",
    "the length of a dissimilarity map @xmath15 with respect to @xmath8 is @xmath233    [ thm : variance ] let @xmath15 be a dissimilarity map , @xmath8 a split system that is circular with respect to some circular ordering , and @xmath231 defined as above .",
    "let @xmath234 ( @xmath235 ) be the circular decomposable metric obtained from the weighted least squares estimates of the splits under the assumption that the variance of @xmath23 is @xmath236 ( with the same constant @xmath237 for all @xmath46 ) .",
    "then @xmath238    the choices of agglomeration parameters for a tree weighting determine @xmath231 at each step and are therefore implicit variance assumptions on the distances for the weighted least squares tree that is being greedily approximated by the algorithm .",
    "the balanced tree weighting scheme for neighbor - net corresponds to balanced neighbor - joining agglomeration @xcite .",
    "it should be interesting to explore bionj @xcite analogs for neighbor - net , which is easy to do since it only involves adapting the tree weightings . in the case of a balanced tsp weighting ,",
    "theorem [ thm : variance ] explains that the neighbor - net algorithm ignores nodes once they have two neighbors after agglomeration .",
    "we conclude by remarking that some progress has been made in the development of statistical models for split networks , suggesting the possibility for maximum likelihood approaches to finding circular split systems @xcite .",
    "our goal in this section is to show how the theorems proved in the previous sections provide insight into how to use neighbor - net in practice , and in how to infer split networks .",
    "we begin with an observation regarding the distance reduction formula used in the current implementations of neighbor - net .",
    "the agglomeration scheme proposed in @xcite is as follows : suppose that a circular ordering contains two blocks @xmath239 that are being agglomerated , where @xmath56 is a union of two smaller blocks @xmath240 so that the agglomerated block is @xmath241 in that order .",
    "@xmath242 there is an analogous formula for the case when two blocks , each composed of two blocks are being joined ( the above formula is applied twice ) .",
    "this weighting is neither a tsp weighting nor a tree weighting .",
    "furthermore , in the case of agglomeration of a pair of blocks each composed of two blocks , the resulting weighting @xmath78 depends on the order in which the agglomeration is performed .",
    "thus , the tree output by neighbor - net using ( [ eq : oldagglom ] ) is not necessarily the neighbor - joining tree , whereas the use of a tree - weighting scheme guarantees this ( proposition [ prop : tree_construct ] ) .",
    "the advantage of producing a circular ordering consistent with the neighbor - joining tree , is that it allows for a direct analysis of the conflicting signals with a tree of interest . to demonstrate this",
    ", we analyzed a published dataset of language structure characters from oceanic austronesian and papuan languages @xcite .",
    "the neighbor - net algorithm was previously used to infer phylogenetic relationships among the languages ( figure s2 from the supplementary materials of @xcite ) .",
    "we compared figure s2 obtained using the default parameters for neighbor - net ( [ eq : oldagglom ] ) with the balanced tree weighting scheme that produces a neighbor - joining tree . in both cases ,",
    "the split weights were computed using the constrained least squares estimation procedure in @xcite .",
    "the split networks were visualized using the program splitstree4 @xcite . figure 4(a ) shows the network for the balanced tree weighting scheme , together with the neighbor - joining tree corresponding to the split system output by the algorithm .",
    "the circular ordering obtained by using the default neighbor - net settings is not consistent with this neighbor - joining tree .",
    "the ability to view the neighbor - joining tree in conjunction with the neighbor - net split network is a direct result of proposition [ prop : tree_construct ] .",
    "the representation of the tree together with the network , as shown in figure 4(left ) , is useful for directly using neighbor - net to evaluate the extent of phylogenetic discordancy with the neighbor - joining tree .",
    "for example , we see clearly that the split between the papuan and austronesian ( oceanic ) languages is in fact a split in the neighbor - joining tree .",
    "note that all the edges in the network and tree are drawn to scale .",
    "the interpretation of neighbor - net as a greedy algorithm for the tsp suggests an analysis of the optimal tsp tour .",
    "we computed this tour for the dataset from @xcite using concorde @xcite .",
    "the optimal tour , of length 7.541 was found in 0.57 seconds .",
    "the length of this tour should be contrasted with the length of the balanced tree weighting tour , 7.810 , which is very close to 7.794 , the length of the tour obtained using the default parameters .",
    "the constrained least squares optimization procedure of @xcite was applied to the optimal circular ordering and resulted in the split network shown in figure 4(right ) .",
    "the comparison of the two split networks in figure 4 is interesting .",
    "a key observation in @xcite was that the papuan languages cluster into groups consistent with the geographical locations of the islands .",
    "on the other hand , it was remarked that bougainville , which is geographically in between the bismarck archipelago and the central solomon islands , did not cluster in between the languages from those two locations .",
    "figure 4(right ) shows that the tsp ordering produces a better overall clustering , albeit still with the bougainville languages not sandwiched in the geographically correct location .",
    "nevertheless , a key new insight that emerges from the network is that bali , which appears to be incorrectly grouped , is in fact correctly grouped if one assumes that the papuan and oceanic groups are really two distinct separate groups ( it is then just a neighbor to nalik ) .",
    "our main conclusion is that the choice of weightings in the neighbor - net algorithm is important in determining the results , and that care has to be taken in choosing the weights appropriately .",
    "furthermore , tree weighting algorithms will be useful in cases where it is desirable to use neighbor - net as a diagnostic tool for exploring neighbor - joining trees , and tsp algorithms may be useful for direct application in obtaining circular orderings .",
    "in fact , the use of tsp solvers in similar contexts is not new , appearing in @xcite in the context of tree construction and in @xcite , where the concorde program is used to find a circular ordering from a distance matrix for proteins based on protein - protein interactions .",
    "it also seems important to develop a variant of neighbor - net that outputs the optimal circular ordering consistent with an arbitrary given tree .",
    "we conclude by noting that neighbor - net can also be used practically as a greedy algorithm for the tsp . unlike the naive greedy algorithm for which many negative results have been published ( see , e.g. , @xcite ) , neighbor - net exhibits good properties . for example , the output does not depend on the order of the input , and the algorithm is optimal for kalmanson matrices .",
    "we experimented with the problem st70.tsp from tsplib @xcite .",
    "the balanced tsp weighting gave a tour of length 759.801 , that is only 12% longer than the optimal tour of length 678.598 .",
    "as expected , the balanced tree weighting scheme yielded a longer tour of length 812.613 .",
    "it will be interesting to explore the improvements possible with the incorporation of search heuristics such as nearest neighbor interchange moves .",
    "these have been used to significantly improve neighbor - joining in the fastme program @xcite .",
    "figure 1(e ) is based on figure 13(b ) from @xcite and we thank stayan devadoss for permission to use his artwork .",
    "we thank david bryant , vincent moulton and andreas spillner for kindly sharing with us a preprint of @xcite , lu luo for useful comments on a preliminary version of this manuscript , and radu mihaescu for suggestions in the proof of theorem [ thm : consistent ] .",
    "lior pachter was supported in part by an nsf career award ( ccf-0347992 ) and thanks jotun hein and philip maini for hosting him while on sabbatical when this work was performed .",
    "dan levy was supported by a grant from the biotechnology and biological sciences research council of the uk ( bb / d005418/1 ) .",
    "d  bryant , f  filimon , and r  gray , _ untangling our past : languages , trees , splits and networks _ , the evolution of cultural diversity : phylogenetic approaches ( r  mace , c  holden , and s  shennan , eds . ) , ucl press , 2005 , pp .  6985 .",
    "p  buneman , _ the recovery of trees from measures of dissimilarity _ , mathematics in the archaeological and historical sciences ( fr  hodson , dg  kendall , and p  tautu , eds . ) , edinburgh university press , 1971 , pp .  387395 .",
    "to3em , _ theoretical foundation of the balanced minimum evolution method of phylogenetic inference and its relationship to weighted least - squares tree fitting _ , molecular biology and evolution * 21 * ( 2004 ) , 587598 .",
    "o  gascuel , _ a note on sattath and tversky s , saitou and nei s , and studier and keppler s algorithms for inferring phylogenies from evolutionary distances _ , molecular biology and evolution * 11 * ( 1994 ) , 961963 .",
    "m  lutz , _ bantu classification , bantu trees and phylogenetic methods _ , phylogenetic methods and the prehistory of languages ( p  foster and c  renfrew , eds . ) ,",
    "cambridge : mcdonald institute for archaeological research , 2006 , pp .  4355 .",
    "be  moret , l  nakhleh , t  warnow , cr  linder , a  tholse , a  padolina , j  sun , and r  timme , _ phylogenetic networks : modeling reconstructibility and accuracy _ , ieee / acm transactions on computational biology and bioinformatics * 1 * ( 2004 ) , 1323 ."
  ],
  "abstract_text": [
    "<S> the neighbor - joining algorithm is a popular phylogenetics method for constructing trees from dissimilarity maps . </S>",
    "<S> the neighbor - net algorithm is an extension of the neighbor - joining algorithm and is used for constructing split networks . </S>",
    "<S> we begin by describing the output of neighbor - net in terms of the tessellation of @xmath0 by associahedra . </S>",
    "<S> this highlights the fact that neighbor - net outputs a tree in addition to a circular ordering and we explain when the neighbor - net tree is the neighbor - joining tree . </S>",
    "<S> a key observation is that the tree constructed in existing implementations of neighbor - net is not a neighbor - joining tree . </S>",
    "<S> next , we show that neighbor - net is a greedy algorithm for finding circular split systems of minimal balanced length . </S>",
    "<S> this leads to an interpretation of neighbor - net as a greedy algorithm for the traveling salesman problem . </S>",
    "<S> the algorithm is optimal for kalmanson matrices , from which it follows that neighbor - net is consistent and has optimal radius @xmath1 . </S>",
    "<S> we also provide a statistical interpretation for the balanced length for a circular split system as the length based on weighted least squares estimates of the splits . </S>",
    "<S> we conclude with applications of these results and demonstrate the implications of our theorems for a recently published comparison of papuan and austronesian languages . </S>"
  ]
}