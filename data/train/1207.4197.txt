{
  "article_text": [
    "imaging faint exoplanets and circumstellar disks is a difficult task limited by the small angular separation and high contrast between the faint astrophysical signal and the residual starlight @xcite .",
    "the first direct images of planets or other interesting localized structures orbiting nearby stars were obtained relatively recently @xcite .",
    "direct imaging results will significantly expand in the near future with a new generation ground - based instruments being implemented @xcite . even using advanced starlight suppression systems ( e.g. coronagraphs ) such as",
    "the one designed for the gemini planet imager @xcite , image post - processing remains necessary to achieve the full high - contrast performance @xcite .",
    "indeed , most recent direct imaging results were enabled by key advances in observational procedures , e.g. angular differential imaging ( adi ) @xcite , simultaneous imaging of contiguous wavelengths @xcite , in conjunction with sophisticated images analysis routines based on the locally optimized combination of images ( loci ) algorithm @xcite . although loci is extremely powerful at detecting point sources , the very aggressive psf subtraction introduces biases on the photometry and astrometry , which have to be calibrated carefully @xcite .",
    "biases can be reduced significantly using statistical exploration of the algorithm parameter space @xcite , a computationally expensive solution , or by modifying the underlying cost function by masking some pixels @xcite or using damping penalty terms @xcite .",
    "loci tends to subtract extended structures such as debris disks , and several studies have focused on mitigation strategies , taking advantage of the geometry in edge - on disks or performing an optimization over large zones @xcite .    in this paper",
    "we introduce a new reduction algorithm based on projections on a truncated karhunen love transformation of the reference psf library .",
    "we first introduce the general formalism associated with psf subtraction and describe the algorithm .",
    "we then use hst nicmos coronagraphic data to illustrate its performances and highlight its advantages for the characterization of point sources and the discovery of faint extended structures around nearby stars .",
    "an astronomical point spread function ( psf ) can be seen as a @xmath0-dimensional stochastic process indexed over a scalar quantity @xmath1 , which is representative of the state of the instrument - telescope system ( for instance : time , wavelength , field rotation angle , wavefront error , exposure time , star magnitude ) at the time of the exposure . with @xmath0 pixels in the image",
    ", the psf intensity can be written as : @xmath2,q[n],\\psi ) , \\label{eq1}\\ ] ] where we have rearranged the detector coordinates in one dimension using the pixel mapping functions @xmath3 and @xmath4 and the pixel index @xmath5 @xmath6)$ ] .",
    "we assume an observation sequence that yields a target ] which might ( @xmath7 ) or might not ( @xmath8 ) contain faint astronomical signal @xmath9 , and a set of reference images : @xmath10 @xmath11 and @xmath12 represent the realizations of the state of the telescope - instrument system respectively for the target image and the set of references .    using prior information about the observation strategy ,",
    "these references have been selected so that they do not contain any astronomical signal in the search region @xmath13 ( dimension @xmath14 pixels ) of the psf .",
    "moreover the observations have been carried out at neighboring states of the telescope / instrument system : @xmath15 for all @xmath16 $ ] , where @xmath17 is a small quantity that can be adjusted in practice using the correlation between images as a proxy .",
    "the goal of psf subtraction is to reconstruct @xmath18 using the set of reference images and to subtract it from the target image since @xmath19 .",
    "unfortunately @xmath20 is a continuous random process of @xmath21 and thus an infinite amount of references would be needed to reconstruct @xmath18 exactly . in practice",
    "we can only seek to determine the best estimate @xmath22 of @xmath18 using the limited information contained in the k references .",
    "assuming that each reference is unique , the ensemble @xmath23 spans @xmath24 , a k dimensional sub - space of @xmath25 , which has an infinity of orthonormal bases @xmath26 .",
    "this problem of estimating @xmath22 can be formulated as : + _ what is the basis set @xmath27 most likely to minimize the distance between a random realization of @xmath28 ( @xmath29 in our case ) and @xmath24 ? more formally : _ @xmath30 \\right\\}\\label{eq2}\\ ] ] where @xmath31 $ ] stands for the expected value over the telescope realizations and @xmath32 denotes the inner product over @xmath13 .",
    "this is a well known problem in signal processing and , assuming that all the images are of zero mean over @xmath13 , the optimal basis set @xmath33 is given by the karhunen - love transform of the @xmath23 @xcite .",
    "moreover if one chooses to only describe @xmath34 over a @xmath35 dimensional sub - space , then the optimal basis set is given by the truncated karhunen - love transform of the references , @xmath36 +      the klip algorithm consists of the following steps :    1 .",
    "partition the target @xmath37 and references @xmath38 images in an ensemble of search areas @xmath13 , and subtract their average values so that they have zero mean over each @xmath13 .",
    "2 .   compute the karhunen - love transform of the set of reference psfs @xmath39 : @xmath40 where the vectors @xmath41 $ ] are the eigenvectors of the k - dimensional covariance matrix @xmath42 of the @xmath38 references over @xmath13 , and @xmath43 are its eigenvalues .",
    "@xmath44 & = & \\sum_{n = 1}^{n_{\\mathcal{s } } } r_i(n)r_j(n ) \\label{eq4}\\\\   e_{rr}\\cdot c_k & = & \\lambda_k c_k , \\ ; \\lambda_1>\\lambda_2> .... >\\lambda_n \\label{eq5 }   \\end{aligned}\\ ] ] 3 .",
    "choose a number of modes @xmath45 to keep in the estimate @xmath22 .",
    "4 .   compute the best estimate @xmath46 of the actual psf @xmath47 from the projection of the science target @xmath37 on the @xmath48 karhunen - love basis : @xmath49 5 .",
    "calculate the final image @xmath50 , @xmath51      equation [ eq::rands ] provides fundamental information pertaining to the optimal choice of @xmath45 for a given search zone @xmath13 .",
    "the variance in the search zone @xmath13 after the psf subtraction is given by : @xmath52 which is a decreasing function of @xmath45 . in figure",
    "[ fig : variance ] we show the impact of @xmath45 on the residual variance integrated over entire klip - reduced images ( i.e. @xmath13 is the full image ) , using hst - nicmos coronagraphic data preselected to have no astrophysical signal .",
    "figure [ fig : variance ] shows that the empirical residual variance after psf subtraction follows the theoretical estimate in equation  [ eq : variance ] .",
    "similarly , equation [ eq::rands ] provides a simple expression for the signal : @xmath53 for the dominant modes ( i.e. @xmath54 ) @xmath55 since the morphology of the astronomical signal can not be reproduced by a psf realization .",
    "indeed the psf of a faint planet is localized over a few pixels and thus almost orthogonal to the main modes of the telescope s psf realizations .",
    "naturally this argument depends on the spatial morphology of the signal : in figure  [ fig : throughput ] we show that the algorithm throughput decreases when @xmath45 increases for several types of faint astrophysical object . given priors on the shape of the astrophysical signal ( i.e. planet position and flux , or a disk model ) ,",
    "it is possible to estimate directly the signal to noise ratio ( snr ) as a function @xmath45 when @xmath13 is small enough so that equation [ eq : variance ] represents the local noise in the vicinity of the source .",
    "it is therefore possible to choose @xmath45 _ a priori _ in order to optimize the snr for a given putative source in the image .",
    "in practice the optimal search area @xmath13 might be too large to use equation  [ eq : variance ] and equation  [ eq : signal ] to pre - select @xmath45 .",
    "instead @xmath45 can be tuned by inspecting the snr of putative sources in reduced images .",
    "however the second term of equation  [ eq::rands ] carries all the information necessary to _ characterize _ faint astrophysical signal once it has been detected .",
    "indeed the impact of the algorithm on the signal only depends on the projection of @xmath9 on the @xmath56 and is not a function of @xmath34 . as a consequence klip enables forward modeling of detected planets and disks by fitting directly an astrophysical model @xmath57 to the final reduced images @xmath58 , where @xmath59 represents the model parameters ( e.g. astrometry and photometry for a planet , or geometry , grain distribution for a disk ) .",
    "@xmath59 can be obtained by minimizing the following cost function : @xmath60 a similar approach was proposed by @xcite using loci , but it presents degeneracies because the loci coefficients are not guaranteed to be independent of @xmath34 or @xmath61 .",
    "such degeneracies do not arise in the case of klip because the effect of the algorithm on the astrophysical source is completely determined from equation  [ eq : fowardmod ] and because the basis @xmath48 is independent of the science target .",
    "note that equation  [ eq : fowardmod ] assumes a noiseless signal .",
    "optimal observers @xcite can mitigate the impact of noise in the final estimate of @xmath59 , and their implementation is greatly facilitated by the fact that equation  [ eq : fowardmod ] only consists of propagating @xmath57 through a linear filter .",
    "discussion regarding the practical implementation and performances of such observers are however beyond the scope of this study .",
    "the left panel of figure  [ fig : hr8799 ] shows an archival hst nicmos image of hr 8799 reduced with klip using annular search zones . while the three planets @xmath62,@xmath63 , and @xmath64 are visible they are not detected unambiguously : the result reported by @xcite used a combination of thousands of loci reductions , and took advantage of two hst roll angles to minimize the false alarm probability .",
    "one could envision a similar parameter search with klip .",
    "the computational cost of such an exercise would however be reduced since klip does not require the introduction of  optimization zones \" and  subtraction zones \" @xcite , which reduces the dimensionality of the algorithm s parameter exploration .",
    "more importantly the astrometry reported in @xcite was the result of a lengthy characterization of the biases associated with loci , involving thousands of reductions with synthetic companions .",
    "on the right panel of figure  [ fig : hr8799 ] we illustrated how one can determine the astrometric location and the photometry of hr8799bcd with forward modeling in a single klip - reduced image .",
    "in this example we performed a simple @xmath65 minimization of the position and flux of each planets , but this framework enables easy implementation of more appropriate modeling using markov chains monte carlo ( mcmc ) .",
    "klip thus provides astrophysical estimates which do not contain any bias arising from self - subtraction in the reduction algorithm .",
    "the uncertainties on the astrophysical parameters are solely driven by the local noise in the reduced image .",
    "this can be addressed by optimizing the klip parameters to increase local snr , using several exposures and taking advantage of observers that are optimal with respect to the residual noise .",
    "pca has been extensively used in astronomy to reduce the dimensionality of large datasets , e.g. @xcite .",
    "principal components can also be used directly with loci or any of its variants to reduce the dimensionality of the reference set , using kl eigen - images instead of reference psfs .",
    "the cost function associated with klip ( equation  [ eq2 ] ) is very similar to the cost function associated with loci @xcite .",
    "however , loci minimizes the distance between the science target and the reference psfs , whereas klip minimizes , in the statistical sense , the distance between _ any _ psfs @xmath66 in the close vicinity of references library and the @xmath45-dimensional orthonormal basis - set @xmath48 .",
    "it is in principle possible to include the target to the reference library before decomposition into principal components , but in this case astrophysical sources can be completely subtracted and forward modeling can not be carried out . while such solutions might yield slightly deeper contrasts they might yield astrophysical estimates with biases that are difficult to calibrate . in this sense loci , with well chosen parameters",
    ", might be optimal for detection while klip is more robust for characterization .    because the set of @xmath67 is not an orthonormal basis",
    ", loci requires the inversion of the covariance matrix @xmath68 , which is typically ill - conditioned .",
    "this leads to noise amplification if the inversion is not properly regularized .",
    "several approaches to regularization exist , for example eigenvalue truncation @xcite , or tikhonov regularization @xcite . with klip",
    "the regularization is implicit with the truncation of the kl basis .",
    "it is also more easily controlled because the kl set remains optimal for any value of @xmath45 .",
    "in addition , simple regularization schemes do not reduce the dimensionality of the covariance matrix , whereas klip reduces the number of references and therefore improves speed .",
    "once the kl transform has been generated for a given search area geometry , the remaining free parameter @xmath45 can be explored with minimal computation burden ( projections ) .",
    "depending on the implementation of the algorithm and the type of data , klip can lead to considerable speed increases , especially when considering klip does not require to process synthetic sources for characterization of detected signal .",
    "as far as detection is concerned the most striking difference between loci and klip resides in disk imaging . using hst cycle 10 nicmos archival data of the disk around hd 181327",
    ", we performed a global - loci and global - klip reduction over the entire image , using a carefully pre - selected reference library of 232 psfs .",
    "the disk edges imaged with klip , fig .",
    "[ fig : diskssims ] , are significantly better constrained when compared with state of the art classical psf subtraction @xcite . for comparison",
    "we show in figure [ fig : diskssims ] a loci reduction of the same object without any regularization : the self subtraction degrades the rich astrophysical information contained in the ring s edge .",
    "it is important to note that with appropriate regularization it is possible to obtain with loci a very similar result to klip .",
    "however , with loci it is not easy to model the astrophysical signal since there is no guarantee that the algorithm configuration optimal for detection will not bias the astrophysical signal .",
    "in this paper we have introduced a new algorithm for high - contrast image post - processing .",
    "klip is a cousin of existing methods ( e.g loci ) in the sense that it builds , using a quadratic cost function , a synthetic reference psf as a linear combination of references from a library .",
    "klip involves a truncated karhunen - love transform of the reference library in order to produce an optimal set of orthogonal references . the science target",
    "is then projected onto a truncated set of these eigenimages to generate the synthetic reference .",
    "we used hst nicmos data to show that klip provides detectability performances similar to loci .",
    "in addition to reducing the dimensionality of the data with the kl truncation , klip provides a linear framework that enables forward modeling of astrophysical sources by fitting directly an astrophysical model to the psf - subtracted data , without introducing degeneracies .",
    "for example the algorithm throughput for a planet candidate can be calculated semi - analytically and independently of the planet signal without having to inject synthetic companions in a reference psf . taking advantage of the properties of the kl transform , it is possible to generate a theoretical expression of the snr in subtracted images , provided that klip is applied is sufficiently small zones to be representative of the local noise around the planet candidate .",
    "the algorithm was illustrated using hst data , but it is also applicable to ground - based ifs data , and preliminary tests show that a local application is preferable in this case because of the lesser degree of correlation between psfs .",
    "the authors also thank j. b. hagan , m. perrin , s. lonsdale , t. comeau and m. russ for work and help on pipeline development ; g. schneider and d. hines for discussions on disk imaging with nicmos , and for providing the lapl reference psf library .",
    "the authors also thank c. chen , m. fitzgerald , b. mnard , c. norman , b. oppenheimer , a. sivaramakrishnan , a. szalay , g. vasisht for discussions .",
    "support for program number hst - ar-12652.01-a was provided by nasa through a grant from the space telescope science institute , which is operated by the association of universities for research in astronomy , incorporated , under nasa contract nas5 - 26555 .",
    "this work was also performed in part under contract with the jet propulsion laboratory ( jpl ) funded by nasa through the sagan fellowship program .",
    "jpl is managed for nasa by the california institute of technology .      ,",
    "l . , feldt , m. , dohlen , k. , mouillet , d. , puget , p. , wildi , f. , abe , l. , antichi , j. , baruffolo , a. , baudoz , p. , boccaletti , a. , carbillet , m. , charton , j. , claudi , r. , downing , m. , fabron , c. , feautrier , p. , fedrigo , e. , fusco , t. , gach , j .- l . , gratton , r. , henning , t. , hubin , n. , joos , f. , kasper , m. , langlois , m. , lenzen , r. , moutou , c. , pavlov , a. , petit , c. , pragt , j. , rabou , p. , rigal , f. , roelfsema , r. , rousset , g. , saisse , m. , schmid , h .-",
    "stadler , e. , thalmann , c. , turatto , m. , udry , s. , vakili , f. , & waters , r. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7014 , society of photo - optical instrumentation engineers ( spie ) conference series    , e. , thalmann , c. , vigan , a. , boccaletti , a. , chauvin , g. , augereau , j.  c. , meyer , m.  r. , mnard , f. , desidera , s. , messina , s. , henning , t. , carson , j. , montagnier , g. , beuzit , j.  l. , bonavita , m. , eggenberger , a. , lagrange , a.  m. , mesa , d. , mouillet , d. , & quanz , s.  p. 2010",
    ", , 524 , l1              , s. , oppenheimer , b.  r. , zimmerman , n. , brenner , d. , parry , i.  r. , crepp , j.  r. , vasisht , g. , ligon , e. , king , d. , soummer , r. , sivaramakrishnan , a. , beichman , c. , shao , m. , roberts , l.  c. , bouchez , a. , dekany , r. , pueyo , l. , roberts , j.  e. , lockhart , t. , zhai , c. , shelton , c. , & burruss , r. 2011 , , 123 , 74    , k.  w. , suzuki , r. , tamura , m. , abe , l. , suto , h. , kandori , r. , morino , j. , nishimura , t. , takami , h. , guyon , o. , jacobson , s. , stahlberger , v. , yamada , h. , shelton , r. , hashimoto , j. , tavrov , a. , nishikawa , j. , ukita , n. , izumiura , h. , hayashi , m. , nakajima , t. , yamada , t. , & usuda , t. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7014 , society of photo - optical instrumentation engineers ( spie ) conference series                    , a .- m . ,",
    "gratadour , d. , chauvin , g. , fusco , t. , ehrenreich , d. , mouillet , d. , rousset , g. , rouan , d. , allard , f. , gendron ,  .",
    ", charton , j. , mugnier , l. , rabou , p. , montri , j. , & lacombe , f. 2009 , a&a , 493 , l21      , b.  a. , graham , j.  r. , palmer , d.  w. , doyon , r. , dunn , j. , gavel , d.  t. , larkin , j. , oppenheimer , b. , saddlemyer , l. , sivaramakrishnan , a. , wallace , j.  k. , bauman , b. , erickson , d.  a. , marois , c. , poyneer , l.  a. , & soummer , r. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7015 , society of photo - optical instrumentation engineers ( spie ) conference series          , c. , macintosh , b. , soummer , r. , poyneer , l. , & bauman , b. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 7015 ,",
    "society of photo - optical instrumentation engineers ( spie ) conference series    , c. , macintosh , b. , & vran , j. 2010 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7736 , society of photo - optical instrumentation engineers ( spie ) conference series        , l. , crepp , j.  r. , vasisht , g. , brenner , d. , oppenheimer , b.  r. , zimmerman , n. , hinkley , s. , parry , i. , beichman , c. , hillenbrand , l. , roberts , l.  c. , dekany , r. , shao , m. , burruss , r. , bouchez , a. , roberts , j. , & soummer , r. 2012 , , 199 , 6                , c. , grady , c.  a. , goto , m. , wisniewski , j.  p. , janson , m. , henning , t. , fukagawa , m. , honda , m. , mulders , g.  d. , min , m. , moro - martn , a. , mcelwain , m.  w. , hodapp , k.  w. , carson , j. , abe , l. , brandner , w. , egner , s. , feldt , m. , fukue , t. , golota , t. , guyon , o. , hashimoto , j. , hayano , y. , hayashi , m. , hayashi , s. , ishii , m. , kandori , r. , knapp , g.  r. , kudo , t. , kusakabe , n. , kuzuhara , m. , matsuo , t. , miyama , s. , morino , j .- i . ,",
    "nishimura , t. , pyo , t .- s . ,",
    "serabyn , e. , shibai , h. , suto , h. , suzuki , r. , takami , m. , takato , n. , terada , h. , tomono , d. , turner , e.  l. , watanabe , m. , yamada , t. , takami , h. , usuda , t. , & tamura , m. 2010 , , 718 , l87"
  ],
  "abstract_text": [
    "<S> we describe a new method to achieve point spread function ( psf ) subtractions for high - contrast imaging using principal component analysis ( pca ) that is applicable to both point sources or extended objects ( disks ) . assuming a library of reference psfs , a karhunen - love transform of theses references is used to create an orthogonal basis of eigenimages , on which the science target is projected . for detection </S>",
    "<S> this approach provides comparable suppression to the locally optimized combination of images ( loci ) algorithm , albeit with increased robustness to the algorithm parameters and speed enhancement . for characterization of detected sources </S>",
    "<S> the method enables forward modeling of astrophysical sources . </S>",
    "<S> this alleviates the biases in the astrometry and photometry of discovered faint sources , which are usually associated with loci - based psf subtractions schemes . </S>",
    "<S> we illustrate the algorithm performance using archival hubble space telescope ( hst ) images , but the approach may also be considered for ground - based data acquired with angular differential imaging ( adi ) or integral - field spectrographs ( ifs ) . </S>"
  ]
}