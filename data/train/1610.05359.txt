{
  "article_text": [
    "in order to characterize planetary systems , it is common practice to assume long - term stability in order to set upper limits on planetary masses and orbital eccentricities ( e.g. * ? ? ? * ; * ? ? ? * ; * ? ? ? * ; * ? ? ? * ) .",
    "this involves running grids of direct n - body integrations over the large multi - dimensional parameter space of initial conditions that are consistent with observational error . in practice , however , one can often explore only a minute fraction of the phase space ; in the case of many systems discovered by the kepler mission , each integration requires several weeks of computation to simulate timescales comparable to the star s age ( @xmath1 planetary orbits ) with current hardware .",
    "a more efficient classifier of dynamical stability would thus be invaluable .    in this investigation",
    ", we specialize to the case of tightly packed systems , where the interplanetary separations are less than 10 mutual hill radii ( @xmath2 ) , where @xmath3 @xmath4 and @xmath5 are the masses of a pair of planets and the central star , and @xmath6 is the semimajor axis of the inner planet .",
    "this regime has long been recognized as important in the early stages of planetary systems when bodies are still merging , and has received much attention .",
    "for the special case of two - planet systems , there exists an analytic  hill criterion \" that , if satisfied , precludes close encounters between the planets for all time ( @xcite , @xcite , @xcite , but see also @xcite , @xcite and @xcite ) .",
    "however , in the general case with more than two planets , the additional degrees of freedom preclude a topological criterion for hill stability .    this has led many authors to perform suites of n - body simulations and fit empirical curves to the results .",
    "because of the prohibitively large phase space of possible initial conditions , several authors ( * ? ?",
    "? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* obertas et al . ,",
    "submitted ) have considered the special case of initially circular , planar orbits with all planet pairs having equal hill separations @xmath7 , defined as the difference in semimajor axis divided by @xmath2 .",
    "they find that instability timescales grow approximately exponentially with hill separation ; however , the fitted coefficients change as the number of planets and planetary masses are varied , and introducing inclinations @xcite , eccentricities @xcite , or unequal spacings between planets @xcite change the instability timescales substantially . for a given planetary system , it is therefore not always clear which scaling law is appropriate to apply , and what confidence one can have in the resulting estimate .    for this investigation",
    "we take a new machine learning approach .",
    "high dimensional classification tasks of this kind are ubiquitous across industry and data science , and sophisticated machine learning algorithms have been developed to tackle these problems .",
    "such techniques have been highly successful in an astronomical context for several image classification tasks , e.g. , assigning morphological types to galaxies @xcite ; however , they have seen little use in dynamical classification to date(see * ? ? ? * for a recent counterexample ) .",
    "we choose to frame the problem as a binary classification task , i.e. , predicting whether or not a given planetary system is stable ( over a given timescale ) .",
    "each  example \" ( planetary system ) is described by a set of  features \" that the algorithm uses to predict stability , in the form of a probability between 0 and 1 . in",
    "supervised machine learning , an algorithm is first trained on examples where it is told the correct answer ( stable or not stable ) . the trained algorithm can then be used to predict on new examples .      in order to train our algorithms , we generated a dataset of 5000 n - body integrations of 3-planet systems over @xmath0 orbits of the innermost body .",
    "we focus on 3-planet systems since there exists an analytic criterion for the case of two planets @xcite , and systems with more planets exhibit qualitatively similar behavior @xcite .",
    "the number of simulations and length of integration were chosen to generate a dataset at limited computational cost ( @xmath8 cpu hours ) , and assess the value of investing significant computing time to train classifiers on more astrophysically relevant timescales ( @xmath9 orbits ) . because we expect that instability timescales of @xmath0 and @xmath10 orbits are both physically driven by chirikov diffusion due to the overlap of mean - motion resonances ( see fig.2 in obertas et al . ,",
    "submitted ) , we expect the performance of models trained on this dataset to be comparable to that of similar algorithms trained on longer datasets .    with a view toward applying these models to kepler discoveries",
    ", we adopted a solar - mass star , 5 @xmath11 ( earth - mass ) planets , and drew the innermost planet s semimajor axis randomly between 0.04 and 0.06 au .",
    "we note , however , that our results are strictly scale - free , and can be applied to comparable systems with masses , orbital periods and semimajor axes expressed in terms of the star s mass , innermost planet s orbital period and semimajor axis , respectively .",
    "the second planet s semimajor axis was separated from the first by a number of mutual hill radii drawn from a uniform distribution in the range @xmath12 $ ] .",
    "the third planet s separation was then independently drawn from the same distribution , yielding unevenly spaced planets .",
    "the particular range of hill - radius separations was chosen to capture the regime of interest on our adopted timescale of @xmath0 orbits and roughly generate a balanced dataset of stable and unstable systems ( this yielded 1479 stable systems out of 5000 ) .",
    "eccentricities and inclinations were drawn independently for each planet from uniform distributions over [ 0 , 0.02 ] and [ 0 , 1@xmath13 , and the remaining angles were drawn randomly over [ 0,@xmath14 .",
    "because one only needs to integrate until the first hill sphere crossing ( once this happens , strong scatterings happen quickly , e.g. , @xcite ) , we use the efficient whfast integrator @xcite in the open - source rebound n - body package @xcite .",
    "rebound is written in ` c99 ` and comes with an optional ` python ` interface .",
    "we adopted a conservative timestep of 1% of the innermost planet s orbital period , and classified systems as unstable if any pair of planets came within 1 hill radius of each other during the simulation .",
    "binary classifiers are often evaluated on their _ precision _ ( here the fraction of systems that are actually stable when the model predicts stability ) and _ recall _ ( the fraction of systems the model predicts are stable out of the truly stable cases ) . for typical algorithms that predict probabilities of class membership , one can trade off between precision and recall by varying the threshold probability for classification .",
    "for example , a conservative model that only classifies systems as stable if it predicts a probability of stability greater than 0.99 will be right most of the times that it predicts stability ( high precision ) , but will miss all the stable systems that were assigned slightly lower probabilities ( low recall ) .",
    "the appropriate threshold depends on the application ( e.g. , if predicting dna matches for crime cases , one might set a high threshold as above to have confidence in predicted matches ) .    when comparing two models , one can plot pairs of precision and recall scores for all possible thresholds to generate a precision - recall curve .",
    "a common scalar metric for comparing classifiers is the area under this curve ( auc ) , which would be unity for a perfect model .      after experimenting with several machine learning algorithms ( random forest and support - vector machine implementations in the python scikit - learn library )",
    ", we found that gradient - boosted decision trees ( gbdt ) xgboost v0.6 @xcite yielded significantly higher auc values for our dataset .",
    "a recurring theme in machine learning is that of  overfitting , \" an algorithm s tendency to latch onto irrelevant idiosyncrasies in the training set that cause it to predict poorly on unseen examples .",
    "different algorithms therefore try to penalize overly complicated models in an effort to retain only the broad features that are likely to generalize well . in practice",
    ", the user navigates this balance between simplicity and complexity empirically , by tuning an algorithm s  hyperparameters \" that mediate this tradeoff , training it , and checking performance ( sec.[metrics ] ) on unseen data ; this process , together with trying different features to maximize performance , is known as cross - validation . in order to rule out the possibility of ( sometimes subtle ) mistakes in cross - validation yielding overly optimistic performance metrics",
    ", it can be good practice to assign a subset of the data to a holdout ( test ) set that is never seen by the algorithm during cross - validation .",
    "evaluation of the final model on the holdout set therefore provides robust metrics of the trained algorithm s expected performance on unseen examples ; consistency between the cross - validation and test scores also suggests a robust cross - validation methodology . in our case , we randomly assigned 1500 systems to a holdout test set , and used only the remaining 3500 for cross - validation .    a typical technique to reduce statistical fluctuations when comparing",
    "the performance of different sets of hyperparameters is @xmath15-fold cross validation .",
    "one begins by splitting the training examples into @xmath15 evenly sized groups ; then , for each group , one trains the model on the remaining @xmath16 chunks , and uses the remaining group to evaluate performance .",
    "the scores from the @xmath15 folds are then averaged , reducing the variance in the estimate . finally , it is generally good practice to use stratified cross - validation , whereby one ensures that each of the @xmath15 folds is assigned an approximately equal number of samples from each class ( stable and unstable ) .",
    "xgboost has several hyperparameters , so we sequentially performed grid searches through 2-dimensional cuts through the parameter space , evaluating performance through the precision - recall auc ( sec.[metrics ] ) using stratified , 5-fold cross - validation on the training set of 3500 examples .",
    "values of the final adopted hyperparameters for the algorithm are discussed in sec.[ic ] and [ shortintegrations ] can be found in table [ hyper ] .",
    ".hyperparameters used for the initial - conditions ( ic ) model ( sec.[ic ] ) and short - integrations ( si ) model ( sec.[shortintegrations ] ) , and their associated performance .",
    "scores for the lissauer - family ( lf ) model shown for comparison .",
    "[ hyper ] [ cols=\"^,^,^,^\",options=\"header \" , ]     finally , we compare the performance of this ` short - integration ' model to the previous ` initial - condition ' model .",
    "fig.[dianaplot ] shows that while both models often assign unstable systems ( blue bins ) a low predicted probability , the ` initial - condition ' model assigns stable systems ( green bins ) a wide range of predicted probabilities , translating to a lower recall .",
    "in contrast , the ` short - integration ' model more confidently assigns high predicted probabilities to stable systems , better separating the two classes . again setting the predicted probability threshold",
    "so as to obtain 90% precision , the recall improves to 68% .    in summary , generating improved features from short integrations and adopting xgboost as our algorithm provided our largest auc gains ( table [ hyper ] ) .",
    "in this investigation , we numerically integrated a dataset of 5000 three - planet systems over @xmath0 orbits .",
    "we then trained machine learning algorithms to classify systems orbital stability on this timescale .",
    "in particular , we trained two models using the xgboost algorithm : an ` initial - conditions ' model ( sec.[ic ] ) that learned only from the system s initial orbital elements , and a ` short - integration ' model ( sec.[shortintegrations ] ) that generated features from short n - body integrations .",
    "we then compared their performance to ` lissauer - family models ' that require the sum of the interplanetary separations ( expressed in mutual hill radii ) to be greater than a particular threshold .",
    "we summarize the investigated models performances in fig.[prcurves ] , which plot values for the respective classifier s precision and recall for all possible values of the probability threshold above which the model labels a system as stable . as discussed above , the appropriate choice of this threshold depends on the desired qualities of the classifier . above we advocated for conservative models that are correct 90% of the time when a system is predicted stable ( 90% precision ) .    our best machine - learning model ( right column of table[hyper ] ) :    * dominates other models at all threshold values . *",
    "recovers 2.25 as many of the stable systems in the test set ( has 2.25 times higher recall ) as a lissauer - family model at a fixed precision of 90% .",
    "* is three orders of magnitude faster than direct n - body integration . performing the short integration , generating the features and evaluating the model for a given system takes @xmath17 1 second with current technology .",
    "we note that while we have focused on making binary predictions ( stable vs. unstable ) for straightforward model comparisons , the xgboost classifier can instead output a predicted confidence for a given system between 0 and 1 .",
    "this has more information and could for example be used to estimate a prior probability distribution for fitting orbital data .",
    "an important limitation of this work are the fixed masses ( 5 earth masses around a solar - mass star ) and the comparatively short integration timescales ( @xmath0 orbits ) .",
    "our results strongly motivate investing computational time to generate datasets over longer timescales with a range in masses .",
    "such classifiers could be used in many of the ways that direct n - body integrations currently are employed , but these models dramatically improved efficiency would allow much faster and complete explorations of parameter space , e.g. :    * mapping out the stability boundary in mass - eccentricity space for observed transiting systems . *",
    "mapping out the parameter space that unseen planets could stably inhabit in a given system to guide observational follow - up strategies or theoretical considerations .",
    "* vetting low signal - to - noise detections through stability constraints . * generating a prior probability distribution describing the allowable regions of phase space for statistical or theoretical investigations . * as a stopping condition for simulations once they achieve a dynamically long - lived configuration .",
    "such tools may be of particular interest for the upcoming transiting exoplanet survey satellite ( tess ) . while transit - timing variations ( ttvs ) have been powerful tools for constraining the masses and eccentricities of near - resonant kepler systems ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , tess shorter time baselines and planets smaller semimajor axes will likely render such analyses difficult or impossible .",
    "it is therefore likely that in many systems , stability considerations will provide the strongest constraints on planetary masses and eccentricities , and this will be important for guiding the substantial radial - velocity follow - up efforts from the ground .    more broadly , we have shown that machine learning can be a powerful tool for high - dimensional classification problems in dynamics .",
    "but in addition to their predictive power , our models also revealed new insights into the underlying physics .",
    "in particular , the most informative features in our model based on short integrations were the variations in the middle planet s semimajor axis .",
    "this suggests that the orbital instabilities are driven by the overlap of mean motion resonances ( which vary the semimajor axes ) rather than the secular chaos at work in our own solar system @xcite , which keeps semimajor axes approximately constant .",
    "we would like to thank david kipping for an insightful review and fred rasio for helpful comments . both greatly improved the accuracy and presentation of this work .",
    ", m.a . and c.h .",
    "were supported by fellowships through the university of toronto s centre for planetary sciences , and d.t .",
    "also gratefully acknowledges support from the jeffrey l. bishop fellowship .",
    "29 natexlab#1#1url # 1`#1`urlprefix[2][]#2 [ 2]#2 , , . .",
    ", , , . . ,",
    ", , , . . ,",
    ", , , , . . ,",
    ", , , , , , , . . ,",
    ", , , , , , , , , , et  al . , .",
    "volume  . .",
    ", , , , , , , , , , et  al . , . .",
    ". , . . , . , ,",
    ". . , . , ,",
    ", , , , , , , , , , et  al . , . .",
    ", , , , . . ,"
  ],
  "abstract_text": [
    "<S> the requirement that planetary systems be dynamically stable is often used to vet new discoveries or set limits on unconstrained masses or orbital elements . </S>",
    "<S> this is typically carried out via computationally expensive n - body simulations . </S>",
    "<S> we show that characterizing the complicated and multi - dimensional stability boundary of tightly packed systems is amenable to machine learning methods . </S>",
    "<S> we find that training an xgboost machine learning algorithm on physically motivated features yields an accurate classifier of stability in packed systems . on the stability timescale investigated ( @xmath0 orbits ) , it is 3 orders of magnitude faster than direct n - body simulations . </S>",
    "<S> optimized machine learning classifiers for dynamical stability may thus prove useful across the discipline , e.g. , to characterize the exoplanet sample discovered by the upcoming transiting exoplanet survey satellite ( tess ) . </S>",
    "<S> this proof of concept motivates investing computational resources to train algorithms capable of predicting stability over longer timescales and over broader regions of phase space . </S>"
  ]
}