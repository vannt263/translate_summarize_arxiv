{
  "article_text": [
    "important in both fundamental science and numerous applications , optimization problems of various degrees of complexity are challenging ( see  @xcite for an excellent introduction ) .",
    "optimization conditioned by constraints that may vary from event to event is of especial theoretical and practical importance . as a first example , when dealing with a system under a random potential , each realization of the random potential demands a separate optimization resulting in a different ground state .",
    "the thermodynamic behavior of such a system in a quenched random potential crucially depends on the random potential realized .",
    "a similar but practical problem may arise in routing passengers at various cities to reach their destinations . in the latter case ,",
    "the optimal routing depends on the number of passengers at various locations , the costs from one location to the others , which likely to vary from time to time .",
    "this type of conditional optimization also occurs in modern proteomics problem , that is , in the mass spectrometry ( ms ) based peptide sequencing . in this case , each tandem ms ( ms@xmath0 ) spectrum constitute a different condition for optimization which aims to find a database peptide or a _ de novo _ peptide to best explain the given ms@xmath0 spectrum .    when the cost function of an optimization problem can be expressed as a sum of independent local contributions , the problem usually can be solved using the transfer matrix method that is commonly employed in statistical physics .",
    "a well - studied example of this sort in statistical physics is the directed polymer / path in a random medium ( dprm )  @xcite .",
    "even when a small non - local energetics is involved , the transfer matrix approach still proves useful  @xcite . as an example , the close relationship between the dprm problem and ms - based peptide sequencing , where a small nonlocal energetics is necessary to enhance the peptide identifications , was sketched in an earlier publication  @xcite and the cost value distribution from many possible solutions other than the optimal one is explored .",
    "indeed , obtaining the cost value distribution from _ all _ possible solutions in many cases is harder than finding the optimal solution alone . in this paper",
    ", we will provide the solution to a generic problem that enables a full characterization of the peptide sequencing score statistics , instead of just the optimal peptide .",
    "the 1d problem considered is essentially a hopping model in the presence of a random potential .",
    "the solution to this problem may also be useful in other applications such as in routing of passengers and even internet traffic .    in what follows",
    ", we will first introduce the generic 1d hopping model in a random potential , followed by its transfer matrix ( or dynamic programming ) solution .",
    "we then discuss the utility of this solution in the context of ms - based peptide sequencing , and demonstrate with real example from mass spectrum in real ms - based proteomics experiments . in the discussion section , we will sketch the utility of the transfer matrix solution in other context and then conclude with a few relevant remarks .",
    "along the @xmath1-axis , let us consider a particle that can hop with a set of prescribed distances @xmath2 towards the positive @xmath3 direction .",
    "that is , if the particle is currently at location @xmath4 , it can move to location @xmath5 , @xmath6 , ",
    "@xmath7 in the next time step . at each hopping step",
    ", the particle will accumulate an energy @xmath8 from location @xmath1 that it just visited .",
    "the score @xmath9 ( negative of the on - site potential energy ) is assumed positive and may only exist at a limited number of locations . for",
    "locations that @xmath9 do not exist , we simply set @xmath10 there .",
    "the energy of a path starting from the origin specified by the sequential hopping events @xmath11 would have visited locations @xmath12 with @xmath13 and has energy @xmath14 in general , there can be more than one path terminated at the same point . treating each path as a state with energy given by @xmath15 ,",
    "one ends up having the following recursion relation for the partition function @xmath16 [ pf_global.0 ] z(x ) = _",
    "i=1^k e^s(x - m_i ) z(x - m_i ) , where @xmath17 plays the role of inverse temperature ( with @xmath18 chosen ) .",
    "if one were only interested in the best score terminated at point @xmath1 , it will be given by the zero temperature limit @xmath19 and the recursion relation may be obtained by taking the logarithm on both sides of ( [ pf_global.0 ] ) and divided by @xmath20 then taking @xmath19 limit to reach [ pf_zt_best ] s_best(x ) = _ 1i k \\ { s(x - m_i)+s_best(x - m_i ) } , where @xmath21 records the best path score among all paths reaching position @xmath1 .",
    "this update method , also termed dynamic programming , records the lowest energy and lowest energy path reaching a given point @xmath1 .",
    "the lowest energy among all possible at position @xmath1 is simply @xmath22 and the associated path can be obtained by tracing backwards the incoming steps .",
    "it is interesting to observe that one can also obtain the worst score at each position via dynamical programming [ pf_zt_worst ] s_worst(x ) = _ 1i k \\ { s(x - m_i)+s_worst(x - m_i ) } .",
    "the full thermodynamic characterization demands more information than the ground state energy . in principle , one may obtain the full partition function using eq .",
    "( [ pf_global.0 ] ) evaluated at various temperatures .",
    "this procedure , however , hinders analytical property such as determination of the average energy @xmath23 a better starting point may be achieved if one can obtain the density of states @xmath24 . in this case , we have z & & de e^-e d(e ) + e & = & .note that if the ground energy @xmath25 of the system is bounded from below , the partition function is simply a laplace transform of a modified density of states given by @xmath26 where @xmath27 and @xmath28 this implies that the density of states @xmath24 together with the ground state energy @xmath25 determine all the thermodynamic behavior of the system . in the next section",
    ", we will explain how to obtain the density of states using the dynamical programming technique as well as how to extend this approach to more complicated situations that will be useful in characterizing the score statistics in ms - based peptide sequencing .",
    "the density of states is related to the energy histogram in a simple way .",
    "the number of states between energies @xmath29 and @xmath30 ( with @xmath31 ) is given by @xmath32 . if we happen to use @xmath33 as the energy bin size for energy histogram , the count @xmath34 in the bin with energy @xmath29",
    "is simply @xmath35 and the density of states @xmath36 . for simplicity",
    ", we will assume that the all the on - site energies @xmath8 are integral multiple of @xmath37 .",
    "this implies that each path energy / score is also an integral multiple of @xmath33 . in the following subsections",
    ", we will use score density of states instead of energy density of states .",
    "we denote by @xmath38 the number of paths reaching position @xmath1 with score @xmath39 . with this notation ,",
    "we can easily write down the recursion relation for @xmath38 as follows [ s.dos ] c(x , n ) = _ i=1^k c(x - m_i , n- ) .",
    "this recursion relation allows us to compute the density of states in the same manner as computing the partition function ( [ pf_global.0 ] ) except that we need to have an additional dimension for score at each position @xmath1 . as an even simpler application of this recursion relation ,",
    "suppose that one is only interested in the number of paths reaching position @xmath1 , one may sum over the energy part on both side of ( [ s.dos ] ) and arrives at [ p_count ] c(x ) = _ i c(x - m_i ) , which enables a very speedy way to compute the total number of paths reaching position @xmath1 .",
    "in the context of _ de novo _ peptide sequencing  @xcite , this number corresponds to the total number of all possible _ de novo _ peptides within a given small mass range .",
    "although simply obtained , this number may be useful for providing rough statistical assessment in _ de novo _ peptide sequencing .      in general , one may wish to associate with each hop an energy @xmath40 or one may wish to introduce some kind of score normalization based on the number of hopping steps .",
    "this is indeed the case when applying this framework to ms - based peptide sequencing where a peptide length factor adding or multiplying to the overall raw score is a common practice . in this case",
    ", it becomes important to keep track the number of hops made in each path .",
    "we may further categorize the counter @xmath38 into @xmath41 .",
    "that is , we may separate the paths with different number of steps from one another and arrive at a finer counter @xmath42 which records the number of paths reaching position @xmath1 with score @xmath39 and with @xmath43 hopping steps .",
    "it is rather easy to write down the recursion relation obeyed by this fine counter [ sl.dos ] c(x , n , l ) = _",
    "i=1^k c(x - m_i , n-,l-1 ) .",
    "this recursion relation allows us to renormalize the raw score based on the number of steps taken .",
    "for example , for raid_dbs  @xcite , a database search method we developed , we divide the raw score obtained by @xmath44 for any peptide ( path ) of @xmath43 amino acids ( hopping steps ) to get better sensitivity in peptide identification .    in principle , the recursion relations given by ( [ s.dos]-[sl.dos ] ) are all one - dimensional updates .",
    "the only difference is the internal structure of counters at each position @xmath1 . for ( [ p_count ] ) ,",
    "the counter is just an integer and has no further structure . for ( [ s.dos ] ) ,",
    "the counter at each position has a 1d structure indexed by the score . for ( [ sl.dos ] ) ,",
    "the counter at each position @xmath1 has a 2d structure indexed by both the score and the number of hopping steps .",
    "this means that in terms of solving the problem using dynamical programming , it is always a 1d dynamical programming with different degrees of internal structure that may lengthen the execution time when shifting from the simplest case ( [ p_count ] ) to the more complicated case ( [ sl.dos ] ) . obviously at each position",
    "@xmath1 , there is an upper bound and a lower bound for score and also for the number of hopping steps accumulated .",
    "we shall call them @xmath21 , @xmath45 , @xmath46 and @xmath47 respectively .",
    "the first two quantities may be obtained by eqs .",
    "( [ pf_zt_best ] ) and ( [ pf_zt_worst ] ) respectively .",
    "we provide the recursions for the two latter quantities below l_max(x ) & = & _ 1i k \\ { l_max(x - m_i ) } + 1 [ l_max ] , + l_min(x ) & = & _ 1i k \\ { l_min(x - m_i ) } + 1 [ l_min ] .",
    "( [ pf_zt_best]-[pf_zt_worst ] ) and ( [ l_max]-[l_min ] ) provides the ranges for both the scores and the number of cumulative hopping steps at each position @xmath1 via simple dynamic programming . as we will discuss later",
    ", this information enables a memory - efficient computations of score histograms .",
    "in this section , we focus on an important subject in modern biology  using ms data to identify the numerous peptides / proteins involved in any given biological process . because of the peptide mass degeneracies and the limited measurement accuracy for the peptide mass - to - charge ratio , using ms@xmath0 spectra is more effective in peptide identifications . in a ms@xmath0 setup ,",
    "a selected peptide with its mass identified by the first spectrometer is fragmented by noble gas , and the resulting fragments are analyzed by a second mass spectrometer .",
    "although such ms@xmath0-based proteomics approaches promise high throughput analysis , the confidence level assignment for any peptide / protein identified is challenging .",
    "the majority of peptide identification methods are so - called database search approaches .",
    "the main idea is to _ theoretically _ fragment each peptide in a database to obtain the corresponding _ theoretical _ spectra .",
    "one then decides the degree of similarity between each theoretical spectrum and the input query spectrum using a scoring function .",
    "the candidate peptides from the database are ranked / chosen according to their similarity scores to the query spectrum .",
    "although one may assign relative confidence levels among the candidate peptides via various ( empirical ) means , an objective , standardized calibration exists only recently  @xcite . in our earlier publications",
    "@xcite , we proposed to tackle this difficulty by using a _ de novo _ sequencing method to provide an objective confidence measure that is both database - independent and takes into account spectrum - specific noise . in this paper , we will provide concrete algorithms for such purpose .    to begin , consider a spectrum @xmath48 with parent ion mass range @xmath49 $ ] , we denote by @xmath50 the set of all `` possible '' peptides with masses in this range .",
    "given a peptide @xmath51 from @xmath50 , the associated quality score @xmath52 is defined by a _ prescribed _ scoring system .",
    "the score distribution of @xmath52 within @xmath50 provides naturally a likelihood measure for any given peptide @xmath51 to the the correct one .    however , as described earlier  @xcite , this seemingly straightforward idea faces two difficulties in terms of implementations .",
    "first , unlike the dprm problem for which the function to be optimized is defined without ambiguity , the choice of the scoring function is somewhat empirical because the parameters used in the scoring must be trained using a training data set .",
    "further , because of different instruments and experimental setups , it seems impossible to design a scoring system such that the correct peptide for each spectrum has the highest score among _ all possible _ peptides ; the application of a given scoring function to general cases may require a leap of faith .",
    "second , even after the scoring function is chosen , it is not known how to find the peptide @xmath53 that maximizes @xmath54 as well as the score distribution @xmath55 within @xmath50 other than by the generally impractical procedure of examining all members of @xmath50 .",
    "the first difficulty can be alleviated by validating high scoring _",
    "de novo _ peptides via database searches  @xcite and is not the main focus of the current paper .",
    "note that a partial solution to the second problem via iterative mapping when nonlocal score contributions exist is provided earlier  @xcite . here",
    "we tackle the second problem head on when the scoring function used does not contain nonlocal contribution other than a final renormalization with respect to the peptide length .",
    "our algorithms contains two parts : computer memory allocations and dynamical programming update .",
    "prior to discussing these two parts , however , we first address the important issue of choosing a good mass unit .",
    "the goal here is to choose a mass unit @xmath56 and expresses the molecular mass of each amino acid as an integral multiple of this unit .",
    "for example , one may choose @xmath56 to be @xmath57 dalton ( da ) , and round the molecular mass of each amino acid to be an integral multiple of @xmath57 da .",
    "once a mass unit is chosen , all the masses under consideration are integral multiples of this unit .",
    "it turns out that different choices of the mass unit leads to different maximum cumulative mass error . as a specific example , consider using @xmath58 da as the mass unit .",
    "the mass of alanine , with true mass @xmath59 da , is now represented as @xmath60 .",
    "this molecular mass expression is @xmath61 da smaller than the true molecular mass of alanine . when this happens , the integral mass representation has a mass smaller than the true mass , and we call such type of mass error a _ down_-error .",
    "now the amino acid tryptophan with molecular mass @xmath62 da will be assigned an integral mass of @xmath63 , which has an extra of @xmath64 da compared to the true mass .",
    "we call this type of mass error the _ up_-error .    the ratio of the mass error to the real molecular mass when multiplied by @xmath65 da provides the cumulative maximum error that can be induced by a single amino acid at @xmath66 da mass . for a fixed mass unit , we went over this mass error analysis for each of the twenty amino acids and documented the largest up - error and down - error .",
    "the larger one between the maximum up - error and the maximum down - error is called the max - error . to search for best mass units that minimize the max - error at @xmath66 da",
    ", we went over all possible mass unit ranging from @xmath67 da to @xmath68 da in step of @xmath69 da .",
    "interestingly enough , we found a discrete list of mass units that have smaller max - error compared to their nearby mass units .",
    "these numerically found _ magic _ mass units are summarized in table  [ tab.magic ] .    [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     once a mass unit is chosen , all the amino acid masses are effectively integers . to obtain the score histogram of _ all _ _ de novo",
    "_ peptides when queried by a spectrum @xmath48 with parent molecular mass @xmath70 ( with n- and c- terminal groups of the peptide stripped away ) , we first construct a mass array where index @xmath71 corresponds a molecular mass @xmath72 . to encode all possible peptides with molecular mass up to @xmath70 , we need to have an array of size @xmath73 .",
    "apparently , when a larger mass unit is used , the size of the mass array is smaller and thus reduces computation time .",
    "however , as one may see from table  [ tab.magic ] , the larger mass unit is also accompanied by a larger max - error and might not be preferred when high mass accuracy is the first priority .",
    "the basic idea of our algorithm is to encode all possible peptides in the mass array by linking pointers , analogous to the consecutive hopping steps in the 1d hopping model . for an amino acid @xmath74 ,",
    "let @xmath75 represents its corresponding integer mass in unit of @xmath56 .",
    "for a peptide made of @xmath76 $ ] , it will have a hopping trajectory in the molecular array given by @xmath77 $ ] with @xmath78 .",
    "let us also denote @xmath79 by @xmath80 to indicate that it is the terminating point of the path .",
    "apparently , all possible peptides with molecular masses equal to @xmath81 will all have corresponding hopping paths starting at the origin and terminating at @xmath80 . through appropriate pointer linking , one may therefore encode _ all _ possible peptides with molecular mass @xmath81 in a one - dimensional mass array .    for a given spectrum @xmath48 , depending on the score function used ,",
    "one may calculate local score contributions at each mass index .",
    "this step is done once only for the whole mass array , and need not be repeated for each candidate peptide . in a typical ms@xmath0 experimental spectrum , there always exists some level of parent ion mass uncertainty .",
    "once the size of the mass uncertainty is specified , we only need to examine _ de novo _ peptides whose corresponding hopping paths terminating at a few consecutive mass indices .",
    "this indicates that some of the mass indices of the aforementioned mass array may not even be used in this context .",
    "below we describe how to efficiently obtain _ relevant mass indices _ and only allocate computer memories for those masses .",
    "assume that the possible terminating points are @xmath82 with @xmath83 .",
    "the update rules described in eqs .",
    "( [ pf_zt_best]-[pf_zt_worst ] ) , ( [ p_count ] ) , and ( [ l_max]-[l_min ] ) will also be used at this stage .",
    "the following pseudocode describes our algorithm .",
    "initialize the mass_index = 0 entry + @xmath84 ; @xmath85=1 ; + remark : max_aa is the maximum number of amino acids considered + for ( aa_index = 0 ; aa_index @xmath86 max_aa ; aa_index + + ) \\ { + label occupancy of n(aa_index ) ; + at n(aa_index ) attach a pointer back to 0 ; + update @xmath87 , @xmath88 , @xmath89 , @xmath90 , @xmath85 at n(aa_index ) ; + } + for ( mass_index = 1 ; mass_index @xmath91 ; mass_index + + ) \\ { + if ( mass_index occupied ? ) \\ { + for ( aa_index = 0 ; aa_index @xmath86 max_aa ; aa_index + + ) \\ { + label occupancy of ( mass_index + n(aa_index ) ) ; + at mass_index+n(aa_index ) attach a pointer to mass_index ; + update @xmath87 , @xmath88 , @xmath89 , @xmath90 , @xmath85 at ( mass_index + n(aa_index ) ) ; + } + } + } + for ( mass_index = @xmath92 ; mass_index @xmath93 ; mass_index )\\ { + backtrack all possible paths @xmath94 final occupied entries ; + } +    the last step in the algorithm above identifies _ relevant mass indices _ , mass_indices that will be traversed by the hopping paths of all peptides with molecular masses in the range @xmath95 $ ] . we only need to allocate computer memory associated with those sites .",
    "for each of these relevant sites , we also know the values of @xmath87 , @xmath88 , @xmath89 , @xmath96 , and the total number of peptides reaching that site through the algorithm above . one may therefore allocate a 2d array of size @xmath97 for each relevant mass_index @xmath98 for later use .      once memory allocation for relevant mass_indices",
    "is done , we can efficiently go through those relevant sites to obtain the 2d score histogram that we mentioned . in the pseudocode",
    "below , update is performed using eq .",
    "( [ sl.dos ] ) .",
    "we now demonstrate the very simple main algorithm    initialize all the fine counters @xmath99 + except @xmath100=1 ; + for ( aa_index = 0 ; aa_index @xmath86 max_aa ; aa_index + + ) \\ { + update @xmath42 at @xmath101n(aa_index ) ; + } + for ( mass_index in ascendingly ordered _",
    "relevant mass_indices_)\\ { + for ( aa_index = 0 ; aa_index @xmath86 max_aa ; aa_index + + ) \\ { + update @xmath42 at @xmath102(mass_index + n(aa_index ) ) ; + } + } +    we now define the final 2d counter [ 2dhist_final ] y(n , l ) _ i=1^k c(f_i , n , l ) . apparently , in the 1d hopping model when allowing @xmath71 consecutive terminating points , the resulting density of states @xmath24 can now be expressed as @xmath103 . if one were interested in normalizing the final score in a path - length dependent manner , one will has the following generic transformation h(e ) = _ lde ( e - f(e,l ) ) where @xmath104 is a generic length - normalized energetic function that takes the raw energy @xmath105 with @xmath43 hopping steps and turn them into a new energy @xmath104 , and @xmath106 is understood .    using a real experimental ms@xmath0 spectrum of parent ion mass @xmath107 da and a raw scoring function ( raid_dbs  @xcite raw score without divided by @xmath44 with @xmath43 being the peptide length ) , we obtained a 2d score histogram . from this 2d score histogram",
    ", we can compute the average peptide length @xmath108 as well .",
    "we then transform the 2d score histogram using two different @xmath109 functions . in the first case , @xmath110 , meaning that one just divides the score by a constant given by @xmath111 . in the second case",
    ", we use the raid_dbs scoring function where @xmath112 . in figure",
    "[ fig1 ] , we show the two resulting score histograms along with the fits to theoretical distribution function  @xcite . as one may see from the figure , both histograms are well fitted by the theoretical distribution function over at least 15 order of magnitudes .",
    "there is difference , however , in the histograms obtained .",
    "in the first case , where the score is merely divided by the average length , we have a wider score distribution than that of the second case .",
    "this implies that a high scoring hit out of the first type of scoring function will have a larger @xmath113-value than that of the second type .",
    "this is perfectly reasonable because when using the first type of raw scoring , very long peptides which by random chances are more likely to hit on fragment peaks in the mass spectrum are less penalized than the shorter peptides . as a consequence ,",
    "one anticipates more false long peptides out of the first type of scoring method than that of the second scoring method .",
    "therefore , one should assign a larger @xmath113-value to the former case and a smaller @xmath113-value to the latter case .",
    "it is apparently important to be able to obtain score histograms of the second scoring method .",
    "however , this can only be achieved if one keeps the length information in the dynamical programming update , see eq .",
    "( [ sl.dos ] ) .",
    "our method may also be extended to other applications . in the case of passenger routings ,",
    "the @xmath1-axis actually represents time .",
    "the local score may be viewed as the additional cost that may vary for different stops . once the problem is laid out",
    ", the 2d histogram obtained from our solution indicates the number of equivalent routes in terms of additional costs and the total number of stops .",
    "this problem should be interesting in its own right .    in this paper , we developed a new approach to obtain the density of states of a 1d hopping problem in random potential .",
    "we have extended the simplest case scenario and have shown that we can apply this method to provide a _",
    "complete _ score histogram for ms - based peptide sequencing problem .",
    "this important information may be used for a more objective statistical significance assignment in peptide identification .",
    "our algorithm may also serve as a speedy _ de novo _ algorithm .",
    "if one is only interested in getting the best scoring peptide with length normalized score , one only needs to keep track of @xmath114 .",
    "furthermore , it is straightforward to include in our _ de novo _ algorithm post - translationally modified amino acids .",
    "the effect is simply an enlargement of the alphabet .",
    "that is , instead of having 20 amino acids , we will simply have more allowed masses but without needing to change any part of the algorithm .",
    "in the near future , we would like to build a web application that allows the users to obtain information of interest .",
    "for example , a user might be interested in knowing : given a parent ion molecular mass and a mass error tolerance , how many _ de novo _ peptides can there be ?",
    "furthermore , we plan to provide users with the full score histogram when a query spectrum is provided and a scoring method is chosen .",
    "our approach , founded on statistical physics , can easily address this type of questions to provide useful information for biological researches .",
    "this work was supported by the intramural research program of the national library of medicine at the national institutes of health ."
  ],
  "abstract_text": [
    "<S> we provide a complete thermodynamic solution of a 1d hopping model in the presence of a random potential by obtaining the density of states . </S>",
    "<S> since the partition function is related to the density of states by a laplace transform , the density of states determines completely the thermodynamic behavior of the system . </S>",
    "<S> we have also shown that the transfer matrix technique , or the so - called dynamic programming , used to obtain the density of states in the 1d hopping model may be generalized to tackle a long - standing problem in statistical significance assessment for one of the most important _ proteomic _ tasks  peptide sequencing using tandem mass spectrometry data .    statistical significance , dynamic programming , mass spectrometry , directed paths in random media , peptide identification </S>"
  ]
}