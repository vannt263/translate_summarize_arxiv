{
  "article_text": [
    "hodgkin - huxley - type neuronal models can be broadly classified into two classes , according to the nature of their transition to spiking in response to an injected current @xcite .",
    "neuronal models with so - called _ class i _ excitability , generate action potentials with arbitrarily low frequency , depending on the strength of the applied current .",
    "this occurs when a resting state disappears through a saddle - node bifurcation .",
    "in contrast , in neurons with _ class ii _ excitability the action potentials are generated with a finite frequency .",
    "this occurs when the resting state loses stability via a hopf bifurcation .",
    "the qif neuron is the canonical model for _ class i _ neurons , and thus generically describes their dynamics near the spiking threshold @xcite .",
    "our aim here is to derive the fres corresponding to a heterogeneous all - to - all coupled population of @xmath0 qif neurons .",
    "the correspondence is exact in the thermodynamic limit , i.e.  when @xmath1 ( this convergence has been recently studied in @xcite ) .",
    "the microscopic state of the population of qif neurons is given by the membrane potentials @xmath2 , which obey the following ordinary differential equations  @xcite : @xmath3 here the overdot denotes the time derivative , and @xmath4 represents an input current .",
    "each time a neuron s membrane potential @xmath5 reaches the peak value @xmath6 , the neuron emits a spike and its voltage is reset to the value @xmath7 . in our analysis",
    "we consider the limit @xmath8 .",
    "this resetting rule captures the spike reset as well as the refractoriness of the neuron . without loss of generality",
    "we have rescaled the time and the voltage in to absorb any coefficients which would have appeared in the first two terms .",
    "the form for the input currents is :    @xmath9    where the external input has a heterogeneous , quenched component @xmath10 as well as a common time - varying component @xmath11 , and the recurrent input is the synaptic weight @xmath12 times the mean synaptic activation @xmath13 , which is written : @xmath14 here , @xmath15 is the time of the @xmath16th spike of @xmath17th neuron , @xmath18 is the dirac delta function , and @xmath19 is the normalized synaptic activation caused by a single pre - synaptic spike with time scale @xmath20 , e.g.  @xmath21 .      in the thermodynamic limit @xmath22 , we drop the indices in eqs .  , and",
    "denote @xmath23 as the fraction of neurons with membrane potentials between @xmath24 and @xmath25 , and parameter @xmath26 at time @xmath27 .",
    "accordingly , parameter @xmath26 becomes now a continuous random variable distributed according to a probability distribution function @xmath28 . the total voltage density at time @xmath27 is then given by @xmath29 .",
    "the conservation of the number of neurons leads to the following continuity equation : @xmath30=0 , \\label{cont}\\ ] ] where we have explicitly included the velocity given by and .",
    "the continuity equation without temporal forcing @xmath31 has a trivial stationary solution . for each value of @xmath26",
    ", this solution has the form of a lorentzian function : @xmath32 .",
    "physically , the lorentzian density means that firing neurons with the same @xmath26 value will be scattered with a density inversely proportional to their speed , i.e.  they will accumulate at slow places and thin out at fast places on the @xmath24 axis .",
    "in addition , for those @xmath26 values corresponding to quiescent neurons , the density @xmath33 collapses at the rest state in the form of a dirac delta function .",
    "next we assume that , independently of the initial condition , solutions of generically converge to a lorentzian - shaped function , so that all relevant dynamics occur inside that lower dimensional space . this fact is mathematically expressed by the following lorentzian ansatz ( la ) for the conditional density functions : @xmath34 ^ 2 + x(\\eta , t)^2 } , \\label{la}\\ ] ] which is a lorentzian function with time - dependent half - width @xmath35 and center at @xmath36 . in the following",
    "we assume that the la completely describes the macroscopic dynamics of the network of qif neurons and postpone the mathematical justification of its validity to sec .",
    "[ validity ] .",
    "the half - width @xmath35 of the la has a particularly simple relation with the firing rate of the neuronal population ( i.e.  the number of spikes per unit time ) .",
    "indeed , the firing rate for each @xmath26 value at time @xmath27 , @xmath37 , can be computed by noting that neurons fire at a rate given by the probability flux at infinity : @xmath38 .",
    "the limit @xmath39 on the right hand side of this equation can be evaluated within the la , and gives the simple identity @xmath40 the ( total ) firing rate @xmath41 is then @xmath42 additionally , the quantity @xmath36 is , for each value of @xmath26 , the mean of the membrane potential : @xmath43 here we take the cauchy principal value , defined as @xmath44 , to avoid the otherwise ill - defined integral .",
    "the mean membrane potential is then @xmath45      substituting the la into the continuity equation , we find that , for each value of @xmath26 , variables @xmath46 and @xmath47 must obey two coupled equations which can be written in complex form as @xmath48 .",
    "\\label{w}\\ ] ] where @xmath49 . closing this equation",
    "requires expressing the mean synaptic activation @xmath13 as a function of @xmath50 .",
    "the simplest choice is to take the limit of infinitely fast synapses , @xmath51 in , so that we get an equality with the firing rate : @xmath52 .",
    "this allows for the system of qif neurons - to be exactly described by eqs .   and ; an infinite set of integro - differential equations if @xmath28 is a continuous distribution .",
    "equation is useful for general distributions @xmath28 ( see appendix b ) , but a particularly sharp reduction in dimensionality is achieved if @xmath26 is distributed according to a lorentzian distribution of half - width @xmath53 centered at @xmath54 : @xmath55 note that this distribution accounts for the quenched variability in the external inputs .",
    "the fact that it is lorentzian is unrelated to the la for the density of membrane potentials . assuming the integrals in and can be evaluated closing the integral contour in the complex @xmath26-plane and using the residue theorem from real @xmath26 into complex - valued @xmath56 .",
    "this is possible into the lower half - plane @xmath57 , since this guarantees the half - width @xmath35 remains positive zero : @xmath58 at @xmath59 .",
    "therefore we closed the integrals in and with an arc @xmath60 with @xmath61 and @xmath62 .",
    "this contour encloses one pole of the lorentzian distribution , which written in partial fractions reads : @xmath63 $ ] . ] .",
    "notably , the firing rate and the mean membrane potential depend only on the value of @xmath64 at the pole of @xmath28 in the lower half @xmath26-plane : @xmath65 as a result , we only need to evaluate at @xmath66 , and thereby obtain a system of fres composed of two ordinary differential equations    [ fre ] @xmath67    this nonlinear system describes the macroscopic dynamics of the population of qif neurons in terms of the population firing rate @xmath68 and mean membrane potential @xmath69",
    ".    it is enlightening to compare mean - field model with the equations of the spiking neurons . note that eq .",
    "resembles equations   and for the individual qif neuron , but _ without spike resetting_. indeed , the macroscopic firing - rate variable @xmath68 enters as a negative feedback term in eq .  , and impedes the explosive growth of the mean membrane potential @xmath69 .",
    "this negative feedback , combined with the coupling term on the right hand side of , describe the effective interaction between the firing rate and mean membrane potential at the network level .",
    "therefore , the fres describe the effect of the single - cell spike generation and reset mechanism at the network level .    in the following",
    "we examine the dynamics described by eq .  , and show that they fully reproduce the macroscopic dynamics of the network of qif neurons , even during episodes of strong spike synchrony .          to begin with the analysis of eq .",
    ", we first note that in the absence of forcing , @xmath31 , the only attractors of are fixed points .",
    "figure  [ fig1](a ) shows a phase diagram of the system as a function of the mean external drive @xmath70 and synaptic weight @xmath12 , both normalized by the width of the input distribution . , @xmath71 , @xmath72 , @xmath73 , and @xmath74 .",
    "] there are three qualitatively distinct regions of the phase diagram : 1 - a single stable node corresponding to a low - activity state ( white ) , 2 - a single stable focus ( spiral ) generally corresponding to a high - activity state ( gray ) , and 3 - a region of bistability between low and high firing rate ( cyan ; see a phase portrait of this region in fig .",
    "[ fig1](d ) ) .",
    "comparison of a sample bifurcation diagram of the fixed points from numerical simulation of networks of qif neurons with that obtained from the fres shows an excellent correspondence , see fig .",
    "[ fig1](b , c ) .",
    "a similar phase diagram can be readily reproduced by traditional heuristic firing - rate models , with one significant qualitative difference : the presence of a stable focus and hence damped oscillations . specifically , in the gray region of the phase diagram in fig .",
    "[ fig1](a ) , the system undergoes oscillatory decay to the stable fixed point .",
    "this oscillatory decay occurs as well for the high - activity state over a large extent of the region of bistability ( cyan ) , see e.g.  fig .",
    "[ fig1](d ) .",
    "the presence of damped oscillations at the macroscopic level reflects the transitory synchronous firing of a fraction of the neurons in the ensemble .",
    "this behavior is common in spiking neuron models with weak noise , and is not captured by traditional firing rate models ( see e.g. @xcite ) .      to show that the fres   fully describe the macroscopic response of the population of qif neurons to time - varying stimuli ( up to finite - size effects ) , we consider two types of stimulus @xmath11 : 1 - a step function and 2 - a sinusoidal forcing . in both cases",
    "we simulate the full system of qif neurons and the fres .",
    "figure  [ fig2 ] shows the system s response to the two different inputs . in both cases",
    "the system is initially ( @xmath75 ) in a bistable regime and set in the low activity state , with parameters corresponding to those of fig .",
    "[ fig1](d ) . left panels of fig .",
    "[ fig2 ] show the response of the system to a step current , applied at @xmath76 .",
    "the applied current is such that the system abandons the bistable region see fig .",
    "[ fig1](a) and approaches the high activity state , which is a stable focus .",
    "this is clearly reflected in the time series @xmath77 , where the rate equations   exactly predict the damped oscillations exhibited by the mean - field of the qif neurons .",
    "the raster plot in panel ( e ) shows the presence of the oscillations , which is due to the transitory synchronous firing of a large fraction of neurons in the population .",
    "finally , at @xmath78 , the current is removed and the system converges again , showing damped oscillations to the new location of the ( focus ) fixed point , which clearly coexists with the stable node where it was originally placed ( @xmath75 ) .",
    "the right hand panels of fig .",
    "[ fig2 ] show the response of the model to a periodic current , which drives the system from one side of the bistable region to the other . as a result",
    ", we observe periodic bursting behavior when the system visits the stable focus region of the phase diagram fig .",
    "[ fig1](a ) .    to further illustrate the potential of the fres   to predict and investigate complex dynamics in ensembles of spiking neurons , we present here a simple situation where the system of qif neurons exhibits macroscopic chaos .",
    "this is observed by increasing the frequency @xmath79 of the sinusoidal driving , so that the system can not trivially follow the stable fixed point at each cycle of the applied current .    .",
    "( a ) phase diagram with the regions where chaos is found , obtained using the rate model  . in the black - shaded region",
    ", there is only one chaotic attractor , whereas in the cyan region the chaotic attractor coexists with a periodic attractor .",
    "dotted lines correspond to the bistability boundary of fig .",
    "[ fig1](a ) , depicted to facilitate comparison .",
    "( b ) chaotic trajectory obtained simulating the fres ; the lyapunov exponent is @xmath80 .",
    "( c ) chaotic trajectory obtained from the qif neurons parameters corresponding to the ( yellow ) triangle symbol in panel ( a ) .",
    "( d ) time series for the rate model ( orange ) and qif model ( black ) .",
    "( e ) raster plot corresponding to 300 randomly selected neurons .",
    "( f ) same raster plot as in ( e ) , ordering neurons according to their intrinsic current @xmath81 .",
    "parameters : @xmath82 , @xmath83 ; and @xmath84 , @xmath85 ( triangle symbol in ( a)).,width=264 ]    figure 3(a ) shows a phase diagram obtained using eq .  .",
    "the shaded regions indicate parameter values where the rate model has either a single chaotic attractor ( in black ) or a chaotic attractor coexisting with a periodic orbit ( in cyan ) . a trajectory on the chaotic attractor is depicted in fig .",
    "3(b ) , and the clearly irregular time series of the firing rate is shown in orange in fig .",
    "3(d ) . using the same parameters we performed numerical simulations of the qif neurons  - , finding a similar attractor and irregular dynamics as in the rate model , see figs",
    "3(c ) and ( d ) . to obtain the time series shown in figs .",
    "3(d ) , we ran the qif neurons numerically and , after a long transient , at time @xmath76 , the rate model was initiated with the values of @xmath68 and @xmath69 obtained from the population of qif neurons .",
    "the time series of the two systems , which are initially close , rapidly diverge reflecting the chaotic nature of the system .    finally , to illustrate this chaotic state at the microscopic level , fig .",
    "3(e ) shows the raster plot for 300 randomly chosen neurons , corresponding to the time series in fig .",
    "the irregular firing of neurons in fig .",
    "3(e ) has some underlying structure that may be visualized ordering the same set of neurons according to their intrinsic currents as @xmath86 , with @xmath87 $ ] , see fig .",
    "clearly , the maxima of the firing rate coincide with the synchronous firings of clusters of neurons with similar @xmath26 values .",
    "the size of these clusters is highly irregular in time , in concomitance with the chaotic behavior .",
    "thus far , we have shown that the la solves the continuity equation , and confirmed that these solutions agree with the numerical simulations of the original system of qif neurons - . here",
    "we further clarify why the la holds for ensembles of qif neurons .    transforming the voltage of the qif neuron into a phase via @xmath88 ,",
    "the system - becomes an ensemble of ` theta neurons ' @xcite : @xmath89 .",
    "\\label{thn}\\ ] ] in the new phase variable @xmath90 , the la becomes : @xmath91 , \\label{oa}\\ ] ] where the function @xmath92 is related with @xmath50 as @xmath93 equations   and are two representations of the so - called poisson kernel on the half - plane and on the unit disk , respectively .",
    "these representations are related via equation , that establishes a conformal mapping from the half - plane @xmath94 onto the unit disk @xmath95 . in the next section",
    "we show that variables @xmath68 and @xmath69 can be related , via the same conformal map , with the kuramoto order parameter , which is a macroscopic measure of phase coherence @xcite .",
    "the key observation supporting the applicability of the la is the fact that equation   turns out to be the ansatz discovered in 2008 by ott and antonsen @xcite .",
    "according to the ott - antonsen ( oa ) theory , in the thermodynamic limit the dynamics of the class of systems @xmath96 , \\label{wbh}\\ ] ] generally converges to the oa manifold . in our case , for equation  , we have @xmath97 and @xmath98 .",
    "thus far , the convergence of to the oa manifold has been proven only for @xmath99 .",
    "this includes the well - known kuramoto and winfree models @xcite , but not system .",
    "however , there are theoretical arguments @xcite that strongly suggest that the oa manifold is also attracting for @xmath26-dependent @xmath100 , as numerically confirmed by a number of recent papers using theta neurons @xcite and other phase - oscillator models @xcite .",
    "there exists a mapping between the macroscopic variables @xmath68 and @xmath69 and the so - called kuramoto order parameter @xmath101 .",
    "equation   relates , for each value of @xmath26 , the firing rate and the mean membrane potential , both contained in @xmath64 , with the uniformity of the phase density , measured by @xmath102 note that @xmath103 in yields a perfectly uniform density .",
    "the kuramoto order parameter is obtained by integrating @xmath102 over the whole population as @xmath104 where we assumed that the density @xmath105 is the oa ansatz eq .  .",
    "the quantity @xmath101 can be seen as the center of mass of a population of phases distributed across the unit circle @xmath106 .    for a lorentzian distribution of currents , @xmath28",
    ", we may derive the exact formula ( see appendix b ) @xmath107 relating the kuramoto order parameter @xmath101 with the firing - rate quantity @xmath108 .",
    "figure 4 illustrates this conformal mapping of the right half - plane ( @xmath109 ) onto the unit disk ( @xmath110 ) .     and the macroscopic quantities of the population of qif neurons : @xmath68 : firing rate , and @xmath69 : mean membrane potential .",
    "note that in the limit @xmath111 ( full coherence , @xmath112 ) we recover @xmath113 , as the original mapping @xmath114 between qif- and theta - neurons dictates.,width=283 ]",
    "we have presented a method for deriving firing rate equations for a network of heterogeneous qif neurons , which is exact in the thermodynamic limit . to our knowledge",
    ", the resulting system of ordinary differential equations   represents the first exact fres of a network of spiking neurons .",
    "we would like to emphasize that the derivation of the fres does not rely on assumptions of weak coupling , separation of time - scales , averaging , or any other approximation .",
    "rather , the assumptions underlying the validity of equation   are that @xmath115 the qif neurons be all - to - all connected , @xmath116 heterogeneity be quenched , and @xmath117 inputs be distributed according to a lorentzian distribution .    the last two assumptions may seem particularly restrictive .",
    "concerning @xmath118 , it must be stressed that for _ arbitrary _ distributions of quenched heterogeneity the la remains generally valid , and therefore equation can be used to discern the stability of the network states ( see appendix c ) .",
    "furthermore , in appendix c we also show numerical simulations using uniform- and gaussian - distributed inputs , that reveal very similar macroscopic dynamics in response to time varying inputs . even relaxing assumption @xmath119 , numerical simulations with identical qif neurons driven by external independent gaussian noise sources",
    "show qualitative agreement with the fres ( see appendix d ) . in sum , the choice of a quenched lorentzian distribution @xmath28 is thus a mere mathematical convenience , whereas the insights gained from the resulting firing - rate description are valid more generally .",
    "our derivation represents a sharp departure from , and a major advance compared to previous studies in several regards .",
    "firstly , in the past it has only been possible to calculate the approximate firing rate of networks of spiking neurons for stationary states , or for weak deviations of such states @xcite .",
    "the equations which result from these derivations are difficult to solve , and typically require special numerical methods .",
    "in contrast , fres can be easily analyzed and simulated , and exactly reproduce the behavior of the spiking network far from any fixed point and for arbitrary external currents .",
    "secondly , firing - rate descriptions traditionally assume that the activity of a population of neurons is equivalent to a set of uncorrelated stochastic processes with a given rate , see e.g.  @xcite .",
    "however , in simulations of spiking networks it is well known that the response of the network to non - stationary inputs generally involves some degree of spike synchrony .",
    "recent theoretical work has sought to improve on classical rate models , which act as a low - pass filter of inputs , by fitting them with linear filters extracted from the corresponding fokker - planck equation for the network @xcite .",
    "these filters tend to generate damped oscillations when the external noise level is not too high , reflecting the presence of spike synchrony @xcite .",
    "the fres also capture this phenomenon , and reveal that the underlying mechanism is an interplay between firing rate and subthreshold voltage .",
    "furthermore , because these equations are exact , we can explore the full nonlinear response of the network , such as the generation of chaotic states of synchronous bursting as shown in fig .",
    "recently it has been shown that , not only kuramoto - like models , but a much wider class of phase - models , evolve in the oa manifold defined by .",
    "specifically , networks of pulse - coupled oscillators @xcite and theta - neurons @xcite allow for an exact , low - dimensional description in terms of the kuramoto order parameter .",
    "although these later works use a finite - width phase coupling function that differs from the synaptic coupling  , the obtained low - dimensional description in terms of the kuramoto order parameter is analogous to ours , but in a different space .",
    "indeed , we showed that the oa ansatz is related , via the nonlinear transformation of variables , to the la ansatz .",
    "remarkably , this transformation establishes an exact correspondence between the kuramoto order parameter and a novel , biophysically maningful macroscopic observable which describes the firing rate and mean membrane potential of the neuronal network .",
    "interestingly , the low - dimensional description in terms of firing rates seems to be a more natural description for networks of spiking neurons , compared to that in terms of the kuramoto order parameter .",
    "the firing rate equations take a surprisingly simple form in the la manifold , what makes them a valuable tool to explore and and understand the mechanisms governing the macroscopic dynamics of neuronal networks .",
    "finally , since the oa ansatz is the asymptotic solution for systems of the form in equation  , applying the change of variables @xmath114 automatically implies that the la should hold for populations governed by : @xmath120 where @xmath121 , @xmath122 , and @xmath123 are related with @xmath124 and @xmath100 as @xmath125/2 $ ] , @xmath126 , @xmath127/2 $ ] .",
    "notably , equation   defines a wide family of ensembles of qif neurons .",
    "therefore , the la is actually valid for more general networks beyond the one investigated here @xmath10 in eq .",
    "may also be a vector containing several forms of disorder .",
    "as particularly relevant cases , in appendix e we provide the fres governing the dynamics of an excitatory network with both , heterogeneous inputs @xmath26 _ and _ synaptic weights @xmath12 , as well as pair of interacting excitatory and inhibitory populations of qif neurons .",
    "in addition , according to eq .  , the la is also valid if synapses are modeled as conductances , in which case the reversal potentials may be distributed as well .",
    "moreover , the role of gap - junctions or synaptic kinetics may be considered within the same framework .",
    "69ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) @noop * * , ( ) @noop _ _",
    "( ,  ) link:\\doibase    10.1103/physreve.51.738 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ,  ( ,  ,  )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) link:\\doibase 10.1063/1.2930766 [ * * ,   ( ) ] @noop * * ,   ( ) in  @noop _ _ ,  ( ,  ,  )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1371/journal.pcbi.1002872 [ * * ,   ( ) ] @noop _ _  ( , ,  ) @noop _ _  ( ,  ,  ) link:\\doibase 10.1063/1.3136851 [ * * ,   ( ) ] @noop * * , ( ) link:\\doibase 10.1103/physrevx.4.011009 [ * * ,   ( ) ] \\doibase doi : 10.1016/j.physd.2011.01.002 [ * * , ( ) ] @noop * * ,   ( ) \\doibase    http://dx.doi.org/10.1016/j.physd.2013.04.009 [ * * , ( ) ] link:\\doibase    10.1103/physreve.90.010901 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.106.254101 [ * * ,   ( ) ] link:\\doibase    10.1209/0295 - 5075/95/60007 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.84.046206 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.110.064101 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms5118 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1016/0370-1573(92)90163-t [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.68.2730 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.3647317 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.101.264103 [ * * , ( ) ]",
    "to numerically simulate the population of qif neurons we used the euler method , with time step @xmath128 .",
    "the population had @xmath129 neurons , and the lorentzian distribution was deterministically generated using : @xmath130 $ ] , where @xmath131 , and @xmath132 .    the time it takes for the membrane potential of a qif neuron ( with @xmath133 ) to reach infinity from a given positive value of the membrane potential is @xmath134 .",
    "for @xmath135 , this expression can be approximated as : @xmath136    in simulations we considered @xmath137 , and used the previous approximation .",
    "thus , the time for the neurons to reach infinity from @xmath6 is @xmath138 .",
    "additionally , the time taken from minus infinity to @xmath7 is @xmath139 .",
    "numerically , once a neuron s membrane potential @xmath5 satisfies @xmath140 the neuron is reset to @xmath141 and held there for a refractory time @xmath142 .",
    "the neurons produce a spike when @xmath5 reaches infinity , i.e.  a time interval @xmath143 after crossing @xmath6 .",
    "the exact time of the spike can not be evaluated exactly in numerical simulations , since @xmath144 is finite .",
    "however , simulations agree very well with the theory provided that @xmath145 .    to evaluate the mean membrane potential @xmath69 , the population average was computed discarding those neurons in the refractory period",
    ". the choice @xmath146 is not needed , but in this way the observed mean membrane potential @xmath69 agrees with the theory , consistent with the definition in .",
    "the mean synaptic activation was evaluated using the heaviside step function @xmath147 with @xmath148 .",
    "the instantaneous firing rates were obtained binning time and counting spikes within a sliding time window of size @xmath149 ( figs .",
    "[ fig2 ] ,  [ figa2 ] ,  [ figa3 ] ,  [ figa4 ] ) and @xmath150 ( fig .",
    "[ fig3 ] ) .",
    "the inverse of eq .   reads : @xmath151 recalling eqs .   and , we write the macroscopic field @xmath152 as @xmath153 where @xmath154 . inserting the conformal mapping @xmath155 the inverse of eq .",
    " we get @xmath156g(\\eta ) d\\eta .\\nonumber\\ ] ] using the geometric series formula , and grouping the powers of @xmath102 , we may evaluate the integrals obtaining @xmath157 where the @xmath158 are the generalized order parameters @xcite : @xmath159^m \\,d\\eta . \\nonumber \\ ] ] since , for lorentzian @xmath28 , @xmath160^m = z(t)^m$ ] , we can revert the power series in and obtain the result in .",
    "in this appendix we compare the results in the main text , obtained using a lorentzian distribution of currents @xmath28 , with other distributions .",
    "the results are qualitatively similar as evidenced by figs .",
    "[ figa1 ] ,  [ figa2 ] and [ figa3 ] ( cf .  figs .  1 , 2 , and 3 in the main text ) .",
    "note that if a particular distribution @xmath28 has @xmath161 poles ( all of them off the real axis ) one can readily obtain the fres consisting of @xmath162 complex - valued ordinary differential equations .",
    "even if @xmath28 does not fulfill this condition , as in the case of gaussian or uniform distributions , the lorentzian ansatz still holds ( see below ) .",
    "moreover , it is possible to efficiently simulate the dynamics of a population by integrating eq .   for a sample of @xmath26 values that approximate a particular @xmath163 , e.g.  eq",
    ".   for @xmath164 is reversible , with invariance under @xmath165 , @xmath166 .",
    "it is advisable to approximate eq .   by a set of odes ( one for each @xmath26 value ) with additional small terms breaking time - reverisibility",
    "this is achieved including a small term in each ode , like @xmath53 in eq .",
    ", so that @xmath28 is actually approximated by a sum of very sharp lorentzian functions .",
    ". however , if @xmath28 is a discrete distribution ( or has a discrete part ) , as in the case of the dirac delta function @xmath167 , the so - called watanabe - strogatz theory applies @xcite , and the ` lorentzian manifold ' is no longer attracting since the dynamics is extremely degenerate , akin to a hamiltonian system .",
    "considering @xmath31 in eqs .   and , it is possible to find the solutions with steady firing rate @xmath168 for arbitrary distributions of currents .    as we pointed out in the main text , the stationary solution of the continuity equation for those neurons that are intrinsically active ( @xmath169 ) must be is inversely proportional to their speed , that is @xmath170 where the normalizing constant is @xmath171 .",
    "the firing rate for each value of @xmath26 is then @xmath172 and integration over all the firing neurons , gives the self - consistent condition for @xmath173 : @xmath174 which is valid for any distribution @xmath28 ( an analogous expression was obtained in eq .",
    "( 45 ) of @xcite ) . for lorentzian @xmath28 , the integral in can be evaluated , and solving the resulting equation for @xmath173 one obtains the steady states in agreement with the result of setting @xmath175 in the fres .      assuming that the la captures the actual dynamics of the population of qif neurons , one can also investigate the stability of steady states for arbitrary distributions @xmath28 .",
    "indeed , the evolution of infinitesimal perturbations from a steady state @xmath176 is determined by the linearization of eq .",
    ": @xmath177 where @xmath178 g(\\eta ) d\\eta$ ] .    to find the discrete spectrum of eigenvalues   and the complex conjugate . indeed , for @xmath26 values such that neurons are actively firing ( @xmath179 ) , the eigenvalues lie exactly on the imaginary axis .",
    "apparently , this seems to forbid the exponential stability obtained from eq .   for the lorentzian distribution .",
    "the same mathematical conundrum was encountered and solved in the kuramoto model @xcite , what suggests similar mechanisms are operating here . ]",
    ", we use the ansatz @xmath180 in and obtain @xmath181 b(\\eta ) e^{\\lambda t } = \\frac{ij}{2\\pi } \\int _ { -\\infty}^\\infty [ b(\\eta ) e^{\\lambda t } + b^*(\\eta ) e^{\\lambda^ * t } ] g(\\eta ) d\\eta .   \\nonumber\\ ] ] solving the equation for @xmath182 , we find @xmath183 g(\\eta ) d\\eta .",
    "\\nonumber\\ ] ] after summing the complex conjugate at each side of the equation , we multiply by @xmath28 and integrate over @xmath26 .",
    "this allows one to cancel out the integrals @xmath184 .",
    "then , imposing self - consistency , we find @xmath185 g(\\eta ) d\\eta.\\ ] ] local bifurcations are associated with marginal stability of the fixed points : @xmath186 . in correspondence with the results obtained for a lorentzian distribution in the main text",
    ", we expect bifurcations of saddle - node type associated with @xmath187 . therefore , from eq .",
    "we find that the loci of the saddle - node bifurcations are located at @xmath188 since @xmath189 for @xmath190 , and zero otherwise , we can restrict the integration over @xmath26 to the range @xmath191 .",
    "now multiplying eq .   by eq .",
    "we get , after defining @xmath192 , two equations that permit to find the locus of the saddle - node bifurcations systematically for arbitrary distributions of currents : @xmath193 with @xmath194 obtained solving @xmath195    .",
    "the cyan - shaded region represents the bistable region , with the solid lines corresponding to saddle - node bifurcations analytically obtained from eqs .   and .",
    "square symbols are estimations of the bifurcations loci obtained from by direct numerical simulations of @xmath129 qif neurons .",
    "triangle symbols indicate parameter values used in numerical simulations of figs .",
    "[ figa2 ] and [ figa3].,width=302 ]          equations and are particularly easy to solve for uniform distributions of currents : @xmath196 after defining the rescaled parameters @xmath197 and @xmath198 , we find two branches of saddle - node bifurcations emanating from the cusp point at @xmath199 : @xmath200 these functions are plotted in fig .",
    "numerical simulations using the network of qif neurons confirm the correctness of these boundaries ( see the square symbols in fig .",
    "[ figa1 ] ) .    for gaussian distributions , @xmath201 the solutions of and can be numerically found .",
    "the results are shown in fig .",
    "[ figa1](b ) .",
    "again , there is a perfect agreement between eqs .   and derived assuming the lorentzian ansatz and the numerical estimations obtained simulating the network of qif neurons .      firing rate equations predict the existence of a stable focus in the shaded region of fig .  1",
    ". trajectories attracted to this fixed point display oscillations in the firing rate and mean membrane potential due to the transient synchronous firing of the qif neurons .",
    "when an external periodic current is injected to all neurons in the network , the spiral dynamics around the fixed point is responsible for the bursting behavior observed in fig .  2 , as well as for the emergence of the macroscopic chaos shown in fig .",
    "we investigate whether similar phenomena occur when an external periodic current of the same frequency is injected in an excitatory network with either uniform or gaussian - distributed currents .",
    "we introduced a sinusoidal forcing @xmath202 observing a behavior qualitatively identical to the one reported in the main text with lorentzian @xmath28 . under a low - frequency",
    "forcing the system displays periodic bursting , see fig .",
    "[ figa2 ] , provided the parameters are set inside the bistable region ( see the black triangles in fig .  [ figa1 ] ) . furthermore , note that the range of firing rates and mean membrane potentials in figure  [ figa2 ] are similar to those of fig .",
    "[ fig2 ] for lorentzian distributions of currents .    as for the simulations shown in figure",
    ", we next increase the frequency of the injected current up to @xmath83 to investigate the emergence of macroscopic chaos in a network with gaussian - distributed currents .",
    "[ figa3 ] shows the emergence of an apparently chaotic state .",
    "the observed dynamics is similar to that of fig .",
    "[ fig3 ] , which suggests it is chaotic .",
    "this type of chaos persists in the thermodynamic limit @xmath1 . on top of this ,",
    "highly - dimensional but weakly chaotic dynamics is probably also present due to ` residual ' finite - size effects .",
    "qif neurons with gaussian - distributed currents .",
    "network parameters correspond to the yellow - triangle symbol in the phase diagram of fig .",
    "s1(b ) . like in fig .",
    "[ fig3 ] , neurons receive a common periodic current @xmath202 of frequency @xmath83 .",
    "parameters : @xmath203 , @xmath204 , @xmath205 , @xmath206.,width=245 ]",
    "we compare now the results obtained above and in the main text for quenched heterogeneity @xmath28 with the results for identical neurons @xmath167 driven by noise .",
    "specifically , the inputs currents are now taken as @xmath207 where @xmath208 are independent white noise terms with expected values @xmath209 , and @xmath210 .        in the thermodynamic limit",
    ", the density @xmath211 obeys the fokker - planck equation : @xmath212=d \\,\\partial^2_{v } \\rho .",
    "\\label{fp}\\ ] ] the lorentzian ansatz is not a solution of this equation , but we demonstrate here that the phenomena observed with quenched heterogeneity arise also with independent noise sources .",
    "this qualitative similarity at the macroscopic level between quenched lorentzian heterogeneity and gaussian noise has been noted in previous work @xcite .    a subtle point in eq .",
    "is that its nondimensionalization entails a different ( compared to @xmath53 ) rescaling with @xmath213 : @xmath214 , @xmath215 , @xmath216 , @xmath217 ( implying @xmath218 ) .",
    "numerical simulations reveal the existence of a region of bistability , see fig .",
    "[ figa4](a ) , analogous to the one observed for quenched heterogeneity , cf .",
    "[ fig1](a ) and [ figa1 ] .",
    "obviously , true bistability only holds in the thermodynamic limit , while what we observe are rather exceedingly long residence times close to each fixed point ( see figure caption for details ) .",
    "additionally , in order to investigate and compare the dynamical behavior of the identical noise - driven neurons with that of the fres , an external current of intensity @xmath82 is injected to all neurons at time @xmath76 , like in fig .",
    "[ fig2 ] . in fig .",
    "[ figa4](b , c ) the time series of the firing rate and the mean membrane potential clearly display damped oscillations after the injection of the current , confirming the existence of a stable focus , exactly as observed in the fres .",
    "the existence of a stable focus reflects the presence of transient spike synchrony in the network , as seen by the raster plot in fig .",
    "[ figa4](d ) .",
    "remarkably , the raster plot and the time series closely resemble those of fig .",
    "the resemblance is not just qualitative , but rather there is a near quantitative fit between the network of qif neurons driven by gaussian noise and the fres , which were derived assuming quenched lorentzian heterogeneity ( orange curves ) .",
    "to illustrate the potential of the la for investigating more sophisticated networks , here we provide the low - dimensional fres corresponding to an excitatory network of qif neurons with independently distributed currents and synaptic weights , and to two interacting populations of excitatory and inhibitory qif neurons with distributed currents .",
    "[ [ excitatory - population - with - heterogeneous - currents - and - synaptic - weights ] ] excitatory population with heterogeneous currents and synaptic weights ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    as a first example , let us assume that _ both _ the currents @xmath26 and the synaptic weights @xmath12 are distributed this type of heterogeneity was also considered in @xcite .",
    "the input currents read then @xmath219 for simplicity , let us additionally assume that @xmath26 and @xmath12 are distributed independently , with a joint distribution @xmath220 . in the simplest situation of lorentzian @xmath28 and @xmath221",
    "@xmath222 the problem is extremely simplified using the lorentzian ansatz , which now trivially reads : @xmath223 ^ 2 + x(\\eta , j , t)^2}. \\nonumber\\ ] ] the firing rate and mean membrane potential are determined only by the value of @xmath154 at the poles in the lower half planes : @xmath224 finally , evaluating eq .   in the main text at the poles ( @xmath66 , @xmath225 ) we get the exact fres :",
    "these equations contain simply an extra term ` @xmath227 ' compared to equations  .",
    "figure  [ figa5 ] shows the bistability boundaries obtained from for different ratios of @xmath228 and @xmath53 , and @xmath31 .",
    "note that the region of bistability shifts to lower values of @xmath229 and to higher values of @xmath230 as the level of heterogeneity in the synaptic coupling @xmath228 is increased .",
    "[ [ firing - rate - equations - for - a - pair - of - excitatory - inhibitory - populations ] ] firing - rate equations for a pair of excitatory - inhibitory populations ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    the microscopic state of each population of qif neurons is characterized by the membrane potentials @xmath231 , which obey the following ordinary differential equations : @xmath232 here , @xmath233 represents the membrane potential of neuron @xmath17 in either the excitatory @xmath234 , or in the inhibitory population @xmath235 . the external currents for the excitatory and inhibitory populations are , respectively : @xmath236 where the synaptic weights are @xmath237 .",
    "finally , the mean synaptic activation for each population is @xmath238 here , @xmath239 is the time of the @xmath16th spike of @xmath17th neuron in either the excitatory @xmath234 , or in the inhibitory population @xmath235 .",
    "additionally , @xmath18 is the dirac delta function , and @xmath19 is the normalized synaptic activation caused by a single pre - synaptic spike with time scale @xmath20 , e.g.  @xmath21 .",
    "it is straightforward to apply the la and the method described in the main text , to obtain the firing rate equations corresponding to the two - population model . considering the limit of infinitely fast synapses , @xmath51",
    ", we get @xmath240 . finally , assuming the lorentzian distributions of currents for both populations : @xmath241 we obtain the firing - rate equations : @xmath242"
  ],
  "abstract_text": [
    "<S> a major goal of neuroscience , statistical physics and nonlinear dynamics is to understand how brain function arises from the collective dynamics of networks of spiking neurons . </S>",
    "<S> this challenge has been chiefly addressed through large - scale numerical simulations . </S>",
    "<S> alternatively , researchers have formulated mean - field theories to gain insight into macroscopic states of large neuronal networks in terms of the collective firing activity of the neurons , or the firing rate . </S>",
    "<S> however , these theories have not succeeded in establishing an exact correspondence between the firing rate of the network and the underlying microscopic state of the spiking neurons . </S>",
    "<S> this has largely constrained the range of applicability of such macroscopic descriptions , particularly when trying to describe neuronal synchronization . here </S>",
    "<S> we provide the derivation of a set of exact macroscopic equations for a network of spiking neurons . </S>",
    "<S> our results reveal that the spike generation mechanism of individual neurons introduces an effective coupling between two biophysically relevant macroscopic quantities , the firing rate and the mean membrane potential , which together govern the evolution of the neuronal network . </S>",
    "<S> the resulting equations exactly describe all possible macroscopic dynamical states of the network , including states of synchronous spiking activity . </S>",
    "<S> finally we show that the firing rate description is related , via a conformal map , with a low - dimensional description in terms of the kuramoto order parameter , called ott - antonsen theory . </S>",
    "<S> we anticipate our results will be an important tool in investigating how large networks of spiking neurons self - organize in time to process and encode information in the brain .    </S>",
    "<S> processing and coding of information in the brain necessarily imply the coordinated activity of large ensembles of neurons . within sensory regions of the cortex , </S>",
    "<S> many cells show similar responses to a given stimulus , indicating a high degree of neuronal redundancy at the local level . </S>",
    "<S> this suggests that information is encoded in the population response and hence can be captured via macroscopic measures of the network activity @xcite . </S>",
    "<S> moreover , the collective behavior of large neuronal networks is particularly relevant given that current brain measurement techniques , such as electroencephalography ( eeg ) or functional magnetic resonance imaging ( fmri ) , provide data which is necessarily averaged over the activity of a large number of neurons .    </S>",
    "<S> the macroscopic dynamics of neuronal ensembles has been extensively studied through computational models of large networks of recurrently coupled spiking neurons , including hodgkin - huxley - type conductance - based neurons @xcite as well as simplified neuron models , see e.g.  @xcite . in parallel , </S>",
    "<S> researchers have sought to develop statistical descriptions of neuronal networks , mainly in terms of a macroscopic observable that measures the mean rate at which neurons emit spikes , the _ firing rate _ @xcite . these descriptions , called firing - rate equations ( fres ) , have been proven to be extremely useful in understanding general computational principles underlying functions such as memory @xcite , visual processing @xcite , motor control @xcite or decision making @xcite .    despite these efforts , to date </S>",
    "<S> there is no exact theory linking the dynamics of a large network of spiking neurons with that of the firing rate . </S>",
    "<S> specifically , current macroscopic descriptions do not offer a precise correspondence between the microscopic dynamics of the individual neurons , e.g.  individual membrane potentials , and the firing rate dynamics of the neuronal network .    </S>",
    "<S> indeed , fres are generally derived through heuristic arguments which rely on the underlying spiking activity of the neurons being asynchronous and hence uncorrelated . as such , firing rate descriptions are not sufficient to describe network states involving some degree of spike synchronization . </S>",
    "<S> synchronization is , however , an ubiquitous phenomenon in the brain , and its potential role in neuronal computation is the subject of intense research @xcite . </S>",
    "<S> hence , the lack of firing rate descriptions for synchronous states limits the range of applicability of mean - field theories to investigate neuronal dynamics .    </S>",
    "<S> here we propose a method to derive the fres for networks of heterogeneous , all - to - all coupled quadratic integrate - and - fire ( qif ) neurons , which is exact in the thermodynamic limit , i.e.  for large numbers of neurons . </S>",
    "<S> we consider an ansatz for the distribution of the neurons membrane potentials that we denominate the _ lorentzian ansatz _ ( la ) . </S>",
    "<S> the la solves the corresponding continuity equation exactly , making the system amenable to theoretical analysis . </S>",
    "<S> specifically , for particular distributions of the heterogeneity , the la yields a system of two ordinary differential equations for the firing rate and mean membrane potential of the neuronal population . </S>",
    "<S> these equations fully describe the macroscopic states of the network including synchronized states , and represent the first example of an exact firing - rate description for a network of recurrently connected spiking neurons . </S>",
    "<S> we finally show how the la transforms , via a conformal mapping , into the so - called ott - antonsen ansatz ( oa ) that is extensively used to investigate the low - dimensional dynamics of large populations of phase oscillators in terms of the kuramoto order parameter @xcite . </S>"
  ]
}