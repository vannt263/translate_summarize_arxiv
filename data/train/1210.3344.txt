{
  "article_text": [
    "clones of functions and clones of relations in their various incarnations have proved to be an immensely powerful tool in the study of the complexity of different versions of the constraint satisfaction problem ( csp , for short ) . in a csp",
    "the aim is to find an assignment of values to a given set of variables , subject to constraints on the values that can be assigned simultaneously to certain specified subsets of variables .",
    "a csp can also be expressed as the problem of deciding whether a given conjunctive formula has a model . in the counting version of the csp the goal is to find the number of satisfying assignments , and in the quantified version we need to verify if a first order sentence , whose quantifier - free part is conjunctive , is true in a given model .",
    "the general csp is np - complete @xcite .",
    "however , many practical and theoretical problems can be expressed in terms of csps using constraints of a certain restricted form .",
    "one of the most widely used way to restrict a constraint satisfaction problem is to specify the set of allowed constraints , which is usually a collection of relations on a finite set .",
    "the key result is that this set of relations can usually be assumed to be a co - clone of a certain kind .",
    "more precisely , a generic statement asserts that if a relation @xmath2 belongs to the co - clone generated by a set @xmath3 of relations then the csp over @xmath4 is polynomial time reducible to the csp over @xmath3 .",
    "then we can use the appropriate galois connection to transfer the question about sets of relations to a question about certain classes of functions .    for the classical decision csp",
    "such a result was obtained by jeavons et al .",
    "@xcite , who proved that intersection of relations ( that is , conjunction of the corresponding predicates ) and projections ( that is , existential quantification ) give rise to polynomial time reducibility of csps . therefore in the study of the complexity of the csp it suffices to focus on co - clones . using the result of geiger @xcite or the one of bodnarchuk et al .",
    "@xcite one can instead consider clones of functions .",
    "a similar result is true for the counting csp as shown by bulatov and dalmau @xcite . in the case of quantified csp , brner et al",
    ".  proved @xcite that conjunction , existential quantification , and also universal quantification give rise to a polynomial time reduction between quantified problems .",
    "the appropriate class of functions is then the class of surjective functions . along with the usual counting csp ,",
    "a version , in which one is required to approximate the number of solutions , has also been considered .",
    "the standard polynomial time reduction between problems is not suitable for approximation complexity . in this case , therefore , another type of reductions , approximation preserving , or , ap - reductions , is used .",
    "the first author proved in @xcite that conjunction of predicates gives rise to an ap - reduction between approximation counting csps . by the galois connection established by fleischner and rosenberg @xcite ,",
    "the approximation complexity of a counting csp is a property of a clone of partial functions .    in most cases establishing the connection between clones of functions and reductions between csps",
    "has led to a major success in the study of the csp . for the decision problem ,",
    "a number of very strong results have been proved using methods of universal algebra @xcite .",
    "for the exact counting csp a complete complexity classification of such problems has been obtained @xcite .",
    "substantial progress has been also made in the case of quantified csp @xcite .",
    "compared to the results cited above the progress made in the approximation counting csp is modest .",
    "perhaps , one reason for this is that clones of partial functions are much less studied , and much more diverse than clones of total functions . in this paper",
    "we attempt to overcome to some extent the difficulties arising from this weakness of partial clones .    in the first part of the paper we introduce new types of quantification and",
    "show that such quantifications , we call them max - implementation and max - quantification , give rise to ap - reductions between approximation counting csps . intuitively , applying the max - quantifier to a relation @xmath5 results in the relation @xmath6 that contains those tuples @xmath7 that have a maximal number of extensions @xmath8 such that @xmath9 is satisfied .",
    "max - implementation , @xmath10 , is a similar construction , but applied to a group of variables .",
    "sets of relations closed with respect this new type of quantification will be called max - co - clones .",
    "thus we strengthen the closure operator on sets of relation hoping that the sets of functions corresponding to the new type of galois connection are easier to study .",
    "we were unable , however , to describe a galois connection for sets closed under max - implementation and max - quantification .",
    "instead , we consider a somewhat close type of quantifiers , @xmath0-existential quantifiers .",
    "quantifiers of this type are known as counting quantifiers in model theory , and often used to enhance first order logic languages ( see , e.g.   @xcite ) .",
    "counting quantifiers are similar to max - existential quantifiers , although do not capture them completely .",
    "we call sets of relations closed under conjunctions and @xmath0-existential quantification @xmath0-existential co - clones . on the functional side , an @xmath11-ary ( partial ) function on a set @xmath12",
    "is said to be @xmath0-subset surjective if it is surjective on any collection of @xmath0-element subsets .",
    "more precisely , for any @xmath0-element subsets @xmath13 the set @xmath14 contains at least @xmath0 elements .",
    "the second result of the paper asserts that @xmath0-existential co - clones are exactly the sets of relation invariant with respect to a set of @xmath0-subset surjective ( partial ) functions .",
    "finally , we give a complete description of max - co - clones on @xmath1 ( boolean max - co - clones ) .",
    "surprisingly , any boolean max - co - clone is also a usual co - clone ( but not the other way around ) .",
    "we show that in general it is not true .",
    "by @xmath15 $ ] we denote the set @xmath16 . for a set @xmath12 , by @xmath17",
    "we denote the set of all _ @xmath11-tuples _ of elements of @xmath12 .",
    "an @xmath11-ary relation is any set @xmath18 .",
    "the number @xmath11 is called the _ arity _ of @xmath2 and denoted @xmath19 .",
    "tuples will be denoted in boldface , say , @xmath20 , and their entries will be denoted by @xmath21\\zd \\ba[n]$ ] . for @xmath22 $ ] by @xmath23",
    "we denote the tuple @xmath24\\zd\\ba[i_k])$ ] , and we use @xmath25 to denote @xmath26",
    ". we will also need predicates corresponding to relations . to simplify the notation we use the same symbol for a relation and the corresponding predicate , for instance , for an @xmath11-ary relation @xmath2 the corresponding predicate @xmath27 is given by @xmath28\\zd \\ba[n])=1 $ ] if and only if @xmath29 .",
    "relations and predicates are used interchangeably .    for a set of relations @xmath3 over a set @xmath12 ,",
    "the set @xmath30 includes all relations that can be expressed ( as a predicate ) using ( a ) relations from @xmath3 , together with the binary equality relation @xmath31 on @xmath12 , ( b ) conjunctions , and ( c ) existential quantification .",
    "this set is called the _ co - clone generated by _ @xmath3 .    _",
    "partial co - clone generated by _",
    "@xmath3 is obtained in a similar way by disallowing existential quantification .",
    "@xmath32 includes all relations that can be expressed using ( a ) relations from @xmath3 , together with @xmath31 , and ( b ) conjunctions ,    if @xmath33 or @xmath34 , the set @xmath3 is said to be a _",
    "partial co - clone _ , and a _ co - clone _ , respectively .",
    "sometimes there is no need to apply even conjunction to produce a new relation .",
    "for instance , @xmath35 defines a binary relation from a ternary one .",
    "therefore it is often convenient , especially for technical purposes , to group manipulations with variables of a relation into a separate category .",
    "more formally , for a relation @xmath27 and a mapping @xmath36 , where @xmath37 is some set of variables , @xmath38 denotes the relation @xmath39 .",
    "we will understand by ( partial ) co - clones sets of relations closed under manipulation with variables , conjunction , and existential quantification ( respectively , closed under manipulation with variables and conjunction ) .",
    "co - clones and partial co - clones can often be conveniently and concisely represented through functions and partial functions , respectively .",
    "let @xmath2 be a ( @xmath0-ary ) relation on a set @xmath12 , and @xmath40 an @xmath11-ary function on the same set .",
    "function @xmath41 _ preserves _",
    "@xmath2 , or is a _ polymorphism _ of @xmath2 , if for any @xmath11 tuples @xmath42 the tuple @xmath43 obtained by component - wise application of @xmath41 also belongs to @xmath2 .",
    "relation @xmath2 in this case is said to be _ invariant _ with respect to @xmath41 .",
    "the set of all functions that preserve every relation from a set of relations @xmath3 is denoted by @xmath44 , the set of all relations invariant with respect to a set of functions @xmath45 is denoted by @xmath46 .",
    "operators @xmath47 and @xmath48 form a galois connection between sets of functions and sets of relations .",
    "sets of the form @xmath46 are precisely co - clones ; on the functional side there is another type of closed sets .    a set of functions is said to be a _ clone _ of functions if it is closed under superpositions and contain all the _ projection _ functions , that is functions of the form @xmath49 . sets of functions of the form @xmath44 are exactly clones of functions @xcite .",
    "the study of the # csp also makes use of another galois connection , a connection between partial co - clones and sets of _ partial functions_. an @xmath11-ary partial function @xmath41 on a set @xmath12 is just a partial mapping @xmath40 . as in the case of total functions , a partial function @xmath41 _ preserves _",
    "relation @xmath2 , if for any @xmath11 tuples @xmath42 the tuple @xmath43 obtained by component - wise application of @xmath41 is either undefined or belongs to @xmath2 .",
    "the set of all partial functions that preserve every relation from a set of relations @xmath3 is denoted by @xmath50 .",
    "the set of all tuples from @xmath17 on which @xmath41 is defined is called the _ domain _ of @xmath41 and denoted by @xmath51 .",
    "a set of functions is said to be _ down - closed _ if along with a function @xmath41 it contains any function @xmath52 such that @xmath53 and @xmath54 for every tuple @xmath55 .",
    "a down - closed set of functions , containing all projections and closed under superpositions is called a _",
    "partial clone_. fleischner and rosenberg @xcite proved that partial clones are exactly the sets of the form @xmath50 for a certain @xmath3 , and that the partial co - clones are precisely the sets @xmath46 for collections @xmath45 of partial functions .",
    "let @xmath12 be a set , and let @xmath3 be a finite set of relations over @xmath12 .",
    "an instance of the counting constraint satisfaction problem , @xmath56 , is a pair @xmath57 where @xmath37 is a set of _ variables _ , and @xmath58 is a set of _",
    "every constraint is a pair @xmath59 , in which @xmath2 is a member of @xmath3 , and @xmath60 is a tuple of variables from @xmath37 of length @xmath61 ( possibly with repetitions ) .",
    "a _ solution _ to @xmath62 is a mapping @xmath63 such that @xmath64 for every constraint @xmath65 .",
    "the objective in @xmath56 is to find the number @xmath66 of solutions to a given instance @xmath62 .",
    "we are interested in the complexity of this problem depending on the set @xmath3 .",
    "the complexity of the exact counting problem ( when we are required to find the exact number of solutions ) is settled in @xcite by showing that for any finite @xmath12 and any set @xmath3 of relations over @xmath12 the problem is polynomial time solvable or is complete in a natural complexity class @xmath67 .",
    "one of the key steps in that line of research is the following result : for a relation @xmath2 and a set of relations @xmath3 over @xmath12 , if @xmath2 belongs to the co - clone generated by @xmath3 , then @xmath68 is polynomial time reducible to @xmath56 .",
    "this results emphasizes the importance of co - clones in the study of constraint problems .",
    "a situation is different when we are concerned about approximating the number of solutions .",
    "we will need some notation and terminology .",
    "let @xmath69 be a counting problem .",
    "an algorithm @xmath70 is said to be an _ approximation algorithm _ for @xmath69 with relative error @xmath71 ( which may depend on the size of the input ) if it is polynomial time and for any instance @xmath62 of @xmath69 it outputs a certain number @xmath72 such that @xmath73 if @xmath62 has no solution and @xmath74 otherwise , where @xmath66 denotes the exact number of solutions to @xmath62 .",
    "the following framework is viewed as one of the most realistic models of efficient computations .",
    "a _ fully polynomial approximation scheme _",
    "( fpas , for short ) for a problem @xmath69 is an algorithm @xmath70 such that : it takes as input an instance @xmath62 of @xmath69 and a real number @xmath75 , the relative error of @xmath70 on the input @xmath76 is less than @xmath71 , and @xmath70 is polynomial time in the size of @xmath62 and @xmath77 .    to determine the approximation complexity of problems approximation preserving of reductions",
    "suppose @xmath69 and @xmath78 are two counting problems whose complexity ( of approximation ) we want to compare .",
    "an _ approximation preserving reduction _ or _ ap - reduction _ from @xmath69 to @xmath78 is an algorithm @xmath70 , using @xmath78 as an oracle , that takes as input a pair @xmath76 where @xmath62 is an instance of @xmath69 and @xmath79 , and satisfies the following three conditions : ( i ) every oracle call made by @xmath70 is of the form @xmath80 , where @xmath81 is an instance of @xmath78 , and @xmath82 is an error bound such that @xmath83 is bounded by a polynomial in the size of @xmath62 and @xmath84 ; ( ii ) the algorithm @xmath70 meets the specifications for being an fpas for @xmath69 whenever the oracle meets the specification for being an fpas for @xmath78 ; and ( iii ) the running time of @xmath70 is polynomial in the size of @xmath62 and @xmath77 . if an approximation preserving reduction from @xmath69 to @xmath78 exists we denote it by @xmath85 , and say that @xmath69 is _ ap - reducible to _ @xmath78 .",
    "similar to co - clones and polynomial time reductions , partial co - clones can be shown to be preserved by ap - reductions .",
    "[ the : partial ] let @xmath2 be a relation and @xmath3 be a set of relations over a finite set such that @xmath2 belongs to @xmath86 .",
    "then @xmath68 is ap - reducible to @xmath56 .",
    "this result however has two significant setbacks .",
    "first , partial co - clones are not studied to the same extent as regular co - clones , and , due to greater diversity , are not believed to be ever studied to a comparable level .",
    "second , it does not used the full power of ap - reductions , and therefore leaves significant space for improvements .",
    "in the rest of this section we try to improve upon the second issue .",
    "[ def : max - implementation ] let @xmath3 be a set of relations on a set @xmath12 , and let @xmath2 be an @xmath11-ary relation on @xmath12 .",
    "let @xmath62 be an instance of @xmath56 over the set of variables consisting of @xmath87 , where @xmath88 and @xmath89 .",
    "for any assignment of @xmath90 , let @xmath91 be the number of assignments @xmath92 such that @xmath93 satisfy @xmath62 .",
    "let @xmath94 be the maximum value of @xmath91 among all assignments of @xmath95 .",
    "the instance @xmath62 is said to be a _",
    "max - implementation _ of @xmath2 if a tuple @xmath96 is in @xmath97 if and only if @xmath98 .    [ the : max - implementation ] if there is max - implementation of @xmath2 by @xmath3 , then @xmath99 .",
    "let @xmath100 be a max - implementation of @xmath2 by @xmath3 , and let @xmath94 be the maximal number of extensions of assignments of @xmath95 to solutions of @xmath62 .",
    "for any instance @xmath101 of @xmath102 we construct an instance @xmath103 of @xmath56 as follows .",
    "* choose a sufficiently large integer @xmath104 ( to be determined later ) .",
    "* let @xmath105 be the constraints from @xmath106 involving @xmath2 , @xmath107 .",
    "set @xmath108 , where each @xmath109 is a fresh copy of @xmath110 .",
    "* let @xmath58 be the set of constraints of @xmath62 .",
    "set @xmath111 , where each @xmath112 is a copy of @xmath58 defined as follows . for each @xmath113",
    "we include @xmath114 into @xmath112 , where @xmath115 is obtained from @xmath60 replacing every variable from @xmath110 with its copy from @xmath109 .",
    "now , as is easily seen , every solution of @xmath106 can be extended to a solution of @xmath116 in @xmath117 ways .",
    "observe that sometimes the restriction of a solution @xmath118 of @xmath116 to @xmath119 is not a solution of @xmath106 .",
    "indeed , it may happen that although @xmath118 satisfies every copy @xmath112 of @xmath62 , its restriction to @xmath115 does not belong to @xmath2 , simply because this restriction does not have sufficiently many extensions to solutions of @xmath62 .",
    "however , any assignment to @xmath119 that is not a solution to @xmath106 can be extended to a solution of @xmath116 in at most @xmath120 ways .",
    "hence , @xmath121 m^m # _",
    "1#_2 m^m # _ 1 + |v_1|^|d| ( m-1)^mm^(-1)m @xmath121 then we output @xmath122",
    ".    let @xmath123 and @xmath124 .",
    "given a desired relative error @xmath71 we have to find @xmath104 such that @xmath125 a straightforward computation shows that any @xmath126 achieves the goal .",
    "max - implementation can be used as another closure operator on the set of relations .",
    "let @xmath127 be a relation on a set @xmath12 .",
    "by @xmath128 we denote the relation @xmath129 on the same set given by the rule : @xmath130 if and only if there are @xmath94 tuples @xmath131 such that @xmath132 , where @xmath94 is the maximal number of elements in the set @xmath133 over all @xmath134 .",
    "a set of relations @xmath3 over @xmath12 is said to be a _",
    "max - co - clone _ if it contains the equality relations , and closed under conjunctions and max - implementations .",
    "the smallest max - co - clone containing a set of relations @xmath3 is called the _ max - co - clone generated by _ @xmath3 and denoted @xmath135 .",
    "[ lem : max - clones - implementations ] let @xmath3 be a set of relations and @xmath136 .",
    "then there is a max - implementation of @xmath2 by @xmath3 .",
    "suppose @xmath136 .",
    "we need to show that @xmath2 can be represented as @xmath137@xmath138 , where @xmath139 is quantifier free . to this end",
    "it suffices to prove three equalities :    1 .   if @xmath140 and @xmath141 is a transformation of the set @xmath142 then @xmath143 ; 2 .   if @xmath144 , then @xmath145 ; 3 .   if @xmath146 , then there is a quantifier free formula @xmath147 such that @xmath148 .",
    "\\(1 ) follows straightforwardly from definitions .",
    "\\(2 ) @xmath29 if and only if it has the maximal number of extensions in both @xmath149 and @xmath150 . without loss of generality ,",
    "sets @xmath151 and @xmath152 are disjoint .",
    "let a tuple @xmath29 have @xmath153 extensions in @xmath149 and @xmath154 extensions in @xmath150 .",
    "then it has @xmath155 extensions in @xmath156 . on the other hand ,",
    "let @xmath157 .",
    "let also it have @xmath158 extensions in @xmath149 and @xmath159 extensions in @xmath150 , and either @xmath160 or @xmath161 .",
    "since such tuple has @xmath162 extensions , it does not belong to the relation defined by @xmath145 as well .",
    "\\(3 ) observe first that @xmath27 does not necessarily equal @xmath163 .",
    "indeed , let @xmath164 denote the formula @xmath165 .",
    "then it is possible that although every extension of a tuple @xmath20 to @xmath166 has very few extensions to a tuple from @xmath139 , and so @xmath157 , the number of extensions @xmath167 is large so that combined @xmath20 has enough extensions to tuples from @xmath139 .    to avoid this",
    "we make sure that extensions to tuples from @xmath168 can not make up for extensions to @xmath139 .",
    "let @xmath94 be the maximal number of extensions @xmath167 of tuple @xmath20 such that @xmath166 , and @xmath169 the maximal number of extensions @xmath170 of @xmath166 to @xmath171 .",
    "let also @xmath172 be the maximal number of extensions @xmath167 of @xmath29 ; it is possible that @xmath173",
    ". set @xmath174 we show that @xmath148 , where @xmath175@xmath176 , and @xmath177 if a tuple @xmath20 belongs to @xmath2 it is extendable in @xmath172 ways to a tuple from @xmath168 , and then every such extended tuple @xmath178 is extendable in @xmath169 ways to a tuple from @xmath139 .",
    "therefore @xmath20 has @xmath179 extensions to a tuple from @xmath147 . on the other hand ,",
    "if @xmath157 , then it can be extended in at most @xmath94 ways to a tuple @xmath166 , then this tuple is extendable in at most @xmath180 ways to a tuple from @xmath139 .",
    "thus @xmath157 has @xmath181 extensions .",
    "the next natural step would be to find a type of functions and a closure operator on the set of functions that give rise to a galois connection capturing max - co - clones .",
    "[ pro : max - implementation ] find a class @xmath182 of ( partial ) functions and a closure operator @xmath183 $ ] on this class such that for any set of relations @xmath3 and any set @xmath184 it holds that @xmath185 , and @xmath186=\\cf\\cap\\ppol\\,\\inv(c)$ ]",
    ".    in all the cases previously studied the projection ( or quantification ) type operators on relations can be reduced to quantifying away a single variable .",
    "however , max - implementations seem to inherently involve a number of variables , rather than a single variable . in the end of this paper",
    "we use our description of boolean max - co - clones to show that max - implementations are provably more powerful than max - quantification ( see below ) . in the boolean case",
    "every max - quantification is equivalent to either existential quantification , or universal quantification .",
    "sets of relations on @xmath1 closed under these two types of quantifications are well known : these are sets of invariant relations of sets of surjective functions @xcite . however , not all of them are max - co - clones",
    ".    therefore a meaningful relaxation of max - co - clones restricts the use of max - implementation to one auxiliary variable .",
    "let @xmath139 be a formula with free variables @xmath187 and @xmath188 over set @xmath12 and some predicate symbols",
    ". then @xmath189 satisfy @xmath190 if and only if the number of @xmath191 such that @xmath192 is true is maximal among all tuples @xmath193 .",
    "the quantifier @xmath194 will be called _ max - quantifier_. a set of relations @xmath3 over @xmath12 is said to be a _",
    "max - existential co - clone _ if it contains the equality relation , and closed under conjunctions and max - existential quantification .",
    "the smallest max - existential co - clone containing a set of relations @xmath3 is called the _ max - existential co - clone generated by _",
    "@xmath3 and denoted @xmath195 .",
    "[ pro : max - quantification ] find a class @xmath182 of ( partial ) functions and a closure operator @xmath183 $ ] on this class such that for any set of relations @xmath3 and any set of functions @xmath184 it holds that @xmath196 , and @xmath186=\\cf\\cap\\ppol\\,\\inv(c)$ ] .    in the next section we consider certain constructions approximating max - existential co - clones .",
    "in order to approach max - quantification we consider counting quantifiers that have been used in model theory to increase the power of first order logic @xcite .",
    "let @xmath139 be a formula with free variables @xmath187 and @xmath188 over set @xmath12 and some predicate symbols",
    ". then @xmath189 satisfy @xmath197 if and only if @xmath192 is true for at least @xmath0 values @xmath191 .",
    "the quantifier @xmath198 will be called _",
    "@xmath0-existential quantifier_. it is easy to see that 1-existential quantifier is just the regular existential quantifier , and the @xmath199-existential quantifier is equivalent to the universal quantifier on set @xmath12 .",
    "we now introduce several types of co - clones depending on what kind of @xmath0-existential quantifiers are allowed .",
    "a set of relations @xmath3 over set @xmath12 is said to be a _",
    "@xmath0-existential partial co - clone _ if it contains the equality relation @xmath31 , and closed under manipulations with variables , conjunction , and @xmath0-existential quantification .",
    "the smallest @xmath0-existential partial co - clone containing a set of relations @xmath3 is called the _ @xmath0-existential partial co - clone generated by _ @xmath3 and denoted @xmath200 . in a similar way we can define sets of relations closed under several counting quantifiers",
    "let @xmath201 .",
    "a set of relations @xmath3 over set @xmath12 is said to be a _",
    "@xmath202-existential partial co - clone _ if it contains the equality relation @xmath31 , and closed under manipulations with variables , conjunction , and @xmath0-existential quantification for @xmath203 .",
    "clearly , if @xmath3 is a set of relations on an @xmath104-element set , we may assume @xmath204 $ ] .",
    "if @xmath205 , set @xmath3 is closed under existential quantification , and so it is called a _ @xmath202-existential co - clone_. if , in addition , @xmath206 , @xmath3 is called _ @xmath0-existential co - clone_.",
    "the set @xmath3 is said to be a _ _ counting co - clone _ _ if it is an @xmath207-existential partial co - clone , that is , if it contains @xmath31 , and closed under conjunctions and @xmath0-existential quantification for all @xmath208 .",
    "the smallest @xmath202-existential partial co - clone ( @xmath202-existential co - clone , @xmath0-existential co - clone , counting co - clone ) containing @xmath3 are called the _",
    "@xmath202-existential partial co - clone _ ( _ @xmath202-existential co - clone _ , _ @xmath0-existential co - clone _ , _ counting co - clone _ ) _ generated by _",
    "@xmath3 and denoted @xmath209 ( @xmath210 , @xmath211 , @xmath212 , respectively ) .",
    "we observe some simple properties of counting quantifiers .",
    "[ lem : counting - quantifiers - property ] let @xmath213 and @xmath214 be conjunctive quantifier free formulas .",
    "then @xmath215 for any @xmath216 , provided @xmath217 and @xmath218 .",
    "[ cor : prenex ] let @xmath3 be a set of relations on a set @xmath12 , @xmath201 , and @xmath219 .",
    "then there is a conjunctive quantifier free formula @xmath213 using relations from @xmath3 and the equality relation such that @xmath220    the following observation summarizes some relationship between the constructions introduced .",
    "[ obs : inclusions ] for a set of relations @xmath3 on @xmath12 , @xmath221 , the following hold .",
    "+ - @xmath3 is a 1-existential ( partial ) co - clone if and only if it is a co - clone .",
    "+ - @xmath3 is a ( partial ) @xmath104-existential clone if and only if it is a ( partial ) co - clone closed under universal quantification .",
    "+ - if @xmath3 is a counting co - clone then it is a max - existential co - clone . + - if @xmath3 is a max - existential co - clone then it is a partial @xmath104-existential co - clone .    in all other cases the introduced versions of co - clones are incomparable",
    "[ exa : incomparability]fix a natural number @xmath104 and let @xmath12 be a set with @xmath222 elements .",
    "consider an equivalence relation @xmath223 on @xmath12 with classes @xmath224 such that @xmath225 .",
    "then the co - clone generated by @xmath223 corresponds to one of the rosenberg s maximal clones @xcite , and so the structure of relations from this co - clone is well understood . for any @xmath11-ary relation @xmath226",
    "there is a partition @xmath227 of @xmath15 $ ] such that a tuple @xmath20 belongs to @xmath168 if and only if for each @xmath228 $ ] and every @xmath229 the entries @xmath230,\\ba[i']$ ] are @xmath223-related .",
    "this also means that @xmath231 .",
    "applying @xmath0-existential and max - existential quantifiers one can easily find the @xmath0-existential , counting , and max - existential clones generated by @xmath2 :    1 .",
    "@xmath232 is the set of relations @xmath168 : there is a partition @xmath233 of @xmath234 $ ] and @xmath235 $ ] such that a tuple @xmath20 belongs to @xmath168 if and only if for each @xmath236 $ ] and every @xmath229 the entries @xmath230,\\ba[i']$ ] are @xmath223-related and @xmath230\\in d_k\\cup\\ldots\\cup d_m$ ] for @xmath237 , @xmath238 .",
    "@xmath239 is the set of relations @xmath168 : there is a partition @xmath233 of @xmath234 $ ] and a function @xmath240\\to[m]$ ] such that a tuple @xmath20 belongs to @xmath168 if and only if for each @xmath236 $ ] and every @xmath229 the entries @xmath230,\\ba[i']$ ] are @xmath223-related and @xmath230\\in d_{\\vf(j)}\\cup\\ldots\\cup d_m$ ] for @xmath237 , @xmath238 .",
    "@xmath241 is the set of relations @xmath168 : there is a partition @xmath233 of @xmath234 $ ] and @xmath235 $ ] such that a tuple @xmath20 belongs to @xmath168 if and only if for each @xmath236 $ ] and every @xmath229 the entries @xmath230,\\ba[i']$ ] are @xmath223-related and @xmath230\\in d_m$ ] for @xmath237 , @xmath238 .",
    "a set @xmath3 such that @xmath242 can be easily found among usual weak co - clones . for instance , for any weak co - clone @xmath3 that is",
    "not a co - clone we have @xmath243 .",
    "such a weak co - clone can be found in , say , @xcite .",
    "in the example given we have @xmath244 .",
    "however , since @xmath245 , we have @xmath246 . for an example distinguishing between @xmath135 and @xmath195 see the conclusion .",
    "we give a sketchy proof of ( 1 ) here , the remaining results are similar .",
    "let @xmath129 satisfies the conditions in ( 1 ) for a partition @xmath233 of @xmath15 $ ] and @xmath235 $ ] . without loss of generality",
    "assume @xmath247 $ ] , @xmath248 .",
    "choose variables @xmath249 and consider relation @xmath250 given by : @xmath251 if and only if @xmath252,\\ba[j])\\in\\rel_m$ ] for any @xmath253 for some @xmath254 $ ] and @xmath252,\\ba[n+\\ell])\\in\\rel_m$ ] for any @xmath255 where @xmath256 .",
    "clearly , @xmath257 .",
    "now , as it is easy to see , @xmath258    in order to show that every relation from @xmath259 satisfies these conditions , it suffices to prove that the set of relations @xmath3 satisfying them is closed under manipulations with variables , conjunction , existential quantification , and @xmath0-existential quantification .",
    "the first three operations are easy , since @xmath3 is a co - clone generated by @xmath223 and unary relation @xmath260 .",
    "let @xmath261 and @xmath262 .",
    "let also @xmath233 and @xmath235 $ ] be the partition and a set from conditions ( 1 ) .",
    "we may assume @xmath263 .",
    "then if @xmath264 then @xmath265 .",
    "otherwise @xmath251 if and only if ( a ) for any @xmath253 , @xmath266 , we have @xmath252,\\ba[j])\\in\\rel_m$ ] , ( b ) for any @xmath267 , we have @xmath252,\\ba[j])\\in\\rel_m$ ] , and ( c ) @xmath230\\in d'$ ] , whenever @xmath268 . therefore @xmath269 .",
    "let @xmath12 be a finite set .",
    "a ( partial ) function @xmath40 is said to be _ @xmath0-subset surjective _ if for any @xmath0-element subsets @xmath13 the image @xmath270 has cardinality at least @xmath0 .",
    "a ( partial ) function that is @xmath0-subset surjective for each @xmath0 , @xmath271 is said to be _",
    "subset surjective_. the set of all arity @xmath11 @xmath0-subset surjective partial functions [ arity @xmath11 @xmath0-subset surjective functions , subset surjective functions ] on @xmath12 will be denoted by @xmath272 [ resp . , @xmath273 , @xmath274 ; furthermore , @xmath275 , @xmath276 , @xmath277 .",
    "any partial function is 1-subset surjective , while @xmath199-subset surjective partial functions are exactly the surjective partial functions . observe that this definition can be strengthened by allowing the sets @xmath278 , @xmath279 $ ] , to have at least @xmath0 elements .",
    "[ lem : relax - subset - monotone ] if an @xmath11-ary function @xmath41 is @xmath0-subset surjective , then for any subsets @xmath13 with @xmath280 , @xmath281 $ ] , the image @xmath270 has cardinality at least @xmath0 .",
    "choose any @xmath282 , @xmath281 $ ] , and set @xmath283 . as @xmath41 is @xmath0-subset surjective , @xmath284 .",
    "finally , @xmath285 , and the result follows .",
    "the conditions of being @xmath0-subset surjective for different @xmath0 are in general incomparable , as the following example shows .",
    "[ exa : incomparable]let @xmath286 be a @xmath0-element set and @xmath287",
    ". then the following function @xmath41 is not @xmath104-subset surjective , but is @xmath288-subset surjective for any @xmath289 $ ] except @xmath290 .",
    "function @xmath41 is binary and given by its operation table : @xmath291 clearly , @xmath41 is not @xmath104-subset surjective , because @xmath292 for @xmath293 .",
    "also , as it is a total function , @xmath41 is 1-subset surjective .",
    "take @xmath289 $ ] , @xmath294 , and @xmath295 with @xmath296 .",
    "if there is @xmath297 with @xmath298 then @xmath299 whenever @xmath300 .",
    "this means that @xmath301 in this case , and , in particular , @xmath41 is @xmath288-subset surjective for any @xmath302 .",
    "so , suppose @xmath303 and @xmath304 if @xmath305 then take @xmath306 and observe that @xmath307 for any @xmath308 , @xmath309 .",
    "thus , @xmath310 .",
    "suppose @xmath311 .",
    "if @xmath312 , then @xmath313 ; assume @xmath314 .",
    "as is easily seen , @xmath315 .",
    "there is @xmath316 such that @xmath317 but @xmath318 .",
    "then @xmath319 , since @xmath320 .",
    "thus , @xmath301 .",
    "the notion of invariance for @xmath0-subset surjective functions is the standard one for partial functions and relations . as usual ,",
    "if @xmath45 is a set of ( @xmath0- ) subset surjective ( partial ) functions , @xmath46 denotes the set of relations invariant with respect to every function from @xmath45 . for a set @xmath3 of relations , @xmath321 and @xmath322",
    "denote the set of all @xmath0-subset surjective functions and partial functions , respectively , preserving every relation from @xmath3 . for a set @xmath201 by @xmath323 and @xmath324",
    "we denote the set of all functions and , respectively , partial functions preserving every relation from @xmath3 that are @xmath0-subset surjective for each @xmath203 .",
    "thus , in particular , @xmath325 by @xmath326 we denote the analogous set of subset surjective functions .    the operator @xmath47 on one side and the operators @xmath322 , @xmath321 , @xmath323 , @xmath327 , @xmath326 on the other side form galois correspondences in the standard fashion .",
    "we characterize closed sets of relations that give rise from this correspondence .",
    "[ lem : quantifier preservation ] let @xmath328 be a relation on @xmath12 , and let @xmath329",
    ". then if a @xmath0-subset surjective ( partial ) function @xmath41 preserves @xmath2 , it also preserves @xmath168 .",
    "suppose @xmath41 is @xmath11-ary .",
    "take @xmath330 . since each of them is put into @xmath168 by @xmath0-existential quantification , it has at least @xmath0 extensions to a tuple from @xmath2 .",
    "let @xmath331 be such that @xmath332 and @xmath333 for @xmath334 and @xmath281 $ ] .",
    "let also @xmath335 .",
    "for any @xmath336 the tuple @xmath337 belongs to @xmath2 . as @xmath41 is @xmath0-subset surjective , @xmath284 , hence , @xmath338 .",
    "[ the : rel - clones ] let @xmath3 be a set of relations on a set @xmath12 and @xmath201 . then @xmath339 .",
    "we will assume that @xmath340 .",
    "indeed , if @xmath341 then @xmath342 is empty for any relation on @xmath12 .",
    "the equality relation , @xmath31 , is invariant with respect to any partial function on @xmath12 .",
    "let @xmath41 be a @xmath0-subset surjective functions .",
    "it is straightforward to verify that manipulations of variables of a predicate invariant under @xmath41 and the conjunction of any two predicates invariant under @xmath41 result in predicates invariant under @xmath41 , again , since it is true for any partial function . by lemma  [ lem : quantifier preservation ] applying @xmath0-quantification to a predicate invariant under @xmath41",
    "gives a predicate invariant under @xmath41 , again because it is true for any partial function .",
    "hence , @xmath343 .",
    "moreover , it follows that @xmath344 .    to establish the reverse inclusion ,",
    "take an @xmath288-ary relation @xmath345 .",
    "we need to show that @xmath346 .",
    "define a relation @xmath168 as follows .",
    "let @xmath347 .",
    "for each @xmath203 we consider sequences @xmath348 of @xmath0-element subsets of @xmath12 .",
    "let also @xmath349 be a list of all such sequences .",
    "let @xmath350 be the relation @xmath351 and @xmath352 .",
    "then @xmath168 is the union of relations given by @xmath353 for all @xmath236 $ ] .",
    "we show that there is @xmath354 such that @xmath355 and @xmath356}\\rela=\\rel$ ] .",
    "then applying @xmath0-quantifications , @xmath203 , to all coordinates of @xmath357 except for the first @xmath288 we infer that @xmath358 .",
    "set @xmath359 and @xmath360 ; by @xmath361 , @xmath203 , we denote the set @xmath362 .",
    "let us consider the relation @xmath363 .",
    "since @xmath209 is closed under conjunctions and contains the total relation @xmath364 , we have @xmath365 and @xmath355 .",
    "now choose any tuple @xmath366 .",
    "there are sets @xmath367 such that @xmath368 , @xmath369 $ ] , whenever @xmath370 , for any @xmath371 $ ] , @xmath372 , @xmath373 , and for any @xmath374 , @xmath369 $ ] , the tuple @xmath375 .",
    "indeed , otherwise we can applying a sequence of @xmath0-quantifications for @xmath203 to obtain an @xmath288-ary relation @xmath376 containing @xmath2 , but not @xmath377 .",
    "then , @xmath378 belongs to @xmath209 , but is smaller than @xmath168 .",
    "therefore we can choose @xmath167 such that for any @xmath379 $ ] and any @xmath380 $ ] all the values @xmath381 are distinct , and @xmath382 .",
    "since @xmath209 is closed under conjunctions , by the fleischer and rosenberg result @xcite it satisfies @xmath383 .",
    "moreover , by the proof of theorem  2 of @xcite @xmath357 is the set of all tuples of the form @xmath384 for @xmath385 , @xmath386 , and @xmath387 .",
    "therefore there exist @xmath385 , @xmath386 and @xmath387 such that @xmath388 .",
    "let @xmath356}\\bc_q=\\ba_{i_q}$ ] .",
    "for any selection @xmath389 of @xmath390-element subsets of @xmath12 , @xmath379 $ ] , there is @xmath391 $ ] such that @xmath392 for @xmath393 $ ] . by the choice of @xmath167 the range of @xmath41 on @xmath394 contains @xmath395 .",
    "hence @xmath41 is @xmath390-subset surjective for any @xmath396 , and so @xmath397 , as it is equal to @xmath398 .",
    "therefore @xmath2 is invariant under @xmath41 , and so @xmath399 .",
    "relation @xmath357 satisfies the required conditions , which completes the proof .",
    "[ cor : galois ] there is a galois correspondence between @xmath202-existential partial co - clones on one side and partial clones generated by @xmath202-surjective partial functions on the other side .",
    "more precisely , for any set @xmath3 of relations on @xmath12 , any @xmath400 , and any set @xmath45 of @xmath202-surjective partial functions on @xmath12 ,    * @xmath46 is a @xmath202-existential partial co - clone ; * @xmath50 is a partial co - clone generated by the set @xmath401 of @xmath202-surjective partial functions ; * @xmath339 ; * @xmath402 is the set of @xmath202-surjective functions from the partial clone generated by @xmath45 .    [ cor : rel - clones ] let @xmath3 be a set of relations on a set @xmath12 .",
    "* @xmath403 ; * @xmath404 ; * @xmath405 ;",
    "in this section we give a description of all max - co - clones on @xmath1 .",
    "we will use the description of usual boolean co - clones from @xcite and _ plain bases _ of boolean co - clones found in @xcite . recall that plain basis of a co - clone @xmath45",
    "is a set @xmath3 of relations such that the closure of @xmath3 with respect to manipulation of variables and conjunction is @xmath45 .    to state the results of @xcite and then to proceed with the proof , we need some definitions and notation .",
    "a relation @xmath27 is said to be _ trivial _ if it can be specified by giving a set of variables that are equal to 0 ( to 1 ) in every tuple from @xmath2 , and a collection of conditions of the form @xmath406 .",
    "more formally , there are sets @xmath407 $ ] and an equivalence relation @xmath408 on @xmath15-(z\\cup w)$ ] such that @xmath29 if and only if @xmath230=0 $ ] whenever @xmath409 , @xmath230=1 $ ] whenever @xmath410 , and @xmath230=\\ba[j]$ ] whenever @xmath411 .",
    "a relation is called _ monotone _ if it is invariant with respect to @xmath412 , the boolean disjunction operation , or @xmath413 , the boolean conjunction operation .",
    "relation @xmath2 is called _ self - complement _ if along with any tuple @xmath29 it also contains its _ complement _ , the tuple @xmath414 such that @xmath415=1 $ ] if and only if @xmath230=0 $ ] .",
    "finally , relation @xmath2 is called _ affine _ if it is the set of solutions to a system of linear equations over @xmath416 .",
    "addition in @xmath416 we denote by @xmath417 .    for @xmath418 $ ] we denote by @xmath419 the assignment to @xmath187 in which @xmath230=1 $ ] if @xmath420 and @xmath230=0 $ ] otherwise",
    ". we will use the following notation : @xmath421 denote the unary _ constant _ relations @xmath422 , respectively .",
    "@xmath423 is the binary _ equality _ relation @xmath424 ; while @xmath425 is the binary _ disequality _ relation @xmath426 .",
    "@xmath427 is the horn @xmath428-ary relation given by the formula @xmath429 , that is , @xmath29 if and only if @xmath430\\zd\\ba[k],\\ba[k+1])$ ] satisfies the formula .",
    "by @xmath431 we denote the anti - horn relation given by the formula @xmath432 .",
    "@xmath433 denotes the relation @xmath434 , and @xmath435 denotes the relation @xmath436 .",
    "finally , @xmath437 is the @xmath438-ary relation @xmath439 , where the first of the two excluded tuples contains @xmath0 zeros and @xmath288 ones , while the second contains @xmath0 ones and @xmath288 zeros .",
    "[ fig : post ] shows the lattice of boolean co - clones ( borrowed from @xcite ) , and table  [ tab : plain - post ] lists plain bases of boolean co - clones .",
    "table  [ tab : plain - post ] is also taken from @xcite only with notation changed to match the one used here .",
    ".plain bases of boolean co - clones [ cols=\"<,<\",options=\"header \" , ]             the next theorem states the main result of this section .    [ the : max - post ] the lattice of boolean max - co - clones is shown in fig  [ fig : max - post ]",
    ". some generating sets of these max - co - clones are given in table  [ tab : max - post ] .",
    "the theorem will follow from a sequence of auxiliary statements . in section  [ sec :",
    "implementations ] we show that using the @xmath10 quantifier we can define various relations , and that any relation can be defined by any two nontrivial binary relations .",
    "then we show , lemma  [ lem : out - max - generation ] , that any proper max - co - clone must contain only monotone , or only self - complement , or only affine relations .",
    "we consider these three cases . in the case of affine relations",
    "we show that the max - co - clones of such relations are exactly regular co - clones , lemma  [ lem : linear - max - clones ]",
    ". then we show , proposition  [ pro : self - dual ] , that there is only one max - co - clone of self - complement relations , which contains a non - affine relation , @xmath440",
    ". then we show , lemmas  [ lem : im2-clone],[lem : imp+-generation ] , that there is only one proper , that is , not @xmath441 , the set of all relations , max - co - clone containing @xmath442 , and this max - co - clone is @xmath443 . finally , we consider the four remaining infinite chains of co - clones . in lemma",
    "[ lem : is - property ] we introduce a property that defines them .",
    "then we show , lemma  [ lem : nand - generation ] , and  [ lem : or - generation ] , that there are no other max - co - clones containing @xmath444 ( for @xmath445 a dual result holds ) .",
    "finally , we show that each of these co - clones is a max - co - clone .",
    "we start with several useful observations .",
    "[ lem : simple - implementations ] ( 1 ) @xmath446 ; + ( 2 ) @xmath447 , @xmath448 ; + ( 3 ) @xmath449 for any @xmath450 ; + ( 4 ) @xmath451 for any @xmath450 .",
    "\\(1 ) as is easily seen , @xmath452 , and @xmath453 .",
    "\\(2 ) the first inclusion follows from @xmath454 ; the second one is similar .",
    "\\(3 ) this claim follows from @xmath455 .",
    "\\(4 ) is similar to ( 3 ) .",
    "[ lem : imp - generation ] for any two different relations @xmath456 , @xmath457 , the set of all relations on @xmath1 .",
    "observe first that @xmath458 also in the relation @xmath459 assignments @xmath460 and @xmath461 to @xmath462 are extendible in two ways , while @xmath463 is extendible in only one way .",
    "therefore @xmath464 thus @xmath465 , and it suffices to show that @xmath466 .",
    "the rest of the proof is derived from that of lemma  15 @xcite , only it does not have to deal with weights .",
    "let @xmath27 be any relation .",
    "for each @xmath418 $ ] with @xmath467 introduce a new variable @xmath468 .",
    "consider the relation given by @xmath469,\\ba_i\\in\\rel}\\left(\\bigwedge_{i\\in i } \\imp(z_i , x_i)\\meet\\bigwedge_{i\\not\\in i}\\nand(z_i , x_i)\\right).\\ ] ] every assignment @xmath467 can be extended to the variables @xmath470 in two ways : with @xmath471 and @xmath472 .",
    "any other assignment can be extended in only one way",
    ". therefore @xmath473,\\ba_i\\in\\rel}\\relo,\\ ] ] which completes the proof .",
    "[ lem : neq - generation ] let @xmath2 be a non - affine relation and @xmath474 . then @xmath475 .    by lemma",
    "[ lem : imp - generation ] it suffices to prove that one of @xmath476 , or @xmath445 belongs to @xmath477 .",
    "observe first that we can always assume that the all - zero tuple @xmath478 . indeed ,",
    "if for some @xmath418 $ ] we have @xmath467 then the relation @xmath479 contains @xmath480 . as @xmath481 , by lemma  4.10 of @xcite , there are tuples @xmath482 such that @xmath483 . observing that @xmath484 if and only if @xmath485 , we have that @xmath486 , but @xmath487 . hence @xmath488 is not affine as well . also , if @xmath489 is such that @xmath490 then by lemma  [ lem : simple - implementations](2 ) @xmath491 .",
    "again we use lemma  4.10 of @xcite to find to find tuples @xmath482 such that @xmath483 .",
    "note that @xmath20 can be chosen to be the all - zero tuple @xmath480 .",
    "after rearranging variables these tuples can be represented as follows @xmath492 denote by @xmath488 the relation obtained from @xmath2 by identifying variables as shown in the last row of the table .",
    "relation @xmath488 contains tuples @xmath493 but does not contain @xmath494 , and so does not belong to @xmath495 . replacing @xmath488 with @xmath496 we obtain a relation @xmath497 such that @xmath498 but @xmath499 .",
    "we now proceed depending on which of the 4 remaining tuples ( a ) @xmath500 , ( b ) @xmath501 , ( c ) @xmath502 , and ( d ) @xmath503 relation @xmath497 contains . if it contains none of ( a)(d ) then @xmath504 . if it contains ( a ) or ( b ) but not ( d ) then @xmath445 is obtained by identifying @xmath188 and @xmath505 , or @xmath506 and @xmath505 , respectively . if @xmath497 contains ( c ) but not ( d ) then @xmath507 . if it contains ( d ) but not ( a ) then @xmath508 . in the case",
    "@xmath497 contains ( a ) , ( d ) , but does not contain ( b ) @xmath442 is obtained by identifying @xmath506 and @xmath505 .",
    "if @xmath497 contains ( a ) , ( d ) , and ( b ) @xmath509 . finally , if the relation contains all of ( a)(d ) @xmath510 .",
    "next we show that every max - co - clone is a subset of @xmath495 , @xmath440 , @xmath511 , or @xmath512 .",
    "[ lem : out - max - generation ] let @xmath3 be a set of relations , which is not affine , monotone , or self - complement",
    ". then @xmath513 .",
    "let @xmath514 be a non - self - complement relation .",
    "then after suitable rearrangement of variables there is @xmath515 such that @xmath516}\\in\\rel$ ] , while @xmath517-[i]}\\not\\in\\rel$ ] .",
    "if @xmath518 then identifying variables @xmath519 and @xmath520 we obtain a binary relation @xmath488 that contains @xmath461 but does not contain @xmath460 . as is easily seen",
    "either @xmath521 or @xmath522 is a constant relation . in the case @xmath523 or @xmath524 ,",
    "identifying all variables of @xmath2 we obtain a constant relation . thus either @xmath525 or @xmath526 .",
    "suppose @xmath526 .",
    "the case @xmath525 is similar . by lemma  5.30 of @xcite for any non - affine relation @xmath527 , the set @xmath528 contains one of the following relations : @xmath529 . if @xmath530 then @xmath531 , and we can make all the arguments below for @xmath532 and @xmath445 .",
    "therefore we have two cases to consider .",
    "suppose first that @xmath533 .",
    "there is a relation @xmath534 that is not invariant under the @xmath412 operation .",
    "therefore for some tuple @xmath535 the tuple @xmath536 does not belong to @xmath168 .",
    "after an appropriate rearrangement of variables these tuples can be represented as follows @xmath537 denote by @xmath538 the relation obtained from @xmath168 by identifying variables as shown in the last row of the table .",
    "relation @xmath538 contains tuples @xmath539 but does not contain @xmath540 .",
    "then , relation @xmath541 contains tuples @xmath542 but does not contain @xmath543 .",
    "we have several cases depending on the 3 remaining tuples ( a ) @xmath544 , ( b ) @xmath545 , ( c ) @xmath503 . if none of ( a)(c ) is in @xmath546 then @xmath547 . if @xmath546 contains ( a ) but not ( c ) ( or ( b ) but not ( c ) ) , then @xmath548 ( respectively , @xmath549 ) . if it contains ( c ) but does not contain ( a ) and ( b ) then @xmath550 . if @xmath546 contains both ( b ) and ( c ) then @xmath551 . finally if @xmath546 contains ( a),(c ) , but",
    "not ( b ) , then @xmath552 .    in either case",
    "@xmath135 contains a constant relation , either @xmath425 or @xmath442 , and contains one of @xmath529 .",
    "if it contains @xmath425 , we are done by lemma  [ lem : imp - generation ] .",
    "so suppose @xmath553 .",
    "then we also have @xmath554 . since @xmath3 is not monotone , as before we can derive relations @xmath555 such that @xmath556 , but @xmath557 , @xmath558 .",
    "now it is easy to see that @xmath559 , where @xmath560 .",
    "recall that the set of affine relations , that is , ( @xmath11-ary ) relations that can be represented as the set of solutions to a system of linear equations over @xmath561 is denoted by @xmath495 .",
    "the next lemma follows from basic linear algebra , as sets of extensions of tuples are cosets of the same vector subspace . for the sake of completeness",
    "we give a proof of this lemma .",
    "[ lem : rectangularity ] let @xmath2 be an ( @xmath11-ary ) affine relation .",
    "then for any @xmath418 $ ] any two tuples @xmath562 have the same number of extensions to tuples from @xmath2 .",
    "let @xmath2 be the set of solutions of a system of linear equations @xmath563 , where @xmath69 is a @xmath564-matrix over @xmath416 , @xmath565 , and @xmath566 .",
    "without loss of generality @xmath567 $ ] . then @xmath69 can be represented as @xmath568 $ ] , where @xmath569 is a @xmath570-matrix and @xmath571 is a @xmath572-matrix ; @xmath573 can be represented as @xmath574 , where @xmath575 , @xmath576 .",
    "fix @xmath577}\\rel$ ] and set @xmath578 .",
    "the set of extensions of @xmath20 is the set of solutions of the system @xmath579 . clearly , the number of solutions this system does not depend on @xmath20 , provided the system is consistent .",
    "[ lem : linear - max - clones ] let @xmath580 .",
    "then @xmath3 is a max - co - clone if and only if it is a co - clone .",
    "lemma  [ lem : rectangularity ] implies that for any ( @xmath11-ary ) relation @xmath581 and any set @xmath582 $ ] the max - implementation @xmath583 is equivalent to a sequence of ordinary existential quantifiers @xmath584 .",
    "recall that a relation is said to be monotone if it is invariant with respect to @xmath413 or @xmath412 . in this section",
    "we consider relations invariant under @xmath412 .",
    "a proof in the case of relations invariant under @xmath413 is similar .",
    "a monotone relation is called _ nontrivial _ if it does not belong to @xmath585 .",
    "[ lem : monotone - generation ] let @xmath2 be a nontrivial relation invariant under @xmath412 .",
    "then either @xmath586 , or @xmath587 . in particular , if the all - zero tuple belongs to @xmath2 then @xmath586 .",
    "observe that @xmath2 is not self - complement , because as it follows from @xcite ( see also fig .",
    "[ fig : post ] ) all self complement monotone relations are trivial . also if the all - one tuple does not belong to @xmath2 , since @xmath2 is invariant under @xmath412 , some variables of @xmath2 equal 0 in all tuples from @xmath2 .",
    "such variables can be quantified away , and the resulting relation is nontrivial as @xmath2 is nontrivial .",
    "we may assume the all - one tuple is in @xmath2 .",
    "suppose first that the all - zero tuple belongs to @xmath2 .",
    "therefore there is a tuple @xmath29 such that its complement does not belong to @xmath2 .",
    "after a suitable rearrangement of variables @xmath588 .",
    "identify variables that take 1 in @xmath20 and also variables that take 0 in @xmath20 .",
    "the resulting relation is @xmath442 .",
    "suppose now that the all - zero tuple does not belong to @xmath2 .",
    "then @xmath589 .",
    "we also assume that @xmath2 is a nontrivial relation of the minimal arity from @xmath590 .",
    "let @xmath187 be the variables @xmath2 depends on .",
    "we introduce a partial order on @xmath15 $ ] as follows : @xmath591 iff for any @xmath29 @xmath230=1 $ ] implies @xmath592=1 $ ] . if @xmath593 for no @xmath594 $ ] , then for any @xmath281 $ ] @xmath595 is a trivial relation , none of its projections equal @xmath596 , and therefore the all - zero tuple belongs to @xmath488 .",
    "hence @xmath597 where @xmath598=1 $ ] and @xmath599=0 $ ] for @xmath600 .",
    "since @xmath2 is invariant under @xmath412 , this implies that @xmath601 , and @xmath587 by lemma  [ lem : simple - implementations](4 ) .",
    "next , consider the case when @xmath593 for some @xmath594 $ ] .",
    "this means there are tuples @xmath482 such that @xmath230=\\ba[j]=0 $ ] ( since the projection of @xmath2 on each variable is @xmath1 ) , @xmath602=0 $ ] , @xmath603=1 $ ] ( due to the minimality of @xmath2 , there must be a tuple @xmath167 with @xmath602\\ne\\bb[j]$ ] ) , and @xmath170 is the all - one tuple , in particular @xmath604=\\bc[j]=1 $ ] .",
    "moreover , as @xmath2 is invariant under @xmath412 , we may assume that @xmath605=1 $ ] whenever @xmath606=1 $ ] .",
    "after rearranging variables these tuples can be represented as follows @xmath607 denote by @xmath488 the relation obtained from @xmath2 by identifying variables as shown in the last row of the table .",
    "relation @xmath488 contains tuples @xmath608 .",
    "observe that for no @xmath609 we have @xmath610=1 $ ] and @xmath611=0 $ ] .",
    "therefore @xmath612 .",
    "we first study max - co - clones not containing @xmath444 . by lemma  [ lem : simple - implementations](1 ) and",
    "@xcite ( see also table  [ tab : plain - post ] ) @xmath613 .",
    "[ lem : im2-clone ] @xmath443 , @xmath585 , @xmath614 , @xmath615 are max - co - clones .",
    "since @xmath585 , @xmath614 , @xmath615 essentially contain only unary relations , the lemma for these co - clones is straightforward .    for @xmath443",
    "the result actually follows from lemma  5 of @xcite .",
    "however , as @xcite uses a different framework , we give a short proof of this result here .",
    "our proof can be derived from the one from @xcite .",
    "observe first that @xmath442 satisfies the property of log - supermodularity .",
    "a function @xmath616 is said to be _ log - supermodular _ if for any @xmath617 @xmath618 here @xmath413 and @xmath412 denote componentwise conjunction and disjunction .",
    "this definition can be extended to relations if they are treated as predicates , that is , functions with values @xmath619 . as is easily seen ,",
    "a relation is log - supermodular if and only if it is invariant under @xmath413 and @xmath412 .",
    "first we show that if @xmath3 is a set of log - supermodular relations then every relation from @xmath135 is log - supermodular .",
    "the property of log - supermodularity is obviously preserved by manipulations with variables and conjunction , because it is equivalent to the existence of certain polymorphisms .",
    "suppose @xmath127 is log - supermodular and @xmath620 .",
    "we associate every tuple @xmath621 with the set of ones in this tuple , and therefore can view @xmath2 as a function on the power set of @xmath622 $ ] .",
    "take @xmath623 and prove that @xmath624 .",
    "let @xmath69 be the set of tuples of the form @xmath621 and @xmath625 the set of tuples of the form @xmath626 viewed as subsets of @xmath622 $ ] .",
    "also , let @xmath627 for @xmath628 $ ] and @xmath629 .",
    "denote by @xmath630 and @xmath631 the sets @xmath632 and @xmath633 .",
    "note that @xmath634 and @xmath635 . since @xmath2 is log - supermodular , we know that @xmath636 for all @xmath637",
    "thus , applying the ahlswede - daykin four - functions theorem @xcite with @xmath638 , @xmath639    now suppose @xmath640 .",
    "this means that @xmath641 and this number is the maximal number of extensions of a tuple from @xmath642 to tuples from @xmath2 . by ( [ equ : lsm ] ) @xmath643 and either @xmath644 or @xmath645 .",
    "however , as @xmath646 is the maximal number of extensions , strict inequality is impossible , and we get @xmath647 .",
    "therefore @xmath648 , and so @xmath649 .",
    "thus @xmath650 contains only log - supermodular relations .",
    "however , as it was observed above , log - supermodularity of relations is equivalent to invariance under @xmath413 and @xmath412 . since , @xmath443 is the class of all relations invariant under this two operations , we have @xmath651 .    [ lem : imp+-generation ] let @xmath652 . then @xmath653 .",
    "if @xmath2 is not invariant under @xmath412 and @xmath413 then the result follows by lemma  [ lem : out - max - generation ] , since @xmath442 is not affine or self - complement .",
    "suppose @xmath2 is invariant with respect @xmath412 .",
    "recall that a relation @xmath129 is called _",
    "2-decomposable _ if any tuple @xmath20 such that @xmath252,\\ba[j])\\in\\pr_{\\{i , j\\}}\\relo$ ] for all @xmath594 $ ] belongs to @xmath168 .",
    "@xmath2 is not 2-decomposable .",
    "let @xmath418 $ ] be a minimal set such that @xmath25 is not 2-decomposable , clearly , @xmath654 .",
    "let @xmath655 .",
    "there is @xmath656 such that for any @xmath420 @xmath657 , where @xmath658 denotes the tuple such that @xmath659\\ne\\ba[i]$ ] and @xmath660=\\ba[j]$ ] for @xmath661 .",
    "choose @xmath662 , and set @xmath663 and @xmath664}(x_{i_4 } ) \\meet\\ldots\\meet\\dl_{\\ba[i_k]}(x_{i_k})).\\ ] ] as is easily seen , @xmath168 is not 2-decomposable , and moreover , @xmath665 is not 2-decomposable .",
    "let @xmath666 .",
    "there is @xmath667 such that for any @xmath420 @xmath668 , where @xmath658 denotes the tuple such that @xmath659\\ne\\ba[i]$ ] and @xmath660=\\ba[j]$ ] for @xmath661 .",
    "observe that there are at most one 1 among components of @xmath20 . indeed ,",
    "if , say , @xmath669 then @xmath670 .",
    "suppose first that @xmath20 is the all - zero tuple .",
    "then after rearranging variables these tuples can be represented as follows @xmath671 denote by @xmath546 the relation obtained from @xmath168 by identifying variables as shown in the last row of the table . then set @xmath672 relation @xmath357 contains tuples @xmath673 but does not contain @xmath674 for any @xmath675 .",
    "next we set @xmath676 .",
    "since @xmath357 is invariant under @xmath412 , it contains @xmath677 , and therefore @xmath376 contains tuples @xmath678 , but does not contain @xmath679 .",
    "let also @xmath680 .",
    "as is easily seen @xmath681 is either @xmath682 or @xmath683 . in the former case",
    "we are done , while in the latter case we just observe that @xmath684 .",
    "now suppose @xmath685 .",
    "as before we can construct a relation @xmath357 such that @xmath686 belong to @xmath357 , but @xmath687 does not belong to @xmath357 for any @xmath675 . since @xmath2 is invariant under @xmath412 tuples @xmath688 also belong to @xmath357 .",
    "hence @xmath689@xmath690 , and @xmath691 .",
    "therefore@xmath692 .",
    "@xmath2 is 2-decomposable .    since @xmath693 contains @xmath443 and therefore all 2-decomposable relations whose binary projections are either trivial relations or @xmath442 , relation @xmath2 has to have a binary projection which is not one of them .",
    "as it and all its projections are invariant under @xmath412 , the only nontrivial binary projections it may have are @xmath442 and @xmath444 .",
    "therefore for some @xmath594 $ ] @xmath694 . there are @xmath482 such that @xmath230=\\bb[j]=0 $ ] and @xmath592=\\bb[i]=\\bc[i]=\\bc[j]=1 $ ] , but for no @xmath695 @xmath696=\\bd[j]=0 $ ] .",
    "note also that @xmath170 can be replaced with @xmath697 . after rearranging variables these tuples can be represented as follows @xmath698 denote by @xmath488 the relation obtained from @xmath2 by identifying variables as shown in the last row of the table . then set @xmath699 relation @xmath168 contains tuples @xmath700 , and @xmath544 , as it is invariant under @xmath412 , but does not contain @xmath701 for any @xmath474 .",
    "then @xmath702 .",
    "next we consider max - co - clones containing @xmath444 , but not @xmath442 .",
    "let @xmath27 be a relation . if @xmath594 $ ] are such that @xmath230=\\ba[j]$ ] for any @xmath29 , we write @xmath703",
    "clearly , @xmath704 is an equivalence relation on @xmath15 $ ] ; its class containing @xmath705 will be denoted by @xmath706 or @xmath707 .",
    "let also @xmath708 denote the set of variables @xmath709 such that there is @xmath710 with @xmath603=1 $ ] .",
    "an @xmath11-tuple @xmath20 is said to be _ @xmath704-conforming _ if ( a ) @xmath230=\\ba[j]$ ] whenever @xmath703 , and ( b ) @xmath230=0 $ ] whenever @xmath711 . when considered ordered with respect to the natural component - wise order ( @xmath712 ) , @xmath704-conforming tuples form a poset isomorphic to @xmath713 , where @xmath714 is the number of @xmath704-classes except for the class @xmath15-o_\\rel$ ] . in",
    "what follows @xmath715 and @xmath716 will denote relations on the set of @xmath704-conforming tuples for appropriate @xmath2 .",
    "we say that a relation @xmath27 satisfies the _ filter property _",
    "if for any @xmath29 any @xmath704-conforming tuple @xmath717 with @xmath718 belongs to @xmath2 .",
    "the filter property implies that if @xmath2 is considered as a subset of the ordered set @xmath713 , then it is an order filter in this set .",
    "in particular , it is completely determined by its minimal ( with respect to @xmath715 ) elements , or equivalently by the maximal elements not belonging to @xmath2 .",
    "we say that @xmath2 satisfies the _",
    "@xmath719-filter property _",
    ", if it satisfies the filter property , and every maximal tuple not belonging to @xmath2 contains zeros in at most @xmath719 classes of @xmath704 from @xmath708 .",
    "[ lem : is - property ] ( 1 ) a relation @xmath2 belongs to @xmath720 if and only if it satisfies the filter property .",
    "+ ( 2 ) a relation @xmath2 belongs to @xmath721 if and only if it satisfies the @xmath719-filter property .",
    "\\(1 ) suppose @xmath722 . then by proposition  3 of @xcite the set @xmath723 and @xmath724 ,",
    "@xmath725 is a plain basis of @xmath720 , and therefore @xmath2 can be represented by a conjunctive formula @xmath139 containing variables @xmath187 , relations @xmath723 , and @xmath724 .",
    "let @xmath29 , and let @xmath167 be a @xmath704-conforming tuple such that @xmath726 .",
    "we show that it belongs to @xmath2 .",
    "clearly , @xmath167 satisfies all the @xmath727 relations .",
    "also , it satisfies all the @xmath532 relations , if @xmath728 belongs to @xmath139 then @xmath729 and @xmath603=0 $ ] .",
    "since @xmath167 contains 0 only in the positions @xmath20 does , every relation @xmath724 is satisfied by @xmath167 .",
    "finally , if @xmath730 belongs to @xmath139 , then @xmath731 , therefore all the @xmath423 relations remain satisfied by @xmath167 .",
    "suppose now that @xmath27 satisfies the filter property .",
    "let @xmath732 $ ] be the sets of variables such that for all @xmath29 @xmath230=1 $ ] ( respectively , @xmath230=0 $ ] ) for @xmath410 ( @xmath409 ) .",
    "let also @xmath733 be the maximal tuples not from @xmath2 .",
    "by @xmath734 we denote the set of @xmath735 such that @xmath736=0 $ ] .",
    "suppose @xmath734 contains elements from @xmath737 classes of @xmath704 .",
    "we construct a formula @xmath139 using variables @xmath187 and relations @xmath738 , and prove that it represents @xmath2 .",
    "formula @xmath139 includes + ( 1 ) @xmath739 for each @xmath409 and @xmath740 for each @xmath410 ; + ( 2 ) @xmath741 for any pair @xmath742 , @xmath703 ; + ( 3 ) @xmath743 for any @xmath744 , @xmath745 $ ] , and any @xmath746 such that @xmath746 belong to different @xmath704-classes from @xmath734 . +",
    "let the resulting relation be denoted by @xmath168 . by what is proved above @xmath168 satisfies the filter property .",
    "it is straightforward that @xmath747 and the maximal tuples not in @xmath168 are the same as those of @xmath2 . therefore @xmath748 .",
    "\\(2 ) suppose first that @xmath2 satisfies the @xmath719-filter property .",
    "then it can be represented by a formula @xmath139 as in part ( 1 ) and for every relation @xmath724 used @xmath749",
    ". therefore @xmath750 .",
    "let now @xmath751 , and therefore can be represented by a formula @xmath139 in @xmath187 , and relations @xmath723 , and @xmath724 for @xmath749 . we need to study the structure of maximal tuples from the complement of @xmath2 .",
    "we use the notation from part ( 1 ) .",
    "let @xmath20 be such a tuple .",
    "it is @xmath704-conforming , so , @xmath230=0 $ ] for all @xmath409 , and @xmath230=\\ba[j]$ ] for any @xmath703 .",
    "this means that @xmath20 satisfies all the @xmath532 and @xmath423 relations in @xmath139 .",
    "if @xmath20 violates a relation @xmath727 and there is @xmath752 such that @xmath230=0 $ ] then @xmath20 is not maximal in the complement of @xmath2 .",
    "therefore @xmath230=0 $ ] if and only if @xmath410 , and @xmath753 is a single @xmath704-class .",
    "suppose @xmath20 violates a relation @xmath754 , and let @xmath755 . if there is @xmath756 such that @xmath230=0 $ ] then the tuple @xmath167 given by @xmath603=1 $ ] if @xmath757 and @xmath603=\\ba[j]$ ] otherwise does not belong to @xmath2 and @xmath758 , a contradiction",
    ". therefore the set of zeros of any maximal tuple from the complement of @xmath2 spans at most @xmath719 classes of @xmath704 , as required .",
    "let @xmath3 be a max - co - clone of monotone relations .",
    "by @xmath759 we denote the maximal @xmath104 such that @xmath760 .",
    "if a maximal number @xmath104 does not exist we set @xmath761 .",
    "[ lem : nand - generation ] for any set @xmath762 of monotone relations @xmath763    it suffices to show that if @xmath3 contains a relation @xmath2 with a maximal tuple that spans @xmath0 classes of @xmath704 , then @xmath764 .",
    "let @xmath2 be such a relation .",
    "applying @xmath10 we may assume that the sets @xmath753 and @xmath765 for @xmath2 are empty ; applying identification of variables we may assume that every set @xmath766 is a singleton . now let @xmath20 be a maximal tuple that spans @xmath0 classes of @xmath704 , and @xmath767 the set of positions such that @xmath230=0 $ ] if and only if @xmath420 ; without loss of generality assume @xmath567 $ ] . since @xmath2 satisfies the filter property , for any @xmath768}\\rel$ ] the tuple @xmath769 belongs to @xmath2 .",
    "observe that identifying all the variables of @xmath2 we make sure that @xmath526",
    ". therefore the relation given by @xmath770 belongs to @xmath135 .",
    "it remains to show that @xmath771 . by the filter property of @xmath2 for any @xmath772 that are not all zeros @xmath773 .",
    "therefore @xmath774 . on the other hand , @xmath775 .",
    "it remains to show that for any @xmath722 such that @xmath517}\\not\\in\\rel$ ] ( the all - ones tuple ) , @xmath776 . by the filter property of @xmath2",
    "if @xmath517}\\not\\in\\rel$ ] there is @xmath281 $ ] such that @xmath230=0 $ ] for all @xmath29 .",
    "let @xmath418 $ ] be the set of all such coordinate positions ; without loss of generality we may assume that @xmath777 $ ] . since @xmath778 , we have @xmath779 where @xmath506 is in the first @xmath104 positions .",
    "[ lem : is - clones ] every co - clone @xmath780 for @xmath781 is a max - co - clone .    first we show that every @xmath782 is a max - co - clone . by lemma  [ lem : is - property ]",
    "it suffices to prove that if every relation from @xmath3 satisfies the filter or @xmath719-filter property , then so does every relation from @xmath135 .",
    "these properties are preserved by manipulations with variables and conjunction , because @xmath782 are co - clones .",
    "it remains to show that they are also preserved by max - implementation .",
    "suppose @xmath127 satisfies the filter property and @xmath783@xmath784 .",
    "observe that we may assume that for any @xmath785 the set @xmath786 does not contain any variable @xmath787 . indeed , if @xmath230=\\bb[j]$ ] for any assignment @xmath178 that satisfies @xmath2 , then we can identify these two variables , and denote the new variable by @xmath785 . the number of extensions of any assignment to @xmath187 does not change , therefore the relation @xmath168 defined in the same way from the new relation does not change .",
    "choose a representation @xmath139 of @xmath168 that uses @xmath788 , @xmath423 , @xmath421 .",
    "such a representation exists as the listed relations constitute a plain basis for @xmath720 by @xcite ( see table  [ tab : plain - post ] ) .",
    "take @xmath130 and @xmath789 ; let @xmath717 be the tuple such that @xmath718 .",
    "it suffices to verify that every extension @xmath167 of @xmath20 is also extension of @xmath717 .",
    "indeed , if this is the case , since @xmath20 has the maximum number of extensions , so does @xmath717 , and thus @xmath790 .",
    "suppose @xmath132 .",
    "then @xmath791 satisfies every relation @xmath788 from @xmath139 , as this tuple contains 1 in every position @xmath178 does .",
    "it also satisfies every relation @xmath423 , because there is no relation of the form @xmath792 , and @xmath793=\\ba'[j]$ ] whenever @xmath703 .",
    "finally , @xmath532 and @xmath727 are also satisfied , because no value is changed in the scopes of the former , and no value is changed to 0 in the scope of the latter .",
    "next we prove that the number of @xmath704-classes spanned by zeros of maximal tuples from the complement of @xmath168 does not exceed that of @xmath2 .",
    "more precisely we show that ( 1 ) @xmath794 for any @xmath281 $ ] , and ( 2 ) for every maximal tuple @xmath795 there is @xmath796 such that @xmath178 is a maximal tuple not belonging to @xmath2 .",
    "the first claim is obvious , as @xmath797}\\rel$ ] and therefore if @xmath230=\\ba[j]$ ] for any @xmath132 then @xmath604=\\bc[j]$ ] for any @xmath798 . observe that we may assume that @xmath799 for any @xmath800 , since otherwise such a variable does not affect the number of extensions of tuples from @xmath801}\\rel$ ] .",
    "for the second claim let @xmath20 be a maximal tuple not belonging to @xmath168 .",
    "suppose first that @xmath802}\\rel$ ] .",
    "since for any @xmath803}\\rel$ ] the tuple @xmath804 belongs to @xmath2 , the tuple @xmath805 is a maximal tuple not belonging to @xmath2 .",
    "next assume @xmath806}\\rel$ ] .",
    "let @xmath807 denote the set of extensions of a tuple @xmath808}\\rel$ ] to a tuple from @xmath2 . due to the filter property of @xmath2 and the assumption that no set @xmath786 contains any @xmath787 , if @xmath809 then @xmath810 . as @xmath20 is a maximal tuple not belonging to @xmath168 ,",
    "the number of extensions of any tuple @xmath717 , @xmath811 , is the same , including the all - one tuple @xmath517}$ ] .",
    "however , for any such tuple @xmath717 , @xmath812})$ ] and yet @xmath813})|$ ] implying @xmath814})$ ] . since @xmath815 for any tuple @xmath717 , @xmath811",
    ", there is @xmath167 such that @xmath816 and @xmath817 for any tuple @xmath717 , @xmath811 .",
    "choose a maximal @xmath818 , @xmath819 , with this property .",
    "we need to show that @xmath820 is a maximal tuple not belonging to @xmath2 . for any @xmath821 the tuple @xmath822 , because , by the choice of @xmath818 , it is a maximal tuple such that @xmath823 . for any @xmath717 , @xmath811",
    ", the tuple @xmath791 belongs to @xmath2 , and therefore @xmath824 .",
    "next we show that @xmath825 .",
    "co - clone @xmath826 contains all relations from @xmath721 invariant under the constant function  1 .",
    "so , we prove that any relation @xmath827 contains the all - one tuple .",
    "relations @xmath828 , and @xmath788 satisfy this condition . manipulations with variables and conjunction preserves this property .",
    "it remains to verify that @xmath10 also preserves this property in @xmath720 .",
    "let @xmath829 and @xmath830 .",
    "let also @xmath831 . as before we may assume that for any @xmath785 the set @xmath786 does not contain any variable @xmath787 .",
    "then since @xmath832})$ ] , where @xmath517}$ ] is the all - one tuple , for any @xmath806}\\rel$ ] , @xmath517}\\in\\relo$ ] .",
    "[ lem : or - generation ] let @xmath833 , then @xmath834 .",
    "first of all @xmath2 can be assumed to be closed under @xmath412 .",
    "indeed , @xmath444 is not self - complement , affine , or closed under @xmath413 ; so if @xmath2 is not closed under @xmath835 the result follows from lemma  [ lem : out - max - generation ] .",
    "we also may assume that every unary projection of @xmath2 contains two elements .",
    "next , observe that we can also assume that for each variable @xmath506 of @xmath2 the set @xmath836 contains only one element . indeed , construct a relation @xmath488 by identifying all variables in every set of the form @xmath836 .",
    "it now suffices to verify that @xmath837 whenever @xmath833 . to see this note that @xmath2 can be obtained from @xmath488 through adding new variables and imposing equality relations .",
    "if @xmath2 contains the all - zero tuple then by lemma  [ lem : monotone - generation ] @xmath586 and the result follows from lemma  [ lem : imp - generation ] .",
    "suppose that the all - zero tuple does not belong to @xmath2 .",
    "we show that either @xmath2 satisfies the filter property , and therefore belongs to @xmath720 , or there is a nontrivial relation @xmath838 containing the all - zero tuple . by what is proved above",
    "it implies the result .    for @xmath29",
    "we denote by @xmath839 the relation obtained as follows .",
    "let @xmath840 denote the set of coordinate positions in which @xmath20 equals 1 .",
    "then @xmath841 if @xmath839 is a nontrivial relation then we are done , since the all - zero tuple belongs to @xmath839 .",
    "therefore assume that every relation @xmath839 is trivial .",
    "observe that since @xmath842 for any @xmath710 and @xmath801-o(\\ba)}(\\ba\\join\\bb)= \\pr_{[n]-o(\\ba)}\\bb$ ] , we have @xmath843-o(\\ba)}\\rel$ ] .",
    "therefore every set of the form @xmath836 for @xmath839 is 1-element .",
    "hence @xmath844 . in particular , for any @xmath29 and any @xmath845 the tuple @xmath167 obtained from @xmath20 by changing @xmath230 $ ] to 1 belongs to @xmath2 .",
    "thus @xmath2 satisfies the filter property .",
    "[ pro : infinite - chains ] every max - co - clone of monotone relations containing a nontrivial relation equals one of @xmath846 , @xmath720 , @xmath847 , @xmath848 for @xmath849 , @xmath443 .    by lemmas  [ lem : im2-clone ] and  [ lem : is - clones ] all these sets are max - co - clones . by lemma  [ lem : imp+-generation ] and the observation that",
    "@xmath613 , max - co - clone @xmath443 is the only max - co - clone containing @xmath442 . by lemma  [ lem : or - generation ]",
    "@xmath720 is the greatest max - co - clone containing @xmath444 .",
    "thus it remains to prove that there are no max - co - clones containing @xmath444 and different from @xmath850 for @xmath849 .",
    "it follows from lemma  [ lem : nand - generation ] .      in this section",
    "we consider the remaining case of self - complement max - co - clones .",
    "[ pro : self - dual ] there is only one max - co - clone of self - complement relations that is not a subclone of @xmath495 .",
    "it is @xmath440 , the clone of all self - complement relations .",
    "the proposition follows from the following four lemmas .",
    "[ lem : in - clone ] @xmath440 is a max - co - clone .",
    "we need to prove that @xmath440 is closed under manipulations with variables , conjunction , and max - implementation .",
    "since @xmath440 is a co - clone , it is closed under the first two operations .",
    "let @xmath851 and @xmath831 .",
    "let @xmath130 and let @xmath414 denote its complement .",
    "then for each extension @xmath852 of @xmath20 the tuple @xmath853 belongs to @xmath2 , as @xmath2 is self - complement , and @xmath853 is an extension of @xmath414 .",
    "therefore @xmath414 has the same number of extensions as @xmath20 , and so @xmath854 .",
    "thus , @xmath168 is self - complement .",
    "[ lem : compl - extraction ] let @xmath2 be a self complement relation that does not belong to @xmath495 ( that is , non - affine ) , then @xmath855 or @xmath856 .",
    "let @xmath27 satisfy the conditions of the lemma .",
    "there are two cases .",
    "@xmath2 does not contain the all - zero tuple .",
    "observe first that in this case @xmath857 contains the disequality relation . indeed , let @xmath29 and let @xmath418 $ ] be the set of indices such that @xmath230=0 $ ] if and only if @xmath420 . since the all - zero tuple does not belong to @xmath2 , @xmath858 $ ] . without loss of generality",
    "let @xmath777 $ ] .",
    "then it is easy to see that @xmath859 is the disequality relation .",
    "as @xmath481 , by lemma  4.10 of @xcite there are tuples @xmath482 such that @xmath483 . rearranging the variables these tuples",
    "can be represented as shown in the table below .",
    "@xmath860 denote by @xmath488 the relation obtained from @xmath2 by identifying variables as shown in the last row of the table , and then set @xmath861 relation @xmath497 contains tuples @xmath862 but does not contain @xmath540 , and so does not belong to @xmath495 .",
    "there are 16 cases depending on whether or not tuples ( a ) @xmath863 , ( b ) @xmath864 , ( c ) @xmath494 , and ( d ) @xmath865 belong to @xmath497 ( remember , this relation is self complement ) .",
    "if none of them belong to @xmath497 then @xmath866 .",
    "suppose first @xmath867 .",
    "if ( a ) belongs to @xmath497 then @xmath868 ; if ( b ) is in @xmath497 then @xmath869 ; finally , if ( c ) is in @xmath497 then @xmath870 .",
    "suppose now ( d ) belongs to @xmath2 .",
    "if ( a ) is not there then @xmath871 .",
    "if ( a ) is also in @xmath2 , then @xmath872 .",
    "the all - zero tuple belongs to @xmath2 .",
    "again by lemma  4.10 of @xcite there are tuples @xmath482 such that @xmath483 , but @xmath20 can be chosen to be the all - zero tuple . then after rearranging variables these tuples can be represented as follows @xmath492 denote by @xmath488 the relation obtained from @xmath2 by identifying variables as shown in the last row of the table .",
    "relation @xmath488 contains tuples @xmath493 but does not contain @xmath494 , and so does not belong to @xmath495 .",
    "there are 16 cases depending on whether or not tuples ( a ) @xmath873 , ( b ) @xmath874 , ( c ) @xmath875 , and ( d ) @xmath876 belong to @xmath488 . if none of the tuples belong to @xmath488 or all of them belong to @xmath488 , then @xmath877 . in the first case it is 1-quantification , and in the second case it is 2-quantification .",
    "if exactly one of ( a ) and ( b ) belongs to @xmath488 then up to permutation of variables @xmath878 .",
    "if exactly one of ( a ) and ( d ) belongs to @xmath488 then up to permutation of variables @xmath879 .",
    "finally , if exactly one of ( c ) and ( d ) belongs to @xmath488 then up to permutation of variables @xmath880 .",
    "[ lem : self - dual - generation ] if @xmath881 then @xmath882 .",
    "observe first that @xmath883 also , @xmath884 since @xmath885 , the equalities above imply that if @xmath886 then @xmath887 .",
    "now it suffices to show that @xmath888 .",
    "we start with the relation given by the following formula @xmath889 }   \\compl_{k+1,0}(x_{i_1}\\zd x_{i_k},y_{j_i})\\\\ & & \\meet \\bigwedge_{i\\sse[2k],|i|=k}\\neq(y_{j_i},y_{j_{\\ov i}}).\\end{aligned}\\ ] ] here @xmath890 is some enumeration of the @xmath0-element subsets of @xmath891 $ ] .",
    "we are interested in assignments of @xmath892 and the number of ways such an assignment can be extended to a satisfying assignment of @xmath139 .",
    "first , observe that the only assignments of @xmath892 that can not be extended are the all - zero and all - one assignment .",
    "second , since @xmath139 is symmetric with respect of permutations of @xmath893 in the sense that for any permutation of this set there is a permutation of the @xmath894 s that keeps the formula unchanged , the number of extensions of an assignment of @xmath892 depends only on the number of 0 s in the assignment .",
    "we will denote this number by @xmath895 , where @xmath104 is the number of zeros .",
    "notice that @xmath139 defines a self - complement relation , therefore , we always assume that the number of zeros is at least @xmath0 . as is easily seen ,",
    "if a tuple @xmath20 has @xmath896 zeros , it can be extended in @xmath897 ways .",
    "indeed , @xmath898 is uniquely defined by @xmath20 if @xmath767 or @xmath899 is a subset of the set of zeros of @xmath20 .",
    "otherwise it can take any value independently of the values of other variables , except that @xmath900 .",
    "let @xmath901 be the relation given by : if @xmath902 then @xmath188 can be any , otherwise @xmath903 .",
    "relation @xmath168 is an intersection of some relations @xmath904 with @xmath905 .",
    "therefore by ( [ equ : switching ] ) it belongs to @xmath906 .",
    "set @xmath907 }   \\relo(x_{i_1}\\zd x_{i_k},y_{j_i}),\\ ] ] and consider @xmath908 , where @xmath909 have the same variables @xmath785 , but the sets of the auxiliary variables @xmath894 are disjoint .",
    "observe that @xmath910 .",
    "similarly to @xmath139 , @xmath911 , provided @xmath896 .",
    "indeed , variable @xmath912 can be assigned any value if @xmath913 for all @xmath420 ; otherwise @xmath912 can take only one value .",
    "therefore for any @xmath914 @xmath915 and @xmath916 . thus @xmath917 .",
    "it now remains to apply proposition  3 of @xcite that claims , in particular , that the relation @xmath437 constitute a plain basis of @xmath440 .",
    "the results of the previous section can be used to reprove some complexity results , namely , that of @xcite . if for counting problems @xmath69 and @xmath78 there are approximation preserving reductions from @xmath69 to @xmath78 , and from @xmath78 to @xmath69 , we denote it by @xmath918 .",
    "the problem @xmath919 plays a special role in this result .",
    "this problem can also be interpreted as the problem of counting the number of independent sets in a bipartite graph , @xmath920 , or as the problem of counting antichains in a partially ordered set @xcite .",
    "the problem of counting the number of satisfying assignments to a cnf , @xmath921 , is predictably the most difficult problem among counting csps .",
    "[ the : boolean trichotomy ] let @xmath3 be a set of relations over @xmath922 .",
    "if every relation in @xmath3 is affine then @xmath923 is in solvable in polynomial time . otherwise if every relation in @xmath3 is in @xmath443 then @xmath924 .",
    "otherwise @xmath925 .",
    "the @xmath926 over affine relations can be solved exactly in polynomial time , as it is proved in @xcite .",
    "if @xmath3 contains @xmath444 or @xmath445 , the problem @xmath56 is interreducible with @xmath921 by theorem  3 of @xcite ( observe that the problem # is of counting the number of independent sets in a graph can be represented as @xmath927 ) . by theorems  [ the : max - implementation ] and  [ the : max - post ]",
    "this leaves only two max - co - clones to consider , @xmath443 and @xmath440 .",
    "since @xmath443 is generated by @xmath442 and by lemma  [ lem : monotone - generation ] , for any @xmath928 the problem @xmath56 is either polynomial time solvable , or is interreducible with @xmath920 .",
    "the remaining max - co - clone , @xmath440 is generated by @xmath929 that contains all tuples such that not all their entries are equal ; this is why it is sometimes called the not - all - equal relation , or nae .",
    "therefore for any @xmath930 such that @xmath931 the problem @xmath56 is interreducible with @xmath932 .",
    "by @xcite the decision problem @xmath933 is np - complete .",
    "therefore by theorem  1 of @xcite @xmath932 is interreducible with @xmath921 .",
    "observe also that some co - clones are not max - co - clones , even those co - clones are generated ( or ` determined ' ) by surjective functions .",
    "for instance , @xmath934 or @xmath935 .",
    "since on a 2-element set every quantification with @xmath194 is equivalent to either existential , or universal quantification , and therefore @xmath195 can be any set of relations of the form @xmath46 for a set of surjective functions @xmath45 , we obtain the following                                  n. creignou .",
    "kolaitis , and b. zanuttini .",
    "structure identification of boolean relations and plain bases for co - clones . .",
    "siam monographs on discrete mathematics and applications , vol .",
    "7 , siam , 2001 ."
  ],
  "abstract_text": [
    "<S> we introduce a new type of closure operator on the set of relations , max - implementation , and its weaker analog max - quantification . </S>",
    "<S> then we show that approximation preserving reductions between counting constraint satisfaction problems ( # csps ) are preserved by these two types of closure operators . together with some previous results </S>",
    "<S> this means that the approximation complexity of counting csps is determined by partial clones of relations that additionally closed under these new types of closure operators . </S>",
    "<S> galois correspondence of various kind have proved to be quite helpful in the study of the complexity of the csp . while we were unable to identify a galois correspondence for partial clones closed under max - implementation and max - quantification </S>",
    "<S> , we obtain such results for slightly different type of closure operators , @xmath0-existential quantification . </S>",
    "<S> this type of quantifiers are known as counting quantifiers in model theory , and often used to enhance first order logic languages . </S>",
    "<S> we characterize partial clones of relations closed under @xmath0-existential quantification as sets of relations invariant under a set of partial functions that satisfy the condition of @xmath0-subset surjectivity . </S>",
    "<S> finally , we give a description of boolean max - co - clones , that is , sets of relations on @xmath1 closed under max - implementations .    </S>",
    "<S> this is an extended version of @xcite .    </S>",
    "<S> [ theorem]corollary [ theorem]proposition [ theorem]lemma [ theorem]observation [ theorem]definition [ theorem]example    = = = = =    = = =    = # 1#1 # 1 # 1#1 _ # 1#1 ^1 _ # 1#2#1 _ 1#1 _ # 2 # 1#2    (    c # 1 + # 2    )    # 1#2#3    (    c # 1 + # 2 + # 3    )    =    = = = = = = = =    = eufm10 scaled 1200 = eufm6 12=12=12= = msbm10 = msbm8 11=11=11= = msbm10 scaled 1200 13=13= 13= = `` 0b4e = ' ' 0d3f    # 1p^k,(#1)_d # 1f^k,(#1)_d # 1p^(#1)_d # 1f^(#1)_d </S>"
  ]
}