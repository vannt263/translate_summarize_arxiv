{
  "article_text": [
    "general - purpose quantum computers hold the promise of achieving quantum speed - ups in many problems of practical importance , unmatched by any known classical methods @xcite . while the prospect of such speed - ups is exciting , a growing realization is the extreme difficulty of achieving the levels of precision and control required for building truly scalable , fault - tolerant quantum hardware . as an intermediate step towards this goal ,",
    "several recent proposals have suggested the development of special - purpose quantum devices which achieve so - called  quantum supremacy \" in certain tasks @xcite . instead of solving general computational problems , these devices instead sample from probability distributions widely believed to be impossible to simulate efficiently using classical means .",
    "the recent explosion of proposals for such classically intractable sampling devices has begun to be matched by actual demonstrations of sampling in the laboratory @xcite , although so far still at small enough scales to allow for exact classical simulation .",
    "an important question regarding such proposals is how far , and in what manner , we can reduce the resources required to exhibit and certify a genuine quantum advantage in sampling .",
    "the boson sampling protocol @xcite shows that such quantum advantage can be achieved using simple linear optical devices and single - photon detectors . however , there are many challenges facing a realistic implementation of boson sampling , including the parallel generation of many single photons , the precise timing constraints on these photons , and the robust and accurate arrangement of the required beam splitters and phase shifters .",
    "an alternative proposal which circumvents this bottleneck is the family of instantaneous quantum polynomial - time ( iqp ) protocols @xcite , where sampling distributions arise from single - qubit measurements on the output of low - depth commuting quantum circuits . if a quantum device can prepare sampling distributions associated with any unitary within a circuit family , then that process would be classically intractable under reasonable conjectures from complexity theory .",
    "furthermore , the commuting nature of these quantum circuits means that they can potentially be engineered to run in constant time , maximally avoiding the threat of environmental noise and decoherence .",
    "however , a practical issue which arises here is the extreme difficulty of engineering the arbitrary long - range interactions needed for such a constant time implementation .",
    "while these long - range interactions can be simulated by bringing distant qubits together using @xmath0 gates before applying local entangling operations , this process would introduce a new bottleneck , the growing time required to shuttle qubits between local interaction regions . in the absence of quantum error correction , the growing influence of decoherence",
    "would quickly degrade the quality of our sampling distributions , making this straightforward implementation likely untenable for practical demonstrations of quantum supremacy .    in this paper ,",
    "we show how nonadaptive measurement - based quantum computation ( mqc ) @xcite can be used to sample from the distributions associated with iqp circuits , while at the same time verifying the classical intractability of this sampling process .",
    "our protocol uses a fixed resource state preparable by a constant - depth local circuit , which is then nonadaptively measured at each site in the pauli @xmath1 , @xmath2 , or @xmath3 bases .",
    "the setting of nonadaptive mqc allows us to replace the time complexity present in local iqp circuits ( with @xmath0 gates ) by a spatial overhead in our resource state , which results in a protocol with constant runtime and local interactions .",
    "the cost of this nonadaptivity is a fundamental randomness in the distributions prepared by our protocol , arising from random mqc byproduct operators .",
    "this leads each sample in our protocol to be obtained with high probability from a different sampling distribution every time .",
    "surprisingly , we show that this inherent randomness has no impact on the hardness of our protocol , which remains classically intractable under the same assumptions as in @xcite . what s more , we show that these random byproduct operators actually simplify our implementation relative to a direct circuit - based counterpart , revealing an inherent advantage of mqc for quantum sampling protocols .",
    "we further show that by simply changing the single - qubit pauli measurements used to obtain sampling statistics , we can rigorously verify the classical intractability of our sampling .",
    "our verification scheme is inspired by the ground state certification protocol of @xcite , but uses the special form of our iqp sampling distributions to replace the nonlocal operations required for general hamiltonian measurements with measurements of single - qubit pauli operators .",
    "this lets us switch between sampling and measurement by a simple change in single - qubit measurement bases , allowing our procedure to achieve a robust demonstration of quantum supremacy capable of efficiently detecting any errors which could potentially harm the correctness of our sampling distributions .",
    "our protocol is closely related to that of @xcite , as it constitutes a faithful translation of their circuit - based iqp sampling into the context of mqc .",
    "however , we show that this translation itself contains several surprises , ultimately revolving around the nontrivial interface of mqc byproduct operators with classically intractable sampling . at first glance , our protocol has much in common with @xcite , which also use nonadaptive mqc to perform classically intractable sampling and verification . upon further investigation however ,",
    "the different protocols are seen to utilize completely different mechanisms for demonstrating quantum supremacy . while using a more involved resource state than the ising - like states of @xcite , the design of our protocol allows for a convenient duality between sampling and verification , in which sampling and verification are both implemented using only single - qubit measurements on our output sampling state .    in section  [ sec : background ] , we review the relevant theory behind iqp sampling , verification , and mqc . in section  [ sec : protocol ]",
    "we present our protocol for preparing , sampling from , and verifying different classically intractable sampling distributions using pauli measurements on a model resource state @xmath4 . in section  [ sec : outlook ]",
    "we comment on the features unique to our protocol , and outline future directions for our work . a brief comparison of our proposal to other proposals within the rapidly growing field of classically intractable sampling can be found in appendix  [ sec : comparison ] , with detailed proofs of the classical intractability and verification of our sampling protocol found in appendices  [ sec : preparation ] , [ sec : sampling ] and [ sec : verification ] .",
    "in the iqp sampling protocols of @xcite , a sampling state @xmath5 is first prepared using an @xmath6-qubit diagonal unitary circuit @xmath7 , and is then measured everywhere in the pauli @xmath1 basis to obtain a random outcome @xmath8 . in the above , @xmath9 denotes the @xmath10 eigenstate of @xmath1 , @xmath11 the single - qubit hadamard operator , @xmath12 a bit string of length @xmath6 , and @xmath13 the corresponding @xmath3 basis product state .",
    "if @xmath7 is chosen from an appropriate family of diagonal unitaries , then @xcite shows that the act of sampling from the distribution @xmath14 is impossible to perform in polynomial time using a classical computer , assuming the widely conjectured non - collapse of the polynomial hierarchy of complexity theory @xcite .",
    "more generally , we use the phrase classically intractable sampling to mean any sampling protocol which shares this property of being impossible to simulate classically ( given the non - collapse of the polynomial hierarchy ) , possibly in the presence of some allowable error and under the assumed truth of additional mathematical conjectures .",
    "we now choose the @xmath6-qubit unitary gates @xmath7 above to be parameterized by @xmath6-bit binary functions @xmath15 , where @xmath16 denotes the finite field of binary numbers .",
    "the functions @xmath17 set the eigenvalues of @xmath7 as @xmath18 where @xmath19 .",
    "when applied to @xmath20 , this results in the sampling state @xmath21 we can alternately describe @xmath22 as the unique state satisfying the @xmath6 ( nonlocal ) stabilizer relations @xmath23 for @xmath24 , where @xmath25 and the polynomial @xmath26 is equal to the difference @xmath27 because addition in @xmath28 is modulo 2 , it is easy to verify that @xmath29 is always independent of the value of @xmath30 .",
    "we now restrict our binary functions to be cubic polynomials , so that @xmath31 can be written in the form @xmath32 for some binary coefficients @xmath33 , @xmath34 , and @xmath35 .",
    "these are generated by linear , quadratic , and cubic monomials , whose associated diagonal unitary gates are @xmath36 , @xmath37 ( controlled-@xmath3 ) , and @xmath38 ( controlled - controlled-@xmath3 ) . in the following , any references to polynomials will be understood to refer specifically to binary polynomials .",
    "we will use @xmath39 , @xmath40 , and @xmath41 to denote homogeneous polynomials , for which the only nonzero coefficients are of the form @xmath33 , @xmath34 , or @xmath35 , respectively .",
    "similarly , @xmath42 and @xmath43 will denote polynomials for which all @xmath44 or all @xmath45 , respectively",
    ".    it will be convenient in the following to interpret @xmath6-bit vectors @xmath46 as linear polynomials of @xmath6 variables , which act as @xmath47 this is useful in giving the probability of different sampling outcomes , as the probability of obtaining any given @xmath48 when @xmath22 is measured in the @xmath1 product basis is @xmath49 @xmath50 refers here to the square of @xmath51 , the ( signed ) difference between the fraction of inputs yielding @xmath52 and @xmath53 .",
    "@xmath51 is known to be # p - hard to compute for arbitrary cubic polynomials @xmath17 @xcite , and we will see that this hardness underlies the classical intractability of our sampling protocol .      it is shown in @xcite that estimating the quantity @xmath50 up to @xmath54 multiplicative error , so that @xmath55 for arbitrary cubic polynomials @xmath17 , is # p - hard , mirroring the difficulty of computing @xmath51 .",
    "this hardness leads to a similar finding as in @xcite , that exactly sampling from the cubic polynomial distributions @xmath56 defined in eq .",
    "( [ eq : distribution ] ) is classically intractable . in particular , assuming the existence of a classical randomized algorithm which can efficiently sample from any of the distributions @xmath56 lets a technique called stockmeyer approximate counting @xcite be used to estimate the probabilities @xmath57 up to @xmath54 multiplicative error , and thus to solve arbitrary # p problems .",
    "while stockmeyer counting is an unphysical process which can not be implemented with realistic classical or quantum computers , it can be carried out at a finite level of the polynomial hierarchy , and the hardness of # p problems for this hierarchy then leads to its collapse .",
    "details of this process can be found in appendix  [ sec : sampling ] . on the other hand ,",
    "we have seen that these distributions appear naturally as the output distributions of the iqp sampling protocol described above , which allows us to interpret a concrete implementation of this protocol as a provable demonstration of  quantum supremacy \" .    while straightforward and conceptually compelling , a major limitation of the above result is the impossibility of verifying that any realistic quantum protocol is sampling from _ exactly _ the ideal distribution @xmath56 @xcite . in order to demonstrate quantum supremacy in a more realistic setting , an alternate proof is given in @xcite which shows the classical intractability of sampling from any distribution @xmath58 which is variationally close to @xmath59 .",
    "variationally close means here that the statistical distance between @xmath58 and @xmath59 is bounded by a constant @xmath60 , so that @xmath61 in @xcite a value of @xmath62 was shown to be sufficient for classically intractable sampling , which in appendix  [ sec : sampling ] we show can be relaxed to @xmath63 ( although both values rely on the particular value of @xmath64 appearing in conjecture  [ conj ] below ) .",
    "this result is appealing from a practical standpoint , as the quantity @xmath65 can be efficiently estimated in experiments involving quantum sampling distributions .    on the other hand , the above  average - case \" sampling result relies upon one additional complexity theoretic conjecture :    [ conj ] let @xmath17 be an arbitrary cubic polynomial of the form given in eq .",
    "( [ eq : cubic_poly ] ) .",
    "then it is # p - hard to efficiently calculate an estimate @xmath66 of @xmath50 for which @xmath67 , on at least @xmath68 of polynomials @xmath17 .",
    "intuitively , this conjecture states that even when our estimates @xmath66 are allowed to fail with some finite probability @xmath64 , corresponding to realistic errors in our sampling distributions @xmath58 , the problem of estimating @xmath50 on the remaining instances is still # p - hard .",
    "while this reliance on an additional unproven conjecture is nt desirable , an analogous conjecture is required for every known average - case classically intractable sampling result , and thus is nt any special demerit of @xcite .",
    "the techniques of @xcite can be used to efficiently verify the condition @xmath69 when @xmath58 arises from measurements on experimentally prepared quantum sampling states @xmath70 , which approximate our intended @xmath22 .",
    "given @xmath70 , we can perform measurements of the nonlocal hermitian stabilizers @xmath71 defined in eq .",
    "( [ eq : hami ] ) , which will always yield the outcome @xmath10 in the ideal case where @xmath72 . in more general cases ,",
    "a sufficiently accurate empirical estimate of these @xmath6 observables @xmath71 can be converted into a bound on the statistical distance between the distributions @xmath58 and @xmath59 .",
    "if the average @xmath73 is sufficiently close to @xmath10 so as to guarantee @xmath69 , then we can confidently conclude that our quantum protocol is performing classically intractable sampling .",
    "we will soon show that the nonlocal measurements of @xmath71 can actually be replaced with single - qubit @xmath1 and @xmath3 measurements , which allows this verification to be done entirely in the setting of mqc .",
    "mqc is a means of carrying out computation using only single - qubit measurements on a fixed many - body resource state . in this framework",
    ", the choice of measurements made on local regions of our resource state determines logical operations which are applied to encoded logical qubits , while simultaneously teleporting these qubits to adjacent unmeasured sites .",
    "the randomness of quantum measurement leads the outcomes of these measurements to determine a so - called byproduct operator , which acts as a random correction to the overall logical operation .",
    "for example , in figure  [ fig : gadgets]a we show the standard protocol for teleporting one logical qubit within the mqc quantum wire known as the 1d cluster state . given two successive @xmath1 measurements with outcomes @xmath74 and @xmath75 , the resultant logical operation is @xmath76 , showing the intended logical unitary to be the identity and the byproduct operator to be a random pauli @xmath77 . in figure  [ fig : gadgets]b we show a gadget for performing the two - qubit @xmath0 operation on logical qubits , for which the byproduct operator is a random two - qubit pauli operator . in both of these examples ,",
    "the collection of operators appearing as byproducts for arbitrary measurement outcomes form a closed group ( up to global phase ) of finite size , referred to as a byproduct group .",
    "an mqc protocol is said to be adaptive if the choice of measurement in some region of our resource state depends on the outcome of measurements made in another region .",
    "adaptation can be seen as a means of ensuring that the byproduct group associated with a large computation remains finite ( for example , contained within the @xmath6-qubit pauli group ) , whereas the use of nonadaptive mqc with arbitrary single - qubit measurements will generally lead to a byproduct group of unbounded size . on the other hand ,",
    "nonadaptive mqc computations can always be implemented in constant time by performing all measurements simultaneously , a serious advantage in the absence of quantum error correction . within the usual scheme for universal mqc using resource states built from @xmath78 gates ,",
    "nonadaptive single - qubit pauli measurements are associated with byproduct groups formed from pauli operators , and implement logical operations contained within the clifford group .",
    "the clifford group is defined as those unitaries @xmath79 which preserve the pauli group under conjugation , so that @xmath80 is a product of pauli operators whenever @xmath81 is .",
    "the evolution of pauli eigenstates under the clifford group is known to be efficiently simulable using classical means @xcite , which means that non - clifford operations are necessary for demonstrating quantum supremacy .     per measurement (",
    "not shown ) .",
    "mathematically , this leads our measurement outcomes @xmath82 to occur uniformly randomly .",
    "( a ) 1d cluster state wire of length 2 , where solid lines indicate @xmath78 formation unitaries .",
    "measuring @xmath1 on two sites implements the identity , with a uniformly random pauli byproduct group .",
    "( b ) planar mqc gadget for implementing nonplanar wire crossings .",
    "measuring @xmath1 on 6 sites implements @xmath0 , with a byproduct group of uniformly random two - qubit pauli operators .",
    "( c ) non - clifford gadget for conditional @xmath83 , where blue triangles indicate @xmath83 gates used to form the gadget .",
    "measuring @xmath2 on 3 non - logical control sites ( red ) gives @xmath83 on sites @xmath84 ,",
    "@xmath85 , and @xmath86 , whereas measuring @xmath3 on these sites instead gives the identity . in both cases , the teleportation is trivial ( output and input sites coincide ) , while the byproduct group is a product of uniformly random @xmath78 s between @xmath84 and @xmath86 , and between @xmath85 and @xmath86.,scaledwidth=49.0% ]    in figure  [ fig : gadgets]c , we give an example of an mqc gadget which implements a non - clifford @xmath83 gate when nonadaptive pauli measurements are applied .",
    "this gadget , which will be utilized in our classically intractable sampling protocol below , is itself formed from non - clifford @xmath83 gates , and has a byproduct group containing non - pauli @xmath78 gates .",
    "a similar gadget was shown in @xcite to enable universal mqc using only pauli measurements , but with adaptation of measurement bases so as to avoid a byproduct group of unbounded size . in our mqc sampling protocol",
    "below , we will show that restricting our logical operations to those generating sub - universal quantum computation will allow us to avoid this use of adapation , while still maintaining a byproduct group of finite size .",
    "in fact , we will find that this non - pauli byproduct group actually leads to a simplification in our protocol relative to circuit - based counterparts .",
    "our mqc implementation of the classically intractable sampling protocol of @xcite uses nonadaptive pauli measurements to prepare , sample from , and verify the @xmath6-qubit sampling states @xmath22 described above , for arbitrary cubic polynomials @xmath17 .",
    "our protocol uses a 2d resource state @xmath4 which is capable of preparing any sampling state @xmath22 using only single - qubit pauli measurements .",
    "@xmath4 is constructed from the teleportation , @xmath0 , and @xmath83 gadgets described in section  [ sec : mqc ] , which are configured to implement any of the iqp circuits @xmath87 associated with arbitrary homogeneous cubic polynomials @xmath39 .",
    "the choice of @xmath39 is determined by the choice of pauli measurement basis applied to each @xmath83 gadget in @xmath4 . by virtue of the byproducts arising from our nonadaptive mqc implementation ,",
    "our output sampling states end up being random @xmath22 where @xmath88 is a sum of the intended @xmath39 , along with random quadratic and linear polynomials @xmath40 and @xmath41 . owing to this randomness in @xmath42 ,",
    "we are unable to deterministically prepare any fixed sampling state @xmath22 . despite this fundamental indeterminism",
    ", we will show how the act of sampling from randomly prepared @xmath22 with @xmath1 measurements at the final stage of our protocol remains classically intractable , even in the presence of realistic noise which leads our output sampling distributions to be some imperfect @xmath58 .",
    "we state the classical intractability of our protocol , and the precise conditions which guarantee this , as theorem  [ thm : one ] .",
    "[ thm : one ] assume the validity of conjecture  [ conj ] and the non - collapse of the polynomial hierarchy .",
    "if the distributions @xmath89 arising from our mqc sampling protocol are close on average to the distributions @xmath57 defined in eq .",
    "( [ eq : distribution ] ) , meaning that the average @xmath90 norm over all @xmath17 meets the experimental threshold @xmath91 , then our protocol is impossible to efficiently simulate using a classical computer , i.e. is classically intractable .",
    "our protocol for classically intractable sampling is divided into two stages : preparation of the random sampling state @xmath22 and sampling / verification measurements on @xmath22 ( see figure  [ fig : protocol ] ) . in the preparation stage , we use @xmath92 single - qubit measurements of pauli @xmath1 , @xmath2 , and @xmath3 on @xmath4 with outcomes @xmath93 to prepare the @xmath6-qubit state @xmath94 associated with a @xmath95-dependent polynomial @xmath96 .",
    "these measurements are chosen to implement the unitary @xmath87 by means of a depth @xmath97 quantum circuit built from local @xmath83 and @xmath0 gates .",
    "the @xmath83 gates in this ideal circuit are applied conditionally as @xmath98 , depending on the coefficients of @xmath39 , with teleportation and @xmath0 gates used before each application to move qubits @xmath99 , @xmath100 , and @xmath101 into the same region .",
    "the application of these conditional @xmath83 s is structured within three nested levels of iteration , which together apply all @xmath102 three - body terms in the lexicographic order of the triples @xmath103 , where @xmath104 .",
    "loop i , the lowest level of iteration , involves fixing qubits @xmath99 and @xmath100 in a designated interaction region , then successively cycling the remaining qubits @xmath105 through this region .",
    "@xmath98 is applied in turn to each triple , until all triples @xmath103 with fixed @xmath99 and @xmath100 have been processed in this manner .",
    "loop ii , the next level of iteration , involves successively replacing qubit @xmath100 by qubit @xmath106 , then repeating loop i for all qubits @xmath107 until all triples @xmath103 with fixed @xmath99 have been processed .",
    "finally , loop iii involves successively replacing qubit @xmath99 by qubit @xmath108 , in the process shifting the location of the interaction region , and repeating loop ii for all qubits @xmath109 until @xmath98 has been applied to all triples of qubits .",
    "the resulting unitary operation is clearly @xmath87 .",
    "while the simple circuit described above is only capable of producing sampling states @xmath110 associated with homogeneous cubic @xmath39 , our mqc implementation utilizes random byproduct operators to implement the remaining quadratic and linear terms required for the preparation of arbitrary @xmath22 .",
    "this reveals a simplification within nonadaptive mqc compared to a direct circuit - based counterpart , which would require additional @xmath78 and @xmath3 gates to implement @xmath7 for arbitrary @xmath17 .",
    "each of the conditional operations @xmath98 is implemented using the @xmath83 gadget shown in figure  [ fig : gadgets]c , which is measured in @xmath2 if @xmath111 and @xmath3 otherwise . for either choice of measurement",
    ", the non - clifford nature of these gadgets leads the resultant byproduct operators to consist of non - pauli @xmath78 gates , which generate random quadratic terms in the output @xmath22 . because our logic gates and byproduct operators are made up of @xmath1 and the diagonal @xmath3 , @xmath78 , and @xmath83 gates , which together form a closed ( non - universal ) gate set under multiplication , the byproduct group associated with our computation",
    "will always remain finite .",
    "the @xmath83 gadgets used in our protocol are embedded in regular intervals in @xmath4 , and are then connected together using 1d cluster wires and @xmath0 gadgets , which simulate the movement of qubits utilized in our ideal quantum circuit described above .",
    "these cluster wires and @xmath0 gadgets are always measured in @xmath1 , which leads to a product of random pauli @xmath1 and @xmath3 byproduct operators .",
    "the @xmath3 byproducts eventually end up generating random linear terms in the output state @xmath22 , while the @xmath1 byproducts can be commuted backwards in our circuit , to eventually be annihilated on the initial @xmath20 which our logical quantum circuit is applied to .",
    "this commutation of @xmath1 byproduct operators induces conditional @xmath112 and @xmath113 byproduct operators arising from prior @xmath83 gadgets , which results in additional randomness in the overall byproduct group . despite this seeming complexity in the distribution of byproduct operators , we prove in appendix  [ sec : preparation ]",
    "that the random outcomes @xmath95 of preparation measurements on @xmath4 lead the random quadratic and linear terms in the polynomial @xmath88 associated with @xmath22 to be uniformly random , simplifying our analysis .    in the second stage of our protocol",
    "we apply a final series of @xmath6 single - qubit pauli measurements to our output state which , while ideally equal to @xmath114 , will realistically be some mixed state @xmath70 .",
    "the choice of single - qubit measurement bases depends on whether we are implementing sampling or verification , which can be chosen randomly with @xmath115 probability . during sampling",
    ", we simply measure all qubits in the @xmath1 basis to generate a sample from the distribution @xmath116 , exactly as described in section  [ sec : intractable ] .",
    "although the randomness in the @xmath17 associated with @xmath70 means that we will almost certainly obtain each sample from a different distribution @xmath58 , our mqc sampling protocol remains classically intractable nonetheless . to prove this classical intractability",
    ", we can treat the overall process of preparing a random @xmath70 and then sampling an outcome @xmath117 as itself a sampling process with probability @xmath118 .",
    "given this description , and our knowledge of the complete randomness of the byproduct contributions @xmath42 , stockmeyer approximate counting can then be used to estimate @xmath89 as a conditional probability which is directly proportional to @xmath118 .",
    "this suffices to proves theorem  [ thm : one ] using the same arguments as in other classically intractable sampling proposals , the details of which are given in appendix  [ sec : sampling ] .",
    "if we choose to perform verification instead of sampling , then we measure all qubits in the @xmath3 basis , except for a random qubit @xmath99 which is measured in @xmath1 .",
    "the outcome of this measurement @xmath119 is then fed into a parity function @xmath120 , where @xmath121 is defined in eq .",
    "( [ eq : partial ] ) .",
    "this process results in an output value of 0 or 1 , which we show in appendix  [ sec : verification ] gives the same information as a measurement of the nonlocal stabilizer @xmath71 described in eq .",
    "( [ eq : hami ] ) , with outcome @xmath122 .",
    "because of our ability to characterize the closeness of @xmath70 to @xmath114 using measurements of @xmath71 , this means that we can interpret @xmath123 as a successful verification measurement , and @xmath124 as a deviation of @xmath70 from our intended @xmath22 . by obtaining many samples of @xmath125 for random @xmath99 ,",
    "@xmath126 , and @xmath70 , the resultant estimate of @xmath127 lets us guarantee the classical intractability of our mqc sampling protocol to any desired statistical significance using only @xmath128 rounds of verification measurements , as stated in theorem  [ thm : two ] .",
    "[ thm : two ] suppose that the empirical average of our parity function after @xmath129 verification measurements satisfies @xmath130 , for the @xmath60 appearing in theorem  [ thm : one ]",
    ". then we can conclude with probability @xmath131 that our sampling distributions @xmath58 satisfy the assumptions of theorem  [ thm : one ] , and thus generate classically intractable sampling .",
    "we give a detailed proof of theorem  [ thm : two ] in appendix  [ sec : verification ] .",
    "we should mention that another potential means of verifying the classical intractability of our sampling protocol would have been to directly measure the @xmath132 local stabilizers of our resource state @xmath4 , analogous to the technique used in @xcite .",
    "the idea behind this verification scheme is that , if we guarantee our mqc resource state to be the ideal @xmath4 , then performing our prescribed pauli measurements should always generate the ideal sampling states @xmath22 .",
    "unfortunately , this resource state verification scheme does nt detect errors occurring during preparation measurements , so that even when given an ideal mqc resource state , measurement imperfections during state preparation will still lead to logical errors which harm our output sampling state @xmath70 . in order for this verification scheme to rigorously guarantee the classical intractability of sampling in our setting , the single - qubit error rates for measurement must be less than @xmath133 , whereas our verification technique only needs errors rates of @xmath134 .",
    "since this latter rate is the maximum allowed for any kind of sampling to maintain a constant variational error , this shows our verification scheme to be optimal with regards to its soundness under measurement imperfections .",
    "we have demonstrated the use of mqc to perform classically intractable sampling and verification in a unified manner , with identical resource requirements for each task .",
    "this shows that verifying the hardness of a quantum sampling protocol does nt need to be any harder than the actual sampling , and in certain architectures comes essentially for free .",
    "this contrasts sharply with many existing quantum supremacy proposals@xcite , for which verifying the non - classical nature of sampling is significantly harder than the sampling itself , likely requiring exponential computational resources to ensure correctness . by using nonadaptive mqc to drive our protocol ,",
    "we have furthermore allowed both sampling and verification to be carried out in constant time , which minimizes the effect of environmental decoherence , and potentially allows us to avoid the use of quantum error correction .    as an outlook , we expect that a hybrid mqc sampling platform combining the simple physical implementation of @xcite or @xcite with the convenient theoretical analysis and flexibility available here would represent an extremely appealing framework for implementing classically intractable sampling .",
    "in particular , a sampling protocol using nonadaptive mqc with non - clifford @xmath135 gadgets embedded in a 2d brickwork - type lattice could potentially demonstrate quantum supremacy in constant time using only @xmath136 qubits , and with entirely local interactions .",
    "such a protocol would implement the  sparse \" iqp circuits appearing in @xcite , which require only @xmath136 two - body interactions . while this can be implemented in our framework using a 2d lattice of @xmath137 qubits which generalizes our @xmath4 , the possibility of reducing resource requirements further , potentially to @xmath136 qubits , would require using local complementation operations on graph states .",
    "as these operations can quickly generate long - range entanglement using only local @xmath2 basis measurements , we consider such capabilities to represent a unique feature of mqc which are well - suited to reproducing the long - range , low - depth quantum circuits often utilized for quantum sampling .",
    "this work was supported in part by national science foundation grants phy-1314955 , phy-1521016 , and phy-1620651 .    99    p.w .",
    "shor , _ polynomial - time algorithms for prime factorization and discrete logarithms on a quantum computer _ , siam j. sci .",
    "* 26 * , 1484 ( 1997 ) .",
    "grover , _ quantum mechanics helps in searching for a needle in a haystack _ , phys .",
    "lett . * 79 * , 325 ( 1997 ) .",
    "d. deutsch and r. jozsa , _ rapid solution of problems by quantum computation _ ,",
    "london a * 439 * , 553 ( 1992 ) .",
    "terhal , d.p .",
    "divincenzo , _ adaptive quantum computation , constant depth quantum circuits and arthur - merlin games _ , quant .",
    "* 4 * , 134145 ( 2004 ) .",
    "bremner , r. jozsa , d.j .",
    "shepherd , _ classical simulation of commuting quantum computations implies collapse of the polynomial hierarchy _ , proc .",
    "a * 467 * , 459472 ( 2011 ) .",
    "s. aaronson and a. arkhipov , _ the computational complexity of linear optics _ , theory of computing , 9(4):143252 , ( 2013 ) .",
    "t. morimae , k. fujii , and j.f .",
    "fitzsimons , _ on the hardness of classically simulating the one clean qubit model _ , phys .",
    "lett . * 112 * , 130502 ( 2014 ) .",
    "bremner , a. montanaro , and d.j .",
    "shepherd , _ average - case complexity versus approximate simulation of commuting quantum computations _ , phys .",
    "* 117 * , 080501 ( 2016 ) .",
    "s. rahimi - keshari , t.c .",
    "ralph , c.m .",
    "caves , _ sufficient conditions for efficient classical simulation of quantum optics _ , phys .",
    "x * 6 * , 021039 ( 2016 ) .",
    "e. farhi and a.w .",
    "harrow , _ quantum supremacy through the quantum approximate optimization algorithm _ , arxiv:1602.07674 , ( 2016 ) .",
    "rohde , d.w .",
    "berry , k.r .",
    "motes , j.p .",
    "dowling , _ a quantum optics argument for the # p - hardness of a class of multidimensional integrals _ , arxiv:1607.04960 , ( 2016 ) .",
    "_ , _ characterizing quantum supremacy in near - term devices _ , arxiv:1608.00263 , ( 2016 ) .",
    "x. gao , s .-",
    "wang , and l .- m .",
    "duan , _ quantum supremacy for simulating a translation - invariant ising spin model _ , phys .",
    "lett . * 118 * , 040502 ( 2017 ) .",
    "k. fujii , _ noise threshold of quantum supremacy _ , arxiv:1610.03632 , ( 2016 ) .",
    "m. bremner , a. montanaro , and d. shepherd , _ achieving quantum supremacy with sparse and noisy commuting quantum computations _ , arxiv:1610.01808 , ( 2016 ) .",
    "b. fefferman , m. foss - feig , and a.v .",
    "gorshkov , _ exact sampling hardness of ising spin models _ , arxiv:1701.03167 , ( 2017 ) .",
    "f. shahandeh , a.p .",
    "lund , t.c .",
    "ralph , _ quantum correlations in nonlocal bosonsampling _ , arxiv:1702.02156 , ( 2017 ) .",
    "lund , m.j .",
    "bremner , t.c .",
    "ralph , _ quantum sampling problems , bosonsampling and quantum supremacy _ , arxiv:1702.03061 , ( 2017 ) .",
    "j. bermejo - vega , d. hangleiter , m. schwarz , r. raussendorf , and j. eisert , _",
    "architectures for quantum simulation showing quantum supremacy _ , arxiv:1703.00466 , ( 2017 ) .",
    "a. deshpande , b. fefferman , m. foss - feig , and a.v .",
    "gorshkov , _ complexity of sampling as an order parameter _ , arxiv:1703.05332 , ( 2017 ) .",
    "t. kapourniotis and a. datta , _ nonadaptive fault - tolerant verification of quantum supremacy with noise _ , arxiv:1703.09568 , ( 2017 ) .",
    "_ , _ boson sampling on a photonic chip _ ,",
    "science * 339 * , 798801 ( 2013 ) .",
    "m. tillmann , b. daki , r. heilmann , s. nolte , a. szameit , and p. walther , _ experimental boson sampling _ , nature photon .",
    "* 7 * , 540544 ( 2013 ) .",
    "crespi , a. _ et al .",
    "_ , _ integrated multimode interferometers with arbitrary designs for photonic boson sampling _ , nature photon .",
    "* 7 * , 545549 ( 2013 ) .",
    "broome , a. fedrizzi , s. rahimi - keshari , j. dove , s. aaronson , t. ralph , and a.g .",
    "white , _ photonic boson sampling in a tunable circuit _",
    ", science * 339 * , 794798 ( 2013 ) .",
    "_ , _ multi - photon boson - sampling machines beating early classical computers _ ,",
    "arxiv:1612.06956 , ( 2016 ) .",
    "r. raussendorf and h.j .",
    "briegel , _ a one - way quantum computer _ ,",
    "lett . * 86 * , 5188 ( 2001 ) .",
    "r. jozsa , _ an introduction to measurement based quantum computation _ , arxiv : quant - ph/0508124 , ( 2005 ) .",
    "briegel , d.e .",
    "browne , w. dr , r. raussendorf , and m. van den nest , _ measurement - based quantum computation _ , nature physics * 5 * , 1926 ( 2009 ) .",
    "d. hangleiter , m. kliesch , m. schwarz , and j. eisert , _ direct certification of a class of quantum simulations _ , arxiv:1602.00703 , ( 2016 ) .",
    "meyer and l.j .",
    "stockmeyer , _ the equivalence problem for regular expressions with squaring requires exponential space _ , in proceedings of the 13th ieee symposium on switching and automata theory , pp .",
    "125129 ( 1972 ) .",
    "stockmeyer , _ the polynomial - time hierarchy _ , theor .",
    "sci . * 3 * , 122 ( 1977 ) .",
    "a. ehrenfeucht and m. karpinski , _ the computational complexity of ( xor , and)-counting problems _ , technical report 8543-cs , ( 1990 ) .",
    "stockmeyer , _ on approximation algorithms for # p _ , siam j. comput . *",
    "14 * , 849861 ( 1985 ) .",
    "the proof actually allows for the existence of some multiplicative error , in the form of distributions @xmath138 which satisfy @xmath139 for all outcomes @xmath46 , with @xmath140 a fixed polynomial .",
    "while sampling from such a distribution @xmath138 is still classically intractable , this is unsatisfactory from a practical standpoint .",
    "for example , if any outcome @xmath141 satisfies @xmath142 , then we must have the probability @xmath143 be exactly 0 as well .",
    "this is clearly impossible to verify for any experimental distribution @xmath138 , leading exact classically intractable sampling results to have a more strained relationship with experimental realities than their average - case counterparts .",
    "d. gottesman , _ the heisenberg representation of quantum computers _",
    ", talk at international conference on group theoretic methods in physics ( 1998 ) , arxiv : quant - ph/9807006 .",
    "j. miller and a. miyake , _ hierarchy of universal entanglement in 2d measurement - based quantum computation _ , npj quantum information * 2 * , 16036 ( 2016 ) .",
    "d. gottesman and i. l. chuang , _ demonstrating the viability of universal quantum computation using teleportation and single - qubit operations _ , nature * 402 * , 390 ( 1999 ) .",
    "s. aaronson and l .- j .",
    "chen , _ complexity - theoretic foundations of quantum supremacy experiments _ ,",
    "arxiv:1612.05903 , ( 2016 ) .",
    "m. rossi , m. huber , d. bru , and c. macchiavello , _ quantum hypergraph states _ , new j. phys . * 15 * , 113022 ( 2013 ) .",
    "o. ghne , m. cuquet , f.e.s .",
    "steinhoff , t. moroder , m. rossi , d. bru , b. kraus , and c. macchiavello , _ entanglement and nonclassical properties of hypergraph states _ , j. phys .",
    "a * 47 * , 335303 ( 2014 ) .    for comparison , the familiar complexity classes p and np",
    "are respectively contained in the zero and first levels of the polynomial hierarchy ( ph ) .",
    "while the randomized complexity class bpp has only been proven to lie in the second level of the ph , a proof of the widely conjectured p = bpp would place it in the zero ( lowest ) level as well . as a corollary , proving",
    "p = bpp would allow stockmeyer counting to be implemented in the second level of the ph , causing the hypothetical collapse invoked in classically intractable sampling results to occur at the second level of the ph , rather than the third .",
    "s. toda , _ pp is as hard as the polynomial - time hierarchy _",
    ", siam j. comput . *",
    "20 * , 865877 ( 1991 ) .    on the other hand ,",
    "the effect of the measurements used in our verification scheme on the measured state is different from that of direct measurements of @xmath71 .",
    "for example , performing a genuine quantum nondemolition measurement of @xmath71 on the sampling state @xmath22 would leave it unchanged , whereas our scheme always collapses it to a tensor product of single - qubit @xmath1 and @xmath3 eigenstates .",
    "since we only care about measurement statistics and not the post - measurement state , this has no impact on our protocol .",
    "t. morimae , y. takeuchi , and m. hayashi , _ verified measurement - based quantum computing with hypergraph states _ , arxiv:1701.05688 , ( 2017 ) .",
    "we now discuss the relationship of our work to previous proposals for classically intractable sampling with qubits , the class of boson sampling protocols having a largely different flavor with regards to theoretical underpinnings and experimental implementations .",
    "as mentioned before , our work is most closely related to that of @xcite , as it implements their circuit - based iqp sampling in the context of mqc .",
    "we have seen that this translation has several practical advantages , mainly that it allows us to use constant depth quantum circuits generated by local interactions to perform classically intractable sampling in constant time .",
    "this translation also reveals the role of mqc byproduct operators in simplifying our protocol , with an associated randomness which ends up having no impact on the classical intractability of sampling .",
    "furthermore , the convenient verification scheme utilized in our protocol can be applied equally well in any classically intractable sampling implementation using the iqp sampling states associated with conjecture  [ conj ] , revealing an inherent practical advantage of sampling from this class of states .",
    "this advantage more generally applies to any protocol which samples from output distributions defined by so - called hypergraph states@xcite .",
    "although our work does nt make use of the alternate conjecture  2 of @xcite , concerning the average - case hardness of estimating fully - connected ising partition functions , our techniques can be easily generalized to define a similar mqc sampling protocol which relies upon conjecture  2 . in this alternate protocol",
    ", our @xmath83 gadget would be replaced by gadgets for the non - clifford @xmath135 and @xmath144 gates , and our byproduct group would contain not only @xmath78 , but also @xmath145 gates . in terms of the clifford hierarchy of unitary operations @xcite ,",
    "the pattern which emerges here is that using gadgets which implement operations at the third level of the clifford hierarchy leads to a random byproduct group formed from clifford gates at the second level of the clifford hierarchy .",
    "just as with our protocol , this would eliminate the need to apply any clifford gates  by hand \" , reducing the physical resources needed for sampling .",
    "our work also has many similarities to the mqc sampling protocol of @xcite , which similarly runs in constant time using a fixed  brickwork \" resource state preparable by a constant depth quantum circuit , and also allows for verification . in our protocol",
    ", the average - case hardness of sampling relies on conjecture  [ conj ] , while the average - case hardness in @xcite relies upon a conjecture regarding the estimation of output probabilities of random quantum circuits , argued in @xcite to be a stronger assumption . on the other hand",
    ", this latter conjecture is very similar to that used in @xcite .    on a different note ,",
    "the simple byproduct group appearing in our protocol , which is necessary for our preparation measurements to always implement iqp circuits , allows us to carry out verification using only single - qubit measurements on our output sampling states @xmath70 .",
    "in contrast , the more general unitaries implemented in @xcite would likely preclude any simple verification schemes based on the ideas of @xcite .",
    "here we study the preparation stage of our mqc protocol , and show that the polynomials @xmath88 associated with our random output states @xmath70 contains uniformly random quadratic and linear coefficients , so that every @xmath34 and @xmath146 is an independent binary random variable with equal @xmath115 probability .",
    "we show this by first characterizing the distribution of preparation outcomes @xmath147 , where @xmath93 , then using this to characterize the distribution @xmath148 of  byproduct polynomials \" arising in our protocol . we show that @xmath148 is uniformly random , a fact which holds true in the presence of arbitrary noise with spatial correlations of a bounded distance .",
    "this result will be used in our proofs of sampling and verification in appendices  [ sec : sampling ] and [ sec : verification ] .",
    "we calculate @xmath147 using the born rule , which in our ideal setting says that given @xmath39-dependent preparation measurements on @xmath4 , the probability of obtaining an outcome @xmath149 ( where @xmath39 denotes the appropriate single - qubit eigenbases ) is @xmath150 the expression @xmath151 here denotes not a scalar , but a partial inner product on @xmath4 , consisting of an @xmath6-qubit state which is nt measured until the sampling and verification stage of our protocol .",
    "consequently , eq .  ( [ eq : t_prob ] ) says that @xmath147 is equal to the squared norm of this state @xmath151 .",
    "although we would expect this output state to be the sampling state @xmath22 , a careful calculation of the inner products arising in our protocol reveals an additional @xmath152 scalar factor per preparation measurement , as remarked in figure  [ fig : gadgets ] .",
    "this shows that @xmath153 , where @xmath154 , which then proves the preparation measurement outcomes to be distributed as @xmath155 .",
    "we note that this independence of measurement outcomes is a generic feature of mqc state preparation protocols , as the implementation of norm - preserving unitary operations in every preparation measurement will necessarily force eq .",
    "( [ eq : t_prob ] ) to take a constant value for all @xmath95 , corresponding to every preparation outcome @xmath156 being uncorrelated and uniformly random .",
    "we now use the uniform randomness of preparation measurement outcomes @xmath95 to prove the uniform randomness of byproduct polynomials @xmath42 , which depend on @xmath95 as @xmath157 .",
    "these global byproducts arise from the local byproduct operators associated with random outcomes @xmath156 in each of the mqc gadgets shown in figure  [ fig : gadgets ] , which are then commuted through our computation to contribute linear and quadratic terms to @xmath157 .",
    "each quadratic and linear coefficient in @xmath42 can thus be expressed as a sum ( mod 2 ) of many different measurement outcomes @xmath156 , and it is clear that the complete randomness of each measurement outcome will lead every byproduct coefficient in @xmath42 which contains even a single random @xmath156 to be itself completely random .",
    "it is clear that every quadratic coefficient contains contributions from at least one random @xmath156 , with the one exception of @xmath158 .",
    "because our @xmath83 gadgets only apply @xmath83 byproduct operators between nearest neighbor logical qubits , and since qubits 1 and @xmath6 are never adjacent to each other in the circuit diagram of figure  [ fig : protocol ] , it remains possible that @xmath158 will always be 0 .",
    "a simple fix for this is to simply vary the ordering among each triple of qubits entering a non - clifford gadget using @xmath0 gadgets , so that all qubits are adjacent to all other qubits equally often . in this case , every quadratic coefficient @xmath159 in @xmath157 will receive @xmath160 random contributions from outcomes @xmath156 arising in @xmath83 gadgets , and every linear coefficient @xmath161 will receive @xmath97 contributions from outcomes arising in 1d cluster wires and @xmath0 gadgets .",
    "this clearly proves that the distribution of byproduct operators will be uniformly random as @xmath162 , where @xmath163 .    the above analysis which counts the number of measurement outcomes contributing to each coefficient of @xmath42 is unnecessary in an idealized setting , but is useful in the presence of realistic noise and experimental imperfections .",
    "we can generally characterize this behavior as a trace preserving quantum operation @xmath164 which maps our mqc resource state to some imperfect @xmath165 .",
    "our measurement statistics @xmath147 in this setting are again set by the born rule , but now as @xmath166 \\\\      & = { \\mathrm{tr}}\\left[{\\ensuremath{|{\\psi_\\mathrm{prep}}\\rangle\\langle{\\psi_\\mathrm{prep}}| } } \\mathcal{e}^\\dagger({\\ensuremath{|{\\mathbf{t}}_{{\\mathbf{a}}}\\rangle\\langle{\\mathbf{t}}_{{\\mathbf{a}}}|}})\\right],\\end{aligned}\\ ] ] where @xmath167 represents the quantum operation which is adjoint to @xmath164 . while @xmath167 may modify our measurement projectors @xmath168 so as to displace or correlate the probabilities of local outcomes @xmath156 , we noted above that the coefficients of byproduct polynomials are determined by at least @xmath160 different such measurement outcomes , any one of which is capable of completely randomizing the probability of that coefficient .",
    "consequently , in order for noise to alter the distribution of byproduct operators , the operator @xmath167 must induce correlations between at least @xmath160 different measurement outcomes in our system . in the presence of any noise with a finite correlation length , this is clearly impossible , which proves the uniform randomness of byproduct operators to be a robust property of our mqc protocol .",
    "here we give a detailed proof of the classical intractability of our mqc sampling protocol under constant variational noise in the output sampling distributions @xmath58 .",
    "we first discuss the general idea behind average - case classically intractable sampling protocols , so as to make clear what precisely needs to be demonstrated in our proof .",
    "we then describe the use of classical post - processing on our measurement records to implement  coarse - graining \" in the description of our protocol .",
    "this coarse - graining lets us simplify the analysis of failure probabilities required in our proof , and eventually lets us prove theorem  [ thm : one ] , with its associated variational error threshold of @xmath169 .",
    "we note a certain duality between the proof given here and the proof of theorem  [ thm : two ] given in appendix  [ sec : verification ] , with the former using a guaranteed bound on @xmath60 as a starting point and the latter deriving such a bound on @xmath60 as an end result .",
    "any proof of classical intractability of quantum sampling requires adopting somewhat of a dual viewpoint . on the one hand",
    ", we recognize that our sampling procedure is an intrinsically quantum task , but at the same time assume that the sampling distributions arising from this quantum process can be exactly replicated using a probabilistic classical algorithm .",
    "this assumption , analogous to the assumption of a hidden variable model describing our quantum process , is made in order to derive a ( widely conjectured ) contradiction , the collapse of the polynomial hierarchy of complexity theory .",
    "even though the probabilities of individual sampling outcomes @xmath89 are exponentially small and would require exponential time to estimate empirically , if they arise from a classical sampling process , then the technique of stockmeyer approximate counting can be used to estimate these probabilities up to multiplicative error . in particular ,",
    "stockmeyer counting can be used to output an estimate @xmath170 which is related to our probability of interest by @xmath171 , for any desired polynomial @xmath140 .",
    "the use of an average - case complexity conjecture , like conjecture  [ conj ] in our paper , is then required to connect the ability to estimate such probabilities in the presence of noise to the ability to solve # p - hard problems , from which a collapse of the polynomial hierarchy follows .",
    "stockmeyer counting is an unphysical process which can not be carried out efficiently using classical or quantum devices , but can be implemented with a hypothetical  alternating turing machine \" capable of efficiently solving problems in the third level of the polynomial hierarchy @xcite .",
    "furthermore , stockmeyer counting involves manipulations on a register of binary random variables underlying our random outcomes , and consequently can only estimate probabilities arising as outcomes of classical randomized algorithms .",
    "nonetheless , if we assume the existence of an efficient classical algorithm for exactly sampling from the distribution @xmath172 , stockmeyer sampling would then permit a device existing in the third level of the polynomial hierarchy to estimate any @xmath50 up to multiplicative error , and thus solve any problem in # p. because solving arbitrary problems in # p is known by toda s theorem @xcite to allow one to efficiently solve all problems in the hierarchy , assuming the existence of this efficient classical algorithm for sampling from distributions @xmath59 would necessarily collapse the polynomial hierarchy to its third level , a contradiction .",
    "hence , this proves the task of sampling from arbitrary @xmath59 to be classically intractable .    a necessary ingredient in any _ average - case _ classically intractable sampling result is a mathematical problem whose estimation remains # p - hard even when our estimates have some finite probability of failing to be multiplicatively close to their actual value .",
    "in our setting , this problem is furnished by conjecture  [ conj ] , which says that estimating @xmath50 up to @xmath54 multiplicative error is # p - hard , even when a fraction @xmath173 of our estimates fail to lie within this @xmath54 multiplicative bound . evidence in support of conjecture  [ conj ]",
    "is given in @xcite .",
    "this failure probability @xmath64 ends up determining the allowed deviation of our quantum sampling distributions @xmath58 from their ideal @xmath59 .",
    "if this deviation is sufficiently small , as measured by the variational distance between @xmath58 and @xmath59 , the assumed computational hardness of estimating @xmath50 then guarantees that our quantum sampling task will be classically intractable .",
    "consequently , our main goal in this proof is to analyze the deviations in our distributions @xmath116 arising from deviations in our experimental states @xmath70 from their ideal @xmath114 , and to find sufficient conditions to guarantee that the failure probability in estimating @xmath50 using stockmeyer sampling on @xmath58 is below our threshold @xmath64 .",
    "we now introduce the idea of coarse - grained sampling distributions , which indeed we have already implicitly made use of in the description of our sampling protocol . in section  [ sec :",
    "protocol ] , we described different preparation outcomes @xmath93 as giving rise to different ideal sampling states @xmath94 via the correspondence @xmath96 .",
    "this means that whenever different preparation outcomes @xmath174 generate the same byproduct polynomials @xmath175 , the resultant sampling states will be identical . in reality though , it is entirely possible that these preparation outcomes will generate different sampling states @xmath176 , leading our description of a single sampling state @xmath177 to represent a coarse - graining over equivalent preparation outcomes @xmath95 .",
    "in particular , if @xmath147 denotes the probability of obtaining a preparation outcome @xmath95 arising from our @xmath39-dependent pauli measurements on @xmath4 , then we find @xmath70 to be given by @xmath178 @xmath179 represents a normalization factor which gives the total probability on input @xmath39 of obtaining any outcome @xmath95 associated with the byproduct polynomial @xmath180 .",
    "while the above coarse - graining might appear trivial , we will now show how this can be used to effectively mix the inequivalent states @xmath70 and @xmath181 when @xmath17 and @xmath182 differ only in their linear coefficients .",
    "if we describe our overall sampling process at this stage as first preparing a random state @xmath70 with @xmath183 , which is then sampled to obtain an @xmath1 basis outcome of @xmath117 , then we would record this in an experiment as yielding the outcome @xmath184 in some outcome space @xmath185 . from the layout of our sampling protocol ,",
    "the probability of this outcome is clearly @xmath186 . because of the degeneracy @xmath187 for all outcomes @xmath46",
    ", we say that any such outcome samples from the polynomial @xmath17 .",
    "these exponentially many outcomes are precisely the ones which can be used to obtain an estimate of @xmath50 via stockmeyer counting , and we will choose our coarse - graining to eliminate this degeneracy , so that each @xmath50 is determined by a unique sampling outcome from a unique output sampling state .",
    "we note that this coarse - graining was used implicitly in @xcite , although interpreted there as an  obfuscation \" of output probabilities .    in appendix",
    "[ sec : preparation ] we showed that the distribution of byproduct polynomials is uniformly random as @xmath188 , where @xmath163 . given this robust characterization of @xmath179",
    ", we will use @xmath189 to indicate the conditional probability of obtaining any outcome which samples from @xmath190 , given that the quadratic portion of our byproduct polynomial is @xmath40 .",
    "this leads @xmath189 to be @xmath191 we use @xmath192 to indicate the @xmath1 basis outcome string corresponding to the linear terms of @xmath17 . in the above",
    ", we have also defined @xmath193 to be the state @xmath194 where @xmath195 indicates a product of @xmath3 operators . in the ideal",
    "setting where each @xmath72 , the result of applying @xmath196 to @xmath197 is to simply remove the linear components of @xmath17 , leaving the state @xmath198 . in this idealized",
    "setting , the result of averaging over all @xmath197 and applying the correction @xmath196 in each case is to leave the state @xmath199 , which contains only cubic and quadratic terms . while we ca nt literally implement these unitary corrections @xmath196 within the setting of mqc",
    ", we can simulate their action through classical postprocessing on our measurement outcomes .",
    "in particular , whenever we obtain an outcome of @xmath184 in our sampling experiment , we instead record this as a coarse - grained outcome @xmath200 lying in a simpler outcome space @xmath201 .",
    "this is equivalent to recording only the polynomial @xmath17 sampled by our experiment , and forgetting the relative contributions to @xmath17 from mqc byproduct operators and from sampling outcomes @xmath46 .",
    "the equivalence of this coarse - graining in our measurement records with the action of active unitary corrections arises from the equality @xmath202 used to derive eq .",
    "( [ eq : prob_1 ] ) .    given this coarse - grained description of our experiment",
    ", we would like to bound the failure probability @xmath203 of obtaining an estimate @xmath66 which differs from the true @xmath50 by more than a multiplicative factor of @xmath54 . by requiring this probability to be less than the @xmath204 appearing in conjecture  [ conj ] , we will arrive at concrete conditions on our coarse - grained output states @xmath193 in order for our mqc protocol to implement classically intractable sampling .",
    "while the stockmeyer counting used to obtain @xmath66 from our sampling probabilities @xmath189 technically introduces its own multiplicative error in this estimate , because this error can be reduced in our ( hypothetical ) stockmeyer counting algorithm to any inverse polynomial @xmath205 while still retaining a polynomial runtime , we will ignore this error in the following and simply set @xmath206 .",
    "we first use markov s inequality to bound the probability of our estimate @xmath66 failing to lie within an arbitrary constant distance of @xmath50 , @xmath207 , over arbitrary polynomials @xmath190 .",
    "we will later convert this into a failure probability for obtaining an estimate of @xmath50 outside of our allowed @xmath54 multiplicative error . since the approximate and exact values of @xmath50 can both be interpreted as probabilities in different distributions , @xmath206 and @xmath208",
    ", we find that the distance between these values , averaged over @xmath41 with fixed @xmath43 , is proportional to the variational distance between these distributions as @xmath209 defining @xmath210 to be the variational distance between these distributions , markov s inequality then tells us that for any @xmath211 and for @xmath190 with a fixed @xmath43 , @xmath212    having this bound in hand , we now give an anticoncentration bound on the probability that @xmath213 , which lets us convert the above bound into a statement about the failure probability @xmath203 .",
    "we utilize a particular form of cantelli s inequality stating that for any non - negative random variable @xmath1 and constant @xmath214 in @xmath215 , @xmath216 this agrees with the more well - known paley - zygmund inequality at @xmath217 , but otherwise gives a more stringent upper bound .",
    "setting @xmath218 , @xmath219 , and using the result @xmath220 from @xcite , this lets us restrict the probability of @xmath221 being less than @xmath222 as @xmath223 we now define @xmath224 to be the average variational distance between distributions @xmath225 and @xmath226 , averaged over all @xmath43 . combining eq .",
    "( [ eq : markov ] ) with the average of eq .",
    "( [ eq : pz ] ) over all @xmath39 , this results in a bound on the multiplicative failure probability of @xmath227 which holds for every @xmath228 .",
    "we now require the failure probability to be at most @xmath229 , in line with conjecture  [ conj ] , and numerically optimize over @xmath230 to find the largest allowed value of @xmath60 for which this can be achieved .",
    "this yields a maximum of @xmath231 , which has a rational lower bound of @xmath232 .",
    "this completes our proof of theorem  [ thm : one ] .",
    "here we prove that the verification scheme occurring in the last stage of our mqc protocol does indeed guarantee the classically intractable of our sampling process .",
    "we first show that the local @xmath1 and @xmath3 measurements made on our sampling states @xmath70 during verification correspond to exact measurements of the nonlocal stabilizers @xmath71 , via the parity functions @xmath125 .",
    "this allows us to estimate the average @xmath233 with respect to random @xmath70 , which allows us to bound the average variational distance @xmath234 using results from @xcite .",
    "if our empirical estimate of @xmath233 remains sufficiently low , an application of hffding s inequality lets us show that @xmath128 verification measurements are sufficient to conclude that @xmath235 with any fixed statistical significance , proving theorem  [ thm : two ] .",
    "we first briefly review our verification procedure .",
    "after preparation of a random @xmath70 , we choose with 50% probability to perform either sampling or verification measurements on @xmath70 .",
    "if verification is chosen , we further choose a random qubit @xmath99 of @xmath70 which is measured in @xmath1 , while all other @xmath236 qubits are measured in @xmath3 .",
    "we denote the measurement outcome string by @xmath119 , ignoring the fact that @xmath237 is associated with a different measurement basis .",
    "we then use our knowledge of the polynomial @xmath17 associated with @xmath70 to compute a parity function of @xmath126 , @xmath120 , where @xmath238 is the polynomial difference @xmath239 .",
    "it is easy to show that @xmath121 is independent of the value of @xmath237 .",
    "we show here that the process of measuring @xmath126 using single - qubit pauli measurements and then computing @xmath125 is exactly equivalent to measuring the nonlocal stabilizer @xmath71 as @xmath240 , where @xmath241 indicates the @xmath71 outcome corresponding to @xmath126 .",
    "both processes yield binary random variables as their output , and in order to prove that their probability distributions are identical , we can prove that both measurement schemes are associated with identical hermitian observables .",
    "while measurements of @xmath71 are clearly associated with the hermitian operator @xmath71 itself , it is nt immediately clear how we should interpret the measurements of @xmath126 as measuring any particular hermitian operator .",
    "the answer comes by recognizing that our relevant measurement statistics during verification consist only of the binary values @xmath125 , and forgets the specific outcomes @xmath126 which produced them .",
    "translating these @xmath242 outcomes into equivalent @xmath71 outcomes shows the expectation value of @xmath71 on @xmath70 to be @xmath243 \\\\      & = { \\mathrm{tr}}\\left[\\rho_f \\left ( x_i \\sum_{{\\mathbf{v } } } ( -1)^{\\partial_{i}f({\\mathbf{v } } ) } { \\ensuremath{|{\\mathbf{v}}\\rangle\\langle{\\mathbf{v}}|}}\\right)\\right ] \\\\      & = { \\mathrm{tr}}\\left(\\rho_f { h_f^{(i)}}\\right).\\end{aligned}\\ ] ] in the last equality , we have used the definition of @xmath71 in eq .",
    "( [ eq : hami ] ) , while in the second to last equality we used @xmath244 .",
    "this reveals that the expectation value of @xmath122 is equal to that of @xmath71 on @xmath70 , and since we made no assumptions about @xmath70 , this shows that our verification scheme is exactly equivalent to measuring @xmath71 @xcite .    as a concrete example , suppose we are working with the 3-qubit sampling state @xmath245 and wish to measure the stabilizer @xmath246 . in this case",
    ", we would perform our verification by measuring @xmath1 on qubit 1 , @xmath3 on qubits 2 and 3 , and then computing the polynomial @xmath247 .",
    "this process , which can be thought of as obtaining classical values and plugging them in to the stabilizer itself , would indicate a success when @xmath248 and @xmath249 , or when @xmath250 and at least one of @xmath251 or @xmath252 holds true .    given the ability to measure arbitrary @xmath71 using single - qubit @xmath1 and @xmath3 measurements",
    ", we now note that the average @xmath253 over randomly chosen sites @xmath99 is equal to 1 on a given @xmath70 only when @xmath72 is the ideal sampling state .",
    "more generally , the techniques of @xcite show that this average can be used to bound the closeness of @xmath70 to @xmath114 , as measured by the fidelity @xmath254 . for our purposes , it will be more convenient to work with the square of this quantity , @xmath255 . when @xmath256 , @xmath70 can not be orthogonal to @xmath22 , and must have a fidelity squared of at least @xmath257 .",
    "if we average both sides of this equality over polynomials @xmath88 with random @xmath42 , then we find that the average fidelity squared @xmath258 of output states @xmath70 relative to their intended @xmath22 is bounded by the average @xmath233 as @xmath259    with eq .",
    "( [ eq : fidelity_bound ] ) in hand , we can now bound the average variational distance @xmath234 between the sampling distributions arising from @xmath70 and @xmath22 .",
    "we utilize the fact that the quantum 1-norm distance @xmath260 gives an upper bound on the variational distance of any output sampling distributions , where @xmath261 with @xmath262 the operator absolute value .",
    "we also use a well - known bound on the 1-norm distance , @xmath263 , which together yield @xmath264 in the above , we used the two bounds mentioned , as well as jensen s inequality for the concave function @xmath265 in eq .",
    "( [ eq : bound_two ] ) . using the relationship between the average of stabilizers and parity functions , @xmath266 , this",
    "finally lets us show that in order to verify that @xmath267 , it is sufficient for our parity function average to be below @xmath268 this gives the bound appearing in theorem  [ thm : two ] .",
    "although any empirical estimate of @xmath233 obtained from finitely many measurements of @xmath125 is nt guaranteed to accurately reflect its true value , we can bound the closeness of this estimate with high probability using the uniformly random distribution of byproduct operators proved in appendix  [ sec : preparation ] .",
    "in particular , this tells us that for any fixed @xmath39 , the average @xmath269 over output random byproducts is unbiased towards any fixed @xmath70 , and thus is an accurate indicator of the uniform closeness of sampling states .",
    "this lets us treat @xmath233 as a simple binary random variable , and use hffding s inequality to bound the probability of this estimate deviating too far from the true value of @xmath233 .    hffding s inequality says that if we obtain an estimate @xmath270 of a binary random variable @xmath1 using @xmath271 independent samples , the probability of the true average @xmath272 lying above @xmath270 by more than @xmath273 is @xmath274 in our case , we choose @xmath1 to be our random parity function , and @xmath273 to be the difference between our specified tolerance @xmath275 , and the more numerically precise tolerance for classically intractable sampling derived in appendix  [ sec : sampling ] , @xmath276 . setting @xmath277 , this gives a failure probability of @xmath278 converting this into a success probability @xmath279 then completes our proof of theorem  [ thm : two ] .",
    "a final remark is given to our means of measuring the highly nonlocal , non - pauli stabilizers @xmath71 through single - qubit pauli measurements .",
    "this technique can actually be generalized to measure the stabilizers of any sampling state formed by starting with @xmath20 and applying an iqp circuit composed of @xmath145 , @xmath3 , @xmath78 , @xmath83 , and any higher multiply - controlled @xmath3 gates . as these states include all hypergraph states as special instances ,",
    "our verification scheme consequently extends that of @xcite , which requires the measured hypergraph stabilizers to be supported on a constant number of qubits .",
    "generalizing yet further , we see that the necessary and sufficient condition for a local measurement scheme to exactly replicate measurements of a nonlocal operator @xmath280 in this manner is that @xmath280 can be diagonalized in a basis which is a tensor product of single - qubit eigenbases .",
    "while this allows us to measure many different multi - qubit operators using only single - qubit measurements , a simple counterexample is given by the hermitian operator @xmath0 , which can not be measured in this manner owing to its unique @xmath281 eigenstate being the entangled @xmath282 ."
  ],
  "abstract_text": [
    "<S> while quantum speed - up in solving certain decision problems by a fault - tolerant universal quantum computer has been promised , a timely research interest includes how far one can reduce the resource requirement to demonstrate a provable advantage in quantum devices without demanding quantum error correction , which is crucial for prolonging the coherence time of qubits . </S>",
    "<S> we propose a model device made of locally - interacting multiple qubits , designed such that simultaneous single - qubit measurements on it can output probability distributions whose average - case sampling is classically intractable , under similar assumptions as the sampling of non - interacting bosons and instantaneous quantum circuits . </S>",
    "<S> notably , in contrast to these previous unitary - based realizations , our measurement - based implementation has two novel features . </S>",
    "<S> ( i ) verifying the classical intractability of our sampling is done using the same resource requirements as sampling itself , requiring only a change in the pauli measurements bases . </S>",
    "<S> ( ii ) our implementation involves no adaptation of measurement bases , leading output probability distributions to be generated in constant time , independent of the system size . </S>",
    "<S> thus , it could be implemented in principle without quantum error correction . </S>"
  ]
}