{
  "article_text": [
    "geothermal reservoirs are typically situated in igneous rocks , where the permeability of the reservoir mainly is governed by discrete fractures .",
    "the fractures occur on a range of scales , where large - scale connected structures tend to completely dictate flow paths .",
    "flow and transport processes are strongly dominated by these structural heterogeneities .",
    "while large - scale fractures dictate preferential fluid pathways , fine - scale fractures contribute significantly to the subsurface heat exchange from the rock to the brine .",
    "the size of the fractures in a fractured reservoir typically follow a power law distribution , which means that at any scale of investigation , flow will be controlled by single fractures that can not be represented by an upscaled permeability @xcite . due to the lack of scale separation in fractured formations",
    ", particular care must be taken to appropriately account for local flow and transport characteristics .",
    "modeling approaches for fractured reservoirs can be classified into three main categories based on their spatial representation in the considered formation  @xcite : single continuum models , multi - continuum models , and discrete fracture - matrix models .",
    "single continuum models average spatial properties of the rock over grid cells that are much larger than the narrow width of the structural heterogeneities ( fractures ) , assuming that the concept of representative elementary volume is valid .",
    "an advantage of this approach is that standard reservoir simulators can be applied . in multi - continuum models ,",
    "the different characteristics of flow in different structural components are preserved for each region of rock ; see , e.g. , @xcite and references therein . each structural component , e.g. fractures on different scales and matrix , is modeled by a representative continuum , and interacts with the other continua comprising the same region . in this way integral transport behavior can be better captured compared to when using a single continuum model . in contrast , discrete fracture network ( dfn ) models represent fractures explicitly and solely considers flow in the network of explicily represented fractures ; see , e.g. , @xcite .",
    "discrete fracture - matrix ( dfm ) models conceptually represent a combination of dfn models and multi - continuum models , with explicitly represented fractures between regions of continuity ( e.g. , @xcite ) , and is the approach we consider here .",
    "the advantage of dfm models is that they allow explicit representation of fractures that can not be represented by an equivalent continuum at the chosen scale in simulation models , while at the same time account for ( upscaled ) permeability due to small scale fractures and pores in the regions surrounding the fractures .",
    "therefore , the dfm models account for the lack of scale separation by modelling fractures that dominate flow characteristics at a certain scale explicitly , while at the same time accounting for the region outside these fractures being permeable .",
    "this is of particular importance in geothermal heat transport , where the permeability of the region surrounding the fractures with dominating flow plays an important role for heat transport .",
    "discretization methods for dfm models are challenging due to the large difference in scales between fractured and non - fractured regions .",
    "co - dimension one approaches treat fractures as lower dimensional objects in the geometrical domain , and associate the removed dimension with a hydraulic aperture in the computations .",
    "this simplifies modelling at the cost of a small volumetric error , see e.g. @xcite .",
    "the explicit representation of fractures in dfm models necessitate large flexibility in terms of grid generation .",
    "frameworks that slightly modifies the fracture network to align with a background grid have been developed to avoid excessive grid refinement close to e.g. fracture intersections @xcite .",
    "in addition to gridding and discretization challenges , numerical representation using dfm models typically leads to a high number of degrees of freedom compared to using continuum models .",
    "efficient numerical methods are therefore important .",
    "in this paper we present a heterogeneity - preserving upscaling method for advective - conductive heat transport in fractured reservoirs .",
    "our main contribution is two - fold : first , we introduce an upgridding method that is tailored to drainage of energy from the matrix to the fracture system .",
    "second , we study discretization schemes for heat transport on the resulting coarse grid .",
    "following @xcite , the coarse grid used for heat transport is based on a fine - scale velocity field , which is assumed to be known .",
    "the coarse cells are constructed by merging fine - scale cells with similar flow properties and distance from the fracture network .",
    "the resulting coarse grid is well suited to represent both the slow drainage of heat from matrix to the fracture network , and the fast transport within the network .",
    "we emphasize that the user interacts with the coarsening algorithm only via a few meta - parameters .",
    "depending on the geometry of the fracture network , the coarse grid can have cells with highly irregular shapes , including non - convexity and high aspect ratios .",
    "while the advective term can be discretized from the known fine - scale velocity field in the manner of @xcite , the complex grid poses challenges for the discretization of the heat conduction term .",
    "to overcome this , we use ideas from multiscale methods developed for elliptic and parabolic equations .",
    "multiscale methods have been used extensively in porous media applications to efficiently discretize the pressure equation in a way that accurately represents fine - scale heterogeneities , see , e.g. , @xcite . due to the emphasis on material heterogeneities",
    ", the majority of the work on multiscale methods applied to porous media problems has with a few exceptions been focused on structured grids .",
    "the framework presented in @xcite , on the other hand , makes few assumptions with regards to grid geometry , and uses an algebraic procedure to compute multiscale basis functions .",
    "this makes the framework in @xcite well suited for general coarse grids , and we therefore use it as a basis for discretization of the coarse - scale conductive term .",
    "however , the highly irregular shape of the coarse cells makes it necessary to introduce modifications to avoid numerical instabilities .",
    "we also study a non - conforming discretization of the coarse advection term , i.e. based on piecewise constant basis functions .",
    "this second approach can be expected to have inferior approximation properties , but it does provide a simple and robust alternative to the multiscale - based discretizations .    to study the performance of our methods we consider fracture network ranging from a cartesian structure to a highly complex network that consists of a large number of stochastic fractures .",
    "we then study the accuracy of the methods under varying upscaling ratios and fluid injection rates .",
    "the numerical examples show that both discretizations capture the main features of the transport , compared to a fine - scale simulation .",
    "as expected , the multiscale based method gives the most accurate predictions , in particular in regions where conduction dominates .",
    "the outline of the paper is as follows . in section [ equations ]",
    "we describe the governing equations for flow and transport in geothermal reservoirs and the discretization on the fine scale .",
    "the framework for coarse scale discretization is presented in section [ upscaling ] .",
    "numerical experiments are presented in section [ num_exp ] and the paper ends with conclusions and a discussion in section [ concl ] .",
    "in this section we present the governing equations for flow and heat transport . we also derive the fine scale discretization that later will be the starting point for our upscaling methodology .",
    "we consider single phase incompressible flow .",
    "mass conservation of the fluid , @xmath0 in combination with darcy s law , @xmath1 is combined into an elliptic equation for the pressure , @xmath2 , @xmath3 where @xmath4 is the permeability tensor , @xmath5 is the viscosity , which is assumed to be constant , @xmath6 is the darcy flux field and @xmath7 contains any sources or sinks .",
    "the relation between hydraulic aperture , @xmath8 , and fracture permeability , @xmath9 , is modelled as @xmath10    the effective volumetric heat capacity for rock and fluid combined is given by @xmath11 where subscripts @xmath12 and @xmath13 denote fluid and rock , respectively , and @xmath14 denotes effective . here",
    ", @xmath15 is the density , @xmath16 is the specific heat capacity , and @xmath17 is the porosity .",
    "we assume that the specific heat capacities of fluid and rock varies slowly with time . assuming local thermal equilibrium for a single phase flow , the energy equation that describes heat tranfer through the reservoir can be simplified to a linear advection - conduction equation for the temperature , @xmath18 , given by @xmath19 in addition , @xmath20 is the energy source term , and @xmath21 is the effective thermal conductivity for the porous medium saturated with fluid at local thermal equilibrium . for simplicity",
    ", we will assume a constant value for conductivity .",
    "the assumptions made above are reasonable for water - filled geothermal reservoirs , including a wide range of temperatures for enhanced geothermal systems ( egs ) situated at large depths . in deep reservoirs water",
    "remains a compressed liquid for high temperatures due to high hydrostatic pressures @xcite .",
    "we obtain a decoupled system of equations and that together with appropriate boundary conditions can be solved sequentially in numerical simulations .",
    "the coupling is one - way via the darcy flux , @xmath22 , due to the assumptions of an incompressible fluid with constant viscosity , and the pressure equation is only solved once , at the start of the simulation .    the ratio between heat advection and conduction is commonly characterized by the heat pclet number @xmath23 , defined as @xmath24 where @xmath25 is a representative length scale , typically the distance between injector and producer wells",
    ", @xmath26 is an average velocity , and @xmath27 is the average heat conductivity .",
    "the flow injection rate generally determines the flow rate through the fracture network and subsequently the highest value of @xmath23 in the reservoir . depending on e.g. the matrix - fracture permeability contrast",
    ", the heat advection in the matrix can be considerably slower compared to that in the fractures leading to a second response from advection through the matrix @xcite . as an effect the values of @xmath23 can",
    ", depending on the local flow field , vary by orders of magnitude in different regions of the reservoir .",
    "we use an unstructured computational grid , constructed as a triangulation constrained to the fractures , with a slightly modified version of the algorithm presented in @xcite .",
    "equations and are discretized using a finite volume discretization .",
    "let be a set of fine grid cells , = \\{@xmath28 , where @xmath29 is the total number of fine cells .",
    "integrating equation over each grid cell @xmath30 and using the divergence theorem gives @xmath31 where @xmath32 is the boundary of grid cell @xmath30 and @xmath33 is the outward normal of @xmath32 .",
    "similarly , equation becomes @xmath34 a two - point flux approximation is used to discretize both equation and the conductive part of equation .",
    "the fractures are incorporated by the hybrid discretization developed in @xcite , where the permeability heterogeneity is preserved by the introduction of cells along the fractures .",
    "the advective fluxes in equation are approximated using standard upstream weighting @xcite .",
    "the discretization of equation gives rise to a linear system on the form @xmath35 where @xmath36 is a vector containing cell - centered pressure values .",
    "equation can be solved either via a direct solver or by using an appropriate iterative solver , see , e.g. , @xcite .",
    "similarly , after discretizing equation in space , the semi - discrete temperature equation reads @xmath37 where @xmath38 is a vector containing cell - centered temperature values , @xmath39 and @xmath40 approximate the advective and the conductive terms in eq .",
    ", respectively , and @xmath41 approximate the right hand side .",
    "@xmath39 , @xmath40 , and @xmath41 are all scaled with the inverse of the effective heat capacity .    for time",
    "propagation we use an implicit second order accurate backward differentiation formula ( bdf2 ) , which has favorable stability properties , with time steps sufficiently small for temporal diffusion not to pollute the simulation accuracy .",
    "the fine scale discretization with explicitly represented fractures in the computational grid is often too computationally expensive to use directly in the heat transport simulations . as an alternative approach",
    ", the fine scale discretization can be used as the basis for numerical upscaling , where most of the computations are carried out on a coarser grid . in this section ,",
    "we introduce an upscaling method for simulation of heat transport in fractured media .",
    "the upscaled transport model requires the construction of a coarse grid , together with a discretization of equation on that grid .",
    "we assume that a fine - scale velocity field is available , so that fine scale heterogeneities in the flow model can be incorporated into the coarse scale transport discretization .",
    "if the coupling between flow and transport is assumed to be weak , a single fine scale pressure solve may be sufficient , in which case the pressure solve will not constitute a large part of the overall simulation cost .",
    "alternatively , iterative solvers or multiscale methods tailored for fractured media can be applied to effectively produce conservative approximations to the velocity field on the fine scale , see for example @xcite .",
    "because of the assumption of incompressible flow , we use a direct fine scale pressure solver in this work .",
    "since no additional errors from an approximate velocity field are introduced , errors due to the coarse scale transport solver can be isolated , and the performance of the method can be thoroughly investigated .      to design adequate coarse grids , insight into the behavior of transport processes in fractured media",
    "is needed .",
    "global transport is often dominated by flow in the fractures , while heat stored in the matrix is transported into the fracture network by a combination of matrix flow and conduction .",
    "this suggests two criteria for the construction of coarse grids .",
    "first , the coarse grid should honor the structure of the flux field to adapt to large scale connectivity , i.e. large scale fractures . specifically , we have found it useful to apply the flow - based indicator framework introduced by aarnes et al .",
    "@xcite , and to use time - of - flight ( tof ) as indicator function for the coarse grid .",
    "second , the assumption that heat drains from the matrix to nearby fractures suggests that the coarse cell geometry in the matrix should reflect the distance to nearby fractures .",
    "we achieve this by classifying fine scale cells located in the matrix according to their geometric distance from the closest fracture and refining the coarse grid according to the distance measure .",
    "it is instructive to draw the parallel between this second criterion and the so - called multiple interactive continuum ( minc ) models @xcite .",
    "both models use distance from fractures as a proxy for the time it takes for heat to drain towards the fractures .",
    "a major difference is that since our starting point is a fine - scale grid , estimation of interaction between coarse cells is relatively simple even for general fracture geometries .",
    "moreover , our approach can readily be combined with heat advection .",
    "we refer to the mapping from the fine grid to the coarse grid as a _ coarse grid partition _ , i.e. the description of which fine grid cells constitute each coarse grid cell .",
    "the different steps in the construction of the coarse grid are visualized in figure [ coarse_grid_construction ] and briefly described in the following steps :    1 .",
    "generate an initial coarse grid partition of a fine grid based on a coarsening indicator , e.g. , based on tof .",
    "2 .   refine the initial coarse grid using a distance based grid partition .",
    "this partition is defined by a predefined coarse grid resolution parameter and a distance indicator ( measuring the distance between the cell center of a fine cell and the closest fracture ) .",
    "hybrid coarse cells ( consisting of both fine fracture cells and fine matrix cells ) are separated so that all coarse cells either contain only fine fracture cells or fine matrix cells .",
    "coarse cells are ensured to be ( or split into ) connected components .",
    "the coarse cells can be merged and refined in an iterative loop in order to obtain a coarse grid with preferred properties @xcite .",
    "the focus of this work is not to obtain an optimal coarse grid , but rather to design a coarse scale discretization that works well also for highly irregular coarse grids .",
    "we remark that the coarse grid in figure [ coarse_grid_construction ] gives a fair representation of the grid cell shapes we have encountered . for transport problems dominated by fracture flow , the number of grid cells can be vastly reduced and still capture large scale behavior for a coarse grid constructed based on flow indicators compared to when a more structured coarse grid is used . however , with a more irregular coarse grid the discretization on the coarse scale needs to be carefully constructed .",
    "this is described in the following sections .",
    "+          let be a set of coarse grid cells , = \\{@xmath42 , @xmath43 , where @xmath44 is the total number of coarse cells .",
    "the coarse scale finite volume discretization takes the same form as the fine scale discretization in equation , with integration over a coarse cell @xmath45 .    in the following ,",
    "we detail the coarse scale discretization of the advective and conductive terms , respectively .",
    "as we will see , the former can be treated relatively easily , while the latter requires more attention .",
    "the treatment of the coarse scale advective term assumes that fine scale fluxes are known .",
    "following @xcite , a control volume discretization of the advective term is obtained by integrating the ( known ) fine scale fluxes to net fluxes on the coarse scale , @xmath46 where @xmath47 denotes a face between fine grid cells @xmath48 and @xmath49 , and @xmath50 a face between coarse grid cells @xmath51 and @xmath52 .      for the coarse scale conductive term we take advantage of the fact that the same structure is found in elliptic and parabolic pressure equations .",
    "in porous media applications , coarse scale discretizations of elliptic equations with strongly variable coefficients ( related to heterogeneous and anisotropic media ) has received much attention the last decade in the context of multiscale methods @xcite .",
    "due to the strong hyperbolic component of the heat transport , a projection of the full temperature profile from the coarse to the fine scale is highly challenging , and we therefore can not directly apply a multiscale framework to the advection - conduction equation .",
    "nevertheless , we construct the upscaled discretization of the conductive term inspired by multiscale metods .",
    "the coarse scale finite volume discretization matrix for the conductive term , @xmath53 , is related to the corresponding fine scale discretization matrix , @xmath40 , by @xmath54 where @xmath55 is a restriction operator represented by a matrix of size @xmath56 , and @xmath57 is a prolongation matrix of size @xmath58 .",
    "the restriction operator , @xmath55 , maps the fine scale discretization to the coarse scale .",
    "we use a finite volume restriction matrix , with elements given by @xmath59 see @xcite .",
    "@xmath57 can be expressed as a column matrix , @xmath60,\\end{aligned}\\ ] ] where the columns @xmath61 , @xmath62 , contain prolongation operators or _",
    "basis functions_.    a coarse scale discretization on the form is often used for multiscale methods for elliptic equations with variable coefficients , see for instance @xcite . in that case",
    ", the basis functions can be combined to directly map the coarse scale solution variables to a fine scale approximation . for elliptic equations that stems from strongly heterogeneous and anisotropic porous media problems ,",
    "a main difficulty with respect to multiscale methods is to define basis functions that give a numerical solution with desired properties .",
    "more generally , the construction of the prolongation matrix @xmath57 is a long - standing issue in the field of coarse discretizations , and it is also closely related to the formulation of coarse spaces in the domain decomposition and multigrid literature @xcite .    it is a common feature of many multiscale methods and numerical upscaling methods that they are most easily realized on relatively structured grids . as exemplified in figure [ coarse_grid_construction ] , the grid coarsening strategy presented in section [ upscaling_grid ] can give rise to highly irregular coarse grids . to define a discretization of the conductive term on these grids based on geometric arguments is very challenging .",
    "instead we consider an algebraic construction of the basis functions in the coarse discretization presented in @xcite , which makes the method much more amenable to complex coarse grids .",
    "the algebraic construction is closely related to ideas in smoothed aggregation algebraic multigrid methods @xcite . in the following subsections , we describe how the methodology in @xcite is applied and modified to obtain a suitable discretization of the conductive term in our advection - conduction equation .",
    "the region of support for a basis function is defined in terms of interaction regions .",
    "these regions resemble discretiztion stencils for multipoint flux approximations @xcite in the sense that all coarse cells that share a vertex with coarse cell @xmath48 contain some fine cells that are included in @xmath61 .",
    "conceptually , we need to consider three different types of interactions : 1 ) matrix cells neighboring matrix cells , 2 ) matrix cells neighboring fracture cells , and 3 ) fracture cells neighboring fracture or matrix cells .",
    "interactions regions for these three types are illustrated in figure [ basis_functions ] , together with the corresponding coarse cells and basis functions for these cells , respectively .",
    "the interaction regions are constructed by the algorithm in @xcite , with some adaptions to account for the presence of fracture cells .",
    "specifically , we do not allow for interaction between coarse matrix cells that are separated by a fracture cell .",
    "this is due to the assumption of advective - dominated heat transport in the fractures .",
    "having defined the support of the basis functions in terms of the interaction regions , we go on to explicitly compute the basis functions .",
    "we use the algebraic construction from @xcite , described briefly below .",
    "the initial description of the elements in the prolongation matrix @xmath57 is @xmath63 i.e. @xmath64 . we note that @xmath65 is a partition of unity , and forms a @xmath66 ( piecewise constant ) discretization on the coarse grid .",
    "now , successive iterations for basis function @xmath67 are given by @xmath68 where @xmath69 , @xmath70 $ ] is a relaxation parameter , and @xmath71 denotes the iteration number .",
    "the effect of the iterations is to smoothen the basis functions .",
    "the support of a basis function is limited to its interaction region , this is enforced after each iteration by simply truncating values that fall outside the interaction region .",
    "however , the truncated basis functions will generally not form a partition of unity . as a remedy , the functions are rescaled cell - wise to ensure that they sum to one within each fine scale cell @xcite .      the above construction of basis functions works well for coarse cells with a reasonably regular geometry .",
    "however , we have observed that when the coarse grid becomes highly irregular , as illustrated in figure [ coarse_grid_construction ] , the basis functions may have a non - monotonic behavior , which consequently lead to oscillations in the numerical solution . to see why the non - monotonic profiles occur",
    ", we note that for cells with large aspect ratios or with complex shapes , interaction regions associated with neighboring cells are not necessarily in contact with the cell center .",
    "thus the rescaling to preserve a partition of unity , which is carried out for each interaction region individually , can cause the basis function not to be monotonically decreasing from the cell center . in this and the following subsection",
    "we discuss two approaches to mitigate this effect . as a partial remedy to the oscillations we limit the number of iterations in the construction of basis functions by minimizing an energy functional @xcite .",
    "specifically , we define @xmath72 as the discrete energy of the basis function for coarse grid cell @xmath48 , @xmath73 by @xmath74 oscillations in the basis function will increase the discrete energy , and we therefore terminate the iterations for basis function @xmath61 if for some iteration @xmath71 we have @xmath75 while continuing to update basis functions that have not been terminated .",
    "the termination freezes the basis functions in all fine - scale cells contained within the interaction region of coarse cell @xmath48 .",
    "while the termination criterion does not guarantee monotone basis functions , the approach has been sufficient for the fracture networks considered here .",
    "in addition to the termination condition for each basis function , global criteria for terminating the iterations are based on the size of the residual and by a user given total number of iterations .",
    "figure [ iteration_histogram ] shows the distribution of basis functions terminated at different numbers of iterations for the fracture network considered in section [ pe_exp ] .",
    "when the smoothening is terminated based on the residual after @xmath76 iterations , 24@xmath77 ( @xmath78 ) of the basis functions are still updating , and they are therefore not included in the figure .",
    "* remark * in addition to non - monotonic basis functions , excessive smoothing may also result in eigenvalues of @xmath53 with negative real parts .",
    "this consequently leads to blow up of the numerical solution as time propagates .",
    "if needed , this can be avoided by introducing an additional criteria on the diagonal elements of @xmath53 such that @xmath79 , @xmath80 .",
    "if the diagonal elements of @xmath53 are strictly positive , then by the gershgorin circle theorem the eigenvalues have real parts that are strictly positive .",
    "as noted above , oscillations in the basis functions can to a large degree be avoided by reducing the number of smoothing iterations .",
    "it is of particular interest to investigate the limit option of taking no iterations at all , and thus represent the coarse - scale temperature with piecewise constant basis functions .",
    "this approach avoids the oscillations , and as the interaction regions are no longer required , the method is simpler to implement .",
    "moreover , it leads to a symmetric discretization of the coarse conduction term , assuming that the fine scale discretization matrix , @xmath40 , is symmetric , since in this case @xmath81 , and thus @xmath82 .",
    "however , the piecewise constant representation of temperature implies that temperature gradients can only be present on the boundary between the coarse - scale cells , where they are represented by the fine - scale discretization @xmath40 .",
    "that is , the coarse - scale conduction retains a dependency on the fine scale grid size @xmath83 , rather than on a representative coarse grid size @xmath84 .",
    "as the above considerations show , the constant basis function will therefore lead to inferior approximations , in particular for large upscaling ratios .",
    "the effect will be most pronounced in regions where conduction is the dominant transport mechanism . nevertheless , the approach is interesting , in that it is considerably simpler and more numerically robust than the smoothed basis functions .",
    "it is of interest to discuss differences with related methods for coarse discretizations in fractured media .",
    "recently , tene et al . @xcite and shah .",
    "et al @xcite developed multiscale methods for solving the pressure equation in fractured media . in both",
    "these works the fracture networks and the matrix are separated into two independent coarse grids , and exchange between fractures and matrix are modelled via a peaceman - type coupling term that is proportial to the difference between the matrix and fracture pressures @xcite . while this approach can be advantageous for the pressure equation with high permeability contrast between fracture and matrix , it is less relevant for heat conduction that has no abrubt jumps in the parameter field .",
    "+         .",
    "there are 1412 of a total of 1852 basis functions for which iterations are terminated early .",
    "440 basis functions are still updating when the smoothing is terminated based on the residual , and therefore not included in the histogram.,width=264,height=264 ]",
    "in this section we consider three different test cases to illustrate the applicability and performance of the upscaling framework .",
    "numerical experiments are run both with a smoothed basis and with constant basis functions , respectively .",
    "first , we present a refinement study for a structured fracture network on an underlying cartesian fine scale grid to investigate the practical importance of sufficiently smooth basis functions .",
    "we follow by investigating the performance of the numerical method for two more complex fracture networks using unstructured triangular fine scale grids .    in the numerical simulations we use standard constant values for granite for the volumetric heat capacity of the rock and the thermal conductivity , @xmath85 kj/(m@xmath86k ) and @xmath87 j@xmath88(mks ) , respectively . for the volumetric heat capacity of the fluid and viscosity , @xmath89 kj@xmath88(m@xmath86k ) , and",
    "@xmath90 cp are used , respectively .",
    "the porosity in the matrix is set to @xmath91 .",
    "the reservoir domain is @xmath92 \\times [ 0 , 1000]$ ] m@xmath93 for all simulations .",
    "initially the temperature in the reservoir is set to 100c , and then water with temperature 20c is injected somewhere in the reservoir . the precise injection and production setups as well as the fracture networks are described for each case in subsections [ conv_study ] , [ pe_exp ] , and [ complex_network ] , respcetively .",
    "the total internal energy per grid cell at time @xmath94 is given by @xmath95 v_i t_i(t ) \\notag \\\\ = ( \\rho c_p)_{eff } v_i t_i(t),\\end{aligned}\\ ] ] where @xmath48 refers to the grid cell index .",
    "the relative @xmath96 error over space in the energy at time @xmath94 , @xmath97 , is then computed as @xmath98 where @xmath99 is the energy vector for the upscaled solution projected on the fine grid , given by @xmath100 , and @xmath101 is the energy vector for a reference solution computed on the fine grid .",
    "@xmath29 refers to the total number of fine grid cells .",
    "we conduct a refinement study using a fine underlying cartesian grid to better understand the practical importance of the iterative framework .",
    "the fracture network consists of six fractures that are aligned with the grid , three in each direction .",
    "first , a coarse mesh is constructed based on a partitioning of the fine grid . because of the structured nature of this fracture network we base the initial coarse grid partition solely on the distance to nearest fracture . using a flow based partition leads to similar results . the upscaling ratio , or _ coarsening factor _ between the coarse and the fine grid is defined as @xmath102 . the coarsening factor is consecutively increased by refining the fine grid by a factor two in each spatial direction , while the same coarse grid is used .",
    "the coarse grid contains @xmath103 grid cells and the fine grids contain @xmath104 , @xmath105 , @xmath106 , and @xmath107 grid cells , respectively , including one - dimensional fracture cells .",
    "water with temperature 20c is injected at a rate of 0.1 @xmath108 in the middle of the domain ( at @xmath109 ) , and extracted where each fracture meets the exterior boundaries .",
    "the total simulation time is @xmath110 years .",
    "the reference temperature for the finest grid is shown in figure [ ref_temp_conv_study ] .",
    "upscaled temperature profiles for the two largest refinement factors are shown in figure [ runex1_fine6889_minc_msrsb ] for + smoothed basis functions and for constant basis functions , respectively .",
    "figure [ 1d_profiles_cartgrid ] shows one dimensional cross - sections of the temperature profiles at vertical value @xmath111 . as seen from the figures , when using the smoothed basis functions , the upscaled method preserves the main features of the fine - scale solution , even for high upscaling ratios .",
    "the constant basis functions overestimate the diffusion , and the heat transfer from the matrix to the fractures is not well captured .",
    "the error increases with the coarsening factor , as can also be seen in the energy error given in table [ table_ex1_cart ] .",
    "this is consistent with the discussion in section [ sec : constbasis ] , in that the gradient is approximated with respect to the fine - scale grid size @xmath83 , rather than the coarse resolution @xmath84 .    to investigate the impact of smoothing iterations we have run a number of simulations varying the maximal number of iterations , without terminating the smoothing of any basis function early .",
    "the upscaled simulations in this section are therefore run with a fixed number of iterations , given in table [ table_ex1_cart ] . when the coarsening factor @xmath112 is larger more iterations are needed in order to reduce the error in the temperature equation .",
    "this is not surprising since for each iteration the support of a basis function for a coarse cell extends approximately one fine grid cell in each spatial direction .",
    "thus , for the temperature gradient to be taken with respect to @xmath84 rather than @xmath83 , the number of iterations should scale with @xmath113 .",
    "however , at a certain number of iterations , depending on the refinement ratio , the error typically starts to increase with more interations .",
    "this is due to that the explicit representation of fractures leads both to a non - uniform coarse grid structure and to irregular shapes of the interaction regions for each coarse cell .",
    "what we have observed is that at a certain point more iterations introduce oscillations in the the basis functions . to ensure the construction of ( overall ) monotone basis functions , we enforce termination of the iterative procedure for each basis function through the criteria of energy reduction described in section [ monotonicity ] in the numerical experiments presented in the following sections .    .",
    "the fine grid contains 413449 grid cells , including fracture cells.,width=294,height=264 ]             [ cols=\"^,^,^,^\",options=\"header \" , ]     [ table_ex1_cart ]          the previous example showed that the coarse discretization , with grids adapted to the fracture network , combined with smoothed basis functions gives a good approximation of the fine - scale temperature profiles .",
    "when the conduction term is discretized with constant basis functions , heat conduction is overestimated , and the approximation quality may suffer .",
    "how severe this effect is naturally depends on the relative importance of heat advection and conduction , as quantified by the heat pclet number .",
    "in this set of numerical experiments we consider a more realistic setup and investigate how variations of the heat pclet number throughout the reservoir affect the numerical results .",
    "we consider a cell based heat pclet number , defined for each cell by equation , where fine scale velocities averaged on each grid cell are used for @xmath26 .",
    "the fracture network used in the simulations in this section are generated using the stochastic fracture generator frac3d @xcite , except from a few of the largest fractures with assumed known positions .",
    "the fracture network is shown in figure [ fractures_2 ] , and apertures range from @xmath114 m to @xmath115 m for the largest fractures . in practice",
    ", the largest of these values corresponds to fracture corridors and fault zones rather than individual features , but we will for simplicity refer to them as fractures . note in particular that the large scale fractures do not form one single connected network .",
    "the average heat pclet numbers per fine grid cell are also shown in figure [ fractures_2 ] .",
    "note that the cell based heat pclet numbers vary by orders of magnitude in different regions of the reservoir due to the fracture - matrix heterogeneity . from figure [ fractures_2 ] we observe that , as expected , advection is the dominant process in the fractures . since the fractures do not form a continuous pathway between inlet and outlet , the fluid needs to flow through the matrix .",
    "this is reflected in relatively high flow rates in the matrix in the middle of the domain , whereas the flow is smaller towards the domain boundary .",
    "based on the previous example , we expect the largest differences between the smoothed and constant basis functions in regions where the heat pclet numbers attain low values . in the simulations 1 @xmath108 of water with temperature 20c",
    "is injected into the domain through a fracture near the bottom left corner and leaves through a fracture near the upper right corner .",
    "exact locations for injection and production are shown in figure [ fractures_2 ] .",
    "we use two computational grids , one fine reference grid with @xmath116 grid cells and an upscaled grid with @xmath117 grid cells , i.e the coarsening factor is @xmath118 .",
    "the grid partitioning for the coarse grid is shown in figure [ grid_partition ] , to illustrate the nonuniform grid structure . a time sequence of temperature profiles for simulations using the fine grid and the upscaled grid with both smoothed and constant basis functions are shown in figure [ time_sequence_ex3 ] at times @xmath119 and @xmath120 years , respectively . for shorter times , advection is dominating and both upscaled simulations capture fine scale behavior well , with some additional numerical diffusion due to the coarse spatial discretization . for longer times the difference between the smoothed basis and the constant basis is more visible .",
    "the smoothed basis performs better compared to the constant basis with respect to capturing heat conduction in the matrix , leading to a less diffused temperature profile .",
    "as expected , the differences are largest towards the domain boundary , where the flow rates are small , and conduction is the dominant transport process .",
    "the production temperatures for both the fine scale simulation and the upscaled simulations are shown in figure [ 1852_gc ] .",
    "both upscaled methods compare well to the fine scale reference simulation , and with smoothed basis functions the upscaled production temperature is closer to that of the reference solution compared to using the constant basis .",
    "fractures_runex3_1point5_linewidth.png ( 5,15)(1,0)8 ( -13,14 ) ( 72,101)(0,-1)8 ( 61,101 )        .",
    "the coarse grid has 1852 grid cells and is generated from a fine grid with 103893 grid cells.,width=264,height=264 ]          +                    .",
    "temperature profiles are shown in figure [ time_sequence_ex3].,width=264,height=264 ]      as a final demonstration of the performance of the coarse discretization framework we apply the method to a very challenging fracture network , shown in figure [ fractures_3 ] .",
    "the fractures are generated with frac3d @xcite , as one set of fractures with high fracture density and the aperture is set to @xmath121 m. all fractures are represented both in the pressure grid and in the transport grid to demonstrate the applicability of the method . for efficiency ,",
    "disconnected fractures can be excluded in the explicit representation and upscaled into the porous medium .",
    "we consider a constant background permeability of @xmath122 md approximating the upscaled fractured media .",
    "the fracture permeability is modeled by equation , leading to a contrast between fracture permeability and background permeability of almost six orders of magnitude . in figure [ fractures_3 ]",
    "the average heat pclet numbers per fine grid cell are shown in addition to the fracture network , as well as production and injection locations .",
    "we observe that due to the high fracture density , there are only small matrix regions with low flow rates .",
    "the fine grid contains @xmath123 grid cells and the upscaled grid @xmath124 grid cells , i.e. the coarsening factor is @xmath125 .",
    "the smoothening of basis functions is terminated after @xmath126 iterations .",
    "the injection rate is 5 @xmath108 and the injection temperature is 20c .",
    "figure [ complex_case_1_year ] shows the fine scale and upscaled temperature profiles at @xmath127 and @xmath128 years , respectively .",
    "both methods preserve the fracture heterogeneity very well .",
    "over longer times , it is clear from figure [ complex_case_1_year ] that the smoothed basis adds less diffusion compared to the constant basis .",
    "figure [ temp_prod_well ] shows the production temperature profiles , and we see that even for this highly complex fracture network , the upscaled methods perform very well , with a similar asymptotic behavior for both methods .",
    "this is also reflected by how the @xmath96 energy errors over space changes over time , as shown in figure [ energy_error_over_time ] . as time progresses , the difference between the @xmath96 energy errors for a smoothed basis and a constant basis increase in favor for the smoothed basis .",
    "nevertheless , the numerical experiments clearly show that both methods can handle complex fracture networks .",
    "fractures_runex4_1point5_linewidth.png ( 14,3)(0,1)8 ( 10,0 ) ( 99,91)(-1,0)8 ( 78,94 )                                 .",
    "temperature profiles are shown in figure [ complex_case_1_year].,width=264,height=264 ]     energy error over space as a function of time for upscaled simulations in section [ complex_network ] , for a constant basis and a smoothed basis , respectively.,width=264,height=264 ]",
    "in this paper , we have presented an upscaling methodology for heat transfer in geothermal fractured reservoirs , modeled by an advection - conduction equation for the temperature .",
    "the methodology uses flow- and structure - based upgridding strategies well suited for advection - driven processes .",
    "the upgridding is combined with a discretization of the coarse scale conductive term based on an algebraic construction of basis functions .",
    "we present two discretizations of the coarse conductive term : one based on piecewise constant functions , and a second formed by a the carefully constructed smoothing procedure of the constant functions . while the former has a simple construction , the latter leads to a superior represenatation of heat transfer via conduction from matrix to fractures .",
    "we demonstrate how to terminate the smoothing iterations to avoid oscillations in the numerical solution .",
    "numerical simulations show that our upscaled framework produces accurate results compared to fine scale numerical solutions for relatively large upscaling ratios , i.e. at a significantly lower cost compared to fine scale simulations .",
    "we also demontrate the applicability of the upscaling framework to a highly complex fracture network , and show that the structural heterogeneity of the fractured reservoir can be preserved .",
    "both the upgridding and the construction of basis functions are based on algebraic approaches , and in principle extensions to three dimensions should therefore be feasible .",
    "however , the upgridding procedure will likely produce no less complex shapes of the coarse cells , and the construction of smoothed basis functions may therefore require further investigation to be robust in 3d .",
    "on the other hand , constant basis functions should be readily applicable , and as the numerical examples show will also give satisfactory accuracy in many cases .",
    ", _ modeling fracture flow with a stochastic discrete fracture network : calibration and validation 2 . the transport model _ water resour .",
    "res . , 26(3 ) , pp .  491500 ( 1990 ) . ,",
    "_ heat transfer in geothermal systems _ , adv .",
    "heat transfer 14 , pp .",
    "1105 ( 1979 ) .                                , _ open - source matlab implementation of consistent discretisations on complex grids _ , comput .",
    "geosci . , 16(2 ) , pp .",
    "297322 ( 2012 ) . , _ modeling fractures and barriers as interfaces for flow in porous media _ , siam j. sci . comput . , 26(5 ) ,",
    "pp .  16671691 ( 2005 ) .        , _ a new approach to simulating flow in discrete fracture networks with an optimized mesh _",
    "siam j. on sci .",
    "comput . , 29(4 ) , pp .",
    "14391459 ( 2007 ) . , _ on the relationship between the multiscale finite volume method and domain decomposition preconditioners _ , comput .",
    "geosci . , 12(3 ) , pp .",
    "367376 ( 2008 ) .          ,",
    "_ a new semi - analytical method for numerical simulation of fluid and heat flow in fractured reservoirs _ , spe adv . tech .",
    "ser . , 1(2 ) , pp .",
    "6372 ( 1993 ) . ,",
    "water resour . , 29(7 ) ,",
    "pp .  1020 - 1036 ( 2006 ) .          , _ modellierung von kluftaquifersystemen : geostatistische analyse und deterministisch - stochastische kluftgenerierung _ , dissertation , institut fr wasserbau , universitt stuttgart , 2002 .",
    "isbn : 3 - 933761 - 17 - 4 ."
  ],
  "abstract_text": [
    "<S> in simulation of fluid injection in fractured geothermal reservoirs , the characteristics of the physical processes are severely affected by the local occurence of connected fractures . to resolve these structurally dominated processes </S>",
    "<S> , there is a need to develop discretization strategies that also limit computational effort . in this paper </S>",
    "<S> we present an upscaling methodology for geothermal heat transport with fractures represented explicitly in the computational grid . </S>",
    "<S> the heat transport is modeled by an advection - conduction equation for the temperature , and solved on a highly irregular coarse grid that preserves the fracture heterogeneity . </S>",
    "<S> the upscaling is based on different strategies for the advective term and the conductive term , respectively . </S>",
    "<S> the coarse scale advective term is constructed from sums of fine scale fluxes , whereas the coarse scale conductive term is constructed based on numerically computed basis functions . </S>",
    "<S> the method naturally incorporates a coupling between the matrix and the fractures via the discretization , so that explicit transfer terms that couple solution variables in the fractures and the matrix are avoided . </S>",
    "<S> numerical results show that the upscaling methodology performs well , in particular for large upscaling ratios , and that it is applicable also to highly complex fracture networks .    </S>",
    "<S> example.eps gsave newpath 20 20 moveto 20 220 lineto 220 220 lineto 220 20 lineto closepath 2 setlinewidth gsave .4 setgray fill grestore stroke grestore </S>"
  ]
}