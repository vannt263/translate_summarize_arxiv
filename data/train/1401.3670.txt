{
  "article_text": [
    "in the maximum asymmetric traveling salesman problem ( max atsp ) we are given a complete directed graph @xmath7 with nonnegative weights on the edges and we wish to compute a traveling salesman tour of maximum weight .",
    "the problem is known to be apx - hard @xcite and the current best approximation algorithms for it are due to kaplan , lewenstein , shafrir and sviridenko @xcite and elbassioni , paluch , van zuylen @xcite . both of them achieve the approximation ratio of @xmath2 , the former is based on linear programming and the other is combinatorial and simpler .",
    "besides being an interesting problem in itself , max atsp is also of particular interest because of its applications to a number of related problems .",
    "for example , an @xmath3-approximation algorithm for max atsp implies a @xmath4-approximation algorithm for ssp , which was recently shown by mucha @xcite .",
    "the shortest superstring problem is defined as follows .",
    "we are given @xmath8 strings @xmath9 over a given alphabet @xmath10 and we want to find a shortest string @xmath11 such that each @xmath12 for @xmath13 is a substring of @xmath11 .",
    "ssp arises in dna sequencing and data compression .",
    "currently the best approximation algorithm for ssp is due to mucha @xcite and achieves an approximation factor of @xmath14 .",
    "any @xmath3-approximation algorithm for max atsp implies also an algorithm with the same guarantee for the maximal compression problem defined by tarhio and ukkonen @xcite .",
    "we devise a combinatorial @xmath0-approximation algorithm for max atsp , thus proving    there exists a @xmath15-approximation algorithm for the maximum tarveling salesman problem .    using the result of mucha @xcite",
    ", we obtain    there exists a @xmath16-approximation algorithm for the shortest superstring problem .",
    "the approach we have adopted is as follows .",
    "we start by computing a maximum weight _ cycle cover _ @xmath17 of @xmath18 , where a cycle cover @xmath19 of graph @xmath18 is defined as a set of directed cycles of @xmath18 such that each vertex of @xmath18 belongs to exactly one cycle of @xmath19 . a maximum weight cycle cover of @xmath18 can be found in polynomial time by a reduction to maximum weight matching .",
    "let @xmath20 denote the weight of a traveling salesman tour of @xmath18 of maximum weight .",
    "the weight of an edge @xmath21 will be denoted as @xmath22 and for any subset @xmath23 of edges @xmath24 by @xmath25 we will mean @xmath26 . since a traveling salesman tour is a cycle cover of @xmath18 ( consisting of just one cycle ) , we know that @xmath27 . by removing the lightest edge from each cycle of @xmath17 , we obtain a collection of vertex - disjoint paths , which can be arbitrarily patched to form a tour . removing the lightest edge from cycle @xmath28 of length @xmath29 results in a path of weight at least @xmath30 . since @xmath17 may contain cycles of lenth two ( @xmath31-cycles ) , in the worst case the obtained tour may have weight equal to @xmath32 .",
    "if we could find a maximum weight cycle cover of @xmath18 without cycles of length two ( @xmath31-cycles ) or three ( @xmath33-cycles ) , then we would achieve a @xmath34- approximation , but , unfortunately finding a maximum weight cycle cover without @xmath31-cycles is apx - hard @xcite .",
    "since @xmath31- and @xmath33-cycles in a maximum weight cycle cover are an obstacle to getting a @xmath0-approximation , we would like to somehow get rid of them . the way we are going to achieve this is as follows .",
    "if @xmath17 contains at least one @xmath31-cycle or at least one @xmath33-cycle ( a triangle ) , we compute a a cycle cover of @xmath18 that does not contain any @xmath31-cycle that already belongs to @xmath17 but may contain * _ half - edges _ * - a half - edge of edge @xmath1 is informally speaking `` either a head or a tail of @xmath1 '' .",
    "such a cycle cover @xmath35 is going to be called a * _ relaxed cycle cover @xmath36 improving @xmath37_*. also we will ensure that a computed @xmath35 has weight at least @xmath20 . a similar relaxed cycle cover and half - edges",
    "have already been introduced in @xcite .",
    "computing @xmath35 is done via a reduction to a maximum weight perfect matching . in some cases",
    "@xmath35 will suffice to build a traveling salesman tour of weight at least @xmath38 .",
    "to ( try to ) extract such a tour from @xmath35 and @xmath17 we build a multigraph @xmath39 consisting of one copy of @xmath17 and two copies of @xmath35 .",
    "each occurrence of an edge @xmath21 in @xmath17 contributes one copy of @xmath21 to @xmath39 and each occurrence of @xmath21 in @xmath35 contributes two copies of @xmath21 to @xmath39 .",
    "if @xmath35 contains only one half - edge of a certain edge @xmath21 , then @xmath35 contributes one copy of @xmath21 to @xmath39 .",
    "the number of copies of edge @xmath21 in @xmath39 may be equal to up to three .",
    "the total weight of edges of @xmath39 is at least @xmath40 .",
    "we would like to divide edges of @xmath39 into four sets @xmath41 in such a way that each @xmath42 ( @xmath43 ) is a collection of vertex - disjoint paths .",
    "one of the sets @xmath44 would then have to have weight at least @xmath38 and by patching it to a tour , we would obtain the desired solution . dividing edges of @xmath39 into four sets can be viewed as coloring them with four colors .",
    "we can immediately see that we are not able to color ( the edges of ) @xmath39 in the way described above if @xmath35 contains any one of the following : @xmath45 a @xmath31-cycle whose one edge belongs to some cycle of @xmath17 , @xmath46 a triangle that already belongs to @xmath17 or a triangle that is oppositely oriented to some triangle of @xmath17 , @xmath47 a triangle whose one edge is contained in some @xmath31-cycle of @xmath17 or @xmath48 a cycle of length @xmath49 such that two of its edges belong to two @xmath31-cycles of @xmath17 . in the paper we will show that if @xmath35 contains neither of the above , then we are able to color @xmath39 as required .    otherwise , if @xmath35 contains one of the cycles that makes it impossible to color @xmath39 into four colors , we compute another cycle cover @xmath50 that does not contain : @xmath45 any @xmath31-cycle that already belongs to @xmath17 , @xmath46 any @xmath31-cycle that belongs to @xmath35 and whose one edge belongs to some cycle of @xmath17 , @xmath47 any triangle @xmath51 such that both @xmath17 and @xmath35 contain a triangle on the same vertices as @xmath51 , @xmath48 a triangle that belongs to @xmath35 and whose one edge is contained in some @xmath31-cycle of @xmath17 or @xmath52 a cycle of length @xmath49 that belongs to @xmath35 and such that two of its edges belong to two @xmath31-cycles of @xmath17 but may contain half - edges .",
    "we call such a cycle cover a * _ relaxed cycle cover improving @xmath37 and @xmath35 . _",
    "* we will compute @xmath50 so that its weight is at least @xmath20 .",
    "computing @xmath50 is done in a similar spirit to computing @xmath35 - via a novel reduction to a maximum weight perfect matching .",
    "once we have cycle covers @xmath53 and @xmath50 described above , we build a multigraph @xmath54 consisting of two copies of each of these cycle covers .",
    "the total weight of edges of @xmath54 is at least @xmath55 .",
    "from @xmath54 we will want to extract a tour of weight at least @xmath38 .",
    "to this end we will divide edges of @xmath54 into eight sets @xmath56 in such a way that each @xmath42 ( @xmath57 ) is a collection of vertex - disjoint paths .",
    "one of the sets @xmath58 will then have to have weight at least @xmath38 .",
    "the task of dividing edges of @xmath39 or @xmath54 into appropriately four or eight sets can equivalently be phrased as follows : we want to color each edge of @xmath39 or @xmath54 with one of four or correspondingly one of eight colors in such a way that each color class consists of vertex - disjoint paths.for coloring both @xmath39 and @xmath54 we present a new method , which we think is interesting in its own right .",
    "one of the surprisingly simple ideas on which this method is based is as follows : let @xmath59 be a subset of @xmath60 and @xmath61 an edge going into @xmath59 ( i.e. @xmath62 and @xmath63 ) , which is colored with a color @xmath29 . then if there exists no edge @xmath64 outgoing from @xmath59 ( i.e. such that @xmath65 and @xmath66 ) which is colored @xmath29 , then @xmath21 does not belong to any cycle , whose all edges are colored @xmath29 .",
    "another ingredient of the method are alternating cycles ( a notion from matching theory ) with certain properties .    * previous and related results * the history of approximating the problems of maximum asymmetric traveling salesman and shortest superstring is quite long as prove the following lists of papers @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite and @xcite , @xcite @xcite , @xcite , @xcite , @xcite .",
    "other variants of the maximum traveling salesman problem that have been considered are among others : the maximum symmetric traveling salesman problem ( max tsp ) , in which the underlying graph is undirected - currently the best known approximation ratio is @xmath67 @xcite , the maximum metric symmetric traveling salesman problem , in which the edge weights satisfy the triangle inequality - the best approximation factor is @xmath68 @xcite , the maximum asymmetric traveling salesman problem with triangle inequality - the best approximation ratio is @xmath69 @xcite .",
    "suppose we have computed a maximum weight cycle cover @xmath17 of a given complete directed graph @xmath7 .",
    "we will say that a cycle @xmath70 is * _ hard _ * if each edge @xmath21 of @xmath28 satisfies @xmath71 . we are going to call cycles of length @xmath72 , i.e. consisting of @xmath72 edges , * _ @xmath72-cycles_*.",
    "also sometimes @xmath33-cycles will be called * _ triangles_*. let us notice that only @xmath31-cycles and triangles can be hard .",
    "if @xmath17 does not contain a hard cycle , then we can easily build a traveling salesman tour of weight at least @xmath73 .",
    "if @xmath17 contains at least one hard cycle , we would like to obtain two other cycle covers @xmath35 and @xmath50 which may contain * _ half - edges _ * - a half - edge of edge @xmath1 is informally speaking `` either a head or a tail of @xmath1 '' .",
    "below we give the precise definitions of a relaxed cycle cover @xmath35 improving @xmath17 and a relaxed cycle cover improving @xmath17 and @xmath35 .",
    "[ rel ] given a complete directed graph @xmath7 with edge weights @xmath74 for every @xmath75 and a maximum weight cycle cover @xmath17of @xmath18 , let @xmath76 be the graph obtained from @xmath18 by replacing each @xmath75 by a vertex @xmath77 and two edges @xmath78 and @xmath79 , each with weight @xmath80 . edges @xmath81 will be called * _ half - edges ( of @xmath1)_*. a * _ relaxed cycle cover improving @xmath17 _ * is a subset @xmath82 such that    * each vertex in @xmath60 has exactly one outgoing and one incoming half - edge in @xmath83 ; * for each @xmath31-cycle @xmath28 of @xmath17 on vertices @xmath84 @xmath83 contains at most two half - edges from @xmath85 .",
    "moreover if @xmath83 contains one half - edge of @xmath1 and one half - edge of @xmath86 , then one of them is incident with @xmath87 and the other with @xmath88 .",
    "let @xmath35 be any relaxed cycle cover improving @xmath17 .",
    "a * _ relaxed cycle cover improving @xmath17 and @xmath35 _ * is a subset @xmath82 such that    * each vertex in @xmath60 has exactly one outgoing and one incoming half - edge in @xmath83 ; * for each @xmath31-cycle @xmath28 on vertices @xmath84 such that @xmath28 either belongs to @xmath17 or @xmath28 belongs to @xmath35 and one of its edges belongs to some cycle of @xmath89 @xmath83 contains at most two half - edges from @xmath85 .",
    "moreover if @xmath83 contains one half - edge of @xmath1 and one half - edge of @xmath86 , then one of them is incident with @xmath87 and the other with @xmath88 ; * for each triangle @xmath51 on vertices @xmath90 containing edges @xmath91 such that either ( 1 ) @xmath92 or ( 2 ) @xmath93 and @xmath35 contains a @xmath31-cycle on two vertices of @xmath51 or ( 3 ) @xmath94 and @xmath17 contains a @xmath31-cycle on two vertices of @xmath51 , + @xmath83 contains at most four and the even number of half - edges of edges of @xmath95 , where @xmath96 denotes a triangle oppositely oriented to @xmath51 . also for any edge @xmath97 , where @xmath98 , @xmath83 satisfies the following : if @xmath99 , then @xmath83 does not contain all half - edges from the set @xmath100 , where @xmath101 belongs to @xmath102 ; * let @xmath28 be a cycle of length @xmath49 containing edges @xmath103 and such that @xmath28 either belongs to @xmath17 and @xmath35 has two @xmath31-cycles that share an edge with @xmath28 or vice versa .",
    "then for each such @xmath28 @xmath83 contains at most six and the even number of half - edges of edges of @xmath104 where @xmath105 denotes a @xmath49-cycle oppositely oriented to @xmath28 .    in graph @xmath106",
    "each original edge of @xmath18 is replaced by two half - edges . since this time on , by saying an edge , we will mean an edge of @xmath18 and by saying a half - edge we will mean an edge of @xmath106 . also by saying that an edge @xmath1 of @xmath18 belongs to @xmath107",
    ", we will mean that both half - edges of @xmath1 belong to @xmath107 .",
    "condition @xmath46 in the above definitions ensures that @xmath107 does not contain certain @xmath31-cycles .",
    "the first part of condition @xmath47 says that @xmath107 does not contain all the edges of a given triangle or a triangle oppositely oriented .",
    "the reason for having the second part of condition @xmath47 , in which we forbid the given subsets of half - edges , is illustrated in figure [ creldef ] .",
    "we will say that a cycle @xmath28 of @xmath35 is * _ problematic _ * if it is a @xmath31-cycle that shares an edge with some cycle of @xmath17 or it is a triangle or a @xmath49-cycle having properties described in conditions @xmath47 and @xmath48 of definition [ rel ] . in an analogous way we define a problematic cycle of @xmath50 .    to compute a relaxed cycle cover @xmath35 improving @xmath17 and a relaxed cycle cover improving @xmath17 and @xmath35 we construct the following undirected graphs @xmath108 and @xmath109 .",
    "first we describe graph @xmath110 . for each vertex @xmath88 of",
    "@xmath18 we add two vertices @xmath111 to @xmath112 .",
    "for each edge @xmath113 we add vertices @xmath114 , an edge @xmath115 of weight @xmath116 and edges @xmath117 , each of weight @xmath118 .",
    "next we build so - called gadgets .    for each @xmath31-cycle of @xmath17 on vertices @xmath87 and @xmath88",
    "we add vertices @xmath119 and edges @xmath120 having weight @xmath116 .",
    "graph @xmath121 is an extension of graph @xmath110 .",
    "let @xmath35 be any relaxed cycle cover improving @xmath17 .",
    "additional gadgets contained in @xmath121 are as follows .    for each triangle @xmath51 on vertices",
    "@xmath90 containing edges @xmath122 such that either ( 1 ) @xmath92 or ( 2 ) @xmath93 and @xmath35 contains a @xmath31-cycle on two vertices of @xmath51 , we add vertices @xmath123 and connect them appropriately to vertices @xmath124 and @xmath125 via edges of weight @xmath116 .",
    "the gadget is depicted in figure [ gtriangle ] .",
    "let us notice that it can not happen that @xmath126 and @xmath127 and @xmath128 because it would mean that triangle consisting of edges @xmath129 has greater weight than @xmath51 and thus that @xmath17 is not a maximum weight cycle cover of @xmath18 .",
    "therefore w.l.o.g .",
    "we can assume that @xmath130 .",
    "for each @xmath49-cycle @xmath28 such that @xmath131 and @xmath17 has two @xmath31-cycles that share an edge with @xmath28 or @xmath70 and @xmath35 has two @xmath31-cycles that share an edge with @xmath28 , we add a similar gadget which will enforce that at most six half - edges of edges @xmath132 are present in @xmath83 .",
    "any perfect matching of @xmath110 yields a relaxed cycle cover @xmath35 improving @xmath17 .",
    "any perfect matching of @xmath121 yields a relaxed cycle cover improving @xmath17 and @xmath35 .",
    "a maximum weight perfect matching of @xmath110 yields a relaxed cycle cover @xmath35 improving @xmath17 such that @xmath133 .",
    "a maximum weight perfect matching of @xmath121 yields a relaxed cycle cover @xmath50 improving @xmath17 and @xmath35 such that @xmath134 .",
    "* proof .",
    "* first we will show that any perfect matching of @xmath121 yields a relaxed cycle cover improving @xmath17 and @xmath35 .",
    "let @xmath135 be any perfect matching of @xmath121 .",
    "@xmath135 defines a set of half - edges @xmath136 of the same weight that satisfies property @xmath45 of definition [ rel ] .",
    "let us now verify that the thus defined set @xmath83 satifies also the other properties of definition [ rel ] .",
    "let @xmath28 be a @xmath31-cycle of @xmath18 on vertices @xmath84 .",
    "then @xmath110 contains vertices @xmath119 and the fact that these vertices have to be matched in a perfect matching ensures that @xmath83 does not contain all four half - edges corresponding to @xmath1 and @xmath86 . if vertices @xmath119 are matched so that @xmath137 is matched with @xmath138 and @xmath139 is matched with @xmath140 , or @xmath137 is matched with @xmath141 and @xmath139 is matched with @xmath142 , then both half - edges of one of the edges @xmath143 are excluded from @xmath107 and for the other edge , either both of its half - edges belong to @xmath107 or both do not belong to @xmath83 .",
    "if @xmath119 are matched in the other way , then matching @xmath135 does not contain appropriately either ( 1 ) @xmath144 and @xmath145 or ( 2 ) @xmath146 and @xmath147 .",
    "therefore condition @xmath46 is indeed satisfied .",
    "let @xmath51 be a triangle containing edges @xmath91 satisfying the properties given in definition [ rel ] .",
    "suppose that @xmath148 .",
    "then the gadget for @xmath51 in @xmath121 looks as in figure [ gtriangle ] .",
    "each of the pair of vertices @xmath149 and @xmath150 , and @xmath151 ensures that exactly two half - edges of edges belonging to corresponding @xmath31-cycles are excluded from @xmath83 .",
    "vertices @xmath152 and @xmath153 gurantee that two more half - edges connecting two vertices from the set @xmath154 are excluded from @xmath83",
    ". therefore @xmath83 contains at most four half - edges connecting two vertices from the set @xmath154 .",
    "we will prove now that @xmath83 contains neither all the half - edges from the set @xmath155 nor all the half - edges from the set @xmath156 .",
    "let us suppose that @xmath83 contains all the half - edges from the set @xmath157 .",
    "since edge @xmath158 belongs to @xmath83 vertex @xmath153 can not be matched with @xmath159 .",
    "since both @xmath160 and @xmath161 belong to @xmath83 vertex @xmath153 can not be matched with @xmath162 or with @xmath163 .",
    "but @xmath153 is incident only with vertices @xmath164 and these are the only vertices it can be matched with - a contradiction .",
    "let us now suppose that @xmath83 contains all the half - edges from the set @xmath165 .",
    "since edge @xmath166 belongs to @xmath83 , vertex @xmath167 must be matched with @xmath168 . since @xmath169 vertex @xmath170 must be matched with @xmath171 . since @xmath172 vertex @xmath152 can not be matched with @xmath173 .",
    "but @xmath152 is incident only with @xmath174- a contradiction .",
    "it is fairly straightforward to show that each traveling salesman tour @xmath175 of @xmath18 corresponds to some perfect matching of @xmath121 .",
    "it is so because a tour can not contain a @xmath31-cycle or triangle if the graph @xmath18 contains at least four vertices .",
    "therefore any maximum weight perfect matching of @xmath121 yields a relaxed cycle cover @xmath50 improving @xmath17 and @xmath35 such that @xmath134 .",
    "the proof for a relaxed cycle cover @xmath35 improving @xmath17 is analogous .",
    "@xmath176 +     on vertices @xmath90 such that @xmath51 consists of edges @xmath91 and @xmath130 . to make the figure more readable vertices",
    "@xmath177 are drawn twice each .",
    "vertices @xmath123 are connected correspondingly to vertices @xmath124 and @xmath125 .",
    "notice that @xmath123 are connected to vertices on edge @xmath158 which does not belong to @xmath51 . ]     on vertices @xmath90 such that @xmath51 consists of edges @xmath91 and @xmath130 . to make the figure more readable vertices",
    "@xmath177 are drawn twice each .",
    "vertices @xmath123 are connected correspondingly to vertices @xmath124 and @xmath125 .",
    "notice that @xmath123 are connected to vertices on edge @xmath158 which does not belong to @xmath51 . ]",
    "let us notice that a relaxed cycle cover @xmath35 and a relaxed cycle cover @xmath50 improving @xmath35 and @xmath17 consist either of ( 1 ) directed cycles or ( 2 ) directed paths such that each one of them begins and ends with a half - edge or both .",
    "we will say that @xmath35 ( @xmath50 ) is * _ integral _ * if for each edge @xmath178 @xmath35 ( @xmath50 ) contains either both half - edges of @xmath21 or none .",
    "if @xmath35 or @xmath50 is integral , then it corresponds to a cycle cover of @xmath18 i.e. consists only of directed cycles .",
    "the algorithm starts with computing a maximum weight cycle cover @xmath17 of a given graph @xmath18 .",
    "if @xmath17 does not contain any hard cycles , we can easily build a tour of weight @xmath179 .",
    "otherwise we compute a relaxed cycle cover @xmath35 improving @xmath17 and , if necessary , a relaxed cycle cover @xmath50 improving @xmath17 and @xmath35 .",
    "both of them are such that @xmath180 .",
    "we compute @xmath35 and @xmath50 in the way described in the previous section . we create two multigraphs @xmath39 and @xmath54 as described in introduction . the total weight of all edges of @xmath39 ( corr .",
    "@xmath54 ) is equal to @xmath181 ( corr .",
    "2(@xmath182 ) , which is at leas t@xmath40 ( corr .",
    "@xmath55 . )",
    "next we would like to divide edges of @xmath39 into four sets @xmath41 in such a way that each @xmath42 ( @xmath43 ) is a collection of vertex - disjoint paths .",
    "if this turns out to be impossible , because @xmath35 contains a problematic cycle , we will show how to divide edges of @xmath54 into eight sets @xmath56 in such a way that each @xmath42 ( @xmath57 ) is a collection of vertex - disjoint paths.the task of dividing edges of @xmath39 or @xmath54 into appropriately four or eight sets can equivalently be viewed as coloring each edge of @xmath39 or @xmath54 with one of four or correspondingly one of eight colors .",
    "let @xmath183 denote @xmath184 @xmath185 and @xmath186 .",
    "further on we will treat @xmath39 and @xmath54 as simple graphs but will require that each edge is colored with an appropriate number of colors equal to the number of its copies in the graph .",
    "we will say that two edges @xmath187 and @xmath188 are * _ in - coincident _ * if there exists a vertex @xmath88 such that both of them are going into @xmath88 .",
    "( we will also say that @xmath187 is in - coincident with @xmath188 . )",
    "we will say that they are * _ out - coincident _ * if there exists a vertex @xmath88 such that both of them are outgoing from @xmath88 .",
    "two edges are * _ coincident _ * if they are in - coincident or out - coincident .",
    "we will also say that an edge @xmath21 is in - coincident with a cycle @xmath28 of @xmath35 if @xmath21 is in - coincident with some edge of @xmath28 .",
    "cycle covers are a special case of @xmath189-matchings and therefore many notions and facts from matching theory will prove useful .",
    "below we recall some of them .",
    "a sequence @xmath190 of edges @xmath191 is said to be * _ an alternating path ( with respect to a given cycle cover @xmath19 ) _ * if its edges alternately belong and do not belong to @xmath19 , every two consecutive edges of @xmath190 are coincident and for each @xmath192 edge @xmath193 is in - coincident with @xmath194 and out - coincident with @xmath195 or vice versa .",
    "an alternating path @xmath196 such that exactly one of the edges @xmath197 belongs to @xmath19 and either @xmath198 is in - coincident with @xmath199 and out - coincident with @xmath187 or the other way round is called * _ an alternating cycle ( with respect to @xmath19)_*. it can be observed that a symmetric difference @xmath200 of two cycle covers @xmath201 of @xmath18 consists of edge - disjoint alternating cycles ( wrt .",
    "both @xmath35 and @xmath50 ) .",
    "( see also @xcite for example . )    since @xmath202 is not always integral , we need to extend the definition of an alternating cycle .",
    "we do it as follows .",
    "let @xmath19 be any cycle cover of @xmath18 .",
    "a sequence @xmath196 is going to be called * _ an alternating h - cycle ( wrt .",
    "@xmath19 ) _ * if @xmath187 and @xmath198 are half - edges and otherwise @xmath190 satisfies analogous conditions as an alternating path .",
    "wel also introduce the term of an alternating weight .",
    "suppose that @xmath190 is an alternating path or cycle ( wrt .",
    "@xmath19 ) , then * _ the alternating weight ( wrt .",
    "@xmath19 ) of @xmath190 _ * is defined as @xmath203 . if @xmath19 is a cycle cover of @xmath18 and @xmath204 an alternating cycle wrt .",
    "@xmath19 , then by * _ applying @xmath204 to @xmath19 _ * we will mean the operation , whose result is @xmath205 .",
    "@xmath205 is also a cycle cover of @xmath18 and we have @xmath206 .",
    "we can easily observe the following property of any alternating cycle with respect to @xmath17 .",
    "[ f ] let @xmath204 be any alternating cycle with respect to @xmath17",
    ". then @xmath207 .    *",
    "* @xmath17 is a maximum weight cycle cover of graph @xmath18 and @xmath208 is a cycle cover of @xmath18 . therefore @xmath209 .",
    "since @xmath210 , we get that @xmath211 .",
    "@xmath176 +    both @xmath212 and @xmath213 disintegrate into alternating cycles and h - cycles , i.e. each edge of correspondingly @xmath212 and @xmath213 belongs to exactly one alternating cycle or h - cycle .",
    "+ we will say that an alternating cycle @xmath204 of @xmath212 is * _ necessary _ * if @xmath214 contains a @xmath31-cycle which also belongs to @xmath17 . + we will say that an alternating cycle @xmath204 of @xmath213 is * _ necessary _ * if @xmath215 contains any of the cycles described in definition [ rel ] .    it will be convenient for us to deal with relaxed cycle covers @xmath35 and @xmath50 such that both @xmath212 and @xmath213 contain only necessary alternating cycles and possibly alternating h - cycles .",
    "[ necessary ] let @xmath35 be a relaxed cycle cover improving @xmath17 such that @xmath133 and let @xmath50 be a relaxed cycle cover improving @xmath17 and @xmath35 such that @xmath134 .",
    "then there exists a relaxed cycle cover @xmath216 improving @xmath17 such that @xmath217 and every alternating cycle from @xmath218 is necessary .",
    "similarly , there exists a relaxed cycle cover @xmath219 improving @xmath17 and @xmath216 such that @xmath220 and every alternating cycle from @xmath221 is necessary .    because of the above lemma since this time on we will assume that every alternating cycle from @xmath212 or @xmath213 is necessary .",
    "we will now show how to color the edges of @xmath39 with colors from @xmath222 in such a way that each color class consists of vertex - disjoint paths .",
    "( if it is not possible to color the whole @xmath39 , then we leave problematic cycles uncolored . )",
    "let us first demonstate how we color the graph @xmath39 when @xmath35 is integral .",
    "formally , the coloring of @xmath39 is an assignment of colors of @xmath222 to edges of @xmath39 .",
    "each edge of @xmath17 is assigned one color and each edge of @xmath35 is assigned two colors .",
    "( if an edge belongs to @xmath223 , then , as a consequence , it is assigned three colors . )",
    "we say that a coloring of @xmath39 is * _ partial _ * if some of its edges have colors assigned to them ( these edges are * _ colored _ * ) and some of them do not ( these edges are * _ uncolored_*. ) still , in a partial coloring of @xmath39 an edge of @xmath35 either has two colors assigned to it or none .",
    "a ( partial ) coloring of @xmath39 is called * _ good _ *",
    "if each color class consists of vertex - disjoint paths    the idea behind coloring @xmath39 is that for each cycle of @xmath17 we mark at least one of its edges , that is going to be colored with one of the colors of @xmath224 and color the unmarked edges of @xmath17 with @xmath49 . whenever possible",
    "we want to color the edges of @xmath35 only with colors of @xmath224 .",
    "each edge @xmath61 of @xmath35 has to be colored twice .",
    "let @xmath225 be two edges of @xmath17 that are coincident with @xmath21 , i.e. they have the form @xmath226 ( they may denote the same edge ) .",
    "then , of course @xmath21 can not be colored with the same color as @xmath187 or @xmath188 .",
    "if @xmath187 is marked and we want to color it @xmath227 and @xmath188 is unmarked , then @xmath21 has to be colored with @xmath31 and @xmath33 .",
    "if both @xmath187 and @xmath188 are marked and we want to color @xmath187 with @xmath227 and @xmath188 with @xmath31 , then we have to use @xmath49 for coloring @xmath21 and color it with @xmath33 and @xmath49 . on the other hand ,",
    "if both @xmath187 and @xmath188 are marked and we want to color them with the same color , say @xmath227 for example , then we have a choice and can color @xmath21 with @xmath31 and @xmath33 or @xmath31 and @xmath49 or @xmath33 and @xmath49 .    in a ( partially ) colored @xmath39 a cycle @xmath28 is called * _ monochromatic _ * if there exists a color @xmath72 of @xmath222 such that each edge of @xmath28 is colored @xmath72 .",
    "of course , if a ( partial ) coloring of @xmath39 is good , then @xmath39 does not contain any monochromatic cycles .",
    "we will say that an edge @xmath21 is * _ safe _ * if no matter how we color the so far uncolored edges , it is guranteed not to belong to any monochromatic cycle . for example suppose that edge @xmath228 is colored with color @xmath227 and that edges @xmath229 are colored appropriately @xmath31 and @xmath230 .",
    "then clearly @xmath21 is safe .",
    "an edge @xmath228 will be called * _ external _ * if @xmath87 and @xmath88 belong to two different cycles of @xmath35 .",
    "otherwise it will be called * _",
    "internal_*.    we state now the observation that will prove very useful in guaranteeing that we do not create monochromatic cycles .",
    "[ obs ] suppose that edge @xmath61 colored @xmath227 goes into cycle @xmath28 of @xmath35 ( i.e. @xmath87 does not belong to @xmath28 and @xmath88 does ) .",
    "if there exists no edge @xmath64 going out of @xmath28 ( @xmath231 is on @xmath28 and @xmath232 is not ) that is colored @xmath29 , then @xmath21 does not belong to any cycle , whose all edges are colored @xmath29 . in other words , @xmath21 is safe .",
    "we say that an edge @xmath21 belonging to a cycle of @xmath35 is * _ winged _ * if all external edges coincident with it are marked .",
    "( an edge that has no external edges coincident with it is thus wingy as well . ) for each cycle @xmath28 of @xmath35 we will require that at least @xmath233 of its edges are winged .",
    "( @xmath234 denotes the length of @xmath28 . ) an external marked edge @xmath21 coincident with a cycle @xmath28 is called * _ a tail ( of @xmath28 ) _ * if all external edges coincident with @xmath28 are marked or if @xmath21 is coincident with an edge of @xmath28 that is not winged . an external marked edge @xmath21 coincident with a cycle @xmath28 that is not its tail is a * _ wing ( of @xmath28)_*. we also say that a cycle @xmath28 is * _ taily _ * if @xmath28 has exactly @xmath235 external marked edges coincident with it .",
    "now , we are ready to give the definition of a nice set of marked edges .",
    "[ nice ] we say that a set of marked edges of @xmath17 is * _ nice _ * if    * for each cycle @xmath28 of @xmath35 at least @xmath233 of its edges are winged , * no edge of @xmath17 is a tail of two different cycles of @xmath35 , * for each @xmath31-cycle @xmath28 of @xmath35 , if @xmath236 has exactly one tail , then it also has a wing which is also a wing of another cycle of @xmath35 .",
    "[ mark ] there exists an algorithm of marking the external edges of @xmath17 in such a way that the resulting set is nice .",
    "the running time of the algorithm is @xmath237 .",
    "next we are going to show the algorithm of coloring @xmath39 which consists of three phases . in phase 1 we color",
    "all marked external edges in such a way that all of them are safe .",
    "for clarity , we first present phase 1 and phase 2 for the case when there are no taily cycles .",
    "+ phase 1 of algorithm color @xmath39 + * while * there exists a cycle @xmath28 of @xmath35 that has an uncolored tail or wing * do * + color all the uncol . marked external edges going into @xmath28 with @xmath227 and all the uncol .",
    "marked external edges going out of @xmath28 with @xmath31 or @xmath33 ; +    [ safe ] in phase 1 of algorithm color @xmath39 , after getting colored , a marked external edge @xmath21 is safe .",
    "* proof .",
    "* let @xmath21 denote any external marked edge . at some point , @xmath21 gets colored together with all other so far uncolored external marked edges coincident with some cycle @xmath28 of @xmath35 .",
    "if at this point , @xmath28 has no previously colored marked external edges coincident with it , then by observation [ obs ] , @xmath21 becomes safe , because we color all marked edges going into @xmath28 with @xmath227 and all marked edges going out of @xmath28 with @xmath31 or @xmath33 .",
    "if , on the other hand , @xmath28 has some previously colored marked external edges coincident with it , then , by this proof , they are already safe .",
    "thus , if @xmath21 is going into @xmath28 , then we color it with @xmath227 and if there exists an edge @xmath21 going out of @xmath28 and colored @xmath227 , then it must have been colored previously and is safe . therefore , @xmath21 is safe as well .",
    "the case when @xmath21 is going out of @xmath28 is analogous .",
    "@xmath176 +    after phase 1 all colored edges are safe but it may happen that there is no way of completing this coloring so that it is good .",
    "for example if a cycle @xmath28 has @xmath238 external edges coincident with it and all edges going into @xmath28 are colored @xmath227 and all edges going out of @xmath28 are colored @xmath31 , then the only way of completing the current coloring is to color each edge of @xmath28 with @xmath33 and @xmath49 . this way we would create a cycle within the class of edges colored @xmath33 and within the class of edges colored @xmath49 .",
    "we say that a cycle @xmath105 of @xmath39 is a * _ cycle within a cycle @xmath28 _ * if every vertex lying on @xmath105 lies also on @xmath28 .",
    "we say that a cycle @xmath28 of @xmath35 is blocked if there is no way of completing the current partial coloring so that it does not contain a monochromatic cycle within @xmath28 .",
    "an internal edge @xmath61 will be called * _ quasiexternal _ * if there exist external edges @xmath225 such that @xmath187 is incident with @xmath87 and @xmath188 is incident with @xmath88 .",
    "[ block ] a cycle @xmath28 of @xmath35 can be blocked only if @xmath28 satisfies one of the following :    * @xmath28 has exactly @xmath235 external edges coincident with it and the number of edges of @xmath28 whose wings are colored the same plus the number of colors of @xmath222 that occur on the external edges of @xmath28 is less than @xmath49 , * all external edges of @xmath28 are colored with the same color , * all external edges coincident with @xmath28 are marked , all internal edges of @xmath28 are quasiexternal and for each quasiexternal edge @xmath61 of @xmath28 there exist two different colors @xmath239 of @xmath224 such that an external edge of @xmath28 incident with @xmath87 is colored @xmath240 , an external edge of @xmath28 incident with @xmath88 is colored @xmath241 and an edge of @xmath28 that is coincident with @xmath21 has an external marked edge coincident with it that is colored with a color @xmath242 belonging to @xmath243 , * @xmath28 is problematic .",
    "otherwise the current partial coloring can be completed in such a way that it does not contain a monochromatic cycle within @xmath28 .",
    "let us notice that if a cycle @xmath28 of @xmath35 is blocked and it is not taily , then we can change the coloring of its tail @xmath51 to @xmath29 , where @xmath29 is such a color of @xmath224 that no external edge incident with @xmath28 is colored @xmath29 , and , as a result , @xmath28 will not be blocked any more and @xmath51 will be safe . roughly , this is what we are going to do in phase 2 with blocked cycles that are not taily .    in phase 2",
    "we are going to change the coloring of some of the external marked edges in such a way that each colored edge is safe and there is no blocked cycle of @xmath35 .",
    "+    phase 2 of algorithm color @xmath54 + there exists a blocked cycle of @xmath35 that is not taily + @xmath244 any blocked cycle of @xmath35 that is not taily + @xmath28 is blocked * do * + change the coloring of the tail @xmath51 of @xmath28 so that @xmath28 is not blocked any more + @xmath51 is also a wing of another cycle @xmath105 of @xmath35 + @xmath105 is blocked and is a @xmath31-cycle , * then * we can change the coloring of its wings and a tail in such a way + that we do not create a new blocked cycle + @xmath105 is blocked , * then * @xmath245    [ p2 ] in phase 2 of algorithm color @xmath39 each colored edge is safe at all times . after executing phase 2",
    ", the graph @xmath39 does not contain a blocked cycle @xmath28 of @xmath35 , apart from problematic cycles .",
    "the running time of phase 2 is @xmath246 .",
    "* proof .",
    "* let @xmath247 denote the graph @xmath248 in which every cycle of @xmath35 is shrunk into one vertex .",
    "all internal edges become loops in @xmath247 and we remove them ( from @xmath247 ) .",
    "thus , the edges of @xmath247 contain all external edges .",
    "let @xmath249 denote the subgraph of @xmath247 containing edges colored @xmath250 .",
    "let us observe that saying that saying that graph @xmath251 is acyclic implies that all external marked edges colored @xmath250 are safe . before starting phase 2 each graph @xmath251 for @xmath252 is acyclic by lemma [ safe ] and the properties of phase 1 .",
    "when in phase 2 of algorithm color @xmath39 we change the coloring of edge @xmath21 from @xmath240 to @xmath241 , we remove one edge from graph @xmath253 and add one edge to graph @xmath254 . removing an edge from an acyclic graph can not make it non - acyclic .",
    "when we change the coloring of @xmath21 into @xmath241 , then one of the cycles of @xmath35 with which @xmath21 is coincident has no other external edges coincident with it that are colored @xmath241 . therefore adding such an edge to @xmath254",
    "can not create a cycle there either .",
    "if a cycle @xmath28 is blocked , we change the coloring of its tail .",
    "another time the coloring of some external edge coincident with @xmath28 can change is when one of its wings changed a color . then if @xmath28 is not a @xmath31-cycle , it can not become blocked and if @xmath28 is a @xmath31-cycle , we are able to change the coloring of its wings and tail in such a way that we do not craete a new blocked cycle .",
    "this shows that the inner while loop in phase 1 ends after visiting at most all cycles of @xmath35 .",
    "@xmath176 +    now , we show what to do with taily cycles .",
    "we say that a taily cycle @xmath28 is * _ favourable _ * if there exitsts such an edge of @xmath28 that the two tails of @xmath28 coincident with @xmath21 are wings of two different cycles of @xmath35 . for each taily",
    "favourable cycle @xmath28 of @xmath35 that is not a @xmath31-cycle , we will be able to guarantee that it does not become blocked in phase 1 and for each taily cycle @xmath28 that is not favourable we will be able to guarantee that for each color @xmath255 of @xmath224 at least one of the tails of @xmath28 is colored @xmath29 .",
    "phase 1 of algorithm color @xmath39 + * while * there exists a cycle @xmath28 of @xmath35 that has an uncolored tail or wing * do * + there exists a taily favourable cycle @xmath28 that has an edge with exactly one colored tail coincident with it + let @xmath21 be an edge of @xmath28 such that exactly one of the edges @xmath225 coincident with it is colored ; + suppose that @xmath187 is colored @xmath29 and is going into ( out of ) @xmath28 ; + color all the uncol .",
    "external edges going into ( out of ) @xmath28 with @xmath29 and all the uncol .",
    "external edges going out of ( into ) @xmath28 + with one of the colors from @xmath256 .",
    "+   + there exists a taily cycle @xmath28 that is not favourable and whose at least one tail is colored + suppose that one of the tails of @xmath28 is colored @xmath29 ; + let @xmath257 be the two colors from @xmath256 ; + color all the uncol .",
    "external edges going into @xmath28 with @xmath258 and all the uncol .",
    "external edges going out of @xmath28 with @xmath259 or vice versa + so that @xmath28 has a tail colored with every color from @xmath224 .",
    "+   + color all the uncol . marked external edges going into @xmath28 with @xmath227 and all the uncol .",
    "marked external edges going out of @xmath28 + with @xmath31 or @xmath33 .",
    "+    [ safe1 ] in phase 1 of algorithm color @xmath39 , after getting colored , a marked external edge @xmath21 is safe .",
    "after the execution of phase 1 no taily favourable cycle of @xmath35 , which is not a @xmath31-cycle , is blocked .    * proof .  * the proof of the first part of the lemma goes through analogously as the proof of lemma [ safe ] .",
    "the key observation is that at the step when we color all uncolored external edges incident with a given cycle @xmath28 of @xmath35 , we color all the so far uncolored edges going into @xmath28 differently than the so far uncolored edges going out of @xmath28 .",
    "@xmath176 +    part 2 of phase 2 of algorithm color @xmath39 + * while * there exists a blocked taily cycle @xmath28 of @xmath35 * do * + if @xmath28 is not a @xmath31-cycle , then @xmath28 has an edge such that if we change the color of one of the tails @xmath51 of @xmath28 coincident with @xmath21 to @xmath49 , + then @xmath28 will cease to be blocked and a cycle @xmath236 of @xmath35 such that @xmath51 is its wing will not become blocked ; + if @xmath28 is a @xmath31-cycle , then we can change the coloring of its tails in such a way that @xmath28 is not blocked any more + and we do not create a new blocked cycle .",
    "[ taily ] part 2 of phase 2 of algorithm color @xmath39 can be performed .",
    "moreover , it can be performed in such a way that whenever an external edge changes color it becomes safe .",
    "phase 3 of algorithm color @xmath39 is based on lemma [ block ] and consists in completing the coloring in such a way that graph @xmath39 does not contain a monochromatic cycle within any cycle of @xmath35 and coloring all unmarked external edges @xmath49 .",
    "we can observe that after the execution of phase 3 , @xmath39 does not contain a monochromatic cycle colored @xmath260 or @xmath33 .",
    "it is so , because by lemma [ p2 ] , each external marked edge is safe and by lemma [ block ] , there is no monochromatic cycle within any cycle of @xmath35 .",
    "we will now prove that @xmath39 can not contain a monochromatic cycle colored @xmath49 either .",
    "let us notice that an edge @xmath261 can be colored @xmath49 only if it belongs to @xmath35 and two edges of @xmath17 coincident with it are marked .",
    "therefore , the danger of creating a monochromatic cycle colored @xmath49 exists on a cycle @xmath28 of @xmath39 if every edge @xmath21 of @xmath28 is either an unmarked edge of @xmath17 or has two marked edges coincident with it and @xmath28 contains an external edge .",
    "let us call such a cycle * _",
    "black_*.    [ black ] after the execution of phase 3 , the graph @xmath39 contains no black cycle .",
    "* proof .  *",
    "the existence of a black cycle in @xmath39 would imply the existence of an alternating cycle @xmath204 of @xmath212 , which is not necessary .",
    "@xmath176 +      the first part of coloring @xmath54 consists in coloring @xmath262 which consists of one copy of @xmath17 and two copies of @xmath50 . we color @xmath262 with colors from @xmath263 in a very similar way to coloring @xmath39 .",
    "( in @xmath262 directed paths may end with half - edges of edges of a triangle or a @xmath49-cycle of @xmath17 . )",
    "it may happen that we can not color the whole @xmath262 because it contains problematic cycle(s ) .",
    "still , problematic cycles do not occur on the same set of vertices both in @xmath39 and @xmath262 . as a final step ,",
    "we complete the coloring of @xmath39 and @xmath262 by borrowing colors from one another .",
    "for example , suppose that a triangle @xmath51 belongs both to @xmath17 and @xmath35 but none of its edges belongs to @xmath50 .",
    "notice that @xmath51 needs to be colored four times in @xmath54 .",
    "then , if four edges of @xmath51 are colored with colors from @xmath264 , then the remaining eight edges of @xmath51 can be colored with colors from @xmath222 .",
    "* proof .",
    "* @xmath265 can be decomposed into alternating cycles and h - cycles .",
    "let @xmath266 denote all alternating cycles from @xmath212 that are not necessary .",
    "then @xmath267 is another relaxed cycle cover improving @xmath17 .",
    "moreover @xmath268 does not contain any alternating cycle that is not necessary .",
    "the weight of @xmath216 is equal to @xmath269 .",
    "by fact [ f ] the alternating ( with respect to @xmath17 ) weight of @xmath270 is nonpositive .",
    "therefore the alternating with respect to @xmath35 weight of @xmath270 is nonnegative .",
    "this means that @xmath217 .",
    "the proof of the existence of @xmath219 is analogous .",
    "@xmath176 +      * proof .",
    "* we prove that if a cycle @xmath28 of @xmath35 does not fall into any of the described five categories , then the current partial coloring can be completed in such a way that it does not contain a monochromatic cycle within @xmath28 .",
    "* case 1 : @xmath28 has no external edges . * + for each cycle @xmath105 of @xmath17 whose all edges are internal edges of @xmath28 , we choose one of its edges and color it @xmath227 .",
    "we do it in such a way that if @xmath105 contains an edge belonging also to @xmath28 , then we color such an edge with @xmath227 . if possible , we choose an edge @xmath21 of @xmath28 such that the edges @xmath225 of @xmath17 belong to two different cycles of @xmath17 and color @xmath187 and @xmath188 with @xmath227 and @xmath21 with @xmath31 and @xmath49 .",
    "we then find one more edge of @xmath28 that can be colored with @xmath227 and @xmath33 and we are done .",
    "* case 2 : @xmath28 has external edges * + for each edge @xmath21 of @xmath28 that has one colored edge @xmath271 coincident with it , we color @xmath21 with colors belonging to @xmath272 , where @xmath29 is the color with which @xmath21 is colored . for each edge @xmath21 of @xmath28 that has two differently colored edges @xmath225 coincident with it ,",
    "we color @xmath21 with colors from @xmath273 , where @xmath274 are the colors with which @xmath225 are colored .",
    "if edge @xmath21 of @xmath28 that has two colored edges @xmath225 coincident with it that are colored with the same color @xmath275 , then if for each color @xmath275 there exists an edge @xmath276 incident with @xmath28 that is colored @xmath29 , then we color @xmath21 with @xmath272 , otherwise we color it with @xmath277 , where @xmath278 is that color of @xmath224 with which no edge of @xmath17 coincident with @xmath28 is colored .",
    "if there exists a quasiexternal edge @xmath61 such that coloring it with @xmath49 would result in creating a monochromatic cycle within @xmath28 , then we color it with the color with which @xmath187 or @xmath188 ic colored , where @xmath225 are external edges incident appropriately with @xmath87 or @xmath88 .",
    "we try to do this in such a way that an edge @xmath271 of @xmath28 coincident with @xmath21 does not have two differently colored edges coincident with it .    similarly , if there exists a path consisting of internal and uncolored edges of @xmath28 such that if we colored all of the edges on this path with @xmath49 , we would create a monochromatic cycle within @xmath28 , we color one of these edges with a color of @xmath224 .",
    "if a colored edge @xmath21 of @xmath28 is such that at some point a so far uncolored edge coincident with it gets colored , then we may have to change the coloring of @xmath21 in the way described above .",
    "if there is no cycle of @xmath17 , that consists solely of uncolored and internal edges of @xmath28 , then we complete the coloring by coloring the uncolored internal edges of @xmath28 with @xmath49 and the uncolored edges of @xmath28 with colors from @xmath224 .",
    "otherwise we continue the coloring in the way shown below .",
    "* case 2a : for each color @xmath275 there exists an edge @xmath276 incident with @xmath28 that is colored @xmath29 *   + we proceed as follows .",
    "let @xmath105 be any cycle of @xmath17 , whose all edges are internal edges of @xmath28 .",
    "let @xmath61 be any edge of @xmath105 .",
    "we can notice that it is always possible to color @xmath21 with one of the colors of @xmath224 so that @xmath21 does not belong to a monochromatic cycle within @xmath28 .",
    "it is so because an edge @xmath279 of @xmath28 going into @xmath87 is colored with at most two colors of @xmath224 .",
    "it may happen that coloring @xmath21 with such a color forces edges @xmath225 of @xmath28 coincident with @xmath21 to be colored with @xmath49 and as a result we could create a monochromatic cycle colored @xmath49 that contains the uncolored edges of @xmath105 .",
    "it is possible only if both @xmath187 and @xmath188 has an edge coincident with it that is colored with a color of @xmath224 different from @xmath29 .",
    "let @xmath280 be an edge of @xmath105 and let @xmath281 be an edge of @xmath28 .",
    "+ * case i * both @xmath279 and @xmath282 has an edge coincident with it that is colored @xmath29 and @xmath187 has an edge coincident with it that is colored @xmath283 .",
    "then we color @xmath21 with @xmath278 , @xmath271 with @xmath29 , @xmath187 and @xmath279 with @xmath277 and @xmath282 with @xmath272 .",
    "we color all the remaining uncolored edges of @xmath105 with @xmath49 . this way ,",
    "all the edges of @xmath105 and edges @xmath284 are safe .",
    "+ * case ii * @xmath279 ( or @xmath282 ) has an edge coincident with it that is colored @xmath29 and @xmath187 has an edge coincident with it that is also colored @xmath29",
    ". then we color @xmath21 with @xmath29 and @xmath187 and @xmath279 ( or @xmath187 and @xmath282 ) with @xmath272 . + * case 2b : there exists a color @xmath285 such that exists no edge @xmath276 incident with @xmath28 is colored @xmath286 *   + each cycle of @xmath17 but one whose all edges are internal edges of @xmath28 is processed as in the case 2a above .",
    "let @xmath105 be the last cycle of @xmath17 such that all its edges are so far uncolored and are internal edges of @xmath28 .",
    "let @xmath287 be any two edges of @xmath105 , @xmath225 two edges of @xmath28 coincident with @xmath21 and @xmath288 edges of @xmath28 .",
    "+ * case i * both @xmath187 and @xmath188 has an edge coincident with it that is colored @xmath29 and @xmath187 has an edge coincident with it that is also colored @xmath289",
    ". then we color @xmath21 with @xmath29 , @xmath279 and @xmath188 with @xmath272 and @xmath187 with @xmath290 .",
    "this way we have guaranteed that at least one edge of @xmath28 is nor colored with @xmath286 . + * case ii * there is no edge @xmath21 of @xmath105 that fullfills the conditions of case i above and @xmath105 is a @xmath31-cycle .",
    "then either ( 1 ) both @xmath187 and @xmath188 has an edge coincident with it that is colored @xmath29 and @xmath279 and @xmath282 has an edge coincident with it that is colored @xmath283 or ( 2 ) edges coincident with @xmath187 and @xmath188 are colored differently ( with colors @xmath29 and @xmath278 ) and the same for edges coincident with @xmath279 and @xmath282 . in the first case we color @xmath21 with @xmath29 ,",
    "@xmath271 with @xmath278 , @xmath187 and @xmath279 with @xmath277 , @xmath188 with @xmath272 and @xmath282 with @xmath291 . in the second case we color @xmath21 with @xmath29 , @xmath271 with @xmath278 , three of the edges of @xmath292 with @xmath277 and one of them appropriately with @xmath290 or with @xmath291 . + * case iii * there is no edge @xmath21 of @xmath105 that fullfills the conditions of case i above and @xmath105 has more than two edges .",
    "we consider three edges @xmath293 of cycle @xmath105 and proceed similarly as above ensuring that there exists an edge colored with @xmath291 or with @xmath290 and an edge of @xmath28 incident with @xmath294 or @xmath295 not colored with @xmath49 .",
    "@xmath176 +      * proof .",
    "* let @xmath28 be a blocked taily cycle of @xmath35 that has more than @xmath31-edges .",
    "then for each color @xmath29 of @xmath224 there exists a tail of @xmath28 colored @xmath29 .",
    "let @xmath21 be any edge of @xmath28 and @xmath225 tails of @xmath28 coincident with @xmath21 .",
    "since @xmath28 is not favourable , we know that there exists a cycle @xmath105 of @xmath35 such that both @xmath187 and @xmath188 are wings of @xmath105 .",
    "moreover , @xmath225 are incident to two different edges @xmath296 of @xmath105 .",
    "( it is so because otherwise @xmath212 would contain an alternating cycle ( consisting of four edges ) that is not necessary . )",
    "let us notice that if @xmath105 does not have a tail , then it can not become blocked if we color @xmath187 or @xmath188 with @xmath49 .",
    "thus @xmath105 has @xmath297 external edges incident with it and is not a @xmath31-cycle .",
    "if changing the color of @xmath187 to @xmath49 causes @xmath105 to become blocked and the same for @xmath188 , then it means that after coloring @xmath187 with @xmath49 , the wings of @xmath187 become colored diffeently or the number of colors of @xmath222 occurring on the external edges incident with @xmath105 descreases .",
    "in such a situation we can change the coloring of the tail @xmath51 of @xmath105 .",
    "the tail @xmath51 is incident to some edge of @xmath105 and some edge @xmath271 belonging to another cycle @xmath298 .",
    "@xmath271 is colored with two colors @xmath274 of @xmath222 .",
    "therefore @xmath51 can be colored with the color of @xmath222 with which it is now colored or another color @xmath278 belonging to @xmath299 .",
    "let us notice that coloring @xmath51 with @xmath278 will ensure that @xmath105 is not blocked . also , after coloring @xmath51 with @xmath278 , @xmath51 is safe , because either @xmath105 has no other external edges incident with it that are colored @xmath278 or @xmath300 , which is also fine .",
    "when @xmath35 is not integral , it contains half - edges .",
    "half - edges can occur in @xmath35 only on the edges that form @xmath31-cycles of @xmath17 .",
    "moreover , if @xmath35 contains a half - edge @xmath301 of edge @xmath61 , then @xmath21 belongs to a @xmath31-cycle of @xmath17 and @xmath35 contains also a half - edge @xmath302 of @xmath303 and one of these half - edges is incident with @xmath87 and the other with @xmath88 .",
    "thus , either @xmath304 and @xmath305 , or @xmath306 and @xmath307 .",
    "we call edges @xmath1 and @xmath86 * halfy*. suppose that @xmath304",
    ". then @xmath212 contains an alternating h - cycle of the form @xmath308 .",
    "( notice that @xmath309 and @xmath310 , hence @xmath311 . ) here an edge @xmath97 ( belonging to @xmath17 ) is called an * _ antenna of @xmath61_*. if an alternating h - cycle containing @xmath312 has the form @xmath313 , then edge @xmath314 is an antenna of @xmath61 .",
    "we say that an edge of @xmath17 is an antenna of a @xmath31-cycle @xmath28 of @xmath17 , if it is an antenna of one of the edges that form @xmath28 .",
    "antennas of a @xmath31-cycle are illustrated in figure [ antenna ] .",
    "-cycle@xmath28 on vertices",
    "@xmath315 belongs to @xmath17 .",
    "@xmath316 and @xmath317 are the two antennas of @xmath28 .",
    "thick ( half-)edges belong to @xmath35 , thin ones to @xmath17 . ]",
    "we can notice that in a good coloring of @xmath39 one of the edges @xmath1 or @xmath86 will have to be colored with two colors of @xmath224 .",
    "suppose that it is edge @xmath1 that we want to color with two colors of @xmath224 .",
    "since edge @xmath318 of @xmath35 must be colored with two colors , we will have to use @xmath49 for coloring it and hence an edge of @xmath17 that goes out of @xmath319 will have to be colored with a color different from @xmath49 .",
    "in other words , if we want to color edge @xmath1 with two colors of @xmath224 , then its antenna must also be colored with a color of @xmath224 .",
    "since we have previously assumed that only marked edges from @xmath17 get colored with a color of @xmath224 , it means that if we mark one of the edges of a @xmath31-cycle of @xmath17 , then we also mark its antenna .",
    "therefore , as long as at least one of the antennas of a @xmath31-cycle @xmath70 is marked , then we can also mark an appropriate edge of @xmath28  the one whose antenna is marked .",
    "when @xmath35 is not integral , it contains at least two directed paths .",
    "each directed path of @xmath35 ends and begins with a half - edge .",
    "we extend the terminology given before as follows .",
    "we say that an edge @xmath61 of @xmath17 is * external * if @xmath21 is not halfy and @xmath87 and @xmath88 belong to two different cycles of @xmath35 or two different paths of @xmath35 or one of the vertices",
    "@xmath84 belongs to a path of @xmath35 and the other to a cycle of @xmath35 .",
    "an edge of @xmath17 which is not external and is not halfy , is called * internal*.    again we mark a certain subset of external edges .",
    "the extension of the definition of a nice set of marked edges is the following .",
    "[ nicec1 ] we say that a set of marked edges of @xmath17 is * _ nice _ * if    * for each cycle @xmath28 of @xmath35 at least @xmath233 of its edges are winged , * no edge of @xmath17 is a tail of two different cycles of @xmath35 , * for each @xmath31-cycle @xmath28 of @xmath35 , if @xmath236 has exactly one tail , then it also has a wing which is also a wing of another cycle of @xmath35 , * at least one antenna of each @xmath31-cycle is marked , * for each path @xmath320 of @xmath35 at least @xmath321 of its edges are winged ( by @xmath322 we mean the number of whole edges contained in @xmath320 ) .",
    "[ markc1 ] there exists an algorithm of marking the external edges of @xmath17 in such a way that the resulting set is nice .",
    "the running time of the algorithm is @xmath323 .",
    "we can notice the following simple fact about the possibility of a path of @xmath35 to be blocked , where we say that a path @xmath320 of @xmath35 is blocked if there is no way of completing the current coloring in such a way that we do not craete a monochromatuc cycle within @xmath320 .    if in the current coloring no edge of a path @xmath320 of @xmath35 is colored and none of its internal edges , then @xmath320 is not blocked .",
    "there exists an algorithm of coloring the marked external edges such that after its execution , each colored edge is safe , no cycle of @xmath35 is blocked and two antennas of the same @xmath31-cycle @xmath28 of @xmath35 are colored differently .",
    "this algorithm is almost the same as the one presented for the integral case .",
    "it remains to show            * there are four half - edges ( two ones are contained in the edges of a @xmath31-cycle such that one of its edges belongs to @xmath51 , the other two share a vertex belonging to the remaining third vertex of @xmath51 ) , * the two half - edges share a vertex and are both oriented as the edges of @xmath51 that contain them * the two half - edges share a vertex and are both oppositely oriented to the edges of @xmath51 that contain them * the common vertex of the edges containing the half - edges belongs to none of the half - edge and none , one or two of the edges containg these half - edges are oppositely oriented to the appropriate edges of @xmath51 , * the common vertex of the edges containing the half - edges belongs to exactly one half - edge and none , one or two of the egses containing the half - edges are oppositely oriented to the appropriate edges of @xmath51 .",
    "let us consider the case when the common vertex of the edges containing the half - edges belongs to exactly one half - edge and both of them are oppositely oriented to the edges of @xmath51 .",
    "suppose that @xmath51 consists of edges @xmath324 , the half - edges are contained in edges @xmath325 , @xmath326 are the four egdes of @xmath50 incident with vertices of @xmath51 and @xmath327 are edges of @xmath17 coincident with edges @xmath328 .",
    "the situation is depicted in figure [ trianglea ] .",
    "let us first assume that @xmath329 is the only edge of @xmath262 that is coincident with @xmath282 and incident with vertex @xmath330 .",
    "similarly let us assume that @xmath331 is the only edge of @xmath262 that is coincident with @xmath279 and incident with vertex @xmath332 .",
    "let @xmath187 be colored with colors @xmath333 and @xmath189 from @xmath264 ,",
    "let @xmath329 be colored with @xmath334 and @xmath335 with @xmath336 .",
    "let @xmath337 denote @xmath338 .",
    "* case 1 : it is not true that both @xmath187 and @xmath188 are colored with @xmath336 .",
    "* + if @xmath339 , then we color @xmath340 and @xmath341 with @xmath336 and @xmath342 with the other color from @xmath337 . otherwise we color @xmath340 and @xmath341 with @xmath28 and @xmath342 with @xmath343 .",
    "+ if @xmath344 , then we color @xmath345 with @xmath336 .",
    "otherwise we color @xmath345 with @xmath333 or @xmath189 depending on how @xmath188 is colored .",
    "if @xmath188 is colored with @xmath333 and @xmath189 , then we change its coloring so that it is colored with @xmath333 and one of the colors of @xmath222 ( or with @xmath333 and one of the colors of @xmath222 ) .",
    "+ if both @xmath282 and @xmath188 are colored with @xmath346 , then we color @xmath347 with @xmath334 , @xmath282 with @xmath28 and a color belonging to @xmath348 and change the coloring of @xmath188 so that it is colored with @xmath343 and one of the colors of @xmath222 .",
    "otherwise we color @xmath347 with the same color as @xmath345 , color @xmath282 with the appropriate two colors ( i.e. not containing @xmath334 or the color of @xmath347 ) and if @xmath188 and @xmath282 share one of the colors of @xmath337 , then we remove that color from the coloring of @xmath188 and replace it with one of the colors of @xmath222 .",
    "let us notice that all the edges @xmath349 are safe and are colored an appropriate number of times as regards graph @xmath262 .",
    "however graph @xmath39 contains three copies of triangle @xmath51 and they can not be colored with colors of @xmath222 . if , however , we manage to color one of the edges of @xmath51 with a color of @xmath264 , then the rest of the edges of the three copies of @xmath51 can be colored with colors of @xmath222 .    when we want to replace one of the colors of @xmath188 with a color of @xmath222 , then it can be done if @xmath39 does not contain four edges going into @xmath350 .",
    "@xmath39 contains four edges going into @xmath350 only if @xmath39 contains a @xmath31-cycle going through @xmath350 , a half - edge going out of @xmath350 and an edge of @xmath50 going into @xmath350 .",
    "such a situation can be avoided by swapping the edges and half - edges between @xmath35 and @xmath50 .",
    "therefore we will assume that such a situation does not arise at @xmath351 or @xmath330 .",
    "now , to be able to color the three copies of @xmath51 with colors of @xmath222 , we need to color one of the edges of @xmath51 with a color of @xmath264 and this must be done in addition to the coloring we have already conducted , i.e. one of the edges of @xmath51 should be colored with two colors of @xmath264 .",
    "we can notice that we can color additionally @xmath345 or @xmath347 with @xmath333 or @xmath189 .",
    "which one we choose depends on the following .",
    "let us assume that @xmath188 is colored with a color @xmath258 of @xmath222 . in @xmath39 each of the vertices @xmath332 and @xmath330 has three edges going out of them , meaning that both @xmath282 and @xmath352 can be colored with remaining of the colors of @xmath222 .",
    "it may happen that that remaining color of @xmath222 is the same and it is @xmath258",
    ". then we must be careful so as not to create a cycle colored @xmath258 within @xmath54 .",
    "we can notice that if @xmath279 is colored @xmath258 , then within @xmath39 @xmath347 and @xmath342 will also have to be colored with @xmath258 and if we color @xmath282 with @xmath258 , then we will have to color @xmath340 and @xmath341 with @xmath258 ( and then @xmath347 and @xmath342 are both colored with two colors of @xmath264 ) .",
    "still , one of these options does not create a cycle colored @xmath258 as it can not be the case that @xmath39 contains two paths colored @xmath258 : one beginning at @xmath350 and ending at @xmath330 and the other beginning at @xmath350 and ending at @xmath332 .    * case 2 : both @xmath187 and @xmath188 are colored with @xmath336 .",
    "* + w.l.o.g .",
    "we may assume that @xmath353 , @xmath279 is colored @xmath354 and @xmath188 is not colored with @xmath343 .",
    "we color @xmath340 with @xmath189 , @xmath341 with @xmath343 and @xmath345 and @xmath347 with @xmath333 .",
    "if @xmath188 is colored with @xmath333 , then we remove @xmath333 from its coloring and replace it with a color of @xmath222 .",
    "we color @xmath282 with two colors of @xmath355 .",
    "if both @xmath188 and @xmath282 are colored with @xmath28 , then we remove it from the coloring of @xmath188 and replace with a color of @xmath264 .",
    "additionally we will either color @xmath345 with @xmath28 or @xmath347 with @xmath343 .    if @xmath279 ( or @xmath282 ) has two edges coincident with it at @xmath332 ( corr . at @xmath330 ) , then we proceed analogously and replace one of the colors from the coloring of @xmath279 with an appropriate coloring of @xmath222",
    ". it may happen that it is not possible , because both @xmath39 and @xmath54 contains four edges going out of @xmath332 but then each color with which it is colored is safe , moreover there is a flexibility in chhosing the pair of volors with which @xmath279 can be colored .",
    "chris armen and clifford stein . improved length bounds for the shortest superstring problem . in _ proceedings of the 4th international workshop on algorithms and data structures , wads 95 , _ ,",
    "volume 955 of _ lecture notes in computer science _ , pages 494505 .",
    "springer 1995 .",
    "chris armen and clifford stein . a @xmath356-approximation algorithm for the shortest superstring problem . in",
    "proceedings of the 7th annual symposium on combinatorial pattern matching , cpm 96 _ , volume 1075 of _ lecture notes in computer science _ , pages 87101 .",
    "springer 1996 .",
    "markus blser and bodo manthey .",
    "two approximation algorithms for 3-cycle covers . in _ proceedings of the 5th international workshop on approximation algorithms for combinatorial optimization _ , volume 2462 of _ lecture notes in computer science _ , pages 4050 .",
    "springer , 2002 .",
    "haim kaplan , moshe lewenstein , nira shafrir , and maxim sviridenko .",
    "approximation algorithms for asymmetric tsp by decomposing directed regular multigraphs .",
    ", 52(4):602626 , 2005 . preliminary version appeared in focs03 .",
    "s.  rao kosaraju , james  k. park , and clifford stein .",
    "long tours and short superstrings ( preliminary version ) . in _ proceedings of the 35th annual symposium on foundations of computer science _ , pages 166177 , 1994 ."
  ],
  "abstract_text": [
    "<S> in the maximum asymmetric traveling salesman problem ( max atsp ) we are given a complete directed graph with nonnegative weights on the edges and we wish to compute a traveling salesman tour of maximum weight . </S>",
    "<S> in this paper we give a fast combinatorial @xmath0-approximation algorithm for max atsp . </S>",
    "<S> it is based on a novel use of _ half - edges _ , matchings and a new method of edge coloring . </S>",
    "<S> ( a _ half - edge _ of edge @xmath1 is informally speaking `` either a head or a tail of @xmath1 '' . ) the current best approximation algorithms for max atsp , achieving the approximation guarantee of @xmath2 , are due to kaplan , lewenstein , shafrir and sviridenko and elbassioni , paluch , van zuylen . using a recent result by mucha , which states that an @xmath3-approximation algorithm for max atsp implies a @xmath4-approximation algorithm for the shortest superstring problem ( ssp ) , we obtain also a @xmath5-approximation algorithm for ssp , beating the previously best known ( having approximation factor equal to @xmath6 . ) </S>"
  ]
}