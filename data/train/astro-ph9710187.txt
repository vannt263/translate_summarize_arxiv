{
  "article_text": [
    "in cosmology and astrophysics , the collapse of objects such as stars or galaxies from large , diffuse clouds to small , dense cores is both very important and nearly ubiquitous .",
    "simulating the gravitational instability requires resolving a very large dynamic range in three dimensions , a challenge to traditional static - grid techniques .",
    "this has lead to the adoption of lagrangean , particle - based methods such as smoothed particle hydrodynamics ( sph ) .",
    "unfortunately schemes of this type suffer from a number of drawbacks , such as poor resolution in shocks and artificially high viscosity .",
    "the structured adaptive mesh refinement ( samr ) method obviously provides a remedy to this problem and allows the application of modern , higher - order hydrodynamics schemes to astrophysics .",
    "however , before such techniques can be used for many applications in cosmology and astrophysics ( and , we suspect , a number of other disciplines as well ) , a few problems must be addressed .",
    "the original samr scheme applies mostly to hyperbolic equations typified by the equations of hydrodynamics .",
    "however , gravity is described ( in the newtonian limit ) by an elliptical equation and , for many applications , a second , collisionless , fluid is required .",
    "this component may represent stars which , to a high degree of accuracy , interact only through gravity ( in the merger of two galaxies , only a handful out of @xmath0 stars are expected to physically collide ) . or it may represent the dark matter that observations of galaxies and clusters of galaxies seem to require . one way to include this in an samr scheme would be to solve the collisionless boltzman equation .",
    "this hyperbolic set of equations follows the evolution of the fluid density in both physical space and velocity space , together known as phase space .",
    "there are two obstacles to this approach .",
    "first , for three physical dimensions , this phase space is six - dimensional , making extreme computational demands .",
    "secondly , the equation does not naturally lead to ` compact ' solutions , those in which the interesting part of the solution occupies a small volume in the computational domain .",
    "therefore , the samr approach is much less appealing for such a fluid .",
    "fortunately , there is another approach to collisionless systems .",
    "the n - body method follows trajectories of a representative sample of individual particles and has proved substantially more efficient than a direct solution of the boltzman equation in most situations .",
    "a substantial amount of effort has been devoted to refining this approach ( see @xcite for an excellent summary ) and we adopt it here .",
    "the trajectories are described by the newtonian dynamical equations , a set of ordinary differential equations , and this complicates the samr framework somewhat .",
    "the required modifications are described in the following section and first results are briefly presented in section  [ sec : results ] .",
    "here we describe first the additional data structures required by the introduction of particles and then changes to the amr method itself . we assume familiarity with the canonical berger and colella samr approach .",
    "a complete description of our implementation will be made in a future paper .",
    "the hydrodynamics portion of our method uses an adaptation of the piecewise parabolic method for cosmological flows @xcite .",
    "a particle is described by it s position @xmath1 , velocity @xmath2 , and mass @xmath3 ( other characteristics are possible but not necessary ) .",
    "there is a unique , one - to - one association between a particle @xmath4 and a grid @xmath5 if that particle s position lies within the grid s boundaries but outside of any finer ( child ) grid .",
    "we exploit this association by denoting that grid as the particle s _ home _ grid and store all such particles in a list along with the rest of the data connected to that grid .",
    "note that a particle s home grid may change is it moves , requiring redistribution of particles .",
    "this disadvantage is offset by a number of factors :    * decreased search time for particle - grid interactions , * improved data encapsulation , and * better parallelization characteristics",
    ".    the third point will be particularly true for a distributed memory version ( which we have not yet implemented ) .",
    "this association is also very natural from a physical standpoint : because the particles are indirectly connected to the solution on their home grid , they tend to share the same time step requirement ( i.e. the maximum time step allowed from accuracy and stability criteria ) .",
    "there are two types of method modifications : those related to solving the new equations and those related to changes in the grid regeneration .",
    "the first type apply mostly to a single grid and so we describe them first . unless otherwise noted , we discuss the subset of particles associated with a given ( home ) grid .",
    "the particle trajectories follow a very simple set of coupled equations : @xmath6 the term on the right - hand side of the second equation is the gravitational forcing term and it s solution can be found by the following elliptic equation : @xmath7 where @xmath8 is the density of both the collisional fluid ( grid ) and collisionless fluid ( particles ) .",
    "these equations are finite - differenced and solved with the same time step as the grid , to reduce bookkeeping .",
    "equation  [ eq : dm_position ] can be solved relatively simply as it depends only on quantities local to a particle , although some care must be taken to correctly time - center the right - hand side .",
    "the second equation is substantially more difficult as it involves the solution to an elliptic equation involving both particle and grid quantities .",
    "the most straightforward way to solve such an equation is on the mesh , so we employ the following three - step prescription :    * particles @xmath9 grid density field * compute gravitational force on the grid * grid force @xmath9 particles    in the first step , a spatially discretized density field is created out of the particle distribution .",
    "typically this involves assigning each particle s mass to the set of 9 or 27 cells nearest to its location ( depending on the desired smoothness of the resulting density field ) .",
    "a detailed description of this procedure can be found in  @xcite .    in the second step , eq .",
    "[ eq : gravity ] is solved with this density field , which also contains a contribution from the collisional fluid . here",
    "we must step back for a moment and recall that this grid , which we have been discussing in isolation , is actually part of a hierarchy of patches that , with differing resolutions , covers the entire computational domain .",
    "a number of techniques have been suggested to solve such a system ( for example , @xcite , @xcite , @xcite ) , many based on solving the higher levels first and then interpolating boundary conditions down to the lower levels .",
    "we have instead adopted a suggestion by couchman  @xcite that utilizes a set of shaped force laws , one for each level of resolution , that when added together produces the desired forces .    once the forces has been computed on the mesh",
    ", the particles associated with that grid must use those forces to update their velocities via eq .",
    "[ eq : dm_velocity ] .",
    "this third step is just the inverse of the first one and the same interpolation technique ( using the nearest 9 or 27 cells ) is employed .",
    "the new equations imply a constraint on the grid s time step since we demand that a particle not move more than some fraction of a cell width .",
    "this accuracy constraint turns out to be very similar to the courant stability criterion .",
    "a slight variation to the original berger and colella control structure is required since the number of time steps a refined grid takes to catch up to it s parent is no longer simply the refinement factor . in fact , strictly speaking , this change is required for any system of evolution equations where the stability or accuracy condition depends on the solution , which includes , in general , fluid dynamics .",
    "this completes the description of the new equations .",
    "the presence of particles also affects the grid regeneration process .",
    "since particles move , and hence change their home grid , there must be a redistribution step .",
    "we combine this with the usual samr regridding phase and assign the particles to the newly created grid hierarchy as it is created .",
    "this implies that the regeneration must occur sufficiently often that particle do not move too far out of the domain of their home grid .",
    "as one of the final accuracy tests of our combined samr - particle system , we have participated in a joint project to simulate the formation and evolution of a typical , but challenging , computational astrophysics target : a cluster of galaxies .",
    "the initial conditions , as predicted by a current cosmological theory , were provided to twelve groups utilizing different numerical techniques , ranging from sph to fixed eulerian grids .",
    "the final comparison  @xcite has yet to be completed , however we present here some results from our samr simulation .",
    "the cluster forms from a nearly homogeneous medium and collapses , under it s own gravity , to a strongly concentrated core .",
    "the resulting structure is nearly spherical , however , the collapse itself is strongly asymmetric . in figure  [ fig : amr_profiles ] , we show the radial density profile of the dark matter ( particles ) and the gas ( mesh ) around the cluster center . in order to gauge the uncertainty of this result ,",
    "we have performed a resolution study , and show the results with four sets of symbols .",
    "we changed the size of the initial mesh from 16@xmath10 up to 128@xmath10 cells .",
    "although there is some tendency for the lower resolution versions to produce cores with somewhat lower central densities , it is clear that the profiles are nearly converged",
    ". also plotted , as a dashed line , is the dark matter profile obtained by other n - body techniques , which agrees well with our results . during the evolution ,",
    "the smallest cell size used by the samr system was 1/8192 of the entire box which provides resolution comparable to the best sph codes and far better than a fixed grid could achieve .",
    "in this paper we have described one way in which a collisionless fluid can be modeled , with particles , in an samr framework , and have shown that the resulting system is very successful in modeling at least one important astrophysical system ( reaching an effective resolution of 8192 in small regions ) .",
    "we do not intend to imply that this is the only way  other variants on these procedures are possible .",
    "one possibility is that particles could be split into sub - particles as they enter a refined grid , however , it is not clear this is a substantial improvement , since the positions and velocities of the sub - particles are , in general , unknown in advance . also , since the particles do nt necessarily exit a refined region at the same time , recombining them would be problematic . and , for gravitational systems at least , the particles are naturally lagrangian and hence tend to naturally cluster where the highest resolution is required , blunting the need to refine them in the same way as the grid .",
    "collisionless fluids are a common element in computational astrophysics , and the n - body technique is the most efficient way to include them .",
    "however astrophysics is not the only problem domain in which particles have been used , with examples ranging from plasmas and vortex simulations to semiconductor devices , and molecular dynamics .",
    "although structured adaptive mesh refinement techniques may not prove useful in all these areas , it is likely that the marriage of samr and particles will prove to be more widely applicable , and so we encourage samr software and toolkit developers to build flexible and expandable systems ."
  ],
  "abstract_text": [
    "<S> we describe an application of berger and colella s  @xcite structured adaptive mesh refinement algorithm to the field of cosmological astrophysics . simulations in this area must include not just a gaseous component which follows the hyperbolic equations of compressible gas dynamics , but also a collisionless component ( such as dark matter or stars ) described by the newtonian dynamical equations . </S>",
    "<S> the two fluids interact via gravity which requires an elliptic solver . </S>",
    "<S> the challenge for amr is twofold . </S>",
    "<S> first , the collisionless material is most easily modeled by following trajectories of individual objects , a method often referred to as an n - body scheme . </S>",
    "<S> the introduction of particles poses a number of difficulties , both physical ( how do they interact accurately with the fluid in the mesh ) and algorithmic ( how to efficiently add a new data structure ) . </S>",
    "<S> the second challenge is to incorporate the gravitational interaction between the two components . </S>",
    "<S> we discuss our solutions to both of these issues and briefly present very encouraging results .    </S>",
    "<S> adaptive mesh refinement , n - body </S>"
  ]
}