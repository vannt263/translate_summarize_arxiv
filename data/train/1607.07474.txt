{
  "article_text": [
    "with the advent of high - throughput molecular biology techniques , it has recently become possible to carry out large - scale phenotypic assays in molecular systems .",
    "for example , podgornaia and laub have mapped all @xmath0 possible combinations of four key residues in the _ e. coli _ protein kinase phoq , and assayed each mutant for the signaling function mediated by its binding partner phop  @xcite .",
    "the study revealed @xmath1 functional phoq variants , which can be thought of as forming the upper plane on the fitness landscape . the upper plane is divided into several clusters under single - point mutational moves  only sequences within each cluster",
    "can mutate into each other without undergoing deleterious moves to the lower plane , where all non - functional sequences reside .",
    "this two - plane landscape is highly epistatic ",
    "the effect of a given mutation depends on the amino acids at the other three positions , in agreement with previous reports on the primary role of epistasis in molecular evolution  @xcite .",
    "the picture of fitness landscapes made of multiple interconnected planes is supported by other high - throughput experiments aimed at elucidation of the relationship between gene sequence and function  @xcite .",
    "although these experiments typically yield distributions of mutation fitness effects , the data can often be understood , at least to a first - order approximation , in terms of functional and non - functional sequence variants  @xcite . indeed , distributions of fitness effects often appear to be bi - modal in such studies , with a low - fitness peak for strongly deleterious and lethal mutations , and another for weakly deleterious and neutral ones . in comparison to deleterious and neutral mutations ,",
    "beneficial mutations are relatively infrequent  @xcite .",
    "the coarse - graining of the fitness landscape into functional and non - functional states may be refined by introducing additional fitness values , e.g. for weakly deleterious mutations .",
    "overall , given the astronomically large number of possible sequence variants , we expect the size of neutrally - connected clusters on all fitness planes to be larger than the population size",
    ". then evolutionary dynamics on a multiple - plane landscape will involve periods of neutral search followed by positive selection , in which the bulk of the population moves to a higher - fitness state  @xcite .",
    "populations evolving on such a landscape will eventually reach a steady state characterized by mutation - drift balance  @xcite .",
    "this balance determines the statistics of the population , such as the mean and the variance of the number of distinct alleles .",
    "although the population continues to explore new alleles through mutations , the allele statistics do not change anymore once the steady state is reached . in the absence of selection ( that is , for evolution on a single neutral plane )",
    ", the probability of observing a given pattern of allelic diversity in a sample of size @xmath2 taken from the steady - state population was derived by ewens  @xcite .",
    "the ewens sampling formula can be used to understand the allelic diversity in neutral populations , and test for deviations from the neutral expectation  @xcite . however , in order to make quantitative predictions of selection coefficients , it is necessary to extend the ewens sampling formula to arbitrary fitness landscapes . as noted above , of special interest in molecular evolution",
    "are landscapes in which alleles are grouped into two or three distinct fitness states .",
    "such landscapes provide a natural generalization of the completely neutral evolutionary scenario .    previous work in this area",
    "has focused mostly on deriving frequency spectra for either arbitrary fitness landscapes or specific models of selection . in particular , li obtained the frequency spectrum for a general landscape , and used it to derive expressions for the mean number of alleles in a sample , as well as the mean and the variance of the heterozygosity  @xcite .",
    "ewens and li derived frequency spectra for landscapes with two and three fitness states , and used them to compute the mean number of distinct alleles and the mean heterozygosity  @xcite .",
    "griffiths also derived a general integral expression for the frequency spectrum  @xcite .",
    "more recently , ethier and kurtz have studied allelic diversity in a general model of selection in which fitness of each new allele is completely independent of the fitness of its parent .",
    "@xcite this and follow - up work  @xcite has contributed to our understanding of how allelic sampling probabilities are shaped by various forms of selection pressure .",
    "in particular , joyce and genz have developed effective algorithms for evaluating sampling probabilities  @xcite . finally , desai et al .",
    "have investigated sampling probabilities in a model ( previously introduced by charlesworth et al .",
    "@xcite and hudson and kaplan  @xcite ) comprised of a sequence of neutral and negatively selected sites  @xcite .",
    "this model has no epistasis , and therefore can be treated using the poisson random field method  @xcite .",
    "however , the models of both ethier and kurtz and desai et al . can not be applied to molecular evolution , which is characterized by prominent epistasis and correlated fitness values .",
    "here we develop an extension of the ewens sampling formula to arbitrary fitness landscapes .",
    "first , we use the diffusion approximation of population dynamics to derive a general sampling formula valid for any number of alleles @xmath3 ( allele @xmath4 is assigned an arbitrary fitness value @xmath5 ) , mutation rate @xmath6 , and population size @xmath7 .",
    "we assume that the population adopts a steady state characterized by mutation - selection - drift balance .",
    "the sampling formula is derived under the assumption that @xmath8 , where @xmath2 is the total sample size ; this assumption is often realistic in populations subjected to high - throughput sequencing .",
    "the most general sampling formula is not amenable to efficient calculations since it involves sums over special functions with a number of terms that increases rapidly with both the sample size and the number of alleles .",
    "therefore , we focus on multiple - plane landscapes applicable in molecular evolution , with only a few ( two or more ) distinct fitness states .",
    "we also make the @xmath9 approximation , which reflects the fact that the number of possible allelic states in molecular systems is typically much larger than effective population sizes .",
    "the resulting sampling formulas are sufficiently tractable to be used to study selection signatures and deviations from neutrality on multiple - plane fitness landscapes for arbitrary mutation rates and selection coefficients . in particular , we study the effective population size approximation  @xcite and its limits of applicability . we compare our results with numerical simulations , investigating potential deviations between experiment and theory which may be caused by the differences in evolutionary dynamics between fully connected sequence networks ( for which our theory is valid ) and more realistic scenarios involving single - point mutations .",
    "we also investigate finite network size effects , since our multiple - plane sampling formula is derived in the infinite allele limit .",
    "our results are applicable to understanding the nature of allelic diversity under selection , mutation and drift , for a vast class of fitness landscapes that are relevant to both molecular evolution and , more generally , evolution in systems where the number of alleles vastly exceeds the population size .",
    "moreover , our sampling formulas form the basis for a quantitative test which can both detect the presence of selection and estimate selection coefficients in epistatic systems under very general and well - defined assumptions .",
    "population - level allele diversity data is increasingly available through high - throughput sequencing techniques , making our approach a practical and timely tool for studying the role played by selection in present - day populations .",
    "we consider a haploid population of fixed size @xmath7 . each individual in the population has a single allele in the state @xmath4 , with fitness @xmath5 ; there are @xmath3 distinct allelic states .",
    "mutations occur at a probability @xmath6 per generation , replacing the original allele with one of the @xmath10 remaining alleles .",
    "thus the probability of offspring @xmath11 produced by parent @xmath12 is @xmath13 .",
    "we can view this system as an `` allelic network '' with the topology of a complete graph , with @xmath3 vertices representing allelic states and edges representing mutational moves .",
    "stochastic evolution of the population can then be described using moran  @xcite or wright - fisher  @xcite population dynamics . without loss of generality",
    ", we can specify fitness @xmath5 of the allele @xmath14 with respect to an arbitrary reference allele @xmath15 .",
    "it is convenient to introduce a @xmath3-dimensional vector of relative fitnesses multiplied by the population size : @xmath16 .",
    "likewise , we define a @xmath3-dimensional vector of mutation rates as @xmath17 , where @xmath18 for moran  @xcite and @xmath19 for wright - fisher population dynamics  @xcite . ,",
    "@xmath20 in @xmath21 we also introduce @xmath22 , which in the limit of large number of alleles @xmath23 becomes @xmath24 and @xmath25 for moran and wright - fisher dynamics , respectively .",
    "note that we consider the case of equal mutation rates between alleles , for which the steady state is well - defined  @xcite .",
    "the evolutionary dynamics of this system in the diffusion limit is described by the forward kolmogorov equation : @xmath26 where @xmath27 is the joint probability of frequencies of @xmath3 alleles at time @xmath28 ( @xmath29 is a @xmath3-dimensional vector of allele frequencies which occupy a @xmath30-dimensional simplex @xmath31 ) , and    @xmath32 =      \\frac{\\epsilon - k\\epsilon x_i}{2n }      + \\frac 12 x_i      \\left [      \\frac{\\partial \\langle f \\rangle}{\\partial x_i }      -      \\sum_{j=1}^{k-1 } x_j \\frac{\\partial \\langle f \\rangle}{\\partial x_j }      \\right ]      +      o \\left ( \\frac{1}{n^2 } \\right ) , \\\\",
    "v_{ii } & = \\mathbb{e}[\\delta x_i^2 ] -",
    "\\mathbb{e}[\\delta x_i]^2 =      \\frac{x_i ( 1-x_i)}{n }      +      o \\left ( \\frac{1}{n^2 } \\right ) , \\\\",
    "v_{ij } & = \\mathbb{e}[\\delta x_i \\delta x_j ] - \\mathbb{e}[\\delta x_i ] \\mathbb{e}[\\delta x_j ] =      -\\frac{x_i x_j}{n }      +      o \\left ( \\frac{1}{n^2 } \\right ) , \\\\ \\end{split}\\ ] ]    where @xmath33 denotes the frequency of allele @xmath14 in the population , and @xmath34 is the mean population fitness .    in steady state @xmath35 , and the distribution of allele frequencies in eq .",
    "[ fokker - plank ] is given by  @xcite @xmath36 where @xmath37 is the normalization constant .",
    "[ watterson - distribution ] can be written more explicitly as @xmath38 where @xmath39 is the @xmath40-norm of @xmath41 , @xmath42 is the generalized beta function written in terms of gamma functions , and @xmath43 is the confluent hypergeometric function @xmath44 generalized to vector arguments .",
    "here , @xmath45 is the rising factorial , @xmath46 is the @xmath47th complete bell polynomial and @xmath48 .",
    "differentiation of this function with respect to @xmath49 yields @xmath50 where @xmath51 and @xmath52 .      when mutation rate decreases and population size is kept fixed , @xmath53 and the population becomes monomorphic  @xcite .",
    "we consider the fourier transform of the steady - state distribution in eq .",
    "[ allele - frequency - distribution ] : @xmath54 where the integral is over the @xmath30-dimensional simplex .",
    "using eq .",
    "[ gen - hyp - def ] , we can write the fourier transform as a ratio of two generalized hypergeometric functions : @xmath55    taking the @xmath53 limit yields @xmath56 thus the steady - state distribution in the monomorphic limit is given by : @xmath57 where @xmath58 is the volume of the @xmath30-dimensional simplex and @xmath59 .",
    "therefore in the @xmath53 limit the population resides in one of the @xmath3 monomorphic states available to it , with the probability of being in a particular state exponentially weighted by its fitness  @xcite .",
    "let us now consider a situation relevant to molecular evolution , where the number of alleles @xmath3 is much larger than the population size @xmath7 . in this case",
    ", the steady state in terms of allele frequencies is unlikely to be reached on relevant evolutionary time scales .",
    "mathematically , the @xmath23 limit of eq .",
    "[ allele - frequency - distribution ] becomes ill - defined  @xcite .",
    "nonetheless , the steady state is well - defined in terms of allelic _ counts _ rather than frequencies of specific alleles  @xcite . in other words ,",
    "the allelic diversity of the population ( e.g. as characterized by the mean and the variance of the distribution of the number of distinct allelic types ) is tractable and will no longer change in steady state , although new alleles will continue being explored through mutation .",
    "one is often interested in statistical properties of a sample of alleles of size @xmath8 obtained from the population .",
    "let us consider a simple example of a population evolving on a small allelic network with @xmath60 allelic types @xmath61 .",
    "suppose that in sampling @xmath62 alleles from the population we first observe allele @xmath63 , then @xmath64 , then @xmath63 again , and finally @xmath65 .",
    "we can record this sequence of alleles as an ordered list @xmath66 .",
    "however , typically we are not interested in the order in which alleles appear in the sample , and therefore record the result as an unordered list @xmath67 , which shows that allele @xmath63 has appeared twice and alleles @xmath64 and @xmath65 have appeared once each . for unordered lists and @xmath68 for ordered ones . for ordered lists @xmath69 , whereas for unordered lists @xmath70 .",
    "] alternatively , we can record non - zero allelic counts , which gives us @xmath71 .",
    "finally , we can dispense with the allele labels altogether , identifying each allele in the sample as either new or already seen . in this case , we are left with an unordered list of counts @xmath72 , meaning that we have observed @xmath73 alleles of @xmath74 different types , with one type represented by two alleles and the other two types by one each . in general , we will refer to @xmath75 as the ( unordered ) allelic counts .",
    "the allelic counts can also be summarized in terms of a histogram which records how many groups of @xmath47 identical alleles occur in the sample , with @xmath47 ranging from @xmath76 to @xmath2 . in our example",
    ", there is one group of two identical alleles and two groups of one allele each , so that @xmath66 is recorded as the allelic histogram @xmath77 . for allelic histograms .",
    "]    we now derive the probability @xmath78 $ ] of observing an unordered sample @xmath75 , given that the population has reached steady state in terms of its allelic diversity . before treating the general case ,",
    "we illustrate our approach using a toy example with @xmath79 allelic types : @xmath80 .",
    "we wish to calculate the probability of observing the @xmath81 unordered configuration in a sample of size @xmath82 , which is assumed to be much less than the population size @xmath7 .",
    "there are @xmath83 ordered configurations that contribute to this probability :    c c c",
    "@xmath84&@xmath85&@xmath86 + @xmath87&@xmath88&@xmath89 + @xmath90&@xmath91&@xmath92 +   + @xmath93&@xmath94&@xmath95 + @xmath96&@xmath97&@xmath98 + @xmath99&@xmath100&@xmath101    in particular , the probability of choosing @xmath63 first , then @xmath63 again and finally @xmath102 is @xmath103 & = \\int x_a^2 x_b^1 \\ ; p(x_a , x_b , x_c ) \\ ;",
    "dx_a dx_b dx_c \\\\      & = \\int x_a^2 x_b^1 \\ ; p(x_a , x_b ) \\ ; dx_a dx_b ,    \\end{split}\\ ] ] where @xmath104 is given by eq .  [ allele - frequency - distribution ] . consequently , the probability of observing two @xmath63 s and one @xmath102 in _ any _ order is given by  @xcite @xmath105 = \\binom{3}{2 \\ ; 1 } \\int x_a^2 x_b^1 \\ ; p(x_a , x_b ) \\ ; dx_a dx_b,\\ ] ] where @xmath106 is the multinomial coefficient . introducing a set @xmath107 , which permutes allelic identities in an ordered manner ( i.e.",
    ", the overall allele ordering from @xmath63 to @xmath102 to @xmath64 is preserved in each pair of alleles ) , we can take into account the first @xmath108 configurations in the table above : @xmath109 + \\mathbb p[\\{a , a , c\\ } ] + \\mathbb p[\\{b , b , c\\ } ] =       \\binom{3}{2 \\ ; 1 }      \\sum_{\\sigma \\in s_2\\mathcal a}\\int x_{\\sigma_1}^2 x_{\\sigma_2}^1 \\ ;",
    "p(x_{\\sigma_1 } , x_{\\sigma_2 } ) \\ ; dx_{\\sigma_1 } dx_{\\sigma_2}.\\ ] ] in order to include the last @xmath108 configurations in the table , we need to switch the order of the alleles : @xmath110 . but",
    "switching the alleles in each pair amounts to replacing @xmath111 with @xmath112 in eq .",
    "[ half : prob ] . thus we can summarize the entire table by introducing a set @xmath113 of all distinct permutations of allelic counts @xmath114 , which determine the powers to which the allelic frequencies are raised in eq .",
    "[ half : prob ] . in our example",
    "@xmath115 and @xmath116 .",
    "therefore , @xmath117 & = &      \\binom{3}{2 \\ ; 1 }      \\sum_{\\nu \\in p\\mathcal",
    "n }      \\sum_{\\sigma \\in s_2\\mathcal a}\\int x_{\\sigma_1}^{\\nu_1 } x_{\\sigma_2}^{\\nu_2 } \\ ;      p(x_{\\sigma_1 } , x_{\\sigma_2 } ) \\ ; dx_{\\sigma_1 } dx_{\\sigma_2 } \\\\        & = & \\binom{3}{2 \\ ; 1 }      \\sum_{\\nu\\in p\\mathcal n }      \\sum_{\\sigma\\in s_2 \\mathcal a }      \\mathbb{e}\\left [ \\prod_{i=1}^2 x_{\\sigma_i}^{\\nu_i } \\right].\\end{aligned}\\ ] ] the above example can be easily generalized to describe the probability @xmath118 $ ] of observing an unordered list of counts , @xmath75 .",
    "note that the sample size is @xmath51 , and that @xmath119 distinct allelic types are observed .",
    "first , we enumerate all @xmath3 alleles , forming a unique ordered list @xmath120 .",
    "second , we choose a subset @xmath121 of size @xmath119 from @xmath122 without replacement , so that the allelic order is preserved : @xmath123 ( note that no subsets are allowed to contain repeating elements of @xmath122 ) .",
    "then @xmath124 can be naturally defined as a set which contains all ordered subsets of @xmath122 of size @xmath119 . finally , as before @xmath125 is a set of all distinct permutations of allelic counts @xmath126 .",
    "with these definitions , @xmath127 =       \\binom{n}{n_1 \\ ; ... \\ ; n_k }      \\sum_{\\nu\\in p\\mathcal n }      \\sum_{\\sigma\\in s_k \\mathcal a }      \\mathbb{e}\\left [ \\prod_{i=1}^k x_{\\sigma_i}^{\\nu_i } \\right],\\ ] ] where @xmath128 is the multinomial coefficient , and the expectation is calculated with respect to the steady - state allele distribution , eq .",
    "[ allele - frequency - distribution ] .",
    "we can use the probability distribution over unordered configurations ( eq .",
    "[ pn ] ) to compute the distribution of the number of different allelic types @xmath119 : @xmath129      =      \\sum_{\\substack{n_1 \\ge ... \\ge n_k \\\\ n_1+ ... +n_k = n } }      \\mathbb p[\\{n_1 , ... , n_k\\}],\\ ] ] where the summation runs over all ordered partitions of @xmath2 into @xmath119 positive integers .      as eq .",
    "[ pn ] demonstrates , evaluation of sample probabilities requires calculation of moments of allele frequency distributions .",
    "this is most easily accomplished by taking derivatives of the normalization constant @xmath130 with respect to the components of @xmath131 : @xmath132      =      \\frac 1z      \\prod_{i=1}^k      \\left ( \\frac{\\partial}{\\partial \\beta_i } \\right)^{\\nu_i }      z.\\ ] ] using eq .",
    "[ calf : deriv ] , we obtain : @xmath133 =          \\binom{n}{n_1 \\ ; ... \\ ; n_k }      \\frac{\\prod_{i=1}^k \\epsilon^{(n_i)}}{(k\\epsilon)^{(n ) } }      \\sum_{\\nu\\in p\\mathcal n }      \\sum_{\\sigma\\in s_k \\mathcal a }      \\frac{\\mathcal f(\\vec\\epsilon + \\vec \\nu_\\sigma ; k\\epsilon + n ; \\vec\\beta ) }      { \\mathcal f(\\vec\\epsilon ; k\\epsilon ; \\vec\\beta ) } , \\end{split}\\ ] ] where equal mutation rates are assumed for all alleles and @xmath134 is a @xmath3-dimensional vector whose @xmath135-th components are @xmath136 ( @xmath137 ) and all the other components are zero .",
    "as discussed above , the sum over @xmath138 extends over all distinct subsets of @xmath119 alleles sampled from @xmath3 uniquely ordered alleles and subject to the @xmath123 constraint .",
    "therefore @xmath134 has @xmath139 zero and @xmath119 non - zero components which are distributed according to @xmath138 .",
    "the sum over @xmath140 extends over all distinct permutations of allelic counts which sum up to @xmath2 .",
    "[ sampling - prob ] is valid for arbitrary fitness landscapes and arbitrary @xmath3 .      when all alleles have the same fitness , the general sampling formula given by eq .",
    "[ sampling - prob ] should reduce to the ewens formula for neutral evolutionary dynamics  @xcite .",
    "indeed , with all @xmath141 set to zero , the generalized hypergeometric function @xmath142 ( eq .  [ gen - hyp - def ] ) becomes @xmath76 .",
    "then for the finite number of alleles @xmath3    @xmath143 =    n_p    \\frac{n!}{(k\\epsilon)^{(n ) } }    \\binom{k}{k }    \\prod_{i=1}^k \\frac{\\epsilon^{(n_i)}}{n_i!},\\ ] ]    where @xmath144 is the total number of distinct permutations of allelic counts @xmath145 . in the limit of an infinite number of alleles @xmath146 , eq .",
    "[ sampling - prob - neutral - finite - k ] becomes @xmath147    =    n_p    \\frac{1}{k ! }    \\frac{n!}{\\prod_{i=1}^k n_i }    \\frac{\\theta^k}{\\theta^{(n)}}.\\ ] ] changing variables to allelic histogram counts yields @xmath148 and @xmath149 , resulting in @xmath150    =    \\frac{n!}{\\prod_{j=1}^n a_j ! j^{a_j } }    \\frac{\\theta^k}{\\theta^{(n)}}.\\ ] ] eq .",
    "[ sampling - prob - neutral - hist ] is known as the ewens sampling formula @xcite .      as a straightforward generalization of the neutral case ,",
    "consider a system with @xmath151 alleles of fitness @xmath152 and @xmath153 alleles with fitness @xmath154 .",
    "thus the fitness landscape consists of two interconnected `` planes '' .",
    "we can assume without loss of generality that alleles @xmath155 belong to the first plane and alleles @xmath156 belong to the second plane .",
    "then @xmath157 defines a fraction of nodes on the first plane , and the fitness vector is @xmath158 with @xmath151 non - zero entries followed by @xmath153 zeros .",
    "then it can be shown that for finite @xmath3 the sampling probability is given by ( appendix  [ appendix : sampling - two - planes ] ) :    @xmath159   =   \\frac{n!}{\\prod_{i=1}^k n_i ! }   \\frac{\\prod_{i=1}^k \\epsilon^{(n_i)}}{(k\\epsilon)^{(n ) } }   \\binom{k}{k } \\times   \\\\   &   \\sum_{\\nu\\in p\\mathcal n }   \\sum_{i=0}^k   \\frac{\\f11 \\left ( \\gamma\\theta+\\sum_{m=1}^i \\nu_m ; \\theta+n ; \\beta \\right ) }   { \\f11\\left(\\gamma \\theta ; \\theta ; \\beta \\right ) }   \\frac{\\binom{i}{i } \\binom{k - i}{k - i}}{\\binom{k}{k}}. \\end{split}\\ ] ]    taking the infinite allele ( @xmath23 ) limit with @xmath160 fixed , we arrive at @xmath161   =   \\frac{n!}{k ! }   \\frac{1}{\\prod_{i=1}^k n_i }   \\frac{\\theta^k}{\\theta^{(n ) } } \\times   \\\\   &   \\sum_{\\nu\\in p\\mathcal n }   \\sum_{i=0}^k   \\frac{\\f11 \\left ( \\gamma\\theta+\\sum_{m=1}^i \\nu_m ; \\theta+n ; \\beta \\right ) }   { \\f11\\left(\\gamma \\theta ; \\theta ; \\beta \\right ) }   \\binom{k}{i }   \\gamma^i ( 1-\\gamma)^{k - i}. \\end{split}\\ ] ] thus hypergeometric sampling of eq .",
    "[ sampling - prob-2-planes - finite - k ] reduces to binomial sampling in the infinite allele limit .",
    "let us now generalize the result of the previous section to the case of multiple fitness states : each allele can be assigned a distinct fitness value @xmath162 , @xmath163 .",
    "in other words , the fitness landscape consists of multiple planes , with @xmath164 nodes of fitness @xmath162 on the @xmath165th plane , so that @xmath166",
    ". then the sampling probability for finite @xmath3 is given by @xmath167    =    \\frac{n!}{\\prod_{i=1}^k n_i ! }    \\frac{\\prod_{i=1}^k \\epsilon^{(n_i)}}{(k\\epsilon)^{(n ) } }    \\binom{k}{k } \\times \\\\    &    \\sum_{\\nu\\in p\\mathcal n }    \\sum_{y\\in \\mathcal y(\\vec i , \\mathcal n ) }    \\frac{\\mathcal f(\\vec\\gamma \\theta + \\vec \\nu^y;\\theta+n ; \\vec\\beta ) }    { \\mathcal f ( \\vec\\gamma \\theta ; \\theta ; \\vec\\beta ) }    \\frac{\\binom{i_1}{i_1 } ... \\binom{i_m}{i_m}}{\\binom{k}{k } } , \\end{split}\\ ] ] and its infinite allele limit is given by @xmath168    =    \\frac{n!}{k ! }    \\frac{1}{\\prod_{i=1}^k n_i }    \\frac{\\theta^k}{\\theta^{(n ) } } \\times \\\\    &    \\sum_{\\nu\\in p\\mathcal n }    \\sum_{y\\in \\mathcal y(\\mathcal n ) }    \\frac{\\mathcal f(\\vec\\gamma \\theta + \\vec \\nu^y;\\theta+n ; \\vec\\beta ) }    { \\mathcal f ( \\vec\\gamma \\theta ; \\theta ; \\vec\\beta ) }    \\binom{k}{i_1 ... i_m }    \\gamma_1^{i_1 } ...",
    "\\gamma_m^{i_m}. \\end{split}\\ ] ] the sums in eqs .",
    "[ sampling - prob - mult - planes - finite - k ] and [ sampling - prob - mult - planes ] take into account all possible ways of sampling @xmath2 alleles from @xmath169 planes ( fig .",
    "[ fig : partitions ] ) . to explain these sums ,",
    "let us imagine distributing @xmath2 books over @xmath169 shelves .",
    "the books come in @xmath119 indivisible volume sets , and the @xmath4th set has @xmath136 identical books in it .",
    "we would like to find all book - to - shelf arrangements , keeping in mind that shelves have finite capacities : only @xmath170 books can be placed on the @xmath165th shelf .",
    "one way to describe any book - to - shelf arrangement is to use an @xmath169-dimensional vector @xmath171 which records how many books are placed on each shelf . for example , if @xmath172 , a vector @xmath173 with @xmath174 zeros following @xmath119 non - zero entries describes placing volume sets on shelves in a particular order : the first volume set goes on the first shelf , the second volume on the second shelf and so on ( assuming that the shelves are large enough to accommodate the volume sets ) , until no more books are left , so that the remaining @xmath174 shelves remain empty .",
    "permutations of this arrangement , expressed as permutations of @xmath171 vector elements , are also allowed ( again , assuming that all the shelves are large enough ) .",
    "we can also put more than one volume set on a single shelf , leading to arrangements such as @xmath175 with @xmath176 zero and @xmath177 non - zero entries .",
    "as before , this arrangement is allowed only if the number of books on each shelf does not exceed shelf capacities .",
    "note that the question of capacity does not arise in the infinite allele limit , since the shelves become effectively infinitely long .    in order to systematically list all the arrangements for volume sets",
    "@xmath178 , we follow a simple rule : if the @xmath119th set of @xmath179 books is placed on the @xmath165th shelf , the @xmath180th set of @xmath181 books goes either on the same shelf or on the @xmath182th shelf with @xmath183 .",
    "taking elements of @xmath178 one by one and changing the initial shelf ( onto which the 1st volume set is placed ) and the number of volume sets on each shelf , we can generate a set of all permutations of @xmath184 elements .",
    "we shall call this set @xmath185 since it depends on both the shelf capacities @xmath186 and the volume sets @xmath114 . in the limit of infinite shelf capacity",
    "the dependence on shelf sizes disappears , and the set of all permutations will be called @xmath187 . to include all possible arrangements",
    ", we need to perform the book - placing procedure for each distinct permutation of @xmath126 .",
    "now , if we replace shelves with fitness planes and volume sets with allelic counts , we obtain an algorithm for generating all allowed placements of allelic counts on fitness planes .",
    "the non - negative indices @xmath188 in eqs .",
    "[ sampling - prob - mult - planes - finite - k ] and [ sampling - prob - mult - planes ] represent the number of volume sets ( allelic counts ) on each shelf ( fitness plane ) . the distribution of alleles among fitness planes of finite capacity is illustrated in fig .  [ fig : partitions]a for @xmath189 and a vector of allelic counts @xmath190 ; the infinite - plane case is shown in fig .  [ fig : partitions]b .     and @xmath187 in eqs .",
    "[ sampling - prob - mult - planes - finite - k ] and [ sampling - prob - mult - planes ] respectively , for a list of allelic counts @xmath191 .",
    "( a ) the finite plane case .",
    "finite plane capacities are shown in parentheses .",
    "( b ) the infinite plane case . ]    next , let us consider the monomorphic limit of eq .",
    "[ sampling - prob - mult - planes ] : @xmath192 with finite @xmath193 and @xmath160 .",
    "it can be shown that @xmath194 { }    \\sum_{m=1}^m \\gamma_m e^{\\beta_m},\\ ] ] leading to @xmath195 & = 1 + o(\\theta ) , \\\\",
    "\\mathbb p[\\{n_1 , ... , n_k\\ } ] & = o(\\theta^{k-1 } ) .",
    "\\end{split}\\ ] ] therefore , as expected , the @xmath196 $ ] ( @xmath197 ) term predominates in the monomorphic limit .    by construction ,",
    "[ sampling - prob-2-planes ] and [ sampling - prob - mult - planes ] reduce to the neutral limit ( eq .  [ sampling - prob - neutral ] ) when all fitness values are the same .",
    "in addition , the neutral limit is reproduced in the strongly polymorphic , mutation - dominated limit , defined as @xmath198 with finite @xmath193 and @xmath160 . in this limit ,",
    "@xmath199 and eq .  [ sampling - prob - mult - planes ] reduces to the neutral result .",
    "this is expected since selection effects become vanishingly small in this regime .",
    "the frequency spectrum @xmath200 is a standard way of characterizing allele frequency distributions in evolving populations  @xcite ; @xmath201 is defined as the number of alleles in the population with frequency in the @xmath202 range .",
    "therefore , according to eq .",
    "[ allele - frequency - distribution ] the steady - state frequency spectrum is given by @xmath203 where @xmath204 is the marginalized allele frequency distribution for the @xmath4th allele .",
    "note that according to eq .",
    "[ phi : def ] @xmath200 is normalized as follows : @xmath205 correspondingly , @xmath206 is the probability that an allele randomly drawn from the population has its frequency in the population in the @xmath202 range .",
    "the frequency spectrum can be used to find @xmath207 $ ] , the mean number of distinct alleles in a sample of size @xmath2 : @xmath208 = \\int_0 ^ 1 \\left(1-(1-x)^n\\right ) \\phi(x ) dx.\\ ] ]    for a landscape with @xmath169 distinct fitness values , the frequency spectrum is given by ( appendix  [ appendix : frequency - spectrum ] ) @xmath209 where the @xmath30-dimensional vectors @xmath210 and @xmath211 are obtained from @xmath3-dimensional vectors @xmath131 and @xmath41 by removing their @xmath4th components .",
    "the formula above is valid for arbitrary number of alleles @xmath3 , mutation rate , and population size . using eq .",
    "[ frequency - spectrum - general ] , the expected number of distinct alleles in a sample of size @xmath2 can be computed as @xmath212    = &    k-    \\frac{1}{\\mathcal f(\\vec\\epsilon ; k\\epsilon ; \\vec\\beta ) }    \\sum_{i=1}^k    \\sum_{j=0}^\\infty    \\frac{1}{(k\\epsilon)^{(j+n ) } }    \\\\    & \\times    \\sum_{j_1+ ... +j_k = j }    \\frac{\\beta_1^{j_1 } ... \\beta_k^{j_k}}{j_1 ! ... j_k ! }",
    "\\epsilon^{(j_1 ) } ...",
    "\\epsilon^{(j_k ) } ( ( k-1)\\epsilon+j - j_i)^{(n)}. \\end{split}\\ ] ] in the @xmath23 limit ( and assuming that all @xmath169 fitness planes also become infinite in this limit ) , eq .",
    "[ frequency - spectrum - general ] simplifies to @xmath213 furthermore , in the case of two fitness states ( @xmath214 ) we can simplify eq .",
    "[ freq - spectrum ] using eq .",
    "[ mathcalf = f11 ]  @xcite : @xmath215 for neutral evolution , we set all @xmath141 to @xmath216 ; eq .",
    "[ freq - spectrum ] then yields @xmath217 which looks like two - allele steady - state allele frequency distribution . in the strongly monomorphic limit and",
    "the absence of selection , the steady - state distribution ( eq .  [ allele - frequency - distribution ] ) simplifies to ( eq .",
    "[ strongly - monomorphic - limit ] ) : @xmath218.\\ ] ] since @xmath219 , we obtain @xmath220\\ ] ] in the monomorphic limit of neutral evolution .    using eq .",
    "[ mean - number - of - alleles - via - freq - spectrum ] , we can obtain a standard expression for the mean number of alleles observed in neutral evolution  @xcite : @xmath221 = \\theta",
    "\\left(\\psi(\\theta+n)-\\psi(\\theta)\\right )    = \\theta \\sum_{i=0}^{n-1 } \\frac{1}{i+\\theta},\\ ] ] where @xmath222 is the digamma function .",
    "note that @xmath207 \\to 1 $ ] in the monomorphic limit ( @xmath192 ) and @xmath207 \\to n$ ] in the strongly polymorphic limit ( @xmath198 ) .    finally , we observe that eq .  [",
    "ek : neutral ] can also be derived by setting all @xmath223 in eq .",
    "[ e - r ] : @xmath224    & =    k-    \\sum_{i=1}^k    \\frac{\\gamma(k\\epsilon)}{\\gamma((k-1)\\epsilon ) ) }    \\frac{\\gamma((k-1)\\epsilon+n))}{\\gamma(k\\epsilon + n ) }    \\\\    & \\xrightarrow[k \\to\\infty ] { }    k - k \\frac{1-\\psi(k\\epsilon)\\epsilon+ o(\\epsilon^2 ) }    { 1-\\psi(k\\epsilon+n)\\epsilon + o(\\epsilon^2 ) }    \\\\    & =    \\theta ( \\psi(\\theta+n)-\\psi(\\theta ) ) . \\end{split}\\ ] ]    in the monomorphic limit ( @xmath192 ) , eq .",
    "[ freq - spectrum ] becomes @xmath225 in this limit , @xmath226 is non - zero only if @xmath227 , where @xmath228 .",
    "note that selection effects disappear : the entire population is in the same allelic state due to genetic drift , performing a random walk on the uppermost fitness plane .    in the strongly polymorphic , mutation - dominated limit ( @xmath198 ) , eq .",
    "[ freq - spectrum ] simplifies to @xmath229 in this case , @xmath230 is peaked around @xmath231 , with @xmath232 .",
    "the population is completely delocalized , with each member of the population in a distinct allelic state and negligible selection effects .",
    "this is not surprising since mutation dominates both selection and genetic drift in this limit .",
    "we have carried out validation of our theoretical predictions against numerical simulations .",
    "we have used the moran model of population genetics  @xcite to evolve a population of @xmath233 haploid organisms , each of which could be in one of @xmath3 allelic states .",
    "specifically , at each step a parent is chosen by randomly sampling the population with weights proportional to the fitness of each individual .",
    "an offspring is then produced as an exact copy of the parent .",
    "next , the offspring undergoes mutation with the probability @xmath6 .",
    "finally , the population is uniformly sampled to choose an organism that will be replaced by the offspring , keeping the overall population size constant .",
    "probabilities of sampling @xmath2 individuals from the population were calculated as averages over @xmath234 samples gathered from @xmath235 independent runs . for each run ,",
    "a randomly generated initial population was evolved to steady state , after which @xmath2 individuals were sampled from the population with replacement @xmath235 times , waiting @xmath236 generations between samples .",
    "we consider two types of models with different mutational moves . in the first model , each allele",
    "is allowed to mutate into any of the other @xmath10 alleles with equal probabilities .",
    "we call this model fully - connected ( fc ) ; it corresponds to our theory which was developed for fc networks . in the second model , a more realistic move set of single - point mutations",
    "is implemented : each organism s genome is represented by a sequence of integers @xmath237 of length @xmath238 , where @xmath239 .",
    "a mutation replaces an integer at a randomly chosen site with one of the remaining @xmath240 integers ; all the replacements have equal probabilities .",
    "we call this model a single - point mutation ( spm ) model .    finally , we assign a fitness value to each allele .",
    "we focus on the landscapes in which alleles can have either low or high fitness values ( the `` two - plane '' model ) , or low , intermediate , and high fitness values ( the `` three - plane '' model ) . the fractions of alleles found in each plane are given by @xmath241 : @xmath242 for the two - plane model and @xmath243 for the three - plane model . in the fc model",
    ", the mutational neighborhood of each allele is the same , so that any desired allele fractions @xmath241 can be implemented .",
    "however , in the spm model the fractions of neutral , beneficial and deleterious moves in each plane will depend on @xmath241 and the assignment of states to planes .",
    "we wished to produce non - trivial distributions of neutral moves on the fitness planes , with mutational neighborhoods of some alleles being completely neutral in each plane .",
    "another condition was that the number of alleles in each plane should decrease with its fitness , to reflect the fact that higher - fitness solutions are harder to find .    to fulfill these requirements , we chose to assign fitness values in the spm model in the following way .",
    "we use the sequence length @xmath244 and the alphabet size @xmath245 . for each sequence",
    "@xmath237 we compute a score @xmath246 .",
    "we compare these scores with a set of cutoffs @xmath247 for the @xmath169-plane landscape .",
    "for the two - plane landscape , the fitness is @xmath76 if @xmath248 , and @xmath249 otherwise .",
    "we use the cutoff @xmath250 , which yields @xmath251 .",
    "for the three - plane landscape , if @xmath248 the fitness is @xmath76 , if @xmath252 the fitness is @xmath253 , and if @xmath254 the fitness is @xmath255 .",
    "we choose the cutoffs @xmath250 and @xmath256 , which lead to @xmath257 . in order to compare fc and spm simulations directly",
    ", we use the same values of @xmath241 in the corresponding fc models .    note that in the neutral case the exact mapping between @xmath258 and @xmath6 is given by @xmath259 for the moran model .",
    "@xcite however , it is unclear if this mapping can be extended to the non - neutral cases considered here . in any event , for the population size and the values of @xmath258 investigated below , @xmath260 .",
    "therefore , we use the diffusion theory result @xmath261 in comparing theoretical predictions with numerical simulations .      in the monomorphic limit , we expect the effective population size ( eps ) approximation to hold  @xcite : population dynamics is neutral but with the rescaled population size @xmath262 . indeed , in the two - plane case eq .",
    "[ sampling - prob-2-planes ] reduces to    @xmath263 \\xrightarrow[\\theta\\to0 ] { } \\frac{n_p}{k ! }",
    "\\frac{n!}{\\prod_{i=1}^k n_i }   \\theta^{k-1 } ( 1-\\gamma)^{k-1}\\ ] ]    in the @xmath192 limit , which corresponds to the @xmath264 regime when @xmath193 is finite ; eq .  [ sampling - prob - neutral : neff ] is the same as the neutral sampling formula ( eq .  [ sampling - prob - neutral ] ) in the monomorphic limit if the population size is rescaled : @xmath265 .",
    "this result can be generalized to the landscape with multiple fitness planes , in which case @xmath266 where @xmath267 is a fraction of nodes with the highest fitness .    however , the eps approximation breaks down in the polymorphic regime .",
    "indeed , if we take the @xmath268 limit , which keeps @xmath269 finite ( i.e. , the ratio of selection and mutation forces remains finite as population size increases ) , it can be shown for the two - plane landscape that @xmath270 }      { \\mathbb{p}[\\{n_1 , ... , n_k\\}|\\beta=0 ] }      =      \\sum_{m=0}^\\infty c_m \\left ( \\frac{s}{\\mu } \\right)^m \\equiv s\\ ] ] where @xmath271 $ ] is given by eq .",
    "[ sampling - prob - neutral ] , and coefficients @xmath272 depend solely on @xmath273 . since the right - hand side of eq .",
    "[ strongly : polymorphic : sample ] does not depend on the population size , it can be used to define @xmath274 . however",
    ", this definition will be sample - specific , due to dependence of @xmath275 on @xmath273 .",
    "thus there is no global rescaling of the population size in the strongly polymorphic regime , and evolutionary dynamics is non - neutral  @xcite .",
    "alleles ( @xmath276 , @xmath81 @xmath277 ) sampled from the population of size @xmath233 . (",
    "a ) and ( b ) kl divergences for the two - plane fitness landscape as a function of the mutation rate @xmath278 and the selection coefficient @xmath279 scaled by the population size , for partition probabilities with and without selection ( a ) , and partition probabilities with selection compared with the eps approximation ( eq .  [ sampling - prob - neutral : neff ] ) ( b ) .",
    "( c ) kl divergences for the sampling probabilities of all possible partitions on a three - plane vs. two - plane landscape .",
    "alleles in the three planes have fitnesses @xmath76 , @xmath280 and @xmath280 respectively , with @xmath281 for both two and three - plane landscapes . ]      ) and ( b ) the population fraction on the lower plane ( eq .  [ fraction.lower.plane:two-plane ] ) for the two - plane fitness landscape , as a function of the mutation rate ( @xmath278 ) and the selection strength ( @xmath279 ) rescaled by the population size . ]",
    "as discussed above , in general we expect allele diversity to deviate from neutrality , making it possible to detect selection signatures using sequences sampled from a population as input . to investigate non - neutral population dynamics , we compute probabilities for all partitions @xmath75 of @xmath2 alleles sampled from the population evolving under selection , and compare them with steady - state partition probabilities obtained under neutral evolution and the eps approximation .",
    "we use the kullback - leibler ( kl ) divergence to quantify the difference between two probability distributions  @xcite : @xmath282    for the two - plane system , we first compare partition probabilities under selection , @xmath283 $ ] , with the corresponding neutral probabilities , @xmath284 $ ] . here , @xmath4 labels distinct partitions . in fig .",
    "[ fig : dev-2 - 3-planes]a , we plot the kl divergence as a function of the mutation rate and the selection strength for the two - plane fitness landscape .",
    "we observe that evolutionary dynamics is essentially neutral if selection is weak ( @xmath285 ) ; in addition , the range of selection coefficients for which neutrality holds increases in the monomorphic regime ( @xmath286 ) . on the other hand ,",
    "population statistics is clearly non - neutral when the population is polymorphic and the separation between the two fitness planes is large .",
    "next , we compute the kl divergence @xmath287 between the eps probability distribution , @xmath288 $ ] , where @xmath289 , and @xmath290 ( fig .  [",
    "fig : dev-2 - 3-planes]b ) .",
    "we see that the eps approximation fails in the polymorphic , weak - selection regime .",
    "overall , the neutral and eps approximations are approximately complementary  for example , in the strong - selection ( @xmath264 ) , polymorphic regime , when evolutionary dynamics becomes non - neutral , it is well approximated by the eps model .    in fig .  [",
    "fig : dev-2 - 3-planes]c we show kl divergences between partition probability distributions on two- and three - plane fitness landscapes . we observe that the partition probabilities are essentially two - plane ( i.e. , there are no selection signatures indicating presence of intermediate - fitness alleles ) if the population is monomorphic ( @xmath286 ) , or if the distance between the two upper planes is smaller than the mutation rate ( @xmath291 ) .",
    "however , there is a considerable parameter region in which deviations between two and three - plane sampling probabilities appear to be significant ( with kl divergences between the two distributions of 0.01 or more ) , making it possible to detect three distinct fitness states in the sampling data .      by definition , the mutation load is given by  @xcite @xmath292 where @xmath293 is the maximum fitness , and",
    "@xmath294 is the mean population fitness . to estimate the mutation load at steady state , we compute the expected value of the mean population fitness over multiple realizations of the stochastic process : @xmath295 = \\sum_{i=1}^k \\mathbb{e}[x_i ] f_i      =      f_k+\\frac{1}{n}\\sum_{i=1}^{k-1 } \\mathbb{e}[x_i]\\beta_i      =      f_k+\\frac{1}{n}\\sum_{i=1}^{k-1 } \\frac{\\partial \\log z}{\\partial \\log \\beta_i},\\ ] ] where @xmath130 is the normalization in the steady - state allele frequency distribution ( eq .  [ allele - frequency - distribution ] ) .",
    "choosing @xmath296 to be the maximum fitness , we obtain the following expression for the mutation load : @xmath297\\beta_i      =      -\\frac{1}{n f_k } \\sum_{i=1}^{k-1 } \\frac{\\partial \\log z}{\\partial \\log \\beta_i}.      \\label{l : general}\\ ] ]    for the two - plane system , eq .  [ l : general ] yields ( appendix  [ appendix : sampling - two - planes ] ) : @xmath298 note that in the two - plane system @xmath299 = \\frac{1 + s}{s } l ,      \\label{fraction.lower.plane : two - plane}\\ ] ] where @xmath300 $ ] is the average fraction of the population on the lower plane .",
    ": @xmath276 , @xmath81 , @xmath277 .",
    "bars : theoretical predictions in the infinite allele limit .",
    "black circles : numerical simulations on the fc sequence network .",
    "grey circles : numerical simulations on the spm sequence network . in all simulations , alphabet size @xmath301 , sequence length @xmath302 , and population size @xmath233 were used .",
    "partition probabilities were estimated from @xmath234 samples as described in the main text .",
    "( a ) monomorphic population , @xmath303 .",
    "( b ) weakly polymorphic population , @xmath304 .",
    "( c ) strongly polymorphic population , @xmath305 .",
    "note that the corresponding kl divergences are listed in table  [ table : kl ] . ]",
    "mutation loads for the two - plane fitness landscape are shown in fig .",
    "[ fig : mutload]a over a range of selection strengths and mutation rates . as expected , we observe that the largest deviations from the maximum fitness occur in the strong - mutation , strong - selection regime , where a fraction of the population is constantly displaced to the lower plane by mutation , incurring a fitness cost",
    ". correspondingly , at a given value of selection strength the mutation load increases with the mutation rate . in the monomorphic regime",
    "the mutation load is vanishingly low because the entire population condenses to a single allelic state and moves randomly on the upper plane .",
    "the fraction of the population on the lower fitness plane is shown in fig .",
    "[ fig : mutload]b .",
    "the fraction is high when the separation between the two planes is low and , at a fixed separation , it increases with the mutation rate .    , unless indicated otherwise ; kl divergences are listed in table  [ table : kl ] . ]",
    "our theoretical results have been developed for fully - connected networks in which an allele can mutate into any other allele .",
    "however , this model is not realistic for protein or nucleotide sequences , in which mutational neighborhoods of a given sequence consist of single - point mutants , i.e. sequences that differ from each other at only a single site .",
    "here we investigate how partition probabilities change if we switch from the fc to the spm allele network described above . in fig .",
    "[ fig : two - infinite - planes ] , we compare theoretical predictions with numerical simulations on the fc and spm networks in the two - plane system .",
    "overall , we observe excellent agreement between theory and simulations on fc networks .",
    "furthermore , we see that the agreement between spm simulations and our theoretical results is reasonable : in nearly all cases , the predicted ranking of the sample partitions , as well as the ranking within any given sample partition with respect to @xmath279 , are preserved .",
    "the largest discrepancies occur in the weakly polymorphic ( @xmath306 ) , strong - selection regime ( @xmath307 ) .",
    "the situation is qualitatively similar when a three - plane fitness landscape is considered ( fig .",
    "[ fig : multiple - planes ] ) .",
    "we again observe excellent agreement between theory and fc simulations and , overall , reasonable agreement between theory and spm simulations , with the largest discrepancies again occurring in the weakly polymorphic , strong - selection regime .",
    ".kl divergences between theoretical predictions and numerical simulations for the two - plane fitness landscape ( fig .",
    "[ fig : two - infinite - planes ] ) and the three - plane fitness landscape ( fig .",
    "[ fig : multiple - planes ] ) ) . [ cols=\"<,<,^,^,^,^,^,^ \" , ]      although our approach is valid for an arbitrary number of alleles @xmath3 , statistics of allele diversity in a population under selection become substantially easier to deal with in the infinite - allele limit .",
    "as discussed in the introduction , this limit is justified since our focus here is on evolution of protein , rna and dna sequences , where the number of alleles grows exponentially with sequence length .",
    "nonetheless , we have systematically investigated the extent of deviations between our infinite - allele theory results and simulations as the number of alleles @xmath3 decreases and becomes comparable to the population size @xmath7 .",
    "[ fig : var - k ] shows the kl divergence between partition probabilities derived theoretically for the two - plane landscape in the infinite - allele limit ( eq .  [ sampling - prob-2-planes ] ) and",
    "obtained numerically on finite - size fc networks .",
    "we consider three regimes : monomorphic ( @xmath308 ) , weakly polymorphic ( @xmath309 ) , and strongly polymorphic ( @xmath310 ) . in the latter two cases ,",
    "noticeable deviations between theory and simulations begin to appear below the @xmath311 regime ; the agreement improves as the population becomes more monomorphic .",
    "we conclude that our theory is applicable over a wide range of mutation rates , as long as the network size is comparable to , or greater than , the population size .    0.75 , @xmath251 ) , as a function of the log ratio between the total number of alleles @xmath3 and the population size @xmath7 .",
    "the sample size is @xmath82 ; partition probabilities were estimated from @xmath234 samples as described in the main text .",
    "population size is @xmath233 , and the total number of alleles is @xmath312 , @xmath313 . for smaller networks ,",
    "the number of the nodes in the upper and lower planes had to be rounded to the nearest integer .",
    "diamonds : polymorphic population ( @xmath305 ) , squares : weakly polymorphic population ( @xmath304 ) , circles : monomorphic population ( @xmath303 ) .",
    "the solid vertical line indicates the case of the network size equal to the population size ( @xmath314 ) .",
    ", title=\"fig : \" ]",
    "one of the most challenging problems in evolutionary biology is to understand evolutionary dynamics of molecular loci , such as protein or rna - coding sequences , or gene regulatory regions .",
    "the number of nucleotides at these loci , @xmath238 , is large enough so that the total number of possible sequences , @xmath315 , is astronomical , far exceeding the population size @xmath7 . under these conditions",
    "the evolution of a molecular locus , assumed to be decoupled by recombination from the rest of the genome , reaches a `` de - labelled '' steady state characterized by mutation - selection - drift balance .",
    "the allelic diversity in the population is determined by the balance of forces of selection and drift on one hand , and mutation on the other . the former act to reduce allelic diversity , while the latter acts to increase it . as a result ,",
    "population statistics such as the mean number of distinct alleles , or the probability of seeing a certain allelic configuration in a sample , do not change with time , even though new genotypes continue to be explored on the effectively infinite allelic network .",
    "the neutral allelic diversity in such a system ( that is , when all alleles have the same fitness ) was explored by ewens  @xcite .",
    "the main result of that study , the ewens sampling formula , is widely used in population genetics .",
    "the neutral landscape is a single plane , with each allele connected to the other @xmath10 alleles .",
    "however , recent high - throughput studies connecting protein sequences with phenotypes reveal a more complex picture : generally , a functional protein such as an enzyme can be disrupted by a subset of mutations at each of its sites ( e.g. , through substitution of a hydrophobic residue for a hydrophilic one in the protein core ) .",
    "other mutations do not significantly change protein stability , binding affinity or specificity , and are therefore effectively neutral .",
    "occasionally , a mutation is found which increases the protein s fitness , but these mutations are generally infrequent .",
    "overall , recent experimental studies point to fitness landscapes comprised of multiple interconnected planes .",
    "the simplest landscape of this kind has just two distinct fitness states , with functional sequences on the upper plane and non - functional sequences on the lower plane  @xcite .",
    "multiple - plane fitness landscapes are characterized by extensive epistasis , which is likely to be pervasive in molecular evolution  @xcite .    since molecular evolution",
    "may be described by steady - state dynamics on multiple - plane fitness landscapes , it is of great interest to generalize the ewens sampling formula to arbitrary fitness landscapes , and to the multiple - plane class of landscapes in particular .",
    "tractable expressions for sampling probabilities would enable inference of selection coefficients , relative plane sizes , and mutation rates , using dna , rna or protein sequences sampled from the population as input . here",
    "we report an extension of the ewens sampling formula to arbitrary fitness landscapes , focusing especially on the multiple - plane case which yields substantial simplifications in the infinite allele limit . unlike current state - of - the - art techniques based on the poisson random field framework  @xcite , such as the sampling probability formulas developed by desai et al .",
    "@xcite , our approach is capable of treating epistasis .",
    "however , the essential drawback of the ewens sampling formula and its generalizations is the `` fully - connected '' assumption ( i.e. , that each allele can mutate into every other allele ) .",
    "moreover , the sampling formula becomes intractable for large sample sizes , due to a large number of terms to sum over .",
    "therefore , in order to study the limits of applicability of our theory , we have carried out extensive comparisons with numerical simulations on multiple - plane fitness landscapes .",
    "first , we checked the full - connectivity assumption inherent in the ewens approach by comparing the sampling probabilities of our theory with those obtained by simulation of steady - state populations evolving on single - point - mutant networks .",
    "we find that the agreement , although dependent on the details of the fitness landscape model , the values of selection coefficients , and mutation rates ( and least reliable in the weakly polymorphic regime ) , remains strong enough overall to encourage application of our theoretical results to sequence data .",
    "note that our model of the fitness landscape was constructed specifically to create a non - trivial distribution of neutral , deleterious and beneficial single - point mutations for the alleles , making it in some sense as distant from the fully connected network as possible .",
    "thus we expect the deviations to be smaller ( or at least not much worse ) in natural systems .",
    "second , we have checked the infinite - allele assumption by systematically reducing the number of alleles until it became lower than the population size .",
    "we find that , over a wide range of mutation rates , deviations between theory and simulations become significant only when the number of alleles approaches the population size from above .",
    "thus our assumption of the infinite network size is justified for all loci that are long enough , such as those encoding transcribed or regulatory regions .",
    "robust inference of selection coefficients and mutation rates on the basis of a sample of population allelic states requires statistics of allelic diversity to deviate substantially from both the neutral expectation and the effective population size ( eps ) approximation .",
    "clearly , no inference of selection signatures is possible on the basis of limited sample data if population dynamics is close to neutral . on the other hand , in the eps",
    "limit only the relative size of the highest - fitness plane can be inferred . by scanning over a wide range of selection coefficients and mutation rates on a two - plane fitness landscape , we have found that , although regions of neutral and eps dynamics are roughly complementary , there are areas of parameter space characterized by deviations from both . thus the use of our generalized ewens sampling formula , which is valid throughout the entire parameter space , is necessary for inferring selection signatures from data .",
    "moreover , allelic diversity generated by steady - state evolutionary dynamics on a three - plane fitness landscape is sufficiently distinct from its two - plane counterpart in the strong - selection , weakly polymorphic regime , opening up a possibility of inferring multiple selection coefficients from the data .",
    "another hallmark of non - neutral population dynamics is de - localization of the population to multiple fitness planes .",
    "with a two - plane landscape , we expect the fraction of the population on the lower plane to increase with the mutation rate and decrease with the distance between the two planes .",
    "our investigation of the mutation load confirms these predictions .    in summary",
    ", we have generalized the ewens sampling formula to evolutionary dynamics under selection .",
    "although in principle our results are valid for arbitrary fitness landscapes , focusing on the infinite allele limit and landscapes with just two or three distinct fitness states yields substantial simplifications , making our approach computationally tractable and thus applicable to inferring selection signatures from high - throughput sequence data .",
    "such multiple - plane fitness landscapes are consistent with recent large - scale studies of molecular phenotypes  @xcite . unlike previous approaches",
    ", we do not assume the absence of epistasis , which is likely to be prevalent in molecular evolution  @xcite .",
    "however , we do make the infinite allele assumption , and , as in the ewens original formula  @xcite , assume that each allele can mutate into any other allele .",
    "we check our theory against numerical simulations in model systems where these assumptions are relaxed , and find that our predictions remain accurate enough to enable inference of evolutionary parameters from sequencing data .",
    "pk acknowledges financial support from a research fellowship awarded by the department of physics and astronomy , rutgers university .",
    "avm was supported in part through a collaboration with los alamos national lab ( lanl - doe 20150236er ) .",
    "software and models used in this study are freely available upon request .",
    "in the two - plane system , the fitness vector has the following structure : @xmath316 with @xmath151 nonzero entries followed by @xmath153 zeros . in this case , eq .",
    "[ gen - hyp - def ] involves summation over only @xmath151 indices :    @xmath317    where @xmath157 is the fraction of nodes on the first ( lower ) plane , and in the last equality we used @xmath318 where the sum runs over all non - negative @xmath319 that sum up to @xmath47 .",
    "now , consider a situation in which the first @xmath4 out of @xmath119 counts happen to come from the first plane .",
    "this means that they are among the first @xmath151 elements of @xmath134 . since assigning these @xmath4 counts to different locations within the first @xmath151 slots in the @xmath134 vector ( while keeping their original order )",
    "does not change the result , we can for convenience assign them to be the first @xmath4 elements of @xmath134 , followed by @xmath320 zeros .",
    "then @xmath321 the corresponding generalized confluent hypergeometric function is again given by the sum over @xmath151 indices : @xmath322 we can rewrite it as @xmath323 using eq .  [ pocchammer - as - binomial - sum ] immediately leads to @xmath324 so that the generalized confluent hypergeometric function is once again reduced to the ordinary confluent hypergeometric function .",
    "lastly , we need to take into account the fact that we can put counts into different positions of the @xmath134 vector .",
    "this introduces an additional binomial pre - factor @xmath325 .",
    "similarly , placing the rest of the counts into the last @xmath153 entries of the @xmath134 vector introduces another binomial pre - factor @xmath326 . using these pre - factors together with eqs .",
    "[ mathcalf = f11 ] and [ mathcalf = f11:again ] in eq .",
    "[ sampling - prob ] yields eq .",
    "[ sampling - prob-2-planes - finite - k ] .",
    "we can expand the exponents in the allele frequency distribution ( eq .  [ allele - frequency - distribution ] ) into a series : @xmath327 and apply @xmath328 in order to get @xmath329 where @xmath330 is a list of the @xmath139 alleles not contained in @xmath138 , and therefore @xmath331 and @xmath332 are @xmath333-dimensional vectors obtained from @xmath41 and @xmath131 by eliminating elements at the positions specified by @xmath138 , while @xmath334 is a @xmath119-dimensional vector obtained from the @xmath3-dimensional vector @xmath335 by keeping the elements at the positions specified by @xmath138 , and eliminating the rest ."
  ],
  "abstract_text": [
    "<S> in considering evolution of transcribed regions , regulatory modules , and other genomic loci of interest , we are often faced with a situation in which the number of allelic states greatly exceeds the population size . in this limit </S>",
    "<S> , the population eventually adopts a steady state characterized by mutation - selection - drift balance . </S>",
    "<S> although new alleles continue to be explored through mutation , the statistics of the population , and in particular the probabilities of seeing specific allelic configurations in samples taken from a population , do not change with time . in the absence of selection , </S>",
    "<S> probabilities of allelic configurations are given by the ewens sampling formula , widely used in population genetics to detect deviations from neutrality . here </S>",
    "<S> we develop an extension of this formula to arbitrary , possibly epistatic , fitness landscapes . </S>",
    "<S> although our approach is general , we focus on the class of landscapes in which alleles are grouped into two , three , or several fitness states . this class of landscapes yields sampling probabilities that are computationally more tractable , and can form a basis for the inference of selection signatures from sequence data . </S>",
    "<S> we demonstrate that , for a sizeable range of mutation rates and selection coefficients , the steady - state allelic diversity is not neutral . therefore , it may be used to infer selection coefficients , as well as other key evolutionary parameters , using high - throughput sequencing of evolving populations to collect data on locus polymorphisms . </S>",
    "<S> we also carry out numerical investigation of various approximations involved in deriving our sampling formulas , such as the infinite allele limit and the `` full connectivity '' assumption in which each allele can mutate into any other allele . </S>",
    "<S> we find that our theory remains sufficiently accurate even if these assumptions are relaxed . </S>",
    "<S> thus , our framework establishes a theoretical foundation for inferring selection signatures from samples of sequences produced by evolution on epistatic fitness landscapes . </S>"
  ]
}