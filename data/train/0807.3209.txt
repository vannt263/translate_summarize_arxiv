{
  "article_text": [
    "in recent two or three decades , a considerable number of researchers have investigated various problems in information sciences , such as image restoration and error - correcting codes on the basis of the analogy between statistical mechanics and probabilistic information processing @xcite . especially , a lot of researchers have investigated various problems in image processing based on the markov random fields @xcite . in the field of the print technologies ,",
    "many techniques of information processing have also developed .",
    "particularly , the _ digital halftoning _",
    "@xcite is regarded as a key processing to convert a digital grayscale image to black and white dots which represents the original grayscale levels appropriately . on the other hand ,",
    "the inverse process of the digital halftoning is referred to as _",
    "the inverse halftoning is also important for us to make scanner machines to retrieve the original grayscale image by making use of much less informative materials , such as the halftoned binary dots .",
    "the inverse halftoning is ` ill - posed ' in the sense that one lacks information to retrieve the original image because the material one can utilize is just only the halftoned black and white binary dots instead of the grayscale one . to overcome this difficulty",
    ", we usually introduce the ` regularization term ' which compensates the lack of the information and regard the inverse problem as a combinatorial optimization @xcite .",
    "then , the optimization is achieved to find the lowest energy state via , for example , simulated annealing @xcite .",
    "besides the standard regularization theory , we can use the bayesian approach . under the direction of this approach ,",
    "stevenson @xcite attempted to apply the maximum of a posteriori ( map for short ) estimation to the problem of inverse halftoning for a given halftone binary dots obtained by the threshold mask and the so - called error diffusion methods .",
    "however , there is few theoretical approach to deal with the inverse - halftoning from the view point of the bayesian inference and statistical mechanics of information .    in this study , on the basis of statistical mechanics of the q - ising model @xcite , we formulate the problem of inverse halftoning to estimate the original grayscale levels by using the information about both the halftoned binary dots and the threshold mask .",
    "we reconstruct the original grayscale revels from a given halftoned binary image and the threshold mask so as to maximize the posterior marginal probability . using monte carlo simulations ,",
    "we investigate statistical properties of the inverse process , especially , we reveal the condition of the bayes - optimal solution for which the mean - square error takes its minimum .",
    "the result of the simulation is supported by the analysis of the infinite - range model . in order to investigate to",
    "what extent the bayesian approach is effective for realistic images , we apply the method to retrieve the grayscale levels of the 256-levels standard image _ lenna _ from the binary dots . we find that the bayes - optimal solution gives a fine restored grayscale image which is very close to the original one .",
    "the contents of this paper are organized as follows . in the next section ,",
    "we formulate the problem of inverse halftoning .",
    "we mention the relationship between statistical mechanics of the q - ising model and bayesian inference of the inverse halftoning . in the following section ,",
    "we investigate statistical properties of the bayesian inverse halftoning by monte carlo simulations .",
    "analysis of the infinite - range model supports the result of the simulations .",
    "we also show that the bayes - optimal inverse halftoning is useful even for realistic images , such as the 256-level standard image _ lenna_. last section is summary .",
    "we first define the model system to investigate the statistical performance of the bayesian inference for the problem of inverse halftoning . as original grayscale images , which are converted to the black and white binary dots",
    ", we consider snapshots from a gibbs distribution of the ferromagnetic q - ising model having the spin variables @xmath0 .",
    "then , each image @xmath1 being specified by the hamiltonian @xmath2 follows the gibbs distribution @xmath3= \\frac{1}{z_s }   \\exp \\left [ - \\frac{j_s}{t_s } \\sum_{\\rm n.n . }",
    "\\left ( \\xi_{x , y } - \\xi_{x^{'},y^ { ' } } \\right)^2   \\right ] \\label{eq : ferro}\\ ] ] at temperature @xmath4 , where @xmath5 is the partition function of the system and the summation @xmath6 runs over the sets of the nearest neighboring pixels located on the square lattice in two dimension .",
    "the ratio of strength of spin - pair interaction @xmath7 and temperature @xmath8 , namely , @xmath9 controls the smoothness of our original image @xmath1 . in fig .",
    "[ fig : fg1 ] ( left ) , we show a typical example of the snapshots from the distribution ( [ eq : ferro ] ) for the case of @xmath10 , @xmath11 and @xmath12 .    ) having @xmath13 pixels for the case of @xmath10 ( left ) .",
    "we set @xmath14 , @xmath15 .",
    "the right panel shows a @xmath16-levels standard image _ lenna _ with @xmath17 pixels . ,",
    "title=\"fig:\",width=188 ] ) having @xmath13 pixels for the case of @xmath10 ( left ) .",
    "we set @xmath14 , @xmath15 .",
    "the right panel shows a @xmath16-levels standard image _ lenna _ with @xmath17 pixels .",
    ", title=\"fig:\",width=188 ]    the right panel of the fig .",
    "[ fig : fg1 ] shows the 256-levels grayscale standard image _ lenna _ with @xmath17 pixels .",
    "we shall use the standard image to check the efficiency of our approach in the last part of this paper . in order to convert original grayscale images to the the black and white binary dots , we make use of the threshold array @xmath18 .    [ cols=\"^,^\",options=\"header \" , ]     each component @xmath19 of the array @xmath20 takes a non - overlapping integer and these numbers are arranged on the @xmath21 squares as shown in fig .",
    "[ fig : fg2 ] for @xmath22 ( left ) and for @xmath23 ( right ) . for general case of @xmath24",
    ", we define the array as @xmath25 we should keep in mind that the definition ( [ eq : mask ] ) is reduced to @xmath26 and the domain of each component of the threshold array becomes the same as that of the original image @xmath1 for @xmath27 .    in order to achieve a pixel - to - pixel map between each element of the threshold array , @xmath28 and the corresponding original grayscale pixel @xmath29 , we spread a lots of threshold arrays over the original image so as not to overlap any threshold array with one another . then , we transform each original pixel @xmath29 into the binary dot @xmath30 by @xmath31 here we defined @xmath28 as the threshold value corresponding to the @xmath32-th pixel and @xmath33 denotes the unit - step function .",
    "halftone images generated by the dither method via ( [ eq : step ] ) are shown in fig .",
    "[ fig : fg3 ] .",
    "we find that the left panel obtained by the uniform threshold mask @xmath34 is hard to be recognized as a grayscale image , whereas , the center panel obtained by the @xmath35 bayer - type threshold array might be recognized as just like an original image through our human vision systems ( due to a kind of _ optical illusion _ ) .",
    "obviously , the inverse process of the above halftoning is regarded as an ill - posed problem .",
    "this is because from ( [ eq : step ] ) , one can not determine the original image @xmath36 completely from a given set of @xmath37 and @xmath38 .",
    "then , the standard regularization theory @xcite provides us a realistic break - through . in the theory",
    ", we introduce the so - called ` regularization term ' that compensates the lack of the information to retrieve the original image .",
    "then , we construct the energy function to be minimized to find the original image as the lowest energy state . for instance , some recent progress based on the standard regularization theory is found in our paper @xcite .    the standard regularization theory is itself a general and powerful approach , nevertheless , we here use an alternative , namely , the bayesian approach to solve the inverse problem .     from the snapshot from a gibbs distribution of the @xmath10 ising model shown in fig .",
    "[ fig : fg1 ] ( left ) .",
    "the center panel shows a halftone image obtained by the dither method using the @xmath39 bayer - type threshold array from the same snapshot .",
    "the right panel shows a halftone image converted by the dither method using the @xmath40 bayer - type threshold array from the 256-level standard image _ lenna _ with @xmath17 pixels shown in fig .",
    "[ fig : fg1 ] ( right ) .",
    ", title=\"fig:\",width=170 ]   from the snapshot from a gibbs distribution of the @xmath10 ising model shown in fig .",
    "[ fig : fg1 ] ( left ) .",
    "the center panel shows a halftone image obtained by the dither method using the @xmath39 bayer - type threshold array from the same snapshot .",
    "the right panel shows a halftone image converted by the dither method using the @xmath40 bayer - type threshold array from the 256-level standard image _ lenna _ with @xmath17 pixels shown in fig . [",
    "fig : fg1 ] ( right ) .",
    ", title=\"fig:\",width=170 ]   from the snapshot from a gibbs distribution of the @xmath10 ising model shown in fig .",
    "[ fig : fg1 ] ( left ) .",
    "the center panel shows a halftone image obtained by the dither method using the @xmath39 bayer - type threshold array from the same snapshot .",
    "the right panel shows a halftone image converted by the dither method using the @xmath40 bayer - type threshold array from the 256-level standard image _ lenna _ with @xmath17 pixels shown in fig .",
    "[ fig : fg1 ] ( right ) .",
    ", title=\"fig:\",width=170 ]    in the bayesian inverse digital halftoning , we attempt to restore the original grayscale image from a given halftone image by means of the so - called maximizer of posterior marginal ( mpm for short ) estimate .",
    "then , we define @xmath41 as an estimate of the original image @xmath1 arranged on the square lattice and reconstruct the grayscale image on the bases of maximizing the following posterior marginal probability : @xmath42 where the summation @xmath43 runs over all pixels except for the @xmath32-th and the posterior probability @xmath44 is given by the bayes formula : @xmath45 in this study , following stevenson @xcite , we assume that the likelihood might have the same form as the halftone process of the dither method , namely , @xmath46 where @xmath47 denotes a kronecker delta and we should notice that the information on the threshold array @xmath18 is available in addition to the halftone image @xmath48 . then , we choose the model of the true prior as @xmath49,\\ ] ] where @xmath50 is a normalization factor . @xmath51 and @xmath52 are the so - called hyper - parameters . it should be noted that one can construct the bayes - optimal solution if we assume that the model prior has the same form as the true prior , namely , @xmath53 and @xmath54 ( what we call , _ nishimori line _ in the research field of spin glasses @xcite ) .    from the viewpoint of statistical mechanics , the posterior probability @xmath55 generates the equilibrium states of the ferromagnetic q - ising model whose hamiltonian is given by @xmath56 under the constraints @xmath57 obviously , the number of possible spin configurations that satisfy the above constraints ( [ eq : constraint ] ) is evaluated as @xmath58 and this quantity is exponential order such as @xmath59 ( @xmath60 : a positive constant ) .",
    "therefore , the solution @xmath61 to satisfy the constraints ( [ eq : constraint ] ) is not unique and this fact makes the problem very hard . to reduce the difficulties , we consider the equilibrium state generated by a gibbs distribution of the ferromagnetic q - ising model with the constraints ( [ eq : constraint ] ) and increase the parameter @xmath51 gradually from @xmath62 .",
    "then , we naturally expect that the system stabilizes the ferromagnetic q - ising configurations due to a kind of the regularization term ( [ eq : ham ] ) .",
    "thus , we might choose the best possible solution among a lot of candidates satisfying ( [ eq : constraint ] ) .",
    "> from the view point of statistical mechanics , the mpm estimate is rewritten by @xmath63 where @xmath64 is the q - generalized step function defined by @xmath65 obviously , @xmath66 is a local magnetization of the system described by ( [ eq : ham ] ) under ( [ eq : constraint ] ) .      to investigate the performance of the inverse halftoning",
    ", we evaluate the mean square error which represents the pixel - wise similarity between the original and restored images .",
    "especially , we evaluate the average case performance of the inverse halftoning through the following averaged mean square error @xmath67 we should keep in mind that the @xmath68 gives zero if all restored images are exactly the same as the corresponding original images .",
    "in this section , we first investigate the statistical properties of our approach to the inverse halftoning for a set of snapshots from a gibbs distribution of the ferromagnetic q - ising model via computer simulations .",
    "we next analytically evaluate the performance for the infinite - range model .",
    "finally , we check the usefulness of our approach for the realistic images , namely , the 256-levels standard image _ lenna_.      we first carry out monte carlo simulations for a set of halftone images , which are obtained from the snapshots from a gibbs distribution of the ferromagnetic @xmath10 ising model with @xmath13 pixels by the uniform threshold @xmath34 and the @xmath39 bayer - type threshold arrays as shown in fig . [",
    "fig : fg2 ] . in order to clarify the statistical performance of our method",
    ", we reveal the hyper - parameters @xmath51 and @xmath69 dependence of the averaged mean square error @xmath68 .    .",
    "the original image is a snapshot from a gibbs distribution of the @xmath10 ferromagnetic ising model with @xmath13 pixels and @xmath70 , @xmath71 and @xmath15 .",
    "the halftone images are obtained by the uniform and @xmath35 bayer - type arrays .",
    ", width=340 ]    we plot the results in fig .",
    "[ fig : fg4 ] .",
    "these figures show that the present method achieves the best possible performance under the bayes - optimal condition , that is , @xmath72 and @xmath54 .",
    "we also find from fig .",
    "[ fig : fg4 ] ( the lower panel ) that the limit @xmath73 leading up to the map estimate gives almost the same performance as the bayes - optimal mpm estimate .",
    "this fact means that it is not necessary for us to take the @xmath74 limit when we carry out the inverse halftoning via simulated annealing .",
    "grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( left ) .",
    "the center panel shows a @xmath10 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( center ) .",
    "the right panel shows a @xmath75 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( right ) . , title=\"fig:\",width=170 ]   grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( left ) .",
    "the center panel shows a @xmath10 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( center ) .",
    "the right panel shows a @xmath75 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( right ) . , title=\"fig:\",width=170 ]   grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( left ) .",
    "the center panel shows a @xmath10 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( center ) .",
    "the right panel shows a @xmath75 grayscale image restored by the mpm estimate from the halftone image shown in fig .",
    "[ fig : fg3 ] ( right ) .",
    ", title=\"fig:\",width=170 ]    from the restored image in fig .",
    "[ fig : fg5 ] ( center ) , it is actually confirmed that the present method effectively works for the snapshot of the ferromagnetic q - ising model .",
    "it should be noted that the mean square error evaluated for the @xmath35 bayer - type array is larger than that for the @xmath76 uniform threshold .",
    "this result seems to be somewhat counter - intuitive because the halftone image shown in the center panel of fig .",
    "[ fig : fg3 ] seems to be much closer to the original image , in other words , is much informative to retrieve the original image than the halftone image shown in the left panel of the same figure .",
    "however , it could be understood as follows .",
    "the shape of each ` cluster ' appearing in the original image ( see the left panel of fig . [",
    "fig : fg1 ] ) remains in the halftone version ( the left panel of fig .",
    "[ fig : fg3 ] ) , whereas , in the halftone image ( the center panel of fig .",
    "[ fig : fg3 ] ) , such structure is destroyed by the halftoning process via the @xmath35 bayer - type array . as we found , in a snapshot of the ferromagnetic q - ising model at the inverse temperature @xmath77 , the large size clusters are much more dominant components than the small isolated pixels .",
    "therefore , the averaged mean square error is sensitive to the change of the cluster size or the shape , and if we use the constant threshold mask to create the halftone image , the shape of the cluster does not change , whereas the high - frequency components vanish .",
    "these properties are desirable for us to suppress the increase of the averaged mean square error .",
    "this fact implies us that the averaged mean square error for the @xmath35 bayer - type is larger than that for the constant mask array and the performance is much worse than expected .      in this subsection",
    ", we check the validity of our monte carlo simulations , namely , we analytically evaluate the statistical performance of the present method for a given set of the snapshots from a gibbs distribution of the ferromagnetic q - ising model in which each spin variable is located on the vertices of the complete graph . for simplicity ,",
    "we first transform the index from @xmath32 to @xmath78 so as to satisfy @xmath79 .",
    "then , the new index @xmath78 runs from @xmath80 to @xmath81 . for this new index of each spin variable ,",
    "we consider the infinite - range version of true prior and the model as @xmath82 where the scaling factors @xmath83 appearing in front of the sums @xmath84 are needed to take a proper thermodynamic limit .",
    "we also set @xmath85 and @xmath86 for simplicity .",
    "obviously , the thermodynamics of the system @xmath1 is determined by the following magnetization : @xmath87 } { \\sum_{\\xi=0}^{q-1 }   \\exp [ 2 \\beta_s m_0 \\xi - \\beta_s { \\xi}^2 ] } .",
    "\\label{eq : m0}\\end{aligned}\\ ] ] on the other hand , the magnetization for the system @xmath61 having disorders @xmath48 and @xmath1 is given explicitly as @xmath88 then , the average case performance is determined by the following averaged mean square error : @xmath89 solving these self - consistent equations with respect to @xmath90 ( [ eq : m0 ] ) and @xmath91 ( [ eq : m ] ) , we evaluate the statistical performance of the present method through the quantity @xmath68 ( [ eq : sigma ] ) analytically .",
    "as we have estimated using the monte carlo simulation , we estimate how the mean square error depends on the hyper - parameter @xmath69 for the infinite - range version of our model when we set to @xmath92 , @xmath11 , @xmath93 , @xmath94 and @xmath15 .",
    "we find from figs .",
    "[ fig : fg6 ] ( a ) and ( b ) that the mean square error takes its minimum in the wide range on @xmath95 including the bayes - optimal condition @xmath96 . here",
    ", we note that @xmath97 holds under the bayes - optimal condition , @xmath98 for both cases of @xmath99 and @xmath100 , which is shown in fig .",
    "[ fig : fg7 ] . from this fact",
    ", we might evaluate the gap @xmath101 between the lowest value of the mean square error and the second lowest value obtained at the higher temperature than @xmath4 as follows .",
    "@xmath102 for example , for @xmath92 , we evaluate the gap as @xmath103 and this value agree with the result shown in fig . [",
    "fig : fg6 ] .",
    "when @xmath92 , @xmath104 , @xmath71 , @xmath105 and @xmath15 , ( b ) the mean square error as a function of the parameter @xmath95 when @xmath92 , @xmath104 , @xmath71 , @xmath106 and @xmath15 .",
    "the value @xmath107 for each line caption denotes the initial condition of the magnetization @xmath91 to find the locally stable solution .",
    ", width=340 ]    ( a )     when @xmath92 , @xmath104 , @xmath71 , @xmath105 and @xmath15 , ( b ) the mean square error as a function of the parameter @xmath95 when @xmath92 , @xmath104 , @xmath71 , @xmath106 and @xmath15 .",
    "the value @xmath107 for each line caption denotes the initial condition of the magnetization @xmath91 to find the locally stable solution .",
    ", width=340 ]    ( b )     as a function of the parameter @xmath95 when @xmath92 , @xmath104 , @xmath71 , @xmath106 and @xmath15",
    ". , width=340 ]    from figs .",
    "[ fig : fg6 ] and [ fig : fg7 ] , we also find that the range of @xmath69 in which the mean square error takes the lowest value coincides with the range of temperature @xmath69 for which the magnetization satisfies @xmath108 as shown in fig . [",
    "fig : fg7 ] .",
    "this robustness for the hyper - parameter selecting is one of the desirable properties from the view point of the practical use of our approach .",
    "moreover , the above evaluations might be helpful for us to deal with the inverse halftoning from the halftoned image of the standard image with confidence .",
    "in fact , we are also confirmed that our method is practically useful from the resulting image shown in fig .",
    "[ fig : fg5 ] ( right ) having the mean square error @xmath109 .",
    "in this paper , we investigated the condition to achieve the bayes - optimal performance of inverse halftoning by making use of computer simulations and analysis of the infinite range model .",
    "we were also confirmed that our bayesian approach is useful even for the inverse halftoning from the binary dots obtained from standard images , in the wide range on @xmath95 including the bayes - optimal condition , @xmath98 .",
    "we hope that some modifications of the prior distribution might make the quality of the inverse halftoning much better",
    ". it will be our future work .",
    "we were financially supported by _ grant - in - aid scientific research on priority areas  deepening and expansion of statistical mechanical informatics ( dex - smi ) \" of the ministry of education , culture , sports , science and technology ( mext ) _ no .",
    "18079001 .",
    "99 h. nishimori , _ statistical physics of spin glasses and information processing : an introduction _ , oxford university press , london ( 2001 ) . j. besag , _ j. roy . stat . soc .",
    "b _ * 48 * , no . 3 , 259 ( 1986 ) . r.c .",
    "gonzales and r.c .",
    "woods , _ digital image processing _ , addison wesley , reading , ma .",
    "pryce and d. bruce , _ j. phys . a : math .",
    "_ * 28 * , 511(1995 )",
    ". g. winkler , _ image analysis , random fields and markov chain monte carlo methods _ , springer ( 2002 ) .",
    "k. tanaka , _",
    "a : math . gen . _ * 35 * , r81 ( 2002 ) .",
    "r. ulichney , _ digital halftoning _ , mit press , massachusetts ( 1987 ) .",
    "bayer , _ icc conf .",
    "record _ , 11 ( 1973 ) .",
    "r. w. floyd and l. steinberg , _ sid int .",
    "digest of tech . papers _ , 36 ( 1975 ) .",
    "c.m . miceli and k.j .",
    "parker , _ j. electron imaging _ * 1 * , 143(1992 ) .",
    "wong , _ ieee trans . on image processing",
    "_ * 4 * , 486(1995 ) .",
    "cabrera , k. iyer , g. xiang and v. kreinovich : _ on inverse halftoning : computational complexity and interval computations , 2000 conference on information science and systems _ , the johns hopkins university , march 16 - 18 ( 2005 ) .",
    "m. discepoli and i. greace , _ lecture note on computer science _ * 3046 * , 388 ( 2004 )",
    ". s. kirkpatrick , c.d .",
    "gelatt and m.p .",
    "vecchi , _ science _ * 220 * , 671 ( 1983 ) .",
    "s. geman and d. geman , _ ieee trans . pattern anal . and mach .",
    "intel . _ * 11 * , 721 ( 1989 ) .",
    "stevenson , _ ieee _ * 6 * , 574(1997 ) .",
    "d. boll@xmath110 , h. rieger and g.m .",
    "shim , _ j. phys . a : math .",
    "* 27 * , 3411 ( 1994 ) .",
    "y. saika and j. inoue , submitted to _",
    "journal of information processing society of japan _",
    "( in japanese ) ( 2008 ) ."
  ],
  "abstract_text": [
    "<S> on the basis of statistical mechanics of the q - ising model , we formulate the bayesian inference to the problem of inverse halftoning , which is the inverse process of representing gray - scales in images by means of black and white dots . using monte carlo simulations , we investigate statistical properties of the inverse process , </S>",
    "<S> especially , we reveal the condition of the bayes - optimal solution for which the mean - square error takes its minimum . </S>",
    "<S> the numerical result is qualitatively confirmed by analysis of the infinite - range model . as demonstrations of our approach , </S>",
    "<S> we apply the method to retrieve a grayscale image , such as standard image _ lenna _ , from the halftoned version . </S>",
    "<S> we find that the bayes - optimal solution gives a fine restored grayscale image which is very close to the original .    </S>",
    "<S> statistical mechanics ; digital halftoning ; image processing ; markov chain monte carlo method ; statistical inference 89.65.gh , 02.50.-r </S>"
  ]
}