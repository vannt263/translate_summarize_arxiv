{
  "article_text": [
    "lisa ( laser interferometer space antenna ) is a joint esa - nasa space mission conceived to detect gravitational waves ( gws )  @xcite .",
    "lisa consists in a constellation of three spacecraft in the vertexes of an equilateral triangle 5  million kilometres to the side .",
    "the constellation orbits the sun following the ecliptic , some 20  degrees ( 45  million kilometres ) behind the earth .",
    "each spacecraft houses two proof masses in nominal free fall , and laser links are established between spacecraft see figure  [ fig0 ] .",
    "the role of the links is to enable interferometric measurements of relative distance and acceleration variations between pairs of proof masses in distant spacecraft .",
    "this is how lisa will detect gws , since they show up as _ tidal forces _ ( or _ geodesic deviations _ in the language of general relativity theory ) in the region where the detector is .    ]",
    "expected gw signals are extremely weak  @xcite , hence severe requirements must be imposed on the proof mass residual acceleration noise to ensure lisa meets its gw detection objectives .",
    "these are defined in terms of spectral density  @xcite : @xmath4\\ !",
    "\\left[1 + \\left(\\frac{0.1\\ { \\rm mhz}}{\\omega/2\\pi}\\right)\\right ]   \\right\\}^{\\!\\frac{1}{2 } } \\ { \\rm m}\\,{\\rm s}^{-2}\\,{\\rm hz}^{-1/2 } \\nonumber   \\label{lisa.req.acc}\\ ] ] in the frequency band from 0.1  mhz to 0.1  hz , which is where optimum gw detection performance can be obtained with interferometer arm - lengths of @xmath55  million kilometres  @xcite .    the conditions in equation  ( [ lisa.req.acc ] )",
    "are not only very demanding , they can not be directly put to test in an earth based environment .",
    "the reason is of course the impossibility to maintain a physical system in accurate free fall near the earth s surface during periods of several hours , as required for measurements in sub - milli - hertz frequency bands .",
    "this fact motivated esa , the european space agency , to fly a technology precursor mission to secure proper working of the key technologies needed by lisa .",
    "such technology mission goes by the name lisa pathfinder ( lpf ) , and its launch date is scheduled for 2011 .",
    "lpf is a squeezed version of one lisa arm : its length is downscaled to @xmath530 cm , and the two proof masses are housed in a single spacecraft .",
    "noise requirements in lpf are relaxed by about an order of magnitude relative to those of lisa .",
    "also , the measuring bandwidth ( mbw ) in the ltp ( lisa technology package , the main instrument on board lpf ) is reduced to the range between 1  mhz and 30  mhz .",
    "because of its small dimensions , lpf can not work as a milli - hertz gw detector ; rather , lpf is a noise monitor intended to understand and properly model its sources  @xcite .",
    "one of such sources of noise , which can limit the performance of lisa , is temperature fluctuations .",
    "thermal stability is necessary to ensure the stability of the optical elements properties in the optical metrology system ( optical bench , mirrors , beam - splitters , etc . ) , as well as of the proof masses environment , where such effects as radiometer and/or radiation pressure fluctuations will cause random accelerations if the temperature fluctuates .",
    "this happens in lisa and lpf alike , and the maximum tolerable levels of temperature fluctuations can be derived from estimates of the magnitude of their contribution to the total instrument noise , and ( conventionally ) assuming that they should contribute not more than @xmath510% to the total .",
    "this generates a requirement in temperature stability for lisa of  @xcite @xmath6 in lisa s mbw , i.e. , from 0.1  mhz to 0.1  hz .",
    "consequently , measurements capable to discern such small temperature fluctuations are needed . in lpf ,",
    "the requirements being relaxed as described above , the temperature stability is also less severe  @xcite : @xmath7 in the frequency band from 1  mhz to 30  mhz . in order to make meaningful temperature measurements , the measuring system must be quieter than this figure , and again 10% of the above is required for it , i.e. , @xmath8    the ltp temperature monitoring system has already been designed and tested  @xcite see also section  [ fee.description ] below and it works . however , a small excess noise has been detected at frequencies around the milli - hertz when the measured temperature drifts with time .",
    "this effect does not pose a serious problem in the ltp , as it only shows up at very low frequencies ( @xmath9mhz ) and in the presence of somewhat high temperature drifts , @xmath10@xmath2ks@xmath3 .",
    "in lisa the mbw stretches down to 0.1  mhz  @xcite , and even weaker temperature drifts are likely to significantly deteriorate the performance of the measuring system .",
    "as we shall see , its origin has been traced to non - linearities of the analog - to - digital converters ( adc ) .",
    "this paper focuses on the identification and reduction of this excess noise .",
    "it is organised as follows : section  [ fee.description ] briefly describes the temperature measurement system which will actually fly in lpf .",
    "section  [ problem ] delves into the details of a potential problem with the non - idealities of the adcs . in section  [ mitigation ] we present experimental evidence that the observed excess noise can indeed be attributed to the adcs non - ideal response , and also two different ways to reduce that noise are analysed . in section",
    "[ results ] we give details of the experimental setups , tests carried through to assess the quality of the proposed methods , and results .",
    "finally , section  [ discussion ] highlights the most relevant results and the prospects of their applicability for lisa .",
    "in this section the temperature measurement system is briefly reviewed .",
    "details can be found in  @xcite .",
    "the functional block diagram of the system is given in fig .",
    "[ fee.proc ] .    ]    the temperature signal , @xmath11 , coming from a wheatstone bridge is modulated by a square wave signal of angular frequency @xmath12 ( @xmath13=6.25hz ) to avoid the 1/@xmath14 noise of the instrumentation amplifier ( ia ) .",
    "the modulated signal is amplified by the ia and low - pass filtered to avoid aliasing . the signal is then quantised by a 16-bit adc .",
    "once the signal is digitised , a digital demodulation takes place : @xmath15 samples are averaged during either polarity of the modulating square wave , and the averaged value of one polarity is subtracted from that of the other one see schematics in fig .",
    "[ fee.proc ] .",
    "this process results in a noise equivalent temperature for _ dc _ signals of @xmath16 at frequencies down to 0.1  mhz  @xcite .",
    "the signal coming from the analog circuit of the front - end electronics ( fee ) is quantised by an adc .",
    "only one type of adc suitable for this purpose has been certified for use in space applications ; it is a 16-bit capacitor based successive approximation register ( sar ) .",
    "limitations in the performance of the system at low frequencies ( milli - hertz range ) when slowly drifting input signals ( @xmath2vs@xmath3 ) are quantised are related to the non - idealities of such adcs , as will be shown below .",
    "in this section we analyse the adc non - linearity errors , and how they perturb the temperature measurements .",
    "quantisation is inherently a non - linear process . by construction , the values of the analog function",
    "are rounded up to the closest adc step , so that even an ideal adc generates output errors associated to the differences between the real and quantised values of the signal . in an adc",
    "@xcite the step size , or least significant bit ( lsb ) , is defined by @xmath17 where @xmath18 is the number of bits of the adc , and @xmath19 is the maximum voltage ( full - scale ) the adc can quantise . when a large number of bits is considered the error introduced by the quantisation process is usually treated as an independent random variable with uniform probability density function ( pdf ) and white spectral density  @xcite .    in a real adc ,",
    "however , the quantisation steps are not uniform due to mismatches in the internal topology of the adc ; more specifically , tolerances in the capacitors of the sar array  @xcite see figure  [ nonlinear ] . such non - uniformity is specified with two parameters : differential non - linearity ( dnl ) and integral non - linearity ( inl ) errors .",
    "the dnl is defined as the deviation between two adjacent transition points of the quantisation ladder and an lsb , or  @xcite @xmath20 where @xmath21 is the output value of the @xmath22-th quantisation code .    the additional noise related to the dnl errors",
    "can be reduced by suitable dithering  @xcite .",
    "the inherent adc noise plus fee noise can be considered in this case as a dither source , which appears to be enough to make the dnl negligible in practice see section  [ real.adcs ] below .    on the other hand",
    ", the inl error is defined as the discrete integral of the dnl , i.e. , @xmath23 and can be understood as the difference between the real and the ideal adc transfer curves see figure  [ nonlinear ] .",
    "the noise introduced by this error is usually less noticeable , although much more difficult to reduce . in this paper",
    "we focus on how to do this , since the inl is the one limiting the performance of the measurement when slowly drifting input signals are present .",
    "this is a common situation in ltp temperature measurements .    ]",
    "experimental results see section  [ non.stationary] obtained with the temperature measurement system reflect the problem depicted in figure  [ nonlinear ] , which shows up as excess noise in the spectrum .",
    "such noise could not be attributed to actual temperature fluctuations since sensors were placed in a thermal environment where fluctuations were efficiently screened out  @xcite , hence such behaviour may not be due to variable temperatures .",
    "analog noise or interferences coming from the signal processing chain ( wheatstone bridge , amplification , low - pas filtering ) were also discarded as possible sources of the extra noise .",
    "finally , the excess noise disappears when a _",
    "dc _ temperature value ( i.e. , not drifting with time ) is measured   see figure  [ spec1 ] .",
    "all in all , the origin of the excess noise has been identified as due to inl errors of the adc . in the following",
    "we present more quantitative arguments confirming this hypothesis .",
    "we first analyse the effect of a faulty bit in a sar adc on the performance of the measurement . for this , a simple adc model is considered . the analog - to - digital conversion is done ( in sar adcs ) by comparing the sampled signal with an analog voltage generated by a digital - to - analog converter ( dac ) and a sar  @xcite .",
    "the topology of the dac is based on a switching capacitor bank composed by 16 capacitors , scaled from @xmath24 to @xmath25 , where @xmath26 defines the most significant bit ( msb ) and @xmath27 defines the lsb .",
    "the dac output voltage is  @xcite @xmath28 where @xmath29 is the binary digit ( @xmath30 stands for the lsb and @xmath31 for the msb ) ; it is set to 0 or 1 depending on the sampled voltage , and @xmath32 is the number of bits of the adc .",
    "an error @xmath33=@xmath34@xmath35@xmath36 in the @xmath37-th capacitor results in an error in the dac output when the corresponding bit is set to 1 .",
    "the voltage error @xmath38 induced by a faulty @xmath37-th bit is therefore @xmath39 where @xmath40 is the ideal lsb .",
    "the erroneous bit produces a superimposed periodic pattern in the quantisation error of the adc with 1 lsb of amplitude when the input voltage varies between 0 and @xmath19 , and exhibits a periodicity with the adc input voltage of @xmath41 .",
    "an example of this is shown in figure  [ sawtooth ] where it can be seen how the faulty bit introduces a long period component superimposed on the typical sawtooth error function of an ideal adc .",
    "= 1  bit ( @xmath42 , red ) , and a real adc with a faulty @xmath37=3 bit ( @xmath43 , blue ) .",
    "centre and bottom : error differences between the two real adcs and the ideal one , respectively .",
    "units in ordinates are lsbs .",
    "[ sawtooth ] ]      when a dither voltage , @xmath44 , with a certain probability density function ( pdf ) , @xmath45 , is added to the input signal of the adc , @xmath46 , the average quantisation error observed at the adc output , @xmath47 , is given by  @xcite @xmath48 where @xmath49 is the quantisation error of an ideal adc .",
    "if we define the fourier transform in voltage domain by is the fourier - conjugate variable of @xmath50 , and is accordingly measured in @xmath51volts@xmath3 . ]",
    "@xmath52 and apply it to eq.([eq.9 ] ) , the following ensues : @xmath53    the quantisation error for an ideal adc ( a sawtooth waveform of amplitude @xmath40/2 see figure  [ sawtooth ] ) is a periodic function of @xmath50 with period @xmath40 .",
    "it can be expanded in fourier series : @xmath54 and its fourier transform is @xmath55 where @xmath56 is dirac s @xmath57-function . if we consider zero - mean gaussian noise as the dither voltage , its pdf and its fourier transform are , respectively , @xmath58   { \\cal p}(\\xi ) & = & e^{-\\sigma^2\\xi^2/2 }   \\label{dith.fourier}\\end{aligned}\\ ] ] where @xmath59 is the dither variance .",
    "substituting now eqs .",
    "( [ qwx ] ) and  ( [ dith.fourier ] ) into eq .",
    "( [ dith.1 ] ) and taking the modulus , we obtain @xmath60    from eq .",
    "( [ dith.eq ] ) we note that the gaussian dither signal , @xmath44 , low - pass filters the quantisation error see figure  [ dither1 ] , top . for instance , for @xmath61=@xmath40 the attenuation of",
    "the first term in the series is 2.7@xmath62@xmath63 . in our case",
    ", we have a 16-bit adc with @xmath19=10v , _",
    "quasi_-white noise at the input of the adc of @xmath64@xmath0vhz@xmath1 and a noise - equivalent bandwidth ( nebw ) of 1.2@xmath65=600hz , where @xmath65 is the cut - off frequency of the anti - alias filter  @xcite .",
    "thus , @xmath40 and @xmath61 are readily calculated , i.e. , @xmath66   \\sigma & = & s^{1/2}_{v}(\\omega)\\times(1.2\\,f_{\\rm cut - off})^{1/2 } =   0.17\\,{\\rm mv } \\end{aligned}\\ ] ]    in our specific case , @xmath67 , hence the quantisation noise from the ideal adc should be suppressed by the inherent noise of the analog processing chain which acts as a filter to the ideal quantisation error .",
    "this can be very clearly seen in figure  [ dither1 ] , top , which shows the errors of an ideal adc ( vertical lines ) alongside the equivalent low - pass filter profile ( dashed trace ) achieved by means of gaussian dither with @xmath61=@xmath40 .",
    "the error of a real adc is formed by the ideal quantisation error function see eq .  ( [ qideal]) plus a term related to the non - idealities of the adc see figure  [ sawtooth ] .",
    "thus , @xmath68 where @xmath69 and @xmath70 are the ideal quantisation error and the quantisation error due to the faulty bits , respectively .",
    "as seen in the previous section , the ideal quantisation error is filtered out by the analog noise in the measurement chain , which acts as a dither signal of gaussian pdf . instead , the quantisation error due to the non - ideality of the adc is not reduced by the same analog noise , which causes it to show up as extra noise . in this section",
    "we show how it can be identified in the temperature measurements , and how it limits the performance of the system .",
    "the modulus of the fourier transform of the non - ideal noise for a single defective bit , @xmath71 , say , is  @xcite @xmath72 where @xmath38 is given in eq .",
    "( [ epsilon ] ) .",
    "the effect of gaussian dither on @xmath70 is readily calculated with eq.([dith.1 ] ) : @xmath73    equations  ( [ qq ] ) and  ( [ qqq ] ) are plotted in figure  [ dither1 ] ( centre and bottom ) .",
    "the plot in the centre corresponds to errors associated to @xmath37=0 , i.e. , the lsb . here , the fundamental period is @xmath74 .",
    "the plot in the bottom shows the same for @xmath37=3 ( the 4-th bit ) with a fundamental period of 16@xmath40 . for each plot ,",
    "the low - pass filter generated by gaussian dither of @xmath61=@xmath40 is also plotted ( dashed lines ) .",
    "it can be noticed that this dither signal suffices to suppress the noise associated to a faulty lsb , @xmath37=0 ( this corresponds to the dnl effect which , is readily mitigated ) .",
    "however , it can not attenuate the low frequency lines due to errors in the higher bits .",
    "in fact , when @xmath37=3 the dithering with @xmath61=@xmath40 is clearly insufficient .    .",
    "centre : quantisation error for a real adc with @xmath37=0 as the faulty bit .",
    "the error is @xmath75=0.5@xmath40 .",
    "bottom : same as previous but for @xmath37=3 .",
    "the error is @xmath76=0.5@xmath40 .",
    "note that the @xmath77-axis scale of the bottom plot is different from the top and middle ones ; for instance , the main frequency for @xmath78 is @xmath79 , while that for @xmath80 is @xmath81 .",
    "this means that errors in the higher bits show up at lower frequencies than those due to errors in the lsb .",
    "[ dither1 ] ]    from figure  [ dither1 ] we note how faulty bits introduce spectral components in the measurement if the signal spans a large enough fraction of the range of the adc transfer curve .",
    "conversely , if the input signal is a constant _ dc _ then no extra noise will be seen , since no bit , whether faulty or not , will change its state .",
    "therefore , the inl effect becomes perceptible in our system only when the input signal runs through a sufficiently wide fraction of the adc range .",
    "as we have just seen , when the input signal , @xmath46 , is not a _ dc _ constant ( e.g. , a ramp ) , the errors related to the inl of the adc tend to introduce low frequency noise components which degrade the performance of the system .",
    "in fact , this is seen to happen in our device for voltage variations in the order of few milli - volts . moreover , if the input signal changes rate , i.e. , @xmath82 then the frequency components introduced by the inl errors spread across the frequency band .    in order to deal with non - constant signals and to estimate inl induced noise ,",
    "a simplification is expedient .",
    "first , let us assume the input signal is a straight line for a certain time interval , i.e. , @xmath83   0 \\ \\ & { \\rm if}\\ \\",
    "t\\leq 0\\ \\ { \\rm or}\\ \\ t > t_{\\rm max } \\end{array}\\right .   \\label{eq.11}\\ ] ] where @xmath84 is the initial value of the signal @xmath85 , and @xmath86 is the slope of the input signal ( vs@xmath3 ) .",
    "if we note @xmath87 the usual time - frequency fourier transform of the non - ideal quantisation noise , it immediately follows from eq .",
    "( [ eq.11 ] ) that @xmath88    in this case , eq .",
    "( [ qq ] ) becomes @xmath89 and the main frequency component for an adc with an error in the @xmath37-th bit is located at @xmath90    before we proceed further , a technical comment is in order .",
    "in several equations above , dirac @xmath57-functions appear .",
    "they are the result of infinite length integration intervals in fourier transform calculations , which are of course idealisations . in any practical situation ,",
    "such intervals are limited to the experimentally available data ranges , so that the @xmath57-functions are actually sinc - functions : they have identical centre points but spread around those centres depending on the integration interval lengths . in order to make sense of e.g.  eq .",
    "( [ q1 ] ) we must ask which is the minimum required integration time to obtain a meaningful spectrum or , in other words , which is the minimum duration , @xmath91 of the ramp signal in eq .",
    "( [ eq.11 ] ) .",
    "this is easily inferred from the frequency of the lowest spectral line @xmath92 in eq .",
    "( [ w1k ] ) : for a conventional ten cycle integration time we get @xmath93    these considerations apply to the analysis of the adc response to signals which drift slowly with time , where _ slow drift",
    "_ means such signals can be conveniently approximated by a series of concatenated ramps with suitable slopes , and lengths complying with eq.([eq.13 ] ) . in these circumstances",
    ", we can generalise eq .",
    "( [ w1k ] ) as follows : @xmath94    from eqs .",
    "( [ w1k ] ) and  ( [ dw ] ) some conclusions can be drawn :    * high - slope signals at the adc input translate into high - frequency components at the output of the adc .",
    "* errors in the higher bits show up as noise at low frequency . * consequently , high - slope input signals combined with errors in high bits may show as noise peaks in the measurement bandwidth . *",
    "the fundamental frequency associated to a faulty bit varies with the variations of @xmath95 , hence the error in a faulty bit spreads across the frequency band when @xmath82 .",
    "the above can be validated by looking at real data from our ltp temperature measurement system .",
    "we took a long time series of temperature data , about 4@xmath6210@xmath96  seconds , and subdivided it into shorter stretches of @xmath516000  seconds . with this",
    ", we calculated the short - time fourier transform ( stft )  @xcite , also known as _ spectrogram _ , and plotted the results as shown in figure  [ spec1 ] see caption for details . the data are amenable to the analysis described above , and the results indicate the presence of the foreseen frequency peaks associated to faulty bits .",
    "they are clearly visible in figure  [ spec1 ] , bottom graph , as the darker areas , which show how the fundamental frequency of the inl errors for different faulty bits is varying with time , and accurately tracing the @xmath97 curve shown on the top left plot . a straightforward fit to the first equation  ( [ dw ] ) permits the identification of the corresponding faulty bit , thus confirming that the extra noise in the temperature measurements is indeed due to the inl errors of the adc .    , of the measurement .",
    "it varies between 0 and 12.5@xmath0vs@xmath3 .",
    "the sensitivity at the input of the adc is @xmath981.35vk@xmath3 , hence the values of the voltage slope almost directly provide the actual temperature drifts in [ ks@xmath3 ] .",
    "top right : power spectral density for : ( i ) the signal shown in the top left plot , i.e. , a non-_dc _ signal ( solid black trace ) and , ( ii ) a _ dc _ signal ( dashed red trace ) , i.e. , with @xmath100@xmath0vs@xmath3 . the excess noise when measuring non - constant signals is very noticeable , and degrades the performance of the measurement by about one order of magnitude .",
    "bottom : stft ( or spectrogram ) of the measurement .",
    "the energy of the signal is concentrated in specific frequencies which change with time precisely following @xmath101 , as predicted by eq.([dw ] ) .",
    "the latter is represented by dashed superimposed traces , and are labelled by the order of the corresponding faulty bit ( from @xmath37=2 to @xmath37=7 ) .",
    "experimental results and theoretical estimates are in excellent agreement .",
    "[ spec1 ] ]    once the problem has been identified , we focus on possible solutions to fix it .",
    "the following section describes two different methods tested successfully to avoid the consequences of inl errors in real adcs .",
    "two different techniques have been used to deal with the non - linearities of the adc .",
    "the first is based on the injection of gaussian noise out of the mbw , taking advantage of the oversampling involved in the measurement .",
    "the second is based on the addition of a triangular wave of high frequency to the signal quantised by the adc  @xcite .",
    "the following sections describe both techniques as well as their practical implementation .",
    "in section  [ dither.section ] we saw that gaussian noise can be used as a dither signal in order to mitigate the non - idealities of the adc transfer curve .",
    "we have also seen that the amount of noise generated by the measurement system itself ( @xmath61@xmath98@xmath40 ) is not enough to suppress the periodic components of erroneous bits for @xmath37@xmath1022 see fig .",
    "[ spec1 ] .",
    "thus , a natural solution is to add more gaussian noise to the adc input .",
    "obviously , this noise should be added out of the mbw in order not to disturb the frequency range of interest , which is in the milli - hertz range .",
    "the adc sampling frequency is 38.4khz , thus leaving a large frequency slot to accommodate the required additional noise .",
    "care must however be taken to also place it away from the fundamental frequency of the modulating square wave ( and its harmonics ) so as to avoid bringing the gaussian noise back into the mbw in the demodulation process .",
    "the required amount of noise to be injected , characterised by @xmath61 , basically depends on the input signal slope , @xmath95 , and on the frequencies of interest , and is limited by the digital processing performed after quantisation see below .",
    "figure  [ slope1 ] shows the relationship between the input signal slope and the main frequency component for each of the faulty bits .",
    "it is useful to identify the faulty bits potentially affecting the measurement as a function of the input signal drifts .",
    "-th bit . when high input signal slopes are present , more faulty bits will affect the measurement quality in the mbw .",
    "clearly , lsbs show up at higher frequencies than msbs .",
    "the shaded areas span the mbws of lisa ( green ) and lpf ( yellow ) , as indicated .",
    "note that lpf s mbw is a sub - region of lisa s .",
    "[ slope1 ] ]    once the problematic bits are identified , the needed amount of gaussian dither must be calculated . for this , we define the @xmath61 needed to filter out the noise components associated to the @xmath37-th faulty bit . if we ( conventionally ) adopt a damping factor of 10 for the first harmonic then @xmath61 is easily derived from the condition ( see eq .",
    "( [ qqq ] ) ) @xmath103 whence @xmath104      in this section we briefly describe the hardware implementation of the gaussian dithering scheme .",
    "the circuit diagram is given in fig .",
    "[ noisegen_circuit ] : the first stage amplifies the noise of an operational amplifier ( op-07  @xcite ) ; the second stage is a high - pass filter of  4-th order ( two sallen - key filters in cascade ) with a cut - off frequency of  100hz ; the third stage is an adder that sums the signal of interest ( the amplified output of the wheatstone bridge ) to the dither signal . in the fourth stage ,",
    "the sum of signal and dither are low - pass filtered with a  4-th order low - pass filter ( again , two sallen - key filters in cascade ) with cut - off frequency  3khz .",
    "the output of this chain is fed to a  16-bit sar adc .",
    "the noise shape of the dither signal is given in fig .",
    "[ noisegen ] ( solid trace ) where the characteristic frequencies of the high- and low - pass filters are clearly visible .    .",
    "@xmath85 is the amplified signal from the wheatstone bridge see figure  [ fee.proc ] .",
    "@xmath105 is the dither signal before low - pass filtered .",
    "[ noisegen_circuit ] ]    as mentioned in section  [ fee.description ] , the amount of gaussian dither must be kept under control to avoid excessive noise folding back into the mbw during the digital demodulation stage .",
    "the limit of the usable gaussian noise amplitude , @xmath61 , can be easily estimated assuming a flat spectrum , @xmath106 , from @xmath107 ( the corner frequency of the high - pass filter ) to @xmath108 ( the corner frequency of the low - pass filter ) .",
    "the demodulation by a square wave of frequency @xmath12 entails a certain gain at _ dc _ of the odd harmonics of @xmath12 of the dither noise which , under the just mentioned assumption , results in the following  @xcite : @xmath109 where @xmath110 is the _ floor function _ , e.g. , @xmath111 is the largest integer smaller than @xmath112 .    in order to cut down the noise leaking into the mbw , i.e. , at _ dc _ in practice , we again impose a requirement that it be less than 10% of the floor noise in the absence of adc errors , @xmath113 , i.e. , @xmath114    in our case , @xmath115hz , @xmath116khz , and @xmath117hz , so that the @xmath118-sum in eq .",
    "( [ sdc ] ) is approximately 0.015 , hence @xmath119@xmath980.015@xmath120 .",
    "the value of @xmath113 is @xmath121v@xmath122hz@xmath3 in the mbw . the maximum value for @xmath123 compliant with the criterion eq .",
    "( [ eq.15 ] ) is therefore @xmath124v@xmath125hz@xmath3 , which corresponds to @xmath1260.5 mv .    .",
    "the central plateau corresponds to @xmath61=3mv see section  [ t.r ] .",
    "the dashed black trace is the floor noise of the measurement system itself , prior to demodulation  @xcite .",
    "[ noisegen ] ]    in section  [ results ] , we present the tests and results obtained with this technique .",
    "another implemented and tested technique consists in using a deterministic signal instead of random gaussian noise as the dither signal .",
    "different signals can be used for this purpose , but for simplicity we have used a triangular wave form in the generation of the signal see below . in this section",
    "we describe the theoretical basis and the hardware implementation details .",
    "the dither signal is now a triangular wave , which can be represented by the fourier series @xmath127 where @xmath128 and @xmath129 are the amplitude and the frequency of the triangular wave , respectively see fig .",
    "[ triangular.scheme ] .",
    "its pdf is  @xcite @xmath130   0 & d<0 \\",
    "{ \\rm and } \\",
    "d > d_{\\rm o }   \\end{cases}\\ ] ] whose fourier transform is @xmath131    as shown in section  [ problem ] , the averaged quantisation error is @xmath132    eq .  ( [ dith.triang.eq ] )",
    "is graphically evaluated in figure  [ triangular.dither ] for different faulty bits and triangular wave amplitudes .",
    "= 0 , @xmath133 , and the low - pass filter when using a triangular wave as the dither signal with @xmath134 .",
    "centre : same as above for an error in bit @xmath37=3 , @xmath135 .",
    "bottom : same as above but with @xmath136 instead of @xmath74 .",
    "note that @xmath112-axis scales are different for @xmath137 and @xmath138 .",
    "[ triangular.dither ] ]    like we did with the gaussian noise , we can give an expression to determine the required triangular wave amplitude , @xmath128 , to attenuate the effect of the @xmath37-th bit : @xmath139    there is no closed form solution to eq .",
    "( [ sinx.x ] ) for the amplitude of the triangular wave , which requires numerical evaluation in each specific case .",
    "the amplitude @xmath128 needed to attenuate the errors coming from the @xmath37=6 bit is @xmath520mv .",
    "figure  [ triangular.scheme ] shows the triangular wave added to the system .",
    "it is important to note that the addition of the triangular signal will not perturb the temperature measurement within the mbw .",
    "the digital demodulation involved in the measurement see sec .",
    "[ fee.description] is done by averaging 6144 samples : 3072 during one polarity and 3072 during the opposite polarity .",
    "afterwards they are subtracted and divided by 2 .",
    "thus , if we inject exactly the same signal in both polarities the net contribution of the added dither signal to the output is zero see eq .",
    "( [ vo ] ) .    ]    the output signal after the digital processing is @xmath140-[\\bar{v}_{\\rm neg}(t )   + \\bar{d}(t)]}{2 } =   \\frac{\\bar{v}_{\\rm pos}-\\bar{v}_{\\rm neg}}{2 }   \\label{vo}\\ ] ] where @xmath105 is the triangular wave see fig .",
    "[ triangular.scheme] and an overbar (  @xmath141  ) means average over 3072 samples .",
    "( [ vo ] ) indicates that there is no limit on the amplitude of the triangular dither , provided triangular waves in both polarities are identical .",
    "therefore that non - linearities of msbs can be reduced without degrading the measurement .",
    "this happens for an analog dither signal , but ours is actually generated with a dac , which imposes some limits on the validity of the previous statement see below .",
    "the circuit which implements the triangular signal is shown in figure  [ triangular.circuit ] , and consists in an 8-bit up - and - down counter followed by a 12-bit dac where only the 8 lsbs are used .",
    "the circuit is configured such that the quantisation step of the dac closely matches that of the 16-bit adc .",
    "mismatches here result in actual performance diverging from the predictions of the theoretical analysis described above .",
    "the output signal from the dac is added to the signal of interest and both are low - pass filtered ( a 4-th order sallen - key filter with a cut - off frequency of 3khz ) , then quantised by the 16-bit sar adc .",
    "the triangular wave is low - pass filtered to eliminate high - frequency components related to the digital quantisation of the dac . nevertheless , the previous analysis is still valid since the fundamental frequency of the triangular wave is 50hz and the low - pass filter cut - off frequency is 3khz .",
    "thus , the dither signal will go almost unaltered through the filter ( except for some distortion in its high - frequency components ) .     is the amplified output signal of the wheatstone bridge .",
    "@xmath105 is the triangular wave .",
    "[ triangular.circuit ] ]",
    "both methods described in section  [ mitigation ] have been put to test . for comparison , a 24-bit delta - sigma adc ( ltc2440  @xcite ) which , in principle , should exhibit less non - linearity problems , has also been tested .",
    "the two dither techniques under study have been tested using exactly the same electronics , the same 16-bit sar adc ad977  @xcite , and under the same input signal conditions . in this section",
    "first we give a brief description of the test set - up and , then , the obtained results are presented .",
    "the test set - up is composed by different parts .",
    "temperature sensors are placed inside a thermal insulator designed to screen out ambient temperature fluctuations to the required level in the mbw , i.e. , @xmath142@xmath0khz@xmath1 for @xmath143mhz  @xcite .",
    "a temperature control is included to implement different temperature profiles inside the insulator ; basically , a set of temperature ramps with different slopes is generated in order to assess whether or not the methods to overcome the inl errors of the adc work see figure  [ profile.experimental ] .",
    "the temperature control consists in a heater commanded by a programmable power supply which is in turn controlled by the computer calculated value of the difference between the desired temperature and the actual measurement see figure  [ setup.fig ] .    ]",
    "the nominal and actual profiles are shown in figure  [ profile.experimental ] .",
    "the experiment has been repeated for the two dithering techniques , and for the 24-bit delta - sigma adc as well .",
    "prior to that , the 16-bit sar adc with no dither signal was tested in order to provide a reference measurement with the inl effects in it .    )",
    "temperature profiles .",
    "bottom : time derivative of the signals shown in the top plot .",
    "tested slopes are : 0.5 , 1 , 2 , 4 , 8 and 16@xmath0ks@xmath3 .",
    "[ profile.experimental ] ]      the power spectral density in the different tested configurations ( no dither , gaussian noise , triangular wave and 24-bit delta - sigma adc ) are given in fig .",
    "[ plot.paper ] for three different slopes , more specifically , for 1 , 4 and 8@xmath0ks@xmath3 .",
    "the measurements performed with the 16-bit sar adc are clearly affected by the inl errors when no dither signal is used .",
    "the noise in the mbw increases by more than one order of magnitude when slopes are around 1@xmath0ks@xmath3 and above .",
    "figure  [ plot.paper ] shows how the inl errors appear in the mbw , spanning wider frequency regions as slopes increase , thus confirming the predicted behaviour .",
    "for instance ,",
    "when the slope is 4@xmath0ks@xmath3 the inl effect is only noticeable at frequencies below 6mhz , while for a slope of 8@xmath0ks@xmath3 the noise appears at frequencies as high as 10mhz .    when the dither signal is gaussian noise , the inl effects can be satisfactorily reduced down to 1mhz for drifts under  8@xmath0ks@xmath3 .",
    "looking up figure  [ slope1 ] , we see that faulty bits up to @xmath37=5 will create additional noise in the band .",
    "then , using eq .",
    "( [ sigma.req ] ) , we find that the necessary dither requires @xmath61@xmath9822@xmath40 , or @xmath61@xmath983mv .",
    "this is however a factor of 6 larger than the maximum estimated after eq .",
    "( [ eq.15 ] ) , which means some extra noise will be added to the system floor noise , if we insist on applying a @xmath61=3mv dither , as discussed in section  [ hw.dither ] .",
    "we did take this option , with the result that the floor noise becomes a factor @xmath51.5 larger than nominal [ in good agreement with predictions calculated using eq .",
    "( [ sdc ] ) ] , with the advantage that good damping of the adc s inl errors obtains .",
    "ks@xmath3 . in absence of dither , the noise of the adc increases ( in amplitude and bandwidth ) with the slope of the input signal .",
    "the solutions adopted work satisfactorily for slopes up to @xmath58@xmath0ks@xmath3 level . the 24-bit sigma - delta",
    "does not exhibit non - linearity problems for the tested slopes .",
    "see text in section  [ t.r ] for details .",
    "[ plot.paper ] ]    the use of a triangular wave as the dither signal appears as the most robust option to deal with the non - idealities of the adc : on the one hand , the floor noise is left untouched and , on the other hand , immunity to faulty bits and high signal slopes can be tuned essentially at will .",
    "the 24-bit delta - sigma adc exhibits a behaviour similar to that observed in the measurements performed by the 16-bit adc with added dither signals .",
    "non - linearity errors in this adc are not noticeable when measuring signals drifting up to  8@xmath0ks@xmath3 .",
    "the generated triangular wave had the following properties : @xmath128=155mv and a period of 20ms , which is an integer sub - multiple of the duration of each polarity ( 80ms ) see figure  [ triangular.scheme ] .",
    "this amplitude is almost 8 times higher than the one estimated towards the end of section  [ dither.det ] ( 20mv ) to attenuate errors up the @xmath37=6  bit .",
    "this means that immunity to faulty bits under higher temperature drifts is accomplished .",
    "figure  [ plot.b1 ] provides a clear display of the superiority of triangular wave over gaussian noise dither .",
    "@xmath1445 whereas the triangular wave attenuates the error in the bits @xmath37@xmath1449 .",
    "[ plot.b1 ] ]    summing up , figure  [ plot.paper ] confirms the analysis in this paper , and shows that when slopes of @xmath510@xmath0ks@xmath3 are present , the effects of the non - idealities can be made negligible by use of proper dither . for higher slopes , e.g. , 16@xmath0ks@xmath3",
    ", some increase in the power spectrum near one milli - hertz is detected .",
    "we believe this is probably due to the relative simplicity of the model used .",
    "further research is ongoing to clarify these matters .",
    "nevertheless , such drifts look unlikely both in lisa and lpf .",
    "temperature diagnostics measurements in lisa and lisa pathfinder must meet very demanding requirements : very low noise , a few @xmath0khz@xmath1 , and very low frequency band , below 1 hz and down to fractions of a milli - hz .",
    "after a suitable measurement system was in place , extra noise was seen to appear at the lower end of the mbw when slowly drifting temperatures were measured . for temperature slopes",
    "higher than @xmath50.5@xmath0khz@xmath1 this extra noise challenges the performance of the ltp measuring system , the problem growing more severe at lower frequencies , down into the submilli - hertz lisa band .",
    "the source of the noise has been investigated and identified as due to the inl effects of the adc , which is a 16-bit sar adc .",
    "we have laid down the theoretical basis of the problem , which has been validated by laboratory experiment .",
    "once the problem is well understood , it needs to be solved .",
    "two different options to mitigate this effect have been proposed , analysed and tested .",
    "both are based on the addition of a dither signal to the signal of interest prior to the adc quantisation . in one of them ,",
    "we use gaussian noise , which certainly reduces the inl error effects of the adc , although in our case its performance is limited by the the digital processing which sets an upper limit on the noise amplitude , @xmath61 , which can be injected in the measurement . alternatively ,",
    "dithering with a triangular wave does not add noise in the mbw , and generally results in a more efficient attenuation of inl errors .",
    "a 24-bit delta - sigma adc has been used for comparison , with the result that a 16-bit adc plus averaging ( to increase the resolution ) and proper dither reaches the same performance as a 24-bit delta - sigma adc .",
    "summing up , a robust method to suppress the inl errors of the adc in the temperature measurement system of the lpf mission has been presented in this paper .",
    "such a system is not foreseen to fly in lpf , but the results obtained herein are important in view of the lisa mission which will need similar ( or even higher ) precisions at lower frequencies .",
    "the method we have described is also useful for other subsystems of lisa where adc non - linearities appear as a limitation in the performance of the measurement system ."
  ],
  "abstract_text": [
    "<S> low - noise temperature measurements at frequencies in the milli - hertz range are required in the lisa ( laser interferometer space antenna ) and lisa pathfinder ( lpf ) missions . </S>",
    "<S> the required temperature stability for lisa is around 10@xmath0khz@xmath1 at frequencies down to 0.1mhz . in this paper </S>",
    "<S> we focus on the identification and reduction of a source of excess noise detected when measuring time - varying temperature signals . </S>",
    "<S> this is shown to be due to non - idealities in the adc transfer curve , and degrades the measurement by about one order of magnitude in the measurement bandwidth when the measured temperature exhibits drifts of @xmath2ks@xmath3 . in a suitable measuring system for the lisa mission , </S>",
    "<S> this noise needs to be reduced . </S>",
    "<S> two different methods based on the same technique have been implemented , both consisting in the addition of dither signals out of band to mitigate the adc non - ideality errors . </S>",
    "<S> excess noise of this nature has been satisfactorily reduced by using these methods when measuring temperature ramps up to 10  @xmath0ks@xmath3 . </S>"
  ]
}