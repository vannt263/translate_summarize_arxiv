{
  "article_text": [
    "dissipative particle dynamics ( dpd )  @xcite is a particle - based coarse - grained model in which atoms , molecules or even groups of molecules are represented by a single mesoscale dpd particle .",
    "the time evolution of the mesoscale particles is governed by a stochastic differential equation .",
    "dissipative and random forces allow to take into account some effect of the missing degrees of freedom .",
    "dpd was put on a firm theoretical ground in  @xcite .",
    "however , it is intrinsically is an equilibrium model , with a prescribed temperature , and can not be used as such to study nonequilibrium systems .",
    "it should be replaced by a dynamics where the fluctuation / dissipation relation is based on variables which evolve in time .",
    "dpd with conserved energy ( dpde ) is such a model  @xcite . in the dpde framework , mesoparticles have an additional degree of freedom , namely an internal energy , which accounts for the energy of the missing degrees of freedom . the dynamics on the internal energies is constructed in order for the total energy of the system to remain constant .",
    "dpde was initially used for thermal transport  @xcite , and later on to simulate shock and detonation waves  @xcite .    while numerous efficient schemes were developed for dpd",
    "( see for instance  @xcite for a review and careful comparison of various schemes ) , the efficient numerical integration of dpde still requires some effort .",
    "one appealing framework to integrate dpde , as considered in  @xcite for instance , is based on the so - called shardlow splitting algorithm ( ssa ) for dpd  @xcite .",
    "it consists in decomposing the dynamics into a hamilonian part and pairwise elementary dynamics - either fluctuation / dissipation or thermal conduction .",
    "there is a consensus on the integration of the hamiltonian part , for which a verlet scheme  @xcite should be used .",
    "there is on the other hand no definite way of integrating the fluctuation / dissipation and thermal conduction parts , even when they are split into elementary pairwise dynamics . in particular , to the author s knowledge , for all the numerical schemes currently used , it is observed that negative internal energies may appear when the fluctuation terms are large compared to the heat capacity .",
    "this sometimes puts a severe constraint on admissible timesteps .",
    "this issue has been explicitly acknowledged by various researchers  @xcite ( and hidden under the rug by others ) , but no satisfactory answer was found yet .",
    "better integration schemes can be obtained by a dedicated treatment of the elementary fluctuation / dissipation and thermal conduction dynamics , instead of resorting to general purpose integration schemes such as euler  maruyama .",
    "the key observation is that the seemingly @xmath0-dimensional elementary fluctuation / dissipation dynamics can be reduced to an effective one - dimensional dynamics , which can be integrated with a high precision and/or stabilized by a metropolis ",
    "hastings acceptance / rejection procedure  @xcite .",
    "in particular , the metropolis procedure automatically corrects for negative internal energies .",
    "a similar reduction can be performed to obtain an effective one - dimensional dynamics for the elementary pairwise thermal conduction , which is a priori of dimension  2 .",
    "this article is organized as follows .",
    "dpde and the general splitting strategy for its numerical discretization are recalled in section  [ sec : dpde ] .",
    "section  [ sec : metropolis ] is the core of this work : it is shown there how to numerically integrate elementary pairwise stochastic dynamics in order to exactly sample the invariant measure of dpde .",
    "the resulting numerical method is tested on various systems in section  [ sec : numerics ] .",
    "section  [ sec : ccl ] gathers the conclusions and some perspectives of this work .",
    "the governing equations of dpde are recalled in section  [ sec : equations_dpde ] , while section  [ sec : microeos ] discusses microscopic equations of state which allow to model temperature - dependent heat capacities ( some technical derivations being postponed to the appendix ) . a general framework for the numerical integration of dpde",
    "is finally presented in section  [ sec : splitting ] .      in dissipative particle dynamics with energy conservation ,",
    "the variables describing the state of the system are the positions @xmath1 of the @xmath2 particles , their associated momenta @xmath3 and the corresponding internal energies @xmath4 .",
    "the positions @xmath5 belong to a position space @xmath6 ( typically , a simulation box with periodic boundary conditions ) , the momenta @xmath7 can assume any value in @xmath8 ( with @xmath9 the physical dimension ) , while the internal energies @xmath10 are scalar variables which should remain non - negative . denoting by @xmath11 the potential energy of the system , the evolution of the variables @xmath12 is governed by the following equations  @xcite : @xmath13 , \\\\",
    "d{\\varepsilon}_{i } & = \\sum_{i \\neq j } \\frac{\\chi^2(r_{ij})}{2 } \\left [ \\gamma({\\varepsilon}_i,{\\varepsilon}_j)\\big(e_{ij } \\cdot v_{ij } \\big)^2 - \\frac{\\sigma^2}{2 } \\left(\\frac{1}{m_i}+\\frac{1}{m_j}\\right)\\right]dt - \\frac{\\sigma}{2 } \\chi(r_{ij } ) \\big(v_{ij } \\cdot e_{ij}\\big ) dw_{ij } \\\\ & \\ \\",
    "+ \\sum_{i \\neq j }   \\kappa \\chi^2(r_{ij } ) \\left(\\frac{1}{t_i({\\varepsilon}_i)}-\\frac{1}{t_j({\\varepsilon}_j ) } \\right ) dt + \\sqrt{2\\kappa}\\chi(r_{ij } ) \\ , d\\widetilde{w}_{ij } ,      \\end{aligned } \\right.\\ ] ] where @xmath14 is the mass of the @xmath15th particle , @xmath16 is the unit vector in the direction  @xmath17 , @xmath18 is a cut - off function , @xmath19 and @xmath20 are two families of independent standard one - dimensional brownian motions with @xmath21 and @xmath22 for @xmath23 .",
    "the fluctuation magnitude @xmath24 and the thermal conductivity @xmath25 are fixed ( although they could depend on the particle pair ) .",
    "it can be shown that the dynamics preserves the total momentum and the total energy , sum of the mechanical energy  @xmath26 and of the internal energy : @xmath27 this is discussed more precisely in section  [ sec : splitting ] , where it is shown that the complete dpde evolution can be separated into elementary dynamics which all preserve the total energy  @xmath28 . moreover , the friction is taken as @xmath29,\\ ] ] where the internal temperatures @xmath30 are obtained from microscopic entropy functions @xmath31 ( which can be different for different particles , as emphasized by the notation ) as @xmath32 see section  [ sec : microeos ] below for further precisions on the micro - equation of state ( eos ) @xmath31 .",
    "the choice   ensures that , for any given energy level @xmath33 , the following measure is invariant by the dynamics : @xmath34 here again , this preservation is ensured by the fact that each elementary dynamics preserves  @xmath35 ; see again section  [ sec : splitting ] .",
    "the invariant measure @xmath35 is equivalent , in the thermodynamic limit , to the canonical measure @xmath36 where @xmath37 is such that the average energy under the canonical measure is equal to the prescribed energy level : @xmath38 .",
    "one key ingredient in dpde is the micro - eos which relates the entropy and the internal energy . with some abuse of notation ,",
    "any of the internal energies @xmath39 is simply denoted by @xmath40 in this section . in general ,",
    "the internal temperature @xmath41 associated with an internal energy @xmath40 is implicitly defined from the internal energy  @xmath40 via the relation @xmath42 moreover , the marginal of the canonical measure   in the variable  @xmath40 reads @xmath43      the classical micro - eos corresponds to a constant heat capacity , in which case @xmath44 and @xmath45 where @xmath46 is some reference energy .",
    "more realistic models , fitted on ab - initio simulations , require a genuinely temperature - dependent heat capacity .",
    "stability issues for the numerical integrators may be magnified in these cases .",
    "the next sections introduce empirical models taking into account some temperature dependence , which are relevant to test the robustness of the numerical scheme for general micro - eos .      a first model for temperature - dependent heat capacities is obtained from the einstein model of harmonic oscillators , already considered in  @xcite . a full derivation of the equations presented in this section is given in the appendix",
    "the einstein model corresponds to the following micro - eos : @xmath47,\\ ] ] where @xmath48 is some reference temperature , and @xmath49 the limiting heat capacity for large temperatures .",
    "the classical micro - eos   is recovered in the limit @xmath50 ( up to an unimportant additive constant ) .",
    "the internal temperature associated with   reads ( see  ) @xmath51 while the associated heat capacity is ( see  ) @xmath52 see figure  [ fig : einstein ] for plots of the associated distribution of internal energies , and of the heat capacity as a function of the temperature .",
    "note that , in practice , only @xmath53 and @xmath54 are needed to integrate the dynamics .",
    "the heat capacity is useful only for physical interpretation .    , for various choices of entropy functions ( in reduced units where @xmath55 and @xmath56 ) .",
    "right : associated heat capacities .",
    "classical refers to   with @xmath57 , einstein to   with @xmath57 and @xmath58 , blended to   with @xmath57 , @xmath59 and @xmath58.,title=\"fig:\",scaledwidth=50.0% ] , for various choices of entropy functions ( in reduced units where @xmath55 and @xmath56 ) .",
    "right : associated heat capacities .",
    "classical refers to   with @xmath57 , einstein to   with @xmath57 and @xmath58 , blended to   with @xmath57 , @xmath59 and @xmath58.,title=\"fig:\",scaledwidth=50.0% ]    an important point is that the definition of the thermodynamic temperature has to be changed since @xmath53 does not tend to @xmath60 as @xmath61 .",
    "one estimator of the internal temperature is for instance @xmath62 where @xmath63 refers to averages with respect to the marginal measure  .",
    "in fact , there is whole family of temperature estimators , see   in the appendix for further precisions .",
    "the internal entropy in the einstein model is such that the marginal measures @xmath64 have non - zero finite values at @xmath65 .",
    "this may lead to thermodynamic inconsistencies in the model .",
    "it seems more appropriate to consider a model micro - eos which ensures that the marginal measure vanishes at @xmath65 , so that negative energies can not appear for the continuous dynamics .",
    "the model eos is obtained by adding an einstein contribution ( of maximal value @xmath66 ) to a baseline constant heat capacity @xmath67 .",
    "more precisely , @xmath68.\\ ] ] note that that the corresponding heat capacity @xmath69 is such that @xmath70 and @xmath71 as @xmath72 . for this model , the standard internal temperature estimator @xmath73 can therefore be used ( see   in the appendix ) . figure  [ fig : einstein ] shows a typical distribution of internal energies and the heat capacity associated with the model .",
    "since there is no closed form expression for the latter quantity , the picture has been obtained by plotting @xmath74 as a function of @xmath75 , relying on  .",
    "when the timestep @xmath76 is fixed , a numerical integration of stochastic dynamics such as dpde consists in finding an iteration rule to pass from @xmath77 , an approximation of the solution @xmath78 of   at time @xmath79 , to an approximation at the next timestep , namely @xmath80 .",
    "the strategy developped here consists in integrating successively the various subparts of the dynamics .",
    "dpde can be decomposed into several elementary dynamics :    a.   the first one is the hamiltonian part @xmath81 which preserves the mechanical energy @xmath82 ( and hence the total energy  @xmath28 ) , as well as the measure  .",
    "b.   the second family of elementary dynamics are the pairwise fluctuation / dissipation dynamics @xmath83dt - \\frac{\\sigma}{2 } \\chi(r_{ij } ) \\big(v_{ij } \\cdot e_{ij}\\big ) dw_{ij } , \\\\",
    "d{\\varepsilon}_j & = d{\\varepsilon}_i .",
    "\\end{aligned } \\right.\\ ] ] the evolution of @xmath84 is in fact fully determined by the requirements that @xmath85 and the elementary energy @xmath86 be constant ( using some it calculus ) .",
    "it can also be shown that the elementary dynamics   preserves any measure of the form @xmath87 , so that it preserves in particular the measure   and the total energy  @xmath28 .",
    "c.   the third and last family of elementary dynamics are the pairwise elementary conduction dynamics @xmath88 by construction , these subdynamics leave the energy @xmath89 invariant , hence the total energy @xmath28 as well .",
    "in addition , it can also be shown that any measure of the form @xmath90 is invariant , so that   preserves in particular the measure  .      in view of the above physical decomposition of the full dpde",
    ", a numerical integrator can be obtained by composing integrators for all elementary dynamics under consideration  a strategy known as splitting methods . for the hamiltonian part ,",
    "the standard choice is to use the verlet scheme  @xcite , which corresponds to the integrator @xmath91 with @xmath92\\right ) .",
    "\\end{aligned}\\ ] ] integrators for the elementary dynamics   and   are respectively denoted by @xmath93 where fd stands for fluctuation / dissipation and tc for thermal conduction .",
    "note that these integrators depend on certain random numbers : independent gaussian random variables @xmath94 and @xmath95 to discretize the brownian motions @xmath96 and @xmath97 , as well as uniform random variables @xmath98 and @xmath99 which are used to implement a metropolis correction .",
    "if a standard discretization of   and   is considered ( using , say , stochastic runge  kutta methods ) , then no uniform random variable is needed ; on the other hand , several gaussian variables may be required to integrate the dynamics over one timestep .",
    "see for instance to  @xcite for an introduction to numerical schemes for sdes .",
    "one possible scheme is the following . denoting by @xmath100 the range of the cut - off function  @xmath18 , the set of `` active '' pairs for a given set of positions  @xmath101 ( _",
    "i.e. _ the set of pairs for which the elementary dynamics   and   are not trivial ) is @xmath102 a new configuration @xmath80 is then obtained from @xmath77 for instance by the composition @xmath103 which corresponds to first integrating the hamiltonian dynamics with the verlet scheme , then looping over the active pairs to integrate the fluctuation / dissipation , and finally looping again over the active pairs to integrate the thermal conduction .",
    "several comments are in order on this formula .",
    "note first the abuse of notation which consists in not making explicit the actual variables of the various integrators ( sometimes additional variables are considered , such as @xmath104 for the verlet scheme ; while the random variables are omitted ) .",
    "second , note that the only scheme which modifies positions is the verlet scheme , which is why the active pairs are determined based on @xmath105 , the positions coming out of @xmath106 .",
    "last , let us emphasize that the order of integration is somewhat arbitrary : it is equally possibly to finish by the verlet part , and/or to immediately integrate both fluctuation / dissipation and thermal conduction for a given pair in order to avoir looping twice over pairs ; maybe more importantly , it is difficult , if not impossible on modern computing architectures , to assign an order to the way pairs are looped over ( based on , say , lexicographical order ) : when dpde is parallelized as in  @xcite , the order is determined by the spatial decomposition under consideration .",
    "error estimates on average properties can be deduced from the integration errors on each subdynamics , using an analysis similar to the one used for langevin dynamics in  @xcite .",
    "this analysis is made precise in section  [ sec : errors ] , after a description of the integrators @xmath107 and @xmath108 .      as will be made clear in the numerical examples presented in section  [ sec : numerics ] , the stability of splitting schemes such as   is limited in practice by the hamiltonian part of the dynamics , especially when singular interaction potentials ( _ e.g. _ lennard  jones or coulomb ) are considered .",
    "one option in this case is to resort to multiple timestepping strategies , where the hamiltonian part is integrated with a smaller timestep .",
    "the reference timestep for the integration of the hamiltonian part is denoted by @xmath109 .",
    "introducing an integer @xmath110 , the timestep used to integrate the elementary pairwise stochastic interactions is @xmath111 .",
    "this amounts to replacing the integrator in   with @xmath112 note that this scheme still provides a consistent discretization of the original dynamics when @xmath113 is fixed and @xmath114 .",
    "this section presents stable schemes to integrate the elementary pairwise fluctuation / dissipation and thermal conduction dynamics .",
    "the key idea , made precise in section  [ sec : rewriting ] for the fluctuation / dissipation and in section  [ sec : num_tc ] for thermal conduction , is to rewrite the elementary dynamics as effective brownian dynamics of a single variable .",
    "the invariant measure of these dynamics is analytically known in terms of the initial conditions , which allows to correct numerical discretizations by a metropolis ",
    "hastings procedure ( described in sections  [ sec : metropolis_elementary_fd ] and  [ sec : num_tc ] ) .",
    "the metropolis correction both allows to stabilize numerical schemes by automatically rejecting negative energies , and also prevents any bias on the thermodynamic properties .",
    "the error on average properties for the resulting numerical scheme therefore solely arises from the verlet discretization , as made precise in section  [ sec : errors ] .      for notational simplicity ,",
    "consider the elementary fluctuation / dissipation dynamics associated with particles  1 and  2 ( rather than general indices  @xmath15 and  @xmath115 ) : @xmath116dt - \\frac{\\sigma}{2 } \\chi(r_{12 } ) \\big(v_{12 } \\cdot e_{12}\\big ) dw_t , \\\\",
    "d{\\varepsilon}_2 & = d{\\varepsilon}_1 , \\end{aligned } \\right.\\ ] ] where @xmath117 is a standard one - dimensional brownian motion .",
    "recall that the evolution of @xmath118 is in fact fully determined by the requirement that the energy @xmath119 be constant .",
    "it is therefore sufficient to integrate the dynamics on @xmath120 , from which the evolution of all other variables ( namely @xmath121 ) is deduced .    in order",
    "obtain a simplified elementary dynamics , note first that the components of @xmath122 orthogonal to @xmath123 do not evolve in time , and that @xmath124 is conserved .",
    "it is therefore sufficient to determine the evolution of the relative velocity along the lines of centers , namely @xmath125 where @xmath126 the projection of   onto the direction  @xmath123 leads to the following one - dimensional equation for @xmath127 : @xmath128    the second observation is that the energy   is preserved , which , together with the last two lines of  , implies that @xmath129 where the quantities with subscripts  0 indicate initial conditions while quantities without subscripts implicitly indicate values at time  @xmath130 .",
    "now , the momenta @xmath122 can be expressed in terms of their initial values and the current value of the relative velocity @xmath127 .",
    "a simple computation shows that @xmath131 where it was made use of the fact that @xmath132 and @xmath133 are invariants of the elementary dynamics  . for more compact notation ,",
    "introduce the reduced mass @xmath134 plugging   into   allows to write the internal energies as a function of @xmath127 . since @xmath135 it follows that @xmath136 .",
    "\\end{aligned}\\ ] ] therefore , @xmath137 , \\qquad { \\varepsilon}_2 & = { \\varepsilon}_{2,0 } - \\frac{\\mu_{12}}{4 } \\left [ \\left(v_{12}^{\\parallel}\\right)^2 - \\left(v_{12,0}^{\\parallel}\\right)^2 \\right ] .   \\end{aligned}\\ ] ]    by plugging the expressions of the internal energies into  , the effective one - dimensional dynamics on @xmath127 finally reads @xmath138 with @xmath139\\right ) + s_2'\\left({\\varepsilon}_{2,0 } - \\frac{\\mu_{12}}{4 } \\left [ v^2 - \\left(v_{12,0}^{\\parallel}\\right)^2 \\right]\\right ) \\right\\}.\\ ] ] the effective dynamics   is the reference dynamics upon which the numerical integrator @xmath140 is constructed .",
    "note that it is parametrized by the initial conditions @xmath141 and @xmath142 . in the numerical scheme presented in section  [ sec : metropolis_elementary_fd ] , these initial conditions will be the values at iteration  @xmath143 , while the current values of the effective dynamics   at time  @xmath144 provide the values at the next iteration  @xmath145 .",
    "the effective dynamics   can be rewritten as an overdamped langevin dynamics as follows : @xmath146 with @xmath147 and @xmath148\\right ) + s_2'\\left({\\varepsilon}_{2,0 } - \\frac{\\mu_{12}}{4 } \\left [ v^2 - \\left(v_{12,0}^{\\parallel}\\right)^2 \\right]\\right ) \\right\\ } v.\\ ] ] note that @xmath149 with @xmath150\\right ) - s_2\\left({\\varepsilon}_{2,0 } - \\frac{\\mu_{12}}{4 } \\left [ v^2 - \\left(v_{12,0}^{\\parallel}\\right)^2 \\right]\\right).\\ ] ] when @xmath151 , the unique invariant measure of   therefore reads @xmath152\\right ) + s_2\\left({\\varepsilon}_{2,0 } - \\frac{\\mu_{12}}{4 } \\left [ v^2 - \\left(v_{12,0}^{\\parallel}\\right)^2 \\right]\\right)\\right ] \\ , dv .",
    "\\end{aligned}\\ ] ]      to simplify the notation , @xmath127 is replaced by @xmath153 in this section .",
    "the proposed numerical scheme consists in analytically integrating the effective dynamics   with the friction fixed to @xmath154 , and accepting or rejecting this proposal according a metropolis criterion ; which corresponds to the so - called smartmc algorithm  @xcite .",
    "more precisely , the proposed new velocity is @xmath155 where @xmath156 is a sequence of independent and identically distributed standard one - dimensional gaussian random variables , and @xmath157 the new momenta and internal energies are then obtained from   and  .",
    "this scheme in fact coincides with the ssa discretization considered in  @xcite since @xmath158 .",
    "the difference with the standard ssa scheme is however that   only provides a proposal for the new state , to be accepted or rejected .",
    "the metropolis ratio to accept a proposed transition from @xmath153 to @xmath159 is @xmath160 , with @xmath161 where @xmath162 is the transition kernel associated with the numerical scheme and @xmath163 is defined in  . for  , denoting respectively @xmath164 it holds @xmath165 in fact , for  , @xmath166 in addition , using the configuration at iteration  @xmath143 as the reference in  , and denoting by @xmath167 the internal energies at this time , @xmath168\\right ) - s_1({\\varepsilon}_1^n ) \\\\ & \\ \\",
    "+ s_2\\left({\\varepsilon}_{2}^n - \\frac{\\mu_{12}}{4 } \\left [ \\left(\\widetilde{v}^{n+1}\\right)^2 - \\left(v^n\\right)^2 \\right]\\right ) - s_2({\\varepsilon}_2^n ) .",
    "\\end{aligned}\\ ] ] if one of the new energies is negative , @xmath169 is set to  0 to avoid singularities ( in a subsequent step of the algorithm , these configurations are anyway automatically discarded ) .",
    "the complete expression of the acceptance therefore relies on the following quantity : @xmath170\\right ) - s_1({\\varepsilon}_1^n ) \\\\ & \\ \\",
    "+ s_2\\left({\\varepsilon}_{2}^n - \\frac{\\mu_{12}}{4 } \\left [ \\left(\\widetilde{v}^{n+1}\\right)^2 - \\left(v^n\\right)^2 \\right]\\right ) - s_2({\\varepsilon}_2^n ) \\\\ & \\ \\ + \\frac{(g^n)^2}{2 } - \\frac{|v^n-\\alpha_{{{\\delta t}}}(\\widetilde{v}^{n+1})\\widetilde{v}^{n+1}|^2}{2\\sigma_{{\\delta t}}(\\widetilde{v}^{n+1})^2 } \\\\ & \\ \\",
    "+ \\log \\sigma_{{\\delta t}}(v^n ) - \\log \\sigma_{{\\delta t}}(\\widetilde{v}^{n+1 } ) .",
    "\\end{aligned}\\ ] ]    the precise algorithm to integrate elementary dynamics such as   is the following . starting from a current configuration @xmath171 :    a.   compute @xmath172 ; b.   propose a new value @xmath173 according to  ; c.   check whether the following energy bound is satisfied : @xmath174 { \\leqslant}\\min({\\varepsilon}_1^n,{\\varepsilon}_2^n).\\ ] ] if this is not the case , the move is rejected : @xmath175 .",
    "d.   if the energy bound is satisfied , compute @xmath176 according to  ; e.   generate @xmath177 $ ] : if @xmath178 , the move is rejected ; otherwise it is accepted .",
    "f.   if the move is accepted , the new momenta and internal energies are set to @xmath179 and @xmath180 , \\qquad { \\varepsilon}_2^{n+1 } = { \\varepsilon}_{2}^n - \\frac{\\mu_{12}}{4 } \\left [ \\left(\\widetilde{v}^{n+1}\\right)^2 - \\left(v^n\\right)^2 \\right].\\ ] ]      the elementary conduction dynamics between two particles reads @xmath181 note that it can be rephrased as an effective one - dimensional dynamics on  @xmath182 , upon introducing @xmath183 : @xmath184 the latter dynamics is a stochastic differential equation of overdamped langevin type , with invariant probability measure @xmath185 .",
    "it is therefore possible to find accurate schemes for this dynamics , and to stabilize them with a metropolis correction by following the same approach as in section  [ sec : metropolis_elementary_fd ] .",
    "more precisely , consider the following numerical scheme : starting from two energies @xmath167 for which @xmath186 ( otherwise nothing needs to be done ) , compute the energy increment @xmath187 and propose @xmath188 if either @xmath189 or @xmath190 , then the move is rejected and @xmath191 .",
    "otherwise , the move is accepted with probability @xmath192 , where @xmath193 with @xmath194      the numerical schemes @xmath107 and @xmath108 presented in sections  [ sec : metropolis_elementary_fd ] and  [ sec : num_tc ] preserve by construction the measure   because of the metropolis correction . on the other hand ,",
    "the verlet scheme is only second - order accurate . using an analysis similar to the one performed in  @xcite for langevin dynamics , and under appropriate ergodicity assumptions ( both for the continuous dynamics and its discrete approximation )",
    ", it can then be shown that , for any physical observable  @xmath195 , @xmath196 where @xmath197 is the probability measure which is actually sampled by the numerical scheme with a timestep  @xmath144 .",
    "this equality means that average properties , as obtained for instance by time averages over a very long numerical dpde trajectory , coincide with the thermodynamic averages with respect to the measure   up to a systematic error of order  @xmath198 .",
    "of course , the above reasoning is only formal since ergodicity can not be proved in general for dpd - like systems  the only known result is for one - dimensional dpd  @xcite .    in practice",
    ", the total energy  @xmath28 drifts in time when dpde is discretized unless some projection procedure is enforced ( for instance by rescaling internal energies in order to keep the total energy constant ; see  @xcite for discussions on this issue ) .",
    "when no energy rescaling is used , as is the case for the simulations reported in section  [ sec : numerics ] , ergodic ( infinite time ) averages can not be considered .",
    "finite time averages are the only quantities which make sense .",
    "the numerical schemes considered in this section are given by  , except in the second part of section  [ sec : lj ] .",
    "the system is spatially decomposed using a linked - cell method , so the order of integration of the various pairs may change from one step to the other .",
    "let us emphasize that , for all simulations reported below , even for the smallest timesteps and in the absence of potential energy functions , standard ssa simulations ( without metropolis correction ) always crashed after a short time due to the appearance of negative internal energies ; so that no numerical result could be reported in those cases .",
    "this is however possible for heat capacities larger than the ones considered here , and/or a smaller einstein temperature @xmath48 . in such situations , the biases / systematic errors related to the timestep are of the same order of magnitude irrespectively of the fact that the elementary dynamics are metropolized or not .",
    "this highlights the fact that the metropolis correction is really useful to stabilize the dynamics rather than to reduce a possibly large bias .    unless otherwise mentioned , the system under consideration is composed of @xmath199 particles in dimension @xmath200 , at particle density @xmath201 , with pairwise interactions : @xmath202 the temperature is set to @xmath203 for initialization ( see section  [ sec : initialization ] ) , the fluctuation magnitude is chosen to be @xmath204 ( in fact , @xmath205 with @xmath206 ) , and the thermal conductivity is set to @xmath207 .",
    "the cut - off radius is @xmath208 for the fluctuation / dissipation and thermal interactions , with weight function @xmath209 the micro - eos corresponds to the blended einstein model   with @xmath57 , @xmath59 and @xmath58 ( the same parameters as in figure  [ fig : einstein ] ) .",
    "reduced units where @xmath210 , @xmath55 and @xmath211 are used throughout .",
    "average properties are estimated by time averages over a simulation time @xmath212 .",
    "the system starts from a solid phase with atoms on a cubic lattice , and velocities sampled according to the boltzmann distribution at temperature @xmath213 ( whose associated inverse temperature is denoted by @xmath214 ) .",
    "the system is next integrated for a time @xmath215 with a timestep @xmath144 using a langevin dynamics at friction @xmath216 ( using the so - called geometric langevin algorithm introduced in  @xcite and studied in  @xcite ) .",
    "internal energies are sampled independently from @xmath217 , by discretizing the one - dimensional overdamped langevin dynamics for each internal energy  @xmath10 , as done in  @xcite : @xmath218 in practice , this dynamics is discretized with a euler - maruyama scheme and an effective timestep @xmath219 as @xmath220 and corrected by a metropolis procedure : the proposal @xmath221 is accepted with probability @xmath222 where @xmath223 with @xmath224    the thermalization time is set to @xmath225 . at the end of the thermalization , an additional burn - in is performed for a time @xmath226 , using the dpde dynamics .",
    "the timestep for these integrations is @xmath227 in all cases , except for lennard  jones systems where it is set to @xmath228 .      as already mentioned in section  [ sec : errors ] , only errors on finite time averages are considered since the energy may drift in time ( the drift rate increasing with @xmath144 ) .",
    "the aim of the simulation results reported below is first and foremost to demonstrate that quite large timesteps can be used to integrate the dynamics .",
    "error bars on finite time averages are in all cases of the order of a few percents at most , and are hence omitted",
    ". if thermodynamic ( infinite time ) averages are of interest , the numerical scheme proposed here should be complemented by some projection procedure to enforce the energy conservation  @xcite .",
    "consider first ideal fluids , which correspond to the trivial interaction potential @xmath229 ; see figure  [ fig : ideal ] .",
    "the first element to note is that there is no timestep restriction for the metropolized scheme , and that there is no bias , even for very large timesteps .",
    "yet , the rejection rate is very small : for the largest timestep ( @xmath230 ) , it is below @xmath231 , while it is of order @xmath232 for @xmath233 .",
    "these rare rejections are however crucial in ensuring the stability of the dynamics . in particular , the number of counts for proposed negative energies is of the order of @xmath234 for all simulations .",
    "consider next a soft interaction potential of the form @xmath235 the results are presented in reduced units where the reference energy corresponds to @xmath236 ; see figure  [ fig : soft ] . here again , it is seen that the metropolized scheme is unconditionnally stable ( _ i.e. _ any simulation timestep can be considered ) .",
    "the rejection rates are comparable to the ones observed for the ideal fluid .",
    "note also that the bias starts off quadratically ( as would be predicted by   for the metropolized scheme if the dynamics was ergodic ; which is not the case here since the energy drifts in time ) .          consider finally the splined lennard  jones potential @xmath237 & \\text{for } r { \\leqslant}r_{\\rm spline } , \\\\ & ( a + br ) ( r - r_{\\rm cut})^2 & \\text{for } r_{\\rm spline } { \\leqslant}r { \\leqslant}r_{\\rm cut } , \\\\ & 0 & \\text{for } r { \\leqslant}r_{\\rm cut } , \\end{aligned } \\right.\\ ] ] with @xmath238 , and where @xmath239 are chosen in order to ensure that @xmath240 and its first derivative are continuous .",
    "the simulations are performed ni reduced units , with @xmath241 and @xmath242 , @xmath243 ; see figure  [ fig : lj ] for the results .",
    "note that , below the stability treshold of the method , around @xmath244 , there is almost no bias .",
    "the stability is in fact limited by the singularities of the lennard - jones potential , as made clear when resorting to the multiple - timestep strategy .",
    "figure  [ fig : mts ] presents simulation results obtained using the multiple timestep scheme  , with @xmath245 , and various values of the integer @xmath113 .",
    "the bias is almost constant with increasing @xmath113 , which shows that the errors on the invariant measure really arise from the hamiltonian part of the dynamics .",
    ", with @xmath245 fixed.,scaledwidth=49.0% ]      the final illustration is the simulation of a transient relaxation , where the initial condition is obtained by equilibrating internal energies at a given temperature @xmath246 , while the mechanical degrees of freedom  @xmath247 are sampled at a temperature @xmath248 .",
    "the initialization is performed as described in section  [ sec : initialization ] , except that the temperatures are different for internal and mechanical degrees of freedom .",
    "the system under study is larger than in the previous section , namely @xmath249 particles in a 2d setting , the other parameters being unchanged .",
    "the initial termalization time is set to @xmath250 , with @xmath251 and @xmath252 . after the time @xmath215 , the internal and kinetic temperatures are monitored ; see figure  [ fig : equilibration ] ( @xmath227 for the soft dpd potential , while @xmath228 for lennard  jones systems ) .",
    "it is expected that they converge to a common value after a certain physical time , which is mostly dictated by the fluctuation magnitude @xmath253 .",
    "such equilibration dynamics are used to parameterize the fluctuation / dissipation in dpde  @xcite .",
    "another option , considered in  @xcite , consists in instantaneously heating only a part of the system , in which case the thermal conduction has a stronger influence .",
    "this article introduced new integration schemes for dpde , using a splitting paradigm similar to the ssa , but based on the integration of elementary pairwise fluctuation / dissipation and thermal conduction dynamics seen as effective dynamics on a single variable .",
    "the interest of such reformulations is that the numerical schemes for the elementary dynamics can be corrected by a metropolis procedure , which dramatically improves the numerical stability of the algorithm ( preventing by construction the occurence of negative internal energies , even for arbitrarily small heat capacities ) ; and also leads to biases which are small .",
    "the increased stability properties of the stochastic part furthermore suggest to resort to multiple timestep strategies , where the hamiltonian part is integrated with a small timestep ( dictated by stability conditions ) while the stochastic part is integrated less frequently but with larger timesteps .",
    "such approaches are very interesting from a computational viewpoint since the stochastic part of the dynamics usually is more expensive than ( or at least as expensive as ) the hamiltonian part due to the generation of random numbers . of course , the schemes presented here could be combined in actual applications with some projection procedure , which improves the computation of average properties at equilibrium but is dubious for nonequilibrium systems ( see the discussion in  @xcite ) .",
    "the approach outlined here for dpde can of course be straightforwardly implemented for standard dpd .",
    "it can also be extended to smoothed dissipative particle dynamics when the latter dynamics is reformulated in terms of internal energies rather than internal entropies  @xcite .",
    "our focus here mostly was on thermodynamic ( static ) averages .",
    "an interesting question , only hinted at with the numerical results on the transient equilibration in section  [ sec : equilibration ] , and left aside for a subsequent work , is the dynamical relevance of the algorithm presented here  for instance for the computation of transport coefficients or the simulation of nonequilibrium shock and detonation waves .",
    "finally , another valuable line of research is to adapt the method presented here so that it can be used in the current massively parallel implementations of dpde  @xcite .    [ [ acknowledgements ] ] acknowledgements + + + + + + + + + + + + + + + +    g. stoltz acknowledges stimulating discussions with john brennan , as well as a longstanding collaboration with jean - bernard maillet .",
    "these two researchers both highlighted several practical issues in the integration of dpde , in particular the occurence of negative internal energies .",
    "this work benefited from a funding of the european army research office , under grant award # w911nf-16 - 1 - 0254 .",
    "it is also supported by the european research council under the european union s seventh framework programme ( fp/2007 - 2013 ) / erc grant agreement number 614492 ; and by the agence nationale de la recherche , under grant anr-14-ce23 - 0012 ( cosmos ) .",
    "it is shown in this appendix that the micro - eos   @xmath254.\\ ] ] leads to the heat capacity predicted by the einstein model of harmonic oscillators .",
    "the temperature @xmath48 allows to define the scale of energies for which quantum effects are non negligible . in the limit @xmath50",
    ", the classical micro - eos @xmath255 is recovered up to unimportant additive constants .",
    "note first , that , from the definition of the internal entropy  , @xmath256 in view of  , it follows that @xmath257 on this expression , it is clear that @xmath258 as @xmath259 for @xmath48 fixed , and that @xmath260 as @xmath50 for @xmath261 fixed .",
    "both limits are a signature that quantum effects are negligible .",
    "let us now make explicit the model heat capacity which underlines the model  , in order to motivate that the small energy behavior is appropriate . from",
    ", it follows that @xmath262 on the other hand , the relation   can be inverted to write the energy as a function of the temperature .",
    "more precisely , @xmath263 so that @xmath264 and finally , the energy @xmath40 can be written in terms of the temperature @xmath265 as @xmath266 since , using  , @xmath267 it follows that @xmath268 this leads therefore to @xmath269 it is easy to check that @xmath270 when @xmath72 , while @xmath271 vanishes at all orders as @xmath272 .",
    "the model heat capacity considered is the one corresponding to the einstein model of harmonic oscillators .",
    "[ [ estimators - of - the - thermodynamic - temperature - from - the - internal - energies ] ] estimators of the thermodynamic temperature from the internal energies ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    recall that the marginal of the canonical measure   in the variable  @xmath10 is given by  . when the internal entropies are such that @xmath273 { } -\\infty , \\qquad s_i({\\varepsilon}_i)-\\beta { \\varepsilon}_i \\xrightarrow[{\\varepsilon}_i\\to+\\infty ] { } -\\infty,\\ ] ] an integration by parts shows that @xmath274_0^{+\\infty}}{{\\displaystyle } \\int_0^{+\\infty } { \\mathrm{e}}^{s_i({\\varepsilon}_i)-\\beta { \\varepsilon}_i}\\ , d{\\varepsilon}_i } = \\beta .",
    "\\end{aligned}\\ ] ] this motivates taking harmonic averages of the internal temperatures as an estimator of the thermodynamic temperature for micro - eos satisfying   ( such as   and  ) .    on the other hand ,",
    "the internal entropy   obtained from the einstein model of harmonic oscillators is not such that @xmath275 as @xmath61 .",
    "alternative estimators of the internal temperature are therefore required . for a general function",
    "@xmath276 such that @xmath277 an integration by parts similar to the one used above shows that @xmath278_0^{+\\infty } , \\end{aligned}\\ ] ] from which the following estimator of the thermodynamic temperature is deduced : @xmath279 where @xmath280 is defined in  .",
    "note that this estimator is a ratio of canonical averages ( similar to what is considered to estimate the potential temperature using the laplacian and the gradient of the potential  @xcite ) .",
    "one possible choice for @xmath281 is @xmath282 , which leads to the estimator  .",
    "more generally , higher order moments of the internal energy can be used by considering @xmath283 for @xmath284 .",
    "m.  p. kroonblawd , t.  d. sewell , and j .- b .",
    "characteristics of energy exchange between inter- and intramolecular degrees of freedom in crystalline 1,3,5-triamino-2,4,6-trinitrobenzene ( tatb ) with implications for coarse - grained simulations of shock waves in polyatomic molecular crystals . , 144(6):064501 , 2016 .",
    "j.  p. larentzos , j.  k. brennan , j.  d. moore , m.  lisal , and w.  d. mattson . parallel implementation of isothermal and isoenergetic dissipative particle dynamics using shardlow - like splitting algorithms .",
    ", 185(7):19871998 , 2014 .",
    "m.  lisal , j.  k. brennan , and j.  bonet avalos .",
    "dissipative particle dynamics at isothermal , isobaric , isoenergetic , and isoenthalpic conditions using shardlow - like splitting algorithms . , 135(20):204105 , 2011 ."
  ],
  "abstract_text": [
    "<S> this article presents a new numerical scheme for the discretization of dissipative particle dynamics with conserved energy . </S>",
    "<S> the key idea is to reduce elementary pairwise stochastic dynamics ( either fluctuation / dissipation or thermal conduction ) to effective one - dimensional dynamics , and to approximate the solution of these dynamics with one step of a metropolis - hastings algorithm . </S>",
    "<S> this ensures by construction that no negative internal energies are encountered during the simulation , and hence allows to increase the admissible timesteps to integrate the dynamics , even for systems with small heat capacities . </S>",
    "<S> stability is only limited by the hamiltonian part of the dynamics , which suggests resorting to multiple timestep strategies where the stochastic part is integrated less frequently than the hamiltonian one .    </S>",
    "<S> dissipative particle dynamics , numerical scheme , metropolis algorithm 82b31 , 82b80 , 65c30 </S>"
  ]
}