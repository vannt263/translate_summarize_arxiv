{
  "article_text": [
    "rocky planet formation begins as gas and dust around a young star settle into a thin disk .",
    "the emergence of planets within this disk is the result of three phases of evolution ( safronov 1969 ; weidenschilling 1980 ; hayashi 1981 ; wetherill & stewart 1993 ; ida & makino 1993 ; kokubo & ida 1996 ) .",
    "initially , coagulation of dust particles causes a stochastic but steady growth in particle mass .",
    "the few largest bodies , or planetesimals , accumulate mass most quickly , and experience a runaway growth phase . as the largest objects clear out the smaller ones , the planetesimal growth is oligarchic , where the largest objects ",
    "`` oligarchs ''  become isolated from their neighbors and grow roughly at the same rate . in a final phase of chaotic growth , mergers of oligarchs lead to the formation of a few terrestrial planets around sun - like stars well within 100  myr ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this scenario is bolstered by recent observations .",
    "most , if not all , young late - type stars have a disk of gas and dust ( backman & paresce 1993 ; beckwith 1999 ; lada 1999 ) .",
    "at least some of these disks will form large planets , similar to those detected in radial velocity studies ( e.g. , marcy & butler  2000 ) .",
    "the persistence of dusty disks around older stars suggests that smaller planets form as well .",
    "dust should be ejected by radiation pressure , but on - going formation of rocky planets can drive a collisional cascade which continually produces dust from a reservoir of small planetesimals ( kenyon & bromley 2001 , 2002a , 2002b ) .",
    "stars with such debris disks include @xmath1  pic ( kalas et al .",
    "2000 ; wahhaj et al .",
    "2003 ) , @xmath2  eri ( greaves et al .",
    "1998 ) , hr  4796a ( jayawardhana et al .  1998 ; koerner et al .  1998 ) and vega ( e.g. , koerner , sargent & ostroff 2001 ) .",
    "interpretations of observed dusty debris disks , and our understanding of planet formation in general , rely heavily on numerical calculations .",
    "two types of tools , statistical solvers and @xmath0-body codes , provide complementary information about planetary disk evolution .",
    "the effectiveness of each tool depends on @xmath0 , the number of particles they can track .",
    "statistical methods like safronov s ( 1969 ) particle - in - cell formalism work well when the particles are numerous and have small mass @xcite .",
    "current @xmath0-body codes are unable to follow planetary growth in this regime .",
    "when the mass of individual objects gets large , binary interactions become important .",
    "orbit evaluations then require direct @xmath0-body calculations , not the ensemble averages of particle - in - cell approaches . our experience with coagulation codes ( kenyon & luu 1998 , 1999 ; kenyon & bromley 2001 , 2002b , 2003 ) suggests that we can accurately evolve objects with masses below @xmath3@xmath4  g using the statistical approach . however , an @xmath0-body code must track particles of heavier mass ( see also kokubo & ida 1996 , 2002 )",
    ". massive planetesimals requiring direct @xmath0-body evolution are relatively rare in typical planet formation models .",
    "this situation is fortunate because @xmath0-body codes can not accurately track large numbers of particles for long periods of time .",
    "simulations performed by chambers ( 2001 ) and some runs reported here involve @xmath5 particles integrated over 100  myr .",
    "ida , kokubo & kominami ( 2003 ) ran larger simulations with @xmath6 , but only for a @xmath70.5  myr time period and only with specialized hardware for gravitational force calculations .",
    "the complementary limitations of @xmath0-body algorithms and coagulation codes call for an integration of both methods into a single `` hybrid code '' ( jewell & alexander 1996 ; weidenschilling et al",
    ".  1997 ) here we describe an algorithm that includes both a statistical component and a direct @xmath0-body part .",
    "our goal is to run self - consistent simulations of planet formation , tracking objects from micron - sized dust grains to jupiter mass planets .",
    "the coagulation code , described briefly below in  2 , accounts for gas , dust , and a swarm of lower mass planetesimals . our @xmath0-body algorithm (  3 ) , is invoked only when needed to evolve the largest planetesimals . in  4 we discuss the hybrid code itself , and focus on how the @xmath0-body and coagulation parts interact .",
    "we provide tests of this code in  5 and give preliminary results related to the problem of terrestrial planet formation .",
    "the coagulation part of our hybrid code tracks dust and planetesimals in multiple annuli around the central star .",
    "kenyon & luu ( 1998 , 1999 ) and kenyon & bromley ( 2001 , 2002b , 2004a ) describe the algorithms and include a complete set of references . here",
    "we briefly review this statistical algorithm .",
    "the physical processes which we simulate include coagulation , fragmentation , gas drag , poynting - robertson drag , and radiation pressure .",
    "we discretize the continuous distribution of particle masses into mass batches , assigning an integral number of particles to each batch . to allow better resolution of the mass spectrum for particles evolving rapidly , adjacent batches differ in mass by a mass - dependent factor .",
    "we dynamically adjust the number of mass batches , as needed .",
    "our spatial domain is cylindrical and is divided into a set of concentric annuli about the central star .",
    "the annuli may be set so that either they have equal width , or their boundaries are equally spaced in log - radius .",
    "masses and particle numbers evolve according to the coagulation equations which include the effects of collisions , poynting - robertson drag , and interaction with the gas disk .",
    "our collisions rates come from geometric cross sections of particles , augmented by a gravitational focusing factor for larger planetesimals .",
    "collision outcomes depend on the planetesimal tensile strength , gravitational binding energy , and relative velocities . depending on these parameters",
    ", collisions result in mergers , fragmentation , and dust production .",
    "we follow particle velocities statistically for each mass batch in each annulus , tracking vertical and horizontal velocity dispersions relative to keplerian orbits in the central plane of the disk .",
    "these dispersions evolve under the influence of gas drag , poynting - robertson drag , viscous stirring and dynamical friction , according to a set of fokker - planck equations ( hornung , pellat & barge 1985 ; wetherill & stewart 1993 ; stewart & ida 2000 ; ohtsuki , stewart , & ida 2002 ) .    to solve the coagulation and fokker - planck equations , we use a fourth - order runge - kutta method .",
    "the algorithm strictly conserves mass .",
    "when objects shift from one annulus to another , velocity dispersions are updated to conserve kinetic energy explicitly . at the inner and outer boundaries of the spatial domain ,",
    "the mass batches reflect a steady , radial flow in the debris disk .",
    "the code does not enforce angular momentum conservation , nonetheless , in test runs of @xmath8 timesteps , angular momentum is conserved to better than 1% .",
    "the coagulation code evolves the swarm of @xmath9 planetesimals accurately until the largest objects reach roughly the mass of pluto .",
    "because these massive objects are rare , the statistical model provides a poor estimate of their behavior . although the coagulation code can still follow the evolution of the swarm , the orbits of the largest objects require explicit calculations using an @xmath0-body code , which we describe in the next section",
    "planetary @xmath0-body codes must be fast and accurate . suitable solvers for the equations of motion are numerous , with published descriptions of symplectic integrators ( wisdom & holman 1991 ; kinoshita , yoshida & nakai 1991 ; saha & tremaine 1992 ) , and more general time - symmetric integrators ( e.g. , quinlan & tremaine 1990 , hut , makino & mcmillan 1995 ) . some integrators ( vasilev 1982 ; wisdom & holman 1991 ; ida & makino 1992 ; fukushima 1996 ; shefer 2002 ) speed up the calculations by tracking only deviations from a purely keplerian orbit about the central star , following the proposal of encke ( 1852 ) .",
    "other improvements include adaptive timestepping , allowing integrators to take large timesteps when forces are small , and to expend more computational resources only when particles experience strong forces ( aarseth 1985 ; mcmillan & aarseth 1993 ; skeel & biesiadecki 1994 ; kokubo , yoshinaga & makino 1997 ; duncan , levison & lee 1998 ) .",
    "our algorithm is based on the encke method .",
    "we work with non - inertial , keplerian frames about the central star and integrate the equations of motion in rectilinear coordinates defined relative to the keplerian frames .",
    "these coordinates have a fixed orientation , aligned with the inertial frame of the central star .",
    "we use an adaptive block timestepping scheme ( e.g. , mcmillan & aarseth 1993 ) and a sixth- or eighth - order accurate integrator based on richardson extrapolation .",
    "we give details of the integrator below .",
    "for now we briefly outline the timestepping scheme .    at the beginning of a timestep , each particle s accelerated reference frame is initially set to its instantaneous keplerian orbit .",
    "if particles are in tight groups , their reference frames can be set to the keplerian orbit of their mutual center of mass .",
    "a friends - of - friends algorithm ( huchra & geller 1982 , geller & huchra 1983 ) finds any such groups with a linking parameter based on the hill radii of the particles .",
    "we then integrate the equations of motion in terms of spatial variables in the accelerated reference frames over a single timestep of length @xmath10 .",
    "next we calculate higher resolution orbits by dividing the timestep into @xmath11 equal substeps . in practice , @xmath12 seems to work best .",
    "a comparison between the lower and higher resolution orbits produces a check of integrator convergence .",
    "we have implemented several criteria for convergence , but have found that an individual particle s total energy , taken as a fraction @xmath2 , of its keplerian orbital energy , gives an effective comparison under most circumstances .",
    "if a particle s orbit has not converged , we simply repeat the process at even higher time resolution .",
    "the strategy of a block timestepping scheme is to track individual orbits and interpolate the converged orbits if needed to evaluate forces on particles whose orbits have not converged .",
    "this procedure reduces the computational load of force calculations if the number of particles is large ( @xmath13 ) . for a smaller number of particles we prefer to integrate all orbits until every orbit has converged .",
    "energy conservation is better in this case and there is no significant penalty in computational load .",
    "the time integrator is an ordinary differential equation ( ode ) solver based on richardson extrapolation .",
    "we start with a low - resolution estimate of the particle orbits over a time interval @xmath10 using a leapfrog intergrator . specifically , the position @xmath14 and velocity @xmath15 of a particle at the end of a time - forward step in the leapfrog case is @xmath16 where @xmath17 is the acceleration , which in our case depends only on position .",
    "we label the position at the end of this single leapfrog timestep as @xmath18 , and note that it contains errors of the order of @xmath19 .",
    "next we divide the time interval into two equal parts and take two successive leapfrog steps to derive a better resolved orbital position , @xmath20 .",
    "we can further subdivide the time interval to obtain a position @xmath21 , derived from @xmath22 successive leapfrog timesteps .",
    "our final position at the end of the time interval @xmath10 is a linear combination of these results , @xmath23 fourth- , sixth- , and eighth - order methods have @xmath24 , 2 and 3 , respectively and coefficients @xmath25    we calculate the gravitational forces between particles directly . at the lowest resolution timesteps ,",
    "we perform the o@xmath26 force evaluations .",
    "however , if we use the block timestepping scheme then only a few particles depend on o@xmath27 interparticle forces at high temporal resolution . to simulate a larger number of bodies , we have an o(@xmath28 barnes & hut ( 1986 ) treecode , as described in barton , bromley & geller ( 1999 ) .",
    "preliminary tests suggest that this code becomes competitive with a direct method only when @xmath0 is greater than o@xmath29",
    ". an alternative would be to use specialized hardware ( e.g. , hut & makino 1999 ) . here ,",
    "our particle numbers are small and we work exclusively with the direct force solver .    for realistic planet formation models , an @xmath0-body algorithm must identify merger events .",
    "we check for mergers in a fast way , by assuming that any merger event which occurs during a single timestep can involve only two particles . for each particle",
    "we save an index number corresponding to some other particle which came the closest during the force calculations .",
    "this indexing reduces the number of calculations from @xmath30 to @xmath31 . for each pair of bodies , with indices @xmath32 and @xmath33 , we check the relative radial velocity using the quantity @xmath34 , where the vectors are relative position and velocity respectively .",
    "if the relative radial velocity is positive at the beginning of a timestep , then we assume no merger takes place . otherwise , we find the minimum separation of the pair during the timestep , interpolating if necessary .",
    "once we have the minimum pair separation @xmath35 and relative speed @xmath36 , a merger event is identified if @xmath37\\ ] ] where @xmath38 is the escape velocity at distance @xmath35 from the @xmath39 particle , and @xmath40 is the particle s physical radius .",
    "thus the merger cross - section is at least the physical cross - section , and is larger if the relative velocity is small compared to the escape velocity of either particle .",
    "with our coagulation code and @xmath0-body algorithm , we track both the numerous low - mass planetesimals and the relatively rare high - mass bodies in a planetary disk .",
    "the interactions between these two populations generally cause the larger bodies to circularize in their orbits , while the smaller bodies tend to get gravitationally stirred , as reflected in an overall increase in eccentricity and inclination . here",
    "we describe how the coagulation and @xmath0-body components work together to simulate these effects .",
    "the multiannulus coagulation code evolves all low - mass bodies .",
    "the model grid contains @xmath0 concentric annuli with widths @xmath41 centered at heliocentric distances @xmath42 .",
    "each annulus contains @xmath43 ) objects of mass @xmath44 with orbital eccentricity @xmath45 and inclination @xmath46 in @xmath47 mass batches .",
    "when an object in the coagulation code reaches a preset mass , it is ` promoted ' into the @xmath0-body code .",
    "to set the initial orbit for this object , we use the three coagulation coordinates , @xmath48 , @xmath49 , and @xmath32 , and select random values for the longitude of periastron and the argument of perihelion .",
    "because the annuli have finite width @xmath41 , we set the semimajor axis of the promoted object to @xmath50 = @xmath51 , where @xmath52 is a random number between 0 and 1 .",
    "when two or more objects within an annulus are promoted to the @xmath0-body code during the same timestep , we restrict the choices of the orbital elements to minimize orbital interactions between the newly promoted @xmath0-bodies .",
    "the coagulation code also determines the simulation timestep .",
    "this interval , @xmath53 , is generally larger than the lowest resolution timestep of the @xmath0-body code , so we take multiple low - resolution substeps , @xmath10 , within that interval .",
    "the length of a substep is set by the orbital speed of the fastest moving body ; for nearly circular orbits this limit is roughly 1/60@xmath54 of the orbital period .    to calculate the effects of the swarm of low - mass bodies on the @xmath0-bodies , we use particle - in - a - box estimates .",
    "for an n - body with index @xmath33 , mass @xmath55 , eccentricity @xmath56 , inclination @xmath57 , horizontal velocity @xmath58 , and vertical velocity @xmath59 , we derive the time - evolution of the orbital eccentricity and inclination from the fokker - planck formulae for the derivatives of the horizontal and vertical velocities :    @xmath60    @xmath61    for viscous stirring in the high velocity limit and    @xmath62    @xmath63    for dynamical friction in the high velocity limit . in these expressions , @xmath64 , @xmath65 , and the functions @xmath66 , @xmath67 , @xmath68 , and @xmath69 are definite integrals @xcite .",
    "the subscript @xmath70 is the annular index while subscript @xmath11 is the index of a mass batch .",
    "the overlap fraction @xmath71 is the fraction of bodies in annulus @xmath70 that approach within 2.4 @xmath72 of the @xmath0-body .",
    "we set @xmath73 , where @xmath74 is the total mass of bodies with @xmath75 in annulus @xmath76 and @xmath77 is the volume of annulus @xmath76 . following stewart & ida ( 2000 ) , we also set @xmath78 , where    @xmath79    with @xmath80 , @xmath81 , @xmath82 , @xmath83 , and @xmath84 ; the subscript @xmath85 denotes a keplerian velocity ( see also * ? ? ?",
    "* ; * ? ? ?",
    "when the relative velocities of particles approach the hill velocity , @xmath86 , we set    @xmath87    @xmath88    @xmath89    and use    @xmath90    @xmath91    for viscous stirring in the low velocity limit and    @xmath92    @xmath93    for dynamical friction in the low velocity limit @xcite . in these expressions , @xmath94 = 0.3125@xmath95 , @xmath96 is the mutual scale height , @xmath97 = @xmath98 , and @xmath99 = @xmath100 .",
    "the combined velocity stirring is then    @xmath101    @xmath102    for viscous stirring and    @xmath103    @xmath104    for dynamical friction .",
    "to calculate the accretion rate of planetesimals onto the @xmath0-bodies , we use the standard coagulation equation :    @xmath105    where @xmath106 is the normalized cross - section ( see kenyon & luu 1999 ) .    to calculate the stirring of planetesimals by @xmath0-bodies",
    ", we calculate the appropriate fokker - planck terms for viscous stirring and dynamical friction and add these results to the long distance stirring of @xcite    @xmath107    where @xmath108 is the number of @xmath0-bodies and @xmath109 .    at the end of each coagulation timestep",
    ", we pass the stirring and accretion rates for each @xmath0-body  @xmath110 , @xmath111 , and @xmath112  to the @xmath0-body code . at the end of every low resolution",
    "timestep in the @xmath0-body code , we modify each particle s orbit and mass to reflect these changes .",
    "when possible , we simply redirect the velocity vector so that the eccentricity varies independently of inclination and semimajor axis .",
    "the @xmath0-body functions return an updated particle list to the coagulation code .",
    "new orbital positions and masses of the large objects are then reinserted into the coagulation grid .",
    "the coagulation calculations proceed in the standard fashion , except that the orbital velocities of the large - mass objects in the grid are not evolved . with a complete circuit from the coagulation code to the @xmath0-body code to the coagulation code",
    ", @xmath0-bodies influence the evolution of the swarm and the swarm influences the evolution of the @xmath0-bodies .",
    "we have published elsewhere results on the performance of the coagulation code , as described in  2 .",
    "however , the @xmath0-body and hybrid codes are new , and our purpose here is to validate them . in this section",
    "we first test the @xmath0-body code for stability , dynamic range , accuracy , and merger resolution , mostly following duncan , levison & lee ( 1998 ) in the validation of their symba algorithm .",
    "we then test the hybrid code against several simulations of terrestrial planet formation at 1 au @xcite .",
    "the following subsections are organized according to the type of calculation .",
    "we test stability during long term orbit integrations of the major planets and a `` scaled outer solar system '' where the masses of the major planets are increased by a factor of 50 ( duncan , levison & lee 1998 ) .",
    "then we test dynamic range with two binary planet configurations .",
    "the code s accuracy is also established with a test to resolve a critical orbital separation between two planetesimals which determines whether their orbits will cross . in considering mergers",
    ", we reproduce the greenzweig & lissauer ( 1990 ) results for planetary accretion rates .",
    "we also derive the integration accuracy required to track the collision between a massive object and a small projectile on opposing circular orbits at 1  au . finally , we simulate terrestrial planet formation , following @xcite , who consider the evolution of km - sized planetesimals , and chambers ( 2001 ) , who models the collisional evolution of lunar mass bodies .      to evaluate the stability of our adaptive integrator , we evolve the four major planets in orbit about a stationary sun . figure  [ fig : symplectic ] shows the behavior of the outer planets eccentricities over a 10  myr period .",
    "we use two different integrators , a sixth - order accurate symplectic integrator ( yoshida 1990 ) and our adaptive code , also with a sixth - order accurate ode solver for comparison .",
    "we run both codes at low and high resolution .",
    "the run times of the two codes are comparable at each resolution . as illustrated in the figure , the low resolution adaptive code obtains a better measure of eccentricity than its symplectic counterpart .",
    "one reason is that the adaptive code is not subject to accumulation of phase errors as in a symplectic algorithm . on the other hand ,",
    "the adaptive code produces a secular drift in energy over the course of the simulation , whereas the symplectic code does not . the fractional error in total energy at 10",
    "myr is @xmath113 and @xmath114 for the low and high resolution adaptive code , respectively .",
    "if the masses of each of the four major planets increase by a factor of 50 , the outer solar system is unstable ( see , for example , duncan & lissauer 1998 ) . to verify that our code yields the correct timescale for this instability , we made tests similar to one performed by duncan , levison & lee ( 1998 ) . as expected , the semimajor axis of jupiter s orbit shrinks by a modest fraction of the original semimajor axis , while saturn is ejected on a timescale of 1,000  years .",
    "as saturn leaves the solar system , its orbit crosses and excites the orbits of uranus and neptune .",
    "an increase in the orbital eccentricity of uranus or neptune leads to a second ejection , as seen in figure  [ fig : scalsolsys ] .",
    "duncan , levison & lee ( 1998 ) note that bound binary planets whose center of mass revolves around a star provide a strong test of the ability of an @xmath0-body integrator to handle a wide range of dynamical timescales .",
    "they set up a pair of jupiter - mass planets with a center of mass on a circular orbit at 1  au .",
    "the planets orbit each other with an initial binary semimajor axis of 0.0125  au and binary eccentricity of 0.6 .",
    "their simulation time was 100  yr , covering about 3,200 binary orbits .",
    "we reproduce the duncan , levison & lee ( 1998 ) test .",
    "we can limit total energy errors to within a part in 10 million , while keeping the wall time well below a minute on a 1.7  ghz amd athlon processor .",
    "figure  [ fig : binary ] illustrates changes in the binary semimajor axis .",
    "the figure also demonstrates a test of our block timestepper .",
    "if a small particle is in a tightly bound orbit around a much more massive object , then the position of the massive particle is interpolated in the force calculations for the small body .",
    "our test simulates the orbit of a massless `` spy satellite '' on a polar orbit about the earth .",
    "figure  [ fig : binary ] shows that the distance of the satellite from the center of the earth varies by about 100  meters during an orbit .",
    "there is no significant drift in its mean altitude over the course of 100 years , corresponding to roughly 600,000 satellite orbits of the earth .",
    "we next test the ability of the @xmath0-body code to handle the evolution of planetesimals .",
    "first , we consider an isolated pair of planetesimals , with masses of @xmath115  g. these bodies start on corotating , circular orbits near 1  au .",
    "we specify their orbital separation in terms of their mutual hill radius , @xmath116^{1/3}$ ] .",
    "there is a critical separation , @xmath117 , which determines the onset of chaotic behavior : if the planetesimals initial orbital separation is smaller than @xmath118 , their orbits will cross , otherwise they will simply scatter to larger orbital separations .",
    "figure  [ fig : npack ] shows the evolution of semimajor axes in cases where orbital separations are initially smaller than @xmath118 ( top panel ) and greater than @xmath118 ( middle panel ) . as expected , the more closely - spaced pair experiences several orbit crossings while the more distant pair does not .",
    "multiple calculations demonstrate that our code can resolve the critical separation @xmath118 to within a few percent .",
    "figure  [ fig : npack ] also shows results for eight planetesimals , each with the same mass as in the preceding case , and initially on circular , keplerian orbits .",
    "the separation between nearest neighbors is @xmath119 .",
    "the orbit crossings proceed from larger radius inward , as illustrated anecdotally in the figure ( see also * ? ? ?",
    "* ; * ? ? ?",
    "next we use the @xmath0-body code to model gravitational stirring by two @xmath115  g objects in a uniform disk of 805 lower mass , @xmath120  g objects ( kokubo & ida 1995 ; weidenschilling et al .  1997 ; kenyon & bromley 2001 ) .",
    "the disk is centered at 1  au , and is 35  @xmath72 in annular extent , where @xmath72 is the mutual hill radius between large and small objects .",
    "to speed up the code s convergence with this relatively large number of particles , we soften the interaction potential on a scale comparable to the physical radius of the large bodies , assuming their density is 1  g @xmath121 .",
    "figure  [ fig:2plus800 ] illustrates the evolution of the radial profile of @xmath122 for the case where the two massive bodies are separated by @xmath123 , and are each at an orbital distance of @xmath124 away from 1  au .",
    "the initial eccentricity and inclinations are zero for the two massive objects , and small ( @xmath125 , @xmath126 ) for the planetesimals .",
    "the @xmath0-body results here compare well with those from the pure coagulation code ( kenyon & bromley 2001 ) , except that the @xmath0-body calculations produce more structure in the profile , particularly an enchanced scattering of the swarm away from the more massive bodies .",
    "this difference , a broadening of the profile as compared to the coagulation results , is expected from previous @xmath0-body calculations ( kokubo & ida 1995 ) .",
    "one test of our merger algorithm is provided by greenzweig & lissauer ( 1990 ) , who studied gravitational focusing by a single planet in a field of test particles , all orbiting a 1  star .",
    "we consider one of their configurations , a @xmath127  planet on a circular orbit at 1  au and a set of test particles on orbits with eccentricity @xmath128 , inclination @xmath129  degrees , and semimajor axes distributed in two rings between 0.977  au and 1.023  au .",
    "we evolve the system through a single close encounter between the planet and each test particle , to determine the fraction of test particles accreted by the planet .",
    "when the planet has a physical radius of @xmath130  km , greenzweig & lissauer ( 1990 ) report an accretion fraction @xmath131 = 0.140 . in their validation of the symba code ,",
    "duncan , levison & lee ( 1998 ) estimate @xmath132 . for a planetary radius of 5,200  km , the derived accretion fractions are @xmath133 ( greenzweig & lissauer 1990 ) and @xmath134 ( duncan , levison & lee 1998 ) .",
    "using the merger criterion specified in  [ sect : nbody ] ( eq . [",
    "[ eq : merger ] ] ) , our results are @xmath135 ( poisson errors with 50,000 test particles ) for the @xmath130  km radius planet and @xmath136 for the 5,200  km radius planet .",
    "a more extreme test of the merger algorithm is to simulate the high - speed collision between two counterrotating objects .",
    "we consider a small ( cm - size ) projectile and a larger target of some specified radius , @xmath137 , both with a density of 1  g/@xmath138 .",
    "the two bodies initially are at 1  au on opposite sides of the sun and are on colliding circular orbits .",
    "the code calculates trajectories with a fixed number of timesteps over a time interval which is randomly distributed at values just greater than 0.25  yr .",
    "we run repeated trials and find the minimum number of low - resolution timesteps , @xmath139 , required to achieve a 95% success rate in detecting collisions .",
    "figure  [ fig : xsection ] illustrates our results . for targets with @xmath140  km ,",
    "@xmath139 is determined by the errors in the interpolation of position between the endpoints of each timestep , and scales approximately as @xmath141 . in our planet formation simulations",
    "reported here , we typically take @xmath142 timesteps per orbit and therefore can expect to resolve high - speed collisions between 1,000  km objects .",
    "if gravitational interactions between target and projectile become important , as in cases with large bodies and slow impact speeds , then the adaptive integrator takes high - resolution timesteps , increasing the accuracy of the merger algorithm .",
    "this effect is illustrated in figure  [ fig : xsection ] , which shows a dramatic decrease in @xmath139 for targets of size 100  km or larger , depending on the adaptive code s error tolerance . in practice ,",
    "our @xmath0-bodies typically have radii greater than 1,000  km and have impact speeds which are more than an order of magnitude smaller than in a counterrotating collision .",
    "thus , our code should accurately resolve mergers in planet formation simulations .",
    "next , we test this assertion explicitly .      to illustrate the behavior of the hybrid code for less idealized conditions , we consider calculations of terrestrial planet formation at 1 au",
    "we compare our results with two sets of published calculations . @xcite and",
    "@xcite use a multi - annulus code which evolves the masses and orbital properties of planetesimals with a coagulation code and follows the evolution of discrete planetary embryos with a monte carlo algorithm . as in our calculations",
    ", their code allows interactions between the planetesimals and the embryos .",
    "they evolve planetesimals for 1 myr in two configurations , 0.861.14 au and 0.51.5 au . here",
    ", we use a grid at 0.841.16 au and compare the @xcite results with our calculations from the pure coagulation code and from the hybrid code .",
    "@xcite uses a three - dimensional @xmath0-body code to consider the final phase of terrestrial planet formation at 0.42 au .",
    "these calculations begin with 150160 lunar - mass to mars - mass embryos and follow the collisional evolution for 200500 myr . here",
    ", we adopt a grid at 0.42 au and compare the outcomes of two pure @xmath0-body calculations and many hybrid calculations with the @xcite results .",
    "we begin with results for @xmath48 = 0.841.16 au . in these calculations ,",
    "the grid has 32 radial zones each containing an initial distribution of planetesimals with radii of 14 km .",
    "the planetesimals have initial surface density @xmath143 g @xmath144 , eccentricity @xmath145 = @xmath146 , and inclination @xmath147 = @xmath148 .",
    "the calculations include gas drag but do not allow fragmentation .",
    "the initial stages of pure coagulation and hybrid calculations are identical . in a few thousand years , objects grow to radii of 1020 km .",
    "after @xmath149 yr , objects reach sizes of 100300 km . because the timescales for dynamical friction and viscous stirring are shorter than the growth timescales , the largest objects have nearly circular orbits while the smallest objects have eccentric orbits .",
    "runaway growth then yields a handful of 10003000 km objects . as runaway growth proceeds ,",
    "viscous stirring continues to heat up the orbits of the smallest objects faster than the smallest objects damp the velocities of the largest objects .",
    "thus , gravitational focusing factors decrease , accretion slows , and runaway growth ends .",
    "the evolution then enters a period of ` oligarchic growth , ' where all of the largest objects grow at roughly the same rate .    during oligarchic growth",
    ", the growth of the largest objects in the hybrid calculations differs from the path followed in the pure coagulation models . in the hybrid models ,",
    "oligarchs grow slowly until their orbits begin to cross @xcite .",
    "once orbits cross , chaotic growth leads to a rapid merger rate and the formation of several ` super - oligarchs ' that accrete most of the leftover planetesimals .",
    "the super - oligarchs accrete some of the remaining lower mass oligarchs and scatter the rest out of the grid @xcite .    in pure coagulation models ,",
    "the orbits of oligarchs are not allowed to cross .",
    "these oligarchs slowly accrete all of the planetesimals within their gravitational reach .",
    "oligarchs rarely accrete other oligarchs .",
    "after 10100 myr , pure coagulation models have more lower mass oligarchs than the hybrid models . however , the largest oligarchs are less massive than their counterparts in the hybrid calculations .    figures [ fig:3dcoag ] and [ fig:3dwhyb ] compare some results from two calculations at specific times .",
    "figure  8 of @xcite shows results for a similar calculation . in every case ,",
    "the mass of the largest object is @xmath150 g at @xmath151",
    "yr , @xmath152 g at @xmath130 yr , and @xmath153 g at @xmath8 yr . at early times , @xmath49 and @xmath32 decline monotonically with increasing mass .",
    "at later times , @xmath49 and @xmath32 have bimodal distributions : objects with @xmath154 g have large @xmath49 and @xmath32 , while more massive objects have much smaller @xmath49 and @xmath32 .",
    "the orbital anisotropy , @xmath155 , follows a similar evolution , with @xmath156 0.4 at early times and @xmath156 0.10.15 at late times .",
    "near the end of the calculations , the largest objects lie in a flattened disk , with @xmath157 0.02 - 0.03 ( see also * ? ? ?",
    "figure [ fig : evsm ] illustrates the evolution of the eccentricity in more detail . at @xmath151 yr , dynamical friction maintains low @xmath49 for the largest bodies . because planets form fastest at the inner edge of the grid , small objects at the inner edge have larger @xmath49 than small objects at the outer outer edge . at @xmath130 yr",
    ", dynamical friction still maintains low @xmath49 for the largest bodies .",
    "because most of the small objects have grown to 100 km radius , these objects have slightly smaller @xmath49 than other objects with @xmath158 g. at @xmath8 yr , objects with @xmath159 g have low @xmath160 , while lower mass objects have higher @xmath161 .",
    "these results compare favorably with figure  9 of @xcite .",
    "we begin our version of the @xcite calculations in a grid of 40 annuli at @xmath48 = 0.42 au . for the hybrid calculations , the annuli contain an initial distribution of planetesimals with radii of 415 km .",
    "the pure @xmath0-body model starts with 160 ` moons ' with a mass of @xmath4 g. in both cases , the objects have @xmath145 = @xmath146 and @xmath147 = @xmath148 . to provide some contrast with previous calculations , we adopt an initial surface density of planetesimals or moons , @xmath162 with @xmath163 = 8 g @xmath144 and @xmath52 = 0.252 , instead of the usual @xmath164 .",
    "although the final configuration of planets depends on the initial surface density gradient , the general evolution is fairly independent of @xmath165 .",
    "the large radial extent of these calculations allows us to illustrate the sensitivity of planet formation to the heliocentric distance . because the timescale for growth by coagulation is @xmath166 , planets grow fastest at the inner edge of the grid @xcite",
    ". in hybrid models with @xmath52 = 1 , objects with radii of @xmath7 200 km form in @xmath167 yr at 0.4 au , in @xmath149 yr at 0.95 au , and in @xmath168 yr at 2 au .",
    "oligarchs with masses of @xmath169 g form on a timescale @xmath170    once large objects start to form , the transition from runaway to oligarchic to chaotic growth proceeds in several waves propagating from the inner disk to the outer disk @xcite . as oligarchs start to form at the outer edge of the grid , dynamical interactions between oligarchs begin at the inner edge .",
    "several orbit crossings lead to dynamical interactions between all oligarchs and a rapid increase in the merger rate .",
    "a few large oligarchs gradually accrete many of the smaller oligarchs , leading to a configuration with several earth - mass planets and a few mars - mass ` leftovers . '    in the moons calculations , dynamical interactions between the 160 original oligarchs dominate the entire evolutionary sequence . in the first @xmath149 yr , five mergers start to produce large oligarchs in the inner disk . the number of oligarchs declines to 146 in @xmath130 yr , to 115 in 1 myr , and to 55 in 10 myr . by 10 myr",
    ", the largest objects in the inner disk reach masses of 0.20.3 @xmath171 and slowly accrete the remaining moons . in the outer disk ,",
    "the smaller surface density and viscous stirring lead to a smaller merger rate .",
    "after @xmath7 100 myr , only @xmath7 20 oligarchs remain in the outer disk .",
    "to compare our results with @xcite , we consider measures of the orbital elements of final ` solar systems ' from several simulations . in our direct @xmath0-body and hybrid calculations ,",
    "the time variation of the mass - weighted eccentricity @xmath172 ( fig .",
    "[ fig : ecc - evol ] ) follows a standard pattern ( see fig .  5 of @xcite ) .",
    "during runaway and oligarchic growth , protoplanets stir their surroundings and @xmath172 increases . at 10 - 100 myr ,",
    "the orbits of oligarchs cross , which further excites orbital eccentricity and produces sharp peaks in @xmath172 .",
    "mergers between oligarchs reduce @xmath172 .",
    "once a few remaining planets have fairly stable orbits , @xmath172 settles to 0.050.15 .",
    "hybrid models yield larger variations in @xmath172 than @xmath0-body calculations of large objects .",
    "because objects grow to the promotion mass throughout a hybrid calculation , the merger phase lasts longer and produces more frequent resonant interactions at later times compared to pure @xmath0-body models .",
    "thus , we often observe several peaks in the evolution of @xmath172 for hybrid models compared to a single peak in pure @xmath0-body calculations .",
    "figure [ fig : eccent ] shows the relation between the eccentricity and mass of the planets produced in our calculations .",
    "our models yield a range in mass from @xmath7 0.01 @xmath171 to @xmath7 23 @xmath171 . for @xmath7 30 planets with masses , @xmath173 0.1 @xmath171 , the orbital eccentricity is not correlated with the mass .",
    "@xcite derived a similar result for @xmath7 50 planets .",
    "however , our calculations yield a reasonably large ensemble of lower mass planets with @xmath174 0.01 - 0.1 @xmath171 . in the full ensemble of planets with @xmath174 0.013 @xmath171",
    ", there is a small , but significant trend of decreasing eccentricity with increasing planet mass . from the spearman rank and kendall s @xmath175 tests @xcite , the probability that the derived distribution of @xmath176 is random is @xmath177 .    to compare this result to our solar system",
    ", we restrict the mass range to 0.052 @xmath171 . for our ensemble of @xmath7 40 planets , the spearman rank and kendall s @xmath175 probabilities are @xmath7 0.1 .",
    "these tests yield probabilities of @xmath7 0.150.2 for the 4 terrestrial planets in our solar system .",
    "we conclude that the weak correlation of @xmath49 with @xmath11 is consistent with architecture of our solar system .    as a final comparison with @xcite",
    ", we calculate several statistical parameters to characterize the final configurations of our models . for a system with @xmath0 oligarchs",
    ", @xmath178 measures the fraction of the mass in the largest object , where @xmath179 is the mass of the largest oligarch and @xmath180 is the total mass in the grid .",
    "the orbital spacing statistic is @xmath181 where @xmath182 is the average mass of an oligarch , @xmath183 is the mass of the central star , @xmath184 is the minimum semimajor axis of an oligarch , and @xmath185 is the maximum semimajor axis of an oligarch . to measure the degree of orbital excitation of a planet , @xcite describes the angular momentum deficit , the difference between the z - component of the angular momentum of an orbit and a circular orbit with the same semimajor axis .",
    "@xcite generalizes this definition as the sum over all planets , @xmath186}{\\sum_{j=1}^{n } m_j ~ \\sqrt{a_j } } ~.\\ ] ] finally , the mass concentration statistic @xmath187 } \\right ) \\ ] ] measures whether mass is concentrated in a few massive objects ( large @xmath188 ; as in the earth and venus ) or many low mass objects ( small @xmath188 ; as in the kuiper belt and scattered disk of the outer solar system ) .    table 1 compares results for our 14 hybrid calculations and our two ` moons ' calculations with statistics for the inner solar system . for calculations with @xmath189 ,",
    "our moons calculations yield roughly the same outcome as @xcite .",
    "the mass of the largest object and the statistics agree well with those in table 1 of @xcite . because we began with a shallower surface density gradient ,",
    "our planetary systems have more massive objects and more oligarchs at larger heliocentric distances than @xcite .",
    "our hybrid models for @xmath52 = 1 yield results similar to the moons calculations .",
    "our most massive object has a mass of 1.11.8 @xmath171 and contains 40% to 80% of the initial mass in the grid .",
    "the calculations typically produce 12 other massive objects comparable in mass to venus and several less massive objects with masses more similar to mars . for models with longer evolution times ,",
    "the number of mars - mass objects declines considerably from 100 myr to 500 myr .",
    "the statistical parameters agree well with the @xcite results .",
    "the planets in all of our model solar systems have more eccentric orbits than the planets in the solar system . however , the other statistics agree rather well with those in the solar system , including one model that is more concentrated than the solar system .",
    "the outcomes of our calculations are sensitive to the initial mass in the grid .",
    "models with @xmath52 = 0.25 produce very low mass planets , @xmath7 0.1 @xmath171 , compared to models with @xmath52 = 12 , @xmath7 12 @xmath171 .",
    "the lower mass models also yield more planets on more circular orbits and have a smaller fraction of the total mass in the largest object .",
    "in this paper we describe a hybrid @xmath0-body coagulation code for planet formation .",
    "we put the @xmath0-body part through a battery of tests to assess its performance in planetary dynamics simulations .",
    "validation tests of the coagulation algorithm appear elsewhere ( e.g. , kenyon & bromley 2001 ) . we provide tests of the hybrid method by comparing it to coagulation simulations and @xmath0-body output separately .",
    "we demonstrate that all three methods quantitatively reproduce published results for the formation of rocky planets by mergers of @xmath190 km - sized @xcite or @xmath142 moon - sized @xcite planetesimals .",
    "table  2 gives a summary of these tests , with references to other published work .",
    "although our intent here is simply to describe our method , the hybrid code now has the potential to match observations of the solar system and debris disks ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "in addition to results on terrestrial planets in  5 , @xcite summarizes results on the transition from oligarchic to chaotic growth in the terrestrial zone .",
    "@xcite shows how a stellar encounter can produce sedna - like orbits in the outer solar system and outlines how observations might distinguish between locally - produced and captured sednas .",
    "future papers will describe more complete results on planet formation in the terrestrial zone and the trans - neptunian region .",
    "we acknowledge a generous allotment , @xmath7 20 cpu years , of computer time on the silicon graphics origin-2000 ` alhena ' through funding from the nasa offices of mission to planet earth , aeronautics , and space science .",
    "advice and comments from m.  geller are greatly appreciated !",
    "nasa _ _ astrophysics theory program _ supported part of this project through grant nag5 - 13278 .",
    "kenyon , s. j. , & bromley , b. c. 2001 , aj , 121 , 538 kenyon , s.  j.  & bromley , b.  c.  2002 , , 577 , l35 kenyon , s. j. , & bromley , b. c. 2002 , aj , 123 , 1757 kenyon , s. j. , & bromley , b. c. 2004 , aj , 127 , 513                                                                              lccccccc 0.25 & 100 & 9 & 0.1 & 0.198 & 19.9 & 0.0031 & 26.4 + 0.25 & 300 & 10 & 0.1 & 0.213 & 22.7 & 0.0029 & 24.7 + 0.50 & 100 & 10 & 0.4 & 0.292 & 20.1 & 0.0058 & 26.1 + 0.50 & 100 & 8 & 0.4 & 0.314 & 25.1 & 0.0094 & 21.9 + 1.00 & 100 & 6 & 1.3 & 0.474 & 27.7 & 0.0090 & 33.4 + 1.00 & 100 & 8 & 1.0 & 0.526 & 23.4 & 0.0118 & 45.8 + 1.00 & 100 & 5 & 1.1 & 0.428 & 35.6 & 0.0131 & 33.4 + 1.00 & 100 & 6 & 1.4 & 0.498 & 28.3 & 0.0093 & 27.0 + 1.00 & 200 & 5 & 1.1 & 0.371 & 28.7 & 0.0121 & 22.4 + 1.00 & 200 & 5 & 1.8 & 0.644 & 32.0 & 0.0499 & 52.6 + 1.00 & 500 & 2 & 2.1 & 0.778 & 36.1 & 0.0228 & 119.4 + 2.00 & 100 & 5 & 2.4 & 0.521 & 19.3 & 0.0328 & 38.6 + 2.00 & 100 & 6 & 2.0 & 0.348 & 24.6 & 0.0292 & 25.7 +   + 1.00 & 100 & 21 & 0.8 & 0.256 & 14.2 & 0.0136 & 17.1 + 1.00 & 100 & 15 & 0.9 & 0.417 & 28.8 & 0.0119 & 25.4 +   + mvem & & 4 & 1.0 & 0.509 & 37.7 & 0.0018 & 89.9 +      giant planet orbit integration & figure 1 &  + scaled outer solar system & figure 2 & figure 5 , duncan , levison & lee ( 1998 ) +   + binary jupiters & figure 3 & figure  4 , duncan , levison & lee ( 1998 ) + earth satellite & figure 3 &  +   + resolving chaos & figure 4 &  + two planetesimals in a swarm & figure 5 & figure 1 , kokubo & ida ( 1995 ) +  &  & figure b3 , weidenschilling et al .",
    "( 1997 ) +   + planetary accretion ( @xmath191  km ) & @xmath192 & @xmath193 , greenzweig & lissauer ( 1990 ) +  ( @xmath194 is the accretion fraction ) &  & @xmath195 , duncan , levison & lee ( 1998 ) + planetary accretion ( @xmath196  km ) & @xmath197 & @xmath198 , greenzweig & lissauer ( 1990 ) +  &  & @xmath199 , duncan , levison & lee ( 1998 ) + high - speed collisions & figure 6 &  +   + planet formation ( coagulation ) & figures 79 & figures  8 & 9 , weidenschilling et al . (",
    "1997 ) + terrestrial planet formation & table 1 & table  1 , chambers ( 2001 )"
  ],
  "abstract_text": [
    "<S> we describe a hybrid algorithm to calculate the formation of planets from an initial ensemble of planetesimals . </S>",
    "<S> the algorithm uses a coagulation code to treat the growth of planetesimals into oligarchs and explicit @xmath0-body calculations to follow the evolution of oligarchs into planets . to validate the @xmath0-body portion of the algorithm </S>",
    "<S> , we use a battery of tests in planetary dynamics . </S>",
    "<S> several complete calculations of terrestrial planet formation with the hybrid code yield good agreement with previously published calculations . </S>",
    "<S> these results demonstrate that the hybrid code provides an accurate treatment of the evolution of planetesimals into planets .    </S>"
  ]
}