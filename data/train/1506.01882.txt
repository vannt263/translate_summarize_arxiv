{
  "article_text": [
    "density functional theory ( dft ) has dominated atomic - scale materials modeling for the past three decades and will continue to be extremely important . however , there are plenty of problems where the accuracy of dft falls short of requirements .",
    "there are clear reasons to expect dft to struggle in strongly - correlated solids , but these are not the only systems for which dft is insufficient .",
    "take , for example , the problem of distinguishing between molecular crystal phases and competing low - energy polymorphs .",
    "even in relatively simple molecular solids such as crystalline benzene and its polymorphs under pressure , the energy differences of interest are less than a few kj / mol .",
    "the most successful calculations based on dft are only reliable to @xmath010 kj / mol,@xcite and it has recently been shown that the use of _ ab initio _ many - electron wavefunction methods , such as quantum monte carlo ( qmc ) , is essential to tackle this problem successfully.@xcite unlike dft , many - electron wavefunction methods can , in principle , be improved systematically until the required convergence is obtained .",
    "another important example is the adsorption of molecules on surfaces , where dft is sometimes unable to give predictions of useful accuracy .",
    "dft values of surface formation energies of simple paradigmatic materials such as silicon and magnesium oxide depend strongly on the assumed exchange - correlation functional , and there is usually no way of knowing in advance which functional to trust .",
    "the well known problem of calculating electronic band gaps could also be mentioned .",
    "the urgent practical need to go beyond dft in these and other areas is driving current efforts to develop more accurate methods .",
    "there is abundant evidence that there are large classes of problems for which qmc techniques , in particular diffusion monte carlo ( dmc ) , are considerably more accurate that dft.@xcite just recently , using qmc methods , chemically accurate ionization potentials have been obtained for the first - row transition - metal atoms with a mean absolute error of only 0.126 kcal / mol.@xcite by combining high accuracy with good efficiency and scalability , qmc methods promise to bring high accuracy to computational materials science as a matter of routine.@xcite    qmc simulations of extended systems are carried out using finite simulation cells subject to periodic boundary conditions .",
    "practical and computational constraints restrict the size of the simulation cell and so introduce finite - size ( fs ) errors , which can be large and are one of the main problems holding back the application of accurate qmc techniques to solids.@xcite quantifying and correcting these errors is an essential part of all qmc simulations of extended systems , particularly when high accuracy is required .",
    "fs errors affect independent - particle approaches such as dft as well as many - body approaches such as qmc . for calculations of perfect crystals , dft fs errors",
    "can be reduced simply by improving the accuracy of the brillouin zone integration , although the errors arise when periodic supercells are used to model aperiodic systems are less easily dealt with .",
    "independent - particle fs errors also affect many - body calculations of perfect crystals@xcite and can be reduced using twist averaging , which is the many - electron equivalent of brillouin zone integration . even after twist averaging",
    ", however , `` many - body '' fs errors with no independent - particle analogues remain .",
    "another important contribution to the fs error in many - body simulations of extended systems arises from the treatment of the potential energy .",
    "the @xmath1 coulomb interaction is inconsistent with the periodicity of the simulation cell and has to be replaced by the ewald interaction , which is the green s function of poisson s equation subject to periodic boundary conditions . unlike the coulomb interaction , the ewald interaction depends on the size and shape of the simulation cell , leading to additional finite - size errors.@xcite one approach to circumventing",
    "this problem is to use a different periodic function , the `` model periodic coulomb '' ( mpc ) interaction , in place of the ewald interaction.@xcite variational quantum monte carlo ( vmc ) simulations using the mpc interaction suffer from smaller fs effects than simulations using the standard ewald interaction .",
    "it has also been shown that using the mpc interaction reduces the fs errors in dmc calculations of ground and excited states.@xcite    a drawback of the mpc approach is that it only reduces fs errors arising from the use of the ewald interaction .",
    "the charge density and exchange - correlation hole in a finite simulation cell are often very similar to those of an infinite solid , so the errors in the coulomb energy are indeed primarily due to the errors in the interaction ; but the imposition of periodic boundary conditions also affects the many - electron wavefunction and thus the electronic kinetic energy .",
    "the non - interacting part of the fs error in the kinetic energy may be eliminated by twist averaging , but the many - body contributions are not negligible .    under the assumption that the low-@xmath2 behaviour of the structure factor is independent of the choice of simulation cell , chiesa _ _",
    "et al.__@xcite proposed a method to estimate the many - body contributions to the fs errors in both the potential and kinetic energies without abandoning the ewald interaction . employing this correction , which is based on the random - phase approximation at long wavelength",
    ", one can calculate fs corrections within a single simulation .",
    "another approach to the treatment of many - body finite - size errors is provided by the kwee - zhang - krakauer ( kzk ) functional,@xcite which adds a correction computed from the difference between the dft energy evaluated using the local density approximation ( lda ) for an infinite system and the dft energy evaluated using a modified lda specifically designed to reproduce the total energy of the finite simulation cell , including fs errors .",
    "both the standard lda and the kzk lda are parameterized on the basis of dmc simulations of cells of uniform electron gas subject to periodic boundary conditions , but the standard lda uses dmc energies that have been extrapolated to infinite cell size while the kzk lda does not .    in this paper",
    ", we systematically study the problem of eliminating fs errors from qmc calculations of real metallic systems , taking lithium and aluminum as examples .",
    "we analyze twist - averaged dmc energies obtained using the ewald interaction and the mpc interaction,@xcite and finite - size corrections based on the chiesa formalism@xcite and the kzk functional.@xcite we also investigate dft - based corrections designed to improve imperfectly twist - averaged results and consider how best to combine the use of twist - averaged boundary conditions@xcite with the kzk functional.@xcite",
    "the diffusion quantum monte carlo method is a stochastic technique for obtaining the ground - state energy of a many - electron system .",
    "dmc has been described in many previous papers@xcite and will not be discussed in detail here , but since this work is focused on technical aspects of dmc simulations we start with a brief explanation .",
    "the dmc algorithm solves the imaginary - time schrdinger equation , @xmath3 where @xmath4 is a @xmath5-dimensional vector defining the positions of all @xmath6 electrons in the simulation cell , @xmath7 is the imaginary time ( a real variable despite its name ) , @xmath8 is the potential energy including electron - electron interactions , and @xmath9 is a constant energy offset .",
    "( we work in hartree atomic units , where the numerical values of @xmath10 , @xmath11 , @xmath12 , and @xmath13 are all equal to 1 . )",
    "the imaginary - time schrdinger equation resembles a @xmath5-dimensional diffusion equation with diffusion constant @xmath14 .",
    "the potential energy term causes the diffusers to `` branch '' ( multiply or die out ) at a position - dependent rate .",
    "the wavefunction @xmath15 is the number density of diffusers , which are normally known as walkers or configurations and are points in the @xmath5-dimensional configuration space , not individual electrons .",
    "the dmc algorithm uses this simple physical interpretation to simulate the imaginary - time evolution of the wavefunction using a finite population of diffusing and branching walkers .",
    "solving the imaginary - time schrdinger equation is useful because it projects out the ground state as @xmath16 .",
    "if the initial wavefunction is expanded as a linear combination of energy eigenfunctions , @xmath17 , the solution of the imaginary - time schrdinger equation @xmath18 is @xmath19 thus , as long as @xmath20 , the wavefunction @xmath21 becomes proportional to @xmath22 as @xmath16 . by gradually adjusting @xmath9 to maintain the normalization of the solution in the large @xmath7 limit , we can find the ground - state energy @xmath23 .",
    "an obvious difficulty with this approach is that the wavefunction @xmath15 , which is not necessarily positive , is interpreted as a walker density , which must be positive .",
    "in fact , a naive application of the dmc algorithm to a many - electron system yields a totally symmetric many - boson ground state of no physical interest .",
    "the fixed - node approximation introduces a trial many - electron ground - state wavefunction , @xmath24 , and forbids walker moves that cause @xmath25 to change sign .",
    "as long as @xmath25 is properly antisymmetric , this is sufficient to ensure that a fermionic solution is obtained .",
    "it may be shown @xcite that energies calculated within the fixed - node approximation are variational : the result is greater than or equal to the many - fermion ground - state energy and tends to the exact energy as the @xmath26-dimensional nodal surface on which @xmath27 tends to the ground - state nodal surface .",
    "the fixed - node approximation is required for dmc simulations of large systems but is the only fundamental limitation of the method .",
    "other approximations , such as the use of a finite time - step or the representation of ions by pseudopotentials , can be made negligible or avoided given sufficient computer time .",
    "fixed - node dmc energies are in most cases comparable in accuracy to energies calculated using the ccsd(t ) method,@xcite which is often known as the `` gold standard '' of quantum chemistry .",
    "the diffusion / branching simulation described above is unstable in practice because the potential energy @xmath8 diverges whenever electrons approach nuclei or each other , leading to uncontrollable branching .",
    "this problem can be overcome using an importance - sampling technique .",
    "the imaginary - time schrdinger equation is re - expressed in terms of the quantity @xmath28 to obtain @xmath29 -    [ e_l(\\mathbf{r } ) - e_t]f(\\mathbf{r},\\tau),\\ ] ] where @xmath30 is the @xmath5-dimensional gradient operator , @xmath31 is the corresponding laplacian , @xmath32 is the @xmath5-dimensional drift velocity vector , and @xmath33 is the local energy .",
    "the importance - sampled imaginary - time schrdinger equation describes a diffusion process similar to that discussed above , except that the walkers now drift with velocity @xmath34 as well as diffusing and branching .",
    "the branching rate is determined by the shifted local energy @xmath35 instead of the shifted potential energy @xmath36 .",
    "if the trial function is a good approximation to the ground state , the local energy is a smooth function of @xmath37 and the numerical difficulties caused by divergences in @xmath8 are avoided .",
    "the fixed - node approximation is imposed by rejecting walker moves that change the sign of @xmath24 .",
    "our dmc simulations used the casino qmc code @xcite and a trial function of slater - jastrow ( sj ) form , @xmath38    \\det[\\psi_{n}(\\mathbf{r}_i^{\\uparrow } ) ]    \\det[\\psi_{n}(\\mathbf{r}_j^{\\downarrow } ) ] , \\label{eq6}\\ ] ] where @xmath39 is the position of the ith spin - up electron , @xmath40 is the position of the jth spin - down electron , @xmath41 $ ] is the jastrow factor , and @xmath42 $ ] and @xmath43 $ ] are slater determinants of spin - up and spin - down one - electron orbitals .",
    "these orbitals were obtained from dft calculations using the plane - wave - based quantum espresso code.@xcite a norm - conserving pseudopotential constructed within dft using the perdew - zunger parameterization of the local density approximation@xcite was employed .",
    "we chose a very large basis - set cut - off of 300 ry to guarantee converge to the complete basis - set limit.@xcite the one - electron orbitals , originally expressed as linear combinations of plane waves , were transformed into a blip polynomial basis for efficiency.@xcite the jastrow function @xmath44 consisted of polynomial one - body electron - nucleus ( en ) and two - body electron - electron ( ee ) terms , the parameters of which were optimized by variance minimization at the variational monte carlo ( vmc ) level.@xcite      qmc fs errors are conventionally separated into one - body and many - body contributions .",
    "one - body ( independent - particle ) errors arise from the non - interacting kinetic , potential and hartree energies and include shell - filling effects .",
    "these errors can be removed by twist averaging .",
    "@xcite many - body errors arise from the effects of exchange and correlation on the coulomb and kinetic energies and are not removed by twist averaging .",
    "as explained in the introduction , various techniques may be used to reduce or cancel these errors , but none is entirely successful and care is required .",
    "the oldest approach is extrapolation , which remains useful .",
    "the use of the modified periodic coulomb interaction @xcite reduces the coulomb errors but not the kinetic energy errors and must therefore be combined with other techniques . the lda - based kwee - zhang - krakauer ( kzk ) approach @xcite applies corrections obtained from dft calculations carried out using a modified exchange - correlation functional explicitly designed to mimic the dmc many - body errors .    to remove single - particle errors and eliminate shell effects in the kinetic energies of metallic systems , we use twist - averaged boundary conditions.@xcite a twist @xmath45 is imposed by insisting that the many - electron wavefunction @xmath46 obeys the bloch boundary condition @xmath47 for all electrons @xmath48 , where @xmath49 is any simulation - cell lattice vector .",
    "expectation values of observables are obtained by averaging over twist vectors @xmath45 uniformly distributed over the simulation - cell brillouin zone : @xmath50 the twists can be chosen from a uniform monkhorst - pack grid,@xcite preferably offset from @xmath51 , or can be chosen randomly , as in this work . the number of twists should be as large as computational resources allow .",
    "as the twist @xmath45 varies , the energies of some of the one - electron states appearing in the slater determinants may cross the fermi level . in the canonical approach",
    "to twist averaging , the electron number is kept constant and the fermi level is allowed to vary with twist .",
    "this makes the twist - averaged total energy slightly too large,@xcite but the bias reduces as the simulation - cell increases in size and is normally negligible . in the grand canonical approach",
    "to twist averaging , the fermi energy is fixed and the electron number is allowed to vary with @xmath45 . as was demonstrated in ref .  , energies obtained using grand - canonical twist averaging exhibit much larger fluctuations than energies obtained using canonical twist averaging with the same number of twists .",
    "furthermore , these fluctuations die away very slowly as the number of twists is increased . to save effort",
    ", applications of qmc to real systems normally use the smallest number of twists possible , so canonical twist averaging is preferable despite the fact that it suffers from small systematic errors .",
    "this work only considers twist averaging within the canonical ensemble .    in metallic systems , even when substantial computational resources are expended , the fs errors due to incomplete twist averaging are substantial .",
    "we therefore define an incomplete - twist - averaging correction as follows : @xmath52 where @xmath53 is the dft energy computed using a fully converged @xmath2-point mesh and @xmath54 is the twist - averaged dft energy obtained using the same simulation cell and set of twists as the dmc simulation .",
    "the incomplete - twist - averaging correction tends to zero as the dmc twist averaging is improved and works well if the independent - particle finite - size errors are well approximated by their dft equivalents . in practice , this approach allows accurate results to be obtained with surprisingly small sets of dmc twists , even in metals .",
    "we analyze three different methods for correcting the many - body fs errors in dmc results .",
    "two of these use the structure - factor - based corrections proposed by chiesa _",
    "et al . _",
    "@xcite the first employs the standard ewald form of the periodic coulomb interaction and chiesa corrections for both the kinetic and potential energies ; the second uses the mpc@xcite to deal with the coulomb errors and a chiesa correction for the kinetic energy only .",
    "results obtained with both of these methods are expected to be similar in quality.@xcite    the third fs - correction method considered here is the kzk approach,@xcite which uses a system - size - dependent local density approximation fitted to the results of dmc simulations of _ finite _ cubic simulation cells of uniform electron gas .",
    "dft energies calculated using the kzk functional incorporate dmc fs errors within an approximation analogous to the lda . to estimate the fs error in the dmc total energy of a given simulation cell , the dft total energy of exactly the same simulation cell is calculated using the kzk functional .",
    "the difference between this value and the dft energy of an infinite simulation cell calculated using the standard lda provides an estimate of the dmc fs error .",
    "the kzk functional was not originally combined with twist averaging , but the combination is easy to implement ( see below ) and very successful .    in the following",
    "we explain how to combine twist averaging and kzk corrections . in general ,",
    "any fs correction can be written as @xmath55 where @xmath56 includes contributions from the hartree energy , the electron - nuclear coulomb interaction energy , and the one - body component of the kinetic energy , while @xmath57 is a many - body term that includes contributions from the exchange - correlation energy and the many - body part of the kinetic energy .",
    "more precisely , @xmath56 may be defined as that part of the total finite - size error that is also present in a dft calculation for the same simulation cell and can be corrected using dft results .    in their original paper,@xcite kwee",
    ", zhang and krakauer considered the finite - size errors affecting a qmc simulation carried out in a supercell of @xmath58 primitive unit cells with twist @xmath59 .",
    "the corresponding one - particle finite - size error is @xmath60 where @xmath61 is the dft energy obtained using a fully converged @xmath2-point mesh and @xmath62 is the @xmath51-point dft energy of the supercell .",
    "this , of course , can be calculated using an @xmath63 monkhorst - pack grid of @xmath2 points in the primitive brillouin zone .",
    "since @xmath59 , the monkhorst - pack grid includes the origin .",
    "the kzk approximation to the many - body finite - size error is @xmath64 where @xmath65 is the @xmath51-point dft energy of the supercell computed using the kzk functional instead of the standard lda .",
    "the kzk approximation to the total finite - size error is @xmath66    if twist averaging is used , the dmc energy becomes a function of the twist @xmath45 , which lies in the small brillouin zone corresponding to the simulation supercell .",
    "the slater determinants appearing in the twisted trial wavefunction are built using orbitals from a monkhorst - pack grid of @xmath63 @xmath2 points within the larger primitive brillouin zone , offset by @xmath45 from the origin . in a dft context , carrying out a supercell calculation at a non - zero twist @xmath45 is equivalent to approximating the integration over the primitive brillouin zone by a quadrature over this offset grid of @xmath2 points .    to help analyze the fs errors , we write the dmc ground - state energy of the infinite simulation cell as @xmath67 where @xmath68 is the twist - averaged dmc energy of the @xmath63 simulation cell and @xmath69 is the required fs correction . in the spirit of kzk",
    ", this is approximated using the formula @xmath70 where @xmath61 is the dft energy computed within the lda using a fully converged @xmath2-point mesh ( which in this work means @xmath71 ) and @xmath72 is the twist - averaged kzk energy for the supercell , computed using the same set of @xmath73 twists employed in the dmc simulations .",
    "the fs correction , @xmath69 , accounts both for the many - body fs errors and for any one - body fs errors not removed by the limited twist averaging employed in the dmc simulations .",
    "the use of twisted boundary conditions requires the use of complex trial wavefunctions and increases the computational cost a little because complex arithmetic is slower than real arithmetic . in the vmc and wavefunction optimization algorithms , since the expectation values of hermitian operators must be real , only the real parts of the local - energy components need to be calculated and collected .",
    "the run - time and programming - time costs of twist averaging are therefore small .",
    "the use of a complex trial function in dmc requires the replacement of the fixed - node approximation , in which the dmc wavefunction is constrained to have the same sign as the trial wavefunction , by the fixed - phase approximation,@xcite in which the dmc and trial wavefunctions are constrained to have the same phase . in practice , however , the fixed - node and fixed - phase algorithms are very similar and little extra coding is required : the real part of the drift vector is used when proposing trial electron moves ; it is neither necessary nor possible to reject node - crossing electron moves ; and , as in vmc , only the real parts of the local energies are gathered .",
    "another important issue in twist averaging is the jastrow factor .",
    "this work uses the same optimized jastrow for each twist vector , as we found that re - optimizing the jastrow factor at every twist provides negligible improvements in the final results.@xcite we note , finally , that the vmc or dmc runs at each twist can be relatively short and need not be fully converged .",
    "the idea is that we collect enough data to achieve an acceptable error bar when the data are averaged over all twist vectors .",
    "if a normal run without twist averaging takes @xmath74 moves to arrive at an acceptable error bar , each twist angle need only be run for around @xmath75 moves .",
    "this section presents dmc results obtained using the three different fs - correction methods explained in the sec .",
    "[ subsec : fse ] . as simple example metals , we have studied lithium ( li ) and aluminum ( al ) , with one and three valence electrons , respectively .",
    "the frozen ionic cores are represented by non - local norm - conserving lda pseudopotentials .",
    "the kzk functional is essentially an lda , so the use of lda pseudopotentials allows us to obtain a consistent comparison of all three finite - size - correction approaches considered .",
    "there is evidence that hartree - fock pseudopotentials may produce more accurate results than lda pseudopotentials when used in dmc simulations , but since our aim is to investigate fs errors , and since these are almost independent of pseudopotential , no advantage would be gained by using another pseudopotential type . to check the accuracy and convergence of the dmc energy as a function of the number of atoms @xmath74 in the simulation cell",
    ", we have performed calculations for a range of different values of @xmath74 ( and thus also different values of @xmath76 ) .",
    "we first investigate the effects of applying chiesa and mpc corrections to the results of @xmath51-point dmc simulations with no twist averaging .",
    "table [ gamli ] shows the @xmath51-point dmc results for li obtained using various different fs correction methods . as expected,@xcite results ( denoted ewald + @xmath77ke + @xmath77pe ) obtained by adding chiesa kinetic and potential energy corrections to the dmc energy calculated using the ewald interaction are in good agreement with results ( denoted mpc + @xmath77ke ) obtained using the modified periodic coulomb interaction with a chiesa correction for the kinetic energy only .",
    "note that the higher - order kinetic energy corrections defined according to equation ( 55 ) in ref .",
    ", are included in @xmath77ke . because of the lack of twist averaging , the single - body fs errors are large and the calculated ground - state energies depend strongly on the size of the simulation cell .",
    "the choice of the @xmath51-point , @xmath78 , maintains the symmetry of the system but usually increases shell - filling effects in metallic systems , making the independent - particle fs errors even worse .",
    "it is clear , however , that no calculation carried out at a single twist vector will yield satisfactorily accurate results .",
    "the use of twist averaging is essential in metals .    .",
    "dmc energies of metallic lithium for different numbers @xmath74 of atoms in the simulation cell .",
    "every energy appearing in the table is the outcome of a single @xmath51-point dmc simulation for the appropriate simulation cell .",
    "results obtained by applying chiesa kinetic ( @xmath77ke ) and potential ( @xmath77pe ) finite - size corrections to dmc energies calculated using the ewald interaction agree well with results obtained by applying only the chiesa kinetic correction to dmc energies calculated using the modified periodic coulomb interaction . despite the application of many - body finite - size corrections , the calculated energy depends strongly on the size of the simulation cell .",
    "this indicates that the single - particle finite - size errors are large .",
    "energies are in ev per atom . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     figure [ likzk ] shows how the fs - corrected dmc energies of metallic li depend on system size , allowing an easy comparison of the three different many - body fs - correction methods considered in this work .",
    "all dmc energies are averaged over 24 randomly chosen twists and include @xmath77bz corrections .",
    "red squares indicate dmc results calculated using the ewald interaction with chiesa corrections for the kinetic and potential energies ( ewald + @xmath77ke + @xmath77pe + @xmath77bz ) ; green circles indicate dmc results obtained using the modified periodic coulomb interaction with chiesa corrections for the kinetic energy only ( mpc + @xmath77ke + @xmath77bz ) ; and blue circles indicate kzk - corrected dmc results , again incorporating @xmath77bz corrections . even for the smallest simulation cell considered , with just 32 atoms , the errors in the ewald + @xmath77ke + @xmath77pe + @xmath77bz and mpc + @xmath77ke",
    "+ @xmath77bz total energies are only 15.7 and 12 mev / atom , respectively . the errors in ewald dmc energies corrected using the kzk scheme are even smaller , at approximately 3 mev / atom .",
    "we emphasize the importance of the success of the twist - averaged kzk method from a practical point of view .",
    "it is known , for example , that the cheap and widely used dft approach often fails to provide accurate enough results@xcite to understand the behavior of materials at high pressure .",
    "therefore , to study the very interesting phase diagram of li,@xcite it will be necessary to perform full many - body computations , most likely using dmc .",
    "the drawback is that dmc calculations are typically at least a thousand times more expensive than dft calculations .",
    "the twist - averaged kzk approach allows one to investigate a large number of possible crystal structures and construct the li phase diagram whilst keeping the cost of the dmc simulations within reasonable bounds .",
    "total dmc energies of li as function of the number of particles in the simulation cell .",
    "all energies are averaged over 24 randomly chosen twists and include @xmath77bz corrections .",
    "red squares indicate dmc results calculated using the ewald interaction with chiesa corrections for the kinetic and potential energies ( ewald + @xmath77ke + @xmath77pe + @xmath77bz ) ; green circles indicate dmc results obtained using the modified periodic coulomb interaction with chiesa corrections for the kinetic energy only ( mpc + @xmath77ke + @xmath77bz ) ; and blue circles indicate kzk - corrected dmc results , again incorporating @xmath77bz corrections . ]",
    "figure [ alkzk ] shows how the fs - corrected dmc energy of metallic al depends on the number of atoms in the simulation cell .",
    "all dmc energies are averaged over @xmath79 randomly chosen twists and include @xmath77bz corrections .",
    "red squares indicate fs - corrected results obtained using the ewald interaction with chiesa corrections for the kinetic and potential energies ( ewald + @xmath77ke + @xmath77pe + @xmath77bz ) ; green circles indicate dmc results obtained using the modified periodic coulomb interaction ( mpc ) with chiesa corrections for the kinetic energy only ( mpc + @xmath77ke + @xmath77bz ) ; and blue circles indicate kzk - corrected dmc results , again incorporating @xmath77bz corrections . for all simulation - cell sizes ,",
    "the ewald + @xmath77ke + @xmath77pe + @xmath77bz and kzk results are in almost perfect agreement .",
    "the difference between the mpc + @xmath77ke + @xmath77bz energies and those obtained using the other two fs - correction methods is about 7 mev / atom for a cell containing just 48 atoms and decreases rapidly with increasing simulation - cell size .",
    "the results of this section have shown that the addition of an incomplete twist - averaging correction , @xmath77bz , allows accurate results to be obtained with a remarkably small number of twists , even for metals . in most of the cases studied ( except for the 96-atom li simulation cell ) ,",
    "the @xmath77bz correction lowers the total dmc energy .",
    "the values of @xmath80 for li simulation cells containing 32 , 48 , 72 , 96 , and 144 atoms are -0.0171 , -0.0091 , -0.0006 , + 0.0013 , and -0.0069 ev , respectively . in the case of al simulation cells containing 24 , 32 , 48 , and 72 atoms , the values of @xmath77bz are -0.092 , -0.066 , -0.047 , and -0.050 ev , respectively . a recent paper by shulenberger and mattsson @xcite provided accurate benchmark dmc results for a wide range of different bulk materials .",
    "they required 216 and 64 twists to obtain converged results for li and al supercells containing 28 and 108 atoms , respectively . because we use incomplete twist - averaging corrections , @xmath77bz , we are able to obtain similarly accurate results with considerably fewer twists .",
    "total dmc energies of al as function of the number of particles in simulation cell .",
    "all energies are averaged over 24 randomly chosen twists and include @xmath77bz corrections .",
    "red squares indicate dmc results calculated using the ewald interaction with chiesa corrections for the kinetic and potential energies ( ewald + @xmath77ke + @xmath77pe + @xmath77bz ) ; green circles indicate dmc results obtained using the modified periodic coulomb interaction with chiesa corrections for the kinetic energy only ( mpc + @xmath77ke + @xmath77bz ) ; and blue circles indicate kzk - corrected dmc results , again incorporating @xmath77bz corrections . ]",
    "we have systematically analyzed and compared the various schemes that have been proposed for correcting fs errors in qmc simulations of real metallic systems . we have explained how to combine the use of twist - averaged boundary conditions with the kzk functional and shown the value of incomplete - twist - averaging corrections based on dft .",
    "the reassuring news is that all of the commonly used approaches work well .",
    "we believe that the use of dft - based incomplete - twist - averaging corrections will have an important role to play in dmc simulations of real metallic systems .",
    "the reliance on dft could be considered a drawback , but it is important to bear in mind that _ any _ valid fs - correction method must yield the same total energy in the limit of a large enough simulation cell .",
    "the important question is not whether the unattainable limiting value is correct but how rapidly it is approached .",
    "the use of incomplete - twist - averaging corrections significantly improves this convergence .",
    "furthermore , energies calculated using the twist - averaged kzk scheme ( which implicitly incorporates a @xmath77bz incomplete - twist - averaging correction ) often settle down to a system - size - independent constant more quickly than energies calculated using other methods incorporating @xmath77bz corrections .",
    "we believe that this paper will provide a useful guide and benchmark for researchers using qmc and other many - body electronic structure methods such as ccsd(t ) and the @xmath81 approximation to study metallic systems .",
    "this work was supported by the uk engineering and physical sciences research council under grant ep / k038141/1 , and made use of computing facilities provided by archer , the uk national supercomputing service , and by the high performance computing service of imperial college london .",
    "we acknowledge support from the thomas young centre under grant tyc-101 ."
  ],
  "abstract_text": [
    "<S> we present a systematic and comprehensive study of finite - size effects in diffusion quantum monte carlo calculations of metals . </S>",
    "<S> several previously introduced schemes for correcting finite - size errors are compared for accuracy and efficiency and practical improvements are introduced . in particular , we test a simple but efficient method of finite - size correction based on an accurate combination of twist averaging and density functional theory . </S>",
    "<S> our diffusion quantum monte carlo results for lithium and aluminum , as examples of metallic systems , demonstrate excellent agreement between all of the approaches considered . </S>"
  ]
}