{
  "article_text": [
    "in the analysis of logic programs , the theory of abstract interpretation @xcite has been widely used to design new analyses and to improve existing ones . given a concrete semantics working over a concrete domain",
    ", an abstract interpretation formalizes an analysis by providing an abstract domain and an abstract semantics ( working on the abstract domain ) , and relating them to their concrete counterparts . an abstract domain is a collection of abstract objects which encode the property to analyze .",
    "the concrete and abstract domains are related by means of abstraction and concretization maps , which allow each concrete object to be abstracted into an abstract object which describes it .",
    "the abstract semantics , in most cases , is given by a set of abstract operators on the abstract domain , which are the counterparts of the concrete ones .",
    "for example , in the case of logic programs , one can individuate in the concrete semantics the main operations ( unification , projection , union ) , and an abstract semantics can be specified by giving the abstract unification , abstract projection and abstract union operations .",
    "the theory of abstract interpretation assures us that , for any concrete operator , there exists a best abstract operator , called the optimal operator .",
    "it computes the most precise result among all possible correct operators , on a given abstract domain .",
    "designing the optimal abstract counterpart of each concrete operator is often a very difficult task .",
    "in fact , even if the definition of the optimal operator for any abstract domain is known from the theory of abstract interpretation ( as a composition of the concrete operator and the abstraction map ) , the hard task is to provide an explicit definition of the abstract operators and to devise algorithms on the abstract domain which compute them .",
    "the property of sharing has been the subject of many papers @xcite , from the both theoretical and practical point of view .",
    "typical applications of sharing analysis are in the fields of optimization of unification @xcite and parallelization of logic programs @xcite .",
    "the goal of ( set ) sharing analysis is to detect sets of variables which share a common variable in the answer substitutions .",
    "for instance , consider the substitution @xmath3 .",
    "we say that @xmath4 and @xmath5 share the variable @xmath6 , while @xmath4 and @xmath7 share the variable @xmath8 , and no single variable is shared by @xmath9 and @xmath7 .",
    "many domains concerning sharing properties also consider linearity in order to improve the precision of the analysis .",
    "we say that a term is linear if it does not contain multiple occurrences of the same variable .",
    "for instance , the term @xmath10 is linear , while @xmath11 is not , since @xmath4 occurs twice .",
    "it is now widely recognized that the original domain proposed for sharing analysis , namely , @xmath12 @xcite , is not very precise , so that it is often combined with other domains for handling freeness , linearity , groundness or structural information ( see for a comparative evaluation ) . in particular , adding some kind of linearity information seems to be very profitable , both for the gain in precision and speed which can be obtained , and for the fact that it can be easily and elegantly embedded inside the sharing groups ( see ) . in the literature , many authors have proposed abstract unification operators ( e.g.  ) for domains of sharing properties , encoding different amounts of linearity information",
    ". however , optimal operators for combined analysis of sharing and linearity have never been devised , neither for the domain @xmath2 @xcite , nor for the more broadly adopted @xmath1 @xcite .    with the lack of optimal operators , the analysis loses precision and might even be slower .",
    "the latter is typical of sharing analysis , where abstract domains are usually defined in such a way that , the less information we have , the more complex the abstract objects are .",
    "this is not the case for other kinds of analyses , such as groundness analysis , where the complexity of abstract objects may grow accordingly to the amount of groundness information they encode .",
    "the lack of optimal operators is due to the fact that the role played by linearity in the unification process has never been fully clarified .",
    "the traditional domains which combine sharing and linearity information are too abstract to capture in a clean way the effect of repeated occurrences of a variable in a term and most of the effects of ( non-)linearity are obscured by the abstraction process .",
    "we propose an abstract domain @xmath0 which is able to encode the _ amount _ of non - linearity , i.e. , which keeps track of the exact number of occurrences of the same variable in a term .",
    "consider again the substitution @xmath13 . intuitively , to each variable @xmath14 in the range of the substitution ,",
    "we associate the multiset of domain variables which are bound to a term where @xmath14 occurs , and call it an @xmath15-sharing group . for instance , we associate , to the variable @xmath6 , the @xmath15-sharing group @xmath16 , to denote that @xmath6 appears once in @xmath17 and three times in @xmath18 . to the variable @xmath8 , we associate the @xmath15-sharing group @xmath19 , to denote that @xmath8 appears once in @xmath17 and once in @xmath20 .",
    "then we consider the collection of all the multisets so obtained @xmath21 , which describes both the sharing property and the exact amount of non - linearity in the given substitution .",
    "the domain we obtain is conceptually simple , but can not be directly used for static analysis , without a widening operator @xcite , since it contains infinite ascending chains .",
    "however , in this domain the role played by ( non-)linearity is manifest , and we can provide a constructive characterization of the optimal abstract unification operator . the cornerstone of the abstract unification is the concept of _ sharing graph _ which plays the same role as alternating paths @xcite for pair - sharing analysis .",
    "we use sharing graphs to combine different @xmath15-sharing groups during unification .",
    "the use of sharing graphs offers a new perspective for looking at variables in the process of unification , and simplifies the proofs of correctness and optimality of the abstract operators .",
    "we prove that sharing graphs yield an optimal abstract unification operator for single binding substitutions .",
    "we also provide a purely algebraic characterization of the unification process , which should help in implementing the domain through widening operators and in devising abstract operators for further abstractions of @xmath0 .",
    "we consider two well - known domains for sharing properties , namely , the reduced product @xcite @xmath1 and the more precise domain @xmath2 by andy king , and show that they can be immediately obtained as abstractions of @xmath0 . by exploiting the unification operator on @xmath0 , we provide the optimal abstract unification operators , in the case of single binding substitutions , for both domains .",
    "we show that we gain in precision w.r.t .  any previous attempt to design an abstract unification operator on these domains .",
    "this is the first time that abstract unification has been provided optimal for a domain including sharing and linearity information .",
    "surprisingly , the optimal abstract operators are able to improve not only aliasing and linearity information , but also groundness .",
    "we show that , in certain cases , we improve over @xmath22 @xcite .",
    "this is mainly due to the fact that our operators exploits the occur - check condition .",
    "as far as we know , there is no abstract unification operator in the literature , for a domain dealing with sharing , freeness and linearity , which is more precise than @xmath23 for groundness .",
    "unification for multi - binding substitutions is usually computed by considering one binding at a time .",
    "for instance , the unification of a substitution @xmath24 with @xmath25 is performed by first computing the unification of @xmath24 with @xmath26 , and then unifying the result with @xmath27 .",
    "actually , computing abstract unification one binding at a time is optimal in @xmath0 @xcite .",
    "we show that this is not the case for @xmath2 and @xmath1 .",
    "this means that the classical schema of computing unification iteratively on the number of bindings can not be used when looking for optimality with multi - binding substitutions , at least with these two domains .      in section [ sec : notation ] we recall some basic notions and the notations about substitutions , multisets and abstract interpretation . in section [ sec",
    ": existential ] we briefly recall the domain of existential substitutions and its operators , which will be used throughout the article . in section [ sec : shlinomega ] we define the domain @xmath0 , together with the unification operator , we show the optimality result and give an alternative algebraic characterization of the unification operator . in section [ sec : practical ] we exploit our results to devise the optimal unification operators for @xmath2 and @xmath1 , in the case of single binding substitutions . section [ sec : practice ] gives some evidence that there are practical advantages in using the optimal unification operators for @xmath2 and @xmath1 . in section [ sec : related ] we compare our domains and operators with those known in the literature .",
    "we conclude with some open questions for future work .",
    "the proofs of the main results of the paper are in appendix [ sec : mainproof ] , and the proofs of the results in section [ sec : practical ] are in appendix [ sec : proofs ] .",
    "the paper is a substantial expansion of @xcite , which introduces preliminary results of optimality for domains involving sharing and linearity properties .",
    "given a set @xmath28 , let @xmath29 be the powerset of @xmath28 and @xmath30 be the set of finite subsets of @xmath28 .",
    "given two posets @xmath31 and @xmath32 , we denote by @xmath33 the poset of monotonic functions from @xmath28 to @xmath34 ordered pointwise .",
    "we use @xmath35 to denote the order relation over @xmath33 .",
    "when an order for @xmath28 or @xmath34 is not specified , we assume the least informative order ( @xmath36 )",
    ". we also use @xmath37 to denote disjoint union and @xmath38 for the cardinality of the set @xmath28 .      in the following ,",
    "we fix a first order signature and a denumerable set of variables @xmath39 . given a term or other syntactic object @xmath40 , we denote by @xmath41 the set of variables occurring in @xmath40 and by @xmath42 the number of occurrences of @xmath8 in @xmath40 .",
    "when it does not cause ambiguities , we abuse the notation and prefer to use @xmath40 itself in the place of @xmath41 .",
    "for example , if @xmath43 is a term and @xmath44 , then @xmath45 should be read as @xmath46 .",
    "we denote by @xmath47 the empty substitution , by @xmath48 a substitution @xmath24 with @xmath49 , by @xmath50 and @xmath51 the domain and range of @xmath24 respectively .",
    "let @xmath52 be the set @xmath53 and , given @xmath54 , let @xmath55 be the projection of @xmath24 over @xmath56 , i.e. , the unique substitution such that @xmath57",
    "if @xmath58 and @xmath59 otherwise . given @xmath60 and @xmath61 two substitutions with disjoint domains , we denote by @xmath62 the substitution @xmath24 such that @xmath63 and @xmath64 if @xmath65 , for each @xmath66 . the application of a substitution @xmath24 to a term @xmath43 is written as @xmath67 or @xmath68 .",
    "given two substitutions @xmath24 and @xmath69 , their composition , denoted by @xmath70 , is given by @xmath71 .",
    "a substitution @xmath24 is idempotent when @xmath72 or , equivalently , when @xmath73 .",
    "a substitution @xmath74 is called renaming if it is a bijection from @xmath39 to @xmath39 ( this is equivalent to saying that there exists a substitution @xmath75 such that @xmath76 ) .",
    "instantiation induces a preorder on substitutions : @xmath24 is more general than @xmath69 , denoted by @xmath77 , if there exists @xmath78 such that @xmath79 . if @xmath80 is the equivalence relation induced by @xmath81 , we say that @xmath78 and @xmath24 are equal up to renaming when @xmath82 .",
    "the sets of substitutions , idempotent substitutions and renamings are denoted by @xmath83 , @xmath84 and @xmath85 respectively .",
    "given a set of equations @xmath86 , we write @xmath87 to denote that @xmath78 is a most general unifier of @xmath86 .",
    "any idempotent substitution @xmath78 is a most general unifier of the corresponding set of equations @xmath88 . in the following",
    ", we will abuse the notation and denote by @xmath89 the substitution @xmath90 , when it exists . in spite of a single binding substitution @xmath91",
    "we often use just the _ binding _ @xmath92 . in the rest of the paper",
    "we assume that a binding @xmath92 is idempotent , namely , that @xmath93 .",
    "a _ position _ is a sequence of positive natural numbers .",
    "we denote with @xmath94 the set of all positions and with @xmath95 the set of all positive natural numbers . given a term @xmath43 and a position @xmath96 ,",
    "we define @xmath97 inductively as follows : @xmath98 for any variable @xmath4 , an _ occurrence _ of @xmath4 in @xmath43 is a position @xmath96 such that @xmath99 .    in the rest of the paper , we use :",
    "@xmath56 , @xmath100 , @xmath101 to denote finite sets of variables ; @xmath102 for variables ; @xmath43 for terms ; @xmath103 for term symbols ; @xmath104 for constants ; @xmath105 for substitutions ; @xmath74 for renamings .",
    "a _ multiset _ is a set where repetitions are allowed .",
    "we denote by @xmath106 a multiset , where @xmath107 is a sequence with ( possible ) repetitions .",
    "we denote by @xmath108 the empty multiset .",
    "we will often use the polynomial notation @xmath109 , where @xmath110 is a sequence without repetitions , to denote a multiset @xmath28 whose element @xmath111 appears @xmath112 times .",
    "the set @xmath113 is called the _ support _ of @xmath28 and is denoted by @xmath114 .",
    "we also use the functional notation @xmath115 , where @xmath116 .    in this paper , we only consider multisets whose support is _",
    "finite_. we denote with @xmath117 the set of all the multisets whose support is _ any finite subset _ of @xmath118 .",
    "for example , both @xmath119 and @xmath120 are elements of @xmath121 .",
    "the cardinality of a multiset is @xmath122 .",
    "the new fundamental operation for multisets is the _ sum _ , defined as @xmath123 multiset sum is associative , commutative and @xmath108 is the neutral element .",
    "note that we also use @xmath124 to denote disjoint union for standard sets .",
    "the context will allow us to identify the proper semantics of @xmath125 .",
    "given a multiset @xmath28 and @xmath126 , the _ restriction _ of @xmath28 over @xmath118 , denoted by @xmath127 , is the only multiset @xmath34 such that @xmath128 and @xmath129 for each @xmath130 . finally , if @xmath131 , @xmath132 $ ] is an integer expression and @xmath133 , we define @xmath134 = \\sum_{x \\in { \\llfloor a \\rrfloor } } a(x ) \\cdot e[x ] \\enspace .\\ ] ] for example , given a multiset @xmath135 then @xmath136 .      given two sets @xmath137 and @xmath28 of concrete and abstract objects respectively , an _ abstract interpretation _",
    "@xcite is given by an approximation relation @xmath138 .",
    "when @xmath139 holds , this means that @xmath140 is a correct abstraction of @xmath141 . in particular , we are interested in the case when @xmath31 is a poset and @xmath142 means that @xmath140 is more precise than @xmath143 . in this case",
    "we require that , if @xmath139 and @xmath142 , then @xmath144 , too . in more detail ,",
    "we require what call the _ existence of a best abstract approximation assumption _ , i.e. , the existence of a map @xmath145 such that for all @xmath146 , it holds that @xmath147",
    ". the map @xmath148 is called the _ abstraction function _ and maps each @xmath141 to its best approximation in @xmath28 .    given a ( possibly partial ) function @xmath149",
    ", we say that @xmath150 is a correct abstraction of @xmath151 , and write @xmath152 , whenever @xmath153 assuming that @xmath154 is true whenever @xmath155 is not defined .",
    "we say that @xmath150 is the _ optimal _ abstraction of @xmath151 when it is the best correct approximation of @xmath151 , i.e. , when @xmath152 and @xmath156 in some cases , we prefer to deal with a stronger framework , in which the domain @xmath137 is also endowed with a partial order @xmath157 and @xmath145 is a left adjoint to @xmath158 , i.e. , @xmath159 the pair @xmath160 is called a _ galois connection_. in particular , we will only consider the case of _ galois insertions _ , which are galois connections such that @xmath161 is the identity map .",
    "if @xmath162 is a galois insertion and @xmath149 is a monotone map , the optimal abstraction @xmath163 always exists and it is definable as @xmath164 .",
    "the choice of the concrete domain depends on the observable properties we want to analyze .",
    "most of the semantics suited for the analysis of logic programs are based on computed answer substitutions , and most of the domains are expressed as abstractions of sets of substitutions . in general , we are not really interested in the substitutions , but in their quotient - set w.r.t .  an appropriate equivalence relation .",
    "let us consider a one - clause program @xmath165 , the goal @xmath166 , and the following answer substitutions : @xmath167 , @xmath168 , @xmath169 and @xmath170 .",
    "although @xmath60 and @xmath61 are equal up to renaming , the same does not hold for @xmath171 and @xmath172 .",
    "nonetheless , they essentially represent the same answer , since @xmath6 and @xmath8 are just two different variables we chose when renaming apart the clause @xmath165 from the goal @xmath166 , and therefore are not relevant to the user . on the other hand ,",
    "if @xmath171 and @xmath172 are answer substitutions for the goal @xmath173 , then they correspond to computed answers @xmath174 and @xmath175 and therefore are fundamentally different . as a consequence ,",
    "the equivalence relation we need to consider must be coarser then renaming , and must take into account the set of variables of interest , i.e. , the set of variables which appear in the goal .",
    "for these reasons , we think that the best solution is to use a domain of equivalence classes of substitutions . among the various domains proposed in the literature ( e.g.  )",
    ", we adopt the domain of existential substitutions @xcite , since it is explicitly defined as a quotient of a set of substitutions , w.r.t .  a suitable equivalence relation .",
    "moreover , the domain is equipped with all the necessary operators for defining a denotational semantics , namely , projection , renaming and unification .",
    "we briefly recall the basic definitions of the domain and the unification operator .    given @xmath176 and @xmath177 , the preorder @xmath178 is defined as follows : @xmath179    the notation @xmath180 states that @xmath60 is an instance of @xmath61 w.r.t .  the variables in @xmath56 .",
    "the equivalence relation induced by the preorder @xmath178 is given by : @xmath181 this relation precisely captures the extended notion of renaming which is needed to work with computed answer substitutions .",
    "it is easy to check that @xmath182 by choosing the renaming @xmath183 .",
    "note that @xmath184 is coarser than the standard equivalence relation @xmath80 : there is no renaming @xmath74 such that @xmath185 . as it happens for @xmath186 ,",
    "if we enlarge the set of variables of interest , not all equivalences between substitutions are preserved : for instance , @xmath187 .",
    "let @xmath188 be the quotient set of @xmath84 w.r.t .",
    "the domain @xmath189 of _ existential substitutions _ is defined as the disjoint union of all the @xmath188 for @xmath54 , namely : @xmath190 in the following we write @xmath191_{u}$ ] for the equivalence class of @xmath24 w.r.t .",
    "the partial order @xmath186 over @xmath189 is given by : @xmath192_u \\preceq [ \\theta']_v \\iff u \\supseteq v \\wedge \\theta \\preceq_v \\theta ' \\enspace .\\ ] ] intuitively , @xmath191_u \\preceq [ \\theta']_v$ ] means that @xmath24 is an instance of @xmath193 w.r.t .",
    "the variables in @xmath100 , provided that they are all variables of interest of @xmath24 .",
    "to ease notation , we often omit braces from the sets of variables of interest when they are given extensionally .",
    "so we write @xmath191_{x , y}$ ] instead of @xmath191_{\\{x , y\\}}$ ] and @xmath194 instead of @xmath195 . when the set of variables of interest is clear from the context or when",
    "it is not relevant , it will be omitted .",
    "finally , we omit the braces which enclose the bindings of a substitution when the latter occurs inside an equivalence class , i.e. , we write @xmath196_u$ ] instead of @xmath197_u$ ] .",
    "given @xmath198 , @xmath199_u , [ \\theta_2]_v \\in { \\mathit{isubst}}_{\\sim}$ ] , the most general unifier between these two classes is defined as the mgu of suitably chosen representatives , where variables not of interest are renamed apart . in formulas : @xmath200_u,[\\theta_2]_v)=    [ { \\mathrm{mgu}}(\\theta'_1 , \\theta'_2)]_{u \\cup v } \\enspace,\\ ] ] where @xmath201 , @xmath202 and @xmath203 .",
    "the last condition is needed to avoid variable clashes between the chosen representatives @xmath204 and @xmath205 .",
    "moreover , @xmath206 is the greatest lower bound of @xmath207 ordered by @xmath186 .",
    "let @xmath208 and @xmath209 .",
    "then @xmath210_{x , y},[\\theta_2]_{y , z})=[x / a , y / r(a , a , v),z / b]_{x , y , z } \\enspace,\\ ] ] by choosing @xmath211 and @xmath212 .",
    "in this case we have @xmath213    a different version of unification is obtained when one of the two arguments is an existential substitution , and the other one is a standard substitution . in this case",
    ", the latter argument may be viewed as an existential substitution where all the variables are of interest : @xmath214_u,\\delta)=    { \\mathrm{mgu}}([\\theta]_u,[\\delta]_{{\\mathit{vars}}(\\delta ) } ) \\enspace .\\ ] ] note that deriving the general unification in from the special case in is not possible .",
    "this is because there are elements in @xmath189 which can not be obtained as @xmath215_{{\\mathit{vars}}(\\delta)}$ ] for any @xmath216 ( see example [ ex : sim ] ) .",
    "this is the form of unification which is better suited for analysis of logic programs , where existential substitutions are the denotations of programs while standard substitutions are the result of unification between goals and heads of clauses .",
    "therefore , the rest of the paper will be concerned with the problem of devising optimal abstract operators corresponding to , for three different abstract domains .",
    "of course , unification is not the only operator needed to give semantics to logic programs : we also need projection , renaming and union .",
    "however , providing optimal abstract counterparts for these operators is generally a trivial task , and will not be considered here .",
    "we want to conclude the section with a small remark about our choice of the concrete domain . by adopting existential substitutions and the corresponding notion of unification",
    ", we greatly simplify all the semantic definitions which are heavily based on renaming variables apart .",
    "this is because all the details concerning renamings are shifted towards the inner level of the semantic domain , where they are more easily managed @xcite .",
    "the domain @xmath1 is one of the best known domains in the literature which combine sharing and linearity information .",
    "the domain @xmath12 records the information of variable aliasing , by abstracting the substitution @xmath217 into the set @xmath218 .",
    "the object @xmath219 , called a _ sharing group _ , states that @xmath220 and @xmath18 do share some variable ( the variable @xmath6 in this case ) .",
    "analogously , the sharing group @xmath221 states that @xmath222 and @xmath20 do share ( in this case the variable @xmath8 ) .",
    "one of the simplest way of adding linearity information is to record , in a separate object , the set of variables @xmath14 such that @xmath223 is a linear term . in our example",
    ", only @xmath18 is not linear .",
    "thus the substitution is abstracted into the pair @xmath224 .",
    "another known domain in the literature is @xmath225 whose main difference w.r.t .",
    "@xmath1 is that it only records sharing information between pairs of variables .",
    "thus , in @xmath225 , each sharing group has at most two elements .",
    "developing optimal unification operators for such abstract domains is a difficult task . in our opinion",
    ", this is because the gap between the substitutions and @xmath226 ( or @xmath225 ) is too wide and the combined effect of aliasing and linearity is difficult to grasp .",
    "we solve this problem by defining a new abstract domain @xmath0 which can be used to approximate @xmath189 .",
    "since @xmath0 has infinite ascending chains , in most cases it can not be directly used for the analysis",
    ". it should be thought of as a general framework from which other domains can be easily derived by abstraction . in this sense",
    ", @xmath0 closes the gap between the concrete domain of substitutions and the abstractions like @xmath1 or @xmath225 .",
    "the structure of @xmath0 has made it possible to develop clean and optimal abstract unification operators . from these , optimal operators for the simpler domains are easy to obtain , at least for single binding substitutions .    the idea underlying @xmath0 is to count the exact number of occurrences of the same variable in a term .",
    "it extends the standard domain @xmath12 by recording , for each @xmath227 and @xmath228 , not only the set @xmath229 but the multiset @xmath230 .",
    "an _ @xmath15-sharing group _ is a multiset of variables , i.e. , an element of @xmath231 .",
    "given variables @xmath232 , examples of @xmath15-sharing groups are @xmath233 , @xmath234 and @xmath235 .",
    "[ eq : theta-1 ] given a substitution @xmath24 and a variable @xmath236 , we define @xmath237    intuitively , @xmath238 is an @xmath15-sharing group which maps each variable @xmath14 to the number of occurrences of @xmath8 in @xmath223 .",
    "given @xmath239 , we have that @xmath240 , @xmath241 , @xmath242 , and @xmath243 .    given a set of variables @xmath56 and a set of @xmath15-sharing groups @xmath244 ( i.e. , @xmath245 ) , we say that the pair @xmath246 correctly approximates a substitution @xmath191_w$ ] if @xmath247 and for each @xmath248 , @xmath249 . in the following",
    "we denote by @xmath250_u$ ] the pair @xmath246 and write @xmath250_u \\rightslice    [ \\theta]_w$ ] to mean that @xmath250_u$ ] correctly approximates @xmath191_w$ ] .",
    "therefore , @xmath250_u$ ] correctly approximates @xmath191_u$ ] when @xmath244 contains at least all the @xmath15-sharing groups which may arise in @xmath24 , restricted to the variables @xmath56 .",
    "note that @xmath191_u$ ] is an equivalence class of substitutions , as defined in section [ sec : existential ] , while @xmath250_u$ ] is just a symbol to denote the pair of objects @xmath246 .",
    "we prefer this notation for the sake of uniformity with substitutions .",
    "[ th : wdapprox ] the relation @xmath251 is well defined .",
    "we can now define the domain @xmath0 of @xmath15-sharing groups .",
    "the domain @xmath0 is defined as @xmath252_u \\mid u \\in { \\wp_f}({\\mathcal{v } } ) , s \\subseteq { \\wp_m}(u ) ,    s \\neq \\emptyset \\rightarrow { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}\\multir}\\in s\\ } \\enspace , \\ ] ] and ordered by @xmath253_{u_1 } \\leq_\\omega [ s_2]_{u_2}$ ] iff @xmath254 and @xmath255 .",
    "the order relation corresponds to the approximation ordering , since bigger ( w.r.t @xmath256 ) elements correctly approximate a larger number of substitutions than smaller elements .",
    "the existence of the empty multiset , when @xmath244 is not empty , is required in order to obtain a galois insertion , instead of a galois connection . in order to simplify the notation , in the following we write an object @xmath257_u \\in { \\mathtt{shlin}^{\\omega}}$ ] as @xmath258_u$ ] by omitting the braces and the empty multiset . moreover , if @xmath259 , we write @xmath260 in place of @xmath261_u \\wedge b",
    "\\in s$ ] .",
    "we define the abstraction for a substitution @xmath191_u$ ] as @xmath262_u)=[\\ { \\theta^{-1}(v)|_u \\mid v \\in { \\mathcal{v}}\\}]_u    \\enspace .\\ ] ]    this is the least element of @xmath0 which correctly approximates @xmath191_u$ ] .",
    "note that by the proof of theorem  [ th : wdapprox ] it immediately follows that @xmath263 is well defined , i.e. , it does not depend from the choice of the representative for @xmath191_u$ ] .",
    "given @xmath264 and @xmath265 , we have @xmath266 , @xmath267 , @xmath268 and @xmath269 for all the other variables ( included @xmath14 ) . projecting over @xmath56 we obtain @xmath270_u)=[x^2,xyz , w]_u$ ] .",
    "[ ex : sim ] as we have said in section [ sec : existential ] , we show an element of @xmath189 , namely the existential substitution @xmath271_{x}$ ] , which can not be obtained as @xmath215_{{\\mathit{vars}}(\\delta)}$ ] for any substitution @xmath69 .",
    "in fact , consider any @xmath15-sharing group @xmath272_{{\\mathit{vars}}(\\delta)})$ ] .",
    "then either @xmath273 and @xmath274 or @xmath275 and @xmath276 .",
    "however , @xmath277_{x})= [ x^2]_{x}$ ] and @xmath278 does not contain any variable with multiplicity one .      in order to define an abstract unification operator over @xmath0",
    ", we need to introduce the concept of multigraph .",
    "we call ( directed ) _ multigraph _ a graph where multiple distinguished edges are allowed between nodes .",
    "we use the definition of multigraph which is customary in category theory @xcite .",
    "a _ multigraph _ @xmath279 is a tuple @xmath280 where @xmath281 and @xmath282 are the sets of _ nodes _ and _ edges _ respectively , @xmath283 is the _ source _ function which maps each edge to its start node , and @xmath284 is the _ target _",
    "function which maps each edge to its end node .",
    "a _ labeled _ multigraph @xmath279 is a multigraph equipped with a _ labelling _",
    "function @xmath285 which maps each node to its _ label _ in the given set @xmath286 .",
    "we write @xmath287 to denote the edge @xmath288 such that @xmath289 and @xmath290 .",
    "we also write @xmath291 to denote any edge @xmath288 such that @xmath289 and @xmath290 .",
    "moreover , with @xmath292 we denote the cardinality of the set @xmath293 . in the notation",
    "above , we omit `` @xmath294 '' whenever the multigraph @xmath279 is clear from the context .",
    "we call _ in - degree _",
    "( respectively _ out - degree _ ) of a node @xmath295 the cardinality of the set @xmath296 ( respectively @xmath297 ) .    given a multigraph @xmath279 , a _ path _",
    "@xmath298 is a _ non - empty _ sequence of nodes @xmath299 such that , for each @xmath300 , there is either an edge @xmath301 or an edge @xmath302 .",
    "nodes @xmath303 and @xmath304 are the _ endpoints _ of @xmath298 , and we say that @xmath298 _ connects _ @xmath303 and @xmath304 .",
    "a multigraph is _ connected _ when all pairs of nodes are connected by at least one path .",
    "we need to find the abstract counterpart of @xmath206 over @xmath0 , i.e. , an operation @xmath305 such that , if @xmath250_u \\rightslice [ \\theta]_u$ ] , then @xmath306_u,\\delta ) \\rightslice { \\mathrm{mgu}}([\\theta]_u,\\delta)\\ ] ] for each @xmath216 .",
    "note that we are looking for an abstract counterpart to the mixed unification in , where one of the two arguments is a plain substitution .",
    "in particular , we would like to find an operator which is the minimum element that satisfies the condition in , i.e. , the _ optimal _ abstract counterpart of @xmath206 . observe that , for a fixed @xmath56 , the set of all the elements @xmath250_u\\in { \\mathtt{shlin}^{\\omega}}$ ] is a complete lattice w.r.t .",
    "@xmath256 with the top element given by @xmath307_u$ ] and the meet operator given by @xmath308_u \\mid i \\in i \\ }",
    "=    \\big[\\bigcap_{i \\in i } s_i\\big]_u \\enspace , \\ ] ] for any family @xmath309_u \\mid i \\in i\\}$ ] of elements of @xmath0 .",
    "moreover , the relation @xmath251 is meet - preserving on the left , since if @xmath310_u \\rightslice [ \\theta]_u$ ] for each @xmath311 , then @xmath312_u \\mid i \\in i\\ } \\rightslice [ \\theta]_u$ ] .",
    "therefore , we may define the abstract @xmath206 as follows @xmath313_u,\\delta)=    { \\bigwedge}_\\omega \\big\\{[s']_{u ' } \\mid \\forall \\theta .",
    "[ s]_u \\rightslice [ \\theta]_u \\rightarrow [ s']_{u ' } \\rightslice    { \\mathrm{mgu}}([\\theta]_u , \\delta)\\big\\ } \\enspace , \\ ] ] where the definitions of @xmath251 and @xmath206 force @xmath314 to be @xmath315 . note that this is just a translation of the general definition of optimal operator in @xcite and it satisfies .",
    "this definition is completely non - constructive .",
    "the rest of this section is devoted to providing a constructive characterization for @xmath316_u,\\delta)$ ] .",
    "we begin to characterize the operation of abstract unification by means of graph theoretic notions .",
    "the _ multiplicity _ of an @xmath15-sharing group @xmath34 in a term @xmath43 is defined as : @xmath317    for instance , @xmath318 .",
    "the meaning of the map @xmath319 is made clear by the following proposition .",
    "[ prop : chi ] given a substitution @xmath24 , a variable @xmath8 and a term @xmath43 , we have that @xmath320 .",
    "moreover , given a set of variables @xmath56 , when @xmath321 , it holds that @xmath322 .",
    "let @xmath323 and @xmath324 , so that @xmath325 .",
    "given @xmath326 we have @xmath327 and @xmath328    if @xmath250_u \\rightslice [ \\theta]_u$ ] and we unify @xmath191_u$ ] with @xmath69 , some of the @xmath15-sharing groups in @xmath244 may be glued together to obtain a bigger resultant group .",
    "it happens that the gluing of the sharing groups during the unification of @xmath191_u$ ] with a single binding substitution @xmath91 may be represented by special labelled multigraphs which we call _ sharing graphs_.    let @xmath329 and @xmath330 .",
    "we look for a representation of the unification process between any substitution @xmath24 approximated by @xmath244 and the binding @xmath331 .",
    "we show that multigraphs can be easily used for this purpose .",
    "for instance , the substitution @xmath332 is approximated by @xmath244 . by unifying @xmath24 with @xmath333",
    "we obtain @xmath334 .",
    "note that any approximation of @xmath69 on the variables @xmath335 must include the sharing group @xmath336 generated by the variable @xmath6 .",
    "thus , any correct approximation of the unification must also contain @xmath336 .",
    "we want to associate to any @xmath15-sharing group @xmath34 in @xmath69 a special multigraph which represents the way the @xmath15-sharing groups in @xmath244 have been merged in order to obtain @xmath34 .",
    "the nodes of this multigraph are the @xmath15-sharing groups in @xmath244 ( possibly repeated any number of times ) .",
    "the following is a sharing graph for @xmath331 and @xmath244 : @xmath337[.4cm][c]{.7cm}{\\begin{center}$x^3$\\end{center}}}}_3 ^ 0}=\"a \" ,    \" a\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$y$\\end{center}}}}_0 ^ 1}=\"b \" ,    \" b\"+<0cm,{1.5cm}>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$y$\\end{center}}}}_0 ^ 1}=\"c \" ,    \" b\"+<0cm,-{1.5cm}>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$y$\\end{center}}}}_0 ^ 1}=\"d \" ,    { \" a \" \\ar \" b \" } ,    { \" a \" \\ar \" c \" } ,    { \" a \" \\ar \" d \" } } \\ ] ] where pedices and apices on a sharing group @xmath34 are respectively the values of @xmath338 and @xmath339 .",
    "for instance , since @xmath340 , then we put the pedice @xmath341 on the node @xmath342 to mean that @xmath4 is bound to a term containing @xmath341 occurrences of the same variable .",
    "symmetrically , since @xmath343 , then we put the apice @xmath344 on the node @xmath342 .",
    "the in - degree and the out - degree of the nodes reflect the values of apices and pedices . in this case , we have @xmath341 out - going edges from @xmath342 and no in - going edges .",
    "moreover , the multigraph must be connected , in order to guarantee that we can use a single variable to form the sharing group @xmath336 .    by summing the labels of all the nodes ,",
    "namely , @xmath345 , we obtain the @xmath15-sharing group @xmath336 which must appear in any correct approximation of the unification .    given any labelled multigraph @xmath279 , in the rest of the paper we assume that the codomain of the labelling function @xmath346 is @xmath231 , the set of @xmath15-sharing groups .    a _ sharing graph _ for the binding @xmath92 and a set of @xmath15-sharing groups @xmath244 is a labelled multigraph @xmath279 such that    1 .",
    "@xmath279 is connected ; 2 .   for each node @xmath347 , @xmath348 ; 3 .   for each node @xmath347 ,",
    "the out - degree of @xmath295 is equal to @xmath349 and the in - degree of @xmath295 is equal to @xmath350 .",
    "the _ resultant @xmath15-sharing group _ of @xmath279 is @xmath351    [ ex : shgraph ] let @xmath352 .",
    "the following is a sharing graph for @xmath353 and @xmath244 : @xmath337[.4cm][c]{.7cm}{\\begin{center}$ux^2$\\end{center}}}}_2 ^ 0}=\"a \" ,    \" a\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xy$\\end{center}}}}_1 ^ 1}=\"b \" ,    \" b\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$vz$\\end{center}}}}_0 ^ 1}=\"c \" ,    \" b\"+<0cm,-{1.5cm}>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xy$\\end{center}}}}_1 ^ 1}=\"d \" ,    \" b\"+<{2cm},-{1.5cm}>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$wz$\\end{center}}}}_0 ^ 1}=\"e \" ,    { \" a \" \\ar \" b \" } ,    { \" a \" \\ar \" d \" } ,    { \" b \" \\ar \" c \" } ,    { \" b \" \\ar \" c \" } ,    { \" d \" \\ar \" e \" } } \\ ] ] where pedices and apices on a sharing group @xmath34 are respectively the value of @xmath338 and @xmath354 . therefore the resultant sharing group is @xmath355 .",
    "it is worth noting that , given any set of @xmath15-sharing groups @xmath244 and binding @xmath92 , there exist many different sharing graphs for @xmath92 and @xmath244 .",
    "each sharing graph yields a resultant sharing group which must be included in the result of the abstract unification operator .",
    "of course , different sharing graphs may give the same resultant sharing group .",
    "the abstract unification operator is defined by collecting all the resultant sharing groups .",
    "[ def : pre - mguomega ] let @xmath177 , @xmath244 be a set of @xmath15-sharing groups with @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] , @xmath92 be a binding , and @xmath356 .",
    "the set of resultant @xmath15-sharing groups for @xmath92 and @xmath244 is @xmath357 we lift @xmath358 to an operation over @xmath0 .",
    "@xmath313_u , x / t)=[{\\mathrm{mgu}}(s , x / t)]_u \\enspace .\\ ] ]    this is a particular case of the abstract unification operator , for single binding substitutions and @xmath356 .",
    "[ ex : shgraphsimple ] let @xmath244 be as in example [ ex : shgraph ] . the following is a sharing graph for @xmath359 and @xmath244 :",
    "@xmath337[.4cm][c]{.7cm}{\\begin{center}$ux^2$\\end{center}}}}_2 ^ 0}=\"a \" ,    \" a\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xyz$\\end{center}}}}_1 ^ 3}=\"b \" ,    \" b\"+<0.5cm,0.1cm>*{}=\"b1 \" ,    \" b\"+<0.5cm,-0.1cm>*{}=\"b2 \" ,    { \" a \" \\ar @/^/   \" b \" } ,    { \" a \" \\ar @/_/   \" b \" } ,    { \" b1 \" \\ar @(ur , dr ) \" b2 \" } , } \\ ] ] where pedices and apices on a sharing group @xmath34 are respectively the value of @xmath338 and @xmath360 . therefore @xmath361 . note that this sharing group can actually be generated by the substitution @xmath362 where @xmath140 is a ground term .",
    "let @xmath363 .",
    "it is the case",
    "that @xmath250_u \\rightslice [ \\theta]_u$ ] and @xmath364_u,\\{x / r(y , y , z)\\})$ ] performs exactly the variable aliasings depicted by the sharing graph .",
    "actually @xmath364_u , \\{x / r(y , y , z)\\ } ) = [ x / r(v_1,v_1,v_1),\\linebreak y / v_1,u / v_1,v / a , w / a]_u=[\\eta]_u$ ] and @xmath365 .",
    "we give here an intuition of the way sharing graphs work .",
    "assume given a set of @xmath15-sharing groups @xmath250_u$ ] and a binding @xmath92 with @xmath356 .",
    "we want to compute @xmath366_u$ ] .",
    "to this aim , for any substitution @xmath24 approximated by @xmath250_u$ ] , that is , @xmath250_u \\rightslice [ \\theta]_u$ ] , we compute @xmath367_u,\\{x / t\\}))$ ] .    for any @xmath368 , assume that there exist @xmath369 such that @xmath370 and @xmath371 .",
    "when unifying @xmath24 with the binding @xmath92 , we use the fact that @xmath372 . by prop .",
    "[ prop : chi ] , @xmath17 contains @xmath373 instances of @xmath374 and @xmath375 instances of @xmath376 .",
    "symmetrically , @xmath68 contains @xmath377 instances of @xmath374 and @xmath378 instances of @xmath376 .",
    "assume that @xmath17 and @xmath68 only differ for the variables occurring in them ( and not for the structure of terms ) .",
    "then , an arrow from the sharing group @xmath379 to @xmath380 represents the fact that , in @xmath381 , one of the copies of @xmath374 is aliased to one of the copies of @xmath376 , i.e. , that there are corresponding positions in @xmath17 and @xmath68 where the two terms contain the variables @xmath374 and @xmath376 respectively .",
    "the third condition for sharing graphs implies that each occurrence of @xmath374 and @xmath376 is aliased to some other variable .",
    "the first condition ( the sharing graph must be connected ) ensures that all the variables corresponding to the @xmath15-sharing groups involved in the sharing graph are aliased to each other . in other words ,",
    "given any two such variables , they are aliased .",
    "although here we are only considering the case when @xmath17 and @xmath68 differ for the variables occurring in them , we will show that it is enough to reach correctness and optimality .",
    "the next example applies this intuition to a concrete case .",
    "consider example [ ex : shgraphsimple ] , where @xmath382 and @xmath363 .",
    "let @xmath383 and @xmath384 , thus @xmath370 and @xmath371 . when unifying @xmath24 with the binding @xmath359 we have that @xmath385 and @xmath386 .",
    "note that @xmath17 contains @xmath387 instances of @xmath374 and @xmath388 instance of @xmath376 .",
    "symmetrically , @xmath389 contains @xmath390 instances of @xmath374 and @xmath391 instances of @xmath376 .",
    "moreover , @xmath17 and @xmath389 only differ for the variables occurring in them .",
    "thus , the three edges in the sharing graph of example [ ex : shgraphsimple ] correspond to the following aliasings :    @xmath392 in particular , the last arrow from @xmath376 to itsself , corresponds to the self - loop in the sharing graph .",
    "the unification operator @xmath393_u , x / t)$ ] can be extended to the case @xmath394 .",
    "the idea is to enlarge @xmath244 by including all the singletons in @xmath395 .",
    "[ def : mguomega ] let @xmath177 , @xmath244 be a set of @xmath15-sharing groups with @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] and @xmath92 be a binding .",
    "@xmath313_u , x / t)={\\mathrm{mgu}}_\\omega([s \\cup \\ { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v \\multir    \\mid v \\in { \\mathit{vars}}(x / t ) \\setminus u \\ } ] _ { u \\cup { \\mathit{vars}}(x / t)},x / t )    \\enspace .\\ ] ]    note that , for a generic abstract domain , the method of extending the abstract object to include all the variables in the concrete substitution @xmath69 may result in a non - optimal abstract unification . for example , this is what happens in the case of the domain @xmath12 , as shown in @xcite .",
    "however , we will prove that , in the case of @xmath0 , the abstract mgu in definition [ def : mguomega ] is optimal .",
    "this operator can be extended to multi - binding substitutions in the obvious way , namely by iterating the single binding operator .",
    "we define @xmath316_u,\\delta)$ ] with @xmath216 and @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] by induction on the number of bindings : @xmath396_u,\\epsilon)&=[s]_u \\enspace , \\\\    { \\mathrm{mgu}}_\\omega([s]_u,\\{x / t\\ } \\uplus \\delta)&={\\mathrm{mgu}}_\\omega (    { \\mathrm{mgu}}_\\omega([s]_u , x / t),\\delta )    \\enspace .",
    "\\end{split}\\ ] ]    it is possible to prove that @xmath316_u,\\delta)$ ] is optimal for multi - binding substitutions @xcite . since optimality of iterative multi - binding unification is not inherited by the abstractions of @xmath0 ( as we show in section  [ sec : multibind ] ) , we will focus on single binding unification . in the rest of the paper ,",
    "we only consider bindings @xmath92 which are idempotent , namely , such that @xmath397 .",
    "we now show that @xmath316_u,\\delta)$ ] is correct w.r.t",
    ".  concrete unification .",
    "we show correctness for multi - binding substitutions , since it is a trivial extension of the single binding case .",
    "in fact , composition of correct operators is still correct .",
    "first of all , we extend the definition of @xmath398 to the case when it is applied to a sharing group @xmath34 .    given @xmath228 and @xmath34 an @xmath15-sharing group",
    ", we define @xmath399    in order to prove the correctness of abstract unification , we need the following auxiliary property .",
    "[ prop : thetam1 ] given substitutions @xmath24 , @xmath400 and an @xmath15-sharing group @xmath34 , we have @xmath401    [ thm : correctness_mgu_omega ] the operation @xmath402 is correct w.r.t .",
    "@xmath206 , i.e. , @xmath403_u \\in { \\mathtt{shlin}^{\\omega } } , \\delta \\in { \\mathit{isubst}}.~[s]_u \\rightslice [ \\theta]_{u } \\implies   { \\mathrm{mgu}}_{\\mathrm{\\omega}}([s]_u,\\delta ) \\rightslice   { \\mathrm{mgu}}([\\theta]_{u},\\delta ) \\enspace .\\ ] ]    let @xmath404 , @xmath405 and @xmath406 . therefore @xmath270_u)=    [ x^3,x , y , z]_u$ ] .",
    "if we proceed with the concrete unification of @xmath191_u$ ] with @xmath69 , we have @xmath364_u,\\delta)=[\\theta']_u$ ] with @xmath407 and @xmath408 .",
    "this gives the following results : @xmath409 with @xmath410_u=[\\theta]_u$ ] .",
    "now , let @xmath411 be obtained from @xmath412 by replacing each occurrence of a variable in @xmath413 with a different fresh variable , @xmath414 and @xmath74 be a substitution mapping variables to variables such that @xmath415 for each @xmath416 .",
    "note that @xmath74 is not a renaming , since it is not bijective .",
    "we have : @xmath417 following the proof , we build a multigraph @xmath279 as follows : @xmath418[.4cm][c]{.85cm}{\\begin{center}$x^3 ( u)$\\end{center}}}}_3 ^ 0 \\ar[d ] \\ar[dr ] \\ar[drr ] &      { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$x ( u_1)$\\end{center}}}}_1 ^ 0 \\ar[dl ] & { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$x ( u_2)$\\end{center}}}}_1 ^ 0      \\ar[dl ] &      { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$x ( u_3)$\\end{center}}}}_1 ^ 0   \\ar[dl ] & { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$x ( w)$\\end{center}}}}_1 ^ 0 \\ar[dl]\\\\      { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$y ( u_4)$\\end{center}}}}_0 ^ 2 & { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$y ( u_5)$\\end{center}}}}_0 ^ 2 & { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$y ( u_6)$\\end{center}}}}_0 ^ 2 &      { \\ovalbox{\\parbox[c][.4cm][c]{.85cm}{\\begin{center}$z ( u_7)$\\end{center}}}}_0 ^ 1    } \\ ] ] note that we have chosen to annotate every sharing group with the corresponding variable in @xmath419 .",
    "this is not a sharing graph since it is not connected , but if we take @xmath420 , the restriction of @xmath279 to the nodes annotated with a variable in @xmath421 is a sharing graph whose resultant @xmath15-sharing group is @xmath422 .",
    "we now prove that @xmath402 is not only correct , but also optimal for a single binding substitution , i.e. , it is the least correct abstraction .",
    "this means proving that , given a set of @xmath15-sharing groups @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] , a binding @xmath92 , and an @xmath15-sharing group @xmath423_u , x / t)$ ] , there exists a substitution @xmath215_u$ ] such that @xmath250_u \\rightslice [ \\delta]_u$ ] and @xmath424_u,\\{x / t\\}))$ ] .",
    "first of all , we prove optimality of @xmath393_u , x / t)$ ] in the special case of @xmath356 .",
    "next , we extend this result to the general case .    [",
    "ex : optimality ] consider @xmath425 and the binding @xmath426 .",
    "the following is a sharing graph for @xmath426 and @xmath244 whose resultant @xmath15-sharing group is @xmath427 .",
    "@xmath418[.4cm][c]{.7cm}{\\begin{center}$xu$\\end{center}}}}_1 ^ 0 \\ar[dr ] & & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xv$\\end{center}}}}_1 ^ 0 \\ar[dl]\\\\      & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$y$\\end{center}}}}_0 ^ 2    } \\ ] ] we show how to find a substitution @xmath215_u$ ] such that the @xmath15-sharing group @xmath428_u,\\{x / s(y , y)\\}))$ ] .",
    "let @xmath429 .",
    "for each node @xmath295 of the sharing graph , we consider a different fresh variable @xmath430 .",
    "assume that the node labelled with @xmath431 in the upper - left corner is node 1 , and proceed clockwise to number the other nodes .    for each variable @xmath432 , we associate to @xmath433 a term containing all the variables @xmath434 such that the label of the @xmath435-th node contains the variable @xmath7 .",
    "thus , we define @xmath436 where @xmath437 correspond to the node containing @xmath6 .",
    "analogously , we define @xmath438 and @xmath439 .",
    "we now define @xmath440 in a different way , namely by replacing in @xmath441 each occurrence of the variable @xmath5 with a term similar to @xmath442 , with the difference that @xmath443 is replaced with the variables @xmath437 and @xmath444 .",
    "the choice of @xmath437 and @xmath444 is obvious by looking at the sharing graph , since the first and second node are the sources of the two edges targeted at the node three .",
    "therefore we obtain @xmath445 .    summing up",
    ", we have : @xmath446 it is easy to check that @xmath250_u \\rightslice [ \\delta]_u$ ] and @xmath447 hence @xmath448_u)=[x^2uvy]_u$ ] .    in the above example we have shown how to find a special substitution such that its fresh variables are unified according to the arrows in a sharing graph .",
    "the same idea is exploited in the next theorem for proving the optimality of the abstract unification operator @xmath402 . for any @xmath15-sharing group @xmath449_u , x / t)$ ]",
    ", we provide a substitution @xmath69 obtained as in example [ ex : optimality ] , such that @xmath250_u$ ] approximates @xmath215_u$ ] and @xmath450_u,\\{x / t)\\})$ ] .",
    "[ th : lpopt ] the single binding unification @xmath393_u , x / t)$ ] is optimal w.r.t .",
    "@xmath206 , under the assumption that @xmath356 , i.e. , : @xmath451_u , x / t)~\\exists \\delta\\in   { \\mathit{isubst}}.~[s]_u \\rightslice [ \\delta]_u \\text { and } b\\in",
    "\\alpha_{\\mathrm{\\omega}}({\\mathrm{mgu}}([\\delta]_u,\\{x / t\\ } ) ) \\enspace .\\ ] ]    the previous proof requires that @xmath356 .",
    "however , the same construction also works when this condition does not hold .",
    "given @xmath330 and @xmath452 , we want to compute @xmath393_u , x / s(y , z))$ ] . by extending the domain of the variables of interests , we obtain @xmath453_v= [ x^2,x^2y , z]_{x , y , z}$ ] .",
    "one of the sharing graphs for @xmath454 and @xmath453_v$ ] is @xmath455[.4cm][c]{.7cm}{\\begin{center}$x^2$\\end{center}}}}^0_2 \\ar[r ]   \\ar[d ] & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$x^2y$\\end{center}}}}^1_2 \\ar[d ] \\ar[dr]\\\\    { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$z$\\end{center}}}}^1_0 & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$z$\\end{center}}}}^1_0 & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$z$\\end{center}}}}^1_0 } \\ ] ] following the proof of the previous theorem , we obtain the substitution @xmath456 where @xmath453_v \\rightslice [ \\delta']_v$ ] and",
    "@xmath457_v,\\{x / s(y , z)\\}))$ ]",
    ". however we are looking for a substitution @xmath69 such that @xmath250_u \\rightslice [ \\delta]_u$ ] and @xmath458_u,\\{x / s(y , z)\\}))$ ] .",
    "nonetheless , we may choose @xmath459 ( or , if we prefer , @xmath460 ) to get the required substitution .",
    "this is not a fortuitous coincidence .",
    "we may show that it consistently happens every time we apply theorem [ th : lpopt ] to an abstract unification where @xmath461 .",
    "therefore , we can prove the main result of the paper .",
    "[ th : optimality_extension ] the single binding unification @xmath358 with extension is optimal w.r.t .",
    "@xmath206 .",
    "the domain @xmath0 has not been designed to be directly implemented , but some of its abstractions could . providing a simpler definition for the set of resultant @xmath15-sharing groups could help in developing the abstract operators for its abstractions .",
    "we show that given a set @xmath244 of @xmath15-sharing groups and a binding @xmath92 , the set of resultant @xmath15-sharing groups has an elegant algebraic characterization .    by definition of sharing graph",
    ", a set of nodes @xmath462 labelled with @xmath15-sharing groups of @xmath244 can be turned into a sharing graph for @xmath244 and @xmath92 if and only if the condition on the out - degree and in - degree is satisfied and the obtained graph is connected .",
    "the condition on the degrees says that for each node @xmath463 labelled with the sharing group @xmath464 , the out - degree of @xmath463 must be equal to @xmath465 .",
    "symmetrically , the in - degree must be equal to @xmath466 . as a consequence , the sum of the out - degrees of all the nodes @xmath467 must be equal to the sum of the in - degrees of all the nodes @xmath468 .",
    "this is because each edge has a source and a target node .",
    "moreover , in order to be connected , any graph needs at least @xmath469 edges .",
    "since the number of edges is equal to the sum of in - degrees of all the nodes , it turns out that such a sum must be equal to or greater than @xmath469 .",
    "surprisingly , this is enough to construct a sharing graph from @xmath462 .",
    "[ th : algebraic ] let @xmath244 be a set of @xmath15-sharing groups and @xmath92 be a binding .",
    "then @xmath470 iff there exist @xmath471 , @xmath472 which satisfy the following conditions :    1 .",
    "@xmath473 ; 2 .",
    "@xmath474 ; 3 .   either @xmath475 or @xmath476 .",
    "following the above theorem , we can give an algebraic characterization of the abstract unification operator as follows .",
    "[ cor : mgu - algebraic ] given a set of @xmath15-sharing groups @xmath244 and a binding @xmath92 , we have that @xmath477 where @xmath478    consider @xmath479 and the equation @xmath480 .",
    "then if we choose @xmath481 , we have @xmath482 . therefore @xmath483 . if we take @xmath484 , although @xmath485 , we have @xmath486 .",
    "this only proves that @xmath487 can not be obtained by the multiset @xmath488 .",
    "if we check for every possible multiset over @xmath244 , we have that @xmath489 .",
    "this characterization of the abstract mgu will be the key point for devising the optimal abstract unification operators on the abstractions of @xmath0 .",
    "let @xmath148 be the abstraction function from @xmath189 to an abstract domain @xmath28 .",
    "if we are able to factor @xmath148 through a galois connection @xmath490 as @xmath491 , then the optimal abstract unification for @xmath148 is exactly @xmath492 .",
    "however , this expression is helpful when it may be simplified in order to use only objects in @xmath28 .",
    "our algebraic characterization makes the simplification feasible , as we show in the following section .",
    "we consider two domains for sharing analysis with linearity information , namely , the domain proposed in @xcite and the classical reduced product @xmath1 . they are defined as abstractions of @xmath0 through galois insertions .",
    "this allows us to design optimal abstract operators for both of them , by exploiting the results introduced so far . by composing each galois insertion with @xmath493",
    ", we get the corresponding abstraction function for substitutions ( * ? ? ?",
    "4.2.3.1 ) .",
    "we first consider the domain for combined analysis of sharing and linearity in @xcite .",
    "the idea is to enhance the domain @xmath12 by annotating each sharing group with linearity information on each variable .",
    "for instance , the object @xmath494 represents the sharing group @xmath234 and the information that @xmath5 may be non - linear ( while @xmath4 and @xmath7 are definitely linear ) .",
    "the objects in this domain can be easily viewed as abstraction of @xmath15-sharing groups .",
    "intuitively , in order to abstract an @xmath15-sharing groups , one simply needs to replace each exponent equal to or greater than @xmath495 with @xmath496 .",
    "let us now formalize the domain as an abstraction of @xmath0 .",
    "an @xmath15-sharing group ( which is a multiset @xmath497 whose support is finite ) is abstracted into a map @xmath498 such that its support @xmath499 is finite .",
    "we call such a map the _ 2-sharing group_. we use a polynomial notation for 2-sharing groups as for @xmath15-sharing groups . for instance",
    ", @xmath500 denotes the 2-sharing group whose support is @xmath501 , such that @xmath502 and @xmath503 .",
    "we denote with @xmath504 the 2-sharing group with empty support .",
    "note that in @xcite the number @xmath495 is used as an exponent instead of @xmath496 , but we prefer this notation to be coherent with @xmath15-sharing groups .",
    "we denote @xmath505 by @xmath506 , where the ordering on @xmath507 is extended in the obvious way , i.e. , for all @xmath508 we have that @xmath509 .",
    "a 2-sharing group @xmath40 represents the sets @xmath510 of @xmath15-sharing group given by : @xmath511 for instance , the 2-sharing group @xmath494 represents the set of @xmath15-sharing groups @xmath512 .",
    "the idea is to use 2-sharing groups to keep track of linearity : if @xmath513 , it means that the variable @xmath4 is not linear in the 2-sharing group @xmath40 .",
    "in the rest of this section , we use the term `` sharing group '' as a short form of 2-sharing group , when this does not cause ambiguity .",
    "an @xmath15-sharing group @xmath34 may be abstracted into the 2-sharing group @xmath514 given by : @xmath515 the next proposition shows two useful properties of the maps @xmath516 and @xmath517 .",
    "[ prop : abstraction ] the following properties hold :    1 .",
    "[ eq : abstraction1 ] @xmath518 .",
    "[ eq : abstraction2 ] @xmath519 .",
    "since we do not want to represent definite non - linearity , we introduce an order relation over sharing groups as follows : @xmath520 and we restrict our attention to downward closed sets of sharing groups .",
    "we denote by @xmath521 the set of 2-sharing groups whose support is a subset of @xmath100 .",
    "the domain we are interested in is the following : @xmath522_u \\mid s \\in \\wp_{{{\\mathop{\\downarrow}}}}({\\mathit{sg}^2}(u ) ) ,    u \\in { \\wp_f}({\\mathcal{v } } ) , s \\neq",
    "\\emptyset \\rightarrow \\emptyset \\in s \\bigr \\ }",
    "\\enspace , \\ ] ] where @xmath523 is the powerset of downward closed subsets of @xmath524 according to @xmath81 and @xmath253_{u_1 } \\leq_{\\mathrm{2}}[s_2]_{u_2}$ ] iff @xmath254 and @xmath255 .",
    "for instance , the set @xmath525 is not downward closed , while @xmath526 is downward closed .",
    "there is a galois insertion of @xmath2 into @xmath0 given by the pair of adjoint maps @xmath527 and @xmath528 : @xmath529_u)&=\\left [ \\bigcup \\ { \\gamma_{\\mathrm{2}}(o ) \\mid o \\in s \\ }",
    "\\right]_u    \\enspace , \\\\    \\alpha_{\\mathrm{2}}([s]_u)&=\\left [ { { \\mathop{\\downarrow}}}\\ { \\alpha_{\\mathrm{2}}(b ) \\mid b \\in s \\ } \\right]_u    \\enspace .\\end{aligned}\\ ] ] with an abuse of notation , we also apply @xmath517 and @xmath516 to subsets of @xmath15-sharing groups and 2-sharing groups respectively , by ignoring the set of variables of interest . for instance , @xmath530 .",
    "[ th : linp - galois ] the pair @xmath531 is a galois insertion .",
    "now we may define the optimal mgu for @xmath2 and single binding substitutions as follows :    given @xmath250_u \\in { \\mathtt{shlin}^2}$ ] and the binding @xmath92 , we define @xmath532_u , x / t)= \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}(\\gamma_{\\mathrm{2}}([s]_u),x / t ) ) \\enspace .\\ ] ]    by construction , @xmath533 is the optimal abstraction of @xmath402 , hence also of @xmath206 . in the case",
    "where @xmath356 , by using additivity of @xmath516 we get : @xmath534_u , x / t)=\\bigl[\\alpha_{\\mathrm{2}}(\\gamma_{\\mathrm{2}}(s ) \\setminus    { \\mathit{rel}}(\\gamma_{\\mathrm{2}}(s),x , t ) ) \\cup \\\\    \\alpha_{\\mathrm{2}}\\bigl(\\ { { \\uplus}{\\mathcal{r}}\\mid { \\mathcal{r}}\\in    { \\wp_m}({\\mathit{rel}}(\\gamma_{\\mathrm{2}}(s),x , t)),\\\\",
    "\\sum_{b \\in { \\mathcal{r } } } \\chi(b , x ) = \\sum_{b \\in { \\mathcal{r } } }    \\chi(b , t ) \\geq { |{\\mathcal{r}}|}-1 \\}\\bigr)\\bigr]_u \\enspace .\\end{gathered}\\ ] ]    now we want to simplify eq .",
    "[ eq : mguandythefirst ] .",
    "in particular we would like to get rid of the abstraction and concretization maps and to express the result using only objects and operators in @xmath2 .",
    "therefore , we need to define operations in @xmath2 which correspond to @xmath125 and @xmath319 in @xmath0 .",
    "the operation on 2-sharing groups which corresponds to multiset union on @xmath15-sharing groups , is given by @xmath535 where @xmath536 and @xmath537 .",
    "we will use @xmath538 for @xmath539 . given a sharing group @xmath40",
    ", we also define the _ delinearization _ operator : @xmath540 note that @xmath541 .",
    "the operator is extended pointwise to sets and multisets .",
    "a fundamental role is played by the notion of multiplicity of a sharing group in a term .",
    "while the multiplicity of an @xmath15-sharing group in a term is a single natural number , every object in @xmath2 represents a set of @xmath15-sharing groups , hence its multiplicity should be a set of natural numbers . actually , it is enough to consider intervals .",
    "we define the minimum @xmath542 and maximum @xmath543 multiplicity of @xmath40 in @xmath43 as follows : @xmath544 sum and product on integers are lifted in the obvious way , namely , the sum is @xmath496 if and only if at least one of the addenda is @xmath496 and @xmath545 for any @xmath546 , while @xmath547 .",
    "the maximum multiplicity @xmath548 either is equal to the minimum multiplicity @xmath549 or it is infinite .",
    "note that , if @xmath34 is an @xmath15-sharing group represented by @xmath40 , i.e. , @xmath550 , then @xmath551 .",
    "actually , not all the values between @xmath549 and @xmath548 may be assumed by @xmath552 .",
    "let @xmath553 and @xmath554 . according , to our definition , @xmath555 . however , it is obvious that if @xmath556 , then @xmath552 is an even number .",
    "according to the above definitions , we define the multiplicity of a multiset of sharing groups as @xmath557 even if this is a superset of all the possible values which can be obtained by combining the multiplicities of all the sharing groups in @xmath421 , this definition is sufficiently accurate to allow us to design the optimal abstract unification .",
    "we extend in the obvious way the definition of @xmath558 ( see corollary [ cor : mgu - algebraic ] ) from @xmath15-sharing groups to 2-sharing groups , i.e. , @xmath559 and we prove the following    [ th : pre - mguandy ] given @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] and the binding @xmath92 with @xmath356 , we have that @xmath560_u , x / t ) & = [ ( s\\setminus s ' ) \\cup \\\\        & { { \\mathop{\\downarrow}}}\\bigl\\ { { \\biguplus}y \\mid y \\in { \\wp_m}(s ' ) ,        n \\in \\chi(y , x ) \\cap \\chi(y , t).\\ n \\geq { |y|}-1     \\bigr\\}]_u \\enspace ,    \\end{split}\\ ] ] where @xmath561 .",
    "let @xmath562 and @xmath563 .",
    "we have that @xmath564 and @xmath565 .",
    "since @xmath566 contains two occurrences of @xmath7 , the `` actual '' multiplicity of the sharing group @xmath567 in @xmath566 should be a multiple of @xmath495 .",
    "but we do not need to check this condition and can safely approximate this set with @xmath568 .",
    "this works because we can always choose a number which is contained in both @xmath569 and @xmath570 and which is an `` actual '' multiplicity .",
    "for instance , we can take @xmath571 and since we have @xmath572 , we get that the sharing group @xmath573 belongs to @xmath574_u , x / f(z , z))$ ] .",
    "this sharing group can be generated by the substitution @xmath575 when the variables of interest are @xmath576 .",
    "theorem [ th : pre - mguandy ] gives a characterization of the abstract unification over @xmath2 .",
    "however , it can not be directly implemented , since one needs to check a certain condition for each element of @xmath577 , which is an infinite set .",
    "nonetheless , this is an important starting point to prove correctness and completeness of the abstract unification algorithm which we are going to introduce .",
    "the characterization in theorem [ th : pre - mguandy ] may be used even when @xmath394 , if we first enlarge the set of variables of interest in order to include all @xmath578 .",
    "[ th : mguandy2 ] given @xmath250_u$ ] in @xmath2 and the binding @xmath92 , let @xmath579 be @xmath580 .",
    "then , @xmath532_u , x / t)= { \\mathrm{mgu}}_{\\mathrm{2}}([s \\cup \\ { v_1 , \\ldots , v_n \\}]_{u \\cup v},x / t ) \\enspace .\\ ] ]    the previous theorem states that enlarging the set of variables of interest preserves optimality .      in order to obtain an algorithm from the characterization in theorem [ th : pre - mguandy ] we need to avoid the use of @xmath577 and to develop a procedure able to compute the resultant sharing groups by inspecting subsets ( not multisets ! ) of @xmath581 . in general ,",
    "any @xmath582 yields more than one sharing group , since every element in @xmath118 may be considered more than once .",
    "however , since @xmath2 is downward closed , it is enough to compute the maximal resultant sharing groups .    given",
    "@xmath582 and the binding @xmath92 , assume that we are only interested in those sharing groups whose support is @xmath583 . by joining ( multiple copies of ) the sharing groups in @xmath118 ,",
    "any resultant sharing group @xmath40 is between @xmath584 and @xmath585 , i.e. , @xmath586 , where @xmath587 is the pointwise extension of the delinearization operator ( see eq .",
    "[ eq : delinearization ] ) .",
    "note that , if @xmath118 is badly chosen , it is possible that we are not able to generate any sharing group with this support . in this computation , the notion of multiplicity of a sharing group in a term plays a major role .",
    "for example , given the binding @xmath92 , if @xmath588 for each @xmath589 , then @xmath584 is a resultant sharing group only if there is a unique sharing group @xmath589 such that @xmath590 .",
    "if there are @xmath591 such that @xmath592 and @xmath593 then @xmath584 is a resultant sharing group .",
    "moreover , we may join two copies of each sharing group in @xmath118 , and therefore also @xmath594 is a resultant sharing group .",
    "now we can define the notions of linearity and non - linearity on the abstract domain .",
    "in addition , we also introduce a new notion of strong non - linearity . given @xmath582 , we partition @xmath118 in three subsets @xmath595 , @xmath596 and @xmath597 .",
    "[ def : andyalgo ] given a set @xmath244 of sharing groups and @xmath582 , we say that @xmath118 is :    * _ linear _ for the term @xmath43 if for all @xmath589 it holds that @xmath598 ; * _ non - linear _ for the term @xmath43 if there exists @xmath589 such that @xmath599 ; * _ strongly non - linear _ for the term @xmath43 if there exists @xmath600 such that @xmath601 or there exists @xmath602 such that @xmath603 .",
    "analogously , we define linearity and non - linearity of @xmath118 for the variable @xmath4 .",
    "note that , if @xmath43 is a variable , the non - linear and strongly non - linear cases coincide .",
    "we now present the algorithm for computing the abstract unification in @xmath2 .",
    "[ th : mguandy ] given @xmath250_u \\in { \\mathtt{shlin}^2}$ ] and the binding @xmath92 with @xmath356 , we have @xmath532_u , x / t )   = [ ( s\\setminus s ' ) \\cup        { { \\mathop{\\downarrow}}}\\bigcup_{x \\subseteq s ' } { \\mathit{res}}(x , x , t)]_u \\enspace , \\ ] ] where @xmath561 and @xmath604 is defined as follows :    1 .   if @xmath118 is non - linear for @xmath4 and @xmath43 , then @xmath605 ; 2 .",
    "if @xmath118 is non - linear for @xmath4 and linear for @xmath43 , @xmath606 and @xmath607 , then we have @xmath608 ; 3 .",
    "if @xmath118 is linear for @xmath4 and strongly non - linear for @xmath43 , @xmath609 and @xmath610 , then we have @xmath611 ; 4 .",
    "if @xmath118 is linear for @xmath4 and not strongly non - linear for @xmath43 , @xmath610 , then we have @xmath612 5 .",
    "otherwise @xmath613 .",
    "[ ex : mguandy1 ] let @xmath429 and consider the set of @xmath495-sharing groups @xmath614 and consider the binding @xmath615 . note that @xmath616 .",
    "let us compute @xmath617 for some @xmath118 s , subsets of @xmath618 .",
    "* @xmath619 . in this case ,",
    "@xmath620 and @xmath621 , hence @xmath118 is non - linear for @xmath4 and @xmath622 . from the first case of theorem [ th : mguandy ] , we have that @xmath623 ; * @xmath624 .",
    "then @xmath118 is linear for @xmath4 and strongly non - linear for @xmath622 , since @xmath625 and @xmath626 . from the third case",
    ", it follows that @xmath627 ; * @xmath628 . then @xmath118 is linear for @xmath4 and not strongly non - linear for @xmath622 ( note that @xmath629 and @xmath630 , hence @xmath118 is non - linear for @xmath622 but it is not strongly non - linear ) . since @xmath631 , we only need to consider those @xmath632 such that @xmath633 . there is only one such set , which is @xmath634 .",
    "therefore @xmath635 .",
    "note that , given @xmath636 , if @xmath4 does not appear in any sharing group of @xmath244 , then @xmath637 .",
    "in fact , we can only apply the fourth or fifth case . in the fourth case",
    ", we have that @xmath638 , and thus the only @xmath639 is the empty multiset .",
    "thus , @xmath640 , which implies that @xmath641 , and @xmath642 . in the fifth case , the result is trivially the emptyset .",
    "symmetrically , when none of the variables of @xmath43 appears in @xmath244 , again we can apply only the fourth or fifth case , and @xmath637 .",
    "consider @xmath244 and @xmath56 as in example [ ex : mguandy1 ] .",
    "we compute @xmath574_u , x / r(y , y))$ ] .",
    "we show the value of @xmath617 for every @xmath643 which contains both the variables @xmath4 and",
    "@xmath5 : @xmath644 hence @xmath645_u , x / r(y , y))=\\\\ \\qquad { { \\mathop{\\downarrow}}}\\ { \\emptyset , x^\\infty y^\\infty ,   x^\\infty y^\\infty v^\\infty , x^\\infty y^\\infty u^\\infty ,   x^\\infty y^\\infty u^\\infty v^\\infty ,   x^\\infty y u^\\infty v , x^\\infty y^\\infty u^\\infty v\\ }   \\mathproofbox \\hspace{0.5cm}\\end{gathered}\\ ] ]    the main difference between the algorithm in theorem [ th : mguandy ] and the characterization in theorem [ th : pre - mguandy ] is that in the former @xmath118 is a subset of @xmath618 while , in theorem  [ th : pre - mguandy ] , @xmath421 is a multiset over @xmath618 . since the number of subsets of @xmath618 is finite , the characterization in theorem [ th : mguandy ] is an algorithm .",
    "obviously , a direct implementation of @xmath533 would be very slow , so that appropriate data structures and procedures should be developed for a real implementation .",
    "although this is mostly out of the scope of this paper , we show here that the definition of @xmath574_u , x / t)$ ] may be modified to consider only _ maximal _ subsets of @xmath581 .",
    "this should help in reducing the computational complexity of the abstract operator .",
    "given @xmath646_u \\in { \\mathtt{shlin}^2}$ ] , let @xmath647 be the set of maximal elements of @xmath28 , i.e. , @xmath648 .",
    "given a sharing group @xmath40 , we define the _ linearized _ version of @xmath40 , denoted by @xmath649 , as @xmath650 the linearization operator @xmath651 is extended pointwise to sets of sharing groups .",
    "we show that instead of choosing @xmath118 as a subset of @xmath618 in the definition of @xmath533 , we may only consider those @xmath118 s which are subsets of @xmath652 .",
    "[ th : closedmgu ] given @xmath250_u \\in { \\mathtt{shlin}^2}$ ] and the binding @xmath92 with @xmath356 , we have @xmath532_u , x / t )   = [ ( s\\setminus s ' ) \\cup       { { \\mathop{\\downarrow}}}\\bigcup_{x \\subseteq \\max s ' } ( { \\mathit{res}}(x , x , t ) \\cup       { \\mathit{res}}'(x , x , t))]_u \\enspace , \\ ] ] where @xmath561 and @xmath653    the next examples compare our optimal abstract unification operator to the original one and show the increase in precision .",
    "[ ex : king1 ] let @xmath654 .",
    "consider the set of @xmath495-sharing groups @xmath655 .",
    "we compute @xmath574_u , x / r(y , y))$ ] .",
    "since @xmath656 , we need to consider any @xmath657 . if @xmath658 then clearly @xmath659 .",
    "if @xmath660 , since @xmath661 , it follows that @xmath118 is linear for @xmath4 and not strongly non - linear for @xmath622 .",
    "thus @xmath532_u , x / r(y , y))=[{{\\mathop{\\downarrow}}}\\{\\emptyset , x^\\infty u^\\infty y , x^\\infty uvy , x^2uwy , x^\\infty v^\\infty y , x^\\infty vwy , x^\\infty w^\\infty y\\}]_u\\ ] ] on the other hand , computing with the unification algorithm given in @xcite , the result is @xmath662 the old algorithm is not able to infer the linearity which arises when combining two distinct sharing groups from @xmath663 with @xmath664 .",
    "moreover , it does not assert that the variables @xmath665 can not share a common variable .",
    "[ ex : king2 ] let @xmath666 and @xmath667 . by computing @xmath574_u , x / r(y))$ ]",
    "we obtain @xmath668 , which shows that @xmath6 and @xmath7 are linear after the unification .",
    "this is not the case when computing with the unification algorithm in @xcite , since we obtain @xmath669 .",
    "note that , we also improve the groundness information .",
    "in fact , in our result , groundness of @xmath6 implies groundness of @xmath7 .",
    "both examples show the increased precision w.r.t .",
    "king s algorithm . in the first example",
    ", we obtain optimality thanks to the introduction of the notion of strong non - linearity . in the second example",
    ", we improve the result since we do not need to consider independence between @xmath4 and @xmath43 , in order to exploit linearity information .",
    "the unification operator on @xmath2 has been defined for single binding substitutions .",
    "it is possible to extend this operator to multi - binding substitutions in the obvious way , namely by iterating the single binding operators . @xmath532_u,\\",
    "{ x / t \\ } \\uplus \\theta)=    { \\mathrm{mgu}}_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{2}}([s]_u , x / t),\\theta ) \\enspace .\\ ] ] however , defined in such a way , @xmath533 is not optimal .",
    "consider , for example , @xmath670 , @xmath671 , and the substitution @xmath672 .",
    "we have that @xmath574_u , x / r(y , y))=[\\downarrow \\ { \\emptyset , x^\\infty z^\\infty yw \\}]_u$ ] .",
    "since @xmath673 , by applying the third case of @xmath533 to @xmath674 we get @xmath675_u , z / w)=[\\downarrow \\{\\emptyset , x^\\infty y^\\infty z^\\infty w^\\infty\\}]_u \\enspace .\\ ] ] however , @xmath676_u,\\theta)))\\\\      = \\ & \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}([\\ { xz , yw \\}]_u,\\theta))\\\\",
    "= \\ & \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}([\\ { wx^2yz^2 \\}]_u,\\{z / w\\}))\\\\      = \\ & \\alpha_{\\mathrm{2}}([{{\\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}\\multir}]_u)=[\\emptyset]_u \\enspace ,    \\end{split}\\ ] ] which shows that @xmath533 is not optimal .",
    "note that , we do not use optimality of @xmath402 to prove this result , since correctness is enough .",
    "the problem is that , to be able to conclude that the unification of @xmath244 with @xmath24 is ground , we need to keep track of the fact that , after the first binding , @xmath14 is linear and @xmath7 is definitively non - linear .",
    "since @xmath2 is downward closed , we are not able to state this property .",
    "note that , in the case we have presented here , by changing the order of the bindings we get an optimal result in @xmath2 , but this happens just by accident .",
    "now , consider the substitution @xmath677 with @xmath678 and @xmath679 .",
    "assume that @xmath680 is an n - ary term , @xmath681 is an m - ary term with @xmath682 and @xmath683 .",
    "we have that : @xmath684_u , x / r(y, .... ,y ) ) = [ { { \\mathop{\\downarrow}}}\\{\\emptyset ,          x^\\infty u^\\infty y , zv \\}]_u \\enspace , \\\\      & { \\mathrm{mgu}}_{\\mathrm{2}}([{{\\mathop{\\downarrow}}}\\{\\emptyset , x^\\infty u^\\infty y , zv \\}]_u , z / s(y, ... ,y ) ) =      [ { { \\mathop{\\downarrow}}}\\{\\emptyset , x^\\infty u^\\infty z^\\infty v^\\infty y \\}]_u \\enspace , \\\\      & { \\mathrm{mgu}}_{\\mathrm{2}}([{{\\mathop{\\downarrow}}}\\ { \\emptyset , x^\\infty u^\\infty z^\\infty v^\\infty y \\}]_u , u / v)=             [ { { \\mathop{\\downarrow}}}\\ { \\emptyset , x^\\infty u^\\infty z^\\infty v^\\infty y \\}]_u \\enspace .    \\end{split}\\ ] ] on the other hand , we have that : @xmath685_u,\\theta)))\\\\      = \\ & \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}([\\ { xu , zv , y \\}]_u,\\theta))\\\\      = \\ & \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}([\\ { x^n u^n y , zv \\}]_u,\\ { z / s(y, ... ,y ) , u / v    \\}))\\\\      = \\ & \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_{\\mathrm{\\omega}}([\\ { x^n u^n y z^m v^m \\}]_u,\\ { u / v \\}))\\\\      = \\ & \\alpha_{\\mathrm{2}}([{{\\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}\\multir}]_u)=[\\emptyset]_u \\enspace .",
    "\\end{split}\\ ] ] however , if @xmath686 , we have : @xmath687_u,\\theta)))\\\\ = \\ & \\alpha_{\\mathrm{2}}([\\ { { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}\\multir}\\ } \\cup \\{x^{kn } u^{kn } y^k z^{kn } v^{kn } \\mid k \\in { \\mathbb{n}}\\}]_u)\\\\ = \\ & [ { { \\mathop{\\downarrow}}}\\{\\emptyset , x^\\infty u^\\infty z^\\infty v^\\infty y \\}]_u \\enspace . \\end{split}\\ ] ] in this case , keeping track of the variables which are definitively non - linear does not help .",
    "it seems that , in order to compute abstract unification one binding at a time , we need to work in a domain which is able to keep track of the exact multiplicity of variables in a sharing group .",
    "actually , this is how @xmath0 works .",
    "obviously , we could try to develop a different algorithm for unification in @xmath2 which directly works with multi - binding substitutions .",
    "however , since the algorithm for single binding substitutions is already quite complex , we think this is not worth the effort .      the reduced product @xmath688 has been used for a long time in the analysis of aliasing properties , since it was recognized that the precision of these analyses could be greatly improved by keeping track of the linear variables . among the papers which consider the domain @xmath689",
    ", we refer to @xcite and @xcite .",
    "actually , these papers also deal with freeness properties , which we do not consider here , to further improve precision .",
    "although the domain @xmath689 has been used for many years , the optimal unification operator is as yet unknown , even for a single binding substitution .",
    "we provide here a new abstract operator for @xmath689 , designed from the abstract unification for @xmath2 , and we prove that it is optimal for single binding substitutions .",
    "the domain @xmath689 keeps track of linearity by recording , for each object of @xmath12 , the set of linear variables .",
    "each element is now a triple : the first component is an object of @xmath12 , the second component is an object of @xmath690 , that is , the set of variables which are linear in all the sharing groups of the first component , and the third component is the set of variables of interest . it is immediate that @xmath689 is an abstraction of @xmath2 ( and thus of @xmath0 ) . in the following , we briefly recall the definition of the abstract domain and provide the abstraction function from @xmath2 . @xmath691\\mid",
    "s \\subseteq\\wp(u ) , ( s \\neq\\emptyset { \\rightarrow}\\emptyset \\in s ) , l \\supseteq u \\setminus { \\mathit{vars}}(s ) , u \\in { \\wp_f}({\\mathcal{v } } )    \\ } \\enspace , \\ ] ] with the approximation relation @xmath692 defined as @xmath693 \\leq_{\\mathit{sl}}[s',l',u']$ ] iff @xmath694 , @xmath695 , @xmath696 .",
    "there is a galois insertion of @xmath689 into @xmath2 given by the pair of maps : @xmath697_u)&=[\\ { { \\llfloor o \\rrfloor } \\mid o \\in s \\},\\ { x \\in u    \\mid \\forall o \\in s.\\ o(x ) \\leq 1\\},u ] \\enspace , \\\\",
    "\\gamma_{\\mathit{sl}}([s , l , u])&=[\\ { b_l \\mid b \\in s \\}]_u \\enspace , \\\\",
    "\\intertext{where $ b_l$ is the 2-sharing group which has the same support of $ b$ , with linear variables dictated by the set $ l$. in formula : }    b_l&=\\lambda v \\in { \\mathcal{v}}. \\begin{cases }                                 \\infty & \\text{if $ b \\in u \\setminus l$,}\\\\                  1 & \\text{if $ b \\in l$,}\\\\                                  0 & \\text{otherwise . }                         \\end{cases}\\end{aligned}\\ ] ]    the functional composition of @xmath493 , @xmath516 and @xmath698 gives the standard abstraction map from substitutions to @xmath689 .",
    "we still use the polynomial notation to represent sharing groups , but now all the exponents are fixed to one . note that the last component @xmath56 in @xmath693 $ ] is redundant since it can be retrieved as @xmath699 .",
    "this is because the set @xmath700 contains all the ground variables .",
    "in order to obtain a correct and optimal abstract unification over @xmath689 , the trivial way is to directly compute @xmath701),x / t ) ) $ ] .",
    "however , we prefer to give an unification operator similar to the other operators for @xmath689 in the literature @xcite . as for the domain @xmath2",
    ", we now provide the notions of multiplicity and linearity over @xmath689 .",
    "given a set @xmath700 of linear variables , we define the maximum multiplicity of a sharing group @xmath40 in a term @xmath43 as follows : @xmath702 according to the similar definition for 2-sharing groups , given @xmath693 \\in { \\mathtt{shlin}}$ ] , we say that @xmath703 is _ linear _ for a term @xmath43 when for all @xmath704 it holds that @xmath705 .",
    "note that , when @xmath43 is a variable , the definition boils down to check whether @xmath706 .",
    "given @xmath707 , we fix the set @xmath700 of linear variables and partition @xmath118 in three subsets @xmath708 , @xmath709 and @xmath710 .",
    "moreover , we need to define the following subsets of @xmath118 : @xmath711 since we do not deal with definite linearity , we need to take into account the sharing groups which can be obtained by linearizing variables .",
    "this may be accomplished by using the set @xmath56 instead of @xmath700 when computing the multiplicity .",
    "we denote by @xmath712 the set @xmath713 which corresponds to the _ linearizable _ sharing groups .",
    "moreover , given sets @xmath714 with @xmath715 we denote by @xmath716 the set @xmath717 , by @xmath718 the set @xmath719 and by @xmath720 the set @xmath721 .",
    "this notation slightly deviates from most of other literature on @xmath12 , where @xmath718 does not include the empty set .",
    "we prefer to adopt a double notation , namely , @xmath718 and @xmath720 , which is more standard in the rest of the research community .",
    "[ def : mgushl ] given @xmath693 \\in { \\mathtt{shlin}}$ ] and the binding @xmath92 such that @xmath356 , we define @xmath722,x / t ) = [ ( s\\setminus x ) \\cup k , u ' \\cup l ' , u ] \\enspace , \\ ] ] where @xmath723 and @xmath724 . here , @xmath725 is the set of new sharing groups created by the unification process and @xmath314 is the set of variables which do not appear in any sharing group of the result , i.e. the set of ground variables .",
    "@xmath725 is defined as follows : @xmath726 finally , the set @xmath727 of linear variables which are not ground is @xmath728    [ th :",
    "optimal - shl ] the operator @xmath729 in definition  [ def : mgushl ] is correct and optimal w.r.t .",
    "@xmath206 , when @xmath730",
    ".    [ rational ] let @xmath731 and consider the binding @xmath732 .",
    "it is easy to check that @xmath703 is linear for @xmath4 but not for @xmath43 . applying our operator ,",
    "we obtain @xmath733,x / f(y , z))=[s',l',u]$ ] with @xmath734 and @xmath735 .",
    "this is more precise that the operators for @xmath1 in @xcite . actually , even using the optimizations",
    "proposed in @xcite , one obtains as result the object @xmath736 \\enspace .\\ ] ] the optimization proposed in @xcite is not applicable as it is , since it requires @xmath737 and @xmath738 to be disjoint . even assuming that this test for independence may be removed as unnecessary",
    ", the final result would be the same as above . in both cases ,",
    "our operator is able to prove that @xmath739 and @xmath740 are not possible sharing groups .",
    "note that , in a domain for rational trees , the sharing group @xmath739 is needed for correctness , since the unification of @xmath741 with the binding @xmath732 succeeds with @xmath742 .",
    "this means that we are able to exploit the occur - check of the unification in finite trees . as a consequence ,",
    "our abstract unification operator is not correct w.r.t .  a concrete domain of rational substitutions @xcite .",
    "an alternative would be to compute the abstract unification following theorem [ th : mguandy ] with @xmath543 and @xmath124 replaced by @xmath743 and @xmath744 respectively ( we can obviously ignore the delinearization operator @xmath745 since @xmath746 ) .",
    "however , we do not pursue further this approach .",
    "in the case @xmath394 , we may proceed as for @xmath0 and @xmath2 : enlarge the set of variables of interest in order to include all @xmath578 and compute unification with @xmath729 .",
    "[ def : mgushl2 ] given @xmath693 \\in { \\mathtt{shlin}}$ ] and the binding @xmath92 , let @xmath579 be @xmath580 .",
    "we define : @xmath722,x / t)= { \\mathrm{mgu}}_{\\mathit{sl}}([s \\cup \\ { v_1 , \\ldots , v_n \\},l   \\cup v , u \\cup v],x / t ) \\enspace .\\ ] ]    [ th : optimal - shl2 ] the operator @xmath729 in definition [ def : mgushl2 ] is the optimal abstraction of @xmath206 .",
    "although the abstract operator @xmath729 is optimal for the unification with a single binding , the optimal operator for a multi - binding substitution can not be obtained by considering one binding at a time .",
    "this is a consequence of the fact that the corresponding operator for single binding unification on @xmath2 can not be extended to an optimal multi - binding operator by simply considering one binding at a time .",
    "in fact , all the counterexamples in section [ sec : multibind ] are also counterexamples for @xmath729 , since it is the case that @xmath250_u = \\gamma_{\\mathit{sl}}(\\alpha_{\\mathit{sl}}([s]_u))$ ] .",
    "in this section , we give some evidence that there are practical advantages in using the optimal unification operators for @xmath689 .",
    "it is far beyond the scope of this paper to provide an experimental evaluation of the new algorithms , but the results in @xcite give some hints on its possible outcome .",
    "introduce an improvement for @xmath747 exploiting some ideas from king s unification operator for the domain @xmath2 . in this way",
    ", they improve precision in a few cases and show that efficiency of the analysis is more likely to be increased than decreased .",
    "in fact , even if the final result of the analysis does not change , a more precise operator may reduce the number of sharing groups in the intermediate steps , which helps performance .",
    "hence , we expect the optimal unification for @xmath689 to further improve the analysis , both in efficiency and precision .",
    "this is more evident if we consider that measure precision in terms of the number of independent pairs ( as well as definitively ground , free and linear variables ) and do not consider set - sharing .",
    "however , show that set - sharing information may be useful in several application of the analysis , such as parallelization of logic programs .",
    "hence , a greater improvement in precision is to be expected if we consider the full set - sharing property .",
    "we now provide a concrete example of a simple program where our abstract operators give better results than the operators known in the literature .",
    "we work with _ difference lists _ , an alternative data structure to lists for representing a sequence of elements . a difference list is a term of the kind @xmath748 where @xmath28 and @xmath34 are lists , which represents the list obtained by removing @xmath34 from the tail of @xmath28 .",
    "for example , using ` prolog `   notation for lists , @xmath749 \\setminus   [ 3,4]$ ] represents the list @xmath750 $ ] , while @xmath751 \\setminus x$ ] and @xmath752 \\setminus [ ] $ ] represent the list @xmath752 $ ] .",
    "the difference lists whose tail is a variable ( such as @xmath751 \\setminus x$ ] ) are mostly useful , since they can be concatenated in constant time . an overview of difference lists may be found in @xcite .",
    "we define the predicate @xmath753 , which translates lists to difference lists and vice - versa . the goal @xmath754 succeeds when the difference list @xmath755 represents the standard list @xmath651 . for example , @xmath756,x , x)$ ] and @xmath757,[1,2,3 | x],x)$ ] succeed without any further instantiation of variables . in order to improve the precision of the analysis",
    ", we keep head and tail of difference lists in separate predicate arguments .",
    "the code for @xmath753 , in head normal form , is the following .",
    "@xmath758 , h = t.\\\\ { \\mathit{difflist}}(l , h , t ) & \\leftarrow l=[x|l ' ] , h=[x|h ' ] , { \\mathit{difflist}}(l',h',t ) .",
    "\\end{split}\\ ] ] where @xmath759 ( list ) , @xmath760 ( head ) , @xmath43 ( tail ) and @xmath4 are variables .",
    "we informally compute the goal - independent analysis of @xmath761 on the domain @xmath689 , which gives : @xmath762 \\enspace , \\\\ { \\llbracket}{\\mathit{difflist}}{\\rrbracket}^1 = & [ \\{\\emptyset , ht , hl\\},\\{l , h , t\\},\\{l , h , t\\ } ] \\enspace , \\\\ { \\llbracket}{\\mathit{difflist}}{\\rrbracket}^2 = & { \\llbracket}{\\mathit{difflist}}{\\rrbracket}^1   \\enspace . \\end{split}\\",
    "] ] the result of the analysis is not affected by our improved unification operator : the standard mgu for @xmath689 , as given in @xcite , yields exactly the same result .",
    "now , suppose we want to analyze the goal @xmath763 .",
    "this corresponds to the goal @xmath764 in head normal form .",
    "its semantics may be computed , using our operators , as @xmath765,h / t)=[\\{\\emptyset , ht\\},\\{l\\},\\{l , h , t\\ } ] \\enspace .\\ ] ] by projecting over @xmath651 and @xmath766 , we get @xmath767 $ ] . hence , the analysis is able to infer that , upon exiting the goal @xmath763 , the variable @xmath651 is ground .    by using the standard mgu for @xmath689 in @xcite , we get @xmath768 \\enspace , \\ ] ] hence @xmath651 is detected to be linear but not ground .",
    "the optimizations introduced in @xcite do not improve this result .",
    "this is a consequence of the fact that these optimizations have been developed to be correct also for rational trees . in this case",
    ", you can not infer that @xmath651 is ground after @xmath763 since the substitution in rational solved form @xmath769 , h/[v | h]\\}$ ] is a correct answer for the same goal .",
    "if we perform the analysis in @xmath2 , using our operators we have @xmath770_{lht}$ ] and the result for the goal @xmath763 is @xmath771_{lh}$ ]",
    ". however , by using the original operator in @xcite , the semantics of @xmath761 does not change , but the result for the goal @xmath763 is @xmath772_{lh}$ ] thus @xmath651 is not proven to be either ground or linear .    the fact that optimal operators improve groundness information is somehow surprising .",
    "generally , one expects that groundness affects aliasing analysis , but not vice - versa .",
    "in fact , it is well known that @xmath12 is a refinement @xcite of the domain @xmath23 . however , as far as groundness is concerned , the precision of @xmath12 and @xmath23 is the same , i.e. , the other objects included in @xmath12 do not improve groundness analysis @xcite . as far as we know",
    ", there is no abstract unification operator in the literature , for a domain dealing with sharing , freeness and linearity , which is more precise that @xmath23 for groundness . on the contrary",
    ", the example above shows that @xmath689 , endowed with the optimal unification , improves over @xmath23 .",
    "amazingly , in this example @xmath689 is even better than @xmath22 @xcite . in the latter ,",
    "the abstract semantics of @xmath761 is @xmath773 , i.e. , @xmath766 is ground iff both @xmath651 and @xmath43 are ground .",
    "the result of the analysis for the goal @xmath763 is @xmath774 .",
    "this is equivalent to @xmath775 which does not imply groundness of @xmath651 .",
    "actually , @xmath775 is the groundness information which may be inferred by .      as far as we know",
    ", there is no implementation or experimental evaluation of the domain @xmath2 .",
    "we think it would be worthwhile to give such an implementation and that there is some evidence that @xmath2 improves over @xmath689 also in practice . for instance , we show a simple program where king s domain is more precise than @xmath689 with optimal operators .",
    "we provide a variant of the predicate @xmath753 , which we call @xmath776 , with only two arguments : head and tail of the difference list are encoded in the second argument as the term @xmath777 .",
    "@xmath778 , d = h \\setminus h.\\\\ { \\mathit{difflist}}'(l , d ) & \\leftarrow l=[x|l ' ] , d=[x|h ] \\setminus t , d'=h \\setminus t , { \\mathit{difflist}}'(l',d ' ) .",
    "\\end{split}\\ ] ] we informally compute the goal - independent analysis of @xmath779 on the domain @xmath689 , which gives : @xmath780 \\enspace , \\\\ { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^1 = & [ \\{\\emptyset , dl , d\\},\\{l\\},\\{d , l\\ } ] \\enspace , \\\\ { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^2 = & { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^1 \\enspace . \\end{split}\\ ] ] the same analysis , computed over @xmath2 , gives @xmath781_{dl } \\enspace , \\\\ { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^1 = & [ \\{\\emptyset , dl , d , d^\\infty\\}]_{dl } \\enspace , \\\\ { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^2 = & { \\llbracket}{\\mathit{difflist } } ' { \\rrbracket}^1 \\enspace . \\end{split}\\ ] ]    now , suppose we want to analyze the goal @xmath782\\setminus t$ ] , which extracts the first two elements from the difference list @xmath783 . in @xmath689",
    "we have the following @xmath784,d/[x_1,x_2|h]\\setminus t)=\\\\    [ \\{\\emptyset\\ } \\cup { \\mathrm{bin}}(\\{dl , d\\},\\{x_1,x_2,h , t\\}^ * ) , \\{l\\},\\{d , l , x_1,x_2,h , t\\ } ] \\enspace .\\end{gathered}\\ ] ] note that the sharing group @xmath785 is part of the result .",
    "if we repeat the analysis in @xmath2 , we have @xmath786_{dl},d/[x_1,x_2|h]\\setminus t)=    \\big[\\{\\emptyset , dlx_1 , dlx_2 , dlh , dlt\\ } ~ \\cup \\\\    { { \\mathop{\\downarrow}}}\\bigl\\ { { \\biguplus}x \\mid x \\in \\wp(\\{d^\\infty x_1^\\infty , d^\\infty x_2^\\infty , d^\\infty h^\\infty , d^\\infty t^\\infty\\ } ) \\bigr\\}\\big]_{dlx_1x_2ht } \\enspace .\\end{gathered}\\ ] ] this result does not contain the sharing group @xmath785 .    generally speaking ,",
    "it is easier to analyze the predicate @xmath753 than @xmath776 .",
    "propose a method named _ untupling _ which is able to automatically recover @xmath753 from @xmath776 .",
    "in this paper , we work with a concrete domain of substitutions on finite trees . in the literature , some authors deal with rational trees .",
    "since any correct operator for rational trees is also correct for finite trees , we can compare the unification operators for rational trees with ours ( of course , this is not entirely fair as far as the precision is concerned ) .",
    "the opposite is not true , since an abstract unification operator for finite trees may be able to exploit the occur - check condition .",
    "we have shown in example [ rational ] that our optimal operator can exploit the occur - check condition , and thus it is not correct for rational trees .",
    "it is well - known that the abstract unification operator of the domain @xmath12 alone ( i.e. , without any freeness or linearity information ) is optimal .",
    "give a formal proof of optimality , considering a slightly different unification operator with two abstract objects and a concrete substitution .",
    "since the two abstract objects are renamed apart , it is equivalent to consider a single abstract object .",
    "the basic idea underlying the proof is to exhibit , for each sharing group in the result of the unification , a pair of concrete substitutions generating the resulting sharing group .",
    "we follow the same constructive schema in the proof of optimality for @xmath0 ( but we look for a single substitution , due to the different concrete operator ) . instead , to prove optimality for @xmath689 and @xmath2 , we use a direct approach and show that the abstract unification operator corresponds to the best correct abstraction ( i.e. , @xmath787 ) of the unification on @xmath0 with simple ( although tedious ) algebraic manipulations .    a different unification operator has been proposed in @xcite for goal - dependent analysis of @xmath12 . in this paper , the standard unification operator is splitted into two different operators for forward and backward unification .",
    "both operators are proved to be optimal and the overall analysis is strictly more precise than the analysis performed on @xmath12 equipped with the standard operator .    as far as we know , these are the only optimality results for domains encoding aliasing properties .      in most of the work combining sharing and linearity , freeness information is included in the abstract domain . in fact",
    ", freeness may improve the precision of the aliasing component and it is also interesting by itself , for example in the parallelization of logic programs @xcite . in this comparison",
    ", we do not consider the freeness component .    the first work which combines set - sharing with linearity is @xcite , followed by @xcite .",
    "the initial unification algorithm has been improved by and by removing an independence test .",
    "this increases the number of cases when linearity information may be exploited .",
    "propose a different improvement , adopting an idea by for the domain @xmath2 , which simplifies the unification of a linear term with a non - linear one .",
    "example [ rational ] shows that , even adopting all these improvements , we still obtain a strictly more precise operator .",
    "since our operator is optimal , any further improvement is now impossible .",
    "show that , if we are only interested in pair - sharing information , @xmath12 is redundant .",
    "they propose a new domain @xmath788 which is obtained by discharging redundant sharing groups .",
    "a sharing group @xmath34 in a set @xmath244 is redundant if @xmath789 and @xmath790 .",
    "analyses performed with @xmath788 are shown to be as precise as those performed with @xmath12 , if only pair - sharing information is required .",
    "introduce the domain @xmath791 .",
    "example [ rational ] shows that our operator is still more precise ( of course , without considering the freeness component ) , because of the sharing group @xmath739 which does not appear in @xmath618 and is not redundant for @xmath788 . in any case , have shown that classical applications of sharing analyses , such as parallelization of logic programs , are able to exploit information which is encoded in @xmath792 but not in @xmath793 .",
    "an alternative presentation of @xmath1 , based on _ set logic programs _",
    ", has been introduced by . however , the proposed operators are not optimal , as shown in .",
    "the domain @xmath2 is introduced by , which provides correct operators for abstract unification",
    ". however , these operators are not optimal , as examples [ ex : king1 ] and [ ex : king2 ] show .",
    "an alternative approach to aliasing analysis is to only record sharing between pairs of variables ( and possibly linearity and groundness information ) .",
    "the best known domain of this category is @xmath225 , introduced by and formalized by .",
    "the domain @xmath225 is the reduced product of pair - sharing , @xmath690 and @xmath794 @xcite , which is the simplest domain for definite groundness .",
    "recently , reformulated the proofs in order to work with rational trees .",
    "moreover , king s algorithms are parametric w.r.t .  the groundness domain , allowing to replace @xmath794 with more precise domains such as @xmath23 and @xmath22 .",
    "the domain @xmath1 is strictly more precise than @xmath225 , since it embeds more groundness information ( equivalent to @xmath23 ) and set - sharing information .",
    "since our operator for @xmath1 is optimal , we are sure that the analyses performed in @xmath1 are strictly more precise than those in @xmath225 .",
    "the following is a counterexample to the optimality of the abstract unification in @xcite , in the case of finite trees , when pair sharing is equipped with @xmath23 or @xmath22 .",
    "[ ex : asub ] consider the object @xmath795 where the first component is a formula of @xmath23 and @xmath22 and @xmath796 is the set of pairs of variables which may possibly share . in this domain ,",
    "linearity information is embedded in the second component in the following way : if @xmath8 is not linear , then @xmath797 must be included in the second component .",
    "thus , both @xmath4 , @xmath5 and @xmath7 are linear in @xmath798 .",
    "we want to unify @xmath799 with @xmath732 . by using the algorithm @xcite",
    ", we obtain @xmath800",
    ". however , in @xmath1 we may represent @xmath799 with @xmath693=[\\{xy , z\\},\\{x , y , z\\},\\{x , y , z\\}]$ ] and @xmath733,x / f(y , z))=[\\{xy\\},\\{z\\},\\{x , y , z\\}]$ ] which proves that @xmath7 is ground .    actually ,",
    "does not state explicitly how to compute the groundness component of the result , although he says that it must be computed before the linearity and pair - sharing components , in order to improve precision .",
    "however , it seems safe to assume that the author s intention was to compute the groundness component using the abstract operators already known , and therefore independently from the pair sharing component .",
    "this is what makes our operator more precise , since linearity information may help in tracking ground variables when working over finite trees .",
    "the domain @xmath225 and its derivatives @xcite use the concept of _ alternating path_. alternating paths may seem the counterparts , for pair - sharing , of sharing graphs .",
    "we now investigate this idea , and show to what extent this correspondence is faithful .",
    "we call _ carrier graph _ a special graph defined by a set of equations @xmath86 .",
    "each distinct occurrence of a variable in @xmath86 is a node .",
    "edges in the carrier graphs can be of two types :    * edges of _ type one _ between two variable occurrences if the occurrences are on opposite sides of a single equation in @xmath86 , * edges of _ type two _ linking two ( distinct ) occurrences of the same variable .",
    "an alternating path is a sequence of edges of alternating type over the carrier graph .",
    "alternating paths in @xmath225 ( and derivatives ) are used to prove correctness of the abstract unification operators .",
    "for example , they are used to prove prop . 3.1 in @xcite .",
    "sharing graphs are used in this paper to prove theorem [ th : algebraic ] , which is the starting point to prove correctness and optimality of the unification algorithms for @xmath2 and @xmath689 .",
    "however , sharing graphs are also used to compute the abstract unification in @xmath0 . even if alternating paths are not used , in the literature , for computing abstract unification , they could .",
    "for any object of pair - sharing @xmath40 , which is a set of pairs of variables , consider any substitution @xmath24 in the concretization of @xmath40 .",
    "then , the object @xmath40 is an abstraction of the set of alternating paths in @xmath24 .",
    "more precisely , it represents all the paths which start and end with edges of type one , which we call _ admissible paths_. they are abstracted by considering only the start and end variables . in order to unify @xmath40 with the binding @xmath92",
    ", we build a carrier graph with all the occurrences of variables in @xmath40 and @xmath92 . for each pair of variables in @xmath40 , we add an edge of type one .",
    "we add edges of type one and two for the binding @xmath92 , as explained above . finally , we add all the type two edges between any occurrence in @xmath92 and any occurrence of the same variable in @xmath40 .",
    "we consider all the admissible paths over the graph so obtained .",
    "it is not difficult to check that the result of the unification algorithm for pair - sharing in @xcite , without any additional groundness domain , is the set of all the start and end variables for all these admissible paths .",
    "[ ex : carriergraph ] let @xmath801 be the set of pairs of variables which share , and consider the binding @xmath615 .",
    "we obtain the carrier graph : @xmath802^{2 } \\\\        v \\ar@{-}[r]^{1 } & x \\ar@{=}[r]^{2 } & x \\ar@{-}[ru]^{1 } \\ar@{-}[rd]^{1 } \\\\        & & & y    } \\ ] ] which gives origin to several alternating paths . among them",
    ", there is an admissible path from @xmath8 to @xmath8 , which proves that @xmath8 is not linear after the unification .",
    "the first difference between alternating paths and sharing graphs is that all the alternating paths are subgraphs of the same carrier graph , while each sharing graph has a different structure , with a different set of nodes .",
    "the second difference is that the information coming from the abstract object and the binding is encoded in a different way .",
    "for instance , consider the set @xmath803 and the binding @xmath804 .",
    "we obtain a carrier graph with 4 nodes @xmath805 , two edges @xmath806^{1 } & y}}$ ] and @xmath806^{1 } & z}}$ ] of type one , and an edge @xmath807^{2 } & x}}$ ] of type two .",
    "therefore , the sharing information coming from the initial pair - sharing and the binding is treated symmetrically , and is entirely encoded on the edges . performing unification on the carrier graph boils down to devising the alternating paths on the graph . on the contrary",
    ", each sharing graph has a set of nodes labelled by @xmath808 , @xmath4 and @xmath7 , with suitable multiplicities .",
    "the labels of the nodes encode the initial pair - sharing information , while the binding affects the multiplicity of nodes .",
    "the process of unification consists of adding the necessary arrows to get a sharing graph .    if we consider a single alternating path in a carrier graph and the sharing graph for the same pair - sharing information and the same binding , they are obviously related , although not in a straightforward manner .",
    "consider an admissible path and delete all type two edges , collapsing in a single node their start and end nodes ( type two edges are used in the carrier graph to avoid the creation of invalid paths , but in a single alternating path they do not add information ) .",
    "then , each type one edge coming from the initial pair - sharing information corresponds to a node in the sharing graph , while a type one edge coming from the binding becomes an arrow in the sharing graph .",
    "consider example [ ex : carriergraph ] .",
    "we depict the ( admissible ) alternating path from @xmath8 to @xmath8 , its collapsed version and the corresponding sharing graph .",
    "@xmath809^{1 }   &   x \\ar@{=}[r]^{2 }   &   x \\ar@{-}[r]^{1 } & y   \\ar@{=}[r]^{2 }   &   y \\ar@{-}[r]^{1 }   &   x \\ar@{=}[r]^{2 }   &   x \\ar@{-}[r]^{1 }   & v \\\\      v \\ar@{-}[rr]^{1 }   & &   x   \\ar@{-}[rr]^{1 } & & y    \\ar@{-}[rr]^{1 }   & &   x   \\ar@{-}[r]^{1 }   & v \\\\       & & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xv$\\end{center}}}}_1 ^ 0   \\ar[rr ] & & { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$y$\\end{center}}}}_0 ^ 2   & &   { \\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xv$\\end{center}}}}_1 ^ 0 \\ar[ll ] \\\\    } \\ ] ] note that , while in the carrier graph , non - linearity of the variable @xmath4 is handled by duplicating the variable @xmath5 which occurs twice , in alternating paths without type two nodes , the duplicated variables are @xmath4 and @xmath8 , which are connected to @xmath5 .",
    "the same holds in the sharing graph , where we have only one node labeled by @xmath5 and two nodes labelled by @xmath810 .    in sharing graphs",
    "we also require the multiplicities of a node to be equal to its in- and out - degrees .",
    "this makes possible to handle groundness at the same level of sharing and linearity , without requiring a separate domain .",
    "remember that a sharing group @xmath244 with multiplicity @xmath295 corresponds , in the concrete domain , to a variable @xmath6 such that @xmath811 .",
    "if the degree of the node labeled with this sharing group is not @xmath295 , this means that one of the occurrences of @xmath6 is bound to a ground term .",
    "this would make ground the entire connected component containing @xmath244 .",
    "hence , in order to correctly and precisely propagate groundness , we just forbid this kind of sharing graphs .",
    "on the contrary , the pair - sharing algorithm in @xcite , which focus on a single path in the carrier graph , is not able to extract groundness information without the help of an auxiliary domain .",
    "have recently proposed a different approach to pair - sharing analysis .",
    "the authors use multigraphs , called _ relation graphs _ , to represent sharing and linearity information .",
    "the nodes of the multigraph are variables , and two of them may share only if there is a _ traversable path _ from one variable to the other .",
    "intuitively , each binding generates edges of different types .",
    "the definition of traversable paths is very similar to that of alternating paths .",
    "a traversable path is a sequence of edges , such that contiguous edges are always of different types .",
    "this domain should be coupled with a groundness domain , and operators are parametric w.r.t .",
    "the latter one .",
    "the authors show that relation graphs , when coupled with the @xmath23 groundness domain , are more precise than @xmath12 and @xmath225 .",
    "however , this is not the case for @xmath1 , at least in the case of finite trees , since the operators in @xcite are not able to use linearity to improve the precision of the groundness component .",
    "[ ex : lagoon - no - better ] as shown in example [ ex : asub ] , if we unify @xmath693=[\\{xy , z\\},\\{x , y , z\\},\\{x , y , z\\}]$ ] with the binding @xmath732 , we obtain @xmath733,x / f(y , z))=[\\{xy\\},\\{z\\},\\{x , y , z\\}]$ ] , proving that @xmath7 is ground after the unification . in the domains @xmath812 and @xmath813 of @xcite , the abstract object corresponding to @xmath693 $ ] is @xmath814 & y } , x \\leftrightarrow y \\right ) \\enspace .\\ ] ] intuitively , the first element of @xmath815 encodes the sharing information , namely , that @xmath4 and @xmath5 may share ( while @xmath7 does not share neither with @xmath4 nor with @xmath5 ) .",
    "the second element of @xmath815 is an element of @xmath22 ( and also of @xmath23 ) and denotes the groundness information that @xmath4 is ground if and only if @xmath5 is ground .",
    "the unification of @xmath815 with @xmath732 in @xmath813 is realized by abstracting the substitution and composing the two abstract object .",
    "the abstraction of @xmath732 is @xmath816          \\ar@{-}[rd ] & \\\\ & z } } } , x \\leftrightarrow ( y \\wedge z )    \\right ) \\enspace , \\ ] ] the first element says that @xmath4 shares with both @xmath5 and @xmath7 , while @xmath5 and @xmath7 do not share . the second element says that @xmath4 is ground if and only if both @xmath5 and @xmath7 are ground .",
    "the abstract conjunction is @xmath817 \\ar@{.}@/_/[ru ]          \\ar@{-}[rd ] & \\\\ & z } } } , ( x \\leftrightarrow y ) \\wedge ( x \\rightarrow z )    \\right ) \\enspace , \\ ] ] where edges drawn in different styles are compatible , namely , that they come from different bindings . from this result , it is not possible to infer that @xmath7 is ground after the unification .    in the actual implementation ,",
    "use another representation for their domain .",
    "each pair of variables is annotated with a formula denoting the groundness models under which the corresponding pair - sharing may occur .",
    "for example , a pair @xmath818 annotated with the formula @xmath819 means that @xmath6 and @xmath8 may share only if none of @xmath820 is ground .",
    "we conjecture that this domain may be embedded in king s @xmath2 .",
    "the next example shows how to perform this embedding .",
    "[ ex : traversablepath ] we consider the example in figure @xmath821 in @xcite .",
    "the variables of interest are @xmath820 .",
    "@xmath822 for instance , @xmath823 means that @xmath6 and @xmath8 may share only if @xmath820 are not ground , while @xmath824 means that @xmath6 is ( possibly ) not linear only if @xmath825 are not ground .",
    "each of these formulas may be viewed as a condition over @xmath495-sharing groups .",
    "for example @xmath823 means that every @xmath495-sharing group which contains @xmath6 and @xmath8 should also contain @xmath14 and @xmath7 , while @xmath824 means that each @xmath495-sharing group where @xmath6 is non - linear should also contain @xmath14 and @xmath7 . in order to find the object of @xmath2 which corresponds to this example ,",
    "it is enough to collect all the @xmath495-sharing groups which satisfy all the conditions enforced by the formulas . in this case , we get @xmath826 .",
    "the idea behind traversable paths is very similar to the concept of alternating path and relation graphs are quite similar to carrier graphs . from a carrier graph , we can obtain a relation graph by removing type two edges and introducing a different type of edge for each binding .",
    "this works because the use of non - linear terms is forbidden : a binding like @xmath827 has to be replaced by two bindings @xmath828 and @xmath829 .",
    "however , the main difference w.r.t .",
    "traditional pair - sharing ( and also @xmath0 ) is that do not abstract traversable paths to set of pairs of variables , but they keep in the abstract object the set of all the edges generated during the unification process . in this way , they are able to record that , in order for two variables @xmath4 and @xmath5 to share , the only possible path touches another variable @xmath7 . hence , if @xmath7 is ground , @xmath4 and @xmath5 can not share : in this way they recover pair sharing dependence information which would be lost otherwise .",
    "we could follow the same approach and use multilayer sharing graphs ( namely , sets of sharing graphs over the same set of nodes , where each layer represents the unification with a single binding ) as abstract objects , without collapsing them to sharing groups .",
    "we do not think this would improve precision of the domain very much , since a sharing group is already a much more concrete abstraction of a graph w.r.t .",
    "the set of all the connected pairs of variables .",
    "in fact , already @xmath12 can encode the information that , grounding a certain variable @xmath7 , two variables @xmath4 and @xmath5 become independent .",
    "moreover , in the example [ ex : traversablepath ] we have shown that relation graphs may be encoded into @xmath2 .      in the recent years",
    ", many authors have studied the behavior of logic programs on _ rational trees _",
    "@xcite , which formalize the standard implementations of logic languages .",
    "we have shown that our operators , which are optimal for finite trees , are not correct for rational trees , since they exploit the occur - check to reduce the sharing groups generated by the abstract unification ( see example  [ rational ] ) .",
    "it would be interesting to adapt our framework to work with rational trees , in order to obtain optimal operators also in this case .",
    "since a rational tree may contain infinite occurrences of a variable , the notion of @xmath15-sharing group needs to be extended in order to allow infinite exponents . also , we need to consider infinite sharing graphs ( or , at least , a representation of them ) and find suitable regularity conditions for them , analogously to the regularity conditions on rational trees .",
    "consider the set of @xmath15-sharing groups @xmath830 and the binding @xmath831 . on rational trees , unifying",
    "@xmath832 ( such that @xmath250_{xyz }   \\rightslice [ \\delta]_{xyz}$ ] ) with @xmath831 would get the substitution @xmath833 in rational solved form .",
    "this , intuitively , corresponds to the sharing group @xmath834 where the exponent @xmath15 denotes an infinite number of occurrences . a possible",
    "( infinite ) sharing graph generating this sharing group is the following : @xmath835[.4cm][c]{.7cm}{\\begin{center}$xy$\\end{center}}}}_1 ^ 1}=\"b \" ,    \" b\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xy$\\end{center}}}}_1 ^ 1}=\"c \" ,    \" c\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$xy$\\end{center}}}}_1 ^ 1}=\"d \" ,    \" d\"+<{2cm},0cm>*{{\\ovalbox{\\parbox[c][.4cm][c]{.7cm}{\\begin{center}$z$\\end{center}}}}_0 ^ 1}=\"e \" ,    { \" a \" \\ar   \" b \" } ,     { \" b \" \\ar   \" c \" } ,    { \" c \" \\ar   \" d \" } ,    { \" d \" \\ar   \" e \" } , } \\ ] ]    although the structure of abstract objects and operators for adapting @xmath0 to work with rational trees is more complex , we expect the optimal abstract operators for rational trees on @xmath2 and @xmath1 to be simpler than those presented here for finite trees . this is because we do not need to worry about the occur - check condition ( embedded in our unification operator ) and infinite multiplicities .",
    "we summarize the main results of this paper :    * we define a new domain @xmath0 as a general framework for investigating sharing and linearity properties and provide the optimal unification operator . * we show that @xmath0 is a useful starting point for studying further abstractions .",
    "we obtain the optimal operators for single binding abstract unification in @xmath1 and @xmath2 , and we show that these are strictly more precise than all the other operators in the literature for the same domains . * we show , for the first time , an optimality result for a domain which combines aliasing and linearity information .",
    "moreover , as a negative result , we prove that the standard schema of the iterative unification algorithm ( one binding at a time ) does not lead to optimal operators for the domains @xmath2 and @xmath1 . as a side result",
    ", we show that @xmath689 and @xmath2 with optimal operators may be more precise than @xmath22 for groundness analysis .",
    "several things remain to be explored : first of all , we need to study the impact on the precision and performance obtained by adopting the new optimal operators and domains .",
    "we plan to implement the operators on @xmath2 and @xmath1 within the ciaopp static analyzer @xcite .",
    "moreover , we plan to analyze the domain @xmath836 @xcite in our framework and , possibly , to devise a variant of @xmath2 which enjoys a similar closure property for redundant sharing groups .",
    "this could be of great impact on the efficiency of the analysis .",
    "last but not least , we plan to translate our framework to the case of unification over rational trees .",
    "in this section we give the proofs of the main results of the paper .",
    "it is enough to prove that @xmath837 when @xmath838 .",
    "assume that @xmath839 , then by definition of @xmath184 there exists a renaming @xmath74 such that @xmath840 for each @xmath841 .",
    "given @xmath842 , if @xmath843 we have @xmath844 .",
    "this concludes the proof .",
    "let @xmath845 .",
    "the proof is by induction on the structure of the term @xmath43 . if @xmath846 is a constant , then @xmath847 which is equal to @xmath848 since @xmath849 for each @xmath850 . if @xmath851 is a variable , then @xmath852 . at the same time , @xmath853 since @xmath854 and @xmath855 for @xmath856 .",
    "for the inductive case , if @xmath857 , we have @xmath858 by inductive hypothesis .",
    "moreover @xmath859 let @xmath56 be a set of variables with @xmath321 . by definition , @xmath860 . since @xmath321 , for any @xmath861 it holds that @xmath862 , and thus @xmath863",
    "the operation @xmath402 is correct w.r.t .",
    "@xmath206 , i.e. , @xmath403_u \\in { \\mathtt{shlin}^{\\omega } } , \\delta \\in { \\mathit{isubst}}.~[s]_u \\rightslice [ \\theta]_{u } \\implies   { \\mathrm{mgu}}_{\\mathrm{\\omega}}([s]_u,\\delta ) \\rightslice   { \\mathrm{mgu}}([\\theta]_{u},\\delta ) \\enspace .\\ ] ]    given @xmath250_u \\rightslice [ \\theta]_{u}$ ] and @xmath216 , we need to prove that @xmath393_u,\\delta ) \\rightslice    { \\mathrm{mgu}}([\\theta]_{u},\\delta)$ ] or the equivalent property @xmath867_u,\\delta ) ) \\leq_{\\mathrm{\\omega}}{\\mathrm{mgu}}_{\\mathrm{\\omega}}([s]_u,\\delta)$ ] .",
    "since @xmath402 is defined inductively on the number of bindings in @xmath69 , it is enough to prove that @xmath393_u , x / t ) \\rightslice { \\mathrm{mgu}}([\\theta]_{u},\\{x / t\\})$ ] for a single binding @xmath92 .",
    "since composition of correct operators is still correct , it follows that multi - binding unification is correct .",
    "moreover , when @xmath868 , we exploit the identity @xmath364_{u},\\{x / t\\ } ) =    { \\mathrm{mgu}}({\\mathrm{mgu}}([\\theta]_{u } , [ \\epsilon]_{{\\mathit{vars}}(x / t)}),\\{x / t\\})$ ] .",
    "when computing @xmath364_u,[\\epsilon]_{{\\mathit{vars}}(x / t)})$ ] all the variables in @xmath580 occurring in @xmath24 are renamed apart from @xmath92 itself .",
    "therefore each @xmath869 is free ( hence linear ) in @xmath364_u,[\\epsilon]_{{\\mathit{vars}}(x / t)})$ ] , i.e. , @xmath870_{u } , [ \\epsilon]_{{\\mathit{vars}}(x / t)}))= \\left[s      \\cup \\ { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v \\multir \\mid v \\in { \\mathit{vars}}(x / t ) \\setminus u      \\}\\right]_{u \\cup { \\mathit{vars}}(x / t ) } \\enspace .\\ ] ] therefore , it is enough to prove that @xmath393_u , x / t ) \\rightslice { \\mathrm{mgu}}([\\theta]_{u},\\{x / t\\})$ ] when @xmath356 .",
    "let @xmath34 be a sharing group in @xmath867_u , \\{x / t\\}))$ ] , we prove that @xmath423_u , x / t)$ ] .    if @xmath871 , we consider a multigraph @xmath279 with only one node labelled by @xmath108 and no edges .",
    "it is easy to check that @xmath279 is a sharing graph for @xmath244 ( since @xmath872 ) and @xmath92 , and that @xmath873 .",
    "therefore , in the following we consider only the case @xmath874 .",
    "the proof is composed of three parts : first , we look for a ( special ) substitution @xmath875 obtained by renaming some variables in @xmath24 and such that @xmath875 is still approximated by @xmath244 ; second , we define a multigraph @xmath279 exploiting the variables of @xmath875 ; third , we show that we can restrict @xmath279 to a smaller sharing graph whose resultant @xmath15-sharing group is exactly @xmath34",
    ".    * first part . * without loss of generality , we assume that @xmath876 ( this is always possible since , in any class @xmath191_{u}$ ] , there exists a substitution whose domain is exactly @xmath56 ) .",
    "let @xmath877 with @xmath878 and we have @xmath410_u={\\mathrm{mgu}}([\\theta]_u,[x / t]_u)$ ] . since @xmath876 , we have @xmath879 .",
    "consider @xmath411 obtained from @xmath412 by replacing each occurrence of a variable in @xmath413 with a different fresh variable .",
    "this means that there exists @xmath880 mapping variables to variables such that @xmath881 for each @xmath882 .",
    "namely , we have @xmath883 note that @xmath74 is not a renaming , since it is not bijective .",
    "we now show that @xmath414 has the property that @xmath250_u    \\rightslice [ \\beta]_u$ ] . for any @xmath884_u)$ ] , we may distinguish three cases :    * @xmath885 . in this case @xmath886 by definition of @xmath0 ; * @xmath887 for @xmath888 . in this case",
    "@xmath889 for each @xmath236 , therefore @xmath890 ; * @xmath887 for @xmath891 .",
    "hence there exists @xmath892 such that @xmath893 and @xmath894 for each @xmath895 .",
    "hence , for each @xmath841 , @xmath896 iff @xmath897 and this implies @xmath898 .",
    "* second part . *",
    "consider the labelled multigraph @xmath279 such that @xmath901 , @xmath902 and @xmath903 .",
    "note that if @xmath904 , then @xmath905 , too .",
    "each position @xmath96 in @xmath282 is an arrow such that @xmath906 and @xmath907 .",
    "observe that the second condition in the definition of sharing graph for @xmath244 and @xmath92 is satisfied , since @xmath250_u \\rightslice [ \\beta]_u$ ] .",
    "let us check the third condition .",
    "for each node @xmath908 , if @xmath909 by prop .",
    "[ prop : chi ] we have @xmath910 , i.e. , there are @xmath295 positions in @xmath911 corresponding to @xmath8 .",
    "therefore the outdegree of @xmath8 is @xmath295 . in the same way",
    ", we have that @xmath912 is the in - degree of @xmath8 .    * third part .",
    "* given @xmath913 , by prop .",
    "[ prop : thetam1 ] we have @xmath914 . since @xmath915 , then @xmath410_u={\\mathrm{mgu}}([\\beta]_u,\\{x / t\\})=[{\\mathrm{mgu}}(\\beta,\\{x / t\\})]_u$ ] .",
    "therefore @xmath916 .",
    "we call @xmath69 the result of @xmath917 , and note that @xmath918 is equivalent to the set of equations @xmath919 .",
    "the relation @xmath920 means that , if @xmath921 and @xmath922 then @xmath923 .",
    "the latter implies that there are in @xmath118 equations of the kind @xmath924 , @xmath925 ,  , @xmath926 with @xmath927 and @xmath928 , i.e. , that @xmath437 and @xmath444 are connected in the graph @xmath279 .",
    "therefore , let @xmath929 .",
    "this is not empty , since @xmath874 . if @xmath96 is an edge such that @xmath930 , then @xmath931 , since @xmath932 .",
    "the converse also holds .",
    "hence , if we restrict the graph @xmath279 to the set of nodes @xmath421 , we obtain a sharing graph whose resultant @xmath15-sharing group is @xmath933 .",
    "the single binding unification @xmath393_u , x / t)$ ] is optimal w.r.t .",
    "@xmath206 , under the assumption that @xmath356 , i.e. , : @xmath451_u , x / t)~\\exists \\delta\\in   { \\mathit{isubst}}.~[s]_u \\rightslice [ \\delta]_u \\text { and } b\\in \\alpha_{\\mathrm{\\omega}}({\\mathrm{mgu}}([\\delta]_u,\\{x / t\\ } ) ) \\enspace .\\ ] ]    let @xmath934 . by definition of @xmath358",
    ", there exists a sharing graph @xmath935 such that @xmath936 .",
    "let @xmath937 .",
    "we want to define a substitution @xmath69 such that @xmath250_u    \\rightslice [ \\delta]_u$ ] and @xmath938_u,\\{x / t\\}))$ ] .",
    "if @xmath939 this is trivial , hence we assume that @xmath940 .",
    "the structure of the proof is as follows : first , we define a substitution @xmath69 which unifies with @xmath92 ; second , we show that @xmath69 is approximated by @xmath250_u$ ] , namely , @xmath250_u",
    "\\rightslice [ \\delta]_u$ ] ; third , we show that @xmath938_u,\\{x / t\\}))$ ] .",
    "* first part .",
    "* we now define a substitution @xmath69 which unifies with @xmath92 . for each node",
    "@xmath941 we consider a fresh variable @xmath942 and we denote by @xmath101 the set of all these new variables .",
    "for any @xmath943 we define a term @xmath944 of arity @xmath945 as follows : @xmath946 we know that there exists a map @xmath947 such that , for each variable @xmath5 and node @xmath295 , the set of edges targeted at @xmath295 and labelled with @xmath5 by @xmath151 is exactly @xmath948 .",
    "namely , we require @xmath949 the idea is that each edge targeted at the node @xmath295 is actually targeted at one of the specific variables in @xmath950 .",
    "in particular , each variable @xmath951 should have exactly @xmath948 edges targeted at it , so that the total number of edges pointing @xmath295 is @xmath952 , i.e. , the in - degree of @xmath295 .",
    "the map @xmath151 chooses , for each edge targeted at @xmath295 , a variable in @xmath950 according to the previous idea .",
    "now , for each node @xmath295 and variable @xmath953 , we denote by @xmath954 the set of edges pointing at @xmath5 in @xmath295 , i.e. , @xmath955 .",
    "thus @xmath954 may be partitioned in @xmath956 sets of @xmath957 elements , denoted by @xmath958 such that @xmath959 .",
    "we may define some variations of the terms @xmath944 by replacing the variables occurring in them with those in the set @xmath960 .",
    "in particular , for @xmath943 and any occurrence @xmath96 of a variable @xmath5 in @xmath43 , we define the term @xmath961 of arity @xmath962 as @xmath963 where , if @xmath964 , we define @xmath965 as the sequence @xmath966 where @xmath967",
    ".    note that @xmath944 and @xmath968 have , in corresponding positions , variables related to nodes which are connected through edges .",
    "we are now ready to define the substitution @xmath69 in the following way :    * @xmath440 is the same as @xmath43 with the difference that each occurrence @xmath96 of a variable @xmath969 is replaced by the term @xmath970 ; * for @xmath943 then @xmath971 ; * in all the other cases , i.e @xmath972 , @xmath973 .      *",
    "if we choose the variable @xmath430 for some @xmath975 , by construction @xmath976 . moreover , since @xmath977 is a sharing graph , there are @xmath978 edges in @xmath86 departing from @xmath295 and targeted to nodes @xmath979 such that @xmath980 .",
    "thus @xmath981 and @xmath982 .",
    "since for each @xmath983 we have that @xmath984 , we obtain the required result which is @xmath985 .",
    "* if we choose a variable @xmath983 then @xmath986 and @xmath987 .",
    "* finally , if @xmath988 , then @xmath989 and @xmath990 .",
    "let @xmath994 be the set of equations @xmath995 .",
    "we show that , for any edge @xmath996 , it follows from @xmath994 that @xmath997 .",
    "since @xmath996 , then for some @xmath998 it holds that @xmath999 .",
    "this implies that @xmath1000 and therefore there exists a position @xmath96 such that @xmath1001 . by definition of @xmath968 , it means that @xmath1002 , in the same position where @xmath1003 occurs in @xmath944 , hence @xmath997 follows from @xmath1004 .",
    "we know that @xmath977 is connected , hence for any @xmath1005 , the set of equations in @xmath994 implies @xmath997 .",
    "we choose a particular node @xmath1006 and , for what we said before , we have @xmath1007 .",
    "we show that @xmath1008 .",
    "@xmath1009 since @xmath935 is a sharing graph , the total out - degree @xmath1010 , is equal to the total in - degree @xmath1011 .",
    "hence @xmath1012 this concludes the proof .        following the previous theorem",
    ", we find @xmath69 such that @xmath991_v,\\{x / t\\}))$ ] and @xmath453_v    \\rightslice [ \\delta]_v$ ] .",
    "we want to prove that @xmath250_u \\rightslice    [ \\delta]_u$ ] and @xmath1016_v,\\{x / t\\ } ) ) \\leq_{\\mathrm{\\omega}}\\alpha_{\\mathrm{\\omega}}({\\mathrm{mgu}}([\\delta]_u,\\{x / t\\}))$ ] , so that @xmath215_u$ ] is the existential substitutions we are looking for .            for each @xmath1028",
    "there exist a position @xmath1029 such that @xmath1030 and @xmath1031 is equivalent to @xmath1032 .",
    "note that , since @xmath1033 , then @xmath944 ( which is actually @xmath442 ) is linear and independent from @xmath92 and the other bindings in @xmath69 . therefore @xmath1034 where @xmath1035 and @xmath1036 .",
    "it follows that @xmath1037_v ) \\\\        = & \\alpha_{\\mathrm{\\omega}}([{\\mathrm{mgu}}(\\{x = t\\ } \\cup { \\mathrm{eq}}(\\delta|_u ) ) ] _ v )",
    "\\\\        = & \\alpha_{\\mathrm{\\omega}}({\\mathrm{mgu}}([\\delta]_u , \\{x / t\\ } ) ) \\enspace .",
    "\\end{split}\\ ] ]    if @xmath1026 , then @xmath1038 note that @xmath4 appears in @xmath618 only in the multiset @xmath1039 .",
    "moreover , if @xmath295 is a node labelled by @xmath1039 , there is only one edge which departs from @xmath295 and there are no edges which arrive in @xmath295 .",
    "this means that      as a result , @xmath440 is linear and does not share variables with @xmath92 or the other bindings in @xmath69 .",
    "the last formula may be rewritten as @xmath1043 where @xmath875 is a substitution such that @xmath1044 .",
    "it is obvious that @xmath1045_v)\\\\      = \\ &",
    "\\alpha_{\\mathrm{\\omega}}([{\\mathrm{mgu}}(\\{x = t\\ } \\cup { \\mathrm{eq}}(\\delta|_u ) \\cup      \\ { y = t_y \\mid y \\in { \\mathit{vars}}(t ) \\setminus u \\})]_v )      \\enspace .",
    "\\end{split}\\ ] ] since @xmath1046 .",
    "let @xmath1047 , then @xmath1048}\\\\        = & \\delta|_u \\circ \\{x/\\delta|_u(t)\\ } \\circ \\delta|_{u_1 } \\\\        & \\text{[since $ \\{x\\}\\notin { \\mathit{vars}}(\\delta|_{u_1})$ ] }      \\end{split}\\ ] ] note that @xmath1049 is @xmath1050 .",
    "we call @xmath1051 and we prove that @xmath1052_v )",
    "\\geq_{\\mathrm{\\omega}}\\alpha_{\\mathrm{\\omega}}([\\gamma    \\circ \\delta|_{u_1}]_v)$ ] .    consider a variable @xmath236 .",
    "if @xmath1053 there is nothing to prove . if @xmath1054 we know that @xmath8 does not occur anywhere else in @xmath1055 and @xmath1056",
    "then @xmath1057 for the unique @xmath5 such that @xmath1058 .",
    "therefore , since @xmath1059 , the sharing group over @xmath100 we obtain in @xmath1060 from @xmath8 may be obtained in @xmath1056 from the variable @xmath5 . if @xmath1061 then @xmath1062 which occurs in every element of @xmath0 .",
    "we first prove that these conditions are necessary .",
    "assume that @xmath34 is a resultant sharing group for @xmath244 and @xmath92 , obtained by the sharing graph @xmath279 .",
    "we show that there exist a finite set @xmath1063 and , for each @xmath1064 , a multiset @xmath1065 , which satisfy the above conditions .",
    "take @xmath1066 and @xmath1067 for each @xmath311 , so that @xmath1068 .",
    "since then in - degree of each node is @xmath1069 , the sum of the in - degrees of all the nodes is @xmath1070 and the sum of the out - degree is @xmath1071 .",
    "both of them must be equal to the number of edges in @xmath282 .",
    "moreover , each connected graph with @xmath1072 nodes has at least @xmath1073 edges .",
    "finally , if a connected graph has more than one node , then every node @xmath435 has an adjacent edge .",
    "therefore , either @xmath1069 or @xmath1074 is not zero .",
    "now we prove that the conditions are sufficient .",
    "let @xmath1075 . if @xmath475 and @xmath1076 for the only @xmath1064 , simply consider a sharing graph with a single node labelled with @xmath1077 and no edges",
    "otherwise , we partition the set @xmath1063 in three parts :      note that this is a partition of @xmath1063 since , by hypothesis , @xmath1081 .",
    "now we define a connected labelled multigraph @xmath279 whose sets of nodes is @xmath1063 and whose labelling function is @xmath1082 . in order to define the edges , we distinguish two cases .",
    "@xmath1083 : : :    let @xmath1084 with @xmath1085 and consider the set of edges :    @xmath1086 @xmath1087 : : :    if @xmath1088 , then also @xmath1089    and there is nothing to prove .",
    "we assume that    @xmath1090 , and thus    @xmath1091 .",
    "let @xmath1092 ,    @xmath1093 and consider the set of edges :    @xmath1094      1 .",
    "it is connected ; 2 .",
    "it has exactly @xmath1095 edges , i.e. it is a tree ( if we do not consider the direction of edges ) ; 3 .   there is no edge targeted at a node @xmath435 with @xmath1096 and no edge whose source is a node @xmath435 with @xmath1097 .",
    "if @xmath1098 is the in - degree of a node and @xmath1099 the outdegree , we call _ unbalancement factor _ of the graph the value : @xmath1100 we prove that given a pre - sharing graph with unbalancement factor @xmath1101 , we can build another pre - sharing graph with unbalancement factor strictly less then @xmath1101 . as a result",
    ", there is a pre - sharing graph with unbalancement factor equal to zero .",
    "assume that the graph has unbalancement factor @xmath1101 .",
    "there is at least an unbalanced node .",
    "assume without loss of generality that the unbalanced node is @xmath1102 and that @xmath1103 .",
    "since @xmath1104 , there exists a node @xmath651 such that @xmath1105 .",
    "let @xmath1106 be the unique edge with source @xmath1102 such that , if we remove @xmath1106 from the graph , @xmath651 becomes disconnected from @xmath1102 .",
    "since no edge starts from a node @xmath435 with @xmath1107 , then @xmath1108 .",
    "this means that @xmath1109 and there is at least another edge starting from @xmath1102 .",
    "assume that it is @xmath1110 .",
    "remove this edge and replace it with an edge @xmath1111 .",
    "it is obvious that the result is a pre - sharing graph with a smaller unbalancement factor than the original one .",
    "the case for @xmath1112 is symmetric .",
    "once the unbalancement factor is zero , since @xmath1113 we can freely add other edges in such a way to complete the graph w.r.t .",
    "the condition on the degree of nodes .",
    "we obtain a sharing graph @xmath279 such that @xmath1114 .",
    "it is obvious that @xmath1119 and @xmath1120 are monotone functions and that they are both join - morphisms .",
    "extensionality of @xmath1121 follows from the fact that , given an @xmath15-sharing group @xmath34 , we have @xmath1122 .",
    "finally , given a 2-sharing group @xmath40 , we have @xmath1123 .",
    "this implies that @xmath1124 is the identity .",
    "given @xmath250_u \\in { \\mathtt{shlin}^{\\omega}}$ ] and the binding @xmath92 with @xmath356 , we have that @xmath560_u , x / t ) & = [ ( s\\setminus s ' ) \\cup \\\\        & { { \\mathop{\\downarrow}}}\\bigl\\ { { \\biguplus}y \\mid y \\in { \\wp_m}(s ' ) ,        n \\in \\chi(y , x ) \\cap \\chi(y , t).\\ n \\geq { |y|}-1     \\bigr\\}]_u \\enspace ,    \\end{split}\\ ] ] where @xmath561 .    by using prop . [ prop : abstraction ] point [ eq : abstraction2 ] , and since @xmath1125 , we get : @xmath1126 therefore , we get the equality @xmath1127_u , x / t)=\\bigl[s \\setminus { \\mathit{rel}}(s , x , t )   \\cup \\\\    \\alpha_{\\mathrm{2}}\\bigl(\\ { { \\uplus}{\\mathcal{r}}\\mid { \\mathcal{r}}\\in    { \\wp_m}({\\mathit{rel}}(\\gamma_2(s),x , t ) ) , \\sum_{b \\in { \\mathcal{r } } } \\chi(b , x ) = \\sum_{b \\in      { \\mathcal{r } } } \\chi(b , t ) \\geq { |{\\mathcal{r}}|}-1 \\}\\bigr)\\bigr]_u \\enspace .\\end{gathered}\\ ] ] now , with simple algebraic manipulations , we obtain : @xmath1128   \\cap \\ { \\sum_{1\\leq",
    "i \\leq k }        \\chi(b'_i , t)~|~ \\forall i. \\alpha_{\\mathrm{2}}(b'_i ) = o_i\\ } \\ } \\enspace .\\end{aligned}\\ ] ]    the move from a single family @xmath1129 to different families @xmath1129 and @xmath1130 is possible since , if @xmath1131 we may define a family @xmath1132 such that @xmath1133 and @xmath1134 for each @xmath1135 . it is immediate to check that the @xmath1136 s satisfy the condition @xmath1137        if there exists @xmath589 such that @xmath601 , then @xmath1141 is an infinite set .",
    "we call @xmath295 its least element . under the same conditions",
    ", @xmath1144 is the interval @xmath1145 $ ] . if there is no @xmath589 such that @xmath601 , then @xmath1146 and they are both singletons .    in the same way ,",
    "if there exists some @xmath589 such that @xmath513 then @xmath1147 is an interval of the kind @xmath1148 .",
    "however , if there is no such @xmath40 , then @xmath1147 is a singleton , whose unique element is @xmath1149 .",
    "assume that we have @xmath1150 such that there exists @xmath1151 with @xmath1152 .",
    "we want to prove that we may find a multiset @xmath1153 such that there exists @xmath1154 with @xmath1155 and @xmath1156 .",
    "this is enough to complete the proof of the theorem .",
    "* @xmath1147 and @xmath1142 are both infinite . in this case",
    ", @xmath1141 is infinite .",
    "moroever , since @xmath1147 is an interval , there are infinite natural numbers in @xmath1157",
    ". we may take @xmath1158 .",
    "* @xmath1142 is infinite and @xmath1147 is a singleton @xmath1159 , then @xmath1160 .",
    "since it must be @xmath1161 , there are only two choices : either @xmath1162 or @xmath1163 .",
    "we distinguish the two subcases . * * @xmath1163 . in this case",
    ", there exists @xmath589 such that @xmath1164 and @xmath1165 , otherwise it is not possible that @xmath1166 .",
    "since @xmath1142 is infinite , the same holds for @xmath1141 , hence we may find an @xmath1167 such that @xmath1168 .",
    "consider @xmath1169 .",
    "we have @xmath1170 , @xmath1171 and @xmath1172",
    ". therefore @xmath1173 and @xmath1174 .",
    "@xmath1175 is a valid result , and @xmath1156 . *",
    "* @xmath1162 .",
    "if there is an @xmath589 such that @xmath1164 , the proof proceeds as in the previous case",
    ". otherwise , @xmath1176 and since it should be @xmath1177 , we have @xmath1178 .",
    "therefore @xmath1179 too , since @xmath1180 , and we may take @xmath1158 . *",
    "if @xmath1142 is finite , then @xmath1181 and we take @xmath1158 .      first of all , given a finite set of variables @xmath100 , let us define the extension operator @xmath1182 such that @xmath1183_u ) = [ s \\cup \\ { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v \\multir \\mid v \\in v \\setminus u \\}]_{u \\cup v}$ ] .",
    "given @xmath1184 , we have that @xmath1127_u , x / t)=\\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_\\omega(\\gamma_{\\mathrm{2}}([s]_u ) , x / t ) ) \\\\= \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_\\omega({\\mathrm{ext}}_v(\\gamma_2([s]_u)),x / t))\\enspace .",
    "\\end{gathered}\\ ] ] we also know that @xmath1185_{u \\cup v } , x / t)=\\\\     \\alpha_{\\mathrm{2}}({\\mathrm{mgu}}_\\omega(\\gamma_2([s \\cup \\ {   v_1 , \\ldots , v_n \\}]_{u \\cup v } ) , x / t ) ) \\enspace .",
    "\\end{gathered}\\ ] ] hence , it is enough to prove that @xmath1186_u ) ) = \\gamma_2([s \\cup \\ {   v_1 , \\ldots , v_n \\}]_{u \\cup v } ) \\enspace .\\ ] ] by definition of @xmath1120 , we have that @xmath1187_{u \\cup v } ) \\\\      = ~ & \\bigl[\\bigcup \\ { \\gamma_2(o ) \\mid o \\in s \\cup \\ { v_1 , \\ldots , v_n \\ } \\}\\bigr]_{u \\cup v } \\\\      = ~ & \\bigl[\\bigcup \\ { \\gamma_2(o ) \\mid o \\in s \\ }",
    "\\cup \\ { { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v_1 \\multir , \\ldots , { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v_n \\multir \\}\\bigr]_{u \\cup v } \\qquad \\text{[since $ \\gamma_2(v_i ) = { \\{\\!\\!\\ { } \\newcommand{\\multir}{\\}\\!\\!\\}}v_i \\multir$]}\\\\      = ~ & { \\mathrm{ext}}_v(\\gamma_2([s]_u ) ) \\enspace ,    \\end{aligned}\\ ] ] which completes the proof .    given @xmath250_u \\in { \\mathtt{shlin}^2}$ ] and the binding @xmath92 with @xmath356 , we have @xmath532_u , x / t )   = [ ( s\\setminus s ' ) \\cup        { { \\mathop{\\downarrow}}}\\bigcup_{x \\subseteq s ' } { \\mathit{res}}(x , x , t)]_u \\enspace , \\ ] ] where @xmath561 and @xmath604 is defined as follows :    1 .",
    "if @xmath118 is non - linear for @xmath4 and @xmath43 , then @xmath605 ; 2 .",
    "if @xmath118 is non - linear for @xmath4 and linear for @xmath43 , @xmath606 and @xmath607 , then we have @xmath608 ; 3 .",
    "if @xmath118 is linear for @xmath4 and strongly non - linear for @xmath43 , @xmath609 and @xmath610 , then we have @xmath611 ; 4 .",
    "if @xmath118 is linear for @xmath4 and not strongly non - linear for @xmath43 , @xmath610 , then we have @xmath612 5 .   otherwise @xmath613 .        *",
    "if @xmath118 is non - linear for @xmath4 and @xmath43 , it is @xmath1194 .",
    "we distinguish two subcases : * * if @xmath1195 , it is enough to take @xmath1196 .",
    "* * if @xmath1197 is finite , since @xmath118 is non - linear for @xmath43 , there exists @xmath1198 such that @xmath1199 .",
    "since @xmath618 is downward closed , consider @xmath1200 such that @xmath1201 and @xmath1202 if @xmath1135 .",
    "we show that there exists a natural number @xmath295 such that , for @xmath1203 , we have @xmath1204 and @xmath1205 . since @xmath1206 , we need to solve the inequalities @xmath1207 and @xmath1208 .",
    "since @xmath1209 , there always exists a solution for @xmath295 . since @xmath1210",
    ", we have that @xmath1211 is in the left hand side of . * if @xmath118 is non - linear for @xmath4 and linear for @xmath43 .",
    "we need to find @xmath979 such that , if we take @xmath1212 , we have @xmath1204 . in other words , we need to solve the disequation @xmath1213 , which is always possible , since @xmath607 .",
    "since @xmath1214 we have @xmath1215 . *",
    "if @xmath118 is linear for @xmath4 and strongly non - linear for @xmath43 , we distinguish two subcases : * * @xmath1195 .",
    "let @xmath1216 and consider any number @xmath979 such that @xmath1217 ( such an @xmath979 always exists since @xmath609 ) .",
    "then , consider the multiset @xmath1218 , and we have that @xmath1219 by construction .",
    "moreover @xmath1220 and @xmath1221",
    ". then @xmath1222 is a valid resultant sharing group . *",
    "* @xmath1197 is finite .",
    "let @xmath602 be a sharing group such that @xmath603 and @xmath1223 be a generic sharing group in @xmath1224 .",
    "we need to find two natural numbers @xmath295 and @xmath979 such that , if we take @xmath1225 , we obtain @xmath1226 ( from this immediately follows @xmath1227 ) and @xmath1228 .",
    "this means we need to solve the equations : @xmath1229 @xmath1230 since @xmath1231 , the second equation is always satisfied .",
    "a solution for the first equation always exists , since the greatest common divisor of @xmath1232 and @xmath1233 is @xmath1233 .",
    "* if @xmath118 is linear for @xmath4 and @xmath118 is not strongly non - linear for @xmath43 , consider the multiset @xmath1234 . then @xmath1235 and @xmath1236 .",
    "since @xmath1237 , we have that @xmath1226 .",
    "moreover , @xmath1238 .    *",
    "right to left inclusion .",
    "* let @xmath1239 where @xmath1240 and there exists @xmath1152 such that @xmath1241 .",
    "we show that there exists @xmath1242 and @xmath1243 such that @xmath1244 .",
    "let @xmath1245 .",
    "we partition @xmath118 in three multisets @xmath1246 , @xmath1247 and @xmath1248 .",
    "note that @xmath1224 , @xmath1249 and @xmath1250 here are multisets and not ordinary set as in the definition of @xmath533 .",
    "we distinguish several cases :    * if @xmath1251 is linear for @xmath4 and strongly non - linear for @xmath43 , then @xmath1252 .",
    "since @xmath1253 , there are two cases : either @xmath1254 or @xmath1255 , which implies that @xmath1256 .",
    "+ since @xmath1251 is strongly non - linear for @xmath43 , there exists @xmath1257 such that @xmath1258 , and thus @xmath1259 .",
    "therefore @xmath1260 .",
    "since @xmath1261 , we have that @xmath609 .",
    "it follows that @xmath1262 . * if @xmath1251 is linear for @xmath4 and not strongly non - linear for @xmath43 , then , as in the previous case we have @xmath610 . since @xmath118 is not strongly non - linear for @xmath43 , @xmath1263 .",
    "moreover , @xmath1264 . by the condition @xmath1265 , we get @xmath1266 . therefore @xmath1267 . * if @xmath1251 is non - linear for @xmath4 and @xmath43 , then @xmath1268 . *",
    "if @xmath1251 is non - linear for @xmath4 and linear @xmath43 , the proof is symmetric to the one of the first case .",
    "[ th : closedmgu - proof ] given @xmath250_u \\in { \\mathtt{shlin}^2}$ ] and the binding @xmath92 with @xmath356 , we have @xmath532_u , x / t )   = [ ( s\\setminus s ' ) \\cup       { { \\mathop{\\downarrow}}}\\bigcup_{x \\subseteq \\max s ' } ( { \\mathit{res}}(x , x , t ) \\cup       { \\mathit{res}}'(x , x , t))]_u \\enspace , \\ ] ] where @xmath561 and @xmath653    it clearly holds that : @xmath532_u , x / t )   \\supseteq [ ( s\\setminus s ' ) \\cup { { \\mathop{\\downarrow}}}\\bigcup_{x \\subseteq \\max s ' } ( { \\mathit{res}}(x , x , t ) \\cup { \\mathit{res}}'(x , x , t ) ) ] _ u\\ ] ] since , for each @xmath1269 , if @xmath1270 is non - empty then @xmath585 may be generated by the characterization in theorem [ th : mguandy ] .",
    "it is enough to take @xmath1271 , hence @xmath1272 according to the last case of theorem [ th : mguandy ] .",
    "we prove the opposite inclusion .",
    "let @xmath1273 and assume that @xmath1274 .",
    "there exists @xmath1275 obtained by replacing each @xmath1276 with @xmath1277 such that @xmath1278 .",
    "we have that @xmath1279 since two different elements in @xmath118 may be replaced with the same maximal element in @xmath1280 .",
    "we want to prove that either @xmath613 , or @xmath1281 or @xmath1282 .",
    "therefore , we assume that @xmath1283 and compare the linearity properties ( linear , non linear , strongly non - linear ) of @xmath1280 w.r.t .  those of @xmath118 .",
    "if they coincide , then it follows that @xmath1281 .",
    "this happens because both @xmath604 and @xmath1284 are obtained by the same case of theorem [ th : mguandy ] .",
    "however , note that @xmath1280 may have less elements than @xmath118 and therefore some variable which is non - linear in @xmath604 could be linear in @xmath1284 .",
    "actually , this never happens since the elements in @xmath1280 which are not explicitly delinearized are either elements of the multiset @xmath1285 in the third case of theorem [ th : mguandy ] ( and therefore may appear multiple times ) or elements of @xmath1249 ( @xmath1224 ) subject to the condition @xmath1286 ( @xmath606 ) .",
    "assume that the linearity properties of @xmath118 and @xmath1280 do not coincide .",
    "the only interesting case is when @xmath118 is linear for @xmath4 and not strongly non - linear for @xmath43 . in all the other cases , it is immediate from the definition that @xmath1287 .      if @xmath1280 is linear for @xmath4 and strongly non - linear for @xmath43 , then it is immediate from the definition that @xmath1287 , provided that @xmath609 . otherwise , it must be @xmath1288 and therefore , in order to be @xmath1289 , we have @xmath1290 and @xmath1291 , which means @xmath1292 is linear for @xmath43 .",
    "it follows that @xmath1293 .",
    "if @xmath1280 is not linear for @xmath4 and linear for @xmath43 , we show that @xmath1294 .",
    "assume , by contradiction , that @xmath1295 . since @xmath1280 is linear for @xmath43 and @xmath1296 , then @xmath1297 , while @xmath1298 , which is a contradiction",
    ". thus it must be @xmath1294 .",
    "if @xmath1299 then @xmath1288 , hence @xmath1300 and @xmath1301 .",
    "if @xmath1302 , since @xmath1280 is linear for @xmath43 , it follows that @xmath1303 .",
    "thus @xmath1287 .",
    "it is enough to prove that @xmath729 is correct and optimal w.r.t .",
    "@xmath533 , namely , that : @xmath722),x / t)=\\alpha_{\\mathit{sl } } (    { \\mathrm{mgu}}_{\\mathrm{2}}(\\gamma_{\\mathit{sl}}([s , l , u]),x / t ) ) \\enspace .\\ ] ] let @xmath1304)=[t]_u$ ] . by theorem [ th : closedmgu - proof ]",
    ", it holds that : @xmath1305),x",
    "/ t)\\\\      = \\ & \\alpha_{\\mathit{sl}}([(t\\setminus t ' ) \\cup { { \\mathop{\\downarrow}}}\\bigcup_{y \\subseteq \\max        t ' } ( { \\mathit{res}}(y , x , t ) \\cup { \\mathit{res}}'(y , x , t ) \\})]_u \\\\      = \\ &",
    "\\alpha_{\\mathit{sl}}\\big([t\\setminus t']_u \\sqcup_2 \\bigsqcup_{y \\subseteq \\max        t ' } ( [ { { \\mathop{\\downarrow}}}{\\mathit{res}}(y , x , t)]_u \\sqcup_2 [ { { \\mathop{\\downarrow}}}{\\mathit{res}}'(y , x , t)\\}]_u)\\big ) \\enspace ,    \\end{split}\\ ] ] where @xmath1306 and @xmath1307 is the lowest upper bound in @xmath2 . by additivity of @xmath698 , this is equivalent to @xmath1308_u ) { \\sqcup}_{\\mathit{sl}}{\\bigsqcup}_{y \\subseteq \\max        t ' } ( \\alpha_{\\mathit{sl}}([{\\mathit{res}}(y , x , t)]_u ) { \\sqcup}_{\\mathit{sl}}\\alpha_{\\mathit{sl}}([{\\mathit{res}}'(y , x , t)]_u ) ) \\enspace .\\ ] ] let @xmath118 , @xmath727 , @xmath314 and @xmath725 as in definition [ def : mgushl ] , we have that @xmath733,x / t)$ ] is equivalent to @xmath1309 \\enspace .\\ ] ] we need to prove that equations and do coincide . in the rest of the paper , we assume that the result of is @xmath1310 $ ] .      if @xmath1313 , for @xmath1316 with @xmath1317 , then @xmath1318 with @xmath1319 and @xmath1320 is linear for @xmath43 . if @xmath1321 then is generated by @xmath1322 , since @xmath1320 is linear for @xmath43",
    "if @xmath1323 there are two cases : if @xmath421 is linear for @xmath43 then it is generated by @xmath1324 , otherwise by @xmath1325 . thus @xmath1326 .    now , assume that @xmath1327 with @xmath1328 and @xmath1329 .",
    "then @xmath1330 where @xmath1331 .",
    "since @xmath421 is made of maximal elements and @xmath1332_u=    \\gamma_{\\mathrm{2}}([s , l , u])$ ] , we have that @xmath421 is linear for @xmath4 iff @xmath1333 . for the same reason ,",
    "@xmath421 is linear for @xmath43 iff @xmath1334 is linear for @xmath43 . as a consequence ,",
    "if @xmath421 is non - linear for @xmath43 , then @xmath1335 is non - linear for @xmath43 .",
    "@xmath421 non - linear for @xmath4 and @xmath43 .",
    ": :    then @xmath1336 .",
    "since    @xmath1335 is non - linear for @xmath4 and    @xmath43 , we have    @xmath1337 and    @xmath1338 . thus    @xmath1339 . @xmath421 non - linear for @xmath4 and linear for @xmath43 .",
    ": :    by hypothesis @xmath1340 and    @xmath1341 , hence    @xmath1342    and    @xmath1343 in particular ,    @xmath1344    when @xmath1345 , otherwise    @xmath1346 .",
    "@xmath421 linear for @xmath4 and strongly non - linear for @xmath43 .",
    ": :    in this case we have that    @xmath1347 with @xmath1348 and    @xmath1349 . by definition of strong non - linearity",
    ",    we have two cases :    +    * there exists @xmath1350 such that    @xmath1351 : in this case    @xmath1352    * there exists @xmath1353 such that    @xmath1354 : in this case    @xmath1355 @xmath421 linear for @xmath4 and non strongly non - linear for @xmath43 .",
    ": :    in this case    @xmath1356 with @xmath1357 , for    some @xmath1358 such that    @xmath1359 and    @xmath1360 .",
    "it is obvious that    @xmath1361    by choosing @xmath1362 .",
    "this proves that if @xmath1312 , then @xmath1363 .",
    "now , we need to prove the converse implication . if @xmath1364 , then @xmath1313 for some @xmath1365 , and it is obvious that @xmath1366 , hence @xmath1312 .",
    "therefore , assume that @xmath1367 , and consider the case when @xmath1333 and @xmath1368 .",
    "we have that @xmath1369 for some @xmath1370 , @xmath1371 non - empty subset of @xmath1224 and @xmath1372 .",
    "we may find @xmath1373 , @xmath1374 such that @xmath1375 , @xmath1376 and @xmath1377 .",
    "we have that @xmath1378 is linear for @xmath4 and strongly non - linear for @xmath43 ( due to the element @xmath1223 ) , with @xmath1379 and @xmath1380 .",
    "therefore , we may apply the definition of @xmath1381 to obtain @xmath1382 with @xmath1383 , hence @xmath1312 .    with similar reasonings",
    ", we may prove that for every @xmath1367 , we have @xmath1312 . in particular : the second line of corresponds to the case we choose a @xmath1384 which is linear for @xmath4 and strongly non - linear for @xmath43 , due to an element @xmath1385 which @xmath603 ; the third line of corresponds to the case @xmath1384 is linear for @xmath118 and is not strongly non - linear for @xmath43 ; the first line of @xmath1386 corresponds to the case @xmath1384 is non - linear for both @xmath4 and @xmath43 ; the second line of corresponds to the case @xmath1384 is linear for @xmath43 and non - linear for @xmath4 .    finally , if @xmath1387 and @xmath1388 , it is possible that @xmath34 can not be obtained as @xmath1389 for any @xmath1390 .",
    "however , @xmath34 may be obtained as @xmath1391 , choosing @xmath1384 as in the previous cases . the same happens if @xmath1333and @xmath1392 .",
    "* linearity . *",
    "we want to prove that @xmath1393 .",
    "first of all , let us define @xmath1394_u , x / t))$ ] the set of ground variables in @xmath1395_u , x / t)$ ] , hence @xmath1396 .",
    "we are going to prove that @xmath1397 and @xmath1398 .",
    "the first equality trivially follows from the fact that the sharing component of @xmath729 is optimal , hence a variable occurs in a sharing group of @xmath1399 iff it occurs in a 2-sharing group of @xmath1395_u , x / t)$ ] .",
    "now , we consider a variable @xmath1400 , and prove that @xmath1401 iff @xmath1402 .",
    "there are several cases .",
    "if we assume that @xmath1403 , by we have @xmath1404 .",
    "moreover , if @xmath1405 and @xmath1406 , by maximality of @xmath421 we have @xmath1407 .",
    "hence , by theorem [ th : closedmgu - proof ] , we have @xmath1408 .",
    "if we assume that @xmath1409 , by we have @xmath1401 iff @xmath1410 .",
    "since @xmath1411 , we also have @xmath1402 iff @xmath1410 and therefore @xmath1401 iff @xmath1402 .",
    "the only case it remains to prove is @xmath1412 which , combined with the condition @xmath1413 , gives @xmath1414 . first of all , note that if @xmath1415 then @xmath1416 ( by definition of @xmath727 ) and @xmath1408 ( since @xmath1250 ) appears delinearized in every 2-sharing group resulting from @xmath1381 or @xmath1417 .",
    "if @xmath1418 , we distinguish four subcases :    * @xmath1333 and @xmath703 linear for @xmath43 .",
    "given @xmath1419 , checking the forth case of theorem [ th : mguandy ] when @xmath1420 , we have that @xmath1421 is not linear for @xmath8 iff @xmath1422 or @xmath1423 .",
    "note that there exists @xmath1424 s.t .",
    "@xmath1425 iff @xmath1426",
    ". finally @xmath1402 iff @xmath1427 iff @xmath1428 iff @xmath1429 . *",
    "@xmath1333 and @xmath703 not linear for @xmath43 . given @xmath1430 , checking the third and forth cases ( when @xmath1431 ) of theorem [ th : mguandy ] , we have that @xmath1421 non - linear for @xmath8 implies @xmath1422 or @xmath1432 , which is equivalent to @xmath1433 , i.e. @xmath1404 . on the other hand , if @xmath1434 , we distinguish the cases : * * @xmath703 strongly non - linear for @xmath43",
    ". there exists @xmath1435 such that @xmath601 or @xmath1436 such that @xmath603",
    ". moreover , there exists @xmath1437 such that @xmath1438 .",
    "if we take @xmath1439 , we have that @xmath1421 is not linear for @xmath8 , hence @xmath1408 . * * @xmath703 is not strongly non - linear for @xmath43",
    ". there exists @xmath1440 such that @xmath1441",
    ". moreover , there exists @xmath1442 such that @xmath1438 .",
    "if we take @xmath1443 , by the fourth case in the definition of @xmath1381 , we have @xmath1421 is not linear for @xmath8 , i.e. @xmath1444 . * @xmath1387 and @xmath703 linear for @xmath43 . if @xmath1408 then @xmath1422 or @xmath1445 .",
    "this implies @xmath1446 , i.e. @xmath1404 . on the other hand , if @xmath1447 , there exist @xmath1448 such that @xmath1449 and @xmath1450 such that @xmath1451 . by definition of @xmath1381",
    ", we have that @xmath1452 is not linear for @xmath8 , hence @xmath1408 . * @xmath1387 and @xmath703 non - linear for @xmath43 . since @xmath1453 , it is obvious that @xmath1404 .",
    "moreover , there exist @xmath1454 such that @xmath1449 , @xmath1455 such that @xmath603 and @xmath1456 such that @xmath1457 .",
    "note that it is possible that @xmath1458 . by definition",
    ", we have @xmath1459 is not linear for @xmath8 , hence @xmath1408 .",
    "first of all , given a finite set of variables @xmath100 ,",
    "let us define the extension operator @xmath1460 such that @xmath1183_u ) = [ s \\cup \\ { v \\mid v \\in v \\setminus u \\}]_{u \\cup v}$ ] .",
    "given @xmath1461 , we have that @xmath1462 , x / t ) ) = \\alpha_{\\mathit{sl}}({\\mathrm{ext}}_v({\\mathrm{mgu}}_{\\mathrm{2}}(\\gamma_{\\mathit{sl}}([s , l , u])),x / t))\\enspace .\\ ] ] by theorem [ th : optimal - shl - proof ] we have that @xmath1463,x / t)=     { \\mathrm{mgu}}_{\\mathit{sl}}([s \\cup v , l \\cup v , u \\cup v ] , x / t)=\\\\     \\alpha_{\\mathit{sl}}({\\mathrm{mgu}}_{\\mathrm{2}}(\\gamma_{\\mathit{sl}}([s \\cup v , l \\cup v , u \\cup v],x / t ) ) )   \\enspace .    \\end{gathered}\\ ] ] hence , it is enough to prove that @xmath1464 ) = \\gamma_2([s \\cup v , l \\cup v , u \\cup v ] ) \\enspace .\\ ] ] by definition of @xmath1120 , we have that @xmath1465)= \\\\      = ~ & [ \\ { b_{l \\cup v } \\mid b \\in s\\ } \\cup \\ { b_{l \\cup v } \\mid b \\in v\\ } ] _ { u \\cup v}\\\\      = ~ & [ \\ { b_{l } \\mid b \\in s\\ } \\cup v]_{u \\cup v } \\quad \\text{[since $ v_{l \\cup v } = v$]}\\\\      = ~ &   { \\mathrm{ext}}_v(\\gamma_{\\mathit{sl}}([s , l , u ] ) \\enspace ,    \\end{aligned}\\ ] ] which completes the proof",
    ".    \\2002 .",
    "optimality in goal - dependent analysis of sharing . in _ proceedings of the joint conference on declarative programming ( agp02 ) _ , j.  j. moreno - navarro and j.  mario - carballo , eds .",
    "universidad politcnica de madrid , madrid , 189205 .",
    "\\2003 . a general framework for variable aliasing : towards optimal operators for sharing properties . in _ logic based program synthesis and transformation 12th international workshop , lopstr 2002 , madrid , spain ,",
    "september 1720 , 2002 . revised selected papers _ , m.  leuschel , ed .",
    "lecture notes in computer science , vol . 2664 .",
    "springer , berlin heidelberg , 5270 .        ,",
    "marriott , k. , schachte , p. , and sndergaard , h. 1994 .",
    "boolean functions for dependency analysis : algebraic properties and efficient representation . in _",
    "static analysis , first international static analysis symposium , sas94 namur , belgium , september 2830 , 1994 , proceedings _ , b.  le charlier , ed .",
    "lecture notes in computer science , vol .",
    "springer , berlin heidelberg , 266280 .        ,",
    "cabeza , d. , carro , m. , hermenegildo , m.  v. , lpez - garca , p. , and puebla , g. 1997 .",
    "the ciao prolog system .",
    "reference manual .",
    "clip3/97 , school of computer science , technical university of madrid ( upm ) .",
    "available from ` http://www.ciaohome.org/ ` .",
    "last accessed july 14 , 2009 .",
    "set - sharing is not always redundant for pair - sharing . in _ functional and logic programming ,",
    "7th international symposium , flops 2004 , nara , japan , april 79 , 2004 , proceedings _ , y.  kameyama and p.  j. stuckey , eds .",
    "lecture notes in computer science , vol . 2998 .",
    "springer , berlin heidelberg , 117131 .    , dams , d. , and yardeni , e. 1991 . derivation and safety of an abstract unification algorithm for groundness and aliasing analysis . in _ logic programming , proceedings of the eighth international conference _ , k.  furukawa , ed . logic programming .",
    "the mit press , cambridge , ma , usa , 7993 .                \\1979",
    ". systematic design of program analysis frameworks . in _",
    "popl 79 : proceedings of the 6th acm sigact - sigplan symposium on principles of programming languages_. acm press , new york , ny , usa , 269282 .",
    "1992c . comparing the galois connection and widening / narrowing approaches to abstract interpretation . in _ programming language implementation and logic programming , 4th international symposium , plilp 92 leuven , belgium , august 2628 , 1992 , proceedings _ , m.  bruynooghe and m.  wirsing , eds .",
    "lecture notes in computer science , vol .",
    "springer , berlin heidelberg , 269295 . invited paper .",
    "\\1992 . aliasing and",
    "groundness analysis of logic programs through abstract interpretation and its safety .",
    "tech . rep . 9227 , technical university of aachen ( rwth aachen ) .",
    "available from ` http://sunsite.informatik.rwth-aachen.de/publications/aib ` .",
    "last accessed july 10 , 2009 .      ,",
    "zaffanella , e. , and bagnara , r. 2004 . a correct , precise and efficient integration of set - sharing , freeness and linearity for the analysis of finite and rational tree languages .",
    "_ 4 , _  3 ( may ) , 289323 .",
    "\\1987 . a semantics - based framework for the abstract interpretation of prolog . in _",
    "abstract interpretation of declarative languages _ , s.  abramsky and c.  hankin , eds .",
    "ellis horwood , chichester , uk , 123142 .",
    "\\1994 . a synergistic analysis for sharing and groundness which traces linearity . in _ programming languages and systems",
    " esop 94 , 5th european symposium on programming edinburg , u.k .",
    ", april 1113 , 1994 , proceedings _ , d.  sannella , ed .",
    "lecture notes in computer science , vol .",
    "springer , berlin heidelberg , 363378 .",
    "precise pair - sharing analysis of logic programs . in _",
    "ppdp 02 : proceedings of the 4th acm sigplan international conference on principles and practice of declarative programming_. acm press , new york , ny , usa , 99108 .              \\1986 .",
    "an application of abstract interpretation of logic programs : occur check reduction . in _",
    "esop 86 , european symposium on programming saarbrcken , federal republic of germany march 1719 , 1986 , proceedings _ , b.  robinet and r.  wilhelm , eds .",
    "lecture notes in computer science , vol .",
    "springer , berlin heidelberg , 327338 ."
  ],
  "abstract_text": [
    "<S> in the analysis of logic programs , abstract domains for detecting sharing and linearity information are widely used . devising abstract unification algorithms for such domains </S>",
    "<S> has proved to be rather hard . at the moment , </S>",
    "<S> the available algorithms are correct but not optimal , i.e. , they can not fully exploit the information conveyed by the abstract domains . in this paper , we define a new ( infinite ) domain @xmath0 which can be thought of as a general framework from which other domains can be easily derived by abstraction . </S>",
    "<S> @xmath0 makes the interaction between sharing and linearity explicit . </S>",
    "<S> we provide a constructive characterization of the optimal abstract unification operator on @xmath0 and we lift it to two well - known abstractions of @xmath0 . </S>",
    "<S> namely , to the classical @xmath1 abstract domain and to the more precise @xmath2 abstract domain by andy king . in the case of single binding substitutions , we obtain optimal abstract unification algorithms for such domains .    </S>",
    "<S> [ firstpage ]    static analysis , abstract interpretation , sharing , linearity , unification . </S>"
  ]
}