{
  "article_text": [
    "the detection of compact signals ( sources ) embedded in a background is a recurrent problem in many fields of astronomy .",
    "some common examples are the separation of individual stars in a crowded optical image , the identification of local features ( lines ) in noisy one - dimensional spectra or the detection of faint extragalactic objects in microwave frequencies .",
    "the detection , identification and removal of the extragalactic point sources ( eps ) is fundamental for the study of the cosmic microwave background radiation ( cmb ) data ( franceschini et al .",
    "1989 , toffolatti et al . 1998 ,",
    "de zotti et al . 1999 ) . in particular",
    ", the contribution of eps is expected to be very relevant at the lowest and highest frequency channels of the future esa planck mission ( mandolesi et al .",
    "1998 , puget et al . 1998 ) .",
    "the heterogeneous nature of the eps that appear in cmb maps as well as their unknown spatial distribution make difficult to separate them from the other physical components ( cmb , galactic dust , synchrotron , etc ) by means of statistical component separation methods .",
    "techniques based on the use of linear filters , however , are well - suited for the task of detecting compact spikes on a background .",
    "several techniques based on different linear filters have been proposed in the literature : the mexican hat wavelet ( mhw , cayn et al .",
    "2000 , vielva et al",
    ". 2001a , b , 2003 ) , the classic _ matched _ filter ( mf , tegmark and oliveira - costa 1998 ) , the adaptive top hat filter ( chiang et al 2002 ) and the scale - adaptive filter ( saf , sanz et al . 2001 ) . a certain deal of controversy has appeared about which one , if any , of the previous filters is _ optimal _ for the detection of point sources in cmb data .    in order to answer that question it is necessary to consider first a more fundamental issue , the concept of _ detection _ itself .",
    "the detection process can be posed as follows : given an observation , the problem is to _ decide _ whether or not a certain signal was present at the input of the receiver .",
    "the decision is not obvious since the observation is corrupted by a random process that we call ` noise ' or ` background ' .",
    "formally , the _ decision _ is performed by choosing between two complementary hypotheses : that the observed data is originated by the background alone ( _ null hypothesis _ ) , and the hypothesis that the observation corresponds to a combination of the background and the signal .",
    "to decide , the detector should use all the available information in terms of the probabilities of both hypotheses given the data . the _ decision device _ separates the space @xmath1 of all possible observations in two disjoint subspaces , @xmath2 and @xmath3 , so that if an observation @xmath4 the null hypothesis is accepted , and if @xmath5 the null hypothesis is rejected , that is , a source is ` detected ' ( @xmath2 is called the region of acceptance ) .",
    "hence , we will call any generic decision device of this type a _",
    "detector_.    the simplest example of detector , and one that has been extensively used in astronomy , is _ thresholding _ : if the intensity of the field is above a given value ( e.g. 5@xmath6 ) , a detection of the signal is accepted , on the contrary one assumes that only background is present .",
    "thresholding has a number of advantages , among them the facts that it is straightforward and that it has a precise meaning in the case of gaussian backgrounds in the sense of controlling the probability of spurious detections .",
    "however , it does not use all the available information contained in the data to perform decisions .",
    "for example , the inclusion of spatial information ( such as the curvature ) could help to distinguish the sources from fluctuations in the background with similar scale but a different shape .",
    "a general detector that can use more information than simple thresholding is given by the neyman - pearson ( np ) decision rule : @xmath7 where @xmath8 is called the likelihood ratio , @xmath9 is the probability density function ( _ pdf _ ) associated to the null hypothesis ( i.e. there is no source ) whereas @xmath10 is the _ pdf _ corresponding to the alternative hypothesis ( i.e. there is a source ) .",
    "@xmath11 are a set of variables which are measured from the data .",
    "@xmath12 is an arbitrary constant , which defines the region of acceptance @xmath2 , and must be fixed using some criterion .",
    "for instance , one can adopt a scheme for object detection based on maxima .",
    "the procedure would consist on considering the intensity maxima of the image as candidates for compact sources and apply to each of them the np rule to decide whether they are true or spurious . for a 1d image",
    ", the ratio of probabilities would then correspond to the probability of having a maximum with a given intensity and curvature ( which are the variables @xmath11 in this case ) in the presence of background plus signal over the probability of having a maximum when only background is present . if this ratio is larger than a given value @xmath12 , the candidate is accepted as a detection , if not , it is rejected .",
    "unfortunately , in many cases the sources are very faint and this makes very difficult to detect them . in order to improve the performance of the detector ,",
    "a prior processing of the image could be useful .",
    "here is where _ filtering",
    "_ enters in scene .",
    "the role of filtering is to transform the data in such a way that a detector can perform better than before filtering .",
    "once the detector is fixed , it is interesting to compare the performance of different filters , which has been rarely considered in the literature . in a recent work , barreiro et al .",
    "( 2003 ) introduce a novel technique for the detection of sources based on the study of the number density of maxima for the case of a gaussian background in the presence or absence of a source . in order to define the region of acceptance",
    "the neyman - pearson decision rule is used with _ pdf _",
    "s associated to the previous number densities and using the information of both the intensities @xmath13 and the curvatures @xmath14 of the peaks in a data set .",
    "in addition , @xmath12 is fixed by maximising the _ significance _ , which is the weighted difference between the probabilities of having and not having a source .",
    "in that work the performances of several filters ( saf , mf and mhw ) is compared in terms of their _ reliability _ , defined as the ratio between the number density of true detections over the number density of spurious detections . they find that , on the basis of this quantity , the choice of the optimal filter depends on the statistical properties of the background .",
    "however , the criterion chosen to fix @xmath12 based on the significance does not necessarily leads to the optimal reliability .",
    "therefore , if we are considering the reliability as the main criterion to compare filters , a different criterion for @xmath12 , based on number densities must be used . in a posterior article , vio et al .",
    "( 2004 ) , following the previous work , adopt the same neyman - pearson decision rule , based on the _ pdf _ s of maxima of the background and background plus source , to define the region of acceptance .",
    "however , they propose to find @xmath12 by fixing the number density of spurious detections and compare the performance of the filters based on the number density of true detections . in this case",
    ", the mf outperforms the other two filters .",
    "note that in these last two works different criteria have been used to fix @xmath12 , thus leading to different results .    in the present work , our goal will also be to find an optimal filter that gives a maximum number density of detections fixing a certain number density of spurious sources . in order to define the detector , we will use a decision rule based on the neyman - pearson test .",
    "we will consider some standard filters ( mf , saf and mh ) introduced in the literature as well as a new filter that we call the biparametric scale adaptive filter ( bsaf ) . in all the filters appears in a natural way the scale of the source .",
    "we will modify such a scale introducing an extra parameter .",
    "in fact , it has been shown by lpez - caniego et al .",
    "( 2004 ) that the standard matched filter can be improved under certain conditions by filtering at a different scale from that of the source .",
    "the performance of the bsaf will be compared with the other filters .",
    "the overview of this paper is as follows . in section 2 ,",
    "we introduce two useful quantities : number of maxima in a gaussian background in the absence and presence of a local source . in section 3",
    ", we introduce the detection problem and define the region of acceptance . in section 4 , we introduce an estimator of the amplitude of the source that is proven to be unbiased and maximum efficient . in section 5 and 6 ,",
    "we obtain different analytical and numerical results regarding weak point sources and scale - free background spectra and compare the performance of the new filter with others used in the literature . in section 7 , we describe the simulations performed to test some theoretical aspects and give the main results and finally , in section 8 , we summarize the conclusions and applications of this paper .",
    "appendix a is a sketch to obtain a sufficient linear detector whereas we obtain the linear unbiased and maximum efficient estimator in appendix b.",
    "let us assume a 1d background ( e. g. one - dimensional scan on the celestial sphere or time ordered data set ) represented by a gaussian random field @xmath15 with average value @xmath16 and power spectrum @xmath17 : @xmath18 , where @xmath19 is the fourier transform of @xmath15 and @xmath20 is the 1d dirac distribution .",
    "the distribution of maxima was studied by rice ( 1954 ) in a pioneering article . the expected number density of maxima per intervals @xmath21 , @xmath22 and @xmath23 is given by @xmath24 being @xmath25 the expected total number density of maxima ( i.e. number of maxima per unit interval @xmath26 ) @xmath27    @xmath28    where @xmath29 and @xmath30 represent the normalized field and curvature , respectively .",
    "@xmath31 is the moment of order @xmath32 associated to the field .",
    "@xmath33 are the coherence scale of the field and maxima , respectively . as an example",
    ", figure  [ fig : fig1 ] shows the values of the ratio @xmath34 for the case @xmath35 ( a typical value for the backgrounds we are considering ) . in this case",
    ", the expected density of maxima has a peak around @xmath36 and @xmath37 , that is , most of the peaks appear at a relatively low threshold and curvature , and the density of peaks decreases quickly for extreme values of @xmath38 and @xmath14 .    if the original field is linear - filtered with a circularly - symmetric filter @xmath39 , dependent on @xmath40 parameters ( @xmath41 defines a scaling whereas @xmath42 defines a translation ) @xmath43 we define the filtered field as @xmath44 then , the moment of order @xmath32 of the linearly - filtered field is @xmath45 being @xmath46 the power spectrum of the unfiltered field and @xmath47 the fourier transform of the circularly - symmetric linear filter .",
    "now , let us consider a position @xmath48 in the image where a gaussian source ( i.e. profile given by @xmath49 , where @xmath41 is the beam width ) is superimposed to the previous background . then , the expected number density of maxima per intervals @xmath21 , @xmath22 and @xmath50 , given a source of amplitude @xmath51 in such spatial interval , is given by ( barreiro et al .",
    "2003 ) @xmath52 @xmath53 where @xmath29 and @xmath30 , @xmath54 is the normalized amplitude of the source and @xmath55 is the normalized curvature of the filtered source .",
    "the last expression can be obtained as @xmath56 note that due to the statistical homogeneity and isotropy of the background , the previous equations are independent of the position of the source .",
    "we consider that the filter is normalized such that the amplitude of the source is the same after linear filtering : @xmath57 .",
    "we want to choose between different filters based on _ detection_. to make such a decision , we will focus on the following two fundamental quantities : a ) the number of spurious sources which emerge after the filtering and detection processes and b ) the number of real sources detected .",
    "as we will see in this section , these quantities are properties of the gaussian field and source that can be calculated from equations ( [ nbackground ] ) and ( [ nsource ] ) .",
    "as we will see , the previous properties are not only related to the snr gained in the filtering process but depend on the filtered momenta up to 4th - order ( in the 1d case ) , i.e. the amplification and the normalized curvature .",
    "let us consider a local peak in the 1d data set characterised by the normalized amplitude and curvature @xmath58 .",
    "let @xmath59 : n.d.f .",
    "@xmath60 represents the _ null _ hypothesis , i.e. the local number density of background maxima , and @xmath61 : n.d.f .",
    "@xmath62 represents the _ alternative _ hypothesis , i.e. the local number density of maxima when there is a compact source : @xmath63 in the previous equation , we have introduced a priori information about the probability distribution of the sources : we get the number density of source detections weighting with the a priori probability @xmath64 .    to construct our detector , we will assume a neyman - pearson ( np ) decision rule using number densities instead of probabilities : @xmath65 where @xmath12 is a constant .",
    "the previous equation defines a region in @xmath66 , the so - called region of acceptance @xmath2 .",
    "therefore , the decision rule is expressed such that if the values of @xmath66 of the candidate maximum is inside @xmath2 ( i.e. @xmath67 ) we decide that the signal is present . on the contrary , if @xmath68 we decide that the signal is absent . )",
    "is equivalent to the one defined by the usual neyman - pearson test in terms of probabilities @xmath69 where @xmath70 , @xmath71 are the _ pdf _ s associated to the number densities given by equations ( [ nbackground ] ) and ( [ eq : number_b+s ] ) and , in order to compare different filters , the constant @xmath72 must be found by fixing the number density of spurious sources in the region of acceptance instead of the _ false alarm _ probability . ]",
    "it can be proved that the previous region of acceptance @xmath2 is equivalent to the sufficient linear detector ( see appendix a ) @xmath73 where @xmath74 is a constant and @xmath75 is given by @xmath76 we remark that the assumed criterion for detection leads to a _ linear _ detector @xmath75 ( i.e. linear dependence on the threshold @xmath38 and curvature @xmath14 ) . moreover ,",
    "this detector is independent of the _ pdf _ of the source amplitudes .    using this detector ,",
    "the expected number density of spurious sources and of true detections are given by @xmath77 @xmath78 we remark that in order to get the true number of real source detections such a number must be multiplied by the probability to have a source in a pixel in the data set .",
    "note that for a fixed number density of spurious sources @xmath79 , the np detector leads to the maximum number density of true detections @xmath80 .",
    "taking into account equations ( [ eq : r _ * ] ) to ( [ eq : ndet ] ) , one can find @xmath79 and @xmath80 for a gaussian background .",
    "after a straightforward calculation , the number density of spurious sources found using the np rule is given by : @xmath81 , \\label{eq : nb*}\\end{aligned}\\ ] ] @xmath82 similarly , the number density of detections is obtained as : @xmath83e^{- \\frac{(1 - \\rho^2)\\varphi^2}{2{(1 - \\rho y_s)}^2 } } ,   \\label{eq : nb}\\end{aligned}\\ ] ]    where @xmath84    @xmath85    @xmath86",
    "the signal has an unknown parameter , the amplitude @xmath51 , that has to be estimated from the data @xmath87 .",
    "we shall assume that the most probable value of the distribution @xmath88 gives an estimation of the amplitude of the source ( criterion for amplitude estimation ) .",
    "the result @xmath89 is given by the equation @xmath90 where the function @xmath75 is given by equation ( [ eq : phi ] ) .",
    "one can prove that the previous expression corresponds to a linear estimator that is unbiased and maximum efficient ( minimum variance ) , i.e. @xmath91 where @xmath92 denotes average value over realizations ( see appendix b ) .",
    "we will consider as an application the detection of compact sources characterised by a gaussian profile @xmath93 , and fourier transform @xmath94 , though the extension to other profiles will be considered in the future .",
    "such a profile is physically and astronomically interesting because it represents the convolution of a point source ( dirac @xmath95 distribution ) with a gaussian beam .",
    "the source profile above includes a `` natural scale '' @xmath41 that characterises the source .",
    "this is a fundamental scale that will appear in all the filters we will consider here . by construction ,",
    "the standard mf and saf operate on this scale , as well as the canonical mhw at the scale of the source .",
    "however , it has been shown that changing the scale at which the mhw and the mf filter the image can improve its performance in terms of detection ( vielva et al .",
    "2001a , lpez - caniego et al .",
    "following this idea , we will introduce another degree of freedom in all the filters that allows us to change their scale in a continuous way ( similarly to the scaling of a continuous wavelet ) .",
    "this degree of freedom is obtained by multiplying the scale @xmath41 by a new parameter @xmath96 .",
    "we will show that with this new parameter the improvement in the results is significant .",
    "the idea of a scale - adaptive filter ( or optimal pseudo - filter ) has been recently introduced by the authors ( sanz et al .",
    "2001 ) . by introducing a circularly - symmetric filter , @xmath97",
    ", we are going to express the conditions in order to obtain a scale - adaptive filter for the detection of the source @xmath98 at the origin taking into account the fact that the source is characterised by a single scale @xmath99 .",
    "the following conditions are assumed : @xmath100 , i.e. @xmath101 is an _ unbiased _ estimator of the amplitude of the source ; @xmath102 the variance of @xmath103 has a minimum at the scale @xmath99 , i.e. it is an _",
    "efficient _ estimator ; @xmath104 @xmath105 has a maximum with respect to the scale at @xmath106 .",
    "then , the filter satisfying these conditions is given by ( sanz et al .",
    "2001 ) @xmath107 , \\nonumber\\end{aligned}\\ ] ] @xmath108    assuming a scale - free power spectrum , @xmath109 , and a gaussian profile for the source , the previous set of equations lead to the filter @xmath110 , \\ \\",
    "q\\alpha r , \\nonumber\\end{aligned}\\ ] ] @xmath111 @xmath112 where we have modified the scale as @xmath113 .    in this case",
    "the filter parameters @xmath114 and the curvature of the source @xmath115 are given by @xmath116 @xmath117 @xmath118 @xmath119 figure  [ fig : fig3 ] shows the saf for two values of the spectral index .",
    "if one removes condition ( 3 ) defining the saf in the previous subsection , it is not difficult to find another type of filter after minimization of the variance ( condition ( 2 ) ) with the constraint ( 1 ) @xmath120 this will be called _ matched _ filter as is usual in the literature .",
    "note that in general the matched and adaptive filters are different .    for the case of a gaussian profile for the source and a scale - free power spectrum given by @xmath121",
    ", the previous formula leads to the following modified matched filter @xmath122 @xmath123 where @xmath124 and @xmath125 is given by equation ( [ eq : saf_m ] ) and we have included the scale parameter @xmath126 .",
    "figure  [ fig : fig3 ] shows the mf for the case @xmath127 ( standard mf ) and values of the spectral index @xmath128 .",
    "we remark that for @xmath129 the scale - adaptive filter and the matched filter coincide , and for @xmath130 ( not shown in the figure ) , the matched filter and the mexican hat wavelet are equal .    for the mf",
    "the parameters @xmath131 and the curvature of the source @xmath115 are given by @xmath132 we remark that the linear detector @xmath133 is reduced to @xmath134 for the standard matched filter ( @xmath135 ) .",
    "i.e. curvature does not affect the region of acceptance for such a filter .",
    "the mh is defined to be proportional to the laplacian of the gaussian function : @xmath136 thus , in fourier space @xmath137 in this case the filter parameters @xmath138 and the curvature of the source @xmath115 are given by @xmath139 the generalization of this type of wavelet for two dimensions has been extensively used for point source detection in 2d images ( cayn et al .",
    "2000 , vielva et al .",
    "2001 , 2003 ) . as for the previous filter ,",
    "the mh is modified by including the scale parameter @xmath126 in the form @xmath140 @xmath141 for the mh the parameters @xmath142 and the curvature of the source @xmath115 are given by @xmath143    figure  [ fig : fig3 ] shows the mh for different values of the spectral index .      if one removes condition ( 3 ) defining the saf in subsection 5.1.1 and introduces the condition that @xmath144 has a spatial maximum in the filtered image at @xmath145 , i.e. @xmath146 @xmath147 , it is not difficult to find another type of filter @xmath148 where @xmath149 is an arbitrary constant that can be related to the curvature of the maximum .",
    "we remark that the constraint @xmath150 is automatically satisfied for any circularly - symmetric filter if the source profile has a maximum at the origin .    for the case of a scale - free power spectrum ,",
    "the filter is given by the parametrized equation @xmath151    where we have modified the scale as @xmath113 .",
    "hereinafter , we will call this new filter containing two arbitrary parameters , @xmath152 and @xmath149 , the biparametric scale - adaptive filter ( bsaf ) .",
    "a calculation of the different moments leads to @xmath153 where m and t are defined in equation ( [ eq : saf_m ] ) and @xmath154 and @xmath155 are given by @xmath156\\gamma ( m),\\ ] ]    @xmath157 \\delta^m \\gamma ( m).\\ ] ]    note that the bsaf contains all the other considered filters as particular cases : the mf is recovered for @xmath158 , when @xmath159 the bsaf defaults to the saf and , finally , the mh wavelet is obtained in the two cases : @xmath160 , @xmath161 and @xmath162 , @xmath163 .",
    "we will test two different _ pdf _ @xmath164 : a uniform distribution in the interval @xmath165 and a scale - free distribution with a lower and upper cut - off @xmath166 .",
    "in particular , we will especially focus on values for the cut - off s that lead to distributions dominated by weak sources .",
    "it is in this regime where sophisticated detection methods are needed , since bright sources can be easily detected with simple techniques .      in this case ,",
    "@xmath167.\\ ] ] this allows us to obtain @xmath168,\\ ] ] @xmath169 in general , we will consider a cut - off in the amplitude of the sources such that @xmath170 after filtering with he standard mf . note that this correspond to different thresholds for the rest of the filters .      in this case , @xmath171,\\ \\",
    "\\beta \\neq 1,\\ ] ] where the normalization constant n and @xmath172 are    @xmath173    @xmath174}.\\\\\\ ] ]    in general , we will consider @xmath175 and @xmath176 , @xmath177 after filtering with the standard mf and the corresponding thresholds for the other filters .",
    "for a fixed number density of spurious sources @xmath178 , we want to find the optimal filter that produces the maximum number density of true detections @xmath80 for different spectral indices ( @xmath179 ) , values of @xmath41 and point source distributions .",
    "in order to do this , we first obtain implicitly the value of @xmath74 from equation ( [ eq : nb * ] ) ( for a fixed value of @xmath178 ) and then substitute it in equation ( [ eq : nb ] ) to calculate @xmath80 .",
    "we consider two different distributions of sources to test the robustness of the method : a uniform distribution and a scale - free distribution .",
    "given that bright point sources are relatively easy to detect , we mainly concentrate on the more interesting case of weak sources . in any case",
    ", we also mention some results for distributions containing bright sources .",
    "we remark that the bsaf has an additional degree of freedom , the parameter @xmath149 , as it appears in equation ( [ eq : eqnndf ] ) .",
    "note that the bsaf and the saf are not the same filter .",
    "the parameter @xmath149 in the bsaf can take any positive or negative value , while the coefficient @xmath180 , for the saf , is a known function of @xmath179 . by construction , the bsaf always outperforms the mf and saf or , in the worst case , defaults to the best of them .        as a first case",
    ", we consider a uniform distribution of sources with amplitudes in the interval @xmath181\\sigma_0 $ ] , where @xmath182 is the zero - order moment of the linearly - filtered map with the standard mf .",
    "therefore , the threshold @xmath38 in the image filtered with this filter is in the interval @xmath183 $ ] .",
    "thus , the corresponding upper limit for @xmath38 in the original ( unfiltered ) map is below 2 , what means that we are considering the detection of weak sources .    as a reference example , in figure  [ fig : numdet_alfa_unif_g0 ] , we plot @xmath80 , the number density of detections , as a function of @xmath126 for the case @xmath184 , @xmath185 and @xmath186 , where @xmath41 is given in pixel units . for completeness",
    ", the theoretical values of @xmath80 are given , in this figure , for values of @xmath126 down to zero ( note that @xmath80 @xmath187 @xmath178 when @xmath188 ) .",
    "however , from a practical point of view , we do not expect the theoretical results to reproduce the values obtained for a pixelized image when filtering at small scales ( since the effect of the pixel is not taken into account ) .",
    "therefore , hereinafter , we will only consider those results obtained when filtering at scales larger ( or of the order ) of the pixel size , which corresponds to @xmath189 . taking into account this constraint , the best results are obtained for @xmath190 for the bsaf , that clearly outperforms the standard mf ( i.e. , @xmath127 ) with an improvement of the @xmath0 in @xmath80 .",
    "if we compare with the mf at @xmath191 , the improvement is of @xmath192 .    in figure",
    "[ fig : numdet_alfa_unif_g05 ] , we give the same results for the case @xmath193 . in this case , the bsaf at @xmath191 improves again significantly the standard mf , with an increase in the number density of detections of @xmath194 .    as @xmath179 increases , the improvement of the bsaf with respect to the standard mf decreases .",
    "in fact , for values of @xmath195 they produce very similar results . as an example , we give the number of detections achieved for each filter for the case @xmath196 , @xmath197 and @xmath186 in fig .  [",
    "fig : unif_g1p5 ] .",
    "it can be seen that the maximum number of detections is approximately found for the standard mf .",
    "however , we would like to point out that the saf and mh wavelet at the optimal scale give approximately the same number of detections as the standard mf .",
    "these results show the importance of filtering at scales @xmath113 instead of the usual scale of the source @xmath41 .",
    "this can also be seen in fig .",
    "[ fig : unif_gamma ] , that summarizes how the relative performance of the considered filters with respect to the standard mf changes with the spectral index @xmath179 ( again for @xmath197 and @xmath186 ) . for each filter ,",
    "the results are given for the optimal scale ( and parameter @xmath149 in the case of bsaf ) .",
    "the improvement of the bsaf with respect to the mf ranges from @xmath198 ( for white noise ) to zero ( for the largest values of @xmath199 .",
    "we would also like to point out that the mh at the optimal scale performs similarly to the standard mf .",
    "in addition , the mh has an analytical expression which makes it very robust and easy to implement .",
    "therefore , it can be a useful filter in some practical cases .",
    "we have also explored how the previous results change when varying @xmath178 and @xmath41 . in particular , we have considered vaules of @xmath178 in the interval 0.01 - 0.05 , @xmath200 and @xmath186 and values of @xmath201 .",
    "the results are summarized in table  [ tab : tabla1_n ] for the bsaf and the standard mf ( we present only those cases where the bsaf improves at least a few per cent the standard mf ) .",
    "the values of @xmath126 and @xmath149 for the bsaf are found as the ones that maximise @xmath80 in each case .",
    ". number density of detections @xmath80 for the standard mf ( @xmath127 ) and the bsaf with optimal values of c and @xmath126 .",
    "rd means relative difference of number densities in percentage : @xmath202.[tab : tabla1_n ] [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     we have also explored how the results depend on the values of @xmath41 and @xmath79 . in table",
    "[ tab : tabla2_n ] , we show the number density of detections for the bsaf and for the standard mf ( @xmath127 ) for @xmath200 and @xmath186 , with @xmath178 ranging from 0.01 to 0.05 , and for values of @xmath203 ( we only include the results for those cases where the relative difference between the bsaf and standard mf is at least a few per cent ) .",
    "we also give the optimal values of @xmath149 and @xmath126 where the bsaf performs better ( taking into account the constraint @xmath204 ) . as for the previous case of the uniform distribution , the relative performance of the bsaf improves when increasing @xmath41 and @xmath79 .",
    "it is also interesting to consider other values of the parameter @xmath205 .",
    "for instance @xmath206 $ ] has an intrinsic interest for astronomy , because they describe the distribution of compact sources in the sky at microwave wavelengths .",
    "we have also explored the performance of the filters for these values ( for the reference case @xmath184 , @xmath197 , @xmath186 ) and the improvement of the bsaf ( with optimal values of @xmath191 and @xmath207 versus the standard mf is still significant and of the order @xmath208 .      to test the effect of the presence of bright sources on our results , we have also considered a scale - free distribution with @xmath209 \\sigma_0 $ ] ( i.e. , a mixture of weak and bright sources ) for @xmath175 .",
    "we find , for the reference case ( @xmath184 , @xmath197 , @xmath186 ) , that the bsaf improves the standard mf around a @xmath210 , with optimal parameters @xmath191 and @xmath211 .",
    "we would like to point out that for for a given set of @xmath179 , @xmath41 and @xmath178 , this distribution of weak and bright sources leads to very similar optimal parameters for the bsaf as the scale - free distribution of weak sources .",
    "in addition , we have also tested the performance of the filters for a scale - free distribution of bright sources with @xmath212 \\sigma_0 $ ] , for the same case as before ( @xmath184 , @xmath197 , @xmath186 ) .",
    "we explore the parameter space of @xmath213 , looking for the best filter regarding detection .",
    "we find that , for this distribution , the optimal parameters for the bsaf are @xmath158 and @xmath127 , that is , the bsaf defaults to the standard mf .",
    "the filters considered here depend on a number of parameters ( @xmath126 in the case of saf , mf and mh and @xmath126 and @xmath149 in the case of bsaf ) that must be determined in order to get the maximum number of detections for a fixed number of spurious detections . while for a given filter the region of acceptance is explicitly independent of the source distribution , the methodology presented here for the estimation of the optimal filter parameters depends on some assumed parameters of the source distribution ( namely @xmath205 , @xmath214 and @xmath215 ) and the noise power spectrum ( @xmath179 ) .",
    "a full study of the robustness of the method for all the filters is out of the scope of this work .",
    "however , we have considered some interesting cases as tests of the robustness of the method .      in order to ascertain to",
    "what extent the uncertainties in the @xmath205 parameter of the source distribution affects the determination of the optimal filter parameters , we repeated our calculations using wrong assumptions on its value .",
    "an interesting case corresponds to assume that the source distribution is uniform when , in reality , it is scale - free and vice versa . in order to do this ,",
    "we first construct the bsaf using the optimal @xmath216 values that were obtained for the uniform distribution .",
    "we calculate then the number density of sources @xmath80 obtained from a map that contains sources that follow a scale - free distribution with @xmath175 .",
    "we find that the differences in the number of detections when using the wrong filter with respect to using the optimal one are very small ( lower than @xmath217 ) .",
    "the same happens if the filter is constructed assuming an underlying scale - free distribution and applied to a map with sources uniformly distributed .",
    "this is not surprising , since tables  [ tab : tabla1_n ] and  [ tab : tabla2_n ] show that both uniform and scale - free distributions lead to similar values of the optimal @xmath126 and @xmath149 parameters .",
    "another source of uncertainty that appears in any real case is the value of the limiting cut - offs of the source distribution , @xmath214 and @xmath215 .",
    "we have seen in the previous subsections that for a given set of values @xmath79 , @xmath179 and @xmath41 , different cut - offs for the same distribution lead to similar optimal @xmath126 and @xmath149 parameters .",
    "for instance , in our reference example ( @xmath184 , @xmath197 , @xmath186 ) and a uniform distribution of sources with @xmath218 and @xmath219 the optimal filter parameters are @xmath191 and @xmath220 , whereas if the upper cut - off value is @xmath221 , the parameters take the values @xmath191 and @xmath222 .",
    "then , the shape of the optimal filter is only weakly dependent on the value of the cut - offs .",
    "this suggests that the methodology presented here is robust against uncertainties in the prior knowledge of the cut - offs of the distribution .    in order to test this idea we proceeded in an analogous way to the case of the @xmath205 parameter explained before",
    ": we apply wrong filters ( that is , filters whose parameters have been determined assuming wrong values of the cutoffs ) to test cases with real distributions of sources .",
    "we tested several interesting cases : for uniform distributions , we studied the case when the sources are assumed to be weak but in reality some of them are bright ( in our example , @xmath215 is assumed to be 2 but in reality its true value is @xmath221 ) and the opposite situation . for the scale - free distribution",
    ", we studied the effect of mistaking the lower cut - off value ( assuming @xmath223 instead of its true value @xmath224 and vice versa ) .",
    "for all the cases , we plotted the curves @xmath225 versus @xmath126 .",
    "we observe that using a wrong filter changes the number of detections of all the filters , but the qualitative behaviour of the @xmath225  @xmath126 curves does not change .",
    "the relative behaviour of the filters is basically the same , and therefore the conclusions we obtained in the previous sections are still valid .",
    "thus , we conclude that the uncertainty in the knowledge of the source distribution is , in general , not a critical issue in the cases we have considered .",
    "a more delicate issue is the one related to the assumption of the @xmath179 parameter .",
    "if one assumes a value for @xmath179 that is very different from the true one , the shape of the filters changes dramatically ( except in the case of the mh whose shape is independent of @xmath179 ) with respect to the optimal ones and this may lead to wrong results .",
    "however , note that there are very well established techniques to estimate the power spectrum .",
    "albeit in this academic case we consider power law - type backgrounds , it is straightforward to apply the method to any kind of power spectrum that can be present in the data .    as an example , we consider a case where the background corresponds to a true value @xmath226 whereas the filters have been constructed with a wrong @xmath227 , that is , a @xmath228 error in the determination of @xmath179 .",
    "the resulting @xmath229 curves are given in figure  [ fig : gamma_falsa ] .",
    "the behaviour of the bsaf , the mf and the saf is qualitatively similar to the case where the noise power spectrum is perfectly known , but the performance of the three filters is poorer .",
    "the mh curve is identical to the ideal case since the shape of the filter does not depend on @xmath179 .",
    "the bsaf still outperforms all the other filters , although the improvement in the number of detections with respect to the mf slightly decreases .",
    "in order to see how our theoretical framework works in a practical example , we run a large set of simulations and study the performance of the np detector after filtering them with the different filters considered in the previous sections .",
    "we choose as a practical example the interesting case of a gaussian background characterised by a white noise power spectrum ( @xmath179=0 ) and sources whose intensity distribution is uniform .",
    "we will focus on the detection of weak sources . for the sake of simplicity , we give the results only for the bsaf and the mf since the other two filters ( saf and mh ) perform worse in the considered case .",
    "the different simulations are performed as follows .",
    "the images contain a number @xmath230 pixels , which is sufficiently large so that the addition of a single source does not modify significantly the dispersion of the images .",
    "the background is generated as a random field with dispersion ( before filtering ) @xmath231 ( in arbitrary units ) .",
    "the sources that we have considered for this example have a characteristic scale @xmath186 pixels . since we are interested in the detection of weak sources , we add point sources with a uniform amplitude distribution in the interval @xmath232 $ ] in the same arbitrary units of the background .",
    "the images filtered with the standard mf ( @xmath127 ) for this scale ( @xmath186 ) have dispersion @xmath233 .",
    "thus , the sources are distributed in the interval @xmath234 $ ] , where @xmath235 is the normalized amplitude of the sources with respect to the dispersion of the field filtered with the standard mf .      for every maximum in a given image , it is possible to apply an empirical np criterion to decide whether the maximum corresponds or not to a source .",
    "the quantities in equations ( [ eq : r _ * ] ) and ( [ eq : phi ] ) can be obtained from simulations in the following way :      the momenta @xmath182 , @xmath236 and @xmath237 ( and , therefore , the quantities @xmath238 , @xmath115 needed to know the value of the linear detector @xmath75 ) can be straightforwardly calculated from the image . for every maximum in the image , it is possible as well to measure directly its amplitude @xmath51 and curvature @xmath14 .",
    "the normalized curvature is easily obtained by fourier transforming the image , multiplying by @xmath239 and going back to real space .",
    "this gives the value of @xmath240 at each point and @xmath14 is obtained dividing by @xmath237 .",
    "the critical value @xmath74 that defines the acceptance region using equation ( [ eq : r _ * ] ) can be obtained as well directly from the simulations . for each considered filter , it is in principle possible to calculate @xmath74 semi - empirically , inverting equation ( [ eq : nb * ] ) ( with the empirically obtained values of @xmath238 and @xmath115 ) just as we did in the previous sections , and hence to proceed with the np decision rule . instead ,",
    "since we are dealing with simulations , we will follow a fully empirical approach .",
    "the argument goes as follows .",
    "we fix the number density of spurious detections , i.e. , the number of maxima of the background that are misidentified as  sources \" by our detection criterion .",
    "then we simulate a set of images containing only background and filter them with the filter under study .",
    "we focus on the background maxima and try to determine the value of @xmath74 that makes the np rule to produce the specified number of spurious detections . for example",
    "let us consider that we perform @xmath241 noise realisations and focus on what happens in a certain pixel ( we choose the central pixel of the simulation in order to avoid border effects ) .",
    "for every realisation , we check if there is a maximum at this position or not .",
    "if a maximum is present , the value of @xmath75 is calculated .",
    "all the values of @xmath75 obtained in that way are sorted into descending numbers ( large to small ) .",
    "the value of @xmath74 is then given by the @xmath75 corresponding to the r - th element @xmath242 of the sorted list ( that is , @xmath74 is the value of @xmath75 so that there are @xmath243 background maxima with @xmath244 ) .",
    "for this example , we considered @xmath185 and therefore @xmath245 .",
    "once the value of @xmath74 has been empirically determined we add a source with a gaussian profile of dispersion @xmath246 pixels at the central position ( pixel @xmath247 ) of the unfiltered background image and then we filter it with the considered filter .",
    "we proceed to apply the detector to any maxima located at the pixel we are considering .",
    "finally , @xmath80 , for each of the filters , will be the number of sources with an estimated @xmath244 divided by the total number of realizations @xmath248 .",
    "we have performed numerical simulations for our reference case ( @xmath185 , @xmath186 and @xmath184 ) , assuming a uniform distribution with @xmath170 .",
    "we have compared the performance of the filters and the empirical np detector in the simulated images with the theoretical predictions as a function of the parameter @xmath126 .",
    "for each @xmath126 value and each filter , we have done five sets of simulations of the background , each one with a number of realizations large enough to have 5000 of them containing a maximum in the central pixel . ] .",
    "we used these simulations to obtain @xmath74 as explained before .    in the figure",
    "[ fig : numdet_sims_todo ] we present the results from the simulations for this case and the comparison with the theoretical calculations .",
    "the lines in this plot show the theoretical results for each filter , the triangles the result from the simulations for the bsaf and the squares the results for the mf .",
    "we concentrate on the bsaf , which corresponds to the dot - dash line . as we mentioned in previous sections ,",
    "the bsaf significantly improves the standard mf for @xmath184 .",
    "the simulations follow the theoretical results well . in the region",
    "where @xmath190 , there is a small deviation from theory which we believe is related to the fact that we are close to the scale of the pixel , but still , significantly close to the expected theoretical value .",
    "we can estimate the amplitude of a source using the unbiased and maximum efficient estimator from equation ( [ eq : estim_amplitude ] ) and then compare it with the amplitude that we have randomly generated . in figure",
    "[ fig : estim_ampli1 ] , we plot the real amplitude versus the estimated one for the bsaf ( top panels ) and the mf ( bottom panels ) .",
    "two amplitude regimes have been explored . in the left panels",
    ", we have simulated a uniform distribution of weak sources , @xmath181\\sigma_0 $ ] .",
    "the parameters used for these simulations are @xmath185 , @xmath184 and @xmath186 .",
    "the optimal filter parameters have been chosen at each case .",
    "the points and the error bars are calculated as the average and the dispersion of the detected sources that fall in each of the amplitude bins from a total of @xmath249 10000 detected sources .",
    "we find a similar positive bias in the determination of the amplitude for the bsaf ( @xmath250 , @xmath220 ) and mf ( @xmath250 ) .",
    "however , the error bars corresponding to the bsaf are slightly smaller than those of the mf .    in the right panels ,",
    "we give the results for a uniform distribution of sources with @xmath251\\sigma_{0}$ ] .",
    "the simulation parameters are the same as before ( @xmath185 , @xmath184 and @xmath186 ) .",
    "as before , the points and the error bars are calculated as the average and the dispersion of the detected sources that fall in each of the amplitude bins from a total of @xmath249 20000 detected sources .",
    "we find that the bsaf ( @xmath191 , @xmath222 ) is unbiased for bright sources whereas the estimation of the amplitude in the case of the standard mf ( @xmath127 ) shows some bias even for bright sources .",
    "therefore , the bsaf with @xmath191 outperforms the standard mf in both the detection and estimation for this distribution .",
    "the fact that sources with small amplitudes are significantly affected by a positive bias can be explained taking into account that these sources are more easily detected if they lie over a positive contribution of the background .",
    "this contributes systematically to the overestimation of the amplitude .",
    "we would like to point out that this estimator produces appreciably better results than a naive estimation using directly the measured values at the maxima .",
    "nowadays , the detection of compact sources on a background is a relevant problem in many fields of science .",
    "a number of detection techniques use linear filters and thresholding - based detectors .",
    "our approach to the problem of detector design is different .",
    "we use a neyman - pearson rule that takes into account _ a priori _ information of the distribution of sources and the number density of maxima to define the region of acceptance .    in our case , we take advantage not only of the amplification but also of the spatial information : the curvature of the background is different from that of the sources , and we use this to improve our detection rule",
    ".    the background is modelled by a homogeneous and isotropic gaussian random field , characterized by a scale - free power spectrum @xmath252 , @xmath253 .",
    "we design a new filter that we call bsaf in such a way that the use of our improved detection rule based on amplification and curvature on the filtered field will increase the number of detections for a fixed number of spurious sources .",
    "we generalize the functional form of this filter , as well as other standard filters , and introduce another degree of freedom , @xmath126 , that allows us to filter at any scale , including that of the source @xmath41 .",
    "we have shown the benefits of filtering at scales smaller than @xmath41 , which significantly improves the number of detections .",
    "as an example , we have considered two different distributions of sources . a uniform distribution in the interval @xmath234 $ ] and a scale - free power law distribution in the interval @xmath254 $ ] ( where the threshold @xmath38 corresponds to the field filtered with the standard mf ) , i.e. we are considering weak sources . the bsaf has proven to be significantly better than the standard mf , the saf and mh wavelet in certain cases . in particular , we have considered a reference case with parameters @xmath184 , @xmath197 and @xmath186 , where the improvement in the number of detections of the bsaf at @xmath191 with respect to the standard mf is @xmath255 .",
    "we have also tested the performance of the filters for a mixture of weak , intermediate and bright sources . for a uniform distribution with",
    "@xmath256 $ ] and for a scale - free distribution with @xmath257 $ ] , the bsaf also improves the mf .",
    "however , for a scale - free distribution with @xmath258 $ ] , i.e. , dominated by bright sources , we find that the optimal bsaf defaults to the standard mf , which gives the maximum number of detections in this case .",
    "we find that the bsaf gives in any case the best performance among the considered filters . indeed ,",
    "the saf and the mf are particular cases of the bsaf and the strategy we follow , i.e. maximization of the detections , guarantees that the parameters of the bsaf will default to the best possible of these filters in each case .",
    "in addition , we also find that the bsaf performs at least as well as the mh in all the considered cases .",
    "therefore , the number density of detections obtained with the bsaf will be at least equal to the best of the other three filters , and in certain cases superior .",
    "however , in some other cases , the gain is small and it is justified to use an analitically simpler filter .",
    "our results suggest that for power law spectra , from the practical point of view , one could use the bsaf when @xmath259 since , in this range , clearly improves the number of detections with respect to the other filters .",
    "however , for @xmath260 the usage of the mh is justified due to its robustness ( since it has an analytical form ) and it gives approximately the same number of detections obtained either with the bsaf or mf .",
    "for all the studied cases of source distributions ( except for the one dominated by bright sources ) and fixing the values of @xmath179 , @xmath79 and @xmath41 , we find that the optimal parameters of the bsaf are only weakly dependent on the distribution of the sources .",
    "we have done some simple tests in order to study the robustness of the method when the knowledge about the source _ pdf _ or the background spectral index is not perfect . we find that the values of the optimal filter parameters vary slightly when we assume that the source distribution is uniform when , in reality , it is scale - free and vice versa .",
    "the uncertainties in the cut - off values of the source _ pdf _ affect the number of detections , but in a similar way for all the filters , and therefore the relative behaviour of the filters do not change .",
    "errors in the estimation of the spectral index @xmath179 reduces the efectiveness of the bsaf , but it still outperforms the other filters .",
    "all of this indicates that our detection scheme is robust against uncertainties in the knowledge of the distribution of the sources and spectral index .    to test the validity of our results in a practical example , we have tested our ideas with simulations for the uniform distribution ( using our reference case @xmath197 , @xmath186 , @xmath184 ) and find that the results follow approximately the expected theoretical values",
    "regarding source estimation , we propose a linear estimator which is unbiased and of maximum efficiency , that we have also tested with simulations .",
    "the ideas presented in this paper can be generalized : application to other profiles ( e.g. multiquadrics , exponential ) and non - gaussian backgrounds is physically and astronomically interesting .",
    "the extension to include several images ( multi - frequency ) is relevant .",
    "the generalization to two - dimensional data sets ( flat maps and the sphere ) and nd images is also very interesting .",
    "finally the application of our method to other fields is without any doubt .",
    "we are currently doing research in some of these topics .",
    "the authors thank enrique martnez - gonzlez and patricio vielva for useful discussions .",
    "mlc thanks the ministerio de ciencia y tecnologa ( mcyt ) for a predoctoral fpi fellowship .",
    "rbb thanks the mcyt and the universidad de cantabria for a ramn y cajal contract .",
    "dh acknowledges support from the european community s human potential programme under contract hprn - ct-2000 - 00124 , cmbnet .",
    "we acknowledge partial support from the spanish mcyt project esp2002 - 04141-c03 - 01 and from the eu research training network ` cosmic microwave background in europe for theory and data analysis ' .",
    "de zotti , g. , toffolatti , l. , argeso , f. , davies , r.d . , mazzotta , p. , partridge , r.b .",
    ", smoot g.f . &",
    "vittorio , n. , 1999 , 3k cosmology , proceedings of the ec - tmr conference held in rome , italy , october , 1998 .",
    "woodbury , n.y .",
    ": american institute of physics , vol .",
    "476 , 204 .                                the ratio @xmath261 can be explicitly written as @xmath262 and taking into account the np criterion for detection , we find @xmath263 where @xmath12 is a constant . by differentiating the previous equation with respect to @xmath75 @xmath264 therefore , @xmath265 is equivalent to @xmath244 , where @xmath74 is a constant , i.e. @xmath133 given by equation ( [ eq : phi ] ) is a sufficient linear detector .",
    "let us assume a linear estimator combination of the normalized amplitude @xmath38 and normalized curvature @xmath14 with the constraint @xmath266 if the estimator is unbiased , i.e. @xmath267 , taking into account that @xmath268 and @xmath269 , we obtain the constraint @xmath270 on the other hand , the variance is given by @xmath271 where we have taken into account that @xmath272 . by minimizing the previous expression with the constraint ( [ eq : constraint_appc ] ) , one obtains @xmath273 therefore , one obtains : @xmath274 @xmath275"
  ],
  "abstract_text": [
    "<S> this paper considers the problem of compact source detection on a gaussian background . </S>",
    "<S> we make a one - dimensional treatment ( though a generalization to two or more dimensions is possible ) . </S>",
    "<S> two relevant aspects of this problem are considered : the design of the detector and the filtering of the data . </S>",
    "<S> our detection scheme is based on local maxima and it takes into account not only the amplitude but also the curvature of the maxima . </S>",
    "<S> a neyman - pearson test is used to define the region of acceptance , that is given by a sufficient linear detector that is independent on the amplitude distribution of the sources . </S>",
    "<S> we study how detection can be enhanced by means of linear filters with a scaling parameter and compare some of them that have been proposed in the literature ( the mexican hat wavelet , the matched and the scale - adaptive filters ) . </S>",
    "<S> we introduce a new filter , that depends on two free parameters ( biparametric scale - adaptive filter ) . </S>",
    "<S> the value of these two parameters can be determined , given the a priori _ pdf _ of the amplitudes of the sources , such that the filter optimizes the performance of the detector in the sense that it gives the maximum number of real detections once fixed the number density of spurious sources . </S>",
    "<S> the new filter includes as particular cases the standard matched filter and the scale - adaptive filter . </S>",
    "<S> then , by construction , the biparametric scale adaptive filter outperforms these filters . the combination of a detection scheme that includes information on the curvature and a flexible filter that incorporates two free parameters ( one of them a scaling ) improves significantly the number of detections in some interesting cases . in particular , for the case of weak sources embedded in white noise the improvement with respect to the standard </S>",
    "<S> matched filter is of the order of @xmath0 . </S>",
    "<S> finally , an estimation of the amplitude of the source ( most probable value ) is introduced and it is proven that such an estimator is unbiased and it has maximum efficiency . we perform numerical simulations to test these theoretical ideas in a practical example and conclude that the results of the simulations agree with the analytical ones .    </S>",
    "<S> methods : analytical - methods : data analysis - techniques : image processing </S>"
  ]
}