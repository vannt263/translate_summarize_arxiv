{
  "article_text": [
    "in this paper we consider the following problem . given a qubit initially either in the ground or excited state with finite lifetime @xmath3 , how can we best make use of a continuous - in - time noisy quantum non - demolition ( qnd ) measurement to optimally estimate the _ initial _ state ( ground or excited ) of the qubit ?",
    "a number of authors have previously considered the related problem of optimal estimation of the _ present _ state of the qubit based on the past and current measurement record @xcite , but , to the best of our knowledge , the problem we consider here has not been previously studied .",
    "qnd measurements play a central role in the theory and practical implementation of quantum measurements @xcite . in a qnd measurement , the interaction term in the hamiltonian coupling the system to the measuring apparatus commutes with the quantity being measured , so that this quantity is a constant of the motion .",
    "this does _ not _ imply that the quantum state of the system is totally unaffected , but it does imply that the measurement is _",
    "repeatable_. for example , a stern - gerlach measurement of @xmath5 for a spin 1/2 particle initially prepared in an eigenstate of @xmath6 will randomly yield the results @xmath7 and @xmath8 with equal probability .",
    "however , all subsequent measurements of @xmath5 will yield exactly the same result as the initial measurement .",
    "the fact that qnd measurements are repeatable is of fundamental practical importance in overcoming detector inefficiencies .",
    "a prototypical example is the electron - shelving technique @xcite used to measure trapped ions .",
    "a related technique is used in present implementations of ion - trap based quantum computation . here the ( extremely long - lived ) hyperfine state of an ion is read out via state - dependent optical fluorescence . with properly chosen circular polarization of the exciting laser ,",
    "only one hyperfine state fluoresces and the transition is cycling ; that is , after fluorescence the ion almost always returns to the same state it was in prior to absorbing the exciting photon .",
    "hence the measurement is qnd .",
    "typical experimental parameters @xcite allow the cycling transition to produce @xmath9 fluorescence photons . given the photomultiplier quantum efficiency and typically small solid angle coverage , only a very small number @xmath10 will be detected on average .",
    "the probability of getting zero detections ( ignoring dark counts for simplicity ) and hence misidentifying the hyperfine state is @xmath11 . even for a very poor overall detection efficiency of only @xmath12",
    ", we still have @xmath13 and nearly perfect fidelity @xmath14 .",
    "it is important to note that the total time available for measurement is not limited by the phase coherence time ( @xmath15 ) of the qubit or by the measurement - induced dephasing  @xcite , but rather only by the rate at which the qubit makes real transitions between measurement ( @xmath5 ) eigenstates . in a perfect qnd measurement",
    "there is no measurement - induced state mixing @xcite and the relaxation rate @xmath1 is unaffected by the measurement process .",
    "the ability to read out a qubit with high fidelity is of central importance to the successful construction of a quantum computer @xcite . in order to successfully measure a qubit",
    ", its quantum state must be mapped into a piece of classical information by measuring the relative occupation of its two states with the highest possible fidelity .",
    "possible qubit implementations include superconducting circuits , silicon based electron and nuclear spins , and trapped ions , among others  @xcite . in order for qubits prepared in different states to be distinguishable ,",
    "the measurement must be completed before the excited qubits decay@xcite .",
    "many atomic qubits have sufficiently long lifetimes so that relaxation is not a major concern  @xcite , but most solid state qubits have lifetimes on the order of microseconds or less , and spontaneous relaxation plays a significant role in the measurement .",
    "the qubit relaxation affects different measurement schemes differently , but in all cases , it can limit the maximum fidelity .",
    "although the behavior of a qubit during continuous measurement has been studied using monte carlo simulations  @xcite , no attempt has been made to derive an analytical expression for the probability distribution of the _ initial _ state or to study how spontaneous emission impacts the measurement fidelity .",
    "this is at least partially because there exist very few high fidelity continuous qnd measurements , and even fewer that operate in a regime where qubit relaxation is a limiting factor .",
    "with the application of low temperature amplifiers , high fidelity ( though not necessarily weak continuous ) measurements of superconducting qubits are now becoming feasible  @xcite .",
    "these measurements have found asymmetries between the probability distributions for the integrated signal corresponding to the ground and excited states , but could not accurately predict them .    here",
    "we find that when we use a measurement protocol that only records the integrated signal , the qubit relaxation induces asymmetry in the probability distributions , and that with a sufficiently precise detector , the distributions become distinctly non - gaussian . unlike measurement of a perfect ( i.e. , non - decaying ) qubit , where fidelity is always improved by a longer measurement , we show that there is some optimal measurement fidelity that depends on the signal to noise ratio ( snr ) of the detector and the filter used .",
    "the first filter we consider is the linear box car filter and optimize over the integrated time @xmath16 . choosing a longer or shorter integration time will lower the fidelity of the measurement .",
    "next we show that by choosing a filter that gives exponentially less importance to results at later times slightly increases the fidelity .",
    "we then numerically find the optimal linear filter and compare these linear filters to a non - linear filter that yields the theoretically optimal estimate of the initial state of the qubit given some measurement record @xmath0 .",
    "we find that we can reach the same fidelity as the linear filters at a substantially lower snr .",
    "furthermore , due to the nature of the updating protocol , the fidelity is a non - decreasing function of the measurement time . in summary , in this paper we determine the optimal measurement fidelity given four measurement protocols for continuous measurement experiments currently being performed , and also provides a guideline for the necessary detector signal to noise ratio in order to reach a particular desired fidelity in future experiments .",
    "there are two major ways of measuring qubits .",
    "the first method is a latching measurement , for example by having the qubit state modify the switching current ( or state ) of an adjacent josephson junction  @xcite or the bifurcation point of the non - linear josephson plasma oscillation @xcite . in such latching measurements ,",
    "the qubit is measured very quickly with very high signal to noise , and after only a short waiting time  @xcite .",
    "some versions of such strong measurements can in principle be qnd @xcite .",
    "the second method is to perform a sequence of repeated or weak continuous quantum non - demolition ( qnd ) measurements , which each leave the populations of the qubit unchanged .",
    "several recent experiments with solid - state qubits @xcite , have used continuous qnd measurement schemes in which the qubit lifetime imposes the main limitation on the measurement fidelity , for which the analysis of this paper should apply .",
    "it is not just continuous measurements that are affected by qubit relaxation .",
    "for example , consider an idealized latching measurement scheme where a qubit is prepared in an eigenstate , but there is some finite arming time @xmath17 before a perfect measurement is made . in this case , a qubit prepared in the ground state will always be measured correctly , but a qubit prepared in the excited state may have decayed during @xmath17 and be misidentified .",
    "thus if @xmath18 is not infinitesimally small , the qubit lifetime places a limit on fidelity even with a perfect detector .",
    "it is worthwhile to first consider the case when the qubit can not relax from the state it is initially prepared in , so it is `` fixed '' for all time .",
    "this allows us to formalize our intuitive understanding of a general continuous measurement and to give us a result against which we can compare the finite lifetime case .",
    "we consider the measurement of a qubit with two states @xmath19 ( excited ) and @xmath20 ( ground ) and assume that the measurement result is given by the actual value of the qubit state plus gaussian noise .",
    "this assumption is justified for example in the current circuit quantum electrodynamic experiments @xcite in which a cavity is dispersively coupled to the qubit ( no energy is exchanged between the cavity and the qubit ) .",
    "a homodyne measurement on the cavity output will reveal the cavity state ( which is proportional to @xmath5 ) plus gaussian noise @xcite .",
    "this gaussian noise will be at least the photon shot noise but in present experiments it is dominated by the following amplifier .",
    "in other words , the measurement is faithful and given that the system is in state @xmath21 our detector for a time interval @xmath22 outputs @xmath23 with statistics @xmath24.\\ ] ] for convenience we have also introduced a dimensionless time @xmath25 where @xmath3 is an arbitrary but finite number , that will become the relaxation lifetime when we treat the finite lifetime case . here",
    "snr is the ratio of integrated signal power to noise power .",
    "it is linear in the integration time and we will adopt the convention of specifying the snr as that achieved after integrating for time @xmath3",
    ". from this distribution we can write @xmath26 in terms of the wiener increment @xmath27 @xcite as @xmath28 here we have introduced the subscript @xmath29 to indicate a possible realization of the dynamics of the qubit given the initial condition @xmath30 . for this case the qubit can be initialized in either state , but because it has an infinite lifetime , it is fixed in whatever state it starts in for the duration of the measurement .",
    "that is , @xmath31 .",
    "we define our measurement signal @xmath32 as the output of the detector integrated over time @xmath33 @xmath34 formally we are restricting ourselves here to a simple box car linear filter which uniformly weights the measurement record @xmath26 in the interval @xmath35 . using eq .",
    "( [ psific ] ) it is simple to carry out the above integral and rewrite the measurement signal as @xmath36 $ ] where @xmath37 $ ] is a gaussian random variable of mean 0 and standard deviation @xmath38 .",
    "the signals then follow the familiar gaussian distributions @xmath39 because these distributions are symmetric about @xmath40 , the most obvious analysis is to set a signal threshold @xmath41 and call every measurement with @xmath42 a ( @xmath7 ) state , and every measurement with @xmath43 a ( @xmath8 ) state .",
    "calculation of fidelity in this case is accomplished using the definition    @xmath44    for the case of infinite qubit lifetime we have the simple result @xmath45    a fidelity of zero corresponds to a completely random measurement that extracts no information , a fidelity of one corresponds to a perfect faithful measurement , and in between the measurement conveys varying degrees of certainty . as @xmath33 becomes large , eq .",
    "( [ eq : fidelity ] ) predicts that the fidelity rapidly approaches unity .",
    "higher snr serves to speed up the convergence , but as long as snr is non zero , any desired fidelity is attainable simply by measuring the qubit for long enough . in table",
    "[ tab : fidelity ] , the required @xmath46 is listed in order to achieve a given fidelity within @xmath3 .",
    "note the same results for the fidelity would be obtained if we used the optimal non - linear filter of sec .",
    "[ sec : nl ] .",
    "that is , for a qubit with infinite lifetime the simple box car filter is equivalent to the optimal non - linear filter , it is only when we include relaxation this is not the case .",
    "this will be discussed in detail in the next four sections .",
    "( color online ) example detector output as a function of time for a continuous qnd measurement with snr = 570 , ( @xmath47 ) which allows for a measurement fidelity of 99% .",
    "the dashed red line corresponds to a large ensemble average of qubit outputs , and decays exponentially with characteristic time @xmath3 .",
    "the solid blue line corresponds to the measurement record for a particular single shot . at this value of snr ,",
    "the jump in output is clearly visible and occurs at @xmath48 . , scaledwidth=45.0% ]    here we consider the same measurement protocol as in sec .",
    "[ sec : classical ] , however unlike a qubit with infinite lifetime , where both states behave similarly , a qubit with a finite lifetime has a fundamental asymmetry in how the excited and ground states behave .",
    "we assume ( in our model ) that the excited state decays at rate @xmath1 but the transition rate upward out of the ground state is zero .",
    "a qubit prepared in the ground state will never experience any excitations , so it can be treated much the same as the fixed qubit discussed above and hence @xmath49 .",
    "by contrast , an initially excited qubit will produce an ensemble averaged output which will decay exponentially with characteristic dimensionless time @xmath50 .",
    "although most qubits dephase in some shorter dimensionless time @xmath51 , our only concern here is the relative population of the two qubit states , so we are not limited by decoherence of the qubit . for a single qubit",
    ", this translates into a single , abrupt relaxation of the qubit at some dimensionless time @xmath48 that is exponentially distributed with mean dimensionless time 1 , @xmath52 .",
    "that is , if the qubit was initially in the excited state then @xmath53 would obey @xmath54 thus given a possible realization @xmath53 , we can generate a typical record an experimentalist would measure by using eq .",
    "( [ psific ] ) . a typical trajectory for @xmath26",
    "is shown in fig .",
    "[ fig : spontemission ] for a @xmath55 of @xmath56 . here",
    "we see , at this value of snr , the jump in output is clearly visible and occurs at @xmath57 ( @xmath58 ) .    in the case where the qubit happens to decay early ,",
    "@xmath59 , the signal @xmath32 from a qubit initially prepared in the excited state would be almost indistinguishable from that of a qubit initially prepared in the ground state , and even if the measurement apparatus were nearly perfect , almost no information could be extracted .",
    "the probability distribution @xmath60 for the measurement signal of an initially excited qubit can be determined analytically with a simple derivation .",
    "this will allow a more quantitative discussion of fidelity , and will eventually allow for optimization of integration time , @xmath61 .",
    "the critical difference between the infinite lifetime system described in sec .",
    "[ sec : classical ] and an actual qnd measurement is that @xmath32 is now a function not only of the dimensionless integration time @xmath33 , but also the exponentially distributed random relaxation time @xmath48 .",
    "if the qubit is initially in the excited state , then from eqs .",
    "( [ psific ] ) , ( [ eq : flat ] ) , and ( [ if_excited ] ) a possible realization of @xmath62 will be @xmath63 .",
    "\\end{aligned}\\ ] ] that is , the probability distribution for @xmath32 given a realization with a decay at time @xmath64 is @xmath65 \\theta(\\tau _ { \\rm{d } } -\\tau_{\\rm f } )      { { \\nonumber}\\\\ & & } + \\frac{1}{\\sqrt{2 \\pi}\\sigma } \\exp\\{-[s- ( 2\\tau _ { \\rm{d } } -              \\tau_{\\rm f } ) ] ^2/ 2\\sigma^2\\ } { { \\nonumber}\\\\ & & } \\times\\theta(\\tau_{\\rm f } -                  \\tau _ { \\rm{d } } ) ,              \\end{aligned}\\ ] ] and from this one can easily obtain the probability distributions for @xmath32 by averaging over all possible realizations ( decay times ) .",
    "doing this gives @xmath66    although it does not figure directly into this analysis , it is not difficult to expand this treatment to consider a measurement with finite  demolition \" that stimulates both excitation and relaxation of the qubit . in this case",
    ", both @xmath67 and @xmath68 will be non - gaussian , because the qubit may excite and relax several times during the measurement interval . to calculate the distributions ,",
    "all we need to do is extend the possible realization to include multiple relaxations and excitations keeping in mind that the relaxation and excitation times are not independent variables : @xmath69 must occur before @xmath70 . for stronger or less ideal measurements",
    ", it may become necessary to include these extra terms , but for now the demolition is taken to be small compared to the spontaneous relaxation and can be ignored .",
    "( color online ) evolution in time of probability distributions for qnd measurement of qubits initialized in the ground ( blue ) and excited ( red ) states for the box car linear filter and a @xmath71 . for short @xmath33 ,",
    "the distributions are almost symmetrical because an excited qubit has probably not decayed yet . as @xmath33 gets longer",
    ", the qubit is much more likely to have decayed , and the mean of @xmath60 begins to drift back towards that of @xmath72 . at some optimal point in between , @xmath73 , and if the threshold @xmath74 is chosen so that @xmath75 , the misidentified tails are minimized , and fidelity is maximized . ]",
    "the gaussian first term in eq .",
    "( [ eq : probdist ] ) is dominant for @xmath76 , and @xmath60 is nearly symmetrical to @xmath72 . for these fast measurements ,",
    "there is little chance that the qubit decays during the measurement , and the distributions will be very similar to those of fixed state bits . at some point , the probability that the qubit has relaxed will be large enough that it significantly affects the distributions . at this point , predictions based on the assumption of no relaxation are no longer valid , and the non - gaussian term in eq .",
    "( [ eq : probdist ] ) becomes very important .",
    "this effect can be seen in the non - gaussian tail of @xmath60 in the second two time cuts in fig .",
    "[ fig : highnevo ] .    a strongly non - gaussian @xmath67 distribution",
    "is not required for the fidelity to exhibit a maximum at some finite measurement time .",
    "even though for experiments with @xmath77 , the non - gaussian tail of @xmath67 is not very prominent , the asymmetry between the distributions in both height and width is quite clear . for long enough dimensionless integration times",
    ", a qubit initially in the excited state will have probably relaxed relatively early in the measurement , so its mean should be very similar to that of a qubit initially in the ground state , the distributions will be almost identical , and all resolving power will be lost .",
    "the behavior of fidelity as a function of integration time for a qnd qubit measurement is very different from a measurement of a fixed state qubit that never relaxes .",
    "recall that in the fixed state case , the fidelity eventually converges to one , independent of snr .",
    "we define fidelity as we did for the fixed state case in eq .",
    "( [ eq : fidelity ] ) .",
    "the difference here is that because the distributions are not necessarily symmetrical , the signal threshold @xmath74 is not always zero .",
    "maximizing @xmath78 with respect to @xmath79 yields the following implicit equation for @xmath79 @xmath80 as an aside we note that from this we see that we can write the fidelity ( optimized with respect to @xmath79 ) in the alternative form @xmath81 despite the complications of finite lifetime , the integrations in eq .",
    "( [ eq : fidelity ] ) can still be carried out analytically to yield @xmath82 the fidelity is maximized by numerically solving for @xmath74 such that @xmath83 . using the correct value of @xmath84 , it is straightforward to compute @xmath85 and then vary @xmath33 to obtain the optimal value of the integration time .",
    "( color online ) a ) the fidelity @xmath78 as a function of time @xmath61 for all measurement protocols .",
    "the box car filtered integrated signal is the red ( solid ) line and the exponential filtered integrated signal is the blue ( dashed ) line .",
    "here we see that both these schemes have an optimal measurement time and that the latter case is less sensitive to the measurement time .",
    "the non - linear filter is shown by the green ( dashed - dotted ) line . here",
    "we see that it is clearly better than the other cases and that there is no optimal measurement time .",
    "b ) the threshold @xmath79 as a function of time @xmath61 for both the box car filtered integrated signal ( red solid line ) and the exponential filtered integrated signal ( blue dashed line ) . in both subplots",
    "the snr after time @xmath86 is 10 and time is measured in units of @xmath3 .",
    ", scaledwidth=45.0% ]    roughly speaking , fidelity is a measure of how separate the probability distributions are , ranging between 0 for complete overlap and 1 for no overlap .",
    "fidelity is limited by detector noise for short times and spontaneous relaxation for long times . for @xmath76 ,",
    "the probability of a relaxation during the measurement is very low , and the fidelity behaves similarly to the fixed state case : it increases with increasing @xmath33 . for longer @xmath87 ,",
    "the qubit is more and more likely to have relaxed during the measurement and the mean of @xmath60 will stop increasing linearly and in the long time limit will actually decrease in time as can be inferred from the decrease in optimal threshold value plotted in fig .",
    "[ fig : timefidelity ] b ) ( red solid line ) .",
    "this implies the existence of some intermediate time @xmath88 that maximizes the fidelity , this is clearly seen in the red solid line of fig .",
    "[ fig : timefidelity ] a ) where the fidelity for a snr@xmath89 has a maximum of @xmath90 at @xmath91 .    to find this time for a given value of snr , we compute @xmath85",
    ", then numerically solve @xmath92 for @xmath93 .",
    "the solution , @xmath94 is the best possible fidelity for the simple linear box car filter ; no improvement can be made from this value without improving the measurement apparatus or the qubit lifetime . this optimal fidelity is only achievable by correctly setting @xmath73 and @xmath74 .",
    "any variation of these parameters will reduce the fidelity . it should be pointed out that while the condition @xmath95 does maximize the fidelity , it implies that the measurement protocol is biased towards the ground state .",
    "that is , if the qubit is prepared in the ground state we are more likely to assign it correctly than if it was prepared in the excited state .",
    "an unbiased measurement protocol is obtained by setting @xmath79 such that @xmath96 . doing this results in a slightly lower optimal fidelity .",
    "( color online ) a ) optimal fidelity @xmath97 and b ) measurement time @xmath98 as functions of snr .",
    "the inset in plot b shows the optimal fidelity as a function of the measurement time .",
    "the red ( solid ) line is for the box car filter , blue ( dashed ) is for the exponential filter , black ( dotted ) is for the optimal linear filter , and the green ( dashed - dotted ) is for the non - linear filter .",
    "here we see that by using the optimal non - linear filter we get an improved fidelity in comparison to the simple linear filters .",
    "particular values are shown in table  [ tab : fidelity ] .",
    ", scaledwidth=45.0% ]    since @xmath97 depends only on snr , it is possible to first derive the required signal to noise ratio after one lifetime , and then choose the correct measurement time and signal threshold required in order to attain any arbitrary fidelity as shown in fig .",
    "[ fig : snrfidelity ] ( red solid line in part a ) along with the optimal measurement time ( red solid line in part b ) . for example , one standard initial goal is a fidelity of 90% , sufficient to violate bell s inequalities  @xcite .",
    "as shown in table [ tab : fidelity ] , this fidelity requires a minimum snr of 30 after time @xmath3 .    [ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     the following argument shows how rapidly the required snr diverges for very high values of fidelity . for large snr , it is a good approximation to set the threshold @xmath99 and then the fidelity is approximately @xmath100 optimizing this with respect to @xmath61 and then using the asymptotic form for the error function of large argument yields the following expression for the optimal integration time @xmath101 where @xmath102 .    approximating the error function in eq .",
    "( [ eq : f0 ] ) by unity and neglecting @xmath103 relative to @xmath104 leads to the following simple asymptotic form for large snr @xmath105 this can be rewritten as in terms of the optimal measurement time as @xmath106 . here",
    "we see that to achieve the optimal , the measurement must be completed in a time that decreases linearly with the desired fidelity .",
    "the slight deviations form this zeroth order result is shown in the inset of fig .",
    "[ fig : snrfidelity ] b. this result is consistent with the intuitive picture that to achieve a fidelity @xmath107 with @xmath108 , we must have sufficient snr to be fooled only by those extremely early decays which occur in time @xmath109 .",
    "this set of decays occurs with probability @xmath110 and is the main source of the infidelity .",
    "in this section we consider the case when we include an exponential weighting factor in our integrated signal @xmath32 .",
    "this is chosen as this would be the optimal linear filter if our signal was simply a decaying exponential with a random initial amplitude , this can be proven by minimizing our estimate of the amplitude in a least square sense . however , even though our signal on average is of this form , in one particular run it is not .",
    "thus this will not be the optimal linear filter for estimating the initial state of the qubit .",
    "for this reason we introduce an integration time @xmath61 and optimize the measurement fidelity over this .",
    "that is , the signal @xmath32 for this filter is given by , @xmath111 as in the last section we first determine a possible @xmath32 given that the qubit started in the excited state .",
    "doing this gives @xmath112}e ^{-\\tau}{{\\nonumber}\\\\ & & } + \\sqrt{{\\rm snr}^{-1}}\\int_0^{\\tau_{\\rm f } } dw(\\tau ) ~e ^{- \\tau}\\end{aligned}\\ ] ] and by treating the noise integral as simply a linear combination of infinitesimal gaussian variables gives @xmath113}\\theta(\\tau_{\\rm f } - \\tau_{\\rm d } ) { { \\nonumber}\\\\ & & } + a~\\theta(\\tau_{\\rm d}-\\tau_{\\rm f})+   x_\\mathrm{g}[0 , \\sigma^2],\\end{aligned}\\ ] ] where @xmath114 and @xmath115 .",
    "here we see that unlike before as the measurement time becomes large the variance saturates at @xmath116 rather then continuing to increase linearly with time .",
    "that is , we have designed our filter such that when all the information about the qubit state has been lost into the @xmath3 environment the noise in the integrated signal will remain constant .",
    "following the same procedure as before the excited state distribution is @xmath117}{{\\nonumber}\\\\ & & } + \\frac{1}{\\sqrt{2 \\pi } \\sigma } \\exp\\left[{{-\\frac {   \\left(s - a\\right)^2}{2\\sigma^2}-\\tau_{\\rm f } } } \\right].\\end{aligned}\\ ] ] repeating the above for the ground state initial condition gives @xmath118 $ ] and a ground state distribution of the form @xmath119}.\\end{aligned}\\ ] ] with the above two distributions the fidelity , as before , can be solved analytically and in terms of the @xmath79 is    @xmath120-\\exp\\left[{-\\frac{(a+\\nu_{\\rm th }   ) ^2}{2 \\sigma^2}}\\right]\\right)+\\frac{(e^{-\\tau_{\\rm f } } + 1-\\nu_{\\rm th } ) } { 4 }     \\left[\\text{erf}\\left(\\frac{a-\\nu_{\\rm th } } { \\sqrt{2}\\sigma}\\right)+\\text{erf}\\left (   \\frac{a+\\nu_{\\rm th}}{\\sqrt{2}\\sigma } \\right)\\right ] .",
    "\\end{aligned}\\ ] ]    using the same procedure as before we can numerically determine the @xmath79 which maximizes the fidelity . for a snr of 10 ( in time @xmath3 )",
    "the fidelity as a function of measurement time is shown in fig .",
    "[ fig : timefidelity ] a ) as a blue dashed line . here",
    "we see as before there is an optimal measurement time . to measure any longer than this time results in a lower fidelity .",
    "the optimal fidelity and measurement time are shown in fig .",
    "[ fig : snrfidelity ] ( blue dashed line ) as a function of the snr .",
    "here we see that by using this filter , the fidelity is slightly better than the simplest case ( see table  [ tab : fidelity ] for some values ) , but more importantly the curvature of the fidelity at @xmath121 is less .",
    "this means that this filter is less sensitive to errors in the measurement time .",
    "that is , this protocol would be more practical to implement than the simple box car integrated signal of sec . [",
    "sec : flat ] .",
    "in this section we calculate the optimal linear filter for estimating the initial state of the qubit . we define the linear signal @xmath32 by the relation @xmath122 where the kernel @xmath123 is unknown and is determined by maximizing the measurement fidelity .",
    "this , as before , is defined as the difference between the probability of us making a correct assignment and an incorrect assignment [ eq .  ( [ eq : fidelity ] ) ] .",
    "the assignment criteria we use is again if @xmath32 is above @xmath79 then we say the qubit was initially up and if it is below @xmath79 then it was down . @xmath79",
    "like @xmath123 is determined by the maximization procedure which we will describe now .    for an unknown kernel",
    "the signal conditioned on the qubit being initially up will be given by @xmath124,\\ ] ] where @xmath125 if the qubit was initially in the ground state then the signal would be @xmath126.\\ ] ] > from the above equations the excited state and ground state probability distribution for the signal @xmath32 are @xmath127}{\\sqrt{2 \\pi \\sigma^2}}d\\tau_{\\rm d } , { { \\nonumber}\\\\ & & } \\\\ p_-(s ) & = & \\frac { \\exp[-(s+a(\\infty ) ) ^2/2\\sigma^2]}{\\sqrt{2 \\pi \\sigma^2}}\\end{aligned}\\ ] ] and by using eq .",
    "( [ eq : fidelity ] ) the fidelity is @xmath128 maximizing this gives the following set of coupled differential equations @xmath129/\\sigma^2\\},{{\\nonumber}\\\\ & & } \\end{aligned}\\ ] ] with the initial conditions @xmath130 , @xmath131 , and the boundary condition @xmath132 .",
    "it is this latter condition which determines @xmath79 .",
    "this system of equations can be solved numerically using a shooting method @xcite .",
    "the results are shown in fig .",
    "[ fig : kopt ] for a snr of @xmath133 and @xmath134 . here",
    "we see that for the small @xmath135 , the kernel @xmath136 can be approximated well by @xmath137 where @xmath138 is a fit parameter that is approximately equal to @xmath139 . in the large @xmath135 limit",
    "the @xmath136 can not be fit by an exponential . for illustrative purposes the optimal linear filter",
    "is compared with the optimal box car linear filter in fig [ fig : kopt ] b ) for a snr of 172 . here",
    "we see that the time when the box car linear filter turns off , is comparable with the time scale of the optimal linear filter .",
    "( color online ) the optimal linear filter for a snr of @xmath133 blue ( dashed ) and snr of @xmath134 red ( solid ) as a function of time .",
    "the green ( dashed - dotted ) line in part b ) is the optimal box car linear filter for a snr of 172 ( @xmath140 ) .",
    ", scaledwidth=45.0% ]    numerically solving for @xmath136 for a given @xmath141 we can use eqs .",
    "( [ optsigma ] ) and ( [ optfid ] ) to plot the fidelity of the optimal linear filter as a function of the snr .",
    "this is shown in fig .",
    "[ fig : snrfidelity ] as a dotted black line and in table [ tab : fidelity ] as column 4 . here",
    "we see that the optimal linear filter out performs the other linear filters and is almost as good as the optimal filter ( which is non - linear ) and is described in the next section .",
    "in the previous sections we considered only the case where one looks at or only has access to the integrated signal , @xmath142 . here",
    "we assume that we have access to the full record @xmath143 and ask how much better can we do with a non - linear filter . in particular , given this record what is our best guess at the initial state of the qubit .",
    "mathematically , our best guess can be represented by the probability distribution @xmath144 .",
    "this is the probability that the initial condition @xmath145 is @xmath30 given the record , @xmath0 .",
    "as with all probability distributions , this will range from 0 to 1 , and the closer it is to one the more we are certain that the qubit was in the initial state @xmath146 .",
    "this by definition is the optimal protocol as it is the best estimate of @xmath145 given the complete set of information available . to find this distribution we use bayes theorem , @xmath147 where @xmath148 is the initial probability distribution and",
    "@xmath149 is the probability that we would measure record @xmath0 given that the experiment was initially prepared in state @xmath145 .",
    "we will assume that our experiment can prepare unbiased initial states and as such we take @xmath150 .",
    "the conditional distribution @xmath149 is the probability that we would measure record , @xmath0 , given that the experiment was initially prepared in state @xmath145 .",
    "thus to calculate @xmath151 all we need to do is calculate @xmath152 .",
    "this is the non - trivial step , but can be determined by @xmath153 where @xmath154 labels a possible realization of the qubit trajectory .",
    "that is , @xmath149 can be determined by taking the ensemble average of @xmath155 for all possible realizations , @xmath156 ( @xmath156 is given by eq .",
    "( [ if_excited ] ) if the qubit is initially in the excited state or @xmath157 if initially in the ground state ) . > from our simple model for the noise , eq .",
    "( [ psigz ] ) , @xmath155 is simply a multiplication of many gaussians each centered on the instantaneous value of @xmath156 .    for an excited state initial condition",
    ", the probability of getting record @xmath0 will be given by    @xmath158 \\exp\\left[-\\int_{\\tau_{\\rm d}}^{\\tau_{\\rm f } } d\\tau(\\psi(\\tau ) + 1 ) ^2 { \\rm snr}/2 \\right ] { { \\nonumber}\\\\ & & } + e^{-\\tau_{\\rm f } } \\exp\\left[-\\int_0^{\\tau_{\\rm f } } d\\tau(\\psi(\\tau ) - 1 ) ^2 { \\rm snr}/2 \\right ] .\\end{aligned}\\ ] ]    here the first term represents all possible trajectories that have had a decay in time @xmath61 ( the integration time ) , the second term represents all the trajectories that did not decay in this time , and @xmath159 is the normalization constant . if the qubit were initially in the ground state then the probability of getting record @xmath0 will be given by @xmath160 .\\end{aligned}\\ ] ]    now that we have expressions for @xmath149 all that we need to do to get our best estimate of the initial state is to use eq .",
    "( [ bayes ] ) .",
    "doing this gives @xmath161 { \\rm snr}\\ } + e^{-\\tau_{\\rm f } } \\exp[s(\\tau_{\\rm f},0 ) { \\rm snr } ] \\right ] { { \\nonumber}\\\\ & & } \\\\\\label{opdown }   p ( i_0 = - 1|\\psi ) & = & \\frac{1}{\\rm norm } \\exp[-s(\\tau_{\\rm f},0 ) { \\rm snr } ] \\end{aligned}\\ ] ] where the two time integrated signal @xmath162 is @xmath163 and the norm is simply @xmath164 + e^{-\\tau_{\\rm f } } \\exp[s(\\tau_{\\rm f},0 ) { \\rm snr } ] + \\exp[-s(\\tau_{\\rm f},0 ) { \\rm snr } ] , \\ ] ]    here we see that to solve this equation we need to evaluate a double integral over a stochastic process .",
    "this is impractical to solve numerically , however , as shown in the appendix we can easily recast these integrals in terms of two sets of two coupled stochastic differential equations which require similar computational resources to that used with the linear filters .    to show a typical trajectory for this estimated initial condition",
    ", we randomly generated records for both an excited and ground state initial condition .",
    "rather then plotting both @xmath165 and @xmath166 we define @xmath167 ( this is the estimator that replaces @xmath32 used in the linear filters ) , this will range from @xmath8 to @xmath168 and the closer it is to one of these limits , the more certain we are that the initial condition which generated @xmath0 is this value .",
    "the results of this simulation are shown in fig .",
    "[ fig : zest ] a ) .",
    "the red ( solid ) line corresponds to the case when the initial state was the ground state and the blue ( dashed ) line is for the excited state .",
    "here we see that for this typical trajectory our estimate is fairly good at predicting the real initial condition and we are almost certain for the excited case .",
    "however this is only a typical trajectory and to get a better understanding of the predictability of this method we use the same fidelity measure as before , that is we subtract our wrong guesses from our correct guesses . to be more specific , we define the following assignment procedure :",
    "if @xmath169 then we assign the qubit as up and if @xmath170 we assign it as down .",
    "if @xmath171 is equal to zero we ignore the result ( or flip an unbiased coin to make our decision ) . given this assignment criteria we can define the fidelity as @xmath172}\\ ] ] where @xmath173 is the number of randomly generated @xmath0 for both @xmath174 and @xmath175 initial conditions .",
    "this is shown in figs .",
    "[ fig : timefidelity ] a ) and [ fig : snrfidelity ] a ) as the green ( dashed - dotted ) line for @xmath176 ( specific optimal fidelities are listed in table  [ tab : fidelity ] ) .",
    "here we see that the fidelity is always better than the other cases and that there is no optimal measurement time .",
    "that is , unlike the box car filter and the exponential linear filter , the fidelity is a non - decreasing function of the integration time .    it should be noted that as in the previous protocols , this is a biased measurement which favors ground state preparations .",
    "this can be seen by looking closely at fig .",
    "[ fig : zest ] b ) .",
    "this figure shows a histogram of @xmath177 estimates when the system is prepared in the excited state ( dark blue bars , column 1 ) and the ground state ( light red bars , column 2 ) for a @xmath178 .",
    "if we use our assignment procedure and subtract the wrong guesses from the correct guesses for each prepared initial state we get a fidelity of 0.92 for the ground state and 0.76 for the excited state ( an average fidelity of 0.84 ) .",
    "this is because when the qubit is prepared in the excited state , rare , early decays will fool the detector .     ,",
    "the challenges from qubit relaxation to attaining high fidelity in a continuous measurement also exist in other measurement schemes . for comparison , consider a latching measurement where the qubit state triggers a classical switching event in the measurement apparatus @xcite .",
    "such a measurement has the advantage that the detector state stays latched for a very long time , so that noise from subsequent amplification stages is completely negligible and the snr is effectively infinite .",
    "we can roughly model this process as an instantaneous measurement with no errors but a finite arming time @xmath17 needed to set up the pre - latched state of the detector .",
    "we assume that the arming stage occurs after the qubit is prepared but before it is measured",
    ". the measurement of a qubit in the excited state will be wrong if the qubit relaxes before the measurement is made .",
    "the probability that the qubit relaxes during @xmath17 rises exponentially towards 1 , so the fidelity falls exponentially , @xmath179 .",
    "as shown in table [ tab : fidelity ] , @xmath180 must be slightly smaller than @xmath98 .",
    "although these times are different in that @xmath180 is a maximum value whereas @xmath98 is an optimal value for a given snr , they provide a valuable comparison between the measurement schemes .",
    "of course , no latching measurement is truly instantaneous with perfect accuracy in translating the qubit state into latching events .",
    "moreover , a latching measurement usually induces some mixing of states , so the actual fidelity may be lower than for an equivalent continuous qnd measurement .",
    "both measurement schemes have their own strengths and weaknesses , but in either case , qubit decay can be a significant limiting factor on the fidelity .",
    "we have examined the effect of qubit relaxation on the estimation of the qubit initial state ( excited or ground ) using a continuous - in - time noisy quantum non - demolition measurement for four different measurement protocols . in these protocols",
    "the measurement results are integrated with a box car linear filter , an exponentially decaying filter , an optimal linear filter and a non - linear bayesian filter which by definition is the optimal theoretical filter .",
    "we found that in all these protocols there exists a theoretical limit on the measurement fidelity .",
    "the determining factor of this limit is the signal to noise ratio of the measurement .",
    "our results are summarized in table  [ tab : fidelity ] where we see that the non - linear filter reaches the same fidelity as the linear filters even for substantially lower required signal to noise ratio .",
    "lastly we compare the continuous quantum non - demolition results with latching measurements and found that there is a quantitatively different but qualitatively similar limit on the fidelity of latching measurements also due to relaxation . the signal to",
    "noise ratio required to do successful qubit single shot quantum non - demolition measurements should be attainable in the near future , and there is no fundamental reason why significantly higher fidelity measurements can not be performed .",
    "we thank michel devoret , isaac chuang , alexandre blais , jens koch , andrew houck , and david schuster for discussions .",
    "this work was supported in part by nsa under aro contract no w911nf-05 - 1 - 0365 , and the nsf under grants itr-0325580 , dmr-0342157 and dmr-0603369 , and the w. m. keck foundation .",
    "in this appendix we present the method used to simulate the optimal non - linear filter .",
    "this filter requires simulating eqs .",
    "( [ opup ] ) and ( [ opdown ] ) which contains a double integral over a stochastic process @xmath26 .",
    "this is not practical numerically and a much better method can be implemented by deriving a set of coupled stochastic differential equations . to do this",
    "we start by rewriting eqs .",
    "( [ opup ] ) and ( [ opdown ] ) as @xmath181 where    @xmath182 + \\int_{0}^{\\tau_{\\rm f } }   d \\tau_{\\rm d}~e^{-\\tau_{\\rm d } } \\exp\\ { [ s(\\tau_{\\rm d } , 0)-s(\\tau_{\\rm f},\\tau_{\\rm d } ) ] { \\rm snr}\\ } , \\\\\\label{opdownbar } \\bar{p}_{-1,\\psi}&= & \\exp[-s(\\tau_{\\rm f},0 ) { \\rm snr } ] , \\end{aligned}\\ ] ]    and the signal @xmath162 is defined in eq .",
    "( [ stt ] ) .",
    "we first differentiate @xmath183 with respect to @xmath61 and by defining @xmath184 -\\int_{0}^{\\tau_{\\rm f } } d \\tau_{\\rm d}~e^{-\\tau_{\\rm d}}\\exp\\ { [ s(\\tau_{\\rm d } , 0)-s(\\tau_{\\rm f},\\tau_{\\rm d } ) ] { \\rm snr}\\},\\end{aligned}\\ ] ]    we get the following set of coupled stochastic differential equations @xmath185 and the initial conditions @xmath186 and @xmath187 . if we use eq .",
    "( [ opdownbar ] ) the two additional coupled equations are @xmath188 with initial conditions @xmath189 and @xmath190 .",
    "note that since there is no relaxation , we do not need to have two equations for the ground state , we can just use @xmath191 , but to keep the problem symmetrical we have decided to leave both equations in .",
    "this makes it easier to extend the theory to cases where upward jumps are possible .",
    "thus to simulate eqs .",
    "( [ opup ] ) and ( [ opdown ] ) we simply solve the above two sets of two coupled differential equations and then combine them using eqs .",
    "( [ opup2 ] ) and ( [ opdown2 ] ) .",
    "note an equivalent derivation of these equations can be made by using the kushner - stratonovich equation @xcite and then simply using bayes theorem to invert these equations for estimating unknown parameters @xcite .",
    "c.  langer , r.  ozeri , j.  d. jost , j.  chiaverini , b.  demarco , a.  ben - kish , r.  b. blakestad , j.  britton , d.  b. hume , w.  m. itano , d.  leibfried , r.  reichle , t.  rosenband , t.  schaetz , p.  o. schmidt , and d.  j. wineland , phys .",
    "* 95 * , 060502 ( 2005 ) .",
    "d. divincenzo , g. burkard , d. loss , and e. sukhorukov , in _ quantum mesoscopic phenomena and mesoscopic devices in microelectronics _ , edited by i. kulik and r. ellialtioglu ( nato advanced study institute , turkey , 1999 ) , ."
  ],
  "abstract_text": [
    "<S> we study how the spontaneous relaxation of a qubit affects a continuous quantum non - demolition measurement of the initial state of the qubit . </S>",
    "<S> given some noisy measurement record @xmath0 , we seek an estimate of whether the qubit was initially in the ground or excited state . we investigate four different measurement protocols , three of which use a linear filter ( with different weighting factors ) and a fourth which uses a full non - linear filter that gives the theoretically optimal estimate of the initial state of the qubit . </S>",
    "<S> we find that relaxation of the qubit at rate @xmath1 strongly influences the fidelity of any measurement protocol . </S>",
    "<S> to avoid errors due to this decay , the measurement must be completed in a time that decrease linearly with the desired fidelity while maintaining an adequate signal to noise ratio . </S>",
    "<S> we find that for the non - linear filter the predicted fidelity , as expected , is always better than the linear filters and that the fidelity is a monotone increasing function of the measurement time . </S>",
    "<S> for example , to achieve a fidelity of 90% , the box car linear filter requires a signal to noise ratio of @xmath2 in a time @xmath3 whereas the non - linear filter only requires a signal to noise ratio of @xmath4 . </S>"
  ]
}