{
  "article_text": [
    "`` today , the study of magic squares is not regarded as a subject of mathematics , but many earlier mathematicians in china and japan studied it . '' these words from shigeru s history of old japanese mathematics @xcite are no longer completely true . while the construction of magic squares remains for the most part recreational , their counting has become part of the mainstream of enumerative combinatorics , as an example of quasipolynomial counting formulas and as an application of ehrhart s theory of lattice points in polytopes .",
    "there are several classical @xcite and recent @xcite mathematical works on counting something like magic squares , but without the requirement that the entries be distinct , and often omitting the diagonals . in previous articles",
    "@xcite we established the groundwork for an enumerative theory of magic squares with distinct entries .",
    "here we apply those geometrical and algebraic methods to solve the problem of counting three kinds of magical @xmath1 squares .",
    "each square @xmath2 has positive integral entries that satisfy certain line - sum equations and distinctness conditions . in a _",
    "weakly semimagic square _ every row and column sum is the same ( their common value is called the _ magic sum _ ) ; in a _",
    "weakly magic square _",
    "each of the two diagonals also adds up to the magic sum .",
    "such squares have been studied before ( see , e.g. , beck et al .",
    "@xcite and stanley @xcite ) ; the difference here is that we count _ strongly _ magic or semimagic squares , where all entries of the square are distinct .",
    "( since strongly magic squares are closest to what are classically known as `` magic squares''see the introduction to our general magic article @xcite  we call strong squares simply `` magic '' or `` semimagic '' without qualification . )",
    "the third type we count is a _ magilatin square _ ; this is a weakly semimagic square with the restriction that the entries be distinct within a row or column .",
    "the numbers of standard magic squares ( with entries @xmath3 ) and latin squares ( in which each row or column has entries @xmath4 ) are special evaluations of our counting functions .",
    "we count the squares in two ways : by magic sum ( an _ affine _ count ) , and by an upper bound on the numbers in the square ( a _ cubic _ count ) . letting @xmath5 denote the number of squares in terms of a parameter @xmath6 which is either the magic sum or a strict upper bound on the entries , we know by our previous work @xcite that @xmath7 is a _ quasipolynomial _ , that is , there are a positive integer @xmath8 and polynomials @xmath9 so that @xmath10 the minimal such @xmath8 is the _ period _ of @xmath7 ; the polynomials @xmath9 are the _ constituents _ of @xmath7 , and @xmath11 is the _",
    "principal constituent_. here we find an explicit list of constituents and also the explicit rational generating function @xmath12 ( from which the quasipolynomial is easily extracted ) .",
    "each magic and semimagic square also has an _ order type _ , which is the arrangement of the cells in order of increasing value of their entries .",
    "the order type is a linear ordering of the cells because all entries are distinct in these squares .",
    "there are @xmath13 possible linear orderings but only a handful are order types of squares .",
    "our approach finds the actual number of order types for each kind of square ; it is the absolute value of the constant term of the principal constituent , that is , @xmath14 .",
    "( see theorems 3.4 and 3.14 and examples 3.11 , 3.12 , and 3.21 in our paper on magic labellings @xcite . ) obviously , this number will be the same for cubic and affine counts of the same kind of square .",
    "( there is also an order type for magilatin squares , which is a linear ordering only within each row and column . as it is not a simple permutation of the cells",
    ", we shall not discuss it any further . )",
    "one of our purposes is to illustrate the technique of our general treatment @xcite .",
    "another is to provide data for the further study of magic squares and their relatives ; to this end we list the exact numbers of each type for small values of the parameter and also the numbers of symmetry types , reduced squares , and reduced symmetry types of each type ( and we refer to the on - line encyclopedia of integer sequences ( oeis ) @xcite for the first 10,000 values of each counting sequence ) .",
    "a square is _ reduced _ by subtracting the smallest entry from all entries ; thus , the smallest entry in a reduced square is 0 .",
    "a square is _ normalized _ by being put into a form that is unique in each symmetry class . clearly , the number of normalized squares , i.e. , of equivalence classes under symmetry , is fundamental ; and the number of reduced , normalized squares is more fundamental yet .",
    "there are other ways to find exact formulas .",
    "xin @xcite tackles @xmath1 magic squares , counted by by magic sum , using macmahon s partition calculus .",
    "he gets a generating function that agrees with ours ( thereby confirming both ) .",
    "stanley s idea of mbius inversion over the partition lattice ( * ? ? ?",
    "* exercise 4.10 ) is similar to ours in spirit , but it is less flexible and requires more computation .",
    "beck and van herick @xcite have counted @xmath15 magic squares using the same basic geometrical setup as ours but with a more direct counting method .    our paper is organized as follows .",
    "section [ tech ] gives an outline of our theoretical and computational setup , as well as some comments on checks and feasibility . in section [ magic ]",
    "we give a detailed analysis of our computations for counting magic @xmath16 squares .",
    "sections [ semimagic ] and [ magilatin ] contain the setup and the results of similar computations for @xmath16 semimagic and magilatin squares .",
    "we conclude in section [ questions ] with some questions and conjectures .",
    "we hope that these results , and still more the method , will interest both magic squares enthusiasts and mathematicians .",
    "the means by which we solve the specific examples of @xmath1 magic , semimagic , and magilatin squares is inside - out ehrhart theory @xcite .",
    "that means counting the number of @xmath17-fractional points in the interior of a convex polytope @xmath18 that do not lie in any of a certain set @xmath19 of hyperplanes .",
    "the number of such points is a quasipolynomial function @xmath20 , the _ open ehrhart quasipolynomial _ of the open inside - out polytope @xmath21 .",
    "the exact polytope and hyperplanes depend on which of the six problems it is , but we can describe the general picture .",
    "first , there are the equations of magic ; they determine a subspace @xmath22 of all @xmath1 real matrices which we like to call the _ magic subspace_though mostly we work in a smaller overall space @xmath23 that results from various reductions .",
    "then there is the polytope @xmath18 of constraints , which is the intersection with @xmath22 of either a hypercube @xmath24^{3 ^ 2}$ ] or a standard simplex @xmath25 : the former when we impose an upper bound on the magic square entries and the latter when we predetermine the magic sum .",
    "the parameter @xmath6 is the strict upper bound in the former case ( which we call _ cubical _ due to the shape of @xmath18 ) , the magic sum in the latter ( which we call _ affine _ as @xmath18 lies in a proper affine subspace ) .",
    "finally there are the strong magical exclusions , the hyperplanes that must be avoided in order to ensure the entries are distinct  or in the magilatin examples , as distinct as they ought to be .",
    "these all have the form @xmath26 . the combination of @xmath18 and the excluded hyperplanes forms the _ vertices _ of @xmath27 , which are all the points of intersection of facets of @xmath18 and hyperplanes in @xmath19 that lie in or on the boundary of @xmath18 .",
    "thus , we count as a vertex every vertex of @xmath18 itself , each point that is the intersection of some facets and some hyperplanes in @xmath19 , and any point that is the intersection of some hyperplanes and belongs to @xmath18 , but not intersection points that are outside @xmath18 .",
    "( points of each kind do occur in our examples . )",
    "the _ denominator _ of @xmath27 is the least common denominator of all the coordinates of all the vertices of @xmath27 .",
    "the period of @xmath20 divides the denominator ; this gives us a known bound on it .",
    "this geometry might best be explained with an example .",
    "let us consider magic @xmath0 squares , @xmath28 \\in { \\mathbb{z } } _ { > 0 } ^{3 ^ 2 } .\\ ] ] the magic subspace is @xmath29 \\in { \\mathbb{r}}^{3 ^ 2 } : \\",
    "\\begin{array}{l }    x _ { 11 } + x _ { 12 } + x _ { 13 } = x _ { 21 } + x _ { 22 } + x _ { 23 } \\\\   = x _ { 31 } + x _ { 32 } + x _ { 33 }   = x _ { 11 } + x _ { 21 } + x _ { 31 } \\\\   = x _ { 12 } + x _ { 22 } + x _ { 32 } = x _ { 13 } + x _ { 23 } + x _ { 33 }",
    "\\\\   = x _ { 11 } + x _ { 22 } + x _ { 33 } = x _ { 13 } + x _ { 22 } + x _ { 31 }     \\end{array }    \\right\\ } .\\ ] ] the hyperplane arrangement @xmath19 that captures the distinctness of the entries is @xmath30 finally , there are two polytopes associated to magic @xmath0 squares , depending on whether we count them by an upper bound on the entries : @xmath31^{3 ^ 2},\\ ] ] or by magic sum : @xmath32 \\in { \\mathbb{r } } _ { \\ge 0 } ^{3 ^ 2 } : \\      x _ { 11 } + x _ { 12 } + x _ { 13 } = 1 \\right\\ }   .\\ ] ] our cubical counting function computes the number of magic squares all of whose entries satisfy @xmath33 , in terms of an integral parameter @xmath6 .",
    "these squares are the lattice points in @xmath34 our second , affine , counting function computes the number of magic squares with positive entries and magic sum @xmath6 .",
    "these squares are the lattice points in @xmath35    in general , the number of squares we want to count , @xmath5 , is the ehrhart quasipolynomial @xmath20 of an open inside - out polytope @xmath21 .",
    "we obtain the necessary ehrhart quasipolynomials by means of the computer program latte @xcite .",
    "it computes the closed ehrhart generating function @xmath36 counting only interior points gives the open ehrhart quasipolynomial @xmath37 and its generating function @xmath38 since we want the open inside - out ehrhart generating function @xmath39 , we need several transformations .",
    "one is _ ehrhart reciprocity _",
    "@xcite , which is the following identity of rational generating functions : @xmath40 the inside - out version ( * ? ? ?",
    "* equation ( 4.6 ) ) is @xmath41 we need to express the inside - out generating functions in terms of ordinary ehrhart generating functions . to do that we take the intersection poset @xmath42 which is ordered by reverse inclusion .",
    "note that @xmath43 and @xmath44 , defined similarly but with @xmath18 instead of @xmath45 , are isomorphic posets because @xmath19 is transverse to @xmath18 ; specifically , @xmath46 , where @xmath47 is the ( topological ) closure of @xmath48 .",
    "now we have the mbius inversion formulas ( * ? ? ?",
    "* equations ( 4.7 ) and ( 4.8 ) ) @xmath49 and @xmath50 ( since @xmath19 is transverse to @xmath18 ; see our general paper @xcite ) . here",
    "@xmath51 is the mbius function of @xmath43 @xcite .",
    "thus we begin by getting all the cross - sectional generating functions @xmath52 from latte .",
    "then we either sum them by and apply inside - out reciprocity , or apply ordinary reciprocity first and then sum by .",
    "( we did whichever of these seemed more convenient . ) in the semimagic and magilatin counts we need a third step because the generating functions we computed pertain to a reduced problem ; those of the original problem are obtained through multiplication by another generating function .",
    "once we have the generating function we extract the quasipolynomial , essentially by the binomial series .",
    "if an ehrhart quasipolynomial @xmath53 of a rational convex polytope has period @xmath8 and degree @xmath54 , then its generating function @xmath55 can be written as a rational function of the form @xmath56 for some nonnegative integers @xmath57 . grouping the terms in the numerator of according to the residue class of the degree modulo @xmath8 and expanding the denominator",
    ", we get @xmath58 x^ { pk+r } \\ .\\end{aligned}\\ ] ] hence the @xmath59th constituent of the quasipolynomial @xmath53 is @xmath60      the initial step is always to reduce the size of the problem by applying symmetry .",
    "each problem has a _ normal _ form under symmetry , which is a strong square .",
    "the number of all magic or semimagic squares is a constant multiple of the number of symmetry types , because every such square has the same symmetry group . for magilatin squares ,",
    "there are several symmetry types with symmetry groups of different sizes , so each type must be counted separately .",
    "semimagic and magilatin squares also have an interesting _ reduced _ form , in which the values are shifted by a constant so that the smallest cell contains 0 ; and a reduced normal form ; the latter two are not strong but are aids to computation .",
    "reduced squares are counted either by magic sum ( the `` affine '' counting rule ) or by the largest cell value ( the `` cubic '' count ) .",
    "all reduced normal semimagic squares correspond to the same number of unreduced squares , while the different symmetry types of magilatin square give reduced normal squares whose corresponding number of unreduced squares depends on the symmetry type .",
    "the total number of squares , @xmath5 , and the number of reduced squares , @xmath61 , are connected by a convolution identity @xmath62 , where @xmath63 is a periodic constant ( by which we mean a quasipolynomial of degree 0 ; we say _ constant term _ for the degree-0 term of a quasipolynomial , even though the `` constant term '' may vary periodically ) or a linear polynomial .",
    "writing for the generating functions @xmath64 and similarly @xmath65 , and @xmath66 , we have @xmath67 it follows from the form of the denominator in equation that the period of @xmath7 divides the product of the periods of @xmath63 and @xmath68 .",
    "the reduced number @xmath61 is , in the semimagic case , a constant multiple of the number @xmath69 of reduced , normal semimagic squares ; in the magilatin case it is a sum of different multiples , depending on a symmetry group , of the number of reduced , normal magilatin squares of each different type @xmath70 .",
    "each @xmath69 is the open ehrhart quasipolynomial @xmath71 of an inside - out polytope @xmath72 which is smaller than the original polytope @xmath18 .",
    "we compute @xmath73 from the ehrhart generating functions @xmath52 of the nonvoid sections",
    "@xmath48 of @xmath74 by flats of @xmath75 through the following procedure :    1 .",
    "we calculate the flats and sections by hand .",
    "we feed each @xmath48 into the computer program latte @xcite , which returns the closed generating function @xmath76 , whose constant term equals @xmath77 because @xmath48 is nonvoid and convex .",
    "3 .   with semimagic squares , by equations ",
    "we have the mbius - inversion formulas @xmath78 where @xmath79 , the intersection poset of @xmath80 .",
    "the procedure for magilatin squares is similar but taking account of the several types .",
    "we check our results in a variety of ways .",
    "the degree is the dimension of the polytope , or the number of independent variables in the magic - sum equations .",
    "the leading coefficient is the volume of the polytope .",
    "( the volume is normalized so that a fundamental domain in the affine space spanned by the polytope has unit volume . )",
    "this check is also not difficult .",
    "the volume is easy to find by hand in the magic examples . in affine",
    "semimagic the polytope is the birkhoff polytope @xmath81 , whose volume is well known ( section [ sa3 ] ) .",
    "the cubical semimagic volume is not well known but it was easy to find ( section [ weaksc3 ] ) .",
    "the magilatin polytopes are the same as the semimagic ones .",
    "the firmest verification is to compare the results of the generating function approach with those of direct enumeration .",
    "if we count the squares individually for @xmath82 where @xmath83 , only the correct quasipolynomial can agree with the counts ( given that we know the degree @xmath54 and period @xmath8 from the geometry ) .",
    "though @xmath84 is too large to reach in some of the examples , still we gain considerable confidence if even a smaller value of @xmath85 yields numbers that agree with those derived from the quasipolynomial or generating function .",
    "we performed this check in each case .      based on our solutions of the six @xmath1 examples we believe our counting method is practical .",
    "the calculations are simple and readily verified .",
    "linear algebra tells us the degree , geometry tells us the period ; we obtain the generating function using the ehrhart package latte @xcite and then apply reciprocity ( equation or ) and mbius inversion ( equation or ) , and extract the constituents , all with maple .",
    "the programming is not too difficult .    in the magic square problems we found the denominator by calculating the vertices of the inside - out polytope .",
    "then we took two different routes . in one",
    "we applied latte and equation . in the other we calculated @xmath5 for small values of @xmath6 by generating all magic squares , taking enough values of @xmath6 that we could fit the quasipolynomial constituents to the data .",
    "this was easy to program accurately and quick to compute , and it gave the same answer .",
    "the programs can be found at our `` six little squares '' web site @xcite .    in principle",
    "the semimagic and magilatin problems can be solved in the same two ways .",
    "the geometrical method with mbius inversion gave complete answers in a few minutes of computer time after a simple hand analysis of the geometry ( see section [ semimagic ] ) .",
    "direct enumeration on the computer proved unwieldy ( at best ) , especially in the affine case , where the period is largest .",
    "a straightforward computer count of semimagic squares by magic sum ( performed in maple  admittedly not the language of choice  on a personal computer ) seemed destined to take a million years .",
    "switching to a count of reduced normal squares , the calculation threatened to take only a thousand years .",
    "these programs are at our `` six little squares '' web site @xcite , as is a complicated `` supernormalized formula '' that greatly speeds up affine semimagic counting ( see section [ sa3alt ] ) .",
    "we use a lot of notation . to keep track of it we try to be reasonably systematic .    * * * refer to magic squares ( section [ magic ] ) .",
    "* * and subscript @xmath86 refer to semimagic squares ( section [ semimagic ] ) . * * and subscript @xmath87 refer to magilatin squares ( section [ magilatin ] ) . * * refer to reduced squares ( the minimum entry is @xmath88 ) , while @xmath89 et al .  refer to ordinary squares ( all positive entries ) . *",
    "* refers to `` cubic '' counting , by an upper bound on the entries .",
    "* * refers to `` affine '' counting , by a specified magic sum . * * ( capital ) refers to all squares of that type . * * ( minuscule ) refers to symmetry types of squares , or equivalently normalized squares .",
    "the standard form of a magic square of order 3 is well known ; it is @xmath90 where the magic sum is @xmath91 . taking account of the 8-fold symmetry , under which we may assume the largest corner value is @xmath92 and the next largest is @xmath93 , and the distinctness of the values",
    ", we have @xmath94 and @xmath95 .",
    "one must also have @xmath96 to ensure positivity .    in this pair of examples ,",
    "the dimension of the problem is small enough that there is no advantage in working with the reduced normal form ( where @xmath97 ) .",
    "here we count by a strict upper bound @xmath6 on the permitted values ; since the largest entry is @xmath98 , the bound is @xmath99 .",
    "the number of squares with upper bound @xmath6 is @xmath100 .",
    "we think of each magic square as a @xmath101-lattice point in @xmath102 , the ( relative ) interior of the inside - out polytope @xmath103 but multiplied by @xmath6 to make the entries integers . here",
    "we use normalized coordinates @xmath104 , @xmath105 , and @xmath106 . the semilattice of flats is @xmath107 with @xmath108 the vertices are @xmath109 of which @xmath110 are the vertices of @xmath111 and @xmath112 are those of @xmath113 .",
    "( both these polytopes are simplices . ) from equation , @xmath114   \\intertext{which we evaluate by { \\tt latte } and ehrhart reciprocity , equation \\eqref{e : ehrrecipgf } : } & = 8 \\left [ \\frac { x^8 } { ( 1-x)^2 ( 1-x^2 ) ( 1-x^4 ) } - \\frac { x^8 } { ( 1-x)^2 ( 1-x^6 ) } \\right ] \\\\[6pt ] & = \\frac { 8 x^{10 } ( 2 x^2 + 1 ) } { ( 1-x)^2 ( 1-x^4 ) ( 1-x^6 ) } \\\\[6pt ] & = \\frac { 8 x^{10 } ( 2x^2 + 1 ) ( x^4-x^2 + 1 ) ( x^{11}+x^{10}+\\cdots+x+1)^2 ( x^{10}+x^8+\\cdots+x^2 + 1 ) } { ( 1-x^{12})^4 } \\ .\\end{aligned}\\ ] ] from this generating function we extract the quasipolynomial @xmath115 \\frac{t^3 - 16t^2 + 73t-58}{6 } =   \\frac{(t-1)(t^2 - 15t+58)}{6}\\ , , & \\text{if } t \\equiv 1 { \\ ( \\operatorname{mod}12 ) } ; \\\\[6pt ] \\frac{t^3 - 16t^2 + 73t-102}{6 } =   \\frac{(t-3)(t^2 - 13t+34)}{6}\\ , , & \\text{if } t \\equiv 3,11 { \\ ( \\operatorname{mod}12 ) } ; \\\\[6pt ] \\frac{t^3 - 16t^2 + 76t-112}{6 } =   \\frac{(t-4)(t^2 - 12t+28)}{6}\\ , , & \\text{if } t \\equiv 4,10 { \\ ( \\operatorname{mod}12 ) } ; \\\\[6pt ] \\frac{t^3 - 16t^2 + 73t-90}{6 } =   \\frac{(t-2)(t-5)(t-9)}{6}\\ , , & \\text{if } t \\equiv 5,9 { \\ ( \\operatorname{mod}12 ) } ; \\\\[6pt ] \\frac{t^3 - 16t^2 + 73t-70}{6 } =",
    "\\frac{(t-7)(t^2 - 9t+10)}{6}\\ , , & \\text{if } t \\equiv 7 { \\ ( \\operatorname{mod}12 ) } ; \\end{cases}\\ ] ] and the first few nonzero values for @xmath116 : @xmath117    [ cols=\">,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]      +    last , we need the intersection points of three planes of @xmath118 ; or , of a plane and a line .",
    "some are not in @xmath119 at all ; them we can ignore .",
    "some are on the boundary of @xmath119 ; they are necessary in finding the denominator , but all of them are points already listed in .",
    "it turns out that @xmath120 is the only vertex in @xmath121 , so it is the only one we need for the intersection poset .",
    "the combinatorial structure and the intersection poset ( figure [ f : s3intersections ] ) for the affine count are identical to those for the cubical count .",
    "the reason is that the affine polytope @xmath122 is the 4-dimensional section of @xmath111 by the flat in which the magic sum equals 1 , and this flat is orthogonal to the line of intersection of the whole arrangement @xmath123 .",
    "the second half of the affine solution is to find @xmath124 by applying equations  after finding the ehrhart generating functions @xmath125 for @xmath126 .",
    "the next step , then , is to calculate those generating functions .",
    "this is done by latte",
    ". then @xmath127 is the sum of all these rational functions ; that is , @xmath128 the generating function for the affine count of semimagic squares , by , is @xmath129   & \\frac {    72x^{15}\\ , \\left\\ {   \\begin{aligned } 18x^{21}&+5x^{20}+15x^{19}+11x^{17}-8x^{16}+x^{15}-23x^{14}-13x^{13}-22x^{12}-9x^{11}\\\\ & -16x^{10}+x^{9}-3x^{8}+7x^{7}+7x^{6}+9x^{5}+7x^{4}+6x^{3}+4x^{2}+2x+1   \\end{aligned } \\right\\ }   } {    ( 1-x^3)^2 ( 1-x^4 ) ( 1-x^5 ) ( 1-x^6 ) ( 1-x^7 ) ( 1-x^8 )   } \\ .",
    "\\end{aligned}\\ ] ] from the geometrical or generating - function denominator we know that the period of @xmath130 divides @xmath131 .",
    "this is long , but it can be simplified .",
    "the factor 7 in the period is due to a single term in .",
    "if we treat it separately we have @xmath132 as a sum of the @xmath133-term @xmath134 and a `` truncated '' generating function for @xmath135 , and a corresponding truncated expression @xmath136 & \\quad \\frac {   -72x^{10}\\ , \\left\\ {   \\begin{aligned } 17x^{19}&+5x^{18}+15x^{17}+x^{16}+12x^{15}-7x^{14}+2x^{13}-7x^{12}\\\\ & -8x^{11}-9x^{10}-9x^{9}-6x^{8}-6x^{7}-x^{6}+x^{4}+x^{3}-1 \\end{aligned } \\right\\ } } {   ( 1-x^3)^2 ( 1-x^4 ) ( 1-x^5 ) ( 1-x^6 ) ( 1-x^8 ) } \\ .\\end{aligned}\\ ] ] we extract the constituents from this expression as in section [ genmethod ] , separately for the two parts of the generating function .",
    "the constituents are all of the form @xmath137 where @xmath138 is a correction , to be defined in a moment , and @xmath139 @xmath140 and @xmath141 is given in table [ tb : semiaffa0 ] .",
    "we call the constituents of the quasipolynomial @xmath142 the _ truncated constituents _ of @xmath130 , since they correspond to the truncated generating function mentioned just above .",
    "the @xmath143 term that undoes the truncation is @xmath144 where @xmath145 the least positive residue of @xmath6 modulo 7 and @xmath146 note that @xmath147 if @xmath148 , so that @xmath149 and in general @xmath150 .        ' '' ''",
    "@xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 +    ' '' ''    0&@xmath151 & 20 & @xmath152 & 40 & @xmath153 & 60 & @xmath154 & 80 & @xmath155 & 100 & @xmath156 +    ' '' ''    1&@xmath157 & 21&@xmath158 & 41&@xmath159 & 61&@xmath160 & 81&@xmath161 & 101&@xmath162 +    ' '' ''    2&@xmath163 & 22&@xmath164 & 42&@xmath165 & 62&@xmath166 & 82&@xmath167 & 102&@xmath168 +    ' '' ''    3&@xmath169 & 23&@xmath170 & 43&@xmath171 & 63&@xmath172 & 83&@xmath173 & 103&@xmath174 +    ' '' ''    4&@xmath175 & 24&@xmath176 & 44&@xmath177 & 64&@xmath178 & 84&@xmath179 & 104&@xmath180 +    ' '' ''    5&@xmath181 & 25&@xmath182 & 45&@xmath183 & 65&@xmath184 & 85&@xmath185 & 105&@xmath186 +    ' '' ''    6&@xmath187 & 26&@xmath188 & 46&@xmath189 & 66&@xmath190 & 86&@xmath191 & 106&@xmath192 +    ' '' ''    7&@xmath193 & 27&@xmath194 & 47&@xmath195 & 67&@xmath196 & 87&@xmath197 & 107&@xmath198 +    ' '' ''    8&@xmath199 & 28&@xmath200 & 48&@xmath201 & 68&@xmath202 & 88&@xmath203 & 108&@xmath204 +    ' '' ''    9&@xmath205 & 29&@xmath206 & 49&@xmath207 & 69&@xmath208 & 89&@xmath209 & 109&@xmath210 +    ' '' ''    10&@xmath211 & 30&@xmath212 & 50&@xmath213 & 70&@xmath214 & 90&@xmath215 & 110&@xmath216 +    ' '' ''    11&@xmath217 & 31&@xmath218 & 51&@xmath219 & 71&@xmath220 & 91&@xmath221 & 111&@xmath222 +    ' '' ''    12&@xmath223 & 32&@xmath224 & 52&@xmath225 & 72&@xmath226 & 92&@xmath227 & 112&@xmath228 +    ' '' ''    13&@xmath229 & 33&@xmath230 & 53&@xmath231 & 73&@xmath232 & 93&@xmath233 & 113&@xmath234 +    ' '' ''",
    "14&@xmath235 & 34&@xmath236 & 54&@xmath237 & 74&@xmath238 & 94&@xmath239 & 114&@xmath240 +    ' '' ''    15&@xmath241 & 35&@xmath242 & 55&@xmath243 & 75&@xmath244 & 95&@xmath245 & 115&@xmath246 +    ' '' ''    16&@xmath247 & 36&@xmath248 & 56&@xmath249 & 76&@xmath250 & 96&@xmath251 & 116&@xmath252 +    ' '' ''    17&@xmath253 & 37&@xmath254 & 57&@xmath255 & 77&@xmath256 & 97&@xmath257 & 117&@xmath258 +    ' '' ''    18&@xmath259 & 38&@xmath260 & 58&@xmath261 & 78&@xmath262 & 98&@xmath263 & 118&@xmath264 +    ' '' ''    19&@xmath265 & 39&@xmath266 & 59&@xmath267 & 79&@xmath268 & 99&@xmath269 & 119&@xmath270 +    the period of the constant term of the truncated constituents is @xmath271 .",
    "it follows that @xmath130 has period @xmath272 , that is , @xmath273 .",
    "the principal constituent of @xmath130 ( that is , for @xmath148 ) is @xmath274 ( this incorporates the effect of the term @xmath275 . ) the constant term is the same as in the cubic count , as it is the number of order types of semimagic squares .",
    "we give the first few nonzero values of @xmath130 in the following table .",
    "( this sequence is a173547 in the oeis @xcite . )",
    "the third row is the number of normalized squares , or symmetry classes ( sequence a173725 ) ; this is @xmath276 .",
    "the last rows are the numbers of reduced squares ( sequence a173728 ) and of reduced , normalized squares ( sequence a173726 ) with magic sum @xmath6 .",
    "@xmath277      we verified our formulas by computing @xmath130 for @xmath278 through direct enumeration of normal squares .",
    "the results agree with those computed by expanding the generating function .",
    "we also applied proposition [ t : snsemimagic ] to derive a formula , independent of all other methods , by which we calculated numbers ( which we are not describing ; see the `` six little squares '' web page @xcite ) that allowed us to find the 840 constituents by interpolation .",
    "these interpolated constituents fully agreed with the ones given above .",
    "a magilatin square is like a semimagic square except that entries may be equal if they are in different rows and columns .",
    "the inside - out polytope is the same as with semimagic squares except that we omit those hyperplanes that prevent equality of entries in different rows and columns .",
    "thus , in our count of reduced squares , we have to count the fractional lattice points in some of the faces of the polytope .",
    "the reduced normal form of a magilatin square is the same as that of a semimagic square except that the restrictions are weaker .",
    "it might be thought that this would introduce ambiguity into the standard form because the minimum can occur in several cells , but it turns out that it does not .",
    "[ t : snmagiclatin ] a reduced , normal @xmath1 magilatin square has the form with the restrictions @xmath279 and .",
    "each reduced square with @xmath280 in the upper right corner corresponds to exactly @xmath281 different magilatin squares with entries in the range @xmath282 , for @xmath283 .",
    "each reduced square with magic sum @xmath22 corresponds to one magilatin square with magic sum equal to @xmath6 , if @xmath284 , and none otherwise , for @xmath285 .",
    "the proof is similar to that for semimagic squares ; we can arrange the square by permuting rows and columns and by reflection in the main diagonal so that @xmath286 is the smallest entry , the first row and column are each increasing , and @xmath287 .",
    "we can not say @xmath288 because entries that do not share a row or column may be equal .",
    "still , we obtain the form with the bounds and the same inequations as in semimagic because all the latter depend on having no two equal values in the same line ( row or column ) .    each reduced , normal magilatin square gives rise to a family of true magilatin squares by adding a positive constant to each entry and by symmetries , which are generated by row and column permutations and reflection in the main diagonal .",
    "call the set of symmetries @xmath289 . as with semimagic , @xmath290 .",
    "each normal , reduced square @xmath291 gives rise to @xmath292 squares via symmetries , where @xmath293 is the stabilizer subgroup of @xmath291 . if all entries are distinct , then the square is semimagic , @xmath293 is trivial , and everything is as with semimagic squares . however , if @xmath294 or @xmath295 or @xmath296 , the stabilizer is nontrivial .",
    "we consider each case in turn .",
    "_ the case @xmath297 .",
    "_ here @xmath298 because no line can repeat a value . to fix the square we can not permute any rows or columns but we can reflect in the main diagonal , so @xmath299",
    "moreover , reduces to @xmath300 we are in @xmath301 , the @xmath302 facet of @xmath303 , with the induced arrangement of three lines , @xmath304 .",
    "the number of reduced magilatin squares of this kind is @xmath305 , where @xmath306 is the number of @xmath307-lattice points in the open facet and , equivalently , the number of symmetry types of reduced magilatin squares of this kind .",
    "we apply equations  to the intersection poset @xmath308 , which is found in figure [ f : ml3intersections ] .",
    "the mbius function @xmath309 equals @xmath310 .    _",
    "the case @xmath311 .",
    "_ in this case a nontrivial member of @xmath293 can only exchange the two zero positions .",
    "such a symmetry that preserves the increase of the first row and column is unique ( as one can easily see ) ; thus @xmath299 .",
    "furthermore , reduces to @xmath312 we are in @xmath313 , the @xmath314 facet , with the induced arrangement @xmath315 of one line .",
    "the number of reduced magilatin squares of this kind is @xmath316 , where @xmath317 is the number of @xmath307-lattice points in the open facet and , equivalently , the number of symmetry types of reduced squares .",
    "we apply equations  to the intersection poset @xmath318 , shown in figure [ f : ml3intersections ] .",
    "the mbius function @xmath319 equals @xmath310 .    _",
    "the case @xmath296 .",
    "_ here we must have @xmath320 .",
    "there are two zero positions in opposite corners .",
    "a symmetry that exchanges them and preserves increase in the first row and column is uniquely determined , so @xmath299 .",
    "the inequations reduce to @xmath321 we are in @xmath322 , the facet where @xmath323 , with the two - line induced arrangement @xmath324 .",
    "the number of reduced magilatin squares of this kind is @xmath325 , where @xmath326 is the number of @xmath307-lattice points in the open facet , equally the number of reduced symmetry types .",
    "we apply equations  to the intersection poset @xmath327 in figure [ f : ml3intersections ] .",
    "the mbius function @xmath328 equals @xmath310 .    _",
    "the case @xmath329 .",
    "_ in these squares there are three zero positions and the whole square is a cyclic latin square .",
    "any symmetry that fixes the zero positions also fixes the rest of the square .",
    "there are @xmath330 symmetries that permute the zero positions , generated by row and column permutations .",
    "they all preserve the entire square .",
    "therefore @xmath331 .",
    "the inequations disappear .",
    "we are in the edge @xmath332 , which is the face where @xmath333 , with the empty arrangement , @xmath334 .",
    "the number of reduced magilatin squares of this kind is @xmath335 , where @xmath336 is the number of @xmath307-lattice points in the open edge , also the number of reduced symmetry types .",
    "the intersection poset @xmath337 consists of the one element @xmath332 , whose mbius function @xmath338 .    to get the intersection posets we may examine tables [ tb : planeedge ] and [",
    "tb : linepolytope ] to find the edges and vertices of @xmath80 in each closed facet .",
    "we also need to know which vertex is in which edge ; this is easy .",
    "although we do not need the fourth facet , @xmath339 , we include it for the interest of its more complicated geometry .",
    "[ c]@xmath318 [ c]@xmath327 [ c]@xmath308 [ c]@xmath340 [ l]@xmath313 [ l]@xmath322 [ l]@xmath301 [ l]@xmath339 [ l]@xmath341 [ l]@xmath342 [ l]@xmath343 [ l]@xmath344 [ l]@xmath345 [ l]@xmath346 [ l]@xmath347 [ l]@xmath348 [ l]@xmath349 [ l]@xmath350 [ l]@xmath351 [ l]@xmath352 [ l]@xmath353 [ l]@xmath354 [ l]@xmath355 .,title=\"fig : \" ]    of course all the functions @xmath356 and @xmath357 depend on whether we are counting cubically or affinely ( thus , subscripted @xmath358 or @xmath359 ) ; the two types will be treated separately .",
    "but the general conclusions hold that @xmath360 + 12{\\mathbf{r}}_{ob}(x ) , \\ ] ] and for the number of reduced symmetry types , @xmath361 with generating function @xmath362 , @xmath363 where @xmath364 is from semimagic and , by equation since @xmath365 for every lower interval in each facet poset ( except facet @xmath339 , which we do not use ) , @xmath366 the sign and reciprocal on the left result from equation .    there is also the generating function of the number of cubical or affine symmetry classes , @xmath367 , whose generating function is @xmath368 .",
    "this is obtained from @xmath361 in the same way as @xmath369 is from @xmath370 , the exact way depending on whether the count is affine or cubic .",
    "the weak quasipolynomial is exactly as in the semimagic cubical problem .",
    "the number of @xmath1 magilatin squares with strict upper bound @xmath6 is @xmath371 .",
    "we count them via @xmath372 , the number of reduced magilatin squares with largest entry ( which we know to be @xmath373 ) equal to @xmath280 .",
    "the formula is @xmath374 equivalently , @xmath372 counts @xmath375-integral points in the interior and part of the boundary of the inside - out polytope @xmath376 of section [ sc3 ] , weighted variably by @xmath377 .",
    "now we must calculate the closed ehrhart generating function for each necessary face .",
    "this is done by latte ; here are the results .",
    "first , @xmath378 : @xmath379 next is @xmath380 : @xmath381 the last facet is @xmath382 : @xmath383 = \\ & \\frac{1}{(1-x)^3 } + \\frac{1}{(1-x ) ( 1-x^2 ) } + \\frac{1}{(1-x ) ( 1-x^2 ) }     \\\\[4pt ] & + \\frac{2x^2 + 1}{(1-x^2)^2 } + \\frac{1}{1-x^3 }   \\\\[4pt ] = \\ & \\frac { -2x^5 + 4x^2 + 5x + 5 } { ( 1-x^2)^2 ( 1-x^3 )   } \\ .",
    "\\end{aligned}\\ ] ] finally , the edge @xmath384 : @xmath385 now @xmath386 results from , and then from we see that @xmath387 & \\frac {    12 x^4 \\left\\ { \\begin{aligned }    & 79 x^{15 } + 190 x^{14 } + 260 x^{13 } + 250 x^{12 } + 211 x^{11 } + 179 x^{10 } + 181 x^9 \\\\   & + 198 x^8 + 210 x^7 + 181 x^6 + 125 x^5 + 61 x^4 + 22 x^3 + 8 x^2 + 4 x + 1    \\end{aligned } \\right\\ } } {   ( 1-x^4 ) ( 1-x^5 ) ( 1-x^3)^2 ( 1-x^2)^2 } \\ . \\end{aligned}\\ ] ] the constituents of @xmath388 are extracted as described in section [ genmethod ] , and here they are : @xmath389   { \\displaystyle}\\frac{3}{10 } t^5 - \\frac{51}{8 } t^4 + \\frac{202}{3 }",
    "t^3   -\\frac{7493}{20 } t^2 + c_1(t ) t - c_0(t ) , & \\text{if $ t$ is odd } ; \\end{cases}\\ ] ] where @xmath390 varies with period 6 , given by @xmath391 and @xmath392 , given by table [ tb : magilatincubc0 ] , varies with period 60 .        ' '' ''",
    "@xmath6 & @xmath393 & @xmath6 & @xmath393 & @xmath6 & @xmath393 & @xmath6 & @xmath393 & @xmath6 & @xmath393 +    ' '' ''    0&948 & 12&948 & 24&@xmath394 & 36&@xmath395 & 48&@xmath394 +    ' '' ''    1&@xmath396 & 13&@xmath397 & 25&@xmath398 & 37&@xmath398 & 49&@xmath397 +    ' '' ''    2&@xmath399 & 14&@xmath400 & 26&@xmath401 & 38&@xmath400 & 50&@xmath399 +    ' '' ''    3&@xmath402 & 15&@xmath403 & 27&@xmath403 & 39&@xmath402 & 51&@xmath404 +    ' '' ''    4&@xmath405 & 16&@xmath406 & 28&@xmath405 & 40&@xmath407 & 52&@xmath407 +    ' '' ''    5&@xmath408 & 17&@xmath408 & 29&@xmath409 & 41&@xmath410 & 53&@xmath409 +    ' '' ''    6&@xmath395 & 18&@xmath394 & 30&948 & 42&948 & 54&@xmath394 +    ' '' ''    7&@xmath411 & 19&@xmath412 & 31&@xmath413 & 43&@xmath412 & 55&@xmath411 +    ' '' ''    8&@xmath400 & 20&@xmath399 & 32&@xmath399 & 44&@xmath400 & 56&@xmath401 +    ' '' ''    9&@xmath414 & 21&@xmath415 & 33&@xmath414 & 45&@xmath416 & 57&@xmath416 +    ' '' ''    10&@xmath407 & 22&@xmath407 & 34&@xmath405 & 46&@xmath406 & 58&@xmath405 +    ' '' ''    11&@xmath417 & 23&@xmath418&35&@xmath419 & 47&@xmath419 & 59&@xmath418 +    thus the period of @xmath388 turns out to be 60 , just like that of @xmath420 ( not a surprise )",
    ". however , again as with @xmath420 , the even constant terms have half the period of the odd constant terms .",
    "that means @xmath421 has period equal to half the denominator of the corresponding inside - out polytope @xmath422 .",
    "we have no explanation for this .",
    "the principal constituent , that for @xmath423 , is @xmath424 the constant term for magilatin squares does not have the simple interpretation as a number of linear orderings that it does for magic and semimagic squares , because the entries in the square need not all be different .",
    "( still , there is an interpretation as a number of partial orderings of the nine cells ; see theorem 4.1 in our general magic and magilatin paper @xcite , and recall that an acyclic orientation of a graph can be represented by a partial ordering of the vertices . )",
    "we confirmed the formulas by generating all magilatin squares and comparing the count with the coefficients of @xmath425 up to @xmath426 .",
    "the number of symmetry types with strict bound @xmath6 is @xmath427 .",
    "we count them via @xmath428 , given by equation ; then @xmath429 equivalently , @xmath428 counts the @xmath375-integral points in the interior and part of the boundary of the inside - out polytope @xmath376 of section [ sc3 ] .",
    "we get @xmath430 from ; then from we see that @xmath431 & \\quad \\frac{x^4 \\left\\ { \\begin{aligned } 9x^{15}&+20x^{14}+23x^{13}+16x^{12}+10x^{11}+13x^{10}+27x^{9}+43x^{8}\\\\ & + 54x^{7}+52x^{6}+41x^{5}+25x^{4}+14x^{3}+8x^{2}+4x+1 \\end{aligned } \\right\\ } } {   ( 1-x^2)^2 ( 1-x^3)^2 ( 1-x^4 ) ( 1-x^5 ) } \\ . \\end{aligned}\\ ] ] the constituents of @xmath432 are : @xmath433 where @xmath434 varies with period 6 , given by @xmath435 and @xmath436 , given by table [ tb : magilatincubsymc0 ] , varies with period 60 .        ' '' ''",
    "@xmath6 & @xmath437 & @xmath6 & @xmath437 & @xmath6 & @xmath437 & @xmath6 & @xmath437 & @xmath6 & @xmath437 +    ' '' ''    0&9 & 12&9 & 24&@xmath438 & 36&@xmath439 & 48&@xmath438 +    ' '' ''    1&@xmath440 & 13&@xmath441&25&@xmath442&37&@xmath442&49&@xmath441 +    ' '' ''    2&@xmath443 & 14&@xmath444 & 26&@xmath445 & 38&@xmath444 & 50&@xmath443 +    ' '' ''    3&@xmath446 & 15&@xmath447 & 27&@xmath447 & 39&@xmath446 & 51&@xmath448 +    ' '' ''    4&@xmath449 & 16&@xmath450 & 28&@xmath449 & 40&@xmath451 & 52&@xmath451 +    ' '' ''    5&@xmath452 & 17&@xmath452&29&@xmath453&41&@xmath454&53&@xmath453 +    ' '' ''    6&@xmath439 & 18&@xmath438 & 30&9 & 42&9 & 54&@xmath438 +    ' '' ''    7&@xmath455 & 19&@xmath456&31&@xmath457&43&@xmath456&55&@xmath455 +    ' '' ''    8&@xmath444 & 20&@xmath443 & 32&@xmath443 & 44&@xmath444 & 56&@xmath445 +    ' '' ''    9&@xmath458 & 21&@xmath459 & 33&@xmath458 & 45&@xmath460 & 57&@xmath460 +    ' '' ''    10&@xmath451 & 22&@xmath451 & 34&@xmath449 & 46&@xmath450 & 58&@xmath449 +    ' '' ''    11&@xmath461 & 23&@xmath462&35&@xmath463&47&@xmath463&59&@xmath462 +    thus the period of @xmath432 turns out to be 60 . as with @xmath420 and @xmath388 , the period of the even constant terms is half that of the odd constant terms .    the principal constituent of @xmath432 is @xmath464      for",
    "the first several nonzero values of the numbers of magilatin squares and of symmetry types , consult this table : @xmath465 the third line contains the number of symmetry classes of @xmath1 magilatin squares , counted by upper bound .",
    "the main numbers , @xmath371 and @xmath427 , are sequences a173548 and a173729 in the oeis @xcite .",
    "the reduced numbers , @xmath466 and @xmath467 , are sequences a174018 and a174019 .",
    "in contrast to the semimagic case , the number of squares is not a simple multiple of the number of symmetry types .",
    "the last example is @xmath1 magilatin squares , counted affinely .",
    "let @xmath468 be the number of @xmath1 magilatin squares with magic sum @xmath116 .",
    "the weak quasipolynomial is the same as in affine semimagic .",
    "we compute @xmath468 , the number of squares with magic sum @xmath6 , via @xmath469 , the number of reduced squares with magic sum @xmath22 .",
    "the formula is @xmath470 equivalently , @xmath469 counts @xmath471-integral points in the interior and part of the boundary of the inside - out polytope @xmath472 of section [ sa3 ] , each weighted by @xmath377 .",
    "now we calculate ( by latte ) the closed ehrhart generating function for each necessary face .",
    "first , @xmath473 : @xmath474 next is @xmath475 : @xmath476 the last facet is @xmath477 : @xmath478 = \\ & \\frac{x^5 + 4x^4 + 6x^3 + 7x^2 + 7x+5}{(1-x^5 ) ( 1-x^3 ) ( 1-x^4 ) ( 1+x ) } \\ . \\end{aligned}\\ ] ] finally , the edge @xmath479 : @xmath480 now we get @xmath481 from ; then by we deduce that @xmath482 & = \\frac { 12x^6 \\left\\ { \\begin{aligned } & 1 + 3x+7x^2 + 15x^3 + 33x^4 + 65x^5 + 128x^6 + 208x^7 + 316x^8\\\\ & + 434x^9 + 566x^{10}+676x^{11}+784x^{12}+852x^{13}+911x^{14}+936x^{15}\\\\ & + 967x^{16}+967x^{17}+1001x^{18}+995x^{19}+1000x^{20}+955x^{21}\\\\ & + 893x^{22}+752x^{23}+624x^{24}+456x^{25}+322x^{26}+174x^{27}+79x^{28 } \\end{aligned } \\right\\ } } { ( 1+x ) ( 1+x+x^2 ) ( 1+x^2 ) ( 1-x^3 ) ( 1-x^5 ) ( 1-x^6 ) ( 1-x^7 ) ( 1-x^8 )   } \\ .",
    "\\end{aligned}\\ ] ] the constituents of @xmath483 are the following : @xmath484 where @xmath485 varies with period 6 , given by @xmath486 the linear coefficient varies with period 12 , given by @xmath487 the constant term @xmath488 , given by table [ tb : magilatinaffc0 ] , varies with period 120 ; and @xmath143 is as in the affine semimagic count .        ' '' ''    @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 & @xmath6 & @xmath141 +    ' '' ''    0&876 & 20&340 & 40&400 & 60&840 & 80&376 & 100&364 +    ' '' ''    1&@xmath489 & 21&@xmath490 & 41&@xmath491 & 61&@xmath492 & 81&@xmath493 & 101&@xmath494 +    ' '' ''    2&@xmath495 & 22&@xmath496 & 42&@xmath497 & 62&@xmath498 & 82&@xmath499 & 102&@xmath500 +    ' '' ''    3&@xmath501 & 23&@xmath502 & 43&@xmath503 & 63&@xmath504 & 83&@xmath505 & 103&@xmath506 +    ' '' ''    4&@xmath507 & 24&@xmath508 & 44&@xmath509 & 64&@xmath510 & 84&@xmath511 & 104&@xmath512 +    ' '' ''    5&@xmath513 & 25&@xmath514 & 45&@xmath515 & 65&@xmath516 & 85&@xmath517 & 105&@xmath518 +    ' '' ''    6&@xmath519 & 26&@xmath520 & 46&@xmath521 & 66&@xmath522 & 86&@xmath523 & 106&@xmath524 +    ' '' ''    7&@xmath525 & 27&@xmath526 & 47&@xmath527 & 67&@xmath528 & 87&@xmath529 & 107&@xmath530 +    ' '' ''    8&@xmath531 & 28&@xmath532 & 48&@xmath533 & 68&@xmath534 & 88&@xmath535 & 108&@xmath536 +    ' '' ''    9&@xmath537 & 29&@xmath538 & 49&@xmath539 & 69&@xmath540 & 89&@xmath541 & 109&@xmath542 +    ' '' ''    10&265 & 30&705 & 50&241 & 70&229 & 90&741 & 110&205 +    ' '' ''    11&@xmath543 & 31&@xmath544 & 51&@xmath545 & 71&@xmath546 & 91&@xmath547 & 111&@xmath548 +    ' '' ''    12&@xmath549 & 32&@xmath550 & 52&@xmath551 & 72&@xmath552 & 92&@xmath553 & 112&@xmath554 +    ' '' ''    13&@xmath555 & 33&@xmath556 & 53&@xmath557 & 73&@xmath558 & 93&@xmath559 & 113&@xmath560 +    ' '' ''    14&@xmath561 & 34&@xmath562 & 54&@xmath563 & 74&@xmath564 & 94&@xmath565 & 114&@xmath566 +    ' '' ''    15&@xmath567 & 35&@xmath568 & 55&@xmath569 & 75&@xmath570 & 95&@xmath571 & 115&@xmath572 +    ' '' ''    16&@xmath573 & 36&@xmath574 & 56&@xmath575 & 76&@xmath576 & 96&@xmath577 & 116&@xmath578 +    ' '' ''    17&@xmath579 & 37&@xmath580 & 57&@xmath581 & 77&@xmath582 & 97&@xmath583 & 117&@xmath584 +    ' '' ''    18&@xmath585 & 38&@xmath586 & 58&@xmath587 & 78&@xmath588 & 98&@xmath589 & 118&@xmath590 +    ' '' ''    19&@xmath591 & 39&@xmath592 & 59&@xmath593 & 79&@xmath594 & 99&@xmath595 & 119&@xmath596 +    the period of @xmath483 turns out to be 840the period of the constant terms , due to the combination of @xmath141 and the constant term of @xmath138 .",
    "this is equal to the denominator .",
    "the principal constituent of @xmath483 , that is , for @xmath597 , is @xmath598 ( incorporating the @xmath275 term ) .",
    "( as with the cubical magilatin count , there is an interpretation of the constant term 948 in terms of partial orderings ; see theorem 4.7 in our general paper @xcite . )",
    "we verified the results by comparing an actual count of magilatin squares with magic sum @xmath278 to the coefficients in @xmath599 .",
    "we compute @xmath600 , the number of symmetry types of squares with magic sum @xmath6 , via @xmath601 , the number of reduced symmetry types with magic sum @xmath22 .",
    "the formula is @xmath602 equivalently , @xmath601 counts @xmath471-integral points in the interior and part of the boundary of the inside - out polytope@xmath472 of section [ sa3 ] .    from",
    "we get @xmath603 and then from we see that @xmath604 & = \\frac { x^6 \\left\\ { \\begin{aligned }   & 1 + 3x+7x^2 + 13x^3 + 23x^4 + 37x^5 + 60x^6 + 86x^7 + 118x^8 + 149x^9\\\\ & + 180x^{10}+199x^{11}+212x^{12}+208x^{13}+196x^{14}+171x^{15}\\\\ & + 145x^{16}+115x^{17}+96x^{18}+79x^{19}+72x^{20}+67x^{21}\\\\ & + 66x^{22}+59x^{23}+54x^{24}+43x^{25}+33x^{26}+19x^{27}+9x^{28 } \\end{aligned } \\right\\ } } { ( 1+x ) ( 1+x+x^2 ) ( 1+x^2 ) ( 1-x^3 ) ( 1-x^5 ) ( 1-x^6 ) ( 1-x^7 ) ( 1-x^8 )   } \\ . \\end{aligned}\\ ] ] the constituents of @xmath605 are : @xmath606 where the quadratic term varies with period 6 , given by @xmath607 the linear term varies with period 12 , given by @xmath608 and @xmath609 , given by table [ tb : magilatinaffsymc0 ] , varies with period 120 .        ' '' ''    @xmath6 & @xmath610 & @xmath6 & @xmath610 & @xmath6 & @xmath610 & @xmath6 & @xmath610 & @xmath6 & @xmath610 & @xmath6 & @xmath610 +    ' '' ''    0&8 & 20&@xmath611 & 40&@xmath612 & 60&@xmath613 & 80&@xmath614 & 100&@xmath615 +    ' '' ''    1&@xmath616 & 21&@xmath617 & 41&@xmath618 & 61&@xmath619 & 81&@xmath620 & 101&@xmath621 +    ' '' ''",
    "2&@xmath622 & 22&@xmath623 & 42&@xmath624 & 62&@xmath625 & 82&@xmath626 & 102&@xmath627 +    ' '' ''    3&@xmath628 & 23&@xmath629 & 43&@xmath630&63&@xmath631 & 83&@xmath632&103&@xmath633 +    ' '' ''",
    "4&@xmath634 & 24&@xmath635 & 44&@xmath636 & 64&@xmath637 & 84&@xmath638 & 104&@xmath639 +    ' '' ''    5&@xmath640 & 25&@xmath641 & 45&@xmath642 & 65&@xmath643 & 85&@xmath644 & 105&@xmath645 +    ' '' ''",
    "6&@xmath646 & 26&@xmath647 & 46&@xmath648 & 66&@xmath649 & 86&@xmath650 & 106&@xmath651 +    ' '' ''    7&@xmath652 & 27&@xmath653 & 47&@xmath654 & 67&@xmath655 & 87&@xmath656 & 107&@xmath657 +    ' '' ''    8&@xmath658 & 28&@xmath659 & 48&@xmath660 & 68&@xmath661 & 88&@xmath662 & 108&@xmath663 +    ' '' ''    9&@xmath664 & 29&@xmath665 & 49&@xmath666 & 69&@xmath667 & 89&@xmath668 & 109&@xmath669 +    ' '' ''    10&@xmath670 & 30&@xmath671 & 50&@xmath672 & 70&@xmath673 & 90&@xmath674 & 110&@xmath675 +    ' '' ''    11&@xmath676 & 31&@xmath677 & 51&@xmath678 & 71&@xmath679 & 91&@xmath680 & 111&@xmath681 +    ' '' ''    12&@xmath682 & 32&@xmath683 & 52&@xmath684 & 72&@xmath685 & 92&@xmath686 & 112&@xmath687 +    ' '' ''    13&@xmath688 & 33&@xmath689 & 53&@xmath690 & 73&@xmath691 & 93&@xmath692 & 113&@xmath693 +    ' '' ''    14&@xmath694 & 34&@xmath695 & 54&@xmath696 & 74&@xmath697 & 94&@xmath698 & 114&@xmath699 +    ' '' ''    15&@xmath700 & 35&@xmath701 & 55&@xmath702 & 75&@xmath703 & 95&@xmath704 & 115&@xmath705 +    ' '' ''    16&@xmath706 & 36&@xmath707 & 56&@xmath708 & 76&@xmath709 & 96&@xmath710 & 116&@xmath711 +    ' '' ''",
    "17&@xmath712 & 37&@xmath713 & 57&@xmath714 & 77&@xmath715 & 97&@xmath716 & 117&@xmath717 +    ' '' ''    18&@xmath718 & 38&@xmath719 & 58&@xmath720 & 78&@xmath721 & 98&@xmath722 & 118&@xmath723 +    ' '' ''    19&@xmath724 & 39&@xmath725 & 59&@xmath726&79&@xmath727 & 99&@xmath728 & 119&@xmath729 +    the period of @xmath605 is 840 .",
    "the principal constituent , that for @xmath597 , is @xmath730 ( this incorporates the @xmath731 term . )",
    "the first several nonzero values are given in the table .",
    "the third line gives the number of symmetry classes of squares .",
    "@xmath732 the sequences @xmath468 and @xmath600 are a173549 and a173730 in the oeis @xcite .",
    "the numbers @xmath733 of reduced magilatin squares and @xmath734 of normalized , reduced squares with largest value @xmath6 are sequences a174020 and a174021 .",
    "a remarkable fact is that the period of every one of our strong ehrhart quasipolynomials equals the denominator , when it could be much smaller .    for some small values of @xmath6 we calculated @xmath735 by hand , which is feasible because the problem is 2-dimensional .",
    "the process of counting lattice points in a diagram drew our attention to some remarkable phenomena that apply to the semimagic and magilatin problems as well .",
    "let @xmath736 ; let @xmath737 be the coefficient in the quasipolynomial @xmath738 and let @xmath739 be that in the ehrhart quasipolynomial of @xmath18 , and let @xmath740 , @xmath741 be their periods .",
    "we observe that the variation in @xmath742 is exactly the same as that in @xmath743 , i.e. , @xmath744 but that is not so for most lower coefficients , especially @xmath392 .",
    "the reason is that adding each new excluded hyperplane results in a constant deduction in degree @xmath745 ( as we discussed at equation ( 4.9 ) in our first article @xcite ) but a more irregular one in lower terms .",
    "we observe that @xmath740 increases  that is , there is longer - term variation in @xmath737as @xmath746 decreases in every case .",
    "thus we propose some daring conjectures .      1 .",
    "@xmath748 for @xmath749 .",
    "( we know that @xmath750 because @xmath742 and @xmath743 have the same variation . )",
    "if @xmath751 for all @xmath752 , then the variation in @xmath737 is the same as that in @xmath739 .",
    "3 .   the period ratios increase by a multiplicative factor as @xmath746 decreases : @xmath753    we do not suggest @xmath754 because that is false in general in ordinary ehrhart theory , according to mcallister and woods @xcite . however , it might be true for the kinds of inside - out polytopes that arise in cubical and affine counting .",
    "maya ahmed , jess de loera , and raymond hemmecke , polyhedral cones of magic cubes and squares , in boris aronov _",
    "et al . _ ,",
    "eds . , _ discrete and computational geometry : the goodman  pollack festschrift _ , algorithms combin .",
    ", vol .  25 , springer - verlag , 2003 , pp .",
    "mr 2004m:05016 .",
    "zbl 1077.52506 .",
    "matthias beck and andrew van herick , enumeration of @xmath15 magic squares , _ math .",
    "_ , to appear .",
    "matthias beck and dennis pixton , the ehrhart polynomial of the birkhoff polytope , _ discrete comput .",
    "* 30 * ( 2003 ) , 623637 .",
    "mr 2004g:52015 .",
    "zbl 1065.52007 .",
    " , `` six little squares and how their numbers grow '' web site : with a detailed version ( as of january 25 , 2007 ) of this paper , maple worksheets , and supporting documentation .",
    "+ url http://www.math.binghamton.edu/zaslav/tmath/slsfiles/      jess a.  de loera , david haws , raymond hemmecke , peter huggins , jeremy tauzer , and ruriko yoshida , _ a user s guide for latte v1.1 _ , univ .  of california at davis , 2003 , + url http://www.math.ecdavis.edu/latte/    eugne ehrhart , sur un problme de gometrie diophantienne linaire .",
    "i : polydres et rseaux .",
    "ii : systmes diophantiens linaires , _ j.  reine angew .  math . _ * 226 * ( 1967 ) , 129 ; * 227 * ( 1967 ) , 2549 . correction , _ ibid . _",
    "* 231 * ( 1968 ) , 220 .",
    "mr 35 # 4184 , 36 # 105 .",
    "zbl 155.37503 , 164.05304 .",
    "jochi shigeru , the dawn of _ wasan _ ( japanese mathematics ) , in helaine selin and ubiratan dambrosio , eds .",
    ", _ mathematics across cultures : the history of non - western mathematics _ , science across cultures : the history of non - western science , vol .  2 , kluwer , 2000 , pp .  423454 .",
    "mr ( book ) 1805670 ( 2002a:01001 ) .",
    "zbl 981.01005 .",
    "richard p.  stanley , _ enumerative combinatorics _ ,",
    "i , wadsworth & brooks / cole , 1986 .",
    "mr 87j:05003 .",
    "zbl 608.05001 .",
    "corrected reprint , cambridge stud .  adv .",
    "49 , cambridge university press , 1997 .",
    "mr 98a:05001 .",
    "zbl 889.05001 , 945.05006 ."
  ],
  "abstract_text": [
    "<S> we find the numbers of @xmath0 magic , semimagic , and magilatin squares , as functions either of the magic sum or of an upper bound on the entries in the square . </S>",
    "<S> our results on magic and semimagic squares differ from previous ones in that we require the entries in the square to be distinct from each other and we derive our results not by _ ad hoc _ reasoning but from the general geometric and algebraic method of our paper `` an enumerative geometry for magic and magilatin labellings '' . here </S>",
    "<S> we illustrate that method with a detailed analysis of @xmath1 squares . </S>"
  ]
}