{
  "article_text": [
    "for spatially inhomogeneous systems , the computational limits are set by the memory requirement for saving big matrices in two time and spatial degrees of freedom . considering @xmath193 time steps on the keldysh and @xmath194 on the matsubara for a lattice of size @xmath52 the required memory to save the green s function is @xmath195 therefore , for a @xmath196 , @xmath197 , @xmath132 the required memory is @xmath198 gigabytes .",
    "this example shows that reaching large time or large system sizes ( @xmath199 ) is prohibitive since the memory requirement is beyond the capabilities of standard available computational resources .",
    "another issue is the inversion of the huge matrix in the cpt equation to get the lattice green s function .",
    "when the matrix size increases the inversion process takes longer time and also the numerical error will increase . + based on the above facts one has to design a way to avoid matrix inversion and the storage of huge matrices to finally be able to reach longer times for the dynamics of the system .      in this section ,",
    "we summarize the procedure to numerically solve the cpt equation by gradually progressing in time in order to avoid inversion and storage of big matrices .",
    "since this equation is of the kadanoff - baym type , there is a great deal of literature on the subject ( see , e.g. @xcite ) .",
    "for example , the method is used in time dependent dynamical mean - field theory ( tdmft ) @xcite , where , however the system is typically translationally invariant . in our case , where we deal with finite systems , we have to consider spatial degrees of freedom and , accordingly , solve a corresponding set of equations for inhomogeneous system .    here , we roughly follow the treatment of ref .",
    "@xcite , see also  @xcite . here , in addition , we consider the case of an inhomogenous system .",
    "the cpt equation for the green s function @xmath200 of the physical system is @xmath201 where @xmath20 is the cluster green s function and @xmath202 is the inter - cluster term . by introducing @xmath203",
    "we rewrite the cpt equation as @xmath204 and after writing the contour integration explicitly we have @xmath205    using langreth theorem @xcite we can write the integral equation for the components of the green s function on the contour .",
    "we obtain the following equations : @xmath206 where @xmath207 means integration over real time and @xmath208 over imaginary time ( matsubara branch ) .",
    "+ we are interested in the magnetization which can be calculated from the lesser ( @xmath209 ) green s function . to solve the equation for @xmath209 first we need to calculate @xmath210 and @xmath211 within cpt . furthermore to determine @xmath211 we need to evaluate the matsubara green s function @xmath212 which can be calculated with equilibrium techniques .",
    "the cluster green s function @xmath213 , ( @xmath214 ) also should be calculated for an affordable cluster size . + it is also worth to mention that due to the presence of anomalous terms like @xmath215 and @xmath216 in the hamiltonian of eq .",
    "( [ hamilt - boson ] ) the structure of the green s function matrix also should include anomalous green s functions in order to satisfy the correct equation of motion .",
    "therefore the @xmath217 , ( @xmath214 ) , is a matrix in itself with the following nambu structure @xmath218    the definition of the green s functions are as follow : + 1 ) advanced green function : @xmath219\\\\ k_{i , j}^a(t , t')=i\\theta(t'-t)[\\langle a_i^\\dag(t)a_j(t')\\rangle-\\langle a_j(t ' ) a_i^\\dag(t)\\rangle]\\\\ f_{i , j}^a(t , t')=i\\theta(t'-t)[\\langle a_i(t)a_j(t')\\rangle-\\langle a_j(t')a_i(t)\\rangle]\\\\ f_{i , j}^{\\dag a}(t , t')=i\\theta(t'-t)[\\langle a_i^\\dag(t)a_j^\\dag(t')\\rangle-\\langle a_j^\\dag(t')a_i^\\dag(t)\\rangle]\\\\ \\end{split}\\ ] ] 2 ) retarded green s function : @xmath220\\\\ k_{i , j}^r(t , t')=-i\\theta(t - t')[\\langle a_i^\\dag(t)a_j(t')\\rangle-\\langle a_j(t ' ) a_i^\\dag(t)\\rangle]\\\\ f_{i , j}^r(t , t')=-i\\theta(t - t')[\\langle a_i(t)a_j(t')\\rangle-\\langle a_j(t')a_i(t)\\rangle]\\\\ f_{i , j}^{\\dag r}(t , t')=-i\\theta(t - t')[\\langle a_i^\\dag(t)a_j^\\dag(t')\\rangle-\\langle a_j^\\dag(t')a_i^\\dag(t)\\rangle]\\\\ \\end{split}\\ ] ] there is relation between retarded and advanced green s function : @xmath221 .",
    "+ 3 ) lesser green s function @xmath222 4 ) mixing green s function : @xmath223 if we write the integral equation for @xmath210 we get ( omitting the spatial indexes ) :    @xmath224    to perform the integration , we discretize the time with equal spacing @xmath225 where @xmath193 and @xmath194 are the number of time points on the real and imaginary branch respectively . after approximating the integral by the trapezoid rule @xmath226 we get    @xmath227    where @xmath228 is used . in the equation for @xmath210",
    "it is not possible to gradually propagate in the direction of time since @xmath229 depends on later times @xmath230 , in other words this equation is not of the volterra type @xcite where the causal structure is evident from the limits of the integral . to get a volterra type of equation for the @xmath210 we have to use another form of the cpt equation :    @xmath231    where now @xmath232 .",
    "proceeding in the same way as above we derive the following equation in discretized time for the advanced green s function @xmath233 we now can gradually proceed in the second index @xmath234 for a fixed @xmath235 .",
    "+ similarly for the retarded green s function we get    @xmath236    where we can progress in time by incrementing @xmath237 for a fixed @xmath238 .",
    "+ for the mixed green s function if we use the cpt eq .",
    "( [ cpt2 ] ) we obtain the following integral equation : @xmath239 since in the convolution including @xmath211 the integration over @xmath0 is on the whole matsubara branch , it is not possible to gradually proceed in time .",
    "so the way out is to choose the other cpt eq . ( [ cpt2 ] ) to end up in a volterra type equation @xmath240 here one can proceed in @xmath241 for a fixed @xmath242 .",
    "the full information of the matsubara green s function on the imaginary axis is necessary to calculate the mixing green s function .",
    "this can be done by equilibrium techniques , see appendix [ equi - green ] .",
    "+ finally for the lesser greens function we have :    @xmath243",
    "the cpt equation for @xmath212 is not of the volterra type , so it is not possible to gradually proceed along the matsubara axes . fortunately due to the time translation invariance of the green s function ,",
    "@xmath212 only depend on the time difference and so one can use fourier transformation to go over to the frequency representation . in this way",
    "one still has to do inversion process to get cpt green s function but in this way the dimension reduces to the size of the lattice .",
    "+ the fourier transformations between the green s functions are as follow : @xmath244 where @xmath245 $ ] . by using fast fourier transformation ( fftw )",
    "the above transformation can be carried out efficiently .",
    "when doing the inverse transformation we truncate the number of matsubara frequencies . using @xmath246 points equally distributed among positive and negative frequencies we get the approximation @xmath247 \\\\",
    "\\omega_n=\\frac{\\pi}{\\beta}2n   \\end{split}\\ ] ] this scheme poorly describes @xmath248 due to missing contributions from the tail of @xmath249 ( @xmath250 ) . in practice",
    ", it is not possible to consider an infinite number of frequencies so one should calculate the tail correction directly .",
    "if we look at the asymptotic behavior ( @xmath250 ) for the non - interacting green s function we realize @xmath251 the asymptotic tail of @xmath252 can be readily calculated by doing the fourier transformation . for bosons",
    "we get : @xmath253 after a little algebra we can collect all contributions at high imaginary frequencies in the tail of the green s function @xmath254 and write : @xmath255+g_t(\\tau)\\\\   g_t(\\tau)=-\\frac{1}{2}+\\frac{\\tau}{\\beta}+\\frac{2\\pi}{\\beta}\\sum_{n=0}^{n/2 - 1 } \\frac{\\sin(\\omega_n \\tau)}{\\omega_n }   \\end{split}\\ ] ]    99 i. bloch , j. dalibard , and w. zwerger , , 885 ( 2008 ) m. lewenstein , a. sanpera , and v. ahufinger , ultracold atoms in optical lattices simulating quantum many - body systems , oxford university press , oxford ( 2012 ) n. strohmaier , d. greif , r. jrdens , l. tarruell , h. moritz , and t. esslinger , , 080401 ( 2010 ) sachdev , subir , quantum phase transitions , cambridge : cambridge university press ( 1999 ) s. suzuki , j - i inoue and bikas k. chkarabarti , quantum ising phases and transitions in transverse ising models , springer , lecture notes in physics , vol . 862 ( 2013 )",
    "f. meinert , m. j. mark , e. kirilov , k. lauber , p. weinmann , a. j. daley , and h .- c .",
    "nagerl , , 053003 ( 2013 ) d. rossini , a. silva , g. mussardo , and g. e. santoro , , 127204 ( 2009 ) p. calabrese , f. h. l. essler , and m. fagotti , , 227203 ( 2011 ) r. kubo , j. phys .",
    "* 12 * , 570 ( 1957 ) j. schwinger , j. math",
    "* 2 * , 407 ( 1961 ) l. p. kadanoff and g. baym , quantum statistical mechanics ( benjamin , new york , 1962 ) l. v. keldysh , sov .",
    "jetp * 20 * , 1018 ( 1965 ) m. wagner , , 6104 ( 1991 ) j. k. freericks , v. m. turkowski , and v. zlatic , , 266408 ( 2006 ) p. schmidt and h. monien , preprint arxiv : cond - mat * 0202046 * ( 2002 ) f. hofmann , m. eckstein , e. arrigoni , and m. potthoff , , 165124 ( 2013 ) c. jung , a. lieder , s. brener , h. hafermann , b. baxevanis , a. chudnovskiy , a. n. rubtsov , m. i. katsnelson , and a. i. lichtenstein , arxiv : * 1011.3264 * ( 2010 ) m. knap , w. von der linden and e. arrigoni , and , 115145 ( 2011 ) h. aoki and n. tsuji , , 779 ( 2014 ) k. balzer , and m. eckstein , , 035148 ( 2014 ) m. balzer , and m. potthof , , 195132 ( 2011 ) c. gramsch , and m. potthoff , , 235135 ( 2015 ) e. arrigoni , m. knap , and w. von der linden , , 086403 ( 2013 ) a. dorda , m. nuss , w. von der linden , and e. arrigoni , , 165105 ( 2014 ) a. dorda , m. ganahl , h. g. evertz , w. von der linden , and e. arrigoni , , 125145 ( 2015 ) d.d .",
    "snchal , d. perez , and m. pioro - ladrire , 522 ( 2000 ) d.d .",
    "snchal , d. perez , and d. plouffe , 075129 ( 2002 ) w. metzner , , 8549 ( 1991 ) s. pairlaut , d. snchal , and a. m. s. tremblay euro .",
    ". j. b * 16 * , 85 ( 2000 ) h. hafermann , s. brener , a. n. rubstov , m. i. katsnelson , and a. i. lichtenstein , jetp lett .",
    "* 86 * , 677 ( 2007 ) c. gros and r. valent , 418 ( 1993 ) m. bonitz , progress in nonequilibrium green s functions iv , world scientific , singapore ( 2000 ) e. arrigoni , m. knap , and w. von der linden , , 014535 ( 2011 ) m. t. tran , , 125103 ( 2008 ) e. lieb , t. schultz , and d. mattis , ann .",
    "phys ( berlin ) * 16 * , 407 ( 1961 ) p. pfeuty , ann .",
    "phys ( berlin ) * 57 * , 79 ( 1970 ) o. derzhko , journal of physical studies ( lviv ) , * 5 * , 49 ( 2001 ) p. danielewicz , ann .",
    "phys . ( n.y ) * 152 * , 239 ( 1984 ) j. rammer and h. smith , , 323 ( 1986 ) m. potthoff , eur .",
    "j. b. * 32 * , 429 ( 2003 ) m. potthoff , eur .",
    "j. b. * 36 * , 335 ( 2003 ) w. koller and n. dupuis , j. phys : condens .",
    "matter * 18 * , 9525 ( 2006 ) .",
    "m. aichhorn , e. arrigoni , m. potthoff , and w. hanke , 235117 ( 2006 ) m. g. zacher , r. eder , e. arrigoni , and w. hanke , 045109 ( 2002 ) m. knap , e. arrigoni , and w. von der linden , 024301 ( 2010 ) m. knap , e. arrigoni , and w. von der linden , 134507 ( 2011 ) z. friedman , , 1429 ( 1978 ) r. j. elliott and c. wood , j. phys .",
    "c * 4 * , 2359 ( 1971 ) j. oitmaa and m. plischke , j. phys .",
    "c * 9 * , 2093 ( 1976 ) d. c. langreth , linear and nonlinear electron transport in solids ( plenum press , new york and london ) , edited by j. t. devreese and v. e .. van doren ( 1976 ) h. brunner , and p. j. van der houwen , the numerical solution of volterra equations ( north - holland , amsterdam ) 1986"
  ],
  "abstract_text": [
    "<S> we introduce a variational implementation of cluster perturbation theory ( cpt ) to address the dynamics of spin systems driven out of equilibrium . </S>",
    "<S> we benchmark the method with the quantum ising model subject to a sudden quench of the transverse magnetic field across the transition or within a phase . </S>",
    "<S> we treat both the one - dimensional case , for which an exact solution is available , as well the two - dimensional one , for which has to resort to numerical results . </S>",
    "<S> comparison with exact results shows that the approach provides a quite accurate description of the real - time dynamics up to a characteristic time scale @xmath0 that increses with the size of the cluster used for cpt . </S>",
    "<S> in addition , and not surprisingly @xmath0 is small for quenches across the equilibrium phase transition , but can be quite larger for quenches within the ordered or disordered phases .    </S>",
    "<S> introduction the remarkable progresses of experiments on ultracold atoms trapped in optical lattices@xcite have boosted a great interest in the nonequilibrium dynamics of closed quantum systems , especially when they are suddenly pushed across a quantum critical point@xcite . </S>",
    "<S> a rich theoretical activity thus flourished , starting from the paradigmatic example of quantum criticality , namely the quantum ising model.@xcite    developing suitable tools for handling many - body systems out of equilibrium is a big challenge that started some time ago with the pioneering works by kubo @xcite , schwinger @xcite , kadanoff and baym @xcite , and keldysh @xcite . </S>",
    "<S> this effort continued with the work by wagner@xcite , who unified the feynman , matsubara , and keldysh perturbation theories into a single and very flexible formalism , till latest developments related to dynamical mean field and related cluster - embedding methods ( see , e.g. @xcite ) . </S>",
    "<S> we shall in particular be concerned with the very recent out - of - equilibrium generalization of cluster perturbation theory ( cpt ) @xcite , which is attractive and conceptually simple @xcite . in cpt </S>",
    "<S> the lattice is divided into small clusters which can be diagonalized exactly . </S>",
    "<S> the inter - cluster terms are then treated within strong - coupling perturbation theory . </S>",
    "<S> its nonequilibrium version allows to investigate the unitary quantum evolution in the thermodynamic limit , accounting for non - local correlations on a length scale defined by the size of the considered cluster . besides the simplicity of the formulation , </S>",
    "<S> the efficiency and accuracy of the specific implementation is also of major importance .    </S>",
    "<S> the main purpose of this work is to develop a non - equilibrium variational implementation of cpt for spin systems . </S>",
    "<S> we test the method on the quantum ising model after a sudden quench of the transverse field . </S>",
    "<S> since the model is exactly solvable in one dimension we have the possibility to benchmark the approach . </S>",
    "<S> we also investigate the same model in two dimensions where an exact solution is not available . in this case </S>",
    "<S> , we compare with finite - size exact diagonalization results . </S>",
    "<S> we discuss in detail how to efficiently implement the method so to allow reaching relatively long simulation times with moderate computational effort .    </S>",
    "<S> the paper is organised as follows . in section  </S>",
    "<S> [ ne - gf ] the non - equilibrium green s function formalism is briefly presented . </S>",
    "<S> the model we shall study is introduced in section  [ hamiltonian ] . </S>",
    "<S> section  [ method ] describes the cpt method together with its self - consistent variational improvement . </S>",
    "<S> results are reported in sec .  </S>",
    "<S> [ results ] . </S>",
    "<S> section  [ summary ] is devoted to concluding remarks .    </S>",
    "<S> non - equilibrium green s functions [ ne - gf ] in this section we briefly outline the non - equilibrium green s function formalism to set up the notations that we shall use throughout the paper . </S>",
    "<S> there is a wide literature on the subject but in this work we mainly follow the kadanoff - baym - wagner scheme @xcite .    </S>",
    "<S> consider a system initially ( at time @xmath1 ) at equilibrium described by a hamiltonian @xmath2 and temperature @xmath3 . at @xmath4 a generic time dependent hamiltonian @xmath5 is switched on . </S>",
    "<S> the non - equilibrium formalism works through averages of time - ordered products of operators along the kadanoff - baym contour@xcite shown in fig . </S>",
    "<S> [ contour ] . </S>",
    "<S> the contour is composed of three branches : it starts at @xmath1 , runs up to @xmath6 and then back to the initial time , and finally moves parallel to the imaginary axis up to @xmath7 . </S>",
    "<S> +     shaped kadanoff - baym contour @xmath8 . </S>",
    "<S> the arrows indicate the contour ordering . </S>",
    "<S> for example , @xmath9 lies ahead of @xmath10 in the ordering ( @xmath11 ) , i.e. , operators at @xmath9 are sorted to the right by the contour ordering ]    due to the lack of time translation invariance , the non - equilibrium single - particle green s function depends on two time variables rather than on their difference and is defined as the contour ordered expectation value @xmath12 where @xmath13 are the creation ( annihilation ) operators for particles , in the present case bosons , at site @xmath14 and @xmath15 are variables on the contour @xmath8 , and can be real or imaginary depending on the branch of the contour in which they lay . </S>",
    "<S> the time evolution of the operators on the kadanoff - baym contour is defined in the heisenberg picture with hamiltonian @xmath16 . </S>",
    "<S> @xmath17 is the time ordering operator and is defined via the contour step function @xmath18 . </S>",
    "<S> the averages in eq . </S>",
    "<S> ( [ gf - definition ] ) are over the initial equilibrium hamiltonian @xmath2 at temperature @xmath3 .    </S>",
    "<S> the dyson equation reads @xmath19 where @xmath20 is the bare green s function and @xmath21 the self - energy . </S>",
    "<S> the product symbol @xmath22 denotes the matrix multiplication in space and the integration over the time variables along the contour @xmath23 .    for a given green s function </S>",
    "<S> @xmath24 each variable @xmath15 can lay on one of the three branches of the contour in fig .  </S>",
    "<S> [ contour ] . </S>",
    "<S> this prompts an alternative representation of @xmath25 as a @xmath26 matrix , as introduced by wagner @xcite . of the @xmath27 matrix elements , only @xmath28 are linearly independent , so that after a suitable transformation one is left with @xmath28 nonzero terms , which are referred to as the retarded @xmath29 , advanced @xmath30 , keldysh @xmath31 , left - mixing @xmath32 , right - mixing @xmath33 and matsubara green s function @xmath34 . </S>",
    "<S> they are explicitly given as @xmath35\\rangle\\,,\\\\ g_{i , j}^a(t , t')=g_{j , i}^r(t',t)^*\\,,\\\\ g_{i , j}^k(t , t')=-i\\langle \\{a_i(t),a_j^\\dag(t')\\}\\rangle \\,,\\\\ g_{i , j}^\\rceil(t,\\tau)=-i\\langle a_j^\\dag(\\tau)a_i(t)\\rangle \\,,\\\\ g_{i , j}^\\lceil(\\tau , t)=-i\\langle a_i(\\tau ) a_j^\\dag(t)\\rangle \\,,\\\\ g_{i , j}^m(\\tau,\\tau')=-\\langle { \\cal t}_\\tau a_i(\\tau ) a_j(\\tau ' ) \\rangle \\ , , \\end{split}\\ ] ] where @xmath10 and @xmath9 are real times and @xmath36 $ ] . in the above equations @xmath37 and @xmath38 $ ] stem for anticommutator and commutator , respectively .    </S>",
    "<S> hamiltonian[hamiltonian ] the hamiltonian of the ising model in a transverse field is given by @xmath39 where @xmath40 means summation over nearest neighbor spins , and @xmath41 is the strength of the magnetic field , with @xmath42 and @xmath43 . in the following </S>",
    "<S> we shall work in units of @xmath44 . </S>",
    "<S> the hamiltonian of eq . </S>",
    "<S> ( [ hamilt ] ) in one dimension has an exact solution which is obtained by a jordan - wigner transformation that maps the system onto a quadratic hamiltonian for spinless fermions , which can be exactly solved @xcite . on the other hand , in two dimensions an exact solution is not available @xcite .    cluster embedded techniques such as cpt in equilibrium have been applied to fermionic and bosonic systems@xcite . out of equilibrium </S>",
    "<S> , cpt has been applied to the fermionic hubbard model@xcite . </S>",
    "<S> here we formulate nonequilibrium cpt for spin systems , exploiting the well known equivalence between spin-1/2 operators are hard - core bosons . </S>",
    "<S> we also provide a variational improvement of it , which allows to treat the ordered phase . </S>",
    "<S> + specifically , if we assume that spin - up corresponds to the presence of a hard - core boson , and spin - down to its absence , the following relationships between spin and boson operators hold@xcite @xmath45 where @xmath46 and @xmath47 are raising and lowering spin operators , respectively .    </S>",
    "<S> the hamiltonian in the bosonic representation then becomes @xmath48 where the on - site hubbard - like term enforces the hard - core constraint when @xmath49 , and @xmath50 . </S>",
    "<S> since the hamiltonian contains both normal and anomalous hopping terms , green s functions with anomalous terms are needed to study the system ( see appendix  [ cpt - numeric ] ) .    </S>",
    "<S> method [ method ]    cluster perturbation theory cluster perturbation theory ( cpt)@xcite is a simple quantum cluster method to deal with correlated systems . in this approach </S>",
    "<S> the idea is to embed a finite cluster of sites , for which a numerically exact solution is affordable , into the infinite lattice . in practice </S>",
    "<S> the starting point is to partition the original @xmath51-dimensional lattice of linear size @xmath52 into clusters of linear size @xmath53 with open boundaries . </S>",
    "<S> fig . </S>",
    "<S> [ lattice ] shows an example for a tiling in @xmath54 and @xmath55 .    . </S>",
    "<S> the inter - cluster hopping is denoted by @xmath56 ]    all clusters are considered as supercells that form a superlattice , each supercell being identified by a superlattice vector @xmath57 . </S>",
    "<S> the sites within each cluster are in turn labelled by vectors @xmath58 . </S>",
    "<S> the lattice hamiltonian @xmath59 is thus written as @xmath60 where @xmath61 corresponds to the cluster hamiltonian and @xmath56 describes the inter - cluster terms . </S>",
    "<S> cpt green s function can be obtained by a subsequent expansion in powers of the inter - cluster hopping . </S>",
    "<S> diagrammatic @xcite and cluster dual fermion approaches@xcite provide a systematic expansion in terms of the inter - cluster terms , which then has to be truncated at some order . within strong - coupling perturbation theory@xcite one obtains an expression for the lattice green s function at lowest order @xmath62 where @xmath56 is the matrix representation of the inter - cluster hopping , @xmath63 the exact equilibrium green s function of the cluster and the product is just a matrix multiplication in lattice sites . </S>",
    "<S> the green s function @xmath64 is diagonal in @xmath57 and identical for all supercells , whereas @xmath56 is off - diagonal in @xmath57 . because of superlattice translation invariance , </S>",
    "<S> the above equation is simpler in momentum space . </S>",
    "<S> after partial fourier transform , @xmath65 , the cpt equation transforms into @xmath66 where now @xmath67 , @xmath64 and @xmath56 are matrices in the label @xmath58 of the sites within each supercell . </S>",
    "<S> the cpt is a conceptually simple method that nevertheless includes short - range correlations on the scale of cluster size and therefore requires moderate computational resources . </S>",
    "<S> + the idea of cpt can be straightforwardly transferred to non - equilibrium situation by replacing the equilibrium frequency - dependent green s functions with the contour ordered ones . </S>",
    "<S> the authors of ref .  </S>",
    "<S> @xcite have developed a non - equilibrium formulation for cpt ( ne - cpt ) and examined how the technique works for the fermi - hubbard model . </S>",
    "<S> the ne - cpt equation reads as following @xmath68 the solution of eq .  </S>",
    "<S> ( [ ne - cpt - equation ] ) provides the non - equilibrium cpt green s function @xmath69 . in the ne - cpt equation </S>",
    "<S> the product symbol @xmath22 denotes not only the matrix multiplication but also an integration over time variables along the contour @xmath70 . </S>",
    "<S> furthermore @xmath71 where @xmath72 is a @xmath73-function on the contour , i.e. , @xmath74 . in what follows </S>",
    "<S> we shall omit the momentum dependence to simplify notations . </S>",
    "<S> the explicit integral form of eq .  </S>",
    "<S> ( [ ne - cpt - equation ] ) is @xmath75 where integration is carried out along the three branches of the contour @xmath76 in fig . </S>",
    "<S> [ contour ] , i.e. @xmath77 the numerical solution of the generic contour equation ( [ contour - eq ] ) requires discretization of the time variable . </S>",
    "<S> a straightforward but not efficient solution for @xmath25 involves a matrix inversion@xcite where large matrices in discretized time are used . in this manner </S>",
    "<S> reaching long time dynamics is computationally prohibitive . </S>",
    "<S> alternatively , by using the kadanoff - baym equations @xcite one can derive the same integral equation , eq . </S>",
    "<S> ( [ contour - eq ] , for the components of @xmath25 in the wagner representation ( see eq . </S>",
    "<S> ( [ wagner - matrix ] ) ) . </S>",
    "<S> a practical application of this approach to non - equilibrium dynamical mean - field theory ( ne - dmft ) has been presented by tran@xcite . </S>",
    "<S> this method takes advantage of the causality of the integral equations : the properties of the system at specific time @xmath78 do not depend on the information at @xmath79 and so its _ a priori _ knowledge is not required in the calculation . here </S>",
    "<S> we follow this approach but for spatially inhomogeneous systems . for details of the procedure and technical issues see appendix  ( [ cpt - numeric ] )    variational cluster perturbation theory within cpt one is free to add an arbitrary single - particle term @xmath80 to the cluster hamiltonian @xmath61 ( eq . ( [ separat ] ) ) provided that it is then subtracted perturbatively , i.e. added to @xmath56 , such that the hamiltonian @xmath59 remains unchanged . </S>",
    "<S> the cpt expansion is now carried out in the new perturbation @xmath81 with the new cluster hamiltonian @xmath82 . while ideal exact results should not depend on @xmath83 , in practice results </S>",
    "<S> do depend on @xmath83 due to the approximate nature of the cpt expansion . </S>",
    "<S> + in this work we shall consider a @xmath84 symmetry breaking term @xmath85 where @xmath86 are real variational parameters to be fixed . we show below that accounting for this variational term is crucial to describe the ordered phase of quantum ising model . </S>",
    "<S> the optimum value of the variational parameters @xmath86 should be determined through a variational principle@xcite . here </S>",
    "<S> we shall resort to a simplified version of the variational procedure introduced in  @xcite . specifically </S>",
    "<S> , we fix the variational parameters within a self - consistent approach where the inter - cluster term @xmath87 is replaced with its mean - field approximation as @xmath88 in one dimension , for example , upon tiling the infinite lattice into clusters of size @xmath53 , the mean - field expression for the supercell hamiltonian at equilibrium is @xmath89 where @xmath90 , @xmath91 are the mean - field self - consistency conditions and , by translational symmetry , we shall set @xmath92 . + out of equilibrium the variational parameters become time dependent . </S>",
    "<S> the protocol we shall implement is a sudden quench of the magnetic field from @xmath93 to a different value @xmath41 . </S>",
    "<S> therefore the explicit time dependent mean - field cluster hamiltonian becomes @xmath94 with the self - consistency condition @xmath95 where @xmath96 is the time evolved cluster wavefunction . in order to evaluate the time dependent variational parameters </S>",
    "<S> @xmath97 we expand the latter to linear order @xmath98 starting from the initial equilibrium state @xmath99 . as a result </S>",
    "<S> , the parameters @xmath100 can be taken as @xmath101 at each time step .    </S>",
    "<S> cpt corrections to the order parameter due to the presence of anomalous terms linear in creation and annihilation operators the new perturbation @xmath102 including @xmath83 ( eq .  [ anomalous ] ) is not quadratic in the boson operators and therefore one has to generlaize cpt to deal with anomalous terms as well- the way to do this ( see ref .  </S>",
    "<S> @xcite ) is to first perform starndard cpt on top of the cluster hamiltonian @xmath103 ( eq .  [ hp ] ) by using just the quadratic part of @xmath56 as a perturbation . the cpt correction to the condensate can be then obtained by using an expression derived within a so - called pseudoparticle formulation of cpt  @xcite for the bose - hubbard model in the superfluid phase , and , subsequently confirmed more formally within a self - energy functional approach .  </S>",
    "<S> @xcite for the equilibrium case , one obtains @xmath104 where @xmath67 and @xmath105 are the cpt corrected green s function and expectation value of the condensate , respectively , while the terms with prime stands for their cluster values . </S>",
    "<S> the vector @xmath106 describes the variational parameters @xmath107 of eq .  </S>",
    "<S> ( [ anomalous ] ) . in eq .  </S>",
    "<S> ( [ condens ] ) the green s functions are @xmath108 nambu matrices and the @xmath105 , @xmath109 and @xmath106 are @xmath110 nambu vectors , namely @xmath111    out of equilibrium it is straightforward to generalize eq .  </S>",
    "<S> ( [ condens ] ) to an equation along the contour : @xmath112 where the ingredients are now contour functions . </S>",
    "<S> again , the symbol @xmath22 represents matrix multiplication in space and time integration along the contour . </S>",
    "<S> we further simplify this expression by multiplying both sides of it by @xmath25 from the left . </S>",
    "<S> this leads to @xmath113 where we have used the fact that @xmath114 . via the cpt equation ( [ ne - cpt - equation ] ) </S>",
    "<S> one can further derive the expression @xmath115 after substituting into eq .  </S>",
    "<S> ( [ condens3 ] ) , one finally gets the following equation for the condensate including cpt correction @xmath116 we rewrite this equation by expressing the contour integration explicitly as @xmath117 where @xmath118 are contour variables ( see fig . [ contour ] ) . by employing langreth theorem </S>",
    "<S> @xcite one can break down the contour integrations into contributions on the real and imaginary time axes . for the condensate on the real time branch of the contour </S>",
    "<S> we get @xmath119 where we have used @xmath120 . similarly for the condensate on the matsubara branch we derive @xmath121 we note from eq .  </S>",
    "<S> ( [ condensate ] ) that , in order to evaluate @xmath122 within cpt , the mixing green s function @xmath123 and retarded green s function @xmath124 have to be determined first . </S>",
    "<S> it is crucial to employ high - order numerical integration schemes to accurately simulate up to long times . </S>",
    "<S> we refer to appendix . </S>",
    "<S> ( [ cpt - numeric ] ) for more details .    </S>",
    "<S> magnetization    the time dependent magnetization is obtained as @xmath125 where @xmath126 is the total size of the lattice . </S>",
    "<S> @xmath127 can be extracted from the lesser component of the green s function within cpt @xmath128 adding the contribution from the condensate , the final expression for the magnetization is @xmath129 where @xmath130 and @xmath131 are elements of the vector @xmath122 , see eq .  </S>",
    "<S> ( [ condensate ] ) . </S>",
    "<S> + for a finite lattice with open boundary conditions , translation symmetry is lost and therefore the magnetization is position dependent , more pronounced close to the boundaries .    </S>",
    "<S> results [ results ] in the following we apply the technique discussed in the previous section for both equilibrium and nonequilibrium situations . </S>",
    "<S> moreover , by comparing the results with exact ones in one dimension we asses the accuracy of the method .    </S>",
    "<S> equilibrium results before applying the technique out of equilibrium we investigate its ability to describe the system already in equilibrium . </S>",
    "<S> this is actually a necessary step since the present non - equilibrium protocol assumes that the system is prepared as the ground state of an initial hamiltonian and is then evolved with a different hamiltonian . therefore , an accurate equilibrium state is a prerequisite for getting a sensible after - quench dynamics . </S>",
    "<S> the cpt method can work directly in the thermodynamic limit , however , in order to compare with exact results in one dimension , we shall consider a finite system with linear size @xmath132 with open boundary conditions . in the cpt method </S>",
    "<S> the procedure is thus to divide the system into two parts , @xmath133 and @xmath134 , each one with size @xmath55 , and then treat the inter - cluster term perturbatively , see fig . </S>",
    "<S> [ lattice ] .     </S>",
    "<S> direction versus magnetic field for different sites on a lattice of size @xmath132 with open boundary condition . </S>",
    "<S> cluster size in cpt is @xmath55 . </S>",
    "<S> exact results are also being reported for comparison . ]    </S>",
    "<S> we first set the anomalous term to zero in the cluster hamiltonian , i.e , @xmath135 in eq .  </S>",
    "<S> ( [ anomalous ] ) . in fig .  </S>",
    "<S> [ cpt - eq ] we display the magnetization parallel to the magnetic field , @xmath136 , for sites @xmath137 to @xmath138 compared with exact result . </S>",
    "<S> as we see cpt works well for large values of magnetic field and reproduces results close to exact ones . by contrast , upon decreasing @xmath41 the accuracy decreases . </S>",
    "<S> standard cpt totally fails close to the mean - field critical field ( @xmath139 ) . </S>",
    "<S> therefore the standard cpt is unable to correctly describe the physics for @xmath140 .    </S>",
    "<S> this kind of instability is well known in approaches based on the bosonic bogoliubov approximation , such as the spin - wave approximation . the green s function for free bosons ( @xmath141 in the hamiltonian of eq . </S>",
    "<S> ( [ hamilt - boson ] ) ) has two poles at @xmath142 . </S>",
    "<S> it is clear that for @xmath143 the poles move to the imaginary axis , a clear signal of an instability .     with open boundary condition . </S>",
    "<S> right panel : @xmath144    the same explanation applies to the interacting hamiltonian eq . </S>",
    "<S> ( [ hamilt - boson ] ) and to the instability seen in fig . </S>",
    "<S> [ cpt - eq ] . </S>",
    "<S> the poles of the green s function become complex for small values of magnetic field , i.e. for @xmath145 . </S>",
    "<S> this is the region where the hard - core constraint of the bosons becomes important and the standard cpt fails to satisfy this condition . </S>",
    "<S> we control the location of the poles by adding the variational term @xmath83 in eq . </S>",
    "<S> ( [ anomalous ] ) to the cluster hamiltonian , which explicitly breaks the @xmath84 symmetry and induces the spontaneous breaking of such symmetry at low fields . </S>",
    "<S> after finding self - consistently the optimum value for the variational parameters we compute the cpt corrections as explained in the previous section .    in fig . </S>",
    "<S> [ en - cpt ] on the left panel we show the result for the ground state energy compared with the exact one . </S>",
    "<S> the agreement is quite good in the whole range of magnetic fields . on the other hand </S>",
    "<S> , it is well known that the energy is a quantity that is not much sensitive to perturbations , so one could argue that this agreement is not significative . on the other hand , </S>",
    "<S> the right panel shows the value of the variational parameter @xmath146 . </S>",
    "<S> this quantity shows a phase transition at @xmath139 , below which @xmath147 acquires a finite value . strictly speaking such a phase transition </S>",
    "<S> should not occur on a finite size system , where @xmath147 must be zero by symmetry , so its emergence is a spurious results that derives from the variational scheme . in the thermodynamic limit the transition does instead occur , although the critical field is known to be @xmath148 . nevertheless , by increasing the length @xmath53 of the cluster up to @xmath149 we observe a decrease of @xmath150 to values close to the exact value . </S>",
    "<S> for the time dependent calculation and for our benchmark , however , we have to stick to smaller values of @xmath151 . keeping in mind this caveat , </S>",
    "<S> let us turn to compare other physical observable different from @xmath152 .    in fig . </S>",
    "<S> [ occu - cpt ] we report the @xmath153 magnetization on the sites @xmath154 compared with the exact value . as we see the comparison is quite satisfactory . at site @xmath137 and for the whole range of magnetic fields , </S>",
    "<S> cpt results are very close to exact ones especially in the instability region @xmath155 . around @xmath156 </S>",
    "<S> the results are less close to the exact ones mainly for the site @xmath138 at the edge of the system .     with open boundary condition . </S>",
    "<S> the cluster size in cpt is @xmath55 . </S>",
    "<S> exact results are also reported for comparison ]    it is worth mentioning that the hard - core constraint implies the following relation between expectation values : @xmath157 we found that within the present self - consistent cpt the expectation value of the above expression slightly deviates from one by about @xmath158 on the average , with a maximum of the order of @xmath159 at @xmath156 and for the sites at the edge of the supercell , as shown by the kink around @xmath156 in fig .  </S>",
    "<S> [ occu - cpt ] . </S>",
    "<S> this is due to the fact that treating inter - cluster terms perturbatively violates the constraint within cpt , mainly for the edge sites .    </S>",
    "<S> non - equilibrium results in this section we present results for the real time dynamics of the ising model within the variational cluster perturbation approach introduced above . </S>",
    "<S> to drive the system out of equilibrium we proceed as follows . </S>",
    "<S> we prepare the system at equilibrium for @xmath160 as the ground state of eq .  </S>",
    "<S> [ hamilt ] with magnetic field @xmath93 and then we suddenly change the magnetic field to a different value @xmath41 . as in equilibrium </S>",
    "<S> we use variational ne - cpt in a self - consistent way as described in section ( [ method ] ) . after finding the time dependent variational parameters for each time step in the mean - field approximation </S>",
    "<S> , we calculate green s function and condensate within cpt as described in sec .  </S>",
    "<S> [ method ] .    </S>",
    "<S> to benchmark this idea for the non - equilibrium case we display in fig . </S>",
    "<S> [ l8-h0.2-h1.2 ] the real time dynamics of magnetization for different sites on a lattice of size @xmath132 with open boundary condition at zero temperature . </S>",
    "<S> we compare results obtained exactly with results within cpt for a cluster size of @xmath55 . </S>",
    "<S> we have reported the dynamics for the case of relatively large quench , from @xmath161 to @xmath162 , for which the field crosses the phase transition . </S>",
    "<S> as we can see , ne - cpt provides quite good results for the magnetization compared to the exact one except for the edge sites where the hopping to the next supercell is treated perturbatively . at the beginning of the dynamics </S>",
    "<S> ne - cpt is very accurate and the deviation builds up as time progresses .     </S>",
    "<S> direction for different sites on a lattice of size @xmath132 . </S>",
    "<S> the cluster size in cpt is @xmath55 . </S>",
    "<S> the magnetic field has been suddenly changed from @xmath161 to @xmath162 . </S>",
    "<S> the exact dynamics is shown for comparison . ]    </S>",
    "<S> we have investigated different types of quenches and the behavior is qualitatively the same : the dynamics remains close to the exact one at short times and starts deviating at later times . </S>",
    "<S> as mentioned , the largest deviations are found at the edge sites .    in fig . </S>",
    "<S> [ 1d - infinite ] we report ne - cpt results for the magnetization dynamics after the quench for an infinite lattice . </S>",
    "<S> we display results obtained for different cluster sizes and different types of quenches . for quenches into the ordered phase ( see lower left and right panels ) , ne - cpt for a cluster of @xmath163 provides quite accurate results for the magnetization dynamics up to @xmath164 ( remember , that time is in unit of @xmath165 ) . for a larger quench from @xmath166 to @xmath167 , crossing the transition point , ne - cpt is able to reproduce the dynamics only up to a shorter value of the time @xmath168 ( see upper left panel ) . for quenches within the disordered phase ( quench from @xmath166 to @xmath169 ) </S>",
    "<S> ne - cpt results show only a slight deviation ( @xmath170 ) from the exact one , however with some small oscillations ( see upper right panel ) . </S>",
    "<S> overall , ne - cpt results for an infinite system systematically improve by increasing cluster size @xmath53 . already for @xmath171 they reproduce quite accurate results for the thermodynamic limit of a very long chain ( @xmath172 ) up to @xmath173 . </S>",
    "<S> + finally we report the real time quench dynamics of the magnetization for the two dimensional ising model , which is not exactly solvable . in @xmath174 the transverse field ising model at zero temperature has an equilibrium phase transition at @xmath175@xcite .     compared with exact results for a chain of length @xmath172 . ]    within the self - consistent variational cpt at equilibrium we get instead @xmath176 , for the small @xmath177 clusters we are considering . </S>",
    "<S> we note that the accuracy of cpt improves systematically by increasing the cluster size . </S>",
    "<S> we show results for different types of quenches which are obtained either within a disordered or a ordered phase or a quench which crosses the critical field . </S>",
    "<S> here we compare lanczos exact results obtained for three different lattice sizes with periodic boundary condition to ne - cpt results using clusters of size @xmath178 . </S>",
    "<S> we note that the largest size we can reach to perform real time quench dynamics within lanczos at zero temperature is @xmath179 .    for a small quench in the ordered phase , @xmath161 to @xmath167 ( fig . </S>",
    "<S> [ 2d - infinite ] lower left - panel ) ne - cpt gives quite accurate results , as compared with lanczos exact results . </S>",
    "<S> we observe that magnetization dynamics within ne - cpt is quite close to the best of the lanczos for times up to @xmath180 . </S>",
    "<S> we further note that in this case the lanczos results already show convergence as a function of system size so that they can be considered as a good approximation to the thermodynamic limit for these values of the parameters . for a larger quench but still in the ordered phase , i.e. @xmath166 to @xmath167 ( top left - panel of fig . </S>",
    "<S> [ 2d - infinite ] ) the ne - cpt results compare well with lanczos results up to @xmath181 . for quenches with large magnetic fields , </S>",
    "<S> i.e. into the disordered phase from @xmath182 to @xmath183 ( top right - panel in fig . </S>",
    "<S> [ 2d - infinite ] ) the lanczos results have not converged yet , so a comparison is difficult to assess . nevertheless , the ne - cpt results quantitatively agrees with the largest lanczos system up to @xmath184 , and agrees qualitatively , i.e. displays similar oscillations , also for larger times . the lower right - panel in fig . </S>",
    "<S> [ 2d - infinite ] shows the dynamics for a large magnetic quench that crosses the critical point , i.e. from @xmath161 to @xmath185 . in this case </S>",
    "<S> the ne - cpt seems not to be accurate and is able to produce reliable dynamics only up to @xmath186 . </S>",
    "<S> we note that in all cases the magnetization stays within its physical values , @xmath187 , except for a quench across the critical point . with cluster sizes of </S>",
    "<S> @xmath188 results are already promising in two dimensions , as long as one restricts to intermediate times . </S>",
    "<S> furthermore , as in the @xmath54 case , ne - cpt results can be improved by systematically increasing the cluster size .    . </S>",
    "<S> ]    summary[summary ] we have introduced a variational formulatiuon of cluster perturbation theory ( cpt ) to investigate the quantum ising model in and out of equilibrium at zero temperature . </S>",
    "<S> we find that plain cpt in equilibrium can describe accurately the system in the disordered phase , @xmath189 , but looses accuracy while approaching the critical field @xmath150 and finally breaks down in the ordered phase , @xmath190 . to describe the system in the broken symmetry region we developed a variational implementation of cpt , whereby an anomalous term is added to the cluster hamiltonian and subtracted perturbatively . </S>",
    "<S> this parameter is then optimized within a self - consistent framework . </S>",
    "<S> we find a good agreement with exact results in the equilibrium case , for example concerning the magnetisation parallel to the magnetic field and the ground state energy .    out of equilibrium </S>",
    "<S> the time dependent variational parameter are determined self - consistently for each time step . </S>",
    "<S> we find that this variational ne - cpt provides very accurate results for the short and intermediate time dynamics while getting inaccurate for longer times . specifically in one dimension </S>",
    "<S> , comparing results of this ne - cpt approximation with exact calculations shows that clusters of size @xmath163 provide quite accurate description of the dynamics up to @xmath191 for quenches within the ordered or disordered phases . when the critical point is crossed , the accuracy is limited to shorter times @xmath192 . </S>",
    "<S> a similar trend emerges also in two dimensions . here </S>",
    "<S> , there is no exact solution to be compared with , so that we resort to finite - size lanczos diagonalization to benchmark the method . </S>",
    "<S> one should notice , however , that ne - cpt can directly provide results in the thermodynamic limit . </S>",
    "<S> we highlight that the accuracy of ne - cpt can be systematically pushed to longer time by increasing the cluster size , at least up to the largest sizes still reachable by lanczos time evolution .    </S>",
    "<S> this variational approach shall be considered as a first step to study hard - core bosons in and out of equilibrium by a variational cpt method . </S>",
    "<S> this idea could be improved and getting more elaborate by considering more variational terms and/or formulating it within the self - energy functional theory@xcite .    </S>",
    "<S> acknowledgment we would like to thank m. nuss , m. aichhorn and a. dorda for fruitful discussions . </S>",
    "<S> this work was supported by funds awarded by the friuli venezia giulia autonomous region operational program of the european social fund 2007/2013 , project dianet - danube initiative and alps adriatic network , cup g93j12000220009 . </S>",
    "<S> the work was also partially supported by the austrian science fund ( fwf ) : p26508 , y746 , and nawi graz . </S>"
  ]
}