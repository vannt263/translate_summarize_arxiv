{
  "article_text": [
    "the optimal rejection of cosmic ray glitches from astronomical images is of critical importance for large - area pixelized detectors in space .",
    "the detectors ( ccds , etc ) are generally stable and repeatable , so they can be carefully calibrated .",
    "they are often sensitive to cosmic rays and other radiation .",
    "the signals from cosmic rays can be the largest contamination .",
    "but the contamination is far from gaussian ; it tends to be dominated by  glitches \" which have a large effect on one or a few pixels for a short duration . finding , limiting , and rejecting affected data is a problem common to many observation and data reduction strategies .",
    "cosmic rays affect ground - based detectors as well , but to a much smaller extent .",
    "this is partly because the atmosphere and magnetic field act as a shield , eliminating most of the cosmic rays , and partly because atmospheric emission and scattering are variable and limit the extent to which it is possible to uncover and understand other systematic errors .",
    "this study was focused on the next generation space telescope ( stockman  1998 ) ; however , many of the results are applicable over a wide range of observatories .",
    "although we specifically consider ir detectors , the results can be applied to visible light detectors or any detectors where both readout noise and poisson statistics are present .",
    "the ultimate limit on the signal - to - noise ratio is the poisson variation in the photon arrival rate . for large numbers of photons , @xmath0 , and low photon occupation numbers , the variance is approximately equal to the number of photons , so the signal - to - noise ratio is @xmath1 if other sources of noise are negligible . for a fixed telescope",
    ", this is proportional to @xmath2 where @xmath3 is the area of the telescope , @xmath4 is the source strength , @xmath5 is the efficiency of the telescope and detector , and @xmath6 is the observing time .",
    "other sources of noise can reduce the signal - to - noise ratio .",
    "the ratio of the poisson variance to the real variance is a measure of the efficiency of the readout scheme .",
    "variance is used rather than sigma , so the efficiency relates directly to time . in what follows , we will use this efficiency to compare various strategies .    in ir detectors ,",
    "the photons can not yet be reliably counted individually .",
    "the detector and readout electronics add noise ( fanson  1998 , tian  1996 ) .",
    "this can be summarized as the readout noise , @xmath7 , expressed as a number of photons or electrons .",
    "typical values range from a few to @xmath8  e for well - designed systems .",
    "a nondestructive readout allows the use of multiple samples on the same pixel and electrons to reduce the readout error .",
    "however , the additional samples make a more complex system with more electronics and computational complexity .",
    "the process of sampling the detector can add electronic noise directly , or heat the detector , causing additional noise . with the current state of the art detectors ,",
    "the noise can be reduced by increasing the number of samples .",
    "there are often sources of noise with a power spectrum that scales inversely with frequency .",
    "although this noise is poorly understood , it is often present , and in many detectors it becomes the dominant source of noise at very low frequencies .",
    "this sort of noise increases with time just like the photon noise from a source , so it can be treated like a background ( or foreground ) contamination .",
    "the readout noise decreases with the number of samples , and the signal ( and poisson variance ) increases with time .",
    "thus after a sufficient time and number of samples , the readout noise will be insignificant relative to the photon noise , and the ideal efficiency of @xmath9 will be approached .    however , there are two obstacles to long integration times . at some point ,",
    "the wells of the detector fill up , and the detectors become nonlinear and ultimately insensitive to additional photons .",
    "also , particularly in space based detectors , cosmic rays strike the detector at a rate of 5 - 30 @xmath10sec@xmath11 ( tribble 1995 , barth & isaacs 1999 ) ( much higher in radiation belts or during solar flares ) and add a large noise signal .",
    "the sampling strategy is an integral part of the larger observation strategy .",
    "the best strategy depends , of course , on the goal of the observation .",
    "possible goals include finding sources , surveying a region of the sky , identifying sources , examining a source for variation , or mapping diffuse emission . here",
    "we concentrate on detecting dim sources and assume that band limiting filters are used for purposes of identification and analysis .",
    "if only a fixed number of samples , @xmath12 , are available , there is an advantage of using them at the beginning and the end of the integration ( fowler sampling , fowler & gatley 1990 , and fowler  1996 ) .",
    "this approach gives the longest effective integration time , and the variance from the readout noise is reduced by @xmath13 , if the sample noise is uncorrelated .",
    "half of the samples are used at the beginning and half at the end , and the signal is obtained by differencing , which adds the variance from the beginning and the end resulting in the factor of 4 .",
    "the efficiency is then @xmath14 $ ] , which approaches 1 for long times @xmath6 , large signals @xmath15 or many samples @xmath12 .",
    "this does not account for cosmic ray hits or other sources of noise which also have effects .",
    "a fixed sample rate has advantages , as the electronics can be made simple , and the effects of the readout on the chip ( heating , electronic noise ) can at least be made constant .",
    "also , the detector charge history can be searched for cosmic ray strikes and other glitches . uniformly weighting each of the readouts and fitting to a straight line effectively uses only 2/3 of the integration time ( difference between the mean negative weighted times and the mean positive weighted times ) .",
    "hence , the maximum efficiency is .667 for dim sources . for bright sources , as we shall see in section 5 , this limitation can be overcome , and the efficiency can approach 1 .    in the limit where the variance is dominated by the readout noise , it is @xmath16 so the efficiency , @xmath17 $ ] is only 1/3 of the fowler readout . but increasing the integration time has a dramatic impact because it increases the number of samples and the signal , so the signal - to - noise ratio increases as @xmath6 for read noise dominated uniform sampling .",
    "hardware limitations often run counter to the algorithmic requirements . for instance , in order to make fowler sampling efficient , it is desirable to have rapid sampling at the beginning and at the end of the integration .",
    "but the high frequencies required for high speed sampling add more noise , and a@xmath18d converters generally have more noise at higher speed . ultimately , this limitation is related to the noise voltage on a resistor , which is proportional to the square root of the bandwidth , which is inversely related to the sampling time .    multiple readouts on each detector chip can relax the constraint , but only at the cost of additional wires , readout electronics and complexity .",
    "also , each readout path can have its own offset and gain requiring additional parameters in the data processing .",
    "the sheer volume of data can present a problem .",
    "an 8k@xmath198k detector running at a sample rate of 1  hz produces 6  tb in just 12.4 hours of observation .",
    "storing and processing this volume of data daily requires a dedicated computer system .",
    "fowler sampled data are easy to deal with . ideally , they consist of @xmath20 samples at the beginning of an integration and @xmath20 samples at the end of the integration .",
    "the data from the beginning and end are summed independently , and the final result is the difference between the two . for integrations that are of the same order as the sample time , the readout sequence ends up taking a substantial fraction of the total time . since the mean time of the readout is the effective time , the effective integration time is reduced to @xmath21 , where @xmath22 is the time for a single sample .",
    "this reduces the efficiency to @xmath23 even if the readout noise is completely negligible compared to the signal",
    ". the readout noise must be added , of course , but if the number of samples is large relative to @xmath24 , where @xmath7 is the readout noise in photons ( or its equivalent electrons ) , the readout noise becomes small , and any signal is dominated by the photon noise .    for a typical size detector pixel ( @xmath25m@xmath26 ) ,",
    "the mean time between cosmic ray events is @xmath27  sec in space .",
    "the problem with a cosmic ray is that _ all _ of the information is lost in the affected pixel due to the cosmic ray , and the efficiency drops to zero .",
    "so the integration time is a balance between making longer integrations to reduce the readout noise effect and losing information to cosmic rays .",
    "also , if a pixel well is filled , the information is lost .    for a data set formed by uniformly sampling with non - destructive reads ,",
    "the important signal is the time derivative or slope .",
    "finding the slope of a set of data can be done in a straightforward manner .",
    "but there are several important sources of noise , and if attention is paid to each of these , the process can be optimized as shown in @xmath287 .",
    "full wells are recognized , and data taken after a well is filled are ignored .",
    "this reduces the effect on the pixel from losing all of the information to effectively losing only the time after the well is full .",
    "cosmic ray glitches are identified and eliminated from the data before fitting the slope .",
    "finally , the weighting is adjusted to weight high signal pixels towards the ends of the integration and low signal pixels uniformly .",
    "this optimizes the fitting so there is no penalty for the high signal data over the fowler sampled data .",
    "thus , if the integration is carried out long enough , the readout noise can be effectively removed for even the low signal data , although this will suffer a factor of @xmath29 noise increase over fowler sampled data .",
    "but if the integration time is a factor of 2 or more longer , uniform sampled data have a higher efficiency .",
    "many other strategies for sampling can be devised .",
    "however , they tend to combine the disadvantage of the hardware complexity of fowler sampling with the disadvantage of the software complexity of uniform sampling . unless there are peculiar features of the hardware or noise , they offer little improvement over the two cases presented here .    in figure 1",
    "we compare the efficiency of uniform sampling with optimum processing to fowler sampling with its simpler optimum processing .",
    "a range of brightnesses is presented along with a range of integration times .",
    "we assume a cosmic ray rate of @xmath30  s@xmath11 per pixel ( 5  @xmath10  s@xmath11 for 27  detectors 10  thick ) and a full well of 70000 e. this introduces the sudden drop to zero in the fowler sampling and the sharp decrease in the uniform sampling for the brightest sources .",
    "we also assume a minimum sample time of 10 seconds , and a maximum number of samples of 64 per integration .",
    "this means that for integrations less than 640 seconds , readout is continuous and uniform even for the fowler case .",
    "the uniform curves are higher because the data are optimally processed , while the identical fowler data are fowler processed .",
    "this limits the fowler efficiency to 50% . for longer times",
    ", it can be seen that the fowler sampled data have a peak at @xmath31  sec for bright sources and up to 5000  sec for dim sources .",
    "the fall - off is due to cosmic ray hits .",
    "changes in the size or rate of cosmic ray hits change the exact placement of the peaks but not their character .",
    "the uniformly sampled data also suffer from cosmic ray hits , but since they are removed by the processing , their effect is small , and efficiency continues to increase until the wells are filled .",
    "thus , the efficiency of the uniform sampling can exceed that of the fowler case provided a sufficiently long integration time is used . as noted above",
    ", this is approximately a factor of 2 for low level sources .",
    "moore s law ( memory doubles every 18 months , moore 1965 ) suggests that we should not have to worry about data storage ( at least not for long ) , but detector arrays also double on the same time scale , and the problems of data storage and handling remain .",
    "keeping only the appropriate bits can substantially reduce the data volume .",
    "obviously , any large offset can be removed , and the size of the data can be scaled to the largest measurements .",
    "excessive precision includes noise that is not useful and can not be compressed .",
    "insufficient precision allows the uncertainties to be dominated by the digitization rather than the original measurement .",
    "making the least significant bit the size of the uncertainty , ( @xmath32 ) , increases the variance by 8% , an additional bit reduces the increase to 2% , and 2 extra bits results in only a .5% variance increase .",
    "thus we arrive at the well - known injunction to keep one digit into the noise but no more .",
    "if the noise of a system is constant , the a@xmath18d can be arranged so that the @xmath32 noise is @xmath33 times as large as the least significant bit .",
    "the value of @xmath33 is then typically chosen to be in the range 1 - 10 .",
    "the precise value depends on the relative cost of keeping extra bits of marginal value to losing a small part of the signal to noise ratio . if the noise of the system is variable , the process is more difficult .",
    "the a@xmath18d can be adjusted for the lowest noise data .",
    "the data can then be divided by the noise , multiplied by @xmath33 , and the integer result stored .",
    "if each datum has a unique noise , a precise noise estimate must be stored for each one , again increasing the number of bits that must be stored .",
    "poisson distributed data present an efficient alternative .",
    "since the uncertainty is @xmath1 , dividing by the uncertainty gives @xmath1 , and both the signal and the noise have the same record , @xmath34 .",
    "hence , there is no need for a separate noise file , and the data can be restored to sufficient accuracy simply by dividing by @xmath33 and squaring the result .",
    "although we have looked at this problem in the context of astronomical observations , this particular data compression technique is general and can be used anywhere the variance is proportional to the signal .    in the case under consideration , the noise is not purely poisson noise , but the variance can be well approximated by @xmath35 , where @xmath36 is related to the readout noise and the number of samples . since we are dealing with a variation on a small perturbation of the noise , a reasonable approximation will work .",
    "after compression , neighboring values will be combined , by truncating any residual fraction and keeping only the integer part .",
    "the key is the range of values that will be combined , not the absolute value which can be recalculated .",
    "consider the form @xmath37 where @xmath33 is the scaling factor as before , and @xmath38 is an offset .",
    "now for large signals @xmath39 as desired . for small signals : @xmath40 which is satisfied at @xmath41 for @xmath42 .",
    "the encoding is fast , requiring only an add , square root and multiply .",
    "the decoding is also fast and straight - forward .",
    "this process reduces the number of bits by a factor of 2 with essentially no loss of information .",
    "the advantage remains even after additional lossless compression ( nieto - santisteban et al .",
    "the algorithm to process fowler sampled data has already been discussed .",
    "we now turn to the problem of optimizing an algorithm to process uniformly sampled data .",
    "all of the sources of error must be considered to make this a general algorithm .",
    "this will unnecessarily complicate it for some cases , but the computer implementation can take advantage of special cases .    the algorithm will assume a nondestructive set of samples for an integration .",
    "we will denote the raw data @xmath43 , and assume @xmath44 samples at times [ 0,1, ... n ] .",
    "thus , the index number is the time , and we look for a signal per sample time .",
    "we will also frequently use data differences , @xmath45 , which approximate the signal .",
    "the first issue to consider is full wells .",
    "conceptually , the detector collects electrons until the well is full and then stops .",
    "real detectors often show some nonlinearity before the well is full , and may show some  bleeding \" into neighboring pixels . in any case , each pixel",
    "s data must be examined to determine if the pixel s well is full .",
    "the examination is most efficient if it proceeds from the last datum towards the first and stops when the first sample less than full is reached . by using all of the data up to the full well",
    ", maximum dynamic range is maintained .",
    "the limit of dynamic range is then determined by the sampling frequency and the full well size . to account for residual nonlinearity , it is most time efficient to use a look - up table to provide a linearization function .",
    "next , the data must be searched for cosmic rays and glitches ( glitches of either sign might arise from cosmic ray strikes on electronic elements other than the detector , or other sources ) .",
    "since glitches can appear at any time , all of the data must be examined and compared to what is expected .",
    "so , we must make an estimate of what is to be expected .",
    "a simple and robust signal estimate is the difference between the last and first data divided by the time : @xmath46 .",
    "a difference between @xmath47 and @xmath48 should be within the noise .",
    "one might object that @xmath48 is included in @xmath47 as @xmath49 , but a little algebra shows that this only reduces the difference by a factor of @xmath50 .",
    "this can be ignored for large @xmath12 or included in the expected uncertainty .",
    "the expected uncertainty must include 2 readout uncertainties , as @xmath48 is a difference , and the poisson statistics of the photons .",
    "but a large cosmic ray hit included in the estimate of @xmath47 could perturb it to the point that other @xmath48 are interpreted as outliers .",
    "the solution to this problem is to identify the _ worst _ offender .",
    "if it is within bounds , then all of the other data are as well .",
    "if it is not , it must be discarded and excluded from the estimate of @xmath47 .",
    "the test is then repeated on the remaining data .",
    "there remains the question of how to set the bound .",
    "we leave this as a tunable parameter to adapt the algorithm to different cosmic ray rates , detector characteristics and observation goals .",
    "thus , @xmath47 is a good estimate of the signal .",
    "however , if the readout noise is the dominant source of noise , a linear fit to the data can reduce the variance by @xmath51 $ ] .",
    "if , on the other hand , the noise is dominated by the poisson statistics of the photons , the linear fit effectively uses only 2/3 of the time . in that case , the noise is worse for the linear fit by 23% .",
    "an optimum weighting is needed .",
    "the set of differences , @xmath48 , has all of the information .",
    "the covariance matrix for the set of differences can be expressed as the sum of two matrices . since the photon noise for each difference is independent of each of the other differences , the matrix describing the covariance due to the photon noise is @xmath52 , where @xmath47 is the signal and @xmath53 is the identity matrix .",
    "neighboring sample differences are correlated by the readout noise .",
    "each sample , @xmath54 , with its noise , is used twice , once positive ( in @xmath48 ) and once negative ( in @xmath55 ) .",
    "thus , the readout covariance matrix has a main diagonal of @xmath56 with a diagonal of @xmath57 on either side of the main diagonal .",
    "the sum of these two matrices can be inverted to form a weight matrix .",
    "since each difference is an estimate of the signal , the sums of the columns ( or rows as the weight matrix is symmetric ) form a weight vector that optimizes the signal when applied to the differences . by subtracting the weight vector from the weight vector shifted by 1 ,",
    "the difference operation is effectively transferred to the weight vector , and the result can be applied directly to the raw data .",
    "the final weight vector depends on the number of data elements and the signal - to - noise ratio @xmath58 . for large @xmath58 , only the two end points are used , and for small @xmath58 the weights have a linear slope with mean of 0 ( see figure 2 ) .",
    "relatively few cases of @xmath58 can approximate the ideal full matrix calculation quite well . in the algorithm",
    "shown below , we use 8 approximations , and select the appropriate one by using the previously calculated @xmath47 . selecting a poor weight vector does not bias the result , it only increases the noise ( and noise estimate ) of the result .",
    "the error is not symmetric . using a weight for high signal - to - noise ratio for a low signal - to - noise ratio case can result in an increase of order @xmath12 in the variance while an error in the other direction at most increases the variance by 33% .",
    "so we calculate the weight vectors for the bottom of each bin , see figure 3 .",
    "all detectors are expected to be non - ideal , particularly after exposure to a space radiation environment ( the nicmos data handbook ) .",
    "the algorithm described above was developed to demonstrate the advantages of uniform sampling , but it does not directly address detector faults . the strategy for accounting for each fault depends on its type .",
    "each pixel may have a different noise level and responsivity , and these parameters may change with time , particularly after a cosmic ray event depositing large amounts of charge .",
    "if a single cosmic ray can produce a responsivity change , then the algorithm would have to test for that effect and decide whether data taken after the cosmic ray are consistent with those ( presumably correct ) data before it . if the noise level can change with time , then the threshold criterion for recognizing a glitch may need to be adaptive rather than using a stored constant .",
    "however , neither of these cases is expected to raise the computation time very much , since most of the time is still devoted to input .",
    "many detectors show a distinct initial transient after the reset of the integrators .",
    "if this effect has the same general shape for all pixels , it can be modeled and subtracted from the measured data before processing to search for glitches .",
    "such a model might be implemented as a simple formula , or as a table lookup . if the effect differs significantly between pixels , then a more complex model or table lookup may be required .",
    "however , it seems unlikely that a completely separate model for every pixel would be required .",
    "improper treatment of such transients could affect the photometric accuracy for pixels that have glitches or become saturated early .",
    "on the other hand , such data are lost altogether for fowler sampling .",
    "improper treatment could also lead to false alarms , e.g. glitches that are the result only of the repeatable initial transient .",
    "it may also be that each cosmic ray produces a temporary response that disqualifies data taken shortly afterwards .",
    "if this effect can be described by a simple dead time , it is easily handled in the code .",
    "if there is a long term effect with a constant waveform , it can be corrected by modeling and subtracting it . if it is still too difficult to correct , then data taken after the glitch can be ignored until the next exposure .",
    "the uniform sampling with cosmic ray rejection would then have a lower efficiency , but still would be superior to fowler sampling in which such pixels can not be used at all .",
    "the algorithm described here makes no use of spatial information .",
    "however , a processor could easily examine the neighbors of every pixel where a glitch or saturation has been found , to see if there is any odd behavior there .",
    "there are two problems : first , in this process it is very easy to introduce spatial correlations which can contaminate the results .",
    "second , the processing can become very involved making it slow .",
    "either of these is incompatible with our attempt to produce a simple , fast and robust process to remove cr and compress data from large - area detectors .",
    "some faults might not be in the detectors .",
    "a variable pointing error would produce a variable brightness incident on pixels where spatial gradients are high , leading to false detections of glitches .",
    "these could be handled by raising the threshold for glitch detection for bright pixels , possibly by using an adaptive calculation .    to summarize",
    ", detector faults will require additional code in the processing algorithm , but this additional code is not expected to produce large computational loads , nor to invalidate or bias the data . for long exposures , uniformly sampled data will still be valid over a larger fraction of the pixels than fowler sampled data .",
    "the process outlined here does not imply anything about neighboring pixels .",
    "this reduces the likelihood of generating any biases in the data .",
    "it also keeps the process simple and short .",
    "only 6 operations per datum plus 6 operations per pixel are required to check , fit and compress the data .",
    "rejected data are somewhat more expensive , but presumably they are relatively rare , so the entire process can take place on a modest computer for even enormous data flows .",
    "the data from an array are usually collected in the order of columns , rows and then sample iterations .",
    "the order of the data required for the algorithm is by sample iteration first and then pixel ( either columns or rows first ) .",
    "this has two implications .",
    "first , an entire read set must be stored in memory .",
    "for example , in the next generation space telescope ( ngst ) with 64 reads in an integration , this set is 8 gb ( 2 bytes @xmath59 64 reads @xmath59 1 m pixel per chip @xmath59 64 chips , see the ngst study team , 1997 ) , so the task is not trivial .",
    "second , to speed the memory operations , it is convenient to have the addresses for the computer reads in a different order than for the a@xmath18d converter writes . if an even power of 2 is adopted for the number of samples , this is easily achieved by swapping some of the address bits and using a double buffer so that the computer can be processing a set of data while the next set is being collected .    since the compression ratio is large ( of order 200 is easily achievable for 64 samples ) , the output storage and transmission are greatly simplified .",
    "the input and output bounds on the computer are entirely dominated by the input side .",
    "the algorithms introduced in offenberg et al .",
    "( 1999 ) and nieto - santisteban et al .",
    "( 1999 ) have now been optimized to reduce computer requirements and improve performance .",
    "first , saturated data are marked and not used .",
    "next , for each pixel , the set of samples ( 64 ) is fit to a straight line .",
    "the interval with largest deviation from the line ( either direction ) is compared with the expected noise .",
    "if it is larger than @xmath60 ( optimum for test case ) , the interval is not used in the fit , and the process is repeated .",
    "most of the processing time is used by the cosmic ray rejection .    next",
    ", a weighted fit is applied to the remaining data .",
    "the optimum fit depends on the signal .",
    "high signal uncertainties are dominated by photon ( electron ) counting noise , and the optimum fit weights the endpoints .",
    "low signal uncertainties are dominated by readout noise , and the optimum fit is uniform weighting .",
    "we calculate the weights for these and 6 intermediate signal - to - noise ratios and choose the best weighting scheme for the signal . by computing the weight table for all 8 signal - to - noise ratio levels ( @xmath61 of total computation time ) and all possible segment lengths , we save time in the weighted fit .",
    "after the fit , we reduce the dynamic range and equalize the noise for the different pixels by finding the square root of the slope plus an offset , which compensates for the readout noise .",
    "finally , an adjustable scaling allows retention of @xmath33 bits of noise after conversion to an integer .",
    "thus n ( 64 ) 16 bit samples are converted to a single 8 bit byte",
    ". this can be further compressed without loss ( see nieto - santisteban et.al . 1999 ) to approximately 3 bits per pixel ( if we keep 2 bits of noise ) .",
    "the final results are robust .",
    "even integration times that lead to most of the pixels being affected by cosmic rays can be effectively cleaned , allowing longer integration times than are practical with fowler sampling .",
    "this leads to higher efficiency than fowler sampling .",
    "the difference can be as large as a factor of 2 , which translates directly to saving half of the total integration time while getting the same quality data .",
    "figure 4 demonstrates the effectiveness of cosmic ray rejection .",
    "the cosmic rays in the raw image ( or , equivalently , in a fowler - sampled image ) make long integration ( @xmath62 sec ) undesirable . if we take non - destructive samples every 30 seconds during the integration , it is possible to get a clean image of long integration times , with high photometric reliability .",
    "the images shown in figure 1 are stretched to the same grey - scale and assume a cosmic ray rate of 5 event / sec / cm@xmath26 , which is the low end estimate for cosmic ray rates in deep space ( l2 orbit ) , such as planned for the next generation space telescope .    the lower pair of plots in figure 5 compares photometry for fowler sampling and uniform sampling with processing for five 2000 second integrations .",
    "the resulting images are processed by throwing out the outliers and using iraf daophot on the final image .",
    "the fowler sampled data are still contaminated with cosmic rays ( cr ) , as expected , so the ideal integration time is shorter .",
    "but the ideal integration time is longer for uniform sampling with deglitching .",
    "the upper pair of plots in figure 5 compare the optimum twenty 500 sec fowler sampled images with a single 10000 sec uniform sampled image after deglitching . in all cases , a total of 320 samples were executed for 10000 seconds of observation .",
    "the uniform sampled image is higher quality even though the data rate is only 1/40 as large ( after data compression ) .    as table 1 indicates , even though the _ processing _ ( including cr rejection ) of this algorithm takes longer than the _ processing _ of fowler sampled data , the total time is dominated by i / o and in particular input . if the input speed can be raised to the data rate , the remaining processing for either the fowler sampling or this algorithm is accommodated on a modest computer .",
    ".uniform w / cr vs. fowler [ cols=\">,^,^\",options=\"header \" , ]     [ table : summary ]    note : the times are based on a ultra sparc 2 running at 168 mhz .",
    "the algorithm presented here is robust as it excises points far from the line and uses a linear fit on the points near the line .",
    "it preserves the maximum dynamic range allowed by the hardware readout and rejects almost all cosmic ray hits .",
    "its adjustable weighting efficiently uses uniformly sampled data , and yet it uses a minimum of computer resources .",
    "these studies are supported by the nasa remote exploration and experimentation project ( ree ) , which is administered at the jet propulsion laboratory under dr .",
    "robert ferraro , project manager .",
    "the following is the complete algorithm . the program `` init_wt '' , is required only once to set up the weight table , wt .",
    "the output of the program , `` cr_rej '' is a compressed best fit image and a list of the number of glitches found at each location .",
    ".... # include < math.h > # include \" simpleimage.h \" # define e 2.71828 # define e .0024788                   //smallest s / n ratio bin # define k 8                          //number of signal ( s ) cuts # define m 64                         //max number of reads float wt[k][m][m/2 + 1 ] ;    void init_wt(float * a , float * f , float * v , float * q ,   float b ,                 //bits of noise to keep float p ,                 //gain ( photons / count )",
    "float v ,                 //readout variance ( counts^2 ) int n ,                   //number of reads float s )                 //sigma for cr cutoff { float * w ; double z[m],y[m],s , w , x , y , z ; register int i , k , n ;    * a = b*sqrt(p ) ;                                          //renormalize bits     * f=3.*v/(n*p*(n+1)*(n+2 ) ) ;                             //output offset    * q = s / p ;                                                //renormalize cutoff    * v=2.0 * * q*v*(n*n+1)/(p*n*(n-1 ) ) ;                      //renormalize variance    for(s = e , k=0;k < k;s*=e , k++){wt[k][0][0]=0 ;               //loop on s / n ratio , s.      for(z[0]=y = x = n=0;++n < n;){w = wt[k][n ] ;                 //for all ramp lengths        y[n]=x=1/(2+s - x);y++ ;                              //new x new last y        for(z = i=0;++i <",
    "n;)z+=z[i]+=y*(y[i]*=x ) ;             //update row and sum        for(y = x , i=0;++i < n;)y+=y[i ] ;                        //sum weight        for(i=0;i<(n+1)/2;i++)w[i]=(z[i]-z[i+1])*p*(n-1 ) ; //differences        w[i]= z+(z[n]=y ) ; }                                 //final weight      for(x=1/(z+y),i=0;i < n/2;i++)w[i]*=x ; } }               //renormalize last row    void cr_rej(//routine to reject cosmic rays and perform linear fit of data .",
    "short int * di ,           //input : data cube ( np x",
    "n ) containing the data .",
    "const int n ,             //input : number of images in the data set .",
    "simpleimage * cd ,         //output : contains the fitted image data .",
    "simpleimage * cr ,         //output : number of detected cr const int np ,            //input : number of pixels in the data set .",
    "const int f ,             //input : count for full - well .",
    "const float a ,           //input : noise bits to keep in sqrt - scaling const float f ,           //input : offset for sqrt - scaling const float v ,           //input : renormalized read variance   const float v ,           //input : read variance ( counts^2 ) const float q )           //input : chi^2 limit in counts { register int p , c , k ; register short int * d , * p ;    const float eve = e*v*e ; const int n = n-1 ;    register float s , x , y,*u,*w,*x,*y , z[m],*c[m ] ; u = z+n ;    for(p = di+n*(p = np);p-->0;){d = p;p-=n ;                    //do for all pixels      if(p[1]>f){cr->setval(p , n);cd->setval(p,0 ) ; }         //if no good data exit      else{while(*--d >",
    "f ) ;                                  //find last good data        for(c=-1,x = y = z+(k = d - p);(c[++c]=y++)<u ; ) ;           //delete full reads        for(y = x;d>=p;*y--=*d-- ) ;                           //convert to floats        s=(*x-*z)/k ;                                       //estimate signal        for(x = v , y = x;y > z;)if((y*=y = s-*y+*--y)>x){x = y;x = y ; } //find worst point        for(;x > s*q+v;x-- ) {                                 //is it a cr ?",
    "s+=(s+*x-*(x+1))/(n-++c ) ;                        //fix s for cr          for(k = c;((c[k]=c[k-1])>x)&&--k;);c[k]=x ;         //fit cr in list          for(k=0,x = v , y = z;k<=c;++y){w = c[k++ ] ;              //for all segments            while(y < w)if((y*=y = s+*y-*++y)>x){x = y;x = y ; } } }   //find worst point         cr->setval(p , c ) ;                                   //record # cr        for(k=0,x = eve;s > x&&++k < k-1;x*=e ) ;                  //find proper s / n bin        if(c){for(y = z , s = y = c=0;y <",
    "u;y = c[c++]+1 ) {             //for all segments            w = wt[k][c[c]-y ] ;                               //find right weights             for(x = c[c];y <",
    "x;)s+=*w++*(*y++-*x-- ) ;           //total this segment            y+=*w ; }                                        //sum of weight          s = s / y+f ; }                                        //final sig        else for(w = wt[k][n],s = f , x = u;*w<0;s+=*w++*(*y++-*x--));//0cr weighted fit        cd->setval(p,(s<0)?0:int(a*sqrt(s ) ) ) ; } } }           //record data ....",
    "fanson , j.l . ,",
    "fazio , g.g .",
    ", houck , j.r .",
    ", kelly , t. , rieke , g.h .",
    ", tenerelli , d.j . & whitten , m. , `` space infrared telescope facility ( sirtf ) '' , proc .",
    "3356 , p. 478 - 491 ,",
    "space telescopes and instruments v , p. y. bely ; j. b. breckinridge ; eds .",
    "fowler , a.m. , gatley , i. , mcintyre , p. , vrba , f.j .",
    ", & hoffman , a.w .",
    ", `` aladdin : the 1024x1024 insb array  design , description , and results '' , proc .",
    "2816 , p. 150 - 160 , infrared detectors for remote sensing : physics , materials , and devices , r. e. longshore ; j. w. baars ; eds , 1996 .",
    "nieto - santisteban , m.a . ,",
    "fixsen , d.j . ,",
    "offenberg , j.d . ,",
    "hanisch , r.j . , & stockman , h.s . 1999 , in_astronomical data analysis software and systems viii _ d.m .",
    "mehringer , r.l .",
    "plante , & d.a .",
    "roberts , eds .",
    "pacifc conference series , * 172 * , 137 .",
    "offenberg , j.d . ,",
    "sengupta , r. , fixsen , d.j . ,",
    "stockman , h.s . , nieto - santisteban , m.a . ,",
    "stallcup , s. , hanisch , r.j .",
    ", & mather , j.c . 1999 , in_astronomical data analysis software and systems viii _ d.m .",
    "mehringer , r.l .",
    "plante , & d.a .",
    "roberts , eds .",
    "pacifc conference series , * 172 * , 141 .",
    "stockman , h.s . ,",
    "fixsen , d. & hanisch , r.j . , `` cosmic ray rejection and image processing aboard the next generation space telescope . ''",
    "the next generation space telescope : science drivers and technological challenges , 34th liege astrophysics colloquium , june 1998 , p. 121 .",
    "tian , z. , ji , r. , lei , s. , gu , b - q . ,  measurement of noise of photovoltaic hgcdte and insb infrared detector \" . proc .",
    "spie vol . 2894 , p. 174",
    "- 179 , detectors , focal plane arrays , and applications , w. g. frederick , j. su , & m. wigdor , eds ."
  ],
  "abstract_text": [
    "<S> we present an algorithm to optimally process uniformly sampled array image data obtained with a nondestructive readout . </S>",
    "<S> the algorithm discards full wells , removes cosmic ray ( particle ) hits and other glitches , and makes a nearly optimum estimate of the signal on each pixel . </S>",
    "<S> the algorithm also compresses the data . </S>",
    "<S> the computer requirements are modest , and the results are robust . the results are shown and compared to results of fowler sampled and processed data . non - ideal detector performance may require some additional code , but this is not expected to cost much processing time </S>",
    "<S> . known types of detector faults are addressed .    </S>",
    "<S> # 1 = 10000 = 1000 </S>"
  ]
}